# StackOverflow 问答 11399000-11399999

# json - Grails, create domain object from json-string with has-many relation

> ID：11399003
> 
> 赞同：2
> 
> 时间：2012-07-09T16:10:18.723
> 
> 标签：json, parsing, grails, parameters

I'm trying to parse a grails parameter map to a Json String, and then back to a parameter map. (For saving html form entries with constraint-violations)

Everything is fine as long as there is no hasMany relationship in the parameter-map.

I'm using

```
fc.parameter = params as JSON 
```

to save the params as JSON String.

Later I'm trying to rebuild the parameter map and create a new Domain-Object with it:

```
new Foo(JSON.parse(fc.parameter)) 
```

Everything is fine using only 1:1 relationships (states).

```
[states:2, listSize:50, name:TestFilter] 
```

But when I try to rebuild a params-map with multi-select values (states)

```
[states:[1,2], listSize:50, name:TestFilter] 
```

I'm getting this IllegalStateException:

```
Failed to convert property value of type org.codehaus.groovy.grails.web.json.JSONArray to required type java.util.Set for property states; nested exception is java.lang.IllegalStateException: Cannot convert value of type [java.lang.String] to required type [de.gotosec.approve.State] for property states[0]: no matching editors or conversion strategy found 
```

I tried to use this, but without success:

```
JSON.use("deep") {
   new Foo(JSON.parse(fc.parameter))
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T18:24:57.283

您可以使用 JsonSlurper 代替 grails 的 converters.JSON，它将 JSON 对象映射到 Groovy Maps。我认为[此](https://stackoverflow.com/questions/11060922/json-to-groovy-with-jsonslurper-and-unknown-string?rq=1)链接也可能对您有所帮助。

编辑：现在，如果问题是将参数映射绑定到您的域，您应该尝试使用 bindData() 方法，例如：

```
bindData(foo, params) 
```

请注意，仅当您在控制器内调用 bindData 时，才可以直接使用。

在您的情况下似乎正在发生的事情是 Grails 正在尝试将具体类型的 List（在 JsonSlurper 的情况下为 ArrayList ，在 converters.JSON 的情况下为 JSONArray ）绑定到一组属性（这是默认数据结构一对多关联）。我将不得不查看您的代码以确认这一点。但是，正如您所做的替换状态：[1,2] 为您的应用程序的方法，尝试另一个测试来确认这个假设。改变：

```
states:[1,2] 
```

为了

```
states:[1,2] as Set 
```

如果这确实是问题所在，甚至**bindData() 都不起作用**，请查看[这个](http://manbuildswebsite.com/2010/02/15/rendering-json-in-grails-part-3-customise-your-json-with-object-marshallers/)以使用对象编组和转换器.JSON 使其工作的更困难的方法。我不知道在你的项目中使用它是否实用，但它确实很好用；）

# javascript - 在 Javascript 中检查 2D 数组边界

> ID：11399005
> 
> 赞同：2
> 
> 时间：2012-07-09T16:10:32.030
> 
> 标签：javascript

我有一个二维数组，我想检查 Javascript 中的边界。我更喜欢这样做而不独立检查每个索引。

例如，如果我的二维数组是......

```
dataset[row0-1][column+column0] 
```

我真的不想做以下事情......

```
if(row0-1 >0)
{
    if(dataset[row0-1].length >= column+column0)
    {
        data = {label : dataset[row0-1][column+column0]};
    }
} 
```

问题是我必须先检查行，然后检查列。我更喜欢用一个操作或一行来完成这两项检查。而不是返回一个越界错误，为什么 Javascript 不只返回 null 或 undefined？

例如，在未来的 Javascript 版本中，如果我们能做到这一点不是更好吗？

```
if(dataset[row0-1][column+column0] != undefined)
{
   data = {label : dataset[row0-1][column+column0]};
} 
else 
{
    ...
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:19:29.497

您可以编写一个函数来检查：

```
function CheckArrayIndex(x, y) {
    if (dataset.length > x && dataset[x].length > y) {
        return dataset[x][y];
    }

    return null;
} 
```

然后你可以像这样使用它：

```
if(CheckArrayIndex(row0-1,column+column0) != null){
   data = {label : dataset[row0-1][column+column0]};
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:17:28.157

我认为独立检查每个索引的原因是因为每个维度在每个索引上都可以有不同的长度。

我知道 C# 有[Multidimensional Arrays](http://msdn.microsoft.com/en-us/library/2yd9wwz4)，但 Javascript 使用[Jagged Arrays](http://msdn.microsoft.com/en-us/library/2s05feca)。

我不认为这种变化很快就会发生。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T16:27:43.237

[您可以使用AND 运算符`&&`](https://developer.mozilla.org/en/JavaScript/Reference/Operators/Logical_Operators)轻松地将嵌套的 if 子句组合成单行：

```
if (row0-1 > 0 && dataset[row0-1].length >= column+column0){
    data = {label : dataset[row0-1][column+column0]};
} 
```

尽管您确实应该检查数组的长度，而不是（仅）大于 0。更好：

```
if (row0-1 > 0 && row0-1 < dataset.length && column+column0 < dataset[row0-1].length)
    data = {label: dataset[row0-1][column+column0]};
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-12T11:41:21.873

我最喜欢这样：假设我们有二维数组`arr`，我们需要访问一个不存在的元素。

```
var arr = [/*elements*/]
var get = function(x, y) {
  if(!arr[x]) {
      return false;
  }
  return arr[x][y] || false;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-07T14:18:48.343

使用@dmck 答案，我在 Array 对象中使用原型。

功能：

```
Array.prototype.CheckBounds = function (x, y)
{
    if (this[x] === undefined)
        return false;

    if (this.length > x && this[x].length > y) {
        return true;
    }

    return false;
}
```

如何使用：

```
if(myArray.CheckBounds(5,10)) //Check bounds
 {
   //OK
 }else{
   //Out of bounds
 }
```

# php - Calculate new gradient positions after the polygon it fills changes dimensions

> ID：11399009
> 
> 赞同：23
> 
> 时间：2012-07-09T16:10:56.477
> 
> 标签：php, javascript, math, vector, svg

**What I want to do?**

Updates to this question: 7/10/2012 - "gradientTransform not quite" Inspired by Duopixel 7/11/2012 - "SVG Code from the example" 7/16/2012 - "@dignifiedquire take on this problem"

I'm trying to create a tool that let's the user dynamically resize polygons. Most of the polygons are filled with gradients `fill="url(#top_surface_1_gradient)"`. The way I go about this is a simple JavaScript script that:

1.  looks for mousemove & click events over a certain polygon
2.  measures the amount of movement
3.  changes half of the coordinates of the polygon (in order to have the effect of stretching) using this algorithm to define new coordinates: `x = x_movement`, `y = x_movement * Math.tan( 31 * (Math.PI/180) )`
4.  polygons that are filled with a single colour are OK
5.  polygons that are filled with a gradient are not, let me demonstrate:

**Visually**

![step_1](../Images/fffd60df4278aa23d961561ff2e929b0.png)

So this is step one, no stretching has been done by the user.

![step_2](../Images/5bbb7d2c09a1ecf8d298169796c1859f.png)

This is where the problem happens. Since I don't know how should I change the `x1, y1` and `x2, y2` coordinates for the gradient, it just stays hanging in it's old position while the polygon has been stretched. The result is a shape that fails to sustain the illusion of depth.

![step_3](../Images/5d591b2751d1116e8b6bef54ce84aa0c.png)

The end result I'm looking for. And bare in mind that the gradient might have a completely random angle from the get go. In this end result, that I'm looking for, both the `x1, y1` and `x2, y2` coordinates of the gradient have been changed. **What algorithm should be used to calculate these positions?** I'm looking for a solution that is **completely blind to the angle of the gradient**.

Below is the SVG with all the appropriate coordinates that was used to generate these examples:

**Using SVG code**

Step1:

```
<!-- Step 1 -->
<linearGradient id="top_surface_1_gradient" gradientUnits="userSpaceOnUse" x1="165.3425" y1="39.7002" x2="-49.991" y2="43.0337">
    <stop  offset="0" style="stop-color:#FFFFFF"/>
    <stop  offset="0.6687" style="stop-color:#CCCCCC"/>
    <stop  offset="1" style="stop-color:#FFFFFF"/>
</linearGradient>
<polygon id="top_surface_1" fill="url(#top_surface_1_gradient)" points="137.145,41.204 68.572,0 0,41.204 68.572,82.396"/> 
```

Step 2

```
<!-- Step 2 --> 
<linearGradient id="top_surface_2_gradient" gradientUnits="userSpaceOnUse" x1="250.0491" y1="233.8115" x2="23.7637" y2="237.3146">
    <stop  offset="0" style="stop-color:#FFFFFF"/>
    <stop  offset="0.6687" style="stop-color:#CCCCCC"/>
    <stop  offset="1" style="stop-color:#FFFFFF"/>
</linearGradient>
<polygon id="top_surface_2" fill="url(#top_surface_2_gradient)" points="205.788,215.557 137.215,174.354 0.078,256.629 68.649,297.823"/> 
```

Step 3

```
<!-- Step 3 --> 
<linearGradient id="top_surface_3_gradient" gradientUnits="userSpaceOnUse" x1="248.4543" y1="454.5225" x2="-75.535" y2="459.5381">
    <stop  offset="0" style="stop-color:#FFFFFF"/>
    <stop  offset="0.6687" style="stop-color:#CCCCCC"/>
    <stop  offset="1" style="stop-color:#FFFFFF"/>
</linearGradient>
<polygon id="top_surface_3" fill="url(#top_surface_3_gradient)" points="205.788,415.557 137.215,374.354 0.078,456.629 68.649,497.823"/> 
```

I've spent countless hours developing solutions for this problem and I just couldn't get my head around it. Any help would be greatly appreciated.

**Update: gradientTransform not quite**

Using the gradientTransform attribute and no x1,y1; x2,y2 coordinates for the gradient, we achieve results that fill the polygon in a way that is almost as needed (This solution can be found here: [http://jsfiddle.net/hqXx2/](http://jsfiddle.net/hqXx2/)). The only place where the solution breaks is when the polygon is filled with a gradient that starts outside of the polygon and/or ends somewhere outside/inside. Let me illustrate:

This is what is achieved with the solution, that Duopixel is suggesting. ![step_4](../Images/3a07b85c4f8366c841e1436fb26fc81d.png)

This is the usage case that is impossible to achieve using the solution mentioned above. I changed the colouring in order to visibly amplify the angle and gradient stops. ![step_5](../Images/d3d8c5062b7e3980e55e6e4f76c69429.png)

**SVG Code from the example**

Here's the code for the larger, correctly expanded group of polygons:

```
<g>
    <linearGradient id="surface_center_inside_bottom_1_" gradientUnits="userSpaceOnUse" x1="167.7629" y1="634.5986" x2="-72.9039" y2="599.2647">
        <stop  offset="0" style="stop-color:#FFFFFF"/>
        <stop  offset="0.8528" style="stop-color:#CCCCCC"/>
        <stop  offset="0.9954" style="stop-color:#CCCCCC"/>
    </linearGradient>
    <polygon id="surface_center_inside_bottom_9_" fill="url(#surface_center_inside_bottom_1_)" points="137.145,620.04 68.572,578.837 0,620.04 68.572,661.233"/>

    <linearGradient id="surface_right_inside_side_1_" gradientUnits="userSpaceOnUse" x1="178.8889" y1="600.1787" x2="33.103" y2="517.9229">
        <stop  offset="0" style="stop-color:#FFFFFF"/>
        <stop  offset="0.9816" style="stop-color:#A3A5A8"/>
    </linearGradient>
    <polygon id="surface_right_inside_side_3_" fill="url(#surface_right_inside_side_1_)" points="136.526,620.374 68.359,578.501 68.572,493.837 137.358,535.37"/>

    <linearGradient id="surface_right_inside_side_2_" gradientUnits="userSpaceOnUse" x1="126.2664" y1="563.249" x2="-28.4" y2="621.916">
        <stop  offset="0" style="stop-color:#FF0000"/>
        <stop  offset="0.6698" style="stop-color:#00FFFF"/>
        <stop  offset="1" style="stop-color:#FF0000"/>
    </linearGradient>
    <polygon id="surface_right_inside_side_5_" fill="url(#surface_right_inside_side_2_)" points="68.573,661.239 0,620.036 0,535.036 68.573,576.231"/>

    <linearGradient id="surface_center_outside_top_1_" gradientUnits="userSpaceOnUse" x1="167.3728" y1="533.5059" x2="-47.9608" y2="536.8394">
        <stop  offset="0.0016" style="stop-color:#FF0000"/>
        <stop  offset="0.6735" style="stop-color:#00FFFF"/>
        <stop  offset="1" style="stop-color:#FF0000"/>
    </linearGradient>
    <polygon id="surface_center_outside_top_3_" fill="url(#surface_center_outside_top_1_)" points="137.145,535.041 68.572,493.837 0,535.041 68.572,576.233"/>
</g> 
```

And here's the SVG code for the smaller one, which I need to expand:

```
<g>
    <linearGradient id="surface_right_inside_side_4_" gradientUnits="userSpaceOnUse" x1="273.4377" y1="319.251" x2="78.0696" y2="209.0197">
        <stop  offset="0" style="stop-color:#FFFFFF"/>
        <stop  offset="0.9816" style="stop-color:#A3A5A8"/>
    </linearGradient>
    <polygon id="surface_right_inside_side_9_" fill="url(#surface_right_inside_side_4_)" points="205.112,366.797 136.945,324.924 137.157,156.261 205.731,197.464"/>

    <linearGradient id="SVGID_1_" gradientUnits="userSpaceOnUse" x1="247.2952" y1="408.1992" x2="-103.1108" y2="356.7538">
        <stop  offset="0" style="stop-color:#FFFFFF"/>
        <stop  offset="0.8528" style="stop-color:#CCCCCC"/>
        <stop  offset="0.9954" style="stop-color:#CCCCCC"/>
    </linearGradient>
    <polygon fill="url(#SVGID_1_)" points="205.731,366.465 137.157,325.262 0.021,407.536 68.592,448.729"/>

    <linearGradient id="surface_right_inside_side_7_" gradientUnits="userSpaceOnUse" x1="160.3313" y1="296.623" x2="-52.0119" y2="377.1676">
        <stop  offset="0" style="stop-color:#FF0000"/>
        <stop  offset="0.6698" style="stop-color:#00FFFF"/>
        <stop  offset="1" style="stop-color:#FF0000"/>
    </linearGradient>
    <polygon id="surface_right_inside_side_6_" fill="url(#surface_right_inside_side_7_)" points="68.532,448.767 0,407.497 0.021,238.536 68.592,279.729"/>

    <linearGradient id="SVGID_2_" gradientUnits="userSpaceOnUse" x1="248.4749" y1="215.7417" x2="-75.5139" y2="220.7572">
        <stop  offset="0.0016" style="stop-color:#FF0000"/>
        <stop  offset="0.6735" style="stop-color:#00FFFF"/>
        <stop  offset="1" style="stop-color:#FF0000"/>
    </linearGradient>
    <polygon fill="url(#SVGID_2_)" points="205.731,197.464 137.157,156.261 68.592,197.333 0.021,238.536 68.592,279.729"/>
</g> 
```

**@dignifiedquire take on this problem**

I've implemented @dignifiedquire suggested algo in a test site: [Here's the test link](http://9ball.me/svg_update/svg_version.php). I did the absolute to relative conversion on my own and it just shows the same result I would have normally adding the same polygon x and y change values to the gradient x and y. That is the main issue - how to translate those values into such value, that transform the gradient as in my examples above?

More help is needed.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-14T19:14:52.723

**更新 3 替代想法**

另一种解决方案是根据梯度的两个端点计算百分比值。
在这张图片中，您可以看到原始多边形`abcd`、它的边界框`a'b'c'd'`和渐变`g1g2`。现在的目标是首先计算两个点`g1`的`g2`绝对值，然后计算这两个点的相对值。

![边界框](../Images/ea44c8912f73dace40afa7db7c2b95e3.png)

我推导出了一种算法，它可以完成我所描述的大部分内容，但它未能计算梯度和边界框之间的交集。我对如何解决这个问题有一个想法，但现在不是实施它的时候，所以我列出了相应的步骤。
基本思想是测试梯度是否与通过边界框角的线之一相交（`a'b'`、`b'c'`、`c'd'`、`d'a'`），然后测试相交是否在所讨论的边缘上。现在有两种特殊情况需要处理。1\. 梯度是垂直的，这意味着它的斜率是无穷大 2\. 有问题的边是垂直的，这意味着它的斜率是无穷大 所有其他情况都可以用基本数学轻松解决（一条线的两点形式，两条线的交点）。

*我的算法*

```
_ = require('underscore')    

function intersectGradientWithPolygon(polygon, gradient){
  var sides = [
    ["a", "b"],
    ["b", "c"],
    ["c", "d"],
    ["d", "a"]
  ];

  var boundingBox = calculateBoundingBox(polygon);

  // intersect each side of the bounding box with the gradient
  var intersections = _.map(sides, function(side){
    var intersection = intersect(boundingBox[side[0]], boundingBox[side[1]], gradient.a, gradient.b);
    if(intersection){
      // calculate the percentages
      console.log(JSON.stringify(intersection));
      return calcPercentage(intersection, boundingBox);
    }
  });

  return intersections;

}

function Point(x,y){
  this.x = x;
  this.y = y;
}

function calcPercentage(intersection, boundingBox){
  var lengthX = (boundingBox.max.x - boundingBox.min.x),
      lengthY = (boundingBox.max.y - boundingBox.min.y),
      x = (intersection.x / lengthX) * 100,
      y = (intersection.y / lengthY) * 100;
}

function calculateBoundingBox(polygon){
  var xValues = _.pluck(polygon, 'x'),
      yValues = _.pluck(polygon, 'y'),
      maxX = _.max(xValues),
      maxY = _.max(yValues),
      minX = _.min(xValues),
      minY = _.min(yValues);

  return {
    "a": new Point(minX, maxY),
    "b": new Point(maxX, maxY),
    "c": new Point(maxX, minY),
    "d": new Point(minX, minY),
    "max": new Point(maxX, maxY),
    "min": new Point(minX, minY)
  };
}
// tests if the two lines a1, b1 and a2, b2 intersect and 
// returns the point of intersection if the do so
function intersect(a1, b1, a2, b2){

  var s = new Point( );

  // TODO
  // This is the part that is missing
  // one needs to implement what I described above at this point
  //

  if (isInIntervall(s.x, a1.x, b1.x) && isInIntervall(s.y, a2.y, b2.y)){
    return s;
  }
  else {
    return false;
  }
}

// test if a point is in the intervall [a,b]
function isInIntervall(point, a, b){
  return (point >= a) && (point <=b);
} 
```

**更新 2**

> **问题：**如果多边形在空间中作为一个整体移动而不是拉伸，梯度坐标应该如何变化？
> 
> **答案：**您计算在 x 和 y 中移动多边形的一个点的量，并将渐变的点移动完全相同的量。

我现在将算法更改为基于在多边形的一侧按绝对单位数量进行缩放。我还创建了一个图像来解释算法的作用

1.  原始多边形
2.  通过输入确定的比例因子缩放多边形
3.  将多边形移回原来的位置

![解释](../Images/49b4665e92271f2fce66df7e151bc8d7.png)

**更新 15.7.2012** 我已经根据我提出的使用转换矩阵进行转换的想法推导出了一个算法。我没有时间测试它，但代码在 node.js 下运行，如果您在文档中包含[underscore.js](http://underscorejs.org)和[sylvester](http://sylvester.jcoglan.com/)（矩阵操作），则应该在浏览器中运行。

**设置**

```
/* underscore for some helper methods
 * http:*http:*underscorejs.org
 */
_ = require("underscore");  

/* matrix operations
 * http:*sylvester.jcoglan.com
 */
require("sylvester"); 
```

**输入**

```
var gradient = {
  "a":{
    "x": 165.3425,
    "y": 39.7002
  },
  "b":{
    "x": -49.991,
    "y": 43.0337 
  }
};

var polygon = {
  "a": {
    "x": 137.145,
    "y": 41.204
  },
  "b": {
    "x": 68.572,
    "y": 0
  },
  "c": {
    "x": 0,
    "y": 41.204
  },
  "d": {
    "x": 68.572,
    "y": 82.396
  }
};
// the scales are now absolute values in the same units as the coordinates
var scaleAbsX = 100;
var scaleAbsY = 100 * Math.tan( 62/2 * (Math.PI/180) );

// this describes the side that is scaled
var side = ["a", "b"]; 
```

**算法**

```
scalePolyWithGradient = function(polygon, gradient, scaleAbsX, scaleAbsY, side){
  // 1\. Scale by factor: derive factor from input scaling and then translate into scaling matrix
  // 2\. Apply scale to the gradient
  // 3\. Translate both back 

  // create a scaling matrix based of the input scales

  // get the two points of the scaled side
  var point1 = polygon[side[0]],
      point2 = polygon[side[1]];
  // scale these points
  var scaledPoint1 = { "x": point1.x + scaleAbsX,
                       "y": point1.y + scaleAbsY },
      scaledPoint2 = { "x": point2.x + scaleAbsX,
                       "y": point2.y + scaleAbsY };

  // calculate the relative scales
  var scaleRelX = scaledPoint1.x / point1.x,
      scaleRelY = scaledPoint1.y / point1.y;

  // create the scale matrix
  var scaleMatrix = $M([ [scaleRelX, 0],
                     [0, scaleRelY] ]);

  // scale both the polygon and the gradient
  // we iterate so that the translation is done on every point
  var scale = function(point){
    // convert the point into a matrix
    point = $M([[point.x], 
                [point.y]]);

    // scale
    var newPoint = scaleMatrix.multiply(point);

    return { "x": newPoint.elements[0][0],
             "y": newPoint.elements[1][0]};
  };

  var newPolygon  = {},
      newGradient = {};

  _.each(polygon, function(point, key){
    newPolygon[key] = scale(point);
  });
  _.each(gradient, function(point, key){
    newGradient[key] = scale(point);
  });

  // calculate the translation to move them to the original position
  // and move them back

  // we know that the points to move to their original position are the
  // ones not in the scale side
  var sides = _.keys(polygon),                   // all possible sides
      movePoints = _.difference(sides, side),    // the points not used in the scale
      point = movePoints[0];                     // the first of these points

  // we use these points to create the translation
  var oldPoint = polygon[point],
      newPoint = newPolygon[point];
  var translateMatrix = $M([ [newPoint.x - oldPoint.x],
                             [newPoint.y - oldPoint.y] ]);

  var translate = function(point){
    // convert the point into a matrix
    point = $M([[point.x], 
                [point.y]]);

    // translate
    var newPoint = point.add(translateMatrix);

    return { "x": newPoint.elements[0][0],
             "y": newPoint.elements[1][0]};
  };
  // apply the translation
  _.each(newPolygon, function(point, key){
     newPolygon[key] = translate(point);
   });
   _.each(newGradient, function(point, key){
     newGradient[key] = translate(point);
   });

  // return the new coordinates
  return [newPolygon, newGradient];
};
// apply the algorithm
var newPolygon, newGradient = null;
var result = scalePolyWithGradient(polygon, gradient, scaleAbsX, scaleAbsY, side);
newPolygon = result[0];
newGradient = result[1]; 
```

**结果**

```
 newPolygon = { "a": {
                   "x": 178.2885,
                   "y":82.405 
                 },
                 "b": {
                   "x": 96.00089999999999,
                   "y": 20.598999999999997
                 },
                 "c": {
                   "x": 13.714500000000001,
                   "y": 82.405
                 },
                 "d": { 
                   "x": 96.00089999999999,
                   "y":144.19299999999998
                 }
               }
 newGradient = { "a": {
                   "x": 212.12550000000005,
                   "y":80.14930000000001
                 },
                 "b": {
                     "x": -46.274699999999996,
                     "y": 85.14955
                 }
               } 
```

**旧答案**

[图片在这里](https://www.evernote.com/shard/s130/sh/04be966e-143a-46f7-b92a-8cf5df2f656a/fb0edaeebe3cb6a2514da63ea846c8dd/res/fba6488f-3d14-4dc4-bb18-e57cd42805e1/scaling_concept-20120714-210224.png.jpg)是因为我无法将图片上传到 stackoverflow（声誉很低）

我抽象了多边形的边，所以我们可以专注于它。左图是缩放前。现在我已经绘制了“整体”渐变来显示需要缩放的内容。为了找出所需的坐标，只需按与多边形边相同的比例缩放梯度的平方。

我知道这张图片没有旋转，但这种方法可以扩展为也包含它。

我可以为这些东西推导出算法，但还没有时间这样做。因此，如果这是您想要的，请告诉我，我明天会处理。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-09T18:13:02.547

您可以将转换应用于渐变，这意味着您可以执行诸如`gradientTransform="rotate(45)`. 这解决了您的轮换问题。

您应该使用相对单位并将用户空间设置为，`objectBoundingBox`以便`x`和`y`值对应于多边形的尺寸。你的 svg 看起来像这样。

```
<svg xmlns="http://www.w3.org/2000/svg" version="1.1">
  <linearGradient id="top_surface_2_gradient" gradientUnits="objectBoundingBox" x1="0%" y1="0%" x2="100%" y2="100%" gradientTransform="rotate(0 0.5 0.5)">
    <stop  offset="0" style="stop-color:#000"/>
    <stop  offset="1" style="stop-color:#fff"/>
  </linearGradient>
  <polygon id="top_surface_2" fill="url(#top_surface_2_gradient)" points="205.788,215.557 137.215,174.354 0.078,256.629 68.649,297.823"/>
</svg>​ 
```

您可以在这里测试它在不同大小的多边形上的工作方式：http: [//jsfiddle.net/hqXx2/](http://jsfiddle.net/hqXx2/)

# asp.net - Selective Explicit Loading in WCF Data Service

> ID：11399012
> 
> 赞同：1
> 
> 时间：2012-07-09T16:11:01.657
> 
> 标签：asp.net, entity-framework, wcf-data-services

I'm about to implement a web service for my database, perhaps using WCF Data Services. Some of the objects I need to make available have child objects that need to be present for the objects to be useful. But because of lazy loading in the Entity Framework, those child objects are not going to be automatically loaded.

I'm going to be calling this service using JSON, and I don't want to have to specify the [$expand option](http://msdn.microsoft.com/en-us/library/ee358709.aspx) in each call. And it's not clear to me where I would use the LoadProperty method (same link), since I'm just writing the `InitializeService` method and letting the framework do the rest.

Is there a way to configure it to explicitly load some child objects and not others?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:58:00.660

WCF 数据服务当前不支持服务器上的自动扩展。客户总是不得不要求扩展。

通过修改传入的请求，您可以围绕 WCF DS 实施某种解决方法。因此，例如，如果客户端发送对 ~/Products 的请求，您可以在它到达 WCF DS 之前对其进行修改并让它处理 ~/Products&$expand=Category，这样可以有效地实现自动扩展。但是要使这样的服务变得健壮，您必须解析查询 URL，并且只有在其中还没有扩展时才添加扩展，依此类推。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:19:51.263

另一种方法是，如果子对象总是需要存在，我们可以使子对象复杂类型而不是实体，以便它们始终与父对象一起出现。子对象是单个实体是否有充分的理由？

希望这可以帮助。

谢谢普拉蒂克

# perl - 我的 MyConfig.pm 有什么问题？

> ID：11399016
> 
> 赞同：0
> 
> 时间：2012-07-09T16:11:17.050
> 
> 标签：perl, cpan

我正在尝试在我的用户本地安装 perl 模块 - 我没有 root 访问权限。我在我的目录结构中为 perl 库设置了以下位置：/dasd/home/miner/perl5lib/lib/lib（不要问） - 我想要我的 perl 模块。

我将愚蠢地发布我的整个 MyConfig.pm - 我认为只有 make_arg、make_install_arg 和 make_pl_arg 很重要，但我认为其中存在我的问题：我不确定 cpan 究竟是如何工作的（并且不能轻易地用谷歌搜索它）所以我不知道 MyConfig.pm 中参数的确切意义。

```
 'build_dir' => q[/dasd/home/miner/.cpan/build],
 'cache_metadata' => q[1],
 'cpan_home' => q[/dasd/home/miner/.cpan],
 'dontload_hash' => {  },
 'ftp' => q[/usr/kerberos/bin/ftp],
 'ftp_proxy' => q[],
 'getcwd' => q[cwd],
 'gpg' => q[/usr/bin/gpg],
 'gzip' => q[/bin/gzip],
 'histfile' => q[/dasd/home/miner/.cpan/histfile],
 'histsize' => q[100],
 'http_proxy' => q[],
 'inactivity_timeout' => q[0],
 'index_expire' => q[1],
 'inhibit_startup_message' => q[0],
 'keep_source_where' => q[/dasd/home/miner/.cpan/sources],
 'links' => q[/usr/bin/links],
 'make' => q[/usr/bin/make],
 'make_arg' => q[LIB= dasd/home/perl5lib/lib/lib PREFIX=~/perl5lib],
 'make_install_arg' => q[LIB= dasd/home/perl5lib/lib/lib],
 'makepl_arg' => q[PREFIX=~/perl5lib LIB=/dasd/home/perl5lib/lib/lib   INSTALLMAN1DIR=~/perl5lib/man1 INSTALLMAN3DIR=~/perl5lib/man3],
 'ncftp' => q[], 
```

为了进一步解释，例如，我运行“cpan MongoDB”，我得到了很多输出，都尖叫着一堆错误，它都死于这个错误：

```
Checking if your kit is complete...
Looks good
Writing Makefile for File::Slurp
Writing MYMETA.yml and MYMETA.json
make: *** No rule to make target `dasd/home/perl5lib/lib/lib'.  Stop.
  /usr/bin/make LIB= dasd/home/perl5lib/lib/lib PREFIX=~/perl5lib -- NOT OK
Running make test
  Can't test without successful make
Running make install
  make had returned bad status, install seems impossible
Running make for K/KR/KRISTINA/MongoDB-0.45.tar.gz
  Is already unwrapped into directory /dasd/home/miner/.cpan/build/MongoDB-0.45 
```

CPAN.pm：将构建 K/KR/KRISTINA/MongoDB-0.45.tar.gz

```
make: *** No rule to make target `dasd/home/perl5lib/lib/lib'.  Stop.
  /usr/bin/make LIB= dasd/home/perl5lib/lib/lib PREFIX=~/perl5lib -- NOT OK
Running make test
  Can't test without successful make
Running make install
  make had returned bad status, install seems impossible 
```

“No rule to make target `dasd/home/perl5lib/lib/lib' 是什么意思？我不想制作那个目录......我想让 cpan 在他们说“为File::Slurp”。我想我想放在 /dasd/home/perl5lib/lib/lib 目录中。我假设我们正在做 File::Slurp，因为 MongoDB 在某种程度上依赖它。

我希望我有更好的方式来表达这个问题 - 但简而言之，这里是：教我这一切意味着什么 - MyConfig.pm 如何更改为我想要的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T16:24:32.957

“No rule to make target `dasd/home/perl5lib/lib/lib'”意味着你在`LIB=`and之间放置一个空格`dasd/home/perl5lib/lib/lib`（当它应该是 a 时`/`），使它们成为单独的参数。`make`认为这`dasd/home/perl5lib/lib/lib`是您希望它构建的文件的名称，但它不知道如何构建。

我首先在文本编辑器中编辑 MyConfig.pm，然后搜索`LIB= dasd`并将其替换为`LIB=/dasd`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:10:39.093

你说你的库存储在`/dasd/home/miner/perl5lib/lib/lib`你的配置文件中有`dasd/home/perl5lib/lib/lib`.

你似乎需要一个领导者`/`和一个`/miner`步骤。

# mongodb - Mongo - how do I find the install path of where the data is for the mongo database?

> ID：11399019
> 
> 赞同：1
> 
> 时间：2012-07-09T16:11:33.233
> 
> 标签：mongodb, mongorestore

I am trying to do a mongorestore command and I am not sure how to find the directory of where the data is.

The command is something like this:

```
mongorestore -v --db new_db_dump [path to the dump directory] 
```

and I am not sure how to find where on my local computer the current dump is so I don't know what the `[path to the dump directory]` is supposed to be.

Any ideas for how to find it? I am on a mac.

Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T19:20:17.600

默认情况下，mongodump 将其输出放在当前工作目录中名为“dump”的子目录中。如果您在执行 mongodump 时忘记了您所在的位置，请尝试在 finder 中搜索“dump”，查看名为“dump”的结果文件夹，并检查其内容。每个数据库的“转储”内都会有一个子目录。

# objective-c - SplitView-Based App: Display an independant view

> ID：11399020
> 
> 赞同：0
> 
> 时间：2012-07-09T16:11:42.213
> 
> 标签：objective-c, uiview, uisplitviewcontroller

I have a splitview-based app, that has a popover menu containing 3 views. I would like to add another view, that doesn't appear in the popover menu, and is displayed when a different button is clicked.

![enter image description here](../Images/7ebf443dc5891a4ac911689546ae6762.png) Here is a screenshot, with the popover menu, and the 'Log' button which I want to use to display my new view.

All of the other views are configured something like this:

```
 UIViewController <SubstitutableDetailViewController> *detailViewController = nil;

    if (row == 0) {
        FirstDetailViewController *newDetailViewController = [[FirstDetailViewController alloc] initWithNibName:@"FirstDetailView" bundle:nil];
        detailViewController = newDetailViewController;
    }

    ...

    NSArray *viewControllers = [[NSArray alloc] initWithObjects:self.navigationController, detailViewController, nil];
    splitViewController.viewControllers = viewControllers;
    [viewControllers release]; 
```

I tried to replicate this code for my new view:

```
-(void)displayLogView{

    UIViewController <SubstitutableDetailViewController> *detailViewController = nil;

    LogDetailViewController *newDetailViewController = [[LogDetailViewController alloc] initWithNibName:@"LogDetailViewController" bundle:nil];
    detailViewController = newDetailViewController;

    // Update the split view controller's view controllers array.
    NSArray *viewControllers = [[NSArray alloc] initWithObjects:self.navigationController, detailViewController, nil];
    splitViewController.viewControllers = viewControllers;
    [viewControllers release];

    [detailViewController release];
} 
```

But nothing happens. I think that I am missing the code to actually display the view. I tried to find how the other views were displayed, but could not find anything (I got the code from the apple sample code).

Any help would be appreciated!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T18:29:49.543

如果您只想要一个幻灯片视图，请尝试使用`presentModalViewController`它来显示它并`dismissModalViewController`摆脱它。

# python - Cases where use of tuple is a must

> ID：11399026
> 
> 赞同：20
> 
> 时间：2012-07-09T16:12:15.880
> 
> 标签：python, list, tuples

In Python, the only difference between a list and a tuple that I know of is **"lists are mutable but tuples are not"**. But as far as I believe, it depends on whether the coder wants to risk mutability or not.

So I was wondering whether there are any cases where the use of a tuple over a list is a must. Things that can not be done with a list but can be done with a tuple?

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-07-09T16:14:27.920

您可以将元组用作字典中的键并将元组插入集合中：

```
>>> {}[tuple()] = 1
>>> {}[list()] = 1 
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: unhashable type: 'list' 
```

这基本上是 a`tuple`是可散列的而 a`list`不是的结果：

```
>>> hash(list())
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: unhashable type: 'list'
>>> hash(tuple())
3527539 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-07-09T16:34:01.223

@Otto 的回答非常好。我唯一要补充的是，当您打开第 3 方扩展程序时，您确实需要查阅文档。某些函数/方法可能需要一种或另一种数据类型（或根据您使用的数据类型而产生不同的结果）。一个例子是使用元组/列表来索引一个 numpy 数组：

```
import numpy as np
a=np.arange(50)
a[[1,4,8]] #array([1, 4, 8])
a[(1,4,8)] #IndexError 
```

**编辑**

此外，快速计时测试表明创建元组比创建列表快得多：

```
import timeit
t=timeit.timeit('[1,2,3]',number=10000000)
print (t)
t=timeit.timeit('(1,2,3)',number=10000000)
print (t) 
```

记住这一点很好。换句话说，做：

```
for num in (8, 15, 200):
    pass 
```

代替：

```
for num in [8, 15, 200]:
    pass 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-10T01:04:09.110

此外，现在使用运算符的过时字符串格式`%`要求参数列表是一个元组。列表将被视为单个参数：

```
>>> "%s + %s" % [1, 2]
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: not enough arguments for format string
>>> "%s + %s" % (1, 2)
'1 + 2' 
```

# spring-mvc - Can Spring-Security control Html+JQuery+Json+SpringRoo project?

> ID：11399030
> 
> 赞同：1
> 
> 时间：2012-07-09T16:12:47.410
> 
> 标签：spring-mvc, spring-security, spring-roo

I'm using HTML+JQuery as UI, Spring-Roo to generate service layer which contains Json object string conversion. It works well for us like the following sample code:

```
@RequestMapping(headers = "Accept=application/json")
@ResponseBody
public ResponseEntity<String> ArticleController.listJson() {
    HttpHeaders headers = new HttpHeaders();
    headers.add("Content-Type", "application/json; charset=utf-8");
    List<Article> result = Article.findAllArticles();
    return new ResponseEntity<String>(Article.toJsonArray(result), headers, HttpStatus.OK);
} 
```

but after several sample pages developed, I have some questions:

1) We want to use Spring-Security as Access Control module, is that OK for this framework? How can server knows it is the same session request from the browser?

2) Instead of jsp server technology, pure HTML + JQuery is really OK? Because I see many Ajax code injected in the html, and many of them cannot be reused. As we know server technologies have the template that can maximizing the reusage of code. I'm worrying about the develop difficulty and maintenance efforts.

```
PS: Why we decided using HTML+JQuery+Json is because we directly get HTML+CSS from Art designer, 
and we have plan to support different client besides browser, so Json might be a good choice. 
```

Thanks.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:20:56.300

> 1）我们想使用 Spring-Security 作为访问控制模块，[...] 服务器如何知道它是来自浏览器的同一个会话请求？

首先，会话必须以某种方式在服务器端建立。使用标准 Spring Security 登录屏幕或`spring_security_login`使用[ajax](/questions/tagged/ajax "显示标记为“ajax”的问题")调用。作为回报，服务器将发送一个带有 JSESSIONID 的 cookie。这个 cookie 与每个后续请求（包括 AJAX 请求）一起发送，因此服务器知道哪个用户调用了 REST 方法。这是完全透明的。

此外，当您注销（通过调用`j_spring_security_logout`）时，会话和 cookie 都会被销毁。

我们成功地使用了这种方法（此外，由于历史原因，我们从 JavaScript 调用[肥皂](/questions/tagged/soap "显示标记为“肥皂”的问题")服务！）并且效果非常好。

> 2) [...]纯 HTML + JQuery 真的可以吗？因为我在html中看到很多Ajax代码注入，而且很多不能复用。[...]

真正的关注点分离才是王道。将 JavaScript 保存在一个位置 ( `.js`) 文件，将 HTML 保存在另一个位置 ( `.html`)。它们不应该混合在一起。还要让您的 JavaScript 代码分层并尽可能远离 DOM 操作（例如使用客户端模板引擎）。

此外，没有什么可以阻止您在构建过程中生成 HTML，因此每个页面中都包含常见的 HTML 片段，例如页眉和页脚。

# python - SQLAlchemy inheritance with relationship is None in instantiated object

> ID：11399033
> 
> 赞同：2
> 
> 时间：2012-07-09T16:12:57.497
> 
> 标签：python, sqlalchemy, mixins, single-table-inheritance

I would like to have a 'relationship' in an inherited (mixin) class.

However, when I create the inherited object, the relationship object is None. I cannot append to it.

How do I resolve this?

Here is code based upon the [documentation](http://docs.sqlalchemy.org/en/rel_0_7/orm/extensions/declarative.html#mixing-in-relationships)

```
from sqlalchemy import Column, Integer, String, DateTime, Boolean, BigInteger, Float
from sqlalchemy import ForeignKey
from sqlalchemy.orm import relationship, backref
from sqlalchemy.ext.declarative import declared_attr
from sqlalchemy.ext.declarative import declarative_base

Base = declarative_base()
class Target(Base):
    __tablename__ = "target"
    id = Column(Integer, primary_key=True)

class RefTargetMixin(object):
    @declared_attr
    def target_id(cls):
        return Column('target_id', ForeignKey('target.id'))

    @declared_attr
    def target(cls):
        return relationship("Target",
            primaryjoin="Target.id==%s.target_id" % cls.__name__
        )

class Foo(RefTargetMixin, Base):
    __tablename__ = 'foo'
    id = Column(Integer, primary_key=True)

print repr(RefTargetMixin.target)
print repr(Foo.target)
print repr(Foo().target) 
```

The output is:

```
<sqlalchemy.orm.properties.RelationshipProperty object at 0x24e7890>
<sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x24e7690>
None 
```

In general, I should be able to append to the relationship object (target), but here I cannot because it is None. Why?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T16:55:53.180

值为 None 的原因是因为您已将其定义为多对一关系。多对一，from parent-to-child，意思是在parent上有一个外键，只能指一个也只有一个孩子。如果您希望类的某些东西`RefTargetMixin`引用项目的集合，那么外键必须在远程端。

因此，这里的目标是使作为 RefTargetMixin 子类的任何对象成为 Target 的潜在父级。这种模式称为[多态关联模式](http://techspot.zzzeek.org/2007/05/29/polymorphic-associations-with-sqlalchemy/)。虽然在许多 ORM 工具包中通过在 Target 上声明“多态外键”来提供这一点很常见，但这并不是一个好的关系实践，因此答案是以某种方式使用多个表。SQLAlchemy 核心在 examples/generic_association 文件夹中为此提供了三种方案，包括“带鉴别器的单个关联表”、“每个关联的表”和“每个相关的表”。每个模式在此处为 RefTargetMixin 提供相同的声明模式，但表的结构会发生变化。

例如，这是您使用“每个关联表”的模型，在我看来，如果您不需要一次查询多种类型的 RefTargetMixin 对象，它往往会扩展得最好（请注意，我按原样使用了该示例，只是更改了名字）：

```
from sqlalchemy.ext.declarative import declarative_base, declared_attr
from sqlalchemy import create_engine, Integer, Column, \
                    String, ForeignKey, Table
from sqlalchemy.orm import Session, relationship

class Base(object):
    """Base class which provides automated table name
    and surrogate primary key column.

    """
    @declared_attr
    def __tablename__(cls):
        return cls.__name__.lower()
    id = Column(Integer, primary_key=True)
Base = declarative_base(cls=Base)

class Target(Base):
    pass

class RefTargetMixin(object):
    @declared_attr
    def targets(cls):
        target_association = Table(
            "%s_targets" % cls.__tablename__,
            cls.metadata,
            Column("target_id", ForeignKey("target.id"),
                                primary_key=True),
            Column("%s_id" % cls.__tablename__,
                                ForeignKey("%s.id" % cls.__tablename__),
                                primary_key=True),
        )
        return relationship(Target, secondary=target_association)

class Customer(RefTargetMixin, Base):
    name = Column(String)

class Supplier(RefTargetMixin, Base):
    company_name = Column(String)

engine = create_engine('sqlite://', echo=True)
Base.metadata.create_all(engine)

session = Session(engine)

session.add_all([
    Customer(
        name='customer 1',
        targets=[
            Target(),
            Target()
        ]
    ),
    Supplier(
        company_name="Ace Hammers",
        targets=[
            Target(),
        ]
    ),
])

session.commit()

for customer in session.query(Customer):
    for target in customer.targets:
        print target 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:26:51.947

这是正常行为：Foo 有一个 Target。当你创建 Foo 对象时，它还没有 Target，所以 的`Foo().target`值为`None`。

如果你想让 Foo 有多个 Target，你应该`foo_id`在 Target 中放一个，而不是`target_id`在 Foo 中放一个，并使用 backref。

此外，在这种情况下，不需要指定主连接。

# c# - 尝试启动进程时发生 ThreadStateException

> ID：11399035
> 
> 赞同：0
> 
> 时间：2012-07-09T16:13:01.807
> 
> 标签：c#, multithreading, stack-overflow, thread-state

我正在尝试在堆栈大小增加到 10.000.000 的另一个线程中运行我的递归函数“hueckel_operator()”。首先，当我点击检测边缘按钮时会调用hueckel_operator。所以我在 detect_edges_click() 函数中创建了新线程

```
 private void detect_edges_Click(object sender, EventArgs e)
        {
             var stackSize = 20000000;
             Thread workerThread = new Thread(new ThreadStart(hueckel_operator), stackSize);                          
                workerThread.Start();

        }

public void hueckel_operator(int counter4, int counter5)
{

} 
```

但是我收到一个错误，因为“错误 22 'hueckel_operator' 没有重载匹配委托'System.Threading.ThreadStart'”

我可以通过哪种方式创建一个新线程来执行我的递归函数？

我应该更好地增加主线程的堆栈大小，而不是创建新线程？

或者我是在胡说八道，我应该继续阅读有关线程的更多信息吗？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T16:31:29.107

阅读[ThreadStart 的 MSDN](http://msdn.microsoft.com/en-us/library/system.threading.threadstart.aspx)，我们可以看到委托的签名是：

```
public delegate void ThreadStart() 
```

您的方法不尊重，因为它需要两个参数。

如果要传递参数，可以使用[ParameterizedThreadStart](http://msdn.microsoft.com/en-us/library/System.Threading.ParameterizedThreadStart.aspx)，但仍需要更改方法签名以接受单个`object`参数：

```
public void hueckel_operator(object param)
{
} 
```

然后，您可以将两个`int`参数封装在自定义类型中：

```
class ThreadParameter
{
     public int I { get; set; }
     public int J { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T16:20:43.103

您可能希望使用`new ParameterizedThreadStart(hueckel_operator)`安全，然后`workerThread.Start();`将参数传递到数组或列表中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T16:16:39.910

我认为您调用新线程的方式并不期望在函数中接收任何参数，因此它找不到您的函数。如果要将参数传递给新线程，则应使用对象数组并将其传递给函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T16:30:56.667

那是因为`ThreadStart`委托应该不带参数，但您的函数`hueckel_operator`需要两个。

要将参数传递给线程函数，只需使用 lambda 表达式将其传递给线程构造函数，如下所示：

```
public static void parametrized(int one, int two)
{
    //perform computation
} 
```

然后将其传递给包装在 lambda 表达式中的 Thread 构造函数：

```
int arg1 = 4;
int arg2 = 2;
Thread t = new Thread(new ThreadStart(() => parametrized(arg1, arg2))); 
```

该表达式`() => parametrized(arg1, arg2)`创建了一个不带参数的匿名函数（就像我们的 Thread 所期望的那样），然后使用提供的参数从其主体中简单地调用我们实际想要调用的函数。

# java - im4Java，改变框架颜色？

> ID：11399037
> 
> 赞同：1
> 
> 时间：2012-07-09T16:13:10.730
> 
> 标签：java, imagemagick, im4java

如何在 ImageMagick 4 Java 中更改框架颜色？我有这样的东西，但框架一直是白色的......

```
IMOperation miop = new IMOperation();
miop.background("#000000");
miop.addImage(path+fileName);
miop.colorize(5,21,64);
miop.frame(2); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T22:11:04.827

```
IMOperation miop = new IMOperation();    
miop.addImage(path+fileName);
miop.background("#000000");
miop.colorize(5,21,64);
miop.frame(2);
miop.addImage(newPath+fileName); 
```

解决方案。

# actionscript-3 - Can I make a mask grow via TweenLite in Action Script?

> ID：11399039
> 
> 赞同：0
> 
> 时间：2012-07-09T16:13:24.013
> 
> 标签：actionscript-3, animation, mask, gsap

I am working on a project with two images, a background(B) and a foreground(F).

My goal is to have (F) "burn away" to reveal (B). At the moment I am trying to do this with a circle shaped mask. I can get my mask to appear statically, but no matter what I try I cannot get the mask to grow to reveal more of (B). Any ideas? This is the code I have right now

```
var BackgroundBitmap:Bitmap = new Background();
addChild(BackgroundBitmap);

var BurnThroughBitmap:Bitmap = new BurnThrough();
addChild(BurnThroughBitmap);

drawCircle(); //creates circle "mycircle:MovieClip" with radius 100 at a predefined point

BurnThroughBitmap.mask = mycircle; //this sucessfully masks the two images, revealing the background

TweenLite.to(mycircle, 14, { scaleX:1.5, scaleY:1.5 } ); //this doesn't work :( 
```

Any suggestions or alternate methods?

Thank you!

# javascript - 推文按钮 Javascript

> ID：11399041
> 
> 赞同：0
> 
> 时间：2012-07-09T16:13:37.043
> 
> 标签：javascript, api, twitter

我正在尝试创建一个快捷功能，这样如果有人按下 Alt+T，他们就可以发布这篇文章。我已对快捷方式部分进行了排序，因此请忽略该部分，它只是在推特上发布页面的标题和 URL。这是我到目前为止所拥有的

```
<script type="text/javascript">
shortcut.add("Alt+T",function() {
window.open("https://twitter.com/intent/tweet?text=(document.title) - &url=(document.URL)&via=jamiebrittain")
});
</script> 
```

似乎`document.title`并`document.url`没有更改为页面标题和 URL。这都在一个脚本标签中，说明它是 javascript 那么为什么不改变或不工作`document.title`并且`document.url`不起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:15:34.240

代替

```
window.open("https://twitter.com/intent/tweet?text=(document.title) - &url=(document.URL)&via=jamiebrittain") 
```

做

```
window.open("https://twitter.com/intent/tweet?text="+encodeURIComponent(document.title)+"&url="+ encodeURIComponent(document.URL)+"&via=jamiebrittain") 
```

您需要将字符串与 javascript 变量连接起来，而不是内联使用它们。

感谢@Esailija 指出您也需要使用[`encodeURIComponent`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/encodeURIComponent) - 这可以确保变量在添加到字符串之前进行编码

# ruby-on-rails - Matching Array with Column of a Table

> ID：11399042
> 
> 赞同：0
> 
> 时间：2012-07-09T16:13:42.110
> 
> 标签：ruby-on-rails, database, postgresql, activerecord

I have an array of certain dates called `array_of_dates`.

And I have a table called `my_table` with columns 'date' and 'count'.

Is there a way I can write an active records query to match the 'date' column in `my_table` with `array_of_dates` and return hashes ? All **keys** being the dates from `array_of_dates`, and all the **values** being the 'count' from `my_table`; returning zero as the **value** if a date present in `array_of_dates` doesn't exist in column 'date' of `my_table`.

Thanks in advance.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:31:18.350

SQL 可能如下所示：

```
SELECT date_col AS key, count(t.date_col) AS value
FROM  (
   SELECT unnest('{2012-07-08, 2012-07-09, 2012-07-10}'::date[]) AS date_col
   ) x
LEFT   JOIN tbl t USING (date_col)
GROUP  BY date_col; 
```

关键元素是带有[`unnest()`](http://www.postgresql.org/docs/current/interactive/functions-array.html#ARRAY-FUNCTIONS-TABLE)和`LEFT JOIN`代替普通连接的子查询。

`values``0`如果没有找到匹配的日期，将是因为`count(t.date_col)`不计算`NULL`值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T18:07:01.450

尝试这个：

```
Model.select("date, count").
  where(:date => array_of_dates).
    reduce(Hash.new(0)){ |h, r| h[r.date] = r.count;h} 
```

# php - Folder cannot be moved in Wordpress

> ID：11399043
> 
> 赞同：0
> 
> 时间：2012-07-09T16:13:47.890
> 
> 标签：php, wordpress, wordpress-theming

Whenever I try to upload a theme through Wordpress it says:

> The uploaded file could not be moved to C:\wamp\www\tweet\wordpress/wp-content/uploads/2012/07.

I googled a lot and many peope suffer the same problem while upload the image in gallery, it is basically of permission but in my case I checked out the permissions very well.

If I try to upload any other theme it works well.

**Edit** I am wondering if there is concept of template in WP,I can see some files with extenion `.tpl`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T08:01:48.710

在我的“仪表板”页面的底部，我可以选择单击“立即重置选项”。当我这样做时，我就可以加载我的徽标了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:39:01.577

如果您的权限是完美的，但您仍然面临问题，那么唯一的方法是将压缩文件复制到主题文件夹中，然后从您的管理面板激活主题

# android - 不同屏幕尺寸Andengine Android上的精灵尺寸

> ID：11399045
> 
> 赞同：11
> 
> 时间：2012-07-09T16:13:55.160
> 
> 标签：android, andengine

` 我正在用 Android Adnengine 开发我的第一个游戏。这是一个从顶视图的赛车游戏。我使用了视差背景和一些汽车。我在宽度和高度较小的设备上对其进行了测试。

我根据相机的宽度，高度放置了32和高度64的汽车。它在我的屏幕尺寸上运行良好，但在更大的屏幕尺寸上，比如 Galaxy Tab，游戏中留下了巨大的空间，因为汽车尺寸保持不变，因为我必须以两个的幂来使用它们。

如何使用适合所有屏幕尺寸的图像？我是否必须根据不同相机宽度和高度的图像大小使用不同的图像？我确信有一个解决方案。

我已经修改了我的清单文件以支持 small、large 和 xlarge 尺寸。

```
 public Engine onLoadEngine() {

    final Display display = getWindowManager().getDefaultDisplay();
    CAMERA_WIDTH = display.getWidth();
    CAMERA_HEIGHT = display.getHeight();

    //Toast.makeText(getApplicationContext(), CAMERA_WIDTH, 3);

    mCamera = new Camera(0, 0, CAMERA_WIDTH, CAMERA_HEIGHT);
    engine = new Engine(new EngineOptions(true,
            ScreenOrientation.LANDSCAPE, new RatioResolutionPolicy(
                    CAMERA_WIDTH, CAMERA_HEIGHT), mCamera).setNeedsMusic(
            true).setNeedsSound(true));

    return engine;
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-10T11:23:30.873

使用比率分辨率策略的问题在于，您可以将游戏设计为特定尺寸，例如 800x480，这在当今的手机中非常流行。

我认为大多数人迷路的地方是认为他们需要拉出当前的显示宽度/高度并使用它来初始化引擎。

据我所知，比率分辨率策略的重点是将尺寸设置为硬编码值，并让比率分辨率策略处理从一台设备到另一台设备的差异。

```
CAMERA_WIDTH = 800;
CAMERA_HEIGHT = 480;

//Toast.makeText(getApplicationContext(), CAMERA_WIDTH, 3);

mCamera = new Camera(0, 0, CAMERA_WIDTH, CAMERA_HEIGHT);
engine = new Engine(new EngineOptions(true,
        ScreenOrientation.LANDSCAPE, new RatioResolutionPolicy(
                CAMERA_WIDTH, CAMERA_HEIGHT), mCamera).setNeedsMusic(
        true).setNeedsSound(true)); 
```

一旦你做了这样的事情，那么你只需要确保你的图形和间距在你预先选择的宽度/高度上看起来很好——在这个例子中是 800 x 480。如果一切正常，适合并且看起来不错，那么比率分辨率策略将当设备具有不同的屏幕尺寸时，请注意事项。

至少我对它应该如何工作的看法——我为 800 x 480 写作，而且在我的 7 英寸平板电脑上一切看起来也不错——当然这不是一个主要的延伸。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-09T16:18:02.913

获取设备的高度和宽度，然后以代数方式使精灵成为屏幕宽度和高度的百分比。

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T20:42:12.920

根据我的经验，我认为解决这个问题的最好方法是处理在大多数设备中流行的两种主要屏幕比例（5:4、5:3）。

您为每个比率选择一个高分辨率，如果设备屏幕尺寸较小，则让引擎按比例缩小。

# java - 如何 春季标签工作

> ID：11399047
> 
> 赞同：5
> 
> 时间：2012-07-09T16:14:22.500
> 
> 标签：java, xml, spring, collections, dependency-injection

我有一个收藏工具；在我的 SomeClass.java 中，我在我的 temp.xml 文件中声明了 SomeClass.java 类的 bean。在 xml 中，我将两个字符串对象添加到集合中。

我的问题是 Collection 是一个接口，所以我不能实例化它， List 也是一个接口，所以我认为我们做不到

```
 Collection<String> someCollection = new List<String>(); 
```

我想知道当我们在xml文件中使用list标签时java代码是如何工作的。意味着对象是否存储在链表或数组列表或某种类型的列表中？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-09T16:20:43.777

这取决于`ApplicationContext`. 每个实现都可能不同，但您可以确定结果是`List`. 编码[文档](http://springindepth.com/book/in-depth-ioc-collections.html)：

> 另一个自定义命名空间实用程序用于创建列表。第一个 bean 定义与 ListFactoryBean 示例相同，只是它更短且更易于阅读。第二个 bean 定义是相同的，只是它使用 list-class 属性来指定要使用的 List 实现。当不使用 list-class 属性时，ApplicationContext 将选择实现类。

```
<util:list id="messageUtilList">
    <ref bean="stringMessage01"/>
    <ref bean="stringMessage02"/>
    <value>Spring is fun to learn.</value>
</util:list>

<util:list id="messageUtilLinkedList" 
           list-class="java.util.LinkedList">
    <ref bean="stringMessage01"/>
    <ref bean="stringMessage02"/>
    <value>Spring is fun to learn.</value>
</util:list> 
```

检查你的[实现`ListFactoryBean`](http://www.jarvana.com/jarvana/view/org/springframework/spring-beans/3.1.0.RELEASE/spring-beans-3.1.0.RELEASE-sources.jar!/org/springframework/beans/factory/config/ListFactoryBean.java?format=ok)可以看到`ArrayList`如果没有提供特定的列表类型，这是默认的列表实现。执行此任务的代码是：

```
if (this.targetListClass != null) {
    result = (List) BeanUtils.instantiateClass(this.targetListClass);
}
else {
    result = new ArrayList(this.sourceList.size());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-30T21:14:31.237

对于，Spring IOC Container 使用 ArrayList 类来制作对象。同样，它使用 LinkedHashSet 和 LinkedHashMap。

# jquery - JqG rid 自定义函数编辑选项

> ID：11399053
> 
> 赞同：1
> 
> 时间：2012-07-09T16:14:41.840
> 
> 标签：jquery, jqgrid

我有一个带有自定义编辑选项的列的 jqgrid。

```
 editable: true,
      edittype: "custom",
      editoptions: { custom_element: itemFirstPaidElem, custom_value: itemFirstPaidValue 
```

下面是两个自定义函数：

```
function itemFirstPaidElem(value, options) {
    var el = "<label>" + value + "</label><a style='margin-left:10px' href='#' class='ItemFirstPaidPickValue' value='" + value + "'><img src='" + path + "/Content/Images/calendar_edit.png'/></a>";
    return el;
}

function itemFirstPaidValue(elem, operation, value) {
    if (operation === 'get') {
        var val = $(elem).text();
        return val;
    }
} 
```

我要做的是在用户完成行编辑时获取标签的内容。问题是对象 $(elem).text(); 总是未定义的。

我查看了 chrome 开发人员工具，我看到的是我需要的值包含在 prevObject 中。

![在此处输入图像描述](../Images/e2bef9f76df7dc27d4bd55f279bd96c5.png)

我试图调用 $(elem).prevObject.text() 但它不起作用，我不太确定它是什么。有人可以在这一点上帮助我。

预先感谢

# python - 将命令在fabric python中的Windows服务器上不起作用

> ID：11399056
> 
> 赞同：3
> 
> 时间：2012-07-09T16:15:01.667
> 
> 标签：python, python-2.7, fabric

我正在尝试使用结构 python 运行 put 命令。它在 Windows 服务器上不起作用。
但它在 linux 服务器上运行良好。我正在使用织物版本 1.4.1。

代码是：

```
def run_windows(local_path="C:\python27\dist",remote_path="\tmp"):
    put(local_path,remote_path) 
```

以下是错误消息：

```
Fatal error: put() encountered an exception while uploading 'C:\python27\dist'
Traceback (most recent call last):
File "C:\Python27\lib\site-packages\fabric-1.4.1-py2.7.egg\fabric\operations.p
y", line 383, in put
mirror_local_mode, mode)
File "C:\Python27\lib\site-packages\fabric-1.4.1-py2.7.egg\fabric\sftp.py", li
ne 265, in put_dir
self.mkdir(rcontext, use_sudo)
File "C:\Python27\lib\site-packages\fabric-1.4.1-py2.7.egg\fabric\sftp.py", li
ne 101, in mkdir`enter code here`
self.ftp.mkdir(path)
File "build\bdist.win32\egg\ssh\sftp_client.py", line 303, in mkdir
self._request(CMD_MKDIR, path, attr)
File "build\bdist.win32\egg\ssh\sftp_client.py", line 635, in _request
return self._read_response(num)
File "build\bdist.win32\egg\ssh\sftp_client.py", line 682, in _read_response
self._convert_status(msg)
File "build\bdist.win32\egg\ssh\sftp_client.py", line 710, in _convert_status
raise IOError(errno.EACCES, text)
IOError: [Errno 13] Permission denied"

command:fab -c env.fabricrc run_windows:hosts="1.2.2.3" 
```

日志也在服务器端生成：

```
2-02-2012 19:48:00 IP 1.6.15.1 administrator is making C:\Testing/\dist (C:\Program Files (x86)\freeSSHd\C:\Testing\dist\\dist) 
```

可能是什么问题？

# android - 如何开始一个不可见的活动，然后在准备好后使其可见？

> ID：11399061
> 
> 赞同：0
> 
> 时间：2012-07-09T16:15:25.397
> 
> 标签：android, android-activity

我想开始`B`活动`A`

但是`B`需要相当长的时间来初始化

所以我想延迟切换视图直到`B`准备好。

有没有办法开始一个不可见的活动`B`，然后在准备好时让它可见？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:19:27.917

为什么不尝试使用 AsyncTask。您可以按照以下步骤操作！！

1）启动 Activity B ，显示一个进度条，可以说“屏幕正在加载”。

2) 将您的屏幕加载到 AsyncTask 中。

3) 完成后移除进度条/对话框并显示屏幕，非常简单。

[AsyncTask 文档](http://developer.android.com/reference/android/os/AsyncTask.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:18:14.707

从活动 A 启动一个后台线程（例如 AsyncTask），它将进行初始化。当 AsyncTask 完成时，启动活动 B。

# asp.net-mvc - 如何使用asp.net mvc razor在视图中访问全局资源

> ID：11399068
> 
> 赞同：22
> 
> 时间：2012-07-09T16:15:53.553
> 
> 标签：asp.net-mvc, razor, localization, globalization

使用 ASP.NET MVC Razor，我有一个`App_GlobalResources`名为“Hello”和“Hello”以及“Hello”`General.resx`和`General.fr.resx`“Bonjour”的名称值对的资源文件。

我如何从我的角度参考这些？

这些不起作用：

```
@Html.Resource("General.Hello")
@Html.Resource("GlobalResources.Hello")
@Html.Resource("GlobalResources.General.Hello")
@Html.Resource("GlobalResources, General.Hello") 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-07-09T17:11:10.617

试试这个，

```
@Resources.General.Hello 
```

语法：*Resources.[ResourceName].[Property]*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-01-05T05:34:37.340

从视图中的资源文件中访问值

添加此名称空间

```
@using System 
```

然后像这样显示值

```
@ResourceFile.Address  //ResouceFile is the name of the ResouceFile 
```

当使用环境培养线时使用此方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-09T13:45:30.473

您需要参考您的命名空间：

```
@GeneralResxNamespace.General.Hello 
```

您可以通过将命名空间添加到 /Views/Web.config 文件以更简单的方式执行此操作。在具有命名空间的部分中添加以下部分：

```
<add namespace="*YourProjectNamespace*.*ResourcesNamespace*.Resources" /> 
```

然后，您可以使用没有命名空间的资源，如示例中所示：

```
General.Hello 
```

# javascript - Google Maps Geolocation API 的替代方案

> ID：11399069
> 
> 赞同：7
> 
> 时间：2012-07-09T16:16:00.867
> 
> 标签：javascript, json, google-maps, geolocation

我正在从事一个每秒涉及大量实时数据的项目（通过 websockets 实现）。因此，它无法处理调用 Google 的 API 来将 City + Region 转换为 longlat 坐标。我得到大约 1 到 100 的成功率。Google API 的“城市和地区”服务是否有无限制的替代方案？理想情况下是本地存储的此类数据的 JSON 数组？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-09T16:50:22.533

您可以使用 Yahoo 提供的称为 YQL 的服务。这项服务对有限数量的请求是免费的，每天最多 100,000 个。然后您可以从 .xml 的响应 XML 中检索纬度和经度`query/results/place/centroid`。

我注意到这项服务的一件事是城市名称需要准确，并且可能会有多个结果。

[http://developer.yahoo.com/yql/](http://developer.yahoo.com/yql/)

YQL 查询示例：

`http://query.yahooapis.com/v1/public/yql?q=SELECT * FROM geo.places WHERE text="Seattle" and placeTypeName = "Town"`

响应 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<query xmlns:yahoo="http://www.yahooapis.com/v1/base.rng" yahoo:count="1" yahoo:created="2012-07-09T16:20:40Z" yahoo:lang="en-US">
  <results>
    <place xmlns="http://where.yahooapis.com/v1/schema.rng" xml:lang="en-US" yahoo:uri="http://where.yahooapis.com/v1/place/2490383">
      <woeid>2490383</woeid>
      <placeTypeName code="7">Town</placeTypeName>
      <name>Seattle</name>
      <country code="US" type="Country">United States</country>
      <admin1 code="US-WA" type="State">Washington</admin1>
      <admin2 code="" type="County">King</admin2>
      <admin3/>
      <locality1 type="Town">Seattle</locality1>
      <locality2/>
      <postal/>
      <centroid>
        <latitude>47.603561</latitude>
        <longitude>-122.329437</longitude>
      </centroid>
      <boundingBox>
        <southWest>
          <latitude>47.422359</latitude>
          <longitude>-122.472153</longitude>
        </southWest>
        <northEast>
          <latitude>47.745071</latitude>
          <longitude>-122.176193</longitude>
        </northEast>
      </boundingBox>
      <areaRank>6</areaRank>
      <popRank>12</popRank>
    </place>
  </results>
</query>
<!-- total: 82 -->
<!-- engine5.yql.mud.yahoo.com --> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-09T16:21:45.647

看看 datasciencetoolkit.org。他们提供了一个 VM 映像/AMI，您可以将其托管在 EC2 上并对您自己的服务器进行地理定位调用，因此没有 API 限制。

还有雅虎的地理定位 API，它的限制比谷歌的要高。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-09T16:26:03.017

通常，当您处理大量数据点时，您会在服务器上对它们进行一次地理编码。然后，您可以将纬度/经度流式传输给准备使用的客户。

Google 有一个[地理编码网络服务](https://developers.google.com/maps/documentation/geocoding/)，您可以从您的服务器使用，但请求限制为每天 2,500 个。如果这不起作用，您还可以查看[OSM](http://www.openstreetmap.org/)的 Nominatim；Mapquest[托管](https://stackoverflow.com/a/10713355/201952)一个没有限制的网络服务。

# javascript - Javascript 缓存破坏在 Firefox 中没有产生结果

> ID：11399073
> 
> 赞同：1
> 
> 时间：2012-07-09T16:16:14.313
> 
> 标签：javascript, browser-cache

我对网络编程比较陌生，我已经不知疲倦地搜索了 2 天，以寻找与此问题相关的术语。

目前，我遇到了一个单一的测试客户端没有从服务器加载正确的 javascript 文件版本的问题。

我正在使用查询字符串中的服务器版本缓存这个文件，它适用于 chrome 和 IE 中的这个人，但由于某种原因，Firefox 正在使用旧文件。

当我查看 Web 控制台时，我看到它加载了正确的文件（查询字符串中包含正确的服务器版本），当我进入加载的文件时，我看到了所有正确的更新代码。

如果有人能阐明这个问题，我将不胜感激。

# javascript - 计算字段剔除相同的值

> ID：11399075
> 
> 赞同：1
> 
> 时间：2012-07-09T16:16:15.927
> 
> 标签：javascript, knockout.js

在 Knockout 中，我试图让一个输入字段自动格式化，这与此页面上 Writable Computed Observables 下的示例非常相似：

[http://www.knockmeout.net/2011/03/reacting-to-changes-in-knockoutjs.html](http://www.knockmeout.net/2011/03/reacting-to-changes-in-knockoutjs.html)

我遇到的问题是，如果您输入的值会转换为相同的值（例如 1.00 和 1.0），那么 Knockout 不会看到该值已更改并且不会更新格式（您可以使用他页面上的示例看看）。我创建了一个 hackjob 解决方案，我们将字段更改为不同的内容，然后将其更改回以触发 Knockout 中的更新，但我想知道是否有人有更合适的修复。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T17:35:13.480

曾经有一段时间，observables 在写入时总是会通知，即使您正在写入的值没有改变。由于我相信 KO 1.21，当实际值没有改变时，可观察对象会抑制通知。

简单的解决方案是您可以调用`valueHasMutated`observable 以确保发送通知。

编写计算的 observable 的更好方法是：

```
//writable computed to parse currency input 
this.editPrice = ko.computed({
    //return a formatted price
    read: function() {
        return viewModel.formatCurrency(this.price());
    },
    //if the value changes, make sure that we store a number back to price
    write: function(newValue) {
        var current = this.price(),
            valueToWrite = viewModel.parseCurrency(newValue);

        //only write if it changed
        if (valueToWrite !== current) {
            this.price(valueToWrite);
        } else {
            //if the rounded value is the same, but a different value was written, force a notification for the current field
            if (newValue !== current) {
                this.price.valueHasMutated();
            }
        }
    },
    owner: this
}); 
```

在这种情况下，我们只会在解析的值不同时写入 observable，并且只会在用户输入的值与当前值不同时强制通知。即使用户输入与当前价格四舍五入的值，这也会导致字段更新。

这是更新的示例：http: [//jsfiddle.net/rniemeyer/6A4aN/](http://jsfiddle.net/rniemeyer/6A4aN/)

# c++ - 在 C++ 中优化字符数组成员交换

> ID：11399076
> 
> 赞同：0
> 
> 时间：2012-07-09T16:16:20.220
> 
> 标签：c++

```
char buffer[256];

for(int x = 0; x<256; x+=4)
{
char one = buffer[x];
char two = buffer[x+1];
char three = buffer[x+2];
char four = buffer[x+3];

buffer[x] = four;
buffer[x+1]=three;
buffer[x+2]= two;
buffer[x+3]=one;
} 
```

我将如何优化这个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T16:20:48.667

使用`std::reverse`：

```
std::reverse(&buffer[x], &buffer[x + 4]); 
```

# perl - 在 perl 中处理项目级变量的最佳方法是什么

> ID：11399078
> 
> 赞同：1
> 
> 时间：2012-07-09T16:16:33.147
> 
> 标签：perl, oop

我被要求研究将一堆 ksh 脚本转换为 perl。现在所有系统变量都是从一个通用文件（url、数据库用户名等）中导出的。

我的问题是在 perl 中处理这些变量的最佳方法是什么？

PS。我喜欢使用 ini 文件的想法，但是我需要一个 ini 文件阅读库（这里的人不会喜欢）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T16:58:52.817

`MyConfig.pm`为了扩展我的评论，这里是一个导出两个常量的示例配置模块。

```
package MyConfig;

use strict;
use warnings;

use base 'Exporter';

our @EXPORT = ( qw/ URL USERNAME / );

use constant URL => 'http:/domain.com/';
use constant USERNAME => 'myuser';

1; 
```

以及使用它的程序文件

```
use strict;
use warnings;

use MyConfig;

print URL, "\n";
print USERNAME, "\n"; 
```

**输出**

```
http:/domain.com/
myuser 
```

如果您阅读有关[文档，`Exporter`](https://metacpan.org/module/Exporter)您将了解如何使用`@EXPORT_OK`和`%EXPORT_TAGS`对常量进行分类，并避免过多地污染调用包的命名空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:24:00.740

我会使用与您的 ksh 脚本类似的概念。

创建一个通用包文件，其中包含所有设置作为包`our`变量。例如`ProjConfig.pm`包含

```
package ProjConfig;

use strict;
use warnings;

our $BaseUrl = 'http://www.fred.com/';
our $DbName = 'TheDB';

1; 
```

然后，您的调用代码只需使用限定名称引用这些变量。例如`program.pl`包含

```
#!/usr/bin/perl

use strict;
use warnings;

use ProjConfig;

{
    my $db = someConnectFunction( $ProjConfig::DbName );
    # do stuff
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T16:40:37.790

您可以使用配置文件并在需要时将其读取。

```
use Config::Merge;

my $config = Config::Merge->new ( '/path/to/config_file.yml' );

my $file = $config->C('filename'); 
```

这将读入一个 yaml 配置文件，这将导致 yaml 结构可用作 perl 哈希。

yaml 文件可能类似于：

```
db:
  name: db_name
  url : 192.168.1.1 
```

回到文件中：

```
print $file->{db}{name}  would print out 'db_name'. 
```

# java - 将整数转换为布尔值

> ID：11399079
> 
> 赞同：26
> 
> 时间：2012-07-09T16:16:38.713
> 
> 标签：java, json, gson

有没有办法可以将 int/short 值转换为布尔值？我收到的 JSON 如下所示：

```
{ is_user: "0", is_guest: "0" } 
```

我正在尝试将其序列化为如下所示的类型：

```
class UserInfo {

    @SerializedName("is_user")
    private boolean isUser;

    @SerializedName("is_guest")
    private boolean isGuest;

    /* ... */
} 
```

如何让 Gson 将这些 int/short 字段转换为布尔值？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-07-10T02:41:16.227

首先获取 Gson 2.2.2 或更高版本。早期版本（包括 2.2）不支持原始类型的类型适配器。接下来，编写一个将整数转换为布尔值的类型适配器：

```
private static final TypeAdapter<Boolean> booleanAsIntAdapter = new TypeAdapter<Boolean>() {
  @Override public void write(JsonWriter out, Boolean value) throws IOException {
    if (value == null) {
      out.nullValue();
    } else {
      out.value(value);
    }
  }
  @Override public Boolean read(JsonReader in) throws IOException {
    JsonToken peek = in.peek();
    switch (peek) {
    case BOOLEAN:
      return in.nextBoolean();
    case NULL:
      in.nextNull();
      return null;
    case NUMBER:
      return in.nextInt() != 0;
    case STRING:
      return Boolean.parseBoolean(in.nextString());
    default:
      throw new IllegalStateException("Expected BOOLEAN or NUMBER but was " + peek);
    }
  }
}; 
```

...然后使用此代码创建 Gson 实例：

```
 Gson gson = new GsonBuilder()
      .registerTypeAdapter(Boolean.class, booleanAsIntAdapter)
      .registerTypeAdapter(boolean.class, booleanAsIntAdapter)
      .create(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:18:32.790

如果您将它们作为整数或短裤阅读，那么您可以

```
boolean b = (i != 0) 
```

其中 b 是您想要获取的布尔值，而 i 是 int 或 short 值。

如果您将它们作为字符串阅读，那么您想要

```
boolean b = !s.equals("0"); // use this if you WANT null pointer exception
                            // if the string is null, useful for catching
                            // bugs 
```

或者

```
boolean b = !"0".equals(s); // avoids null pointer exception, but may silently
                            // let a bug through 
```

# unix - 拆分相应文件夹中的文件

> ID：11399083
> 
> 赞同：0
> 
> 时间：2012-07-09T16:16:46.423
> 
> 标签：unix, file-io

我在名为“test”的主文件夹中有一个文件列表，例如（pippo1.txt、pippo2.txt、pippo3.txt、ecc）。

我想创建多个与文件数量相同且名称相同的文件夹。例如，如果我有一个名为 pippo1.txt 的文件，我想创建一个名为 pippo1 的文件夹，然后我想将 .txt 文件分别复制到名为 pippo1、pippo2、pippo3 的文件夹中，以便 pippo1.txt 保留在文件夹 pippo1、pippo2.txt 将保留在文件夹 pippo2 ecc 中。

我有 14469 个 files.txt 分配在 14469 个文件夹中。

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:21:51.817

在伯恩壳：

```
for i in *.txt
do 
  dir=$(echo $i | sed 's/.txt$//')
  mkdir "$dir"
  cp "$i" "$dir"
done 
```

`bash`你可以使用insted`${}`的构造`sed`：

```
for i in *.txt
do 
  dir=${i%.txt}
  mkdir "$dir"
  cp "$i" "$dir"
done 
```

如果要移动文件而不是复制它，只需使用`mv`而不是`cp`.

当您认为您的列表对于命令行来说太大（但在您的情况下似乎不太大）时，您可以使用`while...read`代替`for`：

```
find . -maxdepth 1 -name '*.txt' | while read i
do 
  dir=${i%.txt}
  mkdir "$dir"
  cp "$i" "$dir"
done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:21:36.017

```
for file in *.txt; do
  newdir="${file%.txt}"
  mkdir -p "$newdir"
  mv "$file" "$newdir"
done 
```

如果您想`pippo1.txt`在“主目录”中保留一份副本，请`cp`使用`mv`. 例如：

```
cp "$file" "$newdir" 
```

# dynamics-crm-2011 - 从 CRM 2011 中的 FetchXml 获取选项集和查找字段值

> ID：11399086
> 
> 赞同：2
> 
> 时间：2012-07-09T16:16:51.630
> 
> 标签：dynamics-crm-2011, fetchxml

我正在尝试使用 fetchxml 从另一条记录中获取值以创建新记录。除了从选项集或查找字段中获取任何值之外，我已经设法让这一切正常工作。选项集没有给出任何错误，但根本没有设置该字段，并且查找说 GUID 的格式不正确，大概是因为它没有通过 GUID。

谁能帮我弄清楚如何获得这些值？

谢谢

编辑：我的代码如下。选项集是评分 (ts_grading) 和我需要从获取中获取的 qualityStatement Guid (ts_quality_statement_id)。

```
string fetchXml = @"<fetch distinct='false' mapping='logical' output-format='xml-platform' version='1.0'>
                            <entity name='ts_self_assessment_item'>
                            <attribute name='ts_evidence_of_areas_of_improvement'/><attribute name='ts_evidence_of_strengths'/><attribute name='ts_expected_completion_date'/>
                            <attribute name='ts_grading'/><attribute name='ts_quality_statement_id'/>
                            <filter type='and'>
                            <condition attribute='ts_self_assessment_id' uitype='ts_self_assessment' operator='eq' value='" + selfAssessmentID + "'/></filter></entity></fetch>";

        // Execute Fetch xml
        EntityCollection selfAssessmentItemResult = Service.RetrieveMultiple(new FetchExpression(fetchXml));

        foreach (var selfAssessment in selfAssessmentItemResult.Entities)
        {                
            string areasOfImprovement = selfAssessment["ts_evidence_of_areas_of_improvement"].ToString();
            string strengths = selfAssessment["ts_evidence_of_strengths"].ToString();
            DateTime completionDate = Convert.ToDateTime(selfAssessment["ts_expected_completion_date"].ToString());
            string grading = selfAssessment["ts_grading"].ToString();
            Guid qualityStatement = new Guid(selfAssessment["ts_quality_statement_id"].ToString());
            Guid parentSelfAssessment = new Guid(entity.Attributes["ts_self_assessmentid"].ToString());              

        }

    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-10T12:12:01.713

OptionSet 属性作为 OptionSetValues 返回，外键作为实体引用返回。尝试使用 Entity.GetAttributeValue 而不是做所有的 ToString 转换工作：

```
 foreach (var selfAssessment in selfAssessmentItemResult.Entities)
    {                
        string areasOfImprovement = selfAssessment.GetAttributeValue<String>("ts_evidence_of_areas_of_improvement");
        string strengths = selfAssessment.GetAttributeValue<string>("ts_evidence_of_strengths");
        DateTime completionDate = selfAssessment.GetAttributeValue<DateTime>("ts_expected_completion_date");
        var grading = selfAssessment.GetAttributeValue<OptionSetValue>("ts_grading");
        Guid qualityStatement = selfAssessment.GetAttributeValue<EntityReference>("ts_quality_statement_id").Id;

    } 
```

如果您需要 OptionSetValue 文本值，则需要使用 OptionSet 元数据服务调用或查看 Entity.FormattedAttributes 属性来查找它。

此外，使用早期绑定对象将使您避免遇到这些类型的转换问题。

# css - div中的styles.less背景图像过渡

> ID：11399092
> 
> 赞同：0
> 
> 时间：2012-07-09T16:17:26.103
> 
> 标签：css, less

我有一个重复背景 png 的 div，我想用 style.less 给出 0.4s 的过渡，如果我使用颜色有效，但如果我在背景上使用图像不起作用，为什么？这是我的代码：

```
.transition_bg{
    transition-property: background; /*standard*/
    transition-duration: 0.4s;

    -webkit-transition-property: background; /*Safari e Chrome */
    -webkit-transition-duration: 0.4s;

    -o-transition-property: background;      /*Opera*/
    -o-transition-duration: 0.4s;

    -moz-transition-property: background;    /*Firefox*/
    -moz-transition-duration: 0.4s; 
}

#navigation li
{
    margin: 0;
    width:126px;
    height:40px;
    padding-left:0px;
    padding-right:0px;
    list-style:none;
    float:left;
    background:url(../img/header/bg_nav.jpg) top left repeat-x;
    .transition_bg;
}

#navigation li:hover{
    background:url(../img/header/bg_nav_hover.jpg) top left repeat-x;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:25:36.753

CSS 过渡不会淡入/淡出背景图像（除非有人可以纠正我）。

如果你确信你需要这样做，也许你可以使用两个容器，每个容器都有一个背景图像，但是当你悬停时，一个的不透明度设置为 1，另一个设置为 0，而默认设置是相反的。这将满足您的要求，但您必须处理 DOM 中的另一个元素，这可能会导致问题。

我将提供一个示例，认为您希望将背景应用于通用容器，但由于您希望在列表项中执行此操作，因此您必须大幅增加代码。

# java - 返回指定用户提交的所有更改列表 - Perforce Java API

> ID：11399093
> 
> 赞同：0
> 
> 时间：2012-07-09T16:17:27.127
> 
> 标签：java, api, perforce, changelist

我目前正在尝试使用[perforce java API](http://www.perforce.com/perforce/doc.current/manuals/p4java-javadoc/)编写一个方法来返回指定用户提交的所有更改列表。问题是我似乎在 API 中找不到任何可以帮助我的方法。

我说我必须使用这样的东西是对的吗？

```
List<IFileSpec> userFiles = iServer.getDepotFiles(FileSpecBuilder.makeFileSpecList(new String[] {"//...@"+userName}), false); 
```

任何意见，将不胜感激 ！！

**编辑**

或者它会是沿着这些[方向的东西](http://www.perforce.com/perforce/r10.1/manuals/p4java-javadoc/com/perforce/p4java/server/IOptionsServer.html#getChangelists%28java.util.List,%20com.perforce.p4java.option.server.GetChangelistsOptions%29)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T17:14:06.087

您和 Bryan Pendleton 似乎已经回答了这个答案。

对于那些寻求直接答案的人：

`getChangelists()`如此[处](http://www.perforce.com/perforce/r10.1/manuals/p4java-javadoc/com/perforce/p4java/server/IOptionsServer.html#getChangelists%28java.util.List,%20com.perforce.p4java.option.server.GetChangelistsOptions%29)所述，是您的方法。要过滤结果，请提供一个`GetChangelistsOptions`指定要过滤的值，在这种情况下，`userName`

# php - FQL查询php：如何查询得到用户评论的点赞数

> ID：11399096
> 
> 赞同：0
> 
> 时间：2012-07-09T16:17:30.807
> 
> 标签：php, facebook-fql, fql.multiquery

如何查询用户评论的点赞数

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T03:40:38.333

它必须基于一个对象，例如提要帖子、事件等。一旦您知道要获得评论的对象类型，您可以执行以下操作：

```
fql?q=select user_likes from comment where fromid=me() and object_id in (....) 
```

如果没有 where() 中连接可索引列（例如 object_id）的子查询，则无法进行查询。这就是 Facebook 强制您加入他们的索引表、缩小结果范围（并阻止您执行“select *”之类的全扫描查询）的方式。

问题是，你必须选择一种对象来观察。例如，如果您想对用户发表的帖子发表评论：

```
fql?q=select user_likes from comment where post_id in (select post_id from stream where filter_key in (select filter_key from stream_filter where uid = me())) 
```

您可以在可索引列（由 * 标记）上使用各种条件。测试它：

[图 api 浏览器](http://developers.facebook.com/tools/explorer)

[facebook fql 评论表文档](http://developers.facebook.com/docs/reference/fql/comment/)

# c# - 数组检查：对象引用未设置为对象的实例

> ID：11399100
> 
> 赞同：1
> 
> 时间：2012-07-09T16:17:59.153
> 
> 标签：c#, arrays

我正在努力寻找解决这个问题的方法。我在这个网站上看到很多涉及这个主题的类似条目，但我似乎无法找到解决方案。我正在尝试检查缓存中的表以查看它是否已经存在，如果不存在，则填充它。下面是我的检查代码，它在“if”语句上出错，告诉我“System.NullReferenceException：对象引用未设置为对象的实例”。这令人费解，因为“.IsNullOrEmpty”不应该抓住这个吗？我想如果数组中的第一个元素为空或空，那么它还没有被缓存，因此采取行动。

```
 string[] saveCatList = Cache["Categories" + Session["sessopnID"]] as string[];
            if (string.IsNullOrEmpty(saveCatList[0]))
            {
                WBDEMOReference.getcatlist_itemcategories[] categories;
                strResult = callWebServ.getcatlist(Session["sessionID"].ToString(),
                            out strResultText, out dNumOfCat, out categories);

                for (int i = 0; i < categories.Length; i++)
                {
                    //ddCat is the ID number of the category drop down list
                    ddCat.Items.Add(new ListItem(categories[i].categorydesc.ToString(),
                                                 categories[i].categorynumber.ToString()));
                }
            } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T16:19:42.887

与`string.IsNullOrEmpty(saveCatList[0])`您一起检查数组的第一个元素是否为空或为空。看来你的数组是空的，所以你应该首先检查你的数组：

```
if(saveCatList == null || string.IsNullOrEmpty(saveCatList[0])) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:20:35.377

```
Cache["Categories" + Session["sessopnID"]] as string[]; 
```

此强制转换失败并且“作为字符串”返回 null。因此，当您尝试将关联变量作为数组访问时，您实际上是在执行 null[0]，这是一个 NullReferenceException。

如果您添加检查以首先确保数组不为空，这将正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T16:23:09.910

改变

```
if (string.IsNullOrEmpty(saveCatList[0])) 
```

到

```
if (saveCatList != null && saveCatList.Length>0 && string.IsNullOrEmpty(saveCatList[0])) 
```

还有，改变

```
 ddCat.Items.Add(new ListItem(categories[i].categorydesc.ToString(),
                                             categories[i].categorynumber.ToString())); 
```

到

```
if (categories[i].categorydesc != null && categories[i].categorynumber!= null)
{
  ddCat.Items.Add(new ListItem(categories[i].categorydesc.ToString(),
                                             categories[i].categorynumber.ToString()));

} 
```

# c# - Fiddler Qustion & 为什么一个 php/aspx 样式表页面，

> ID：11399101
> 
> 赞同：0
> 
> 时间：2012-07-09T16:18:00.370
> 
> 标签：c#, php, jquery, asp.net-mvc-3, fiddler

我不需要任何代码帮助，它非常简单，只需要一个带有 Fiddler 的解释以及为什么用 php/aspx 扩展名命名一个 css 文件。我正在尝试从网站复制一个动作。基本上它涉及一个单击按钮来更改站点的主题。

单击时，命令会触发到 php 页面（没问题，可以使用 MVC ActionMethod 调用复制相同的内容）。但是，当我查看 Fiddler 的原始视图时，我会看到所有相关的样式属性。没有打开/关闭样式标签，它们也没有嵌入到网页中，而是将 jquery 附加到指向新样式表的 html 头标签中，该样式表包含我在 Fiddler 中观察到的样式属性。

所以这是我的两个问题：

**1\. 虽然我理解为什么按钮链接指向 php/aspx 页面以调用方法，但为什么嵌入在 Html 中的生成的样式表页面以 php/aspx 扩展名结尾？为什么不只是一个普通的 .css？**

**2\. 什么动作会导致 Fiddler 在原始视图中显示样式表行，我将如何在 C# 方法调用中复制它？我的意思是，如果我所做的只是创建一个新的样式表页面（再次以 php/aspx 扩展名结尾），并附加当前的 html 以指向 tyhat 新的样式表文件，那么结果视图不会是 html而不是新的样式表行？**

**这是我在 Fiddler 的原始视图中观察到的示例：**

.new-web-site-theme-12345 一个img {边框：0; }

.new-web-site-theme-12345 #content div.paragraph { 颜色：#676767; }

.new-web-site-theme-12345 #logo { 填充：25px 0; }

.new-web-site-theme-12345 .mySite-search { 边距：0 0 0 10px; }

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:25:25.960

对于**1.**：为什么不呢？您可以命名您喜欢/喜欢的任何名称，无需`.css`在末尾命名样式表，这只是一个约定。浏览器使用 mime 类型而不是文件扩展名，这不是你的硬盘。

对于**2.**：我不能回答你。您还没有真正概述结果的样子，因此由于缺乏细节，如果不猜测我不太喜欢哪个答案，就无法给出答案。所以我更喜欢*啊？*反而。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:23:10.060

`css`如果您动态生成 CSS，使用`PHP`或插入值，则使用另一个扩展名命名文件`C#`。

问题2不清楚。

# jquery - 显示与父类相同的图像，与列表项的ID相同

> ID：11399102
> 
> 赞同：2
> 
> 时间：2012-07-09T16:18:01.040
> 
> 标签：jquery, toggle, each

**>>** [**JSFIDDLE**](http://jsfiddle.net/BramVanroy/Mzdtg/) **<<**

```
var imgFilterBtn = $("nav > ul > li > ul > li > a");

$("img").fadeIn("slow");

imgFilterBtn.click(function() {
    var fadeInClass = $(this).attr("id");
    var wrongFilter = $(this).parent("li").parent("ul").children("li").children("a");

    wrongFilter.removeClass(); // un-style all links in one sub-list
    $(this).toggleClass("selected"); // style selected link

    var wrongFilterID = wrongFilter.attr("id");
    $("#imgWrap").removeClass(wrongFilterID); // remove all classes from imgWrap that are equal to an ID all LI-items in  the current list

    $("#imgWrap").toggleClass(fadeInClass); // toggle the class that is equal to the ID of the clicked a-element

    $("img").hide(); // hide all images

    var imgWrapClass = $("#imgWrap").attr("class");
    $("#imgWrap").children("img." + imgWrapClass).fadeIn("fast"); // fade in all elements that have the same class as imgWrap
}); 
```

我已尽我所能包含解释脚本正在做什么的注释。

**1\. 什么有效：**

*   图像在文档加载时淡入
*   “选定”类已切换（但未切换回来！）
*   课程`#imgWrap`已切换，但不会切换回来
*   图像被隐藏并在单击列表项（实际上是其父项`li`）时显示

* * *

**2\. 什么不起作用**

*   单击 li-item 时，其他类不会被删除
*   上面提到的事情

* * *

**3\. 应该发生什么** 当用户点击一个链接时，该链接的 ID 被传递给分配给的类`#imgWrap`。但是在分配这个类之前，与相同列表的其他列表项的 ID 相同的所有其他类（因此不是另一个列表）被删除。所以，当你点击`black`和`fashion`，然后`brown` `#imgWrap`应该有类`fashion`和`brown`，并且`black`应该已经被删除了。

我猜我缺少一个`each`功能，但我不确定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:27:27.223

问题似乎是`wrongFilter`包含该特定列表的**所有** `a`元素，并且`wrongFilter.attr("id")`将**始终选择****第一个**选定元素的 ID 。

关于切换：如果您选择已选择的元素，则首先删除`selected`该类，然后再次添加它。类似于添加到的类`#imgWrap`。

将选择限制为实际选择的元素并修复类添加/删除：

```
// ...
// Only get the currently selected element
var wrongFilter = $(this).closest('ul').find('a.selected');
var wrongFilterID = wrongFilter.attr("id"); // get its ID

// toggle `selected` for the previous selected element and the current one;
// will remove the class if the previous selected element is the same as the
// current one 
wrongFilter.add(this).toggleClass('selected');

// ...

// if the class already exists, the same menu entry was clicked and we have 
// to remove the class
$("#imgWrap").toggleClass(fadeInClass, wrongFilterID !== fadeInClass);

// ... 
```

但现在可能是这样`wrongFilterID`，`undefined`下一次调用`removeClass`将删除所有类 form `#imgWrap`。所以你必须添加一个测试：

```
if(wrongFilterID) {
    $("#imgWrap").removeClass(wrongFilterID); 
} 
```

另一个问题是它`imgWrapClass`可以是一个以空格分隔的类字符串，例如`"fashion black"`，这意味着

```
.children("img." + imgWrapClass) 
```

将导致

```
.children("img.fashion black") 
```

这不是你想要的。

您必须从该字符串创建一个适当的选择器，例如：

```
// "fashion black" becomes "fashion.black"
var imgWrapClass = $.trim($("#imgWrap").attr("class")).replace(/\s+/g, '.'); 
```

* * *

修复所有这些后，它似乎可以正常工作：

[**演示**](http://jsfiddle.net/Mzdtg/7/)

# mongodb - 有没有办法更新 MongoDB 数组键名？

> ID：11399103
> 
> 赞同：1
> 
> 时间：2012-07-09T16:18:00.937
> 
> 标签：mongodb, hashmap, key, rename

有这个 MongoDB 文档：

```
{
  "name": "First Floor",
  "years": {
    "Year 1": {
      "Class A": [
        "Nayara",
        "Steve",
        "Jean"
      ],
      "Class B": [
        "Mark",
        "James",
        "Ana"
      ]
    }
  }
} 
```

有没有办法更新数组键名，“Year 1”到“Year somethingelse”？

如果是这样，它是否也可以与“A类”和“B类”一起使用以将其更改为“其他类”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:19:45.270

是的，你应该[$rename](http://www.mongodb.org/display/DOCS/Updating#Updating-%24rename)

```
db.collection.update(query, 
                     {$rename: {'years.Year 1': 'years.Year somethingelse'}}) 
```

当然，您可以对“A 类”和“B 类”字段执行相同操作。

# jakarta-ee - 在 JBoss 7 for MySQL 上使用 JNDI 数据源时出错

> ID：11399106
> 
> 赞同：0
> 
> 时间：2012-07-09T16:18:03.310
> 
> 标签：jakarta-ee, jboss, datasource, jndi

我按照[这些说明](https://community.jboss.org/wiki/DataSourceConfigurationInAS7)进行操作。

我想在 JBoss 上使用 JNDI 数据源连接 MySQL 数据库以检索一些数据。

我一运行 test.jsp 就会产生错误：

```
javax.servlet.ServletException: javax.servlet.jsp.JspException: Unable to get connection, DataSource invalid: "java.sql.SQLException: No suitable driver found for java:/jdbc/bookstore"
    org.apache.jasper.runtime.PageContextImpl.doHandlePageException(PageContextImpl.java:862)
    org.apache.jasper.runtime.PageContextImpl.handlePageException(PageContextImpl.java:791)
    org.apache.jsp.test_jsp._jspService(test_jsp.java:90)
    org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:847)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:369)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:326)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:253)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:847) 
```

这就是我得到的：

MySQL Server 5.5：数据库 -> 书店表 -> 书

```
connector -> mysql-connector-java-5.1.21-bin.jar
container -> jboss-as-7.1.1.Final
IDE -> Eclipse juno 
```

第 1 步 - JBoss：

[JBoss_Home]/modules/com/mysql/main -> 得到下面的文件

```
module.xml
mysql-connector-java-5.1.21-bin.jar
mysql-connector-java-5.1.21-bin.jar -> this auto created 
```

module.xml 包含：

```
<?xml version="1.0" encoding="UTF-8"?>
<module xmlns="urn:jboss:module:1.0" name="com.mysql">
  <resources>
    <resource-root path="mysql-connector-java-5.1.21-bin.jar"/>
  </resources>
  <dependencies>
    <module name="javax.api"/>
  </dependencies>
</module> 
```

第 2 步 JBoss：

[JBoss_Home]/standalone/configuration/standalone.xml

`standalone.xml`添加数据源如下：

```
<subsystem xmlns="urn:jboss:domain:datasources:1.0">
            <datasources>
                <datasource jndi-name="java:jboss/datasources/ExampleDS" pool-name="ExampleDS" enabled="true" use-java-context="true">
                    <connection-url>jdbc:h2:mem:test;DB_CLOSE_DELAY=-1</connection-url>
                    <driver>h2</driver>
                    <security>
                        <user-name>sa</user-name>
                        <password>sa</password>
                    </security>
                </datasource>
                <datasource jta="true" jndi-name="java:/jdbc/bookstore" pool-name="bookstore_pool" enabled="true" use-java-context="true" use-ccm="true">
                    <connection-url>jdbc:mysql://localhost:3306/bookstore</connection-url>
                    <driver>mysql</driver>
                    <transaction-isolation>TRANSACTION_READ_COMMITTED</transaction-isolation>
                    <pool>
                        <min-pool-size>10</min-pool-size>
                        <max-pool-size>100</max-pool-size>
                        <prefill>true</prefill>
                    </pool>
                    <security>
                        <user-name>root</user-name>
                        <password>786</password>
                    </security>
                    <statement>
                        <prepared-statement-cache-size>32</prepared-statement-cache-size>
                        <share-prepared-statements>true</share-prepared-statements>
                    </statement>
                </datasource>
                <drivers>
                    <driver name="mysql" module="com.mysql">
                        <xa-datasource-class>com.mysql.jdbc.jdbc2.optional.MysqlXADataSource</xa-datasource-class>
                    </driver>
                    <driver name="h2" module="com.h2database.h2">
                        <xa-datasource-class>org.h2.jdbcx.JdbcDataSource</xa-datasource-class>
                    </driver>
                </drivers>
            </datasources>
        </subsystem> 
```

**第 3 步 - Eclipse 项目：**

test.jsp 页面：

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1" pageEncoding="ISO-8859-1"%>

<%@ taglib uri="http://java.sun.com/jsp/jstl/sql" prefix="sql" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>

<sql:query var="rs" dataSource="java:/jdbc/bookstore">
select title,description from book
</sql:query>

<html>
  <head>
    <title>DB Test</title>
  </head>
  <body>

  <h2>Results</h2>

<c:forEach var="row" items="${rs.rows}">
    Foo ${row.title}<br/>
    Bar ${row.description}<br/>
</c:forEach>

  </body>
</html> 
```

在**web.xml 中添加：**

```
<!-- JDBC DataSources (java:comp/env/jdbc) -->
    <resource-ref>
        <description>The used datasource</description>
        <res-ref-name>jdbc/bookstore</res-ref-name>
        <res-type>javax.sql.DataSource</res-type>
        <res-auth>Container</res-auth>
    </resource-ref> 
```

**jboss-web.xml**包含：

```
<?xml version="1.0" encoding="UTF-8"?>
<jboss-web>
    <resource-ref>
        <res-ref-name>jdbc/bookstore</res-ref-name>
        <jndi-name>java:/jdbc/bookstore</jndi-name>
        <res-type>javax.sql.DataSource</res-type>
        <res-auth>Container</res-auth>
    </resource-ref>
</jboss-web> 
```

下面是项目结构：

![项目](../Images/b0be9b76efb76e9119ffc681133718cd.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T17:06:32.873

这在 7.1.1.Final 上对我有用，没有任何问题。这是我的设置的样子。

`${JBOSS_HOME}/modules/com/mysql/main/modules.xml:`

```
<?xml version="1.0" encoding="UTF-8"?>
<module xmlns="urn:jboss:module:1.1" name="com.mysql">
  <resources>
      <resource-root path="mysql-connector-java-5.1.21-bin.jar"/>
  </resources>
  <dependencies>
      <module name="javax.api" />
  </dependencies>
</module> 
```

在`standalone.xml`：

```
<subsystem xmlns="urn:jboss:domain:datasources:1.0">
    <datasources>
        <datasource jndi-name="java:jboss/datasources/ExampleDS" pool-name="ExampleDS" enabled="true" use-java-context="true">
            <connection-url>jdbc:h2:mem:test;DB_CLOSE_DELAY=-1</connection-url>
            <driver>h2</driver>
            <security>
                <user-name>sa</user-name>
                <password>sa</password>
            </security>
        </datasource>
        <datasource jta="true" jndi-name="java:/jdbc/test" pool-name="test_pool" enabled="true" use-java-context="true" use-ccm="true">
            <connection-url>jdbc:mysql://localhost:3306/as7test</connection-url>
            <driver>mysql</driver>
            <transaction-isolation>TRANSACTION_READ_COMMITTED</transaction-isolation>
            <pool>
                <min-pool-size>10</min-pool-size>
                <max-pool-size>100</max-pool-size>
                <prefill>true</prefill>
            </pool>
            <security>
                <user-name>user</user-name>
                <password>mypass</password>
            </security>
            <statement>
                <prepared-statement-cache-size>32</prepared-statement-cache-size>
                <share-prepared-statements>true</share-prepared-statements>
            </statement>
        </datasource>
        <drivers>
            <driver name="mysql" module="com.mysql">
                <xa-datasource-class>com.mysql.jdbc.jdbc2.optional.MysqlXADataSource</xa-datasource-class>
            </driver>
            <driver name="h2" module="com.h2database.h2">
                <xa-datasource-class>org.h2.jdbcx.JdbcDataSource</xa-datasource-class>
            </driver>
        </drivers>
    </datasources>
</subsystem> 
```

这对我有用，没有错误。我没有尝试通过任何代码建立连接，但我确实在 Web 管理控制台上测试了连接。

**编辑：** ~~尝试添加`<module name="javax.transaction"/>`到您的依赖项。有一个错误，默认情况下没有添加，我看到您使用的是 XA 数据源。~~

# excel - 如何根据excel中的条件替换单元格的文本

> ID：11399111
> 
> 赞同：5
> 
> 时间：2012-07-09T16:18:24.807
> 
> 标签：excel

我有以下数据排序为：

| 活动 ID | 员工人数 |
| --- | --- |
| 一个 | 10 |
| 乙 | 8 |
| C | 4 |

这应该是前 10 名排序；我想用“其他”词而不是原始值替换最后一个 Activity 值（ C ）。谁能告诉我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T16:26:33.593

您可以使用`IF`新单元格中的语句来替换文本，例如：

```
=IF(A4="C", "Other", A4) 
```

这将检查单元格值 A4 是否为“C”，如果是，则将其替换为文本“Other”；否则，它使用单元格 A4 的内容。

**编辑**

假设`Employee_Count`值在 B1-B10 中，您可以使用以下命令：

```
=IF(B1=LARGE($B$1:$B$10, 10), "Other", B1) 
```

这个函数甚至不需要对数据进行排序；该`LARGE`函数将找到系列中的第 10 个最大数字，然后公式的其余部分将与之进行比较。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-06-21T14:27:51.330

您可以使用**条件格式**替换文本而不影响任何公式。只需转到规则格式，您将在其中看到**Number**、**Font**、**Border**和**Fill**。
转到数字选项卡并选择`CUSTOM`。然后只需在它说的地方输入`TYPE`：你想在引号中说什么。

例子..`"OTHER"`

# core-data - 有没有更好的方法：我笨拙地使用了AddingManagedObjectContext？

> ID：11399117
> 
> 赞同：0
> 
> 时间：2012-07-09T16:19:07.177
> 
> 标签：core-data, nsmanagedobjectcontext

问题：AddingManagedObjectContext 的笨拙使用？

该应用程序是通用库样式 CoreData。RootTableView 具有书籍类别列表、小说、科幻等。添加书籍是通过 EditButton 在第二级 BookListTableView 上完成，然后是新出现的“+”按钮。第三级显示书籍详情表格视图。

当用户触摸第二级“BookList”视图上的“+”按钮时，他已经表明该书默认情况下应该具有刚刚在主 BookCategoryList 视图上选择的类别。新书将是主 MOC 中的未知对象，并在插入操作开始时放置在添加 MOC 中。我发现如果我将用户所需的类别（比如科幻）从 mainMOC 添加到 addMOC 中，保存时会出现错误：时间，因为据我了解，ManagedObject 不能存在于两个不同的 MOC 中。

因为我想为了方便用户而执行此类别添加，所以我进行了以下工作。我使用具有相同类别名称的新替代类别，并将其添加到新书的属性中：

```
@property (nonatomic, retain) NSSet* categories; 
```

，从而允许在编辑模式下的 Books Details Table 视图显示替代类别对象的名称。然后当用户触摸保存按钮时，就在：

```
[self.addingManagedObjectContext save:&error] 
```

使用objectID，我从新书中删除了替代类别，然后从addingManagedObjectContext 本身中删除了相同类别。

按照这个添加MOC保存通过：

NSNotificationCenter *dnc = [NSNotificationCenter defaultCenter]; [dnc addObserver:self 选择器:@selector(addControllerContextDidSave:) 名称:NSManagedObjectContextDidSaveNotification 对象:self.addingManagedObjectContext];

addMOC 中的新书（无类别）被合并到 mainMOC

然后我将mainMOC对应的category插入到新书里，然后保存mainMOC，完成saveAction。

这对我有用，但感觉很尴尬。有人可以解释我错在哪里以及我错过了什么吗？处理这个问题的正确和优雅的可可方法是什么？

谢谢，马克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T22:32:09.087

一个托管对象可以存在于多个托管对象上下文中，或者更准确地说，代表给定实体的同一实例的托管对象可以存在多个上下文中。

当您直接将托管对象实例从一个上下文传递到另一个上下文时会出现问题，尤其是当您发现跨越线程边界时。

“传递”托管对象的正确方法是传递`objectId`例如

```
//Context 1
NSManagedObjectID *objectID = myObjectInContext1.objectID;

//Context 2
NSManagedObject *myObjectInContext2 = [self.managedObjectContext2 objectWithID:objectID]; 
```

或者，您也可以从第二个上下文中的持久存储中重新获取类别，这将为您提供有效的类别对象，然后传递一些其他值来指示要使用这些对象中的哪一个，例如类别 ID 或标题。

# spring - 什么可能导致未在 Spring 中设置依赖项

> ID：11399120
> 
> 赞同：1
> 
> 时间：2012-07-09T16:19:26.050
> 
> 标签：spring, dependency-injection, annotations, required

我遇到了 Spring 的`@Required`注解，我不确定何时使用它。

我的主要疑问是：**什么可能导致未设置 Spring 依赖项从而证明使用`@Required`?**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:26:46.193

首先查看参考文档中的[*4.9.1 @Required*](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/beans.html#beans-required-annotation)。恕我直言，当自动装配如此普遍使用时，此注释的使用受到限制。

在 XML 时代这非常好 - 如果您忘记在 XML 中定义但`<property name="movieFinder" .../>`记得放置字段或设置器，Spring 会抛出异常。`@Required``movieFinder`

请注意，此注释不会使您摆脱最常见的 Spring 新手错误 -`new`在容器控制之外使用运算符手动创建 bean。Spring 必须对 bean 进行后处理并仅在容器实际创建带注释的类时才抛出异常（但未注入依赖项）。

这些天你只需用`@Autowired`//注释该字段`@Resource`，`@Inject`如果找不到bean（否则离开`null`）抛出异常（*没有这样的bean*或类似的）。如果您可以`@Required`添加注释，那么是什么阻止您用 XML 替换它`@Autowired`并完全摆脱它？

话虽如此，对于某些人来说`@Required`可能有很好的文档价值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:25:29.930

在很大程度上是为了防止开发人员错误。

有时开发人员认为某些内容会出现在实际不存在的上下文中，原因有很多，包括：

1.  只是忘记添加 bean
2.  依赖问题（当依赖组件被自动检测时）
3.  类型/包装误解

在这些情况下，最好在上下文加载时失败，而不是稍后出现 NPE。

# mysql - 数据库设计：如何处理具有非唯一外键的表

> ID：11399123
> 
> 赞同：1
> 
> 时间：2012-07-09T16:19:32.527
> 
> 标签：mysql, database

我有一个表`products`和一个`categories`表，两者都可以选择在`images`表中包含相关记录。

`images.fk`值`1`可以指向`categories.id`or `products.id`，因此我添加了一列`images.related_to`。

当我想检索一个类别及其图像时，我使用

```
WHERE categories.id = images.fk AND images.related_to = 'categories' 
```

但显然现在如果该类别没有图像，我的查询将不会返回任何内容，因为`WHERE images.related_to = 'categories'`.

我可以通过首先运行查询来查看该类别是否有图像来解决这个问题，但这似乎不是一个好的解决方案。

`images.fk`没有包含唯一值是否被认为是糟糕的设计？我应该有单独的`categories.images`和`products.images`表吗？那么，如果我也有`users`, `shops`,的图像`suppliers`怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:32:12.530

还有两张桌子说

ProductImages(ProductId,ImageId) CategoryImages(CategoryID,ImageID)

然后 ProductImages 对 Products 和 FK To Images 有一个 FK

和

CategoryImages 具有类别的 FK 和图像的 FK

是经典的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:51:55.670

如果我理解你的问题，我会这样做：

*   products 和 Categories 之间的基数是 N:M（一个产品可以有多个类别，一个类别属于多个产品
*   我添加了另一个名为“IMAGES”的表，一个产品可以有多个图像，一个图像属于一个产品，所以基数是 1:N

您只需要添加其他属性。

![在此处输入图像描述](../Images/ee4a25abdff147ecbbb6f164287f02bc.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T17:00:09.793

你可以想一想`images`，因为它是一个多用途的图像存储。制作`images`主键`auto_increment`，不要将图像 fk 存储在此表中：`images(image_id, src, size, etc... , Primary(image_id))`.

再创建一个（或三个）表（简化代码）`images_on_categories (category_id, image_id, Primary(category_id, image_id))`：.

或：`images_on_users (user_id, image_id, Primary(user_id, image_id))`。

您可以像这样创建 FK：`FOREIGN KEY (images_on_users.user_id) REFERENCES users (users.user_id)`

# java - Converting JSONArray to String in javascript to send to java

> ID：11399124
> 
> 赞同：8
> 
> 时间：2012-07-09T16:19:32.283
> 
> 标签：java, javascript, json, cordova

I am working with an android app that uses phonegap. The java calls some HTML that displays a web page and the HTML uses javascript for functions. Now in the javascript I make a JSON call using parameters from the HTML. The problem is I need to send this JSONArray back to the Java class. However, when I use

```
JavaActivity.parseJson(jsonArray.toString()); 
```

(where jsonArray is the JSONArray and parseJson is the method in the java activity)

the string that it sends looks something like this:

```
[{Object:Object}, {Object:Object}, {Object:Object}, .....] 
```

What am I doing wrong or is there another way to convert this String, or just send the JSONArray directly?

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-09T16:37:13.413

Assuming jsonArray holds all the data you want to send to Java do:

```
var jString = JSON.stringify(jsonArray); 
```

Now 'jString' is the json encoded string representation of your array.

# jquery - jQuery.on？在 Ajax 之后操作 DOM

> ID：11399130
> 
> 赞同：0
> 
> 时间：2012-07-09T16:19:48.403
> 
> 标签：jquery

> **可能重复：**
> [使用 .live() 绑定 jQuery UI 自动完成](https://stackoverflow.com/questions/4551230/bind-jquery-ui-autocomplete-using-live)

我似乎无法弄清楚这一点。我相信我将不得不使用 .load() 或 .on() 但我不知道如何使它们中的任何一个工作。

所以我有一个有 3 行的表。当用户填写 3 行时，我想为他们提供更多。

一旦他们填写了最后一行，就会调用这个脚本。

```
function addNewRow(id)
{
    var qty = $('#qty' + id).val();
    if (qty > 0)
    {
        $('#quickaddtable').append('<?php echo createRow(($i+1)); ?>');
    }
} 
```

问题是我正在使用自动完成功能并且对于新创建的行它不起作用。我知道我需要重新加载 DOM，但我只是迷失了如何轻松地做到这一点。

```
$(function(){  

    $(".id").autocomplete({ 
            //My Code
    });  
}); 
```

我确信这是一个简单的答案，但是几乎所有示例都显示 .on("click",...)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T00:26:25.350

尼尔明白了。我全都看错了。

我需要将 .on 与自动完成而不是 addNewRow 函数一起使用。

所以我改变了这个

```
$j(function(){  

    //attach autocomplete  
    $j(document).on("keyup.autocomplete", '.autocomplete', function(){
        $j(this).autocomplete({
                   //My Code
            });
    });

}) 
```

谢谢大家的帮助。我花了几个小时看这个，几分钟后你们再次回复谢谢。由于尼尔没有发布答案，我有什么办法可以给他信用吗？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-09T16:25:12.057

这里的问题是，当使用 `$('.id')`选择器时，新行还不存在。当您添加更多行时，匹配“.id”的新元素不会绑定到您之前调用的方法。

我可能只是在插入之后重新绑定，而不是玩弄绑定到文档（`$(document).on('event')`）。所以它会是这样的：

```
$('#quickaddtable').append( ... );
$('.id').autocomplete("destroy");
$('.id').autocomplete({ ... }); 
```

# ruby-on-rails - activeadmin 中的 collection_select

> ID：11399139
> 
> 赞同：0
> 
> 时间：2012-07-09T16:20:23.323
> 
> 标签：ruby-on-rails, activeadmin

Activeadmin 为 has_many 和 belongs_to 关联创建了一个不错的下拉菜单。但由于我需要编辑我的表格，这些东西都被删除了。

在我的原始形式中，我使用了：

```
<%= f.label :artist_id %><br />
<%= collection_select(:work, :artist_id, Artist.all, :id, :name) %> 
```

但这在我的 admin/works.rb 中不起作用。我在那里创建的表格是：

```
 ActiveAdmin.register Work do
  form do |f|
        f.inputs "Details" do
          f.input :title
          f.input :exhibition_id
          f.input :artist_id
          f.input :photo
        end

        f.buttons
      end
end 
```

如何在我的管理表单中创建类似的效果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T09:17:41.870

Activeadmin uses Formtastic and this is how i solved it:

```
f.input :artist, :as => :select, :multiple => false, :input_html => { :size => 1 } 
```

# java - 等效于 mongo 的 out:reduce 选项在 hadoop

> ID：11399140
> 
> 赞同：0
> 
> 时间：2012-07-09T16:20:26.670
> 
> 标签：java, mongodb, hadoop, mapreduce

我正在重写 MongoDB map reduce 作业以改用 Hadoop（使用 mongo-hadoop 连接器），但是当我将两个数据集映射到同一个集合时，它会覆盖值而不是使用它们

> *{ reduce : "collectionName" } - 如果结果集中和旧集合中的给定键存在文档，则将对这两个值执行归约操作（使用指定的归约函数）并将结果写入输出集合。如果提供了 finalize 函数，这也将在 reduce 之后运行。*

如何使用 mongo-hadoop 完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:04:12.213

Mongo-Hadoop 目前只支持覆盖目标集合。但是，可以将多个作业链接在一起，允许您将 MR 输出发送到一个新作业中，该作业也从旧集合中读取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T14:32:24.263

对于其他寻找此功能的人，即将推出对多输入的支持。

更改的分支位于[此处](https://github.com/mlew/mongo-hadoop)。它做得很好，我们正在生产中使用它。

# haskell - 具有关联类型同义词的 Data.Vector.Unbox 的自动派生

> ID：11399143
> 
> 赞同：7
> 
> 时间：2012-07-09T16:20:44.067
> 
> 标签：haskell, template-haskell, type-families, deriving

我有一个数据类型

```
newtype Zq q = Zq (IntType q) 
```

其中 'q' 将是该类的一个实例

```
class Foo a where
   type IntType a 
```

而“IntType”只是与“q”相关的底层表示（即 Int、Integral 等）。

我想让 Zq 成为[Data.Vector.Unbox](http://hackage.haskell.org/packages/archive/vector/0.9.1/doc/html/Data-Vector-Unboxed.html)的一个实例。我们目前正在使用上面链接中建议的大约 50 行简单代码手动派生 Unbox。我们将在我们的代码中创建几种不同类型的“拆箱”，因此为每种类型编写 50 行并不吸引人。

我在[这里](http://comments.gmane.org/gmane.comp.lang.haskell.libraries/17252)找到了两种选择。一种替代方法是使用[这个包](http://hackage.haskell.org/packages/archive/vector-th-unbox/0.1.0.0/doc/html/Data-Vector-Unboxed-Deriving.html)，它使用 Template Haskell 来派生 Unbox 的实例。TH 代码如下所示：

```
derivingUnbox "Zq"
  [d| instance (Foo q, U.Unbox (IntType q)) => Unbox' (ZqBasic q) (IntType q) |]
  [| \ (Zq x) -> x |]
  [| \ x -> Zq x |] 
```

问题是，我[无法使用关联的类型同义词定义实例](http://www.haskell.org/pipermail/glasgow-haskell-users/2008-October/015794.html)（或者我可以吗？？）

[一个相关问题：为什么[TypeSynonymInstances](http://hackage.haskell.org/trac/haskell-prime/wiki/TypeSynonymInstances)是 Fl​​exibleInstances隐含的扩展，不允许**关联**类型同义词实例？这是某种根本不同的野兽吗？]

我目前对该问题的解决方案是将 Zq 重新定义为

```
newtype Zq q i = Zq i 
```

然后添加等式约束

```
i~(IntType q) 
```

在每个涉及 (Zq qi) 的情况下，这不是很优雅。我的（工作）拆箱派生变为

```
derivingUnbox "Zq"
  [d| instance (U.Unbox i, i~IntType q, Foo q) => Unbox' (Zq q i) i |]
  [| \ (Zq x) -> x |]
  [| \ x -> Zq x |] 
```

我觉得我应该能够在不诉诸于显式暴露类型“i”的情况下完成此操作。我所做的只是将它从关联的类型同义词移动到具有等式约束的显式参数。为什么这种“从根本上”是一种不同（而且显然更安全）的方法？有什么方法可以避免添加类型参数“i”并仍然获得自动拆箱派生？

除了额外的类型参数，我在使用 TH 包为 (Vector r) 派生 Unbox 时遇到了问题，也就是说，我想制作一个 Unbox Vector 的 Unbox Vector。我的尝试是这样的：

```
newtype Bar r = Bar (Vector r)

derivingUnbox "Bar"
  [d| instance (Unbox r) => Unbox' (Bar r) (Vector r) |]
  [| \ (Bar x) -> x |]
  [| \ x -> Bar x |] 
```

但我得到（很多）错误，例如：

```
`basicUnsafeFreeze` is not a (visible) method of class `Data.Vector.Generic.Base.Vector` 
```

我不确定为什么它找不到这个方法，当它适用于我的 Zq 类型时。

* * *

[上面](http://comments.gmane.org/gmane.comp.lang.haskell.libraries/17252)列出的第二种方法是使用扩展 GeneralizedNewtypeDeriving。我看到这种方法的最大问题是我有一些需要拆箱的实际数据（而不是新类型）。但是，仅使用扩展名，我应该可以编写

```
newtype Zq q = Zq (IntType q) deriving (Unbox, M.MVector MVector, G.Vector Vector) 
```

或者至少

```
newtype Zq q i = Zq i deriving (Unbox, M.MVector MVector, G.Vector Vector) 
```

第一个导致错误：

```
No instance for (Unbox (IntType q)) arising from the `deriving` clause of a data type declaration
No instance for (M.MVector MVector (IntType q)) ""
No instance for (G.Vector Vector (IntType q)) "" 
```

第二个给出：

```
No instance for (M.MVector MVector i) ""
No instance for (G.Vector U.Vector i) "" 
```

我不确定为什么它不能导出这些实例，因为上面的帖子让我相信它应该能够。也许我可以摆脱使用 GeneralizedNewtypeDeriving 的关联类型同义词？（当我需要为“数据”派生 Unbox 时，这仍然（可能）不能解决我的问题。）

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T06:35:38.567

我已经改变了[4820b73](https://github.com/liyang/vector-th-unbox/commit/4820b730b19716026aadc17176355710c109aafa)的语法，所以你现在应该可以做你想做的事了：

```
derivingUnbox "Complex"
    [d| (Unbox a) ⇒ Complex a → (a, a) |]
    [| \ (r :+ i) → (r, i) |]
    [| \ (r, i) → r :+ i |] 
```

我还修复了[fe37976](https://github.com/liyang/vector-th-unbox/commit/fe379761bcf03699bbb6e0b272981042bfe4c9b4)中的“xyz is not a (visible) method...”错误，尽管可以通过以下方式解决它：

```
import qualified Data.Vector.Generic
import qualified Data.Vector.Generic.Mutable 
```

现在在[Hackage](http://hackage.haskell.org/package/vector-th-unbox-0.2)上发布。抄送：@reinerp

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-10T22:10:44.007

您在这里遇到了几个单独的问题：

## TH方法

### 是的，关联类型同义词的类实例是非法的

确实，您不能为关联的类型同义词或类型函数定义类实例，这是有充分理由的：编译器无法判断它们是否重叠。例如：

```
type family F a
instance Eq (F Int)
instance Eq (F Bool) 
```

这些实例是否重叠？鉴于上述源代码，我们无法判断：这取决于后来某人如何为`F`. 例如，他们可以定义

```
type instance F Int = Double
type instance F Bool = Double 
```

然后两个实例`Eq`实际上是重叠的。

### 您遇到了`vector-th-unbox`包裹问题

如果您查看`Unbox`您想要的实际实例，您实际上并不想要 ; 的实例`IntType q`。你想要的就是这样：

```
instance (Unbox (IntType q), Foo q) => Unbox (Zq q) where
    ... 
```

问题是该`vector-th-unbox`包迫使您使用假类型类`Unbox'`来传达中间表示类型（`IntType q`在您的情况下），作为滥用模板 Haskell 的语法来传递类型的便捷方式。然后 GHC 看到你写了`Unbox' (Zq q) (IntType q)`然后抱怨。我建议为`vector-th-unbox`软件包提交一个错误。

## `Unbox`为了`Vector r`

我认为 Louis Wasserman 涵盖了这一点。

## `GeneralizedNewtypeDeriving`方法_

您遇到的特定编译错误是因为 GHC 无法推断出适当的上下文。对于与您遇到的大多数问题类似的问题，`StandaloneDeriving`语言扩展可以解决您的问题：

```
deriving instance Unbox (IntType q) => Unbox (Zq q)
deriving instance Unbox (IntType q) => M.MVector MVector (Zq q)
deriving instance Unbox (IntType q) => G.Vector Vector (Zq q) 
```

### 但不要这样做！

虽然`GeneralizedNewtypeDeriving`通常完全按照您的意愿行事，但它在[某些基本方面](http://hackage.haskell.org/trac/ghc/ticket/1496)被破坏了，并且`Unbox`它产生的实例[完全被破坏了](http://permalink.gmane.org/gmane.comp.lang.haskell.libraries/17315)！因此，在游说 Liyang 解决您当前的问题之后，请坚持使用 TH 方法。

# python - 如何在 Python 的单元测试场景中模拟 HTTP 请求

> ID：11399148
> 
> 赞同：34
> 
> 时间：2012-07-09T16:20:50.040
> 
> 标签：python, unit-testing, http, mocking, monkeypatching

我想为所有与 HTTP 相关的测试包括一个 Web 服务器。它不需要非常复杂。我宁愿不依赖于在线。所以我可以测试我的程序的一些选项。

1.  启动服务器
2.  使用适当的 mime 类型、响应代码等创建一些资源 (URI)。
3.  运行测试（最好不必为每个测试启动服务器）
4.  关闭服务器。

有关此代码的任何提示都会有所帮助。我用 BaseHTTPServer 尝试了一些东西，但还没有成功。nosetests 命令似乎无限期地等待。

```
import unittest
from foo import core

class HttpRequests(unittest.TestCase):
    """Tests for HTTP"""

    def setUp(self):
        "Starting a Web server"
        self.port = 8080
        # Here we need to start the server
        #
        # Then define a couple of URIs and their HTTP headers
        # so we can test the code.
        pass

    def testRequestStyle(self):
        "Check if we receive a text/css content-type"
        myreq = core.httpCheck()
        myuri = 'http://127.0.0.1/style/foo'
        myua = "Foobar/1.1"
        self.asserEqual(myreq.mimetype(myuri, myua), "text/css")

    def testRequestLocation(self):
        "another test" 
        pass

    def tearDown(self):
        "Shutting down the Web server"
        # here we need to shut down the server
        pass 
```

谢谢你的帮助。

* * *

**更新 - 2012:07:10T02:34:00Z**

这是一个给定网站将返回 CSS 列表的代码。我想测试它是否返回正确的 CSS 列表。

```
import unittest
from foo import core

class CssTests(unittest.TestCase):
    """Tests for CSS requests"""

    def setUp(self):
        self.css = core.Css()
        self.req = core.HttpRequests()

    def testCssList(self):
        "For a given Web site, check if we get the right list of linked stylesheets"
        WebSiteUri = 'http://www.opera.com/'
        cssUriList = [
        'http://www.opera.com/css/handheld.css',
        'http://www.opera.com/css/screen.css',
        'http://www.opera.com/css/print.css',
        'http://www.opera.com/css/pages/home.css']
        content = self.req.getContent(WebSiteUri)
        cssUriListReq = self.css.getCssUriList(content, WebSiteUri)
        # we need to compare ordered list.
        cssUriListReq.sort()
        cssUriList.sort()
        self.assertListEqual(cssUriListReq, cssUriList) 
```

然后在`foo/core.py`

```
import urlparse
import requests
from lxml import etree
import cssutils

class Css:
    """Grabing All CSS for one given URI"""

    def getCssUriList(self, htmltext, uri):
        """Given an htmltext, get the list of linked CSS"""
        tree = etree.HTML(htmltext)
        sheets = tree.xpath('//link[@rel="stylesheet"]/@href')
        for i, sheet in enumerate(sheets):
            cssurl = urlparse.urljoin(uri, sheet)
            sheets[i] = cssurl
        return sheets 
```

现在，代码依赖于在线服务器。它不应该。我希望能够添加大量不同类型的样式表组合并测试协议，然后在它们的解析、组合等方面进行一些选项。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-07-09T16:25:18.550

为单元测试启动 Web 服务器绝对不是一个好习惯。单元测试应该简单且隔离，这意味着它们应该避免执行例如 IO 操作。

如果您要编写的是真正的单元测试，那么您应该制作自己的测试输入并查看[模拟对象](http://en.wikipedia.org/wiki/Mock_object)。Python 作为一种动态语言，模拟和猴子路径是编写单元测试的简单而强大的工具。特别是看看优秀的[Mock 模块](http://www.voidspace.org.uk/python/mock/)。

### 简单的单元测试

因此，如果我们查看您的`CssTests`示例，您正在尝试测试`css.getCssUriList`是否能够提取您提供的一段 HTML 中引用的所有 CSS 样式表。您在这个特定的单元测试中所做的并不是测试您可以发送请求并从网站获得响应，对吗？您只是想确保给定一些 HTML，您的函数返回正确的 CSS URL 列表。因此，在这个测试中，您显然不需要与真正的 HTTP 服务器对话。

我会做类似以下的事情：

```
import unittest

class CssListTestCase(unittest.TestCase):

    def setUp(self):
        self.css = core.Css()

    def test_css_list_should_return_css_url_list_from_html(self):
        # Setup your test
        sample_html = """
        <html>
            <head>
                <title>Some web page</title>
                <link rel='stylesheet' type='text/css' media='screen'
                      href='http://example.com/styles/full_url_style.css' />
                <link rel='stylesheet' type='text/css' media='screen'
                      href='/styles/relative_url_style.css' />
            </head>
            <body><div>This is a div</div></body>
        </html>
        """
        base_url = "http://example.com/"

        # Exercise your System Under Test (SUT)
        css_urls = self.css.get_css_uri_list(sample_html, base_url)

        # Verify the output
        expected_urls = [
            "http://example.com/styles/full_url_style.css",
            "http://example.com/styles/relative_url_style.css"
        ]
        self.assertListEqual(expected_urls, css_urls) 
```

### 使用依赖注入进行模拟

现在，不太明显的事情是对你的类的`getContent()`方法进行单元测试。`core.HttpRequests`我想您正在使用 HTTP 库，而不是在 TCP 套接字上发出自己的请求。

为了使您的测试保持在*单元*级别，您不希望通过网络发送任何内容。您可以做些什么来避免这种情况，即进行测试以确保您正确使用 HTTP 库。这不是关于测试代码的行为，而是测试它与周围其他对象交互的方式。

这样做的一种方法是明确对该库的依赖：我们可以向 中添加一个参数，以`HttpRequests.__init__`向它传递一个库的 HTTP 客户端实例。假设我使用了一个 HTTP 库，它提供了一个`HttpClient`我们可以调用的对象`get()`。您可以执行以下操作：

```
class HttpRequests(object):

    def __init__(self, http_client):
        self.http_client = http_client

   def get_content(self, url):
        # You could imagine doing more complicated stuff here, like checking the
        # response code, or wrapping your library exceptions or whatever
        return self.http_client.get(url) 
```

我们已经明确了依赖关系，现在需要由调用者来满足要求`HttpRequests`：这称为依赖注入（DI）。

DI 在两件事上非常有用：

1.  它避免了您的代码秘密依赖某个对象存在于某处的意外情况
2.  它允许编写测试，根据测试的目标注入不同类型的对象

在这里，我们可以使用一个我们将提供给它的模拟对象，`core.HttpRequests`并且它会在不知不觉中使用它，就好像它是真正的库一样。之后，我们可以测试交互是否按预期进行。

```
import core

class HttpRequestsTestCase(unittest.TestCase):

    def test_get_content_should_use_get_properly(self):
        # Setup

        url = "http://example.com"

        # We create an object that is not a real HttpClient but that will have
        # the same interface (see the `spec` argument). This mock object will
        # also have some nice methods and attributes to help us test how it was used.
        mock_http_client = Mock(spec=somehttplib.HttpClient) 

        # Exercise

        http_requests = core.HttpRequests(mock_http_client)
        content = http_requests.get_content(url)

        # Here, the `http_client` attribute of `http_requests` is the mock object we
        # have passed it, so the method that is called is `mock.get()`, and the call
        # stops in the mock framework, without a real HTTP request being sent.

        # Verify

        # We expect our get_content method to have called our http library.
        # Let's check!
        mock_http_client.get.assert_called_with(url)

        # We can find out what our mock object has returned when get() was
        # called on it
        expected_content = mock_http_client.get.return_value
        # Since our get_content returns the same result without modification,
        # we should have received it
        self.assertEqual(content, expected_content) 
```

我们现在已经测试了我们的`get_content`方法与我们的 HTTP 库正确交互。我们已经定义了`HttpRequests`对象的边界并对其进行了测试，这是我们应该在单元测试级别进行的。该请求现在在该库的手中，并且我们的单元测试套件当然不是测试该库是否按预期工作的角色。

### 猴子补丁

现在想象一下，我们决定使用伟大的[requests 库](http://docs.python-requests.org/en/latest/index.html)。它的 API 更加程序化，它没有提供我们可以从中获取 HTTP 请求的对象。相反，我们将导入模块并调用它的`get`方法。

我们的`HttpRequests`类`core.py`将如下所示：

```
import requests

class HttpRequests(object):

    # No more DI in __init__

    def get_content(self, url):
        # We simply delegate the HTTP work to the `requests` module
        return requests.get(url) 
```

没有更多的 DI，所以现在，我们想知道：

*   如何防止网络交互发生？
*   我如何测试我`requests`是否正确使用了该模块？

在这里，您可以使用动态语言提供的另一种奇妙但有争议的机制：[猴子补丁](http://en.wikipedia.org/wiki/Monkey_patch)。我们将在运行时将`requests`模块替换为我们制作并可以在测试中使用的对象。

然后，我们的单元测试将如下所示：

```
import core

class HttpRequestsTestCase(unittest.TestCase):

    def setUp(self):
        # We create a mock to replace the `requests` module
        self.mock_requests = Mock()

        # We keep a reference to the current, real, module
        self.old_requests = core.requests

        # We replace the module with our mock
        core.requests = self.mock_requests

    def tearDown(self):
        # It is very important that each unit test be isolated, so we need
        # to be good citizen and clean up after ourselves. This means that
        # we need to put back the correct `requests` module where it was
        core.requests = self.old_requests

    def test_get_content_should_use_get_properly(self):
        # Setup

        url = "http://example.com"

        # Exercise
        http_client = core.HttpRequests()
        content = http_client.get_content(url)

        # Verify

        # We expect our get_content method to have called our http library.
        # Let's check!
        self.mock_requests.get.assert_called_with(url)

        # We can find out what our mock object has returned when get() was
        # called on it
        expected_content = self.mock_requests.get.return_value
        # Since our get_content returns the same result without modification,
        # we should have received
        self.assertEqual(content, expected_content) 
```

为了使这个过程不那么冗长，`mock`模块有一个`patch`装饰器来照顾脚手架。然后我们只需要写：

```
import core

class HttpRequestsTestCase(unittest.TestCase):

    @patch("core.requests")
    def test_get_content_should_use_get_properly(self, mock_requests):
        # Notice the extra param in the test. This is the instance of `Mock` that the
        # decorator has substituted for us and it is populated automatically.

        ...

        # The param is now the object we need to make our assertions against
        expected_content = mock_requests.get.return_value 
```

### 结论

保持单元测试小、简单、快速和独立是非常重要的。依赖另一台服务器运行的单元测试根本不是单元测试。为了帮助解决这个问题，DI 是一个很好的实践，而模拟对象是一个很好的工具。

首先，要理解模拟的概念以及如何使用它们并不容易。像每个电动工具一样，它们也可能在您的手中爆炸，例如让您相信您已经测试过某些东西，而实际上您并没有。确保模拟对象的行为和输入/输出反映现实是最重要的。

### 附言

Given that we have never interacted with a real HTTP server at the unit test level, it is important to write Integration Tests that will make sure our application is able to talk to the sort of servers it will deal with in real life. We could do this with a fully fledged server set up specially for Integration Testing, or write a contrived one.

# objective-c - 用于 iOS ARC 问题的 BWDB SQLite 包装器

> ID：11399152
> 
> 赞同：0
> 
> 时间：2012-07-09T16:21:03.253
> 
> 标签：objective-c, ios, sqlite, automatic-ref-counting, variadic-functions

我正在尝试使用 Bill Weinman 的 BWDB 包装器，可以在这里下载：http: [//bw.org/iosdata/](http://bw.org/iosdata/)

我无法正确地将其转换为 ARC，有比我更有经验的人来看看吗？主要问题是 insertRow 和 updateRow 方法中的 va_list，不知道如何处理它。其余的错误很容易摆脱。

提前感谢您的任何帮助/建议！

头文件

```
//  BWDB.h
//  Created by Bill Weinman on 2010-09-25.
//  Copyright 2010 The BearHeart Group, LLC. All rights reserved.

#import <Foundation/Foundation.h>
#import <sqlite3.h>

#define defaultDatabaseFileName @"bwtest.db"
#define BWDB_VERSION @"1.0.5"

@interface BWDB : NSObject <NSFastEnumeration> {
    sqlite3 *database;
    sqlite3_stmt *statement;
    NSString *tableName;
    NSString *databaseFileName;
    NSFileManager *filemanager;

    // for "fast enumeration" (iterator/generator pattern)
    NSDictionary * enumRows[1]; // enumerated (iterator) object(s) are passed in a C array
                                // we only ever pass one at a time
}

@property (nonatomic, retain) NSString *tableName;

// object management
- (BWDB *) initWithDBFilename: (NSString *) fn;
- (BWDB *) initWithDBFilename: (NSString *) fn andTableName: (NSString *) tn;
- (void) openDB;
- (void) closeDB;
- (NSString *) getVersion;
- (NSString *) getDBPath;

// SQL queries
- (NSNumber *) doQuery:(NSString *) query, ...;
- (BWDB *) getQuery:(NSString *) query, ...;
- (void) prepareQuery:(NSString *) query, ...;
- (id) valueFromQuery:(NSString *) query, ...;

// CRUD methods
- (NSNumber *) insertRow:(NSDictionary *) record;
- (void) updateRow:(NSDictionary *) record: (NSNumber *) rowID;
- (void) deleteRow:(NSNumber *) rowID;
- (NSDictionary *) getRow: (NSNumber *) rowID;
- (NSNumber *) countRows;

// Raw results
- (void) bindSQL:(const char *) cQuery arguments:(va_list)args;
- (NSDictionary *) getPreparedRow;
- (id) getPreparedValue;

// Utilities
- (id) columnValue:(int) columnIndex;
- (NSNumber *) lastInsertId;

@end 
```

实施文件

```
//  BWDB.m
//  Created by Bill Weinman on 2010-09-25.
//  Copyright 2010 The BearHeart Group, LLC. All rights reserved.

#import "BWDB.h"

@implementation BWDB

@synthesize tableName;

#pragma mark -
#pragma mark Object Management

- (void)dealloc {
    // NSLog(@"%s", __FUNCTION__);
    [self closeDB];
    [super dealloc];
}

// if you're not using the CRUD functions, you don't need a table name
- (BWDB *) initWithDBFilename:(NSString *)fn {
    // NSLog(@"%s", __FUNCTION__);
    if ((self = [super init])) {
        databaseFileName = fn;
        tableName = nil;
        [self openDB];
    }
    return self;
}

- (BWDB *) initWithDBFilename: (NSString *) fn andTableName: (NSString *) tn {
    // NSLog(@"%s", __FUNCTION__);
    if ((self = [super init])) {
        databaseFileName = fn;
        tableName = tn;
        [self openDB];
    }
    return self;
}

- (void) openDB {
    // NSLog(@"%s", __FUNCTION__);
    if (database) return;
    filemanager = [[NSFileManager alloc] init];
    NSString * dbpath = [self getDBPath];

    if (![filemanager fileExistsAtPath:dbpath]) {
        // try to copy from default, if we have it
        NSString * defaultDBPath = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:databaseFileName];
        if ([filemanager fileExistsAtPath:defaultDBPath]) {
            // NSLog(@"copy default DB");
            [filemanager copyItemAtPath:defaultDBPath toPath:dbpath error:NULL];
        }
    }
    if (sqlite3_open([dbpath UTF8String], &database) != SQLITE_OK) {
        NSAssert1(0, @"Error: initializeDatabase: could not open database (%s)", sqlite3_errmsg(database));
    }
    [filemanager release];
    filemanager = nil;
}

- (void) closeDB {
    // NSLog(@"%s", __FUNCTION__);
    if (database) sqlite3_close(database);
    if (filemanager) [filemanager release];
    database = NULL;
    filemanager = nil;
}

- (NSString *) getVersion {
    return BWDB_VERSION;
}

- (NSString *) getDBPath {
    // NSLog(@"%s", __FUNCTION__);
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    return [documentsDirectory stringByAppendingPathComponent:databaseFileName];
}

// iteration in ObjC is called "fast enumeration"
// this is a simple implementation
- (NSUInteger) countByEnumeratingWithState:(NSFastEnumerationState *)state objects:(id *)stackbuf count:(NSUInteger)len {
    if (*enumRows = [self getPreparedRow]) {
        state->itemsPtr = enumRows;
        state->state = 0;   // not used, customarily set to zero
        state->mutationsPtr = (unsigned long *) self;   // also not used, required by the interface
        return 1;
    } else {
        return 0;
    }
}

#pragma mark -
#pragma mark SQL Queries

// doQuery:query,...
// executes a non-select query on the SQLite database
// uses SQLbind to bind the variadic parameters
// Return value is the number of affect rows
- (NSNumber *) doQuery:(NSString *) query, ... {
    // NSLog(@"%s: %@", __FUNCTION__, query);
    va_list args;
    va_start(args, query);

    const char *cQuery = [query UTF8String];
    [self bindSQL:cQuery arguments:args];
    if (statement == NULL) return [NSNumber numberWithInt:0];

    va_end(args);
    sqlite3_step(statement);
    if(sqlite3_finalize(statement) == SQLITE_OK) {
        return [NSNumber numberWithInt: sqlite3_changes(database)];
    } else {
        NSLog(@"doQuery: sqlite3_finalize failed (%s)", sqlite3_errmsg(database));
        return [NSNumber numberWithInt:0];
    }
}

// prepareQuery:query,...
// prepares a select query on the SQLite database
// uses SQLbind to bind the variadic parameters
// use getRow or getValue to get results
- (void) prepareQuery:(NSString *) query, ... {
    // NSLog(@"%s: %@", __FUNCTION__, query);
    va_list args;
    va_start(args, query);

    const char *cQuery = [query UTF8String];
    [self bindSQL:cQuery arguments:args];
    if (statement == NULL) return;
    va_end(args);
}

// prepareQuery:query,...
// executes a select query on the SQLite database
// uses SQLbind to bind the variadic parameters
// Returns NSArray of NSDictionary objects
- (BWDB *) getQuery:(NSString *) query, ... {
    // NSLog(@"%s: %@", __FUNCTION__, query);
    va_list args;
    va_start(args, query);

    const char *cQuery = [query UTF8String];
    [self bindSQL:cQuery arguments:args];
    if (statement == NULL) return nil;
    va_end(args);
    return self;
}

- (id) valueFromQuery:(NSString *) query, ... {
    // NSLog(@"%s: %@", __FUNCTION__, query);
    va_list args;
    va_start(args, query);
    const char *cQuery = [query UTF8String];
    [self bindSQL:cQuery arguments:args];
    if (statement == NULL) return nil;
    va_end(args);
    return [self getPreparedValue];
}

// bindSQL:arguments
// binds variadic arguments to the SQL query. 
// cQuery is a C string, args is a variadic list of ObjC objects
// objects in variadic list are tested for type
// see SQLquery for how to call this
- (void) bindSQL:(const char *) cQuery arguments:(va_list)args {
    // NSLog(@"%s: %s", __FUNCTION__, cQuery);
    int param_count;

    // preparing the query here allows SQLite to determine
    // the number of required parameters
    if (sqlite3_prepare_v2(database, cQuery, -1, &statement, NULL) != SQLITE_OK) {
        NSLog(@"bindSQL: could not prepare statement (%s)", sqlite3_errmsg(database));
        statement = NULL;
        return;
    }

    if ((param_count = sqlite3_bind_parameter_count(statement))) {
        for (int i = 0; i < param_count; i++) {
            id o = va_arg(args, id);

            // determine the type of the argument
            if (o == nil) {
                sqlite3_bind_null(statement, i + 1);
            } else if ([o respondsToSelector:@selector(objCType)]) {
                if (strchr("islISLB", *[o objCType])) { // integer
                    sqlite3_bind_int(statement, i + 1, [o intValue]);
                } else if (strchr("fd", *[o objCType])) {   // double
                    sqlite3_bind_double(statement, i + 1, [o doubleValue]);
                } else {    // unhandled types
                    NSLog(@"bindSQL: Unhandled objCType: %s", [o objCType]);
                    statement = NULL;
                    return;
                }
            } else if ([o respondsToSelector:@selector(UTF8String)]) { // string
                sqlite3_bind_text(statement, i + 1, [o UTF8String], -1, SQLITE_TRANSIENT);
            } else {    // unhhandled type
                NSLog(@"bindSQL: Unhandled parameter type: %@", [o class]);
                statement = NULL;
                return;
            }
        }
    }

    va_end(args);
    return;
}

#pragma mark -
#pragma mark CRUD Methods

- (NSNumber *) insertRow:(NSDictionary *) record {
    // NSLog(@"%s", __FUNCTION__);
    int dictSize = [record count];

    // the values array is used as the argument list for bindSQL
    id keys[dictSize];  // not used, just a side-effect of getObjects:andKeys
    id values[dictSize];
    [record getObjects:values andKeys:keys];    // convenient for the C array

    // construct the query
    NSMutableArray * placeHoldersArray = [NSMutableArray arrayWithCapacity:dictSize];
    for (int i = 0; i < dictSize; i++)  // array of ? markers for placeholders in query
        [placeHoldersArray addObject: [NSString stringWithString:@"?"]];

    NSString * query = [NSString stringWithFormat:@"insert into %@ (%@) values (%@)",
                        tableName,
                        [[record allKeys] componentsJoinedByString:@","],
                        [placeHoldersArray componentsJoinedByString:@","]];

    [self bindSQL:[query UTF8String] arguments:(va_list)values];
    sqlite3_step(statement);
    if(sqlite3_finalize(statement) == SQLITE_OK) {
        return [self lastInsertId];
    } else {
        NSLog(@"doQuery: sqlite3_finalize failed (%s)", sqlite3_errmsg(database));
        return [NSNumber numberWithInt:0];
    }
}

- (void) updateRow:(NSDictionary *) record:(NSNumber *) rowID {
    // NSLog(@"%s", __FUNCTION__);
    int dictSize = [record count];

    // the values array is used as the argument list for bindSQL
    id keys[dictSize];  // not used, just a side-effect of getObjects:andKeys
    id values[dictSize + 1];
    [record getObjects:values andKeys:keys];    // convenient for the C array
    values[dictSize] = rowID;

    NSString * query = [NSString stringWithFormat:@"update %@ set %@ = ? where id = ?",
                        tableName,
                        [[record allKeys] componentsJoinedByString:@" = ?, "]];

    [self bindSQL:[query UTF8String] arguments:(va_list)values];
    sqlite3_step(statement);
    sqlite3_finalize(statement);
}

- (void) deleteRow:(NSNumber *) rowID {
    // NSLog(@"%s", __FUNCTION__);

    NSString * query = [NSString stringWithFormat:@"delete from %@ where id = ?", tableName];
    [self doQuery:query, rowID];
}

- (NSDictionary *) getRow: (NSNumber *) rowID {
    NSString * query = [NSString stringWithFormat:@"select * from %@ where id = ?", tableName];
    [self prepareQuery:query, rowID];
    return [self getPreparedRow];
}

- (NSNumber *) countRows {
    return [self valueFromQuery:[NSString stringWithFormat:@"select count(*) from %@", tableName]];
}

#pragma mark -
#pragma mark Raw results

- (NSDictionary *) getPreparedRow {
    // NSLog(@"%s", __FUNCTION__);
    int rc = sqlite3_step(statement);
    if (rc == SQLITE_DONE) {
        sqlite3_finalize(statement);
        return nil;
    } else  if (rc == SQLITE_ROW) {
        int col_count = sqlite3_column_count(statement);
        if (col_count >= 1) {
            NSMutableDictionary * dRow = [NSMutableDictionary dictionaryWithCapacity:1];
            for(int i = 0; i < col_count; i++) {
                // can't use NULL with stringWithUTF8String (bw 1.0.5)
                const char * sqliteColName = sqlite3_column_name(statement, i);
                if(sqliteColName) {
                    NSString * columnName = [NSString stringWithUTF8String:sqliteColName];
                    id o = [self columnValue:i];
                    if (o != nil) [dRow setObject:o forKey:columnName];
                    else {
                        NSLog(@"getPreparedRow: columnValue returned nil (%s)", sqlite3_errmsg(database));
                        return nil;
                    }
                } else {
                    NSLog(@"getPreparedRow: sqlite3_column_name returned NULL (%s)", sqlite3_errmsg(database));
                    return nil;
                }
            }
            return dRow;
        }
    } else {    // rc != SQLITE_ROW
        NSLog(@"getPreparedRow: could not get row: %s", sqlite3_errmsg(database));
        return nil;
    }
    return nil;
}

// returns one value from the first column of the query
- (id) getPreparedValue {
    // NSLog(@"%s", __FUNCTION__);
    int rc = sqlite3_step(statement);
    if (rc == SQLITE_DONE) {
        sqlite3_finalize(statement);
        return nil;
    } else  if (rc == SQLITE_ROW) {
        int col_count = sqlite3_column_count(statement);
        if (col_count < 1) return nil;  // shouldn't really ever happen
        id o = [self columnValue:0];
        sqlite3_finalize(statement);
        return o;
    } else {    // rc == SQLITE_ROW
        NSLog(@"valueFromPreparedQuery: could not get row: %s", sqlite3_errmsg(database));
        return nil;
    }
}

#pragma mark -
#pragma mark Utility Methods

- (id) columnValue:(int) columnIndex {
    // NSLog(@"%s columnIndex: %d", __FUNCTION__, columnIndex);
    id o = nil;
    switch(sqlite3_column_type(statement, columnIndex)) {
        case SQLITE_INTEGER:
            o = [NSNumber numberWithInt:sqlite3_column_int(statement, columnIndex)];
            break;
        case SQLITE_FLOAT:
            o = [NSNumber numberWithFloat:sqlite3_column_double(statement, columnIndex)];
            break;
        case SQLITE_TEXT:
            o = [NSString stringWithUTF8String:(const char *) sqlite3_column_text(statement, columnIndex)];
            break;
        case SQLITE_BLOB:
            o = [NSData dataWithBytes:sqlite3_column_blob(statement, columnIndex) length:sqlite3_column_bytes(statement, columnIndex)];
            break;
        case SQLITE_NULL:
            o = [NSNull null];
            break;
    }
    return o;
}

- (NSNumber *) lastInsertId {
    return [NSNumber numberWithInt: sqlite3_last_insert_rowid(database)];
}

@end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T17:42:37.990

我不知道您是否从 Lynda 培训课程或其他来源获得了 BWDB，但我尝试了它并随后转移到[FMDB](https://github.com/ccgus/fmdb)另一个更完整的包装器，顺便说一句，它已经启用了 ARC。如果您没有与 BWDB 结婚，您可能需要查看 FMDB。

如果您想坚持使用 BWDB，您可以在目标设置的“构建阶段”中将其标记为非 ARC，方法是双击“构建阶段”`BWDB.m`中的文件并指定`-fno-objc-arc`. 如果您不想，则无需转换为 ARC。您通常可以通过这种方式在 ARC 项目中使用非 ARC 代码。请参阅“我可以为特定文件选择退出 ARC 吗？” [过渡到 ARC](http://developer.apple.com/library/ios/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html#//apple_ref/doc/uid/TP40011226-CH1-SW17)常见问题解答部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T19:06:00.110

在过去的几周内，Lynda.com 发布了 Bill Weinman 课程的更新版本，题为*[iOS SDK 和 SQLite：构建数据驱动的应用程序](http://u.bw.org/ldc-iossql)*。

这个新版本解决了 ARC 问题。我已经使用 ARC 编译它并且编译得很好。

# java - 播放框架测试错误

> ID：11399154
> 
> 赞同：2
> 
> 时间：2012-07-09T16:21:20.920
> 
> 标签：java, playframework, playframework-1.x

我正在尝试在 Play 中运行一些测试，并且需要在 test/lib 目录中有一个 Play 1.x jar。但是，使用 jar 时，Play 会给出错误消息：

```
Oops: UnexpectedException
An unexpected error occured caused by exception UnexpectedException:
While applying class play.classloading.enhancers.LocalvariablesNamesEnhancer on controllers.PlayDocumentation 
```

此处的堆栈跟踪：[https ://gist.github.com/3077427](https://gist.github.com/3077427)

任何提示如何包含 jar 并避免此错误？需要 Jar，因为我正在使用`play.mvc.Http$Response`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T09:48:39.190

将 Play jar 移动到 /test/lib 之外的目录可以解决此问题

# sql-server - SSRS - 空白分组/重复问题

> ID：11399159
> 
> 赞同：1
> 
> 时间：2012-07-09T16:21:45.773
> 
> 标签：sql-server, reporting-services, ssrs-grouping

我确定这是一个快速解决方案，但它真的让我摸不着头脑，因为我是新手，在 SSRS 中处理这个级别/类型的问题......

第一个屏幕： http: [//www.pasteshack.net/images/579309001341850589.png](http://www.pasteshack.net/images/579309001341850589.png)

第二屏： http: [//www.pasteshack.net/images/431284001341850718.png](http://www.pasteshack.net/images/431284001341850718.png)

由于显而易见的原因，我不得不将我的公司信息清空，希望有足够的信息来回答我的问题。

我正在寻找 flt_Num 列以始终列出 flt_number，即使它是重复的。见[http://www.pasteshack.net/images/431284001341850718.png](http://www.pasteshack.net/images/431284001341850718.png) flt_number 0125。

我是否已经足够清楚地解释了我的目标？这非常令人沮丧，我希望这是一个简单的解决方案。

非常感谢，詹姆斯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T16:31:27.437

确保[`HideDuplicates`](http://msdn.microsoft.com/en-us/library/ms152916%28v=sql.90%29.aspx)未将单元格设置为 true。

# actionscript-3 - FLVPlayback 组件闪烁

> ID：11399163
> 
> 赞同：0
> 
> 时间：2012-07-09T16:22:01.980
> 
> 标签：actionscript-3, flash, flash-cs5

好的，

我发现了一个基于 Flash 的视频播放器，它将播放一系列从 XML 文件中读取的视频。这可以满足我的需要，但它有 1 个问题。它只有一个信号自定义播放/停止按钮，我需要完全控制。

所以我用标准的 PlayPauseButton、StopButton、SeekBar、VolumeBar 和 MuteButton FLV 组件制作了一个组件。

所以我然后去，以便代码将它们定位在我想要它们的位置。问题是我想要它们的位置也在视频的底部 25px 处。因此，当您将鼠标悬停在视频成帧器上时，我创建了进出补间。

问题是当视频播放并且您将鼠标悬停在帧上时，组件组件会像应有的那样淡入，但它们只是不断闪烁。

所以我厌倦了 FLVPlayback 皮肤，它工作得很好。所以我想知道是否有任何方法可以修复自定义按钮？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:52:52.137

您没有提供有关您的案例的足够信息，但有时我们会遇到这个问题当我们在框架概念上构建按钮并在鼠标悬停时执行播放操作只需检查您的按钮是否有多个框架，您可能会遇到这种情况。 .

# asp.net - 发布 Web 应用程序项目时找不到“在预编译的程序集中启用强命名”选项

> ID：11399165
> 
> 赞同：0
> 
> 时间：2012-07-09T16:22:15.403
> 
> 标签：asp.net, visual-studio

当我尝试发布 Web 应用程序项目时，我看不到“在预编译的程序集中启用强命名”选项。我以前在网站上看到过这个选项。有人可以对此提出建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:30:02.967

该选项在 Asp.net WEB Stie 模板上可用。创建一个 asp.net 网站，当您右键单击解决方案资源管理器时，单击发布，然后会出现一个弹出窗口，其中包含对预编译程序集启用强命名的选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:31:22.977

根据[MSDN](http://msdn.microsoft.com/en-us/library/ms178731%28v=vs.80%29.aspx)：

*   在 Visual Web Developer 的“解决方案资源管理器”窗格中，单击您的网站项目名称。

*   单击查看，然后单击属性页。或者，您可以在解决方案资源管理器中右键单击您的网站项目名称，然后单击属性页。

*   出现“属性页”窗口。单击 MSBuild 选项节点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-27T10:53:20.590

关于如何在此处的 aspnet_compiler 工具中执行此操作有一个很好的三部分系列

[http://msdn.microsoft.com/en-us/library/ms228209(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ms228209(v=vs.100).aspx)

[http://msdn.microsoft.com/en-us/library/ms228040.aspx](http://msdn.microsoft.com/en-us/library/ms228040.aspx)

希望能帮助到你。

# c# - 如何编码 html 并通过 HTTP Post 发送

> ID：11399168
> 
> 赞同：0
> 
> 时间：2012-07-09T16:22:18.963
> 
> 标签：c#, httpwebrequest, http-post

我正在尝试通过 http post 发送 html 元素。如何安全地编码和解码 html 字符串？HtmlEncode 没有帮助，因为它不编码 & 并且它看起来像新参数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:39:06.170

请使用 HttpUtility.UrlEncode()

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:38:08.587

您可能想要 URLEncode 而不是 HTMLEncode

[http://msdn.microsoft.com/en-us/library/zttxte6w.aspx](http://msdn.microsoft.com/en-us/library/zttxte6w.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T16:39:10.910

您需要以与编码查询字符串相同的方式进行编码。

```
string myPostVars = string.Format(
    "myHtml={0}&myInt={1}",
    HttpUtility.UrlEncode("<div>This is my div</div>"),
    90210
); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-09T16:48:08.753

通过 POST 传递任何内容的最安全方法是将其转换为 base64。试试 [这个](http://msdn.microsoft.com/en-us/library/dhx0d524.aspx)。

# ant - Ant 在文件集中包含目录内容，同时展平路径/到/目录

> ID：11399169
> 
> 赞同：2
> 
> 时间：2012-07-09T16:22:19.780
> 
> 标签：ant

我试图让 Ant 在 a 中包含一个目录，`fileset`而不必求助于冗长的解决方案（除非我真的必须这样做）。也许我错过了一些明显的东西。

```
<copy todir="targetdir">
    <fileset dir="@{source}">
        <include name="**/somedir/" />
    </fileset>
</copy> 
```

我正在尝试从中获取 的*内容*，`somedir`包括所有子目录，`@{source}/path/to/somedir`但不明确知道在哪里`somedir`。

所以，说`somedir`有两个子目录，`sub1`并且`sub2`，目标是让这两个目录最终进入`targetdir`（包括它们的所有内容）。

我不能把整个事情弄平，因为这会杀死子目录中的目录结构，而上面概述的当前解决方案让我有了`targetdir`contains `somedir`，而不仅仅是它的内容。

之后我不想移动目录，因为理论上我可以在具有不同路径的文件集中包含多个包含，所有这些都需要相同的副本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T21:18:23.963

There are a couple of ways to do this using [mappers](http://ant.apache.org/manual/Types/mapper.html) inside the copy element. The easiest way is to use a [cut dirs mapper](http://ant.apache.org/manual/Types/mapper.html#cutdirs-mapper) but you will need to know the amount of dirs you want to cut from the path. You could also use a [regexp mapper](http://ant.apache.org/manual/Types/mapper.html#regexp-mapper) to remove the leading dirs:

```
<regexpmapper from="^(([^/]*/)+?)/somedir/(.*)$$" to="\2"/> 
```

The above is untested but should define 2 capturing groups, everything before somedir and the bit after somedir, and replace is just the second group.

# android - 根据屏幕大小和密度从远程路径加载资源

> ID：11399172
> 
> 赞同：0
> 
> 时间：2012-07-09T16:22:30.883
> 
> 标签：android

我的 android 应用程序支持所有屏幕尺寸，但有时我需要从服务器动态加载资源，我如何确定（编程）要加载哪个资源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:26:31.323

您可以使用[DisplayMetrics](http://developer.android.com/reference/android/util/DisplayMetrics.html)类来获取各种格式的屏幕密度和屏幕宽度/高度。

您可以通过调用获取 DisplayMetrics`getWindowManager().getDefaultDisplay().getMetrics(metrics);`

只需将其放入 switch 语句中，或巧妙地格式化您的资源 URL 和请求以利用密度。

# c# - 对 C# 类中的属性进行排序

> ID：11399174
> 
> 赞同：4
> 
> 时间：2012-07-09T16:22:35.577
> 
> 标签：c#, reflection, properties, sql-order-by

我们有一个需要解析的文件格式，如下所示：

```
v1|000|sammy|endpoint|blah 
```

这是供应商提供给我们的一种有序的固定宽度格式，因此这 5 个字段中的每一个都映射到类中的特定属性（实际格式大于 30）。

我想通过将序列应用于属性来使用反射来解析它。我可以做到这一点的一种方法是自己编造一些东西 - 编写一个接受单个数字的 Attribute 类，并将该属性应用到具有其序列索引的每个属性，并在 OrderBy 子句中的反射期间查找它。

在 C# 中是否有现有的或更好的方法来执行此操作？例如，是否已经有一个属性？有没有办法在 C# 甚至 MSIL 中询问在类中声明了哪些顺序属性？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T21:22:27.460

使用 可以看到属性在元数据中出现的顺序[`PropertyInfo.MetadataToken`](http://msdn.microsoft.com/en-us/library/system.reflection.memberinfo.metadatatoken.aspx)。碰巧当前的编译器会使这个顺序与源代码中属性出现的顺序相匹配，因此通过 order by `MetadataToken`，您将获得与源代码中相同的顺序。

免责声明：未来的编译器可能会改变这一点。如果没有理由，它可能不会，但如果编译器，例如，变成多线程的，可能需要额外的不必要的努力来保持原始顺序。如果您依赖于此，请确保在 .NET Framework 以这种方式更新时出现硬错误而不是静默运行时损坏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:28:49.627

您使用的是 .net 4.0 吗？这似乎正是创建[动态关键字](http://msdn.microsoft.com/en-us/library/dd264736.aspx)的那种情况。也就是说，似乎顺序和一致性比在任何时间点发生的特定类型更重要，因此您可以通过任何让您满意的规则任意将标题、数据等分配给动态对象，然后将它们拉回使用相同的规则。这也将（大概）允许您不使用反射，这始终是一个优点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T16:26:25.303

如果您想使用基于属性的方法，我个人会为此创建一个自定义属性。这不是“标准”操作，因此框架中没有（适当的）属性可用于装饰您的类。

我的方法可能是一个类级别的属性，它接受列表中每个条目的属性名称的字符串数组，或者类似的东西。

话虽如此，我质疑基于属性的方法是否是正确的方法。您可能需要某种类型的管理器类来调解这一点，因为需要做一些“反思”过程。让该类管理此处的关系可能更有意义，尤其是因为它已经需要了解您的类层次结构（以便首先构建类）。

在这一点上，拥有一个可以直接构造对象的自定义类或方法将比尝试使用反射并动态地执行此操作要执行得更好，更易于维护，并且要简单得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-09T16:39:17.450

我建议使用类似[FileHelpers](http://filehelpers.sourceforge.net/)的东西进行解析。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-09T16:43:50.223

现在，如果性能不是一个大问题并且您正在使用反射，那么获取没有属性的映射的一种简单方法是使用 RegEx 使用组进行解析。与此实现类似： [从文本文件中读取固定宽度记录](https://stackoverflow.com/q/162727/1373170)

这使用正则表达式，例如：

```
"^(?<Field1>.{6})(?<Field2>.{16})(?<Field3>.{12})" 
```

由于您可以自己定义组名称，因此您可以明智地选择名称以与您的属性名称完全匹配，这样就可以使用反射自动映射，而无需使用属性。

**编辑：** 鉴于您最终会在字符串中使用属性名称，这不会非常“重构友好”，我强烈建议对此进行彻底的单元测试，以确保在产生不匹配时重命名您的属性会破坏测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-09T16:35:55.167

您可以考虑实现类似于[Google 的 Protocol Buffers 的](https://developers.google.com/protocol-buffers/)东西。

目前没有 C# 实现（我知道），但提供的文档非常好，应该给你一些想法，这些想法比反射慢得多且通常复杂得多。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-09T18:59:35.080

这里当然有很多可能的答案，所以这是我遇到的一个马马虎虎的答案：

System.ComponentModel.DataAnnotations 中有一个名为 ColumnAttribute 的现有属性（在 .Net 4.5+ 中，它已移至 System.ComponentModel.DataAnnotations.Schema）：

[http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.schema.columnattribute(v=vs.110](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.schema.columnattribute(v=vs.110) )

你可以像这样使用它：

```
[Column(Order=1)]
public string Version { get; set; }

[Column(Order=2)]
public string Id { get; set; } 
```

但是，如果固定宽度格式发生变化，这显然很烦人 - 如果说在开头添加了一个字段，您必须手动进入并更改您输入的 30 多个序数。由于在这种情况下我们不控制格式并且未来的版本可能会频繁出现，因此最好从在类中输入的订单属性中找到具有隐含顺序的内容。

# api - 通过 API 打破国际化

> ID：11399175
> 
> 赞同：1
> 
> 时间：2012-07-09T16:22:37.113
> 
> 标签：api, internationalization, foursquare

几天前，我使用 php-foursquare 库为 mediawiki 创建了一个小型 PHP 扩展。为了获得德语类别，我在 HTTP 标头中添加了“Accept-Language: de”，如此处所述[https://developer.foursquare.com/overview/versioning](https://developer.foursquare.com/overview/versioning)

起初一切正常，但现在我又得到了英语的结果。有没有关于这个的错误/问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T19:37:35.420

确认这是一个错误。我已经在内部向相关团队报告了它，希望它会尽快修复。

# javascript - 使用带有悬停的 raphael.js 的内存泄漏

> ID：11399177
> 
> 赞同：3
> 
> 时间：2012-07-09T16:22:43.623
> 
> 标签：javascript

使用带有悬停属性的 Raphael 库饼图会发生严重的内存泄漏。如果我删除包含悬停属性的代码，它会很好地工作，当我将其添加回内存占用量时，内存占用量会稳步增长，并且将鼠标悬停在饼图上会增加内存占用量。与大多数其他示例不同，我使用 window.setInterval 来不断更新页面（如果这有帮助的话）。我不知道如何纠正这个问题并寻求帮助。

以下是我正在做的基础知识......几乎使用 Raphael 网站上的动态饼图并为其添加间隔计时器。但是，我无法弄清楚如何在没有内存问题的情况下利用悬停效果？？？：

```
 window.onload = setInterval(drawThePie, 10000);
function drawThePie() {
    var mainCont = parent.frames["main"].document;
    mainCont.getElementById("holder").innerHTML = "Getting data..";

    //..Setting values for pieChart and legend into arrays here

    //..Looping through color array and setting values for colorlist below

            var r = Raphael("holder");
    var aCircle = r.aCircle(85,85,78).attr({fill: "black"});

            pie = r.piechart(85,85,75,data, {"legend": legend, "legendpos": "east", colors: colorlist });
    if(dataNotZero > 0) { mainCont.getElementById("holder").innerHTML = "";}

            pie.hover(function () {
                this.sector.stop();
                this.sector.scale(1.1, 1.1, this.cx, this.cy);

                if (this.label) {
                    this.label[0].stop();
                    this.label[0].attr({ r: 7.5 });
                    this.label[1].attr({ "font-weight": 800 });
                }
            }, function () {
                this.sector.animate({ transform: 's1 1 ' + this.cx + ' ' + this.cy }, 500, "bounce");

                if (this.label) {
                    this.label[0].animate({ r: 5 }, 500, "bounce");
                    this.label[1].attr({ "font-weight": 400 });
                }
            });
        }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T03:02:40.583

它看不到您的所有代码。所以我只能猜...

也许这部分被磨损了

```
this.sector.scale 
```

这部分代码可能获得了一些具有一些 DOM 参考的价值。当函数结束时，该值仍然没有释放 DOM 引用。

# fortran - 如何在 gfortran 中使用和验证四精度？

> ID：11399178
> 
> 赞同：11
> 
> 时间：2012-07-09T16:22:55.880
> 
> 标签：fortran, precision

我正在尝试在 gfortran 中使用四精度，但它似乎`real*16`不起作用。经过一番摸索，我发现它可能实现为`real*10`. `real*10` *实际上是*四精度吗？

如何测试我的代码的精度？是否有用于测试精度的标准简单算法？例如，当我想弄清楚计算机 0 是什么时，我会继续除以 2.0，直到达到 0.0。跟踪这些值让我知道计算机何时“认为”我的非零数为零 - 给我计算机零。

有没有像我描述的那样用一种算法来计算精度的好方法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-09T17:47:59.057

添加到现有答案... real*N 是该语言的扩展，最好不要使用。real*10 不是四精度。被称为“扩展”——它是英特尔处理器提供的 10 字节类型。real*16 在 gfortran 上可能可用也可能不可用，具体取决于编译器版本、硬件和 libquadmath 的可用性。如果在软件中提供，它会很慢。

Fortran 要求您想要的精度的方法是使用 selected_real_kind 函数为您想要的精度定义一个 kind 值。

```
integer, parameter :: QR_K = selected_real_kind (32)
real (kind=QR_K) :: MyReal 
```

如果可用，将获得一个四元实数。或者，使用 Fortran 2008 或更高版本，您可以“使用 ISO_FORTRAN_ENV”，然后可以访问种类值 REAL128。如果精度不可用，则种类值将为 -1。

一个相关问题：[`real*8` 是什么意思？](https://stackoverflow.com/questions/10520819/what-does-real8-mean/10521611)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-09T17:11:18.960

对现代 Fortran 代码使用种类，即

```
real(some_kind_value) :: variable 
```

然后，您可以使用`selected_real_kind()`或`iso_fortran_env`模块或模块中的`c_long_double`种类值`iso_c_binding`来获取种类变量。所有这些都有略微不同的含义。

您可以使用`epsilon()`、`tiny()`或内在函数`huge()`来`nearest()`评估代码的实际精度。

gfortran 中的四精度通常需要`libquadmath`大多数平台都可以使用的库，但默认情况下可能不可用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-09T16:31:41.473

[kind 类型参数](http://gcc.gnu.org/onlinedocs/gfortran/KIND-Type-Parameters.html#KIND-Type-Parameters)的 gfortran 文档回答了这个问题，特别是最后一句话，内容如下：

> 可用的种类参数可以在 ISO_FORTRAN_ENV 模块的常量数组 CHARACTER_KINDS、INTEGER_KINDS、LOGICAL_KINDS 和 REAL_KINDS 中找到（参见 ISO_FORTRAN_ENV）。

您可能已经发现，这`real*16`并没有在您的平台上实现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-09T17:48:12.597

real(kind=10) 是所谓的扩展 80 位精度[Wikipedia 80-bit](http://en.wikipedia.org/wiki/Extended_precision#x86_Extended_Precision_Format)。

real(kind=16) 是正确的四倍 128 位精度[Wikipedia 128-bit](http://en.wikipedia.org/wiki/Quadruple-precision_floating-point_format)。

如前所述，您可以使用 selected_real_kind()、epsilon()、tiny()、huge() 来选择和检查要使用的精度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-11T13:43:33.757

试试 gfortran 命令

> gfortran -fdefault-real-8 test.f -o test.exe

在测试文件上

```
 implicit double precision(a-h,o-z)
 1    continue
      print * , ' i:'
      read(5,*) i
      if(i.le.0) stop
      a=i
      b=sqrt(a)
      print * , b
      c=b*b
      print * , c
      goto 1
      end 
```

在我的平台（FEDORA 20）上它可以工作。

# iphone - 无法使用 Parse 将用户登录到 Facebook

> ID：11399185
> 
> 赞同：2
> 
> 时间：2012-07-09T16:23:25.117
> 
> 标签：iphone, ios, facebook, parsing, facebook-graph-api

我正在开发一个使用 Parse 作为后端并要求用户通过 Facebook 登录的应用程序。我在 facebook 上创建了一个应用程序，并按照所有说明来实施它，但我收到了一个奇怪的错误。用户被带到权限页面，一旦他们登录并接受，他们就会被带回我的应用程序。该应用程序没有崩溃，但我收到此错误消息并且用户最终为零：

```
Error Domain=facebookErrDomain Code=10000 "The operation couldn’t be completed.
(facebookErrDomain error 10000.)" UserInfo=0x6a24d80
{error=<CFBasicHash 0x6a23dc0     [0x1925b38]>
{type = mutable dict, count = 4,
entries =>
2 : <CFString 0x6a24110 [0x1925b38]>{contents = "type"} = <CFString 0x6a242f0 [0x1925b38]>{contents = "OAuthException"}
3 : <CFString 0x6a24290 [0x1925b38]>{contents = "message"} = <CFString 0x6a241a0 [0x1925b38]>{contents =
    "Error validating access token:
     Session is invalid. This could be because the application was uninstalled
     after the session was created."}
6 : <CFString 0x6a24b30 [0x1925b38]>{contents = "code"} = 190
11 : <CFString 0x6a24c70 [0x1925b38]>{contents = "error_subcode"} = 461
}
} 
```

我几乎可以肯定这是 facebook 的问题，因为我什至尝试使用 Parse 的示例项目登录，这会产生相同的结果。但是，以防万一，这是我用于登录用户的代码。

```
NSArray *permissionsArray = [NSArray arrayWithObjects:@"user_about_me",
                             @"user_relationships",@"user_birthday",@"user_location",
                             @"offline_access", nil];

[PFFacebookUtils logInWithPermissions:permissionsArray block:^(PFUser *user, NSError *error) {
    if (error)
        NSLog(@"error %@", error);
    NSLog(@"user %@", user);
}]; 
```

任何帮助表示赞赏。

谢谢，

# vector - 在顺序很重要的clojure中处理多个返回值的“正确”方式

> ID：11399186
> 
> 赞同：4
> 
> 时间：2012-07-09T16:23:30.883
> 
> 标签：vector, clojure

我正在使用打嗝来生成一些复选框，然后是标签。原始代码如下所示：

```
(check-box "check1")
(label "check1" "Check1") 
(check-box "check2")
(label "check2" "Check2")
(check-box "check1")
(label "check3" "Check3")
(check-box "check4")
(label "check4" "Check4") 
```

经过大量的修修补补，我得出以下结论：

```
(map
    (fn [x]
        (map
            #(get (vector
                (check-box x)
                (label x (capitalize x)))%)
            [0 1]))
    ["check1" "check2" "check3" "check4"]) 
```

哪个有效，但我觉得我并没有以非常类似 lisp/优化/正确/等的方式进行操作。方式 - 特别是返回一个向量只是为了用 get 舀出这些值。有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-09T16:51:04.050

也许解构是你需要的？

```
(defn multi-return-fn []
  [:1 :2 :3])

(let [[x y z] (multi-return-fn)]
    (println x)
    (println y)
    (println z)) 
```

解构也适用于 fn 参数、循环、for 循环等。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-09T18:25:00.230

正如其他人所指出的，您的问题不是很清楚，但是在正常的 Hiccup 应用程序的上下文中，假设您可能想要以下内容是合理的：

```
(apply concat
       (for [boxnum (range 1 5)
             :let [lower-name (str "check" boxnum)
                   upper-name (str "Check" boxnum)]]
         [(check-box lower-name)
          (label lower-name upper-name)])) 
```

您可以通过多种其他方式编写它；这个错误在于冗长而清晰，而不是简洁。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T18:02:43.213

**在 amalloy 评论后编辑**

我不知道打嗝，我不完全理解你想要做什么。具体来说，我不明白`get`你必须按照自己的意愿去做的那一行。但是，您似乎在说您想要来自以下代码块的返回值列表：

```
(check-box "check1")
(label "check1" "Check1") 
(check-box "check2")
(label "check2" "Check2")
(check-box "check1")
(label "check3" "Check3")
(check-box "check4")
(label "check4" "Check4") 
```

如果我是对的，那就是你想要做的，那么最简单的方法——但最不通用的方法——就是简单地将它全部包装在对 list 的调用中。但是，为了使其更通用和惯用，我会这样做：

```
(apply concat
  (for [x [1 2 3 4]
        :let [name (str "check" x)]]
    [(check-box name)
     (label name (capitalize name))])) 
```

`for`通过将一个（或多个）变量（在本例中为 x）绑定到序列中的一个元素，一次一个，然后循环，直到它通过所有这些元素。这样，它经过 1、2、3 和 4，然后在`let`binds name to内`(str "check" x)`。例如，在第一次迭代中，name 将被绑定为“check1”。剩下的就是简单地用适当的参数调用`check-box`and`label`函数。

如果你想进一步概括这一点——例如，你可能不知道你想要多少个复选框和标签——你可以像这样轻松地做到这一点：

```
(defn make-n-checkboxes-and-labels
  [n]
  (apply concat
    (for [x (range 1 (inc n))
          :let [name (str "check" x)]]
      [(check-box name)
       (label name (capitalize name))]))) 
```

在这种情况下，它现在已被泛化为一个函数，您可以执行与以前完全相同的操作，但现在通过执行以下操作：

```
(make-n-checkboxes-and-labels 4) 
```

再说一次，我没有对打嗝做任何研究，所以我可能不知道你到底想做什么。此外，Timothy 可能建议（隐含地，不明确地）用关键字替换字符串。我会重申这个建议，因为关键字应该更快更好看（在这种情况下，它们也可能更惯用）。如果你想用关键字替换你的字符串，它应该是一个简单的环绕`(keyword)`字符串的问题，如下所示：

```
(keyword (str "check" 1))
=> :check1 
```

祝你好运！

# emgucv - 如何使用 EMGU 开始图像处理？

> ID：11399190
> 
> 赞同：0
> 
> 时间：2012-07-09T16:23:48.540
> 
> 标签：emgucv

我对使用 emgu 编程完全陌生。我最近了解到使用这个库进行图像处理会很有帮助。所以我需要一本好的文本或电子书来帮助我熟悉不同的功能和结构。我会如果您说出其中最好的并告诉我在哪里可以下载它们，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-30T10:02:48.990

在此[链接](http://www.emgu.com/wiki/files/2.4.2/document/Index.html)中，您可以研究 emgu cv api 并找到所有方法描述和文档。

您还可以查看 Open CV[电子书](http://www.cse.iitk.ac.in/users/vision/dipakmj/papers/OReilly%20Learning%20OpenCV.pdf)和这本[带有](http://docs.opencv.org/opencv_tutorials.pdf)教程的电子书。

Emgu CV 的好处是可以直接调用 Open CV 方法抛出 CvInvoke 类

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T17:10:03.177

如果您正在使用 .net（您可能是）从[Aforge.NET](http://www.aforgenet.com/)开始，这是一个更容易使用的库，其中包含许多好文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-22T11:21:35.890

这真的取决于你是否有任何目标、图像处理/模式识别的先前知识、OpenCV、OO 编程知识......

如果你有一个明确的目标和一些先前的知识，一个好的开始是想想你到底想做什么，找到如何在 OpenCV 上做，并将它移植到 EMGU，首先使用 CvInvoke，然后使用 EMGU 类和使用[EMGU 文档](http://www.emgu.com/wiki/files/2.4.2/document/Index.html)来帮助您。然后，如果您有具体问题，可以在这里搜索或提问。

如果您不了解 OpenCV 或图像处理/模式识别，我建议您从它们开始（如果您想在 C# 上学习，请使用 EMGU 和 CvInvoke）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-22T00:01:20.207

你可以试试这个[网站](http://fewtutorials.bravesites.com/tutorials)，我认为它包含了学习 emgu cv 的良好开端

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-17T11:18:10.627

您可以尝试 emcu.cv.examples 并阅读这些代码，尝试，最后您应该使用这些示例编写不同的代码

# css - CSS改变流体图像的纵横比

> ID：11399194
> 
> 赞同：2
> 
> 时间：2012-07-09T16:24:03.523
> 
> 标签：css, image, image-scaling

如何制作流畅的图像，但要使用我自己决定的宽高比？（让我们说 16:9）
我已经让它变得流畅，`max-width: 100%;`但我不能改变纵横比。

注意：图像在大多数情况下具有不同的纵横比。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-09T18:13:36.497

您可以将图像包装在两个容器中。给一个容器`height:0`和一个`padding-top`你想要的图像高度与宽度成比例的百分比。因此，对于宽度的 50% 的高度，请使用`padding-top:50%`和`height:0`，正如[这里](https://stackoverflow.com/questions/9219005/proportionally-scale-a-div-with-css-based-on-max-width-similar-to-img-scaling)所解释的那样，它将使高度与宽度成 50% 成正比。

```
.wrapper {padding-top:50%;height:0;position:relative;} 
```

在该容器内，放置另一个具有以下样式的容器：

```
.inner{position:absolute;left:0;top:0;right:0;bottom:0;} 
```

现在只需将您的图像放在内部容器中并给它`width:100%`和`height:100%`

见小提琴： http: [//jsfiddle.net/henrikandersson/PREUD/1/](http://jsfiddle.net/henrikandersson/PREUD/1/) （更新了小提琴）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:39:04.993

[我在另一篇文章](https://stackoverflow.com/questions/8979520/how-do-i-get-dynamically-fluid-images-depending-on-browser-window-aspect-ratio)中找到了这段代码：

# 例子

## CSS

```
.43 img { width: auto; }
.widescreen img { width: 100%; }
.portrait img { height: 100%; } 
```

## JavaScript

```
var getAspect = function(){
    var h = window.innerHeight;
    var w = window.innerWidth;
    var aspect = w / h;

    var 43 = 4 / 3;
    var cssClass = "";

    if (aspect > 43) {
        cssClass = "widescreen";
    }
    else if (aspect === 43) {
        cssClass = "43";
    }
    else {
        cssClass = "portrait";
    }

    $("body").addClass(cssClass); // Using jQuery here, but it can be done without it
};

var checkAspect = setInterval(getAspect, 2000); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-09T16:53:45.100

它可能需要在 HTML 中添加额外的标记，但您可以使用 CSS Clip 属性将图像的可见部分剪切为您想要显示的内容。[https://developer.mozilla.org/en/CSS/clip](https://developer.mozilla.org/en/CSS/clip)

# android - 带有 URL 设置的 Android WebView

> ID：11399195
> 
> 赞同：0
> 
> 时间：2012-07-09T16:24:04.127
> 
> 标签：android, url, webview, settings

我想通过某种设置菜单设置 webview 的 URL。这样做的目的是为一台设备创建一个 Web 前端，并且该设备将设置其 IP 地址。

我希望能够将此 IP 地址设置为应用程序的 URL。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:26:58.283

WbView 有 loadUrl 方法，像这样使用它：

```
String webUrlStr = "http://www.url.com";
mWebView.loadUrl(webUrlStr); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:47:53.943

您可以将该 URL 存储在[SharedPreferences](http://developer.android.com/reference/android/content/SharedPreferences.html)对象中，并考虑使用[PreferenceActivity](http://developer.android.com/reference/android/preference/PreferenceActivity.html)屏幕对其进行编辑。

# android - 如何为小屏幕和大屏幕设置相同的webview宽度

> ID：11399196
> 
> 赞同：1
> 
> 时间：2012-07-09T16:24:05.037
> 
> 标签：android

在我的应用程序中，我使用了 webview。webviews 正在获取我加载到其中的图像的大小。现在的问题是，如果我想在 7" 或 10" 平板电脑屏幕上查看它们，我会在 webview 的右侧看到一个白色边框。

所以我希望图像适合大小屏幕上的网络视图。

这是我拥有的 webview 的代码：

```
package be.weaterApp.weatherwatch;

import android.app.Activity;
import android.app.ProgressDialog;
import android.content.pm.ActivityInfo;
import android.os.Bundle;
import android.webkit.WebView;
import android.webkit.WebViewClient;

public class Dauwpunten extends Activity{
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.temperaturen);

    String loadUrl = "http://www.meteociel.fr/cartes_obs/pointrosee.png";

    // initialize the browser object
    WebView browser = (WebView) findViewById(R.id.webviewt);

    browser.getSettings().setLoadWithOverviewMode(true);
    browser.getSettings().setUseWideViewPort(true);
    browser.getSettings().setBuiltInZoomControls(true);
    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);
    final ProgressDialog pd = ProgressDialog.show(this, "", "De kaart wordt geladen...", true);
    //setContentView(R.layout.weerforu);

    browser.setWebViewClient(new WebViewClient() {
      @Override
      public void onPageFinished(WebView view, String url) {
        pd.dismiss();
      }
    });
    try {
        // load the url
        browser.loadUrl(loadUrl);
    } catch (Exception e) {
        e.printStackTrace();
    }
}
} 
```

这是针对 xml 的：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<com.android.sdk.mobgold.MobRequest
    android:id="@+id/ad"
    android:layout_width="fill_parent"
    android:layout_height="50dip"
    android:layout_gravity="center_horizontal"
    android:clickable="true" />

<android.webkit.WebView
    android:id="@+id/webviewt"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

</android.webkit.WebView>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:30:09.693

我会将该 PNG 包装在一个小的 HTML 文件中，并将其图像标签设置为 100% 宽度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:31:00.630

如果您创建一个大小设置为图像大小的 webview，则 webview 在不同分辨率的设备上将具有不同的大小。更好的方法（如果您希望您的应用在所有屏幕尺寸上都显示相同）是使用权重 ( `android:layout_weight="X"`) 创建不依赖于内容大小的比例布局，但会使 webview而是占据屏幕的一定百分比。这样，无论设备大小如何，您都可以让您的 web 视图（例如）恰好占据屏幕的 50%。

# php - 向 CSV 文件添加新行

> ID：11399197
> 
> 赞同：59
> 
> 时间：2012-07-09T16:24:17.980
> 
> 标签：php, csv

如果我在服务器上保存了一个 CSV，我如何使用 PHP 来编写给定的行，比如`142,fred,elephants`它的底部？

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2012-07-09T16:28:15.630

打开 CSV 文件进行附加 ( [^(*文档*)](http://php.net/fopen)）：[`fopen`](http://php.net/fopen)

 *```
$handle = fopen("test.csv", "a"); 
```

然后添加您的行（[^(*文档*)](http://php.net/fputcsv)）：[`fputcsv`](http://php.net/fputcsv)

 *```
fputcsv($handle, $line); # $line is an array of strings (array|string[]) 
```

然后关闭手柄（[^(*文档*)](http://php.net/fclose)）：[`fclose`](http://php.net/fclose)

 *```
fclose($handle); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-12-24T16:26:16.723

您可以对文件使用面向对象的接口类 - SplFileObject [http://php.net/manual/en/splfileobject.fputcsv.php](http://php.net/manual/en/splfileobject.fputcsv.php) (PHP 5 >= 5.4.0)

```
$file = new SplFileObject('file.csv', 'a');
$file->fputcsv(array('aaa', 'bbb', 'ccc', 'dddd'));
$file = null; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-09-13T13:26:19.353

这个解决方案对我有用：

```
<?php
$list = array
(
'Peter,Griffin,Oslo,Norway',
'Glenn,Quagmire,Oslo,Norway',
);

$file = fopen('contacts.csv','a');  // 'a' for append to file - created if doesn't exit

foreach ($list as $line)
  {
  fputcsv($file,explode(',',$line));
  }

fclose($file); 
?> 
```

参考：[https ://www.w3schools.com/php/func_filesystem_fputcsv.asp](https://www.w3schools.com/php/func_filesystem_fputcsv.asp)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-02T12:41:21.947

如果您希望每个拆分文件保留原始文件的标题；这是hakre答案的修改版本：

```
$inputFile = './users.csv'; // the source file to split
$outputFile = 'users_split';  // this will be appended with a number and .csv e.g. users_split1.csv

$splitSize = 10; // how many rows per split file you want 

$in = fopen($inputFile, 'r');
$headers = fgets($in); // get the headers of the original file for insert into split files 
// No need to touch below this line.. 
    $rowCount = 0; 
    $fileCount = 1;
    while (!feof($in)) {
        if (($rowCount % $splitSize) == 0) {
            if ($rowCount > 0) {
                fclose($out);
            }
            $out = fopen($outputFile . $fileCount++ . '.csv', 'w');
            fputcsv($out, explode(',', $headers));
        }
        $data = fgetcsv($in);
        if ($data)
            fputcsv($out, $data);
        $rowCount++;
    }

    fclose($out); 
```***

# html - $.mobile.changePage 在 IE9 中不起作用，但在 FireFox 中起作用（12）

> ID：11399200
> 
> 赞同：1
> 
> 时间：2012-07-09T16:24:27.130
> 
> 标签：html, jquery-mobile, internet-explorer-9

我正在使用 IE9。

以下代码在 FireFox 12 中运行良好

```
 var sst;
    sst = '<li>test12</li>';
    $.mobile.changePage('#ChooseProg', { transition: "slideup" });                                        
    $('#RepData').html(sst); 
```

这是 ChoosProg 页面的样子：

```
 <div data-role="page" id="ChooseProg" data-title="Choose Prog">

     <div data-role="header" data-position="fixed" class="ui-btn-right" style="min-height:42px;">
     <h1>Select Program</h1>            
     </div>

     <div data-role="content">          
     <ul id="RepData" data-role="listview" data-filter="false" data-inset="true">   
     <li>
     </ul>
     <p>&nbsp;</p>          
     </div><!-- /content -->

     <div data-role="footer" data-position="fixed" class="ui-btn-right" style="min-height:42px;">
     </div>

     </div> <!-- /page --> 
```

在 IE9 中，它没有给出任何错误，而且我似乎没有进入 ChooseProg 页面。

# javascript - 匹配美国电话模式的正则表达式

> ID：11399201
> 
> 赞同：0
> 
> 时间：2012-07-09T16:24:27.893
> 
> 标签：javascript, regex

我想验证一个美国电话号码，这是我目前所拥有的：

```
var numberRegex = /^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/ 
```

我的问题是这允许单括号。

这将允许传递一个左括号而没有像这样的右括号：`(111-121-1212`.

有没有人有一个正则表达式脚本可以匹配美国电话号码并考虑括号？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:26:56.357

使用替代品 ( `|`)：

```
(?:
 \(([0-9]{3})\)
  |
 ([0-9]{3})
) 
```

结果 re 看起来像：

```
var numberRegex = /^(?:\(([0-9]{3})\)|([0-9]{3}))[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:27:27.170

[RegExLib 可能有你的解决方案](http://regexlib.com/DisplayPatterns.aspx?categoryId=7&cattabindex=6&AspxAutoDetectCookieSupport=1)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-09T16:28:00.040

我建议不要这样做。验证电话号码的唯一方法是尝试拨打电话，看看谁接听。电话号码可能在语法上看起来是正确的，但在语义上仍然可能是错误的（即假电话号码）。

您能做的最好的事情就是警告用户电话号码“看起来无效”，但无论如何都接受任何输入。

# oracle - 我需要授予访问权限以在另一个模式中使用一个模式的表

> ID：11399202
> 
> 赞同：3
> 
> 时间：2012-07-09T16:24:27.920
> 
> 标签：oracle, oracle10g

我有一个模式 [A]，它有一个包，其中一个函数调用另一个模式的 [B] 表 [tableB]。当我编译包时出现错误，“表或视图不退出”我用谷歌搜索发现错误是因为我的包正在调用另一个模式的表。后来我发现我必须在被调用的模式[B]中授予特权。在 Schema B 的包中，我编写了以下代码

程序 givePrivilege 开始 GRANT SELECT ON tableB TO A; 结尾;

我是甲骨文的新手，我很震惊。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-09T16:27:43.153

跟着这些步骤：

1) 登录到模式 B
2) 运行语句`GRANT SELECT ON tableB TO A;`
3) 在包中确保 tableB 被引用为 B.tableB
4) 编译包。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T16:27:27.567

作为 B，您只需授予 A`SELECT`对表的权限。您无需创建授予权限的过程。您只需要`GRANT`在以 B 身份登录时执行该语句。

```
GRANT SELECT ON tableB
   TO a 
```

# c# - 最新的 .NET 性能清单

> ID：11399215
> 
> 赞同：0
> 
> 时间：2012-07-09T16:25:38.300
> 
> 标签：c#, .net, architecture

搜索提高我的 .NET 应用程序的性能，我在 MSDN 上找到了以下文章：http: [//msdn.microsoft.com/en-us/library/ff647606](http://msdn.microsoft.com/en-us/library/ff647606)

这些文章已经过时，我正在寻找更新、维护和有效的清单。

有没有人有任何最新的技巧来改进 ac# 4.0 Winform 应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:33:47.297

> 这些文章已经过时，我正在寻找更新、维护和有效的清单。

没有任何新的“官方”名单。我相信这是因为清单很容易被滥用。总是有例外，清单将重点放在错误的事情上。由于 .NET 自 1.1 天（即设计该清单的时间）以来已经证明了自己，因此对这些清单的需求并不那么重要。

与其关注清单，不如直接根据需要进行测量和调整。如果您的计划正确（即：首先制定良好的性能预算），分析将告诉您*准确*地将精力和时间花在哪里。

清单倾向于强调查看所有代码，这不是对优化资源的有效利用。

话虽如此，您引用的列表实际上仍然具有相关性并且基本有效。只是意识到现在通常有更好的方法（即：泛型确实改变了很多指导，因为这些列表中的重点围绕管理装箱和拆箱等）。

# java - 读取远程 XML 文件或将其复制到语言环境（使用 Java）？

> ID：11399222
> 
> 赞同：1
> 
> 时间：2012-07-09T16:26:11.730
> 
> 标签：java, xml, performance

我的问题是关于使用 Java 读取远程 XML 文件。我的文件存储在一台运行 Windows CE 的设备中。我应该每天多次访问这些设备中的一些。考虑到网络限制、TCP 会话的建立和数据丢失，哪种解决方案更有效：远程打开和读取文件还是在本地获取一份副本到服务器然后处理它？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T18:01:15.347

似乎您希望服务器从客户端读取文件，而大多数情况下相反。在这种情况下，您应该有一些从客户端到服务器的推送功能，这可以通过 HTTP。

或者您可以在客户端中运行一个 Http 连接侦听器，该侦听器接受来自服务器的请求并将 XML 文件发送回服务器。本质上它就像在客户端中运行的服务器线程。

不确定你是否在 Windows CE 上运行 JAVA。在 Windows CE HTTP 侦听器中寻找解决方案。

看看有没有帮助

# file-io - unix 命令“mv”失败

> ID：11399224
> 
> 赞同：3
> 
> 时间：2012-07-09T16:26:26.250
> 
> 标签：file-io, unix, mv

我正在使用 move 命令`mv -f $file1 $file2`将文件从源目录移动到目标目录。我收到一条失败消息：

```
mv: cannot create regular file $file2:File exists 
```

你能告诉我移动命令失败的原因吗？

有没有办法解决这个错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-11-30T13:56:47.280

这是由竞争条件引起的。`mv`你在你的脚本中运行了多个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:28:41.897

那个文件真的存在吗？如果它存在，并且您**确定**要覆盖它，请添加 -f 标志，这将强制命令继续；

```
mv -f file1 file2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T23:12:35.693

此错误可能是由权限冲突引起的，有时是由在文件名中使用非法字符引起的。确保文件名中没有不寻常的特殊字符，并确认文件移动到的目录中没有同名文件。您可能需要使用`ls -l`上述目标目录来查看权限设置是否允许您读取/写入该目录。

# javascript - 为什么选择器“：按钮”不适用于点击事件？

> ID：11399236
> 
> 赞同：3
> 
> 时间：2012-07-09T16:26:58.207
> 
> 标签：javascript, jquery

嗨，我正在使用 Jquery 选择器“：按钮”，但不能与点击事件结合使用....

```
$(":button").click(function () {
   alert("click");
   return false;
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T16:30:56.733

确保将代码放入 jQuery 文档就绪函数中：

```
$(function(){

   /** YOUR CODE **/
   $(":button").click(function () {
       alert("click");
       return false;
   });

}); 
```

但正如我从[您对 OP 的评论中](https://stackoverflow.com/questions/11399236/why-selector-button-doesnt-work-with-click-event/11399304#comment15029142_11399236)看到的那样，您实际上可能想要这样做：

```
$(function(){

   /** YOUR CODE **/
   $(":submit").click(function () {
       alert("click");
       return false;
   });

}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-09T16:31:16.013

您可能有以下问题；

*   可能会忘记在您的代码中添加 jQuery 库

*   可能是你忘记了`$(document).ready()`包装，即

    ```
    $(document).ready(function() {
      // place all jquery code here
      $(':button').on('click', function() {
         alert('click');
         return false;
      });
    }); 
    ```

*   `:button`可以动态添加到 DOM 中，即在页面加载之后

    在这种情况下，您应该尝试：

    ```
    $('body').on('click', ':button', function() {
      alert('Click');
      return false;
    }); 
    ```

### 根据你上面的评论

你可以试试这个：

```
$('input[type=submit]').on('click', function() {
   alert('click');
   return false;
}); 
```

**或者**

```
$('input[type=submit]').on('click', function(e) {
   alert('click');
   e.preventDefault();
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-09T16:34:38.750

jQuery 的[`:button`](http://api.jquery.com/button-selector/)选择器等价于`$('button, input[type="button"]')`. 因此，它与您的控件不匹配：`<input type="submit" value="Create" />`.

尝试`$('input[type="submit"]')`改用（您可以使用`$(':submit')`，但`[type="submit"]`可能更快）。

# php - 无法重定向到粉丝页面或其他链接

> ID：11399238
> 
> 赞同：1
> 
> 时间：2012-07-09T16:27:02.243
> 
> 标签：php, facebook

我为一个假日网站制作了一个 Facebook 应用程序，用户可以使用他们的 Facebook 帐户登录并投票给团队成员。

当用户（使用他的 Facebook 帐户登录）投票给成员时，一个简单的帖子会发布到他的墙上：

```
 $wallPost = array(
        'message' => 'A simple message here',
        'link' => 'http://www.facebook.com/link_to_fan_page',
    ); 
```

现在如果我点击我墙上的帖子，链接会按预期重定向到粉丝页面，但是如果朋友或其他人（与应用程序无关）查看我的墙点击链接，重定向到风扇没有发生，他们得到一个弹出错误。

***application_name* 发生错误。请稍后再试**

publish_stream**权限**设置正确。

因为没有应用重定向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T13:13:10.423

我已经解决了更换

```
$publishStream = $this->facebook->api('/me/feed', 'post', $wallPost); 
```

和

```
$publishStream = $this->facebook->api('/me/links', 'post', $wallPost); 
```

有关**提要**和**链接**的更多信息，请查看[http://developers.facebook.com/docs/reference/api/user/](http://developers.facebook.com/docs/reference/api/user/)

# jquery - 引导选项卡上的 CodeMirror 克隆显示功能

> ID：11399239
> 
> 赞同：0
> 
> 时间：2012-07-09T16:27:02.650
> 
> 标签：jquery, twitter-bootstrap, codemirror

我的项目有问题。我的应用程序执行以下操作：

1.  从脚本文件加载信息。
2.  使用 CodeMirror 进行编辑
3.  保存回服务器

我已经使用 Twitter BootStrap Tabs 和 Code Mirror 进行语法高亮。

我接下来要做的是：当 Tab Show 时，我需要将内容从文件加载到 textarea，然后从中创建 CodeMirror Editor。但是，当我尝试时，每次 onShown 事件触发时我都会克隆 CodeMiror 对象。

```
<!-- ==============================IWSSID-LUA-TAB======================================================-->

    <div class="tab-pane fade" id="iwssid-lua-tab">

        <div>
            <button id="save-iwssid-code" class="btn btn-info" onclick="set_data('lua/iwssid.lua',$('#iwssid-lua-code').val())">Save</button>
            <a href="lua/iwssid.lua" target="_blank" class="btn btn-success pull-right">Dowload File</a>
        </div>

        <br>

        <form>
            <div>
                <textarea id="iwssid-lua-code" name="iwssid-lua-code"></textarea>
            </div>
        </form>

        <script>
            $(function () {

              $('a[href="#iwssid-lua-tab"]').on('shown', function (e) {
                                                post = get_data('lua/iwssid.lua'); 
                                                $('#iwssid-lua-code').val(post);
                                                var iwssid_editor = CodeMirror.fromTextArea(document.getElementById("iwssid-lua-code"), {
                                                                                            mode: "lua",
                                                                                            autofocus: true,
                                                                                            lineNumbers: true,
                                                                                            lineWrapping: true,
                                                                                            onCursorActivity: function() {

                                                                                            iwssid_editor.setLineClass(hlLine, null, null);
                                                                                            hlLine = iwssid_editor.setLineClass(iwssid_editor.getCursor().line, null, "activeline");
                                                                                            },                                                                                        
                                                                                            onBlur: function () { 
                                                                                                iwssid_editor.save();
                                                                                            }
                                                                                            });
                                                var hlLine = iwssid_editor.setLineClass(0, "activeline");
                                                })
              })
            </script>
    </div>
    <!-- ==============================END OF IWSSID-LUA-TAB======================================================--> 
```

set_data 和 get_data 方法：

```
<script>
    function get_data(file) {
        var post;
        $.ajax({
               type: "POST",
               async: false,
               url: "filemanager.php",
               data: { command: "get", filename: file }
               }).done(function(msg ) {
                       post = msg;

                       });
        return post;
    }

    function set_data(file, content) {
        $.ajax({
               type: "POST",
               url: "filemanager.php",
               data: { command: "set", filename: file, data: content }
               }).done(function(msg ) {
                       alert("Done");
                       });
    }

    </script> 
```

在创建新的之前，我尝试设置`iwssid_editor = null`and `delete iwssid_editor`，但没有成功。请解释我的错误。 [这是我的问题的屏幕截图](http://i.imgur.com/Dv9M4.png)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-07T06:24:48.867

为什么不在页面加载时创建 Codemirror 编辑器？

# jquery - 尝试在easySlider轮播中显示所有图像的替代文字

> ID：11399243
> 
> 赞同：2
> 
> 时间：2012-07-09T16:27:07.250
> 
> 标签：jquery, html, append, image

我有以下html：

```
<div id="slider">
    <ul>
        <li><a href="#" filename="strangeweather_1"><img src="large/strangeweather_1.jpg" alt="Baby, You're Just Like Stereo Equipment - ink, watercolor, gouache on paper" /></a></li>
        <li><a href="#" filename="strangeweather_2"><img src="large/strangeweather_2.jpg" alt="I Don't Mind If You Sleep Through This Or It Wakes You - ink, gouache, watercolor on paper" /></a></li>
        <li><a href="#" filename="strangeweather_3"><img src="large/strangeweather_3.jpg" alt="It's Not Over Yet - ink, watercolor, gouache, graphite on paper" /></a></li>
    </ul>
</div>

<div id="contentTitle"><!-- append alt text here -->
</div> 
```

我的 jQuery 看起来像这样：

```
$(document).ready(function() {
   var altText = $(this).find('#slider ul li img').attr('alt');
   $('div#contentTitle').append(altText); 
```

});

这似乎适用于文档加载时的第一个 img alt。不确定如何在通过轮播加载每个图像时显示其替代文本。

jquery 是否有效地获取 alt 的副本并将其存储以进行操作？我正在考虑使用 .offset() 在绝对位置显示 alt。我不知道每次加载当前图像时如何显示 alt。

希望这是有道理的。

所有代码都在这里：[http ://dev.jessicaharby.com/work/](http://dev.jessicaharby.com/work/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:29:57.393

你可以试试[`each()`](http://api.jquery.com/jQuery.each/)方法：

```
$(document).ready(function() {
   $('#slider ul li img').each(function() {
         $('div#contentTitle').append($(this).attr('alt'));
   }); 
}) 
```

[演示](http://jsfiddle.net/7zs5W/3/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-09T16:30:41.373

尝试这个：

**更新**：修正错别字

```
$(document).ready(function() {
     var altText = "";
     $('#slider ul li img').each(function(a, b){
        altText += $(b).attr('alt') + "<br/>";
     });

   $('#contentTitle').append(altText); //Remove the div from the slecttor, since you are using ID selector this version is faster.
}); 
```

JsFiddle：http: [//jsfiddle.net/vsDze/](http://jsfiddle.net/vsDze/)

# php - PHP for循环输出中的漂亮HTML格式

> ID：11399244
> 
> 赞同：2
> 
> 时间：2012-07-09T16:27:09.733
> 
> 标签：php, html, for-loop, formatting

我很确定我在这里或其他地方找不到答案，或者可能是因为我无法提出正确的问题是我的错，但无论如何，说我的 PHP 中有一个 for 循环，它是这样的：

```
for($i=0; $i<3; $i++){
echo "<a href=\"\">$i</a> | ";
} 
```

如何使最后一次调用“ | ”不出现以便获得良好的输出：

```
<a href="">0</a> | <a href="">1</a> | <a href="">2</a> 
```

代替

```
<a href="">0</a> | <a href="">1</a> | <a href="">2</a> | <-- remove this! :( 
```

你们太棒了！谢谢！！！

如果 $i < $undefinedNumber 怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:35:18.213

保持流程，如果它不是第一个，你只需要它：

```
for ($i = 0; $i < 3; $i++) {
    echo $i ? " | " : '', "<a href=\"\">$i</a>";
} 
```

对于第一个`$i`is`0`这意味着它是`false`. 否则`$i`为正整数，表示`true`。

有时找到描述问题的替代方法有助于制定更简单的答案。代替：

```
<a href="">0</a> | <a href="">1</a> | <a href="">2</a> |  /* <-- remove this! :( */ 
```

就是这个问题：

```
/* :( remove this! --> */ | <a href="">0</a> | <a href="">1</a> | <a href="">2</a> 
```

* * *

相同形式的解决方案也适用于 CSS：

```
a:not(:first-child):before {content: ' | '} 
```

有时这比摆弄 PHP 和 HTML ( [Example](http://codepad.viper-7.com/XAJ7zq) ) 更容易集成 - 但是这会添加`|`到链接文本或样式中(至少在我测试它的 chrome 中，看起来有问题)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:28:52.560

```
for($i=0; $i<3; $i++){
   echo "<a href=\"\">$i</a>"
   if ($i != 2) {
      echo " | ";
   }
} 
```

或者

```
echo "<a href=\"\">0</a>";
for($i=1; $i<3; $i++){
   echo " | <a href=\"\">$i</a>"
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T16:30:53.490

```
for($i=0; $i<3; $i++) {
    if ($i == 0) {
       echo "<a href=\"\">$i</a>;
    }
    else {
       echo " | <a href=\"\">$i</a>"
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-09T16:32:01.883

所以你只需要从输出中删除最后一个栏？为什么不在循环时跳过它？像这样的东西：

```
for($i=0; $i<3; $i++)
{
    echo "<a href=\"\">$i</a>";

     if($i < 2)
         echo "|";
} 
```

这将确保该栏仅在前两个链接之后显示，而不是在第三个链接之后显示。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-09T16:32:09.253

```
$output=array();
for($i=0; $i<3; $i++){
    $output[]="<a href=\"\">$i</a>";
}
$ouput=implode(' | ', $ouput); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-09T16:32:33.207

```
$arr = array();

for ($i=0; i<3; i++)
    $arr[] = "<a href=''>$i</a>";

echo implode(" | ",$arr); 
```

* * *

更紧凑的版本：

```
echo implode(" | ", array_map(function($x){return "<a href=''>$x</a>";},range(1,3))); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-09T16:34:13.483

你也可以这样做：

```
for($i=0; $i<3; $i++) {
    $arr[] = "<a href=\"\">$i</a>";
}
echo implode(' | ',$arr); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-09T16:39:29.320

这是编程中常见的情况，称为特例模式。[除了使用 if 语句或三元运算符](http://en.wikipedia.org/wiki/Ternary_operation#Perl.2C_PHP)之外，没有内置的方法可以解决这个问题

```
for($i=0; $i<3; $i++){
    echo "<a href=\"\">$i</a>" . ($i != 2) ? " | " : ""; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-07-09T16:40:28.743

不要在 php 中做，在样式表中做。

首先构建你的 HTML

```
<ul class="navlinks">
     <?php foreach($links as $linkName => $linkUrl): ?>
     <li><a href="<?php echo $linkUrl; ?>"><?php echo $linkName; ?></a></li>
     <?php endforeach; ?>
</ul> 
```

应用 CSS。

```
.navlinks > li:after
{ 
    content:"<li>|</li>";
}

.navlinks > li:last-child:after
{ 
    content:"";
} 
```

您永远不应该在 php 中设置 HTML 样式，这是正确的做法。

# git - 将文件从 master 分支授权到 rebased 分支

> ID：11399253
> 
> 赞同：1
> 
> 时间：2012-07-09T16:27:39.260
> 
> 标签：git, branching-and-merging

我在 master 及其客户私有分支中有一个通用文件“foobar”。以前他们分道扬镳，现在我设法获得了一个适用于 master 中所有私有分支的文件。

为了让我的客户分支机构跟踪master，我已经成功使用了`git rebase -i master`.

但是，我现在已经`git checkout master -- foobar`在我的私人分支中强制“同步”，提交它，现在我的 git rebases 出错了。每次手动修复都需要很长时间。

```
git checkout master -- foobar && git add foobar && git rebase --continue 
```

有人可以提供一两个提示如何摆脱这种棘手的情况吗？恢复我在私有分支上的提交不是问题。基本上我希望我的所有分支都使用来自 master 的 foobar 文件，结束。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T19:59:24.177

通过属性使用自定义合并驱动程序：

```
git checkout master
echo foobar merge=checkoutMaster > dir/to/foobar/.gitattributes
git add dir/to/foobar/.gitattributes
git commit -m "Always use master version of foobar"
git config merge.checkoutMaster.name "Use master version of foobar"
git config merge.checkoutMaster.driver "~/checkoutMasterFoobar.sh %O %A %B"
echo "git checkout master -- dir/to/foobar/foobar && exit 0" > ~/checkoutMasterFoobar.sh 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T15:53:07.707

我想我已经找到了解决方案，我重新设置了基础，然后从 master 签出更改。

当你做相反的事情时，坏事就会发生。即从master 签出文件，然后rebase。

# facebook - fancybox 中的 facebook 登录按钮仅在第一次正确加载

> ID：11399259
> 
> 赞同：0
> 
> 时间：2012-07-09T16:28:00.713
> 
> 标签：facebook, fancybox

我正在将 facebook 登录按钮添加到 fancybox（1.3.4 版）模式（一个用于加入，一个用于登录）。facebook 按钮都在页面加载时被实例化，但被隐藏。触发fancybox登录模式后，facebook按钮在模式中被重写并第一次正确加载。但是，如果您关闭模式然后第二次或第三次重新加载它，则没有 facebook 登录按钮。它只是空白。当我查看基于模式的 fancybox 的内联 html 块时，最初加载页面时生成的 facebook 按钮标记消失了……实际上并没有完全消失，但是 iframe 深处的按钮代码被清除了。

我已经看到了对这些 facebook 按钮 iframe 的建议，所以我尝试添加 iframe 而不是原始的 facebook 按钮标记。请注意，我没有使用 iframe fancybox 类型，我目前不能这样做。当我包含`<iframe src="/myfacebookbuttonpage"></iframe>`在模态部分中时，它再次正确加载，然后在关闭模态后，查看源代码我可以看到 iframe 重写为`<iframe src="about:blank"></iframe>`并且 iframe 的内部是空白的。

有人知道这里发生了什么吗？还是出于某种原因，这种尝试在fancybox modals 中包含facebook 登录按钮是完全错误的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:10:16.440

这是使用内联 iframe 时 fancybox v1.3.2+ 中的一个错误。

作为一种变通方法，您可以编辑 fancybox`js`文件或在您的自定义 fancybox 脚本中应用变通方法。

[转到此处获取更多说明](http://groups.google.com/group/fancybox/browse_thread/thread/feec524b4c0199bc)

# ruby - instance_eval 的行为不一致

> ID：11399276
> 
> 赞同：0
> 
> 时间：2012-07-09T16:29:02.083
> 
> 标签：ruby

当将一个块传递给 instance_eval 时，它意味着在该实例的上下文中执行。*self*在该块中显式或隐式引用时，应引用已调用 instance_eval 的实例。这似乎在所有情况下都可以正常工作，除非传递已转换为 proc 的方法对象。在这种情况下，*self*指的是定义方法的实例，而不是评估块的实例。这是一个代码示例来演示我的意思：

```
class A
  def test(&b)
    instance_eval(&b)
  end
end

class B
  def test_a(a)
    a.test { puts self }
  end

  def test_b_helper(*args)
    puts self
  end

  def test_b(a)
    m = method(:test_b_helper).to_proc
    a.test(&m)
  end
end

a = A.new
b = B.new

b.test_a(a) #<A:0x007ff66b086c68>
b.test_b(a) #<B:0x007fa3e1886bc0> 
```

预期的行为是两个测试都返回相同的输出。在这种情况下，*self*应该引用 A 的实例，而不是 B。

我查看了文档并进行了一些搜索，但我无法找到有关此特性的信息。我希望有一些经验丰富的 Ruby 专家可以帮助消除这种行为差异。

澄清一下，我使用的是 Ruby 1.9.2。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T17:01:23.777

不同之处在于， Blocks 和 Procs 是*闭包*， Method 对象不是。

摘自 D. Flanagan, Y. Matsumoto。*Ruby 编程语言*，O'Reilly 2008，p。204：

> `Method`对象和对象之间的一个重要区别`Proc`是 Method 对象不是闭包。Ruby 的方法旨在完全自包含，并且它们永远无法访问自己范围之外的局部变量。`Method`因此，对象保留的唯一绑定 `self`是要调用方法的对象的值。

现在，当您强制转换 Method 对象`to_proc`时，您将 的值绑定`self`到 B 的调用实例，因此您将获得上述结果。实际上，在您创建对象`self`时已经修复。`Method`

当您考虑以下代码时，这一点变得特别清楚：

```
class A
  def foo
    puts 'bar'
  end
end

class B; end

class C < A; end

foo = A.instance_method(:foo)
# => #<UnboundMethod: A#foo>

a = A.new
foo.bind(a).call
# bar

b = B.new
foo.bind(b).call
# TypeError: bind argument must be an instance of A

c = C.new
foo.bind(c).call
# bar 
```

简单地说：`self`总是固定在`Method`和`UnboundMethod`对象上。

# ruby-on-rails - as_json 与 :except 不工作

> ID：11399281
> 
> 赞同：1
> 
> 时间：2012-07-09T16:29:24.343
> 
> 标签：ruby-on-rails, json

我正在尝试格式化 json 响应，删除不需要的字段以获得较小的响应（即 created_at 和 updated_at）

我目前正在这样做：

```
friends = @user.friends
friends.each do |f|
  f[:name] = f.user.username # adding arbitrary attribute needed in the response
end
render :json => friends.as_json(:except => [:created_at, :updated_at]) 
```

created_at 和 updated_at 仍然包含在响应中，我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T16:54:14.740

`:except`不会处理嵌套在数组中的属性。您可以在实例本身上使用它：

```
friends = @user.friends.map do |f|
  f[:name] = f.user.username # adding arbitrary attribute needed in the response
  f.as_json(:except => [:created_at, :updated_at]
end
render :json => friends 
```

# java - java中的模式匹配错误

> ID：11399284
> 
> 赞同：1
> 
> 时间：2012-07-09T16:29:45.660
> 
> 标签：java, regex

当我使用以下代码片段时，我遇到了一个问题

```
 String regexString=regexPair.get(paramName);

 Pattern p = Pattern.compile(regexString);
 Matcher m = p.matcher(paramMap.get(paramName)[0]);
 status = m.matches(); 
```

它返回假

其中 regexPair 是 hashmap 和 regexPair.get(paramName) 是

```
"^[_A-Za-z0-9-]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9]+(\\.[A-Za-z0-9]+)*(\\.[A-Za-z]{2,})$" 
```

而我会尿布

```
String regexString="^[_A-Za-z0-9-]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9]+(\\.[A-Za-z0-9]+)*(\\.[A-Za-z]{2,})$" 
```

然后它工作正常

`paramMap.get(paramName)[0]`返回 agsd@gmail.com。

我不明白为什么会发生这种情况，请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:42:00.097

你怎么知道那`regexPair.get(paramName)`是你给的字符串？这是某个`println`电话的结果吗？

我怀疑引用并不完全相同。可能`regexPair.get(paramName)`实际包含`'\\'`后跟另一个`'\\'`（即连续两个真正的反斜杠），而替换只包含`"\\"`（这是一个反斜杠）。请注意，该字符串`"(\\."`实际上只有 3 个字符长。

# api - 如何选择最受欢迎的对象，例如列出最常阅读的文章

> ID：11399285
> 
> 赞同：0
> 
> 时间：2012-07-09T16:29:45.753
> 
> 标签：api, facebook-opengraph

我正在考虑创建一个社交阅读器应用程序，用户可以在该应用程序上阅读我发布的文章。

在应用主页上，我想列出阅读次数最多的文章。

有没有办法使用 FB API 来做这个客户端，或者我可以从 FB API 服务器端获取数据并存储它？

还是我需要整理我自己的数据存储中的读取计数并创建列表服务器端？

我打算有自定义对象和动作，我基本上想要一个按动作列出的最受欢迎的对象

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T06:28:24.993

> 有没有办法使用 FB API 来做这个客户端

不，我不这么认为。

> 或者我可以从 FB API 服务器端获取数据并存储它吗？

当然，只需将其保存到数据库并执行您的逻辑即可。例如，当用户阅读文章时，增加数据库表中每一页的计数。然后使用拉取“TOP X”的 SQL 查询

```
select top 10 * from articletable order by NumRead asc 
```

当用户调用 news.read 时，会返回一个操作实例 id，在调用后立即检查相应文章的 ID

```
FB.api(
'/me/news.reads',
'post',
{ article: 'URL_TO_ARTICLE' },
function(response) {
   if (!response || response.error) {
      alert('Error occured');
      console.log(response.error);
   } else {
      FB.api(
       response.id, function(response) {
         var data = response['data'];
         var video = data['article']; 
         // Send to your database logic article['id'];
       });
   }
}); 
```

或者您完全跳过第二个 API 调用，只需将当前页面保存在表中并增加其计数。

# java - Android JAVA：读取线程正在访问的变量

> ID：11399286
> 
> 赞同：0
> 
> 时间：2012-07-09T16:29:55.457
> 
> 标签：java, android, thread-safety

我有一个带有多个屏幕的应用程序。此外，我有一个全局运行的计时器，它偶尔（每分钟左右）尝试从网站刷新他们的交易数据并将其存储在 JSONArray ( `static JSONArray jTransactions`) 中。

当你进入 Transaction 屏幕时，它做的第一件事就是用 jTransactions 的内容填充 ListView，它会每隔几秒刷新一次显示的信息。但是，如果 web 线程当前正在运行，我会得到所有内容的空值。

我有足够的编码能力，知道这是一个线程问题，但我对 JAVA/Android 开发的经验不足，不知道如何处理它。而且我的 Google-fu 可能很弱，但我发现的唯一答案要么不适用，要么涉及大量重写。

我想我的问题是——我怎样才能改变我的代码，以便我的活动和获取线程之间没有直接冲突？

我也完全接受我的代码可能很丑；正如我所说，我还在学习这个平台。

这是我正在运行的线程的精简版本：

```
 static int iRefreshTransactions = 30000;
        static boolean bRefreshingTransactions = false;
        static Calendar cLastRefreshTransactions = null;
        final Runnable mRefreshTransactions = new Runnable() {
           public void run() {
               mHandler.removeCallbacks(this);
               Thread T = new tRefreshTransactions();
               T.start();
           }
        };
        private class tRefreshTransactions extends Thread {
            @Override
            public void run() {
            bRefreshingTransactions = true;
            RetrieveTransactions();
                bRefreshingTransactions = false;
                handler.sendEmptyMessage(0);
            }
            private Handler handler = new Handler() {
                @Override
                public void handleMessage(Message msg) {
                    cLastRefreshTransactions = Calendar.getInstance();
                    ShowToast("cLastRefreshTransactions(): " + cLastRefreshTransactions.getTime().toLocaleString());
                    mHandler.postDelayed(mRefreshTransactions, iRefreshTransactions);
            }
            };
            private Handler failhandler = new Handler() {
                @Override
                public void handleMessage(Message msg) {
                    // handle the failure somehow
                }
            };
        } 
```

这是 RetrieveTransactions() 代码的精简版本：

```
 // Retrieve the user's latest transactions from the website.
    public boolean RetrieveTransactions() {
        String result;
        FailureReason = "";
        iTransactions = 0;

        // Retrieve the Page.
        result = GetPage(Url);

        // Strip the transactions from the page and convert them to a JSONArray.
        try {
            String sTransactions = textExtract(result, "var dataTable1Data=", ";\n", 0);
            jTransactions = new JSONArray(sTransactions);
            iTransactions = jTransactions.length();
            return true;
        } catch (JSONException e1) {
            // Generally if it fails during this, there was no JSONArray to parse (hence no transactions).
            FailureReason = "No Transactions Found";
            return false;
        }
    } 
```

最后是在列表视图中显示事务的精简代码，在活动启动时调用，此后每 5 秒左右调用一次：

```
public void ShowTransactions() {
    try {
        if (!bRefreshingTransactions) {
            if (iTransactions==0) {
                return;
            } 
            if (iTransactions==0) return;
            List<String> listContents = new ArrayList<String>(iTransactions);
            for (int i = 0; i < iTransactions; i++) {
                listContents.add(jTransactions.getString(iTransactions - i - 1));
            }
            lvRecentTransactions.setAdapter(new ArrayAdapterTransactions(MyContext, listContents));
        }
    } catch (Exception e) {
        // Do error stuff here
    }
} 
```

先感谢您。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:46:59.140

这似乎是互斥问题。使`jTransaction`同步或将`jTransaction`变量放入`synchonized`块中。

```
 synchronized(jTransactions ){
        String sTransactions = textExtract(result, "var dataTable1Data=", ";\n", 0);
        jTransactions = new JSONArray(sTransactions);
        iTransactions = jTransactions.length();
   } 
```

我没有测试代码，但希望同步对您有所帮助。

# drupal - 根据分类术语生成 url 别名

> ID：11399287
> 
> 赞同：3
> 
> 时间：2012-07-09T16:29:56.393
> 
> 标签：drupal, drupal-7, drupal-modules, drupal-taxonomy

我有一个词汇类别和四个术语。我想要做的是，如果内容被标记为特别是“term1”以使 url 生成为 word1/[node:title]，而对于所有其他标签，则只是标准的 url 格式。

如果我想要 url 中的术语显然 id 使用模式替换，但如果使用特定标签，我希望使用另一个词

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T18:18:16.133

我想不出一种简单的即插即用方式来实现这一目标。您可能必须在 Pathauto 的 URL 别名设置中为“默认路径模式”创建自己的令牌：

```
/**
 * Implementation of hook_token_info().
 */
function MODULE_token_info() {
  $info['tokens']['node']['node-term-path'] = array(
    'name'        => t('Node path by term'),
    'description' => t('The path to a node based on its taxonomy terms.'),
  );
  return $info;
}

/**
 * Implementation of hook_tokens().
 */
function MODULE_tokens($type, $tokens, array $data = array(), array $options = array()) {
  $replacements = array();
  if ($type == 'node' && !empty($data['node'])) {
    $node = $data['node'];

    foreach ($tokens as $name => $original) {
      switch ($name) {
        case 'node-term-path':
          $items = field_get_items('node', $node, 'TAXONOMY_FIELD_NAME');
          foreach ($items as $item) {
            $tids[] = $item['tid'];
          }
          if (in_array(TID_OF_TERM1, $tids)) {
            // Path for nodes with term1
            $replacements[$original] = 'word1/'. pathauto_cleanstring($node->title);
          }
          else {
            // Path for other nodes
            $replacements[$original] = 'content/'. pathauto_cleanstring($node->title);
          }
          break;
      }
    }
  }
  return $replacements;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T14:34:24.553

找到了一种简单的方法，任何需要类似解决方案的人都可以使用模块实体参考。

[http://drupal.org/project/entityreference](http://drupal.org/project/entityreference)

我刚刚为用户帐户选择实体引用创建了一个新字段，然后您可以选择 drupal 中的任何实体进行引用。（即你可以选择一个术语/内容/任何东西）

# php - ajax中的php ajax

> ID：11399289
> 
> 赞同：3
> 
> 时间：2012-07-09T16:30:02.317
> 
> 标签：php, javascript, ajax

我有一些将 php 脚本输出加载到 div 中的 ajax。我希望用户能够单击输出中的链接并重写 div 而无需重新加载整个页面。这原则上可行吗？想象一下代码看起来像：

html

```
<div id="displayhere"></div> 
```

php1 输出

```
echo '<a href="javascript:void(0);" onclick="reLoad(par1,par2,par3);">ChangeToNew</a>'; 
```

JS

```
function reLoad(par1,par2,par3) {
...
 document.getElementById("displayhere").innerHTML=xmlhttp.responseText;
xmlhttp.open("GET","php2.php?par1="+par1 etc.,true);
xmlhttp.send(); 
```

php2

```
$par1 = $_get['par1'];
change database
echo '<a href="javascript:void(0);" onclick="reLoad(par1,par2,par3);">'.$par1.'</a>'; 
```

这在原则上可行还是方法有缺陷？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-09T16:43:20.347

您所描述的是标准的日常 AJAX。PHP 与等式无关；JS 将简单地接收服务器发送的任何内容。碰巧的是，在您的情况下，服务器响应正在由 PHP 处理。然而，JS 和 PHP 没有 - 不能 - 有直接关系。

所以原理没问题。但是，您实际上用它做什么当然会影响它的工作情况。

需要考虑的事项：

*   PHP 会做什么？这可能会影响加载时间
*   缓存响应怎么样，如果这适用的话，那么 PHP 就不必计算它之前生成的东西了？
*   UI - 是否会让用户知道正在获取内容？

等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:04:21.917

I'm used to using jQuery so will give examples using it.

If you create your links as

```
<a href="file_to_run.php?par1=1&par2=2&par3=3" id="do_this">Click Me</a> 
```

You could then write your code as

```
<script>
  $("#do_this").live('click', function(){
    var link_url = $(this).attr('href');
    $.ajax({
      url: link_url,
      success: function(data) {
        $('#displayhere').html(data);
      }
   return false;
 };
</script> 
```

If you use jQuery, make sure you use the .live('click', function(){}) method versus the .click(function(){}) method, otherwise it won't recognize dynamically created elements. Also make sure you do a return false.

# google-app-engine - Google App Engine 中未订阅用户的 IM 状态

> ID：11399291
> 
> 赞同：0
> 
> 时间：2012-07-09T16:30:02.820
> 
> 标签：google-app-engine, xmpp, google-talk

我正在实现一个 GAE 应用程序，我需要使用属于某个域的用户 gmail 地址显示任何用户的聊天状态。

用户不知道该应用程序并且该应用程序没有被添加到用户的联系人/IM 列表中。

是否可以？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T17:07:53.507

不，那是不可能的。XMPP 仅公开已接受订阅请求的联系人的状态消息。

# django - 更多 Django 项目正在覆盖 memcached

> ID：11399293
> 
> 赞同：1
> 
> 时间：2012-07-09T16:30:10.423
> 
> 标签：django, memcached

在我的服务器上，我在 Django 中有一个项目，结合了 Nginx + Gunicorn。我在这个项目中使用了 memcached，它对我来说很好用。

现在我想添加下一个项目。一切都很好，因为我在我的新项目中添加了缓存。然后这两个项目正在覆盖另一个项目的缓存。当我转到一个项目的页面时，我看到了第二个。

在我的 settings.py 中，我有：

```
MIDDLEWARE_CLASSES = (
    'django.middleware.cache.UpdateCacheMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.cache.FetchFromCacheMiddleware',
    ... 
```

和

```
CACHES = {
    'default': {
        'BACKEND': 'django.core.cache.backend.memcached.MemcachedCache',
        'LOCATION': '127.0.0.1:11211',
    }
} 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T16:35:00.773

更改`CACHE_MIDDLEWARE_KEY_PREFIX`设置中的值。对于每个项目，它应该是唯一的。

# c++ - 调试断言失败 - 向量迭代器不可取消引用

> ID：11399294
> 
> 赞同：0
> 
> 时间：2012-07-09T16:30:15.857
> 
> 标签：c++, vector

运行此代码时出现此运行时错误：

```
void AlienShipManager::Update(float timeDelta, 
        BulletManager* bulletManager,
        ParticleManager* particleManager,
        GameStringSystem* stringBatch)
{
    unsigned int i = 0;
    while (i < m_alienShipList.size())
    {
        AlienResult result = m_alienShipList[i].Update(timeDelta, bulletManager);
        switch (result)
        {
            case AlienResult::Dead:
                break;
            default:
                break;
        }
            ++i 
    }
} 
```

排队

```
AlienResult result = m_alienShipList[i].Update(timeDelta, bulletManager); 
```

我如何将 AlienShip 添加到矢量类：

```
m_alienShipList.push_back(AlienShip(position, speed, m_screeSize, m_alienShipTexture)); 
```

如果我有机会，也会出现错误：

```
AlienShip* newAlien = new AlienShip(position, speed, m_screeSize, m_alienShipTexture);
    m_alienShipList.push_back(*newAlien);
    delete newAlien; 
```

但如果我将其更改为：

```
AlienShip* newAlien = new AlienShip(position, speed, m_screeSize, m_alienShipTexture);
    m_alienShipList.push_back(*newAlien); 
```

因此导致巨大的内存泄漏。

这是我的 AlienShip 类的外观：

```
#pragma once

#include "Body.h"
#include "BulletManager.h"
#include "ParticleManager.h"

enum AliensShipState
{
    flying,
    dying,
    dead,
    escaped
};

enum AlienResult
{
    No,
    Hit,
    Dying,
    Dead,
    Escaped
};

class AlienShip : public Body
{
public:
    AlienShip(void);
    AlienShip(float2& position, float2& speed, float2* screenSize, ID3D11Texture2D* alienTexture);
    ~AlienShip(void);

    AlienResult Update(float timeDelta, BulletManager* bulletManager);
    void Draw(BasicSprites::SpriteBatch^ spriteBatch);

protected:
    float m_baseY;
    AliensShipState m_state;
    float2* m_screenSize;
}; 
```

AlienShip 类继承自 Body 类，其中包含 Sprite 类，其中包含另一个向量。但是由于 Sprite 类在其他地方工作得很好，我不认为它是错误的来源。

我想知道为什么会发生这种情况，因为我找不到删除临时对象和损坏向量迭代器之间的关系，如果它完全损坏的话。

程序也可以在 Release 中编译和运行，但有一些数据损坏。

我正在使用适用于 Windows 8 的 Visual Studio 2012 Beta。

如果您需要更多源代码，请写。不幸的是，很难发布所有代码，因为这是一个复杂的程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T16:37:52.410

鉴于当您按值将项目添加到向量时它不起作用，但当您泄漏指针时它会起作用，我有 95% 的信心相信您的复制构造函数`AlienShip`会执行浅拷贝，从而导致您的问题。

编辑：请注意，这`m_alienShipList.push_back(AlienShip(position, speed, m_screeSize, m_alienShipTexture));`会导致您的类的副本，如果复制构造函数不能正常工作，它将在以后导致问题。

事实上，如果`AlienShip`您粘贴的定义是正确的，那么实际上只有默认的复制构造函数可能会做错事（您有自己的析构函数这一事实进一步强化了这一事实）。

要么实现一个执行深度复制的复制构造函数，要么更优选地重写您的类以使用 RAII 为您管理内存，以便默认副本是正确的。

# flash - PNG 偶尔会在从 Flash 到服务器的过程中丢失数据

> ID：11399295
> 
> 赞同：0
> 
> 时间：2012-07-09T16:30:27.017
> 
> 标签：flash, png

我们对此感到困惑，希望能得到一些帮助！

我们的用户正在 Flash 中创建 TIF，并通过 HTTP POST 将 Base64 中的图像数据发布到 ASPX 服务器，该服务器通过以下方式接收它：

```
byte[] bytes = Convert.FromBase64String(Request.Form["ImgData"]  ); 
```

我们发现该方法有效，但在 20-30 种左右的情况下，服务器接收到的数据量与客户端声称发送的数据量不同。ASP 代码：

```
dataLengthSentFromClient = Request.Form["dataLengthFromClient"].ToString();
<>
ReceivedBytesLength=Request.Form["ImgData"].Length.ToString(); 
```

但其他 24 次它似乎工作正常。有任何想法吗？我们不应该以这种方式将数据从 Flash 传递到服务器吗？

* * *

（这里是客户端 AS 代码） var image:BitmapData;

```
if (toTrim) {
tempBitmapData=new BitmapData(workingSrc.width,workingSrc.height,true,0x00000000);
tempBitmapData.draw(workingSrc);
var tempBitmap:Bitmap=new Bitmap(tempBitmapData,PixelSnapping.ALWAYS,true);
bounds=tempBitmapData.getColorBoundsRect(0xFF000000,0x00000000,false);
var letterMatrix:Matrix=new Matrix(1,0,0,1,- bounds.x,- bounds.y);
tempBitmap.transform.matrix=letterMatrix;
image=new BitmapData(bounds.width,bounds.height,true,0x00000000);
image.draw(tempBitmap,letterMatrix);
} else {
image=new BitmapData(workingSrc.width,workingSrc.height,true,0x00000000);
image.draw(workingSrc,letterMatrix);
}

var bytes:ByteArray=PNGEncoder.encode(image);
var base64Bytes:String=Base64.encodeByteArray(bytes);

var vars:URLVariables = new URLVariables();
vars.activityID=activityID;
vars.imgData=base64Bytes;
vars.dataLengthFromSarah=vars.imgData.length;
vars.activityLocation=activityLoc;
vars.op="writePNG";
if (fileName!=null) {
vars.filename=fileName;
}
// Save info about the variables passed in case we need to dump error data
dispatchEvent(new DumpPrepEvent(vars.toString()));

var url:URLRequest=new URLRequest(INTERFACE);
url.data=vars;
url.method=URLRequestMethod.POST; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T11:16:01.347

我能想象的唯一原因（假设您使用的每个库都工作正常）是 base64 符号是 urlencoded 但不是 urldecoded。Base64 有“+”，它将在传输后进行 urlencoded，我不确定这个 ASPX 库是否自己进行 urldecode。在这种情况下，即使是几个字节的随机数据，出错的概率也高于 1/25。但可能是您使用的是小尺寸的非随机测试数据。

# iphone - UIImage initWithData如何等到完成

> ID：11399300
> 
> 赞同：1
> 
> 时间：2012-07-09T16:30:42.773
> 
> 标签：iphone, ios, uikit, core-graphics, quartz-2d

当我以这种方式加载 BMP 图像时：

```
NSData * pImageData = [[NSData alloc] initWithBytesNoCopy:pBuffer length:dwSize freeWhenDone:NO];
UIImage * pLoaded = [[UIImage alloc] initWithData:pImageData];
[pImageData release]; 
```

并尝试使用 Quartz2D 显示该图像：

```
CGImageRef cgImage = [pLoaded CGImage];
CGContextSaveGState(context);
CGContextTranslateCTM(context, x, y*2 + h);
CGContextScaleCTM(context, 1.0, -1.0);
CGContextDrawImage(context, CGRectMake(x, y, w, h), cgImage);
CGContextRestoreGState(context); 
```

图像显示为黑色矩形，或者有时显示但不完全。当我在 initWithData 后睡眠 1 秒时，图像正确显示。

是否有 UIKit/Quartz2D API 方法来等待图像初始化完成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T17:41:43.283

您可以使用`@synchronization`或`dispatch`排队等待图像下载完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T08:55:33.450

当我使用时一切正常：

```
NSData * pImageData = [[NSData alloc] initWithBytes:pBuffer length:dwSize]; 
```

代替：

```
NSData * pImageData = [[NSData alloc] initWithBytesNoCopy:pBuffer length:dwSize freeWhenDone:NO]; 
```

感谢 phix23。

# ruby-on-rails - Rails：未知属性

> ID：11399303
> 
> 赞同：1
> 
> 时间：2012-07-09T16:30:56.730
> 
> 标签：ruby-on-rails

当我有 rails 3.0.8 时，这曾经有效。在听说 ActiveRecord 的一些安全问题后，我决定更新所有内容，但结果被破坏了。如果您需要更多信息，请告诉我。

错误：

```
unknown attribute: gene_family_id 
```

app/views/gene_families/show.html.erb

```
<%= form_for( [@gene_family, @gene_family.cvits.build], :html => {:onsubmit => "return ray.ajax()" }) do |f| %>
...
<% end %> 
```

配置/路由.yml

```
LisCvit::Application.routes.draw do
  resources :cvits, :path => 'cvit' do
          get 'new' , :on => :collection
  end
  resources :gene_families do
    resources :cvits
    collection do
      post 'blast'
      get 'search'
    end     
  end
  root :to => "cvits#error"
end 
```

完整跟踪：

```
ruby/1.8/gems/activerecord-3.2.6/lib/active_record/attribute_assignment.rb:88:in `assign_attributes'
ruby/1.8/gems/activerecord-3.2.6/lib/active_record/attribute_assignment.rb:78:in `each'
ruby/1.8/gems/activerecord-3.2.6/lib/active_record/attribute_assignment.rb:78:in `assign_attributes'
ruby/1.8/gems/activerecord-3.2.6/lib/active_record/associations/association.rb:235:in `build_record'
ruby/1.8/gems/activerecord-3.2.6/lib/active_record/base.rb:500:in `initialize'
app/models/cvit.rb:6:in `initialize'
ruby/1.8/gems/activerecord-3.2.6/lib/active_record/reflection.rb:183:in `new'
ruby/1.8/gems/activerecord-3.2.6/lib/active_record/reflection.rb:183:in `build_association'
ruby/1.8/gems/activerecord-3.2.6/lib/active_record/associations/association.rb:233:in `build_record'
ruby/1.8/gems/activerecord-3.2.6/lib/active_record/associations/collection_association.rb:112:in `build'
ruby/1.8/gems/activerecord-3.2.6/lib/active_record/associations/collection_proxy.rb:46:in `__send__'
ruby/1.8/gems/activerecord-3.2.6/lib/active_record/associations/collection_proxy.rb:46:in `build'
app/views/gene_families/show.html.erb:102:in `_app_views_gene_families_show_html_erb___277042720_17231010160'
app/views/gene_families/show.html.erb:92:in `each'
app/views/gene_families/show.html.erb:92:in `_app_views_gene_families_show_html_erb___277042720_17231010160'
ruby/1.8/gems/actionpack-3.2.6/lib/action_view/template.rb:145:in `send'
ruby/1.8/gems/actionpack-3.2.6/lib/action_view/template.rb:145:in `render'
ruby/1.8/gems/activesupport-3.2.6/lib/active_support/notifications.rb:125:in `instrument'
ruby/1.8/gems/actionpack-3.2.6/lib/action_view/template.rb:143:in `render'
ruby/1.8/gems/actionpack-3.2.6/lib/action_view/renderer/template_renderer.rb:47:in `render_template'
ruby/1.8/gems/actionpack-3.2.6/lib/action_view/renderer/abstract_renderer.rb:38:in `instrument'
ruby/1.8/gems/activesupport-3.2.6/lib/active_support/notifications.rb:123:in `instrument'
ruby/1.8/gems/activesupport-3.2.6/lib/active_support/notifications/instrumenter.rb:20:in `instrument'
ruby/1.8/gems/activesupport-3.2.6/lib/active_support/notifications.rb:123:in `instrument'
ruby/1.8/gems/actionpack-3.2.6/lib/action_view/renderer/abstract_renderer.rb:38:in `instrument'
ruby/1.8/gems/actionpack-3.2.6/lib/action_view/renderer/template_renderer.rb:46:in `render_template'
ruby/1.8/gems/actionpack-3.2.6/lib/action_view/renderer/template_renderer.rb:54:in `render_with_layout'
ruby/1.8/gems/actionpack-3.2.6/lib/action_view/renderer/template_renderer.rb:45:in `render_template'
ruby/1.8/gems/actionpack-3.2.6/lib/action_view/renderer/template_renderer.rb:18:in `render'
ruby/1.8/gems/actionpack-3.2.6/lib/action_view/renderer/renderer.rb:36:in `render_template'
ruby/1.8/gems/actionpack-3.2.6/lib/action_view/renderer/renderer.rb:17:in `render'
ruby/1.8/gems/actionpack-3.2.6/lib/abstract_controller/rendering.rb:110:in `_render_template'
ruby/1.8/gems/actionpack-3.2.6/lib/action_controller/metal/streaming.rb:225:in `_render_template'
ruby/1.8/gems/actionpack-3.2.6/lib/abstract_controller/rendering.rb:103:in `render_to_body'
ruby/1.8/gems/actionpack-3.2.6/lib/action_controller/metal/renderers.rb:28:in `render_to_body'
ruby/1.8/gems/actionpack-3.2.6/lib/action_controller/metal/compatibility.rb:50:in `render_to_body'
ruby/1.8/gems/actionpack-3.2.6/lib/abstract_controller/rendering.rb:88:in `render'
ruby/1.8/gems/actionpack-3.2.6/lib/action_controller/metal/rendering.rb:16:in `render'
ruby/1.8/gems/actionpack-3.2.6/lib/action_controller/metal/instrumentation.rb:40:in `render'
ruby/1.8/gems/activesupport-3.2.6/lib/active_support/core_ext/benchmark.rb:5:in `ms'
/usr/local/lib/ruby/1.8/benchmark.rb:308:in `realtime'
ruby/1.8/gems/activesupport-3.2.6/lib/active_support/core_ext/benchmark.rb:5:in `ms'
ruby/1.8/gems/actionpack-3.2.6/lib/action_controller/metal/instrumentation.rb:40:in `render'
ruby/1.8/gems/actionpack-3.2.6/lib/action_controller/metal/instrumentation.rb:83:in `cleanup_view_runtime'
ruby/1.8/gems/activerecord-3.2.6/lib/active_record/railties/controller_runtime.rb:24:in `cleanup_view_runtime'
ruby/1.8/gems/thinking-sphinx-2.0.12/lib/thinking_sphinx/action_controller.rb:12:in `cleanup_view_runtime'
ruby/1.8/gems/actionpack-3.2.6/lib/action_controller/metal/instrumentation.rb:39:in `render'
ruby/1.8/gems/actionpack-3.2.6/lib/action_controller/metal/implicit_render.rb:10:in `default_render'
ruby/1.8/gems/actionpack-3.2.6/lib/action_controller/metal/mime_responds.rb:196:in `respond_to'
app/controllers/gene_families_controller.rb:178:in `show'
ruby/1.8/gems/actionpack-3.2.6/lib/action_controller/metal/implicit_render.rb:4:in `send_action'
ruby/1.8/gems/actionpack-3.2.6/lib/action_controller/metal/implicit_render.rb:4:in `send_action'
ruby/1.8/gems/actionpack-3.2.6/lib/abstract_controller/base.rb:167:in `process_action'
ruby/1.8/gems/actionpack-3.2.6/lib/action_controller/metal/rendering.rb:10:in `process_action'
ruby/1.8/gems/actionpack-3.2.6/lib/abstract_controller/callbacks.rb:18:in `process_action'
ruby/1.8/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:414:in `_run__1468902388__process_action__453433196__callbacks'
ruby/1.8/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:405:in `send'
ruby/1.8/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:405:in `__run_callback'
ruby/1.8/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
ruby/1.8/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:81:in `send'
ruby/1.8/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:81:in `run_callbacks'
ruby/1.8/gems/actionpack-3.2.6/lib/abstract_controller/callbacks.rb:17:in `process_action'
ruby/1.8/gems/actionpack-3.2.6/lib/action_controller/metal/rescue.rb:29:in `process_action'
ruby/1.8/gems/actionpack-3.2.6/lib/action_controller/metal/instrumentation.rb:30:in `process_action'
ruby/1.8/gems/activesupport-3.2.6/lib/active_support/notifications.rb:123:in `instrument'
ruby/1.8/gems/activesupport-3.2.6/lib/active_support/notifications/instrumenter.rb:20:in `instrument'
ruby/1.8/gems/activesupport-3.2.6/lib/active_support/notifications.rb:123:in `instrument'
ruby/1.8/gems/actionpack-3.2.6/lib/action_controller/metal/instrumentation.rb:29:in `process_action'
ruby/1.8/gems/actionpack-3.2.6/lib/action_controller/metal/params_wrapper.rb:206:in `process_action'
ruby/1.8/gems/activerecord-3.2.6/lib/active_record/railties/controller_runtime.rb:18:in `process_action'
ruby/1.8/gems/actionpack-3.2.6/lib/abstract_controller/base.rb:121:in `process'
ruby/1.8/gems/actionpack-3.2.6/lib/abstract_controller/rendering.rb:45:in `process'
ruby/1.8/gems/actionpack-3.2.6/lib/action_controller/metal.rb:203:in `dispatch'
ruby/1.8/gems/actionpack-3.2.6/lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
ruby/1.8/gems/actionpack-3.2.6/lib/action_controller/metal.rb:246:in `action'
ruby/1.8/gems/actionpack-3.2.6/lib/action_dispatch/routing/route_set.rb:73:in `call'
ruby/1.8/gems/actionpack-3.2.6/lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
ruby/1.8/gems/actionpack-3.2.6/lib/action_dispatch/routing/route_set.rb:36:in `call'
ruby/1.8/gems/journey-1.0.4/lib/journey/router.rb:68:in `call'
ruby/1.8/gems/journey-1.0.4/lib/journey/router.rb:56:in `each'
ruby/1.8/gems/journey-1.0.4/lib/journey/router.rb:56:in `call'
ruby/1.8/gems/actionpack-3.2.6/lib/action_dispatch/routing/route_set.rb:600:in `call'
ruby/1.8/gems/actionpack-3.2.6/lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
ruby/1.8/gems/rack-1.4.1/lib/rack/etag.rb:23:in `call'
ruby/1.8/gems/rack-1.4.1/lib/rack/conditionalget.rb:25:in `call'
ruby/1.8/gems/actionpack-3.2.6/lib/action_dispatch/middleware/head.rb:14:in `call'
ruby/1.8/gems/actionpack-3.2.6/lib/action_dispatch/middleware/params_parser.rb:21:in `call'
ruby/1.8/gems/actionpack-3.2.6/lib/action_dispatch/middleware/flash.rb:242:in `call'
ruby/1.8/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:205:in `context'
ruby/1.8/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:200:in `call'
ruby/1.8/gems/actionpack-3.2.6/lib/action_dispatch/middleware/cookies.rb:338:in `call'
ruby/1.8/gems/activerecord-3.2.6/lib/active_record/query_cache.rb:64:in `call'
ruby/1.8/gems/activerecord-3.2.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:473:in `call'
ruby/1.8/gems/actionpack-3.2.6/lib/action_dispatch/middleware/callbacks.rb:28:in `call'
ruby/1.8/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:405:in `_run__397314981__call__4__callbacks'
ruby/1.8/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:405:in `send'
ruby/1.8/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:405:in `__run_callback'
ruby/1.8/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
ruby/1.8/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:81:in `send'
ruby/1.8/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:81:in `run_callbacks'
ruby/1.8/gems/actionpack-3.2.6/lib/action_dispatch/middleware/callbacks.rb:27:in `call'
ruby/1.8/gems/actionpack-3.2.6/lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
ruby/1.8/gems/actionpack-3.2.6/lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
ruby/1.8/gems/actionpack-3.2.6/lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
ruby/1.8/gems/railties-3.2.6/lib/rails/rack/logger.rb:26:in `call_app'
ruby/1.8/gems/railties-3.2.6/lib/rails/rack/logger.rb:16:in `call'
ruby/1.8/gems/actionpack-3.2.6/lib/action_dispatch/middleware/request_id.rb:22:in `call'
ruby/1.8/gems/rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'
ruby/1.8/gems/rack-1.4.1/lib/rack/runtime.rb:17:in `call'
ruby/1.8/gems/activesupport-3.2.6/lib/active_support/cache/strategy/local_cache.rb:72:in `call'
ruby/1.8/gems/rack-1.4.1/lib/rack/lock.rb:15:in `call'
ruby/1.8/gems/actionpack-3.2.6/lib/action_dispatch/middleware/static.rb:62:in `call'
ruby/1.8/gems/railties-3.2.6/lib/rails/engine.rb:479:in `call'
ruby/1.8/gems/railties-3.2.6/lib/rails/application.rb:220:in `call'
ruby/1.8/gems/rack-1.4.1/lib/rack/content_length.rb:14:in `call'
ruby/1.8/gems/railties-3.2.6/lib/rails/rack/log_tailer.rb:17:in `call'
ruby/1.8/gems/rack-1.4.1/lib/rack/handler/webrick.rb:59:in `service'
/usr/local/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
/usr/local/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
/usr/local/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
/usr/local/lib/ruby/1.8/webrick/server.rb:162:in `start'
/usr/local/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
/usr/local/lib/ruby/1.8/webrick/server.rb:95:in `start'
/usr/local/lib/ruby/1.8/webrick/server.rb:92:in `each'
/usr/local/lib/ruby/1.8/webrick/server.rb:92:in `start'
/usr/local/lib/ruby/1.8/webrick/server.rb:23:in `start'
/usr/local/lib/ruby/1.8/webrick/server.rb:82:in `start'
ruby/1.8/gems/rack-1.4.1/lib/rack/handler/webrick.rb:13:in `run'
ruby/1.8/gems/rack-1.4.1/lib/rack/server.rb:265:in `start'
ruby/1.8/gems/railties-3.2.6/lib/rails/commands/server.rb:70:in `start'
ruby/1.8/gems/railties-3.2.6/lib/rails/commands.rb:55
ruby/1.8/gems/railties-3.2.6/lib/rails/commands.rb:50:in `tap'
ruby/1.8/gems/railties-3.2.6/lib/rails/commands.rb:50
script/rails:6:in `require'
script/rails:6 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:56:28.970

如果您更新到 3.2.3 或更高版本，这*可能*是由强制将属性列入白名单以进行批量分配的新默认方法引起的。[请参阅发行说明](http://weblog.rubyonrails.org/2012/3/30/ann-rails-3-2-3-has-been-released/)的开头。尽管没有看到引发错误的实际代码，但很难判断这是否是您的错误的原因。

# javascript - javascript：使用哈希字符拆分 HREF 字符串

> ID：11399306
> 
> 赞同：1
> 
> 时间：2012-07-09T16:31:00.183
> 
> 标签：javascript, jquery, split

我有以下代码返回函数中每个链接的 url：

```
var nav_link;
$('#nav_what-we-do').find('.top-dropdown').find('a').each(function(index, elem) {
    console.log("Descendant: " + elem.tagName + " " + elem.href);
    the_link = $(this);
    nav_link = elem.href.split('#');
    if (nav_link[0] === '/what-we-do/') {
        the_link.attr('href','#'+nav_link[1]);
        the_link.click(function() {
            var tab_id = $(this).attr('href');
            selectTab(tab_id);
            return false;
        });
    }
}); 
```

控制台打印如下链接：

```
Descendant: A http://localhost/testsite/what-we-do/#solutions
Descendant: A http://localhost/testsite/what-we-do/#features
Descendant: A http://localhost/testsite/what-we-do/features/test
Descendant: A http://localhost/testsite/what-we-do/solutions/test2 
```

现在我只想要那些包含哈希 (#) 的链接并使用此哈希拆分它们。然后我想检查 array(0) 是否包含字符“/what-we-do/”。我试图像这样拆分链接：

```
nav_link = elem.href.split('#'); 
```

但**IF**部分不起作用。

有人可以告诉我我做错了什么。

**编辑**

根据TJ的建议

```
$('#nav_what-we-do').find('.top-dropdown').find('a').each(function(index, elem) {
    //console.log("Descendant: " + elem.tagName + " " + elem.href);
    var the_link = elem.href,
        hashIndex = the_link.split("#");
    if(hashIndex.length == 2) {
        console.log(hashIndex);
        console.log("Descendant: " + elem.tagName + " " + elem.href);
        console.log('First part is: ' + hashIndex[0].indexOf("/what_we_do/"));
    }
    if (hashIndex.length == 2 && hashIndex[0].indexOf("/what_we_do/") !== -1) {
        the_link.attr('href', "#" + hashIndex[1]);
        the_link.attr('href', the_link.substring(hashIndex));
        the_link.click(function() {
            var tab_id = $(this).attr('href');
            selectTab(tab_id);
            return false;
        });
    }
}); 
```

如果我在控制台中打印，我会得到：

```
["http://localhost/testsite/what-we-do/", "solutions"] site_javascript.js:133
Descendant: A http://localhost/testsite/what-we-do/#solutions site_javascript.js:134
First part is: -1 site_javascript.js:135

["http://localhost/testsite/what-we-do/", "features"] site_javascript.js:133
Descendant: A http://localhost/testsite/what-we-do/#features site_javascript.js:134
First part is: -1 
```

第一部分应该是值**hashIndex[0].indexOf("/what_we_do/")**

由于**hashIndex**有字符串**/what-we-do/ 会发生**什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T16:36:17.307

我想你可能想要：

```
var nav_link;
$('#nav_what-we-do').find('.top-dropdown').find('a').each(function(index, elem) {
    console.log("Descendant: " + elem.tagName + " " + elem.href);
    var the_link = elem.href,
        hashIndex = the_link.indexOf("#");
    if (hashIndex !== -1 && the_link.indexOf("/what-we-do/") !== -1) {
        the_link.attr('href', the_link.substring(hashIndex));
        the_link.click(function() {
            var tab_id = $(this).attr('href');
            selectTab(tab_id);
            return false;
        });
    }
}); 
```

（请注意，我声明了`the_link`; 如果它已经在迭代器函数之外的某个地方声明，您可以删除它，但它似乎应该是本地的。）

或者*（从**技术上讲**`/what-we-do/`，如果在哈希**之后**，上述内容将匹配*） ：

```
var nav_link;
$('#nav_what-we-do').find('.top-dropdown').find('a').each(function(index, elem) {
    console.log("Descendant: " + elem.tagName + " " + elem.href);
    var the_link = elem.href,
        split = the_link.split("#");
    if (split.length === 2 && split[0].indexOf("/what-we-do/") !== -1) {
        the_link.attr('href', "#" + split[1]);
        the_link.click(function() {
            var tab_id = $(this).attr('href');
            selectTab(tab_id);
            return false;
        });
    }
}); 
```

在那里，我对其进行了限制，因此如果在第一个散列之后有散列，则它不匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:38:03.093

这是失败的，因为您正在检查整个绝对路径 (http://.....) 与它的标记 (/what-we-do/)。

有几种方法可以解决这个问题 - 最简单的方法可能是检查您要查找的令牌是否在 URL 中（而不是像目前那样完全等于它）。

```
if (nav_link.indexOf('#') != -1 && nav_link[0].indexOf('/what-we-do/') != -1) {
    ... 
```

# firefox - Firefox 和 HTML5 视频元素 - 带有 Flash 后备的奇怪行为。mediaelemnts.js 中可能存在的错误

> ID：11399308
> 
> 赞同：0
> 
> 时间：2012-07-09T16:31:03.827
> 
> 标签：firefox, html5-video, mediaelement.js, fallback

我正在将视频嵌入网页并使用 mediaelements.js。我使用了[mediaelements.js](http://mediaelementjs.com/)示例中的以下代码：

```
<video width="640" height="360" id="player2" poster="img/echo-hereweare.jpg" controls="controls" preload="none">
    <source type="video/mp4" src="somevideo.mp4" />
    <source type="video/webm" src="somevideo.webm" />
    <source type="video/ogg" src="somevideo.ogv" />
    <object width="640" height="360" type="application/x-shockwave-flash" data="flash/flashmediaelement.swf">       
        <param name="movie" value="flash/flashmediaelement.swf" /> 
        <param name="flashvars" value="controls=true&amp;file=somevideo.mp4" />
        <img src="img/echo-hereweare.jpg" width="640" height="360" alt="Here we are" 
        title="No video playback capabilities" />
    </object>
</video> 
```

然后是示例中的脚本代码：

```
<script>
    $('audio,video').mediaelementplayer({
        success: function(player, node) {
            $('#' + node.id + '-mode').html('mode: ' + player.pluginType);
        }
    });
</script> 
```

然后我在 Firefox 中发现了一些奇怪的东西。**当我在没有启动mediaelements.js**（不使用上面的脚本）的情况下使用此代码时，firefox会尝试播放.mp4，但控制台自然会报告不支持.mp4格式的错误。到目前为止一切顺利。

据我了解，视频元素现在应该尝试下一种格式——.webm。而是加载了 flash 后备 (flashmediaelement.swf)（到目前为止没有播放任何内容，因为尚未单击播放按钮，但 .swf 仍然完全加载）。

然后，当我播放视频时，.webm 会按预期下载并播放。

**当我将它与 mediaelements.js 一起使用时，**发生了更奇怪的事情——.swf 不仅被完全加载一次，而且至少被请求一次，而不被下载（你在 firebug 的网络选项卡中看到它——黄线一个忙碌的微调器，好像它会加载和加载。但是没有错误或任何状态代码，也没有显示文件大小。这似乎有点像“卡住”请求。我想发布它的屏幕截图，但我暂时不允许。）。

另外，我在 Firebug 的控制台中收到了 .webm 无法解码的警报。.webm-video 开始加载，但不会完全加载（状态代码 206）。然后根本没有视频播放，因为 .webm 尝试播放但由于解码错误而停止。那么flash fallback不应该跳进去吗？

我现在的问题是：

1.  这是 Firefox 中媒体元素的正常行为吗？即使不需要，也会加载备用 flashplayer？
2.  为什么它在第二种情况下加载了两三次，尽管它也没有使用？我猜这是 mediaelemnts.js 中的一个错误
3.  第三，为什么firefox在没有mediaelements.js的情况下播放.webm而没有mediaelements.js？我猜另一个错误？

感谢您的帮助。

**---注意---** *我知道我正在使用 mediaelements.js 附带的 .swf 作为后备解决方案，即使我没有使用 mediaelements.js。有谁知道一个简单的轻量级 Flash 视频播放器？还是我必须坚持使用 flowplayer 作为标准的 Flash 视频播放器？*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T05:12:53.527

我不能拥有所有视频文件的多个版本（有很多并且整个网站都已下载）所以我写了这个，它似乎适用于当前的 Safari、FireFox 和 Chrome - 应该适用于其他所有文件或添加到非 MP4列表

```
<script type="text/javascript">
    /*U might need to add other non-MP4 native browsers*/
    if (navigator.userAgent.indexOf('Firefox'||'Chrome') != -1) {
        document.write("<object type='application/x-shockwave-flash' data='player.swf' width='480' height='270'>
        <param name='movie' value='player.swf' />
        <param name='allowFullScreen' value='true'/>
        <param name='wmode' value='transparent' />
        <param name='flashVars' value='controlbar=over&amp;file=video/sequence03.mp4' />
        <span title='No video playback capabilities, please download the video below'>
        <a href='video/sequence03.mp4'>Sequence 03</a></span></object>")
    }
    else {
        document.write("<video width='480' height='270' controls><source src='video/sequence03.mp4' type='video/mp4' /></video>")
    }
</script> 
```

# wpf - 如何向控件模板/样式添加新属性

> ID：11399312
> 
> 赞同：4
> 
> 时间：2012-07-09T16:31:17.667
> 
> 标签：wpf, styles, controltemplate

我刚刚在标题中创建了一个带有复选框的 Expander 样式：

```
<Style TargetType="{x:Type Expander}" x:Key="MyCheckboxExpander">
    <Setter Property="Background" Value="{StaticResource ExpanderBackgroundBrush}"/>
    <Setter Property="HeaderTemplate" Value="{StaticResource MyHeaderExpander}" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type Expander}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*" x:Name="ContentRow"/>
                    </Grid.RowDefinitions>
                    <Border Grid.Row="0" x:Name="Border" Background="{TemplateBinding Background}" BorderThickness="1" 
                            BorderBrush="{StaticResource ExpanderBorderBrush}" CornerRadius="2,2,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="18"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="20"/>
                            </Grid.ColumnDefinitions>
                            <CheckBox VerticalAlignment="Center" Margin="4,0,0,2"/>
                            <ToggleButton Grid.Column="2" x:Name="ToggleBt" Template="{DynamicResource MyExpanderToggleButton}" Background="{StaticResource ExpanderBackgroundBrush}" 
                                          IsChecked="{Binding Path=IsExpanded, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" 
                                          OverridesDefaultStyle="True"/>
                            <ContentPresenter Grid.Column="1" Margin="0,0,0,0" RecognizesAccessKey="True" ContentSource="Header"/>
                        </Grid>
                    </Border>
                    <Border Visibility="Collapsed" Grid.Row="1" x:Name="ExpandSite" Background="{StaticResource ContentBackgroundBrush}"
                            BorderBrush="{StaticResource ExpanderBorderBrush}" BorderThickness="1,0,1,1" CornerRadius="0,0,2,2">
                        <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" 
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}" Focusable="false"/>
                    </Border>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsExpanded" Value="True">
                        <Setter Property="Visibility" Value="Visible" TargetName="ExpandSite"/>
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter Property="Background" Value="{StaticResource ExpanderBackgroundBrush}" TargetName="Border"/>
                        <Setter Property="BorderBrush" Value="{StaticResource ExpanderBackgroundBrush}" TargetName="Border"/>
                        <Setter Property="Visibility" Value="Hidden" TargetName="ToggleBt" />
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

如何为此扩展器创建新属性 (IsChecked) 以绑定到布尔值？e. G：

```
<Expander IsChecked="{Binding MyBoolValue}" /> 
```

同样在模板上：

```
<CheckBox VerticalAlignment="Center" Margin="4,0,0,2" IsChecked="{TemplateBinding ????}" /> 
```

**编辑：**

我发现了一个[类似的问题](https://stackoverflow.com/questions/973372/binding-custom-dependency-property-to-custom-wpf-style)，但我想知道是否有另一种方法可以在不使用控制继承的情况下做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T15:29:06.143

我创建了一个这样的附加属性：

```
public sealed class AP : DependencyObject 
{
    public static bool GetIsChecked(DependencyObject obj)
    {
        return (bool)obj.GetValue(IsCheckedProperty);
    }

    public static void SetIsChecked(DependencyObject obj, bool value)
    {
        obj.SetValue(IsCheckedProperty, value);
    }

    // Using a DependencyProperty as the backing store for MyProperty.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty IsCheckedProperty =
        DependencyProperty.RegisterAttached("IsChecked", typeof(bool), typeof(AP), new UIPropertyMetadata(false));
} 
```

然后我所要做的就是：

```
<Expander my:AP.IsChecked="{Binding Path=TestBool}" /> 
```

在模板上：

```
<CheckBox VerticalAlignment="Center" Margin="4,0,0,2" IsChecked="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=(my:AP.IsChecked)}" /> 
```

我想知道如果样式是在不同的组件中定义的，该怎么办...

# apache - Apache 内容协商、文件扩展名和永久重定向

> ID：11399315
> 
> 赞同：4
> 
> 时间：2012-07-09T16:31:25.290
> 
> 标签：apache, mod-rewrite, redirect, http-status-code-301, multiviews

给定一个 Apache 2.x Web 服务器，它使用**Content Negotiation** ( `+MultiViews`) 来访问*没有*扩展名的 URL（例如，allow `/foo`vs. `/foo.php`or ），当有人*实际上*尝试使用这些扩展名时`/foo.html`，如何发出**301 永久重定向？**

 *目标是让所有道路都通向 URL 的*sans 扩展*版本，所以`/foo/`转到`/foo`，然后`/foo.html`转到`/foo`。事实证明，后者很棘手。（用例：互联网上散落的遗留 URL 仍在使用扩展。我们希望这些 URL 被永久重定向。）

有[规范的链接元素](http://www.mattcutts.com/blog/canonical-link-tag/)，但即使在随附的幻灯片中，建议最好首先执行重定向服务器端。

我一直在用**mod_rewrite**尝试这个，但看起来 Apache 就像是“打败了我”。就好像扩展被简单地忽略了一样。“不需要，我已经解决了”阿帕奇说。但是你不能处理永久重定向，因此扩展和无扩展变体都是允许的。不是想要的结果。:)

这是一个例子。给定一个由小写字母组成的 2-4 个字符的文件名，以及一个放在 中的测试文件`/foo/file.html`，我们希望永久重定向到`/foo/file`：

```
Options +MultiViews
RewriteEngine on
...
RewriteRule ^foo/([a-z]{2,4}).html/$ /foo/$1 [R=301,L] 
```

`/foo/file/`并重定向到，*但*当然`/foo/file.html/` *不会*。如果我们尝试如下规则（注意 $ 之前缺少斜杠）：`/foo/file``/foo/file.html`

 *```
RewriteRule ^foo/([a-z]{2,4}).html$ /foo/$1 [R=301,L] 
```

...我们最终得到了太多的重定向，因为 Apache 的行为就好像规则如下，所以它最终会追逐自己的尾巴：

```
RewriteRule ^foo/([a-z]{2,4})$ /foo/$1 [R=301,L] 
```

为了让自己变得太聪明，我还尝试了嵌套括号：

```
RewriteRule ^foo/(([a-z]{2,4}).html)$ /foo/$2 [R=301,L] 
```

没有骰子。重定向循环城市。

真正好的是“集体”捕捉这种事情，这样我就不会在 htaccess 中漂浮所有这些特殊情况。

[另一个 SO question 开始针对](https://stackoverflow.com/questions/9261384/redirecting-files-with-html-extension-to-files-without-extension-in-url/)处理 html 文件的单一案例解决此问题，但建议的解决方案表面上需要*禁用 Content Negotiation*，如果您仍想将它用于图像和其他文件扩展名（因为它在我的情况）。

额外的功劳：我们还想避免尾部斜杠，所以如果有人尝试`/foo/`（它本身可能是 .html 或 .php 文件），`/foo`无论如何都会去。第一条规则（上面）实现了这一点，但我认为这是由于 +MultiViews。我对在`DirectorySlash`这里使用表示怀疑，因为那里可能存在一些风险，使其不值得。**

# php - 为非常长的数据文件优化推进数据插入

> ID：11399318
> 
> 赞同：0
> 
> 时间：2012-07-09T16:31:33.713
> 
> 标签：php, database, orm, propel

我正在阅读一个很长的文本文件，其中每一行都由一个 ID、groupID 和其他数据组成。每个 ID 可以与许多 groupID 相关联（第 1、2、3 行），并且每个 ID-groupID 组合可以与许多数据相关联（第 2,3 行）。

```
JWOFJ903JCKDF8O | groupID-22 | some data 
JWOFJ903JCKDF8O | groupID-33 | same ID as above, but different groupID and data
JWOFJ903JCKDF8O | groupID-33 | same ID and groupID as above, but different data 
... 
DF8#CKJ90JJ3WOF | groupID-22 | some data 
... 
```

我正在将此数据移动到数据库中，因此我有一个 ID 表（无 ID 重复）、一个 ID 和 groupID 表（无 ID-groupID 重复）以及一个引用 ID 的数据表-groupID 表。

所以要向数据库中插入1行，我首先检查ID表中不存在这个ID，然后插入它。然后我检查 ID-groupID 表中是否不存在此 ID-groupID 组合，然后将其插入。最后，在这个 ID-groupID id 下插入数据。

```
does this $id exist in the IDs table
if($id doesn't exist in the IDs table){
  insert a new ID()
  save()
}

does this ID-groupID combo exist in the ID-groupID table
if(doesn't exist){
  create new id-groupid combo
}

does this data exist under the third table in association with this id-groupid combo
if(doesn't exist){
  insert it
} 
```

问题是因为文件非常大（100,000 行），这个过程需要几个小时才能完成。我可以做些什么来优化我的推进查询吗？还是改进数据库的设计？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:37:05.313

您应该使用[PDO](http://php.net/manual/en/book.pdo.php)。PDO 为您提供了一些性能和安全性改进。此外，PDO 和 MySQLi 模块支持[transactions](http://php.net/manual/en/pdo.begintransaction.php)，这很可能是您正在寻找的。

事务，如果你只做 INSERT/UPDATE/SELECTS，将被缓存并一次执行，而不是每次被调用。这非常适合有循环的场景。

例子：

```
$pdo = new PDO(...);
$pdo->beginTransaction();

foreach($array as $ar){
    $pdo->query('INSERT INTO...');         
}

$pdo->commit(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T19:44:06.110

看看[他的回答](https://stackoverflow.com/a/11339539/569101)。

它指向一篇关于 Propel optimizaton for a large insert 的文章。它是法语，但很容易理解。

# java - Guava java EventBus实例化错误

> ID：11399319
> 
> 赞同：6
> 
> 时间：2012-07-09T16:31:36.897
> 
> 标签：java, exception, publish, guava, publish-subscribe

我正在尝试使用 Google 的 Guava 库的 EventBus。

从 Guava 的[文档](http://docs.guava-libraries.googlecode.com/git-history/v12.0/javadoc/index.html)中，实例化一个 EventBus 对象应该很容易。

我的代码：

```
package test;

import com.google.common.eventbus.EventBus;

public class Test {
    public static void main(String[] args) {
        EventBus bus = new EventBus("Sample");
    }
} 
```

我收到此错误：

```
Exception in thread "main" java.lang.NoSuchMethodError: com.google.common.base.Objects.firstNonNull(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
at com.google.common.cache.CacheBuilder.getKeyStrength(CacheBuilder.java:355)
at com.google.common.cache.CustomConcurrentHashMap.<init>(CustomConcurrentHashMap.java:206)
at com.google.common.cache.ComputingCache.<init>(ComputingCache.java:39)
at com.google.common.cache.CacheBuilder.build(CacheBuilder.java:569)
at com.google.common.eventbus.EventBus.<init>(EventBus.java:156)
at test.Test.main(Test.java:7)
Java Result: 1 
```

我已经尝试过使用 Guava 10.0、11.0 和 12.0 并且总是出现相同的错误。我在 OSX Lion 上使用 Netbeans 7.1：我尝试过 Java 6（32 位和 64 位）和 Java 7：没有改进。在谷歌上我找不到任何东西。是番石榴的问题吗？或者，像往常一样，我错过了什么？

此致，

亚历山德罗

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-09T17:24:43.933

为了扩展@biziclop 所说的内容，您很可能在类路径中同时拥有最新版本的 Guava 和 google-collect 或 3.0 之前的 Guava 版本。Objects.firstNonNull 是在 3.0 中添加的，表明正在加载该类的旧版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-06-21T19:20:48.590

我有同样的问题。我使用的是 google-collections 1.0，其中 guava 是 v11。这个问题在我升级到之后就消失了

`<!-- https://mvnrepository.com/artifact/com.google.guava/guava --> <dependency> <groupId>com.google.guava</groupId> <artifactId>guava</artifactId> <version>19.0</version> </dependency>` 从

```
<dependency>
  <groupId>com.google.collections</groupId>
  <artifactId>google-collections</artifactId>
  <version>1.0</version>
</dependency> 
```

# javascript - 事件系统导致 Javascript 中的堆栈溢出

> ID：11399322
> 
> 赞同：3
> 
> 时间：2012-07-09T16:31:45.330
> 
> 标签：javascript, jquery, json, events, stack-overflow

我将尝试解释我的实际设置，它背后的想法，什么中断，我在它周围尝试了什么。

## 上下文

我有一个 PHP5.3 后端将“事件”（一个事件是一个包含一些数据的标准数组，其中一个唯一的序列号）提供给 Javascript（使用 jQuery 1.7.x）。使用 jsonp（在子域上）和服务器端的长轮询来检索事件。第一个事件的 id 为 1，然后随着每个新事件递增。客户端跟踪“最后检索到的事件 id”，该值从 0 开始。对于每个长轮询请求，它都会提供该 id，因此后端仅返回该事件之后发生的事件。

事件以下列方式处理：一旦被接收（通过 jsonp 回调），它们被存储在一个 eventQueue 变量中，并且“最后检索到的事件 id”被更新为最后一个接收并存储在队列中的事件。然后调用一个处理下一个排队事件的函数。该函数检查一个事件是否已经被处理（通过在一个事件开始被处理时设置的另一个变量的方式），如果它什么都不做，那么调用堆栈将我们带回到 jsonp 回调，其中一个新的发出长轮询请求。（这将在处理其他事件时重复排队新事件的过程）但是，如果当前没有正在处理的事件，它会验证队列中是否还有事件，如果是这样，它会处理第一个（具有最低 id 的那个）。“处理事件”可以是与我的应用程序相关的各种任务，但与我遇到的问题或上下文无关。例如，更新一个变量、页面上的一条消息等。一旦一个事件被认为“正在处理完成”（一些事件会进行 ajax 调用以获取或发送数据，在这种情况下，这会发生在它们的成功 ajax 回调中），调用另一个名为 eventComplete 的函数。该函数从事件队列中删除已处理的事件，确保处理事件是否正在处理的变量设置为 false，然后调用处理事件队列的函数。（所以它处理下一个，最低的 id，事件）但不是我遇到的问题或上下文。例如，更新一个变量、页面上的一条消息等。一旦一个事件被认为“正在处理完成”（一些事件会进行 ajax 调用以获取或发送数据，在这种情况下，这会发生在它们的成功 ajax 回调中），调用另一个名为 eventComplete 的函数。该函数从事件队列中删除已处理的事件，确保处理事件是否正在处理的变量设置为 false，然后调用处理事件队列的函数。（所以它处理下一个，最低的 id，事件）但不是我遇到的问题或上下文。例如，更新一个变量、页面上的一条消息等。一旦一个事件被认为“正在处理完成”（一些事件会进行 ajax 调用以获取或发送数据，在这种情况下，这会发生在它们的成功 ajax 回调中），调用另一个名为 eventComplete 的函数。该函数从事件队列中删除已处理的事件，确保处理事件是否正在处理的变量设置为 false，然后调用处理事件队列的函数。（所以它处理下一个，最低的 id，事件）调用另一个名为 eventComplete 的函数。该函数从事件队列中删除已处理的事件，确保处理事件是否正在处理的变量设置为 false，然后调用处理事件队列的函数。（所以它处理下一个，最低的 id，事件）调用另一个名为 eventComplete 的函数。该函数从事件队列中删除已处理的事件，确保处理事件是否正在处理的变量设置为 false，然后调用处理事件队列的函数。（所以它处理下一个，最低的 id，事件）

## 问题

这在所有经过测试的主要浏览器上都非常有效。（在 Internet Explorer 8 和 9、Chrome、Opera、Firefox 上测试）由于使用了长轮询，它也非常灵活。即使在重新加载页面后，获取所有“历史记录”（大多数事件生成的文本数据会附加在页面中的某种控制台中）并处于应用程序的完全相同状态也非常好。但是，当事件数量变多时，这也会成为问题。根据估计，我需要能够处理多达 30,000 个事件。在我的测试中，即使有 7,000 个事件，事情也开始出错。Internet Explorer 8 堆栈溢出大约 400 个事件。Chrome 不会加载所有事件，但会关闭（和中断，但并不总是在同一点，与 IE8 不同）。IE9 和 FF 处理一切都很好，并在处理所有事件时挂起 2-3 秒，这是可以容忍的。但是，我在想，在它们破裂之前，这可能只是更多事件的问题。是我对当前的网络浏览器要求太高，还是我做错了什么？有办法解决吗？我的整个模型错了吗？

## 可能的解决方案

我摆弄了一些想法，但没有一个真正奏效。我尝试强制后端一次不输出超过 200 个事件，并在所有当前队列完成处理后添加新的轮询请求。仍然有堆栈溢出。我还尝试在完成处理后删除`eventQueue`对象（即使它当时是空的）并重新创建它，希望它可能会释放一些底层内存或其他东西。我缺乏想法，所以任何想法、指针或一般建议将不胜感激。

**编辑：**

我有一个启示！我想我确切地知道为什么会发生这一切（但我仍然不确定如何处理和修复它），我也会提供一些基本的代码摘录。

```
var eventQueue = new Object();
var processingEvent = false;
var lastRetrievedEventId = 0;
var currentEventId = 0;

function sendPoll() {
// Standard jsonp request (to a intentionally slow backend, i.e. long-polling),
// callback set to pollCallback(). Provide currentEventId to the server to only get
// the events starting from that point.
}

function pollCallback( data ) {
    // Make sure the data isn't empty, this happens if the jsonp request 
    // expires (30s in my case) and it didn't get any new data.
    if( !jQuery.isEmptyObject( data ) )
    {
        // Add each new event to the event queue.
        $.each(data.events, function() {
            eventQueue[ this.id ] = this;
            lastRetrievedEventId = this.id; // Since we just put the event in the queue, we know it is officially the last one "retrieved".
        });

        // Process the next event, we know there has to be at least one in queue!
        processNextEvent();
    }

    // Go look for new events!
    sendPoll();
}

function processNextEvent() {
    // Do not process events if they are currently being processed, that would happen
    // when an event contains an asynchronous function, like an AJAX call.
    if( !processingEvent )
    {
        var nextEventId = currentEventId + 1;

        // Before accessing it directly, make sure the "next event" is in the queue.
        if( Object.prototype.hasOwnProperty.call(eventQueue, nextEventId) )
        {
            processingEvent = true;
            processEvent( eventQueue[ nextEventId ] );
        }
    }
}

function processEvent( event ) {
    // Do different actions based on the event type.
    switch( event.eventType ) {
        case SOME_TYPE:
            // Do stuff pertaining to SOME_TYPE.
            eventComplete( event );
            break;
        case SOME_OTHER_TYPE:
            // Do stuff pertaining to SOME_OTHER_TYPE.
            eventComplete( event );
            break;

        // Etc. Many more cases here. If there is an AJAX call, 
        // the eventComplete( event ) is placed in the success: callback 
        // of that AJAX call, I do not want events to be processed in the wrong order.
    }
}

function eventComplete( event ) {
    // The event has completed, time to process the event after it.
    currentEventId = event.id; // Since it was fully processed, it is now the most current event.
    delete eventQueue[ event.id ]; // It was fully processed, we don't need it anymore.
    processingEvent = false;
    processNextEvent(); // Process the next event in queue. Most likely the source of all my woes.
}

function myApplicationIsReady() {
    // The DOM is fully loaded, my application has initiated all its data and variables,
    // start the long polling.
    sendPoll();
}

$(function() {
    // Initializing my application.
    myApplicationIsReady();
}); 
```

看完之后，我明白了为什么调用堆栈会充满许多事件。例如（-> 表示调用）：

*`myApplicationIsReady() -> sendPoll()`*

然后在获取数据时：

*`pollCallback() -> [ processNextEvent() -> processEvent() -> eventComplete() -> processNextEvent() ]`*

括号中的部分是循环并导致调用堆栈溢出的部分。少量事件不会发生这种情况，因为它会这样做：

*`pollCallback() -> processNextEvent() -> processEvent() -> eventComplete() -> sendPoll()`*

那将有两个事件，第一个包含异步调用。（所以它到达第二个事件，它没有得到处理，因为第一个事件没有完成处理，而是调用轮询函数，然后释放整个调用堆栈，最终回调将恢复活动）

现在它不容易修复，它最初是这样设计的，因为：

*   我不想丢失事件（如，我想确保所有事件都得到处理）。
*   我不想挂起浏览器（我不能使用同步 AJAX 调用或等待某事完成的空循环）。
*   我绝对希望以正确的顺序处理事件。
*   我不希望事件卡在队列中并且应用程序不再处理它们。

这就是我现在需要帮助的地方！为了做我想做的事，听起来我需要使用链接，但这正是导致我的调用堆栈问题的原因。也许有更好的链接结构可以让我完成所有这些工作，而无需深入调用堆栈，我可能会忽略它。再次提前感谢您，我觉得我正在取得进步！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T20:55:59.523

使用 ? 而不是递归调用函数怎么样`setTimeout(func, 0)`？

# java - 是否可以动态混合 ListView 和 TextView？

> ID：11399331
> 
> 赞同：0
> 
> 时间：2012-07-09T16:32:13.313
> 
> 标签：java, android, listview, android-4.0-ice-cream-sandwich

我试图找到一种方法，但没有结果。我想要一个像下面这样的 ListView，当我点击一个元素时，比如“Word”，它会像这张图片：

![和我想要的结果](../Images/778bf7f3a755d04190c44ac96565f670.png)

是否可以 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T17:39:36.223

您所描述的是[ExpandableListView](http://developer.android.com/reference/android/widget/ExpandableListView.html)的作用。基本上它就像一个列表视图，因此您仍然必须创建自己的适配器，但它可以让您单击一行来膨胀一个更大的项目，然后您可以将文本填充到其中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:35:55.103

我建议创建您自己的扩展`ArrayAdapter`或扩展的类`BaseAdapter`。然后，您可以使用`getView()`每次为用户重绘屏幕时调用的方法。然后，您可以为每个选择设计多个视图，并选择要在`getView()`函数中显示的视图。所以当用户选择一个项目时，你在你的自定义类中设置一个标志，然后`notifyDataSetChanged()`你就可以开始了！

# unix - 需要使用 unix shell 脚本连接 DB2 数据库

> ID：11399333
> 
> 赞同：1
> 
> 时间：2012-07-09T16:32:28.267
> 
> 标签：unix, db2

需要使用 unix shell 脚本连接到 DB2 数据库我每次都使用 QMF 工具运行 DB2 查询。现在我需要通过 shell 脚本连接它。DSN 名称--GM2P 数据库名称--DPPRICMG 表名称--项目任何帮助和建议将不胜感激。任何人都可以请尽快回答这个问题。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T10:54:33.623

为了正确运行脚本，您必须按如下方式对远程数据库进行编目：

```
db2 catalog tcpip node NODE1 remote ip.ip.ip.ip server 50000
db2 catalog database mydb1 at node NODE1 authentication server 
```

然后你可以使用这个脚本来发出你想要的任何 sql：

```
db2 connect to mydb2 user username using password
db2 "update bla bla bla "
db2 connect reset 
```

请注意，如果您使用 DB2 for z/OS，那么编目会有些不同。

# python - Channel API python看不懂一部分

> ID：11399335
> 
> 赞同：0
> 
> 时间：2012-07-09T16:32:32.253
> 
> 标签：python, google-app-engine

我正在尝试使用 Google App Engine 中的通道 API 构建聊天应用程序。在浏览 [http://developers.google.com/appengine/docs/python/channel/overview](http://developers.google.com/appengine/docs/python/channel/overview)时， 我无法理解使用 XMLHttpRequest(); 打开套接字部分；任何帮助将不胜感激！！谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:51:45.890

基本上，当套接字打开时，下面的代码会更新示例井字游戏的用户界面，并向服务器发送一条 POST 消息，询问最新的游戏状态。

代码不是 Python，它是客户端[Javascript](http://en.wikipedia.org/wiki/JavaScript)。我在下面评论了它：

```
sendMessage = function(path, opt_param) {
  /* path variable is part of a URL being maintained */
  path += '?g=' + state.game_key;  /* Saving game key in URL */
  if (opt_param) {
    path += '&' + opt_param; /* Adding optional parameters to the path */
  }
  var xhr = new XMLHttpRequest(); /* Used for Ajax in Javascript */
  xhr.open('POST', path, true); /* Asynchronously POST, via HTTP, the path */
  xhr.send(); /* Start the POST above */
};

onOpened = function() {
  connected = true; /* Set boolean value, which lets us know we're connected */
  sendMessage('opened'); /* We can now send messages to the server */
  updateBoard(); /* Update user interface to reflect that socket is open */
}; 
```

请注意，应用程序定义`sendMessage()`为 XmlHttpRequest 的包装器，客户端使用它来向服务器发送消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:21:25.303

当客户端和服务器之间的通道建立时，套接字被“打开”。此时将调用 OnOpened 回调。回调向服务器发出 POST 请求以获取游戏的当前状态。因此 XMLHttpRequest 与套接字的打开无关，而只是一种具有双向通信的常见编码模式，因为通道只是一种方式（服务器到客户端）。另一条路由（客户端到服务器）是通过这些 HTTP 请求完成的。几乎每次您在频道中收到来自服务器的消息时，您都希望将某些内容发送回服务器（响应、更新等）。希望这可以帮助。

# magento - Magento 可配置产品属性

> ID：11399337
> 
> 赞同：1
> 
> 时间：2012-07-09T16:32:37.147
> 
> 标签：magento

我想为可配置产品的每个选项添加一个参数例如 - 我想创建 3 种尺寸的枕头 - S、M、L，但每种尺寸的枕头使用一些 z 码的织物，每种尺寸都不同。

下图更好地显示它。关于我应该如何进行的任何想法？*我对 Magento 开发相当陌生。这是可以开箱即用还是需要编码的东西？

![因此，每种尺寸都有一个文本框，用于输入与每种尺寸相关的码数](../Images/caafbb15a1b2ab9781ca1fb0a78e980d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:37:05.837

1）创建一个新的属性（码）

*   范围：全球
*   输入类型：下拉
*   用于创建可配置产品：是
*   插入一些标签/选项

2) 将此新属性分配给默认属性集

3) 使用尺寸和码属性创建一个新的可配置产品

# ruby-on-rails - mongoid 连接问题

> ID：11399340
> 
> 赞同：0
> 
> 时间：2012-07-09T16:33:02.530
> 
> 标签：ruby-on-rails, mongoid

我一直在尝试在 Ubuntu 上将 Mongoid 与 Rails 一起使用。Mongodb 使用 rails app 3.0 到 3.2 对我来说运行良好，

今天突然，我收到错误“/home/pravinmishra/.rvm/gems/ruby-1.9.2-p318/gems/mongo-1.5.2/lib/mongo/connection.rb:413:in `connect': Failed连接到 localhost:27017 (Mongo::ConnectionFailure) 的主节点”

很多时候我遇到这个问题，下面的命令对我有用。

```
sudo rm /var/lib/mongodb/mongod.lock
sudo -u mongodb mongod -f /etc/mongodb.conf --repair
sudo start mongodb
sudo status mongodb 
```

但今天我没有运气。

前几天我更改了我的 etc/hosts 文件并添加了 27.0.0.1 localhost.me

```
127.0.0.1 localhost.me:3000 localhost ubuntu
127.0.0.1 localhost
127.0.1.1 ubuntu
127.0.0.1 localhost.me locahost ubuntu 
```

我想，这会造成问题。为了结束，我将 mongoid.config 文件 localhost 更改为 localhost.me，但仍然出现错误“/home/pravinmishra/.rvm/gems/ruby-1.9.2-p318/gems/mongo-1.5.2/lib/mongo/ connection.rb:413:in `connect': 无法连接到 localhost.me:27017 的主节点（Mongo::ConnectionFailure）”

mongoid.yml 文件

```
defaults: &defaults
  host: localhost
  allow_dynamic_fields: false

development:
  <<: *defaults
  database: xxx_development

test:
  <<: *defaults
  database: xxx_test

# set these environment variables on your prod server
production:
 # host: <%= ENV['MONGOID_HOST'] %>
 # port: <%= ENV['MONGOID_PORT'] %>
 # username: <%= ENV['MONGOID_USERNAME'] %>
 # password: <%= ENV['MONGOID_PASSWORD'] %>
 # database: <%= ENV['MONGOID_DATABASE'] %>

 # set these environment variables on your prod server
production:
  uri: <%= ENV['MONGOHQ_URL'] %> 
```

任何建议将不胜感激，在此先感谢..!!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:07:03.950

Your `/etc/hosts` file is broken

```
27.0.0.1 localhost.me:3000 localhost ubuntu 
```

1.  Your IP is incorrect. `localhost` is at 127.0.0.1, not 27.0.0.1
2.  You can't put port numbers into this file. Think of `hosts` as a local DNS override.

Because Mongoid looks at 27.0.0.1 for a running MongoDB, it can't find one. And fails to connect.

# django - 反向关系 ToManyField Tastypie

> ID：11399342
> 
> 赞同：3
> 
> 时间：2012-07-09T16:33:09.803
> 
> 标签：django, json, tastypie

我有两个资源（Tastypie），其中一个有一个`ToManyField`字段：

```
class SongResource(ModelResource):

    class Meta:
        queryset = Song.objects.all()
        resource_name = 'song'
        authorization = Authorization()

class AlbumResource(ModelResource):
    songs = fields.ToManyField('core.api.SongResource', 'songs', full=True)
    class Meta:
        queryset = Album.objects.all()
        resource_name = 'album'
        authorization = Authorization() 
```

因此，当我访问我的 PlaylistResource 时，我会看到如下内容：

`http://127.0.0.1:8000/api/v1/playlist/1/?format=json`这是我得到的回复：

```
{
"created_in": "2012-06-24T22:57:01+00:00",
"id": "1",
"number_of_plays": 0,
"playlist_slug": "my-first-playlist",
"playlist_title": "my first playlist",
"resource_uri": "/api/v1/playlist/1/",
"songs": [{
    "genre": "Progressive metal",
    "id": "2",
    "length": "04:19",
    "number_of_plays": 0,
    "price": 0.0,
    "resource_uri": "/api/v1/song/2/",
    "song_slug": "leyla-2008",
    "song_title": "Leyla",
    "song_url": "http://www.amazon.s3.com/prologue",
    "thumbnail": "http://almacosta.files.wordpress.com/2011/05/bob_marley.jpg?w=250",
    "year": 2008
}, {
    "genre": "Progressive metal",
    "id": "3",
    "length": "3.26",
    "number_of_plays": 0,
    "price": 0.0,
    "resource_uri": "/api/v1/song/3/",
    "song_slug": "yazamadim-2008",
    "song_title": "Yazamadim",
    "song_url": "http://www.amazon.s3.com/prologue",
    "thumbnail": "http://img72.imageshack.us/img72/3215/14so8.jpg",
    "year": 2008
}] 
```

}

现在我想访问每首歌的专辑或艺术家，所以我添加了

```
album = fields.ForeignKey('core.api.AlbumResource','album') 
```

对我来说`SongResource`，但我收到了这个错误

```
{
"error_message": "'Song' object has no attribute 'album'",
"traceback": "Traceback (most recent call last):\n\n  File \"/usr/local/lib/python2.7/dist-packages/tastypie/resources.py\", line 192, in wrapper\n    response = callback(request, *args, **kwargs)\n\n  File \"/usr/local/lib/python2.7/dist-packages/tastypie/resources.py\", line 406, in dispatch_detail\n    return self.dispatch('detail', request, **kwargs)\n\n  File \"/usr/local/lib/python2.7/dist-packages/tastypie/resources.py\", line 427, in dispatch\n    response = method(request, **kwargs)\n\n  File \"/usr/local/lib/python2.7/dist-packages/tastypie/resources.py\", line 1058, in get_detail\n    bundle = self.full_dehydrate(bundle)\n\n  File \"/usr/local/lib/python2.7/dist-packages/tastypie/resources.py\", line 654, in full_dehydrate\n    bundle.data[field_name] = field_object.dehydrate(bundle)\n\n  File \"/usr/local/lib/python2.7/dist-packages/tastypie/fields.py\", line 709, in dehydrate\n    m2m_dehydrated.append(self.dehydrate_related(m2m_bundle, m2m_resource))\n\n  File \"/usr/local/lib/python2.7/dist-packages/tastypie/fields.py\", line 514, in dehydrate_related\n    return related_resource.full_dehydrate(bundle)\n\n  File \"/usr/local/lib/python2.7/dist-packages/tastypie/resources.py\", line 654, in full_dehydrate\n    bundle.data[field_name] = field_object.dehydrate(bundle)\n\n  File \"/usr/local/lib/python2.7/dist-packages/tastypie/fields.py\", line 621, in dehydrate\n    foreign_obj = getattr(bundle.obj, self.attribute)\n\nAttributeError: 'Song' object has no attribute 'album'\n" 
```

}

有什么技巧可以让我获得反向数据吗？

**编辑** 这是我的歌曲和专辑模型（与我在 models.py 文件中的顺序相同）

```
class Song(models.Model):

    song_title = models.CharField(max_length=140)
    length = models.CharField(max_length=5, blank=True, null = True)
    genre = models.CharField(max_length=100, blank = True, null = True)
    year = models.IntegerField(blank = True, null = True)
    thumbnail = models.URLField(default = '/media/thumbnail.png')
    song_url = models.URLField()
    number_of_plays = models.IntegerField(verbose_name='Number of plays')
    price = models.FloatField(default = 0.0)
    song_slug = models.SlugField(unique=True, max_length=200)

    def __unicode__(self):
        return self.song_title

class Album(models.Model):

    album_title = models.CharField(max_length=140)
    release_year = models.IntegerField('Release Year')
    price = models.FloatField(default=0.0)
    album_slug = models.SlugField(unique=True)
    songs = models.ManyToManyField(Song)

    def __unicode__(self):
        return self.album_title

    def get_absolute_url(self):
        return '/album/%s' % self.album_slug 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T19:23:38.380

使用 a`ToManyField`而不是 ForeignKey 并告诉它属性是`album_set`. 要获取要包含的完整资源，请指定`full=True`.

# java - Apache HttpClient 连接不足，但我不知道为什么？

> ID：11399343
> 
> 赞同：3
> 
> 时间：2012-07-09T16:33:24.313
> 
> 标签：java, apache-httpclient-4.x

经过一些使用，HttpClient 似乎在这里阻塞，导致我的整个应用程序冻结：

```
Thread [main] (Suspended)   
    Unsafe.park(boolean, long) line: not available [native method]  
    LockSupport.park(Object) line: 186  
    AbstractQueuedSynchronizer$ConditionObject.await() line: 2043   
    AbstractConnPool$2(PoolEntryFuture<T>).await(Date) line: 131    
    HttpConnPool(AbstractConnPool<T,C,E>).getPoolEntryBlocking(T, Object, long, TimeUnit, PoolEntryFuture<E>) line: 281 
    AbstractConnPool<T,C,E>.access$000(AbstractConnPool, Object, Object, long, TimeUnit, PoolEntryFuture) line: 62  
    AbstractConnPool$2.getPoolEntry(long, TimeUnit) line: 176   
    AbstractConnPool$2.getPoolEntry(long, TimeUnit) line: 172   
    AbstractConnPool$2(PoolEntryFuture<T>).get(long, TimeUnit) line: 100    
    PoolingClientConnectionManager.leaseConnection(Future<HttpPoolEntry>, long, TimeUnit) line: 212 
    PoolingClientConnectionManager$1.getConnection(long, TimeUnit) line: 199    
    DefaultRequestDirector.execute(HttpHost, HttpRequest, HttpContext) line: 453    
    ContentEncodingHttpClient(AbstractHttpClient).execute(HttpHost, HttpRequest, HttpContext) line: 927 
    ContentEncodingHttpClient(AbstractHttpClient).execute(HttpUriRequest, HttpContext) line: 826    
    ContentEncodingHttpClient(AbstractHttpClient).execute(HttpUriRequest) line: 804 
    ... 
```

我在返回的 HttpResponse 上没有看到任何“close()”或“release()”方法，我在这里没有做什么我需要做的事情？

根据请求，这是我的代码：

```
final HttpResponse hr = Misc.httpClient.execute(hg);
if (hr.getEntity().getContentType().getValue().toLowerCase().contains("html")) {
    final Document doc = Jsoup.parse(hr.getEntity().getContent(), ContentType.getOrDefault(hr.getEntity()).getCharset(), urlAsString);
    processDocument(url, doc);
} else if (hr.getEntity().getContentType().getValue().toLowerCase().contains("text/xml")) {
    final SyndFeedInput input = new SyndFeedInput();

    rssFeed = input.build(new InputStreamReader(hr.getEntity().getContent()));
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-09T16:41:00.973

您从 HttpResponse 中获得的`InputStream`内容需要`close()`调用它。HttpResponse 本身没有`close()`。

例如，当您获取 HttpResponse 并调用`getEntity()`以获取 HttpEntity 时，调用`getContent()`以获取 InputStream，在您完成读取内容后，调用`close()`InputStream。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:46:17.540

更多细节会有所帮助，但以下是可能发生此类事情的几个原因：

1.  您不断打开与同一台服务器的连接并期望服务器关闭它们，而服务器希望您重用连接（http1.1），因此您实际上有泄漏。

2.  您可能在导致此问题的底层传输（路由等）中存在连接问题，因此 httpclient 正在等待 TCP 超时。

3.  服务器保持连接打开，因为它很忙但尚未回复。

# java - 在 Java 中使用嵌套类实现 Iterable

> ID：11399346
> 
> 赞同：4
> 
> 时间：2012-07-09T16:33:29.943
> 
> 标签：java, generics, iterator

这是我的代码：

```
import java.util.List;

public class ItemList implements Iterable<Entry> {
    private List<Entry> entries;

    public static class Entry {
        private final String id;
        private int quantity;
    }

    @Overide public Iterator<Entry> iterator() {
        return entries.iterator();
    }
} 
```

此代码不会编译。（它声称在 ItemList 类定义中找不到“Entry”类型）。

我希望其他类能够迭代此列表的内部条目。我宁愿不将 Entry 类移到单独的文件中，因为这需要将该类的许多内部工作暴露给包中的所有其他类。

我的问题是：为什么不能编译？而且，解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-09T16:46:28.720

问题是范围界定。由于`Entry`是一个内部类，它需要以“父级”的名称为前缀。试试这个：

```
class ItemList implements Iterable<ItemList.Entry> {

    private List<Entry> entries;

    public static class Entry {
        private final String id = null;
        private int quantity;     
    }

    @Override public Iterator<Entry> iterator() {
        return entries.iterator();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:39:08.637

入口是一个私人班级，所以其他班级将无法看到它。您可以将其公开，但仍保持嵌套。

它也应该是静态的，因为它不依赖于外部类的任何状态。

# vba - 在 VBA 中保留 ActiveSheet

> ID：11399349
> 
> 赞同：1
> 
> 时间：2012-07-09T16:33:37.430
> 
> 标签：vba, excel

在我的代码中，我从一张纸上复制两行单元格并将其粘贴到另一张纸上（以及其他正常工作的东西，因此无需在这里全部引用）。我的问题是我希望宏对我选择在其中运行宏的每个工作表执行此操作，而不仅仅是最初用于记录宏的工作表。

```
Sheets("Gr 3 Lang").Select
ActiveCell.Rows("1:2").EntireRow.Select
Selection.Copy
Sheets("Gr 3 Math").Select
ActiveSheet.Paste 
```

本质上，如果我打算在“Gr 4 Math”等中运行宏，我不希望它说“Gr 3 Math”。

我尝试改用 ActiveSheet，但那时“Gr 3 Lang”是 ActiveSheet。

不知道该怎么办。

特伦顿

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T19:12:35.437

这个应该做...

```
Sheets("Gr 3 Lang").Rows("1:2").Copy ActiveSheet.Range("A1") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:08:18.943

```
Sheets(1).Rows("1:2").EntireRow.Copy
ActiveSheet.Paste 
```

将 1 替换为您想要的任何内容。您可以按名称或索引使用 Sheets("Gr 3 Math")。

# java - Java中的gzinflate

> ID：11399350
> 
> 赞同：3
> 
> 时间：2012-07-09T16:33:39.760
> 
> 标签：java, php, interop, zlib

因此，我的 Java 应用程序接收了一些使用 PHP 的 gzdeflate() 生成的数据。现在我正在尝试用 Java 扩充这些数据。这是我到目前为止所得到的：

```
InflaterInputStream inflInstream = new InflaterInputStream(new ByteArrayInputStream(inputData.getBytes() ), new Inflater());

byte bytes[] = new byte[1024];
while (true) {
    int length = inflInstream.read(bytes, 0, 1024);
    if (length == -1)  break;

    System.out.write(bytes, 0, length);
} 
```

'inputData' 是一个包含压缩数据的字符串。

问题是： .read 方法抛出异常：

> java.util.zip.ZipException：不正确的标头检查

关于这个主题的其他网站只会将我重定向到 Inflater 类的文档，但显然我不知道如何使用它来与 PHP 兼容。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-09T19:29:32.770

根据[文档](http://php.net/manual/en/function.gzdeflate.php)，php gzdeflate() 生成原始 deflate 数据 (RFC 1951)，但 Java 的[Inflater 类](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/zip/Inflater.html)需要 zlib (RFC 1950) 数据，这是包装在 zlib 标头和尾部的原始 deflate 数据。 *除非*您对 Inflater 构造函数指定[nowrap 为 true 。](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/zip/Inflater.html#Inflater%28boolean%29)然后它将解码原始放气数据。

```
InputStream inflInstream = new InflaterInputStream(new ByteArrayInputStream(inputData.getBytes()), 
                                                   new Inflater(true));

byte bytes[] = new byte[1024];
while (true) {
    int length = inflInstream.read(bytes, 0, 1024);
    if (length == -1)  break;

    System.out.write(bytes, 0, length);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:42:08.003

按照示例使用 GZIPInputStream（不要直接使用 Inflater）：

[http://java.sun.com/developer/technicalArticles/Programming/compression/](http://java.sun.com/developer/technicalArticles/Programming/compression/)

# google-drive-api - Google Drive 可以与 Google App Engine UserService 集成吗？

> ID：11399364
> 
> 赞同：0
> 
> 时间：2012-07-09T16:34:20.670
> 
> 标签：google-drive-api

我想构建我的第一个 Google Drive 应用程序，并且我已经开始使用示例项目。由于它使用自己的身份验证内容（OAuth2 等），我想知道是否有一种简单的方法可以将其与 Google App Engine 中的 UserService 集成。例如，在使用 Google Drive 身份验证时，如何使用 MailService*代表当前用户发送邮件？*

谢谢！

丹尼尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:49:39.330

就 Google Drive 而言，根本没有提到 UserService。唯一的方法似乎是 OAuth2.0

# asp.net-mvc - { 得到; 放; 在 ViewModel 中使用

> ID：11399375
> 
> 赞同：15
> 
> 时间：2012-07-09T16:35:53.627
> 
> 标签：asp.net-mvc, razor

我正在使用 C# 以及将视图模型从控制器传递到视图的 ViewModel。

在我的视图模型中，以下内容似乎按预期工作，因为它将描述信息从视图传递回控制器：

```
public string Description { get; set; } 
```

但如果我有以下内容，它不会传回描述。说明显示为空。

```
 public string Description 
```

为什么`{ get; set; }`重要？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-07-09T16:43:45.070

我对 asp.net MVC / Razor 了解不多，但是您的 2 个代码示例之间存在重要区别。

```
public string Description { get; set; } 
```

创建一个属性，一旦编译，类中有一个生成的私有字段，带有访问该字段的get/set方法。用 {get;set;} 声明的属性相当于：

```
 private string _description;
    public string Description
    {
        get
        {
            return _description;
        }
        set
        {
            this._description = value;
        }
    } 
```

但是以下内容：

```
public string Description; 
```

创建一个简单的公共字段。

我的猜测是 razor 使用反射从 ViewModel 获取值，它可能会寻找一个属性，而不是一个字段。所以它确定该属性不存在，因此返回 null

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-09T16:55:58.950

以下语法是 C# 语言功能“自动属性”。

```
public string Description { get; set; } 
```

ASP.NET MVC 使用`reflection`并且`data-binding`仅适用于属性而不适用于变量。使用属性进行公共访问是要走的路。

建议阅读[这篇](http://www.codinghorror.com/blog/2006/08/properties-vs-public-variables.html)文章，作者收回了他对公共财产的“不喜欢”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-09T17:20:19.627

`default model binder`是将请求值绑定到模型中的属性的一种。它仅将值绑定到**公共 get-set 属性**，甚至不绑定到公共字段。

如果要将值绑定到字段，则必须编写自己的模型绑定器，但公共属性或比公共字段更好，因此您不需要它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-29T11:17:38.927

**这是一个所谓的自动属性，本质上是以下内容的简写（编译器将生成类似的代码）：**

```
private string name;
public string Name
{
    get
    {
        return this.name;
    }
    set
    {
        this.name = value;
    }
} 
```

# nant - 未找到 NANT 0.92 SDK 7

> ID：11399381
> 
> 赞同：5
> 
> 时间：2012-07-09T16:35:56.653
> 
> 标签：nant

环境：

Windows 2008 R2 64Bit SDK 安装在**C:\Program Files (x86)\Microsoft SDKs\Windows\v7.1**

框架安装在**C:\Windows\Microsoft.NET\Framework64\v4.0.30319**

尝试运行 Nant 来编译一些 .NET 4 类，我们收到以下消息。

```
The SDK for the 'net-4.0' framework is not available or not configured.:

            NAnt.Core.BuildException: The SDK for the 'net-4.0'
framework is not available or not configured.
               at NAnt.Core.Tasks.ExternalProgramBase.DetermineFilePath()
               at NAnt.Core.Tasks.ExternalProgramBase.get_ProgramFileName()
               at
NAnt.Core.Tasks.ExternalProgramBase.PrepareProcess(Process process)
               at NAnt.Core.Tasks.ExternalProgramBase.StartProcess()
               at NAnt.Core.Tasks.ExternalProgramBase.ExecuteTask()
               at NAnt.Core.Task.Execute()
               at NAnt.Core.Target.Execute()
               at NAnt.Core.Project.Execute(String targetName, Boolean
forceDependencies)
               at NAnt.Core.Project.Execute()
               at NAnt.Core.Project.Run() 
```

在查看 NANt.exe.config 时，它似乎会查看注册表以找到 SDK 的适用路径。

```
<project>
 <readregistry
     property="installRoot"
      key="SOFTWARE\Microsoft\.NETFramework\InstallRoot"
      hive="LocalMachine" />
 <locatesdk property="sdkInstallRoot"
 minwinsdkver="v7.0A" minnetfxver="4.0" maxnetfxver="4.0.99999"
 failonerror="false" />
</project> 
```

注册表中不存在密钥，我们的 SDK 版本也不匹配 minwinsdkver="v7.0A"

有人遇到此问题并找到有效的解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-25T17:47:54.040

Simplest solution is to add the key to the registry.

For myself the registry entry was slightly different: at HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft.NETFramework set sdkInstallRootv2.0=C:\Program Files\Microsoft SDKs\Windows\v7.0A.

After this Nant compiled fine as expected.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-01T02:11:07.503

我昨天遇到了这个问题。另一种解决方法是将 NAnt 可执行文件标记为 32 位。

1.  打开开发人员命令提示符
2.  切换到包含您的 NAnt 可执行文件的目录。
3.  运行以下命令：*corflags NAnt.exe /32Bit+*

# javascript - 当数组的一部分没有数据时，javascript自定义排序

> ID：11399382
> 
> 赞同：1
> 
> 时间：2012-07-09T16:35:57.990
> 
> 标签：javascript

我有一个看起来像这样的对象模型：

```
MyObject = {
   TheName: "",
   OtherProps :....
} 
```

我有一个这些对象的数组，我的自定义排序函数如下所示：

```
function SortArray() {

  var CustomFunction;

  var CustomSortAsc = function (a, b) {
    return a['TheName'] - b['TheName'];
  }

  var CustomSortDsc = function (a, b) {
    return b['TheName'] - a['TheName'];
  }

  if (SomeCondition) {
      CustomFunction = CustomSortAsc;
  } else {
      CustomFunction = CustomSortDsc;
  }

  SomeArray.sort(CustomFunction);
} 
```

`SomeArray`里面有大约 200-300 个对象，问题是有时对象有一个空`TheName`属性。因此，排序似乎没有按预期工作。例如，如果有值，则按名称排序，然后根据排序函数将所有没有名称的值放入。

使这项工作的方法是什么？感谢您的建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T16:43:52.253

由于您的 TheNames 是字符串，因此您最好使用[localeCompare](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/localeCompare)代替：

```
var CustomSortAsc = function(a, b) {
    return (a['TheName'] || '').localeCompare(b['TheName'] || '');
}; 
```

我可能会这样写：

```
var baseSort = function(a, b) { 
  return (a['TheName'] || '').localeCompare(b['TheName'] || '');
};
var CustomFunction = SomeCondition 
                   ? baseSort 
                   : function(a, b) { return -baseSort(a, b); }; 
```

更新：如果您需要一直查看最后的空值...

```
var CustomSortAsc = function(a, b) {
    return a['TheName'] === '' 
         ? b['TheName'] === ''
           ? 0
           : 1
         : b['TheName'] === ''
           ? -1
           : a['TheName'].localeCompare(b['TheName']); 
}; 
```

...或者，如果您愿意`if`：

```
if (a['TheName'] === '') {
  if (b['TheName'] === '') {
    return 0;
  } else {
    return 1;
  }
} else {
  if (b['TheName'] === '') {
    return -1;
  } else {
    return a['TheName'].localeCompare(b['TheName']);
  }
} 
```

*（这实际上更具可读性吗？）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:50:02.493

自定义排序函数**必须**返回一个数字（<、= 或 > 0）。如果它返回任何其他内容（如`NaN`），则行为是“特定于实现的”（根据标准），这意味着它通常会中断并且什么都不排序。

我不确定您要对什么进行排序（'TheName' 听起来像字符串，您的函数用于数字），但是如果 b 上不存在该属性，则应该返回 1，如果 a 上不存在则返回 -1；那么您的无属性项目将被排序到数组的末尾。

# python - 从字典列表中提取所有键

> ID：11399384
> 
> 赞同：51
> 
> 时间：2012-07-09T16:36:02.083
> 
> 标签：python

我正在尝试获取字典列表中所有键的列表，以便填写 csv.DictWriter 的 fieldnames 参数。

以前，我有这样的事情：

```
[
{"name": "Tom", "age": 10},
{"name": "Mark", "age": 5},
{"name": "Pam", "age": 7}
] 
```

我`fieldnames = list[0].keys()`用来获取列表中的第一个字典并提取它的键。

现在我有这样的东西，其中一个字典比其他字典有更多的键：值对（可能是任何结果）。新键是根据来自 API 的信息动态添加的，因此它们可能会出现在每个字典中，也可能不会出现，而且我事先不知道会有多少新键。

```
[
{"name": "Tom", "age": 10},
{"name": "Mark", "age": 5, "height":4},
{"name": "Pam", "age": 7}
] 
```

我不能只使用`fieldnames = list[1].keys()`它，因为它不一定是第二个具有额外键的元素。

一个简单的解决方案是找到具有最多键的字典并将其用于字段名，但如果您有这样的示例，这将不起作用：

```
[
{"name": "Tom", "age": 10},
{"name": "Mark", "age": 5, "height":4},
{"name": "Pam", "age": 7, "weight":90}
] 
```

第二个和第三个字典都有 3 个键，但最终结果应该是列表`["name", "age", "height", "weight"]`

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2012-07-09T16:38:59.113

```
all_keys = set().union(*(d.keys() for d in mylist)) 
```

**编辑**：必须解压列表。现在修好了。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-07-09T16:47:07.197

您的数据：

```
>>> LoD
[{'age': 10, 'name': 'Tom'}, 
 {'age': 5, 'name': 'Mark', 'height': 4}, 
 {'age': 7, 'name': 'Pam', 'weight': 90}] 
```

这个集合理解会做到这一点：

```
>>> {k for d in LoD for k in d.keys()}
{'age', 'name', 'weight', 'height'} 
```

它以这种方式工作。首先，创建 dict 键列表的列表：

```
>>> [list(d.keys()) for d in LoD]
[['age', 'name'], ['age', 'name', 'height'], ['age', 'name', 'weight']] 
```

然后创建此列表列表的扁平化版本：

```
>>> [i for s in [d.keys() for d in LoD] for i in s]
['age', 'name', 'age', 'name', 'height', 'age', 'name', 'weight'] 
```

并创建一个消除重复的集合：

```
>>> set([i for s in [d.keys() for d in LoD] for i in s])
{'age', 'name', 'weight', 'height'} 
```

可以简化为：

```
{k for d in LoD for k in d.keys()} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-11-02T03:09:19.673

```
from itertools import chain

lis = [
    {"name": "Tom", "age": 10},
    {"name": "Mark", "age": 5, "height":4},
    {"name": "Pam", "age": 7, "weight":90}
]

# without qualification a dict iterates over its keys
# and set takes any iterable in its constructor
headers_as_set = set(chain.from_iterable(lis))

# you asked for a list
headers = list(
    set(chain.from_iterable(lis))
) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-09T16:45:00.177

```
>>> lis=[
{"name": "Tom", "age": 10},
{"name": "Mark", "age": 5, "height":4},
{"name": "Pam", "age": 7, "weight":90}
]
>>> {z for y in (x.keys() for x in lis) for z in y}
set(['age', 'name', 'weight', 'height']) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-09T16:41:07.980

以下示例将提取密钥：

```
set_ = set()
for dict_ in dictionaries:
    set_.update(dict_.keys())
print set_ 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-07-09T16:48:52.597

借用`lis`@AshwiniChaudhary 的回答，这里解释了如何解决问题。

```
>>> lis=[
{"name": "Tom", "age": 10},
{"name": "Mark", "age": 5, "height":4},
{"name": "Pam", "age": 7, "weight":90}
] 
```

直接在 dict 上迭代会返回其键，因此您无需调用`keys()`即可将它们取回，从而为列表中的每个元素保存一个函数调用和一个列表构造。

```
>>> {k for d in lis for k in d}
set(['age', 'name', 'weight', 'height']) 
```

或使用`itertools.chain`：

```
>>> from itertools import chain
>>> {k for k in chain(*lis)}
set(['age', 'name', 'weight', 'height']) 
```

# flash - Adobe HDS 的单独分段和加密步骤

> ID：11399385
> 
> 赞同：22
> 
> 时间：2012-07-09T16:36:05.577
> 
> 标签：flash, adobe, http-live-streaming

Adobe HTTP 动态流 (HDS) 的[文件打包](http://help.adobe.com/en_US/HTTPStreaming/1.0/Using/WSaeac10ab694095a12a9a3a7d12823cda643-7ffc.html)器支持使用一个命令对视频文件进行分段和加密。

但是，我们有一个工作流程需要，我们在加密这些文件之前对分段文件执行额外的处理步骤。

使用 HLS（HTTP Live Streaming），这很容易做到，因为加密步骤使用 AES-128 加密，它是开放且广泛实施的。

HDS可以做到这一点吗？基于对页面的简要阅读，这似乎是不可能的，但可能有其他知识证明我错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-31T16:15:20.417

我会联系 Adob​​e 并询问他们您想要在分段之后但在加密之前执行的处理。Adobe Flash Acces 具有多个加密级别，因此如果您可以使用部分加密来完成这项工作，那么它是可能的。这是有关 Adob​​e Access Server 的文档 - [http://www.adobe.com/support/adobeaccess/pdfs/server/AdobeAccess_4_ProtectingContent.pdf](http://www.adobe.com/support/adobeaccess/pdfs/server/AdobeAccess_4_ProtectingContent.pdf)。

# javascript - 使用 java 脚本代码启用在 Web 浏览器中运行的脚本

> ID：11399391
> 
> 赞同：0
> 
> 时间：2012-07-09T16:36:50.430
> 
> 标签：javascript, jquery, html, browser

我设计了一个包含一些 javascripts 的网页，但是当我在某些浏览器（如 Internet Explorer）中运行该页面时，我的脚本被阻止并且浏览器要求在该浏览器中手动启用脚本

我需要 java 脚本或 jquery 代码来使脚本在任何浏览器中自动运行。任何人都可以帮助我吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T16:37:39.800

如果在浏览器中禁用 JavaScript，网站就不可能打开它。

设计您的网站时要考虑到[渐进式增强](http://en.wikipedia.org/wiki/Progressive_enhancement)和[不显眼的 JavaScript](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript)。

* * *

如果“某些浏览器，如 Internet Explorer”，您的意思是“Internet Explorer 不会运行我的代码”（而不是“关闭 JS 的浏览器不会运行我的代码”），那么您可能只需要学习如何编写 cross - 浏览器兼容的代码。

如果没有一个不起作用的特定代码示例（以及您收到的特定错误消息），该主题太宽泛，无法在 StackOverflow 上涵盖。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T16:40:56.123

听起来您在本地运行网站，即打开文件而不是从 Web 服务器提供它。尝试运行本地 Web 服务器或在免费在线服务上托管您的网站，只要浏览器没有禁用 JavaScript，消息就不会显示。

# objective-c - 带有自动换行的 UILabel 背景颜色

> ID：11399396
> 
> 赞同：1
> 
> 时间：2012-07-09T16:37:02.783
> 
> 标签：objective-c, ios, uilabel

我想为我的 UILabel 设置一个背景“覆盖”，并让它只用文本着色标签的一部分，而不是整个矩形。见下图。

![在此处输入图像描述](../Images/9df93ad47221dd75dea547a33652d565.png)

做到这一点的最佳方法是什么？

# php - PHP获取值消失

> ID：11399398
> 
> 赞同：0
> 
> 时间：2012-07-09T16:37:05.687
> 
> 标签：php, html, forms

我有一个 html 表单，其中填充了我从 MySQL 数据库查询中获得的值。查询是`id`通过 GET 发送的。

我将 id 连同一个被锚点包围的按钮一起发送到表单`<a>`：

`<a href='editRQS.php?id=$row[0]'><button class='edit'>Edit</button></a>`

`$row[0]`由正确的填充，`id`我确信它工作正常。当我单击按钮时，会发送带有`id`. 然后在另一个页面收到它，如下所示：

```
<?php
$id = -1;

if(isset($_GET['id'])){
    $id = $_GET['id'];
    echo "<label class='exists' id='idRequest'> $id</label>";       
}

if($id != -1 ){
    echo '<form id="findRequest" class="hide" >';
} else {
    echo '<form id="findRequest" class="show" >';
}   
?> 
```

问题是`id`到达页面 - 但随后它消失了。任何帮助将不胜感激。

**编辑**

页面似乎重新加载，我不知道为什么，我有一些 javascript 来管理一些页面功能，唯一可能导致这种情况的是提交另一个表单时的事件处理程序，但我已经阻止它像这样：

```
$('anotherForm').on('submit',function(e){
   .
   .
   .
   e.preventDefault();
 } 
```

**编辑**

感谢所有提供帮助的人，我还没有找到它不起作用的原因，我尝试禁用 javascript 并且页面停止重新加载所以我想这是另一件事让我的页面变得混乱

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T17:01:28.623

检查您的 register_globals 设置，如果它打开，您将使用第一条语句覆盖 $_GET['id'] 。

您可以通过将 $id 重命名为 $id 以外的名称来轻松检查它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:15:33.527

该页面正在重新加载，因为表单已提交。`preventDefault`提交表单是不够的。尝试`e.preventDefault(); e.stopPropagation();`后者在单击提交按钮时阻止表单提交（仍然处理单击，并且在某些情况下传播到表单，然后提交。

另外，我看到你正在使用 jQuery。只需让您的事件处理程序返回 false。jQuery 自动将返回错误的处理程序转换为`e.preventDefault() ||e.returnValue = false e.stopPropagation() || e.cancelBubble = true;`构造。或者您可以自己编写代码...？

# ios - 分组 UITableView 和水平边距

> ID：11399402
> 
> 赞同：3
> 
> 时间：2012-07-09T16:37:27.323
> 
> 标签：ios, ipad, uitableview, autosize

我有一个分组的 UITableView，它真的被设计成在 iPhone 的纵向模式下看起来不错。它的单元格子视图设置了自动调整大小，以便它们在横向模式下伸展，但这使得它在美学上不太令人愉悦——单元格对于它们的内容来说看起来太宽了。

我现在把它做成一个通用应用程序，但在 iPad 上，自动调整大小会导致更大的拉伸，而且看起来无法接受。

如果我可以使 UITableView 的单元格组具有固定宽度（或最大宽度），或者我可以以某种方式控制水平边距，那将是理想的。

由于在 UITableView 中没有找到对此的支持，我做了一些快速尝试，将其子类化以在布局时限制其大小，并且作为替代方案，引入容器视图以使 UITableView 仅垂直自动调整大小。这两种方法都有效，但产生了新问题：在边缘滑动时滚动不起作用，我现在被迫使 UITableView 的背景透明（这违背了 Apple 的建议），因为现在 UITableView 的框架和之间的背景不连续边距。

有没有人找到解决我的问题的技巧（即限制 UITableView 中组的宽度，导致边距扩大以填充视图的宽度），或者它的开源解决方案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T15:49:14.247

好消息！我终于找到了一种方法，只需进行微小的代码更改即可令人满意地实现这一目标：

*   根据这篇文章的解决方案，通过子类化`UITableViewCell`和覆盖来缩小单元格： [How to set the width of a cell in a UITableView in grouped style](https://stackoverflow.com/questions/2539021/how-to-set-the-width-of-a-cell-in-a-uitableview-in-grouped-style)`-setFrame`

*   并且要添加垂直填充，使用`contentInset`UITableView 的属性（从 UIScrollView 继承）效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T20:57:45.120

您始终可以保留标准表格视图并为表格视图单元格提供具有透明边的自定义背景，以便它们看起来比实际小。

Cocoa With Love 有一篇关于如何做到这一点的精彩文章：[Easy custom UITableView drawing](http://cocoawithlove.com/2009/04/easy-custom-uitableview-drawing.html)。

这篇文章的基本要点是你需要制作六个不同版本的背景，并在`tableView:cellForRowAtIndexPath:`要求一个单元格时提供正确的一个。您将需要一个顶部有圆角（用于截面的第一行），一个底部有圆角（用于截面的底行），以及一个所有四个角都是圆形的（当只有一节中的一行）。然后您将需要相同的三个，但为每行的“选定”版本定制。

# android - Appcelerator：使用 GCM 获取通知，让该通知打开应用程序

> ID：11399404
> 
> 赞同：2
> 
> 时间：2012-07-09T16:37:32.420
> 
> 标签：android, titanium, google-cloud-messaging

我有 GCM 向我的手机发送通知，我的手机可以收到它们（如果应用程序已经打开。如果它不再运行，它不会打开。这也是一个问题。）

但是，现在我关注的是当我点击收到的通知时会发生什么。特别是，什么也没有发生。我已经对其进行了设置，以便它应该通过意图打开应用程序，但它不起作用。

这是我的 app.js 中的相关部分：

```
var senderId = 'XXXXXXXXXX';

var c2dm = require('com.findlaw.c2dm');
Ti.API.info("module is => " + c2dm);

Ti.API.info('Registering...');
c2dm.registerC2dm(senderId, {
    success:function(e) {
        Ti.API.info('JS registration success event: ' + e.registrationId);

        var params = {devicecode: e.registrationId, deviceType: "Android"};
        JOURNAL.webApi.webCallPOST(JOURNAL.serviceLocatorModel.urls.Membership, "/registerdevice", params, JOURNAL.registerDeviceComplete, JOURNAL.registerDeviceError);
    },
    error:function(e) {
        Ti.API.error("Error during registration: "+e.error);

        var message;
        if(e.error == "ACCOUNT_MISSING") {
            message = "No Google account found; you'll need to add one (in Settings/Accounts) in order to activate notifications";
        } else {
            message = "Error during registration: "+e.error
        }

        Titanium.UI.createAlertDialog({
            title: 'Push Notification Setup',
            message: message,
            buttonNames: ['OK']
        }).show();
    },
    callback:function(e) // called when a push notification is received
    {
        Ti.API.info('JS message event: ' + JSON.stringify(e.data));

        var intent = Ti.Android.createIntent({
            action: Ti.Android.ACTION_MAIN,
            flags: Ti.Android.FLAG_ACTIVITY_NEW_TASK | Ti.Android.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED,
            className: 'com.geneca.journaling.GenecaJournalingActivity',
            //className: 'org.appcelerator.titanium.TiActivity',
            packageName: 'com.geneca.journaling'
        });
        intent.addCategory(Ti.Android.CATEGORY_LAUNCHER);

        // This is fairly static: Not much need to be altered here
        var pending = Ti.Android.createPendingIntent({
            activity: Ti.Android.currentActivity,
            intent: intent,
            type: Ti.Android.PENDING_INTENT_FOR_ACTIVITY,
        });

        var notification = Ti.Android.createNotification({
            contentIntent: pending,
            contentTitle: 'New message',
            contentText: e.data.message,
            tickerText: "New message"
        });

        Ti.Android.NotificationManager.notify(1, notification);
    }
}); 
```

这是我的 tiapp.xml 中的相关部分

```
<android xmlns:android="http://schemas.android.com/apk/res/android">
    <manifest>
        <activity android:name="com.geneca.journaling.GenecaJournalingActivity" />
        <permission android:name="com.geneca.journaling.permission.C2D_MESSAGE" android:protectionLevel="signature"/>
        <uses-permission android:name="com.geneca.journaling.permission.C2D_MESSAGE"/>

        <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE"/>
        <uses-permission android:name="android.permission.WAKE_LOCK"/>
        <application>
            <service android:name="com.findlaw.c2dm.C2DMReceiver"/>
            <receiver
                android:name="com.google.android.c2dm.C2DMBroadcastReceiver" 
                    android:permission="com.google.android.c2dm.permission.SEND">
                <intent-filter>
                    <action android:name="com.google.android.c2dm.intent.RECEIVE"/>
                    <category android:name="com.geneca.journaling"/>
                </intent-filter>
                <intent-filter>
                    <action android:name="com.google.android.c2dm.intent.REGISTRATION"/>
                    <category android:name="com.geneca.journaling"/>
                </intent-filter>
            </receiver>
        </application>
    </manifest>
</android>
<modules>
    <module platform="android" version="0.1">com.findlaw.c2dm</module>
</modules> 
```

我已经运行了 log cat，它收到了通知和意图，但它吐出了这个，并且没有打开应用程序：

```
I/ActivityManager(  307): START {act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10200000 pkg=com.geneca.journaling cmp=com.geneca.journaling/.GenecaJournalingActivity bnds=[0,102][720,230] u=0} from pid -1
W/KeyguardViewMediator(  307): verifyUnlock called when not externally disabled
W/InputMethodManagerService(  307): Window already focused, ignoring focus gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@41c18038 attribute=android.view.inputmethod.EditorInfo@42319798 
```

（中间的并不总是出现，所以我认为它并不相关。）

附带说明一下，如果应用程序未打开，日志猫会给我`Bad notification posted from package com.geneca.journaling.mobile: Couldn't create icon`，然后是一堆错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T05:53:05.093

我已将我的 gcm 模块上传到 github。希望你们可以好好工作。=] [https://github.com/liccowee/Google-Cloud-Messaging--Titanium-](https://github.com/liccowee/Google-Cloud-Messaging--Titanium-)

# java - 单一 RMI 服务的简单入口点？

> ID：11399408
> 
> 赞同：2
> 
> 时间：2012-07-09T16:37:45.077
> 
> 标签：java, service, rmi, rmiregistry

我有几个导出 RMI 接口的服务。

他们过去通过创建自己的注册表（使用`LocateRegistry.createRegistry`）并将其绑定在那里来提供此功能。然而，当服务被转移到在同一个虚拟机（Tomcat）中作为单独的应用程序运行时，这变得不可能了，因为由于某种原因，那里只能存在一个注册表。

我通过为所有服务使用中央注册表来解决这个问题。即便如此，我对注册表的多对象注册表角色并不真正感兴趣，只是它的入口点设施。然而，中央注册中心引入了更多的复杂性（例如，它必须首先启动，它必须具有它注册的服务的接口）。

有没有办法恢复每个服务独立提供其 RMI 接口的入口点的情况，同时让它们在同一个 VM 中运行（这是托管细节，不是设计的一部分）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:43:09.053

我忘记了我已经问[过一个类似的问题](https://stackoverflow.com/questions/4864206/server-via-rmi-without-registry)（出于不同的原因，减少代码，在我将服务一起移动到一个 VM 之前），其中第一个答案建议了一种绕过注册表的方法：

> 使用 UnicastRemoteObject，将导出对象时获得的存根序列化，并使用共享文件、套接字或sneakernet 使存根对客户端可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-15T06:30:40.767

如果一年后你仍然对这个问题感兴趣......

可以在同一个 JVM 中启动多个注册表。只需调用`LocateRegistry.getRegistry`不同的端口即可。您必须为每个服务拥有众所周知的端口，但我认为如果您已经实施了从[这个答案到另一个问题的](https://stackoverflow.com/a/4988791/1441122)选项 3，那么您已经在这样做了。

很久以前有一个错误会阻止多个注册表共存于同一个 JVM 中，但在 JDK 5 中已修复。Tomcat 中可能存在阻止多个 RMI 注册表运行的问题。或者，您使用的 Tomcat 版本可能位于非常旧的 JDK 之上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T23:37:44.293

每个 JVM 不能有多个 Registry，因为 Registry 有一个固定的 RMI 对象 ID。只需调整所有服务器以像这样开始：

```
static Registry registry;
// ...
try
{
  registry = LocateRegistry.createRegistry(Registry.REGISTRY_PORT);
}
catch (...) // whatever the exception is, probably ExportException
{
  registry = LocateRegistry.locateRegistry(Registry.REGISTRY_PORT);
}
registry.rebind(...); // etc 
```

然后他们中的任何一个先启动将启动注册表，其他人将使用它。

# emacs - dired+ 不会自动启动

> ID：11399410
> 
> 赞同：3
> 
> 时间：2012-07-09T16:37:54.090
> 
> 标签：emacs, dired

当我键入时，内置的 Dired 就会启动`C-x d`。[`dired+`](http://www.emacswiki.org/emacs/DiredPlus)已加载，因为我可以运行`diredp-*`命令，但`dired+`仅*在*我运行`diredp`命令后才启动。问题是什么？我正在使用 Emacs 24.1，并`dired+`通过包管理器安装。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T18:21:27.640

Dired+ 未加载。您看到的所有功能都是自动加载的。这意味着只要你调用其中一个函数，emacs 就知道它需要读取 diredp.el。读取该文件后，它会覆盖默认目录并使一切正常。

要解决您的问题，只需`(require 'diredp)`在您的`.emacs`.

# ios - 旋转时自动排列网格样式元素的最佳方法？

> ID：11399412
> 
> 赞同：1
> 
> 时间：2012-07-09T16:37:58.943
> 
> 标签：ios, xcode

我的应用程序中有一个项目网格，如下所示：

[http://cl.ly/1m243117220B060Z0M26/Screen%20Shot%202012-07-09%20at%2011.34.22%20AM.png](http://cl.ly/1m243117220B060Z0M26/Screen%20Shot%202012-07-09%20at%2011.34.22%20AM.png)

目前这些只是自定义 UIButtons。使这些网格项目自动重新排列以适应横向模式的宽度的最佳方法可能是什么？

[http://cl.ly/1d0x431P1n211W1H2n3B/Screen%20Shot%202012-07-09%20at%2011.35.42%20AM.png](http://cl.ly/1d0x431P1n211W1H2n3B/Screen%20Shot%202012-07-09%20at%2011.35.42%20AM.png)

显然，这通常在应用程序中完成，但我搜索了一下，找不到我想要的东西。

如果有人知道 Isotope for iOS ( [http://isotope.metafizzy.co/](http://isotope.metafizzy.co/) )

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T18:22:49.187

您可能需要一个根据滚动视图的大小调整滚动视图和图像（或者在我的情况下是带有图像的按钮）的例程（并确保设置滚动视图`autoSizingMask`，使其随着方向的变化而伸展）。

因此，例如，我有一个执行以下操作的例程（它假设您已经为每个图标添加了 UIButton 创建的滚动视图......不过，如果您也使用 UIImageViews，这个基本想法也可以工作）：

```
- (void)rearrangeImages
{
    if (!_listOfImages)
    {
        [self loadImages];
        return;
    }

    // a few varibles to keep track of where I am

    int const imageWidth = [self thumbnailSize];
    int const imagesPerRow = self.view.frame.size.width / (imageWidth + 2);
    int const imageHeight = imageWidth;
    int const imagePadding = (self.view.frame.size.width - imageWidth*imagesPerRow) / (imagesPerRow + 1);
    int const cellWidth = imageWidth + imagePadding;
    int const cellHeight = imageHeight + imagePadding;

    NSInteger row;
    NSInteger column;
    NSInteger index;

    CGRect newFrame;

    // iterate through the buttons

    for (UIView *button in [_scrollView subviews])
    {
        index = [button tag];

        if ([button isKindOfClass:[UIButton class]] && index < [_listOfImages count])
        {
            // figure out where the button should go

            row = floor(index / imagesPerRow);
            column = index % imagesPerRow;
            newFrame = CGRectMake(column * cellWidth  + imagePadding, 
                                  row    * cellHeight, 
                                  imageWidth, 
                                  imageHeight);

            if (button.frame.origin.x != newFrame.origin.x || button.frame.origin.y != newFrame.origin.y)
                [button setFrame:newFrame];
        }
    }

    NSInteger numberOfRows = floor(([_listOfImages count] - 1) / imagesPerRow) + 1;

    [_scrollView setContentSize:CGSizeMake(self.view.frame.size.width, numberOfRows * cellHeight)];
} 
```

然后，当屏幕改变方向时，我的应用程序会调用它，例如，

```
- (void)viewWillLayoutSubviews
{
    [self rearrangeImages];
} 
```

如果您支持 iOS 5 之前的版本，您可能还需要以下内容：

```
- (void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration
{
    float iOSversion = [[[UIDevice currentDevice] systemVersion] floatValue];

    // we don't need to do this in iOS 5, because viewWillLayoutSubviews is automatically called

    if (iOSversion < 5.0)
        [self viewWillLayoutSubviews];
} 
```

# c# - 带有 DevDefined.OAuth 的 App Metro 错误

> ID：11399417
> 
> 赞同：0
> 
> 时间：2012-07-09T16:38:10.767
> 
> 标签：c#, oauth, microsoft-metro, windows-runtime

我正在为 Windows 8 开发应用程序 Metro。我使用 DevDefined.Oauth 进行身份验证，但出现以下错误：

> 无法加载文件或程序集“System.Web，Version=2.0.0.0，Culture=neutral，PublicKeyToken=b03f5f7f11d50a3a”或其依赖项之一。该系统找不到指定的文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T21:56:36.323

这是因为 Metro 的 .NET 仅支持一小[部分通用程序集和类](http://msdn.microsoft.com/en-us/library/windows/apps/br230232.aspx)。`System.Web`根本不支持，因此您无法在 Metro 应用程序中使用该库。

# javascript - 使用 javascript 将 JSON 对象绑定到 asp.net gridview 控件

> ID：11399420
> 
> 赞同：0
> 
> 时间：2012-07-09T16:38:26.400
> 
> 标签：javascript, jquery, asp.net, html, json

我的 jquery ajax 调用了我的 codebehining 静态 WebMethod，我曾经 `System.Web.Script.Serialization.JavaScriptSerializer`获取 JSON 对象，输出是这样的。

```
[{"ProductId":"9","Category":"TV","Products":"Discovery","Price":15.97},{"ProductId":"25","Category":"TV","Products":"HBO","Price":15.97}] 
```

我有具有 ProductId、Category、Products、Price 列的 GridView（asp.net 控件）。我应该使用 JavaScript 将此 json 对象绑定到 gridview。

我什至不知道如何在上面的 Json 字符串上申请循环。请对此有所了解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:05:53.973

You can loop thru your `JSON` data like this

```
var data=[{"ProductId":"9","Category":"TV","Products":"Discovery","Price":15.97},
          {"ProductId":"25","Category":"TV","Products":"HBO","Price":15.97}];

$.each(data,function(index,item){
    alert(item.ProductId);
    alert(item.Category);
}); 
```

To replace the Grid, You can build the HTML markup for a table and inject that to the DOM.

```
 var itemRow="<table>";  
 $.each(data,function(index,item){
    itemRow+="<tr><td>"+item.ProductId+"</td><td>"+item.Category+"</td></tr>";
 });        
 itemRow+="</table>";  

 $("#divItems").html(itemRow); 
```

Working sample [http://jsfiddle.net/qS7uD/6/](http://jsfiddle.net/qS7uD/6/)

But you will not get the ASP.NET Grid Events after this as it is pure HTML markup for the display

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:01:10.237

要反序列化您的 JSON，您应该创建一个具有相同属性的类并像这样使用 JavascriptSerilzier。

```
public class Product
{
  public int ProductId{get;set;}
  public string Category{get;set;} 
  public string Products{get;set;} 
  public decimal Price{get;set;}
} 

myProducts List<Product> = new JavaScriptSerializer().Deserialize<List<Project>>(myJson); 
```

然后，您可以使用简单的 for-each 循环遍历您的产品列表。您也可以使用 List 作为数据源来绑定您的控件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T16:46:15.307

您不能使用默认的 asp.net 网格来执行此操作，[请查看 jQGrid](http://www.trirand.com/blog/)以获取基于 json 的网格

# qt - 更改 QTabWidget 中选定选项卡的光标

> ID：11399421
> 
> 赞同：0
> 
> 时间：2012-07-09T16:38:29.643
> 
> 标签：qt, qtabwidget, qtabbar

我想知道是否可以更改 a 的选定选项卡的光标`QTabWidget`。我的意思是：我想为选定的选项卡设置一个箭头，为其他选项卡设置一个“手”。我能够为小部件的 4 个选项卡设置“手”，但不能单独设置。

我可以这样做吗？

谢谢

`QTabBar`---编辑---我可以访问`QTabWidget`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T17:43:39.300

子类`QTabBar`，在它的构造函数中打开鼠标跟踪（`setMouseTracking(true)`），在`mouseMoveEvent(QMouseEvent* event)`调用`tabAt(const QPoint& position) const`和`currentIndex() const`。如果它们返回相同的数字使用`setCursor(Qt::OpenHandCursor)`，否则使用`unsetCursor()`返回正常的箭头光标（记得先调用父类实现）。

我假设您可以访问 ，`QTabBar`因为您已经派生自`QTabWidget`，否则您将必须对其进行子类化才能设置新的`QTabBar`派生类。

# java - 使用流在 Java 中传输数据

> ID：11399422
> 
> 赞同：0
> 
> 时间：2012-07-09T16:38:49.337
> 
> 标签：java, io, stream

我一直在阅读[有关 I/O 的 Java 教程，](http://docs.oracle.com/javase/tutorial/essential/io/)试图了解流及其正确用法。假设我有两个连接的设备，`InputStream`并且`OutputStream`在两个设备上都有一个和。如何在两者之间传输数据？

例如，如果我想要一个设备向另一个设备发送一堆单词，然后将它们打印到屏幕上。那将如何运作？

```
public class Device1 {
    // assuming connectedDevice is something
    String[] words = new String()[]{"foo", "bar", "baz"};
    OutputStream os = connectedDevice.getOutputStream();
    InputStream is = connectedDevice.getInputStream();
    /*
        How to write to output stream?
    */
}

public class Device2 {
    // assuming connectedDevice is something
    ArrayList<String> words = new ArrayList<String>();
    OutputStream os = connectedDevice.getOutputStream();
    InputStream is = connectedDevice.getInputStream();
    /*
        How can I somehow get the words using `read()` and `put()`
        them into the ArrayList for use?
    */
} 
```

也许我做错了所有这些。在此先感谢您对理解的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:44:00.857

这取决于设备的连接方式。例如，它们可能通过 TCP 或通过共享文件系统进行连接。

如果您想专注于流，请创建一个使用文件系统的应用程序。然后，使用`FileOutputStream`并`FileInputStream`了解流 API。

如果您的重点是网络，那么您也需要学习[网络教程](http://docs.oracle.com/javase/tutorial/networking/index.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:50:15.143

如果您只想发送字符，请`OutputStreamWriter`在写入端使用 an 并`InputStreamReader`在读取端使用 an 来包装您的流。您可以编写整个字符串，然后一次读取一个字符并打印它。如果您需要非常小心，您应该为两者选择一个固定的字符编码。

如果你想发送像`String`s 这样的整个简单对象，你可以使用`DataOutputStream`/ `DataInputStream`。（对于字符串，使用`UTF`方法。）

如果您想变得更复杂，则需要使用`ObjectOutputStream`and对对象进行序列化/反序列化`ObjectInputStream`。

# symfony - Sonata 用户包创建 4 个表

> ID：11399433
> 
> 赞同：1
> 
> 时间：2012-07-09T16:39:18.990
> 
> 标签：symfony, fosuserbundle, symfony-sonata

我之前安装过 FosUser 包，今天安装了 SonataUserBundle。当我 --dump-sql 时，Symfony 想要安装 4 个新表：

```
fos_user_user
fos_user_group
for_user_user_group
notification_message 
```

前 3 个令人困惑，因为管理员已经在使用现有的 ...Entity\User 类，我什至为其设置了关系。

```
namespace Rent\ProgramBundle\Entity;

use FOS\UserBundle\Entity\User as BaseUser;
use Doctrine\ORM\Mapping as ORM;

/**
* @ORM\Entity
* @ORM\Table(name="tbl_user")
*/
class User extends BaseUser
... 
```

为什么要安装这 3 个表以及如何防止这种情况？它们有什么用，因为即使没有它们，管理部分也能正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-22T22:41:02.273

默认情况下，SonataAdminBundle 不附带任何用户管理功能，但应用程序很可能需要此类功能。Sonata 项目包括一个集成了 FOSUserBundle 的 SonataUserBundle。

FOSUserBundle 在 Symfony2 中增加了对数据库支持的用户系统的支持。它为用户管理提供了一个灵活的框架，旨在处理用户登录、注册和密码检索等常见任务。

SonataUserBundle 只是一个将 FOSUserBundle 包含到 AdminBundle 中的薄包装器。SonataUserBundle 包括：

*   默认登录区域
*   用于显示当前用户和注销链接的默认 user_block 模板
*   2个管理类：用户和组
*   用户和组的默认类。

SonataAdminBundle 中有一个小魔法：如果 bundle 检测到 SonataUserBundle 类，那么默认的 user_block 模板将被更改为使用 SonataUserBundle 提供的模板。

请看一下这个[文件](http://sonata-project.org/bundles/admin/master/doc/reference/security.html)。希望它是有帮助的。

# iphone - UIActionSheet，在继续之前获取 clickedButtonIndex？

> ID：11399435
> 
> 赞同：0
> 
> 时间：2012-07-09T16:39:25.563
> 
> 标签：iphone, uiactionsheet, objective-c-category

我想要做的是在 UITableView 上，用户滑动一行以调出删除选项，一旦他们按下删除，就会弹出一个 UIActionSheet 以确保他们想要删除该行，因为它比典型的行更重要在一张桌子上。根据他们按下的内容，我可以从数据库中删除该行中的数据。我如何将该行的 indexPath 放入 UIActionSheet 中？如果我有一个单节表，那么我也许可以使用该行的标记并重新创建 indexPath，但是对于多个节，如何做到这一点？

似乎有一个更好的方法可以在我的

```
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath 
```

方法，我可以删除那里的行。或者有没有办法从 UIActionSheet 传回信息？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T17:23:29.660

`-tableView:commitEditingStyle:forRowAtIndexPath:`您可以将 存储为`indexPath`属性/ivar，然后将`ActionSheet`.

当用户确认删除时，只需删除数据（您已经存储了`indexPath`！）并从表格视图（`-deleteRowsAtIndexPaths:withRowAnimation:`或`-reloadData`）中删除单元格。不要忘记保留/释放`indexPath`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:50:43.603

有几件事：

1.  我不会使用 UIActionSheet，我会使用 UIAlertView。
2.  正在“编辑”以进行删除的行可以或被设置为 selectedRow。
3.  如果用户选择“是”继续并删除该行按钮，那么您可以调用

UITableView 对象上的 [indexPathForSelectedRow] 方法。无需保存额外的 NSIndexPath 对象或记住状态。TableView 已经为您做到了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T17:54:56.703

我通过为 actionSheet = indexpath.row 设置标签来作弊

```
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
    // If row is deleted, remove it from the list.
    if (editingStyle == UITableViewCellEditingStyleDelete)
    {
        UIActionSheet *registerActionSheet = [[UIActionSheet alloc] initWithTitle:@"Sure You Want To Delete?"delegate:self cancelButtonTitle:@"Cancel" destructiveButtonTitle:ACTION_SHEET_DELETE_BUTTON_TITLE otherButtonTitles: nil];
        registerActionSheet.tag = indexPath.row;
        registerActionSheet.actionSheetStyle = UIActionSheetStyleBlackOpaque;
        [registerActionSheet showInView:self.view];
    }
} 
```

进而

```
-(void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex{
    if ([[actionSheet buttonTitleAtIndex:buttonIndex] isEqualToString:ACTION_SHEET_DELETE_BUTTON_TITLE]) {

         //do deleting stuff here using actionSheet.tag as index

    } 
```

}

编辑：刚刚看到您正在使用的多个部分的微妙之处。通过向其添加 indexPath 属性来扩展 UIActionSheet 会对您的情况有所帮助吗？

或将标签设置为“x”数字，前半部分表示部分，后半部分表示行。

# python - 在python中使用csv writer时如何设置准确性

> ID：11399437
> 
> 赞同：2
> 
> 时间：2012-07-09T16:39:30.300
> 
> 标签：python, csv

我有一个浮点变量 obj["time"]，它代表 unix 时间，之前我将结果写入文本文件，所以我可以使用

```
 fd_out.write("%.6f\n" %(obj["time"])) 
```

强制结果为小数点后 6 位。但现在我想将结果打印到 csv 文件中，所以我使用了：

```
 writer.writerow((obj["time"])) 
```

结果默认只有2位小数，我该如何更改？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T16:41:30.610

使用中间格式应该可以解决您的问题，例如以下示例：

```
writer.writerow(("%.6f" % obj["time"], )) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:43:43.077

当您直接写入文件时，您执行了格式化操作以将浮点变量转换为具有所需位数的字符串。您可以对 CSV 编写器执行完全相同的操作。

```
writer.writerow("%.6f" %(obj["time"])) 
```

正如评论中指出的那样，您需要省略换行符，因为 CSV 编写器会为您添加它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T16:44:51.313

[来自在 Python 中为 csv.writer 指定格式](https://stackoverflow.com/questions/2982642/specifying-formatting-for-csv-writer-in-python)的较早答案：

```
class TypedWriter:
    """
    A CSV writer which will write rows to CSV file "f",
    which uses "fieldformats" to format fields.
    """

    def __init__(self, f, fieldnames, fieldformats, **kwds):
        self.writer = csv.DictWriter(f, fieldnames, **kwds)
        self.formats = fieldformats

    def writerow(self, row):
        self.writer.writerow(dict((k, self.formats[k] % v) 
                                  for k, v in row.iteritems()))

    def writerows(self, rows):
        for row in rows:
            self.writerow(row) 
```

# c# - 在 C# 中将字符串转换为双精度

> ID：11399439
> 
> 赞同：78
> 
> 时间：2012-07-09T16:39:34.233
> 
> 标签：c#, string, double, type-conversion

`#`我有一个长字符串，其中包含由-`value1#value2#value3#`等分隔的双类型值

我将它拆分为字符串表。然后，我想将此表中的每个元素转换为双精度类型，但出现错误。这里的类型转换有什么问题？

```
string a = "52.8725945#18.69872650000002#50.9028073#14.971600200000012#51.260062#15.5859949000000662452.23862099999999#19.372202799999250800000045#51.7808372#19.474096499999973#";
string[] someArray = a.Split(new char[] { '#' });
for (int i = 0; i < someArray.Length; i++)
{
    Console.WriteLine(someArray[i]); // correct value
    Convert.ToDouble(someArray[i]); // error
} 
```

* * *

## 回答 #1

> 赞同：201
> 
> 时间：2012-07-09T16:42:41.317

有3个问题。

**1) 小数点分隔符不正确**

不同的文化使用不同的小数分隔符（即`,`和`.`）。

如果您`.`用`,`它替换应该按预期工作：

```
Console.WriteLine(Convert.ToDouble("52,8725945")); 
```

您可以使用将文化作为第二个参数的重载方法解析您的双打。在这种情况下，您可以使用`InvariantCulture`（[什么是不变的文化](https://stackoverflow.com/questions/2423377/what-is-the-invariant-culture)），例如使用`double.Parse`：

```
double.Parse("52.8725945", System.Globalization.CultureInfo.InvariantCulture); 
```

您还应该看一下[`double.TryParse`](https://msdn.microsoft.com/en-us/library/3s27fasw.aspx)，您可以将它与许多选项一起使用，并且检查您的字符串是否有效特别有用`double`。

**2）你有一个不正确的双**

您的值之一不正确，因为它包含两个点：

`15.5859949000000662452.23862099999999`

**3）您的数组末尾有一个空值，这是不正确的双精度数**

您可以使用重载`Split`来删除空值：

`string[] someArray = a.Split(new char[] { '#' }, StringSplitOptions.RemoveEmptyEntries);`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-03-26T05:13:03.607

将类添加为 Public 并像 convertToInt32() 一样轻松使用它

```
 using System;
  using System.Collections.Generic;
  using System.Linq;
  using System.Web;

  /// <summary>
  /// Summary description for Common
  /// </summary>
  public static class Common
  {
     public static double ConvertToDouble(string Value) {
        if (Value == null) {
           return 0;
        }
        else {
           double OutVal;
           double.TryParse(Value, out OutVal);

           if (double.IsNaN(OutVal) || double.IsInfinity(OutVal)) {
              return 0;
           }
           return OutVal;
        }
     }
  } 
```

然后调用函数

```
double DirectExpense =  Common.ConvertToDouble(dr["DrAmount"].ToString()); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-07-09T16:57:07.800

大多数人已经尝试回答你的问题。
如果你还在调试，有没有想过使用：

```
Double.TryParse(String, Double); 
```

这将帮助您在进行实际解析之前首先确定每个字符串中的错误。
如果您有文化相关的问题，您可以考虑使用：

```
Double.TryParse(String, NumberStyles, IFormatProvider, Double); 
```

这个[http://msdn.microsoft.com/en-us/library/system.double.tryparse.aspx](http://msdn.microsoft.com/en-us/library/system.double.tryparse.aspx)有一个很好的例子来说明如何使用它们。

如果你需要一个长的，Int64.TryParse 也可用：http: [//msdn.microsoft.com/en-us/library/system.int64.tryparse.aspx](http://msdn.microsoft.com/en-us/library/system.int64.tryparse.aspx)

希望有帮助。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-01-22T13:07:45.433

```
private double ConvertToDouble(string s)
    {
        char systemSeparator = Thread.CurrentThread.CurrentCulture.NumberFormat.CurrencyDecimalSeparator[0];
        double result = 0;
        try
        {
            if (s != null)
                if (!s.Contains(","))
                    result = double.Parse(s, CultureInfo.InvariantCulture);
                else
                    result = Convert.ToDouble(s.Replace(".", systemSeparator.ToString()).Replace(",", systemSeparator.ToString()));
        }
        catch (Exception e)
        {
            try
            {
                result = Convert.ToDouble(s);
            }
            catch
            {
                try
                {
                    result = Convert.ToDouble(s.Replace(",", ";").Replace(".", ",").Replace(";", "."));
                }
                catch {
                    throw new Exception("Wrong string-to-double format");
                }
            }
        }
        return result;
    } 
```

成功通过的测试是：

```
 Debug.Assert(ConvertToDouble("1.000.007") == 1000007.00);
        Debug.Assert(ConvertToDouble("1.000.007,00") == 1000007.00);
        Debug.Assert(ConvertToDouble("1.000,07") == 1000.07);
        Debug.Assert(ConvertToDouble("1,000,007") == 1000007.00);
        Debug.Assert(ConvertToDouble("1,000,000.07") == 1000000.07);
        Debug.Assert(ConvertToDouble("1,007") == 1.007);
        Debug.Assert(ConvertToDouble("1.07") == 1.07);
        Debug.Assert(ConvertToDouble("1.007") == 1007.00);
        Debug.Assert(ConvertToDouble("1.000.007E-08") == 0.07);
        Debug.Assert(ConvertToDouble("1,000,007E-08") == 0.07); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-11-21T10:32:20.733

你可以试试这个例子。一个简单的 C# 程序将字符串转换为双精度

```
class Calculations{

protected double length;
protected double height;
protected double width;

public void get_data(){

this.length = Convert.ToDouble(Console.ReadLine());
this.width  = Convert.ToDouble(Console.ReadLine());
this.height = Convert.ToDouble(Console.ReadLine());

   }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-09T16:41:23.293

在您的字符串中，我看到：`15.5859949000000662452.23862099999999`这不是双精度（它有两个小数点）。也许这只是一个合法的输入错误？

您可能还想弄清楚您的最后一个`String`是否为空，并考虑这种情况。

# html - 使用单选按钮的可折叠内容？

> ID：11399440
> 
> 赞同：0
> 
> 时间：2012-07-09T16:39:35.713
> 
> 标签：html, jquery-mobile

我正在尝试根据用户是否单击单选按钮来显示和隐藏文本字段。这可能吗？根据文档，可折叠内容需要一个标题。

这是我的代码，没有可折叠的内容：

```
 <fieldset data-role="controlgroup" data-mini="true">
           <input type="radio" name="radio-mini" id="radio-mini-1" value="choice-1" />
            <label for="radio-mini-1">No</label>

            <input type="radio" name="radio-mini" id="radio-mini-2" value="choice-2"  />
            <label for="radio-mini-2">Yes</label>
    </fieldset>
    <label for="textarea-a">Textarea:</label>
    <textarea name="textarea" id="textarea-a">
    </textarea> 
```

如果单击标记为“是”的单选按钮，我希望显示文本区域。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:59:16.837

好吧，如果 the`radio`和 the`textarea`是兄弟姐妹（并且您正在使用并且很高兴与最新的浏览器兼容），您可以使用 CSS：

```
label[for=textarea-a],
#textarea-a {
    display: none;
}

#radio-mini-2:checked ~ label[for=textarea-a],
#radio-mini-2:checked ~ #textarea-a {
    display: block;
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/ayU4T/1/)。

在上面，我`radio`从 中删除了您的元素`fieldset`（因为`textarea`，并且它`label` *必须*是兄弟姐妹才能使这种方法起作用）。

# .htaccess - 如何仅使用 htaccess 使某些用户可以访问网站

> ID：11399441
> 
> 赞同：2
> 
> 时间：2012-07-09T16:39:42.547
> 
> 标签：.htaccess

我的网站正在建设中，我想把网站展示给我的朋友，并拒绝所有用户。我在 htaccess 文件中使用了特定的 ip，但 ip 不是静态的。有没有办法保留mac地址？或任何方式

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T16:51:19.663

您无法使用 htaccess 文件中的指令匹配 MAC 地址。你也可以

1.  在您的实际内容上设置密码，没有密码的每个人都会被转发到“建设中”页面（可能使用`ErrorDocument`403 /under_construction.html`）

2.  寻找一个特殊的查询字符串，你可以只给你的朋友：

    ```
    RewriteEngine On
    RewriteCond %{QUERY_STRING} !special_var=my_buddies
    RewriteRule ^ /under_construction.html [R=301,L] 
    ```

    所以在这里，任何没有`special_var=my_buddies`查询字符串（[http://hostname.com/some/content.php?special_var=my_buddies](http://hostname.com/some/content.php?special_var=my_buddies)）的 url 都会被重定向到建设中的页面

3.  您可以通过设置 cookie 来做类似的事情。创建一个称为类似的小型登录页面`/my_buddies.php`，只需`set_cookie()`调用创建`my_buddies`cookie（不必是 php，cookie 可以被称为任何东西）。然后执行与查询字符串类似的操作：

    ```
    RewriteEngine On
    RewriteCond %{HTTP_COOKIE} !my_buddies
    RewriteRule ^ /under_construction.html [R=301,L] 
    ```

    本质上是一样的。如果`my_buddies`cookie 字符串中没有，则重定向到建设中的页面。

可能还有其他方法可以做这样的事情，但我想不出任何事情。

# android - 适用于 Android EasyTracker 的 Google Analytics V2 SDK 出现错误

> ID：11399443
> 
> 赞同：11
> 
> 时间：2012-07-09T16:39:52.283
> 
> 标签：android, google-analytics, google-analytics-api

我已按照位于此处的新的适用于 Android 的 Google Analytics V2 SDK 的教程进行操作：

[https://developers.google.com/analytics/devguides/collection/android/v2/](https://developers.google.com/analytics/devguides/collection/android/v2/)

不幸的是，每当我运行应用程序时，报告都不起作用，这是 logcat 给我的消息：

```
07-09 09:13:16.978: W/Ads(13933): No Google Analytics: Library Incompatible.
07-09 09:13:16.994: I/Ads(13933): To get test ads on this device, call adRequest.addTestDevice("2BB916E1BD6BE6407582A429D763EC71");
07-09 09:13:17.018: I/Ads(13933): adRequestUrlHtml: <html><head><script src="http://media.admob.com/sdk-core-v40.js"></script><script>AFMA_getSdkConstants();AFMA_buildAdURL({"kw":[],"preqs":0,"session_id":"7925570029955749351","u_sd":2,"seq_num":"1","slotname":"a14fd91432961bd","u_w":360,"msid":"com.mysampleapp.sampleapp","js":"afma-sdk-a-v6.0.1","mv":"8013013.com.android.vending","isu":"2BB916E1BD6BE6407582A429D763EC71","cipa":1,"format":"320x50_mb","net":"wi","app_name":"1.android.com.mysampleapp.sampleapp","hl":"en","u_h":592,"carrier":"311480","ptime":0,"u_audio":3});</script></head><body></body></html>
07-09 09:13:17.041: W/ActivityManager(220): Unable to start service Intent { act=com.google.android.gms.analytics.service.START (has extras) }: not found
07-09 09:13:17.049: W/GAV2(13933): Thread[main,5,main]: Connection to service failed 1
07-09 09:13:17.057: W/GAV2(13933): Thread[main,5,main]: Need to call initializea() and be in fallback mode to start dispatch.
07-09 09:13:17.088: D/libEGL(13933): loaded /system/lib/egl/libGLES_android.so
07-09 09:13:17.096: D/libEGL(13933): loaded /vendor/lib/egl/libEGL_POWERVR_SGX540_120.so
07-09 09:13:17.096: D/libEGL(13933): loaded /vendor/lib/egl/libGLESv1_CM_POWERVR_SGX540_120.so
07-09 09:13:17.096: D/libEGL(13933): loaded /vendor/lib/egl/libGLESv2_POWERVR_SGX540_120.so 
```

这是我的代码（我已经编辑了一些与 httppost 等有关的代码）：

```
 package com.mysampleapp.sampleapp;

    import java.io.BufferedReader;
    import java.io.InputStream;
    import java.io.InputStreamReader;
    import java.util.ArrayList;
    import java.util.List;

    import org.apache.http.HttpEntity;
    import org.apache.http.HttpResponse;
    import org.apache.http.NameValuePair;
    import org.apache.http.client.HttpClient;
    import org.apache.http.client.entity.UrlEncodedFormEntity;
    import org.apache.http.client.methods.HttpPost;
    import org.apache.http.impl.client.DefaultHttpClient;
    import org.apache.http.message.BasicNameValuePair;
    import org.json.JSONArray;
    import org.json.JSONObject;

    import com.google.analytics.tracking.android.EasyTracker;

    import android.app.Activity;
    import android.app.ProgressDialog;
    import android.content.DialogInterface;
    import android.content.DialogInterface.OnCancelListener;
    import android.content.Intent;
    import android.content.SharedPreferences;
    import android.os.AsyncTask;
    import android.os.Bundle;
    import android.preference.PreferenceManager;
    import android.util.Log;
    import android.view.View;
    import android.view.View.OnClickListener;
    import android.widget.ImageView;
    import android.widget.TextView;

    public class viewRandom extends Activity {

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);

            setContentView(R.layout.viewrandom);

            uservote.setVisibility(View.GONE);
            new randomViewClass().execute();

        }

        public void onStart() {
            super.onStart();
            EasyTracker.getInstance().activityStart(this);
        }

        public void onStop() {
            super.onStop();
            EasyTracker.getInstance().activityStop(this);
        }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-11T01:40:17.943

我意识到这是一篇旧帖子，但我想提供更多信息，这与我今天收到的错误完全相同。

王子是完全正确的，它来自破折号。对于大多数删除破折号并输入 - 再次将起作用。但是一旦你再次清理你的项目，它会将它切换回 en_dash，这可能是 mysho 的问题。

由于 Android Lint，它会自动执行此操作。你可以禁用它！

> 进入你的偏好（我在 Mac 上，所以对我来说它是 Eclipse -> Preferences）
> 
> 转到 Android 转到 Lint 错误检查
> 
> 您可以完全禁用 Lint 检查器，也可以像我做的那样，只禁用 en_dash 东西
> 
> 要么在 Usability:Typography 下使用名为“TypographyDashes”的那个，要么在搜索框中搜索“dash”。无论哪种方式，它都应该提供 TypographyDashes。
> 
> 突出显示并在严重性下将其设置为“忽略”
> 
> 从那里单击应用，然后允许它重新启动

希望我能帮上忙

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-10T15:12:39.627

好的，我发现了问题所在。它在我的 analytics.xml 文件中：

```
<?xml version="1.0" encoding="utf-8" ?>
<resources>
    <string name="ga_trackingId">UA-0000000-00</string>
    <bool name="ga_autoActivityTracking">true</bool>
    <bool name="ga_reportUncaughtExceptions">true</bool>
    <string name="ga_sampleFrequency">20</string>
</resources> 
```

发生的事情是当我将我的 trackingId 粘贴到文件中时，eclipse 自动将其转换为“破折号”，而 Google 无法正确读取我的 trackingId。将破折号更改为常规破折号效果很好，现在一切正常。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-05-11T10:00:16.137

最好在“资源”标签中添加一个属性，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<resources xmlns:tools="http://schemas.android.com/tools" tools:ignore="TypographyDashes">
  <!--Replace placeholder ID with your tracking ID-->
  <string name="ga_trackingId">UA-12345678-X</string>

  <!--Enable automatic activity tracking-->
  <bool name="ga_autoActivityTracking">true</bool>

  <!--Enable automatic exception tracking-->
  <bool name="ga_reportUncaughtExceptions">true</bool>
</resources> 
```

# javascript - JavaScript 代码包上传前后网站性能差异

> ID：11399445
> 
> 赞同：0
> 
> 时间：2012-07-09T16:40:08.540
> 
> 标签：javascript, scripting, web

我一直在研究通过添加不同的 JavaScript 代码包来衡量网站性能的方法。在将代码添加到站点之前和之后，我可以使用哪些工具来进行性能分析。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:45:40.117

Chrome（内置）和 Firefox（Firebug）都具有出色的性能检查器。如果您只需要感受一下性能，它们就“足够好”了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:45:35.740

我过去使用过几种工具：

*   [https://developers.google.com/speed/pagespeed/](https://developers.google.com/speed/pagespeed/)
*   [http://yslow.org/](http://yslow.org/)

今天，您可以在[谷歌分析](http://analytics.blogspot.co.il/2012/03/measure-your-websites-performance-with.html)中获得这些性能指标……这很棒，因为您可以看到在您将更改部署到您的网站之前/之后的历史记录。

# c# - 在 ASP.NET MVC 2 中保存对象时抛出 NHibernate.TransientObjectException

> ID：11399447
> 
> 赞同：0
> 
> 时间：2012-07-09T16:40:13.700
> 
> 标签：c#, asp.net-mvc, nhibernate, fluent-nhibernate

当我尝试在我正在处理的 MVC 2 项目中使用关联的姓氏列表保存客户时，我遇到了 NHibernate 抛出 TransientObjectException 的问题。

这是类的代码：

```
public class Customer 
{
  public virtual Guid Id { get; set; }
  public virtual int Version { get; set; } 
  public virtual string Forename { get; set; }
  public virtual IList<FamilyName> FamilyNames { get; set; } 
}
public class FamilyName
{
  public virtual Guid Id { get; set; }
  public virtual int Version { get; set; } 
  public virtual string Name{ get; set; }
  public virtual bool IsCurrent { get; set; }
  public virtual Patient Patient { get; set; }
} 
```

我正在使用 Fluent NHibernate 进行持久性，映射如下所示：

```
public CustomerMap()
{
  Table("Customers");
  Id(x=>x.Id).GeneratedBy.GuidComb();
  Version(x => x.Version);
  Map(x => x.Forename).Not.Nullable();
  HasMany(x => x.FamilyNames)
    .Inverse()
    .Cascade.All();
}

public FamilyNameMap()
{
  Table("FamilyNames");
  Id(x=>x.Id).GeneratedBy.GuidComb();
  Version(x => x.Version);
  Map(x => x.Name).Not.Nullable();
  Map(x => x.IsCurrent).Not.Nullable();
  References(x => x.Patient).Not.Nullable();
} 
```

我有一个强类型的 EditCustomerDetails 视图，其中包含以下代码：

```
<% using (Html.BeginForm("SaveChanges", "CustomerDetails")) { %>
<input type="submit" value="Save changes"/>
<%= Html.HiddenFor(customer => customer.Id) %>
<%= Html.HiddenFor(customer => customer.Version) %>
  <label>Forename:</label>
  <%= Html.TextBoxFor(customer => customer.Forename)%>
  <label>Family Names</label>
  <div class="familyNames">
  <%= Html.EditorFor(customer => customer.FamilyNames)%>
  </div>
<% } %> 
```

这是 FamilyName 类的自定义编辑器模板：

```
<%= Html.HiddenFor(name => name.Id) %>
<%= Html.HiddenFor(name => name.Version) %>
<%= Html.HiddenFor(name => name.Patient.Id) %>
<label>Name:</label>
<%= Html.TextBoxFor(name => name.Name) %>
<label>Is Current?:</label>
<%= Html.CheckBoxFor(name =>name.IsCurrent) %> 
```

单击 Save Changes 按钮调用控制器上的一个方法，该方法将客户传递回存储库，该存储库调用 ISession 上的 Update 方法。这是 NHibernate.TransientObjectException 与消息“对象引用未保存的瞬态实例 - 在刷新之前保存瞬态实例”的消息一起抛出的地方。

我不知道为什么会这样。我已经进入了代码，并且所有数据都从视图中正确传回，所有对象都具有正确的属性值。我能够找到解决此问题的唯一建议是参考在映射中设置 Cascade.All ，这就是我一直在做的事情。

有任何想法吗？

编辑：这是错误消息：

```
ERROR Shipping.Web.Filters.UnhandledErrorAttribute - An unhandled exception has occurred
 Shipping.TransientObjectException: object references an unsaved transient instance - save the transient instance before flushing. Type: Shipping.Domain.Entities.Customer, Entity: Haemoglobinopathy.Domain.Entities.Customer
   at NHibernate.Engine.ForeignKeys.GetEntityIdentifierIfNotUnsaved(String entityName, Object entity, ISessionImplementor session)
   at NHibernate.Type.EntityType.GetIdentifier(Object value, ISessionImplementor session)
   at NHibernate.Type.ManyToOneType.NullSafeSet(IDbCommand st, Object value, Int32 index, Boolean[] settable, ISessionImplementor session)
   at NHibernate.Persister.Entity.AbstractEntityPersister.Dehydrate(Object id, Object[] fields, Object rowId, Boolean[] includeProperty, Boolean[][] includeColumns, Int32 table, IDbCommand statement, ISessionImplementor session, Int32 index)
   at NHibernate.Persister.Entity.AbstractEntityPersister.Update(Object id, Object[] fields, Object[] oldFields, Object rowId, Boolean[] includeProperty, Int32 j, Object oldVersion, Object obj, SqlCommandInfo sql, ISessionImplementor session)
   at NHibernate.Persister.Entity.AbstractEntityPersister.UpdateOrInsert(Object id, Object[] fields, Object[] oldFields, Object rowId, Boolean[] includeProperty, Int32 j, Object oldVersion, Object obj, SqlCommandInfo sql, ISessionImplementor session)
   at NHibernate.Persister.Entity.AbstractEntityPersister.Update(Object id, Object[] fields, Int32[] dirtyFields, Boolean hasDirtyCollection, Object[] oldFields, Object oldVersion, Object obj, Object rowId, ISessionImplementor session)
   at NHibernate.Action.EntityUpdateAction.Execute()
   at NHibernate.Engine.ActionQueue.Execute(IExecutable executable)
   at NHibernate.Engine.ActionQueue.ExecuteActions(IList list)
   at NHibernate.Engine.ActionQueue.ExecuteActions()
   at NHibernate.Event.Default.AbstractFlushingEventListener.PerformExecutions(IEventSource session)
   at NHibernate.Event.Default.DefaultFlushEventListener.OnFlush(FlushEvent event)
   at NHibernate.Impl.SessionImpl.Flush()
   at NHibernate.Transaction.AdoTransaction.Commit()
   at Haemoglobinopathy.Persistence.TransactionAttribute.OnActionExecuted(ActionExecutedContext filterContext) in C:\dev\Projects\Haemoglobinopathy\Haemoglobinopathy.Persistence\TransactionAttribute.cs:line 26
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation)
   at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClassd.<>c__DisplayClassf.<InvokeActionMethodWithFilters>b__c()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation)
   at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClassd.<>c__DisplayClassf.<InvokeActionMethodWithFilters>b__c()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor, IDictionary`2 parameters)
   at System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:43:57.790

尝试调用 ISession.SaveOrUpdate

# c# - 预期的 C# 方法名称 - 多线程

> ID：11399449
> 
> 赞同：1
> 
> 时间：2012-07-09T16:40:18.497
> 
> 标签：c#, .net, multithreading

我已经在 C# 中创建了这个程序，但我收到了“预期方法名称”错误。我究竟做错了什么？

```
for (int i = 0; i < numberofThreads2; i++)     
{   
    Thread thread1 = new Thread(new ThreadStart (Start(1, 2, 3, 4, 5)));
    thread1.Start();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T16:42:17.247

您正在创建错误的线程委托。尝试：

```
Thread thread1 = new Thread(() => Start(1, 2, 3, 4, 5)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-09T16:42:54.123

`ThreadStart`是具有签名的委托`void ThreadStart()`。这与 call 不同`Start(...)`，后者实际上`Start`立即运行，而不是在新线程中传递委托来执行此操作。您可能正在寻找`Thread thread1 = new Thread(() => Start(1, 2, 3, 4, 5));`，它创建了一个与以下方法等效的 lambda，该方法可以转换为`ThreadStart`：

```
void myLambda()
{
    Start(1, 2, 3, 4, 5);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T16:43:46.497

`ThreadStart`因为 ThreadStart 是一个委托，它的目的是封装一个方法，所以期待一个方法的名称。

像这儿

```
public void foo () { }

ThreadStart ts = new ThreadStart(foo); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T16:46:47.113

```
new Thread(()=> Start(1,2,3,4,5)).Start(); 
```

# c# - 为什么 List 没有更新，为什么 var w 一直为空？

> ID：11399453
> 
> 赞同：0
> 
> 时间：2012-07-09T16:40:43.613
> 
> 标签：c#

在按钮 8 点击事件中我做了：

```
 private void button8_Click(object sender, EventArgs e)
        {
            if (buttonLockMode == true)
            {
                trackBar1.Enabled = true;
                button8.ForeColor = Color.Red;
                button8.Enabled = false;
                textBox1.Text = "Frame Number : " + trackBar1.Value;
                this.trackBar1.Select();
                textBox3.Enabled = true;
                textBox4.Enabled = true;
                wireObjectAnimation1 = new WireObjectAnimation(this, wireObject1);
                int currentFrameIndexRight = trackBar1.Value;
                wireObjectCoordinates1 = new WireObjectCoordinates() { FrameNumber = currentFrameIndexRight };
                WireObjectCoordinatesCloneFrame();

                List<WireObjectCoordinates>  temp = wireObjectAnimation1.CoordinatesList;
                temp.Add(wireObjectCoordinates1);
                //wireObjectAnimation1.CoordinatesList.Add(wireObjectCoordinates1);

                //WireObjectCoordinatesCloneFrame();

            }
            else
            {
                button8.ForeColor = Color.Black;
            }
        } 
```

Phoog 我使用了与临时列表相同的想法。在wireObjectanimation中我做了：

```
private List<WireObjectCoordinates> _coordinateslist = new List<WireObjectCoordinates>();
        public List<WireObjectCoordinates> CoordinatesList
        {
            get { return _coordinateslist; } 
        } 
```

而且当我在获取行上放置断点时，_coordinateslist 和 CoordinatesList 都是空的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:40:56.163

`First`如果没有满足谓词的元素，则抛出。因此，在 which 中很可能没有`_coordinatesList`项目`FrameNumber`等于`currentFrameIndex`。

试试这个：更改`catch`为`catch (Exception e)`并在执行进入 catch 块时，使用调试器检查异常。或者，将您的调试器设置为在处理的异常上中断，这也将使您有机会检查异常。

一旦你确定了假设是否为真，即序列中没有元素满足谓词，你可以进行下一步，即确定*为什么*没有元素满足谓词：要么你的期望是错误的，或者应该满足期望的代码是错误的。

这是一个很好的例子，说明了为什么你永远不应该`catch { }`在你的代码中使用。

如果您坚持代码约定，这也会很有帮助。像这样的标识符`_coordinatesList`通常是私有字段；`WireObjectCoordinatesList`通常是公共财产。你有它倒退，这是令人困惑的。

关于列表 getter 中的断点：

> 我在 get 上放了一个断点，当我点击 button8 时它停在那里但是现在 List _coordinatesList 是空的。如果我将断点放在 Form1 button8 单击事件上，我会看到列表包含点坐标，但是当我在 wireObjectanimation 类中时，列表为空。

考虑这段代码：

```
private List<string> _words = new List<string>();
public List<string> Words { get { return _words; } } 
```

而这个调用代码：

```
void AddAWord(string word)
{
    this.Words.Add(word);
} 
```

该调用代码等价于：

```
void AddAWord(string word)
{
    List<string> temp = this.Words;
    temp.Add(word);
} 
```

换句话说，属性 getter 首先将列表返回给`AddAWord`，然后在列表上`AddAWord`调用`Add`。这很可能是当您将断点放在属性 getter 中时列表尚未包含任何内容的原因。

编辑

我并不是说添加临时变量可以解决您的问题。相反， temp 变量旨在阐明问题发生的原因。添加 temp 变量不会改变代码的含义。事实上，C# 编译器很可能会隐式创建 temp 变量。

也许我误解了你的所作所为和你的期望，但在我看来，你的期望是不正确的。换句话说，您将断点放在了错误的行上。

考虑：

```
1  private List<WireObjectCoordinates> _coordinateslist = new List<WireObjectCoordinates>();  
2  public List<WireObjectCoordinates> CoordinatesList  
3  {  
4      get { return _coordinateslist; } // <<< your breakpoint here
5  }  
6
7  private void button8_Click(object sender, EventArgs e)   
8  {   
9      if (buttonLockMode == true)   
10     {
11         // ...
12         List<WireObjectCoordinates>  temp = wireObjectAnimation1.CoordinatesList; // <<< my breakpoint here
13         temp.Add(wireObjectCoordinates1);
14     }   
15     else   
16     {   
17         // ... 
```

现在单步执行代码。您在第 4 行有一个断点。我在第 12 行添加一个断点。我们首先到达第 12 行。按 F11。执行移至第 4 行，这是您的断点。请注意，该列表是空的。当然它是空的，因为我们还没有到达第 13 行。

按几次 F11 以逐步通过属性获取器。执行点返回到第 12 行。`temp`变量仍然为空。再次按 F11 将属性值分配给`temp`变量。执行移至第 13 行。

再次按 F11。这调用了`Add`方法。现在列表包含一个元素。

我的观点是，无论是否有临时变量，这一系列指令都是相同的。考虑一个单行表达式，如下所示：

```
wireObjectAnimation1.CoordinatesList.Add(wireObjectCoordinates1); 
```

以下步骤按此顺序发生：

*   确定引用的对象`wireObjectAnimation1`
*   调用该`CoordinatesList`对象的 getter
*   在上一步getter`Add`返回的对象上调用方法`CoordinatesList`

您的断点在第二步；`Add`在第三步调用；因此，当您命中断点时，该列表为空。

# database - VB.NET中的MS访问数据库

> ID：11399458
> 
> 赞同：0
> 
> 时间：2012-07-09T16:41:03.363
> 
> 标签：database, vb.net, ms-access

我按照互联网上的教程创建了自己的数据库。我成功地在它上面建立了一个程序。然后我创建了一个访问 .mdb 文件（另一个数据库），然后我将程序连接的数据库更改为我创建的数据库。

我只是做了一个改变。但是，每当我尝试使用更新时，它就开始向我显示错误

```
da.update(ds,"Phone Book") 
```

其中 da 是数据适配器，ds 是数据集。

> 错误是：“ INSERT INTO 语句中的语法错误”

我刚刚更改了程序连接的数据库。我没有改变一点代码。

编辑：我忘了提，我在谷歌上搜索过这个，我读到的一件事是，那个访问数据库可能是只读的或什么的。但是我取消了只读框，所以我不知道它是否仍然可能是问题。虽然，我不认为代码有问题

编辑：我现在才发现，即使我更改了所引用的表，它也会引发相同的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:44:55.870

听起来第一个数据库可能使用了 Sql Server Express 之类的东西。这是一种与 Access 完全不同的数据库，具有不同的提供程序、不同的 SQL 方言、连接字符串等。为什么您认为可以在不破坏某些代码的情况下更改所有这些？

# ant - Ant：应用文件集，但只在一个文件上执行一次？

> ID：11399465
> 
> 赞同：0
> 
> 时间：2012-07-09T16:41:25.697
> 
> 标签：ant, less

我正在处理与此处的问题类似的事情：[ANT script to compile all (css) LESS files in a dir and subdirs with RHINO](https://stackoverflow.com/questions/6909106/ant-script-to-compile-all-css-less-files-in-a-dir-and-subdirs-with-rhino)

但是，我很难将其定制为一个特定的要求：

*   如果有任何`.less`文件发生更改：*仅在*`dir.less`一个文件上运行 LESS （因为它会导入其他较少的文件，从而生成单个组合输出）。

 *这是我当前的状态`build.xml`：

```
<target name="less" description="Compile LESS files">

    <echo message="Checking for LESS file changes..."/>

    <apply dir="${dir.less}" executable="${tool.less}" parallel="false" failonerror="true">

        <fileset dir="${dir.less}" includes="*.less" />
        <srcfile/>

        <mapper type="glob" from="*.less" to="${dir.css}/*.css"/>
        <targetfile/>

        <arg value="-compress" />
  </apply>

</target> 
```

这当前构建所有`.LESS`文件并将它们输出到适当的位置（这是可居住的）。如果我将映射器全局替换为：

`<mapper type="glob" from="MainFileThatImportsOthers.less" to="${dir.css}/MainFileThatImportsOthers.css"/>`

文件集指令有效地简化为该文件，并且更改该`.LESS`目录中的其他文件不会导致任务输出。

有人可以指出我正确的方向，这样我就可以避免设置错误并每次都回避每个`.LESS`文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T21:42:39.487

研究[选择器](http://ant.apache.org/manual/Types/selectors.html)如何在 ANT 中工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T21:01:28.503

我制定了一个可以正常工作的解决方案，我使用一个`upToDate`任务来设置一个属性以有条件地触发`Exec`编译器：

```
<target name="scanLess" description="Scan for LESS file changes">

    <echo message="Checking for LESS file changes..."/>

    <uptodate property="tool.less.changed" targetfile="${dir.css}/MyFile.css" >
        <srcfiles dir="${dir.less}" includes="*.less" />
    </uptodate>

</target>

<target name="less" depends="scanLess" unless="tool.less.changed" description="Compile LESS files" >

    <echo message="LESS files changed, running lessc" />

    <exec executable="${tool.less}" failonerror="true">
        <arg value="${dir.less}/MyFile.less" />
        <arg value="${dir.css}/MyFile.css" />
        <arg value="-compress" />
    </exec>
</target> 
```*

# sqlite - PyQt QMessageBox 表现得很有趣

> ID：11399468
> 
> 赞同：0
> 
> 时间：2012-07-09T16:41:36.090
> 
> 标签：sqlite, pyqt, qmessagebox

我的 QMessageBox 答案有些奇怪。此函数用于从 SQLite 数据库中删除一行。在删除之前，会弹出一个消息框并要求确认。查询执行得很好，除了它总是删除，无论我回答是还是否。

这是代码：

```
def deleteFromDB(self):
  name = (str(self.ui.searchName.text()).upper())
    if name:
      with con:
        cur = con.cursor()
        cur.execute('SELECT name FROM cases WHERE name =?',[name])
        tempname = str(cur.fetchone())
        if len(tempname) != 4 :
            reply = QtGui.QMessageBox.question(self, 'Removal',
                    "Are you sure ", QtGui.QMessageBox.Yes |
                     QtGui.QMessageBox.No, QtGui.QMessageBox.No)
                 if reply == QtGui.QMessageBox.Yes:
                     cur.execute('DELETE FROM cases where name =?',[name]) 
```

# ios - 在模拟器上崩溃，而不是在设备上

> ID：11399472
> 
> 赞同：2
> 
> 时间：2012-07-09T16:42:14.310
> 
> 标签：ios, memory-management, memory-leaks, ios-simulator

我的应用程序在设备上运行时崩溃（顺便说一句），崩溃不能 100% 重现。但它似乎只发生在设备上，而不是在模拟器中。

当我使用 NSZombies 在模拟器中运行时，我从未发现任何问题。有人可以阐明我在下面的观点。

*   设备内存有限，可能因此而崩溃。
*   什么会被认为是会导致崩溃的大内存分配？
*   内存泄漏/大分配会导致内存损坏吗？
*   我所有的崩溃总是 EXC_BAD_ACCESS 但就像我说的那样，从来没有在模拟器上发生过，所以我不能运行僵尸。（或者还有其他方法吗？）

注意我还在模拟器上模拟了低内存警告，看看这是否会导致问题。

这让我发疯了。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T17:56:18.153

```
I know where it crashes but I need to know which other classes released this object. 
```

为您的对象覆盖 -[release] -[autorelease] 和 -[retain] （或者如果您不知道哪个对象，您可以为 NSObject 执行此操作），然后记录它们，设置断点。

如果您确定在每个点释放哪个对象，将时间戳/对象 ID/保留计数添加到日志语句中，那么您可能能够将所有数据放入电子表格，然后获得与 Instruments 相同的数据给你。

耻辱你必须为 3.0 构建。几乎没有人再使用 3.x，而 ARC（虽然不是解决所有问题的灵丹妙药）比非 ARC 好得多。

这里还有一个提示：从您的模拟器中删除该应用程序并重新安装它。我遇到了一个问题，我的项目中缺少一些捆绑资源，但模拟器在构建之间挂在它们上。如果您尝试加载不再在您的项目中的 .xib，我可能会看到它崩溃...

# visual-studio-2010 - VS2010 SP1 变量检测

> ID：11399477
> 
> 赞同：0
> 
> 时间：2012-07-09T16:42:25.823
> 
> 标签：visual-studio-2010, visual-studio-debugging

我在 C#/.NET4 中有一个项目，其中一个方法中有几个嵌套循环。最近，我注意到我无法将鼠标悬停在这些循环中检查变量值。事实上，如果我转到即时窗口并尝试手动研究该值，编译器会报告该变量不存在。当我将鼠标悬停时，什么都没有出现，但它只出现在一种方法的某些部分。如果我查看相同代码的其他部分（我无法弄清楚这些部分之间在调试方面的区别）鼠标悬停工作正常。我的事情很简单：

```
for (int i = 0...)
{
   XX Breakpoint is hit here XX
} 
```

我无法获得 i 的价值！VS2010 调试器是否存在一些限制，这是一个已知问题，它只会影响某些代码部分？我删除了所有的 PDB 文件，从头开始完全重建文件，但它似乎仍然不知道变量存在。非常感谢任何建议。

# mercurial - 嵌套子存储库中的 Mercurial 新存储库

> ID：11399478
> 
> 赞同：2
> 
> 时间：2012-07-09T16:42:36.497
> 
> 标签：mercurial, mercurial-subrepos

我不确定这是否可能，如果不是，任何替代解决方案都将受到欢迎！

我有许多使用 Orchard 的解决方案 - 它要求任何模块都位于其文件夹结构内的某个目录中。我有一些模块，基于 DVCS 的强大功能，我希望能够仅使用 suprepos 重现一个新项目。并且只用 Mercurial 更新 Orchard。

我的文件夹结构如下：

```
Project
    - Orchard
        - Modules
            - Orchard module 1
            - Orchard module 2
    - My other code 
```

我刚刚将果园文件复制到我的仓库，然后将我的模块添加为子仓库。

我希望能够做的是让 Orchard 的其余部分也成为一个子存储库。但是我找不到在另一个子仓库中拥有一个 suprepo 的方法。它不会是嵌套的子存储库，因为在两种情况下（果园和模块）都将是我的“基础”存储库。

即 Project/.hgsub 看起来像：

```
Orchard = http://path/to/orchard
Orchard/Modules/Module1 = http://path/to/module1
Orchard/Modules/Module2 = http://path/to/module2 
```

但这似乎不起作用，我找不到文档来说明我是否/如何做到这一点。

任何帮助表示赞赏！

**编辑：**如果不清楚我没有对 Orchard repo 的写访问权限，我也无法移动模块。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:24:28.910

刚刚测试了这个场景。

这是您需要做的。

将文件夹添加到 Orchard 存储库，其中“模块”作为文件夹（在其中放置至少一个文件）。使用 .hgsub (subrepos) 提交，现在应该添加 subrepos，拉取 subrepos 并更新它们在 .hgsubstate 中的引用。

如果您有任何问题，请分享。

# shell - 从命令行检查 GMAIL 中的电子邮件并将其保存为 PDF？

> ID：11399480
> 
> 赞同：1
> 
> 时间：2012-07-09T16:42:49.457
> 
> 标签：shell, pdf, curl, gmail

我想构建一个脚本，它基本上可以登录到 GMail，根据给定的标准检查某些邮件，将对话保存为我的本地计算机上的 PDF（或其他内容），然后注销。有没有人做过这样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T13:28:21.810

访问 gmail 服务取决于您选择的协议，即 pop 或 imap。在这里找到一个脚本来打开一个会话并访问您的邮箱： http: [//glaudiston.blogspot.fr/2011/08/gmail-acess-via-bash-imap.html](http://glaudiston.blogspot.fr/2011/08/gmail-acess-via-bash-imap.html)

另请注意，您的 gmail 帐户将其邮件作为 RSS 提要发布。查看最后一封未读的电子邮件（尽管这不是您想要做的）。

```
curl -u LOGIN:PASSWORD --silent "https://mail.google.com/mail/feed/atom"| perl -ne 'print "\t" if /<name>/; print "$2\n" if /<(title|name)>(.*)<\/\1>/;' 
```

下载电子邮件后，将它们导出为 pdf 非常简单：您应该在 linux 中找到许多包来执行此操作（在包管理器中搜索 pdf）。您也可以从 a2ps 开始。

# jquery - 通过 AJAX Post 将文件输入作为 FileReader 二进制数据发布

> ID：11399484
> 
> 赞同：26
> 
> 时间：2012-07-09T16:43:03.797
> 
> 标签：jquery, ajax, rest, filereader

我正在尝试通过 REST API 将上传到 HTML 文件输入的附件发布到网页。API 文档指出，该帖子是作为 HTTP 请求正文的直接二进制内容，而不是表单文件上传。

我的代码如下：

```
$('#_testButton').bind('click', function () {
    var file = document.getElementById('_testFile').files[0]
    var reader = new FileReader();
    reader.onload = function () {
        $.ajax({
            url: '/attachmentURL',
            type: 'POST',
            data: reader.result
        })
    }
    reader.readAsBinaryString(file)
}) 
```

我需要它适用于许多不同的 mimeType，所以我没有在上面的代码中声明它。但是，我尝试为 .doc 文件声明 contentType:'application/msword'，还尝试了 processData:false 和 contentType:false。

数据被发布在它应该发布的地方。但是，当我打开文件时，我收到一条消息，显示 mimeType:application/x-empty 带有一个空文件或一个带有一堆二进制字符的文件。我试过 .doc 文件和 pdf 文件，结果是一样的。

有谁知道我可以改变什么来完成这项工作？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-07-09T16:54:09.323

只需将`file`参考作为数据发送（使用`processData: false`）至少对我来说完成了这项工作：

```
$('#_testButton').bind('click', function () {
    var file = document.getElementById('_testFile').files[0];

    $.ajax({
        url: "/attachmentURL",
        type: "POST",
        data: file,
        processData: false
    });
}); 
```

它在这里描述：[https ://developer.mozilla.org/en/DOM/XMLHttpRequest/Sending_and_Receiving_Binary_Data#section_3](https://developer.mozilla.org/en/DOM/XMLHttpRequest/Sending_and_Receiving_Binary_Data#section_3)

发送字符串（即使该字符串表示二进制数据）将不起作用，因为浏览器将强制将其转换为 unicode 并按照[指定](http://www.w3.org/TR/XMLHttpRequest/#the-send-method)的方式编码为 utf-8，这将破坏二进制数据：

> 如果数据是一个字符串，让编码为 UTF-8。
> 
> 让 mime 类型为“text/plain;charset=UTF-8”。
> 
> 让请求实体主体为转换为 Unicode 并编码为 UTF-8 的数据。

发送`file`参考 ( `blob`) 将执行此操作：

> 如果数据是 Blob 如果对象的类型属性不是空字符串，则让 mime 类型为其值。
> 
> 让请求实体body为data表示的原始数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-05T11:28:38.557

变量文件；

```
 $('#_testFile').on("change", function (e) {
            file = e.target.files[0];
        });
        $('#_testButton').click(function () {
            var serverUrl = '/attachmentURL';

            $.ajax({
                type: "POST",
                beforeSend: function (request) {
                    request.setRequestHeader("Content-Type", file.type);
                },
                url: serverUrl,
                data: file,
                processData: false,
                contentType: false,
                success: function (data) {
                    console.log("File available at: ", data);
                },
                error: function (data) {
                    var obj = jQuery.parseJSON(data);
                    alert(obj.error);
                }
            });
        }); 
```

# jquery - Twitter Bootstrap：隐藏模式时重新加载页面不起作用

> ID：11399485
> 
> 赞同：0
> 
> 时间：2012-07-09T16:43:08.960
> 
> 标签：jquery, twitter-bootstrap, modal-dialog

我有一个表格，其中最后一个标签“td”调用了模态窗口。问题是仅在隐藏页面重新加载时适用于第一个模式窗口，但对于其他模式窗口重新加载不起作用。

```
<a class="icon-remove-sign" id="exclusao" href="#modalExclude{{janela.campanha.id}}" data-toggle="modal" title="Excluir"></a> 
// this generate the following urls:
// http://localhost:8000/display/detail/15/#modalExclude11
// http://localhost:8000/display/detail/15/#modalExclude12
// http://localhost:8000/display/detail/15/#modalExclude13 
```

jQuery 代码：

```
$(function() {
    $('#exclusao').click(function() {
        var modal = $(this).attr('href');
        console.log(modal); // show the href only for the first row --> #modalExclude11
        // show modal
        $(modal).modal({
            show: false,
        });
        // clean message info in modal
        $('div#messageExclude').html('');
        // reload page when modal is hidden
        $(modal).on('hidden', function() {
            window.location.reload(true) // work only for the first row --> #modalExclude11
        });

    });
}); 
```

所有模式都正确显示，但只会使页面重新加载到表格的第一行。有谁知道可以是什么？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T18:18:32.020

问题是ID：

```
<a class="icon-remove-sign" id="exclusao" href="#modalExclude{{janela.campanha.id}}" data-toggle="modal" title="Excluir"></a> 
```

需要使用 CLASS，我忘记了 ID 在代码中必须是唯一的，但是使用类是有效的。

```
class="icon-remove-sign" 
```

谢谢！

# android - 在android中动态改变列表视图t

> ID：11399487
> 
> 赞同：-1
> 
> 时间：2012-07-09T16:43:17.197
> 
> 标签：android

在我的应用程序中，我实时获得了一些细节，我想用 onclick 监听器在 LIstview 中显示它们。我知道如何只放置列表视图，但我不知道如何提供 Oncliklister 用于动态更改视图。

任何人都可以提供一些关于相同的见解..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:50:59.720

ListView 有一个 setOnItemClickListener() 方法，可以让您设置一个侦听器，以便在单击列表中的项目时获取回调。

```
ListView list = (ListView) findViewById(R.id.listview);
list.setOnItemClickListener(new AdapterView.onItemClickListener() {
   @Override
   public void onItemClick(AdapterView<?> adapter, View view, int position, long arg) {
      Object listItem = list.getItemAtPosition(position);
      //Do what you want with the listItem
   } 
}); 
```

# python - wxpython中的事件处理

> ID：11399489
> 
> 赞同：0
> 
> 时间：2012-07-09T16:43:23.890
> 
> 标签：python, events, wxpython, wxwidgets

在 wxpython 中，最好是通过为每个事件处理程序创建一个单独的函数（例如为每个按钮单击一个单独的函数）来处理事件，还是创建一个大的 button_handler，然后确定从那里单击的按钮？

基本上，我想知道为每个单独的事物监视许多不同的事件是否会占用更多资源，或者只是一个大事件会确定在触发时单击了哪个事件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:52:12.283

别担心。这两种方案所需的资源都是微不足道的，尤其是在 python 脚本中。专注于以最容易理解和维护的方式设计代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T17:14:07.883

资源强度在这里不是您的问题，但您肯定希望为此使用一个大事件循环。由于全局解释器锁，python 中的许多事件处理程序都有处理事件队列的烦人方式，并且在某些事件处理程序中，如果不从堆栈中删除它甚至可能无法检查事件（例如 VPython），等等在这些情况下，如果您在代码中使用多项检查，您很可能会遇到奇怪且难以跟踪的错误。如果您使用一个大型事件，这将不会发生，或者如果发生，将更容易追踪。

Ravenspoint 是正确的，因为这两种方法的资源强度都是微不足道的，仅基于资源强度你不应该担心它，但是单个事件循环更容易维护。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T19:10:57.477

如果我有三个按钮做完全不同的事情，那么我需要为它们提供不同的事件处理程序，因为我发现这更容易调试。如果它们都是应用了略微不同格式选项的打印按钮，那么我会将它们全部连接到同一个处理程序并使用 event.GetEventObject() 来确定调用了哪个。我有几次由同一个处理程序处理多个事件是当我有一个工具栏按钮和一个菜单项都调用相同的东西时。它更多地与程序流程和易于调试有关，而这只是随着实践而来的。

# java - 从没有 TimeZone 名称的 TimeZone 获取 TimeZone 偏移值

> ID：11399491
> 
> 赞同：60
> 
> 时间：2012-07-09T16:43:24.703
> 
> 标签：java, timezone

我需要以 [+/-]hh:mm 格式保存手机的时区

我正在使用 TimeZone 类来处理这个问题，但我能得到的唯一格式如下：

```
PST -05:00
GMT +02:00 
```

我宁愿不对结果进行子串化，是否有任何键或选项标志我可以设置为仅获取值而不是该时区的名称（GMT/CET/PST ...）？

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2012-07-09T16:46:00.707

> 我需要以 [+/-]hh:mm 格式保存手机的时区

不，你没有。单独的偏移量是不够的，您需要存储整个时区名称/id。例如，我住在奥斯陆，我当前的偏移量是 +02:00，但在冬天（由于[dst](/questions/tagged/dst "显示标记为“dst”的问题")）它是 +01:00。标准时间和夏季时间之间的确切切换取决于您不想探索的因素。

所以不是存储`+ 02:00`（或者应该是`+ 01:00`？）我存储`"Europe/Oslo"`在我的数据库中。现在我可以使用以下命令恢复完整配置：

```
TimeZone tz = TimeZone.getTimeZone("Europe/Oslo") 
```

想知道我今天的时区偏移量是多少？

```
tz.getOffset(new Date().getTime()) / 1000 / 60   //yields +120 minutes 
```

然而在 12 月也是如此：

```
Calendar christmas = new GregorianCalendar(2012, DECEMBER, 25);
tz.getOffset(christmas.getTimeInMillis()) / 1000 / 60   //yields +60 minutes 
```

说得够多了：存储时区名称或 ID，每次要显示日期时，检查当前偏移量（今天）是多少，而不是存储固定值。您可以使用[`TimeZone.getAvailableIDs()`](http://docs.oracle.com/javase/7/docs/api/java/util/TimeZone.html#getAvailableIDs())枚举所有支持的时区 ID。

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2013-05-21T22:53:10.200

@MrBean - 我处于类似的情况，我必须调用第 3 方 Web 服务并以 +/-hh:mm 格式传递 Android 设备的当前时区偏移量。这是我的解决方案：

```
public static String getCurrentTimezoneOffset() {

    TimeZone tz = TimeZone.getDefault();  
    Calendar cal = GregorianCalendar.getInstance(tz);
    int offsetInMillis = tz.getOffset(cal.getTimeInMillis());

    String offset = String.format("%02d:%02d", Math.abs(offsetInMillis / 3600000), Math.abs((offsetInMillis / 60000) % 60));
    offset = (offsetInMillis >= 0 ? "+" : "-") + offset;

    return offset;
} 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2017-12-07T18:50:52.843

现在有了java8，你可以使用

```
Integer offset  = ZonedDateTime.now().getOffset().getTotalSeconds(); 
```

获取与 UTC 的当前系统时间偏移量。然后，您可以将其转换为您想要的任何格式。发现它对我的情况很有用。示例：[https ://docs.oracle.com/javase/tutorial/datetime/iso/timezones.html](https://docs.oracle.com/javase/tutorial/datetime/iso/timezones.html)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2019-09-16T09:14:52.077

使用 Java 8，您可以通过以下代码实现此目的。

```
 TimeZone tz = TimeZone.getDefault();
    String offsetId = tz.toZoneId().getRules().getStandardOffset(Instant.now()).getId(); 
```

并且`offsetId`将类似于 +01:00

请注意该函数`getStandardOffset`需要一个`Instant`作为参数。这是您要检查给定时区偏移量的特定时间点，因为时区的偏移量可能会**在 time 期间发生变化**。由于某些地区有**夏令时**。

我认为这就是为什么@Tomasz Nurkiewicz 建议不要直接以带*符号的小时格式*存储偏移量，而是在每次需要时检查偏移量的原因。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2018-06-29T15:54:28.797

```
ZoneId here = ZoneId.of("Europe/Kiev");
ZonedDateTime hereAndNow = Instant.now().atZone(here);
String.format("%tz", hereAndNow); 
```

会给你一个标准化的字符串表示，比如“+0300”

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2018-11-20T10:07:33.143

我们可以很容易地得到 a 的毫秒偏移量，`TimeZone`只需要一个`TimeZone`实例和`System.currentTimeMillis()`。`TimeUnit`然后我们可以使用该类从毫秒转换为任何选择的时间单位。

像这样：

```
public static int getOffsetHours(TimeZone timeZone) {
    return (int) TimeUnit.MILLISECONDS.toHours(timeZone.getOffset(System.currentTimeMillis()));
} 
```

*或者，如果您更喜欢新的 Java 8 时间 API*

```
public static ZoneOffset getOffset(TimeZone timeZone) { //for using ZoneOffsett class
    ZoneId zi = timeZone.toZoneId();
    ZoneRules zr = zi.getRules();
    return zr.getOffset(LocalDateTime.now());
}

public static int getOffsetHours(TimeZone timeZone) { //just hour offset
    ZoneOffset zo = getOffset(timeZone);
    TimeUnit.SECONDS.toHours(zo.getTotalSeconds());
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2021-05-05T22:18:40.793

# *`java.time`：现代日期时间 API*

您可以使用[`ZonedDateTime#getOffset`](https://docs.oracle.com/javase/8/docs/api/java/time/ZonedDateTime.html#getOffset--).

请注意，观察[DST](https://en.wikipedia.org/wiki/Daylight_saving_time)的时区的偏移量会根据 DST的变化而变化。对于其他地方（例如印度），它保持不变。因此，建议提及显示时区偏移量的时刻。提到了一个时刻`Instant.now()`，它表示 UTC 中的日期时间（由`Z`它表示代表 Zulu 并指定`+00:00`小时的时区偏移量）。

**显示返回的所有时区的偏移量`ZoneId.getAvailableZoneIds()`：**

```
import java.time.Instant;
import java.time.ZoneId;
import java.time.ZonedDateTime;

public class Main {
    public static void main(String[] args) {
        // Test
        Instant instant = Instant.now();
        System.out.println("Timezone offset at " + instant);
        System.out.println("==============================================");
        ZoneId.getAvailableZoneIds()
            .stream()
            .sorted()
            .forEach(strZoneId -> System.out.printf("%-35s: %-6s%n",
                strZoneId, getTzOffsetString(ZoneId.of(strZoneId), instant)));
    }

    static String getTzOffsetString(ZoneId zoneId, Instant instant) {
        return ZonedDateTime.ofInstant(instant, zoneId).getOffset().toString();
    }
} 
```

**输出：**

```
Timezone offset at 2021-05-05T21:45:34.150901Z
==============================================
Africa/Abidjan                     : Z     
Africa/Accra                       : Z     
Africa/Addis_Ababa                 : +03:00
...
...
...    
W-SU                               : +03:00
WET                                : +01:00
Zulu                               : Z 
```

从**[Trail: Date Time](https://docs.oracle.com/javase/tutorial/datetime/index.html)**了解有关[现代日期时间 API](https://www.oracle.com/technical-resources/articles/java/jf14-date-time.html) ^*的更多信息。

* * *

^(* 出于任何原因，如果您必须坚持使用 Java 6 或 Java 7，则可以使用[***ThreeTen-Backport，***](http://www.threeten.org/threetenbp/)它将大部分*java.time*功能向后移植到 Java 6 和 7。如果您正在为 Android 项目和 Android API 工作level 仍然不符合 Java-8，请检查[Java 8+ APIs available through desugaring](https://developer.android.com/studio/write/java8-support-table)和[How to use ThreeTenABP in Android Project](https://stackoverflow.com/questions/38922754/how-to-use-threetenabp-in-android-project)。)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-04-10T15:21:42.123

我知道这是旧的，但我想我会给出我的意见。我必须为工作中的一个项目这样做，这就是我的解决方案。

我有一个 Building 对象，其中包含使用 TimeZone 类的时区，并希望在新类中创建 zoneId 和 offset 字段。

所以我所做的是创建：

```
private String timeZoneId;
private String timeZoneOffset; 
```

然后在构造函数中，我传入了 Building 对象并像这样设置这些字段：

```
this.timeZoneId = building.getTimeZone().getID();
this.timeZoneOffset = building.getTimeZone().toZoneId().getId(); 
```

所以 timeZoneId 可能等于“EST”之类的东西，而 timeZoneOffset 可能等于“-05:00”之类的东西

我不想你可能不会

# reporting-services - SSRS 报告要求提供凭证

> ID：11399497
> 
> 赞同：2
> 
> 时间：2012-07-09T16:43:47.027
> 
> 标签：reporting-services

我在报告服务器上设置了报告。并从 mvc.net 通过 javascript。我正在使用以下代码打开报告：

```
function ShowSnapShot() {
    window.open("http://ServerName/ReportingServerName/Pages/ReportViewer.aspx?%2fFolderName%2fSubFolderName%2fReportName&rs:Command=Render&Parameter=003532");    
} 
```

每当我打开报告时，它都会要求提供凭据。我如何通过 url 传递凭据，或者有什么方法可以在不使用 Report Viewer 的情况下打开报告？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T00:43:29.490

确保打开此报表的用户对报表服务器上的报表/文件夹具有*浏览权限。*

此外，检查报告使用的数据源上的凭据。您可能需要选择*安全存储在报表服务器中的凭据*。

# symfony - Symfony2 和表单主题/自定义（必需/帮助/错误）

> ID：11399501
> 
> 赞同：5
> 
> 时间：2012-07-09T16:43:56.647
> 
> 标签：symfony, twig, theming, formbuilder

也许我忽略了一些东西，希望这很容易完成。

我有一个表格，我最终想要的是以下结果：

字段：

*   是强制性的/必需的
*   当前有错误
*   有帮助

应该在标签和一个额外的 div 之后获得一个额外的`a`-Tag，如果适用，则填充帮助和/或错误。

我要做的是，必填字段`a`通过使用以下方式获取 -Tag：

```
{% use 'form_div_layout.html.twig' with field_label as base_field_label %}

{% block field_label %}
    {{ block('base_field_label') }}

    {% if required %}
        <a href=""><span>&nbsp;</span></a>
    {% endif %}
{% endblock %} 
```

所以，我已经尝试过的是这个的不同版本：

```
{% use 'form_div_layout.html.twig' with field_label as base_field_label %}

{% block field_label %}
    {{ block('base_field_label') }}

    {% if required or help is defined %}
        <a href=""><span>&nbsp;</span></a>
    {% endif %}
{% endblock %}

{% block field_row %}
    {% spaceless %}
        <div class="row">
            {% if required or help is defined %}
                <div>
                    {{ form_errors(form) }}
                    {{ help }}
                </div>
            {% endif %}

            {{ form_label(form) }}
            {{ form_widget(form, { 'attr': {'class': 'grid_4'} }) }}
        </div>          
    {% endspaceless %}
{% endblock field_row %} 
```

我无法让它工作。

所以我的问题是：

*   我从哪里获得帮助文本，它也可以包含 HTML？我在`form builder`没有成功的情况下尝试了这个 - 但至少有一个例外：

    ```
    $builder    ->add('subject', 'text', array(
        'label' => 'Subject',
        'help' => 'Can be formatted content with <strong>HTML-Elements</strong>',
        )); 
    ```

*   如何判断当前字段有错误（将类添加到行），如果有，也显示它？`{{ form_errors(form) }}`没有输出任何东西，无论我把它放在 `field_row˚.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-13T07:43:08.600

没有帮助文本，您必须为字段创建表单扩展并将其添加到默认选项。

SF 2.1 Beta 1 中的示例：

```
namespace Webility\Bundle\WebilityBundle\Form\Extension;

use Symfony\Component\Form\FormInterface;
use Symfony\Component\Form\FormViewInterface;
use Symfony\Component\Form\FormBuilderInterface;
use Symfony\Component\Form\AbstractTypeExtension;
use Symfony\Component\OptionsResolver\OptionsResolverInterface;

class HelpFormTypeExtension extends AbstractTypeExtension
{

    public function buildView(FormViewInterface $view, FormInterface $form, array $options){
        $view->setVar('help', $options['help']);
    }

    public function getExtendedType(){
        return 'field';
    }

    public function setDefaultOptions(OptionsResolverInterface $resolver) {
        $resolver->setDefaults(array(
            'help' => null
        ));
    }
} 
```

并将其注册为服务：

```
<service id="webility.form.extension.help" class="Webility\Bundle\WebilityBundle\Form\Extension\HelpFormTypeExtension">
        <tag name="form.type_extension" alias="field" />
</service> 
```

对于错误问题：您是否有任何错误要打印？如果验证失败，请在控制器中检查：

```
echo '<pre>'; print_r( $form->getErrorsAsString() ); echo '</pre>'; exit; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T08:41:42.947

[如我的问题Maciej Pyszyński's anwser](https://stackoverflow.com/a/11466202/1456376)中所述解决它非常有帮助。

在这种情况下，我以另一种方式解决了它，我也想在这里发布。根据手册[“添加“帮助”消息”](http://symfony.com/doc/current/cookbook/form/form_customization.html#adding-help-messages)，我构建了这个：

**注意**此解决方案不能与 twig 一起使用`formbuilder`，需要在 twig 中进行一些调整。

### 获取帮助 ''-tags（实际上它们现在是 div）......</h3>

```
{% block field_label %}
    {{ block('base_field_label') }}

    {% if attr.class is defined and '_hint' == attr.class %}
        <div>
            <a><span class="help">Help Icon</span></a>
            <div class="tooltip">
                {% if help is defined %}
                    {{ help|raw }}
                {% else %}
                    Somebody forgot to insert the help message
                {% endif %}
            </div>
        </div>
    {% endif %}
{% endblock %} 
```

### 在错误中获得正确的类

```
{% block field_row %}
    {% spaceless %}
        <div class="row{% if form_errors(form) %} error{% endif %}">
            {{ form_label(form) }}
            {{ form_widget(form, { 'attr': {'class': 'grid_4'} }) }}
        </div>
    {% endspaceless %}
{% endblock field_row %} 
```

### 以及来自模板的调用

```
<div class="row{% if form_errors(form.url) %} _error{% endif %}">
    {{ form_label(form.field, null, { 'attr': {'class': '_hint'}, 'help': 'Help text or variable containing it' }) }}
    {{ form_widget(form.field, { 'attr': {'class': 'grid_4'} }) }}
</div> 
```

# php - 处理自定义 cms 的图像、视频、文档

> ID：11399507
> 
> 赞同：0
> 
> 时间：2012-07-09T16:44:13.050
> 
> 标签：php, image, content-management-system, assets, concept

我正在使用 php 构建 CMS，但是我正在努力处理如何处理动态页面可以提供的各种不同资产，通常一个平均页面将包含各种尺寸的图片（拇指、正文、主要等） 、内嵌图像和各种不同的资产（pdf、flv、mp4、doc 等）。

目前用户可以上传资产并在服务器上创建文件夹，我只是想要一些关于如何在删除、编辑和链接到 cms 中的动态页面方面进行管理的技术和概念？我已经有一个包含所有内容（meta_stuff、title、friendly_url、content_text 等）的内容表。

上传时是否应该将参考存储在资产表中的某处？是否应该将所有资产路径（图像、文档、视频等）存储在一个表中？还是为每个资产分开？是否应该将多个图像尺寸（小、中、大等）存储在不同的字段中，例如（assetid、smallpath、mediumpath、largepath？使用什么技术将资产链接到动态页面？这应该是一个连接表还是单个？如何我是否要为一个页面检索多个 pdf 和多个图像的不同资产？如何处理资产的删除，因为这可以引用到另一个动态页面？以及您认为有什么其他好处？

感谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:07:17.607

在类似于您所描述的场景中处理资源（视频、图像、文档......）时，请记住以下一些基本事项。

你想要知道上传的是**什么**，上传的是**什么类型**的东西以及上传的是**谁**。为此，最好有以下表格：

**编辑：**对不起这个错误，`asset_types.asset_type_id`应该链接到`assets.asset_type_id`而不是`assesst.asset_id`

![在此处输入图像描述](../Images/4d0038645473baf68b3bc8a922166da5.png)
（注意：这只是一个大纲，当然你会有更多的字段）
这个模型可以很容易地完成以下任务

*   上传：上传内容后，将其存储在某个位置（使用正确的 `.htaccess`配置），然后将该路径存储在表中。
*   删除：当用户试图删除某些东西时，你检查他是否是所有者。
*   当你想添加一个新类型时，你不需要创建一个新表。

希望这将使您朝着正确的方向前进。

**更新**：回答您的评论，例如，当用户想要将图像添加到文章中时，您有两个选择：

1.  用户会看到一个按钮/选择菜单/选择所需图像的任何内容，一旦单击它将添加`<img src=LINK_TO_RESOURCE" />`到内容的正文中（确保您保护自己免受 XSS 攻击）。

    或者

2.  您使用自己的简单标记，当用户单击图像时，这`[[PREFIX_IMG:IMG_ID]]`将被添加到内容的正文中，当查看内容时，您将`<img src="LINK_TO_RESOURCE" />`使用`IMG_ID`.

**第二次更新**：嗯，你有几个选项来处理不直接嵌入“文章”本身的资源。

1.  例如，您可以在“文章”表中拥有一个可以调用的字段`summary`，并在表中再添加一个列`assets`，您可以调用它`asset_sub_type`并具有不同的类型，例如`summary`. 然后，当您想查看摘要时，您从数据库中获取摘要文本/标题并将资源添加到其中。

2.  （这是我使用的技术）当从数据库中获取摘要时，我看到哪个图像是与该文章相关的数据库，并使用 PHP 动态调整它的大小并将其附加到摘要中。

# web-services - 从移动应用程序调用哪种 Web 服务（REST 或 SOAP）更有效

> ID：11399511
> 
> 赞同：1
> 
> 时间：2012-07-09T16:44:28.007
> 
> 标签：web-services, rest, soap

我必须开发一个移动应用程序，我想知道是否有一个 Web 服务框架可以使开发更容易，并提供可扩展性、安全性和更快的解析消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T17:03:37.507

在性能和网络传输方面，由于 SOAP 的大小和复杂的 XML 解析，Web Service 可能是效率最低的方法。如果您愿意使用 AMF，根据我的经验，它是最有效的实施方式。有许多服务器端支持，包括 Java、.NET、php、ruby 等。

[您可以通过此博客](http://www.jamesward.com/2007/12/12/blazebench-why-you-want-amf-and-blazeds/)查看不同技术的性能比较，并且可以在[此处](http://www.btconsulting.ch/technology/page3/)找到 AMF 的 iOS 实现。

简而言之，这是我对众多客户端-服务器通信的看法：

### 网络服务 (SOAP)

*   优点：强类型，冗长，支持复杂的数据类型，支持许多服务器平台。大多数客户端都会有某种内置支持
*   缺点：体积非常庞大，不利于网络传输，复杂的 XML 结构会影响应用程序的性能。

### 宁静的 XML

*   优点：如果设计正确，与 SOAP 相比，XML 易于理解，尺寸更小
*   缺点：不是强类型。您必须编写自己的 XML 解析器来将数据解析为强类型对象。XML 解析通常是缓慢且低效的。

### JSON

*   优点：易于理解，结构更紧凑。
*   缺点：不是强类型。无法支持引用的数据。例如，如果您返回十个在其属性中引用同一父级的子级，那么您最终将拥有同一父级的十个副本。

### AMF

*   优点：二进制数据格式、强类型、小网络占用以及极快的序列化和反序列化
*   缺点：没有那么广为人知。

# php - 为移动应用程序组织 Web 服务

> ID：11399513
> 
> 赞同：0
> 
> 时间：2012-07-09T16:44:35.977
> 
> 标签：php, actionscript-3, flex4

**背景**

我为我的公司编写了一个内部使用的 Playbook 应用程序，用户可以在其中登录并从我们的数据库中收集某些信息集。但是，并非所有用户都请求相同的信息。

该应用程序是在 Adob​​e AIR 框架中作为前端编写的，我使用 PHP/MSSQL 作为后端。

到目前为止，我已经在我们的内部网络服务器上按照以下层次结构组织了 PHP 脚本：

```
// Contains class whose constructor connects to our database
// and every method is a seperate query
./MyApp/liveScripts/service/Connection.php

// These are example php files that take POST inputs and executes the query
./MyApp/liveScripts/service/getDataX.php
./MyApp/liveScripts/service/getDataY.php
./MyApp/liveScripts/service/getDataZ.php 
```

每个查询都以 XML 格式返回数据，供我的应用程序读取然后显示。

**问题**

起初我只有几个特殊查询，但现在我面临大约 40 多个独特的查询，并且连接类因大量独特的方法而膨胀。

此外，我发现自己创建了很多单独的 php 文件来执行这些查询，感觉效率很低。这是我 90% 的 php 文件的样子：

```
<?php

include("Connection.php");

$userid = $_POST['userid'];
$fooid = $_POST['fooid'];
$barid= $_POST['barid'];
$service = new Connection();

echo $service->getDataX($userid, $fooid, $barid);

?> 
```

**问题**

我的问题是，根据您的经验，当有很多独特的查询需要处理时，组织 PHP 脚本的最佳方式是什么？是否有一个 Connection 类将每个单独的查询存储为一个单独的方法，并且每个方法都有一个唯一的 PHP 文件是一个可行的解决方案？

我试过用谷歌搜索其他解决方案和层次结构，但还没有遇到任何问题。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T19:16:59.487

也许尝试通过将变量字符串传递给返回结果的新方法来动态创建查询。我个人从未将 PHP/MSSQL 用于 PlayBook 应用程序，但这就是我开始寻找的地方。

# android - Android：如何在振动设置之间切换（始终、从不、仅在静音模式下、仅在不处于静音模式时）？重访

> ID：11399516
> 
> 赞同：4
> 
> 时间：2012-07-09T16:44:46.103
> 
> 标签：android, settings, vibration

**问题**

寻找在以下之间切换的方法：

*   总是
*   绝不
*   仅在静音模式下
*   仅在未处于静音模式时

这些选项可通过手机上的路径 --- 菜单 >> 设置 >> 声音 >> 振动 --- 找到。

通过手机上的导航进行更改很简单（顺便说一下，我的手机是带有 Android 2.3.3 的 Motorola Atrix 2），但我还没有遇到在我的代码中使用的方法。

**代码**

我基本上有按钮可以在单击时操纵振动设置。此处显示了这些按钮之一：

```
 bSilent.setOnClickListener(new View.OnClickListener() 
    {
        public void onClick(View v) 
        {
            audioManager.setRingerMode(AudioManager.RINGER_MODE_SILENT);
            audioManager.setVibrateSetting(AudioManager.VIBRATE_TYPE_RINGER, AudioManager.VIBRATE_SETTING_OFF);
            audioManager.setVibrateSetting(AudioManager.VIBRATE_TYPE_NOTIFICATION, AudioManager.VIBRATE_SETTING_OFF);

            Toast.makeText(getBaseContext(), "Set to Never", Toast.LENGTH_SHORT).show();
        }
    }); 
```

audioManager 在此代码上方的某处定义为：

```
final AudioManager audioManager = (AudioManager) this.getSystemService(Context.AUDIO_SERVICE); 
```

Android 提供了 AudioManager.setVibrateSetting，但现在已弃用。相反，它们将您引用到 getRingerMode 方法。

[http://developer.android.com/reference/android/media/AudioManager.html](http://developer.android.com/reference/android/media/AudioManager.html)

但是，使用这些功能（以及它们的任意组合）不能有效地在四种振动设置之间移动。例如，如果我从“始终”开始，我似乎不可能到达“从不”。振动方法的所有组合只会在“始终”和“仅在静音模式”之间移动。另一方面，如果我从“从不”开始，所提供的方法只会在“从不”和“仅在不处于静音模式时”之间切换。

因此，假设我想让我的手机处于静音模式并让它振动。然后，我决定不再希望它振动。我无法从“始终”或“仅在静音模式”切换到“从不”。

**过去的解决方案和帖子**

我知道这有点像 StackOverflow 上的重复帖子。这个问题之前提过。。。

此处：[Android 2.2 上的振动设置](https://stackoverflow.com/questions/3742323/vibrate-settings-on-android-2-2)

并且（最近）在这里：[更改振动设置](https://stackoverflow.com/questions/11264550/changing-vibrate-setting)

前者的链接提供了一个“答案”。LuTHieR 最终参与了讨论，最终自己想出了一个办法。他引用了该网站：

[https://android.googlesource.com/platform/packages/apps/Settings/+/froyo-release/src/com/android/settings/SoundSettings.java](https://android.googlesource.com/platform/packages/apps/Settings/+/froyo-release/src/com/android/settings/SoundSettings.java)

并说“我查看了 com.android.settings.Settings 类的源代码并复制了部分启用和禁用振动的方法”。

我用力地浏览了这个网站，找不到他做了什么。谁能澄清他的解决方案？

**问题**

有没有人可以在“始终”、“从不”、“仅在静音模式”和“仅在不处于静音模式时”之间精确切换？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-26T18:44:44.243

我的解决方案（具有所需振动模式的收入函数的路径`String sParam`，如果需要重构为整数0-3）：

```
AudioManager audioManager = getSystemService( Context.AUDIO_SERVICE);

if( Build.VERSION.SDK_INT < 16)
{
    // sParam may be:
    // 0 - Always
    // 1 - Never
    // 2 - Only in silent mode (when sound is off)
    // 3 - Only when not in silent mode (when sound is on)

    if( (sParam.equals( "1") == true) || (sParam.equals( "3") == true))
    {
        Settings.System.putInt( Static.contextApplication.getContentResolver(), "vibrate_in_silent", 0);
        if( sParam.equals( "1") == true) 
            audioManager.setVibrateSetting( AudioManager.VIBRATE_TYPE_RINGER, AudioManager.VIBRATE_SETTING_OFF);

        if( sParam.equals( "3") == true)  
            audioManager.setVibrateSetting( AudioManager.VIBRATE_TYPE_RINGER, AudioManager.VIBRATE_SETTING_ON);
    }

    if( (sParam.equals( "0") == true) || (sParam.equals( "2") == true))
    {
        Settings.System.putInt( Static.contextApplication.getContentResolver(), "vibrate_in_silent", 1);
        if( sParam.equals( "0") == true)  
            audioManager.setVibrateSetting( AudioManager.VIBRATE_TYPE_RINGER, AudioManager.VIBRATE_SETTING_ON);
        if( sParam.equals( "2") == true)  
            audioManager.setVibrateSetting( AudioManager.VIBRATE_TYPE_RINGER, AudioManager.VIBRATE_SETTING_ONLY_SILENT);
    }
}
// else (for new SDK > 16 via setRingerMode() ??? ) 
```

# jquery - 垂直居中的jquery wmu滑块

> ID：11399518
> 
> 赞同：0
> 
> 时间：2012-07-09T16:44:52.440
> 
> 标签：jquery, css, slider, positioning

我已经设置了一个滑块，我很难让图像全屏显示而不会溢出，以及保持它垂直居中并将导航点保持在屏幕的最底部。

我能得到的任何帮助将不胜感激。

这是网站网址：

[http://www.klossal.com/js/wmuSlider/demo/demo3.html](http://www.klossal.com/js/wmuSlider/demo/demo3.html)

这是代码，

HTML：

```
<div style="top:50%;">

<div class="wmuSlider example1">
<div class="wmuSliderWrapper" style="height:100%;">
<article>
<img width="612" height="612" src="http://www.klossal.com/portfolio/space_1_header.png"  
/>
</article>
<article>
<img width="612" height="612" src="http://www.klossal.com/portfolio/space_2_header.png" 
/>
</article>
<article>
<img width="612" height="612"     
src="http://farm6.static.flickr.com/5201/5296457034_5688b25c15_z.jpg" />
</article>
<article>
<img width="612" height="612"    
src="http://farm6.static.flickr.com/5245/5291874922_35ca47cc3d_z.jpg" />
</article>
</div>
</div>

</div>
<script>
    $('.example1').wmuSlider({
        touch: Modernizr.touch,
        animation: 'slide',
        slideshow: false
    });
</script> 
```

和 CSS：

```
/* Demo */
.wmuSlider,
.wmuGallery {
margin-bottom: 20px;
}

/* mwuSlider */
.wmuSlider {
position: relative;
overflow: hidden;
}
.wmuSlider .wmuSliderWrapper {
display: none;
}
.wmuSlider .wmuSliderWrapper article {
position: relative;
text-align: center;
}
.wmuSlider .wmuSliderWrapper article img {
max-width: 100%;
height: auto;
}

/* mwuGallery */
.wmuGallery .wmuGalleryImage {
position: relative;
text-align: center;
}
.wmuGallery .wmuGalleryImage img {
max-width: 100%;
height: 100%;
}

/* Default Skin */
.wmuGallery .wmuGalleryImage {
margin-bottom: 10px;
}
 .wmuSliderPrev, .wmuSliderNext {
position: absolute;
width: 40px;
height: 80px;
text-indent: -9999px;
background: url(http://klossal.com/js/wmuSlider/demo/images/sprites.png) no-repeat 0 0;
top: 50%;
margin-top: -40px;
z-index: 2;
}
.wmuSliderPrev {
background-position: 100% 0;
left: 20px;
}
.wmuSliderNext {
right: 20px;
}
.wmuSliderPagination {
z-index: 2;
position: absolute;
left: 50%;
bottom: 0px;
}
.wmuSliderPagination li {
float: left;
margin: 0 5px 0 0;
list-style-type: none;
}
.wmuSliderPagination a {
display: block;
text-indent: -9999px;
width: 10px;
height: 10px;
background: url(http://klossal.com/js/wmuSlider/demo/images/sprites.png) no-repeat 0   
-80px;
}
.wmuSliderPagination a.wmuActive {
background-position: -10px -80px;
}

body{
background:#141414;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T17:04:51.720

Here's the run down

You have a container -- `<div class="wmuSlider">` -- this container has a height of `612px`

Then you have a wrapper for your slider images -- `<div class="wmuSliderWrapper">` -- this element has a height set to 100%. That means it will use the height of the page wrapper -- `<div class="wmuSlider">` -- which is 612px.

So we have no spacing at all yet, we're bound to the exact dimensions of our wrapper. Let's go on.

You have `<article>`'s, and each `<article>` has an `<img>` -- these images have a height of - you guessed it - `612px`.

So the images are going to be the same height as all containers around it.

Finally we have `<ul class="wmuSliderPagination">`. This element is positioned at the bottom of the element `<div class="wmuSliderWrapper">`. However, because the image has the same height as the wrapper, the `<ul class="wmuSliderPagination">` will have any image that spans the full `612px` sit beneath it, as per your `z-index:2`.

If we want to change this, so that the pagination doesn't have any issues, we can do a few things.

We can change the height of the `<div class="wmuSliderWrapper">` from `100%` to `98%` and add `overflow:hidden;`, such as->

```
.wmuSliderWrapper{
  height:98%;
  overflow:hidden;
} 
```

However, this will cut off the bottom of the image, we may not want to do that. Instead, we can change the overall height of the `<div class="wmuSlider">`, and set the height of the `<div class="wmuSliderWapper">` to a fixed height.

```
.wmuSlider{
  height:632px; //20px is the average line-height of a single element
}
.wmuSliderWrapper{
  height:612px;//give 20pxs of room for the pagination wrapper
} 
```

Your `<img>`'s have hard coded width's and height, so with the above solution, you should never run into that problem again; HOWEVER, if the images vary in height at some point, you would need to include

```
.wmuSliderWrapper{
  height:612px;
  overflow:hidden; // stop any element that has dimensions larger than the container from overflowing
} 
```

# ios - 修改低、中、高频核心音频IOS

> ID：11399522
> 
> 赞同：1
> 
> 时间：2012-07-09T16:45:00.687
> 
> 标签：ios, core-audio

我看到iOS上唯一的效果器是ipod EQ。有没有其他方法可以改变 iOS 上音频单元的高频、中频和低频？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T20:14:54.513

不幸的是，iPhone 并没有真正允许自定义音频单元（即音频单元的 ID 不能注册以供 AUGraph 使用）。您可以做的是注册一个渲染回调并自己处理原始 PCM 数据。像 musicdsp.org 这样的网站有示例 DSP 代码，您可以利用这些代码来实现您可以想象的任何效果。

另外，这里有一个类似的 StackOverflow 问题供参考：[How to make a simple EQ AudioUnit](https://stackoverflow.com/questions/4029079/how-to-make-a-simple-eq-audiounit-bass-mid-treble-with-ios)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T05:03:41.167

有一堆内置的音频单元，包括一组滤波器、延迟甚至混响。一个很好的线索是查看 AUComponent.h。您需要正确设置他们的 ABSD，否则他们会抛出错误或产生静音。但他们确实有效。

# unix - Unix egrep 查看文件夹信息？

> ID：11399525
> 
> 赞同：0
> 
> 时间：2012-07-09T16:45:06.630
> 
> 标签：unix, grep

我有一个简单的 egrep 命令，它在当前目录中的所有文件中搜索包含单词“error”的行：

```
egrep -i "error" * 
```

该命令也将通过子目录。以下是整个文件夹的示例：

```
/Logfile_20120630_030000_ID1.log
/Logfile_20120630_030001_ID2.log
/Logfile_20120630_030005_ID3.log
/subfolder/Logfile_20120630_031000_Errors_A3.log
/subfolder/Logfile_20120630_031001_Errors_A3.log
/subfolder/Logfile_20120630_031002_Errors_A3.log
/subfolder/Logfile_20120630_031003_Errors_A3.log 
```

顶层目录的日志文件包含“错误”行。但是“子文件夹”目录中的日志文件不包含带有“错误”的行。（仅在文件名中）

所以我遇到的问题是 egrep 命令似乎正在查看“子文件夹”中的信息。我的结果得到了一大块似乎是二进制块的内容，然后是顶部文件夹日志文件中包含“错误”一词的文本行。

如果我删除了“子文件夹”下的所有文件，但没有删除文件夹本身，我会得到完全相同的结果。

那么Unix是否将文件历史信息保存在文件夹中？

问题已通过运行得到纠正： find 。-类型 f | egrep -i "错误" *

但我仍然不明白为什么这是一个问题。我在 SunOS 上运行 C-shell。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T12:51:54.963

```
egrep -i error * 
```

元`*`字符匹配任何文件名。目录也是文件。 `*`由 shell 扩展为当前目录中的所有文件，这通常称为 globbing。

```
set noglob 
```

关闭该行为。但是，您的目录中不太可能存在已命名`*`的文件，因此在此示例中，该命令将找不到任何类型的文件。顺便说一句 - 不要创建一个命名的文件`*`来测试它，因为命名的文件`*`可能会导致各种有趣和不需要的事情发生。想想当您尝试删除文件时会发生什么？ `rm '*'` 将是正确的命令，但如果你或其他人`rm *`不假思索地做了一个，那么你有问题......

# c# - 在 C# 中显示来自另一个应用程序的 WPF 窗口

> ID：11399528
> 
> 赞同：3
> 
> 时间：2012-07-09T16:45:17.583
> 
> 标签：c#, wpf, winapi, process, window

我有一个名为 app1 的 WPF 应用程序，它有一个名为 window1 的窗口。当用户单击 的关闭按钮时`window1`，应用程序不会关闭，但 window1 会隐藏 ( `this.hide()`)。

我想检查应用程序的另一个实例在启动时是否已经在运行；如果是这样，我想显示已经运行的实例并终止新的实例。

我怎样才能做到这一点？

我知道如何检查进程以及如何关闭当前应用程序，但我不知道如何显示另一个正在运行的 WPF 进程的窗口...

在我的应用程序启动事件中，我这样做：

```
private void Application_Startup(object sender, StartupEventArgs e)
{
    if(Process.GetProcessesByName(Process.GetCurrentProcess().ProcessName).Count() > 1)
    {
        Application.Current.Shutdown(0);
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-09T16:50:11.470

一个典型的方法是使用互斥锁。这允许您防止启动第二个实例（或者更确切地说，在应用程序*的第二个实例中检测它*）。

此时，您可以通知原始应用程序实例“显示”自己。这是[一篇很好的文章，详细描述了整个过程](http://sanity-free.org/143/csharp_dotnet_single_instance_application.html)（尽管使用 Windows 窗体）。

对于 WPF 应用程序，您需要将此逻辑放入应用程序的启动逻辑中，并[添加一个 HwndSourceHook 来处理](https://stackoverflow.com/questions/624367/how-to-handle-wndproc-messages-in-wpf)您想要显示的 WPF 窗口中的 windows 消息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T17:47:53.050

我找到了如何做这项工作！

我的问题通过“Reed Copsey”帮助和 Windows SendMessage API 解决了。为了做这件事，我在 window1.xaml.cs 文件中编写了这些代码：

```
 using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Reflection;
using System.Runtime.InteropServices;
using System.Windows.Interop;

namespace app1
{
    public partial class window1: Window
    {
        public window1()
        {
            InitializeComponent();            
        }
        private void window1_Loaded(object sender, RoutedEventArgs e)
        {
            HwndSource source = HwndSource.FromHwnd(new WindowInteropHelper(this).Handle);
            source.AddHook(new HwndSourceHook(WndProc));
        }
        private IntPtr WndProc(IntPtr hwnd, int msg, IntPtr wParam, IntPtr lParam, ref bool handled)
        {
            System.Windows.Forms.Message m = System.Windows.Forms.Message.Create(hwnd, msg, wParam, lParam);
            if (m.Msg == WM_COPYDATA)
            {
                // Get the COPYDATASTRUCT struct from lParam.
                COPYDATASTRUCT cds = (COPYDATASTRUCT)m.GetLParam(typeof(COPYDATASTRUCT));

                // If the size matches
                if (cds.cbData == Marshal.SizeOf(typeof(MyStruct)))
                {
                    // Marshal the data from the unmanaged memory block to a 
                    // MyStruct managed struct.
                    MyStruct myStruct = (MyStruct)Marshal.PtrToStructure(cds.lpData,
                        typeof(MyStruct));

                    // Display the MyStruct data members.
                    if (myStruct.Message == "Show Up")
                    {
                        this.Show();
                    }
                }
            }
            return IntPtr.Zero;
        }

        internal const int WM_COPYDATA = 0x004A;

        [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
        internal struct MyStruct
        {
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 256)]
            public string Message;
        }
        [StructLayout(LayoutKind.Sequential)]
        internal struct COPYDATASTRUCT
        {
            public IntPtr dwData;       // Specifies data to be passed
            public int cbData;          // Specifies the data size in bytes
            public IntPtr lpData;       // Pointer to data to be passed
        }

    }
} 

```

我在 App.xaml.cs 中编写了这些代码：

```
 using System;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Linq;
using System.Windows;
using System.Windows.Threading;
using System.Runtime.InteropServices;
using System.Security;

namespace app1
{    
    public partial class App : Application
    {       
        [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
        internal struct MyStruct
        {
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 256)]
            public string Message;
        }

        internal const int WM_COPYDATA = 0x004A;
        [StructLayout(LayoutKind.Sequential)]
        internal struct COPYDATASTRUCT
        {
            public IntPtr dwData;       // Specifies data to be passed
            public int cbData;          // Specifies the data size in bytes
            public IntPtr lpData;       // Pointer to data to be passed
        }
        [SuppressUnmanagedCodeSecurity]
        internal class NativeMethod
        {            
            [DllImport("user32.dll", CharSet = CharSet.Auto, SetLastError = true)]
            public static extern IntPtr SendMessage(IntPtr hWnd, int Msg,
                IntPtr wParam, ref COPYDATASTRUCT lParam);

            [DllImport("user32.dll", CharSet = CharSet.Auto, SetLastError = true)]
            public static extern IntPtr FindWindow(string lpClassName, string lpWindowName);
        }

        private void Application_Startup(object sender, StartupEventArgs e)
        {            
            if (System.Diagnostics.Process.GetProcessesByName(Process.GetCurrentProcess().ProcessName).Count() > 1)
            {
                IntPtr hTargetWnd = NativeMethod.FindWindow(null, "window1");
                if (hTargetWnd == IntPtr.Zero)
                {                    
                    return;
                }
                MyStruct myStruct;
                myStruct.Message = "Show Up";
                int myStructSize = Marshal.SizeOf(myStruct);
                IntPtr pMyStruct = Marshal.AllocHGlobal(myStructSize);
                try
                {
                    Marshal.StructureToPtr(myStruct, pMyStruct, true);

                    COPYDATASTRUCT cds = new COPYDATASTRUCT();
                    cds.cbData = myStructSize;
                    cds.lpData = pMyStruct;
                    NativeMethod.SendMessage(hTargetWnd, WM_COPYDATA, new IntPtr() , ref cds);

                    int result = Marshal.GetLastWin32Error();
                    if (result != 0)
                    {                       
                    }
                }
                finally
                {
                    Marshal.FreeHGlobal(pMyStruct);
                }
                Application.Current.Shutdown(0);
            }            
        }  

    }
} 

```

就是这样。:D

# java - Android 构造和语法错误

> ID：11399531
> 
> 赞同：0
> 
> 时间：2012-07-09T16:45:21.590
> 
> 标签：java, android

我在网上找到了这个示例代码。它似乎可以做我想做的事，向 API 发出请求，我只需要对其进行一点定制。

但是，当我尝试编译它时，它给了我三行相同的错误

```
 Syntax error on token(s), misplaced 
 construct(s)
- Syntax error on token "setEntity", = 
 expected after this token 
```

也许有人能看到我看不到的东西？

这是代码：

```
import java.util.ArrayList;
import java.util.List;

import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;

public class http {

HttpClient httpclient = new DefaultHttpClient();
HttpPost httppost = new HttpPost("http://www.yoursite.com/script.php");

    List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
    nameValuePairs.add(new BasicNameValuePair("id", "12345"));
    nameValuePairs.add(new BasicNameValuePair("stringdata", "AndDev is Cool!"));
    httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

    // Execute HTTP Post Request
    HttpResponse response = httpclient.execute(httppost);

 } 
```

nameValuePairs.add 行和 httppost.setEntity 行引发错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:58:44.953

除了 Ran 所说的：你可能想先学习一些基本的 Java 编程课程/教程。一些与编程相关的教程假设你已经熟悉了，只列出几行不能直接使用的代码，因为它们属于方法。

您需要按如下方式重写您的类（“myMethodName”可以是您选择的任何其他名称）

```
public class http {
   public void myMethodName() {
       HttpClient httpclient = new DefaultHttpClient();
       HttpPost httppost = new HttpPost("http://www.yoursite.com/script.php");

       List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
       nameValuePairs.add(new BasicNameValuePair("id", "12345"));
       nameValuePairs.add(new BasicNameValuePair("stringdata", "AndDev is Cool!"));
       httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

       // Execute HTTP Post Request
       HttpResponse response = httpclient.execute(httppost);
   }
} 
```

然后这段代码就不能按原样执行了。您需要创建您的类“http”的一个实例，并从 Android Activity 调用它的“myMethodName”方法。

# objective-c - UITableView 显示数据然后崩溃

> ID：11399532
> 
> 赞同：0
> 
> 时间：2012-07-09T16:45:22.550
> 
> 标签：objective-c, uitableview, exc-bad-access

我正在制作一个列出 Documents 字典中文件的 iOS。我想在 UITableView 中显示这些数据，问题是它不起作用。它将数据加载到视图中。*然后*应用程序冻结并调用`EXC_BAD_ACCESS`
这是我的代码：

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
    timesRun = 0;
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectoryPath = [paths objectAtIndex:0];
    NSString *bundleRoot = [[NSBundle mainBundle] bundlePath];
    dirContents = [[NSFileManager defaultManager] contentsOfDirectoryAtPath:documentsDirectoryPath error:nil];
    [bundleRoot release];
    NSLog(@"Count: %i",[dirContents count]);
    return [dirContents count];
}

- (UITableViewCell *)tableView:(UITableView *)tableViewData cellForRowAtIndexPath:(NSIndexPath *)indexPath{
    UITableViewCell *cell = nil;
    int Locatation = indexPath.row;
    Locatation++;
    cell = [tableViewData dequeueReusableCellWithIdentifier:@"MyCells"];
    if (cell == nil) {
        cell = [[[UITableViewCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"MyCell"]autorelease];
    }
    //cell.textLabel.text = [NSString stringWithFormat:@"Cell: %i",Locatation];
    cell.textLabel.text = [dirContents objectAtIndex:timesRun];
    timesRun++;  
    return cell;
    NSLog(@"Did return");
}
- (void)tableView:(UITableView *)tableViewDat didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];
    NSLog(@"%@",cell.textLabel.text);
    [tableView deselectRowAtIndexPath:indexPath animated:YES];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:04:18.483

This displays a basic misunderstanding of the concept of the table view data source.

My suggestion:

Create an array that contains the files outside any tableview methods. Then you use that array to feed the tableview.

Use array.count to return numberofrowsatindexpath. Also, on providing the cells at cellforrowatindexpath, don't use iterations/counters. The tableview ask for each element of your array itself using the indexpath argument. You access it like this:

id object = [array objectArIndex: indexPath.row]

And you then use the objects attributes to set the labels of the cell.

Please read a tutorial on tableviews. I recommend itunesU Paul hegarty's lectures. They're really great.

Ps. You release the bundleRoot object in numberofrowsinsection, which you don't retain (or use at all) which is most likely causing your crash.

**Edit:**

With a little more spare time, I retouched your code:

```
//code not tested/written in xcode. Might contain typos

//in your .m file
//in your (private) interface

@property (nonatomic, retain, readonly) NSArray *dirContents;

//in your implementation

@synthesize dirContents=_dirContents;

-(NSArray*) dirContents {
  if (!dirContents) {
   NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
   NSString *documentsDirectoryPath = [paths objectAtIndex:0];
   _dirContents = [[[NSFileManager defaultManager] contentsOfDirectoryAtPath:documentsDirectoryPath error:nil] retain];
  }
  return _dirContents;
  //note that if you want to "refresh" the contents you would have to
  //release _dirContents and set it to nil or implement this differently
}

-(void) dealloc {
  [_dirContents release];
  //....
  [super dealloc];
 }

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
  return [[self dirContents] count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
  UITableViewCell *cell = nil;

  cell = [tableView dequeueReusableCellWithIdentifier:@"MyCells"];
  if (cell == nil) {
     cell = [[[UITableViewCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"MyCells"]autorelease];
  }

  cell.textLabel.text = [[self dirContents] objectAtIndex: indexPath.row];

  return cell;
  //  NSLog(@"Did return"); //this never gets called by the way
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
  UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];
  NSLog(@"%@",cell.textLabel.text);
  [tableView deselectRowAtIndexPath:indexPath animated:YES];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:07:00.130

My problem was sort of like Mario's answer. `[dirContents count]` returned a *higher* value than the amount of times it could add an object from the array.

In other words it was a Out of Bounds error.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T17:09:41.567

确保您在使用它时没有发布 dirContents。我确定您没有这样做，只是交叉检查您的代码。

# c++ - CUDA：结构的共享数据成员和对该结构的引用成员具有不同的地址、值

> ID：11399534
> 
> 赞同：1
> 
> 时间：2012-07-09T16:45:35.073
> 
> 标签：c++, cuda, shared-memory, address-operator

好的，这就是问题所在：使用 CUDA 1.1 计算 gpu，我试图为每个线程维护一组（可能数量不同，这里固定为 4 个）索引，这是我作为 struct var 成员保留的引用。我的问题是在访问成员数组时获取对结构的引用会导致不正确的结果：我用 0 初始化成员数组值，当我使用原始结构 var 读取数组 vals 时，我得到正确的值 (0) ，但是当我使用对 struct var 的引用阅读它时，我得到了垃圾（-8193）。即使使用类而不是结构也会发生这种情况。

为什么tmp低于！= 0 ??

c++ 不是我的主要语言，所以这可能是一个概念问题，或者它可能是在 cuda 中工作的一个怪癖

```
struct DataIdx {
    int numFeats;
    int* featIdx;
};
extern __shared__ int sharedData[];

__global__  void myFn(){
    int tidx = blockIdx.x * blockDim.x + threadIdx.x;

    DataIdx myIdx;  //instantiate the struct var in the context of the current thread
    myIdx.numFeats = 4;
    size_t idxArraySize = sizeof(int)*4;
    //get a reference to my array for this thread. Parallel Nsight debugger shows myIdx.featIdx address = 0x0000000000000000e0
    myIdx.featIdx = (int*)(&sharedData[tidx*idxArraySize]);  

    myIdx.featIdx[0] = 0x0;  //set first value to 0 
    int tmp = myIdx.featIdx[0];  // tmp is correctly eq to 0 in Nsight debugger -- As Expected!!
    tmp = 2*tmp;    antIdx.featIdx[0] = tmp; //ensure compiler doesn't elide out tmp

    DataIdx *tmpIdx = &myIdx;  //create a reference to my struct var
    tmp = tmpIdx.featIdx[0];   // expected 0, but tmp = -8193 in debugger !! why?  debugger shows address of tmpIdx.featIdx = __devicea__ address=8
    tmpIdx.featIdx[0] = 0x0;
    tmp = tmpIdx.featIdx[0]; // tmp = -1; cant even read what we just set

    //forcing the same reference as myIdx.featIdx, still gives a problem! debugger shows address of tmpIdx.featIdx = __devicea__ address=8
    tmpIdx->featIdx =  (int*)(&sharedData[tidx*idxArraySize]); 
    tmp = tmpIdx.featIdx[0]; //tmp = -8193!! why != 0?

    DataIdx tmpIdxAlias = myIdx;
    tmp = tmpIdx.featIdx[0]; //aliasing the original var gives correct results, tmp=0

     myIdx.featIdx[0] = 0x0;
     mySubfn(&myIdx); //this is a problem because it happens when passing the struct by reference to subfns
     mySubfn2(myIdx);
}
__device__ mySubfn(struct DataIdx *myIdx){
  int tmp = myIdx->featIdx[0]; //tmp == -8193!! should be 0
}
__device__ mySubfn2(struct DataIdx &myIdx){
  int tmp = myIdx.featIdx[0]; //tmp == -8193!! should be 0
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:41:05.940

我不得不修改你的代码来编译。在行

tmpIdx->featIdx[0] = 0x0

编译器无法理解指向共享内存的指针。它不是对共享内存 (R2G) 进行存储，而是对超出范围的全局地址 0x10 进行存储。

```
 DataIdx *tmpIdx = &myIdx;
0x000024c8  MOV32 R2, R31;  
0x000024cc  MOV32 R2, R2;  
    tmp = tmpIdx->featIdx[0];
    tmpIdx->featIdx[0] = 0x0;
0x000024d0  MOV32 R3, R31;  
0x000024d4  MOV32 R2, R2;  
0x000024d8  IADD32I R4, R2, 0x4;  
0x000024e0  R2A A1, R4;  
0x000024e8  LLD.U32 R4, local [A1+0x0];  
0x000024f0  IADD R4, R4, R31;  
0x000024f8  SHL R4, R4, R31;  
0x00002500  IADD R4, R4, R31;  
0x00002508  GST.U32 global14 [R4], R3;   // <<== GLOBAL STORE vs. R2G (register to global register file)
    tmp = tmpIdx->featIdx[0]; 
```

Nsight CUDA 内存检查器将越界存储捕获到全局内存。

内存检查器检测到 1 个访问冲突。错误 = 存储（全局内存）访问冲突 blockIdx = {0,0,0} threadIdx = {0,0,0} 地址 = 0x00000010 accessSize = 0

如果您为`compute_10,sm_10`（实际上 <= 1.3）进行编译，您应该看到编译器无法确定访问共享内存的每一行的以下警告：

```
kernel.cu(46): warning : Cannot tell what pointer points to, assuming global memory space 
```

如果您在启动后添加 cudaDeviceSynchronize，您应该会看到错误代码 cudaErrorUnknown 由内存访问越界引起。

`__shared__`是变量内存限定符而不是类型限定符，所以我知道您将如何告诉编译器 featIdx 将始终指向共享内存。在 CC >= 2.0 上，编译器应将 (int*)(&sharedData[tidx*idxArraySize]) 转换为通用指针。

# html - 滚动时如何使 div 跟随？

> ID：11399537
> 
> 赞同：63
> 
> 时间：2012-07-09T16:45:54.560
> 
> 标签：html, scroll

我在左侧有一个 div，其中包括营业时间和天气。我希望该 div 根据用户的滚动方式向下和向上滚动。所以它会跟随页面上下移动。我将如何尝试？这是我的网站[judystropicalgarden.com](http://judystropicalgarden.com)

谢谢

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2012-07-09T16:50:49.997

您可以使用 CSS 属性 Fixed，或者如果您需要更精细的调整，则需要使用 javascript 并跟踪 scrollTop 属性，该属性定义了用户代理的滚动条位置（0 位于顶部...而 x 位于在底部）

```
.Fixed
{
    position: fixed;
    top: 20px;
} 
```

或使用 jQuery：

```
$('#ParentContainer').scroll(function() { 
    $('#FixedDiv').css('top', $(this).scrollTop());
}); 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2020-01-22T11:18:02.953

这篇文章很旧，但我为此目的找到了一个完美的 CSS，我想分享它。

> 粘性元素在相对和固定之间切换，具体取决于滚动位置。它是相对定位的，直到在视口中遇到给定的偏移位置 - 然后它“粘”在适当的位置（如位置：固定）。

```
 div.sticky {
        position: -webkit-sticky; /* Safari */
        position: sticky;
        top: 0;
        background-color: green;
        border: 2px solid #4CAF50;
    } 
```

来源：[https ://www.w3schools.com/css/css_positioning.asp](https://www.w3schools.com/css/css_positioning.asp)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-07-09T16:50:09.637

使用 CSS 中的样式，您可以定义某物的定位方式。如果您将元素定义为**fixed**，它将始终保持在屏幕上的相同位置。

```
div
{
    position:fixed;
    top:20px;
} 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-07-09T16:49:48.787

您可以使用`fixed`CSS 位置属性来完成此操作。这里有一个基本[教程](http://davidwalsh.name/css-fixed-position)。

编辑：但是，IE 版本 < IE7 不支持这种方法，并且仅在 IE7 处于标准模式时才支持。[此处](https://stackoverflow.com/questions/1628265/how-to-get-positionfixed-css-to-work-in-ie-7-with-transitional-doctype)将对此进行更详细的讨论。

[这里](http://ryanfait.com/resources/fixed-positioning-in-internet-explorer/)还有一个 hack，解释了如何在 IE6 中完成固定定位而不影响绝对定位。您的网站针对的是哪个版本的 IE？

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2014-08-01T22:10:15.797

更好的 JQuery 答案是：

```
$('#ParentContainer').scroll(function() { 
    $('#FixedDiv').animate({top:$(this).scrollTop()});
}); 
```

您还可以在 scrollTop 之后添加一个数字，即 .scrollTop() + 5 以赋予它增益。

一个好的建议是将持续时间限制为 100 并从默认摆动变为线性缓动。

```
$('#ParentContainer').scroll(function() { 
    $('#FixedDiv').animate({top:$(this).scrollTop()},100,"linear");
}) 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-06-18T04:34:01.937

位置：**固定；**财产应该做的工作，我在我的网站上使用它，它工作得很好。 [http://www.w3schools.com/css/css_positioning.asp](http://www.w3schools.com/css/css_positioning.asp)

# php - 创建一个组合 MySQL 中多个查询的结果的结果集？

> ID：11399539
> 
> 赞同：0
> 
> 时间：2012-07-09T16:46:04.573
> 
> 标签：php, mysql

这是我的场景：我有两个不同的表：“订阅”表包含与用户网站订阅相关的所有信息，“评分”表包含订阅网站产品的分数。简化是这样的：

```
Subscriptions: 'id','user','place','created', etc.
Ratings: 'id','user','product','created',etc. 
```

现在我需要 mysql 来返回我最近的 10 个项目，无论是订阅还是评分。到目前为止，找到的解决方案是进行两个不同的调用：

```
SELECT * FROM subscriptions WHERE ... ORDER BY created LIMIT 10\. 
```

有了这两个结果（20 个元素），我通过“created”对多维数组进行排序，并获得前 10 个（将结果保存在 $items 中）：

```
$items = array_slice($items, 0, 10); 
```

我怀疑这个解决方案效率不高，因为我在两次调用中得到它，并返回比我需要的更多的元素。我一直在阅读 UNION 运算符允许您一次选择多个不同的表，但列数相同。我的问题是，在一次调用中加入由公共字段（在我的情况下创建）排序的特定数量的不同类型元素的最有效方法是什么？不可能吗？非常感谢，感谢任何帮助，Jesús。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:47:54.200

UNION 是必需的。

你可以在这里学习如何使用它：

[加入两个表，然后按日期排序，但合并两个表](https://stackoverflow.com/questions/5284923/join-two-tables-then-order-by-date-but-combining-both-tables)

我发布的链接中没有解释，但也可以在 UNION 上设置一个限制。结合 ORDER BY 这就是您所需要的。（归功于 Frits van Campen）

```
(SELECT cols FROM subscriptions) 
UNION 
(SELECT cols FROM ratings);
ORDER BY created LIMIT 10 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:48:41.760

修改您的查询以使用[UNION](http://dev.mysql.com/doc/refman/5.1/en/union.html)来组合结果，一旦组合了结果，您就可以利用 LIMIT 方法和 ORDER BY 将输出限制为所需的记录数。

> 要将 ORDER BY 或 LIMIT 应用于单个 SELECT，请将子句放在括 SELECT 的括号内：

此外：

> 要使用 ORDER BY 或 LIMIT 子句对整个 UNION 结果进行排序或限制，请将各个 SELECT 语句括起来并将 ORDER BY 或 LIMIT 放在最后一个之后。

```
(SELECT cols FROM subscriptions WHERE ... ORDER BY created LIMIT 10) 
UNION 
(SELECT cols FROM ratings WHERE ... ORDER BY created LIMIT 10);
ORDER BY created LIMIT 10 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T16:48:48.273

使用`UNION`：[http ://dev.mysql.com/doc/refman/5.0/en/union.html](http://dev.mysql.com/doc/refman/5.0/en/union.html)

# python - “标签”对象没有属性“计数”

> ID：11399549
> 
> 赞同：1
> 
> 时间：2012-07-09T16:46:45.290
> 
> 标签：python, django

当我转到“标签”对象没有属性“计数”的开发服务器时，我不断收到此错误。我不明白为什么在前几行代码中使用 tag.count 时没有产生任何错误时，第 117 行会出现错误？谢谢！

这是错误消息：

```
AttributeError at /tag/
'Tag' object has no attribute 'count'
Request Method: GET
Request URL:    
http://127.0.0.1:8000/tag/

Django Version: 1.4
Exception Type: AttributeError
Exception Value:    
'Tag' object has no attribute 'count'
Exception Location: /Users/jonathanschen/Python/projects/skeleton/django_bookmarks/django_bookmarks/bookmarks/views.py in tag_cloud_page, line 117
Python Executable:  /usr/bin/python
Python Version: 2.7.1
Python Path:    
['/Users/jonathanschen/Python/projects/skeleton/django_bookmarks',
 '/Library/Python/2.7/site-packages/pip-1.1-py2.7.egg',
 '/Library/Python/2.7/site-packages/distribute-0.6.27-py2.7.egg',
 '/Library/Python/2.7/site-packages/nose-1.1.2-py2.7.egg',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python27.zip',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-darwin',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac/lib-scriptpackages',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-tk',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-old',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-dynload',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python/PyObjC',
 '/Library/Python/2.7/site-packages',
 '/Library/Python/2.7/site-packages/setuptools-0.6c11-py2.7.egg-info']
Server time:    Mon, 9 Jul 2012 11:35:33 -0500 
```

它引用的代码是这样的：

```
def tag_cloud_page(request):
    MAX_WEIGHT = 5
    tags = Tag.objects.order_by('name')
    # Calculate tag min and max counts
    min_count = max_count = tags[0].bookmarks.count()
    for tag in tags:
        tag.count = tag.bookmarks.count()
        if tag.count < min_count:
            min_count = tag.count
        if max_count < tag.count:
            max_count = tag.count
        #calculate count range. Avoid dividing by zero.
        range = float(max_count - min_count)
        if range == 0.0:
            range = 1.0
        # Calculate tag weights.
        for tag in tags:
            tag.weight = int(
                MAX_WEIGHT * (tag.count - min_count) / range #line 117
            )
        variables = RequestContext(request, {
            'tags': tags
        })
        return render_to_response('tag_cloud_page.html', variables) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:52:26.463

您使用相同的关键字迭代`tags`两次`tag`。把你的第二个 for 循环变成这样：

```
for related_tag in tags: 
```

此外，您需要`tag.weight = ...`在第二个循环中进行更改，以便它引用正确的`tag`和`related_tag`实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:53:52.107

你没有说哪一行是第 117 行。我假设它是行：

```
MAX_WEIGHT * (tag.count - min_count) / range 
```

您在 for 循环中使用具有相同名称“标记”的相同迭代器，该循环也使用标记进行迭代。这是行不通的。

# maps - KML 和谷歌地图错误

> ID：11399554
> 
> 赞同：0
> 
> 时间：2012-07-09T16:47:07.027
> 
> 标签：maps, kml

我用 Java 创建了一个程序来创建 KML 文件。输出是这样的：

```
<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://earth.google.com/kml/2.2">
<Placemark>
<name>Evidence File</name>
<description>London</description>
<Point>
<coordinates>51.522416,-0.131836,0<coordinates>
</Point>
</Placemark>
</kml> 
```

但是，当我将它导入谷歌地图时 - 我有错误：

> 我们无法完成上传您的文件。没有对地图进行任何更改。

谁能看到我遗漏的任何错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T23:23:36.880

您的结束`coordinates`标签缺少“/”，即它应该是：

```
<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://earth.google.com/kml/2.2">
    <Placemark>
        <name>Evidence File</name>
        <description>London</description>
        <Point>
            <coordinates>51.522416,-0.131836,0</coordinates>
        </Point>
    </Placemark>
</kml> 
```

# javascript - 谷歌地图 v3：你可以只设置边界地图吗？

> ID：11399557
> 
> 赞同：0
> 
> 时间：2012-07-09T16:47:12.050
> 
> 标签：javascript, google-maps-api-3

仅使用 SW 和 NE 坐标，您可以设置谷歌地图视图，还是必须缩放和/或中心坐标？

我一直在寻找 a) 找不到明确的答案。b）我尝试过的任何构造都不起作用。

如果有人知道这是可能的，我将如何定义边界选项来创建地图？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:50:50.707

您可以使用`fitBounds`将地图设置为（大约）指定的边界，如[API 参考](https://developers.google.com/maps/documentation/javascript/reference#Map)中所述。

# ruby-on-rails - Rails - 多态关联连接表

> ID：11399570
> 
> 赞同：1
> 
> 时间：2012-07-09T16:48:30.417
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

我目前正在尝试建立一个看起来很简单的模型结构，但我还没有完全搞定。

我有一个模型`payment`可以属于 a`customer`或 a `supplier`（两者都可以有很多`payments`）。

我的问题只是我是否需要手动创建一个接口表来允许这样做，或者声明多态关联是否会为我这样做？

例如我有：

```
class Payment < ActiveRecord::Base
    belongs_to :payment_originator, :polymorphic => true
end

class Customer < ActiveRecord::Base
    has_many :payments, :as => :payment_originator
end

class Supplier < ActiveRecord::Base
    has_many :payments, :as => :payment_originator
end 
```

这足够了吗，还是我还需要使用生成器来手动创建 payment_originator 模型？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:56:43.987

就模型而言，这已经足够了。您只需要将 a`:payment_originator_type`和迁移`:payment_originator_id`到付款表。您在上面定义的关联将自动为您填写这些。

# iphone - 如何使用子类而不是预期类？

> ID：11399572
> 
> 赞同：-1
> 
> 时间：2012-07-09T16:48:35.757
> 
> 标签：iphone, objective-c, ios, class, uibutton

我有一个包含 UIButton 作为子视图的类。我有一个我制作的 UIButton 子类，它有我自己的修改，我想用它来代替 UIButton，但我不想只是删除原始 UIButton 并添加这个代替，因为那样它就不会响应该类提供给它的 UIButton 命令。

如何在这里使用我的 UIButton 子类？

希望这是有道理的。

编辑：所以我有一个 UIView 的子类。它被称为 MyView。MyView 有一个 UIButton 的子视图。我还有一个 UIButton 的子类，称为 MyButton。我想在 MyView 上使用 MyButton 而不是 UIButton。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T16:59:21.537

在头文件或实现文件的顶部：

```
#import "MyView.h"
#import "MyButton.h" 
```

你需要它的地方：

```
MyView *myView = [[MyView alloc] init];
MyButton *myButton = [[MyButton alloc] init];
[myView addSubview:myButton]; 
```

就这样，当然将按钮设置在正确的位置，具有正确的大小等，我留给你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:52:56.767

如果您`UIButton`只是为了添加属性或方法而进行子类化，那么您应该[创建一个类别](https://stackoverflow.com/questions/5500327/subclass-uibutton-to-add-a-property/5500525#5500525)。如果您正在创建需要覆盖现有方法或执行其他绘图的自定义按钮，那么您只需创建按钮的实例并将其添加到您的视图中。

```
MyButton *button = [[MyButton alloc] initWithFrame:CGRectMake(10, 10, 100, 100)]; 
```

# c# - .html 文件 > HTMLAgilityPack > TreeView 层次结构

> ID：11399574
> 
> 赞同：0
> 
> 时间：2012-07-09T16:48:45.293
> 
> 标签：c#, html, treeview, html-agility-pack

使用 HTMLAgilityPack + TreeView 创建 HTML 文件的层次结构 GUI。HTML 文件是由 CMS 生成的，而且生成得不是很好。

需要做到以下几点： 1\. 将每个*Outline Level 0*节点读入 TreeView。

```
HtmlNodeCollection ZeroLevelNodes = doc.DocumentNode.SelectNodes("//body/object[@type='text/sitemap']|//body/ul/object[@type='text/sitemap']|//body/ul/li/object[@type='text/sitemap']"); 
```

2\. 将 Outline Level 1 节点读取为它们各自 Outline Level 0 节点的子节点 **注意：**每个 Outline Level 0 节点（减去一些对这个问题不重要的节点）的布局为`<li><object><param /></object>`（注意缺少结束`</li>`标记） . 需要在 TreeView 中显示为子节点的节点将位于无序列表`<ul>`中，该列表是 0 级节点标记的下一个兄弟节点`<li>`，例如：

```
<ul>
    <li>
        <object>
            <param name="**exampleLevel0**" value="**example.htm**" /> //value example.htm as the text in the level 0 node.
        </object>
    <ul>
        <li>
            <object>
               <param name="**ExampleLevel1**" value="childnode.htm" /> //childnode.htm as the text in the level 1 child node.
            </object>
        <li>
            <object>
               <param name="**ExampleLevel1_2**" value="childnode2.htm" /> //childnode2.htm as the text in the level 1 child node.
            </object>
    </ul>
 </ul> 
```

这是我当前生成顶层层次结构的代码

```
HtmlNodeCollection tocNodes = doc.DocumentNode.SelectNodes("//body/object[@type='text/sitemap']|//body/ul/object[@type='text/sitemap']|//body/ul/li/object[@type='text/sitemap']");
foreach (HtmlNode zeroLevelNode in zeroLevelNodes)
        {

            TreeNode tNode = new TreeNode();
            HtmlNode paramNode = zeroLevelNode.SelectSingleNode("param[@name]");
            string paramName = paramNode.GetAttributeValue("name", null);
            string paramValue = paramNode.GetAttributeValue("value", null);
            TreeView.Nodes.Add(new TreeNode(paramValue));
            tNode = TreeView.Nodes[i];
            AddNode(zeroLevelNode, tNode);
            i += 1;
        } 
```

谁能帮我将“孩子”（大纲级别 1）节点加载到 TreeView 所需的代码？(AddNode(zeroLevelNode, tNode)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T17:13:09.350

像这样的东西？

```
HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();
doc.LoadHtml(html);
TreeNode root = new TreeNode("HTML");
treeView1.Nodes.Add(root);

LoadTree(root, doc.DocumentNode);

void LoadTree(TreeNode treeNode, HtmlAgilityPack.HtmlNode rootNode)
{
    foreach (var node in rootNode.ChildNodes.Where(n=>n.Name!="#text"))
    {
        TreeNode n = new TreeNode(node.Name);
        node.Attributes.Select(a => a.Name + "=" + a.Value)
                       .ToList()
                       .ForEach(x => n.Nodes.Add(x));
        treeNode.Nodes.Add(n);

        LoadTree(n, node);
    }
} 
```

# ember.js - Emberjs 根元素

> ID：11399577
> 
> 赞同：8
> 
> 时间：2012-07-09T16:48:50.127
> 
> 标签：ember.js

在指南中我可以找到：

" 如果您将 Ember 应用程序嵌入到现有站点中，您可以通过提供 rootElement 属性为特定元素设置事件侦听器：

```
window.App = Ember.Application.create({
  rootElement: '#sidebar'
}); 
```

"

请举例说明如何正确使用它。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-09T18:06:34.157

**HTML**

```
<script type="text/x-handlebars" data-template-name="app-view">
    My ember app view
</script>

This is a static content

<div id="app-container"></div>

This is a static content 
```

**JS**

```
App = Ember.Application.create({
  rootElement: '#app-container'
});

App.ApplicationController = Ember.Controller.extend();
App.ApplicationView = Ember.View.extend({
    templateName: 'app-view'
});

App.Router = Ember.Router.extend({
    root: Ember.Route.extend({
        index: Ember.Route.extend({
            route: '/',

            connectOutlets: function (router) {
                // do some stuff here...
            }
        })
    })
});

App.initialize(); 
```

这是 JSFiddle：http: [//jsfiddle.net/MikeAski/xtzNB/](http://jsfiddle.net/MikeAski/xtzNB/)

# wcf - WCF REST 服务到 GZIP 压缩响应并接受 IIS 上的请求

> ID：11399579
> 
> 赞同：1
> 
> 时间：2012-07-09T16:48:55.433
> 
> 标签：wcf, rest, iis-7.5, gzip

.NET 4.0 和 IIS 7.5

我完全迷失了这个。压缩在 IIS 上启用了静态和动态。Web.Config 看起来像这样：

```
<httpCompression minFileSizeForComp="1" directory="%SystemDrive%\inetpub\temp\IIS Temporary Compressed Files">
      <scheme doDynamicCompression="true" name="gzip" dll="%Windir%\system32\inetsrv\gzip.dll"/>
      <dynamicTypes>
        <add mimeType="text/*" enabled="true"/>
        <add mimeType="message/*" enabled="true"/>
        <add mimeType="application/javascript" enabled="true"/>
        <add mimeType="application/json" enabled="true"/>
        <add mimeType="application/json; charset=utf-8" enabled="true"/>
        <add mimeType="*/*" enabled="true"/>
      </dynamicTypes>
      <staticTypes>
        <add mimeType="image/png" enabled="true"/>
        <add mimeType="text/*" enabled="true"/>
        <add mimeType="message/*" enabled="true"/>
        <add mimeType="application/javascript" enabled="true"/>
        <add mimeType="application/json" enabled="true"/>
        <add mimeType="*/*" enabled="true"/>
      </staticTypes>
    </httpCompression>
    <urlCompression doStaticCompression="true" doDynamicCompression="true"/>
  </system.webServer> 
```

然而，当我在 Figgler 服务器中监控流量时，不会压缩我的请求。如何使用我的服务启用它？

# java - 如何增加java堆的内存大小

> ID：11399583
> 
> 赞同：1
> 
> 时间：2012-07-09T16:49:19.643
> 
> 标签：java, memory, heap-memory

我想增加堆 java 以避免这个错误消息我有 windows 7 64bit 和 java 版本

```
C:\Users\Rasha>java -version
java version "1.5.0_15"
Java(TM) 2 Runtime Environment, Standard Edition (build 1.5.0_15-b04)
Java HotSpot(TM) Client VM (build 1.5.0_15-b04, mixed mode)

java -Xms1024m -Xmx1024m -XX:PermSize=512m -XX:MaxPermSize=512m
Error occurred during initialization of VM
Could not reserve enough space for object
Could not create the Java virtual machine. 
```

虽然我已经有6G内存了，怎么让系统识别呢？

对这个问题有什么建议吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-09T16:53:12.380

使用 64 位 JVM。由于需要连续的地址空间，32 位 JVM 不能分配超过 1.5 gb 的内存（例如，在您遇到困难的地方）。我知道您使用的是 32 位 JVM，因为上面显示“客户端 VM”，而 64 位没有“客户端 VM”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T05:21:23.970

谢谢，我找到了问题，我有多个版本的java，配置冲突解决方法是删除所有版本并安装java 64位版本，空间分配好谢谢大家

# ruby - 当使用 curl 获取文件并通过管道传输到 ruby 时，STDIN.gets 产生 nil

> ID：11399584
> 
> 赞同：1
> 
> 时间：2012-07-09T16:49:21.440
> 
> 标签：ruby, stdin

因此，如果我使用 curl 下载并运行以下代码，gets 会产生 nil 并且不会提示任何内容。

```
str=gets
unless str.nil?
  puts str
else
  puts "gets produced nil"
end 
```

正在使用的命令（您可以自己尝试）

`curl https://raw.github.com/gist/3077534/06ea1c27f7bed38408d2662671f29ea758e2e54b/gets_test.rb | ruby`

这样做有更好/更常见的做法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T17:09:04.910

这可能对您有用：

```
tty = STDIN.reopen('/dev/tty')

tty.each_line do |line|
  break if line == "\n"
  puts line
end

tty.close 
```

它对我有用：

```
$ curl https://raw.github.com/gist/3078191 | ruby
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   106  100   106    0     0     84      0  0:00:01  0:00:01 --:--:--   153
foo
foo
foobar
foobar
now pressing enter ...
now pressing enter ... 
```

# java - 在 GUI 中刷新文本面板的显示

> ID：11399587
> 
> 赞同：1
> 
> 时间：2012-07-09T16:49:31.940
> 
> 标签：java, user-interface, refresh, stringbuilder

我遇到了更多“我对编程毫无希望”的问题。

我有一段代码，它使用 StringBuilder 在程序启动时在 GUI 的文本面板中显示数组元素。这是 StringBuilder 代码：

```
// memory tab
    StringBuilder mList = new StringBuilder();
    memLocList = new Memory[MEM_LOCATIONS];
    mem = new Memory();
    for (int i = 0; i < memLocList.length; i++) {
        memLocList[i] = mem;
        memLocList[i].setOpCode(00);
        mList.append(String.format("%10s %04x %10s %6s", "Address:   ", i,
                "Value:  ", memLocList[i].getOpCode()));
        mList.append("\n");
    }

JComponent memTab = makeTextPanel(mList.toString());
    tabs.addTab("Memory", new JScrollPane(memTab));

}

protected JComponent makeTextPanel(String t) {
    text = t;
    JPanel panel = new JPanel(false);
    JTextPane filler = new JTextPane();
    filler.setFont(new Font("Courier", Font.PLAIN, 14));
    filler.setText(text);
    filler.setAlignmentX(LEFT_ALIGNMENT);
    panel.setLayout(new GridLayout(1, 1));
    panel.add(filler);
    return panel;
} 
```

GUI 也有一个文本输入面板，可以在其中输入十六进制值的字符串。

单击按钮时，系统会提示用户输入另一个值，该值对应于数组中应插入第一个十六进制值的位置。

输入这些值后，我希望更新/刷新显示以反映这一点，但不确定如何去做。

我在这里找到了这个问题，这是相似的，但我不确定实现观察者/可观察模式是否是正确的方法，即使是，我将如何去做： [Best Way to Constantly Update GUI Elements](https://stackoverflow.com/questions/539076/best-way-to-constantly-update-gui-elements)

我最初的方法是添加一个“updateDisplay()”方法，我可以在处理按钮单击后调用它并重新调用 makeTextPanel 方法：

```
public void updateDisplay() {

    makeTextPanel(text);
} 
```

我认为这可能会刷新它，但它对显示没有影响。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:01:37.040

您将数组保存在模型类中，并允许其他类通过为此类提供 SwingPropertyChangeSupport 对象以及 addPropertyChangeListener(...) 方法来“监听”它。然后给数组一个 setXXX(...) 方法，并在更新数组后在该方法中触发 SwingPropertyChangeSupport 对象。这个网站上有这类事情的例子，有些是我写的。

例如：[这里](https://stackoverflow.com/a/11171831/522444)，[这里](https://stackoverflow.com/a/9351702/522444)，[这里](https://stackoverflow.com/a/10199137/522444)，...

顺便说一句，我对你的电话`makeTextPanel(text)`不起作用并不感到惊讶。它创建了一个 JPanel，但您似乎没有对该方法返回的 JPanel 执行任何操作。但你也不应该。我不认为创建新的 JPanel 是您想要的解决方案，而是使用我上面描述的侦听器框架更新由某种组件（例如 JList 或 JTextArea）显示的字符串。

如果其中任何一个令人困惑，请要求澄清。

# php - PHPUnit 模拟对象是否可以替换在类中创建的对象？

> ID：11399600
> 
> 赞同：6
> 
> 时间：2012-07-09T16:50:13.017
> 
> 标签：php, mocking, phpunit

我一直在尝试让 PHPUnit 模拟对象为我正在处理的一些遗留代码工作，但是我在让它代替我所追求的对象时遇到了问题，我很确定这一定是因为我用错了。

目前我们有一个纯粹用于创建查询的类，当另一个类想要进行查询时，它会创建该类的一个对象并将 sql 和数据库详细信息传递给它。我想要做的是让 PHPUnit 用我可以测试的模拟版本替换这个对象。

我一直发现的是，如果我在测试脚本中创建模拟对象，被测试的方法只是绕过它。我猜这是因为该方法是在本地创建然后使用该对象，而不是作为参数传递（在这种情况下，我可以只使用作为参数传递的模拟对象来引用该方法）。下面是代码可能看起来的示例：

```
class SampleClass{
    function loadData(){
        $sql = "SELECT * FROM users";
        $query = new Query();
        $query->query($sql);
        while($row = $query->get_row()){
            if($row['email'] = ''){
                $this->errors[] = "Email missing from user ".$row['user_id'];
            }
            $result[] = $query->get_row();
        }
        $this->users = $result;
        if(count($user->errors) >= 1){
            return $user->errors;
        }else{
            return true;
        }
    }
}

class Query{
    function query($sql){
        $this->result = mysql_query($sql);
    }
    function get_row(){
        return mysql_fetch_assoc($this->result);
    }
} 
```

有没有办法在 PHPUnit 测试文件中创建一个模拟对象，它将 SampleClass 中的 $query 对象替换为一个模拟对象，我可以用它来测试传递给的参数并控制其响应？我将无法替换查询类或更改它的引用方式，因为它在我们的应用程序中被广泛使用，但我希望至少能够为它创建某种形式的测试框架。感谢您提供的任何帮助

编辑以澄清在 loadData 方法中发生的不仅仅是查询，这是我正在尝试测试的方法的一部分。我希望在查询类方法 get_row 中加入一个双倍的查询类方法，它将返回一个预设的样本数据数组以供该方法使用，而不是访问实际的数据库

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:55:38.900

是的，这是可能的。

但是，您可以只创建`SampleClass`自己的存根。`Query`您也可以创建依赖项的类名或实例。所以你实际上可以注入它。我会说这是一种更好的方法，并且更容易让您编写测试。

# ios - 在人员选择器 (ABPeoplePickerNavigationController) 中选择的人员的地理地址，格式化

> ID：11399605
> 
> 赞同：1
> 
> 时间：2012-07-09T16:50:26.777
> 
> 标签：ios, addressbook, abaddressbook, abperson

用 显示人员选择器`ABPeoplePickerNavigationController`，我可以通过以下方式在字典中获取所选人员的地址：

```
- (BOOL)peoplePickerNavigationController:(ABPeoplePickerNavigationController *)peoplePicker shouldContinueAfterSelectingPerson:(ABRecordRef)person property:(ABPropertyID)property identifier:(ABMultiValueIdentifier)identifier {
    if (property == kABPersonAddressProperty) {
        ABMultiValueRef addressMultiValue = ABRecordCopyValue(person, kABPersonAddressProperty);    

        NSDictionary *address = (NSDictionary *)CFBridgingRelease(ABMultiValueCopyValueAtIndex(addressMultiValue, ABMultiValueGetIndexForIdentifier(addressMultiValue, identifier)));

    }

    [self dismissModalViewControllerAnimated:YES];

    return NO;
} 
```

根据国家/地区的不同，有关如何格式化此地址的约定是不一样的。
有没有办法获取选择器显示的地址字符串（类似于 Contacts.app 显示的内容）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T17:15:48.160

正如您在 Contacts.app 中看到的那样，我不确定如何动态创建一组可编辑的地址字段，但 AddressBookUI 中有一个实用功能，可让您将地址字典格式化为特定于区域的地址字符串：[`ABCreateStringWithAddressDictionary`](http://developer.apple.com/library/ios/#DOCUMENTATION/AddressBookUI/Reference/AddressBookUI_Functions/Reference/reference.html). 此功能依赖于正确设置的国家代码值；如果缺少此值会发生什么，未指定。

# bdd - SpecFlow 相关功能

> ID：11399609
> 
> 赞同：0
> 
> 时间：2012-07-09T16:50:48.997
> 
> 标签：bdd, specflow

我有 2 个功能 1\. 用户创建 2\. 用户注册两者都是独立的并且有多个场景。第二个功能依赖于第一个，所以当我直接运行第二个功能时，这个功能如何检查第一个功能已经运行并且用户创建。我正在使用数据库，其中创建状态列（True/False）告诉用户是否已创建。所以，我想如果我在运行第二个功能之前运行第一个功能来创建用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:46:20.303

一般来说，在测试和特殊功能之间存在依赖关系被认为是一种非常糟糕的做法。每个测试/场景都应该有自己独立的设置。

如果您的第二个功能依赖于用户创建，您可以在您的场景中添加另一个步骤，例如“何时创建某某用户”。

如果一个功能下的所有场景共享共同的内容，您可以将其上移到背景标签下。例如：

功能：用户注册

背景给定这样那样的用户

情景 当……然后……然后……

情景 当……然后……然后……

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-09T15:12:45.507

我用反射

1.  [查找具有 DescriptionAttribute](https://stackoverflow.com/questions/607178/how-enumerate-all-classes-with-custom-class-attribute)（又名特征）的所有类型
2.  使用 TestAttribute 和 DescriptionAttribute 查找他们的 MethodInfos（又名场景）
3.  将它们存储到字典中
4.  使用 Activator.CreateInstance 和 Invoke 通过“功能标题/场景标题”调用它们

当然，您必须根据需要设置（私有）字段“testRunner”。

# php - PHP 上的 OpenSSL 问题 - 不同版本的不同行为

> ID：11399613
> 
> 赞同：3
> 
> 时间：2012-07-09T16:50:57.370
> 
> 标签：php, openssl, public-key-encryption

*（这个问题最初是在 ServerFault 上发布的——我已经在那里删除了它并把它移到了这里。）*

我有一台运行 PHP 5.3.5 的开发机器和一台运行 PHP 5.3.8 的生产机器。

以下代码在开发机器上运行：

```
<?php
$key = "-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC0x+2RiQ+LCZNAUcl/Ecf1NrTr
lhjOiHaVC+w/y+UJevqVcDstD22OJGwT13B9T47OuQG9BmzcZQYLcShUMhVD/Owu
9+8PcK51EnBd0lym6+z/WixpnqfQonyKiqq5ytmYKUlUv39J8QQUI2geyvY9VpWS
wyNcFUs7wPl2zsLCPQIDAQAB
-----END PUBLIC KEY-----";

$data = "Hello, world!";

$key1 = openssl_get_publickey($key);
print_r ($key1);
echo "<p>";

$res = openssl_public_encrypt($data, $encrypted_data, $key1, OPENSSL_PKCS1_PADDING);

echo base64_encode($encrypted_data); 
```

在我的开发机器上，此代码输出资源和编码字符串。我会在这里复制它，但当然它每次都会改变。在生产机器上，此代码会产生资源编号和以下 PHP 错误：

```
PHP Warning:  openssl_public_encrypt(): Don't know how to get public key from this private key in C:\xxx\test.php on line 15
PHP Warning:  openssl_public_encrypt(): key parameter is not a valid public key in C:\xxx\test.php on line 15 
```

不幸的是，目前不能在生产机器上安装旧版本的 PHP，因为在其上运行的其他应用程序至少需要 5.3.8。

如果我升级到 5.4.x 会有帮助吗？

我确实知道 5.3.5 上的 OpenSSL 版本是 0.9.8，而 5.3.8 中的版本是 1.0.0。我想那里可能有问题。有没有办法解决这个问题？

我试图从 OpenSSL.org 站点和 PHP 错误跟踪器中找出尽可能多的信息，但我不知道我在寻找什么。

问候，

菲利普

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-11T07:51:23.083

根据[这篇文章](https://stackoverflow.com/questions/10422268/openssl-seal-problems)，该问题与 XAMPP/Windows 安装中 Apache 和 PHP 的不同 OpenSSL 版本有关。我对 openssl_verify 有类似的问题。我通过对 Apache 和 PHP 使用相同的 OpenSSL 版本（替换 DLL）解决了这个问题。这是[解决方案的链接](http://www.apachefriends.org/f/viewtopic.php?p=190619#p194972)。

*“我找到了解决问题的方法，默认 1.7.7 安装中 /apache/bin/ 中似乎有 2 个错误文件需要替换为 /php/ 中存在的文件（libeay32.ddl 和 ssleay32.dll )"*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-14T06:47:40.767

你传递了错误的参数`openssl_public_encrypt`

`openssl_public_encrypt($data, $encrypted_data, $key1, OPENSSL_PKCS1_PADDING)`

`$key1`资源 id在哪里使用`$key`而不是`$key1`. 您可以使用

`openssl_public_encrypt($data, $encrypted_data, $key, OPENSSL_PKCS1_PADDING)`

# php - 打开/保存位于服务器文件夹中的 PDF

> ID：11399620
> 
> 赞同：0
> 
> 时间：2012-07-09T16:51:24.280
> 
> 标签：php, pdf, save

我想为 PHP 内部网的用户提供打开/保存 PDF 文件的可能性，这些文件位于 Apache 服务器上的文件夹中。PDF 包含公司私人信息，因此我不想将它们放在网络文件夹中。

```
echo '<form name="openpdf" method="POST" action="downloadPDF.php">';
echo '<input type="hidden" name="pdf">';
echo'</form>';

<tr>
<td> PDFFile1 </td>
<td><a href=javascript:void(null); onclick='document.openpdf.pdf.value="c:\pdfs\example.pdf";document.openpdf.submit(); return false;'><IMG src="img/pdf.jpg"></a></td></tr> 
```

下载PDF.php：

```
<?
$pdf=$_POST["pdf"];
if (file_exists($pdf)) {
    header('Content-Description: File Transfer');
    header('Content-Type: application/pdf');   
    header('Content-Disposition: attachment; filename='.basename($pdf));   
    header('Content-Transfer-Encoding: binary');     
    header('Expires: 0');    
    header('Cache-Control: must-revalidate');   
    header('Pragma: public');   
    header('Content-Length: ' . filesize($pdf));     
    ob_clean();     
    flush();     
    readfile($pdf);     
    exit; 
} 
?> 
```

问题是当用户打开/保存文件时，路径指向该文件夹，但在客户端 PC 中而不是在服务器中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:55:54.020

如果您在服务器内部通过 PHP 处理 PDF，您应该`file:///`从 URL 中省略 。

所以应该是

```
$pdf="c:/pdfs/example.pdf"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T18:14:49.177

你现在正在做的是

1.  Javascript 在单击时在表单的 pdf 字段中输入值`c:\pdfs\example.pdf`并将其提交到 downloadpdf.php。
2.  在服务器上，Downloadpdf.php 将 $_POST["pdf"] 值分配给 $pdf。
3.  如果文件 $pdf 存在，它只是继续提供用户下载此文件。

现在，这**可能**适用于服务器和客户端是同一台计算机的情况（特别是在 PC 上，因为`C:`驱动器）；即喜欢本地XAMPP。但是在现实世界中，用户和服务器将在完全不同的计算机上，`if (file_exists($pdf))`总是会失败（除非在服务器上`C:`实际上文件`exaple.pdf`夹中有一个文件`pdfs`）在现实世界中，第 3 步将失败，因为 $pdf =`c:\pdfs\example.pdf`并且服务器将查看*它自己的* `C:`驱动器（如果它是 Windows 服务器）。
你应该

1 尝试使用 HTML 文件上传框上传文件。
2 使用 $_FILES 在服务器上获取/获取它并进行处理
3\. 发送所需的标头以进行下载。

有关详细信息，请参阅[HTML 表单文件上传 (Google)](https://www.google.co.in/search?q=html+form+file+upload)和 [$_FILES (PHP.Net)](http://php.net/manual/en/reserved.variables.files.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T16:53:28.620

服务器不知道客户端 PC，因此`readfile`在这里不起作用。

您可能想尝试重定向，但我必须承认我不知道浏览器是否出于安全原因允许这样做（您正在使用重定向切换协议）。

# javascript - 同步 span 和 textarea 滚动条 - 滚动条稍微偏离和粘贴问题

> ID：11399630
> 
> 赞同：0
> 
> 时间：2012-07-09T16:51:56.503
> 
> 标签：javascript, css

我按以下方式设置了一个表格，每个单元格都包含一个跨度和一个文本区域：

```
<table>
   <tr><td class="title">Original File</td></tr>
   <tr><td><span id='ogline' onscroll="og.scrollTop=scrollTop"></span><span><textarea onscroll="ogline.scrollTop=scrollTop" onkeyup="linenumber()" id='og' onfocusout="linenumber()"></textarea></span></td></tr>
</table> 
```

除此之外，我还有以下 CSS：

```
<style>
span {
  width:93%;
  height: 100%;
}
textarea {
  width:92%;
  height: 100%;
  border-style:solid;
  border-color:black;
  border-width:2px;
  font-size:13px;
}
table {
  width:100%;
  height:100%;
}
.title {
  height:5%;
  text-align:center;
  background-color:#009;
  color:white;
}
#ogline {
  padding-top:4px;
  overflow:auto;
  font-size:12px;
  line-height:14.99px;
  width:6%;
}
</style> 
```

我想要做的是让 span 的滚动条和 textarea 的滚动条同步。我使用 onscroll 事件侦听器和以下代码在某种程度上实现了这一点：

```
onscroll="og.scrollTop=scrollTop"
onscroll="ogline.scrollTop = scrollTop 
```

这在一定程度上实现了我想要的效果，跨度大约偏离了它应该在的位置。我遇到的最大问题是当我将大量文本粘贴到文本区域时。这几乎完全不起作用，两个滚动条都完全关闭，直到我按住其中一个滚动条很长一段时间，然后另一个滚动条将尝试赶上另一个滚动条。

有什么建议么？我应该尝试解决这个问题的更好方法吗？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T18:48:40.113

这可以工作：

```
var scrolling=false;

function og_scroll(el)
{
    if (scrolling && el!=scrolling) {
        return;
    }
    scrolling = el;
    var textareas = document.getElementsByTagName('textarea');
    for (var i=0; i<textareas.length; i++) {
        if (textareas[i].id.indexOf('og')==0) { // searching for id==og*
            textareas[i].scrollTop=el.scrollTop;
        }
    }
    scrolling = false;
}

function up(num)
{
    var area = document.getElementById('og'+num);
    if (area.scrollTop > 0) {
        area.scrollTop -= 15;
    }
}

function down(num)
{
    var area = document.getElementById('og'+num);
    if (area.scrollTop < area.scrollHeight) {
        area.scrollTop += 15;
    }
}

function fix_mouse_scroll() {
    var textareas = document.getElementsByTagName('textarea');
    for (var i=0; i<textareas.length; i++) {
        if (textareas[i].id.indexOf('og')==0) {
            if ("onmousewheel" in document) {
                textareas[i].onmousewheel = fixscroll;
            } else {
                textareas[i].addEventListener('DOMMouseScroll', fixscroll, false);
            }
        }
    }
}

function fixscroll(event){
    var delta=event.detail? event.detail : event.wheelDelta; // positive or negative number
    delta = delta>0 ? 15 : -15;
    event.target.scrollTop += delta;
    //console.log(delta, ' with ',event.target.scrollTop);
} 
```

html部分：

```
<tr><td> <span onmousedown='up(1)'>[UP]</span> <span onmousedown='down(1)'>[DOWN]</span> <textarea id='og1' onscroll="og_scroll(this);"></textarea></td></tr>
<tr><td> <span onmousedown='up(2)'>[UP]</span> <span onmousedown='down(2)'>[DOWN]</span> <textarea id='og2' onscroll="og_scroll(this);"></textarea></td></tr>
<tr><td> <span onmousedown='up(3)'>[UP]</span> <span onmousedown='down(3)'>[DOWN]</span> <textarea id='og3' onscroll="og_scroll(this);"></textarea></td></tr> 
```

完整的 html 代码在[这里](http://pastebin.com/NSk9CptY)。

# vb.net - 如何验证 vb.net 中的文本框长度？

> ID：11399631
> 
> 赞同：1
> 
> 时间：2012-07-09T16:52:04.540
> 
> 标签：vb.net, validation, customvalidator, rangevalidator

在 VB.NET 中，我正在尝试验证

> `<asp:textbox id="name" runat=server> </asp:textbox>`

文本框值不应超过 200 个字符，并且文本框只接受字符串。

哪个验证器会是一个不错的选择？我想使用自定义验证器，它可以与字符串值一起使用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:57:28.700

```
 <asp:RegularExpressionValidator ID="regexTextBox1"
 ControlToValidate="YourTextBoxID" runat="server" 
 ValidationExpression="^[\s\S]{0,200}$" Text="200 characters max" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T18:48:10.880

您可以完全避免使用自定义验证器。
如果您只需要强制文本框字段的最大长度，您可以使用它

```
<asp:TextBox MaxLength="200" id="name" runat=server> </asp:TextBox> 
```

# django - Django/Celery 和 CloudAMQP/Heroku 的连接错误

> ID：11399642
> 
> 赞同：4
> 
> 时间：2012-07-09T16:53:01.463
> 
> 标签：django, heroku, celery, cloudamqp

我有一个已经部署到 Heroku 的 Django 应用程序。这个应用程序使用 Celery 进行消息队列，我已经使用 RabbitMQ 在本地运行它，没有发生任何事故。

不幸的是，当我将这个婴儿部署到 Heroku 时，我发现 RabbitMQ 插件不可用，我必须使用 CloudAMQP。CloudAMQP 和 Heroku 的文档让我相信我可以使用 Celery（即使他们推荐 Pika），但是当我尝试部署时，我的调度程序和工作进程都会遇到严重的连接错误。以下是确切的错误：

```
2012-07-09T16:46:22+00:00 app[scheduler.1]: [2012-07-09 11:46:22,234: ERROR/Beat] Celerybeat: Connection error: [Errno 111] Connection refused. Trying again in 2.0 seconds...
2012-07-09T16:46:23+00:00 app[worker.1]: [2012-07-09 11:46:23,852: ERROR/MainProcess] Consumer: Connection Error: [Errno 111] Connection refused. Trying again in 2 seconds... 
```

我应该注意我的 Heroku 配置变量确实有一个 CLOUDAMQP_URL，所以这应该不是问题吗？

如果有人将 CloudAMQP 与 Django/Heroku 一起使用，我将不胜感激，可以给我一些关于如何确保 Celery 可以与代理连接的指导。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-10T11:54:57.630

您可能超出了免费计划的 3 个并发连接限制。将 [BROKER_POOL_LIMIT](http://celery.github.com/celery/configuration.html#std:setting-BROKER_POOL_LIMIT)设置为 1，它应该会更好地工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-15T20:06:33.453

Make sure that you have this at the top of your `settings.py` file.

```
import djcelery
djcelery.setup_loader() 
```

# android - 工厂擦除后的Android设备如何仍然记得应用程序激活码？

> ID：11399647
> 
> 赞同：0
> 
> 时间：2012-07-09T16:53:30.963
> 
> 标签：android, google-play

当用户为高级订阅应用程序付费时，如果该设备被工厂擦除，激活码会怎样？它不能存储在 SharedPreferences 中 - Google Play 呢？我注意到一些应用程序能够在工厂擦除后恢复激活码。这怎么可能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T16:56:22.320

很可能是因为它们存储在云中，在他们的服务器上，并且当您重新连接到他们知道的公认帐户时。该公认帐户也可能是 Google 帐户。例如，Windows 8 Metro 带有自己的基于云的存储，用于链接到人们的真实账户的应用程序

此外，某些应用程序可能会将激活文件存储在 SD 卡上或归档。工厂刷卡并不总是意味着格式化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:03:07.230

共享的偏好可以备份并恢复到谷歌的云，或者更具体地说：

[https://developers.google.com/android/backup/](https://developers.google.com/android/backup/)

# c - Unix：为什么在 ASCII 之后停止读取 C 中的宽字符？

> ID：11399648
> 
> 赞同：1
> 
> 时间：2012-07-09T16:53:41.200
> 
> 标签：c, linux, unicode, locale, glibc

characters.txt 的内容（从 od -c 输出）：

```
0000000   %   (   )   *   +   ,   -   .   /   0   1   2   3   4   5   6
0000020   7   8   9   <   =   >   ?   [   ]  \n   A   B   C   D   E   F
0000040   G   H   I   J   K   L   M   N   O   P   Q   R   S   T   U   V
0000060   W   X   Y   Z  \n   a   b   c   d   e   f   g   h   i   j   k
0000100   l   m   n   o   p   q   r   s   t   u   v   w   x   y   z  \n
0000120 316 223 316 224 316 230 316 233 316 236 316 243 316 246 316 250
0000140 316 251 316 261 316 262 316 263 316 264 316 265 316 266 316 267
0000160 316 270 316 271 316 272 316 273 316 274 316 275 316 276 316 277
0000200 317 200 317 201 317 202 317 203 317 204 317 205 317 206 317 207
0000220 317 210 317 211  \n 
```

也就是说，一些 ASCII 后跟一些 UTF-8 中的希腊语。我想阅读这些字符（以下是在 glibc 信息页面中给出的示例之后编写的）

```
wint_t* read_characters() {
    char *filename = "characters.txt";
    FILE *infile;
    infile = fopen (filename, "rb");
    printf ("File orientation: %d\n", fwide (infile,0));
    static wint_t b[16384], c, *p;
    p = b;
    while ((p-b)<sizeof(b)-4 && (c = fgetwc (infile)) != WEOF)
        *p++ = c;
    *p++ = WEOF;
    printf("\nRead %ld wint_t chars from characters.txt\n", p-b);
    return b;
} 
```

输出是：

> 文件方向：0 从 characters.txt 中读取 81 个 wint_t 字符

这意味着阅读以第一个希腊字符停止。为什么？我没有使用可以伪造 WEOF 的带符号变量。谁能帮忙？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T07:51:19.383

解决方案（由 nm 提示）是包含此调用

```
setlocale(LC_ALL, "en_US.UTF-8"); 
```

**即使全局设置了 LC_ALL，这也是必要的**，因为 C 程序总是以“C”语言环境开始。如果你想使用其他东西，你总是必须设置它。

# forms - Symfony2 - 翻译实体字段类型选项

> ID：11399655
> 
> 赞同：1
> 
> 时间：2012-07-09T16:54:05.143
> 
> 标签：forms, entity, translation, symfony-2.1

我正在使用 FormBuilder 来创建我的表单。这很好用。问题是我的“许可证对象”，它创建了一个带有选项的选择字段。这些选项应该被翻译。但是怎么做呢？

```
$form = $this   ->createFormBuilder($request)
                    ->add('title', 'text',
                        array(  'label' => $this->get('translator')->trans('form.title', array(), 'client_request_a_photo'))
                    )
                    ->add('description', 'textarea',
                        array(  'label' => $this->get('translator')->trans('form.description', array(), 'client_request_a_photo'))
                    )
                    ->add('licence','document',
                       array('class'=>'WunschbildBundle\Document\Licence', 'property'=>'options', 
                          'label' => $this->get('translator')->trans('form.licence', array(), 'client_request_a_photo'))
                    )                      
                    ->getForm(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T08:59:59.993

在任何情况下，您都没有提供什么是“文档”字段类型，所以我们帮不上什么忙。但是，据我了解，这些选项是通过“许可证”对象的“选项”属性获取的。如果您希望翻译这些内容，则对象“许可证”必须是可翻译的，并且属性“选项”必须具有翻译。您可以通过使用学说扩展包来做到这一点。可在[此处](https://github.com/l3pp4rd/DoctrineExtensions/blob/master/doc/translatable.md)找到有关 Translatable 的文档。希望这有帮助。

# java - 哪种表示可以是'\r\x00\x00\x00'（如果我通常有十六进制代码：'\x0\x00\x00\x03'）

> ID：11399658
> 
> 赞同：1
> 
> 时间：2012-07-09T16:54:08.753
> 
> 标签：java, hex, representation, klee

我正在使用一个程序（klee）来测试 c 代码。我需要在我的程序中使用结果。

它不是可读的信息，但有些解决方案是十六进制数据，格式如下：'\x0e\x00\x00\x00' 我已经询问过如何将其转换为整数，我找到了解决方案。

我也必须在结构中引入这种结果，我会知道大小，但会知道字段或其他任何相关信息。

我想我可以解决这个问题，但现在的问题是，有时您可以获得以下内容： '\n\x00\x00\x00'= 13 或 '\r\x00\x00\x00' = 10

而且我没有找到他们使用哪种表示形式将其转换为可读信息。显然我可以在 python 中解决这个问题： import struct selection = struct.unpack('

我对pyton一无所知，我想在java或c中找到一个解决方案。非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:57:53.190

Windows 系统使用该值`\n\r`来指示换行 -`\n`移动到新行，并将`\r`写指针移动到行的开头。我在想您可能有一些包含换行符的字符数据，其中每个字符都转换为大端格式的 32 位整数值。

希望这可以帮助！

# python - ConfigParser 的新行？

> ID：11399665
> 
> 赞同：12
> 
> 时间：2012-07-09T16:54:41.700
> 
> 标签：python

我有一个使用的配置文件`configParser`：

```
<br>
[ section one ]<br>
one = Y,Z,X <br><br>
[EG 2]<br>
ias = X,Y,Z<br> 
```

我的程序可以很好地读取和处理这些值。

但是，某些部分将非常大。我需要一个允许值位于新行的配置文件，如下所示：

```
[EG SECTION]<br>
EG=<br>
item 1 <br>
item 2 <br>
item 3<br>
etc... 
```

`string.split()`在我的代码中，我有一个简单的函数，它使用显然现在设置为逗号的值的分隔符（或分隔符） 。我已经尝试过`\n`不起作用的转义字符串。

有谁知道这是否可以通过 python 的配置解析器实现？
[http://docs.python.org/library/configparser.html](http://docs.python.org/library/configparser.html)

```
# We need to extract data from the config 
def getFromConfig(currentTeam, section, value, delimeter):
    cp = ConfigParser.ConfigParser()
    fileName = getFileName(currentTeam)
    cp.read(fileName)
    try:
        returnedString = cp.get(section, value)
    except: # The config file could be corrupted
        print( "Error reading " + fileName + " configuration file." )
        sys.exit(1) #Stop us from crashing later
    if delimeter != "": # We may not need to split
        returnedList = returnedString.split(delimeter)
    return returnedList 
```

我会用这个：

```
taskStrings = list(getFromConfig(teamName, "Y","Z",",")) 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-09T18:45:19.943

ConfigParser`_read()`方法的文档字符串说：

> 延续由嵌入的换行符表示，然后是前导空格。

或者（正如 Python 3 中的版本所说）：

> 值可以跨越多行，只要它们的缩进比值的第一行更深。

此功能提供了一种将值拆分并跨多行“继续”它们的方法。例如，假设您有一个名为的配置文件`'test.ini'`，其中包含：

```
[EG SECTION]<br>
EG=<br>
  item 1<br>
  item 2<br>
  item 3<br> 
```

您可以使用如下代码将 中的值读`EG`入`EG SECTION`列表：

```
try:
    import ConfigParser as configparser
except ImportError:  # Python 3
    import configparser

cp = configparser.ConfigParser()
cp.read('test.ini')

eg = cp.get('EG SECTION', 'EG')
print(repr(eg))  # -> '\nitem 1\nitem 2\nitem 3'

cleaned = [item for item in eg.strip().split('\n')]
print(cleaned)  # -> ['item 1', 'item 2', 'item 3'] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T17:03:49.760

这似乎是可能的。例如，在我自己的配置文件中，我有一个带有元组的列表对象：

```
[root]
path: /
redirectlist: [ ( r'^magic', '/file' ),
    ( r'^avplay', '/file' ),
    ( r'^IPTV', '/file' ),
    ( r'^box', '/file' ),
    ( r'^QAM', '/qam' ),
    ( r'.*opentv.*', '/qam' ),
    ( r'.+', '/file' ) ] 
```

我这样做：

```
redirectstr = _configdict.get('root', 'redirectlist')
redirects = eval(redirectstr) 
```

请注意，我实际上是在评估那条线，如果在野外使用可能会导致安全漏洞。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-07-09T07:25:18.430

[https://docs.python.org/3/library/configparser.html#supported-ini-file-structure](https://docs.python.org/3/library/configparser.html#supported-ini-file-structure)

> 值也可以跨越多行，只要它们的缩进比值的第一行更深。根据解析器的模式，空行可能被视为多行值的一部分或被忽略。

```
[Multiline Values]
chorus: I'm a lumberjack, and I'm okay
    I sleep all night and I work all day 
```

```
[Section]
key = multiline
  value with a gotcha

 this = is still a part of the multiline value of 'key' 
```

对于你的情况

```
[EG SECTION]<br>
EG=<br>
item1<br>
item2<br>
item3<br>

eg = cp.get('EG SECTION', 'EG')
print(eg) 
```

会得到一些错误：源包含解析错误：这是“无价值”错误。

项目 1 将被视为没有值的新选项项目 2,3 相同，而 EG=
获取空白值

如果您使用“allow_no_value=True”修改它们

```
[EG SECTION]<br>
EG=<br>
item1<br>
item2<br>
item3<br>

cp = ConfigParser.ConfigParser(allow_no_value=True)
eg = cp.get('EG SECTION', 'EG')
print(eg) 
```

你会得到空白屏幕输出，因为 EG=

最后，添加一些缩进和拆分功能

```
[EG SECTION]<br>
EG=<br>
 item1<br>
 item2<br>
 item3<br>

cp = ConfigParser.ConfigParser()
eg = cp.get('EG SECTION', 'EG').split('\n')
print(eg) 
```

你会得到`['item1', 'item2', 'item3']`

# javascript - jQuery替换标记的文本

> ID：11399668
> 
> 赞同：6
> 
> 时间：2012-07-09T16:54:53.187
> 
> 标签：javascript, jquery, replace

我正在尝试替换元素中特定的突出显示（标记）文本。

到目前为止，这就是我获得突出显示的文本的方式：

```
var markArea = $('.ElementText textarea').get(0);
var text     = markArea.value.substring(markArea.selectionStart, markArea.selectionEnd);
```

因此，如果我在 textarea 中有这样的内容：“applebanana apple orange”并标记第三个单词（apple），我想完全替换我标记的内容，而不在 textarea 中出现任何其他“apple”。

有没有办法指定代码应该在字符串中寻找替换的开始和结束区域？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T17:07:24.720

你可以试试这样的

```
var markArea = $('.ElementText textarea').get(0);
var startStr = markArea.value.substring(0,markArea.selectionStart);
var endStr   = markArea.value.substring(markArea.selectionEnd);
var text     = startStr +"REPLACEMENT VALUE HERE"+ endStr;    
$('.ElementText textarea').val(text); 
```

我会玩这个，它可能会在 startStr 或 endStr 上偏离 1 （我总是把它搞砸：/ ）但这应该做你想做的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-09T17:14:49.757

在上面的答案之前写了这个，但我会保留它，因为它只是编写代码的另一种方式/不使用 jQuery：

```
function replaceAtIndex(str,s,e,rep){
   return str.slice(0,s) + rep + str.slice(e);
}

markArea.value = replaceAtIndex(markArea.value,markArea.selectionStart,markArea.selectionEnd,"replacement"); 
```

# jquery - Backbone JS - 在嵌套子模型更改时更新父模型集合

> ID：11399669
> 
> 赞同：0
> 
> 时间：2012-07-09T16:55:01.850
> 
> 标签：jquery, backbone.js, underscore.js

我有一个带有一组子模型的父模型。对于每个子模型，我想用数据呈现一个表单，然后在任何表单发生更改时更新父模型：

在父模型视图中：

```
render: function () {    
    _.each(this.model.get('myChildModelCollection').models, function (myChildModel) {
       var childForm = new ChildFormView({model: myChildModel}) 
       childForm.model.on('change', function () {
              //DO SOMETHING HERE TO UPDATE THE PARENT MODEL COLLECTION
       })
       this.$("#child-list").append(childForm.render().el);
    });
} 
```

更改事件被触发，但我不知道在父模型集合中引用正确子模型的正确方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:18:04.653

假设您真的想在视图中设置绑定，您可以将渲染方法重写为

```
render: function () {
    var parent=this.model, coll=parent.get('myChildModelCollection');

    // Backbone proxies Underscore methods on its collections
    coll.each(function (myChildModel) {
        var childForm = new ChildFormView({model: myChildModel}) 
        this.$("#child-list").append(childForm.render().el);
    });

    coll.on('change', function(model) {
        // do what you have to do with 
        // parent as your parent model,
        // coll as your collection,
        // model set to the modified child 
    });
} 
```

请注意，当在父模型或集合中进行控制时，此类绑定可能会更有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:07:10.300

This is something that came to my mind:

```
 render: function () { 
        var that = this;   
        _.each(this.model.get('myChildModelCollection').models, function (myChildModel) {
           var childForm = new ChildFormView({model: myChildModel}) 
           childForm.model.on('change', function () {
                that.renderTheCollection();
           })
           this.$("#child-list").append(childForm.render().el);
        });
    }, 
    renderTheCollection : function() {
        _.each(this.model.get('myChildModelCollection').models, function (myChildModel) {
              // Update
        }
     } 
```

# java - HTML 5 音频标签 - 从 PHP 或 Java servlet 采购？

> ID：11399671
> 
> 赞同：-1
> 
> 时间：2012-07-09T16:55:27.307
> 
> 标签：java, php, html, audio

我需要从客户端应用程序无法直接访问的位置流式传输音频。为此，我正在调查使用 Java servlet 或 PHP 根据需要创建流。

以前有人做过吗？

这将如何处理 <audio> 标签中的跳过/查找命令？

有什么办法可以防止客户端缓存音频？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:57:23.837

使用它来阻止缓存：

```
header("Cache-Control: no-cache, must-revalidate"); 
```

一定有人这样做是为了保护受版权保护的音乐。

它仍然可以与跳过和搜索标签一起正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:07:18.577

> 以前有人做过吗？

是的，我很确定这已经完成了。如果您正在寻找代码，请参阅[HTTP_Download](http://pear.php.net/package/HTTP_Download/)。

> 这将如何处理`<audio>`标签中的跳过/查找命令？

在服务器端没有什么可做的。您的浏览器会处理这个问题。如果您想在浏览器中处理该问题，请查阅您的浏览器技术规范，了解`<audio>`您的浏览器支持的 HTML 标记的功能。

> 有什么办法可以防止客户端缓存音频？

一点也不。数据的当前副本在客户端可用，否则浏览器无法播放/跳过/搜索媒体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T14:59:11.223

如果您从脚本生成音频标签，那么您可以通过在示例文件名的末尾添加一个虚拟 GET 变量来强制重新加载示例。像这样的东西...

```
echo "<source src=\"sample.php?rand=" . rand(1,99999) . "\" />\n"; 
```

# c - 字符串文字的 C 优化

> ID：11399682
> 
> 赞同：22
> 
> 时间：2012-07-09T16:56:12.897
> 
> 标签：c, string, gcc, compiler-optimization, string-pool

我刚刚在 gdb 中检查了以下内容：

```
char *a[] = {"one","two","three","four"};
char *b[] = {"one","two","three","four"};
char *c[] = {"two","three","four","five"};
char *d[] = {"one","three","four","six"}; 
```

...我得到以下信息：

```
(gdb) p a
$17 = {0x80961a4 "one", 0x80961a8 "two", 0x80961ac "three", 0x80961b2 "four"}
(gdb) p b
$18 = {0x80961a4 "one", 0x80961a8 "two", 0x80961ac "three", 0x80961b2 "four"}
(gdb) p c
$19 = {0x80961a8 "two", 0x80961ac "three", 0x80961b2 "four", 0x80961b7 "five"}
(gdb) p d
$20 = {0x80961a4 "one", 0x80961ac "three", 0x80961b2 "four", 0x80961bc "six"} 
```

我真的很惊讶字符串指针对于等效单词是相同的。我原以为每个字符串都会在堆栈上分配自己的内存，而不管它是否与另一个数组中的字符串相同。

这是某种编译器优化的例子，还是这种字符串声明的标准行为？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-07-09T17:06:26.323

它被称为“字符串池”。它在 Microsoft 编译器中是可选的，但在 GCC 中不是。如果您在 MSVC 中关闭字符串池，那么不同数组中的“相同”字符串将被复制，并且具有不同的内存地址，因此会占用额外（不必要的）50 字节左右的静态数据。

编辑：v 4.0 之前的 gcc 有一个选项，`-fwritable-strings`它禁用了字符串池。此选项的效果是双重的：它允许覆盖字符串文字，并禁用字符串池。因此，在您的代码中，设置此标志将允许有些危险的代码

```
/* Overwrite the first string in a, so that it reads 'xne'.  Does not */ 
/* affect the instances of the string "one" in b or d */
*a[0] = 'x'; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-09T16:58:04.703

（我假设您的`a`,`b`和`c`被`d`声明为局部变量，这是您与堆栈相关的期望的原因。）

C 中的字符串文字具有静态存储持续时间。它们永远不会在“堆栈上”分配。它们总是分配在全局/静态内存中并且“永远”存在，即只要程序运行。

您`a`的`b`、`c`和`d`数组在堆栈上分配。存储在这些数组中的指针指向静态内存。在这种情况下，相同单词的指针相同并没有什么不寻常的。

编译器是否会将相同的文字合并为一个取决于编译器。一些编译器甚至有一个选项来控制这种行为。字符串文字始终是只读的（这就是为什么`const char *`对数组使用类型是一个更好的主意），因此在您开始依赖实际指针值之前，它们是否被合并并没有太大区别。

PS只是出于好奇：即使这些字符串文字是在堆栈上分配的，为什么您会期望相同的文字多次“实例化”？

# c# - 赛事管理应用——如何管理球员和球队？

> ID：11399684
> 
> 赞同：2
> 
> 时间：2012-07-09T16:56:23.490
> 
> 标签：c#, .net, database, database-design, data-modeling

我正在编写一个射箭锦标赛管理应用程序。此应用程序将在没有互联网连接的法官的笔记本电脑上运行。

它可以轻松管理球员、球队及其得分和积分。我正在用 C# .NET 编写。

**我的问题：**

大约有100名球员被分成大约20支球队。存储有关球员和球队的信息的最佳方式是什么？如何将该信息保存到光盘？我无法在法官的 PC 上安装任何其他软件（所以没有本地 MySQL）。

你能给我一些想法吗？

也许将来会有不止一个人同时输入乐谱（可能的 LAN 连接）。如何适应这种情况？（这不太重要，现在我需要 1 个 pc 功能）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T17:01:24.817

如果使用 DataTables 创建 DataSet，则可以将表保存为 XML。如果您将域与其他代码分开，您可以轻松地将数据集替换为数据库，请参阅存储库模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T17:01:37.033

SQLite 可能是要走的路。它是一个不需要单独安装的嵌入式数据库（换句话说，您可以将它与您的程序一起安装。）

# java - javacv中getStructuringElement()的等价方法是什么？

> ID：11399686
> 
> 赞同：2
> 
> 时间：2012-07-09T16:56:35.127
> 
> 标签：java, opencv, javacv

我正在开发使用图像处理技术的项目。我使用 javacv 包作为调用 opencv 方法的接口。因此，opencv 有很多教程和材料，但 javacv 可用的材料数量较少。所以我找到了一个方法调用getStructuringElement()。

请问有人能解释一下javacv中的类似方法以及这种方法的目的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T17:43:52.747

这是`cvCreateStructuringElementEx`.

这是使用它的简单[示例](http://javacv-examples.googlecode.com/svn-history/r24/trunk/OpenCV2_Cookbook/src/main/scala/opencv2_cookbook/chapter05/Ex1ErodingAndDilating.scala)。

# yum - 在 rpmforge 存储库中找不到用于 linux 的保险丝

> ID：11399687
> 
> 赞同：0
> 
> 时间：2012-07-09T16:56:36.657
> 
> 标签：yum, fuse, rhel5

我正在尝试通过 yum 在我们的 RHEL5 实例上安装 fuse。它在我的 yum 列表中不可用。

检查后，一些站点建议启用 rpmforge repo 将提供 yum 中的软件包进行安装。我启用了 rpmforge repo（RHEL5 的最新版本），但也没有保险丝。

我也尝试过使用 EPEL repo，结果相同。

谁能帮我找到这个的根本原因？

注意：我可以使用 src 安装 fuse，但这不适用于我尝试安装的其他软件 (s3fs)，这就是为什么我需要 yum 才能工作，这样我才能拥有所需的所有最新软件包。

谢谢您的帮助。

——诺曼 A。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-22T10:17:13.880

FUSE (kmod-fuse) 已从 RPMforge 转移到 ELRepo，因为 ELRepo 专注于 RHEL 和衍生发行版（如 CentOS 或 Scientific Linux）的硬件支持。

[http://elrepo.org/](http://elrepo.org/)

请注意，在 RHEL5 的最新版本中，FUSE 是内核的一部分。

# mule - 使用 XPath Evaluator 选择骡子

> ID：11399689
> 
> 赞同：0
> 
> 时间：2012-07-09T16:56:49.667
> 
> 标签：mule

在下面的 mule 流程中，我使用 xpath 来决定需要将消息发送到哪个队列。然而，xpath 表达式返回 false，即使 XML 具有 tc="121"。你能告诉我我做错了什么吗？

下面是 XPath 评估的 mule 流和 XML。

骡流：

```
<flow name="ProcessXMLRequest">
    <jms:inbound-endpoint exchange-pattern="one-way" queue="mq.xml.request" />
    <logger message="XML payload is #[payload]" level="INFO" />
    <choice>
        <when expression="/TXLife/TXLifeRequest/TransType/@tc='121'"
            evaluator="xpath">
            <jms:outbound-endpoint queue="mq.121.request.apps" />
        </when>
        <when
            expression="/TXLife/TXLifeRequest/TransType/@tc='1122'"
            evaluator="xpath">
            <jms:outbound-endpoint queue="mq.1122.request.apps" />
        </when>
        <otherwise>
            <jms:outbound-endpoint queue="mq.error"/>
        </otherwise>
    </choice>
</flow> 
```

XML:

```
<TXLife xmlns:ns2="http://abc.com/services/mvi" xmlns="http://ACORD.org/Standards/Life/2">
    <TXLifeRequest PrimaryObjectID="Holding_1">
        <TransType tc="121">121</TransType>
        <TransMode tc="2">2</TransMode>
    </TXLifeRequest>
</TXLife> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T20:15:30.120

这是一个命名空间问题：您需要配置`http://ACORD.org/Standards/Life/2`命名空间并在 XPath 表达式中使用它。

在 Mule 中，这是通过[命名空间管理器](http://www.mulesoft.org/documentation/display/MULE3USER/XML+Namespaces)以如下方式实现的：

```
<mulexml:namespace-manager>
  <mulexml:namespace prefix="life2" uri="http://ACORD.org/Standards/Life/2"/>
</mulexml:namespace-manager> 
```

# asp.net - 样式化 AsyncFileUpload 控件

> ID：11399692
> 
> 赞同：0
> 
> 时间：2012-07-09T16:56:59.897
> 
> 标签：asp.net, ajax

我一直在尝试格式化 AsyncFileUpload 控件一段时间，但我只是想不出一种方法来做到这一点。我尝试了一些在设置通用输入类型和 ASP.NET Web 窗体 FileUpload 控件样式时有效的方法，例如将不透明度设置为 0 并将浏览按钮隐藏在其他元素之上，但这些技术似乎都没有有效工作在 AsyncFileUpload 上。有没有人有某种方法可以对这个控件应用一些样式？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T17:10:17.687

不确定这是您要找的东西，但我希望它对您有所帮助 [http://www.shauninman.com/archive/2007/09/10/styling_file_inputs_with_css_and_the_dom](http://www.shauninman.com/archive/2007/09/10/styling_file_inputs_with_css_and_the_dom) [http://www.webresourcesdepot.com/aspnet-flash-file-支持 s3 的上传器/](http://www.webresourcesdepot.com/aspnet-flash-file-uploader-with-s3-support/)

# php - 是否可以“喜欢”一个 OpenGraph 对象？

> ID：11399700
> 
> 赞同：2
> 
> 时间：2012-07-09T16:57:48.027
> 
> 标签：php, facebook-like, facebook-opengraph

我在将我网站中的 Facebook Like 按钮与 OpenGraph 对象链接时遇到问题。

几天以来，我更新了我的网站的元数据，将特定网站声明为不同的 OG 对象。这工作正常，因为
- Facebook 调试器正在接受 URL 并将它们识别为没有错误的 OG 对象
- 我的应用程序的洞察力向我展示了从这些更改生效的那一刻起，对象生命周期的一个非常大的增量

在这一点上，我预计在每个网站中按下的每个点赞按钮都会发布类似于
“用户 1 喜欢 App 上的 ObjectTitle”的内容，
但生成的消息仍然是“用户 1 喜欢链接”或“用户 1 喜欢页面”

真的不可能将原始的 Facebook Like Button 与 OpenGraph 对象连接起来吗？
我是否需要创建“内置赞”才能在用户时间轴中发布这样的故事？
我在这里想念什么吗？或者有人有同样的问题吗？

谢谢！我感谢任何形式的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T06:18:30.893

> 真的不可能将原始的 Facebook Like Button 与 OpenGraph 对象连接起来吗？

是的，这正是你正在做的。您所有经过调试和喜欢的 URL 现在都是 Graph 上的对象。

> 我是否需要创建“内置赞”才能在用户时间轴中发布这样的故事？

是的，您需要使用内置的点赞操作来实现此目的，但如果您的推理不足以不使用常规的点赞按钮，Facebook 很可能会拒绝您提交操作的请求。

您需要一个与常规文章页面显着不同的对象（例如食谱）

# javascript - Android 4.0“冰淇淋三明治”中不一致的 TOUCHSTART 事件

> ID：11399707
> 
> 赞同：2
> 
> 时间：2012-07-09T16:58:04.720
> 
> 标签：javascript, android, button, android-4.0-ice-cream-sandwich, touchstart

我注意到`BUTTON`元素`TOUCHSTART`在 Android 4.0 中接收事件的方式非常不一致。我在特定`BUTTON`的`TOUCHSTART`,`MOUSEDOWN`和`CLICK`事件上添加了事件侦听器，并且在我们所有的冰淇淋三明治测试设备上，`TOUCHSTART`事件很少且不一致地触发，而`MOUSEDOWN`and`CLICK`事件每次都触发。

通常我只会依赖其他两个事件并完成它，但我现在正在从事的特定项目的负责人非常坚持`TOUCHSTART`在移动设备上使用该事件。

关于如何使用 Android 解决此问题的任何想法？

# magento - Magento 重置产品列表 查看全部

> ID：11399708
> 
> 赞同：0
> 
> 时间：2012-07-09T16:58:05.840
> 
> 标签：magento

Magento 版本 1.7.0.0

对，当客户更改类别时，我正在尝试将产品列表计数重置为默认值。

例如

客户访问 - 类别 A 显示默认产品 - 16 选择查看所有 查看所有产品 导航到 - 类别 B 显示全部不是 16。

我知道有一种方法可以在 toolbar.php 中更改它，但这是修改我试图避免的核心文件。有什么办法可以在不编辑核心文件的情况下做到这一点？

欢呼安迪。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T19:30:51.250

只需将其添加到您的模板文件中，它就可以解决问题：

`Mage::getSingleton('catalog/session')->unsLimitPage();`

希望能帮助到你！

# html - FireFox 不显示 CSS/脚本/图像（实际上来自子文件夹的任何内容）基本 HTML 站点，IIS7

> ID：11399709
> 
> 赞同：0
> 
> 时间：2012-07-09T16:58:14.820
> 
> 标签：html, css, firefox, iis

本地（在 IIS 之外）：在 IE/FireFox/Chrome 上一切正常

IIS：除 FireFox 外，一切正常。它不想加载我的任何子文件夹内容。

我已经用谷歌搜索了这个问题，因此......

1.  权限设置得当，（毕竟，它在其他浏览器中也能正常工作。）
2.  文件的路径也很好。（同样，只是 FireFox。）
3.  IIS 中的 .css MIME 类型是“text/css”。
4.  在 IIS 功能下检查静态内容。
5.  根据 Notepad++，（网站是用它制作的。），它是用 ANSI 编码的。（尝试了其他人，没有变化。）

在 FireBug > Net > All 中：它将页面和 Google 托管脚本以外的所有内容显示为“正在加载”。换句话说，任何本地都无法加载。（它们都存储在根目录的子文件夹中。）

文档类型：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 
```

<头>

```
<title>My Website</title>
<meta charset="ISO-8859-1" http-equiv="X-UA-Compatible" value="IE=9" />
<link rel="stylesheet" type="text/css" href="styles/clean.css" />
<link rel="stylesheet" type="text/css" href="styles/style.css" />
<noscript><link rel="stylesheet" type="text/css" href="styles/noscript.css" /></noscript>
<script type="text/javascript" src="scripts/jquery-1.7.1.js"></script>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript" src="scripts/script.js"></script>
<!--[if lt IE 10]>
<script type="text/javascript" src="scripts/pie.js"></script>
<script type="text/javascript" src="scripts/html5shiv.js"></script>
<script type="text/javascript" src="scripts/selectivizr.js"></script>
<![endif]--> 
```

拜托，你能想到的，我会很感激的。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T17:09:50.700

解决方案：

1.  清除浏览器缓存。看看这是否有效（它应该有效）。
2.  使用`~/`后跟路径。看看，如果这行得通。
3.  最后，如果没有任何效果，请使用绝对 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-28T09:43:38.370

我在 Firefox 中也遇到了这个问题，其中 css 和 javascript 文件没有得到应用我的解决方案是将 lang='en' 添加到 DOCTYPE 中，即`<!DOCTYPE html lang='en'>` 希望这会有所帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T17:20:00.920

你检查过 IIS 中的重写规则吗？使用 chrome 右键单击​​并检查页面的属性，转到资源并检查资源的链接。如果未加载它们，则很可能是 IIS 配置有问题……很可能是目录根目录、重写（重定向）规则或每个目录的权限有问题。

# bash - BASH，猫缓冲区

> ID：11399715
> 
> 赞同：1
> 
> 时间：2012-07-09T16:58:44.033
> 
> 标签：bash, queue, buffer, pipe, cat

```
cat report.txt | sed 's/<\/li>/<\/li> \n/g' > report.txt 
```

这显然会导致一个空文件。

是否有一种机制允许您在处理数据之前存储数据或存储输出直到命令完成执行然后写入文件？

[http://en.wikipedia.org/wiki/Pipeline_(Unix)#Implementation](http://en.wikipedia.org/wiki/Pipeline_%28Unix%29#Implementation)：

“...接收程序每秒可能只能接受 100 个字节，但不会丢失任何数据。相反，发送程序的输出被保存在一个队列中。当接收程序准备读取数据时，操作系统从队列中发送其数据，然后从队列中删除该数据。”

听起来应该有一个简单的技巧将其加载到队列中，而不是立即将其写入文件，然后在命令完成后将其卸载？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T17:02:06.187

您需要的是[*就地*](http://joemaller.com/823/quick-note-about-seds-edit-in-place-option/)编辑：

```
sed -i 's/<\/li>/<\/li> \n/g' report.txt 
```

# c++ - Eclipse CDT 自动完成功能不起作用

> ID：11399719
> 
> 赞同：39
> 
> 时间：2012-07-09T16:58:58.667
> 
> 标签：c++, eclipse, eclipse-cdt

我记得前段时间 Eclipse 在您键入时会自动完成，现在我只能在按`Ctrl`+时才能完成`Space`。我已经检查过并且没有任何未解决的依赖项，按下`Ctrl`+时我可以看到所有自动完成选项`Space`，但这不是我每次都喜欢做的事情......有人可以指出我的方向以获得自动 -完整回来？（使用 CDT C++）

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2013-04-22T03:41:59.850

最近某个时候（不确定，但自 2013 年 3 月以来？）我的 Eclipse`CDT`停止了自动完成。我发现在`Editor`-> `Content Assist`->`Advanced`检查`Parsing-based Proposals`让自动完成在我的机器上工作。

Ubuntu 12.10、Eclipse 4.2.2、CDT 8.1.2

![在此处输入图像描述](../Images/0a96ce017d76cbbf022ebe90cb015a96.png)

此快照显示`Task-Focused`，我在另一个`Eclipse`实例上看不到。在那种情况下，我刚刚检查`Parsing-based Proposals`并完成仍然有效。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2018-07-28T18:13:56.270

即使在 2018 年有 eclipse photon 时，这个问题也很有效。

1) 转到窗口 > 首选项 > C/C++ > 编辑器 > 内容辅助 > 高级。

2）选中“基于解析的提议（以任务为中心）”。

3）现在通过按“Ctrl + Space”绑定一个键。

[![在此处输入图像描述](../Images/54b1b5d193db7629d54d2409b4cdf4e4.png)](https://i.stack.imgur.com/fDSyA.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-26T11:30:08.610

我遇到了 Eclipse Juno (OSX Java "1.6.0_33") 的问题，其中自动完成（和保存键绑定）无法正常工作。谷歌搜索我发现这个：[Eclipse JUNO 没有启动](https://stackoverflow.com/questions/11310970/eclipse-juno-doesnt-start)

将我的 Mercurial 插件更新到最新版本 (1.9.1) 为我解决了这两个问题。

很奇怪。

# pointers - 从 String^ 转换为 String*

> ID：11399725
> 
> 赞同：1
> 
> 时间：2012-07-09T16:59:21.377
> 
> 标签：pointers, c++-cli

我目前有一个小问题，我认为这很容易，但不是，所以（也许很容易，但我不知道）我需要将 String^ 转换为 String^* 所以基本上是一个字符串指针，一小段代码：

```
ARPLC_command_byuser = textBox1->Text; 
```

我已经尝试了各种方法，但似乎都失败了（好吧，他们没有，我愿意）。

如果您有任何想法，请告诉我该怎么做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T17:15:12.260

那是不可能的。当垃圾收集器压缩堆时，托管对象在内存中移动。这将使任何指针无效。这是 C++/CLI 使用 ^ hat 来指示对象引用的主要原因，它们是在对象被移动时垃圾收集器可以识别和更新的指针。

从技术上讲，可以*固定*托管对象以确保它不会被移动。你可以用 pin_ptr<> 或 GCHandle::Alloc() 来做一些事情。应该避免这种情况。通过使用 Marshal 类将托管字符串复制到非托管内存中，将托管字符串转换为本机指针。

# sql - 在 Where 子句中使用 Case 语句

> ID：11399727
> 
> 赞同：-1
> 
> 时间：2012-07-09T16:59:33.987
> 
> 标签：sql, sql-server, sql-server-2005, case, where-clause

在我的查询中，我有以下条件

```
left Join Table2 on Table2.Id = Table1.Id and Table2.status in  ('Close', 'Open') 
```

由于左连接，上述条件给了我 2 额外的行。我注意到，如果条件中只有 Close 或 Open ，它会返回正确的行数。

为了解决这个问题，我试图写这样的东西

```
And  Table2.status = (Case Table2.status
                WHEN 'Open' Then 'Open'
                When 'Close' Then 'Close'   
                 End ) 
```

但这仍然返回 2 个额外的行。对于如何解决这个问题，有任何的建议吗？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:08:38.137

你可以这样做：

```
select *
from table1
    left join 
    (
         select id from table2 
         where status in ('open', 'close')
         group by id

    ) as table2
        on table1.id = table2.id 
```

这看起来很老套，但我目前似乎无法想出更好的东西。否则，您可以使用`DISTINCT`

```
select DISTINCT table1.*, table2.stuff
FROM Table1
    LEFT JOIN Table2
        on Table2.Id = Table1.Id and Table2.status in  ('Close', 'Open') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:12:28.133

关键是`DISTINCT`陈述。

```
SELECT DISTINCT Table1.* FROM Table1 
     LEFT JOIN Table2 ON Table2.Id = Table1.Id 
                      AND Table2.status in  ('Close', 'Open') 
```

# android - ListView 和 ContextMenu

> ID：11399728
> 
> 赞同：0
> 
> 时间：2012-07-09T17:00:02.130
> 
> 标签：android, listview, contextmenu

是否可以在 ListView 类中实现使用上下文菜单？这里没有 onContextItemSelected() 方法。我不想在 Activity 类中编写带有上下文菜单的代码。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T19:09:29.963

这会严重破坏 Android UI 模式。`Activity`（以及最近的版本`Fragment`）负责显示像菜单这样的小部件。将此功能下推到 a`View`将使您的应用程序变得神秘。

你可以通过定义一个接口来获得你想要的东西，比如`ContextPopupDelegate`在上下文菜单中构建和处理选择的功能，然后让你的新`View`实现这个接口。使用您的视图的任何活动都委托给接口方法。

# java - ServletRequest.getRemoteAddr 何时返回 IPv6

> ID：11399729
> 
> 赞同：3
> 
> 时间：2012-07-09T17:00:09.663
> 
> 标签：java, servlets, ip, ipv6

我正在进行 API 调用，该调用需要请求 IP 地址。我正在使用 ServletRequest.getRemoteAddr() 来获取请求的 IP。对于一位用户，getRemoteAddr() 返回的是 IPv6 而不是 IPv4，这是为什么？

据我了解，IPv6 是对 IPv4 的扩展，用户可以选择使用 IPv6 而不是 IPv4。这是否意味着用户或用户的 ISP 正在使用 IPv6？这是如何工作的......还有一种方法可以获得 IPv4 等价物吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T17:27:28.550

ipv6 不是 ipv4 的“扩展”，它是一种替代寻址方案。客户端是使用 ipv6 还是 ipv4 地址取决于客户端的配置（尽管客户端和服务器之间的中介需要兼容）。由于 ipv6 地址不向后兼容，因此无法获得与 ipv6 地址“等效”的 ipv4（但另一方面，有*一种*方法可以以与 ipv6 兼容的方式对 ipv4 地址进行编码）。

# jakarta-ee - 从实体类创建一个 JPA1 抽象类 findAll 方法

> ID：11399732
> 
> 赞同：0
> 
> 时间：2012-07-09T17:00:38.213
> 
> 标签：jakarta-ee, jpa, ejb

在抽象类中使用 an `EntityManager`，我正在尝试创建一个函数，该函数从实体类返回表中所有结果的列表。每个表都有自己的继承自抽象类的持久性类。到目前为止，我有：

```
public abstract class AbstractFacade<T> {
    private Class<T> entityClass;

    ...

    public List<T> findAll() {
        javax.persistence.criteria.CriteriaQuery cq = getEntityManager().getCriteriaBuilder().createQuery();
        cq.select(cq.from(entityClass));
        return getEntityManager().createQuery(cq).getResultList();
    }
} 
```

这适用于 JPA 2.0 但我刚刚发现我的服务器仅限于不支持`getCriteriaBuilder()`或不支持的 JPA 1.0`createQuery(CriteriaQuery cq)`

有没有一种方法可以重构我的代码以使用 JPA 1.0 中存在的机制做相对相同的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T17:12:24.647

您可以使用以下方法：

```
public List<T> findAll() {
    return (List<T>) getEntityManager().createQuery(
        "select e from " + entityClass.getSimpleName() + " e")
        .getResultList();
} 
```

请注意，如果您覆盖逻辑实体名称 ( `@Entity(name = ...)`)，它将不起作用，但在实践中并不常见。

# php - 在 PHP 中使用 array_walk 对数组进行排序？

> ID：11399741
> 
> 赞同：2
> 
> 时间：2012-07-09T17:01:46.157
> 
> 标签：php, arrays, multidimensional-array, sorting

如何适用`ksort`于数组的每个元素`$counts`？我的意思是简单地**在每个嵌套数组上调用这个函数**，而不是递归。

```
bool array_walk(array &$array, callable $funcname [,mixed $userdata = NULL]) 
```

我试过`array_walk`将标志`SORT_NUMERIC`作为用户数据传递。这给了我**一个警告**：

```
 $counts = array();

    $counts['group1'] = array(); // Keys are timestamps but as STRING
    $counts['group2'] = array(); // Keys are timestamps but as STRING
    // ...

    // Array + operator does a key reordering here
    $counts['group1'] += $dummyData;
    $counts['group2'] += $dummyData;

    // .. so sort array by keys
    array_walk($counts, 'ksort', SORT_NUMERIC); 
```

> 警告： ksort() 最多需要 2 个参数，给定 3 个。

**第三个参数**是什么？

**编辑**：天才答案：

```
foreach($counts as &$group) :
    ksort($group, SORT_NUMERIC);
endforeach; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T17:16:16.733

来自[http://php.net/manual/en/function.array-walk.php](http://php.net/manual/en/function.array-walk.php)

> 通常，funcname 有两个参数。数组参数的值是第一个，键/索引是第二个。
> 
> 如果提供了可选的 userdata 参数，它将作为第三个参数传递给回调函数名。

# windows - 下载 Word 文档时的 Microsoft 安全登录框

> ID：11399745
> 
> 赞同：4
> 
> 时间：2012-07-09T17:02:14.793
> 
> 标签：windows, security, ms-word, download, popup

我已经在网上四处寻找这个，但似乎无法在任何地方找到答案，所以希望有人能提供帮助。

尝试下载 Word 文档或 Excel 文件时，我创建的网站上出现“Windows 安全”弹出窗口（我需要为其他人而不是我自己修复它）。PDF 看起来不错。

一个示例页面是[http://www.christletonhigh.co.uk/school_information/uniform.php](http://www.christletonhigh.co.uk/school_information/uniform.php)如果您点击下载右下角的“统一价格和订购单”。

网站上没有 SSL，错误只出现在 IE 上（我在 Windows 7 上使用 IE9，我看到其他人在网上提到他们的设置发生了这种情况）并且似乎不会影响所有文件，所以它是有点混乱。单击弹出窗口上的取消会导致文档仍然打开。

请问有人有什么想法吗？客户告诉我，导致问题的文档从未受到密码保护。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-03T08:35:18.670

For the reference, here's the detailed explanation why this happens: [http://support.microsoft.com/kb/2019105](http://support.microsoft.com/kb/2019105)

Solution mentioned by Anshuman should work: create script that adds "Content-Disposition" header with "attachment" value. For example: `Content-Disposition: attachment; filename="myfile.doc"`. This will force all the content (including PDF, images, etc.) to be downloaded.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T22:20:27.560

*   撇开安全设置不谈，其他浏览器似乎比 IE9 更优雅地处理这个问题。例如，Chrome 似乎可以轻松处理文档的下载，并且不会导致 Windows 安全对话框提示输入其网络的凭据...
*   用户可以从 Word 选项中禁用“受保护的视图”设置 | 信任中心，并且文档将打开而没有对话框（可能不希望指示他们这样做）

我想这是让用户下载需要其他应用程序处理的内容时所承担的风险。PDF会更好（因此“P”代表“便携式”），所以如果他们可以使用PDF，那将是我的第一个建议。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T12:53:24.453

当您提供文件的直接 URL 路径并让浏览器处理文件时，就会出现此问题。要解决此问题，请创建一个明确下载文件的 php 脚本。希望这可以帮助 ：）

# php - 无 Cookie 表单登录到 Symfony2 站点

> ID：11399753
> 
> 赞同：2
> 
> 时间：2012-07-09T17:02:41.630
> 
> 标签：php, session, symfony, safari

我有一个 symfony 站点，旨在用于另一个站点的 iframe 中。对于所有浏览器，它都可以正常工作，除了 Safari，因为 Safari 不允许 iframe 设置任何 cookie。我没有登录，而是返回到没有错误的空白登录页面。

我一直在尝试的解决方案是将 PHPSESSID 设置为表单上的隐藏字段，并使用它来跟踪会话而不是 cookie。我遇到的问题是登录后，formlogin 似乎设置了一个新的会话密钥并发送了一个重定向。我无法在此重定向上获得正确的会话密钥。

我试图通过将以下内容添加到 app.php 的末尾来将会话密钥添加到重定向 URL 的末尾（这非常不合时宜，但我变得非常绝望）。

```
foreach(headers_list() as $header) {
    if (substr($header,0,9) == "location:") {
        if (strpos($header, '?')===FALSE && strpos($header, '#')===FALSE ) {
            header($header."?PHPSESSID=".session_id());
        }
    }
} 
```

这添加了一个会话密钥，但它似乎是添加旧的会话密钥，而不是表单登录创建的新密钥。结果，当我尝试登录时，我收到消息“您的会话已超时，或者您已禁用 cookie。”。

如何获得正确的 session_id？有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T21:13:54.537

你得到的只是额外的安全检查，以防止恶意用户伪造会话。如果您尝试使用登录表单加载页面，然后删除所有 cookie，然后尝试进行身份验证，则会发生相同的行为。

检查是在[这一行](https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Security/Http/Firewall/AbstractAuthenticationListener.php#L129)定义的。检查方法不[言自明](https://github.com/symfony/HttpFoundation/blob/master/Request.php#L552)，非常清楚。

对于您的特殊任务，我会说这不是首选行为，因此您应该覆盖此类。

[关于如何编写自定义身份验证提供程序](http://symfony.com/doc/current/cookbook/security/custom_authentication_provider.html)有相当好的文档- 这可能是您灵感的起点；）

# spring - 如何注册转换器以在 Spring Web MVC 中的特定类型的 String 和 List 之间进行转换？

> ID：11399756
> 
> 赞同：1
> 
> 时间：2012-07-09T17:03:07.460
> 
> 标签：spring, spring-mvc, converter

我们的应用程序在控制器方法中接受基于 JSON 的字符串，我们希望使用 Spring 的 Converter 接口将其转换为特定类的列表。

该字符串是较大表单提交的一部分，其中包含在不同时间发送的附加参数。

不幸的是，看起来 Spring 正在选择这个转换器（声明为`<String, List<Proprietary>>`）并使用它将所有字符串转换为列表，这不是我们想要的。

有没有办法使用 Spring MVC 提供的转换服务来解决这个问题？我们通过只接受控制器方法中的字符串并直接执行转换来解决这个问题，但这并不那么干净。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T16:34:58.067

我可以推荐的一种解决方法是创建您自己的[HandlerMethodArgumentResolver](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/web/method/support/HandlerMethodArgumentResolver.html)并触发此 HandlerMethodArgumentResolver 以针对特定参数执行 - 例如通过创建名为 JsonArgument 的注释，使用 @JsonArgument 注释这些参数 -

```
 @Override
    public boolean supportsParameter(MethodParameter methodParameter) {
        if (methodParameter.getParameterAnnotation(JsonArgument.class)!=null) return true; 
```

现在，在这个 HandlerMethodArgumentResolver 中，您可以获取特定的请求参数值（例如 Json 字符串）并将其转换为所需的类型。

```
@Override
public Object resolveArgument(MethodParameter parameter, ModelAndViewContainer mav, NativeWebRequest webRequest, WebDataBinderFactory binderFactory) throws Exception {
...
       jsonString = webRequest.getParameter(parameterName);
       Class<?> type = methodParameter.getParameterType();
       //Convert jsonString to object of appropriate type.. 
```

这样，您的更改将高度集中在您已注释的类型上。

# kwicks - Kwicks slider images with text

> ID：11399761
> 
> 赞同：0
> 
> 时间：2012-07-09T17:03:15.323
> 
> 标签：kwicks

Hello (I am not a programmer so bear with me)

I am using drupal 7\. My boss loves the KWICKS slider. I have gotten this to work but only with images using views-kwicks module.

I would like to be able to have text(teaser) placed over the images in the slider with a link to the corresponding page when clicked, like [http://demo.themesmania.com/creative/kwicks-slider](http://demo.themesmania.com/creative/kwicks-slider)

How should I go about doing this? Thank you!!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-09T15:41:43.063

该链接中使用的标记是：

把它放在你`<li></li>`的 kwicks 里面：

```
<div class="slide-description">
<h4>At vero eos et accusamus et</h4>
<p>At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum deleniti</p>
</div> 
```

然后使用这个CSS：

```
.slide-description { background-color:#000;
    bottom: 0;
    cursor: pointer;
    display: block;
    font-weight: normal;
    left: 0;
    line-height: normal;
    padding: 16px 20px;
    position: absolute;
    width: 760px;z-index: 2;} 
```

# puppet - 运行“puppet apply”时如何指定 puppet:///private/ 的目录？

> ID：11399766
> 
> 赞同：1
> 
> 时间：2012-07-09T17:03:58.850
> 
> 标签：puppet

所以，我有一个 puppet 存储库。它的版本`git`和类似的东西。我可以方便地在我的机器上对这个存储库的副本进行临时更改，然后在测试计算机上尝试这些更改，然后再将这些更改提交给 puppet 服务器（避免触摸生产机器进行测试的麻烦） ，以及 puppetca 签署临时 EC2 实例的麻烦）。我可以`scp`将存储库的副本转移到适当的机器上并做`puppet apply site.pp --modulepath=foo --templatedir=blah`，它主要工作......

直到我有一个来自`puppet:///private/foo`. 那么这一切`Could not evaluate: Could not retrieve information from source(s) puppet:///private/foo at /home/ubuntu/ops-puppet/production/modules/foobar/manifests/baz.pp:68`。

我可以使用命令行标志来指定“私有”文件的路径吗？我似乎无法在文档中找到它（但我今天早上可能只是忘记了；）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T19:10:20.153

检查您的 /etc/puppet/fileserver.conf 文件 (http://docs.puppetlabs.com/guides/file_serving.html#file-server-configuration) 并确保它有一个指向预期目录的 [private] 块.

Zac B 关于检查私有目录权限的问题的评论也是一个好主意。

# iphone - iPhone 硬编码滑动

> ID：11399767
> 
> 赞同：0
> 
> 时间：2012-07-09T17:04:02.993
> 
> 标签：iphone

基本上，我们要么可以远程访问 iPhone，要么将手机连接到可以控制手机（发送消息等）的网络。如何在不触摸实际手机的情况下模拟滑动？我知道有刷卡识别器，但我还没有找到一种方法来硬编码坐标来模拟刷卡；例如，在不接触手机的情况下，执行滑动解锁。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:07:06.190

滑动输入。您通常会使用手势识别器或直接处理触摸来识别滑动，然后执行某种操作。如果要模拟滑动，只需执行用户做出等效手势时将执行的操作。

例如，如果滑动通常会切换到不同的视图，只需调用切换到该视图的方法。如果可能的话，用动画来做，这样用户就可以看到正在发生的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:12:04.117

我不完全确定您尝试做的事情是否可行，除非可能使用自动化仪器中的脚本。但是，如果 iPhone 越狱了，您可以安装 Veency 并通过任何 VNC 客户端连接手机并以这种方式与之交互。

# php - Get the title from the pages table

> ID：11399771
> 
> 赞同：0
> 
> 时间：2012-07-09T17:04:26.110
> 
> 标签：php, symfony1

How do I use Doctrine in Symfony to get page title from a table of pages?

For example:

```
$title = Doctrine::getTable('MyTable')->getTitle($this->page_id); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T17:38:41.550

您需要抓住对象，然后从中拉出标题。

尝试：

```
$object = Doctrine::getTable('MyTable')->find($this->page_id);
$title = $object->getTitle(); 
```

# c# - WPF/SL control to represent grapf on the map. Any ideas?

> ID：11399772
> 
> 赞同：0
> 
> 时间：2012-07-09T17:04:26.270
> 
> 标签：c#, wpf, silverlight

I need to create WPF/SL application to represent a graph on the map. The users will create and edit the graph vertices linked with geographic locations. Please recommend WPF/SL control suitable for this task.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T17:08:19.917

有一些很棒的第三方地图控件，例如[Telerik 的 Map Control](http://www.telerik.com/products/wpf/map.aspx)，它们可以处理地图，包括添加您自己的地理数据。

# php - Post onto multiple facebook pages

> ID：11399773
> 
> 赞同：0
> 
> 时间：2012-07-09T17:04:29.613
> 
> 标签：php, facebook

I'm new to facebook api, for last two days I'm looking to find a way to post onto multiple facebook pages.

I've list of facebook page id's e.g.: `1234, 34456, 77889,44224432`. I don't own those pages. Is there a way I could post same message on all of these pages once?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T21:08:24.930

您需要在页面上进行身份验证并使用

`https://graph.facebook.com/{PAGE_ID}/feed`

作为您使用 cURL 的操作。

**参考**： http: [//php-academy.blogspot.ca/2011/04/how-to-post-from-facebook-app-to.html](http://php-academy.blogspot.ca/2011/04/how-to-post-from-facebook-app-to.html)

# javascript - javascript inside perl script

> ID：11399774
> 
> 赞同：3
> 
> 时间：2012-07-09T17:04:35.527
> 
> 标签：javascript, perl

I have created a perl script which is getting run time data from server and displaying on a html page. I am not using any databse there.

I have to link another perl script with 1 javascript variable. I want to make that value global so that I can access from anywhere.

Here is the problem

For testing when I include that javascript function inside perl script it alerts me passed value but if I put that function in a js file and call it, it doesn't alert anything. I tried calling js file from multiple locations but no luck :(

Can anybody help me on this asap?

this is code from js file

```
`$(document).ready(function(){
function aabcd(){
var y=document.getElementById("mnth").value;
alert(y);
}
});
` 
```

* * *

Here is the full code.

I am facing problem here I am unable to call this test.js file. If I include this file's contents in this perl script then it works fine but I want to use via file so that I can use those variable as globally. `

```
#!/usr/bin/perl
#!/bin/ksh

use CGI qw(:standard escapeHTML);
print <<EOH;
Content-Type: text/html; charset=ISO-8859-1

<!DOCTYPE html
        PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
         "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<meta http-equiv="Content-Language" content="en" />
<title> ITSS UNIX report</title>

<style type="text/css">
h1 { font-size: 24px; }
body {
     font: 13px tahoma;
     background: #ffffff;
      margin: 1em 2em;
        padding: 0em;
     }
</style>
<link rel="stylesheet" type="text/css" href="/example1.css" />
<script type="text/javascript" src="/DropMenu1.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>
<script type="text/javascript" src="/test.js"></script>
</head>
<body>

<TABLE WIDTH="100%" cellSpacing=0 cellPadding=1 align=center border=0 style='border: 1px solid; border-width: 0 0 0 0; border-style:solid; margin: 0; padding: 0;' bordercolor=#B
DBDBD>
<TR>
<TD width=100% BGCOLOR=#000066 ALIGN=center><FONT style='font-size: 28.0pt;mso-bidi-font-size: 11.0pt;font-family: tahoma;color: #FFFFFF;background-color=#000066'>User Audit Sec
urity Report</TD>
</TR>
</TABLE>
<form name="myform">
<select name="year" id="year">
<option value="2011">2011</option><option value="2012">2012</option></select>
<select name="mnth" id="mnth" onchange="return aabcd();">
<option value="-1" class="item1" >Click for Month</option>
<option value="Jan" class="item2" >January </option>
<option value="Feb" class="item2" >February</option>
<option value="Mar" class="item2" >March </option>
<option value="Apr" class="item2">April</option>
<option value="May" class="item2" >May </option>
<option value="Jun" class="item2" >June </option>
<option value="Jul" class="item2" >July</option>
<option value="Aug" class="item2" >August </option>
<option value="Sep" class="item2" >September</option>
<option value="Oct" class="item2" >October</option>
<option value="Nov" class="item2" >November</option>
<option class="item2" value="Dec">December</option></select></td></tr>
<input id="sub" value="Submit" type="button">
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T13:59:28.467

如果您查看 CGI 模块的 perldoc，这是包含 javascript 文件的推荐方法：

```
print $q->start_html(-title=>'The Riddle of the Sphinx',
                 -script=>[
                           { -type => 'text/javascript',
                             -src      => '/javascript/utilities10.js'
                           },
                           { -type => 'text/javascript',
                             -src      => '/javascript/utilities11.js'
                           },
                           { -type => 'text/jscript',
                             -src      => '/javascript/utilities12.js'
                           },
                           { -type => 'text/ecmascript',
                             -src      => '/javascript/utilities219.js'
                           }
                        ]
                    ); 
```

$q 将保存一个 CGI 对象，并且还应该用于构造 HTML 的其余部分。这应该会大大提高其有效的机会。您还需要验证“/test.js”是获取 javascript 文件的正确 URL，并通过检查您的服务器日志来确认它已返回给浏览器。您还可以在 Firebug 中检查您的浏览器正在请求和接收它。

最后，虽然 CGI 在 10 或 12 年前非常流行，但今天有许多更现代的方法可以用 perl 开发 Web 应用程序。例如，检查 cpan 的[CGI::Application](https://metacpan.org/module/CGI%3a%3aApplication)和[Dancer](https://metacpan.org/module/Dancer)。使用 Template::Toolkit 之类的东西也可以让你的生活更轻松。

# css - Rails. Can't get images to be displayed from a CSS file

> ID：11399776
> 
> 赞同：1
> 
> 时间：2012-07-09T17:04:47.070
> 
> 标签：css, ruby-on-rails, ruby, sass

I already tried many different approaches and none work, am I missing something here?

This is what I have tried...

```
th a.asc {
  background-image: url(up_arrow.gif);
}

th a.desc {
  background-image: url(down_arrow.gif);
} 
```

and

```
th a.asc {
  background-image: url("assets/up_arrow.gif");
}

th a.desc {
  background-image: url("assets/down_arrow.gif");
} 
```

and

```
th a.asc {
  background-image: url(assets/up_arrow.gif);
}

th a.desc {
  background-image: url(assets/down_arrow.gif);
} 
```

and

```
th a.asc {
  background-image: url(<%= asset_path "up_arrow.gif" %>);
}

th a.desc {
  background-image: url(<%= asset_path "down_arrow.gif" %>);
} 
```

and...

```
th a.asc {
  background-image: asset-url("up_arrow.gif", image);
}

th a.desc {
  background-image: asset-url("down_arrow.gif", image);
} 
```

and many more.

I have renamed the file application.css, application.css.scss, application.css.erb, application.scc.scss.erb, index.css, index.css.scss, index.css.erb

I have read this... [http://edgeguides.rubyonrails.org/asset_pipeline.html#coding-links-to-assets](http://edgeguides.rubyonrails.org/asset_pipeline.html#coding-links-to-assets) and [404 when displaying background image in CSS with rails 3.2](https://stackoverflow.com/questions/10093077/404-when-displaying-background-image-in-css-with-rails-3-2) and [Rails 3.1 serving images from vendor/assets/images](https://stackoverflow.com/questions/6562140/rails-3-1-serving-images-from-vendor-assets-images) and [Rails 3.1 and Image Assets](https://stackoverflow.com/questions/6213218/rails-3-1-and-image-assets) and other pages from stackoverflow.

But my images don't appear. They are in the `app/assets/images` directory. I have double checked and triple checked and yes, they are in that location. I go to Inspect Element in Google Chrome and when I click in the images link, it shows me the broken link image.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T18:10:55.213

`asset-url`假设有一些事情，你的最后一个例子应该可以工作......

*   资产管道实际上已启用（在`config/application.rb`查找中`config.assets.enabled = true`）
*   你有`sass-rails`在你的 Gemfile
*   如果`sass-rails`是 Gemfile 中某个组的一部分（例如，该`:assets`组），则必须确保 Bundler 在您的开发环境中加载该组 gem。在你的`config/application.rb`你应该看到这样的东西：

    ```
    如果定义了？（捆绑器）
      # 这会在开发和测试环境中加载您的 :assets 组
      Bundler.require *Rails.groups(:assets => %w(开发测试))
    结尾
    ```

*   这个特定的样式表是一个 SASS 样式表（即，应该具有扩展名 .SASS 或 .SCSS 因为`asset-url`是`sass-rails`gem 的助手）

*   这个样式表实际上是在资产管道中加载的（它应该被命名`application.css.scss`或者是必需的/@included by `application.css.scss`）

如果这一切都是真的，那么你仍然有问题，那么我会说发生了一些愚蠢的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:24:57.600

你的第一个看起来不错，对我有用。所以有几件事要检查：

*   您的图像 up_arrow.gif 是否与 CSS 文件位于同一目录中？（或者，如果您的 CSS 在 HTML 页面中，则与 html 文件位于同一目录）
*   在浏览器中使用调试工具，例如 Firefox 或 Safari 中的 Firebug，右键单击并选择“Inspect Element”（首先在 Safari 首选项中打开开发人员菜单）。查看以确保计算出的 CSS 属性是您所期望的，然后查看资源/网络选项卡以查看浏览器是否正在尝试从正确的位置加载您的图像。
*   图像是否被用作背景图像，但由于 A 元素太小而不可见？如果 A 元素中没有文本，它将是 0x0。如果它具有文本和/或大小属性，如果背景图像有一堆空白区域，它可能仍然太小。尝试将 A 标签变大，看看是否是这种情况。例如，在你的 CSS 中添加一个 width 和 height 属性，还有一个 display: block 属性似乎是必要的。

如果您希望图像成为按钮，您也可以在 A 标签内放置一个 IMG 标签。尽管您可以根据需要使 CSS 工作，但它可能会更容易一些。

这对我有用：

```
<html>
<head>
<style type='text/css'>
    th a.asc { 
        background-image: url(up_arrow.png); 
        width: 32px; height: 32px; display: block;
    }
</style>
</head>
<body>
<table><tr><th><a class='asc'></a></th></tr></table>
</body>
</html> 
```

# javascript - 使用固定位置按钮使图像适应宽度

> ID：11399782
> 
> 赞同：0
> 
> 时间：2012-07-09T17:05:32.420
> 
> 标签：javascript, jquery, internet-explorer, css-position

我有一个具有以下功能的页面：有一个生成 scoll （水平和垂直）的大图像和一个固定位置的按钮（它保留在左上角，即使有滚动），单击时适合图像到客户端宽度。

由于`position: fixed`Internet Explorer 8 不支持，因此我使用了一种解决方法 - 这是函数：

```
function setFixedPosition(jqueryWrapper, pixelsFromTop, pixelsFromLeft) {

    jqueryWrapper.css('position', 'absolute');

    var setOffsets = function() {
        jqueryWrapper.css("top", (($(window).scrollTop() + pixelsFromTop) + "px"));
        jqueryWrapper.css("left", (($(window).scrollLeft() + pixelsFromLeft) + "px"));
    };

    setOffsets();

    $(window).scroll(function() {
        setOffsets();
    });
}

setFixedPosition($('#zoomFitButton'), 15, 15); 
```

这是按钮的操作：

```
$('#zoomFitButton').click(function() {
    $('img.preview').css('width', '100%');
}); 
```

该按钮在 Firefox 13 和 IE8 中均保持不变。

但是，在 IE8 下，如果我在某处滚动，然后单击按钮，按钮将移动到“奇怪”的位置：

*   如果我垂直滚动，然后单击，它会将按钮放在左下角；
*   如果我水平滚动，然后单击，它将按钮放在右上角；
*   如果我双向滚动，然后单击，它会将按钮放在中心的某个位置。

在 Firefox 中，该按钮始终保留在左上角（我期望的位置），即使在我单击了适合宽度按钮之后也是如此。

这是[一个测试页](http://jsfiddle.net/zMW9k/2/)。

我的代码是否适用于这个功能（原则上），或者我需要在适合宽度操作中添加一些内容（以修复我的按钮定位）；或者 IE 有什么问题（我需要一个解决方法 - 如果是这样，有什么建议吗？）？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T10:05:12.917

我找到了一个也适用于 IE6 的解决方案。

我认为这个问题与 IE 在调整文档大小后没有更新 scrollTop 和 scrollLeft 位置有关。
因此，在调整图片大小后，我必须滚动到左上角（scrollTop(0) 和 scrollLeft(0)）。
不幸的是，如果我有一张大图片需要垂直滚动，即使它适合宽度，解决方法会将我带到页面顶部。所以我添加了代码，使我按比例回到我之前的近似位置。我将逻辑包装在一个更通用的函数中：

```
function doSomethingThatAffectsScrollPosition(affectingScrollPositionFunction) {

    var oldDocumentWidth = $(document).width();
    var oldScrollFromLeft = $(window).scrollLeft();

    var oldDocumentHeight = $(document).height();
    var oldScrollFromTop = $(window).scrollTop();

    affectingScrollPositionFunction();

    var newDocumentWidth = $(document).width();
    var widthRatio = (newDocumentWidth / oldDocumentWidth);
    var newScrollFromLeft = (oldScrollFromLeft * widthRatio);

    var newDocumentHeight = $(document).height();
    var heightRatio = (newDocumentHeight / oldDocumentHeight);
    var newScrollFromTop = (oldScrollFromTop * heightRatio);

    $(window).scrollLeft(0); // Needed for button repositioning
    $(window).scrollLeft(newScrollFromLeft);

    $(window).scrollTop(0); // Needed for button repositioning
    $(window).scrollTop(newScrollFromTop);
} 
```

我在适合宽度按钮的操作中使用了该功能：

```
$('#zoomFitButton').click(function() {
    doSomethingThatAffectsScrollPosition(function() {
        $('img.preview').css('width', '100%');
    });
}); 
```

[这](http://jsfiddle.net/zMW9k/6/)是一个测试页面。

# sitecore - Accessing page methods from command in Sitecore

> ID：11399784
> 
> 赞同：1
> 
> 时间：2012-07-09T17:05:56.017
> 
> 标签：sitecore

I'm building Sitecore sheer UI application. The main layout is `aspx` page NOT XAML, which contains a grid. I added a dropdown list as a ribbon button. When dropdown list changes, it must filter the grid source based on the selected value in dropdown.

When dropdown list changes, my custom command will trigger, but in the command I can't access my grid control so that I can do a filter. So my question is how can I call a method inside my `aspx` page from command class?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-10T13:28:16.423

从您的帖子中，我了解到您已经构建了一个界面（.aspx 页面），当用户单击功能区中的下拉值时会打开该界面。

如果是这种情况，那么您可以使用**命令文件中的查询字符串在 aspx 页面中传递下拉值**

1.  在命令文件中添加以下代码

    *   在**执行方法中，从****CommandContext 上下文中**检索点击的值：

        ```
        Item item = context.Items[0]; 
        ```

    *   在**运行**方法用户 SheerResponse 中打开 aspx 文件：

        ```
        UrlString urlString = new UrlString("youraspxpage.aspx?id="+(Dropdownvalue));
        SheerResponse.ShowModalDialog(urlString.ToString()); 
        ```

2.  在 aspx 文件中添加以下代码以访问您从下拉列表中选择的选项：

    *   在 page_load 方法中从查询字符串访问下拉值，检索下拉值并加载网格：

        ```
        string dropdownvalue= (Request.QueryString["id"]); 
        ```

让我知道情况是否不同。
谢谢。

# ruby - 我如何用上帝监控独立的应用程序？

> ID：11399785
> 
> 赞同：1
> 
> 时间：2012-07-09T17:06:04.697
> 
> 标签：ruby, god

我目前正在研究 Rails/Ruby 项目的进程监控选项，就像上帝一样。

但我真的找不到任何关于如何用上帝监控多个应用程序（例如在一台机器上运行的 2 个 rails 项目）的任何信息。

据我所知，我只是设置了上帝（系统红宝石）并让每个项目添加自己的配置（可能以某种方式在部署挂钩中）。这也应该适用于运行不同 ruby​​ 版本（rbenv、rvm）或捆绑程序的项目，因为神 ruby​​ 不必访问任何项目代码。

有人已经像这样使用它了吗？还是有更好的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-09T17:20:25.507

我用上帝来观看我所有的东西（独角兽、redis、resque workers）。基本设置是这样的：

God 全局安装，在系统启动时加载并读取其配置文件，`/etc/god/all.god`.

### /etc/god/all.god

```
files = Dir.glob "/etc/god/**/*.god"

files.each do |f|
  next if f == '/etc/god/all.god'
  God.load f
end 
```

该文件加载所有配置文件`/etc/god`及其子文件。部署脚本将配置文件放在那里并告诉上帝（重新）加载它们。

```
$ ls -l /etc/god
total 16
-rw-r--r-- 1 root   root    108 2012-02-23 16:26 all.god
drwxr-xr-x 2 sergio sergio 4096 2012-03-20 20:59 app1_production
drwxr-xr-x 2 sergio sergio 4096 2012-03-27 00:58 app2_production
drwxr-xr-x 2 root   root   4096 2012-04-23 01:37 util

$ ls -l /etc/god/app1_production/
total 0
lrwxrwxrwx 1 sergio sergio 55 2012-03-20 20:59 redis.god -> /srv/app1_production/current/config/god/redis.god
lrwxrwxrwx 1 sergio sergio 56 2012-03-20 20:59 resque.god -> /srv/app1_production/current/config/god/resque.god
lrwxrwxrwx 1 sergio sergio 57 2012-03-20 20:59 unicorn.god -> /srv/app1_production/current/config/god/unicorn.god 
```

这是一个头`unicorn.god`。

```
rails_env = "production"
pid_dir = "/srv/app1_#{rails_env}/shared/pids"
rails_root = "/srv/app1_#{rails_env}/current"

God.watch do |w|
  w.name = "unicorn-#{rails_env}"
  w.interval = 30.seconds # default

  # unicorn needs to be run from the rails root
  w.start = "cd #{rails_root} && /home/sergio/.rvm/bin/r193_bundle exec unicorn_rails -c #{rails_root}/config/unicorn/unicorn.#{rails_env}.rb -E #{rails_env} -D"

  # QUIT gracefully shuts down workers
  w.stop = "kill -QUIT `cat #{pid_dir}/unicorn.pid`"

  # USR2 causes the master to re-create itself and spawn a new worker pool
  w.restart = "kill -USR2 `cat #{pid_dir}/unicorn.pid`" 
```

如您所见，unicorns 是通过 rvm 包装器启动的，因此每个新应用程序都可以使用自己的 ruby​​。此外，您提供自己的`start`,`stop`和`restart`命令，因此您可以使用 god 观看任何软件。

这种方法对我来说非常有效（到目前为止）。

# configurationmanager - Configuration Management and SlowCheetah

> ID：11399788
> 
> 赞同：1
> 
> 时间：2012-07-09T17:06:18.787
> 
> 标签：configurationmanager, slowcheetah

I need to apply **xdt transformations** to other files than ***.config** ones. I found the SlowCeetah extension which seems to provide this kind of feature as authors and extension page says, but, even if I setup the trasformation for xml files, and note that the **preview tool** works well.., according to solution configuration manager configuratoins, no transformation is applied.

For example I setup the trasformation for log4net.xml file, by using the tooling command "Add Transformation" which added log4net.*{configname}*.xml files but nothing happen when I deploy the solution or simply build with the specific build configuration.

Anyone has seen this issue?

Googlin' around I found that trasnformations to xml files should be applied to files setup as Content and Copy Always, anyone has suggestion about that?

I 'm very sad becaues I made all my configurations with transformations, and if I cannot solve that issue I lost 2 days of boring config job and I just can do that manually Thanks in advance Cheers

# java - CheckedTextView 在自定义 ListView 中不起作用

> ID：11399793
> 
> 赞同：2
> 
> 时间：2012-07-09T17:06:34.223
> 
> 标签：java, android

我创建了一个包含 CheckedTextView 的 ListView。我正在通过自定义 ArrayAdapter 提供此 ListView 中的元素。列表显示正常，但是当我选择列表项时复选框没有响应

代码：

MainActivity 类：

```
public class MainActivity extends ListActivity {

    ArrayList<String> m_list;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        new AsyncHandler(this).execute();
    }

    public class AsyncHandler extends AsyncTask {

        Context context;

        public AsyncHandler(Context c) {
            context = c;
        }

        @Override
        protected void onPreExecute() {
            super.onPreExecute();
            Toast.makeText(context, "In onPreExecute()", Toast.LENGTH_SHORT)
                    .show();
        }

        @Override
        protected Object doInBackground(Object... arg0) {
            getList();
            return null;
        }

        @Override
        protected void onPostExecute(Object result) {
            // super.onPostExecute(result);
            setListAdapter(new ElementAdapter(context, m_list));
        }

        private void getList() {
            m_list = new ArrayList<String>();
            m_list.add("Ele 1");
            m_list.add("Ele 2");
            m_list.add("Ele 3");
            m_list.add("Ele 4");
        }
    }

} 
```

适配器类

```
public class ElementAdapter extends ArrayAdapter implements OnClickListener {

    ArrayList<String> items = new ArrayList<String>();
    Context context;
    CheckedTextView tvElement;

    public ElementAdapter(Context c, ArrayList<String> elements) {
        super(c, R.layout.row, elements);
        this.items = elements;
        this.context = c;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        LayoutInflater inflater = (LayoutInflater) context
                .getSystemService(context.LAYOUT_INFLATER_SERVICE);
        View view = inflater.inflate(R.layout.row, parent, false);
        tvElement = (CheckedTextView) view
                .findViewById(R.id.ctvElements);
        tvElement.setText(items.get(position));
        tvElement.setOnClickListener(this);
        return view;
    }

    @Override
    public void onClick(View view) {
        switch(view.getId()){
        case R.id.ctvElements:
            if(!tvElement.isChecked()){
                tvElement.setChecked(true);
                tvElement.setCheckMarkDrawable(android.R.drawable.checkbox_on_background);
            }else{
                tvElement.setChecked(false);
                tvElement.setCheckMarkDrawable(android.R.drawable.checkbox_off_background);
            }
            notifyDataSetChanged();
        }
    }
} 
```

行布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent" android:layout_height="match_parent"
    android:orientation="horizontal">

    <CheckedTextView android:id="@+id/ctvElements"
        android:paddingLeft="20dip" android:paddingRight="20dip"
        android:paddingTop="10dip" android:paddingBottom="10dip"
        android:orientation="vertical" android:layout_width="fill_parent"
        android:layout_height="?android:attr/listPreferredItemHeight"
        android:gravity="center_vertical" android:checkMark="@android:drawable/checkbox_off_background"
        android:focusable="false" />

    <!-- <CheckBox android:id="@+id/checkBox1" android:layout_width="wrap_content" 
        android:layout_height="wrap_content" android:focusable="false" /> <TextView 
        android:id="@+id/tvElement" android:layout_width="wrap_content" android:layout_height="wrap_content" 
        android:text="Element" android:textSize="25sp" /> -->

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T17:18:56.430

如果您只想为每一行添加复选标记，请使用[ListView.setChoiceMode()](http://developer.android.com/reference/android/widget/AbsListView.html#setChoiceMode%28int%29)。复选标记将响应行中任意位置的单击，而不添加任何 onClickListeners 或自定义适配器。

将此添加到您的 onCreate 中：

```
ListView listView = (ListView) findViewById(android.R.id.list);
listView.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE); 
```

然后使用内置的 ArrayAdapter：

```
 @Override
    protected void onPostExecute(Object result) {
        // super.onPostExecute(result);
        setListAdapter(new ArrayAdapter<String>(context, R.layout.row, m_list));
    } 
```

您可以将默认选中的行布局与`android.R.layout.simple_list_item_checked`.

否则，如果您想要一些自定义 ListView 行将 row.xml 更改为：

```
<CheckedTextView android:id="@android:id/text1"
        android:layout_height="?android:attr/listPreferredItemHeight"
        android:layout_width="fill_parent"
        android:checkMark="@android:drawable/checkbox_off_background"
        android:gravity="center_vertical" 
        android:paddingLeft="20dip" 
        android:paddingRight="20dip"
        android:paddingTop="10dip" 
        android:paddingBottom="10dip"
        /> 
```

# asp.net - 扩展 .net 控件：如何防止 HTML 属性呈现

> ID：11399795
> 
> 赞同：0
> 
> 时间：2012-07-09T17:06:37.030
> 
> 标签：asp.net, .net, gridview, custom-server-controls, servercontrols

我编写了一个扩展标准 .net Gridview 控件的服务器控件。

但是，默认情况下，标准 gridview 控件会在它生成的 html 标记中添加一个**border="0"**属性，并且我想防止该属性被我的服务器控件呈现。

我可能会使用 ScriptManager 添加一些 Javascript，以便在控件所在的页面加载后删除该属性，但这似乎有点笨拙，我希望有人可以告诉我如何干净地做到这一点，例如，添加**this.Attributes.Remove("border");** 到控件的 PreRender 事件或类似的东西（顺便说一句，这不起作用，或者我不必问这个问题）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T18:21:26.880

您需要做的就是设置`Gridlines`为**“无”**

参考：的[GridLines](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.gridlines.aspx)属性`GridView`。

```
<asp:GridView GridLines="None" /> 
```

当然，如果您想对渲染进行更多控制，那么您正在寻找控制适配器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:40:56.453

我正在使用 devexpress gridview，所以它可能有点不同，但我注意到发生了同样的事情，我补充说

```
grid.Attributes["border"] = ""; 
```

到页面加载事件，并且边框不再以 html 呈现。有点破解，但它对我有用。

# joomla - Joomla 2.5 password reset user sync

> ID：11399796
> 
> 赞同：-1
> 
> 时间：2012-07-09T17:06:53.000
> 
> 标签：joomla, joomla2.5

We have a Joomla 2.5 website and a second site (non-Joomla) that needs to have user information synchronized. We already have implemented a user registration that syncs to the other system after the email verification link is clicked.

The issue I have now is password reset. Joomla has a nice system to allow a user to reset the password. What I need to know is once the user clicks on the email to start the reset process (reset.php), how can I grab the user information within the confirm() method? All I need is the user (email or id) so that I can pass the new encrypted password to the other system.

Any suggestions would be VERY helpful.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T18:04:01.543

在 file`components\com_users\models\reset.php`中，在第 227 行附近的函数`processResetConfirm()`中，用户 ID 在`$user->id`.

```
// Get the user id.
$db->setQuery((string) $query);
$user = $db->loadObject(); 
```

现在应该在 int 中找到用户 ID`$user->id`

# php - 战地 3 统计 API

> ID：11399802
> 
> 赞同：-3
> 
> 时间：2012-07-09T17:07:15.393
> 
> 标签：php, javascript, ajax, web-services

我正在用 PHP 构建一个 Web 应用程序。在应用程序中，需要通过 api 请求从游戏《战地 3》中提取一些统计数据。我正在寻找用于 api 请求的来源。我查看了[bf3stats.com](http://bf3stats.com)，但是他们建议我缓存结果而不是轮询每个页面请求。

我正在寻找的是一个 API，我可以在其中每分钟轮询几次数据。有没有这样的api可用？[EA](http://www.ea.com/)的 Blaze是否提供 api？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T17:19:07.350

您将需要弄清楚如何自己处理请求。

目前还没有任何公开的做法。

注意：您不应该在此处发布这些类型的问题。您基本上只是要求我们为您进行研究。不过，请随时发布有关自己提出请求的问题。

# c# - C#.NET 中针对 32 位和 64 位的多目标

> ID：11399805
> 
> 赞同：7
> 
> 时间：2012-07-09T17:07:19.933
> 
> 标签：c#, .net

假设我有一个基于 C# 开发的 Windows 应用程序。我想确保它适用于 32 位和 64 位。但我不想一次又一次地更改配置设置或应用程序设置。有没有办法测试这两种变体？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-09T17:09:51.053

有几个选项。

1.  您可以针对`AnyCPU`. 如果你的程序是 100% C#/托管代码，没有本地依赖，这将导致它在 64 位操作系统上运行 64 位，在 32 位操作系统上运行 32 位。

2.  目标 x86。这将导致它在任何地方运行 32 位，这在 64 位 Windows 上正常工作（通过 WOW64）。如果您也使用本机（32 位）库，这也可以正常工作。

3.  进行两个构建和两个单独的部署。这允许您使用本机代码并仍然在 64 位操作系统上运行 64 位，但工作量要大得多。

由于 32 位应用程序在 64 位操作系统上运行良好，因此很少有理由在 64 位本机上运行程序。这通常只有在您处理大量数据并且确实需要访问比 32 位进程更大的内存空间时才真正有益。在 .NET 中，这通常意味着如果要为程序使用超过 1.2-1.6gb 的 RAM，则需要构建 64 位。否则，32 位在任何地方都可以正常工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-09T17:10:19.197

如果您以 AnyCPU 为目标，则大多数 .NET 程序将在 32 位或 64 位计算机上原样运行。根据目标操作系统的需要，代码将被转换为 32 位或 64 位代码。

需要小心的例外是在对非托管代码使用互操作时。

如果您对非托管代码进行互操作并需要在 64 位平台上以 64 位运行，则必须进行两次构建。

如果您对非托管代码进行互操作并且可以接受作为 32 位进程运行，则以 x86 为目标。这避免了两次构建，并将您的 .NET 代码作为 32 位进程在 32 位和 64 位平台上运行。

# mysql - MySQL中复选框/多选的最佳存储

> ID：11399807
> 
> 赞同：0
> 
> 时间：2012-07-09T17:07:31.060
> 
> 标签：mysql, database, checkbox, relational

情况：用户将通过复选框/多选选择最多 10 个选项。选择的选项可能少至 1 个，也可多达 10 个。我正在寻找将数据存储在 mysql 数据库中的最佳方法，例如：

(1) 提取此数据的查询速度很快。我不需要对数据进行更新、复杂的连接等操作，我只需要拉取数据。(2) 需要最少的存储空间 (3) 这是可扩展的，因为将来可能会在复选框中添加新选项 (4) 为其编写代码并不繁琐 (PHP)

选项：

1.  序列化数据并存储在单个列/行中

2.  将选择的每个选项存储为单独的行，位于“选项名称”的单列下

3.  为每个提交存储一行。如果选择了该选项，则每个选项都有一列，并带有一点标记

关于什么是最好的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T17:12:31.073

使用**规范化**。

使用主表的外键约束分别制作用于存储选项的子表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:20:26.663

如果我是你，我会制作一个好的 EER 图，并对数据库进行规范化，除此之外，还会查看 InnoDB 和 MyISAM 引擎，看看你应该在每个表中使用哪个 onr，如果你担心你的查询，你仍然可以使用工具来查看如何改进查询，但是如果将所有内容放在一张表、一行中，您甚至不会使用 INDEX，或者您的数据库将因大量重复信息而过载

# automatic-ref-counting - TWRequest 和 ARC - 在项目的其他地方使用值

> ID：11399808
> 
> 赞同：0
> 
> 时间：2012-07-09T17:07:33.207
> 
> 标签：automatic-ref-counting, twrequest

我正在将 ARC 与 TWRequest 一起使用。我已经成功地从 twitter 返回了一个搜索并创建了一个结果数组。这是我的代码...

```
NSArray *results = [dict objectForKey:@"results"];

            //Loop through the results
    NSMutableArray *twitterText = [[NSMutableArray alloc] init];

            for (NSDictionary *tweet in results)
            {
                // Get the tweet
                NSString *twittext = [tweet objectForKey:@"text"];

                // Save the tweet to the twitterText array
                [twitterText addObject:twittext];
}
                NSLog(@"MY ************************TWITTERTEXT************** %@", twitterText ); </p> 
```

我的问题是，我想稍后在 cellForRowAtIndexPath 下的 .m 文件中使用 twitterText，但是一旦循环（如上）完成，它就会在 ARC 下发布。我已在我的 .h 文件中将该属性设置为 strong （以及在循环之前将其声明为上面）。在上述循环之后直接打印日志可以很好地打印 twitterText 数组，但 cellForRowAtIndex 路径方法中的相同日志返回空白。任何帮助，将不胜感激。谢谢。艾伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T20:45:47.737

艾伦，

您似乎没有保存`twitterText`在任何永久 ivar 中。正如上面编写的代码，ARC`twitterText`在 log 语句之后正确地解除分配。

因此，只需分配`twitterText`给控制器中的 ivar。

安德鲁

# javascript - 动态改变 ToolTipDialog 内容

> ID：11399809
> 
> 赞同：0
> 
> 时间：2012-07-09T17:07:46.500
> 
> 标签：javascript, tooltip

我的应用程序有一个指标列表，每个指标都有其帮助按钮。单击每个按钮，会弹出一个 ToolTipDialog，其中分别定义了每个按钮。按照我编写代码的方式（如下），当用户在单击第一个帮助按钮后单击列表中的另一个帮助按钮时，内容不会刷新。我无法弄清楚如何动态更改“内容”。任何帮助将不胜感激：

HTML：

```
<div dojoType="dijit.layout.ContentPane" id="group1" title="Population projection" selected="true">
<table id="popIndTable">
<tr id="someID">
<td><input data-dojo-type="dijit.form.RadioButton" class="checkInd" id="checkCBR" name="checkInd" /></td>
<td id="indCBR">Crude Birth Rate</td>
<td id="infoCBR"><img id="imgCBR" src="Images/help_icon2.png"  width="16px" onClick="showToolTipDialog(this,this.id);" /></td>
</tr>
<tr>
<td><input data-dojo-type="dijit.form.RadioButton" class="checkInd" id="checkTest1" name="checkInd" /></td>
<td id="indTest1">Test 1</td>
<td id="infoTest1"><img id="imgTest1" src="Images/help_icon2.png"  width="16px" onClick="showToolTipDialog(this,this.id);" /></td>
</tr>
<tr>
<td><input data-dojo-type="dijit.form.RadioButton" class="checkInd" id="checkTest2" name="checkInd" /></td>
<td id="indTest2">Test 2</td>
<td id="infoTest2"><img id="imgTest2" src="Images/help_icon2.png"  width="16px" onClick="showToolTipDialog(this,this.id);" /></td>
</tr>
</table>
</div> 
```

JavaScript：

```
function showToolTipDialog(node,infoId){
var infoText;
var infoElem = dojo.byId(infoId).parentNode.id;
if (infoElem == "infoCBR"){
infoText = "This is the text container for CBR";
}
else if (infoElem == "infoTest1"){
infoText = "This is the text container for Test1";
}
if (!tooltipDialog) {
tooltipDialog = new dijit.TooltipDialog({
content: infoText,
style: "width:200px;height:auto;",
autofocus: !dojo.isIE, // NOTE: turning focus ON in IE causes errors when reopening the dialog
refocus: !dojo.isIE
});
dijit.popup.open({ popup: tooltipDialog, around: node});
tooltipDialog.opened_ = true;
}
else {
if (tooltipDialog.opened_) {
dijit.popup.close(tooltipDialog);
tooltipDialog.opened_ = false;
}
else {
dijit.popup.open({popup: tooltipDialog, around: node});
tooltipDialog.opened_ = true;
}
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-24T18:13:30.477

我相信以编程方式更改 dojo 小部件值的首选方法是使用 .set() 方法。IE：

```
this.myTooltipDialog.set("content", newContent); 
```

而不是：

```
this.myTooltip.content = newContent; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T18:05:16.690

看起来您从未重置工具提示对话框的内容。您创建一次，但一旦创建 ( `new dijit.TooltipDialog({...})`) 它仍然是静态的。

我不知道 Dojo API。但是你可以直接设置内容值吗？也许在您的第一个之后立即`else`：

```
tooltipDialog.content = infoText; 
```

这只是一个猜测，但如果 Dojo 的 API 足够简单，那可能会成功。

如果没有，您可能必须删除您的`if (!tooltipDialog) {`支票。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-09-24T18:24:35.427

如果您的内容不太复杂，我建议您在每次调用时创建一个新的 TooltipDialog 并在模糊时将其清除，例如

```
var dlgDiv = dojo.create("div");
var dlg = new dijit.TooltipDialog({
    content: dlgDiv,
    onBlur: function () {
        popup.close(this);
        this.destroyRecursive();
    }
});

// you can create any content within dlgDiv at here dynamicly

dojo.popup.open({
    around: yourArondNode  ,
    orient: ["below", "before", "after", "above"],
    popup: dlg
});
dlg.focus(); 
```

# java - R中用于凝聚聚类的自定义距离度量

> ID：11399812
> 
> 赞同：0
> 
> 时间：2012-07-09T17:07:53.900
> 
> 标签：java, r, hadoop, machine-learning, hierarchical-clustering

我们是否可以在 R 中为凝聚聚类定义自定义距离函数？另外，我想防止在不满足某个条件时合并两个集群。这在R中可能吗？

另外，当 R 放在 Hadoop 上时，是否有可能做到这一切？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T03:31:16.267

在 R 中，对于凝聚层次聚类，您可以使用几种距离度量：欧几里得、绝对距离（曼哈顿）或绝对距离（曼哈顿）取决于您的数据类型。尝试查看：http://127.0.0.1： 29417/library/cluster/html/agnes.html**或**直接访问 R 网站 (http://www.r-project.org/) 并查看手册。它可能会有所帮助。

# java - 在 Android 上仍有 AdMob 问题

> ID：11399813
> 
> 赞同：-1
> 
> 时间：2012-07-09T17:07:54.013
> 
> 标签：java, android, admob, manifest

我已经阅读了大约 2 打文章以及 Google 文档和我的代码，因为它只是给了我一个强制关闭框。这是我的代码

显现

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.ndai.funnys"
    android:versionCode="1" 
    android:versionName="1.0" >
    <uses-sdk android:minSdkVersion="8"  
        android:targetSdkVersion="15" />
    <uses-permission android:name="android.permission.INTERNET"/>
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".GuysFunnysActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity android:name="com.google.ads.AdActivity"
    android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScreenSize"/>
    </application>
</manifest> 
```

主要的.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout  android:id="@+id/LinearLayout01"
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
    <com.google.ads.AdView android:id="@+id/adView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        ads:adUnitId="a14ffb06b21e68e"
        ads:adSize="BANNER"
        ads:testDevices="TEST_EMULATOR, 12345678901234567890123456789012"
        ads:loadAdOnCreate="true"/>
</LinearLayout> 
```

JAVA

```
package com.ndai.funnys;

import java.io.InputStream;
import java.net.URL;
import android.app.Activity;
import android.graphics.drawable.Drawable;
import android.os.Bundle;
import android.widget.ImageView;
import android.widget.LinearLayout;
import com.google.ads.*;

public class GuysFunnysActivity extends Activity 
{
    @Override
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }
} 
```

我究竟做错了什么？这和我在其他网站上看到的完全一样。即使我使用了测试设备代码，我也尝试过具有相同问题的非 xml 版本。

LOGCAT

```
07-09 17:34:23.207: D/AndroidRuntime(729): Shutting down VM
07-09 17:34:23.207: W/dalvikvm(729): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
07-09 17:34:23.237: E/AndroidRuntime(729): FATAL EXCEPTION: main
07-09 17:34:23.237: E/AndroidRuntime(729): java.lang.RuntimeException: Unable to start activity ComponentInfo    {com.ndai.funnys/com.ndai.funnys.GuysFunnysActivity}: android.view.InflateException: Binary XML file line #8: Error inflating class com.google.ads.AdView
07-09 17:34:23.237: E/AndroidRuntime(729):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
07-09 17:34:23.237: E/AndroidRuntime(729):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
07-09 17:34:23.237: E/AndroidRuntime(729):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
07-09 17:34:23.237: E/AndroidRuntime(729):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
07-09 17:34:23.237: E/AndroidRuntime(729):  at android.os.Handler.dispatchMessage(Handler.java:99)
07-09 17:34:23.237: E/AndroidRuntime(729):  at android.os.Looper.loop(Looper.java:123)
07-09 17:34:23.237: E/AndroidRuntime(729):  at android.app.ActivityThread.main(ActivityThread.java:4627)
07-09 17:34:23.237: E/AndroidRuntime(729):  at java.lang.reflect.Method.invokeNative(Native Method)
07-09 17:34:23.237: E/AndroidRuntime(729):  at java.lang.reflect.Method.invoke(Method.java:521)
07-09 17:34:23.237: E/AndroidRuntime(729):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
07-09 17:34:23.237: E/AndroidRuntime(729):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
07-09 17:34:23.237: E/AndroidRuntime(729):  at dalvik.system.NativeStart.main(Native Method)
07-09 17:34:23.237: E/AndroidRuntime(729): Caused by: android.view.InflateException: Binary XML file line #8: Error inflating class com.google.ads.AdView
07-09 17:34:23.237: E/AndroidRuntime(729):  at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:576)
07-09 17:34:23.237: E/AndroidRuntime(729):  at android.view.LayoutInflater.rInflate(LayoutInflater.java:618)
07-09 17:34:23.237: E/AndroidRuntime(729):  at android.view.LayoutInflater.inflate(LayoutInflater.java:407)
07-09 17:34:23.237: E/AndroidRuntime(729):  at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
07-09 17:34:23.237: E/AndroidRuntime(729):  at android.view.LayoutInflater.inflate(LayoutInflater.java:276)
07-09 17:34:23.237: E/AndroidRuntime(729):  at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:198)
07-09 17:34:23.237: E/AndroidRuntime(729):  at android.app.Activity.setContentView(Activity.java:1647)
07-09 17:34:23.237: E/AndroidRuntime(729):  at com.ndai.funnys.GuysFunnysActivity.onCreate(GuysFunnysActivity.java:20)
07-09 17:34:23.237: E/AndroidRuntime(729):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
07-09 17:34:23.237: E/AndroidRuntime(729):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
07-09 17:34:23.237: E/AndroidRuntime(729):  ... 11 more
07-09 17:34:23.237: E/AndroidRuntime(729): Caused by: java.lang.ClassNotFoundException: com.google.ads.AdView in loader dalvik.system.PathClassLoader    [/data/app/com.ndai.funnys-2.apk]
07-09 17:34:23.237: E/AndroidRuntime(729):  at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:243)
07-09 17:34:23.237: E/AndroidRuntime(729):  at java.lang.ClassLoader.loadClass(ClassLoader.java:573)
07-09 17:34:23.237: E/AndroidRuntime(729):  at java.lang.ClassLoader.loadClass(ClassLoader.java:532)
07-09 17:34:23.237: E/AndroidRuntime(729):  at android.view.LayoutInflater.createView(LayoutInflater.java:466)
07-09 17:34:23.237: E/AndroidRuntime(729):  at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:565)
07-09 17:34:23.237: E/AndroidRuntime(729):  ... 20 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T22:55:45.590

在 Eclipse 中，所有 jar 都必须添加到 libs/ 或专门导出`Order And Export`到`Java Build Path`. 否则，jar 将不会捆绑到您的编译代码中，并且您的应用程序在引用 jar 文件时将在运行时失败。

# actionscript-3 - AS3：通过动态添加的子对象中的实例名称查找对象

> ID：11399814
> 
> 赞同：0
> 
> 时间：2012-07-09T17:07:57.893
> 
> 标签：actionscript-3, air, instance, addchild

我正在做一个 Adob​​e AIR Kiosk 应用程序，但我遇到了一个小问题。

第一步是生成一个网络摄像头容器：

```
var bandwidth:int = 0; 
var quality:int = 100;
var camera:Camera = Camera.getCamera();
camera.setQuality(bandwidth, quality);
camera.setMode(885,575,30,true);
var video:Video = new Video(885,575);
video.attachCamera(camera);
video.name = "camara";
webcam.addChild(video); 
```

它工作正常，问题是我想对其应用自定义过滤器

如果我这样写它就可以了：

```
MovieClip(parent).contenedor_postal.postal.webcam.filters = [filter]; 
```

但我只想影响剪辑“网络摄像头”内的孩子而不影响其他 MC，所以我这样写：

```
MovieClip(parent).contenedor_postal.postal.webcam.camara.filters = [filter]; 
```

并且不起作用。我曾经在 AS2 中编程，所以也许技巧很简单，但我找不到任何有效的方法。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:12:19.310

如果视频具有名称属性“camara”，那么这应该有效：

```
MovieClip(parent).contenedor_postal.postal.webcam.getChildByName("camara").filters = [filter]; 
```

# assembly - 汇编语言如何增加多位十进制ASCII字符串？

> ID：11399820
> 
> 赞同：-1
> 
> 时间：2012-07-09T17:08:16.977
> 
> 标签：assembly, x86

所以我有这部分代码

```
 mov SI, 0002
    mov ah, INPUT[SI]
    INC SI
    mov al, INPUT[SI]
    sub AX, 3030h
    aad
    inc al
    cmp byte ptr INPUT[0002], 39h
    jne OTHER

OTHER: aam
       add ax, 3030h
       mov INPUT[0003], al
       mov INPUT[0002], ah 
```

其中输入是用户输入。这段代码的作用是增加一个 2 位数字，我的问题是，当要增加一个三位数字时。

示例：输入：98 输出：99

输入：99 输出：110

期望的结果：输入：99 输出：100

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T17:14:34.493

您应该使用该`inc`命令，例如：`inc var`，但是我看到您在代码中使用了此命令无济于事。如果`inc`不适合你，还有`add destination, source`

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T18:28:57.953

如果将所有与进位相关的东西都留给 CPU 会简单得多，我建议将输入数字完全转换为整数，递增然后转换回字符串并输出。我想让你考虑一下，所以我会给你一个类似 C 的伪代码，如果你需要更多帮助，我会帮助你将其转换为汇编；）

```
int nInput = 0;

// Converting to decimal
if( input[ 0 ] > '9' ) input[ 0 ] -= 'a' + 10;
else input[ 0 ] -= '0'
nInput += input[ 0 ];

if( input[ 1 ] > '9' ) input[ 1 ] -= 'a' + 10;
else input[ 1 ] -= '0'
nInput += input[ 1 ] * 16;

if( input[ 2 ] > '9' ) input[ 2 ] -= 'a' + 10;
else input[ 2 ] -= '0'
nInput += input[ 2 ] * 256;

if( input[ 3 ] > '9' ) input[ 3 ] -= 'a' + 10;
else input[ 3 ] -= '0'
nInput += input[ 3 ] * 4096;

// Incrementing :)
nInput += 1;

// Converting back to string
char output[ 5 ];

int digit = nInput & 15;
if( digit > 9 ) digit += 'a' + 10;
else digit += '0';
output[0] = digit;

digit = ( nInput & 255 ) / 16;
if( digit > 9 ) digit += 'a' + 10;
else digit += '0';
output[1] = digit;

digit = ( nInput & 4095 ) / 256
if( digit > 9 ) digit += 'a' + 10;
else digit += '0';
output[2] = digit;

digit = ( nInput & 65535 ) / 4096;
if( digit > 9 ) digit += 'a' + 10;
else digit += '0';
output[3] = digit;

output[4] = 0; 
```

这是您应该在汇编中实现的代码。不要盲目地去做，想想你在做什么，为什么！

**提示：**您可以避免所有这些乘法和除法，只需仔细查看您的除法或乘法 :)

# html - “挂钩”浏览器滚动条到只有一个 HTML 元素

> ID：11399826
> 
> 赞同：1
> 
> 时间：2012-07-09T17:08:30.847
> 
> 标签：html, css, scroll, position, scrollbar

当我滚动时，我希望页面中的所有内容都保持不变，除了一个指定的元素。

如何神奇地将一个 HTML 元素“连接”到浏览器的默认滚动条，以便它只影响整个 HTML 文档中的那个元素？...**不使用位置：固定属性**？

我只需要支持 Chrome。

我知道我做梦很疯狂，但我希望 CSS/JavaScript/HTML 向导可以用一些滑稽的装置让我平静下来。

# wcf - WCF 服务的 SOAP 语句

> ID：11399830
> 
> 赞同：0
> 
> 时间：2012-07-09T17:09:00.160
> 
> 标签：wcf, .net-4.0, ibm-midrange, rpgle

我在这里询问了使用 RPG 的 WCF 服务并收到以下回复：Scott Klement 有一个演示文稿和示例：[http ://www.scottklement.com/presentations/#HTTPAPI](http://www.scottklement.com/presentations/#HTTPAPI)

我使用 SoapUI 来测试我的服务，并让他的 soap 语句与 HTTAPI 一起使用。该服务在 SoapUI 中返回数据，但我在 RPG 程序中使用它没有成功。SoapUI 返回以下内容，但它似乎只适用于 SoapUI - 它也不包括我的服务的路径，即

```
http://ServerName/COE/CustByNameList.svc 
```

如果我导航到`http://ServerName/COE/CustByNameList.svc?wdsl,`我会得到 wsdl。

SoapUI 中返回的语句：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:tem="http://tempuri.org/">
   <soapenv:Header/>
   <soapenv:Body>
      <tem:GetCustomerData>
         <!--Optional:-->
         <tem:CustomerNumber>1688</tem:CustomerNumber>
      </tem:GetCustomerData>
   </soapenv:Body>
</soapenv:Envelope> 
```

结果如下所示：

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body><GetCustomerDataResponse xmlns="http://tempuri.org/"><GetCustomerDataResult xmlns:a="http://schemas.datacontract.org/2004/07/" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><a:List xmlns:b="http://schemas.datacontract.org/2004/07/WebOrderEntry.Lists"><b:PartialCSTMS><b:ADR19A>3910 LAKEFIELD DR             </b:ADR19A><b:ADR29A>JOHNS CREEK FACILITY          </b:ADR29A><b:CITY9A>SUWANEE                  </b:CITY9A><b:CST_x0023_9A>1688</b:CST_x0023_9A><b:NAME9A>JOHNSON CONTROLS              </b:NAME9A><b:PHON9A>770-495-9950        </b:PHON9A><b:STAT9A>GA</b:STAT9A><b:ZIPC9A>30024     </b:ZIPC9A></b:PartialCSTMS></a:List></GetCustomerDataResult></GetCustomerDataResponse></s:Body></s:Envelope> 
```

我不断收到 500 个内部服务器错误。根据我看到的示例，我尝试了许多 SOAP 语句的变体，但它们可以追溯到 2008 年。有没有人成功地从 RPG 调用 WCF 服务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T14:18:05.147

我询问了我的 Twitter 网络，[@alexeivbaranov](https://twitter.com/alexeivbaranov)回复了以下内容：

> 尝试使用 TcpMon 比较来自 SoapUI 和 RPG 客户端的请求和响应。据我了解，您的 SoapUI req 工作正常，但 RPG req 得到 500，因此请求出现问题。比较它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T16:16:20.773

检查你的标题。你可能错过了肥皂动作。下面是使用启用了安全性的 WsHttp 绑定公开的对 WCF 服务的请求示例。wsa：行动是你可能需要的东西。

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<soapenv:Envelope
    xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope"
    xmlns:ns="http://somenamespace">
    <soapenv:Header xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <wsa:Action>http://someuri/Get</wsa:Action>
        <wsa:To>http://localhost/someapp/SomeService.svc</wsa:To>
    </soapenv:Header>
    <soapenv:Body>
        <ns:GetRequest>
            <ns:Body>
                <ns:Id>12345</ns:Id>
            </ns:Body>
        </ns:GetRequest>
    </soapenv:Body>
</soapenv:Envelope> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T11:34:39.417

我不得不放弃使用 HTTPAPI 来使用我的 WCF Web 服务——只是无法通过 HTTP 400 和 500 错误。记录没有帮助。我相信我终于设法让 SOAP 调用正确，但随后开始收到似乎转化为特殊字符问题的错误。

相反，我最终使用了 IBM 的 IWS 并让它工作。这两个链接很有帮助：

[http://www.ibm.com/developerworks/ibmi/library/i-amrawsdl2rpg/index.html](http://www.ibm.com/developerworks/ibmi/library/i-amrawsdl2rpg/index.html)

[http://www.iprodeveloper.com/article/rpg-programming/consume-web-services-with-ibms-iws-66209](http://www.iprodeveloper.com/article/rpg-programming/consume-web-services-with-ibms-iws-66209)

# c++ - 为什么运算符重载失败？

> ID：11399832
> 
> 赞同：2
> 
> 时间：2012-07-09T17:09:20.087
> 
> 标签：c++

在以下代码中，我举例说明了运算符重载的示例：

```
#include <iostream>
using namespace std;

template <typename T>
class A
{
public:
    A()   {};
    A( T &obj) {value = obj;};
    ~A() {};
    T value;
    template <typename E>
    A<T>& operator = (const A<E> &obj)
    {
        cout<<"equal operator"<<endl;
        if(this == &obj)
            return *this;

        value = obj.value;
        return *this;
    }

};

int main()
{
    int temp;
    temp = 3;
    A<int> myobjects(temp);
    cout<<myobjects.value<<endl;

    temp = 7;
    A<int> yourobjects(temp);
    yourobjects = myobjects;
    cout<<yourobjects.value<<endl;

    return 0;
} 
```

但是，我在调试这个程序的时候，发现主程序并没有调用等号运算符重载函数。但是，如果我按以下方式更改等号运算符：

```
 A<T>& operator = (const A<T> &obj)
    {
        cout<<"equal operator"<<endl;
        if(this == &obj)
            return *this;

        value = obj.value;
        return *this;
    } 
```

它会起作用的。你有什么想法为什么初始功能不起作用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-09T17:12:21.103

您的赋值运算符的模板版本不会禁止为您的类生成编译器提供的非模板复制赋值运算符。编译器将隐式声明和定义具有以下签名的复制赋值运算符

```
A<T>& operator =(const A<T>&); 
```

在复制分配的重载解决过程中，编译器提供的版本获胜（因为它更专业）。

您的模板版本的赋值运算符只会被考虑用于转换赋值。例如，如果在某些时候您想要将`A<int>`对象分配给`A<double>`对象，则将使用您的模板版本的赋值运算符。但是，当您分配`A<int>`给`A<int>`您的运算符时，将被忽略，因为编译器声明的版本是更好的匹配。

当您声明自己的副本分配版本时

```
A<T>& operator =(const A<T>&); 
```

签名，它会抑制编译器生成的签名。你的版本被使用。

这意味着，如果您想拥有自己的复制赋值运算符*和*模板转换赋值运算符，则需要在类中显式实现*这两者*。

PS作为'@Cheers 和hth。- Alf' 正确指出，您的赋值运算符模板版本在一般情况下甚至无效。指针通常具有不同的不相关类型`this`。`&obj`不允许比较不同不相关类型的指针。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-09T17:13:02.923

`T& operator=(T const&)`如果您没有定义自己的复制赋值运算符，则编译器会自动声明和定义带有签名的复制赋值运算符。

您的赋值运算符模板不是复制赋值运算符，因为它是一个模板（模板永远不是复制赋值运算符）。

在您的示例中，`myobjects`and`yourobjects`都是 type `A<int>`。`operator=`编译器可以选择两种重载：

1.  `A<int>& operator=(A<int> const&)`，由编译器隐式提供，或
2.  `A<int>& operator=(A<int> const&)`，您的模板的专业化。

您会注意到这两个具有完全相同的签名。重载决议的规则之一是在所有其他条件相同的情况下，非模板比模板更可取。隐式声明的复制赋值运算符不是模板，并且您的重载是模板，因此`operator=`选择了隐式声明的。

要禁止隐式声明的复制赋值运算符，您需要声明并定义自己的：

```
A& operator=(A const&) { /* etc. */ } 
```

# localization - 如何本地化 Liferay 博客文章日期显示？

> ID：11399834
> 
> 赞同：0
> 
> 时间：2012-07-09T17:09:35.220
> 
> 标签：localization, internationalization, liferay, blogs, portlet

我们使用带有德语的 Liferay 作为默认用户设置，如下所述：

[http://www.liferay.com/community/wiki/-/wiki/Main/Configure+time+zones+and+locale](http://www.liferay.com/community/wiki/-/wiki/Main/Configure+time+zones+and+locale)

但是，一旦我们使用博客 portlet，博客条目的日期就会以英文格式显示：7/11/12 6:00 AM

有没有办法将默认显示更改为德语格式？

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T22:08:38.043

我无法模拟这个问题，如果我切换到德语 (de)，那么日期会以德语格式显示，请参见屏幕截图：

德语： ![在此处输入图像描述](../Images/15e6187d73ded2a2809d783d38bb9b3c.png)

英语： ![在此处输入图像描述](../Images/363d95bd97e30644f06f0a914b12ad1c.png)

如果我将用户默认语言切换为德语，那么我也会得到德语日期格式：

![在此处输入图像描述](../Images/b3012751fe35c9d7d794fb370c77c047.png)

# python - SQLAlchemy 使用反射建模复杂关系

> ID：11399835
> 
> 赞同：0
> 
> 时间：2012-07-09T17:09:36.057
> 
> 标签：python, sqlalchemy

我正在查询由第三方维护的专有数据库。该数据库有许多表，每个表都包含大量字段。

我的问题涉及三个感兴趣的表，树、站点和仪表。

树表以简单的树结构描述节点。与其他数据一起，它有一个外键引用它自己的主键。它还有一个 Object_Type 字段和一个 Object_ID 字段。Site 和 Meter 表各有许多字段。

**树节点与**仪表**或**站点具有一对一的关系。如果 Object_Type 字段为 1，则 Object_ID 字段指的是 Site 表中的主键。如果为 2，则表示 Meter 表中的主键。

 **按照这个例子[https://bitbucket.org/sqlalchemy/sqlalchemy/src/408388e5faf4/examples/declarative_reflection/declarative_reflection.py](https://bitbucket.org/sqlalchemy/sqlalchemy/src/408388e5faf4/examples/declarative_reflection/declarative_reflection.py)

我正在使用反射来像这样加载表结构

```
Base = declarative_base(cls=DeclarativeReflectedBase)

class Meter(Base):
    __tablename__ = 'Meter'

class Site(Base):
    __tablename__ = 'Site'

class Tree(Base):
    __tablename__ = 'Tree'
    Parent_Node_ID = Column(Integer, ForeignKey('Tree.Node_ID'))
    Node_ID = Column(Integer, primary_key=True)
    children = relationship("Tree", backref=backref('parent', remote_side=[Node_ID]))

Base.prepare(engine) 
```

我已经包含了自我参照关系，并且效果很好。如何使用 Object_ID 作为外键添加两个关系，并对 Object_Type 字段进行适当检查？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T20:28:27.587

首先是关于反思的说明。我发现自己不依赖反思会好得多。

1.  它不需要有效的数据库连接来加载/使用您的代码
2.  它违反了显式优于隐式的python指南。如果您查看代码，最好*查看*元素（列等），而不是让它们在您的视野之外神奇地创建。

这意味着更多的代码但更易于维护。

我建议的原因至少部分是我在您的帖子中看不到架构。

如果您在代码中创建表和类而不是依赖反射，那么您可以更好地控制映射。

在这种情况下，您要使用多态映射

1.  如上所述创建一个 TreeNode 类。
2.  创建 SiteNode 和 MeterNode 作为子类

然后，您的代码将包括以下内容：

```
mapper(TreeNode,tree_table,polymorphic_on=tree_table.c.object_type)
mapper(SiteNode, site_table,inherits=TreeNode,
                 inherit_condition=site_table.c.node_id==tree_table.c.node_id,
                 polymorphic_identity=1) 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T17:02:52.120

对于 tree.object_id 是可以引用 Site 或 Meter 的外键，您可以让 Site 和 Meter 从一个公共基表下降，即连接表继承，或者映射到*同一个*表，即，单表继承，或者正如有人所说，将 Tree 映射到两个不同的表以及一个公共基表。最后一个建议与 TreeNode 已经有一个“类型”字段的想法很吻合。

最后一种可能更容易的选择是直接在 TreeNode 上使用*两个*外键——site_id 和meter_id，以及两个关系，“meter”和“site”；然后使用 Python @property 返回一个或另一个：

```
class TreeNode(Base):
   # ...

   @property
   def object(self):
       return self.meter or self.site 
```**

# jquery - 我的 jQuery 脚本在访问文件时工作，但不能作为 Intranet 站点

> ID：11399836
> 
> 赞同：1
> 
> 时间：2012-07-09T17:09:38.640
> 
> 标签：jquery, jquery-ui, iis-7

问题 - 当我访问我的页面 \\server\d$\Intranet\Homepage.htm 时，一切正常。没有问题。当我访问有一个主页时，“http://server/intranet/homepage.htm”（intranet 不是网站）没有脚本工作。页面/脚本适用于每台电脑，所以这不是浏览器问题。

链接代码 -

```
<meta http-equiv="X-UA-Compatible" content="IE=edge" > <!--Added to see if compatiblity was the issue-->
<link href="css/main.css" rel="stylesheet" type="text/css" /> <!--css works-->
<link href="css/vader/jquery-ui-1.8.21.custom.css" rel="stylesheet" type="text/css" />
<script src="js/jquery-1.7.2.min.js" charset="UTF-8"></script>
<script src="js/jquery-ui-1.8.21.custom.min.js" charset="UTF-8"></script>
<script type="text/javascript" src="js/jquery.scripts" charset="UTF-8"></script> 
```

这与两个版本没有冲突（我已经删除了 1.8.21 并且仍然损坏）。我读过的所有内容都说 IIS 不会限制它的服务，但我不确定。我刚刚开始使用 IIS、jQuery 和一般的编码。非常需要和感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T17:25:09.987

这是最常见的安全问题。尝试启用 Intranet 站点或将域添加到浏览器上的受信任站点。

以下是一些可以帮助您的资源：

*   [http://www.slickit.ca/2009/02/internet-explorer-enable-intranet.html](http://www.slickit.ca/2009/02/internet-explorer-enable-intranet.html)
*   [http://windows.microsoft.com/en-US/windows-vista/Changing-intranet-security-settings](http://windows.microsoft.com/en-US/windows-vista/Changing-intranet-security-settings)

第一个链接应该可以解决问题：

> 控制面板 > Internet 选项 > 安全 > 本地 Intranet > 站点 > 取消选中自动检测 Intranet 网络 > 确定 > 确定

# jquery - 无法使用 jQuery 在 Firefox 中暂停视频

> ID：11399838
> 
> 赞同：0
> 
> 时间：2012-07-09T17:09:42.173
> 
> 标签：jquery, html5-video, mediaelement.js

HTML：

```
<video class="0" autoplay="true" width="586px" height="440" src=""></video> 
```

JS：

```
$('video').mediaelementplayer();

if($('video').attr('class') == "0"){
    $('video')[0].player.pause();
} 
```

在 chrome 中，视频已正确暂停。但是在 Firefox 中它不会暂停。任何想法如何解决这一问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:14:42.657

试试这个：

```
if($('video').attr('class') == "0"){
    $('video')[0].pause();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T10:23:33.817

试试这样：

```
 $("video").get(0).pause(); 
```

...

```
<video class='0' id='video_01'
  controls preload='none'  src="http://media.w3.org/2010/05/sintel/trailer.webm"
  poster="http://media.w3.org/2010/05/sintel/poster.png"   

  <p>Your user agent does not support the HTML5 Video element.</p>
</video>

function callPause(){  
    if($('video').attr('class') == "0"){
     $("video").get(0).pause();
     }
   return false;
   } 
```

小提琴示例：[这里](http://jsfiddle.net/Mk7h7/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T10:26:28.697

这将暂停您的视频

```
$('video[class="0"]').get(0).pause() 
```

演示：http: [//jsbin.com/eyepat/2/edit#javascript,html](http://jsbin.com/eyepat/2/edit#javascript,html)

在旁注类不能以整数开头[http://www.w3schools.com/tags/att_standard_class.asp](http://www.w3schools.com/tags/att_standard_class.asp)

# jquery - jQuery 模板

> ID：11399848
> 
> 赞同：0
> 
> 时间：2012-07-09T17:10:54.627
> 
> 标签：jquery, asp.net-mvc, jquery-templates

这是关于 jQuery 模板

我使用 NuGet 来安装它。信息在[GitHub](https://github.com/jquery/jquery-tmpl)中。所以我想我使用的是正确的包。

`jQuery.tmpl.min.js`在`ASP.NET MVC 4`项目中添加和引用。

问题是，当我测试使用

```
$('#files-list').tmpl(data).appendTo('#Container'); 
```

有用。

但是，如果我更改为：

```
var t = "div" + tmplName;
$(t).tmpl(data).appendTo('#Container'); 
```

它失败。FireBug 给了我一些控制台错误，例如`$(t).tmpl(data).appendTo is not a function`.

谁能告诉我为什么我不能这样做？我该如何解决？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T19:20:49.257

为什么你得到那个异常是因为你没有一个带有 id`t`或`"div" + tmplName`. 确保您有一个带有传递 id 的脚本块。

前任。

```
<script id="movieTemplate" type="text/x-jquery-tmpl"> 
    <li><b>${Name}</b> (${ReleaseYear})</li>
</script>

<script>
var movies = [
    { Name: "The Red Violin", ReleaseYear: "1998" },
    { Name: "Eyes Wide Shut", ReleaseYear: "1999" },
    { Name: "The Inheritance", ReleaseYear: "1976" }
];

$("#movieTemplate" ).tmpl(movies).appendTo("#movieList");
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T19:25:43.233

这个：

```
var t = "div" + tmplName; 
```

永远不能等于：

```
'#files-list' 
```

你不想要更多类似的东西：

```
var t = '#' + tmplName; 
```

# php - 将数据推送到页面而不定期检查？

> ID：11399857
> 
> 赞同：6
> 
> 时间：2012-07-09T17:11:37.887
> 
> 标签：php, javascript, jquery, mysql, ajax

有什么方法可以将数据推送到页面而不是定期检查？

显然，您可以使用 ajax 定期检查它，但是有什么方法可以在执行 php 脚本时强制页面重新加载？

从理论上讲，您可以通过仅在应该执行 ajax 函数时使用表来提高 ajax 请求的速度（当 ajax 函数应该从数据库中检索新数据时更新表中的值），但这仍然需要大量内存和 mysql 连接以及在查询执行时仍有一些等待时间，即使没有更新/您不想执行检索数据库数据的 ajax 函数。

有什么方法可以比查询数据库和检查存储“如果更新”数据的表或告诉 ajax 函数从另一个页面执行更有效吗？

我猜 node.js 或 HTML5 webSocket 也可能是一个可行的解决方案？

或者您可以将“如果更新”数据存储在文本文件中？欢迎任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T17:20:49.567

您基本上是在谈论通知客户端（即浏览器）**服务器端事件**。这实际上归结为两件事：

1.  您使用的是什么网络服务器？（您是否仅限于特定语言？）
2.  您需要支持哪些浏览器？

您最好的选择是使用**WebSockets**来完成这项工作，除了使用 web-sockets 之外的任何事情都是一种黑客行为。尽管如此，许多“hacks”都可以正常工作，我建议您尝试**[Comet](http://en.wikipedia.org/wiki/Comet_%28programming%29)**或**AJAX long-polling**。

有一个名为[Atmosphere](https://github.com/Atmosphere/atmosphere)的项目（以及更多项目）为您提供适合您正在使用的 Web 服务器的解决方案，然后会根据用户的浏览器自动选择最佳选项。

如果您不受浏览器的限制并且可以选择您的网络堆栈，那么我建议使用[SocketIO](http://socket.io/) + [nodejs](http://nodejs.org/)。这只是我现在的偏好，*WebSockets 仍处于起步阶段，一旦它开始发展，事情就会变得有趣*。有时我的整个应用程序并不适合 nodejs，所以我将把数据操作单独卸载给它。

祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T17:28:22.530

Another possibility, if you can store the data in a simple format in a file, you update a file with the data and use the web server to check its timestamp.

Then the browser can poll, making HEAD requests, which will check the update times on the file to see if it needs an updated copy.

This avoids making a DB call for anything that doesn't change the data, but at the expense of keeping file system copies of important resources. It might be a good trade-off, though, if you can do this for active data, and roll them off after some time. You will need to ensure that you manage to change this on any call that updates the data.

It shares the synchronization risks of any systems with multiple copies of the same data, but it might be worth investigating if the enhanced responsiveness is worth the risks.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T17:15:27.570

曾经有一种称为“服务器推送”的技术，它让一个 Web 服务器进程坐在那里等待脚本的更多输出，并在它出现时将其转发给客户端。这是 1995 年最热门的新技术，虽然你可能仍然可以做到，但没有人这样做，因为这是一个非常糟糕的想法。

所以，是的，你可以，但是当你到达那里时，你很可能希望你没有。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T17:14:14.430

好吧，您可以（或将要）使用 HTML5 套接字。

此页面包含有关此技术的一些重要信息：

[http://www.html5rocks.com/en/tutorials/websockets/basics/](http://www.html5rocks.com/en/tutorials/websockets/basics/)

# jquery - 加载消息 Jquery mobile

> ID：11399858
> 
> 赞同：0
> 
> 时间：2012-07-09T17:11:44.050
> 
> 标签：jquery, css, html, jquery-mobile

我正在使用 jquery mobile 开发移动应用程序。每当被`showPageLoadingMsg()`调用时，它都会执行下面的`".ui-loader"`类。但是，我想加载外部图像。可能吗？

```
.ui-loader { display: none; position: absolute; opacity: .85; image:url('img/loader.gif'); z-index: 100; left: 50%; width: 200px; margin-left: -130px; margin-top: -35px; padding: 10px 30px; } 
```

帮助将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T11:38:45.507

Use `background-image:url('img/loader.gif');`

# c# - 创建日期和平均值查询

> ID：11399863
> 
> 赞同：0
> 
> 时间：2012-07-09T17:12:01.423
> 
> 标签：c#, sql, linq

我需要从数据上下文的表中选择日期和平均值，并且需要按年份和月份对其进行分组。在 SQL 中，它看起来像这样

```
select Year(data) as years, Month(data) as months, Avg(value) as prices from Prices
group by Year(data),MONTH(data)
order by years, months 
```

我创建了一个 LINQ 查询

```
var query0 = from c in dc.Prices
             where Convert.ToDateTime(c.data).CompareTo(left) >= 0
                   && Convert.ToDateTime(c.data).CompareTo(right) <= 0
                   && c.idsticker.Equals(x)
              group c by new { ((DateTime)c.data).Year, ((DateTime)c.data).Month }
                    into groupMonthAvg
              select groupMonthAvg; 
```

但我不知道如何在结果中获得平均值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:20:27.023

只需在您的 中使用[Average](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.average.aspx)函数`select`：

```
var query0 = from c in dc.Prices
         where Convert.ToDateTime(c.data).CompareTo(left) >= 0
               && Convert.ToDateTime(c.data).CompareTo(right) <= 0
               && c.idsticker.Equals(x)
          group c by new { ((DateTime)c.data).Year, ((DateTime)c.data).Month }
                into groupMonthAvg
          select new {
              groupMonthAvg.Key.Year, 
              groupMonthAvg.Key.Month, 
              YearAverage = groupMonthAvg.Average(x=>x.Year),
              MonthAverage = groupMonthAvg.Average(x=>x.Month)
              }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T17:21:05.397

这应该这样做：

```
var query0 = from c in dc.Prices
             where Convert.ToDateTime(c.data).CompareTo(left) >= 0
                   && Convert.ToDateTime(c.data).CompareTo(right) <= 0
                   && c.idsticker.Equals(x)
              group c by new { ((DateTime)c.data).Year, ((DateTime)c.data).Month }
                    into groupMonthAvg
              select new { Year = groupMonthAvg.Key.Year, Month = groupMonthAvg.Key.Month, Average => groupMonthAvg.Average(i => i.value) }; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T17:22:10.500

使用平均功能。

```
var query0 = from c in dc.Prices
             where Convert.ToDateTime(c.data).CompareTo(left) >= 0
                   && Convert.ToDateTime(c.data).CompareTo(right) <= 0
                   && c.idsticker.Equals(x)
              group c by new { ((DateTime)c.data).Year, ((DateTime)c.data).Month }
                    into groupMonthAvg
              select new
              {
                  years = groupMonthAvg.Key.Year,
                  months = groupMonthAvg.Key.Month,
                  prices = groupMonthAvg.Average(x=>x.value)
              }; 
```

# python - 匹配索引值

> ID：11399865
> 
> 赞同：-1
> 
> 时间：2012-07-09T17:12:05.583
> 
> 标签：python, list, indexing, matching

这是我当前的代码。我想检查两个值（行）以检查文件中的匹配项。

```
def checkOS():
    fid1 = open("C:/Python/NSRLOS.txt", 'r')
    fid2 = open("C:/Python/sha_sub_hashes.out", 'r')
    outdata = open("osMatches.txt", 'w')
    line1 = fid1.readline()
    line2 = fid2.readline()
    while(line1 and line2):
        xline= line1.split(',')[1]
        yline = line2.split("|")[3]
        zline = xline.replace('"','')
        if (yline == zline):
            outdata.append([yline , zline])
            print xline, zline

if __name__=="__main__":
    checkOS() 
```

唯一的问题是我不确定我写的是什么，if 语句之前的所有代码都只是重新格式化以便能够从行的索引中提取。我想知道的是我使用的语句是否在这种意义上有效并且有效？然后我想输出相等的值。以下是文件中的一些行：

```
file2:
"10","Amstrad 6128","Unknown","1006"
"100","Macintosh 9.0","8.5.1","67"
"101","Macintosh 9.0.4","na","67"
"102","Macintosh 9.1","9.1","67"
"103","Macintosh 9.2","9.2","67"
"104","Macintosh 9.2.2","9.2.2","67"
"105","Macintosh 9.x","9.X","67"
"106","Macintosh X","10","67"
"107","Macintosh7.5.3","7.5.3","67"
"108","NetWare","n/a","674"
"109","Novel Dos 7.0","7","609"
"11","Apple II+","Unknown","67"
"110","OS/2","Unknown","427"

file2:

    DD84270022E57F1850C8454FA432ADFF99588157B|index.docbook|2225|Redhat 7.3 (32bit)|Linux

D84270022E57F1850C8464F5432ADFF99588157B|index.docbook|2225|Redhat 8.0 (32bit)|Linux

26EEEB25D7005F9FF9EE05A8084C77242702FBAD|Localizable.strings|2142|Mac OS X 10.4|OSX

34DC3D728C34E32F090307F575254D57E53C53FF|SYSTEM|10747904|Windows 7 Home Premium (32bit)|Windows

279E5A766C88EEA5AB946A0AF8D0C4FC366B2AF9|totem.devhelp|21324|Linux Ubuntu Desktop 9.10 (32bit)|Linux

279E5A766C88EEA5AB964A0AF8D0C4FC366B2AF9|totem.devhelp|21324|Linux Ubuntu Desktop 9.10 (64bit)|Linux

B3D11390AB8683BBE443A415EDD91BFDFD482134|dslconfig.pyc|6246|Redhat 9.0 (32bit)|Linux 
```

现在您可能不会在这几行中找到任何直接匹配项，但我知道在该行的某个地方至少会有一个匹配项，因为我在浏览文件时看到了这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:20:07.710

你可能正在寻找这样的东西：

使用`with()`它会自动为您关闭文件。

```
def checkOS():
    with open("C:/Python/NSRLOS.txt") as fid1,open("C:/Python/sha_sub_hashes.out") as fid2,open("osMatches.txt", 'w') as outdata:
        for xline,yline in zip(fid1,fid2):  #zip fetches lines from both files one by one                                           
            xline= xline.split(',')[1]      #use itertools.izip instead of zip if you're on python 2.x
            yline = yline.split("|")[3]
            zline = xline.replace('"','')
            if yline == zline:                
                outdata.write("{0}{1}\n".format(yline , zline)) #use write to write the data back

if __name__=="__main__":
checkOS() 
```

# php - 带有 CakePHP Auth 组件的唯一用户名和电子邮件

> ID：11399866
> 
> 赞同：2
> 
> 时间：2012-07-09T17:12:07.183
> 
> 标签：php, cakephp, user-registration

我是 Cake 的新手，我正在构建一个应用程序来学习它。我的用户注册系统遇到了一些问题。`Users`到目前为止，这是我在控制器中的注册码：

```
public function register() {
    $this->set('title_for_layout', 'Register');
    if ($this->request->is('post')) {
        $this->User->create();
        if ($this->User->save($this->request->data)) {
            $this->Session->setFlash('The user has been saved');
            $this->redirect(array('action' => 'register'));
        } else {
            $this->Session->setFlash('The user could not be saved. Please, try again.');
        }
    }
} 
```

在我的`User`模型中，我有这种方法来散列密码：

```
public function beforeSave() {
    if (isset($this->data[$this->alias]['password'])) {
        $this->data[$this->alias]['password'] = AuthComponent::password($this->data[$this->alias]['password']);
    }
    return true;
} 
```

这行得通，用户`users`使用他们的用户名、电子邮件和散列密码添加到我的数据库中的表中。但是，没有进行检查以确保用户名和电子邮件是唯一的。

根据我有限的理解，我需要向我的`User`模型添加一些验证规则，以确保用户名和电子邮件字段在输入表之前是唯一的？目前我只有这些验证规则：

```
public $validate = array(
    'username' => array(
        'required' => array(
            'rule' => array('notEmpty'),
            'message' => 'A username is required'
        )
    ),
    'email' => array(
        'required' => array(
            'rule' => array('notEmpty'),
            'message' => 'An email is required'
        )
    ),
    'password' => array(
        'required' => array(
            'rule' => array('notEmpty'),
            'message' => 'A password is required'
        )
    )
); 
```

此外，我的注册表单有一个`Password (confirm)`名为`passwordConf`. 我想检查用户在输入用户表之前是否正确输入了他的密码，但我不知道该怎么做。我猜想在我的注册方法的某个地方我需要检查两个密码是否相同。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T21:03:44.090

isUnique 规则将适用于您的用户名和电子邮件字段。下面是一个代码示例，展示了如何在每个字段中使用多个规则：

```
public $validate = array(
    'username' => array(
        'required' => array(
            'rule' => array('notEmpty'),
            'message' => 'You must enter a username.'
        ),
        'length' => array(
            'rule' => array('between', 3, 15),
            'message' => 'Your username must be between 3 and 15 characters long.'
        ),
        'unique' => array(
            'rule'    => 'isUnique',
            'message' => 'This username has already been taken.'
        )
    ),
    'password' => array(
        'required' => array(
            'rule' => array('notEmpty'),
            'message' => 'You must enter a password.'
        ),
        'length' => array(
            'rule' => array('minLength', '6'),
            'message' => 'Your password must be at least 6 characters long.'
        )
    ),
        'email' => array(
            'email' => array(
            'rule'    => array('email'),
            'message' => 'Please enter a valid email address.'
        )
    )
); 
```

至于比较密码，只需编辑您的 beforeSave 回调并检查密码，如果匹配则返回 true，否则返回 false。像这样的东西：

```
public function beforeSave() {
    if (isset($this->data[$this->alias]['password'])) {
        if($this->data[$this->alias]['password'] === $this->data[$this->alias]['passwordConf']) {
            $this->data[$this->alias]['password'] = AuthComponent::password($this->data[$this->alias]['password']);
            return true;
        } else {
            return false;
        }
    }
    return true;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-09T17:52:07.820

CakePHP 实际上有一个名为 的验证规则`isUnique`，您可以使用它来检查用户名和电子邮件。可以在[此处](http://book.cakephp.org/1.3/view/1152/Core-Validation-Rules)找到内置规则列表。您可以使用这个和[数据验证教程](http://book.cakephp.org/1.3/en/view/1143/Data-Validation)来检查用户名和电子邮件。至于检查密码是否相同，您可以使用`EqualTo`规则列表中显示的规则，假设您可以在每个请求中即时制定验证规则。

# c# - 实例化后跟赋值编译，但是

> ID：11399871
> 
> 赞同：1
> 
> 时间：2012-07-09T17:12:21.793
> 
> 标签：c#, generics, dictionary, reference

我想允许用户在搜索鸭嘴兽时输入鸭嘴兽的 ID 或名称（或名称的一部分）。

数据库现在已关闭，因此我无法测试此代码，但我分配给 kvp 两次的事实似乎不正确。无论如何，首先我的代码：

```
String SearchVal = textBoxPlatypusNumOrPartialName.Text.Trim();
int PlatypusID;
int.TryParse(SearchVal, out PlatypusID);

Dictionary<int, string> CandidatePlatypusDict = PlatypusID > 0 ? PlatypusSetupData.GetPlatypusById(PlatypusID) :        PlatypusSetupData.GetCandidatePlatypusFromName(SearchVal);

KeyValuePair<int, String> kvp = new KeyValuePair<int, string>();
using (var getPlatypusIDAndNameDlg = new GetPlatypusForm(CandidatePlatypusDict)) {
    DialogResult dr = getPlatypusIDAndNameDlg.ShowDialog();
    if (dr == DialogResult.OK) {
        kvp = getPlatypusIDAndNameDlg.PlatypusKVP; 
    }
} 
```

...现在，如果我尝试这样做：

```
KeyValuePair<int, String> kvp; // = new KeyValuePair<int, string>(); 
```

我得到：“使用未分配的局部变量'kvp'”

而且我不能将 null 分配为 KeyValuePair，因为它是不可为 null 的类型。

这个 kvp 的实例化然后分配给它可以吗，如果不是，我该如何解决它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T17:15:18.443

> 这个 kvp 的实例化然后分配给它可以吗，如果不是，我该如何解决它？

好吧，*没关系*- 但你可能想要：

```
KeyValuePair<int, String> kvp;
using (...) {
   kvp = dr == DialogResult.OK ? getPlatypusIDAndNameDlg.PlatypusKVP 
                               : /* some other value here */;
} 
```

这样，它显然只分配了一次，但*总是*被分配。接下来，您需要确定在not的情况下您*希望*它具有什么价值。`dr``DialogResult.OK`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T17:18:12.130

如果您的 KeyValuePair 为空有意义，则将其声明为可为空：

```
KeyValuePair<int, String>? kvp = null; 
```

但请确保稍后在代码中正确使用可空性（完全是一个词）。

编辑：

利用它现在拥有的属性

```
kvp.HasValue;
kvp.Value; 
```

和方法

kvp.GetValueOrDefault();

# python - 使 APScheduler 在 Web 应用程序的后台运行

> ID：11399879
> 
> 赞同：4
> 
> 时间：2012-07-09T17:13:14.043
> 
> 标签：python, scheduling, flask, job-scheduling

我有一个 Flask 网络应用程序，它显示来自 rss 提要的信息。我想定期处理 rss 提要，例如每 30 分钟一次。提取一些信息并将其存储在 sqlite 数据库中。

但我不知道如何将功能安排到特定的时间间隔。

我使用了 APScheduler，我的代码如下：

```
def main():
    # Start the scheduler
    filename = os.path.abspath(os.path.join(os.path.dirname( __file__ ), '..', 'tmp')) + '\\' + 'spider.log'
    logging.basicConfig(filename=filename, level=logging.DEBUG,format='%(levelname)s[%(asctime)s]: %(message)s')
    sched = Scheduler()
    sched.start()
    sched.add_interval_job(run_job, minutes=30)
    time.sleep(9999) 
```

我有一个**run.py**函数

```
from app import app, spider

spider.main()
app.run(debug=True) 
```

`app.run(debug=True)`启动 Flask Web 应用程序。问题是代码永远不会到达`app.run`.

那么是否可以产生另一个进程来处理`spider.main()`调用，并在后台运行该进程？还是我应该使用另一种方法？

**注意：**我知道我可以使用 Flask-Celery，但是对于这个小应用程序来说，这似乎太重量级了......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T01:51:36.973

你不需要`time.sleep`- 当你运行`spider.main`它时，它会启动你的调度程序，然后让进程休眠 9999 秒 - 之后它将运行下一行。因此`app.run`将在开始后约 2.78 小时`spider.main`开始。

所以`spider`应该是这样的：

```
def main():
    # Start the scheduler
    filename = os.path.abspath(os.path.join(os.path.dirname( __file__ ), '..', 'tmp')) + '\\' + 'spider.log'
    logging.basicConfig(filename=filename, level=logging.DEBUG,format='%(levelname)s[%(asctime)s]: %(message)s')
    sched = Scheduler()
    sched.start()
    sched.add_interval_job(run_job, minutes=30) 
```

# c - 将短字符串与小字典（解析）进行比较的最有效方法

> ID：11399880
> 
> 赞同：2
> 
> 时间：2012-07-09T17:13:20.860
> 
> 标签：c, algorithm, parsing, lexical-analysis

我正在尝试优化我只是为了好玩而制作的简单 C 解释器，我正在做这样的解析 - 首先我将文件解析为双向链表中的标记，然后我进行语法和语义分析。
我想用这个原型优化功能：

bool parsed_keyword(struct token *, char dictionary[][]);

在函数内部，我基本上针对*所有关键字*调用 strcmp并编辑令牌类型。这当然会导致（几乎）每个正在解析的字符串调用 20 次 strcmp 调用。

我在想 Rabin-Karp 会是最好的，但在我看来它并不最适合这项工作（将一个单词与小字​​典匹配）。完成这项工作的最佳算法是什么？感谢您的任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T17:18:22.887

哈希表可能是我解决这个特定问题的选择。它将提供`O(1)`对您大小的表的查找。不过，trie 也是一个不错的选择。

但是，最简单的实现方法是将单词按字母顺序放在一个数组中，然后`bsearch`从 C 库中使用。它应该几乎和哈希或特里一样快，因为您只处理 30 个单词。它实际上可能比哈希表更快，因为您不必计算哈希值。

Steve Jessop 的想法是一个很好的想法，将您的字符串首尾相连地排列在相同大小的字符数组中。

```
const char keywords[][MAX_KEYWORD_LEN+1] = {
 "auto", "break", "case", /* ... */, "while"
};

#define NUM_KEYWORDS sizeof(keywords)/sizeof(keywords[0])

int keyword_cmp (const void *a, const void *b) {
    return strcmp(a, b);
}

const char *kw = bsearch(word, keywords, NUM_KEYWORDS, sizeof(keywords[0]),
                         keyword_cmp);

int kw_index = (kw ? (const char (*)[MAX_KEYWORD_LEN+1])kw - keywords : -1); 
```

如果您还没有它，您应该考虑获取一份[编译器：原理、技术和工具](https://rads.stackoverflow.com/amzn/click/com/0321486811)。由于它的封面，它通常被称为*龙书*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T17:21:54.990

如果您正在寻找效率，我会说 Rabin Karp 不是您的最佳选择，而 Boyer-Moore 会发现您的最佳效率，尽管实施起来要困难一些。

如果您这样做是为了好玩，老实说，我认为没有必要进行优化，因为这些调用仍应在很短的时间内运行，并且您并不真的需要它以行业速度运行。

如果您正在尝试使用字符串匹配算法，这是一个很酷且有用的目标，我建议您研究 KMP 算法和 Boyer-Moore 算法，这两种算法都会在实施过程中教给您很多东西。

当然还有其他更直接的方法，比如字典查找和简单的二进制搜索等……，但这些方法并没有真正优化你正在处理字符串的事实，字符串比较是一个非常有趣的领域，你将不可避免地运行在某个时候进入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T21:01:03.963

假设您的关键字没有改变，这听起来像是[完美哈希函数](http://en.wikipedia.org/wiki/Perfect_hash_function)的正确案例。完美的散列函数将输入映射到整数（如常规散列函数），但没有冲突。

[维基百科](http://en.wikipedia.org/wiki/Perfect_hash_function#External_links)有几个完美的哈希生成器的链接，包括[GNU gperf](http://www.gnu.org/software/gperf/manual/gperf.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T17:24:11.127

进行查找时首先想到的就是使用一个排序的键盘数组，然后对它们进行二分搜索。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-09T20:36:41.130

如果关键字集是固定的，您可以使用完美散列，例如使用[gperf](http://www.gnu.org/software/gperf/)。这只需要不断的工作和单个字符串比较，因此可能比其他方法更快。

# c# - Lync sdk 自动拨号

> ID：11399881
> 
> 赞同：2
> 
> 时间：2012-07-09T17:13:21.030
> 
> 标签：c#, .net, lync, lync-2010

我刚开始使用 SDK 使用 Lync API。是否可以使用手机号码呼叫不在联系人列表中的人？这是我的代码（我为此使用自动化）：

```
LyncClient lyncClient = LyncClient.GetClient();
var automation = LyncClient.GetAutomation();
var conversationModes = AutomationModalities.Audio;
var conversationSettings = new Dictionary<AutomationModalitySettings, object>();
List<string> participants = new List<string>();
var contact = lyncClient.ContactManager.GetContactByUri("+1 (111) 1111111");
participants.Add(contact.Uri);
automation.BeginStartConversation(AutomationModalities.Audio, participants, null, StartConversationCallback, automation); 
```

如果`+1 (111) 1111111`我的联系人列表中存在有电话的用户，它可以正常工作，但如果用户不存在或者它是我自己的电话号码，那么我无法拨打电话。我没有打电话，而是看到弹出窗口“转接电话”，它允许我从我的联系人列表中手动选择一个人来打电话。

有什么解决办法吗？我只想像使用 MS Lync 桌面客户端一样拨打任何电话号码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T18:06:10.977

所以不起作用的原因是因为`lyncClient.ContactManager.GetContactByUri("+1 (111) 1111111");`没有给你一个有效的联系人，因为它不在你的联系人列表中。而不是搜索联系人，只需执行以下操作：

```
participants.Add("tel:+15555555555"); 
```

这将使用一个`telUri`有效的 URI 来开始对话。

# css - 仅当从 Windows Server 提供时，背景图像才在 IE7 中显示

> ID：11399884
> 
> 赞同：1
> 
> 时间：2012-07-09T17:13:55.700
> 
> 标签：css, internet-explorer-7, windows-server

我有一个 h2 上的背景图像，当从我的 Linux 服务器提供时显示在 IE7 中，但从我的 Windows 服务器提供时不显示：

```
#QandA .question h2, #QandA .question h3 {
        background:url(../images/nav_level2_closed.gif) no-repeat -20px -1px;
    padding-left : 25px;
} 
```

我尝试在 url 上使用引号，使用非相对引用，并确保指定的文件名与服务器上的文件名完全相同（通过 WS-FTP 查看文件列表时）

任何想法将不胜感激。

# ruby-on-rails - 如何调试 Rails 应用程序？

> ID：11399890
> 
> 赞同：2
> 
> 时间：2012-07-09T17:14:39.360
> 
> 标签：ruby-on-rails, ruby, debugging

我是 Ruby on Rails 的新手，我面临着许多我不知道的逻辑错误。像普通程序员一样，解决错误的方法是先调试它。我可以知道如何调试它吗？因为当我尝试这样做时，它已经向我显示了一个错误：

“未捕获的异常：未初始化的常量 Object::ApplicationController”

我可以知道如何解决这个错误以及如何调试吗？谢谢！:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-09T17:53:04.480

您可以在代码中以快速而肮脏的方式进行操作：

```
raise my_object.inspect 
```

这将引发有关对象信息的异常。

或者使用[ruby​​-debug](http://bashdb.sourceforge.net/ruby-debug.html) gem。

我建议您阅读 Rails 文档中的[调试 Rails 应用程序](http://guides.rubyonrails.org/debugging_rails_applications.html)一章。

# android - 如何让 AdMob 在 Android 2.3.3 上运行

> ID：11399892
> 
> 赞同：0
> 
> 时间：2012-07-09T17:14:47.540
> 
> 标签：android, admob

我按照在我的应用程序中添加 AdMob 的说明操作，并根据建议的 API 级别编译了我的代码，它编译得很好，当我尝试在模拟器或我的设备上测试应用程序时它不起作用，应用程序崩溃了我导航到具有 AdMob 的活动。

我搜索并尝试了堆栈溢出中的所有线程，但似乎没有一个对我有用，当其他发布相同问题的人说他们在有人回答后说它对他们有用但他们的解决方案似乎没有时，我感到很惊讶努力使没有人抱怨的应用程序崩溃。

我尝试了从 4 到最新版本 6 的许多版本的 AdMob，但似乎都不起作用。任何帮助或建议我做错了什么？

顺便说一句，我什至启动了一个 4.0.3 的新应用程序，但应用程序仍然崩溃。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T21:26:26.673

确保将库放置在`libs`项目目录或 Java 构建路径中，明确`export`放置它，以便在您的应用程序编译时将其捆绑到您的 .apk 文件中。

# spring - 如果 ttl 过期，Java Spring Cache 中是否有重新计算值异步的功能？

> ID：11399895
> 
> 赞同：1
> 
> 时间：2012-07-09T17:14:59.183
> 
> 标签：spring, caching, asynchronous

如果 TTL，有没有办法配置缓存行为，如异步重新计算缓存？由于查询可能太重 - 我更愿意从缓存中返回一个值，但我也想触发重新计算，直到重新计算该值 - 从缓存中返回它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T17:27:37.333

Spring 提供了对现有缓存库（如[ehcache](/questions/tagged/ehcache "显示标记为“ehcache”的问题") ）的抽象。所以你应该看看你的缓存提供者。例如，在 EhCache 中，您可以从[`UpdatingSelfPopulatingCache`](http://ehcache.org/apidocs/net/sf/ehcache/constructs/blocking/UpdatingSelfPopulatingCache.html)- 但它是阻塞的。

# google-places-api - Google Places API：textSearch 是否支持多个页面结果？

> ID：11399901
> 
> 赞同：0
> 
> 时间：2012-07-09T17:15:20.410
> 
> 标签：google-places-api

我正在尝试使用 next_page_token 参数从 textSearch 调用中获取下一页结果，但总是收到 REQUEST DENIED 错误。根据[Accessing Additional Results in google places search](https://stackoverflow.com/questions/11248434/accessing-additional-results-in-google-places-search)，文档中存在错误，应使用 pagetoken 而不是 page_token。我都试过了，但对我不起作用。如果多页结果可用于 textSearch，我在文档中找不到任何地方。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T11:34:27.803

应为下一页查询指定“传感器”参数。根据文档“设置 pagetoken 将导致任何其他参数被忽略”，但事实并非如此，您必须指定“传感器”和“关键”参数。

# macos - 自定义视图 (MacOS)

> ID：11399904
> 
> 赞同：0
> 
> 时间：2012-07-09T17:15:29.053
> 
> 标签：macos, nsview, custom-view

我需要使用自定义视图（NSView *mainContent），并根据用户从 NSPopUpButton 中的选择将视图换成不同的 nib。弹出按钮的 IBAction 方法如下所示：

```
- (IBAction)menuSelected:(NSPopUpButton *)sender {

NSInteger index = [sender indexOfSelectedItem];
NSLog(@"Selected button index is %ld", index);

[dynamicTitle.cell setTitle:[self returnSectionTitle:index]];
NSLog(@"%@", dynamicTitle.stringValue);

switch (index) {
    case 0:
        Sect1 = [[Sect1_View alloc] initWithNibName:@"Sect1_View" bundle:nil];
        maincontent = Sect1.view;
        [maincontent release];
        break;
    case 1:
    Sect2 = [[Sect2_View alloc] initWithNibName:@"Sect2_View" bundle:nil];

        break;
    case 2:
    Sect3a = [[Sect3a_View alloc] initWithNibName:@"Sect3a_View" bundle:nil];

        break;
    case 3:
    Sect3b = [[Sect3b_View alloc] initWithNibName:@"Sect3b_View" bundle:nil];    

        break;
    case 4:
    Sect3c = [[Sect3c_View alloc] initWithNibName:@"Sect3c_View" bundle:nil];    

        break;
    case 5:
    Sect4 = [[Sect4_View alloc] initWithNibName:@"Sect4_View" bundle:nil];    

        break;

    default:
        break;

    } 
```

}

这似乎没有检索到新的笔尖，关于如何实现这一点的任何建议？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T22:13:34.650

NSView 不理解消息 initWithNibName:bundle:，它是你想要的 NSViewController。您可以在每个 nib 中放置一个视图和附加的控制器，然后使用此消息加载控制器，如果这是您想要做的。

我认为编译器会给您发送有关发送可能无法处理的消息的警告，并且系统日志也会在运行时发出警告。我错了吗？

# php - 通过 PHP cURL 创建 Google 日历活动时“需要登录”？

> ID：11399906
> 
> 赞同：2
> 
> 时间：2012-07-09T17:15:35.540
> 
> 标签：php, curl, google-calendar-api

我已经多次发现这个问题，但我找不到解决方案的单个实例，所以我正在尝试自己。

我正在创建一个简单的 Web 应用程序来帮助我的雇主将活动安排到 Google 日历中。我已经创建了日历，用 Google API 注册了它，并编写了 cURL 函数来检查现有的约会和返回时间和日期。我挂断了创建新事件的功能。我编写的函数（为清楚起见扩展了一些变量名）如下：

```
function post_cal($url, $header, $post_content)
{
   global $authtoken, $curlDefaults;
   $request = $url;
   $headers = array('Content-Type: application/json; Authorization: OAuth ' . $authtoken . $header);
   $options = array (
      CURLOPT_URL => $request,
      CURLOPT_HTTPHEADER => $headers,
      CURLOPT_POST => 1,
      CURLOPT_POSTFIELDS => $post_content,
   );
   $ch = curl_init();
   curl_setopt_array($ch, ($curlDefaults + $options));
   $result = curl_exec($ch);
   curl_close($ch);
   $json = json_decode($result, true);
   return $json;
} 
```

当我尝试像这样运行 post_cal 函数时，我得到一个“401 - 需要登录”错误对象：

```
$scheduled = post_cal('https://www.googleapis.com/calendar/v3/calendars/xxxxxx/events, '', $apptInfo); 
```

cURL 函数与我用来读取事件和返回现有值的函数几乎相同——两者都可以正常工作！我使用相同的 $authtoken 变量，该变量是通过明确定义了“https://www.googleapis.com/auth/calendar”范围的刷新令牌收集的。我已经阅读并重新阅读了 Google OAuth 文档，但似乎无法准确找到此错误的来源。

$apptInfo 是一个数组，编码为 JSON，包含约会信息，包括开始和结束时间、摘要和描述。

我知道这可以通过 Google 提供的 PHP 库或 Zend/GData 框架更轻松地完成。但是，我正在使用这个项目作为自学 PHP 的一种方式——在此之前我对它的经验很少——并且想至少了解登录错误的来源，以及在跌倒之前如何克服它回到现有的快捷方式。因为这不是一个必要的项目，所以我有大量的时间在我身边；这只是我想帮忙的事情。

谁能向我解释我做错了什么，或者我需要分享哪些进一步的信息来隔离问题？我不想错过这个学习机会！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-29T22:18:35.777

使用萤火虫你可以准确地看到你发送的标题。我想这是一个调试问题，因为一切似乎都很好。但我建议使用谷歌的 PHP API SDK。

```
$events = $service->events->listEvents('primary');

while(true) {
  foreach ($events->getItems() as $event) {
  echo $event->getSummary();
}
$pageToken = $events->getNextPageToken();
  if ($pageToken) {
     $optParams = array('pageToken' => $pageToken);
     $events = $service->events->listEvents('primary', $optParams);
} else {
   break;
 }
} 
```

[https://developers.google.com/google-apps/calendar/v3/reference/events/list](https://developers.google.com/google-apps/calendar/v3/reference/events/list)

# html - 有一个图例会导致 IE 忽略字段集的顶部填充 - 替代方案？

> ID：11399913
> 
> 赞同：2
> 
> 时间：2012-07-09T17:16:12.907
> 
> 标签：html, internet-explorer, padding, legend, fieldset

我正在创建一个表单并遇到了字段集的填充问题。虽然在 Opera、FF 和 Chrome 中看起来一切正常，但 IE 7 和 8 都只是丢弃了字段集中的任何顶部填充。下面的代码正确地在 fielset 的左侧、底部和右侧添加了填充（尽管后者会导致这个[已知问题](https://stackoverflow.com/questions/248483/ie-css-fieldset-border-extends-too-far-to-the-right-why)），但将第一行内容直接放置在图例下方，没有间距：

```
<form>      
  <fieldset style="padding:30px;">
      <legend>Legend</legend>
      <label for="input">Label</label>
      <input type="text" id="input" />  
  </fieldset>    
 </form> 
```

然而，[这个](https://stackoverflow.com/a/5398861/840977)对另一个问题的回答将我指向了传奇标签，事实上，如果我把它排除在外，一切都很好。

所以我的问题是：

是否有解决方法来同时拥有图例标签和填充？我的快速顶部尝试（第一个元素的顶部边缘）没有效果。

或者我是否必须放弃（语义正确的）图例标签并将其替换为（更随意）的东西，如标题？这对屏幕阅读器有什么影响？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T17:35:06.407

是否可以从字段集中删除所有填充，而是在字段集中创建一个添加填充的 div？

```
<form>
  <fieldset>
      <legend>Legend</legend>
      <div style="padding:30px;">
         <label for="input">Label</label>
         <input type="text" id="input" />
      </div>
  </fieldset>
</form> 
```

# ruby-on-rails - 整数范围的 Rails 序列化被破坏

> ID：11399916
> 
> 赞同：1
> 
> 时间：2012-07-09T17:16:29.283
> 
> 标签：ruby-on-rails, ruby, serialization, range, yaml

我需要`Range`在 Rails 上下文中使用 YAML 序列化 ruby​​ 。我想检查整数范围和字符串范围是否正确序列化。

这是我的测试：

```
# classic irb
require 'yaml'         # => true
YAML::VERSION          # => "0.60"
YAML.dump(1..2)        # => "--- !ruby/range \nbegin: 1\nend: 2\nexcl: false\n"
YAML.dump("1".."2")    # => "--- !ruby/range \nbegin: \"1\"\nend: \"2\"\nexcl: false\n" 
```

这两个输出是完全不同的，所以我向前并在我的 rails 应用程序中对其进行了编码。

然而，在 Rails 上下文中，ruby 似乎忘记了如何正确序列化一系列整数！

```
# ./script/rails console
Rails::VERSION::STRING # => "3.0.15"
RUBY_VERSION           # => "1.8.7"
YAML::VERSION          # => "0.60"
YAML.dump(1..2)        # => "--- !ruby/range\n  begin: 1\n  end: 2\n  excl: false"
YAML.dump("1".."2")    # => "--- !ruby/range\n  begin: 1\n  end: 2\n  excl: false"
# The two outputs are identical, the distinction between integers and strings is lost! 
```

ruby 和 ruby​​ on rails 似乎都使用相同版本的 YAML 库。如果我没记错的话，我的 ruby​​ 版本不支持在多个编码器引擎之间切换。

我有几个问题：

1.  造成这种差异的原因是什么？
2.  *新版本的ruby*​​ / *rails*是否会出现此问题？
3.  我怎样才能以兼容的方式正确解决这个问题？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T19:30:13.273

范围是 Ruby 内部的，而不是像整数或字符串这样的 YAML 基本类型。不要像你一样对范围进行编码，而是使用它的起点和终点并在接收端重建范围。

我使用类似的东西：

```
[1] (pry) main: 0> range = 0..1
=> 0..1
[2] (pry) main: 0> require 'yaml'
=> true
[3] (pry) main: 0> YAML.dump(range)
=> "--- !ruby/range\nbegin: 0\nend: 1\nexcl: false\n"
[4] (pry) main: 0> YAML.dump({'min' => range.min, 'max' => range.max})
=> "---\nmin: 0\nmax: 1\n" 
```

然后我可以使用以下方法在接收端重新创建范围：

```
Range.new(*YAML.load(YAML.dump({'min' => range.min, 'max' => range.max})).values)
=> 0..1 
```

或者如果您不确定`'min'`并且`'max'`将按照正确的顺序执行此操作：

```
[19] (pry) main: 0> Range.new(*YAML.load(YAML.dump({'min' => range.min, 'max' => range.max})).values_at('min', 'max'))
=> 0..1 
```

* * *

添加一些关于 Ruby 1.9.3+ 序列化字符范围的信息：

```
[2] (pry) main: 0> range = '0'..'1'
=> "0".."1"
[3] (pry) main: 0> YAML.dump(range)
=> "--- !ruby/range\nbegin: '0'\nend: '1'\nexcl: false\n"

[5] (pry) main: 0> RUBY_VERSION
=> "1.9.3" 
```

再次使用 1.9.2+：

```
[2] (pry) main: 0> range = '0'..'1'
=> "0".."1"
[3] (pry) main: 0> YAML.dump(range)
=> "--- !ruby/range \nbegin: \"0\"\nend: \"1\"\nexcl: false\n"
[4] (pry) main: 0> RUBY_VERSION
=> "1.9.2" 
```

并且，解决方法保持范围开始/结束类型：

```
[6] (pry) main: 0> Range.new(*YAML.load(YAML.dump({'min' => range.min, 'max' => range.max})).values_at('min', 'max'))
=> "0".."1" 
```

在这两种情况下， YAML_VERSION 都是`0.60`.

# json - 使用 jquery 来自另一个域的 json

> ID：11399917
> 
> 赞同：1
> 
> 时间：2012-07-09T17:16:33.873
> 
> 标签：json, api, jquery, jsonp

抱歉，如果这是重复的，但我无法在任何相关线程上找到答案。我正在尝试从 api 获取 json 并读取内容，但无法解析。代码如下。我正在使用 jsonp，因为 json 不能跨域工作。

```
function getBbyJson()
{
    link = "http://api.remix.bestbuy.com/v1/products(name=playbook*)?show=sku,name,regularPrice,shortDescription&format=json&apiKey="+apikey
    $(document).ready(function(){
        $.ajax({
            type: "GET",
            url: link,
            dataType: "jsonp", 
            success: function(data){
                for (var i = 0,len = data.products.length; i < len; i++) {
                    var name = data.products[i].name;
                    $('<div class="name" id="item_'+i+'"></div>').html(name).appendTo('#container');                        
                }
            } 
        });
    });
} 
```

使用此函数，bby 返回 400 错误并显示以下消息

```
"Couldn't understand '/v1/products(name=playbook*)?show=sku,name,regularPrice,shortDescription&format=json&apiKey=apikey&callback=jQuery17206852765618823469_1341853386681&_=1341853391235'" 
```

jquery 方法是添加一个回调函数，并在末尾添加一个随机数。

我可以通过添加下面的代码来删除回调函数

```
jsonp: false
jsonpCallback: "" 
```

但是，我无法摆脱 jquery 生成的随机数。我不知道如何从这里开始。我在本地 json 文件上使用了相同的函数，并且运行顺利。

如果我将链接粘贴到浏览器中，来自 bby 的返回 json 如下

```
{
  "queryTime": "0.005",
  "currentPage": 1,
  "totalPages": 2,
  "partial": false,
  "from": 1,
  "total": 15,
  "to": 10,
  "products": [
    {
      "name": "BlackBerry - Leather Sleeve for BlackBerry PlayBook Tablets - Black",
      "shortDescription": "From our expanded online assortment; designed for use with BlackBerry PlayBook tablets; premium-grade leather material; access to ports; reinforced panels",
      "regularPrice": 49.99,
      "sku": 2638153
    },
    {
      "name": "BlackBerry - PlayBook Tablet with 16GB Memory",
      "shortDescription": "BlackBerry PlayBook Tablet operating system7\" HD capacitive screen with multi-touchWi-Fi16GB memorySupports all POP e-mail services",
      "regularPrice": 199.99,
      "sku": 2265381
    },
    {
      "name": "BlackBerry - PlayBook Tablet with 32GB Memory",
      "shortDescription": "BlackBerry PlayBook Tablet operating system7\" HD capacitive screen with multi-touchWi-Fi32GB memorySupports all POP e-mail services",
      "regularPrice": 249.99,
      "sku": 2387032
    },
    {
      "name": "BlackBerry - PlayBook Tablet with 64GB Memory",
      "shortDescription": "BlackBerry PlayBook Tablet operating system7\" HD capacitive screen with multi-touchWi-Fi64GB storage memorySupports all POP e-mail services",
      "regularPrice": 299.99,
      "sku": 2387041
    },
    {
      "name": "BlackBerry - Rapid Charger for BlackBerry PlayBook",
      "shortDescription": "From our expanded online assortment; compatible with BlackBerry PlayBook tablets; 90&#176; magnetic connector; compact design",
      "regularPrice": 69.99,
      "sku": 2638199
    },
    {
      "name": "BlackBerry - Rapid Charger for BlackBerry PlayBook Tablets - Black",
      "shortDescription": "Compatible with BlackBerry PlayBook tablets; charges PlayBook battery; holds PlayBook upright for viewing; magnetically connects to PlayBook",
      "regularPrice": 69.99,
      "sku": 2496254
    },
    {
      "name": "BlackBerry - Refurbished PlayBook Tablet with 16GB Memory - Black",
      "shortDescription": "RefurbishedBlackBerry PlayBook Tablet operating system7\" HD capacitive screen with multitouchWi-Fi16GB memorySupports all POP e-mail services",
      "regularPrice": 159.99,
      "sku": 4063218
    },
    {
      "name": "BlackBerry - Silicone Skin for BlackBerry PlayBook Tablets - Black",
      "shortDescription": "From our expanded online assortment; compatible with BlackBerry PlayBook tablets; silicone material; play-through design",
      "regularPrice": 29.99,
      "sku": 2638162
    },
    {
      "name": "Hip Street - AC/Car Power Adapter Kit for BlackBerry PlayBook Tablets",
      "shortDescription": "Compatible with BlackBerry PlayBook tablets and other devices with a USB charging cable; LED indicator light; USB charging cable; overcurrent protection",
      "regularPrice": 39.99,
      "sku": 3894198
    },
    {
      "name": "Hip Street - Antifingerprint Screen Protector for BlackBerry PlayBook Tablets - Clear",
      "shortDescription": "Compatible with BlackBerry PlayBook tablets; high-quality optical enhanced film; antiscratch hard coating; residue-free adhesive",
      "regularPrice": 19.99,
      "sku": 3894082
    }
  ],
  "canonicalUrl": "/v1/products(name=\"playbook*\")?show=sku,name,regularPrice,shortDescription&format=json&apiKey=ydpyq9h9cmpmzaakbawv9mzk",
  "totalTime": "0.022"
} 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:29:35.037

也许这可以帮助你： [http ://wiki.asp.net/page.aspx/1734/jquery-cross-domain-ajax-call-using-jsonp/](http://wiki.asp.net/page.aspx/1734/jquery-cross-domain-ajax-call-using-jsonp/)

```
function getBbyJson()
{
    var link = "http://api.remix.bestbuy.com/v1/products(name=playbook*)";
    $(document).ready(function(){
        $.ajax({
            type: "GET",
            url: link,
            crossDomain: true,
            contentType: "application/json; charset=utf-8",
            data: { show: "sku,name,regularPrice,shortDescription",
                    apiKey:apikey},
            dataType: "jsonp", 
            success: function(data){
                for (var i = 0,len = data.products.length; i < len; i++) {
                    var name = data.products[i].name;
                    $('<div class="name" id="item_'+i+'"></div>').html(name).appendTo('#container');                        
                }
            } 
        });
    });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T17:29:45.540

尝试添加到您的代码：

```
$.ajax({
            type: "GET",
            url: link,
            dataType: "jsonp", 
            success: function(data){
                for (var i = 0,len = data.products.length; i < len; i++) {
                    var name = data.products[i].name;
                    $('<div class="name" id="item_'+i+'"></div>').html(name).appendTo('#container');                        
                }
            }
            error : function(data){
                      console.log(data);
                     }
        }); 
```

看看有什么输出

# ruby-on-rails-3 - Jasmine：用它测试我的 Rails 站点的界面

> ID：11399920
> 
> 赞同：2
> 
> 时间：2012-07-09T17:16:52.887
> 
> 标签：ruby-on-rails-3, bdd, jasmine

我一直在寻找测试 Rails 3 应用程序的方法，该应用程序的丰富界面具有相当多的 JS 代码。我尝试了 Capybara，但没有成功，所以现在我正在尝试 Jasmine。但我很难理解我应该如何去做。

从我收集到的信息来看，Jasmine 本身就可以很好地测试网站的 JS 组件，但如果我想直接测试界面呢？我需要类似的东西：

```
describe "Sign in" 
   Visit '/home'
   When user clicks "Sign in" link 
   The sign in form should appear 
```

我真的可以对 Jasmine 做类似的事情吗？到目前为止，我的测试包含在 rails-jasmine gem 生成的结果页面中，显然它们在该 DOM 上运行，而不是在我网站的 DOM 上运行。

我现在正在尝试使用常青树，但我得到了相同的结果（我什至不能包括 jQuery）。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T16:13:09.190

要回答您的问题 - 不，Jasmine 本身不会以某种方式让您浏览您的网站并在如此高的级别上进行测试，例如与 Cucumber 的集成测试。

Jasmine 主要是为了测试你的 js 的 API 而构建的，所以基本上你只能测试 URL 路由或其他东西，如果它们是你的 API 的一部分。

例如，您可以测试主干路由器如何响应窗口的当前位置，或从一个位置导航到下一个位置，但这是因为主干路由器显式处理 URL 位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T02:22:21.717

这可能会有所帮助：[http ://railscasts.com/episodes/275-how-i-test](http://railscasts.com/episodes/275-how-i-test)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T05:24:51.580

您可以尝试`jasminerice`与固定装置一起使用。如果目的是测试 JS DOM 交互，那么fixtures 就是要走的路。但是，如果这个想法也是为了测试服务器交互，那么使用类似的东西`cucumber`是有道理的。

# javascript - Javascript：创建动态变量和对象名称。/html5 本地存储

> ID：11399923
> 
> 赞同：1
> 
> 时间：2012-07-09T17:17:21.547
> 
> 标签：javascript, html, variables, loops

我正在处理由 HTML5 本地存储保存的表单。

按保存时：

```
function saveAll(){
  var field1 = document.getElementById('field1').value;
  localStorage.setItem('con_field1',field1);
  var field2 = document.getElementById('field2').value;
  localStorage.setItem('con_field2',field2);
  var field3 = document.getElementById('field3').value;
  localStorage.setItem('con_field3',field3);
  var field4 = document.getElementById('field4').value;
  localStorage.setItem('con_field4',field4);
  var field5 = document.getElementById('field5').value;
  localStorage.setItem('con_field5',field5);
  var field6 = document.getElementById('field6').value;
  localStorage.setItem('con_field6',field6);
} 
```

并且在加载页面时（填写表格）：

```
function ShowAll() {
  var field1 = localStorage.getItem('con_field1');
  document.conditioning.field1.value = field1;
  var field2 = localStorage.getItem('con_field2');
  document.conditioning.field2.value = field2;
  var field3 = localStorage.getItem('con_field3');
  document.conditioning.field3.value = field3;
  var field4 = localStorage.getItem('con_field4');
  document.conditioning.field4.value = field4;
  var field5 = localStorage.getItem('con_field5');
  document.conditioning.field5.value = field5;
  var field6 = localStorage.getItem('con_field6');
  document.conditioning.field6.value = field6;
} 
```

这一切都很好，但我想以一种更花哨和有效的方式重新编写它。我在想这样的事情：

```
function ShowAll() {
  var field = [];
  for (i=0; i<6; i++) {
    field[i] = localStorage.getItem(window['con_field' + i]);
    document.purpose.field[i].value = window['con_field' + i]
  }
} 
```

但是浏览器不喜欢这个。基本上我需要创建一个循环，自动将“字段”名称更改为“field1、field2、field3”等。窗口的东西正在工作，但我只是用错了。

有人有想法吗？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-10-07T12:39:47.437

```
function showAll(t1,c1,d1)  {
    var field1 = localStorage.getItem('con_field1');
    console.log(field1)
    var field2 = localStorage.getItem('con_field2');
    var field3 = localStorage.getItem('con_field3');
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T17:23:17.757

您应该将所有数据添加到一个对象，对其进行字符串化，然后将其添加到单个键下的本地存储中。

当你加载它时，抓取一个本地存储项，解析它，然后访问对象的属性。

例如

```
var save = function () {
    var data = {
        foo: 'bar'
    };

    localStorage.setItem('myData', JSON.stringify(data));
};

var load = function () {
    var data = JSON.parse(localStorage.getItem('myData'));

    var someProp = data.foo; // gives you 'bar'
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T17:20:56.673

看起来您的主要问题是字段的索引从 1 开始，但您的循环索引从 0 开始。

那这个呢？

```
var field = [];
for (i = 1; i <= 6; i++)
{
  field[i] = localStorage.getItem(window['con_field' + i]);
  document.purpose.field[i].value = window['con_field' + i]
} 
```

此外，我不是 100% 对此表示赞同，但我认为使用`document.getElementByID`比在窗口对象上使用括号表示法更能跨浏览器兼容，但我已经有一段时间没有写普通的香草 JS 了，所以不要引用我的话。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T17:20:46.970

我会尝试`document.purpose["field" + i].value = window['con_field' + i]`。

# jquery - 使用 Jquery 的动态下拉 div

> ID：11399924
> 
> 赞同：-5
> 
> 时间：2012-07-09T17:17:23.047
> 
> 标签：jquery

我需要一段代码来创建“其他”下拉选项。基本上，如果有3个颜色选项：红色| Glue |蓝色，我希望它们能够选择其他以及选择的Div时，有一个文本框供他们输入下一个颜色。现在发布代码......对不起人们。这是我到目前为止所尝试的：

```
<label class="desc">
                                    Operating System:
                                </label>
                                <div><select name="os" id="os"><option value="1" selected = "selected">Windows 98</option> 
```

Windows ME 新建

```
<script type="text/javascript">
$(document).ready(function(){
  $('#os').change(function(){
    if($(this).val() == 'other')
      $('#otheros').show();
    else
      $('#otheros').hide();
  });
});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T17:31:18.063

这是一个代码片段，这是[演示](http://jsfiddle.net/FyPKg/5/)

```
#otherOption
{
    display:none;
    margin-left:5px;
}

<select id='ddlColors'>
    <option value = 'red'>red</option>
    <option value = 'blue'>blue</option>
    <option value = 'other'>other</option>
</select>
<div id='otherOption'>
    <input type='text' />
</div>

    $(document).ready(function(){
    $('#ddlColors').change(function(){
        if($(this).val() == 'other')
            $('#otherOption').show();
        else
            $('#otherOption').hide();
    });
});​ 
```

# mysql - mysql，如何在 2 个表中选择 2 个列？

> ID：11399925
> 
> 赞同：0
> 
> 时间：2012-07-09T17:17:24.370
> 
> 标签：mysql, inner-join

这是我正在研究的示例 mysql 代码：

```
 SELECT t.name
    FROM terms AS t 
    INNER JOIN term_taxonomy AS tt
    ON tt.term_id = t.term_id 
    WHERE ...... 
```

上面的代码在表 t 中获取列“name”，我想在表 tt 中加入列“count”，所以我尝试了：

```
SELECT t.name, tt.count 
```

这种修改不会对结果产生任何影响。结果如何获得“名称”和“计数”？

**问题解决**了我使用 wpdb 的 get_col 只能返回一列。现在我改为 get_result 并解决了这个问题。感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T01:50:50.180

问题已解决——我`$wpdb->get_col`用作查询的包装器。这是一个只返回一列的 wordpress 函数。现在我改为`$wpdb->get_result`，一切正常。感谢您的帮助！

# linux - tar .svn folders preserver directory structure

> ID：11399929
> 
> 赞同：0
> 
> 时间：2012-07-09T17:17:54.867
> 
> 标签：linux, svn

What I need is to extract all .svn-folders from a project within their original directory structure and make a tar file out of it. So that in the archive I have only the emtpy folders with all .svn-folders and their contents in it.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:31:45.057

You can do this by using tar a bit like cpio, by selecting directories using find. EG:

```
find . -name .svn -print | tar --create --files-from - > /tmp/stuff.tar 
```

If you want, you can avoid problems with whitespace using -print0 instead of -print, and tar --null.

# sharepoint-2010 - 无法使用 Lists.UpdateListItems Web 服务调用更新 SharePoint 2010 的托管元数据字段

> ID：11399933
> 
> 赞同：8
> 
> 时间：2012-07-09T17:18:19.407
> 
> 标签：sharepoint-2010

我正在尝试使用 Lists.UpdateListItems Web 服务更新 SharePoint 托管元数据 (MMD) 字段，但它不起作用。

这是我的 SOAP 请求

```
<?xml version="1.0" ?>
<S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/">
<S:Body>
  <UpdateListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/">
    <listName>My Test List</listName>
    <updates>
      <Batch ListVersion="0" PreCalc="TRUE" OnError="Continue">
        <Method Cmd="Update" ID="1">
          <Field Name="ID">3</Field>
          <Field Name="Document_x0020_Title">foo</Field>
          <Field Name="Fiscal_x0020_Year1">13;#FY 2006|7e8205da-57a1-45a3-8147-469b795ad6e8</Field>
        </Method>
      </Batch>
    </updates>
   </UpdateListItems>
</S:Body></S:Envelope> 
```

此请求将成功更新“文档标题”（文本字段），但 MMD 字段“会计年度”未更改，并且 Web 服务没有返回错误。

请注意，MMD 的值采用“WssId;#TermValue|TermGuid”格式，并且已经为站点创建了术语。

请帮忙。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-11T14:01:10.053

弄清楚了。

我必须使用不同的字段名称。该字段的标签是“会计年度”，但有效的字段名称实际上是“d3c0ddc947ab4b8c90b6a0fe2d4caf09”而不是“Fiscal_x0020_Year1”。所以我的 SOAP 请求看起来像

```
 <Method Cmd="Update" ID="1">
      <Field Name="ID">3</Field>
      <Field Name="Document_x0020_Title">foo</Field>
      <Field Name="d3c0ddc947ab4b8c90b6a0fe2d4caf09">13;#FY 2006|7e8205da-57a1-45a3-8147-469b795ad6e8</Field>
    </Method> 
```

要获取此字段名称，我使用 Lists.GetListContentType Web 服务方法返回字段信息并查找字段类型“Note”。以下是 SharePoint 返回的示例

```
<Field Type="Note" DisplayName="Fiscal Year_0"
StaticName="d3c0ddc947ab4b8c90b6a0fe2d4caf09" Name="d3c0ddc947ab4b8c90b6a0fe2d4caf09" 
ID="{1afa458b-d50a-4139-ad8d-f1172774de34}" ShowInViewForms="FALSE" Required="FALSE" 
CanToggleHidden="TRUE" SourceID="{77871b4e-f3ba-42dc-8940-ab33fb431099}" Hidden="TRUE" 
Version="1" Customization="" ColName="ntext8" RowOrdinal="0"/> 
```

我还发现使用 Lists.GetListContentTypes 方法来获取 Lists.GetListContentType 方法调用中使用的内容类型 ID 很有用。

----***更新***-- 我发现你不必使用“WssId;#TermValue|TermGuid”的格式。您可以简单地使用“TermValue|TermGuid”。因此，在上面的示例中，该值将是“FY 2006|7e8205da-57a1-45a3-8147-469b795ad6e8”。

这非常有用，因为您可以在不同的站点上重复使用相同的值，这与以前的值不同，您只能在一个站点中使用它。对于多值，您只需要用“;”分隔它 代替 ”;＃”。例如“2006 财年|7e8205da-57a1-45a3-8147-469b795ad6e8;2007 财年|823205da-57a1-45a3-8147-469b795ade13”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-12T17:44:20.557

感谢您提及有关 StaticName 的内容。这结束了我的痛苦。

似乎对于不链接到 MMS 的简单字段（如 Title），允许使用更惰性的更新语法。例如，就它自己而言，处理以下更新时不会出现错误。

```
<Field Name="Title">Some Title</Field> 
```

但是，链接到 MMS 的字段的规则并不相同。
按照上面的方法，我进入了我的彩信领域。如果您通过其友好名称识别该类型的字段并输入一个整数，则可以使用任意值更新该类型的字段，例如：

```
<Field Name="Activity">20</Field> 
```

“20”只是翻译成某个术语。
我尝试了很多数字，它们都以同一个词的形式出现。

或者，如果我更接近记录的更新值的方式，同时仍用“活动”标识字段，则服务返回错误 0x80020005。

```
<Field Name="Activity">HTA|fe951639-7c90-41ee-9888-6ae0e6523120</Field> 
```

所以不要那样做。
只有当卫星完全对齐时，我才能找到成功。**StaticName 是关键**。

```
<Field Name="j06a8d8240f84aec987f6a28effa3ae1">HTA|fe951639-7c90-41ee-9888-6ae0e6523120</Field> 
```

查找 StaticName 的另一种方法是在对 GetList 请求的响应中查找每个 MMS 字段的字段类型=“注释”。此操作比 GetListContentType 少 1 个输入。您只需要列表名称而不需要 contentTypeID。

摇滚吧。

# c# - C# 中的 7-zip (7za.EXE) 用于归档同名文件并存储文件夹信息

> ID：11399934
> 
> 赞同：0
> 
> 时间：2012-07-09T17:18:21.560
> 
> 标签：c#, .net, visual-studio-2005, c#-2.0, 7zip

我的软件应该使用 7zip 将文件收集到 .zip 或 .7z 存档中，但由于软件的性质，有很多文件具有相同的名称，但目录不同，例如：

```
D:\Software\Components\Station1\Alarms\Logs\ValvePressureSensor.xml
D:\Software\Components\Station1\Configurations\ValvePressureSensor.xml
D:\Software\Components\Station2\Alarms\Logs\ValvePressureSensor.xml 
```

这些文件存储在列表“FileList.lst”中，我以这种方式调用 7-zip：

```
7za a -t7z "D:\Software\CollectedData\Diagnostics.7z" 
"@D:\Software\ZipTemp\FileList.lst" 
```

所以我想知道是否有办法在压缩每个文件时保留它们的目录以阻止 7-zip 标记重复文件？

我知道涉及从每个文件路径的开头删除“D：\”的解决方法，但这将是手动不可能的，因为“FileList.lst”在 C# 代码中填充了大约 1500~3000 个文件（其中并不总是相同的文件），并且 FileList.lst 位于一个临时文件夹中，该文件夹被创建、压缩，然后动态销毁。所以我无法将 7za.EXE 存储在同一区域。最重要的是，文件列表被另一个需要文件路径中指定的驱动器的可执行文件使用。

我应该提到我正在使用 Visual Studio 2005、C#2.0 和 7-zip v9.20。

编辑：我的问题之前相当广泛，我应该澄清我正在从 WinZip 切换（由于许可问题）所以我记得在 WinZip 中如果添加 -p 开关，WinZip 将存储添加的所有文件的文件夹信息，而不仅仅是对于来自子文件夹的文件；文件夹信息将从命令行中指定的文件夹开始。你知道7zip中有类似的东西吗？

编辑 2：原来你不能用 7-zip 保存文件夹信息

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T17:20:42.713

> 我知道涉及从每个文件路径的开头删除“D：\”的解决方法，但这手动是不可能的

所以动态删除它。如果你的路径是一致的，一个简单的`path.Substring(3)`就足够了。

# xcode - 如何在 Xcode 中运行处理草图？

> ID：11399936
> 
> 赞同：1
> 
> 时间：2012-07-09T17:18:24.230
> 
> 标签：xcode, ios5, processing

作为学生论文项目的一部分，我和我的团队正在制作一个显示数据可视化的应用程序，该应用程序将在 Processing 中完成。我们想知道最好的方法是什么？

我们最初考虑将处理文件 (.pde) 转换为视频并在应用程序中播放，但我听说将其转换为 .dvg 更好，我还听说你可以只运行 .pde在 Xcode 中。

有人对最好的方法和方法有什么建议吗？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-22T20:23:22.050

我在 iprocessing.org 包中进行了更改，某些功能（例如捕获麦克风、加速度计、地理定位等）无法正常工作。

还更新了代码中实现的 Processing.js 的版本。我重新编写了几乎所有的代码并创建了这个 iOS APP：[http](http://spincles.dekwilde.com.br/) ://spincles.dekwilde.com.br/ 代码可在此链接获得： [https ://github.com/dekwilde/Spincles](https://github.com/dekwilde/Spincles)

现在我称他为 iProcessing 2.0

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T14:57:04.827

我有一些可行的想法，但我没有 iPhone，只在模拟器中测试过：

1.  [iProcessing](http://www.luckybite.com/iprocessing/)
2.  SketchPatch 的Davide用他的[P5Nitro](http://sketchpatch.net)库向我展示了他的手机上的弹簧演示，它比 iProcessing 运行得更好[。](https://github.com/davidedc/P5Nitro)
3.  如果你的 .pde 文件没有使用很多 java 特定的库，你可以尝试将项目移植到iOS 的[OpenFrameworks](http://www.openframeworks.cc/download/)。由于该项目受到处理的启发，因此还有一个漂亮[的处理用户指南。](http://wiki.openframeworks.cc/index.php?title=OF_for_Processing_users)使用 setup()/update()/draw() 和触摸事件，您将轻松自如。

祝你好运 ！

# html - IE中可点击的td

> ID：11399938
> 
> 赞同：0
> 
> 时间：2012-07-09T17:18:34.430
> 
> 标签：html

我在 IE 6++ 中遇到 TD 上的光标指针问题。有一个带有此类 HTML 代码的表格单元格，点击事件`BlockDay`仅适用于第二个 div，但我在所有 TD 上都写了它。

```
 <TD class="calnedar_td" onclick="BlockDay('1340571600');return false;">
    <DIV style="DISPLAY: inline; FLOAT: left"></DIV>
    <DIV style="DISPLAY: inline; FLOAT: right">Mon 25</DIV>
    </TD>

   .calnedar_td{
     height:105px;
     width:105px;
     vertical-align: top;
     text-align: left;
     padding: 3px;
     cursor:pointer;
    } 
```

我怎样才能使所有 td 区域都可点击？谢谢你，安东。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:24:48.877

```
// place this in your ready event

$('td.calnedar_td').bind("click", function(){
           // whatever
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:21:40.407

我相信您需要在每个 TD 内放置一些东西，以便以这种方式点击。如果单元格不包含任何内容，只需添加一个不间断空格，如下所示：

```
<TD class="calnedar_td" onclick="BlockDay('1340571600');return false;">
    <DIV style="DISPLAY: inline; FLOAT: left">&nbsp;</DIV>
    <DIV style="DISPLAY: inline; FLOAT: right">Mon 25</DIV>
    </TD> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T17:20:20.767

我相信你必须在第二个 DIV 中放一些东西才能点击..！我可能是错的，但事件处理程序可能需要某些东西实际上是可点击的，然后才能使用 onclick 事件。

# java - 为什么在 Java 中打印数组时会得到垃圾值？

> ID：11399950
> 
> 赞同：0
> 
> 时间：2012-07-09T17:19:52.233
> 
> 标签：java, arrays

> **可能重复：**
> [用 Java 打印数组的最简单方法](https://stackoverflow.com/questions/409784/simplest-way-to-print-an-array-in-java)

我什至如何打印数组？我正在尝试一些方法，但我一直得到的只是垃圾值。我试图导入 Arrays 库 - 仍然没有工作。

```
 int []x = {1, 2, 3, 4, 5};
    int []y;
    y = x.clone();
    System.out.println(x);
    System.out.println(y); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-09T17:22:19.083

不是垃圾。是`toString`此类的默认实现。

以可读格式打印元素的最简单方法是：

```
String printed = Arrays.toString(x); 
```

[Arrays.toString(int[])](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Arrays.html#toString%28int%5b%5d%29)的文档

可以使用相同的方法打印出`primitives`和的数组`Objects`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-09T17:20:24.060

它不是垃圾值；它 `toString()`是`int[]`,

如果要打印数组的内容

```
public void printArray(int[] arrray){
 for(int number: array){
   System.out.println(number);
 }
} 
```

* * *

**也可以看看**

*   [为什么没有 java.lang.Array 类？如果一个java数组是一个对象，它不应该扩展对象吗？](https://stackoverflow.com/questions/8546500/why-isnt-there-a-java-lang-array-class-if-a-java-array-is-an-object-shouldnt)

# magento - Magento 错误：无法在 Collection.php 中发送标头错误

> ID：11399958
> 
> 赞同：0
> 
> 时间：2012-07-09T17:20:25.460
> 
> 标签：magento, header

在我的 Magento 1.6.2.0 中，导出客户时出现错误：

```
a:5:{i:0;s:156:"Cannot send headers; headers already sent in .../Mage/Eav/Model/Resource/Entity/Attribute/Option/Collection.php, line 1";i:1;s:1385:"
#0 /home/mysite/public_html/lib/Zend/Controller/Response/Abstract.php(148): Zend_Controller_Response_Abstract->canSendHeaders(true)
#1 .../Mage/Core/Controller/Response/Http.php(105): Zend_Controller_Response_Abstract->setRedirect('http://mysite...', 302)
#2 .../Mage/Adminhtml/Controller/Action.php(336): Mage_Core_Controller_Response_Http->setRedirect('http://mysite...')
#3 .../Mage/ImportExport/controllers/Adminhtml/ExportController.php(98): Mage_Adminhtml_Controller_Action->_redirect('*/*/index')
#4 .../Mage/Core/Controller/Varien/Action.php(420): Mage_ImportExport_Adminhtml_ExportController->exportAction()
#5 .../Mage/Core/Controller/Varien/Router/Standard.php(250): Mage_Core_Controller_Varien_Action->dispatch('export')
#6 .../Mage/Core/Controller/Varien/Front.php(176): Mage_Core_Controller_Varien_Router_Standard->match(Object(Mage_Core_Controller_Request_Http))
#7 .../Mage/Core/Model/App.php(349): Mage_Core_Controller_Varien_Front->dispatch()
#8 /home/mysite/public_html/app/Mage.php(640): Mage_Core_Model_App->run(Array)
#9 /home/mysite/public_html/index.php(80): Mage::run('', 'store')
#10 {main}";s:3:"url";s:99:"/index.php/admin/export/export/key/.../entity/customer/file_format/csv";s:11:"script_name";s:10:"/index.php";s:4:"skin";s:5:"admin";} 
```

保存新的或编辑的产品后出现同样的错误。产品已保存但在出现错误之前：

```
a:5:{i:0;s:156:"Cannot send headers; headers already sent in .../core/Mage/Eav/Model/Resource/Entity/Attribute/Option/Collection.php, line 1";i:1;s:1420:"
#0 /home/mysite/public_html/lib/Zend/Controller/Response/Abstract.php(148): Zend_Controller_Response_Abstract->canSendHeaders(true)
#1 .../core/Mage/Core/Controller/Response/Http.php(105): Zend_Controller_Response_Abstract->setRedirect('http://mysite...', 302)
#2 .../core/Mage/Adminhtml/Controller/Action.php(336): Mage_Core_Controller_Response_Http->setRedirect('http://mysite...')
#3 .../local/CJM/ColorSelectorPlus/controllers/Override/Admin/Catalog/ProductController.php(92): Mage_Adminhtml_Controller_Action->_redirect('*/*/', Array)
#4 .../core/Mage/Core/Controller/Varien/Action.php(420): CJM_ColorSelectorPlus_Override_Admin_Catalog_ProductController->saveAction()
#5 .../core/Mage/Core/Controller/Varien/Router/Standard.php(250): Mage_Core_Controller_Varien_Action->dispatch('save')
#6 .../core/Mage/Core/Controller/Varien/Front.php(176): Mage_Core_Controller_Varien_Router_Standard->match(Object(Mage_Core_Controller_Request_Http))
#7 .../core/Mage/Core/Model/App.php(349): Mage_Core_Controller_Varien_Front->dispatch()
#8 /home/mysite/public_html/app/Mage.php(640): Mage_Core_Model_App->run(Array)
#9 /home/mysite/public_html/index.php(80): Mage::run('', 'store')
#10 {main}";s:3:"url";s:82:"/index.php/admin/catalog_product/save/id/246/key/.../";s:11:"script_name";s:10:"/index.php";s:4:"skin";s:5:"admin";} 
```

> 无法发送标头；标头已经发送...

...意味着有一个标头重定向，但之前有一个输出。但是那到底在 core/Mage/Eav/Model/Resource/Entity/Attribute/Option/Collection.php 哪里呢？

一些想法？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T14:48:25.193

找到它，它是愚蠢的。我很困惑，因为

`Cannot send headers; headers already sent in .../Mage/Eav/Model/Resource/Entity/Attribute/Option/Collection.php, line 1`

标头已在...第 1 行发送。这是文件的编码错误。因此，如果您正在使用 notepadd++，请不要忘记将 utf-8 与 BOM 一起使用，它可以为您节省大量时间来搜索有线错误。

# cpu-usage - 如何确定某个 HTTPD 进程正在处理哪个 URL？

> ID：11399962
> 
> 赞同：9
> 
> 时间：2012-07-09T17:20:27.847
> 
> 标签：cpu-usage, apache

我的 Web 服务器上偶尔会有 HTTPD 请求导致 CPU 使用率飙升。我在Top看这个。每个 URL 都是在每次请求时动态生成的。框架是 Codeigniter。我在 Linux CentOS 上使用 prefork Apache 作为我的 Web 服务器。

当 CPU 使用率飙升时，如何确定正在处理哪个 URL？我可以以某种方式将进程 ID 与 Apache 日志中的 HTTP 请求相关联吗？该站点上有数百万个页面，因此查看 Codeignitor 的分析器并没有帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-09T21:51:10.160

您可以将 PID 添加到您的日志中（请参阅[http://httpd.apache.org/docs/current/mod/mod_log_config.html](http://httpd.apache.org/docs/current/mod/mod_log_config.html) -- %P）。

或者您可以激活 mod_status - 它为您提供一个相当有用的实时显示，其中包含该孩子的最新 URL。

# c - 数组的二进制插入排序不起作用（C 中的代码）

> ID：11399964
> 
> 赞同：-1
> 
> 时间：2012-07-09T17:20:45.990
> 
> 标签：c, sorting, binary, insertion-sort

这是我的代码：

```
#include <stdio.h>
#define SIZE 4
int main(int argc, const char * argv[])
{
double m[SIZE],tmp;
int i,min,max,c,k,l,pos;
for (i=0; i<SIZE; i++) {
    printf("a%d? ",i);
    scanf("%lf",&m[i]);
}
for (i=0; i<SIZE; i++)
    printf("%.1lf ",m[i]);
printf("\n");
k = 1;
//========================
do {
    min = 0;
    max = k-1;
    do
    {
        c = (min+max)/2;
        if (m[c]>m[k]) 
        {
            min=c;
        }
        else {
            max=c; 
        }
        c = (min+max)/2; 
    }
    while(min != c);
    pos = min; 
    if(m[pos]<m[k])
    {
            pos++;
    }
    tmp = m[k]; 
    l=k;
    while (l>pos) {
        m[l]=m[l-1];
        l--;
    }
    m[pos]=tmp;
    k++;
} while (k != SIZE);
for (i=0; i<SIZE; i++)
    printf("%.1lf ",m[i]);
//========================
return 0; 
```

}

有人可以帮忙，为什么排序不起作用？正如我所想，代码是正确的。也许我对算法不满意？

我正在尝试使用二进制插入排序。或者有人可以提供 C 代码替代方案（看看什么是不正确的）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T17:27:33.730

的抽象算法`insertion sort`是：

```
function insertionSort(array A)
    for i from 1 to length[A]-1 do
        value := A[i] 
        j := i-1
        while j >= 0 and A[j] > value do
            A[j+1] := A[j]
            j := j-1
        done
        A[j+1] = value
    done 
```

在 中实施`C`，我们有：

```
 void binaryInsertionSort (int a[], int n)
   {
     register int i, m;
     int hi, lo, tmp;

     for (i = 1; i < n; i++) {
        lo = 0, hi = i;
        m = i / 2;

        do {
            if (a[i] > a[m]) {
                lo = m + 1;
            } else if (a[i] < a[m]) {
                hi = m;
            } else
                break;

            m = lo + ((hi - lo) / 2);
        } while (lo < hi);

        if (m < i) {
            tmp = a[i];
            memmove (a + m + 1, a + m, sizeof (int) * (i - m));
            a[m] = tmp;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-10T13:18:06.330

尝试这个：

```
void binaryInsertionSort (int *array, size_t size) {
register int i, middle;
int high, low, tmp;
static int comparisonCount = 0, swapCount = 0;
i = 1;
while (i < size) {
  low = 0, high = i;
  middle = i / 2;

  do {
    if (array[i] > array[middle]) {
      low = middle + 1;
    } else if (array[i] < array[middle]) {
      high = middle;
    } else
      break;

    middle = low + ((high - low) / 2);
  } while (low < high);

  comparisonCount++;
  if (middle < i) {
    tmp = array[i];
    memmove (array + middle + 1, array + middle, sizeof (int) * (i - middle));
    swapCount++;
    array[middle] = tmp;
  }
  i++;
}
printf("Comparison:%d Swap: %d\n", comparisonCount, swapCount);
} 
```

# java - 使用 Eclipse 等进度条制作启动画面

> ID：11399971
> 
> 赞同：9
> 
> 时间：2012-07-09T17:21:22.047
> 
> 标签：java, spring, swing, splash-screen, windowbuilder

我的主类从文件加载配置，然后显示一个框架。我想制作一个像 Eclipse 这样的带有进度条的启动画面，以便在加载文件时进度会增加，并且在加载文件后启动画面会消失。然后我的主框架被加载。

**主类代码：**

```
public static void main(String[] args) {
  ApplicationContext context = new ClassPathXmlApplicationContext(
    "classpath:/META-INF/spring/applicationContext.xml");
  // splash with progress load till this file is loaded
  UserDao userDao = context.getBean(UserDao.class);
  isRegistered = userDao.isRegistered();
  System.out.println("registered: " + isRegistered);
  if (isRegistered) {
    // progress finish and hide splash
    log.debug("user is registered"); // show frame1
  } else {
    // progress finish and hide splash
    log.debug("user is not registered"); // show frame2
  }
} 
```

我对 Swing 没有太多经验，所以请告知如何实现。

**更新：**我找到了以下示例，但问题不大：

*   当计数器达到指定的数字时，它应该在 (300) 处停止，它会一直计数，而不会停止计时器并隐藏启动屏幕。

*   我想将计数器绑定到文件加载，因此在加载文件时会加载进度，直到加载文件然后进度完成并且启动屏幕消失。

    ```
    @SuppressWarnings("serial")
    @Component
    public class SplashScreen extends JWindow {

        static boolean isRegistered;

        static Log log = LogFactory.getLog(SplashScreen.class);

        private static JProgressBar progressBar = new JProgressBar();
        private static SplashScreen execute;
        private static int count;
        private static Timer timer1;

        public SplashScreen() {

            Container container = getContentPane();
            container.setLayout(null);

            JPanel panel = new JPanel();
            panel.setBorder(new javax.swing.border.EtchedBorder());
            panel.setBackground(new Color(255, 255, 255));
            panel.setBounds(10, 10, 348, 150);
            panel.setLayout(null);
            container.add(panel);

            JLabel label = new JLabel("Hello World!");
            label.setFont(new Font("Verdana", Font.BOLD, 14));
            label.setBounds(85, 25, 280, 30);
            panel.add(label);

            progressBar.setMaximum(50);
            progressBar.setBounds(55, 180, 250, 15);
            container.add(progressBar);
            loadProgressBar();
            setSize(370, 215);
            setLocationRelativeTo(null);
            setVisible(true);
        }

        public void loadProgressBar() {
            ActionListener al = new ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    count++;
                    progressBar.setValue(count);
                    if (count == 300) {
                        timer1.stop();
                        execute.setVisible(false);
                        return;
                    }
                }
            };
            timer1 = new Timer(50, al);
            timer1.start();
        }

        public static void main(String[] args) {

            execute = new SplashScreen();

            ApplicationContext context = new ClassPathXmlApplicationContext(
                    "classpath:/META-INF/spring/applicationContext.xml");

            UserDao userDao = context.getBean(UserDao.class);

            isRegistered = userDao.isRegistered();

            if (isRegistered) {
                 // show frame 1
            } else {
                                                        // show frame 2

            }

        }

    } 
    ```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-09T17:26:11.093

`SplashScreen`Java 有一个专门用于此目的的内置类。[这里](http://docs.oracle.com/javase/tutorial/uiswing/misc/splashscreen.html)有一个关于如何使用它的教程。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-15T14:26:25.110

> 当计数器达到指定的数字时，它应该在 (300) 处停止，它会一直计数，而不会停止计时器并隐藏启动屏幕。

下面的代码似乎很好用（有一个致命缺陷，计数器可能需要比文件加载更长的时间，反之亦然）：

```
import java.awt.Color;
import java.awt.Container;
import java.awt.Font;
import java.awt.HeadlessException;
import java.awt.event.ActionListener;
import javax.swing.*;

public class SplashScreen extends JWindow {

    static boolean isRegistered;
    private static JProgressBar progressBar = new JProgressBar();
    private static SplashScreen execute;
    private static int count;
    private static Timer timer1;

    public SplashScreen() {

        Container container = getContentPane();
        container.setLayout(null);

        JPanel panel = new JPanel();
        panel.setBorder(new javax.swing.border.EtchedBorder());
        panel.setBackground(new Color(255, 255, 255));
        panel.setBounds(10, 10, 348, 150);
        panel.setLayout(null);
        container.add(panel);

        JLabel label = new JLabel("Hello World!");
        label.setFont(new Font("Verdana", Font.BOLD, 14));
        label.setBounds(85, 25, 280, 30);
        panel.add(label);

        progressBar.setMaximum(50);
        progressBar.setBounds(55, 180, 250, 15);
        container.add(progressBar);
        loadProgressBar();
        setSize(370, 215);
        setLocationRelativeTo(null);
        setVisible(true);
    }

    private void loadProgressBar() {
        ActionListener al = new ActionListener() {

            public void actionPerformed(java.awt.event.ActionEvent evt) {
                count++;

                progressBar.setValue(count);

                System.out.println(count);

                if (count == 300) {

                    createFrame();

                    execute.setVisible(false);//swapped this around with timer1.stop()

                    timer1.stop();
                }

            }

            private void createFrame() throws HeadlessException {
                JFrame frame = new JFrame();
                frame.setSize(500, 500);
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setVisible(true);
            }
        };
        timer1 = new Timer(50, al);
        timer1.start();
    }

    public static void main(String[] args) {
        execute = new SplashScreen();
    }
}; 
```

> 我想将计数器绑定到文件加载，因此在加载文件时会加载进度，直到加载文件然后进度完成并且启动屏幕消失。

您应该查看`ProgressMonitor`并`ProgressMonitorInputStream`使用 a `Task`，然后您可以检查文件何时被完全读取并结束`SplashScreen`. [在这里](http://docs.oracle.com/javase/tutorial/uiswing/components/progress.html#monitors)查看一些很棒的教程和解释

# ruby - 红宝石。在对象的设置器名称和初始化中使用符号“=”

> ID：11399972
> 
> 赞同：0
> 
> 时间：2012-07-09T17:21:25.120
> 
> 标签：ruby, object, setter, initializer

```
class Item

    def name=(name_value)   
        @name = name_value
    end

    def name
        @name
    end

end 
```

在第一种情况下：

```
item = Item.new
item.name=("value")
puts item.class 
```

我不断得到。

```
Item 
```

在第二种情况下：

```
item = Item.new.name=("value")
puts item.class 
```

我有

```
String 
```

为什么？我不明白其中的区别。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T17:33:50.430

Ruby 将您的第二个示例视为这样

```
item = Item.new.name = 'value' 
```

赋值运算符的返回值是被赋值的值。`Item.new.name = 'value'`返回`'value'`等`item = 'value'`。

```
class Item
  def name=(name_value)
    @name = "processed #{name_value}"
  end

  def name
    @name
  end
end

item = Item.new
item2 = item.name = "value" # your example code

item2 # => "value"
item.name # => "processed value" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T17:35:28.367

在 Ruby 中，赋值表达式计算为被赋值的值。

IE：

```
foo = 'bar' 
```

评估为`'bar'`

所以，在你的情况下

```
Item.new.name=("value") 
```

这将更惯用地写成这样：

```
Item.new.name = 'value' 
```

分配的值是字符串`'value'`。

因此，`Item.new.name = 'value'`计算结果为`'value'`（当然还有调用该方法的副作用`name=`），这意味着

```
item = Item.new.name = 'value' 
```

评估为

```
item = 'value' 
```

最后，`item`有值`'value'`，即 a `String`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T17:26:27.583

在第二种情况下，您正在创建一个新项目并设置名称，当您设置名称时，它返回一个字符串，您将其分配给项目变量。你应该使用第一种形式

或者从 ActiveRecord 继承时：

```
item = Item.new(:name=>"value") 
```

# c# - C# - 创建包含作为关键字的列名的索引

> ID：11399976
> 
> 赞同：2
> 
> 时间：2012-07-09T17:21:39.440
> 
> 标签：c#, ms-access, indexing

我有一个创建 Access MDB 文件的 C# 程序。表和列的名称是固定的，我没有机会更改它们。不幸的是，其中一列被命名为“组”。

我编写的代码如下所示：

```
string indexSQL = buildIndexString(table.TableName);
//indexSQL = "CREATE INDEX comp ON ExpFactMap([Group]);"
new OleDbCommand(indexSQL, conn).ExecuteNonQuery(); 
```

执行 ExecuteNonQuery() 时，出现语法错误。如果我使用“组”以外的任何列，则代码可以正常工作。问题似乎在于它将 Group 解释为关键字而不是列名。

有谁知道如何解决这个问题？在理想情况下，我会更改列的名称，但不幸的是，这是不可能的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T18:00:31.883

Group 不是您尝试在 DDL 语句中用作对象名称的唯一保留字：

```
//indexSQL = "CREATE INDEX comp ON ExpFactMap([Group]);" 
```

不幸的是，“comp”也是一个保留字。请参阅[Access 中的问题名称和保留字](http://allenbrowne.com/AppIssueBadWord.html#C)。

括号中的保留字在您的`CREATE INDEX`声明中：

```
CREATE INDEX [comp] ON ExpFactMap([Group]); 
```

# sitecore - 在 ImageField 上设置 MediaItem

> ID：11399980
> 
> 赞同：3
> 
> 时间：2012-07-09T17:21:51.970
> 
> 标签：sitecore, sitecore6, sitecore-media-library

目前`mediaItem.Src`正在使用 MediaItem 属性抛出一个过时的警告和状态。虽然`mediaItem.MediaItem`没有二传手。这个警告真的只是为了让人们使用类似的东西：

```
var image = new Sitecore.Data.Items.MediaItem(imageField.MediaItem);
Sitecore.Resources.Media.MediaManager.GetMediaUrl(image); 
```

（和相关的字段属性）仍然是`.Src`实际设置字段值的推荐方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T01:23:54.110

我相信您会设置媒体 ID 而不是媒体项目属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T12:40:57.973

我会参考第 4.1.7 节下的 Content API Cookbook（ [PDF 链接）](http://sdn.sitecore.net/upload/sitecore6/64/content_api_cookbook-usletter.pdf)

它的一些示例代码：

```
home.Editing.BeginEdit();
imageField.Clear();
imageField.Src = Sitecore.Resources.Media.MediaManager.GetMediaUrl(sampleMedia);
imageField.MediaID = sampleMedia.ID;
imageField.MediaPath = sampleMedia.MediaPath;
... 
```

# makefile - 生成文件 w。协议缓冲区和自动依赖

> ID：11399983
> 
> 赞同：5
> 
> 时间：2012-07-09T17:21:56.973
> 
> 标签：makefile, protocol-buffers

我有一个像这样的 Makefile：

```
.SECONDARY:

NVCC = nvcc
NVCCFLAGS = --gpu-architecture compute_20

CXX = g++
CXXFLAGS = -O3 -std=c++0x -Wall

CXXLINT = python cpplint.py
CXXLINTFLAGS = --filter=-build/include,-readability/streams,-runtime/sizeof,-whitespace/parens

PROTOC = protoc
PROTOCFLAGS = --cpp_out=.

BINS = my_binary
LIBS = -lcublas -lcusparse
PROTOS = $(wildcard *.proto)
SOURCES = $(wildcard *.cu)
HEADERS = $(wildcard *.cuh)
PBS = $(PROTOS:%.proto=%.pb)
DEPS = $(SOURCES:%.cu=%.d)
TESTS = my_test

all: lint protos
all: deps
all: bins
protos: ${PBS}
deps: ${DEPS}
bins: ${BINS}

clean:
    rm -rf *.o *.d *.pb.cc *.pb.h ${BINS} ${TESTS}

lint:
    ${CXXLINT} ${CXXLINTFLAGS} ${SOURCES}
    ${CXXLINT} ${CXXLINTFLAGS} ${HEADERS}

tests: lint protos
tests: deps
tests: ${TESTS}
tests: tests-run
tests-run: ${TESTS}
    for f in $^; do eval "/usr/bin/time -f \"$$f runtime: %E\" ./$$f"; done

%: %.o
    ${NVCC} ${NVCCFLAGS} -o $@ $^ ${LIBS}

%.d: %.cu
#   ${CXXLINT} ${CXXLINTFLAGS} $*.cu
    ${NVCC} -M -o $*.d $*.cu

%.o: %.cu
    ${NVCC} ${NVCCFLAGS} -c -o $@ $*.cu
    rm $*.d

%.pb: %.proto
    ${PROTOC} ${PROTOCFLAGS} $*.proto
    ${CXX} ${CXXFLAGS} -c -o $*.pb.o $*.pb.cc

ifneq ($(MAKECMDGOALS),clean)
-include ${DEPS}
endif 
```

出现问题是因为在构建原型目标之前我无法生成 DEPS。因为构建协议缓冲区会在树中添加一个新的头文件，如果这不是在 DEPS 之前首先完成，nvcc -M（make 依赖）将失败，因为它找不到生成的 *.pb.h . 任何想法如何解决这一问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-15T23:52:03.857

另一种解决方案是使您的依赖文件依赖于协议缓冲区生成的结果。以下代码段包含所有步骤，因为很难一一解释，底部有一些项目的解释：

```
CXX_FLAGS      := $(shell pkg-config --cflags protobuf) -xc++
LD_FLAGS       := $(shell pkg-config --libs protobuf)

PROTOS         := $(wildcard *.proto)
PROTO_OBJS     := $(PROTOS:.proto=.pb.o)

BINS     := my_binary

SRCS     := $(wildcard *.cu)
OBJS     := $(SRCS:.cu=.o)
DEPS     := $(SRCS:.cu=.d)

PBSRCS   := $(wildcard *.proto)
PBOBJS   := $(PROTOS:.proto=.pb.o)
PBGENS   := $(PROTOS:.proto=.pb.cc) $(PROTOS:.proto=.pb.h)

all: $(BINS)

clean:
        rm -f $(BINS) $(OBJS) $(DEPS) $(PBOBJS) $(PBGENS)

$(BINS): $(OBJS)
$(OBJS): $(DEPS)
$(DEPS): $(PBOBJS)

.PRECIOUS: $(PBGENS)

%.d: %.cu
        $(CXX) -M $(CXX_FLAGS) $< > $@

%.pb.cc: %.proto
        protoc --cpp_out=. $<

%.pb.o : %.pb.cc
        $(CXX) $(CXX_FLAGS) -c -o $@ $<

%.o: %.cu
        $(CXX) $(CXX_FLAGS) -c -o $@ $<

$(BINS): %: %.o
        $(CXX) $(LD_FLAGS) -o $@ $(PROTO_OBJS) $^

ifneq ($(MAKECMDGOALS),clean)
-include $(DEPS)
endif 
```

该`pkg-config`命令不是必需的，但如果您想自动获取与 protobuf 文件相关的编译和链接标志，则很方便。当然，您必须将自己的标志添加到此变量中。

可能对您没用，但在这里使用`-xc++`是为了能够处理`.cu`文件并将它们解释为 C++；即使对于不同于`nvcc`.

该行`$(DEPS): $(PBOBJS)`指示应该在创建依赖项之前创建和编译 protobuf 文件。有几种方法可以实现这一点，因此这只是一个示例。

该`.PRECIOUS`行指示`make`保留生成的 protobuf 文件。在此示例代码段中，这些文件被视为中间文件，因此将在没有此行的情况下被删除。

我将此作为单独的答案发布，因为前一个和这个没有太多共同点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T12:54:10.723

在构建依赖项时，即使缺少头文件，您也可以选择继续。使用`cpp`or `gcc`，可以通过使用 options 来实现`-MM -MG`。我没有使用 NVCC 的经验，但我在手册中没有看到任何支持这些标志。如果这是真的，那么您可以尝试`cpp`仅切换到依赖项生成。从`cpp`手册页：

> -MG 假定丢失的头文件是生成的文件，并将它们添加到依赖项列表中而不会引发错误。

顺便说一句，你的模式规则`%.pb: %.proto`对我来说似乎不正确。它依赖于`%.pb.h`并且使用当前方法，将不知道如何解决任何依赖关系，因为它不知道如何创建文件。`%.pb.cc``%.proto``make``%.pb.h``.pb.h`

# jquery - 检查每个图像是否可见。如果没有可见，做点什么

> ID：11399984
> 
> 赞同：1
> 
> 时间：2012-07-09T17:22:05.323
> 
> 标签：jquery, each

```
$("img").each(function() {
    if($(this).is(':hidden')) {
        $("p#nothing").show();
    }
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div id="imgWrap">
<img src="http://static.pullandbear.net/2/photos/2012/V/0/1/p/9396/326/800/9396326800_4_1_4.jpg" class="fashion black" alt="">
<img src="http://static.pullandbear.net/2/photos/2012/V/0/1/p/9396/323/401/9396323401_4_1_4.jpg" class="fashion" alt="">
<img src="http://static.pullandbear.net/2/photos/2012/V/0/1/p/9396/306/622/9396306622_4_1_4.jpg" class="fashion pink" alt="">
<img src="http://static.pullandbear.net/2/photos/2012/V/0/1/p/5396/361/707/5396361707_4_1_4.jpg" class="fashion brown" alt="">
<img src="http://static.pullandbear.net/2/photos/2012/V/0/1/p/5396/302/800/5396302800_4_1_4.jpg" class="fashion pink" alt="">
<img src="http://static.pullandbear.net/2/photos/2012/V/0/1/p/5396/377/800/5396377800_4_1_4.jpg" class="fashion black" alt="">
<img src="http://static.pullandbear.net/2/photos/2012/V/0/1/p/5396/349/725/5396349725_4_1_4.jpg" class="fashion beige" alt="">
<img src="http://static.pullandbear.net/2/photos/2012/V/0/1/p/5639/306/401/5639306401_4_1_4.jpg" class="jumpsuit blue" alt="">
</div>
```

```
$("img").each(function() {
    if($(this).is(':hidden')) {
        $("p#nothing").show();
    }
}); 
```

HTML：

```
<div id="imgWrap">
<img src="http://static.pullandbear.net/2/photos/2012/V/0/1/p/9396/326/800/9396326800_4_1_4.jpg" class="fashion black" alt="">
<img src="http://static.pullandbear.net/2/photos/2012/V/0/1/p/9396/323/401/9396323401_4_1_4.jpg" class="fashion" alt="">
<img src="http://static.pullandbear.net/2/photos/2012/V/0/1/p/9396/306/622/9396306622_4_1_4.jpg" class="fashion pink" alt="">
<img src="http://static.pullandbear.net/2/photos/2012/V/0/1/p/5396/361/707/5396361707_4_1_4.jpg" class="fashion brown" alt="">
<img src="http://static.pullandbear.net/2/photos/2012/V/0/1/p/5396/302/800/5396302800_4_1_4.jpg" class="fashion pink" alt="">
<img src="http://static.pullandbear.net/2/photos/2012/V/0/1/p/5396/377/800/5396377800_4_1_4.jpg" class="fashion black" alt="">
<img src="http://static.pullandbear.net/2/photos/2012/V/0/1/p/5396/349/725/5396349725_4_1_4.jpg" class="fashion beige" alt="">
<img src="http://static.pullandbear.net/2/photos/2012/V/0/1/p/5639/306/401/5639306401_4_1_4.jpg" class="jumpsuit blue" alt="">
</div>

<p id="nothing">No products were found that matched your filters</p> 
```

这不起作用，但我真的不知道为什么。需要做什么：检查所有图像是否可见。如果它们都不可见，则显示一个段落。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:23:33.403

我们可以使用 selector 来找出可见的 img 控件。`$("img:visible")`为您提供可见的 jQuery img 对象数组。通过检查长度，我们发现有多少 img 控件是可见的，这`length = 0`意味着选择器没有返回任何元素`means none of img is visible`。

```
if($("img:visible").length == 0)
{
  //show graph
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T17:25:19.277

您的代码所做的是在任何图像被隐藏时显示该段落，如果所有图像都被隐藏，您想要显示它：

```
var shown = false;
$("img").each(function() {
  if($(this).is(':hidden')) {
    shown = true;
  }
});
if (!shown) {
  $("p#nothing").show();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T17:25:16.413

试试这个：

```
if ($("img:hidden").length > 0) {
    $("p#nothing").show();
} 
```

# node.js - 如何在节点中将套接字升级到 TLS？

> ID：11399986
> 
> 赞同：2
> 
> 时间：2012-07-09T17:22:12.043
> 
> 标签：node.js, ftp, openssl, ssl

我正在尝试在 Node 中编写一个支持具有显式身份验证的 TLS 的 FTP 服务器。在这种模式下，客户端向服务器发送`AUTH TLS`命令，服务器以确认响应，提示客户端开始协商安全连接。

我正在使用此代码升级连接：[https](https://github.com/andris9/rai/blob/master/lib/starttls.js) ://github.com/andris9/rai/blob/master/lib/starttls.js 。我通过使用 net.Server 编写一个简单的 echo 服务器，然后使用该`starttls`函数立即将套接字升级到安全连接来验证这是否有效。`openssl s_client`使用按预期连接到此测试服务器。

但是，当我尝试使用支持具有显式身份验证的 TLS 的 FTP 客户端连接到我的测试 FTP 服务器时，由返回的对象引发以下异常`createSecurePair`：

```
[Error: 140735236446560:error:1408A0B7:SSL routines:SSL3_GET_CLIENT_HELLO:no ciphers     
 specified:../deps/openssl/openssl/ssl/s3_srvr.c:1009:
] 
```

我实际上已经指定了密码（`createSecurePair`传递了一个设置为 'RC4-SHA:AES128-SHA:AES256-SHA'的`options`字典）。`ciphers`我已经对连接进行了数据包嗅探，似乎发生的情况是，在服务器响应客户端的`AUTH TLS`命令后，客户端和服务器之间进行了短暂的交换，我认为这是（失败的）TLS 协商。但我对 TLS 的了解还不够深入，无法进一步调查。我应该如何去调查这个错误的来源？

我正在运行节点 0.8.1，并且与 0.6.19 有相同的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T13:39:54.407

事实证明这只是一个愚蠢的错误。我正在修改的 FTP 服务器代码使用`socket.setEncoding`. 当然，打开它会搞砸 TLS 协商。

# c# - 非对称 TCP 加密 C#

> ID：11399994
> 
> 赞同：4
> 
> 时间：2012-07-09T17:23:12.590
> 
> 标签：c#, .net, encryption, ssl, tcp

我想编写一个使用 tcp 套接字进行通信的客户端和服务器应用程序。但是我不需要证书，因为用户不在乎对方是谁。但我确实需要非对称加密，所以没有人可以窥探。我想不出使用 RSA 共享对称密钥的方法，但无论如何我认为我应该将 SSL 与 TCP 一起使用？

在 C# 中创建 SSL/TCP 连接的最常用方法是什么？我想我要么不指定证书，要么动态创建其中一个（但它们应该是一次性的......）。实现它的最简单方法是什么？我尝试简单地将 sslstream 添加到我的 tcp 流中，但这并没有削减它（我得到流不可读错误）。到目前为止，这是我的简单代码

```
 {
        Thread serverThread = new Thread((ThreadStart)delegate
        {
            TcpListener listener = new TcpListener(1234);
            listener.Start();
            using (TcpClient client = listener.AcceptTcpClient())
            //using (var sslstream = client.GetStream())
            using (var sslstream = new System.Net.Security.SslStream(client.GetStream(), true))
            using (StreamReader reader = new StreamReader(sslstream))
            using (StreamWriter writer = new StreamWriter(sslstream))
            {
                writer.AutoFlush = true;
                string inputLine;
                while ((inputLine = reader.ReadLine()) != null)
                {
                    writer.WriteLine(inputLine);
                }
            }
        });
        serverThread.Start();
        {
            string[] linesToSend = new string[] { "foo", "bar", "ack" };
            using (TcpClient client = new TcpClient("127.0.0.1", 1234))
            //using (var sslstream = client.GetStream())
            using (var sslstream = new System.Net.Security.SslStream(client.GetStream(), true))
            using (StreamReader reader = new StreamReader(sslstream))
            using (StreamWriter writer = new StreamWriter(sslstream))
            {
                writer.AutoFlush = true;
                foreach (string lineToSend in linesToSend)
                {
                    Console.WriteLine("Sending to server: {0}", lineToSend);
                    writer.WriteLine(lineToSend);
                    string lineWeRead = reader.ReadLine();
                    Console.WriteLine("Received from server: {0}", lineWeRead);
                    //Thread.Sleep(2000); // just for effect
                }
                Console.WriteLine("Client is disconnecting from server");
            }
        }
        serverThread.Join();
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T17:32:13.123

您需要提供一个实现[`LocalCertificateSelectionCallback`](http://msdn.microsoft.com/en-us/library/system.net.security.localcertificateselectioncallback.aspx)来选择要使用的证书，并且您需要提供一个实现[`RemoteCertificateValidationCallback`](http://msdn.microsoft.com/en-us/library/system.net.security.remotecertificatevalidationcallback)来接受对等方使用的自签名证书。

要创建自签名证书（即一次性），请参阅[在 C# 中创建自签名证书](http://blogs.msdn.com/b/dcook/archive/2008/11/25/creating-a-self-signed-certificate-in-c.aspx)。

[在使用 SSL 和 SslStream 进行点对点身份验证](https://stackoverflow.com/a/699922/105929)中也有一个关于 SO 的分步示例。

确保你理解其中的含义，即。中间人可能会降低您的流量，因为您实际上并未验证所提供的证书。换句话说，这根本不是一种*身份验证*形式（如 SO 链接答案中所建议的那样），而只是一种与*某人*进行私人通信的方式，但您并不真正知道与谁联系。另一种方法是使用根证书来签署每个使用的一次性证书并验证客户端中的证书链，但与博客链接相比，这会使证书的生成变得非常复杂。

# arrays - Bash：有没有一种方法可以轻松地将大数组分解成更小的数组？

> ID：11399999
> 
> 赞同：5
> 
> 时间：2012-07-09T17:23:31.407
> 
> 标签：arrays, bash, split

我想知道 bash 中是否有一种简单的方法可以将一个大数组分解为几个较小的数组。我目前正在考虑这样的事情：

```
for ((i = 0; i<= (bigArrayLength/2); i++))  do   
bigArray[i] = smallArray[i]  
done

for ((i = (bigArrayLength/2); i <=bigArrayLength; i++))  
do  
bigArray[i] = secondSmallArray[i]  
done 
```

但必须有更好的方法来解决它。有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-09T17:42:58.393

如果你有`bash`3.2 或更高版本，你可以使用新的“子元素”语法 ( `${bigArray[@]:index_of_first_element:element_count}`)，但要小心 - 如果元素值中有任何空格，这可能会在没有预处理的情况下严重破坏。

所以这个想法是这样的：

```
cnt="${#bigArray[@]}"
let cnt1="$cnt/2"
let cnt2="$cnt - $cnt1 - 1"
# this way we remove the rounding error if the count was odd and account for 0-based indexing

smallArray=( "${bigArray[@]:0:$cnt1}" )
secondSmallArray=( "${bigArray[@]:$cnt1:$cnt2}" ) 
```