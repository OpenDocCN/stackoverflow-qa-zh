# StackOverflow 问答 10962000-10962999

# vb.net - 在 .NET 中接收无标准第 2 层数据包

> ID：10962001
> 
> 赞同：2
> 
> 时间：2012-06-09T14:55:42.520
> 
> 标签：vb.net, raw-sockets, system.net.sockets

我正在尝试在 .NET 中接收第 2 层数据包。我尝试在 RAW 模式下使用套接字但无济于事。

WireShark 数据包示例：

```
 0000   ff ff ff ff ff ff 00 b0 d0 04 82 ae 12 fd bb 00  ................  
 0010   01 1c 00 02 00 b0 d0 04 82 ae 01 af af af af af  ................  
 0020   af af af af af af af af af af af af af af af af  ................  
 0030   af af af af af af af af af af af af              ............ 
```

到目前为止，这是我尝试过的一件事：

```
Private LocalIP As System.Net.IPAddress
Private RAW_TcpSocket As System.Net.Sockets.Socket
Private RAW_IPEndPoint As System.Net.IPEndPoint
Private STR_TcpSocket As System.Net.Sockets.Socket
Private STR_IPEndPoint As System.Net.IPEndPoint

Private Sub frmMain_Load(sender As Object, e As System.EventArgs) Handles Me.Load
    Try
        Me.LocalIP = New System.Net.IPAddress(New Byte() {192, 168, 200, 106})
        Me.RAW_IPEndPoint = New System.Net.IPEndPoint(Me.LocalIP, 0)

        Me.RAW_TcpSocket = New System.Net.Sockets.Socket(Net.Sockets.AddressFamily.InterNetwork, Net.Sockets.SocketType.Raw, Net.Sockets.ProtocolType.IP)

        Dim inValue As Byte() = New Byte(3) {1, 0, 0, 0}
        Dim outValue As Byte() = New Byte(3) {0, 0, 0, 0}

        With Me.RAW_TcpSocket
            Dim RecBuf(512) As System.Byte
            .Bind(Me.RAW_IPEndPoint)
            '.SetSocketOption(SocketOptionLevel.IP, SocketOptionName.TypeOfService, True)
            .IOControl(IOControlCode.ReceiveAll, inValue, outValue)
            .BeginReceive(RecBuf, 0, RecBuf.Length, SocketFlags.None, AddressOf Me.RAW_TcpReceive, RecBuf)
        End With

    Catch ex As Exception
        Debug.WriteLine(ex)
    End Try
End Sub

Private Sub RAW_TcpReceive(ByVal ar As System.IAsyncResult)
    Dim RecBuf As System.Byte() = CType(ar.AsyncState, System.Byte())
    SetText(vbCrLf)
    For Each tmpByte As Byte In RecBuf
        SetText("0x" & tmpByte.ToString("X") & Space(2))
    Next
    Beep()
    'MsgBox("RAW SOCKET RECEIVED DATA")
End Sub 
```

# vb.net - VB.NET中的字典获取分组的键

> ID：10962002
> 
> 赞同：1
> 
> 时间：2012-06-09T14:55:55.760
> 
> 标签：vb.net, count

你好，我有这本词典。。

```
Dim Rooms As New Dictionary(Of Integer, Of Integer)

Rooms(1) = 101, 102, 109, 110
Rooms(2) = 103, 104, 105
Rooms(3) = 106, 107 
```

我想知道我是否可以获得字典中有多少个键

例如，在这本字典中，我有 3 个键，如果我使用 Rooms.Count，它会返回 9，这就是每对键值对，但我想获得 3 个，每个不同的值作为键。

***编辑：Sintax 错误 PD：我现在不能使用，因为我必须在按 IP 过滤的 Web 服务中使用，但是如果我在字典上使用计数，VS2010 会告诉我这将包含键/值对的数量。***

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T15:04:18.153

如果您正在谈论`System.Collections.Generic.Dictionary(Of TKey, Of TValue)`，您的代码将抛出一个，`ArgumentException`因为您多次添加相同的键。

如果您改用索引器，它仍然不起作用：

```
Rooms(1) = 101
Rooms(1) = 102
... 
```

像这样，也不会有例外，但是第二行只会覆盖第一行中存储的值。

看来您实际上想使用`Dictionary(Of Integer, Of List(Of Integer))`. 像这样使用它：

```
Dim Rooms = Rooms As Dictionary(Of Integer, Of List(Of Integer))

Rooms(1) = New List(Of Integer) From { 101, 102, 109, 110 }
Rooms(2) = New List(Of Integer) From { 103, 104, 105 }
Rooms(3) = New List(Of Integer) From { 106, 107 } 
```

`Rooms.Count`然后将为您提供字典中的键数。

当且仅当您的每个键的列表稍后不会更改长度时，您可以使用数组而不是`List(Of Integer)`实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T15:02:32.530

如果将相同的键添加到字典中，则会出现异常。如果这是一个键值对列表，您可以使用 groupby linq 运算符

```
 Dim rooms = New List(Of KeyValuePair(Of String, String))()

rooms.Add(New KeyValuePair(Of String, String)("one", "thing1"))
rooms.Add(New KeyValuePair(Of String, String)("one", "thing2"))
rooms.Add(New KeyValuePair(Of String, String)("two", "other1"))
rooms.Add(New KeyValuePair(Of String, String)("two", "other2"))

Dim query = rooms.GroupBy(Function(x) x.Key)
For Each g As var In query
    Console.WriteLine("Key: " & Convert.ToString(g.Key))
    For Each v As var In g
        Console.WriteLine(vbTab & Convert.ToString(v.Value))
    Next
Next 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T15:05:45.097

请参阅我对 SO 问题[c# 字典的回答如何为单个键添加多个值？](https://stackoverflow.com/a/10089931/880990)我在这里展示了我的多地图实现。这基本上是一个带有列表条目的字典。它允许您存储每个键的值列表。

# ios - 如何在电话间隙中选择多个图像 URI

> ID：10962006
> 
> 赞同：2
> 
> 时间：2012-06-09T14:56:43.783
> 
> 标签：ios, cordova

我阅读了电话间隙文档，可以从相册中获取一个图像 uri，但 uri 位于临时目录中。

我怎样才能直接获取专辑图片uri，或者选择多个图片，有没有关于这个的插件？谢谢

# haskell - 文件处理-Haskell

> ID：10962011
> 
> 赞同：1
> 
> 时间：2012-06-09T14:57:55.047
> 
> 标签：haskell, file-processing, winghci

如何在haskell中实现以下内容：

1.  我从命令行收到一个输入文件。此输入文件包含用制表符、换行符和空格分隔的单词。
2.  我必须用逗号替换这些元素（制表符、换行符和空格）。
3.  然后将结果写入一个名为`output.txt`.

任何帮助深表感谢。我的 Haskell 技能仍在发展中。

* * *

到目前为止，我有这个代码：

```
 processFile::String->String
    processFile [] =[]
    processFile input =input

    process :: String -> IO String
    process fileName = do
    text <- readFile fileName
    return (processFile text)

    main :: IO ()
    main = do
    n <- process "input.txt"
    print n 
```

在 processFile 函数中，我应该处理输入文件中的文本。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-09T15:32:42.810

您可以使用该`getArgs`函数在命令行上读取参数。例如：

```
import System.Environment (getArgs)

main = do
  args <- getArgs
  case args of
    [arg] -> putStrLn $ "You gave me one arg: " ++ arg
    _     -> putStrLn $ "You gave me " ++ show (length args) ++ " arguments." 
```

* * *

您可以使用该`readFile`功能读取文件。

```
contents <- readFile "test.txt"
putStrLn contents -- Prints the contents of the file 
```

* * *

您可以使用该`writeFile`函数写入文件：

```
writeFile "test2.txt" "Some file data\n" -- Writes the data to the file 
```

* * *

制表符、换行符和空格可以称为空格或单词分隔符。该`words`函数将字符串转换为单词列表。

```
print $ words "some text with\nmany words"
-- prints ["some", "text", "with", "many", "words"] 
```

* * *

该`intersperse`函数在列表的每个元素之间插入一个分隔符：

```
import Data.List (intersperse)

main =
  print $ intersperse '.' ["some", "text", "with", "many", "words"]
  -- prints "some.text.with.many.words" 
```

`intercalate`如果您需要更长的分隔符，您也可以查看该功能。

* * *

这些是您的程序所需的所有工具，我认为您可以弄清楚其余的。祝你好运！

# ios - 越狱的 iPhone 无法调试

> ID：10962012
> 
> 赞同：0
> 
> 时间：2012-06-09T14:58:00.903
> 
> 标签：ios, debugging, jailbreak

我有一部越狱的 iPhone 5.1.1。我使用本[教程](http://iphonedevwiki.net/index.php/Xcode#Developing_without_Provisioning_Profile)为开发做好准备。

现在; 当我在插入 iPhone 的情况下调试我的 Xcode 项目时，它首先显示：

```
Build Succeeded. 
```

然后，它将项目上传到我的 iPhone。（在那一刻一切正常。）

但是，当我在 iPhone 的屏幕上看到一个空白页面仅一秒钟后，程序会自行关闭并返回到正常的主页 UI。

之后，如果我通过手动单击上传的程序图标从手机运行程序，效果很好。

因此，它适用于将应用程序上传到 iPhone，但不适用于调试。

**问题：**有没有办法让它也可以用于调试？

## 编辑：

我使用 Xcode 4.3.2。

**运行应用程序后的控制台错误：**

1.  Xcode：错误：无法根据默认值为 ID“启用”创建警报：1
2.  Xcode：AMDeviceStartHouseArrestService（线程 0x1066ba000）：设备出错：ApplicationLookupFailed

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-16T09:48:31.953

我使用来自[http://oneiros.altervista.org/jailcoder/的 Jailcoder](http://oneiros.altervista.org/jailcoder/)

它设置 xcode 和您的项目，以便您可以在设备上运行和调试。

我第一次使用 xcode 时必须重新安装它，因为我自己更改了一些设置并且它们发生冲突，

# delphi - `overload` 关键字有什么不同吗？

> ID：10962017
> 
> 赞同：11
> 
> 时间：2012-06-09T14:58:39.320
> 
> 标签：delphi, overloading

有时我在未重载的方法之后有“重载”关键字。

除了代码的可读性和可维护性之外，这是否还有我应该注意的其他影响？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-09T15:21:54.107

最大的区别在于，当方法的参数不正确时，错误消息对于非重载方法要好得多。

```
program Test;

procedure F(X: Integer);
begin
end;

procedure G(X: Integer); overload;
begin
end;

var
  P: Pointer = nil;

begin
  F(P); // E2010 Incompatible types: 'Integer' and 'Pointer'
  G(P); // E2250 There is no overloaded version of 'G' that can be called with these arguments
end. 
```

更微妙的是，重载的方法可能会被你不知道的函数重载。考虑标准`IfThen`函数。`StrUtils.IfThen`只存在一次：

```
function IfThen(AValue: Boolean; const ATrue: string;
  AFalse: string = ''): string; overload; inline; 
```

但它被标记为`overload`。这是因为它被 重载了`Math.IfThen`，并且如果单个单元同时使用`Math`and `StrUtils`，则不合格的`IfThen`将根据参数解析为正确的函数，而不管`uses`列表中单元的顺序如何。

# couchdb - couchdb - 过滤复杂键

> ID：10962018
> 
> 赞同：1
> 
> 时间：2012-06-09T14:58:52.673
> 
> 标签：couchdb, mapreduce, analytics

我在 couchdb 中有以下模式的 30m 条记录。

```
{ countryIso: 'TR'
, region: '68'
, city: 'Ankara'
, lat: '39.927200317383'
, lon: '32.864398956299'
, action: 'install'
, itime: 1288523291000  // That is unix timestamp
, fileId: 33221
, api_level: '3'
, display_size: '320x480'
, model: 'Galaxy'
} 
```

这些记录代表服务中文件的下载。我想做的是为这些事件提供统计数据。

一些示例查询：

*   给定 fileId 和日期范围，获取每天的下载次数
*   给定 fileId 和日期范围，获取每天使用的 display_size
*   给定 fileId 和日期范围，获取每天使用的 api_level

理想情况下（如果可能），我们还应该回答更复杂的查询，例如：

*   给定 fileId、日期范围和 countryIso，显示每天的下载量

我做了以下地图功能

```
function (doc) {
  emit([doc.fileId,
        Math.floor(doc.itime/60/60/24),
        doc.countryIso, doc.display_size,
        doc.api_level], 1)
} 
```

并`_sum`作为reduce函数。

现在我可以做到这一点

```
?group_level=2&startkey=[247]&endkey=[247,{}]

{"rows":[
{"key":[247,14913505],"value":4},
{"key":[247,14913528],"value":4},
{"key":[247,14913563],"value":4}
]} 
```

例如，每天获取特定 fileId 的下载量。

或这个

```
?group_level=3&startkey=[247]&endkey=[247,{}]

{"rows":[
{"key":[247,14913505,"GB"],"value":4},
{"key":[247,14913528,"AE"],"value":4},
{"key":[247,14913563,"TR"],"value":4}
]} 
```

获取每个国家/地区每天特定 fileId 的下载量。

但我似乎无法以一种会返回这个的方式来查询我的视图

```
{"rows":[
{"key":[247,14913505,"320x480"],"value":4},
{"key":[247,14913528,"320x480"],"value":4},
{"key":[247,14913563,"320x533"],"value":4}
]} 
```

我是否必须为我需要的每个查询（图表）创建一个单独的视图，或者您认为可以创建一个复杂的视图来回答所有这些查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T08:03:05.067

没有办法像那样分割你的键，你只有词汇顺序可以使用。所以做单独的视图。

# uitableview - UITableView 部分将使用一个属性进行排序并为标题显示另一个

> ID：10962022
> 
> 赞同：0
> 
> 时间：2012-06-09T14:59:51.717
> 
> 标签：uitableview, ios4, ios5

我有一个核心数据UITableView，核心数据托管对象有4个属性（headerTitle、headerNumber、objectTitle、objectComment）。

我希望 UITableView 由 headerNumber 划分，但 titleForHeaderInSection 是 headerTitle 属性。目前我在下面有这段代码....

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    id <NSFetchedResultsSectionInfo> sectionInfo = [[self.fetchedResultsController sections] objectAtIndex:section];
    return [sectionInfo numberOfObjects];
}

- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section 
{
    id <NSFetchedResultsSectionInfo> sectionInfo = [[__fetchedResultsController sections] objectAtIndex:section];
    return [NSString stringWithFormat:@"%@", [sectionInfo name]];
}

- (NSFetchedResultsController *)fetchedResultsController
{
    if (__fetchedResultsController != nil) {
        return __fetchedResultsController;
    }

    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    // Edit the entity name as appropriate.
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"Event" inManagedObjectContext:self.managedObjectContext];
    [fetchRequest setEntity:entity];

    // Set the batch size to a suitable number.
    [fetchRequest setFetchBatchSize:20];

    // Edit the sort key as appropriate.
    NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"timeStamp" ascending:NO];
    NSArray *sortDescriptors = [NSArray arrayWithObjects:sortDescriptor, nil];

    [fetchRequest setSortDescriptors:sortDescriptors];

    // Edit the section name key path and cache name if appropriate.
    // nil for section name key path means "no sections".
    NSFetchedResultsController *aFetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:self.managedObjectContext sectionNameKeyPath:@"headerNumber" cacheName:@"Master"];
    aFetchedResultsController.delegate = self;
    self.fetchedResultsController = aFetchedResultsController;

    NSError *error = nil;
    if (![self.fetchedResultsController performFetch:&error]) {
         // Replace this implementation with code to handle the error appropriately.
         // abort() causes the application to generate a crash log and terminate. You should not use this function in a shipping application, although it may be useful during development. 
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        abort();
    }

    return __fetchedResultsController;
} 
```

headerNumber 是 2012 年 6 月的数字年份和月份，如 201206。 headerTitle 是 headerNumber 的单词，例如“June 2012”

有没有人有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T10:11:19.137

您可以使用以下方法在表格视图中显示 headerTitle 属性

```
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section {

NSString *sectionTitle = [self tableView:tableView titleForHeaderInSection:section];

//return a view with uiLable and show your headerTitle there

} 
```

并使用以下方法显示 headerNumber 属性

```
- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section 
{
      // put your code here 
} 
```

这将如何帮助你

# php - 如果页面中有未处理的错误，我如何在 php 中重定向？

> ID：10962023
> 
> 赞同：0
> 
> 时间：2012-06-09T15:00:27.830
> 
> 标签：php, error-handling

在 asp.net 中，如果页面中有未处理的错误，我可以轻松地将用户重定向到客户错误页面，方法是将其放在 web.config 上：

```
<customErrors mode="RemoteOnly" defaultRedirect="Oops.aspx"  /> 
```

我现在正在研究 php，如果出现未处理的错误，我想要将用户重定向到另一个页面。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T15:05:22.040

如果出现错误，您不想重定向。您想使用 http 500 进行响应。

对于非致命错误，您可以使用 php`set_error_handler`和`set_exception_handler`函数。对于致命错误，PHP 将响应 500 和空白页面，但您可以将 Web 服务器配置为提供自定义页面。例如，对于 Apache，您将这一行放在配置中：

```
ErrorDocument 500 /error500.html 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T15:53:06.140

我建议可能考虑使用异常，或者根据您的应用程序产生的错误创建一个错误处理类。

至于 PHP 中的重定向，你可以使用`header()`PHP 中的方法。

[头功能](http://www.w3schools.com/php/func_http_header.asp)

使用此方法的最简单方法是执行以下操作：

`header('Location: www.example.com');`

上面的代码片段将重定向到代码中的指定站点。

该`header()`方法将允许您重定向到另一个页面或站点。

如果您有兴趣，可以了解有关[PHP 异常的](http://net.tutsplus.com/tutorials/php/the-ins-and-outs-of-php-exceptions/)更多信息。

# android - 无法使用 AsyncTask 显示 ProgessDialog

> ID：10962028
> 
> 赞同：0
> 
> 时间：2012-06-09T15:01:15.380
> 
> 标签：android, android-asynctask

我使用 asynctask 从 Web 服务获取数据。但是线程执行时progessdialog不显示

```
private class Task_Bank extends AsyncTask<Void, Void, ArrayList<String>>{
        @Override
        protected ArrayList<String> doInBackground(Void... params) {
            ArrayList<String> arrayBankL = new ArrayList<String>();
            String url="http://qhoang.org/webservices/get_list_bank.php";
            JSONParser jsonParser = new JSONParser();
            JSONObject jsonObject = jsonParser.getJSONFromURL(url);
            int i = 0;
            try{
                JSONArray array_bank = jsonObject.getJSONArray("list_bank");
                for(i=0;i<array_bank.length();i++){
                    JSONObject node = array_bank.getJSONObject(i);
                    JSONObject c = node.getJSONObject("node_list_bank");
                    String namebank = c.getString("tennganhang");
                    arrayBankL.add(namebank);
                }
            }catch(JSONException e){
                e.printStackTrace();
            }
            return arrayBankL;
        }

        @Override
        protected void onPostExecute(ArrayList<String> result) {
            ArrayAdapter<String> arrayAdapter_bank = new ArrayAdapter<String>(TaskAActivity.this,android.R.layout.simple_spinner_item,result);
            arrayAdapter_bank.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
            spn_bank.setAdapter(arrayAdapter_bank);
        }

        @Override
        protected void onProgressUpdate(Void... values) {
            ProgressDialog MyDialog = ProgressDialog.show( TaskAActivity.this, " " , " Loading. Please wait ... ", true);
        }   
} 
```

OnCreate()

```
Task_Bank a = new Task_Bank();
a.execute(); 
```

JSONParser 是使用来自 web 服务结果的解析器 JSON 的 i 类代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T15:02:54.940

您应该在任务开始之前开始`show()`对话，这是正确的地方。`onPreExecute()`在`onProgressUpdate`你应该只增加你的进度`ProgressDialog`。当任务完成时，在`onPostExecute()`通话中`MyDialog.dismiss()`

```
@Override
protected void onPreExecute() {
   progressDialog.show();           
} 
```

它可能是这样的

```
ProgressDialog MyDialog = ProgressDialog.show(TaskAActivity.this, " " , " Loading. Please wait ... ", true);
// some settings
Task_Bank a = new Task_Bank();
a.execute();

@Override
   protected void onPreExecute() {
      MyDialog.show();          
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T15:07:46.910

您应该对代码进行一些修改以显示进度对话框。

> 开始在 onPreExecute 中显示 ProgressDialog。
> 
> 在 onPostExecute 中停止显示进度对话框。

```
@Override
    protected void onPreExecute() {
        super.onPreExecute();
        dialog = new ProgressDialog(context);
        dialog.setTitle("Hello");
        dialog.setMessage("Please Wait!!!");
        dialog.setProgressStyle(ProgressDialog.STYLE_SPINNER);
        dialog.show();
    }

@Override
    protected void onPostExecute(Object result) {
        dialog.dismiss();
                ---------
} 
```

# twitter - 我不明白 twitter 引导跨度和行

> ID：10962032
> 
> 赞同：34
> 
> 时间：2012-06-09T15:02:02.603
> 
> 标签：twitter, twitter-bootstrap, 960.gs

我是一个巨大的 960 网格系统用户，我想我会尝试[Twitter Bootstrap](http://twitter.github.com/bootstrap/)，但也许这是一个愚蠢的问题，你可以笑着投反对票，但事实是我不了解跨度和行。

所以我的问题是，当我创建一个容器并在其中创建跨度时，它不能正确地彼此相邻：

如果我写以下内容，就像在[960gs中一样](https://960.gs/)

```
<div class="container_12">
  <div class="grid_4"></div>
  <div class="grid_4"></div>
  <div class="grid_4"></div>
</div> 
```

我得到一个完美的 3 列彼此相邻。

但是我无法使用 Twitter Bootstrap 实现这一点，无论我做什么，我总是会得到不成比例的列，所以这些列不会像它应该的那样填充容器，就像 960gs 一样。如果我放置 3 列，则右侧的边距不正确，或者无法正确放入容器中。

Boostrap 示例：

```
<div class="container">
    <div class="row">
        <div class="span4">
            <h2>Column one</h2>
            <p>
                Donec id elit non mi porta gravida at eget metus. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus. Etiam porta sem malesuada magna mollis euismod. Donec sed odio dui.
            </p>
        </div>  
        <div class="span4">
            <h2>Column one</h2>
            <p>
                Donec id elit non mi porta gravida at eget metus. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus. Etiam porta sem malesuada magna mollis euismod. Donec sed odio dui.
            </p>
        </div>  
        <div class="span4">
            <h2>Column one</h2>
            <p>
                Donec id elit non mi porta gravida at eget metus. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus. Etiam porta sem malesuada magna mollis euismod. Donec sed odio dui.
            </p>
        </div>  
    </div>  
</div> 
```

![在此处输入图像描述](../Images/0011854f044f9e7257ffe2634df66188.png)

所以在上面的例子中，我最终得到了不成比例的列，左边的第一列没有边距。如果我使用网格类在 960gs 中执行此操作，那就完美了。

与导致我的问题的 960gs 相比，Twitter Bootstrap 有什么不同？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-06-09T18:04:25.223

**原因：**

*   容器是 940px
*   行为 960px，边距为 -20px
*   span4 300px，边距为 20px

当屏幕宽度 <=940px 时，行的 -20px 和 span4 的 20px 边距相互抵消，这就是第一个 span4 没有左边距的原因。

**“推特引导”解决方案：**

添加 bootstrap-responsive.css 以及当屏幕低于 980 像素并超过 768 像素时：

容器变为 724px，行 744px 和 span4 228px，在第一个 span4 上保持左边距。

# python - Python烧瓶应用程序验证文本字段 - 不允许空间

> ID：10962038
> 
> 赞同：5
> 
> 时间：2012-06-09T15:03:37.670
> 
> 标签：python, flask, wtforms

我在 Python Flask 中有一个应用程序，其中用户名字段具有长度验证。我还想防止用户名中出现空格。我怎么能做到这一点？

```
class RegistrationForm(Form):
    username = TextField('Username', [validators.Length(min=4, max=25)])
    email = TextField('Email Address', [validators.Email(message='Invalid email address.')]) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T15:34:26.760

您应该能够确保使用 Regexp 验证器。我使用 Django 用于用户名表单的正则表达式：

```
username = TextField('Username', [validators.Regexp(r'^[\w.@+-]+$'), validators.Length(min=4, max=25)]) 
```

这允许使用字母数字字符、点、@、+ 和 -。您当然可以将 \w 用于字母数字字符。

# c++ - 在自定义堆栈分配器中释放内存

> ID：10962041
> 
> 赞同：0
> 
> 时间：2012-06-09T15:04:26.803
> 
> 标签：c++, memory-management, destructor

在我的自定义堆栈分配器中，我在程序启动时使用 分配大量内存`malloc()`，然后在程序关闭时`free()`分配所有内存。

所以基本上它看起来像这样：

```
//start up
m_pInitialPosition = malloc(STACK_SIZE);

//shutdown
free(m_pInitilaPosition); 
```

当我需要创建一个新对象时，我调用`allocateNew()`：

```
 Actor* pActor = getStackAllocator().allocateNew<Actor>();
 *pActor = Actor(); 
```

这`allocateNew()`看起来像：

```
template <class T>
T* allocateNew()
{
   //allocate returns void*
   return new (allocate(sizeof(T), __alignof(T))) T;
} 
```

如果我打电话，就会出现问题（_BLOCK_TYPE_IS_VALID（pHead->nBlockUse 异常）：

```
delete pActor; 
```

如果我只是删除该行，问题就会消失并且没有内存泄漏，因为我仍然`free()`在堆栈分配器中调用，但没有调用 Actor 的析构函数......

那么我可以改变什么来确保调用析构函数呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T15:41:39.187

当您调用`delete`时，指向的对象`pActor`将被破坏，并且将使用默认的释放器（可能是 free()）释放内存，而不是您的。由于该对象已由您的分配器分配，因此它无法工作。

定义一种新方法来处理对象删除，如下所示：

```
template<class T> void deleteObject(T *obj) {
   if (obj!=nullptr) {  // do nothing is obj is null
      obj->~T(); // call the object's destructor
      deallocate(obj);  // your method to handle deallocation in your 'memory pool'
   }
} 
```

并将您的删除替换为：

```
 getStackAllocator().deleteObject(pActor); 
```

本文介绍了如何制作自定义内存分配器：[http ://bitsquid.blogspot.fr/2010/09/custom-memory-allocation-in-c.html](http://bitsquid.blogspot.fr/2010/09/custom-memory-allocation-in-c.html)

* * *

此外，我对您的代码有疑问。这些行应该做什么？

```
Actor* pActor = getStackAllocator().allocateNew<Actor>();
*pActor = Actor(); 
```

1-如果 allocateNew() 执行分配和默认构造，没关系，但第二行没用？2- 如果 allocateNew() 只执行分配而不初始化对象，则第二行是错误的：它在未初始化的对象上调用赋值运算符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T15:42:30.303

`delete pActor`不是安置的适当补充`new`。要“撤消”对象构造`new (allocate(sizeof(T), __alignof(T))) T`，您只需要调用析构函数，不使用`delete`它也会尝试在位置指针处释放内存`pActor`

例如

```
pActor->~Actor(); 
```

您可能应该将其包装在堆栈分配器类的成员函数中，这样客户就不必神奇地知道如何解除分配给他们的对象并让您自由地更新分配器的实现。

例如

```
template <class T>
void deallocate(T* t)
{
    t->~T();
} 
```

# iphone - 无法在 UIScrollView 中访问 UITextField

> ID：10962042
> 
> 赞同：1
> 
> 时间：2012-06-09T15:04:31.187
> 
> 标签：iphone, uiscrollview, uitextfield

我正在尝试在 UIScrollView 中添加 UITextField。我无法在 UIScrollView 中获取 UITextField，但单击 TextField 什么也不做。我已经尝试了很多东西。我尝试的最后一件事是制作自定义 ScrollView 并检查 hitTest。我将它设置为对 delaysContentTouches 说“不”，但它仍然什么都不做。我在 TextField 上设置了 userInteractionEnabled ，但仍然没有。我看过所有其他类似的问题，但没有一个有答案。

下面的代码显示了我尝试将 Label 和 TextField 添加到 UIView，然后将该 UIView 添加到 ScrollView 中。这一切都在视觉上起作用，但 TextField 什么也不做。

```
UILabel *lbl = [[UILabel alloc] initWithFrame:CGRectMake(10, 0, 100, 30)];
lbl.text = @"Sample";
[lbl setBackgroundColor:[UIColor clearColor]];
[lbl setTextColor:[UIColor blackColor]];

UITextField *txt = [[UITextField alloc] initWithFrame:CGRectMake(115, 0, 195, 30)];
txt.borderStyle = UITextBorderStyleRoundedRect;
txt.font = [UIFont systemFontOfSize:15];
//txt.placeholder = @"enter username";
txt.autocorrectionType = UITextAutocorrectionTypeNo;
txt.keyboardType = UIKeyboardTypeDefault;
txt.returnKeyType = UIReturnKeyNext;
txt.clearButtonMode = UITextFieldViewModeWhileEditing;
[txt canBecomeFirstResponder];
txt.delegate=self;
txt.userInteractionEnabled=TRUE;
[txt addTarget:self action:@selector(tfTouch:) forControlEvents:UIControlEventTouchUpInside];
txt.contentVerticalAlignment = UIControlContentVerticalAlignmentCenter;   

UIView *theView = [[UIView alloc] init];
theView.userInteractionEnabled=TRUE;
[theView addSubview:lbl];
[theView addSubview:txt];
[scrollView addSubview:theView]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T15:13:04.007

为什么你有另一个视图，你可以直接在滚动视图上添加你的文本字段和标签。可能您只需要为您的视图设置一个框架。那应该这样做：

```
[theView sizeToFit]; 
```

还要正确设置您的 contentSize。`scrollView.contentSize = theView.bounds;`

# c++ - 正确的代码 - 带有 popen 的非阻塞管道

> ID：10962044
> 
> 赞同：2
> 
> 时间：2012-06-09T15:05:07.423
> 
> 标签：c++, pipe, popen

关于非阻塞管道有很多问题，但是没有可以复制和粘贴（几乎没有更正）和使用的代码示例。

我从这个线程中得到了想法和来源： [Non-blocking pipe using popen？](https://stackoverflow.com/questions/1735781/non-blocking-pipe-using-popen)

但是如何使用呢？在`while`周期？请检查我的更改。真的需要使用`errno == EAGAIN`& 附加标题`#include <cerrno>`吗？如果需要，建议您拥有更好的版本：

```
 FILE *pipe;
    char buff[512];
    if ( !(pipe = popen( command.c_str(), "r")) ) return false;

    int d = fileno(pipe);   
    while ( true )
    {
        ssize_t r = read(d, buff, sizeof(buff));
        if (r == -1 && errno == EAGAIN) // really need errno? 
            continue;
        else if (r > 0)
            ptr_output->append(buff);       
        else
            break;
    }

    pclose(pipe); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T15:15:52.563

是的。如果`read`调用返回错误值 ( `-1`)*并* `errno`设置为`EAGAIN`，则表示没有可用数据，因此您`continue`循环再试一次。如果你去掉`errno`，错误将被有效地忽略，你的程序可能会崩溃。想象一下，如果您确实删除了它：当`read`返回`-1`时，例如，错误是管道已损坏（另一端将其关闭），您将继续尝试循环并进入无限循环。馊主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-26T18:41:07.007

在我的 Linux 多线程应用程序*（Ubuntu 16.04、x86_64、Native POSIX Threads、libc.so.6 版本 Ubuntu GLIBC 2.23-0ubuntu9）中，* 这段代码

```
int fd = fileno(pipe);
fcntl(fd, F_SETFL, O_NONBLOCK);
while (true)
        {
            ssize_t r = read(fd, buff, sizeof(buff));
            if ((r == -1) && (errno == EAGAIN)) // really need errno?
                continue;
            else
            {
                if (r > 0)
                    result += buff;
                else
                    break;
            }
        } 
```

即使有`fctnl(...)`原因失败，不仅是命令的输出，而且还经常读取 RAM 中的许多其他任意值。我认为这是由于**代码的线程不安全**。

（示例：`echo`由 20 个线程并行执行 3 个值，10、30 和 40，`read`这些值仅显示最后一个值。输出：40 QIh MIh 40 40 30...）

由于`fgets`实现是**线程安全的****[，因此该答案中的](https://stackoverflow.com/a/478960/1566267)****另一个代码****可以正常工作**：

```
while (!feof(pipe))
{
    if (fgets(buff, sizeof(buff), pipe) != NULL)
    result += buff;
} 
```

# jquery - jQuery - 添加单位到偏移量

> ID：10962049
> 
> 赞同：8
> 
> 时间：2012-06-09T15:05:40.183
> 
> 标签：jquery, offset

小问题。我`div id="comHere"`在设计中间的某个地方。在设计的顶部，我有一个`<a href="#comeHere">Click Here</a>`.

现在，当我单击 href 链接时，它会使用此代码滚动到 div

`scrollTop: $($anchor.attr('href')).offset().top`

我的要求是，比如说，当我点击链接时，我希望滚动发生在而不是从顶部`div`发生位置偏移。`600px``600px+100px``600px`

这可能使用 jQuery 吗？

谢谢，开发

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-09T15:07:18.050

```
scrollTop: $($anchor.attr('href')).offset().top - 100 
```

# iphone - 重新实例化对象和内存泄漏

> ID：10962051
> 
> 赞同：0
> 
> 时间：2012-06-09T15:05:47.117
> 
> 标签：iphone, objective-c, memory-leaks

我想知道最安全的方法是释放一个对象并重新实例化它。

我正在做的是这个，它似乎有效，但我不确定这是否不会造成内存泄漏？

```
- (void)reLoadCalendarObject
{
if (self.calViewController != nil)
    self.calViewController = nil;   //release instantiated object

CalViewController *tempCalViewController = [[CalViewController alloc]initWithDate:[NSDate dateWithTimeIntervalSinceNow:0.0f] observer:self];
self.calViewController = tempCalViewController;
[tempCalViewController release];
self.calViewController.dataSource = self.calendarDataSource;
} 
```

`self.calViewController`属性被声明为`(nonatomic,retain)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T15:31:32.170

当您使用时`@property (nonatomic, retain) MyObject *myObject;`，`@synthesize myObject = _myObject;`编译器将为您生成 getter 和 setter。设置器的**行为**（不一定像这样实现）是这样的

```
1| - (void)setMyObject:(MyObject *)myObject;
2| {
3|     if (_myObject != myObject) {
4|         [_myObject release];
5|         _myObject = [myObject retain];
6|     }
7| } 
```

在第**3**行，我们进行检查以确保您设置的对象与传入的对象不同（我们检查指针，因为我们正在检查它是完全相同的对象）

在第**4**行，我们知道我们有不同的对象，所以我们需要释放旧值

在第**5**行，我们对新对象进行保留

* * *

正如@thesaad 指出的那样，你`self.calViewController = nil;`是多余的，事实上，如果属性已经设置`if (self.calViewController 1= nil)`，发送（或任何对象）将是完全安全的。`nil`

在您传递的示例中，`nil`这就是发生的情况。

在第**3**行，我们看到这`nil`与之前设置的对象不同

在第**4**行，我们释放旧对象

在第**5**行，我们将支持 ivar 设置为`nil`. 打电话`retain`是`nil`无操作的，所以这也很好

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T15:21:58.817

这些行在您的代码中是额外的。

```
if (self.calViewController != nil)
    self.calViewController = nil;   //release instantiated object 
```

当您创建一个属性时，内存管理将转到编译器端。并且您重新实例化它的方式是完美的。所以代码会这样

```
- (void)reLoadCalendarObject
{

CalViewController *tempCalViewController = [[CalViewController alloc]initWithDate:[NSDate dateWithTimeIntervalSinceNow:0.0f] observer:self];
self.calViewController = tempCalViewController;
[tempCalViewController release];
self.calViewController.dataSource = self.calendarDataSource;
} 
```

# ant - 蚂蚁目标中的axis2 java2wsdl

> ID：10962054
> 
> 赞同：0
> 
> 时间：2012-06-09T15:05:55.367
> 
> 标签：ant, axis2

我有一个以下ant脚本，我试图调用axis2中提供的java2wsdl实用程序来从编译java类生成WSDL；

```
<exec executable="java2wsdl" newenvironment="false" dir="${build.ws.java.dir}" failonerror="true">
    <env key="AXIS2_HOME" value="${axis2.home.dir}" />
    <env key="CLASSPATH" value="${toString:compile.classpath}" />
    <env key="Path" value="${axis2.bin.dir}${path.separator}${env.Path}" />
    <env key="PATH" value="${axis2.bin.dir}${path.separator}${env.PATH}" />
    <arg line="-o ${build.ws.java.dir}${file.separator}wsdl" />
    <arg value="-cn ${trimmed.wsClass}" /> 
</exec> 
```

但是在 exec 任务中执行 java2wsdl 时出现异常；

```
xbuild.xml:1141: Execute failed: java.io.IOException: Cannot run program "java2wsdl" (in directory "C:\RTC\sr
c\Dev\Service\build\ws\java"): CreateProcess error=2, The system cannot find the file specified
        at java.lang.ProcessBuilder.start(ProcessBuilder.java:459)
        at java.lang.Runtime.exec(Runtime.java:593)
        at org.apache.tools.ant.taskdefs.Execute$Java13CommandLauncher.exec(Execute.java:862)
        at org.apache.tools.ant.taskdefs.Execute.launch(Execute.java:481)
        at org.apache.tools.ant.taskdefs.Execute.execute(Execute.java:495)
        at org.apache.tools.ant.taskdefs.ExecTask.runExecute(ExecTask.java:631)
        at org.apache.tools.ant.taskdefs.ExecTask.runExec(ExecTask.java:672)
        at org.apache.tools.ant.taskdefs.ExecTask.execute(ExecTask.java:498)
        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.Task.perform(Task.java:348)
        at org.apache.tools.ant.taskdefs.Sequential.execute(Sequential.java:68)
        at net.sf.antcontrib.logic.IfTask.execute(IfTask.java:197)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.TaskAdapter.execute(TaskAdapter.java:154)
        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.Task.perform(Task.java:348)
        at org.apache.tools.ant.Target.execute(Target.java:390)
        at org.apache.tools.ant.Target.performTasks(Target.java:411)
        at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)
        at org.apache.tools.ant.helper.SingleCheckExecutor.executeTargets(SingleCheckExecutor.java:38)
        at org.apache.tools.ant.Project.executeTargets(Project.java:1251)
        at org.apache.tools.ant.taskdefs.Ant.execute(Ant.java:442)
        at org.apache.tools.ant.taskdefs.CallTarget.execute(CallTarget.java:105)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.Task.perform(Task.java:348)
        at org.apache.tools.ant.taskdefs.Sequential.execute(Sequential.java:68)
        at net.sf.antcontrib.logic.ForEach.executeSequential(ForEach.java:178)
        at net.sf.antcontrib.logic.ForEach.execute(ForEach.java:254)
        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.Task.perform(Task.java:348)
        at org.apache.tools.ant.Target.execute(Target.java:390)
        at org.apache.tools.ant.Target.performTasks(Target.java:411)
        at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)
        at org.apache.tools.ant.helper.SingleCheckExecutor.executeTargets(SingleCheckExecutor.java:38)
        at org.apache.tools.ant.Project.executeTargets(Project.java:1251)
        at org.apache.tools.ant.taskdefs.Ant.execute(Ant.java:442)
        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.Task.perform(Task.java:348)
        at org.apache.tools.ant.taskdefs.Sequential.execute(Sequential.java:68)
        at net.sf.antcontrib.logic.IfTask.execute(IfTask.java:197)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.TaskAdapter.execute(TaskAdapter.java:154)
        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.Task.perform(Task.java:348)
        at org.apache.tools.ant.Target.execute(Target.java:390)
        at org.apache.tools.ant.Target.performTasks(Target.java:411)
        at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)
        at org.apache.tools.ant.helper.SingleCheckExecutor.executeTargets(SingleCheckExecutor.java:38)
        at org.apache.tools.ant.Project.executeTargets(Project.java:1251)
        at org.apache.tools.ant.taskdefs.Ant.execute(Ant.java:442)
        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.Task.perform(Task.java:348)
        at org.apache.tools.ant.taskdefs.Sequential.execute(Sequential.java:68)
        at net.sf.antcontrib.logic.IfTask.execute(IfTask.java:197)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.TaskAdapter.execute(TaskAdapter.java:154)
        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.Task.perform(Task.java:348)
        at org.apache.tools.ant.taskdefs.Sequential.execute(Sequential.java:68)
        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.Task.perform(Task.java:348)
        at org.apache.tools.ant.taskdefs.MacroInstance.execute(MacroInstance.java:398)
        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.Task.perform(Task.java:348)
        at org.apache.tools.ant.taskdefs.Sequential.execute(Sequential.java:68)
        at net.sf.antcontrib.logic.IfTask.execute(IfTask.java:197)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.TaskAdapter.execute(TaskAdapter.java:154)
        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.Task.perform(Task.java:348)
        at org.apache.tools.ant.taskdefs.Sequential.execute(Sequential.java:68)
        at net.sf.antcontrib.logic.IfTask.execute(IfTask.java:197)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.TaskAdapter.execute(TaskAdapter.java:154)
        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.Task.perform(Task.java:348)
        at org.apache.tools.ant.taskdefs.Sequential.execute(Sequential.java:68)
        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.Task.perform(Task.java:348)
        at org.apache.tools.ant.taskdefs.MacroInstance.execute(MacroInstance.java:398)
        at net.sf.antcontrib.logic.ForTask.doSequentialIteration(ForTask.java:259)
        at net.sf.antcontrib.logic.ForTask.doToken(ForTask.java:268)
        at net.sf.antcontrib.logic.ForTask.doTheTasks(ForTask.java:299)
        at net.sf.antcontrib.logic.ForTask.execute(ForTask.java:244)
        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.Task.perform(Task.java:348)
        at org.apache.tools.ant.taskdefs.Sequential.execute(Sequential.java:68)
        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.Task.perform(Task.java:348)
        at org.apache.tools.ant.taskdefs.MacroInstance.execute(MacroInstance.java:398)
        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.Task.perform(Task.java:348)
        at org.apache.tools.ant.Target.execute(Target.java:390)
        at org.apache.tools.ant.Target.performTasks(Target.java:411)
        at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)
        at org.apache.tools.ant.Project.executeTarget(Project.java:1368)
        at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)
        at org.apache.tools.ant.Project.executeTargets(Project.java:1251)
        at org.apache.tools.ant.Main.runBuild(Main.java:809)
        at org.apache.tools.ant.Main.startAnt(Main.java:217)
        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:280)
        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:109)
Caused by: java.io.IOException: CreateProcess error=2, The system cannot find the file specified
        at java.lang.ProcessImpl.create(Native Method)
        at java.lang.ProcessImpl.<init>(ProcessImpl.java:81)
        at java.lang.ProcessImpl.start(ProcessImpl.java:30)
        at java.lang.ProcessBuilder.start(ProcessBuilder.java:452)
        ... 185 more 
```

少了什么东西？

谢谢

--

SJunejo

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T09:52:45.900

我在以下链接的帮助下找到了解决方案；

[http://axis.apache.org/axis2/java/core/tools/CodegenToolReference.html](http://axis.apache.org/axis2/java/core/tools/CodegenToolReference.html)

请参阅“**从 Ant 调用代码生成器**”部分。

上面的任务定义了 wsdl2java。我提供 java2wsdl 可能对 sfor 未来参考有用；

```
<target name="java-to-wsdl" unless="wsdl.generated" description="This target will generate actual WSDL file for each WS class provided" >
    <!-- Prepare classpath -->
    <path id="axis2.classpath">
        <!-- Add Axis2 Libraries -->
        <fileset dir="${axis2.lib.dir}" includes="**/*.jar" />
        <!-- Java WS Build Directory -->
        <dirset dir="${build.ws.java.dir}" />
        <!-- Full compile classpath for data and rest of other classes -->
        <path refid="compile.classpath" />
    </path>
    <!-- Convert java ws class path into a fully qualified name i.e. com.temenos.webservices.[service_name].[service_wsClassName] -->
    <path id="java.ws.class" >
        <fileset file="${wsClassfile}" />
    </path>
    <pathconvert property="trimmed.wsClass" refid="java.ws.class" >
        <packagemapper from="${build.ws.java.dir}${file.separator}*.class" to="*"/>
    </pathconvert>
    <if>
        <not>
            <equals arg1="${trimmed.wsClass}" arg2="" />
        </not>
        <then>
            <property name="axis2.home" value="${axis2.bin.dir}" />
            <java classname="org.apache.ws.java2wsdl.Java2WSDL" fork="yes" failonerror="true" >
                <classpath refid="axis2.classpath"/>
                <arg value="-o"/>
                <arg value="${build.ws.java.dir}${file.separator}wsdl"/>
                <arg value="-cn"/>
                <arg value="${trimmed.wsClass}"/>
            </java>
        </then>
    </if>
    <property name="wsdl.generated" value="true" />
</target> 
```

**注意：关于原始问题，即在 ANT 中执行 .bat 或 .sh 是不允许的，因为仅适用于可执行文件。如果您必须使用这些脚本，请使用 ant-contrib 任务。**

谢谢

--

斯茹内霍

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T14:11:17.793

我可以看到很多代码，但我没有看到实际的 ant-task 被调用。我的解决方案包含如下代码：

定义：

```
<taskdef name="axis2-wsdl2java" classname="org.apache.axis2.tool.ant.AntCodegenTask">
<classpath>
    <fileset dir="some axis2 lib folder/axis2-1.4.1/lib" includes="*.jar" />
</classpath> 
```

用法：

```
<target name="main" description="Generate" depends="init">
<echo message="Uri is ${uri}" />
<echo message="Generation output-folder set to ${output_folder}" />
<delete dir="${output_folder}" />
<mkdir dir="${output_folder}" />

<axis2-wsdl2java wsdlfilename="${uri}" output="${output_folder}" />
<ant dir="${output_folder}" />
<runtarget target="determine_jarname" />
<echo message="in main jar_filename set to ${jar_filename}" />
<jar destfile="${jar_output_folder}/${jar_filename}.jar"
       basedir="${output_folder}/build/classes" /> 
```

所以对 wsdl2java 的实际调用是一行

```
<axis2-wsdl2java wsdlfilename="${uri}" output="${output_folder}" /> 
```

另一件事是设置属性 ${env.AXIS2_HOME} 以及

# c++ - 如何获取特定域用户的访问令牌？

> ID：10962058
> 
> 赞同：0
> 
> 时间：2012-06-09T15:06:26.053
> 
> 标签：c++, active-directory, dns, access-token

我是 Active Directory 域管理员，如何获取特定域用户的访问令牌？我想使用这个用户的访问令牌从只对他开放的共享文件夹中获取一些数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T15:55:32.293

**如果用户已登录并且您想使用他的令牌模拟他，那么过程是：**

1.  用于`WTSEnumerateSessions`在循环中列出系统的所有活动用户。

2.  `PWTS_SESSION_INFO`如果用户是您想要的，则使用信息进行比较。

3.  如果用户匹配，则使用`WTSQueryUserToken`获取用户的令牌。此 Api 需要会话 ID，您将从`PWTS_SESSION_INFO`第 1 步中调用的 struct 中获得该会话 ID`WTSEnumerateSessions`

4.  使用 DuplicateTokenEx 复制令牌，然后使用 ImpersonateLoggedOnUser 模拟该用户。

5.  复制文件等完成工作

6.  回归自我。

[示例点击这里](http://www.cplusplus.com/forum/articles/11167/)

**如果用户未登录并且您想使用他的凭据模拟并完成工作，则：**

1.  使用`LogonUser`API 获取令牌并从上述选项的第 4 步开始。

# haskell - 如何让 Show 显示函数的名称？

> ID：10962069
> 
> 赞同：4
> 
> 时间：2012-06-09T15:07:48.237
> 
> 标签：haskell

作为一个让我熟悉 Haskell 的简单练习，在 Youtube 上闲逛并偶然发现 American Countdown 游戏节目之后，我想为 Numbers 游戏制作一个求解器。

你得到 6 个数字，需要将它们组合起来`(+) (-) (*) (/)`才能得到给定的结果。

![在此处输入图像描述](../Images/4f04b571902b90e242cc9187c6233da8.png)

到目前为止我得到的是非常脑死亡的，

```
let operands = [75, 2, 6, 3, 8, 7] :: [Double]
let goal = 623 :: Double
let operations = [(+), (-), (*), (/)]

show (head [(a, x, b, y, c, z, d, t, e) |
      a <- operands,
      b <- filter (\ q -> q /= a) operands,
      c <- filter (\ q -> q /= a && q /= b) operands,
      d <- filter (\ q -> q /= a && q /= b && q /= c) operands,
      e <- filter (\ q -> q /= a && q /= b && q /= c && q /= d) operands,
      x <- operations,
      y <- operations,
      z <- operations,
      t <- operations,
      t (z (y (x a b) c) d) e == goal]) 
```

...但显然 Show 不知道如何处理函数。

```
No instance for (Show (Double -> Double -> Double))
  arising from a use of `show'
Possible fix:
  add an instance declaration for (Show (Double -> Double -> Double)) 
```

我该如何解决这个问题？我是否需要弄乱类型和数据构造函数来制作我自己的可以打印的函数，还是有一些更简单的方法来解决它？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-09T15:25:53.187

另外一个选项：

```
data Operation = Add | Subtract | Multiply | Divide deriving (Show)

apply :: Operation -> Double -> Double -> Double
apply Add      = (+)
apply Subtract = (-)
apply Multiply = (*)
apply Divide   = (/) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-09T15:21:08.790

我通常不建议您`Show`为函数实现实例。这不是“草率”的做事方式，原因如下：

您定义了显示函数的“规范”方式。您可能希望他们现在显示为他们的名字，但如果您决定这样做：

```
add 0 y = y
add x y = add (x - 1) (y + 1)

operations = [..., add, ...] 
```

你的程序的输出真的应该根据你的内部实现而改变吗？这没有多大意义。另外，无名函数会发生什么？

此外，在程序的另一部分，您可能希望将您的函数显示为它们的类型，等等，然后您会有冲突的`Show`实例。

通常，只有`Show`在您知道应该只有一种显示该事物的方式时才实施，并且该方式适用于所有需要显示的值。

* * *

解决此问题的最简单方法可能是将操作的名称与操作一起存储。像这样：

```
let operations = [("+", (+)), ("-", (-)), ("*", (*)), ("/", (/))]

-- ...
show (head [(a, xname, b, yname, c, zname, d, tname, e) |
  a <- operands,
  b <- filter (\ q -> q /= a) operands,
  c <- filter (\ q -> q /= a && q /= b) operands,
  d <- filter (\ q -> q /= a && q /= b && q /= c) operands,
  e <- filter (\ q -> q /= a && q /= b && q /= c && q /= d) operands,
  (xname, x) <- operations,
  (yname, y) <- operations,
  (zname, z) <- operations,
  (tname, t) <- operations,
  t (z (y (x a b) c) d) e == goal]) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T15:20:47.363

您不能在 Haskell 中打印函数的名称（元编程可能有一些疯狂的技巧，但实际上您不能）。对于您的程序，将操作列表定义为带有每个操作符名称的字符串的对列表可能是最简单的，例如

```
let operations = [((+)," + "), ((-), " - ")), ((*), " * ")), ((/), " / ")] 
```

您可以通过做`map fst operations`和`map snd operations`获取它们的名称来获取仅操作的列表。

# java - 使用 getHardwareAddress 非确定性在 Java 中获取 mac 地址

> ID：10962072
> 
> 赞同：8
> 
> 时间：2012-06-09T15:07:58.393
> 
> 标签：java, mac-address

我在获取机器的 mac 地址时遇到问题，在[这个问题](https://stackoverflow.com/questions/6164167/get-mac-address-on-local-machine-with-java)中使用以下代码解决了这个问题：

```
Process p = Runtime.getRuntime().exec("getmac /fo csv /nh"); 
java.io.BufferedReader in = new java.io.BufferedReader(new  java.io.InputStreamReader(p.getInputStream())); 
String line; 
line = in.readLine();         
String[] result = line.split(","); 

System.out.println(result[0].replace('"', ' ').trim()); 
```

但是，我想知道为什么这段代码不起作用。每次读取 MAC 地址时，它都会返回不同的值。首先我认为这是因为 getHash，也许使用了我不知道的时间戳......但即使删除它，结果也会改变。

代码

```
 public static byte[] getMacAddress() {
        try {
            Enumeration<NetworkInterface> nwInterface = NetworkInterface.getNetworkInterfaces();
            while (nwInterface.hasMoreElements()) {
                NetworkInterface nis = nwInterface.nextElement();
                if (nis != null) {
                    byte[] mac = nis.getHardwareAddress();
                    if (mac != null) {
                        /*
                         * Extract each array of mac address and generate a
                         * hashCode for it
                         */
                        return mac;//.hashCode();
                    } else {
                        Logger.getLogger(Utils.class.getName()).log(Level.WARNING, "Address doesn't exist or is not accessible");
                    }
                } else {
                    Logger.getLogger(Utils.class.getName()).log(Level.WARNING, "Network Interface for the specified address is not found.");
                }
                return null;
            }
        } catch (SocketException ex) {
            Logger.getLogger(Utils.class.getName()).log(Level.SEVERE, null, ex);
        }
        return null;
    }
} 
```

输出示例（我直接从字节数组打印，但足以看出我认为的不同）

```
[B@91cee
[B@95c083
[B@99681b
[B@a61164
[B@af8358
[B@b61fd1
[B@bb7465
[B@bfc8e0
[B@c2ff5
[B@c8f6f8
[B@d251a3
[B@d6c16c
[B@e2dae9
[B@ef5502
[B@f7f540
[B@f99ff5
[B@fec107 
```

提前致谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-09T15:13:15.360

`B@91cee`实际上是数组的结果`toString()`方法。`byte[]`

我建议您`new String(mac)`改为使用打印值。

`byte[].toString()`实现为：

```
public String toString() {
    return getClass().getName() + "@" + Integer.toHexString(hashCode());
} 
```

由于默认是作为内存中的地址实现的，因此每次`Object.hashCode()`都创建新的时它并不一致。`Object`

**编辑：**

由于返回的字节是十六进制的，所以你应该把它转换成十进制字符串。代码可以从[这里看到](https://stackoverflow.com/a/10962221/1285418)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-09T15:27:43.930

以下是[Mkyong.com](http://www.mkyong.com/java/how-to-get-mac-address-in-java/)网站上有关如何在 Java 中获取 MAC 地址的示例：

```
package com.mkyong;

import java.net.InetAddress;
import java.net.NetworkInterface;
import java.net.SocketException;
import java.net.UnknownHostException;

public class app{

   public static void main(String[] args){

    InetAddress ip;
    try {

        ip = InetAddress.getLocalHost();
        System.out.println("Current IP address : " + ip.getHostAddress());

        NetworkInterface network = NetworkInterface.getByInetAddress(ip);

        byte[] mac = network.getHardwareAddress();

        System.out.print("Current MAC address : ");

        StringBuilder sb = new StringBuilder();
        for (int i = 0; i < mac.length; i++) {
            sb.append(String.format("%02X%s", mac[i], (i < mac.length - 1) ? "-" : ""));        
        }
        System.out.println(sb.toString());

    } catch (UnknownHostException e) {

        e.printStackTrace();

    } catch (SocketException e){

        e.printStackTrace();

    }

   }

} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-11-13T22:37:24.573

如果机器未连接，西班牙人的答案将不起作用，并且它会根据您连接的网络给出不同的值。

这个不依赖于任何 IP 地址：

```
public class MacAdress {
    public static void main(String[] args) {
        try {
            InetAddress ip = InetAddress.getLocalHost();
            System.out.println("Current IP address : " + ip.getHostAddress());

            Enumeration<NetworkInterface> networks =
                             NetworkInterface.getNetworkInterfaces();
            while(networks.hasMoreElements()) {
                NetworkInterface network = networks.nextElement();
                byte[] mac = network.getHardwareAddress();

                if (mac != null) {
                    System.out.print("Current MAC address : ");

                    StringBuilder sb = new StringBuilder();
                    for (int i = 0; i < mac.length; i++) {
                        sb.append(String.format("%02X%s", mac[i],
                                     (i < mac.length - 1) ? "-" : ""));
                    }
                }
            }
        } catch (UnknownHostException e) {
            e.printStackTrace();
        } catch (SocketException e){
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-05-12T07:10:15.047

```
public static String getHardwareAddress() throws Exception {
    InetAddress ip = InetAddress.getLocalHost();
    NetworkInterface ni = NetworkInterface.getByInetAddress(ip);
    if (!ni.isVirtual() && !ni.isLoopback() && !ni.isPointToPoint() && ni.isUp()) {
        final byte[] bb = ni.getHardwareAddress();
        return IntStream.generate(ByteBuffer.wrap(bb)::get).limit(bb.length)
                .mapToObj(b -> String.format("%02X", (byte)b))
                .collect(Collectors.joining("-"));
    }
    return null;
} 
```

# c# - 从应用程序日志生成 pcap 文件的库

> ID：10962073
> 
> 赞同：0
> 
> 时间：2012-06-09T15:08:06.973
> 
> 标签：c#, pcap

我自己一直在从应用程序日志文件中查看生成 pcap 文件。（我认为 Wireshark 将是分析网络流量如何在系统中反弹的好工具。）

然而，相信简单的任务似乎很难。我有网络数据（在我的例子中是 SIP 数据）。然后我应该用 IP+UDP 标头和[pcap-headers](http://wiki.wireshark.org/Development/LibpcapFileFormat)包装这些数据。这似乎很容易，但不知何故我失败了。当我在 Wireshark 中打开 pcap 时，所有标题都只是糊状。

如果我放弃，是否有一个库可以用来编写 pcap 文件？
（我发现的所有库似乎都专注于从设备到文件的字幕。我这里没有设备......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T18:10:36.967

有一个名为[SharpPcap](http://sourceforge.net/apps/mediawiki/sharppcap/index.php?title=Main_Page)的托管库，它是 libpcap 的包装器，用于与 pcap 文件交互。使用该库，您应该能够同时读取和“捕获”数据包。感兴趣的类/函数将是 [CaptureFileWriterDevice](http://sharppcap.sourceforge.net/htmldocs/SharpPcap.LibPcap/CaptureFileWriterDevice.html)并为您要记录的每个数据包执行[SendPacket](http://sharppcap.sourceforge.net/htmldocs/SharpPcap.LibPcap/PcapDevice.html#M%3aSharpPcap.LibPcap.PcapDevice.SendPacket%28System.Byte%5b%5d,System.Int32%29)或[写入操作。](http://sharppcap.sourceforge.net/htmldocs/SharpPcap.LibPcap/CaptureFileWriterDevice.html#M%3aSharpPcap.LibPcap.CaptureFileWriterDevice.Write%28SharpPcap.RawCapture%29)

# c# - 代码合同 - 没有正确警告只读成员？

> ID：10962074
> 
> 赞同：3
> 
> 时间：2012-06-09T15:08:07.940
> 
> 标签：c#, code-contracts

鉴于此类，我不确定为什么会收到 Ensure unproven Result != null 警告。

```
public class MyClass {
  private readonly string _value;

  public MyClass(string value) {
    Contract.Requires(value != null);  
    _value = value;
  }

  public string Value {
    get {
      Contract.Ensures(Contract.Result<string>() != null);
      return _value;
    }
  }
} 
```

我可以通过添加 _value != null 的不变量来消除警告，但感觉我不应该这样做。这只是分析的限制吗？

**编辑**：为问题添加更多内容，因为我认为我的问题的重点被遗漏了。

```
public class Test {
    private string _value = "";

    public string Value {
        get {
            Contract.Ensures(Contract.Result<string>() != null);
            return _value;
        }
        set {
            Contract.Requires<ArgumentNullException>(value != null);
            _value = value;
        }
    }
} 
```

CC 分析似乎对这个类非常满意；在ctor中分配了一个非空值，因此证明`Requires`了要更改的setter非空值。`_value``Ensures`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T15:40:47.597

您的构造函数不承诺 `_value`将是非空的。它设置`_value`为`value`，它是非空的，但这是一个实现细节，而不是合同的一部分。即使它是合同的一部分，也不够，因为当您添加另一个不做出相同承诺的构造函数时，所有前置条件和后置条件都应该保持同样有效。

您应该添加不变量 that `_value != null`。为什么感觉你不应该这样做？

*编辑*：作为替代方案，您可以尝试添加一个不变量`Value != null`（这在 之外也很有用`MyClass`），并使`Value`' 的属性获取器确保`Contract.Result<string>() == _value`（仅证明不变量），但我不确定这会起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-07T05:46:44.433

在提出问题时不确定该选项是否可用，但我今天遇到了类似的问题，发现通过打开代码合同选项“Infer Invariants for readonly”，警告消失了。

# python - 龙卷风中可以并发吗？

> ID：10962076
> 
> 赞同：11
> 
> 时间：2012-06-09T15:08:26.233
> 
> 标签：python, concurrency, wsgi, tornado

我知道龙卷风是一个单线程和非阻塞服务器，因此请求是按顺序处理的（除非使用事件驱动的方法进行 IO 操作）。

有没有办法在龙卷风中并行处理多个请求以进行正常（非 IO）执行。我不能分叉多个进程，因为我需要一个跨请求的公共内存空间。

如果不可能，请向我推荐其他可以处理并行请求并支持 wsgi 的 python 服务器。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-09T15:11:31.397

如果您真的要处理多个同时受计算限制的请求，并且您想在 Python 中完成，那么您需要一个多进程服务器，而不是多线程服务器。CPython 具有全局解释器锁 (GIL)，可防止多个线程同时执行 python 字节码。

大多数 Web 应用程序只做很少的计算，而是等待来自数据库、磁盘或其他服务器上的服务的 I/O。确保在丢弃 Tornado 之前需要处理计算绑定请求。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-09T16:43:31.583

您的问题的答案实际上取决于这些计算绑定线程将运行多长时间。如果它们运行时间很短，并且处理它们的速度至少与它们到达的速度相匹配，那么 Tornado 就可以了。它是真正的单线程，但它的扩展性非常好。

如果您的计算绑定请求长时间运行，那么使用线程服务器不一定有帮助，因为正如 Ned Batchelder 已经指出的那样，GIL 将成为一个瓶颈。

如果您能够放宽在所有请求中具有相同内存空间的限制，那么您可以考虑使用[PyZMQ](http://zeromq.github.com/pyzmq/)运行 Tornado ，因为它提供了一种运行多个 Tornado 后端的方法，前端由单个 Tornado 实例。这使您可以继续将 Tornado 用于整个解决方案。有关更多信息，请参阅 PyZMQ 的[web.zmqweb](https://github.com/ellisonbg/zmqweb)模块。

# php - 使用过滤器选择的不同组合时搜索 mysql 数据库

> ID：10962078
> 
> 赞同：0
> 
> 时间：2012-06-09T15:08:40.493
> 
> 标签：php, mysql, forms, search

当使用过滤器选择的不同组合时，我正在尝试搜索 mysql 数据库。

选择您搜索的产品应具有的可用性的示例代码是：

```
<select multiple="multiple" id="avail" class="avail" name="avail">
    <option selected="selected" value="0">All</option>
    <option value="1">Stock</option>
    <option value="3">Test</option>
    <option value="4">Special order</option>
</select> 
```

如果选择了“全部”选项，我不会将其包含在 mysql 查询中，但是当我想搜索“测试”和“特殊订单”而不是“库存”的产品时，我该怎么办然后？

我相信查询会是这样的：

```
SELECT * FROM products WHERE availability IN (an array) 
```

但我不知道如何从选定的值中创建一个数组。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T15:52:55.157

我正在使用手机应用程序，我不能给你一个完整的例子，但是使用 php 函数 implode 将数组转换为字符串并使用你的查询，如果你不能解决让我知道，我会写你和.example 当我回家

# asp.net - 脚本下载完成后放置 ajax 响应

> ID：10962083
> 
> 赞同：1
> 
> 时间：2012-06-09T15:09:21.790
> 
> 标签：asp.net, ajax

我有一个简单的网站，它使用 ajax 获取 html 并将其放在某个 div (AjaxPlaceHolder) 中。

例如这里是我的网页：

```
<html>

    <body>
           // some html...

           <div id="AjaxPlaceHolder"></div>

    </body>

    <div id="footer"></div>

</html> 
```

现在我的问题是，当我使用 ajax 获取 html 时，我得到如下信息：

```
<script type="text/javascript" src="js/someJsFile.js"></script>
<table>html content</table>
// more html 
```

注意这一行：

```
<script type="text/javascript" src="js/someJsFile.js"></script> 
```

在浏览器下载该文件（someJsFile.js）之前，我不想放置 html 内容。我怎么能知道浏览器何时下载该脚本？我知道我可以将 someJsFile.js 内容放在那里并将其包裹在`<script type="text/javascript">`标签周围，但如果我可以将 .js 文件分开，那就太好了。

## 编辑：

**换句话说，这就是我想做的事情：**

使用ajax获取html。不要渲染 html（同时将它放在隐藏的 div 中）直到文档完成下载必要的图像和脚本

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T17:25:58.130

您可以将 javascript 文件加载与 html ajax 加载的其余部分分开。

如果你分开它，你可以同步加载外部脚本，这样你就可以确保它们首先加载。

在简单的 javascript 中，您在打开时设置同步标志。

```
function getFile(url, passData) {
  if (window.XMLHttpRequest) {              
    AJAX=new XMLHttpRequest();              
  } else {                                  
    AJAX=new ActiveXObject("Microsoft.XMLHTTP");
  }
  if (AJAX) {
    AJAX.open("POST", url, false);
    AJAX.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    AJAX.send(passData);
    return AJAX.responseText;                                         
  } else {
     return false;
  }                                             
}

var fileFromServer = getFile('http://domain.com/scr.js', sendThisDataAsAPost); 
```

在 jQuery 中

```
jQuery.ajax({
        type: "GET",
        url: url,
         async : false,
        success: callback,
        dataType: "script",
        cache: true
}); 
```

关于同步调用：[http ://www.hunlock.com/blogs/Snippets:_Synchronous_AJAX](http://www.hunlock.com/blogs/Snippets:_Synchronous_AJAX)

jQuery 调用：[http ://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# lua - Lua 字符串转 int

> ID：10962085
> 
> 赞同：223
> 
> 时间：2012-06-09T15:09:26.470
> 
> 标签：lua

如何在 Lua 中将字符串转换为整数？

我有一个这样的字符串：

```
a = "10" 
```

我希望将其转换为数字 10。

* * *

## 回答 #1

> 赞同：350
> 
> 时间：2012-06-09T15:14:21.617

使用[`tonumber`功能](http://www.lua.org/manual/5.1/manual.html#pdf-tonumber)。如`a = tonumber("10")`.

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2012-06-09T18:52:16.900

您可以通过在算术运算中使用字符串来强制进行隐式转换`a= "10" + 0`，但这并不像使用`tonumber`显式那样清晰或干净。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-03-26T16:34:00.510

```
local a = "10"
print(type(a))
local num = tonumber(a)
print(type(num)) 
```

**Output**

```
 string                                                                                                                                                                          
   number 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-08-28T15:08:53.543

Lua 中的所有数字都是浮点数（**编辑：** Lua 5.2 或更低版本）。如果您真的想转换为“int”（或至少复制此行为），您可以这样做：

```
local function ToInteger(number)
    return math.floor(tonumber(number) or error("Could not cast '" .. tostring(number) .. "' to number.'"))
end 
```

在这种情况下，您将字符串（或实际上，无论它是什么）显式转换为数字，然后像 (int) 强制转换在 Java 中所做的那样截断该数字。

**编辑：**这在 Lua 5.3 中仍然有效，即使 Lua 5.3 有真正的整数，因为它`math.floor()`返回一个整数，而像这样的运算符`number // 1`如果是浮点数，仍然会返回一个`number`浮点数。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-03-12T16:36:26.093

say the string you want to turn into a number is in the variable `S`

```
a=tonumber(S) 
```

provided that there are numbers and only numbers in `S` it will return a number, but if there are any characters that are not numbers (except periods for floats) it will return nil

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-07-17T18:05:56.640

应该注意的是，`math.floor()`总是向下舍入，因此对于负浮点值不会产生合理的结果。

例如，表示为整数的 -10.4 通常会被截断或四舍五入为 -10。然而 math.floor() 的结果并不相同：

```
math.floor(-10.4) => -11 
```

对于类型转换的截断，以下辅助函数将起作用：

```
function tointeger( x )
    num = tonumber( x )
    return num < 0 and math.ceil( num ) or math.floor( num )
end 
```

参考： http: [//lua.2524044.n2.nabble.com/5-3-Converting-a-floating-point-number-to-integer-td7664081.html](http://lua.2524044.n2.nabble.com/5-3-Converting-a-floating-point-number-to-integer-td7664081.html)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-04-29T18:13:48.167

更清晰的选择是使用**tonumber**。

从 5.3.2 开始，此函数将自动检测（有符号）整数、浮点数（如果存在点）和十六进制（整数和浮点数，如果字符串以“0x”或“0X”开头）。

以下片段较短但不等效：

*   ```
    a + 0 -- forces the conversion into float, due to how + works. 
    ```

*   ```
    a | 0 -- (| is the bitwise or) forces the conversion into integer. 
    -- However, unlike `math.tointeger`, it errors if it fails. 
    ```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2019-07-03T10:07:26.010

[`tonumber (e [, base])`](https://www.lua.org/manual/5.3/manual.html#pdf-tonumber)

`tonumber` takes two arguments, first is string which is converted to number and second is base of `e`.

Return value `tonumber` is in base 10.

If no `base` is provided it converts number to base 10.

```
> a = '101'
> tonumber(a)
101 
```

If base is provided, it converts it to the given base.

```
> a = '101'
> 
> tonumber(a, 2)
5
> tonumber(a, 8)
65
> tonumber(a, 10)
101
> tonumber(a, 16)
257
> 
```

If `e` contains invalid character then it returns `nil`.

```
> --[[ Failed because base 2 numbers consist (0 and 1) --]]
> a = '112'
> tonumber(a, 2)
nil
> 
> --[[ similar to above one, this failed because --]]
> --[[ base 8 consist (0 - 7) --]]
> --[[ base 10 consist (0 - 9) --]]
> a = 'AB'
> tonumber(a, 8)
nil
> tonumber(a, 10)
nil
> tonumber(a, 16)
171 
```

I answered considering Lua5.3

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-11-28T16:19:20.677

我建议检查 Hyperpolyglot，有一个很棒的比较：[http ://hyperpolyglot.org/](http://hyperpolyglot.org/)

[http://hyperpolyglot.org/more#str-to-num-note](http://hyperpolyglot.org/more#str-to-num-note)

附言。实际上 Lua 转换成双精度数而不是整数。

> number 类型表示实数（双精度浮点数）。

[http://www.lua.org/pil/2.3.html](http://www.lua.org/pil/2.3.html)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-07-12T09:19:31.693

您可以制作一个访问器以将“10”保留为 int 10。

例子：

```
x = tonumber("10") 
```

如果您打印 x 变量，它将输出一个 int 10 而不是 "10"

和 Python 进程一样

x = int("10")

谢谢。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-02-03T06:00:40.107

从 lua 5.3 开始，有一个`math.tointeger`字符串到整数的新函数。仅用于整数，没有浮点数。

例如：

```
print(math.tointeger("10.1")) -- nil
print(math.tointeger("10")) -- 10 
```

如果要转换整数和浮点数，该`tonumber`函数更合适。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-08-24T18:06:23.317

您可以使用该`tonumber`功能，就像您如何使用该`tostring`功能一样，以下是如何使用它：

```
local x = tonumber("45")
print(x) 
```

结果应该是`45`。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-07-01T14:49:26.070

```
Lua 5.3.1  Copyright (C) 1994-2015 Lua.org, PUC-Rio
> math.floor("10");
10
> tonumber("10");
10
> "10" + 0;
10.0
> "10" | 0;
10 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-09-21T05:35:45.240

Lua 数字类型是**双精度类型**，在**luaconf 中实现。h** detail 一般有两种选择：

1.  **【推荐使用】****5.3版本**的Lua脚本包含global.lua文件，里面包含了`tonumber()`and`tostring()`方法，可以实现数字和字符串的转换。
2.  `math.tointeger()`也可以用这种方法转换成数字。

不过根据你的**实际场景**，如果只是为了计算，Lua可以根据这个操作符号进行转换。例如

```
 s = "1" + 2; -- lua will convert "1" to 1
  print(s)

  s1 = "e" + 3; -- error
  print(s1) 
```

更多关于lua，可以看[lua官方文档](https://www.lua.org/docs.html)

希望对您有用，期待您的回复，期待与您的进一步沟通！

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-12-16T22:41:41.537

这是你应该放的

```
local stringnumber = "10"
local a = tonumber(stringnumber)
print(a + 10)

output:

20 
```

# java - 没有任何顺序的一堆选择的正则表达式

> ID：10962086
> 
> 赞同：4
> 
> 时间：2012-06-09T15:09:56.123
> 
> 标签：java, regex

我正在尝试创建一个 JAVA 正则表达式来测试是否设置了特定选项。目前我有`[ks]?[zx]?[ap]?`所以它要么是 k、s 或什么都没有，然后是 z、x 或什么都没有，最后是 a、p 或什么都没有。

这个正则表达式的唯一问题是它只适用于这个订单，但它应该适用于所有订单，因为`kza`, `azk`, `zka`, `kaz`,`akz`和`zak`做同样的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T17:03:44.143

锻炼自己——这个答案强化了正则表达式作为一种只写语言！

```
^(([ks](?!.*[ks]))|([zx](?!.*[zx]))|([ap](?!.*[ap]))){0,3}$ 
```

如果您将 Groovy（或 Java 7）用于多行字符串，则可以更清楚地写成这样：

```
^(?x:
    (  (  [ks]  (?!.*[ks])  )
    |  (  [zx]  (?!.*[zx])  )
    |  (  [ap]  (?!.*[ap])  )
    )  {0,3}
)$ 
```

此版本匹配每个组，仅当该组稍后未出现在字符串中的某个位置时。这是一个“零宽度，前瞻断言”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T15:14:45.577

如果我理解了，请替换“？” 通过“管道”：尝试：`"[ks]|[zx]|[ap]"`

# php - 您真的需要在每次页面加载时自动加载基于类的网站的所有页面吗？

> ID：10962090
> 
> 赞同：1
> 
> 时间：2012-06-09T15:10:11.980
> 
> 标签：php, class, include, autoload

我继承了一个基于类的 PHP 站点，该站点的每个页面都是它自己的类。`index.php`处理您根据参数查看的页面，`p`然后调用该特定类。例如，网站的搜索页面很简单`mysite.com/?p=search`

`index.php`调用的第一行之一是一个`Autoload.php`文件，该文件执行站点`include`的**每个**基于类的页面。这意味着无论您在哪个页面上，脚本都会加载其他**每个**页面/类。

我的问题：

1.  这些页面/类之间没有联系，所以真的**有****必要**在每次页面加载时都加载它们吗？
2.  它是否会**减慢**每个页面加载时必须超过 50 个页面/类的脚本，`include`还是可以**忽略不计**？
3.  如果是这样，那么我不应该进行**基于 if 的检查**来确定我应该根据`p`参数加载哪个页面/类，并且只加载那个页面/类，而不是在每个页面加载时加载每个页面吗？
4.  或者是否还有其他一些我不知道的**潜在缺点？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T15:50:09.387

这是一个令人困惑的文件名称，因为自动加载是 PHP 中的一种机制，它允许您在需要时加载类，当您有很多类并且每次执行只需要少数类时，这是一个很好的解决方案。

例如：

```
function autoload($class_name) {
  $file = "classes/$class_name.php";

  // You could add some checks here (e.g. whether the file exists, whether the
  // class indeed exists after the file is loaded) to facilitate better errors,
  // of course this would marginally increase the time needed to load each class.

  require $file;
}

// Register the `autoload` function with PHP's autoload mechanism
spl_autoload_register('autoload');

// This will execute `autoload('Class')` (unless `Class` is already defined)
$instance = new Class; 
```

所以，回答你的问题：

1.  没有必要全部加载它们，但是使用的类必须是可用的，或者通过一起加载它们（当前情况）、有条件地加载它们（`if(p == 'whatever') require 'classes/whatever.php'`），或者通过使用自动加载。

2.  每当包含文件时都会有一些延迟，因为必须解析/执行该文件。PHP 相当快，但包含不需要的文件仍然是一种浪费。如果您使用字节码缓存，则仍必须执行检索到的字节码。

3.  这是改进的一种途径，自动加载提供了一种更动态的选择。

4.  如果您的任何页面类依赖于另一个类，则依赖关系可能会成为问题，因为您的条件加载可能会变得非常臃肿。

如果您正在使用它，还有一些关于字节码缓存的附加材料：

*   [PHP5 框架：自动加载和操作码缓存](https://stackoverflow.com/questions/1941541/php5-frameworks-autoloading-and-opcode-caching)
*   [PHP 操作码缓存是否与 __autoload 一起使用？](https://stackoverflow.com/questions/1396501/do-php-opcode-cache-work-with-autoload)

总结似乎是，只要您使用`include`或`require`加载文件，字节码缓存就会按预期工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T15:25:13.047

使用条件 require 或 include 很慢。

只需要你提到的主文件中的所有类，没有任何条件，就在全局范围内。编译后的代码将被缓存为一个，您不会因在运行时加载额外的代码而受到惩罚。

编辑：您将受益于启用 PHP APC 或其他一些 PHP 加速器。

编辑 2：PHP APC 将在未来版本中成为 PHP 核心的一部分（已宣布）。无论您是使用条件加载还是一次性加载，您都将从 PHP APC 中受益。如果您已经拥有它，一次为您的 50 页加载可能会很好。

**编辑 3**：[下载 PHP APC 源代码](http://pecl.php.net/package/APC)并找到一个名为 apc.php 的查找文件。从您的服务器运行 apc.php 以查看一些非常出色的 APC 状态和统计信息，其中包括当前内存使用情况和最大内存（另见[此处](http://www.php.net/manual/en/apc.configuration.php#ini.apc.shm-size)）。

# c# - asp:图像宽度属性

> ID：10962091
> 
> 赞同：0
> 
> 时间：2012-06-09T15:10:14.610
> 
> 标签：c#, asp.net, image

我正在尝试获取 asp:Image 的像素宽度。图片不是本地的。

```
imgUserThumb.Width.Value 
```

总是以 0.0 的形式返回，有人知道为什么吗？或者也许那不是正确的方法？此外，图像使用“onerror”属性来检查传递给它的图像 URL 是否有效，如果不是，则显示默认缩略图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T15:21:04.250

如果您没有为图像标签设置宽度和高度，您将得到 0。

如果您需要获取图像的实际大小，请将其加载到位图并从那里获取宽度。

```
Image img = new Bitmap("Mytest.png");
var imgwidth = img.Width; 
```

## 从 URL 编辑

```
private  int GetImageWidth(string url)
{
    int width = 0;
    using (WebClient client = new WebClient())
    {
        client.Credentials = new NetworkCredential("name", "pw");
        byte[] imageBytes = client.DownloadData(url);
        using (MemoryStream stream = new MemoryStream(imageBytes))
        {
            var img = Image.FromStream(stream);
            width=  img.Width;
        }
    }
    return width;
} 
```

# code-generation - Python 2.x 可以将解释器中的全局变量保存到文件中吗？

> ID：10962092
> 
> 赞同：0
> 
> 时间：2012-06-09T15:10:21.387
> 
> 标签：code-generation, interpreter, python

将诸如具有当前值和名称的绑定变量、已输入定义函数的代码、开头的导入等内容写入 .py 文件？（在**win32**上，只是因为缺少内置的 readline）。

**编辑**只是标准安装/包，没有 iPython 之类的东西。:)

我可以让 python 在干净的出口上保存**历史文件**，但我很感兴趣是否有任何方法可以让解释器转储它已经拥有的一些代码。以人类可读的格式。

如果它与我输入的不完全相同而功能和可见名称相同，那根本不是问题。

**原因**只是好奇。

* * *

无用的理由：当你在一个未知的终端上匆忙帮助一个朋友，而他正在学习语言时，它会派上用场，只是意识到没有方便的方法来保存工作，同时将它放入一个文件并运行它可以说，这会让这位同志更难喘口气。我知道有诸如[playerpiano 之](https://code.google.com/p/playerpiano/)类的东西，但你看，它是一个随机终端，你没有管理员权限，也没有互联网。:) 顺便说一句，在学校发生了好几次。请注意，主要原因是好奇。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T15:13:52.347

一些 Python shell 让您有机会保存您的工作。例如，IDLE 将允许您将交互式会话的文本保存到文件中，因此至少您拥有所创建内容的文本。

IPython 提供[IPython Notebook](http://ipython.org/ipython-doc/stable/interactive/htmlnotebook.html)，它可以让您保存交互式会话。

# pdf - 从 BitBucket 以 PDF 格式下载 Wiki 页面

> ID：10962093
> 
> 赞同：8
> 
> 时间：2012-06-09T15:10:30.197
> 
> 标签：pdf, pdf-generation, wiki, bitbucket

如何将 BitBucket 存储库的 Wiki 页面（使用 Creole 的 WikiOhana）保存为 PDF？我阅读了文档，但我认为这是不可能的（至少是直接的）。

万一不可能。您会推荐哪些其他选项将 wiki 作为文档共享？

我正在使用 OS X Lion 和 Windows 7。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-03-04T12:52:06.077

另外的选择：

*   克隆 wiki（bitbucket wiki 上的右上角按钮）。所有 wiki 页面都保存为 md 文件
*   使用一些在线工具将 MD 转换为 PDF（即[https://md2pdf.netlify.com/](https://md2pdf.netlify.com/)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-13T02:41:31.607

一种解决方法是使用 Safari 或 Chrome 打开它，使用开发人员工具删除 wiki 页面的左侧导航面板、页眉、页脚并将其导出为 PDF。

1.  右键单击并选择“检查元素”，然后选择导航/页眉/页脚节点并将其删除。
2.  从浏览器的文件菜单中将当前 HTML 页面导出为 PDF。

# javascript - 通过 JavaScript 或 jQuery 滚动 div 内容

> ID：10962097
> 
> 赞同：-3
> 
> 时间：2012-06-09T15:11:00.413
> 
> 标签：javascript, jquery

我知道我们可以使用 JavaScript 函数`scrollTo`来`scrollBy`滚动浏览器滚动条，但我不想滚动浏览器滚动条。我想滚动 DIV 的内容`overflow: scroll`（意味着当我们将其 CSS 属性设置为滚动时 HTML 提供给 div 的`overflow`滚动条）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T19:30:57.680

您可以使用`scrollTop`and`scrollLeft`属性来滚动您的 DIV 元素，它也适用于 BODY 元素。

[现场 jsFiddle 示例](http://jsfiddle.net/tTW8m/1/)

# javascript - Javascript 计时器性能

> ID：10962098
> 
> 赞同：0
> 
> 时间：2012-06-09T15:11:08.520
> 
> 标签：javascript, timer, timing

我看到有时 javascript 计时器有一点滞后。我想知道您是否认为拥有更多具有不同时间的计时器或只有一个更好。

例如，我需要两个计时器，一个用于时钟秒刷新（每 1000 毫秒），另一个用于来自服务器的一些更新（每 3600 毫秒）。您是否认为我们最好只使用一个计时器（更频繁），例如：

```
if(dateObj.getSeconds()==0){
  //do update each minute
} 
```

也许答案是：它是一样的...... :-)

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T15:20:46.007

拥有两个计时器是一个更好的主意 - 更具可读性且更易于维护。

如果一段代码密集运行几秒钟，浏览器很可能会杀死这样的脚本。所以不要指望滞后会比这几秒钟大。然而，通常这种滞后不应大于几十毫秒。

如果您需要确切知道计时器的安排时间以及延迟是多少，请查看以下简单代码片段：

```
var scheduled = new Date().getTime() + 100;
setTimeout(function() {
  var lag = new Date().getTime() - scheduled;
  //...
}, 100); 
```

`lag`在我的情况下（Firefox）的变量总是在-1（！）和1毫秒之间。

# mongodb - MongoDB - 地理空间查询 - 查询顺序

> ID：10962099
> 
> 赞同：1
> 
> 时间：2012-06-09T15:11:09.273
> 
> 标签：mongodb, geospatial

我对 MongoDB 地理空间索引有一个非常奇怪的问题：

```
> db.events.find({'geo': {'$maxDistance': 5, '$near': [45.21012750000001, 7.1364645]}})
error: {
"$err" : "geo values have to be numbers: { $maxDistance: 5.0, $near: [ 45.21012750000001, 7.1364645 ] }",
"code" : 13026 
```

}

最奇怪的是，以不同顺序编写的相同查询可以完美运行：

```
> db.events.find({'geo': {'$near': [45.21012750000001, 7.1364645], '$maxDistance': 5}}) 
```

两个查询不应该保持相同的结果吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T05:11:06.953

这两个查询的处理方式不同 - 如您所见，顺序很重要。

[在https://jira.mongodb.org/browse/SERVER-1990](https://jira.mongodb.org/browse/SERVER-1990)中有一个要求使两者相同，但它目前不是针对特定版本的。

随意就这个问题投票和/或观看它。

# c# - 使用 C# 开发 Android 应用程序

> ID：10962104
> 
> 赞同：109
> 
> 时间：2012-06-09T15:11:40.743
> 
> 标签：c#, android, mono

是否可以使用 C# 编写 Android 应用程序？有 API 之类的吗？个人和商业开发是否免费？

我需要安装什么才能在我的 Visual Studio 中拥有 android 项目模板？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2013-02-26T00:02:39.053

使用过 Mono，我不会推荐它。Mono 运行时与您的应用程序捆绑在一起，因此您的 apk 最终会膨胀到超过 6MB。C# 更好的编程解决方案是[dot42](http://www.dot42.com/)。Mono 和 dot42 都是许可产品。

就个人而言，我建议在[IntelliJ IDEA](http://www.jetbrains.com/idea/index.html)开发环境中使用 Java。我这么说有3个原因：

1.  已经有很多适用于 Android 的 Java 代码了。帮自己一个忙，不要重新发明轮子。
2.  IDEA 与 Visual Studio 非常相似，可以轻松学习；它由JetBrains制造，智能感知优于VS。
3.  IDEA 是免费的。

我已经做了 12 年的 C# 程序员，并开始使用 C# 为 Android 开发，但最终跳槽并走 Java 路线。这些语言非常相似，您真的不会注意到太多的学习曲线。

PS 如果你想使用 C# 原生的 LINQ、序列化和其他方便的特性，那么你只需要寻找等效的 java 库。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2012-06-09T15:14:28.183

你可以使用`Mono for Android`：

[http://xamarin.com/monoforandroid](http://xamarin.com/monoforandroid)

另一种选择是`dot42`：

[http://www.dot42.com/](http://www.dot42.com/)

dot42 提供免费的社区许可证和专业许可证，价格为 399 美元。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-01-14T14:31:29.767

这是一个新的（注：在技术预览阶段）： http: [//www.dot42.com](http://www.dot42.com)

它基本上是一个 Visual Studio 插件，可让您将 C# 代码直接编译为 DEX 代码。这意味着没有运行时要求，例如 Mono。

披露：我在这家公司工作

* * *

更新：所有来源现在都在[https://github.com/dot42](https://github.com/dot42)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-06-09T15:14:21.107

Mono Touch 就是答案。

[http://xamarin.com/monotouch](http://xamarin.com/monotouch)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-04-03T08:06:38.717

我使用 Unity 3D 游戏引擎为 PC 和手机开发游戏。我们在此开发中使用 C#。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-06-09T15:15:01.343

您应该尝试运行 Mono（它与 .NET 兼容）。

对于游戏开发，我推荐unity：[http ://unity3d.com/](http://unity3d.com/)

一般应用：http: [//xamarin.com/monoforandroid](http://xamarin.com/monoforandroid)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-06-09T15:16:47.847

确实有适用于 Android 的 C# 编译器。尽管我更喜欢用 Java 开发 Android 应用程序，但我还是推荐 MonoForAndroid。[您可以在http://xamarin.com/monoforandroid](http://xamarin.com/monoforandroid)上找到更多信息

# javascript - 弹出窗口关闭后如何显示成功消息？

> ID：10962108
> 
> 赞同：0
> 
> 时间：2012-06-09T15:12:58.917
> 
> 标签：javascript, html, replace, popup

我有替换`Div`标签的javascript代码...

```
<script type="text/javascript">
  function showPopup(url) {
   newwindow=window.open(url,'Image        
Share','height=490,width=850,top=200,left=80,resizable');
    if (window.focus) {newwindow.focus()}
      }
    function replace() {
  document.getElementById("div1").style.display="none";
  document.getElementById("div2").style.display="block";
}
</script>

<div id = "div1" style="display:block" onclick = "replace()">
 123123123
 </div>

 <div id = "div2" style="display:none">454545454 </div> 
```

那行得通，但前提是我做一次。如果我在同一页面上这样重复：

```
<!-- -------1------- -->

<div id = "div1" style="display:block" onclick = "replace()">
123123123
</div>
<div id = "div2" style="display:none">454545454 </div>

<!-- -------2------- -->

<div id = "div1" style="display:block" onclick = "replace()">
123123123
</div>
<div id = "div2" style="display:none">454545454 </div>

<!-- -------3------- -->

<div id = "div1" style="display:block" onclick = "replace()">
123123123
</div>
<div id = "div2" style="display:none">454545454 </div> 
```

* * *

然后它不起作用。

我在`"div1"`. 我想在弹出窗口关闭后替换它，并用成功消息替换它，或者在弹出窗口打开后禁用超链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T19:41:52.663

这不起作用，因为您多次使用相同的 id，一个元素的 id 只能使用一次，因此您必须将重复元素的 id 更改为 div3 和 div4 等...

# jquery - 如何在 jQuery 选择器中使用变量？

> ID：10962115
> 
> 赞同：4
> 
> 时间：2012-06-09T15:14:12.240
> 
> 标签：jquery, variables, jquery-selectors

我正在尝试找到与变量匹配的“src”图像。我使用“警报”来确保变量“currentThumbnail”是正确的，所以我认为问题出在语法上。这就是我目前所拥有的：

```
var currentImage = $('.imageMain').attr('src');
var currentThumbnail = currentImage.substring(6);
var nextT = $('.thumbnails a img[src=currentThumbnail]'); 
```

问题出在“img[src=currentThumbnail]”上。我需要更改什么才能使其有效？

如果不清楚，我很乐意添加更多信息。谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-09T15:15:13.853

```
var nextT = $('.thumbnails a img[src=currentThumbnail]'); 
```

应该

```
var nextT = $('.thumbnails a img[src="'+ currentThumbnail +'"]'); 
```

您需要字符串连接，因为您在`currentThumbnail`字符串中使用变量。

### 来自@ThiefMaster 的重要评论

> 应引用选择器中的属性值。文档说这是一项要求，我认为不强制执行的唯一原因是向后兼容性

# php - PHP：使用其中一个数组的值对三个数组进行排序。对我的 Android/iPhone 应用程序至关重要

> ID：10962120
> 
> 赞同：0
> 
> 时间：2012-06-09T15:14:37.630
> 
> 标签：php, mysql, json

我正在设计一个 PHP 文件来与我的 Android/iPhone 应用程序进行通信，并且遇到了一个简单但难以解决的问题。

**我有这个函数，它只从数据库（ MySQL ）中获取三个参数（ categories_id 、 categories_name 、 categories_picture ），并通过 jSON 响应将它们发送到我的应用程序。**事情是：因为一件事或另一件事，类别没有按顺序发送（按 category_id ），我希望如此。

**问题：**有没有办法按 CATEGORIES_ID 同时订购三个数组？

**当前响应示例：** categories_id = ( 4, 8, 2, 1 ); categories_name=（椅子、桌子、灯、门）；categories_picture=( www.xyz.com/photo4.jpg,www.xyz.com/photo8.jpg,www.xyz.com/photo2.jpg,www.xyz.com/photo1.jpg) **期望响应：** categories_id = ( 1 , 2, 4, 8); categories_name=（门、灯、椅子、桌子）；categories_picture=(www.xyz.com/photo1.jpg,www.xyz.com/photo2.jpg,www.xyz.com/photo4.jpg,www.xyz.com/photo8.jpg)

您是否看到这三个数组如何根据 categories_id 的分类发生变化？

**当前功能：**

```
if( $accion == 3 )
{    
    /*fetch category details from shop_category*/
    $sql = "select * from `shop_category` where `Stat` like 'Y' order by `CName`";
    $rec = @mysql_query( $sql );
    $row = @mysql_num_rows( $rec );**

    if( $row > 0 ) 
    {
        $path_to_link = 'category_pic/';
        while( $data = @mysql_fetch_array( $rec ) ) 
        {
            $categories_id[] = $data['C_ID'];
            $categories_name[] = stripslashes( $data['CName'] );
            $categories_picture[] = $domain.$path_to_link.$data['C_Image'];
        }

        $respond_categories = array( "categories_id"=>$categories_id, "categories_name"=>$categories_name, "categories_picture"=>$categories_picture );
        echo (json_encode($respond_categories)); 
    }

} 
```

我要感谢所有花时间阅读的人。谢谢。

如果有人对此应用感兴趣，该应用名为：Google Play 中的 Cae de Cajon。它只是我的一个客户的测试版。:) 为它感到自豪。它也可以在 Apple Store 中找到，但不是最新的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T15:18:26.723

这可能是有史以来最愚蠢的问题之一。答案可能是？：

$sql = "select * from `shop_category`where `Stat`like 'Y' order by `CID`"; ??

我不知道。

谢谢

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T08:14:53.380

感谢您的解决方案。您可以在 while 循环中使用计数器而不是使用 C_ID 从数据库获取所需的响应，它看起来像

```
if( $accion == 3 )
{    
    /*fetch category details from shop_category*/
    $sql = "select * from `shop_category` where `Stat` like 'Y' order by `C_ID`";
    $rec = @mysql_query( $sql );
    $row = @mysql_num_rows( $rec );
if( $row > 0 ) 
{
    $path_to_link = 'category_pic/';

$i = 0;
while( $data = @mysql_fetch_array( $rec ) ) 
    {
        $category_array[] = $i;
    $categories_id[] = $data['C_ID'];
        $categories_name[] = stripslashes( $data['CName'] );
        $categories_picture[] = $domain.$path_to_link.$data['C_Image'];
    $i++;
    }

    $respond_categories = array( "category_array"=>$category_array,"categories_id"=>$categories_id, "categories_name"=>$categories_name, "categories_picture"=>$categories_picture );
    echo (json_encode($respond_categories)); 
}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T21:20:21.603

您必须在查询中使用 order by 子句

# java - 执行强制转换操作 Vs i++ 的成本是多少？

> ID：10962123
> 
> 赞同：6
> 
> 时间：2012-06-09T15:14:55.983
> 
> 标签：java, casting

在 Java 中，进行强制转换的成本是多少：

```
(MyObject) IObject; 
```

相对：

```
i++; 
```

假设它前面有“int i = N”。

编辑：

如果您愿意，请暂时忽略我与 (i++) 的直接比较。让我用更笼统的说法重新表述一下：一般来说铸造有多贵？选择比我幼稚的“i++”示例更好的参考操作，例如，以简单的变量声明和赋值为例，在 VM 字节码/操作方面执行强制转换与执行转换相比如何？

我用 i++ 作为量尺。那是一个非常糟糕的主意。当他们选择“米”作为基线时，他们的表现要好得多。Java中有运营成本的基本计量单位吗？一个JVM操作？我想这将取决于 Java 操作编译成的本机代码...... anwyay，铸造的成本是多少？（你帮我挑尺子，我不擅长）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T18:19:48.817

我将在第二部分做一个简短的回答（铸造有多贵）：

铸造非常便宜，并且在重要的地方进行了高度优化。 `if (o instanceof Clazz) ((Clazz)o)`是完全免费的（演员表，而不是支票本身）。

总的来说，如果编译器可以证明强制转换并不断折叠，那么它不会花费任何成本。否则，需要在对象的标头中加载以确定类。一些JVM可以使用一些指针来存储类，这很重要。无论如何，即使是负载也可能很便宜并且会命中 L1 缓存。硬件几乎可以正确预测所有强制转换分支 - 想象一下获得 ClassCastException 的可能性有多大（缓慢的路径 - 在这种情况下优化并不重要）。

由于许多原因，数组通常比集合框架及其泛型快得多，但转换本身只占很小的一部分。

最后：明目张胆的“测量”，即微基准测试往往是一个令人震惊的想法，从整体上测量应用程序性能是正确的方法。微基准测试需要深入了解 JVM 如何优化（或不优化），并且您必须确保对您实际需要的内容进行基准测试。[总的来说，它本身就是一门艺术。](http://www.azulsystems.com/events/javaone_2002/microbenchmarks.pdf)

# javascript - 画布变换循环导致 chrome 省略部分循环

> ID：10962130
> 
> 赞同：1
> 
> 时间：2012-06-09T15:15:31.003
> 
> 标签：javascript, canvas

我现在正在练习画布，并在使用变换循环创建文本“环”时遇到了 chrome 错误。

链接在这里：[http ://herophuong.byethost7.com/javascript/slideshow](http://herophuong.byethost7.com/javascript/slideshow)

使用 Opera 和 Firefox 打开它会使脚本成功完成，而使用 chrome 时，结果不是它应该是的（环丢失了一些部分或根本不出现）。如果我花时间使用 webkit 检查器（内置 chrome）逐步浏览脚本，脚本将成功执行。

是否有任何解决该错误的方法，或者我必须等待更新版本的 Chrome？我当前的版本是 19.0.1084.52。

一些截图：

![Firefox 中的 HTML5 幻灯片](../Images/3e5cae2b44dcf4fff66cefdf3217c72d.png) ![Chrome 中的 HTML5 幻灯片](../Images/d1a3ed67c3c0226f2ff45280b56518b9.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T15:30:14.400

我刚刚在 Linux Ubuntu 12.10（长期支持）上使用 chrome 19.0.1084.52 对其进行了测试。我不能说为什么它不起作用，请检查您的 chrome 中是否支持画布文本：

```
typeof document.createElement('canvas').getContext('2d').fillText === "function" 
```

可能是您的计算机上以某种方式禁用了它。

# android - 我无法将字符串数组传递给我的 AsyncTask

> ID：10962133
> 
> 赞同：0
> 
> 时间：2012-06-09T15:15:59.163
> 
> 标签：android

编译器错误是“ `The method execute(ArrayList<String>...) in the type AsyncTask<ArrayList<String>,Void,ArrayList<String>> is not applicable for the arguments (String)`”

为什么它不接受新参数？谁能看到我做错了什么？

```
 ArrayList<String> passing = new ArrayList<String>();
            passing.add(logicalUrl);
            passing.add("filename.pdf");
            new myTask().execute(logicalUrl);
            return true;
        }

    public class myTask extends AsyncTask<ArrayList<String>, Void, ArrayList<String>> {
        ProgressDialog dialog;

        @Override
        protected void onPreExecute() {
            dialog = new ProgressDialog(ModuleContents.this);
            dialog.setTitle("Downloading...");
            dialog.setMessage("Please wait...");
            dialog.setIndeterminate(true);
            dialog.show();
        }

        protected ArrayList<String> doInBackground(ArrayList<String>... passing) {
            ArrayList<String> passed = passing[0];
            String physicalUrl = parsePhysicalUrl(passed.get(0));
            String filename = passed.get(1);
            try {
                globals.saveFile(physicalUrl, filename);
            } catch (ClientProtocolException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            }
            return passed;

        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T15:19:17.410

您有`new myTask().execute(logicalUrl)`logicalUrl is `String`，但您在通用中指定了应该是`ArrayList<String>`

所以改成

```
 public class myTask extends AsyncTask<String, Void, ArrayList<String>> {} 
```

或添加为`ArrayList`您创建的类的参数。

```
new myTask().execute(passing); 
```

现在它应该可以工作了。看来你只是忽略了它：]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T15:20:20.160

改变：

```
new myTask().execute(logicalUrl); 
```

到：

```
new myTask().execute(passing); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T15:20:14.640

`new myTask().execute(passing);`代替`new myTask().execute(logicalUrl);`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-09T15:29:22.610

你的方法应该是这样的

```
 ArrayList<String> passing = new ArrayList<String>();
        passing.add(logicalUrl);
        passing.add("filename.pdf");

        **new myTask().execute(passing);**

        return true; 
```

并检查此链接。，。它类似于你的问题

[将参数传递给 AsyncTask，并返回结果](https://stackoverflow.com/questions/4195609/passing-arguments-to-asynctask-and-returning-results)

# python - 我无法理解这个说法（多维数组）

> ID：10962135
> 
> 赞同：2
> 
> 时间：2012-06-09T15:16:30.790
> 
> 标签：python

在我试图理解的一段代码中，我遇到了以下语句：

```
_RecvBuf[conn] = _RecvBuf[conn][8+msgSize:] 
```

_RecvBuf 被声明为

```
_RecvBuf = {} 
```

msgSize 是一个整数。我看不到这意味着什么，有什么帮助吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T15:19:30.973

_RecvBuf 是一个字典，它看起来像是将连接映射到字符串。在这种情况下，`_RecvBuf[conn]`是一个字符串，并且`_RecvBuf[conn] = _RecvBuf[conn][8+msgSize:]`会`8+msgSize`从 conn 的字符串中截取第一个字节。

Python 使用 [] 语法在字典中查找键和对字符串进行切片。

# android - 媒体播放器完成时如何停止animationdrawable？

> ID：10962136
> 
> 赞同：0
> 
> 时间：2012-06-09T15:16:35.653
> 
> 标签：android, animation, media-player

我有一个动画 xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<animation-list xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/anim"
    android:oneshot="true" >

    <item
        android:drawable="@drawable/pik1"
        android:duration="150"/>
    <item
        android:drawable="@drawable/pik2"
        android:duration="150"/>

</animation-list> 
```

我想要做的是在 mediaplayer 播放时开始并继续运行动画，并在 mediaplaye 完成播放时停止动画。

例如：媒体播放器正在播放 5 秒长的声音，我想播放动画 5 秒然后停止。

这是我在主要活动中的 java 代码：

```
piks.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                if (play != null) {
                    play.reset();
                    play.release();
                }
                play = MediaPlayer.create(pikselActivity.this,
                        R.raw.pisound);
                play.start();
                frame.start();

            }
        }); 
```

frame.start() 开始动画，但是当声音结束时，动画继续运行。声音结束后如何让动画停止？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T15:21:24.137

您将需要实现 OnCompletionListener

```
play.setOnCompletionListener(new

OnCompletionListener() {

              @Override
              public void onCompletion(MediaPlayer arg0) {
                  frame.stop();

              }
          }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T15:20:55.027

在您的媒体播放器上放置一个 onCompletionListener()。在媒体完成的回调中添加

```
frame.clearAnimation(); 
```

像这样：

```
if (play != null) {
    play.reset();
    play.release();
}
play = MediaPlayer.create(pikselActivity.this,R.raw.pisound);

play.setOnCompletionListener(new OnCompletionListener() {
    public void onCompletion (MediaPlayer mp){
        frame.clearAnimation();
    }
});
play.start();
frame.start(); 
```

# javascript - 无法将我的计时器值存储在 cookie 中

> ID：10962140
> 
> 赞同：0
> 
> 时间：2012-06-09T15:17:08.793
> 
> 标签：javascript, html, cookies

我昨天问过关于在浏览器关闭时保存计时器值，然后在用户打开它时再次开始计数。我发现使用 cookie 一定是一个很好的解决方案，所以我添加了 set 和 getcookie 函数，但我仍然无法获取我的计时器值。这可能很容易，但我看不出有什么问题，因为我在 javascript 中仍然太菜鸟。有人知道我在做什么错吗？谢谢你！！这是我到目前为止的代码：

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head>
    <title>Test</title>
    <script type="text/javascript">
var sec = 0;
var min =  0;
var hr = 0;
var dias = 0;
var bool = true;
function stopwatch() {
        sec++;
        if (sec == 60) {
            sec = 0;
            min += 1;
        }

        if (min == 60) {
            min = 0;
            hr += 1;
        }

        if (hr == 24) {
            hr = 0;
            dias += 1;
        }

        totalTime = ((dias<=9) ? "0" + dias : dias) + "d, " + ((hr<=9) ? "0" + hr : hr) + " : " + ((min<=9) ? "0" + min : min) + " : " + ((sec<=9) ? "0" + sec : sec);
        document.getElementById("timer").innerHTML = totalTime;
        if (bool == true) {
        start = setTimeout("stopwatch()", 1000);
        }

    }

function setCookie(name, value, expires) {
document.cookie = name + "=" + escape(value) + "; path=/" + ((expires == null) ? "" : "; expires=" + expires.toGMTString());
}

function getCookie (name) {
    var cname = name + "=";               
    var dc = document.cookie;

    if (dc.length > 0) {              
        begin = dc.indexOf(cname);       
            if (begin != -1) {           
            begin += cname.length;       
            end = dc.indexOf(";", begin);
                if (end == -1) end = dc.length;
                return unescape(dc.substring(begin, end));
            } 
        }
    return null;
}

var exp = new Date();                                  
exp.setTime(exp.getTime() + (1000 * 60 * 60 * 24 * 30));

    </script>
</head>
<body onload="stopwatch()">
    <div id="timer" name="timer"> </div>
  <button onclick="bool = false"; > pause </button>
  <button onclick="bool = true;stopwatch();" > resume </button>

    <form>
      <input type="button" value="Set a Cookie" onClick="setCookie('myCookie',timer.value, exp)">
    </form>
<form>
<input type="button" value="Get Cookie Value" onClick="this.form.tf.value = getCookie('myCookie')">
<input type="text" name="tf" size="30">
</form>

 </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T15:34:46.160

cookie 值保存为“未定义”，因为您没有存储正确的值：`timer.value`

将其更改为`totalTime`它可以工作：

```
<input type="button" value="Set a Cookie" onClick="setCookie('myCookie',totalTime, exp)"> 
```

看到[这个小提琴](http://jsfiddle.net/YRfDr/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T15:50:14.507

[@floorish](https://stackoverflow.com/a/10962276/1015609)说的问题`timer.value`不存在，因为`timer`它是一个 DIV 元素并且没有`value`属性。

因此，您需要更改`timer.value`为`document.getElementById('timer').innerHTML`并且会很好。

[现场 jsFiddle 演示](http://jsfiddle.net/Zztbg/)

* * *

**编辑1：**

如果您希望计时器开始计算它保存在 cookie 上的位置，您应该在页面加载时读取 cookie。我是这样设计的：

```
<!DOCTYPE html>
<html>
<head>
<title>Timer</title>
</head>
<body>
<div id="timer">&nbsp;</div>
<button id="switcher"></button>
<p><input type="button" id="setCookie" value="Set a Cookie"></p>
<p><input type="button" id="getCookie" value="Get Cookie Value"> <input type="text" id="lastTime" size="30"></p>
<script>
/**
 * Set cookie 
 * @param {string} name Name of cookie
 * @param {string} value Value of the cookie
 * @param {object} expires Date object of expire time
 */
function setCookie(name, value, expires) {
  document.cookie = name + "=" + escape(value) + "; path=/" + ((expires == null) ? "" : "; expires=" + expires.toGMTString());
}

/**
 * Get cookie 
 * @param {string} name Name of cookie
 * @return {?string}
 */
function getCookie(name) {
    var cname = name + "=";               
    var dc = document.cookie;

    if (dc.length > 0) {              
    begin = dc.indexOf(cname);       
      if (begin != -1) {           
      begin += cname.length;       
      end = dc.indexOf(";", begin);
        if (end == -1) end = dc.length;
        return unescape(dc.substring(begin, end));
      } 
    }
    return null;
}

var time;

/**
 * Format time and return formatted string
 * @param {number} time Time in seconds that will formatted
 * @return {string}
 */
function formatTime(time) {
  var days = parseInt(time / 86400, 10); // Calculate days from seconds and delete decimals.
  if (0 > days) {
    days = 0;
  }

  var hours = parseInt((time -  days * 86400) / 3600, 10); // Calculate hours from seconds and delete decimals.
  if (0 > hours) {
    hours = 0;
  }

  var mins = parseInt((time -  days * 86400 - hours * 3600) / 60, 10); // Calculate minutes from seconds and delete decimals.
  if (0 > mins) {
    mins = 0;
  }

  var seconds = parseInt(time - days * 86400 - hours * 3600 - mins * 60, 10); // Calculate remain seconds.

  // Array for the time display, the content is something like:
  //   array(3) {
  //     0: '01',
  //     1: '57',
  //     2: '31'
  //   }
  var displayHours = [
    ((hours <= 9) ? '0' + hours : hours),
    ((mins <= 9) ? '0' + mins : mins),
    ((seconds <= 9) ? '0' + seconds : seconds)
  ];

  // Return formatted days and the displayHours is joined with ' : ', then it like this:
  //   '00d, ' + '01 : 57 : 31'
  return ((days <= 9) ? '0' + days : days) + 'd, ' + displayHours.join(' : ');
}

/**
 * Append to the 'timer' DIV the formatted time
 */
function watch() {
  // Append to the 'timer' DIV a formatted time
  //   ++time equal time = time + 1
  document.getElementById('timer').innerHTML = formatTime(++time);
}

/**
 * @type {?object} Variable to handle the interval timer.
 */
var timer = null;

/**
 * Switch between 'pause' and 'resume' time
 */
var switcher = function () {
  if (timer) { // If timer is assigned and not null
    clearInterval(timer); // Clear the interval to stop
    timer = null; // Null the timer
    document.getElementById('switcher').innerHTML = 'Resume'; // Change the word of the button to 'Resume'.
  } else {
    timer = setInterval(watch, 1000); // Start the interval timer
    document.getElementById('switcher').innerHTML = 'Pause'; // Change the word of the button to 'Pause'.
  }
};

// Assign on click event to 'switcher' button
document.getElementById('switcher').onclick = switcher;

// Assign on click event to 'setCookie' button
document.getElementById('setCookie').onclick = function () {
  // New Date object for the expire time
  var exp = new Date();
  // Set the expire time
  exp.setTime(exp + 2592000000);
  // Set a 'time' cookie with the current timer time and expire time object.
  setCookie('time', time, exp);
};

// Asign on click event to 'getCookie' button
document.getElementById('getCookie').onclick = function () {
  document.getElementById('lastTime').value = formatTime(getCookie('time'));
};

// Function that will call when document loaded.
window.onload = function () {
  // Get the time saved into the cookie and turn it to number.
  var oldTime = parseInt(getCookie('time'), 10);
  if (0 < oldTime) { // If the time saved
    time = oldTime; // Set the current time to the saved time
  } else { // If not time saved
    time = 0; // Set the current time to zero.
  }

  // Start the timer
  switcher();
}
</script>
</body>
</html> 
```

[现场 jsFiddle 演示](http://jsfiddle.net/Cg358/)

# python - 在 python 中包装交互式 CLI

> ID：10962141
> 
> 赞同：6
> 
> 时间：2012-06-09T15:17:12.190
> 
> 标签：python, popen

我正在尝试将[gnugo](https://www.gnu.org/software/gnugo/)包装在 python 脚本中。

我已经在 SO 中讨论了关于[在此处](https://stackoverflow.com/questions/1567371/wrapping-an-interactive-command-line-application-in-a-python-script)和[此处](https://stackoverflow.com/questions/10873157/python-interactive-cli-application)包装 CLI 应用程序的其他问题，尽管它们有所帮助，但我无法让我的脚本完全工作。在标准输入的第一次输入之后，该进程似乎被终止。

脚本如下所示：

```
import subprocess 

proc = subprocess.Popen(['gnugo', '--mode', 'gtp'], stdout=subprocess.PIPE, stdin=subprocess.PIPE)

c = raw_input('first command: ')

while True:
    r = proc.communicate(c)
    print 'gnugo says: ' + str(r)
    c = raw_input('next command: ') 
```

我得到的错误是：

```
$ python testgnu.py
first command: play b c4
gnugo says: ('= \n\n', None)
next command: genmove w
Traceback (most recent call last):
  File "testgnu.py", line 8, in <module>
    r = proc.communicate(c)
  File "/usr/local/Cellar/python/2.7.3/lib/python2.7/subprocess.py", line 754, in communicate
    return self._communicate(input)
  File "/usr/local/Cellar/python/2.7.3/lib/python2.7/subprocess.py", line 1307, in _communicate
    self.stdin.flush()
ValueError: I/O operation on closed file 
```

我正在运行 python 2.7.3（可能没关系，但 gnugo 版本是 3.8）。

其他问题中的一些答案建议[pexpect](http://sourceforge.net/projects/pexpect/)但我想使用尽可能少的外部库。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-09T15:41:22.600

您的问题是[`Popen.communicate`](http://docs.python.org/library/subprocess.html#subprocess.Popen.communicate)在执行读取和写入后关闭文件。

您必须手动调用`proc.stdin.write(...)`以发送流程文本并`proc.stdout.read*()`阅读文本：

```
while True:
    proc.stdin.write(c)
    r = proc.stdout.readline() 
```

# ruby-on-rails-3 - 黄瓜 h1 测试通过但不应该？

> ID：10962142
> 
> 赞同：0
> 
> 时间：2012-06-09T15:17:13.493
> 
> 标签：ruby-on-rails-3, rspec, cucumber

我刚刚开始使用黄瓜并且喜欢它，但是有一个问题似乎非常基本，我无法解决。我正在使用以下内容对我的主页进行非常基本的测试：

home_pages.feature

```
Feature: Viewer visits the Home Page
        In order to read the page
        As a viewer
        I want to see the home page of my app

    Scenario: View home page
        Given I am on the home page
        Then I should see "Test" in the selector "h1"

    Scenario: Check Home Page Links
        Given I am on the home page
        Then I should see "How It Works" in a link
        And I should see "Sign Up" in a link
        And I should see "Log In" in a link 
```

和 cr1_steps.rb

```
Given /^I am on the home page$/ do
  visit root_path
end

Then /^I should see "([^"]*)" in the selector "([^"]*)"$/ do |text, selector|
  page.should have_selector selector, content: text
end

Then /^I should see "([^"]*)" in a link$/ do |text|
    page.should have_link text
end 
```

主页.html.erb

```
<div class="center hero-unit">
  <h1>Working</h1>
    <p>testing testing testing</p>
      <a class="btn btn-primary btn-large">
        Click This
      </a>
 </div>
  <ul class="thumbnails">
    <li class="span3">
      <div class="thumbnail">
        <img src="http://placehold.it/360x268" alt="">
      </div>
    </li>
  </ul> 
```

然而，即使“h1”选择器在 home.html.erb 中有“工作”，黄瓜也会通过，因为它应该失败，因为我正在测试“h1”测试任何想法为什么会这样

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T16:14:21.300

`:content`我在 Capybara 文档中没有看到一个选项`#has_selector?`

试试`text: text`吧。

# .net - 控件在运行时创建后存储在哪里？

> ID：10962143
> 
> 赞同：1
> 
> 时间：2012-06-09T15:17:17.940
> 
> 标签：.net, vb.net, vb.net-2010

我是 .NET 编程的新手。

我需要在运行时创建多个 TextBoxies。

我有以下 VB NET 代码：

```
 Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click

   Dim textbox1 As New TextBox
   static Dim shiftDown As Integer
   static Dim counter As Integer

    counter += 1
    shiftDown = shiftDown + 30
    textbox1.Name = "Textbox" + counter.ToString()
    textbox1.Size = New Size(170, 10)
    textbox1.Location = New Point(10, 32 + shiftDown)
    textbox1.Visible = True
    GroupBox1.Controls.Add(textbox1)

End Sub 
```

此代码示例在单击 Button1 后在运行时在窗体上创建多个文本框。

我的问题是单击按钮后创建的文本框存储在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T16:33:25.600

@Darren 写的理论上是正确的。不过，我不确定这是否是您要寻找的东西，所以这里有更多信息。

像任何局部变量一样，`textbox1`它的作用域仅限于定义它的方法，并且会在 Sub 返回时“消失”。但是，它引用的对象（ 的实例`TextBox`，以前称为`textbox1`）仍然存在，并且现在在 的`Controls`集合中存储了一个引用`GroupBox1`。

显然，您创建它`TextBox`是有原因的，并且想要再次获得它 - 您可以。您需要做的就是查看`GroupBox1.Controls`集合。假设您开始时它是空的，您可以相信其中的所有子对象都是`TextBox`您创建的控件。

现在，如果`GroupBox1`包含动态创建的控件以外的其他内容，您可以选择仅存储和检索动态文本框。例如，您可以在类级别（例如，在您的表单上）定义和创建一个集合，并将每个文本框添加到该集合中`Button1_Click`。

有多种方法，但希望这能让你指出正确的方向。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T16:51:17.750

这是一个非常模棱两可的问题，至少有5个正确答案。让我们从显而易见的答案开始：

*   TextBox 对象存储在所有 .NET 引用类型对象的存储位置：在垃圾收集堆上。

不那么明显的那些，旨在最大限度地混淆：

*   TextBox 类派生自 Control，而 Control 派生自 MarshalByRefObject 派生的 Component。这允许将对象存储在不同的 AppDomain 或进程中。在这种情况下，您的程序将引用代理。这是不寻常的顺便说一句。
*   您的程序将 TextBox 对象的引用存储在 GroupBox1.Controls 集合中，因此您可以认为是组框“存储”了该对象。Winforms 使用此引用在窗体关闭时自动处理文本框
*   但这不是重要的参考。您可以从 Controls 集合中删除文本框，它不会被释放。Winforms 维护一个将窗口句柄映射到控制对象的内部表。即使您的程序没有存储对它的任何引用，该引用也可以使您的主窗体保持活动状态。当您使用 Controls.Remove 或 Controls.Clear 删除文本框时，会导致严重的泄漏。该控件被重新托管并“存储”在一个名为“停车窗口”的不可见窗口上
*   TextBox 类实际上是名为 EDIT 的本机 Windows 控件的托管包装器。它是所有 Windows 控件的鼻祖，自 Windows 版本 1 以来就一直存在。这有点像冰山，90% 都在水下，不可见。Windows 将窗口对象存储在由在同一桌面上运行的所有进程共享的堆中。Handle 属性是对该本地对象的“引用”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T15:24:37.503

A`TextBox`只是一个 .NET 类，您的 textbox1 对象与该类的任何其他实例一样，由公共语言运行时 (CLR) 保存在内存中。.NET 框架会为您处理这个问题（就像任何其他对象一样）。你打电话时：

`GroupBox1.Controls.Add(textbox1)`框架使用该内存位置（指向文本框对象）并根据内存地址内容创建一个新文本框。

# mysql - mysql 转储 - 字符编码

> ID：10962145
> 
> 赞同：1
> 
> 时间：2012-06-09T15:17:24.160
> 
> 标签：mysql, character-encoding, dump

我有一个 mysql 转储，其中包含 ascii 字符，如`Ã¼berprÃ¼ft`. 我的问题就像我无法进行另一个转储，我一直在网上搜索解决方案，但每个建议都会涉及另一个转储，将其设置为 utf-8。有没有办法转换转储文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T15:42:28.593

整个转储是这样编码的，也就是说，是用 UTF-8 编码的吗？在这种情况下，您可以在导入转储时简单地设置编码。

如果使用`mysql`命令行客户端导入dump，导入`--default-character-set`时使用命令行开关，例如：

```
> mysql -u user --default-character-set=utf8 < dump.sql 
```

# java - 了解Android的webview addjavascriptinterface

> ID：10962150
> 
> 赞同：21
> 
> 时间：2012-06-09T15:18:43.313
> 
> 标签：java, javascript, android, webview

我知道要从 Javascript 交互到 Java，您必须使用 webview 中的 addjavascriptInterface 方法注入 Java 对象。

这是我面临的问题。

1.  我使用方法注册了一个 java 对象`addJavascriptInterface`，以便在我的 JS 中可用。

2.  我使用在 webview 中注入了一些 JS`webview.loadURL("javascript:XXX");`

3.  当我完成注入 JS 时，我会发送一个 JS 事件。

问题是，如果在第 1 步之后立即执行以下 Javascript：

```
mWebView.loadUrl("javascript:if(window.myobject) console.log('myobject found---------'); else {console.log('myobject not found----');}"); 
```

我在控制台的日志中收到“找不到我的对象”。

我想知道，如果有一段时间我可以访问我的对象，如果是这样，我如何知道我应该等待多长时间才能调用我的对象？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-07-20T04:33:03.087

> 我想知道是否有一段时间我可以访问我的对象

是的，我认为有延迟，因为`WebView.addJavascriptInterface`会在 WebView 的内部工作线程中运行。或许你已经想到了这一点，意识到 WebView 至少要维护一个工作线程来做异步网络 IO。也许您在使用 WebView 时也注意到了 DDMS 中的这些线程。

事实证明，它还使用一个线程来为许多其他公共方法工作。我真的希望 Google 的文档能更清楚地说明这一点！但我希望我能帮助你，并向你展示我是如何为自己确认这一点的。

跟我来看看 WebView 的源代码。它具有合理的可读性，即使您无法准确了解正在发生的事情，也可以通过回答有关线程的一些问题来追踪。

您可以通过 SDK 管理器工具下载 Android 框架源，但它也镜像在 Github 上，所以我在这里链接到了。我猜测并选择了一个接近 ICS 版本的标签。不难找到[`WebView.addJavascriptInterface`](https://github.com/android/platform_frameworks_base/blob/android-4.0.1_r1/core/java/android/webkit/WebView.java#L4022)。我刚刚用谷歌搜索了“WebView.java 站点：github.com/android”。

该方法`WebView.addJavascriptInterface`向以下实例发送消息`WebViewCore`：

```
mWebViewCore.sendMessage(EventHub.ADD_JS_INTERFACE, arg); 
```

里面有`WebViewCore.java`一堆重载的方法被称为[`sendMessage`](https://github.com/android/platform_frameworks_base/blob/android-4.0.1_r1/core/java/android/webkit/WebViewCore.java#L1734)，但我们并不需要知道究竟是哪一个被调用，因为它们做的事情几乎相同。甚至有一个很好的评论给我们一个提示，我们在正确的地方！所有这些都委托给一个实例，[`EventHub`](https://github.com/android/platform_frameworks_base/blob/android-4.0.1_r1/core/java/android/webkit/WebViewCore.java#L920)该实例是某个内部类。[这个方法](https://github.com/android/platform_frameworks_base/blob/android-4.0.1_r1/core/java/android/webkit/WebViewCore.java#L1652)结果是同步的，并且正在向 的实例发送消息`Handler`，这很好地表明它可能正在另一个线程中运行，但为了完整起见，让我们找出来！

那是从 调用`Handler`的实例化的。这里还有几跳，但最终我发现这是从（的子类）中调用的，它与新的右[在这里](https://github.com/android/platform_frameworks_base/blob/android-4.0.1_r1/core/java/android/webkit/WebViewCore.java#L162)一起实例化。[`EventHub.transferMessages`](https://github.com/android/platform_frameworks_base/blob/android-4.0.1_r1/core/java/android/webkit/WebViewCore.java#L1064)[`WebViewCore.initialize`](https://github.com/android/platform_frameworks_base/blob/android-4.0.1_r1/core/java/android/webkit/WebViewCore.java#L209)`run``WebCoreThread``Runnable``Thread`

多么冒险！所以，即使我真的不能确定所有这些移动部件发生了什么，我很有信心说这种方法不是同步的，而是向 WebView 的工作线程发送消息。我希望这是有道理的！

> 如果是这样，我如何知道我应该等待多长时间才能调用我的对象？

不幸的是，我不知道这个问题的答案。我正在研究这个确切的问题，并在我的谷歌搜索过程中在 StackOverflow 上发现了这个问题。我认为您有以下选择，其中一些比其他更好或更容易：

1) 仅`Thread.sleep`100 毫秒或介于`addJavascriptInterface`和之间的时间`loadUrl("javascript:...")`。Blech，我不喜欢这个，但它可能是最简单的。

2) 另一种可能性是，您可以`WebView.loadUrl`使用专门测试接口是否已设置的 JavaScript 片段进行调用，并捕获未设置时引发的 ReferenceError。但是，正如您可能已经猜到的那样，这种方法涉及向 WebView 添加一个 JavaScript 接口！

3) 改为调用`WebView.setWebChromeClient`，并捕获 JavaScript 的`alert()`or `console.log`。从我的实验来看，这种方法**是**同步的，所以没有延迟。（我已经在源代码中确认了这一点，但我将把细节作为练习留给读者）你可能应该想出一些特殊的字符串来调用`alert`并在里面检查它`onJsAlert`，所以你不只是捕捉所有`alert()`的 s。

对不起这个答案的长度，我希望这会有所帮助。祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T05:11:44.523

确保您需要从 Java 访问的 HTML / Javascript 中声明的 Javascript 对象声明为全局的，否则它们很可能会被收集。我有执行此操作的代码（其中 Android 是我使用 addJavascriptInterface 添加的界面）：

```
<script>
  var cb = function(location) {
     alert('location is ' + location);
  }
  Android.getLocation('cb');
</script> 
```

getLocation 方法调用 Android 的 LocationManager.requestSingleUpdate，然后在 LocationListener 触发时调用回调。

如果没有“var”，我发现当位置查找调用回调时，回调函数已被垃圾收集。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-17T00:33:45.073

（从我对[类似问题的](https://stackoverflow.com/a/18839482/253704)回答中复制）

我将 Jason Shah 和 Mr S 的实施作为我修复的基石，并对其进行了极大的改进。

有太多代码可以放入此评论中，我将链接到它。

*   详情：[http ://twigstechtips.blogspot.com/2013/09/android-webviewaddjavascriptinterface.html](http://twigstechtips.blogspot.com/2013/09/android-webviewaddjavascriptinterface.html)
*   来源：[https ://github.com/twig/twigstechtips-snippets/blob/master/GingerbreadJSFixExample.java](https://github.com/twig/twigstechtips-snippets/blob/master/GingerbreadJSFixExample.java)

要点是：

*   适用于所有版本的 Gingerbread (2.3.x)
*   从 JS 到 Android 的调用现在是同步的
*   不再需要手动映射接口方法
*   修复了字符串分隔符破坏代码的可能性
*   更改 JS 签名和接口名称要容易得多

# c# - EF多对多储蓄问题

> ID：10962152
> 
> 赞同：0
> 
> 时间：2012-06-09T15:18:58.737
> 
> 标签：c#, entity-framework

我有一个数据库表：

```
Item{ItemId ...}
Item{BoardId ...}
ItemsInBoards{ItemId, BoardId, CreatedOnDate} 
```

我的应用程序中有一个模型

```
public class Item
{
public int ItemId{get;set;}
...
public virtual ICollection<Board> Boards { get; set; }
}

public class Board
{
public int BoardId{get;set;}
...
public virtual ICollection<Item> Items { get; set; }
} 
```

保存...

```
...
Item item = con.Item.Find(model.ItemId); // Find item by ID
// Try to save
Board b = con.Boards.Find(model.BoardId); // Find a board by ID
                b.CreatedOnDate = DateTime.Now; // This is the issue
                item.Boards.Add(b);
                con.SaveChanges(); 
```

它已保存但没有`CreatedOnDate`. 我不知道如何设置`CreatedOnDAte`字段以将其保存在数据库中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T15:34:24.080

这不是多对多的关系。您需要两个一对多关系并且必须`ItemsInBoards`作为模型实体公开：

```
public class Item
{
    public int ItemId{get;set;}
    ...
    public virtual ICollection<ItemInBoard> ItemsInBoard { get; set; }
}

public class Board
{
    public int BoardId{get;set;}
    ...
    public virtual ICollection<ItemInBoard> ItemsInBoard { get; set; }
}

public class ItemInBoard
{
    [Key, Column(Order = 1)]
    public int ItemId{get;set;}
    [Key, Column(Order = 2)]
    public int BoardId{get;set;}

    public DateTime CreatedOnDate{get;set;}

    public virtual Item Item{get;set;}
    public virtual Board Board{get;set;}
} 
```

然后您可以通过以下方式写入关联表 - 包括`CreatedOnDate`属性值：

```
var newItemInBoard = new ItemInBoard
{
    ItemId = model.ItemId,
    BoardId = model.BoardId,
    CreatedOnDate = DateTime.Now
};
con.ItemsInBoard.Add(newItemInBoard);
con.SaveChanges(); 
```

关于这种模型类型的更多细节在这里：[https ://stackoverflow.com/a/7053393/270591](https://stackoverflow.com/a/7053393/270591)

# android - Android Tabbar：为什么每次切换标签时都会重新创建活动？

> ID：10962153
> 
> 赞同：0
> 
> 时间：2012-06-09T15:18:58.957
> 
> 标签：android, tabbar

我有 2 个带有标签栏的项目。在每个项目中，活动都绑定到标签栏。但是，在第一个活动中，仅在我第一次切换到某个选项卡时才创建活动（我认为这种行为是正常的）。在第二个中，每次我切换到选项卡时都会调用 onCreate，而不管之前是否创建了此活动的实例。

我不明白为什么 2 个应用程序（2 个项目 = 2 个应用程序）的行为方式如此不同。在这两个项目中，我都试图归档任何行为——它本身就发生了。谁能解释我不同行为的可能原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T17:53:50.487

没有看到你的代码，我们只能猜测。

也许您在一个应用程序中调用`finish()`您的活动，而不是在另一个应用程序中。

# c# - 根据点对纹理进行 XNA 旋转

> ID：10962156
> 
> 赞同：0
> 
> 时间：2012-06-09T15:19:14.373
> 
> 标签：c#, math, vector, xna, rotation

我正在写一个小测试项目。我在原点有一个对象（带有位置和边界框），当发生某些事情时（比如在手机上单击鼠标/触摸），我希望从原点对象到该点绘制一条线。

使用纹理，我意识到我将不得不在这里使用旋转，但不知道如何计算出将纹理旋转多少。任何帮助，将不胜感激。

到目前为止，我有：

Vector2 原点 Vector2 接触点

就是这样。

谢谢大家！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T15:31:25.283

有一个简单的公式可以根据 X 和 Y 坐标计算角度：

```
float angle = Math.Atan2(TouchPoint.Y - Origin.Y, TouchPoint.X - Origin.X); 
```

`SpriteBatch.Draw()`您可以在接受旋转角度的重载中使用此角度。

请参阅此参考：http: [//msdn.microsoft.com/en-us/library/ff433992.aspx](http://msdn.microsoft.com/en-us/library/ff433992.aspx)

您可能想要在度数和弧度之间进行转换：

```
float rad = deg * Math.PI/180;

float deg = rad * 180/Math.PI; 
```

# python - python有“人”吗？

> ID：10962160
> 
> 赞同：12
> 
> 时间：2012-06-09T15:19:34.720
> 
> 标签：python

我想知道是否有专门用于 Python 的像“man.py”这样的 CLI？

前任，

```
man.py os.system
> system(command) -> exit_status
>
> Execute the command (a string) in a subshell. 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-09T15:22:13.653

pydoc 模块提供了它：

```
$ python -m pydoc os.system
Help on built-in function system in os:

os.system = system(...)
    system(command) -> exit_status

    Execute the command (a string) in a subshell.
$ 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-09T15:21:36.180

最简单的方法是`pydoc function`在 shell 上使用，`function`可以是内置函数的名称，也可以是模块中函数的限定名称 ( `module.function`)：

```
> PAGER=cat pydoc urllib.urlencode
[adrian@hades:~]> PAGER=cat pydoc urllib.urlencode
Help on function urlencode in urllib:

urllib.urlencode = urlencode(query, doseq=0)
    Encode a sequence of two-element tuples or dictionary into a URL query string.
... 
```

（`PAGER=cat`仅用于在此处复制和粘贴）

使用 IPython 时，您可以使用`function?`查看文档字符串`function`或`function??`更详细的视图，其中包括用 python 编写的函数的完整源代码。

在普通的 python shell 中，您可以使用`help(function)`它。但是，在我看来，IPython 方式更舒服。

# tridion - 核心服务 2011 - 地址簿

> ID：10962162
> 
> 赞同：7
> 
> 时间：2012-06-09T15:19:49.820
> 
> 标签：tridion

是否可以使用核心服务 (Tridion 2011 SP1) 创建 Audience Manager 通讯簿？

（或者以任何其他方式自动创建它们 - 数据库脚本，互操作？）

干杯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-11T09:50:24.500

核心服务中没有 Audience Manager 功能；只有 Content Manager 功能在那里公开。

但是，您可以使用服务器上的公共 API (Tridion.AudienceManagement.API) 来创建您想要的任何项目。您没有指定要创建的通讯簿类型 - 但我将假设您想要一个静态的地址簿来创建联系人。

这是一些示例代码：

```
StaticAddressBook denmark = new StaticAddressBook();
denmark.Title = "Denmark";
denmark.Key = "DK";
denmark.Save(); 
```

如果你想创建一个动态通讯簿，你也需要指定一个过滤器；让我知道是否是这种情况，我也可以为此提供一些示例代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T07:44:08.693

您可以使用 Tridion.OutboundEmail.ContentManagement 命名空间。其中有一个 AddressBook 对象（或者您可以根据要创建的 AB 类型使用 StaticAddressBook）。像这样的东西应该工作：

```
AddressBook ab = new AddressBook();
ab.Title = "The title of my new Address Book";
ab.Save(); 
```

查看 StaticAddressBook 的 API（已记录），有一个静态方法 StaticAddressBook.CreateLocalAddressBook 实际上在此实例中可能更相关。如果我是您，我会检查一下；) 您可以从 SDLTridionWorld.com 下载文档

# php - 致命错误：在 pdo 中对非对象调用成员函数 prepare()

> ID：10962175
> 
> 赞同：0
> 
> 时间：2012-06-09T15:21:30.983
> 
> 标签：php, mysql, sql, pdo

我收到“致命错误：在非对象上调用成员函数 prepare()”错误，脚本在我的其他主机上运行良好，但现在我移动主机显示此错误并且不知道为什么，因为编码很好。

```
include 'functions/functions.php';  
global $db;

$db = mysqlconnect();

$password = md5($_POST['mypassword']);

$mod = '1' ;
$statement = $db->prepare("SELECT * FROM users WHERE username = ? AND password = ? And mod = ?");
$statement->execute(array($_POST['myusername'],$password, $mod));

$count = $statement->rowCount();

if($count == 1){
    $db = mysqlconnect();
  // Register $myusername, $mypassword and redirect to file "login_success.php"

$_SESSION['user'] = $_POST['myusername'] ;

//Test if it is a shared client
if (!empty($_SERVER['HTTP_CLIENT_IP'])){
  $ip=$_SERVER['HTTP_CLIENT_IP'];
//Is it a proxy address
}elseif (!empty($_SERVER['HTTP_X_FORWARDED_FOR'])){
  $ip=$_SERVER['HTTP_X_FORWARDED_FOR'];
}else{
  $ip=$_SERVER['REMOTE_ADDR'];
}

$sqll = "UPDATE users SET lastip=? WHERE username=?";
    $q = $db->prepare($sqll);
    $q->execute(array($ip,$_SESSION['username']));

$_SESSION['user'] = $_POST['myusername'] ;

$sqlll = "INSERT INTO user_log (username,ip) VALUES (?, ?)";
    $qq = $db->prepare($sqlll);
    $qq->execute(array($_SESSION['username'],$ip));

header("Location: home.php");
} else {
  echo "Wrong Username or Password";
} 
```

你能看到它说这条线上的准备是错误的吗

```
$statement = $db->prepare("SELECT * FROM users WHERE username = ? AND password = ? And mod = ?"); 
```

当我可以看到的代码没有任何问题时......

这是我的函数文件，其中包含 mysqlconnect

```
 function mysqlconnect(){
     global $db;
    $host = 'localhost';
    $port = 3306; // This is the default port for MySQL
    $database = '';
    $username = '';
    $password = '';

    // Construct the DSN, or "Data Source Name".  Really, it's just a fancy name
    // for a string that says what type of server we're connecting to, and how
    // to connect to it.  As long as the above is filled out, this line is all
    // you need :)
    $dsn = "mysql:host=$host;port=$port;dbname=$database";

    // Connect!
    $db = new PDO($dsn, $username, $password);

} 
```

我必须把我的连接信息拿出来让每个人都知道......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T15:44:38.740

声明时`$db = mysqlconnect();`，您希望`mysqlconnect()`返回一个 PDO 对象。将函数更改为此以使其工作：

```
function mysqlconnect(){
    $host = 'localhost';
    $port = 3306; // This is the default port for MySQL
    $database = '';
    $username = '';
    $password = '';

    // Construct the DSN, or "Data Source Name".  Really, it's just a fancy name
    // for a string that says what type of server we're connecting to, and how
    // to connect to it.  As long as the above is filled out, this line is all
    // you need :)
    $dsn = "mysql:host=$host;port=$port;dbname=$database";

    // Connect!
    $db = new PDO($dsn, $username, $password);

    // Return PDO object
    return $db;
} 
```

# jquery - 浏览器兼容性问题

> ID：10962177
> 
> 赞同：1
> 
> 时间：2012-06-09T15:21:40.127
> 
> 标签：jquery, html, css, webkit

如何让我的网站在所有网络浏览器中看起来都一样？我主要使用 Firefox，但我是一名新的网页设计师，我无法让我的网站在所有浏览器上看起来都一样。

我尝试使用谷歌搜索 webkits、jquery，但没有向我解释它是如何工作的。我还在学习jquery。我试图让我的标题导航栏和容器紧密结合在一起，就像我在 Firefox 中的代码一样。但在 Internet Explorer 9 中，它们之间的距离更远。我也试图让我的侧面容器更近，但在我正在查看的两个浏览器中它都不能正常工作。

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML    1.0                                        Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1- transitional.dtd">
              <html xmlns="http://www.w3.org/1999/xhtml">
             <head>
             <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
            <title>Untitled Document</title>
            <link href="template8.css" rel="stylesheet" type="text/css" />
            </head>

           <body style="background-attachment: fixed; background-repeat: no-repeat;"  background="Images/template8 bkg.jpg">
         <br />
         <br />

          <div id="header">
          <br />
          <br />
           <br />
           Floating Mountain Enterprise</div>
           </div>
           <div id="centeredmenu">
            <ul>
           <li><a href="portfolio.htm" class="active">Tab one</a></li>
         <li><a href="portfolio.htm">Tab two</a></li>
           <li><a href="portfolio.htm">Tab three</a></li>
         <li><a href="portfolio.htm">Tab four</a></li>
       </ul>
         <br />
          <br />
          <br />
         <br />
           <br />
          </div><!-- end header -->
          <div id="left"><center><br />
          <br />
          TEXT HERE<br />
           TEXT HERE<br />
           TEXT HERE<br />
            TEXT HERE<br />
           TEXT HERE<br />
            TEXT HERE<br />
            TEXT HERE</center></div>
            <div id="right"><center><br />
               <br />
            TEXT HERE<br />
            TEXT HERE<br />
           TEXT HERE<br />
           TEXT HERE<br />
           TEXT HERE<br />
           TEXT HERE<br />
           TEXT HERE</center></div>

         <div id="container">
          <div id="content">
              <h1>HEADER ONE</h1>  <!-- end h1 -->
          YOUR CONTENT HERE!

         <h2>Header Two</h2>
        <p>More content here. </p>
         <p>&nbsp;</p>
        <p>&nbsp;</p>
         <p>&nbsp;</p>
          <p>&nbsp;</p>
          <p>&nbsp;</p>
          <p>&nbsp;</p>
         <p>&nbsp;</p>
         <p>&nbsp;</p>
          <br />
          <br />

        </div>  <!-- end content -->
          </div>  <!-- end container -->

         </body>
          </html>

         CSS

         @charset "utf-8";
       /* CSS Document */

         html,body,div,ul,ol,li,dl,dt,dd,h1,h2,h3,h4,h5,h6,pre,form,p,blockquote,fieldset,input,hr                {margin:0; padding:0;}
          h1,h2,h3,h4,h5,h6,pre,code,address,caption,cite,code,em,strong,th {font-   size:1em; font-weight:normal; font-style:normal;}
         ul,ol {list-style:none;}
       fieldset,img,hr {border:none;}
       caption,th {text-align:left;}
         table {border-collapse:collapse; border-spacing:0;}
         td {vertical-align:top;}

       #header
        {     margin: 0px auto;
      text-align:center;
       font-size:x-large; font-weight:bold;
 width: 810px;
 height: 200px;
 background: url(Images/template8%20header.jpg);
 box-shadow: 15px 15px 5px #333;
 -moz-box-shadow: 10px 10px 5px #333;
 -webkit-box-shadow: 10px 10px 5px #333;
}

        #centeredmenu {
      float:left;
      width:100%;
        overflow:hidden;
       position:relative;
          }
    #centeredmenu ul {
      clear:left;
      float:left;
         list-style:none;
        margin:0;
        padding:0;
        position:relative;
       left:50%;
       text-align:center;
           }
     #centeredmenu ul li {
        display:block;
       float:left;
         list-style:none;
        margin:0;
        padding:0;
           position:relative;
         right:50%;
            }
       #centeredmenu ul li a {
        display:block;
        margin:0 0 0 5px;
        padding:3px 10px;
        background:#FFF;
        color:#000;
         text-decoration:none;
        line-height:1.3em;
       }
     #centeredmenu ul li a:hover {
       background: #999;
         color:#fff;
         }
       #centeredmenu ul li a.active,
       #centeredmenu ul li a.active:hover {
         color: #333;
         background:#000;
         font-weight:bold;
            }

       #container
        {     margin: 0px auto;
           padding-left:15px;
             margin-top:27px;
          width: 800px;
 height: auto;
 background: url(Images/container%20bkg.png);
 box-shadow: 15px 15px 5px #333;
 -moz-box-shadow: 10px 10px 5px #333;
 -webkit-box-shadow: 10px 10px 5px #333;}

        #content

     {     margin: 0px auto;
           padding-left:15px;
      width: 780px;
      padding-top:25px;
          height: auto;
font-family: "MS UI Gothic";
        font-style:oblique;
}

          #left * {
background-color: #999;
       -moz-opacity: 0.5 !important; -webkit-opacity: 0.5!important; -ms- filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=50)" !important; filter: alpha (opacity=50) !important; opacity: 0.5 !important;
      min-height: 400px;
      margin-left:35px;     
      float: left;     
      width: 150px;
        height: auto;
  box-shadow: 15px 15px 5px #666;
  -moz-box-shadow: 10px 10px 5px #666;
  -webkit-box-shadow: 10px 10px 5px #666; }

       #right *{
background-color:#999;
-moz-opacity: 0.5 !important; -webkit-opacity: 0.5!important; -ms- filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=50)" !important; filter: alpha (opacity=50) !important; opacity: 0.5 !important;
     margin-right:35px;    
          width: 150px;     
          min-height: 400px;     
           float: right;
     box-shadow: 15px 15px 5px #666;
     -moz-box-shadow: 10px 10px 5px #666;
     -webkit-box-shadow: 10px 10px 5px #666; } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T15:51:49.263

*在每个*浏览器上看起来*完全*一样听起来有点极端......

 ***在主流浏览器上**类似*（并且流畅）听起来更真实。*

 *通常认为，如果您没有 CSS3 中的“border-radius”或其他很酷的东西可以在“旧浏览器”（例如 IE7 或 IE8）中工作，那是因为您的访问者必须更新他的浏览器......

所以，至少设法为他提供你网站/应用程序的可用体验，如果他没有酷炫的 CSS3 边框半径/不透明度/阴影……效果等等，那真的没什么大不了的……如果他不更新他的浏览器，也许是因为他不太关心那种东西。

Now, if you want every major browser to look similar, you could use a CSS reset first ([this one](http://meyerweb.com/eric/tools/css/reset/) is a common one, there are some others), then adapt it to your needs. It will reset the default settings the browsers use to display HTML elements, which differ on some points from one to another.

Then, if you still want to be able to use the CSS3 effects anyway, you can use something like [PIE](http://css3pie.com/) (or similar) for your effects to work on old IEs (6, 7 and 8). But, think that it will have some performance impacts because it's emulating CSS3 features with javascript.**

# android - Android 从 AsyncTask 中执行方法

> ID：10962183
> 
> 赞同：0
> 
> 时间：2012-06-09T15:21:59.347
> 
> 标签：android, android-asynctask, loading

我创建了一个活动，它使用谷歌地图生成 UI 并显示用户位置，其开头为：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.map_display);

    Button myLocationBtn = (Button)findViewById(R.id.myLocationBtn);
    Button searchRequest = (Button)findViewById(R.id.searchRequest);
    locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
    myLocationBtn.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            touched = false;
            locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, locationListener);
        }
    });
    searchRequest.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            locationManager.removeUpdates(locationListener);
            onSearchRequested();
        }
    });
    initialiseMapView();
  } 
```

这个屏幕需要一段时间才能加载，我认为这是实际调用和运行地图信息并获取用户位置的结果，它在我的方法 initialiseMapView(); 中运行。所以我尝试如下引入AsyncTask：

```
private class loadMap extends AsyncTask<String, Integer, String>{

    @Override
    protected String doInBackground(String... params) {
        initialiseMapView();
        return null;
    }
} 
```

我在原始代码中所做的只是更改了 initialiseMapView(); 到新的 loadMap().execute();。每次我尝试运行此活动时应用程序都会崩溃，我相信这是因为 initialiseMapView 方法不在 loadMap 类中，但我不确定。

请帮忙 ：（

* * *

这是initialiseMapView方法：

```
private void initialiseMapView() {

      mapView = (MapView) findViewById(R.id.mapView);
      mapController = mapView.getController();

      locationListener = new GPSLocationListener();
      locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, locationListener);

      mapView.setBuiltInZoomControls(true);
      mapView.setSatellite(false);

      GeoPoint startPoint = new GeoPoint((int)(51.500152 * 1E6), (int)(-0.126236 * 1E6));
      mapController.setCenter(startPoint);

      mapController.setZoom(mapView.getZoomLevel());

      mapController.setZoom(14);

      mapFromQuery("london");

      mapView.invalidate();
  } 
```

如果无法做到这一点，是否有某种方法可以在内容加载时显示屏幕？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T15:25:39.390

你不能打电话

> 初始化地图视图（）；

在 doInBackground() 方法中，因为它运行在与 UI 线程不同的线程上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T18:46:39.450

为了扩展其他人所说的内容，您的 AsyncTask 子类应实现以下内容：

onPreExecute() 在后台任务开始之前在 UI 线程上执行。这可能是初始化地图视图的理想位置。

doInBackground() 在后台执行，不得尝试执行任何 UI 功能。这是拨打网络电话和下载地图数据的理想场所。

如果您想从后台任务更新您的 UI，请调用 publishProgress()，这将导致在 UI 线程中调用 onProgressUpdate()。

示例代码：

```
 class DownloadFilesTask extends AsyncTask<URL, Integer, Long> {
      protected Long doInBackground(URL... urls) {
      int count = urls.length;
      long totalSize = 0;
      for( int i = 0; i < count; ++i) {
          totalSize += Downloader.downloadFile(urls[i]);
          publishProgress((int)((i/(float)count)*100));
      }
      return totalSize;
      }

      protected void onProgressUpdate(Integer... progress) {
      setProgressPercent(progress[0]);
      }

      protected void onPostExecute(Long result) {
      showDialog("Downloaded " + result + " bytes");
      }
  }

  ...

  new DownloadFilesTask().execute(url1, url2, url3); 
```

ETA：还有几件事要考虑。每当您有一个线程在后台运行时，您都必须考虑前台任务随时可能消失的可能性。例如，如果用户在数据仍在加载时退出应用程序，或者用户甚至旋转设备。

如果您的 onProgressUpdate() 方法引用了 myMapView，请考虑 myMapView 可能不再是有效的 MapView 对象。（我假设 Android 框架知道忽略不再相关的 View 对象的更新，否则应用程序将到处失败。）

如果您的后台任务是 CPU 密集型的，您可以考虑调用 cancel()（例如在 onStop() 中）告诉后台任务放弃它的工作。或者更好的是，使用 onRetainNonConfigurationInstance() 将对后台线程的引用传递给应用程序的新实例，以便后台任务可以不间断地继续其工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T15:24:01.623

您不能`work related to UI`在 initialiseMapView 中执行任何操作，因为它是从 doInBackground 调用的，所以请确认相同............

# unit-testing - 为什么使用 mox 的失败测试也会失败其他测试？

> ID：10962196
> 
> 赞同：0
> 
> 时间：2012-06-09T15:24:31.093
> 
> 标签：unit-testing, mox

我的问题很简单：我有一堆使用 pymox 的单元测试。当我添加一个失败的新测试时，大多数时候很多其他测试也会失败。我怎样才能防止这种情况发生？

例如，我有一个简单的脚本，我有两个单元测试：

```
def test_main_returnsUnknown_ifCalculator_returnsMinus1(self):
    m=mox.Mox()
    m.StubOutWithMock(check_es_insert,"getArgs")
    check_es_insert.getArgs(\
        'Nagios plugin for checking the total number of documents stored in Elasticsearch')\
        .AndReturn({ 'critical' : 7, 'warning' : 5, 'address' : 'myhost:1234', 'file' : '/tmp/bla'})
    ################
    #some other mocking here, not relevant, I think
    ################
    m.ReplayAll()
    #now let's test
    check_es_docs.main()
    #verify and cleanup
    m.UnsetStubs()
    m.VerifyAll()
    m.ResetAll()
def test_main_doesWhatPrintAndExitSays_inNormalConditions(self):
    m=mox.Mox()
    m.StubOutWithMock(check_es_insert,"getArgs")
    check_es_insert.getArgs(\
        'Nagios plugin for checking the total number of documents stored in Elasticsearch')\
        .AndReturn({ 'critical' : 7, 'warning' : 5, 'address' : 'myhost:1234', 'file' : '/tmp/bla'})
    ################
    #some other mocking here, not relevant, I think
    ################
    m.ReplayAll()
    #now let's test
    check_es_docs.main()
    #verify and clean up
    m.UnsetStubs()
    m.VerifyAll()
    m.ResetAll() 
```

通常，两个测试都通过，但如果我在第二次测试中偷偷输入错字，我会在运行测试时得到以下输出：

```
$ ./check_es_docs.test.py
FE
======================================================================
ERROR: test_main_returnsUnknown_ifCalculator_returnsMinus1 (__main__.Main)
If it can't get the current value from ES, print an error message and exit 3
----------------------------------------------------------------------
Traceback (most recent call last):
  File "./check_es_docs.test.py", line 13, in test_main_returnsUnknown_ifCalculator_returnsMinus1
    m.StubOutWithMock(check_es_insert,"getArgs")
  File "/usr/local/lib/python2.7/dist-packages/mox-0.5.3-py2.7.egg/mox.py", line 312, in StubOutWithMock
    raise TypeError('Cannot mock a MockAnything! Did you remember to '
TypeError: Cannot mock a MockAnything! Did you remember to call UnsetStubs in your previous test?

======================================================================
FAIL: test_main_doesWhatPrintAndExitSays_inNormalConditions (__main__.Main)
If getCurrent returns a positive value, main() should print the text and exit with the code Calculator.printandexit() says
----------------------------------------------------------------------
Traceback (most recent call last):
  File "./check_es_docs.test.py", line 69, in test_main_doesWhatPrintAndExitSays_inNormalConditions
    check_es_docs.main()
  File "/home/radu/check_es_docs.py", line 25, in main
    check_es_insert.printer("Total number of documents in Elasticsearch is %d | 'es_docs'=%d;%d;%d;;" % (result,result,cmdline['warning'],cmdline['critical']))
  File "/usr/local/lib/python2.7/dist-packages/mox-0.5.3-py2.7.egg/mox.py", line 765, in __call__
    return mock_method(*params, **named_params)
  File "/usr/local/lib/python2.7/dist-packages/mox-0.5.3-py2.7.egg/mox.py", line 1002, in __call__
    expected_method = self._VerifyMethodCall()
  File "/usr/local/lib/python2.7/dist-packages/mox-0.5.3-py2.7.egg/mox.py", line 1060, in _VerifyMethodCall
    raise UnexpectedMethodCallError(self, expected)
UnexpectedMethodCallError: Unexpected method call.  unexpected:-  expected:+
- printer.__call__("Total number of documents in Elasticsearch is 3 | 'es_docs'=3;5;7;;") -> None
?                           -

+ printer.__call__("Total nuber of documents in Elasticsearch is 3 | 'es_docs'=3;5;7;;") -> None

----------------------------------------------------------------------
Ran 2 tests in 0.002s

FAILED (failures=1, errors=1) 
```

第一个测试应该没有错误地通过，因为它没有改变一点。check_es_insert.getArgs() 不应该是 MockAnything 实例，而且我没有忘记调用 UnsetStubs。我已经搜索了很多，但没有找到其他有同样问题的人。所以我想我错过了一些非常明显的东西......

附加信息：

*   check_es_docs 是我正在测试的脚本
*   check_es_insert 是另一个我从中导入很多东西的脚本
*   我尝试将 UnsetStubs() 放在 VerifyAll() 之后，结果相同
*   我尝试从 SetUp 方法初始化 mox.Mox() 对象，并将清理内容放入 TearDown，结果相同

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T18:53:29.010

我建议将所有测试放入扩展 TestCase 的测试类中，然后在 tearDown 方法中添加 UnsetStubs：

```
from unittest import TestCase
import mox

class MyTestCasee(TestCase):
  def __init__(self, testCaseName):
    self.m = mox.Mox()
    TestCase.__init__(self, testCaseName)

  def tearDown(self):
    self.m.UnsetStubs()

def test_main_returnsUnknown_ifCalculator_returnsMinus1(self):
  self.m.StubOutWithMock(check_es_insert,"getArgs")
  check_es_insert.getArgs(\
    'Nagios plugin for checking the total number of documents stored in Elasticsearch')\
    .AndReturn({ 'critical' : 7, 'warning' : 5, 'address' : 'myhost:1234', 'file' : '/tmp/bla'})
  ################
  #some other mocking here, not relevant, I think
  ################
  self.m.ReplayAll()
  #now let's test
  check_es_docs.main()
  #verify and cleanup
  self.m.VerifyAll()

def test_main_doesWhatPrintAndExitSays_inNormalConditions(self):
  self.m.StubOutWithMock(check_es_insert,"getArgs")
  check_es_insert.getArgs(\
      'Nagios plugin for checking the total number of documents stored in Elasticsearch')\
      .AndReturn({ 'critical' : 7, 'warning' : 5, 'address' : 'myhost:1234', 'file' : '/tmp/bla'})
  ################
  #some other mocking here, not relevant, I think
  ################
  self.m.ReplayAll()
  #now let's test
  check_es_docs.main()
  #verify and clean up
  self.m.VerifyAll()
  self.m.ResetAll() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-30T15:50:27.607

您也可以使用`mox.MoxTestBase`，它设置 self.mox 并在 tearDown 上调用 VerifyAll()。

```
class ClassTestTest(mox.MoxTestBase):
  def test():
    m = self.mox.CreateMockAnything()

    m.something()
    self.mox.ReplayAll()
    m.something() # If this line is removed the test will fail 
```

# python - 如何判断函数和类实例方法是否相同？

> ID：10962199
> 
> 赞同：1
> 
> 时间：2012-06-09T15:24:37.583
> 
> 标签：python, metaprogramming

如何判断类实例方法和函数是否相同？

我有一个使用装饰器的简单类：

```
@decorate_class
class Hello:

    @decorate_func
    def world(self):
        return 
```

这些是我的装饰器：

```
# A global variable
global_func = None

def decorate_func(func):
    global_func = func
    return func

def decorate_class(clazz):
    print clazz.__dict__["world"] == global_func
    return clazz 
```

以上返回`False`，可能是因为`type(func)`in `decorate_func`is `function`，但 in `decorate_class`it is `instancemethod`。但是打印它们都给了我：

```
<function world at 0x7f490e59ce60> 
```

如，相同的内存地址。我如何比较它们以知道它们是相同的功能？通过内存地址进行比较是否安全（且正确）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T15:36:00.167

您的问题实际上是您对`global_func`.

如果您更改`decorate_class`为：

```
def decorate_class(clazz):
    print global_func, clazz.__dict__["world"] == global_func
    return clazz 
```

你会看到那`global_func`是`None`.

要解决此问题，请显式声明`global_func`如下：`global``decorate_func`

```
def decorate_func(func):
    global global_func
    global_func = func
    return func 
```

一切都会奏效。

这（基本上）是因为 Python 假定，如果您在函数中分配一个变量，则该变量被假定为该函数的局部变量，除非它被显式声明为全局变量。

# multithreading - 如何中断执行阻塞套接字连接的线程？

> ID：10962202
> 
> 赞同：6
> 
> 时间：2012-06-09T15:24:56.697
> 
> 标签：multithreading, sockets, interrupt, system-calls

我有一些代码会生成一个`pthread`尝试维护与远程主机的套接字连接的代码。如果连接丢失，它会尝试`connect()`在其套接字上使用阻塞调用重新连接。由于代码在单独的线程中运行，我并不真正关心它使用同步套接字 API 的事实。

也就是说，直到我的应用程序退出的时候。我想执行一些类似的有序关闭，所以我使用线程同步原语来唤醒线程并发出信号让它退出，然后`pthread_join()`在线程上执行 a 以等待它完成。`connect()`这很好用，除非当我命令关闭时线程处于调用中间。在这种情况下，我必须等待连接超时，这可能需要很长时间。这使得应用程序似乎需要很长时间才能关闭。

我想做的是以`connect()`某种方式中断对的呼叫。调用返回后，线程会注意到我的退出信号并干净地关闭。由于`connect()`是系统调用，我认为我可以使用信号故意中断它（从而使调用返回`EINTR`），但我不确定这是否是 POSIX 线程环境中的稳健方法。

有没有人对如何做到这一点有任何建议，无论是使用信号还是通过其他方法？请注意，`connect()`在一些我无法修改的库代码中调用已关闭，因此不能选择更改为非阻塞套接字。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-09T16:29:03.093

尝试*close()*套接字以中断*connect()*。我不确定，但我认为它至少可以在 Linux 上运行。当然，请注意正确同步，以便您只*关闭（）*此套接字一次，或者第二次*关闭（）*理论上可以关闭刚刚打开的不相关文件描述符。

**编辑**：*shutdown* () 可能更合适，因为它实际上并没有关闭套接字。

或者，您可能想看看[pthread_cancel()](http://www.kernel.org/doc/man-pages/online/pages/man3/pthread_cancel.3.html)和[pthread_kill()](http://www.kernel.org/doc/man-pages/online/pages/man3/pthread_kill.3.html)。但是，我看不到在没有竞争条件的情况下使用这两者的方法。

我建议您放弃多线程服务器方法，转而使用事件驱动，例如使用[epoll](http://linux.die.net/man/4/epoll)进行事件通知。通过这种方式，您可以避免所有这些非常基本的问题，这些问题对于线程来说变得非常困难，例如正确关闭。您可以随时自由地做任何您想做的事情，例如安全地关闭套接字并且再也不会收到他们的消息。

另一方面，如果在您的工作线程中执行非阻塞*connect()*并通过 epoll_pwait() （或 ppoll( *)*或*pselect()*；注意*p*）获得通知，您可能能够避免相关的竞争条件与信号。

# android - Android AlarmManager 重调度逻辑

> ID：10962204
> 
> 赞同：2
> 
> 时间：2012-06-09T15:25:02.153
> 
> 标签：android, logic, alarmmanager

我有一个应用程序，它允许用户安排闹钟在特定时间响起，并在他们选择的时间间隔内重复。我使用 JSON 来保存警报详细信息，使用 SharedPreferences 作为存储。

我正在使用 AlarmManager 安排何时应通知我的应用程序应发出警报以通知用户。我目前正在使用 AlarmManager 的 setRepeating() 方法，提供用户提供的间隔。这很好用，理论上应用程序永远不需要更新存储下一个闹钟时间的 JSon，因为 AlarmManager 只会使用间隔重新安排下一个闹钟时间。

但是，我的想法是，当设备重新启动时，我*需要*向 AlarmManager 提供最新的警报时间，以避免 AlarmManager 认为错过了警报，因为不一定是这种情况。

那么，最好的方法是什么？

*   当警报响起时更新 JSon 下一个警报时间，即使这可能不是必需的（只要没有重新启动，setRepeating() 就会处理这个）？
*   注册并收听关机广播，然后更新 JSon（这引发了一些问题 - 考虑到手机正在关机，应用程序将计算多长时间并将警报详细信息写入存储）？
*   不要更新 JSon，而是向 AlarmManager*唤醒*的对象添加逻辑，以确定刚刚广播的警报是否有效并且应该提醒用户？

我确信上述任何方法都可以，但我无法决定哪种方法最好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T20:22:04.573

这似乎主要是一个选择问题。您注意到的问题与在 Linux 笔记本电脑中看到并由 anachrond 解决的一般问题相似。在我看来，每次收到事件时，我都会简单地更新时间并将其存储在 SharedPreferences 中。尝试监听系统何时关闭可能并不完全可靠（当您的用户（可能是醉酒的大学生）放下设备并且电池耗尽时会发生什么？）。相反，我认为在这种情况下最好的做法是——每次警报触发时——重新计算发送下一个警报的时间，将其存储在某个地方，并根据启动计划进行适当的启动。

# google-app-engine - appengine 执行多少次写入来更新现有实体的列表属性？

> ID：10962207
> 
> 赞同：1
> 
> 时间：2012-06-09T15:25:34.390
> 
> 标签：google-app-engine, google-cloud-datastore

根据[https://developers.google.com/appengine/docs/billing](https://developers.google.com/appengine/docs/billing) “现有实体放置（每个实体）需要 1 次写入 + 每个修改后的索引属性值 4 次写入 + 每个修改后的复合索引值 2 次写入”

因此，当我将一个新元素插入到 1000 个元素的列表属性并将其放回时，将需要对该属性进行 4004 次写入。它是否正确？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T16:00:52.663

对，那是正确的。每个列表属性值都有自己的索引条目。

# jboss - 如何在 Jboss 7 的应用程序客户端容器中 jun 一个 jar 文件？

> ID：10962209
> 
> 赞同：4
> 
> 时间：2012-06-09T15:25:49.047
> 
> 标签：jboss, ejb, ejb-3.0, jboss7.x

我需要运行包含一些会话 bean 的 jar 文件。在 EJB 3 书中，我看到我们可以使用 glassfish 运行一个主类，如下所示。

appclient -client 示例-client.jar

JBoss 7 我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:28:48.657

它在 JBoss AS 7 中非常相似。应该类似于`appclient.sh example-client.jar`. [appclient 文档](https://docs.jboss.org/author/display/AS71/Application+Client+Reference)看起来并不完整，但有一些特定于 JBoss AS 7 的信息。

# git - Git（1.7.10）每次都询问我用户名和密码

> ID：10962222
> 
> 赞同：8
> 
> 时间：2012-06-09T15:28:01.513
> 
> 标签：git, version-control, github, ssh, credentials

由于我有新版本，它不再询问我在 ssh 密钥文件中设置的密码。

当我每次推送时，它现在直接询问 github 用户名和密码。

这是 git 的一个新特性还是过去改变了它，或者 github 上有什么改变了？

我尝试使用 ssh 以及 ssh 密钥文件中的电子邮件和密码进行身份验证，并且成功了。

GitHub 更改为 smartftp 并更改了设置 repos 的说明

[https://github.com/blog/1104-credential-caching-for-wrist-friendly-git-usage](https://github.com/blog/1104-credential-caching-for-wrist-friendly-git-usage)

[https://help.github.com/articles/create-a-repo](https://help.github.com/articles/create-a-repo)

后来看到了，他们现在默认使用https而不是git协议

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T15:39:06.040

前几天我从 GitHub 上的新存储库说明中剪切和粘贴时遇到了这个问题。有人可能应该提交错误报告，因为它几乎让我认识的每个人都感到困惑。

问题是说明告诉您创建一个使用 https 协议而不是 git 协议的远程。我通常使用：

```
github_username=CodeGnome
git remote add origin "git@github.com:${github_username}/${PWD##*/}.git"
git push --tags --set-upstream origin master 
```

从预先存在的本地存储库中填充新的 GitHub 存储库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-04-04T14:42:44.623

```
git config --global credential.helper cache
git config --global credential.helper 'cache --timeout=3600' 
```

首次推送时只需输入用户名和密码；3600秒或1小时后，您无需用户名和密码即可推送。

超时你可以设置你的号码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-09T16:34:56.323

使用 https 地址，您还有另一个选择（除了[密码缓存](https://help.github.com/articles/set-up-git)）：在您的（或用于 bash 会话）中
使用`_netrc`包含您的用户名和密码的文件。 请注意，默认情况下没有为 Windows 定义 HOME。`HOME``.netrc`

```
machine github.com
login <login_github>
password <password_github> 
```

另请参阅“ [Git - 如何`.netrc`在 Windows 上使用文件来保存用户和密码](https://stackoverflow.com/questions/6031214/git-how-to-use-netrc-file-on-windows-to-save-user-and-password/6031266#6031266)”。

（“[与 github 同步](https://stackoverflow.com/questions/5377703/syncing-with-github/5378094#5378094)”中的其他选项）

# web-services - 允许代表用户发布 wordpress 博客的 API？

> ID：10962224
> 
> 赞同：0
> 
> 时间：2012-06-09T15:28:31.347
> 
> 标签：web-services, wordpress

这样的事情存在吗？我一直在寻找，但到目前为止都是空的。如果不是 Wordpress，也许 Blogger 等也存在类似的 api？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T16:32:20.533

Wordpress 具有[XML-RPC api](http://codex.wordpress.org/XML-RPC_Support)，允许外部应用程序发布到您的 Wordpress 博客。许多应用程序都使用它，例如用于 iPad 的官方 Wordpress 博客应用程序。

注意：默认情况下它是关闭的，您必须在“设置”中启用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-08T17:59:52.193

根据您的工作，还有一个[基于 REST 的 JSON API，适用于 WordPress.COM](http://developer.wordpress.com/docs/api/)和支持[Jetpack](http://jetpack.me)的自托管博客。

# c# - 如果值有效，如何保持掩码字符显示，如果没有输入值，如何去除掩码字符

> ID：10962225
> 
> 赞同：0
> 
> 时间：2012-06-09T15:28:42.840
> 
> 标签：c#, asp.net, asp.net-ajax, ajaxcontroltoolkit

当 MaskedEditExtender 的输入文本没有聚焦时，如果值有效，我想保持掩码字符显示，如果没有输入值，我想删除掩码字符。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T17:22:52.360

If it's for a text box, you can use the OnClick Event to dynamically generate the MaskedEditExtender, and then the OnTextChanged event to check if there is an input value still. If there is then you keep the control, if not then you remove it.

# opencv - 理解opencv的warpperspective和warpaffine的最佳方式是什么？

> ID：10962228
> 
> 赞同：10
> 
> 时间：2012-06-09T15:29:01.013
> 
> 标签：opencv, computer-vision

我正在尝试转换静态图像以产生从不同角度拍摄的错觉。看起来`warpPerspective`和`warpAffine`是我应该理解的功能才能完成这项工作。然而，即使在阅读了 OpenCV 文档之后，我也很难理解它们。

我应该阅读哪些教程/文档可以很好地解释它们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T17:21:54.290

你没有提到你使用的语言。

1.  OpenCV 文档对这些功能进行了图解说明，这非常好。

2.  除此之外，OpenCV 还提供了一个使用 C++ 代码的教程。:[仿射变换](http://docs.opencv.org/doc/tutorials/imgproc/imgtrans/warp_affine/warp_affine.html#warp-affine)

    （如果您使用 Python，请在此处找到：[仿射变换](https://github.com/abidrahmank/OpenCV2-Python/blob/master/Official_Tutorial_Python_Codes/3_imgproc/geometric_transform.py)）

3.  如果您愿意，Gary Bradsky 的书“Learning OpenCV”在第 163 页对此进行了很好的解释。您可以从“ [Google Books](http://books.google.co.in/books?id=seAgiOfu2EIC&printsec=frontcover&dq=learning%20opencv&hl=en&sa=X&ei=RYbTT8r6FIrqrQeptYj8Dw&redir_esc=y#v=onepage&q=learning%20opencv&f=false) ”中阅读

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-09T17:40:01.427

warpPerspective 进行射影变换或单应性：

[http://en.wikipedia.org/wiki/Homography](http://en.wikipedia.org/wiki/Homography)

warpAffine 进行仿射变换：

[http://en.wikipedia.org/wiki/Affine_transformation](http://en.wikipedia.org/wiki/Affine_transformation)

Abid Rahman，已经提到了一本好书。如果你想要一个更理论的，[多视图几何](http://www.amazon.co.uk/Multiple-View-Geometry-Computer-Vision/dp/0521540518/ref=sr_1_1?ie=UTF8&qid=1339263505&sr=8-1)被认为是这些主题的圣经。

# java - WaveFront .obj 文件 - “f”命令有什么作用？

> ID：10962232
> 
> 赞同：2
> 
> 时间：2012-06-09T15:30:07.257
> 
> 标签：java, wavefront

我一直在阅读David Brackeen 的*用 Java 开发游戏。*直到现在我都明白了书中的一切。在 Wavefront 对象文件中，我了解该`v`命令的作用，但我不了解该`f`命令。例如：

```
# OBJ - Wavefront object file
# The javagamebook loader only understands these commands:
#   mtllib <filename>    - Load materials from an external .mtl
#                          file.
#   v <x> <y> <z>        - Define a vertex with floating-point
#                          coords (x,y,z).
#   f <v1> <v2> <v3> ... - Define a new face. a face is a flat,
#                          convex polygon with vertices in
#                          counter-clockwise order. Positive
#                          numbers indicate the index of the
#                          vertex that is defined in the file.
#                          Negative numbers indicate the vertex
#                          defined relative to last vertex read.
#                          For example, 1 indicates the first
#                          vertex in the file, -1 means the last
#                          vertex read, and -2 is the vertex
#                          before that.
#   g <name>             - Define a new group by name. The faces
#                          following are added to this group.
#   usemtl <name>        - Use the named material (loaded from a
#                          .mtl file) for the faces in this group.

# load materials
mtllib textures.mtl

# define vertices
v 16 32 16
v 16 32 -16
v 16 0 16
v 16 0 -16
v -16 32 16
v -16 32 -16
v -16 0 16
v -16 0 -16

g myCube
usemtl wall1
f 1 3 4 2
f 6 8 7 5
f 2 6 5 1
f 3 7 8 4
f 1 5 7 3
f 4 8 6 2 
```

`f`命令在这里做什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T16:11:05.357

立方体有八个角（由顶点或点表示），由 v 定义（v 表示顶点）面 (f) 是由角的坐标 (v) 定义的表面，有关说明，请参见[Polygon_mesh](http://en.wikipedia.org/wiki/Polygon_mesh)。

```
 v1+-----------+  v2
     /            /
    /     f1     /
   /            /
v4+------------+v3
  |            |
  |            |
  |     f2     |
  |            |
  |            |
v6+------------+v5 
```

这意味着面 f1 是由 v1,v2,v3 和 v4 定义的；f2 由 v4、v3、v5、v6。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-09T16:19:08.893

表示模型的`f`一个面（例如，三角形或四边形）。这些数字是顶点列表中的索引，指示您应该将其连接以形成面的方式。

在发布的 obj 文件中，`f`您找到的第一个表示该面由具有顶点 #1、#3、#4 和 #2 的四边形（因为有 4 个顶点）组成。

重要提示：您应该以指定的顺序连接顶点，以避免以后法线计算出现问题和/或非多边形（自相交）形状出现问题。

# c# - 如何在pdf文件中找到空白页

> ID：10962235
> 
> 赞同：8
> 
> 时间：2012-06-09T15:30:32.233
> 
> 标签：c#, .net, pdf, itextsharp, pdf-parsing

我无法检测到 pdf 文件中的空白页。我已经在互联网上搜索了它，但找不到一个好的解决方案。

> 使用 Itextsharp 我尝试了页面大小，Xobjects。但他们没有给出确切的结果。

我试过了

```
if(xobjects==null || textcontent==null || size <20 bytes )
  then "blank"
else
 not blank 
```

但它返回错误答案的最长时间。我用过**Itextsharp**

代码如下...我正在使用**Itextsharp**库

**对于 xobjects**

```
PdfDictionary xobjects = resourceDic.GetAsDict(PdfName.XOBJECT);
//here resourceDic is PdfDictionary type
//I know that if Xobjects is null then page is blank. But sometimes blank page gives xobjects which is not null. 
```

**对于内容流**

```
 RandomAccessFileOrArray f = reader.SafeFile;
 //here reader = new PdfReader(filename);

 byte[] contentBytes = reader.GetPageContent(pageNum, f);
 //I have measured the size of contentbytes but sometimes it gives more than 20 bytes for   blank page 
```

**对于文本内容**

```
String extractedText = PdfTextExtractor.GetTextFromPage(reader, pageNum, new LocationTextExtractionStrategy());
  // sometimes blank page give a text more than 20 char length . 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T14:09:57.387

A very simple way to discover empty pages is this: use a Ghostscript commandline that calls the `bbox` device.

Ghostscript's bbox calculates the coordinates of that minimum rectangle *'bounding box'* which encloses all points of the page where a pixel would be rendered:

```
gs \
  -o /dev/null \
  -sDEVICE=bbox \
   input.pdf 
```

On Windows:

```
gswin32c.exe ^
  -o nul ^
  -sDEVICE=bbox ^
   input.pdf 
```

Result:

```
GPL Ghostscript 9.05 (2012-02-08)
Copyright (C) 2010 Artifex Software, Inc.  All rights reserved.
This software comes with NO WARRANTY: see the file PUBLIC for details.
Processing pages 1 through 6.
Page 1
%%BoundingBox: 27 281 548 804
%%HiResBoundingBox: 27.000000 281.000000 547.332031 804.000000
Page 2
%%BoundingBox: 0 0 0 0
%%HiResBoundingBox: 0.000000 0.000000 0.000000 0.000000
Page 3
%%BoundingBox: 27 302 568 814
%%HiResBoundingBox: 27.949219 302.000000 567.332031 814.000000
Page 4
%%BoundingBox: 27 302 568 814
%%HiResBoundingBox: 27.949219 302.000000 567.332031 814.000000
Page 5
%%BoundingBox: 27 302 568 814
%%HiResBoundingBox: 27.949219 302.000000 567.332031 814.000000
Page 6
%%BoundingBox: 27 302 568 814
%%HiResBoundingBox: 27.949219 302.000000 567.332031 814.000000 
```

As you can see, page 2 of my input document was empty.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T13:24:22.813

我怀疑你已经在你的字符串上尝试过 .Trim() ，所以我不会单独建议它。

空白中 20+ 字符长度字符串的实际内容是什么？我怀疑这只是换行符（就像人们按`enter`10 次以上只是为了获取新页面而不是插入分页符时会发生什么），在这种情况下：

```
String extractedText = 
    string.Replace(string.Replace(
        PdfTextExtractor.GetTextFromPage(reader, pageNum, new LocationTextExtractionStrategy())
    , Environment.NewLine, ""), "\n", "").Trim(); 
```

让我们知道这之后的输出内容是什么。

另一种可能性是它是带有不间断空格和其他实际上不是空格的字符的空白文本，您需要手动查找和替换这些字符。此时我建议您实际上只使用正则表达式匹配[0-9,az,AZ] 并使用它来确定您的页面是否为空白。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-10T17:01:46.150

有一个用于 C# 和 VB.NET 的包装库，来自`mupdf c++ library`. 您可以使用它将页面转换为`bmp`（以不同格式，，，`tif`）`jpg`并`png`检查位图的大小。

您应该检查哪个是您将视为空白的页面的最小字符的最小尺寸。

# c++ - 在 C++ 中何时使用指针？

> ID：10962239
> 
> 赞同：-2
> 
> 时间：2012-06-09T15:31:01.497
> 
> 标签：c++, pointers

在 C++ 中，我有两个这样的代码块：

```
Base *base = new Base();
base->showName(); 
```

和：

```
Base base;
base.showName(); 
```

我不知道我们什么时候使用指针，什么时候不使用？有什么不同，什么更好？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-09T15:32:57.347

您显示的第一个代码是内存泄漏。

~~第二个片段是 Java，而不是 C++。~~该问题已被编辑为使用我建议的代码。

一般来说，在 C++ 中你应该避免`new`，除非你真的需要动态生命周期。相反，写：

```
Base base;
base.showName(); 
```

这更好，因为

*   它更快，不需要堆分配。
*   您不必记住释放内存，编译器会在作用域结束时自动执行此操作。
*   它是自动异常安全的。在堆栈展开期间，将调用析构函数并回收内存。

如果对象需要超出范围的末尾，您应该使用：

```
unique_ptr<Base> base(new Base());
base->showName(); 
```

Now`unique_ptr`将在`unique_ptr`死亡时为您释放内存，并且它也是异常安全的。当您返回 a`unique_ptr`时，所有权将转移给调用者，他可以获得自动清理的好处。

# iphone - IPHONE api 演示

> ID：10962244
> 
> 赞同：1
> 
> 时间：2012-06-09T15:31:42.167
> 
> 标签：iphone

Android 有一个 API 演示，您可以直接将其安装到 Android 设备上，并查看小部件、按钮和所有其他玩具的工作原理。很高兴看到有什么可用的。IPHONE 我需要同样的东西，但我无法在搜索引擎查询下找到它。谁能指出我在哪里？

顺便说一句：我在此站点上找到了指向 android API 演示的链接，但我找不到该链接，但该 apk 应用程序的标题为 android 的“API 演示”，我认为它来自 Android 开发人员站点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T15:38:08.617

[在http://developer.apple.com/](http://developer.apple.com/)有大量示例代码，部分“<a href="https://developer.apple.com/library/ios/navigation/index.html?section=Resource%20Types&topic= Sample%20Code" rel="nofollow">示例代码"。你可能想看看[UICatalog](https://developer.apple.com/library/ios/#samplecode/UICatalog/Introduction/Intro.html#//apple_ref/doc/uid/DTS40007710)，这就是你要找的。

但是，没有包含所有内容的“上帝应用程序”。

# php - 在 Facebook 上检索用户的前 10 位朋友（获取他们的 UID） PHP、Facebook API

> ID：10962247
> 
> 赞同：1
> 
> 时间：2012-06-09T15:32:05.897
> 
> 标签：php, facebook, facebook-graph-api, facebook-php-sdk

**如何获取用户的前 10 位好友的 uid**，并用指定的字符串包装每个 uid？

来自：[获取 facebook 应用程序的顶级朋友列表](https://stackoverflow.com/q/9407379/1399030)，我看到了这个：

```
$statuses = $facebook->api('/me/statuses');

foreach($statuses['data'] as $status){
// processing likes array for calculating fanbase. 

        foreach($status['likes']['data'] as $likesData){
            $frid = $likesData['id']; 
            $frname = $likesData['name']; 
            $friendArray[$frid] = $frname;
        }

 foreach($status['comments']['data'] as $comArray){
 // processing comments array for calculating fanbase
            $frid = $comArray['from']['id'];
            $frname = $comArray['from']['name'];

} 
```

但这会返回什么？它是否在数组中返回朋友的用户 ID？我想把它放在一个数组中，即搜索的结果，所以我可以使用 foreach 包装每个 ID 并用它做我想做的事。

如果上面的代码足够了，我应该调用`$frid`顶级朋友的数组吗？我只需要理解。**:o)**

感谢您的时间。

* * *

**假设已授予权限。**
（这仅在用户允许权限后才会发生，因此假设我们已经拥有该权限。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T20:23:53.460

前往[https://github.com/facebook/facebook-php-sdk/zipball/master确保您拥有最新的 SDK](https://github.com/facebook/facebook-php-sdk/zipball/master)

解压缩，你有一个如下所示的布局

```
/facebook-php-sdk
index.php 
```

其中 index.php 与正在使用的文件一起显示在浏览器中的好友数量

在 PHP 文件的开头包含 SDK

```
require('sdk/src/facebook.php'); 
```

转到[https://developers.facebook.com/apps](https://developers.facebook.com/apps)，选择您的应用并获取您的 App ID 和 App Secret，在 PHP 文件中创建一个实例

```
$facebook = new Facebook(array(
  'appId'  => 'YOUR_APP_ID_HERE',
  'secret' => 'YOUR_SECRET_HERE',
)); 
```

然后检索`$user`数据，这样我们就知道当前用户是经过身份验证的

```
$user = $facebook->getUser(); 
```

在发送任何呼叫之前检查身份验证是否正确

```
if ($user) {
  try {
    $user_profile = $facebook->api('/me');
  } catch (FacebookApiException $e) {
    error_log($e);
    $user = null;
  }
} 
```

[现在可以在https://developers.facebook.com/docs/reference/api/user/#statuses](https://developers.facebook.com/docs/reference/api/user/#statuses)上调用`/me/statuses`文档

```
$statuses = $facebook->api('/me/statuses'); 
```

[这应该返回在http://developers.facebook.com/docs/reference/api/status/](http://developers.facebook.com/docs/reference/api/status/)中定义的所有当前用户状态消息的结构状态消息数组。

现在你需要决定什么决定了顶级朋友

*   点赞数+评论数
*   评论数
*   点赞数

让我们选择选项1，并给每个权重1。即一个like和一个comment在确定朋友数量时是等价的

所以创建一个变量来保存它，例如 $friendArray

然后对所有状态消息进行迭代，但整个 JSON 响应以包装的开头`data`

```
{
  "data": [ 
```

所以访问`$statuses['data']`，foreach 会将所有状态消息作为一个`status`项目提供

```
foreach($statuses['data'] as $status){ 
```

在此循环中迭代所有喜欢并增加出现的每个 id 的值

```
foreach($status['likes']['data'] as $likesData){
    $frid = $likesData['id']; 
    $friendArray[$frid] = $friendArray[$frid] + 1;
} 
```

在此循环中迭代所有评论并增加出现的每个 id 的值

```
foreach($status['comments']['data'] as $comArray){
    $frid = $comArray['from']['id'];
    $friendArray[$frid] = $friendArray[$frid] + 1;
} 
```

在外循环结束时，您应该有一个包含分数`foreach($statuses['data'] as $status){`的数组。`$friendArray`

调用`asort` [http://www.php.net/manual/en/function.asort.php](http://www.php.net/manual/en/function.asort.php)对数组进行排序，然后您可以循环获取前 x 分数。

您显示的代码不是函数，实际上缺少右括号，它实际上没有返回任何内容，因为它不是函数。

**注意事项**：`/me/statuses`每次调用只返回一组有限的状态消息，您需要获取`previous`页面调用以迭代*所有*消息。返回的顶级朋友只是基于我上面提出的限制。

# sql-server - sys.dm_os_wait_stats 中的“杂项”是什么？

> ID：10962248
> 
> 赞同：2
> 
> 时间：2012-06-09T15:32:13.520
> 
> 标签：sql-server, tsql, sql-server-2005

检查`sys.dm_os_wait_stats`对我来说是这样的：

![在此处输入图像描述](../Images/03aaead8121eea889fc6c08ff0874f3a.png)

**是什么`MISCELLANEOUS`意思？**[文档](http://msdn.microsoft.com/en-us/library/ms179984.aspx)什么也没说。等待统计信息刚刚被清除。`MISCELLANEOUS`随着时间的推移稳步增加。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T15:38:33.697

您*可能*可以忽略它。如果这是您的首要等待之一，那么您的系统很可能运行良好（以下例外）。

从[SQL Server 等待类型存储库](http://blogs.msdn.com/b/psssql/archive/2009/11/03/the-sql-server-wait-type-repository.aspx)...

> 这真的应该被称为“不等待”。
> 
> 这可能已在 SQL 2000 中使用，但对于 2005/2008，它不用于任何有效等待。它只是列表中的默认等待，不用于指示任何真正的等待。此类型在 SQL 2008 的 sys.dm_os_wait_stats 中出现两次，但“其他”实例是代码中较旧的未使用等待类型。我们应该能够删除它。

另一方面，如果你正在使用`NEWSEQUENTIALID()`或 CLR，你可能还需要注意这个注释，来自已故的 Ken Henderson 的[SQL Server 2005 Waiting and Blocking Issues](http://www.informit.com/articles/article.aspx?p=686168&seqNum=5)：

> 在 SQL Server 2005 中，这些异常情况中的大多数已转换为更具描述性的等待类型，但仍有一些被归类为 MISCELLANEOUS 等待类型。其中，有两个值得一提。第一个是 NEWSEQUENTIALID 内置函数的同步。另一个是 CLR 程序集加载的同步。因为这些用法在 MISCELLANEOUS 存储桶中彼此聚集在一起，所以如果不检查会话正在执行的语句，就不可能区分它们。

这篇文章有点老，所以可能是 CSS 博客文章了解了在服务包或 2008+ 中发生的变化，而 Ken 在其他时间根本没有掌握（换句话说，这可能不一定是对于您正在运行的 SQL Server 2005 的构建不再适用）。

由于等待类型的文档并不完整，因此尚不清楚何时以及如何将某些等待类型从该存储桶中提升出来，但我认为很明显，随着时间的推移，这里捕获的“有意义”延迟越来越少。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T15:52:19.613

除了@Aaron 已经解释过的内容之外，[该文档](http://technet.microsoft.com/en-us/library/ms179984.aspx#WaitTypes)还提到不能保证它的未来兼容性。

> 各种各样的
> 
> 标识仅供参考。不支持。不保证未来的兼容性。

# ios - 自定义 UIButton，无法识别的选择器发送到实例

> ID：10962252
> 
> 赞同：3
> 
> 时间：2012-06-09T15:32:30.877
> 
> 标签：ios, xcode, unrecognized-selector

我正在尝试子类化 UIButton 以将属性附加到它，但您可能已经猜到我收到“无法识别的选择器发送到实例”错误。

确切错误：[UIButton setAnnotPin:]: unrecognized selector sent to instance

以下是代码的重要部分：

MapViewController.h：

```
 #import "UIRightPinAccessoryButton.h" 
```

MapViewController.m：

```
- (MKAnnotationView *) mapView:(MKMapView *)mapView viewForAnnotation:(id <MKAnnotation>) annotation{ 
 //some other code..

UIRightPinAccessoryButton *rightAccessoryButton = [UIRightPinAccessoryButton buttonWithType:UIButtonTypeDetailDisclosure];
rightAccessoryButton.frame = CGRectMake(0, 0, 35, 35);
rightAccessoryButton.contentVerticalAlignment = UIControlContentVerticalAlignmentCenter;
rightAccessoryButton.contentHorizontalAlignment = UIControlContentHorizontalAlignmentCenter;
[rightAccessoryButton addTarget:self action:@selector(rightAccessoryButtonTapped:) forControlEvents:UIControlEventTouchUpInside]; 

rightAccessoryButton.annotPin = annot;  **// Error comes here**
} 
```

这是我的 UIRightPinAccessoryButton 类：

UIRightPinAccessoryButton.h

```
#import "Annotations.h"

@interface UIRightPinAccessoryButton : UIButton{
  Annotations *annotPin;
} 

@property (nonatomic) Annotations *annotPin; 
```

UIRightPinAccessoryButton.m

```
#import "UIRightPinAccessoryButton.h"

@implementation UIRightPinAccessoryButton

@synthesize annotPin;

@end 
```

我真的不明白为什么 xcode 在 UIButton 上寻找 setAnnotPin: 方法而不是我的自定义 UIRightPinAccessoryButton？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T15:40:59.747

本节`[UIRightPinAccessoryButton buttonWithType:UIButtonTypeDetailDisclosure];`

不会返回类型的对象，`UIRightPinAccessoryButton`但会返回 UIButton 类型的对象所以将其更改为

```
UIRightPinAccessoryButton *rightAccessoryButton = [[UIRightPinAccessoryButton alloc] init]; 
```

此外，似乎没有办法将按钮的类型更改为 UIButtonTypeDetailDisclosure 一旦其子类化，您可以设置自己的图像以使其看起来相同
而且您不能轻松子类化 buttonWithType，请从[iPhone 阅读更多内容：Override UIButton buttonWithType to返回子类](https://stackoverflow.com/questions/2562713/iphone-override-uibutton-buttonwithtype-to-return-subclass)

# objective-c - iOS：强制 UIWebView 重新加载/阻止缓存

> ID：10962256
> 
> 赞同：8
> 
> 时间：2012-06-09T15:33:00.000
> 
> 标签：objective-c, ios5, uiwebview

我有一个显示网站的 iPhone 应用程序。该网站不时更改其内容，但我的应用程序每次打开时都不会重新加载。我试图阻止网站的缓存，但没有成功。

这是我的初始化方法：

```
- (id)init:(NSString *)url withTitle:(NSString *)theTitle withPageName:(NSString *)pageName {
    self = [super init];
    if(self) {
        NSLog(@"websiteviewcontroller init");
        self.title = theTitle;
        self.url = url;
        self.pageName = pageName;

        CGRect frame = [[UIScreen mainScreen] applicationFrame];
        webView = [[UIWebView alloc] initWithFrame:frame];

        NSURL *theURL = [NSURL URLWithString:url];
        [webView loadRequest:[NSURLRequest requestWithURL:theURL]]; 

        // support zooming
        webView.scalesPageToFit = YES;

                //[[NSURLCache sharedURLCache] removeAllCachedResponses];
                [webView reload];

    }
    return self;
} 
```

这是我的 viewWillAppear 方法：

```
- (void)viewWillAppear:(BOOL)animated {

    CGRect frame = [[UIScreen mainScreen] applicationFrame];
    webView = [[UIWebView alloc] initWithFrame:frame];

    NSURL *theURL = [NSURL URLWithString:url];
    [webView loadRequest:[NSURLRequest requestWithURL:theURL]]; 

    [webView reload];

    // support zooming
    webView.scalesPageToFit = YES;
} 
```

请帮我解决这个问题。非常感谢所有答案。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-14T10:36:01.013

此代码片段解决了我的问题：

```
[[NSURLCache sharedURLCache] removeAllCachedResponses]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T07:09:52.583

答案只针对下一个问题。一个完整的答案： [没有缓存的 UIwebview](https://stackoverflow.com/questions/9744644/uiwebview-without-cache)

# html - symfony2 自定义表单选择选项

> ID：10962258
> 
> 赞同：1
> 
> 时间：2012-06-09T15:33:03.820
> 
> 标签：html, css, forms, symfony, customization

我正在尝试做一个简单的表单来添加一个带有名称和颜色的活动。

所以我想制作一个包含一些颜色数组的列表，现在它正在工作我有颜色的名称，但我想要做的是：

```
<select id="a" name="select" style="width: 10%;">
    <option style="background-color: FF0;" value="FF0"></option>
    <option style="background-color: F0F;" value="F0F"></option>
    <option style="background-color: 0FF;" value="0FF"></option>
</select> 
```

如何添加“style="background-color:"mycolor;" 我的表格？

```
public function buildForm(FormBuilder $builder, array $options)
{        
    $builder->add('name');         
    $listColor;

    for($r = 0;$r < 255; $r = $r + 120)
    {
        for($g = 0;$g < 255; $g = $g + 120)
        {    
            for($b = 0;$b < 255; $b = $b + 120)        
            {
                $string = dechex($r).dechex($g).dechex($b);
                $listColor[$string] = $string;
            }
        }
    }
    $builder->add('color', 'choice', array(
        'choices' => $listColor));
} 
```

在数组中有一些选项有诀窍吗？放一些 html ？

我发现的最接近的事情是在你的表单上添加一个类名，以便在它之后在 css 中做一些事情......

```
{{ form_widget(form, { 'attr': {'class': 'myclass'}}) }} 
```

谢谢;)

拉夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T17:19:34.243

你可以使用 jquery 来解决这个问题，试试这个例子：

[JSBIN "style="背景颜色:"mycolor;"](http://jsbin.com/urahas/edit#javascript,html,live)

```
$(document).ready(function(){
    $("#a option").each(function(index,value){
       var option = $(this);
       var bc= 'background-color:'+option.val()+';';
       option.attr('style',bc);
    });
}); 
```

# javascript - jQuery：在页面上的另一个图像上随机点填充图像？

> ID：10962262
> 
> 赞同：0
> 
> 时间：2012-06-09T15:33:35.490
> 
> 标签：javascript, jquery

所以我有一个购物车，在我的页面上有一个固定的位置。想象[一下接近这个](http://www.google.com/imgres?q=shopping%20cart%20top%20view&num=10&um=1&hl=en&rlz=1C1CHFA_enUS484US484&biw=1203&bih=636&tbm=isch&tbnid=X1kEZI497zk7OM%3a&imgrefurl=http://www.shutterstock.com/pic-1833588/stock-photo--d-golden-shopping-cart-isolated-top-view.html&docid=jOfI5CNWkh30SM&imgurl=http://image.shutterstock.com/display_pic_with_logo/62870/62870,1158115330,1/stock-photo--d-golden-shopping-cart-isolated-top-view-1833588.jpg&w=450&h=470&ei=lmvTT-C2OuTs6gH7n72LAw&zoom=1&iact=hc&vpx=313&vpy=114&dur=43&hovh=229&hovw=220&tx=100&ty=135&sig=100380215418192422415&sqi=2&page=1&tbnh=133&tbnw=128&start=0&ndsp=19&ved=1t:429,r:1,s:0,i:75)的东西，除了它不是一个角度，而且它完全垂直地面对。我想要做的（使用 jQuery）是在这个图像上随机填充图像，唯一的限制是它们在购物车“篮子”区域内。

`append`我猜有一些方法可以引用购物车篮内的区域，然后在这些点上做一些 jQuery 。

我想我会先使用 position()....

```
var pos = $("#myimage").position();
top = pos.top;  // top offset position
left = pos.left; // left offset position
right = pos.left + $("#myimage").width;
bottom = pos.top + $("#myimage").height; 
```

然后通过执行以下操作获取 x 和 y 位置：

```
var adjustedHigh = (top - bottom) + 1;

var y = Math.floor(Math.random()*adjustedHigh) + bottom 
```

不知道如何附加到该坐标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T16:03:22.860

`position:absolute`在要附加的图像上设置，然后将坐标值分别设置为`left`和`top`CSS 属性。

# java - 如何使用 java 写入现有的 XML 文件

> ID：10962267
> 
> 赞同：4
> 
> 时间：2012-06-09T15:33:59.923
> 
> 标签：java, xml

我有一个看起来像这样的 xml 文件。员工.xml

```
<Employees>
    <Employee>
        <FirstName>myFirstName</FirstName>
        <LastName>myLastName</LastName>
        <Salary>10000</Salary>
    <Employee>
</Employees> 
```

现在如何将新的 Employee 元素添加到现有的 XML 文件中？.. 示例代码非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T15:47:57.127

您不能“将节点写入现有 XML 文件”。您可以将现有的 XML 文件读入内存，添加到数据模型中，然后写入一个新文件。您可以重命名旧文件并将新文件写入旧名称。但是没有常用的 Java 实用程序可以修改 XML 文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T16:04:23.457

要添加到现有的 XML 文件，通常需要将其读入内部数据结构，以内部形式添加所需的数据，然后将其全部写入，覆盖原始文件。

内部结构可以是您自己制作的，也可以是`DOM`您自己制作的，并且有多种读入和写出的方法。

如果数据相当小，DOM 可能是最简单的，并且在[这个相关问题](https://stackoverflow.com/questions/7373567/java-how-to-read-and-write-xml-files)的答案中有一些示例代码。

如果你的数据很大，DOM 就不行。可能的方法是使用 SAX 进行读取和写入（尽管 SAX 传统上只是一种读取机制），如对[另一个相关问题](https://stackoverflow.com/questions/4898590/generating-xml-using-sax-and-java)的回答中所述。

您可能还想考虑[JAXB](http://www.oracle.com/technetwork/articles/javase/index-140168.html)或（甚至是最好的）[StAX](http://stax.codehaus.org/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-09T15:36:58.030

请使用[xstream](http://xstream.codehaus.org/)将您的文件解析为对象，或创建一个包含员工的列表，然后您可以直接将其转换为 xml。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-09T15:45:56.247

我认为此链接可能对您有用。

这里有示例如何读取/解析、修改（添加元素）和保存（再次写入 xml 文件）。

您可以在以下位置找到以下示例：[http ://www.petefreitag.com/item/445.cfm](http://www.petefreitag.com/item/445.cfm)

读：

```
DocumentBuilderFactory docFactory = DocumentBuilderFactory.newInstance();
DocumentBuilder docBuilder = docFactory.newDocumentBuilder();
Document doc = docBuilder.parse("/path/to/file.xml"); 
```

调整：

```
// attributes
Node earth = doc.getFirstChild();
NamedNodeMap earthAttributes = earth.getAttributes();
Attr galaxy = doc.createAttribute("galaxy");
galaxy.setValue("milky way");
earthAttributes.setNamedItem(galaxy);

// nodes
Node canada = doc.createElement("country");
canada.setTextContent("ca");
earth.appendChild(canada); 
```

编写 XML 文件：

```
Transformer transformer = TransformerFactory.newInstance().newTransformer();
transformer.setOutputProperty(OutputKeys.INDENT, "yes");

//initialize StreamResult with File object to save to file
StreamResult result = new StreamResult(new StringWriter());
DOMSource source = new DOMSource(doc);
transformer.transform(source, result);

String xmlString = result.getWriter().toString();
System.out.println(xmlString); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-09T15:39:37.877

您需要使用 DOM 来编写/编辑您的 xml 文件。
这很简单：
您只需要创建节点并为其添加属性。
您还可以使用 DOM 编写/编辑 XSLT 文件。
只需在 Google 上搜索 DOM java

# css - Pictos 图标无法在 iOS 上呈现

> ID：10962268
> 
> 赞同：0
> 
> 时间：2012-06-09T15:34:00.763
> 
> 标签：css, ios, icons, pictos

我的 pictos 图标在桌面浏览器中运行良好，但无法在 ios 上呈现。

头

```
<link href="//get.pictos.cc/fonts/1895/1" rel="stylesheet" type="text/css"> 
```

标题链接 HTML

```
<a href="/" alt="Home" class="" rel="tooltip" title="Home"><span aria-hidden="true" data-icon="H"></span></a> 
```

Pictos CSS

```
[data-icon]:before {
font-family: 'Pictos Custom';
content: attr(data-icon);
-webkit-font-smoothing: antialiased;
} 
```

chrome 中的 Pictos 图标 ![Pictos 图标铬](../Images/3d106704694aeff1608fec8f7726b7b2.png)

iOS 中的 Pictos 图标 ![Pictos 图标 iOS](../Images/adcdf5d8271e6b89a12717be45863aa6.png)

# c++ - sfml 中的鼠标位置和点击检测

> ID：10962270
> 
> 赞同：0
> 
> 时间：2012-06-09T15:34:23.557
> 
> 标签：c++, sfml

```
int Game::MouseOnDot(float x, float y, RenderWindow &renderWindow) {
    Rect<int> Dot;
    Event event;
    Dot.left = x;
    Dot.top = y;
    Dot.width = 20;
    Dot.height = 20;
    while (renderWindow.pollEvent(event)) {
        float Mx = sf::Mouse::getPosition().x;
        float My = sf::Mouse::getPosition().y;
        if (event.type == Event::MouseButtonReleased&&Mx > x && Mx < Dot.height && My > y && My < Dot.width){
                return 1;
        }
            else
                return 0;
    }
} 
```

我不知道为什么如果在点上按下按钮它会返回 1 告诉其他函数关闭窗口，这将不起作用。我在鼠标位置上做错了吗？

```
while (renderWindow.isOpen()) {
        processEvents(renderWindow);
        float Time = clock.getElapsedTime().asSeconds();
        float TimeDifference = Time - LastUpdateTime;
        if (TimeDifference >= UpdateTime) {
            processEvents(renderWindow);
            y += 3;
            if (y <= 770) {
                if(Game::MouseOnDot(x, y, renderWindow)==1)
                                    renderWindow.close();
                Game::Spawn(renderWindow, Green_Dots, x, y);
                LastUpdateTime = Time;
                return; 
```

当 MouseOnDot 重新输入 0 或 1 时，我仍然无法工作我在这里粘贴部分。它不会关闭窗口，我不知道为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-01T18:58:36.867

使用 *sf::Mouse::getPosition().x* 返回相对于桌面的位置，如果你想要它相对于你的 renderWindow 你需要做： *sf::Mouse::getPosition(renderWindow).x*

那么 Attila 对鼠标/点的比较是完全正确的 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T15:44:02.567

我认为您的问题是您将位置与 x 坐标和高度进行比较。您需要与 x 和 x+height 进行比较（类似于 y 坐标/宽度）

尝试：

```
if (event.type == Event::MouseButtonReleased && 
    Mx > x && Mx < x + Dot.height &&
    My > y && My < y + Dot.width) {
  //...
} 
```

# php - 如何使用 drupal 7 发送带有 drupal_goto 的变量

> ID：10962273
> 
> 赞同：3
> 
> 时间：2012-06-09T15:34:31.613
> 
> 标签：php, drupal, drupal-7

我正在尝试使用 drupal_goto 函数，但它被重定向到错误的 URL

这是我的代码

```
$dis='user/' . $account->uid . '/edit/?id=6356928';
 drupal_goto($dis); 
```

身份证问题

有什么建议么 ？？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T07:58:06.173

[drupal_goto](https://api.drupal.org/api/drupal/includes!common.inc/function/drupal%5fgoto/7)使用与[url()](https://api.drupal.org/api/drupal/includes!common.inc/function/url/7)`$options`相同的设置。

尝试执行以下操作

```
drupal_goto("user/" . $account->uid . "/edit", array(
    'query' => array(
        'id' => '6356928',
    ),
)); 
```

# ruby-on-rails - rails - 在多对多上增加价值

> ID：10962289
> 
> 赞同：0
> 
> 时间：2012-06-09T15:37:31.677
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在关注一个railscast，试图创建一个添加链接来添加一个与多对多关联相关的值。我使用模型而不是实现多对多的唯一区别

```
has_and_belongs_to_many. 
```

而且效果不太好。
（presenetation 很好，但添加按钮失败。）

这是我的代码

文件：ingredient_recipe.rb

```
class IngredientRecipe < ActiveRecord::Base
  attr_accessible :created_at, :ingredient_id, :order, :recipe_id
  belongs_to :recipe
  belongs_to :ingredient
end 
```

文件：ingredient.rb

```
class Ingredient < ActiveRecord::Base
 has_many :ingredient_recipes
 has_many :recipes, :through => :ingredient_recipes
 ... 
```

文件：recipes.rb

```
class Recipe < ActiveRecord::Base
 has_many :ingredient_recipes
 has_many :ingredients, :through => :ingredient_recipes
 ... 
```

在用户界面中

```
 <%= link_to_add_fields "Add", f, :ingredient_recipes %> 
```

该方法已定义

```
def link_to_add_fields(name, f, association)
 new_object = f.object.class.reflect_on_association(association).klass.new
 fields = f.fields_for(association, new_object, :child_index => "new_#{association}") do |builder|
   render(association.to_s.singularize + "_fields", :f => builder)
 end
 link_to_function(name, "add_fields(this, \"#{association}\", \"#{escape_javascript(fields)}\")")
end 
```

问题

渲染（association.to_s.singularize + "
_fields", :f => builder）显示
<%= f.text_field :name%> <%= f.hidden_​​field :_destroy%> <%= link_to "x","" , class: "remove_fields"%> 并打印错误

```
 ActionView::Template::Error (undefined method `name' for #<IngredientRecipe:0x6393ee8>): 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T15:43:40.087

不完全确定是不是这样，但由于它试图在成分食谱对象上调用名称，您是否尝试过更改方法中传递的符号？

```
 <%= link_to_add_fields "Add", f, :ingredients %> 
```

# c++ - 如何在基于范围的for循环中找到当前对象的索引？

> ID：10962290
> 
> 赞同：86
> 
> 时间：2012-06-09T15:37:33.713
> 
> 标签：c++, iterator

假设我有以下代码：

```
vector<int> list;
for(auto& elem:list) {
    int i = elem;
} 
```

我可以`elem`在不维护单独的迭代器的情况下找到向量中的位置吗？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-06-09T16:20:33.850

是的，你可以，只是需要一些按摩；）

诀窍是使用组合：不是直接迭代容器，而是沿途使用索引“压缩”它。

专用拉链代码：

```
template <typename T>
struct iterator_extractor { typedef typename T::iterator type; };

template <typename T>
struct iterator_extractor<T const> { typedef typename T::const_iterator type; };

template <typename T>
class Indexer {
public:
    class iterator {
        typedef typename iterator_extractor<T>::type inner_iterator;

        typedef typename std::iterator_traits<inner_iterator>::reference inner_reference;
    public:
        typedef std::pair<size_t, inner_reference> reference;

        iterator(inner_iterator it): _pos(0), _it(it) {}

        reference operator*() const { return reference(_pos, *_it); }

        iterator& operator++() { ++_pos; ++_it; return *this; }
        iterator operator++(int) { iterator tmp(*this); ++*this; return tmp; }

        bool operator==(iterator const& it) const { return _it == it._it; }
        bool operator!=(iterator const& it) const { return !(*this == it); }

    private:
        size_t _pos;
        inner_iterator _it;
    };

    Indexer(T& t): _container(t) {}

    iterator begin() const { return iterator(_container.begin()); }
    iterator end() const { return iterator(_container.end()); }

private:
    T& _container;
}; // class Indexer

template <typename T>
Indexer<T> index(T& t) { return Indexer<T>(t); } 
```

并使用它：

```
#include <iostream>
#include <iterator>
#include <limits>
#include <vector>

// Zipper code here

int main() {
    std::vector<int> v{1, 2, 3, 4, 5, 6, 7, 8, 9};

    for (auto p: index(v)) {
        std::cout << p.first << ": " << p.second << "\n";
    }
} 
```

你可以在[ideone](http://ideone.com/rAcaZ)看到它，虽然它缺乏 for-range 循环支持，所以它不那么漂亮。

**编辑：**

只是记得我应该更频繁地检查 Boost.Range。不幸的是没有`zip`范围，但我确实找到了一颗珍珠：[`boost::adaptors::indexed`](http://www.boost.org/doc/libs/1_49_0/libs/range/doc/html/range/reference/adaptors/reference/indexed.html)。但是，它需要访问迭代器才能提取索引。耻辱：x

否则，使用[`counting_range`](http://www.boost.org/doc/libs/1_49_0/libs/range/doc/html/range/reference/ranges/counting_range.html)和泛型`zip`我相信它可以做一些有趣的事情......

在理想的世界里，我会想象：

```
int main() {
    std::vector<int> v{1, 2, 3, 4, 5, 6, 7, 8, 9};

    for (auto tuple: zip(iota(0), v)) {
        std::cout << tuple.at<0>() << ": " << tuple.at<1>() << "\n";
    }
} 
```

`zip`自动创建一个视图作为引用元组的范围，并简单`iota(0)`地创建一个“假”范围，该范围从无穷大开始`0`并只计数无穷大（或者好吧，它的类型的最大值......）。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-06-09T16:01:54.863

jrok 是对的：基于范围的 for 循环不是为此目的而设计的。

但是，在您的情况下，可以使用指针算法来计算它，因为`vector`它的元素是连续存储的 (*)

```
vector<int> list;
for(auto& elem:list) { 
    int i = elem;
    int pos = &elem-&list[0]; // pos contains the position in the vector 

    // also a &-operator overload proof alternative (thanks to ildjarn) :
    // int pos = addressof(elem)-addressof(list[0]); 

} 
```

但这显然是一种不好的做法，因为它会混淆代码并使其更加脆弱（如果有人更改容器类型、重载`&`运算符或将 'auto&' 替换为 'auto'，它很容易中断。祝你调试好运！）

注意：C++03 中的向量以及 C++11 标准中的数组和字符串保证了连续性。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2012-06-09T16:00:54.940

不，你不能（至少，不费力气）。如果您需要元素的位置，则不应使用基于范围的 for。请记住，它只是最常见情况的便利工具：为每个元素执行一些代码。在需要元素位置的不太常见的情况下，您必须使用不太方便的常规`for`循环。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2018-07-20T08:44:03.953

根据@Matthieu 的回答，使用提到的[boost::adaptors::indexed](https://www.boost.org/doc/libs/1_49_0/libs/range/doc/html/range/reference/adaptors/reference/indexed.html)有一个非常优雅的解决方案：

```
std::vector<std::string> strings{10, "Hello"};
int main(){
    strings[5] = "World";
    for(auto const& el: strings| boost::adaptors::indexed(0))
      std::cout << el.index() << ": " << el.value() << std::endl;
} 
```

[你可以试试](https://ideone.com/JDjsTB)

这很像提到的“理想世界解决方案”，语法漂亮且简洁。请注意，`el`在这种情况下的类型类似于`boost::foobar<const std::string&, int>`，因此它在那里处理引用并且不执行复制。它甚至非常高效：[https](https://godbolt.org/g/e4LMnJ) ://godbolt.org/g/e4LMnJ （代码相当于保留一个自己的计数器变量，它尽可能好）

为了完整起见，替代方案：

```
size_t i = 0;
for(auto const& el: strings) {
  std::cout << i << ": " << el << std::endl;
  ++i;
} 
```

或者使用向量的连续属性：

```
for(auto const& el: strings) {
  size_t i = &el - &strings.front();
  std::cout << i << ": " << el << std::endl;
} 
```

第一个生成与 boost 适配器版本相同的代码（最佳），最后一个指令更长：[https ://godbolt.org/g/nEG8f9](https://godbolt.org/g/nEG8f9)

注意：如果你只想知道，如果你有最后一个元素，你可以使用：

```
for(auto const& el: strings) {
  bool isLast = &el == &strings.back();
  std::cout << isLast << ": " << el << std::endl;
} 
```

这适用于每个标准容器，但必须使用`auto&`/ （与上面相同），但无论如何都建议这样做。`auto const&`根据输入，这也可能非常快（尤其是当编译器知道向量的大小时）

替换`&foo`by`std::addressof(foo)`以确保通用代码的安全。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2014-07-03T17:14:06.810

如果你有一个支持 C++14 的编译器，你可以用函数式的方式来做：

```
#include <iostream>
#include <string>
#include <vector>
#include <functional>

template<typename T>
void for_enum(T& container, std::function<void(int, typename T::value_type&)> op)
{
    int idx = 0;
    for(auto& value : container)
        op(idx++, value);
}

int main()
{
    std::vector<std::string> sv {"hi", "there"};
    for_enum(sv, [](auto i, auto v) {
        std::cout << i << " " << v << std::endl;
    });
} 
```

适用于 clang 3.4 和 gcc 4.9（不适用于 4.8）；对于两者都需要设置`-std=c++1y`。您需要 c++14 的原因是`auto`lambda 函数中的参数。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-04-15T07:06:20.083

有一种非常简单的方法可以做到这一点

```
vector<int> list;
for(auto& elem:list) {
    int i = (&elem-&*(list.begin()));
} 
```

`i`您需要的索引在哪里。

这利用了[C++ 向量总是连续](https://stackoverflow.com/questions/7609169/are-c-vectors-always-contiguous)的这一事实。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2016-08-17T15:21:24.047

如果您坚持使用基于范围的 for 并了解索引，则维护索引非常简单，如下所示。我认为基于范围的 for 循环没有更清洁/更简单的解决方案。但真的为什么不使用标准 for(;;) 呢？这可能会使您的意图和代码最清晰。

```
vector<int> list;
int idx = 0;
for(auto& elem:list) {
    int i = elem;
    //TODO whatever made you want the idx
    ++idx;
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2020-10-10T11:24:16.400

这是一个使用 c++20 的非常漂亮的解决方案：

```
#include <array>
#include <iostream>
#include <ranges>

template<typename T>
struct EnumeratedElement {
    std::size_t index;
    T& element;
};

auto enumerate(std::ranges::range auto& range) 
    -> std::ranges::view auto 
{
    return range | std::views::transform(
        [i = std::size_t{}](auto& element) mutable {
            return EnumeratedElement{i++, element};
        }
    );
}

auto main() -> int {
    auto const elements = std::array{3, 1, 4, 1, 5, 9, 2};
    for (auto const [index, element] : enumerate(elements)) {
        std::cout << "Element " << index << ": " << element << '\n';
    }
} 
```

这里使用的主要特性是 c++20 范围、c++20 概念、c++11 可变 lambda、c++14 lambda 捕获初始化程序和 c++17 结构化绑定。有关任何这些主题的信息，请参阅 cppreference.com。

请注意，`element`在结构化绑定中实际上是引用而不是元素的副本（在这里并不重要）。这是因为 only 周围的任何限定符`auto`都会影响从中提取字段的临时对象，而不是字段本身。

生成的代码与由此生成的代码相同（至少由 gcc 10.2 生成）：

```
#include <array>
#include <iostream>
#include <ranges>

auto main() -> int {
    auto const elements = std::array{3, 1, 4, 1, 5, 9, 2};
    for (auto index = std::size_t{}; auto& element : elements) {
        std::cout << "Element " << index << ": " << element << '\n';
        index++;
    }
} 
```

证明：[https ://godbolt.org/z/a5bfxz](https://godbolt.org/z/a5bfxz)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-11-13T03:13:02.727

我从您的评论中了解到，您想知道索引的一个原因是要知道该元素是否是序列中的第一个/最后一个。如果是这样，你可以这样做

```
for(auto& elem:list) {
//  loop code ...
    if(&elem == &*std::begin(list)){ ... special code for first element ... }
    if(&elem == &*std::prev(std::end(list))){ ... special code for last element ... }
//  if(&elem == &*std::rbegin(list)){... (C++14 only) special code for last element ...}
//  loop code ... 
} 
```

**编辑：**例如，这将打印一个跳过最后一个元素中的分隔符的容器。适用于我能想象到的大多数容器（包括数组），（在线演示[http://coliru.stacked-crooked.com/a/9bdce059abd87f91](http://coliru.stacked-crooked.com/a/9bdce059abd87f91)）：

```
#include <iostream>
#include <vector>
#include <list>
#include <set>
using namespace std;

template<class Container>
void print(Container const& c){
  for(auto& x:c){
    std::cout << x; 
    if(&x != &*std::prev(std::end(c))) std::cout << ", "; // special code for last element
  }
  std::cout << std::endl;
}

int main() {
  std::vector<double> v{1.,2.,3.};
  print(v); // prints 1,2,3
  std::list<double> l{1.,2.,3.};
  print(l); // prints 1,2,3
  std::initializer_list<double> i{1.,2.,3.};
  print(i); // prints 1,2,3
  std::set<double> s{1.,2.,3.};
  print(s); // print 1,2,3
  double a[3] = {1.,2.,3.}; // works for C-arrays as well
  print(a); // print 1,2,3
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-02-14T09:11:05.883

Tobias Widlund 写了一个很好的 MIT 许可的 Python 样式标头，仅枚举（虽然是 C++17）：

[GitHub](https://github.com/therocode/enumerate/blob/master/enumerate.hpp)

[博客文章](https://web.archive.org/web/20210506120522/https://blog.therocode.net/2018/10/for-each-with-index)

真的很好用：

```
std::vector<int> my_vector {1,3,3,7};

for(auto [i, my_element] : en::enumerate(my_vector))
{
    // do stuff
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-08-27T13:39:25.343

如果您想避免在将索引变量设置为循环本地的同时编写辅助函数，您可以使用带有可变变量的 lambda。：

```
int main() {
    std::vector<char> values = {'a', 'b', 'c'};
    std::for_each(begin(values), end(values), [i = size_t{}] (auto x) mutable {
        std::cout << i << ' ' << x << '\n';
        ++i;
    });
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-01-12T03:53:00.200

这是一个基于宏的解决方案，它可能在简单性、编译时间和代码生成质量方面胜过大多数其他解决方案：

```
#include <iostream>

#define fori(i, ...) if(size_t i = -1) for(__VA_ARGS__) if(i++, true)

int main() {
    fori(i, auto const & x : {"hello", "world", "!"}) {
        std::cout << i << " " << x << std::endl;
    }
} 
```

结果：

```
$ g++ -o enumerate enumerate.cpp -std=c++11 && ./enumerate 
0 hello
1 world
2 ! 
```

# php - PHP Solr安装不起作用

> ID：10962291
> 
> 赞同：3
> 
> 时间：2012-06-09T15:37:44.993
> 
> 标签：php, solr, centos, pecl, centos6

我遇到了尝试使用 pecl 扩展安装 solr 的错误。我读过这个：

*   [尝试安装 pecl Solr 扩展，但它需要 curl](https://serverfault.com/questions/278124/trying-to-install-pecl-solr-extension-but-it-needs-curl)（服务器故障）

我在 centos 6 服务器上使用 php 5.3.3。

两次我都遇到同样的问题：

```
pecl install -n solr-beta or pecl install -n solr or pear install pecl/solr

Enable Solr (yes of course) [yes] : 
Enable Solr Debugging (Compiles solr in debug mode) [no] : 
libcURL install prefix [/usr] : 
libxml2 install prefix [/usr] : 

checking for cURL in default path... not found
configure: error: Please reinstall the libcurl distribution -
    easy.h should be in <curl-dir>/include/curl/
ERROR: `/var/tmp/solr/configure --enable-solr=yes --enable-solr-debug=no --with-curl=/usr --with-libxml-dir=/usr' failed 
```

有其他解决方法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-21T09:50:35.483

我有同样的问题，我只需要做的是：

```
sudo apt-get install libcurl4-gnutls-dev libxml2-dev 
```

并重新安装它。

字体：[链接](http://phpconfigure.com/2011/04/configure-error-please-reinstall-the-libcurl-distribution/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T16:32:19.410

您链接的解决方案仅在您实际将 curl 作为模块安装时才有效 - 如果您现在没有这样做并重试。

# php - 通过 https 的 file_get_contents 显示垃圾

> ID：10962300
> 
> 赞同：1
> 
> 时间：2012-06-09T15:39:10.670
> 
> 标签：php

我正在尝试通过 https 下载上传的文件，当文件本身下载时，它们无法查看。

我已经尝试过 JPG、DOC 和 XLS 文件，并且都给出了相同的问题，并且在所有情况下，如果我通过 FTP 下载它们会完美打开，并且它们可以在使用脚本的浏览器预下载中正常打开。

这是显示我尝试使用的代码的脚本子集？知道为什么它会下载垃圾吗？

```
$_file = sanitiseData($_GET['doc']);
$filename = '/doc_uploads/'.$_file; 
if (file_exists($filename)) { 
header('Content-type:image/jpg');
header('Content-Disposition: attachment; filename="'.$_file.'"');
echo file_get_contents($filename);
} else { 
echo "The file $_file does not exist"; 
} 
```

这是尝试通过浏览器查看下载的 JPG 时的垃圾示例：

����JFIF��;创建者：gd-jpeg v1.0（使用 IJG JPEG v62），质量 = 90 ��C ��C ��R�"����}!1AQa"q2��� #B��R��$3br�%&'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������� ��������������������������������������������������w!1AQaq “2�B����#3R�br�$4�%�&'()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz������������������������ ������������������������������������������������������ ?�P��q\�O�^�-�C�z�z����o�N��P;��.i�~k+Զ���|�7`'e' ���G�>+���_�6�%�Ԓ��Y�w���P�~.����2E�� ��"��������ms���� [���?��%|"�R5�s�c������=?V��>���IG�=?V��>���I_Q@w����o ���������o����������=?V��>���IG�=?V��>���I_Q@w����o�� ������o����������=?V��>���IG�=?V��>���I_Q@w����o���� �����o����������=?V��>���IG�=?V��>���I_Q@w����o������ ���o����������=?V��>���IG�=?V��>���I_Q@w����o��������o����������=?V��>���IG�=?V��>�� �I_Q@w����o����������o����������=?V��>���IG�=?V��>���I_Q @w����o����������o����������=?V��>���IG�=?V��>���I_Q@w ����o����������o����������=?V��>���IG�=?V��>���I_Q@w�� ��o����������o����������=?V��>���IG�=?V��>���I_Q@w���� o����������o����������=GU��>���� �N�v������%|!E~�xO� �ỹx_P ����j(�z����_

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T17:30:01.060

你最好的选择是使用[readfile(...)](http://php.net/manual/en/function.readfile.php)。PHP 的网站有一个很好的例子，应该可以帮助你。我在我的网站上使用它，它就像一个魅力：

```
if (file_exists($file)) {
    // Inform browser that this is a force-download
    header('Content-Description: File Transfer');
    header('Content-Type: application/octet-stream');
    // Inform browser that data can be binary in addition to text
    header('Content-Disposition: attachment; filename='.basename($file));
    header('Content-Transfer-Encoding: binary');
    // Inform browser that this page expires immediately so that an update to the file will still work.
    header('Expires: 0');
    header('Cache-Control: must-revalidate');
    header('Pragma: public');
    header('Content-Length: ' . filesize($file));
    // Push actual file.
    ob_clean();
    flush();
    readfile($file);
    exit();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T15:46:46.440

单引号导致您输出字符串`"$filename"`而不是变量 value `$filename`。

```
echo file_get_contents($filename); 
```

虽然我们没有看到该函数`sanitiseData()`，但我们假设它正确过滤掉了可用于路径注入的字符串，例如`../`.

### 附录：

我会注意到 jpeg 的正确 MIME 类型是`image/jpeg`，而不是`image/jpg`. 这也可能会给您带来问题。

# ruby - 为什么我的哈希显示一个值，但是当我用 [] 访问它时它返回 nil？

> ID：10962302
> 
> 赞同：0
> 
> 时间：2012-06-09T15:39:20.450
> 
> 标签：ruby, sinatra

我有这段代码，可以尝试调试返回到我的服务器的内容：

```
task = JSON.parse(request.body.read)

puts task.inspect
puts 'description hash: ' 
puts task[:description] 
```

当这段代码运行时，我得到：

```
{"completed" => false, "task_type" => 0, "description"=> "second task"}
description hash: 
nil 
```

有没有不同的方法来访问这个哈希？因为从我看到的检查显示了描述值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T15:48:27.903

### 问题

在您给出的示例中，您正在定义一个“描述”的哈希键，但查找的是 :description 键，它不存在。原因是第一个是String，第二个是Symbol。

```
"description".class
=> String

:description.class
=> Symbol 
```

### 解决方案

使用字符串查找您的密钥，或者如果您知道您的密钥始终是字符串，则在您的下标上调用 #to_s，但您的下标可能不是。

```
task['description']
=> "second task"

task[:description.to_s]
=> "second task" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T15:40:44.753

`:description`不一样`'description'`。这应该有效：

```
puts task['description'] 
```

# asp.net-mvc - STS 身份验证 - MVC 站点

> ID：10962305
> 
> 赞同：0
> 
> 时间：2012-06-09T15:39:44.090
> 
> 标签：asp.net-mvc, authentication, wif

我有两台服务器：STS 和 Web。在 STS 服务器上，我调用：

```
FormsService.SignIn(model.UserName, false); 
```

下一行，我检查：

```
User.Identity.IsAuthenticated 
```

这设置为 TRUE。然后我重定向回我的 Web 服务器并在我点击的控制器中检查：

```
User.Identity.IsAuthenticated 
```

这设置为 FALSE。

```
What could cause this? 
```

更新：我也刚刚尝试将 STS 网站移动到 Web 服务器。我得到同样的错误/问题

更新：我忘了提到我们的 DEV 服务器工作得很好。那里的配置是相同的（除了服务器名称和证书指纹）。这两个服务器之间唯一不同的是一个（DEV）使用自签名证书并且位于我们的防火墙内。另一个（QA）正在使用官方（thawte）证书，并且在我们的防火墙内。此证书的通用名称与服务器名称不匹配（因此可以在我们的场中共享）。因此，当我们访问该站点时，我们使用 https://[commonname].com/web 而不是 https://[servername]/web。我尝试了后一种方法（我得到证书错误，名称不匹配）但仍然有相同的结果。

另外，我可以直接访问 STS 站点并在那里登录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-04T07:51:07.607

从您的`STS`服务器重定向时，您必须使用`AutoPost`将提交`token`到`Relying party`.

何时`Relying party`收到令牌，它将针对该用户创建 cookie。

因此，下次您`User.Identity.IsAuthenticated`在 Relying 聚会检查时，它会返回给您`True`。

通过以下链接了解更多信息，

[http://chris.59north.com/post/2013/03/27/Claims-based-identities-in-ASPNET-MVC-45-using-the-standard-ASPNET-providers.aspx](http://chris.59north.com/post/2013/03/27/Claims-based-identities-in-ASPNET-MVC-45-using-the-standard-ASPNET-providers.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T18:55:05.177

默认情况下，ASP.NET 身份验证基于 cookie。Cookie 存在于网络域中。因此，如果您像这样安装了两台服务器：

1.  [http://www.web.com](http://www.web.com)
2.  [http://www.sts.com](http://www.sts.com)

WEB服务器无法读取STS设置的cookie

有两种可能的解决方案：

1.  将两台服务器都实现为子域
2.  将身份验证票证存储在 URL 而不是 cookie 中

对于选项 1 移动服务器，如下所示：

1.  [http://www.web.yourdomain.com](http://www.web.yourdomain.com)
2.  [http://www.sts.yourdomain.com](http://www.sts.yourdomain.com)

更新 web.config 以将 cookie 限定为 yourdomain.com：

```
<authentication mode="Forms">
      <forms domain=".yourdomain.com"/>
</authentication> 
```

要在 url 中存储票证，请查看这篇文章 - [http://www.codeproject.com/Articles/2796/Cookieless-ASP-NET-forms-authentication](http://www.codeproject.com/Articles/2796/Cookieless-ASP-NET-forms-authentication)

**更新：似乎我没有得到 STS 代表安全令牌服务。我的回答不相关。:(**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-09T18:28:44.550

将 RP 移动到另一台服务器时，我们遇到了同样的问题。事实证明，我们需要进入应用程序池 -> 高级设置 -> 设置 'Load User Profile' = true。

之后，一切都在新服务器上正常运行，并且 User.Identity.IsAuthenticated 在从 STS 返回后返回“true”。

# c++ - 访问可调用对象，构造了 boost::thread

> ID：10962309
> 
> 赞同：0
> 
> 时间：2012-06-09T15:40:02.520
> 
> 标签：c++, boost, boost-thread

我正在使用 Boost 1.49 和 MSVC10。

如果 a`boost::thread`是用可调用对象¹构造的，并且该对象具有我想从*的上下文外部`thread`*访问的成员函数或变量，我如何访问 callabe 对象？

例如，我实现了一个简单的应用程序，它产生 5 个工作线程，保存到`vector<boost::thread*>`本地到`main()`. 这些线程中的每一个都使用一个可调用对象进行实例化，该对象在其构造函数中`Gizmo`采用一个`char`参数。这`char`被保存为类`std::string`中的成员变量`Gizmo`。每个线程将`cout`被保存`string`，然后休眠 250 毫秒。它永远在这个循环中继续，直到不知何故 saves`string`的价值变成“死”。

[简短，独立，（希望）正确，示例](http://sscce.org/)：

```
#include <cstdlib>
#include <string>
#include <memory>
#include <vector>
using namespace std;

#include <boost/thread.hpp>
#include <boost/date_time/posix_time/posix_time.hpp>

boost::mutex cout_mtx;

class Gizmo
{
public:
    Gizmo(const string& state) : state_(state) {};
    Gizmo(Gizmo&& rhs) : state_(std::move(rhs.state_)) {};
    virtual ~Gizmo()
    {
        bool b = true;
    }
    void operator()();

    string state_;
};

void Gizmo::operator()()
{
    while( state_ != "die" )
    {
        {
            boost::mutex::scoped_lock scoped_lock(cout_mtx);
            cout << state_ << flush;
        }
        boost::this_thread::sleep(boost::posix_time::milliseconds(250));
    }
}

boost::thread* start_thread(char c)
{
    Gizmo g(string(1,c));
    return new boost::thread(g);
}

int main()
{
    vector<boost::thread*> threads;

    string d=".*x%$";
    for( string::const_iterator it = d.begin(); it != d.end(); ++it )
    {
        threads.push_back(start_thread(*it));
    }

    for( auto th = threads.begin(); th != threads.end(); ++th )
        (*th)->join();
} 
```

现在我想进行代码更改，`main()`其中将：

1.  获得`thread`第一名`vector`
2.  获取其中`Gizmo`包含的对象`thread`
3.  设置`state_`为“死”

我如何获得`Gizmo`线程内的内容？

```
for( auto th = threads.begin(); th != threads.end(); ++th )
{
    boost::this_thread::sleep(boost::posix_time::seconds(1));
    Gizmo& that_gizmo = (*th)-> ??? ;  // WHAT DO I DO?
    that_gizmo.state_ = "die";
} 
```

* * *

(1)在这种情况下，*可调用对象*意味着 a`class`和`operator()`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T17:03:44.567

您的 start_thread() 方法正在创建一个临时的堆栈对象，然后将其传递给线程。相反，您应该在 main() 中创建一个 Gizmo 对象向量，然后将该向量的每个成员（一个 Gizmo）传递给 boost 的线程构造函数。当您可以在主函数的向量中存储对线程的可调用对象时，我看不出有什么理由应该专门获取线程的可调用对象。

请记住在主线程和检查它的 boost 线程之间同步状态设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T16:32:14.517

你不能实现一个`start_thread`类，让你访问仿函数，而不是一个函数，并保留一个指向这些指针的向量吗？类似的东西（细节有待解决，这些都没有经过测试）：

```
class start_thread {
 public:
  explicit start_thread(char c) : gizmo_(std::string(c,1)), t_(gizmo_) {}
  void join() { t_.join();}
  const Gizmo& callable() const { return gizmo_;}
  Gizmo& callable() { return gizmo_;}
 private:
  Gizmo gizmo_;
  boost::thread t_;
} 
```

您需要将 传递`gizmo_`给线程构造函数作为`boost::ref(gizmo_)`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T23:06:22.850

`boost::thread`不提供获取可调用对象的能力 。`boost::thread`有一个默认构造函数，所以它不知道将作为线程入口点的可调用类型或函数。此外，如果`boost::thread`不执行类型擦除，则将无法再管理同一集合或线程池中具有不同入口点的线程。例如，`std::vector< boost::thread< Gizmo > >`只能管理`Gizmo`线程，而`std::vector< boost::thread >`可以管理`Gizmo`线程和非`Gizmo`线程。

不必在单独的列表中管理`Gizmo`和`boost::thread`对象，或者创建一个新类型来将两者配对在一起，而是考虑通过`std::pair`或将两者关联起来`boost::tuple`。例如：

```
std::vector< boost::tuple< boost::thread*, Gizmo > > threads; 
```

此外，如果线程最终有多种类型用于入口点，并且每种类型都需要自己的关闭形式，请考虑通过执行类型擦除`boost::function`。例如：

```
void shutdown_gizmo( Gizmo& );

boost::function< void() > fn = boost::bind( shutdown_gizmo, boost::ref( gizmo ) );

// The tuple now contains a function object, decoupling it from Gizmo objects,
// and allowing other shutdown methods to be paired with threads.
typedef boost::tuple< boost::thread*, boost::function< void() > > tuple_t;
std::vector< tuple_t > threads; 
```

对于任何解决方案，只要注意维护`Gizmo`对象的范围，以及维护正确`Gizmo`对象的句柄即可。`Gizmo`无意中获得实际对象副本的句柄是相当容易的。

# c# - 如何在 Microsoft.Office.Interop.Word 命名空间中设置事件？

> ID：10962315
> 
> 赞同：0
> 
> 时间：2012-06-09T15:40:57.567
> 
> 标签：c#, ms-word

我试过

```
var wordApp = new Microsoft.Office.Interop.Word.Application();
var doc = wordApp.Documents.Open(FileName);
wordApp.Visible = true;

   ((Microsoft.Office.Interop.Word.ApplicationEvents4_Event)wordApp.Quit) += new ApplicationEvents4_QuitEventHandler(delegate
                    {
                        MessageBox.Show("word closed!");
                    }); 
```

但我得到：

```
Cannot convert method group 'Quit' to non-delegate type 'Microsoft.Office.Interop.Word.ApplicationEvents4_Event'. Did you intend to invoke the method?

Microsoft.Office.Interop.Word._Application.Quit(ref object, ref object, ref object)' 
and non-method 'Microsoft.Office.Interop.Word.ApplicationEvents4_Event.Quit'. Using method group. 
```

由于警告，我做了演员表，但没有解决。而且我不知道如何解决这个错误。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T16:17:06.457

您在强制转换表达式中放错了括号，您不想强制转换退出。正确的语法是：

```
((Microsoft.Office.Interop.Word.ApplicationEvents4_Event)wordApp).Quit += ... 
```

*也许您可以通过使用using*指令更轻松地避免麻烦，这样您就不需要填塞表达式并且可以编写更具可读性的代码：

```
using Word = Microsoft.Office.Interop.Word;
...

    var wordApp = new Word.Application();
    var doc = wordApp.Documents.Open(FileName);
    wordApp.Visible = true;
    var events = (Word.ApplicationEvents4_Event)wordApp;
    events.Quit += delegate {
        MessageBox.Show("word closed!");
    }; 
```

# shopify - 无法使用 ShopifyAPI 更新变体价格

> ID：10962321
> 
> 赞同：2
> 
> 时间：2012-06-09T15:41:35.787
> 
> 标签：shopify

我面临一个问题 - 无法使用 ShopifyAPI 更新变体的价格。

在更新变体的价格时，它给出了错误

> @remote_errors=#<\ActiveResource::ResourceInvalid：失败。响应代码 = 422。响应消息 = 无法处理的实体。>，@validation_context=nil，@errors=#<\ActiveResource::Errors:0x000000029eb1d0 ...>>，@messages={:base=>["选项不唯一"]}

'<' 后的'\' 需要显示错误，否则堆栈溢出会隐藏错误。

根据生产商店的另一个问题的要求
，测试商店的请求 ID 为“38f5c3b3b7bdf4433724a845c6df4571”，请求 ID 为“6050f165586b631e81b840dc0e1e6807”

# 更多发现

测试商店的变体价格变化

```
p = ShopifyAPI::Product.last  
v = p.variants.first  
v.price = "8.00"  
v.save 
```

变量的初始价格 = "9.00"
返回**false，错误**为 @messages={:base=>["Options are not unique"]}
请求 id 978ad18483f40ff3946df18df0a9d1d8 。
.

现场商店的变体价格变化

```
p = ShopifyAPI::Product.first  
p.variants[0].price = "24.65"  
p.save 
```

变体的初始价格 = "25.65"
返回**true，但价格未更改**
请求 id a9a798b631e3dd10fc81b723f2883af1 。
.

通过测试商店的产品更改价格

```
p = ShopifyAPI::Product.first  
p.variants[0].price = "8.00"  
p.save 
```

变体的初始价格 = "7.00"
返回**true 并更新价格**
请求 id 7d995f6f6ed3bf515e69a1640f27f44a 。
.

通过实时商店中的产品更改价格

```
p = ShopifyAPI::Product.last  
v = p.variants.first  
v.price = "4.00"  
v.save 
```

变量的初始价格 = "3.00"
返回**false，错误**为 @messages={:base=>["Options are not unique"]} 请求 id c6aaa5b65576eb4ec0d89715d25b787e

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T16:31:20.143

```
@messages={:base=>["Options are not unique"]} 
```

那是你的问题。查看您`POST`用于提交请求的日志，该请求用于创建新对象。Shopify 认识到已经存在具有指定选项的变体，并拒绝创建新的变体。

如果您`PUT`改为使用 HTTP 方法，Shopify 会正确地将其解释为更新，一切都应该没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T01:30:55.390

这是 ActiveResource 3.1+ 中的一个错误。

我已经打开了一个[ActiveResource 拉取请求](https://github.com/rails/activeresource/pull/30)，但我目前仍在等待回复。

我已在 shopify_api v3.0.1 中针对此错误[提交了解决方法](https://github.com/Shopify/shopify_api/commit/0e67bfc6c946a2b4de454028c807aff24ff2bc9b)，因此升级此 gem 将为您解决此问题。

# mysql - 消息系统查询以获取最后一条消息、未读消息的数量和会话中的用户数组

> ID：10962323
> 
> 赞同：7
> 
> 时间：2012-06-09T15:41:48.190
> 
> 标签：mysql, sql, messaging

我正在开发一个包含两个表和另一个包含用户信息的表的消息传递系统。
对话可以在 2 个或更多用户之间进行。每个对话都有一个 UID，并且用户之间交换的每条消息都标有该对话 UID。

以下是表格：

`conversation_list`：此表中的每一行都链接`user_id`和`conversation_id`，它还包含用户上次查看对话的时间。

```
`id`                 -> unique ID, autoincremented
`user_id`            -> This contains the user associated with the conversation.
`conversation_id`    -> This contains the UID of the conversation
`date_lastView`      -> This field has the time that the user viewed the conversation last 
```

`conversation_messages`：此表中的每一行都包含一条消息

```
`id`                 -> unique ID, autoincremented
`user_id`            -> This contains the user that sent the message.
`conversation_id`    -> This contains the UID of the conversation
`date_created`       -> This contains the time when the message was posted
`message`            -> This contains the message 
```

`users`：此表中的每一行都包含一个用户

```
`User_ID`            -> UID of the user
`FirstName`          -> This contains the first name of the user
`LastName`           -> This contains the last name of the user 
```

我已经有一个 SQL 查询来获取每个对话的最后一条消息。这里是 ：

```
SELECT *
FROM conversation_messages AS m

JOIN
  (SELECT mx.conversation_id,
          MAX(mx.date_created) AS MaxTime
   FROM conversation_messages AS mx
   GROUP BY mx.conversation_id) AS mx ON m.conversation_id = mx.conversation_id
AND m.date_created = mx.MaxTime

JOIN
  (SELECT mu.conversation_id
   FROM conversation_list AS mu
   WHERE mu.user_id = :USER_ID_CONNECTED
   GROUP BY mu.conversation_id) AS mux ON m.conversation_id = mux.conversation_id

JOIN conversation_list AS mu ON m.conversation_id = mu.conversation_id

GROUP BY mu.conversation_id
ORDER BY m.date_created DESC 
```

我现在想在这个完美运行的查询中添加返回的能力：

*   每个对话的未读消息数（所有消息的计数`date_creaded`大于`date_lastView`登录用户的数）
*   包含每个对话中每个用户的数组，`User_ID`并按他们最后一次在对话中发布消息的时间排序。
*   与最后一个数组的想法相同，但与用户的`FirstName`and`LastName`相同。

我尝试了一些事情，但我真的不成功，所以我现在请求 SO 社区提供宝贵的帮助。

所有这些只能显示登录用户参与的对话。

它有帮助，我创建了一个[SQLFiddle](http://sqlfiddle.com/#!2/c7306/2)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T18:21:23.047

用户对话中未读消息的数量（此处为用户 #6）：

```
SELECT l.conversation_id, count(*)
FROM   conversation_list l
JOIN   conversation_messages m ON m.conversation_id = l.conversation_id AND m.date_created > l.date_lastview
WHERE  l.user_id = 6
GROUP BY l.conversation_id 
```

按最后活动排序的对话参与者：

```
SELECT conversation_id, user_id, max(date_created) as last_active
FROM   conversation_messages
GROUP BY conversation_id, user_id
ORDER BY conversation_id, last_active 
```

第三个查询应该和第二个一样，只是在 上再加入一个表`user_id`，对吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-27T06:18:11.377

我对查询添加了 3 项改进以[获取未读消息](https://stackoverflow.com/questions/10962323/messaging-system-query-to-get-last-messages-number-of-unread-messages-and-array#10963469)：

*   如果 last_view 字段为空，它将假定该用户从不检查他的消息，因此所有消息都将是“未读”
*   仅将非用户创建的消息识别为新消息。
*   当没有未读消息时，计数将返回 0

```
SELECT l.conversation_id, count(m.id)
FROM   conversation_list l
LEFT JOIN   conversation_messages m ON m.conversation_id = l.conversation_id AND (l.date_lastview IS NULL OR m.date_created > l.date_lastview)  AND m.user_id != 6
WHERE  l.user_id = 6
GROUP BY l.conversation_id 
```

# icloud - 如何让 NSMetadataQuery 将我保存的文档的文件夹视为包？

> ID：10962324
> 
> 赞同：4
> 
> 时间：2012-06-09T15:41:48.160
> 
> 标签：icloud, uidocument, info-plist, nsmetadataquery

我正在编写一个应用程序，它可以在本地和 iCloud 上保存和加载文档。本地工作正常，但我遇到了 iCloud 问题。

文档保存为一个包 - UIDocument 读取和写入一个包含图像文件、缩略图文件和信息 plist 的 NSFileWrapper。当我将文档保存到 iCloud，然后查看“管理存储”下的文件时，我看到的是单个文件而不是包；更重要的是，当我使用 NSMetadataQuery 搜索文件时，它会为每个单独的文件而不是包返回一个 NSMetadataItem。结果，我的应用程序没有意识到要加载任何包，而且 iCloud 毫无用处。

我*认为*如果我设置了文档类型并正确导出了 UTI，那么这些包就会得到正确处理。对吗？如果是这样，将文档类型设置为包的清单是什么？我有：

*   添加了文档类型
*   将 LSTypeIsPackage 设置为 YES（我尝试过字符串 YES 和 bool YES）
*   将 CFBundleTypeExtensions 设置为包含一个字符串的数组：文件后缀
*   将 LSHandlerRank 设置为所有者
*   导出具有相同标识符的 UTI
*   将其设置为符合 com.apple.package
*   添加了一个 UITypeTagSpecification 字典，其中包含一个数组，用于键 public.filename-extension，其中包含一个字符串：文件后缀

我还尝试添加一个匹配的 Imported UTI 来匹配导出的 UTI，但没有运气。

我错过了什么？

更新：我注意到[这个问题](https://stackoverflow.com/questions/9026242/nsmetadataquery-ignoring-custom-file-package-type)中的 OP看到了我想要的行为（即使他不想要它），所以它必须是可能的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T16:57:39.310

基于[此](http://www.mail-archive.com/cocoa-dev@lists.apple.com/msg71677.html)，我尝试从我的 plist 中删除 LSItemContentTypes，它起作用了。

# php - 在 Ajax 提交后强制下载由 TCPDF 创建的 PDF

> ID：10962325
> 
> 赞同：7
> 
> 时间：2012-06-09T15:42:14.537
> 
> 标签：php, jquery, ajax, download, tcpdf

我的应用程序允许用户填写表单，并通过 Ajax 后调用发送它。表单 si 发送到创建 PDF 文件的 TCPDF 类。该类具有方法“-> output(...)”，允许将文件保存到 Web 服务器中，将其发送到浏览器，ecc ... 我的目标是，在表单提交后，创建 PDF 文件，然后强制用户下载它（不刷新）。该方法不适用于 ajax 调用。我找到的唯一解决方案是创建文件，将其放入 Web 服务器，然后将用户重定向到文件的位置到 Web 服务器；但这不是一个好的解决方案，我需要强制下载（自动启动）。我在论坛上读过其他类似的解决方案，但不是很好的形式有什么建议吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-01-20T09:40:47.010

```
$pdf->Output("filename.pdf",'D'); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-07-13T08:44:09.163

尝试

```
 $pdf->Output("filename.pdf",'FD'); 
```

这将建议客户是否要保存或打开文件。

# java - 如何使用 Java 向 iPhone 发送推送通知消息？

> ID：10962326
> 
> 赞同：1
> 
> 时间：2012-06-09T15:42:20.270
> 
> 标签：java, iphone

我想使用 Java 向特定的 iPhone 设备发送推送通知消息。

我不知道该怎么做。

我对此进行了谷歌搜索，他们建议使用“PayLoad”类，但不要从任何 jar 文件中获取此类。

请任何人都可以指导我将推送通知消息发送到 iPhone 起诉 Java？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T15:46:07.287

使用[JavaPNS](http://code.google.com/p/javapns/)。这是一个例子：

```
 import javapns.Push;

 public class PushTest {

       public static void main(String[] args) {

                Push.alert("Hello World!", "keystore.p12", "keystore_password", false, "Your token");

       }
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T16:03:57.870

使用 parse sdk from `www.parse.com`，它有助于提供一种处理 ios 和 android 之间的推送通知的好方法（当然是它的 java）。与它一起工作真的很简单..

parse.com 网站上的示例不适用于 android，因此我提供了该网站的链接，其中的步骤更易于使用

[http://developingonandroid.wordpress.com/2011/11/24/3-android-push-notifications-in-parse-a-deep-overview/](http://developingonandroid.wordpress.com/2011/11/24/3-android-push-notifications-in-parse-a-deep-overview/)

# c# - 如何在 C# 中通过 FileStream 和 ResumableUploader 上传/更新文件

> ID：10962335
> 
> 赞同：0
> 
> 时间：2012-06-09T15:43:15.020
> 
> 标签：c#, filestream, gdata, google-docs-api, google-drive-api

我想通过 Google Documents List API(C#) 中的 System.IO.FileStream 上传/更新文件？

我使用以下两种方式：Google.GData.Client.ResumableUpload.ResumableUploader
(1) public void UpdateAsync(Authenticator authentication, AbstractEntry payload, object userData)
(2) public void UpdateAsync(Authenticator authentication, Uri resumableUploadUri, Stream payload, string contentType,对象 userData)

(1) 成功。
（2） 403 Forbidden 或其他失败......

那么，有人有关于（2）的示例代码吗？

我的 (2) 代码：此代码由**Claudio Cherubino**的示例代码编辑，用于将文件流上传到 Google 文档（驱动器）。但是文件（DocumentEntry）的名称在 Google Drive 的页面上显示为“Untitled”。似乎“蛞蝓”不起作用。我错过了一些重要的设置吗？

```
Google.GData.Documents.DocumentsService conn =
new Google.GData.Documents.DocumentsService("TestSend");
conn.setUserCredentials("UserName", "UserPass");

string path = @"D:\test_file\test.exe"; 

Google.GData.Client.ResumableUpload.ResumableUploader send =
new Google.GData.Client.ResumableUpload.ResumableUploader();
send.AsyncOperationCompleted += new Google.GData.Client.AsyncOperationCompletedEventHandler(
    delegate(object sender,
        Google.GData.Client.AsyncOperationCompletedEventArgs e)
    {
        System.Windows.Forms.MessageBox.Show("File Send Done");
    }
);

System.IO.FileStream fs = new System.IO.FileStream(path, System.IO.FileMode.Open, System.IO.FileAccess.ReadWrite);

send.InsertAsync(
    new Google.GData.Client.ClientLoginAuthenticator("TestSend", "writely", this._DiskConn.Credentials),
    new System.Uri("https://docs.google.com/feeds/upload/create-session/default/private/full?v=3"),
    fs,
    "application/octet-stream",
    System.IO.Path.GetFileName(path),
    new object()
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T21:19:31.327

试试下面的代码：

```
DocumentsService service = new DocumentsService("MyDocumentsListIntegration-v1");
ClientLoginAuthenticator authenticator = new ClientLoginAuthenticator(APPLICATION_NAME, ServiceNames.Documents, USERNAME, PASSWORD);

string slug = "Legal contract";
MediaFileSource mediaSource = new MediaFileSource("c:\\contract.txt", "text/plain");
Uri createUploadUrl = new Uri("https://docs.google.com/feeds/upload/create-session/default/private/full?v=3");

ResumableUploader ru = new ResumableUploader();
ru.InsertAsync(authenticator, createUploadUrl, mediaSource.GetDataStream(), mediaSource.ContentType, slug, new object()); 
```

# objective-c - Objective-C 中的 NSTask

> ID：10962340
> 
> 赞同：0
> 
> 时间：2012-06-09T15:44:06.550
> 
> 标签：objective-c, sh, nstask

所以我试图从我的程序中运行一些终端命令，但我遇到了一些令人困惑的错误。

我是来自 Java 的新开发人员，所以我可能会遗漏一些东西。

继承人的代码：

```
NSTask *task = [[NSTask alloc] init];
NSString *commitText = [commitMessage stringValue];
NSString *a = [NSString stringWithFormat:@"cd %@", dirPath];
NSString *c = [NSString stringWithFormat:@"git commit -m '%@'", commitText];
NSArray *commands = [[NSArray alloc]initWithObjects:a,
                     @"git add 'Project'",
                     c,
                     @"git push origin HEAD",
                     nil];
[task setLaunchPath:@"/bin/sh"];

// Do commands
NSArray *args = [NSArray arrayWithObjects:commands,
                 nil];

[task setArguments: args];
[task launch]; 
```

以下是错误：

```
2012-06-09 08:35:20.561 Auto Git[5433:403] -[__NSArrayI fileSystemRepresentation]:                 unrecognized selector sent to instance 0x7fb250d6a1e0
2012-06-09 08:35:20.561 Auto Git[5433:403] -[__NSArrayI fileSystemRepresentation]: unrecognized selector sent to instance 0x7fb250d6a1e0
2012-06-09 08:35:20.679 Auto Git[5433:403] (
  0   CoreFoundation                      0x00007fff870b4f56 __exceptionPreprocess + 198
  1   libobjc.A.dylib                     0x00007fff90e35d5e objc_exception_throw + 43
  2   CoreFoundation                      0x00007fff871411be -[NSObject doesNotRecognizeSelector:] + 190
  3   CoreFoundation                      0x00007fff870a1e23 ___forwarding___ + 371
  4   CoreFoundation                      0x00007fff870a1c38 _CF_forwarding_prep_0 + 232
  5   Foundation                          0x00007fff9174f3a3 -[NSConcreteTask launchWithDictionary:] + 901
  6   Auto Git                            0x000000010d83c6db -[Push push:] + 571
  7   CoreFoundation                      0x00007fff870a470d -[NSObject performSelector:withObject:] + 61
  8   AppKit                              0x00007fff8e0f8f7e -[NSApplication sendAction:to:from:] + 139
  9   AppKit                              0x00007fff8e0f8eb2 -[NSControl sendAction:to:] + 88
  10  AppKit                              0x00007fff8e0f8ddd -[NSCell _sendActionFrom:] + 137
  11  AppKit                              0x00007fff8e0f82a0 -[NSCell trackMouse:inRect:ofView:untilMouseUp:] + 2014
  12  AppKit                              0x00007fff8e177fc4 -[NSButtonCell trackMouse:inRect:ofView:untilMouseUp:] + 489
  13  AppKit                              0x00007fff8e0f6eaa -[NSControl mouseDown:] + 786
  14  AppKit                              0x00007fff8e0c2348 -[NSWindow sendEvent:] + 6306
  15  AppKit                              0x00007fff8e05ba55 -[NSApplication sendEvent:] + 5593
  16  AppKit                              0x00007fff8dff20c6 -[NSApplication run] + 555
  17  AppKit                              0x00007fff8e26e244 NSApplicationMain + 867
  18  Auto Git                            0x000000010d83bff2 main + 34
  19  Auto Git                            0x000000010d83bfc4 start + 52
  20  ???                                 0x0000000000000003 0x0 + 3
 ) 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T15:52:19.327

您的参数数组包含一个数组。它应该是一个字符串数组。使用您的`commands`对象作为 NSTask 的参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T15:50:01.437

我认为问题在于您将带有字符串数组的数组传递给`setArguments`. 您应该只传递带有字符串的数组，而不是嵌套数组。

但我认为你误解了论点是如何`NSTask`工作的。你可能应该做这样的事情：

```
[task setArguments:[[[NSArray alloc] initWithObjects:
                     @"git", @"add", @"Project", nil]
                    autorelease]]; 
```

等等，或者如果你真的想使用`sh`你可能需要添加一些`;`来分隔 shell 命令。

# android - 如何在安卓应用中保存数据

> ID：10962344
> 
> 赞同：67
> 
> 时间：2012-06-09T15:44:38.983
> 
> 标签：android

我最近编写了一个 Android 应用程序。它只是一个简单的应用程序，可让您通过几个简单的计数器间隔来记录篮球比赛的得分。我收到了添加保存功能的需求，这样您就可以保存您的分数，然后重新加载它们。目前，当您停止应用程序时，您的数据会丢失。所以我想知道的是我必须添加什么才能让应用程序保存标签（分数）然后重新加载它。谢谢大家，对不起，我对这些东西了解不多。

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2012-06-09T16:03:41.243

你有两个选择，我会留给你选择。

1.  共享偏好

    这是一个 Android 独有的框架，允许您在键值框架中存储原始值（例如和`int`，虽然严格来说不是原始值）。这意味着您为一个值命名，例如“homeScore”并将该值存储到此键中。`boolean,``String``String`

    ```
    SharedPreferences settings = getApplicationContext().getSharedPreferences(PREFS_NAME, 0);
    SharedPreferences.Editor editor = settings.edit();
    editor.putInt("homeScore", YOUR_HOME_SCORE);

    // Apply the edits!
    editor.apply();

    // Get from the SharedPreferences
    SharedPreferences settings = getApplicationContext().getSharedPreferences(PREFS_NAME, 0);
    int homeScore = settings.getInt("homeScore", 0); 
    ```

2.  内部存储器

    在我看来，这就是您可能正在寻找的东西。您可以将所需的任何内容存储到文件中，因此这为您提供了更大的灵活性。但是，这个过程可能会比较棘手，因为所有内容都将存储为字节，这意味着您必须小心保持您的读取和写入进程一起工作。

    ```
    int homeScore;
    byte[] homeScoreBytes;

    homeScoreBytes[0] = (byte) homeScore;
    homeScoreBytes[1] = (byte) (homeScore >> 8);  //you can probably skip these two 
    homeScoreBytes[2] = (byte) (homeScore >> 16); //lines, because I've never seen a                   
                                                  //basketball score above 128, it's
                                                  //such a rare occurance.

    FileOutputStream outputStream = getApplicationContext().openFileOutput(FILENAME, Context.MODE_PRIVATE);
    outputStream.write(homeScoreBytes);
    outputStream.close(); 
    ```

现在，您也可以查看[External Storage](http://developer.android.com/guide/topics/data/data-storage.html#filesExternal)，但我不建议在这种特殊情况下这样做，因为外部存储以后可能不存在。（注意，如果你选择这个，它需要一个权限）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-09T16:21:21.093

OP 要求一个“保存”功能，这不仅仅是在程序执行期间保留数据（您必须这样做才能使应用程序有价值。）

我建议将数据保存在 sdcard 上的文件中，这样您不仅可以稍后调用它，还可以让用户将设备作为外部驱动器安装在自己的计算机上并获取数据以在其他地方使用。

所以你真的需要一个多点系统：

1）实施`onSaveInstanceState()`。在这个方法中，你被传递了一个Bundle，它基本上就像一个字典。在捆绑包中存储尽可能多的信息，以便在应用程序停止的位置重新启动应用程序。在您的`onCreate()`方法中，检查传入的捆绑包是否为非空，如果是，则从捆绑包中恢复状态。

2) 实施`onPause()`。在此方法中，创建一个 SharedPreferences 编辑器并使用它来保存您下次启动应用程序所需的任何状态。这主要包括用户的偏好（因此得名），但与应用程序的启动状态相关的任何其他内容也应该放在此处。我不会*在*这里存储分数，只是你需要重新启动应用程序的东西。然后，在 中`onCreate()`，只要没有捆绑对象，就使用 SharedPreferences 接口来调用这些设置。

3a) 至于分数之类的东西，你可以按照上面 Mathias 的建议，将分数存储在返回的目录中`getFilesDir()`，使用`openFileOutput()`等。我认为这个目录是应用程序私有的，并且存在于主存储中，这意味着其他应用程序和用户将无法访问数据。如果你没问题，那么这可能是要走的路。

3b）如果您确实希望其他应用程序或用户可以直接访问数据，或者如果数据将非常大，那么 sdcard 就是要走的路。选择一个目录名称，如 com/user1446371/basketballapp/ 以避免与其他应用程序冲突（除非您确定您的应用程序名称是合理唯一的）并在 sdcard 上创建该目录。正如 Mathias 所指出的，您应该首先确认 sdcard 已安装。

```
File sdcard = Environment.getExternalStorageDirectory();
if( sdcard == null || !sdcard.isDirectory()) {
    fail("sdcard not available");
}
File datadir = new File(sdcard, "com/user1446371/basketballapp/");
if( !datadir.exists() && !datadir.mkdirs() ) {
    fail("unable to create data directory");
}
if( !datadir.isDirectory() ) {
    fail("exists, but is not a directory");
}
// Now use regular java I/O to read and write files to data directory 
```

我建议为您的数据使用简单的 CSV 文件，以便其他应用程序可以轻松读取它们。

显然，您必须编写允许“保存”和“打开”对话框的活动。我通常只是调用 openintents 文件管理器并让它完成工作。但是，这需要您的用户安装 openintents 文件管理器才能使用这些功能。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-09-30T23:00:10.197

在 onCreate 中：

```
SharedPreferences sharedPref = getSharedPreferences("mySettings", MODE_PRIVATE);

    String mySetting = sharedPref.getString("mySetting", null); 
```

在 onDestroy 或等效项中：

```
SharedPreferences sharedPref = getSharedPreferences("mySettings", MODE_PRIVATE);

    SharedPreferences.Editor editor = sharedPref.edit();
    editor.putString("mySetting", "Hello Android");
    editor.commit(); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-09T15:50:25.243

使用 SharedPreferences，[http://developer.android.com/reference/android/content/SharedPreferences.html](http://developer.android.com/reference/android/content/SharedPreferences.html)

这是一个示例：http: [//developer.android.com/guide/topics/data/data-storage.html#pref](http://developer.android.com/guide/topics/data/data-storage.html#pref)

如果数据结构比较复杂或者数据量大，使用[Sqlite](http://developer.android.com/guide/topics/data/data-storage.html#db)数据库；但是对于少量数据和非常简单的数据结构，我会说，SharedPrefs 会做，并且数据库可能是开销。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-04-22T11:10:43.190

有很多选项可以存储您的数据，Android 让您可以选择任何人您的数据存储选项如下：

Shared Preferences 将私有原始数据存储在键值对中。内部存储 将私人数据存储在设备内存中。外部存储 将公共数据存储在共享的外部存储上。SQLite 数据库将结构化数据存储在私有数据库中。网络连接 使用您自己的网络服务器在 Web 上存储数据

[在此处](http://developer.android.com/guide/topics/data/data-storage.html)查看示例和教程

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2021-06-02T13:37:43.307

## **2021答案**

老问题，但在 2021 年，您可以使用多种方法来保存数据。

**1\. 使用本地数据库**- Room Library

Room 是一个库，可让您将数据存储在 Android 设备附带的内部 SqlLite 数据库中，它是一个本地数据库。这很容易而且非常强大。

[https://developer.android.com/training/data-storage/room](https://developer.android.com/training/data-storage/room)

**2\. 使用远程数据库**- Firebase / 你自己的数据库实现

您可以在服务器上使用 Firebase 服务或您自己的数据库实现来远程存储您的数据，这样您就可以通过多个设备访问数据。

[https://firebase.google.com/docs/firestore](https://firebase.google.com/docs/firestore)

**3\. 存储本地文件**

您可以将所有信息存储在设备外部存储中保存的本地文件中，可能使用带有 \n 作为数据分隔符的 .txt 文件。这个选项在 2021 年看起来真的很“穴居人”。

[https://stackoverflow.com/a/14377185/14327871](https://stackoverflow.com/a/14377185/14327871)

**4\. 使用 SharedPreferences**

正如许多人指出的那样，您还可以使用 sharedPreferences 将少量信息存储为键值对，例如在跨会话保存用户首选项时很有用。

[https://developer.android.com/training/data-storage/shared-preferences?hl=en](https://developer.android.com/training/data-storage/shared-preferences?hl=en)

对于 OP 案例，我建议使用第一个或第二个选项。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-09T15:53:05.117

1.  共享偏好： [高分的android共享偏好示例？](https://stackoverflow.com/questions/5384499/android-shared-preferences-example-for-high-scores)

2.  您的应用程序是否可以访问“外部存储媒体”。如果是这样，那么您可以简单地将值（将其与时间戳一起存储）写入文件并保存。如果这就是您要查找的内容，时间戳将帮助您显示进度。{不是一个聪明的解决方案。}

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-10-06T21:40:57.380

请不要忘记一件事 - 卸载应用程序时会删除内部存储数据。在某些情况下，它可能是“意外功能”。然后最好使用外部存储。

[关于存储的 Google 文档](http://developer.android.com/guide/topics/data/data-storage.html)- 请特别查看 getExternalStoragePublicDirectory

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-02-22T04:31:57.777

快速回答：

```
public class MainActivity extends AppCompatActivity implements View.OnClickListener {

    Boolean Music;

    public static final String PREFS_NAME = "MyPrefsFile";

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        //restore preferences
        SharedPreferences settings = this.getSharedPreferences(PREFS_NAME, 0);
        Music = settings.getBoolean("key", true);
    }

    @Override
    public void onClick() {

                //save music setup to system
                SharedPreferences settings = this.getSharedPreferences(PREFS_NAME, 0);
                SharedPreferences.Editor editor = settings.edit();
                editor.putBoolean("key", Music);
                editor.apply();
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-07-20T15:08:21.847

**您可以存储您的分数并轻松加载它们！通过使用此方法** 使用此库[Paper Db](https://github.com/pilgr/Paper)

在您的应用中添加此库：

```
implementation 'io.github.pilgr:paperdb:2.7.1' 
```

然后在您存储的活动 onCreate() 中对其进行一次初始化：

```
Paper.init(context) 
```

创建一个密钥来存储你的分数

```
int myScore=10;
Paper.book().write("scores", myScore); 
```

并获得 score 的值：

```
int mySavedScores=Paper.book().read("scores"); 
```

而已！！！现在即使应用程序关闭，您也可以保存和访问该值，并参考文档以获取更多方法和信息，阅读文档是一个好习惯。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2012-06-09T15:53:55.223

在我看来，db4o 是最简单的方法。在这里你可以找到一个教程：http: [//community.versant.com/documentation/reference/db4o-7.12/java/tutorial/](http://community.versant.com/documentation/reference/db4o-7.12/java/tutorial/)

在这里你可以下载图书馆：

[http://www.db4o.com/community/download.aspx?file=db4o-8.0-java.zip](http://www.db4o.com/community/download.aspx?file=db4o-8.0-java.zip)

（只需将lib目录下的db4o-8.0...-all-java5.jar放到你项目的libs文件夹中。如果你的项目中没有libs文件夹就创建它）

由于 db4o 是一个面向对象的数据库系统，您可以直接将对象保存到数据库中，然后再将它们取回。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2020-02-22T06:35:44.470

使用此方法可以非常轻松地使用 sharedPreferences。

```
private val sharedPreferences = context.getSharedPreferences("myPreferences", Context.MODE_PRIVATE)

fun put(key: String, value: String) = sharedPreferences.edit().putString(key, value).apply()

fun put(key: String, value: Int) = sharedPreferences.edit().putInt(key, value).apply()

fun put(key: String, value: Float) = sharedPreferences.edit().putFloat(key, value).apply()

fun put(key: String, value: Boolean) = sharedPreferences.edit().putBoolean(key, value).apply()

fun put(key: String, value: Long) = sharedPreferences.edit().putLong(key, value).apply()

fun getString(key: String, defaultValue: String? = null): String? = sharedPreferences.getString(key, defaultValue)

fun getInt(key: String, defaultValue: Int = -1): Int = sharedPreferences.getInt(key, defaultValue)

fun getFloat(key: String, defaultValue: Float = -1F): Float = sharedPreferences.getFloat(key, defaultValue)

fun getBoolean(key: String, defaultValue: Boolean = false): Boolean = sharedPreferences.getBoolean(key, defaultValue)

fun getLong(key: String, defaultValue: Long = -1L): Long = sharedPreferences.getLong(key, defaultValue)

fun clearAll() = sharedPreferences.edit().clear().apply() 
```

将它们放在一个类中并在其构造函数中获取上下文。

# php - 如何在 PDO 中使用会话？

> ID：10962345
> 
> 赞同：2
> 
> 时间：2012-06-09T15:44:47.697
> 
> 标签：php, session, login, pdo

我仍在重做并删除代码中的旧 mysql_* 命令。我试图转移我的会话登录表单旧代码，这就是我到目前为止得到的：

```
 public function login($user, $password)
  {
    if (!empty($user) && !empty($password))
    {    
      $password = $web->doHash($user, $password); // in this function is (return sha1(strtoupper($user).':'.strtoupper($password))
      $stmt = $db_login->prepare("SELECT * FROM account WHERE username=:user AND pass_hash=:password");
      $stmt->bindValue(':user', $user, PDO::PARAM_STR);
      $stmt->bindValue(':password', $password, PDO::PARAM_STR);
      $stmt->execute();
      $rows = $stmt->rowCount();

      if ($rows > 0)      
      {    
        $results_login = $stmt->fetch(PDO::FETCH_ASSOC);
        $_SESSION['user_name'] = $results_login['username'];
        $_SESSION['user_id'] = $results_login['id'];  
        return true;
      }
      else
      {
        return false;
      }
    }
    else
    {
      return false;
    }
  } 
```

之后，我使用检查用户是否登录网站：

```
 public function isLogged()
  {
    return (!empty($_SESSION['user_id']) && !empty($_SESSION['user_name']));
  } 
```

但似乎 - 这个函数返回总是空的，因为 $_SESSION 在 PDO 中不存在？当然，在我的网站上以这种形式使用注销：

```
 public function logout()
  { 
      unset($_SESSION['user_id']);
      unset($_SESSION['user_name']);       
  } 
```

但我认为 PDO 有不同的会话处理方式？我没有找到任何东西，所以我能以某种方式在 PDO 中添加 $_SESSION 而无需过多更改代码吗？

我在整个网络项目中都`$_SESSION['user_name']`使用变量。`$_SESSION['user_id']`

概括：

1）如何正确使用PDO中的会话？

`$stmt->fetch(PDO::FETCH_ASSOC);`2）使用和之间有什么区别`$stmt->fetchAll();`

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T16:25:48.360

答案如下：

1.  `session_start()`在您使用会话的每个页面的顶部调用。
2.  不同之处在于`$stmt->fetch()`它将获取一行，`fetchAll()`并将获取整个结果集。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T15:54:28.643

`PDOStatement::rowCount()`mysql 不起作用，所以 $rows 不会返回任何东西。另外，PDO与会话无关，它是处理数据库的扩展。

如果你想计算结果的数量，你可以做

```
$stmt->execute();
$results = $stmt->fetchAll();
$results = count($results); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T16:37:06.087

答案：

1) 确保 session_start() 在所有使用 Sessions 的页面开始时被调用

2) 确保从您的查询中返回数据

更多信息

`PDO::FETCH_ASSOC`检索按列名索引的数据。即[关联数组](http://www.informit.com/articles/article.aspx?p=31840&seqNum=3)。

在我看来，使用 总是更好，`PDO::FETCH_ASSOC`因为很清楚正在获取和处理哪些数据。

如果您选择，您还可以使用此代码以关联数组格式获取所有行`fetchAll(PDO::FETCH_ASSOC)`

有关 `FetchAll`PDO 功能的更多信息，请查看[此处](http://php.net/manual/en/pdostatement.fetchall.php)

# asp.net - 如何用我的覆盖 RadWindow 控件 CSS 类？

> ID：10962347
> 
> 赞同：1
> 
> 时间：2012-06-09T15:44:51.400
> 
> 标签：asp.net, css, telerik, radwindow

![在此处输入图像描述](../Images/33bb15703f34b73ed97293d3f188c62a.png)你好，

我正在使用具有自己的 css 的 Telerik 控件（RadWindow）。

我想编辑控件设计并更改颜色、背景等。

我希望我的 CSS 覆盖控件 CSS，所以我使用了相同的类名称，但结果是我的类被控件的 CSS 覆盖。

这里有谁知道我该怎么做才能解决它？

我附上了屏幕截图以使自己更清楚。

非常感谢你的帮助！英巴尔。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T16:10:21.393

一种从另一个覆盖 CSS 的简单方法是使选择器更具体，例如通过预先添加一个额外的选择器：

```
body div.radwindow_Gray table td.topleft { /* Your new properties */ } 
```

在此示例中，我已添加`body`到选择器中。

> 你的 CSS 选择器越具体，它就越重要。

另一种解决方案是附加`!important`到属性值*（在 IE6 中不起作用）*：

```
div.radwindow_Gray table td.topleft { background: red !important } 
```

HTML 文档中的 CSS 文件高于 radWindow 中的 CSS 文件。
在 radWindow 中的最后一个 CSS 文件之后移动您的 CSS 文件，也将解决您的问题，因为您的 CSS 将覆盖来自 radWindow 的那些。这样，您可以保持选择器与 radWindow 的 CSS 相同。

# php - 在 Python 中重写 PHP 正则表达式

> ID：10962348
> 
> 赞同：-2
> 
> 时间：2012-06-09T15:45:21.590
> 
> 标签：php, python, django, google-app-engine, webapp2

我正在为 App Engine 上的基于 Python 的开源博客平台（类似于 WordPress）编写一个插件（带有 WebApp 框架和 Django 模板）

这个插件和这个完全一样：[http ://wordpress.org/extend/plugins/blog-mechanics-keyword-link-plugin-v01/](http://wordpress.org/extend/plugins/blog-mechanics-keyword-link-plugin-v01/)

> 一个允许您定义关键字/链接对的插件。关键字会自动链接到您的每个帖子中。

这是关键的正则表达式源代码：

```
// The regular expression comes from an older 
// auto link plugin by Sean Hickey. It fixed the autolinking inside a link
// problem. Thanks to [Steph] for the code.

// For keywords with quotes (') to work, we need to disable word boundary matching
if ($ignorecase) $case = "i"; else $case="";
$cleankeyword = preg_quote($cleankeyword,'\'');
if (BM_KEYWORDLINK_QUOTES && strpos( $cleankeyword  , '\'')>0)
    $regEx = '\'(?!((<.*?)|(<a.*?)))(' . $cleankeyword . ')(?!(([^<>]*?)>)|([^>]*?</a>))\'s' . $case;
else
     $regEx = '\'(?!((<.*?)|(<a.*?)))(\b'. $cleankeyword . '\b)(?!(([^<>]*?)>)|([^>]*?</a>))\'s' . $case; 

$content = preg_replace($regEx,$url,$content,$limit); 
```

如何在 Python 中重写正则表达式？我没有PHP经验。

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T16:21:46.267

**你试过**什么？通过`re`手册。它有很多很好的信息，它会回答你可能遇到的许多问题。例如，`re.escape`用于使外部字符串安全。

# php - 从mysql数据库编码和拉取

> ID：10962349
> 
> 赞同：0
> 
> 时间：2012-06-09T15:45:28.897
> 
> 标签：php, javascript, mysql, html, linux

我在不同的位置有 2 台服务器，我需要一个安全的服务器来执行此操作。

SERVER1 显示 SERVER2 上 Web 应用程序的最新条目。此应用程序来自子域，因此出于安全原因，它与主网站不在同一台服务器上。

问题。SERVER1 上的主站点从该 Web 应用程序的数据库中提取，该 Web 应用程序现在位于 SERVER2 上。我无法进行远程 SQL 连接，因为这太慢了。

有没有一种理想的方法来编码或做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T15:59:04.567

如果我正确理解您的问题，您正在寻找一种从 server2 查询 server1 数据库的方法，而不使用远程 SQL 连接，因为它太慢了。

基于此，任何类型的远程操作都会太慢（例如，SSH 隧道不会加快速度，因为它只是为进程添加加密）。

就个人而言，我会设置某种数据库复制 - 每次在 server1 上插入/更改/删除记录时，都会将该更改推送到 server2。然后，您就可以像在本地一样查询 server1（即在 server2 上查询它），它始终是最新的，并且应该足够快以满足您的需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T16:01:28.057

远程 SQL 连接是可行的方法。

另一种选择是跨`SERVER1`and进行复制`SERVER2`，因此每个连接都是本地的。

# javascript - 使用 Google Maps API 进行地理定位

> ID：10962350
> 
> 赞同：1
> 
> 时间：2012-06-09T15:45:35.183
> 
> 标签：javascript, geolocation, ip

我的一个朋友最近给了我他们的旧网页设计师杂志，还有一个关于如何使用 Google 或 Bing Maps API 显示访问者位置的小教程。

这是他们提供的代码：[The Code](http://n1x.co.uk/geolocation.txt)。

问题是，编写 tut 的人说给定的代码应该传递给 Google/Bing 地图 API，但我不知道该怎么做。

请帮忙！！

**PS我的计算机语言*很差*，所以请尽可能清楚地描述。谢谢**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T15:52:24.860

首先包括 Google Maps API：

```
<script src="http://maps.google.com/maps?file=api&amp;v=2&amp;sensor=false&amp;key=YOUR_KEY" type="text/javascript"></script> 
```

现在

```
<script type="text/javascript">

var map = null;

function initialize() 
{
  if (GBrowserIsCompatible()) 
  {        
    map = new GMap2(document.getElementById("googleMap"));
    map.setUIToDefault();
  }
}

// your code:

function get_location()
{ 
    navigator.geolocation.getCurrentPosition(map);
}

function show_map(position)
{
    var latitude=position.coords.latitude; 
    var longitude=position.coords.longitude; 

    map.setCenter(new GLatLng(latitude, longitude), 13);
}

</script> 
```

# java - 尝试在 JTree 中使用 setSelectionPath 时出现 java.util.ConcurrentModificationException

> ID：10962356
> 
> 赞同：0
> 
> 时间：2012-06-09T15:46:31.207
> 
> 标签：java, swing, exception, jtree

单击按钮以在 JTree 中设置选择路径后，我一直在尝试。该代码正确设置了路径，但是每次单击它时，我都会得到一个

```
Exception in thread "AWT-EventQueue-0" java.util.ConcurrentModificationException
at java.util.AbstractList$Itr.checkForComodification(Unknown Source)
at java.util.AbstractList$Itr.next(Unknown Source)
at com.treeview.main.iui.SelectableTree.actionPerformed(SelectableTree.java:225)
at javax.swing.AbstractButton.fireActionPerformed(Unknown Source)
at javax.swing.AbstractButton$Handler.actionPerformed(Unknown Source)
at javax.swing.DefaultButtonModel.fireActionPerformed(Unknown Source)
at javax.swing.DefaultButtonModel.setPressed(Unknown Source)
at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(Unknown Source)
at java.awt.Component.processMouseEvent(Unknown Source)
at javax.swing.JComponent.processMouseEvent(Unknown Source)
at java.awt.Component.processEvent(Unknown Source)
at java.awt.Container.processEvent(Unknown Source)
at java.awt.Component.dispatchEventImpl(Unknown Source)
at java.awt.Container.dispatchEventImpl(Unknown Source)
at java.awt.Component.dispatchEvent(Unknown Source)
at java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)
at java.awt.LightweightDispatcher.processMouseEvent(Unknown Source)
at java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)
at java.awt.Container.dispatchEventImpl(Unknown Source)
at java.awt.Window.dispatchEventImpl(Unknown Source)
at java.awt.Component.dispatchEvent(Unknown Source)
at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
at java.awt.EventQueue.access$000(Unknown Source)
at java.awt.EventQueue$1.run(Unknown Source)
at java.awt.EventQueue$1.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
at java.awt.EventQueue$2.run(Unknown Source)
at java.awt.EventQueue$2.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
at java.awt.EventQueue.dispatchEvent(Unknown Source)
at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
at java.awt.EventDispatchThread.run(Unknown Source) 
```

我不知道是什么原因造成的。我读到当您多个线程尝试访问同一资源但我看不到问题时会发生这种情况。

这是我要运行的代码：

```
/**
     * Handles the event when a button is clicked.
     */
    @Override
    public void actionPerformed(ActionEvent arg0) {
            // If button "Force adaptation is clicked"
            if (arg0.getSource() == forceAdapt) {
                    // ModelContainer.getInstance().getAdaptedTree().removeAllChildren();
                    // tree.setModel(new DefaultTreeModel(ModelContainer.getInstance()
                    // .getAdaptedTree()));
                    // treeModel.reload();
            } else if (arg0.getSource() == showAll) {
                    expandFullTree(tree, ModelContainer.getInstance().getAdaptedTree());
                    // If button "Show All" is clicked
                    // tree.setModel(new DefaultTreeModel(ModelContainer.getInstance()
                    // .getFullTree()));
                    // treeModel.reload();
            }
            // In case recommendation button was clicked.

            for (JButton button : recommendButtons) {
                    if (arg0.getSource() == button) {
                            TreeHandler th = new TreeHandler();
                            TreeItem node = th.getNodeByName(ModelContainer.getInstance()
                                            .getAdaptedTree(), button.getText());

                            tree.setSelectionPath(new TreePath(node.getPath()));
                    }
            }

    } 
```

这两种方法用按钮填充 ArrayList：

```
 /**
 * Handles tree selection event.
 */
public void valueChanged(TreeSelectionEvent event) {
    selectedNode = (TreeItem) tree.getLastSelectedPathComponent();

    // If there's predecessors.
    if (!lastSelectedNode.getId().equals("-1")) {
        // Display selection in bottom bar.
        currentSelectionField.setText("Current Selection: "
                + selectedNode.toString() + " Prev Node : "
                + lastSelectedNode.toString());
        /*
         * Increase the clicks in the transition matrix and updates the
         * probability transition matrix.
         */
        ModelContainer.getInstance().increaseClicksOnElement(
                Integer.parseInt(selectedNode.getId()) - 1,
                Integer.parseInt(lastSelectedNode.getId()) - 1);
        // Recalculate the Markovian matrix.
        ModelContainer.getInstance().recalculateMarkovian();

        // Display recommendations
        displayRecommendations(ModelContainer.getInstance()
                .getNextMarkovians(
                        (Integer.parseInt(selectedNode.getId()) - 1) + "",
                        5));

    }

    lastSelectedNode = selectedNode;

}

public void displayRecommendations(ArrayList<TreeItem> recommend) {

    recommendation.removeAll();

    int place = 2;
    for (TreeItem treeItem : recommend) {
        JButton aButton = new JButton(treeItem.toString());
        aButton.setPreferredSize(new Dimension(recommendation.getWidth(),
                recommendation.getHeight() / place));
        aButton.addActionListener(this);
        recommendButtons.add(aButton);
        recommendation.add(aButton);
        System.out.println(aButton.getText());
        place = place * 2;
    }
    recommendation.revalidate();
    recommendation.repaint();

} 
```

# python - 渲染时捕获 IOError：没有足够的数据

> ID：10962358
> 
> 赞同：0
> 
> 时间：2012-06-09T15:46:57.273
> 
> 标签：python, django, sorl-thumbnail

我在创建缩略图的过程中遇到了问题。我在其最新版本中使用 sorl.thumbnail。

错误指向我的缩略图，但图像的地址存在。

```
{% thumbnail img "255x120" crop="center" as im %}
<img src="{{ im.url }}" height="120" />
{% endthumbnail %} 
```

它指控问题出在 PIL 上：

```
Request Method: GET
Request URL:    http://localhost:8000/
Django Version: 1.3.1
Exception Type: TemplateSyntaxError
Exception Value:    
Caught IOError while rendering: not enough data
Exception Location: D:\CODE\wamp\www\AMBIENTES\env\lib\site-packages\PIL\TiffImagePlugin.py in load, line 383 
```

完整追溯： [http ://dpaste.de/R2zLw/](http://dpaste.de/R2zLw/)

# php - PHP 运算符查看某物是否包含某物的一部分

> ID：10962359
> 
> 赞同：0
> 
> 时间：2012-06-09T15:47:05.273
> 
> 标签：php, preg-match

我目前有一个问题。我有一个看起来像下面的代码，我想要一个运算符来检查查询的一部分是否存在于数组中。这是我拥有的代码：

```
<?php
$search = 'party hat';
$query = ucwords($search);
$string = file_get_contents('http://clubpenguincheatsnow.com/tools/newitemdatabase/items.php');
$string = explode('<br>',$string);
foreach($string as $row)
{
    preg_match('/^(\D+)\s=\s(\d+)\s=\s(\D+)\s=\s(\d+)/', trim($row), $matches);
    if($matches[1] == "$query")
    {
        echo "<a href='http://clubpenguincheatsnow.com/tools/newitemdatabase/info.php?id=$matches[2]'>";
        echo $matches[1];
        echo "</a><br>";
    }
}
?> 
```

我想要做的不是`if($matches[1] == "$query")`检查两者是否相同，而是希望我的代码`$query`查看`$matches[1]`. 我该怎么做呢？请帮我！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T15:49:28.197

您可以使用[`strpos`](http://php.net/strpos)来测试一个字符串是否包含在另一个字符串中：

```
if(strpos($matches[1], $query) !== false) 
```

如果您希望它不区分大小写，请[`stripos`](http://php.net/stripos)改用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T15:50:33.977

如果要检查 $query 是否是 $matches[1] 的子字符串，可以使用

`strpos($matches[1], $query) !== false`

（请参阅文档了解为什么必须使用！==）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T15:55:55.853

您可以使用 strstr 来测试一个字符串是否包含另一个字符串：

```
if(strstr($matches[1], $query)) {
    // do something ...
} 
```

# driver - 如果 WinDbg 附加断点，驱动程序加载/卸载失败

> ID：10962361
> 
> 赞同：3
> 
> 时间：2012-06-09T15:47:28.573
> 
> 标签：driver, windbg, device-driver, wdk

我刚开始开发驱动程序。对于加载、卸载和调试的一些实验，我编写了以下简单的驱动程序：

```
#include <ntddk.h> 

void DriverUnload(PDRIVER_OBJECT pDriverObject) 
{ 
    UNREFERENCED_PARAMETER(pDriverObject);
    DbgPrint("Driver unloading\n"); 
} 

NTSTATUS DriverEntry( 
    PDRIVER_OBJECT DriverObject, 
    PUNICODE_STRING RegistryPath) 
{ 
    UNREFERENCED_PARAMETER(DriverObject);
    UNREFERENCED_PARAMETER(RegistryPath);

    DriverObject->DriverUnload = DriverUnload; 
    DbgPrint("Hello, World\n"); 

    return STATUS_SUCCESS; 
} 
```

我为我的目标系统 Windows 7 64bit 编译了带有调试符号的驱动程序，将其复制到目标系统并使用 OSR Driver Loader 加载并运行它。

一切正常，我可以卸载和加载驱动程序：![在此处输入图像描述](../Images/daee00e4942a2decdb458e51a97342db.png)

我可以使用串行连接与 WinDbg 连接，并且可以成功中断并运行目标系统。但是，当我尝试设置断点时会出现问题。

我最初尝试像这样设置断点：

> kd> bp MyDriver1!DriverEntry

但问题是，如果我重新加载驱动程序并检查断点：

> kd> bl
> 0 e fffff880`03572010 0001 (0001) < Unloaded_MyDriver1.sys >+0x1010

对于作为初学者的我来说，它看起来不太好（卸载？）并且加载时没有发生中断。

所以，我发现可以在加载模块时设置断点：

> kd> bu MyDriver1
> 
> 0 e fffff880`03578000 0001 (0001) MyDriver1!DriverEntry < PERF > (MyDriver1+0x0)

当我在上述命令后继续执行系统并加载驱动程序（net start MyDriver1）时，系统崩溃：

> 中断指令异常 - 代码 80000003（第一次机会）
> 
> * * *
> 
> *   *
> *   您看到此消息是因为您按了 *
> *   CTRL+C（如果您运行控制台内核调试器）或者，*
> *   CTRL+BREAK（如果您运行 GUI 内核调试器），*
> *   在调试器机器的键盘上。*
> *   *
> *   这不是错误或系统崩溃 *
> *   *
> *   如果您不打算闯入调试器，请按“g”键，然后 *
> *   现在按“Enter”键。此消息可能会立即再次出现。如果它 *
> *   确实，请再次按“g”和“Enter”。*
> *   *
>     
>     * * *
>     
>     
> 
> nt!RtlpBreakWithStatus 指令：fffff800 `028ca490 cc int 3 kd > bu MyDriver1 kd> bl 0 e fffff880`03572010 0001
> 
> (0001) MyDriver1!DriverEntry < 性能 > (MyDriver1+0x0)
> 
> kd > bc 0 kd> bl 1 e fffff880`03578000 0001 (0001)
> 
> MyDriver1!DriverEntry (MyDriver1+0x0)
> 
> kd> g 访问冲突 - 代码 c0000005 (!!!第二次机会!!!)
> 
> nt!IopUnloadDriver+0x327: fffff800`02cb8b29 0fb74844 movzx
> 
> ecx,word ptr [rax+44h]

最后，如果我现在继续执行，我会得到一个 BSOD ......

这里有什么问题？是我的代码错误还是我设置的断点不正确？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T16:48:30.067

您要查找的命令是 sxe ld:MyDriver1

这将在驱动程序映射到内存但在调用 MyDriver1!DriverEntry 之前中断，并允许您在 DriverEntry 处放置断点。

该命令`bu MyDriver1`在驱动程序映像的 PE 标头的第一个字节中放置一个断点。

此外，在卸载驱动程序后清理断点，否则会导致调试器修改可能分配给其他内容的内存。

# windows-phone-7 - 媒体播放器项目，锁屏WP7？

> ID：10962364
> 
> 赞同：0
> 
> 时间：2012-06-09T15:47:37.803
> 
> 标签：windows-phone-7, windows-phone-7.1

我正在使用 Media Player 类做简单的媒体播放器，但我遇到了一些问题。当我在播放音乐时锁定屏幕然后解锁时，音乐停止。如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T09:21:08.210

您可以通过禁用空闲检测来启用应用程序在锁屏下锁定

```
PhoneApplicationService.Current.ApplicationIdleDetectionMode = IdleDetectionMode.Disabled; 
```

更好的方法是使用后台音频代理（参见[http://msdn.microsoft.com/en-us/library/hh202978(v=vs.92).aspx](http://msdn.microsoft.com/en-us/library/hh202978(v=vs.92).aspx)）

# delphi - 测试未在接口部分声明的类

> ID：10962366
> 
> 赞同：3
> 
> 时间：2012-06-09T15:48:02.627
> 
> 标签：delphi, delphi-xe2, spring4d

我是一个依赖注入容器的新手，我正在尝试将它们与 Mocking 结合使用。

假设我有一个控制器和一个列表（模型）：

```
IBlahList = interface
  property Items[AIndex: integer]: IBlah read GetItem;
end;

IController = interface
  property List: IBlahList read GetList;
end; 
```

IController 的实现看起来像（注意，它在以下`implementaion`部分：

```
implementation

TController = class (TInterfacedObject, IController)
private
  FList: IBlahList;
  function GetList: IBlahList;

public
  constructor Create(const AList: IBlahList);

end; 
```

然后，当然，我会注册这个类（以及 IBlahList 的一个）`GlobalContainer`：

```
GlobalContainer.RegisterType<TController>.Implements<IController>; 
```

`implementation`根据各种来源的建议（好吧，无论如何，尼克霍奇斯！），我将 TController 放在该部分中，这样我们就不能直接引用 TController 类。

现在，只是说我想在单元测试中测试我的 ICollection 实现：

```
procedure TestSomething
var
  LMockList: TMock<IBlahList>;
  LController: IController;
begin
  LMockList := TMock<IBlahList>.Create;

  // Oops, I can't do this, I can't access TController
  LController := TController.Create(LMockList);

end; 
```

所以，我的问题是，我应该将 TController 类移到我的`interface`部分中以便我可以测试它，还是有其他方法可以将模拟 IBlahList 传递给我尚未找到的控制器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T17:28:29.287

如果您在实现部分中有具体类，那么您可以公开一个工厂函数（即在接口部分中有它），它创建一个具有所需参数的 IController。

拥有一个无法实例化的实现绝对没有意义，IMO。

```
interface

...

function CreateController(AList: IBlahList): IController;

implementation

function CreateController(AList: IBlahList): IController;
begin
  Result := TController.Create(AList);
end; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T16:18:41.133

好吧，您可能也应该在测试项目中使用模拟框架，但在这些情况下，我通常“作弊”并`implementation`使用 DUNIT 条件变量将其移动到我需要的地方：

```
// In the real app, we want the implementation and uses clauses here.
{$IFNDEF DUNIT}  
implementation
uses
  classes;
{$ENDIF}

type
  TClassUnderTest = class(TObject)
    // ...
  end;

// In test projects it is more convenient to have the implemenation and 
// uses clauses down here.
{$IFDEF DUNIT}
implementation
uses
  classes;
{$ENDIF} 
```

然后确保任何测试项目都定义了 DUNIT 条件变量，并将 TClassUnderTest 声明所需的任何单元移动到接口部分。后者您可以永久执行或在 DUNIT 条件控制下执行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-10T13:00:14.357

我只能说：在这种情况下不要听尼克的。

将一个类放在一个单元的实现部分中只是有缺点，你正面临其中之一。

使用依赖注入的全部意义在于解耦你的代码片段。

现在你删除了 TController 的静态依赖和一些实现 IBlahList 的类，但是你引入了另一个（更糟糕的 imo）依赖：对 DI 容器的依赖。

不要将类放在单元的实现部分中，只是为了防止有人直接在您的生产代码中创建它。也不要将对 DI 容器的依赖项放入该单元中。

更好的方法是拥有 3 个单元：接口、类、注册。

编辑：我建议阅读这篇文章并注意下划线部分：[http ://www.loosecouplings.com/2011/01/dependency-injection-using-di-container.html](http://www.loosecouplings.com/2011/01/dependency-injection-using-di-container.html)

Edit2 - 添加了一些伪代码来说明我的意思。单元测试代码可能与问题完全相同。

```
unit Interfaces;

interface

type
  IBlahList = interface
    property Items[AIndex: integer]: IBlah read GetItem;
  end;

  IController = interface
    property List: IBlahList read GetList;
  end;

implementation

end. 
```

-

```
unit Controller;

interface

uses
  Classes,
  Interfaces;

type
  TController = class (TInterfacedObject, IController)
  private
    FList: IBlahList;
    function GetList: IBlahList;
  public
    constructor Create(const AList: IBlahList);
  end;

implementation

...

end. 
```

-

```
unit Registration;

interface

implementation

uses
  Interfaces,
  Controller,
  Spring.Container;

initialization
  GlobalContainer.RegisterType<TController>.Implements<IController>;

end. 
```

# c# - 删除不带 .Include 的选择 N+1

> ID：10962367
> 
> 赞同：7
> 
> 时间：2012-06-09T15:48:11.770
> 
> 标签：c#, mysql, entity-framework, entity-framework-4, linq-to-entities

考虑这些人为的实体对象：

```
public class Consumer
{
    public int Id { get; set; }
    public string Name { get; set; }
    public bool NeedsProcessed { get; set; }
    public virtual IList<Purchase> Purchases { get; set; }  //virtual so EF can lazy-load
}

public class Purchase
{
    public int Id { get; set; }
    public decimal TotalCost { get; set; }
    public int ConsumerId { get; set; }
} 
```

现在假设我想运行这段代码：

```
var consumers = Consumers.Where(consumer => consumer.NeedsProcessed);

//assume that ProcessConsumers accesses the Consumer.Purchases property
SomeExternalServiceICannotModify.ProcessConsumers(consumers); 
```

默认情况下，这将受到 ProcessConsumers 方法中的 Select N+1 的影响。它会在枚举消费者时触发一个查询，然后它将一个一个地抓取每个购买集合。这个问题的标准解决方案是添加一个包含：

```
var consumers = Consumers.Include("Purchases").Where(consumer => consumer.NeedsProcessed);

//assume that ProcessConsumers accesses the Consumer.Purchases property
SomeExternalServiceICannotModify.ProcessConsumers(consumers); 
```

这在许多情况下都可以正常工作，但在一些复杂的情况下，包含可以完全破坏性能几个数量级。是否有可能做这样的事情：

1.  抓住我的消费者，var consumer = _entityContext.Consumers.Where(...).ToList()
2.  抓住我的购买，var purchase = _entityContext.Purchases.Where(...).ToList()
3.  水合消费者。从我已经加载到内存中的购买中手动购买集合。然后，当我将它传递给 ProcessConsumers 时，它不会触发更多的数据库查询。

我不确定如何做#3。如果您尝试访问任何会触发延迟加载（以及因此 Select N+1）的 consumer.Purchases 集合。也许我需要将消费者转换为正确的类型（而不是 EF 代理类型），然后加载集合？像这样的东西：

```
foreach (var consumer in Consumers)
{
     //since the EF proxy overrides the Purchases property, this doesn't really work, I'm trying to figure out what would
     ((Consumer)consumer).Purchases = purchases.Where(x => x.ConsumerId = consumer.ConsumerId).ToList();
} 
```

**编辑：** 我已经重写了这个例子，希望能更清楚地揭示这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T13:50:26.907

如果我理解正确，您希望在 1 个查询中同时加载过滤后的消费者子集和过滤后的购买子集。如果这不正确，请原谅我对您的意图的理解。如果这是正确的，您可以执行以下操作：

```
var consumersAndPurchases = db.Consumers.Where(...)
    .Select(c => new {
        Consumer = c,
        RelevantPurchases = c.Purchases.Where(...)
    })
    .AsNoTracking()
    .ToList(); // loads in 1 query

// this should be OK because we did AsNoTracking()
consumersAndPurchases.ForEach(t => t.Consumer.Purchases = t.RelevantPurchases);

CannotModify.Process(consumersAndPurchases.Select(t => t.Consumer)); 
```

请注意，如果 Process 函数希望修改消费者对象，然后将这些更改提交回数据库，则此方法将不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T19:00:27.020

您是否不可能通过在数据库上进行工作来解决多次往返或低效查询生成问题 - 主要是通过返回投影而不是特定实体，如下所示：

```
var query = from c in db.Consumers
            where c.Id > 1000
            select new { Consumer = c, Total = c.Purchases.Sum( p => p.TotalCost ) };
var total = query.Sum( cp => cp.Total ); 
```

无论如何，我都不是 EF 专家，所以如果这种技术不合适，请原谅我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T17:43:10.380

> **抓住我的消费者**

```
var consumers = _entityContext.Consumers
                              .Where(consumer => consumer.Id > 1000)
                              .ToList(); 
```

> **抓住我的购买**

```
var purchases = consumers.Select(x => new {
                                       Id = x.Id,
                                       IList<Purchases> Purchases = x.Purchases         
                                       })
                         .ToList()
                         .GroupBy(x => x.Id)
                         .Select( x => x.Aggregate((merged, next) => merged.Merge(next)))
                         .ToList(); 
```

> **水合消费者。从我已经加载到内存中的购买中手动购买集合。**

```
for(int i = 0; i < costumers.Lenght; i++)
   costumers[i].Purchases = purchases[i]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T16:42:57.357

如果您使用相同的上下文来获取两个集合， EF 将为`consumer.Purchases`您填充集合：

```
List<Consumer> consumers = null;
using ( var ctx = new XXXEntities() )
{
  consumers = ctx.Consumers.Where( ... ).ToList();

  // EF will populate consumers.Purchases when it loads these objects
  ctx.Purchases.Where( ... ).ToList();
}

// the Purchase objects are now in the consumer.Purchases collections
var sum = consumers.Sum( c => c.Purchases.Sum( p => p.TotalCost ) ); 
```

**编辑 ：**

这仅导致 2 次 db 调用：1 次获取集合，`Consumers`1次获取`Purchases`.

EF 将查看`Purchase`返回的每条记录并从中查找相应的`Consumer`记录`Purchase.ConsumerId`。然后它将为您将`Purchase`对象添加到`Consumer.Purchases`集合中。

* * *

选项 2：

如果出于某种原因您想从不同的上下文中获取两个列表然后链接它们，我会在`Consumer`类中添加另一个属性：

```
partial class Consumer
{
  public List<Purchase> UI_Purchases { get; set; }
} 
```

然后，您可以从集合中设置此属性`Purchases`并在您的 UI 中使用它。

# c# - 2 TcpClient 在同一台机器和端口上

> ID：10962369
> 
> 赞同：2
> 
> 时间：2012-06-09T15:48:56.513
> 
> 标签：c#, sockets

我是 C# 和网络编程的初学者，我有一个问题： - 我在端口 100 上有一个`TcpListner`和 2 `TcpClient`，它们都在同一台机器上运行，那么第二个客户端可以工作吗？或者它是否给出错误 - 端口已在使用中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T15:53:45.537

它们都应该工作，因为客户端不占用任何端口，它只是连接到它。您可以让多个客户端连接到同一个端口（例如，多个 Web 浏览器连接到同一个 Web 服务器）。但是，您不能在同一端口上拥有两台服务器，但这听起来不像您正在尝试做的事情。

一种简单的查找方法是运行所有内容并查看是否出现错误。

# c++ - 多重继承抽象类

> ID：10962372
> 
> 赞同：-1
> 
> 时间：2012-06-09T15:49:28.160
> 
> 标签：c++

测试.h

```
class A
{
    public:
        virtual void FunctionA(void) = 0;
        virtual ~A(void);
};
class B
{
    public:
        virtual void FunctionB(void) = 0;
        virtual ~B(void);
};
class C:public A, public B 
{
    public:
        virtual ~C(void) = 0;
}; 
```

测试.cpp

```
#include "test.h"
inline A::~A(void){}
inline B::~B(void){}
inline C::~C(void){} 
```

为什么会有警告 C4505 'C:~C' : unreferenced local function has been removed ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T15:54:29.123

您不能声明一个纯函数并在类主体中定义它，这不是合法的语法。我不知道警告意味着您的编译器认为它意味着什么。

你需要做这样的事情（对于你所有的纯虚拟析构函数）。

```
class A {
public:
    virtual void FunctionA() = 0;
    virtual ~A() = 0;
};
inline A::~A() {} 
```

或者，因为无论如何你的每个类中至少有一个纯虚函数，所以在这种情况下使析构函数纯虚函数没有真正的优点，所以你可以这样做（在类主体中）：

```
virtual ~A() {} 
```

**编辑：**另外，你需要有一个返回类型（例如`void`）`A::FunctionA()`和`B::FunctionB()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-01T15:42:36.010

这是[纯虚拟继承、多重继承和 C4505](https://stackoverflow.com/questions/12592865/pure-virtual-inheritance-multiple-inheritance-and-c4505)的副本。我从那里重新引用我的答案：

这是 MSVC++ 2010 及更早版本中的错误。即使编译器声称已删除代码，代码实际上也会被调用。它似乎已在 MSVC++ 2012 中修复。其他编译器（如 gcc 或 clang）不会发出警告。根据 C++03 标准第 10.4.2 节，语法“... = 0 {...}”是非法的（即使 MSVC++ 没有抱怨），正如已经指出的那样：

> 注意：函数声明不能​​同时提供纯说明符和定义

然而，定义一个纯虚析构函数通常不是非法的，第 12.4.7 节指出：

> 析构函数可以声明为虚拟（10.3）或纯虚拟（10.4）；如果在程序中创建了该类或任何派生类的任何对象，则应定义析构函数。如果一个类有一个带有虚拟析构函数的基类，那么它的析构函数（无论是用户声明的还是隐式声明的）都是虚拟的。

我禁用警告的方法是将以下几行添加到标题中：

```
#if defined(_MSC_VER) && (_MSC_VER <= 1600)
#  pragma warning(disable:4505)
#endif 
```

如果您想在本地更多地禁用警告，那么`#pragma warning( push )`可能`#pragma warning( pop )`会有所帮助。请参阅[http://msdn.microsoft.com/en-us/library/2c8f766e(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/2c8f766e%28v=vs.80%29.aspx)

由于代码似乎被调用，我认为您可以忽略警告。

# math - 如何检查两个旋转矩形之间的交点？

> ID：10962379
> 
> 赞同：32
> 
> 时间：2012-06-09T15:50:10.633
> 
> 标签：math, intersection, rect

有人可以解释如何检查**一个旋转的矩形是否与另一个矩形相交**吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-06-09T22:35:02.290

1.  对于两个多边形中的每条边，检查它是否可以用作分隔线。如果是这样，你就完成了：没有交叉点。
2.  如果没有找到分隔线，则您有一个交叉点。

```
/// Checks if the two polygons are intersecting.
bool IsPolygonsIntersecting(Polygon a, Polygon b)
{
    foreach (var polygon in new[] { a, b })
    {
        for (int i1 = 0; i1 < polygon.Points.Count; i1++)
        {
            int i2 = (i1 + 1) % polygon.Points.Count;
            var p1 = polygon.Points[i1];
            var p2 = polygon.Points[i2];

            var normal = new Point(p2.Y - p1.Y, p1.X - p2.X);

            double? minA = null, maxA = null;
            foreach (var p in a.Points)
            {
                var projected = normal.X * p.X + normal.Y * p.Y;
                if (minA == null || projected < minA)
                    minA = projected;
                if (maxA == null || projected > maxA)
                    maxA = projected;
            }

            double? minB = null, maxB = null;
            foreach (var p in b.Points)
            {
                var projected = normal.X * p.X + normal.Y * p.Y;
                if (minB == null || projected < minB)
                    minB = projected;
                if (maxB == null || projected > maxB)
                    maxB = projected;
            }

            if (maxA < minB || maxB < minA)
                return false;
        }
    }
    return true;
} 
```

有关更多信息，请参阅本文：[2D 多边形碰撞检测 - 代码项目](http://www.codeproject.com/Articles/15573/2D-Polygon-Collision-Detection)

**注意：**该算法仅适用于凸多边形，按顺时针或逆时针顺序指定。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-09-13T21:18:36.210

在 javascript 中，完全相同的算法是（为方便起见）：

```
/**
 * Helper function to determine whether there is an intersection between the two polygons described
 * by the lists of vertices. Uses the Separating Axis Theorem
 *
 * @param a an array of connected points [{x:, y:}, {x:, y:},...] that form a closed polygon
 * @param b an array of connected points [{x:, y:}, {x:, y:},...] that form a closed polygon
 * @return true if there is any intersection between the 2 polygons, false otherwise
 */
function doPolygonsIntersect (a, b) {
    var polygons = [a, b];
    var minA, maxA, projected, i, i1, j, minB, maxB;

    for (i = 0; i < polygons.length; i++) {

        // for each polygon, look at each edge of the polygon, and determine if it separates
        // the two shapes
        var polygon = polygons[i];
        for (i1 = 0; i1 < polygon.length; i1++) {

            // grab 2 vertices to create an edge
            var i2 = (i1 + 1) % polygon.length;
            var p1 = polygon[i1];
            var p2 = polygon[i2];

            // find the line perpendicular to this edge
            var normal = { x: p2.y - p1.y, y: p1.x - p2.x };

            minA = maxA = undefined;
            // for each vertex in the first shape, project it onto the line perpendicular to the edge
            // and keep track of the min and max of these values
            for (j = 0; j < a.length; j++) {
                projected = normal.x * a[j].x + normal.y * a[j].y;
                if (isUndefined(minA) || projected < minA) {
                    minA = projected;
                }
                if (isUndefined(maxA) || projected > maxA) {
                    maxA = projected;
                }
            }

            // for each vertex in the second shape, project it onto the line perpendicular to the edge
            // and keep track of the min and max of these values
            minB = maxB = undefined;
            for (j = 0; j < b.length; j++) {
                projected = normal.x * b[j].x + normal.y * b[j].y;
                if (isUndefined(minB) || projected < minB) {
                    minB = projected;
                }
                if (isUndefined(maxB) || projected > maxB) {
                    maxB = projected;
                }
            }

            // if there is no overlap between the projects, the edge we are looking at separates the two
            // polygons, and we know there is no overlap
            if (maxA < minB || maxB < minA) {
                CONSOLE("polygons don't intersect!");
                return false;
            }
        }
    }
    return true;
}; 
```

希望这可以帮助某人。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-12-05T05:34:22.187

如果有人感兴趣，这里是 Java 中的相同算法。

```
boolean isPolygonsIntersecting(Polygon a, Polygon b)
{
    for (int x=0; x<2; x++)
    {
        Polygon polygon = (x==0) ? a : b;

        for (int i1=0; i1<polygon.getPoints().length; i1++)
        {
            int   i2 = (i1 + 1) % polygon.getPoints().length;
            Point p1 = polygon.getPoints()[i1];
            Point p2 = polygon.getPoints()[i2];

            Point normal = new Point(p2.y - p1.y, p1.x - p2.x);

            double minA = Double.POSITIVE_INFINITY;
            double maxA = Double.NEGATIVE_INFINITY;

            for (Point p : a.getPoints())
            {
                double projected = normal.x * p.x + normal.y * p.y;

                if (projected < minA)
                    minA = projected;
                if (projected > maxA)
                    maxA = projected;
            }

            double minB = Double.POSITIVE_INFINITY;
            double maxB = Double.NEGATIVE_INFINITY;

            for (Point p : b.getPoints())
            {
                double projected = normal.x * p.x + normal.y * p.y;

                if (projected < minB)
                    minB = projected;
                if (projected > maxB)
                    maxB = projected;
            }

            if (maxA < minB || maxB < minA)
                return false;
        }
    }

    return true;
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-12-26T06:20:10.860

查看 Oren Becker 设计的用于检测旋转矩形与形状的交集的方法：

```
struct _Vector2D 
{
    float x, y;
};

// C:center; S: size (w,h); ang: in radians, 
// rotate the plane by [-ang] to make the second rectangle axis in C aligned (vertical)
struct _RotRect 
{
    _Vector2D C;
    _Vector2D S;
    float ang;
}; 
```

调用以下函数将返回两个旋转的矩形是否相交：

```
// Rotated Rectangles Collision Detection, Oren Becker, 2001
bool check_two_rotated_rects_intersect(_RotRect * rr1, _RotRect * rr2)
{
    _Vector2D A, B,   // vertices of the rotated rr2
       C,      // center of rr2
       BL, TR; // vertices of rr2 (bottom-left, top-right)

 float ang = rr1->ang - rr2->ang, // orientation of rotated rr1
       cosa = cos(ang),           // precalculated trigonometic -
       sina = sin(ang);           // - values for repeated use

 float t, x, a;      // temporary variables for various uses
 float dx;           // deltaX for linear equations
 float ext1, ext2;   // min/max vertical values

 // move rr2 to make rr1 cannonic
 C = rr2->C;
 SubVectors2D(&C, &rr1->C);

 // rotate rr2 clockwise by rr2->ang to make rr2 axis-aligned
 RotateVector2DClockwise(&C, rr2->ang);

 // calculate vertices of (moved and axis-aligned := 'ma') rr2
 BL = TR = C;
 /*SubVectors2D(&BL, &rr2->S);
 AddVectors2D(&TR, &rr2->S);*/

 //-----------------------------------
 BL.x -= rr2->S.x/2;    BL.y -= rr2->S.y/2;
 TR.x += rr2->S.x/2;    TR.y += rr2->S.y/2;

 // calculate vertices of (rotated := 'r') rr1
 A.x = -(rr1->S.y/2)*sina; B.x = A.x; t = (rr1->S.x/2)*cosa; A.x += t; B.x -= t;
 A.y =  (rr1->S.y/2)*cosa; B.y = A.y; t = (rr1->S.x/2)*sina; A.y += t; B.y -= t;
 //---------------------------------------

 //// calculate vertices of (rotated := 'r') rr1
 //A.x = -rr1->S.y*sina; B.x = A.x; t = rr1->S.x*cosa; A.x += t; B.x -= t;
 //A.y =  rr1->S.y*cosa; B.y = A.y; t = rr1->S.x*sina; A.y += t; B.y -= t;

 t = sina*cosa;

 // verify that A is vertical min/max, B is horizontal min/max
 if (t < 0)
 {
  t = A.x; A.x = B.x; B.x = t;
  t = A.y; A.y = B.y; B.y = t;
 }

 // verify that B is horizontal minimum (leftest-vertex)
 if (sina < 0) { B.x = -B.x; B.y = -B.y; }

 // if rr2(ma) isn't in the horizontal range of
 // colliding with rr1(r), collision is impossible
 if (B.x > TR.x || B.x > -BL.x) return 0;

 // if rr1(r) is axis-aligned, vertical min/max are easy to get
 if (t == 0) {ext1 = A.y; ext2 = -ext1; }
 // else, find vertical min/max in the range [BL.x, TR.x]
 else
 {
  x = BL.x-A.x; a = TR.x-A.x;
  ext1 = A.y;
  // if the first vertical min/max isn't in (BL.x, TR.x), then
  // find the vertical min/max on BL.x or on TR.x
  if (a*x > 0)
  {
   dx = A.x;
   if (x < 0) { dx -= B.x; ext1 -= B.y; x = a; }
   else       { dx += B.x; ext1 += B.y; }
   ext1 *= x; ext1 /= dx; ext1 += A.y;
  }

  x = BL.x+A.x; a = TR.x+A.x;
  ext2 = -A.y;
  // if the second vertical min/max isn't in (BL.x, TR.x), then
  // find the local vertical min/max on BL.x or on TR.x
  if (a*x > 0)
  {
   dx = -A.x;
   if (x < 0) { dx -= B.x; ext2 -= B.y; x = a; }
   else       { dx += B.x; ext2 += B.y; }
   ext2 *= x; ext2 /= dx; ext2 -= A.y;
  }
 }

 // check whether rr2(ma) is in the vertical range of colliding with rr1(r)
 // (for the horizontal range of rr2)
 return !((ext1 < BL.y && ext2 < BL.y) ||
      (ext1 > TR.y && ext2 > TR.y));
}

inline void AddVectors2D(_Vector2D * v1, _Vector2D * v2)
{ 
    v1->x += v2->x; v1->y += v2->y; 
}

inline void SubVectors2D(_Vector2D * v1, _Vector2D * v2)
{ 
    v1->x -= v2->x; v1->y -= v2->y; 
}

inline void RotateVector2DClockwise(_Vector2D * v, float ang)
{
    float t, cosa = cos(ang), sina = sin(ang);
    t = v->x; 
    v->x = t*cosa + v->y*sina; 
    v->y = -t*sina + v->y*cosa;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-07-10T02:58:34.857

在 Python 中：

```
def do_polygons_intersect(a, b):
    """
 * Helper function to determine whether there is an intersection between the two polygons described
 * by the lists of vertices. Uses the Separating Axis Theorem
 *
 * @param a an ndarray of connected points [[x_1, y_1], [x_2, y_2],...] that form a closed polygon
 * @param b an ndarray of connected points [[x_1, y_1], [x_2, y_2],...] that form a closed polygon
 * @return true if there is any intersection between the 2 polygons, false otherwise
    """

    polygons = [a, b];
    minA, maxA, projected, i, i1, j, minB, maxB = None, None, None, None, None, None, None, None

    for i in range(len(polygons)):

        # for each polygon, look at each edge of the polygon, and determine if it separates
        # the two shapes
        polygon = polygons[i];
        for i1 in range(len(polygon)):

            # grab 2 vertices to create an edge
            i2 = (i1 + 1) % len(polygon);
            p1 = polygon[i1];
            p2 = polygon[i2];

            # find the line perpendicular to this edge
            normal = { 'x': p2[1] - p1[1], 'y': p1[0] - p2[0] };

            minA, maxA = None, None
            # for each vertex in the first shape, project it onto the line perpendicular to the edge
            # and keep track of the min and max of these values
            for j in range(len(a)):
                projected = normal['x'] * a[j][0] + normal['y'] * a[j][1];
                if (minA is None) or (projected < minA): 
                    minA = projected

                if (maxA is None) or (projected > maxA):
                    maxA = projected

            # for each vertex in the second shape, project it onto the line perpendicular to the edge
            # and keep track of the min and max of these values
            minB, maxB = None, None
            for j in range(len(b)): 
                projected = normal['x'] * b[j][0] + normal['y'] * b[j][1]
                if (minB is None) or (projected < minB):
                    minB = projected

                if (maxB is None) or (projected > maxB):
                    maxB = projected

            # if there is no overlap between the projects, the edge we are looking at separates the two
            # polygons, and we know there is no overlap
            if (maxA < minB) or (maxB < minA):
                print("polygons don't intersect!")
                return False;

    return True 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-08-12T10:12:27.677

也许它会帮助某人。PHP中的相同算法：

```
function isPolygonsIntersecting($a, $b) {
    $polygons = array($a, $b);

    for ($i = 0; $i < count($polygons); $i++) {
        $polygon = $polygons[$i];

        for ($i1 = 0; $i1 < count($polygon); $i1++) {
            $i2 = ($i1 + 1) % count($polygon);
            $p1 = $polygon[$i1];
            $p2 = $polygon[$i2];

            $normal = array(
                "x" => $p2["y"] - $p1["y"], 
                "y" => $p1["x"] - $p2["x"]
            );

            $minA = NULL; $maxA = NULL;
            for ($j = 0; $j < count($a); $j++) {
                $projected = $normal["x"] * $a[$j]["x"] + $normal["y"] * $a[$j]["y"];
                if (!isset($minA) || $projected < $minA) {
                    $minA = $projected;
                }
                if (!isset($maxA) || $projected > $maxA) {
                    $maxA = $projected;
                }
            }

            $minB = NULL; $maxB = NULL;
            for ($j = 0; $j < count($b); $j++) {
                $projected = $normal["x"] * $b[$j]["x"] + $normal["y"] * $b[$j]["y"];
                if (!isset($minB) || $projected < $minB) {
                    $minB = $projected;
                }
                if (!isset($maxB) || $projected > $maxB) {
                    $maxB = $projected;
                }
            }

            if ($maxA < $minB || $maxB < $minA) {
                return false;
            }
        }
    }

    return true;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-02-18T12:15:29.477

您也可以使用[Rect.IntersectsWith()](http://msdn.microsoft.com/query/dev12.query?appId=Dev12IDEF1&l=EN-US&k=k%28System.Windows.Rect.IntersectsWith%29;k%28TargetFrameworkMoniker-.NETFramework,Version=v4.5%29;k%28DevLang-csharp%29&rd=true)。

例如，在 WPF 中，如果您有两个 UIElement，使用 RenderTransform 并放置在 Canvas 上，并且您想知道它们是否相交，您可以使用类似的东西：

```
bool IsIntersecting(UIElement element1, UIElement element2)
{
    Rect area1 = new Rect(
        (double)element1.GetValue(Canvas.TopProperty),
        (double)element1.GetValue(Canvas.LeftProperty),
        (double)element1.GetValue(Canvas.WidthProperty),
        (double)element1.GetValue(Canvas.HeightProperty));

    Rect area2 = new Rect(
        (double)element2.GetValue(Canvas.TopProperty),
        (double)element2.GetValue(Canvas.LeftProperty),
        (double)element2.GetValue(Canvas.WidthProperty),
        (double)element2.GetValue(Canvas.HeightProperty));

    Transform transform1 = element1.RenderTransform as Transform;
    Transform transform2 = element2.RenderTransform as Transform;

    if (transform1 != null)
    {
        area1.Transform(transform1.Value);
    }

    if (transform2 != null)
    {
        area2.Transform(transform2.Value);
    }

    return area1.IntersectsWith(area2);
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-05-18T11:13:48.117

带有切换到（例如）包括“触摸”情况的 Type(Java)Script 实现：

```
class Position {
    private _x: number;
    private _y: number;

    public constructor(x: number = null, y: number = null) {
        this._x = x;
        this._y = y;
    }

    public get x() { return this._x; }
    public set x(value: number) { this._x = value; }

    public get y() { return this._y; }
    public set y(value: number) { this._y = value; }
}

class Polygon {
    private _positions: Array<Position>;

    public constructor(positions: Array<Position> = null) {
        this._positions = positions;
    }

    public addPosition(position: Position) {
        if (!position) {
            return;
        }

        if (!this._positions) {
            this._positions = new Array<Position>();
        }

        this._positions.push(position);
    }

    public get positions(): ReadonlyArray<Position> { return this._positions; }

/**
 * https://stackoverflow.com/a/12414951/468910
 * 
 * Helper function to determine whether there is an intersection between the two polygons described
 * by the lists of vertices. Uses the Separating Axis Theorem
 *
 * @param polygonToCompare a polygon to compare with
 * @param allowTouch consider it an intersection when polygons only "touch"
 * @return true if there is any intersection between the 2 polygons, false otherwise
 */
  public isIntersecting(polygonToCompare: Polygon, allowTouch: boolean = true): boolean {
    const polygons: Array<ReadonlyArray<Position>> = [this.positions, polygonToCompare.positions]

    const firstPolygonPositions: ReadonlyArray<Position> = polygons[0];
    const secondPolygonPositions: ReadonlyArray<Position> = polygons[1];

    let minA, maxA, projected, i, i1, j, minB, maxB;

    for (i = 0; i < polygons.length; i++) {

        // for each polygon, look at each edge of the polygon, and determine if it separates
        // the two shapes
        const polygon = polygons[i];
        for (i1 = 0; i1 < polygon.length; i1++) {

            // grab 2 vertices to create an edge
            const i2 = (i1 + 1) % polygon.length;
            const p1 = polygon[i1];
            const p2 = polygon[i2];

            // find the line perpendicular to this edge
            const normal = {
                x: p2.y - p1.y,
                y: p1.x - p2.x
            };

            minA = maxA = undefined;
            // for each vertex in the first shape, project it onto the line perpendicular to the edge
            // and keep track of the min and max of these values
            for (j = 0; j < firstPolygonPositions.length; j++) {
                projected = normal.x * firstPolygonPositions[j].x + normal.y * firstPolygonPositions[j].y;

                if (!minA || projected < minA || (!allowTouch && projected === minA)) {
                    minA = projected;
                }

                if (!maxA || projected > maxA || (!allowTouch && projected === maxA)) {
                    maxA = projected;
                }
            }

            // for each vertex in the second shape, project it onto the line perpendicular to the edge
            // and keep track of the min and max of these values
            minB = maxB = undefined;
            for (j = 0; j < secondPolygonPositions.length; j++) {
                projected = normal.x * secondPolygonPositions[j].x + normal.y * secondPolygonPositions[j].y;

                if (!minB || projected < minB || (!allowTouch && projected === minB)) {
                    minB = projected;
                }

                if (!maxB || projected > maxB || (!allowTouch && projected === maxB)) {
                    maxB = projected;
                }
            }

            // if there is no overlap between the projects, the edge we are looking at separates the two
            // polygons, and we know there is no overlap
            if (maxA < minB || (!allowTouch && maxA === minB) || maxB < minA || (!allowTouch && maxB === minA)) {
                return false;
            }
        }
    }

    return true;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-04-21T08:15:37.563

Lua 实现内置在 love2d 框架中。碰撞检测功能无论如何都在纯lua中工作

```
math.inf = 1e309
function love.load()
    pol = {{0, 0}, {30, 2}, {8, 30}}
    pol2 = {{60, 60}, {90, 61}, {98, 100}, {80, 100}}
end
function love.draw()
    for k,v in ipairs(pol) do
        love.graphics.line(pol[k][1], pol[k][2], pol[k % #pol + 1][1], pol[k % #pol + 1][2])
    end
    for k,v in ipairs(pol2) do
        love.graphics.line(pol2[k][1], pol2[k][2], pol2[k % #pol2 + 1][1], pol2[k % #pol2 + 1][2])
    end
end

function love.update(dt)
    pol[1][1] = love.mouse.getX()
    pol[1][2] = love.mouse.getY()
    pol[2][1] = pol[1][1] + 30
    pol[2][2] = pol[1][2] + 2
    pol[3][1] = pol[1][1] + 8
    pol[3][2] = pol[1][2] + 30

    --lazy way to see that's function works
    print(doPolygonsIntersect(pol, pol2))
end
-------------------------------------------------------------------------
function doPolygonsIntersect(a,b)
polygons = {a,b}
for i=1, #polygons do
    polygon = polygons[i]
    for i1=1, #polygon do
        i2 = i1 % #polygon + 1
        p1 = polygon[i1]
        p2 = polygon[i2]

        nx,ny = p2[2] - p1[2], p1[1] - p2[1]

        minA = math.inf
        maxA = -math.inf
        for j=1, #a do
            projected = nx * a[j][1] + ny * a[j][2]
            if projected < minA then minA = projected end
            if projected > maxA then maxA = projected end
        end

        minB = math.inf
        maxB = -math.inf
        for j=1, #b do
            projected = nx * b[j][1] + ny * b[j][2]
            if projected < minB then minB = projected end
            if projected > maxB then maxB = projected end
        end

        if maxA < minB or maxB < minA then return false end
    end
end
return true
end 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-12-14T14:07:23.387

采用 Sri 的 JavaScript 并使其与 Phaser 3 Polygons 一起使用。

```
 /// Checks if the two Phaser 3 polygons are intersecting.
    gameScene.doPolygonsIntersect=function(a, b) {
        // https://stackoverflow.com/questions/10962379/how-to-check-intersection-between-2-rotated-rectangles#10965077
        /**
         * Helper function to determine whether there is an intersection between the two polygons described
         * by the lists of vertices. Uses the Separating Axis Theorem
         *
         * @param a an array of connected points [{x:, y:}, {x:, y:},...] that form a closed polygon
         * @param b an array of connected points [{x:, y:}, {x:, y:},...] that form a closed polygon
         * @return true if there is any intersection between the 2 polygons, false otherwise
         */

        var polygons = [a, b];
        var minA, maxA, projected, i, i1, j, minB, maxB;

        for (i = 0; i < polygons.length; i++) {

            // for each polygon, look at each edge of the polygon, and determine if it separates
            // the two shapes
            var polygon = polygons[i];
            for (i1 = 0; i1 < polygon.points.length; i1++) {

                // grab 2 vertices to create an edge
                var i2 = (i1 + 1) % polygon.points.length;
                var p1 = polygon.points[i1];
                var p2 = polygon.points[i2];

                // find the line perpendicular to this edge
                var normal = { x: p2.y - p1.y, y: p1.x - p2.x };

                minA = maxA = undefined;
                // for each vertex in the first shape, project it onto the line perpendicular to the edge
                // and keep track of the min and max of these values
                for (j = 0; j < a.points.length; j++) {
                    projected = normal.x * a.points[j].x + normal.y * a.points[j].y;
                    if (!isDef(minA) || projected < minA) {
                        minA = projected;
                    }
                    if (!isDef(maxA) || projected > maxA) {
                        maxA = projected;
                    }
                }

                // for each vertex in the second shape, project it onto the line perpendicular to the edge
                // and keep track of the min and max of these values
                minB = maxB = undefined;
                for (j = 0; j < b.points.length; j++) {
                    projected = normal.x * b.points[j].x + normal.y * b.points[j].y;
                    if (!isDef(minB) || projected < minB) {
                        minB = projected;
                    }
                    if (!isDef(maxB) || projected > maxB) {
                        maxB = projected;
                    }
                }

                // if there is no overlap between the projects, the edge we are looking at separates the two
                // polygons, and we know there is no overlap
                if (maxA < minB || maxB < minA) {
                    console.log("polygons don't intersect!");
                    return false;
                }
            }
        }
        return true;
    }; 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-02-21T19:37:47.183

它在 LUA 中，希望它能在需要时帮助某人：

```
function doPolygonsIntersect(a, b)
    local polygons = { a, b };
    local minA, maxA, projected, i, i1, j, minB, maxB;

    for i = 1, #polygons do
        --// for each polygon, look at each edge of the polygon, and determine if it separates
        --// the two shapes
        local polygon = polygons[i];
        for i1 = 0, (#polygon-1) do
            --// grab 2 vertices to create an edge
            local i2 = (i1 + 1) % (#polygon);
            local p1 = polygon[i1+1];
            local p2 = polygon[i2+1];

            --// find the line perpendicular to this edge
            local normal = { x = p2.y - p1.y, y = p1.x - p2.x };
            minA = nil;
            maxA = nil;

            --// for each vertex in the first shape, project it onto the line perpendicular to the edge
            --// and keep track of the min and max of these values
            for j = 1, #a do
                projected = normal.x * a[j].x + normal.y * a[j].y;
                if (minA == nil or projected < minA) then
                    minA = projected;
                end
                if (maxA == nil or projected > maxA) then
                    maxA = projected;
                end
            end

            --// for each vertex in the second shape, project it onto the line perpendicular to the edge
            --// and keep track of the min and max of these values
            minB = nil;
            maxB = nil;
            for j = 1, #b do
                projected = normal.x * b[j].x + normal.y * b[j].y;
                if (minB == nil or projected < minB) then
                    minB = projected;
                end
                if (maxB == nil or projected > maxB) then
                    maxB = projected;
                end
            end

            if (maxA < minB or maxB < minA) then
                return false;
            end
        end
    end

    return true;
end 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-01-31T04:10:18.830

Go 中公认的算法。

```
func isPolygonIntersecting(a *Polygon, b *Polygon) bool {
    for _, polygon := range []*Polygon{a, b} {
        for i1 := 0; i1 < len(*polygon); i1++ {
            i2 := (i1 + 1) % len(*polygon)
            p1 := (*polygon)[i1]
            p2 := (*polygon)[i2]

            normal := pixel.V(p2.Y-p1.Y, p1.X-p2.X)

            minA := math.MaxFloat64
            maxA := math.MaxFloat64
            for _, p := range *a {
                projected := normal.X*p.X + normal.Y*p.Y
                if minA == math.MaxFloat64 || projected < minA {
                    minA = projected
                }
                if maxA == math.MaxFloat64 || projected > maxA {
                    maxA = projected
                }
            }

            minB := math.MaxFloat64
            maxB := math.MaxFloat64
            for _, p := range *b {
                projected := normal.X*p.X + normal.Y*p.Y
                if minB == math.MaxFloat64 || projected < minB {
                    minB = projected
                }
                if maxB == math.MaxFloat64 || projected > maxB {
                    maxB = projected
                }
            }

            if maxA < minB || maxB < minA {
                return false
            }
        }
    }
    return true
}

type Polygon []struct {
    X float64
    Y float64
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-10-09T11:31:21.077

@dabs 的答案[https://stackoverflow.com/a/56962827/11846040](https://stackoverflow.com/a/56962827/11846040)转换为 Dart：

```
// `CustomPoint` is just a class holding two x/y or y/x values

class Polygon {
  final CustomPoint<num> nw;
  final CustomPoint<num> ne;
  final CustomPoint<num> se;
  final CustomPoint<num> sw;

  Polygon(this.nw, this.ne, this.se, this.sw);

  List<CustomPoint<num>> get points => [nw, ne, se, sw];
}

bool overlap(Polygon a, Polygon b) {
    for (int x = 0; x < 2; x++) {
      final Polygon polygon = (x == 0) ? a : b;

      for (int i1 = 0; i1 < polygon.points.length; i1++) {
        final int i2 = (i1 + 1) % polygon.points.length;
        final CustomPoint<num> p1 = polygon.points[i1];
        final CustomPoint<num> p2 = polygon.points[i2];

        final CustomPoint<num> normal =
            CustomPoint<num>(p2.y - p1.y, p1.x - p2.x);

        double minA = double.infinity;
        double maxA = double.negativeInfinity;

        for (CustomPoint<num> p in a.points) {
          final num projected = normal.x * p.x + normal.y * p.y;

          if (projected < minA) minA = projected.toDouble();
          if (projected > maxA) maxA = projected.toDouble();
        }

        double minB = double.infinity;
        double maxB = double.negativeInfinity;

        for (CustomPoint<num> p in b.points) {
          final num projected = normal.x * p.x + normal.y * p.y;

          if (projected < minB) minB = projected.toDouble();
          if (projected > maxB) maxB = projected.toDouble();
        }

        if (maxA < minB || maxB < minA) return false;
      }
    }

    return true;
  } 
```

我搜索了几个月才能找到这个答案，但找不到。享受你现在的人 15 年！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-11-09T12:17:49.253

Matlab实现：

```
function isIntersecting = IsPolygonsIntersecting(polyVertices1, polyVertices2)
    isIntersecting = ...
        IsPolygon1Intersecting2( polyVertices1, polyVertices2 ) && ...
        IsPolygon1Intersecting2( polyVertices2, polyVertices1 );
end

function isIntersecting = IsPolygon1Intersecting2(polyVertices1,polyVertices2)
    nVertices = size(polyVertices1,1);
    isIntersecting = true;
    for i1 = 1:nVertices    
        % Current edge vertices:
        i2 = mod(i1, nVertices) + 1;
        p1 = polyVertices1(i1,:);
        p2 = polyVertices1(i2,:);

        % Project the polygon vertices on the edge normal and find the extreme values:
        normal = [p2(2) - p1(2); p1(1) - p2(1)];

        minA = min(polyVertices1 * normal);
        maxA = max(polyVertices1 * normal);
        minB = min(polyVertices2 * normal);
        maxB = max(polyVertices2 * normal);

        if (maxA < minB || maxB < minA)
            isIntersecting = false;
            return;
        end
    end
end 
```

# flash - 如何在Flash中分割用钢笔工具制作的形状

> ID：10962387
> 
> 赞同：-2
> 
> 时间：2012-06-09T15:51:25.457
> 
> 标签：flash, shape, pen

我在尝试仅拆分使用 Flash 中的钢笔工具制作的形状时遇到了麻烦：如果我只是擦除一点颜色，白点键保持原样，并且形状不会被拆分。我想将它分开，因为我想在形状的一部分和另一部分之间创建一个骨架。

任何的想法？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T19:15:15.217

您可能会描述几种不同的场景。

1) 你有一个形状，它的轮廓是用钢笔工具绘制的，然后创建了一个填充。要分离此形状的部分，您可以使用套索工具，然后使用箭头工具选择要表达的部分。但是，最初由钢笔工具制作的轮廓可能会引起一些挫败感。最简单的方法可能是简单地删除填充周围的线，或者像下一个场景一样使用线。

2）您正在使用的形状实际上是由钢笔工具创建的一条线。也就是说，没有填充。使用这些“形状”的方法是转换它们。该命令是将线转换为填充。完成后，您可以像第一个场景一样使用形状。

3) 您试图在钢笔工具模式下分割形状。这是错误的做法。

# xcode - 在 Instruments 中运行 SenTestingKit 单元测试

> ID：10962388
> 
> 赞同：10
> 
> 时间：2012-06-09T15:51:25.817
> 
> 标签：xcode, memory-leaks, instruments, sentestingkit

我正在开发一个数据库访问库，并且正在尝试使用已经编写的单元测试来检查内存泄漏。

这些是基于 SenTestingKit 的逻辑测试，在 Xcode 4.2 中设置正常方式。我可以使用 Cmd-U 很好地运行它们，但看不到从 Instruments 启动它们的方法，或者调用 Instruments 来检查它们。

我怎样才能使这项工作？我是否需要编写新案例并将其构建到应用程序中？

（[这个问题](https://stackoverflow.com/questions/6570384/xcode-memory-leaks-detection-in-unit-test)是关于泄漏检查单元测试，但我认为是 pre-SenTestingKit。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-05T15:20:10.973

这个答案从 SenTest for OS X 开始。如果您担心在仪器下使用 SenTest for iOS，请跳到下一节。

## 仪器中的 OS X 单元测试

我意识到这有点晚了，但是我今天需要在逻辑测试中运行仪器并让它适用于我的环境，所以这就是我所做的：

1.  在 Instruments 运行的情况下，创建一个新文档。
2.  从文档中的 Target 下拉菜单中选择 Target
3.  选中右下角的“Traverse Packages”选项，让您可以深入了解 Xcode 包的内部
4.  导航到 /Applications/Xcode 并在 /Applications/Xcode.app/Contents/Developer/Tools/ 中找到 otest 二进制文件并选择它
5.  添加`OBCJ_DISABLE_GC`值`YES`作为环境变量（如果您正在运行 GC，请不要这样做）
6.  添加`DYLD_FRAMEWORK_PATH`并指向包含 .octest 包的目录
7.  添加`DYLD_LIBRARY_PATH`与 DYLD_FRAMEWORK_PATH 相同的值
8.  将工作目录设置为 .xcodeproj 所在的目录
9.  对于参数，使用`-SenTest Self`.octest 包的完整路径

某些环境变量和您的工作目录可能不是必需的，具体取决于您是否需要加载其他框架以及您的代码目录中是否有需要阅读的测试文件。因此，如果这些步骤不适用于您，您可以省略这些步骤。

完成后，您将能够保存文档并使用它来运行测试。

## 仪器中的 iOS 单元测试

在 OP 明确要求后，我开始使用基于 iOS 模拟器的项目验证基本说明。

对于 iOS，您需要一些不同的配置，因为您正在调试不同的可执行文件，并且您将需要不同的库。因此，DYLD_FRAMEWORK_PATH 将包含 .octest 包目录的路径和模拟器框架的路径。后者将是这样的： `/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator6.0.sdk/Developer/Library/Frameworks` 取决于您使用的模拟器版本，我们将在下面将其称为 SDKPATH

1.  在 Instruments 运行的情况下，创建一个新文档。
2.  从文档中的 Target 下拉菜单中选择 Target
3.  选中右下角的“Traverse Packages”选项，让您可以深入了解 Xcode 包的内部
4.  导航`/Applications/Xcode`并找到其中的 otest 二进制文件`/Applications/Xcode/Developer/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator6.0.sdk/Developer/usr/bin/`并选择它
5.  添加`DYLD_LIBRARY_PATH`并指向包含 .octest 包的目录
6.  添加`DYLD_ROOT_PATH`指向 SDKPATH（上图）
7.  `IPHONE_SIMULATOR_ROOT`使用 SDKPATH添加（上）
8.  添加`DYLD_FRAMEWORK_PATH`并指向包含 .octest 包和 SDKPATH（上图）的目录，`:`在路径列表中用冒号 ( )分隔它们
9.  添加`CFFIXED_USER_HOME`您的 iPhone 模拟器主页（`~/Library/Application Support/iPhone Simulator`尽管我在将其放在这里之前已经对其进行了扩展，因为我不确定 ~ 是否被解释）
10.  将工作目录设置为 .xcodeproj 所在的目录
11.  对于参数，使用`-SenTest Self`.octest 包的完整路径

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-07-22T14:05:20.560

这是另一种更简单的方法，并且可以更好地控制您的配置文件：

在 setUp 的开头放置一个断点并运行您要运行的测试。当 Xcode 遇到断点时，打开 Instruments 并在目标下搜索 octest。然后，您可以简单地附加到该过程。切换到 Xcode 并在断点后继续运行，仪器应该分析您想要运行的所有测试。

希望这可以帮助。

# javascript - 阻止 Javascript 舍入大数字 ID

> ID：10962390
> 
> 赞同：5
> 
> 时间：2012-06-09T15:51:36.970
> 
> 标签：javascript

以下引发了一个警告框读数：`211466719468855300`。为什么会发生这种情况，即使我尝试将其转换为字符串？我怎样才能准确地阅读它？

**HTML：**

```
<a class="delete-link" data-id="211466719468855298">Delete</a>​ 
```

**JS：**

```
$('.delete-link').click(function(e) {
        var $item =$(this);
        var itemID = String($item.data('id'));
        alert(itemID);
}); 
```

**小提琴：http:** [//jsfiddle.net/zUbym/1/](http://jsfiddle.net/zUbym/1/)

​</p>

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-09T15:53:15.273

发生这种情况有两个原因：

1.  jQuery 是否愿意将您的“数据”属性值转换为“适当的”类型
2.  这么大的数字在 JavaScript 中无法准确表示，因为所有数字都是 64 位 IEEE 794 浮点值。

如果直接使用“.attr()”获取属性值，可以避免数字转换，但必须将其保留为字符串。或者，您可以在数据值前面加上一些非数字字符（“_”或其他字符），以防止 jQuery 试图帮您一个忙。

# python - Python 的垃圾收集器如何检测循环引用？

> ID：10962393
> 
> 赞同：40
> 
> 时间：2012-06-09T15:52:16.580
> 
> 标签：python, garbage-collection, cpython

我试图了解 Python 的垃圾收集器如何检测循环引用。当我查看文档时，我看到的只是一个声明，即检测到循环引用，除非涉及的对象有`__del__`方法。

如果发生这种情况，我的理解（可能是错误的）是 gc 模块通过（我假设）遍历所有分配的内存并释放任何无法访问的块来充当故障保护。

在使用 gc 模块之前，Python 如何检测和释放循环内存引用？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-06-09T16:05:59.650

> 在使用 gc 模块之前，Python 如何检测和释放循环内存引用？

它没有。gc 仅*用于*检测和释放循环引用。非循环引用通过引用计数处理。

现在，要*了解*gc 如何确定任何给定对象引用的对象集，请查看`gc_get_references`. `Modules/gcmodule.c`相关位是：

```
// Where `obj` is the object who's references we want to find
traverseproc traverse;
if (! PyObject_IS_GC(obj))
    continue;
traverse = Py_TYPE(obj)->tp_traverse;
if (! traverse)
    continue;
if (traverse(obj, (visitproc)referentsvisit, result)) {
    Py_DECREF(result);
    return NULL;
} 
```

这里的主要功能是`tp_traverse`。每个 C 级类型都定义了一个`tp_traverse`函数（或者对于不包含任何引用的对象，例如`str`，将其设置为`NULL`）。的一个例子`tp_traverse`是`list_traverse`的遍历函数`list`：

```
static int
list_traverse(PyListObject *o, visitproc visit, void *arg)
{
    Py_ssize_t i;

    for (i = Py_SIZE(o); --i >= 0; )
        Py_VISIT(o->ob_item[i]);
    return 0;
} 
```

> 我看到的是检测到循环引用的语句，除非涉及的对象有`__del__()`方法。

你是对的 - Python 的循环检测器可以检测和收集循环*，除非*它们包含带有`__del__`方法的对象，因为解释器无法安全地删除这些对象（要了解为什么会这样，假设你有两个对象使用`__del__`相互引用的方法。它们应该按什么顺序被释放？）。

当循环中涉及带有`__del__`方法的对象时，垃圾收集器会将它们粘贴在单独的列表中（可通过 访问[`gc.garbage`](http://docs.python.org/library/gc.html#gc.garbage)），以便程序员可以手动“处理”它们。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-09T16:06:32.320

> 在使用 gc 模块之前，Python 如何检测和释放循环内存引用？

Python 的垃圾收集器（实际上不是`gc`模块，它只是垃圾收集器的 Python 接口）执行此操作。因此，Python在使用垃圾收集器之前*不会检测和释放循环内存引用。*

Python 通常会在引用计数达到零时立即释放大多数对象。（我说“大多数”是因为它从不释放例如小整数或内部字符串。）在循环引用的情况下，这永远不会发生，因此垃圾收集器会定期遍历内存并释放循环引用的对象。

当然，这都是 CPython 特有的。其他 Python 实现有不同的内存管理（Jython = Java VM，IronPython = Microsoft .NET CLR）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-06-09T17:38:16.493

我想我在@SvenMarnich 在对原始问题的评论中提供的一些链接中找到了我正在寻找的答案：

容器对象是可以保存对其他 Python 对象的引用的 Python 对象。列表、类、元组等是容器对象；整数、字符串等不是。因此，只有容器对象存在循环引用的风险。

每个 Python 对象都有一个字段 - *gc_ref*，对于非容器对象，它（我相信）设置为 NULL。对于容器对象，它被设置为等于引用它的**非容器对象的数量**

任何 *gc_ref* 计数大于 1 的容器对象（？我原以为是 0，但现在还可以吗？）具有不是容器对象的引用。因此它们是可访问的，并且不考虑成为不可访问的内存岛。

任何可被已知可达的对象（即我们刚刚识别为 *gc_ref* 计数大于 1 的对象）可达的容器对象也不需要被释放。

剩余的容器对象是不可访问的（除了彼此），应该被释放。

[http://www.arctrix.com/nas/python/gc/](http://www.arctrix.com/nas/python/gc/)是提供更全面解释 的链接[http://hg.python.org/cpython/file/2059910e7d76/Modules/gcmodule.c](http://hg.python.org/cpython/file/2059910e7d76/Modules/gcmodule.c)是源链接代码，其中有注释进一步解释了循环引用检测背后的想法

# authentication - 无需密码的 api 用户身份验证（使用通过短信发送的代码）

> ID：10962399
> 
> 赞同：0
> 
> 时间：2012-06-09T15:52:32.980
> 
> 标签：authentication, ssl, hash

我有一个可以访问我的服务的移动应用程序。我不要求用户创建密码，而是向他发送一个 4 个字符的代码，他使用该代码对数据进行签名。对数据进行签名意味着对消息（sha258）应用哈希，使用代码作为 hashKey。当消息到达服务器时，我在消息上应用相同的哈希来查看用户是否是假装的。

如果我使用 SSL，我应该只发送带有消息的代码吗？或者这种做法可以吗？

# shell - 如何解析命令并为其着色？

> ID：10962400
> 
> 赞同：3
> 
> 时间：2012-06-09T15:52:42.680
> 
> 标签：shell, command, text-coloring

我喜欢命令提示符着色的想法，我想知道如何扩展它以在我输入命令时或通过制表符完成时让 shell 为命令着色。例如，当我完成输入“gcc”时，shell 应该识别出它是一个有效的命令并将其涂成绿色。如果该命令不是一个可识别的命令，那么它应该以红色和粗体显示。

此功能将极大地帮助键入正确的命令，特别是如果您有很长的命令行，其中包含意外包含拼写错误的流水线命令。所有命令拼写错误都将用红色和粗体显示，以便我可以轻松识别我输入错误的命令。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T13:44:45.757

我不确定您是否可以在`bash`. 但在其他 shell 中也是可能的，例如`zsh`（参见：[https](https://github.com/zsh-users/zsh-syntax-highlighting) ://github.com/zsh-users/zsh-syntax-highlighting ）或`fish`（参见： http: [//fishshell.com/](http://fishshell.com/)）。

# jquery - 检查ID是否存在，然后重命名

> ID：10962412
> 
> 赞同：2
> 
> 时间：2012-06-09T15:54:26.830
> 
> 标签：jquery, html, duplicates

我正在尝试检测重复的 ID，

[http://jsfiddle.net/HB7ev/10/](http://jsfiddle.net/HB7ev/10/)

如果我理解正确：

```
if (id in dupeUIDCheck) 
```

检查 的值`id`是否在数组中：`dupeUIDCheck`但是，似乎：

```
dupeUIDCheck[id] = true; 
```

最后设置的实际上使检查工作。

它并没有真正看内部：

```
dupeUIDCheck = $(document).find('DIV')
            .map(function(){ return this.id || undefined})
            .toArray(); 
```

对于价值观，我首先呼吁。

我怎样才能解决这个问题？出于某种原因，我确实让它在我自己网站的一部分中工作，所以它`makeIdUnique()`似乎像它应该的那样工作，但为什么在这个例子中没有呢？（也许是格式错误的数组？）

原始函数是从之前的问题中派生出来的：[Renaming duplicates in Javascript Array](https://stackoverflow.com/questions/10643933/renaming-duplicates-in-javascript-array)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T16:01:09.023

@TrySpace

据我了解，“dupeUIDCheck”是一个常规数组。如果这是真的，那么你需要使用 Array.prototype.indexOf 方法：

```
if (dupeUIDCheck.indexOf(id) != -1) {
 ...
} 
```

这段代码“dupeUIDCheck[id] = true;” 解决了这个问题，因为您在数组对象本身上定义属性，并且“in”运算符显然会确认存在这样的属性，但数组元素并非如此。“in”运算符不在数组元素内查找。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T15:58:18.500

您可以使用

```
$.inArray(id, dupeUIDCheck) 
```

或者

```
dupeUIDCheck.indexOf(id); 
```

### 笔记

与`dupeUIDCheck`数组一样，要查找数组中的元素是否存在，您需要使用`indexOf()`. `.indexOf()`如果找到或未找到，则返回`index`该数组中的搜索元素`-1`。`$.inArray(value, array)`是 jQuery 方法，其工作与`.indexOf()`.

* * *

那是

```
function makeIdUnique(id) {

   if (dupeUIDCheck.indexOf(id) >= 0) {  // exists
     // your code
   } 

} 
```

或者

```
function makeIdUnique(id) {

   if ($.inArray(id, dupeUIDCheck) >= 0) {  // exists
     // your code
   } 

} 
```

`id in dupeUIDCheck`适用于**对象**

```
var obj = {a: 'abc', b: 'def'}; 
```

然后搜索对象的属性，您可以使用

```
if( 'a' in obj) {

} 
```

# android - 如何在不显示通知的情况下 startForeground()？

> ID：10962418
> 
> 赞同：105
> 
> 时间：2012-06-09T15:54:52.353
> 
> 标签：android, android-service, foreground

我想创建一个服务并让它在前台运行。

大多数示例代码都有通知。但我不想显示任何通知。那可能吗？

你能给我一些例子吗？有没有其他选择？

我的应用服务正在做媒体播放器。**如何使系统不杀死我的服务，除了应用程序自己杀死它**（比如通过按钮暂停或停止音乐）。

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2012-06-09T20:10:56.527

作为 Android 平台的一项安全功能，在*任何情况下，您**都不能*在没有通知的情况下拥有前台服务。这是因为与后台服务相比，前台服务消耗更多资源并且受到不同的调度约束（即它不会被杀死得那么快），并且用户需要知道什么可能在消耗他们的电池。所以，*不*要这样做。

 **但是，可能会有“假”通知，即您可以制作透明通知图标 (iirc) *。*这对你的用户来说是非常不诚实的，你没有理由这样做，除了杀死他们的电池并因此产生恶意软件。

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2013-08-16T20:19:59.173

**更新：**这在 Android 7.1 上已“修复”。 [https://code.google.com/p/android/issues/detail?id=213309](https://code.google.com/p/android/issues/detail?id=213309)

自 4.3 更新以来，基本上*不可能*`startForeground()`在不显示通知的情况下启动服务。

但是，您可以使用官方 API 隐藏图标...不需要透明图标：（`NotificationCompat`用于支持旧版本）

```
NotificationCompat.Builder builder = new NotificationCompat.Builder(context);
builder.setPriority(Notification.PRIORITY_MIN); 
```

我已经接受了通知本身仍然需要存在的事实，但是对于仍然想要隐藏它的人，我可能也找到了解决方法：

1.  `startForeground()`使用通知和所有内容启动虚假服务。
2.  启动您要运行的真实服务，也使用`startForeground()`（相同的通知 ID）
3.  停止第一个（假）服务（您可以调用`stopSelf()`并在 onDestroy 调用`stopForeground(true)`）。

瞧！根本没有通知，您的第二个服务继续运行。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2016-06-01T22:33:00.533

**这在 Android 7.1 中不再有效，并且可能违反[Google Play 的开发者政策](https://play.google.com/about/privacy-security/malicious-behavior/)。**

相反，[让用户阻止服务通知](https://stackoverflow.com/a/41177817/238753)。

* * *

这是我在[Lior Iluz](https://stackoverflow.com/users/444324/lior-iluz)[的回答](https://stackoverflow.com/a/18281520/238753)中实现的技术。

## 代码

### 前台服务.java

```
public class ForegroundService extends Service {

    static ForegroundService instance;

    @Override
    public void onCreate() {
        super.onCreate();

        instance = this;

        if (startService(new Intent(this, ForegroundEnablingService.class)) == null)
            throw new RuntimeException("Couldn't find " + ForegroundEnablingService.class.getSimpleName());
    }

    @Override
    public void onDestroy() {
        super.onDestroy();

        instance = null;
    }

    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }

} 
```

### ForegroundEnablingService.java

```
public class ForegroundEnablingService extends Service {

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        if (ForegroundService.instance == null)
            throw new RuntimeException(ForegroundService.class.getSimpleName() + " not running");

        //Set both services to foreground using the same notification id, resulting in just one notification
        startForeground(ForegroundService.instance);
        startForeground(this);

        //Cancel this service's notification, resulting in zero notifications
        stopForeground(true);

        //Stop this service so we don't waste RAM.
        //Must only be called *after* doing the work or the notification won't be hidden.
        stopSelf();

        return START_NOT_STICKY;
    }

    private static final int NOTIFICATION_ID = 10;

    private static void startForeground(Service service) {
        Notification notification = new Notification.Builder(service).getNotification();
        service.startForeground(NOTIFICATION_ID, notification);
    }

    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }

} 
```

### AndroidManifest.xml

```
<service android:name=".ForegroundEnablingService" />
<service android:name=".ForegroundService" /> 
```

## 兼容性

测试和工作：

*   官方模拟器
    *   4.0.2
    *   4.1.2
    *   4.2.2
    *   4.3.1
    *   4.4.2
    *   5.0.2
    *   5.1.1
    *   6.0
    *   7.0
*   索尼 Xperia M
    *   4.1.2
    *   4.3
*   三星Galaxy ？
    *   4.4.2
    *   5.X
*   Genymotion
    *   5.0
    *   6.0
*   CyanogenMod
    *   5.1.1

**自 Android 7.1 起不再工作。**

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2015-05-22T08:05:36.607

**警告**：虽然这个答案似乎有效，但实际上它默默地[阻止了您的服务成为前台服务](https://stackoverflow.com/questions/10962418/how-to-startforeground-without-showing-notification/41177817#comment68356058_30391451)。

原答案：

* * *

只需将通知的 ID 设置为零：

```
// field for notification ID
private static final int NOTIF_ID = 0;

    ...
    startForeground(NOTIF_ID, mBuilder.build());
    NotificationManager mNotificationManager = (NotificationManager) getSystemService(NOTIFICATION_SERVICE);
    mNotificationManager.cancel(NOTIF_ID);
    ... 
```

您可以获得的一个好处是，a`Service`将能够以高优先级运行而不会被 Android 系统破坏，除非内存压力很大。

要使其与 Pre-Honeycomb 和 Android 4.4 及更高版本一起使用，请确保使用`NotificationCompat.Builder`Support Library v7 提供的版本，而不是`Notification.Builder`.

**编辑**

由于较新的 api 级别的安全原因，此代码将不再工作

`NotificationId`不能设置为“0”（这会导致应用崩溃）

```
startForeground(1, notification) 
```

这是显示通知的完美方式（推荐方法）

但是，如果您需要它而不考虑推荐的方法，请尝试`"notificationManager.createNotificationChannel("channel_id")"`从您的代码中删除。

**或** 使用`notificationManager.removeNotificationChannel(channel)`

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2012-10-12T02:02:18.840

您可以使用它（如@Kristopher Micinski 建议的那样）：

```
Notification note = new Notification( 0, null, System.currentTimeMillis() );
note.flags |= Notification.FLAG_NO_CLEAR;
startForeground( 42, note ); 
```

**更新：**

请注意，Android KitKat+ 版本不再允许这样做。请记住，这或多或少违反了 Android 中的设计原则，即@Kristopher Micinski 提到的让用户可以看到后台操作的设计原则

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2019-01-03T07:57:30.793

您可以使用 layout_height = "0dp" 的自定义布局在**Android 9+**上隐藏通知

```
NotificationCompat.Builder builder = new NotificationCompat.Builder(context, NotificationUtils.CHANNEL_ID);
RemoteViews remoteViews = new RemoteViews(context.getPackageName(), R.layout.custom_notif);
builder.setContent(remoteViews);
builder.setPriority(NotificationCompat.PRIORITY_LOW);
builder.setVisibility(Notification.VISIBILITY_SECRET); 
```

custom_notif.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="0dp">
</LinearLayout> 
```

在 Pixel 1、android 9 上测试。此解决方案不适用于 Android 8 或更低版本

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2016-06-08T12:27:59.050

更新：这不再适用于 Android 4.3 及更高版本

* * *

有一种解决方法。尝试在不设置图标的情况下创建通知，并且通知不会显示。不知道它是如何工作的，但确实如此:)

```
 Notification notification = new NotificationCompat.Builder(this)
            .setContentTitle("Title")
            .setTicker("Title")
            .setContentText("App running")
            //.setSmallIcon(R.drawable.picture)
            .build();
    startForeground(101,  notification); 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2016-12-16T05:29:59.867

# 阻止前台服务通知

这里的大多数答案要么不起作用，要么[破坏前台服务](https://stackoverflow.com/a/30391451/238753)，要么违反[Google Play 政策](https://play.google.com/about/privacy-security/malicious-behavior/)。

可靠且安全地隐藏通知的唯一方法是让用户阻止它。

### 安卓 4.1 - 7.1

唯一的方法是阻止来自您的应用程序的**所有**通知：

1.  将用户发送到应用程序的详细信息屏幕：

    ```
    Uri uri = Uri.fromParts("package", getPackageName(), null);
    Intent intent = new Intent(Settings.ACTION_APPLICATION_DETAILS_SETTINGS).setData(uri);
    startActivity(intent); 
    ```

2.  让用户阻止应用程序的通知

*请注意，这也会阻止您的应用程序的 toast。*

### 安卓 8.0 - 8.1

在 Android O 上阻止通知是不值得的，因为操作系统只会将其替换为“*在后台运行*”或“*使用电池*”通知。

### 安卓 9+

使用[通知渠道](https://developer.android.com/guide/topics/ui/notifiers/notifications#ManageChannels)来阻止服务通知，而不影响您的其他通知。

1.  将服务通知分配给通知通道
2.  将用户发送到通知通道的设置

    ```
    Intent intent = new Intent(Settings.ACTION_CHANNEL_NOTIFICATION_SETTINGS)
        .putExtra(Settings.EXTRA_APP_PACKAGE, getPackageName())
        .putExtra(Settings.EXTRA_CHANNEL_ID, myNotificationChannel.getId());
    startActivity(intent); 
    ```

3.  让用户屏蔽频道的通知

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2012-06-18T01:08:25.700

更新：这不再适用于 Android 4.3 及更高版本

* * *

我将 Notification 的构造函数的图标参数设置为零，然后将生成的通知传递给 startForeground()。日志中没有错误，也没有显示通知。但是，我不知道该服务是否已成功前台 - 有什么方法可以检查吗？

编辑：用dumpsys检查，确实该服务在我的2.3系统上处于前台。尚未检查其他操作系统版本。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2015-03-09T17:58:29.537

4.3（18）及以上版本无法隐藏服务通知，但您可以禁用图标，4.3（18）及以下版本可以隐藏通知

```
Notification noti = new Notification();
if (Build.VERSION.SDK_INT > Build.VERSION_CODES.JELLY_BEAN) {
    noti.priority = Notification.PRIORITY_MIN;
}
startForeground(R.string.app_name, noti); 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2017-11-19T11:29:44.347

我发现在 Android 8.0 上仍然可以通过不使用通知通道来实现。

```
public class BootCompletedIntentReceiver extends BroadcastReceiver {
    @Override
    public void onReceive(Context context, Intent intent) {
        if ("android.intent.action.BOOT_COMPLETED".equals(intent.getAction())) {

            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {

                Intent notificationIntent = new Intent(context, BluetoothService.class);    
                context.startForegroundService(notificationIntent);

            } else {
                //...
            }

        }
    }
} 
```

在 BluetoothService.class 中：

```
 @Override
    public void onCreate(){    
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {

            Intent notificationIntent = new Intent(this, BluetoothService.class);

            PendingIntent pendingIntent = PendingIntent.getActivity(this, 0, notificationIntent, 0);

            Notification notification = new Notification.Builder(this)
                    .setContentTitle("Title")
                    .setContentText("App is running")
                    .setSmallIcon(R.drawable.notif)
                    .setContentIntent(pendingIntent)
                    .setTicker("Title")
                    .setPriority(Notification.PRIORITY_DEFAULT)
                    .build();

            startForeground(15, notification);

        }

    } 
```

不会显示持久通知，但是您会看到 Android 的“x 应用程序正在后台运行”通知。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2021-02-12T11:33:07.187

对于开发人员的有时客户不想要前台服务的永久通知来说，这是一个相当麻烦的事情。我创建了一个虚假通知来启动服务，之后我取消了它`notificationManager.cancel(1);`

```
 final String NOTIFICATION_CHANNEL_ID = "com.exmaple.project";
    final String channelName = "Notification";
   @RequiresApi(api = Build.VERSION_CODES.O)
@Override
public void onCreate() {
    super.onCreate();
    stopForeground(true);
    Intent stopSelf = new Intent(this, Notification_Service.class);
    stopSelf.setAction("ACTION_STOP_SERVICE");
    PendingIntent pStopSelf = PendingIntent
            .getService(this, 0, stopSelf
                    , PendingIntent.FLAG_CANCEL_CURRENT);
    Notification notification;
    NotificationCompat.Action action =
            new NotificationCompat.Action.Builder(
                    0, "Close", pStopSelf
            ).build();
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {
        NotificationChannel serviceChannel = new NotificationChannel(NOTIFICATION_CHANNEL_ID, "Notification One", NotificationManager.IMPORTANCE_DEFAULT);
        NotificationManager notificationManager = getSystemService(NotificationManager.class);
        notificationManager.createNotificationChannel(serviceChannel);
        notification = new NotificationCompat.Builder(this, NOTIFICATION_CHANNEL_ID)
                .setSmallIcon(R.drawable.ic_launcher_background)
                .setContentText("Welcome to App.")
                .setPriority(Notification.PRIORITY_MIN)
                .addAction(action)
                .build();
    } else {
        notification = new NotificationCompat.Builder(this, NOTIFICATION_CHANNEL_ID)
                .setSmallIcon(R.drawable.ic_launcher_background)
                .setContentTitle("App")
                .setContentText("Welcome to App.")
                .setPriority(Notification.PRIORITY_MIN)
                .addAction(action)
                .build();
    }
    NotificationManager notificationManager =
            (NotificationManager) getSystemService(Service.NOTIFICATION_SERVICE);
    notificationManager.notify(1, notification);
    startForeground(1, notification);
    notificationManager.cancel(1);
} 
```

有时永久通知不会被删除，`notificationManager.cancel(1);`因为我添加了假的关闭操作按钮。

**操作按钮结果：**

```
 @Override
        public int onStartCommand(Intent intent, int flags, int startId) {
            super.onStartCommand(intent, flags, startId);
            if ("ACTION_STOP_SERVICE".equals(intent.getAction())) {
                stopSelf();
            }

            return START_STICKY;
        } 
```

**启动服务：**

```
 if (!isMyServiceRunning()) {
       Intent serviceIntent = new Intent(this, Notification_Service.class);
                ContextCompat.startForegroundService(this, serviceIntent);
            } 
```

检查服务是否已经在运行。

```
private boolean isMyServiceRunning() {
        ActivityManager manager = (ActivityManager) getSystemService(Context.ACTIVITY_SERVICE);
        for (ActivityManager.RunningServiceInfo service : manager.getRunningServices(Integer.MAX_VALUE)) {
            if (Notification_Service.class.getName().equals(service.service.getClassName())) {
                return true;
            }
        }
        return false;
    } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-04-06T14:44:31.933

更新：这[不再适用](https://stackoverflow.com/a/18281520/238753)于 Android 7.1 及更高版本

* * *

这是使您的应用程序的 oom_adj 为 1 的方法（在 ANDROID 6.0 SDK 模拟器中测试）。添加临时服务，在您的主要服务调用`startForgroundService(NOTIFICATION_ID, notificion)`中。然后再次启动`startForgroundService(NOTIFICATION_ID, notificion)`具有相同通知 id 的临时服务调用，一段时间后在临时服务调用 stopForgroundService(true) 以关闭正在运行的通知。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-05-27T12:38:45.177

最合适的解决方案是使用 Notification Channel。

你需要做的就是 `notificationManager.createNotificationChannel(channel)`从你的班级中删除。

```
val notificationManager =
            getSystemService(Context.NOTIFICATION_SERVICE) as NotificationManager
        val channel = NotificationChannel(
            notificationChannelId,
            "Endless Service notifications channel",
            NotificationManager.IMPORTANCE_HIGH
        ).let {
            it.description = "Endless Service channel"
            it.enableLights(true)
            it.lightColor = Color.RED
            it.enableVibration(true)
            it.vibrationPattern = longArrayOf(100, 200, 300, 400, 500, 400, 300, 200, 400)
            it
        }
        notificationManager.createNotificationChannel(channel) 
```

**或者**

通过简单地使用`notificationManager.deleteNotificationChannel("channel_id")`

虽然，不建议删除*前台服务*使用的通知。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2022-01-14T21:26:32.653

尽管这不是直接的问题，但许多搜索此问题的人可以通过使用[WorkManager轻松解决创建持久、长时间运行的任务的挑战](https://developer.android.com/topic/libraries/architecture/workmanager)

截至 2022 年，它是 Google 推荐的用于运行所有类型的后台任务（一次性、定期、加速、前台等）的 API。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2012-08-15T00:43:44.760

您还可以将您的应用程序声明为持久的。

```
<application
    android:icon="@drawable/icon"
    android:label="@string/app_name"
    android:theme="@style/Theme"
    *android:persistent="true"* >
</application> 
```

这实质上将您的应用程序设置为更高的内存优先级，从而降低了它被杀死的可能性。**

# xcode - 当在表中选择项目时，通过加载在 plist 中命名的 .xib

> ID：10962426
> 
> 赞同：0
> 
> 时间：2012-06-09T15:56:17.283
> 
> 标签：xcode, ios4, plist

嗨，我正在尝试更新我正在开发的应用程序。该应用程序最初是一个五视图选项卡视图应用程序。我已经决定要修改应用程序，使其具有更少的选项卡，因此我想将三个选项卡移动到一个表格列表中并从那里加载它们，从而腾出一些选项卡栏空间用于我的其他一些事情想努力实施。

为了实现这一点，我想我会设置一个表格视图并将详细信息从 .plist 加载到 tableView 中。我想我可以在 .plist 中命名 .xib 文件，然后获取这些名称并使用它们将适当的 .xib 文件推送到视图中。从理论上讲，这一切听起来都不错（至少在我的脑海中），但我在这样做时遇到了一些问题。在创建表格视图方面，我可以使 .plist 正常工作，但我会陷入困境，因为我不知道如何传递笔尖的名称并使用它来推送正确的视图。谁能给我解释一下。我的 plist 如下所示：

```
<array>
<dict>
    <key>rowData</key>
    <array>
        <dict>
            <key>calcType</key>
            <string>Item 1</string>
            <key>subdetails</key>
            <string>some stuff about item 1</string>
            <key>nibName</key>
            <string>nibOne.xib</string>
        </dict>
        <dict>
            <key>calcType</key>
            <string>Item 2</string>
            <key>subdetails</key>
            <string>some stuff about item 2</string>
            <key>nibName</key>
            <string>nibTwo.xib</string>
        </dict>
        <dict>
            <key>calcType</key>
            <string>Item 3</string>
            <key>subdetails</key>
            <string>some stuff about item 3</string>
            <key>nibName</key>
            <string>nibThree.xib</string>
        </dict>
    </array>
</dict> 
```

我的 didSelectRowAtIndex 方法目前看起来像这样：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

     //Get the dictionary of the selected data source.
NSDictionary *dictionary = [[[self.artCalculators     objectAtIndex:indexPath.section]objectForKey:@"rowData"] objectAtIndex:indexPath.row];

CalcDetailViewController *controller = [[CalcDetailViewController alloc] initWithNibName:@"CalcDetailViewController" bundle:[NSBundle mainBundle]]; 

 controller.title = [dictionary objectForKey:@"calcType"];

 [self.navigationController pushViewController:controller animated:YES]; 
```

我知道需要改变的行是：

```
CalcDetailViewController *controller = [[CalcDetailViewController alloc] initWithNibName:@"CalcDetailViewController" bundle:[NSBundle mainBundle]]; 
```

但我不确定它需要是什么。谁能告诉我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T17:10:07.000

您从字典中获取 nib 名称的方式与从字典中获取任何其他对象的方式相同：

```
NSString *nibName = [dictionary objectForKey:@"nibName"];
CalcDetailViewController *controller = [[CalcDetailViewController alloc] initWithNibName:nibName bundle:nil]; 
```

您不需要显式传入主包，如果传入`nil`.

# ruby - 哈希值数组

> ID：10962430
> 
> 赞同：1
> 
> 时间：2012-06-09T15:57:01.573
> 
> 标签：ruby, arrays, hash

如何将输入推入哈希值？我的问题是我有多个键，它们都引用数组。

```
{"A"=>["C"], "B"=>["E"], "C"=>["D"], "D"=>["B"]} 
```

我怎样才能将另一个字符串推到其中一个上？例如，我想将 a 添加`"Z"`到 key 的数组中`"A"`？

目前我要么覆盖以前的数组，要么所有数据都在一个中。

它关于将 Array`["AB3", "DC2", "FG4", "AC1", "AF4"]`转换为带有`{"A"=>["B", "C", "F"]}`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T16:00:30.637

任何命令`<<, push, unshift`都会起作用

```
if h["A"] 
  h["A"] << "Z"
else
  h["A"] = ["Z"]
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T16:27:11.870

您说您最初的问题是将数组`["AB3", "DC2", "FG4", "AC1", "AF4"]`转换为 hash `{"A"=>["B", "C", "F"]}`，可以这样完成：

```
Hash[a.group_by { |s| s[0] }.map { |k, v| [k, v.map { |s| s[1] }] }] 
```

或者像这样：

```
a.inject(Hash.new{|h, k| h[k]=[]}) { |h, s| h[s[0]] << s[1] ; h } 
```

请注意，这`Hash.new{|h, k| h[k]=[]}`会创建一个默认值为`[]`（一个空数组）的数组，因此您始终可以使用`<<`它向其中添加元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T17:54:19.743

更好的方法：

在 Hash 中添加一个新的类方法，如下所示：

```
class Hash
  def add (k,v)
    unless self.key?k
      self[k] = [v] 
    else
      self[k] = self[k] << v
    end 
    self
  end 
end

h={}
h.add('A','B') #=> {"A"=>["B"]}
h.add('A','C') #=> {"A"=>["B", "C"]}
h.add('B','X') #=> {"A"=>["B", "C"], "B"=>["X"]} 
```

完毕。

根据您的确切问题，这可能更加惯用；比如说，您想一次发送多个值，然后可以对代码进行 DRY 处理以处理多个参数。

希望这可以帮助。

一切顺利。

# google-product-search - 谷歌商务搜索一个独立的应用程序？

> ID：10962434
> 
> 赞同：2
> 
> 时间：2012-06-09T15:58:21.487
> 
> 标签：google-product-search

我正在构建一个移动应用程序。我不是商人，我只是一个应用程序开发人员。我想整合一些谷歌的搜索能力，所以我偶然发现了谷歌商务搜索。它的功能似乎涵盖了我正在寻找的确切功能。然而，它似乎只适用于零售商，因此定价也是如此。

所以我的问题是：

*   有没有办法通过公开开放的api集成谷​​歌的产品或商业搜索？
*   有没有办法整合一些图像搜索（查找相似图像）？

谢谢你。

# groovy - 如何使用 Groovy Postbuild Plugin 在项目/作业主页上书写？

> ID：10962435
> 
> 赞同：1
> 
> 时间：2012-06-09T15:58:24.943
> 
> 标签：groovy, hudson, jenkins, hudson-plugins, jenkins-plugins

我正在使用 Groovy Postbuild Plugin，并使用它来显示来自构建日志的不同信息。但是有没有办法在项目页面上写相同的信息，而不是构建页面？我是说，

```
BUILD PAGE: http://localhost:8080/job/A_JOB/121/ 
PROJECT PAGE: http://localhost:8080/job/A_JOB/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T08:11:51.087

我认为您正在寻找设置 Job description HTML 的[Job::setDescription](http://javadoc.jenkins-ci.org/hudson/model/AbstractItem.html#setDescription%28java.lang.String%29)（您通过`add description`在工作页面上手动完成）。

# mysql - 如何使用sql获得最大重复计数

> ID：10962438
> 
> 赞同：5
> 
> 时间：2012-06-09T15:58:31.860
> 
> 标签：mysql, count

嗨有一个表名是cou

```
name      type

kasu      1
kasu      4
kasu      3
nimal     1
nimal     2 
```

我需要这个答案

```
name  cnt

kasu  3 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T16:10:23.797

```
SELECT name, COUNT(name) AS `cnt`
FROM cou 
GROUP BY name
ORDER BY `cnt` DESC
LIMIT 1 
```

好的，抱歉，我没有找到更优雅的东西，所以我以愚蠢的方式做到了。肯定有另一种方法可以做到这一点......

## [用你的例子演示](http://sqlfiddle.com/#!2/e906b/20)

## [添加输入后的另一个示例](http://sqlfiddle.com/#!2/ea5bb/1)

# matlab - 3D 矩阵上的 FFT 和 IFFT

> ID：10962440
> 
> 赞同：2
> 
> 时间：2012-06-09T15:58:34.720
> 
> 标签：matlab, fft

我在 MATLAB 中有一部包含 70 个灰度帧的电影。我把它们放在一个 3-D 矩阵中，所以维度是 X、Y 和时间。
我想确定时间维度中的频率，所以我必须计算^(第三)维度中每个点的 FFT。这不是问题，但我必须使用`ifft`.
在正常情况下，这将是正确的：`X = ifft(fft(X))`，但当您处理多维数据时，在 MATLAB 中似乎并非如此。

这是我使用的代码：

```
for i = 1:length              
    y(:, :, i) = [img1{i, level}];  %# take each picture from an cell array and put it
end                                 %# and put it in 3D array
y2 = ifft(fft(y, NFFT,3), NFFT, 3); %# NFFT = 128, the 3 is the dimension in which i want
                                    %# to calculate the FFT and IFFT 
```

`y`是 480x640x70，所以有 70 张 640x480 像素的图像。

如果我只使用`fft`,`y2`是 480x640x128 （这是正常的，因为我们想要 128 个点`NFFT`）。
如果我使用`fft`and `ifft`，`y2`则为 480x640x128 像素。这不正常，128应该又是70了。
我试图通过使用 2 个`for`循环在一个维度上做到这一点，这很好。不过，for 循环需要很多时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T16:36:37.523

您需要致电：

```
 y2 = ifft(fft(y, 128,3), 70, 3); 
```

或更一般地说

```
 y2 = ifft(fft(y, NFFT, 3), size(y,3), 3); 
```

你这样做的方式是，你要求的输出`ifft`也有第三维等于`NFFT`你的 128。

# c++ - 在 gui 应用程序中打开控制台

> ID：10962441
> 
> 赞同：0
> 
> 时间：2012-06-09T15:59:00.307
> 
> 标签：c++, winapi, dll

我正在尝试用 C++ 创建一个程序，该程序在 CMD 表单中与他一起打开，以便我可以在程序内部的 CMD 中运行程序。例如，在这张照片中：

![在此处输入图像描述](../Images/a0234acaf2144ada7fa3e47e8ab88534.png)

我找到了一些例子，但无法在代码中实现它们，所以，我请求你的帮助......更准确地说，我想在 dll 中创建一个函数，所以我可以调用这个 CMD，从任何语言开始

> * * *
> 
> 基本上是一个嵌入控制台

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T18:35:01.847

我看到两种方法：

*   编写您自己的控制台小部件并将所有输入的命令传递给 std::system 命令
*   执行[如何在 Win32 应用程序中打开控制台窗口中所述的操作](http://justcheckingonall.wordpress.com/2008/08/29/console-window-win32-app/)

# javascript - Rails 3.2 在开发模式下的请求处理顺序

> ID：10962445
> 
> 赞同：0
> 
> 时间：2012-06-09T15:59:19.443
> 
> 标签：javascript, ruby-on-rails, ajax

我有一个页面在异步加载动态内容时显示微调器动画（此处为 HAML）：

```
#loading_spinner

#async_vote

:javascript    
  $(document).ready(function() {
    $.ajax({
      url: "/votes/voteables",
      cache: false,
      beforeSend: function(xhr){
        $("#loading_spinner").show();
      },
      success: function(html){
        $("#loading_spinner").hide();
        $("#async_vote").html(html);
      }
    });
  }); 
```

为了模拟一个缓慢的请求，我在 - 方法中设置了几秒钟的睡眠时间`:voteables`。

现在，问题是浏览器没有显示-element`background-image`的。`#loading_spinner`

发生的情况是，虽然 JavaScript 代码应该在页面加载时执行，但它实际上是在获取微调器的背景图像之前执行 AJAX 调用。因此当控制器中的延迟为 3 秒时，图像会立即加载（因为请求不是并行服务的），`success`执行 -callback 并立即隐藏图像。

我正在使用 Rails 3.2 并使用`rails server`.

任何建议如何在开发中解决此问题？这会成为生产中的问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T16:22:58.077

我认为，如果您将 ajax 请求包装在加载中，而不是准备就绪，它将在图像下载之前不会执行，如下所示：

```
$(window).load(function(){
  // ajax functionality goes here
}); 
```

# cordova - PhoneGap 中的 OAuth

> ID：10962446
> 
> 赞同：1
> 
> 时间：2012-06-09T16:00:11.073
> 
> 标签：cordova, foursquare

我正在尝试学习 Phonegap 并使用它为 Andorid 制作一个小型应用程序。我的应用程序需要从 FourSquare API 中提取附近的餐馆。

我可以通过哪些方式做到这一点？

我无法理解 FourSqaure 的文档。它需要OAuth机制来完成。如何在 PhoneGap 应用程序中执行此操作 - 缺少重定向 URI。

如果有人能告诉我要走哪条路以及如何实现这一目标，那将非常有帮助？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T19:42:00.467

您是否尝试过使用 ChildBrowser 插件？（https://github.com/phonegap/phonegap-plugins/tree/master/Android/ChildBrowser）我将它用于 Twitter，它似乎适用于身份验证。但是您确实存在必须以易于访问的格式存储秘密 OAuth 密钥的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T16:15:33.823

本月早些时候，我只是在为同样的问题而苦苦挣扎。我正在寻找一种在 Android 上实现自定义 RESTful 服务的好方法。我遇到了这个名为 Scribe 的库（[https://github.com/fernandezpablo85/scribe-java](https://github.com/fernandezpablo85/scribe-java)）。它在 Android 上运行得非常好。更好的是，它已经内置了对 Foursquare OAuth 的支持！这是他们展示的使用 Scribe+Android+Foursquare 的示例文件：

```
package org.scribe.examples;

import java.util.Scanner;

import org.scribe.builder.*;
import org.scribe.builder.api.*;
import org.scribe.model.*;
import org.scribe.oauth.*;

public class FoursquareExample
{
  private static final String PROTECTED_RESOURCE_URL = "http://api.foursquare.com/v1/user";

  public static void main(String[] args)
  {
    OAuthService service = new ServiceBuilder()
                            .provider(FoursquareApi.class)
                            .apiKey("FEGFXJUFANVVDHVSNUAMUKTTXCP1AJQD53E33XKJ44YP1S4I")
                            .apiSecret("AYWKUL5SWPNC0CTQ202QXRUG2NLZYXMRA34ZSDW4AUYBG2RC")
                            .build();
    Scanner in = new Scanner(System.in);

    System.out.println("=== Foursquare's OAuth Workflow ===");
    System.out.println();

    // Obtain the Request Token
    System.out.println("Fetching the Request Token...");
    Token requestToken = service.getRequestToken();
    System.out.println("Got the Request Token!");
    System.out.println();

    System.out.println("Now go and authorize Scribe here:");
    System.out.println(service.getAuthorizationUrl(requestToken));
    System.out.println("And paste the verifier here");
    System.out.print(">>");
    Verifier verifier = new Verifier(in.nextLine());
    System.out.println();

    // Trade the Request Token and Verfier for the Access Token
    System.out.println("Trading the Request Token for an Access Token...");
    Token accessToken = service.getAccessToken(requestToken, verifier);
    System.out.println("Got the Access Token!");
    System.out.println("(if your curious it looks like this: " + accessToken + " )");
    System.out.println();

    // Now let's go and ask for a protected resource!
    System.out.println("Now we're going to access a protected resource...");
    OAuthRequest request = new OAuthRequest(Verb.GET, PROTECTED_RESOURCE_URL);
    service.signRequest(accessToken, request);
    Response response = request.send();
    System.out.println("Got it! Lets see what we found...");
    System.out.println();
    System.out.println(response.getBody());

    System.out.println();
    System.out.println("Thats it man! Go and build something awesome with Scribe! :)");
 }

} 
```

# python - 使用内存引用重载 [] python 运算符和链接方法

> ID：10962448
> 
> 赞同：7
> 
> 时间：2012-06-09T16:00:28.477
> 
> 标签：python, operator-overloading

是否可以使用初始内存引用重载`[] (__getitem__)`Python 运算符和链方法。

想象一下，我有一个`Math`接受整数列表的类，如下所示：

```
class Math(object):
    def __init__(self, *args, **kwargs):
        assert(all([isinstance(item, int) for item in list(args)]))
        self.list = list(args)

    def add_one(self):
        for index in range(len(self.list)):
            self.list[index] += 1 
```

我想做这样的事情：

```
instance = Math(1,2,3,4,5)
instance[2:4].add_one() 
```

执行此代码后`instance.list`应该是`[1,2,4,5,5]`，这可能吗？

我知道我可以做类似的事情`add_one(2,4)`，但如果可能的话，这不是我想要的 API 风格。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-09T16:12:44.823

正如 Winston 提到的，您需要实现一个辅助对象：

```
class Math(object):
    def __init__(self, *args, **kwargs):
        self.list = list(args)

    def __getitem__(self, i):
        return MathSlice(self, i)

class MathSlice(object):
    def __init__(self, math, slice):
        self.math = math
        self.slice = slice

    def add_one(self):
        for i in xrange(*self.slice.indices(len(self.math.list))):
            self.math.list[i] += 1

instance = Math(1,2,3,4,5)
instance[2:4].add_one()

print instance.list 
```

与 MathSlice 对象共享数学对象的方式取决于如果数学对象发生更改，您希望语义是什么。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-09T16:07:32.707

Numpy 做这样的事情。

该`__getitem__`方法将接收一个`slice`对象。有关详细信息，请参阅[http://docs.python.org/reference/datamodel.html](http://docs.python.org/reference/datamodel.html)。您需要返回一个新对象，但实现该对象以修改原始列表。

# c# - 将通用 sql 查询嵌入到 c# 程序中

> ID：10962468
> 
> 赞同：-1
> 
> 时间：2012-06-09T16:03:30.553
> 
> 标签：c#, mysql

好的，主要参考我的第一个问题代码，我希望用户在运行时输入员工姓名，然后我将用户输入的这个姓名与我的 emp 表的 e_name 进行比较，如果它存在我想显示所有该员工的信息，我怎样才能做到这一点？

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Windows.Forms;
using MySql.Data.MySqlClient;

namespace ConnectCsharppToMySQL
{
    public  class DBConnect
    {
        private MySqlConnection connection;
        private string server;
        private string database;
        private string uid;
        private string password;

        string name;

        //Constructor
        public DBConnect()
        {
            Initialize();
        }

        //Initialize values
        private void Initialize()
        {
            server = "localhost";
            database = "test";
            uid = "root";
            password = "";
            string connectionString;
            connectionString = "SERVER=" + server + ";" + "DATABASE=" +
            database + ";" + "UID=" + uid + ";" + "PASSWORD=" + password + ";";

            connection = new MySqlConnection(connectionString);
        }

        //open connection to database
        private bool OpenConnection()
        {
            try
            {
                connection.Open();
                return true;
            }
            catch (MySqlException ex)
            {
                //When handling errors, you can your application's response based 
                //on the error number.
                //The two most common error numbers when connecting are as follows:
                //0: Cannot connect to server.
                //1045: Invalid user name and/or password.
                switch (ex.Number)
                {
                    case 0:
                        MessageBox.Show("Cannot connect to server.  Contact administrator");
                        break;

                    case 1045:
                        MessageBox.Show("Invalid username/password, please try again");
                        break;
                }
                return false;
            }
        }

        //Close connection
        private bool CloseConnection()
        {
            try
            {
                connection.Close();
                return true;
            }
            catch (MySqlException ex)
            {
                MessageBox.Show(ex.Message);
                return false;
            }
        }

        //Insert statement
        public void Insert()
        {
            string query = "INSERT INTO emp (e_name, age) VALUES('Pooja R', '21')";

            //open connection
            if (this.OpenConnection() == true)
            {
                //create command and assign the query and connection from the constructor
                MySqlCommand cmd = new MySqlCommand(query, connection);

                //Execute command
                cmd.ExecuteNonQuery();

                //close connection
                this.CloseConnection();
            }
        }

        //Update statement
        public void Update()
        {
            string query = "UPDATE emp SET e_name='Peachy', age='22' WHERE e_name='Pooja R'";

            //Open connection
            if (this.OpenConnection() == true)
            {
                //create mysql command
                MySqlCommand cmd = new MySqlCommand();
                //Assign the query using CommandText
                cmd.CommandText = query;
                //Assign the connection using Connection
                cmd.Connection = connection;

                //Execute query
                cmd.ExecuteNonQuery();

                //close connection
                this.CloseConnection();
            }
        }    

        //Select statement
        public List<string>[] Select()
        {

            string query = "SELECT * FROM emp where e_name=(/*I WANT USER ENTERED NAME TO GET INSERTED HERE*/)";

            //Create a list to store the result
            List<string>[] list = new List<string>[3];
            list[0] = new List<string>();
            list[1] = new List<string>();
            list[2] = new List<string>();

            //Open connection
            if (this.OpenConnection() == true)
            {
                //Create Command
                MySqlCommand cmd = new MySqlCommand(query, connection);
                //Create a data reader and Execute the command
                MySqlDataReader dataReader = cmd.ExecuteReader();

                //Read the data and store them in the list
                while (dataReader.Read())
                {
                    list[0].Add(dataReader["e_id"] + "");
                    list[1].Add(dataReader["e_name"] + "");
                    list[2].Add(dataReader["age"] + "");
                }

                //close Data Reader
                dataReader.Close();

                //close Connection
                this.CloseConnection();

                //return list to be displayed
                return list;
            }
            else
            {
                return list;
            }
        }

        public static void Main(String[] args)
        {

            DBConnect db1 = new DBConnect();
            Console.WriteLine("Initializing"); 
            db1.Initialize();

             Console.WriteLine("Search :");
             Console.WriteLine("Enter the employee name");
             db1.name = Console.ReadLine();
             db1.Select();

                      Console.ReadLine();

        }
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T16:18:58.427

使用 MySqlParameter 作为：

```
using (MySqlConnection connection = new MySqlConnection(connectionString))
{
    connection.Open();
    using (MySqlCommand command = new MySqlCommand ("SELECT * FROM emp where e_name =@Name", connection))
    {
        //
        // Add new SqlParameter to the command.
        //
        command.Parameters.AddWithValue("@Name", name);// name is get from console read line. 

        //
        // Read in the SELECT results.
        //
        MySqlDataReader reader = command.ExecuteReader();
        while (reader.Read())
        {
            // read each value 
        }
    }
} 
```

## 编辑

这是您需要做的更改

```
//add name as Select method parameter
public List<string>[] Select(string name)
{
  string query = "SELECT * FROM emp where e_name =@Name"; // change your select query 

  ....

  MySqlCommand cmd = new MySqlCommand(query, connection);
  cmd.Parameters.AddWithValue("@Name", name) // add this line after creating command 

  ....
} 
```

将上述方法称为

```
 db1.name = Console.ReadLine();
 db1.Select(db1.name); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T16:19:46.737

此方法需要接受一个参数：

```
public List<string>[] Select() 
```

像这样的东西，很可能是：

```
public List<string>[] Select(string name) 
```

然后，在该方法中，您可以引用该`name`变量。调用该方法时，您将提供该变量：

```
var listOfResults = dbConnectInstance.Select(someNameValue); 
```

一旦该变量出现在您的方法中，您就可以在 SQL 查询中使用它。您可以通过将其设置为`SELECT`查询中的参数来执行此操作。可能是这样的（请记住，这是徒手代码，我没有方便测试的 MySql .NET 库）：

```
string query = "SELECT * FROM emp where e_name=@ename";
//... (opening the connection like you do now, etc.)
MySqlCommand cmd = new MySqlCommand(query, connection);
cmd.Parameters.Add("@ename", MySqlDbType.VarChar, 80).Value = name;
//... (continuing as you do now) 
```

这本质上是在名为的查询中创建一个占位符`@ename`（它可以被称为任何东西，这`@`是作为占位符的重要部分），它期望被实际值替换。`Parameters`在命令对象的集合中添加一个项目就是用值替换占位符。

这在 ADO.NET（这是您正在使用的数据库连接技术）中称为“参数化查询”。它有助于使您的查询保持动态（一个查询可以以不同的值重复使用）以及有助于防止[SQL 注入攻击](http://msdn.microsoft.com/en-us/library/hdb58b2f.aspx)（请注意，我说*有助于防止*，因为它不是灵丹妙药，一般而言，增加对该主题的理解是您的最好的防守）。

更多关于 MySql .NET 库的查询和参数的信息可以[从这里开始](http://dev.mysql.com/doc/refman/5.0/es/connector-net-examples-mysqlparameter.html)。

# c# - 您的计算机中缺少 Rlapack.dll - c# 和 R

> ID：10962469
> 
> 赞同：2
> 
> 时间：2012-06-09T16:03:33.787
> 
> 标签：c#, r

当我通过集成了 R 的 Visual Studio 2010 运行 ac# 应用程序时，我收到错误消息：`The program can't start because Rlapack.dll is missing from your computer. Try reinstalling the program to fix this problem.` 我尝试重新安装程序，但它不起作用。我还尝试将其放入包含 Matrix 的文件夹中，但它不起作用。[StackOverflow Q](https://stackoverflow.com/questions/7960738/importing-mgcv-fails-because-rlapack-dll-cannot-be-found)中建议了此解决方案。

我正在运行 64 位 Windows 7！该应用程序是 32 位的。有两个dll。一个在名为 i386 的文件夹中，另一个在 x64 文件夹中。

这是我的代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using RDotNet;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {

        public Form1()
        {
            InitializeComponent();
            string dlldir = @"D:\Program Files\R-2.15.0\bin\i386";

            bool r_located = false;

            while (r_located == false)
            {
                try
                {
                    REngine.SetDllDirectory(dlldir);
                    REngine.CreateInstance("RDotNet");
                    r_located = true;
                }

                catch
                {
                    MessageBox.Show(@"Unable to find R installation's \bin\i386 folder.
                    Press OK to attempt to locate it.");

                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2018-01-11T16:07:29.560

我意识到这已经得到了回答，但那是在 2012 年。对于任何在 2018 年仍然遇到 R 版本 3.4.3 或更高版本的人，特别是在尝试遵循r.net 主页上[的简单示例](https://rdotnet.codeplex.com/)时，以下是我确实修复了它：

1.  在您的代码中，在该行之前`REngine engine = REngine.GetInstance();`，添加该行`REngine.SetEnvironmentVariables(@"C:\Program Files\R\R-3.4.3\bin\x64", @"C:\Program Files\R\R-3.4.3");`。

2.  右键单击项目，转到构建并取消选中“首选 32 位”。

3.  复制`Rlapack.dll`自`C:\Program Files\R\R-3.4.3\bin\i386`

4.  粘贴在两者`C:\Program Files\R\R-3.4.3\library\stats\libs\i386`中`C:\Program Files\R\R-3.4.3\library\Matrix\libs\i386`

5.  复制`Rlapack.dll`自`C:\Program Files\R\R-3.4.3\bin\x64`

6.  粘贴到`C:\Program Files\R\R-3.4.3\library\stats\libs\x64`和`C:\Program Files\R\R-3.4.3\library\Matrix\libs\x64`中。

如此痛苦，但这就是最终让它为我工作的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T10:11:38.383

这是我刚刚做的，它起作用了：我把 dll 放在我的应用程序的 bin 文件夹中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-03T19:19:30.107

尝试设置路径变量`before`调用 dll：

```
 var envPath = Environment.GetEnvironmentVariable("PATH");
     string s = null;
     if (Environment.Is64BitProcess)
         s = @"C:\Program Files\R\R-2.15.0\bin\x64";
     else
         s = @"C:\Program Files\R\R-2.15.0\bin\i386";
     Environment.SetEnvironmentVariable("PATH", envPath + Path.PathSeparator + s); 
```

# android - 无法检查我的 AVD 的目标

> ID：10962470
> 
> 赞同：0
> 
> 时间：2012-06-09T16:03:33.833
> 
> 标签：android, eclipse

当我添加一个新的 AVD 时，我禁用了目标列表：

![在此处输入图像描述](../Images/b7d28bfafe1f1dbd9f593279fbab27eb.png)

我是Android新手，我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T16:10:07.353

你确定你打开了sdk manager并安装了android？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T16:25:26.403

您需要打开android sdk manager，然后安装至少一个android平台（包）安装。

![在此处输入图像描述](../Images/0cbb1ebd571ca6c3157d27b360adf4a8.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T16:31:07.513

确保

1.你已经从sdk manager安装了android

2\. 您已经在 Eclipse 中设置了正确的路径。窗口--->首选项-->Android-->SDK 位置。如果一切都好。您将在列表中看到 android 版本。

# c++ - 验证IP地址的简易方法已发布

> ID：10962473
> 
> 赞同：0
> 
> 时间：2012-06-09T16:03:49.867
> 
> 标签：c++, network-programming, dhcp

我正在一个依赖于网络连接的 Linux 机器（DHCP 客户端）上编写 C++ 程序。我需要务实地验证我的系统是否有 IP 地址。我知道这是一个普遍且开放式的问题，因此任何快速而肮脏的解决方案都对我有用，但理想情况下，我想检查/读取系统文件以确保 DHCP 客户端已从 DHCP 服务器接收到 IP 地址。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T02:45:50.727

只需尝试任何需要 IP 地址的操作，如果有的话应该可以工作。想到了 DNS 查找。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T02:57:04.227

也许看看 say 的来源`ifconfig`，因为如果分配了一个，它会得到 IP 地址。快速 strace 表明它可能是一个 ioctl，例如

```
ioctl(4, SIOCGIFADDR, {ifr_name="eth0", ifr_addr={AF_INET, inet_addr("<my ip>")}}) 
```

我的 IP 地址的 /proc/net 的 grep 表明，如果您知道如何解析`/proc/net/fib_trie`，则可以从那里获取它。

# sql - Oracle Pro*C 使用游标更新表失败

> ID：10962482
> 
> 赞同：0
> 
> 时间：2012-06-09T16:05:24.253
> 
> 标签：sql, c, oracle, cursor

我有一张这样的桌子：

```
CREATE TABLE book_info (
     book_id                 VARCHAR(32)     not null,
     title                   varchar(255)    not null,
     author                  varchar(255)    not null,
     folder_path         varchar(255)    not null,
     primary key(book_id)
); 
```

我在上面插入了这些数据：

```
insert into book_info values('BOOK1', 'APUE', 'Richard Stevens', '/home/user1/unix_programming_books');
insert into book_info values('BOOK2', 'Unix Network programming', 'Richard Stevens', '/home/user1/unix_programming_books');
insert into book_info values('BOOK3', 'Core Python Applications Programming', 'Wesley J. Chun', '/home/user1/python_programming_books'); 
```

我正在尝试使用 Oracle PRO*C 更新此表，但我不能！下面是我的代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

EXEC SQL INCLUDE SQLCA;
EXEC SQL INCLUDE ORACA;

#define USER_LEN                        10                          
#define PASS_LEN                        10                          

VARCHAR user[USER_LEN];
VARCHAR pass[PASS_LEN];

#define STRCPY_TO_ORA(dest, source)\
        dest.len = strlen(source);\
        strcpy((char *)dest.arr, (const char *)source)

#define STRCPY_FROM_ORA(dest, source)\
        source.arr[source.len] = 0;\
        strcpy((char *)dest,(const char *)source.arr)

/* Connecting to the database */
int db_connection(char *db_user, char *db_pass)
{
        strncpy((char *) user.arr, db_user, USER_LEN);
        user.len = strlen((char *) user.arr);
        strncpy((char *) pass.arr, db_pass, PASS_LEN);
        pass.len = strlen((char *) pass.arr);

    EXEC SQL CONNECT :user IDENTIFIED BY :pass;
        if (sqlca.sqlcode != 0)
        {
        fprintf(stdout, "Connection failed:%s\n", sqlca.sqlerrm.sqlerrmc);
                return(sqlca.sqlcode);
        }
    fprintf(stdout, "Connected to ORACLE as user:%s\n", user.arr);
        return (sqlca.sqlcode);
}

int book_not_found_function(char *path)
{
    fprintf(stdout, "%s\n", __FUNCTION__);
}

int path_update_success_function(char *book_id, char *new_path)
{
    fprintf(stdout, "Update book %s path to %s\n", book_id, new_path);
}

void other_function(void)
{
    fprintf(stdout, "%s\n", __FUNCTION__);  
}

/* Updating books path */
int books_path_updating(char *old_path, char *new_path) 
{
    char book_id_string[32];
        EXEC SQL BEGIN DECLARE SECTION;
        varchar sql_old_path[255];
        varchar sql_new_path[255];
    varchar sql_book_id[32];
        EXEC SQL END DECLARE SECTION;

        STRCPY_TO_ORA(sql_old_path, old_path);
        STRCPY_TO_ORA(sql_new_path, new_path);

    /* Declare a cursor for the FETCH statement. */
    EXEC SQL DECLARE books_cursor CURSOR FOR
    SELECT BOOK_ID
        FROM BOOK_INFO 
        WHERE FOLDER_PATH = :sql_old_path;

    if (sqlca.sqlcode != 0)
    {
            fprintf(stdout, "Declare cursor failed\n");
        fprintf(stdout, "Oracle error %s\n", sqlca.sqlerrm.sqlerrmc);
            return(sqlca.sqlcode);
    }

    EXEC SQL OPEN books_cursor;

    if (sqlca.sqlcode != 0)
    {
            fprintf(stdout, "Open cursor failed\n");
        fprintf(stdout, "Oracle error %s\n", sqlca.sqlerrm.sqlerrmc);
            return(sqlca.sqlcode);
    }

    for ( ;; )
    {
        //EXEC SQL WHENEVER NOT FOUND DO break; // I used it but still nothing
        //EXEC SQL WHENEVER NOT FOUND GOTO not_found; // I used this too
        //EXEC SQL WHENEVER NOT FOUND DO continue; // I used this too

            /* Fetching data */
            EXEC SQL FETCH books_cursor 
            INTO :sql_book_id;
        if (sqlca.sqlcode == 1403)
        {
            fprintf(stdout, "No book found for this folder %s\n", old_path);    
            book_not_found_function(old_path);

            return 0;
        }

            else if (sqlca.sqlcode != 0)
            {
            fprintf(stdout, "Oracle error %s\n", sqlca.sqlerrm.sqlerrmc);
                    EXEC SQL CLOSE books_cursor;
                    return (sqlca.sqlcode);
            }

        else
        {
            STRCPY_FROM_ORA(book_id_string, sql_book_id);
                fprintf(stdout, "BOOK_ID = %s\n", book_id_string);
            /* Updating the path */
            EXEC SQL UPDATE BOOK_INFO
            SET FOLDER_PATH =:sql_new_path
            WHERE BOOK_ID =:sql_book_id;
            if (sqlca.sqlcode != 0)
                {
                fprintf(stdout, "Oracle error %s\n", sqlca.sqlerrm.sqlerrmc);
                        EXEC SQL CLOSE books_cursor;
                        return (sqlca.sqlcode);
                }
            else
            {
                path_update_success_function(book_id_string, new_path); 
            }
        }
    }
    EXEC SQL CLOSE books_cursor;
    other_function();

    EXEC SQL COMMIT WORK RELEASE;   
    return 0;   
}

int main(int argc, char **argv)
{
    db_connection("evariste", "123456");

    books_path_updating("/home/user1/unix_programming_books", "/home/user1/UNIX_PROGRAMMING_BOOKS");
    books_path_updating("/non_existing_path", "/non_existing_path");

    return 0;
} 
```

该程序产生输出：

```
Connected to ORACLE as user:evariste
BOOK_ID = BOOK1
Update book BOOK1 path to /home/user1/UNIX_PROGRAMMING_BOOKS
BOOK_ID = BOOK2
Update book BOOK2 path to /home/user1/UNIX_PROGRAMMING_BOOKS
No book found for this folder /home/user1/unix_programming_books // WHEY THIS?
book_not_found_function // WHY THIS
Declare cursor failed   // WHY THIS 
Oracle error ORA-01403: no data found // WHY THIS 
```

该表没有更新，函数**path_update_success_function**和**other_function**永远不会执行！为什么这个？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T11:53:49.533

> ```
> Connected to ORACLE as user:evariste
> BOOK_ID = BOOK1
> Update book BOOK1 path to /home/user1/UNIX_PROGRAMMING_BOOKS
> BOOK_ID = BOOK2
> Update book BOOK2 path to /home/user1/UNIX_PROGRAMMING_BOOKS
> No book found for this folder /home/user1/unix_programming_books // WHEY THIS? 
> ```

您已经获取了结果集的末尾。这次有两行匹配游标，所以前两次fetch成功；第三个没有数据。这是意料之中的，您不应将其视为错误 - 只需中断循环，这也会导致`other_function`被调用。

> ```
> book_not_found_function // WHY THIS 
> ```

因为您将 1403 视为错误。如果你想在没有匹配的时候调用这个函数，你需要在循环中计数，如果需要，之后再调用它。

> ```
> Declare cursor failed   // WHY THIS 
> Oracle error ORA-01403: no data found // WHY THIS 
> ```

`sqlca.sqlcode`似乎仍然是从较早的提取中设置的，所以这是一种误导。

据我所知，您通常会在文件中声明一次光标，而不是每次调用函数时；不确定 Pro*C 是否只是忽略重新定义。您可以查看生成的文件以了解它如何处理它。您也不会从中得到运行时错误，如果它是错误的，它将不会（预）编译。

> 该表没有更新，函数 path_update_success_function 和 other_function 永远不会执行！为什么这个？

`path_update_success`前两次提取被调用，但第三次调用失败，第二个路径则不调用，因为函数`declare cursor`在接近它之前由于明显而返回。`other_function`不会被调用，因为对于这两个调用，您在到达之前都从函数返回。同样，该表似乎没有更新，因为您在提交之前返回。与 SQL*Plus 不同，Pro*C 不会在退出时自动提交，因此存在隐式回滚。另请注意，如果您确实到达了`commit`，则会`release`断开您的连接，因此您第二次会收到未连接到 Oracle 的错误。您应该决定真正提交/回滚一次，可能就在`main`.

* * *

未经测试的修改：

```
int books_path_updating(char *old_path, char *new_path)
{
    char book_id_string[32];
    int books_found;

    EXEC SQL BEGIN DECLARE SECTION;
        varchar sql_old_path[255];
        varchar sql_new_path[255];
        varchar sql_book_id[32];
    EXEC SQL END DECLARE SECTION;

    STRCPY_TO_ORA(sql_old_path, old_path);
    STRCPY_TO_ORA(sql_new_path, new_path);

    /* Declare a cursor for the FETCH statement */
    EXEC SQL DECLARE books_cursor CURSOR FOR
        SELECT BOOK_ID
        FROM BOOK_INFO
        WHERE FOLDER_PATH = :sql_old_path;

    EXEC SQL OPEN books_cursor;

    if (sqlca.sqlcode != 0)
    {
        fprintf(stdout, "Open cursor failed\n");
    }

    books_found = 0;
    while (sqlca.sqlcode == 0)
    {
        /* Fetching data */
        EXEC SQL FETCH books_cursor
        INTO :sql_book_id;

        if (sqlca.sqlcode != 0)
        {
            break;
        }

        STRCPY_FROM_ORA(book_id_string, sql_book_id);
            fprintf(stdout, "BOOK_ID = %s\n", book_id_string);

        /* Updating the path */
        EXEC SQL UPDATE BOOK_INFO
            SET FOLDER_PATH = :sql_new_path
            WHERE BOOK_ID = :sql_book_id;

        if (sqlca.sqlcode != 0)
        {
            break;
        }

        /* Track how many books we found, though we only really care later that
         * this is non-zero */
        books_found++;

        path_update_success_function(book_id_string, new_path);
    }

    EXEC SQL CLOSE books_cursor;

    /* Check for and display error, but ignore 1403 as this just indicates the
     * end of the result set */
    if ((sqlca.sqlcode != 0) && (sqlca.sqlcode != 1403))
    {
        fprintf(stdout, "Oracle error %s\n", sqlca.sqlerrm.sqlerrmc);
        return 1;
    }

    if (books_found == 0)
    {
        fprintf(stdout, "No book found for this folder %s\n", old_path);
        book_not_found_function(old_path);
        return 0;
    }

    other_function();

    return 0;
}

int main(int argc, char **argv)
{
    int rc;

    rc = db_connection("evariste", "123456");

    /* Only do the first path if we didn't get an error connecting */
    if (rc == 0)
    {
        rc == books_path_updating("/home/user1/unix_programming_books",
            "/home/user1/UNIX_PROGRAMMING_BOOKS");
    }

    /* Only do the next path if we didn't get an error from the previous one */
    if (rc == 0)
    {
        rc = books_path_updating("/non_existing_path",
            "/non_existing_path");
    }

    /* Decide whether to rollback or commit; this assumes you don't want to
     * keep any changes if there are any errors */
    if (rc != 0)
    {
        EXEC SQL ROLLBACK WORK RELEASE;
        return 1;
    }

    EXEC SQL COMMIT WORK RELEASE;
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-15T17:00:13.273

似乎 DECLARE CURSOR 没有设置 sqlca.sqlcode。当您完成提取时，您遇到的错误是前一个错误。

所以你不应该在 DECLARE CURSOR 之后测试错误，而应该只在 OPEN CURSOR 之后。

# c - 在链表中追加节点时未显示结果

> ID：10962485
> 
> 赞同：0
> 
> 时间：2012-06-09T16:06:11.663
> 
> 标签：c, linked-list

我已经编写了一个代码来附加节点是否为空。我认为我的代码和逻辑是正确的，但我仍然无法得到任何答案。它的编译但运行后没有显示任何结果。请告诉我为什么

```
#include<stdio.h>
#include<stdlib.h>

struct node 
{
    int data;
    struct node *nxt;
};

void append(struct node *,int);
void display(struct node*);

void append( struct node *q, int num )
{
    struct node *temp,*r;
    if(q == NULL)
    {
        temp = (struct node*)malloc(sizeof(struct node));
        temp -> data = num;
        temp -> nxt = NULL;
        q = temp;
    }
    else
    {
        temp = q;
        while(temp->nxt != NULL)
        {
            temp = temp->nxt;
        }
        r = (struct node*)malloc(sizeof(struct node));
        r -> data = num;
        r -> nxt = NULL;
        temp->nxt = r;
    }
}

void display(struct node *q)
{
    while(q != NULL)
    {
        printf("%d",q->data);
        q = q->nxt;
    }
}

int main()
{
    struct node *a;
    a= NULL;
    append(a,10);
    append(a,11);
    append(a,12);
    display(a);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T16:09:31.113

您需要通过地址将第一个参数（列表头）的`append`地址传递给方法。如所写，它在第一次调用（以及每个后续调用）中传递 NULL，因为它是按值传递的。

原型应该是这样的：

```
void append( struct node **q, int num ) 
```

然后像这样拨打电话：

```
append(&a,10); 
```

请注意，`append`需要相应地更新函数以正确处理参数更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T16:10:22.427

append 的原型需要修改为

```
void append( struct node **q, int num ); 
```

并将`a`as的地址传递`&a`给此函数。这是因为 C 只支持按值传递。[在此处](http://www.maths.cam.ac.uk/undergrad/catam/ccatsl/manual/node50.html)了解更多信息。

请找到修改后的附加功能，如下所示：

```
void append( struct node **q, int num ) 
{     
  struct node *temp,*r;     

  if(*q == NULL)     
  {         
     temp = (struct node*)malloc(sizeof(struct node));
     temp -> data = num;
     temp -> nxt = NULL;
     *q = temp;
  }
  else
  {
     temp = *q;
     while(temp->nxt != NULL)
     {
         temp = temp->nxt;
     }
     r = (struct node*)malloc(sizeof(struct node));
     r -> data = num;
     r -> nxt = NULL;
     temp->nxt = r;
 } 
} 
```

此外：

更改以下行：

```
printf("%d",q->data); 
```

作为

```
printf("%d\n",q->data); 
```

除非某些终端中有换行符，否则 printf 可能不会刷新数据。

# lan - 如何禁用几乎阻止每个端口的 Rogers NetComm Rocket Hub 防火墙

> ID：10962489
> 
> 赞同：-1
> 
> 时间：2012-06-09T16:06:41.743
> 
> 标签：lan, ports

出于某种原因，我的 Rocket Hub 几乎阻塞了所有端口，除了一些更常用的端口，如 443、80、22、21、20 等。

我可以在我的桌面上运行我的本地 LAMP 服务器并从我的笔记本电脑访问它，但是当我尝试使用协同或通过 LAN 连接到 Minecraft 服务器时，我无法这样做。我在使用服务器计算机时可以访问 Minecraft 服务器，即使使用 Rocket Hub 提供的 IP 而不是 localhost；但是当我尝试通过 LAN 上的其他任何东西连接到它时，我被阻止这样做。

我坚信这是 Rogers Rocket Hub 的问题，因为在 Rocket Hub 之前我没有遇到任何问题。我也尝试将特定端口添加到 NAT 端口转发设置，但仍然没有运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T16:15:14.283

我弄清楚了这个问题。问题不是路由器的防火墙，而是我的病毒扫描程序的防火墙 - Vipre Antivirus。

在尝试在 Ubuntu 中启动我的 Minecraft 服务器后，我意识到这是问题所在，并且它起作用了。我以前从未遇到过这个问题的原因是因为在我得到火箭集线器之前，我在 Ubuntu 上托管了 LAN 服务器。

对于希望找到修复程序的任何人，打开 Vipre Antivirus 单击防火墙旁边的编辑设置，单击例外，然后转到端口选项卡并为特定端口添加例外。在本例中，Minecraft 端口为 25565，并使用 TCP 协议。选择 Minecraft 服务器的 exe 文件，你应该没问题。如果它仍然不起作用，您可以在要运行服务器时暂时禁用防火墙，直到找到修复程序。

# android - 如何正确地将 JSON .net Web 服务解析为 Android？

> ID：10962490
> 
> 赞同：0
> 
> 时间：2012-06-09T16:06:52.757
> 
> 标签：android, asp.net, json, web-services

我已经尝试了许多版本的解析来自我的 .net Web 服务的 JSON 数据，而我目前的版本在我的 JSON 数据前面添加了一个 {"d": ..... 我不知道为什么。

手动调用我的网络服务时，数据格式正确。但是，当我使用这个解析器时，我检查了使用 .names() 以列出 JSONObjects 的名称，它只显示 ["d"]

是否有任何推荐的代码来解析 Java 中的 JSON Web 服务？

这是我解析数据的代码

```
 //initialize
                InputStream is = null;
                String result = "";
                JSONObject jArray = null;
                String url = "http://10.0.2.2:1672/Eventurous/WsEventurousMobile.asmx/getEventsList";
                //http post
                try{

                    HttpClient httpclient = new DefaultHttpClient();
                    HttpPost httppost = new HttpPost(url);

                    JSONObject obj = new JSONObject();
                    obj.put("category",category);
                    httppost.setEntity(new StringEntity(obj.toString(),"UTF-8"));

                    httppost.setHeader("Accept","application/json");
                    httppost.setHeader("Content-type","application/json");

                    HttpResponse response = httpclient.execute(httppost);
                    HttpEntity entity = response.getEntity();
                    is = entity.getContent();

                }catch(Exception e){
                    Log.e("log_tag", "Error in http connection "+e.toString());
                }

                //convert response to string
                try{
                    BufferedReader reader = new BufferedReader(new InputStreamReader(is,"iso-8859-1"),8);
                    StringBuilder sb = new StringBuilder();
                    String line = null;
                    while ((line = reader.readLine()) != null) {
                        sb.append(line + "\n");
                    }
                    is.close();
                    result=sb.toString();
                }catch(Exception e){
                    Log.e("log_tag", "Error converting result "+e.toString());
                }

                //try parse the string to a JSON object
                try{
                        jArray = new JSONObject(result);
                }catch(JSONException e){
                    Log.e("log_tag", "Error parsing data "+e.toString());
                }

                try{

                        JSONArray catalogObj = jArray.getJSONArray("Table");
   //Im using the newtonsoft json dataset converter and so the name of the JSONArray
       //is by default Table and i have no idea how to change it either

                        JSONObject event = catalogObj.getJSONObject(0);
                        return event.getString("EventName");        

                }
                catch(Exception e)
                {
                    return e.toString();
                } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T16:09:03.270

我建议使用 gson 库[http://code.google.com/p/google-gson/](http://code.google.com/p/google-gson/)。

> 是否有任何推荐的代码来解析 Java 中的 JSON Web 服务？

在不知道 json 数据的情况下，很难给出任何具体的建议。但无论如何，我建议使用在 Android 开发人员中非常流行的 gson 库。

# java - 在没有 java -jar unix & windows 的情况下运行 JAR？

> ID：10962492
> 
> 赞同：0
> 
> 时间：2012-06-09T16:07:19.167
> 
> 标签：java, windows, unix, command-line, jar

我想在**unix和windows**中运行一个jar文件，而不必直接用java调用它，比如：

```
java -jar myjar.jar parameters 
```

我想要 ：

```
myjar.jar parameters 
```

我一直在阅读-

[运行 JAR 文件而不直接调用 `java`](https://stackoverflow.com/questions/1667830/running-a-jar-file-without-directly-calling-java)

对于 unix 来说，这似乎是一个非常好的技巧。

但是，这在 Windows 中不起作用。

我正在寻找一种适用于 unix 和 windows 的统一解决方案，但我不确定是否存在。

该解决方案必须只有一次，并且它必须包括与 jar 相关的更改，而不是操作系统 - 因为这是我提供给客户的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T16:30:17.873

您所要求的无法完成：Windows 将仅以.dll 文件中的 .exe 中使用的[PE/COFF格式加载可执行文件。](http://en.wikipedia.org/wiki/Portable_Executable)

相反，您可以做的是为用户提供一个启动实际 Java 程序的“包装”程序。您可以在 C 中创建包装器，这有几个好处：您可以在可执行文件上设置图标并将程序与 Windows 资源管理器中的文件类型相关联。[批处理文件](http://en.wikipedia.org/wiki/Batch_file)是一种流行的替代方案；它们更容易创建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T16:33:02.737

您可以编写自己的 bash 和批处理/powershell 脚本。至于 windows，你可以试试[Launch4J](http://launch4j.sourceforge.net/)。它应该比从头开始编写复杂的脚本更容易。

请注意，您只能提供包装器以使执行更简单（一键式）。无论如何，Java 都必须运行。明确地，由用户，或作为脚本的一部分。你不能没有它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T16:29:13.653

您可以提供一个脚本来为 Unix (.sh) 和 Windows (.bat) 启动您的应用程序。这似乎是许多公司的首选方法。一个例子是 JBoss 服务器，其中为 Windows 提供了 run.bat，为 Unix 提供了 run.sh。这些脚本设置适当的环境变量、类路径等，然后调用 java.lang.

# .net - .net 中是否有 Xml 的替代品？

> ID：10962496
> 
> 赞同：0
> 
> 时间：2012-06-09T16:07:40.707
> 
> 标签：.net, xml

我有 .net 4.0 silverlight 项目，并且在外部 xml 文件中保存了许多应用程序和/或用户特定的配置。应用程序特定的配置是指项目名称、url、特定的 UI 配置等。随着我的应用程序的增长，这些 xml 配置文件的数量和每个 xml 文件中的内容。所以我的问题是：.net 中是否有任何替代方法可以将这些类型的值存储在其他地方？以前我在数据库表中拥有所有这些值，因此不存在该选项。我正在寻找某种不同类型的存储库的方法或某种方式来模块化我不断增长的 xml。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T16:40:26.183

您始终可以使用存储在文本文件中的 JSON，与 Xml 相比，它是轻量级的，并且仍然清晰易懂，并且可以轻松地序列化和反序列化为 C# 对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T16:42:52.443

在我看来，您的问题不是数据的实际格式，而是配置管理过程的要求越来越高。您可能想考虑实现一个简单的管理工具来帮助您（或其他人）管理您的配置数据，然后数据格式的选择是次要的。

在我目前的公司，配置管理的发展非常自然。首先，我们将大部分配置放在数据库的配置表中。然后我们对其进行更改并将其放入 XML 中，然后将这些 XML 放入我们的数据库中。然后我们将这些 XML 重构为规范格式，并实现了一个 GUI 工具来编辑它们，以便猴子可以进行配置。它当然不完美，但我们很满意。

# wcf - 如何区分不同参数的WCF函数调用？

> ID：10962498
> 
> 赞同：1
> 
> 时间：2012-06-09T16:07:54.020
> 
> 标签：wcf, silverlight

我正在使用 WCF 在我的 Silverlight 应用程序（Visual Studio 2010，C#）中阅读电子邮件 (IMAP)。我创建了一个读取电子邮件的函数，它接受一个可以是收件箱、发件箱或草稿的字符串参数，我如何在我的`myFunctionCompleted`函数中理解我的输入参数是`myFunctionAsync`什么？

例如我打电话：

```
ReadMailAsync("inbox");
ReadMailAsync("outbox"); 
```

我应该打`ReadMailCompleted`两次电话（每次打电话`ReadMailAsync`）吗？如何区分我的`ReadMailCompleted`以便我可以读取正确的结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T16:56:53.413

您可以在调用时将文件夹作为 asyncState 对象传递`ReadMailAsync`：

```
var folder = "inbox";
ReadMailAsync(folder, folder); 
```

asyncState 对象将在`ReadMailCompleted`处理程序中返回给您：

```
void OnReadMailCompleted(object sender, ReadMailCompletedEventArgs e)
{
    var folder = e.Result.AsyncState as string; //now you have the input parameter...
} 
```

# javascript - 淘汰赛/MVVM 设计问题

> ID：10962499
> 
> 赞同：2
> 
> 时间：2012-06-09T16:08:07.967
> 
> 标签：javascript, design-patterns, mvvm, knockout.js

我正在努力解决一个在使用 KnockoutJS 框架和 MVVM 时不断出现的问题。有时，集合中特定项目的属性发生更改，并且由于该更改，我需要影响同一集合中的所有其他项目。在所有语言和模式中，一个对象不应该“知道”它所在的集合的任何信息，但我发现自己需要经常打破这个规则才能让某些类型的逻辑起作用。

我已经创建了一个人为的示例来说明我正在谈论的内容，以展示我一直在解决这个问题的骇人听闻的方式。我希望有更多经验的人可以参与并告诉我更好的方法来做到这一点。

[JSFiddle 人为设计的示例](http://jsfiddle.net/zero21xxx/wXYYw/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T20:58:40.277

我不知道这是否是“推荐”的方法，但我会就如何解决这个问题提出我的建议。我不是 MVVM 专家（尽管我已经编写了很多 KnockoutJS 应用程序），但我认为一些 OOP 原则将足以在这里提供帮助。

### 所以首先让我们讨论一下目前的情况......

正如您正确观察到的那样（敲除双关语无意！），您的方法并不理想-`Person`对象不仅知道它们的兄弟姐妹（即使通过订阅间接地知道），而且还知道它们订阅的父对象-您的`Person`类型已订阅对父级进行更改。这不仅使您的`Person`对象在此场景之外无法使用，而且还赋予每个实例过多的责任（违反单一责任原则），并且每个实例都订阅了其他每个实例的更改，这当然是浪费！

### 那么解决方案是什么？

对我来说，放置这种逻辑的理想位置是在您的父对象（即您的视图模型）上。您的视图模型已经知道它的子对象，那么为什么不把功能放在那里呢？这将使您的`Person`类型可以在其他地方重用（好吧，所以它有可观察的，所以它现在与 KO 相关联，但这可以通过 Mapping 插件来克服）并减轻它管理其兄弟姐妹的责任。

但这仍然意味着您在父母和孩子之间有紧密的耦合 - 这不是我们在 OOP 中想要的！为了克服这个问题，您可以采用发布/订阅（观察者）模式，并让您的`Person`类型在发生变化时发布消息，然后您可以让订阅者（例如您查看模型）决定如何响应此事件。您也不一定需要使用淘汰赛的 pub/sub 产品，任何 pub/sub 实现都可以。虽然您也可以利用 KO 提供的功能，所以我会向您指出这些扩展/帮助程序的方向，以使事情变得简单：[http ://www.knockmeout.net/2012/05/using-ko-native -pubsub.html](http://www.knockmeout.net/2012/05/using-ko-native-pubsub.html)

希望我有所帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T19:46:29.873

除非我误解了您的情况，否则您可以使用`computed`自动动态更新的可观察对象。

首先，我认为每个人的“未成年”财产标志只是将他们的年龄与一分钟相比的计算。年龄。例如 19。

其次，您还可以使用`computed`observable 为所有用户做一个聚合标志。

最后，我不一定同意这是父子关系。这些只是特定于页面的视图模型的属性。

看看这个在这两种情况下都使用计算的例子。 [http://codepen.io/anon/pen/ufKCo](http://codepen.io/anon/pen/ufKCo)

# symfony1 - 在 Doctrine 中手动保存多对多关系

> ID：10962500
> 
> 赞同：2
> 
> 时间：2012-06-09T16:08:25.840
> 
> 标签：symfony1, doctrine, many-to-many, symfony-1.4

我刚刚创建了一个具有多对多关系（用户组）和以下代码的新项目。

正如您可以在代码中猜到的那样，我正在尝试将组手动分配给用户，但它没有分配任何东西......任何想法？

```
User:
  columns:
    id: 
      type: integer(4)
      autoincrement: true
      primary: true
    username:
      type: string(255)
    password:
      type: string(255)
  attributes:
    export: all 
    validate: true

Group:
  tableName: group_table
  columns:
    id: 
      type: integer(4)
      autoincrement: true
      primary: true
    name:
      type: string(255)
  relations:
    Users:
      foreignAlias: Groups
      class: User
      refClass: GroupUser

GroupUser:
  columns:
    group_id:
      type: integer(4)
      primary: true
    user_id:
      type: integer(4)
      primary: true
  relations:
    Group:
      foreignAlias: GroupUsers
    User:
      foreignAlias: GroupUsers 
```

代码是这样的：

```
 public function executeIndex(sfWebRequest $request)
  {
    $user = Doctrine_Core::getTable('User')->find(1);

    $groups = Doctrine_Core::getTable('Group')->findAll();

    $user->setGroups($groups);

    $user->save();
    $this->forward('default', 'module');
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T19:57:28.100

尝试在用户实体中定义关系（并且不要在组中使用foreingAlias）。也使用**本地**和**外国**领域。因此，schema.yml 应该如下所示：

```
User:
  ...
  relations:
    Groups:
      class: Group
      refClass: GroupUser
      local: user_id
      foreign: group_id

Group:
  ...
  relations:
    Users:
      class: User
      refClass: GroupUser
      local: group_id 
      foreign: user_id 
```

如果这不起作用，我认为您可以使用 Doctrine“链接”方法设置组。查看 Record.php（可能在 lib/vendor/symfony/lib/plugins/sfDoctrinePlugin/lib/vendor/doctrine/Doctrine 文件夹中）

例子：

```
$groups_ids = array();
foreach($groups as $group) $groups_ids[] = $group->getId();
$user->link('Groups',$groups_ids); 
```

此外，如果您只想向该关系添加实例（并且您讨厌将来修复您的代码的人），您可以创建 N-GroupUsers 示例：

```
foreach($groups as $group) {
    $ug = new GroupUser();
    $ug->setUserId($user->getId());
    $ug->setGroupId($user->getId());
    $ug->save();
} 
```

请使用第一个选项，让我知道这是否适合您！

# php - 创建的符号链接不适用于下载管理器？还有 .htaccess

> ID：10962501
> 
> 赞同：0
> 
> 时间：2012-06-09T16:08:45.607
> 
> 标签：php, .htaccess, http-headers, download, symlink

我正在尝试设置一个小型 Web 文件服务器。我已经下载了一些软件，我正在尝试学习如何配置它以在单击链接时下载文件，而不是尝试在浏览器中打开它们

我的文件存储在与我的 web 目录不同的目录中。所以我做了一个符号链接和一个别名，它似乎工作！但我不确定我必须从这里做什么所以我发现*.htaccess*信息说它可以强制文件下载。所以我这样做了：

```
<FilesMatch "\.(jpg|zip|avi|mkv|mp4)$" >
    ForceType application/octet-stream
    Header add Content-Disposition "attachment"
</FilesMatch> 
```

问题是它不起作用。这会在符号链接目录中工作吗？我尝试将它放在我的索引和符号链接文件夹中。它不起作用。

另一件事是我可以右键单击我网站上的链接，然后单击“将链接另存为”，这样我就可以下载文件了。但是，如果我单击“复制链接地址”并将其粘贴到我的下载管理器中，它将不起作用。有没有办法来解决这个问题？

# ios - iOS使用本地时区设置ekevent开始时间

> ID：10962504
> 
> 赞同：0
> 
> 时间：2012-06-09T16:09:10.303
> 
> 标签：ios, eventkit, ekevent

在我的 iOS 应用程序中，我展示了日期选择器，用户可以通过该选择器选择他们想要选择的时间以将事件存储在日历中。我正在为此使用活动工具包。
这工作正常。但问题是它在 GMT 时区创建了偶数。如何根据当地时间在日历中创建事件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T02:16:21.867

我找到了解决方案：我们不必将数据转换为本地时区。我们必须在 GMT 时区设置开始日期，并且事件工具包将处理转换为本地时区并显示它。

# php - PHP 数值 preg_match

> ID：10962509
> 
> 赞同：-2
> 
> 时间：2012-06-09T16:09:56.063
> 
> 标签：php, scripting, preg-match

目前我有一个看起来像这样的代码片段：

```
preg_match('/^(\D+)\s=\s(\d+)\s=\s(\D+)\s=\s(\d+)/', trim($row), $matches); 
```

我想要做的是允许它也使用数字，因为在我的输出中它没有显示数字。我该怎么做呢？请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T12:58:17.630

检查这是否解决了您的问题：

```
preg_match('/^(.+)\s=\s(\d+)\s=\s(\D+)\s=\s(\d+)/', trim($row), $matches); 
```

来源：[https ://stackoverflow.com/a/10963620/1439823](https://stackoverflow.com/a/10963620/1439823)

如果您希望允许数字和等于“=”之间的任何内容，您应使用下面的代码

```
preg_match('/^(.+)\s=\s(.+)\s=\s(.+)\s=\s(.+),/', trim($row), $matches); 
```

# javascript - Webkit 和 Moz 变换，取决于浏览器

> ID：10962511
> 
> 赞同：2
> 
> 时间：2012-06-09T16:10:17.790
> 
> 标签：javascript, firefox, cross-browser, transform, browser-detection

我有一些 Javascript 可以检测浏览器并根据浏览器对元素应用转换。Webkit 的那个在 Chrome 上运行良好，但 Firefox 的那个不行。有人可以告诉我下面的代码是否正确：

```
if(typeof navigator.vendor.toLowerCase().indexOf('chrome')!=-1){    
    document.getElementById('jj_preview7').style.WebkitTransform = 'scale(' + jj_input23 + ') ' + 'rotate(' + jj_input24 + 'deg)' + 'translate(' + jj_input25 + 'px, ' + jj_input26 + 'px)' + 'skew(' + jj_input27 + 'deg, ' + jj_input28 + 'deg)';
}

if(typeof navigator.vendor.toLowerCase().indexOf('firefox')!=-1){
    document.getElementById('jj_preview7').style.MozTransform = 'scale(' + jj_input23 + ') ' + 'rotate(' + jj_input24 + 'deg)' + 'translate(' + jj_input25 + 'px, ' + jj_input26 + 'px)' + 'skew(' + jj_input27 + 'deg, ' + jj_input28 + 'deg)';
} 
```

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T16:46:46.147

```
// Test element we apply both kinds of transforms to:
var testEl = document.createElement('div');
testEl.style.MozTransform = 'translate(100px) rotate(20deg)';
testEl.style.webkitTransform = 'translate(100px) rotate(20deg)';
var styleAttrLowercase = testEl.getAttribute('style').toLowerCase();

// when we check for existence of it in the style attribute;
// only valid ones will be there.
var hasMozTransform = styleAttrLowercase.indexOf('moz') !== -1;
var hasWebkitTransform = styleAttrLowercase.indexOf('webkit') !== -1; 
```

这样做你现在可以这样做：

```
var transformParts = [];

if (jj_input23 !== '') {
    transformParts.push('scale(' + jj_input23 + ')');
}

if (jj_input23 !== '') {
    transformParts.push('rotate(' + jj_input24 + 'deg)');
}
if (jj_input25 !== '' && jj_input26 !== '') {
    transformParts.push('translate(' + jj_input25 + 'px, ' + jj_input26 + 'px)');
}

if (jj_input27 !== '' && jj_input28 !== '') {
    transformParts.push('skewX(' + jj_input27 + 'deg) skewY(' + jj_input28 + 'deg)');
}
var transformTxt = transformParts.join(' ');

if (hasWebkitTransform) {    
    document.getElementById('jj_preview7').style.WebkitTransform = transformTxt;
}

if (hasMozTransform) {
    document.getElementById('jj_preview7').style.MozTransform = transformTxt;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T17:01:48.267

这是解决方案：http: [//jsfiddle.net/Adu49/1/](http://jsfiddle.net/Adu49/1/)

当您直接从输入中读取而不解析它时，您可能会生成 CSS 声明，例如：`scale() translate(deg,deg)`这显然是非法的。在这种情况下，Firefox 更愿意放弃它，而 Chrome 更愿意接受部分正确的声明。这就是为什么您的代码不能在 Firefox 上运行但在 Chrome 上运行的原因，并且在您填写所有字段后，它最终将在两种浏览器上运行。

So I placed some `value || default` in your code, which will guaranty a proper default value is set when the input box is empty (if you want to interact with user, you need more validation code here.)

And some off-topic here. Please change the way you naming variables and elements, it's too confusing.

# php - PHP的空格问题

> ID：10962515
> 
> 赞同：0
> 
> 时间：2012-06-09T16:10:30.080
> 
> 标签：php, fieldset, removing-whitespace

我正在接受来自另一个 .php 文件的预设输入

```
$Instructor=$_POST["Instructor"]; 
```

当我`echo $Instructor`，输出是`Dr. Doom`（这是正确的）

当我通过字段集传递它时，我只得到（Dr.）而不是（Doom）。我需要通过整个名称。任何人都可以帮忙。我是 PHP 新手，所以请尝试以简单的形式进行解释。非常感谢您提前。这是我正在使用的代码。

```
echo "<fieldset> 
 <Legend> Contact Information </Legend>
 PROFESSOR: <inputname='Professor' type= 'text' value=$Instructor maxlength='35' 
            disabled='disabled'> </fieldset>" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T16:17:33.193

由于您在 HTML 属性上省略了引号，因此您的 html 中只会解释第一个空格之前的字符。引用属性，并[`htmlentities()`](http://us3.php.net/manual/en/function.htmlentities.php)使用`ENT_QUOTES`选项正确转义它：

```
echo "<fieldset ... ... value='" . htmlentities($Instructor, ENT_QUOTES) . "' ... </fieldset>"; 
```

请注意，如果没有转义，除了可能破坏输出标记外，它还容易受到跨站点脚本的攻击。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T16:17:36.147

您需要在包含空格的属性值周围加上引号。在您的情况下，它们需要被转义，因为 PHP 字符串文字也使用它们：

```
echo "... value=\"$Instructor\" ..."; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T16:17:58.237

除了变量清理之外，你忘了引用这个：

```
value=$Instructor 
```

请注意这里的空间：

```
type= 'text' 
```

顺便说一句，如果你想使用 HTML 文本块， PHP 中有一个很好的语法叫做“ [heredoc ”。](http://onlamp.com/pub/a/php/2003/04/10/php_heredocs.html)

```
$str = <<<EOF
<fieldset> 
 <Legend> Contact Information </Legend>
 PROFESSOR: <inputname='Professor' type='text' value='$Instructor' maxlength='35' disabled='disabled'>
</fieldset>
EOF; 
```

好的是文本可以保持人类可读并且仍然支持内联变量插值（输入“$something like this”）

# javascript - 如何为表单域选择标签的值

> ID：10962516
> 
> 赞同：0
> 
> 时间：2012-06-09T16:10:41.197
> 
> 标签：javascript, jquery

我坚持这个。我想获取一个字段***的标签值，***以便在警报中使用它作为验证脚本的一部分。这是我的代码：

`onblur`（该函数在事件 ( `isFieldBlank(this)`)上被调用。

```
function isFieldBlank(that) {
    if($(that).val()=="") {
      var fieldLabel = $('label[for*="' + that + '"]).val();
      alert(fieldLabel);
      alert("You must provide a value for: ") + fieldLabel;
      $(that).addClass("error");
      $(that).focus();
      return false;
    } else {
        $(that).removeClass("error");       
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T16:16:42.673

用这个：

```
var fieldLabel = $('label[for*="' + $(that).attr('id') + '"]').text(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T16:11:22.100

```
var fieldLabel = $('label[for*="' + that + '"]).val(); 
```

应该

```
var fieldLabel = $('label[for*="' + that.id + '"]').text(); // here, .text() 
                                                           // not .val()
                                               //^--> missed a quote here 
```

`.val()`用于检索输入值。你需要在`.text()`这里使用。

并且您还需要转换`that`为`that.id`才能获得`id`.

阅读更多关于

*   **[。文本（）](http://api.jquery.com/text)**

*   **[.val()](http://api.jquery.com/val)**

# java - 使用 UDP 查询服务器？

> ID：10962518
> 
> 赞同：0
> 
> 时间：2012-06-09T16:10:55.373
> 
> 标签：java, multithreading, udp, netty, apache-mina

我要查询服务器（可以增加100左右）

我目前正在一个一个循环中迭代地查询它们，但这需要太多时间。

我在网上找到了 2-3 个选项，例如**MultiThreading** 、**Netty**等。

我应该选择哪一个？

这是算法->

一次向 100 台服务器发送 100 个 UDP 数据**包**

100 个服务器每个响应 1 个 UDP 数据包。（不再需要通信）

我需要处理那 1 个 UDP 数据包并将其存储在某处。（我的服务器应该同时接受多个数据包）

编辑： **游戏**服务器

# backbone.js - 从函数 CoffeeScript 返回一个值

> ID：10962520
> 
> 赞同：0
> 
> 时间：2012-06-09T16:11:05.430
> 
> 标签：backbone.js, coffeescript

我有代码：

```
 country: (origin) ->
    @geocoder = new google.maps.Geocoder
    @geocoder.geocode(
        'latLng': origin,
        (results, status) => 
            if status is google.maps.GeocoderStatus.OK
              return results[6]
            else alert("Geocode was not successful for the following reason: " + status);
    ) 
```

我在backbone.js 中称它为：

```
test = @country(origin)
console.log(test) 
```

作为测试，我正在使用 console.log。但是我得到一个：

```
undefined 
```

响应，因为国家功能没有返回任何东西。我知道 results[6] 里面有数据，因为我可以在那里做一个 conolse.log 并返回。

调用时如何使国家/地区函数返回结果[6]？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T16:16:25.023

我不知道 API*本身*，但它看起来像是异步的，这意味着您无法让函数返回值。相反，您必须传入一个继续函数，该函数在结果可用时对其进行处理。

```
country: (origin, handleResult) ->
    @geocoder = new google.maps.Geocoder
    @geocoder.geocode(
        'latLng': origin,
        (results, status) => 
            if status is google.maps.GeocoderStatus.OK
              handleResult(results[6])
            else alert("Geocode was not successful for the following reason: " + status);
    ) 
```

要使用它，只需制作一个知道如何处理结果的函数并将其传递给`country`函数：

```
obj.country origin, (result) ->
    alert 'Got #{result} from Google' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T16:23:56.130

在 CoffeeScript 中，函数中的最后一个表达式被返回，就像在 Ruby 中一样。

在这里，您返回您的结果`console.log`

```
typeof console.log("123")
> "undefined" 
```

我注意到有些人通过将一个单行`@`作为最后一行来避免这种情况，它只会返回`this`并避免一些尴尬的语法。

# c# - 检查 SFTP 远程服务器上是否存在文件

> ID：10962521
> 
> 赞同：3
> 
> 时间：2012-06-09T16:11:20.843
> 
> 标签：c#, sftp, sharpssh

下面的代码会将名为的文件`file.txt`从.`SFTP remote server``local machine`

```
 sftp.Get("/usr/mine/file.txt" , "C:/Folder/"); 
```

我想要做的是检查文件是否`file.txt`存在`remote server`。我该怎么做这个检查。帮助

我在用`SharpSSH`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T16:48:03.950

您可以考虑只接受小打击并尝试下载文件。如果它不存在，应该抛出一个异常，你可以抓住它并继续前进。检查文件是否存在是一个不稳定的情况，因此在大多数情况下，最好尝试执行您的操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-03T13:09:14.493

这应该可以解决问题。

```
 using (var sftp = new SftpClient(host, username, password))
        {
            try
            {

                sftp.Connect();
                MessageBox.Show(sftp.Exists(remoteDirectory).ToString());
            }
            catch (Exception Sftpex)
            {
                MessageBox.Show(Sftpex.ToString());
            }
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-01T02:26:39.783

我这样做是通过使用 .GetFileList 并将值读取到 ArrayList 中，然后循环遍历每个值，将文件名添加到列表框中。然后我根据列表框检查我的输入文件，看看它是否存在。下面的示例代码将 .GetFileList 值添加到 ArrayList 中，然后添加到列表框中。

顺便说一句 - 这是 VB.NET :)

```
Dim InputFileList As ArrayList = oSftp.GetFileList(frmOptions.tbFTPInboundFolder.Text)
 For Each f In InputFileList
                If f.ToString() <> "." AndAlso f.ToString <> ".." Then
                    frmMain.lbFTPInputDirectory.Items.Add(f)
                End If
            Next 
```

# arrays - 用于循环数组

> ID：10962523
> 
> 赞同：1
> 
> 时间：2012-06-09T16:11:29.077
> 
> 标签：arrays, bash, for-loop, whitespace

我正在尝试解决一个 bash 脚本的问题，该脚本旨在搜索 /Users/ 中的每个用户主目录并找到两个不同的目录，存储在数组“SUBDIRS”中。如果这些目录存在，我想使用递归和强制选项删除。如果它们不存在，我希望脚本继续寻找下一个目录、下一个主文件夹等。

```
#!/bin/sh

err=0

SUBDIRS=(
    "Library/Application Support/Spotify"
    "Library/Caches/com.spotify.client"
)

for HOMEDIR in /Users/*; do

    for SUBDIR in ${SUBDIRS}; do

        DIR="${HOMEDIR}/${SUBDIR}"

            if [[ -d "${DIR}" ]]; then
                rm -rf "${DIR}"
                echo "${HOMEDIR}/${SUBDIR} has been removed."
                APP=$(find "${HOMEDIR}" -name [sS]potify.app)
                rm -rf "${APP}"
            fi

    done

done

exit $err 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T16:15:07.783

您需要表明它是一个要扩展的数组（并引用它）。

```
for SUBDIR in "${SUBDIRS[@]}"; do 
```

`find`您应该在命令中引用该模式，以便`find`扩展它而不是 shell。

```
APP=$(find "${HOMEDIR}" -name '[sS]potify.app') 
```

# css - CSS 布局（1 个 div - 4 个从右侧浮动的 imgs）

> ID：10962525
> 
> 赞同：0
> 
> 时间：2012-06-09T16:11:37.210
> 
> 标签：css, layout, html, css-float

我正在处理第一个 div 应该包含文本的 css[布局](http://i.imgur.com/skrOI.png)，div 的宽度和高度应该根据内容灵活。右边应该有 4 个（将来可能更多）具有相同尺寸的图像，最好能适应第一个 div，但它们必须是正方形。现在我只有这样的[东西](http://snippets.etabled.com/css/layouts/1-4.html)。有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T16:21:33.633

使用浮点数怎么样？您将有两个容器`div`一个浮动。这些图像可以很容易地放在桌子上，因为它们都是相同的大小。如果您提前知道图像的宽度，您可以将第一个 div 预定义为该宽度和高度，这样如果布局变得太小，它就不会分解图像。

```
<div style="float:right;">
    <table>
        <tr>
            <td><img src="" /></td>
            <td><img src="" /></td>
        </tr>
        <tr>
            <td><img src="" /></td>
            <td><img src="" /></td>
        </tr>
    </table>
</div>
<div>
    <p>some text here</p>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T16:22:02.467

您可以使用以下 HTML：

```
​&lt;div id="wrapper">
    <div id="display">Some text</div>
    <div id="rightBar">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
    </div>
</div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

连同以下 CSS：

```
#wrapper {
    overflow: auto;
    background-color: yellow;
    display: inline-block
}

#display {
    width: 100px;
    height: 100%;
    float: left;
    border: 1px solid black;
}

#rightBar {
    width: 100px;
    background-color:red;
    float: left;
}

#rightBar div {
    border: 1px solid black;
    width: 40px;
    height: 40px;
    display: inline-block;
}​ 
```

[在此处](http://jsfiddle.net/WSZjA/)查看实时示例

# android - 如何启动一个新的Activity并发送参数？

> ID：10962529
> 
> 赞同：1
> 
> 时间：2012-06-09T16:12:19.753
> 
> 标签：android, android-activity

我想开始一项新活动并向她发送一个参数。并且根据已发送的内容，活动将以某种方式运行。（对不起，我的英语不好）选项取决于一个按钮。如果按下“option1”或“option2”，SettingsActivity 将相同，除了一些细节，所以我在“SettingsActivity”中发送了一个参数来分隔两种方式。

我有下一个：

```
option1.setOnClickListener(new View.OnClickListener() {
            public void onClick(View view) {
                Intent myIntent = new Intent(view.getContext(), SettingsActivity.class);
                startActivityForResult(myIntent, 0);
            }

        });
option2.setOnClickListener(new View.OnClickListener() {
            public void onClick(View view) {
                Intent myIntent = new Intent(view.getContext(), SettingsActivity.class);
                startActivityForResult(myIntent, 0);
            }

        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T16:31:48.957

要调用新活动，您可以通过以下代码执行此操作。意图可以调用新活动的地方。这里 xyz 是当前活动，xyz1 类是目标活动。

```
 Intent i = new Intent(xyz.this, zyz1.class);
 i.putExtra("post", 2);
 startActivity(i); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T16:17:09.127

在 settingsActivity 中使用 `.putExtra("Name", name);`and 使用这个：`getIntent().getExtras().getString("Name");`

`.putExtra("Name", name);`- “名称”有点像临时 id，第二个值是您的字符串。

要使用它`getIntent().getExtras().getString("Name");`，请使用类似的东西

`String name = getIntent().getExtras().getString("Name");`在 SettingsActivity

# java - JMS ActiveMQ 队列已存在

> ID：10962530
> 
> 赞同：2
> 
> 时间：2012-06-09T16:12:31.173
> 
> 标签：java, spring, activemq

我有一个独立的 java 应用程序，它使用我的 spring 配置中的 spring-jms 标签来启动几个 JMS 使用者：

```
ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext("applicationContext.xml"); 
```

以下是 bean 定义的样子：

```
<bean id="fooConnectionFactory" class="org.apache.activemq.ActiveMQConnectionFactory">
    <property name="brokerURL" value="${foo_broker_url}" />
</bean>

<jms:listener-container connection-factory="fooConnectionFactory" acknowledge="client" client-id="fooService">
    <jms:listener destination="${foo_queue_name}" ref="fooListener" selector="${foo_selector}" />
</jms:listener-container>
... 
```

我计划编写一个 Windows 批处理文件来启动消费者，以及一个单独的批处理文件来关闭它（目前我一直在使用命令行启动它）。

我的问题有两个方面：
1\. 关闭批处理文件实际上是如何关闭连接的？
2\. 如果在队列已经连接的情况下执行启动批处理文件，我不希望应用程序创建第二个连接。任何想法如何防止这种情况？

关于问题 2：我知道尝试向队列发送消息并等待响应或失败可能会奏效，但这似乎有点矫枉过正，必须有更好的方法。我在 javax.jms.Connection 类的 API 文档中读到了这个：

“如果在调用此方法时具有相同 clientID 的另一个连接已经在运行，则 JMS 提供程序应该检测到重复的 ID 并抛出 InvalidClientIDException。”

但是，在侦听器容器上指定 clientID（请参阅上面的 bean 定义）似乎不会阻止第二个连接。

## 更新

我已经确定最简单的解决方案可能是将此应用程序作为 Tomcat 下的 webapp 运行。但是，我将保留这个问题，希望有人能为所提出的任何一个问题提供可行的解决方案。

第一个问题可以改写/澄清如下：如何通过执行单独的应用程序/脚本来终止正在运行的应用程序/线程？

第二个问题可以通过询问来详细说明：是否有一条与 JMS 生产者连接到队列相关的数据可以使其唯一？基于这个独特的数据，是否可以确定“这个”连接已经存在？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T21:19:52.733

我已经确定处理这些问题的最简单方法是将我的独立应用程序转换为 web 应用程序并部署在 Tomcat 下。通过这种方式，我将能够更轻松地管理启动/停止应用程序，并且我将能够确保在给定时间只有一个应用程序实例在运行。

我将继续关注这个问题，因此请随时发布您自己的解决方案，我愿意将已接受的答案更改为您的答案！

# objective-c - 在 sqlite 数据库中插入空值

> ID：10962532
> 
> 赞同：0
> 
> 时间：2012-06-09T16:12:51.313
> 
> 标签：objective-c, ios5, sqlite, xcode4.2, xcode4.3

我正在使用一个应用程序从用户那里获取字符串并将其保存到数据库中。一遍又一遍地检查代码后，字符串没有进入数据库。例如，如果我添加一个像“abc”这样的字符串，我会收到消息 STRING ADDED 但是在 sqlite manager 中打开数据库时，会插入 null 来代替 abc。谁能指导我？我正在使用 xcode 4.2 并为 iPhone 开发。

# mobile - 分析服务，告诉用户在应用程序中做了什么

> ID：10962538
> 
> 赞同：0
> 
> 时间：2012-06-09T16:14:12.217
> 
> 标签：mobile, analytics

我了解 Flurry 提供的分析包括：用户留存、每日用户、平均活跃会话时间等。但我可以使用它或其他服务来告诉我有多少用户点击了某个按钮，用户在特定视图上花费了多少时间ETC？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:53:17.160

是的你可以。Localytics（我在那里工作）、Flurry 和其他应用程序分析服务支持记录完全符合您描述的“事件”。这些事件还具有“属性”，您可以使用这些“属性”来跟踪其他详细信息，例如时间（我们通常建议分桶——即 0-5 秒、6-10 部分等）。这是我们集成文档的链接：[http ://www.localytics.com/docs/iphone-integration/](http://www.localytics.com/docs/iphone-integration/)

您可能还想跟踪屏幕，然后将事件和屏幕组合成转化漏斗。

# metaprogramming - D 对于这些功能是否足够强大？

> ID：10962541
> 
> 赞同：5
> 
> 时间：2012-06-09T16:14:38.873
> 
> 标签：metaprogramming, d

很长一段时间以来，我一直想设计一种将可扩展性与效率（以及安全性、易用性等）结合起来的编程语言。我最近重新发现了 D，我想知道 D 2.0 是不是我想自己制作的语言. 我最喜欢的是元编程的潜力；理论上，D 的[特征](http://dlang.org/traits.html)系统可以在编译时启用以下功能吗？

1.  运行时反射：编译时反射特性是否足以构建像 Java/.NET 那样的运行时反射系统？

2.  代码转换：使用元程序，创建 C#/C++/等。每次编译 D 程序时的版本（如果可以传播 doc 注释，则加分）。

3.  性状。我不是指D 中内置的[元编程特征，我指](http://dlang.org/traits.html)[的是类组合的面向对象特征](http://en.wikipedia.org/wiki/Trait_%28computer_programming%29)。AD 程序将指示要组合的一组特征，而元程序将组合它们。

4.  单元推理引擎：给定一些可选指示单元的符号，例如`unit(value)`，D 元程序是否可以检查以下代码，推断正确的单元，并在最后一行发出错误消息？（我为[boo](http://boo.codehaus.org/)写了这样一个东西，所以我可以向你保证，这通常是可能的，在整个程序范围内）：

    ```
    auto mass = kg(2.0);
    auto accel = 1.0;                      // units are strictly optional
    auto force = mass*accel;
    accel += metresPerSecondSquared(9.81); // units of 'force' and 'accel' are now known
    force += pounds(3.0);                  // unit mismatch detected 
    ```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-09T17:07:20.520

> 运行时反射：编译时反射特性是否足以构建像 Java/.NET 那样的运行时反射系统？

是的。您可以使用[__traits](http://dlang.org/traits.html)在编译时获取所需的所有信息，并生成运行时反射所需的运行时数据结构。

> 代码转换：使用元程序，创建 C#/C++/等。每次编译 D 程序时的版本（如果可以传播 doc 注释，则加分）。

不，无论D多么强大，这根本不可能。有些功能根本不会转移。例如，D 有一个内联汇编器，它 100% 不可能转换为 C#。没有一种语言可以无损地转换为所有其他语言。

> 性状。我不是指 D 中内置的元编程特征，我指的是用于类组合的面向对象的特征。AD 程序将指示要组合的一组特征，而元程序将组合它们。

您可以为此使用[模板混合](http://dlang.org/template-mixin.html)，尽管它们不提供方法排除。

> 单位推理引擎：给定一些可选地指示单位的符号，例如单位（值），D 元程序是否可以检查以下代码，推断正确的单位，并在最后一行发出错误消息？（我为 boo 写了这样一个东西，所以我可以向你保证，这通常是可能的，在整个程序范围内）：

是的，这在 D 中很简单。[至少已经有一种实现](http://www.dsource.org/projects/scrapple/browser/trunk/units/si2.d)了。

# git - Visual Studio 2010 git 扩展管理无法连接的遥控器

> ID：10962544
> 
> 赞同：5
> 
> 时间：2012-06-09T16:15:33.417
> 
> 标签：git, github, git-extensions, git-remote

我很确定我犯了一个小错误。我正在使用 Git Source Control Provider for VS 2010 和 Git Extension UI。我对 git 概念完全陌生，我通过 UI 做所有事情，而不是使用命令提示符。

我创建了一个存储库，然后创建了一个私钥和公钥。然后我使用私钥配置了 repo 的遥控器（Public 已添加到我在 GitHub 上的帐户中）。这一切都很好，因为我能够推送我的本地回购。为了配置远程，我在 VS 中使用了 Git 扩展（Git -> 管理远程）。

然后我创建了另一个仓库并尝试使用相同的私钥再次配置遥控器，但失败并显示错误“无法打开连接：主机不存在”。我创建了另一个私钥/公钥对，但它再次失败并显示相同的消息。

我究竟做错了什么？任何人？提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-10T05:33:31.467

正如我所说，这一定是一个微不足道的错误。我试图使用 HTTPS url 而不是 SSH url 推送新的本地 repo。我使用了 SSH url，现在一切都很酷。

# deployment - Windows 8 模拟器命令行界面

> ID：10962548
> 
> 赞同：5
> 
> 时间：2012-06-09T16:16:30.620
> 
> 标签：deployment, windows-8, windows-runtime, microsoft-metro

我知道`VS2012`能够直接从编辑器中启动 Windows 模拟器。
我想要/需要的是能够“告诉模拟器”启动一个特定的应用程序。假设我有一个以前编译的（Metro）应用程序，它可能是 C# 或 HTML，我想告诉模拟器启动并运行我的特定应用程序。那可能吗？

假设我也在 Windows 7 中，我想尝试一下。我知道我不能在 Win7 机器上这样做，所以我想我会通过 Remote Destop 连接到 Windows8 VM，然后在那里启动模拟器以查看我的应用程序是如何工作的，或者如前所述，用我的应用程序启动模拟器。

那么这一切都可能吗？我该怎么做？有没有人能想到一个更好的主意来实现这一目标？说 powershell 将我的应用程序发送到 Win8 机器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T02:45:28.620

您可以在...找到模拟器可执行文件

```
C:\Program Files (x86)\Common Files\Microsoft Shared\Windows Simulator\11.0 
```

但是，使用 ILSpy 查看 Windows.Simulator.exe，似乎它寻找的唯一启动命令是 /Minimized。如果您查看 OnStartup，它包含代码...

```
if (App.ParseStartAsMinimized(e.Args))
{
    window.WindowState = WindowState.Minimized;
} 
```

这是我唯一能找到的。我也没有找到它试图访问其配置文件的地方。但是，它确实引用了 System.Configuration，因此可能需要进行一些额外的侦探工作。

# ios - 当在 UIView 上按下另一个 UIButton 时，从实例变量中的 UITextField 捕获文本

> ID：10962551
> 
> 赞同：0
> 
> 时间：2012-06-09T16:16:53.340
> 
> 标签：ios, uitextfield, uitextfielddelegate

我的 UIView 上有几个 UITextFields（在 UITableViewCells 内），带有“保存”UIButton。当用户单击“保存”按钮时，我想对 UITextFields 进行一些基本验证。

我已经覆盖了 textFieldDidEndEditing 以将我的每个 UITextField 数据保存到一个实例变量中；但是，如果用户在单击 UIKeyboard 的“返回”按钮或单击另一个 UITextField 之前单击保存按钮，则我最后一个 UITextField 中的数据永远不会保存到我的实例变量中，并且验证总是失败。

我正在寻找一种方法来触发“onBlur”（我知道那是 JS 的事情）类型的事件，以将 UITextField 中的字符串保存到我的实例变量中。

我查看了 UITextFieldDelegate 协议，但没有看到类似的内容。

有没有我可能会错过的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T16:25:20.200

要触发`textFieldDidEndEditing`你的`UITextField`，你需要打电话

```
[_txt resignFirstResponder]; 
```

是`_txt`你的`UITextField`

请注意，如果您没有对 _txt 的引用并且您需要找到第一响应者以便辞职您可以使用此问题中的解决方案[Get the current first responder without using a private API](https://stackoverflow.com/questions/1823317/how-do-i-legally-get-the-current-first-responder-on-the-screen-on-an-iphone)

然后而不是打电话

```
[_txt resignFirstResponder]; 
```

你会打电话给

```
[self.view findAndResignFirstResponder]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T10:14:15.730

试试这个 // 如果我们遇到换行符返回

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{   
    // enter closes the keyboard
    if ([string isEqualToString:@"\n"])
    {
        [textField resignFirstResponder];
        return NO;
    }
    return YES;
} 
```

这将触发

```
- (BOOL)textFieldShouldEndEditing:(UITextField *)textField
{
    [textField resignFirstResponder];
    // Call webservice
    return YES;
} 
```

# phpunit - Phpunit 3.6 找不到单元测试

> ID：10962560
> 
> 赞同：0
> 
> 时间：2012-06-09T16:17:48.637
> 
> 标签：phpunit

我得到无法打开文件“FooTest.php”

我在 Windows 上使用 PHP 5.4.0 和 PHPUnit 3.6

当它调用包含“。”的 get_include_path 时，我已将问题追溯到 PHPUnit\Util\Filesystem.php。和梨的位置。

由于某种原因，它没有解决。到测试所在的位置，因为它将本地解析到 PHPUnit 位置。

如何让 phpunit 识别测试的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T09:53:53.120

首先还要确保您的 PHPUnit 安装和所有依赖项都是最新的：

```
pear upgrade phpunit/PHPUnit --alldeps 
```

如果您的 pear 安装出错，您也可以从[github 存储库](https://github.com/sebastianbergmann/phpunit)中获取它。

根据您的项目和环境的设置方式，确保您的当前目录是您的项目目录。

```
cd /your/projects/home/directory/ 
```

调用 phpunit 的常用语法是

```
phpunit [switches] <your_unit_test.php> 
```

或者

```
phpunit [switches] <directory> 
```

因此，基本上，如果您的测试存储在目录`YourUnitTests`中，最简单的启动方法就是使用

```
phpunit YourUnitTests 
```

# java - DOM 的子元素

> ID：10962568
> 
> 赞同：3
> 
> 时间：2012-06-09T16:19:16.723
> 
> 标签：java, dom, xml-parsing

我有这个 XML 文件：

```
<scene>
    <texture file="file1.dds"/>
    <texture file="file2.dds"/>
    ...
    <node name="cube">
        <texture name="stone" unit="0" sampler="anisotropic"/>
    </node>
</scene> 
```

我需要名为“纹理”的“场景”的所有子元素，但使用以下代码：

```
Element rootNode = document.getDocumentElement();

NodeList childNodes = rootNode.getElementsByTagName("texture");
for (int nodeIx = 0; nodeIx < childNodes.getLength(); nodeIx++) {
    Node node = childNodes.item(nodeIx);

    if (node.getNodeType() == Node.ELEMENT_NODE) {
        // cool stuff here    
    }
} 
```

我还得到了“节点”内的“纹理”元素。

我怎样才能过滤掉这些？或者我怎样才能只获得“场景”的直接子元素？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T16:21:20.220

您可以使用[Xpath](http://www.w3schools.com/xpath/default.asp)执行此操作，请考虑取自[JAXP 规范 1.4](http://www.jcp.org/en/jsr/detail?id=206)的以下示例（我建议您对此进行咨询）：

```
// parse the XML as a W3C Document
DocumentBuilder builder = DocumentBuilderFactory.newInstance().newDocumentBuilder();
org.w3c.Document document = builder.parse(new File("/widgets.xml"));
// evaluate the XPath expression against the Document
XPath xpath = XPathFactory.newInstance().newXPath();
String expression = "/widgets/widget[@name='a']/@quantity";
Double quantity = (Double) xpath.evaluate(expression, document, XPathConstants.NUMBER); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T22:52:06.853

我发现自己的解决方案可以正常工作：

```
Element parent = ... ;

String childName = "texture";
NodeList childs = parent.getChildNodes();

for (int nodeIx = 0; nodeIx < childs.getLength(); nodeIx++) {
    Node node = childs.item(nodeIx);

    if (node.getNodeType() == Node.ELEMENT_NODE 
            && node.getNodeName().equals(name)) {
        // cool stuff here
    }
} 
```

# matlab - 获取griddata形成的凸包

> ID：10962576
> 
> 赞同：0
> 
> 时间：2012-06-09T16:20:58.470
> 
> 标签：matlab

是否有可能得到由表示凸包的网格数据形成的函数 f(x,y)。实际上，我想获得 griddata 用来插值特定点的点（单纯形点）。我的意思不是 griddata 只是给我最终结果，是否有可能获得中间值。

我发现它使用 delaunay 三角剖分来形成凸包。可以通过matlab的delaunay函数给出。那么我怎样才能得到我的插值点所属的单纯形呢？

是否可以在 matlab 中获取 griddata 函数的源代码以便进行更改？

# macos - 使用 CoreAnimation “折叠”一个 NSWindow

> ID：10962581
> 
> 赞同：5
> 
> 时间：2012-06-09T16:21:29.123
> 
> 标签：macos, core-animation, nswindow, transformation, appkit

所以我对 AppKit 和 Cocoa（来自带有 CocoaTouch 的 UIKit）相当陌生，我目前正在实现一个折叠 NSWindow 的界面。在 iOS 上，这将相当容易，但看到 OS XI 选择询问的许多微小差异如何。

您将如何实施以下过渡？

![窗口折叠](../Images/896b22403584eca2ccee2493a5b0e74f.png)

*注意*：底栏是我的 contentView 的一部分，而不是 OS X 提供的底栏。即我的窗口（顺便说一下INAppStoreWindow）由一个titleBar 和一个contentView 组成。

我想我可以只折叠 contentView 并同步调整窗口大小，但如果我能够在折叠时保持透明度，这是由于透视变换而发生的。即向内弯曲的侧面应该（在过渡期间）是透明的。还是我想多了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:49:16.707

首先是坏消息：与 UIKit 不同，AppKit 不使用 Core Animation 来呈现其控件。所有的 CALayer 都在 NSView 的特殊层托管实例中居住在他们自己的世界中。因此，除非您的窗口的内容视图是图层托管的，否则您不能在没有相当程度的黑客攻击的情况下将 CAAnimations 应用于整个窗口的内容（可能会将整个内容视图呈现为位图，将其设置为图层的内容，并对其执行转换。我不确定）。

希望您的内容视图是基于核心动画的。如果是这样，您描述的方法应该有效。您还应该能够将图层托管在透明的无边框 NSWindow 中，然后您对内容视图所做的任何转换都会显示其后面的桌面。这是一个应该做你想做的事情的片段（来自 Matt Long）：

```
 - (id) initWithContentRect: (NSRect) contentRect
                 styleMask: (unsigned int) aStyle
                   backing: (NSBackingStoreType) bufferingType
                     defer: (BOOL) flag
{
    if (![super initWithContentRect: contentRect 
                             styleMask: NSBorderlessWindowMask 
                          backing: bufferingType 
                         defer: flag]) return nil;
    [self setBackgroundColor: [NSColor clearColor]];
    [self setOpaque:NO];

    return self;
} 
```

# java - Android：如何关闭从类返回到活动的游标

> ID：10962585
> 
> 赞同：0
> 
> 时间：2012-06-09T16:22:35.583
> 
> 标签：java, android, database, sqlite, cursor

我有：Accounts.java

```
public class Accounts{

    private SQLiteDatabase dbConfig;

public Cursor list(Context context, String db, String where, String order) {

    DBHelper dbHelper = new DBHelper(context, db);
    dbConfig = dbHelper.getReadableDatabase();

    Cursor c = dbConfig.query("accounts", new String[]{ "iId","sName"}, where, null, null, null, order);
    return c;   
    }
} 
```

和：MainActivity.java

```
Accounts account = new Accounts();
Cursor cursor =  account.list(getApplicationContext(), globalDB, null, null);
while (cursor.moveToNext()) { 
     int id = cursor.getInt(0);
     String name = cursor.getString(1);
}
cursor.close(); 
```

运行我的应用程序，我收到一些 logcat 消息，例如：

```
close() was never explicitly called on database... 
```

预防它的最佳方法是什么？如何关闭从其他类返回的光标？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T16:51:15.977

退出后`account.list()`，底层数据库连接仍处于打开状态，但没有对它的剩余引用。所以，它已经泄露了。

您可以在完成后关闭数据库，或者您可以在应用程序的整个生命周期内保持打开状态，方法是使用您打开一次的单个全局数据库连接，在所有活动中共享，并且永不关闭。

我推荐后一种方法。它产生了更简单的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T16:35:50.537

而不是调用`cursor.close();`，您可以调用并创建一个`Accounts.close()`关闭游标和数据库的方法

# windows - 创建转储文件，复制错误（截屏）并在应用程序崩溃后重新启动

> ID：10962589
> 
> 赞同：0
> 
> 时间：2012-06-09T16:23:48.033
> 
> 标签：windows, perl, error-handling, batch-file, dump

我正在压力测试中测试应用程序。
这就是为什么如果发生错误（打开错误窗口）或者它挂起或崩溃，我需要重新启动它。同时，我需要收集有关导致重新启动的问题的所有有用信息：制作转储文件并从错误窗口复制错误文本（和/或截取其屏幕截图）。

使用 bash 很简单：[在 OSX 崩溃时自动重新启动程序](https://stackoverflow.com/questions/7247543/restarting-program-automatically-on-crash-in-osx)（没有屏幕截图或转储，但错误窗口保留在 MacOS 上，因此实际上不需要它们）。但是，我需要此功能才能在 Win (XP/Vista/7) 上运行。

我可以使用[特殊的监控工具](http://alternativeto.net/software/restarter/)进行重启，但那样我会依赖非标准程序。我可以在 XP 上使用[用户模式进程转储程序](http://www.microsoft.com/en-us/download/details.aspx?id=4060)，但它不适用于 Vista。

是否有任何优雅和通用的方式（批处理文件或 perl 脚本会很棒）来为所有版本的 Windows 实现所描述的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T16:46:02.077

关于问题的第一^(部分)，您可以使用[`tasklist`](http://technet.microsoft.com/en-us/library/bb491010.aspx).
这将运行`myapp.exe`，必要时重新启动它：

```
 @echo off
    set MYAPP=myapp.exe

    rem # Loop infinitely and restart the application if it's not running
:Start
    tasklist /FI "IMAGENAME eq %MYAPP%" 2>NUL | find /I /N "%MYAPP%" >NUL
    if errorlevel 1 %MYAPP%
    call :Sleep 1
    goto Start

    rem # A short sleep subroutine to yield system resources
:Sleep
    ping 127.0.0.1 -n %1 -w 1000 > nul 
```

关于问题的^(第二)部分，您可以使用[AutoDumpPlus](http://support.microsoft.com/kb/286350)收集用户模式核心转储。
例如：

```
 adplus -crash -quiet -pn myapp.exe -o C:\temp 
```

这将运行 ADPlus，监控所有名为 的进程`myapp.exe`，并在检测到崩溃时在输出目录中生成核心转储`C:\temp`（当然，可以更改）。

我还没有整体测试过这个设置，但我希望它对你有用！

# ruby-on-rails - 我应该在哪里放置对我的 rails 应用程序中的模型执行统计分析的代码？

> ID：10962593
> 
> 赞同：0
> 
> 时间：2012-06-09T16:24:04.130
> 
> 标签：ruby-on-rails, ruby-on-rails-3, model-view-controller

在我的控制器中，我需要生成将绘制图表的数据。为了获取这些数据，我需要执行查询和处理返回的数据。现在我在 StatsHelper 模块中有一个 Stats 类，但我意识到这是不正确的。Stats 类用于多个控制器并处理多个模型，尽管主要关注一个模型。这个逻辑应该去哪里？

我倾向于将它放在 Stats 命名空间中自己的模型中，但与模型中的其他模型一起工作似乎很奇怪。我不想把它放在一个库中，因为它绝对是特定于应用程序的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T20:07:34.100

我将创建一个单独的 Stats 类，以保持代码在逻辑上分离，并且在未来易于识别和返工（而不是将它与其他代码逻辑混合在一起）。

在您正在执行统计数据的课程中，即。object.some_stat，我会定义将调用 Stats 类的特定方法。如果您有许多模型要对其执行统计信息，那么我将在一个模块中定义所有这些方法，然后将该模块包含在我要对其使用统计信息的每个类中。我发现这可以保持代码非常干净。

最简单的方法是创建您的 Stat 模块，并在其中包含您想要方法的每个类。

```
module Stat
  def sum
  ..
  end
end

class Something
  include Stat
end 
```

# azure - 我如何知道带有 azure 网站的主机服务器机器类型？

> ID：10962596
> 
> 赞同：0
> 
> 时间：2012-06-09T16:24:40.617
> 
> 标签：azure

当我在网站上部署 umbraco cms 站点时，我认为它将在 Windows 机器上运行，因为它是 asp.net。但是，如果我部署 wordpress 或 joomla，它是否在 Linux 上运行？

我如何知道我的主机服务器是 windows 还是 linux？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T16:31:58.713

Windows Azure 网站托管在 Windows 操作系统上。Windows Azure 网站运行在一个巨大的服务器场中，该服务器场基于 Windows Server 操作系统，您的内容转到一个名为“内容共享”的位置。您网站的所有实例都从单个共享中获取内容并在 Windows Server 操作系统场中运行。

不管您使用的是 Wordpress、Joomla 还是 Umbraco。如果您选择创建 Windows Azure 网站，那么它将托管在带有 IIS 的 Windows 操作系统上，W3WP 可能会成为托管您网站的主机进程。Windows Azure 网站的设计方式让您无需关注正在运行的操作系统，而是完全专注于您的应用程序开发并保持其运行。

仅当您选择创建 Windows Azure 虚拟机并为其部署基于 Linux 操作系统的 VHD 时，您的主机服务器才会是**Linux 。**

# java - 如何将对象放置在 JFrame 上的特定位置（x，y）？

> ID：10962597
> 
> 赞同：6
> 
> 时间：2012-06-09T16:25:14.330
> 
> 标签：java, swing, user-interface, jframe

如何将对象放置在 JFrame 上的特定位置 (x,y)？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-09T16:27:37.467

在这里找到[绝对定位教程](http://docs.oracle.com/javase/tutorial/uiswing/layout/none.html)。请仔细阅读，为什么不鼓励使用[LayoutManagers这种方法](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)

要将 JButton 添加到您的 JPanel，您可以使用以下命令：

```
JButton button = new JButton("Click Me");
button.setBounds(5, 5, 50, 30);
panel.add(button); 
```

在这里尝试这个示例程序：

```
import java.awt.*;
import javax.swing.*;

public class AbsoluteLayoutExample
{
    private void displayGUI()
    {
        JFrame frame = new JFrame("Absolute Layout Example");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JPanel contentPane = new JPanel();
        contentPane.setOpaque(true);
        contentPane.setBackground(Color.WHITE);
        contentPane.setLayout(null);

        JLabel label = new JLabel(
            "This JPanel uses Absolute Positioning"
                                    , JLabel.CENTER);
        label.setSize(300, 30);
        label.setLocation(5, 5);

        JButton button = new JButton("USELESS");
        button.setSize(100, 30);
        button.setLocation(95, 45);

        contentPane.add(label);
        contentPane.add(button);

        frame.setContentPane(contentPane);
        frame.setSize(310, 125);
        frame.setLocationByPlatform(true);
        frame.setVisible(true);
    }

    public static void main(String... args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                new AbsoluteLayoutExample().displayGUI();
            }
        });
    }
} 
```

![绝对定位输出](../Images/342edeacae1f9201e385124a1a7d3ce6.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-09T17:08:35.817

试试这2个……结合起来……

`setLocation()`和`setBounds()`

使用NetBeans团队2005年开发的GroupLayout就更好了。WindowsBuilder Pro是Java构建GUI的好工具

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-09T16:32:37.060

在继承框架的类中：

```
setLayout(null); 
```

在您的组件中：

```
setLocation(x,y); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-09T16:29:43.823

查看此绝对布局代码示例：

[绝对布局演示](http://www.java2s.com/Code/Java/Swing-JFC/AbsoluteLayoutDemo.htm)

# facebook - 在隐私方面，是否可以从 Facebook 分享响应中提取用户 ID 以使用该用户的详细信息？

> ID：10962600
> 
> 赞同：0
> 
> 时间：2012-06-09T16:25:28.613
> 
> 标签：facebook, api, privacy

使用 Facebook API，您可以取回 Facebook 分享的帖子 ID，即使用户尚未授权您的应用程序。

帖子 ID 以您的用户 ID 为前缀，并用下划线分隔。

```
FB.ui({
    method: 'feed',
    name: 'People Argue Just to Win',
    link: 'http://www.nytimes.com/2011/...',
}, function( response ){
    // Response gives you :
    // { post_id: "[fbUserId]_346759642059572" }
}); 
```

在我看来，Facebook 似乎是在以编程方式使用它，而不是出于善意向我们提供 userId 的想法。但是使用起来非常诱人。

我对权限有点生疏——如果有办法找回所有喜欢/分享了特定 URL 的用户，而不仅仅是计数，那么这应该没问题。

但问题仍然存在，可以接受吗？

**编辑：**

现在我想了想，您可以通过匿名调用访问用户 ID，`https://graph.facebook.com/[postId]`但前提是该帖子已公开。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T19:34:18.210

如果您收到来自 FB 的回复，则意味着您已经向用户请求了所需的权限，
所以是的，您可以随意使用从 Facebook 返回的数据，但您始终必须告知用户您如何使用这些数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T19:33:42.793

只有在您有权限或应用程序功能所必需的情况下，您才能缓存用户数据。使用like 按钮，您可以订阅edge.create 并缓存来自like 的响应。

参考：http: [//developers.facebook.com/docs/reference/javascript/FB.Event.subscribe/](http://developers.facebook.com/docs/reference/javascript/FB.Event.subscribe/)

> 二、存储和使用您从我们这里收到的数据
> 
> 您只会请求操作应用程序所需的数据。您可以缓存通过使用 Facebook API 接收到的数据，以改善您的应用程序的用户体验，但您应该尽量使数据保持最新。此许可不授予您对此类数据的任何权利。

在我的应用程序中，我存储查看的每个页面或用户的 ID，以加快页面加载时间并计算页面浏览量。只要我不与第 3 方共享信息或公开用户设置为非公开的内容，似乎在政策范围内。

# android - 无法在 ScrollView 中调整 RelativeLayout 的大小以填充整个屏幕

> ID：10962602
> 
> 赞同：49
> 
> 时间：2012-06-09T16:25:49.980
> 
> 标签：android, android-layout, android-scrollview, android-relativelayout

我有一个奇怪的问题，我不知道如何解决。我在 ScrollView 中有一个 RelativeLayout，这个 scrollView 的高度设置为 fill_parent。相对布局也是如此。尽管如此，内容并没有填满整个屏幕，它只会出现在这个 RelativeLayout 中最后一个布局的 wrap_content 中。

这是我的代码：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res/com.pontai"
    android:id="@+id/relativeLayout1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <ScrollView
        android:layout_width="match_parent"
        android:layout_height="match_parent" >

        <RelativeLayout
            android:id="@+id/relativeLayout2"
            android:layout_width="match_parent"
            android:layout_height="match_parent" >

            <LinearLayout
                android:id="@+id/linearLayout1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignLeft="@+id/relativeLayout3"
                android:layout_alignParentTop="true"
                android:layout_alignRight="@+id/relativeLayout5"
                android:layout_marginTop="5dp"
                android:orientation="horizontal" >

                <TextView
                    android:id="@+id/textView1"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:text="How much points you have here:"
                    android:textAppearance="?android:attr/textAppearanceSmall" />

                <TextView
                    android:id="@+id/textViewTotalPoints1"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:text="120"
                    android:textAppearance="?android:attr/textAppearanceMedium" />
            </LinearLayout>

            <RelativeLayout
                android:id="@+id/relativeLayout4"
                android:layout_width="wrap_content"
                android:layout_height="80dp"
                android:layout_alignLeft="@+id/relativeLayout3"
                android:layout_below="@+id/linearLayout1"
                android:layout_marginTop="5dp"
                android:layout_toLeftOf="@+id/textView7"
                android:orientation="vertical" >

                <TextView
                    android:id="@+id/textView3"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_alignParentTop="true"
                    android:layout_centerHorizontal="true"
                    android:layout_marginTop="5dp"
                    android:text="Ratings"
                    android:textAppearance="?android:attr/textAppearanceMedium" />

                <TextView
                    android:id="@+id/textViewPositivePoints"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_centerHorizontal="true"
                    android:textAppearance="?android:attr/textAppearanceSmall" />

                <ImageView
                    android:id="@+id/imageView2"
                    android:layout_width="25dp"
                    android:layout_height="25dp"
                    android:layout_below="@+id/textView3"
                    android:layout_toLeftOf="@+id/textView3"
                    android:src="@drawable/thumbs_up_focused" />

                <TextView
                    android:id="@+id/textViewNegativePoints"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_alignRight="@+id/textView3"
                    android:layout_centerVertical="true"
                    android:layout_marginRight="3dp"
                    android:text="22"
                    android:textAppearance="?android:attr/textAppearanceSmall" />

                <TextView
                    android:id="@+id/textView5"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_alignBaseline="@+id/textViewNegativePoints"
                    android:layout_alignBottom="@+id/textViewNegativePoints"
                    android:layout_alignLeft="@+id/textView3"
                    android:layout_marginLeft="3dp"
                    android:text="33"
                    android:textAppearance="?android:attr/textAppearanceSmall" />

                <ImageView
                    android:id="@+id/imageView3"
                    android:layout_width="25dp"
                    android:layout_height="25dp"
                    android:layout_alignTop="@+id/imageView2"
                    android:layout_toRightOf="@+id/textViewNegativePoints"
                    android:src="@drawable/thumbs_down_focused" />
            </RelativeLayout>

            <RelativeLayout
                android:id="@+id/relativeLayout5"
                android:layout_width="95dp"
                android:layout_height="80dp"
                android:layout_alignRight="@+id/relativeLayout3"
                android:layout_alignTop="@+id/relativeLayout4"
                android:layout_toRightOf="@+id/textView7"
                android:orientation="vertical" >

                <TextView
                    android:id="@+id/textView4"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_alignParentTop="true"
                    android:layout_centerHorizontal="true"
                    android:layout_marginTop="5dp"
                    android:text="Comments"
                    android:textAppearance="?android:attr/textAppearanceMedium" />

                <ImageView
                    android:id="@+id/imageView1"
                    android:layout_width="50dp"
                    android:layout_height="50dp"
                    android:layout_alignParentBottom="true"
                    android:layout_centerHorizontal="true"
                    android:src="@drawable/speech_bubble" />
            </RelativeLayout>

            <RelativeLayout
                android:id="@+id/relativeLayout3"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_below="@+id/relativeLayout4"
                android:layout_centerHorizontal="true"
                android:layout_marginLeft="10dp"
                android:layout_marginRight="10dp"
                android:layout_marginTop="10dp" >

                <TextView
                    android:id="@+id/textViewOfferName"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_alignParentTop="true"
                    android:layout_centerHorizontal="true"
                    android:layout_marginTop="10dp"
                    android:text="Offer Name"
                    android:textAppearance="?android:attr/textAppearanceLarge" />

                <TextView
                    android:id="@+id/textViewBusinessName"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_alignParentTop="true"
                    android:layout_centerHorizontal="true"
                    android:layout_marginTop="35dp"
                    android:text="Business Name"
                    android:textAppearance="?android:attr/textAppearanceMedium" />

                <TextView
                    android:id="@+id/textViewBusinessAddress"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_alignParentTop="true"
                    android:layout_centerHorizontal="true"
                    android:layout_marginTop="60dp"
                    android:text="Business Address"
                    android:textAppearance="?android:attr/textAppearanceMedium" />

                <TextView
                    android:id="@+id/textViewNull1"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_alignParentTop="true"
                    android:layout_centerHorizontal="true"
                    android:layout_marginTop="80dp"
                    android:textAppearance="?android:attr/textAppearanceLarge" />

                <TextView
                    android:id="@+id/textViewTotalPoints"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_below="@+id/textViewNull1"
                    android:layout_centerHorizontal="true"
                    android:text="0/0"
                    android:textAppearance="?android:attr/textAppearanceLarge" />

                <Button
                    android:id="@+id/buttonUseNow"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_below="@+id/textViewTotalPoints"
                    android:layout_centerHorizontal="true"
                    android:layout_marginTop="10dp"
                    android:text="@string/offer_details_use_now" />

                <TextView
                    android:id="@+id/textView2"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_alignParentLeft="true"
                    android:layout_below="@+id/buttonUseNow"
                    android:layout_marginTop="10dp"
                    android:text="@string/_terms_and_conditions_"
                    android:textAppearance="?android:attr/textAppearanceSmall" />

                <TextView
                    android:id="@+id/textViewTermsConditions"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_alignParentLeft="true"
                    android:layout_below="@+id/textView2"
                    android:layout_marginTop="2dp"
                    android:textAppearance="?android:attr/textAppearanceSmall" />
            </RelativeLayout>

            <TextView
                android:id="@+id/textView7"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignBottom="@+id/relativeLayout5"
                android:layout_centerHorizontal="true"
                android:layout_marginBottom="30dp"
                android:text="e"
                android:textAppearance="?android:attr/textAppearanceSmall"
                android:visibility="invisible" />
        </RelativeLayout>
    </ScrollView>

</RelativeLayout> 
```

任何人都知道如何使 RelativeLayout2 与 ScrollView 具有相同的高度，这意味着我希望它到达屏幕底部吗？

谢谢和问候， 费利佩

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2012-06-09T16:27:39.683

我以前遇到过这个问题。只需`android:fillViewport="true"`在您的滚动视图中使用，它就会填满屏幕。

```
 <ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/scrollView1"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
         android:fillViewport="true" > 
```

# actionscript-3 - Adobe Flex，比 creationComplete 加载数据更好的地方？

> ID：10962604
> 
> 赞同：0
> 
> 时间：2012-06-09T16:25:56.330
> 
> 标签：actionscript-3, apache-flex, flex4, flash-builder, flex4.6

调用 HttpService 加载数据以显示在视图中的最合适的位置是什么？我正在阅读 creationComplete 不是最好的回调，但找不到更好的答案。我的应用程序有许多选项卡式对话框和其他视图，我希望在视图首次在屏幕上呈现时调用一次 HttpService。

谢谢你，肖恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T16:31:24.403

嗯，这是一个完全可以接受的解决方案，因为它是在第一次呈现视图时获得通知的最简单方法。所以，你有点依赖它。

您也可以在渲染之前加载数据并将其传递给视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T06:45:20.840

我不确定，但这可能会有所帮助：尝试`contentCreationComplete`事件。

# mysql - MYSQL 在多个字段上左连接

> ID：10962606
> 
> 赞同：3
> 
> 时间：2012-06-09T16:26:21.137
> 
> 标签：mysql, join

我有一张朋友桌。是否可以对表的两个字段进行左连接。换句话说，我不知道这两个字段中的哪一个可能有我需要的匹配项。如果没有，还有其他方法可以做到这一点吗？

```
$sql = "SELECT * FROM `friends` f
LEFT JOIN `users` u
ON f.askee OR f.asker = u.ID
where (asker='$userid' OR askee='$userid') AND status='3'"; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T16:32:19.363

左连接是正确的：OR 运算符会按照您的预期进行。但是你的过滤器`$userid`应该应用于父表（`friends`），而不是左连接一个（否则它会取消外连接）：

```
$sql = "SELECT * FROM `friends` f
LEFT JOIN `users` u ON f.`askee` = u.`ID` OR f.`asker` = u.`ID`
WHERE u.`status` = '3' AND u.ID = '$userid'"; 
```

# php - 如何将 jquery var 发送到 php？

> ID：10962607
> 
> 赞同：3
> 
> 时间：2012-06-09T16:26:36.990
> 
> 标签：php, jquery, ajax

当我尝试用 jquery 发送一个 var 时，ajax php 没有收到它，我也不知道为什么。

这是我的脚本：

```
function showHiddenUserInfoPanel(id){
$(document).ready(function(){
    $('#admin-resume').fadeToggle('slow', 'linear', function(){
        $.ajax({
            async: true,
            type: "POST",
            dataType: "html",
            contentType: "application/x-www-form-urlencoded",
            data: "userid="+id, // Also I tried with : data: {userid: id},
            url: "user-profile.php",
            success: function(){
                $('#info-user').fadeToggle('slow', 'linear');
                alert(id); // I receive the correct id value
            }
        });
    });
}); 
```

这是我的 user-profile.php：

```
<div id="activity_stats">
    <h3>Viendo el perfil de <?php echo $_POST["userid"]; ?></h3>
</div> 
```

任何人都可以帮助我吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-09T16:42:08.897

只是我还是您根本没有使用响应？

```
$.ajax({
  success: function(){
    $('#info-user').fadeToggle('slow', 'linear');
  }
}); 
```

您的匿名`success`函数忽略了所有响应。我怀疑你`#info-user`应该是一个空元素，你没有得到视觉反馈。

一个例子可能是：

```
$.ajax({
  success: function(response){
    $('#info-user').html(response).fadeToggle('slow', 'linear');
  }
}); 
```

其他替代方法可能是使用[`.load()`](http://api.jquery.com/load/).

# ruby-on-rails - 在 rails os x 10.7.4 xcode 4.3.2 rvm 1.14.1 上运行 bundle install 时出错

> ID：10962608
> 
> 赞同：0
> 
> 时间：2012-06-09T16:26:41.630
> 
> 标签：ruby-on-rails, rvm, databasedotcom-gem

试图启动一个新的 rails 应用程序，如果不安装捆绑包，我无法启动服务器。我得到这个错误。我尝试了其他堆栈无济于事。提前感谢您的任何指导！

```
Using coffee-rails (3.1.1) 
Using columnize (0.3.6) 
Using country_select (0.0.2) 
Using daemon_controller (1.0.0) 
Using database_cleaner (0.7.2) 
Using multipart-post (1.1.5) 
Using databasedotcom (1.3.0) 
Using debugger-ruby_core_source (1.1.2) 
Installing debugger-linecache (1.1.1) with native extensions 
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb 
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
    --with-opt-dir
    --without-opt-dir
    --with-opt-include
    --without-opt-include=${opt-dir}/include
    --with-opt-lib
    --without-opt-lib=${opt-dir}/lib
    --with-make-prog
    --without-make-prog
    --srcdir=.
    --curdir
    --ruby=/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby
extconf.rb:2:in `require': no such file to load -- debugger/ruby_core_source (LoadError)
    from extconf.rb:2

Gem files will remain installed in /Users/jahrichie/.bundler/tmp/2264/gems/debugger-linecache-1.1.1 for inspection.
Results logged to /Users/jahrichie/.bundler/tmp/2264/gems/debugger-linecache-1.1.1/ext/trace_nums/gem_make.out
An error occured while installing debugger-linecache (1.1.1), and Bundler cannot continue.
Make sure that `gem install debugger-linecache -v '1.1.1'` succeeds before bundling. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T03:27:32.103

看起来您错过了使用 ruby​​ 或在使用过的 ruby​​ 中安装 bundler 并且 bundler 已安装在系统 ruby​​ 中（但事实并非如此），请尝试：

```
rvm use 1.9.3 --install 
```

它将确保您使用 ruby​​ 并安装它。

# mysql - 使用 PetaPoco Database.Insert 插入 mysql 时出现问题

> ID：10962629
> 
> 赞同：3
> 
> 时间：2012-06-09T16:30:02.930
> 
> 标签：mysql, petapoco

我有一个使用 PetaPoco 重新实现 ASP.NET 的 Membership Provider、Role Provider 和 Profile Provider 的小项目。每个表都有两个共同的字段：name 和 lowered_name。当尝试使用 Database.Insert() 将新记录插入数据库时​​，我遇到了一个问题，无法插入 lowered_name 字段。

例如，我们有一个名为 Category 的表

```
CREATE TABLE `category` (
  `name` varchar(100) NOT NULL,
  `lowered_name` varchar(100) NOT NULL,
  PRIMARY KEY (`lowered_name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
```

和一个类别实体：

```
[TableName("category"), PrimaryKey("lowered_name")]
    public class Category
    {
        [Column("name")]
        public string Name { get; set; }
        [Column("lowered_name")]
        public string LoweredName { get; set; }
    } 
```

我已经使用 PetaPoco 插入了一个新类别，如下所示

var name = Guid.NewGuid().ToString(); var cat = new Category() { Name = name, LoweredName = name.ToLower() };

```
 var db = new Database("Test");

        db.Insert(cat);

        var retrievecat = db.SingleOrDefault<Category>("where lowered_name like @0", name.ToLower());

        Console.WriteLine(retrievecat.LoweredName);

        Assert.IsTrue(retrievecat != null); 
```

但是，此代码不起作用，创建了一条新记录，但记录的 lowered_name 字段为空。当我将 db.Insert(cat) 更改为：

```
db.Execute("insert into category(name, lowered_name) values (@0, @1)", name, name.ToLower()); 
```

一切安好。

我为上面的这些提供程序完成了很多代码，它们与 PostGreSQL 和 SQL Server 配合得很好，我不想重新实现每个存储库的每个 Insert 函数（我在 AbstractRepository 类中创建了一个通用的 Insert 函数）。

你有什么主意吗？

* * *

如果 lowered_name 是主键，SchoTime 已经帮助我解决了这个问题。但是，在我的真实应用程序中，name 和 lowered_name 不是主键。

我使用一个抽象类：

```
public abstract class AbstractEntity
    {
        #region Fields
        private string _name;
        #endregion Fields

        #region Properties
        [PetaPoco.Column(Name = "id")]
        public long Id { get; set; }

        [Required]
        [PetaPoco.Column(Name = "name")]
        public string Name
        {
            get { return _name; }
            set
            {
                _name = value;
                LoweredName = value.ToLower();
            }
        }

        [Required]
        [PetaPoco.Column(Name = "lowered_name")]
        public string LoweredName { get; set; }
        [PetaPoco.Column(Name = "description")]
        public string Description { get; set; }

        #endregion Properties

        #region Initialization
        public AbstractEntity()
        {
        }
        public AbstractEntity(string name)
        {
            Name = name;
        }
        #endregion Initialization
    } 
```

和用户实体：

```
[PetaPoco.TableName("vietspring_security_user"), PetaPoco.PrimaryKey("id")]
    public class User:AbstractEntity
    {
        #region Private Variables
        private string _email;
        #endregion

        #region Constructors
        public User():base()
        {
            InitMembers();
        }
        public User(int id)
        {
            Id = id;
            InitMembers();
        }
        public User(string name): base(name)
        {
            Name = name;
            InitMembers();
        }
        #endregion

        #region Properties

        [PetaPoco.Column("password")]
        public virtual string Password { get; set; }
        [PetaPoco.Column("password_format")]
        public virtual int PasswordFormat { get; set; }
        [PetaPoco.Column("password_salt")]
        public virtual string PasswordSalt { get; set; }
        [PetaPoco.Column("email")]
        public virtual string Email
        {
            get
            {
                return _email;
            }
            set
            {
                _email = value;
                LoweredEmail = value.ToLower();
            }
        }
        [PetaPoco.Column("lowered_email")]
        public virtual string LoweredEmail { get; set; }
        [PetaPoco.Column("password_question")]
        public virtual string PasswordQuestion { get; set; }
        [PetaPoco.Column("password_answer")]
        public virtual string PasswordAnswer { get; set; }
        [PetaPoco.Column("comments")]
        public virtual string Comments { get; set; }
        [PetaPoco.Column("is_approved")]
        public virtual bool IsApproved { get; set; }
        [PetaPoco.Column("is_locked_out")]
        public virtual bool IsLockedOut { get; set; }
        [PetaPoco.Column("creation_date")]
        public virtual DateTime CreationDate { get; set; }
        [PetaPoco.Column("last_activity_date")]
        public virtual DateTime LastActivityDate { get; set; }
        [PetaPoco.Column("last_login_date")]
        public virtual DateTime LastLoginDate { get; set; }
        [PetaPoco.Column("last_locked_out_date")]
        public virtual DateTime LastLockedOutDate { get; set; }
        [PetaPoco.Column("last_password_change_date")]
        public virtual DateTime LastPasswordChangeDate { get; set; }
        [PetaPoco.Column("failed_password_attempt_count")]
        public virtual int FailedPasswordAttemptCount { get; set; }
        [PetaPoco.Column("failed_password_attempt_window_start")]
        public virtual DateTime FailedPasswordAttemptWindowStart { get; set; }
        [PetaPoco.Column("failed_password_answer_attempt_count")]
        public virtual int FailedPasswordAnswerAttemptCount { get; set; }
        [PetaPoco.Column("failed_password_answer_attempt_window_start")]
        public virtual DateTime FailedPasswordAnswerAttemptWindowStart { get; set; }
        [PetaPoco.ResultColumn]
        public virtual IList<Application> Applications { get; set; }
        #endregion

        ...
    } 
```

在 MembershipProvider 中，我调用以下这些方法来创建新用户：

```
var userId = Convert.ToInt64(_userRepository.Insert(user));
                    _userRepository.AddApplication(app.Id, userId);
                    status = MembershipCreateStatus.Success; 
```

我成功保存用户，但 name 和 lowered_name 字段为空。这种情况怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T08:45:57.560

因为您有一个主键`lowered_name`并且它似乎不是一个自动增量列，所以您必须将 autoIncrement 设置为 false ，如下所示。

```
[PrimaryKey("lowered_name", autoIncrement=false)] 
```

AutoIncrement 默认为 true。

# ios - 将 UIView 从一个 UIScrollView 拖到另一个

> ID：10962632
> 
> 赞同：0
> 
> 时间：2012-06-09T16:30:47.953
> 
> 标签：ios, uiview, uiscrollview, drag-and-drop, uigesturerecognizer

我的屏幕上有两个 UIScrollView，我需要能够将 UIView 从一个滚动视图拖到另一个滚动视图。

目前，我在要移动的 UIView 上有一个 UILongGestureRecognizer ，这样当用户开始拖动它时，我让视图跟随触摸：

```
- (void)dragChild:(UILongPressGestureRecognizer *)longPress {
    [[longPress view] setCenter:[longPress locationInView:[[longPress view] superview]]];
} 
```

但是当我得到起始 UIScrollView 的边界时，视图消失了，因为它被锁定在该滚动视图的边界中。

当我开始拖动时，有没有办法将它从滚动视图中“弹出”，以便我可以将它带到另一个滚动视图？

另外，我如何测试“drop”位置？我想知道它是否被丢弃在某个其他视图上。

或者我是不是走错了路？

多谢你们

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T16:36:37.963

如果您需要将其从滚动视图拖到另一个，请执行以下操作（伪代码）

当您开始拖动时，请执行以下操作

```
//scrollView1 is the scroll view that currently contains the view
//Your view is the view you want to move
[scrollView1.superView addSubView:yourView]; 
```

现在删除视图时，您需要知道它是否在另一个滚动视图中

```
//scrollView2 is the second scroll view that you want to move it too
//Your view is the view you want to move
CGPoint point = yourView.center;
CGRect rect = scrollView2.frame;
if(CGRectContainsPoint(rect, point))
{  
    //Yes Point is inside add it to the new scroll view
    [scrollView2 addSubView:yourView];
}
else
{
    //Point is outside, return it to the original view
    [scrollView1 addSubView:yourView];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T16:41:56.717

这是一个未经测试的想法：

*   当拖动开始时，将拖动视图移出滚动视图（作为子视图）并进入两个滚动视图的相互父视图。
*   当拖动结束时，将拖动视图移出超级视图并进入新的滚动视图。

您可能必须小心坐标系，`[UIView convertPoint:toView:]`在移动物体时使用诸如在视图的不同视角之间转换之类的东西。

# ruby-on-rails - 验证任一属性是否定义了一个值，并且与 mongoid 的“nil”不同

> ID：10962648
> 
> 赞同：0
> 
> 时间：2012-06-09T16:32:52.787
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, mongoid

我有一个`Post`具有 2 个属性的模型：

`attr1`和`attr2`

我想检查任一属性是否定义了值或与“nil”不同。

我该怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T19:47:38.777

这个问题的解决方案是下一个查询：

```
Post.any_of({ :attr1.ne => nil }, { :attr2.ne => nil}) 
```

非常感谢你！。问候！

# liferay-6 - jbpm 与 liferay

> ID：10962650
> 
> 赞同：0
> 
> 时间：2012-06-09T16:33:00.890
> 
> 标签：liferay-6, jbpm

我可以在 liferay 之外运行一个用 jbpm5 完成的示例工作流

但现在我想在 liferay 中运行这个例子

所以问题是如何将jbpm5与liferay集成

我想我需要在 liferay 中编辑一些配置文件

我正在阅读这些[说明](http://www.liferay.com/community/wiki/-/wiki/1071674/How+to+Set+Up+JBPM+with+Liferay)，但找不到解决方案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T12:37:13.490

如果您尝试集成 jBPM5，这并不简单。如您所见，您提到的教程是为 jbpm 3.1.2（一个非常旧的版本）编写的。将 jBPM5 集成到 liferay 将是一个巨大的社区贡献，因此如果您有兴趣，我们可以指导您，但您需要进行工作和研究才能使其正常工作。我可以在 jBPM5 方面为您提供帮助，但您需要深入研究 liferay 位。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T17:10:46.400

我建议如果你想在 Liferay 中运行 Workflow，首先你必须找到一个工作流引擎的插件。据我所知，Liferay 支持 Activity、JBPM、Kaleo，.. 你下载了 Liferay 的 JBPM 插件吗？因为默认 Liferay 使用 Kaleo。

# android - Netty 框架或如何将其与 AsyncTask 一起使用

> ID：10962654
> 
> 赞同：3
> 
> 时间：2012-06-09T16:33:29.337
> 
> 标签：android, multithreading, asynchronous, android-asynctask, netty

我正在尝试开发一个将使用[Netty](http://netty.io/)的 Android 应用程序。

首先我想在 Android 上测试 Netty，所以我要开发[EchoClient](http://netty.io/docs/stable/xref/org/jboss/netty/example/echo/package-summary.html)的例子。

我正在“翻译”客户部分。这部分有两个类：[EchoClient](http://netty.io/docs/stable/xref/org/jboss/netty/example/echo/EchoClient.html)和[EchoClientHandler](http://netty.io/docs/stable/xref/org/jboss/netty/example/echo/EchoClientHandler.html)

`EchoClient`作为线程运行，并`EchoClientHandler`处理所有网络内容。

在 main 方法`EchoClient`上，运行如下：

`new EchoClient(host, port, firstMessageSize).run();`

`EchoClientHandler`使用异步事件编程模型。

这是[EchoClient](http://netty.io/docs/stable/xref/org/jboss/netty/example/echo/EchoClient.html)的一段代码：

```
public void run() {
    // Configure the client.
    ClientBootstrap bootstrap = new ClientBootstrap(
            new NioClientSocketChannelFactory(
                    Executors.newCachedThreadPool(),
                    Executors.newCachedThreadPool()));

    // Set up the pipeline factory.
    bootstrap.setPipelineFactory(new ChannelPipelineFactory() {
        public ChannelPipeline getPipeline() throws Exception {
            return Channels.pipeline(
                    new EchoClientHandler(firstMessageSize));
        }
    });

    // Start the connection attempt.
    ChannelFuture future = bootstrap.connect(new InetSocketAddress(host, port));

    // Wait until the connection is closed or the connection attempt fails.
    future.getChannel().getCloseFuture().awaitUninterruptibly();

    // Shut down thread pools to exit.
    bootstrap.releaseExternalResources();
} 
```

这种`run()`方法可以是`AsyncTask.doBackground()`方法。

如您所见， [EchoClientHandler](http://netty.io/docs/stable/xref/org/jboss/netty/example/echo/EchoClientHandler.html)是此类的一部分。

这是我想在 UI 线程中使用的[EchoClientHandler方法：](http://netty.io/docs/stable/xref/org/jboss/netty/example/echo/EchoClientHandler.html)

```
@Override
public void messageReceived(
        ChannelHandlerContext ctx, MessageEvent e) {
    // Send back the received message to the remote peer.
    transferredBytes.addAndGet(((ChannelBuffer) e.getMessage()).readableBytes());
    e.getChannel().write(e.getMessage());
} 
```

如何在 AsynTask 中使用 EchoClientHandler？我不知道如何在调用`onProgressUpdate`时更新 TextView。`messageReceived`

有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T23:48:39.013

也许你可以使用回调。

**步骤 1.**定义接口

```
public interface MyCallback {
     public void onMessage(string msg);
} 
```

**步骤 2.**在 EchoHandler 构造函数中取一个符合该接口的对象并将其存储为类变量

```
private MyCallback _myCallback
public EchoClientHandler(int firstMessageSize, MyCallback callback) {
   _myCallback = myCallback;
   ...
} 
```

**步骤 3.**将对象传递给管道中的构造函数。myCallback 可以来自 run() 作为参数或在您的 EchoClient 构造函数中。

```
// Set up the pipeline factory.
bootstrap.setPipelineFactory(new ChannelPipelineFactory() {
    public ChannelPipeline getPipeline() throws Exception {
        return Channels.pipeline(
                new EchoClientHandler(firstMessageSize, myCallback));
    }
}) 
```

**步骤 4.**在您​​的消息处理程序中调用回调

```
@Override
public void messageReceived(
    ChannelHandlerContext ctx, MessageEvent e) {
    // Send back the received message to the remote peer.
    transferredBytes.addAndGet(((ChannelBuffer) e.getMessage()).readableBytes());
    e.getChannel().write(e.getMessage());

    _myCallback.onMessage("message");
} 
```

希望这可以帮助。

# c - 如何在我的 C 代码中的某些函数上方插入编译指示

> ID：10962656
> 
> 赞同：1
> 
> 时间：2012-06-09T16:33:43.670
> 
> 标签：c, parsing, compiler-construction, pragma

> **可能重复：**
> [如何在程序中自动插入编译指示](https://stackoverflow.com/questions/10960974/how-to-automatically-insert-pragmas-in-your-program)

我想要一个工具来自动在某些函数定义上方的行上编写编译指示。编译指示与某些分析器提供的一些信息有关。

例如，如果我有这个功能。

```
void some function()
{
....
} 
```

插入 pragma 后，它看起来像这样，

```
#pragma something
void some function()
{
....
} 
```

现在我在想，也许我们可以使用编译器组件来告诉我们所有函数定义（在哪些行和列上）在哪里，并在正确的位置插入 pragma。对我来说最简单的选择是什么。

# css - 带有背景图像和渐变的 CSS 少？

> ID：10962657
> 
> 赞同：0
> 
> 时间：2012-06-09T16:33:53.517
> 
> 标签：css, less

什么是最有效的为此编写更少的方法，以便它可以为所有浏览器创建规则？

```
CSS output:

background: url(../i/bg_lines7.png), -webkit-linear-gradient(left, #555, #333) #333;
background: url(../i/bg_lines7.png), -moz-linear-gradient(left, #555, #333) #333;
..

CSS output:
background: #000, url(../i/bg_lines7.png), -webkit-linear-gradient(left, #555, #333);
background: #000, url(../i/bg_lines7.png), -moz-linear-gradient(left, #555, #333); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T15:59:19.753

使用混合。

```
.my-multi-browser-thing (@image,@gsc,@gec,@bfb) {
    background: url(../i/@image), -webkit-linear-gradient(left, @gsc, @gec) @bfb;
    background: url(../i/@image), -moz-linear-gradient(left, @gsc, @gec) @bfb;
    ... add more syntax variations ...
}

.my-multi-browser-thing ("bg_lines7.png",#555,#333); 
```

# c# - 在 ASP.NET 中下载文件（通过服务器），同时将其流式传输给用户

> ID：10962661
> 
> 赞同：2
> 
> 时间：2012-06-09T16:34:49.337
> 
> 标签：c#, asp.net, .net, windows

我的 ASP.NET 网站当前将文件从远程服务器下载到本地驱动器，但当用户访问该站点时，他们必须等待服务器完成文件下载，然后才能从我的 ASP.NET 网站下载文件。

是否可以通过我的 ASP.NET 网站直接将远程网站的下载流式传输给用户（有点像代理）？

我目前的代码如下：

```
using (var client = new WebClientEx())
                {
    client.DownloadFile(downloadURL, "outputfile.zip");
} 
```

网络客户端类：

```
 public class WebClientEx : WebClient
    {
        public CookieContainer CookieContainer { get; private set; }

        public WebClientEx()
        {
            CookieContainer = new CookieContainer();
        }

        protected override WebRequest GetWebRequest(Uri address)
        {
            var request = base.GetWebRequest(address);
            if (request is HttpWebRequest)
            {
                (request as HttpWebRequest).CookieContainer = CookieContainer;
            }

            return request;
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T17:07:49.883

如果我理解正确，您正在为正在下载的远程文件实现某种缓存，但同时流式传输给用户。在这种情况下，您可能不想使用`WebClient`并等待整个文件完成。

查看类似帖子的答案，使用`HttpWebRequest`： [https ://stackoverflow.com/a/5605490/1373170](https://stackoverflow.com/a/5605490/1373170)

在这种情况下，您可以将文件分成块进行流式传输，并将这些相同的块发送到本地存储和`Response`. 如果您真的不需要服务器上本地的文件，您可以完全避免该存储，而只将其直接流式传输给用户。

# teamcity - TeamCity 重用工件存档名称

> ID：10962663
> 
> 赞同：0
> 
> 时间：2012-06-09T16:35:02.437
> 
> 标签：teamcity

我需要将几个文件夹放入工件存档中。现在我正在按照以下方式进行操作：

```
P3Binaries/bin => build %env.BUILD_NUMBER%.zip!/bin
P3Binaries/DemoFiles => build %env.BUILD_NUMBER%.zip!/DemoFiles 
```

但我不想重复档案名称（实名更复杂）。有什么方法可以将它存储到某个变量中以便重用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T20:51:14.540

是的，您可以将此值存储在构建配置参数中并重用它。 [在构建配置中定义和使用构建参数](http://confluence.jetbrains.net/display/TCD7/Defining+and+Using+Build+Parameters+in+Build+Configuration)

# c# - XNA - 鼠标坐标到单词空间的转换

> ID：10962666
> 
> 赞同：1
> 
> 时间：2012-06-09T16:35:17.320
> 
> 标签：c#, xna, transformation

我有一个很烦人的问题。我想创建一个绘图程序，使用 winform + XNA 组合。

最重要的部分是将鼠标位置转换为 XNA 绘制的网格 - 我能够进行翻译，但它只有在我不放大时才有效 - 当我这样做时，坐标简直是可怕的错误。

而且我不知道我做错了什么。我试图用缩放矩阵变换，用逆缩放矩阵变换，乘以缩放，但似乎没有一个工作。

一开始（缩放值 = 1），网格从 (0,0,0) 开始到 (Width, Height, 0)。只要缩放值根本没有改变，我就能够基于这个网格获得坐标。我使用自定义着色器，具有正交投影矩阵、单位视图矩阵和转换后的世界矩阵。

以下是两种主要方法：

```
internal void Update(RenderData data)
{
    KeyboardState keyS = Keyboard.GetState();
    MouseState mouS = Mouse.GetState();

    if (ButtonState.Pressed == mouS.RightButton)
    {
        camTarget.X -= (float)(mouS.X - oldMstate.X) / 2;
        camTarget.Y += (float)(mouS.Y - oldMstate.Y) / 2;
    }

    if (ButtonState.Pressed == mouS.MiddleButton || keyS.IsKeyDown(Keys.Space))
    {
        zVal += (float)(mouS.Y - oldMstate.Y) / 10;
        zoom = (float)Math.Pow(2, zVal);
    }

    oldKState = keyS;
    oldMstate = mouS;

    world = Matrix.CreateTranslation(new Vector3(-camTarget.X, -camTarget.Y, 0)) * Matrix.CreateScale(zoom / 2);
}

internal PointF MousePos
{
    get
    {
        Vector2 mousePos = new Vector2(Mouse.GetState().X, Mouse.GetState().Y);

        Matrix trans = Matrix.CreateTranslation(new Vector3(camTarget.X - (Width / 2), -camTarget.Y + (Height / 2), 0));

        mousePos = Vector2.Transform(mousePos, trans);
        return new PointF(mousePos.X, mousePos.Y);
    }
} 
```

第二种方法应该根据网格返回鼠标光标的坐标（其中网格的 (0,0) 点是左上角）。

但就是不工作。我从矩阵 trans 中删除了缩放转换，因为我无法获得任何有用的结果（大多数时候，坐标非常错误，当网格大小为 500x500 时，大多数情况下是数千个）。

有什么想法或建议吗？这两天我一直在尝试解决这个简单的问题：\

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T08:39:12.287

看一下用于将屏幕空间位置转换为世界空间的 GraphicsDevice.Viewport.Unproject 方法，它基本上以相反的顺序通过您的世界、视图、投影转换。

至于您的缩放问题，为什么不将相机移近您正在查看的对象，而不是缩放世界变换？

# java - 我应该在这种方法中使用 lock.lock(): 吗？

> ID：10962667
> 
> 赞同：0
> 
> 时间：2012-06-09T16:35:26.450
> 
> 标签：java

我编写了这个方法，其目的是通知线程正在离开

特定的代码块

线程代表正在离开桥梁的汽车，以便其他汽车可以穿过它。

给定数量的汽车（容量有限）可以进入这座桥，而且只有一种方式。

```
public void getout(int diection){
        // release the lock
        semaphore.release();

        try{
            lock.lock(); //access to shared data
            if(direction == Car.NORTH)
                nNordTraversing--; //decreasing traversing threads
            else
                nSudTraversing--;

            bridgeCond.signal(); 

        }finally{
            lock.unlock();
        }

    } 
```

我的问题是：我应该使用 lock.lock(); 或者这只是胡说八道？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T16:39:10.633

*由于我们没有完整的代码（信号量是什么？），这个答案部分基于猜测。*

如果您的问题与递增和递减操作有关，那么您应该知道这些操作实际上不是原子的。

所以是的，如果您有其他线程访问这些变量，您需要保护它们以确保没有其他线程可以读取它们或更糟的是尝试执行相同的操作，因为两个并行增量可能只导致一个有效。

但由于锁定是有代价的，您也可以将变量封装在[AtomicLong](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/atomic/AtomicLong.html)中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T16:46:01.037

好吧，我假设 nNordTraversing 和 nSudTraversing 是共享数据。由于 ++ 和 -- 不是原子操作，因此在更改之前锁定它们是有意义的。否则可能会发生以下情况：

*   您读取了变量 nNordTraversing（例如 7）
*   另一个线程被调度并完成了它的 getout 方法，它改变了变量（例如 7 -- --> 6）
*   您被安排回来，更改变量，但在其他线程更改之前读取的旧数据（例如 7 --> 8）
*   另一个线程的更改被覆盖，计数不再一致（例如，现在是 8，但应该是 7）

这称为丢失更新问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T16:42:21.967

从代码片段和需求`getout`不会被模拟线程调用，只有队列前面的线程，因此调用的方法`getout`应该同步，因为并非所有线程（汽车）都可以在队列的前面.

我还认为您`semaphore`在调用方法中用作保护锁。

如果在您的实现`getout`中被多个方法调用，那么是的，您需要同步并且您的代码是正确的。

# css - 输入焦点时更改背景位置 div

> ID：10962671
> 
> 赞同：0
> 
> 时间：2012-06-09T16:36:10.850
> 
> 标签：css, html, input, background, focus

我正在用标签等图像构建表单......

我有：

```
DIV.icon-phone {
    width: 22px
    height: 22px
    background: url('icon-set.png') no-repeat 22px 66px;
}

INPUT.pool-phone {
    border:1px solid #666;
} 
```

我会这样：如果 INPUT.pool-phone:focus 将 DIV.icon-phone 背景位置更改为：44px 66px

请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T16:44:34.730

为了在修改另一个元素时更改元素的某些 css 属性，您需要具有特定的结构..

对于您的示例，该`input`元素必须与 the 共享相同的直接父级，`div`并且在层次结构中位于它之前。

在这种情况下，您可以使用[`~`General 同级组合](http://www.w3.org/TR/selectors/#general-sibling-combinators)器来定位它

```
.pool-phone:focus ~ .icon-phone{
   background-position:...
} 
```

**演示在** [http://jsfiddle.net/gaby/fx5Uy/](http://jsfiddle.net/gaby/fx5Uy/)

* * *

否则你可以使用javascript并绑定到`onfocus`事件..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T16:43:23.247

您可以编写一个 javascript 函数来为您处理这些问题。

```
[the input button].onfocus = function changeBg () { [thediv].style.background="[whatever you want]" };
[the input button].onblur = function resetBg () { [thediv].style.background="[whatever you want]" }; 
```

Gaby 发布了一个更可取的纯 CSS 版本（至少对我而言）。

# silverlight - 将列表绑定到 silverlight datagrid/datafrom 列

> ID：10962672
> 
> 赞同：0
> 
> 时间：2012-06-09T16:36:14.460
> 
> 标签：silverlight, data-binding, datagrid, dataform

一定有我遗漏的东西，我想做一件很简单的事情，例如，我有一个像下面这样的类：

```
public class Person
{
    public int ID { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public DateTime DateOfBirth { get; set; }
    public List<string> phoneNumbers { get; set; }
} 
```

我想通过以下方式将其绑定到数据表单：

```
 public Person person { get; set; }
 private void GetPerson()
 {
 List<string> lst = new List<string>();
        lst.Add("123445");
        lst.Add("2345345");
        lst.Add("4576345");
        lst.Add("456784");
        lst.Add("789067");

        person = new Person()
        {
            ID = 1,
            FirstName = "Kevin",
            LastName = "Dockx",
            DateOfBirth = new DateTime(1981, 5, 5),
            phoneNumbers= lst

        };
 } 
```

接着

```
 GetPerson();
  dataForm1.CurrentItem = person; 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T17:32:03.787

您创建新列表、将项目添加到列表并创建新人员的那些语句需要在方法中。您不能将这些语句放在方法之外（与 Person 属性定义处于同一级别）。

作为旁注——当您尝试构建此代码时，您肯定会遇到编译器错误。我强烈建议养成尝试理解并理解特定编译器错误的习惯——因为它们已经告诉你*你做错了什么*:)

# android - admob 广告不显示，但我的 logcat 中没有错误

> ID：10962678
> 
> 赞同：1
> 
> 时间：2012-06-09T16:37:18.357
> 
> 标签：android, admob

我想在我的 Android 应用程序中测试我的 admob 广告，但广告无法显示。并且在logcat中找不到错误。我还可以从 Admob 找到广告成功请求。我使用“X”来表示我的发布 ID。

```
package com.admob.test;

import android.app.Activity;
import android.os.Bundle;

public class AdmobTestActivity extends Activity {
/** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }
} 
```

.

```
 <?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.admob.test"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="4" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".AdmobTestActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name="com.google.ads.AdActivity"
                        android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|s        mallestScreenSize" />
    </application>
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />

</manifest> 
```

.

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
              android:orientation="vertical"
              android:layout_width="fill_parent"
              android:layout_height="fill_parent">
  <com.google.ads.AdView android:id="@+id/adView"
                         android:layout_width="wrap_content"
                         android:layout_height="wrap_content"
                         ads:adUnitId="xxxxxxxxxxxxxxx"
                         ads:adSize="BANNER"
                         ads:testDevices="C904358AFB272CDFA888A5C1CB914DA4"
                         ads:loadAdOnCreate="true"/>
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T21:10:45.790

如果 AdMob 说您的应用状态为“活动”，则表示您的代码一切正常，并且您的应用正在向 admob 发送请求。问题是由于某种原因没有适合您的广告。
正如你所说，它是活跃的，我会试试这个：

点击您应用的“管理设置”（在 AdMob > 网站和应用中），然后选择“应用设置”选项卡并选择

> “使用关键字定位广告和 Google 认证的广告网络 (GCAN) 来提高填充率。”

这样，您将有更多机会展示一些广告。

您将在站点和应用程序页面收到此消息：

> 恭喜您启用了 Google AdSense 广告！您帐户中的应用已启用以投放 Google AdSense 广告。对于任何未填充的广告请求，AdMob 将尝试投放 Google AdSense 广告以帮助提高您的填充率。您无需进一步更改。

这对我有帮助。我没有收到广告，现在它工作得很好。也许这会对某人有所帮助。

# sql-server - 将日期与日期时间戳分开，然后按日期总计显示

> ID：10962680
> 
> 赞同：0
> 
> 时间：2012-06-09T16:38:03.833
> 
> 标签：sql-server

我对 SQL 很陌生，好吧，我已经 8 年左右没有使用它了。这是在使用 SQL Server 的餐厅销售点系统中完成的。无论如何，这是我当前的代码：

```
select cashier_id,grand_total, num_people_party, datetime
from invoice_totals
where datetime >= '2012-06-01' 
```

最终，我想显示一份报告，其中列出了每个日期的收银员 ID ( )服务的总人数 ( `num_people_served`) 和总计 ( )。`grand_total``cashier_id`

所以：

```
Cashier ID 223
2012-06-01   10   200.00
2012-06-02   23   245.00

Cashier ID 224
2012-06-01   15   123.00
2012-06-02   24   254.00

etc... 
```

这不应该太难，但我只是不记得了，我的搜索也没有被证明有用。此外，应该注意的是，该`DateTime`字段需要拆分才能按日期对总计进行分组。

* * *

在从下面的评论中添加除法字段时，添加后出现以下错误：

```
Message: Could not retrieve datatable.
SELECT CASHIER_ID AS SERVER, CONVERT(VARCHAR(10),[DATETIME],111) AS DATE, SUM(GRAND_TOTAL) AS TOTAL_SALES, SUM(NUM_PEOPLE_PARTY) AS NUMBER_SERVED, SUM(GRAND_TOTAL) / SUM(NUM_PEOPLE_PARTY) AS CASHPERCUSTOMER
FROM INVOICE_TOTALS
WHERE [DATETIME] >= '2012-06-01'
GROUP BY CASHIER_ID, CONVERT(VARCHAR(10),[DATETIME],111) 
Stack Trace:    at PCA_DataMod.PCA_DB.OpenDT(String SQLLoadInfo, Boolean NoSchema)
   at PCA_DataMod.PCA_DB.OpenDT(String SQLLoadInfo)
   at pcAmerica.Desktop.POS.Forms.frmReportCustomWiz.GetRawSQLFields()
   at pcAmerica.Desktop.POS.Forms.frmReportCustomWiz.Display_Step(WizardStep Index)

Message: Divide by zero error encountered.
Stack Trace:    at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj)
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlDataReader.HasMoreRows()
   at System.Data.SqlClient.SqlDataReader.ReadInternal(Boolean setTimeout)
   at System.Data.SqlClient.SqlDataReader.Read()
   at System.Data.Common.DataAdapter.FillLoadDataRow(SchemaMapping mapping)
   at System.Data.Common.DataAdapter.FillFromReader(DataSet dataset, DataTable datatable, String srcTable, DataReaderContainer dataReader, Int32 startRecord, Int32 maxRecords, DataColumn parentChapterColumn, Object parentChapterValue)
   at System.Data.Common.DataAdapter.Fill(DataSet dataSet, String srcTable, IDataReader dataReader, Int32 startRecord, Int32 maxRecords)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataSet dataSet, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataSet dataSet)
   at PCA_DataMod.PCA_DB.OpenDT(String SQLLoadInfo, Boolean NoSchema) 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T16:43:31.460

你可以`group by`收银员和当天：

```
select     cashier_id
,          dateadd(d, 0, datediff(d, 0, [datetime]))
,          sum(grand_total)
,          sum(num_people_party)
from       invoice_totals
where      [datetime] >= '2012-06-01'
group by
           cashier_id
,          dateadd(d, 0, datediff(d, 0, [datetime])) 
```

在 SQL Server 2008 及更高版本中，您可以替换

```
dateadd(d, 0, datediff(d, 0, [datetime])) 
```

和

```
cast([datetime] as date) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T16:46:40.860

您可以按日期部分分组：

```
select cashier_id,SUM(grand_total), SUM(num_people_party), DATEPART(dd,[datetime]) AS Day, DATEPART(mm,[datetime]) AS Month, DATEPART(yyyy,[datetime]) AS Year
from invoice_totals
where datetime >= '2012-06-01'
group by cashier_id, DATEPART(dd,[datetime]), DATEPART(mm,[datetime]), DATEPART(yyyy,[datetime]) 
```

或者更简单地说

```
select cashier_id, SUM(grand_total), SUM(num_people_party), DAY([datetime]) AS Day, MONTH([datetime]) AS Month, YEAR([datetime]) AS Year
from invoice_totals
where datetime >= '2012-06-01'
group by cashier_id, DAY([datetime]), MONTH([datetime]), YEAR([datetime]) 
```

# java - 更快的字符串排列

> ID：10962682
> 
> 赞同：0
> 
> 时间：2012-06-09T16:38:15.250
> 
> 标签：java, string, performance, permutation, factorial

我有排列方法

```
public void permute(String str) {
    permute(str.toCharArray(), 0, str.length() - 1);
}

private void permute(char[] str, int low, int high) {
    if (low == high) {
        writeIntoSet(new String(str, 0, length));
    } else {
        for (int i = low; i <= high; i++) {
            char[] x = charArrayWithSwappedChars(str, low, i);
            permute(x, low + 1, high);
        }
    }
}

private char[] charArrayWithSwappedChars(char[] str, int a, int b) {
    char[] array = str.clone();
    char c = array[a];
    array[a] = array[b];
    array[b] = c;
    return array;
} 
```

但是当我将长度为 10 个字母的字符串放入此方法时，它变成了 10！组合，这需要很多时间。有没有可能让它更快？

**编辑**

我需要对 10 个字母进行排列，但在那之后，我会在字典中搜索这些“单词”。例如，我有 - CxRjAkiSvH，我需要词 CAR、CARS、CRASH 等。有任何性能选项吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T16:59:20.073

存在用于生成排列的现有算法，这些算法可能比您正在使用的算法更有效，因此您可以查看[其中之一](http://en.wikipedia.org/wiki/Permutation#Algorithms_to_generate_permutations)。我过去曾使用过 Johnson-Trotter 算法，该算法通过使最小的变化成为可能，每次都获得下一个排列，从而稍微加快了速度。我不知道您必须在什么样的约束范围内工作，但如果您不必使用 Java，最好不要使用。它根本不会是最快的。特别是如果您的算法使用递归。正如其他人所建议的那样，如果您坚持使用此算法，您最好远离递归方法并尝试使用循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T16:44:26.167

对于 10 个字符的字符串，有 10 个！排列，没有两种方法可以解决这个问题。您可以通过附加到s 或手动`StringBuffer`使用来稍微加快速度。`char[]`

# c++ - wm_copydata，变量 endpaint_text 周围的堆栈已损坏

> ID：10962683
> 
> 赞同：-1
> 
> 时间：2012-06-09T16:38:25.153
> 
> 标签：c++, winapi

我在下面挂钩了 Winapi EndPaint() 函数，在其中我发送了一些 wm_copydata，但与此同时，我收到“wm_copydata，变量 endpaint_text 周围的堆栈已损坏......”挂钩的应用程序崩溃。

BOOL WINAPI Mine_EndPaint(HWND hWnd, const PAINTSTRUCT *lpPaint) {

```
 BOOL result = fpEndPaint(hWnd, lpPaint);

    if (hWnd == g_win)
    {

        if (lpPaint->rcPaint.left == g_12x && lpPaint->rcPaint.top == g_12y)
        {
        painting = 0;

        wchar_t endpaint_text[MAX_PATH] = L"deleting_a";
         COPYDATASTRUCT cds;
        ::ZeroMemory(&cds, sizeof(COPYDATASTRUCT));
        cds.cbData = sizeof(paint_dc);
        cds.lpData = endpaint_text;

        ::SendMessageTimeoutW(g_main, WM_COPYDATA, (WPARAM)::GetDesktopWindow(), (LPARAM)&cds, SMTO_ABORTIFHUNG, 1000, 0);

        }
        else if (lpPaint->rcPaint.left == g_list12x && lpPaint->rcPaint.top == 137)
        {

        big_painting = 0;
        wchar_t endpaint_text[MAX_PATH] = L"deleting_b";
         COPYDATASTRUCT cds;
        ::ZeroMemory(&cds, sizeof(COPYDATASTRUCT));
        cds.cbData = sizeof(paint_dc);
        cds.lpData = endpaint_text;

        ::SendMessageTimeoutW(g_main, WM_COPYDATA, (WPARAM)::GetDesktopWindow(), (LPARAM)&cds, SMTO_ABORTIFHUNG, 1000, 0);

        }
    }

    else if (check_d)
    {
        re_window = NULL;

        GetWindowText(hWnd, window_text, MAX_PATH);
        if (!wcscmp(window_text, L"Text"))
        {
            check_d = false;
            re_window = hWnd;
            wchar_t re_info[MAX_PATH] = L"";
            //wcscat(re_info, text);
            COPYDATASTRUCT cds;
            ::ZeroMemory(&cds, sizeof(COPYDATASTRUCT));
            cds.dwData = 931;
            cds.cbData = sizeof(re_info);
            cds.lpData = re_info;
            wsprintf(re_info, L"Text='%s', HWND='%X'", d_text, re_window);
            ::SendMessageTimeoutW(g_main, WM_COPYDATA, (WPARAM)::GetDesktopWindow(), (LPARAM)&cds, SMTO_ABORTIFHUNG, 1000, 0);

        }

    }
    return result;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T08:35:29.277

它溢出了 wsprint，与提到的损坏的 var 无关。

# php - 用什么代替全局变量？

> ID：10962685
> 
> 赞同：2
> 
> 时间：2012-06-09T16:38:31.610
> 
> 标签：php

> **可能重复：**
> [PHP Globals 的安全替代品（良好的编码实践）](https://stackoverflow.com/questions/7290993/safe-alternatives-to-php-globals-good-coding-practices)

我有一个函数中需要的变量。它存储在 $config 数组中的 config.php 中。该变量不能通过参数传递，因为我无法从那里访问它，也不应该需要它。

所以我相信我在这里有三种选择（仅限程序）：

1.  全球人。奇迹般有效。Globals 被讨厌，因此我不使用它的想法。
2.  在我的 config.php 文件中定义一个常量。
3.  在函数中包含配置文件。

我应该选择什么替代方案？

# django - 为什么 South 尝试删除我要添加的列？

> ID：10962690
> 
> 赞同：2
> 
> 时间：2012-06-09T16:39:01.207
> 
> 标签：django, django-south

我有一个简单的迁移，如下所示：

```
class Migration(SchemaMigration):

    def forwards(self, orm):
        db.add_column('activities_newsitem', 'related_story', self.gf('django.db.models.fields.related.ForeignKey')(to=orm['projects.Story'], null=True, blank=True),keep_default=True) 
```

不幸的是，它失败了，我不确定为什么。下面是输出。请注意，它运行添加列查询就好了。事实上，当我查看数据库时，该列是正确的。

但由于某种原因，它之后运行了一个下拉列，这就是失败的原因。为什么这样做？

```
DEBUG south execute "ALTER TABLE `activities_newsitem` ADD COLUMN `related_story_id` integer NULL;" with params "[]" (generic.py:145)
DEBUG south execute "ALTER TABLE `activities_newsitem` ADD CONSTRAINT `related_story_id_refs_id_3d3841088db0fdb0` FOREIGN KEY (`related_story_id`) REFERENCES `projects_story` (`id`);" with params "[]" (generic.py:145)
DEBUG south execute "CREATE INDEX `activities_newsitem_related_story_id` ON `activities_newsitem` (`related_story_id`);" with params "[]" (generic.py:145)
DEBUG south execute "ALTER TABLE `activities_newsitem` ADD COLUMN `related_story_id` integer NULL;" with params "[]" (generic.py:145)
DEBUG south execute "ALTER TABLE `activities_newsitem` ADD CONSTRAINT `related_story_id_refs_id_3d3841088db0fdb0` FOREIGN KEY (`related_story_id`) REFERENCES `projects_story` (`id`);" with params "[]" (generic.py:145)
DEBUG south execute "ALTER TABLE `activities_newsitem` DROP COLUMN `related_story_id` CASCADE;" with params "[]" (generic.py:145)
 ! Error found during real run of migration! Aborting.

 ! Since you have a database that does not support running
 ! schema-altering statements in transactions, we have had 
 ! to leave it in an interim state between migrations. 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T01:08:16.267

看起来它试图运行你的命令两次。如果您查看迁移文件夹，是否有 2 个相同的迁移？如果您在没有实际迁移的情况下运行两次创建迁移命令，它可能会执行此操作。

您是否意外运行了两次命令？您可以通过打开数据库控制台并检查您的迁移是否在 south_migrationhistory 表中来检查这一点。

假设您使用的是 unixy 系统（OSX/Linux），从命令行：

`mysql -u username -p password`

然后

`select * from south_migrationhistory;`

你的移民在那里吗？

如果是这样，你的任务就完成了，你可以继续前进。如果不是，并且您的 activities_newsitem 表中有该列，则您需要伪造迁移以使您的南迁移历史保持最新。

要伪造您的迁移：

`python manage.py migrate activities --fake 0001`

其中 0001 是迁移编号（所有迁移文件都以数字为前缀）。

# android - Android 无法在三星 Galaxy Tab 10.1 上加载驱动程序触摸屏

> ID：10962692
> 
> 赞同：0
> 
> 时间：2012-06-09T16:39:38.043
> 
> 标签：android, linux-device-driver

你能帮我解决这个问题吗：我的平板电脑 Galaxy Tab 10.1，在重置后按下电源按钮 15 秒进行软重置，因为冻结加载应用程序，而不是加载触摸屏驱动程序。Dmesg 消息：

```
<6>[    7.163493] mXT1386: mxt_probe
<6>[    7.163501] maXTouch driver
<6>[    7.163507]    "sec_touch"
<6>[    7.163513]   addr:   0x004c
<6>[    7.163519]   irq:    220
<6>[    7.163525]   flags:  0x0000
<6>[    7.163531]   adapter:"Tegra I2C adapter"
<6>[    7.163537]   device: "(null)"
<3>[    7.163685] tegra-i2c tegra-i2c.1: I2c error status 0x00000008
<3>[    7.169602] tegra-i2c tegra-i2c.1: no acknowledge from address 0x4c
<3>[    7.176023] tegra-i2c tegra-i2c.1: Packet status 0x00010009
<6>[    7.182700] Warning: To wake up touch-ic in deep sleep, retry i2c communication!
<3>[    7.222752] tegra-i2c tegra-i2c.1: I2c error status 0x00000008
<3>[    7.228727] tegra-i2c tegra-i2c.1: no acknowledge from address 0x4c
<3>[    7.235061] tegra-i2c tegra-i2c.1: Packet status 0x00010009
<3>[    7.241798] sec_touch 1-004c: Failure accessing maXTouch device
<3>[    7.247800] sec_touch 1-004c: Chip could not be identified
<6>[    7.253434] p3_touch_exit_hw
<4>[    7.253455] sec_touch: probe of 1-004c failed with error 255
<6>[    7.253510] Successfully added driver sec_touch 
```

如何确定是硬件问题还是配置问题？

我从 CWM 清理缓存、数据、系统文件夹并重新安装 stock rom p7510uekmm 并没有发生任何事情

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T19:12:27.590

我的 Galaxy Tab 遇到了这个问题，并尝试了上面提到的想法，但它对我不起作用。然而，我已经弄清楚到底出了什么问题。

我总是在 dmesg 中出现这个失败：

tegra-i2c tegra-i2c.1：没有来自地址 0x4c 的确认

因此，它无法从地址 0x4c 的触摸屏控制器读取，因为芯片没有响应。提到的一个修复是重新编写配置，假设设备以某种方式被楔入。这也不起作用，因为您无法写入 0x4c - 同样缺乏确认。所以，如果 0x4c 是正确的地址，那么芯片一定是死的，对吧？

我尝试添加重置。没变。隔夜断开电池。也没有变化。

然后，我意识到发生了什么事。MXT1386 具有“固件更新”模式。当您将其置于更新模式时，设备地址从 0x4c 变为 0x26！一旦进入该模式，它就不会响应原始地址。由于我没有设备的文档，因此不知道如何退出固件更新模式，我更新了 Linux 内核以调用更新固件的驱动程序函数。一旦该过程完成并且芯片复位，它就会恢复到其原始地址。那时（在最后一次重新启动后），一切都很好。

我有一个替换内核，您可以安装和启动它重新启用触摸板。我建议先做一个 nandroid 备份，安装我的内核，然后在修复 nandroid 后恢复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T11:15:18.293

它试图通过 I ² C 总线联系触摸控制器并失败。它重试一次，然后放弃。该单元上的 mXT1386 地址 0x4C 是正确的。

*   您应该通过取出电池来尝试硬关机/开机。

*   您可以尝试拆开设备并将连接器重新连接到触摸控制器。它位于一个单独的板上，连接着一根可能已经脱落的柔性电缆。

*   另一种可能是触控芯片本身损坏。

# playframework - 如何在 Play 框架 2.0 (Java) 中重定向到外部 URL

> ID：10962694
> 
> 赞同：9
> 
> 时间：2012-06-09T16:39:45.683
> 
> 标签：playframework, playframework-2.0

使用控制器中的 redirect() 方法似乎可以重定向到内部 URL。

```
public static Result index() {
  return redirect(routes.Application.tasks());
} 
```

但是我想重定向到控制器中的外部 URL。redirect(String) 方法只接受内部 URL 作为参数。

我需要的是相当于标准 Java servlet 重定向的 Play 框架，即

```
request.sendRedirect(String url) 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-09T16:48:38.120

有时最简单的解决方案只是......有效：

```
return redirect("http://stackoverflow.com/questions/10962694"); 
```

也值得使用[其他可用的重定向](http://www.playframework.org/documentation/api/2.0.1/java/play/mvc/Results.html)，例如

*   `seeOther(String url)`
*   `movedPermanently(String url)`
*   `temporaryRedirect(String url)`

ETC

# spring - Spring 中的上下文注解有什么作用？

> ID：10962696
> 
> 赞同：9
> 
> 时间：2012-06-09T16:40:00.870
> 
> 标签：spring, jersey

在 Rest API 设计中，我想知道上下文注释的确切目的是什么？

```
private HttpServletRequest request;

 @Context
 public void setRequest(final HttpServletRequest req) {
        request = req;
 } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-09T16:49:32.237

目的是表明`request`应该从上下文中设置属性。

`@Context`用于从[这里](https://wikis.oracle.com/display/Jersey/Overview+of+JAX-RS+1.0+Features)注入各种 HTTP-ish 上下文数据：

> 一般来说，@Context 可用于获取与请求或响应相关的上下文 Java 类型。

[API 文档](https://docs.oracle.com/javaee/7/api/javax/ws/rs/core/Context.html)（IMO 不是非常有用。或者，也许更准确地说，非常有用。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-11T08:11:10.933

此注解用于将信息注入到类字段、bean 属性或方法参数中。

JAX-RS @Context 用于获取 ServletContext，WebApplicationContextUtils 用于获取 Spring 应用程序上下文，使用此 Spring 应用程序上下文，您可以从 Spring 容器访问和获取 bean

# c++ - c ++：逐行读取文件

> ID：10962698
> 
> 赞同：-4
> 
> 时间：2012-06-09T16:40:26.423
> 
> 标签：c++, file-io, filepath

我想知道是否有打开文件并逐行读取输入的 C++ 方式。

我遇到了以下完成任务的代码：

```
#include <iostream>
#include <fstream>
using namespace std;

int main () {
  ifstream myfile;
  myfile.open ("example.txt");
  return 0;
} 
```

鼓励我不要使用任何 C 函数或命令。

问题是，我的“example.txt”是字符串的形式，使用 str.c_str() 是一个 C 函数，所以我想我有两种方法可以解决这个问题。

是否有另一种方法可以逐行读取文件中的输入？也许使用可以接受字符串作为文件路径参数的东西？有 C++ 做事的方式吗？:)

或者，是否有另一种方法可以将字符串转换为 const char *，这是 myfile.open() 函数需要的？

提前谢谢了！

编辑：我缺乏实​​践和研究使我认为 c_str() 是一个 C 函数，但事实并非如此。我很抱歉。因为不是，所以我找到了答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T16:44:00.983

C++11 的`fstream`构造函数接受`string`. 在大多数情况下，您希望使用`fstream`' 构造函数，而不是`.open()`- 您保存一行和一个函数调用。

要逐行读取文件，您应该使用[`std::getline()`](http://en.cppreference.com/w/cpp/string/basic_string/getline).

另请注意，`string::c_str()`仍然是 C++ 函数，而不是 C 函数，以及`fstream`' 构造函数采用`const char *`. 大多数（如果不是全部，我不是 100% 肯定）C 标准库函数也包含在 C++ 标准中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T17:02:09.997

由于关于 str.c_str() 的问题已经得到解答，我将添加一些关于逐行获取输入的内容。例如，您想每行输入 2 个整数，提取它们，然后将其放入向量中。

```
fstream fs(filename.c_str(), ios_base::in);
string line;
stringstream ss;
int a,b;
vector<int> d; 
int numlines;
int i;
for (i = 0; getline(fs, line); i++) {
  for (ss.str(line); ss >> a >> b; d.push_back(a), d.push_back(b)) {}
  ss.clear();
}
numlines = i; 
```

希望您了解使用`getline()`和`fstream()`

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-06-09T16:46:21.130

它看起来会非常相似。您将需要 an`ifstream`而不是`ofstream`，您将需要`>>`运算符，并且假设您的文件有不止一行，您将需要一个循环和`ifstream::feof()`函数。

# wordpress - 如何解决 wordpress 3.3.2 中的导入问题？

> ID：10962700
> 
> 赞同：-3
> 
> 时间：2012-06-09T16:40:33.580
> 
> 标签：wordpress

当我尝试在 wordpress 3.3.2 中导入帖子时，我该如何解决这个问题？

> 在 /home/pixl/public_html/wp-content/uploads/shutter.xml_.txt 中找不到导出文件。这很可能是由权限问题引起的。

虽然上传文件夹的权限是：777

！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T18:27:15.747

我发现这个问题的不同解决方案只需安装 backupwordpressdb 插件并备份您的 wordpress 并再次下载该 zip 文件将该 zip 文件导入您的下一个 wordpress 站点并导入该 zip 文件。

可能这会解决你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T17:29:57.163

检查基于日期的文件夹的权限：uploads/2012/06/ 我的 Wordpress 导入将数据保存在那里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-10T17:38:53.780

我的是一个孤立的用例......但只是在这里发布以防其他人挣扎。

wordpress 导入器不能很好地与 Media Cloud 插件配合使用（我会假设其他插件会修改上传的存储位置）。

禁用媒体云插件为我解决了这个问题。尝试禁用所有插件并再次运行导入器（我应该这样做......我知道得更好）。

祝你好运！

# django - Django - 将开发服务器（manage.py runserver）与常规服务器（例如 Apache）区分开来

> ID：10962703
> 
> 赞同：0
> 
> 时间：2012-06-09T16:40:51.207
> 
> 标签：django, apache, wsgi, django-manage.py, django-dev-server

我需要一种方法来**区分 Django 中的开发服务器（例如 by 运行`./manage.py runserver 0.0.0.0:8000`）与在 Apache 上运行的**开发服务器。对于 Apache，我使用 WSGI 守护程序模式，但我想找到一些更可靠的解决方案来检测 Django 开发服务器上的执行情况。

我目前使用的类似于：

```
wsgi_wrapper = request.META.get('wsgi.file_wrapper')
wsgi_wrapper_path = wsgi_wrapper.__module__ if wsgi_wrapper else None 
```

这似乎提供了`wsgi_wrapper_path`存储：

*   " `wsgiref.util`" 在 Django 的内置开发服务器上运行时的字符串，
*   `None`当以守护程序模式在 Apache / WSGI 上运行时，

这里的问题是我不确定我是否可以依赖该检查（例如，如果生产/登台/开发服务器或我的本地主机配置发生更改）。我找不到任何有关此的文档。

**我需要该检查主要是因为 Django 的开发服务器存在一个问题**：即使 HTTP 请求本身没有设置内容类型（例如，它是一个请求） ，它也会将请求的`CONTENT_TYPE`( `request.META['CONTENT_TYPE']`) 设置为“ ”。`text/plain``GET`

任何关于 Django 的开发服务器检测（或解决请求内容类型不正确的问题）的想法都将不胜感激。谢谢。

附言。我基本上是在问这个问题：[如何判断我的 Django 应用程序是否在开发服务器上运行？](https://stackoverflow.com/q/1291755/548696)对于 Django 1.4，尝试确定在配置更改时足够可靠的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T08:08:49.060

作为一个原则 - 当使用生产服务器和开发服务器时，它们应该有不同的配置 - 最常见的是它们将使用不同的数据库、不同的邮件设置等。所以最好的地方告诉服务器的类型是配置。我可以指出两种最常用的方法：

*   配置文件

然后在 settings.py 中添加：

```
server = config.get("SERVER_TYPE", "DEV") 
```

并且 SERVER_TYPE 仅在 PRODUCTION 的配置文件中

*   环境

运行 Web 服务器时将 SERVER_TYPE 设置为环境变量。即对于 Supervisord，运行网络服务器：

```
environment=SERVER_TYPE=PROD 
```

或者对于 Apache：

```
SetEnv SERVER_TYPE PROD 
```

这样你就可以确保只要你不混合配置文件，你总是会得到真正的服务器类型，不管你如何启动服务器。至少这就是使用配置文件的原因。

# php - PHP 函数中未定义的变量和包含的脚本

> ID：10962704
> 
> 赞同：2
> 
> 时间：2012-06-09T16:40:52.737
> 
> 标签：php, variables, scope

我已经阅读了很多关于这个问题的东西，但是我仍然无法解决它。

在我的函数文件中，我声明了一个具有如下值的变量：

```
$px_host = "localhost"; 
```

我有一个像这样的数据库查询功能：

```
function dbQuery($database, $reqquery){
if(!$connect = mysql_connect($px_host, $px_dbuser, $px_dbpass)){
    exit("Error - cannot connect to MySQL server - " . mysql_error());
}

if(!$database = mysql_select_db($database)){
    exit("Error - cannot select database - " . mysql_error());
}

if(!$query = mysql_query($reqquery)){
    exit("Error - query error.");
}

return $query;
} 
```

每当我尝试运行该函数时，都会收到“未定义变量”错误。我尝试将变量设置为全局，但它仍然说它是未定义的。它们在同一个文件中，变量在函数之前定义和设置。

（我不擅长解释这一点，所以尝试解决它）包含的文件`dbQuery()`包含在另一个文件中。在另一个文件中，有一个函数用于`dbQuery()`获取某些信息。是否有可能因为它最初是从第一个文件运行的，所以变量超出了范围？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T17:50:47.210

在您的特定情况下，您应该在函数内声明全局函数外的所有变量。所以

```
function dbQuery($database, $reqquery){
    global $px_host,$px_dbuser,$px_dbpass;
    // rest of function
} 
```

但是您的代码可以改进：您应该在脚本的开头定义常量

```
define('DB_HOST','localhost');
define('DB_USER','user');
define('DB_PASS','pass'); 
```

并在函数内部使用常量（因此无需声明全局，而且更符合逻辑，因为主机、用户和传递不是变量而是常量）。

您应该在流程开始时只连接一次数据库，以便函数`dbQuery`只执行查询（根据函数名称）。

编辑答案的完整性：

正如一些用户在其他评论中所说的那样，我邀请您阅读[mysql_connect 的 php 文档](http://us.php.net/manual/en/function.mysql-connect.php)并查看红色建议：

> 不鼓励使用此扩展程序。相反，应该使用 MySQLi 或 PDO_MySQL 扩展。另请参阅 MySQL：选择 API 指南和相关的常见问题解答以获取更多信息。此功能的替代方案包括：

我不是在这里说你必须在你的项目中做什么，但阅读文档并遵循提示/建议对于你的项目的成功至关重要。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T17:25:28.770

时间不早了，所以这只是部分答案。

您可以采取的另一种方法是将数据库实例传递到您的辅助函数中，从而解决凭据问题。

```
function dbQuery($database, $reqquery)
{
    if (false !== ($query = mysql_query($reqquery, $database))) {
        exit("Error - query error.");
    }

    return $query;
} 
```

现在这个函数通过参数接收它的依赖并且也更短并且不会每次都连接/查询/断开连接。

剩下的代码必须写在别处；如果您在每个页面都需要一个数据库，则可以在链的上层编写：

```
if (false === ($connect = mysql_connect($px_host, $px_dbuser, $px_dbpass))) {
    exit("Error - cannot connect to MySQL server - " . mysql_error());
}

if (false === mysql_select_db($database)) {
    exit("Error - cannot select database - " . mysql_error());
} 
```

`$connect`然后你在任何需要的地方传递。

```
$res = dbQuery($connect, 'SELECT "hello world"'); 
```

当然，`mysql_connect`朋友们使用隐含连接，所以从技术上讲，无论如何您都不需要传递它；尽管如此，这是一个很好的模式。

**最后但并非最不重要的**

学习如何使用 PDO 并陶醉在 OOP 的神奇世界中；-)

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-06-09T16:46:17.917

如果将变量设置为全局，则还需要在函数中将其设置为全局。在这种情况下：

```
$px_host = "localhost";

function dbQuery($database, $reqquery){
    global $px_host;
    if(!$connect = mysql_connect($px_host, $px_dbuser, $px_dbpass)){
        exit("Error - cannot connect to MySQL server - " . mysql_error());
    }

    if(!$database = mysql_select_db($database)){
        exit("Error - cannot select database - " . mysql_error());
    }

    if(!$query = mysql_query($reqquery)){
        exit("Error - query error.");
    }

    return $query;
} 
```

这应该可以解决这个问题。

# asp.net-mvc-3 - 使用 FilePathResult 将文件流返回到 mvc 中的 UI

> ID：10962706
> 
> 赞同：1
> 
> 时间：2012-06-09T16:40:58.823
> 
> 标签：asp.net-mvc-3

我在控制器中有一个动作

```
public ActionResult Download()    
{ 
    return File(FileStream, "application/octet-stream", fileName); 
} 
```

如果我想使用**FilePathresult**作为：

```
public FilePathResult Download()
{ 
    return File(FileStream, "application/octet-stream", fileName);
} 
```

我可以像这样调用`Download()`按钮的点击吗

```
@Html.ActionLink("FileDownload", "Download", new { file = item.FileName, GuID = item.DocumentGuID }) /text).Width(10); 
```

在第二种情况下，实施`Download()`也是正确的，即

```
public FilePathResult Download() 
```

?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T19:56:29.267

您`ActionLink`定义了要传递的参数，因此您需要将这些参数添加到您的操作中

```
@Html.ActionLink("FileDownload", "Download", new { file = item.FileName, GuID = item.DocumentGuID }) /text).Width(10); 
```

我不确定那里`/text.Width(10);`在做什么，但是正确形成`ActionLink`的参数还必须将 Html 属性定义为最后一个参数，只需传入`null`.

这是一个正确形成的示例`ActionLink`。

```
@Html.ActionLink("ActionName", "ControllerName", new { id = 10}, null) 
```

您的链接中有一个`file`和一个`GuID`参数，因此将它们作为参数添加到您的操作中。

```
public FilePathResult Download(string file, Guid GuID)
{ 
    return File(FileStream, "application/octet-stream", fileName);
} 
```

试一试，让我们知道会发生什么:-)

快乐编码！

# python - 从其他域向 GAE 发送 Post 请求

> ID：10962707
> 
> 赞同：1
> 
> 时间：2012-06-09T16:41:23.390
> 
> 标签：python, google-app-engine, post

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T16:46:40.860

尝试更改相对于您的环境的操作... GAE 对应用程序版本有不同的 url。

```
action="/upload" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T18:03:07.707

尝试在您的测试页面中仅使用 1 个表单，也许 IE 无法区分要提交的表单

# android - 设置查找变量的意图

> ID：10962710
> 
> 赞同：1
> 
> 时间：2012-06-09T16:41:51.990
> 
> 标签：android, android-intent

我对Android知之甚少，如果这个问题没有被正确提出，请原谅。

我正在尝试设置一个在选择 url 时打开我的应用程序的意图。我的代码如下所示：

```
 <intent-filter> 
            <data android:scheme="http" android:host="something.com" android:pathPattern=".*p=.*" />
            <action android:name="android.intent.action.VIEW" />
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter> 
```

它运行良好 - 但我只想在 URL 中有变量“p”时启动应用程序。含义：不启动[http://something.com/ok](http://something.com/ok) 但启动[http://something.com/ok/?p=100](http://something.com/ok/?p=100)

我想我需要添加 android:pathPattern 属性并寻找“p=”？有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T20:52:54.900

为此，您可以使用`pathPattern`意图过滤器的属性。 [（请参阅此处的参考资料。）](http://developer.android.com/guide/topics/manifest/data-element.html#path)

# iphone - 创建具有多个值的动态 NSMutableDictionary 查询

> ID：10962717
> 
> 赞同：2
> 
> 时间：2012-06-09T16:42:42.500
> 
> 标签：iphone, ios, templates, dynamic, nsmutabledictionary

我正在做一个项目，我希望能够处理一些模板类型的消息。该模板将包含以下内容：

```
"{{user1}} has just created an account" 
```

然后，我有一个数据映射，它将为您提供 NSMutableDictionary 中数据所在的位置：

```
"activity.message.status" 
```

然后我希望能够通过拆分该字符串来查询 NSMutableDictionary，使其变为：

```
[[[myDictionary objectForKey:@"activity"] objectForKey:@"message"] objectForKey:@"status"] 
```

我可以做一些东西，只要它是 3 弦，但有些可能或多或少。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T12:03:03.783

它实际上比将字符串拆分为键要容易得多。Apples Key-Value-Coding 正是您想要的。

```
[myDictionary valueForKeyPath:@"activity.message.status"]; 
```

> 键路径是一串点分隔键，用于指定要遍历的对象属性序列。序列中第一个键的属性是相对于接收者的，并且每个后续键都相对于前一个属性的值进行评估。
> 
> 例如，关键路径 address.street 将从接收对象中获取地址属性的值，然后确定相对于地址对象的街道属性。
> 
> [键值编码编程指南](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/KeyValueCoding/Articles/BasicPrinciples.html#//apple_ref/doc/uid/20002170-BAJEAIEE)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T16:55:11.037

你会做类似的事情，

```
NSArray *array = [@"activity.message.status" componentsSeperatedByString:@"."]; 
```

这将创建一个包含`{activity,message,status)`.

现在您有了可用于查询字典的数组。

```
[[[myDictionary objectForKey:[array objectAtIndex:0]] objectForKey:[array objectAtIndex:1]] objectForKey:[array objectAtIndex:2]]; 
```

这相当于：

```
[[[myDictionary objectForKey:@"activity"] objectForKey:@"message"] objectForKey:@"status"]; 
```

希望这可以帮助 ！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T17:01:08.307

从您的问题中我不清楚我们应该如何映射`user1`到`activity.message.status`. 现在我假设你的意思是模板可能包含一个字符串`"{{activity.message.status}}"`，你希望能够解析它。

这是一个迭代操作`NSMutableString`，可以循环直到找不到匹配项：

```
NSError *error = NULL;
NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:@"\\{\\{.+?\\}\\}"
                              options:NSRegularExpressionCaseInsensitive
                              error:&error];
NSRange matchRange = [regex rangeOfFirstMatchInString:string
                      options:0 range:NSMakeRange(0, [string length])];
NSRange keyPathRange = NSMakeRange(matchRange.location + 2, matchRange.length - 4);
NSString *keyPath = [string substringWithRange:keyPathRange];
NSString *newSubstring = [myDictionary valueForKeyPath:keyPath];
[string replaceCharactersInRange:matchRange withString:newSubstring]; 
```

我没有测试过这段代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T17:17:37.950

NSMutableDictionary 上的（递归......酷）类别方法怎么样：

```
- (void)setObject:(id)object forCompoundKey:(NSString *)compoundKey {

    NSArray *keys = [compoundKey componentsSeparatedByString:@"."];

    if ([keys count] == 1) {
        return [self setObject:object forKey:compoundKey];
    }

    // get the first component of the key
    NSString *key = [keys objectAtIndex:0];

    // build the remaining key with the remaining components
    NSRange nextKeyRange;
    nextKeyRange.location = 1;
    nextKeyRange.length = [keys count] - 1;
    NSArray nextKeys = [keys subarrayWithRange:nextRange];
    NSString *nextKey = [nextKeys componentsJoinedByString:@"."];

    NSMutableDictionary *nextDictionary = [NSMutableDictionary dictionary];
    [self addObject:nextDictionary forKey:key];

    // now the cool part... recursion
    [nextDictionary setObject:object forCompoundKey:nextKey];
} 
```

我没有对此进行测试，但它通过了快速桌面检查。objectForCompoundKey: 检索可以类似地编写。

# sql - 具有多个子查询时的相关子查询执行

> ID：10962726
> 
> 赞同：-1
> 
> 时间：2012-06-09T16:43:45.760
> 
> 标签：sql, oracle, oracle10g

当有多个子查询时，我对相关子查询执行有疑问。

当只有一个子查询时，我知道相关子查询的执行。但是，如果有多个我无法理解。

我参考了许多书籍和网站，但找不到合适的答案。

下面是两个查询。我知道 query1 是如何执行的，但 query2 是如何执行的？

查询1：

```
select e.ename, e.city 
  from emp1 e 
 where exists ( select f.ename 
                  from emp2 f  
                 where f.ename = ’ajay’ 
                   and e.city = f.city
                       ) 
```

查询2：

```
select e.ename 
  from employee e 
 where exists ( select ‘x’ 
                  from emp_company c 
                 where e.ename = c.ename  
                   and exists ( select ‘x’ 
                                  from company m 
                                 where c.cname = m.cname 
                                   and m.city = ’bombay’ 
                                       )
                       ) 
```

1.  在执行 query1 的第一步中`ename`，`city`考虑了员工表的第一行。
2.  在 query1 执行的第二步中，将主查询中考虑的城市与 的每一行进行比较`emp2`。
3.  将主查询中的城市与 emp2 的每一行进行比较；如果任何行满足将行 ename 添加到列表的条件。
4.  形成的列表返回到主查询。
5.  如果返回的列表不为空，则`exists`计算结果为 true。然后`emp1`表的`ename`，`city`添加输出。
6.  , from是从表的第二行中选择`ename`的。`city``emp1``emp1`

您能否像我解释 query1 一样解释 query2 的执行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T07:42:53.817

你的第二个查询说的是：如果有他们工作的公司退出（第一个子查询）并且如果孟买存在这样的公司（取自第一个子查询）（第二个子查询），请给我员工。使用以下可能更有效的 select 语句，您将获得相同的结果：

```
select e.ename 
from employee e,
  emp_company ec,
  company c 
where e.ename = ec.ename
  and ec.cname = c.cname
  and c.name = 'bombay' 
```

这是为了逻辑。如果您对*Oracle 先生*如何获取行的详细信息感兴趣，您可以查看**Query Explain Plan**。

# javascript - 在流式 CSS 中指定相对路径的正确方法是什么？

> ID：10962730
> 
> 赞同：2
> 
> 时间：2012-06-09T16:44:29.787
> 
> 标签：javascript, html, css, path

我在 Firefox 中工作，相对路径不起作用。

需要注意的是，我使用 AJAX 流式传输我的 .css 文件并将其动态添加到 DOM。

另一个需要注意的是，我的网站是通过以下两种方式之一进入的：

```
www.host.com (use this for production) 
```

或者

```
www.host.com/dev/ (use this for dev) 
```

图片在这里：

```
www.host.com/host/images 
```

或者

```
www.host.com/dev/host/images 
```

取决于您如何进入该网站。

我可以发布任何需要的信息并测试解决方案。

我正在使用

```
../images/name.jpg 
```

但浏览器不知何故将此用于：

```
hosts.com/images/name.jpg 
```

这不存在。

这是一个关于相对路径和正确实施的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T16:58:44.037

**绝对路径 URL**

之所以称为绝对路径，是因为它们指的是非常具体的位置，包括域名。Web 元素的绝对路径通常也称为 URL。例如，这个网页的绝对路径是：

[在流式 CSS 中指定相对路径的正确方法是什么？](https://stackoverflow.com/questions/10962730/what-is-the-correct-way-to-specify-relative-paths-in-css/10962788#10962788)

您通常使用域的绝对路径来指向与您自己的域不同的域中的 Web 元素。例如，如果我想链接到谷歌，那将是[......](http://www.google.com)

如果您指的是与您所在域相同的 Web 元素，则无需在链接路径中使用域名。只需省略域，但请确保在域名后包含第一个斜杠 (/)。

在大多数网站上使用不带域名的绝对路径是个好主意。这种格式可确保无论您将页面放在何处，链接或图像都可以使用。这似乎是使用较长链接的愚蠢理由，但如果您在站点上的多个页面和目录之间共享代码，使用绝对路径将加快您的维护速度。

**相对路径 URL**

相对路径会根据链接所在的页面而变化。使用相对路径创建链接有几个规则：

*   与页面在同一目录中的链接没有列出路径信息的文件名
*   列出的子目录没有任何前面的斜杠每周/文件名
*   链接一个目录被列为 ../filename

如何确定相对路径：

1.  确定您正在编辑的页面的位置。这篇文章位于我网站上的/library/weekly 文件夹中。
2.  确定要链接到的页面或图像的位置。初学者资源中心位于：/library/beginning/
3.  比较位置并决定如何指向它在本文中，我需要上一级目录（to/library），然后返回到开始目录
4.  使用上面列出的规则编写链接：...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T16:52:06.410

相对路径会根据链接所在的页面而变化。使用相对路径创建链接有几个规则：

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T17:16:44.570

我需要对此进行测试，但是对于动态插入的 CSS，所有路径都相对于根目录或 www.host.com ......这将解析为......这实际上是说所有路径实际上都是绝对的......这是我在 FireFox 中看到的行为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T16:46:31.520

相对路径总是相对于 CSS 位置，而不是引用 CSS 文件的网页位置。那么问题来了，CSS 文件的起始位置是什么？如果您使所有路径都相对于它，它应该适用于您的生产和开发 URL。

# mysql - Tomcat停止响应并且无法关闭

> ID：10962733
> 
> 赞同：0
> 
> 时间：2012-06-09T16:44:59.930
> 
> 标签：mysql, tomcat

在过去的四天里，我在生产服务器上遇到了一个问题，Tomcat 停止响应，当我尝试通过shutdow.sh 关闭它时，tomcat 进程仍然存在。我将不得不终止该进程并重新启动它。在tomcat崩溃并停止响应之前直接记录下面的堆栈。我做了很多研究，但还没有解决这个问题。

任何帮助表示赞赏

有两个严重的 Web 应用程序错误

```
Jun 9, 2012 4:50:08 PM org.apache.catalina.loader.WebappClassLoader clearReferencesJdbc
SEVERE: The web application [/beta] registered the JDBC driver [com.mysql.jdbc.Driver] but failed to unregister it when the web application was stopped. To prevent a memory leak, the JDBC Driver has been forcibly unregistered.
Jun 9, 2012 4:50:08 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/beta] appears to have started a thread named [MultiThreadedHttpConnectionManager cleanup] but has failed to stop it. This is very likely to create a memory leak. 
```

和一个 MySQL 错误

```
INFO: Illegal access: this web application instance has been stopped already.  Could not load com.mysql.jdbc.SQLError.  The eventual following stack trace is caused by an error thrown for debugging purposes as well as to attempt to terminate the thread which caused the illegal access, and has no functional impact.
java.lang.IllegalStateException
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1587)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1546)
    at com.mysql.jdbc.MysqlIO.send(MysqlIO.java:3358)
    at com.mysql.jdbc.MysqlIO.quit(MysqlIO.java:1695)
    at com.mysql.jdbc.ConnectionImpl.realClose(ConnectionImpl.java:4388)
    at com.mysql.jdbc.ConnectionImpl.cleanup(ConnectionImpl.java:1368)
    at com.mysql.jdbc.ConnectionImpl.finalize(ConnectionImpl.java:2737)
    at java.lang.ref.Finalizer.invokeFinalizeMethod(Native Method)
    at java.lang.ref.Finalizer.runFinalizer(Finalizer.java:83)
    at java.lang.ref.Finalizer.access$100(Finalizer.java:14)
    at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:160) 
```

下面的全栈

```
INFO: Destroying Spring FrameworkServlet 'springMvcServlet'
Jun 9, 2012 4:50:08 PM org.apache.catalina.core.ApplicationContext log
INFO: Closing Spring root WebApplicationContext
Jun 9, 2012 4:50:08 PM org.apache.catalina.loader.WebappClassLoader clearReferencesJdbc
SEVERE: The web application [/beta] registered the JDBC driver [com.mysql.jdbc.Driver] but failed to unregister it when the web application was stopped. To prevent a memory leak, the JDBC Driver has been forcibly unregistered.
Jun 9, 2012 4:50:08 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/beta] appears to have started a thread named [MultiThreadedHttpConnectionManager cleanup] but has failed to stop it. This is very likely to create a memory leak.
Jun 9, 2012 4:50:09 PM org.apache.catalina.loader.WebappClassLoader validateJarFile
INFO: validateJarFile(/home/bratecp/public_html/beta/WEB-INF/lib/ImageEditor.jar) - jar not loaded. See Servlet Spec 2.3, section 9.7.2\. Offending class: javax/servlet/Servlet.class
Jun 9, 2012 4:50:09 PM org.apache.catalina.loader.WebappClassLoader validateJarFile
INFO: validateJarFile(/home/bratecp/public_html/beta/WEB-INF/lib/gwt-user.jar) - jar not loaded. See Servlet Spec 2.3, section 9.7.2\. Offending class: javax/servlet/Servlet.class
Jun 9, 2012 4:50:09 PM org.apache.catalina.core.ApplicationContext log
INFO: Initializing Spring root WebApplicationContext
Jun 9, 2012 4:50:11 PM org.apache.catalina.loader.WebappClassLoader loadClass
INFO: Illegal access: this web application instance has been stopped already.  Could not load com.mysql.jdbc.SQLError.  The eventual following stack trace is caused by an error thrown for debugging purposes as well as to attempt to terminate the thread which caused the illegal access, and has no functional impact.
java.lang.IllegalStateException
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1587)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1546)
    at com.mysql.jdbc.MysqlIO.send(MysqlIO.java:3358)
    at com.mysql.jdbc.MysqlIO.quit(MysqlIO.java:1695)
    at com.mysql.jdbc.ConnectionImpl.realClose(ConnectionImpl.java:4388)
    at com.mysql.jdbc.ConnectionImpl.cleanup(ConnectionImpl.java:1368)
    at com.mysql.jdbc.ConnectionImpl.finalize(ConnectionImpl.java:2737)
    at java.lang.ref.Finalizer.invokeFinalizeMethod(Native Method)
    at java.lang.ref.Finalizer.runFinalizer(Finalizer.java:83)
    at java.lang.ref.Finalizer.access$100(Finalizer.java:14)
    at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:160)
Jun 9, 2012 4:58:44 PM org.apache.catalina.core.AprLifecycleListener init
INFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: /usr/local/jdk1.6.0_29/jre/lib/amd64/server:/usr/local/jdk1.6.0_29/jre/lib/amd64:/usr/local/jdk1.6.0_29/jre/../lib/amd64:/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib
Jun 9, 2012 4:58:44 PM org.apache.catalina.startup.SetAllPropertiesRule begin
WARNING: [SetAllPropertiesRule]{Server/Service/Connector} Setting property 'compression' to 'on' did not find a matching property.
Jun 9, 2012 4:58:44 PM org.apache.catalina.startup.SetAllPropertiesRule begin
WARNING: [SetAllPropertiesRule]{Server/Service/Connector} Setting property 'compressionMinSize' to '2048' did not find a matching property.
Jun 9, 2012 4:58:44 PM org.apache.catalina.startup.SetAllPropertiesRule begin
WARNING: [SetAllPropertiesRule]{Server/Service/Connector} Setting property 'noCompressionUserAgents' to 'gozilla, traviata' did not find a matching property.
Jun 9, 2012 4:58:44 PM org.apache.catalina.startup.SetAllPropertiesRule begin
WARNING: [SetAllPropertiesRule]{Server/Service/Connector} Setting property 'compressableMimeType' to 'text/xml,text/plain,application/json,application/javascript,text/css' did not find a matching property.
Jun 9, 2012 4:58:44 PM org.apache.tomcat.util.digester.SetPropertiesRule begin
WARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'debug' to '1' did not find a matching property.
Jun 9, 2012 4:58:44 PM org.apache.tomcat.util.digester.SetPropertiesRule begin
WARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'debug' to '0' did not find a matching property.
Jun 9, 2012 4:58:44 PM org.apache.tomcat.util.digester.SetPropertiesRule begin
WARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'debug' to '1' did not find a matching property.
Jun 9, 2012 4:58:45 PM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["http-bio-8080"]
Jun 9, 2012 4:58:45 PM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["ajp-bio-8009"]
Jun 9, 2012 4:58:45 PM org.apache.catalina.startup.Catalina load 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T17:30:09.093

至少有两个问题同时出现：

1.  您正在注册一个 JDBC 驱动程序，该驱动程序是从您的 web 应用程序的 WEB-INF/lib 目录中加载的，并且在您的 web 应用程序关闭时未能取消注册该驱动程序。您可以使用`java.sql.DriverManager.deregisterDriver()`从`ServletContextListener`.

2.  您（可能）有一个非守护线程比您的 webapp 寿命更长。确定这里发生了什么的唯一方法是进行线程转储以找出哪个线程仍然处于活动状态（在您运行 shutdown.sh 并等待大约 5 秒以使一切稳定下来之后）以及它可能来自何处。基本上，当您的 webapp 关闭时，您在 webapp 中启动线程的任何地方都需要有一个对称的停止线程。请记住，某些操作会在您没有意识到的情况下启动线程（例如，创建`TimerTask`、执行某些与 AWT 相关的操作等）。

您可能希望解决这两个问题以提高应用程序服务器的稳定性。

在上面的堆栈跟踪中，它是一个连接终结器，它试图“真正”关闭与数据库的连接。我想知道您是否在 webapp 关闭之前没有正确关闭 Connection 对象（或连接池），因此 Connection 终结器在它们实际实现其目标之后运行（在 ClassLoader 死后）。

# java - 从 Socket 多次打开读/写流

> ID：10962736
> 
> 赞同：4
> 
> 时间：2012-06-09T16:45:30.053
> 
> 标签：java, sockets

在我`ServerSocket`监听传入连接的类中，以下是代码：

```
while(isRunning)
{
    try
    {
        Socket s = mysocketserver.accept();
        acknowledgeClient(s);
        new ClientHandler(s).start(); //Start new thread to serve the client, and get back to accept new connections.
    }
    catch(Exception ex)
    {
        ex.printStackTrace();
    }
} 
```

以下是`acknowledgeClient(Socket s)`代码。

```
ObjectInputStream in = new ObjectInputStream(s.getInputStream);
ObjectOutputStream out = new ObjectOutputStream(s.getOutStream);
String msg = in.readObject().toString();
System.out.println(msg+" is Connected"); //Show who's connected
out.writeObject("success"); //Respond with success.
in.close();
out.close(); 
```

的`run()`方法`ClientHandler`。

```
try
{
    in = new ObjectInputStream(client.getInputStream());
    out = new ObjectOutputstream(client.getOutputStream());
    String msg = "";
    while(!msg.equalsIgnoreCase("bye"))
    {
        msg = in.readObject().toString();
        System.out.println("Client Says - "+msg);
        out.writeObject("success");
    }
    in.close();
    out.close();
}
catch(Exception ex)
{
    ex.printStackTrace();
} 
```

以下是客户端程序如何与此 Echo Server 通信的方式。

```
try
{
    int count = 10;
    client = new Socket("localhost",8666);
    in = new ObjectInputStream(client.getInputStream());
    out = new ObjectOutputstream(client.getOutputStream());
    out.writeObject("Foo");
    System.out.println("Connection Status : "+in.readObject().toString());
    while(count>0)
    {
        out.writeObject("Hello!");
        String resp = in.readObject().toString(); //Getting EOFException here.
        System.out.println("Sent with :"+resp);
        count--;
        Thread.sleep(1000);
    }
    out.close();
    in.close();
    client.close();
}
catch(Exception ex)
{
    ex.printStackTrace();
} 
```

您可能已经注意到，在连接后确认客户端后，我关闭读/写流，然后从为客户端提供服务的新线程中，我再次打开流，并从服务器读/写已连接的套接字已启动，但是一旦我尝试读取服务器对`Hello!`客户端发送的响应，它就会崩溃`EOFException`而不是`success`.

我知道 EOF 发生的原因，但不知道为什么会在这里发生，我没有尝试读取其流中没有任何内容的套接字（它应该`success`由服务器编写）。

`Hello!`客户端在服务器端打印并写入`success`响应之前尝试读取套接字是否为时过早？

**PS：我知道通过放置这么多代码来提出问题并不是一个好方法，我们希望在这里得到问题的答案并理解它，而不是让别人解决我们的问题并逃脱。所以，我提供了这么多代码来展示问题的各个方面。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T16:59:02.943

我研究了 ObjectInputStream 的源代码，似乎对原始输入流的引用`s.getInputStream()`存储在 ObjectInputStream 中。

当您关闭 ObjectInputStream 时，`s.getInputStream()`也会关闭。

输入流一旦关闭，就无法再次打开。因此，您会得到一个 EOFException，这表明您处于流的末尾（因为无法再次打开流）。

你应该做这样的事情来承认客户。

在 ClientHandler 的 run() 方法中：

```
try {
    // acknowledge client
    ObjectInputStream in = new ObjectInputStream(s.getInputStream());
    ObjectOutputStream out = new ObjectOutputStream(s.getOutStream());
    String msg = in.readObject().toString();
    System.out.println(msg+" is Connected"); //Show who's connected
    out.writeObject("success"); //Respond with success.
    // end acknowledge client

    String msg = "";
    while(!msg.equalsIgnoreCase("bye"))
    {
        msg = in.readObject().toString();
        System.out.println("Client Says - "+msg);
        out.writeObject("success");
    }
    in.close();
    out.close();
}
catch(Exception ex)
{
    ex.printStackTrace();
} 
```

如果要在单独的方法中隔离确认代码，只需确保在不关闭流的情况下保持对同一 ObjectInputStream 的正确引用，然后传递引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T16:53:33.663

> 我再次打开流，并从服务器开始从连接的套接字读取/写入，

流关闭后，您将无法再次打开它。实际上，您根本不能以这种方式在同一个流上使用两个 Object 流。

相反，您应该为输入和输出创建一次且仅一次的对象流，并且在完成之前不要关闭它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T17:05:27.343

看看这个程序，我写它是为了理解多个客户端和服务器的通信，你的问题在这个程序中得到了回答。

客户端代码

```
public class ClientWala {

    public static void main(String[] args) throws Exception{

        Boolean b = true;
    Socket s = new Socket("127.0.0.1", 4444);

    System.out.println("connected: "+s.isConnected());

    OutputStream output = s.getOutputStream();
    PrintWriter pw = new PrintWriter(output,true);

    // to write data to server
    while(b){

        if (!b){

             System.exit(0);
        }

        else {
            pw.write(new Scanner(System.in).nextLine());
        }
    }

    // to read data from server
    InputStream input   = s.getInputStream();
    InputStreamReader isr = new InputStreamReader(input);
    BufferedReader br = new BufferedReader(isr);
    String data = null;

    while ((data = br.readLine())!=null){

        // Print it using sysout, or do whatever you want with the incoming data from server

    }

    }
} 
```

服务器端代码

```
public class ServerTest {

    ServerSocket s;

    public void go() {

        try {
            s = new ServerSocket(44457);

            while (true) {

                Socket incoming = s.accept();
                Thread t = new Thread(new MyCon(incoming));
                t.start();
            }
        } catch (IOException e) {

            e.printStackTrace();
        }

    }

    class MyCon implements Runnable {

        Socket incoming;

        public MyCon(Socket incoming) {

            this.incoming = incoming;
        }

        @Override
        public void run() {

            try {
                PrintWriter pw = new PrintWriter(incoming.getOutputStream(),
                        true);
                InputStreamReader isr = new InputStreamReader(
                        incoming.getInputStream());
                BufferedReader br = new BufferedReader(isr);
                String inp = null;

                boolean isDone = true;

                System.out.println("TYPE : BYE");
                System.out.println();
                while (isDone && ((inp = br.readLine()) != null)) {

                    System.out.println(inp);
                    if (inp.trim().equals("BYE")) {
                        System.out
                                .println("THANKS FOR CONNECTING...Bye for now");
                        isDone = false;
                        s.close();
                    }

                }
            } catch (IOException e) {
                // TODO Auto-generated catch block
                try {
                    s.close();
                } catch (IOException e1) {
                    // TODO Auto-generated catch block
                    e1.printStackTrace();
                }
                e.printStackTrace();
            }

        }

    }

    public static void main(String[] args) {

        new ServerTest().go();

    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T22:39:35.343

关闭套接字流周围的任何输入流或输出流或读取器或写入器会关闭套接字，并暗示其他流、读取器和写入器。

在套接字的生命周期内使用相同的流、读取器和写入器。

# windows - VB.NET 上的唯一硬件 ID

> ID：10962743
> 
> 赞同：1
> 
> 时间：2012-06-09T16:46:12.533
> 
> 标签：windows, vb.net

我有一个我想通过要求我的用户注册来保护的应用程序。我还想确保它们不能安装在两台以上的机器上。为此，我需要知道在哪里可以找到唯一的硬件 ID 号，并在注册码中使用它。我只需要知道如何使用代码获取该号码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T18:58:18.913

正如其他人指出的那样，确实没有唯一的硬件 ID 这样的东西。其他人在你之前尝试过使用各种东西（例如主板序列号，CPU序列号，HDD序列号，MAC地址）或这些东西的组合，但他们都以自己的方式出现问题。序列号并非总是由所有驱动程序返回，即使它们返回，如果硬件升级或更换，它们也可以轻松更改。此外，从技术上讲，序列号可以由不同的供应商重复，尤其是在虚拟机上。MAC 地址是有问题的，因为通常有多个并且它们经常更改，尤其是使用 VPN 时。此外，MAC 地址通常由使用相同 VPN 软件的多台机器复制。您可以使用 Windows 安装序列号，但这也可以随着操作系统升级而复制和更改。简单的答案是，如果可能的话，不要。如果你必须做这样的事情，最好有一种方法，通过将加密的 GUID 写入硬盘驱动器上的某个位置，以编程方式标记每台安装了你的软件的计算机，并为你的支持人员提供一个简单的机制来重新标记任何计算机随意。

# javascript - 如何按度数更改对象的 x 和 y 坐标？

> ID：10962747
> 
> 赞同：-1
> 
> 时间：2012-06-09T16:46:22.717
> 
> 标签：javascript, math, object, expression, coordinates

我正在用 HTML5 为我的画布处理一些坐标函数，我想制作一个可以按度移动对象的函数。
我的梦想是制作一个像这样工作的函数：

```
box.x=10;
box.y=10;
// now the box has the coordinates (10,10)
moveTheBoxWithThisAmountOfDistance=10;
degreesToMoveTheBox=90;
box.moveByDegrees(moveTheBoxWithThisAmountOfDistance,degreesToMoveTheBox);
// now the box.x would be 20 and box.y wouldn't be changed because
// we only move it to the right (directional 90 degrees) 
```

我希望这有任何意义！
所以我的问题是：
当我必须将度数转换为坐标时，数学表达式如何？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T16:51:28.267

使用`sin`and`cos`将角度和距离转换为坐标：

```
function moveByDegrees(distance, angle) {
  var rad = angle * Math.pi / 180;
  this.x += Math.cos(rad) * distance;
  this.y += Math.sin(rad) * distance;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T16:50:26.443

就是这样：[http](http://en.wikipedia.org/wiki/Rotation_matrix) ://en.wikipedia.org/wiki/Rotation_matrix ，所有的数学都被描述了:)

另请注意，如果您需要多次连续旋转（即您进行连续动画），最好从初始值重新计算 x' 和 y' 而不仅仅是以前的值。不这样做会导致舍入误差累积，并且经过数千次旋转后，结果会变得过于粗糙。

# ios - AdBannerView & popover：只是隐藏？

> ID：10962753
> 
> 赞同：0
> 
> 时间：2012-06-09T16:46:54.907
> 
> 标签：ios, cocoa-touch, uipopovercontroller, iad, adbannerview

在我的 iPad 应用程序中，我有一个 AdBannerView，我需要呈现一个弹出框。

如果我这样做，它会抛出警告说横幅可能被隐藏：事实上，即使横幅实际上没有隐藏，用户也不能点击它，因为点击会被弹出窗口拦截（所以点击会有关闭弹出框的效果，而不是打开广告）。

事实证明，将显示弹出框的广告隐藏 b4，并在弹出框消失后再次显示，可以消除警告。（当然可以，广告不再可见！）

但是，这是如何工作的？如果我隐藏横幅然后再次显示，我还能获得收入吗？

有没有更好的解决方案来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T16:51:12.217

我会忽略警告。如果广告完全可见，那应该没问题。

# matlab - MATLAB中的ROC曲线垂直平均值

> ID：10962755
> 
> 赞同：1
> 
> 时间：2012-06-09T16:47:33.997
> 
> 标签：matlab, average, roc

有没有办法在[MATLAB](http://en.wikipedia.org/wiki/MATLAB)中计算几条[ROC 曲线的垂直平均值（](http://en.wikipedia.org/wiki/Receiver_operating_characteristic) [http://vicos.fri.uni-lj.si/data/vprsistemi/ROCintro.pdf](http://vicos.fri.uni-lj.si/data/vprsistemi/ROCintro.pdf) ） ？我在 MATLAB 指南中发现*perfcurve*可以做到这一点，但我不知道如何使用它。

 ** * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T17:18:23.777

您可以将检测数组的概率连接成一个矩阵，然后取它们的平均值。假设您的误报概率保存在行向量中`PFA`，并且您的检测概率值保存在行向量`PD1`, `PD2`, ... 中：

```
PDMatrix = [PD1; PD2; ...];
PDMean = mean(PDMatrix, 1); 
```

这假设您的 ROC 曲线都共享相同的 PFA 值。如果不是这种情况，那么您可以创建一个通用 PFA 数组并使用 interp1 在平均之前重新采样您的 PD 数组。例如，如果您对从 10^-6 到“接近 1”的对数间隔的 PFA 值感兴趣，并且您的 PFA/PD 对具有在此范围内插值的数据，您可以执行类似的操作

```
PFAResampled = logspace(-6, -.1, 1000);
PD1Resampled = interp1(PFA1, PD1, PFAResampled);
PD2Resampled = interp1(PFA2, PD2, PFAResampled); 
```

之后，您可以连接并取平均值，如上所示。*

# java - 通过 CD 安装 java 程序

> ID：10962758
> 
> 赞同：2
> 
> 时间：2012-06-09T16:48:09.057
> 
> 标签：java, deployment, installation, software-distribution, cd

我有一个要在 CD 上分发的程序（java jar 文件）。我的朋友告诉我，有免费/开源的 CD 安装程序可以自动将您的程序安装到客户的计算机上。

现在我似乎在 Google 上找不到这个。那么有没有你推荐我可以使用的 CD 安装程序（所以我不需要自己编写一个）。

大纲：

我的程序由类文件、声音文件、源文件（我是开源的）和图像（打包成 jar 文件）组成。

我只需要安装程序就可以在 Windows 计算机上工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T16:50:42.640

我认为[IzPack](http://izpack.org/)做了类似的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-09T17:10:05.740

您可以查看 Java WebStart，它在 Java 6 中得到了增强，允许“launch-from-cd-and-install-to-harddrive”，这意味着它可以作为一个非常简单的安装程序工作。

它需要一个已经存在的 JVM。您也可以将可再发行的 JRE 放在 cd 上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T17:44:42.437

[Launch4J](http://launch4j.sourceforge.net/index.html)是我用作安装程序的工具。它真的很轻巧，并且有一个很好的 GUI，让开发人员的事情变得简单（我选择不使用 IzPack 的一个原因）。

**它使开发人员和用户的事情变得非常简单。**

您的 jar 文件包含在 exe 启动器中。如果未检测到最新的 JRE，则使用捆绑的 JRE 或提示用户通过 java.com/download 下载

真的，我不能要求任何更简单/更好的东西。尽管您可能会从 IzPack 中获得更多功能，但如果您想要快速完成日常开发人员所需的一切，请选择 Launch4J。

PS他们的启动画面选项是一个不错的奖励:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-10T22:28:32.907

在遇到无数最终问题后，我使用[Inno Setup](http://www.jrsoftware.org/isinfo.php)完成了这项工作。非常快速且易于使用。创建一个类似于您在流行程序中看到的安装程序。使您（和用户）能够创建桌面快捷方式、QuickLaunch 图标和启动文件夹。允许您添加许可证信息等。非常简单直观的界面，我不必阅读任何文档！

一个大骗局：只为 Windows 制作安装程序。这符合我的要求，但可能不适用于所有人。

# ruby-on-rails - custom_require.rb:36:in `require': 193: %1 不是有效的 Win32 应用程序

> ID：10962759
> 
> 赞同：1
> 
> 时间：2012-06-09T16:48:11.153
> 
> 标签：ruby-on-rails, ruby

我刚刚使用 Rails 安装程序安装了 rails。

当我运行以下代码时：

```
rails new blog 
```

我收到以下错误：

```
F:/dev/ruby/RailsInstaller/Ruby1.9.3/lib/ruby/site_ruby/1.9.1/rubygems/custom_re
quire.rb:36:in `require': 193: %1 is not a valid Win32 application.   - F:/dev/r
uby/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/i386-mingw32/digest/md5.so (LoadErro
r)
        from F:/dev/ruby/RailsInstaller/Ruby1.9.3/lib/ruby/site_ruby/1.9.1/rubyg
ems/custom_require.rb:36:in `require'
        from F:/dev/ruby/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railt
ies-3.2.1/lib/rails/generators/app_base.rb:1:in `<top (required)>'
        from F:/dev/ruby/RailsInstaller/Ruby1.9.3/lib/ruby/site_ruby/1.9.1/rubyg
ems/custom_require.rb:36:in `require'
        from F:/dev/ruby/RailsInstaller/Ruby1.9.3/lib/ruby/site_ruby/1.9.1/rubyg
ems/custom_require.rb:36:in `require'
        from F:/dev/ruby/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railt
ies-3.2.1/lib/rails/generators/rails/app/app_generator.rb:1:in `<top (required)>
'
        from F:/dev/ruby/RailsInstaller/Ruby1.9.3/lib/ruby/site_ruby/1.9.1/rubyg
ems/custom_require.rb:36:in `require'
        from F:/dev/ruby/RailsInstaller/Ruby1.9.3/lib/ruby/site_ruby/1.9.1/rubyg
ems/custom_require.rb:36:in `require'
        from F:/dev/ruby/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railt
ies-3.2.1/lib/rails/commands/application.rb:24:in `<top (required)>'
        from F:/dev/ruby/RailsInstaller/Ruby1.9.3/lib/ruby/site_ruby/1.9.1/rubyg
ems/custom_require.rb:36:in `require'
        from F:/dev/ruby/RailsInstaller/Ruby1.9.3/lib/ruby/site_ruby/1.9.1/rubyg
ems/custom_require.rb:36:in `require'
        from F:/dev/ruby/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railt
ies-3.2.1/lib/rails/cli.rb:15:in `<top (required)>'
        from F:/dev/ruby/RailsInstaller/Ruby1.9.3/lib/ruby/site_ruby/1.9.1/rubyg
ems/custom_require.rb:36:in `require'
        from F:/dev/ruby/RailsInstaller/Ruby1.9.3/lib/ruby/site_ruby/1.9.1/rubyg
ems/custom_require.rb:36:in `require'
        from F:/dev/ruby/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railt
ies-3.2.1/bin/rails:7:in `<top (required)>'
        from F:/dev/ruby/RailsInstaller/Ruby1.9.3/bin/rails:19:in `load'
        from F:/dev/ruby/RailsInstaller/Ruby1.9.3/bin/rails:19:in `<main>' 
```

我在 ruby​​193 和 rails 3.2.1 上运行

关于如何解决这个问题的任何想法？

# c# - HttpChannelRequest WaitForReply 上的 WCF 代理 ProcessGetResponseWebException

> ID：10962761
> 
> 赞同：4
> 
> 时间：2012-06-09T16:48:26.967
> 
> 标签：c#, asp.net, wcf, entity-framework, exception-handling

### 服务合约

```
[OperationContract]
List<Campaign> AttainCampaigns(); 
```

### 直接实例化对象时工作

```
public List<Campaign> AttainCampaigns()
{
    var campaign1 = new Campaign { Id = "x", Name = "namex" };
    var campaign2 = new Campaign { Id = "y", Name = "namey" };
    var campaigns = new List<Campaign> { campaign1, campaign2 };
    return campaigns;
} 
```

### 如果来自实体框架的等效对象，则在客户端上引发错误

```
// Different implementation getting the campaign objects from database
private List<Campaign> RetrieveCampaigns()
{
    return Global.Repositor.Campaigns.Select(c => c).ToList();;
}

public static EntityRepositor Repositor
{
    get
    {
        if (_entityRepositor == null)
            _entityRepositor = new EntityRepositor();
        return _entityRepositor;
    }
}

public class EntityRepositor : DbContext
{
    public DbSet<Campaign> Campaigns { get; set; }
} 
```

### 服务器上没有明显的错误

*   奇怪的是，当我将调试器附加到服务器端的进程时，我没有看到任何异常——实体框架似乎很好地实例化了底层 SQL Express 数据库中的对象
*   我什至没有在输出中看到任何第一次机会异常

### 大约 15 秒后 WCF 测试客户端异常，然后立即

*   我第一次调用`AttainCampaigns()`客户端等待/处理大约 15 秒，然后在下面显示异常
*   即使我删除服务并重新连接，所有后续调用都会立即显示错误

_我的猜测是数据库调用本身很好，但是耗时太长，所以我需要在服务器或客户端配置中增加某些超时值？如果那是正确的树，它们可能是哪些超时？

```
An error occurred while receiving the HTTP response to http://example.com/Service.svc. This could be due to the service endpoint binding not using the HTTP protocol. This could also be due to an HTTP request context being aborted by the server (possibly due to the service shutting down). See server logs for more details.
Server stack trace: 
   at System.ServiceModel.Channels.HttpChannelUtilities.ProcessGetResponseWebException(WebException webException, HttpWebRequest request, HttpAbortReason abortReason)
   at System.ServiceModel.Channels.HttpChannelFactory`1.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout)
   at System.ServiceModel.Channels.RequestChannel.Request(Message message, TimeSpan timeout)
   at System.ServiceModel.Dispatcher.RequestChannelBinder.Request(Message message, TimeSpan timeout)
   at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout)
   at System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation)
   at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message)
Exception rethrown at [0]: 
   at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)
   at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type)
   at IBacker.AttainCampaigns()
   at BackerClient.AttainCampaigns()
Inner Exception:
The underlying connection was closed: An unexpected error occurred on a receive.
   at System.Net.HttpWebRequest.GetResponse()
   at System.ServiceModel.Channels.HttpChannelFactory`1.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout)
Inner Exception:
Unable to read data from the transport connection: An existing connection was forcibly closed by the remote host.
   at System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size)
   at System.Net.PooledStream.Read(Byte[] buffer, Int32 offset, Int32 size)
   at System.Net.Connection.SyncRead(HttpWebRequest request, Boolean userRetrievedStream, Boolean probeRead)
Inner Exception:
An existing connection was forcibly closed by the remote host
   at System.Net.Sockets.Socket.Receive(Byte[] buffer, Int32 offset, Int32 size, SocketFlags socketFlags)
   at System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size) 
```

### 服务器 - perSession ServiceContract & Web.config

```
[ServiceBehavior(InstanceContextMode = InstanceContextMode.PerSession, 
ConcurrencyMode = ConcurrencyMode.Single)] 
```

&

```
 <system.web>
    <compilation targetFramework="4.5" />
  </system.web>
  <system.serviceModel>     
    <bindings>
      <wsHttpBinding>
        <binding name="wsHttp" allowCookies="true">
          <security mode="None" />
        </binding>
      </wsHttpBinding>
    </bindings>
    <services>
      <service name="MyNameSpace.MyImplementation">
        <endpoint address="" binding="wsHttpBinding" bindingConfiguration="wsHttp"
          name="wsHttpEp" contract="MyNameSpace.IServiceContract" />
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="true" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true" />
  </system.serviceModel>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true" />
    <directoryBrowse enabled="true" />
  </system.webServer>
  <entityFramework>
    <defaultConnectionFactory type="System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework" />
  </entityFramework> 
```

### 客户端 - ChannelFactory & App.config

```
_channelFactory = new ChannelFactory<T>("wsHttpEp");
Service = _channelFactory.CreateChannel(); 
```

&

```
 <system.serviceModel>
    <bindings>
      <wsHttpBinding>
        <binding name="wsHttp" allowCookies="true">
          <security mode="None" />
        </binding>
      </wsHttpBinding>
    </bindings>
    <client>
      <endpoint address="http://example.com/Service.svc" contract="MyNameSpace.IServiceContract"
                binding="wsHttpBinding" bindingConfiguration="wsHttp" name="wsHttpEp" />
    </client>
  </system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T18:14:30.267

您需要更新服务器配置文件才能在客户端查看异常详细信息：

```
<serviceBehaviors>
   <behavior name="EmployeeManager_Behavior">
      <serviceDebug includeExceptionDetailInFaults="true"/>
      <serviceMetadata httpGetEnabled="true" />
   </behavior>
</serviceBehaviors> 
```

请在启用该选项的情况下发布更新的异常详细信息。

查看您的代码，我可能会给您一个建议。不要存储`DbContext`是静态变量。EntityFramework 做了很多缓存，所以上下文实例化没有任何成本。静态 var 可以由某人处理，而`Null`check 不会捕捉到这一点。

# blackberry - 在黑莓中创建对话框

> ID：10962766
> 
> 赞同：2
> 
> 时间：2012-06-09T16:49:05.250
> 
> 标签：blackberry, screen, customization, textfield

![在此处输入图像描述](../Images/0dce8d0c4d4c1696c6b31ab0c43fa2af.png) 嗨，我想创建一个登录屏幕，其中包含用户名和密码以及登录按钮但是当用户未能在用户名或密码的 TextField 内输入正确信息时，应该会从角落弹出一个像图像聊天对话框这样的弹出窗口TextField 的右侧显示适当的消息如何实现此自定义？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T07:21:50.390

我给你一个简单的方法。如果它对您的问题不完美，您只需忽略此答案。

在这里，我做了如下的逻辑。我给了你两个按钮 1）登录 2）删除

我想你知道如何验证你的文本字段是对还是错；保留一个 if 条件，如果正确则写下你的逻辑，否则不需要任何字段，否则你有三个条件

1) id 错误 2) 密码错误或 3) 两者都错误

根据两个条件，您可以在上面的文本字段上添加特定的工具提示框。

我也为错误条件和删除条件提供样本

使其成为您的要求

**资源 ：**

背景需要 chat.png 图片![在此处输入图像描述](../Images/4f02c5c0b3b6f74d5753c7820e711af4.png)

**示例代码：**

```
package mypackage;

import net.rim.device.api.system.Bitmap;
import net.rim.device.api.ui.Field;
import net.rim.device.api.ui.FieldChangeListener;
import net.rim.device.api.ui.UiApplication;
import net.rim.device.api.ui.XYEdges;
import net.rim.device.api.ui.component.BasicEditField;
import net.rim.device.api.ui.component.ButtonField;
import net.rim.device.api.ui.container.MainScreen;
import net.rim.device.api.ui.container.VerticalFieldManager;
import net.rim.device.api.ui.decor.Border;
import net.rim.device.api.ui.decor.BorderFactory;

/**
 * A class extending the MainScreen class, which provides default standard
 * behavior for BlackBerry GUI applications.
 */
public final class MyScreen extends MainScreen implements FieldChangeListener
{
    /**
     * Creates a new MyScreen object
     */
    private BasicEditField id,password;
    private ButtonField login,cancel;
    private  VerticalFieldManager id_mgr,pass_mgr;
    private PopupField id_hint,pass_hint;
    public static Bitmap img;
    public MyScreen()
    { 
        img=Bitmap.getBitmapResource("chat.png");
        // Set the displayed title of the screen       
        setTitle("Login Page");
        Border b=BorderFactory.createRoundedBorder(new XYEdges(5, 5, 5, 5), Border.STYLE_SOLID);
        id_hint=new PopupField("Wrong Id", img);

        pass_hint=new PopupField("Wrong password", img);
        id_mgr=new VerticalFieldManager();

        id=new BasicEditField(){
            protected void layout(int width, int height) {
                super.layout(120, 40);
                setExtent(120, 40);

            }
        };
        id.setBorder(b);
        add(id_mgr);
        add(id);
        pass_mgr=new VerticalFieldManager();
        password=new BasicEditField(){
            protected void layout(int width, int height) {
                super.layout(120, 40);
                setExtent(120, 40);

            }
        };
        password.setBorder(b);
        add(pass_mgr);
        add(password);

        login=new ButtonField("Login");
        login.setChangeListener(this);
        add(login);

        cancel=new ButtonField("Remove");
        cancel.setChangeListener(this);
        add(cancel);

    }
    public void fieldChanged(Field field, int context) {
        if(field==login)
        {
            try {
//              id_mgr.add(new NullField(Field.FOCUSABLE));
                id_mgr.add(id_hint);
                id_mgr.setPadding(0, 0, 0, 50);
                pass_mgr.add(pass_hint);
                pass_mgr.setPadding(0, 0, 0, 50);
                id_hint.setFocus();
            } catch (IllegalStateException e) {
                return;
            }
        }else if(cancel==field)
        {
            synchronized (UiApplication.getEventLock()) {
                id_mgr.deleteAll();
                pass_mgr.deleteAll();
            }
        }

    }
} 
```

PopupField.java 的类是

```
package mypackage;

import net.rim.device.api.system.Bitmap;
import net.rim.device.api.ui.Color;
import net.rim.device.api.ui.Graphics;
import net.rim.device.api.ui.component.BitmapField;

public class PopupField extends BitmapField{
    private  Bitmap img,scalled_img;
    private String message;
    private int layout_width;

    public PopupField(String message,Bitmap img)
    {
        this.message=message;
        layout_width=this.getFont().getAdvance(message)+40;
        scalled_img=new Bitmap(layout_width, img.getHeight());
        img.scaleInto(scalled_img, Bitmap.FILTER_BILINEAR);
        this.img=scalled_img;
    }

    protected void layout(int width, int height) {

        super.layout(img.getWidth(), img.getHeight());
        setExtent(img.getWidth(), img.getHeight());

    }

    protected void paint(Graphics graphics) {
        graphics.drawBitmap(0, 0, img.getWidth(), img.getHeight(), img,0,0);
        graphics.setColor(Color.RED);
        graphics.drawText(message,20,20);
        super.paint(graphics);
    }

} 
```

**输出图像：**![在此处输入图像描述](../Images/acb4335ad8afdbe124779b48ef89174a.png)

**继续帮助别人**

其他解决方案是这个链接会告诉你 [http://v4ks1n.wordpress.com/2011/01/28/tooltips-class-for-blackberry/](http://v4ks1n.wordpress.com/2011/01/28/tooltips-class-for-blackberry/)

# php - 由于延迟时间和多个请求，避免双重数据库查询

> ID：10962769
> 
> 赞同：0
> 
> 时间：2012-06-09T16:50:04.080
> 
> 标签：php, mysql, sql, task

我有一个链接到我的网站的 MySql 数据库，它有一个带有任务列表的表（列由下面的“/”分隔），即：

任务1/doTask1.sh/待办事项

任务2/doTask2.sh/完成

任务3/doTask3.sh/待办事项

任务4/doTask4.sh/待办事项

ETC...

在对我的网站的每个请求中，我希望执行“待办事项”任务，然后由服务器标记为“完成”。任务只能执行一次。但问题来了。

如果什么：

用户 A 选择标记为“待办事项”的任务。doTask1.sh 执行并标记为完成，由用户 A 的请求触发。用户 B 选择标记为“待办事项”的任务（仅限任务 3 和任务 3，因为任务 1 已完成）。doTask3.sh 执行并标记为完成，由用户 A 的请求触发。doTask3.sh 再次执行，由用户 B 的请求触发。doTask4.sh 也是如此。

由于同时存在数据库连接，使用 PHP/Nginx/MySql 会发生这种情况吗？如果是，如何绕过/避免这个问题？

* * *

*在这个例子中，我使用了 doTaskx.sh 来简化情况。实际上，此列将包含任务描述，支持我的网站的 PHP 脚本将根据该描述执行任务。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T17:04:38.343

是的，这可能发生。

解决此问题的一种方法是执行以下操作：

*   创建“待定”状态”。
*   当请求执行任务时，对数据库运行更新，将所有匹配 ID 和状态 =“todo”的内容设置为“pending”。
*   如果更新的记录数为 1，则执行任务并将其标记为“完成”。
*   如果更新的记录数为 0，则意味着另一个请求首先到达那里。
*   无论哪种方式，更新用户界面以显示任务正在等待/完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T17:00:07.547

锁定列表。获取仍待执行的请求任务，将它们标记为“进行中”，解锁，然后将它们传递给执行任务的任何对象。

# java - 条件 == 在字符串和常量之间

> ID：10962770
> 
> 赞同：-6
> 
> 时间：2012-06-09T16:50:09.797
> 
> 标签：java, android

> **可能重复：**
> [如何比较 Java 中的字符串？](https://stackoverflow.com/questions/513832/how-do-i-compare-strings-in-java)

有人可以告诉我为什么会出现这种情况

```
if (lista.getString(0)=="username") 
```

不返回真？我曾经尝试过

```
if (lista.getString(0)==lista.getString(0)) 
```

并且不工作，我知道这是一个语言问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T16:51:37.287

`==`测试参考相等。

`.equals`测试值相等。

因此，您应该使用：

```
if (lista.getString(0).equals("username")) 
```

请参阅[如何比较 Java 中的字符串？](https://stackoverflow.com/questions/513832/how-do-i-compare-strings-in-java)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T16:51:34.323

为了`String`比较总是使用`equals()`.

```
if (lista.getString(0).equals("username")) 
```

使用`==`，您最终将比较引用，而不是值。

一个简单的片段进一步澄清：

```
String s1 = "Hello";
String s2 = new String(s1);
System.out.println(s1.equals(s2)); // true because values are same
System.out.println((s1 == s2)); // false because they are different objects 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T16:52:49.170

来自 Java 技术

```
Since Strings are objects, the equals(Object) method will return true if two Strings have
the same objects. The == operator will only be true if two String references point to the  
same underlying String object. Hence two Strings representing the same content will be  
equal when tested by the equals(Object) method, but will only be equal when tested with 
the == operator if they are actually the same object. 
```

采用

```
if (lista.getString(0).equals("username")) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T16:57:29.743

比较对象的正确方法是，

```
object1.equals(object2) 
```

而 String 是 Java 中的一个对象，所以它对 String 也有同样的含义

```
s1.equals(s2) 
```

例如：

```
if (lista.getString(0).equals("username")) 
```

# count - 计数和左连接不能正常工作

> ID：10962771
> 
> 赞同：0
> 
> 时间：2012-06-09T16:50:21.360
> 
> 标签：count, sum, left-join, max

尝试对这些行进行计数 COUNT(engineerName) ASengineerCount, Count(managerName) as managerCount, Count(isContractor) ascontractorCount 但它始终返回所有三个相同的数字。所以我试图为每个添加一个 Where，Example Count(isContractor where isContractor = 'yes') ascontractorCount 但遇到错误请帮忙，谢谢。

```
<?php

        clASs EfficiencyController extends DooController
        {

        function getEfficiency(){

        include './protected/config/db.conf.php';
        Doo::db()->setDb($dbconfig, 'local_network');

        $Vendor = ($_SERVER['REQUEST_METHOD'] == "POST") ? $_POST['Vendor'] : $_GET['Vendor'];
        $date   =   ($_SERVER['REQUEST_METHOD'] == "POST") ? $_POST['date'] : $_GET['date'];
        $level   =  ($_SERVER['REQUEST_METHOD'] == "POST") ? $_POST['level'] : $_GET['level'];
            switch($level) {
            case "Region":
            case "area":
                $Market99="";
                break;
            default:
                $Market99=$level;
                break;

        }
    {
        //
        // LUCENT,NORTEL
        //

        $query = " SELECT 
                  DayKey,
                Market99,
                Region,
                areaName,
                Sum(Total_Sites) as totalCount,
                Max(engineerCount) AS engineerCount,
                Max(managerCount) AS managerCount,
                Max(contractorCount) AS contractorCount,
                SC_Type,
                Sum(Total_Carriers),
                Sum(Total_Sectors),
                Vendor 
                FROM
                network.envEquipSummaryConfig a
            Left Join
            (SELECT 
                market,
                    areaName,
                    COUNT(engineerName) AS engineerCount,
                    Count(managerName) as managerCount,
                    Count(isContractor) as contractorCount
            FROM
                employee.employees
            GROUP BY market
            ORDER BY COUNT(market) DESC) b ON a.Market99 = b.market
            Where
            a.DayKey <= \"$date\" and a.Vendor = \"$Vendor\" 
            Group By Market99 asc";

            switch($level) {
                case "region":
                        $query = $query. " order by region ASC";
                        break;
                        case "area":
                        $query = $query. " order by areaName ASC";
                        break;
                default;
                        $query = $query. " order by Market99 ASC";
                        break;  

            }

        }
        //echo $query; exit;    

        $this->setContentType('xml');
        $result = Doo::db()->fetchAll($query);

        printf("<root>\n");
        if(count($result) > 0)
        foreach($result AS $row) {

                    printf("\t<data>\n");
                printf("\t\t<date>%s</date>\n",$row["DayKey"]);
                printf("\t\t<vName>%s</vName>\n",$row["Vendor"]);
                printf("\t\t<location>%s</location>\n",$row["Market99"]);
                printf("\t\t<toCount>%s</toCount>\n",$row["totalCount"]);
                printf("\t\t<enCount>%s</enCount>\n",$row["engineerCount"]);
                printf("\t\t<mnCount>%s</mnCount>\n",$row["managerCount"]);
                printf("\t\t<cnCount>%s</cnCount>\n",$row["contractorCount"]);

                printf("\t</data>\n");

        }
      printf("</root>\n");

    }
}   

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T17:12:32.230

```
SELECT 
  market,
  areaName,
  COUNT(engineerName) AS engineerCount,
  Count(managerName) as managerCount,
  Count(isContractor) as contractorCount
FROM
  employee.employees
GROUP BY market 
```

应该

`Group By market,areaName`猜测。

这就是它所能看到的一切，因为您几乎没有提供任何有用的信息。

# mysql - MySQL复制系统

> ID：10962779
> 
> 赞同：0
> 
> 时间：2012-06-09T16:51:25.057
> 
> 标签：mysql, replication, master, slave

我会在大型结构上使用复制。我会知道在主服务器上执行 INSERT 是否会等待数据在所有服务器上复制，或者在将数据放在运行请求的服务器上之后结束，然后在后台运行复制。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T17:09:40.847

见这里[http://dev.mysql.com/doc/refman/5.1/en/replication-howto-masterbaseconfig.html](http://dev.mysql.com/doc/refman/5.1/en/replication-howto-masterbaseconfig.html)

master 将更改写入二进制 log，二进制 log 在后台传输到 slave。

主从复制需要许多步骤。根据您的 MySQL 版本，请按照[此处描述的步骤进行操作](http://dev.mysql.com/doc/refman/5.1/en/replication-howto.html)

# ruby - EventMachine 之上是否有任何 Web 框架？

> ID：10962782
> 
> 赞同：3
> 
> 时间：2012-06-09T16:51:32.927
> 
> 标签：ruby, node.js, event-handling, web-frameworks, eventmachine

EventMachine 之上是否有任何 Web 框架？到目前为止，我已经找到[了 Fastr](https://github.com/chrismoos/fastr)和[Cramp](https://github.com/lifo/cramp)。两者似乎都过时了。

此外，谷歌搜索如何设置 Rails + EventMachine，返回的结果数量有限。

NodeJS 真的不是什么新鲜事。Evented I/O 已经存在了很长时间（Twisted for Python 和 EventMachine for Ruby）。然而，NodeJS 吸引我的是基于它的实现。

例如。NodeJS有[TowerJS](http://towerjs.org/)。在许多其他人中。也许，这是其趋势因素的众多促成原因之一。

我最喜欢 TowerJS 的地方是它类似于 Rails 的结构。EventMachine 有类似的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T19:38:54.567

[Goliath](https://github.com/postrank-labs/goliath)是非阻塞（异步）Ruby Web 服务器框架的开源版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T18:44:26.673

你可能会发现[异步 sinatra](https://github.com/raggi/async_sinatra)很有趣

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-10T08:58:32.173

除了 EventMachine 和这里​​提到的其他，还有[vert.x](http://vertx.io/)。我不确定它有多大的“网络框架”，但它的网站显示了一个简单应用程序的示例，比如一个可能在 Sinatra 中编写的应用程序。

# php - 从文件夹 php 中选择随机不同的图像

> ID：10962785
> 
> 赞同：-1
> 
> 时间：2012-06-09T16:51:40.000
> 
> 标签：php, image, random, directory

我想从包含许多图像的文件夹中选择四个随机图像。

**我要显示的是一个表格（2x2），我可以在其中显示 4 个随机不同的图像。**

有人可以告诉我如何从文件夹中选择随机**不同**的文件，以便我可以将它们的路径存储在变量中，然后可以使用这些变量在表格中随机显示图像！

是否有任何特定功能可以从文件夹或类似的东西中选择随机文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T16:53:47.543

1.  用于[`glob()`](http://php.net/glob)从目录中获取所有文件。
2.  用于[`array_rand()`](http://php.net/array_rand)从数组中获取随机条目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T15:00:37.193

```
<?php

    function get_imagess($root) {

    $r = array();
    $r = array();
    $k = glob("$root/*");
    shuffle($k);
    foreach($k as $n) {
        if (is_dir($n)) {
            break;
            //$r = array_merge($r, get_imagesss($n));
            print_r("xxx");
        } else {
           $r[] = $n;
           //print_r($n + "yeah");     
        }
    }
    return $r;
}

    function get_images($root) {

    $r = array();
    $k = glob("$root/*");
    shuffle($k);
    $n = $k[0];
//    foreach($k as $n) {
        if (is_dir($n)) {
            $r = array_merge($r, get_imagess($n));
        } else {
           $r[] = $n;
        }
//    }

    return $r;
}

$files = get_images('.');
//print_r($files);
//break;

shuffle($files);
$true=true;
    $extList = array();
    $extList['gif'] = 'image/gif';
    $extList['jpg'] = 'image/jpeg';
    $extList['jpeg'] = 'image/jpeg';
    $extList['png'] = 'image/png';
        $ass=0;
while($true)
    {
        $ass=$ass+1;
        if($ass>100){$true=false;}
        $imageInfo = pathinfo($files[0]);
        if (isset( $extList[ strtolower( $imageInfo['extension'] ) ] )){

    $temp = substr($files[0], -5);  
    $temp = strtolower($temp);
    if( $temp == "p.jpg"){shuffle($files);}  // checking if jpg has a preview file
    else{  // no preview found
    $true=false;
    //print_r($temp);
    }}
    else
        {
        shuffle($files);
        //print_r('bad' + $temp);
        }
}

//print_r($files[0]);
echo '<HTML><meta HTTP-EQUIV="Refresh" CONTENT="5; URL=./ImageRotateMaybe.php"><img src="';
echo $files[0];
echo ' " width=100%>';
?> 
```

# php - 使用 FILTER_SANITIZE_STRING 清理输入

> ID：10962789
> 
> 赞同：0
> 
> 时间：2012-06-09T16:52:09.607
> 
> 标签：php, http-post, forms, sanitize

我很生气写一些代码来清理来自表单的数据。在表单中，我有一个名为“sender_countryCode”的输入字段，它只能包含 2 或 3 个文本字符，如 USA、FR、EN ......以下代码应该阻止与字符串不同的所有内容，但如果我在该字段没有通过过滤器！

```
if  (isset($_POST["sender_countryCode"])){
    $var    =   $_POST["sender_countryCode"];
    $var    =   stripslashes($var);
    $var    =   htmlentities($var);
    $var    =   strip_tags($var);
    $var    =   filter_var($var, FILTER_SANITIZE_STRING);
    $sender["countryCode"] = $var;
    unset($var);
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T21:18:54.250

这行得通:) ...对不起，我有点晚了，但我看到它没有回答。这是我的解决方案：

```
function maxLengthCheckUp($this) {
    if ( strlen($this) <= 4){
        return TRUE;
    }
}
if (isset($_POST["sender_countryCode"]) 
  && !preg_match('/\s/',$_POST["sender_countryCode"]) 
  && maxLengthCheckUp($_POST["sender_countryCode"])) {
    $var    =   $_POST["sender_countryCode"];
    $var    =   stripslashes($var);
    $var    =   htmlentities($var);
    $var    =   strip_tags($var);
    $var    =   filter_var($var, FILTER_SANITIZE_STRING);
    $sender["countryCode"] = $var;
    echo $sender["countryCode"];
    unset($var, $sender);
};//end of if(... 
```

使用以下元素创建您的表单：

```
<input type="text" name="sender_countryCode" id="sender_countryCode" />
<input type="submit" name="Submit" id="Submit" value="Submit" /> 
```

提交您的表单...创建一个普通表单...只需使用我上面的 php 代码。试试看 ：）

# sql - SSIS - 列名作为变量/以编程方式更改

> ID：10962794
> 
> 赞同：2
> 
> 时间：2012-06-09T16:52:54.677
> 
> 标签：sql, sql-server, ssis

我希望有人能帮我解决这个问题——我有 24 个 CSV 格式的文件，它们都有相同的布局，需要加入一些预先存在的数据。每个文件都有一个需要连接到其余数据的列，但这些列在原始文件中都具有相同的名称。我需要将列自动重命名为文件名作为连接的一部分。

列的最终名称需要是：文件名 - 来自另一列的数据。

我目前的方法是使用foreach容器并使用容器生成的变量来命名列，但是我无法在连接中输入该值，即使我这样做了，它也会弄乱输出映射，因为列名会不同。

有没有人对如何解决这些问题有任何想法？谁有主意，谁来救我的脖子！

**编辑**如果更多细节对此有所帮助...... SSIS版本是2008，每个文件只有几百行。从每月发行的几张账单中收集完整的账单历史记录基本上是一项一次性任务。

源数据有三列，产品编号、产品类型和成本。

目的地需要有 24*3 列，每列都有给定产品类别的每月费用。共有三个产品类别和 24 个账单（在单独的文件中），因此 24*3。

**所以希望我更清楚一点——我真正需要知道的就是使用从 foreach 文件容器传入的变量来更改列的名称。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T09:49:20.773

我认为最简单的方法是创建一个 tmp 数据库（又名 staging db）以将数据从 xls 文件加载到其中并定义**存储过程**，您可以在其中传递参数（例如文件名等）并构建您的逻辑......干杯马里奥

# c# - 使用 linq to sql 插入多个子记录

> ID：10962795
> 
> 赞同：0
> 
> 时间：2012-06-09T16:53:15.397
> 
> 标签：c#, sql, linq-to-sql

我正在创建一个轻弹 Web 应用程序。

我有一个 flickrUser 表和一个 flickrPhoto 表

我已经插入了 flickrUser 记录，现在我想插入一些 flickrPhoto 记录；

```
FlickrPhoto:
 -photoid
 -flickruserid
 -id (PK) 
```

这是我尝试插入 flickrphoto 记录的方式（flickrphoto 存储在 MyPhoto 表中）

```
public void insertList(List<string> photoids, string flickruserid)
    {
        PicsPreciousLinqDataContext db = new PicsPreciousLinqDataContext();
        for (int i = 0; i < photoids.Count; i++)
        {              
                MyPhoto mf = new MyPhoto();
                mf.photoId = photoids[i];
                mf.source = "flickr";

                var query = from b in db.FlickrUsers
                            where b.nsid == flickruserid
                            select b;

                FlickrUser fUser = query.FirstOrDefault();
                mf.FlickrUserId = fUser.nsid;
                db.MyPhotos.InsertOnSubmit(mf);                
        }
        db.SubmitChanges();  <= Cannot add an entity with a key that is already in use.
    } 
```

我已经尝试了一些变化，但也没有成功。插入多个子记录的正确方法是什么？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T17:01:24.500

请检查您的**MyPhotos**表，我怀疑它的**userId**列作为主键。它应该是外键/引用键列。

添加以下代码，而不是您的代码，

```
 for (int i = 0; i < photoids.Count; i++)
    {              
            MyPhoto mf = new MyPhoto();
            mf.photoId = photoids[i];
            mf.source = "flickr";

            var query = from b in db.FlickrUsers
                        where b.nsid == flickruserid
                        select b;

            FlickrUser fUser = query.FirstOrDefault();
            mf.FlickrUserId = fUser.nsid;
            db.MyPhotos.Add(mf);               
    }
db.SubmitChanges(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T17:25:42.557

如果 id 的值由数据库设置（即 NEWID() 作为默认值，或自动递增），则在您的 dbml 设计器中，单击作为主键的列并确保以下属性具有这些值：

```
Auto Generated Value: True
Auto-Sync: OnInsert
Primary Key: True 
```

如果它不是由数据库设置，那么您必须在 C# 代码中为插入的每一行为 Id 列创建唯一值，而不是设置上面的前两个属性。

这可以通过以下方式完成：

```
 Guid.NewGuid(); 
```

所以在你的代码中：

```
PicsPreciousLinqDataContext db = new PicsPreciousLinqDataContext();
...
MyPhoto mf = new MyPhoto();
            mf.photoId = photoids[i];
            mf.source = "flickr";
            mf.id = Guid.newGuid();
...
db.MyPhotos.InsertOnSubmit(mf); 
```

用于数据库中 uniqueIdentifier 类型列的列。

# security - 每个应用程序的 Glassfish 安全领域

> ID：10962796
> 
> 赞同：0
> 
> 时间：2012-06-09T16:53:19.390
> 
> 标签：security, glassfish

我在 glassfish 服务器上部署了两个应用程序，每个应用程序都使用自己的安全领域（文件、jdbc）。问题是 glassfish 只允许设置一个默认领域，这导致一次只有一个应用程序可以运行。我是 glassfish 的新手，所以我可能遗漏了一些基本的东西，或者应该以不同的方式解决这个问题（我是否需要为我的每个应用程序设置一个单独的域才能设置特定领域的安全性？）。

任何建议，将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T17:17:00.700

可以在同一个 GlassFish 域中创建更多文件领域，您只需为存储用户/密码信息的密钥文件指定一个新文件名。如果您愿意，可以按照本[教程进行操作。](http://www.developinjava.com/securing-a-web-application-on-glassfish-using-jaas.html)

关于问题的另一部分，您还可以考虑使用[LDAP](http://docs.oracle.com/cd/E18930_01/html/821-2435/ggkuk.html#gkbjp)服务器，这是一种可扩展且更通用的解决方案，因为同一公司内的其他应用程序也可以使用它。例如，您可以使用[OpenLDAP](http://www.openldap.org/)或[OpenDJ](http://www.forgerock.com/opendj.html)，并使用[JNDI](http://docs.oracle.com/javase/jndi/tutorial/) API 让您的应用程序访问 LDAP 领域。

[在这里](http://www.cris.com/~adhawan/tutorial/)，您可以找到 JNDI 和 OpenLDAP 教程，但您可以轻松找到有关该主题的其他教程。

# php - Doctrine 2.2 + Zend Framework 分页速度优化

> ID：10962802
> 
> 赞同：5
> 
> 时间：2012-06-09T16:54:36.347
> 
> 标签：php, performance, doctrine-orm

我在使用`HYDRATE_OBJECT`. 当我从 切换`HYDRATE_ARRAY`到 时`HYDRATE_OBJECT`，它需要将近 10 倍的时间！我使用了[学说 2 和 zend 分页器](https://stackoverflow.com/questions/6635194/doctrine-2-and-zend-paginator/9334016#9334016)作为参考：

```
$query = $em->createQuery($dql)
    ->setHydrationMode(\Doctrine\ORM\AbstractQuery::HYDRATE_ARRAY)
    ->setParameter('x', 1);

// Pagination
$paginator = new Doctrine\ORM\Tools\Pagination\Paginator($query, false);
$iterator = $paginator->getIterator();
die(); // 160 ms 
```

对比

```
$query = $em->createQuery($dql)
    ->setHydrationMode(\Doctrine\ORM\AbstractQuery::HYDRATE_OBJECT)
    ->setParameter('x', 1);

// Pagination
$paginator = new Doctrine\ORM\Tools\Pagination\Paginator($query, false);
$iterator = $paginator->getIterator();
die(); // 1.4s 
```

我应该注意什么？如何减少处理时间并仍然利用`HYDRATE_OBJECT`？有没有更好的方法来完成分页？

***编辑**：使用`->setFirstResult($itemsPerPage * $page - $itemPerPage)->setMaxResults($itemsPerPage);`显着减少加载时间，但使用时`$iterator`：

```
$adapter =  new \Zend_Paginator_Adapter_Iterator($iterator);
$zend_paginator = new \Zend_Paginator($adapter);          
$zend_paginator->setItemCountPerPage($itemsPerPage)
    ->setCurrentPageNumber($page); 
```

Zend 只知道`$itemsPerPage`, ( `count($iterator) == $itemsPerPage`) ，因此分页链接总是只计算 1 页。如何使用 Zend_Paginator 完成正确的分页，并且只加载`$itemsPerPage`实体？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T17:39:29.867

我现在通过为 Doctrine 分页创建 Zend 分页适配器包装器解决了这个问题；

```
<?php
class PaginatorAdapter extends Doctrine\ORM\Tools\Pagination\Paginator implements
        Zend_Paginator_Adapter_Interface
{
    public function getItems($offset, $itemCountPerPage)
    {
        $this->getQuery()->setFirstResult($offset)->setMaxResults($itemCountPerPage);
        return $this->getQuery()->getResult($this->getQuery()->getHydrationMode());
    }
} 
```

# image - 苹果脚本提取裁剪的 eps 图像并将新图像保存在单独的文件夹中

> ID：10962808
> 
> 赞同：0
> 
> 时间：2012-06-09T16:55:26.237
> 
> 标签：image, applescript, export, adobe-indesign, eps

我想知道是否有人有 AppleScript 可以从 INDD CS5/CS6 文档中提取裁剪的 EPS 文件并将裁剪的图像保存到新文件夹中。

我看过很多关于 CS3 的帖子，并试图调整 AppleScript 以适合我，但无法保存图像。

我需要它们以 300 dpi、eps 格式、二进制、JPG 预览 MAC OS 并保存在新文件夹中。我熟悉 AppleScript，如果可能的话，我希望能得到帮助

我是脚本新手，这就是为什么这对我来说有点困难。它适用于我正在处理的 1300 张图像的大型目录，我希望将其自动化，这样我就不必手动裁剪了。

我敢肯定，这将节省大量时间并最大限度地减少人为错误。任何帮助都会非常感谢我自己并与我的同事分享。

非常感谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T23:09:42.510

它不是 AppleScript，但这已成为我的目录工作流程中不可或缺的一部分：[https](https://sites.google.com/a/lapay.biz/www/imagestransformto100%25) ://sites.google.com/a/lapay.biz/www/imagestransformto100%25 。我用它来缩放/旋转/倾斜/裁剪以匹配布局，然后锐化并重新链接。它非常灵活，应该可以完成您想要做的事情。

# javascript - 使用 javascript 从表单、计算和更新 html 内容中获取数值

> ID：10962809
> 
> 赞同：1
> 
> 时间：2012-06-09T16:55:33.417
> 
> 标签：javascript, jquery, html

我正在尝试用 HTML 和 javascript 制作一个非常简单的计算器，但它仍然不起作用

我的问题是：
1\. 如何从表单中获取值并将其设置为数字，而不是字符串？
2\. 如何在javascript中进行二次计算？
3\. 如何使用 javascript 更新 html 内容？因此，每当我更改输入表单的值并按下提交时，结果都会根据我输入的输入而改变，我尝试了*document.getElementById("idhere").innerHTML=valuehere;* 但仍然无法正常工作。

```
<script tyle="text/javascript">
function calculateThis(form) {
var userweight=form.weight.value;
var caffeineamount=form.caffein.value;
var caffeinetimes=form.caffeintimes.value;
var totalcaffeine=caffeineamount*caffeinetimes;

// Calculate max caffeine per person
var maxcaffeine=userweight*10;

// Calculate remaining after 24 hours
// Half life = 6 hours
var totalcaffeineafter=totalcaffeine(1/16);

// Calculating how many hours until the caffeine completely digested
var totaldigest=totalcaffeine;
var digesttime=0;

while (totaldigest>0.05) {
totaldigest=totaldigest(1/2);
digesttime++;
}

digesttime=digesttime*6;

// Calculating when the user will probably die of overdose
var countcaffeine=0;
var overdosetime=1;

while (countcaffeine<maxcaffeine){
countcaffeine=countcaffeine+totalcaffeine;
overdosetime++;
}

// Show total amount of caffeine
document.getElementById("showtotalkafein").innerHTML=totalcaffeine;

// Show amount of caffeine after 1 day
document.getElementById("showtotalkafeinsetelah").innerHTML=totalcaffeineafter;

// Show digest time
document.getElementById("showwaktudigest").innerHTML=digesttime;

// Show overdose
document.getElementById("showberapakali").innerHTML=overdosetime;

return false;
}
</script>

<form class="form">
Weight<br />  
<input type="text" name="weight" class="required" value="" /><p /> 
Amount of caffein in coffee<br />
<input type="text" name="caffein" class="required" value="" /><p /> 
How many times drinking coffee in a day<br /> 
<input type="text" name="caffeintimes" class="required" value="" /><p />

<button type="button" onclick="calculateThis(this.form); return false;">Calculate</button></form>

<h1>Result</h1>
<p id="showtotalkafein">Show Caffein Total Here</p> 
<p id="showtotalkafeinsetelah">Show Caffeine Amount After 24 hours</p> 
<p id="showwaktudigest">Show Digest TIme Here</p> 
<p id="showberapakali">Show Overdose Time Here</p> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T17:12:27.540

```
function calculateThis(form) {
    var userweight = parseInt(form.weight.value, 10);
    var caffeineamount = parseInt(form.caffein.value, 10);
    var caffeinetimes = parseInt(form.caffeintimes.value, 10);
    var totalcaffeine = caffeineamount * caffeinetimes;

    console.log(totalcaffeine)
    // Calculate max caffeine per person
    var maxcaffeine = userweight * 10;

    // Calculate remaining after 24 hours
    // Half life = 6 hours
    var totalcaffeineafter = totalcaffeine * (1 / 16);

    // Calculating how many hours until the caffeine completely digested
    var totaldigest = totalcaffeine;
    var digesttime = 0;

    while (totaldigest > 0.05) {
        totaldigest = totaldigest * (1 / 2);
        digesttime++;
    }

    digesttime = digesttime * 6;

    // Calculating when the user will probably die of overdose
    var countcaffeine = 0;
    var overdosetime = 1;

    while (countcaffeine < maxcaffeine) {
        countcaffeine = countcaffeine + totalcaffeine;
        overdosetime++;
    }

    // Show total amount of caffeine
    document.getElementById("showtotalkafein").innerHTML = totalcaffeine;

    // Show amount of caffeine after 1 day
    document.getElementById("showtotalkafeinsetelah").innerHTML = totalcaffeineafter;

    // Show digest time
    document.getElementById("showwaktudigest").innerHTML = digesttime;

    // Show overdose
    document.getElementById("showberapakali").innerHTML = overdosetime;

    return false;
} 
```

**[演示](http://jsfiddle.net/cAyJU/2/)**

### 笔记

在这里，我使用`.parseInt()`which 将数字转换为整数，如果您需要 Float 中的任何值，请使用`.`parseFloat()`。

* * *

### 代码中的问题

*   `form.weight.value`, `form.caffein.value`... 以字符串形式给出值，因此您需要将它们转换为数字（整数/浮点数）。

*   您使用`totalcaffeine(1 / 16)`and `totaldigest = totaldigest(1 / 2);`，不是 javascript 中的有效数学运算，它应该是`totalcaffeine * (1 / 16)`and`totaldigest = totaldigest * (1 / 2);`

* * *

### 根据你的评论

什么`.parseInt(form.caffeintimes.value, 10)`，做什么？

的格式`parseInt`为：

`.parseInt(valueToConvert, [radix])`.

因此，`.parseInt(form.caffeintimes.value, 10)`将`form.caffeintimes.value`字符串转换为 10 基整数。

* * *

### 相关参考：

**[.parseInt()](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/parseInt)**

**[.parseFloat()](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/parseFloat)**

# javascript - JQuery .hide() 在 FireFox 中不起作用

> ID：10962812
> 
> 赞同：0
> 
> 时间：2012-06-09T16:56:08.087
> 
> 标签：javascript, jquery, css

我在 Firefox 中获得正确的显示/隐藏行为时遇到问题。网站在 Chrome/Safari 中运行。暂时不用担心 IE。

网站在这里：

[http://chrismcaleenan.com/map/?page_id=6](http://chrismcaleenan.com/map/?page_id=6)

当用户在 Chrome/Safari 中将鼠标悬停/鼠标移出/单击地图上的状态时，您可以看到所需的行为（忽略插图 - 这仍在进行中）。在 Firefox 中，该站点似乎可以处理鼠标悬停，但不能处理鼠标悬停或单击。

这是我认为相关的代码，尽管错误可能出现在实际的 CSS 或其他地方：

```
//actions on poly mouseover     
        for (var i = 0; i < statesPoly.length; i++) {
            (function(i){
                google.maps.event.addListener(eval(statesPoly[i]), 'mouseover', function() {
                    this.setOptions({ strokeWeight: '2' });
                    $("#"+statesPoly[i]).addClass("highlight");
                    if(map.getZoom() <= 6) 
                    $('#supp_data'+i).show();
                });
            })(i);
        }

        //actions on poly click     
        var zoomArray = new Array();

        for (var i = 0; i < statesPoly.length; i++) {
            zoomArray[i]=0;

            (function(i){
                google.maps.event.addListener(eval(statesPoly[i]), 'click', function() {
                    if (!zoomArray[i]) {                
                        map.panTo(eval(stateCenters[i]));
                        map.setZoom(7);
                        polyArray[i].setOptions({ fillOpacity: '0' });
                        zoomArray[i] = 1;   
                        $('#supp_data'+i).hide();
                        $('#inset-map').hide();
                    }
                    else {
                        map.panTo(myLatLng);
                        map.setZoom(6);
                        $('#inset-map').show();

                        //for some reason bug causes 11,12 to skip - adding manual reset
                        polyArray[i].setOptions({ fillOpacity: '.8' });
                        zoomArray[i] = 0;
                        polyArray[11].setOptions({ fillOpacity: '.8' });
                        zoomArray[11] = 0;
                        polyArray[12].setOptions({ fillOpacity: '.8' });
                        zoomArray[12] = 0;

                        for (n = 0; n < polyArray.length; n++) {
                            polyArray[n].setOptions({ fillOpacity: '.8' });
                            zoomArray[n] = 0;   
                        }

                    }
                });
            })(i);
        }

        //actions on table mouseover 
        for (var i = 0; i < statesPoly.length; i++) {
            (function(i){
                google.maps.event.addDomListener(document.getElementById(statesPoly[i]), 'mouseover', function() {
                    $("#"+statesPoly[i]).addClass("highlight");
                    polyArray[i].setOptions({ strokeWeight: '2' });
                    if(map.getZoom() <= 6)
                    $('#supp_data'+i).show();
                });
            })(i);
        }

        //actions on table click    
        var zoomArray = new Array();

        for (var i = 0; i < statesPoly.length; i++) {
            zoomArray[i]=0;

            (function(i){
                google.maps.event.addDomListener(document.getElementById(statesPoly[i]), 'click', function() {
                    if (!zoomArray[i]) {                
                        map.panTo(eval(stateCenters[i]));
                        map.setZoom(7);
                        polyArray[i].setOptions({ fillOpacity: '0' });
                        zoomArray[i] = 1;   
                        $('#supp_data'+i).hide();
                        $('#inset-map').hide();

                    }
                    else {
                        map.panTo(myLatLng);
                        map.setZoom(6);
                        $('#inset-map').show();

                        //for some reason bug causes 11,12 to skip - adding manual reset
                        polyArray[i].setOptions({ fillOpacity: '.8' });
                        zoomArray[i] = 0;
                        polyArray[11].setOptions({ fillOpacity: '.8' });
                        zoomArray[11] = 0;
                        polyArray[12].setOptions({ fillOpacity: '.8' });
                        zoomArray[12] = 0;

                        for (n = 0; n < polyArray.length; n++) {
                            polyArray[n].setOptions({ fillOpacity: '.8' });
                            zoomArray[n] = 0;   
                        }

                    }
                });
            })(i);
        }

        //actions on poly mouseout 
        for (var i = 0; i < statesPoly.length; i++) {
            (function(i){
                google.maps.event.addListener(eval(statesPoly[i]), 'mouseout', function() {
                    this.setOptions({ strokeWeight: '1' });
                    $("#"+statesPoly[i]).removeClass("highlight");
                    $('#supp_data'+i).hide();
                });
            })(i);
        }

        //actions on table mouseout
        for (var i = 0; i < statesPoly.length; i++) {
            (function(i){
                google.maps.event.addDomListener(document.getElementById(statesPoly[i]), 'mouseout', function() {
                    $("#"+statesPoly[i]).removeClass("highlight");
                    polyArray[i].setOptions({ strokeWeight: '1' });
                    $('#supp_data'+i).hide();
                });
            })(i);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T18:15:29.593

解决了。我从未将我的 Poly 对象之一放入数组中。Chrome 和 Safari 继续运行该脚本，但 Firefox 将其终止（没有错误）。

# android - 动态相对布局中的问题

> ID：10962813
> 
> 赞同：0
> 
> 时间：2012-06-09T16:56:16.610
> 
> 标签：android, dynamic, android-relativelayout

请检查这个。

```
 RelativeLayout layout = new RelativeLayout(this);

    ImageView item = new ImageView(this);
    item.setImageResource( R.drawable.invite );
    item.setAdjustViewBounds(true);

    RelativeLayout.LayoutParams params = new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.WRAP_CONTENT, RelativeLayout.LayoutParams.WRAP_CONTENT);
    params.addRule(RelativeLayout.ALIGN_LEFT, RelativeLayout.TRUE);
    item.setLayoutParams(params);
    item.setId( mIconIdCounter );
    layout.addView(item, params);
    params = new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.WRAP_CONTENT, RelativeLayout.LayoutParams.WRAP_CONTENT);
    params.addRule(RelativeLayout.BELOW, item.getId());

    TextView tv1=new TextView(getApplicationContext());
    tv1.setText("Invite");
    tv1.setTextSize(15);
    tv1.setId(2);
    params.addRule(RelativeLayout.BELOW, item.getId());
    layout.addView(tv1, params);

    params = new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.WRAP_CONTENT, RelativeLayout.LayoutParams.WRAP_CONTENT);
    params.addRule(RelativeLayout.RIGHT_OF, item.getId());

    ImageView item2 = new ImageView(this);
    item2.setImageResource( R.drawable.logout );
    item2.setAdjustViewBounds(true);
    item2.setLayoutParams(params);
    item2.setId(3);
    layout.addView(item2, params);

    params = new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.WRAP_CONTENT, RelativeLayout.LayoutParams.WRAP_CONTENT);
    params.addRule(RelativeLayout.BELOW, item2.getId());
    params.addRule(RelativeLayout.RIGHT_OF, item.getId());
    TextView tv2=new TextView(getApplicationContext());
    tv2.setText("Logout");
    tv2.setTextSize(15);
    tv2.setId(4);
    params.addRule(RelativeLayout.BELOW, item2.getId());
    layout.addView(tv2, params);

    params = new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.WRAP_CONTENT, RelativeLayout.LayoutParams.WRAP_CONTENT);
    params.addRule(RelativeLayout.ALIGN_PARENT_TOP, RelativeLayout.TRUE);
    ImageView item3 = new ImageView(this);
    item3.setImageResource( R.drawable.fbplaceholder);
    item3.setAdjustViewBounds(true);
    item3.setLayoutParams(params);
    item3.setId(5);
    layout.addView(item3, params); 
```

在这里，我必须在 item imageview 的上面设置 item3 Imageview。但是我做不到。在此代码中 item3 是重叠项。我必须将它设置在项目 imageview 的顶部。请建议我哪里出错了。

在此先感谢 Gaurav Gupta

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T17:57:29.847

当您在最后添加项目时，它是相对布局，其中项目根据参数重叠

尝试这个

添加 item3 作为第一个元素

和

在项目参数中添加此 params.addRule(RelativeLayout.BELOW, item3.getId());

# javascript - 如何在文本框中缩进文本和光标的起始位置（用户、密码等）

> ID：10962816
> 
> 赞同：2
> 
> 时间：2012-06-09T16:56:40.450
> 
> 标签：javascript, html, css

我有一个登录表单，带有用户名和密码输入字段。

这些框有阴影，当您单击框时，光标在阴影中闪烁，您几乎看不到它。

我希望有人单击文本框并使光标在文本框左侧缩进 3px 处闪烁。我该怎么做呢？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T17:04:13.953

您的输入是否在 css 文件中有一个类？如果是，您应该将该元素添加`padding-left: 3px;`到该类。

如果没有，您应该添加`style="padding-left: 3px;"`到您的 html 中的输入标签。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T17:09:21.633

您可以添加`padding-left: 3px;`到输入框的样式。请记住，如果您希望输入框的宽度保持不变，您还需要从其宽度中减去 3px。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T17:04:56.090

将此添加到您的文本框中：

`style="padding-left: 3px"`

或这个：

`style="text-indent: 3px"`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T17:32:13.893

使用填充将是最好的方法。`style="padding-left: 3px;"`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-27T15:37:24.943

您可以使用`text-indent`css 属性执行此操作。

```
<input style="text-indent:16px"/>
```

# http - 服务器如何在端口数量有限的情况下工作？

> ID：10962818
> 
> 赞同：1
> 
> 时间：2012-06-09T16:57:19.097
> 
> 标签：http

据我所知，（单一通用）网络服务器使用端口（与任何其他 tcp/upd 应用程序一样）来识别用户/进程。因为，端口是一个 16 位无符号整数，因此范围从 0 到 65535。当它达到其限制时，服务器如何操作？

**高水平样本**

1.  server1 以 8080 应答！**client1**连接到 server1（现在它们通过随机端口连接：（但唯一）server1：**5123** <--> client1：6123）

2.  另一个**client2**连接到 server1 ( server1: **5124** <--> client2:7123 )

所以，问题是：*对于给定的实例，服务器是否受到 65535（实际上小于）的限制？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T20:27:19.893

在最简单的情况下，Web 服务器只使用服务器系统上的一个 TCP 端口（通常是端口 80）。与网络服务器的所有连接都通过该单个端口进行处理。其他 65534 个端口仍可用于其他用途。

这是有效的，因为 TCP 连接不仅由服务器上的端口号识别，而且由**(server IP, server TCP port, client IP, client TCP port)**的组合识别。因此，服务器可以在其端口 80 上拥有大量并发 TCP 连接，使用其他三个项来识别流量属于哪个连接。如果服务器只有一个 IP 地址，因此**（服务器 IP、服务器端口）**部分在与 Web 服务器的所有连接上都是相同的，则各个连接仍然可以通过组合的**（客户端 IP、客户端端口）**部分来区分。

如果您`netstat -a`在繁忙的 Unix 网络服务器上运行该命令，您将看到它的实际效果。该命令将在服务器的端口 80 上显示一堆连接，但都具有不同的客户端 IP 和/或端口。它还将显示系统仍在侦听端口 80 上的新连接，同时它正在处理该端口上的所有现有连接。

与网络服务器的连接总数可能受到其他一些约束（可能是内存使用，可能是网络服务器本身或操作系统内核中的一些任意限制）或一些外部约束（可能是外部防火墙或网关中的连接表大小）但它不受 16 位 TCP 端口范围的限制。

另请注意，TCP 端口与 UDP 端口完全分开，因此将 TCP 端口 80 用于 Web 服务器并不会阻止 UDP 端口 80 用于其他目的。反之亦然。

# tomcat - 将 Tomcat 配置为服务（无 catalina.bat）

> ID：10962821
> 
> 赞同：7
> 
> 时间：2012-06-09T16:57:31.987
> 
> 标签：tomcat

我使用 Apache 网站上的安装程序将 Tomcat 安装为服务。我的 bin 文件夹中没有 catalina.bat。如何设置 permgem 内存大小？有什么推荐的尺寸设置吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-09T17:12:10.233

您必须使用 tomcatXw.exe（其中 X 是您的主要 Tomcat 版本）来配置服务：那里有配置所有 JVM 选项的地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-26T04:55:13.347

`Java_OPT`在 catalina 中配置 Tomcat ，
首先在安装程序中添加 tomcat，你永远不会`catalina` 在 bin 文件夹中找到文件。

要设置您必须使用的参数`tomcate property`（使用 tomcatXw.exe 打开它）
几乎不知道如何在属性文件中设置参数。

**在 catalina 文件中**：（写这样的东西）

```
JAVA_OPTS="-Djava.awt.headless=true -Xms2048m -Xmx4048m -XX:NewSize=1024m -XX:MaxNewSize=2048m -XX:PermSize=1024m -XX:MaxPermSize=2048m -XX:+DisableExplicitGC" 
```

**在Tomcat属性文件**中：（添加您的参数`Java options:`与图片相同）

![在此处输入图像描述](../Images/c124f5cb46cf899acb2fb522aa9c5b7c.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-01T15:57:23.943

此链接告诉如何在我们没有 catalina.bat 文件的 tomcat7 exe 安装中配置堆最大大小。[http://plavc.wordpress.com/2012/02/08/tomcat-service-on-windows/](http://plavc.wordpress.com/2012/02/08/tomcat-service-on-windows/)

# java - 确保*所有*代码路径返回有效的 JDBC 连接或抛出异常（禁止“null”）

> ID：10962822
> 
> 赞同：0
> 
> 时间：2012-06-09T16:57:32.837
> 
> 标签：java, jdbc, nullpointerexception

目标：确保*所有*代码路径都*抛出*或返回有效连接；我试图不惜一切代价明确避免连接对象返回为“null”。

这是我能想到的最好的：

```
public class JdbcConnectionManager {
  public static class JdbcConnectionFailureException extends Exception {
    private static final String JDBC_CONNECTION_INVALID_MESSAGE =
        "JDBC connection invalid, checked with timeout value of: "
            + JdbcConnectionManager.JDBC_CONNECTION_VALIDATION_TIMEOUT_IN_SECONDS;
    private static final long serialVersionUID = 1L;
    public JdbcConnectionFailureException(String message) {
      super(message);
    }
    public JdbcConnectionFailureException(Throwable throwable) {
      super(throwable);
    }
  }
  private static int JDBC_CONNECTION_VALIDATION_TIMEOUT_IN_SECONDS = 3;
  public static Connection getJdbcConnection(
      JdbcConnectionParameters jdbcConnectionParameters)
      throws JdbcConnectionFailureException {
    try {
      if (jdbcConnectionParameters
          .driverNeedsHelpRegisteringUsingClassForName()) {
        Class.forName(jdbcConnectionParameters
            .getClassForNameDriverRegistrationString());
      }
      Connection jdbcConnection =
          DriverManager.getConnection(jdbcConnectionParameters
              .getJbdcConnectionUrl());
      if (!jdbcConnection
          .isValid(JdbcConnectionManager.JDBC_CONNECTION_VALIDATION_TIMEOUT_IN_SECONDS)) {
        throw new JdbcConnectionManager.JdbcConnectionFailureException(
            JdbcConnectionManager.JdbcConnectionFailureException.JDBC_CONNECTION_INVALID_MESSAGE);
      }
      // TODO: perform further validation on the connection
      return jdbcConnection;
    } catch (ClassNotFoundException classNotFoundException) {
      throw new JdbcConnectionManager.JdbcConnectionFailureException(
          classNotFoundException);
    } catch (SQLException sqlException) {
      throw new JdbcConnectionManager.JdbcConnectionFailureException(
          sqlException);
    }
  }
} 
```

我在这里坚如磐石吗？有没有更好、更简洁/优雅/健壮的方式来确保“连接”永远不会“空”？

编辑：

我添加了一个 jdbcConnection.isValid() 检查，但我忽略了输入验证。我会在实际代码中这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T17:05:12.400

对我来说看上去很好。

你可以做几件事来改进你的代码。

首先，您应该始终将先决条件放在首位。在您的情况下，首先检查方法输入，例如`jdbcConnectionParameters`

`Exception`其次，由于所有捕获的异常都会重新抛出，因此您可以通过使用自定义异常捕获和重新抛出来捕获所有异常。

就像是：

```
try {
      if (jdbcConnectionParameters.driverNeedsHelpRegisteringUsingClassForName()) {
        Class.forName(jdbcConnectionParameters.getClassForNameDriverRegistrationString());
      }
      jdbcConnection = DriverManager.getConnection(jdbcConnectionParameters.getJbdcConnectionUrl());
} catch (Exception exception) {
      exception.printStackTrace();
      throw new JdbcConnectionManager.JdbcConnectionFailureException(exception);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T17:05:27.337

从 try 块内部返回连接会更清楚：

```
public static Connection getJdbcConnection(
              JdbcConnectionParameters jdbcConnectionParameters)
                                     throws JdbcConnectionFailureException {
    try {
        if (jdbcConnectionParameters.driverNeedsHelpRegisteringUsingClassForName()) {
            Class.forName(jdbcConnectionParameters
                                .getClassForNameDriverRegistrationString());
        }
        return DriverManager.getConnection(jdbcConnectionParameters
                   .getJbdcConnectionUrl());
        // TODO: perform further validation on the connection
    } 
    catch (ClassNotFoundException classNotFoundException) {
        throw new JdbcConnectionManager.JdbcConnectionFailureException(
            classNotFoundException);
    } 
    catch (SQLException sqlException) {
        throw new JdbcConnectionManager.JdbcConnectionFailureException(
            sqlException);
    }
} 
```

编辑：回答你关于死代码的问题：

jdbcConnection 在这个地方不能为空，因为如果它为空，就会在该行抛出 NPE

```
if (!jdbcConnection.isValid(...)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T17:05:29.980

你的代码很好，但对我来说你有点过于复杂了：

```
public static Connection getJdbcConnection(
  JdbcConnectionParameters jdbcConnectionParameters)
  throws JdbcConnectionFailureException {
    try {
      if (jdbcConnectionParameters.driverNeedsHelpRegisteringUsingClassForName()) {
        Class.forName(jdbcConnectionParameters
            .getClassForNameDriverRegistrationString());
      }
      return DriverManager.getConnection(jdbcConnectionParameters.getJbdcConnectionUrl());
    } catch (ClassNotFoundException classNotFoundException) {
      throw new JdbcConnectionManager.JdbcConnectionFailureException(classNotFoundException);
    } catch (SQLException sqlException) {
      throw new JdbcConnectionManager.JdbcConnectionFailureException(sqlException);
    }
} 
```

还可以考虑使用`DataSource`and `JdbcTemplate`from [spring](/questions/tagged/spring "显示标记为“春天”的问题")。如果您将该异常作为原因传递并重新抛出，也不要这样做`printStackTrace()`- 它将被记录两次。

# c - c返回int值不起作用

> ID：10962825
> 
> 赞同：0
> 
> 时间：2012-06-09T16:57:49.983
> 
> 标签：c, function, return-value

这是我的代码：

```
#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>
#include <pthread.h>

int num_mezzo_1(int num_orig);
int num_mezzo_2(int num_orig);

int main(int argc, char *argv[]){
    int num,contatore,tmp=0,tmp_1,tmp_2;
    num=atoi(argv[1]);
    if(num <= 3){
        printf("%d è primo\n", num);
        exit(0);
    }
    else{
        num_mezzo_1(num);
        num_mezzo_2(num);
        tmp=tmp_1+tmp_2;
            //using printf to debug
        printf("t1 %d, t2 %d\n", tmp_1,tmp_2);
        if(tmp>2){
            printf("%d NON è primo\n", num);
        }
        else{
            printf("%d è primo\n", num);
        }
    }
    exit(0);
}

int num_mezzo_1(int num_orig){
    int tmp_1=0,cont_1;
    for(cont_1=1; cont_1<=(num_orig/2); cont_1++){
        if((num_orig % cont_1) == 0){
            tmp_1++;
        }
    }
    //using printf to debug
    printf("\n%d\n", tmp_1);
    return tmp_1;
}

int num_mezzo_2(int num_orig){
    int tmp_2=0,cont_2;
    for(cont_2=((num_orig/2)+1); cont_2<=num_orig; cont_2++){
        if((num_orig % cont_2) == 0){
            tmp_2++;
        }
    }
    //using printf to debug
    printf("\n%d\n\n", tmp_2);
    return tmp_2;
} 
```

这个程序计算一个数字是否是素数。
如果我将数字 13 作为输入，则函数`num_1`的值为in且函数的值为`1`into并且两者都是正确的。 问题是返回一个**很大很大**的值，我不明白为什么。`tmp_1``num_2``1``tmp_2`
`tmp=tmp_1+tmp_2`

 *** * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T17:01:42.380

您正在调用这些函数`num_mezzo_1()`，`num_mezzo_2()`但您没有存储它们的返回值，因此您的变量`tmp_1`并`tmp_2`保持未初始化。

**编辑：**尝试更改代码

```
 num_mezzo_1(num);
    num_mezzo_2(num); 
```

到

```
 tmp_1 = num_mezzo_1(num);
    tmp_2 = num_mezzo_2(num); 
```

在 else 块中，看看你是否得到了你所期望的。

工作代码：

```
tmp=(num_mezzo_1(num)+num_mezzo_2(num)); 
```**

# jquery - 切换不适用于 IE 6

> ID：10962826
> 
> 赞同：0
> 
> 时间：2012-06-09T16:58:13.423
> 
> 标签：jquery, html, internet-explorer-6

我有这段代码在 IE 8 和 firefox 上运行良好

```
 <script type="text/javascript">
 function toggleDiv(divId) {
    $("#"+divId).toggle(); 
}
 </script>

 </head>

 <body>

 <br />
 <br />

 <a href="javascript:toggleDiv('myContent');">>> press 2 xxexamplexx</a>
 <div id="myContent" class='hidden'>
 <ul>

 <a href="javascript:toggleDiv('myContent1');"><div><li>xxexamplexx </li></div></a>
 <div id="myContent1" class='hidden'>

 <a href="javascript:toggleDiv('myContent2');">
 <li style="margin-left:7em;">xxexamplexx</li></a>
 <div id="myContent2" class='hidden'>
 <a href="javascript:toggleDiv('myContent3');">
 <li style="margin-left:10em;">xxexamplexx</li></a>
 <div id="myContent3" class='hidden'>
 <a href="javascript:toggleDiv('myContent4');">
 <li style="margin-left:11em;">xxexamplexx</li></a>
 <div id="myContent4" class='hidden'>
 <a href="javascript:toggleDiv('myContent5');">
 <li style="margin-left:14em;">xxexamplexx</li></a>
 <div id="myContent5" class='hidden'>
 <li style="margin-left:16em;"><b>xxexamplexx.</b></li>
 </div>

 </div>

 <a href="javascript:toggleDiv('myContent6');">
 <li style="margin-left:11em;">xxexamplexx</li></a>
 <div id="myContent6" class='hidden'>
 <li style="margin-left:14em;"><b>xxexamplexx</b></li>
 </div>

 </div>

 <div class="space"></div>
 </div><!--content2-->
 </div> 
```

当我在 IE 6 上测试它时，一半的切换不起作用，并且默认显示它们，当我第一次加载页面时，它们将被显示。

知道如何解决这个问题吗？

它也不适用于 IE 7。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T20:42:48.100

你在这段代码中有混乱。你应该这样构建：

```
<ul>
  <li>
    <a>link</a>
    <ul>
      <li>
        no-link
      </li>
      <li>
        <a>link</a>
        <ul>
          ...
        </ul>
      </li>
  </li>
  <li>
    <a>link</a>
    <ul>
      ...
    </ul>
  </li>
</ul> 
```

然后添加 ids、hrefs 并使用你的函数，或者更好地使用这样的函数：

```
$("ul a").click(function(){
  $(this).parent().children("ul").toggle();
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T20:49:04.743

当页面加载那些 id 以`myContent`

```
$(document).ready(function(e){
    $('div[id^="myContent"]').toggleClass('hidden');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T20:39:21.647

我建议通过[W3C Validator](http://validator.w3.org/)运行您的代码。这将告诉您您遇到的 HTML 错误。

例如，您在 a 中有一个`<a>`标签`<ul>`，但在 a 中没有`<li>`。这是无效的。

该页面在某些浏览器中可能呈现正常，但是对于这样的 HTML 错误，您可能会发现它在某个地方存在问题。先解决这些问题。

# entity-framework - Linq to entity 无法将类型“string”隐式转换为“bool”linq 查询

> ID：10962828
> 
> 赞同：0
> 
> 时间：2012-06-09T16:58:19.493
> 
> 标签：entity-framework, linq-to-entities

我正在处理 asp.net 应用程序，并且我创建了一个查询。我想更改它，以便如果选中复选框，则无法输入字段的空记录。我的查询如下所示：

```
var query = from d in context.data_vault.Where(d => states.Contains(d.STATE) 
    && counties.Contains(d.COUNTY)
    && cities.Contains(d.CITY)
    && zipCodes.Contains(d.ZIP)
    && areaCodes.Contains(d.AREA_CODE)
    && (d.MKTVAL > Convert.ToInt32(txtMarketValueFrom) && d.MKTVAL < Convert.ToInt32(txtMarketValueTo.Text))
    && (d.LTV > Convert.ToByte(txtLTVFrom.Text ) && d.LTV < Convert.ToByte(txtLTVTo.Text))
    && d.FHA_LIMIT_FLAG == chkFHA.Checked
    && (d.MTGAMT > Convert.ToInt32(txtMortgageFrom.Text) && d.MTGAMT < Convert.ToInt32(txtMortgageTo.Text))
    && (d.MTGDATE > Convert.ToDateTime(txtMortgageDateFrom.Text) && d.MTGDATE < Convert.ToDateTime(txtMortgageDateTo.Text))
    && d.LOAN_TYPE == drpMortgageLoanType.Text
    //&& (chkLenderName.Checked )  d.LENDERNAME != null  
    && lenderNames.Contains(d.LENDERNAME)
    //&& rdoexcludeSecondMortgage.Checked ? d.HE == "" : rdoexcludeSecondMortgage.Checked
    //&& d.HEAMT = txtSecondMortgageFrom.Text
    && d.HE_LOAN_TYPE == drpSecondMortgageLoanType.SelectedItem.Text
    && d.HELENDERNAME == txtSecondMortgageLenderName.Text
    && (d.AGE > Convert.ToByte(txtAgeFrom.Text) && d.AGE < Convert.ToByte(txtAgeTo.Text)
    //rdoNoPhone.Checked ? d.phones
    ))
    group d by new
    {
        d.STATE
    } into g
    select new
    {
        g.Key.STATE,
        Count = (Int32?)g.Sum(p => p.SCORE),
        Phone = (Int64?)g.Count(p => p.PHONE != null)
    };

GridView1.DataSource = query;
GridView1.DataBind(); 
```

如何更改它，以便如果选中 rdoNoPhone.Checked 单选按钮，则不包括具有空电话的记录

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T17:40:58.057

尝试像这样更改您的符号：

```
 var query = from d in context.data_vault.Where(delegate(ata_vault d){

  return states.Contains(d.STATE) 
    && counties.Contains(d.COUNTY)
    && cities.Contains(d.CITY)
    && zipCodes.Contains(d.ZIP)
    && areaCodes.Contains(d.AREA_CODE)
    && (d.MKTVAL > Convert.ToInt32(txtMarketValueFrom) && d.MKTVAL < Convert.ToInt32(txtMarketValueTo.Text))
    && (d.LTV > Convert.ToByte(txtLTVFrom.Text ) && d.LTV < Convert.ToByte(txtLTVTo.Text))
    && d.FHA_LIMIT_FLAG == chkFHA.Checked
    && (d.MTGAMT > Convert.ToInt32(txtMortgageFrom.Text) && d.MTGAMT < Convert.ToInt32(txtMortgageTo.Text))
    && (d.MTGDATE > Convert.ToDateTime(txtMortgageDateFrom.Text) && d.MTGDATE < Convert.ToDateTime(txtMortgageDateTo.Text))
    && d.LOAN_TYPE == drpMortgageLoanType.Text
    //&& (chkLenderName.Checked )  d.LENDERNAME != null  
    && lenderNames.Contains(d.LENDERNAME)
    //&& rdoexcludeSecondMortgage.Checked ? d.HE == "" : rdoexcludeSecondMortgage.Checked
    //&& d.HEAMT = txtSecondMortgageFrom.Text
    && d.HE_LOAN_TYPE == drpSecondMortgageLoanType.SelectedItem.Text
    && d.HELENDERNAME == txtSecondMortgageLenderName.Text
    && (d.AGE > Convert.ToByte(txtAgeFrom.Text) && d.AGE < Convert.ToByte(txtAgeTo.Text)
    && rdoNoPhone.Checked ? d.PHONE!= null : true
    })
    group d by new
    {
        d.STATE
    } into g
    select new
    {
        g.Key.STATE,
        Count = (Int32?)g.Sum(p => p.SCORE),
        Phone = (Int64?)g.Count(p => p.PHONE != null)
    }; 
```

# jquery - jQuery如果不是'0'

> ID：10962829
> 
> 赞同：3
> 
> 时间：2012-06-09T16:58:29.780
> 
> 标签：jquery

```
$(".test").css('cursor','pointer');
<div class="test>0</div>
<div class="test>1,000</div> 
```

如何将此应用于非 0 的元素？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T17:00:43.487

```
$(".test").filter(function() {
   return this.innerHTML != '0';
}).css('cursor','pointer'); 
```

**[演示](http://jsfiddle.net/WMVb2/1/)**

### 更正您的 HTML

```
<div class="test">0</div>  <!-- missing closing quote-->
<div class="test">1,000</div> <!-- missing closing quote--> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T17:00:26.377

如果我假设正确，您希望`cursor:pointer`应用于内容不为 0 的 div。尝试使用如下过滤器，

```
$('.test').filter(function () { 
      return $(this).text() != '0'; 
}).css('cursor', 'pointer'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T17:00:46.000

```
$('.test').each(function(){
    if($(this).text() != '0')
        $(this).css('cursor', 'pointer');
}); 
```

但最简单的方法是添加一个不同的类

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T17:01:17.017

你可以使用这样的东西：

```
if($(".test").text() != '0')
  {

     //Your code here   

  } 
```

通过使用 .text() ，它将从选择器中获取文本（如您所想）

# geometry - 根据半径计算三个接触圆的位置

> ID：10962830
> 
> 赞同：0
> 
> 时间：2012-06-09T16:58:38.530
> 
> 标签：geometry, raphael

这最终是一个几何问题。我正在使用 raphaeljs 为一系列数据中的每个项目绘制 3 个区域圆圈。每个圆圈代表一个类别中的项目数。

我希望圆圈接触但不重叠，并且我希望整个集合位于其父 div 的中间。

图在这里：[http ://chriscanipe.com/images/circles.jpg](http://chriscanipe.com/images/circles.jpg)

只知道每个圆的半径以及父 div 的宽度和高度，我将如何计算每个圆的中心的 xy 坐标？我想得越多，我想我实际上是在尝试绘制一个三角形，其中每个角都是圆的 x,y 中心。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T17:46:01.750

在您最初的问题之外，您需要在此处限制或选择许多限制条件。在您的示例图像中，您如何决定旋转由中心形成的三角形？你把三角形的“中心”称为什么？

解决此问题的一种方法可能是：

假设第一个圆在原点 (0,0) 假设第二个圆在这个点的正上方 (0,r1+r2) 计算第三个点——这是两个圆的交点。一个以原点为中心，半径为 r1+r3，另一个以 (0,r1+r2) 为中心，半径为 r2+r3。

现在有了这三个点就可以算出一个“中心”

然后你可以根据这个中心和你的 div 的尺寸来绘制你的圆圈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T17:49:09.400

这被称为[阿波罗尼乌斯圈](http://en.wikipedia.org/wiki/Circles_of_Apollonius)问题。您可以使用链接找到解决方案。

我已经对此进行了迭代推广。给定两条曲线 A 和 B 彼此相切，变换第三条曲线 C 使其与其他两条曲线相切。用户在两条固定曲线上以点选择的形式提供一些提示。算法进行如下：

1.  设 p 和 q 是投影到 A 和 B 上的选定点。
2.  变换 C 使其与 p 和 q 相关。
3.  由于我们不期望 C 在 p 和 q 处与 A 和 B 相切，因此我们需要找到 p 和 q 的新选择。
4.  计算在这些点处相交的曲线在 p 和 q 处的密切圆（或曲率为 0 的线）。
5.  计算圆（和线）之间的交线。
6.  取 p 和 q 作为和弦中点在 A 和 B 上的投影，从 2 开始重复，直到相交的弦足够小。

当然有很多琐碎的细节，但是任何能够实现该算法的人都应该能够解决这些问题。

我很快就会添加插图，但我目前无法访问 Mathematica。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T03:05:21.803

这是我对这个问题的解决方案的实现。它包含许多几何和三角恒等式——但没有调用三角函数。

```
HTML >>>
<!DOCTYPE HTML>
<html>
  <head>
    <title>
      Tangent Circles in a Box
    </title>
    <link rel="stylesheet" href="CSS/tangent_circles.css" type="text/css" />
  </head>
  <body>
    <div id="main_container">
      <div id="inner_container">
        <img class="circle" id="left_circle" src="http://www.clker.com/cliparts/Z/Z/S/Y/S/w/red-circle-cross-transparent-background-md.png" alt="left_circle" />
        <img class="circle" id="right_circle" src="http://www.clker.com/cliparts/Z/Z/S/Y/S/w/red-circle-cross-transparent-background-md.png" alt="right_circle" />
        <img class="circle" id="third_circle" src="http://www.clker.com/cliparts/Z/Z/S/Y/S/w/red-circle-cross-transparent-background-md.png" alt="third_circle" />
      </div>
    </div>
    <div id="userControls">
      <form id="userControlsForm">
        Circle One <input id="circleOneInput" type="text" placeholder="Enter Numeric Value" value=""><br>
        Circle Two <input id="circleTwoInput" type="text" placeholder="Enter Numeric Value" value=""><br>
        Circle Three <input id="circleThreeInput" type="text" placeholder="Enter Numeric Value" value="">
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6/jquery.min.js"></script>
        <script src="JS/tangent_circles.js"></script> 
      </form>
    </div>
  </body>
</html>
HTML <<<

CSS >>>
body 
{
  background-color: white;
}

#main_container
{
  background-color: #cccccc;
  width: 800px;
  height: 800px;
  margin: auto;
  border: solid #cccccc 1px;
  -o-border-radius: 4px;
  -moz-border-radius: 4px;
  -webkit-border-radius: 4px;
  border-radius: 4px;
}   

  #inner_container 
  {     
    width: 100%;
    height: 100%;
    position: relative;
  }   

    .circle
    {
      position: absolute;
      text-align: center;
      font-family: fantasy;
    }
        #left_circle
    {
      top: 0px;
      left: 0px;
      width: 300px;
      height: 300px;
    }

    #right_circle
    {
      top: 0px;
      left: 0px;
      width: 300px;
      height: 300px;
    }

    #third_circle
    {
      top: 0px;
      left: 0px;
      width: 300px;
      height: 300px;
    }

    #userControls
    {
      padding: 30px;
      width: 400px;
      height: 200px;
      margin: auto;
      margin-top: 30px;
      background-color: #dddddd;
    }

      #circleOneInput
      {
        margin-bottom: 10px;
      }

      #circleTwoInput
      {
        margin-bottom: 10px;
      }

#userControls
{
  position: absolute;
  left    : 20px;
  top     : 50px;
  width   : 200px;
}
CSS <<<
 JS >>>
$(function() {
  function changeCircles(){
    $("#inputWarning").remove();
    var radius1 = parseInt( $("#circleOneInput").val(), 10);
    var radius2 = parseInt( $("#circleTwoInput").val(), 10);
    var radius3 = parseInt( $("#circleThreeInput").val(), 10);
    console.log( 'radius1 = ' + radius1 + ', ' +
                 'radius2 = ' + radius2 + ', ' +
                 'radius3 = ' + radius3
      );
    if ( isNaN( radius1 ) || isNaN( radius2 ) || isNaN( radius3 ))
    {
      $("#userControlsForm").after('<span id="inputWarning" style="color: red;">Only Numbers Please</span>');
    }
    else
    { 
      // normalize circle sizes

      if (radius1 < 10)
      {
        radius1 = 10;
      }

      if (radius2 < 10)
      {
        radius2 = 10;
      }

      if (radius3 < 10) 
      {
        radius3 = 10;
      }

      if (radius1 > 150)
      {
        radius1 = 150;
      }

      if (radius2 > 150)
      {
        radius2 = 150;
      }

      if (radius3 > 150)
      {   
        radius3 = 150;
      } 

      // do the actual circle changing
      // 1) calculate
      // 2) animate
      // calculate sides of triangle
      var a = radius2 + radius3;
      var b = radius1 + radius3;
      var c = radius2 + radius1;

      // get dimensions of containing div
      var container_width  = $("#inner_container").width();
      var container_height = $("#inner_container").height();

      var center_x = container_width / 2.0;
      var center_y = container_height / 2.0;

      // calculate cosine and sine of angle inside circle b
      var cos_beta = ((a * a) + (c * c) - (b * b))/(2 * a * c);
      var sin_beta = Math.sqrt( 1 - cos_beta * cos_beta );

      // calculate coordinates of circles a and b
      var Ax = 0;
      var Ay = 0;
      var Bx = radius1 + radius2;
      var By = 0;

      // calculate cosine and sine of angle between triangle and horizontal
      var cos_phi = (Bx - Ax)/c;
      var sin_phi = Math.sqrt( 1 - cos_phi * cos_phi );

      // calculate the cosine and sine of the sum of both angles
      var cos_phiNbeta = cos_phi * cos_beta - sin_beta * sin_phi;
      var sin_phiNbeta = cos_phi * sin_beta + sin_phi * cos_beta;

      // calculate coordinates of circle c
      var Cx = Bx - cos_phiNbeta * a;
      var Cy = By + sin_phiNbeta * a;

      // find centroid
      var centroid_x = (Ax + Bx + Cx) / 3.0;
      var centroid_y = (Ay + By + Cy) / 3.0;

      // get coordinate adjustment
      var adjust_x = center_x - centroid_x;
      var adjust_y = center_y - centroid_y;

      // convert coordinates to div position values
      var A_left = Ax + adjust_x - radius1;
      var A_top  = Ay + adjust_y - radius1;
      var B_left = Bx + adjust_x - radius2;
      var B_top  = By + adjust_y - radius2;
      var C_left = Cx + adjust_x - radius3;
      var C_top  = Cy + adjust_y - radius3;

      // calculate div dimensions
      var A_width  = 2 * radius1;
      var A_height = 2 * radius1;
      var B_width  = 2 * radius2;
      var B_height = 2 * radius2;
      var C_width  = 2 * radius3;
      var C_height = 2 * radius3;

    // the following needs Jquery
      var circle_a = $("#left_circle");
      var circle_b = $("#right_circle");
      var circle_c = $("#third_circle");

      circle_a.animate( {
                        'top'   : A_top + 'px',
                        'left'  : A_left + 'px',
                        'width' : A_width + 'px',
                        'height': A_height + 'px'
                        }, 500 );

      circle_b.animate( {
                        'top'   : B_top + 'px',
                        'left'  : B_left + 'px',
                        'width' : B_width + 'px',
                        'height': B_height + 'px'
                        }, 500 );

      circle_c.animate( {
                        'top'   : C_top + 'px',
                        'left'  : C_left + 'px',
                        'width' : C_width + 'px',
                        'height': C_height + 'px'
                        }, 500 );

    }
  }
  $("#circleOneInput").keyup(changeCircles);
  $("#circleTwoInput").keyup(changeCircles);
  $("#circleThreeInput").keyup(changeCircles);
}); // end ready
 JS <<< 
```

# javascript - javascript“倒计时”未定义错误

> ID：10962831
> 
> 赞同：0
> 
> 时间：2012-06-09T16:58:38.957
> 
> 标签：javascript

我不断收到这条线的“倒计时未定义”

```
 var timeout = setTimeout('countdown()',1000); 
```

`function countdown()`它应该每秒循环一次。我该如何解决这个问题？

```
function countdown() {

var until = $('.time-elapsed').attr('data-time');
var nextmonth = new Date(until);
var now = new Date();
var timeDiff = nextmonth.getTime() - now.getTime();

if(timeDiff <=0) {
var nextmonth = new Date(until);
}

var seconds = Math.floor(timeDiff / 1000);
var minutes = Math.floor(seconds / 60);
var hours = Math.floor(minutes / 60);
var days =  Math.floor(hours / 24);

hours%=24;
minutes%=60;
seconds%=60;

$('.time-elapsed').find('ul:eq(0)').find('li:eq(1)').html(days);
$('.time-elapsed').find('ul:eq(1)').find('li:eq(1)').html(hours);
$('.time-elapsed').find('ul:eq(2)').find('li:eq(1)').html(minutes);
$('.time-elapsed').find('ul:eq(3)').find('li:eq(1)').html(seconds);

var timeout = setTimeout('countdown()',1000);

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T16:59:46.723

不要使用字符串作为 setTimeout 的第一个参数。使用一个函数：

```
var timeout = setTimeout(countdown,1000); 
```

我建议您在函数底部使用`setInterval(countdown,1000)`和删除`setTimeout(countdown,1000)`。将无限`setInterval`重复该功能。`countdown`

要停止它，只需使用`clearInterval(timeout);`

# clang - Stmt::viewAST 仅在带有 Graphviz 或 gv 的系统上的调试版本中可用

> ID：10962845
> 
> 赞同：2
> 
> 时间：2012-06-09T17:00:34.650
> 
> 标签：clang, graphviz, abstract-syntax-tree

我一直在尝试使用以下命令使 clang 2.9 输出带有 graphviz 的 AST：

```
./clang -cc1 -ast-view smd.c 
```

但是它在控制台上输出代码并抱怨：

> Stmt::viewAST 仅在带有 Graphviz 或 gv 的系统上的调试版本中可用！

在 llvm[文档](http://llvm.org/docs/ProgrammersManual.html)中提到`/Applications/Graphviz.app/Contents/MacOS/`应该添加到路径中。我这样做了，`export PATH=$PATH:/Applications/Graphviz.app/Contents/MacOS/`但仍然无法正常工作。

同样在同一文档中提到：

> 让它工作需要少量的配置。在带有 X11 的 Unix 系统上，安装 graphviz 工具包，并确保 'dot' 和 'gv' 在你的路径中。如果您在 Mac OS/X 上运行，请下载并安装 Mac OS/X Graphviz 程序，并将 /Applications/Graphviz.app/Contents/MacOS/（或安装它的任何位置）添加到您的路径。设置好系统和路径后，重新运行 LLVM 配置脚本并重建 LLVM 以启用此功能。

我不知道这个配置在哪里并重建 LLVM（我所做的只是下载[llvm+clang 2.9](http://llvm.org/releases/download.html#2.9)包并直接从文件夹中运行命令。

关于我的graphviz版本：

```
$ dot -v
dot - graphviz version 2.28.0 (20111028.1807) 
```

但是该`gv`命令不可用，我似乎无法在谷歌上找到它应该位于或获取的位置。

对此有任何线索吗？问题本身是**如何将 clang 2.9 输出到 graphviz**。我只是相信这与我的机器上找不到的这个 gv 有关，但我可能会被误导。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T00:34:03.917

由于我必须通过一些奇怪的细节才能使其正常工作，而且我认为这不是 Mac OS Lion 用户的直接方法，所以我发现如果有人像我一样因为看似简单的事情而陷入困境一条线任务。

1.  首先，在任何事情之前，您可能想检查您是否有 graphviz 和 gv，正如我在最初的问题中所提到的，如果您遇到与我相同的情况，您会听到关于 graphviz 或 gv 的叮当声。虽然仅使用 google 就可以相对容易地找到[graphviz](http://www.graphviz.org/)，但 gv 在我看来并不像，因为它在他们的官方网站上缺少它的名字，即[GNU gv](http://www.gnu.org/software/gv/)。

2.  您应该可以轻松安装 graphviz，但 gv 可能不会。它抱怨一个名为`Xaw3d`. 他们的[网站](http://directory.fsf.org/wiki/Xaw3d)包含一个不是那么最新的版本（2003），但这就是我们要做的。如果您像我一样不幸，您会发现下载已损坏。幸运的是，一位朋友向我指出了[麻省理工学院的这个网站](http://web.mit.edu/mfloyd/www/computing/mac/gv/)，该网站有人不得不处理这个问题，因此为我节省了很多时间。在我回答这个问题时，它是最近的（2012 年 5 月），所以它也应该对你有用。我在这里发布我实际使用的内容，以防该页面出现故障：

3.  获取[.zip](http://xorg.freedesktop.org/archive/individual/lib/libXaw3d-1.6.tar.bz2)或[tar](http://xorg.freedesktop.org/archive/individual/lib/libXaw3d-1.6.tar.gz)版本的`gv`.

4.  `pkg-config utility`通过运行避免：

> $ ./configure X11_CFLAGS='-I/usr/X11/include/X11' X11_LIBS='-L/usr/X11/lib -lX11 -lXext -lXmu -lXt'

在`ibXaw3d-1.6`控制台上的目录中。

其次是：

> 制作
> 
> 须藤使安装
> 
> 打扫干净

完成后返回并安装 gv，如果它不起作用，请更改他们的代码，这对我来说也是错误的（在一行上缺少一些参数，这使得安装无法完成），正如 MIT 页面提到的：

改变`Scrollbar.c`：

> (*swclass->threeD_class.shadowdraw) (w, event, region, FALSE);

到

> (*swclass->threeD_class.shadowdraw) (w, event, region, sbw->threeD.relief, FALSE);

在 MAC 上，如果未运行以下命令，它也会抱怨僵尸进程，以防万一，作者还建议以这种方式完成配置：

> ./configure --x-includes=/usr/X11/include/X11 --x-libraries=/usr/X11/lib --enable-SIGCHLD-fallback

最后如果你运行 gv 应该是可用的`$gb whatever.ps`。如果您想知道，这是它的用途之一，如果不是全部，请打开 .ps（我没有费心去看它，因为它不是最初的目的）。

* * *

现在，如果您仍然像我一样不走运，那么运行相同的东西将行不通。

感谢 Joey（下面评论中的人）和[LLVM 邮件列表](http://comments.gmane.org/gmane.comp.compilers.llvm.devel/50578)的人，我发现我应该在调试模式下运行构建。

现在看来，如果您像我最初为 MAC OS 下载的二进制文件一样，出于优化原因，它会自动进入**非**调试模式（快 10 倍左右，我在控制台上的输出之一）。

如果您转到[此页面](http://llvm.org/releases/download.html)并按照 1\. 到 5\. 您将按照该页面上的说明获得已处于调试模式的最新版本。

确保您打开`LLVM/Debug+Accerts/bin/clang`并从该叮当声中执行。结果应该在 gv 上用树打开一个 GUI。

* * *

正如您可能注意到的那样，我必须继续使用最新版本。有一种方法可以根据[llvm getting started](http://llvm.org/docs/GettingStarted.html)在 llvm compile 的 debug 模式下编译。基本上这一段说明了一切：

> 这些构建使用 --enable-optimized 选项来配置或通过在 gmake 命令行上指定 ENABLE_OPTIMIZED=1 来启用。对于这些构建，构建系统将编译启用 GCC 优化的工具和库，并从它生成的库和可执行文件中去除调试信息。请注意，使用 LLVM 发行版时，Release Builds 是默认的。

虽然我收到了一些似乎证实我在调试模式下成功编译 2.9 的消息，例如：

> llvm[0]: *****完成调试构建
> 
> llvm[0]: *****注意：调试构建可能比
> 
> llvm[0]: *****优化构建。使用 make ENABLE_OPTIMIZED=1 到
> 
> llvm[0]: *****进行优化构建。或者，您可以
> 
> llvm[0]: *****使用 --enable-optimized 进行配置。

做同样的事情（在这种情况下，文件夹只被调用`Debug`而不是`Debug+Asserts`），但是对于 2.9 进行相同的过程不起作用。**如果有人知道为什么，请让我知道，因为我仍然对 2.9 感兴趣，**但总而言之，最后在视觉上看到它是有效的。**我仍然不知道为什么它只在 gv 上输出而不在 graphviz 上输出**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-19T16:54:07.960

虽然这个答案是在 6 年后才出现的，但它可能会增加一种更简单的方法来解决相同的问题。我今天面临同样的问题，我使用自制软件解决了它。

1.  berw cask install Graphviz
2.  brew cask install xquartz # gv 的依赖
3.  酿造桶安装gv

此外，请确保您使用的 clang 是调试版本，正如 OP 所提到的。

# arduino - 使用 Arduino 设置 AVR Studio

> ID：10962848
> 
> 赞同：0
> 
> 时间：2012-06-09T17:01:06.457
> 
> 标签：arduino, atmel, avr-studio5, avr-studio4

我尝试设置 AVR studio 5.1 和 6 来使用我的 Arduino 库。我遵循的说明在这里： [http](http://www.engblaze.com/tutorial-using-avr-studio-5-with-arduino-projects/) ://www.engblaze.com/tutorial-using-avr-studio-5-with-arduino-projects/ 我的项目包括必要的库，它们位于同一目录中。它们也已添加到 AVR Studio 中的项目中。我仍然遇到对所有内容的未定义引用的问题。

我的问题是：我该如何解决这个问题？跳过上述说明中的所有环节后，还有其他人有同样的问题吗？

我应该使用 AVR Studio 4 吗？有同样的问题吗？我应该跳过 AVR Studio 而使用 Eclipse 吗？

先谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T02:32:16.300

当您说您已将库添加到项目中时，您的意思是您已将它们添加到编译器源目录，还是将库源文件作为“现有项”添加到项目本身？

未定义的引用通常会出现，因为源文件尚未作为链接添加到项目中。如果未添加它们以使其显示在解决方案资源管理器中，则 Studio 不会将它们作为构建目标添加到 Makefile。未定义的错误是链接器在找不到已编译的目标文件时抱怨（因为它们从未构建过）。具体来说，这在我们的 Studio 5 教程的第 11 步“编译器和链接器设置”中。

这意味着您必须在两个地方添加库（C++ 编译器设置和作为项目本身的链接/现有项）。如果您已经完成了这两件事，我不确定发生了什么，因为这对我们总是有效的。您还可以查看我们更新的教程，了解如何将[Arduino 与 Atmel Studio 6 结合](http://www.engblaze.com/tutorial-using-atmel-studio-6-with-arduino-projects/)使用，尽管它使用相同的基本策略。

编辑：作为附录，如果您不喜欢 Atmel Studio 工作流程，可以使用 Eclipse：[http](http://arduino.cc/playground/Main/DevelopmentTools) ://arduino.cc/playground/Main/DevelopmentTools 可能会出现一些相同的问题，因为您仍然设置自定义工具链来复制 Arduino IDE。您的特定里程可能会有所不同。

AVR Studio 4 基于 Eclipse。在这一点上它已经很老了，但也有一个明确定义的工作流程，所以如果你不需要新功能，它很有可能会起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T20:55:11.343

代码块也很棒。您可以将这个 Arduino 特定版本与向导和模拟器一起使用，一切准备就绪。 [http://www.arduinodev.com/codeblocks/](http://www.arduinodev.com/codeblocks/)

# android - 将 SWF 移植到 Android 动态壁纸的步骤

> ID：10962849
> 
> 赞同：1
> 
> 时间：2012-06-09T17:01:08.013
> 
> 标签：android, actionscript-3, flash, air, live-wallpaper

我有一个几年前制作的简单 SWF 视频循环，看起来不错，我想把它做成我的 android 设备的动态壁纸。

是否可以在不重写太多的情况下做到这一点？

我设置了我的 Android SDK，并发现一些信息散布在诸如...

1.  Android 教程：[CubeLiveWallpaper](https://developer.android.com/resources/samples/CubeLiveWallpaper/index.html)
2.  [创建 Android 动态壁纸](http://www.codeproject.com/Articles/108390/How-To-Create-Android-Live-Wallpaper)和
3.  [这个 SO 线程](https://stackoverflow.com/questions/3657963/is-it-possible-to-embed-a-flex-component-in-a-pure-java-android-application)

我知道在 android 中有 swf 意味着我需要 adobe air，这可能会减慢应用程序的速度。所以，

1.  这可能吗？
2.  对于将 SWF 移植到 Android 动态壁纸，我还应该知道什么教程式的吗？
3.  有没有更好的方法来做到这一点，仍然需要最少的修改？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T16:52:40.183

您可能无法将 SWF 直接嵌入壁纸中。看起来动态墙纸使用特定的绘图 API...也就是说，您可以做的是将 swf（如果它更像是电影而不是交互式）导出到 .mov... 一旦它是 . mov 文件，您可以轻松地将其制作为您想要的任何视频格式。将它们嵌入动态壁纸而不是 swf 可能会更好。所以你可以使用这个： http: [//forum.xda-developers.com/showthread.php?t=804720](http://forum.xda-developers.com/showthread.php?t=804720) 这让你可以为任何支持大量编解码器的视频设置动态壁纸。

# c - bsearch 对按降序排序的数组

> ID：10962854
> 
> 赞同：0
> 
> 时间：2012-06-09T17:01:25.487
> 
> 标签：c, binary-search, libc, bsearch

我有一个按降序排序的数组，没有重复。我可以使用 libc 中的 bsearch 函数对其执行二进制搜索吗？为此，我是否需要更改传递给它的比较函数？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T17:05:36.433

是的，您可以使用`bsearch`. 您需要确保您的`compare`函数与数组的排序顺序一致。在您的情况下，这可能意味着在逻辑上反转正常的升序/等于/降序。

# php - 由于冒号而没有获取 xml 节点

> ID：10962857
> 
> 赞同：3
> 
> 时间：2012-06-09T17:02:05.753
> 
> 标签：php, xml, simplexml

我有一个 XML 文档，它使用斜杠：注释。当我使用 php 尝试检索这些节点中的内容时，它只是不起作用。

这是我的代码：

```
 <?php
$rss = new DOMDocument();
$rss->load('http://terrodactyl.netau.net/wordpress/?feed=rss2');
$feed = array();
foreach ($rss->getElementsByTagName('item') as $node) {
    $item = array ( 
        'title' => $node->getElementsByTagName('title')->item(0)->nodeValue,
        'desc' => $node->getElementsByTagName('description')->item(0)->nodeValue,
        'link' => $node->getElementsByTagName('link')->item(0)->nodeValue,
        'date' => $node->getElementsByTagName('pubDate')->item(0)->nodeValue,
                    'commentcount' => $node->getElementsByTagName('slash:comments')->item(0)->nodeValue,
                    'creator' => $node->getElementsByTagName('dc:creator')->item(0)->nodeValue,
        );
    array_push($feed, $item);
}
$limit = 5;
for($x=0;$x<$limit;$x++) {
    $title = str_replace(' & ', ' &amp; ', $feed[$x]['title']);
    $link = $feed[$x]['link'];
    $description = $feed[$x]['desc'];
    $date = date('l F d, Y', strtotime($feed[$x]['date']));
            $creator = $feed[$x]['creator'];
            $comments = $feed[$x]['commentcount'];
    echo "<div class=’blogpost primary_wide4’&gt;<h2>";
            echo "<h2>".$title."</h2><img class='left' src='images/image02.jpg' width='250' height='272' alt='' />";
    echo "<h3>Posted on ".$date."</h3>";
    echo "<p>".$description."</p>";
            echo "<p class='meta'>";
            echo "<span class='comments'><a href='".$link."'>".$comments."Comments</a></span>  ";
            echo " <span class='readmore'><a href='".$link."'> View Post</a></span></p>";
            echo "</div><br><br>";
}
?> 
```

我如何访问数据（在本例中为 0）：

```
<slash:comments>0</slash:comments> 
```

使用 php？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-09T17:31:23.693

如果您尝试读取包含命名空间的标签，您将使用[getElementsByTagNamesNS函数。](http://www.php.net/manual/en/domdocument.getelementsbytagnamens.php)从该提要的 XML 来看，其内容类似于：

```
$slashNS = "http://purl.org/rss/1.0/modules/slash/";
echo $node->getElementsByTagNameNS($slashNS, 'comments')->item(0)->nodeValue; 
```

# c# - 使用 StringBuilder.AppendFormat 格式化字符串未按预期工作

> ID：10962860
> 
> 赞同：3
> 
> 时间：2012-06-09T17:02:22.960
> 
> 标签：c#, string, format

我正在尝试使用 StringBuilders AppendFormat 方法创建一个包含数据的表。我希望第二列和第三列中的文本左对齐。

这是我在谷歌上找到的一个例子： [http ://www.csharp-examples.net/align-string-with-spaces/](http://www.csharp-examples.net/align-string-with-spaces/)

但是，使用与网站相同的代码，我会得到不同的结果。第二列文本的位置取决于第一列文本的长度。我做错了吗？有没有更好的方法更适合这项任务？我想要从第一列的第一个字符到第二列的第一个字符有一定的空间（如 c++ 中的 setw() 方法）

```
symbolTableToString.AppendFormat(" {0,-20}  {1,-10}  {2,-10} {3,-10}",dataNode.token, dataNode.tokenClass, dataNode.tokenMode, dataNode.alias).AppendLine(); 
```

我将每一行放入一个文本框中，并且无法使用不同的小部件，因为这是家庭作业的一部分。![在此处输入图像描述](../Images/d216976c14dc804875e398ae72c3ab49.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T17:21:01.343

你的文本框有一个可变宽度的字体，所以使用空格数来对齐列几乎不会很好。将文本框的 Font 属性更改为固定宽度字体，例如 Courier New。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T17:12:44.200

您的问题不是 AppendFormat，它实际上似乎工作正常。将该文本框设置为使用等宽字体，例如 Courier New 或 Consolas。

# c# - 何时在 C# 中使用 Delegate，为什么以及它在不同的线程上工作？

> ID：10962862
> 
> 赞同：-4
> 
> 时间：2012-06-09T17:02:46.203
> 
> 标签：c#, .net, delegates

我知道这个问题已经被问了很多，但是我需要一个非常实用的方式来回答我所问的所有问题，最好是使用代码示例。什么时候应该在 C# 中使用委托方法？如何使用它？我为什么要使用它？它与多线程有什么关系？

任何答案表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T17:12:12.297

委托基本上是一个方法指针。它具有对该方法及其对象的引用（当然，除非它是静态方法）。

每当您需要调用一个方法但调用它的代码不知道它是哪个方法时，您都可以使用委托。最常见的原因是调用该方法的代码是在该方法之前编写的，例如像`List<T>.Sort(comparison)`.

委托不会在不同的线程上调用该方法，而是在与使用委托的代码相同的线程上调用该方法。当在不同的线程上调用方法时，这是因为使用委托的代码已经在不同的线程上运行，或者专门为该方法启动了一个新线程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T17:05:25.993

委托是一个函数指针，它指向像 C 中的任何函数。您可以将委托作为参数传递给其他函数。

您可以将其用于回调函数、线程​​等。

有关更多信息，请查看此[MSDN](http://msdn.microsoft.com/en-us/library/ms173171%28v=vs.80%29.aspx)链接

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T21:33:28.120

关于多线程 Delegate.BeginInvoke 用于在后台线程中调用方法。委托还用于将函数引用传递给其他多线程结构，如 ThreadPool 后台工作程序等。

# c++ - 指向向量的指针的指针

> ID：10962865
> 
> 赞同：0
> 
> 时间：2012-06-09T17:03:39.617
> 
> 标签：c++, vector

我错了什么？

```
vector<vector<unsigned int> *> *matrix
matrix = new vector<vector<unsigned int> *>(n);
for (vector<vector<unsigned int> *>::size_type i = 0; i < n; i++) {
    matrix->at(i) = new vector<unsigned int>(i + 1);
}

... 
```

编码

```
vector<int> *myVector2 = new vector<int>(500000000);
for(size_t i = 0; i < myVector->size(); i++) {
    myVector->at(i) = i;
}
delete myVector; 
```

工作正常。我需要使用一个非常大的矩阵 - 大到无法保存整个矩阵，我需要动态更改内存使用情况（有时只存储一些行，并非所有行都已满（我只需要先查看 k它们的元素）等）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T17:15:11.433

`new`可能在这里没有任何帮助。的主要目的`vector`是照顾呼叫`new`您。

```
typedef vector<vector<unsigned int> > matrix_t;
matrix_t matrix( n );
std::size_t row_index = 0;
for ( matrix_t::iterator i = matrix.begin(); i != matrix.end(); ++ i ) {
    i.resize( row_index + 1 );
    ++ row_index;
} 
```

当您想要更改行数或长度时，请调用`matrix.resize()`或`matrix[n].resize()`。这最大限度地减少了分配的数量。但最好将所有内容映射到单个平面向量，该向量与您需要的最大矩阵一样大。动态释放和重新分配事物会导致各种低效率，例如不必要的缓存未命中和 VM 分页。

**编辑：**当使用 缩小向量时`resize`，通常不会释放其内存。你需要使用一个技巧：

```
std::vector< unsigned int >( new_row_length ).swap( v ); 
```

请注意，这仅在使向量更小时才有帮助；变大或变化较小时，最好坚持`resize`。

最好的解决方案可能是找到现有的线性代数库并使用现有的三角矩阵类。

# c# - 在 switch 语句中分配了无法访问的变量

> ID：10962875
> 
> 赞同：0
> 
> 时间：2012-06-09T17:04:53.657
> 
> 标签：c#, switch-statement

我有以下代码。一个 switch 语句，它接受一个状态名称并将另一个变量设置为该状态的缩写。但是，在我关闭我的 switch 语句后，我收到一条错误消息，指出该变量无法访问。

```
string stateab;

switch (s)
{
    case "Alabama":
        stateab = "AL";
        break;
    case "Alaska":
        stateab = "AK";
        break;
    case "Arizona":
        stateab = "AZ";
        break;
    case "Arkansas":
        stateab = "AR";
        break;
    case "California":
        stateab = "CA";
        break;
    case "Colorado":
        stateab = "CO";
        break;
    case "Connecticut":
        stateab = "CT";
        break;
    case "Delaware":
        stateab = "DE";
        break;
    case "DENIED":
        stateab = "DENIED";
        break;
    case "District of Columbia":
        stateab = "DC";
        break;
    case "Florida":
        stateab = "FL";
        break;
    case "Georgia":
        stateab = "GA";
        break;
    case "Hawaii":
        stateab = "HI";
        break;
    case "Idaho":
        stateab = "ID";
        break;
    case "Illinois":
        stateab = "IL";
        break;
    case "Indiana":
        stateab = "IN";
        break;
    case "Iowa":
        stateab = "IA";
        break;
    case "Kansas":
        stateab = "KS";
        break;
    case "Kentucky":
        stateab = "KY";
        break;
    case "Louisiana":
        stateab = "LA";
        break;
    case "Maine":
        stateab = "ME";
        break;
    case "Maryland":
        stateab = "MD";
        break;
    case "Massachusetts":
        stateab = "MA";
        break;
    case "Michigan":
        stateab = "MI";
        break;
    case "Minnesota":
        stateab = "MN";
        break;
    case "Mississippi":
        stateab = "MS";
        break;
    case "Missouri":
        stateab = "MO";
        break;
    case "Montana":
        stateab = "MT";
        break;
    case "Nebraska":
        stateab = "NE";
        break;
    case "Nevada":
        stateab = "NV";
        break;
    case "New Hampshire":
        stateab = "NH";
        break;
    case "New Jersey":
        stateab = "NJ";
        break;
    case "New York":
        stateab = "NY";
        break;
    case "North Carolina":
        stateab = "NC";
        break;
    case "North Dakota":
        stateab = "ND";
        break;
    case "Ohio":
        stateab = "OH";
        break;
    case "Oklahoma":
        stateab = "OK";
        break;
    case "Oregon":
        stateab = "OR";
        break;
    case "Pennsylvania":
        stateab = "PA";
        break;
    case "Rhode Island":
        stateab = "RI";
        break;
    case "South Carolina":
        stateab = "SC";
        break;
    case "South Dakota":
        stateab = "SD";
        break;
    case "Tennessee":
        stateab = "TN";
        break;
    case "Texas":
        stateab = "TX";
        break;
    case "Utah":
        stateab = "UT";
        break;
    case "Vermont":
        stateab = "VT";
        break;
    case "Virginia":
        stateab = "VA";
        break;
    case "Washington":
        stateab = "WA";
        break;
    case "West Virginia":
        stateab = "WV";
        break;
    case "Wisconsin":
        stateab = "WI";
        break;
    case "Wyoming":
        stateab = "WY";
        break;

}

Console.WriteLine(stateab); 
```

最后一行给了我一个错误，说明该变量在当前上下文中不存在。有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-09T17:09:45.870

编译器要求您确保`stateab`在读取变量之前为其分配了一些值。在您的情况下，您需要满足值不满足任何`case`子句的情况`s`（即使您的应用程序的逻辑不可能做到这一点）。

您可以通过`stateab`使用初始值初始化变量来轻松解决它：

```
string stateab = ""; 
```

……或者`default`在你的陈述中加入一个子句`switch`：

```
case "Wyoming":
    stateab = "WY";
    break;
default:
    stateab = "Unknown";
    break; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T17:06:18.360

您需要`break;`而不是在每个案例结束时继续..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T17:09:35.507

C#在使用 switch 语句时需要**默认大小写。**没有它就无法编译。最后值得尝试默认情况。

```
default:
   //do something
   break; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T17:09:52.460

这是`switch`声明的格式：

```
switch (expression) {    
      case constant-expression: statement
      jump-statement  
      [default:statement
      jump-statement] 
} 
```

您应该包括一个`default`案例并`break`在每个案例的末尾使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-09T17:11:02.547

你有一个编译器错误，因为局部变量可能保持未初始化，如果你将`switch`一些字符串传递给你的语句，这些字符串不会在案例中列出（例如`"Hello world"`）。因此，您应该在第一次使用本地变量之前对其进行初始化。您可以在声明之前的声明点执行此操作`switch`：

```
string stateab = ""; 
```

或者，您可以将`default`大小写添加到您`switch`引发异常的位置（或提供默认值以缩写）。

```
switch (s)
{
    case "Alabama":
         stateab = "AL";
         break;
    // ...
    default:
         throw new ArgumentOutOfRange("s");
} 
```

.

# javascript - jQuery .each 使用 ajax 加载的内容

> ID：10962878
> 
> 赞同：2
> 
> 时间：2012-06-09T17:05:08.810
> 
> 标签：javascript, ajax, jquery

我有以下功能， func resizeInputText 工作正常。基本上，当我的应用程序通过 ajax 成功加载数据时，我想调用 resizeAll 。

由于在页面加载后内容被拉出，我试图将我的每个代码包装在 .on 事件中。

它不起作用，有谁知道如何执行此操作或如何使用 ajax 加载的内容调用 .each ？

一如既往的感谢！

```
function resizeInputText(obj) {
var boxWidth = ($(obj).val().length * 7) + 1;
    if (boxWidth <= 30) {
        var boxWidth = 30;
    } else if (boxWidth >= 250) {
        var boxWidth = 250;
    }
$(obj).css({width:boxWidth});
}

function resizeAll() {
$("#right-content").on(function () {
    $("input:text").each(function () {
        resizeInputText(this);
    });
});
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T17:11:50.200

您的`.on`方法`resizeAll`没有为其执行函数的事件。[您可以在文档页面上](http://api.jquery.com/on/)看到各种用法，但基本上您需要告诉它要侦听哪个事件，以及在引发该事件时要做什么。Ajax 广播一些您可以使用该`.on`方法绑定到的事件，在这种情况下，“ajaxSuccess”可能适合您。

但是，对您来说更好的方法是`resizeAll`作为 ajax 方法的回调传入，该回调将在 ajaxCall 成功完成时执行。jQuery ajax 语法允许您通过包含选项来做到这一点`success: resizeAll`。在这种情况下，您可以将您的修改`resizeAll`为如下所示：

```
function resizeAll() {
    $("input:text").each(function () {
        resizeInputText(this);
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T17:07:13.173

`success`您可以简单地在AJAX 请求的回调中调用该函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T17:12:07.587

正如 ThiefMaster 所说，您可以执行以下操作：

```
$.ajax({  
url : "requested url",
data : { "data to be send "},
success : function(data) {
   $.each(data, function(index,value) {

     //your code goes here
  });
}
}); 
```

# php - 使用 ajax 进行验证码验证

> ID：10962883
> 
> 赞同：0
> 
> 时间：2012-06-09T17:05:26.500
> 
> 标签：php, javascript, ajax

我正在使用本教程[http://www.crackajax.net/captchaform.php](http://www.crackajax.net/captchaform.php)，但遇到了麻烦。表单或验证码都不会验证。这是我的表单代码：

```
<form action="https://www.salesforce.com/servlet/servlet.WebToLead?encoding=UTF-8" method="POST" name="contact" id="contact" onsubmit="return checkform(this);">

***form elements removed***

<!-- Start Captcha -->
<img src="captcha.php" border="0">
<p>Enter Letters:<input type="text" name="code" value=""><p>
<input type="submit" value="Submit Form" onclick="return checkform()"> 
```

这是我的脚本：

```
<script language="JavaScript">

        var url = 'captcheck.php?code=';
        var captchaOK = 2;  // 2 - not yet checked, 1 - correct, 0 - failed

        function getHTTPObject()
        {
        try {
        req = new XMLHttpRequest();
          } catch (err1)
          {
          try {
          req = new ActiveXObject("Msxml12.XMLHTTP");
          } catch (err2)
          {
          try {
            req = new ActiveXObject("Microsoft.XMLHTTP");
            } catch (err3)
            {
    req = false;
            }
          }
    }
        return req;
    }

        var http = getHTTPObject(); // We create the HTTP Object        

        function handleHttpResponse() {
        if (http.readyState == 4) {
            captchaOK = http.responseText;
            if(captchaOK != 1) {
              alert('The entered code was not correct. Please try again');
              document.contact.code.value='';
              document.contact.code.focus();
              return false;
              }
              document.contact.submit();
           }
        }

        function checkcode(thecode) {
        http.open("GET", url + escape(thecode), true);
        http.onreadystatechange = handleHttpResponse;
        http.send(null);
        }

        function checkform() {
        // First the normal form validation
        if(document.contact.req.value=='') {
          alert('Please complete the "required" field');
          document.contact.req.focus();
          return false;
          }
        if(document.contact.code.value=='') {
          alert('Please enter the string from the displayed image');
          document.contact.code.value='';
          document.contact.code.focus();
          return false;
          }
          // Now the Ajax CAPTCHA validation
          checkcode(document.contact.code.value);
          return false;
        }      
</script> 
```

最后但同样重要的是，这里是 captcha.php 文件：

```
<?php 
//Start a session so we can store the captcha code as a session variable.
session_start();
// Decide what characters are allowed in our string
// Our captcha will be case-insensitive, and we avoid some
// characters like 'O' and 'l' that could confuse users
$charlist = '23456789ABCDEFGHJKMNPQRSTVWXYZ'; 

// Trim string to desired number of characters - 5, say
$chars = 5;
$i = 0;
while ($i < $chars) 
{ 
  $string .= substr($charlist, mt_rand(0, strlen($charlist)-1), 1);
  $i++;
}

// Create a GD image from our background image file
$captcha = imagecreatefrompng('captcha.png');

// Set the colour for our text string
// This is chosen to be hard for machines to read against the background, but
// OK for humans
$col = imagecolorallocate($captcha, 240, 200, 240);

// Write the string on to the image using TTF fonts
imagettftext($captcha, 17, 0, 13, 22, $col, 'Carton-Slab.otf', $string);

// Store the random string in a session variable
$_SESSION['secret_string'] = $string;

// Put out the image to the page
header("Content-type: image/png");
imagepng($captcha);
?> 
```

验证码图像框将显示，字母/数字也将显示，但正如我之前提到的，表单/验证码不会验证。提交表单后，用户将被带到感谢页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T23:58:26.503

我从教程中复制了代码，它可以工作。你没有说 captcheck.php 文件，它存在吗？使用教程中的 captcheck.php 和我必须删除的代码

```
if(document.contact.req.value=='') {
    alert('Please complete the "required" field');
    document.contact.req.focus();
    return false;
} 
```

让它工作。

# ruby - Ruby 1.9.3 中此处文档的语法是否不同？

> ID：10962890
> 
> 赞同：1
> 
> 时间：2012-06-09T17:06:00.227
> 
> 标签：ruby

我目前正在学习 Ruby，并且在我正在使用的教程中遇到了一个奇怪的问题。我正在使用Learn Ruby The Hard Way 中的[这个练习](http://ruby.learncodethehardway.org/book/ex9.html "这个练习")，它不断产生语法错误，我不知道为什么。

我尝试使用的代码是

```
 puts <<-'HERE'
        There's something going on here.
        With the PARAGRAPH thing
        We'll be able to type as much as we like.
        Even 4 lines if we want, or 5, or 6.
    HERE 
```

但是，它总是会产生以下语法错误

```
ex9.rb:12: syntax error, unexpected tIDENTIFIER, expecting $end
We'll be able to type as much as we like.
     ^ 
```

任何帮助，将不胜感激！我正在使用 TextWrangler，*TextWrangler*将其解析为块引用，但 Ruby 不是。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T17:16:34.773

它适用于 ruby​​-1.9.3-p194：

```
[1] pry(main)> puts <<-'HERE'
[1] pry(main)*         There's something going on here.
[1] pry(main)*         With the PARAGRAPH thing
[1] pry(main)*         We'll be able to type as much as we like.
[1] pry(main)*         Even 4 lines if we want, or 5, or 6.
[1] pry(main)*     HERE
        There's something going on here.
        With the PARAGRAPH thing
        We'll be able to type as much as we like.
        Even 4 lines if we want, or 5, or 6.
=> nil 
```

我会怀疑隐藏字符或编码问题。`--encoding`检查您的语言环境，或在启动解释器时尝试使用标志。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T17:30:52.937

尽管在您发布的代码片段中看起来不像，但您可能确实在`-`in的两侧或一侧有一个空格`<<-'HERE'`。

如果这样做，您可能会看到如下警告：

```
test.rb:1: warning: `<<' after local variable is interpreted as binary operator
test.rb:1: warning: even though it seems like here document
test.rb:4: syntax error, unexpected tIDENTIFIER, expecting $end
        We'll be able to type as much as we like.
             ^ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T14:25:00.960

我遇到了这个问题，结果发现上面示例中的底部文件标记“HERE”没有靠在左边距（无论如何在笔记本中）。

它前面的任何空格，或制表符，它拒绝点空白工作。

# javascript - 将字符串转换为整数并计算

> ID：10962891
> 
> 赞同：0
> 
> 时间：2012-06-09T17:06:01.237
> 
> 标签：javascript, html

我正在制作一个计算器，其工作方式如下：
用户将他的计算放在一个文本框中，例如：2+4+5；然后将整个字符串转换为整数并计算数字并显示结果：11;。我的代码如下：

脚本：

```
function solve() {  
    problem = parseInt(document.getElementById('prob'));   
    ans = document.getElementById('ansspace');  
    ans.innerHTML = problem  
} 
```

HTML：

```
<input type="text" id="prob">  
<br>  <input type="button" id="add" value="Add" onclick="solve()">  <br>  
<p id='ansspace'></p> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T17:12:18.547

可以`eval()`用来做计算，但要注意安全问题。`eval`不推荐，因为用户可以从页面执行他的代码。否则，使用正则表达式解析内容或使用正则表达式验证输入值是否可以安全地与 eval 一起使用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T17:17:15.030

使用 jQuery 很简单：

```
$('#add').on('click', function() {
    var solution = eval($('#prob').val());
    $('#ansspace').html(solution);
});​​​​​ 
```

[在此处](http://jsfiddle.net/7V6j8/1/)查看实时示例

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T17:12:33.377

制作计算器确实没有简单的方法，但为了让您的代码正常工作，您可以使用`eval`：

```
function solve() {  
  var problem = document.getElementById('prob').value;   
  var ans = document.getElementById('ansspace');   
  ans.innerHTML = eval(problem);  
} 
```

# sql - OUTER JOIN 中的条件给出与 WHERE 条件不同的结果

> ID：10962892
> 
> 赞同：1
> 
> 时间：2012-06-09T17:06:05.120
> 
> 标签：sql, postgresql

在尝试`outer join`查询时，我注意到将一个条件从子句更改`where`为`join`子句会更改结果。这让我感到惊讶，但我将表格和查询简化如下，现在我想我明白了，但我想听听一个可靠的解释。

```
create table t0 (id int, b int);
create table t1 (id int, b int);
insert into t0 (id, b) values (1, 10), (2, 10);
insert into t1 (id, b) values (1, 2);

select t0.id, t0.b
from t0
left outer join t1 on 
    t0.id = t1.id
where
    t0.b = 10
    and
    t1.b = 2
;
 id | b  
----+----
  1 | 10
(1 row) 
```

现在我将条件之一从子句`where`移到`join`子句：

```
select t0.id, t0.b
from t0
left outer join t1 on 
    t0.id = t1.id
    and
    t1.b = 2
where 
    t0.b = 10
;
 id | b  
----+----
  1 | 10
  2 | 10
(2 rows) 
```

你知道如何写一个直截了当的推理吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T17:12:28.950

only的`on`条件决定了是否成功。如果连接失败，则连接的列将填充.`outer join``join``null`

另一方面，`where`子句从结果集中过滤出整行。

为了使这一点更清楚，`t1.b`添加到结果集中。作为`t1.b = 2`一个`where`条件，你得到：

```
t0.id   t0.b   t1.id   t1.b
1       10     1       2 
```

与`t1.b = 2`作为`on`条件::

```
t0.id   t0.b   t1.id   t1.b
1       10     1       2
2       10     NULL    NULL 
```

您可以看到为什么该`where`子句将第二行过滤掉：`null = 2`不正确。

# android - 如何用渐变填充 ShapeDrawable（包含 PathShape）

> ID：10962894
> 
> 赞同：1
> 
> 时间：2012-06-09T17:06:25.940
> 
> 标签：android, drawable

我在使用可绘制的方法填充`ShapeDrawable`包含自定义的内容时遇到问题。以下代码在绘制 a 时完美运行：`PathShape``setShaderFactory()``RectShape`

```
ShapeDrawable shape = new ShapeDrawable();
shape.setShape(new RectShape());
shape.setShaderFactory(new ShaderFactory() {
    @Override
    public Shader resize(int width, int height) {
        LinearGradient gradient = new LinearGradient (0, 0,
                width, height, Color.Red, Color.Blue,
                TileMode.REPEAT);
        return gradient;
    }
}); 
```

但是，当我将其更改`RectShape`为任何 custom`PathShape`时，drawable 仅使用渐变起始颜色（红色）填充整个形状。换句话说，自定义形状绘制正确，但颜色完全错误。有没有人见过这个并且知道可能是什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T15:23:27.730

实验后发现渐变的大小一定是跟标准的宽度和标准的高度有关`PathShape`，在创建的时候和高度和宽度没有关系`ShapeDrawable`。这意味着您必须跟踪您`PathShape`在其整个生命周期中分配给您的标准宽度/高度`ShapeDrawable`，以防它被调整大小。

虽然有点不雅，但这里有一个解决方案：

```
public static final int STD_WIDTH = 20;
public static final int STD_HEIGHT = 20;

PathShape shape = new PathShape(myPath, STD_WIDTH,
        STD_HEIGHT);
ShapeDrawable drawable = new ShapeDrawable();
drawable.setShape(myPathShape);
drawable.setShaderFactory(new ShaderFactory() {
    @Override
    public Shader resize(int width, int height) {
        LinearGradient gradient = new LinearGradient (0, 0,
                STD_WIDTH, STD_HEIGHT, Color.Red, Color.Blue,
                TileMode.REPEAT);
        return gradient;
    }
}); 
```

# mysql - 假设无限的磁盘空间（但实际上计算能力很高），MySQL表的大小是否有限制以提高效率

> ID：10962902
> 
> 赞同：-4
> 
> 时间：2012-06-09T17:07:32.337
> 
> 标签：mysql, database, optimization

假设`SELECT`MySQL 中的查询最坏`O(log(n))`（只是任意）时间来搜索表中的键以查找大小为 1,000 个键的小表。

10 年后，表内的键数呈指数增长。假设 10 年来没有任何升级，MySQL 可以扩展这些数据的能力如何。

搜索速度会显着下降吗？MySQL 能在多大程度上处理这种数据增长？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T17:12:28.197

你对你的用例不是很具体。如果使用得当，MySQL 可以处理数十亿行。如果使用不当，几乎任何表都会给您带来麻烦，尽管在您的数据库不再适合内存之前您不太可能遇到太多麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T17:13:21.720

就查询和表的优化而言，行数没有最差限制。如果不是，这取决于 CPU 功率和内存容量。

# ruby-on-rails - 关联关联的计数器缓存

> ID：10962903
> 
> 赞同：3
> 
> 时间：2012-06-09T17:07:37.717
> 
> 标签：ruby-on-rails, activerecord, one-to-many, counter-cache

我有一个论坛模型，其中有很多讨论。每个讨论都有很多帖子。讨论或多或少只是帖子对象的集合。

现在，我想在论坛中为该论坛讨论中包含的帖子提供一个 counter_cache。

所以真的，似乎我应该使用一个`:through`关联而不是两个单独的关联来完成这个。

但是，我找不到任何建议混合使用 has_many :through 和 has_one :through 关联的参考，仅适用于一对一和多对多，而不适用于一对多。

```
class Forum < ActiveRecord::Base
  has_many :discussions
  has_many :posts, :through => :discussions
end

class Post < ActiveRecord::Base
  belongs_to :discussion
  has_one :forum, :through => discussion
end

class Discussion < ActiveRecord::Base
  has_many :posts
  belongs_to :forum
end 
```

像上面那样可取，还是我应该手动处理计数器缓存？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T17:33:36.387

像这样的东西应该工作。

```
class Forum < ActiveRecord::Base
  has_many :discussions
  has_many :posts, :through => :discussions
end

class Post < ActiveRecord::Base
  belongs_to :discussion, counter_cache: true
  has_one :forum, :through => discussion

  after_create :increment_forum_counter_cache

  private

  def increment_forum_counter_cache
     Forum.increment_counter( 'discussions_count', self.discussion.forum.id )
  end
end

class Discussion < ActiveRecord::Base
  has_many :posts
  belongs_to :forum

end 
```

我似乎记得以前通过 has_one 关系设置 counter_cache 时遇到了麻烦。上面的方法应该有效。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-10T15:39:16.553

所以普通的计数器缓存似乎工作得很好，混合关系类型也是如此

```
class Post < ActiveRecord::Base
  belongs_to :user
  belongs_to :discussion
  has_one :forum, :through => :discussion,
            :counter_cache => :posts_counter
end
class Forum < ActiveRecord::Base
  has_many :discussions
  has_many :posts, :through => :discussions
end

class Discussion < ActiveRecord::Base
  has_many :posts
  belongs_to :forum
  belongs_to :user
end 
```

# android - 如何让选项卡创建功能 UI - 对非静态方法的静态引用

> ID：10962910
> 
> 赞同：1
> 
> 时间：2012-06-09T17:08:48.413
> 
> 标签：android, tabs, navigation, android-actionbar

我正在使用 android ( [FragmentTabs.java](http://developer.android.com/resources/samples/ApiDemos/src/com/example/android/apis/app/FragmentTabs.html) ) 上的教程设计一个操作栏选项卡界面，当我尝试跟踪我切换到在选项卡中显示的片段时遇到问题。（我通过按钮切换选项卡并使用布局文件中的 onClick 在主活动中查找方法）

在 TabListener 中的这部分代码中，片段被更新：

```
 mFragment = mActivity.getFragmentManager().findFragmentByTag(mTag); 
```

其参数传递给：

```
bar.addTab(bar.newTab()
            .setText("MMC/Data Commands")
            .setTabListener(new TabListener<MMCFragment>(
                    this, "MMCFragment", MMCFragment.class))); 
```

所以，当用户按下选项卡内创建的视图上的按钮时，我会尝试更新“mFragment”。如果我在用户切换选项卡时不更新它：

```
public void onTabUnselected(Tab tab, FragmentTransaction ft) {
        if (mFragment != null) {
            ft.detach(mFragment);
        }
    } 
```

它分离 mFragment，这是在创建选项卡时传递给它的原始片段，即带有标签“MMCFragment”的片段，当视图切换到不同的片段时，这是一个问题。所以我在 TabListener 中做了一个方法：

```
public void updateMfrag(String tag){
        mFragment = mActivity.getFragmentManager().findFragmentByTag(tag);
    } 
```

但是当我从方法外部调用它时出现错误，因为我对非静态方法进行了静态引用。我怎样才能解决这个问题？还是有更好的方法在选项卡中导航视图？

# java - 波前 .obj .Mtl 结构

> ID：10962911
> 
> 赞同：1
> 
> 时间：2012-06-09T17:08:50.613
> 
> 标签：java, textures, .obj, wavefront

我正在尝试使用 lwjgl 在 Java 中加载 .obj 文件，而无需使用任何库来执行此操作。我创建了一个类来加载没有材质和纹理的模型。这很容易。但现在我想用材质和纹理来加载模型。我的问题是关于 .mtl 文件的知识。我在任何地方都没有找到 .mtl 文件的任何解释。但我需要知道这些 Ka、Kd、Ks、Tr、Ns 和 map_... 是什么意思。也许有人知道网络上某个地方的一个很好的解释？

我的第二个问题是关于 .obj 文件中纹理的纹理坐标。我不明白如何在具有 2D 纹理坐标的 3D 模型上绘制 2D 纹理，因为您需要 3D 房间中的第三个值，因为 3D 房间中的 2D 平面也需要每个顶点 3 个值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T17:17:17.793

我认为这是一个合理的解释：

[MTL 文件规范](http://local.wasp.uwa.edu.au/~pbourke/dataformats/mtl/)

# python - Flask-SQLAlchemy - 系列中第一集未观看的剧集，按上次观看排序

> ID：10962912
> 
> 赞同：3
> 
> 时间：2012-06-09T17:08:57.870
> 
> 标签：python, flask, sqlalchemy, subquery, flask-sqlalchemy

在这里，我再次需要你的帮助。

我想从用户最喜欢的系列中检索每个系列的一集，该系列首先未观看（所以下一个要观看）和按最后观看排序的系列。

```
from flask import Flask
from flask.ext.sqlalchemy import SQLAlchemy
import logging
from datetime import datetime
from sqlalchemy.ext.associationproxy import association_proxy

app = Flask(__name__)
db = SQLAlchemy(app)

logging.basicConfig()

watched_episodes = db.Table('watched_episodes',
    db.Column('user_id', db.Integer, db.ForeignKey('user.id')),
    db.Column('episode_id', db.Integer, db.ForeignKey('episode.id'))
)

class User(db.Model):
    __tablename__ = 'user'
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String)
    favorite_series = association_proxy('user_series', 'serie')
    watched_episodes = db.relationship('Episode', secondary=watched_episodes,
        backref=db.backref('users', lazy='dynamic'))

    def __repr__(self):
        return '<User {0}>'.format(self.name)

    def __init__(self, name):
        self.name = name

class UserSerie(db.Model):
    __tablename__ = 'user_series'
    user_id = db.Column(db.Integer, db.ForeignKey('user.id'), \
        primary_key=True)
    serie_id = db.Column(db.Integer, db.ForeignKey('serie.id'), \
        primary_key=True)
    last_watched = db.Column(db.DateTime)
    user = db.relationship("User", \
        backref=db.backref("user_series", cascade="all, delete-orphan"))
    serie = db.relationship("Serie")

    def __init__(self, serie=None, user=None, last_watched=None):
        self.user = user
        self.serie = serie
        self.last_watched = datetime.now()

class Serie(db.Model):
    __tablename__ = 'serie'
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String)

    def __init__(self, name):
        self.name = name

    def __repr__(self):
        return '<Serie {0}>'.format(self.name)

class Episode(db.Model):
    __tablename__ = 'episode'
    id = db.Column(db.Integer, primary_key=True)
    air_time = db.Column(db.DateTime)
    seas_num = db.Column(db.Integer)
    epis_num = db.Column(db.Integer)
    serie_id = db.Column(db.Integer, db.ForeignKey('serie.id'))
    serie = db.relationship('Serie',
        backref=db.backref('episodes', lazy='dynamic'))

    def __init__(self, air_time, seas_num, epis_num):
        self.air_time = air_time
        self.seas_num = seas_num
        self.epis_num = epis_num

    def __repr__(self):
        return '<Episode S{0}E{0}>'.format(self.seas_num, self.epis_num)

u1 = User('user1')

s1 = Serie('Serie1')
s2 = Serie('Serie2')

e1 = Episode(datetime(2008, 05, 30), 1, 1)
e1.serie = s1
e2 = Episode(datetime(2008, 06, 05), 1, 1)
e2.serie = s1
e3 = Episode(datetime(2008, 06, 10), 1, 1)
e3.serie = s1

e4 = Episode(datetime(2012, 01, 01), 1, 1)
e4.serie = s2
e5 = Episode(datetime(2012, 02, 12), 1, 1)
e5.serie = s2
e6 = Episode(datetime(2012, 03, 23), 1, 1)
e6.serie = s2

u1.favorite_series.extend([s1, s2])

db.session.add(u1)
db.session.add(s1)
db.session.add(s2)
db.session.add(e1)
db.session.add(e2)
db.session.add(e3)
db.session.add(e4)
db.session.add(e5)
db.session.add(e6)
db.create_all()
db.session.commit()

logging.getLogger('sqlalchemy.engine').setLevel(logging.INFO)

sub = db.session.query(UserSerie.serie_id, UserSerie.last_watched).\
    group_by(UserSerie.serie_id).subquery()

sub2 = db.session.query(Episode).\
    filter(Episode.serie_id.in_(x.id for x in u1.favorite_series)).\
    order_by(Episode.air_time).\
    group_by(Episode.serie_id).subquery()

shows = db.session.query(Serie, sub2).\
    outerjoin(sub, Serie.id == sub.c.serie_id).\
    outerjoin(sub2).\
    filter(Serie.id.in_(\
        x.id for x in u1.favorite_series)).\
    order_by(sub.c.last_watched)

for s in shows:
    print s 
```

虽然这会返回：

```
(<Serie Serie1>, 3, datetime.datetime(2008, 6, 10, 0, 0), 1, 1, 1)
(<Serie Serie2>, 6, datetime.datetime(2012, 3, 23, 0, 0), 1, 1, 2) 
```

但我希望有剧集作为对象，如：

```
(<Serie Serie1>, <Episode S01E01>)
(<Serie Serie2>, <Episode S01E01>) 
```

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T19:43:23.390

好的。似乎没有人能够帮助我。我再次得到朋友人工的帮助。

问题已通过以下代码解决：

```
episodes = Episode.query.subquery()
userseries = UserSerie.query.subquery()
# Get the min air time for each of the favorite series.
min_air_times = db.session.query(
        Serie.id.label('serie_id'),
        db.func.min(episodes.c.id).label('id')
    ).filter(
        Serie.id.in_(x.id for x in u1.favorite_series)
    ).outerjoin(
        userseries,
        Serie.id == userseries.c.serie_id
    ).outerjoin(
        episodes,
        Serie.id == episodes.c.serie_id
    ).filter(
        ~episodes.c.id.in_(x.id for x in u1.watched_episodes)
    ).filter(
        episodes.c.seas_num != 0
    ).order_by(
        desc(userseries.c.last_watched)
    ).group_by(
        Serie.id
    ).subquery()
# Select the serie and episode.
shows = db.session.query(
        Serie,
        Episode
    ).join(
        Episode,
        Episode.serie_id == Serie.id
    ).join(
        min_air_times,
        db.and_(
            min_air_times.c.serie_id == Serie.id,
            min_air_times.c.id == Episode.id
        )
    ).all() 
```

# python - 本地开发服务器的谷歌应用引擎没有终端输出？

> ID：10962922
> 
> 赞同：2
> 
> 时间：2012-06-09T17:11:04.793
> 
> 标签：python, google-app-engine

我一直在使用谷歌应用程序引擎使用 python 2.7、ubuntu 12.04 和 webapp2 框架进行网络应用程序开发。

由于某些奇怪的原因，当我在本地开发服务器上运行应用程序时，我无法再像以前那样在终端上查看我的 http 响应或查看错误。我不知道它是怎么变成这样的。

此外，当使用我的终端运行新的使用 dev_server.py 命令时，如下所示，

```
ahmad@ubuntu:~/GAE$ python google_appengine/dev_appserver.py wiki 
```

我收到正在使用套接字的错误。我记得当我运行一个应用程序时，我必须单击 ctrl+c 来杀死它并重新运行另一个应用程序。现在它似乎在后台运行，如果我尝试运行另一个应用程序，我会得到一个套接字正在运行的声明用过的...

这是在本地开发服务器上运行差异应用程序的确切错误，

```
ahmad@ubuntu:~/GAE$ python google_appengine/dev_appserver.py wiki
WARNING  2012-06-09 17:04:25,981 rdbms_mysqldb.py:74] The rdbms API is not available because the MySQLdb library could not be loaded.
INFO     2012-06-09 17:04:26,022 appengine_rpc.py:160] Server: appengine.google.com
INFO     2012-06-09 17:04:26,024 appcfg.py:582] Checking for updates to the SDK.
INFO     2012-06-09 17:04:26,221 appcfg.py:600] The SDK is up to date.
WARNING  2012-06-09 17:04:26,221 datastore_file_stub.py:518] Could not read datastore data from /tmp/dev_appserver.datastore
Traceback (most recent call last):
  File "google_appengine/dev_appserver.py", line 125, in <module>
    run_file(__file__, globals())
  File "google_appengine/dev_appserver.py", line 121, in run_file
    execfile(script_path, globals_)
  File "/home/ahmad/GAE/google_appengine/google/appengine/tools/dev_appserver_main.py", line 690, in <module>
    sys.exit(main(sys.argv))
  File "/home/ahmad/GAE/google_appengine/google/appengine/tools/dev_appserver_main.py", line 653, in main
    persist_logs=persist_logs)
  File "/home/ahmad/GAE/google_appengine/google/appengine/tools/dev_appserver.py", line 3595, in CreateServer
    server = HTTPServerWithScheduler((serve_address, port), handler_class)
  File "/home/ahmad/GAE/google_appengine/google/appengine/tools/dev_appserver.py", line 3623, in __init__
    request_handler_class)
  File "/usr/lib/python2.7/SocketServer.py", line 408, in __init__
    self.server_bind()
  File "/usr/lib/python2.7/BaseHTTPServer.py", line 108, in server_bind
    SocketServer.TCPServer.server_bind(self)
  File "/usr/lib/python2.7/SocketServer.py", line 419, in server_bind
    self.socket.bind(self.server_address)
  File "/usr/lib/python2.7/socket.py", line 224, in meth
    return getattr(self._sock,name)(*args)
socket.error: [Errno 98] Address already in use
INFO     2012-06-09 17:04:26,322 datastore_stub_util.py:2410] Applying all pending transactions and saving the datastore 
```

感谢您提前提供任何帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T17:18:33.687

“地址已在使用中”看起来该端口已被其他进程使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T20:18:53.443

尝试找到挂在您的端口上的进程。如果您使用类似的东西，`ps aux`您可能会立即识别出僵尸应用服务器实例。如果没有，可以使用[示例](http://www.cyberciti.biz/faq/what-process-has-open-linux-port/)来确定哪个进程正在使用端口。你可能不得不这样`kill -9`做。

如果它应该正在使用中，请使用`-p PORT`参数在不同的端口上启动 dev_appserver。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T17:27:42.807

如果您尝试同时运行两个应用程序（通过使用 dev_appserver 的两个实例），您将需要告诉其中一个使用不同的端口。[在运行开发 Web 服务器](https://developers.google.com/appengine/docs/python/tools/devserver)中通过示例对其进行了描述。

在 Ubuntu 上 Ctrl-C'ing dev_appserver 不应导致它在后台运行。（可能是 Ctrl-Z）。

# java - 未找到命名对象

> ID：10962925
> 
> 赞同：4
> 
> 时间：2012-06-09T17:11:45.870
> 
> 标签：java, jsf, jsf-2, cdi

我创建了一个新的验证器：

```
package com.example.jsf.validator;

import com.example.components.LoginFormValue;
import com.example.ejb.SecurityEjb;
import java.io.Serializable;
import javax.ejb.EJB;
import javax.enterprise.context.ApplicationScoped;
import javax.faces.application.FacesMessage;
import javax.faces.component.UIComponent;
import javax.faces.context.FacesContext;
import javax.faces.validator.Validator;
import javax.faces.validator.ValidatorException;
import javax.inject.Named;

/**
 * Validator for {@code login-form} component.
 *
 * @author steve
 */
@Named
@ApplicationScoped
public class LoginValidator implements Validator, Serializable
{
    @Override
    public void validate(FacesContext context, UIComponent component, Object value) throws ValidatorException
    {
        if (value == null)
        {
            return;
        }

        LoginFormValue loginFormValue = (LoginFormValue) value;
        if (securityEjb.checkCredentials(loginFormValue.getEmailAddress(), loginFormValue.getPassword())) {
            return;
        }

        throw new ValidatorException(new FacesMessage("Incorrect email address/password"));
    }

    @EJB
    private SecurityEjb securityEjb;
} 
```

但是当我尝试使用它时：

```
<my:login-form emailAddress="#{loginBean.emailAddress}"
               rememberMe="#{loginBean.rememberMe}"
               actionListener="#{loginBean.submit()}"
               recoverPasswordOutcome="recover-password"
               registerOutcome="signup">
    <f:validator validatorId="#{loginValidator}"/>
</my:login-form> 
```

加载页面时显示此异常：

```
javax.faces.FacesException: Expression Error: Named Object: com.example.jsf.validator.LoginValidator@31888ef8 not found. 
```

有问题的代码行是：

```
com.sun.faces.application.ApplicationImpl.createValidator(ApplicationImpl.java:1593) 
```

为什么 JSF 可以实际解析验证器 bean 类却不能实例化它？我的应用程序中的每个其他验证器都是一个`Named` `ApplicationScoped`bean，它们都工作得很好。我引用它们都使用`<f:validator validatorId="{myValidatorBean}"/>`.

我正在使用 GlassFish 3.1.2。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-09T21:03:40.750

必须引用验证器的`<f:validator validatorId>`ID，而不是具体的验证器实例。验证器的 ID 正是您指定为`@FacesValidator`值或`<validator-id>`使用该`faces-config.xml`方法时指定的那个。例如

```
@FacesValidator("myValidator") 
```

然后将其引用为

```
<f:validator validatorId="myValidator" /> 
```

`validatorId`在视图构建期间，任何 EL 表达式都将被解析为`String`标识验证器 ID。因此，当传递一个具体`Validator`实例时，它只会以它的`toString()`值结束，就像`com.example.MyValidator@hashcode`作为验证器 ID 传递一样，这显然不存在，因为异常消息试图告诉你：

> javax.faces.FacesException：表达式错误：命名对象：com.example.jsf.validator.LoginValidator@31888ef8 未找到。

您应该使用`<f:validator binding>`or`<h:inputText validator>`代替。它可以举一个具体的例子。

```
<f:validator binding="#{myValidator}" /> 
```

传递给复合组件时它不起作用是另一个问题。您根本没有指定`for`属性，因此它不会应用于`UIInput`组合内的任何组件。我认为以下问题/答案将完全适用以解决该问题：[如何为复合组件内的输入组件指定验证器？](https://stackoverflow.com/questions/8780703/how-to-specify-a-validator-for-an-input-component-inside-a-composite-component)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-22T21:53:25.847

我今天遇到了同样的问题，并通过添加“实现验证器”来解决它。那是我的错误。

```
<ui:composition>
    <h:inputText id="#{id}" value="#{value}" size="20">
        <f:validator validatorId="com.example.shop.validator.PhoneNumber"/>
    </h:inputText>
</ui:composition>

@FacesValidator("com.example.shop.validator.PhoneNumber")
public class PhoneNumber implements Validator {

@Override
public void validate(FacesContext facesContext, UIComponent uiComponent,     Object o) throws ValidatorException {

} 
```

# jquery - 重建选择菜单

> ID：10962927
> 
> 赞同：0
> 
> 时间：2012-06-09T17:12:02.947
> 
> 标签：jquery, jquery-mobile

如何使用 jQuery Mobile 重建选择菜单？

这是我的代码...

```
<script>
$(document).delegate('#registration-city', 'pageinit', function () {
    // $("#city").selectmenu('refresh', true); //Rebuild is don't work
    $("#zip").change(function () {
        // $("#city").selectmenu('refresh', true); //Rebuild is don't work
        ...
        $('#city').append(response.list).selectmenu('refresh'); // Works
        ...
        });
    $("#zip").keyup(function () {
    ...
        $("#city").selectmenu('refresh', true); // Rebuild is don't work
    ...
    });
});
</script> 
```

谢谢你的帮助。

干杯，

文森特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T17:31:59.013

您可以在 JQM 中动态插入的元素上触发`create`事件

```
 $("#elementid").trigger("create"); 
```

# jquery - iframe：防止父和 iframe jquery 库发生冲突

> ID：10962930
> 
> 赞同：0
> 
> 时间：2012-06-09T17:12:11.177
> 
> 标签：jquery, jquery-ui, iframe, conflict

好的，这是一个简单的问题：

我正在构建一个登陆页面编辑器，并将用户创建的模板加载到编辑器页面上的 iframe 中。父级加载了 jquery 和 ui，因为这些工具包括拖放。我将框等拖放到 iframe 中，然后抓取 iframe 并使生成的拖放元素可在 iframe 中拖动。

所以要明确的是，我的一切工作都很完美，你可以拖动和调整大小以及从父窗口到 iframe 的所有内容。但是，如果加载到编辑器中的模板中已经包含 jquery，则会发生冲突。

我需要加载到编辑器中的模板能够在需要时使用 jquery，因为某些模板可能有 jquery 滑块等...

我的第一个问题是......如果父“编辑器”页面上已经有 jquery，并且我正在抓取 iframe 并操作内容，jquery 是否已经加载到 iframe 中？换句话说，如果有人在他们的模板中有一个 jquery 滑块，我是否可以确保 iframe 不加载 jquery，然后滑块仍然可以工作，因为父级已经有了它？如果是这种情况并且我不需要它们两次，那么是否有一种简单的方法可以爬取 iframe 的内容并取出正在加载 jquery 的脚本标记？？？？

我的第二个问题是......是否有“无冲突”规则或我可以在 jquery 上调用的东西，所以如果有两个它不会冲突？

我的第三个问题是我搞砸了:(？

请帮我！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-09T17:22:32.170

The conflict can`t happen instead iframes can be use to remove conflicts , so if you have an iframe with jquery and the parent of iframe also have a jquery than this will never conflict, may be there are some other issues in your code .

And for loading scripts dynamically you can use `$.getScript("name.js")`.

# java - 本地主机上的 NotBoundException

> ID：10962933
> 
> 赞同：1
> 
> 时间：2012-06-09T17:12:20.543
> 
> 标签：java, rmi

我有一个在本地主机上运行的 RMI 服务器，导出一个类型的对象`Message`：

```
try {
    MessageServer obj = new MessageServer();
    Message stub = (Message) UnicastRemoteObject.exportObject(obj, 0);
    Registry registry = LocateRegistry.getRegistry();
    registry.bind("M", stub);
} catch (RemoteException e) {
} catch (AlreadyBoundException e) {
} 
```

然后我想启动一个客户端并获取这个对象的存根。似乎找到了注册表，但随后在`try`块`NotBoundException`中抛出了 a：

> java.rmi.NotBoundException：M at sun.rmi.registry.RegistryImpl.lookup(RegistryImpl.java:136) at sun.rmi.registry.RegistryImpl_Skel.dispatch(Unknown Source) at sun.rmi.server.UnicastServerRef.oldDispatch(UnicastServerRef .java:409) 在 sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:267) 在 sun.rmi.transport.Transport$1.run(Transport.java:177) 在 java.security.AccessController.doPrivileged(Native方法）在 sun.rmi.transport.Transport.serviceCall(Transport.java:173) 在 sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:553) 在 sun.rmi.transport.tcp.TCPTransport$ConnectionHandler .run0(TCPTransport.java:808) 在 sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:667) 在 java.util.concurrent.ThreadPoolExecutor。runWorker(ThreadPoolExecutor.java:1110) 在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603) 在 java.lang.Thread.run(Thread.java:679) 在 sun.rmi.transport.StreamRemoteCall .exceptionReceivedFromServer(StreamRemoteCall.java:273) 在 sun.rmi.transport.StreamRemoteCall.executeCall(StreamRemoteCall.java:251) 在 sun.rmi.server.UnicastRef.invoke(UnicastRef.java:377) 在 sun.rmi.registry。 RegistryImpl_Stub.lookup(Unknown Source) at rmtest.MessageClient.main(MessageClient.java:23)在 sun.rmi.registry.RegistryImpl_Stub.lookup(Unknown Source) 在 rmtest.MessageClient.main(MessageClient.java: 23)在 sun.rmi.registry.RegistryImpl_Stub.lookup(Unknown Source) 在 rmtest.MessageClient.main(MessageClient.java: 23)

```
public static void main(String args[]) {
        //String host = "localhost";
        Registry registry;
        Message stub = null;
        try {
            registry = LocateRegistry.getRegistry();
            stub = (Message) registry.lookup("M"); //NotBoundException thrown here
        } catch (NotBoundException ex) {
        } catch (AccessException ex) {
        } catch (RemoteException ex) {
        }
        try {
            stub.insert("TestString"); //NullPointerException here
        } catch (RemoteException ex) {
        }

} 
```

为什么`"M"`找不到？服务器和客户端都在 Netbeans 中启动，注册表是通过终端预先启动的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T11:56:41.977

RMI 有点像野兽，如何运行它始终是一个问题。

首先，按照@EJP 的建议进行适当的异常处理：原因可能是您遇到连接超时或类似情况 - 所以将 an`e.printStackTrace()`放入`catch`块中，让我们看看我们是否收到某种错误消息（顺便说一句，您将停止创建空`catch`当您调试一个抑制的异常 2 天时会非常快地阻塞）。不能是您的防火墙捕获了连接吗？

我也会更改`getRegistry()`为`createRegistry()`, 和（它可以`bind()`为`rebind()`您节省一点时间）。

您遇到的异常是因为您的主应用程序无法绑定（注册）您想要的服务，并且默认注册表中缺少（不可用）。

RMI 可以通过多种方式完成。您选择的方法对于开发和测试来说绝对很酷，但是如果您想将其投入生产，您需要进行一些更改（例如，可能会有一个共同`rmiregistry`运行的地方，您必须使用策略文件和一些属性，例如`java.rmi.codebase=...`，您需要安装适当的安全管理器等）

# iphone - iPhone应用程序中的启动画面使用Storyboard延迟

> ID：10962942
> 
> 赞同：1
> 
> 时间：2012-06-09T17:12:49.677
> 
> 标签：iphone, objective-c, ios, ios5

所以我知道 Default.png 可以用于 iPhone 应用程序中的启动画面，但我发现它看起来不专业，因为一旦应用程序完成加载就没有动画。

所以我正在尝试添加一个会淡出的启动画面，然后转到上一个视图。

互联网上的大多数示例往往基于使用 addSubview 的旧方式。我将如何将其添加到我的故事板应用程序中。

当前代码（时间错误，因为我不确定它最初是否有效）

```
 - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    splashView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"Default2.png"]];
    splashView.frame = CGRectMake(0, 0, 324, 480);
    [_window addSubview:splashView];
    [_window bringSubviewToFront:splashView];
    [_window makeKeyAndVisible];

    [self performSelector:@selector(removeSplash) withObject:nil afterDelay:1500.2];
    return YES;
}

-(void)removeSplash;
{
    [UIView animateWithDuration:1.0 animations:^{self.splashView.alpha = 0.0;} completion:^(BOOL finished){ [splashView removeFromSuperview]; }];
    [splashScreen release];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T03:11:42.663

除了[Guntis Treulands](https://stackoverflow.com/users/894671/guntis-treulands)的回答之外，我还有另一种方法可以做到这一点，而无需将动画代码移出`- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions`方法。

只需将您的 splashView 直接添加到`_window.rootViewController.view`.

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    UIImage *splashImage = [UIImage autoAdjustImageNamed:@"Default.png"];
    UIImageView *splashImageView = [[UIImageView alloc] initWithImage:splashImage];
    [self.window.rootViewController.view addSubview:splashImageView];
    [self.window.rootViewController.view bringSubviewToFront:splashImageView];
    [UIView animateWithDuration:1.5f
                          delay:2.0f
                        options:UIViewAnimationOptionCurveEaseInOut
                     animations:^{
                         splashImageView.alpha = .0f;
                         CGFloat x = -60.0f;
                         CGFloat y = -120.0f;
                         splashImageView.frame = CGRectMake(x,
                                                            y,
                                                            splashImageView.frame.size.width-2*x,
                                                            splashImageView.frame.size.height-2*y);
                     } completion:^(BOOL finished){
                         if (finished) {
                             [splashImageView removeFromSuperview];
                         }
                     }];

    return YES;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T07:34:40.887

在您的情况下，我仍会将其添加为子视图，但始终将其保留为窗口的顶部子视图。当它`alpha == 0`停止接收触摸时。所以..每次你想淡出它时都没有理由释放它。

就我而言 - 每次应用程序最大化或打开时，客户都希望看到启动画面，所以我也这样做了：

```
- (void)applicationDidEnterBackground:(UIApplication *)application 
{
    extraSplashScreen.alpha = 1;  //when it goes in background - set splash screen visible.
}

- (void)applicationDidBecomeActive:(UIApplication *)application 
{ 
    [self fadeOutSplash]; //initiate fade out.
} 
```

我的`fadeOutSplash`函数看起来像这样（以防万一）：

```
- (void)fadeOutSplash
{
    [UIView beginAnimations:nil context:NULL];  

    [UIView setAnimationDelegate:self];

    [UIView setAnimationCurve:UIViewAnimationCurveEaseIn];   

    [UIView setAnimationDuration:0.3];

    [UIView setAnimationDelay:0.5];

    extraSplashScreen.alpha = 0;

    [UIView commitAnimations];
} 
```

希望有帮助。

# mysql - 使用 Zend_Db_Select 在一个连接中包含多个表

> ID：10962943
> 
> 赞同：1
> 
> 时间：2012-06-09T17:12:57.860
> 
> 标签：mysql, left-join, zend-db-select

我知道 Zend_Db_Select 的使用是可选的，但我想知道是否有办法使用它来生成以下 SQL：

```
 LEFT JOIN (pages p
             , core_url_rewrite url)
            ON p.page_id = mi.page_id
           AND url.page_id = p.page_id 
```

..或者如果不支持。据我所知，您一次只能加入一张桌子。如果您将表包含为 Zend_Db_Expr：

```
->joinLeft(new Zend_Db_Expr('(pages p, core_url_rewrite url)'), 
    'ON p.page_id = mi.page_id
    AND url.page_id = p.page_id') 
```

然后我会得到类似下面的东西，这是无效的

```
 LEFT JOIN (pages p
             , core_url_rewrite url) AS t
            ON p.page_id = mi.page_id
           AND url.page_id = p.page_id 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T21:21:59.727

不支持多个表 JOIN。 `Zend_Db_Select`被编程为仅支持一个数组元素作为连接表参数名称，如果它是一个`Zend_Db_Expr`或`Zend_Db_Select`实例，它将为其分配别名“t”，假设您正在输入单个表名称/表达式。

您可以将其拆分为两个`joinLeft`，这可能对将来的维护更好，并且与您想要的没有区别。

# c - for循环内外变量初始化的区别

> ID：10962948
> 
> 赞同：1
> 
> 时间：2012-06-09T17:13:45.443
> 
> 标签：c, variables, for-loop

我写了一个程序来打印出所有的数字，其二进制模式在 1 到 1993 之间是对称的（例如：1001001，1010101）。我犯了一个错误，我发现了。但是，有一些细节我还不能理解。

正确的代码：

```
#include <stdio.h>
main() {
    int binary[11] = {0};
    int i, n, j, k;
    for(i = 1; i <= 1993; i++) {
        n = i; k = 0;
        while(n != 0) {
            binary[k++] = n%2 ; 
            n = n/2;
        }   
        for(j = 0; j < k; j++) {
            if(binary[j] != binary[k-j-1])
            break;
        }   
        if(j == k) {
            printf("%d ", i);
            for(j = 0; j < k; j++)
                printf("%d", binary[j]);
            printf("\n");
        }   
    }
} 
```

错误的代码：

```
#include <stdio.h>
main() {
    int binary[11] = {0};
    int i, n, j, k = 0; /* I have found a mistake here, k=0 should inside the for loop */     
    for(i = 1; i <= 1993; i++) {
        n = i;
        while(n != 0) {
            binary[k++] = n%2 ; 
            n = n/2;
        }   
        for(j = 0; j < k; j++) {
            if(binary[j] != binary[k-j-1])
            break;
        }   
        if(j == k) {
            printf("%d ", i);
            for(j = 0; j < k; j++)
                printf("%d", binary[j]);
            printf("\n");
        }   
    }
} 
```

我只是不明白为什么在for循环外“k=0”时变量“i”不能增加到6，循环会一次又一次地重复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T17:23:32.873

你的 while 循环增加了`k`。所以在 while 循环中使用它之前，你必须将它设置为 0。如果你不这样做，你有一个来自先前计算的旧值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T17:38:44.740

在“错误代码”中，k 变量不会在迭代之间重置为 0。然而，它会随着 while 循环的每次迭代而增加。在某些时候，它会打破 binary[11] 数组的上限，然后是 "binary[k++] = n%2 ;" 语句将开始覆盖堆栈上的其他变量，包括变量“i”。在这种情况下，会发生不可预知的事情。

如果您单步执行“错误代码”，我相信您能够验证当 i=6 时会发生这种情况。

# java - Android java.lang.ClassNotFoundException

> ID：10962959
> 
> 赞同：3
> 
> 时间：2012-06-09T17:14:51.923
> 
> 标签：java, android, classnotfoundexception

我知道这在 SO 上被问了很多，但不幸的是，没有一个答案能解决我的问题。

我有 3 台用于测试 + 模拟器的 Android 设备，我的应用程序在所有设备上都可以正常工作，但是当我发布应用程序时出现此错误（仅在少数设备上，不是全部）：

```
java.lang.RuntimeException: Unable to start activity ComponentInfo{<package>/<package>.<ProjectName>Activity}: android.view.InflateException: Binary XML file line #10: Error inflating class <package>.MainSurfaceView
 at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
 at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
 at android.app.ActivityThread.access$2300(ActivityThread.java:125)
 at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
 at android.os.Handler.dispatchMessage(Handler.java:99)
 at android.os.Looper.loop(Looper.java:123)
 at android.app.ActivityThread.main(ActivityThread.java:4627)
 at java.lang.reflect.Method.invokeNative(Native Method)
 at java.lang.reflect.Method.invoke(Method.java:521)
 at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
 at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
 at dalvik.system.NativeStart.main(Native Method)
Caused by: android.view.InflateException: Binary XML file line #10: Error inflating class <package>.MainSurfaceView
 at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:576)
 at android.view.LayoutInflater.rInflate(LayoutInflater.java:618)
 at android.view.LayoutInflater.inflate(LayoutInflater.java:407)
 at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
 at android.view.LayoutInflater.inflate(LayoutInflater.java:276)
 at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:198)
 at android.app.Activity.setContentView(Activity.java:1647)
 at <package>.<ProjectName>Activity.onCreate(Unknown Source)
 at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
 at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
 ... 11 more
Caused by: java.lang.ClassNotFoundException: <package>.MainSurfaceView in loader dalvik.system.PathClassLoader[/data/app/<package>-1.apk]
 at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:243)
 at java.lang.ClassLoader.loadClass(ClassLoader.java:573)
 at java.lang.ClassLoader.loadClass(ClassLoader.java:532)
 at android.view.LayoutInflater.createView(LayoutInflater.java:466)
 at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:565) 
```

该类扩展了 GLSurfaceView 类并具有 3 个构造函数（GLSurfaceView 仅支持 2 个，但我在 SO 上读到缺少的第三个可能会导致问题 - 它不会）。

类（仅限构造函数）：

```
public class MainSurfaceView extends GLSurfaceView {

    public MainSurfaceView(Context context) {
        super(context);
    }

    public MainSurfaceView(Context context, AttributeSet attrs){
        super(context, attrs);
    }

    public MainSurfaceView(Context context, AttributeSet attrs, int defStyle){
        super(context, attrs);
    }
} 
```

添加构造函数

```
public MainSurfaceView(Context context, AttributeSet attrs, int defStyle){
    super(context, attrs);
} 
```

没有解决问题。

我的清单文件：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
      package="<package>"
      android:versionCode="5"
      android:versionName="1.2.1">
    <uses-sdk android:minSdkVersion="8" />

    <supports-screens android:largeScreens="true"
                      android:anyDensity="true"
                      android:normalScreens="true"
                      android:smallScreens="true"
                      android:resizeable="true" />

    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>

    <application android:icon="@drawable/icon" android:label="@string/app_name">
        <activity android:name=".<project>Activity"
                  android:label="@string/app_name"
                  android:screenOrientation="portrait">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity android:name="com.google.ads.AdActivity"
            android:theme="@android:style/Theme.NoTitleBar.Fullscreen"
            android:configChanges="keyboard|keyboardHidden|orientation" />

    </application>
</manifest> 
```

还有我的布局文件：

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout
  xmlns:android="http://schemas.android.com/apk/res/android"
  xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
  android:orientation="vertical"
  android:layout_width="480dp"
  android:layout_height="800dp"
  android:layout_gravity="center">

    <<package>.MainSurfaceView android:id="@+id/glSurface" android:layout_width="fill_parent"
         android:layout_height="fill_parent" android:layout_gravity="top|left"/>

  <com.google.ads.AdView android:id="@+id/adView"
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content"
    android:layout_gravity="bottom"
    android:visibility="visible"
    android:layout_alignParentTop="true"
    ads:adSize="BANNER"
    ads:adUnitId="<id>"
    ads:loadAdOnCreate="true"/>

</FrameLayout> 
```

谢谢你的帮助。如果有人可以告诉我如何重新创建错误，那也将非常有帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-10T16:11:42.560

如果您已更新到*ADTv17*或更高版本，旧的*ProGuard*文件将对您执行此操作。创建一个新的空项目，查看*project.properties*和*proguard-properties*并相应地修改您当前的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-29T05:32:14.777

我建议使用 try catch 块来查找确切的错误。就我而言，我还发现了“java.lang.ClassNotFoundException”。在我调试它之后，它在 catch 块中被捕获。它显示“android.view.InflateException: Binary XML file line #7: Error inflating class fragment”。因此，当我们遇到上述错误时，我们需要先调试它以找到确切的错误。

# forms - JasperReports：pdf 表单——分页符

> ID：10962960
> 
> 赞同：0
> 
> 时间：2012-06-09T17:14:53.827
> 
> 标签：forms, pdf, jasper-reports, ireport, page-break

我正在尝试使用*JasperReports* ( *iReport* ) 生成 PDF 应用程序 (表单)。

这是要求：

我有一个 XML 文件，它是该报告的数据源。我有一个申请人，并且可以有多个受抚养人。我在矩形框（无 jtable）中显示依赖信息，每个依赖者一行。我需要在每个依赖计数 5 之后添加一个分页符。

分页表达式在这里可以工作吗，在我看来，在表格形式的标准报告的情况下很容易分页，您可以在其中限制每页的记录数。但我正在做的不是报告，而是具有多种格式的表格。

有人知道如何做到这一点吗？

# jquery - 使用 Jquery 删除动态创建的表单元素

> ID：10962962
> 
> 赞同：1
> 
> 时间：2012-06-09T17:15:27.207
> 
> 标签：jquery, forms

我有这个有效的代码：

```
return form.find('input[name!=user_view]').serializeArray(); 
```

但我现在也想省略我添加的另一个输入框，但我不知道如何删除多个元素。

所以我想做这样的事情：

```
return form.find('input[name!=user_view],input[name!=client_view]').serializeArray(); 
```

但它不起作用。

什么是正确的函数/语法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T17:18:33.780

试试这个：

```
return form
          .find(':not(input[name=user_view],input[name=client_view])')
          .serializeArray(); 
```

# c# - 当我在 C# 中使用 ANTLR 制作的解析器时，看不到任何事情发生

> ID：10962966
> 
> 赞同：0
> 
> 时间：2012-06-09T17:15:59.757
> 
> 标签：c#, antlr

我有一些制作笔译和口译的知识和技能。但在每种情况下，我都使用了手写解析器。现在我有一个好主意，可以编写一个解释器，通过自己的 .NET 上的虚拟机工作，这样它就可以使用它的任何到达 API。也许IL的编译器也会出现。我决定使用 ANTLR 来提高开发速度，并主要关注语言和 VM 代码，而不是解析。ANTLR - 因为我在 Wikipedia 中发现它有一个 IDE，并且可以为 C# 生成解析器代码，我选择它来编写我的程序。

经过一些努力，我强制我的代码编译。这是 C# 代码：

```
using System;
using System.Resources;
using System.Reflection;
using System.Globalization;
using System.Configuration;
using System.IO;
using Antlr.Runtime;

class AgathaInterpretter
{
    static ResourceManager rm;
    static CultureInfo ci;

    static string GetString(string key)
    {
        try
        {
            return rm.GetString(key, ci);
        }
        catch (Exception)
        {
            return "Resource string not found.";
        }
    }

    public static void Main(string[] args)
    {
        ci = new CultureInfo(ConfigurationManager.AppSettings["locale"]);
        rm = new ResourceManager("Agatha.Messages", Assembly.GetExecutingAssembly());

        switch (args.Length)
        {
            case 0:
                Console.WriteLine(GetString("ERROR_COMMAND_LINE_ARGS_ZERO"));
                return;
            case 1:
                break;
            default:
                Console.WriteLine(GetString("ERROR_COMMAND_LINE_ARGS_GREATER"));
                return;
        }

        StreamReader streamReader;
        try
        {
            streamReader = new StreamReader(args[0]);
        }
        catch (Exception)
        {
            Console.WriteLine(GetString("ERROR_SCRIPT_FILE_INACCESSIBLE"));
            return;
        }
        string str = "";
        while (!streamReader.EndOfStream)
            str += streamReader.ReadLine() + "\n";
        Console.WriteLine(str);

        ANTLRStringStream Input = new ANTLRStringStream(str);
        AgathaLexer Lexer = new AgathaLexer(Input);
        CommonTokenStream Tokens = new CommonTokenStream(Lexer);
        AgathaParser Parser = new AgathaParser(Tokens);
        Parser.prog();
    }
} 
```

这是我的语法：

```
grammar Agatha;

options
{
    language=CSharp2;
}

tokens {
    PLUS    = '+' ;
    MINUS   = '-' ;
    MULT    = '*' ;
    DIV = '/' ;
    LP = '(' ; 
    RP = ')' ;
    SEMICOLON = ';' ;
    ASSIGN = '=';
}

public prog: statement+ ;

statement: assignmentExpression | SEMICOLON ; 

assignmentExpression    : ID ASSIGN additiveExpression SEMICOLON| additiveExpression SEMICOLON ;

additiveExpression: multiplicativeExpression ( ( PLUS | MINUS )  multiplicativeExpression )* ;

multiplicativeExpression: unaryExpression ( ( MULT | DIV ) unaryExpression )* ;

unaryExpression : LP assignmentExpression RP | NUMBER | ID; 

NUMBER  : (DIGIT)+ ;

WS : (' ' |'\t' |'\n' |'\r' )+ {skip();} ;

ID : ('a'..'z' |'A'..'Z' )+ ;

fragment DIGIT  : '0'..'9' ; 
```

似乎是有效的，生成了解析器。首先发布我的 C# 代码后，我尝试加载不同的文件并用我的 prog() 解析它们。但是，如果我也提供错误的源，没有例外，没有输出到控制台，什么都不会发生。我想先接受一些培训，但没有得到任何培训。我哪里错了？发生了什么？

# c# - 是否有 ac# 开源 OCR 可以从个人支票中提取信息？

> ID：10962967
> 
> 赞同：0
> 
> 时间：2012-06-09T17:15:59.860
> 
> 标签：c#, ocr

我一次扫描多张支票，并希望通过 OCR 传递支票图像来获取以下信息。

*   姓名
*   地址
*   支票号码
*   路由号码
*   帐号
*   金额（手写）

Ammount 是我可以从支票扫描仪获取帐号的大人物

是否有在 C# 中执行此操作的开源或示例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T17:20:08.287

有一个名为 Tesseract 的库，我用来从护照 ( [http://code.google.com/p/tesseract-ocr/](http://code.google.com/p/tesseract-ocr/) ) 中获取信息。

我只是把它拿出来执行，它工作得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T22:17:28.850

Tesseract 是一个很好的开源选项。我在 C# 程序中用作引擎（使用 C# 包装器 Tessnet2）。我的程序中也有一个验证阶段，因此您可以查看已识别的内容并确认或修复它。

# objective-c - 为 iOS 分发预加载的 TouchDB 数据库

> ID：10962969
> 
> 赞同：1
> 
> 时间：2012-06-09T17:16:14.133
> 
> 标签：objective-c, ios, touchdb

我在应用程序上使用 TouchDB 与云上的 CouchDB 服务器同步数据。

一切正常，但我现在需要使用应用程序包部署应用程序的预加载版本，因此用户不必下载 MB 的静态数据。

这样做的最佳方法是什么？我正在考虑只在我的项目中包含带有数据库和附件的 TouchDB 目录，在初始化 TouchDB 数据库之前，我检查它是否存在于“应用程序支持”数据库下，如果不存在，则将其复制到我的代码中。

这是正确的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T15:29:12.577

您可以在应用程序包中包含数据库和附件目录，然后使用

```
-(BOOL) replaceWithDatabaseFile: (NSString*)databasePath
                 withAttachments: (NSString*)attachmentsPath
                           error: (NSError**)outError; 
```

[https://github.com/couchbaselabs/TouchDB-iOS/blob/master/Source/TD_Database.h#L87](https://github.com/couchbaselabs/TouchDB-iOS/blob/master/Source/TD_Database.h#L87)

看起来这在执行您计划的操作之前会进行一些完整性检查：

[https://github.com/couchbaselabs/TouchDB-iOS/blob/master/Source/TD_Database.m#L91](https://github.com/couchbaselabs/TouchDB-iOS/blob/master/Source/TD_Database.m#L91)

但是，这确实意味着您不必使复制代码与数据库保存其文件的位置保持同步。

# c++ - StillImage::GetDeviceList 指针

> ID：10962982
> 
> 赞同：0
> 
> 时间：2012-06-09T17:18:20.300
> 
> 标签：c++, windows, winapi, pointers

我试图在一个名为 StillIamge 的接口中调用一个名为 GetDevicesList 的方法调用，但我得到的是空结果。我认为这是一个指针问题，但我不是 C++ 专家，我认为这就是问题所在。方法调用是：

```
HRESULT GetDeviceList(
  DWORD dwType,
  DWORD dwFlags,
  [out]  DWORD *pdwItemsReturned,
  [out]  LPVOID *ppBuffer
); 
```

我知道它正在工作，因为当我插入和拔出成像设备时，返回的设备的数量会上下波动。我认为结果为空白的事实是由于我没有得到正确的指针 - 有人可以快速查看一下并让我知道是否是这个原因吗？

```
#include "stdafx.h"

bool debug = true;

int _tmain(int argc, _TCHAR* argv[])
{
    DWORD dwStiTotal = 0;
    PSTI pSti = NULL;
    HRESULT hres = StiCreateInstance(GetModuleHandle(NULL), STI_VERSION, &pSti, NULL);

    STI_DEVICE_INFORMATION deviceInfo[255];
    memset(deviceInfo,0, sizeof(deviceInfo));

    hres = pSti->GetDeviceList(NULL, NULL, &dwStiTotal, (LPVOID*) deviceInfo); 
    printf("number devices %d\n", dwStiTotal);
    for (int i=0; i<dwStiTotal; i++){
        printf("---------------------------------------------------\n");
        printf("type %d\n", deviceInfo[i].DeviceType);
        printf("vendor %s\n", deviceInfo[i].pszVendorDescription);
        printf("device %s\n", deviceInfo[i].pszDeviceDescription);
        printf("portname %s\n", deviceInfo[i].pszPortName);
        printf("PropProvider %s\n", deviceInfo[i].pszPropProvider);
        printf("LocalName %s\n", deviceInfo[i].pszLocalName);
        printf("InternalName %s\n", deviceInfo[i].szDeviceInternalName);
    }
    pSti->Release();

    if (debug){
        char key;
        std::cin >> key;
    }

    return 0;
} 
```

提前非常感谢，很抱歉提出这样一个基本问题！

问候，

尼尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T17:38:23.913

如果检查 的[引用](http://msdn.microsoft.com/en-us/library/windows/hardware/ff543784%28v=vs.85%29.aspx)，`GetDeviceList`则最后一个参数*ppBuffer*是指向*STI 分配的*缓冲区的*（指向 a）*句柄。您正在尝试向它发送您自己分配的缓冲区，我相信这甚至应该以某种方式崩溃...

 *无论如何，这是正确的方法

```
STI_DEVICE_INFORMATION* deviceInfo = NULL;
hres = pSti->GetDeviceList(NULL, NULL, &dwStiTotal, (LPVOID*) &deviceInfo); 
```

我们得到的是一个指向项目数组的指针，由*STI*本身`STI_DEVICE_INFORMATION`分配。完成后，您需要使用.*`LocalFree`**

# python - 查找任何带有逗号或空格的文本

> ID：10962983
> 
> 赞同：0
> 
> 时间：2012-06-09T17:18:22.303
> 
> 标签：python, regex

我有一些文字。你可以在这里看到它。

```
str1 = '{5723647 9 aqua\t \tfem nom/voc pl}{5723647 9 aqua\t \tfem dat sg}{5723647 9 aqua\t \tfem gen sg}'
str2 = '{27224035 2 equo_,equus#1\t \tmasc abl sg}{27224035 2 equo_,equus#1\t \tmasc dat sg}' 
```

这是我想要得到的：

```
result1 = [('aqua', 'fem nom/voc pl'), ('aqua', 'fem dat sg'), ('aqua', 'fem gen sg')]
result2 = [('equus#1', 'masc abl sg'), ('equus#1', 'masc dat sg')] 
```

正如您在此处看到的，可以有两种变体：

1.  (anytext,)(word-I-need)\t \t(form-I-need)。
2.  (anytext)(word-I-need)\t \t(form-I-need)。

这是我尝试过的正则表达式：

```
pattern = re.compile(r'\d* \d*(?:,| )(.*?)\t \t(.*?)}') 
```

这是我得到的：

```
[('aqua', 'fem nom/voc pl'), ('aqua', 'fem dat sg'), ('aqua', 'fem gen sg')]
[('equo_,equus#1', 'masc abl sg'), ('equo_,equus#1', 'masc dat sg')] 
```

但是，第二个必须是：

```
[('equus#1', 'masc abl sg'), ('equus#1', 'masc dat sg')] 
```

你有什么建议？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T17:45:25.133

```
pattern = re.compile(r"\{(?:.*?,|.*?)(\S+)\t \t(.*?)\}") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T17:44:44.620

这将是少数人的意见，但为什么不使用正则表达式逻辑来处理更容易使用正则表达式编写的东西，然后使用 Python 来处理其余部分呢？除其他外，它更能适应变化。就像是

```
>>> import re
>>> 
>>> str1 = '{5723647 9 aqua\t \tfem nom/voc pl}{5723647 9 aqua\t \tfem dat sg}{5723647 9 aqua\t \tfem gen sg}'
>>> str2 = '{27224035 2 equo_,equus#1\t \tmasc abl sg}{27224035 2 equo_,equus#1\t \tmasc dat sg}'
>>> 
>>> pattern = re.compile("{([^\}]*)}")
>>> 
>>> def extract(part):
...     ps = part.split()
...     word = ps[2].split(',')[-1]
...     form = ' '.join(ps[3:])
...     return word, form
... 
>>> for s in str1, str2:
...     for entry in re.findall(pattern, s):
...         print extract(entry)
... 
('aqua', 'fem nom/voc pl')
('aqua', 'fem dat sg')
('aqua', 'fem gen sg')
('equus#1', 'masc abl sg')
('equus#1', 'masc dat sg') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T18:27:40.217

像这样的东西可能会起作用

```
([^{\s,]*)\t \t([^}]*) 
```

# c# - 将新字符串添加到文件的最后一行

> ID：10962988
> 
> 赞同：1
> 
> 时间：2012-06-09T17:18:43.613
> 
> 标签：c#

正如标题所说，我想在文件底部添加一个新字符串，但不知何故，它不起作用。希望有人可以帮助我x___x

```
 private string add(string asd){
        {string filename = "asd.txt";
        StreamReader reader = new StreamReader(filename);
        StreamWriter write = new StreamWriter(filename);
        string input = null;
        while ((input = reader.ReadLine()) != null)
        {
            write.WriteLine(input);
        }
        reader.Close();
        write.WriteLine(asd);
        write.Close();} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-09T17:21:32.387

使用[`File.AppendAllText`](http://msdn.microsoft.com/en-us/library/ms143356).

> 打开文件，将指定的字符串附加到文件，然后关闭文件。如果文件不存在，此方法创建一个文件，将指定的字符串写入文件，然后关闭文件。

例子：

```
private string Add(string asd) {
    string filename = "asd.txt";
    File.AppendAllText(filename, asd);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T17:20:34.293

您正在同时从同一个文件中写入/读取。那是行不通的。您必须创建一个要写入的临时文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T17:37:35.403

怎么样的东西：

```
private string add(string asd){
{
        string filename = "asd.txt";
        string readText = File.ReadAllText(filename );
        File.WriteAllText(filename , createText + asd);
} 
```

# c# - 列出文件夹中的所有文件 - 文件的完整路径

> ID：10962989
> 
> 赞同：7
> 
> 时间：2012-06-09T17:18:44.463
> 
> 标签：c#, .net

我有一个文件夹，`C:\Name\Folder\`里面有几个文件。

我需要显示该文件夹中文件的完整文件路径。

它应该以 . 格式显示所有文件`C:\Name\Folder\file.txt`。我的代码如下；

```
string[] filePaths = Directory.GetFiles(@"C:\Name\Folder\");
for (int i = 0; i < filePaths.Length; ++i) {
    string path = filePaths[i];
    Console.WriteLine(System.IO.Path.GetFileName(path));
} 
```

它只打印文件名，但我还需要它来打印文件的完整路径。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-09T17:24:09.677

简单地打印`path`变量有什么问题？

顺便说一句，您可以通过`foreach`语句迭代文件：

```
foreach(var path in Directory.GetFiles(@"C:\Name\Folder\"))
{
   Console.WriteLine(path); // full path
   Console.WriteLine(System.IO.Path.GetFileName(path)); // file name
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-09T17:20:28.400

使用以下，

```
System.IO.Path.GetFullPath(path); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-09T17:24:26.273

`Directory.GetFiles`返回完整路径。您只看到文件名，因为您调用`Path.GetFileName`. `path`如果您需要完整路径，请使用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-09T17:22:52.733

如果您已经拥有 filePaths 中的路径，您需要调用 GetFileName 做什么？ [无论如何，对于此类信息，使用Directory/FileInfo classes](http://msdn.microsoft.com/en-us/library/system.io.directoryinfo.aspx)
可能更容易，它们具有所有必需的属性（例如 Fullpath）

# box2d - 如何使用 Box2d 将 2 根绳索连接到悬挂标志？

> ID：10962990
> 
> 赞同：0
> 
> 时间：2012-06-09T17:18:52.890
> 
> 标签：box2d

我正在使用此问题/答案中的代码，并且效果很好：[Box2d 弹性绳索接头](https://stackoverflow.com/questions/9171937/box2d-elastic-rope-joint)

该代码使用 FOR 循环进行迭代以创建绳索接头。我试图让它挂一个标志并自然摆动。我创建了第二个 FOR 循环，这很有效。我现在有 2 根秋千绳！

我的问题是，如何将每根绳子的末端连接到标志（矩形精灵）？

我设法让它连接到第二根绳子，最后一个夹具（因为这些是 FOR 循环运行后的自然值）并且它工作得很好，只有第一根绳子没有连接到标志。我需要能够找出第一根绳子的最后一个关节/身体是什么，以便我可以将它（关节）连接到标志对象......所以我真的在问如何找到最后一个关节/第一个绳索的主体（即第一个 FOR 环）？

# javascript - Node.js MYSQL 在前一个查询完成后按顺序运行每个查询？

> ID：10962993
> 
> 赞同：0
> 
> 时间：2012-06-09T17:19:05.293
> 
> 标签：javascript, mysql, node.js, asynchronous

我正在使用来自 Node.js 的 Javascript MYSQL 库，然后我有多个查询要循环运行。但是当我运行循环时，`the loop`总是在它开始的查询仍在处理时突然到达结束（完成）。那么我如何保持循环等待每个查询完成，然后正常继续？

我的代码是：

```
function startHere() {
    console.log("-- START --");
    for (i=1; i < 6; i++) {
        dbInsert(i);
    }
    console.log("-- END --");
}
function dbInsert(id) {
    connection.query (
        'INSERT INTO table SET data=?',
        [id],
        function selectCb(err, results, fields) {
            if (err) {
                console.log(err.message);
            }
            if (results.length > 0) {
                console.log(id+" RECORDS ADDED!");
            }
        }
    );
}
startHere(); 
```

当我运行它时，它总是返回如下：

```
-- START --
-- END --
1 RECORDS ADDED!
2 RECORDS ADDED!
3 RECORDS ADDED!
4 RECORDS ADDED!
5 RECORDS ADDED! 
```

这意味着，循环不会等待它开始的查询结束。
如何检测查询的端点并使其工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T10:35:21.280

[`async`](https://github.com/caolan/async)应该为你工作

```
async.series([
    function(){ ... },
    function(){ ... }
]); 
```

见[https://github.com/caolan/async#series](https://github.com/caolan/async#series)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T18:16:47.687

您的 selectCb 方法没有被同步调用，因此您的循环有效地触发了每个调用然后返回。

您可以检查文档以获取该 connection.query 方法的同步版本，或者您需要创建一个回调以在所有插入触发后打印结束消息。

# javascript - 按 ID 查找和元素并在特定时间后重定向

> ID：10962995
> 
> 赞同：-2
> 
> 时间：2012-06-09T17:19:33.733
> 
> 标签：javascript

我正在使用以下 JS 来定位 ID 为“someID”的元素，然后在 6 秒后重定向。我只希望它在存在此元素 ID 的页面上工作，但现在它会重定向它应用到的所有页面。我在这里做错了什么？

```
if (!document.getElementById("someID")) {
            setTimeout(function () {
             window.location.href = "http://www.somesite.com"; 
        }, 6000); 

}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T18:00:16.487

我的猜测是您没有等到实际元素加载完毕。

如果您的代码位于页面头部，则需要将其包装在 onload 中，以使脚本在元素可用之前不会执行：

```
window.onload=function(){
 if (document.getElementById("someID")) {
   setTimeout(function () {
     window.location.href = "http://www.somesite.com"; 
   }, 6000); 
  }     
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T17:23:24.340

```
if (document.getElementById("someID") != null) {
            setTimeout(function () {
             window.location.href = "http://www.somesite.com"; 
        }, 6000); 
}; 
```

# php - PDO：无法将变量传递给准备

> ID：10962999
> 
> 赞同：0
> 
> 时间：2012-06-09T17:19:44.590
> 
> 标签：php, mysql, pdo

> **可能重复：**
> [PHP PDO bindValue in LIMIT](https://stackoverflow.com/questions/2269840/php-pdo-bindvalue-in-limit)

```
 $number=8;
    try {  
        $topics=$dbh->prepare("SELECT * FROM topictable ORDER BY RAND() LIMIT ?");
        $topics->execute(array($number));       
        $topicarray = $topics->fetch(PDO::FETCH_BOTH);
        print_r($topicarray);
    }  
    catch(PDOException $e) {  
        echo $e->getMessage();  
    } 
```

以上是我的代码，我知道问题出在哪里，`$topics=$dbh->prepare("SELECT * FROM topictable ORDER BY RAND() LIMIT ?")`因为当我更改时？到8，它的工作原理。请赐教。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T17:36:55.590

```
$topics=$dbh->prepare("...LIMIT :limit");
$topics->bindValue(':limit', intval($number), PDO::PARAM_INT);
$topics->execute(); 
```