# StackOverflow 问答 000204000-000204999

# mysql - 奇怪的 MySQL 语法错误

> ID：204007
> 
> 赞同：0
> 
> 时间：2008-10-15T08:20:02.263
> 
> 标签：mysql

我收到此错误：-

您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'ï»¿ 附近使用正确的语法

每当我尝试这样的事情时：-

```
mysql> source /home/user1/sql/ddl.sql
mysql> source /home/user1/sql/insert.sql
mysql> source /home/user1/sql/cleanup.sql 
```

有趣的是，这发生在每个 sql 脚本中，但只有第一条语句被破坏。脚本中的其余语句将运行良好。我通过在每个脚本中放置一个虚拟语句来解决这个问题。

以前有人遇到过这个问题吗？我完全被难住了，检查谷歌还没有帮助。提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-15T08:26:36.367

一种可能性是 SQL 文件是用带有[BOM](https://en.wikipedia.org/wiki/Byte_Order_Mark)的 Unicode 编写的，MySQL 无法解释。

这可以解释症状。

一个解决方案是在一个像样的编辑器中打开它们并在没有它的情况下将它们保存回来。

VIM 中的示例：

强制移除 BOM

```
:set nobomb 
```

保存并退出

```
:x! 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T08:24:15.407

您的输入文件可能包含[Unicode BOM](http://en.wikipedia.org/wiki/Byte_Order_Mark)，有些程序（例如记事本）将其放在文件开头以指示文件格式，这有点麻烦。

# c# - 条码图像到 C# 中的 Code39 转换？

> ID：204008
> 
> 赞同：6
> 
> 时间：2008-10-15T08:21:46.457
> 
> 标签：c#, image-processing, barcode, code39

我有 jpg 格式的条形码图像，并想从中提取条形码 #。请帮忙！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-15T08:48:08.150

我们开发了 ac# 组件，它可以从所有维度、旋转、质量等条码中读取值。它尚未发布，但我们将在[http://blog.lemqi.com](http://blog.lemqi.com)上发布有关它的详细信息。它可能是免费的（也许是开源的）。但也许距离发布还有 1-2 周，因为我们之前必须重构代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-07T09:52:27.373

请参阅 CodeProject 文章：[从图像中读取条形码 - II](http://www.codeproject.com/KB/graphics/barcodeimaging2.aspx)。

作者 ( [James](http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1770204) ) 改进（并归功于）[以前编写](http://www.codeproject.com/KB/dotnet/barcodeImaging.aspx)的VB 库，以仅使用 .NET 代码从图像中解码条形码。

可下载的解决方案中有两个项目：

*   条码库 - 用 C# 编写
*   测试应用程序 - 用 VB 编写

我已经成功地将 VS2008 中的 C# 代码用于带有扩展（包括 alpha 字符）代码 39 条码的 JPG 图像。

该库能够扫描整个图像以查找条形码，其中条形码只是其中的一部分。这有好有坏。它更灵活，但您可能必须解析噪声。当然，您会希望从尽可能干净的图像开始。此外，扫描的条形码必须相当笔直，不得旋转或倾斜。

如果您可以将扫描限制为实际条形码的“切片”，您可能会获得更好的准确性。

在文章评论中，[另一个用户](http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2393263)提交[了一个](http://www.codeproject.com/KB/graphics/barcodeimaging2.aspx?fid=191552&select=1482523#xx1482523xx)重新扫描条形码并使用校验和数字的功能，如果您控制原始条形码的打印并且可以首先包含校验和，那就太好了。

当然，有一些非常令人印象深刻（也有一些非常昂贵）的商业解决方案具有经过充分测试、更灵活、可以扫描更多条码格式以及由于改进了图像采样而对图像质量更宽容的优势。但这是一个很好的（*免费*）开始！

*您需要注册 CodeProject 才能下载代码，但这也是免费的 - 值得花时间，因为该网站上有很多好的代码！*

更新：顺便说一句，我刚刚查看了Joachim [Kerschbaumer](https://stackoverflow.com/users/20227/joachim-kerschbaumer)在您的问题的[另一个答案中提到的](https://stackoverflow.com/questions/204008/barcode-image-to-code39-conversion-in-c#204084)[博客](http://blog.lemqi.com/)。一定要关注那个项目！它看起来是一个**非常**强大的解决方案。如果它可以从那些繁忙的图像中读取那些歪斜的条形码，那么它可以做任何事情！

 *** * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T08:44:16.737

我使用 softek 条码工具包 - [http://www.bardecode.com/](http://www.bardecode.com/)

效果很好 - 单个开发人员 249 美元。

# html - 获取 html 文件的最后修改日期

> ID：204010
> 
> 赞同：7
> 
> 时间：2008-10-15T08:21:53.833
> 
> 标签：html, date

我如何找出导入到我的网络应用程序中的 html 文件的最后修改日期？

html 文件位于另一台服务器上，不同的用户可以进行更新，当我检索页面时，我希望能够看到它上次更新的时间，以便我可以在主页上标记更新日期。一世

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-15T08:31:22.397

我假设您正在使用 HTTP 来检索页面。

在这种情况下，您可以使用 HTTP 的 HEAD 方法来获取文件的标头数据。（见[http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html，9.4](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)）

然后您可以检查响应的“Last-Modified”标头。（参见[http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html，14.29](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)）

在某些缓存机制（代理、浏览器缓存）的情况下，可能需要在请求标头中包含“Cache-Control: must-revalidate”。（参见[http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html，14.9.4](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-15T08:26:21.470

使用`document.lastModified`Javascript 属性。

quirksmode 也有一个很好的功能来格式化日期：[http ://www.quirksmode.org/js/lastmod.html](http://www.quirksmode.org/js/lastmod.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-15T08:29:42.960

您可以使用响应标头中的[Last-Modfied 标](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)头。

> Last-Modified 实体标头字段指示源服务器认为最后修改变体的日期和时间。

```
 Last-Modified  = "Last-Modified" ":" HTTP-date 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-15T08:30:42.507

```
<script type="text/javascript">
<!--
document.write(document.lastModified);
// -->
</script> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-11-17T12:19:37.817

有一些建议的元标记键表示可以使用的都柏林核心值。请参阅：[https ://stackoverflow.com/a/14893974/895245](https://stackoverflow.com/a/14893974/895245)

# python - 如何从 Python 执行程序？os.system 由于路径中的空格而失败

> ID：204017
> 
> 赞同：295
> 
> 时间：2008-10-15T08:24:28.760
> 
> 标签：python, shellexecute

我有一个需要执行外部程序的 Python 脚本，但由于某种原因失败了。

如果我有以下脚本：

```
import os;
os.system("C:\\Temp\\a b c\\Notepad.exe");
raw_input(); 
```

然后它失败并出现以下错误：

> 'C:\Temp\a' 不是内部或外部命令、可运行程序或批处理文件。

如果我用引号转义程序：

```
import os;
os.system('"C:\\Temp\\a b c\\Notepad.exe"');
raw_input(); 
```

然后它工作。但是，如果我添加一个参数，它会再次停止工作：

```
import os;
os.system('"C:\\Temp\\a b c\\Notepad.exe" "C:\\test.txt"');
raw_input(); 
```

执行程序并等待它完成的正确方法是什么？我不需要从中读取输出，因为它是一个执行工作然后退出的可视程序，但我需要等待它完成。

另请注意，将程序移动到非间隔路径也不是一种选择。

* * *

这也不起作用：

```
import os;
os.system("'C:\\Temp\\a b c\\Notepad.exe'");
raw_input(); 
```

注意交换的单/双引号。

这里有或没有记事本的参数，它会失败并显示错误消息

> 文件名、目录名或卷标语法不正确。

* * *

## 回答 #1

> 赞同：308
> 
> 时间：2008-10-15T08:37:39.200

[`subprocess.call`](http://docs.python.org/2/library/subprocess.html#using-the-subprocess-module)将避免不得不处理各种 shell 的引用约定的问题。它接受一个列表，而不是一个字符串，因此参数更容易分隔。IE

```
import subprocess
subprocess.call(['C:\\Temp\\a b c\\Notepad.exe', 'C:\\test.txt']) 
```

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2008-10-15T20:09:37.587

这是一种不同的方法。

如果您使用的是 Windows，则以下操作类似于在资源管理器中双击文件，或将文件名作为 DOS“启动”命令的参数：文件使用与其扩展名关联的任何应用程序（如果有）打开.

```
filepath = 'textfile.txt'
import os
os.startfile(filepath) 
```

例子：

```
import os
os.startfile('textfile.txt') 
```

如果记事本与 .txt 文件关联，这将使用记事本打开 textfile.txt。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2009-05-26T18:13:51.810

最外层的引号被 Python 本身使用，Windows shell 看不到它。如上所述，Windows 只理解双引号。Python 将在 Windows 上将正斜杠转换为反斜杠，因此您可以使用

```
os.system('"C://Temp/a b c/Notepad.exe"') 
```

' 由 Python 使用，然后将“C://Temp/abc/Notepad.exe”（作为 Windows 路径，不需要双反斜杠）传递给 CMD.EXE

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-10-26T01:33:47.333

至少在 Windows 7 和 Python 3.1中，如果命令的路径中有空格，`os.system`Windows 希望命令行被*双引号引起来。*例如：

```
 TheCommand = '\"\"C:\\Temp\\a b c\\Notepad.exe\"\"'
  os.system(TheCommand) 
```

一个让我难过的真实例子是在 VirtualBox 中克隆一个驱动器。由于某些访问权限问题，上面的`subprocess.call`解决方案不起作用，但是当我双引号命令时，`os.system`变得很高兴：

```
 TheCommand = '\"\"C:\\Program Files\\Sun\\VirtualBox\\VBoxManage.exe\" ' \
                 + ' clonehd \"' + OrigFile + '\" \"' + NewFile + '\"\"'
  os.system(TheCommand) 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2018-01-22T13:16:24.057

对于 python >= 3.5`subprocess.run`应该用来代替`subprocess.call`

[https://docs.python.org/3/library/subprocess.html#older-high-level-api](https://docs.python.org/3/library/subprocess.html#older-high-level-api)

```
import subprocess
subprocess.run(['notepad.exe', 'test.txt']) 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2010-04-30T07:08:44.977

```
import win32api # if active state python is installed or install pywin32 package seperately

try: win32api.WinExec('NOTEPAD.exe') # Works seamlessly
except: pass 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-15T08:27:05.633

我怀疑这与您在 Windows 中使用快捷方式时的问题相同......试试这个：

```
import os;
os.system("\"C:\\Temp\\a b c\\Notepad.exe\" C:\\test.txt"); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-01-22T13:29:24.267

假设我们要运行您的 Django Web 服务器（在 Linux 中），您的路径 (path= `'/home/<you>/<first-path-section> <second-path-section>'`) 之间有空格，因此请执行以下操作：

```
import subprocess

args = ['{}/manage.py'.format('/home/<you>/<first-path-section> <second-path-section>'), 'runserver']
res = subprocess.Popen(args, stdout=subprocess.PIPE)
output, error_ = res.communicate()

if not error_:
    print(output)
else:
    print(error_) 
```

* * *

[**注**]：

*   不要忘记访问权限：`chmod 755 -R <'yor path'>`
*   `manage.py`是可执行的：`chmod +x manage.py`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-08-07T16:55:33.170

对于 Python 3.7，使用[subprocess.call](https://docs.python.org/3.7/library/subprocess.html#using-the-subprocess-module)。使用原始字符串来简化 Windows 路径：

```
import subprocess
subprocess.call([r'C:\Temp\Example\Notepad.exe', 'C:\test.txt']) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-04-26T04:32:59.230

不需要子流程，可以简单的实现

```
GitPath="C:\\Program Files\\Git\\git-bash.exe"# Application File Path in mycase its GITBASH
os.startfile(GitPath) 
```

# sql - 数据库无关应用程序的数据库设计

> ID：204025
> 
> 赞同：18
> 
> 时间：2008-10-15T08:28:21.857
> 
> 标签：sql, database, database-design

对于应该能够支持最常见的关系数据库系统（SQL Server、MySQL、Oracle、PostgreSQL ...）的新应用程序**的数据库设计**，我必须考虑什么？

甚至值得努力吗？有哪些陷阱？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-15T09:45:28.847

简短的回答是坚持标准或接近标准实现的功能。这意味着更详细的是：

*   避免使用数据库的过程语言（存储过程或触发器），因为这是系统之间存在巨大差异的地方。您可能需要使用它们来模拟某些功能，但不要使用它们来创建自己的功能。

*   将自动增量字段的序列与字段本身分开。这对于 MSSQL 来说看起来有点强制，但会在 Oracle、DB/2 等中干净利落地实现，而不需要任何仿真修复。

*   将 char 和 varchar 字段保持在您所针对的引擎集的最小最大大小以下。

*   当您编写查询时，请使用完整的 JOIN 语法，并将 JOIN 括起来，以便每个连接都位于单个表和带括号的表达式之间。

*   将日期处理逻辑保留在代码中，而不是查询中，因为许多日期函数超出了标准。（例如：如果您想获取过去两周的内容，请在代码中计算两周前的日期并在查询中使用它。）

除此之外，所涉及的努力不应该太吓人，所以它可能是值得的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-15T08:43:48.563

如果我是你，我会**认真考虑你在这里的投资回报**。

能够连接到任何后端或随时更改后端*听起来*总是一个好主意，但根据我的经验，这在现实世界中很少发生。

事实证明，您可以通过仅支持 Oracle 和 SQL Server（或 MySQL 和 SQL Server，或...等）来覆盖 95% 的潜在客户。

**在继续之前做你的研究**，祝你好运！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-15T08:41:49.753

我目前支持 Oracle、MySQL 和 SQLite。老实说，这很难。一些建议是：

*   避免存储过程，但您可能需要它们来模拟某些平台上缺少的功能（见下文）
*   学习如何使用触发器，因为您需要它们来模拟缺少的功能（例如，对于 Oracle，您没有自动增量，因此您需要模拟它，一个不错的选择是使用触发器）
*   拥有一个不错的测试环境，因为您需要测试大量 SQL，然后才能确定它在所有平台上都在执行您想要的操作。

值得吗……这取决于。在商业上，对于企业级应用程序来说这是值得的，但对于博客或网站，如果可以的话，你最好坚持使用一个平台。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-15T08:42:41.657

人们经常会告诉你的一个答案是不要使用特定于数据库的 sql，而只是按照 ansi 标准编写代码。他们通常会说只通过存储过程与数据库对话以抽象出任何 sql。这些都是错误的答案，只会导致痛苦。编码为“标准”sql 几乎是不可能的，因为每个供应商都有如此不同的解释。

你需要做的是有某种数据库持久层来抽象数据库之间的差异（对不起，johnstock，这几乎就是你所说的）。每个平台都有许多其他 ORM 和类似产品可以做到这一点，

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-15T08:44:13.307

我将抄袭 johnstok 的回答：1）不要使用存储过程和 2）不要使用供应商特定的 SQL，并添加到它。

你还问，“这值得努力吗？”。我会说……也许吧。我编写了一个基于 SQL Server 的开源错误跟踪器 BugTracker.NET。许多开发人员根本不会尝试，因为他们喜欢坚持自己熟悉的技术。而且，当我考虑启动托管服务时，我注意到专用的 Linux 虚拟服务器比 Windows（非虚拟）服务便宜得多。理论上我可以在单声道下运行 C#，但是我的 SQL 是特定于 SQL Server 的（即使我不使用存储过程），移植起来会很费劲。

如果您的目标是商业/企业市场，您会发现有些商店严格使用 Oracle 或严格的 SQL Server，并且您的应用程序可能会根据其使用的技术在竞争的前几轮中被排除在外。

所以，对你来说，也许开放确实很重要。它是一个什么样的应用程序？谁会使用它？

您还问，“有什么陷阱”。不进行测试。如果您计划支持您列出的 4 个 db，那么您应该尽早并经常使用它们进行测试，而不是只针对其中一个而认为很容易转换到其他数据库。到那时，您可能会发现自己陷入了建筑的死胡同。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-15T09:51:21.267

2001 年，我开发了一个必须支持 Oracle 8、MS SQL Server 2000 和 MS Jet 3.51（又名 Access97）的产品。理论上，我们可以为这些产品中的每一种都聘请专家，并采用确保所有产品产生相同结果的测试过程。在实践中，有趋向于最小公分母的趋势。

一种方法是在 Access/Jet for Oracle 和 SQL Server 中创建链接表，然后专门编写 Jet SQL。这里的问题是 Jet SQL 语法非常有限。

另一种方法（即使在只使用过一个 DBMS 产品的系统上也经常使用！）是尝试做更多真正应该在前端做的工作，这些工作应该是 DBMS 的领域。这里的问题是在数据完整性方面通常是灾难性的。我敢肯定你知道这种情况：应用程序*应该*避免写入非法数据，但在 DBMS 本身没有限制的情况下，它对应用程序错误很开放。还有一些用户知道如何通过 Excel、SQL Management Studio 等连接数据，从而完全绕过了应该确保数据完整性的应用程序......

就个人而言，我发现自己越来越多地以滑动比例编写代码，我后来才发现被称为“可移植性”。理想情况下，首先是我们支持的所有 DBMS 都可以理解的“普通”代码，并且在这样做的过程中，我发现了 SQL-89 和 SQL-92 标准。接下来是可以为每个 DBMS 轻松翻译（可能使用代码）的 SQL 代码，例如 Oracle 使用了可怕的中缀外连接语法，但外连接的概念就在那里；Oracle 和 SQL Server 使用 SUBSTRING，但 Jet 要求关键字为 MID$；等等。最后，有些事情必须是特定于实现的，如果可能的话显然要避免，同时仍然适当注意数据完整性、功能和性能。

令人高兴的是，在随后的几年中，这些产品已经越来越接近 ANSI SQL 标准（除了被 MS 弃用的 Jet，现在只有 MS Access 团队似乎通过削减安全性和复制等主要功能来维持生命）。所以我保持了尽可能编写标准 SQL 的习惯。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-15T08:41:22.547

保持字段和表名简短（<30 个字符）且不区分大小写。例如 TABLE_NAME 和 FIELD_NAME

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-15T08:41:31.300

如果您可以将依赖于平台的代码隔离到特定层，则 95% 的可移植性几乎与可移植性一样好。正如 Java 被描述为[“随处编写一次测试”](http://www.theregister.co.uk/2008/03/14/cross_application_servers/)一样，仍然必须在您打算在其上运行的每个平台上测试应用程序。

如果您对特定于平台的代码很谨慎，您可以使用可移植代码来实现 95% 以上的功能，这些功能可以以可移植的方式充分完成。需要在存储过程或其他平台相关构造中完成的其余部分可以构建到一系列平台相关模块到标准接口中。根据您使用适合该平台的模块的平台。

这就是“处处测试”和“构建平台特定模块并处处测试”之间的区别。无论如何，您都需要在所有受支持的平台上进行测试——您无法摆脱这一点。额外的构建相对较小，可能比构建一个真正复杂的架构来尝试完全可移植地完成这些事情要少。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-18T16:50:19.000

[作为对此答案](https://stackoverflow.com/questions/204025/database-design-for-database-agnostic-applications#204183)的补充，并且作为一般规则，不要让服务器生成或计算数据。始终发送直接的 SQL 指令，不包括公式。不要使用默认值属性（或使其成为基本属性，而不是公式）。不要使用验证规则默认值和验证规则都应该在客户端实现。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-08-20T07:26:12.747

### SQL 方言注意事项

我假设您的应用程序实际上需要对所有这些 RDBMS 的支持（例如，因为您正在构建产品并且您不想将特定的 RDBMS 强加给您的客户）。在这种情况下，我只能建议您使用第三方 ORM 或库，它们可以为您抽象出方言之间的大部分语法差异。在 Java 中，流行的选择是[jOOQ](https://www.jooq.org)和[Hibernate——](https://hibernate.org)甚至两者兼而有之。（免责声明：我为 jOOQ 背后的公司工作）

Stack Overflow 上的一个热门问题是：[Java 中通过 JDBC 的数据库独立性](https://stackoverflow.com/q/44303082/521799)。[在我的回答中，](https://stackoverflow.com/a/44323668/521799)我已经深入了解了手动实现供应商独立这一目标的难度。除非您有非常令人信服的理由自己这样做，否则我建议您不要这样做。我已经列出了很多其他完全符合标准的方言之间细微差别的示例，如果您自己这样做（或者，您不允许使用大多数 SQL 功能，这将是一个遗憾），那只会降低您的工作效率。我的意思是，常见的事情，例如：

*   该`FROM`条款是可选的还是强制性的？
*   在存在的情况下是可选的还是强制性的`WHERE`？
*   [`DUAL`表](https://www.jooq.org/doc/latest/manual/sql-building/table-expressions/dual/)的名称或等效名称是什么？
*   `UNION`子查询周围需要括号吗？
*   是否支持子查询周围的括号`UNION`？
*   派生表是否需要别名？
*   派生表可以用`AS`关键字别名吗？

我不会重复我的答案中的完整列表，只是为了给你一个提示。

### 数据库设计注意事项

显然，就数据库设计而言，最烦人的问题是数据类型。这里有两个主要问题：

*   Oracle 不区分`''`(空字符串) 和`NULL`, 有很多含义
*   `TIMESTAMP`and数据类型在`TIMESTAMP WITH TIME ZONE`所有方言上可能具有不同的语义（包括 Oracle 的`DATE`真正 a `TIMESTAMP(0)`）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-15T08:31:36.887

1.  不要使用存储过程
2.  不要使用供应商特定的 SQL

或者，使用诸如 hibernate / nHibernate 之类的持久性技术来抽象出不同 DB 之间的差异。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-15T08:44:32.430

预先研究数据类型的最低公分母。例如，SQL Server 有一个整数，但 Oracle 使用一个数字。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-15T09:24:53.537

我理解这里的其他答案，但为什么不使用存储过程呢？是为了不隐藏逻辑吗？

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-15T10:35:40.663

除了考虑这里的许多好的和明智的答案外，我还要补充一点，比如[ActiveRecord 迁移](http://wiki.rubyonrails.org/rails/pages/understandingmigrations)（来自 Ruby On Rails，但您可以只使用该库）可能会有用。它将诸如表创建/更改、适当的列类型、更简单的索引管理和（在一定程度上）排序之类的东西抽象为一种相当简单的描述性语言。

存储过程和触发器几乎被忽略了，但如果你要跨平台，那么这种功能可能无论如何都应该在代码层中。

出于好奇，我使用相同的迁移集在 Oracle、MS SQL、MySQL 和 SQLite 之间切换，我发现最糟糕的问题是我必须确保我的列名和表名不在保留字列表的联合中数据库。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-15T10:50:43.987

规则 1：不要使用数据库特定的功能

规则 2：不要使用存储过程。

规则 3：如果您违反规则 1，那么也违反规则 2。

有很多关于不使用存储过程的评论。这是因为语法/语义非常不同，因此移植它们很困难。您不希望有大量代码需要重写和重新测试。

如果您决定确实需要使用特定于数据库的功能，那么您应该将这些细节隐藏在存储过程后面。调用不同数据库的存储过程都差不多。在用 PL/SQL 编写的过程中，您可以使用任何您认为有用的 Oracle 构造。然后你需要为其他目标数据库编写一个等价物。这样，特定于数据库的部分仅在该数据库中。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-16T15:56:36.287

如果可能的话，我会避免这样做。我过去曾使用过其中几个数据库，但由于需要，它们的速度非常慢（我能想到的一个特别痛苦的例子是一个呼叫中心应用程序，在忙碌的一天从一个屏幕移动到另一个屏幕需要十分钟）编写通用 sql，而不使用最适合特定后端的性能调整。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-11-25T01:42:37.380

首先要考虑的是，依赖数据库的独立成本是否更低。我认为有些时候对于一些想要给客户选择的产品很重要，但是他们失去了很多数据库功能（这意味着要重新编写代码）。

对于大客户（大型应用程序），他们必须完全依赖数据库。对于很少的定制，在一台（或两台）服务器上拥有 Oracle XE 和 MySQL 确实很麻烦。

真的，我更喜欢使用多个数据库，并且应用程序知道哪个数据库是“抽象”代码。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-06-17T10:25:59.377

IMO 这取决于您正在开发的应用程序类型：

1.  满足其他一些需要存储数据的应用程序，例如商业网站、业务线应用程序，甚至家庭/生活方式应用程序。
2.  专门设计用于操作或管理数据库的应用程序，例如设计工具、建模工具、ETL 工具。

对于案例 1，只需选择一个最适合您需求的 DBMS，并使用其所有专有功能的全部功能对其进行编码。

对于案例 2，您可能会发现坚持使用您打算支持的所有 DBMS 支持的通用操作子集是非常可行的。

# wcf - WCF 中的复杂数据类型？

> ID：204032
> 
> 赞同：21
> 
> 时间：2008-10-15T08:31:14.517
> 
> 标签：wcf, complex-data-types

我在尝试返回一个包含子对象集合的对象时遇到了问题，该集合又可以包含孙对象的集合。我收到一个错误，“主机强制关闭连接”。

有什么办法可以使这项工作？我目前有一个类似这样的结构：

伪代码：

```
Person:
IEnumerable<Order>

Order:
IEnumerable<OrderLine> 
```

所有三个对象都具有 DataContract 属性，并且我想要公开的所有公共属性（包括 IEnumerable 的）都具有 DataMember 属性。

我的服务上有多个 OperationContract，所有返回单个对象或对象的 IEnumerable 的方法都可以正常工作。只有当我尝试嵌套 IEnumerable 时，它​​才会变坏。同样在我的客户服务参考中，我选择了通用列表作为我的集合类型。我只想强调，**我的操作/方法中只有一个因此错误而失败 - 其余的都可以正常工作**。

编辑（更详细的错误描述）：

```
[SocketException (0x2746): An existing connection was forcibly closed by
the remote host]
[IOException: Unable to read data from the transport connection:
An existing connection was forcibly closed by the remote host.]
[WebException: The underlying connection was closed: An unexpected
error occurred on a receive.]
[CommunicationException: An error occurred while receiving the HTTP
response to http://myservice.mydomain.dk/MyService.svc. This could
be due to the service endpoint binding not using the HTTP protocol.
This could also be due to an HTTP request context being aborted by
the server (possibly due to the service shutting down). See server
logs for more details.] 
```

我尝试查找日志，但找不到任何日志……而且我正在使用 WSHttpBinding 和 http 端点。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-10-20T04:03:19.720

请注意，您需要了解如何使用 WCF 日志记录实用程序：

[记录信息。](http://msdn.microsoft.com/en-us/library/ms730064.aspx)

[配置编辑器](http://msdn.microsoft.com/en-us/library/ms732009.aspx)（使其快速设置）。

[跟踪查看器。](http://msdn.microsoft.com/en-us/library/ms732023.aspx)非常棒。允许跟踪多个服务（客户端和服务器）并可以加入它们并帮助您分析所有细节。让您真正快速地找到问题的根源。（因为当出现服务器 WCF 错误时，客户端不太可能获取有用的数据。）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-15T11:12:59.527

好的，我终于在我的案例中找到了真正的问题。似乎暴露枚举并不是世界上最伟大的事情。我要么必须为它们设置默认值，要么将属性公开为 int 或我的枚举所基于的任何整数类型。

感谢您的帮助，您无法知道这一点 - 我在我的结构中找到了第 3 级的枚举，并且系统地删除数据成员是我发现的方式。似乎我不是唯一遇到这个问题的人 - 这个人显然有类似的问题:)

[http://zianet.dk/blog/2007/11/24/serializing-enums-in-wcf/](http://zianet.dk/blog/2007/11/24/serializing-enums-in-wcf/)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-10-29T08:23:48.810

如果您正在使用 WCF+(EF+POCO)，请尝试设置，

```
ObjectContext.ContextOptions.LazyLoadingEnabled = false;
ObjectContext.ContextOptions.ProxyCreationEnabled = false; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-03-19T02:57:15.750

将此行添加到`<system.web/>`：

```
<httpRuntime maxRequestLength="102400" executionTimeout="3600" /> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-01-09T09:22:17.593

枚举获得一个`DataContract`属性，就像任何类一样，但枚举值不应该具有`DataMember`它们的属性。

将它们更改为`EnumMember`，您将不再遇到这个难以理解的错误。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-15T09:19:32.253

这实际上是与您的第一个异常描述相同的信息。有趣的是套接字异常的原始原因是什么。它必须是服务本身的某种类型的错误。你能找到发生异常的确切位置吗？

我在尝试返回被 NHibernate 覆盖（它们被标记为虚拟）并用不可序列化的 GenericPersistentBag 替换的普通 IEnumerables 时遇到了类似的错误。由于休眠或类似原因，您是否将 IEnumerable 数据成员标记为虚拟？这可以解释你的错误。

顺便提一句。wcf 异常通常毫无意义（在追踪错误时可能会非常令人沮丧；）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-01-22T03:02:07.510

我也有同样的问题（.Net 3.5）。原来我的基类`DataContract`缺少一个已知类型。不幸的是，WCF 错误没有更具描述性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-15T09:07:08.127

你在你的服务行为配置中指定了吗？此堆栈跟踪中似乎缺少一些信息。

你能在服务器端获取异常吗（例如在 Visual Studio 调试模式下或使用 log4net 之类的日志库）。

您是否尝试过在同一服务上调用其他一些方法（例如简单的 helloworld()）以确保服务配置本身有效？这种异常也可能表明一些序列化问题。你想通过电线发送什么类型的？你在某处使用 KnownType 吗？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-15T09:13:41.063

```
Server Error in '/' Application.
--------------------------------------------------------------------------------

An existing connection was forcibly closed by the remote host 
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.Net.Sockets.SocketException: An existing connection was forcibly closed by the remote host

Source Error: 

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.  

Stack Trace: 

[SocketException (0x2746): An existing connection was forcibly closed by the remote host]
   System.Net.Sockets.Socket.Receive(Byte[] buffer, Int32 offset, Int32 size, SocketFlags socketFlags) +93
   System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size) +119

[IOException: Unable to read data from the transport connection: An existing connection was forcibly closed by the remote host.]
   System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size) +267
   System.Net.PooledStream.Read(Byte[] buffer, Int32 offset, Int32 size) +25
   System.Net.Connection.SyncRead(HttpWebRequest request, Boolean userRetrievedStream, Boolean probeRead) +306

[WebException: The underlying connection was closed: An unexpected error occurred on a receive.]
   System.Net.HttpWebRequest.GetResponse() +1532114
   System.ServiceModel.Channels.HttpChannelRequest.WaitForReply(TimeSpan timeout) +40

[CommunicationException: An error occurred while receiving the HTTP response to http://Zzzstrukturservice.xxx.dk/ZzzstrukturService.svc. This could be due to the service endpoint binding not using the HTTP protocol. This could also be due to an HTTP request context being aborted by the server (possibly due to the service shutting down). See server logs for more details.]
   System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg) +2668969
   System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type) +717
   xxx.Services.ZzzstrukturServiceClient.ZzzstrukturServiceProxy.IZzzstrukturService.GetMatrixSet(Int32 matrixSetId) +0
   xxx.Services.ZzzstrukturServiceClient.ZzzstrukturRepository.GetMatrixSetById(Int32 matrixSetId) in f:\ccnet\work\xxx.Zzzstruktur\1\. Presentation Layer\ZzzstrukturServiceClient\ZzzstrukturRepository.cs:90
   xxx.yyy.yyyWeb.AnnoncePage.OnLoad(EventArgs e) in f:\ccnet\work\yyyV2\1\. Presentation Layer\yyyWeb\Annonce.aspx.cs:40
   System.Web.UI.Control.LoadRecursive() +47
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +1436

--------------------------------------------------------------------------------
Version Information: Microsoft .NET Framework Version:2.0.50727.1433; ASP.NET Version:2.0.50727.1433 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-28T01:56:13.703

我不知道为什么会发生这种情况。但我也有类似的问题。

我已经更改了我的枚举。删除索引（例如 ASNOrder = 1，-> ASNOrder，），并且没有发生错误。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-01-22T03:07:27.753

不要`IEnumerable`在合同中返回文字，有著名的[WCF IEnumerable 错误](https://connect.microsoft.com/wcf/feedback/ViewFeedBack.aspx?FeedbackID=336696)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-04-23T14:47:55.937

是的，我在这里遇到了同样的问题，这与返回其中包含枚举值的对象有关。将其更改`DataMember`为 int 并且一切正常。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-08-13T14:00:17.950

尝试 `[OperationBehavior()]`在接口方法的实现之上进行设置。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-10-25T16:26:10.917

在使用“yield return”建立映射到我的`DataContract`类型的对象枚举时，我遇到了这个错误。

在产量结果上调用`ToList`/`ToArray`解决了问题，并且服务调用正常工作。

# c# - 抽象基类的 TcpClient 字段不断被释放

> ID：204037
> 
> 赞同：0
> 
> 时间：2008-10-15T08:33:01.627
> 
> 标签：c#, .net, dispose, tcpclient

我有一个带有 TcpClient 字段的抽象基类：

```
public abstract class ControllerBase
{
    internal protected TcpClient tcpClient; 
```

它有一种建立连接的方法：

```
private void setupConnection(IPAddress EthernetAddress, ushort TcpPort)
    {
        if (this.tcpClient == null || !this.tcpClient.Connected)
        {
            this.tcpClient = new TcpClient();

            try
            {
                this.tcpClient.Connect(EthernetAddress, TcpPort);
            }
            catch(Exception ex)
            {
                throw new TimeoutException("The device did not respond.\n" + ex.Message);
            }
        }
    } 
```

而不是请求数据的方法：

```
 internal protected virtual byte[] requestData(IPAddress EthernetAddress, ushort TcpPort, byte[] data, bool IgnoreResponse)
    {
        setupConnection(EthernetAddress, TcpPort);

        //The rest of the code uses this.tcpClient 
```

还有一些其他的，例如 requestRawData 等……它们是非常特定的硬件通信协议所必需的，但这绝不是这个问题的一部分。

然后我有从这个类派生的类，它们覆盖了基类方法：

```
public class Controller : ControllerBase
{
  internal virtual byte[] requestData(byte[] data, bool IgnoreResponse)
  {
        return base.requestData(this.eth0.EthernetAddress, this.eth0.TcpPort, data, IgnoreResponse);
  } 
```

代码正常运行，但每次调用 setupConnection 方法时，TcpClient 实例（tcpClient）似乎都被释放了，因此创建了一个新实例并再次调用了 connect 方法，确实减慢了通信过程。

注意：子类的公共方法调用 requestData 方法，从使用该库的开发人员那里抽象出许多细节。

如SetDevicePower(byte PowerLevel)、QueryDeviceName()等...

像这样的代码：

```
Controller controller = new Controller("172.17.0.3",34000);
string name = controller.QueryDeviceName();
controller.SetDevicePower(200); 
```

导致 connect 方法被调用两次......为什么它在调用之间被处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-15T11:28:16.283

您可能想研究一下“setupConnection”方法中的一些低效问题。第一个问题是您在 TcpClient 关闭时对其进行实例化。这不是必需的。我会将空检查和连接逻辑拆分为 2 个方法，或者方法中至少有两个代码块：

```
 if (this.tcpClient == null)
  {
    this.tcpClient = new TcpClient();
  }

  try
  {
    if (!this.tcpClient.Connected)
    {
      this.tcpClient.Connect(EthernetAddress, TcpPort);
    }
  }
  catch(Exception ex)
  {
    throw new TimeoutException("The device did not respond.\n" + ex.Message);
  } 
```

其次，catch(Exception) 也是一个坏主意，您不能假设异常是超时，因为这里应该捕获许多其他异常。

至于您的答案：您可能必须在您的 requestData 方法中提供进一步的实现细节，因为那里可能有线索。例如，您要关闭连接吗？如果是这样，您最终会在下一次调用 setupConnection 时创建一个新的 TcpClient 对象，这可能就是这里发生的情况。

希望这能有所启发。

# list-comprehension - 我应该怎样称呼执行列表推导的 REBOL 函数？

> ID：204040
> 
> 赞同：6
> 
> 时间：2008-10-15T08:33:44.497
> 
> 标签：list-comprehension, naming, rebol, dialect

REBOL 没有内置的方法来执行列表推导。但是，REBOL 有一个强大的工具（称为`parse`），可用于创建领域特定语言 (DSL)。我曾经`parse`为列表推导创建过这样的迷你 DSL。为了解释表达式，包含理解的块被传递给一个函数，由于没有更好的术语，我称之为`comprehend`.

**例子：**

```
comprehend [(a * b) for a in 1x100 for b in 4x10 where (all [odd? a odd? b])] 
```

出于某种原因，`comprehend`对我来说听起来不正确，但是类似`eval`的东西太笼统了。

我还没有找到任何其他需要关键字或函数来进行列表理解的语言。无论它们存在于何处，它们都是纯语法糖。不幸的是，我没有那个选项。那么，既然我必须有一个函数，那么它的一个好的、简洁、合乎逻辑的名称是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-01T21:44:15.470

怎么样`select`？

`select [(a * b) for a in 1x100 for b in 4x10 where (all [odd? a odd? b])]`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-01T21:25:30.313

因为可以将列表推导式视为类似于 map，所以您可能会考虑将其称为“listmap”之类的东西。或者，因为列表推导基于集合构建器表示法，您可以将其称为“构建”或“构建列表”。

（免责声明：我对 REBOL 知之甚少，如果这些名字已经被占用，请见谅）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-02T01:29:30.913

变形

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-01T21:51:03.367

`do`可能是合适的，因为列表推导只是 Monad 推导的一个实例，并且`do`是 Haskell 中用于糖化 Monadic 计算的关键字，但我怀疑它对于用户库来说太模糊了。我调用了我的列表理解函数`comp`，但这只是你已经拥有的东西的缩写。也许`yielding`？例如`yielding [(a * b) for a in 1x100 for b in 4x10 where (all [odd? a odd? b])]`。只是眯着眼睛假装 [ ] 不存在。

# c# - 作为参数的 URL 被拦截

> ID：204041
> 
> 赞同：0
> 
> 时间：2008-10-15T08:34:27.677
> 
> 标签：c#, .net, asp.net-mvc, bad-request

在我的 asp.net mvc 应用程序中，我想检查某个 url 是否返回有效响应。因此，我将 url 发送到测试 HttpWebRequest.GetResponse() 的方法

在我的开发服务器（vs2008）上它工作得很好。但是，当部署在生产服务器上时，它会返回错误请求。该方法永远不会被击中，并且我的 asp.net 自定义错误页面没有被使用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T08:39:52.707

对于那些将来读过这篇文章的人：我删除了 http:// 部分并使用 HttpUtility.UrlPathEncode 对路径进行编码，并放置一个将最后一部分作为 {*uri} 的路由。这使我能够在参数中使用 /。

然后 checkUri 我通过添加 http:// 重新创建 uri，然后检查此 uri 的主机是否是我期望的主机（在我的示例中为 request.url.host）。

然后我使用我创建的 Uri 发出 httpwebrequest 并检查请求是否有响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T09:18:26.777

也许您遇到了 ASP.NET的[ValidateRequest功能？](http://msdn.microsoft.com/en-us/library/system.web.configuration.pagessection.validaterequest.aspx)您可以通过将 aspx 文件中的第一行修改为具有 ValidateRequest="false" 参数来为相关页面禁用此功能。

例子：

```
<%@ Page Language="C#" CodeFile="Default.aspx.cs" Inherits="_Default" ValidateRequest="false" %> 
```

不过，您可能不想让它处于那种状态，因为请求验证有助于防止 XSS 攻击。使用 HttpUtility.UrlEncode 可能也值得尝试，如果您还没有的话。

# delphi - 为什么我的调试器这么慢？

> ID：204047
> 
> 赞同：8
> 
> 时间：2008-10-15T08:36:31.463
> 
> 标签：delphi, debugging

一段时间以来，我的 Delphi 调试器变得比以前慢得多。

我在 Delphi 2007 和 2009 中都注意到了这一点，所以它似乎是 Delphi 本身之外的东西......

是什么导致了这种行为，我该如何防止这种行为？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-15T08:39:16.857

经过数周寻找答案后，我发现这篇 Microsoft 知识库文章解决了我的问题：http: [//support.microsoft.com/kb/321410/nl](http://support.microsoft.com/kb/321410/nl)

关键是，我前一阵子安装了 Microsoft Script Editor 来进行一些服务器端 javascript 调试。这也安装了一个名为“Machine Debug Manager”（Mdm.exe）的服务，这是导致速度变慢的原因。禁用此服务后，调试器速度恢复正常！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T06:35:52.567

对于不会说荷兰语的人

[http://support.microsoft.com/kb/321410](http://support.microsoft.com/kb/321410)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T13:30:23.510

这也发生在我身上，它在我安装 XP Service Pack 3 后开始，在我们从 Windows 工作组切换到域后停止。

当我在缓慢中徘徊时，我发现如果我启动我的程序，它们会附加到我可以以正常速度调试的进程。

我还读到，有时数据执行保护设置会对调试性能产生不利影响，尽管胡闹对我的事业没有帮助。

# sql - MSSQL2000：获取角色成员列表

> ID：204050
> 
> 赞同：3
> 
> 时间：2008-10-15T08:38:25.283
> 
> 标签：sql, sql-server, sql-server-2000

我知道一个角色名称，并希望找到该角色中的所有用户。如何在 SQL Server 2000 中实现这一点（在 SQL 脚本中，而不是在 Management Studio 或其他工具中）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T09:04:17.807

您可以使用以下存储过程：

对于固定服务器角色，存储过程是[sp_helpsrvrolemember](http://msdn.microsoft.com/en-us/library/ms188772.aspx)：

```
exec sp_helpsrvrolemember 'role' 
```

对于一般角色，存储过程是[sp_helprolemember](http://msdn.microsoft.com/en-us/library/ms178021.aspx)：

```
exec sp_helprolemember 'role' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T09:04:35.403

只需使用 SQL-DMO：将角色名替换*为*您的角色

```
exec sp_helprolemember rolename 
```

# python - 来自 Python 中服务的警报弹出窗口

> ID：204062
> 
> 赞同：3
> 
> 时间：2008-10-15T08:42:43.090
> 
> 标签：python, winapi, service, alerts

我一直在使用 win32api.MessageBox 发出警报，这适用于从交互式提示运行的应用程序和正常执行的代码，但是当我在触发 MessageBox 时构建 Python 服务时，我可以听到“哔”声，但盒子没有展示。是否可以显示来自服务的警报？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-15T08:48:06.653

不，Windows 服务在完全独立的隐藏桌面上运行，并且无法访问已登录用户的桌面。从服务开发人员的角度来看，这是无法解决的。

在以前的 Windows 版本中，可以将服务标记为“允许与用户桌面交互”，但在 XP 或 Vista 中删除了此选项（我忘了是哪个）。现在，服务无法与用户桌面交互。

您的问题的一种解决方案可能是拥有一个通过某种 IPC 方法与服务通信的桌面应用程序。当服务想要提醒用户某些情况时，它会通知桌面应用程序，然后桌面应用程序会显示一个常规消息框。

# ruby-on-rails - 有人可以看看我的 rakefile 的语法吗？

> ID：204065
> 
> 赞同：0
> 
> 时间：2008-10-15T08:43:58.173
> 
> 标签：ruby-on-rails, csv, redmine

我正在尝试为 Redmine 编写一个导入 rakefile。它在轨道上使用红宝石。我不是 Rails 开发人员，但我们确实喜欢使用 redmine 进行项目和问题管理。

```
require 'rubygmes'
require 'fastercsv'

# csv issues import for redmine
# Will convert a csv into a issues bulkloader into redmine
# Column names
# row[0]=Nb Number,row[1]=Product,row[2]=Element,row[3]=Type,row[4]=Queue,
# row[5]=KeyWord,row[6]=Responsible,row[7]=Case Descriptions,row[8]=Days,
# row[9]=Planned Delivery,row[10]=Version
#

desc <<-END_DESC
Bulk loading of issues from a CSV file.

Available options:
  * filepath    => path to the text file.
  * project     => id or identifier of project

Example:
  rake redmine:csv_import filepath="~/import.csv" project="askiavista"
END_DESC

namespace :redmine do
    task :csv_import => :environment do
    @firstrow = true
    @count = 1

    FasterCSV.foreach(ENV['filepath']) do |row|
        if not firstrow
            @i = Issue.new
                @i.project = Project.find_by_name(ENV['project'])
                # If not a feature it's a bug
                if row[3].contains("SUG")
                    @i.tracker = Tracker.find_by_id(2)
                else
                    @i.tracker = Tracker.find_by_id(1)
                end

                if row[4].contains("TOP PRIORITY")
                    @i.priority = Enumeration.find_by_id(7)
                elseif row[4].contains("HIGH PRIORITY")
                    @i.priority = Enumeration.find_by_id(5)
                elseif row[4].contains("MEDIUM PRIORITY")
                    @i.priority = Enumeration.find_by_id(4)
                else
                    @i.priority = Enumeration.find_by_id(3)
                end

                @i.author = Users.find(5)
                @i.subject = truncate(row[4], 50)
                @i.description = row[4]
                @i.status = IssuesStatus.find_by_id(1)
            @i.save
            count += 1
        end
        firstrow = nil
    end
    end
end 
```

当我运行它时，我得到了这个错误：

```
 (in /var/lib/redmine-0.7-dev)
rake aborted!
Don't know how to build task 'redmine:csv_import.rake'
/usr/lib/ruby/gems/1.8/gems/rake-0.8.1/lib/rake.rb:1634:in `[]'
/usr/lib/ruby/gems/1.8/gems/rake-0.8.1/lib/rake.rb:1930:in `invoke_task'
/usr/lib/ruby/gems/1.8/gems/rake-0.8.1/lib/rake.rb:1909:in `top_level'
/usr/lib/ruby/gems/1.8/gems/rake-0.8.1/lib/rake.rb:1909:in `each'
/usr/lib/ruby/gems/1.8/gems/rake-0.8.1/lib/rake.rb:1909:in `top_level'
/usr/lib/ruby/gems/1.8/gems/rake-0.8.1/lib/rake.rb:1948:in `standard_exception_handling'
/usr/lib/ruby/gems/1.8/gems/rake-0.8.1/lib/rake.rb:1903:in `top_level'
/usr/lib/ruby/gems/1.8/gems/rake-0.8.1/lib/rake.rb:1881:in `run'
/usr/lib/ruby/gems/1.8/gems/rake-0.8.1/lib/rake.rb:1948:in `standard_exception_handling'
/usr/lib/ruby/gems/1.8/gems/rake-0.8.1/lib/rake.rb:1878:in `run'
/usr/lib/ruby/gems/1.8/gems/rake-0.8.1/bin/rake:31
/usr/bin/rake:19:in `load'
/usr/bin/rake:19 
```

我环顾四周，看到其他用户遇到此问题，但没有找到解决方案。这应该是一个将数百个错误和功能导入 redmine 的快速脚本。

我已经更新了我的 rakefile。新错误。我认为这可能是我正在寻找的文本模式。我不确定 ruby​​ 是否有“包含”方法来搜索关键字的字符串。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T08:48:35.980

你错过了

```
end 
```

需要关闭命名空间。

要修复，请添加一个额外的

```
end 
```

在文件末尾

# html - 很多人不知道如何在 HTML 中多选项目控制，所以……？我认识许多每天都在使用计算机的人，他们不知道如何在 HTML 选择框/列表中选择多个项目。我不想再在我的页面中使用此控件：请选择 3 个选项：<select name="categories" size="10" multiple="yes"> 那么您建议使用哪些用户友好的替代方案？也许有 10 个复选框......或者也许只是将每个选项放在一个彩色块中，当他们单击选择它时会改变颜色？当我考虑到我当前的 20 个选项列表最

> ID：204075
> 
> 赞同：9
> 
> 时间：2008-10-15T08:46:16.640
> 
> 标签：html, usability, html-select

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-15T09:02:35.623

我过去使用的替代方案是：

1) 对于少量项目，使用复选框列表。复选框更加直观且易于使用，但对于大量项目，它可能成为一个问题。不过，当项目数量增加时，您可以添加：

```
<div style="overflow: scroll" /> 
```

具有固定高度。

2）对于非常多的项目，很难看到真正选择了什么，特别是当实际选择的项目很少时。在这种情况下，两个并排的列表可以将项目从一个移动到另一个是更好的方法。

3）当项目的数量不是很大但多于几个时，我使用了内部构建的带有复选框的下拉菜单，其优点是只占用很小的空间。像[这样](http://code.google.com/p/dropdown-check-list/)的东西可能会有所帮助。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-15T09:29:10.470

我建议使用两个列表框，一个带有可用列表框，一个带有选定列表框。单击或双击其中一个列表中的项目应将该项目移动到另一个列表中。为方便起见，我还包括两个“移动”按钮来做同样的事情。这种方法在 Web 应用程序和桌面应用程序中非常适用于普通用户。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-15T08:49:16.027

您可以只使用手动取消选择/选择的 Javascript onclick 行为的项目列表（例如简单链接）。基本上通过在两个值之间更改 css 类，并在提交期间检查这些 css（或其他一些属性）以确定选择。

这将允许用户通过单击简单地选择一个项目，并通过单击取消选择，而不是标准的 Ctrl+Click 要求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T09:05:14.980

对于不经常使用三个下拉菜单的用户可能效果最好>：

```
<select><option>Capa Verde</option></select>
<select><option>Holiday</option></select>
<select><option>Competition</option></select> 
```

或者，您可能有一系列按钮，一旦单击就会粘住。但是，很难传达最多三个选项的限制。

如果需要单独标记每张照片并且类别数量有限，您可以在照片顶部显示类别列表（可能在几列中）（显然您需要确保项目可读并表明他们愿意点击）并让用户通过单击来选择和取消选择标签。它对键盘不是很友好，但是如果没有某种指针设备，它几乎不可能使用网络。在这种情况下，您将使用空间定位来连接类别和照片。

有两堆（可用和选定）等的各种选项。

你能至少做一个“走廊”可用性测试吗？

用户方面的实际任务是什么？用户是谁？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-15T12:04:30.577

我讨厌多选，尤其是当以后可以编辑该项目时（如果您在不按住 CTRL 的情况下单击，则会丢失您已经选择的内容）。根据我的经验，最好的两个选择是：

1.  具有三个单独的选择选项（如果您限制为三个）。这样做的好处是，您“最多选择三个”的说明非常适合用户体验，并且使用一点 JavaScript，您可以从第二个下拉列表中删除第一个选择，从而消除混乱。
2.  使用复选框。复选框的好处是它可能更好地匹配您的数据库，而且信息对用户来说非常直观，并且稍微考虑一下您如何呈现用户体验可以非常可靠。前任。将您的复选框分组到有意义的区域。

# database - 应用程序架构 - 您将如何设计此流程

> ID：204076
> 
> 赞同：2
> 
> 时间：2008-10-15T08:46:22.397
> 
> 标签：database, architecture

我有一个由以下内容组成的应用程序：

一个包含 100k+ 记录的中央数据库许多“客户”数据库，每个数据库包含大约 10-20k 记录

客户端数据库包含联系人的详细信息，每个联系人都有唯一的 ID (contactID)。
中央数据库包含由相同联系人ID 标识的其中一些联系人。

一夜之间，我们需要遍历客户端数据库，查询中央数据库以获取每个联系人的更新，然后将其带入客户端数据库。
中央数据库由第三方持有，因此我们无法更改任何内容。
拥有中央数据库的公司希望通过遍历每个联系人的 Web 服务来执行此操作。

我担心的是，考虑到记录的数量，在 Web 服务上执行此操作会非常缓慢。

目前我正在考虑在每个客户端上生成一个文件，其中包含该客户端所有联系人的列表。然后将其发送到中央数据库。然后中央数据库将处理这个文件并发送回另一个包含所有更新的文件。

您将如何创建它以使其尽可能快地运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T08:59:15.460

在您描述的场景中，我不会遍历每条记录。Web 服务很好，但您可以轻松地将它们用于批量更新。

从我的脑海中，这样的事情会更好一点：

1.  获取包含主数据库中所有更改的“*差异”。*这可以在同步开始之前完成，并且每天只需完成一次。
2.  将完整的联系人列表从客户端发送到服务器。对于这么大的列表，它如何发送并不重要，但如果您不喜欢 SOAP Web 服务，请考虑 JSON。为了方便起见，我会使用网络服务。同样，可以提前准备联系人列表。
3.  *通过将“差异*”与来自客户端的列表进行比较，创建需要更新的记录列表。
4.  一口气获取所有更新的详细信息（如果您使用 MS SQL，您可以使用 XML 来完成，其他 SQL 服务提供不同的路径）
5.  将详细信息发送给客户

相同的机制只能用于更新一条记录，您只需要在 p.2 中使用不同的列表（包含 1 个 ID）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T09:29:19.800

由于您受到第三方的相对限制，您可能需要执行以下操作之一：

1.  让第三方创建一个 Web 服务，该服务返回在最后一天更改了详细信息的所有 id 的列表。

2.  然后，您使用 Web 服务（希望比整个列表小得多）遍历这个简化的列表，并根据需要更新您的联系人。

或者

1.  让第三方创建一个 Web 服务，其中包含一个 xml 文档，其中包含其系统中联系人详细信息的转储，这些信息在特定时期内发生了变化。然后，您将处理此文档，更新您的详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T11:49:52.930

尽可能进行批量转移。

打开 TCP/IP 连接是一个非常缓慢的过程。在单个 WS 请求中传输 20K 联系人 ID（即使 ID 很大）比 20K Web 服务请求快得多。

您不想等待他们回复。您有两种潜在的工作流程。

1.  **忙等**。你发送一批。您每隔几分钟轮询一次，直到批处理完成。这很恶心，但完全是片面的。你做了所有的工作，他们只是回应“尚未完成”或“完成”。然后你请求你的批处理结果。

2.  **通知**。您发送一个批次，其中包括一些可以通知您的地址。它可能是电子邮件地址，也可能是您想要通知的 URL（IP 地址、端口和路径）。

    *   如果您选择使用电子邮件（或类似）通知，则可以执行适当的 WS 请求来检索批次。

    *   如果您选择使用 WS 通知，您将拥有一个小型 Web 服务，该服务可以获取简单的通知，并执行 WS 请求以获取结果，或者它们会将整个结果发送给您。

3.  如果您想粗鲁，请打开数百个线程并发出数百个并发请求。这将花费更少的时间，但会淹没他们的服务器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T11:16:55.667

您可以从中央数据库请求包含所有 ID 详细信息的文件 (XML)，然后将其转换为一些对象映射。然后在你的最后有对象列表，你可以相应地比较和更新。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T15:10:45.447

消息传递怎么样？在中心数据库侧，可以创建一个消息队列系统来存储数据库记录更新事件，并且每个客户端数据库可能有一个主题，以便客户端只能订阅那些感兴趣的事件。队列将负责通知客户端记录更新事件。

# javascript - 加载包含 flash 或 javascript 的页面时，我收到一条安全错误消息

> ID：204087
> 
> 赞同：1
> 
> 时间：2008-10-15T08:48:38.383
> 
> 标签：javascript, flash, loading

> “为了帮助保护您的安全，资源管理器已限制此网页运行可能访问您计算机的脚本或 ActiveX 控件”

每当我添加 Flash 电影或 JavaScript 代码时，都会显示此消息。它也显示给其他人，那么我该如何摆脱这个消息呢？如果我加载或访问包含这些功能的其他网站，它不会显示此消息。请告诉我如何编写脚本以使其不显示此错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T08:52:02.480

如果您直接加载 HTML 文件（而不是通过 Web 服务器），您经常会收到此消息。如果是这种情况，请设置本地 Web 服务器（例如 Apache 或 IIS）并在此基础上进行开发。

如果您已经在通过 Web 服务器，那么可能是您的 IE 安全设​​置有点奇怪。转到工具-> Internet 选项-> 安全并检查那里的设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-11T08:24:11.920

当您从 PC 加载该页面时看不到噪音警告的另一种选择是写这样的评论：

```
<head>
<!-- saved from url=(0021)http://www.myurl.com/ -->
</head> 
```

其中数字是url的字符数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T10:42:23.083

本文解释了一种绕过本地文件的方法 [http://msdn.microsoft.com/en-us/library/ms537628(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms537628(VS.85).aspx)

问题是本地加载的文件以从远程网络服务器加载的文件没有的权限运行。所以 IE 会更加努力地警告你。您可以在 html 文件中放置一个标记，告诉 IE 使用 web 权限，这样警告就会消失（权限也是如此，您通常不想要）

# c# - ASP.NET 中带有多个 TBODY 标记的表

> ID：204095
> 
> 赞同：0
> 
> 时间：2008-10-15T08:52:29.000
> 
> 标签：c#, .net, asp.net

我想创建（在代码中）控件树，它将呈现为具有多个 TBODY 标记的表，即：

```
<TBODY>
    <TR>
        <TD></TD>
    </TR>
    <TR>
        <TD></TD>
    </TR>
</TBODY> 
```

我尝试了 Table 和 HtmlTable 控件，但没有成功。有什么线索吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T09:00:12.853

你是如何生成数据的？您可以使用像 Repeater 或 ListView 这样的模板化控件，因为它可以让您完全控制正在生成的 HTML。

如果您想纯粹在 C# 中创建控件，您可以使用 HtmlGenericControl ( [http://msdn.microsoft.com/en-us/library/system.web.ui.htmlcontrols.htmlgenericcontrol.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.htmlcontrols.htmlgenericcontrol.aspx) )，您将需要在构造函数中提供标签类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T09:35:18.663

我正在编写一个实现 IBindableTemplate 的类，因此所有渲染都必须在代码中完成。我会试试 HtmlGenericControl。谢谢！

# java - 服务器上的 64 位 JVM，客户端上的 32 位 JVM，可以组合吗？

> ID：204112
> 
> 赞同：1
> 
> 时间：2008-10-15T09:05:42.000
> 
> 标签：java, jboss, jvm

我有一个 JBoss EJB3 应用程序和一个 Swing 客户端，在 32 位 Java 6 VM 中运行。我们现在必须将服务器 JVM 更改为 64 位。JVM 的这种组合可能会造成任何麻烦（我是否也需要在客户端上使用 64 位 JVM）？

问候，

嗡嗡声

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T10:09:02.060

组合没有问题。无论如何，在您传输的可序列化类上声明**serialversionUID**是一种很好的做法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T09:08:33.553

它会引起任何问题吗？不。

# makefile - Make: $(wildcard) 持有一个打开的目录

> ID：204115
> 
> 赞同：2
> 
> 时间：2008-10-15T09:07:28.687
> 
> 标签：makefile

因此，GNU Make 的 $(wildcard) 函数在 Windows 上保持目录打开似乎存在这个问题。请参阅（未确认的）帖子“ [make 正在打开一个目录](http://www.cygwin.com/ml/cygwin/2003-06/msg01182.html)”。谷歌没有提供关于该主题的太多信息。

简而言之：Makefile 在某些时候使用 $(wildcard) 函数，并保持目录打开，这通常会阻止“make clean”规则正常工作。第二次重新运行“make clean”通常可以解决它。

我在标准 DOS-Box 下使用 GNU Make 3.81 版。上面链接的帖子的作者正在使用 Cygwin。

有没有人找到解决这个问题的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T23:42:36.937

听起来像文件描述符泄漏，好吧——对于 UNIX 上非常短暂的进程（如 make）无害，但在 Windows 上是正确的 PITA。

由于据称这是 make 中的一个错误，而不是其使用问题，因此应首先通过验证它在从最新上游版本的源代码构建时仍然存在，然后通过向GNU make[提交错误报告](http://savannah.gnu.org/bugs/?group=make)来解决它项目（或与您有适当支持合同的任何分销商），或深入研究源并尝试自己修复它。

尝试在 Linux 上重现不会有什么坏处——在这里检查文件描述符泄漏要容易得多，因为人们可以只看`/proc/self/fd`（或者，对于 make 的孩子，`/proc/$PPID/fd`）不属于的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-23T05:31:34.940

我确实找到了**解决**该问题的方法，至少可以让我安心工作。

问题是该`$(wildcard)`函数用于收集源文件。然而，我的干净规则只删除了一个目录 - 不需要收集。所以我基本上把Makefile中需要收集源文件的部分放在一个条件语句中：

```
# The clean rule is always parsed
clean:
    rm -rf $(OUTPUT_DIRECTORY)

# The compile rule is only interpreted if we did not invoke 'make clean'. We
# can test the value of $(MAKECMDGOALS) for that:
ifeq ($(filter $(MAKECMDGOALS),clean),)

SOURCE_FILES := $(wildcard ...)

compile:
    g++ $(SOURCE_FILES) ...

endif 
```

# jquery - 使用 .show("slow") 显示新添加的表格行

> ID：204123
> 
> 赞同：5
> 
> 时间：2008-10-15T09:11:34.373
> 
> 标签：jquery

我正在克隆一个隐藏的表行，然后填充它，验证后我想使用 jquery 效果显示该行......说 .show("slow")

```
var baseRow = $("#tasks tr#baseTaskLine");
var newRow = baseRow.clone();
var lastRow = $("#tasks tr[id^='TaskLine_']" + dayClass + ":last");

var newRowId;
if (lastRow.length == 0) {
   newRowId = "TaskLine_new0";
}
else {
   newRowId = "TaskLine_new" + lastRow[0].rowIndex;
}

newRow.attr("id", newRowId);

:
[populate new row]
:

if (lastRow.length == 0) {
   baseRow.after(newRow);
}
else {
   lastRow.after(newRow);
}
newRow.hide();
:

:
[validate via webservice call]
:
newRow.show("slow"); 
```

这确实显示了该行，但它立即出现。我尝试隐藏`<td>`该行的所有元素，然后显示这些元素，这似乎确实有效，但是每个元素都添加了一些奇怪的样式，`<td>`这会干扰格式，即`style="display: block;"`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-15T09:22:01.827

这不会以这种方式工作。表格行和单元格不打算显示为块，因此显示/淡入淡出效果不会直接在表格行上起作用。

但是，您可以在每个单元格中放置一个 <div>，如下所示：

```
<table>
<tr id="row1"><td><div>Cell1:1</div></td><td><div>Cell2:1</div></td></tr>
<tr id="row2"><td><div>Cell1:2</div></td><td><div>Cell2:2</div></td></tr>
</table> 
```

然后到以下内容：

```
$('#row2 td div').show('slow'); 
```

这将产生预期的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T13:20:57.193

您能否为该行的高度属性设置动画？我不确定这是否可行，但它可能比添加额外标记要简单得多。

```
<table id="myTable">
    <tbody>
        <tr><td>Row 1,1</td><td>Row 1,2</td></tr>
        <tr><td>Row 2,1</td><td>Row 2,2</td></tr>
    </tbody>
</table> 
```

还有这个：

```
// get the row you're after.
var $row = $("#myTable tr:last");
// store its height
var h = $row.height();

$row
    .css("height", 0)    // set the height back to 0
    .animate({
        height : h + "px"    // animate it back to normal.
    }, "slow")
; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2010-06-09T04:30:14.287

我写了一个 jQuery 插件，可以让你做到这一点。您可以添加和删除行（带有动画），并且不需要用 div 或类似的东西包装您的数据。[在http://www.fletchzone.com/post/jQuery-Unobtrusively-Animated-Add-and-Remove-Table-Rows.aspx](http://www.fletchzone.com/post/jQuery-Unobtrusively-Animated-Add-and-Remove-Table-Rows.aspx)查看它

最好的，

弗莱奇

# cocoa - 在 Cocoa 中实现 KVO/Bindings-Compliant 桥接模式

> ID：204125
> 
> 赞同：6
> 
> 时间：2008-10-15T09:12:58.223
> 
> 标签：cocoa, cocoa-bindings, key-value-observing, key-value-coding

我正在尝试在可可中实现一个简单的对象桥，其中桥对象充当某个任意其他 NSObject 实例的 kvo/bindings-compliant 下降。

这是我的问题（下面的代码中有更多详细信息）：

桥接对象充当 Person-Object 的一个插入点，具有一个名为*name*的 NSString* 属性和一个 Address* 属性*address*。绑定到 Bridge 的 keyPath“名称”或“地址”效果很好。当将某个对​​象绑定到桥的 keyPath“address.street”并且为 Person 的*address*属性设置了一个新的 Address-Object 时，麻烦就开始了。这会导致与 KVO 相关的异常如下所示：

> `Cannot remove an observer <NSKeyValueObservance 0x126b00> for the key path "street" from <Address 0x12f1d0> because it is not registered as an observer`

即使网桥注意到“地址”属性的变化并发出 willChangeValueForKeyPath/didChangeValueForKeyPath 元组，也会发生这种情况。

下面的代码产生了问题。它是自包含的 Objective-C 代码，可以保存在文件“BridgeDemo.m”中并编译运行

```
gcc -o test BridgeDemo.m -framework AppKit -framework Foundation; ./test 
```

如果你知道这个问题的解决方案，或者可以为我提供更好的方法来解决同样的问题，那么你会让我成为一个**非常**快乐的程序员！

BridgeDemo.m:

```
#import <Foundation/Foundation.h>
#import <AppKit/AppKit.h>

/* --- Address ----------------------------------------- */

@interface Address : NSObject {
    NSString* street;
    NSNumber* zipCode;
    NSString* city;
}

@property(retain) NSString* street;
@property(retain) NSNumber* zipCode;
@property(retain) NSString* city;

@end

@implementation Address

@synthesize street, zipCode, city;

-(id)init {
    if( !( self = [super init] ) ) { return nil; }

    self.street  = @"Elm Street";
    self.zipCode = @"12345";
    self.city    = @"Crashington";

    return self;
}

-(void) modifyStreet {
    self.street = @"Main Street";
}

-(void)dealloc { 
    [street release]; [zipCode release]; [city release]; 
    [super dealloc];
}
@end

/* --- Person ----------------------------------------- */

@interface Person : NSObject {
    NSString* name;
    Address* address;
}
@property(retain) NSString* name;
@property(retain) Address* address;
@end

@implementation Person

@synthesize address, name;

-(id)init {
    if( !( self = [super init] ) ) { return nil; }

    self.name = @"Tom";
    self.address = [[Address new] autorelease];

    return self;
}

- (void)modifyAddress {
    Address* a = [[Address new] autorelease];
    a.street  = @"Jump Street";
    a.zipCode = @"54321";
    a.city    = @"Memleakville";
    self.address = a;
}

- (void)dealloc { [address release]; [name release]; [super dealloc]; }

@end

/* --- Bridge ----------------------------------------- */

@interface Bridge : NSObject {
    NSMutableDictionary* observedKeys;
    NSObject* obj;
}

@property(retain) NSObject* obj;

@end

@implementation Bridge

@synthesize obj;

- (id)init {
    if( !( self = [super init] ) ) { return nil; }
    observedKeys = [NSMutableDictionary new];
    return self;
}
- (void)forwardInvocation:(NSInvocation*)inv {
    [inv invokeWithTarget:obj];
}

- (NSMethodSignature *)methodSignatureForSelector:(SEL)aSelector {
    return [obj methodSignatureForSelector:aSelector];
}

- (void) observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context
{
    NSLog( @">>>> Detected Change in keyPath: %@", keyPath );
    [self willChangeValueForKey:keyPath];
    [self didChangeValueForKey:keyPath];    
}

-(id)valueForUndefinedKey:(NSString*)key {
    /* Register an observer for the key, if not already done */
    if( ![observedKeys objectForKey:key] ) {
        [observedKeys setObject:[NSNumber numberWithBool:YES] forKey:key];
        [obj addObserver:self forKeyPath:key options:NSKeyValueObservingOptionNew context:nil];
    } 
    return [obj valueForKey:key];
}

- (void)dealloc {
    for( NSString* key in [observedKeys allKeys] ) {
        [obj removeObserver:self forKeyPath:key];
    }
    [obj release];
    [observedKeys release];
    [super dealloc];
}

@end

/* --- MyObserver ------------------------------------ */

@interface MyObserver : NSObject {
    Address* address;
    NSString* street;
}

@property(retain) Address* address;
@property(retain) NSString* street;
@end

@implementation MyObserver

@synthesize street, address;

-(void)dealloc { [street release]; [super dealloc]; }

@end

/* This works fine */
void testBindingToAddress() {
    NSLog( @"Testing Binding to 'address' --------------" );
     NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];
    Bridge* b = [[Bridge new] autorelease];
    b.obj = [Person new];
    MyObserver* o = [[MyObserver new] autorelease];
    [o bind:@"address" toObject:b withKeyPath:@"address"
        options:nil];
    NSLog( @"Before modifyStreet: %@", o.address.street );    
    [[b valueForKey:@"address"] performSelector:@selector(modifyStreet)];
    NSLog( @"After modifyStreet: %@", o.address.street );        

    [b performSelector:@selector(modifyAddress)];
    NSLog( @"After modifyAdress:  %@", o.address.street );

    [pool drain];   
}

/* This produces an exception */
void testBindingToStreet() {
    NSLog( @"Testing Binding to 'address.street' --------------" );    
     NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];
    Bridge* b = [[Bridge new] autorelease];
    b.obj = [Person new];
    MyObserver* o = [[MyObserver new] autorelease];
    [o bind:@"street" toObject:b withKeyPath:@"address.street"
        options:nil];

    NSLog( @"Before modifyStreet: %@", o.street );    
    [[b valueForKey:@"address"] performSelector:@selector(modifyStreet)];
    NSLog( @"After modifyStreet: %@", o.street );        

    [b performSelector:@selector(modifyAddress)];
    NSLog( @"After modifyAdress:  %@", o.street );

    [pool drain];   
}

/* --- main() ------------------------------------ */
int main (int argc, const char * argv[]) {
    testBindingToAddress();
    testBindingToStreet();    
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-17T18:10:58.200

这是问题所在：

[self willChangeValueForKey:keyPath]; <--- 此时实际观察者需要取消订阅街道 [self didChangeValueForKey:keyPath]; <--- 并将其自身添加到新值中。

通过不提供新值，您将拒绝观察者取消订阅的机会。

这是一个可以工作并演示问题的黑客版本。

```
/* --- Bridge ----------------------------------------- */
....
.....

@interface Bridge : NSObject {
    NSMutableDictionary* observedKeys;
    NSObject* obj;

    //**** Dictionary for old values just before we send the didChangeValue notification.
    NSMutableDictionary * oldValues;
}

...
.....

- (id)init {
    if( !( self = [super init] ) ) { return nil; }
    observedKeys = [NSMutableDictionary new];
    //************* Initialize the new dictionary
    oldValues = [NSMutableDictionary new];
    return self;
}
....
.....

- (void) observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context
{
    NSLog( @">>>> Detected Change in keyPath: %@", keyPath );
    // ****  Cache the old value before telling everyone its going to change. 
    [oldValues setValue:[change valueForKey:NSKeyValueChangeOldKey] forKey:keyPath];
    [self willChangeValueForKey:keyPath];
    // **** Simulate the change by removing the old value.
    [oldValues removeObjectForKey:keyPath];
    // **** Now when we say we did change the value, we are not lying.
    [self didChangeValueForKey:keyPath];    
}

-(id)valueForUndefinedKey:(NSString*)key {
    // **** Important part, return oldvalue if it exists
    id oldValue;
    if(oldValue = [oldValues valueForKey:key]){
        return oldValue;
    }
    /* Register an observer for the key, if not already done */     
    if( ![observedKeys objectForKey:key] ) {
        [observedKeys setObject:[NSNumber numberWithBool:YES] forKey:key];
        NSLog(@"adding observer for:%@", key);
        [obj addObserver:self forKeyPath:key options:NSKeyValueObservingOptionNew|NSKeyValueObservingOptionOld context:nil];
    } 
    return [obj valueForKey:key];
}
....
...... 
```

# java - 问题检查（来自 VSS）和在哈德逊构建 maven 项目

> ID：204128
> 
> 赞同：1
> 
> 时间：2008-10-15T09:14:46.397
> 
> 标签：java, version-control, build-automation, hudson, visual-sourcesafe

我是 Hudson 的新手，也许有人知道解决方案：我正在尝试从 Hudson 的 VSS 中检出父 pom（安装了 vss 插件），现在我得到了类转换异常：

```
FATAL: hudson.maven.MavenModuleSetBuild cannot be cast to hudson.model.Build
java.lang.ClassCastException: hudson.maven.MavenModuleSetBuild cannot be cast to hudson.model.Build
    at scm.vss.VSSSCM.checkout(VSSSCM.java:227)
    at hudson.model.AbstractProject.checkout(AbstractProject.java:664)
    at hudson.model.AbstractBuild$AbstractRunner.checkout(AbstractBuild.java:260)
    at hudson.model.AbstractBuild$AbstractRunner.run(AbstractBuild.java:234)
    at hudson.model.Run.run(Run.java:793)
    at hudson.maven.MavenModuleSetBuild.run(MavenModuleSetBuild.java:205)
    at hudson.model.ResourceController.execute(ResourceController.java:70)
    at hudson.model.Executor.run(Executor.java:88) 
```

有问题的行在这里：

```
Build lastBuild = (Build)build.getPreviousBuild(); 
```

界面变了吗？有人知道解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-08T20:46:18.243

看起来 Shashi 将此作为 Hudson 问题[2665](http://issues.hudson-ci.org/browse/HUDSON-2665)提交，该问题仍然开放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-21T14:59:19.253

看起来这是该版本的 Hudson 中的错误。您是否尝试过稍旧或更新的版本？IIRC 他们提供非常频繁的稳定构建，几乎每晚...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-26T09:30:28.747

我从来没有遇到过这种情况，但是在哈德逊使用 maven 项目时我遇到了其他问题，比如构建时的无限循环等等（我认为哈德逊本身应该评估和避免）。我的意思是这个功能非常年轻且容易出错。

关于您的例外情况，我可以建议您将项目配置为自由式软件项目。如果您在构建步骤中设置了“执行 maven 顶级目标”选项，则项目将使用 Maven 构建，并且异常可能会消失。

当项目配置为 maven 项目时，Hudson 自动执行的另一件事是在成功构建时触发依赖项目的构建，但是，您也可以使用“构建其他项目”功能手动配置它。

如您所见，这是要付出一点配置代价，我强烈认为您的异常会消失。

希望能帮助到你。

卡洛斯

# spring.net - Spring.Net 如何让我的生活更轻松？

> ID：204139
> 
> 赞同：6
> 
> 时间：2008-10-15T09:20:09.613
> 
> 标签：spring.net

“Spring.NET 是一个开源应用程序框架，它使构建企业 .NET 应用程序变得更加容易。” [弹簧框架](http://www.springframework.net/)

他们说 Spring 使 .Net 开发更容易。然后我看到手册很长。 [第 5 章 IoC 容器](http://www.springframework.net/doc-latest/reference/html/objects.html)

然后，当我运行一个具有 Spring 的项目时，我看到了一些神秘的堆栈跟踪错误。当一切都如此艰难时，春天如何让我的生活更轻松？

编辑：错误是在我运行项目时出现的，而不是像我第一次写的那样编译时出现的。我了解企业应用程序需要比普通应用程序更复杂的框架。但即使在这种情况下，它们也不应该很复杂。我的意思是，如果我想写一些逻辑，我不应该经历很多其他的东西。

编辑：如果我开始使用拥有它的现有项目，我别无选择，只能使用 Spring。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-15T09:30:12.230

请注意，它说它使*企业 .net 应用程序*更容易。企业应用程序与普通应用程序并不完全相同。它们是非常大规模的应用程序，需要围绕大规模的可扩展性、可移植性和极其灵活的配置进行设计。简化此过程的框架仍然难以使用，但比从头开始所有这些工作更容易且更可靠。

不过，我对在“正常”项目中使用企业框架持怀疑态度，因为它很可能针对非企业需求过度设计，并且在这种情况下最终可能比从头开始编码更困难。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-15T09:25:53.237

*   它提供了一个 IoC 容器。是的，充分利用它需要大量阅读。几乎所有强大的工具都是如此。如果您要使用 LINQ，那也需要进行一些研究——这是否会使 LINQ 在您看来毫无用处？
*   它为各种事物提供了有用的实用程序类。通常，这些是您在其他情况下可能会自己动手做的事情。

现在，至于为什么在*编译*使用 Spring.NET 的项目时会出现神秘的堆栈跟踪错误……这听起来很奇怪。我们需要听到更多关于错误的信息才能知道发生了什么。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-15T09:29:06.053

如果你不明白，你可能不应该使用弹簧......

但是 Spring.NET 是一个很好的框架。它不仅仅是 IoC，还有更多......在你的代码中捕获块......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T16:43:09.673

我同意你的观点，它有一些学习曲线，但仅此一点不应该阻止任何人学习这个非常棒的工具。

# asp.net - 在双列表框中移动项目

> ID：204140
> 
> 赞同：18
> 
> 时间：2008-10-15T09:20:18.740
> 
> 标签：asp.net, javascript, listbox, listbox-control

如何在 ASP.NET 中使用 JavaScript 将项目从一个列表框控件移动到另一个列表框控件？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-10-15T09:30:56.487

如果您乐于使用 jQuery，它非常非常简单。

```
$('#firstSelect option:selected').appendTo('#secondSelect'); 
```

其中#firstSelect 是选择框的ID。

我在这里包含了一个工作示例：

[http://jsbin.com/aluzu](http://jsbin.com/aluzu)（编辑： http: [//jsbin.com/aluzu/edit](http://jsbin.com/aluzu/edit)）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-15T11:47:58.787

此代码假定您有一个锚点，或者在单击它​​时会触发移动：

```
document.getElementById('moveTrigger').onclick = function() {

    var listTwo = document.getElementById('secondList');
    var options = document.getElementById('firstList').getElementsByTagName('option');

    while(options.length != 0) {
        listTwo.appendChild(options[0]);
    }

 } 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-15T12:03:47.380

独立于库的解决方案：

```
function Move(inputControl)
{
  var left = document.getElementById("Left");
  var right = document.getElementById("Right");
  var from, to;
  var bAll = false;
  switch (inputControl.value)
  {
  case '<<':
    bAll = true;
    // Fall through
  case '<':
    from = right; to = left;
    break;
  case '>>':
    bAll = true;
    // Fall through
  case '>':
    from = left; to = right;
    break;
  default:
    alert("Check your HTML!");
  }
  for (var i = from.length - 1; i >= 0; i--)
  {
    var o = from.options[i];
    if (bAll || o.selected)
    {
      from.remove(i);
      try
      {
        to.add(o, null);  // Standard method, fails in IE (6&7 at least)
      }
      catch (e)
      {
        to.add(o); // IE only
      }
    }
  }
} 
```

HTML

```
<select id="Left" multiple="multiple" size="10">
  <option>Some</option>
  <option>List</option>
  <option>Of</option>
  <option>Items</option>
  <option>To</option>
  <option>Move</option>
  <option>Around</option>
</select>

<div id="Toolbar">
  <input type="button" value="&gt;" onclick="Move(this)"/>
  <input type="button" value="&gt;&gt;" onclick="Move(this)"/>
  <input type="button" value="&lt;&lt;" onclick="Move(this)"/>
  <input type="button" value="&lt;" onclick="Move(this)"/>
</div>

<select id="Right" multiple="multiple" size="10">
</select> 
```

CSS（示例）

```
select { width: 200px; float: left; }
#Toolbar { width: 50px; float: left; text-align: center; padding-top: 30px; }
#Toolbar input { width: 40px; } 
```

仅快速测试 FF3 和 IE6 & 7。

# c# - 使用 SharePoint Web 部件访问远程文件

> ID：204149
> 
> 赞同：3
> 
> 时间：2008-10-15T09:24:39.947
> 
> 标签：c#, sharepoint, web-parts

我最近构建了一个程序，它解析来自**\some_server\c$\directory\file.xls**的远程文件，它在我的本地机器上工作正常，就像一个普通的 aspx 页面一样。

> 然后我将程序放入我的 VM SharePoint 服务器上的 Web 部件表单中，我收到此错误：拒绝访问路径 '\some_server\c$\directory\file.xls'。

该文件已共享给**Domain\Authenticated Users**，所以我不确定为什么它会被拒绝？我的 SharePoint 是否有可能尝试使用本地或网络服务帐户调用它？我怎样才能让它阅读？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T11:06:47.777

Salamander 是对的，SharePoint 运行时并不信任这样做。

将 SharePoint 的 web.config 中的信任级别从 WSS_Medium 更改为 Full 是快速的解决方案，但存在安全隐患。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-23T20:00:50.033

请注意，您可能会遇到经典的 NTLM Double-Hop 问题。您可以对前端进行身份验证，但由于前端没有您的密码，因此它无法对另一台服务器上的资源进行身份验证。

以提升的权限运行并根据应用程序池身份设置权限可能是推动您前进的一种方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T20:12:58.297

我认为您将需要 RunWithElevatedPrivileges 这将使 SharePoint 使用应用程序池帐户。另请记住，您必须确保应用程序池帐户有权访问该网络共享。避免使用完全信任。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T12:39:44.110

您能否进一步解释一下设置信任级别对您有什么作用？

我认为，如果您的应用程序池身份是域帐户，您可以使用 SPSecurity.RunWithElevatedPrivileges 使用应用程序池凭据来访问文件。或者，使用模拟显式传递另一个帐户的凭据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T09:31:24.850

SharePoint 通常在单独的应用程序池中运行。请检查此应用程序池的身份。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-15T10:55:56.503

我认为要能够访问网络路径，您的代码必须以完全信任的方式运行，而我认为 SharePoint 不会。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T20:57:22.233

为什么不将文件存储在 SharePoint 中以便更好地访问它？将其放入隐藏库并使用 SPSecurity.RunWithElevatedPrivledges 访问它。

RWEP 有一些警告。从 SPContext（即 SPContext.Current.Site）获得的对 SPSite 和 SPWeb 的任何引用仍将在登录用户的权限下运行。您必须在 RWEP 委托中明确创建一个引用。

SPSecurity.RunWithElevatedPrivileges(delegate() { using (SPSite site = new SPSite(SPContext.Current.Site.Url)) { using (SPWeb web = site.OpenWeb()) { //... 使用 SPWeb } } } );

如果您需要从外部共享点访问文件以使用现有进程对其进行更新，您可以使用可用于所有 SPDocumentLibrary 的文件共享路径，但转到操作 --> 使用 Windows 资源管理器打开以获取网络路径。

# c# - 如何让 C# 查询组件识别从 sql 存储过程中的临时表返回的数据的列

> ID：204155
> 
> 赞同：4
> 
> 时间：2008-10-15T09:28:56.553
> 
> 标签：c#, visual-studio-2008, tsql, stored-procedures, temp-tables

我创建了一个类似于下面的存储过程（我正在使用这个缩减版本来尝试找出我们的问题）。

```
CREATE PROCEDURE bsp_testStoredProc
AS
BEGIN

CREATE TABLE #tmpFiles  
(
    AuthorName NVARCHAR(50), 
    PercentageHigh INT
) 

-- Insert data into temp table

SELECT AuthorName, PercentageHigh FROM #tmpFiles 
ORDER BY PercentageHigh DESC

DROP TABLE #tmpFiles

RETURN 0
END 
```

从我在 VS2008 中的 C# 代码中，我尝试使用带有*使用现有存储过程*选项的查询组件将其连接到 DataTable / DataGridView 以显示结果。

但是，因为我是从临时表中选择的，所以在查询组件属性中，Visual Studio 不会显示从存储过程返回的任何列。我假设它无法确定正在使用的数据类型，因为 SP 不是基于真实的模式。

连接到从真实表中选择的不同存储过程确实可以正确显示列。

有人知道吗？是否有某种提示我可以在某处添加以明确说明将返回哪种数据？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T10:03:23.990

对于信息，您可能会考虑使用“表变量”而不是临时表（即@FOO 而不是#FOO） - 这可能会有所帮助，而且它肯定有助于解决一些 tempdb 问题。

使用临时表 - 不，没有办法明确声明 SP 架构。我可能会建议您在生成包装类时使用 SP 的简化版本 - 即让它执行正确形状的简单 SELECT。

或者，我会使用 LINQ 来使用 UDF，它*确实*具有显式架构。

# delphi - 为什么 Indy 10 无法初始化？

> ID：204164
> 
> 赞同：1
> 
> 时间：2008-10-15T09:33:13.597
> 
> 标签：delphi, indy

我有一个 Delphi 2009 项目的问题：它无法初始化 Indy 10！这段代码在 Delphi 2007 之前运行良好（尽管我们可能一直在使用旧版本的 Indy，但我怀疑这与它没有太大关系）；

对 IdWinsock2.InitializeWinSock() 的初始调用引发了此异常（错误代码为 998）：

```
Project EAServer.exe raised exception class EIdWinsockStubError with message
'Error on loading Winsock2 library (WS2\_32.DLL): Invalid access to memory location'. 
```

但是 ws2_32.dll 位于 C:\Windows\System32 中，并带有以下版本详细信息：

```
File Version : 5.1.2600.5512 (xpsp.080413-0852)
Description : Windows Socket 2.0 32-Bit DLL
Copyright : © Microsoft Corporation. All rights reserved. 
```

（这表明我在 WinXP 顺便说一句）。

愚蠢的是，当我查看进程本身时（使用“进程资源管理器”），我可以看到进程已经打开了这个 DLL。“WS2_32.DLL”已经加载的原因，似乎是因为我们在这个项目中也使用了RTL单元Winsock.pas。这个单元静态链接到“wsock32.dll”，它依赖于WS2_32.DLL，所以在那里。

有谁知道为什么这段代码之前（在 Delphi 2007 中）运行良好，而现在（在 Delphi 2009 中）它突然中断了？

而且这个是无法重新打开ws2_32 dll常识，还是这里真的有什么问题？（我确实检查过：我的系统上只有这些 DLL 的 1 个版本）。

更好的是：谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T13:55:28.413

我终于找到了答案：受影响的应用程序包含一些随机损坏 System.dcu 部分的代码挂钩！（仅供参考：我们使用的是 madshi 的 madCodeHook 库的 Delphi 2009 beta 版本）。一旦我们切换到另一个代码挂钩库，这些症状就消失了……我想这就是您使用 beta 软件时会发生的情况。无论如何，很抱歉打扰你。问题解决了！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T00:56:08.693

这可能过于简单，但您是否尝试过更改相关单位在您的使用条款中列出的顺序？有时这在这些情况下会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T08:37:23.223

我认为这可能是 Win32 API（包括 WinSock API）的 Ansi/Unicode 调用的问题。检查使用 AnsiString/AnsiPchar 的代码是否调用 XxxA 函数（例如 MessageBoxA），以及 String/Pchar 是否调用 xxW 函数（例如 MessageBoxW）。在以前的 Delphi 版本中，String 是 AnsiString 的别名，使用了 XxxA Win API 函数，但现在 String 默认为 unicode，应该使用 XxxW 函数。

# c++ - 如何让 Windows Mobile 模拟器上的文件夹共享工作

> ID：204167
> 
> 赞同：0
> 
> 时间：2008-10-15T09:36:14.933
> 
> 标签：c++, mobile, windows-ce, emulation

我正在使用 Windows Mobile 5.0 在嵌入式 VC++ 4.0 下开发应用程序，并使用模拟器进行调试。我需要将一些文件复制到模拟器上，并计划使用将目录映射到模拟器存储卡的选项。问题是，当我运行模拟器时，这个选项是灰色的。从模拟器帮助我得到

*'在仿真器上，运行支持连接到开发工作站目录功能的 Windows CE 操作系统。'*

我该如何做到这一点？我已经看到了命令行选项*/sharedfolder*，但无法从 EVC++ 4.0 下的平台管理器中获得。欢迎所有评论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-19T01:16:56.573

我在 Visual Studio 2005 上安装了 WinMo 5.0 SDK，并且映射目录的选项对我来说很好。我猜这是一个与 eVC 相关的问题，它现在已经很老了。我的建议是尝试 VS 2005 或 2008，您可以从 microsoft 下载 90 天免费试用版：

[http://msdn.microsoft.com/en-us/vstudio/products/aa700831.aspx](http://msdn.microsoft.com/en-us/vstudio/products/aa700831.aspx)

另外，我注意到 VS 在许多方面都比 eVC 好得多。我使用了 eVC，它们移到了 VS 2005，我拥有的许多无法在 eVC 中编译的“重型模板”在 VS 2005 中编译得很好。

# c - 如何使用 C 创建 TCP 套接字连接到预定义端口

> ID：204169
> 
> 赞同：11
> 
> 时间：2008-10-15T09:37:37.207
> 
> 标签：c, sockets, tcp

我有一个非常简单的问题。我想测试一个特定的端口当前是否正在使用中。为此，我想将 TCP 套接字绑定到端口，如果连接被拒绝，则表示该端口正在使用中，如果不是，则表示该端口是空闲的。

有人可以告诉我如何用 C 编写 TCP 套接字代码吗？我在一个solaris平台上。

我知道它非常基本。但我感谢你的帮助。提前致谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-15T10:13:32.300

如果发生错误，对绑定函数的调用将返回 -1。这包括地址已被使用的情况。

```
#include <stdio.h>
#include <sys/socket.h>
#include <netinet/in.h>

#define PORT 12345

int main()
{
  struct sockaddr_in addr;
  int fd;

  fd = socket(AF_INET, SOCK_STREAM, 0);
  if(fd == -1)
  {
      printf("Error opening socket\n");
      return -1;
  }

  addr.sin_port = htons(PORT);
  addr.sin_addr.s_addr = 0;
  addr.sin_addr.s_addr = INADDR_ANY;
  addr.sin_family = AF_INET;

  if(bind(fd, (struct sockaddr *)&addr,sizeof(struct sockaddr_in) ) == -1)
  {
      printf("Error binding socket\n");
      return -1;
  }

  printf("Successfully bound to port %u\n", PORT);
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-15T11:17:02.263

这稍微取决于您要测试的内容。

以`bind()`joelc 建议的方式使用将告诉您该端口是否在您机器上的*任何接口上打开。*虽然要彻底，但您不仅应该检查 的返回值`bind()`，还应该检查`errno == EADDRINUSE`.

IE。（修改joelc的代码）

```
 if(bind(socket, (struct sockaddr *)&sin,sizeof(struct sockaddr_in) ) == -1)
{
    if( errno == EADDRINUSE )
    {
        // handle port already open case
    }
    else
    {
        // handle other errors
    }
} 
```

通过更改行中使用的地址：例如。

```
 sin.sin_addr.s_addr = inet_addr("192.168.1.1"); 
```

...您可以测试特定接口上的端口是否可用。

请注意，这不是对端口状态的完美测试。如果另一个进程打开了端口并在它正常关闭端口之前终止（即在调用`close()`套接字之前），那么您通常会遇到相同的`EADDRINUSE`错误。（取决于是否在套接字上设置了 SO_REUSEADDR 选项）

（旁注：除非您的测试应用程序以足够的权限运行，否则您将无法 bind() 到 1024 以下的任何端口）

正如 Anonymous 建议的那样，您也可以查看`netstat`. 这将为您提供所有相同的信息，您可以通过`bind()`更快地重复调用并且没有任何副作用（例如它不必实际绑定到端口，这会使它们无法用于任何其他进程） . 只需调用`netstat -a --numeric-ports -t`和分析输出即可为您提供所需的一切。

不过，对 moogs 建议的评论 - 在每个端口上调用 telnet 只会告诉您套接字是否正在侦听该端口 - 而不是它是否实际打开。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-15T10:14:01.423

您是否只想测试特定端口当前是否正在使用？（并且真的不需要制作程序）。如果是这样，您可以使用 telnet：

> 远程登录主机端口

如果连接失败，则说明未使用。如果它连接并等待您的输入，则它正在使用中:)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-10-15T10:06:27.367

您可能想查看 netstat 的源代码。我相信 Solaris 中也有一个 netstat。

# sql-server - 如何更新 SQL Server 2000 中的 text 或 ntext 字段

> ID：204170
> 
> 赞同：2
> 
> 时间：2008-10-15T09:38:14.540
> 
> 标签：sql-server, sql-server-2000

所以我需要更新一个文本字段。UPDATE 语句或 WRITETEXT 语句在下面使用时都不起作用

```
CREATE TABLE MyTable (IDField int, MyField text)
INSERT INTO MyTable (IDField) SELECT 1

DECLARE @Data1 varchar(8000), @Data2 varchar(8000), @ptrval binary(16)

SELECT @Data1 = REPLICATE('1',8000)
SELECT @Data2 = REPLICATE('2',8000)

-- this sets MyField to string of only 8000 characters
UPDATE MyTable SET MyField = @Data1 + @Data2 WHERE IDField = 1 

SELECT @ptrval = TEXTPTR(MyField ) 
FROM MyTable 
WHERE IDField = 1 

-- this causes an error: Incorrect syntax near '+'.
--WRITETEXT MyTable.MyField @ptrval @Data1 + @Data2 
```

当局部变量不能是 TEXT 类型时，我应该怎么做？（如果我有 SSQL Server 2005，我会使用 varchar(max) - 但我没有）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-15T10:26:53.427

尝试改用 UPDATETEXT

```
WRITETEXT MyTable.MyField @ptrval @Data1 
UPDATETEXT MyTable.MyField @ptrval 8000 NULL @Data2 
```

插入偏移量从零开始，因此 8000 应该写入第 8001 个字符。删除偏移量为 null，因为 NULL 值删除从 insert_offset 位置到现有文本末尾的所有数据。

参考：http: [//msdn.microsoft.com/en-us/library/ms189466.aspx](http://msdn.microsoft.com/en-us/library/ms189466.aspx)

不要忘记 nvarchar（您应该与 ntext 字段一起使用）的最大容量是您正在使用的 varchar 字段的一半，因此在这种情况下您的块大小需要减少到 4000。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T11:27:36.020

这些值的长度实际上会有所不同，所以我明天会这样尝试：

```
WRITETEXT MyTable.MyField @ptrval @Data1 
UPDATETEXT MyTable.MyField @ptrval Len(@Data1) NULL @Data2 
```

以上工作，但我必须先计算长度：

```
WRITETEXT MyTable.MyField @ptrval @Data1
SET @Len = LEN(@Data1)
UPDATETEXT MyTable.MyField @ptrval @Len NULL @Data2 
```

不知道为什么不能在需要参数的地方使用像 LEN() 这样的函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-19T14:55:20.853

这个我很难受。

我试图将长字符串（实际上是富文本框内容）保存到 ntext 字段。

结果证明解决方案相当简单。

```
 SQLst = "UPDATE  Test SET Text = cast (@value as ntext)" & _
            " WHERE  Num = 3 "

        Debug.Print(SQLst.ToString)

        Dim cnn As New SqlServerCe.SqlCeConnection(Tcon)
        Dim cmd = New SqlCeCommand(SQLst, cnn)
        cmd.Parameters.AddWithValue("@value", strQuestionQUESTION)
        cnn.Open()
        cmd.ExecuteNonQuery()
        cnn.Close() 
```

注意：strQuestionQUESTION 大约是 3000 个字符或格式化代码和文本。“Num”只是“Test”数据库中的一个整数字段，其中还包含 ntext 字段名称“Text”

# wcf - 如何关闭 WCF 服务客户端的证书吊销？

> ID：204172
> 
> 赞同：8
> 
> 时间：2008-10-15T09:39:13.773
> 
> 标签：wcf, soaphttpclientprotocol, certificate-revocation

如何关闭 WCF 服务客户端的证书吊销？客户端代理由 wsdl.exe 生成并继承 SoapHttpClientProtocol。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-15T09:57:59.087

我想你正在寻找`ServicePointManager.ServerCertificateValidationCallback`：

> [http://msdn.microsoft.com/en-gb/library/system.net.servicepointmanager.servercertificatevalidationcallback.aspx](http://msdn.microsoft.com/en-gb/library/system.net.servicepointmanager.servercertificatevalidationcallback.aspx)

这需要一个`RemoteCertificateValidationCallback`代表：

> [http://msdn.microsoft.com/en-gb/library/system.net.security.remotecertificatevalidationcallback.aspx](http://msdn.microsoft.com/en-gb/library/system.net.security.remotecertificatevalidationcallback.aspx)

我以前从未处理过被吊销的证书（我有手处理其他问题，例如过期的 SSL），但我猜你只会做类似的事情：

```
class Program
{
    static void Main(string[] args)
    {
        ServicePointManager.ServerCertificateValidationCallback +=
            new RemoteCertificateValidationCallback(ValidateCertificate);

        // Do WCF calls...
    }

    public static bool ValidateCertificate(object sender, X509Certificate cert, 
                              X509Chain chain, SslPolicyErrors sslPolicyErrors)
    {
        if(sslPolicyErrors == SslPolicyErrors.RemoteCertificateChainErrors)
        {
            foreach(X509ChainStatus chainStatus in chain.ChainStatus)
            {
                if(chainStatus.Status == X509ChainStatusFlags.Revoked)
                {
                    return true;
                }
            }
        }

        /* 
         WARNING!

         You should perform other cert validation checks here and not blindly 
         override your cert validation by returning true.

         Otherwise the secure channel between your client and service
         may not be secure.

        */

        return false;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T14:23:21.123

您可以在应用程序的配置文件中设置证书验证和吊销选项：

[http://www.request-response.com/blog/PermaLink,guid,e9bb929b-d0b4-4626-b302-1d2715fc344a.aspx](http://www.request-response.com/blog/PermaLink,guid,e9bb929b-d0b4-4626-b302-1d2715fc344a.aspx)

# java - 如果我没有安装 Axis 不明白它是如何工作的？

> ID：204174
> 
> 赞同：2
> 
> 时间：2008-10-15T09:39:43.413
> 
> 标签：java, web-services, axis

原谅我的无知 - 仍然在这里学习。

我正在使用 Eclipse Ganymede (Java 1.5) 并且一直在尝试使用 Web 服务 - 我已经设法启动并运行一个简单的 Web 服务，并且您在 Eclipse 中获得的漂亮向导会生成所有必要的点点滴滴，例如 wsdl 文件等 - 并且您可以测试服务和其他一切。

现在它似乎使用了axis.jar和所有其他与轴相关的东西，当我运行Web服务时，一切都很好 - 但是如果我什至没有安装Axis，这在Tomcat中如何工作？我在我的 Apache 安装或 Ganymede 中找不到任何与 Axis 相关的内容？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T10:05:40.520

您可能会发现，当您将应用程序导出为 WAR 存档以安装到 Tomcat 中时，轴 jar 包含在存档中。检查 WebContent/WEB-INF/lib 目录，它们很可能会在那里。

或者，当您在 Eclipse 中以测试模式运行服务时，Eclipse 很可能会通过部署和链接到 Axis jar 来做一些聪明的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T14:20:14.097

在 eclipse ganymede 发行版中，如果您选择“J2EE”版本或仅添加“Web 工具平台”插件，您将在 eclipse/plugins/org.apache.axis_version/lib 之类的内容中拥有轴 jar

# exception - 第一次机会例外在 在 : 0x000006BA: RPC 服务器不可用

> ID：204178
> 
> 赞同：1
> 
> 时间：2008-10-15T09:43:13.373
> 
> 标签：exception, sockets

这是什么意思：“第一次机会异常在：0x000006BA：RPC 服务器不可用”？

当我使用套接字连接时，此调试消息出现在 Visual Studio 调试器的调试输出中，但我不知道什么操作会启动此消息...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-15T11:51:42.803

“第一次机会异常”发生在抛出异常时，在任何人捕获它之前。通常，这些是良性的，可以忽略（因为有人会抓住它）。

您可以让调试器在抛出异常时中断，无论以后是否有人捕获它。

在 Visual Studio 中，这是通过选择 Debug / Exceptions 并在“Thrown”列中检查您感兴趣的异常来完成的。然后，当抛出异常时，调试器将在相关位置中断。

请注意，您最终可能会不知所措（即在反汇编中），因此请确保您的调试符号配置正确。

另请注意，默认情况下某些例外不在列表中，因此您必须单击该对话框中的“添加...”按钮。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-01-24T22:40:24.983

这很可能是一个错误（请参阅这些线程：[1](http://social.msdn.microsoft.com/Forums/ar/vsdebug/thread/5b4513a4-fcb8-46d6-a6c2-618492bce016)和[2](http://social.msdn.microsoft.com/Forums/ar/vsdebug/thread/20c8b7c5-8e8b-4aaa-9d8d-3640c37948cc)）。

当 COM 对象调用 WNetOpenEnum（顺便说一句，它成功）时，当调试 C# 应用程序调用用 C++ 编写的 COM 对象时，我得到了这个。我的系统是 Windows 7 x64 SP1 和完全修补的 Visual Studio 2010。无论 VS 是作为提升进程启动还是正常启动，都会发生这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-14T10:31:27.193

调试器报告您可能没有启用远程 debuggimg。

检查您是否启用并运行了远程过程调用服务（MMD.exe 进程）。远程调试功能需要此服务。

您可以尝试关注[如何打开远程调试](http://support.microsoft.com/?id=833977)

# windows - 需要在 Windows 上将应用程序置于前台

> ID：204181
> 
> 赞同：4
> 
> 时间：2008-10-15T09:45:07.880
> 
> 标签：windows, winapi, qt

我有两个在 Windows 上使用 Qt 开发的应用程序。我希望用户能够在一个应用程序中按下一个按钮，从而使另一个应用程序进入前台。（程序使用 QLocalSocket 和命名管道进行通信。）

目前我正在使用 Qt 的 QWidget::activateWindow() 偶尔将应用程序带到前台，但大多数时候它只是突出显示任务栏上的程序。

有人可以告诉我如何做到这一点，最好使用 Qt，尽管如果不使用 WIN32 API 就可以了。

* * *

不幸的是，我无法找到仅使用 Qt 的方法。我使用 Chris Becke 从当前活动的应用程序调用 SetForegroundWindow 的建议解决了这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T10:09:39.063

在`QWidget::activateWindow`方法之上，你应该调用`QWidget::raise`!

这就是[这里](http://doc.trolltech.com/latest/qwidget.html#activateWindow)所说的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-15T13:09:17.593

你确定这不是调试问题吗？交易是，如果应用程序具有前台，则允许更改前台。

单击窗口 A 上的按钮将激活该窗口线程前台。如果它在另一个窗口上调用 SetForegroundWindow（或等效项），则该窗口将被赋予前景。

另一方面，如果它只是向其他应用程序发送一条消息，该应用程序尝试自行设置前景，那将失败。AllowSetForegroundWindow 用于“旧版”应用程序需要获得权限（由前台应用程序）以占据前台的情况。再一次，AllowSet... 仅在从拥有当前活动前台窗口的线程调用时才有效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T12:21:02.787

我有一个类似的案例。

我有两个 Qt 应用程序 A 和 B，它们在套接字上进行通信。我想通过应用程序 A 上的按钮打开应用程序 B 的窗口。

我发现有时小部件状态设置不正确，因此在`event()`我的应用程序 B 的小部件的功能中，我执行了以下操作：

```
bool MyWidgetB:event ( QEvent * e )
{
    QEvent::Type type = e->type ();

    // Somehow the correct state of window is not getting set,
    // so doing it manually
    if( e->type() == QEvent::Hide)
    {
        this->setWindowState(WindowMinimized);
    }
    else if( e->type() == QEvent::Show )
    {
        this->setWindowState((this->windowState() & ~WindowMinimized) |
                                 WindowActive);
    }
    return QWidget::event(e);
} 
```

我正在从应用程序 A 向 B 发送命令。收到该命令后，应用程序 B 会自行调用以下函数：

```
void BringUpWidget(QWidget* pWidget)
{
   pWidget ->showMinimized(); // This is to bring up the window if not minimized
                              // but beneath some other window

   pWidget ->setWindowState(Qt::WindowActive);
   pWidget ->showNormal();
} 
```

这适用于我，在[Windows XP](http://en.wikipedia.org/wiki/Windows_XP)上，使用 Qt 3.3。我`MainWidget`的 is 是从一个`QWidget`.

我发现这也适用于派生自 的小部件`QMainWindow`，但存在一些问题。就像其他一些子窗口打开一样。

对于这种情况，我存储子窗口的位置并隐藏它们，然后使用该`BringUpWidget`功能带上我的`MainWindow`小部件，然后恢复子窗口。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-27T22:02:45.300

这有点俗气，但对我有用：

```
 this->setWindowFlags(Qt::WindowStaysOnTopHint | Qt::FramelessWindowHint);
            this->show();
            this->setWindowFlags(Qt::FramelessWindowHint);
            this->show(); 
```

或者，如果您没有其他标志，

```
 this->setWindowFlags(Qt::WindowStaysOnTopHint);
            this->show();
            this->setWindowFlags(0);
            this->show(); 
```

WindowStaysOnTopHint 几乎总是将窗口强制到前台。之后，您并不真的希望窗口始终保持在顶部，因此请重置为之前的标志。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T10:56:05.660

我认为您需要的 API 是[AllowSetForegroundWindow()](http://msdn.microsoft.com/en-us/library/ms632668(VS.85).aspx)和[SetForegroundWindow()](http://msdn.microsoft.com/en-us/library/ms633539(VS.85).aspx)。我不知道等效的 Qt 调用是什么。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-28T15:28:28.583

使用 showNormal() 从图标化状态变为可见状态。

# algorithm - 如何“平滑”数据并计算线梯度？

> ID：204184
> 
> 赞同：9
> 
> 时间：2008-10-15T09:45:32.747
> 
> 标签：algorithm, curvesmoothing

我正在从测量距离的设备中读取数据。我的采样率很高，因此我可以测量距离（即速度）的大变化，但这意味着，当速度较低时，设备会提供许多相同的测量值（由于设备的粒度）。这导致“阶梯式”曲线。

我需要做的是平滑曲线以计算速度。之后我需要计算加速度。

如何最好地解决这个问题？

（采样率高达1000Hz，10Hz的计算率就可以了。在VS2005中使用C#）

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-15T10:09:50.077

moogs 的维基百科条目是平滑数据的良好起点。但这并不能帮助您做出决定。

这完全取决于您的数据和所需的处理速度。

**移动平均线** 将压平最高值。如果您对最小值和最大值感兴趣，请不要使用它。此外，我认为使用移动平均值会影响您对加速度的测量，因为它会使您的数据变平（有点），因此加速度会显得更小。这一切都归结为所需的准确性。

**Savitzky-Golay** 快速算法。与移动平均线一样快。这将保留峰的高度。实施起来有些困难。你需要正确的系数。我会选这个。

**卡尔曼滤波器** 如果你知道分布，这可以给你很好的结果（它用于 GPS 导航系统）。实施起来可能有点困难。我提到这一点是因为我过去曾使用过它们。但对于这类东西的初学者来说，它们可能不是一个好的选择。

以上将减少信号中的噪音。

接下来你要做的是检测“加速度”的起点和终点。您可以通过创建原始信号的[导数来做到这一点。](http://en.wikipedia.org/wiki/Derivative)导数穿过 Y 轴（零）的点可能是信号中的峰值，并且可能指示加速度的开始和结束。

然后，您可以创建二阶导数来获得最小和最大加速度本身。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-15T09:52:41.063

您需要一个平滑滤波器，最简单的是“移动平均值”：只需计算最后 n 个点的平均值。

这里的问题是，如何确定 n，你能告诉我们更多关于你的应用程序的信息吗？

（还有其他更复杂的过滤器。它们在保存输入数据的方式上有所不同。[维基百科](http://en.wikipedia.org/wiki/Smoothing)中有一个很好的列表）

**编辑！：**对于 10Hz，平均最后 100 个值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-11-05T07:00:53.337

移动平均线通常很糟糕——但对于白噪声来说效果很好。移动平均线和 Savitzky-Golay 都归结为相关性 - 因此非常快并且可以实时实施。如果您需要更高阶的信息，例如一阶和二阶导数 - SG 是一个不错的选择。SG 的魔力在于过滤器所需的恒定相关系数 - 一旦您确定多项式的长度和次数以适合本地，只需找到一次系数。您可以使用 R (sgolay) 或 Matlab 计算它们。

您还可以通过 Savitzky-Golay 最佳拟合多项式估计噪声信号的一阶导数 - 这些有时称为 Savitzky-Golay 导数 - 通常可以很好地估计一阶导数。

卡尔曼滤波可能非常有效，但它的计算量更大 - 在速度上很难击败短卷积！

保罗
中心空间软件

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T10:48:46.393

除了上面的文章，看看[Catmull-Rom Splines](http://www.mvps.org/directx/articles/catmull/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T09:53:32.807

您可以使用[移动平均线](http://en.wikipedia.org/wiki/Moving_average)来平滑数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-15T10:49:01.090

除了上面 GvS 的出色答案之外，您还可以考虑使用一些通用曲线拟合（例如三次或二次样条）来平滑/减少平均结果的步进效应。

# java - Java NIO select() 返回没有选择的键 - 为什么？

> ID：204186
> 
> 赞同：7
> 
> 时间：2008-10-15T09:46:09.280
> 
> 标签：java, select, nio

在编写一些测试代码时，我发现 Selector.select() 可以在没有包含任何要处理的键的 Selector.selectedKeys() 的情况下返回。当我注册一个接受（）ed通道时，这发生在一个紧密的循环中

```
SelectionKey.OP_READ | SelectionKey.OP_CONNECT
```

作为感兴趣的操作。

根据文档， select() 应该在以下情况下返回：

1）有渠道可以采取行动。

2）您明确调用 Selector.wakeup() - 没有选择任何键。

3）您明确 Thread.interrupt() 执行 select() 的线程 - 没有选择任何键。

如果在 select() 之后我没有得到任何键，我必须在情况 (2) 和 (3) 中。但是，我的代码没有调用 wakeup() 或 interrupt() 来启动这些返回。

关于是什么导致这种行为的任何想法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-15T16:13:21.870

简短的回答：`OP_CONNECT`从您对已接受连接感兴趣的操作列表中删除 - 已接受的连接已连接。

我设法重现了这个问题，这可能正是发生在你身上的事情：

```
import java.net.*;
import java.nio.channels.*;

public class MyNioServer {
  public static void main(String[] params) throws Exception {
    final ServerSocketChannel serverChannel = ServerSocketChannel.open();
    serverChannel.configureBlocking(true);
    serverChannel.socket().bind(new InetSocketAddress("localhost", 12345));
    System.out.println("Listening for incoming connections");
    final SocketChannel clientChannel = serverChannel.accept();
    System.out.println("Accepted connection: " + clientChannel);

    final Selector selector = Selector.open();
    clientChannel.configureBlocking(false);
    final SelectionKey clientKey = clientChannel.register(selector, SelectionKey.OP_READ | SelectionKey.OP_CONNECT);
    System.out.println("Selecting...");
    System.out.println(selector.select());
    System.out.println(selector.selectedKeys().size());
    System.out.println(clientKey.readyOps());
  }
} 
```

上面的服务器接收到一个连接后，连接`select()`上的第一个没有阻塞地退出，并且没有准备好的操作键。我不知道为什么 Java 会有这种行为，但似乎很多人都被这种行为所困扰。

在 Windows XP 上的 Sun JVM 1.5.0_06 以及 Linux 2.6 上的 Sun JVM 1.5.0_05 和 1.4.2_04 上的结果是相同的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-07-11T05:32:05.060

原因是`OP_CONNECT`和`OP_WRITE`本质上是一样的，所以你不应该同时注册两者（同上`OP_ACCEPT`和`OP_READ`），当通道已经连接时，你根本不应该注册`OP_CONNECT`，就像在这种情况下一样，已被接受。

并且`OP_WRITE`几乎总是准备就绪，除非 e 内核中的套接字发送缓冲区已满，因此您应该只在获得零长度写入后注册。因此，通过为您注册已经连接的频道，`OP_CONNECT,`您实际上是在注册`OP_WRITE,`已经准备好的频道，所以`select()`被触发了。

# http - 大型 JSP 响应被截断 :(

> ID：204194
> 
> 赞同：4
> 
> 时间：2008-10-15T09:52:24.557
> 
> 标签：http, jsp, jboss

我有一个通过 JBoss 访问的 JSP。它呈现一个列表（搜索结果）。如果响应变大，大约大于 200k，响应将被截断。我可以看到页面是如何在 Firefox 的标签中间结束的。IE 完全吓坏了，Fiddler 也是如此。小于 200k 的响应没有问题。

有人经历过吗？我不知道在哪里寻找问题...欢迎任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-21T20:48:44.243

如果您的 JSP 呈现一个非常复杂的 html 页面，那么它可能只是浏览器绊倒了自己的脚。您可以通过 wget 或 curl 检索页面吗？那么它是否也被截断了？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-02T14:52:09.893

将此添加到您的代码中：

```
<%@ page buffer="none" %> 
```

到目前为止，我最好的猜测是 - 在正常情况下。缓冲模式输出被写入缓冲区，如果服务器页面完全“完成” - 输出的一部分卡在以太（缓冲区）中。

当您禁用缓冲区时 - jsp 的输出会在生成后立即发送到客户端。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T10:18:10.933

也许它与刷新缓冲区有关？那个数字（200k）敲响了我遇到的问题的钟声。像这样放置一个页面指令：

```
<%@page buffer="500kb" autoFlush="true" %> 
```

并使用缓冲区大小和自动刷新值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T10:47:33.177

Thank you all again. During the pasted days I've experienced a disk crash, vomiting children and a trip to Spain.

Since the disk crash I cannot reproduce this behavior! I have not lost any code and I have the exact same JBoss. But I have a slightly different Java and Firefox version. No Fiddler installed (although I had it turned off on my old machine).

I still have no clue what caused it. But also I don't care anymore :P

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T22:00:15.503

我赞同 Henning 的建议。我在 JBoss 上使用了 JSP 来返回数兆字节的响应，我会查看代码或者可能是中间代理服务器而不是 JBoss。

# linux - 'ls' 命令在 Linux/Unix 中如何工作？

> ID：204202
> 
> 赞同：14
> 
> 时间：2008-10-15T09:55:58.573
> 
> 标签：linux, unix, open-source, operating-system, solaris

我想确切地知道“Is”命令在 Linux 和 Unix 中是如何工作的。

据我所知， ls forks & exec 到 Linux/Unix shell，然后获取输出（当前文件树的输出。例如/home/ankit/）。我需要更详细的解释，因为我不确定调用 fork 后会发生什么。

谁能详细解释'ls'命令的功能？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-10-15T09:59:00.423

ls 不分叉。shell fork 和 execs 是为了运行任何未内置的命令，它可以运行的命令之一是 ls。

ls 使用 opendir() 和 readdir() 单步执行目录中的所有文件。如果它需要关于其中之一的更多信息，它会调用 stat()。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-15T10:11:17.250

为了增加答案，他们在 The C Programming Language book (K&RC) 中给出了一个关于如何实现 ls 的小例子。他们已经很好地解释了使用的数据结构和函数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-28T20:50:47.727

要了解 ls 的作用，您可以查看 OpenSolaris 源代码：[https](https://hg.java.net/hg/solaris~on-src/file/tip/usr/src/cmd/ls/ls.c) ://hg.java.net/hg/solaris~on-src/file/tip/usr/src/cmd/ls/ls.c 。

如果那是压倒性的，那么在 Solaris 上，您首先使用 truss 查看 ls 发出的系统调用，以了解它的作用。使用桁架，尝试：

桁架 -afl -o ls.out /bin/ls

然后查看 ls.out 中的输出

我相信trace相当于Linux中的truss。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-31T22:20:53.450

如果你真的想了解 ls 的详细内幕，请查看源代码。您可以按照 tpgould 的链接访问 Solaris 源代码，或者很容易从任何 Linux 或 BSD 发行版在线找到源代码。

我会特别推荐 4.4BSD 源代码。

我记得， ls 从解析它的许多选项开始，然后从命令行上列出的文件或目录开始（默认是“.”）。子目录通过递归到目录列表例程中来处理。我记得没有 fork() 或 exec() 。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2011-12-18T13:10:54.067

这是一个旧线程，但我仍然在发表评论，因为我相信被赞成和接受的答案部分不正确。@Mark 说 ls 内置在 shell 中，因此 shell 不会执行和分叉。当我在 bash 上研究 tldp 文档时（我已附上链接）“ **ls** ”未列为内置命令。

[http://tldp.org/LDP/Bash-Beginners-Guide/html/sect_01_03.html](http://tldp.org/LDP/Bash-Beginners-Guide/html/sect_01_03.html)

Bash 内置命令：

alias、bind、builtin、command、declare、echo、enable、help、let、local、logout、printf、read、shopt、type、typeset、ulimit 和 unalias。

# postgresql - 当所有子对象都消失时，自动删除父对象行

> ID：204207
> 
> 赞同：0
> 
> 时间：2008-10-15T09:57:16.823
> 
> 标签：postgresql

在 PostgreSQL 8.3 数据库中，我有按 ID 引用“booking_transactions”表的“bookings”表。这样每个预订都属于一个单一的交易。可以从数据库中删除预订。

当引用它的所有“预订”都消失时，如何确保自动删除“booking_transactions”行？

我怀疑 ON DELETE "bookings" 触发器不起作用，因为它必须查询 "bookings" 表的其他行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-15T10:24:24.070

“预订”上的触发器应该可以在触发器函数中查询表本身没有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T11:30:52.533

以下 plpgsql 触发器函数完成了这项工作

```
BEGIN
DELETE FROM
    booking_transactions bt
WHERE
    bt.id = OLD.transaction_id AND
    NOT EXISTS (SELECT 1 FROM bookings b WHERE b.transaction_id = bt.id);

RETURN OLD;
END; 
```

必须在预订的 DELETE 后执行

# perl - 如何检测格式错误的 UTF 字符

> ID：204208
> 
> 赞同：11
> 
> 时间：2008-10-15T09:57:28.977
> 
> 标签：perl, utf-8, character-encoding

我想在使用 SQL*Loader 加载数据时使用 Perl 脚本检测并用空格替换格式错误的 UTF-8 字符。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T17:47:40.837

考虑 Python。它允许使用用户定义的错误处理程序扩展编解码器，因此您可以用您想要的任何内容替换不可解码的字节。

```
import codecs
codecs.register_error('spacer', lambda ex: (u' ', ex.start + 1))
s = 'spam\xb0\xc0eggs\xd0bacon'.decode('utf8', 'spacer')
print s.encode('utf8') 
```

这打印：

```
spam  eggs bacon 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T10:07:32.140

编辑：（删除了一些关于 SQL Loader 的信息，因为它似乎不再相关。）

一个问题是要弄清楚什么是格式错误的 UTF-8 字符的“结束”。说什么是非法的很容易，但下一个合法字符从哪里开始可能并不明显。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T11:44:35.377

[RFC 3629](https://www.rfc-editor.org/rfc/rfc3629)描述了 UTF-8 字符的结构。如果你看一下，你会发现找到无效字符非常简单，并且下一个字符边界总是很容易找到（它是一个小于 128 的字符，或者是“长字符”开始标记之一，前导位为 110、1110 或 11110）。

但是 BKB 可能是正确的 - 最简单的答案是让 perl 为你做这件事，虽然我不确定 Perl 在检测到不正确的 utf-8 并使用该过滤器时会做什么。

# sql-server - 可以将 MS SQL 2005 备份恢复到 MS SQL 2008 实例吗？

> ID：204212
> 
> 赞同：12
> 
> 时间：2008-10-15T10:01:30.560
> 
> 标签：sql-server, sql-server-2005, backup

是否可以将 SQL Server 2005 数据库的备份还原到 SQL Server 2008 实例上？

我需要重建一个服务器，因为它变得相当糟糕，所以我计划借此机会升级到 SQL 2008，并想知道我是否能够恢复我的备份。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-15T10:06:13.000

从 2005 年升级到 2008 年是可以的，向后移动可能需要更多的工作

注意您的数据库登录可能有问题（因为它们不会存在于新的服务器主数据库中），但无论服务器版本如何，都会发生这种情况。只需重新创建它们并与您的数据库重新关联。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-19T01:59:03.273

可以，但请确保您的所有服务器都是 SQL 2008。如果您有开发、测试、QA 或灾难恢复服务器，所有这些服务器都需要是 2008，因为 2005 服务器将无法恢复 2008 备份。

为防止 Ilya 提到的丢失登录问题，请按照此知识库文章中的步骤操作。SP_Help_Revlogin 将编写您的登录脚本，您可以在新服务器上应用该脚本。Presto，您的所有登录信息都以相同的 SID 和所有内容返回。

[http://support.microsoft.com/kb/246133](http://support.microsoft.com/kb/246133)

（仅供参考，这就是我们昨晚升级 StackOverflow 的方式，呵呵。）

[http://twitter.com/SuperDalgas/status/976719756](http://twitter.com/SuperDalgas/status/976719756)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-15T10:45:13.733

您可以使用 2008 恢复 2005 备份而不会出现任何问题。从这个角度来看，兼容性很好。

只有备份文件才能向后退。

在任何情况下，您还可以重新创建数据库结构并使用 SSIS 将数据从一台服务器传输到另一台服务器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-26T13:23:32.170

您还可以对数据库文件进行分离/附加（至少可以从 2000 年到 2005 年），但这种方法有更多注意事项（在 IRRC 之后需要显式重建索引）

# dynamics-crm - 为什么连接到 Dynamics CRM 元数据服务时出现 401 错误？

> ID：204226
> 
> 赞同：1
> 
> 时间：2008-10-15T10:08:38.190
> 
> 标签：dynamics-crm, dynamics-crm-4

我连接到 CRM 的目的是检索选项列表值的列表。在我的开发机器上，我使用自己的登录名工作，一切正常。在测试服务器上，代码在 NETWORK SERVICE 帐户下执行。当它连接到 CRM Web 服务时，一切都很好。当它连接到元数据服务时，我收到 401 Unauthorized 消息。

这是我第一次使用元数据服务，所以我希望有人能告诉我为什么会出现错误。连接是使用下面的代码配置的，当您尝试检索选项列表数据时会发生故障。

```
CrmAuthenticationToken token = new CrmAuthenticationToken();
token.OrganizationName = config.AppSettings.Settings["CrmTargetOrganisation"].Value;
token.AuthenticationType = 0;

MetadataService service = new MetadataService();
service.Credentials = System.Net.CredentialCache.DefaultCredentials;
service.Url = config.AppSettings.Settings["CrmMetadataServiceUrl"].Value;
service.CrmAuthenticationTokenValue = token;
service.UnsafeAuthenticatedConnectionSharing = true; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-18T20:04:17.000

我怀疑这可能是 Kerberos / 委托问题，以确保它尝试用 new System.Security.Net.NetworkCredentials("username","password","domain"); 替换 DefaultCredentials

看看这是否仍然给你一个 401。

这是我通常尝试查看它是否与 kerbos/安全相关的快速方法。

我需要有关您的环境的更多信息才能发表任何其他明智的评论。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-15T23:09:36.930

就我而言（是的，我们仍然使用 CRM 4），IIS 中的网站未绑定到用于访问端口 5555 上的元数据服务的主机名。

# winapi - 如何从 INI 文件读/写中文/日文字符？

> ID：204241
> 
> 赞同：2
> 
> 时间：2008-10-15T10:15:16.790
> 
> 标签：winapi, ini

使用`WritePrivateProfileString`和`GetPrivateProfileString`结果`???`代替真实字符。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-01-11T15:08:20.207

`GetPrivateProfileString()`并且`WritePrivateProfileString()`可以使用Unicode，有点。

如果 ini 文件是 UTF-16LE 编码的，即它有一个 UTF-16 BOM，那么这些函数将在 Unicode 中工作。但是，如果函数必须创建文件，它们将创建一个 ANSI 文件并且仅在 ANSI 中工作。

因此，要使用 Unicode 功能，请在首次使用之前创建您的 ini 文件，并向其写入 UTF-16LE 字节顺序标记。然后照常进行。

请注意，这些函数*根本不适用于 UTF-8*。

请参阅[Michael Kaplan 的博客](http://www.siao2.com/2006/09/15/754992.aspx)以获取比您想知道的更多详细信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-22T02:54:39.953

WritePrivateProfileStringW 函数将以遗留系统编码（例如，日本系统上的 Shift-JIS）写入 INI 文件，因为它是遗留支持函数。如果你想要一个完全支持 Unicode 的 INI 文件，你需要使用一个外部库。

试试 SimpleIni [http://code.jellycan.com/simpleini/](http://code.jellycan.com/simpleini/)

它是 C++，单头文件，具有 MIT 许可证的模板库（即商业用途是可以的）。将其包含到您的源文件中并使用它。它是跨平台的，支持 UTF-8 和传统编码文件，并且可以读写 INI 文件，主要保留注释和结构等。最容易签出页面。

它已经存在了一段时间，并且似乎被相当多的人使用。我写了它并继续支持它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T10:26:49.947

根据[`WritePrivateProfileString`](http://msdn.microsoft.com/en-us/library/ms725501.aspx)文档，有一个 Unicode 版本：`WritePrivateProfileStringW`. 使用它，您应该能够使用 Unicode 字符。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T10:18:01.713

这可能只是您如何显示或处理字符串的问题。例如，普通的控制台窗口不能用 printf 显示日文字符串。

你可以发布一些你的代码吗？

# .net - 为什么布尔值比字符消耗更多的内存？

> ID：204256
> 
> 赞同：27
> 
> 时间：2008-10-15T10:26:54.737
> 
> 标签：.net, memory, char, boolean

为什么 Boolean 在 .NET 框架中消耗 4 个字节，而 char 消耗 2 个字节？布尔值应占用 1 位或至少小于 char。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-10-15T10:32:36.020

这是内存对齐的问题。4 字节变量的工作速度比 2 字节变量快。这就是为什么你应该使用 int 而不是 byte 或 short 作为计数器等的原因。

只有当内存比速度更重要时，才应该使用 2 字节变量。这就是为什么 char（.NET 中的 Unicode）占用两个字节而不是四个字节的原因。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-12T01:20:44.993

**关于`boolean`**

大多数其他答案都弄错了——对齐和速度是程序员应该坚持使用 int 循环计数器的原因，而不是编译器可以使字节为 4 字节宽的原因。实际上，您的所有推理都适用于字节和短以及布尔值。

至少在 C# 中，bool（或 System.Boolean）是一个 1 字节宽的内置结构，可以自动装箱，所以你有一个对象（至少需要两个内存字来表示，即 8/在 32/64 位环境下分别为 16 个字节），一个字段（至少一个字节）加上一个指向它的内存字，即总共至少 13/25 个字节。

这确实是关于“C# 原始类型”的第一个 Google 条目。 [http://msdn.microsoft.com/en-us/library/ms228360(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms228360(VS.80).aspx)

此外，引用的链接（[http://geekswithblogs.net/cwilliams/archive/2005/09/18/54271.aspx](http://geekswithblogs.net/cwilliams/archive/2005/09/18/54271.aspx)）还指出，根据 CLI 标准，布尔值占用 1 个字节。

然而，实际上，唯一可见的地方是布尔数组 - n 个布尔值将占用 n 个字节。在其他情况下，一个布尔值可能需要 4 个字节。

*   在结构内部，大多数运行时（也在 Java 中）会将所有字段对齐到 4 字节边界以提高性能。用于嵌入式设备的 Monty JVM 更明智——我猜它以最佳方式重新排序字段。
    *   在解释器的本地帧/操作数堆栈上，在大多数实现中，为了提高性能，一个堆栈条目是一个内存字宽（可能在 .NET 上，它必须是 64 位宽才能支持 double 和 long，这在 .NET 上）仅使用 1 个堆栈条目，而不是 Java 中的 2 个）。如果额外的开销是值得的，JIT 编译器可以改为将 1 个字节用于布尔局部变量，同时通过重新排序字段来保持其他变量对齐而不影响性能。

**关于`char`**

`char`是两个字节，因为当需要支持国际化时，在内部使用两个字节字符是最安全的选择。这与选择支持 Unicode 没有直接关系，而是与选择坚持 UTF-16 和基本多语言平面有关。在 Java 和 C# 中，您可以一直假设一个逻辑字符适合 char 类型的变量。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-15T10:35:49.540

这是因为在 32 位环境中，CPU 可以比 8 位或 16 位值更快地处理 32 位值，因此这是速度/大小的权衡。如果您必须节省内存并且您有大量的布尔值，只需使用*uint*并将您的布尔值保存为 4 字节*uint*的位。字符为 2 个字节宽，因为它们存储 16 位 Unicode 字符。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-12T02:24:40.637

不管内存存储的细微差别如何，使用布尔值表示 true/false yes/no 值对开发人员（包括您自己，当您必须在一年后重新访问代码时）很重要，因为它更准确地反映了您的意图。让你的代码更容易理解比节省两个字节更重要。

使您的代码更准确地反映您的意图还可以降低某些编译器优化产生负面影响的可能性。这个建议超越了平台和编译器。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-12T01:31:25.377

您还应该使用布尔值来帮助编写可维护的代码。如果我看一下代码，发现某些东西是布尔值，那么值得节省内存来确定您使用 char 作为布尔值。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-15T10:34:00.650

我发现：“实际上，布尔值是 4 个字节，而不是 2 个。原因是 CLR 支持布尔值。我认为这就是它的作用，因为 32 位值的操作效率更高，因此时间/空间一般来说，权衡是值得的。如果你需要将一堆比特塞在一起，你应该使用比特向量类（忘记它在哪里）......“

它由 Paul Wick 在[http://geekswithblogs.net/cwilliams/archive/2005/09/18/54271.aspx撰写](http://geekswithblogs.net/cwilliams/archive/2005/09/18/54271.aspx)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-15T10:52:23.967

只有当您有大量位数组时，内存才是一个问题，在这种情况下，您可以使用 System.Collections.BitArray 类。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-15T11:03:44.367

首先，您应该使用分析器来确定您在哪里有内存问题，恕我直言。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-15T11:15:10.460

这是因为 Windows 和 .Net 从一开始就使用[Unicode](http://en.wikipedia.org/wiki/Unicode) [(UTF 16)](http://en.wikipedia.org/wiki/UTF-16)作为其内部字符集。 [UTF 16](http://en.wikipedia.org/wiki/UTF-16)每个字符使用 2 个字节或每个字符使用一对 2 字节字，但仅在需要时才使用，因为它是[可变宽度编码](http://en.wikipedia.org/wiki/Variable-width_encoding)。

“对于基本多语言平面 (BMP) 中的字符，生成的编码是单个 16 位字。对于其他平面中的字符，编码将产生一对 16 位字”

我对布尔值的猜测是它们是四个字节，因为默认寄存器是 32 位，这将是 .Net 可以有效地进行逻辑运算的最小大小，除非使用按位运算。

# .net - 从经典 ASP 到 .net c# 或 vb？

> ID：204265
> 
> 赞同：6
> 
> 时间：2008-10-15T10:33:59.123
> 
> 标签：.net, asp-classic

我是一个业余程序员，拥有几个数据库驱动的移动网站，我最终决定从经典的 asp 切换到 .net。但是经过几天的阅读，我无法决定我应该走哪条路。我应该学习 c# 还是继续 .net 中的 vb？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-15T10:37:39.833

对于业余爱好者编程（即，您只能在自己身上工作的非商业活动），它真的没有任何真正的区别。

**选择你更舒服的那个**。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-15T10:39:37.660

C# 因为如果你知道它，你的工作机会会更大，而且在我看来它是一种更优雅的语言。

它有一个更大的社区，您可能会发现更多用 c# 编写的教程。如果您选择任何一种语言，都可以使用[在线转换器](http://www.developerfusion.com/tools/convert/csharp-to-vb/)来帮助您。

之后您将轻松阅读 Java 代码。您可能还会对 c 或 c++ 语法感到宾至如归。

哦，如果您从未接触过 Web 表单并且来自经典的 asp 背景，为什么不试试[asp.net mvc呢？](http://www.asp.net/mvc/default.aspx?wwwaspnetrdirset=1)*在某些*方面它更接近“旧方式” 。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-15T10:39:59.500

大约 3 年前，我在工作中遇到了这个问题。如果您深入研究这些语言的语法，您会发现它们非常接近。

我选择了 C# 方式，因为它似乎被更广泛地使用、要求、更多示例可用并且它是跨平台的（我上次查看时缺少 mono vb.net）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-15T10:40:08.797

自 1991 年以来在 VB 中工作后，我发现 VB.Net 真的很难上手——这些语言非常相似，让人感觉很熟悉，但又足够不同，让我经常绊倒。为了让它更加混乱，我用 Excel/VBA 做了很多工作，它仍然是 VB6。

因此，当我在 .Net 中工作时，我更喜欢 C#：我从来都不是 C++ 或 Java 程序员，所以我不会因为那里的差异而绊倒。

不利的一面是，经过多年的 VB 自动更正，C# 区分大小写很乏味……

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-15T11:33:10.983

c# 出于这些原因：

1.  我没有任何确凿的证据或任何东西，但似乎 c# 程序员比相反的方式更容易阅读/编码 vb.net 代码。
2.  c#似乎在就业市场上更受欢迎（我知道你是个业余爱好者，但仍然......）
3.  c# 在语法上更接近 c/c++/java。如果你想学习其他语言，c# 会让你有一点优势（java 除外，因为这两种语言非常相似，所以你会有相当大的优势......你只需要主要是学习一个新的框架。）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-15T11:59:18.483

尽管 VB.Net 是可行的，但趋势是朝着 C# 发展。当今顶级开发人员编写的大多数文章都是用 C# 编写的，它可以节省您简单地使用 C# 进行开发的时间，而不必将您的“句法思维过程”翻译回 VB。

从语法区分大小写的角度来看，您会发现 C# 更具挑战性，并且您可能会发现自己对智能感知的依赖超出了您的预期。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-15T12:24:59.023

我也是从 asp classic 开始的，发现 VB.NET 比 C# 容易得多。当然，大多数示例都是用 C# 编写的，但如果您了解 C# 语法，那么理解和应用并不难。无论哪种方式，您都应该能够相当舒适地阅读。

我不是在编写（我也不想）大型、复杂的 Web 应用程序。我发现 VB 有很多小东西可以帮助我专注于逻辑，而不是像区分大小写这样“愚蠢”的东西。

我认为这与你的想法有很大关系。我发现 VB 比 C# 更容易阅读 100 倍，但其他人则不同。这就是为什么不只有一种语言适合所有人。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-15T10:37:05.760

c#：一开始会更难，但以后会付出。我的意见...

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-15T10:41:11.697

我的感觉是 C# 比 VB 有更光明的未来，从长远来看会给你带来更丰富的体验。许多其他现代语言也在使用 C 派生语法，这也将使它们更容易学习。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-15T10:41:41.633

您可以直接从 C# 开始。VB.NET 和 VB 中通用的东西不多，不管外观。

如果您从 VB.NET 开始，则无论如何您都必须学习该框架。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-15T10:42:36.313

我对你的建议是使用 C#。我是一名 VB 程序员，但我总是觉得被编程社区排斥在外。C# 使用行业广泛使用的术语，而 VB.NET 使用自己的术语。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-15T11:06:01.163

只是为了呼应这里的几个人：

*   “经典” ASP 和 VB.net 完全是不同的野兽。一些语法是相似的，但一旦你开始深入研究，它就是一种完全不同的语言。

*   如果您坚持使用类似 VB 的语言，您可能会感到困惑。ASP.NET 有很多不同之处，我强烈考虑完全重新开始。购买一本 C# 书籍并度过一个周末可能是清理学习管道的最佳方式。

*   C# 对案例和语法有更多的了解。VB.Net 也与 VBS (ASP) 相提并论，因此您要确保无论您使用哪种方式，您都有一个好的 IDE 来保护您并在您学习时保持一致。

*   与 Visual Basic 相比，对于外行招聘经理来说，C# 在 CV/简历上看起来要复杂得多。一种是锋利的、切割的、热的。另一个是基本的。无论如何，C#/Java 语法的工作通常比 VB 多得多。

*   但最终你应该去你最快乐的地方。**你有完全的自由选择，所以尽情享受吧。**

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-15T12:36:54.973

这两种语言非常相似，只是我所说的语法糖差异。选择你更满意的。我也会回应其他人的说法，如果您感觉不强烈，那么您应该使用 c#，因为这是更多产的语言。

当你在这里时，还有一些其他的提示。

*   不再有隐藏字段 - 您不再需要隐藏字段来保存您的状态，使用 Session 集合或 ViewState 集合。
*   将您的数据库访问移到另一个项目中，不要从页面或后面的页面代码与数据库对话。
*   看看使用一些 ORM 对象关系映射（LLBGenPro、CodeSmith、LINK 到 SQL 等）
*   记录所有异常查看 global.aspx.cs 中的应用程序事件

欢迎来到一个全新的世界！

# debugging - 为什么 Eclipse CDT 忽略断点？

> ID：204282
> 
> 赞同：25
> 
> 时间：2008-10-15T10:40:16.910
> 
> 标签：debugging, eclipse-cdt, breakpoints

我的问题是我在代码中设置了一些断点，其中一些没有工作。在某些地方它抱怨“未解决的断点”。

有谁知道为什么会这样？顺便说一句，我正在使用 gdb。

编辑：是的，当然是用调试信息编译的。它只发生在代码中的某些类或点上。而且我很确定已经到达了代码的那一部分，因为我可以通过步进到达它

编辑：理查德的解决方案不起作用；不管怎么说，还是要谢谢你。我正在调试中编译，没有任何优化。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-22T04:04:00.957

可能是您试图在尚未加载的共享库中设置断点。在库加载之前，这将不起作用。较新的 gdb 允许设置延迟断点，但 CDT 可能（尚）不支持。一种解决方法是在一个从一开始就可用的位置设置一个断点，当相关共享库已经加载时将到达该位置。然后在共享库中设置另一个断点。现在它应该可以工作了。这有点乏味，但通常有效。

从[GDB 文档](http://sources.redhat.com/gdb/current/onlinedocs/gdb_6.html)：

> 对于地址未知的挂起断点，该字段将包含“PENDING”。在加载具有断点引用的符号或行的共享库之前，不会触发此类断点。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-15T13:18:13.363

我发现有时将引用的 Process Launcher 从“GDB (DSF) Create Process Launcher”切换到“Standard Create Process Launcher”已经为我解决了这个问题。其他时候，只需删除所有断点并重新启动 Eclipse 即可。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-06T07:30:14.633

“未解决的断点”只是意味着 GDB 没有找到与您尝试设置断点的文件和行相对应的代码位置。

您是否试图在构造函数中停止？

如果是这样，您可能会看到这个 cently fixed GCC [bug](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=27574)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-09-09T04:01:45.557

有时优化也会导致断点被跳过。确保您使用 -O0 进行编译

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-20T11:24:53.883

我发现使用 F8 (resume) 不会在我的断点处停止。但是，如果我设置了 Stop On Startup : main ，然后单步执行我的代码（F5/F6），那么我的断点就会被命中。除了-g 或-g3 之外，我没有任何特殊的编译器选项。希望帮助...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-31T07:37:07.307

确保断点类型正确。对于 C/C++，它是一个小蓝点。如果它看起来像其他任何东西，则很可能断点类型不正确。我会尝试关闭文件，右键单击它 -> 使用 -> C/C++ 编辑器打开。这对我有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-07T22:57:25.510

如果这里的其他答案没有解决您的问题，那么您可能遇到了与我相同的问题（这是 GDB 版本过时的结果）。对于在 Mac 上使用 GDB 的任何人来说，情况都可能如此。

在这里查看我的问题和答案：

[使用多个源文件时，GDB 不会中断某些代码行](https://stackoverflow.com/questions/18067569/gdb-does-not-break-on-some-lines-of-code-when-using-multiple-source-files)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-05-30T01:45:27.373

我对 GDB 也有类似的问题。似乎它是由相同的源代码文件名引起的，即使它们具有不同的路径。我重命名了重复项，之后 GDB 工作得很好。

西尔维乌

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-10-21T11:14:37.820

您是否在模板类/函数中放置断点？我遇到了同样的问题：我可以单步执行模板代码，但断点不起作用。我猜eclipse不明白它必须在该类的所有实例中放置断点：

```
template <typename T>
int doit(T a) {
 return a.do(); // <-- breakpoint here
}
...
A a;
cout << doit(a); 
```

我认为它会等待 doit(...) 而永远不会等待 doit(...)。如果我将它设置为函数：'doit'，至少 gdb 本身会在断点处停止。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-11-10T20:42:29.037

我有同样的问题，

```
1.- Removed the breakpoints. 
2.- Restart eclipse 
3.- Clean the project by using project -> clean 
4.- Add again the breakpoints and start your debugging. 
```

这解决了我的问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-03-18T15:00:37.893

令人惊讶的是，这个问题有这么多不同的答案。Eclipse 2019.12、CDT 9.10、RHEL 8.0、x86_64 中仍然存在（2020）问题。就我而言，我可以通过调整断点属性并将其从“常规”更改为“硬件”来修复它（选择断点窗口，然后右键单击断点，断点属性，常见，类型）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-05-10T17:57:54.497

如果您使用 GDB 作为调试器，请确保同时使用两个标志：-g 和 -ggdb

您可以直接编辑 make 文件，FCFLAGS = -g -ggdb（您可能拥有的其他一些标志）

或转到调试配置（它在您单击错误图标旁边的小箭头时下拉的菜单中。）选择您正在调试的项目，然后单击调试器选项卡。检查您正在使用 gdb，并在此处添加标志。

# c# - 为 WPF 启用拖放功能的有效 ListView 实现？

> ID：204289
> 
> 赞同：2
> 
> 时间：2008-10-15T10:43:06.983
> 
> 标签：c#, .net, wpf, listview, controls

一直在尝试找到 WPF 列表视图（或列表框）的有效实现，您可以在其中通过向上或向下拖动来订购项目。

我找到了一些，但没有一个真正有效，例如这个 [http://www.codeproject.com/KB/WPF/ListViewDragDropManager.aspx?msg=2765618#xx2765618xx](http://www.codeproject.com/KB/WPF/ListViewDragDropManager.aspx?msg=2765618#xx2765618xx) 一旦你有需要向下滚动的列表就会停止工作到达最后一项。

为什么在 WPF 中拖放如此困难？有人知道工作控制吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T10:48:07.610

拖放并不难，真的:)

尝试阅读这篇关于拖放[的文章。](http://www.beacosta.com/blog/?p=53)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T12:05:19.763

另请查看CodeProject 上的[这篇](http://www.codeproject.com/KB/WPF/WPFDragDrop.aspx)文章！

它不像 Josh & Bea 的实现那样功能齐全，但使用起来非常简单......

此实现依赖于附加属性（附加行为）

来源

```
<ListBox src:DragAndDrop.DragEnabled="true"/> 
```

目标

```
<ListBox src:DragAndDrop.DropEnabled="true"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-07T14:06:26.223

我一直在为 WPF 拖放而苦苦挣扎，并决定硬着头皮为它创建一个框架。

你可以在这里找到代码：[http ://code.google.com/p/gong-wpf-dragdrop/](http://code.google.com/p/gong-wpf-dragdrop/)

我很想得到一些反馈，希望它能解决你的问题！

# .net - 有谁知道我在哪里可以找到.net 的内存编辑用户控件？

> ID：204295
> 
> 赞同：0
> 
> 时间：2008-10-15T10:48:15.520
> 
> 标签：.net, .net-2.0, binary-data, user-controls, memory-editing

我正在开发一个小应用程序，它列出了给定格式文件的内容。文件格式充当描述二进制数据的模板（想想二进制 xml）。这允许生成这些文件的客户端以他们想要的任何方式存储数据，因此包含的**所有类型的解释****都是未知的**。我想做的是浏览这些类型，解释常见类型，并为未知类型公开一种内存编辑器。

基本的概要是我有一个字节缓冲区，我将通过用户界面对其进行操作。

我正在寻找一些 .net 的用户控件，希望它们已经做到了。如果没有，我想我将不得不自己写。请向我发送现有程序集的链接

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T11:05:22.273

这个项目声称有一个可重用的十六进制编辑器组件：[Be.HexEditor](http://sourceforge.net/projects/hexbox/) - 这可能是编辑随机二进制数据的最佳方式。

# t4 - 如何在 T4 ClassBlock 方法中使用模板？

> ID：204303
> 
> 赞同：1
> 
> 时间：2008-10-15T10:53:03.310
> 
> 标签：t4

我开始研究 T4 的代码生成。

我知道你有一个基本模板，你可以在其中嵌入小块 c#/vb 可以执行聪明的东西......

```
<#@ template language="VB" debug="True" hostspecific="True" #>
<#@ output extension=".vb" debug="True" hostspecific="True" #>
Imports System
<#For Each Table as String in New String(0 {"Table1","Table2"}#>
Public Class <#=Table#>DA
    Public Sub New
        <#= WriteConstructorBody() #>
    End Sub 
End Class
<#Next#>
<#+
    Public Function WriteConstructorBody() as String
        return "' Some comment"
    End function
#> 
```

这很棒..但是我希望能够编写我的主要块......

```
<#@ template language="VB" debug="True" hostspecific="True" #>
<#@ output extension=".vb" debug="True" hostspecific="True" #>
Imports System
<# 
For Each BaseTableName as String in New String(){"Table1","Table2"} 
    WriteRecDataInterface(BaseTableName) 
    WriteRecDataClass(BaseTableName) 
    WriteDAInterface(BaseTableName) 
    WriteDAClass(BaseTableName) 
Next 
#> 
```

然后我希望能够让 WriteX 方法存在于类块中，但它们本身可以使用示例代码写入，即转义代码块。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T11:20:19.123

你可以写.....

```
<#@ template language="VB" debug="True" hostspecific="True" #>
<#@ output extension=".vb" debug="True" hostspecific="True" #>
Imports System
<# 
For Each BaseTableName as String in New String(){"Table1","Table2"} 
    WriteRecDataInterface(BaseTableName) 

    ' WriteRecDataClass(BaseTableName) 
    ' WriteDAInterface(BaseTableName) 
    ' WriteDAClass(BaseTableName) 
Next 
#>

<#+ Public Sub WriteRecDataInterface(BaseTableName as String)#>
    Some Templated unescaped code might go here
    <#+ For SomeLoopVar as Integer = 1 to 10 #>
        Some Templated unescaped code might go here
    <#+ Next #>
    Some Templated unescaped code might go here
<#+ End Sub #>
'...
'...
' Other Subs left out for brevity
'... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T11:18:43.523

您似乎可以将静态输出与类块中的模板代码混合使用。下面是一个 C# 示例：

```
<#@ template language="C#" #>
<# HelloWorld(); #>
<#+
    private string _field = "classy";
    private void HelloWorld()
    {
        for(int i = 1; i <= 3; i++)
        {
#>
Hello <#=_field#> World <#= i #>!
<#+
        }
    }
#> 
```

# asp.net - Asp.net 服务器在服务器端/客户端控制相同的事件处理顺序

> ID：204305
> 
> 赞同：1
> 
> 时间：2008-10-15T10:53:24.513
> 
> 标签：asp.net, event-handling

我有一个 asp.net 服务器控件（在其定义中带有 asp:）。该按钮已设置为回发。

在服务器端，我有点击事件处理程序，例如 btnSave_click()

在客户端，我有一个要在单击事件上调用的 javascript 函数，例如 btnSave.Attributes.Add("onclick","javascript: return CheckIsDirty();")

我不确定这两个将执行哪个命令。因为我希望首先在客户端警告任何尚未填写的数据输入字段，然后再实际保存任何数据。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T11:02:05.977

第一个客户端，第二个服务器端。

所以你可以使用它。

我也在某些情况下使用它，例如：

```
close.Attributes["OnClick"] = "return confirm('Are you sure?')"; 
```

在这种情况下，如果用户按下“否​​”，那么服务器端事件处理程序甚至不会发挥作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T11:08:12.907

这里的技巧是如果您的测试失败，则将此全局变量“Page_IsValid”设置为 false，这将停止回发。

阅读此页面[http://msdn.microsoft.com/en-us/library/aa479045.aspx](http://msdn.microsoft.com/en-us/library/aa479045.aspx) ，其中解释了服务器端和客户端验证。您可以使用一个很好的代码示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T12:01:23.517

您设置 onClick JavaScript 事件的方式实际上会阻止它在您被覆盖 ASP.NET 事件处理程序时回发。完成您想要的验证的正确方法是：

```
btnSave.Attributes.Add("onclick", "CheckIsDirty();" + GetPostBackEventReference(btnSave).ToString()); 
```

请注意，您附加了 GetPostBackEventReference 的结果，因此在 JavaScript 中您首先调用 CheckIsDirty() 方法，然后调用 ASP.NET 回发方法。假设您的方法返回 true，则按钮将发布。如果它返回 false 则不会导致回发。

这听起来像你想要完成的事情吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T11:07:00.740

我认为您需要更好地理解客户端的含义和服务器端的含义以及它们之间的关系。我已经看到越来越多的开发人员把它弄得一团糟。

当然，在您的情况下，客户端将首先执行。实际上，在执行服务器代码后没有办法执行它（除非您手动执行某些操作）。我将尝试给出一个简短的解释：

无论您在服务器中拥有什么，都会在客户端上生成一些 HTML，并且用户始终在客户端上进行交互。因此，您有一个用户正在单击的 html 按钮。浏览器将执行与其关联的javascript，或者如果没有指定javascript并且按钮是提交按钮，它将提交表单。如果您检查生成的 html，您会看到对于 onclick 事件，您将拥有添加的脚本，然后是一些自动生成的脚本，这些脚本实际上会将表单提交到服务器。只有在提交页面时，您的服务器端代码才会执行​​。

# python - 在 Python 中检查成员是否存在

> ID：204308
> 
> 赞同：27
> 
> 时间：2008-10-15T10:54:18.317
> 
> 标签：python, exception, introspection, hasattr

我经常想检查一个对象是否有成员。一个例子是在函数中创建单例。为此，您可以`hasattr`像这样使用：

```
class Foo(object):
    @classmethod
    def singleton(self):
        if not hasattr(self, 'instance'):
            self.instance = Foo()
        return self.instance 
```

但你也可以这样做：

```
class Foo(object):
    @classmethod
    def singleton(self):
        try:
            return self.instance
        except AttributeError:
            self.instance = Foo()
            return self.instance 
```

一种方法比另一种更好吗？

**编辑：**添加`@classmethod`...但请注意，问题*不*在于如何制作单例，而是如何检查对象中成员的存在。

**编辑：**对于那个例子，一个典型的用法是：

```
s = Foo.singleton() 
```

然后`s`是一个类型的对象，`Foo`每次都一样。而且，通常，该方法会被多次调用。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-15T12:28:11.233

这是两种不同的方法：№1 是 LBYL（在你跳跃之前先看），№2 是 EAFP（请求宽恕比许可更容易）。

Pythonistas 通常建议 EAFP 更好，其参数风格为“如果一个进程在您测试它的时间和您尝试自己创建它的时间之间创建文件怎么办？”。这个论点在这里并不适用，但它是一般的想法。异常不应被视为*太*异常。

在您的情况下性能方面 - 因为在 CPython 中设置异常管理器（`try`关键字）非常便宜，而创建异常（`raise`关键字和内部异常创建）相对昂贵 - 使用方法 №2 只会引发一次异常; 之后，您只需使用该属性。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-15T12:15:54.300

我只是试图测量时间：

```
class Foo(object):
    @classmethod
    def singleton(self):
        if not hasattr(self, 'instance'):
            self.instance = Foo()
        return self.instance

class Bar(object):
    @classmethod
    def singleton(self):
        try:
            return self.instance
        except AttributeError:
            self.instance = Bar()
            return self.instance

from time import time

n = 1000000
foo = [Foo() for i in xrange(0,n)]
bar = [Bar() for i in xrange(0,n)]

print "Objs created."
print

for times in xrange(1,4):
    t = time()
    for d in foo: d.singleton()
    print "#%d Foo pass in %f" % (times, time()-t)

    t = time()
    for d in bar: d.singleton()
    print "#%d Bar pass in %f" % (times, time()-t)

    print 
```

在我的机器上：

```
Objs created.

#1 Foo pass in 1.719000
#1 Bar pass in 1.140000

#2 Foo pass in 1.750000
#2 Bar pass in 1.187000

#3 Foo pass in 1.797000
#3 Bar pass in 1.203000 
```

似乎 try/except 更快。它对我来说似乎也更具可读性，无论如何取决于具体情况，这个测试非常简单，也许你需要一个更复杂的测试。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-15T10:59:22.283

这取决于哪种情况是“典型的”，因为异常应该模拟非典型情况。因此，如果典型情况是该`instance`属性应该存在，则使用第二种代码样式。如果没有`instance`像有一样典型`instance`，那么使用第一种样式。

在创建单例的特定情况下，我倾向于使用第一种样式，因为在初始时创建单例是一个典型的用例。:-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T12:45:28.327

使用它的方式有点离题。单例被高估了，“共享状态”方法在 python 中同样有效，而且大多数情况下非常干净，例如：

```
class Borg:
    __shared_state = {}
    def __init__(self):
        self.__dict__ = self.__shared_state
    # and whatever else you want in your class -- that's all! 
```

现在每次你这样做：

```
obj = Borg() 
```

它将具有相同的信息，或者，在某种程度上是相同的实例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T12:27:14.807

我必须同意克里斯。请记住，在您真正需要之前不要进行优化。我真的怀疑检查存在是否会成为任何合理程序的瓶颈。

我确实也将[http://code.activestate.com/recipes/52558/](http://code.activestate.com/recipes/52558/)视为一种方法。该代码的未注释副本（“垃圾邮件”只是类接口具有的随机方法）：

```
class Singleton:
    class __impl:
        def spam(self):
            return id(self)
    __instance = None
    def __init__(self):
        if Singleton.__instance is None:
            Singleton.__instance = Singleton.__impl()
        self.__dict__['_Singleton__instance'] = Singleton.__instance
    def __getattr__(self, attr):
        return getattr(self.__instance, attr)
    def __setattr__(self, attr, value):
        return setattr(self.__instance, attr, value) 
```

# java - Web 应用程序的类似电子表格的控件？

> ID：204310
> 
> 赞同：7
> 
> 时间：2008-10-15T10:54:41.997
> 
> 标签：java, asp.net, javascript, apache-flex, web-applications

我的一个客户希望将基于多个（非常复杂的）电子表格的关键“应用程序”转换为 Web 应用程序。作为其中的一部分，他们希望他们用来输入/建模数据的一些网页尽可能地类似于电子表格。

我很想知道是否有人对可以比标准 html/javascript/ajax 代码做得更好的可嵌入控件有任何经验/建议 - 尽管也欢迎对可以做到这一点的 Javascript 框架提出建议。我主要考虑 ActiveX、Flex、Java 或类似的控件，商业或开源都可以。

要使用的编码语言和平台仍然存在争议，因此 ASP.NET 与 IE 或 PHP/Flex 与 Firefox 或其他一些组合都可以——这将由业务需求而非平台驱动。

功能性当然是主要驱动力，但拥有漂亮的眼睛糖果总是有用的，因此可皮肤和凉爽是一个加号。关于 Javascript 框架，我以前使用过 Dojo 和 Mootools，但我更喜欢一些更简洁的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T10:59:15.857

我会说这归结为数据网格。

对于 Javascript 框架：Jquery 有这样的“插件[”](http://trirand.com/jqgrid/jqgrid.html)。服务器端：Telerik 有这样的 asp.net[控件](http://demos.telerik.com/ASPNET/Prometheus/Grid/Examples/Overview/DefaultCS.aspx)。

这实际上取决于您要使用的平台组合。

另外，为什么要将asp.net 页面绑定到IE 而不是Firefox？

对于 Web 应用程序，我的建议是结合使用 asp.net mvc 和 jquery。在我看来，JQuery 是最好和最稳定的 JavaScript 框架。问题是 asp.net mvc 仍处于 ctp 阶段，在某些人看来它可能不够“支持”和“稳定”。我已经完成了一个基于该混合物的中型商业网络应用程序，并且对它感到满意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-02-26T15:43:07.560

查看 ZK 电子表格，它很酷。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-09-23T18:57:47.777

听起来 EASA 可能会满足您的需求。它是 Zurich、GE、HP 等公司使用的无代码应用程序开发工具。您可能想看看[http://www.easasoftware.com/spreadsheets](http://www.easasoftware.com/spreadsheets)。希望这可以帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-19T22:44:18.880

查看[SpreadsheetGear](http://www.spreadsheetgear.com)，它是一个 .Net 组件，可让您读取/写入 Excel 文件并执行宏。您可以保留电子表格的逻辑并使用它们为您的网站提供动力。

对于前端，您可能需要查看 Telerik，因为人们已经创建了一个[类似于 Telerik 网格控件界面的电子表格](http://www.telerik.com/community/code-library/submission/b311D-babbkh.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T11:27:08.157

我会考虑基于 google docs/apps 或类似的后台网络服务的解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-24T02:11:51.197

在这里，您可以下载基于 Web 的开源电子表格[GelSheet](http://gelsheet.sourceforge.net)。它是用 PHP/MySql/Javascript 编写的。您可以在 sourceforege 项目页面联系开发人员进行任何自定义。这是我找到的最佳解决方案，我将其用作个人项目的一部分。

# perl - 为什么我不应该使用 UNIVERSAL::isa？

> ID：204316
> 
> 赞同：17
> 
> 时间：2008-10-15T10:57:46.983
> 
> 标签：perl

根据这个

[http://perldoc.perl.org/UNIVERSAL.html](http://perldoc.perl.org/UNIVERSAL.html)

我不应该使用 UNIVERSAL::isa() 而应该使用 $obj->isa() 或 CLASS->isa()。

这意味着首先要找出某些东西是否是引用，然后是对这个类的引用，我必须这样做

```
eval { $poss->isa("Class") } 
```

并检查 $@ 和所有的口香糖，否则

```
use Scalar::Util 'blessed';
blessed $ref && $ref->isa($class); 
```

我的问题是为什么？像这样调用 UNIVERSAL::isa 有什么问题？对于以下内容，它要干净得多：

```
my $self = shift if UNIVERSAL::isa($_[0], __PACKAGE__) 
```

查看是否在对象上调用此函数。是否有一个不错的干净替代方案，不会因与号和潜在的长线而变得繁琐？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-10-15T11:18:49.297

主要问题是，如果您`UNIVERSAL::isa`直接调用，您将绕过任何已重载的类`isa`。如果这些类依赖于重载行为（他们可能会这样做，否则他们不会覆盖它），那么这是一个问题。如果您`isa`直接在您的祝福对象上调用，那么`isa`在任何一种情况下都会调用正确的方法（如果存在则重载，如果不存在则 UNIVERSAL::）。

第二个问题是，它`UNIVERSAL::isa`只会像其他使用`isa`. 对于非祝福引用和简单标量，它具有不同的行为。因此，您的示例不检查是否`$ref`是被祝福的没有做正确的事情，您忽略了错误条件并使用了`UNIVERSAL`替代行为。在某些情况下，这可能会导致细微的错误（例如，如果您的变量包含类的名称）。

考虑：

```
use CGI;

my $a = CGI->new();

my $b = "CGI";

print UNIVERSAL::isa($a,"CGI");  # prints 1, $a is a CGI object.
print UNIVERSAL::isa($b,"CGI");  # Also prints 1!! Uh-oh!! 
```

所以，总而言之，不要使用`UNIVERSAL::isa`... 做额外的错误检查并`isa`直接在你的对象上调用。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-15T11:14:30.147

请参阅[UNIVERSAL::isa](http://search.cpan.org/dist/UNIVERSAL-isa/lib/UNIVERSAL/isa.pm)和[UNIVERSAL::can](http://search.cpan.org/dist/UNIVERSAL-can/lib/UNIVERSAL/can.pm)的文档，了解为什么不应该这样做。

简而言之，有些重要的模块确实需要覆盖“isa”（例如[Test::MockObject](http://search.cpan.org/dist/Test-MockObject/)），如果您将其作为函数调用，则会破坏它。

我不得不说，`my $self = shift if UNIVERSAL::isa($_[0], __PACKAGE__)`对我来说看起来不是很干净——反 Perl 的拥护者会抱怨线路噪音。:)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-15T11:13:20.853

要直接回答您的问题，答案在您链接到的页面底部，即如果一个包定义了一个`isa`方法，那么`UNIVERSAL::isa`直接调用不会调用包`isa`方法。从面向对象的角度来看，这是非常不直观的行为。

这篇文章的其余部分只是更多关于你为什么要这样做的问题。

在像上面这样的代码中，在什么情况下特定的`isa`测试会失败？即，如果它是一种方法，在这种情况下，第一个参数不是包类或其实例吗？

我问这个是因为我想知道您是否有正当理由首先要测试第一个参数是否是对象。即，您是否只是想抓住人们说`FooBar::method`而不是`FooBar->method`or `$foobar->method`？我猜 Perl 不是为那种溺爱而设计的，如果人们错误地使用`FooBar::method`他们很快就会发现。

你的旅费可能会改变。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-15T14:21:39.473

其他人都告诉过你*为什么*不想使用`UNIVERSAL::isa`它，因为当事情超载时它会中断`isa`。如果他们已经养成了重载这种非常特殊方法的所有习惯，那么您当然要尊重它。当然，你*可以*这样写：

```
if (eval { $foo->isa("thing") }) {
     # Do thingish things
} 
```

因为`eval`保证如果抛出异常则返回 false，否则返回最后一个值。但这看起来*很糟糕*，你不应该以有趣的方式编写代码，因为语言希望你这样做。我们真正想要的只是写：

```
if ( $foo->isa("thing") ) {
     # Do thingish things
} 
```

为此，我们必须确保它`$foo`始终是一个对象。但`$foo`可能是字符串、数字、引用、未定义的值或各种奇怪的东西。Perl 不能让*一切都*成为一流的对象，真是太可惜了。

哦，等等，它可以...

```
use autobox;   # Everything is now a first class object.
use CGI;       # Because I know you have it installed.

my $x = 5;
my $y = CGI->new;

print "\$x is a CGI object\n" if $x->isa('CGI');   # This isn't printed.
print "\$y is a CGI object\n" if $y->isa('CGI');   # This is! 
```

您可以从 CPAN中获取[autobox 。](http://search.cpan.org/perldoc?autobox)您还可以将它与词法范围一起使用，因此所有内容都可以成为您想要使用的文件或块的第一类对象，`->isa()`而不会带来额外的麻烦。它还比我在这个简单示例中介绍的*要*多得多。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-15T11:26:29.703

假设您希望能够做的事情的示例是在对象方法中，那么您就不必要地偏执了。第一个传递的项目将始终是对适当类（或子类）的对象的引用，或者是类（或子类）的名称。它永远不会是任何其他类型的引用，除非该方法被故意作为函数调用。因此，您可以安全地使用**ref**来区分这两种情况。

```
if (ref $_[0]) {
  my $self = shift;
  # called on instance, so do instancey things
} else {
  my $class = shift;
  # called as a class/static method, so do classy things
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-02-20T12:12:21.290

对。对于重载的类，它做错了事`isa`。只需使用以下成语：

```
if (eval { $obj->isa($class) }) { 
```

它易于理解和普遍接受。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-01-06T20:59:56.387

2020 年更新：Perl v5.32 具有[类中缀运算符](https://www.effectiveperlprogramming.com/2020/01/use-the-infix-class-instance-operator/), `isa`，它处理左侧的任何类型的事情。如果`$something`不是一个对象，你会返回 false 而不会爆炸。

```
use v5.32;

if( $something isa 'Animal' ) { ... } 
```

# c# - 将结构变量初始化为 Nullable

> ID：204320
> 
> 赞同：0
> 
> 时间：2008-10-15T11:00:23.373
> 
> 标签：c#, .net, nullable

有没有办法在 c# 中将变量声明为 Nullable？

```
struct MyStruct {        
    int _yer, _ner;

    public MyStruct() {

        _yer = Nullable<int>; //This does not work.
        _ner = 0;
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-15T11:02:50.733

_yer 必须声明为 int？或 Nullable<int>。

```
 int? _yer;
    int _ner;

    public MyStruct(int? ver, int ner) {

        _yer = ver;
        _ner = ner;
    }
} 
```

或者像这样：

```
 Nullable<int> _yer;
    int _ner;

    public MyStruct(Nullable<int> ver, int ner) {

        _yer = ver;
        _ner = ner;
    }
} 
```

**请记住，结构不能包含显式的无参数构造函数。**

```
error CS0568: Structs cannot contain explicit parameterless constructors 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T11:02:21.607

尝试像这样声明你的变量：

```
int? yer; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T11:02:31.547

[可空类型](http://msdn.microsoft.com/en-us/library/2cf62fcy(VS.80).aspx)怎么样：

```
struct MyStruct
{
    private int? _yer, _ner;
    public MyStruct(int? yer, int? ner)
    {
        _yer = yer;
        _ner = ner;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T11:02:41.967

尝试最初将 _yer 声明为 Nullable 类型，而不是标准的 int。

# winapi - 如何以编程方式操作 DLGTEMPLATE？

> ID：204334
> 
> 赞同：3
> 
> 时间：2008-10-15T11:05:24.770
> 
> 标签：winapi, mfc, localization, hook

**什么？**

我有一个从资源 DLL 加载的 DLGTEMPLATE，如何以编程方式在运行时更改分配给控件的字符串？

我希望能够在创建对话框之前执行此操作，这样我就可以知道显示的字符串来自资源 DLL，而不是初始化对话框时对 SetWindowText 的调用。

谷歌已经找到了在代码中创建 DLGTEMPLATE 的示例，或者在编辑内存中的字符串时没有处理简单的样式位。

**如何？**

我通过挂钩对话框/属性表创建 API 来做到这一点。这使我可以在创建实际对话框之前以及在它具有 HWND 之前访问 DLGTEMPLATE。

**为什么？**

我希望能够进行运行时本地化和本地化测试。我已经为加载字符串（包括 MFC 7.0 包装器）、菜单和加速器表实现了此功能，但我正在努力处理对话框/属性表的创建。

代码示例将是完美的答案，理想情况下是一个围绕 DLGTEMPLATE 的类，如果我制定出自己的解决方案，我会发布它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-15T13:30:50.730

您无法编辑内存中的字符串。DLGTEMPLATE 结构是资源 dll 的相关字节的直接文件映射。那是只读的。

您将需要处理整个 DLGTEMPLATE 结构并用改变的长度字符串写出一个新结构。

坦率地说，仅挂钩 WM_INITDIALOG 并通过与控件交互来更改字符串比构建 DLGTEMPLATE 编写器更容易。因为周围的人不多。除非您有额外的要求将更改的对话框资源作为原始 .res 文件实际保存到磁盘（或尝试就地修改 .dll），否则我真的建议您避免这种方法。

您说您已经在为加速器表和菜单字符串执行此操作 - 如果您可以保证修补的字符串会更短，那么只需制作 DLGTEMPLATE 结构的二进制副本，并编写查找所需的非平凡扫描代码每个字符串，以便您可以将副本修补到位。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-16T00:00:12.723

有一个名为 RESFMT.ZIP 的文件（我认为它起源于 Microsoft，但我不完全确定），它通过一些代码示例解释了这一点。Raymond Chen 在他的博客上也做了一些很好的解释。注意 DIALOGEX 和 DIALOG 控件的格式是不同的。

正如在其他一些答案中所指出的，您需要从一开始就再次创建结构。这还不错，因为您已经掌握了基本信息。添加控件是很难的地方。

基本上，将较大的内存块分配到 WORD *lpIn 中。然后在上面添加结构。添加 DIALOG 的基本信息（请参阅 DLGTEMPLATE）和控件非常明显，因为信息在 MSDN 中。

您将遇到的两个最大问题是：确保各个部分从对齐边界开始，以及解释 DIALOG 控件的值，尤其是在仅添加字符串或字符串或序数时。每个控件都需要从一个均匀的边界开始。

对于第一个（从我认为 RESFMT.ZIP 的某个地方借来的）：

```
WORD *AlignDwordPtr (WORD *lpIn)
    {
    乌龙 ul;

    ul = (ULONG) lpIn;
    ul +=3；
    ul >>=2;
    ul

我所做的是构建了一系列函数，如下所示，它允许我在内存中组装 DIALOGS。（我的需要是我可以拥有一些不需要关联 RC 文件来获取一些非常基本的消息的通用代码）。

这是一个例子......

```
WORD *AddStringOrOrdinalToWordMem( WORD *lpw, char *sz_Or_Ord )
    {
    LPWSTR lpwsz;
    整数缓冲区大小；

    如果（sz_Or_Ord == NULL）
        {
        *lpw++ = 0;
        }
    别的
        {
        if (HIWORD(sz_Or_Ord) == 0) //MAKEINTRESOURCE 宏
            {
            *lpw++ = 0xFFFF；
            *lpw++ = LOWORD(sz_Or_Ord);
            }
        别的
            {
            if (strlen(sz_Or_Ord))
                {
                lpwsz = ( LPWSTR ) lpw;
                BufferSize = MultiByteToWideChar(CP_ACP, 0, sz_Or_Ord, -1, lpwsz, 0);
                MultiByteToWideChar(CP_ACP, 0, sz_Or_Ord, -1, lpwsz, BufferSize);
                lpw = lpw + 缓冲区大小；
                }
            别的
                {
                *lpw++ = 0;
                }
            }
        }
    返回（lpw）；
    }

```

完整模块的头文件包括以下功能：

WORD *AddControlToDialogTemplateEx(MTDialogTemplateType *dlgtmp,
                                   字符 *标题,
                                   字号，
                                   字符 *WinClass,
                                   双字样式，
                                   短 x,
                                   短 y,
                                   短cx，
                                   短cy，
                                   DWORD ExStyle,
                                   诠释帮助ID）；

int DestroyDlgTemplateEx(MTDialogTemplateType *dlgtmp);

MTDialogTemplateType *CreateDlgTemplateEx( char *Name, // 我们使用 name 仅供参考，所以可以为 NULL
                                            短 x,
                                            短 y,
                                            短cx，
                                            短cy，
                                            DWORD 扩展样式，
                                            双字样式，
                                            字符 *菜单，
                                            字符 *WinClass,
                                            字符 *标题，
                                            字符 *FontTypeFace,
                                            整数字体大小，
                                            整数字体重量，
                                            int FontItalic,
                                            整数字符集，
                                            整数帮助ID，
                                            int NumberOfControls);

```

这使我可以轻松地从代码中组装整个对话框。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T18:51:11.163

请参阅 API 函数 :: [EnumChildWindows](http://msdn.microsoft.com/en-us/library/ms633494(VS.85).aspx) ( HWND, WNDENUMPROC, LPARAM )

您可以在 CFormView::Create 或 CDialog::OnInitDialog 中调用它，让自己有机会替换控件标题。不用担心，旧琴弦在更换之前不会闪烁。

在您的对话框资源中，将控件标题设置为某种字典中的键。如果您正在编译 /clr，您可以使用托管字符串表资源。在您的回调中，在您的字典中查找已翻译的字符串并将控件的标题设置为翻译。/clr 和托管字符串表的另一个好处是，您可以通过已设置 System::Threading::Thread::CurrentThread->CurrentUICulture 的 Windows（或您）自动查找正确的语言。

像这样的东西

```
CMyDialog::OnInitDialog()
{
    ::EnumChildWindows(
        this->GetSafeHwnd(),
        CMyDialog::UpdateControlText,
        (LPARAM)this )
}

BOOL CALLBACK CMyDialog::UpdateControlText( HWND hWnd, LPARAM lParam )
{
    CMyDialog* pDialog = (CMyDialog*)lParam;
    CWnd* pChildWnd = CWnd::FromHandle( hWnd );

    int ctrlId = pChildWnd->GetDlgCtrlID();
    if (ctrlId)
    {
        CString curWindowText;
        pChildWnd->GetWindowText( curWindowText );
        if (!curWindowText.IsEmpty())
        {
            CString newWindowText = // some look up
            pChildWnd->SetWindowText( newWindowText );
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T20:43:46.240

您必须在代表模板的内存缓冲区中找到要修改的字符串。唯一的方法是遍历整个模板。这并不容易。完成此操作后，如果新字符串比原始字符串长，则在缓冲区中插入字节。如果新字符串较短，则缩小缓冲区。

正如 Chris 所写，修改 WM_INITDIALOG 中的文本并尝试重新表述您可能不会调用 SetWindowText() 的要求会容易得多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T09:52:19.797

谢谢大家，我实际上有 24 小时的时间来解决这个问题，然后使用全局 Windows 挂钩过滤 WM_INITDIALOG，这是一种更简单的方法，效果很好，不需要 API 挂钩，2 页代码只需要几行。

感谢所有的答案。

# database - 为什么从 SQLPlus 运行脚本不需要密码？

> ID：204336
> 
> 赞同：1
> 
> 时间：2008-10-15T11:06:28.137
> 
> 标签：database, oracle

我注意到它可以通过只提供用户名而不提供密码来使用 Oracle 的 SQLPlus 运行 SQL 脚本。这不是对甲骨文任何形式的安全性的严重破坏吗？

还是我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-15T11:12:47.280

很可能，您的 oracle 服务器启用了[操作系统身份验证](http://www.oracle-base.com/articles/misc/OsAuthentication.php)，这基本上告诉 oracle 信任已经登录到操作系统的用户。

# c# - .net 反射和“params”关键字

> ID：204343
> 
> 赞同：10
> 
> 时间：2008-10-15T11:09:58.800
> 
> 标签：c#, .net, reflection

在 .net 中，有没有办法使用反射来确定方法上的参数是否用“params”关键字标记？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-15T11:20:29.340

检查是否`ParamArrayAttribute`已应用于`ParameterInfo`对象：

```
//use string.Format(str, args) as a test
var method = typeof(string).GetMethod("Format", new[] {typeof(string), typeof(object[])});
var param = method.GetParameters()[1];
Console.WriteLine(Attribute.IsDefined(param, typeof(ParamArrayAttribute))); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-15T11:14:17.933

测试以查看最终的[ParameterInfo](http://msdn.microsoft.com/en-us/library/system.reflection.parameterinfo.aspx)是否应用了[ParamArrayAttribute](http://msdn.microsoft.com/en-us/library/system.paramarrayattribute.aspx)。

# snmp - 什么是最好的开源 SNMP 监控工具？

> ID：204344
> 
> 赞同：20
> 
> 时间：2008-10-15T11:10:10.860
> 
> 标签：snmp

我目前正在开发必须为 SNMP 版本 1 和 2 以及将来可能会发出 v3 的 SNMP 陷阱的软件。我下载了几个，发现它们要么太复杂，要么太简单。我想要的只是查看陷阱并分析其中的数据结构，以及导入我的自定义 MIB 的能力。到目前为止，我发现的最好的是 ireasonings MIB Browser，但对于任何不错的替代品都会非常有用。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-15T11:25:14.230

[netsnmp](http://www.net-snmp.org) - 应该做你所追求的一切，具有各种语言绑定以适应各种口味。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-15T13:27:42.610

我使用过的唯一使用 SNMP 监控的监控工具是 Nagios、Zenoss、OpenNMS 和我公司的专有产品——但它们用于全面的网络监控。

您希望监控多少台设备？如果只是一对，@Andrew 对 netsnmp 的建议可能就足够了。

# c++ - 如何在 Eclipse 中设置 linux C++ 项目？

> ID：204345
> 
> 赞同：5
> 
> 时间：2008-10-15T11:10:11.170
> 
> 标签：c++, linux, eclipse

我在 linux 环境中有一个现有的 C++ 项目，并希望将其导入 Eclipse IDE。

不确定我是否应该开始一个新的 Eclipse C++ 项目，或者是否有某种方法可以导入源文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T11:13:55.547

您可以“就地”创建一个新的 Eclipse C++ 项目，即如果您在 /home/joe/mysources 签出源代码，您可以在新项目向导中选择该目录（先取消选中“使用默认位置”复选框）。您的所有源文件都将显示在 Eclipse 项目中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T11:15:18.430

一种解决方案：只需创建一个新的 C++ 项目（标准 make 项目），签出/复制其中的文件，然后在资源视图中右键单击项目目录并选择新建 > 其他 > C++ > 转换为 C/C++ Make项目。

# java - 为 O/RM 系统（休眠）实现长期历史模式的最佳实践？

> ID：204349
> 
> 赞同：4
> 
> 时间：2008-10-15T11:12:10.760
> 
> 标签：java, database, hibernate, orm

我已经使用 Hibernate 将几个 java 类（如 Customer、Assessment、Rating 等）映射到数据库。现在我正在考虑对持久数据的所有更改的历史模式。该应用程序是一个 Web 应用程序。在删除（或编辑）数据的情况下，另一个用户应该有可能看到更改并撤消它。由于更改超出了当前会话的范围，因此我不知道如何以命令模式之类的方式解决此问题，建议将其用于撤消功能。

对于单值编辑，类似这个[问题](https://stackoverflow.com/questions/141612/database-structure-to-track-change-history)的方法听起来不错。但是删除整个持久实体呢？最简单的方法是在该客户是否被删除时在表中创建一个标志。最复杂的方法是为存储已删除实体的每个类创建一个表。中间有什么吗？我怎样才能将这两个东西舒适地集成到 O/RM 系统（在我的情况下是 Hibernate）中，而不用过多地使用 SQL（由于可移植性我想避免）并且仍然具有足够的灵活性？

有最佳实践吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T15:36:50.570

维护审计/撤消跟踪的一种方法是用版本号标记对象记录的每个版本。如果这是一个简单的版本号，则查找当前版本将是一项痛苦的工作，因此反向版本编号效果最好。“版本” 0 始终是当前版本，如果您进行更新，所有以前版本的版本号都会递增。删除对象是通过递增当前记录上的版本号而不是在 0 处插入新版本号来完成的。

与逐个属性的方法相比，这使得回滚或历史版本视图更加简单，但确实占用了更多空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T15:15:35.200

一种方法是创建一个“更改历史记录”实体，其中包含更改实体的实体 ID、操作（编辑/删除）、属性名称、原始值、新值的属性。也许还参考执行编辑的用户。删除将使用“删除”操作为已删除实体的所有属性创建实体。

该实体将提供足够的数据来执行撤消和查看更改历史记录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T20:40:31.220

嗯，我也在寻找这个问题的答案。到目前为止，我发现的最好的是 www.jboss.org/envers/ 框架，但即便如此，在我看来，工作量也超过了必要的工作量。

# c++ - 设计 ala “object.method1().method2().method3()”的术语是什么？

> ID：204360
> 
> 赞同：6
> 
> 时间：2008-10-15T11:16:53.217
> 
> 标签：c++

这个设计的术语是什么？

```
object.method1().method2().method3() 
```

..当所有方法都返回 *this？

我不久前找到了这个术语，但同时失去了它。我不知道如何在谷歌上搜索这个:) 另外，如果有人能想到一个更好的问题标题，请随时更改它。

谢谢

**Update-Gishu**：阅读后，我觉得你的问题是误导提供的代码片段..（随时回滚）

*方法链*

```
object.method1().method2().method3() 
```

*流畅的界面*

```
private void makeFluent(Customer customer) {
        customer.newOrder()
                .with(6, "TAL")
                .with(5, "HPK").skippable()
                .with(3, "LGV")
                .priorityRush();
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-15T11:17:38.737

在我看来，您正在描述一个流畅的界面。我还听说它被称为流水线或链接。

更新-Gishu：[http ://martinfowler.com/bliki/FluentInterface.html](http://martinfowler.com/bliki/FluentInterface.html)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-15T11:18:41.870

> 它链接这些方法调用，这就是为什么这被称为[方法链接](https://isocpp.org/wiki/faq/references#method-chaining)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-15T11:19:38.593

它通常被称为方法链。其应用的一个例子是[Named Parameter Idiom](http://www.parashift.com/c++-faq-lite/ctors.html#faq-10.18)。

顺便说一句，我发现在 Google 中搜索“object method1 method2”会找到您正在寻找的页面，这很有趣。:)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-01-22T04:21:07.810

它被称为[方法链](http://en.wikipedia.org/wiki/Method_chaining)。例如，有一个 boost 库提供了一种在大括号初始化出现之前分配到容器的链接方式（[Boost.Assignment](http://www.boost.org/doc/libs/1_57_0/libs/assign/doc/index.html)）：

```
vector<int> v; 
v += 1,2,3,4,5,6,7,8,9;

typedef pair< string,string > str_pair;
deque<str_pair> deq;
push_front( deq )( "foo", "bar")( "boo", "far" ); 
```

但是，通常情况下，您会在其他语言中看到它更多地用于执行诸如提供[流畅界面](http://en.wikipedia.org/wiki/Fluent_interface)之类的操作：

```
 FluentGlutApp(argc, argv)
     .withDoubleBuffer().withRGBA().withAlpha().withDepth()
     .at(200, 200).across(500, 500)
     .named("My OpenGL/GLUT App")
     .create(); 
```

除了流媒体之外，我个人在 C++ 中并没有看到太多。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-15T11:24:09.643

链式在业界是一个比较常见的名称，大多数开发人员至少听说过它，而流畅的界面更具学术性，很多人都不知道你在说什么。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-15T11:19:41.620

您正在寻找的术语是[方法链接](https://isocpp.org/wiki/faq/references#method-chaining)。

# android - 有没有办法将 3D 模型导入 Android？

> ID：204363
> 
> 赞同：58
> 
> 时间：2008-10-15T11:17:09.753
> 
> 标签：android, 3d, opengl-es

是否可以创建一个简单的 3D 模型（例如在 3DS MAX 中）然后将其导入 Android？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-04-12T17:35:43.603

这就是我要去的地方：

*   我使用 Google 的 APIDemos 作为起点——那里有旋转的立方体，每个立方体由两个数组指定：顶点和索引。
*   我已经使用 Blender 构建了我的模型并将其导出为 OFF 文件 - 它是一个文本文件，列出了所有顶点，然后根据这些顶点（索引几何）列出了面
*   然后我创建了一个简单的 C++ 应用程序，将其关闭并将其写入两个包含数组的 XML（一个用于顶点，一个用于索引）
*   然后将这些 XML 文件复制到 res/values，这样我就可以将它们包含的数据分配给这样的数组：
    `int vertices[] = context.getResources().getIntArray(R.array.vertices);`
*   我还需要在此处手动更改要绘制的面数：`gl.glDrawElements(GL10.GL_TRIANGLES, 212*6, GL10.GL_UNSIGNED_SHORT, mIndexBuffer);`-您可以在 OFF 文件的顶部找到该数字（在本例中为 212）

在这里你可以找到我的项目页面，它使用了这个解决方案：[Github project > vsiogap3d](https://github.com/maciejgryka/vsiogap3d)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-12T15:19:26.490

您可以将其导出为 ASE 格式。从 ASE，您可以手动或以编程方式将其转换为您的代码。在 Android 中，您将需要顶点作为顶点数组和面作为索引。不要忘记你必须设置

```
gl.glFrontFace(GL10.GL_CCW); 
```

因为 3ds max 默认是逆时针的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-15T11:24:07.353

这应该是可能的。您可以将文件作为程序的数据文件（因此它将被推送到模拟器并打包以安装到实际设备上）。然后，您可以使用 Android 和 GLES 库在 java 中编写模型加载器和查看器来显示模型。

不过，这方面的具体资源可能是有限的。3ds 是一种专有格式，因此第 3 方加载器供应不足，而且大多是逆向工程。其他格式（例如搅拌机或牛奶形状）更开放，您应该能够相当容易地找到在 java 中为它们编写加载程序的详细信息。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-04-26T09:47:57.340

你试过min3d for android吗？它支持 3ds max、obj 和 md2 模型。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-15T11:20:13.100

不确定具体是 Android，但一般来说，您需要 3DS Max 中的脚本手动写出您需要的模型格式。

至于Android是否存在，我不知道。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-09-26T22:40:41.270

您还可以使用**3D Object Converter转换 3DS MAX 模型**

[http://web.t-online.hu/karpo/](http://web.t-online.hu/karpo/)

此工具可以将 3ds 对象转换为 text\xml 格式或 c 代码。请注意，该工具不是免费的。您可以尝试 30 天的试用期。'C' 代码和 XML 转换器可用。

'c' OpenGL 输出示例：

```
glDisable(GL_TEXTURE_2D);
glEnable(GL_LIGHTING);
glEnable(GL_NORMALIZE);

GLfloat Material_1[] = { 0.498039f, 0.498039f, 0.498039f, 1.000000f };

glBegin(GL_TRIANGLES);

  glMaterialfv(GL_FRONT,GL_DIFFUSE,Material_1
  glNormal3d(0.452267,0.000000,0.891883);
  glVertex3d(5.108326,1.737655,2.650969);
  glVertex3d(9.124107,-0.002484,0.614596);
  glVertex3d(9.124107,4.039649,0.614596);

glEnd(); 
```

或直接'c'输出：

```
Point3 Object1_vertex[] = {
       {5.108326,1.737655,2.650969},
       {9.124107,-0.002484,0.614596},
       {9.124107,4.039649,0.614596}};
long Object1_face[] = {
       3,0,1,2,
       3,3,4,5
       3,6,3,5}; 
```

您可以将这些对象集合迁移到您的 Java 代码中。

# language-agnostic - 寻求有关结构化代码以降低圈复杂度的说明

> ID：204369
> 
> 赞同：20
> 
> 时间：2008-10-15T11:18:52.073
> 
> 标签：language-agnostic, metrics, cyclomatic-complexity

最近我们公司开始每周测量我们代码中函数的圈复杂度（CC），并报告哪些函数得到了改进或恶化。所以我们开始更加关注函数的CC。

我读过 CC 可以非正式地计算为 1 + 函数中的决策点数（例如 if 语句、for 循环、选择等），或者通过函数的路径数......

我知道减少CC的最简单方法是重复使用Extract Method重构......

有些事情我不确定，例如以下代码片段的 CC 是什么？

1)

```
for (int i = 0; i < 3; i++)
    Console.WriteLine("Hello"); 
```

和

```
Console.WriteLine("Hello");
Console.WriteLine("Hello");
Console.WriteLine("Hello"); 
```

他们都做同样的事情，但是第一个版本是否因为 for 语句而具有更高的 CC 呢？

2)

```
if (condition1)
    if (condition2)
        if (condition 3)
            Console.WriteLine("wibble"); 
```

和

```
if (condition1 && condition2 && condition3)
    Console.WriteLine("wibble"); 
```

假设该语言进行短路评估，例如 C#，那么这两个代码片段具有相同的效果......但是第一个片段的 CC 是否更高，因为它有 3 个决策点/if 语句？

3)

```
if (condition1)
{
    Console.WriteLine("one");

    if (condition2)
        Console.WriteLine("one and two");
} 
```

和

```
if (condition3)
    Console.WriteLine("fizz");

if (condition4)
    Console.WriteLine("buzz"); 
```

这两个代码片段做了不同的事情，但是他们有相同的CC吗？还是第一个片段中的嵌套 if 语句有更高的 CC？即嵌套的 if 语句在心理上更难理解，但这反映在 CC 中吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-15T14:22:31.610

1.  是的。您的第一个示例有一个决策点，而您的第二个没有，因此第一个示例具有更高的 CC。
2.  是的-也许，您的第一个示例有多个决策点，因此 CC 更高。（请参阅下面的说明。）
3.  也许吧。显然它们的决策点数量相同，但是计算 CC 的方法不同，这意味着......

...如果您的公司以特定方式测量 CC，那么您需要熟悉该方法（希望他们正在使用工具来执行此操作）。对于不同的情况（case 语句、布尔运算符等）有不同的计算 CC 的方法，但是无论您使用什么约定，您都应该从度量中获得相同类型的信息。

更大的问题是其他人提到的，您的公司似乎更关注 CC 而不是其背后的代码。总的来说，当然，5以下很好，10以下很好，20以下还可以，21到50应该是一个警告信号，50以上应该是一个大警告信号，但这些是指导，不是绝对的规则。您可能应该检查 CC 高于 50 的过程中的代码，以确保它不仅仅是一大堆代码，但可能有特定原因导致该过程以这种方式编写，而且它不可行（对于任何原因）来重构它。

如果您使用工具重构代码以减少 CC，请确保您了解这些工具在做什么，并且它们不是简单地将一个问题转移到另一个地方。最终，您希望您的代码几乎没有缺陷、能够正常工作并且相对容易维护。如果该代码的 CC 也较低，那就太好了。如果您的代码符合这些标准并且 CC 高于 10，那么也许是时候坐下来尽您所能为您的代码辩护（也许让他们检查他们的政策）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-15T11:26:09.360

通过维基百科条目和 Thomas J. McCabe 的 [原始论文](http://www.literateprogramming.com/mccabe.pdf)浏览后，您上面提到的项目似乎是该指标的已知问题。

但是，大多数指标确实有利有弊。我想在一个足够大的程序中，CC 值可能指向代码的**可能复杂**部分。但更高的CC并不一定意味着复杂。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-15T11:51:41.010

像所有软件指标一样，CC 并不完美。在足够大的代码库上使用，它可以让您了解*可能*存在问题的区域。

这里有两点要记住：

1.  足够大的代码库：在任何不平凡的项目中，您都会拥有具有非常高 CC 值的函数。如此之高，以至于在您的一个示例中，CC 是 2 还是 3 都没有关系。假设 CC 超过 300 的函数绝对值得分析。CC是301还是302都没关系。
2.  别忘了用你的脑袋。有些方法需要很多决策点。通常可以以某种方式重构它们以减少它们，但有时它们不能。不要遵循“使用 CC > xy 重构所有方法”之类的规则。看看他们，用你的大脑来决定做什么。

我喜欢每周分析的想法。**在质量控制中，趋势分析是在问题产生过程**中识别问题的一种非常有效的工具。这比必须等到它们变得如此之大以至于它们变得明显要好得多（有关一些详细信息，请参阅[SPC](http://en.wikipedia.org/wiki/Statistical_process_control)）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-15T11:25:58.860

CC 不是衡量质量的灵丹妙药。显然，重复语句并不比循环“更好”，即使循环具有更大的 CC。循环具有更大 CC 的原因是有时它可能会被执行，有时它可能不会执行，这导致两个不同的“案例”都应该被测试。在您的情况下，循环将*始终*执行三次，因为您使用了一个常量，但 CC 不够聪明，无法检测到这一点。

与示例 2 中的链式 if 相同 - 此结构允许您拥有一个语句，该语句仅在 condition1 和 condition2 为真时执行。这是一种特殊情况，在使用 && 的情况下是不可能的。因此，即使您在代码中不使用 if 链，它也有更大的潜力用于特殊情况。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-15T11:47:49.830

这是盲目应用*任何指标的危险。*CC 指标当然有很多优点，但与任何其他改进代码的技术一样，它不能脱离上下文进行评估。将您的管理层指向 Casper Jone 对代码行测量的讨论（希望我能为您找到一个链接）。他指出，如果代码行数可以很好地衡量生产力，那么汇编语言开发人员就是地球上生产力最高的开发人员。当然，他们并不比其他开发人员更有效率；只需要他们更多的代码来完成高级语言用更少的源代码所做的事情。正如我所说，我提到了这一点，这样您就可以向您的经理展示盲目地应用指标是多么愚蠢，而无需对指标告诉您的内容进行智能审查。

我建议如果不是，您的管理层明智地使用 CC 度量来发现代码中应该进一步审查的潜在热点。盲目地以降低 CC 为目标而没有参考代码可维护性或其他良好编码的措施是愚蠢的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-01-06T14:35:49.133

圈复杂度类似于温度。它们都是度量，在大多数情况下，没有上下文就毫无意义。如果我说外面的温度是 72 度，那并没有多大意义；但如果我加上我在北极的事实，72 这个数字就变得很重要了。如果有人告诉我一个方法的圈复杂度为 10，那么如果没有它的上下文，我就无法确定它是好是坏。

当我对现有应用程序进行代码审查时，我发现圈复杂度是一个有用的“起点”指标。我首先检查的是 CC > 10 的方法。这些“>10”的方法不一定是坏的。它们只是为我提供了审查代码的起点。

考虑 CC 编号时的一般规则：

*   CC#和#of tests的关系，应该是CC# <= #tests
*   只有在提高可维护性时才重构 CC#
*   CC 高于 10 通常表示一种或多种[代码气味](http://c2.com/cgi/wiki?CodeSmell)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-15T11:38:24.547

[题外话] 如果您更喜欢指标的可读性而不是良好的分数（J.Spolsky 说过，“什么是衡量的，什么是完成的”？-这意味着指标被滥用的频率比我想象的要多），通常更好使用命名良好的布尔值来替换复杂的条件语句。

然后

```
if (condition1 && condition2 && condition3)
    Console.WriteLine("wibble"); 
```

变得

```
bool/boolean theWeatherIsFine =  condition1 && condition2 && condition3;

if (theWeatherIsFine)
    Console.WriteLine("wibble"); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-10-31T03:55:17.283

我不是这方面的专家，但我想我会给我的两分钱。也许这就是这一切的价值。

Cyclomatic Complexity 似乎只是一种特定的自动快捷方式，用于查找潜在（但不是绝对）有问题的代码片段。但真正要解决的问题不就是测试吗？代码需要多少个测试用例？如果 CC 更高，但测试用例数量相同且代码更干净，则不必担心 CC。

1.) 那里没有决策点。那里只有一条通过程序的路径，两个版本中的任何一个都只有一个可能的结果。第一个更简洁更好，圈复杂度该死。

1个测试用例

2.) 在这两种情况下，你要么写“wibble”，要么不写。

两个测试用例

3.) 第一个可能没有结果，“一”或“一”和“一和二”。3条路径。第二个可能不会导致任何结果，两者中的任何一个，或两者兼而有之。4条路径。

前3个测试用例，后4个测试用例

# com - InstallShield：达尔文描述符

> ID：204384
> 
> 赞同：1
> 
> 时间：2008-10-15T11:25:52.823
> 
> 标签：com, dll, registry, installshield, regsvr32

我的 InstallShield 安装程序似乎没有正确注册它的几个 COM DLL，即使我已经在安装程序中刷新了它们的 COM 信息。如果我在安装后手动运行 regsvr32，一切都很好。

我注意到安装后，我的组件的注册表中有 InprocServer32 值，这些值包含看起来随机的字符串，我相信这是*Darwin 描述符*，我知道如果存在，它将覆盖明文路径位置。当我手动运行 regsvr32 时，这些达尔文描述符消失了。我目前的假设是这些描述符中编码的信息不正确，因此当我的程序尝试实例化 COM 组件时，它使用了不正确的 Darwin 描述符信息并且失败了，即使 DLL 的明文路径是正确的。

任何人都可以阐明我如何查看是否是这种情况、解码这些描述符、阻止 InstallShield 生成 Darwin 描述符或以其他方式修复我的安装程序吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T08:51:19.203

我理解 darwin 描述符是 Windows 安装程序服务跟踪 COM 入口点回到原始 .MSI （所以它可以修复 .dll 如果它被删除等）。MSI 保存实际值。

大概因为你已经重建了 COM 信息，你有没有从你的机器上卸载 MSI 并重新安装（所以 msiexec 不仅仅是进行维护安装而不是完整安装）。

# java - 在类中存储图像/声音的最佳方式？

> ID：204388
> 
> 赞同：1
> 
> 时间：2008-10-15T11:26:59.500
> 
> 标签：java, serialization, image, audio, persistence

我正在开发一种应用程序实例之间的交换格式，以便用户可以将信息保存到文件并稍后恢复。整个“交换格式”是一个被序列化并写入磁盘的类。

您建议如何在该类中存储图形/声音信息？我想避免只是将文件放入 .jar 中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T13:12:08.163

您可以将资源作为 byte[] 数组存储在类中。使用 ByteArrayInputStream 和 ByteArrayOutputStream，您可以将数组包装为流，并使用它们来存储和检索资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T11:31:53.233

** 我 **

关于你的案子的更多细节怎么样？“最佳”方法通常取决于特定的应用程序/用途。图像/声音是否来自文件？来自流？该类的每个实例是否都应存储单独的图像？还是可以在不同实例之间共享图像？

**gsmd**

> 图像来自文件，声音来自流；实际上有一组项目，其中一些可能附有图像；无法共享图像

* * *

你尝试过哪些方法？我想使用 Serializable 接口是要走的路。这是有关该主题 的[两篇](http://java.sun.com/developer/technicalArticles/ALT/serialization/) [文章。](http://java.sun.com/developer/technicalArticles/Programming/serialization/)

基本上，

1.  在你的类中实现 Serializable 接口
2.  将不应保存在文件中的成员标记为瞬态（包含文件句柄、套接字连接等上下文数据的成员）。
3.  您必须自定义图像和声音类如何使用写入数据，但要实现：

    > private void writeObject(ObjectOutputStream out) 抛出 IOException；
    > 
    > private void readObject(ObjectInputStream in) 抛出 IOException，ClassNotFoundException；

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T11:34:13.620

在类中以任何您喜欢的方式存储数据，但实现数据的自定义序列化。请参阅[可序列化](http://java.sun.com/j2se/1.5.0/docs/api/java/io/Serializable.html)。

# c++ - 在 C++ 中返回对象

> ID：204396
> 
> 赞同：34
> 
> 时间：2008-10-15T11:29:35.343
> 
> 标签：c++, memory-management, factory

从类返回对象时，什么时候释放内存合适？

例子，

```
class AnimalLister 
{
  public:
  Animal* getNewAnimal() 
  {
    Animal* animal1 = new Animal();
    return animal1;
  }
} 
```

如果我创建一个 Animal Lister 实例并从中获取 Animal 引用，那么我应该在哪里删除它？

```
int main() {
  AnimalLister al;
  Animal *a1, *a2;
  a1 = al.getNewAnimal();
  a2 = al.getNewAnimal();
} 
```

这里的问题是 AnimalLister 没有办法跟踪创建的动物列表，所以我如何更改此类代码的逻辑以删除创建的对象。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-01-06T21:29:31.040

根据您的使用情况，您可以在此处使用几个选项：

1.  每次创建动物时都复制一份：

    ```
    class AnimalLister 
    {
    public:
      Animal getNewAnimal() 
      {
        return Animal();
      }
    };

    int main() {
      AnimalLister al;
      Animal a1 = al.getNewAnimal();
      Animal a2 = al.getNewAnimal();
    } 
    ```

    优点：

    *   容易理解。
    *   不需要额外的库或支持代码。

    缺点：

    *   它需要`Animal`一个行为良好的复制构造函数。
    *   `Animal`如果大而复杂，它可能涉及大量复制，尽管[返回值优化](https://en.wikipedia.org/wiki/Return_value_optimization)可以在许多情况下缓解这种情况。
    *   如果您计划返回派生自的子类，则不起作用，`Animal`因为它们将被[切](http://cplusplusgems.blogspot.com/2005/10/what-is-slicing-problem-class-base.html)分成plain `Animal`，从而丢失子类中的所有额外数据。
2.  返回一个`shared_ptr<Animal>`：

    ```
    class AnimalLister 
    {
    public:
      shared_ptr<Animal> getNewAnimal() 
      {
        return new Animal();
      }
    };

    int main() {
      AnimalLister al;
      shared_ptr<Animal> a1 = al.getNewAnimal();
      shared_ptr<Animal> a2 = al.getNewAnimal();
    } 
    ```

    优点：

    *   适用于对象层次结构（无对象切片）。
    *   不必复制大对象没有问题。
    *   无需`Animal`定义复制构造函数。

    缺点：

    *   需要 Boost 或 TR1 库，或其他智能指针实现。
3.  跟踪所有`Animal`分配`AnimalLister`

    ```
    class AnimalLister 
    {
      vector<Animal *> Animals;

    public:
      Animal *getNewAnimal() 
      {
        Animals.push_back(NULL);
        Animals.back() = new Animal();
        return Animals.back();
      }

      ~AnimalLister()
      {
         for(vector<Animal *>::iterator iAnimal = Animals.begin(); iAnimal != Animals.end(); ++iAnimal)
            delete *iAnimal;
      }
    };

    int main() {
      AnimalLister al;
      Animal *a1 = al.getNewAnimal();
      Animal *a2 = al.getNewAnimal();
    } // All the animals get deleted when al goes out of scope. 
    ```

    优点：

    *   `Animal`非常适合在有限的时间内需要一堆s 并计划一次性释放它们的情况。
    *   轻松适应自定义内存池并`Animal`在单个`delete`.
    *   适用于对象层次结构（无对象切片）。
    *   不必复制大对象没有问题。
    *   无需`Animal`定义复制构造函数。
    *   不需要外部库。

    缺点：

    *   上面写的实现不是线程安全的
    *   需要额外的支持代码
    *   不如前两个方案清晰
    *   不明显的是，当 AnimalLister 超出范围时，它会带走 Animals。你不能像挂在 AnimalLister 上那样更长时间地挂在 Animals 上。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-10-15T11:34:21.840

我建议返回一个`std::tr1::shared_ptr`（或者`boost::shared_ptr`，如果您的 C++ 实现没有 TR1）而不是原始指针。因此，不要使用`Animal*`，`std::tr1::shared_ptr<Animal>`而是使用 。

共享指针为您处理引用跟踪，并在没有引用时自动删除对象。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-15T11:34:33.010

最简单的方法是返回智能指针而不是常规指针。例如：

```
std::auto_ptr< Animal> getNewAnimal() 
{
  std::auto_ptr< Animal > animal1( new Animal() );
  return animal1;
} 
```

如果你能够使用 TR1 或 Boost，你也可以使用 shared_ptr<>。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-15T11:41:49.330

指针和分配内存的经典问题。这是关于责任的——谁负责清理 AnimalLister 对象分配的内存。

您可以在 AnimalLister 本身中存储指向每个分配的 Animals 的指针，并让它清理它们。

但是，您确实有几个指向位于 main() 中的 Animals 的指针，它们将引用已删除的内存。

我认为引用计数解决方案比滚动您自己的解决方案更好的原因之一。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-15T12:07:38.387

1.  shared_ptr （效果很好），
2.  返回一个简单的指针并告诉你的类的用户它现在是他们的动物，他们有责任在完成后删除它，
3.  实现一个 'freeAnimal(Animal*)' 方法，这使得很明显需要删除动物指针。

4.  另一种方法是直接返回动物对象，不使用指针，不调用 new。复制构造函数将确保调用者获得他们自己的动物对象，他们可以将其存储在堆或堆栈上，或者根据需要复制到容器中。

所以：

```
class AnimalLister 
{
Animal getAnimal() { Animal a; return a; }; // uses fast Return Value Optimisation
};

Animal myownanimal = AnimalLister.getAnimal(); // copy ctors into your Animal object 
```

RVO 意味着返回对象而不是指针实际上更快（因为编译器不会创建新对象并将其复制到调用者的对象中，而是直接使用调用者的对象）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-11T11:44:04.997

在[Scott Meyers 的彻底讨论中](http://www.aristeia.com/Papers/resourceReturnProblem.txt)，他得出结论，使用 shared_ptr 或 auto_ptr 是最好的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-15T11:42:03.447

或者您可以遵循 COM-ish 方法，并应用简单的引用计数。

*   创建对象时，立即给它一个参考值 1
*   当任何人得到指针的副本时，他们 AddRef()
*   当任何人放弃他们的指针副本时，他们 Release()

如果引用计数达到 0，则该对象将自行删除。

它最终是 shared_ptr 在幕后所做的，但它使您可以更好地控制正在发生的事情，并且根据我的经验更容易调试。（它也非常跨平台）。

在我的开发过程中，我还没有给 shared_ptr 太多的机会，所以这可以完美地满足你的目的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-15T12:36:50.013

释放对象占用的内存的时间是当您不再需要该特定对象时。在您的特定情况下，AnimalLister 类的用户请求了一个指向 Animal 类的新分配对象的指针。因此，当他不再需要该指针/对象时，他就是负责释放内存的人。

```
AnimalLister lister;
Animal* a = lister.getNewAnimal();
a->sayMeow();
delete a; 
```

在我看来，在这种情况下没有必要过度设计任何东西。AnimalLister 只是一个创建新 Animal 对象的工厂，仅此而已。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-07T22:12:31.133

I really like Josh's answer, but I thought I might throw in another pattern because it hasn't been listed yet. The idea is just force the client code to deal with keeping track of the animals.

```
class Animal
{
...
private:
  //only let the lister create or delete animals.
  Animal() { ... }
  ~Animal() { ... } 
friend class AnimalLister;
...
}

class AnimalLister 
{
  static s_count = 0;

public:
  ~AnimalLister() { ASSERT(s_count == 0); } //warn if all animals didn't get cleaned up

  Animal* NewAnimal() 
  {
    ++count;
    return new Animal();
  }

  void FreeAnimal(Animal* a)
  {
    delete a;
    --s_count;
  }
} 
```

# java - 是否可以在 Java 的派生类中取消实现接口？

> ID：204398
> 
> 赞同：2
> 
> 时间：2008-10-15T11:30:39.617
> 
> 标签：java, oop

让我们有以下类层次结构：

```
public class ParentClass implements SomeInterface {
}

public class ChildClass extends ParentClass {
} 
```

然后让我们有这两个实例：

```
ParentClass parent;
ChildClass child; 
```

然后我们有以下 TRUE 陈述

```
(parent instanceof SomeInterface) == true
(child instanceof SomeInterface) == true 
```

是否可以在 ChildClass 中取消实现 SomeInterface，所以当我们检查 instanceof 运算符时，它返回 false？

如果不可能，是否有解决方法？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-15T11:41:13.980

不，这是不可能的，您这样做的意图很好地暗示了您的类层次结构中存在缺陷。

解决方法：更改类层次结构，例如。像这样：

```
interface SomeInterface {}
abstract class AbstractParentClass {}
class ParentClass extends AbstractParentClass implements SomeInterface {}
class ChildClass extends AbstractParentClass {} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-15T11:43:20.260

也许你想要的是组合而不是继承，即有一个“基类”对象作为成员，只需实现你需要的接口，将任何需要的方法转发给成员。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-19T09:12:31.230

我同意其他答案，即在 Java 中是不可能的。

其他答案进一步表明它表明您的设计存在缺陷。

虽然我同意他们的观点，但公平地指出一些著名的 OO 专家（尤其是 Bertrand Meyer）不同意我们的观点，并认为应该允许这样的设计。

其他 OO 继承模型（尤其是 Meyer 的 Eiffel 编程语言）确实支持您正在寻找的“可用性或类型更改”（CAT）特性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-15T11:34:23.790

这是不可能的，这样做会违反 ChildClass 和 ParentClass 之间隐含的 IS-A 关系。你为什么要这样做？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-15T11:40:45.570

我认为您不能“取消实现”它，但您可以检查它是否是父类的实例。接口是你的吗？如果是这样，您可以将其扩展为包含具有语义的“IsObjectDerived”方法，如果该类仅从对象派生，则该方法返回 true。由于您正在编写类，因此您需要做的就是在父类中实现它，如果对象属于 Parent 类，则返回 true，否则返回 false。

您也可以通过检查当前类的超类并确保它是对象来使用反射来做到这一点。我可能会这样做，因为那时实现类不能说谎。您可能想查看我找到的关于 Java 反射的[教程。](http://java.sun.com/docs/books/tutorial/reflect/class/classModifiers.html)

[编辑] 一般来说，我同意这在合理的设计中似乎是不必要的，但可以做到。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-19T16:37:09.137

由于继承是 OOP 多态性的基础，它表示 is-A 关系 - 您的问题似乎要求一种将“是”关系重新定义为“不是”关系的方法。

那是行不通的。

回到一些介绍性的面向对象文本或在线资料，研究面向对象的含义：多态性、封装性和同一性。

1.  剥离身份，您就获得了 COM/ActiveX 和被盗的凭据。
2.  剥离封装，没有人是安全的。
3.  去掉 polyphism 的类型规则，你基本上没有什么必然是它所说的那样。

如果你想要这样的情况，那么在“C”中编程。不要乱用假装使用 OOP 语言功能编写 OOP 代码。只需使用 struct 来保存您的数据。让工会无处不在。放弃使用类型转换。

您的程序可能无法可靠运行，但您将能够绕过 Java 和 C++ 等语言引入的任何限制，以使程序更可靠、更易于阅读和更易于编写/修改。

在像 SmalTalk 或 Python 这样的动态编程语言中，您基本上可以在运行时撕下蝴蝶的翅膀。但只能通过更改/破坏对象的类型。

这样做不会给你买任何东西。有一些编码/设计技术和设计模式可以让您完成与此类似的任何“好”结果。

最好考虑一下您在应用程序中到底要做什么，然后尝试找到最安全/最简单的方法来使用合理的技术来完成它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-15T11:41:10.140

我认为您应该将此问题视为您的接口和类设计存在缺陷的明确指示。即使您可以在 Java 中做到这一点（我认为您做不到），您也不应该这样做。

如何重新分解 ParentClass，以便您将 SomeInterface 实现与您在 ChildClass 中想要的实现分开。也许您需要 ParentClass 和 ChildClass 的公共基类。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-15T13:14:14.383

我看不出这会是怎样一种合理的做法，但是您*可以*使用 Shigeru Chiba 等人创建的优秀包 Javassist 动态更改一个类。使用它，您可以在类中添加和删除功能，然后使用这些类的实例而不保存为类文件。

动态的，有趣的，对其他人来说完全令人困惑。谨慎使用是我的建议，但在我看来，它会让你成为更好的程序员。

（我相信 ASM 以类似的方式工作，但到目前为止我还没有尝试过。它似乎在使用 JVM 的非 Java 语言创建者中非常流行，所以它可能很好。）

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-10-15T11:37:49.150

也许您有一个可以设计更好解决方案的特定案例，但对于一般案例，您需要一些黑魔法。最终[Javassist](http://www.csg.is.titech.ac.jp/~chiba/javassist/)可以用来“破解”你的对象，但我不太确定。

# windows-xp - 如何使用 Windows XP 中的计算机管理工具从 MSMQ 中删除消息

> ID：204401
> 
> 赞同：2
> 
> 时间：2008-10-15T11:31:15.013
> 
> 标签：windows-xp, msmq

计算机管理 -> 服务和应用程序 -> 消息队列

如何从特定队列中删除消息？在我看来，有某种方法，但我现在找不到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2019-12-10T15:55:21.100

在 Windows 10 中，您可以在计算机管理 --> 服务和应用程序 --> 消息队列中清空队列，方法是右键单击队列并选择所有任务 --> 清除：

[![在此处输入图像描述](https://i.stack.imgur.com/WON1y.jpg)](https://i.stack.imgur.com/WON1y.jpg)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T11:49:09.580

好吧，MMC 无法删除有害消息。

您可以尝试[QueueExplorer](http://www.cogin.com/mq/download.php)，也许这会对您有所帮助，或者您必须以编程方式解决您的问题

# episerver - 启动 EPiServer 网站时出现异常

> ID：204404
> 
> 赞同：2
> 
> 时间：2008-10-15T11:33:18.800
> 
> 标签：episerver

我们正在开发一个基于 EPiServer 的网站，并尝试将我们的最新版本部署到 WinXP IIS6 机器上。

浏览网站时，我们得到以下堆栈跟踪

```
[ClassFactoryException: ClassFactory not initialized]
   EPiServer.BaseLibrary.ClassFactory.get_Instance() +123
   EPiServer.BaseLibrary.Context.get_Repository() +14
   EPiServer.WorkflowFoundation.StorageProviders.ObjectStoreStorageProvider.VerifyCommonSchemas() +15
   EPiServer.WorkflowFoundation.AspNetWorkflowManager.get_StorageProvider() +44
   EPiServer.WorkflowFoundation.AspNetWorkflowManager.Initialize(Boolean lazyLoading) +589
   EPiServer.WorkflowFoundation.AspNetWorkflowManager.get_InstanceHandler() +16
   EPiServer.WorkflowFoundation.Workflows.ApprovalService..ctor() +93

[TargetInvocationException: Exception has been thrown by the target of an invocation.]
   System.RuntimeTypeHandle.CreateInstance(RuntimeType type, Boolean publicOnly, Boolean noCheck, Boolean& canBeCached, RuntimeMethodHandle& ctor, Boolean& bNeedSecurityCheck) +0
   System.RuntimeType.CreateInstanceSlow(Boolean publicOnly, Boolean fillCache) +103
   System.RuntimeType.CreateInstanceImpl(Boolean publicOnly, Boolean skipVisibilityChecks, Boolean fillCache) +261
   System.Activator.CreateInstance(Type type, Boolean nonPublic) +66
   EPiServer.WorkflowFoundation.WorkflowSystem.RegisterServices(IWorkflowManager manager, WorkflowSettingsElement configuration) +338
   EPiServer.WorkflowFoundation.WorkflowSystem.Init(HttpApplication context) +240
   System.Web.HttpApplication.InitModules() +267
   System.Web.HttpApplication.InitInternal(HttpContext context, HttpApplicationState state, MethodInfo[] handlers) +1251
   System.Web.HttpApplicationFactory.GetNormalApplicationInstance(HttpContext context) +243
   System.Web.HttpApplicationFactory.GetApplicationInstance(HttpContext context) +106
   System.Web.HttpRuntime.ProcessRequestInternal(HttpWorkerRequest wr) +214 
```

我用谷歌搜索了它，并访问了 EPiServer 论坛，但我没有找到任何具体的建议或解决方案。有没有其他人遇到过这个？

罗斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T21:02:28.360

配置文件是为 IIS7 编写的，但您在 Studio 中构建 webserver 需要一个 IIS6 Sonfig 文件。我已经在 ny EPiServer notes [http://epiwiki.se/troubleshooting/classfactory-not-initialized中写过这个](http://epiwiki.se/troubleshooting/classfactory-not-initialized)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-09T13:38:01.247

我冒昧地在这里猜测，但是您是否偶然在 EPiServer 5 SP 2 上进行开发并在 EPiServer 5 SP 3 上进行部署？

在 EPiServer 5 SP3 中，对 EPiServer 如何处理应用程序的初始化进行了一些改造。这些更改使其无法挂钩 Application_Start 中的数据工厂事件。相反，您需要首先挂钩 Application_FirstBeginRequest，然后我们有一个 DataFactory 的实例可以使用。

[推荐阅读](http://world.episerver.com/Forum/Pages/Thread.aspx?id=23087&epslanguage=en)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-22T19:16:36.390

绝对听起来像一个配置错误。正如 Mattias 所说，默认的 web.config 是针对 IIS7 的。这可能会在运行 IIS6 或 Cassini 时导致问题。

# c# - 在 DataRow 中设置项目的值不起作用

> ID：204406
> 
> 赞同：4
> 
> 时间：2008-10-15T11:33:39.470
> 
> 标签：c#, datarow

我正在尝试将 DataTable 中的所有 DateTime 值转换为字符串。这是我使用的方法：

```
private static void ConvertDateTimesToStrings(DataTable dataTable)
{
    if (dataTable == null)
    {
        return;
    }

    for (int rowIndex = 0; rowIndex < dataTable.Rows.Count; rowIndex++ )
    {
        for (int i = 0; i < dataTable.Columns.Count; i++)
        {
            DateTime dateTime;
            try
            {
                dateTime = (DateTime)dataTable.Rows[rowIndex][i];
            }
            catch (InvalidCastException)
            {
                continue;
            }
            dataTable.Rows[rowIndex][i] = dateTime.ToString("dd.MM.yyyy hh:mm:ss");
        }
    }
} 
```

在这条线工作之后：

```
dataTable.Rows[rowIndex][i] = dateTime.ToString("dd.MM.yyyy hh:mm:ss"); 
```

我检查了 dataTable.Rows[rowIndex][i] 的值，发现它仍然是 DateTime，而不是字符串。为什么会发生这种情况，我该如何解决？

编辑：我正在尝试这样做，因为我正在与 api 作斗争，不幸的是我无法选择使用哪个组件。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-15T11:41:16.227

这根本行不通，因为您没有更改底层数据类型。

您有一个 DataTable，其中有一列的数据类型为 DateTime。

您可以为其分配一个字符串，但它会转换回日期时间。

为什么要将其更改为格式化字符串？难道你不能只在需要显示它时格式化，并作为 DateTime 处理，直到你必须显示它？

**更新：**如果您在尝试转换之前检查列的类型也会更好，它可以更快：

```
if (dataTable.Columns[0].DataType == typeof(DateTime))
{
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-15T11:41:27.147

它可能已确定列数据类型是日期时间，并且在您将值保存回其中时将值重新装箱为日期时间。

试试这个... 在数据表上创建一个新列作为 TypeOf(String)，并将字符串值保存到该列中。复制所有值后，删除日期时间列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T12:20:39.033

它不起作用，因为该列的 DataType 仍然是 DateTime，它会将字符串转换回 datetime。我建议在生成 API 消息时将日期格式化为字符串。如果您仍需要为日期时间值生成字符串列

```
foreach (DataColumn column in dataTable.Columns) {
  if (column.DataType == typeof(DateTime)) {
    dataTable.Columns.Add(column.ColumnName + "_string", typeof(string));
  }
}

foreach (DataRow row in dataTable.Rows) {
   foreach (DataColumn column in dataTable.Columns) {
     if (column.DataType == typeof(DateTime)) {
       row[column.ColumnName + "_string"] = row[column.ColumnName].ToString("dd.MM.yyyy hh:mm:ss");
     }
   }
} 
```

然后您可以删除所有 DateTime 列或使用 dataTable.Select() 仅获取您需要的列。PS：我没有测试代码，这取决于你。

# asp.net - 如何在 ASP.NET Trace 中增加信息

> ID：204412
> 
> 赞同：0
> 
> 时间：2008-10-15T11:36:56.607
> 
> 标签：asp.net, performance, trace

我已经对我的应用程序的后端进行了一些性能改进，并且为了向 GUI 的最终用户展示好处，我们一直在使用 Trace.axd 页面进行计时。（前端是 .Net 1.1，后端是 Java，通过 Web 服务连接。）

但是，这些时间显示新旧后端之间没有区别。

通过在后端放置一个断点并将请求保持 30 秒，我可以从 Trace.axd 中看到 POST 需要 3 毫秒，而 GET 需要 4 秒。我错过了大约26s...

POST应该是性能提升的地方，但是Trace页面上的时间似乎只包括发送请求的时间，而不是返回的时间。

有没有办法增加跟踪中信息的粒度以包括整个请求？还是有其他方法可以进行我需要的测量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T14:43:47.060

好吧，我最终得到了我想要的东西。问题是 IIS 跟踪不包括 POST 返回所需的时间。

我发现我可以使用 Trace.Write() 将自定义条目添加到跟踪日志中，甚至可以使用 Trace.Write(string category, string message) 添加类别。

在 POST 完成后执行的代码中添加对 Trace.Write() 的调用给了我一个更好的数字。

尽管如此，它仍然不是很理想，因为它是自定义的，我有责任把它放在尽可能接近 POST 周期的末尾。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T12:23:02.333

我不确定您是如何在 .NET 端发出请求的，但我假设某处涉及到 HttpWebRequest。我希望 HttpWebRequest.GetResponse() 在收到响应标头后立即返回。这样，您可以在其余部分仍在下载时开始处理大型响应的开始。如果您的跟踪消息是在调用 GetResponse 之前和之后立即出现的，那么您将看不到后端的整个执行时间。您可以在关闭响应后立即添加跟踪消息吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T12:36:11.980

跟踪输出未显示您在制动点中花费的所有时间是不正常的。您是否检查了总时间列以查看它是否与您在请求中花费的时间相匹配？不要忘记其中一列仅显示自前面的跟踪语句以来所花费的时间。

如果您想在跟踪输出中获得更精细的数据，您可以添加自己的。TraceContext 类有两个方法，Warn 和 Write，它们在输出中添加行（warn 将其添加为红色）。

TraceContext 可以从每个页面或控件访问：只需使用 this.Trace.Warn() 或 this.Trace.Write() （我认为它也可以通过 HttpContext 类访问）。

# python - 无法在 mod_python 下获取类的单独实例

> ID：204427
> 
> 赞同：2
> 
> 时间：2008-10-15T11:47:27.350
> 
> 标签：python, apache, mod-python

我正在尝试在 Apache 2.2 / mod_python 3.2.8 下运行一些 python 代码。最终代码执行 os.fork() 并产生 2 个独立的长期运行进程。这些进程中的每一个都必须创建一个类的单独实例，以避免并行流中任何可能的冲突。

```
class Foo(object):
   pass

kidprocs = []

for kid in ('kid1', 'kid2'):

  pid = os.fork()
  if pid:
    # parent
    kidprocs.append(pid)
    time.sleep(5)
  else:
    # child

    fooobj = Foo() 
    print "Starting %s in sub-process %s" % (kid, os.getpid())
    print "Kid fooobj: %s" % repr(fooobj) 
    os._exit(0)

for kidproc in kidprocs:
  os.waitpid(kidproc, 0) 
```

这些打印输出如下所示：

```
Starting kid1 in sub-process 20906
    foo obj: <__main__.Foo instance at 0xb7da5fec>

Starting kid2 in sub-process 20909
    foo obj: <__main__.Foo instance at 0xb7da5fec> 
```

如您所见，我为两个子流程获得了相同的对象。你知道为什么它在 mod_python 下会这样吗？有没有办法获得单独的实例？非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T12:05:04.540

函数给出的内存位置`repr()`是虚拟内存中的地址，而不是系统全局内存中的地址。fork() 返回的每个进程都有自己的虚拟内存空间，与其他进程完全不同。它们不共享内存。

**编辑：**根据下面布莱恩的评论，从技术上讲，它们确实共享内存，直到内核决定将它们隔离（当一个孩子写入共享内存的一部分时）。但是，行为实际上是相同的。

您的程序的结构是相同的，因此 对于每个孩子的每个相同对象， python**在每个进程的不同虚拟内存存储中使用相同的虚拟内存位置。**

如果你实际修改对象的内容并测试它们，你会发现即使内存位置看起来相同，但两者是完全不同的对象，因为它们属于两个不同的进程。实际上，您不能从另一个修改一个（没有某种进程间通信来调解）。

# javascript - 是否有任何工具可以将 SVG 数据转换为 Canvas 友好的输入？

> ID：204431
> 
> 赞同：2
> 
> 时间：2008-10-15T11:49:02.200
> 
> 标签：javascript, xml, svg

是否有任何工具可以将 SVG (XML) 数据转换为 Canvas 友好的输入？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-08-15T02:22:13.097

看看canvg。它是一个 JavaScript 库，可以解析 SVG 并渲染到指定的画布元素中：

[http://code.google.com/p/canvg/](http://code.google.com/p/canvg/)

还有一篇 Ajaxian 文章（但我每篇文章只能发布一个链接），标题为“CanVG：使用 Canvas 渲染 SVG 文件”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T13:47:23.287

不，我不这么认为。SVG 实际上与 Canvas 有很大不同。SVG 是一种矢量图形描述语言，而画布是由指令集以编程方式“绘制”的。此外，Canvas 实际上根本不是基于矢量的。

看看[Raphael Javascript 库](http://www.raphaeljs.com/)。它的 API 将根据浏览器的功能绘制 SVG/Canvas/VML。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T13:50:09.273

Dojo 还支持渲染 SVG。

请参阅 dojoX 包。 [链接文本](http://dojotoolkit.org/projects/dojox)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-08T20:21:58.617

看看[这篇](http://www.svgopen.org/2009/papers/54-SVG_vs_Canvas_on_Trivial_Drawing_Application/)来自 svg 公开会议的文章。在中间的某个地方，它讨论了一种使用服务器端渲染结合 svg 和 canvas 的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-10T20:38:31.820

我使用 Canvg 作为基础来创建这个在线工具：

[www.professorcloud.com/svg-to-canvas](http://www.professorcloud.com/svg-to-canvas)

它从 SVG 输入创建 JavaScript Canvas 函数。没有完成整个 SVG 规范，但足够有用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-06-14T19:08:51.063

[Fabric.js](http://github.com/kangax/fabric.js)有一个 SVG-to-canvas 解析器。这是一个[演示](http://fabricjs.com/kitchensink/)。请注意单击侧边栏 SVG 部分中的按钮如何获取 SVG 文档并将它们实时解析到画布上。

您甚至可以操作那些画布渲染的对象（缩放、移动、旋转等）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-15T14:17:10.387

看看 XSLT。

# .net - 如果出现故障，如何自动重新建立双工通道？

> ID：204437
> 
> 赞同：14
> 
> 时间：2008-10-15T11:51:51.180
> 
> 标签：.net, wcf, duplex, fault-tolerance

我正在使用 WCF 在 .Net 3.5 中开发客户端/服务器应用程序。基本上，长时间运行的客户端服务（在多台机器上）通过 netTcpBinding 建立到服务器的双工连接。然后服务器使用客户端的回调合约来执行某些按需操作，客户端以异步方式响应（我认为这是相当标准的东西）。我将 DuplexClientBase 类子类化以处理大部分通信。

不幸的是，当任一端出现问题（例如网络故障、意外异常等）时，通道会出现故障/中止，并且所有后续操作都会失败。我通过创建一个 RecoveringClientBase 类解决了非双工通道中的这一限制，该类在客户端出现故障时自动获取并重试操作。

所以我的问题是，是否有确定双工通道何时出现故障的既定方法？我应该在哪里检查这个，在服务器或客户端上？如果做不到这一点，我必须有哪些选项来确保重新建立连接？

**更新：**我正在寻找一些特定于双工通道的建议，其中服务器可能会尝试使用出现故障的回调通道。因此，我需要在频道发生问题时立即重新连接/重新订阅的东西。目前，我正在收听频道的 Closing 事件，如果状态不是已关闭，则重新创建它。它有点工作，但感觉很hacky......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-09T22:00:32.263

我在长时间运行的会话（几分钟-几小时）中经历过片状。我不能确定它是 WCF，我很确定它的网络级别。

我正在考虑完全取消双工。尝试管理连接状态是一件非常麻烦的事情。

我正在考虑在客户端上托管一个服务端点，用于当前属于回调合同的操作。客户端将使用端点详细信息联系服务器，服务器可以将这些存储在某个地方（持久或任何地方）。当服务器需要联系客户端时，它会通过隐藏的端点详细信息打开与客户端的连接。基本上，将双工连接变成 2 个客户端-服务器连接。

没有回答你的问题，但我能感觉到你的痛苦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T14:28:13.987

WCF 团队的 Nicolas Allen 对此提出了建议：

[http://blogs.msdn.com/drnick/archive/2007/11/05/custom-transport-retry-logic.aspx](http://blogs.msdn.com/drnick/archive/2007/11/05/custom-transport-retry-logic.aspx)

他的建议是在渠道层面处理这个问题。通道级别更好一些，因为您可以通过行为将其插入任何绑定的堆栈，而不需要自定义客户端基类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T15:16:46.640

我遇到过一些类似的问题，在我看来，这些长时间运行的调用或多或少不受支持。

WCF 似乎被设计为用于短期运行的调用。服务，被调用，做一些小事情，然后完成。

我将我的应用程序重构为更小的工作项。因此，我现在得到了许多较小的项目，而不是一件长期运行的大型项目。当然，有时这是不可能实现的。然后我必须为稳定的网络连接祈祷（可以捕捉到异常，所以我认为故障并不是真正的问题）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-18T07:26:17.367

我认为你真的应该听听错误的事件。您可以在两端收听，客户端我认为您已经在处理，服务器端是 OperationContext.Current.Channel.events。

我还没有找到一种自动重新发送消息的方法，因为您的回调通道已经出现故障并且您还不知道新的回调通道，但需要将这些调用保留在服务器的某个位置，直到客户端重新连接。

客户端最终会出现故障，应该重新与服务器握手，服务器应该发出未发送的调用。

基本上，从故障/关闭通道中恢复的唯一方法是用新通道替换它，但是，最关键的部分是您应该真正检测到断开连接，我发现启用可靠会话将在大多数情况下按时引发故障事件案子。或者，您可以在两端发送心跳消息到“测试”通道故障。

# php - 如何从 CakePHP 中的 ajax 调用重定向父页面？

> ID：204438
> 
> 赞同：0
> 
> 时间：2008-10-15T11:51:54.830
> 
> 标签：php, cakephp, redirect

有人知道如何从 ajax 调用重定向父页面吗？我对服务器进行了 ajax 调用，并且从处理调用的控制器函数中，我想转到另一个页面。通常这个函数从当前页面更新一个元素，但在某些情况下我想将浏览器重定向到另一个页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T12:11:43.730

如果您想重定向浏览器中加载的页面，您可能需要在 AJAX 调用中发回某种消息，然后您可以在 javascript 中拦截该消息，然后更改浏览器位置

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T11:56:10.190

您是否尝试过在 AJAX 响应中简单地发送“位置”标头？

# encryption - 在 iSeries 上加密

> ID：204440
> 
> 赞同：2
> 
> 时间：2008-10-15T11:54:36.197
> 
> 标签：encryption, ibm-midrange

有哪些工具可用于加密或密码保护存储在 IFS 上的文件？

*集成文件系统，可从 Windows 访问

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T15:14:41.957

1.  您可以设置对象安全性，以便只有某些用户可以查看文件。
2.  有可供购买的加密工具。还有一些用于加密的内置 API。

以下是一些可供研究的资源：

1.  [场景：使用加密服务 API 的密钥管理和文件加密](http://publib.boulder.ibm.com/infocenter/iseries/v5r4/index.jsp?topic=/apis/qc3Scenario.htm)
2.  [安全的下一步](http://www.ibmsystemsmag.com/i5/june04/administrator/8475p4.aspx)
3.  [一种简单的数字加密/解密算法](http://www.itjungle.com/fhg/fhg042705-story01.html)
4.  [加密服务 API](http://publib.boulder.ibm.com/infocenter/iseries/v5r4/index.jsp?topic=/apis/catcrypt.htm)

这些文章中的大多数都涉及加密表中的数据，但这些概念应该可以帮助您加密 IFS 上的文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T18:19:13.710

[或者您可以简单地使用ccrypt](http://ccrypt.sourceforge.net/)或[TrueCrypt](http://www.truecrypt.org/)（可能不是您要查找的内容）从 Windows 框中加密文件。两者都是免费的。就像[GnuPG](http://www.gnupg.org/)一样，它有一个 windows 端口，可能是最好的。

不要忘记带有[PASE](http://publib.boulder.ibm.com/infocenter/systems/scope/i5os/index.jsp?topic=/rzalf/rzalfintro.htm)的 iSeries可以按原样运行许多 AIX 程序。

ccrypt for AIX 几乎肯定可以在 iSeries 上运行并从 QSH 调用。对于 AIX 的 GnuPG 也是如此；它可以在 iSeries 本身上运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T21:52:07.547

iSeries有[PkZIP](http://www.pkware.com/software-pkzip/iseries-file-compression)可以提供加密。

[您还可以使用Java Cryptography](http://java.sun.com/javase/6/docs/technotes/guides/security/crypto/CryptoSpec.html) '滚动自己的' 加密。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-22T14:28:54.013

我们目前正在使用免费的琶音。我们曾经使用 PKZip，但能够用免费的琶音软件替换该工具。似乎运作良好

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-21T13:52:15.137

您可以设置文件的权限，以便只有一组中的用户可以访问它。我认为它的选项 9 我目前无法访问 iseries。

# javascript - JavaScript 中的解构赋值

> ID：204444
> 
> 赞同：16
> 
> 时间：2008-10-15T11:56:07.677
> 
> 标签：javascript, variable-assignment, destructuring

从 JavaScript 1.7 的 Mozilla changlog 中可以看出，它们添加了解构赋值。可悲的是，我不太喜欢这种语法（为什么要写两次 a 和 b？）：

```
var a, b;  
[a, b] = f(); 
```

这样的事情会好很多：

```
var [a, b] = f(); 
```

那仍然是向后兼容的。类似 Python 的解构不会向后兼容。

无论如何，我能想到的 JavaScript 1.5 的最佳解决方案是：

```
function assign(array, map) {
    var o = Object();
    var i = 0;
    $.each(map, function(e, _) {
        o[e] = array[i++];
    });
    return o;
} 
```

其工作原理如下：

```
var array = [1,2];
var _ = assign[array, { var1: null, var2: null });
_.var1; // prints 1
_.var2; // prints 2 
```

但这真的很糟糕，因为 _ 没有任何意义。它只是一个空壳来存储名称。但遗憾的是它是必需的，因为 JavaScript 没有指针。从好的方面来说，您可以在值不匹配的情况下分配默认值。另请注意，此解决方案不会尝试对数组进行切片。所以你不能做类似的事情`{first: 0, rest: 0}`。但是，如果有人想要这种行为，那很容易做到。

什么是更好的解决方案？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-15T21:25:39.557

首先，`var [a, b] = f()`在 JavaScript 1.7 中运行良好 - 试试吧！

*其次，您可以使用以下方法稍微*平滑使用语法`with()`：

```
var array = [1,2];
with (assign(array, { var1: null, var2: null }))
{
   var1; // == 1
   var2; // == 2
} 
```

当然，这不允许您修改现有变量的值，因此恕我直言，它比 JavaScript 1.7 功能的用处要小得多。在我现在编写的代码*中*，我只是直接返回对象并引用它们的成员——我将等待 1.7 的特性变得更广泛可用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-15T15:47:18.397

您不需要虚拟“_”变量。您可以使用窗口对象范围直接创建“全局”变量：

```
window["foo"] = "bar";
alert(foo); // Gives "bar" 
```

这里还有几点：

*   我不会将这个函数命名为“assign”，因为这个术语太笼统了。
*   为了更接近 JS 1.7 语法，我会让函数将目标作为第一个参数，将源作为第二个参数。
*   使用对象文字来传递目标变量很酷，但可能与 JS 1.7 解构混淆，其中目标实际上是一个对象而不是数组。我更喜欢只使用逗号分隔的变量名列表作为字符串。

这是我想出的：

```
function destructure(dest, src) {  
    dest = dest.split(",");  

    for (var i = 0; i < src.length; i++) {  
        window[dest[i]] = src[i];  
    }  
}  

var arr = [42, 66];  

destructure("var1,var2", arr); 

alert(var1); // Gives 42
alert(var2); // Gives 66 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-22T19:19:23.973

这是我在 PHPstorm 10 中所做的：

*文件 -> 设置 -> 语言和框架 -> ...*

... 将 JavaScript 语言版本设置为例如 JavaScript 1.8.5...

*-> 单击应用。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-14T19:48:56.000

在标准 JavaScript 中，我们习惯了各种丑陋，使用中间变量模拟解构赋值也不错：

```
function divMod1(a, b) {
    return [ Math.floor(a / b), a % b ];
}

var _ = divMod1(11, 3);
var div = _[0];
var mod = _[1];
alert("(1) div=" + div + ", mod=" + mod ); 
```

但是我认为以下模式更符合规范：

```
function divMod2(a, b, callback) {
    callback(Math.floor(a / b), a % b);
}

divMod2(11, 3, function(div, mod) {
    alert("(2) div=" + div + ", mod=" + mod );
}); 
```

请注意，我们不是将两个结果作为数组返回，而是将它们作为参数传递给回调函数。

（参见运行在[http://jsfiddle.net/vVQE3/](http://jsfiddle.net/vVQE3/)的代码）

# development-environment - 对于开发人员来说，什么是好的协作网站？

> ID：204449
> 
> 赞同：3
> 
> 时间：2008-10-15T11:57:20.843
> 
> 标签：development-environment

我们在世界各地有许多需要与之合作的开发人员。

我们需要的功能是：

1.  某种白板，多个用户可以查看和更新​​。
2.  一个私人维基。
3.  用于管理工作量的票证系统。
4.  源代码控制系统会很好，但不是必需的。

理想情况下，这应该已经托管在某个地方（并且是免费的），或者如果任何软件都可以做到这一点，而且价格也不贵，那就没问题了。

理想情况下，所有这些功能都将在标准 http 上运行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-15T12:00:17.590

我喜欢[Assembla](http://www.assembla.com)，其中包括：
- SVN
- Trac
- MessageBoard
- Wiki
和其他一些功能。您还可以为每个项目获得 200MB 的可用空间...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-15T12:00:01.210

大本营可能会提供您需要的一些东西：[http ://www.basecamphq.com/](http://www.basecamphq.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T12:14:23.100

[Slicehost](http://www.slicehost.com/) + [Trac](http://trac.edgewall.org/) + [Subversion](http://subversion.tigris.org/) / [Mercurial](http://www.selenic.com/mercurial/wiki/) / [Git](http://git.or.cz/) / [Bazaar](http://bazaar-vcs.org/)。

不幸的是，我不知道任何开源白板:(

配置自己的机器的好处是你可以配置任何你想要的。如果您的开发团队认为 bzr 是他们想要的方式，那将是一个真正的耻辱，但是您托管的项目管理应用程序并不能很好地支持它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-04T20:51:02.647

### [GitHub](https://github.com/)

免费计划适用于开源，但也可用于私人项目。包括：

*   维基
*   问题跟踪器
*   源代码控制

# git - git: squash/fixup 较早的提交

> ID：204461
> 
> 赞同：24
> 
> 时间：2008-10-15T12:05:07.567
> 
> 标签：git

假设你有：

```
A-B-C 
```

现在你的构建/测试失败了。该修复程序应合并到 A 中。我当前的工作流程是这样的：

```
$ git commit -m "fixA"

A-B-C-fixA

$ git rebase -i A~1 
```

并在 A 中压缩 fixA，结果为：

```
A'-B-C 
```

是否有命令可以执行以下操作：

```
A-B-C + (index with fix for A)

$ git commit -supperdupper A 
```

结果：

```
A'-B-C 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2011-01-05T17:39:31.030

*如果您只是在寻找修复早期提交的简单解决方案，请阅读问题！它解释了一切。但是由于 Elmarco 要求采用一种巧妙的方式，所以我们开始：*

从 Git 1.7.0 开始，有一个`--autosquash`选项[`rebase`](https://www.kernel.org/pub/software/scm/git/docs/git-rebase.html)，可以满足您的要求。还有使事情变得更容易的`--fixup`和`--squash`选项。[`commit`](https://www.kernel.org/pub/software/scm/git/docs/git-commit.html)通过一些别名，您甚至可以将整个事情变成一个命令。

我建议升级到最新的 Git 以获得最大的效果：

```
git/Documentation/RelNotes $ grep -i -A1 autosquash\\\|fixup *
1.7.0.txt: * "git rebase -i" learned new action "fixup" that squashes the change
1.7.0.txt-   but does not affect existing log message.
--
1.7.0.txt: * "git rebase -i" also learned --autosquash option that is useful
1.7.0.txt:   together with the new "fixup" action.
1.7.0.txt-
--
1.7.3.txt: * "git rebase -i" peeks into rebase.autosquash configuration and acts as
1.7.3.txt:   if you gave --autosquash from the command line.
1.7.3.txt-
--
1.7.4.txt: * "git commit" learned --fixup and --squash options to help later invocation
1.7.4.txt-   of the interactive rebase.
--
1.7.4.txt: * "git rebase --autosquash" can use SHA-1 object names to name which
1.7.4.txt:   commit to fix up (e.g. "fixup! e83c5163").
1.7.4.txt- 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-19T14:21:20.040

我[创建了一些别名](https://gist.github.com/bkeepers/4986257)，以便更容易使用git 1.7 中添加的`git commit --fixup`和命令。`git commit --squash`将这些添加到您的`~/.gitconfig`：

```
[alias]
  fixup = !sh -c 'REV=$(git rev-parse $1) && git commit --fixup $@ && git rebase -i --autosquash $REV^' -
  squash = !sh -c 'REV=$(git rev-parse $1) && git commit --squash $@ && git rebase -i --autosquash $REV^' - 
```

用法：

```
$ git commit -am 'bad commit'
$ git commit -am 'good commit'

$ git add .          # Stage changes to correct the bad commit
$ git fixup HEAD^    # HEAD^ can be replaced by the SHA of the bad commit 
```

错误的提交可以是多次提交。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-07-09T14:21:53.227

我当前的 git 工作流程是如此`--fixup`/`--squash`密集，以至于我编写了一个新`git-fixup`命令来自动处理大多数烦人的位：

*   `git fixup`显示在最新提交下分组的修改后的文件，这些文件涉及*相同的文件*
*   `git fixup -a`将所有这些更改作为`--fixup`更改与其相应的“父”提交提交
*   `git fixup -r``git rebase --autosquash`对所有修复提交执行自动操作

很多变化使得仅上面的三个命令就足以完成工作，无需复制粘贴 commit-id 或通过阅读`git log`来找到正确的`--fixup`目标。

来源：[https ://github.com/ohmu/git-crust](https://github.com/ohmu/git-crust)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-04-04T13:06:29.440

如果你想压缩最后两个提交，那么你必须调用

```
git rebase --interactive <3rd last commit> 
```

然后，您需要选择最后一个提交并压缩倒数第二个提交。您无法压缩历史的最高提交。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T12:21:25.363

如果您正在与其他人共享您正在进行更改的分支，那么您正在做的事情是危险的。在您的情况下，您正在**重写**提交 A 并将 B 和 C 重新定位在新 A 之上，这是一个全新的对象。任何已经将旧 A 拉入其存储库的人最终都可能破坏他们的存储库，因为存储库中的历史将“神奇地”改变。他们的 git 无法知道历史已被改写。

由于这个事实，Git 开发人员故意不让这件事变得容易，因为您必须意识到执行此类操作的后果。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-30T18:56:32.650

我认为问题的根源在于 git（以及通常的版本控制）迫使您根据更改的顺序进行思考，但是变更集或功能分支或任何您称之为有凝聚力的相关更改组通常在逻辑上不是顺序的. 编写代码的顺序是偶然的，不一定与阅读它的顺序有关。

我没有解决方案，但我编写了一个[Perl 脚本](https://gist.github.com/oktal3700/cafe086b49c89f814be4a7507a32a3f7)来帮助自动化重写历史的过程。它类似于@MikaEloranta 的 Python 脚本，我在编写它时没有看到它。

`commit --fixup`并且`rebase --autosquash`很棒，但他们做得还不够。当我有一系列提交`A-B-C`并且我在我的工作树中编写了更多属于一个或多个现有提交的更改时，我必须手动查看历史记录，确定哪些更改属于哪些提交，暂存它们并创建`fixup!`提交。但是 git 已经获得了足够的信息来为我做所有这些事情。

对于`git diff`脚本中的每个块，`git blame`用于查找最后触及相关行的提交，并调用`git commit --fixup`以编写适当的`fixup!`提交，基本上与我之前手动执行的操作相同。

如果脚本无法将一个大块解析为一个单一的、明确的提交，它会将其报告为一个失败的大块，您将不得不回退到那个手动方法。如果您在两个单独的提交中两次更改了一行，则该脚本会将对该行的更改解析为这些提交中的最新一次，这可能并不总是正确的解决方案。恕我直言，在“正常形式”功能分支中，您不应该在两次不同的提交中两次更改一行，每次提交都应该呈现它所触及的行的最终版本，以帮助审阅者。但是，它可能发生在错误修复分支中，以设计一个示例，该行`foo(bar());`可以被提交 A（重命名`foo`为`fox`）和提交 B（重命名`bar`为`baz`）触及。

If you find the script useful, please feel free to improve and iterate on it and maybe one day we'll get such a feature in `git` proper. I'd love to see a tool that can understand how a merge conflict should be resolved when it has been introduced by an interactive rebase.

# code-signing - 代码签名证书有什么特别之处？

> ID：204463
> 
> 赞同：11
> 
> 时间：2008-10-15T12:05:37.893
> 
> 标签：code-signing, certificate

它与我可以通过 makecert 生成或从某个权威机构购买的任何其他证书不同吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-10T12:04:48.897

正如*Mile L*和*Boot to the Head*所提到的，扩展密钥使用决定了密钥的用途。

大多数商业证书颁发机构（Verisign 等）为单一目的或尽可能少地颁发证书。

他们利用这种缩小范围的目的为证书开辟不同的市场，然后相应地定价。

当（在大多数情况下）生成的证书相同时，您会看到他们为 Windows 程序集/Java/Office/Adobe Air 等销售不同的对象签名证书。

例如，这里发布的[Comodo](https://secure.comodo.net/products/frontpage?ap=Multisigner&area=CodeSigning&product=8)代码签名证书可以对 Java 小程序、WebStart 应用程序、Firefox 扩展甚至 Windows 程序集进行签名。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-15T12:19:32.653

用于签署软件的证书与用于签署任何文档的证书相同。签名软件的不同之处在于签名最终驻留的位置。在典型的文档签名中，签名只是附加到原始文档中。出于显而易见的原因，您不能将签名附加到大多数类型的软件（一些解释语言会允许这样做，但我不知道它是否在实践中完成）。

签名问题的解决方案因执行环境而异。对于可执行二进制文件，签名通常存储在单独的文件中。在 Java 中，您可以在可执行 JAR 文件中嵌入签名。

Microsoft 有一个很好的参考来[介绍签名过程](http://msdn.microsoft.com/en-us/library/ms537361.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T17:28:38.300

据我所知，证书有一个“密钥使用”属性，它描述了证书的用途：SSL 服务器、代码签名、电子邮件签名等。所以我认为这取决于操作系统、网络浏览器或 e - 邮件客户端，检查这些位。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-15T12:13:14.587

这取决于你用它做什么。如果您希望证书在 SSL 通信中被浏览器接受，则必须在浏览器中安装根证书。权威机构生成的证书已经在浏览器中安装了它们的根证书。

如果您只是使用证书来签署程序集，那么您就不需要它。这取决于谁在检查证书以及他们是否关心根是否是已知的权威。

更多在这里：

[http://en.wikipedia.org/wiki/Root_certificate](http://en.wikipedia.org/wiki/Root_certificate)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-21T15:18:43.117

当证书被调用时，它声称要执行的角色与识别一样重要。这不仅与身份有关，还与角色授权有关。电子邮件保护证书不应执行服务器身份验证。安全问题要求对通过单个证书赋予的权力进行必要的限制。底层 API 应该强制正确使用，无论是通过操作系统还是 .NET Framework 等抽象。

有不同的证书类型，因为在身份验证和授权中需要它们的角色非常不同。允许不同的证书类型和层次结构允许证书链模型，如证书上的“证书路径”中所示。服务器身份验证证书将需要在受信任的根证书中的某处具有顶级 CA 证书......或者是最终实现的证书家族树的一部分。我敢肯定，第三方证书颁发机构会根据功能和信任程度对它们进行定价。

*Boot To The Head*是正确的......有一个增强的密钥使用属性，它提供了证书声称角色的描述（例如服务器身份验证；或者在我的 CA 证书的情况下：数字签名、证书签名、关闭线 CRL 签名，CRL 签名）。查看证书属性中的详细信息，您会发现它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-16T01:14:32.450

我还要补充一点，必须对 .NET 程序集进行强命名（这需要对其进行签名）才能添加到 GAC。

有不同类型的证书...来自 Win 2003 服务器中捆绑的 CA，您可以请求：

*   客户端认证
*   电子邮件保护
*   服务器认证
*   代码签名
*   时间戳签名
*   IPSec
*   其他

# sql - 提高 FOR XML 显式性能

> ID：204464
> 
> 赞同：2
> 
> 时间：2008-10-15T12:06:16.267
> 
> 标签：sql, sql-server, xml, explicit

尽管使用 SQL FOR XML EXPLICIT 很麻烦，但我发现自己经常使用它。因为它允许完全控制生成的 XML 文档。

我的问题是性能问题，有时生成一个描述一些财务数据（发票、账单等）的 XML 文档只需要一个月时间就需要 5 分钟以上！

所以我一直在寻找提高其性能的技巧。**甚至是其他可以带来性能优势的替代方法。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T12:57:54.153

如果 XML 在生成后被传递给某个应用程序（例如 Web 应用程序）进行处理，一种替代方法是在 SQL 中生成正常的记录集，并让调用应用程序创建 XML 文档。或者，SQL 可以使用 FOR XML AUTO 生成比您需要的更简单的 XML 格式，然后调用应用程序可以使用 XSLT 样式表将其转换为正确的 XML 格式。

当然，无论是否格式化为 XML，您都需要确保原始 SQL 没有潜在的性能问题（例如，您的数据库是否缺少某些索引？）

# iphone - 如何从 iPhone 访问 SOAP 服务

> ID：204465
> 
> 赞同：225
> 
> 时间：2008-10-15T12:07:17.937
> 
> 标签：iphone, ios, web-services, soap, wsdl

我正计划为 iPhone 开发一个应用程序，该应用程序必须访问几个 SOAP 服务。在对 iPhone SDK 进行一些基本检查时，我找不到任何对访问 SOAP 服务的支持，通过谷歌搜索得出的结论是 iPhone SDK 中不支持 SOAP。

因此，如果我确实想构建那个应用程序，我需要想出一种方法来从 iPhone 访问 SOAP 服务。最好的方法是什么？有什么最佳实践吗？是否有人已经使用 iPhone SDK 中的功能编写了一个库来访问 SOAP 服务？

（由于我需要访问的服务由另一方公开，并且他们只将其公开为 SOAP，不幸的是，它不是切换到另一种类型的接口（例如基于 REST 的 API）的选项。

下吕

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-10-15T16:17:19.757

一个字：不要。

好吧，显然这不是一个真正的答案。但仍应不惜一切代价避免使用 SOAP。;-) 是否可以在 iPhone 和网络服务之间添加代理服务器？或许可以为您将 REST 转换为 SOAP？

您*可以*尝试[CSOAP](http://csoap.sourceforge.net/)，这是一个依赖于 libxml2（包含在 iPhone SDK 中）的 SOAP 库。

我已经为 OSX 编写了自己的[SOAP 框架](http://toxic-public.googlecode.com/svn/trunk/Frameworks/ToxicSOAP/)。但是它没有得到积极维护，需要一些时间才能移植到 iPhone 上（你需要先用 TouchXML 替换[NSXML](http://code.google.com/p/touchcode/wiki/TouchXML)）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-22T14:04:37.183

我的解决方案是使用 PHP 让代理服务器接受 REST、发出 SOAP 请求并返回结果。

实施时间：15-30分钟。

不是最优雅，但坚固。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-15T18:14:36.587

我一直在低级别（XML 生成和解析）上滚动自己的访问，以处理偶尔需要从 Objective-C 执行 SOAP 样式请求。也就是说，有一个名为 SOAPClient ( [soapclient](http://ditchnet.org/soapclient/) ) 的库可用，它是开源的（BSD 许可）并可在可能感兴趣的 Google 代码 ( [mac-soapclient ) 上使用。](http://code.google.com/p/mac-soapclient/)

我不会证明它的能力或有效性，因为我从未使用过它或不得不使用它的 API，但它是可用的，并且可能会根据您的需要为您提供快速解决方案。

Apple 曾经有一个非常糟糕的实用程序，称为 WS-MakeStubs。我认为它在 iPhone 上不可用，但您可能还对旨在替换它的开源库感兴趣 - 代码生成 Objective-C 用于与 SOAP 客户端交互。同样，我没有使用它——但我已经在我的笔记中标记了它：[wsdl2objc](http://code.google.com/p/wsdl2objc/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-29T15:53:48.337

您可以使用我找到的工具进行连接[http://www.wsdl2code.com](http://www.wsdl2code.com)

```
SampleServiceProxy *proxy = [[SampleServiceProxy alloc]initWithUrl:@"YOUR
        URL" AndDelegate:self];

[proxy GetDouble];
[proxy GetEnum];
[proxy getEnum:kTestEnumTestEnum2];
[proxy GetInt16];
[proxy GetInt32];
[proxy GetInt64];
[proxy GetString];
[proxy getListStrings]; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-12-25T14:42:03.073

这是一个使用 SOAP 服务格式执行 API 调用 的**swift 4示例代码。**

```
 func callSOAPWSToGetData() {

        let strSOAPMessage =
            "<?xml version=\"1.0\" encoding=\"utf-8\"?>" +
                "<soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">" +
                "<soap:Body>" +
                "<CelsiusToFahrenheit xmlns=\"http://www.yourapi.com/webservices/\">" +
                "<Celsius>50</Celsius>" +
                "</CelsiusToFahrenheit>" +
                "</soap:Body>" +
        "</soap:Envelope>"

        guard let url = URL.init(string: "http://www.example.org") else {
            return
        }
        var request = URLRequest.init(url: url)
        let length = (strSOAPMessage as NSString).length
        request.addValue("application/soap+xml; charset=utf-8", forHTTPHeaderField: "Content-Type")
        request.addValue("http://www.yourapi.com/webservices/CelsiusToFahrenheit", forHTTPHeaderField: "SOAPAction")
        request.addValue(String(length), forHTTPHeaderField: "Content-Length")
        request.httpMethod = "POST"
        request.httpBody = strSOAPMessage.data(using: .utf8)

        let config = URLSessionConfiguration.default
        let session = URLSession(configuration: config)
        let task = session.dataTask(with: request) { (data, response, error) in
            guard let responseData = data else {
                print("Error: did not receive data")
                return
            }
            guard error == nil else {
                print("error calling GET on /todos/1")
                print(error ?? "")
                return
            }
            print(responseData)
            let strData = String.init(data: responseData, encoding: .utf8)
            print(strData ?? "")
        }
        task.resume()
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-15T12:34:40.470

看看[这里这个链接](http://www.remobjects.com)和他们的路线图。他们有 RO|C，可以连接到他们的 Web 服务，其中可能包括 SOAP（我使用肯定包括它的 VCL 版本）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-02-28T14:53:14.420

查看 gsoap，它在[ios_plugin](http://sourceforge.net/projects/gsoap2)下的下载包中包含两个 iOS 示例。该工具将 WSDL 转换为 SOAP 和 XML REST 的代码。

# regex - 是否有 Perl 函数将字符串转换为正则表达式以将该字符串用作模式？

> ID：204467
> 
> 赞同：8
> 
> 时间：2008-10-15T12:08:23.097
> 
> 标签：regex, perl, string

我无法将 Perl grep() 与*可能*包含被解释为正则表达式量词的字符的字符串一起使用。

当 grep 模式为“g++”时出现以下错误，因为“+”符号被解释为量词。下面是 for 程序的输出：

```
1..3
ok 1 - grep, pattern not found
ok 2 - grep, pattern found

Nested quantifiers in regex; marked by <-- HERE
in m/g++ <-- HERE / at escape_regexp_quantifier.pl line 8. 
```

是否有一个修饰符我可以用来指示 grep 量词应被忽略，或者是否有一个函数可以转义量词？

```
#! /usr/bin/perl 

sub test_grep($)
{
    my $filter = shift;
    my @output = ("-r-xr-xr-x   3 root     bin       122260 Jan 23  2005 gcc",
                  "-r-xr-xr-x   4 root     bin       124844 Jan 23  2005 g++");
    return grep (!/$filter/, @output);
}

use Test::Simple tests => 2;

ok(test_grep("foo"), "grep, pattern not found");
ok(test_grep("gcc"), "grep, pattern found");
ok(test_grep("g++"), "grep, pattern found"); 
```

PS：除了上面的回答问题，欢迎大家对上面Perl使用的任何反馈，因为我还在学习中。谢谢

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-15T12:13:08.110

标准方法是`\Q`在变量前使用转义指示符，告诉 Perl 不要将内容解析为正则表达式：

```
return grep (!/\Q$filter/, @output); 
```

在代码中更改该行会产生：

```
1..3
好的 1 - grep，找不到模式
好的 2 - grep，找到模式
好的 3 - grep，找到模式

```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-15T12:15:19.183

我想你正在寻找[quotemeta](http://perldoc.perl.org/functions/quotemeta.html)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-15T12:17:23.377

*除了上面的答案问题，我欢迎任何关于上面 Perl 使用的反馈，因为我还在学习中。谢谢*

我建议您不要使用原型（test_grep 之后的*($) ）。*它们有它们的用途，但在大多数情况下不是，而且绝对不是在这种情况下。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-15T14:31:25.743

> PS：除了上面的回答问题，欢迎大家对上面Perl使用的任何反馈，因为我还在学习中。

一般来说，对于 Perl 编码建议，我可以给出的最佳建议是安装[Perl::Critic](http://search.cpan.org/perldoc?Perl::Critic)并在您的代码上使用[perlcritic](http://search.cpan.org/perldoc?perlcritic)命令。如果你不能这样做，你可以使用[在线 perl 评论工具](http://perlcritic.com/)。如果您手边有[Perl Best Practices](http://oreilly.com/catalog/9780596001735/)的副本，这将有所帮助，因为您`Perl::Critic`已经阅读了这本书，并且会为您提供页码的参考，但是即使您没有这本书，您仍然可以在[Perl 中找到扩展的反馈： :Critic 文档](http://search.cpan.org/dist/Perl-Critic/)部分以`Perl::Critic::Policy::`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-15T15:22:34.967

在这种情况下，我建议使用 qr 创建 Regexp 对象而不是字符串。

```
ok(test_grep(qr/foo/), "grep, pattern not found");
ok(test_grep(qr/gcc/), "grep, pattern found");
ok(test_grep(qr/g\+\+/), "grep, pattern found"); 
```

那么你不需要 \Q 转义。虽然你仍然可以使用它：

```
ok(test_grep(qr/\Qg++/), "grep, pattern found"); 
```

# c# - 在单例对象上使用反射调用方法

> ID：204468
> 
> 赞同：5
> 
> 时间：2008-10-15T12:11:08.957
> 
> 标签：c#, reflection, singleton

所以我有以下内容：

```
public class Singleton
{

  private Singleton(){}

  public static readonly Singleton instance = new Singleton();

  public string DoSomething(){ ... }

  public string DoSomethingElse(){ ... }

} 
```

使用反射如何调用 DoSomething 方法？

我问的原因是因为我将方法名称存储在 XML 中并动态创建 UI。例如，我正在动态创建一个按钮，并告诉它在单击按钮时通过反射调用什么方法。在某些情况下，它会是 DoSomething，或者在其他情况下，它会是 DoSomethingElse。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-15T12:20:50.543

未经测试，但应该可以工作......

```
string methodName = "DoSomething"; // e.g. read from XML
MethodInfo method = typeof(Singleton).GetMethod(methodName);
FieldInfo field = typeof(Singleton).GetField("instance",
    BindingFlags.Static | BindingFlags.Public);
object instance = field.GetValue(null);
method.Invoke(instance, Type.EmptyTypes); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-02-05T07:42:37.187

做得好。谢谢。

对于无法引用远程程序集的情况，这是相同的方法，只需稍作修改。我们只需要知道基本的东西，例如类全名（即命名空间.类名和远程程序集的路径）。

```
static void Main(string[] args)
    {
        Assembly asm = null;
        string assemblyPath = @"C:\works\...\StaticMembers.dll" 
        string classFullname = "StaticMembers.MySingleton";
        string doSomethingMethodName = "DoSomething";
        string doSomethingElseMethodName = "DoSomethingElse";

        asm = Assembly.LoadFrom(assemblyPath);
        if (asm == null)
           throw new FileNotFoundException();

        Type[] types = asm.GetTypes();
        Type theSingletonType = null;
        foreach(Type ty in types)
        {
            if (ty.FullName.Equals(classFullname))
            {
                theSingletonType = ty;
                break;
            }
        }
        if (theSingletonType == null)
        {
            Console.WriteLine("Type was not found!");
            return;
        }
        MethodInfo doSomethingMethodInfo = 
                    theSingletonType.GetMethod(doSomethingMethodName );

        FieldInfo field = theSingletonType.GetField("instance", 
                           BindingFlags.Static | BindingFlags.Public);

        object instance = field.GetValue(null);

        string msg = (string)doSomethingMethodInfo.Invoke(instance, Type.EmptyTypes);

        Console.WriteLine(msg);

        MethodInfo somethingElse  = theSingletonType.GetMethod(
                                       doSomethingElseMethodName );
        msg = (string)doSomethingElse.Invoke(instance, Type.EmptyTypes);
        Console.WriteLine(msg);} 
```

# visual-studio - “云端”的版本控制

> ID：204470
> 
> 赞同：9
> 
> 时间：2008-10-15T12:11:48.580
> 
> 标签：visual-studio, version-control, saas

我是一名使用 Microsoft Visual Studio 处理个人和团体项目的开发人员。我可以在自己的服务器上设置几个不同的源代码控制包之一，例如 VSS、SourceGear Vault 或 SVN，并远程访问它们；但是，我不想处理设置、配置等的麻烦。

有人提供托管源代码控制服务吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-15T12:24:23.313

对于 Git，请查看[GitHub](http://github.com)。好包，被大量开源项目使用。被认为是 git 的最佳托管体验之一。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-15T12:46:29.073

我使用[Assembla](http://www.assembla.com)来托管我所有的个人项目。它有 500mb 的存储空间，您可以托管您的代码并进行错误跟踪和问题跟踪。

它还有一套很好的工具，您可以使用 SVN、Trac/SVN、Trac/git、Mercurial 甚至是外部 SVN 服务器进行源代码控制。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-15T12:28:07.113

[http://unfuddle.com/](http://unfuddle.com/)提供各种 SCM 产品（Subversion/Git/Maybe CVS？）以及问题跟踪。他们做得很好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-15T12:17:36.323

我们将 Dreamhost 用于我们的 subversion 存储库，到目前为止非常高兴，而且您无法击败价格： [http ://www.dreamhost.com/hosting-features.html#svn](http://www.dreamhost.com/hosting-features.html#svn)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-15T12:17:49.023

Google Code、SourceForge 都有代码托管解决方案。你想有多私密？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-15T12:17:35.340

[Dreamhost](http://www.dreamhost.com/r.cgi?74720)的基本托管计划为您提供大量的网络托管空间、带宽、数据库、jabber 聊天服务器、CVS、subversion 存储库等，每月只需 5 美元多一点。

[Beanstalk](http://beanstalkapp.com/)看起来不错（仅限 SVN），但我没有任何经验。免费计划为 3 个用户和 1 个存储库提供 20mb 空间。

[Project Locker](http://www.projectlocker.com/)为您托管 subversion 存储库和问题跟踪软件 trac。与版本控制结合使用时，Trac 非常好。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-15T12:16:37.807

我很久以前用过[CVSDude 。](http://cvsdude.com/)当时，它们最多可以释放 10 MB。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-30T03:25:21.377

我目前正在使用 webfaction (webfaction.com) 作为我的主要网络主机。他们将颠覆提供为“一键式安装程序”——实际上它需要的点击次数比名称所暗示的要多，但这确实是一个简单的过程。

他们的技术支持绝对出色，并且在他们的每个级别的共享主机中都为您提供了相同的功能。我会推荐他们，相比之下，我使用过的大多数主机都非常糟糕。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-07-04T12:54:15.590

Visual Studio Online 基于 Team Foundation Server 的功能和额外的云服务，是云中项目数据的所在地。无需安装或配置单个服务器，几分钟内即可在我们的云基础架构上启动并运行。使用您最喜欢的开发工具（例如 Visual Studio、Eclipse 或 Xcode）连接到云中的项目。

[http://www.visualstudio.com/](http://www.visualstudio.com/)

Visual Studio Online Basic 在云中开始您的下一个开发项目 - 5 个用户免费！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-05-18T03:44:54.450

Visual Studio Online 现在是[Visual Studio Team Services](https://www.visualstudio.com/products/visual-studio-team-services-vs)。您不仅可以通过无限、免费、私有的 Git 或 TFVC 存储库获得云托管的[版本控制](https://www.visualstudio.com/features/version-control-vs)，而且还可以将错误和工作项跟踪与 DevOps 的企业敏捷工具集成在一起，例如积压和看板、构建、测试和发布的自动化以及团队协作和应用程序开发的其他功能。

您的前 5 个用户仍然是免费的。以下是有关[如何开始使用 Team Services](https://www.visualstudio.com/en-us/docs/setup-admin/team-services/sign-up-for-visual-studio-team-services)的更多信息。

# c++ - main() 在 C 和 C++ 中应该返回什么？

> ID：204476
> 
> 赞同：795
> 
> 时间：2008-10-15T12:13:48.327
> 
> 标签：c++, c, return-value, main, return-type

`main()`在 C 和 C++中定义函数的正确（最有效）方法是什么——`int main()`或者`void main()`——为什么？论点又如何？如果`int main()`那么`return 1`或`return 0`？

* * *

*这个问题有很多重复，包括：*

*   [C 函数的有效签名是`main()`什么？](https://stackoverflow.com/questions/2108192/what-are-the-valid-signatures-for-cs-main-function/)
*   [`main()`函数的返回类型](https://stackoverflow.com/questions/17715008/the-return-type-of-main-function/)
*   [`void main()`和之间的区别`int main()`？](https://stackoverflow.com/questions/636829/difference-between-void-main-and-int-main)
*   [`main()`的 C++ 中的签名](https://stackoverflow.com/questions/1621574/mains-signature-in-c)
*   [什么是正确的声明`main()`？](https://stackoverflow.com/questions/4207134/what-is-the-proper-declaration-of-main)— 对于 C++，确实有一个很好的答案。
*   [`main()`C 中的函数样式](https://stackoverflow.com/questions/8692120/styles-of-main-functions-in-c)
*   [`main()`C中方法的返回类型](https://stackoverflow.com/questions/10915713/return-type-of-main-method-in-c)
*   [`int main()`与`void main()`C 中的对比](https://stackoverflow.com/questions/9356510/int-main-vs-void-main-in-c)

有关的：

*   [C++——`int main(int argc, char **argv)`](https://stackoverflow.com/questions/5191965/c-int-mainint-argc-char-argv)
*   [C++——`int main(int argc, char *argv[])`](https://stackoverflow.com/questions/5217395/c-int-mainint-argc-char-argv)
*   [是`char *envp[]`作为可`main()`移植的第三个参数吗？](https://stackoverflow.com/questions/10321435/is-char-envp-as-a-third-argument-to-main-portable)
*   [该函数必须`int main()`在所有编译器中返回一个值吗？](https://stackoverflow.com/questions/18402853/must-the-int-main-function-return-a-value-in-all-compilers)
*   [为什么`main()`C 和 C++ 中函数的类型留给用户定义？](https://stackoverflow.com/questions/5296163/why-is-the-type-of-the-main-function-in-c-and-c-left-to-the-user-to-define)
*   [为什么要`int main(){}`编译？](https://stackoverflow.com/questions/22239/why-does-int-main-compile)
*   [`main()`C++14 中的合法定义？](https://stackoverflow.com/questions/26470912/legal-definitions-of-main-in-c14)

* * *

## 回答 #1

> 赞同：643
> 
> 时间：2008-10-15T12:16:08.277

的返回值`main`指示程序如何退出。正常退出由 0 返回值表示`main`。非零返回表示异常退出，但对于如何解释非零代码没有标准。正如其他人所指出的，`void main()`C++ 标准禁止使用，不应使用。有效的 C++`main`签名是：

```
int main() 
```

和

```
int main(int argc, char* argv[]) 
```

这相当于

```
int main(int argc, char** argv) 
```

还值得注意的是，在 C++ 中，`int main()`可以不使用返回语句，此时默认返回 0。对于 C99 程序也是如此。是否`return 0;`应该省略还有待商榷。有效的 C 程序主签名的范围要大得多。

效率不是`main`功能的问题。根据 C++ 标准，它只能进入和离开一次（标记程序的开始和终止）。对于 C，允许重新输入`main()`，但应避免。

* * *

## 回答 #2

> 赞同：204
> 
> 时间：2008-10-16T09:59:57.177

接受的答案似乎是针对 C++ 的，所以我想我会添加一个与 C 相关的答案，这在几个方面有所不同。ISO/IEC 9899:1989 (C90) 和 ISO/IEC 9899:1999 (C99) 之间也有一些变化。

`main()`应声明为：

```
int main(void)
int main(int argc, char **argv) 
```

或同等学历。例如，`int main(int argc, char *argv[])`相当于第二个。在 C90 中，`int`返回类型可以省略，因为它是默认值，但在 C99 和更高版本中，`int`返回类型不能省略。

如果实现允许，`main()`可以用其他方式声明（例如，`int main(int argc, char *argv[], char *envp[])`），但这会使程序实现定义，并且不再严格符合。

该标准定义了 3 个严格符合的返回值（即不依赖于实现定义的行为）：成功终止和`0`不成功终止。任何其他值都是非标准的和实现定义的。在 C90 中，必须在末尾有一个显式语句以避免未定义的行为。在 C99 和更高版本中，您可以省略. 如果你这样做了，并且完成了，就会有一个隐含的.`EXIT_SUCCESS``EXIT_FAILURE``main()``return``main()``main()``return 0`

最后，从标准的角度来看，从 C 程序`main()` *递归*调用并没有错。

* * *

## 回答 #3

> 赞同：137
> 
> 时间：2013-09-10T14:15:12.000

## 标准 C — 托管环境

对于托管环境（这是正常环境），C11 标准 (ISO/IEC 9899:2011) 说：

> ### 5.1.2.2.1 程序启动
> 
> 程序启动时调用的函数名为`main`. 实现没有声明这个函数的原型。它应定义为返回类型`int`且不带参数：
> 
> ```
> int main(void) { /* ... */ } 
> ```
> 
> 或带有两个参数（这里称为`argc`and `argv`，尽管可以使用任何名称，因为它们对于声明它们的函数是本地的）：
> 
> ```
> int main(int argc, char *argv[]) { /* ... */ } 
> ```
> 
> 或同等学历; ^(10))或以其他一些实现定义的方式。
> 
> 如果它们被声明，主函数的参数应遵守以下约束：
> 
> *   的值`argc`应为非负数。
> *   `argv[argc]`应为空指针。
> *   如果 的值`argc`大于零，则`argv[0]`通过 `argv[argc-1]`inclusive 的数组成员应包含指向字符串的指针，这些指针在程序启动之前由宿主环境赋予实现定义的值。目的是从托管环境中的其他地方向程序提供在程序启动之前确定的信息。如果主机环境不能提供大写和小写字母的字符串，则实现应确保以小写形式接收字符串。
> *   如果 的值`argc`大于零，则 指向的字符串`argv[0]` 代表程序名；`argv[0][0]`如果主机环境中没有程序名，则应为空字符。如果 的值`argc`大于 1，则`argv[1]`through指向的字符串`argv[argc-1]` 表示程序参数。
> *   数组所指向的参数`argc`和字符串应可由程序修改，并在程序启动和程序终止之间保留其最后存储的值。`argv``argv`
> 
> ^(10))因此，`int`可以替换为定义为 的 typedef 名称`int`，或者`argv`可以写为 的类型`char **argv`，依此类推。

### C99 或 C11 中的程序终止

从返回的值`main()`以实现定义的方式传输到“环境”。

> ### 5.1.2.2.3 程序终止
> 
> 1 如果`main`函数的返回类型是与 兼容的类型`int`，则从函数的初始调用返回`main`相当于以`exit`函数返回的值`main`作为参数调用函数；^(11))到达`}`终止 `main`函数返回值0。如果返回类型与 不兼容`int`，则返回到宿主环境的终止状态未指定。
> 
> ^(11))根据 6.2.4，在前一种情况下声明了自动存储持续时间的对象的生命周期`main` 将结束，即使在后者中它们不会有。

请注意，这`0`是强制性的“成功”。如果您愿意，可以使用`EXIT_FAILURE`and `EXIT_SUCCESS`from `<stdlib.h>`，但 0 已确定，1 也是如此。另请参阅[大于 255 的退出代码 — 可能吗？](https://stackoverflow.com/questions/179565/exitcodes-bigger-than-255-possible/).

在 C89 中（因此在 Microsoft C 中），没有关于如果`main()`函数返回但没有指定返回值会发生什么的声明；因此，它会导致未定义的行为。

> ### 7.22.4.4`exit`功能
> 
> ¶5 最后，控制权返回到主机环境。如果 的值为`status`0 或，则返回*成功终止*`EXIT_SUCCESS`状态的实现定义形式。如果值为 ，则返回状态*未成功终止*的实现定义形式。否则返回的状态是实现定义的。*`status``EXIT_FAILURE`*

 **## 标准 C++ — 托管环境

C++11 标准 (ISO/IEC 14882:2011) 说：

> ### 3.6.1 主函数[basic.start.main]
> 
> ¶1 程序应包含一个名为 main 的全局函数，它是程序的指定开始。[...]
> 
> ¶2 实现不应预定义主要功能。该功能不得重载。它应该有一个 int 类型的返回类型，否则它的类型是实现定义的。所有实现都应允许以下两种 main 定义：
> 
> ```
> int main() { /* ... */ } 
> ```
> 
> 和
> 
> ```
> int main(int argc, char* argv[]) { /* ... */ } 
> ```
> 
> 后一种形式`argc`是从程序运行的环境传递给程序的参数数量。如果`argc`不为零，则这些参数应作为指向以空结尾的多字节字符串 (NTMBS) (17.5.2.1.4.2) 的初始字符的指针提供，并且`argv[0]` 应是指向 NTMBS 的初始字符的指针，该名称表示用于调用程序或. 的值应为非负数。的值 应为 0。 [ 注意：建议在 . 之后添加任何其他（可选）参数。——尾注]`argv[argc-1]``argv[0]``""``argc``argv[argc]``argv`
> 
> ¶3 该功能`main`不得在程序中使用。的链接（3.5）`main`是实现定义的。[...]
> 
> ¶5 main 中的 return 语句具有离开 main 函数（销毁具有自动存储持续时间的任何对象）并`std::exit`以返回值作为参数进行调用的效果。如果控制到达main的末尾没有遇到return语句，效果就是执行
> 
> ```
> return 0; 
> ```

C++ 标准明确规定“它 [主函数] 应具有 type 的返回类型`int`，否则其类型是实现定义的”，并且需要与 C 标准相同的两个签名作为选项支持。因此，C++ 标准直接不允许使用“void main()”，尽管它无法阻止允许替代方案的非标准实现。请注意，C++ 禁止用户调用`main`（但 C 标准没有）。

C++11 标准中有一段 §18.5开始**和结束**，与**§7.22.4.4**中**的`exit`**段落相同中）。`EXIT_SUCCESS``EXIT_FAILURE``<cstdlib>`

## 标准 C——通用扩展

传统上，Unix 系统支持第三种变体：

```
int main(int argc, char **argv, char **envp) { ... } 
```

第三个参数是一个以空结尾的字符串指针列表，每个字符串都是一个环境变量，它有一个名称、一个等号和一个值（可能为空）。如果你不使用这个，你仍然可以通过' `extern char **environ;`'进入环境。这个全局变量在 POSIX 中是唯一的，因为它没有声明它的标头。

这被 C 标准认可为通用扩展，记录在附件 J 中：

> ### J.5.1 环境参数
> 
> ¶1 在托管环境中，main 函数接收第三个参数 ，`char *envp[]`它指向一个以空结尾的指针数组`char`，每个指针都指向一个字符串，该字符串为程序的执行提供有关环境的信息（5.1\. 2.2.1)。

## 微软 C

[Microsoft VS 2010](http://msdn.microsoft.com/en-us/library/6wd819wh%28v=vs.100%29.aspx)编译器很有趣。该网站说：

> main 的声明语法是
> 
> ```
>  int main(); 
> ```
> 
> 或者，可选地，
> 
> ```
> int main(int argc, char *argv[], char *envp[]); 
> ```
> 
> 或者，`main`and`wmain`函数可以声明为返回`void`（无返回值）。如果您声明`main`或`wmain`返回 void，则无法使用 return 语句将退出代码返回给父进程或操作系统。`main`要在或`wmain`声明为时返回退出代码`void`，您必须使用该`exit`函数。

我不清楚当一个程序退出时会发生什么（什么退出代码返回给父级或操作系统）`void main()`——而且 MS 网站也保持沉默。

有趣的是，MS 没有规定`main()`C 和 C++ 标准要求的两个参数版本。它只规定了一个三参数形式，其中第三个参数是`char **envp`，一个指向环境变量列表的指针。

Microsoft 页面还列出了其他一些替代方案——`wmain()`它采用宽字符串等等。

[此页面](http://msdn.microsoft.com/en-us/library/6wd819wh%28v=vs.80%29.aspx)的 Microsoft [Visual Studio 2005](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2005)版本未列为替代版本。Microsoft [Visual Studio 2008](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2008)以后的[版本](http://msdn.microsoft.com/en-us/library/6wd819wh%28v=vs.90%29.aspx)可以。`void main()`

## 标准 C — 独立环境

如前所述，上述要求适用于托管环境。如果您使用的是独立环境（这是托管环境的替代方案），那么标准就没有什么可说的了。对于独立环境，不需要调用在程序启动时调用的函数，`main`并且对其返回类型没有限制。标准说：

> ### 5.1.2 执行环境
> 
> 定义了两种执行环境：独立和托管。在这两种情况下，程序启动都是在执行环境调用指定的 C 函数时发生的。所有具有静态存储持续时间的对象都应在程序启动之前进行初始化（设置为其初始值）。这种初始化的方式和时间是未指定的。程序终止将控制权返回给执行环境。
> 
> ### 5.1.2.1 独立环境
> 
> 在独立环境中（C 程序的执行可能在没有操作系统的任何好处的情况下发生），程序启动时调用的函数的名称和类型是实现定义的。除了第 4 节要求的最小集合之外，独立程序可用的任何库设施都是实现定义的。
> 
> 独立环境中程序终止的效果是实现定义的。

对第 4 条一致性的交叉引用指的是：

> ¶5*严格遵守的程序*应仅使用本国际标准中指定的语言和库的那些特性。^(3))它不应产生依赖于任何未指定、未定义或实现定义的行为的输出，并且不应超过任何最小实现限制。
> 
> ¶6 两种形式的一致性实现是*托管*的和*独立*的。符合要求的*托管实现*应接受任何严格符合要求的程序。符合标准的*独立实现*应接受任何严格符合标准的程序，其中库条款（第 7 条）中指定的功能的使用仅限于标准头文件`<float.h>`、`<iso646.h>`、`<limits.h>`、`<stdalign.h>`、 `<stdarg.h>`、`<stdbool.h>`、`<stddef.h>`、`<stdint.h>`和 `<stdnoreturn.h>`. 一个符合要求的实现可能有扩展（包括额外的库函数），只要它们不改变任何严格符合的程序的行为。^(4))
> 
> ¶7*符合标准的程序*是符合标准的实现可接受的程序。^(5))
> 
> ^(3))一个严格符合的程序可以使用条件特性（见 6.10.8.3），只要使用相关宏的适当的条件包含预处理指令保护使用。例如：
> 
> ```
> #ifdef __STDC_IEC_559__ /* FE_UPWARD defined */
>     /* ... */
>     fesetround(FE_UPWARD);
>     /* ... */
> #endif 
> ```
> 
> ^(4))这意味着一个符合要求的实现除了在本国际标准中明确保留的标识符外，不保留标识符。
> 
> ^(5))严格符合的程序旨在最大限度地在符合的实现中移植。符合标准的程序可能取决于符合标准的实现的不可移植特性。

值得注意的是，实际定义任何函数的独立环境所需的唯一标头是`<stdarg.h>`（甚至那些可能——而且通常是——只是宏）。

## 标准 C++ — 独立环境

正如 C 标准承认托管和独立环境一样，C++ 标准也是如此。（引自 ISO/IEC 14882:2011。）

> ### 1.4 实施合规性 [intro.compliance]
> 
> ¶7 定义了两种实现：*托管实现*和*独立实现*。对于托管实现，本国际标准定义了一组可用的库。独立的实现是在没有操作系统的情况下可以执行的实现，并且具有一组实现定义的库，其中包括某些语言支持库 (17.6.1.3)。
> 
> ¶8 一个符合规范的实现可以有扩展（包括额外的库函数），只要它们不改变任何格式良好的程序的行为。需要实现来诊断使用根据本国际标准格式错误的扩展的程序。然而，这样做之后，他们可以编译和执行这样的程序。
> 
> ¶9 每个实现都应包括文档，以标识它不支持的所有有条件支持的构造，并定义所有特定于语言环境的特征。³
> 
> ^(3))本文档还定义了实现定义的行为；见 1.9。
> 
> ### 17.6.1.3 独立实施[合规]
> 
> 定义了两种实现：托管和独立 (1.4)。对于托管实现，本国际标准描述了一组可用的标头。
> 
> 一个独立的实现有一组实现定义的头文件。该集合应至少包括表 16 中所示的标题。
> 
> 提供的标头版本`<cstdlib>`应至少声明函数`abort`、`atexit`、`at_quick_exit`、`exit`和`quick_exit`(18.5)。此表中列出的其他标头应满足与托管实现相同的要求。
> 
> 表 16 — 独立实现的 C++ 头文件
> 
> ```
> Subclause                           Header(s)
>                                     <ciso646>
> 18.2  Types                         <cstddef>
> 18.3  Implementation properties     <cfloat> <limits> <climits>
> 18.4  Integer types                 <cstdint>
> 18.5  Start and termination         <cstdlib>
> 18.6  Dynamic memory management     <new>
> 18.7  Type identification           <typeinfo>
> 18.8  Exception handling            <exception>
> 18.9  Initializer lists             <initializer_list>
> 18.10 Other runtime support         <cstdalign> <cstdarg> <cstdbool>
> 20.9  Type traits                   <type_traits>
> 29    Atomics                       <atomic> 
> ```

## `int main()`在 C 中使用呢？

C11 标准的标准 §5.1.2.2.1 显示了首选符号 - <code>int main(void) - 但标准中也有两个示例显示`int main()`：[§6.5.3.4 ¶8](https://port70.net/~nsz/c/c11/n1570.html#6.5.3.4p8)和[§6.7.6.3 ¶ 20](https://port70.net/~nsz/c/c11/n1570.html#6.7.6.3p20) . 现在，重要的是要注意示例不是“规范的”；它们只是说明性的。如果示例中有错误，它们不会直接影响标准的正文。也就是说，它们强烈地表明了预期的行为，所以如果标准包含`int main()`在一个例子中，它表明这`int main()`是不被禁止的，即使它不是首选的符号。

> ### 6.5.3.4`sizeof`和`_Alignof`运算符
> 
> …</p>
> 
> ¶8 示例 3 在此示例中，计算可变长度数组的大小并从函数返回：
> 
> ```
> #include <stddef.h>
> 
> size_t fsize3(int n)
> {
>     char b[n+3]; // variable length array
>     return sizeof b; // execution time sizeof
> }
> int main()
> {
>     size_t size;
>     size = fsize3(10); // fsize3 returns 13
>     return 0;
> } 
> ```

* * *

## 回答 #4

> 赞同：65
> 
> 时间：2008-10-15T12:33:14.733

我相信`main()`应该返回`EXIT_SUCCESS`or `EXIT_FAILURE`。它们定义在`stdlib.h`

* * *

## 回答 #5

> 赞同：43
> 
> 时间：2015-07-07T08:07:30.277

请注意，C 和 C++ 标准定义了两种实现方式：独立式和托管式。

*   **C90 托管环境**

允许的形式¹：

```
int main (void)
int main (int argc, char *argv[])

main (void)
main (int argc, char *argv[])
/*... etc, similar forms with implicit int */ 
```

评论：

前两个被明确声明为允许的形式，其他的被隐式允许，因为 C90 允许“隐式 int”作为返回类型和函数参数。不允许使用其他形式。

*   **C90 独立环境**

允许使用任何形式或名称的 main ²。

*   **C99 托管环境**

允许的表格³：

```
int main (void)
int main (int argc, char *argv[])
/* or in some other implementation-defined manner. */ 
```

评论：

C99 删除了“隐式 int”，因此`main()`不再有效。

引入了一个奇怪的、模棱两可的句子“或以某种其他实现定义的方式”。这可以解释为“参数`int main()`可能变化”或“main 可以具有任何实现定义的形式”。

一些编译器选择以后一种方式解释标准。可以说，人们不能轻易地通过引用标准本身来说明它们不符合，因为它是模棱两可的。

然而，允许完全狂野的形式`main()`可能（？）不是这个新句子的意图。C99 基本原理（非规范性）暗示该句子引用了`int main` ⁴的附加参数。

然而，托管环境程序终止部分继续争论 main 不返回 int ⁵的情况。尽管该部分对于应该如何声明 main 不是规范的，但它肯定意味着即使在托管系统上也可以以完全实现定义的方式声明 main。

*   **C99 独立式环境**

允许使用任何形式或名称的 main ⁶。

*   **C11 托管环境**

允许的表格⁷：

```
int main (void)
int main (int argc, char *argv[])
/* or in some other implementation-defined manner. */ 
```

*   **C11 独立式环境**

允许使用任何形式或名称的 main ⁸。

* * *

请注意，`int main()`在上述任何版本中，它从未被列为任何托管 C 实现的有效形式。在 C 中，不同于 C++，`()`并且`(void)`有不同的含义。前者是一个过时的功能，可能会从语言中删除。请参阅 C11 未来语言方向：

> 6.11.6 函数声明器
> 
> 使用带空括号的函数声明符（不是原型格式参数类型声明符）是一个过时的特性。

* * *

*   **C++03 托管环境**

允许的表格⁹：

```
int main ()
int main (int argc, char *argv[]) 
```

评论：

请注意第一种形式中的空括号。在这种情况下，C++ 和 C 是不同的，因为在 C++ 中，这意味着函数不接受参数。但在 C 中，这意味着它可以采用任何参数。

*   **C++03 独立环境**

启动时调用的函数的名称是实现定义的。如果它被命名`main()`，它必须遵循规定的表格^(10)：

```
// implementation-defined name, or 
int main ()
int main (int argc, char *argv[]) 
```

*   **C++11 托管环境**

允许的表格^(11) :

```
int main ()
int main (int argc, char *argv[]) 
```

评论：

标准的文本已更改，但含义相同。

*   **C++11 独立环境**

启动时调用的函数的名称是实现定义的。如果它被命名`main()`，它必须遵循规定的表格^(12)：

```
// implementation-defined name, or 
int main ()
int main (int argc, char *argv[]) 
```

* * *

**参考**

1.  ANSI X3.159-1989 2.1.2.2 托管环境。“程序启动”

> 程序启动时调用的函数名为 main。实现没有声明这个函数的原型。它应定义为返回类型为 int 且不带参数：

```
int main(void) { /* ... */ } 
```

> 或者带有两个参数（这里称为 argc 和 argv，尽管可以使用任何名称，因为它们是声明它们的函数的局部变量）：

```
int main(int argc, char *argv[]) { /* ... */ } 
```

2.  ANSI X3.159-1989 2.1.2.1 独立环境：

> 在独立环境中（C 程序的执行可能在没有操作系统的任何好处的情况下发生），程序启动时调用的函数的名称和类型是实现定义的。

3.  ISO 9899:1999 5.1.2.2 托管环境 -> 5.1.2.2.1 程序启动

> 程序启动时调用的函数名为 main。实现没有声明这个函数的原型。它应定义为返回类型为 int 且不带参数：

```
int main(void) { /* ... */ } 
```

> 或者带有两个参数（这里称为 argc 和 argv，尽管可以使用任何名称，因为它们是声明它们的函数的局部变量）：

```
int main(int argc, char *argv[]) { /* ... */ } 
```

> 或等价物；9) 或以其他一些实现定义的方式。

4.  国际标准的基本原理 — 编程语言 — C，修订版 5.10。5.1.2.2 托管环境 --> 5.1.2.2.1 程序启动

> main 参数的行为，以及 exit、main 和 atexit（参见第 7.20.4.2 节）的交互行为已被编纂，以遏制 argv 字符串的表示形式以及 main 返回值的含义中的一些不必要的变化。

> 将 argc 和 argv 作为 main 的参数的规范认可了广泛的先前实践。argv[argc] 需要为空指针，以提供对列表末尾的冗余检查，也是基于惯例。

> main 是唯一可以用零个或两个参数可移植地声明的函数。（其他函数的参数数量必须在调用和定义之间完全匹配。）这种特殊情况只是认识到当程序不访问程序参数字符串时将参数留给 main 的普遍做法。虽然许多实现支持两个以上的 main 参数，但标准既不祝福也不禁止这种做法；用三个参数定义 main 的程序并不严格符合（参见 §J.5.1.）。

5.  ISO 9899:1999 5.1.2.2 托管环境 --> 5.1.2.2.3 程序终止

> 如果 main 函数的返回类型是与 int 兼容的类型，则从初始调用到 main 函数的 return 等效于以 main 函数返回的值作为参数调用 exit 函数；11）到达`}`终止的main 函数返回值 0。如果返回类型与 int 不兼容，则返回给宿主环境的终止状态是未指定的。

6.  ISO 9899:1999 5.1.2.1 独立环境

> 在独立环境中（C 程序的执行可能在没有操作系统的任何好处的情况下发生），程序启动时调用的函数的名称和类型是实现定义的。

7.  ISO 9899:2011 5.1.2.2 托管环境 -> 5.1.2.2.1 程序启动

本节与上面引用的 C99 相同。

8.  ISO 9899:1999 5.1.2.1 独立环境

本节与上面引用的 C99 相同。

9.  ISO 14882:2003 3.6.1 主要功能

> 实现不应预定义主要功能。该功能不得重载。它应该有一个 int 类型的返回类型，否则它的类型是实现定义的。所有实现都应允许以下两种 main 定义：

```
int main() { /* ... */ } 
```

> 和

```
int main(int argc, char* argv[]) { /* ... */ } 
```

10.  ISO 14882:2003 3.6.1 主要功能

> 独立环境中的程序是否需要定义主要功能是实现定义的。

11.  ISO 14882:2011 3.6.1 主要功能

> 实现不应预定义主要功能。该功能不得重载。它应该有一个 int 类型的返回类型，否则它的类型是实现定义的。所有实现都应允许
> 
> — () 的函数返回 int 和
> 
> — (int, pointer to pointer to char) 返回 int 的函数
> 
> 作为 main 的类型（8.3.5）。

12.  ISO 14882:2011 3.6.1 主要功能

本节与上面引用的 C++03 相同。

* * *

## 回答 #6

> 赞同：30
> 
> 时间：2008-10-15T12:16:51.503

成功返回 0，错误返回非零。这是 UNIX 和 DOS 脚本用于找出程序发生了什么的标准。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2011-12-27T08:02:51.533

`main()`在 C89 和 K&R C 中，未指定的返回类型默认为“int”。

```
return 1? return 0? 
```

1.  如果不写return语句`int main()`，则关闭`}`默认返回0。

（仅在 c++ 和 c99 以后，对于 c90 必须编写 return 语句。请参阅[为什么 main 此处不返回 0？](https://stackoverflow.com/questions/8677672/why-main-does-not-return-0-here)）

2.  `return 0`或`return 1`将被父进程接收。在 shell 中，它进入一个 shell 变量，如果您从 shell 运行程序而不使用该变量，那么您不必担心`main()`.

请参阅[如何获取我的 main 函数返回的内容？](https://stackoverflow.com/q/8626109/775964).

```
$ ./a.out
$ echo $? 
```

这样你可以看到它是`$?`接收返回值的最低有效字节的变量`main()`。

在 Unix 和 DOS 脚本中，`return 0`通常返回成功和非零错误。这是 Unix 和 DOS 脚本用来找出程序发生了什么并控制整个流程的标准。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-10-15T15:22:13.313

请记住，即使您返回一个 int，某些操作系统 (Windows) 也会将返回的值截断为单个字节 (0-255)。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2011-07-01T16:32:34.087

操作系统可以使用返回值来检查程序是如何关闭的。

返回值 0 在大多数操作系统中通常意味着 OK（无论如何我都能想到的那些）。

当你自己调用一个进程时也可以检查它，看看程序是否退出并正确完成。

这**不仅仅是**一个编程约定。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-07-01T23:30:59.867

的返回值`main()`显示程序如何退出。如果返回值是`zero`，则表示执行成功，而任何非零值都表示执行中出现问题。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-11-23T07:29:29.500

返回 0 应该告诉程序员程序已成功完成工作。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-04-22T11:34:54.647

## 忽略`return 0`

当 C 或 C++ 程序到达末尾时`main`，编译器会自动生成返回 0 的代码，因此无需`return 0;`在末尾显式放置`main`.

**注意：**当我提出这个建议时，几乎总是跟着两种评论之一：“我不知道。” 或“这是个坏建议！” 我的理由是，依赖标准明确支持的编译器行为是安全且有用的。对于 C，从 C99 开始；参见 ISO/IEC 9899:1999 第 5.1.2.2.3 节：

> [...] 从对函数的初始调用返回`main`等效于以`exit`函数返回的值`main`作为参数调用函数；到达`}`终止`main`函数的返回值 0。

对于 C++，从 1998 年的第一个标准开始；参见 ISO/IEC 14882:1998 第 3.6.1 节：

> 如果控制到达main末尾没有遇到return语句，效果就是执行return 0；

从那时起，这两个标准的所有版本（C99 和 C++98）都保持了相同的想法。我们依赖于 C++ 中自动生成的成员函数，很少有人在函数`return;`末尾写明确的语句`void`。反对省略的原因似乎可以归结为[“看起来很奇怪”](https://stackoverflow.com/questions/2581993/what-the-reasons-for-against-returning-0-from-main-in-iso-c/2582015#2582015)。如果您像我一样对更改 C 标准的理由感到好奇，请[阅读此问题](https://stackoverflow.com/questions/31394171/what-was-the-rationale-for-making-return-0-at-the-end-of-main-optional)。另请注意，在 1990 年代初期，这被认为是“草率的做法”，因为当时它是未定义的行为（尽管得到广泛支持）。

此外，[C++ 核心指南](https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md)包含多个`return 0;`在末尾省略的`main`实例，并且没有写入显式返回的实例。尽管该文件中还没有关于这个特定主题的具体指导方针，但这似乎至少是对这种做法的默许。

所以我主张省略它；其他人不同意（通常非常激烈！）在任何情况下，如果您遇到省略它的代码，您就会知道标准明确支持它并且您会知道它的含义。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-03-03T11:56:57.407

如果您确实存在与从进程返回整数的效率相关的问题，您可能应该避免多次调用该进程以致该返回值成为问题。

如果你这样做（多次调用一个进程），你应该找到一种方法将你的逻辑直接放在调用者中，或者放在一个 DLL 文件中，而不为每次调用分配一个特定的进程；在这种情况下，多进程分配给您带来了相关的效率问题。

详细地说，如果您只想知道返回 0 是否比返回 1 效率更高或更低，在某些情况下它可能取决于编译器，但一般来说，假设它们是从相同的源（本地、字段、常量、嵌入式在代码、函数结果等中）它需要完全相同数量的时钟周期。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-03-10T14:11:33.747

返回的内容取决于您要对可执行文件执行的操作。例如，如果您将程序与命令行 shell 一起使用，那么您需要返回 0 表示成功，返回非 0 表示失败。然后，您将能够根据代码的结果在带有条件处理的 shell 中使用该程序。您也可以根据您的解释分配任何非零值，例如对于严重错误，不同的程序退出点可以终止具有不同退出值的程序，并且调用 shell 可以通过检查返回的值来决定做什么。如果代码不打算与 shell 一起使用并且返回的值不会打扰任何人，那么它可能会被省略。我个人使用签名`int main (void) { .. return 0; .. }`

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-02-10T22:22:08.667

这是返回码用法的一个小演示......

当使用 Linux 终端提供的各种工具时，可以使用返回码，例如在进程完成后进行错误处理。假设存在以下文本文件 myfile：

> 这是一些示例，用于检查 grep 的工作原理。

当您执行 grep 命令时，会创建一个进程。一旦它通过（并且没有中断），它会返回一些介于 0 和 255 之间的代码。例如：

```
$ grep order myfile 
```

如果你这样做

```
$ echo $?
$ 0 
```

你会得到一个0。为什么？因为[grep](http://en.wikipedia.org/wiki/Grep)找到匹配项并返回退出代码 0，这是成功退出的常用值。让我们再次检查一下，但有些内容不在我们的文本文件中，因此找不到匹配项：

```
$ grep foo myfile
$ echo $?
$ 1 
```

由于 grep 未能将令牌“foo”与我们文件的内容匹配，因此返回码为 1（这是发生故障时的常见情况，但如上所述，您有很多值可供选择）。

现在下面的 bash 脚本（只需在 Linux 终端中键入）虽然非常基本，但应该给出一些错误处理的想法：

```
$ grep foo myfile
$ CHECK=$?
$ [ $CHECK -eq 0] && echo 'Match found'
$ [ $CHECK -ne 0] && echo 'No match was found'
$ No match was found 
```

在第二行之后没有任何内容打印到终端，因为“foo”使 grep 返回 1，我们检查 grep 的返回码是否等于 0。第二个条件语句在最后一行回显它的消息，因为由于 CHECK 它是真的== 1。

如您所见，如果您正在调用这个和那个过程，有时必须查看它返回的内容（通过 main() 的返回值）。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-10-03T21:56:28.587

> 在 C 和 C++ 中定义 main() 函数的正确（最有效）方法是什么——int main() 或 void main()——为什么？

那些词“（最有效）”并没有改变问题。除非您处于独立环境中，否则有一种普遍正确的声明方式`main()`，那就是返回 int。

> `main()`在 C 和 C++ 中应该返回什么？

这不是*应该**返回* `main()`的，而是应该返回的。 当然，是别人调用的函数。您无法控制调用. 因此，您必须使用类型正确的签名声明以匹配其调用者。你在这件事上根本没有任何选择。您不必问自己什么效率更高或更低，或者风格更好或更差，或类似的事情，因为答案已经由 C 和 C+ 标准完美定义。只要跟着他们。 *`main()``main()``main()``main()`*

 *> 如果 int main() 那么返回 1 还是返回 0？

0 表示成功，非零表示失败。同样，不是您需要（或获得）选择的东西：它是由您应该遵守的接口定义的。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-10-10T15:34:27.617

在 C 中，[C11 标准的第 5.1.2.2.1 节](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1548.pdf)（强调我的）：

> 它应定义为**返回类型`int`**且不带参数：
> 
> ```
> int main(void) { /* ... */ } 
> ```
> 
> 或带有两个参数（这里称为`argc`and `argv`，尽管可以使用任何名称，因为它们对于声明它们的函数是本地的）：
> 
> ```
> int main(int argc, char *argv[]) { /* ... */ } 
> ```

但是对于像我这样的初学者来说，一个抽象的例子可以让我掌握它：

当您在程序中编写一个方法时，例如`int read_file(char filename[LEN]);`，作为该方法的调用者，您希望知道一切是否顺利（因为可能会发生故障，例如找不到文件）。通过检查方法的返回值，您可以知道一切是否顺利，这是该方法向您发出成功执行（或不成功）信号的一种机制，并让调用者（您，例如在您的 main 方法中）决定如何处理意外故障。

所以现在想象我为一个用于更复杂系统的微机制编写了一个 C 程序。当系统调用微机制时，它想知道一切是否按预期进行，以便它可以处理任何潜在的错误。如果 C 程序的 main 方法会返回 void，那么调用系统如何知道其子系统（微机制）的执行情况？它不能，这就是 main() 返回 int 的原因，以便与调用者通信成功（或不成功）执行。

换句话说：

合理的是主机环境（即操作系统（OS））需要知道程序是否正确完成。如果没有 int 兼容类型作为返回类型（例如 void），“返回到主机环境的状态是未指定的”（即大多数操作系统上的未定义行为）。

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2021-08-29T18:52:49.247

在 Windows 上，如果程序由于访问冲突而崩溃，退出代码将为`STATUS_ACCESS_VIOLATION (0xC0000005)`. 对于来自 x86 异常的其他类型的崩溃也类似。

因此，除了您返回`main`或传递给的内容之外，还有一些事情`exit`可能会导致看到退出代码。

# tfs - 如何从批处理文件中的 TFS 检索任务和错误列表？

> ID：204484
> 
> 赞同：1
> 
> 时间：2008-10-15T12:16:19.197
> 
> 标签：tfs, batch-file, task

我想以编程方式访问我们 TFS 中的工作项。难道不应该有一个明显的命令行工具来提取这些信息吗？还是我可以调用的 WebService？我已经检查过使用 Excel - 这很整洁，但我想要更多的铁杆......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T12:58:44.913

查看 TFS API ( [http://msdn.microsoft.com/en-us/library/bb130146(VS.80).aspx](http://msdn.microsoft.com/en-us/library/bb130146(VS.80).aspx) )。访问 Microsoft 用于创建 Visual Studio 集成及其版本控制命令行工具 ( [tf.exe](http://msdn.microsoft.com/en-us/library/z51z7zy0(VS.80).aspx) ) 的相同代码。

您还可以查看电动工具。 [tfpt.exe](http://msdn.microsoft.com/en-us/tfs2008/bb980963.aspx)是电动工具命令行，并具有许多其他高级功能。也就是说 - 您可以使用 SDK 做几乎所有您想做的事情。

新版本的电动工具即将推出，而且看起来[Powershell 支持](http://blogs.msdn.com/bharry/archive/2008/10/01/preview-of-the-next-tfs-power-tools-release.aspx)即将到来

享受！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T13:16:58.310

如果您下载[tfs 电动工具](http://msdn.microsoft.com/sv-se/tfs2008/bb980963(en-us).aspx)，您可以使用“tfpt 查询”来发挥您的优势。

# asp.net - 尽管可见 = true，但没有出现 DetailsView，以及如何绑定到空的哈希表？

> ID：204485
> 
> 赞同：0
> 
> 时间：2008-10-15T12:16:29.617
> 
> 标签：asp.net

我正在尝试将哈希表绑定到我的 ASP.NET Web 应用程序中的详细信息视图。当我这样做时，当我进行调试时，详细信息视图不会出现在网页上。我已经检查了控件的所有属性，并确保可见和 autogeneratecolumns（没有 autogeneraterows 属性）设置为 true，并且确实如此。

另外，我想将此详细信息视图绑定到哈希表，但是当我这样做时，由于数据源属性或当我说 datasource = strings.keys （其中字符串是哈希表的 ID）。我可以理解为什么会发生这种情况，因为 strings.keys 属性为空（尚未指定，即使我通过使用如何使用该属性的外部示例指定它，同样的错误）。我期待 detailsview 只呈现一个带有 Key 和 Object 行的空表。我怎么能做到这一点？最终，我想将标签绑定到从哈希表返回的值（使用返回字符串的函数）。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T14:15:49.220

好的，我现在已经这样做了：

我有一个 BLL 类，它负责检索项目并将其添加到哈希表集合中。其中一个函数是 AddToCollection()，它接受键和值的参数。我通过objectdatasource控件选择这个方法，并组成参数值。我仍然没有在我的页面上看到详细信息视图？

ASP 代码：

```
<asp:DetailsView ID="CopyDetails" runat="server" AllowPaging="True"
                 Height="161px" Width="140px" BackColor="White"
                 AutoGenerateRows="true" BorderColor="Gray"
                 BorderStyle="Solid" BorderWidth="1px" Font-Names="Verdana" 
                 Font-Size="10px">
    <PagerStyle BackColor="#00CCFF" />
</asp:DetailsView>
<br />
<asp:ObjectDataSource ID="ObjectDataSource2" runat="server" 
                      SelectMethod="ReturnString" TypeName="Strings">
    <SelectParameters>
        <asp:Parameter DefaultValue="Test" Name="SendFrom" Type="String" />
        <asp:Parameter DefaultValue="1" Name="StepOfSite" Type="Int32" />
    </SelectParameters>
</asp:ObjectDataSource> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T12:46:13.113

你能用一个包含空字符串的键和值的元素来初始化哈希表吗？然后，您将拥有一个实例化的哈希表对象，当用户单击时，可以使用选定的数据重新填充该对象。此外，请注意您在页面生命周期中使用的事件来实例化哈希表。

# dynamics-crm - 在 MS CRM 4.0 中创建动态实体

> ID：204488
> 
> 赞同：1
> 
> 时间：2008-10-15T12:16:57.150
> 
> 标签：dynamics-crm, dynamics-crm-4

我正在尝试使用动态实体创建一个新联系人。我在 CRM SDK 中找到的示例有这个代码。

```
// Set the properties of the contact using property objects.
        StringProperty firstname = new StringProperty();
        firstname.Name = "firstname";
        firstname.Value = "Jesper";
        StringProperty lastname = new StringProperty();
        lastname.Name = "lastname";
        lastname.Value = "Aaberg";

        // Create the DynamicEntity object.
        DynamicEntity contactEntity = new DynamicEntity();

        // Set the name of the entity type.
        contactEntity.Name = EntityName.contact.ToString();

        // Set the properties of the contact.
        contactEntity.Properties = new Property[] {firstname, lastname}; 
```

在我的代码中，我有以下实现。

```
 StringProperty sp_Field1 = new StringProperty("Field1","Value1");
        StringProperty sp_Field2 = new StringProperty("Field2","Value1");

        CrmService service = new CrmService();
        service.Credentials = System.Net.CredentialCache.DefaultCredentials;
        // Create the DynamicEntity object.
        DynamicEntity contactEntity = new DynamicEntity();
        // Set the name of the entity type.
        contactEntity.Name = EntityName.contact.ToString();
        // Set the properties of the contact.
        contactEntity.Properties = new Property[] {sp_Field1,sp_Field2}; 
```

我在代码中没有看到太大的差异。在我在互联网上找到的示例中，我的实现与在 SDK 中找到的实现相同。但是如果我运行相同，我会收到以下错误

> CS0029：无法将类型“Microsoft.Crm.Sdk.StringProperty”隐式转换为“Microsoft.Crm.Sdk.PropertyCollection”

我尝试创建一个 PropertyCollection 类型的新变量（属于 mscrm 命名空间的变量）并将字符串属性添加到其中并将其传递给实体。

```
Microsoft.Crm.Sdk.PropertyCollection propTest = new Microsoft.Crm.Sdk.PropertyCollection();
        propTest.Add(sp_SSNNo);
        propTest.Add(sp_FirstName);
        contactEntity.Properties = new Property[] {propTest}; 
```

这给了我以下错误

> CS0029：无法将类型“Microsoft.Crm.Sdk.PropertyCollection”隐式转换为“Microsoft.Crm.Sdk.Property”

我确信这是一个小的类型转换错误，但我无法弄清楚错误在哪里。而且，即使这是一个类型转换错误，为什么它适用于互联网上给出的所有样本而不是我。我尝试让代码示例运行，但我遇到了相同的转换错误。如果您需要有关此的更多信息，请告诉我，对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T14:42:40.510

这是微软的一篇文章，试图讨论这个话题：

[http://community.dynamics.com/blogs/cscrmblog/archive/2008/06/23/web-services-amp-dlls-or-what-s-up-with-all-the-duplicate-classes.aspx](http://community.dynamics.com/blogs/cscrmblog/archive/2008/06/23/web-services-amp-dlls-or-what-s-up-with-all-the-duplicate-classes.aspx)

这不是您遇到的错误，而是两个程序集的工作方式和它们的设计目的之间的设计差异。

如果您想继续使用 Microsoft.Crm.Sdk.dll，您应该能够通过以下方式实现您的目标...

```
 StringProperty sp_Field1 = new StringProperty("Field1","Value1");
    StringProperty sp_Field2 = new StringProperty("Field2","Value1");

    CrmService service = new CrmService();
    service.Credentials = System.Net.CredentialCache.DefaultCredentials;
    // Create the DynamicEntity object.
    DynamicEntity contactEntity = new DynamicEntity();
    // Set the name of the entity type.
    contactEntity.Name = EntityName.contact.ToString();

    // Set the properties of the contact.
    PropertyCollection properties = new PropertyCollection();
    properties.Add(sp_Field1);
    contactEntity.Properties = properties; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T14:56:39.590

感谢 SaaS 开发人员，该代码现在运行良好。另一种方法是将 StringProperty 直接添加到实体属性集合中。

```
contactEntity.Properties.Add(sp_SSNNo); 
```

再次感谢您的回复：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T14:09:46.160

我认为问题在于您正在引用 Microsoft.Crm.Sdk 程序集中的动态实体类。SDK 中的示例使用对 CRM Web 服务的引用。这可能会让人感到困惑，因为这两个程序集都包含许多相同的类型，但它们是不同的。

# c# - 使用 LINQ 保持顺序

> ID：204505
> 
> 赞同：394
> 
> 时间：2008-10-15T12:20:13.293
> 
> 标签：c#, arrays, linq, sorting, data-structures

我在有序数组上使用 LINQ to Objects 指令。我不应该执行哪些操作来确保数组的顺序没有改变？

* * *

## 回答 #1

> 赞同：710
> 
> 时间：2008-10-15T13:51:27.133

我检查了[System.Linq.Enumerable](http://msdn.microsoft.com/en-us/library/system.linq.enumerable_methods.aspx)的方法，丢弃了任何返回非 IEnumerable 结果的方法。我检查了每个人的备注，以确定结果的顺序与源的顺序有何不同。

绝对保持秩序。您可以通过索引将源元素映射到结果元素

*   可枚举
*   投掷
*   康卡特
*   选择
*   数组
*   列表

保持秩序。元素被过滤或添加，但不会重新排序。

*   清楚的
*   除了
*   相交
*   类型
*   前置（.net 4.7.1 中的新功能）
*   跳过
*   跳过时
*   拿
*   TakeWhile
*   在哪里
*   Zip（.net 4 中的新功能）

Destroys Order - 我们不知道预期的结果是什么顺序。

*   到字典
*   去查查看

明确重新定义顺序 - 使用这些来更改结果的顺序

*   排序依据
*   按降序排列
*   逆转
*   然后通过
*   然后降序

根据一些规则重新定义订单。

*   GroupBy - IGrouping 对象的生成顺序基于 source 中生成每个 IGrouping 的第一个键的元素的顺序。分组中的元素按照它们在源中出现的顺序产生。
*   GroupJoin - GroupJoin 保留外部元素的顺序，并且对于外部的每个元素，匹配元素从内部开始的顺序。
*   Join - 保留外部元素的顺序，并且对于这些元素中的每一个，保留内部匹配元素的顺序。
*   SelectMany - 对于 source 的每个元素，调用选择器并返回一系列值。
*   Union - 当枚举此方法返回的对象时，Union 按该顺序枚举第一个和第二个，并产生每个尚未产生的元素。

* * *

编辑：我已经将 Distinct 移动到 Preserving order based on this [implementation](https://github.com/dotnet/corefx/blob/master/src/System.Linq/src/System/Linq/Enumerable.cs)。

```
 private static IEnumerable<TSource> DistinctIterator<TSource>
      (IEnumerable<TSource> source, IEqualityComparer<TSource> comparer)
    {
        Set<TSource> set = new Set<TSource>(comparer);
        foreach (TSource element in source)
            if (set.Add(element)) yield return element;
    } 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2008-10-15T12:24:00.523

您实际上是在谈论 SQL，还是在谈论数组？换句话说，您使用的是 LINQ to SQL 还是 LINQ to Objects？

LINQ to Objects 运算符实际上并未更改其原始数据源——它们构建了由数据源有效支持的序列。改变排序的唯一操作是 OrderBy/OrderByDescending/ThenBy/ThenByDescending - 即使这样，对于相同排序的元素，这些操作也是稳定的。当然，很多操作都会过滤掉一些元素，但是返回的元素会按照相同的顺序排列。

如果您转换为不同的数据结构，例如使用 ToLookup 或 ToDictionary，我不相信此时会保留顺序 - 但无论如何这有些不同。（但我相信，映射到同一键的值的顺序会保留以供查找。）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-15T12:25:09.333

如果您正在处理数组，听起来您使用的是 LINQ-to-Objects，而不是 SQL；你确定吗？大多数 LINQ 操作不会重新排序任何东西（输出将与输入的顺序相同） - 所以不要应用另一种排序（OrderBy[Descending]/ThenBy[Descending]）。

[编辑：正如乔恩说得更清楚；LINQ一般会创建一个*新*序列，不理会原始数据]

请注意，将数据推送到`Dictionary<,>`(ToDictionary) 将打乱数据，因为字典不尊重任何特定的排序顺序。

但最常见的事情（选择、位置、跳过、采取）应该没问题。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-06-11T21:04:43.257

我在引用官方文档的类似问题中找到了一个很好的答案。引用它：

对于`Enumerable`方法（适用于 的 LINQ to Objects `List<T>`），您可以依赖 、 或 所返回的元素`Select`的`Where`顺序`GroupBy`。`ToDictionary`对于本质上无序的事物，例如or ，情况并非如此`Distinct`。

> ### 来自[Enumerable.GroupBy](http://msdn.microsoft.com/en-us/library/bb534501.aspx)文档：
> 
> 对象的`IGrouping<TKey, TElement>`生成顺序基于 source 中生成 each 的第一个键的元素的顺序`IGrouping<TKey, TElement>`。分组中的元素按照它们出现的顺序产生`source`。

这不一定适用于`IQueryable`扩展方法（其他 LINQ 提供程序）。

资料来源：[LINQ 的可枚举方法是否保持元素的相对顺序？](https://stackoverflow.com/questions/6146724/do-linqs-enumerable-methods-maintain-relative-order-of-elements#6146742)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-15T12:53:11.447

任何“group by”或“order by”都可能会改变顺序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-05-19T09:24:16.407

这里的问题是专门指LINQ-to-Objects。

如果您使用的是 LINQ-to-SQL，则那里没有顺序，除非您使用以下命令强加：

```
mysqlresult.OrderBy(e=>e.SomeColumn) 
```

如果您不使用 LINQ-to-SQL 执行此操作，则后续查询的结果顺序可能会有所不同，即使是相同的数据也是如此，这可能会导致间歇性错误。

# project-management - 如何管理非英语客户？

> ID：204506
> 
> 赞同：4
> 
> 时间：2008-10-15T12:20:38.207
> 
> 标签：project-management

管理涉及非英语客户的软件项目时，最佳实践是什么？

哪些沟通问题是相关的？您会维护两种语言的文档（尤其是定期更新规范）吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-15T13:08:24.130

此类项目的基本风险是沟通不畅，因此首要任务是验证双方的理解，即您不仅应该验证客户是否理解您所说的 - 您还必须验证您是否理解客户所说的。然后，以验证沟通为明确目标，并根据您必须了解客户语言的资源和您的客户必须了解您的语言的资源，您和您的客户应就如何处理项目沟通达成一致：双方的文档语言、单一联络点、所有通信的书面记录、所有通信的翻译等。

为了尽量减少误解的可能性，如果可能的话，最好只用一种语言进行所有正式交流。如果沟通应以一种以上的语言进行，您必须尽量减少沟通渠道的数量，即您不能让每个人都与其他人进行沟通：应指定联络人来处理所有沟通。**熟悉项目中使用的语言的单点联系至关重要。**

应避免随意交流。所有电话会议和会议都应有描述所有协议和行动项目的书面会议记录——如果使用多种语言，所有会议记录应由单方翻译并由单点联系人审核。

我刚才描述的做法，可能看起来很难承受，但它们会避免很多头痛。

祝你好运！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-15T12:40:15.933

我的母语不是英语，所以我站在另一边。有时我们不得不用 4-6 种语言编写项目文档。

试着找懂英语的人（比如关键人物）。我尽量避免在项目中使用不同语言进行交流。当然，您可以与项目成员使用不同的语言进行交谈和写作，但如果您同时与项目的所有成员交谈或写作，则应该是一种语言。

文档应该以尽可能多的语言进行维护。所有文件都应定期更新，并尽量避免出现必须告诉他们“英语是当前的”的情况。寻找以目标语言为母语的人并为您翻译英语。与你尝试相反的方式相比，它会更好、更容易理解、更本地化。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-15T13:18:16.513

这可能是您可能想要切换到敏捷开发的完美案例。这不再强调大量文档，您可以在每个间隔结束时提供工作供客户签字。如果您不知道敏捷是什么，只需 google 一下，您就会得到大量信息。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-15T13:15:45.707

始终跟进任何口头讨论的书面确认。大多数人可以更好地阅读外语，然后他们会说它们。它还有助于选择一种语言作为所有文档和代码的标准。

# windows - Windows 网络名称解析

> ID：204513
> 
> 赞同：1
> 
> 时间：2008-10-15T12:24:19.430
> 
> 标签：windows, networking

这还不是特别与编程相关，但我对 Vista 和 XP 如何在家庭 LAN 情况下解析网络名称非常感兴趣。

在 Windows 2000 中，网络名称解析是通过 netbeui 协议完成的 - tcp/ip 网络需要一个 wins 服务器。XP和Vista默认不再安装netbeui，所以我完全不清楚局域网上的PC是如何找到彼此的。

谜题解决方案的一部分似乎是，如果网络上有一个路由器设备配置为 DHCP 服务器（因此，配置为 DNS 服务器），则 PC 名称的 DNS 查询往往会得到解决。

在更孤立的情况下——连接到以太网集线器的几台 XP 和 Vista PC，配置为仅与 tcp/ip 通信——名称解析和广播涉及哪些服务和协议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-07T08:49:10.357

自从我不得不专业地处理这类事情以来已经有一段时间了，所以我怀疑我能否给你一个准确的即兴答案，但我会这样说：如果你可以访问类似于如果您感兴趣，我强烈建议您在其中一台机器上安装[Wireshark](http://www.wireshark.org/)或类似工具，然后简单地观察相关网络上的流量。即使现实与人们合理预期的情况大相径庭，它也很容易做到，并且可以非常快速地生成有关特定配置的可靠信息。我经常对我所看到的一些事情感到非常惊讶，尤其是在名称解析方面。

生成名称查找流量本身很简单——事实上，Wireshark 本身可能会尝试查找名称以便将它们包含在其输出中，除非您要求它不要这样做，因此您可能根本不需要采取任何显式操作，具体取决于. 请记住注意缓存和开关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-20T10:56:10.427

老问题，但要完成：

在对等网络中（即没有 Active Directory、WINS 服务器等）：

Windows Vista 及更高版本使用[链路本地多播名称解析 (LLMNR)](http://en.wikipedia.org/wiki/Link-local_Multicast_Name_Resolution)，回退到基于 TCP/IP 广播的 NetBios，这是 Windows XP 使用的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T12:41:16.073

看起来对等名称解析协议正在与 Vista 和 XP 一起使用。

对等名称解析协议 [http://technet.microsoft.com/en-us/library/bb726971.aspx](http://technet.microsoft.com/en-us/library/bb726971.aspx)

我附近的人 [http://technet.microsoft.com/en-us/library/bb726969.aspx](http://technet.microsoft.com/en-us/library/bb726969.aspx)

编辑：在 Chris 的评论之后做了更多的挖掘之后，这里有一个关于 Windows XP Professional 如何解析名称的链接： [http ://technet.microsoft.com/en-us/library/bb457118.aspx#ECAA](http://technet.microsoft.com/en-us/library/bb457118.aspx#ECAA)

# .net - Java Lucene 与 .Net 的集成

> ID：204519
> 
> 赞同：3
> 
> 时间：2008-10-15T12:27:12.093
> 
> 标签：.net, lucene, solr, nutch

我有 nutch 和 lucene 设置来抓取和索引一些网站，我想使用 .net 网站而不是 nutch 附带的 JSP 网站。

谁能推荐一些解决方案？

我已经看到了在索引服务器上运行的应用程序的解决方案，.Net 站点使用远程连接连接到该应用程序。

速度显然是一个考虑因素，所以这仍然可以表现良好吗？

**编辑：** NHibernate.Search 可以为此工作吗？

**编辑：**我们最终选择了我们的 ASP.net 站点使用的 Solr 索引服务器和[solrnet](http://code.google.com/p/solrnet/)库。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-27T19:25:34.810

如果其他答案不完全清楚，Lucene.NET 和 Lucene (Java) 使用相同的索引格式，因此您应该能够继续使用现有的（基于 Java 的）**索引**机制，然后使用 Lucene .NET 在您的 .NET Web 应用程序中**查询**索引。

从[Lucene.NET 孵化器站点](http://incubator.apache.org/lucene.net/)：

> 除了 API 和类移植到 C# 之外，Java Lucene 的算法也移植到 C# Lucene。这意味着使用 Java Lucene 创建的索引 与 C# Lucene**来回兼容；**在阅读、写作和更新方面。事实上**，可以使用 Java Lucene 和 C# Lucene 进程同时搜索和更新 Lucene 索引**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-15T12:54:52.287

除了使用 Lucene，您可以使用[Solr](http://lucene.apache.org/solr/)通过 nutch 进行索引（请参阅[此处](http://blog.foofactory.fi/2007/02/online-indexing-integrating-nutch-with.html)），然后您可以使用以下两个可用库之一非常轻松地连接到 Solr：[SolrSharp](http://www.codeplex.com/solrsharp)和[SolrNet](http://code.google.com/p/solrnet/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T16:39:27.483

我也在做这件事。

[http://today.java.net/pub/a/today/2006/02/16/introduction-to-nutch-2.html](http://today.java.net/pub/a/today/2006/02/16/introduction-to-nutch-2.html)

看来您可以将查询提交给 nutch 并返回 rss 结果。

编辑：

今天以 Windows 形式运行，作为概念证明。两个文本框（searchurl 和 query），一个用于服务器 url，一个用于查询。一个数据网格视图。

```
private void Form1_Load(object sender, EventArgs e)
        {
            searchurl.Text = "http://localhost:8080/opensearch?query=";

    }

    private void search_Click(object sender, EventArgs e)
    {
        string uri;

        uri = searchurl.Text.ToString() + query.Text.ToString();
        Console.WriteLine(uri);

        XmlDocument myXMLDocument = new XmlDocument();

        myXMLDocument.Load(uri);

        DataSet ds = new DataSet();

        ds.ReadXml(new XmlNodeReader(myXMLDocument));

        SearchResultsGridView1.DataSource = ds;
        SearchResultsGridView1.DataMember = "item";

    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-12T15:48:37.820

通过搜索 SolrNet 和 SolrSharp 之间的比较到达这里，只是想我会在这里留下我的印象。

似乎 SolarSharp 是一个死项目（很长时间没有更新），所以唯一的选择是 SolarNet。

我希望这会对某人有所帮助，我会对已接受的答案发表评论，但我还没有足够的声誉:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T14:41:29.683

我没有使用 Solr，而是编写了一个在 cron 作业中运行的基于 Java 的索引器，以及一个用于查询的基于 Java 的 Web 服务。实际上，我并没有像 .net 站点用于构建页面的不同类型的数据那样索引页面。所以实际上有 4 个不同的索引，每个索引都有不同的文档结构，它们都可以以大致相同的方式进行查询（例如：用户、帖子、消息、照片）。

通过为 Web 服务响应定义 XSD，我能够在 .net 和 java 中生成类来存储文档的表示。Web 服务基本上在正确的索引上运行查询，并从命中填写响应 xml。.net 客户端将其解析回对象。还有一个用于任何客户端 JavaScript 的 json 接口。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T06:38:53.417

为什么不从 java lucene 切换到 dot net 版本。当然，这是一项投资，但主要是一种班级替代活动。你需要的最后一件事是更多的层，除了粘合之外没有任何价值。更少的胶水和更多的东西是你应该追求的......

# version-control - 有没有办法用另一个非 Tcl/Tk diff 实用程序替换 diff 实用程序？

> ID：204529
> 
> 赞同：1
> 
> 时间：2008-10-15T12:32:18.540
> 
> 标签：version-control, cvs

我在 Windows XP 机器上使用 TkCVS 作为 CYGWIN CVS 客户端的 GUI 前端。这是一个很好的折衷方案，因为在我的 Linux 机器上我也在运行 TkCVS（运行 CVS 服务器的同一台机器，顺便说一句......）。

我有兴趣用商业产品（如 BeyondCompare 或 ExamDiff ...）替换 diff 实用程序（它有一个 tkdiff.tcl GUI 前端，用于 TkCVS）

有没有人有办法做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T18:35:18.310

来自[tkcvs 常见问题解答](http://www.twobarleycorns.net/tkcvs/FAQ)：

> Q4。我可以在 tkcvs 中使用 tkdiff 以外的差异工具吗？
> 
> A. 是的，通过更改 cvscfg(tkdiff)。您通常必须为您的 diff 工具编写一个包装器，以使其检查版本，并处理其特定的命令行选项，这些选项可能与 tkdiff 不同。
> 
> 在 contrib 目录中，有一个名为 "cvsdiff" 的 gvim-wrapper，它可以按原样使用，也可以作为包装您喜欢的 diff 工具的模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T12:43:55.973

只使用 cvs diff 命令怎么样？

或者下载 vim 的 cvscommand 插件模块。

# asp.net - 列表框值在回发中持续存在

> ID：204538
> 
> 赞同：2
> 
> 时间：2008-10-15T12:34:50.830
> 
> 标签：asp.net

我在 ASP.net 中有一个列表框。我正在从页面中的另一个列表框中动态填充列表框值。在回发期间，输出列表框的值不会被保留。（在转到另一个页面并返回此页面时）。

请提出一些好的答案。EnableViewstate = "true" 不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T12:39:04.190

您是否在 Page_Load 中做任何应该在

```
if(!IsPostBack) {} 
```

加载中的初始化代码只需要在页面首次加载时调用，而不是在回发时调用。

如果你要去另一个页面，然后再回到这个页面，我认为你需要自己在 Session 中保存信息，然后在你回到页面时恢复它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T12:51:27.473

仅当您在同一页面上进行回发时，才会保留视图状态。正如卢佛朗哥所写

```
if(!IsPostBack) {} 
```

您在初始页面请求中使用它来填写数据。如果您希望跨页面保留数据，则使用会话存储值是最好的选择。

据我所知，最好在 PreInit 中的 SaveViewState 事件之前填写列表框中的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T12:50:34.540

在 Page 的 Init 事件 (Page_Init) 中初始化控件的内容。这样用户提供的任何值都不会被您的默认值覆盖。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T12:51:30.110

EnableViewState 将使用页面首次呈现时的值重新填充输出列表框，因为它们仍然是存储在视图状态中的值。浏览器仅在回发中发送选定的值，因此服务器无法知道您在客户端上添加了哪些其他值。

您可以通过向页面添加隐藏输入并在更新列表框时使用动态值填充它来解决此问题。然后，您的页面可以在回发期间检查该值并正确重新填充列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-11T18:17:40.417

对客户端列表框所做的更改在回发期间不会保留，您需要将该信息记录在隐藏字段中，然后在 page_load 事件期间配置控件以使更改在回发的其余部分中保持不变。

# eclipse - 在 Eclipse 中更改概览标尺颜色

> ID：204548
> 
> 赞同：7
> 
> 时间：2008-10-15T12:38:49.340
> 
> 标签：eclipse, settings, colors

如何在 Eclipse 3.4.0.I20080617-2000 中更改概览规则**背景**颜色（编辑窗口右侧的垂直条带有一些注释）？

General > Editors > Text Editors > Annotations 只允许更改标记本身的颜色，而不是整个条的背景。

看起来我的网络搜索技能越来越弱，因为我在任何地方都找不到它......

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2011-08-06T10:06:41.137

我还遇到了无法在注释标尺中看到颜色的问题，因此我制作了一个小插件，可以为标尺设置背景颜色。你可以从这里 D/L 它：[https ://github.com/chookapp/AnnotationsRulerBackground](https://github.com/chookapp/AnnotationsRulerBackground)

（截图在：[https](https://github.com/chookapp/AnnotationsRulerBackground) ://github.com/chookapp/AnnotationsRulerBackground ）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T23:30:50.360

我和 Michal 有同样的问题 - 这似乎是不可定制的。

由于 Vista 的颜色较浅，我无法在概览标尺中看到一些注释标记。您可以更改标记的颜色，但条本身不会更改颜色。

看起来改变它的唯一方法是改变所有窗口的系统颜色。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-15T12:40:53.483

您只能更改编辑器内出现标记的颜色（常规 > 编辑器 > 文本编辑器 > 注释）。总览标尺中的颜色是根据该颜色计算得出的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-05-29T16:40:31.353

在 e4_classic_win7.css 的末尾添加以下行

```
#org-eclipse-e4-ui-compatibility-editor Composite > Canvas {
    background-color : #232323;
} 
```

该文件位于
Eclipse Kepler：\plugins\org.eclipse.platform_4.3.2.v20140221-1700\css\
Eclipse Mars：\plugins\org.eclipse.ui.themes_1.1.1.v20151026-1355\css\

请务必在 Preferences->General->Appearance 中选择 windows clasic 主题
并重新启动 eclipse。

或者，您可以编辑其他相应的 css 文件。
注意：您必须选择自己喜欢的 RBG 颜色而不是 #232323

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-08-09T09:39:24.537

我的解决方案是在所有文本编辑器中使文本在深色背景上变亮。`(Window -> Preferences -> General -> Editors -> Text Editors -> Background color => BLACK`，然后是您需要的每个“语法着色”）

这样，我选择的注释颜色可以是高度饱和的深色 - 然后文本仍然可以在文本编辑器中的注释突出显示处清晰可见，但概览标尺中的标记也非常可见（假设您的操作系统中的窗口颜色为浅色）。

这样做的缺点是您必须进行大量自定义才能到达那里。（如果您打算沿着这条路线走，那么值得导出您对其他工作区的偏好。）它更多的是一种解决方法而不是答案:-(

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-30T15:47:21.217

它似乎对我有用。唯一要做的就是在更改后“重新启动”Eclipse。总览标尺和编辑器将显示所选颜色

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-08-21T02:02:38.853

如果你使用的是 eclipse 4，试试这个。 [https://github.com/jeeeyul/eclipse-themes](https://github.com/jeeeyul/eclipse-themes)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-12-21T19:26:38.387

实际上，您可以通过转到 Preferences > General > Editors > Text Editors 来禁用此栏。然后只需取消选中标有“显示范围指示器”的框。注释仍会出现，栏将采用您主题的颜色。[在那里](https://stackoverflow.com/questions/16449728/eclipse-change-vertical-bar-color)找到了解决方案。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-11-08T16:16:51.267

我在下面添加并在 eclipse luna 和 neon 中运行良好。有用

```
#org-eclipse-e4-ui-compatibility-editor Canvas,
#org-eclipse-e4-ui-compatibility-editor Canvas > * > * {
    background-color: #b5c7ce;
}
    background-color: #e0d2d2;
}
```

# sql - Oracle中将数据插入时间戳（6）类型字段的语法是什么

> ID：204549
> 
> 赞同：3
> 
> 时间：2008-10-15T12:38:51.523
> 
> 标签：sql, database, oracle, records

我需要在 Oracle 的表中插入一些数据。

唯一的问题是其中一个字段是时间戳（6）类型，它是必需的数据。我不关心这里实际发生了什么，我只需要为条目获取正确的语法，以便数据库接受它。

我正在使用 gui Web 客户端输入数据，但如果必须，我不介意使用原始 SQL。

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-15T13:04:24.217

我不知道这是否有帮助，但在 SQL*Plus 中我这样做了：

```
create table x ( a timestamp(6));
insert into x values ( current_timestamp );
select * from x; 
```

给我这个：

```
T
---------------------------------------------------------------------------
15-OCT-08 02.01.25.604309 PM 
```

所以看起来很有效。

如果您需要将先前已知的值放入列中，那么 TO_TIMESTAMP() 函数怎么样？像这样的东西：

```
select to_timestamp('27/02/2002 15:51.12.539880', 'dd/mm/yyyy hh24:mi.ss.ff') 
from dual ; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-09-09T13:00:09.397

使用`to_timestamp()`是一种选择。另一个是这样做的：

```
INSERT INTO table VALUES (timestamp'2009-09-09 09:30:25 CET'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-15T22:03:17.423

这里有几个对我有用的不同的 TO_TIMESTAMP 函数......

此 TO_TIMESTAMP 函数对 TIMESTAMP(6) 类型的列执行 INSERT：

```
TO_TIMESTAMP('04/14/2015 2:25:55','mm/dd/yyyy hh24:mi.ss.ff') 
```

此 TO_TIMESTAMP 函数对 DATE 类型的列进行 INSERT：

```
TO_TIMESTAMP('04/15/2015','mm/dd/yyyy') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-01T17:26:18.517

```
insert into x values(to_timestamp('22:20:00','hh24:mi')); 
```

# linux - 最后修改的头文件和linux文件系统

> ID：204553
> 
> 赞同：0
> 
> 时间：2008-10-15T12:40:07.323
> 
> 标签：linux, header, last-modified

我使用 httpclient 和 last-modified 标头来检索 html 文件的最后更新日期，但是当我在 linux 机器上尝试此操作时，它会返回昨天的日期，但当我使用 Windows 机器时，它会返回今天的日期。有人知道在 linux 中使用此标头字段的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T16:26:55.853

也许，linux服务器的时钟设置不同，这种方式“生活在过去”？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T16:41:56.820

如果您使用 Windows 进行双重引导，则必须确保您的 Linux 系统配置为*不*认为 BIOS 将时钟保持为 GMT（或 UTC），而是保持本地时间。否则在 Linux 中你的 Linux 系统的时钟将一直关闭。

还要确保 /etc/localtime 文件是指向 /usr/share/zoneinfo 下正确时区文件的符号链接。

配置完这两件事后，使用命令验证您的日期和时间是否正确`date`，如果不正确，请通过以下方式正确设置：

`date MMDDhhmmCCYY.ss`

例如，对于我结束时的当前时间（2008 年 10 月 15 日 19:41:27），我将使用：

`date 101519412008.27`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T16:45:22.693

只是一个想法-也许您的文件系统是使用 noatime 选项安装的。我在这里假设您的 html 文件没有被修改，只在没有更改的情况下访问，并且没有记录“更新”时间。

你能看到文件的时间戳吗？正好是 1 天，还是只是昨天的某个时候？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T07:02:06.287

当我查看与时间相关联的日期时，它是正确的，但是在我调用 http 方法后显示的日期落后了一天。可能是缓存问题

# sql - postgresql 8.2中的嵌套事务？

> ID：204557
> 
> 赞同：11
> 
> 时间：2008-10-15T12:41:32.623
> 
> 标签：sql, postgresql, transactions

我正在研究应用数据库模式更新的脚本。我已经使用 start transaction/commit 设置了我的所有 SQL 更新脚本。我在命令行上将这些脚本传递给 psql。

我现在需要在一个事务中同时应用多个脚本。到目前为止，我想出的唯一解决方案是从原始脚本集中删除启动事务/提交，然后将它们合并到一个新的启动事务/提交块中。我正在编写 perl 脚本来即时执行此操作。

实际上，我想要嵌套事务，我无法弄清楚如何在 postgresql 中执行。

有没有办法为此目的执行或模拟嵌套事务？我已经设置了自动解决任何错误的东西，所以如果任何较低的交易失败，我不需要继续进行顶级交易。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-15T12:56:18.070

好吧，您可以使用 SavePoints 在 postgresql 中使用嵌套事务。

以这个代码示例为例：

```
CREATE TABLE t1 (a integer PRIMARY KEY);

CREATE FUNCTION test_exception() RETURNS boolean LANGUAGE plpgsql AS
$$BEGIN
   INSERT INTO t1 (a) VALUES (1);
   INSERT INTO t1 (a) VALUES (2);
   INSERT INTO t1 (a) VALUES (1);
   INSERT INTO t1 (a) VALUES (3);
   RETURN TRUE;
EXCEPTION
   WHEN integrity_constraint_violation THEN
      RAISE NOTICE 'Rollback to savepoint';
      RETURN FALSE;
END;$$;

BEGIN;

SELECT test_exception();
NOTICE:  Rollback to savepoint
 test_exception 
----------------
 f
(1 row)

COMMIT;

SELECT count(*) FROM t1;
 count 
-------
     0
(1 row) 
```

也许这会对你有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T14:25:08.250

我最终在带外“解决”了我的问题 - 我使用 perl 脚本重新处理输入脚本以消除它们的启动事务/提交调用，然后将它们全部推送到一个文件中，从而获得它自己的启动事务/犯罪。

# windows-mobile - 有没有一种简洁的方法可以在紧凑的框架 3.5 中播放 mp3 声音

> ID：204562
> 
> 赞同：4
> 
> 时间：2008-10-15T12:45:54.223
> 
> 标签：windows-mobile, compact-framework, playback

我使用 p/invoke 方法来播放`wav`声音。有一些方法可以调用 windows 媒体播放器来播放`mp3`声音，但它速度慢且麻烦。

有没有简单的方法来播放短`mp3`文件？

这主要用于当您不看屏幕而不看音乐时的应用程序**提示**和**声音提示。**

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-12-28T23:15:21.943

如果您正在寻找播放 mp3 的方法：

```
公共课声音
{
    [DllImport("aygshell.dll", SetLastError = true)]
    私有静态外部 IntPtr SndPlaySync(string pszSoundFile, uint dwFlags);
    [DllImport("aygshell.dll")]
    private static extern uint SndOpen(string pszSoundFile, ref IntPtr phSound);
    [DllImport("aygshell.dll")]
    私有静态外部 uint SndPlayAsync(IntPtr hSound, uint dwFlags);
    [DllImport("aygshell.dll")]
    私有静态外部 uint SndClose(IntPtr hSound);
    [DllImport("aygshell.dll")]
    私有静态外部 uint SndStop(int SoundScope, IntPtr hSound);

    常量 int SND_SCOPE_PROCESS = 0x1;
    私人静态随机_随机=新随机（）；

    // 初始化启动路径...您将在其中保存临时 mp3
    私有静态字符串_startupPath；
    公共静态字符串 StartupPath
    {
        得到{返回声音._startupPath; }
        设置 { Sound._startupPath = value; }
    }

    私有枚举 SND
    {
        同步 = 0x0000，
        异步 = 0x0001，
        节点默认 = 0x0002，
        内存 = 0x0004，
        循环 = 0x0008，
        NOSTOP = 0x0010，
        现在 = 0x00002000,
        别名 = 0x00010000，
        别名 ID = 0x00110000，
        文件名 = 0x00020000，
        资源 = 0x00040004
    }

    公共静态无效播放声音（字符串文件名）
    {
        播放声音（文件名，空）；
    }

    public static void PlaySound(string fileName, WaitCallback 回调)
    {
        SndStop(SND_SCOPE_PROCESS, IntPtr.Zero);
        ThreadPool.QueueUserWorkItem(playSoundProcess,
            新对象 [] {文件名，回调 });
    }

    私人静态无效playSoundProcess（对象o）
    {
        对象[] par = (object[])o;
        字符串文件名 = (string)par[0];
        WaitCallback 回调 = (WaitCallback)par[1];
        SndPlaySync（文件名，0）；

        尝试
        {
            文件.删除（文件名）；
        }
        抓住
        { }

        如果（回调！= null）
            回调。调用（文件名）；
    }

    公共静态无效ClearSounds（）
    {
        SndStop(SND_SCOPE_PROCESS, IntPtr.Zero);
        尝试
        {
            string[] oldFiles = Directory.GetFiles(StartupPath, "*.mp3");
            foreach（oldFiles 中的字符串 f）
                文件.删除（f）；
        }
        抓住
        { }
    }

    public static void PlaySound(byte[] mp3, WaitCallback 回调)
    {
        string temp = string.Format("{0}\\{1}-{2}.mp3", StartupPath, DateTime.Now.Ticks, _random.Next());
        使用 (FileStream fs = File.Create(temp))
        {
            fs.Write(mp3, 0, mp3.Length);
        }

        播放声音（临时，回调）；
    }
}

```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-15T18:44:00.193

CF Framework 3.5 现在支持播放 .WAV 文件：

[命名空间 System.Media.SoundPlayer](http://msdn.microsoft.com/en-us/library/system.media.soundplayer.aspx)

用于提示和音效的短 WAV 文件甚至可能比 MP3 播放*得更快*，因为它们是“准备播放”的......

# c# - 获取特定成员的 CustomAttributes

> ID：204564
> 
> 赞同：1
> 
> 时间：2008-10-15T12:46:18.323
> 
> 标签：c#, reflection, attributes

有什么方法可以获取我在方法中接收的特定对象的自定义属性？

我不想也不能遍历 Type.GetMembers() 并搜索我的成员。我有一个具有属性的对象，它也是一个成员。

我如何获得属性？

```
class Custom
{
    [Availability]
    private object MyObject = "Hello";

    private void Do(object o)
    {
        //does object 'o' has any custom attributes of type 'Availability'?
    }

    //somewhere I make the call: Do(MyObject)

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T12:52:15.053

不，对象没有属性——成员有。当您使用“Do”方法时，没有记录表明您调用了 Do(MyObject) 与 Do(MyOtherFieldWhichHasTheSameValue)。

如果您需要查找成员的属性，则基本上必须传入相关的 MemberInfo，而不是它的评估结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T12:50:07.787

如果没有至少 1 个反射调用，您将无法执行此操作。之后，以某种方式保存该值。

例子：

```
abstract MyBase
{
  public string Name;
  protected MyBase()
  {
    //look up value of Name attribute and assign to Name
  } 
}

[Name("Foo")]
class MyClass : MyBase
{
} 
```

# python - 有使用交付系统的经验吗？

> ID：204570
> 
> 赞同：0
> 
> 时间：2008-10-15T12:48:02.050
> 
> 标签：python, html, deliverance

我的新老板参加了一次演讲，其中介绍了 Deliverance，一种允许在运行中为任何 html 输出添加皮肤的代理。他决定在那之后立即使用它，无论它多么年轻。

更多在这里：

[http://www.openplans.org/projects/deliverance/introduction](http://www.openplans.org/projects/deliverance/introduction)

从理论上讲，当您希望新手调整您的克隆主题而无需教他 zope 产品背后的所有复杂机制时，该系统听起来很棒。并在 Drupal 网站上连续应用相同的主题。

但我不相信理论，并且想知道是否有人在现实世界中尝试过这个:-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-05-13T09:31:47.550

在过去 4 年左右专业使用 Plone，并在 4 个商业网站上使用了 Deliverance，我建议所有新的前端开发人员（和老手一样）使用 Deliverance 来主题 Plone 网站。

它比旧的、混乱的方法*更*容易学习（几周 vs 几个月），并且可能比旧的、混乱的方法更强大——你仍然需要其中的一些方法（即使是在生命的后期阶段）地点）。

不仅如此，它还使用 XPath 和 CSS 选择器，并且可以在非 Plone 站点上使用，因此投入的时间很容易转移。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T21:47:04.280

请注意，plone.org 使用 xdv，这是一种编译为 xslt 的交付版本。尝试它的最简单方法是使用[http://pypi.python.org/pypi/collective.xdv](http://pypi.python.org/pypi/collective.xdv) ，尽管 plone.org 在（修补的）Nginx 中运行 xslt。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T18:05:38.397

plone 网站本身 ( [http://plone.org](http://plone.org/) ) 以拯救为主题。据我所知，它是第一个使用deliverance的大型生产克隆站点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T12:58:03.123

在我们进行测试时，我将在这里开始回答这个问题，但我很想得到其他用户的反馈。

## 安装

我们花了一个下午的时间从教程到“如何”，最终在虚拟机上安装和运行这个东西。

这个没问题：[http ://www.openplans.org/projects/deliverance/getting-started](http://www.openplans.org/projects/deliverance/getting-started)

有 setuptools 包，但这不能开箱即用（当然也不能不编译任何东西）。我们必须安装：

*   setuptools >= 0.6c5（使用来自[http://pypi.python.org/pypi/setuptools/](http://pypi.python.org/pypi/setuptools/)的 0.6c9 进行测试）。
*   当然，编译意味着安装 gcc、linux-header 和 lib6-dev
*   开发中的 libxslt（我们使用 libxslt1-dev）
*   与 zl so zlib 链接（我们使用 zlib1g-dev）
*   你最好在开始 Deliverance 安装之前安装 Pastescript
*   安装 python-nose 不是强制性的，但它有助于检查一切是否正常

我们没有设法让它与 python-virtualenv 一起工作，因为我们确实搞砸了 debian 系统，但它似乎运行正常。

希望它可以提供帮助。

# project-management - 软件代理机构如何交付高质量的软件/赢得项目？

> ID：204572
> 
> 赞同：26
> 
> 时间：2008-10-15T12:49:49.160
> 
> 标签：project-management, bids

我目前在一家定制软件机构工作。有没有人有任何如何赢得价格合理的工作的经验？

似乎来自离岸/卧室编程团队的竞争如此激烈，如今成本极具竞争力。我觉得在预算上和软件产品公司或者内部 IT 部门相比是很不一样的。

正如其他人之前所说，除非客户端足够大，否则我们只能真正达到许多软件的 1.0 版。在这种情况下，花费大量时间将软件做得最好是没有商业意义的。这就像我们在做与内部 IT 员工一样的工作质量。我们的许多客户也没有技术头脑，因此不会为他们不理解的东西付费。

由于我们公司没有钱拒绝工作，因此我们经常以太少的钱承担复杂的工作。我在管理变更和保持严格的规格等方面做得更好。这仍然很难。

编辑 - - - - - - - - - - - -

从这篇文章发布将近 3 年，我可以列出从那时起我学到的一些重要经验教训。

请看下面我的回答

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-15T13:35:32.937

如果你担心用太少的钱做太多的工作，那就按小时工作。是的，在大多数情况下，这更难卖。

也许您可以尝试两阶段的方法。有一个非常短的初始参与，其中可交付成果是非常具体的需求文档，成为客户的财产。您冒着必须为实际开发而竞争的风险，但您消除了将项目定价过低的风险，因为您已经了解客户喜欢使用什么以及应用程序要求。

一旦您以合理的价格赢得工作，然后使用 mathieu 建议的最佳实践来帮助确保质量和生产力，从而降低您产生的成本。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-15T13:41:52.037

您在帖子中描述的（不是您的问题），我认为首先是销售、管理和营销问题。

你说你的客户没有技术头脑，这需要有一个有凝聚力的销售、咨询和沟通策略，这与编程技能无关。

此外，如果您的公司不断接受对您的团队来说过于复杂或昂贵的项目，而您交付的产品质量低下，您迟早会陷入困境。您将吸引您不想要的客户，而现有客户将因您的“无能”而被拒之门外，迟早会找到另一家公司，他们会尝试在其中进行相同的价格游戏。在我看来，这些客户一文不值。

你问'你如何赢得价格合理的工作'？人是群居动物，他们互相交谈。如果市场认为您是一家不可靠的公司，人们和未来的客户迟早会知道。客户不在乎你是否以非常低的价格提供了产品，而且时间太紧了——这并不是他们的错误，而是你接受了它。所以再一次，我认为整个考验是一种糟糕的商业行为。

我发现你真的必须为低预算的工作定义严格的规格，定义你将交付和可以交付的产品，告诉他们价格，阻止你的老板提供太多的长期客户折扣价格标签，因为他们太害怕失去客户。当事情开始失控时，尽早并经常进行沟通。为附加功能编写精确的报价。把这些准确地写下来，不要依赖电话交谈（你：“那是额外的 4 个小时的工作”，客户：“好的”...... 4 个月后，客户“那又是什么？？？我为什么要支付这个”）。

当然，现在降低价格的一种方法是不雇用完全的白痴，这些白痴最初可能比更合格的程序员便宜。这是一种短视的做法，会惨遭失败。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-20T00:53:02.037

与客户的关系将为您赢得更多业务。一位开发人员实际上挺身而出并停止了一个项目，因为他的销售顾问基本上就解决方案集向我们撒了谎。然后，开发人员在相同的预算内提供了一个简单的、简单的解决方案，并且他按时交付了。

这个人和他的团队已经在我公司咨询了 6 年多了。他的正直和认真、勤奋的天性是一个巨大的优势，随着他的声誉越来越高，他找到了优秀的人才为他工作。他的诚实比我通过将公司的智力资产运送到海外所获得的任何储蓄都更有价值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-19T23:23:24.170

“来自离岸/卧室项目团队的竞争如此激烈” - 听起来你们需要一些时间来建立网络。归根结底，人们喜欢与人做生意，而不是与企业做生意。如果您在客户社区中广为人知并受到喜爱，那么您将成为领跑者，并且您将从建立的信心中获得更好的价格。推荐会给你一个强大的优势 - 要求他们。

“我们公司没有钱拒绝工作”——很多公司都以此为起点，但最终你必须克服这种方法。你花在这些类型工作上的时间阻碍了成功。你需要决定你想做什么类型的工作（以及客户将是谁），同样重要的是你不做什么。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-10T11:40:03.857

作为一名顾问，出于这个原因，我个人已转向仅按小时计费的模型。我被太多疯狂的合同烧伤了，我感受到了你的痛苦。

最后，那些只接受最低价格提案的人会给你的公司带来麻烦。虽然您不能如此挑剔，以至于您永远不会获得项目，但您绝对希望避开那些支持管理层对实际软件开发过程如此不可知论的合同，以至于他们只看最初的价格标签。 . 通常，改变利润率和时间表的是合同或规范中没有的东西。

预先挑剔而不是降低价格通常对您最有利，以便接收最终成为麻烦客户的浪潮。在您的情况下，虽然 RFP 之间总是存在不如技术要求规范简洁的争论，但初始报价应理解为基于 RFP 中的清晰程度的一般估计。

我绝对同意 kitsune，如果您的公司一直在接受不适合您公司的开发专业知识或带宽的合同，那么结果就是开销和声誉不佳。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-06-23T18:24:18.297

这可以看作是上述问题的快速指南。

**提案文件**

1.  从一份提案文件开始，尽可能地解释您对客户需求的理解。这可以在至少 1-2 页的写作中完成。它可以开始朝着要求前进，但它应该比这更随意。

**预算文件**

2.  现在转到 Excel 并列出项目中您认为必须完成的所有任务。以天为单位记下时间，不大于 2（0.25、0.5 等）。

3.  添加一列进行测试，并使其占开发时间的百分比（20-30％是正常的）

4.  现在添加一个管理列（项目 + 帐户）并为此添加时间百分比（超过前两列）。20-40% 是正常的。（70-30 分下午/上午）

5.  为您的公司设置日费率。您可以变得更复杂，并为不同的用户功能设置不同的费率，但至少要设置一个费率，这意味着无论执行什么工作，您都将获得良好的利润。

6.  算出到目前为止已记录的总天数的值是多少。然后在此之上添加一个应急金额（对于固定价格工作）10-20% 在这里是正常的，但可以根据客户的经验和您习惯与他们相处的变化量而改变。

7.  此时，您可以对总金额进行折扣，这比降低本文档的任何其他部分要好，因为它会向客户表明您并没有神奇地让工作变得更快，而是您正在减少一些利润。因此，他们不应期望您缩短项目的时间范围。

**重要 - 在制定成本核算时分析客户的预算和业务。将专为大型企业设计的成本核算提供给希望经济高效地完成应用程序的伙伴是没有意义的。同样，请确保您向习惯于高端自由职业者费率的组织正确收费。

像业务分析师一样思考。它不仅可以帮助您在客户看到您的成本时让他们满意，而且可能会让您更深入地了解他们的业务。如果他们要通过使用你来赚钱，那么你可能会成为赢家。如果你不能直接问他们要花多少钱，可以通过询问他们有多少客户、他们收取什么费用、他们有多少员工等来计算。然后你应该能够弄清楚如果什么您的提议将对他们有利。**

8.  回到您的提案文档，并添加一个包含设计、开发、管理等部分的表格……您可以在某些情况下向客户展示您的成本核算表，但在大多数情况下最好避免复杂性。不过，它是作为备用的，而且您不只是咳出一个数字。

**时间线文件**

9.  从预算中取出设计和开发任务列表，并将其放入新工作表（如果您像我一样豪华，则将其放入项目）。输入每个部分的开始和结束日期，在顶部添加大约 30-50% 的额外时间。

10.  在 Excel 中以块的形式添加一些日子的图形表示，或使用[像这样的甘特模板](http://www.vertex42.com/ExcelTemplates/excel-gantt-chart.html)。

11.  返回到您的提案文档并添加时间文档中的关键里程碑。

**提案阶段完成**

12.  将您的提案发送或展示给您的潜在客户。希望他们对您提出的建议感到兴奋，并乐于进入下一阶段，即完整的需求收集。在具有相同客户的后续项目中，您可能能够直接进入需求。

**需求阶段**

13.  针对单独的 ID（1、2、4、5 或 1.1、1.2、1.3）列出每个要求。这并不重要，但第二个可以帮助处理大型列表。

14.  有一些需求测试，您可以尝试遵循这些测试，但有时它们不适用（例如，某些需求可能是设计主导的）。其中一些是：需求是否可测试，是否单一，是否清晰？我会尝试在某个地方找到指向此的链接。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-15T12:59:34.053

这是我的开发人员观点：

*   版本控制最佳实践：保持主干干净，不提交不能编译的代码，频繁提交
*   [持续集成](http://martinfowler.com/articles/continuousIntegration.html)
*   [单元测试](http://en.wikipedia.org/wiki/Unit_testing)（代码覆盖率）
*   在测试服务器上自动部署
*   应用程序的自动打包
*   尽可能自动化:)

另外，请雇用[优秀的开发人员](http://haacked.com/archive/2007/06/25/understanding-productivity-differences-between-developers.aspx)，并[善待他们](http://www.codinghorror.com/blog/archives/000012.html):)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-20T00:56:02.860

销售固定价格、固定范围的工作，而不是按小时工作。这减轻了客户超支的风险（您承担了所有风险，但无论如何您都在这样做），并根据软件的价值而非投入工作的质量来构建项目。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-01-21T02:07:19.397

我们正在尝试构建产品并重用现有经验。与乌克兰（我工作的地方）的英国相比，工资较低，但仍比印度高 4-5 倍。

到目前为止，最好的结果是获得两个需要类似解决方案的新客户，这样我们可以提供更好的定价，并且我们对我们的估计更有信心。

顺便说一句，我查看了whywaitdigital.com，似乎我们有您的客户可能需要的产品。我们做门户网站——编辑、B2C、支持地理的产品目录，我们也使用[ASP.NET MVC](http://en.wikipedia.org/wiki/ASP.NET_MVC_Framework)。您可以在我们的网站 www.socialtalents.com 上找到联系信息。

# c++ - 拆分已拆分的窗格 (MFC)

> ID：204576
> 
> 赞同：2
> 
> 时间：2008-10-15T12:50:49.937
> 
> 标签：c++, mfc, views, splitter

在我的 MFC 程序中，我使用拆分器来创建两个窗格。我现在想再次将这些窗格中的一个分成两半并放入另一个视图中，有人可以告诉我如何做到这一点或指出一些代码的方向吗？

我宁愿自己编写代码，所以我对自定义派生类不感兴趣，除非它们非常基础。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-15T13:17:21.053

在`CMainFrame::OnCreateClient`

```
// Create splitter with 2 rows and 1 col
m_wndSplitter.CreateStatic(this, 2, 1);
// Create a view in the top row
m_wndSplitter.CreateView(0, 0, RUNTIME_CLASS(CView1), CSize(100, 100), pContext);
// Create a 2 column splitter that will go in the bottom row of the first
m_wndSplitter2.CreateStatic(&m_wndSplitter, 1, 2, WS_CHILD|WS_VISIBLE, m_wndSplitter.IdFromRowCol(1, 0));
// Create views for the bottom splitter
m_wndSplitter2.CreateView(0, 0, RUNTIME_CLASS(CView2), CSize(100, 100), pContext); 
m_wndSplitter2.CreateView(0, 1, RUNTIME_CLASS(CView3), CSize(100, 100), pContext);
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T12:53:47.250

我不是 MFC 方面的专家，但你不能把一个分离器放在你用第一个分离器制作的窗格中吗？这就是我们在winform中所做的......

# vb.net - 部署时间 Webservice 位置

> ID：204580
> 
> 赞同：1
> 
> 时间：2008-10-15T12:52:11.947
> 
> 标签：vb.net, web-services, url, web-application-project

在我的 Visual Studio Web 应用程序项目中，我正在添加对 Web 服务的引用。当我添加 Web 引用时，会生成以下文件列表。

*   参考地图
*   参考资料.vb
*   参考.disco
*   参考资料.wsdl

所有这些文件都包含指向 Web 服务的 url。即使我将它移到没有视觉工作室的机器上，它也能正常工作。但是如果我打算更改 Web 服务的 url，我需要通过使用记事本编辑*这四个文件来修改所有这些文件。*

取而代之的是，有什么方法可以让我在配置文件中拥有 url，然后在一个地方更改它，然后将 Web 服务指向新位置。

我正在使用框架 1.1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T12:57:47.037

将 Web 服务引用“Url Behaviour”属性设置为 Dynamic，地址将在您的 app.config 文件中配置......

app.config 文件应该包含类似

```
 <applicationSettings>
        <Exceptions.Properties.Settings>
            <setting name="Exceptions_CentreService_CentreService" serializeAs="String">
                <value>http://localhost/CentreServiceCompatibility/CentreService.asmx</value>
            </setting>
        </Exceptions.Properties.Settings>
    </applicationSettings> 
```

# c# - 中间停止安装程序

> ID：204587
> 
> 赞同：1
> 
> 时间：2008-10-15T12:54:11.070
> 
> 标签：c#, .net, windows-installer

我想通过我的安装程序类以编程方式停止我的安装程序。我想在安装事件处理程序之前执行此操作。但是当我调用 Rollback() 时，我不知道 IDictionary SavedState 作为参数传递。我将它作为 null 传递，因为回滚引发异常。有人知道吗如何停止安装程序以编程方式运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-08T19:31:17.713

如果您正在创建作为 Visual Studio 一部分的安装项目，您应该能够将自定义操作添加到安装程序的各个部分。在自定义操作中，您可以编写代码来实现您的结果。 [MSDN 链接](http://msdn.microsoft.com/en-us/library/d9k65z2d(VS.80).aspx)

# nightly-build - Nightly Builds：我为什么要这样做？

> ID：204603
> 
> 赞同：49
> 
> 时间：2008-10-15T12:58:29.610
> 
> 标签：nightly-build

我为什么要进行**夜间构建？**

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-10-15T13:04:49.583

您应该每晚进行构建以确保您的代码库保持健康。

每晚构建的一个副作用是它迫使团​​队创建和维护一个完全自动化的构建脚本。这有助于确保您的构建过程记录在案且可重复。

自动化构建擅长发现以下问题：

*   有人签入了破坏东西的东西。
*   有人忘记签入必要的文件或更改。
*   您的构建脚本不再起作用。
*   你的构建机器坏了。

每晚执行此操作可确保您在问题发生后的 24 小时内发现此类问题。这比在交付软件前 24 小时发现所有问题要好。

当然，您还应该为每个夜间构建运行自动化单元测试。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-10-15T13:05:24.340

我个人发现持续集成比夜间构建更好：
[http ://en.wikipedia.org/wiki/Continuous_integration](http://en.wikipedia.org/wiki/Continuous_integration)

我什至在一个人的项目中使用它，令人惊讶的是，你能以多快的速度发现问题并在那里处理它们。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-10-15T13:56:38.120

我从事建筑工程（除其他外）已有 16 年了。我坚信尽早构建、经常构建、持续集成。所以我对一个项目做的第一件事是确定它将如何构建（Java：[Ant](http://ant.apache.org/)或[Maven](http://maven.apache.org/)；.NET：[NAnt](http://nant.sourceforge.net/)或[MSBuild](http://msdn.microsoft.com/en-us/library/wea2sca5(VS.80).aspx)）以及如何管理它（[Subversion](http://subversion.tigris.org/)或其他一些版本控制）。然后我将根据平台添加持续集成（ [CruiseControl](http://cruisecontrol.sourceforge.net/)或[CruiseControl.NET ），然后让其他开发人员放松。](http://ccnet.thoughtworks.com/)

随着项目的增长以及对报告和文档的需求的增长，最终构建将需要更长的时间来运行。那时，我会将构建拆分为仅编译和运行单元测试的连续构建（在签入时运行）和构建所有内容、运行所有报告并构建任何生成的文档的每日构建。我还可以添加一个交付构建，用于标记存储库并为客户交付进行任何额外的打包。我将使用细粒度的构建目标来管理细节，以便任何开发人员都可以构建系统的任何部分——持续集成服务器使用与任何开发人员完全相同的构建步骤。最重要的是，我们从不交付用于测试的构建或未使用构建服务器构建的客户。

这就是我所做的——这就是我这样做的原因（以及为什么你也应该这样做）：

假设您有一个典型的应用程序，其中包含多个项目和多个开发人员。虽然开发人员可能从一个通用的、一致的开发环境开始（相同的操作系统、相同的补丁、相同的工具、相同的编译器），但随着时间的推移，他们的环境会有所不同。一些开发人员会虔诚地应用所有安全补丁和升级，而另一些则不会。一些开发人员会添加新的（也许更好的）工具，而另一些则不会。有些人会记得在构建之前更新他们的完整工作空间；其他人只会更新他们正在开发的项目的一部分。一些开发人员会将源代码和数据文件添加到项目中，但忘记将它们添加到源代码管理中。其他人将编写依赖于他们环境的特定怪癖的单元测试。结果，您很快就会看到广受欢迎的“嗯，

通过使用单独的、稳定的、一致的、已知良好的服务器来构建您的应用程序，您将轻松发现这类问题，并且通过从每次提交运行构建，您将能够查明问题何时潜入系统. 更重要的是，因为您使用单独的服务器来构建和打包您的应用程序，它每次都将始终以相同的方式打包所有内容。没有什么比让开发人员向客户发送定制版本、让它工作、然后不知道如何重现定制更糟糕的了。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-09-06T12:54:42.690

当我看到这个问题时，首先我搜索了[**Joel Spolsky 的**](https://stackoverflow.com/users/4/joel-spolsky)答案。有点失望，所以我打算在这里添加它。

希望每个人都知道[**乔尔职业测试**](https://meta.stackexchange.com/questions/109280/should-the-joel-test-on-careers-be-updated)。

来自他关于 Joel 测试的博客[**：12 步更好的代码**](http://www.joelonsoftware.com/articles/fog0000000043.html)

> **3\. 你每天构建吗？**
> 
> 当您使用源代码控制时，有时一位程序员会不小心签入破坏构建的内容。*例如，他们添加了一个新的源文件，一切都在他们的机器上编译得很好，但是他们忘记了将源文件添加到代码存储库中。于是他们锁上机器回家，浑然不觉，满心欢喜。但是没有其他人可以工作，所以他们也不得不回家，不高兴。*
> 
> 破坏构建是如此糟糕（而且如此普遍），它有助于进行日常构建，以确保没有破坏被忽视。*在大型团队中，确保立即修复损坏的一种好方法是每天下午（例如，午餐时间）进行每日构建。每个人都在午餐前尽可能多地办理登机手续。当他们回来时，构建完成。如果它有效，那就太好了！每个人都检查了最新版本的源代码并继续工作。如果构建失败，您可以修复它，但每个人都可以继续使用预构建、完整版本的源代码。*
> 
> 在 Excel 团队中，我们有一条规则，任何破坏构建的人，作为他们的“惩罚”，负责照看构建直到其他人破坏它。这是不破坏构建的一个很好的激励，也是一个让每个人在构建过程中轮换的好方法，以便每个人都了解它是如何工作的。

虽然我没有机会进行日常构建，但我是它的忠实粉丝。

还是不服气？查看[**每日构建是您的朋友中的简介！**](http://www.joelonsoftware.com/articles/fog0000000023.html)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-15T13:05:50.407

实际上，您不需要的是持续集成和自动测试（这比夜间构建更进一步）。

如果您有任何疑问，您应该阅读[Martin Fowler 撰写的这篇关于持续集成的文章](http://martinfowler.com/articles/continuousIntegration.html)。

总而言之，您希望尽可能早地、经常地构建和测试，以便立即发现错误，以便可以修复它们，而当您引起它们时您试图实现的目标仍然记忆犹新。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-10-15T13:07:33.023

实际上，我建议您每次签入时都进行构建。换句话说，我建议您设置一个持续集成系统。

这种系统的优点和其他细节可以[在 Fowler 的文章](http://martinfowler.com/articles/continuousIntegration.html)和其他地方[的 Wikipedia 条目中找到。](http://en.wikipedia.org/wiki/Continuous_Integration)

以我个人的经验，这是一个质量控制的问题：每次修改代码（或测试，可以看作是一种需求形式）时，错误可能会悄悄出现。为了确保质量，您应该重新构建产品因为它将被运送并执行所有可用的测试。这样做的次数越多，虫子形成群落的可能性就越小。因此，优选每天（每晚）或连续循环。

此外，无论您将项目的访问权限限制为开发人员还是更大的用户群，每晚构建都可以让每个人都使用“最新版本”，从而最大限度地减少将自己的贡献合并回代码中的痛苦。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-15T13:48:54.907

*您希望定期*进行构建，以发现开发人员之间代码集成的问题。您希望*每晚*执行此操作，而不是每周执行此操作或按某个更长的时间表执行此操作的原因是，您等待发现此类问题的时间越长，解决它们的难度就越大。在每次签入时进行构建（持续集成）的做法只是将夜间构建过程推向了一个合乎逻辑的极端。

从长远来看，拥有可重复构建过程的附带好处也很重要。如果您在一个有多个项目的团队工作，那么在某些时候您将需要能够轻松地重新创建旧版本，也许是为了创建补丁。:(

构建过程自动化程度越高，为每个后续构建节省的时间就越多。它还使构建过程本身脱离了交付最终产品的关键路径，这应该会让您的经理感到高兴。:)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-15T13:02:59.803

它还取决于为您的项目工作的团队的规模和结构。如果有不同的团队相互依赖 API，那么为频繁集成进行夜间构建可能会很有意义。如果你只和一两个队友一起玩，那可能值得，也可能不值得。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-23T17:31:03.487

根据您的产品的复杂性，持续集成可能会也可能不会运行完整的测试套件。

想象一下，Cisco 正在测试一个路由器，其中包含 1000 种不同的设置进行测试。在某些产品上运行完整的测试套件需要时间。有时几周。因此，您需要针对不同目的进行构建。每晚构建可以成为更全面的测试套件的基础。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-15T13:07:49.700

任何构建自动化都比没有构建自动化要好:-)

就个人而言，我更喜欢每日构建——这样，如果构建不起作用，那么每个人都在附近修复它。

事实上，如果可能的话，那么持续集成构建是可行的方法（即在每次签入时构建），因为它可以最大限度地减少构建之间的更改量，因此可以很容易地判断谁破坏了构建并且也很容易修复构建。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-15T13:02:09.557

嗯......我想这在很大程度上取决于你的项目，当然。如果它只是您的爱好项目，没有发布，没有依赖项，并且除了您提交代码之外没有其他人，这可能是矫枉过正。

另一方面，如果有一个开发人员团队都在提交代码，那么自动夜间构建将帮助您确保存储库中代码的质量。如果有人为所有其他人做了“破坏构建”的事情，它很快就会被注意到。可能会在不注意的情况下破坏构建，例如忘记向存储库添加新文件，并且在集中位置的夜间构建将很快检测到这些。

当然还有其他可能的好处，我相信其他人会提供它们。:)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-15T13:04:08.930

我认为它们非常重要，尤其是在超过 1 人的项目中。如果有人：团队需要尽快知道：

*   签入错误文件
*   不签入文件
*   ...

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-15T13:08:13.867

有几个原因，有些会比其他的更适用

*   如果您的项目由两个或更多人进行
*   这是获取您未处理的最新版本代码的好方法
*   每晚构建提供了代码当前状态的时间片
*   如果您需要将代码发送给人们，每晚构建将为您提供稳定的构建

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-15T13:05:01.127

每晚构建仅对于大型项目是必需的（当它需要很长时间才能在一天中经常构建时）。如果您有一个不需要很长时间构建的小项目，您可以在完成功能代码片段时构建它，这样您就知道您没有在过程中搞砸任何东西。但是，对于较大的项目，这是不可能的，因此构建项目很重要，这样您就知道一切仍在正常工作

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-15T13:36:40.593

每夜构建是执行静态代码分析的理想选择（如果您在 java 世界中，请参阅 qalab 和它收集统计信息的项目）。不幸的是，这是很少做的事情。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-15T13:01:16.423

每晚构建并不总是必要的——我认为它们只对大型项目真正有用。但是如果你在一个大项目上，每晚构建是检查一切是否正常的好方法——你可以运行所有的测试（单元测试、集成测试），构建你的所有代码——简而言之，验证一切正常在你的项目中坏了。

如果您有一个较小的项目，您的构建和测试时间会更短，因此您可能有能力进行更多的常规构建。

# c++ - 超过 64 位时的未定义行为

> ID：204606
> 
> 赞同：1
> 
> 时间：2008-10-15T12:59:20.297
> 
> 标签：c++, 64-bit

在我当前的 32 位应用程序中，我（非常偶尔）通过对 64 位整数进行操作来检查溢出。

但是，在 64 位系统上似乎没有标准的 128 位整数。有没有一种检查溢出的简单方法，或者一种获取 128 位整数的方法，它适用于所有操作系统和编译器？

我尝试使用 GMP 作为更通用的解决方案，但它对我的要求来说有点重量级。

效率并不太重要，没有特定于处理器的 ASM 是。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T13:34:44.437

这个问题的大部分讨论都适用：

[如何检测整数溢出？](https://stackoverflow.com/questions/199333/best-way-to-detect-integer-overflow-in-cc)

许多用于 32 位溢出检查的技术也适用于 64 位（并非所有讨论的技术都使用下一个更大的整数类型来处理溢出）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T13:09:14.957

[本文档详细](http://www.fefe.de/intof.html)讨论了捕获溢出（在 c 中）。我不知道在 C++ 中是否有更好的方法来做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T13:59:29.067

一种解决方案是围绕 64 位 int 创建一个类，该类覆盖算术运算符以在执行操作之前进行检查。

我不记得我脑海中的 operatorX 语法（很久以前我从 C++ 切换到 Java），但一个示例是：

```
int64 myint64::add (int64 a, int64 b) {
    if (MAX_INT64 - a > b) {
        // error condition here.
    }
    return a + b;
}
int64 myint64::mul (int64 a, int64 b) {
    if (MAX_INT64 / a > b) {
        // error condition here.
    }
    return a * b;
} 
```

对于任何其他算术运算类似，尽管这对于诸如幂、阶乘等非基本函数可能会变得非常复杂。

但是，如果您从基本的算术构建块构建它们，它们就会起作用。

# javascript - JSMX ajax API 没有将表单变量传递给带有 ie7 的页面

> ID：204608
> 
> 赞同：0
> 
> 时间：2008-10-15T13:00:08.390
> 
> 标签：javascript, ajax

我有几个使用 Firefox 的页面，但是[JSMX](http://www.lalabird.com/)在使用 IE7 时没有传递表单变量。

有人经历过吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-07-08T02:46:42.813

1.  我在这里搜索了“JSMX”。这是唯一发现的问题。

2.  JSMX[网站](http://www.lalabird.com/)列出了 2008 年 2 月 10 日的“最新消息”。

3.  jQuery 完成了 JSMX 所做的一切，而且也更简单。jQuery 还做了很多很多。

4.  jQuery 拥有庞大的安装基础、大量支持，甚至由 Google、Microsoft 等提供免费的脚本托管。

所以，答案是忘记 JSMX 并使用[jQuery](http://jquery.com/)。

# sql-server - Crystal Report 数据源重映射

> ID：204611
> 
> 赞同：0
> 
> 时间：2008-10-15T13:00:45.347
> 
> 标签：sql-server, asp-classic, crystal-reports

我正在使用 Crystal Reports 和 MS SQL Server。我需要重新映射水晶报表以指向同一 SQL Server 上的不同数据库。是否有自动执行此操作的方法，还是我必须为每个报告重新映射？我目前正在通过添加一个新的数据连接来执行此操作，然后使用指定的参数更新存储过程以更改数据库（目录）。此外，重新映射后，显示报告的 .asp 崩溃如下：

Active Server Pages，ASP 0115 (0x80004005) 外部对象中出现可捕获错误 (E06D7363)。脚本无法继续运行。

代码是：

设置 mainReportTableCollection = Session("oRpt").Database.Tables

```
For Each mnTable in mainReportTableCollection
  With mnTable.ConnectionProperties
   .Item("user ID") = "<some_login_name>"
   .Item("Password") = "<some_password>"
   .Item("DSN") = "<some_DSN>"
   .Item("Database") ="<some_Database>"
  End With
Next 
```

但是，如果我注释掉最后两个分配，它就会运行。

提前致谢。

真的是你的，西尔维。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-20T08:10:27.240

以后你会发现我使用的过程（我简化了它，抑制了我们自己的对象和全局变量）。此过程允许将报表从开发时使用的原始连接重定向到活动 SQL 服务器。它是用 VB 编写的，使用 2 个主要对象：

1.  通过水晶报表实例打开的原始报表对象
2.  ADODB 连接是当前 SQL 服务器的活动连接（称为 P_currentConnection）

在应用程序中查看/打印报表对象之前调用此函数（也可以是子函数）。它可以用于在复制数据库之间分发报告时，用户根据他们的位置连接到不同的服务器/数据库。

```
Public Function connectReportToDatabase( _
    P_report As CRAXDRT.Report)

Dim table As CRAXDRT.DatabaseTable, _

For Each table In P_report.Database.tables

    If table.DllName <> "crdb_ado.dll" Then
        table.DllName = "crdb_ado.dll"
    End If

    table.ConnectionProperties.DeleteAll

    table.ConnectionProperties.Add "Provider", P_currentConnection.Provider
    table.ConnectionProperties.Add "Data source", P_currentConnection.Properties("Data source").Value
    table.ConnectionProperties.Add "Database", P_currentConnection.DefaultDatabase
    table.ConnectionProperties.Add "Integrated security",  P_currentConnection.Properties("Integrated security").Value
    table.ConnectionProperties.Add "Persist Security Info", P_currentConnection.Properties("Persist Security Info").Value
    table.ConnectionProperties.Add "Initial Catalog", P_currentConnection.Properties("Initial Catalog").Value

    table.SetTableLocation table.location, "", P_currentConnection.ConnectionString

    table.TestConnectivity

Next table 
```

可以使用以下过程调用它：

```
Dim crystal As CRAXDRT.Application, _
    m_report as CRAXDRT.report        

Set crystal = New CRAXDRT.Application
Set m_rapport = crystal.OpenReport(nameOfTheReport & ".rpt")

connectreportToDatabase(m_report) 
```

如果您的报告包含子报告，您可能还必须将它们重定向到活动连接。在这种情况下，您必须浏览报表中的所有对象，检查属于报表类型的对象并将它们重定向到新连接。我相信你会很高兴在这个原始过程中添加相应的额外行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T15:23:48.490

You can get any of the info from the current report connection info. So if your not changing servers, then set the crystalServer variable to the reports current server.

```
'SET REPORT CONNECTION INFO
For i = 0 To rsource.ReportDocument.DataSourceConnections.Count - 1
    rsource.ReportDocument.DataSourceConnections(i).SetConnection(crystalServer, crystalDB, crystalUser, crystalPassword)
Next

For i = 0 To rsource.ReportDocument.Subreports.Count - 1
    For x = 0 To rsource.ReportDocument.Subreports(i).DataSourceConnections.Count - 1
        rsource.ReportDocument.OpenSubreport(rsource.ReportDocument.Subreports(i).Name).DataSourceConnections(x).SetConnection(crystalServer, crystalDB, crystalUser, crystalPassword)
    Next
Next 
```

# jquery - 如何在 jQuery/AJAX 选项卡中使用 CodeIgniter/MVC 视图？

> ID：204612
> 
> 赞同：0
> 
> 时间：2008-10-15T13:00:54.160
> 
> 标签：jquery, codeigniter, jquery-ui-tabs

尝试使用[jQuery 选项卡](http://docs.jquery.com/UI/Tabs)制作表单向导。

是否可以将表单的每个步骤放在单独的视图中，然后通过 jQuery/AJAX 选项卡选项加载每个步骤？当我AJAX加载部分表单时，无法访问js、css等；因为部分文件没有“标题”。它似乎根本没有从父页面继承。`<div>`作为一种解决方法，我将所有表单放在一个页面上，并用s划分为选项卡。这可以完成工作，但关闭 js 并没有多大意义（尽管该应用程序依赖于 js，并且只能在内部使用启用 js 的浏览器）。

我正在使用 CodeIgniter，但我猜这个问题对任何 MVC 框架都有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T13:56:31.880

除非标签是在 iframe 中加载的，否则它们应该可以访问加载它们的页面的 js 和 css。你能做一个测试来确认你怀疑 JS 和 CSS 不可访问吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T22:54:14.897

我只是使用我自己的 MVC 框架使用 jquery 选项卡编写一个类似的应用程序。这是我解决“在选项卡内浏览”的方法

问题：我的表单位于单独的视图中，并且它们使用 ajax 加载到选项卡中。

```
 jQuery(document).ready(function(){
    var tabs = jQuery("#tabs > ul").tabs().bind('tabsload', function( event, ui ){
      jQuery( 'form', ui.panel ).submit(function() {
        jQuery.ajax({
          type: 'post',
          url: $(this).attr('action'),
          data: $(this).serialize(),
          success: function( response ){
            if(response.match( /^http:\/\/.*$/ ))
            {
              tabs.tabs('url', ui.index, response );
              tabs.tabs('load', ui.index );
            }
          }
        });
        return false;
      });
    }); 
```

在每个选项卡加载后，我会覆盖选项卡内容中表单的默认提交事件（可访问`ui.panel`）。然后表单被序列化并作为 ajax 帖子发送。如果响应是一个 URL，那么我只需将选项卡的 URL 设置为它并重新加载它。

希望这可以帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T01:38:47.367

我发现的问题是我的大部分 ajax 数据都作为 text/html 而不是 URL 发送回来？这意味着它不会显示，如果我将它附加到“目标”，那么它不会加载选项卡加载事件，因此不会发生与提交按钮的绑定

# notepad++ - 流式日志（txt）查看器

> ID：204614
> 
> 赞同：44
> 
> 时间：2008-10-15T13:01:28.187
> 
> 标签：notepad++, tail

任何人都知道可以以流方式读取 txt 文件的查看器（或 Notepad++ 插件）？例如，我想查看一个 txt 文件的最后 10 行，它们会不断地附加。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-10-15T13:10:02.083

[Tail for Win32](http://tailforwin32.sourceforge.net/)是一个简单的开源程序，我已经使用了几年了。

Notepad++ 实际上可以开箱即用。

在 Notepad++ 中：设置 > 首选项 > MISC。

从那里，您可以在“文件状态自动检测”组中检查“静默更新”和“更新后滚动到最后一行”

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-01-19T22:47:04.747

您正在寻找的 Notepad++ 插件是 Document Monitor。但是，如果您注意到 Notepad++ 意外冻结，导致您丢失未保存的更改，那么这个插件可能是罪魁祸首，因为它已知不稳定。见[http://www.g-loaded.eu/2009/10/17/be-cautious-with-notepad/](http://www.g-loaded.eu/2009/10/17/be-cautious-with-notepad/)

另请查看 Windows 上尾随文档的其他线程：

*   [如何实时监控文本文件](https://stackoverflow.com/questions/18632/how-to-monitor-a-text-file-in-realtime)
*   [https://stackoverflow.com/questions/113121/best-tail-log-file-visualization-freeware-tool](https://stackoverflow.com/questions/113121/best-tail-log-file-visualization-freeware-tool)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-15T13:18:54.017

换句话说...[最好的尾巴（日志文件可视化）免费软件工具？](https://stackoverflow.com/questions/113121/best-tail-log-file-visualization-freeware-tool)， 不 ？

该问题的解决方案是：[Bar​​etail](http://www.baremetalsoft.com/baretail/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-29T14:14:55.643

[Log Expert](http://www.log-expert.de/)是一个具有拖尾、突出显示、过滤、列化和基本 Eclipse 集成的出色工具。还有一个 SDK，可免费用于非商业和商业用途。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-14T11:56:59.763

应该使用 Logtail_plugin.wlx / logViewer.wlx 插件尝试 Lister。 [http://www.ghisler.com/lister/](http://www.ghisler.com/lister/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-26T04:35:18.897

您可以通过使用 LogFilePatternReceiver 配置 Chainsaw 来使用 Apache 的 Chainsaw 跟踪日志文件。有关示例配置文件，请参见欢迎选项卡。

[http://logging.apache.org/chainsaw](http://logging.apache.org/chainsaw)

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-10-15T13:04:42.623

在 UNIX 中，tail -f。在 Windows 中？不知道。Cygnus 工具可能也有 tail 命令。

# svn - 如何跨存储库迁移 svn:externals 属性中的所有 URL？

> ID：204616
> 
> 赞同：15
> 
> 时间：2008-10-15T13:02:36.250
> 
> 标签：svn, migration, repository, externals

我们正在将我们的 SVN 存储库从一台机器移动到另一台机器，随之而来的是新存储库的新域名。问题是，在存储库中，有很多 svn:externals 对存储库中其他项目的引用。例如，我们有 projectA，它在 svn:externals 属性中：

```
external/libraryA svn://oldserver.net/repo/libraryA
external/libraryB svn://oldserver.net/repo/libraryB 
```

...等等。所有 URL 都引用了这个特定的域名，因此可以很容易地对其进行解析。已经吸取了教训，我会将这些 URL 迁移为“svn://localhost/”，但我需要找到一种方法来查看存储库历史并重写所有旧 URL，以便我们仍然可以检查这些项目的旧版本没有断开的链接。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2010-08-19T20:47:37.977

我会为此使用[SvnDumpTool 。](http://svn.borg.ch/svndumptool/)它正是您正在寻找的东西：

```
svndumptool transform-prop svn:externals "(\S*) (|-r ?\d* ?)http://oldserver.net(/\S*)" "\2\3 \1" source.dumpfile source-fixed-externals.dumpfile 
```

这修复了[subversion 1.5 格式](http://subversion.apache.org/docs/release-notes/1.5.html#externals)的每个外部，并使用相对 URL。

所以 svn:externals 像：

```
external/libraryA svn://oldserver.net/repo/libraryA 
```

变得：

```
 /repo/libraryA external/libraryA 
```

使用服务器根相对 URL。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-24T15:51:33.550

正如您所指出的，您仍然希望能够检查旧版本，唯一的解决方案是真正“重写”整个历史记录（前面提到的解决方案 D）。

为此，您应该：

1)使用[svnadmin dump 转储](http://svnbook.red-bean.com/en/1.1/re31.html "svnadmin dump")*整个*存储库的内容：

```
$ svnadmin dump /path/to/repos > original-dumpfile
* Dumped revision 0.
* Dumped revision 1.
* Dumped revision 2.
* Dumped revision 3. 
```

2) 编辑转储文件，更改 svn:externals URL。**这是最困难的部分**：假设存储库也包含二进制数据，在纯文本编辑器中打开转储文件很可能会损坏转储文件。我有使用所谓的“十六进制编辑器”的良好经验，例如[免费软件十六进制编辑器 XVI32](http://www.chmaas.handshake.de/delphi/freeware/xvi32/xvi32.htm "免费十六进制编辑器 XVI32")

3）创建一个新的存储库并将修改后的转储文件加载到其中：

```
$ svnadmin create newrepos
$ svnadmin load newrepos < modified-dumpfile 
```

有关更多信息，您可能还对此链接感兴趣：
[http ://svnbook.red-bean.com/en/1.1/ch05s03.html](http://svnbook.red-bean.com/en/1.1/ch05s03.html)

注意：Subversion 1.5 实际上在 svn:externals 属性中添加了对*相对 URL*的支持，这可以精确地防止将来出现此类问题：http:
[//subversion.tigris.org/svn_1.5_releasenotes.html#externals](http://subversion.tigris.org/svn_1.5_releasenotes.html#externals)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-11T11:27:08.400

我不得不在 9 个用户和 4 个部署中重新定位 12 个工作副本。这是一个简单的更改，用 IP 替换域，即`thing.domain.net -> 192.168.0.1`

期望`svn relocate`像描述的那样表现（遍历嵌套的外部），我编写了一个简单的 DOS 指令来在每个位置运行：

`for /D %G in (*) do ( cd ./%G & svn relocate http://thing.domain.net http://192.168.0.1 & cd ..)`

这没有按预期工作，只是重新定位父 WC。

我的解决方案是自己编辑存储库（我使用 Tortoise Repo Browser）来更改外部的位置。在此更改之后，只需更新重新定位的父级即可使所有内容保持一致。

*让所有 Tortoise 用户清除他们的 URL 历史记录可能是个好主意，这样他们就不会无意中使用旧 URL 执行操作（它仍然存在于 DNS 查找中）：*

***`Settings->Saved Data->URL history->Clear`***

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-04-09T01:25:51.923

我用 vi 编辑了我的转储文件，但我必须使用“-b”开关以二进制模式进行编辑，这样任何可以解释为行尾的字符都不会被转换。

例如 vi -b 文件名.dump

此外，我发现，如果您的 URL 长度发生变化，则还必须修改字符串长度。例如，考虑如下所示的条目：

节点路径：trunk/src/include

节点类型：dir

节点动作：改变

道具内容长度：192

内容长度：192

K13

svn:外部

V 156

MGL_ABC svn://server_name/dir1/dir2

MGL_DEF svn://server_name/dir1/dir3

当您修改这些 URL 时，如果字符串的长度发生变化，您还需要更改“192”、“192”和“156”以匹配新的长度。我发现很难计算绝对长度，但很容易找到差异。
例如，假设 URL 1 变短了 3 个字符，而 URL 2 变短了 4 个字符。然后，您必须从这三个字符串长度数字中的每一个中减去“7”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T13:40:57.777

你可以：

a) 检查旧版本，并更改​​您的主机文件以将旧名称指向新地址，然后 svn 更新。如果 URL 路径也发生了变化......那么你也可以：

b) 花时间编写一个脚本，在当前（旧版本）工作副本中查找属性并更改那里的 URL，而不提交它们。或者：

c）记下您签入新属性值的修订（-s），签出旧版本，然后简单地将这些修订（-仅影响属性）合并到您的工作副本中。

d）或者，可能，使用 svndump 转储存储库数据，字符串替换转储中的 URL，然后恢复它.. 我不会给你任何保证，甚至可以工作 ;-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-10T08:44:20.537

我所有的外部文件都在名为`flow`. 我用这个单线（bash shell）修复了我外部的 URL：

```
for p in $(find -maxdepth 4 -name flow); 做 svn ps svn:externals "$(svn pg svn:externals $p/.. | perl -pe 's/^(\w+) svn\+ssh.*thing\.domain\.net(.*)/$2 $1/')" $p/..; 完毕

```

# c# - LINQ to SQL 错误消息：找不到“哪里”

> ID：204627
> 
> 赞同：0
> 
> 时间：2008-10-15T13:05:33.607
> 
> 标签：c#, linq, linq-to-sql

我正在尝试开始使用 LINQ，特别是 LINQ to SQL，但我遇到了一些困难

我已经用 SqlMetal 尝试过这个，现在在 Visual Studio 中使用数据库表设计器，我不断收到类似的错误，就像在这段代码中，使用我在 VS2008 中使用数据库布局设计器创建的数据上下文。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class _Default : System.Web.UI.Page
{
protected void Page_Load(object sender, EventArgs e)
{
    if (Page.IsPostBack)
    {
        string usn = UserNameBox.Text;
        string pss = PassBox.Text;

        if (usn == "" || pss == "")
            return;

        DataClassesDataContext dc = new DataClassesDataContext();
        var user = from u in User
                   where u.UserName == usn
                   select u;

    }
}
} 
```

我收到一条关于 where 的错误消息：找不到源类型“System.Security.Principal.IPrincipal”的查询模式的实现。还有：“哪里”没有找到。

当我尝试使用 SqlMetal 的结果时，我遇到了类似的情况。我删除了该来源并重新开始使用设计器。我一定在这里遗漏了一些东西，但我不知道是什么。既然我使用的是 LINQ to SQL，这些表不应该实现我需要的东西，还是我需要做一些额外的事情来实现它？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-15T13:06:51.200

尝试更改`User`为`dc.User`：

```
var user = from u in dc.User
                   where u.UserName == usn
                   select u; 
```

这`User`是属性[System.Web.UI.Page.User](http://msdn.microsoft.com/en-us/library/system.web.ui.page.user.aspx)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-15T13:07:27.423

尝试

```
var user = from u in dc.User
                   where u.UserName == usn
                   select u; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-15T13:06:42.713

您不应该**使用**在查询中某处创建的 dc 吗？

就像是：

```
protected void Page_Load(object sender, EventArgs e) 
{ 
  if (Page.IsPostBack) 
  {
    string usn = UserNameBox.Text; 
    string pss = PassBox.Text; 
    if (usn == "" || pss == "")            
      return; 
    DataClassesDataContext dc = new DataClassesDataContext(); 
    var user = from u in dc.User where u.UserName == usn select u; 
  } 
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-15T13:08:00.513

您的查询表达式应该使用 dc.User，而不仅仅是 User：

```
DataClassesDataContext dc = new DataClassesDataContext();
var user = from u in dc.User
           where u.UserName == usn
           select u; 
```

如果您打开了复数，则可能是 dc.Users 。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T15:13:24.923

您所指的用户（当您不使用 dc.User 时）是 Page.User 成员。这就是智能感知没有抱怨的原因。

# performance - 谷歌地图如何运作？

> ID：204644
> 
> 赞同：41
> 
> 时间：2008-10-15T13:10:43.113
> 
> 标签：performance, google-maps, image

谷歌地图背后的技术名称是什么，它允许服务器只发送用户请求的地图部分以提高性能，是否有任何库来处理这个问题？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-10-15T13:25:25.580

该技术通常可以描述为**地图服务器**。地图服务器从覆盖整个地球的大量预先生成的地图瓦片图像中为请求的位置生成地图。地图服务器可能会在此之上覆盖来自其他数据库的数据。地图查看器客户端和地理数据库的组合传统上称为**地理信息系统**(GIS)。

[任何人都可以使用Google Maps API](http://code.google.com/apis/maps/)编写嵌入 Google 地图的 Web 应用程序。如果您希望部署自己的地图服务器，还有一个很好的开源地图服务器（称为[MapServer ）。](http://en.wikipedia.org/wiki/MapServer)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-26T22:35:23.157

如前所述，Google 生成了所有这些 256x256 的图块，并且只提供相关的图块。从您的评论看来，您正在寻找可以为您生成这些图块的东西。有几个人编写了代码来将图像分割成图块 - 例如[http://crazedmonkey.com/blog/googletilecutter](http://crazedmonkey.com/blog/googletilecutter)或[http://www.klokan.cz/projects/gdal2tiles/](http://www.klokan.cz/projects/gdal2tiles/)两者似乎都可以做你想做的事情为了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-15T13:24:38.357

如果您查看谷歌地图页面的链接，它将如下所示：

```
http://maps.google.com/maps?f=q&hl=en&sll=37.0625,-95.677068&sspn=53.345014,88.769531&ie=UTF8&ll=41.226264,-81.454246&spn=0.012507,0.021672&z=16 
```

页面上的 javascript 代码和服务器代码使用链接中的数字来确定您正在查看的地图的位置、缩放级别和查看窗口的大小来确定要发送到浏览器的图块。

有一些商业库可以提供映射数据以及显示和导航数据的工具。我以前见过的一个是[Geomicro](http://www.geomicro.com/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-22T16:29:52.207

您还可以将[Google Maps API](http://code.google.com/apis/maps/documentation/reference.html#GTileLayer)与您自己的图像一起使用。当然，它们不需要是地图；它们可以是任何图像。这将允许用户拖动和缩放，就像在谷歌地图中一样。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-17T19:16:50.313

[您可以使用 OpenSource、 http ://www.geoserver.org](http://www.geoserver.org) [http://www.openlayers.org](http://www.openlayers.org) 以及最后但并非最不重要 的[http://geowebcache.org/](http://geowebcache.org/)来尝试这一点

您应该能够在几个小时内设置一个类似于 maps.google 的最小环境。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-01T07:53:41.330

以下是 EveryBlock.com 的创始人之一生成基于 Web 的地图的开源堆栈的一个很好的概要：[http ://www.alistapart.com/articles/takecontrolofyourmaps](http://www.alistapart.com/articles/takecontrolofyourmaps)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-01T09:14:35.380

基础学科的通用名称是[GIS](http://en.wikipedia.org/wiki/Geographic_information_system)。

您是出于一般的好奇心而询问更多细节，还是您对项目有特定的技术需求？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-06-11T15:59:04.143

谷歌从销售这些图像的服务中获取高清卫星照片，然后存储和裁剪这些图像，并仅提供您查看某个点时需要的图像。也就是说，您是否注意到当您放大和缩小时会看到出现方形瓷砖？这些是 Google Server 为您服务的。

您还必须考虑他们如何使用 Google 文件系统和 MapReduce 处理负载

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-15T14:58:45.220

Google 地图和 Google 地球使用称为 KML 或“Keyhole 标记语言”的东西，它是 XML 的一种特殊变体。它的命名是为了向第一颗地理跟踪卫星致敬。您可以使用此标记对其特定的纬度和经度坐标进行地理编码，从而将信息存储在 Google 地球中（它最终会渗透到 Google 地图）。你甚至可以包括高度。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-15T13:22:17.380

它只是一个巨大的图像，由独立下载的方形块组成（使用 AJAX 等）。我相信它是由某种内部 Google 库（也可能是 GWT）完成的。

有关此主题的更多信息：http: [//blog.grimpoteuthis.org/2005/02/mapping-google.html](http://blog.grimpoteuthis.org/2005/02/mapping-google.html)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-01T08:42:40.777

不回答这个问题，只是更广泛的信息。微软为 Silverlight 提供了一种名为“深度缩放”的功能，可以轻松实现这种效果。

它是一个免费的作曲家，您可以在其中平铺您的图片（或一张大图片）并进行一些其他设置，然后将其分解为子文件夹中的许多较小的图片，每个缩放级别一个文件夹。然后创建一个可以流畅地使用它们的页面。

关于它的一个很好的博客条目： [http ://weblogs.asp.net/jgalloway/archive/2008/03/21/why-silverlight-2-deep-zoom-really-is-something-new.aspx](http://weblogs.asp.net/jgalloway/archive/2008/03/21/why-silverlight-2-deep-zoom-really-is-something-new.aspx)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-10T15:55:43.597

我正在开发一个跨浏览器查看器，以查看非常大的历史计划和草图。[对我在http://www.cadmaps.com/gisblog/?p=7](http://www.cadmaps.com/gisblog/?p=7)上找到的第一步（一个旧博客）有很好的帮助， 以了解图像金字塔（这就是谷歌地图的工作原理）。

使用“tiler”，我生成了很多图像，例如 testImage_0001111100.png。0001111100 即图像金字塔中的第 5 个缩放级别和 x/y 位置。大多数计算（邻居图像，图像堆叠上下）是由 ajax 请求调用的 php 在服务器端完成的。

我目前正在为平滑移动和缩放方面的（并非无法解决的）问题而苦苦挣扎。那是我的问题 - 但请阅读这篇文章。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2008-10-15T13:22:16.600

[AJAX](http://en.wikipedia.org/wiki/AJAX)允许您从 javascript 更新页面的一部分。基本上，javascript 向网络服务器发出请求，并用结果替换现有页面的一部分。

[JQuery](http://jquery.com/)是一个使这变得更容易的库。我不知道谷歌用什么。

# c# - 如何使用 C# 验证字符串不包含 HTML

> ID：204646
> 
> 赞同：33
> 
> 时间：2008-10-15T13:11:06.823
> 
> 标签：c#, html, validation

有没有人有一种简单、有效的方法来检查字符串是否不包含 HTML？基本上，我想检查某些字段是否只包含纯文本。我考虑过寻找 < 字符，但这很容易在纯文本中使用。另一种方法可能是创建一个新的 System.Xml.Linq.XElement 使用：

```
XElement.Parse("<wrapper>" + MyString + "</wrapper>") 
```

并检查 XElement 是否不包含子元素，但这对于我需要的东西来说似乎有点重量级。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-10-15T13:18:12.723

以下将匹配任何匹配的标签集。即<b>这个</b>

```
Regex tagRegex = new Regex(@"<\s*([^ >]+)[^>]*>.*?<\s*/\s*\1\s*>"); 
```

以下将匹配任何单个标签。即 <b> （它不必关闭）。

```
Regex tagRegex = new Regex(@"<[^>]+>"); 
```

然后你可以像这样使用它

```
bool hasTags = tagRegex.IsMatch(myString); 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-10-15T13:36:08.083

[您可以通过使用HttpUtility.HtmlEncode](http://msdn.microsoft.com/en-us/library/system.web.httputility.htmlencode.aspx)对输入进行编码来确保纯文本。

事实上，根据您希望检查的严格程度，您可以使用它来确定字符串是否包含 HTML：

```
bool containsHTML = (myString != HttpUtility.HtmlEncode(myString)); 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-10-15T13:19:44.013

干得好：

```
using System.Text.RegularExpressions;
private bool ContainsHTML(string checkString)
{
  return Regex.IsMatch(checkString, "<(.|\n)*?>");
} 
```

这是最简单的方法，因为括号中的项目不太可能自然出现。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-15T16:13:19.950

我刚刚尝试了我的 XElement.Parse 解决方案。我在字符串类上创建了一个扩展方法，这样我就可以轻松地重用代码：

```
public static bool ContainsXHTML(this string input)
{
    try
    {
        XElement x = XElement.Parse("<wrapper>" + input + "</wrapper>");
        return !(x.DescendantNodes().Count() == 1 && x.DescendantNodes().First().NodeType == XmlNodeType.Text);
    }
    catch (XmlException ex)
    {
        return true;
    }
} 
```

我发现的一个问题是纯文本 & 和小于字符会导致 XmlException 并指示该字段包含 HTML（这是错误的）。为了解决这个问题，首先传入的输入字符串需要将 & 号和小于号字符转换为其等效的 XHTML 实体。我写了另一个扩展方法来做到这一点：

```
public static string ConvertXHTMLEntities(this string input)
{
    // Convert all ampersands to the ampersand entity.
    string output = input;
    output = output.Replace("&amp;", "amp_token");
    output = output.Replace("&", "&amp;");
    output = output.Replace("amp_token", "&amp;");

    // Convert less than to the less than entity (without messing up tags).
    output = output.Replace("< ", "&lt; ");
    return output;
} 
```

现在我可以使用以下代码获取用户提交的字符串并检查它是否不包含 HTML：

```
bool ContainsHTML = UserEnteredString.ConvertXHTMLEntities().ContainsXHTML(); 
```

我不确定这是否是防弹的，但我认为这对我的情况来说已经足够了。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-12-12T17:25:04.280

这也会检查像 < br /> 带有可选空格的自封闭标签之类的东西。该列表不包含新的 html5 标签。

```
internal static class HtmlExts
{
    public static bool containsHtmlTag(this string text, string tag)
    {
        var pattern = @"<\s*" + tag + @"\s*\/?>";
        return Regex.IsMatch(text, pattern, RegexOptions.IgnoreCase);
    }

    public static bool containsHtmlTags(this string text, string tags)
    {
        var ba = tags.Split('|').Select(x => new {tag = x, hastag = text.containsHtmlTag(x)}).Where(x => x.hastag);

        return ba.Count() > 0;
    }

    public static bool containsHtmlTags(this string text)
    {
        return
            text.containsHtmlTags(
                "a|abbr|acronym|address|area|b|base|bdo|big|blockquote|body|br|button|caption|cite|code|col|colgroup|dd|del|dfn|div|dl|DOCTYPE|dt|em|fieldset|form|h1|h2|h3|h4|h5|h6|head|html|hr|i|img|input|ins|kbd|label|legend|li|link|map|meta|noscript|object|ol|optgroup|option|p|param|pre|q|samp|script|select|small|span|strong|style|sub|sup|table|tbody|td|textarea|tfoot|th|thead|title|tr|tt|ul|var");
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-15T13:32:04.473

尖括号可能不是您唯一的挑战。其他字符也可能是潜在有害的脚本注入。比如常见的双连字符“--”，也可以用在SQL注入中。还有其他人。

在 ASP.Net 页面上，如果 machine.config、web.config 或 page 指令中的 validateRequest = true，如果 HTML 标记，用户将收到一个错误页面，说明“从客户端检测到潜在危险的 Request.Form 值”或检测到各种其他潜在的脚本注入攻击。您可能希望避免这种情况并提供更优雅、不那么可怕的 UI 体验。

您可以使用正则表达式测试开始和结束标记 <>，如果仅出现其中一个，则允许文本。允许 < 或 >，但不允许 < 后跟一些文本，然后按该顺序 >。

您可以允许尖括号和 HtmlEncode 文本以在数据持久保存时保留它们。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-03-12T06:33:58.033

使用上面提到的 HttpUtility.HtmlEncode 方法时要小心。如果您正在检查一些带有特殊字符的文本，而不是 HTML，它将不正确地评估。也许这就是 J c 使用“...取决于您希望检查的严格程度...”的原因

# asp.net - 什么时候不应该使用 Web 服务？

> ID：204653
> 
> 赞同：35
> 
> 时间：2008-10-15T13:14:01.827
> 
> 标签：asp.net, web-services, architecture, web-applications

使用 Web 服务通常是一种出色的架构方法。而且，随着 .Net 中 WCF 的出现，它变得更好了。

但是，根据我的经验，有些人似乎认为应始终在数据访问层中使用 Web 服务来调用数据库。我不认为 Web 服务是通用的解决方案。

我正在考虑具有几十个用户的小型 Intranet 应用程序。Web 应用程序及其 Web 服务部署到一个 Web 服务器，而不是 Web 场。将来不会有另一个 Web 应用程序可以使用这个特定的 Web 服务。在我看来，调用 Web 服务的成本不必要地增加了 Web 服务器的负担。进程间调用会影响性能。维护和调试 Web 应用程序和 Web 服务的代码更加复杂。部署也是如此。我只是看不到在这里使用网络服务的好处。

可以通过创建两个版本的 Web 应用程序（有和没有 Web 服务）来测试这一点，并进行压力测试，但我没有这样做。

您对将 Web 服务用于小型 Web 应用程序有意见吗？在其他情况下，Web 服务不是一个好的架构选择吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-10-15T13:35:13.937

Web 服务是数据访问的绝对可怕选择。这是几乎零收益的大量开销和复杂性。

如果您的应用程序要在一台机器上运行，为什么要拒​​绝它执行进程内数据访问调用的能力？我不是在谈论从您的 UI 代码直接访问数据库，我是在谈论将您的存储库抽象出来，但仍将它们的程序集包含在您正在运行的网站中。

在某些情况下，我会推荐 Web 服务（我假设您的意思是 SOAP），但这主要是为了互操作性。

服务的粒度也存在问题。SOA 意义上的服务将封装操作或业务流程。数据访问方法只是该过程的一部分。

换句话说：

```
 - someService.SaveOrder(order);  // <-- bad
    // some other code for shipping, charging, emailing, etc

  - someService.FulfillOrder(order);  //<-- better
    //the service encapsulates the entire process 
```

为 Web 服务而 Web 服务是不负责任的编程。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-15T13:55:42.397

夏洛特杰出的开发人员尼克哈里森提出了以下使用 Web 服务有意义的场景：

*   在 Web 场中，有多个 Web 服务器托管网站，所有网站都指向在另一个 Web 服务器上运行的 Web 服务。这允许将负载分布在多个服务器上。
*   客户端/服务器，Windows 窗体应用程序可以在其中调用 Web 服务。
*   跨平台
*   穿过防火墙

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-15T13:39:33.380

仅仅因为该工具生成一堆存根并不意味着它是一个很好的用途。WS-* 在您向外部方公开*服务*的场景中表现出色。这意味着每个操作都应该在业务流程的粒度上，而不是在数据访问上。

众多标准可用于详细描述合同的不同方面，（假设的）完全兼容的 WS 堆栈可以消除第三方开发人员的大量痛苦，甚至允许传说中的点击集成 a'la雅虎管道。通过良好的治理控制，您可以根据需要改进您的公共接口并管理向后兼容性。

所有这些几乎不可能自动生成。C# 存根生成器只知道类的物理接口，但对所涉及的语义一无所知。有关更详细的讨论，请参阅[本文](http://www.hpl.hp.com/techreports/2005/HPL-2005-83.pdf)。

如果你正在建立一个网站，那么就建立一个网站。如果您想在应用程序中进行异步消息传递，请使用[MSMQ](http://en.wikipedia.org/wiki/MSMQ)。如果要向内部客户端公开数据，请使用[POX](http://en.wikipedia.org/wiki/Plain_Old_XML)。如果您需要高效的二进制消息格式，请查看 Google 的[协议缓冲区](http://code.google.com/p/protobuf/)，或者如果您需要 RPC，请查看[Hessian 的 C#](http://www.hessiancsharp.org/)或 DCOM。

Web 服务是一种粗粒度的集成解决方案。它们是死板的，它们比替代品慢，它们需要付出太多的努力才能做好（如果做得不好，几乎毫无意义）。

总结一下：“什么时候不应该使用 Web 服务**？** ” - 任何时候你都可以在没有它的情况下逃脱

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-15T13:23:17.690

如果您只是为您的 Intranet 编写一个小型（少于 50 个用户）Web 应用程序，那么 Web 服务似乎有点过头了。特别是如果它的主要功能（提供对许多服务的单点访问）不会被使用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-15T13:25:52.067

我同意在小型 Web 应用程序中使用 Web 服务会增加一层看起来不合理的复杂性。我的大多数解决方案，互联网和内部网，10-50 个用户，不使用 Web 服务。我很高兴其他人也有同样的感觉……我以为我是唯一的一个。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-08-12T14:47:44.587

对于小型 Web 应用程序，我认为使用 Web 服务通常是一个不错的主意，您可以使用它轻松地将 Web 服务器与数据层分离。有了直截了当的开发要求和出色的工具，我看不到问题所在。

但是**，请勿**在以下情况下使用 Web 服务：

*   当您必须使用 Http 作为数据的传输和 Xml 序列化并且您需要大量不同的数据位时，同步且经常。无论是 REST、SOAP 还是 WS-*，您都会遇到性能问题。您拨打的电话越多，您的系统就会越慢。如果您希望不太频繁地异步获取中等大小的数据块，并且可以使用直接的 TcpIp（例如 Wcf netTcpBinding），您会更好。
*   当您需要从您的 Web 服务查询数据并将数据与其他数据源连接时，更倾向于建立一个数据仓库，该数据仓库可以填充来自整个企业的适当整合和合理化的数据

这是我的经验，希望对你有帮助。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-15T13:25:33.427

对于一个小规模的网络应用程序（你必须问一个问题，“它会一直保持小规模吗？”）使用网络服务，单独的业务层、数据层等等可能是矫枉过正的。

在有人向我开枪之前，我确实同意层之间的逻辑分离以及单元测试、持续集成等非常出色。在我目前的角色中，如果没有他们，我会完全迷失并在角落里摇摆不定。但是，对于一个非常小型的 Web 应用程序，例如用于跟踪一家拥有 36 名员工的公司的联系电话和地址，成本/收益分析表明，上面列出的所有“优点”都是多余的。

但是……记得问“它会一直保持小规模吗？”这个问题。:-)

# linq - 在 LINQ to SQL 中检索单个记录结果的最佳方法

> ID：204670
> 
> 赞同：44
> 
> 时间：2008-10-15T13:20:31.033
> 
> 标签：linq, linq-to-sql

如果我在关键字段上查询具有条件的表，如下所示：

```
 var user = from u in dc.Users
                   where u.UserName == usn
                   select u; 
```

我知道我要么得到零个结果，要么得到一个结果。我是否应该继续使用 for-each 检索结果，或者是否有另一种首选方法来处理这种情况。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2008-10-15T13:23:32.697

尝试这样的事情：

```
var user = (from u in dc.Users
                   where u.UserName == usn
                   select u).FirstOrDefault(); 
```

FirstOrDefault方法返回满足指定条件的序列的第一个元素，如果没有找到这样的元素，则返回默认值[。](http://msdn.microsoft.com/en-us/library/bb549141.aspx)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-15T13:22:58.203

为什么不喜欢

```
var user = dc.Users.SingleOrDefault(u=> u.UserName==usn); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-15T13:32:12.850

还应注意 First/FirstOrDefault/Single/SingleOrDefault 是 LINQ to Sql 命令的执行点。由于在此之前没有执行过 LINQ 语句，因此会影响生成的 SQL（例如，可以在 sql 命令中添加 TOP 1）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-15T13:25:02.723

我会使用 First() 或 FirstOrDefault()。

区别：在 First() 上，如果找不到行，则会引发异常。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-15T13:23:11.307

我会使用 SingleOrDefault 方法。

```
var user = (from u in dc.Users
                   where u.UserName == usn
                   select u).SingleOrDefault(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-24T17:03:38.973

另一种选择是使用 Contains(username) 而不是 "=="

```
var user = (from u in dc.UserInfo 
                      where u.Users.Contains(username) 
                      select u).SingleOrDefault(); 
```

# eclipse - 如何在 Eclipse 项目的源文件中管理许可证横幅

> ID：204676
> 
> 赞同：17
> 
> 时间：2008-10-15T13:22:17.083
> 
> 标签：eclipse, plugins, banner

我即将发布一组 Eclipse 插件作为开放源代码，并注意到在 LGPL/EPL 下发布的大多数源代码在每个文件中都包含一个标题横幅，该标题引用许可证或包含许可证本身。

由于手动将这些横幅添加到每个文件似乎是一项艰巨且容易出错的任务。我怎样才能自动插入这些横幅？

***编辑：***我最终找到了[版权向导](https://marketplace.eclipse.org/content/copyright-wizard)和[版权生成器](https://marketplace.eclipse.org/content/eclipse-copyright-generator)，它们是 Eclipse 插件，它们也允许更新现有的许可证横幅。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-15T14:28:14.623

关于最佳实践，我相信您应该将许可证文本放在单独的文件中，并使用构建工具（即 ant）将其添加到所有其他文件的开头。由于您正在谈论一个开源项目，因此无论如何您都需要一个构建过程来考虑生成 javadocs、发布版本等。

顺便说一句，ant 任务是简单的 Java 类，所以如果你没有找到一个可以做到这一点的 ant 插件，那么自己编写一个应该很容易。

日食，据我所知，它不能做这样的事情。我能想到的最快方法是使用 bash（如果您使用的是 Linux）。假设文件 msg 包含您要在每个文件开头添加的文本。

1.  创建一个新目录来存储文件：

    mkdir ~/outdir

2.  在每个文件的开头添加 msg 并将结果放在 outdir

    我在`ls "*.java"`；做猫味精 $i > ~/outdir/$i ; 完毕

类似地，您可以编写一个递归执行相同操作的命令，并添加一个额外的步骤来创建目录结构：

```
mkdir ~/outdir
for i in `find -type d | sed 's/\.//' | grep -v "^$"`; do mkdir ~/outdir$i; done
for i in `find -name "*.java"`; do cat msg $i > ~/outdir/$i ; done 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T21:37:40.420

下面是一种比手动添加更类似于 Eclipse 的方法，通过 Eclipse 中的 GUI 完成。请注意，这些是 Linux / Windows 菜单；Mac有点不同。

1.  打开`Windows->Preferences`
2.  导航`Java->Code Style->Code Templates`
3.  编辑`Comments->Files`评论模板以包含您的样板文件。
    有当前年份，文件名等变量...

另请注意，这只是新文件的解决方案；它不会帮助您处理旧文件；为此，我会为您现有的代码使用类似 idrosid 的解决方案

# word-count - 备注文本字段中的字数

> ID：204682
> 
> 赞同：0
> 
> 时间：2008-10-15T13:23:50.933
> 
> 标签：word-count

我想限制一个人可以在文本字段中输入的字数。输入每个单词时，如何跟踪该字段中的单词数（通过使用第二个字段）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-03-09T11:22:32.953

使用这个js（使用jquery）：

```
$('#newKeywords').bind('change', function() {

   $('#wordsLong').text($('#newKeywords').val().split(' ').length + 1);

}); 
```

这个html：

```
<textarea id="newKeywords"></textarea>
<div>The text consists of <span id="wordsLong"></span> keywords.</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T22:07:03.467

来自[媒体学院](http://www.mediacollege.com)：

[在 JavaScript 中限制文本区域或文本字段中的字符数](http://www.mediacollege.com/internet/javascript/form/limit-characters.html)

# c++ - 如何输入 4 字节的 UTF-8 字符？

> ID：204683
> 
> 赞同：5
> 
> 时间：2008-10-15T13:23:52.103
> 
> 标签：c++, unicode, utf-8, astral-plane

我正在编写一个小应用程序，我需要使用不同字节长度的 utf-8 字符进行测试。

我可以输入 unicode 字符来测试以 utf-8 编码的 1,2 和 3 个字节，例如：

```
string in = "pi = \u3a0"; 
```

但是如何获得一个用 4 字节编码的 unicode 字符呢？我试过了：

```
string in = "aegan check mark = \u10102"; 
```

据我了解应该是输出。但是当我打印出来时，我得到ᴶ0

我错过了什么？

**编辑：**

我通过添加前导零让它工作：

```
string in = "\U00010102"; 
```

希望我早点想到这一点:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-15T14:53:41.063

模式中有更长的转义形式，`\U`后跟八位数字，而不是`\u`后跟四位数字。这也用于 Java 和 Python 等：

```
>>> '\xf0\x90\x84\x82'.decode("UTF-8")
u'\U00010102' 
```

但是，如果您使用的是字节字符串，为什么不像上面那样转义每个字节，而不是依靠编译器将转义转换为 UTF-8 字符串？这似乎也更便携 - 如果我编译以下程序：

```
#include <iostream>
#include <string>

int main()
{
    std::cout << "narrow: " << std::string("\uFF0E").length() <<
        " utf8: " << std::string("\xEF\xBC\x8E").length() <<
        " wide: " << std::wstring(L"\uFF0E").length() << std::endl;

    std::cout << "narrow: " << std::string("\U00010102").length() <<
        " utf8: " << std::string("\xF0\x90\x84\x82").length() <<
        " wide: " << std::wstring(L"\U00010102").length() << std::endl;
} 
```

在 win32 上使用我当前的选项 cl 给出：

`warning C4566: character represented by universal-character-name '\UD800DD02' cannot be represented in the current code page (932)`

编译器尝试将字节字符串中的所有 unicode 转义转换为系统代码页，与 UTF-8 不同，它不能表示所有 unicode 字符。奇怪的是，它理解`\U00010102`为`\uD800\uDD02`UTF-16（其内部 unicode 表示）并破坏了错误消息中的转义...

运行时，程序打印：

```
narrow: 2 utf8: 3 wide: 1
narrow: 2 utf8: 4 wide: 2 
```

请注意，UTF-8 字节串和宽字符串是正确的，但编译器转换失败`"\U00010102"`，给出了字节串`"??"`，结果不正确。

# web-services - 从 DTO 转换为实体和从实体转换为 DTO 的简单方法？

> ID：204694
> 
> 赞同：11
> 
> 时间：2008-10-15T13:27:56.913
> 
> 标签：web-services, serialization, translation, dto-mapping

我最近参与了几个分布式客户端/服务器项目，我们经常遇到的一个痛点是将 DTO 对象转换为我们的实体，反之亦然。我想知道是否有人对这个时间槽有一个“简单”的解决方案？

我想到的一件事是使用反射进行某种翻译......我想你必须确保你的属性名称在线路的每一侧都完全相同 - 但似乎它可能会起作用。

只是在寻找一种方法来避免我的开发中的一些时间沉没。

谢谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T13:35:50.923

## 痛苦与风险

手动获取/设置属性！你试过这个：[http](http://dozer.sourceforge.net/) ://dozer.sourceforge.net/ 。

用于将 bean 转换为 bean 的灵活且可配置的框架。可能有帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-09-17T20:08:12.347

我最近一直在使用[AutoMapper](http://automapper.codeplex.com/)，它就像一个魅力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T13:36:12.407

我已经成功地使用了 XDoclet 之类的工具（尽管编写脚本应该不难）来自动生成传输对象和简单的实体翻译。

也就是说，如果您认为您的实体翻译足够简单，可以使用反射来完成，那么您是否有理由不能只通过线路而不是 DTO 传递实体对象？稍微自定义的序列化可能比完整的 DTO 更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-15T08:53:48.160

使用[ValueInjecter](http://valueinjecter.codeplex.com/)，你可以将任何东西映射到任何东西，例如

```
 object <-> object
 object <-> Form/WebForm
 DataReader -> object 
```

它具有很酷的功能，例如：扁平化和非扁平化

下载包含大量示例（asp.net mvc、web-forms、winforms、单元测试的示例应用程序）

# asp.net - 将值存储在 web.config - appSettings 或 configSection - 哪个更有效？

> ID：204695
> 
> 赞同：12
> 
> 时间：2008-10-15T13:28:19.877
> 
> 标签：asp.net, web-config, performance, appsettings, configsection

我正在编写一个可以使用几个不同主题的页面，并且我将在 web.config 中存储有关每个主题的一些信息。

创建一个新的sectionGroup并将所有内容存储在一起，还是将所有内容放在appSettings中更有效？

**configSection解决方案**

```
<configSections>
    <sectionGroup name="SchedulerPage">
        <section name="Providers" type="System.Configuration.NameValueSectionHandler"/>
        <section name="Themes" type="System.Configuration.NameValueSectionHandler"/>
    </sectionGroup>
</configSections>
<SchedulerPage>
    <Themes>
        <add key="PI" value="PISchedulerForm"/>
        <add key="UB" value="UBSchedulerForm"/>
    </Themes>
</SchedulerPage> 
```

要访问 configSection 中的值，我使用以下代码：

```
 NameValueCollection themes = ConfigurationManager.GetSection("SchedulerPage/Themes") as NameValueCollection;
    String SchedulerTheme = themes["UB"]; 
```

**appSettings 解决方案**

```
<appSettings>
    <add key="PITheme" value="PISchedulerForm"/>
    <add key="UBTheme" value="UBSchedulerForm"/>
</appSettings> 
```

要访问 appSettings 中的值，我正在使用此代码

```
 String SchedulerTheme = ConfigurationManager.AppSettings["UBSchedulerForm"].ToString(); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-15T13:43:00.270

对于更复杂的配置设置，我会使用一个自定义配置部分，它清楚地定义了每个部分的角色，例如

```
<appMonitoring enabled="true" smtpServer="xxx">
  <alertRecipients>
    <add name="me" email="me@me.com"/>
  </alertRecipient>
</appMonitoring> 
```

在您的配置类中，您可以使用类似的方式公开您的属性

```
public class MonitoringConfig : ConfigurationSection
{
  [ConfigurationProperty("smtp", IsRequired = true)]
  public string Smtp
  {
    get { return this["smtp"] as string; }
  }
  public static MonitoringConfig GetConfig()
  {
    return ConfigurationManager.GetSection("appMonitoring") as MonitoringConfig
  }
} 
```

然后，您可以通过以下方式从您的代码中访问配置属性

```
string smtp = MonitoringConfig.GetConfig().Smtp; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-15T13:31:45.520

在效率方面不会有可衡量的差异。

如果您只需要名称/值对，AppSettings 就很棒。

对于更复杂的事情，值得创建一个自定义配置部分。

对于您提到的示例，我将使用 appSettings。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-15T13:48:07.810

性能不会有任何差异，因为 ConfigurationManager.AppSettings 无论如何都只是调用 GetSection("appSettings") 。如果您需要枚举所有键，那么自定义部分将比枚举所有 appSettings 并在键上查找一些前缀更好，但否则坚持使用 appSettings 会更容易，除非您需要比 NameValueCollection 更复杂的东西。

# mysql - 字段大小会影响查询时间吗？

> ID：204696
> 
> 赞同：9
> 
> 时间：2008-10-15T13:28:19.987
> 
> 标签：mysql, sql, database

我的问题是关于 MySQL 的，但我也想知道这会如何影响其他数据库。我有几个字段，`varchar(255)`但我的同事坚持认为，如果它们是`varchar(30)`- 或任何较小的大小 - 那么查询会运行得更快。我不太确定，但如果是这样，我会承认的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-15T16:45:06.067

这里的大多数其他答案都集中在 VARCHAR 以可变长度方式存储这一事实，因此它存储您在给定行上输入的字符串的字节数，而不是字段的最大长度。

但是在查询期间，在某些情况下 MySQL 会将 VARCHAR 转换为 CHAR ——因此大小会上升到最大长度。例如，当 MySQL 在某些 JOIN 或 ORDER BY 或 GROUP BY 操作期间创建临时表时，就会发生这种情况。

告诉所有情况它会这样做很复杂，因为它取决于优化器如何处理查询，它取决于您定义的其他表结构和索引，它取决于查询的类型，甚至取决于版本MySQL，因为每个版本都改进了优化器。

简短的回答是肯定的，无论*您*使用 VARCHAR(255) 还是 VARCHAR(30)，都会有所不同。因此，根据您的需要定义列的最大长度，而不是为了传统而像 255 这样的“大”长度。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-15T13:41:29.180

这取决于查询和数据，但您可能优化得太早，甚至担心。

对于 SELECT 查询，语句本身在 MySQL 中的运行速度也一样快，只要数据不比在较小字段中的数据大，它就会以同样快的速度传输。如果较小的字段迫使您将信息存储在较小的空间中（您会使用额外的 225 个字符吗？），那么您将快速传输到其他程序。

对于 INSERT 查询，字段的大小不是问题，但使用可变长度字段会减慢完成的过程。具有固定长度行的 INSERT 明显更快（至少在 MySQL 5.0 和更早版本中）。

通常，使用数据所需的大小。如果您不知道是需要 255 个字符还是 30 个字符，那么您可能优化得太早了。大数据字段是否会导致瓶颈？您的程序是否存在数据库性能问题？首先找到你的瓶颈，然后用它们解决问题。我猜您在这里查看的时间差异对于您要解决的任何问题都不重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T14:44:45.527

既然你问了其他数据库……</p>

它绝对会影响查询时间。

在 Oracle 中，当数据从服务器移动到客户端时，它是通过缓冲区完成的。那里没有什么革命性的东西。它放入该缓冲区的行数基于最大行大小。假设您的查询返回 4 列 varchars。如果列的大小是 100 并且应该是 10，则 Oracle 在每次提取中容纳的行数将比使用正确大小的列定义时少 10 倍。这会导致不必要地重新读取块。它迫使更多的网络流量，更多的往返。

在 Oracle 中，您可以使用 SET ARRAYSIZE 更改缓冲区的大小。试一试，使用一种大小进行查询，然后使用 10% 的空间再次执行。您会看到读取次数增加，网络访问次数增加，性能下降。使列太大就像使缓冲区太小一样。

但准确大小列的真正原因是数据完整性。你把坏东西拒之门外。这与性能一样重要。

记住：

*   为性能而设计永远不会太早
*   你说的99%会回来，你不会
*   第一次做对的事情要容易、更好、更便宜。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T13:38:50.700

如果您只使用前 30 个字符，那么 varchar(30) 和 varchar(255) 之间不会有区别（尽管 varchar(1000) 会有所不同，这需要额外的字节）。

当然，如果你最终使用超过 30 个字符，它会更慢，因为你有更多的数据要传递给客户端，而且你的索引会更大。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T13:43:51.313

任何小于 VARCHAR(255) 的东西都将使用一个字节来存储它的**size**，因此 VARCHAR(30) 和 VARCHAR(255) 不会有所作为。

但是看看你的数据是否一致，我的意思是，总是相同的大小，在这种情况下，使用 CHAR 会更有用，因为你不会浪费时间在大小信息上，而且你的搜索会更容易找到数据，而不是在此处的帐户索引中。

即使您的数据不一致，但会发生变化，比如说一个字节，一个 CHAR 会更好，因为无论如何您都会浪费一个字节的大小信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-15T13:45:01.467

列宽很少会影响查询性能。当然，如果您使用较大的对象（BLOB、LONGBLOB、TEXT、LONGTEXT），则可能会提取大量数据。这可能会影响性能，但不一定。这实际上只影响存储。如果您关心数据类型的存储大小，可以参考[http://dev.mysql.com/doc/refman/5.0/en/storage-requirements.html](http://dev.mysql.com/doc/refman/5.0/en/storage-requirements.html)以查看详细信息。

重申一下：数据的存储大小不一定会影响查询速度。还有许多其他设计考虑因素会影响查询速度。表和关系、键结构、索引、查询和连接架构等的设计。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-15T13:48:48.573

几年前，很多人建议在 MySQL 中使用`tinytext`，而不是`varchar`在 MySQL 中使用，因为在行数据大小不变的情况下，逐行搜索应该更快。MySQL 的查询、存储和索引处理算法肯定是从那时起演变而来的，现在可能没有那么大的影响。

但是你可能优化得太快了，不应该担心这个级别的性能。

# apache-flex - 如何禁用 Flex 组件中的水平滚动条？

> ID：204698
> 
> 赞同：13
> 
> 时间：2008-10-15T13:30:44.320
> 
> 标签：apache-flex, actionscript-3

我有一些充满动态数据的 GridItem 组件。有时这个数据长于 GridItem 的固定宽度，导致 GridItem 得到一个水平滚动条。我怎样才能禁用它（我假设你可以......）

是否有通用样式也可以处理其他 Flex 组件？

谢谢。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-15T13:47:24.927

一些 Flex 组件，包括 GridItem，有一个名为 的通用属性`horizontalScrollPolicy`。将此设置为`off`将防止出现水平滚动条。（垂直滚动条也有类似的属性`verticalScrollPolicy`。）

其他选项`on`用于始终打开，默认值`auto`用于在需要时显示它。

可以在[此处](http://livedocs.adobe.com/flex/3/langref/mx/core/Container.html#horizontalScrollPolicy)找到 GridItem 和 Flex 3 中其他容器的此属性的完整描述。

# javascript - 如何将 ajax 调用添加到 Mootools 类

> ID：204702
> 
> 赞同：0
> 
> 时间：2008-10-15T13:31:40.993
> 
> 标签：javascript, ajax, image, mootools

我已经（非常轻微地）修改了 Mootools 类 noobSlide（[http://www.efectorelativo.net/laboratory/noobSlide/](http://www.efectorelativo.net/laboratory/noobSlide/)）来创建一个 flickr 风格的照片流。

这是修改后的html（注意你可以在上面的页面上看到原文）

```
print("code sample");<h2>Sample 2</h2>
<div class="sample">
<div class="mask4">
    <div id="box2">
        <span><img src="img1.jpg" alt="Photo" /></span>
        <span><img src="img2.jpg" alt="Photo" /></span>
        <span><img src="img3.jpg" alt="Photo" /></span>
        <span><img src="img4.jpg" alt="Photo" /></span>
        <span><img src="img5.jpg" alt="Photo" /></span>
        <span><img src="img6.jpg" alt="Photo" /></span>
        <span><img src="img7.jpg" alt="Photo" /></span>
    </div>
</div>
<p class="buttons">
    <span id="prev1">&lt;&lt; Previous</span>
    <span id="next1">Next &gt;&gt;</span>
</p> 
```

这是JS

```
print("code sample");//SAMPLE 2 
    var hs2 = new noobSlide({
        box: $('box2'),
        items: [1,2,3,4],
        size: 500,
        interval: 3000,
        buttons: {
            previous: $('prev1'),
            next: $('next1')
        }
    }); 
```

我想知道的是如何为此添加 ajax 调用，我有大约 50 张图片，我只想一次加载大约 5 张（实际上我想我只需要加载 2 张）。

所以我想要一些关于如何使用本机 mootools ajax 类/函数将 ajax 添加到 noobslide 的帮助

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-06-21T20:22:40.843

[摩托罗拉](http://mootorial.com/wiki/)。

# .net - Mono 对于严肃的企业开发是否足够强大？

> ID：204709
> 
> 赞同：12
> 
> 时间：2008-10-15T13:33:40.943
> 
> 标签：.net, mono, cross-platform

自从我深入了解 Mono 已经有几年了。当我最后一次查看时，就 BCL 实施而言，它并不完全存在，并且可用的工具是有限的。我现在特别需要做一些跨平台开发，并且想知道社区对 Mono 作为企业选择的看法。由于过去几年我的大部分开发工作都是在 .Net 中完成的，因此 Mono 似乎是一个自然的选择。但是，我不想推动一项经不起考验的技术。

注意：我说的不是小型甚至中型项目。我说的是一个大型企业应用程序，它将使用面向服务的方法在全球范围内分布。此外，在 Mono 平台上编写的服务有多稳定？

感谢您的意见！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-17T23:52:03.283

去年夏天，我在 Mac OS X 上使用 Mono 1.91 获得了一个 .NET 2.0（+/- 50 000 行代码）项目。我不得不用 Monobcj 重写接口，因为 Mono-Winforms 的实现在 Mac 上看起来很糟糕。但是对于非 UI 代码，在我删除了对特定 Win32 调用的依赖后，一切都运行良好。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-15T13:41:05.577

现在2.0出来了，我想是的。我们当前的构建系统依赖于它并且对它非常满意。现在发布一个实际的产品，你能在 .NET 2.0 中完成这一切吗？如果是这样，我认为是。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-17T16:49:59.160

Mono 的健壮性已得到改进，足以满足重型 asp.net 站点的需要 - 2.0 版本已进行了大量错误修复以提高稳定性。

不仅如此，我们还做了很多工作来提高堆栈的整体可扩展性。

其中大部分是在 2.0 版本中发布的，但有些是在之后发生的，并且正在排队等待今年晚些时候即将发布的 2.2。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T12:24:12.950

我认为这真的取决于您所说的企业 raedy，因为这是一个非常超载的术语。

请参阅我关于类似问题的帖子： [Mono 准备好迎接黄金时段了吗？](https://stackoverflow.com/questions/18450/is-mono-ready-for-prime-time#264959)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T13:35:33.047

上次我研究它时，有几个限制。那是几年前的事了。可扩展性是我们当时的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T01:44:07.083

如果您对跨平台开发有“特定需求”，那么我认为 Mono 确实是您唯一的选择 :) 但如前所述，它确实已经走了很长一段路。

# c# - 我应该如何检查标志枚举中是否设置了标志？

> ID：204711
> 
> 赞同：6
> 
> 时间：2008-10-15T13:34:41.817
> 
> 标签：c#, coding-style

以下两种方法，你更喜欢阅读哪一种？
是否有另一种（更好的？）方法来检查是否设置了标志？

```
 bool CheckFlag(FooFlag fooFlag)
 {
      return fooFlag == (this.Foo & fooFlag);
 } 
```

和

```
 bool CheckFlag(FooFlag fooFlag)
 {
      return (this.Foo & fooFlag) != 0;
 } 
```

* * *

请为您喜欢的方法投票。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-15T13:49:27.277

这两个表达式做不同的事情（如果 fooFlag 设置了多个位），那么哪个更好实际上取决于您想要的行为：

```
fooFlag == (this.Foo & fooFlag) // result is true iff all bits in fooFlag are set

(this.Foo & fooFlag) != 0       // result is true if any bits in fooFlag are set 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-15T13:38:02.200

```
bool CheckFlag(FooFlag fooFlag)
{
    return fooFlag == (this.Foo & fooFlag);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-15T13:37:05.133

我更喜欢第一个，因为它更具可读性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-15T13:38:29.997

```
bool CheckFlag(FooFlag fooFlag)
{
    return (this.Foo & fooFlag) != 0;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-15T13:37:57.800

我更喜欢第一个。我在布尔表达式中谨慎使用 !=0 。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-10-15T13:38:50.573

我是一个积极的思考者：

```
bool CheckFlag(FooFlag fooFlag)
{
  return this.Foo & fooFlag == 1;
} 
```

# asp.net - 如何向 ASP 按钮 PostBackUrl 添加参数？

> ID：204733
> 
> 赞同：3
> 
> 时间：2008-10-15T13:39:51.133
> 
> 标签：asp.net, search, button

我现在正在构建一个带有文本框和一个按钮的搜索页面，可能还有一个下拉菜单来稍后过滤结果。我将按钮的 PostBackUrl 设置为我的搜索页面 (~/search.aspx)。有没有一种简单的方法可以将文本框中的值传递到搜索页面？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-15T14:26:22.990

如果您在按钮上设置了 PostBackUrl，则第一页上的搜索框字段以及该页面上的任何其他表单字段都已发布到您的搜索页面。诀窍是在您的 search.aspx 页面的代码隐藏中访问它们。

```
if (Page.PreviousPage != null)
{
    TextBox SourceTextBox = 
        (TextBox)Page.PreviousPage.FindControl("TextBox1");
    if (SourceTextBox != null)
    {
        Label1.Text = SourceTextBox.Text;
    }
} 
```

这是一种方式。还有一些快捷方式，例如使用 search.aspx 页面顶部的 PreviousPageType 指令：

```
<%@ PreviousPageType VirtualPath="~/SourcePage.aspx" %> 
```

有关如何使用它以及第一种方法的更多详细信息，可以在此处找到：

[http://msdn.microsoft.com/en-us/library/ms178139.aspx](http://msdn.microsoft.com/en-us/library/ms178139.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T13:51:11.690

您也许可以使用 useSubmitBehavior="true" 并在表单上放置一个 method="get" 。这样它将使用浏览器提交行为并将文本框的值附加到查询字符串

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T14:02:54.300

您还可以使用一些 JavaScript 通过在文本框字段中捕获 Enter 键按键事件来完成此操作。您也可以扩展它以验证文本框中的文本。（这个例子是使用[jQuery](http://jquery.com)）

```
$(document).ready(function(){
    // Event Handlers to allow searching after pressing Enter key
    $("#myTextBoxID").bind("keypress", function(e){
        switch (e.keyCode){
        case (13):
            // Execute code here ...
            break;
        default:
            break;
        }
    });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T14:36:01.863

解决了这个问题，上一页是“default.aspx”，但是控件不在该页上。由于我使用母版页，因此我必须选择**Master**而不是**PreviousPage**。

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
  If PreviousPage IsNot Nothing Then
      Dim txtBoxSrc As New TextBox
      txtBoxSrc = CType(Master.FindControl("searchbox"), TextBox)
      If txtBoxSrc IsNot Nothing Then
          MsgBox(txtBoxSrc.Text)
      End If
  End If
End Sub

<div class="gsSearch">
    <asp:TextBox ID="searchbox" runat="server"></asp:TextBox>
    <asp:Button ID="searchbutton" runat="server" Text="search" 
         UseSubmitBehavior="true" PostBackUrl="~/search.aspx" />
</div> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T14:58:25.313

我不知道为什么您会在该代码中获得空引用，而我对 VB 不了解，但我将尝试进行一些您可能可以尝试的轻微修改。

我知道 FindControl 返回类型 Control.. 也许您可以等待将其装箱为特定类型。

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
  If PreviousPage IsNot Nothing Then
      Dim txtBoxSrc As New Control
      txtBoxSrc = PreviousPage.FindControl("searchbox")
      If txtBoxSrc IsNot Nothing Then
          MsgBox((CType(txtBoxSrc, TextBox)).Text)
      End If
  End If
End Sub

<div class="gsSearch">
    <asp:TextBox ID="searchbox" runat="server"></asp:TextBox>
    <asp:Button ID="searchbutton" runat="server" Text="search" 
         UseSubmitBehavior="true" PostBackUrl="~/search.aspx" />
</div> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-05T22:04:59.603

怎么样，这个（vb，对不起）：

通过代码隐藏从文本框中获取值，然后简单地在控件上设置 postbackurl，如下所示：

```
dim textval = SourceTextBox.text
dim myparam = "George"

searchbutton.PostBackUrl = "~/search.aspx?myparam=" & myparam 
```

你可以把它放在处理按钮点击的函数中，不是吗？

# .net - 如何从 Castle Windsor 配置中读取/解析属性

> ID：204737
> 
> 赞同：5
> 
> 时间：2008-10-15T13:41:05.547
> 
> 标签：.net, configuration, dependency-injection, castle-windsor

我有很多城堡 xml 配置，其中连接字符串等属性也保存在 .Net 配置部分下。

我希望能够使用容器读取属性，但看不到执行此操作的机制。

IE

```
<castle>
  <configuration>
    <properties>
      <connectionString>Data Source=MyServer;Initial Catalog=YadaYada;User      ID=me;Password=IAmGod</connectionString>
     </properties>
    <components> 
```

...

显然，这些属性是存在的，因为它们存在组件依赖关系。我可以解析组件，但不能解析属性。

当然，我可以新建一个组件来读取注入它的属性城堡，或者我可以将所有属性包装在一个专门用于保存名称/值对的组件中。但我会认为有一个简单的 container.resolve("property.connectionstring") 表示法。

*编辑 Markdown 不是很好，上面是一个 xml 部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T02:13:41.670

您可以通过几种不同的方式来执行此操作 - 对于强类型解决方案，显而易见的方法是实现自定义配置类，然后将类的属性与 Windsor 配置中的属性连接起来（只读属性与一堆构造函数参数可能是最好的，所以其他开发人员不认为他们可以更新它们） - 正如你所指出的，要使两者保持同步需要做一些工作。也许写一个小工具来解析配置文件来为这个组件生成windsor config/class定义，所以你不需要维护它。

另一种选择是采用现有的配置解释器并公开在解析配置时收集的属性 - 需要做一些工作（但不会太多）来获得这些......我认为你可以通过以下方式做到这一点：

*   创建一个实现 IXmlProcessorEngine 的装饰器，该装饰器捕获对 AddProperty(XmlElement element) 的调用并将元素存储在它自己的私有字典中。
*   将 XmlProcessor 替换为您自己的实现（即复制该类的源代码，然后更改构造函数，以便将装饰器包装在执行实际工作的 DefaultXmlProcessorEngine 实例周围，从而记录各种添加属性调用）。
*   从 XmlInterpreter 继承并覆盖 ProcessResource 方法，以便它调用您的 XmlProcessor 替换。
*   决定如何获取装饰器存储的属性，也许它配置了一个字典，该字典依次通过 XmlInterpreter 和 XmlProcessor 的构造函数传入。

不幸的是，AFAIK 这些属性没有传递到配置存储，因为它们只在解释阶段使用——另外我不相信在解析的这个阶段调用类型转换器，所以值将是字符串，但至少 if/else 等条件语句将被正确评估，包括在内。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T14:06:51.610

你不是想错了吗？

当然，使用连接字符串的对象在构造函数中应该有一个 ConnectionString 属性，并且在配置的组件部分中将依赖项推入其中，例如：

```
<component type="SessionManager">
  <parameters>
    <connectionString>#{connectionString}</connectionString>
  </parameters>
</component> 
```

这样，连接字符串将自动传入，您的组件根本不需要了解容器 - 解耦和内聚！！！

# c# - 朋友的 C# 等价物是什么？

> ID：204739
> 
> 赞同：209
> 
> 时间：2008-10-15T13:41:08.073
> 
> 标签：c#

> **可能重复：**
> [为什么 C# 不提供 C++ 风格的“朋友”关键字？](https://stackoverflow.com/questions/203616/why-does-c-sharp-not-provide-the-c-style-friend-keyword)

我希望 Tester 类可以访问一个类的私有成员变量，而不会将它们暴露给其他类。

在 C++ 中，我只是将 Tester 类声明为朋友，我该如何在 C# 中执行此操作？有人可以给我一个例子吗？

* * *

## 回答 #1

> 赞同：286
> 
> 时间：2008-10-15T13:42:22.313

没有“朋友”的直接等价物 - 最接近的可用（并且不是很接近）是[InternalsVisibleTo](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)。我只使用过这个属性进行测试——它非常方便！

**示例：**放置在`AssemblyInfo.cs`

```
[assembly: InternalsVisibleTo("OtherAssembly")] 
```

* * *

## 回答 #2

> 赞同：98
> 
> 时间：2012-05-08T21:53:52.377

壁橱等价物是创建一个嵌套类，该类将能够访问外部类的私有成员。像这样的东西：

```
class Outer
{
    class Inner
    {
       // This class can access Outer's private members
    }
} 
```

或者如果您更喜欢将 Inner 类放在另一个文件中：

```
Outer.cs
partial class Outer
{
}

Inner.cs
partial class Outer
{
    class Inner
    {
       // This class can access Outer's private members
    }
} 
```

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2011-08-06T22:07:55.353

采取一个非常常见的模式。类工厂制作小部件。Factory 类需要处理内部结构，因为它是 Factory。两者都在同一个文件中实现，并且根据设计、愿望和性质，它们是紧密耦合的类——事实上，Widget 实际上只是工厂的一种输出类型。

在 C++ 中，使 Factory 成为 Widget 类的朋友。

在 C# 中，我们可以做什么？我想到的唯一体面的解决方案是发明一个接口 IWidget，它只公开公共方法，并让 Factory 返回 IWidget 接口。

这涉及到相当多的乏味——在界面中再次暴露所有自然的公共属性。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2008-10-15T13:53:27.473

C# 中没有“朋友”关键字，但测试私有方法的一种选择是使用 System.Reflection 来获取方法的句柄。这将允许您调用私有方法。

给定具有此定义的类：

```
public class Class1
{
    private int CallMe()
    {
        return 1;
    }
} 
```

您可以使用以下代码调用它：

```
Class1 c = new Class1();
Type class1Type = c.GetType();
MethodInfo callMeMethod = class1Type.GetMethod("CallMe", BindingFlags.Instance | BindingFlags.NonPublic);

int result = (int)callMeMethod.Invoke(c, null);

Console.WriteLine(result); 
```

如果您使用的是 Visual Studio Team System，那么您可以通过右键单击方法并选择“创建单元测试...”来让 VS 自动生成一个带有私有访问器的代理类。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-09-10T10:59:58.880

如果被授予访问权限的类在另一个包中并且您公开的方法标记为内部或内部受保护的，则您可以模拟朋友访问。您必须修改要共享的程序集并将以下设置添加到 AssemblyInfo.cs ：

```
// Expose the internal members to the types in the My.Tester assembly
[assembly: InternalsVisibleTo("My.Tester, PublicKey=" +
"012700000480000094000000060200000024000052534131000400000100010091ab9" +
"ba23e07d4fb7404041ec4d81193cfa9d661e0e24bd2c03182e0e7fc75b265a092a3f8" +
"52c672895e55b95611684ea090e787497b0d11b902b1eccd9bc9ea3c9a56740ecda8e" +
"961c93c3960136eefcdf106955a4eb8fff2a97f66049cd0228854b24709c0c945b499" +
"413d29a2801a39d4c4c30bab653ebc8bf604f5840c88")] 
```

公钥是可选的，具体取决于您的需要。

# code-metrics - 验证数据时降低圈复杂度的最佳方法是什么？

> ID：204742
> 
> 赞同：7
> 
> 时间：2008-10-15T13:41:30.337
> 
> 标签：code-metrics, cyclomatic-complexity, data-processing

现在，我正在开发一个 Web 应用程序，该应用程序从可能返回空结果的数据库中接收大量数据。当通过应用程序的圈复杂度时，许多函数的权重在 10 到 30 之间。在大多数情况下，大多数具有高数字的函数都有很多类似于以下的行：

```
If Not oraData.IsDBNull(4) Then row("Field") = oraData.GetString(4) 
```

这引出了我的问题，尝试降低这些数字的最佳方法是什么？现在，我正在考虑将大多数功能置于 10 以下。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T13:49:03.877

第一个问题是：你为什么“挂”在 CC 上？它是一种评估代码密集程度的工具，经验法则应该是“cc 数字不要太高”。

它可能会击中所有这些“IF”并提出该数字 - 因此通过调用一个包装函数来减少 if 的数量，该函数从处理空值的结果集中提取数据或更改查询以使其不返回空值。

请记住，空值确实提供了信息并且并非无用。例如共和党还是民主党？使用 null 表示没有选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T13:53:31.090

分解成函数，可能是这样的：

```
//Object Pascal
procedure UpdateIfNotNull( const fldName: String; fldIndex : integer );
begin
  if oraData.IsDBNull( fldIndex ) then
    row( fldName ) := oraData.GetString(fldIndex);
end; 
```

当然，您可以扩展程序签名，以便“oraData”和“row”可以作为参数传递。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-15T14:12:06.140

[使用扩展方法](http://msdn.microsoft.com/en-us/library/bb384936.aspx)怎么样。

```
Imports System.Runtime.CompilerServices

Module Extensions

    <Extension()> _
    Public Function TryGetString(ByVal row As IDataRecord, i As Integer) As String
        If row.IsDBNull(i) Then
            Return null
        End If
        Return row.GetString(i);
    End Function

End Module 
```

然后你可以简单地写：

```
row("Field") = oraData.TryGetString(4) 
```

这样可以流畅地读取并降低函数的圈复杂度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T14:28:01.163

你看到[这个问题了](https://stackoverflow.com/questions/204369/seeking-clarifications-about-structuring-code-to-reduce-cyclomatic-complexity)吗？他在问类似的问题（但我认为是在更基本的层面上）……但这意味着这里的答案可能没有太大帮助。

我肯定会同意这里的其他建议：如果有重复的语句可以整齐地打包到函数/过程中，这可能是一种可以采用的方法，只要你不只是转移 CC。如果你从一个 CC 为 35 的 proc 转移到三个 CC 分别为 15、10 和 10 的 proc，我不确定你是否获得了太多。（这不是一个糟糕的第一步，但理想情况下你可以在更大范围内简化某些事情，以减少系统该区域的总 CC。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T13:56:59.853

可以将**if**重构为单独的实用程序函数以减少 CC。可能需要许多函数或依赖于类型区分的函数来处理不同的数据库类型（字符串、整数等）

但是，我认为任何解决方案都会导致代码的可维护性或可读性降低（即，您可能会恶化其他指标！）并且 QA 会根据这个理由允许它通过。

# sql - SQL WHERE 子句的正则表达式

> ID：204746
> 
> 赞同：2
> 
> 时间：2008-10-15T13:43:09.443
> 
> 标签：sql, ajax, regex

对于 Web 应用程序，我想构建一个 WHERE 子句并将其提交给服务器。在那里，我会将其附加到查询中。该子句将类似于

```
LASTNAME LIKE 'Pep%' AND (DOB BETWEEN '19600101' AND '19601231 OR SALARY<35000) 
```

在将子句提交到 SQL Server 之前，您能否提出一个正则表达式来验证子句？

（是的，当然，我想要 ORDER 子句的正则表达式）

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-15T13:44:33.963

这是一个非常糟糕的主意。我建议您构建一个过滤系统，而不是用户可以在表单中选择各种选项，然后构建正确的 sql 服务器端，而不是让自己面临各种注入攻击。

作为可能出错的示例，请考虑以下情况：

```
LASTNAME LIKE 'Pep%'--
DROP TABLE People
-- 
```

这会将 DROP TABLE 命令注入到您的 SQL 中，这将很难检测到。您当然可以删除 -- 和 /* 之类的内容，但我保证如果您这样做，有人可以找到方法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-15T14:40:15.070

你不建造

```
LASTNAME LIKE 'Pep%' AND (DOB BETWEEN '19600101' AND '19601231 OR SALARY<35000) 
```

你建立

```
LASTNAME LIKE @LastName AND (DOB BETWEEN @dobStart AND @dobEnd OR SALARY<@MaxSalary) 
```

并将这些人作为参数传入。没有正则表达式，没有大惊小怪。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-15T16:59:25.273

其他几位评论者指出，允许用户输入来确定 SQL 语法是一个坏主意，并造成了 SQL 注入漏洞。

请注意，评论者对此意见一致，并且 StackOverflow 的总“声誉”超过 14,000！

但撇开这一点不谈，您问如何编写正则表达式来匹配任意 SQL 语法。答案是**你不能用正则表达式来做到这一点**。

在这种情况下，“常规”意味着表达式可以匹配某一类输入语言，也可以用[确定性有限状态机](http://en.wikipedia.org/wiki/Deterministic_finite-state_machine)（有点像流程图）来表示。

例如，您需要匹配 SQL 表达式的一件简单事情是匹配嵌套括号的能力。你不能设计一个有限状态机来匹配嵌套括号，因为它需要能够计算你在任何给定点嵌套括号的深度。为此，您需要解析器来实现堆栈，但这是正则表达式无法做到的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-15T16:21:05.927

我想稍微扩展一下吉米的答案。

```
LASTNAME LIKE 'Pep%' 
```

那只是**邪恶**的。永远不要这样做。SQL 字符串应如下所示：

```
LASTNAME LIKE @LastName + '%' 
```

现在的问题是，在您的情况下，您根本不知道是否需要进行姓氏检查。您所拥有的只是 SELECT 和 FROM 子句以及 lastname 列的文本框，其中可能有也可能没有值。美好的。这仍然不是像第一个例子那样做的借口。您需要做的是像这样构建您的查询（现在使用 C#，因为您没有提供客户端语言）：

```
//create a place to keep parameters until we can construct the SqlCommand object
List<SqlParameter> params = new List<SqlParameter>();
SqlParameter p;

// the StringBuilder is MUCH more efficient the concatenating strings
// the 1=1 is a placeholder so you can always just append " AND whatever"
StringBuilder sql = new StringBuilder("SELECT ... \nFROM .... \nWHERE 1=1\n");

// Check and add a parameter for the LastName column if needed
if (!String.IsNullOrEmpty(txtLastName.Text))
{
   sql.AppendLine("AND LASTNAME LIKE @LastName + '%'");
   p = new SqlParameter("@LastName", SqlDbType.VarChar, 50);  // use the actual datatype here
   p.Value = txtLastName.Text;
   params.Add(p);      
}

// Check and add a parameter for another field if needed
if (!String.IsNullOrEmpty(txtSomeOtherField.Text))
{
   sql.AppendLine("AND OtherField LIKE @OtherParam + '%'");
   p = new SqlParameter("@OtherParam", SqlDbType.VarChar, 255);
   p.Value = txtSomeOtherField.Text;
   params.Add(p);
}

// ...  You could also write a method to abstract the code in the if blocks ...

// you haven't told us _how_ the user will specify the order, so I'm leaving that implementation detail out for now
sql.Append(" ORDER BY LastName, OtherField");  

// now we can finally get our SQL String and build the (SAFE!) SqlCommand object:
SqlCommand cmd = new SqlCommand(sql.ToString(), YourSqlConnectionObjectHere);
cmd.Parameters.AddRange(params.ToArray()); 
```

现在您有了一个动态生成的 where 子句，没有注入的可能性。它之所以有效，是因为发送到数据库的字符串的*每一*部分都是代码中的精确文字，即使这些文字是通过多个步骤组装而成的。参数中使用的值永远不会替换到字符串中，而是作为数据单独发送到服务器。

当然这是 C# (.Net)，但几乎每个现代平台都有某种形式的参数化查询/准备语句功能，您应该使用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T14:50:32.583

您可能想看看[Subsonic](http://subsonicproject.com/)。它旨在为您生成一个数据层，并让您使用对象来构建您的 where 子句。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-15T14:09:13.430

where 子句中元素的可能性是巨大的。显然，您有 AND 和 OR 以及 BETWEEN 和 IN 列表以及其他运算符，加上括号，但您也可以调用系统过程、用户定义的函数，并且根据您正在使用的 RDBMS，整个子查询。然后有些查询可能在语法上是正确的，但仍然是非法的。

覆盖这一点的单个正则表达式将 (a) 非常大并且 (b) 可能无法涵盖所有​​情况。您不仅*真的*不想这样做，而且可能甚至不可能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-15T14:22:18.380

正如已经建议的那样，正则表达式是错误的工作工具，您真正需要的是 SQL 解析器。我不知道任何 .Net SQL 解析器，但我确信 Google 搜索会出现一些。

# asp.net - 在 Asp.net Listview 中查找选定项模板内的控件

> ID：204747
> 
> 赞同：1
> 
> 时间：2008-10-15T13:43:11.330
> 
> 标签：asp.net, vb.net, listview

我正在将功能从 asp.net Gridview 转换为 Listview。在所选项目更改时的网格视图中，我将从所选行中的标签中获取一个值并将其写入网格视图之外的不同标签。

```
Protected Sub grdModules_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles grdModules.SelectedIndexChanged

    Dim lblModuleTitle As Label = grdModules.SelectedRow.FindControl("lblModuleTitle")
    lblCurrentModule.Text = lblModuleTitle.Text

End Sub 
```

在 Listview 中，没有“SelectedRow”概念，而是一个 SelectedItem。但是，您不能对所选项目进行 findcontrol。当我尝试执行以下操作时（我得到一个空引用异常）：

```
Protected Sub listviewModules_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles listviewModules.SelectedIndexChanged

    Dim lblModuleTitle As Label = CType(listviewModules.FindControl("lblModuleTitle"), Label)
    lblCurrentModule.Text = lblModuleTitle.Text

End Sub 
```

有谁知道在所选项目模板中找到控件的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T13:54:11.370

您在整个 ListView 上调用 FindControl，而不仅仅是所选项目。这应该有效：

```
Dim lblModuleTitle As Label = CType(listviewModules.Items(listviewModules.SelectedIndex).FindControl("lblModuleTitle"), Label) 
```

# performance - 使用 Workflow Foundation 的性能影响

> ID：204754
> 
> 赞同：5
> 
> 时间：2008-10-15T13:46:19.280
> 
> 标签：performance, workflow, workflow-foundation

我意识到这是一个非常普遍的问题，但我想知道在相当大的企业系统中使用 WF 对命令式代码实现业务逻辑对性能的影响。我想听听其他人在这方面的经验。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-15T22:05:22.987

您可以查看Windows Workflow Foundation 的[性能特征，](http://msdn.microsoft.com/en-us/library/aa973808.aspx)了解在 Windows Workflow Foundation 之上开发应用程序时非常重要的关键性能注意事项和建模指南。

但是我建议等待 PDC（10 月底）的 WF 4.0 公告，因为[他们很有希望](http://download.microsoft.com/download/5/9/B/59B74A2A-245D-4304-802E-E0A0800FACD3/Dublin__NET_4_overview.docx)

> **性能和可扩展性显着提升（性能提升**十倍）

* * *

编辑（PDC 之后，2008 年 11 月 11 日）：

好吧，虽然 Kenny Wolf[在他的演讲](http://channel9.msdn.com/pdc2008/TL17/)中说从执行速度到持久性大小有 10-100 倍的性能改进，但 PDC 的性能并没有透露太多。

[此外，Rick Garibay 在此处](http://rickgaribay.net/archive/2008/10/28/wf-4.0-big-changes-ahead.aspx)发布了与 Kenny Wolf 的一些谈话后讨论。我正在复制一段相关的文章：

> 我的第一个问题是围绕进行如此大修的动力。Kenny 分享说，他们非常、非常深入地关注基于早期版本框架的关键客户请求和机会。最能引起共鸣的特征类型有 3 种。首先，是提供一个真正基于模型的框架，允许 WF 的各个方面以声明方式表示。其次，能够真正参与到存储库生态系统中，这是部署、管理和运营场景的关键。最后但并非最不重要的是性能。
> 
> 在演讲的早些时候，Kenny 提到了一些有趣的改进，包括 10 倍到 100 倍的性能改进，以及持续的工作流程在 WF 4.0 中变得基本上“免费”。在他演讲后我们进行的更多一对一讨论中，他使用了用木制棒球棒挥动棒球的类比。虽然木制棒球棒很有效，但有时感觉有点沉重，如果不是笨重的话。当您拿起铝制棒球棒时，它明显更轻，并且感觉更符合空气动力学。WF 3.0 和 3.5 工作，但 WF 4 是一种新的和改进的铝制棒球棒。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-20T12:28:25.083

我曾经做过一些关于 WF 性能的基准测试。事实证明，“声明性条件”非常缓慢。我相信这是由于在这个过程中做了很多反思。

# http - VBS 中的 HTTP GET

> ID：204759
> 
> 赞同：41
> 
> 时间：2008-10-15T13:47:29.747
> 
> 标签：http, vbscript, request

有没有办法在 Visual Basic 脚本中执行 HTTP GET 请求？我需要从特定 URL 获取响应的内容进行处理。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-10-15T14:10:18.000

```
Dim o
Set o = CreateObject("MSXML2.XMLHTTP")
o.open "GET", "http://www.example.com", False
o.send
' o.responseText now holds the response as a string. 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2008-10-16T15:00:06.417

在撰写本文时，您还没有描述您将对响应做什么或它的内容类型是什么。一个答案已经包含了一个非常基本的用法`MSXML2.XMLHTTP`（我推荐更明确的`MSXML2.XMLHTTP.3.0`progID），但是您可能需要对响应做不同的事情，它可能不是文本。

XMLHTTP 也有一个`responseBody`属性，它是响应的字节数组版本，并且有一个`responseStream`它是`IStream`响应的包装器。

请注意，在服务器端需求（例如，在 ASP 中托管的 VBScript）中，您将使用`MSXML.ServerXMLHTTP.3.0`或`WinHttp.WinHttpRequest.5.1`（具有几乎相同的界面）。

这是使用 XmlHttp 获取 PDF 文件并存储它的示例：-

```
Dim oXMLHTTP
Dim oStream

Set oXMLHTTP = CreateObject("MSXML2.XMLHTTP.3.0")

oXMLHTTP.Open "GET", "http://someserver/folder/file.pdf", False
oXMLHTTP.Send

If oXMLHTTP.Status = 200 Then
    Set oStream = CreateObject("ADODB.Stream")
    oStream.Open
    oStream.Type = 1
    oStream.Write oXMLHTTP.responseBody
    oStream.SaveToFile "c:\somefolder\file.pdf"
    oStream.Close
End If 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-02-18T04:12:51.427

如果您使用 GET 请求实际发送数据...

检查： [http ://techhelplist.com/index.php/tech-tutorials/37-windows-troubles/60-vbscript-sending-get-request](http://techhelplist.com/index.php/tech-tutorials/37-windows-troubles/60-vbscript-sending-get-request)

MSXML2.XMLHTTP 的问题在于它有多个版本，根据 Windows 操作系统版本和补丁而具有不同的名称。

这解释了它：http: [//support.microsoft.com/kb/269238](http://support.microsoft.com/kb/269238)

我有更多的运气使用 vbscript 来调用

```
set ID = CreateObject("InternetExplorer.Application")
IE.visible = 0
IE.navigate "http://example.com/parser.php?key=" & value & "key2=" & value2 
do while IE.Busy.... 
```

....还有更多的东西，但只是为了让请求通过。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-14T13:08:46.213

```
 strRequest = "<soap:Envelope xmlns:soap=""http://www.w3.org/2003/05/soap-envelope"" " &_
         "xmlns:tem=""http://tempuri.org/"">" &_
         "<soap:Header/>" &_
         "<soap:Body>" &_
            "<tem:Authorization>" &_
                "<tem:strCC>"&1234123412341234&"</tem:strCC>" &_
                "<tem:strEXPMNTH>"&11&"</tem:strEXPMNTH>" &_
                "<tem:CVV2>"&123&"</tem:CVV2>" &_
                "<tem:strYR>"&23&"</tem:strYR>" &_
                "<tem:dblAmount>"&1235&"</tem:dblAmount>" &_
            "</tem:Authorization>" &_
        "</soap:Body>" &_
        "</soap:Envelope>"

        EndPointLink = "http://www.trainingrite.net/trainingrite_epaysystem" &_
                "/trainingrite_epaysystem/tr_epaysys.asmx"

dim http
set http=createObject("Microsoft.XMLHTTP")
http.open "POST",EndPointLink,false
http.setRequestHeader "Content-Type","text/xml"

msgbox "REQUEST : " & strRequest
http.send strRequest

If http.Status = 200 Then
'msgbox "RESPONSE : " & http.responseXML.xml
msgbox "RESPONSE : " & http.responseText
responseText=http.responseText
else
msgbox "ERRCODE : " & http.status
End If

Call ParseTag(responseText,"AuthorizationResult")

Call CreateXMLEvidence(responseText,strRequest)

'Function to fetch the required message from a TAG
Function ParseTag(ResponseXML,SearchTag)

 ResponseMessage=split(split(split(ResponseXML,SearchTag)(1),"</")(0),">")(1)
 Msgbox ResponseMessage

End Function

'Function to create XML test evidence files
Function CreateXMLEvidence(ResponseXML,strRequest)

 Set fso=createobject("Scripting.FileSystemObject")
 Set qfile=fso.CreateTextFile("C:\Users\RajkumarJoshua\Desktop\DCIM\SampleResponse.xml",2)
 Set qfile1=fso.CreateTextFile("C:\Users\RajkumarJoshua\Desktop\DCIM\SampleReuest.xml",2)

 qfile.write ResponseXML
 qfile.close

 qfile1.write strRequest
 qfile1.close

End Function 
```

# php - 用 BOM 搜索 UTF-8 文件的优雅方式？

> ID：204765
> 
> 赞同：100
> 
> 时间：2008-10-15T13:48:29.150
> 
> 标签：php, utf-8, shell, text-editor

出于调试目的，我需要递归搜索以 UTF-8 字节顺序标记 (BOM) 开头的所有文件的目录。我目前的解决方案是一个简单的 shell 脚本：

```
find -type f |
while read file
do
    if [ "`head -c 3 -- "$file"`" == $'\xef\xbb\xbf' ]
    then
        echo "found BOM in: $file"
    fi
done
```

或者，如果您更喜欢简短、不可读的单行字：

```
find -type f|while read file;do [ "`head -c3 -- "$file"`" == $'\xef\xbb\xbf' ] && echo "found BOM in: $file";done
```

它不适用于包含换行符的文件名，但无论如何都不会期望此类文件。

有没有更短或更优雅的解决方案？

是否有任何有趣的文本编辑器或文本编辑器的宏？

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2010-05-18T15:37:42.487

这个不仅可以找到而且可以清除讨厌的 BOM 的简单命令怎么样？:)

```
find . -type f -exec sed '1s/^\xEF\xBB\xBF//' -i {} \; 
```

我喜欢“寻找” :)

**警告**以上将**修改**包含这三个字符的二进制文件。

如果您只想显示 BOM 文件，请使用以下文件：

```
grep -rl $'\xEF\xBB\xBF' . 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2011-09-19T23:06:44.257

在 Windows 上执行此操作的最佳和最简单的方法：

[Total Commander](https://en.wikipedia.org/wiki/Total_Commander) → 转到项目的根目录 → 查找文件 ( `Alt`+ `F7`) → 文件类型 *.* → 查找文本“EF BB BF” → 选中“十六进制”复选框 → 搜索

你得到了清单:)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-05-21T19:22:13.180

```
find . -type f -print0 | xargs -0r awk '
    /^\xEF\xBB\xBF/ {print FILENAME}
    {nextfile}' 
```

上面给出的大多数解决方案都比文件的第一行测试更多，即使有一些（例如 Marcus 的解决方案）然后过滤结果。此解决方案仅测试每个文件的第一行，因此应该更快一些。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-17T11:55:14.777

如果您接受一些误报（如果有非文本文件，或者在不太可能的情况下文件中间有 ZWNBSP），您可以使用 grep：

```
fgrep -rl `echo -ne '\xef\xbb\xbf'` . 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-07-12T21:16:51.320

您可以使用`grep`来查找它们并使用 Perl 将它们删除，如下所示：

```
grep -rl $'\xEF\xBB\xBF' . | xargs perl -i -pe 's{\xEF\xBB\xBF}{}' 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-17T14:12:25.950

我会使用类似的东西：

```
grep -orHbm1 "^`echo -ne '\xef\xbb\xbf'`" . | sed '/:0:/!d;s/:0:.*//' 
```

这将确保 BOM 从文件的第一个字节开始出现。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2011-11-03T09:34:05.607

对于 Windows 用户，请参阅[此](https://github.com/emrahgunduz/BomCleaner)（用于在项目中查找的优秀 PHP 脚本`BOM`）。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-12-21T01:55:46.480

一个矫枉过正的解决方案是[`phptags`](http://freecode.com/projects/phptags)（不是`vi`同名的工具），它专门寻找 PHP 脚本：

```
phptags --warn ./ 
```

将输出如下内容：

```
./invalid.php: TRAILING whitespace ("?>\n")
./invalid.php: UTF-8 BOM alone ("\xEF\xBB\xBF") 
```

并且该`--whitespace`模式将自动修复此类问题（递归，但断言它只重写 .php 脚本。）

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-04-03T09:05:19.713

我用它来只更正 JavaScript 文件：

```
find . -iname *.js -type f -exec sed 's/^\xEF\xBB\xBF//' -i.bak {} \; -exec rm {}.bak \; 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-17T13:51:58.333

```
find -type f -print0 | xargs -0 grep -l `printf '^\xef\xbb\xbf'` | sed 's/^/found BOM in: /' 
```

*   `find -print0`在每个文件名之间放置一个空 \0 而不是使用新行
*   `xargs -0`期望空分隔参数而不是行分隔
*   `grep -l`列出与正则表达式匹配的文件
*   正则表达式`^\xeff\xbb\xbf`并不完全正确，因为如果非 BOMed UTF-8 文件在行首的宽度为零，它将匹配它们

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-10-16T14:28:10.630

If you are looking for UTF files, the [file command](http://unixhelp.ed.ac.uk/CGI/man-cgi?file) works. It will tell you what the encoding of the file is. If there are any non ASCII characters in there it will come up with UTF.

```
file *.php | grep UTF 
```

That won't work recursively though. You can probably rig up some fancy command to make it recursive, but I just searched each level individually like the following, until I ran out of levels.

```
file */*.php | grep UTF 
```

# wpf - WPF 将 My.Settings 集合绑定到 Combobox 项

> ID：204779
> 
> 赞同：8
> 
> 时间：2008-10-15T13:51:50.783
> 
> 标签：wpf, binding

我对 WPF 非常陌生，并且仍在尝试围绕 XAML 进行绑定。

我想用 my.settings 中的字符串集合的值填充组合框。我可以用这样的代码做到这一点：

Me.ComboBox1.ItemsSource = My.Settings.MyCollectionOfStrings

......它的工作原理。

如何在我的 XAML 中执行此操作？是否可以？

谢谢

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-15T14:11:49.290

**是**的，您可以（并且大部分情况下应该）在 XAML 中声明绑定，因为这是 WPF 中最强大的功能之一。

在您的情况下，要将 ComboBox 绑定到您的自定义设置之一，您将使用以下 XAML：

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:p="clr-namespace:WpfApplication1.Properties"
    Title="Window1">
    <StackPanel>
        <ComboBox
            ItemsSource="{Binding Source={x:Static p:Settings.Default}, Path=MyCollectionOfStrings}" />
    </StackPanel>
</Window> 
```

注意以下几个方面：

*   我们声明了一个带有前缀“p”的 XML 命名空间，它指向“Settings”类所在的 .NET 命名空间，以便在 XAML 中引用它
*   我们使用标记扩展“{Binding}”在 XAML 中声明绑定
*   我们使用了标记扩展“静态”来表明我们想要引用 XAML 中的静态（VB 中的“共享”）类成员

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-30T16:23:32.067

我有一个更简单的解决方案，使用自定义标记扩展。在您的情况下，它可以像这样使用：

```
<Window x:Class="Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:my="clr-namespace:WpfApplication1"
    Title="Window1" Height="90" Width="462" Name="Window1">
    <Grid>
        <ComboBox ItemsSource="{my:SettingBinding MyCollectionOfStrings}" />
    </Grid>
</Window> 
```

您可以在我的博客上找到此标记扩展的 C# 代码： [http ://www.thomaslevesque.com/2008/11/18/wpf-binding-to-application-settings-using-a-markup-extension/](http://www.thomaslevesque.com/2008/11/18/wpf-binding-to-application-settings-using-a-markup-extension/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T14:12:04.797

有可能的。在 C# 中，我这样做（对于一个简单的布尔值）：

```
IsExpanded="{Binding Source={StaticResource Settings}, Mode=TwoWay, Path=Default.ASettingValue}" 
```

因此，我在 App.xaml 的 Application.Resources 中定义了静态资源“设置”：

```
<!-- other namespaces removed for clarity -->
<Application xmlns:settings="clr-namespace:DefaultNamespace.Properties" >
 <Application.Resources>
  <ResourceDictionary>
   <settings:Settings x:Key="Settings" />
   <!--stuff removed-->
  </ResourceDictionary>
 </Application.Resources>
</Application> 
```

你的路径可能不同；在 C# 中，您可以通过以下方式访问应用程序中的应用程序设置

```
DefaultNamespace.Properties.Settings.Default.ASettingValue 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T16:16:27.230

知道了！

```
<Window x:Class="Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:p="clr-namespace:WpfApplication1"
    Title="Window1" Height="90" Width="462" Name="Window1">
    <Grid>
        <ComboBox ItemsSource="{Binding Source={x:Static p:Settings.Default}, Path=MyCollectionOfStrings}" />
    </Grid>
</Window> 
```

谢谢大家帮助我达到一个伟大的“啊哈！” 时刻 :-) ...希望在我在 WPF 中花费更多时间之后，我会明白为什么会这样。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-06T18:01:50.627

您还可以将列表作为分隔字符串存储在设置中，然后使用转换器。

```
<ComboBox ItemsSource="{Binding Default.ImportHistory,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,Converter={StaticResource StringToListConverter},ConverterParameter=|}" IsEditable="True">
/// <summary>
/// Converts a delimited set of strings to a list and back again. The parameter defines the delimiter
/// </summary>
public class StringToListConverter : IValueConverter {
 /// <summary>
 /// Takes a string, returns a list seperated by {parameter}
 /// </summary>
 public object Convert(object value, Type targetType, object parameter, CultureInfo culture) {
     string serializedList = (value ?? string.Empty).ToString(),
            splitter = (parameter ?? string.Empty).ToString();
     if(serializedList.Trim().Length == 0) {
         return value;
     }
     return serializedList.Split(new[] { splitter }, StringSplitOptions.RemoveEmptyEntries);
 }
 /// <summary>
 /// Takes a list, returns a string seperated by {parameter}
 /// </summary>
 public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture) {
     var items = value as IEnumerable;
     var splitter = (parameter ?? string.Empty).ToString();
     if(value == null || items == null) {
         return value;
     }
     StringBuilder buffer = new StringBuilder();
     foreach(var itm in items) {
         buffer.Append(itm.ToString()).Append(splitter);
     }
     return buffer.ToString(0, splitter.Length > 0 ? buffer.Length - splitter.Length : buffer.Length);
 }
} 
```

然后，当单击浏览按钮时，您可以添加到列表中：

```
var items = Settings.Default.ImportHistory.Split('|');
if(!items.Contains(dlgOpen.FileNames[0])) {
 Settings.Default.ImportHistory += ("|" + dlgOpen.FileNames[0]);
}
cboFilename.SelectedValue = dlgOpen.FileNames[0];
Settings.Default.Save(); 
```

# java - 如何从两个绝对路径（或 URL）构造 Java 中的相对路径？

> ID：204784
> 
> 赞同：309
> 
> 时间：2008-10-15T13:53:42.137
> 
> 标签：java, url, file, path

给定两条绝对路径，例如

```
/var/data/stuff/xyz.dat
/var/data 
```

如何创建以第二条路径为基础的相对路径？在上面的示例中，结果应该是：`./stuff/xyz.dat`

* * *

## 回答 #1

> 赞同：324
> 
> 时间：2008-10-15T17:32:00.883

有点迂回，但为什么不使用URI呢？它有一个 relativize 方法，可以为你做所有必要的检查。

```
String path = "/var/data/stuff/xyz.dat";
String base = "/var/data";
String relative = new File(base).toURI().relativize(new File(path).toURI()).getPath();
// relative == "stuff/xyz.dat" 
```

请注意，正如[@Jirka Meluzin](https://stackoverflow.com/users/1113396/jirka-meluzin)在[另一个答案](https://stackoverflow.com/a/25743823/537554)`java.nio.file.Path#relativize`中指出的那样，自 Java 1.7 以来的文件路径。

* * *

## 回答 #2

> 赞同：269
> 
> 时间：2011-12-18T23:17:08.397

从 Java 7 开始，您可以使用[relativize](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Path.html#relativize%28java.nio.file.Path%29)方法：

```
import java.nio.file.Path;
import java.nio.file.Paths;

public class Test {

     public static void main(String[] args) {
        Path pathAbsolute = Paths.get("/var/data/stuff/xyz.dat");
        Path pathBase = Paths.get("/var/data");
        Path pathRelative = pathBase.relativize(pathAbsolute);
        System.out.println(pathRelative);
    }

} 
```

输出：

```
stuff/xyz.dat 
```

* * *

## 回答 #3

> 赞同：77
> 
> 时间：2010-06-16T15:24:08.113

在撰写本文时（2010 年 6 月），这是通过我的测试用例的唯一解决方案。我不能保证这个解决方案没有错误，但它确实通过了包含的测试用例。我编写的方法和测试取决于[Apache commons IO](http://commons.apache.org/io/)[`FilenameUtils`](https://commons.apache.org/proper/commons-io/javadocs/api-release/org/apache/commons/io/FilenameUtils.html)中的类。

该解决方案已使用 Java 1.4 进行了测试。如果您使用的是 Java 1.5（或更高版本），则应考虑替换`StringBuffer`为`StringBuilder`（如果您仍在使用 Java 1.4，则应考虑更换雇主）。

```
import java.io.File;
import java.util.regex.Pattern;

import org.apache.commons.io.FilenameUtils;

public class ResourceUtils {

    /**
     * Get the relative path from one file to another, specifying the directory separator. 
     * If one of the provided resources does not exist, it is assumed to be a file unless it ends with '/' or
     * '\'.
     * 
     * @param targetPath targetPath is calculated to this file
     * @param basePath basePath is calculated from this file
     * @param pathSeparator directory separator. The platform default is not assumed so that we can test Unix behaviour when running on Windows (for example)
     * @return
     */
    public static String getRelativePath(String targetPath, String basePath, String pathSeparator) {

        // Normalize the paths
        String normalizedTargetPath = FilenameUtils.normalizeNoEndSeparator(targetPath);
        String normalizedBasePath = FilenameUtils.normalizeNoEndSeparator(basePath);

        // Undo the changes to the separators made by normalization
        if (pathSeparator.equals("/")) {
            normalizedTargetPath = FilenameUtils.separatorsToUnix(normalizedTargetPath);
            normalizedBasePath = FilenameUtils.separatorsToUnix(normalizedBasePath);

        } else if (pathSeparator.equals("\\")) {
            normalizedTargetPath = FilenameUtils.separatorsToWindows(normalizedTargetPath);
            normalizedBasePath = FilenameUtils.separatorsToWindows(normalizedBasePath);

        } else {
            throw new IllegalArgumentException("Unrecognised dir separator '" + pathSeparator + "'");
        }

        String[] base = normalizedBasePath.split(Pattern.quote(pathSeparator));
        String[] target = normalizedTargetPath.split(Pattern.quote(pathSeparator));

        // First get all the common elements. Store them as a string,
        // and also count how many of them there are.
        StringBuffer common = new StringBuffer();

        int commonIndex = 0;
        while (commonIndex < target.length && commonIndex < base.length
                && target[commonIndex].equals(base[commonIndex])) {
            common.append(target[commonIndex] + pathSeparator);
            commonIndex++;
        }

        if (commonIndex == 0) {
            // No single common path element. This most
            // likely indicates differing drive letters, like C: and D:.
            // These paths cannot be relativized.
            throw new PathResolutionException("No common path element found for '" + normalizedTargetPath + "' and '" + normalizedBasePath
                    + "'");
        }   

        // The number of directories we have to backtrack depends on whether the base is a file or a dir
        // For example, the relative path from
        //
        // /foo/bar/baz/gg/ff to /foo/bar/baz
        // 
        // ".." if ff is a file
        // "../.." if ff is a directory
        //
        // The following is a heuristic to figure out if the base refers to a file or dir. It's not perfect, because
        // the resource referred to by this path may not actually exist, but it's the best I can do
        boolean baseIsFile = true;

        File baseResource = new File(normalizedBasePath);

        if (baseResource.exists()) {
            baseIsFile = baseResource.isFile();

        } else if (basePath.endsWith(pathSeparator)) {
            baseIsFile = false;
        }

        StringBuffer relative = new StringBuffer();

        if (base.length != commonIndex) {
            int numDirsUp = baseIsFile ? base.length - commonIndex - 1 : base.length - commonIndex;

            for (int i = 0; i < numDirsUp; i++) {
                relative.append(".." + pathSeparator);
            }
        }
        relative.append(normalizedTargetPath.substring(common.length()));
        return relative.toString();
    }

    static class PathResolutionException extends RuntimeException {
        PathResolutionException(String msg) {
            super(msg);
        }
    }    
} 
```

这通过的测试用例是

```
public void testGetRelativePathsUnix() {
    assertEquals("stuff/xyz.dat", ResourceUtils.getRelativePath("/var/data/stuff/xyz.dat", "/var/data/", "/"));
    assertEquals("../../b/c", ResourceUtils.getRelativePath("/a/b/c", "/a/x/y/", "/"));
    assertEquals("../../b/c", ResourceUtils.getRelativePath("/m/n/o/a/b/c", "/m/n/o/a/x/y/", "/"));
}

public void testGetRelativePathFileToFile() {
    String target = "C:\\Windows\\Boot\\Fonts\\chs_boot.ttf";
    String base = "C:\\Windows\\Speech\\Common\\sapisvr.exe";

    String relPath = ResourceUtils.getRelativePath(target, base, "\\");
    assertEquals("..\\..\\Boot\\Fonts\\chs_boot.ttf", relPath);
}

public void testGetRelativePathDirectoryToFile() {
    String target = "C:\\Windows\\Boot\\Fonts\\chs_boot.ttf";
    String base = "C:\\Windows\\Speech\\Common\\";

    String relPath = ResourceUtils.getRelativePath(target, base, "\\");
    assertEquals("..\\..\\Boot\\Fonts\\chs_boot.ttf", relPath);
}

public void testGetRelativePathFileToDirectory() {
    String target = "C:\\Windows\\Boot\\Fonts";
    String base = "C:\\Windows\\Speech\\Common\\foo.txt";

    String relPath = ResourceUtils.getRelativePath(target, base, "\\");
    assertEquals("..\\..\\Boot\\Fonts", relPath);
}

public void testGetRelativePathDirectoryToDirectory() {
    String target = "C:\\Windows\\Boot\\";
    String base = "C:\\Windows\\Speech\\Common\\";
    String expected = "..\\..\\Boot";

    String relPath = ResourceUtils.getRelativePath(target, base, "\\");
    assertEquals(expected, relPath);
}

public void testGetRelativePathDifferentDriveLetters() {
    String target = "D:\\sources\\recovery\\RecEnv.exe";
    String base = "C:\\Java\\workspace\\AcceptanceTests\\Standard test data\\geo\\";

    try {
        ResourceUtils.getRelativePath(target, base, "\\");
        fail();

    } catch (PathResolutionException ex) {
        // expected exception
    }
} 
```

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2009-04-01T15:02:45.063

使用 java.net.URI.relativize 时，您应该注意 Java 错误： [JDK-6226081（URI 应该能够对具有部分根的路径进行相对化）](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6226081)

> 目前，只有当一个是另一个的前缀时，该`relativize()`方法`URI`才会相对化 URI。

这本质上意味着`java.net.URI.relativize`不会为您创建“..”。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2016-04-07T13:34:11.317

在**Java 7**及更高版本中，您可以简单地使用（与 相比`URI`，它没有错误）：

```
Path#relativize(Path) 
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2009-08-17T20:44:07.673

[另一个答案](https://stackoverflow.com/a/705963/)中提到的错误由[Apache HttpComponents](https://hc.apache.org/httpcomponents-client-ga/httpclient/project-info.html)中的[URIUtils解决](https://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/client/utils/URIUtils.html#resolve%28java.net.URI,%20java.lang.String%29)

```
public static URI resolve(URI baseURI,
                          String reference) 
```

> 根据基本 URI 解析 URI 引用。解决 java.net.URI () 中的错误

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2008-10-15T14:09:29.343

如果您知道第二个字符串是第一个字符串的一部分：

```
String s1 = "/var/data/stuff/xyz.dat";
String s2 = "/var/data";
String s3 = s1.substring(s2.length()); 
```

或者如果你真的想要在你的例子开头的句点：

```
String s3 = ".".concat(s1.substring(s2.length())); 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2012-06-26T20:11:12.340

递归产生一个更小的解决方案。如果结果是不可能的（例如不同的 Windows 磁盘）或不切实际（根目录只是公共目录），则会引发异常。

```
/**
 * Computes the path for a file relative to a given base, or fails if the only shared 
 * directory is the root and the absolute form is better.
 * 
 * @param base File that is the base for the result
 * @param name File to be "relativized"
 * @return the relative name
 * @throws IOException if files have no common sub-directories, i.e. at best share the
 *                     root prefix "/" or "C:\"
 */

public static String getRelativePath(File base, File name) throws IOException  {
    File parent = base.getParentFile();

    if (parent == null) {
        throw new IOException("No common directory");
    }

    String bpath = base.getCanonicalPath();
    String fpath = name.getCanonicalPath();

    if (fpath.startsWith(bpath)) {
        return fpath.substring(bpath.length() + 1);
    } else {
        return (".." + File.separator + getRelativePath(parent, name));
    }
} 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2014-09-09T11:45:52.917

这是其他图书馆免费的解决方案：

```
Path sourceFile = Paths.get("some/common/path/example/a/b/c/f1.txt");
Path targetFile = Paths.get("some/common/path/example/d/e/f2.txt"); 
Path relativePath = sourceFile.relativize(targetFile);
System.out.println(relativePath); 
```

输出

```
..\..\..\..\d\e\f2.txt 
```

[编辑] 实际上它输出更多 ..\ 因为源是文件而不是目录。我的情况的正确解决方案是：

```
Path sourceFile = Paths.get(new File("some/common/path/example/a/b/c/f1.txt").parent());
Path targetFile = Paths.get("some/common/path/example/d/e/f2.txt"); 
Path relativePath = sourceFile.relativize(targetFile);
System.out.println(relativePath); 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-08-13T03:38:01.637

我的版本大致基于[Matt](https://stackoverflow.com/a/205621/14731)和[Steve](https://stackoverflow.com/a/205592/14731)的版本：

```
/**
 * Returns the path of one File relative to another.
 *
 * @param target the target directory
 * @param base the base directory
 * @return target's path relative to the base directory
 * @throws IOException if an error occurs while resolving the files' canonical names
 */
 public static File getRelativeFile(File target, File base) throws IOException
 {
   String[] baseComponents = base.getCanonicalPath().split(Pattern.quote(File.separator));
   String[] targetComponents = target.getCanonicalPath().split(Pattern.quote(File.separator));

   // skip common components
   int index = 0;
   for (; index < targetComponents.length && index < baseComponents.length; ++index)
   {
     if (!targetComponents[index].equals(baseComponents[index]))
       break;
   }

   StringBuilder result = new StringBuilder();
   if (index != baseComponents.length)
   {
     // backtrack to base directory
     for (int i = index; i < baseComponents.length; ++i)
       result.append(".." + File.separator);
   }
   for (; index < targetComponents.length; ++index)
     result.append(targetComponents[index] + File.separator);
   if (!target.getPath().endsWith("/") && !target.getPath().endsWith("\\"))
   {
     // remove final path separator
     result.delete(result.length() - File.separator.length(), result.length());
   }
   return new File(result.toString());
 } 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-08-17T15:25:02.533

Matt B 的解决方案使要回溯的目录数量错误 - 它应该是基本路径的长度减去公共路径元素的数量，再减去一（对于最后一个路径元素，它是文件名或由`""`生成的尾随`split`） . 它恰好与`/a/b/c/`and一起使用，但是用and`/a/x/y/`替换参数，您将看到问题。`/m/n/o/a/b/c/``/m/n/o/a/x/y/`

此外，它需要`else break`在第一个 for 循环内部，否则它将错误处理恰好具有匹配目录名称的路径，例如`/a/b/c/d/`and `/x/y/c/z`--`c`在两个数组中的同一插槽中，但不是实际匹配。

所有这些解决方案都缺乏处理无法相互关联的路径的能力，因为它们具有不相容的根，例如`C:\foo\bar`和`D:\baz\quux`。可能只是 Windows 上的一个问题，但值得注意。

我在这方面花费的时间比我预期的要长得多，但这没关系。我实际上需要这个工作，所以感谢所有参与进来的人，我相信这个版本也会更正！

```
public static String getRelativePath(String targetPath, String basePath, 
        String pathSeparator) {

    //  We need the -1 argument to split to make sure we get a trailing 
    //  "" token if the base ends in the path separator and is therefore
    //  a directory. We require directory paths to end in the path
    //  separator -- otherwise they are indistinguishable from files.
    String[] base = basePath.split(Pattern.quote(pathSeparator), -1);
    String[] target = targetPath.split(Pattern.quote(pathSeparator), 0);

    //  First get all the common elements. Store them as a string,
    //  and also count how many of them there are. 
    String common = "";
    int commonIndex = 0;
    for (int i = 0; i < target.length && i < base.length; i++) {
        if (target[i].equals(base[i])) {
            common += target[i] + pathSeparator;
            commonIndex++;
        }
        else break;
    }

    if (commonIndex == 0)
    {
        //  Whoops -- not even a single common path element. This most
        //  likely indicates differing drive letters, like C: and D:. 
        //  These paths cannot be relativized. Return the target path.
        return targetPath;
        //  This should never happen when all absolute paths
        //  begin with / as in *nix. 
    }

    String relative = "";
    if (base.length == commonIndex) {
        //  Comment this out if you prefer that a relative path not start with ./
        //relative = "." + pathSeparator;
    }
    else {
        int numDirsUp = base.length - commonIndex - 1;
        //  The number of directories we have to backtrack is the length of 
        //  the base path MINUS the number of common path elements, minus
        //  one because the last element in the path isn't a directory.
        for (int i = 1; i <= (numDirsUp); i++) {
            relative += ".." + pathSeparator;
        }
    }
    relative += targetPath.substring(common.length());

    return relative;
} 
```

以下是涵盖几种情况的测试：

```
public void testGetRelativePathsUnixy() 
{        
    assertEquals("stuff/xyz.dat", FileUtils.getRelativePath(
            "/var/data/stuff/xyz.dat", "/var/data/", "/"));
    assertEquals("../../b/c", FileUtils.getRelativePath(
            "/a/b/c", "/a/x/y/", "/"));
    assertEquals("../../b/c", FileUtils.getRelativePath(
            "/m/n/o/a/b/c", "/m/n/o/a/x/y/", "/"));
}

public void testGetRelativePathFileToFile() 
{
    String target = "C:\\Windows\\Boot\\Fonts\\chs_boot.ttf";
    String base = "C:\\Windows\\Speech\\Common\\sapisvr.exe";

    String relPath = FileUtils.getRelativePath(target, base, "\\");
    assertEquals("..\\..\\..\\Boot\\Fonts\\chs_boot.ttf", relPath);
}

public void testGetRelativePathDirectoryToFile() 
{
    String target = "C:\\Windows\\Boot\\Fonts\\chs_boot.ttf";
    String base = "C:\\Windows\\Speech\\Common";

    String relPath = FileUtils.getRelativePath(target, base, "\\");
    assertEquals("..\\..\\Boot\\Fonts\\chs_boot.ttf", relPath);
}

public void testGetRelativePathDifferentDriveLetters() 
{
    String target = "D:\\sources\\recovery\\RecEnv.exe";
    String base   = "C:\\Java\\workspace\\AcceptanceTests\\Standard test data\\geo\\";

    //  Should just return the target path because of the incompatible roots.
    String relPath = FileUtils.getRelativePath(target, base, "\\");
    assertEquals(target, relPath);
} 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-10-15T17:21:26.100

实际上，如果目标路径不是基本路径的子路径，则我的其他答案不起作用。

这应该有效。

```
public class RelativePathFinder {

    public static String getRelativePath(String targetPath, String basePath, 
       String pathSeparator) {

        // find common path
        String[] target = targetPath.split(pathSeparator);
        String[] base = basePath.split(pathSeparator);

        String common = "";
        int commonIndex = 0;
        for (int i = 0; i < target.length && i < base.length; i++) {

            if (target[i].equals(base[i])) {
                common += target[i] + pathSeparator;
                commonIndex++;
            }
        }

        String relative = "";
        // is the target a child directory of the base directory?
        // i.e., target = /a/b/c/d, base = /a/b/
        if (commonIndex == base.length) {
            relative = "." + pathSeparator + targetPath.substring(common.length());
        }
        else {
            // determine how many directories we have to backtrack
            for (int i = 1; i <= commonIndex; i++) {
                relative += ".." + pathSeparator;
            }
            relative += targetPath.substring(common.length());
        }

        return relative;
    }

    public static String getRelativePath(String targetPath, String basePath) {
        return getRelativePath(targetPath, basePath, File.pathSeparator);
    }
} 
```

* * *

```
public class RelativePathFinderTest extends TestCase {

    public void testGetRelativePath() {
        assertEquals("./stuff/xyz.dat", RelativePathFinder.getRelativePath(
                "/var/data/stuff/xyz.dat", "/var/data/", "/"));
        assertEquals("../../b/c", RelativePathFinder.getRelativePath("/a/b/c",
                "/a/x/y/", "/"));
    }

} 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-12-16T16:12:58.193

凉爽的！！我需要一些这样的代码，但用于比较 Linux 机器上的目录路径。我发现这在以父目录为目标的情况下不起作用。

这是该方法的目录友好版本：

```
 public static String getRelativePath(String targetPath, String basePath, 
     String pathSeparator) {

 boolean isDir = false;
 {
   File f = new File(targetPath);
   isDir = f.isDirectory();
 }
 //  We need the -1 argument to split to make sure we get a trailing 
 //  "" token if the base ends in the path separator and is therefore
 //  a directory. We require directory paths to end in the path
 //  separator -- otherwise they are indistinguishable from files.
 String[] base = basePath.split(Pattern.quote(pathSeparator), -1);
 String[] target = targetPath.split(Pattern.quote(pathSeparator), 0);

 //  First get all the common elements. Store them as a string,
 //  and also count how many of them there are. 
 String common = "";
 int commonIndex = 0;
 for (int i = 0; i < target.length && i < base.length; i++) {
     if (target[i].equals(base[i])) {
         common += target[i] + pathSeparator;
         commonIndex++;
     }
     else break;
 }

 if (commonIndex == 0)
 {
     //  Whoops -- not even a single common path element. This most
     //  likely indicates differing drive letters, like C: and D:. 
     //  These paths cannot be relativized. Return the target path.
     return targetPath;
     //  This should never happen when all absolute paths
     //  begin with / as in *nix. 
 }

 String relative = "";
 if (base.length == commonIndex) {
     //  Comment this out if you prefer that a relative path not start with ./
     relative = "." + pathSeparator;
 }
 else {
     int numDirsUp = base.length - commonIndex - (isDir?0:1); /* only subtract 1 if it  is a file. */
     //  The number of directories we have to backtrack is the length of 
     //  the base path MINUS the number of common path elements, minus
     //  one because the last element in the path isn't a directory.
     for (int i = 1; i <= (numDirsUp); i++) {
         relative += ".." + pathSeparator;
     }
 }
 //if we are comparing directories then we 
 if (targetPath.length() > common.length()) {
  //it's OK, it isn't a directory
  relative += targetPath.substring(common.length());
 }

 return relative;
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-15T17:13:25.057

我假设您有**fromPath**（文件夹的绝对路径）和**toPath**（文件夹/文件的绝对路径），并且您正在寻找将**toPath**中的文件/文件夹表示为相对路径的路径从**fromPath**（您当前的工作目录是**fromPath**）然后这样的事情应该工作：

```
public static String getRelativePath(String fromPath, String toPath) {

  // This weirdness is because a separator of '/' messes with String.split()
  String regexCharacter = File.separator;
  if (File.separatorChar == '\\') {
    regexCharacter = "\\\\";
  }

  String[] fromSplit = fromPath.split(regexCharacter);
  String[] toSplit = toPath.split(regexCharacter);

  // Find the common path
  int common = 0;
  while (fromSplit[common].equals(toSplit[common])) {
    common++;
  }

  StringBuffer result = new StringBuffer(".");

  // Work your way up the FROM path to common ground
  for (int i = common; i < fromSplit.length; i++) {
    result.append(File.separatorChar).append("..");
  }

  // Work your way down the TO path
  for (int i = common; i < toSplit.length; i++) {
    result.append(File.separatorChar).append(toSplit[i]);
  }

  return result.toString();
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-10-12T08:25:04.297

这里已经有很多答案，但我发现它们并没有处理所有情况，例如基础和目标相同。此函数采用基本*目录*和目标路径并返回相对路径。如果不存在相对路径，则返回目标路径。File.separator 是不必要的。

```
public static String getRelativePath (String baseDir, String targetPath) {
    String[] base = baseDir.replace('\\', '/').split("\\/");
    targetPath = targetPath.replace('\\', '/');
    String[] target = targetPath.split("\\/");

    // Count common elements and their length.
    int commonCount = 0, commonLength = 0, maxCount = Math.min(target.length, base.length);
    while (commonCount < maxCount) {
        String targetElement = target[commonCount];
        if (!targetElement.equals(base[commonCount])) break;
        commonCount++;
        commonLength += targetElement.length() + 1; // Directory name length plus slash.
    }
    if (commonCount == 0) return targetPath; // No common path element.

    int targetLength = targetPath.length();
    int dirsUp = base.length - commonCount;
    StringBuffer relative = new StringBuffer(dirsUp * 3 + targetLength - commonLength + 1);
    for (int i = 0; i < dirsUp; i++)
        relative.append("../");
    if (commonLength < targetLength) relative.append(targetPath.substring(commonLength));
    return relative.toString();
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-05-30T08:20:44.570

这是一个从基本路径解析相对路径的方法，无论它们是在同一根还是在不同的根中：

```
public static String GetRelativePath(String path, String base){

    final String SEP = "/";

    // if base is not a directory -> return empty
    if (!base.endsWith(SEP)){
        return "";
    }

    // check if path is a file -> remove last "/" at the end of the method
    boolean isfile = !path.endsWith(SEP);

    // get URIs and split them by using the separator
    String a = "";
    String b = "";
    try {
        a = new File(base).getCanonicalFile().toURI().getPath();
        b = new File(path).getCanonicalFile().toURI().getPath();
    } catch (IOException e) {
        e.printStackTrace();
    }
    String[] basePaths = a.split(SEP);
    String[] otherPaths = b.split(SEP);

    // check common part
    int n = 0;
    for(; n < basePaths.length && n < otherPaths.length; n ++)
    {
        if( basePaths[n].equals(otherPaths[n]) == false )
            break;
    }

    // compose the new path
    StringBuffer tmp = new StringBuffer("");
    for(int m = n; m < basePaths.length; m ++)
        tmp.append(".."+SEP);
    for(int m = n; m < otherPaths.length; m ++)
    {
        tmp.append(otherPaths[m]);
        tmp.append(SEP);
    }

    // get path string
    String result = tmp.toString();

    // remove last "/" if path is a file
    if (isfile && result.endsWith(SEP)){
        result = result.substring(0,result.length()-1);
    }

    return result;
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-12-31T19:23:57.333

通过了 Dónal 的测试，唯一的变化 - 如果没有公共根，它返回目标路径（它可能已经是相对的）

```
import static java.util.Arrays.asList;
import static java.util.Collections.nCopies;
import static org.apache.commons.io.FilenameUtils.normalizeNoEndSeparator;
import static org.apache.commons.io.FilenameUtils.separatorsToUnix;
import static org.apache.commons.lang3.StringUtils.getCommonPrefix;
import static org.apache.commons.lang3.StringUtils.isBlank;
import static org.apache.commons.lang3.StringUtils.isNotEmpty;
import static org.apache.commons.lang3.StringUtils.join;

import java.io.File;
import java.util.ArrayList;
import java.util.List;

public class ResourceUtils {

    public static String getRelativePath(String targetPath, String basePath, String pathSeparator) {
        File baseFile = new File(basePath);
        if (baseFile.isFile() || !baseFile.exists() && !basePath.endsWith("/") && !basePath.endsWith("\\"))
            basePath = baseFile.getParent();

        String target = separatorsToUnix(normalizeNoEndSeparator(targetPath));
        String base = separatorsToUnix(normalizeNoEndSeparator(basePath));

        String commonPrefix = getCommonPrefix(target, base);
        if (isBlank(commonPrefix))
            return targetPath.replaceAll("/", pathSeparator);

        target = target.replaceFirst(commonPrefix, "");
        base = base.replaceFirst(commonPrefix, "");

        List<String> result = new ArrayList<>();
        if (isNotEmpty(base))
            result.addAll(nCopies(base.split("/").length, ".."));
        result.addAll(asList(target.replaceFirst("^/", "").split("/")));

        return join(result, pathSeparator);
    }
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-04-09T14:53:30.410

如果你正在编写一个 Maven 插件，你可以使用[Plexus'`PathTool`](https://codehaus-plexus.github.io/plexus-utils/apidocs/org/codehaus/plexus/util/PathTool.html)：

```
import org.codehaus.plexus.util.PathTool;

String relativeFilePath = PathTool.getRelativeFilePath(file1, file2); 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-11-26T09:18:42.413

如果路径不适用于 JRE 1.5 运行时或 maven 插件

```
package org.afc.util;

import java.io.File;
import java.util.LinkedList;
import java.util.List;

public class FileUtil {

    public static String getRelativePath(String basePath, String filePath)  {
        return getRelativePath(new File(basePath), new File(filePath));
    }

    public static String getRelativePath(File base, File file)  {

        List<String> bases = new LinkedList<String>();
        bases.add(0, base.getName());
        for (File parent = base.getParentFile(); parent != null; parent = parent.getParentFile()) {
            bases.add(0, parent.getName());
        }

        List<String> files = new LinkedList<String>();
        files.add(0, file.getName());
        for (File parent = file.getParentFile(); parent != null; parent = parent.getParentFile()) {
            files.add(0, parent.getName());
        }

        int overlapIndex = 0;
        while (overlapIndex < bases.size() && overlapIndex < files.size() && bases.get(overlapIndex).equals(files.get(overlapIndex))) {
            overlapIndex++;
        }

        StringBuilder relativePath = new StringBuilder();
        for (int i = overlapIndex; i < bases.size(); i++) {
            relativePath.append("..").append(File.separatorChar);
        }

        for (int i = overlapIndex; i < files.size(); i++) {
            relativePath.append(files.get(i)).append(File.separatorChar);
        }

        relativePath.deleteCharAt(relativePath.length() - 1);
        return relativePath.toString();
    }

} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-12-24T03:41:59.500

我知道这有点晚了，但是我创建了一个适用于任何 Java 版本的解决方案。

```
 public static String getRealtivePath(File root, File file) 
    {
        String path = file.getPath();
        String rootPath = root.getPath();
        boolean plus1 = path.contains(File.separator);
        return path.substring(path.indexOf(rootPath) + rootPath.length() + (plus1 ? 1 : 0));
    } 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2014-01-26T20:31:44.330

org.apache.ant 有一个带有 getRelativePath 方法的 FileUtils 类。自己还没有尝试过，但值得一试。

[http://javadoc.haefelinger.it/org.apache.ant/1.7.1/org/apache/tools/ant/util/FileUtils.html#getRelativePath(java.io.File](http://javadoc.haefelinger.it/org.apache.ant/1.7.1/org/apache/tools/ant/util/FileUtils.html#getRelativePath(java.io.File) , java.io.File)

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2015-07-31T09:18:24.933

```
private String relative(String left, String right){
    String[] lefts = left.split("/");
    String[] rights = right.split("/");
    int min = Math.min(lefts.length, rights.length);
    int commonIdx = -1;
    for(int i = 0; i < min; i++){
        if(commonIdx < 0 && !lefts[i].equals(rights[i])){
            commonIdx = i - 1;
            break;
        }
    }
    if(commonIdx < 0){
        return null;
    }
    StringBuilder sb = new StringBuilder(Math.max(left.length(), right.length()));
    sb.append(left).append("/");
    for(int i = commonIdx + 1; i < lefts.length;i++){
        sb.append("../");
    }
    for(int i = commonIdx + 1; i < rights.length;i++){
        sb.append(rights[i]).append("/");
    }

    return sb.deleteCharAt(sb.length() -1).toString();
} 
```

* * *

## 回答 #23

> 赞同：-3
> 
> 时间：2008-10-15T16:50:48.020

伪代码：

1.  通过路径分隔符（“/”）分割字符串
2.  通过遍历拆分字符串的结果来找到最大的公共路径（因此在两个示例中您最终会得到“/var/data”或“/a”）
3.  `return "." + whicheverPathIsLonger.substring(commonPath.length);`

# passwords - 两个PHPBB问题

> ID：204787
> 
> 赞同：0
> 
> 时间：2008-10-15T13:54:28.373
> 
> 标签：passwords, registration, phpbb

我想知道是否可以就我遇到的两个问题寻求帮助：

首先，是否有可能，假设我有一个随机变量来加载两个不同的注册屏幕？IE。一个有和没有验证码？或者一个有和没有我想使用的其他东西？

其次，是否可以有第二个登录框？说某人已经登录，向他们显示另一个可能允许他们再次登录或我想使用它，显示他们知道另一个人的密码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T15:52:33.300

[克里斯，你有没有试过在phpBB 社区论坛](http://www.phpbb.com/community/?sid=fde569d6a492d70273b878edfeece0f4)上询问这些人？

他们可能会帮助你，因为我认为修改 phpBB 是他们的面包和黄油。

[http://www.phpbb.com/community/?sid=fde569d6a492d70273b878edfeece0f4](http://www.phpbb.com/community/?sid=fde569d6a492d70273b878edfeece0f4)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T15:53:58.913

一个检查的好地方是phpBB 网站上的[phpBB MOD 数据库](http://www.phpbb.com/mods/db/)，看看其他人是否已经做过。

如果您确实找到了一些您想要的东西，请确保它适用于正确的版本。phpBB2 模组不适用于 phpBB3，反之亦然。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T13:57:11.083

phpBB 是开源的，所以你可以修改它来做这两件事——但它们不是开箱即用的选项。

# eclipse - 如何从 Eclipse 的 Synchronize 视图中导出选定的文件？

> ID：204799
> 
> 赞同：7
> 
> 时间：2008-10-15T13:57:13.893
> 
> 标签：eclipse

有时我做了一些本地更改，出于某种原因不想将它们提交到源存储库。在这种情况下，我喜欢压缩并保存我的本地文件系统上的更改，直到我准备好在以后提交它们。

我记得在早期版本的 eclipse 中，有一个来自 Synchronize 视图的上下文相关操作，它会在 Navigator 视图中突出显示您在 Synchronize 视图中选择的相同文件。然后从导航器视图中，您可以选择导出突出显示的选择。

我看不到 Synchronize 视图中仍然可以使用该选项的位置，并且在 Navigator/Package Explorer 视图中手动选择文件很乏味。是否有一种简单的方法可以在同步视图中导出选定的文件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-20T03:48:24.617

您可能想查看*更改集*功能。

在同步视图中，最后一个按钮是更改集按钮 - 如果打开它，您可以将更改分配给您定义的集（右键单击列出的文件，然后*添加到 -> 新更改集*。

我设置了一个名为*Local changes*的更改集，然后为我正在处理的每个缺陷/功能设置了一个新的更改集（并将其设置为默认更改集）。当需要提交功能或缺陷的更改时，我只需右键单击相应的更改集名称并单击*commit*。

这样，您可以随心所欲地保留本地更改，而不必担心对哪些文件需要提交以及哪些文件要保留（或从中创建补丁等）进行排序。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-17T19:58:22.350

它不在上下文菜单上，但转到顶部的导航菜单并选择“显示在->导航器”将应用该选择。我不知道您是否可以只导出选定的文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-09-30T16:53:54.850

您可以通过设置导出的快捷键并使用它来做到这一点，同时在 Eclipse 中几乎所有地方都选择了相关文件，包括同步视图。

转到 Windows > Preferences > General > Keys 搜索“导出”并将其绑定到一个键。不要忘记将“时间”设置为“在对话框和窗口中”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-18T09:36:09.160

补丁不正是您需要的吗？Synchronize 视图中应该有一个**Create Patch**上下文菜单项，它会创建一个文件，其中包含对所选源文件的所有更改。**您可以稍后使用Apply Patch**轻松重新应用补丁。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-10-26T09:49:08.577

使用变更集的想法很好。如果要导出链接到更改集的所有文件，请执行以下操作：

同步视图>>选择更改集>>文件>>导出...>>常规>>文件系统>>下一步>>现在选择更改集的所有文件>>选择“为文件创建目录结构”和一个导出的“到目录”>>完成

问候

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-08-13T10:38:54.827

这就是我在 eclipse 2019-06 (4.12.0) 中的做法

假设，我正在处理 Primeface Upgrade 的问题并且出现了一个新问题。我需要将与 PF 升级相关的现有更改备份到特定更改集，例如先*升级*。以下是过程

1.  打开团队同步视角
2.  在同步视图上，最后一个按钮是更改集按钮，打开它
3.  选择应该成为变更集*升级*一部分的所有文件。右键单击列出的文件，然后添加到/重新分配更改到 -> 新更改集 -> 命名为*升级*-> 选择“输入提交评论” -> 输入提交评论 -> 单击确定
4.  使用相同的方法添加所有应该成为变更集一部分的文件
5.  右键单击变更集*升级*-> 创建路径 -> 保存在文件系统中 -> 选择位置和文件 -> 选择工作区 -> 完成
6.  上述步骤将创建补丁文件，我们可以重新应用它来获得变更集的效果
7.  要重新应用：右键单击将应用变更集的版本 -> 团队 -> 应用补丁 -> 选择文件 -> 选择路径文件 -> 下一步 -> 检查所有更改是否已导入 -> 完成。
8.  每天下班后，我每天只使用第 5 步备份此补丁文件

# c# - 如何在 VB.Net 中声明 lambda 事件处理程序？

> ID：204801
> 
> 赞同：21
> 
> 时间：2008-10-15T13:57:22.487
> 
> 标签：c#, vb.net, unit-testing, events, lambda

我相信下面的 VB.Net 代码相当于前面的 C# 代码；但是 VB.Net 测试失败 - 从未调用事件处理 Lambda。

到底是怎么回事？

VB.Net 版本 - 失败：

```
<TestFixture()> _
Public Class TestClass
    <Test()> _
    Public Sub EventTest()
        Dim eventClass As New EventClass
        Dim eventRaised As Boolean = False
        AddHandler eventClass.AnEvent, Function() (eventRaised = True)
        eventClass.RaiseIt()
        Assert.IsTrue(eventRaised)
    End Sub    
End Class

Public Class EventClass
    Public Event AnEvent()
    Public Sub RaiseIt()
        RaiseEvent AnEvent()
    End Sub
End Class 
```

C# 版本 - 通过：

```
[TestFixture]
    public class TestClass
    {
        [Test]
        public void EventTest()
        {
            var eventClass = new EventClass();
            var eventRaised = false;
            eventClass.AnEvent += () => { eventRaised = true; }; 
            eventClass.RaiseIt();
            Assert.IsTrue(eventRaised);
        }
    }

    public class EventClass
    {
        public delegate void EventHandler();
        public event EventHandler AnEvent;
        public void RaiseIt()
        {
            AnEvent();
        }
    } 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-06T14:15:30.220

对于那些现在发现这个问题的人：自 Visual Basic 2010 (VB 10.0) 以来，匿名`Sub`s 确实有效，因此您可以编写如下内容：

```
Sub() eventRaised = True 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-15T14:45:04.233

> **注意：**这与 Visual Studio 2010 和 VB.net 10 之前的旧版本 VB.net 相关

不同之处在于，在 VB.Net 中，lambda 表达式必须返回一个值，即它们必须是函数而不是子函数。lambda 表达式`eventRaised = true`被解释为布尔表达式而不是赋值，即评估为假而不是设置为真。

[有关MSDN](http://msdn.microsoft.com/en-us/library/bb531253.aspx)的更多详细信息。

我不认为示例中使用的用于测试事件的 c# 模式可以在 VB.Net 中完成而不引入另一个函数，例如

```
<TestFixture()> _
Public Class Test
    <Test()> _
    Public Sub EventTest()
        Dim eventClass As New EventClass
        Dim eventRaised As Boolean = False
        AddHandler eventClass.AnEvent, Function() (SetValueToTrue(eventRaised))
        eventClass.RaiseIt()
        Assert.IsTrue(eventRaised)
    End Sub

    Private Function SetValueToTrue(ByRef value As Boolean) As Boolean
        value = True
        Return True
    End Function

End Class

Public Class EventClass
    Public Event AnEvent()
    Public Sub RaiseIt()
        RaiseEvent AnEvent()
    End Sub
End Class 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-19T05:11:09.517

长话短说，你暂时不能在 VB 中这样做（它在考虑下一个版本的特性列表中）。您必须使用已声明的方法和 AddressOf 运算符。

VB 团队没有时间在语言中包含匿名委托（这是您尝试使用的，技术上不是 lambda 表达式）。

他们必须实现 Lambda 表达式，这样 Linq 才能真正工作。任何事情都不需要匿名代表（但会非常有用）。我猜他们花了更多时间来整理 Linq To XML 和 XML litterals 之类的东西，并在语法中集成更多查询运算符……

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-18T12:58:36.517

具有弹出窗口的 WPF 控件需要 WPF 应用程序对象的实例。在 WPF 应用程序中，这是自动创建的。在 WinForm 应用程序中不是这种情况。因此，必须手动创建此对象。应用程序还必须设置为保持打开状态，直到通过代码将其关闭，否则当 WinForm 应用程序确定不再需要它时，它将自动关闭。以下代码将在 WinForm 中打开 Application 对象并保持打开状态直到关闭。推荐的方法是在 WinForm 关闭时关闭 Application 对象。

```
 Dim app As System.Windows.Application = New System.Windows.Application With {
            .ShutdownMode = Windows.ShutdownMode.OnExplicitShutdown
        }
        AddHandler Closed, Sub()
                               app.Shutdown()
                           End Sub 
```

# php - 对于高流量 ajax 密集型网站，您有什么建议？

> ID：204802
> 
> 赞同：7
> 
> 时间：2008-10-15T13:57:23.360
> 
> 标签：php, python, lighttpd, cherrypy, high-load

对于像 reddit 这样的网站，每个主题都有很多赞成/反对票和很多评论，我应该怎么做？

Lighttpd/Php 还是 Lighttpd/CherryPy/Genshi/SQLAlchemy？

对于数据库，什么会更好/最快的 MySQL（4.1 或 5？）或 PostgreSQL？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-15T14:11:29.777

我无法回答 MySQL/PostgreSQL 问题，因为我对 Postgres 的经验有限，但我的硕士研究项目是关于使用 CherryPy 的高性能网站，我认为如果你使用 CherryPy 作为你的地点。它可以轻松扩展到商品硬件上的数千个同时用户。

当然，对于 PHP 也可以这样说，我不知道有任何合理的基准来比较 PHP 和 CherryPy 的性能。但是，如果您想知道 CherryPy 是否可以处理每秒大量请求的高流量站点，答案肯定是肯定的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-15T14:26:18.093

理想的设置将接近[此](http://www.igvita.com/2008/02/11/nginx-and-memcached-a-400-boost/)：

![缓存](https://www.igvita.com/posts/02-08/nginx-memcached.png)

简而言之，[nginx](http://wiki.codemongers.com/)是一个快速、轻量级的 webserver/front-proxy，它有一个独特的模块，可以让我们直接从[memcached](http://www.danga.com/memcached/)的 RAM 存储中获取数据，而无需访问磁盘或任何动态 webapp。当然，如果请求的 URL 还没有被缓存（或者如果它已经过期），请求会像往常一样继续到 webapp。天才之处在于，当 webapp 生成响应时，它的一个副本会转到 memcached，准备好被重用。

所有这一切不仅完全适用于网页，而且适用于 AJAX 查询/响应。

在文章中，'back' 服务器是 http，并专门讨论 mongrel。如果后面是 FastCGI 和其他（更快？）框架，那就更好了；但它的重要性要小得多，因为 nginx/memcached 团队承担了大部分负载。

请注意，如果您的 AJAX 流量的 url 方案设计良好（最好是 REST，恕我直言），您可以将大部分数据库放在 memcached 中，并且任何 POST（将传递给应用程序）都可以抢先更新缓存。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-15T16:31:15.377

在数据库问题上，我会说 PostgreSQL 比 MySQL 具有更好的扩展性和更好的数据完整性。对于小型站点，MySQL 可能会更快，但据我所知，随着数据库大小的增长，它会显着减慢。（*注意：我从未将 MySQL 用于大型数据库，因此您可能应该对它的可扩展性获得第二意见。*）但是 PostgreSQL 的扩展性肯定很好，并且对于高流量站点来说是一个不错的选择。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-15T14:11:42.053

将需要更多数据。Jeff 有几篇关于相同问题的文章，答案是等到遇到性能问题。

首先 - 谁在托管，他们有什么可用的？您的内部人才技能组合是什么？你打算聘请外部公司吗？他们推荐什么？带有愿意学习新框架的团队的全新项目？

第二件事是做一些模型——界面是如何工作的。它需要加载和持久化哪些数据？这个想法是保持网络和数据库之间的流量朝下。例如，没有大量查询的健谈页面。等等

一旦您对数据需求和流程有了更好的了解 - 然后进行数据库设计。有很多规则要遵循，但更好的规则之一是遵循规范化规则（是的，我是数据库专家，为什么？）

现在您已经构建了几个页面 - 运行您的测试。你有问题吗？是的，现在看看它是什么。页面服务或数据库拉动？衡量然后选择行动方案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-28T20:54:21.820

我会选择 nginx + php + xcache + postgresql

# .net - .net 在 IComparer 中使用哪种排序算法

> ID：204805
> 
> 赞同：7
> 
> 时间：2008-10-15T13:58:20.537
> 
> 标签：.net, algorithm, sorting

`IComparer`当我们在我们的类中实现时，有人知道.net 使用哪种排序算法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-15T14:00:40.810

[快速排序](http://en.wikipedia.org/wiki/QuickSort)似乎是它。

[IComparer](http://msdn.microsoft.com/en-us/library/system.collections.icomparer.aspx)上的文档说

> 此接口与[Array.Sort](http://msdn.microsoft.com/en-us/library/system.array.sort.aspx)和[Array.BinarySearch](http://msdn.microsoft.com/en-us/library/system.array.binarysearch.aspx)方法结合使用。

Array.Sort[文档](http://msdn.microsoft.com/en-us/library/aw9s5t8f.aspx)说

> 此方法使用快速排序算法。此实现执行不稳定的排序；也就是说，如果两个元素相等，则可能不会保留它们的顺序。相反，稳定排序保留了相等元素的顺序。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-11-08T08:29:35.607

当前的[文档](https://docs.microsoft.com/en-us/dotnet/api/system.array.sort?view=netframework-4.7.1)说它使用了一种**[Introsort](https://en.wikipedia.org/wiki/Introsort)**，一种混合​​排序算法：

是这样的：

1.  如果分区大小少于 16 个元素，则使用 **插入排序**算法

2.  如果分区数超过 2 * LogN，其中 N 是输入数组的范围，则使用**Heapsort**算法。

3.  否则，它使用**快速排序**算法。

    [来源这里](https://docs.microsoft.com/en-us/dotnet/api/system.array.sort?view=netframework-4.7.1)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-15T14:00:35.647

根据[MSDN](http://msdn.microsoft.com/en-us/library/aw9s5t8f%28VS.80%29.aspx)，.NET 使用 QuickSort。顺便说一句，该方法绝对不依赖于比较器（只要它是基于比较的），为什么.NET 应该根据您是否提供自定义比较器来使用不同的方法？

# .net - 有人可以解释在.Net 中使用主互操作程序集的好处吗？

> ID：204806
> 
> 赞同：13
> 
> 时间：2008-10-15T13:58:33.110
> 
> 标签：.net, interop, components

这个概念对我来说是新的，一位同事提出了这个建议。可悲的是，我不知道他在说什么。有人可以启发我吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-15T14:13:30.800

[你可以在这里](http://msdn.microsoft.com/en-us/library/aa302338.aspx)找到很多关于它的信息。

简而言之，PIA 是一个签名的互操作程序集，它提供来自 COM 库发布者的 COM 库中类型的“官方”定义。

至于好处，贴出的文章总结得很好：

> PIA 很重要，因为它们提供了唯一的类型标识。PIA 将官方类型定义与其他互操作程序集提供的伪造定义区分开来。具有单一类型标识可确保共享 PIA 中定义的类型的应用程序之间的类型兼容性。由于 PIA 由其发布者签名并标有 PrimaryInteropAssembly 属性，因此可以将其与定义相同类型的其他互操作程序集区分开来。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-15T14:27:56.607

主互操作程序集会将 COM 接口包装成 .NET 兼容类型。它没有像手动调用方法那样为您提供精细的控制，但它已经足够接近了。

没有 PIA：

```
object _comObject;
Type _comObjectType;
_comObjectType = Type.GetTypeFromProgID("MyCompany.MyApplication.MyObject", true);
_comObject = Activator.CreateInstance(_comObjectType);

string name = (string)_comObjectType.InvokeMember("GetCustomerName", BindingFlags.InvokeMethod, null, _comObject, , new object [] { _customerId }); 
```

使用 PIA：

```
MyCompany.MyApplication.MyObject obj = new MyObject();
string name = obj.GetCustomerName(_customerId); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-11T14:19:41.090

通过一个例子简单地说，如果你想开发一个应用程序类似于任何其他具有扩展功能的办公工具（MS word，visio ...），你可以使用 PIA 在你的项目中使用办公工具的功能。在我的类图中绘图应用程序，使用 visio 面板创建类图。

# .net - 可折叠侧面板控制

> ID：204807
> 
> 赞同：3
> 
> 时间：2008-10-15T13:58:36.073
> 
> 标签：.net, vb.net, winforms

我正在寻找一种在表单内创建或实现可折叠侧面板的方法。与 ToolStripContainer 的工作方式类似，除了使用可以填充控件的面板外，我想要相同的一般概念。有谁知道使用提供的 .Net 控件执行此操作的简单方法，或者这是一项完全自定义的工作。无论哪种方式，我都会很感激一些建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T05:14:14.210

这里有一个代码示例：http: [//www.codeproject.com/Articles/8220/Collapsible-Panels-in-VB-NET](http://www.codeproject.com/Articles/8220/Collapsible-Panels-in-VB-NET)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T19:53:58.953

试试这个，它在 c# 中，但我相信它可以很容易地翻译

启动一个新项目并添加一个面板。将该面板停靠在表单的左侧。将按钮添加到面板将其停靠在右侧将按钮文本设置为“<”并将宽度设置为 20。在 button1_Click 事件中添加此

```
 private void button1_Click(object sender, EventArgs e)
    {
        if (button1.Text == ">")
        {
            panel1.Width = 200;
            button1.Text = "<";
        }
        else
        {
            panel1.Width = button1.Width;
            button1.Text = ">";
        }
    } 
```

这里发生的情况是，当单击按钮时，表单向左缩小，只留下按钮可见。再次单击该按钮时，它会向后展开。

# javascript - 在 JavaScript 块上使用 HTML 注释仍然有意义吗？

> ID：204813
> 
> 赞同：68
> 
> 时间：2008-10-15T14:02:34.380
> 
> 标签：javascript, html

过去，人们习惯于将 HTML 注释标签包裹在 JavaScript 块周围，以防止“旧”浏览器显示脚本。连 Lynx 都聪明到可以忽略 JavaScript，那么为什么有些人继续这样做呢？这些天有什么正当理由吗？

```
<script type="text/javascript">
<!--
//some js code
//-->
</script> 
```

编辑：我确实遇到过一种情况。某些代码编辑器（例如 Dreamweaver）在“设计视图”中会被 JavaScript 字符串中引用的 HTML 弄糊涂，并尝试将其显示为页面的一部分。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2008-10-15T14:05:04.063

不，绝对不是。如今，任何用户代理、搜索引擎蜘蛛或绝对其他任何东西都足够聪明，可以在无法执行 Javascript 时忽略它。

只有一个非常短暂的时期，这完全有帮助，那是在 1996 年左右。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-10-15T14:20:32.503

没有充分的理由再这样做了，因为需要这样做的浏览器基本上已经从网络上消失了。

事实上，这样做实际上会导致某些旧浏览器尝试解释使用 XHTML 的页面时出现意外问题 - 来自[developer.mozilla.org](http://developer.mozilla.org/en/Properly_Using_CSS_and_JavaScript_in_XHTML_Documents#Use_of_Comments_Inside_Inline_style_and_script)：

> *   Mozilla 1.1+/Opera 7
>     
>     
>     
>     不要应用 CSS 或执行 JavaScript。
>     
>     
> *   网景 7.0x/Mozilla 1.0.x
>     
>     
>     
>     不要应用 CSS，但会执行 JavaScript。
>     
>     
> *   互联网浏览器 5.5+
>     
>     
>     
>     无法显示文档。

该站点还链接到上述[几个](http://developer.mozilla.org/en/Properly_Using_CSS_and_JavaScript_in_XHTML_Documents/Examples#Problem_2) [问题](http://developer.mozilla.org/en/Properly_Using_CSS_and_JavaScript_in_XHTML_Documents/Examples#Problem_3)的示例。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-10-16T08:12:13.777

你应该使用 CDATA 虽然......

```
<script type="text/javascript" charset="utf-8">
/* <![CDATA[ */

/* ]]> */
</script> 
```

因为如果您的代码中有 '<'、'>'、'&' 等，则代码将无法验证 :)

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-03-24T14:48:58.263

见鬼，没有人需要这个了，如果你这样做了，你还有更多的问题需要关心。当你真的想支持需要它的浏览器时，你必须注意更多的事情。甚至没有谈论缺乏css！

然而，更大的问题是，人们做错了。实际上你的例子是错误的，因为这条线

```
--> 
```

应该读

```
//--> 
```

其次，你输入属性说“text/JavaScript”也有什么问题。它一直是“text/javascript”（全部小写），但它已经过时（参见[IANA List](http://www.iana.org/assignments/media-types/text/)），现在应该是“application/javascript”（参见[另一个 IANA List](http://www.iana.org/assignments/media-types/application/)。但是，JS 大师 Douglas Crockford 说你只是应该把它排除在外。

另一个没有人提到的问题是：在 HTML 注释中，不允许使用“--”，这意味着您不能使用“x--”将 x 减一。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-30T20:50:49.363

不必使用 CDATA 块是我更喜欢使用 HTML 4.01 Strict 作为我的文档类型的原因之一，但是，Saicu，我认为它使用了以下语法：

```
<script charset="utf-8">
//<![CDATA[

//]]>
</script> 
```

也许两者是等价的？有谁知道一个比另一个有优势吗？

# c# - 是否有任何正当理由忽略捕获的异常

> ID：204814
> 
> 赞同：51
> 
> 时间：2008-10-15T14:02:40.120
> 
> 标签：c#, exception

哇，我刚从外包开发人员那里拿回了一个巨大的 C# 项目，在进行代码审查时，我的分析工具发现了一堆它认为不好的东西。更令人沮丧的消息之一是：

```
Exceptions.DontSwallowErrorsCatchingNonspecificExceptionsRule  : 2106 defects 
```

开发人员向我保证，他们有充分的理由使用所有空的 catch 块，有时使用空的 catch 块进行尝试只是为了忽略无用的异常并防止应用程序崩溃。我觉得这是一个警察和完整的BS。我实际查找的一些示例是数据库调用，其中记录被保存到数据库中，在这种情况下，如果忽略异常，用户会得到一个好的提示，认为一切正常，然后继续他们的工作。实际上，他们的工作从未保存过。我认为这绝对是最可怕的错误。在这种情况下，他们在尝试使用空的 catch 块时抛出该代码是完全错误的。但我的问题是，“这在任何情况下都可以接受吗？” 我认为不是，但我知道我错了。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-10-15T14:15:21.640

虽然有一些合理的理由可以忽略例外情况；但是，通常只有特定的例外情况可以安全地忽略。正如[Konrad Rudolph](https://stackoverflow.com/questions/204814/is-there-any-valid-reason-to-ever-ignore-a-caught-exception#204827)所指出的，作为框架的一部分，您可能必须捕获并吞下错误；正如[osp70](https://stackoverflow.com/questions/204814/is-there-any-valid-reason-to-ever-ignore-a-caught-exception#204873)所指出的，您知道可以忽略的框架可能会生成一个异常。

但是，在这两种情况下，您可能都知道异常类型，如果您知道类型，那么您应该有类似于以下的代码：

```
try {
  // Do something that might generate an exception
} catch (System.InvalidCastException ex) {
  // This exception is safe to ignore due to...
} catch (System.Exception ex) {
  // Exception handling
} 
```

对于您的应用程序，听起来在某些情况下可能会出现类似的情况；但是您给出的数据库保存示例即使出现异常也返回“OK”并不是一个很好的迹象。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-15T14:06:28.537

除非我打算对它们做点什么，否则我不会捕获异常。忽略它们并没有对它们做任何事情。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-15T14:05:09.790

我有时会使用对页面显示不是强制性的 WebControl。如果失败，我不想阻止页面显示。非关键 WebControl 的一个示例是显示广告的 WebControl。

但是，我确实记录了错误。我只是不重新扔它。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-10-15T14:18:32.273

我的感觉是任何空的 Catch Block 都需要评论。

忽略某些错误可能是有效的，但您需要记录您的原因。

此外，您不希望将其设为通用的“catch (Exception e) { }”。

您应该只捕获那里预期的并且已知可以安全忽略的特定错误类型。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-15T14:17:49.700

通常没有，实际上在 99% 的情况下都没有，但是

也有例外。我参与的一个项目是使用第三方库来处理 TWAIN 设备。它有问题，在某些硬件组合下会引发空指针错误。然而，我们从来没有发现任何情况下它实际上并没有在它之前扫描文档 - 所以捕获异常是完全合理的。

所以我认为如果是你的代码抛出了异常，那么你应该总是检查它，但是如果你被第三方代码卡住了，那么在某些情况下你可能会被迫吃掉异常并继续前进。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-10-15T14:51:26.717

另一种可以原谅捕获和忽略异常的情况是在进行单元测试时。

```
public void testSomething(){
    try{
        fooThatThrowsAnException(parameterThatCausesTheException);
        fail("The method didn't throw the exception that we expected it to");
    } catch(SomeException e){
        // do nothing, as we would expect this to happen, if the code works OK.
    }
} 
```

请注意，即使 catch 块什么都不做，它也解释了原因。

话虽如此，最近的测试框架（Junit4 和 TestNG）允许您指定预期的异常 - 这会导致类似这样的事情......

```
@Test(expected = SomeException.class)
public void testSomething(){
    fooThatThrowsAnException(parameterThatCausesTheException);
    fail("The method didn't throw the exception that we expected it to");
} 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-10-15T15:26:15.630

我想从我收集到的最好的答案是它在某种程度上可以接受，但应该受到限制。您应该尝试使用另一种替代方法，如果找不到另一种替代方法，您应该对代码的工作方式有足够的了解，以便您可以预期特定的异常类型，而不仅仅是使用一揽子捕获所有“异常”。忽略此异常的原因的文档应以可理解的注释形式包含。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-10-15T14:07:29.160

在关键代码中，可能不是，因为程序的状态必须始终准确定义。就像您的数据库调用示例一样。

当然，在非关键代码中，我们也这样做（我们只是在消息框中显示捕获的异常并继续运行）。可能是插件或模块出现故障，但主程序不受影响。可能 lexical_cast 失败并且屏幕上出现了文本故障。无需停止该过程。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-10-15T14:12:15.140

我认为这是可接受的一个例子是在关键应用程序的一些非关键模块中（例如，在航天飞机导航系统的声音反馈模块中），对于不应该发生的异常，并且不能更干净地处理.

在这些情况下，您不会希望让该异常传播并导致整个应用程序失败（对不起，没有更多的导航系统，我们的哔哔声模块崩溃了，我们真的无能为力）。

编辑说在任何这些情况下，您至少希望在某处记录事件。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2008-10-15T14:16:46.350

我认为如果你有一个空的 catch 块，你需要记录它为什么是空的，以便下一个开发人员知道。例如，在 server.transfer 上，有时会引发 Web 异常。我抓住了这一点并评论说我们可以忽略它，因为转移电话。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2008-10-15T18:37:17.790

在某些情况下，捕获特定异常并且什么都不做是可以的。这是一个简单的例子：

```
 public FileStream OpenFile(string path)
    {
        FileStream f = null;
        try
        {
            f = new FileStream(path, FileMode.Open, FileAccess.ReadWrite);
        }
        catch (FileNotFoundException)
        {
        }
        return f;
    } 
```

你也可以这样写方法：

```
 public FileStream OpenFile(string path)
    {
        FileStream f = null;
        FileInfo fi = new FileInfo(path);
        if (fi.Exists)
        {
            f = new FileStream(path, FileMode.Open, FileAccess.ReadWrite);                
        }
        return f;
    } 
```

在这种情况下，捕获异常（非常）稍微安全一些，因为文件可能会在您检查它是否存在和打开它之间被删除。

当然，有理由*不*这样做。在 .NET 中，异常的计算量很大，因此您要避免引发大量异常的任何事情。（在 Python 中，异常很便宜，使用异常来执行诸如跳出循环之类的事情是一种常见的习惯用法。）

但这忽略了一个*特定*的例外。这段代码：

```
catch
{
} 
```

是不可原谅的。

没有充分的理由不捕获`try`块中的代码将抛出的特定类型异常。天真的开发人员给出的第一个原因是不管类型如何都捕获异常，“但我不知道可能会抛出什么类型的异常”，这就是对这个问题的回答。

如果你不知道什么类型的异常可能会被抛出，你就不知道你的代码是如何失败的。如果你不知道你的代码是如何失败的，那么你就没有理由假设如果失败了就继续处理是可以的。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-10-15T14:08:57.567

是的，根据 Maxim 的帖子，在某些情况下它是可以接受的（不可避免的，必要的）。这并不意味着你必须喜欢它。2106 违规可能太多了，至少他们应该在 catch 块中添加一个注释，说明为什么可以吞下这个异常。

@Dustin 向公共用户显示任何异常详细信息（堆栈跟踪、行号等）是一种不好的做法。您可能应该记录异常并显示一般错误。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2008-10-15T14:26:02.320

说到异常，*总会有异常*。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-10-15T14:05:15.967

这取决于框架。实施不当的框架实际上可能需要这样做。我记得 VB6 中的一个 hack，无法确定集合是否包含元素。唯一的方法是尝试检索元素并吞下错误。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-10-15T17:48:28.667

我认为最初的问题已经得到很好的回答，但我想补充的一件事是，如果您认为这些外包/合同开发人员的工作质量很差，您应该确保您公司的合适人员知道这一点。

可能有可能将其送回返工，部分付款可能会被扣留，或者同一家公司将不再被使用。如果您的公司再次使用承包商，他们可能会找到一种将质量要求纳入协议的方法，假设这还没有。

如果这是内部工作，则会对产生不合格工作的团队/个人产生影响。也许这只是意味着他们必须在晚上和周末工作来修复它，但他们会以这样或那样的方式陷入困境。这同样适用于承包商，甚至可能更是如此。

请注意专业地解释您的职位，并专注于对公司/产品最有利的事情。你不希望它看起来像你只是在抱怨，或者你对外包有某种政治上的反对。不要拿你做事。考虑成本、上市时间、客户满意度等。你知道，所有这些都是管理类型关心的事情。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-10-15T18:34:54.237

我很想知道这个特定的。

```
Connection con = DriverManager.getConnection(url, "***", "***");

try {
    PreparedStatement pStmt = con.prepareStatement("your query here");

    ... // query the database and get the results
}
catch(ClassNotFoundException cnfe) {
    // real exception handling goes here
}
catch(SQLException sqle) {
    // real exception handling goes here
}
finally {
    try {
        con.close();
    }
    catch {
        // What do you do here?
    }
} 
```

我永远不知道在 finally 块中的最后一个 catch 中该做什么。我以前从未见过 close() 抛出异常，而且我不太可能不担心它。我只是记录异常并继续。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-10-16T05:38:19.857

除非您的捕获代码将

1.  记录异常
2.  将异常重新打包成另一个匹配相同抽象的异常。并再次抛出
3.  *以您认为合适的方式*处理异常

 *您可以忽略该异常，但至少在方法文档中提及预期的异常，以便消费者可以在必要时进行预期和处理

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-10-16T09:26:43.140

举一个 Java 世界中可以忽略异常的例子：

```
String foo="foobar";
byte[] foobytes;

try
{
    foobytes=foo.getBytes("UTF-8");
}
catch (UnsupportedEncodingException uee)
{
    // This is guaranteed by the Java Language Specification not to occur, 
    // since every Java implementation is required to support UTF-8.
} 
```

也就是说，即使在这种情况下，我也会经常使用

```
...
catch (UnsupportedEncodingException uee)
{
    // This is guaranteed by the Java Language Specification not to occur, 
    // since every Java implementation is required to support UTF-8.
    uee.printStackTrace();
} 
```

如果虚拟机要疯狂/破坏规范，我对此无能为力，但是通过堆栈跟踪，我至少可以注意到它何时开始陷入疯狂......

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-10-15T14:13:21.753

这是一件非常糟糕的事情。

虽然有*正当的*理由你可能想要忽略异常——如果它以某种方式被预期，并且没有必要对此做任何事情——但是这样做 2000 次似乎他们只是想把他们的异常扫到地毯下。

可以吞下异常的示例可能是探测事物……您向某些设备或模块发送消息，但您不在乎它是否真的到达那里。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-10-15T15:09:07.663

以下仅适用于已检查异常的语言，例如 Java：

*有时，一个方法会抛出一个您知道*不会发生的已检查异常，例如，一些 java API 期望编码名称为字符串，如果不支持给定的编码，则抛出 UnsupportedEncodingException。但通常我会传递一个我知道支持的文字“UTF-8”，所以理论上我可以在那里写一个空的捕获。

我通常不这样做（空捕获），而是抛出一个包含“不可能”异常的通用未经检查的异常，或者我什至声明一个我抛出的类 ImpossibleException。因为我关于错误条件不可能的理论可能是错误的，在这种情况下，我不希望异常被吞下。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-10-15T16:22:35.267

我喜欢让几乎所有我的异常都冒泡到一个应用程序处理程序，在那里它们被记录下来，并向最终用户显示一条通用错误消息。但这里需要注意的是，实际发生的异常不应该太多。如果您的应用程序抛出了许多异常，那么可能是有问题或者本可以更好地编码的东西。在大多数情况下，我会尝试确保我的代码提前检查异常情况，因为生成异常的成本很高。

顺便说一句，外包编码通常是一个坏主意。根据我的经验，通常他们是顾问，只是为了薪水而与项目的成功无关。此外，您向他们的 - 缺乏 - 编码标准投降（除非您将其包含在合同中）。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2008-10-15T18:46:19.317

这样想 - 如果您花费 CPU 周期来捕获异常但随后吞下，那么您忽略了一个潜在的问题并浪费了 CPU。正如许多人所说，应用程序不应该抛出那么多异常，除非你有一些糟糕的构造。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-12-10T21:15:22.547

我们有一个应用程序代表其他应用程序进行大量处理，您将一些作业（配置集合）插入数据库，应用程序将在适当的时间获取并运行它。我们倾向于吞下该应用程序中的许多异常，因为即使 Job1 以一种可怕的方式因灾难性错误而死，我们也希望该应用程序保持活力以尝试处理 Job2。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-10-15T14:40:12.650

我认为最好的经验法则是仅在您完全了解异常的含义及其可能的后果时才忽略异常。对于某些不会影响系统其余部分的隔离模块，我认为只要您知道其他任何事情都没有发生任何不好的事情，就可以捕获通用异常。

IMO 更容易了解 Java 中的后果，因为每个方法都需要声明它可以抛出的所有异常，以便您知道会发生什么，但是在 C# 中，即使没有记录也可以抛出异常，因此很难知道所有方法可能引发的异常，并且缺乏这些知识，捕获所有异常通常是一个坏主意。

# version-control - 如何比较两个源树在 win32 上的差异/变化？

> ID：204818
> 
> 赞同：0
> 
> 时间：2008-10-15T14:03:28.310
> 
> 标签：version-control

有两个带有源代码树的目录。什么是揭示它们变化的最佳软件。不仅应该是文件名，还应该是一些文件比较查看器。如果它是免费工具可能会更好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-15T14:17:15.457

[WinMerge](http://www.winmerge.org/)，虽然不完全符合 Beyond Compare 的要求，但它很接近并且是开源的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T14:09:25.897

超越比较[http://www.scootersoftware.com/](http://www.scootersoftware.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T14:05:26.387

我使用[windiff](http://www.grigsoft.com/download-windiff.htm)进行快速检查。它不是非常复杂，但它可以完成工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T14:09:52.570

Beyond Compare - 付费但物有所值。

# c - 自动发现 C 依赖项

> ID：204823
> 
> 赞同：12
> 
> 时间：2008-10-15T14:04:54.860
> 
> 标签：c, include, dependencies

我需要为我当前的项目编写文档，其中列出了所有 .c 文件，并且每个文件都列出了该文件直接或间接包含的每个 .h 文件。

这是一个大项目，虽然我们有 Makefiles 理论上有这些信息，但这些 Makefiles 有时是不正确的（我们从另一家公司继承了这个项目）。我们经常不得不做一些`make clean ; make`更改才能真正反映在重新编译中，所以我不想依赖这些 Makefile。

那么有没有一种工具可以让我们给它一个 .c 文件的名称和一个包含路径，并让它告诉我们所有直接或间接包含在 .c 文件中的 .h 文件？我们没有任何奇怪的东西

```
#define my_include "some_file.h"
#include my_include 
```

所以这个工具不需要是完美的。在常规包含的包含路径中搜索 .c 和 .h 文件的任何内容都足够了。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-15T14:28:21.753

我在 Makefile 中所做的是

```
SRCS=$(wildcard *.c)

depend: $(SRCS)
    gcc -M $(CFLAGS) $(SRCS) >depend

include depend 
```

这意味着如果任何源文件被更新，depend 规则将运行，并使用 gcc -M 来更新名为depend 的文件。然后将其包含在生成文件中，以提供所有源文件的依赖规则。

Make 将在包含文件之前检查文件是否是最新的，因此只要您运行 make 而无需执行“make depend”，此依赖规则就会在必要时运行。

这将在任何文件发生更改时运行。我从来没有发现这是一个问题，但是如果您在目录中有大量文件，您可能会发现花费的时间太长，在这种情况下，您可以尝试为每个源文件设置一个依赖文件，如下所示：

```
SRCS=$(wildcard *.c)
DEPS=$(SRCS:.c=.dep)

%.dep : %.c
    gcc -M $(CFLAGS) $< >$@

include $(DEPS) 
```

请注意，您可以使用 -MM 而不是 -M 来不包含系统标头。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-15T14:20:15.657

“gcc -M file.c” 可以满足您的需要。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-17T11:08:52.997

gcc -M 的替代方法是[fastdep](https://fastdep.louislivi.com/#/en/)。Fastdep 的作者报告说 fastdep 比 gcc 的 -M 快十倍。如果项目需要一段时间来构建，fastdep 可能值得一看。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-28T18:35:31.413

使用 SCons

```
$ scons --tree=all
scons: Reading SConscript files ...

scons: done reading SConscript files.
scons: Building targets ...
scons: `.' is up to date.
+-.
  +-SConstruct
  +-app
  | +-test.o
  | | +-test.c
  | | +-/include/PCI_1149_1.h
  | | +-/include/Pci.h
  | | +-/usr/bin/gcc
  | +-/usr/bin/gcc
  | +-/lib/libpci1149_64.a
  ... 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-15T14:33:26.563

在 MSVC（至少 2005 和 2008，可能还有其他版本，但不是 VC6）中，您可以让编译器告诉您编译期间包含的所有文件。输出非常冗长，但完整且相当容易用人眼解析。

在 Project Settings 中，转到 C/C++>Advanced 选项卡，然后切换“Show Includes”，然后从头开始重建您的项目。

# python - 捕获正则表达式的内容并有效地删除它们

> ID：204829
> 
> 赞同：7
> 
> 时间：2008-10-15T14:05:55.917
> 
> 标签：python, regex

情况：

*   文本：一个字符串
*   R：匹配部分字符串的正则表达式。计算起来可能很昂贵。

我想从文本中删除 R 匹配项，并查看它们实际包含的内容。目前，我这样做：

```
import re
ab_re = re.compile("[ab]")
text="abcdedfe falijbijie bbbb laifsjelifjl"
ab_re.findall(text)
# ['a', 'b', 'a', 'b', 'b', 'b', 'b', 'b', 'a']
ab_re.sub('',text)
# 'cdedfe flijijie  lifsjelifjl' 
```

据我所知，这会运行两次正则表达式。是否有一种技术可以在通过时完成所有操作，也许使用 re.split？似乎对于基于拆分的解决方案，我还需要至少两次执行正则表达式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T14:41:51.273

```
import re

r = re.compile("[ab]")
text = "abcdedfe falijbijie bbbb laifsjelifjl"

matches = []
replaced = []
pos = 0
for m in r.finditer(text):
    matches.append(m.group(0))
    replaced.append(text[pos:m.start()])
    pos = m.end()
replaced.append(text[pos:])

print matches
print ''.join(replaced) 
```

输出：

```
['a', 'b', 'a', 'b', 'b', 'b', 'b', 'b', 'a']
cdedfe flijijie  lifsjelifjl 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-15T15:05:21.210

那这个呢：

```
import re

text = "abcdedfe falijbijie bbbb laifsjelifjl"
matches = []

ab_re = re.compile( "[ab]" )

def verboseTest( m ):
    matches.append( m.group(0) )
    return ''

textWithoutMatches = ab_re.sub( verboseTest, text )

print matches
# ['a', 'b', 'a', 'b', 'b', 'b', 'b', 'b', 'a']
print textWithoutMatches
# cdedfe flijijie  lifsjelifjl 
```

**re.sub**函数的 'repl' 参数可以是一个函数，因此您可以从那里报告或保存匹配项，并且无论函数返回什么都是 'sub' 将替代的。

该功能也可以轻松修改以执行更多操作！查看docs.python.org 上[的 re 模块文档](http://docs.python.org/library/re.html#module-contents)，了解有关其他可能性的更多信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-15T15:00:40.970

我修改后的答案，使用**re.split()**，它在一个正则表达式传递中完成：

```
import re
text="abcdedfe falijbijie bbbb laifsjelifjl"
ab_re = re.compile("([ab])")
tokens = ab_re.split(text)
non_matches = tokens[0::2]
matches = tokens[1::2] 
```

（编辑：这是一个完整的功能版本）

```
def split_matches(text,compiled_re):
    ''' given  a compiled re, split a text 
    into matching and nonmatching sections
    returns m, n_m, two lists
    '''
    tokens = compiled_re.split(text)
    matches = tokens[1::2]
    non_matches = tokens[0::2]
    return matches,non_matches

m,nm = split_matches(text,ab_re)
''.join(nm) # equivalent to ab_re.sub('',text) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T14:36:18.680

您可以将 split 与捕获括号一起使用。如果这样做，那么模式中所有组的文本也会作为结果列表的一部分返回（来自[python doc](http://www.python.org/doc/2.5.2/lib/node46.html)）。

所以代码是

```
import re
ab_re = re.compile("([ab])")
text="abcdedfe falijbijie bbbb laifsjelifjl"
matches = ab_re.split(text)
# matches = ['', 'a', '', 'b', 'cdedfe f', 'a', 'lij', 'b', 'ijie ', 'b', '', 'b', '', 'b', '', 'b', ' l', 'a', 'ifsjelifjl']

# now extract the matches
Rmatches = []
remaining = []
for i in range(1, len(matches), 2):
    Rmatches.append(matches[i])
# Rmatches = ['a', 'b', 'a', 'b', 'b', 'b', 'b', 'b', 'a']

for i in range(0, len(matches), 2):
    remaining.append(matches[i])
remainingtext = ''.join(remaining)
# remainingtext = 'cdedfe flijijie  lifsjelifjl' 
```

# web-applications - 如何在不安装的情况下尝试新的语言或框架？

> ID：204831
> 
> 赞同：26
> 
> 时间：2008-10-15T14:06:12.237
> 
> 标签：web-applications, sandbox

存在如此多的语言和框架，并且不断出现新的语言和框架，我没有时间下载、安装和配置每一个来评估它。过去，我遇到过允许将代码写入或粘贴到窗口中并在浏览器中实时查看结果的 web 应用程序，通常是在教程设置中。

对于给定的技术，您最喜欢哪些沙盒站点？

**编辑：** @fretj 提供了优秀的[Google Code Playground](http://code.google.com/apis/ajax/playground/)的链接（+1 点赞），但我认为这只是为了试验 Google 自己的应用程序（搜索、地图、地球、语言等）。但事实证明，它包含一些隐藏的宝石：除了他们的应用程序之外，您还可以尝试他们托管的许多 Javascript 库，包括[jQuery](http://code.google.com/apis/ajax/playground/#jquery)、[jQuery UI](http://code.google.com/apis/ajax/playground/#jqueryui)、[MooTools](http://code.google.com/apis/ajax/playground/#mootools)、[Dojo](http://code.google.com/apis/ajax/playground/#dojo)和[Prototype Scriptaculous](http://code.google.com/apis/ajax/playground/#prototype_scriptaculous)。

它们都隐藏在“Pick an API”框中的“库”类别下。我忽略了这个类别，因为我认为它是用于一个名为 Google Libraries 的应用程序。Javascript 本身也有一个 Javascript 类别。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-15T14:07:54.400

[W3Schools.com](http://www.w3schools.com/)在其教程的许多课程中都包含迷你沙盒。每个示例都用于说明该特定课程，但您可以添加或更改代码以将其用作沙箱。有 Javascript、DOM 脚本、Ajax、SQL、ADO、ASP 和 ASP.NET 的示例。

[JS Bin](http://jsbin.com)是一个用于 Javascript 和 CSS 测试的沙箱，内置支持许多脚本库，包括 jQuery、script.aculo.us、YUI、MooTools 和 dojo。因此，您无需下载和安装每个库即可试用示例代码。此外，它还允许您使用唯一的 URL（如 pastebin）保存您的代码片段，并允许对每个片段进行协作编辑。

[Codepen](http://codepen.io/)是一个面向前端开发人员的协作沙箱，专注于 HTML、CSS 和 JS。您可以自定义界面的许多方面，包括您想要包含的 JS 库、几个 CSS 功能（例如添加 reset.css）以及 Emmet 和 Vim 键绑定等其他奖励。

~~[Try Ruby](http://tryruby.hobix.com/)是一个非常基础的交互式教程，它向完全的新手介绍 Ruby。它以连续方式完成，因此您必须一口气从头到尾完成，但这不会花费很长时间。~~[Try Ruby 于 8 月 19 日被其所有者[_why 删除](http://en.wikipedia.org/wiki/Why_the_lucky_stiff)。很多人希望他的内容能够回归。为什么（尖锐的）Ruby 指南有[HTML](http://mislav.uniqpath.com/poignant-guide/)和[PDF](http://www.ember.co.nz/resources/whys-poignant-guide-to-ruby/)镜像。]

[OpenSourceCMS](http://www.opensourcecms.com/)包含数十个开源软件包，允许您试用最流行的门户、博客、图片库和论坛的前端和管理后端功能。您拥有完整的管理员权限，可以更改每个包上的任何内容，然后从用户的角度查看这些更改的结果。

[JSONLint](http://www.jsonlint.com/)是一个在线 JSON 验证器，其语法检查并不过分复杂，但可以像宣传的那样工作。

对于正则表达式，请尝试使用 Ruby构建的[Rubular 、使用 Javascript 构建的](http://www.rubular.com/)[RegExPal](http://regexpal.com/)或[RegExr](http://gskinner.com/RegExr/)，这对正则表达式初学者非常有帮助，因为它内置了代码感知。

[Codepad](http://codepad.org/)是一个带有扭曲的 pastebin：它内置了一个解释器/编译器，支持 13 种语言，包括 C、C++、Haskell、Scheme、Python 和 PHP。因此，您不仅可以使用它来共享代码，还可以在您离开编程环境时运行或测试代码（想想无聊但强制性的会议或公共交通上的长途通勤等）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-05T07:51:40.370

不确定它是否完全符合这个问题，但这是我最近发现的一个不错的游乐场：

[Google AJAX API 游乐场](http://code.google.com/apis/ajax/playground/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T07:14:51.973

Lua在其网站上有一个[Live 演示。](http://www.lua.org/cgi-bin/demo "现场演示")还展示沙盒技术...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T16:40:19.927

eXist-db 有一个[沙箱](http://demo.exist-db.org/sandbox/sandbox.xql)，对于使用 XQuery/XPath 非常有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T20:48:02.407

您还可以尝试将[Heroku](http://heroku.com/features)用于 Ruby on Rails，并将[AppJet](http://appjet.com)用于服务器端 JavaScript。

有点离题，但我强烈推荐开发“Try Ruby”网站的同一个人的“Why's Poignant Guide to Ruby”——你不会相信在卡通的帮助下学习 Ruby 是多么快速和容易！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-16T18:43:53.790

您可以使用[Wonderfl](http://wonderfl.net/)编译和沙箱 Flash/Actionscript/等。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-12-09T04:49:18.427

这是一个老问题，但我发现[repl.it](http://repl.it/)非常有用。许多不同的语言。我的一个抱怨是包含/导入某些库不能很好地工作。例如，您不能在 repl.it (python) 中运行它

```
from time import sleep
print "We are going to sleep for 5 seconds."
sleep(5)
print "Now we will sleep for 3 seconds."
sleep(3) 
```

# t4 - T4（微软的文本模板框架）有什么好的资源吗？

> ID：204836
> 
> 赞同：3
> 
> 时间：2008-10-15T14:06:54.043
> 
> 标签：t4

什么都会好的。示例、最佳实践、示例等

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T14:08:41.670

Hanselman 昨天刚刚在博客上发表了这篇文章，他有一个巨大的链接列表：

[http://www.hanselman.com/blog/T4TextTemplateTransformationToolkitCodeGenerationBestKeptVisualStudioSecret.aspx](http://www.hanselman.com/blog/T4TextTemplateTransformationToolkitCodeGenerationBestKeptVisualStudioSecret.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T14:24:37.800

Hanselman 发布了指向此的链接，但以防万一：Rob Conery 最近也发表了有关此的博客，并且像往常一样，它非常棒： [http ://blog.wekeroad.com/blog/make-visual-studio-generate-your-repository /](http://blog.wekeroad.com/blog/make-visual-studio-generate-your-repository/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T14:51:01.443

为了我的钱，可以在[http://www.olegsych.com/上找到有关 T4 的优质信息的权威来源](http://www.olegsych.com/)

从这里开始-> [http://www.olegsych.com/2007/12/text-template-transformation-toolkit/](http://www.olegsych.com/2007/12/text-template-transformation-toolkit/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T14:18:36.173

我发现[Clarius 的 T4 编辑器](http://www.t4editor.net/)真的很有帮助。它将 T4 的语法突出显示、IntelliSense 和项目项添加到 Visual Studio。网站上也有演示视频。有一个免费的社区版和一个增强的、非免费的版本，它也进行 C# 语法突出显示。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-23T16:05:36.117

还要确保查看复数视觉提供的[“T4 模板”课程](http://pluralsight.com/training/courses/TableOfContents?courseName=t4-templates)。它涵盖以下主题：

*   T4简介
*   T4 积木
*   加长 T4
*   现实世界的例子
*   故障排除和调试

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-02T09:47:26.640

似乎还有另一个[由 Tangible 提供的 T4 编辑器，](http://t4-editor.tangible-engineering.com/Download_T4Editor_Plus_ModelingTools.html)它似乎不仅仅是一个 T4 编辑器，还包括一些建模工具。

# asp.net - ASP.Net 中的请求之间是否重用了线程？

> ID：204840
> 
> 赞同：7
> 
> 时间：2008-10-15T14:08:15.413
> 
> 标签：asp.net, multithreading

我只是想知道每个会话是否使用相同的线程，或者在请求之间依靠特定线程是否危险。我得到的是，我可以使用线程静态存储吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-15T14:08:46.240

简短的回答是肯定的。用于请求的线程将返回到线程池，并可用于为其他请求提供服务。它们不是特定于会话的，要回答您的第二个问题，您永远不应指望特定线程可用于特定会话的后续请求。因此，在 ASP.Net 中使用线程静态变量是一个非常糟糕的主意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T14:15:21.407

> 我得到的是，我可以使用线程静态存储吗？

否。请改用应用程序/缓存或会话存储。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T09:57:07.687

> 我得到的是，我可以使用线程静态存储吗？

或者，如果您只希望数据在单个请求的生命周期内保留，您可以将其存储在 HttpContext.Current.Items

# c++ - 在哪里可以查看 C++ 标准

> ID：204841
> 
> 赞同：15
> 
> 时间：2008-10-15T14:08:17.147
> 
> 标签：c++, stl

> **可能重复：**
> [在哪里可以找到当前的 C 或 C++ 标准文档？](https://stackoverflow.com/questions/81656/where-do-i-find-the-current-c-or-c-standard-documents)

我想在我正在处理的当前程序中使用 STL，而供应商不支持我认为合理的 STL，工作不是我认为合理的。我一直找不到一个 C++ 标准或 STL 标准，而不仅仅是一个 API，这让我想知道我的解释是否正确，或者供应商的解释是否正确。[我已经在SGI 的网站上](http://www.sgi.com/tech/stl/table_of_contents.html)花费了很多时间。有什么推荐吗？此外，是否有任何不是 API 的文档被视为标准？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-15T14:20:42.613

当前 C++0x 标准的草案可从此[页面](http://www.research.att.com/~bs/C++.html)获得，C++ 标准委员会的官方主页在[此处](http://www.open-std.org/jtc1/sc22/wg21/)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-15T14:09:37.877

该标准以 PDF 格式提供给 ANSI.org。（我上次检查时 18 美元，可下载）。18 美元的可下载 PDF 被认为是一项突破，因为以前 ANSI 只以硬拷贝形式出售它的标准，一份几千美元。（通常，ANSI 标准的市场非常有限——只有摩托车头盔制造商才会购买摩托车头盔等的 ANSI 标准），标准销售是 ANSI 为其运营提供资金的主要方式。

ISO 中的每个国家标准机构都可以在他们认为合适的时候提供该标准。有人告诉我，英国标准公司已经达成协议以书本的形式出版它，但我不知道它是否真的发生过。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-15T14:35:52.520

有关从何处获取当前标准文件的信息：

[在哪里可以找到当前的 C 或 C++ 标准文档？](https://stackoverflow.com/questions/81656/where-do-i-find-the-current-x-standard#83763)

该问题中的其他回答有关于可以免费获得的各种标准草案的下载信息（实际批准的标准不能免费获得）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T14:22:32.250

我搜索了“C++ ansi 标准”并点击了第一个结果

> 互联网上有什么是免费的？
> 
> C++ 标准通过了两个委员会草案 (CD)，可供公众查看和评论。公众意见征询期后对第二张 CD 所做的更改提交给成员机构进行投票，并成为官方标准。C++ 标准的 CD2 与最终标准非常相似，但并不完全相同。

[草案正文](ftp://ftp.research.att.com/dist/c++std/WP/CD2/body.pdf)（参见目录列表等目录）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T10:52:56.167

如果您对树件感兴趣，这本书的 ISBN 是 978-0470846742。它是最新的（包括技术勘误）。在与编译器供应商争论时，您怀疑它是权威资源是正确的。该标准没有规定性能，但确实为许多算法的大 O 复杂度设置了上限

# xml - Xsd 和继承

> ID：204852
> 
> 赞同：28
> 
> 时间：2008-10-15T14:10:34.787
> 
> 标签：xml, xsd

我有一个这样的xsd

```
<xsd:complexType name="A">  
        <xsd:complexContent>  
            <xsd:sequence>  
                <xsd:element name="options">  
                    <xsd:complexType>  
                        <xsd:sequence>  
                            <xsd:element name="Day">  
                            ...  
                            </xsd:element>  
                        </xsd:sequence>  
                    </xsd:complexType>  
                </xsd:element>  
            </xsd:sequence>  
        </xsd:complexContent>  
</xsd:complexType>  

<xsd:complexType name="B">  
    <xsd:complexContent>
        <xsd:extension base="A">
        ...What would go here...
        </xsd:extension>
    </xsd:complexContent>
</xsd:complexType> 
```

所以基本上我希望 A 类有一系列选项（例如 Day、Week）然后我希望 B 从 A 继承并拥有 A 的所有选项以及额外的 2 或 3 个选项，如小时、秒。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-10-16T05:00:33.287

这是我想出的架构：

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema id="inheritance"
    targetNamespace="http://test.com"
    elementFormDefault="qualified"
    xmlns="http://www.w3.org/2001/XMLSchema"
    xmlns:test="http://test.com"
>
    <xs:element name="Time">
        <xs:complexType>
            <xs:sequence>
                <xs:element name="First" type="test:A" />
                <xs:element name="Second" type="test:B" />
            </xs:sequence>
        </xs:complexType>
    </xs:element>

    <xs:complexType name="shortOptions">
        <xs:sequence>
            <xs:element name="Day" />
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="longOptions">
        <xs:complexContent>
            <xs:extension base="test:shortOptions">
                <xs:sequence>
                    <xs:element name="Week" />
                </xs:sequence>
            </xs:extension>
        </xs:complexContent>
    </xs:complexType>

    <xs:complexType name="A">
        <xs:sequence>
            <xs:element name="options" type="test:shortOptions" />
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="B">
        <xs:sequence>
            <xs:element name="options" type="test:longOptions" />
        </xs:sequence>
    </xs:complexType>

</xs:schema> 
```

这似乎适合这个xml：

```
<?xml version="1.0" encoding="utf-8" ?>
<Time xmlns="http://test.com">
    <First>
        <options>
            <Day>Today</Day>
        </options>
    </First>
    <Second>
        <options>
            <Day>Tomorrow</Day>
            <Week>This Week</Week>
        </options>
    </Second>
</Time> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-15T15:45:06.140

只需添加`<xsd:sequence>`所需的元素：

```
<xsd:complexType name="B">  
    <xsd:complexContent>
        <xsd:extension base="A">
           <xsd:sequence>
              <xsd:element name="Hours">
              ...
              </xsd:element>
           </xsd:sequence>
        </xsd:extension>
    </xsd:complexContent>
</xsd:complexType> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T05:27:41.813

您需要将选项定义为它自己的复杂类型，然后在其上使用扩展来创建新的选项复杂类型并使用替换而不是扩展。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T04:26:05.870

您需要为选项创建一个类型，其中包含小时等，然后在 csgero 的答案中添加选项而不是小时。

# c# - 最佳服务器端 .NET PDF 编辑库

> ID：204860
> 
> 赞同：35
> 
> 时间：2008-10-15T14:12:49.617
> 
> 标签：c#, .net, asp.net, vb.net, pdf

什么是最好的 .NET PDF 编辑库，为什么？

它需要在 IIS 网络服务器上使用。具体来说，我需要编辑由报告服务生成的 PDF。

我感兴趣的因素：

1.  速度
2.  内存消耗
3.  价格
4.  文件质量
5.  库稳定性
6.  图书馆规模
7.  其他你认为重要的

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-15T15:18:34.617

看看[iTextSharp](http://itextsharp.sourceforge.net/)。iTextSharp 是[iText](http://www.lowagie.com/iText/)的一个端口，它是一个免费的 Java-Pdf 库。

引用 iText：

您可以使用 iText 来：

*   将 PDF 提供给浏览器
*   从 XML 文件或数据库生成动态文档
*   使用 PDF 的许多交互功能
*   添加书签、页码、水印等。
*   拆分、连接和操作 PDF 页面
*   自动填写 PDF 表单
*   将数字签名添加到 PDF 文件
*   以及更多...

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-07-15T07:28:08.033

[Syncfusion Essential PDF](https://www.syncfusion.com/products/file-formats/pdf)是最好的。我已经使用它多年了。此外，与其他供应商相比，Syncfusion 提供了最好的支持。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-15T14:17:29.593

我研究了很多 Adob​​e 未专门提供的工具，其中两个立即浮现在脑海中的是[Atalasoft 的 DotImage](http://www.atalasoft.com/Products/DotImage/Default.aspx)和[LEADTools](http://www.leadtools.com/SDK/Raster/Raster-Addon-PDF.htm)。它们都相当昂贵，但提供服务器许可并使用超快的 C++ GDI 库。

有一个名为[PDFSharp](http://pdfsharp.com/PDFsharp/)的免费软件 .Net 库，它使用 .Net 本机 GDI+，因此速度较慢且内存密集。但话又说回来，它是免费的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-01-11T10:14:03.907

webSupergoo 有一个用于 .NET 的超级 PDF 库

他们的 ABCpdf 产品专为与 Web 服务器一起使用而设计。文档很清楚，安装附带一个示例网站项目。

如果您访问他们的网站，您应该会看到现场演示的链接：

[http://www.websupergoo.com/abcpdf-1.htm](http://www.websupergoo.com/abcpdf-1.htm)

ABCpdf 7 是当前版本。性能和可靠性非常好。标准版售价 329 美元，但有时可以免费获得安装。下载大小约为 30 MB。支持 32 位和 64 位服务器。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-15T14:21:53.997

我使用[http://www.tallcomponents.com/](http://www.tallcomponents.com/)主要是填写 pdf 表格，然后将 pdf 展平。似乎工作正常。我没有任何问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-15T14:16:54.803

我不知道它是否是最好的，但我使用的[是 PDF-Writer.NET](http://www.softizer.com/show_product/software_development/components_libraries/pdfwriternet/)，为此我支付了 89 美元。我已经在几个生产应用程序中使用了它。我喜欢它，因为它易于设置和使用，并且不需要大量编码，这使新开发人员更容易开始使用它。

在此之前，我使用开源库和 Acrobat 互操作 DLL 来破解 PDF。那很粗糙。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-15T14:18:41.413

不确定 PDF 部分，但 Aspose 有一个 PDF 库。我用他们的词库来生成word文档。在我看来，他们的文档非常不错。

[http://www.aspose.com/categories/file-format-components/aspose.pdf-for-.net-and-java/default.aspx](http://www.aspose.com/categories/file-format-components/aspose.pdf-for-.net-and-java/default.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-15T14:17:08.267

查看[Aspose.Pdf for .NET](http://www.aspose.com/categories/file-format-components/aspose.pdf-for-.net-and-java/default.aspx)。它有一个很好的 API，有据可查并且占用空间小。

# vb.net - VB.NET := 运算符

> ID：204877
> 
> 赞同：7
> 
> 时间：2008-10-15T14:17:10.140
> 
> 标签：vb.net, optional-variables

以下是什么意思？

```
Class.Function(variable := 1 + 1) 
```

这个运算符叫什么，它有什么作用？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-15T14:29:55.947

它用于分配可选变量，而不分配以前的变量。

```
sub test(optional a as string = "", optional b as string = "")
   msgbox(a & b)
end sub 
```

你现在可以做

```
test(b:= "blaat")
'in stead of
test("", "blaat") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T14:22:03.593

它将值 2 分配给可选参数“变量”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T14:32:40.280

VB.NET 支持方法调用中命名（可选）参数的这种语法。此特定语法通知`Class.Function`其参数`variable`将设置为 2 (1 + 1)。

# http-headers - 我可以使用“http header”来检查动态页面是否已更改

> ID：204886
> 
> 赞同：5
> 
> 时间：2008-10-15T14:18:22.320
> 
> 标签：http-headers

您可以请求 http 标头通过查看其日期来检查网页是否已被编辑，但是动态页面（如 php、aspx）如何从数据库中获取其数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-25T13:09:31.543

尽管您可能认为它已经过时，但我一直发现 Simon Willison 关于[条件 GET](http://simonwillison.net/2003/Apr/23/conditionalGet/)的文章非常有用。该示例是用 PHP 编写的，但它非常简单，您可以将其调整为其他语言。这是示例：

```
function doConditionalGet($timestamp) {
    // A PHP implementation of conditional get, see 
    // http://fishbowl.pastiche.org/archives/001132.html
    $last_modified = substr(date('r', $timestamp), 0, -5).'GMT';
    $etag = '"'.md5($last_modified).'"';

    // Send the headers
    header("Last-Modified: $last_modified");
    header("ETag: $etag");

    // See if the client has provided the required headers
    $if_modified_since = isset($_SERVER['HTTP_IF_MODIFIED_SINCE']) ?
        stripslashes($_SERVER['HTTP_IF_MODIFIED_SINCE']) :
        false;

    $if_none_match = isset($_SERVER['HTTP_IF_NONE_MATCH']) ?
        stripslashes($_SERVER['HTTP_IF_NONE_MATCH']) : 
        false;

    if (!$if_modified_since && !$if_none_match) {
        return;
    }

    // At least one of the headers is there - check them
    if ($if_none_match && $if_none_match != $etag) {
        return; // etag is there but doesn't match
    }

    if ($if_modified_since && $if_modified_since != $last_modified) {
        return; // if-modified-since is there but doesn't match
    }

    // Nothing has changed since their last request - serve a 304 and exit
    header('HTTP/1.0 304 Not Modified');
    exit;
} 
```

有了这个，您可以使用 HTTP 动词[GET](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.3)或[HEAD](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.4)（我认为[其他](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9)动词也可以，但我看不出使用它们的原因）。您需要做的就是添加`If-Modified-Since`或`If-None-Match`使用相应的标题值`Last-Modified`或`ETag`由页面的先前版本发送。从 HTTP 版本 1.1 开始，建议使用`ETag`over `Last-Modified`，但两者都可以。

这是条件 GET 如何工作的一个非常简单的示例。首先，我们需要以通常的方式检索页面：

```
获取 /some-page.html HTTP/1.1
主机：example.org
```

带有条件标题和内容的第一个响应：

```
200 好
ETag：您的ETagHere
```

现在有条件的获取请求：

```
获取 /some-page.html HTTP/1.1
主机：example.org
If-None-Match: YourETagHere
```

并且响应表明您可以使用页面的缓存版本，因为只有标题将被传递：

```
304 未修改
ETag：您的ETagHere
```

有了这个，服务器通知您页面没有修改。

我还可以向您推荐另一篇关于条件 GET 的文章：[面向 RSS 黑客的 HTTP 条件 GET](http://fishbowl.pastiche.org/2002/10/21/http_conditional_get_for_rss_hackers/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T14:34:03.693

这是*[ETag](http://en.wikipedia.org/wiki/HTTP_ETag)*标头的确切用途，但它必须由您的 Web 框架支持，或者您需要注意您的应用程序正确响应带有标头*If-Match*、*If-Not-Match*和*If-Range*的请求（请参阅[HTTP 第 3.11 章](http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.11)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T14:32:29.733

是的，您可以并且应该使用 HTTP 标头将页面标记为未过期。如果它们是动态的（PHP、ASPX 等）和/或数据库驱动，您需要手动控制设置 Expires 标头/适当地发送未修改的 HTTP。ASP.NET 对此有一些 SqlDependency 对象，但它们仍然需要配置和管理。（不确定 PHP 是否有类似的东西，但如果没有的话，PEAR 中可能有一些东西......）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T14:40:12.323

`Last-Modified`仅当站点的程序员明确将其设置为返回时，该标头才对您有用。

对于常规的静态页面`Last-Modified`，是 HTML 文件最后一次修改的时间戳。对于动态生成的页面，服务器无法可靠地分配`Last-Modified`值，因为它无法真正了解内容如何根据​​请求发生变化，因此许多服务器根本不生成标头。

如果您可以控制页面，那么确保设置了 Last Modified 标题将确保检查`Last-Modified`成功。否则，您可能必须获取页面并执行正则表达式以查找更改的部分（例如，新闻站点标题中的日期/时间）。如果不存在这样明显的标记，那么我会[支持 Oli](https://stackoverflow.com/questions/204886/can-i-use-http-header-to-check-if-a-dynamic-page-has-been-changed#204898)在页面内容上使用 MD5 的建议，以确保它已更改。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T14:21:28.693

如果它正确使用 http 响应标头，则可以，但它经常被忽略。

否则，存储内容的本地 md5 哈希可能对您有用（除非您可以挂出更简单的内容字符串）。这并不理想（因为这是一个相当缓慢的过程），但它是一种选择。

# visual-studio - 在 Visual C++ 解决方案中查找过时或丢失的依赖项或输出文件（或：为什么 VS 坚持不更改就重新构建项目？）

> ID：204901
> 
> 赞同：5
> 
> 时间：2008-10-15T14:21:54.903
> 
> 标签：visual-studio, build-process

我有一个包含多个项目的解决方案。我只更改其中一个中的代码，但每次我点击`Ctrl`++`Shift`时`B`，Visual Studio 都会重建所有其他代码。

我希望它构建其他项目，所以这很好。不好的是，通常情况下，它会看到无事可做。我在某个地方有一个不稳定的依赖，所以这不起作用。

是否有工具或宏（或开关）可以探索依赖关系树并告诉我哪些文件丢失或过期，以便我可以让它停止？

我知道我可以通过（例如）触摸所有项目文件来解决这个特定情况。

不幸的是，当文件配置为生成输出文件时，我经常看到这种情况（例如，IDL 文件配置为输出类型库，但不包含“库”块，因此它永远不会创建 TLB ）。

这不会通过触摸所有项目文件来解决，所以我正在寻找更通用的东西来添加到我的个人工具箱中，它可以很容易地告诉我为什么要重建文件，无论是因为它比依赖，或者因为项目被错误配置为期望永远不会生成的输出文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T14:31:43.713

如果我理解正确，您可以通过触摸所有项目文件来解决此问题。这可能是由具有未来最后修改时间的源文件引起的。

**编辑：**

> 我知道我可以通过（例如）触摸所有项目文件来解决这个特定的情况，但我想在我的个人技巧箱中添加一些东西，我可以在未来使用，在一般情况下。

我很困惑 - 这个问题的“一般情况”是什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T15:11:05.833

在选项/项目和解决方案/构建和运行中，将 MSBuild 项目构建输出详细程度设置为详细。它应该让您了解它为什么要重建所有项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T14:26:57.373

不是我发现的。如果您知道一个项目不会经常更改，您可以告诉配置管理器不要构建它。（右键单击解决方案，然后选择配置管理）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T14:26:59.230

据我所知， ctrl + shift + b 默认绑定到 BuildSolution，这就是为什么要构建所有项目的原因。除了右键单击项目并按构建之外，我不确定您还能使用什么:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T14:31:00.563

您可能需要检查工具>选项>项目和解决方案，并检查您的选项是否设置为仅构建启动项目和依赖项而不是所有解决方案。

或者不要使用 ctrl+shirt+b 你应该在你想要构建的项目上简单地按 F6 :)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-15T14:32:58.547

您可以使用 shift+F6 仅构建当前项目。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-15T20:52:38.810

虽然没有直接回答我的问题：“有什么工具可以帮我解决这个问题吗？”，我通过使用 SysInternals Process Monitor 发现了具体问题：

项目配置了/analyze，需要Visual Studio Team Edition，但是这台PC上的版本是Visual Studio Professional，不支持。不幸的是，Visual Studio 中似乎存在一个错误，它认为应该创建 .pchast 文件，尽管它没有办法这样做。我在 Connect 上提出了这个问题。

我想我可能会为 Visual Studio Professional 编写一个宏，如果打开 /analyze，它只会在构建结束时创建一个空的 .pchast 文件......

# asp.net - 带有 ASP.NET 母版页的事件和委托

> ID：204906
> 
> 赞同：2
> 
> 时间：2008-10-15T14:22:42.110
> 
> 标签：asp.net, events, delegates, master-pages

如何捕捉母版页引发的自定义事件？

在我的母版页上，我有一个自定义事件和委托：

```
public event SignOutHandler SignOut;
public delegate void SignOutHandler(); 
```

当单击母版页上的链接按钮时会引发此问题。

```
if (SignOut != null)
{
    SignOut();
} 
```

在页面上的用户控件中，我想订阅该事件，但我不知道我应该如何访问它。通常我会做类似的事情：

```
MyInstantiatedMasterPage.SignOut += new MyMasterPage.SignOutHandler(MyEvent); 
```

但是处理母版页意味着这是不可能的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T14:39:48.750

它被实例化为一个全局对象，这是您需要使用的：

```
((MyMasterPage)Master).SignOut += new MyMasterPage.SignOutHandler(MyEvent); 
```

# parsing - 用于解析发现退回邮件的 SMTP 日志的工具

> ID：204910
> 
> 赞同：4
> 
> 时间：2008-10-15T14:24:30.327
> 
> 标签：parsing, logging, smtp, zabbix, splunk

我们的网络应用程序发送电子邮件。我们有很多用户，我们收到很多反弹。例如，用户更改公司，他的公司电子邮件不再有效。

为了查找退回邮件，我使用日志解析器解析 SMTP 日志文件。日志来自 Microsoft SMTP 服务器。

有些反弹很棒，比如`550+#5.1.0+Address+rejected+user@domain.com`. 有`user@domain.com`反弹。

但是有些错误消息中没有电子邮件，例如`550+No+such+recipient`.

我创建了简单的 Ruby 脚本来解析日志（使用日志解析器）来查找哪些邮件导致了类似`550+No+such+recipient`.

我很惊讶我找不到可以做到这一点的工具。我找到了像 Zabbix 和 Splunk 这样的工具来进行日志分析，但对于这样简单的任务来说，它们看起来有点矫枉过正。

任何人都知道一个可以解析 SMTP 日志、查找导致它们的退回邮件和电子邮件的工具吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-08T18:31:39.187

据我所知，日志文件分析实际上只对检测在 SMTP 会话级别被拒绝的邮件有用。在远程 MTA 接受要传递的消息但随后未能传递之后发生的退回怎么办？

我们使用以下设置来检测*和分类*交付到远程 MTA 后的所有退回邮件。

1.  所有外发邮件都有一个[唯一的返回路径标头](http://en.wikipedia.org/wiki/Variable_envelope_return_path)，该标头在解码时标识收件人电子邮件地址和特定邮件。

2.  接收返回到返回路径地址的邮件的[Apache James服务器。](http://james.apache.org/)

3.  一个用 Java 开发并在 Apache James 中执行的自定义 mailet，它对收件人地址进行解码，将电子邮件文本发送到[boogietools 退回工作室](http://www.boogietools.com/)进行退回类型分类，然后将结果保存到我们的数据库中。

它工作得非常非常好。我们能够检测永久硬退回和瞬时软退回，这些退回进一步分为非常精细的退回类型，例如垃圾邮件拒绝、不在办公室回复等。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-15T14:29:08.320

这篇[文章](http://scriptolog.blogspot.com/2007/08/smtp-log-parsing.html)正是您正在寻找的。它基于伟大的工具[日志解析器](http://www.microsoft.com/technet/scriptcenter/tools/logparser/default.mspx)。

> 日志解析器是一个强大的通用工具，它提供对基于文本的数据（如日志文件、XML 文件和 CSV 文件）以及 Windows® 操作系统上的关键数据源（如事件日志、注册表、文件系统和 Active Directory®。您告诉 Log Parser 您需要什么信息以及您希望如何处理它。您的查询结果可以在基于文本的输出中自定义格式，或者它们可以持久保存到更专业的目标，如 SQL、SYSLOG 或图表。大多数软件旨在完成数量有限的特定任务。Log Parser 是不同的......它可以使用的方式数量仅受用户的需求和想象力的限制。世界就是您使用 Log Parser 的数据库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T18:16:17.480

我喜欢 logParser。当我需要解析非常特定或自定义的东西或使用正则表达式时，我会使用 biterScripting。他们实际上有一些我用来入门的示例脚本。一个在[http://www.biterscripting.com/Download/SS_WebLogParser.txt](http://www.biterscripting.com/Download/SS_WebLogParser.txt)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-08T06:33:16.100

您不想解析日志以尝试识别退回邮件。如果您只查看日志，您将同时遇到误报和误报。

退回可能会在您交付到的服务器的下游生成。在您的传出服务器日志中，它们看起来像是成功交付。

传入日志（从空发件人到您的 VERP 编辑地址之一）中退回的原始模式匹配将不准确。有几个原因：

*   将有延迟警告与实际的失败反弹混合在一起。
*   大多数外出和类似的自动回复使用空发件人来防止 battlin-bots 综合症。
*   同样，质询-响应系统（如 *spit* boxbe.com）倾向于使用空发送者。
*   您的 VERP 发件人地址（如果每个收件人都是持久的）将被垃圾邮件发送者收集并作为垃圾邮件目标或反向散射返回。

因此，可悲的是，唯一可靠的方法是检查退回邮件本身。根据 RFC1894，它们中的大多数将具有“报告/交付状态”MIME 部分，并且根据您选择的语言，可能有库或模块可以帮助处理其他退回格式。我唯一有直接经验的是 Perl Mail::DeliveryStatus::BounceParser 模块，它运行良好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T23:58:01.327

我基于这篇文章的退回计数器程序，后来才发现这种方法实际上不适用于大容量发件人，因为 SMTP 日志不是按顺序排列的。在我的博客文章中有更多关于它的内容：[SMTP 日志中的电子邮件退回检测以及为什么它是不可能](http://phreakhead.livejournal.com/74871.html)的。

# yui - YUI 上传器 2.6.0 示例

> ID：204914
> 
> 赞同：1
> 
> 时间：2008-10-15T14:25:35.690
> 
> 标签：yui, yui-uploader

我试图简单地使用一些关于 YUI-Uploader 的示例和说明，但我对一些问题感到沮丧。

1.  “YUI 库：上传器”备忘单的简单用例对我不起作用，因为除`addListener()`myUploader 对象之外的所有列出的方法都不存在。
2.  该[示例](http://developer.yahoo.com/yui/examples/uploader/uploader-simple.html)适用于 2.5.1 版本，包括一个名为 的方法`browse()`，该方法不仅在 2.6.0 版本中被删除，而且如果我愿意，我找不到任何关于如何使用 2.5.1 版本的文档。
3.  我找不到该`uploader.swf`文件的源 FLA，因此我可以从理论上诊断所有这些问题。

有没有人成功使用过 2.6.0 YUI Uploader，如果是的话，是否有一些我应该避免的常见干扰 JavaScript，或者更好的例子？谢谢你。

感谢您的回复。

我可能会注意到我在收到任何回复之前完成了我的“上传者”项目。我的部分问题是由于一些示例是针对 v2.5.1 的，另一部分是由于没有使用事件侦听器来查看组件何时准备就绪。我从剖析[Flickr](http://flickr.com)所做的事情中得到了最大的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T09:41:42.083

您现在可以在`uploader.swf` [此处`Uploader.as`](http://github.com/yui/yui2/blob/fa7794624ce8dd3d3b231289ca1995c25bebecc4/src/uploader/as/Uploader.as)找到源代码，因为 YUI 源代码在 GitHub 上可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T22:50:50.547

简单示例的链接错误，这是正确的链接。

[YUI 上传器简单示例](http://developer.yahoo.com/yui/examples/uploader/uploader-simple-button.html)

如果你愿意，你也可以看看我的实现，它非常简单，使用 YUI 2.6.0 可以正常工作。

[Tivac.com YUI 上传器实现](http://tivac.com/upload/)

对于#1 来说，您正在尝试立即调用上传程序上的方法。您应该为它可以触发的所有事件添加侦听器，并在“contentReady”事件触发后进行任何配置。所有 YUI 示例和我的都是这样做的，因此您可以在那里查看代码示例。

# caching - SQLAlchemy 是否支持缓存？

> ID：204918
> 
> 赞同：36
> 
> 时间：2008-10-15T14:26:30.197
> 
> 标签：caching, sqlalchemy, cherrypy

SQLAlchemy 是否支持某种缓存，所以如果我重复运行相同的查询，它会从缓存返回响应而不是查询数据库？更新数据库时是否会自动清除此缓存？

或者在 CherryPy + SQLAlchemy 设置上实现这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2010-01-28T03:43:08.180

我们有一个非常全面的缓存解决方案，例如结合嵌入式钩子，在 0.6 中。这是 Query 的子类化方法，使其了解 Beaker，并允许通过查询选项控制显式查询和惰性加载器的查询缓存。

我现在正在生产中运行它。该示例本身位于 dist 中，介绍文档位于[http://www.sqlalchemy.org/docs/orm/examples.html#beaker-caching](http://www.sqlalchemy.org/docs/orm/examples.html#beaker-caching)。

更新：烧杯现在已被`dogpile`缓存取代： http: [//docs.sqlalchemy.org/en/latest/orm/examples.html#module-examples.dogpile_caching](http://docs.sqlalchemy.org/en/latest/orm/examples.html#module-examples.dogpile_caching)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-24T03:16:05.867

不是你的第二个问题的答案，但从这个链接中的评论表明 SQLAlchemy 不支持缓存：[http ://spyced.blogspot.com/2007/01/why-sqlalchemy-impresses-me.html](http://spyced.blogspot.com/2007/01/why-sqlalchemy-impresses-me.html)

**乌鸦说...**

> ```
> Does SQLAlchemy do any kind of internal caching?
> 
> For example, if you ask for the same data twice (or an obvious subset
> of the initially requested data) will the database be hit once or twice?
> 
> I recently wrote a caching database abstraction layer for an
> application and (while fun) it was a fair bit of work to get it to a
> minimally functional state. If SQLAlchemy did that I would seriously
> consider jumping on the bandwagon.
> 
> I've found things in the docs that imply something like this might be
> going on, but nothing explicit.
> 4:36 PM 
> ```

**乔纳森·埃利斯说……**

> ```
> No; the author of SA [rightly, IMO] considers caching a separate concern.
> 
> What you saw in the docs is probably the SA identity map, which makes it so 
> if you load an instance in  two different places, they will refer
> to the same object. But the database will still be queried twice, so it is
> not a cache in the sense you mean. 
> ```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2015-11-02T18:35:59.530

SQLAlchemy 支持两种类型的缓存：

1.  缓存结果集，以便重复运行相同的查询命中缓存而不是数据库。它使用`dogpile`它支持许多不同的后端，包括`memcached`、`redis`和基本平面文件。

    文档在这里：[http ://docs.sqlalchemy.org/en/latest/orm/examples.html#module-examples.dogpile_caching](http://docs.sqlalchemy.org/en/latest/orm/examples.html#module-examples.dogpile_caching)

2.  缓存`query`对象，以便 Python 解释器不必每次都手动重新组装查询字符串。这些查询被调用`baked queries`并且缓存被调用`baked`。基本上，它会缓存`sqlalchemy`在访问数据库之前采取的所有操作——它不会减少数据库调用。`query`最初的基准测试显示，在代码冗长程度略有增加的情况下，生成时间的加速最高可达 40% 。

    文档在这里：[http ://docs.sqlalchemy.org/en/latest/orm/extensions/baked.html](http://docs.sqlalchemy.org/en/latest/orm/extensions/baked.html)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-11-21T19:37:15.280

或通过弱引用字典（weakref.WeakValueDictionary）使用应用程序级缓存，请参见此处的示例：[http ://www.sqlalchemy.org/trac/wiki/UsageRecipes/UniqueObject](http://www.sqlalchemy.org/trac/wiki/UsageRecipes/UniqueObject)

# css - 如何将 CSS 文件动态加载到 Flex 应用程序中？

> ID：204924
> 
> 赞同：6
> 
> 时间：2008-10-15T14:27:58.977
> 
> 标签：css, apache-flex, dynamic-css

我知道您可以应用 CSS 以使用 StyleManager 在 Flex 中设置对象样式：http://livedocs.adobe.com/flex/3/html/help.html?content=
[styles_07.html](http://livedocs.adobe.com/flex/3/html/help.html?content=styles_07.html)

您还可以动态加载已**编译**的 CSS 文件 (SWF)：http: //livedocs.adobe.com/flex/3/html/help.html?content=
[styles_10.html](http://livedocs.adobe.com/flex/3/html/help.html?content=styles_10.html)

但是，我正在使用 Web GUI 和服务器端脚本动态创建我的 CSS 文件。如果 CSS 发生更改，则脚本还需要将 CSS 编译为 SWF（这不是一个可行的选项）。有没有办法解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T15:19:47.953

在对 Adob​​e 错误跟踪器中与此相关的问题的[评论中，](http://bugs.adobe.com/jira/browse/SDK-11868#action_186925) *T. Busser*描述了对您来说可能是一个可行的解决方案：

> *“我创建了一个小类，它将‘解析’一个使用 HTTPService 对象读取的 CSS 文件。它分解 HTTPService 对象返回的字符串，将其分解为选择器，并为每个选择器创建一个新的 CSSStyleDeclaration 对象找到了。一旦将所有属性分配给 CSSStyleDeclaration 对象，它就会添加到 StyleManager。它不执行任何检查，您应该确保 CSS 文件格式正确，但在 99% 的情况下就足够了。我的客户几乎不会使用 @font、Embed() 和 ClassReference() 之类的东西。他们确实需要能够更改颜色和类似的东西，以便他们可以轻松地将 Flex 应用程序主题化为他们的房屋风格。*

您可以尝试与此人联系以获取他们的解决方案，也可以使用[此 as3csslib 项目](http://code.google.com/p/as3csslib/)中的代码作为编写类似他们所描述内容的基础。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T09:38:50.583

你也可以像这样在 flex 中实现动态样式表。在这里我找到了这篇文章： [http ://askmeflash.com/article_m.php?p=article&id=6](http://askmeflash.com/article_m.php?p=article&id=6)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-09-23T20:42:54.290

*编辑：此解决方案不起作用。从解析器中取出的所有选择器都转换为小写。这可能适用于您的应用程序，但它可能不会...*

*我将这个答案留在这里，因为它可能会帮助一些人寻找解决方案，并警告其他人这种方法的局限性。*

* * *

请参阅我的问题：“[寻找用 AS3 编写的 CSS 解析器](https://stackoverflow.com/questions/7531455/looking-for-css-parser-written-in-as3)”以获得完整的讨论，但我发现隐藏在标准库中的 CSS 解析器。以下是如何使用它：

```
public function extractFromStyleSheet(css:String):void {

    // Create a StyleSheet Object
    var styleSheet:StyleSheet = new StyleSheet();
    styleSheet.parseCSS(css);

    // Iterate through the selector objects
    var selectorNames:Array = styleSheet.styleNames;
    for(var i:int=0; i<selectorNames.length; i++){

        // Do something with each selector
        trace("Selector: "+selelectorNames[i];

        var properties:Object = styleSheet.getStyle(selectorNames[i]);
        for (var property:String in properties){

            // Do something with each property in the selector
            trace("\t"+property+" -> "+properties[property]+"\n");
        }
    }
} 
```

然后，您可以使用以下方式应用样式：

```
cssStyle = new CSSStyleDeclaration();
cssStyle.setStyle("color", "<valid color>);
FlexGlobals.topLevelApplication.styleManager.setStyleDeclaration("Button", cssStyle, true); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T14:48:12.977

Flex 中的 CSS 应用程序在编译时在服务器端处理，而不是在运行时在客户端处理。

然后我会为您看到两个选项（我不确定两者的实用性）：

1.  使用服务器端脚本将 CSS 编译为 SWF，然后动态加载它们。
2.  解析 CSS 样式表并使用 flex 中的 setStyle 函数来应用样式。与此方法类似的示例是[Flex Style Explorer](http://examples.adobe.com/flex3/consulting/styleexplorer/Flex3StyleExplorer.html)，您可以在其中查看[源代码](http://examples.adobe.com/flex3/consulting/styleexplorer/srcview/index.html)。

祝你好运。

# erlang - Erlang/OTP 有哪些分析器和分析器？

> ID：204926
> 
> 赞同：16
> 
> 时间：2008-10-15T14:28:13.377
> 
> 标签：erlang, profiler, lexical-analysis

Erlang 有什么好的代码分析器/分析器吗？我需要一些可以为我的代码构建调用图（例如 gprof）的东西。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-15T14:51:18.930

对于静态代码分析，您有[Xref](http://www.erlang.org/doc/man/xref.html)和[Dialyzer](http://www.it.uu.se/research/group/hipe/dialyzer/)，对于分析，您可以使用 cprof、fprof 或 eprof，参考[这里](http://www.erlang.org/documentation/doc-5.5.5/lib/tools-2.5.5/doc/html/index.html)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-15T14:46:50.813

'fprof' 模块包括分析功能。从[fprof 模块文档](http://www.erlang.org/doc/man/fprof.html)：

```
fprof:apply(foo, create_file_slow, [junk, 1024]).
fprof:profile().
fprof:analyse(). 
```

`fprof:apply`（或`trace`）运行该函数，`profile`将跟踪文件转换为有用的文件，并`analyse`打印出摘要。这将为您提供观察到的函数调用列表、调用它们的对象、调用对象的对象以及挂钟计时信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-25T21:47:35.507

试试这个：[https](https://github.com/virtan/eep) ://github.com/virtan/eep 你可以得到这样的东西[https://raw.github.com/virtan/eep/master/doc/sshot1.png](https://raw.github.com/virtan/eep/master/doc/sshot1.png)

# c# - 在c#中使用临时表

> ID：204933
> 
> 赞同：10
> 
> 时间：2008-10-15T14:29:35.900
> 
> 标签：c#, sql, temp-tables

我将 excel 表读入数据网格。从那里，我设法将网格的行读入 DataTable 对象。DataTable 对象具有数据，因为当我将网格的数据源与该表对象相等时，网格被填充。

我的问题：我想使用表对象并使用 SQL 服务器操作它的值，（即我想将它存储为临时表并使用 C# 代码中的 SQL 查询来操作它，我希望它返回不同的结果 inte一个网格。（我不知道如何在 C# 中使用临时表）

这是单击按钮时要执行的代码....

```
 SqlConnection conn = new SqlConnection("server = localhost;integrated security = SSPI");
//is connection string incorrect?

SqlCommand cmd = new SqlCommand();

//!!The method ConvertFPSheetDataTable Returns a DataTable object//
cmd.Parameters.AddWithValue("#table",ConvertFPSheetDataTable(12,false,fpSpread2_Sheet1));
//I am trying to create temporary table     

//Here , I do a query               
cmd.CommandText = "Select col1,col2,SUM(col7) From #table group by col1,col2 Drop #table";

SqlDataAdapter da = new SqlDataAdapter(cmd.CommandText,conn);
 DataTable dt = new DataTable();
da.Fill(dt); ***// I get an error here 'Invalid object name '#table'.'***

fpDataSet_Sheet1.DataSource = dt;

//**NOTE:** fpDataSet_Sheet1 is the grid control 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-31T00:51:15.150

在这两个地方将您的临时表从 #table 更改为 ##table。

使用## 表示保留的全局临时表。完成任务后，您需要将其删除。

Command =“删除表##table”

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-15T14:37:33.810

将数据放入数据库需要时间 - 因为您已经在内存中拥有它，也许 LINQ-to-Objects（带有 DataSetExtensions）是您的朋友？用正确的类型替换 <int> 等...

```
 var query = from row in table.Rows.Cast<DataRow>()
                  group row by new
                  {
                      Col1 = row.Field<int>(1),
                      Col2 = row.Field<int>(2)
                  } into grp
                  select new
                  {
                      Col1 = grp.Key.Col1,
                      Col2 = grp.Key.Col2,
                      SumCol7 = grp.Sum(x => x.Field<int>(7))
                  };
        foreach (var item in query)
        {
            Console.WriteLine("{0},{1}: {2}",
                item.Col1, item.Col2, item.SumCol7);
        } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-15T16:20:33.773

我不认为您可以按照您的想法在 SQL 中创建临时表，因为它只存在于创建它的查询/存储过程的范围内。

如果电子表格是标准格式——这意味着您知道列并且它们总是相同的，您可能希望在 SQL 中创建一个表来将此文件放入其中。有一种非常快速的方法可以做到这一点，称为 SqlBulkCopy

```
// Load the reports in bulk
SqlBulkCopy bulkCopy = new SqlBulkCopy(connectionString);
// Map the columns
foreach(DataColumn col in dataTable.Columns)
   bulkCopy.ColumnMappings.Add(col.ColumnName, col.ColumnName);
bulkCopy.DestinationTableName = "SQLTempTable";
bulkCopy.WriteToServer(dataTable); 
```

但是，如果我正确理解您的问题，您不需要使用 SQL Server 来修改 DataTable 中的数据。您可以使用 JET 引擎为您获取数据。

```
 // For CSV
    connStr = string.Format("Provider=Microsoft.JET.OLEDB.4.0;Data Source={0};Extended Properties='Text;HDR=Yes;FMT=Delimited;IMEX=1'", Folder);
    cmdStr = string.Format("SELECT * FROM [{0}]", FileName);
    // For XLS
    connStr = string.Format("Provider=Microsoft.JET.OLEDB.4.0;Data Source={0}{1};Extended Properties='Excel 8.0;HDR=Yes;IMEX=1'", Folder, FileName);
    cmdStr = "select * from [Sheet1$]";
OleDbConnection oConn = new OleDbConnection(connStr);
            OleDbCommand cmd = new OleDbCommand(cmdStr, oConn);
            OleDbDataAdapter da = new OleDbDataAdapter(cmd);
            oConn.Open();
            da.Fill(dataTable);
            oConn.Close(); 
```

此外，在您的代码中，您询问您的连接字符串是否正确。我不认为是（但我可能是错的）。如果你的不工作试试这个。

```
connectionString="Data Source=localhost\<instance>;database=<yourDataBase>;Integrated Security=SSPI" providerName="System.Data.SqlClient" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T16:04:52.153

也许您可以使用 DataView。您可以从已有的 DataTable 中创建它。

```
dv = new DataView(dataTableName); 
```

然后，您可以使用 DataView 的方法过滤（应用 SQL WHERE 子句）或对数据进行排序。您还可以使用 Find 查找匹配行，或 FindRows 查找所有匹配行。

一些过滤器：

```
dv.RowFilter = "Country = 'USA'";
dv.RowFilter = "EmployeeID >5 AND Birthdate < #1/31/82#"
dv.RowFilter = "Description LIKE '*product*'"
dv.RowFilter = "employeeID IN (2,4,5)" 
```

排序：

```
dv.Sort = "City" 
```

查找一行：查找名为“John Smith”的客户。

```
 vals(0)= "John"
   vals(1) = "Smith"
   i = dv.Find(vals) 
```

其中 i 是包含客户的行的索引。

将这些应用到 DataView 后，您可以将网格绑定到 DataView。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T14:46:00.207

请原谅我，如果我不明白你到底想要什么。
如果你想在 Excel 表上执行 SQL 查询，你可以直接做。

或者，您可以使用 SQL Server 查询 excel（OPENROWSET 或我不记得的函数）。使用它，您可以使用 excel 表加入 sql server 表

Marc 的建议是另一种看待它的方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-07T16:43:22.160

将命令文本从

```
Select col1,col2,SUM(col7) From #table group by col1,col2 
```

至

```
Select col1,col2,SUM(col7) From @#table group by col1,col2 
```

# c# - Set time programmatically using C#

> ID：204936
> 
> 赞同：7
> 
> 时间：2008-10-15T14:30:10.003
> 
> 标签：c#, time

What is the best way to set the time on a remote machine remotely? The machine is running Windows XP and is receiving the new time through a web service call. The goal is to keep the remote machines in synch with the server. The system is locked down so that our web service is the only access, so I cannot use a time server on each remote machine.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-15T14:39:02.717

This is the Win32 API call for setting system time:

```
[StructLayout(LayoutKind.Sequential)] 
public struct SYSTEMTIME { 
 public short wYear; 
 public short wMonth; 
 public short wDayOfWeek; 
 public short wDay; 
 public short wHour; 
 public short wMinute; 
 public short wSecond; 
 public short wMilliseconds; 
 } 
 [DllImport("kernel32.dll", SetLastError=true)] 
public static extern bool SetSystemTime(ref SYSTEMTIME theDateTime ); 
```

I'm not exactly sure how you would get the security worked out such that you could execute that function on the client, though.

You can get a lot more detail on setting system time at [PInvoke](http://www.pinvoke.net/default.aspx/kernel32/SetSystemTime.html).

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-15T14:42:34.207

I would use Windows built-in internet time abilities. You can set up a [time server](http://en.wikipedia.org/wiki/Time_server) on your server, have it get time from a 2nd-tier timeserver, and have all your client machines get time from it.

I've been down the application-setting-system-time road before.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-15T14:50:47.280

The way to query a network machine for it's system time is [NetRemoteTOD](http://msdn.microsoft.com/en-us/library/aa370612(VS.85).aspx).

Here's code to do it in Delphi (a usage example is posted below).

Since it relies on Windows API calls, it shouldn't be too different in C#.

```
unit TimeHandler;

interface

type
  TTimeHandler = class
  private
    FServerName : widestring;
  public
    constructor Create(servername : widestring);
    function RemoteSystemTime : TDateTime;
    procedure SetLocalSystemTime(settotime : TDateTime);
  end;

implementation

uses
  Windows, SysUtils, Messages;

function NetRemoteTOD(ServerName :PWideChar; var buffer :pointer) : integer; stdcall; external 'netapi32.dll';
function NetApiBufferFree(buffer : Pointer) : integer; stdcall; external 'netapi32.dll';

type
  //See MSDN documentation on the TIME_OF_DAY_INFO structure.
  PTime_Of_Day_Info = ^TTime_Of_Day_Info;
  TTime_Of_Day_Info = record
    ElapsedDate : integer;
    Milliseconds : integer;
    Hours : integer;
    Minutes : integer;
    Seconds : integer;
    HundredthsOfSeconds : integer;
    TimeZone : LongInt;
    TimeInterval : integer;
    Day : integer;
    Month : integer;
    Year : integer;
    DayOfWeek : integer;
  end;

constructor TTimeHandler.Create(servername: widestring);
begin
  inherited Create;
  FServerName := servername;
end;

function TTimeHandler.RemoteSystemTime: TDateTime;
var
  Buffer : pointer;
  Rek : PTime_Of_Day_Info;
  DateOnly, TimeOnly : TDateTime;
  timezone : integer;
begin
  //if the call is successful...
  if 0 = NetRemoteTOD(PWideChar(FServerName),Buffer) then begin
    //store the time of day info in our special buffer structure
    Rek := PTime_Of_Day_Info(Buffer);

    //windows time is in GMT, so we adjust for our current time zone
    if Rek.TimeZone <> -1 then
      timezone := Rek.TimeZone div 60
    else
      timezone := 0;

    //decode the date from integers into TDateTimes
    //assume zero milliseconds
    try
      DateOnly := EncodeDate(Rek.Year,Rek.Month,Rek.Day);
      TimeOnly := EncodeTime(Rek.Hours,Rek.Minutes,Rek.Seconds,0);
    except on e : exception do
      raise Exception.Create(
                             'Date retrieved from server, but it was invalid!' +
                             #13#10 +
                             e.Message
                            );
    end;

    //translate the time into a TDateTime
    //apply any time zone adjustment and return the result
    Result := DateOnly + TimeOnly - (timezone / 24);
  end  //if call was successful
  else begin
    raise Exception.Create('Time retrieval failed from "'+FServerName+'"');
  end;

  //free the data structure we created
  NetApiBufferFree(Buffer);
end;

procedure TTimeHandler.SetLocalSystemTime(settotime: TDateTime);
var
  SystemTime : TSystemTime;
begin
  DateTimeToSystemTime(settotime,SystemTime);
  SetLocalTime(SystemTime);
  //tell windows that the time changed
  PostMessage(HWND_BROADCAST,WM_TIMECHANGE,0,0);
end; 
```

And here is the usage example:

```
procedure TfrmMain.SynchLocalTimeWithServer;
var
  tod : TTimeHandler;
begin
  tod := TTimeHandler.Create(cboServerName.Text);
  try
    tod.SetLocalSystemTime(tod.RemoteSystemTime);
  finally
    FreeAndNil(tod);
  end;  //try-finally
end; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-02T18:59:35.800

Here's the routine I have been using for years to read the `DateTime` value off our our SQL Server (using file time), convert it to a `SYSTEMTIME` that is set on the PC.

This works for PCs and Windows Mobile devices.

It can be called anytime you happen to be calling your SQL Server.

```
public class TimeTool {

  private static readonly DateTime NODATE = new DateTime(1900, 1, 1);

#if PocketPC
  [DllImport("coredll.dll")]
#else
  [DllImport("kernel32.dll")]
#endif
  static extern bool SetLocalTime([In] ref SYSTEMTIME lpLocalTime);

  public struct SYSTEMTIME {
    public short Year, Month, DayOfWeek, Day, Hour, Minute, Second, Millisecond;
    /// <summary>
    /// Convert form System.DateTime
    /// </summary>
    /// <param name="time">Creates System Time from this variable</param>
    public void FromDateTime(DateTime time) {
      Year = (short)time.Year;
      Month = (short)time.Month;
      DayOfWeek = (short)time.DayOfWeek;
      Day = (short)time.Day;
      Hour = (short)time.Hour;
      Minute = (short)time.Minute;
      Second = (short)time.Second;
      Millisecond = (short)time.Millisecond;
    }

    public DateTime ToDateTime() {
      return new DateTime(Year, Month, Day, Hour, Minute, Second, Millisecond);
    }

    public static DateTime ToDateTime(SYSTEMTIME time) {
      return time.ToDateTime();
    }
  }

  // read SQL Time and set time on device
  public static int SyncWithSqlTime(System.Data.SqlClient.SqlConnection con) {
    SYSTEMTIME systemTime = new SYSTEMTIME();
    DateTime sqlTime = NODATE;
    string sql = "SELECT GETDATE() AS [CurrentDateTime]";
    using (System.Data.SqlClient.SqlCommand cmd = new System.Data.SqlClient.SqlCommand(sql, con)) {
      try {
        cmd.Connection.Open();
        System.Data.SqlClient.SqlDataReader r = cmd.ExecuteReader();
        while (r.Read()) {
          if (!r.IsDBNull(0)) {
            sqlTime = (DateTime)r[0];
          }
        }
      } catch (Exception) {
        return -1;
      }
    }
    if (sqlTime != NODATE) {
      systemTime.FromDateTime(sqlTime); // Convert to SYSTEMTIME
      if (SetLocalTime(ref systemTime)) { //Call Win32 API to set time
        return 1;
      }
    }
    return 0;
  }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T14:55:48.250

You could also probably do this in a batch file using some combination of

```
TIME 
```

to set the time, and

```
net time \\server_name 
```

to retrieve the time from a server.

# c# - 使用 C# 确定 LocalSystem 帐户名称

> ID：204942
> 
> 赞同：2
> 
> 时间：2008-10-15T14:31:24.430
> 
> 标签：c#, sql-server, localsystem

我们有一个从命令行安装 SQL Server Express 并通过参数 SQLACCOUNT="NT AUTHORITY\SYSTEM" 将服务帐户指定为 LocalSystem 帐户的应用程序。

这不适用于不同的语言，因为 LocalSystem 的帐户名称不同。有一个表格列出了这里的差异：

[http://forums.microsoft.com/MSR/ShowPost.aspx?PostID=685354&SiteID=37](http://forums.microsoft.com/MSR/ShowPost.aspx?PostID=685354&SiteID=37)

这似乎并不完整（未列出瑞典语版本）。所以我希望能够以编程方式确定名称，也许使用 SID？

我找到了一些 VB 脚本来执行此操作：

```
Set objWMI = GetObject("winmgmts:root\cimv2") 

Set objSid = objWMI.Get("Win32_SID.SID='S-1-5-18'") 

MsgBox objSid.ReferencedDomainName & "\" & objSid.AccountName 
```

有谁知道可以在 C# 中使用的等效代码？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-15T14:49:27.203

为此，您可以使用 .NET 的内置[System.Security.Principal.SecurityIdentifier类：通过将其转换为](http://msdn.microsoft.com/en-us/library/system.security.principal.securityidentifier.aspx)[NtAccount](http://msdn.microsoft.com/en-us/library/system.security.principal.ntaccount.aspx)的实例，您可以获得帐户名称：

```
using System.Security.Principal;

SecurityIdentifier sid = new SecurityIdentifier("S-1-5-18");
NTAccount acct = (NTAccount)sid.Translate(typeof(NTAccount));
Console.WriteLine(acct.Value); 
```

稍后编辑，以回应评论中的问题：您不需要任何特殊权限即可在本地计算机上进行 SID-to-name 查找 - 例如，即使您运行的用户帐户仅在 Guest 组中，这段代码应该可以工作。如果 SID 解析为域帐户，情况会有所不同，但即使在大多数情况下，只要您登录到域（并且在查找时域控制器可用），它也应该可以正常工作.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-10T12:59:46.293

或者您可以使用：

```
string localSystem = new SecurityIdentifier(WellKnownSidType.LocalSystemSid, null).Translate(typeof(NTAccount)).Value; 
```

例如，`WellKnownSidType`您可以查找其他帐户。`NetworkService`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T14:34:37.840

这应该与您发布的内容类似。我不确定如何立即获取 WMI 对象的特定属性，但这将使您开始使用以下语法：

```
ManagementObject m = new ManagementObject("winmgmts:root\cimv2");
m.Get();
MessageBox.Show(m["Win32_SID.SID='S-1-5-18'"].ToString()); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-21T14:29:58.797

接受答案的问题是帐户名必须可由运行代码的本地机器解析。

如果您在远程机器上读取 ACL，您可能无法解析远程机器上的域 SID/本地 SID。以下使用 WMI 并获取远程机器的参数和您希望远程机器解析的 SID。

```
/// <summary>
/// Returns the Account name for the specified SID 
// using WMI against the specified remote machine
/// </summary>
private string RemoteSID2AccountName(String MachineName, String SIDString)
{
    ManagementScope oScope = new ManagementScope(@"\\" + MachineName +     
       @"\root\cimv2");
    ManagementPath oPath = new ManagementPath("Win32_SID.SID='" + SIDString + "'");
    ManagementObject oObject = new ManagementObject(oScope, oPath, null);
    return oObject["AccountName"].ToString();
} 
```

# visual-studio - 氪表没有出现在 Visual Studio Professional 2008 中

> ID：204950
> 
> 赞同：1
> 
> 时间：2008-10-15T14:33:22.993
> 
> 标签：visual-studio, krypton-toolkit

我刚刚从组件工厂安装了 Krypton Toolkit 3.0.6。我发现在 create new Project Dialog Box 中，Krypton Form 没有显示为选项。我确信它曾经出现过（而且我实际上已经在早期版本的 krypton 工具包中使用过它）。但是在新安装之后它没有。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T11:50:46.690

为了完整性和准确性，我发布了从氪金形式继承的实际代码。

```
public partial class Form1  : ComponentFactory.Krypton.Toolkit.KryptonForm 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T14:54:17.850

“New Krypton Form”过去不是出现在“新项目”对话框中，而是出现在“新项目”对话框中。（例如右键单击项目，添加新项目）

但我在那里也看不到。Phil 可能已将其从安装程序中删除。

在任何情况下，只需添加一个常规 Form，然后让它从 KryptonForm 而不是 Form 派生，瞧，你有自己的 KryptonForm。

# asp.net - Asp.Net - 添加选项以在客户端选择...表单提交时代码中没有值

> ID：204963
> 
> 赞同：2
> 
> 时间：2008-10-15T14:37:05.730
> 
> 标签：asp.net, client-side

我对某事感到很困惑。我有 2 个选择列表，如果您在第一个中选择一个选项，然后我会使用一组选项加载第二个。每次更改第一个选择元素中的选择时，我都会清除它并重新填充它。现在，在回发时，我需要知道在第二个选择元素中选择的选项的值，但它始终显示为 -1。

我确定我错过了一些基本的和愚蠢的东西，但有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T14:39:01.593

我实际上并没有看到代码，但可能发生的情况是您在实际查看值之前清除它，可能在您的 Page_Load 中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-15T14:45:38.007

您是否说您使用客户端代码而不是服务器端代码将项目添加到右侧列表？

如果是这样，您将需要捕获手动发布的表单项 (Request.Form) 并使用这些新详细信息填充列表项。或者至少那是我脑海中的记忆。

如果您发布更多关于它是服务器端还是客户端添加到列表框的详细信息，我相信有更多时间的人可以给您答案。

# java - 如何在固定字符序列上拆分字符串？

> ID：204970
> 
> 赞同：-1
> 
> 时间：2008-10-15T14:40:11.823
> 
> 标签：java, string, split

假设我有以下字符串：

```
String asd = "this is test ass this is test" 
```

我想使用“ass”字符序列分割字符串。

我用了：

```
asd.split("ass"); 
```

它不起作用。我需要做什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-15T14:47:10.000

这对我来说似乎很好用：

```
public class Test
{
    public static void main(String[] args) {
        String asd = "this is test ass this is test";
        String[] bits = asd.split("ass");
        for (String bit : bits) {
            System.out.println("'" + bit + "'");
        }
    }
} 
```

结果：

```
'this is test '
' this is test' 
```

你真正的分隔符可能不同吗？不要忘记 split 使用它的参数作为正则表达式......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-27T09:42:36.043

```
String asd = "this is test foo this is test";
String[] parts = asd.split("foo"); 
```

试试这个它会工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T14:51:27.417

```
public class Splitter {

    public static void main(final String[] args) {
        final String asd = "this is test ass this is test";
        final String[] parts = asd.split("ass");
        for (final String part : parts) {
            System.out.println(part);
        }
    }
} 
```

印刷：

```
this is test 
 this is test 
```

在 Java 6 下。您期待什么输出？

# .net - WMI - 一般故障

> ID：204973
> 
> 赞同：0
> 
> 时间：2008-10-15T14:40:15.007
> 
> 标签：.net, wmi

我们有一个 .NET 应用程序，它使用 WMI 收集整个网络中机器上的各种信息，例如读取 Win32_NTLogEvent 以查看 Symantec Antivirus 是否编写了任何内容。查询工作正常，但在重复运行 WMI 查询后，“通用故障”错误将开始出现。这在大约之后非常一致地发生。125 个电话。重新启动我们正在对其运行 WMI 查询的机器，始终可以修复错误……直到运行下一个 125 个查询。

看起来存储库很好，我们找不到任何日志文件大小问题。

更多信息 - 得到错误后运行 WMIDiag 并发现 -

25607 13:55:38 (1)！！错误：WMI 枚举操作错误报告：2 错误！

25608 13:55:38 (0) ** - ROOT/CIMV2, SubClassesOf, '*', 0x80041006 - (WBEM_E_OUT_OF_MEMORY) 没有足够的内存用于操作。

25609 13:55:38 (0) ** MOF 注册：'C:\WINNT\SYSTEM32\WBEM\SNMPREG.MOF' 25610 13:55:38 (0) ** - Root/CIMv2、InstancesOf、'Win32_PerfFormattedData_PerfProc_Thread'、 0x8007000E - 没有足够的存储空间来完成此操作。

25611 13:55:38 (0) ** MOF 注册：'C:\WINDOWS\SYSTEM32\WBEM\WMI.MOF'

有人见过这个吗？想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T15:22:13.457

我们在不同的 WMI 查询中多次看到“通用故障”错误，因此我们基本上得出的结论是 WMI 不够稳定，无法用于原始管理以外的任何事情。经过几个月的混乱，我们唯一的解决方案是拉取所有 WMI 调用并在纯 API 调用中找到替换。他们总是会工作一段时间，然后因“通用错误”而失败（我知道这不是一个答案，但这是一个共同的经验，如果有人有答案，我会很高兴听到它）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T14:53:23.230

我相信我们已经找到了问题所在。为了简化我们的一些查询，我们在 where 子句中添加了类似 1=1 的内容，以简化查询的构建。删除了常量 = 常量，我测试的一个查询从 40 秒缩短到了 0.4 秒，并且运行了 10,000 多次而没有产生一般故障 (WBEM_E_OUT_OF_MEMORY)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-13T07:51:10.183

Windows 远程管理 (WinRM) 可以克服所有这些问题。WinRM 是 WS-Management 协议的 Microsoft 实现，它是一种基于标准的简单对象访问协议 (SOAP)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T09:30:18.823

尝试通过 WMI 在远程计算机上卸载/安装软件时，我遇到了类似的问题。

当您的漫游配置文件出现在目标机器上时，就会出现问题。这可能是由于之前已在目标计算机上查询过 WMI。

我不知道这是否是同一个问题，但在尝试卸载软件之前，我必须检查一下我的配置文件是否在目标机器上的 Documents and Settings 文件夹中。

我假设当您运行查询时，它会在本地计算机上创建您的配置文件。

每当我尝试在我以前在远程工作过的机器上卸载软件时，我都会收到一条通用故障消息。

现在，我确保在尝试远程卸载/安装软件组件之前，我的配置文件已从目标计算机中删除。从那以后我没有任何问题。

希望这对任何人都有帮助。

# html - JSP 中的 TinyMCE（Struts 应用程序）

> ID：204975
> 
> 赞同：1
> 
> 时间：2008-10-15T14:40:32.370
> 
> 标签：html, jsp, struts, tinymce

我需要使用哪个下载来在 JSP（Struts 应用程序）中使用 TinyMCE

我看到主包、开发包以及不同的压缩包。

我正在尝试为我们的应用程序中的文本区域实现富文本编辑器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T15:22:23.453

压缩包只是主包的压缩版本——你应该小心使用它们，因为它们会导致客户端的大量负载。开发包可能是代码的不稳定版本，因此您可能应该使用主包以确保安全。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T19:29:54.673

我让它工作了。回答我自己的问题：我们需要将整个文件夹复制到项目中，并按照网站中的示例编辑 Jsp。

我使用了主包。

# c++ - static const Member Value vs. Member enum：哪种方法更好？为什么？

> ID：204983
> 
> 赞同：46
> 
> 时间：2008-10-15T14:42:33.287
> 
> 标签：c++, class-design

如果您想将某个常量值与一个类相关联，这里有两种方法可以实现相同的目标：

```
class Foo
{
public:
    static const size_t Life = 42;
};

class Bar
{
public:
    enum {Life = 42};
}; 
```

从客户的角度来看，它们在句法和语义上似乎是相同的：

```
size_t fooLife = Foo::Life;
size_t barLife = Bar::Life; 
```

除了纯粹的风格问题之外，还有什么理由会比另一种更受欢迎吗？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-10-15T14:46:35.353

hack 曾经是必要的`enum`，因为许多编译器不支持值的就地初始化。由于这不再是问题，请选择其他选项。现代编译器还能够优化此常量，使其不需要存储空间。

不使用变体的唯一原因`static const`是如果您想*禁止*获取值的地址：您不能获取`enum`值的地址而可以获取常量的地址（这会提示编译器保留空间毕竟是值，但前提*是*它的地址确实被占用了）。

*此外，除非也明确定义*了常量，否则获取地址将产生链接时错误。请注意，它仍然可以在声明的位置进行初始化：

```
struct foo {
    static int const bar = 42; // Declaration, initialization.
};

int const foo::bar; // Definition. 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-15T14:46:19.957

它们不相同：

```
size_t *pLife1 = &Foo::Life;
size_t *pLife2 = &Bar::Life; 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-15T14:50:18.527

一个区别是枚举定义了一种可以用作方法参数的类型，例如，以获得更好的类型检查。两者都被编译器视为编译时常量，因此它们应该生成相同的代码。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-17T05:47:29.417

`static const`值被视为 r 值，就像`enum`您将看到的 99% 的代码一样。常量 r 值永远不会为它们生成内存。优势`enum`常数是它们不能成为另外 1% 的 l 值。这些`static const`值是类型安全的，并允许浮点数、c 字符串等。

`Foo::Life`如果编译器具有与之关联的内存，则编译器将生成一个左值。通常的方法是获取它的地址。例如`&Foo::Life;`

这是 GCC 将使用该地址的一个微妙示例：

```
int foo = rand()? Foo::Life: Foo::Everthing; 
```

编译器生成的代码使用 和 的`Life`地址`Everything`。更糟糕的是，这只会产生关于 和 的缺失地址的链接器`Foo::Life`错误`Foo::Everything`。这种行为完全符合标准，尽管显然是不可取的。还有其他编译器特定的方式可以发生这种情况，并且所有标准都符合。

一旦你有一个符合要求的 c++11 编译器，正确的代码将是

```
class Foo {
 public:
  constexpr size_t Life = 42;
}; 
```

这保证始终是一个左值，并且它是类型安全的，两全其美。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-15T14:47:32.807

好吧，如果需要，您可以获取静态 const 成员值的地址。您必须声明一个单独的枚举类型的成员变量来获取它的地址。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-15T22:30:01.173

## 另一个第三种解决方案？

一个细微的区别是枚举必须在标题中定义，并且对所有人可见。当您避免依赖时，这很痛苦。例如，在 PImpl 中，添加枚举会适得其反：

```
// MyPImpl.hpp

class MyImpl ;

class MyPimpl
{
   public :
      enum { Life = 42 } ;
   private :
      MyImpl * myImpl ;
} 
```

另一个**第三种解决方案**是问题中提出的“const static”替代方案的变体：在标头中声明变量，但在源代码中定义它：

```
// MyPImpl.hpp

class MyImpl ;

class MyPimpl
{
   public :
      static const int Life ;
   private :
      MyImpl * myImpl ;
} 
```

.

```
// MyPImpl.cpp
const int MyPImpl::Life = 42 ; 
```

请注意，MyPImpl::Life 的值对 MyPImpl 的用户（包括 MyPImpl.hpp）是隐藏的。

这将使 MyPimpl 作者能够根据需要更改“Life”的值，而无需 MyPImpl 用户重新编译，这是 PImpl 的总体目标。

# cvs - 从 CVS 中删除空目录？

> ID：204991
> 
> 赞同：36
> 
> 时间：2008-10-15T14:45:04.030
> 
> 标签：cvs

我不太确定这是怎么发生的，但不知何故，一个完全空的目录层次结构最终出现在我的存储库中：

```
com/
com/companyname/
com/companyname/blah/
com/sun/
com/sun/java/
com/sun/java/jax_rpc_ri/ 
```

我认为发生的事情是这些目录中确实有文件，但后来开发人员意识到他/她不应该首先签入它们，因为这些是构建过程的副产品，所以他/她删除了文件，但不知何故，空目录作为古代遗物留在存储库中。

如何从 CVS 中删除它？我似乎能够在谷歌上找到的唯一结果是不需要删除空目录，因为 CVS 首先不会保留它们，并且`-P`(prune) 选项`cvs update`应该将它们从工作目录 - 如果您的存储库中实际上有空目录，这将是零帮助。

A`cvs remove`并且`cvs commit`似乎没有处理这种情况：

```
$ cvs remove -Rf com
cvs remove: Removing com
cvs remove: Removing com/companyname
cvs remove: Removing com/companyname/blah
cvs remove: Removing com/sun
cvs remove: Removing com/sun/java
cvs remove: Removing com/sun/java/jax_rpc_ri
$ cvs commit com
cvs commit: Examining com
cvs commit: Examining com/companyname
cvs commit: Examining com/companyname/blah
cvs commit: Examining com/sun
cvs commit: Examining com/sun/java
cvs commit: Examining com/sun/java/jax_rpc_ri
$ ls -l com
total 24
drwxrwxr-x  2 matt matt 4096 Oct 15 14:38 CVS
drwxrwxr-x  9 matt matt 4096 Oct 15 14:38 companyname
drwxrwxr-x  4 matt matt 4096 Oct 15 14:38 sun 
```

它还在那里！

SVN 也有这种奇怪的行为吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-10-15T14:54:04.603

AFAIK CVS 协议不允许删除目录。您应该转到服务器控制台并将它们从真实的物理存储库中删除。

* * *

[http://www.network-theory.co.uk/docs/cvsmanual/Removingdirectories.html](http://www.network-theory.co.uk/docs/cvsmanual/Removingdirectories.html)

> **您不会删除目录本身；没有办法做到这一点。**

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-10-15T14:55:45.130

CVS 签出和更新总是会签出空目录；这就是 CVS 的构建方式。使用 "-P" -- "prune" -- 进行更新以删除空目录：

```
cvs update -dP 
```

（添加“-d”将更新自上次更新后出现的新目录；否则，CVS 将忽略它们。）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-11-04T14:03:57.997

刚做了

1.  rm -rvf /localCopy/project/emptyDirectory
2.  编辑/localCopy/project/CVS/Entries，删除行D/emptyDirectory////，保存文件
3.  rmdir -v /CVSROOT/project/emptyDirectory

摆脱项目中的emptyDirectory。承认弄乱内部 CVS 数据是不合法的，但似乎有效（cvs 版本 1.12.13）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-15T15:25:32.480

CVS 有许多设计缺陷，永远无法在不丢失历史记录的情况下摆脱目录就是其中之一。在不丢失历史记录的情况下重命名文件和目录是另一个问题。

考虑毕业到[Subversion](http://subversion.tigris.org/)。 [cvs2svn](http://cvs2svn.tigris.org/)在转换包括所有分支和标签的存储库方面做得非常好。CVS 和 SVN 命令集非常相似，只需要很少的调整。（为了防止这成为“你应该使用什么版本控制”之战）一旦你使用了 SVN，你就可以转移到任何数量的更高级的版本控制系统，比如[git](http://git.or.cz/)或[SVK](http://svk.bestpractical.com/view/HomePage)。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-10-08T12:47:38.323

这对我有用。基本上当你做

**rmdir -v /CVSROOT/project/emptyDirectory** # 我们正在从 CVS 存储库目录中删除目录。

如果您具有存储库 unix 服务器登录访问权限，则可以前往该路径并删除该目录，或者向 unix 团队提出同样的问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-15T15:07:47.727

cvs 倾向于对目录采用两阶段方法，这就是为什么许多 cvs 命令有一个 -P 选项来“修剪空目录”。

发生这种情况时，例如要重命名我刚刚添加的目录，我删除该目录，删除 CVS/Entries 文件中目录的条目，它将是一个以“D”开头的行。

任务完成。

如果我已经提交，我确保包含空目录/ies 的当前工作区都已签入。然后我将添加目录的工作区部分吹走。

例如，在

```
~/Sandbox/my_project/some_stuff_i_want
~/Sandbox/my_project/empty_dir_1
~/Sandbox/my_project/other_stuff_i_want 
```

我确保两个目录中的所有内容都是最新的，其中包含我想要保留的内容。然后我从我的沙箱中吹走 my_project。

**然后我从存储库本身**中删除空目录。

返回并检查相同的工作区，例如 my_project 将为我提供没有空目录的工作区。

或者只是保留所有内容并使用 -P 选项让 CVS 检查所有内容（或更新所有内容），然后删除空目录。

高温高压

干杯，

抢

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-01-27T10:58:59.127

您无法从工作区中删除目录，您需要将其从保存实际存储库的服务器中删除。但是您可以使用 cvs remove 命令从目录中删除文件。******