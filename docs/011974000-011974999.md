# StackOverflow 问答 11974000-11974999

# php - 使用 HTML-ENTITIES 字符集替代 mb_convert_encoding

> ID：11974008
> 
> 赞同：10
> 
> 时间：2012-08-15T17:22:07.377
> 
> 标签：php, string, character-encoding

我有以下代码：

```
mb_convert_encoding($string, 'HTML-ENTITIES', 'utf-8'); 
```

我需要一个替代代码，它完全一样但不使用任何 mb_* 函数（mb 扩展在某些环境中不可用）。

我以为

```
utf8_decode(htmlentities($string, ENT_COMPAT, 'utf-8')); 
```

应该完全一样，但不幸的是它没有。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-15T22:41:24.463

我玩了一会儿，发现这很有趣。似乎第二部分也运行“htmlspecialchars”。必须是 mb_convert_encoding 中的一些错误，因为 htmlentities 没有正确运行。

如果您对结果运行 htmlspecialchars_decode，您将获得与使用 mb_convert_encoding 完全相同的结果。

编码：

```
$string = 'Test:!"$%&/()=ÖÄÜöäü<<';
echo mb_convert_encoding($string, 'HTML-ENTITIES', 'utf-8')."\n\n";
echo htmlspecialchars_decode(utf8_decode(htmlentities($string, ENT_COMPAT, 'utf-8', false))); 
```

这里是上面代码的演示：http: [//sandbox.onlinephpfunctions.com/code/715acade3b8337d9c9e48e58deee2a237015c259](http://sandbox.onlinephpfunctions.com/code/715acade3b8337d9c9e48e58deee2a237015c259)

这里有一个没有 htmlspecialchars_decode 的演示，以显示您的问题： [http ://sandbox.onlinephpfunctions.com/code/5c4a32bf99aa8fd6246c4a77132a023d32945363](http://sandbox.onlinephpfunctions.com/code/5c4a32bf99aa8fd6246c4a77132a023d32945363)

# mysql - MySQL - 如何从嵌套选择中删除

> ID：11974012
> 
> 赞同：0
> 
> 时间：2012-08-15T17:22:20.127
> 
> 标签：mysql, sql

大家好，我在这里有关于如何进行嵌套选择的代码，现在我的问题是我想删除嵌套选择中的一些文件，但我不知道如何..

```
SELECT title, 
       filename, 
       jono, 
       client, 
       dt, 
       remarks 
FROM   ((SELECT doc_title    AS title, 
                doc_filename AS filename, 
                doc_jono     AS jono, 
                doc_client   AS client, 
                doc_date     AS dt, 
                remarks 
         FROM   tbl_doc) 
        UNION 
        (SELECT wbok_title    AS title, 
                wbok_filename AS filename, 
                wbok_jono     AS jono, 
                wbok_client   AS client, 
                wbok_date     AS dt, 
                wbok_remarks  AS remarks 
         FROM   tbl_wbok) 
        UNION 
        (SELECT cad_title    AS title, 
                cad_filename AS filename, 
                cad_jono     AS jono, 
                cad_client   AS client, 
                cad_date     AS dt, 
                cad_remarks  AS remarks 
         FROM   tbl_cad) 
        UNION 
        (SELECT oth_title    AS title, 
                oth_filename AS filename, 
                oth_jono     AS jono, 
                oth_client   AS client, 
                oth_date     AS dt, 
                oth_remarks  AS remarks 
         FROM   tbl_oth)) AS t1 
ORDER  BY title 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T17:26:42.793

您不能从此 SELECT 中执行此操作，因为它包含 UNION；您必须单独为每个表执行 DELETE。

顺便说一句，您的四个表应该是一个表。包括一个包含 DOC、WBOK、CAD 或 OTHER 的 CATEGORY 字段；这样您就可以区分您的四个数据集。这样做会大大简化你的整体逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T17:26:53.360

这个的一般形式是

```
DELETE FROM table tbl
    WHERE tbl.id = (SELECT id FROM [ your query here] ) 
```

如果你有一张桌子

```
CREATE TABLE Foo (bar integer PRIMARY KEY) 
```

那么这将是

```
DELETE FROM table tbl
    WHERE tbl.id = (SELECT id FROM table ... JOIN ..  WHERE X=y etc.. ) 
```

如果你的情况，如果你想删除 UNION 中的东西，你必须一个一个地做，因为你一次只能***从***一个表中删除。

所有表的数据结构都相同。Robert Harvey 建议您创建一个带有名为“CATEGORY”的附加列的单个表，该列对数据曾经所在的表进行编码。这通常是一个好主意，它会使您的删除更容易

# php - PHP停止睡眠

> ID：11974017
> 
> 赞同：0
> 
> 时间：2012-08-15T17:22:48.223
> 
> 标签：php, sleep

我有一个脚本使用`sleep(1);`了大约 20 次，但我需要知道如何停止 sleep()。

这是我的例子：

```
<?php
for($i=0;$i<20;$i++){
echo "hi";
sleep(1);
if ($whatever == "stop")break;
}
?> 
```

无论用户检查什么，这都是用于聊天的机器人脚本，所以 $whatever 用户消息，如果它是“停止”，sleep() 就会停止。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T17:25:59.697

```
for($i=0; $i<20; $i++) {
    echo "hi";
    if ($whatever != "stop") {
        sleep(1);
    }
} 
```

# ssis - 2012 SSIS 包的行为因环境而异

> ID：11974020
> 
> 赞同：2
> 
> 时间：2012-08-15T17:22:55.223
> 
> 标签：ssis, sql-server-2012

我们在开发虚拟机上开发了一个 2012 SSIS 包，该虚拟机在 VS 2010 和通过 2012 服务器上的集成服务目录成功端到端运行。当我们在与我们的开发虚拟机具有相同映像的暂存虚拟机上运行完全相同的 SSIS 包时，它在各种任务上都会失败。两个 VM 之间的唯一区别是我们在连接管理器中指向的服务器。但是，该问题与端点或数据无关，而与 SSIS 实际运行任务的方式有关。在我们的几个数据流任务中，我们使用 OLE DB 源组件并使用需要参数的 Sql 命令。在我们所有的查询中，我们都放置了注释标题。在我们的开发虚拟机上，这工作正常......没有问题。从登台 VM 运行时，它无法解析查询以确定参数。另一个示例来自我们正在提取的执行 SQL 组件`@@DBTS`并将其转换为 bigint （即`SELECT CAST(@@DBTS AS bigint)`）。这被放入字符串类型的 SSIS 变量 (CurrentTimeStamp) 中。然后我们将它传递给另一个执行 SQL 组件，该组件调用一个存储过程，该过程采用变量 (CurrentTimeStamp)，但在参数映射中，我们将输入作为 LONG 数据类型传递。同样，这在我们的开发虚拟机中运行良好，但在暂存虚拟机中却不行。我们收到以下错误：“将结果提取到类型为 (DBTYPE_I4) 的变量时发生错误”。可能的失败原因： 查询问题。“ResultSet”属性设置不正确、参数设置不正确或连接未正确建立。

我比较了操作系统版本、补丁和安装的软件。与下面列出的唯一区别：

*   开发虚拟机暂存虚拟机
*   缺少 Microsoft Team Foundation Server 2010 - ENU v10.0.40219
*   Microsoft Visual C++ 2008 Redistributable - x64 9.0.3.0729.4148 缺失
*   Microsoft Visual C++ 2008 Redistributable - x86 9.0.3.0729.4148 缺失
*   缺少 Microsoft Visual C++ 2008 Redistributable - x64 9.0.3.0729.4974

如果其他人经历过类似的事情，您可能提供的任何指导将不胜感激。我们的下一步是向 MS 开一张支持票，因为这只是一个令人头疼的问题。

在此先感谢，安东尼

***编辑...这个问题已经解决。请参阅下面的摘要。***

问题一：

++我们有一个执行 Sql 任务，它返回一个数据库时间戳值，该值存储在一个 LONG 类型的变量中。该任务在 DEV 服务器上有效，但在 PROD 服务器上失败。在 PROD Server 中，如果我们将 SSIS 变量类型更改为 ULONG，则任务成功。

我们发现在 PROD 中，返回值是一个很大的数字，导致 LONG 数据类型溢出。在 DEV 中，我们的值较小，问题没有发生。我研究并检查了 ULONG 最大值归结为 UInt64.MaxValue ，它非常大，应该足以满足您的要求。（最大值为：18,446,744,073,709,551,615）

[http://msdn.microsoft.com/en-us/library/system.uint64.maxvalue.aspx](http://msdn.microsoft.com/en-us/library/system.uint64.maxvalue.aspx)

问题 2：

++我们有一个触发 Sql 命令的 OLE DB 源。如果我们在查询顶部添加注释，它可以在 DEV 服务器上运行，但在 PROD 服务器上解析时验证失败，并出现错误：无法从 SQL 命令中提取参数。提供程序可能无法帮助解析命令中的参数信息。在这种情况下，请使用“来自变量的 SQL 命令”访问模式，其中整个 SQL 命令都存储在一个变量中。

* * *

附加信息：

语法错误、权限冲突或其他非特定错误 (Microsoft SQL Server Native Client 11.0)

我们发现评论解析能力实际上是在执行查询的后端查询引擎上，而不是特定于 SSIS。在我们的 DEV 中，我们针对解析良好的 Sql 2012 实例触发查询（带有注释）。在失败的 PROD 服务器中，查询是针对无法解析注释的 Sql 2008 R2 实例执行的。如果我们将 PROD 中的连接管理器更改为指向 Sql 2012 实例并使用注释触发相同的查询，则它解析得很好。

# c# - 实体框架维护外键关系

> ID：11974022
> 
> 赞同：1
> 
> 时间：2012-08-15T17:23:09.720
> 
> 标签：c#, entity-framework, foreign-keys, foreign-key-relationship

我有一个包含多个外键关系的单一位置表。它具有状态表、城市表、国家表和用户表的外键。现在我在 Entity 框架中正确映射了表模型，但是如果我尝试访问 Location 表中的外键 id 字段以添加新的外键映射，我无法访问它，而是得到一个 Reference 字段，例如**StateReference** .

现在我发现一些文章说，只需使用 entitykey.StateReference。我试过了，它可以工作，但对我来说似乎很笨拙。我注意到的是，它还为我提供了一个字段 State 而不是 StateID。因此，据此我假设人们只能将状态名称传递给 Location 对象，而实体框架几乎会自动计算出这种关系。我无法在任何地方找到或找出正确的语法。

如果我在这里偏离基地，有人可以指出正确的方向并纠正我吗？我已经为此苦苦挣扎了一段时间，似乎无法理解。或者，如果我说的是正确的，有人可以给我一些基本代码来显示语法。我正在 VS2010 中制作 Web 服务，所以如果我理解正确，我将使用 ef v1。下面是我的位置对象的代码。

```
 using(Entities context = new Entities())
     {
       Location NewLocation = new Location
        {
          //In SQL all three of these field are acutally foreign key ids I am 
             trying to maintian
          State = context.States.Where(i => i.State1.Equals(AddedState)),
          Country = context.Countries.Where(i => i.State1.Equals(AddedCountry)),
          City = context.Cities.Where(i => i.City1.Equals(AddedCity)),
         }
      };
      context.AddToLocation(NewLocation);
      context.SaveChanges();
     } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T23:29:43.633

正确的语法应该是：

```
using(Entities context = new Entities())
{
    Location NewLocation = new Location
    {
      State = context.States.SingleOrDefault(s => s.ID == AddedState.ID),
      Country = context.Countries.SingleOrDefault(c => c.ID == AddedCountry.ID),
      City = context.Cities.SingleOrDefault(c => c.ID == AddedCity.ID)
    };
    context.AddToLocation(NewLocation);
    context.SaveChanges();
} 
```

（假设调用了主键属性`ID`）

顺便说一句：使用 VS2010 并不一定意味着您使用的是 EF 版本 1。重要的是您的项目的 .NET Framework 目标平台：如果项目以 .NET 3.5 为目标，则您使用的是 EF 版本 1。如果项目以 .NET 4.0 为目标，您正在使用 EF 版本 4。（版本 2 和 3 不存在。）在 VS2010 中创建新项目时，默认目标平台是 .NET 4.0。因此，除非您将目标平台明确更改为 .NET 3.5（或将旧项目从 VS2008 迁移到 VS2010），否则您更有可能使用 EF 4.0。

正如 Tod 在您的问题下方的评论中所提到的，使用 EF 4.0，您可以选择在从现有数据库模式创建/更新模型时将外键列公开为模型属性。在更新向导中有一个复选框“*在模型中包含外键列*”：

![更新向导](../Images/16743fb279fb24bf9ad2f753bbc82121.png)

**编辑**

如果`AddedState`和是表示实体属性的字符串，则`AddedCountry`可以将查询替换为查询：`AddedCity``Name``ID``Name`

```
using(Entities context = new Entities())
{
    Location NewLocation = new Location
    {
      State = context.States.SingleOrDefault(s => s.Name == AddedState),
      Country = context.Countries.SingleOrDefault(c => c.Name == AddedCountry),
      City = context.Cities.SingleOrDefault(c => c.Name == AddedCity)
    };
    context.AddToLocation(NewLocation);
    context.SaveChanges();
} 
```

请注意，使用`SingleOrDefault`假设`Name`是在数据库表中是唯一的。如果有两条或多条同名记录`SingleOrDefault`将抛出异常（“序列包含多个元素”）。`SingleOrDefault`您可以在那时替换`FirstOrDefault`为仅加载具有给定名称的第一条记录。

# c# - 向 XML 文件添加注释并使用 C# 读入

> ID：11974023
> 
> 赞同：1
> 
> 时间：2012-08-15T17:23:09.543
> 
> 标签：c#, xml, comments

我正在开发 ac# 控制台应用程序，它有一个包含程序设置的 xml 配置文件。

我想在 xml 文件中添加注释，以显示可以使用`<!--My Comment-->`. 出于某种原因，当我把它放进去时，就好像 C# 认为这是文件的结尾并且没有读取文件的其他部分，没有抛出错误并且程序没有停止响应它继续运行其余部分的代码。

下面是配置文件。

```
<?xml version="1.0" encoding="utf-8" ?>
<options>
  <database>
    <item key="server" value="localhost" />
    <item key="database" value="emailserver" />
    <item key="username" value="myusername" />
    <item key="password" value="mypassword" />
    <item key="port" value="3306" />
  </database>
  <EmailServer>
    <item key="logFile" value="email_server.txt" />
    <!--You can use fileCopy or database-->
    <item key="logManageMode" value="fileCopy" />
    <item key="ip_address" value="127.0.0.1" />
    <item key="smtpPort" value="26" />
    <item key="requireAuthentication" value="false" />
  </EmailServer>
</options> 
```

如果我不将该评论放入其中，它将读入整个文件。下面是读取 XML 文件的代码。

```
public Dictionary<string, string> readConfig(string sectionName, bool soapService=false, Dictionary<string, string> config=null)
        {
            Dictionary<string, string> newConfig = null;
            if (config == null)
            {
                newConfig = new Dictionary<string, string>();
            }
            //Dictionary<string, string> config = new Dictionary<string, string>();
            try
            {
                XmlDocument configXml = new XmlDocument();
                string configPath = "";
                if (soapService)
                {
                    string applicationPath = HttpContext.Current.Server.MapPath(null);
                    configPath = Path.Combine(applicationPath, "config.xml");
                    configXml.Load(configPath);
                }
                else
                {
                    configXml.Load("config.xml");
                }

                XmlNodeList options = configXml.SelectNodes(string.Format("/options/{0}", sectionName));
                XmlNodeList parameters = configXml.GetElementsByTagName("item");
                foreach (XmlNode option in options)
                {
                    foreach (XmlNode setting in option)
                    {
                        string key = setting.Attributes["key"].Value;
                        string value = setting.Attributes["value"].Value;

                        if (config == null)
                        {
                            newConfig.Add(key, value);
                        }
                        else
                        {
                            config.Add(key, value);
                        }
                    }
                }
            }
            catch (KeyNotFoundException ex)
            {
                Console.WriteLine("Config KeyNotFoundException: {0}", ex.Message);
            }
            catch (XmlException ex)
            {
                Console.WriteLine("Config XmlException: {0}", ex.Message);
            }
            catch (Exception ex)
            {
                Console.WriteLine("Config Exception: {0}", ex.Message);
                Console.WriteLine("StackTrace: {0}", ex.StackTrace);
            }
            if (config == null)
            {
                return newConfig;
            }
            return config;
        } 
```

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T17:27:04.220

您的评论是一个节点。所以当你遍历节点时：

```
 foreach (XmlNode option in options) 
                 { 
                     foreach (XmlNode setting in option) 
                     { 
                         string key = setting.Attributes["key"].Value; 
                         string value = setting.Attributes["value"].Value; 
```

您在 commebnt 处触发了 try/catch 块，因为该节点不包含“键”或“值”属性。

您可以使用该[`NodeType`](http://msdn.microsoft.com/en-us/library/system.xml.xmlnode.nodetype.aspx)属性来确定节点是否为评论。例如：

```
 foreach (XmlNode option in options) 
                 { 
                     foreach (XmlNode setting in option) 
                     { 
                         if (setting.NodeType == XmlNodeType.Comment)
                         {
                             continue;
                         }
                         string key = setting.Attributes["key"].Value; 
                         string value = setting.Attributes["value"].Value; 
```

如果节点不是元素，另一种选择是继续：

```
if (setting.NodeType != XmlNodeType.Element) 
```

根据 Tomalak：实际上这与 OP 的原始代码一样脆弱。在 XML 中插入与注释不同的节点类型，它将再次爆炸。只需在循环中选择一个特定的 XmlNodeList： `XmlNodeList settings = option.SelectNodes("item[@key and @value]");`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T17:47:54.967

这是您的代码的一个版本，它不会阻塞未知的 XML 节点类型，而且更短一些。

关键是您不能简单地遍历子节点列表并期望节点是特定的。

如果您想在特定节点上工作，请始终选择特定的东西 - 在这种情况下，名称`item`包含一个`@key`和一个属性的元素节点。`@value`

```
XmlNodeList settings = option.SelectNodes("./item[@key and @value]"); 
```

这是完整的代码：

```
public Dictionary<string, string> readConfig(string sectionName, bool soapService=false, Dictionary<string, string> config=null)
{
    Dictionary<string, string> myConfig = config ?? new Dictionary<string, string>();
    try
    {
        XmlDocument configXml = new XmlDocument();
        string configPath = "config.xml";
        if (soapService)
        {
            string applicationPath = HttpContext.Current.Server.MapPath(null);
            configPath = Path.Combine(applicationPath, "config.xml");
        }
        configXml.Load(configPath);

        XmlNodeList options = configXml.SelectNodes(string.Format("/options/{0}", sectionName));
        foreach (XmlNode option in options)
        {
            XmlNodeList settings = option.SelectNodes("./item[@key and @value]");
            foreach (XmlNode setting in settings)
            {
                myConfig.Add(setting.Attributes["key"].Value, setting.Attributes["value"].Value);
            }
        }
    }
    catch (KeyNotFoundException ex)
    {
        Console.WriteLine("Config KeyNotFoundException: {0}", ex.Message);
    }
    catch (XmlException ex)
    {
        Console.WriteLine("Config XmlException: {0}", ex.Message);
    }
    catch (Exception ex)
    {
        Console.WriteLine("Config Exception: {0}", ex.Message);
        Console.WriteLine("StackTrace: {0}", ex.StackTrace);
    }
    return myConfig;
} 
```

# c# - 在asp.net c#上的gridview上更改行或记录的颜色？

> ID：11974025
> 
> 赞同：2
> 
> 时间：2012-08-15T17:23:23.240
> 
> 标签：c#, asp.net, gridview, colors, row

我正在为约会簿制作一张桌子......我需要做以下事情......

显示所有尚未参加的约会（我有一个按钮将它们标记为参加）...如果约会尚未参加并且日期早于今天的日期，则该行必须显示为红色（文本字体颜色） ...

所以我的问题是，如何更改特定行的颜色，以及如果我必须在查询中获取某些内容以指定该行必须具有不同的颜色？

谢谢你

```
<asp:GridView ID="grdvEventosVendedor" runat="server" AllowPaging="True" 
                AutoGenerateColumns="False" CellPadding="4" DatakeyNames="idCita"
                EmptyDataText="No Hay Eventos Para Este Vendedor" ForeColor="#333333" 
                GridLines="None" AllowSorting="True"
                onpageindexchanging="grdvEventosVendedor_PageIndexChanging" 
                onrowcommand="grdvEventosVendedor_RowCommand" 
                onsorting="grdvEventosVendedor_Sorting" CellSpacing="1" 
                onrowdatabound="grdvEventosVendedor_RowDataBound" >
                <AlternatingRowStyle BackColor="White" ForeColor="#284775"/>

                <Columns>
                    <asp:TemplateField HeaderText="" ItemStyle-Width="35px">
                        <ItemTemplate>
                            <asp:ImageButton ID="imgBtnEdicEvento" runat="server" 
                                CommandArgument='<%# Eval("idCita")%>' CommandName="Edicion" 
                                Height="32px" ImageUrl="~/img/pencil_32.png" Width="32px" />
                        </ItemTemplate>
                    </asp:TemplateField>

                    <asp:TemplateField HeaderText="" ItemStyle-Width="35px">
                        <ItemTemplate>
                            <asp:ImageButton ID="imgBtnDelete" runat="server"
                                CommandName="Borrar" 
                                ImageUrl="~/img/1385_Disable_16x16_72.png" 
                                onclientclick="return confirm('¿Desea eliminar el registro?');" 
                                CommandArgument='<%# Eval("idCita")%>' />
                        </ItemTemplate>
                    </asp:TemplateField>

                    <asp:BoundField DataField="Cliente" HeaderText="Cliente" InsertVisible="False" ReadOnly="True" SortExpression="Cliente" ItemStyle-Width="50px" />
                    <asp:BoundField DataField="Empresa" HeaderText="Empresa" InsertVisible="False" ReadOnly="True" SortExpression="Empresa" ItemStyle-Width="50px"/>
                    <asp:BoundField DataField="Telefono" HeaderText="Telefono" InsertVisible="False" ReadOnly="True" SortExpression="Telefono" ItemStyle-Width="50px"/>
                    <asp:BoundField DataField="Nextel" HeaderText="Nextel" InsertVisible="False" ReadOnly="True" SortExpression="Nextel" ItemStyle-Width="50px"/>
                    <asp:BoundField DataField="Tipo" HeaderText="Tipo" InsertVisible="False" ReadOnly="True" SortExpression="Tipo" ItemStyle-Width="50px"/>
                    <asp:BoundField DataField="Descripcion" HeaderText="Descripcion" InsertVisible="False" ReadOnly="True" SortExpression="Descripcion" ItemStyle-Width="100px"/>

                    <asp:TemplateField HeaderText="Fecha" SortExpression="Fecha" ItemStyle-Width="50px">
                        <ItemTemplate>                                            
                            <%# DataBinder.Eval(Container.DataItem, "Fecha", "{0:dd/MM/yyyy}")%>
                        </ItemTemplate>

                        <EditItemTemplate>                                        
                            <asp:TextBox ID="tbxFecha"  runat="server" Text='<%#Bind("Fecha","{0:dd/MM/yyyy}") %>' ValidationGroup="gpEdicionAgenda">
                            </asp:TextBox>
                        </EditItemTemplate>
                    </asp:TemplateField>

                    <asp:BoundField DataField="HoraInicio" HeaderText="Hora" InsertVisible="False" ReadOnly="True" SortExpression="HoraInicio" ItemStyle-Width="50px"/>
                    <asp:BoundField DataField="Lugar" HeaderText="Lugar" InsertVisible="False" ReadOnly="True" SortExpression="Lugar" ItemStyle-Width="50px"/>
                    <asp:BoundField DataField="Estado" HeaderText="Estado" InsertVisible="False" ReadOnly="True" SortExpression="Estado" ItemStyle-Width="50px"/>

                    <asp:TemplateField HeaderText="Atender" ItemStyle-Width="35px">
                        <ItemTemplate>
                            <asp:ImageButton ID="imgBtnAtender" runat="server"
                                CommandArgument='<%# Eval("idCita")%>' CommandName="Atender" 
                                ImageUrl="~/img/activar.png" Width="16px" Height="16px" 
                                onclientclick="return confirm('¿Desea marcar como atendido este registro?');" />
                        </ItemTemplate>
                    </asp:TemplateField>

                    <asp:TemplateField HeaderText="CRM" ItemStyle-Width="35px">
                        <ItemTemplate>
                            <asp:ImageButton ID="imgBtnCRM" runat="server"
                                CommandArgument='<%# Eval("IdCliente")%>' CommandName="CRM" 
                                ImageUrl="~/img/go.gif" Width="16px" Height="16px" />
                        </ItemTemplate>
                    </asp:TemplateField>

                    <asp:TemplateField HeaderText="VM" ItemStyle-Width="35px">
                        <ItemTemplate>
                            <asp:ImageButton ID="imgBtnVerMas" runat="server"
                                CommandArgument='<%# Eval("IdCliente")%>' CommandName="VerMas" 
                                ImageUrl="~/img/search.png" Width="16px" Height="16px" />
                        </ItemTemplate>
                    </asp:TemplateField>
                </Columns>

                <EditRowStyle BackColor="#999999" Font-Size="Small" />
                <FooterStyle BackColor="#5D7B9D" Font-Bold="True" ForeColor="White" />
                <HeaderStyle BackColor="#5D7B9D" Font-Bold="True" ForeColor="White" Font-Size="Larger" />
                <PagerStyle BackColor="#284775" ForeColor="White" HorizontalAlign="Center" />
                <RowStyle BackColor="#F7F6F3" ForeColor="#333333" HorizontalAlign="Center" Font-Size="Small" />
                <SelectedRowStyle BackColor="#E2DED6" Font-Bold="True" ForeColor="#333333" />
                <SortedAscendingCellStyle BackColor="#E9E7E2" />
                <SortedAscendingHeaderStyle BackColor="#506C8C" />
                <SortedDescendingCellStyle BackColor="#FFFDF8" />
                <SortedDescendingHeaderStyle BackColor="#6F8DAE" />
            </asp:GridView> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T17:29:29.717

您可以通过在行的 Backcolor 属性中指定颜色来更改行的颜色，您可以在`grdvEventosVendedor_RowDataBound`gridview 事件中指定该属性

```
 e.Row.BackColor = Drawing.Color.Red; 
```

或者，您可以使用

```
`e.Row.BackColor = Color.FromName("#FFOOOO");` 
```

您可以这样做来实现上述内容：

```
protected void grdvEventosVendedor_RowDataBound(object sender, GridViewRowEventArgs e)
{
  if (e.Row.RowType = DataControlRowType.DataRow)
  {
      if(put_your_condition_here)
      {
           e.Row.BackColor = Drawing.Color.Red;
           //// or you can assign color by doing this: e.Row.BackColor = Color.FromName("#FFOOOO");
      }
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T17:31:30.707

有很多方法可以处理这个问题，包括在数据绑定之后（或）在 RowDataBound 事件期间循环遍历每一行：

```
foreach (GridViewRow row in yourGridView.Rows)
{
    // Find controls/data to do comparison against
    e.Row.BackColor = Color.FromName("#FF0000"); 
} 
```

或者...

```
protected void yourGridView_RowDataBound(object sender, GridViewRowEventArgs e)
{
    // Watch out for header and footer rows here
    e.Row.BackColor = Color.FromName("#FF0000");                
} 
```

# java-me - 如何在跳棋游戏中玩家移动和 AI 移动之间添加暂停？

> ID：11974027
> 
> 赞同：1
> 
> 时间：2012-08-15T17:23:52.903
> 
> 标签：java-me, nokia-s40

当在我的游戏中，玩家移动时，在计算 AI 移动之前它是不可见的。然后两个动作一起显示。

我想展示玩家的移动，然后是 AI 移动（在计算之后）。我尝试了线程延迟但没有用。如何使用某种暂停来添加这种可见性，但该暂停不能暂停程序的执行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T11:44:27.377

1.  玩家做出选择，停止接受玩家输入，在一个线程中启动玩家移动动画并在另一个线程中启动 AI。
2.  当 AI 完成时，玩家移动动画未完成：wait(100)。当玩家移动动画完成后，开始播放 AI 移动动画。
3.  当 AI 移动动画完成后，恢复接受玩家输入。

    在第 2 步中，如果 AI 花费的时间比玩家移动的动画长，则显示一些等待动画。在开始 AI 移动动画之前，应停止此等待动画。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-15T17:29:17.880

您始终可以创建一个布尔检查，仅当您的玩家完成移动时才设置为 true。

```
public class ... 
{
    boolean playerMoveMade = false;

    ...

    public void gameCycle() 
    {
        ...

        if (playerMoveMade) 
        {
            playerMoveMade = false;
            // ... render AI move
        }
    }
} 
```

# asp.net - Gridview列标题自动换行，如何防止？

> ID：11974039
> 
> 赞同：0
> 
> 时间：2012-08-15T17:24:58.517
> 
> 标签：asp.net, gridview, header, word-wrap

**背景：**

我有一个非常宽的网格视图。一些标题中有一个空格。因此，每个标题的第二个单词被包装到第二行。我该如何防止这种情况？

**以前的尝试：**

到目前为止，我已经尝试了以下没有运气。

1.  尝试在标签中设置`<ItemStyle Wrap="False" />`属性`<boundfield...>`
2.  尝试`HeaderStyle-Wrap="false"`在gridview标签中设置属性
3.  根据[http://www.velocityreviews.com/forums/t292904-gridview-header-wrap.html](http://www.velocityreviews.com/forums/t292904-gridview-header-wrap.html)我需要从所有父对象中删除它。我把它从所有东西中取出，它仍然包裹着。
4.  我尝试设置数据绑定标签中每列的宽度。这没有用。
5.  我试过`Wrap="false"`在`<headerstyle`标签中设置

**截图**

![在此处输入图像描述](../Images/e23af1b05e1bf813d1f4fe9a0c1d2358.png)

**问题：**

如何防止网格视图中的标题文本在非常宽的网格视图中自动换行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-04-09T07:44:25.690

我把它放在每一列：

```
 headerStyle-Wrap="false" ItemStyle-Wrap="false" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T17:49:04.563

在页面上添加此样式定义：

```
.myGrid th
{
     white-space: nowrap !important;
} 
```

Where `myGrid`- GridView 的 CssClass 属性值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T18:27:10.797

我最终做的只是为 gridview 创建一个任意大的宽度，以让它有足够的空间。唯一的缺点是它不会根据实际需要多少空间而动态增长和收缩。不是一个真正的解决方案，所以如果有人有更好的解决方案发布它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-21T21:11:29.227

在 gridview 的属性中，设置**Styles-> Header Style-> Wrap**为 False

# c++ - 链接约定，如何声明 qsort

> ID：11974041
> 
> 赞同：0
> 
> 时间：2012-08-15T17:25:00.933
> 
> 标签：c++, extern, linkage, qsort

我想问一下如何在不同的编译单元中从 stdlib.h 声明 qsort 函数，并避免有关不一致的 dll 链接的警告。

```
typedef int (*FT)(const void*, const void*); //FT has C++ linkage
extern "C"{
    typedef int (__cdecl *CFT)(const void*, const void*);//CFT has C linkage
    void __cdecl qsort(void*p, size_t n, size_t sz, CFT cmp);//cmp has C linkage
} 
```

c:\bjarne_exercise_5.cpp(15): 警告 C4273: 'qsort' : 不一致的 dll 链接 c:\program files\microsoft visual studio 10.0\vc\include\stdlib.h(425) : 请参阅之前的 'qsort' 定义

# macos - 在 Mac App SDK 中连接到 SSH 隧道

> ID：11974042
> 
> 赞同：0
> 
> 时间：2012-08-15T17:25:06.397
> 
> 标签：macos, sdk, ssh, reachability, tunnel

我正在开发一个处理在线数据的 Mac 应用程序。选项之一是它支持 SSH 隧道获取数据。理想情况下，应用程序将使用一些用户设置连接到 SSH 隧道，然后工作（即应用程序中使用的所有网络连接都通过此隧道，这应该将端口 80 转发到远程服务器 [所以，如果我要实现WebView 或其他组件，它们将自动通过 SSH 隧道工作]) 自动，所有远程服务都通过隧道路由。

这对我来说是一个新的代码领域。我从某人那里读到过类似的东西，我可以使用 Reachability，这听起来很有趣，但我真的不知道。有人可以指出我关于这种代码的教程的方向吗？

谢谢，

山姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:14:29.637

I finally got a chance to speak to an Apple Engineer about this and it is not possible.

# javascript - HTML5 拖放 - 如何捕获和交换数据属性

> ID：11974048
> 
> 赞同：2
> 
> 时间：2012-08-15T17:25:25.097
> 
> 标签：javascript, html, drag-and-drop

所以我在这里遵循了一个 HTML5 拖放示例：

[http://www.html5rocks.com/en/tutorials/dnd/basics/#toc-dataTransfer](http://www.html5rocks.com/en/tutorials/dnd/basics/#toc-dataTransfer)

并创建了以下代码

[http://jsfiddle.net/Vk5zT/](http://jsfiddle.net/Vk5zT/)

问题是，我希望能够从本质上交换整个元素及其数据属性，而不仅仅是内部 html。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:51:22.993

您可以只交换元素本身，而不是序列化和重新解析新元素。

```
 var parent = this.parentNode,
            insertionPoint, elem = this;

        do {
            elem = elem.nextSibling;
        } while (elem && elem !== draggedItem);

        insertionPoint = elem ? this : this.nextSibling;
        parent.insertBefore(draggedItem, insertionPoint);
        draggedItem = null; 
```

[http://jsfiddle.net/Vk5zT/11/](http://jsfiddle.net/Vk5zT/11/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T17:54:46.913

见[http://jsfiddle.net/Vk5zT/7/](http://jsfiddle.net/Vk5zT/7/)：

```
$(this).replaceWith($(draggedItem).clone(true,true));
$(draggedItem).replaceWith($(this).clone(true,true)); 
```

但是`.clone(true,true)`也应该复制事件侦听器，但它没有，所以拖放停止工作。我解决了它创建函数`addEvents`：

```
function addEvents(){
    $('.segmentListItem').each(function(index){
        $(this)[0].addEventListener('dragstart',handleDragStart,false);
        $(this)[0].addEventListener('drop',handleDrop,false);
        $(this)[0].addEventListener('dragover',handleDragOver,false);
    });
} 
```

接着：

```
$(this).replaceWith($(draggedItem).clone(true,true));
$(draggedItem).replaceWith($(this).clone(true,true));
addEvents(); 
```

**编辑：**

我已经解决了事件侦听器的问题，并且我已将您的代码改编为 jquery：

[http://jsfiddle.net/Vk5zT/12/](http://jsfiddle.net/Vk5zT/12/)

# jquery - 复选框上的jQuery单击事件不起作用

> ID：11974052
> 
> 赞同：5
> 
> 时间：2012-08-15T17:26:03.053
> 
> 标签：jquery

我有以下代码，我正在尝试开始工作。我想要的是如果选中复选框，则显示带有“生成器”类的表行，如果未选中（默认）则将其删除。我已经测试了 jquery，我知道它加载正常，所以这不是问题。

以下是我尝试从[jQuery 复选框事件处理](https://stackoverflow.com/questions/3442322/jquery-checkbox-event-handling)中改编的代码：

```
<script>
$('#gen_form input:checkbox').click(function() {
    var $this = $(this);
    // $this will contain a reference to the checkbox   
    if ($this.is(':checked')) {
        $(".generator").toggle();
    } else {
        $(".generator").toggle();
    }
});
</script>

      <?php if(isset($msg)){ echo "<span id='msg'>".$msg."</span>"; }?>
      <h2>Add CLLI</h2>
      <form method="post" id='gen_form'>
        <table class="form_table_newuser">
         <tr>
          <td class='tdl'>Generator</td><td class='tdr'><input type='checkbox' id='showGen' name='generator' /></td><td>&nbsp;</td>
         </tr>
         <tr class='generator'>
          <td class='tdl'>Start Time</td><td class='tdr'><input type='text' name='start_time' class='textbox'/></td><td>&nbsp;<span class='error'>*<?php echo $errors['start_time']; ?></span></td>
         </tr>
         <tr class='generator'>
          <td class='tdl'>End Time</td><td class='tdr'><input type='text' name='end_time' class='textbox'/></td><td>&nbsp;<span class='error'>*<?php echo $errors['end_time']; ?></span></td>
         </tr> 
```

我对 jQuery 还是很陌生，并且正在学习。我用复选框检查尝试的一切都失败了。我可以使用一个按钮并且它可以工作（使用不同的代码），但我需要能够使用该复选框。我在发布之前尝试了更多的事情，说他们都处理复选框，但点击复选框时他们都没有做任何事情。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-15T17:28:43.303

您需要将该函数包装在文档就绪回调中，否则在绑定处理程序时元素不存在：

```
$(document).ready(function() {
    $('#gen_form input:checkbox').click(function() {
        $(".generator").toggle(); // simplifies to this
    });
}); 
```

此外，jQuery[`.toggle()`](http://api.jquery.com/toggle)为您交替处理隐藏/显示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T17:31:44.467

尝试将代码放入`$(document).ready`处理程序中，根据标记的结构，听起来您只想选择一个输入元素，请尝试以下操作：

```
$(document).ready(function(){
  $('#showGen').change(function(){
      $('.generator').css('display', this.checked ? 'block' : 'none');
      // or $('.generator').toggle()
  })
}) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T17:30:58.623

这是因为 dom 还没有准备好，你的脚本在元素存在之前运行。

如果你把你的脚本包装在 jQuery 的文档中，这样它就可以工作了：-

```
$(function(){
  $('#gen_form input:checkbox').click(function() {
    var $this = $(this);
    // $this will contain a reference to the checkbox   
    if ($this.is(':checked')) {
      $(".generator").toggle();
    } else {
      $(".generator").toggle();
    }
  });
}); 
```

我在 jsFiddle 中尝试过它并且它有效

# iphone - 代码中的解析问题错误

> ID：11974060
> 
> 赞同：-5
> 
> 时间：2012-08-15T17:26:31.387
> 
> 标签：iphone, objective-c, ios

以下代码中存在语法错误：

```
[videoView loadHTMLString:videoHTML baseURL:nil]; 
```

这段代码的声明，但我无法得到它。

```
- (void)embedYouTube {

    videoHTML = [NSString stringWithFormat:@"\
             <html>\
             <head>\
             <style type=\"text/css\">\
             iframe {position:absolute; top:50%%; margin-top:-130px;}\
             body {background-color:#000; margin:0;}\
             </style>\
             </head>\
             <body>\
            <iframe width=\"560%%\" height=\"315px\" src="http://youtube.com/embed/-0Xa4bHcJu8" frameborder="0" allowfullscreen></iframe>\
             </body>\
             </html>", videoURL];

             [videoView loadHTMLString:videoHTML baseURL:nil];

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T17:28:30.647

您需要转义 URL 和边框周围的引号：

```
src=\"http://... 
```

# mongodb - 想对 mongodb 做增量备份。写日记？操作日志？

> ID：11974071
> 
> 赞同：9
> 
> 时间：2012-08-15T17:26:57.130
> 
> 标签：mongodb, backup, journaling, binlog

我想每天备份单个 mongodb 数据库，可能使用 mongodump。为了不丢失任何数据，我希望这是增量的，所以如果在一天中间出现问题，我需要能够在执行 mongorestore 后重播当天的更改，直到故障点。

我是否正确理解我需要为此使用oplog？还是记录答案？我尝试执行以下操作：

1.  将我的 mongo 数据库变成只有一个的副本集，以便它创建一个 oplog。（这感觉很hacky）
2.  使用 --oplog 选项重新启动 mongod
3.  执行应记录在 oplog 中的更改

然而，没有任何东西存储在 oplog 中。进行此类增量备份的最佳方法是什么？我基本上是在寻找一种类似的方法来重放 mysql binlog。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-16T17:01:56.837

MongoDB 不提供开箱即用的增量备份选项，但可以进行文件快照并重放 oplog。您是否按照文档中概述的步骤将服务器设置为副本集？ [http://www.mongodb.org/display/DOCS/Replica+Sets+-+Basics](http://www.mongodb.org/display/DOCS/Replica+Sets+-+Basics)

你能告诉我们这些备份的目的吗？您是否考虑过将第二个节点添加到您的副本集以实现数据持久性？

如果您已经完成了将服务器设置为副本集成员的步骤，您可以在 shell 中运行 rs.status() 吗？

另一个注意事项（只是为了澄清） - 日记并不是一种备份策略；日志只是确保数据库在发生故障转移时可以返回到一致的状态。强烈建议在启用日志的情况下运行。

这是用于备份的 MongoDB 文档： [http ://www.mongodb.org/display/DOCS/Backups](http://www.mongodb.org/display/DOCS/Backups)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-27T20:57:17.750

进行备份的最佳方法是将[Ops Manager](https://www.mongodb.com/presentations/webinar-introducing-ops-manager)配置为 MongoDB 基础架构的一部分，但它的作用远不止备份……

# javascript - 拖放的dataTransfer.setData在chrome中不起作用？

> ID：11974077
> 
> 赞同：5
> 
> 时间：2012-08-15T17:27:12.007
> 
> 标签：javascript, html, drag-and-drop

```
<div id="asd" title="222">drag me</div>

<script>
var el = document.getElementById("asd");
el.draggable=true;
el.addEventListener("dragstart", function(ev){
    ev.stopPropagation();
    var dt = ev.dataTransfer;
    dt.effectAllowed = "copyMove";
        console.log(this.getAttribute("title") + " attr");
    dt.setData('Text', this.getAttribute("title"));
        console.log(dt.getData('Text') + " dt");
},false);
</script> 
```

小提琴：

[http://jsfiddle.net/vwjCa/](http://jsfiddle.net/vwjCa/)

[http://jsfiddle.net/vwjCa/2/](http://jsfiddle.net/vwjCa/2/)（此处自定义类型而不是文本）

在 Firefox 打印中：

```
222 attr
222 dt 
```

在镀铬印刷品中：

```
222 attr
 dt 
```

这里的问题在哪里？提前致谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-18T16:09:05.157

回答我自己：

**显然 chrome只允许在 drop 事件中**读取 dataTransfer 的数据

 **这是出于安全原因

例如，如果我在远程页面上“拖过”信用卡号，除非我没有“删除”，否则这个应该无法读取我的数据

firefox does the same, but allows to read getData() if "domain" of events is the same

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T17:35:16.470

[chrome](http://code.google.com/p/chromium/issues/detail?id=31037)中有一个错误，它只允许您使用某些 mime 类型。尝试将`'Text'`您的代码更改为`'text/plain'`，这应该可以在 chrome 中使用。**

# objective-c - 获取当前日期的 NSDate - 3 个月

> ID：11974084
> 
> 赞同：0
> 
> 时间：2012-08-15T17:27:35.580
> 
> 标签：objective-c, ios, ipad, date, nsdate

如何获得当前日期 - 3 个月？我需要它来进行数据库查询以获取过去 3 个月内的所有文件。

我知道操作“dateByAddingTimeInterval”，但我必须减去 3 个月。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:09:47.483

取决于您如何定义 3 个月。如果您的意思是 3 个月前的同一天，您可以这样做：

```
 NSCalendar *calendar = [NSCalendar currentCalendar];
    NSDateComponents *components = [calendar components:(NSHourCalendarUnit | NSMinuteCalendarUnit | NSYearCalendarUnit |NSMonthCalendarUnit|NSDayCalendarUnit) fromDate:[NSDate date]];

    NSInteger now_hour = [components hour];
    NSInteger now_minute = [components minute];
    NSInteger yearx =  [components year];
    NSInteger monthx =  [components month];
    NSInteger dayx =  [components day];

    //1 = january
    NSInteger monthsMinus3 = (monthx > 3) ? monthx -3 : (monthx +12 -3);
    NSDateComponents *comps = [[NSDateComponents alloc] init];
    [comps setMinute:now_minute];
    [comps setHour:now_hour];
    [comps setYear:yearx];
    [comps setMonth:monthx];
    [comps setDay:dayx];
    NSDate *threeMonthAgo = [calendar dateFromComponents:comps]; 
```

当然，您也可以更改月份而无需创建额外的日期，但我认为这更清晰、更灵活，以防您想调试并可能更改日期，以防您在 3 个月前定义 -n 天取决于我们在哪个月份。例如 - (30+31+30) 或 -(31+30+31) 或必须考虑 2 月 28 天。

同样，一切都取决于您在 3 个月前如何定义……但这应该会引导您找到解决方案

# php - 为什么 crypt() 会产生不同的结果？

> ID：11974091
> 
> 赞同：3
> 
> 时间：2012-08-15T17:28:06.313
> 
> 标签：php, encryption, passwords, blowfish, crypt

Crypt 正在使用相同的输入数据生成不同的散列，并且 [以下] 以前的功能散列生成器/检查不再适用于验证用户：

```
public static function blowfish($password, $storedpass = false) {
    //if encrypted data is passed, check it against input ($info) 
      if ($storedpass) { 
            if (substr($storedpass, 0, 60) == crypt($password, "$2y$08$".substr($storedpass, 60))) { 
                return true; 
            }  else { 
                return false; 
            } 
      }  else { 
          //make a salt and hash it with input, and add salt to end 
          $salt = ""; 
          for ($i = 0; $i < 22; $i++) { 
            $salt .= substr("./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", mt_rand(0, 63), 1); 
          } 
          //return 82 char string (60 char hash & 22 char salt) 
          return crypt($password, "$2y$08$".$salt).$salt; 
     }
} 
```

我把头撞在墙上，没有找到 Zend 内部算法与 PHP 与操作系统算法之间差异的答案；或 PHP 5.3.8 与早期版本之间的变化......

编辑：我的问题在技术上得到了回答，这是我的错，我没有正确提问。我已经实现：

```
$salt = substr(bin2hex(openssl_random_pseudo_bytes(22)), 0, 22);
          //for ($i = 0; $i < 22; $i++) { 
            //$salt .= substr("./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", mt_rand(0, 63), 1); 
          //} 
```

我真正的问题是；为什么以下函数返回不同？

```
print(substr($storedpass, 0, 60)."<br />"); 
```

回报：$2y$08$43f053b1538df81054d4cOJyrO5/j7NtZBCw6LrFof29cLBs7giK6

```
print(crypt($password, "$2a$08$".substr($storedpass, 60))); 
```

返回：$2a$08$43f053b1538df81054d4cOPSGh/LMc0PZx6RC6PlXOSc61BKq/F6。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:59:56.483

**因为您是在`salt`随机数的帮助下创建的，**

该函数[`mt_rand()`](http://php.net/manual/en/function.mt-rand.php)将在您每次调用时创建随机数，可选择使用 min、max 参数。通常对于强加密密码散列，Salt 应该使用加密安全伪随机数生成器 (CSPRNG) 生成。

然后来到你的问题，我假设ZEND和php之间的算法没有区别。因为zend是一个围绕php核心的框架，并且可以利用它。

要验证密码，`crypt`检查是如何工作的

```
crypt($password, $stored_hash) == $stored_hash; 
```

一旦你在第一次散列时存储了散列，就很容易验证。

这就是这里实际发生的情况，如果您将散列作为第二个参数传递给函数 blowfish，它将通过 bool 值返回验证，而不管盐值如何。

```
if (substr($storedpass, 0, 60) == crypt($password, "$2y$08$".substr($storedpass, 60))) { 
    return true; 
}  else { 
    return false; 
} 
```

有关散列和安全性的信息，请阅读[此](http://crackstation.net/hashing-security.htm)

希望这可以帮助

# c++ - git分支实验

> ID：11974092
> 
> 赞同：1
> 
> 时间：2012-08-15T17:28:18.237
> 
> 标签：c++, git, branch

好吧，我一直在为一个项目工作。今天我正在试验特定于 Windows`wchar`的东西，从早上开始我需要更改很多代码，结果我得到了一个丑陋的烂摊子。我可以清除后者，但现在我需要在最后一次工作提交上做一些主流工作。但我不想放弃这项工作。那么我怎样才能将这项工作保留在某个分支中以备将来使用，并将我的工作区恢复到最后一次提交呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T17:32:42.287

您可以创建一个新分支并将您的更改提交给它：

```
git checkout -b topic/ugly-mess
git commit -a -m 'Checkpointing mess.' 
```

然后返回具有最后一次工作提交的主流分支：

```
git checkout master 
```

如果您希望在上游发布“本地混乱”，请推送分支：

```
git push origin topic/ugly-mess 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T17:32:55.060

只需创建一个新分支

```
git branch -b wchar_migration 
```

并将您的更改提交到其中

```
git commit -am "wchar ..." 
```

然后回到你的工作

```
git checkout master 
```

如果以后你想包含你在 master 上所做的修改，只需在它的基础上进行 rebase。

```
git co wchar_migration
git rebase master 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T17:32:45.547

你可能甚至不需要分支。如果您使用`git stash`， git stashes（存储）当前的“脏”工作区并将您返回到一个干净的工作区。如果需要，您可以`apply`稍后隐藏更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T17:32:54.853

只要您没有进行任何此类工作，您就可以随时[`git stash`](http://git-scm.com/book/en/Git-Tools-Stashing)进行实验。

但是您已经将其描述为*实验性*的，因此另一种选择，可能是更好的选择，是将这项工作保留在它自己的分支中，例如`git checkout -b wcharExperiment`，将工作提交到这个新分支，然后检查您的主分支。

# ckeditor - 样式表解析器和格式组合

> ID：11974093
> 
> 赞同：0
> 
> 时间：2012-08-15T17:28:27.213
> 
> 标签：ckeditor

我正在使用 ckeditor，并使用 stylesheetparser 从相当长的样式表中加载样式。它可以工作，但我无法让它以我想要的方式在视觉上工作：样式下拉列表将每个样式的定义应用于样式名称的显示；我希望这些是纯文本。具体来说，某些样式的顶部或底部边距较大，这会在下拉内容中留下巨大的空白。

我克隆了 stylesheetparser plugin.js 源代码，并尝试修改将解析后的样式推送到样式列表的代码。我可以成功更改名称，但不能更改名称在列表中的显示方式。如果我更改此代码中的类属性（如下所示），它会更改实际的样式定义，而不仅仅是用于在下拉列表中显示它的样式。

```
 // Add each style to our "Styles" collection.
    for ( i = 0; i < aClasses.length; i++ )
    {
        var oElement = aClasses[ i ].split( '.' ),
            element = oElement[ 0 ].toLowerCase(),
            sClassName = oElement[ 1 ];

        styles.push( {
            name : element + '.' + sClassName,
            element : element,
            attributes : {'class' : sClassName}
        });
    } 
```

有谁知道如何更改用于在下拉列表中显示样式的样式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:06:28.930

要改变这一点，您必须使用样式组合插件，而不是样式表解析器，因为它只是填充样式，但它是显示它们的组合。

# java - @ElementCollection 与地图 其中 Entity 是 Embeddable 的一个字段

> ID：11974096
> 
> 赞同：5
> 
> 时间：2012-08-15T17:28:36.590
> 
> 标签：java, hibernate, jpa, map

在搜索了 JPA 文档和各种帖子之后，我对 JPA2.0 是否可以实现以下操作感到困惑。我刚从 JPA 开始，如果我在做一些愚蠢的事情，请原谅，

我的域模型有一个“投资组合”，其中包含零个或多个“未平仓头寸”。一个仓位由一个“工具”（它是一个 JPA 实体）和一个价格（双倍）组成。投资组合如下：

```
@Entity (name = "portfolio")
public class Portfolio {
    @Id
    @Column (name = "id")
    @GeneratedValue
    private long id;

    @ElementCollection (fetch = FetchType.EAGER)
    @CollectionTable (name = "portfolio_entry", joinColumns = @JoinColumn (name = "portfolio_id"))
    private final Map<Instrument, OpenPosition> positions = new HashMap<Instrument, OpenPosition>();
.... 
```

OpenPosition Embeddable 如下：

```
@Embeddable
public class OpenPosition extends Position {
    @ManyToOne (targetEntity = InstrumentImpl.class, optional = false)
    @JoinColumn (name = "instrument_id", nullable = false)
    protected Instrument instrument;

    @Column (name = "price", nullable = false)
    protected double price;
.... 
```

仪器实体是：

```
@Entity (name="instrument")
public class Instrument {
    @Id
    @Column(name = "id")
    @GeneratedValue
    private long id;

    @Column(name = "isin", nullable = false)
    private String isin;
....    
    @Override 
    public int hashCode() {
        int hash = 17;
        hash = 31 * hash + isin.hashCode();
    .... 
```

当我尝试使用它时，架构被创建并且我能够持久化投资组合，但是当我尝试检索它们时，我在 Instrument 类的 hashCode 方法中得到一个 NullPointerException。似乎 JPA 正在尝试获取哈希码来构建 Map 键，但 Instrument 对象尚未加载。

通过调试可以看出，虽然在 Instrument 对象中设置了 id，但其他字段都是 null。

所以我的问题是，JPA2.0 是否允许 ElementCollection，其中键是一个实体，它也作为 Embeddable 值的字段存在？如果是这样，我在搞砸什么。如果没有，最好的解决方法是使用 Instrument 实体的 id 作为键吗？

提前致谢。

ps 我正在使用hibernate 4.1.4 JPA 实现。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-12-01T18:01:19.747

> 所以我的问题是，JPA2.0 是否允许 ElementCollection，其中键是一个实体，它也作为 Embeddable 值的字段存在？

是的，我设法用这个映射做到了：

```
@ElementCollection( targetClass = FreightBid.class )
@MapKeyJoinColumn( name = "carrier_id", referencedColumnName = "id" )
@CollectionTable( name = "freight_bid",
    joinColumns = @JoinColumn( name = "offer_pool_id" ) )
@Access( AccessType.FIELD )
private Map<Carrier,FreightBid> bidsByCarrier; 
```

就我而言， Carrier 是一个`@Entity`， FreightBid 是一个`@Embedded`

我已经能够正确地保存和检索包含此地图的实体。

> 我在搞砸什么。

您应该`protected Instrument instrument;`从`OpenPosition`类中删除该字段，而是使用`@MapKeyJoinColumn`Portfolio 类中映射字段上的注释来声明应该将哪个列用作映射键的连接列。

此外，最好避免在充当映射键的对象的 hashCode 方法中使用除 id 之外的其他字段……您的 JPA 实现者可能会搞砸。

# ember.js - Ember.ArrayController.create() 不返回唯一实例

> ID：11974101
> 
> 赞同：0
> 
> 时间：2012-08-15T17:28:51.293
> 
> 标签：ember.js

我确定我在这里一定遗漏了一些明显的东西：我正在创建 3 个对象，每个对象都有一个设置为 ArrayController 的属性。当我添加每个新对象时，ArrayController 实例共享前一个控制器的内容，而不是唯一的实例：

[http://jsfiddle.net/w6DKR/3/](http://jsfiddle.net/w6DKR/3/)

在我的示例中，我可以解决此问题的唯一方法是`this.set('content', []);`在 ArrayController init 方法中执行此操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T19:56:24.777

**初始化（也是一个常见的错误！）**

Ember 初学者最常见的错误之一是认为他们将属性传递给实例而不是原型。例如：

```
var Person = Ember.Object.extend({
  chromosomes: ["x"] // CAREFUL !!!!!
});

var joe = Person.create();
joe.get("chromosomes").push("y");

var jane = Person.create();
jane.get("chromosomes").push("x");

// Joe and Jane are all mixed up?!?!?!?!
console.log( joe.get("chromosomes") );  // x, y, x
console.log( jane.get("chromosomes") ); // x, y, x 
```

为什么会发生这种染色体突变？当我们在定义 Person 类时向原型中添加一个数组时，问题就开始了。然后与从 Person 实例化的每个对象共享该数组。

我们应该如何处理这件事？

```
var Person = Ember.Object.extend({
  chromosomes: null,
  init: function() {
    this._super();
    this.chromosomes = ["x"]; // everyone gets at least one X chromosome
  }
});

var joe = Person.create();
joe.get("chromosomes").push("y");  // men also get a Y chromosome

var jane = Person.create();
jane.get("chromosomes").push("x"); // women get another X chromosome

// Hurray - everyone gets their own chromosomes!
console.log( joe.get("chromosomes") );  // x, y
console.log( jane.get("chromosomes") ); // x, x 
```

在类中声明对象或数组时，您通常希望将它们与 init() 函数中的每个实例一起初始化。这样，您的每个对象都将收到自己独特的对象和数组实例。还记得在 init() 中调用 this._super() ，这样 init() 将在原型链的整个过程中被调用。

当然，将对象或数组直接保存在原型中并没有错，如果它们是为了在实例之间保持不变的话。事实上，一种常见的模式是在原型中保留默认设置，然后在 init() 中为每个实例复制该默认设置。一旦您了解对象是如何创建和初始化的，这些类型的模式就很容易实现。

复制自文章：[http ://www.cerebris.com/blog/2012/03/06/understanding-ember-object/](http://www.cerebris.com/blog/2012/03/06/understanding-ember-object/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T19:47:59.893

实际上，您通常不希望在块`content: []`内进行设置，`.extend({...})`因为每个实例都将共享同一个数组。AFAIK 这是 Ember.js 中可接受的，甚至可能是常见的模式：

```
App.MyController = Ember.ArrayController.extend({
    content: null,
    init: function() {
        this._super();
        this.set('content', []);
    },
    // ...
}); 
```

# sql - SELECT SQL 语法 For Count in WHERE 子句

> ID：11974108
> 
> 赞同：8
> 
> 时间：2012-08-15T17:29:09.643
> 
> 标签：sql, oracle, group-by, aggregate-functions

我正在尝试构建正确的 sql 语句 (Oracle) 以获取大于给定值的每个 customer_id 的 device_id 计数。例如，我想知道具有 3 个以上 device_id 的 customer_id。一个 device_id 只能关联一个 customer_id，而一个 customer_id 可能有多个 device_id。

```
Table:
device_id
customer_id
....

Data (device_id, customer_id):
00001, CUST1
00002, CUST1
00003, CUST1
00004, CUST1
00005, CUST2
00006, CUST2 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-15T17:31:05.490

获取拥有 3 台以上设备的客户：

```
select customer_id, count(device_id)
from YourTable
Group by customer_id
having count(device_id) > 3 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T17:32:17.430

您将需要使用`GROUP BY`and`HAVING`子句

```
select customer_id, count(device_id)
from YourTable
group by customer_id
having count(device_id) > 3 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T17:32:20.550

你需要的是有子句：

```
select customer_id, count(*)
from t
group by customer_id
having count(*) > 3 
```

# ruby-on-rails - 如何在 erb 中创建向下钻取表 - Ruby on Rails

> ID：11974109
> 
> 赞同：0
> 
> 时间：2012-08-15T17:29:12.567
> 
> 标签：ruby-on-rails, ruby-on-rails-3, erb

我的数据库中有 2 个表，Company & Users。我有一个列出所有公司的列表（显示为表格）。现在我想在每一行中插入一个链接，该链接可以将用户带到另一个列表（显示为表格），该列表仅显示属于特定公司行的那些用户？

```
Companies list

<table>
<% @companies.each do |company| %>
  <tr>
    <td><%= company.Name %></td>
    <td><%= company.addressline1 %></td>
    <td><%= company.addressline2 %></td>
    <td><%= company.City %></td>
    <td><%= company.postcode %></td>
    <td><%= company.Telephone %></td>
    <td><%= link_to 'Edit', edit_company_path(company) %></td>
    <td><%= link_to "Users", url_for(:users) %></td>  
  </tr>
<% end %>
</table> 
```

用户列表

```
<table>
<% @users.each do |user| %>
  <tr>
    <td><%= user.username %></td>
    <td><%= user.email %></td>
    <td><%= UserType.find(user.user_type_id).user_type_name %></div>
    <td><%= check_box_tag(user, user.is_admin, user.is_admin) %></div>
    <td><%= check_box_tag(user, user.active_status, user.active_status) %></div>
    <td><%= link_to 'Edit',  edit_user_path(user) %></td>
  </tr> 
```

<% 结束 %>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T19:20:11.517

Pinny 的答案会起作用，但如果您将用户范围限定在公司范围内，您可能需要查看嵌套资源（[http://guides.rubyonrails.org/routing.html#nested-resources](http://guides.rubyonrails.org/routing.html#nested-resources)）

您可以将您的用户资源定义为您的公司的“孩子”`config/routes.rb`

```
resources :companies do
  resources :users
end 
```

从那时起，您的用户控制器中始终有参数 :company_id 可用，可以通过`/companies/#{company_id}/users`

然后，在您的控制器中，您可以限定任何用户查询公司的范围，例如：

```
def show
  @company = Company.find(params[:company_id])
  @user = @company.users.find(params[:id])
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T18:21:55.163

有多种方法可以做到这一点。您可以从添加一个简单的路线开始：

```
match 'companies/:company_id/users' => 'users#for_company', :as => :company_users 
```

在你的`UsersController`：

```
def for_company
  @users = Company.find(params[:company_id]).users
  render :action => :index
end 
```

在您的公司列表视图中，将链接更改为：

```
<td><%= link_to "Users", company_users_path(company) %></td> 
```

一旦你把它准备好并开始工作，你可能需要考虑其他方法来设置路线。例如，您可能希望`users`成为`companies`. 有关这方面的更多信息，请参见[此处](http://guides.rubyonrails.org/routing.html)。

# indexeddb - IDBDatabase.transaction 中不推荐使用数字事务模式。使用“只读”或“读写”

> ID：11974115
> 
> 赞同：3
> 
> 时间：2012-08-15T17:29:40.403
> 
> 标签：indexeddb

我在使用 IndexedDB 的应用程序上收到此警告。

“IDBDatabase.transaction 中不推荐使用数字事务模式。使用“只读”或“读写””

当我第一次编写应用程序时（大约几个月前）我没有看到这一点，但似乎每次尝试访问 IDBDatabase.transaction 时都会收到此警告。

在 chrome 控制台上，它可以正确识别以下事务密钥。

```
IDBTransaction.READ_WRITE
1
IDBTransaction.READ_ONLY
0 
```

我正在执行 IDB 事务的示例代码：

```
IndexedDB.set = function(key, obj, onsuccess, oncomplete) {
    var db = IndexedDB.db;
    var trans = db.transaction([key], IDBTransaction.READ_WRITE);
    var objectStore = trans.objectStore(key);
    var request = objectStore.put(obj);

    request.onsuccess = function(e) {
      if (onsuccess !== undefined)
        onsuccess(request.result);
    };

    request.onerror = function(e) {
      console.log("Database error: " + e.target.errorCode);
    };
    trans.oncomplete = function(e) {
      if (oncomplete !== undefined)
        oncomplete(request.result);
    };
  }; 
```

我应该担心这个吗？如果是这样，我怎样才能避免这个警告？

我的 chrome v：版本 21.0.1180.75

感谢您的意见。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T20:03:41.460

IndexedDB 标准仍在进行中（尽管版本 1 非常接近完成），最近的更改之一是[从像 "IDBTransaction.READ_WRITE" 这样的数字常量切换到像 "readwrite" 这样的纯字符串](http://old.nabble.com/-IndexedDB--Numeric-constants-vs-enumerated-strings-to33370626.html#a33370626)。这是一个好主意，因为它使代码更简洁、更易读。

旧常量可能会继续工作一段时间，尽管会出现您观察到的警告消息，但现在使用字符串是“正确”的方式，这可能是您应该使用的方式，例如：

```
 var trans = db.transaction([key], "readwrite"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-16T05:12:06.907

为了向后兼容，我建议提供一个后备。对于 chrome，我会忽略您收到的警告并继续使用该界面。

也许尝试以下工作以使其反向和向前兼容：

```
var transactionType = { READ_ONLY: "readonly", READ_WRITE: "readwrite" }
if (IDBTransaction.READ_ONLY && IDBTransaction.READ_WRITE){
   transactionType.READ_ONLY = IDBTransaction.READ_ONLY
   transactionType.READ_WRITE = IDBTransaction.READ_WRITE
}

var trans = db.transaction([key], transactionType.READ_WRITE); 
```

使用此解决方案，您可以确保旧浏览器仍然可以工作，而新浏览器也可以。

# javascript - Javascript 默认参数

> ID：11974118
> 
> 赞同：4
> 
> 时间：2012-08-15T17:29:51.977
> 
> 标签：javascript

当一个愚蠢的问题出现时，我正在阅读 Three.js 代码：下面的代码之间有什么区别吗？

```
frameHeight = frameHeight !== undefined ? frameHeight : 24; 
```

和

```
frameHeight = frameHeight || 24; 
```

（frameHeight是函数的参数）

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-15T17:32:17.643

是的，它们是不同的。

```
frameHeight = frameHeight || 24; 
```

这将强制`frameHeight`转换为布尔值。如果是`0`, `''`, `false`, `null`, `undefined`, 否则`NaN`为假，`frameHeight`默认为 24​​。

```
frameHeight = frameHeight !== undefined ? frameHeight : 24; 
```

这将显式检查是否`frameHeight`不是`undefined`并且仅用于`undefined`将其默认为`24`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T17:31:50.153

```
frameHeight = frameHeight || 24; 
```

^ 也会进行空值检查。还将检查 0、false、空字符串 ('') NaN 和未定义

```
frameHeight = frameHeight !== undefined ? frameHeight : 24; 
```

^ 只会检查未定义。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-15T17:34:08.880

是的，存在差异，根据具体情况，差异可能很大。

```
frameHeight = frameHeight || 24 
```

`24`如果 frameHeight 最初是任何虚假值，例如`""`、`0`、`null`、或`undefined`，则将分配给 frame 。`NaN``false`

然而：

```
frameHeight = frameHeight !== undefined ? frameheight : 24 
```

`24`只有当初始值正好是时才会分配它`undefined`。

因此，在这个特定函数中可能具有重要意义的是，第二种方法将允许您通过`0`设置`frameHeight`零高度，但第一种方法不会，因为它将覆盖它`0`到`24`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T17:34:30.857

```
frameHeight = frameHeight || 24; 
```

失败为`frameHeight`= 0 适用于`frameHeight`= null

```
frameHeight = frameHeight !== undefined ? frameHeight : 24; 
```

失败 for `frameHeight`= null 适用于`frameHeight`= 0

# cuda - CUDA __device__ 函数的开头或结尾是否存在隐式屏障同步？

> ID：11974120
> 
> 赞同：2
> 
> 时间：2012-08-15T17:30:04.007
> 
> 标签：cuda, synchronization, gpgpu

如果 CUDA 内核调用 __device__ 函数，在进入或退出 __device__ 函数的块中的所有线程之间是否存在任何隐式同步？

如果不是，那么这意味着块中的某些线程可能在块中的其他线程甚至进入它之前退出 __device__ 函数（在没有任何显式同步的情况下）？

任何指向相关信息/参考的指针将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T19:43:10.757

是的，正如 talonmies 指出的那样，经线中只有隐式同步 btw 线程。当内核启动时，硬件会查看任何经线（可能是第一个经线）并为其执行第一条指令，然后切换到另一个经线。有可能一些warp在另一个warp甚至执行内核的第一条指令之前就退休了，因为warp在退出时不需要相互等待

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T19:29:24.270

您应该`__syncthreads()`在内核代码中使用函数。调用该`__device__`函数后，添加`__syncthreads();`行以放置障碍并同步线程。

# css - 内联 CSS 不适用于添加的小部件

> ID：11974121
> 
> 赞同：0
> 
> 时间：2012-08-15T17:30:07.780
> 
> 标签：css, gwt

我似乎无法弄清楚为什么我添加的小部件不会内联显示。我希望我的验证小部件在标签之后显示内联。但无论我做什么都不会。为什么？

```
<ui:UiBinder
 xmlns:ui="urn:ui:com.google.gwt.uibinder"
  xmlns:validation='urn:import:com.versature.vsm.client.ui.validation'>

<ui:style>
.validationField {
    display:inline-block;
}
</ui:style>

<g:HTMLPanel ui:field="mainPanel">
     <div class="{style.validationField}">
         <g:Label text="ACCOUNT NUM:"/> 
         <validation:ValidationField ui:field="accountNumberValidation"/>
     </div>
</g:HTMLPanel> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T19:17:11.160

替换`<g:Label>`为`<g:InlineLabel>`。

Label 使用 a `<div>`，默认情况下显示为块，而 InlineLabel 使用 a `<span>`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T17:39:14.100

> 我希望我的验证小部件在标签之后显示内联。但无论我做什么都不会。为什么？

您目前正在制作容纳它们的*容器*`inline`。要使单个元素内联，您可以（确保仅应用以下解决方案之一；同时应用两者都不起作用）：

**(1)通过将样式更改为：将CSS 类的*子*`validationField`类设置为内联显示：**

```
<ui:style>
.validationField * {
    display:inline-block;
}
</ui:style> 
```

**(2)通过将 UiBinder XML 更改为：*仅*`validationField`将CSS 类应用于您的`ValidationField`GWT 小部件：**

 *```
<g:HTMLPanel ui:field="mainPanel">
     <g:Label text="ACCOUNT NUM:"/> 
     <validation:ValidationField ui:field="accountNumberValidation" stylePrimaryName="{style.validationField}"/>
</g:HTMLPanel> 
```*

# java - 从 servlet 到达 xml

> ID：11974123
> 
> 赞同：0
> 
> 时间：2012-08-15T17:30:12.230
> 
> 标签：java, xml, servlets, saxparser, classnotfoundexception

尝试从 servlet 写入项目中的本地 xml 文件。当从另一个 java 类运行相同的代码时，不会发生错误，但是当代码从 servlet 运行时，我收到以下错误：

java.lang.ClassNotFoundException: org.jdom2.JDOMException

在 servletis 的 doGet 方法末尾粘贴到 servlet 的部分代码如下：

```
 try {

                SAXBuilder builder = new SAXBuilder();
                File xmlFile = new File("C:\\eclipse\\workspace1\\BeamII\\WebContent\\Data.xml");

                Document doc = (Document)builder.build(xmlFile);

                Element Users = doc.getRootElement();
                List<Element> myUsers = Users.getChildren();

                Element beamUser = myUsers.get(0);

                Element Data= beamUser.getChildren().get(2);

                Element data1= new Element ("data1");

                Data.addContent(data1);

                XMLOutputter xmlOutput = new XMLOutputter();

                xmlOutput.setFormat(Format.getPrettyFormat());
                xmlOutput.output(doc, new FileWriter("C:\\eclipse\\workspace1\\BeamII\\WebContent\\Data.xml"));

                // xmlOutput.output(doc, System.out);

                System.out.println("done!");
          } catch (IOException io) {
                io.printStackTrace();
          } catch (JDOMException e) {
                e.printStackTrace();
          } 
```

我的进口如下：

```
 import java.io.File;
                import java.io.FileWriter;
                import java.io.IOException;
                import java.util.ArrayList;
                import java.util.List;

                import org.jdom2.input.SAXBuilder;
                import org.jdom2.output.Format;
                import org.jdom2.output.XMLOutputter;
                import org.jdom2.Document;
                import org.jdom2.Element;
                import org.jdom2.JDOMException;

                import javax.servlet.RequestDispatcher;
                import javax.servlet.ServletException;
                import javax.servlet.http.HttpServlet;
                import javax.servlet.http.HttpServletRequest;
                import javax.servlet.http.HttpServletResponse; 
```

谢谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:44:53.140

检查`jdom-2.0.2.jar`（或您使用的任何版本）是否在`C:\eclipse\workspace1\BeamII\WebContent\WEB-INF\lib`.

# vtd-xml - VTD-XML如何在xpath中处理一对多关系

> ID：11974125
> 
> 赞同：0
> 
> 时间：2012-08-15T17:30:21.987
> 
> 标签：vtd-xml

在使用 VTD-XML 使用大型 xpath 解析 xml 时遇到问题，

1) 例如，在单个 xpath 中与 xml 元素的一对多关系，

```
<group>       
<element>
  <model>
    <product>BMW
      <feature>
      </feature>
    </product>
  </model>

   <model>
      <product>FORD
         <feature>
      </feature>

      </product>
  </model> 

  <model>
  </model> 

</element>
<groups> 
```

问题是，我正在使用多个自动驾驶仪来打破一对多的关系。但是底层的导航器是相同的。有时我没有得到所有的元素。

# php - 需要优化php mysql中的插入查询

> ID：11974128
> 
> 赞同：1
> 
> 时间：2012-08-15T17:30:34.683
> 
> 标签：php, mysql, sql, optimization

我正在使用以下代码将多条记录插入表中。如您所见，查询处于循环中。每次循环执行时，都会运行单独的 sql 查询来插入它。

我想要一种方法，而不是运行多个查询，只有单个 INSERT sql 查询应该与多个插入语句一起运行。

虽然我的这段代码运行良好，但我需要优化它。

```
$managed_ailments = unserialize($ailments);
foreach($managed_ailments as $ailment_id)
{
    $sql = "INSERT INTO ". TABLE_PATIENTS_AILMENTS_RECORDS ."";
    $sql .= "(patient_id, ailment_id, datecreated) VALUES";
    $sql .= "($patient_id, $ailment_id, now())";
    $query = $mysql->query($sql);
} 
```

这里 $managed_ailments 是一个序列化的数组，我已经反序列化了。数组中可以有一个或多个值。$mysql->query($sql) 是我的自定义函数。

请帮助我将此代码转换为一个可以完成所有操作的单个 sql 查询。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T17:36:10.747

像这样的东西应该工作：

```
$managed_ailments = unserialize($ailments);
$sql = "INSERT INTO ". TABLE_PATIENTS_AILMENTS_RECORDS ."";
$sql .= "(patient_id, ailment_id, datecreated) VALUES (";

$query_parts = array();

foreach($managed_ailments as $ailment_id) {
    $query_parts[] = "($patient_id, $ailment_id, now()";
}
$sql .= implode(",", $query_parts);
$sql .= ")";

$query = $mysql->query($sql); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T17:37:17.777

您可以为每个记录添加一个值语句然后执行查询，即：

```
INSERT INTO example 
    (example_id, name, value, other_value)
VALUES
    (100, 'Name 1', 'Value 1', 'Other 1'),
    (101, 'Name 2', 'Value 2', 'Other 2'),
    (102, 'Name 3', 'Value 3', 'Other 3'),
    (103, 'Name 4', 'Value 4', 'Other 4'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T17:43:07.293

您可以使用已准备好的语句的 MySQLi 扩展。您将模板一次发送到服务器，然后循环发送数据。

```
//initialize and connect $mysqli via MySQLi extension 

$sql = "INSERT INTO ". TABLE_PATIENTS_AILMENTS_RECORDS ."";
$sql .= "(patient_id, ailment_id, datecreated) VALUES";
$sql .= "(?, ?, now())";

$stmt = $mysqli->prepare($query)

$managed_ailments = unserialize($ailments);
foreach($managed_ailments as $ailment_id) {
    $stmt->bind_param("ii", $patient_id, $ailment_id);
    $stmt->execute();
} 
```

请注意，我假设 $patient_id、$ailment_id 都是整数。并且还假设您不想保留执行查询的结果，因为您正在覆盖 $query

这将减少 NOW() 函数的开销并节省一些带宽。

这是[PHP MySQLi 文档的链接](http://php.net/manual/en/book.mysqli.php)

# php - 使用 Gettext() 实现 PHP Web 应用程序国际化；

> ID：11974133
> 
> 赞同：6
> 
> 时间：2012-08-15T17:30:59.270
> 
> 标签：php, ubuntu-server, php-gettext

我目前正在开发一个需要提供法语和英语版本的 PHP Web 应用程序。我环顾四周，发现 Gettext() 功能提供了最佳性能。

我用命令生成了我的 .pot 文件

```
 xgettext PhpFileToTranslate.php -o NameOfTemplateFile.pot 
```

并成功生成了一个 .pot 文件。我使用 PoEdit 生成 messages.po 文件并创建了 messages.mo

这是我的服务器文件：

```
/app
    /locale
        /en_US
              /LC_MESSAGES
              messages.po
              messages.mo
        /fr_FR
              /LC_MESSAGES
              messages.po
              messages.mo
        template.pot 
```

我在 php 文件中设置语言环境，如下所示：

```
$language = $_SESSION['language'];  //session contains 'fr_FR.UTF-8' or 'en_US.UTF-8'
setlocale(LC_ALL, $language);
bindtextdomain('messages', './locale');  
textdomain('messages'); 
```

但我只看到标签而不是翻译......我尝试使用'fr_FR'而不是'fr_FR.UTF-8'和各种字符串，但它不起作用。

我错过了什么吗？我的服务器是带有 Apache 和 php5 的 Ubuntu 12.04 服务器

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T17:37:24.763

要在 linux 上编译 .mo 文件，您需要在服务器和编译它的机器上安装语言环境。语言环境是您的操作系统支持的语言。

如本教程所述：[http](http://dev.jimdo.com/archive-old-blog/tutorial-for-the-easy-use-of-gettext-for-internationalization-of-php-apps/) ://dev.jimdo.com/archive-old-blog/tutorial-for-the-easy-use-of-gettext-for-internationalization-of-php-apps/ 验证您是否拥有安装在你的 linux 上的语言环境

确保您要使用的语言环境已安装在您的 linux 中，并且您使用 .UTF-8（您需要 i18n，所以请使用 UTF！）：

```
# Example for debian
dpkg-reconfigure locales 
```

-- 在 linux 上安装新的语言环境

列出系统上实际安装的语言：

```
locale -a 
```

安装 fr_FR 的示例：

```
#List the available i18n locales
less /usr/share/i18n/SUPPORTED 
```

安装语言环境（此处为 fr_FR.utf8）

```
locale-gen fr_FR.utf8 
```

重新配置系统上的语言环境

```
sudo  dpkg-reconfigure locales 
```

使用 PoEdit 重新编译您的 .mo 文件，这应该可以解决问题。确保在服务器和编译 .mo 文件的机器上都安装了语言环境。

希望有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T13:17:14.493

除了Bruno 所说的，别忘了重新加载Apache 配置（例如，service apache2 reload）。我浪费了一些时间来寻找它为什么不起作用，只是为了发现安装新语言/区域设置后必须重新加载 Apache 配置。

# django - 从views.py的列表中提取最后一个元素时的Django奇怪行为

> ID：11974134
> 
> 赞同：0
> 
> 时间：2012-08-15T17:31:02.797
> 
> 标签：django, django-views

我用 Django 创建了一个博客，我希望我最后发布的帖子出现在第一页。这是我的views.py代码：

```
 def index(request):
       messages = get_list_or_404(Message.objects.order_by('publication_date'))
       last = messages[-1]
       return render_to_response('posts/index.html', {
          'last_message' : last,                                                        
          'posts_list'   : messages,
       }) 
```

但我不明白为什么，在此页面上按 F5 时，它会随机打印最后一篇文章（如预期的那样）或第一篇文章（没有任何明显原因）（有时是最后一篇文章，有时是第一篇文章）。

这种行为发生在使用 mod_wsgi 运行的 apache2 而不是 django 开发服务器（它总是显示最后一篇文章）。

有没有人有任何线索？

非常感谢

编辑：这是我在 index.html 模板中使用的代码：

```
{% if last_message %}
 <article>
 <h1><a href="/posts/{{ last_message.id }}">{{ last_message.title }}</a></h1>
 <p class="meta_infos">Published on {{ last_message.publication_date }}</p>
 <p>{{ last_message.text }}</p>
 </article>
{% else %}
 <p>No post available</p>
{% endif %} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:40:24.267

我会这样做以确保您每次只拉回一个对象而不是所有消息：

```
messages = Message.objects.order_by('-publication_date')[:1]
if not messages:
    raise Http404
last = message[0] 
```

或者你可以这样做：

```
try:
    last = Message.objects.order_by('-publication_date')[0]
except IndexError:
    raise Http404 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T22:04:43.227

好吧，伙计们，问题来自需要重新加载的apache服务器（PHP不需要这样做，这就是我没有想到的原因）。

我还用 last = get_list_or_404(Message).latest('publication_date') 替换了 messages = get_list_or_404(Message.objects.order_by('publication_date')) 哪个更简洁。

感谢您的帮助和回答！

# ios - 防止应用在运行单元测试时创建视图控制器

> ID：11974138
> 
> 赞同：10
> 
> 时间：2012-08-15T17:31:05.007
> 
> 标签：ios, unit-testing, uiviewcontroller, tdd, ocunit

当我使用 OCUnit 测试我的应用程序时，它会在运行测试之前像往常一样设置 AppDelegate、窗口和 rootViewController。我的 rootViewController 然后将自己添加为某些 NSNotifications 的观察者。

当我用隔离的测试实例和模拟观察者测试这些通知时，自动创建的 rootViewController 的通知处理程序也会被调用，这会导致我的一些测试失败。

在测试模式下运行时，有没有办法阻止 OCUnit 创建 rootViewController 或使其使用不同的 ViewController 类？如果不用在我的应用程序代码中编写特殊的测试相关代码就可以做到这一点，那就太酷了。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-16T05:31:49.357

*更新：我今天所做的与下面的答案略有不同。了解[如何轻松切换您的 App Delegate 以进行测试](https://qualitycoding.org/ios-app-delegate-testing/)*

它确实需要在您的应用程序代码中添加一些特定于测试的代码。以下是我为避免完整的启动顺序而采取的措施：

**编辑方案**

*   选择测试操作
*   在“测试”中选择参数选项卡
*   禁用“使用运行操作的选项”
*   添加环境变量，设置`runningTests`为`YES`

**编辑您的应用委托**

*   `-application:didFinishLaunchingWithOptions:`在有意义的情况下添加以下内容：

    ```
    #if DEBUG
        if (getenv("runningTests"))
            return YES;
    #endif 
    ```

*   做同样的事情，`-applicationDidBecomeActive:`但很简单`return`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-06-04T09:47:52.423

@Jon Reid 的解决方案很棒，我现在在我所有的项目中都使用它，但是它有一个小问题：默认情况下，方案没有保存在版本控制系统中。因此，当您从 git 克隆项目时，测试可能会因为`runningTests`未设置环境变量而失败。我总是忘记它。

所以，为了提醒自己，我现在在我的所有项目中添加一个小测试：

```
#import <UIKit/UIKit.h>
#import <XCTest/XCTest.h>

@interface DMAUnitTestModeTests : XCTestCase

@end

@implementation DMAUnitTestModeTests

- (void)testUnitTestMode {
    BOOL isInUnitTestMode = (BOOL)getenv("runningTests");

    XCTAssert(isInUnitTestMode, @"You have to set a 'runningTests' environment variable in the schemes editor.");
    //http://stackoverflow.com/questions/11974138/prevent-app-from-creating-a-viewcontroller-when-running-unit-tests/11981192#11981192
}

@end 
```

如果有人提出更好的解决方案，请告诉我:)

**为什么我将其发布为答案：**这只是对@Jon Reid 答案的一个小改进（我真的很喜欢）。我想把它写成评论，但是以这种方式共享代码会很不方便，所以我决定将它作为答案发布（尽管它并不完全是问题的答案）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-08-22T08:26:44.630

Xcode 本身在运行测试时设置环境变量，因此无需在您的方案中创建任何环境变量。如果您已经出于其他目的这样做，那么这样做可能是可行的。但是，您可以使用 Xcode 的环境变量来确定测试是否正在运行。objc 中的大部分代码如下所示，您可以将其放入您的应用程序委托中：

**选项1：**

```
static BOOL isRunningTests(void) __attribute__((const));

static BOOL isRunningTests(void)
{
    NSDictionary* environment = [[NSProcessInfo processInfo] environment];
    NSString* injectBundle = environment[@"XCInjectBundle"];
    NSLog(@"TSTL %@", [injectBundle pathExtension]);
    return [[injectBundle pathExtension] isEqualToString:@"xctest"] || [[injectBundle pathExtension] isEqualToString:@"octest"];
} 
```

然后只需`isRunningTests()`在需要检查测试的地方调用。但是，此代码实际上应该存储在其他地方，例如，在 TestHelper 类中：

**选项 2：**

```
// TestHelper.h
#import <Foundation/Foundation.h>

extern BOOL isRunningTests(void) __attribute__((const)); 
```

```
// TestHelper.m
#import "TestCase.h"

extern BOOL isRunningTests(void)
{
    NSDictionary* environment = [[NSProcessInfo processInfo] environment];
    NSString* injectBundle = environment[@"XCInjectBundle"];
    NSLog(@"TSTL %@", [injectBundle pathExtension]);
    return [[injectBundle pathExtension] isEqualToString:@"xctest"] || [[injectBundle pathExtension] isEqualToString:@"octest"];
} 
```

注意我们仍然使用全局变量，类名的选择其实是无关紧要的。这只是一些有意义的课程。

**选项 3：**

在 swift 中，您需要将其包装在一个类中以便在 Objective-c 和 swift 中工作。你可以这样做：

```
class TestHelper: NSObject {
    static let isRunningTests: Bool = {
        guard let injectBundle = NSProcessInfo.processInfo().environment["XCInjectBundle"] as NSString? else {
            return false
        }
        let pathExtension = injectBundle.pathExtension

        return pathExtension == "xctest" || pathExtension == "octest"
    }()
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-13T09:51:09.770

我在[RxTodo MVVM 示例应用程序](https://github.com/devxoul/RxTodo)中看到的最简洁的方式，它是这样的：

1.  `@UIApplication`从您的应用程序委托类中删除属性
2.  添加 main.swift 文件，实现如下：

    ```
    import UIKit
    import Foundation

    final class MockAppDelegate: UIResponder, UIApplicationDelegate {}

    private func appDelegateClassName() -> String {
        let isTesting = NSClassFromString("XCTestCase") != nil
        return
        NSStringFromClass(isTesting ? MockAppDelegate.self : AppDelegate.self)
    }

    UIApplicationMain(
        CommandLine.argc,
        UnsafeMutableRawPointer(CommandLine.unsafeArgv)
            .bindMemory(to: UnsafeMutablePointer<Int8>.self, capacity: Int(CommandLine.argc)),
        NSStringFromClass(UIApplication.self), appDelegateClassName()
    ) 
    ```

它是 Swift 3 版本。对于 v2，请参阅编辑历史。

# streaming - Google TV 模拟器无法播放 HLS

> ID：11974141
> 
> 赞同：0
> 
> 时间：2012-08-15T17:31:26.923
> 
> 标签：streaming, android-videoview, http-live-streaming, google-tv

我有一个适用于 android 3.1 (API 12) 的谷歌电视模拟器我正在尝试播放 hls 文件，但我收到消息“无法播放此视频”

我正在使用以下代码：

```
mVideoView = (VideoView) findViewById(R.id.videoView1);
mVideoView.setVideoURI(Uri.parse("http://vodmytvoriginrt-i.akamaihd.net/i/rotana/1RRCP0183_,500,1000,1800,.mp4.csmil/master.m3u8"));
mVideoView.setOnCompletionListener(this);
mVideoView.setOnErrorListener(this);
MediaController mc = new MediaController(this, true);
mc.setMediaPlayer(mVideoView);
mc.setAnchorView(mVideoView);
mVideoView.setMediaController(mc);
mVideoView.requestFocus(); 
```

mVideoView.start();

我可能会丢失什么？有没有人有这个问题的解决方案或建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T19:15:22.890

Google TV 模拟器不支持 HLS。我将为此提出功能请求。谢谢！

# c# - 带分页的自定义数据表

> ID：11974145
> 
> 赞同：3
> 
> 时间：2012-08-15T17:31:36.910
> 
> 标签：c#, asp.net, vb.net

我正在使用我的自定义`DataTable`作为`DataSource`我的`ListView`. 现在，我面临的问题是它`Paging`不起作用。

我想要做的是，当我点击页面`1`等等`2`时，我应该一次只能获取 10 行。

我的意思是，当页面加载时，我只想获取前 10 行，单击时`2`我想获取接下来的 10 行。但是点击页面`1`不应该`SQL`再次执行该语句，只是从某处（`ViewState`/ `Cache`）获取数据。

什么是正确的方法？我应该如何进行？？

**注意：**我不想使用`SQL DataSource`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T17:50:09.863

你需要的是一个 PagingDataSource ...

```
protected void Page_Load(object sender, EventArgs e)
{
    BindData((hdnPage.Value != "" ? Convert.ToInt32(hdnPage.Value) : 0));
}

private void BindData(int? pageNo)
{
    PagedDataSource ds = new PagedDataSource();
    ds.DataSource = [YOUR DATA SOURCE];
    ds.AllowPaging = true;
    ds.PageSize = 10;
    ds.CurrentPageIndex = pageNo ?? 0;

    pnlPaging.Controls.Clear();
    for (int i = 0; i < ds.PageCount; i++)
    {
        if (ds.PageCount < 2)
        {
            break;
        }

        if (pageNo == i || (pageNo == null && i == 0))
        {
            pnlPaging.Controls.Add(new LiteralControl("<span style=\"display:inline-block;margin:0 2px 2px 0;\">" + (i + 1).ToString() + "</span>"));
            continue;
        }

        SuprLinkButton lb = new SuprLinkButton()
        {
            CommandName = "pageThis",
            CommandArgument = i.ToString(),
            ID = "lbPage" + i.ToString(),
            Text = (i + 1).ToString()
        };
        lb.Attributes.Add("style", "display:inline-block;margin:0 2px 2px 0;");
        lb.Command += new CommandEventHandler(lb_Command);
        pnlPaging.Controls.Add(lb);
    }

    [LISTVIEW].DataSource = ds;
    [LISTVIEW].DataBind();
} 
```

我有一个面板来保存所有页面链接和一个隐藏字段来保存当前页面索引。然后是分页命令...

```
protected void lb_Command(object sender, CommandEventArgs e)
{
    hdnPage.Value = e.CommandArgument.ToString();
    BindData(Convert.ToInt32(e.CommandArgument));
} 
```

# c# - 在 C# 类中调用方法

> ID：11974146
> 
> 赞同：1
> 
> 时间：2012-08-15T17:31:38.480
> 
> 标签：c#, generics

这是我试图理解的一段 C# 代码。类在接口中具有以下可用方法。

```
T GetLookupValue<T, S>(string sTName, string sFName, string sLuName, S value); 
```

当我使用 dotPeek 查看这个类的用法时，它显示了这一点。

```
 public T GetLookupValue<T, S>(string sTName, string sFName, string sLuName, S value)
{
  return (T) this.db.a(sTName, sFName, sLuName, false, (object) value, false, false);
} 
```

**我如何调用这个方法？**我需要用什么代替 T 和 S？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T17:33:31.203

该方法将自身呈现为通用查找函数。如果实现真的可以处理任何类型，那么您可以对 S 和 T 使用任何类型。

例子：

```
string result = GetLookupValue<string, int>("tname", "fname", "luname", 42);

MyClass result = GetLookupValue<MyClass, string>("tname", "fname", "luname", "blah"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T17:33:43.180

[这是对 C# 泛型的精彩介绍](http://msdn.microsoft.com/en-us/library/ms379564%28v=vs.80%29.aspx)，这就是它。

基本上，您只需将 T 和 S 替换为您想要的任何内容。T 是您的返回类型，S 将是用于最终参数的类型 ( `value`)

例如：

```
var myObject = GetLookupValue<MyObject, MyOtherObject>("sTName", "sFName", "sLuName", (MyOtherObject)myOtherObject); 
```

这允许更健壮的代码。您可以将一种方法塑造成您需要的任何东西

泛型是您如何将任何内容放入`List<T>`：

```
List<String> stringList = new List<String>();
List<int> intList = new List<int>();
... 
```

在编译时，您的泛型值被内置到您的代码中。所以，如果你对我上面的例子做了一个 dotPeek，你会看到这样的东西：

```
public MyObject GetLookupValue<MyObject, MyOtherObject>(string sTName, string sFName, string sLuName, MyOtherObject value)
{
  return (MyObject) this.db.a(sTName, sFName, sLuName, false, (object) value, false, false);
} 
```

***但是，在写出来时，将参数`value`作为泛型似乎毫无意义，因为它只是被强制转换为`object`.... 他们可能已经成功了`T GetLookupValue<T>(string sTName, string sFName, string sLuName, object value);`。（它允许最终装箱一个值对象（即 int、double 等）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T17:33:46.533

> 我如何调用这个方法？

这将取决于您要使用的类型。例如：

```
int result = GetLookupValue<int, string>("tname", "fname", "luname", "some value"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-15T17:34:52.550

类型 T 和 S 是类型。要调用此方法并存储结果，请使用：

```
SomeClass returnedObject = GetLookupValue<SomeClass, SomeOtherType>("", "", "", ""); 
```

该方法将返回与您为 T 输入的任何内容等效的类型。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-15T17:36:16.303

看来 T 是您的返回类型，而 S 是在内部用作某个值的类型。

因此，您需要为 T 和 S 指定类型，因此：

```
SomeType result = GetLookupValue<SomeType, SomeValueType>(...); 
```

# objective-c - 格式化错误日期的最实用方法（Objective-C，Cocoa Touch）

> ID：11974147
> 
> 赞同：0
> 
> 时间：2012-08-15T17:31:43.057
> 
> 标签：objective-c, ios, cocoa-touch

我正在从互联网上检索格式很差的日期戳，例如：

```
sun apr 22 19:57:10 2012
thu apr 5 10:13:44 2012 
```

最好我想：

```
22 April 2012 19:57:10
5 April 2012 10:13:44 
```

是否有一种直接的方法将错误日期输入日期戳，然后以传统方法（如在 SQL 查询中）进行布局？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T17:36:25.360

您将需要使用 NSDateformatter。检查服务器用于提供日期格式的标准，并使用您的 NSDateformatter 实例复制该行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T17:41:27.513

使用[`NSDateFormatter`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDateFormatter_Class/Reference/Reference.html). 有关格式规范，请参见[此处](http://unicode.org/reports/tr35/tr35-10.html#Date_Format_Patterns)。

```
 NSString *date1 = @"sun apr 22 19:57:10 2012";
    NSString *date2 = @"thu apr 5 10:13:44 2012";

    //Release this later if not using ARC
    NSDateFormatter *dformatter = [[NSDateFormatter alloc] init]; 
    [dformatter setDateFormat:@"EEE MMM d H:m:s yyyy"];

    NSLog(@"Date: %@", [dformatter dateFromString:date1]);
    NSLog(@"Date: %@", [dformatter dateFromString:date2]); 
```

# dojo - 将 dijit.form.Select 下拉列表放置在特定位置而不是正文的底部

> ID：11974153
> 
> 赞同：0
> 
> 时间：2012-08-15T17:31:57.283
> 
> 标签：dojo, dijit.form

有人知道如何将 dijit.form.Select 下拉列表放置在某些 div 中，但不像 dijit 那样放置在正文的底部吗？我已经替换了 dijit.Dialog 中的选择元素 - 选择没问题，但它没有选项。所有选项都在正文的底部，在对话框的底层之后。尝试了 MySelect.dropDown.placeAt() - 它有奇怪的影响，它放置了一些带有滚动条的空 div，但值无论如何都在同一个地方，我无法访问他们的 div - 它无法使用 MySelect.dropDown.parentWidget 因为它指向 MySelect。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T08:57:46.863

您可以通过小部件的“下拉”属性访问它。

```
var node = dijit.byId('myselect').dropDown.domNode 
```

这将为您提供全局菜单弹出容器的第一个子项。只有一个，因为 dijit 中的菜单布局是这样的，所以只有一个应该同时出现。

所以

```
 node.className == "dijitSelectMenu" 
&& node.parentNode.className == "dijitPopup dijitMenuPopup" 
```

带有 z-index 的那个是 dijitPopup （它是全局的，并且这里的样式会随着任何其他选择框甚至您使用的工具提示而改变）

# c++ - 如何在堆栈上创建多态对象？

> ID：11974158
> 
> 赞同：8
> 
> 时间：2012-08-15T17:32:17.183
> 
> 标签：c++, stack, polymorphism

如何在堆栈上分配多态对象？我正在尝试做类似的事情（试图避免使用新的堆分配）？：

```
A* a = NULL;

switch (some_var)
{
case 1:
    a = A();
    break;
case 2:
    a = B(); // B is derived from A
    break;
default:
    a = C(); // C is derived from A
    break;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T17:39:52.893

免责声明：我绝对不认为这是一个好的解决方案。好的解决方案是重新考虑设计（鉴于存在有限数量的可能性，这里可能不保证 OO 多态性？），或者使用第二个函数通过引用传递所述多态对象。

但是由于其他人提到了这个想法，但细节错误，我发布这个答案是为了展示如何让它正确。希望我做对了。

很明显，可能类型的数量是有限的。这意味着一个有区别的联合`boost::variant`可以解决问题，即使它不是很漂亮：

```
boost::variant<A, B, C> thingy = 
    some_var == 1? static_cast<A&&>(A())
    : some_var == 2? static_cast<A&&>(B())
    : static_cast<A&&>(C()); 
```

如果我一直认为这不是对 OO 多态性的良好使用，那么现在您可以使用静态访问者之类的东西这一事实就是其中之一。

如果您想按照其他答案中的建议手动使用新放置而不是现成的解决方案，则需要注意许多事情，因为我们在此过程中失去了常规自动对象的一些属性：

*   编译器不再给我们正确的大小和对齐方式；
*   我们不再自动调用析构函数；

在 C++11 中，这些都可以分别用`aligned_union`和轻松修复`unique_ptr`。

```
std::aligned_union<A, B, C>::type thingy;
A* ptr;
switch (some_var)
{
case 1:
    ptr = ::new(&thingy.a) A();
    break;
case 2:
    ptr = ::new(&thingy.b) B();
    break;
default:
    ptr = ::new(&thingy.c) C();
    break;
}
std::unique_ptr<A, void(*)(A*)> guard { ptr, [](A* a) { a->~A(); } };
// all this mechanism is a great candidate for encapsulation in a class of its own
// but boost::variant already exists, so... 
```

对于不支持这些功能的编译器，您可以获得替代方案： Boost 包含`aligned_storage`和`alignment_of`可用于构建的特征`aligned_union`；并且`unique_ptr`可以用某种范围保护类替换。

既然这已经不碍事了，那就清楚了，不要这样做，只是简单地将一个临时的传递给另一个函数，或者完全重新审视设计。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-15T17:47:16.457

您不能构造单个函数来像那样工作，因为在条件块内创建的自动或临时对象不能将它们的生命周期扩展到包含块中。

我建议将多态行为重构为一个单独的函数：

```
void do_something(A&&);

switch (some_var)
{
case 1:
    do_something(A());
    break;
case 2:
    do_something(B()); // B is derived from A
    break;
default:
    do_something(C()); // C is derived from A
    break;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-15T17:35:11.357

如果 B 是您的基本类型 D1、D2 和 D3 是您的派生类型：

```
void foo()
{
    D1  derived_object1;
    D2  derived_object2;
    D3  derived_object3;
    B *base_pointer;

    switch (some_var)
    {
        case 1:  base_pointer = &derived_object1;  break;
        ....
    }
} 
```

如果你想避免浪费三个派生对象的空间，你可以把你的方法分成两部分；选择您需要的类型的部分，以及适用于它的方法的部分。在决定了您需要哪种类型之后，您调用一个分配该对象的方法，创建一个指向它的指针，然后调用该方法的后半部分来完成堆栈分配对象的工作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-06-13T22:06:14.453

我写了一个通用模板来做到这一点。[此处](https://gist.github.com/shlomil/79ddde6f55a0b129f01c870739b3f4e7)提供完整代码（对于此问题的范围而言，它变得过于复杂）。StackVariant 对象包含提供的类型中最大类型大小的缓冲区，以及最大对齐方式。Object 是在堆栈上使用“placement new”构造的，operator->() 用于多态访问以建议间接。此外，重要的是要确保如果定义了虚拟 detor，则应该在堆栈上的对象销毁时调用它，因此模板 detor 只是使用 SFINAE 定义来执行此操作。

（参见下面的使用示例和输出）：

```
//  compile: g++ file.cpp -std=c++11
#include <type_traits>
#include <cstddef>

// union_size()/union_align() implementation in gist link above

template<class Tbaseclass, typename...classes>
class StackVariant {
    alignas(union_align<classes...>()) char storage[union_size<classes...>()];
public:
    inline Tbaseclass* operator->() { return ((Tbaseclass*)storage); }
    template<class C, typename...TCtor_params>
    StackVariant& init(TCtor_params&&...fargs)
    {
        new (storage) C(std::forward<TCtor_params>(fargs)...);      // "placement new"
        return *this;
    };

    template<class X=Tbaseclass>
    typename std::enable_if<std::has_virtual_destructor<X>::value, void>::type
    call_dtor(){
        ((X*)storage)->~X();
    }

    template<class X=Tbaseclass>
    typename std::enable_if<!std::has_virtual_destructor<X>::value, void>::type
    call_dtor() {};

    ~StackVariant() {
        call_dtor();
    }
}; 
```

使用示例：

```
#include <cstring>
#include <iostream>
#include "StackVariant.h"

class Animal{
public:
    virtual void makeSound() = 0;
    virtual std::string name() = 0;
    virtual ~Animal() = default;
};

class Dog : public Animal{
public:
    void makeSound() final { std::cout << "woff" << std::endl; };
    std::string name() final { return "dog"; };
    Dog(){};
    ~Dog() {std::cout << "woff bye!" << std::endl;}
};

class Cat : public Animal{
    std::string catname;
public:
    Cat() : catname("gonzo") {};
    Cat(const std::string& _name) : catname(_name) {};
    void makeSound() final { std::cout << "meow" << std::endl; };
    std::string name() final { return catname; };
};

using StackAnimal = StackVariant<Animal, Dog, Cat>;

int main() {
    StackAnimal a1;
    StackAnimal a2;
    a1.init<Cat>("gonzo2");
    a2.init<Dog>();  
    a1->makeSound();
    a2->makeSound();
    return 0;
}
//  Output:
//  meow
//  woff
//  woff bye! 
```

有几点需要注意：

1.  我在尝试避免性能关键函数中的堆分配时编写它，它完成了这项工作 - 速度提高了 50%。
2.  我编写它是为了利用 C++ 自己的多态机制。在此之前，我的代码充满了 switch-case ，就像这里之前的建议一样。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-15T17:34:28.740

# 您不能创建多态局部变量

您不能创建多态局部变量，因为 的子类`B`可能`A`具有比 更多的属性`A`，因此占据更多位置，因此编译器必须为 . 的最大子类保留足够的空间`A`。

1.  如果你有几十个子类，其中一个子类有很多属性，这会浪费很多空间。
2.  如果您将作为参数接收到的子类的实例放入局部变量中`A`，并且将代码放入动态库中，那么与它链接的代码可以声明一个比您的库中更大的子类，因此编译器无论如何都不会在堆栈上分配足够的空间。

# 所以自己分配空间

使用[placement new](http://www.devx.com/tips/Tip/12582)，您可以在通过其他方式分配的空间中初始化对象：

*   `alloca`，但看到[这个 SO 问题](https://stackoverflow.com/q/2318306/324969)似乎不是最好的选择。
*   一个可变长度数组，它带来了一些（非）可移植性的乐趣，因为它在 GCC 下工作，但[不在 C++ 标准中（甚至在 C++11 中也没有）](https://stackoverflow.com/q/1887097/324969)
*   `aligned_union<A, B, C>::type`，正如 R. Martinho Fernandes 在对此[答案的评论中所建议的那样](https://stackoverflow.com/a/11974268/324969)

但是，这些技术可能会使用大量额外空间，并且如果您获得的引用（指针）指向编译时未知子类的引用（指针）`A`大于您所考虑的类型，则这些技术可能不起作用。

我建议的解决方案是在每个子类上都有一种工厂方法，它调用一个提供的函数，并带有一个指向给定子类的堆栈分配实例的指针。我在提供的函数签名中添加了一个额外的 void* 参数，因此可以将任意数据传递给它。

@MooingDuck在下面的评论中建议使用模板和 C++11 进行[此实现。](http://ideone.com/8OFNK)如果您需要它用于无法从 C++11 功能中受益的代码，或者对于一些带有结构而不是类的普通 C 代码（如果`struct B`有第一个类型的字段`struct A`，那么它可以像“子结构”一样进行操作），那么我下面的`A`版本就可以解决问题（但不是类型安全的）。

此版本适用于新定义的子类，只要它们实现类`ugly`工厂方法，并且它将使用恒定数量的堆栈来获取此中间函数所需的返回地址和其他信息，加上请求的实例的大小类，但不是最大子类的大小（除非您选择使用那个）。

```
#include <iostream>
class A {
    public:
    int fieldA;
    static void* ugly(void* (*f)(A*, void*), void* param) {
        A instance;
        return f(&instance, param);
    }
    // ...
};
class B : public A {
    public:
    int fieldB;
    static void* ugly(void* (*f)(A*, void*), void* param) {
        B instance;
        return f(&instance, param);
    }
    // ...
};
class C : public B {
    public:
    int fieldC;
    static void* ugly(void* (*f)(A*, void*), void* param) {
        C instance;
        return f(&instance, param);
    }
    // ...
};
void* doWork(A* abc, void* param) {
    abc->fieldA = (int)param;
    if ((int)param == 4) {
        ((C*)abc)->fieldC++;
    }
    return (void*)abc->fieldA;
}
void* otherWork(A* abc, void* param) {
    // Do something with abc
    return (void*)(((int)param)/2);
}
int main() {
    std::cout << (int)A::ugly(doWork, (void*)3);
    std::cout << (int)B::ugly(doWork, (void*)1);
    std::cout << (int)C::ugly(doWork, (void*)4);
    std::cout << (int)A::ugly(otherWork, (void*)2);
    std::cout << (int)C::ugly(otherWork, (void*)11);
    std::cout << (int)B::ugly(otherWork, (void*)19);
    std::cout << std::endl;
    return 0;
} 
```

到那时，我认为我们可能已经超过了简单的成本`malloc`，所以你可能想使用它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-15T17:40:12.270

您可以通过放置新来做到这一点。这会将项目放在堆栈上，在缓冲区中包含的内存中。但是，这些变量不是自动的。缺点是你的析构函数不会自动运行，当它们超出范围时，你需要正确地销毁它们，就像你创建它们一样。

手动调用析构函数的合理替代方法是将您的类型包装在智能指针中，如下所示：

```
class A
{
public:
   virtual ~A() {}
};

class B : public A {};
class C : public B {};

template<class T>
class JustDestruct
{
public:
   void operator()(const T* a)
   {
      a->T::~T();
   }
};

void create(int x)
{
    char buff[1024] // ensure that this is large enough to hold your "biggest" object
    std::unique_ptr<A, JustDestruct<T>> t(buff);

    switch(x)
    {
    case 0:
       ptr = new (buff) A();
       break;

    case 1:
       ptr = new (buff) B();
       break;

    case 2:
       ptr = new (buff) C();
       break;
    }

    // do polymorphic stuff
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-15T17:37:48.563

多态性不适用于值，您需要引用或指针。您可以多态地使用对临时对象的 const 引用，它将具有堆栈对象的生命周期。

```
const A& = (use_b ? B() : A()); 
```

如果您需要修改对象，您别无选择，只能动态分配它（除非您使用 Microsoft 的非标准扩展，它允许您将临时对象绑定到非常量引用）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-15T17:40:28.980

`char`阵列和放置的组合`new`将起作用。

```
char buf[<size big enough to hold largest derived type>];
A *a = NULL;

switch (some_var)
{
case 1:
    a = new(buf) A;
    break;
case 2:
    a = new(buf) B;
    break;
default:
    a = new(buf) C;
    break;
}

// do stuff with a

a->~A(); // must call destructor explicitly 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-08-15T17:40:29.960

严格回答您的问题-您现在所拥有的就是这样做-即`a = A();`and`a = B()`和`a = C()`，但是这些对象是切片的。

*要使用您拥有的代码*实现多态行为，我担心这是不可能的。编译器需要事先知道对象的大小。除非你有引用或指针。

如果您使用**指针**，则需要确保它不会最终悬空：

```
A* a = NULL;

switch (some_var)
{
case 1:
    A obj;
    a = &obj;
    break;
} 
```

将无法工作，因为`obj`超出范围。所以你剩下：

```
A* a = NULL;
A obj1;
B obj2;
C obj3;
switch (some_var)
{
case 1:
    a = &obj1;
    break;
case 2:
    a = &obj2;
    break;
case 3:
    a = &obj3;
    break;
} 
```

这当然是浪费。

对于**引用**，它有点棘手，因为它们必须在创建时分配，并且您不能使用临时对象（除非它是`const`引用）。因此，您可能需要一个返回持久引用的工厂。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-08-15T17:42:02.080

> 试图避免使用 new 进行堆分配）？

那么在这种情况下，您**像往常一样在堆栈上创建对象并将地址分配给基指针**。但是请记住，如果这是在函数内部完成的，请不要将地址作为返回值传递，因为函数调用返回后堆栈会展开。

所以这很糟糕。

```
A* SomeMethod()
{
    B b;
    A* a = &b; // B inherits from A
    return a;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-08-15T17:50:40.390

这*是*可能的，但是要干净利落地做*很多*工作（也就是说，无需手动放置新的和暴露的原始缓冲区）。

您正在查看类似[Boost.Variant](http://www.boost.org/doc/libs/1_50_0/doc/html/variant.html)的东西，经过修改以将类型限制为基类和一些派生类，*并*公开对基类型的多态引用。

这个东西（*PolymorphicVariant*？）将为您包装所有放置新的东西（并且还负责安全销毁）。

如果这真的是你想要的，请告诉我，我会给你一个开始。除非你真的需要这种行为，否则 Mike *Seymour*的建议更实用。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-06-18T08:49:55.947

运行这个简短的程序，你就会明白为什么多态对象不能很好地在堆栈上工作。当您创建一个未知的派生类型的堆栈对象并期望它从函数调用中返回时，当调用函数超出范围时，会发生该对象被销毁的情况。因此，只要该功能在范围内，该对象就存在。为了返回一个比调用函数寿命更长的有效对象，您需要使用堆。这通过这个简单的层次结构和具有 switch 语句的同一函数的两个版本来演示，除了一个在堆栈上执行，另一个在堆上执行。查看两个实现的输出并查看调用了哪些方法、从哪个类调用它们以及何时调用它们。

```
#include <string>
#include <iostream>

class Base {
public:
    enum Type {
        DERIVED_A = 0,
        DERIVED_B,
        DERIVED_C
    };

protected:
    Type type_;

public:
    explicit Base(Type type) : type_(type) {
        std::cout << "Base Constructor Called." << std::endl;
    }
    virtual ~Base() {
        std::cout << "Base Destructor Called." << std::endl;
    }

    virtual void doSomething() {
        std::cout << "This should be overridden by derived class without making this a purely virtual method." << std::endl;
    }

    Type getType() const { return type_; }
};

class DerivedA : public Base {
public:
    DerivedA() : Base(DERIVED_A) {
        std::cout << "DerivedA Constructor Called." << std::endl;
    }
    virtual ~DerivedA() {
        std::cout << "DerivedA Destructor Called." << std::endl;
    }

    void doSomething() override {
        std::cout << "DerivedA overridden this function." << std::endl;
    }
};

class DerivedB : public Base {
public:
    DerivedB() : Base(DERIVED_B) {
        std::cout << "DerivedB Constructor Called." << std::endl;
    }
    virtual ~DerivedB() {
        std::cout << "DerivedB Destructor Called." << std::endl;
    }

    void doSomething() override {
        std::cout << "DerivedB overridden this function." << std::endl;
    }
};

class DerivedC : public Base {
public:
    DerivedC() : Base(DERIVED_C) {
        std::cout << "DerivedC Constructor Called." << std::endl;
    }
    virtual ~DerivedC() {
        std::cout << "DerivedC Destructor Called." << std::endl;
    }

    void doSomething() override {
        std::cout << "DerivedC overridden this function." << std::endl;
    }
};    

Base* someFuncOnStack(Base::Type type) {
    Base* pBase = nullptr;

    switch (type) {
        case Base::DERIVED_A: {
            DerivedA a;
            pBase = dynamic_cast<Base*>(&a);
            break;
        }
        case Base::DERIVED_B: {
            DerivedB b;
            pBase = dynamic_cast<Base*>(&b);
            break;
        }
        case Base::DERIVED_C: {
            DerivedC c;
            pBase = dynamic_cast<Base*>(&c);
            break;
        }
        default: {
            pBase = nullptr;
            break;
        }
    }
    return pBase;
}

Base* someFuncOnHeap(Base::Type type) {
    Base* pBase = nullptr;

    switch (type) {
        case Base::DERIVED_A: {
        DerivedA* pA = new DerivedA();
        pBase = dynamic_cast<Base*>(pA);
        break;
        }
        case Base::DERIVED_B: {
        DerivedB* pB = new DerivedB();
        pBase = dynamic_cast<Base*>(pB);
        break;
        }
        case Base::DERIVED_C: {
        DerivedC* pC = new DerivedC();
        pBase = dynamic_cast<Base*>(pC);
        break;
        }
        default: {
        pBase = nullptr;
        break;
        }
    }
    return pBase;    
}

int main() {

    // Function With Stack Behavior
    std::cout << "Stack Version:\n";
    Base* pBase = nullptr;
    pBase = someFuncOnStack(Base::DERIVED_B);
    // Since the above function went out of scope the classes are on the stack
    pBase->doSomething(); // Still Calls Base Class's doSomething
    // If you need these classes to outlive the function from which they are in
    // you will need to use heap allocation.

    // Reset Base*
    pBase = nullptr;

    // Function With Heap Behavior
    std::cout << "\nHeap Version:\n";
    pBase = someFuncOnHeap(Base::DERIVED_C);
    pBase->doSomething();

    // Don't Forget to Delete this pointer
    delete pBase;
    pBase = nullptr;        

    char c;
    std::cout << "\nPress any key to quit.\n";
    std::cin >> c;
    return 0;
} 
```

输出：

```
Stack Version:
Base Constructor Called.
DerivedB Constructor Called.
DerivedB Destructor Called.
Base Destructor Called.
This should be overridden by derived class without making this a purely virtual method.

Heap Version:
Base Constructor Called.
DerivedC Constructor Called.
DerivedC overridden this function.
DerivedC Destructor called.
Base Destructor Called. 
```

我不是说不能做；我只是在说明尝试这样做的注意事项。尝试做这种事情可能是不明智的。我不知道有什么方法可以做到这一点，除非你有一个包装类，它包含堆栈分配的对象来管理它们的生命周期。我将不得不尝试解决这个问题，看看我是否能想出类似的东西。

# jquery - jQuery Toggle - 跳转到命名锚点并打开它

> ID：11974163
> 
> 赞同：0
> 
> 时间：2012-08-15T17:32:23.487
> 
> 标签：jquery, html, toggle, anchor

这是我正在使用的[http://jsfiddle.net/wajPw/](http://jsfiddle.net/wajPw/)

在示例中，请注意第 1 节的第一句中有一个上标“1”。

当用户点击“1”时，我想跳转到页面底部的“参考”部分，同时打开该内容。我已经能够让它跳到锚点或打开，但不能同时打开。我也一直在尝试使用“window.location.hash”，但不确定这是否是正确的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T17:44:28.120

像这样的东西会模仿锚跳跃。

```
$('a[href=#refs]').click(function(e){
    e.preventDefault(); //disable the default action of jumping to the link

    //open it before we get there?
    $('a[name=refs]').parent().click(); 

    //references offset..
    var refsOffset = $('a[name=refs]').offset().top;

    //body,html animate selector is a cross-browser fix.
    $('body, html').animate({
        scrollTop: refsOffset
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T17:41:28.530

这可能会帮助您上路。

```
$('sup').on('click', function(){
    $('a[name="refs"]').parent().next().slideDown();
}); 
```

当然，这不会切换与指示的数字相对应的 li，但我不确定这是否是您想要的。

[http://jsfiddle.net/wajPw/1/](http://jsfiddle.net/wajPw/1/)

# apache - 使用完整的查询语句重定向选定路径下的所有图像

> ID：11974165
> 
> 赞同：0
> 
> 时间：2012-08-15T17:32:26.900
> 
> 标签：apache, .htaccess

我有以下 .htaccess 文件

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
RewriteRule ^css/.*$ - [PT]
RewriteRule ^flash/.*$ - [PT]
RewriteRule ^images/user-images/(.*)$ /index.php?image=$1 [QSA]
RewriteRule ^inc/.*$ - [PT]
RewriteRule ^js/.*$ - [PT]
RewriteRule ^swf/.*$ - [PT] 
```

我需要调整其中一行来接受和维护查询变量

```
RewriteRule ^images/user-images/(.*)$ /index.php?image=$1 [QSA] 
```

这是的示例网址如下所示：

```
http://domain.com/images/user-images/Montreal/private/2012_08_10/YzAbCdE.jpg?lang=fr 
```

lang 变量总是被剥离我如何仍然让上面的 url 工作并重定向到[http://domain.com/images/user-images/Montreal/private/2012_08_10/YzAbCdE.jpg](http://domain.com/images/user-images/Montreal/private/2012_08_10/YzAbCdE.jpg)而不会丢失 lang=fr

谢谢你的帮助 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:49:28.600

如果我理解正确你想要

```
http://domain.com/images/user-images/path/YzAbCdE.jpg?lang=fr 
```

映射到

```
/index.php?image=path%2FYzAbCdE.jpg&lang=fr 
```

这将是您的重写规则：

```
RewriteRule ^images/user-images/(.*)$ /index.php?image=$1 [QSA] 
```

应该做。特别是 [QSA] 应该保留语言参数，如果你想剥离语言参数，你需要 [QSD] 而不是 [QSA]。

如果这不起作用，可能是因为您的 apache 服务器太旧并且不知道 QSA。

但是，您可以尝试通过以下方式替换上述重写规则：

```
RewriteRule ^images/user-images/([^?]*)$ /index.php?image=$1
RewriteRule ^images/user-images/([^?]*)?(.*)$ /index.php?image=$1&$2 
```

# c++ - 重载宏

> ID：11974170
> 
> 赞同：3
> 
> 时间：2012-08-15T17:32:59.993
> 
> 标签：c++, visual-studio-2010, macros, c-preprocessor, variadic-macros

我试图通过参数的数量来重载宏。
当然，我实际上不能重载宏。

我试过使用可变参数宏来选择正确的宏（使用如果`__VA_ARGS__`不存在它应该删除它之前的最后一个逗号的事实 - **[GCC参考](http://gcc.gnu.org/onlinedocs/cpp/Variadic-Macros.html)**）：

```
#define TEST1() printf("TEST1");
#define TEST2() printf("TEST2");

#define CHOOSER(x, y,FUNC,...) FUNC()

#define MANIMACRO(...) CHOOSER(,__VA_ARGS__,TEST1,TEST2)

int main(void)
{
    MANIMACRO(1);
    MANIMACRO();
} 
```

这个想法是，如果`__VA_ARGS__`存在，它应该将 4 个参数传递给**CHOOSER**，其中第三个参数应该与未使用的参数一起“消失”。所以会选择 TEST1。

如果没有参数，则该参数`__VA_ARGS__`将为空，并且应该已删除昏迷，因此将选择并使用**TEST2 。**

所以，我想这不起作用，因为`__VA_ARGS__`可能仅在预处理阶段结束时才被删除，在整个事情已经扩展之后。

那么，我该怎么做呢？（在 vs2010 中）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T17:48:08.540

基于[这个答案](https://stackoverflow.com/a/9338429/390913)：

```
#define TEST1(expr)           printf("test1")
#define TEST2(expr, explain)  printf("test2")

#define N_ARGS_IMPL2(_1, _2, count, ...) \
   count
#define N_ARGS_IMPL(args) \
   N_ARGS_IMPL2 args
#define N_ARGS(...) N_ARGS_IMPL((__VA_ARGS__, 2, 1, 0))
 /* Pick the right helper macro to invoke. */
#define CHOOSER2(count) TEST##count
#define CHOOSER1(count) CHOOSER2(count)
#define CHOOSER(count)  CHOOSER1(count)
 /* The actual macro. */
#define TEST_GLUE(x, y) x y
#define TEST(...) \
   TEST_GLUE(CHOOSER(N_ARGS(__VA_ARGS__)), \
               (__VA_ARGS__))

int main() {
  TEST(one); // singleArgumentExpansion(one)
  TEST(two, "foopy"); // twoArgumentExpansion(two, "foopy")
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T18:01:40.713

首先，您链接的页面说明它是 GCC 扩展。如果您按照标签所暗示的那样使用 Visual Studio 2010，我并不感到惊讶它不起作用。

那么你没有正确使用它：你需要`##`在昏迷和`__VA_ARGS__`. 如果我这样做并修复使两个 TESTx 宏都打印 TEST1 的错字，我会得到 gcc 4.4 所期望的行为

```
#include <stdio.h>

#define TEST1() printf("TEST1\n");
#define TEST2() printf("TEST2\n");

#define CHOOSER(x, y, FUNC,...) FUNC()

#define MANIMACRO(...) CHOOSER(,##__VA_ARGS__,TEST1,TEST2)

int main(void)
{
    MANIMACRO(1);
    MANIMACRO();
} 
```

# android - 如何知道我的 Android 设备（Galaxy）上有哪些 SQLite 数据库

> ID：11974171
> 
> 赞同：0
> 
> 时间：2012-08-15T17:33:03.487
> 
> 标签：android, sqlite, galaxy

您好（第一次上论坛），我正在 Eclipse 中开发 Android 应用程序，并使用我的三星 Galaxy S2 进行测试和调试。我了解数据库文件存储在 /data/data/ 中的某个位置。我的手机没有“根”我所知道的，我没有运气通过 adb 访问这个文件夹。

因此，如果我以编程方式创建数据库，例如

```
myDatabaseOpenHelper = new DatabaseOpenHelper(context, "foo",   null, 1);
myDatabaseOpenHelper = new DatabaseOpenHelper(context, "bar",   null, 1);
myDatabaseOpenHelper = new DatabaseOpenHelper(context, "yet_a_database",    null, 1); 
```

（myDatabaseOpenHelper 是 SQLiteOpenHelper 类型）然后设备可能最终包含我不知道或忘记的数据库。真的没有办法获得概览吗？如果没有任何效果，我可以重置 SQLite，删除所有内容吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T17:35:44.523

数据库将存在于 /data/data/[your packagename]/databases。

您可以通过转到应用程序的应用程序信息来清除所有数据库，然后`Clear Data`

# git - 限制用户的推送命令权限

> ID：11974172
> 
> 赞同：0
> 
> 时间：2012-08-15T17:33:08.723
> 
> 标签：git, github, branch, githooks

我怎么能不允许用户进行要在远程存储库中创建新分支的推送？
无论如何不要让用户推送到 github 中的某个远程分支，例如限制他/她推送到 origin/master 分支？（考虑到该帐户不是组织帐户。我习惯使用 gitolite 来执行此操作，但由于它是 github，我似乎不知道它是如何完成的）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T17:43:14.240

您不能在 github 上运行自定义脚本。这将允许恶意用户破坏他们的服务器。如果您希望此限制对他们有所帮助，那么您可以让他们使用本地 git 挂钩。如果出于安全考虑，您希望此限制是绝对的，那么您不能将它们推送到 github。

# apache-flex - 有没有办法在 Adob e Flex AIR 应用程序中将主机名外部化？

> ID：11974174
> 
> 赞同：1
> 
> 时间：2012-08-15T17:33:14.247
> 
> 标签：apache-flex, configuration-files

我不喜欢在服务和频道配置等文件中硬编码主机名。当我们有多个开发人员和多个开发人员环境时，它变得难以管理。有没有办法通过编译应用程序之外的本地文件将这些外部化？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T17:41:33.560

回答你的问题；是的，有办法。

添加一些额外的细节；我在我的一个客户端应用程序中所做的是使用 HTTPService（或者您可以使用 URLLoader）加载 XML 文件。XML 文件包含其他服务的各种端点，其中包括其他 HTTPServices 和我们的 AMF 服务器的本地端点。

在任何给定的 HTTPService、WebService 或 RemoteObject 标记上，您都可以在运行时设置相关属性。

# javascript - 了解 Marionette 中 Backbone.js 的布局

> ID：11974176
> 
> 赞同：8
> 
> 时间：2012-08-15T17:33:29.503
> 
> 标签：javascript, backbone.js, marionette, backbone-views, backbone-relational

我想我可能对`Marionette.Layout`打算如何使用有一个根本的误解。

我正在尝试这样的事情：

![在此处输入图像描述](../Images/5a09998dd0553353d3b54e6eadde7033.png)

布局包括两个`Marinotette.ItemView`s：“Explode”`ItemView`和“PopStar” `ItemView`。此布局旨在始终包含这些视图，因此我尝试这样做：

```
var TheLayout = Backbone.Marionette.Layout.extend({
    template: '#the=layout-template',
    regions: {
        explode: '#explode-region',
        popstar: '#popstar-region'
    }
    initialize:function(options){
        _.bindAll(this);

        var explodeView = new ExplodeView();
        this.explode.show(explodeView);        // <-- This throws and exception because the regions are not available yet

    }
}) 
```

但看起来这些区域在布局渲染之前不可用。我在添加视图之前尝试调用`this.render()`，但这不起作用。我很确定这里的根本问题是我在错误的情况下应用了布局。

在这种情况下我应该怎么做？什么时候使用正确`Marionette.Layout`？

谢谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-15T22:35:27.683

`onRender`在布局的方法中显示区域视图。代码：

```
var TheLayout = Backbone.Marionette.Layout.extend({
    template: '#the=layout-template',
    regions: {
        explode: '#explode-region',
        popstar: '#popstar-region'
    }
    onRender: function() {
        var explodeView = new ExplodeView();
        this.explode.show(explodeView);
    }
}) 
```

请注意，在这种情况下，`_.bindAll(this)`不需要。

# objective-c - 从主视图获取标签的位置

> ID：11974178
> 
> 赞同：1
> 
> 时间：2012-08-15T17:33:33.730
> 
> 标签：objective-c, ios, uiview, position, subview

我有一个 UILabel（名称：lbl）和一个 UIView，除了主视图（名称：myView）我将我的标签添加到 myView 作为子视图

现在 ！我想在主视图中获取标签的位置！不在我的视图中

这是我的项目：

[http://www.mediafire.com/?w63bnurf28n8cnb](http://www.mediafire.com/?w63bnurf28n8cnb)

我不想使用此代码：

```
CGPoint pos;
pos.x=myView.frame.origin.x+lbl.frame.origin.x  ;
pos.y= myView.frame.origin.y+lbl.frame.origin.y ; 
```

因为如果我想使用 CGAffineTransformMakeRotation 旋转 myView 这个代码不起作用！

我想要标签在主视图中的位置！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:08:18.340

`UIView`具有用于在视图层次结构中上下转换点的方法:) 这些中的任何一个都可以解决问题。

```
 [mainView convertPoint:lbl.center fromView:myView];
    [myView convertPoint:lbl.center toView:mainView]; 
```

# ruby-on-rails-3 - SublimeLinter 对 rails 进行语法检查

> ID：11974179
> 
> 赞同：1
> 
> 时间：2012-08-15T17:33:35.177
> 
> 标签：ruby-on-rails-3, ubuntu-12.04

我刚刚安装了[https://github.com/SublimeLinter/SublimeLinter](https://github.com/SublimeLinter/SublimeLinter) 并且想知道：默认情况下可以切换检查 ruby​​ 吗？他们编写了 Ruby - 语法检查，`ruby -wc`但是如何调用它？是否有任何特定于 Rails 的插件？没有找到其他...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T02:51:29.220

我*不太*确定你在问什么……但如果你想改变 SublimeLinter 以便它运行除 之外的东西`ruby -wc`，那么你可以编辑文件中的第 10 行`~/Library/Application Support/Sublime Text 2/Packages/SublimeLinter/sublimelinter/modules/ruby.py`。

例如，您可以采取以下步骤让 SublimeLinter 使用您的 gemset 的 ruby​​：

*   按住选项键
*   单击`Go`Finder 中的菜单
*   选择`Library`
*   导航到`Application Support/Sublime Text 2/Packages/SublimeLinter/sublimelinter/modules`
*   `ruby.py`在 Sublime Text 2 中打开文件
*   将第 10 行更改`'executable': 'ruby',`为`'executable': '/Users/YOUR-USER-NAME/.rvm/bin/rvm-auto-ruby',`
*   重新启动崇高文本 2

**更新：**

我刚刚发现了一个更简单的方法来完成这个......

`Sublime Text 2`您可以通过打开菜单、进入 Preferences -> Package Settings -> SublimeLinter 并选择来更改 SublimeLinter 设置以使 SublimeLinter 使用您的 gemset 的 ruby `Settings - User`​​。将此文本添加到文件中，保存并重新启动 Sublime Text 2：

```
{
    "sublimelinter_executable_map":
    {
        "ruby": "rvm-auto-ruby"
    }
} 
```

# c# - 如何获取已登录用户在 sharepoint 2010 中可以访问的子站点

> ID：11974190
> 
> 赞同：1
> 
> 时间：2012-08-15T17:34:08.753
> 
> 标签：c#, sharepoint-2010, sharepoint-clientobject

我需要检索用户可以使用客户端对象模型访问的子站点。

这是我所拥有的：

```
 NetworkCredential credential = new NetworkCredential(user, pwd, domain);
          ClientContext clientContext = new ClientContext(string.Format("http://{0}:{1}/", server, port));
          clientContext.Credentials = credential;

            Web oWebsite = clientContext.Web;

            clientContext.Load(oWebsite, website => website.Webs, website => website.Title);
            clientContext.ExecuteQuery();

            infos = new List<Infos>();

            Infos info = null;

            for (int i = 0; i != oWebsite.Webs.Count; i++)
            {
                info = new Infos();

                info.SubSite = oWebsite.Webs[i].Title;
                info.UrlSubSite = oWebsite.Webs[i].ServerRelativeUrl;

                ListCollection lists = oWebsite.Webs[i].Lists;
                clientContext.Load(lists);
                clientContext.ExecuteQuery();

                foreach (var list in lists)
                {
                    Lists myList = new Lists();
                    myList.Title = list.Title;

                    info.Listas.Add(myList);
                }

                infos.Add(info);
            }

            var query = from Infos i in infos
                        select i.SubSite;

            return query.ToList();
        }
        catch(Exception ex)
        {
            throw ex;
        }

        return null;
    } 
```

=====

使用此代码，我收到**403 禁止错误**。我的客户端用户无权访问根站点（我在 ClientContext 构造函数中使用）。但他有一些子网站。我需要使用客户端对象模型获取他有权访问的子站点（只需将它们全部列出）。

还有其他方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-05T11:32:17.530

```
ClientContext clientContext =
 new ClientContext(string.Format("http://{0}:{1}/", 
                                            server, 
                                            port)); 

WebCollection webs = clientContext.Web.GetSubwebsForCurrentUser(null); 
```

# shell - 文件 glob() 什么时候理解**？

> ID：11974196
> 
> 赞同：4
> 
> 时间：2012-08-15T17:34:29.543
> 
> 标签：shell, glob

在 Java7 中，`sun.nio.fs.Globs`似乎`getPathMatcher()`将成语理解`**`为一种**跨目录边界**匹配零个或多个字符的方法（请参阅[getPathMatcher javadoc](http://docs.oracle.com/javase/7/docs/api/java/nio/file/FileSystem.html#getPathMatcher%28java.lang.String%29 "java.nio.file.FileSystem.getPathMatcher()")）。

我可以发誓一些适当的选项设置的shell（zsh，bash，tcsh）在某些时候给了我相同的行为。但是对于我的一生，我不记得如何启用它，我什至开始怀疑我的记忆是否我在某个时候工作过......（编辑：zsh 提供了这种行为，但仅适用于目录，即`"**.gz"`不'不匹配`foo/bar/fubar.gz`，但`"**/*.gz"`确实如此）。

事实上，查看各种 glob 实现的文档（例如 POSIX glob(3)、glob(7) 和 Perl 的 File::Glob）似乎并没有在任何地方提到这种行为。一个例外是 Ruby`Dir.glob()`显式处理`**`.

（最初的问题是：“有人知道如何在 unix shell（例如 zsh）中启用此行为吗？”，但现在请参阅下面的已编辑问题）。

作为一个额外的问题：有人知道如何`'**'`在 Google 中搜索吗？...

* * *

**已编辑的问题**

事实上，我的 shell 似乎确实接受了这种行为`zsh`（感谢断言这一事实​​并促使我进一步研究的响应）。我认为它不匹配的原因来自以下微妙之处：`"**.gz"`不会匹配 a `<path>/<prefix>.gz`，但`"**/*.gz"`会匹配。这是一个例子。让我们从以下树开始：

```
$ find . -type f | sort
./foo/a.gz
./foo/bar/fubar/abc.gz
./foo/bar/x.gz
./foo/bar/y.gz
./xyz.gz 
```

`"**.gz"`不匹配内部子目录，只匹配`"*.gz`" 将：

```
$ ls -1 **.gz
xyz.gz 
```

而`"**/*.gz"`确实：

```
$ ls -1 **/*.gz
foo/a.gz
foo/bar/fubar/abc.gz
foo/bar/x.gz
foo/bar/y.gz
xyz.gz 
```

现在，将其与 Java 行为进行比较：

```
@Test
public void testStar() {
    String pat = Globs.toUnixRegexPattern("*.gz");
    assertEquals("^[^/]*\\.gz$", pat);
}

@Test
public void testStarStar() {
    // '**' allows any number of directories on the path
    // this apparently is not POSIX, although darn useful
    String pat = Globs.toUnixRegexPattern("**.gz");
    assertEquals("^.*\\.gz$", pat);
} 
```

显然（从正则表达式），这里`"**"`匹配路径上的任何字符（即它变成`".*"`正则表达式），无论是否在子目录中，以及是否作为文件名的一部分。

（免责声明：`Globs`是一个副本，`sun.nio.fs.Globs.toUnixRegexPattern(String glob)`因为我需要跨平台的东西）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T18:51:40.247

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-15T18:54:28.997

`**` is interpreted as `(*/)#` (zero or more directories) in Zsh's extended glob syntax, which is implemented in Zsh-specific C code ([`Src/glob.c`](http://zsh.git.sourceforge.net/git/gitweb.cgi?p=zsh/zsh;a=blob;f=Src/glob.c;hb=HEAD)). This behavior is not optional.

When `shopt -s globstar` is enabled in Bash, it acts similarly in Bash's extended glob syntax, which is implemented in Bash-specific C code ([`pathexp.c`](http://git.savannah.gnu.org/cgit/bash.git/tree/pathexp.c)). This is off by default.

In traditional UNIX `glob`, `**` is interpreted the same as `*`.

# mysql - 从另一个表中的 SELECT * 中排除一个表中的结果？

> ID：11974199
> 
> 赞同：-5
> 
> 时间：2012-08-15T17:34:35.900
> 
> 标签：mysql

> **可能重复：**
> [来自 1 个表的 MySQL SELECT 结果，但根据另一个表排除结果？](https://stackoverflow.com/questions/2862778/mysql-select-results-from-1-table-but-exclude-results-depending-on-another-tabl)

我希望我不是在问已经回答的问题..没有看到。看起来很简单，但我无法让它工作。

我有两张桌子：Unit 和 Lease。

我想要从单元表中列出所有打开的单元（建筑物和单元单元号）的列表，不包括租赁表中 enddate 字段中为空的单元。

表的结构（我删除了此示例不需要的其他字段：

```
CREATE  TABLE Unit(
    UnitKey     Int NOT NULL AUTO_INCREMENT,
    UnitNumber  Char(5) NOT NULL,
    BuildingKey Int     NOT NULL,
    CONSTRAINT   UNIT_PK    PRIMARY KEY(UnitKey),
    CONSTRAINT   UNIT_BLDG_FK     FOREIGN KEY(BuildingKey)
                    REFERENCES Building(BuildingKey));

CREATE  TABLE Lease(
    LeaseKey  Int                   NOT NULL AUTO_INCREMENT,
    UnitKey   Int                  NOT NULL,
    EndDate     Date                   NULL,
    CONSTRAINT LEASE_PK               PRIMARY KEY(LeaseKey),
    CONSTRAINT      LEASE_UNIT_FK   FOREIGN KEY(UnitKey) REFERENCES Unit(UnitKey)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:37:57.550

尝试这个：

```
select u.*
from units u
where not exists (select 1 from lease l where l.unitkey = u.unitkey and l.enddate is null) 
```

在其他数据库引擎中，您将使用“not in”。但是，这在 mysql 中优化得更好。

# jquery - 您如何使用 jQuery 设置居中图像顶部的动画

> ID：11974200
> 
> 赞同：-1
> 
> 时间：2012-08-15T17:34:38.417
> 
> 标签：jquery, jquery-animate

我有一个简单的网页，由水平和垂直居中的图像组成，因此它显示在可见页面的绝对中心。我正在尝试使用 jQuery animate 将此图像迁移到页面顶部。

我使用两个 div 和一些 css 使图像居中。

html...

```
<div id="outer">
    <div id="inner"><img src="images/png/logo.png" id="logo-index" width="84px" height="100px"/></div>
</div> 
```

css...

```
#outer{
position: absolute;
top: 50%;
left: 0px;
width: 100%;
height: 1px;
overflow: visible;
}

#inner{
width: 82px;
height: 100px;
margin-left: -41px;
position: absolute;
top: -50px;
left: 50%;
}

#logo-index{
opacity: 0;
} 
```

图像最初使用 opacity 0 隐藏，然后使用 jQuery 淡入查看。然后 id 喜欢使用 jQuery animate 将图像移动到页面顶部。

jQuery...

```
$('#logo-index').animate({opacity: "1"}, 1500).delay(3000, function(){
    //jQuery move to top of page here...
}); 
```

我用谷歌搜索了很多不同的方法，我现在完全不知道实现这一目标的正确方法。我没有足够的动画功能经验来实现这一点。我肯定有人在那里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:32:45.913

动画#outer，因为它是图像的“容器”，具有 50% 的顶部位置。

```
$('#logo-index').animate({opacity: "1"}, 1500).delay(3000, function(){
    //jQuery move to top of page here...
    $('#outer').animate({top:"10%"}, 1500);
}); 
```

可以在这里测试：[jsfiddle live code to animate](http://jsfiddle.net/8PSbY/)

我希望它有帮助！干杯

# c++ - 进行自定义 cout 时出错

> ID：11974206
> 
> 赞同：3
> 
> 时间：2012-08-15T17:35:09.903
> 
> 标签：c++

我正在尝试制作一个自定义 cout 类，当我尝试运行不处理链接的代码版本时，它将文本输出到控制台输出和日志文件（out<<"one"<<"two"）它工作正常，但是当我尝试让它处理链接时，它给了我“这个运算符函数的参数太多”。我错过了什么？

```
class CustomOut
{
    ofstream of;

public:
   CustomOut()
   {
     of.open("d:\\NIDSLog.txt", ios::ate | ios::app);
   }

   ~CustomOut()
   {
     of.close();
   }

   CustomOut operator<<(CustomOut& me, string msg)
    {
    of<<msg;
    cout<<msg;

    return this;
}}; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T17:42:50.580

您需要一个`operator<<`返回对对象实例的引用的成员：

```
class CustomOut
{
  ...

  CustomOut& operator<<(string const& msg)
  {
    // Process message.
    f(msg);

    return *this;
  }
}; 
```

这将允许您以`CustomOut`链接方式“流式传输”到您的班级：

```
CustomOut out;
out << str_0 << str_i << ... << str_n; 
```

# java - 在数组中查找两个最相似的值（Java）

> ID：11974208
> 
> 赞同：4
> 
> 时间：2012-08-15T17:35:16.037
> 
> 标签：java, arrays, integer

我有一个整数数组，我想找到两个最相似的值（最小差异）。

示例：如果数组中的值为 ，则`80,100,500,600,501,505`最相似的两个值为`500`和`501`。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T18:14:13.633

这似乎是一项小任务，我们可以将这个问题解决为：

1：应用任何有效的**排序**算法。

2：然后比较**相邻的元素**，并选择**差异**较小的元素。

代码在这里：

```
void nearestFinder(){
   int array[];
//apply  sorting algorithm - say selection sort
pre_diff = 0;
new_array = selection_sort(array);
   for(int i =0;i<new_array.length();i++){
      diff = Math.abs(new_array[i]-new_array[i+1]);
      if(diff>pre_diff){
       index =i;
       pre_diff =diff;
       }

      }
print(new_array[index],new_array[index+1])
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T17:38:02.213

这个问题的诀窍是首先对数组进行排序。这将使您只需要比较彼此相邻的数字；选择差异最小的 2 个。

伪代码：

```
sort the array: use Arrays.sort()
 int max_difference = Integer.MAXVALUE
int val1, val2;
for(i=0; i< array_size -1; ++i) {
 int x = array[i+1] - array[i];
 if(x <= max_difference) {
   max_difference = x;
   val1 = array[i];
   val2 = array[i+1];
 }
} 
```

最后，`val1`将`val2`包含 2 个最相似的值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-15T18:22:56.607

如果对数据进行排序，时间复杂度为 O(N * ln(N))

```
int[] ints = {80, 100, 500, 600, 501, 505};
Arrays.sort(ints);
int value = 0, delta = Integer.MAX_VALUE;
for (int i = 0; i < ints.length - 1; i++) {
    int d = ints[i + 1] - ints[i];
    if (d < delta) {
        delta = d;
        value = ints[i];
    }
}
System.out.printf("value " + value + " and " + (value + delta)); 
```

印刷

```
value 500 and 501 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T17:39:31.363

我将遍历每个元素 O(N^2)。要找到两个最相似的元素，请使用减法并将差异与存储的最低差异进行比较。然后，一旦找到最小的差异（忽略您正在搜索的数字），您还可以存储您正在搜索的数字以及您从中减去的数字。您还应该使用绝对值，以便数字的大小是您所知道的。

# ios - 如何处理 RESTKit 可达性断言失败

> ID：11974209
> 
> 赞同：0
> 
> 时间：2012-08-15T17:35:15.683
> 
> 标签：ios, restkit

设置 RKObjectManager 时，可能会发生以下情况：

```
*** Assertion failure in -[RKReachabilityObserver validateIntrospection] 
```

在 Google 网上论坛上引用： [https ://groups.google.com/forum/?fromgroups#!topic/restkit/JQ4I6MZrVyc%5B1-25%5D](https://groups.google.com/forum/?fromgroups#!topic/restkit/JQ4I6MZrVyc%5B1-25%5D)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T17:35:15.683

至少在我的情况下，答案是：

一旦 RKObjectManager 在设置期间提供了它的 baseURL，如下所示：

```
RKObjectManager* manager = [RKObjectManager managerWithBaseURLString:MY_BASE_API_URL]; 
```

后面直接替换底层的 RKClient ，像这样：

```
manager.client = [RKClient clientWithBaseURL:[NSURL URLWithString:MY_BASE_API_URL]]; 
```

将导致此错误：

```
 *** Assertion failure in -[RKReachabilityObserver validateIntrospection] 
```

**因此，一旦设置了顶级 RKObjectManager，就不要尝试替换 RKClient。**

似乎这个问题有几个变种，还有其他人想权衡吗？

# jquery - 根据脚本状态更改文本（展开或折叠）

> ID：11974212
> 
> 赞同：0
> 
> 时间：2012-08-15T17:35:25.390
> 
> 标签：jquery, css

我正在尝试根据其折叠或展开将静态“显示/隐藏公告”标题更改为动态“显示公告”或“隐藏公告”。目前，无论内容是折叠还是展开，它都只显示“显示/隐藏公告”，我想将其更改为动态。

我的代码：

```
 <div class="collapsibleContainer" title="Show/Hide Announcement">
        <img src="images/announce.jpg" />
    </div> 
```

我的脚本：

```
<script language="javascript" type="text/javascript">
    $(document).ready(function() {
        $(".collapsibleContainer").collapsiblePanel();
    });
</script>
<script>
(function($) {
    $.fn.extend({
        collapsiblePanel: function() {
        // Call the ConfigureCollapsiblePanel function for the selected element
        return $(this).each(ConfigureCollapsiblePanel);
    }
  });
})(jQuery);

function ConfigureCollapsiblePanel() {
    $(this).addClass("ui-widget");

    // Check if there are any child elements, if not then wrap the inner text within a new div.
    if ($(this).children().length == 0) {
    $(this).wrapInner("<div></div>");
    }    

    // Wrap the contents of the container within a new div.
    $(this).children().wrapAll("<div class='collapsibleContainerContent ui-widget-content'></div>");

    // Create a new div as the first item within the container.  Put the title of the panel in here.
    $("<div class='collapsibleContainerTitle ui-widget-header'><div>" + $(this).attr("title") + "</div></div>").prependTo($(this));

    // Assign a call to CollapsibleContainerTitleOnClick for the click event of the new title div.
    $(".collapsibleContainerTitle", this).click(CollapsibleContainerTitleOnClick);
}

function CollapsibleContainerTitleOnClick() {
    // The item clicked is the title div... get this parent (the overall container) and toggle the content within it.
    $(".collapsibleContainerContent", $(this).parent()).slideToggle();
}

</script> 
```

我的 CSS：

```
.collapsibleContainer
{
    margin: 0 auto;
    width: 550px;
    padding-bottom: 10px;

}

.collapsibleContainerTitle
{
    cursor:pointer;
}

.collapsibleContainerTitle div
{
    padding-top:5px;
    padding-left:10px;
    color:#FFFFFF;
    font-family: 'Capriola';
    font-weight: 400;
    background-images: url(images/bg.png);
} 
```

我更新的 CSS 以显示不透明度，但它改变了文本。我只希望背景和边框淡出。悬停为 1.0：

```
.collapsibleContainerTitle div
{
    padding-top:5px;
    padding-left:10px;
    color:#FFFFFF;
    font-family: 'Capriola';
    font-weight: 400;
    background-images: url(images/bg.png);
opacity:0.4;
filter:alpha(opacity=40); /* For IE8 and earlier */
}

.collapsibleContainerTitle div:hover
{
    padding-top:5px;
    padding-left:10px;
    color:#FFFFFF;
    font-family: 'Capriola';
    font-weight: 400;
    background-images: url(images/bg.png);
opacity:1.0;
filter:alpha(opacity=100); /* For IE8 and earlier */
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:49:05.680

你必须移动这个脚本块

```
<script language="javascript" type="text/javascript">
    $(document).ready(function() {
        $(".collapsibleContainer").collapsiblePanel();
    });
</script> 
```

在第二个脚本块下方。

这是小提琴：

[http://jsfiddle.net/EWJby/](http://jsfiddle.net/EWJby/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T17:50:22.383

像这样的东西：

```
function CollapsibleContainerTitleOnClick() {
    $(".collapsibleContainerContent", $(this).parent()).slideToggle(function() {
        $(".collapsibleContainerTitle", $(this).parent()).children(':first')
           .text($(this).is(':visible')?'Hide Announcement':'Show Announcement');
    });
} 
```

[**小提琴**](http://jsfiddle.net/7WKXm/1/)

# string - 以下用于查找不同字符串的算法是否有效？

> ID：11974215
> 
> 赞同：0
> 
> 时间：2012-08-15T17:35:38.837
> 
> 标签：string, algorithm

我最近发现了一个类似的问题：

```
"Given an array of strings, return the number of distinct strings in that array." 
```

我想出了这个解决方案：

```
1\. Get number_of_strings, which equals the number of strings in the input array
2\. Get number_of_non_redundant, which equals the length of the input array cast as a set
3\. Return 2 times number_of_non_redundant - number_of_strings 
```

所以，我的问题是，这个算法是否适用于所有数据集？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T17:40:35.130

考虑字符串数组`["a", "a", "a", "d", "d", "d"]`。

`number_of_strings`是 6；`number_of_non_redundant`是 2\. 你提议退货`2 * 2 - 6 = -2`。所以...不，您的算法不适用于所有数据集。

除非我对这个问题有很大的误解，否则只是返回`number_of_non_redundant`总是有效的，因为它是你想要返回的定义。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T18:07:29.133

正如其他人所指出的，简单地返回`number_of_non_redundant`似乎是这个问题的答案。

这是确定的可能解决方案`number_of_non_redundant`：

> 1）创建一个哈希集（特定于语言）
> 
> 2）遍历整个数组，在数组的每个元素上检查该元素是否存在于哈希集中，如果不存在，则添加它。
> 
> 3) 返回哈希集的大小。

在此处使用哈希集提供了恒定时间操作（添加、包含）。

此外，我想指出您不能（至少我在语言中不知道这一点）简单地*将*数组转换为集合。*铸造*是一个恒定的时间操作。这是两种不同的数据结构，为了从数组中获取元素并将它们放入集合中，需要遍历数组并将元素输入到集合中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T17:57:24.753

首先按字典顺序对数组进行排序，然后使用标志变量循环遍历它，以跟踪元素 i-th 和 (i-1)-th 之间的变化？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T18:00:33.460

此算法**不适**用于所有数据集。不过，它可能适用于特定示例。

```
say n = number of non redundant strings 
p = number of strings in original array 
```

照你说的`2n-p = n => n= p`

您的算法仅在 时有效`(number of non redundant strings = length of original array)`，这意味着仅当原始数组是一个集合时。

只是提示一下，如果您有足够的可用内存，则解决此问题的理想方法是散列，或者您可以使用排序就地进行，但与散列相比需要更长的时间

# java - 在通话期间运行 SpeechRecognizer

> ID：11974218
> 
> 赞同：5
> 
> 时间：2012-08-15T17:35:49.480
> 
> 标签：java, android

有没有办法在通话时运行 SpeechRecognizer？我是这样做的：

*   `BroadcastReceiver`处理电话状态的变化（例如摘机）。
*   在`SpeechRecognizer`当前（主）线程中启动，因为它只能在主线程中启动。应用程序上下文用于识别器（当前上下文，给广播接收器，不能开始使用）

但不幸的是，另一边的人听不到我的声音（虽然语音识别工作正常）。在外面，识别器已经“消耗”了我的声音并且没有发送它。

我知道在调用期间在主线程中做事是危险的，但是有没有办法在调用期间以某种方式运行识别器？

更新：我正在尝试`TelephonyManager`侦听器而不是 a `BroadcastReceiver`，但是一些内部服务与 NPE 相冲突。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T18:32:09.383

AFAIK 语音通话永远不会从 Android 端处理。应用程序处理器或通信处理器在任何给定时间都可以控制流，而不是两者。通常，一旦语音通话开始，麦克风和耳机的流控制就会交给通信处理器。奇怪的是，在您的情况下，应用程序处理器正在获得控制权。这看起来是一个错误。

音频流直接由通信处理器处理（这是有道理的，因为在应用程序处理器中执行两次，在最终将处理呼叫的通信处理器中执行一次是浪费处理）。所以我认为这是不可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T07:21:07.963

根据电话型号，如果语音识别器在服务中实现是可能的。我对带有 android v4 的 HTC Rezound 没有任何问题，但是带有 android v2.3 的 Motorola Bionic 无法工作，因为音频管理器崩溃了。即使使用 HTC，识别器也无法听到另一部手机上的人的声音。在扬声器打开的情况下，它会保持报告错误不匹配。

# c - 强大的功能

> ID：11974224
> 
> 赞同：0
> 
> 时间：2012-08-15T17:36:23.783
> 
> 标签：c, embedded

我有两个用于分配和取消分配计时器的功能。

Allocate timer 分配一个定时器，返回一个int给已分配的定时器

```
int allocate_timer(void)
{
  int count = 0;
  int allocated = 0;
    /*Loop to find the first timer that is not allocated*/
    for(count = 0; count< ARRAY_SIZE; count++)
    {
            if(allocated_timers[count] == '0')
            {
                    /*When the next timer available timer is found it is set to allocated and timer is set to zero*/
                    allocated_timers[count] = '1';
                    timers[count] = 0;
                    break;
            }

            else if(allocated > ARRAY_SIZE - 1)
            {
                printf("No timers available\n");
                exit(0);

            }

            else
            {
                allocated++;
            }

    }
    /*Position of the allocated timer is returned*/
    return count;
} 
```

释放计时器，将 int 传入将要释放的位置

```
void deallocate_one_timer(int position)
{       
    if(TIMER_ALLOCATED == allocated_timers[position])
    {
            allocated_timers[position] = '0';
            timers[position] = 0;
    }
} 
```

我无法让它们变得比现在更强大。关于如何让它们变得更好的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T17:43:10.560

该变量`allocated`始终等于`count`（因此可以删除），并且 IMO 使用它可能会造成混淆，`'0'`并且`'1'`作为`allocated_timers`数组中的值。通常它是`0`and `1`。

它们都不会影响代码的健壮性，但代码越容易理解，就越能抵御未来的修改。

当您有两个“并行”数组时，就像您在此处所做的那样，每个计时器都有一个条目 in`timers`和一个相应的条目 in `allocated_timers`，值得考虑是否有一个`struct`包含两个成员的 a 数组更好（在这种情况下可能命名`value`和`allocated`）。有时这并不好，但通常有助于理解代码，因为读者不必发现并记住这两个数组密切相关。

`deallocate_one_timer`如果在将其用作数组索引之前检查它`position`是否在范围内`0`，则可以使调用者的错误使用更加健壮。`ARRAY_SIZE`我并不是说函数有责任进行这些检查，但它们有时有助于诊断其他地方的错误。您可以使用`assert`这样的非必要检查。`assert`有两个好处。首先，它自我说明检查不是这个函数的责任，只是你正在检查其他人是否做了他们应该做的事情。其次，如果您需要使其更小或更快，您可以轻松地禁用程序的非调试版本中的所有断言。

同样，如果释放了当前未分配的计时器，则退出并显示错误消息可能会有所帮助，因为这可能表明存在潜在问题。谁释放它两次可能会在分配它的其他人的任何一方这样做，这意味着其他人突然发现他们不再独占使用他们的计时器。

最后，`timers[index]`在分配和解除分配时都设置为 0。没有什么特别的错误，只是它混淆了哪个函数实际上*负责*确保新分配的计时器具有正确的初始值的问题。deallocate 函数什么都不做，或者它可以将计时器设置为分配的计时器不可能保持的值（可能是 -1，假设计时器从 0 上升），这样在调试时你可以立即知道如果你是使用值为 -1 的计时器，出现问题。

最后，这段代码（显然）不是线程安全的，我认为这是一种非鲁棒性。编写不能在多线程程序中使用的代码并不丢人，尤其是对于甚至可能没有创建线程能力的嵌入式系统。只要这是一个深思熟虑的决定，并记录在案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T18:20:37.790

*   决定是否要使用 '0' 和 '1' 或常量，例如 deallocate_one_timer 中使用的 TIMER_ALLOCATED，并保持一致。

*   您对`allocated`变量的使用是多余的。循环会更好：

    ```
    int allocate_timer(void)
    {
        int count;

        for (count = 0; count < ARRAY_SIZE; count++)
        {
            if (allocated_timers[count] == '0')
            {
                allocated_timers[count] = '1';
                timers[count] = 0;
                return count;
            }
        }
        fprintf(stderr, "No timers available\n");
        exit(EXIT_FAILURE);
    } 
    ```

或者也许最好不要在失败时退出，而是返回并出错。

# backbone.js - 骨干关系更改事件未触发？

> ID：11974226
> 
> 赞同：0
> 
> 时间：2012-08-15T17:36:29.150
> 
> 标签：backbone.js, backbone-relational

我被这件事难住了。我有一个简单的骨干关系模型：

```
window.Site = Backbone.RelationalModel.extend({
    idAttribute: "_id",
    // These are the relations to the user model.
    relations: [{
        type: Backbone.HasMany,
        key: 'users',
        relatedModel: 'window.User'
      }],

}); 
```

我的用户模型（与站点模型相关）如下所示：

```
 //Site User model
  // -------------

  window.User = Backbone.RelationalModel.extend({
    }); 
```

用户模型故意保持沉默，因为我仍在进行原型设计。

我从服务器收到的用于补充站点和用户的 JSON 如下所示：

```
{
_id: foo,
users: [
username: bar,
password: fizz
]} 
```

我被难住的是听众。SiteView（呈现我的 SiteCollection）上的事件如下所示：

```
initialize: function() {

  //basic bindings
  this.model.bind('change', this.setSave, this);
  this.model.bind('destroy', this.remove, this);

  // bindings to sub-models
  this.model.bind('add:users', this.setDetailsView, this);
  this.model.bind('remove:users', this.setSave, this);
  this.model.bind('change:users', this.setSave, this); 
```

`add:users`and`remove:users`事件可以正常触发，但事件`change:users`不会。在渲染我的用户模型的 DetailsView 中，我还有一些简单的事件绑定：

```
initialize: function() {
  this.model.bind('change', this.render, this);
  this.model.bind('destroy', this.remove, this); 
```

但是，由于某种原因，`change:users`SiteView 中的事件不会触发，而`change`DetailsView 中的事件会触发。

这可能是因为：

*   用户模型上的`change`事件在两个不同的视图中绑定了两次？
*   用户模型不是双向的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T21:35:14.007

在我看来，更新：事件并不像您预期​​的那样工作。据我了解，它仅在密钥（即相关模型）更改时触发，但在您更改其属性时不会触发。这意味着，只有当您从一个用户切换到另一个用户时，它才会触发，而不是在您更改现有用户的属性时。这是我对源码第711行的理解。可能有用的是这些方面的东西：

```
this.model.get('users').each(function(user){
    user.bind(change,this.render,this);
},this); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-26T15:18:39.003

更好的解决方案：

```
this.model.bind('relational:change:users', this.setSave, this); 
```

# telerik-grid - Telerik MVC Grid submitChanges 没有网格更改

> ID：11974228
> 
> 赞同：2
> 
> 时间：2012-08-15T17:37:00.613
> 
> 标签：telerik-grid, telerik-mvc

我正在使用 Telerik 的 MVC 网格，我想提交带有一些网格外值的批量编辑模式更改。根据这个[Telerik 论坛](http://www.telerik.com/community/forums/aspnet-mvc/grid/grid-with-inline-edit-as-part-of-larger-form.aspx#2232837)，我可以调用网格的 submitChanges 函数并在 OnSubmitChanges 事件中提供非网格值。仅当网格发生更改时才调用此函数。可能会出现在网格之外更改值但未保存网格值的情况。是否可以强制提交以便可以提交非网格值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T18:18:07.880

好在 Telerik MVC 扩展是开源的。我通过以下方式找到了答案：

```
function SaveCriteriaChanges() {
    var grid = $("#MyGridId").data("tGrid");

    //don't submit if grid fails validation
    if (!grid.validate())
        return false;

    if (grid.hasChanges()) {
        grid.submitChanges();
    } else { //no grid changes to process so force submission
        var additionalValues = {};
        if(!$.telerik.trigger(grid.element, 'submitChanges', { values: additionalValues })) {
            grid.sendValues($.extend({}, additionalValues), 'updateUrl', 'submitChanges');
        }
    }

    return true;
} 
```

# android - 地图在 2.3 中不起作用

> ID：11974229
> 
> 赞同：-1
> 
> 时间：2012-08-15T17:37:06.870
> 
> 标签：android, google-maps, logcat

我有一个用于查找用户当前位置的代码。当我在 android 1.6 中运行我的代码时，我得到了输出。但是我在 android 2.3 中运行我只得到了错误。我的代码有什么问题。

日志猫：

```
08-15 23:03:39.612: E/AndroidRuntime(403): FATAL EXCEPTION: main
08-15 23:03:39.612: E/AndroidRuntime(403): java.lang.NullPointerException
08-15 23:03:39.612: E/AndroidRuntime(403):  at com.android.locationspeecher.MyPositionOverlay.draw(MyPositionOverlay.java:25)
08-15 23:03:39.612: E/AndroidRuntime(403):  at com.google.android.maps.Overlay.draw(Overlay.java:179)
08-15 23:03:39.612: E/AndroidRuntime(403):  at com.google.android.maps.OverlayBundle.draw(OverlayBundle.java:45)
08-15 23:03:39.612: E/AndroidRuntime(403):  at com.google.android.maps.MapView.onDraw(MapView.java:530)
08-15 23:03:39.612: E/AndroidRuntime(403):  at android.view.View.draw(View.java:6880)
08-15 23:03:39.612: E/AndroidRuntime(403):  at android.view.ViewGroup.drawChild(ViewGroup.java:1646)
08-15 23:03:39.612: E/AndroidRuntime(403):  at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
08-15 23:03:39.612: E/AndroidRuntime(403):  at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
08-15 23:03:39.612: E/AndroidRuntime(403):  at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
08-15 23:03:39.612: E/AndroidRuntime(403):  at android.view.View.draw(View.java:6883)
08-15 23:03:39.612: E/AndroidRuntime(403):  at android.widget.FrameLayout.draw(FrameLayout.java:357)
08-15 23:03:39.612: E/AndroidRuntime(403):  at android.view.ViewGroup.drawChild(ViewGroup.java:1646)
08-15 23:03:39.612: E/AndroidRuntime(403):  at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
08-15 23:03:39.612: E/AndroidRuntime(403):  at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
08-15 23:03:39.612: E/AndroidRuntime(403):  at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
08-15 23:03:39.612: E/AndroidRuntime(403):  at android.view.View.draw(View.java:6883)
08-15 23:03:39.612: E/AndroidRuntime(403):  at android.widget.FrameLayout.draw(FrameLayout.java:357)
08-15 23:03:39.612: E/AndroidRuntime(403):  at com.android.internal.policy.impl.PhoneWindow$DecorView.draw(PhoneWindow.java:1862)
08-15 23:03:39.612: E/AndroidRuntime(403):  at android.view.ViewRoot.draw(ViewRoot.java:1522)
08-15 23:03:39.612: E/AndroidRuntime(403):  at android.view.ViewRoot.performTraversals(ViewRoot.java:1258)
08-15 23:03:39.612: E/AndroidRuntime(403):  at android.view.ViewRoot.handleMessage(ViewRoot.java:1859)
08-15 23:03:39.612: E/AndroidRuntime(403):  at android.os.Handler.dispatchMessage(Handler.java:99)
08-15 23:03:39.612: E/AndroidRuntime(403):  at android.os.Looper.loop(Looper.java:130)
08-15 23:03:39.612: E/AndroidRuntime(403):  at android.app.ActivityThread.main(ActivityThread.java:3683)
08-15 23:03:39.612: E/AndroidRuntime(403):  at java.lang.reflect.Method.invokeNative(Native Method)
08-15 23:03:39.612: E/AndroidRuntime(403):  at java.lang.reflect.Method.invoke(Method.java:507)
08-15 23:03:39.612: E/AndroidRuntime(403):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
08-15 23:03:39.612: E/AndroidRuntime(403):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
08-15 23:03:39.612: E/AndroidRuntime(403):  at dalvik.system.NativeStart.main(Native Method) 
```

这是我的 MyPositionOverlay 代码：

```
public class MyPositionOverlay extends Overlay {

    Location location;
    private final int mRadius=5;

    @Override
    public void draw(Canvas canvas,MapView mapView,boolean shadow){

        Projection projection=mapView.getProjection();

        if(shadow==false){
            Double latitude=location.getLatitude()*1E6;
            Double longitude=location.getLongitude()*1E6;

            GeoPoint geoPoint;
             geoPoint=new GeoPoint(latitude.intValue(),longitude.intValue());

             Point point=new Point();
             projection.toPixels(geoPoint, point);

             RectF oval=new RectF(point.x - mRadius,point.y - mRadius,point.x + mRadius,point.y + mRadius);

             Paint paint=new Paint();
             paint.setARGB(250, 255, 255, 255);
             paint.setAntiAlias(true);
             paint.setFakeBoldText(true);

             Paint backPaint=new Paint();
             backPaint.setARGB(175, 50, 50, 50);
             backPaint.setAntiAlias(true);

             RectF backRect=new RectF(point.x + 2 + mRadius, point.y - 3*mRadius,point.x + 65, point.y + mRadius);

             canvas.drawOval(oval, paint);
             canvas.drawRoundRect(backRect, 5, 5, backPaint);
             canvas.drawText("Here I Am", point.x + 2*mRadius, point.y, paint);
        }
        super.draw(canvas, mapView, shadow);

        }

    @Override
    public boolean onTap(GeoPoint point,MapView mapView){
        return false;
    }

public Location getLocation(){

    return location;

}
public void setLocation(Location location){
    this.location=location;
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:42:00.553

你有一个空指针异常。看起来你试图绘制的东西是空的。你有你的drawables在一个特定的分辨率文件夹吗？像drawable-ldpi。

如果是这种情况，2.3 模拟器可能具有不同的分辨率配置文件（可能是 mdpi），导致该可绘制对象为空。

无论如何，你需要去那行代码找出什么是空的，然后找出原因。

# autohotkey - .exe 关闭后，如何使 AutoHotkeys 的功能停止工作？

> ID：11974230
> 
> 赞同：0
> 
> 时间：2012-08-15T17:37:10.093
> 
> 标签：autohotkey, keyboard-hook

我正在测试 AutoHotkeys 作为一种在应用程序运行时阻止用户使用 Ctrl、Alt 和 Windows 键的方法。为此，我编译了代码：

```
LAlt::return
RAlt::return
LControl::return
RControl::return
RWin::Return
LWin::Return 
```

使用 AutoHotkeys 附带的编译器进入 .exe。

我的问题是，通常当我关闭 .exe 文件（通过使用 TerminateProcess(,) 的代码或手动关闭）时，密钥不会立即释放。例如，Windows 键可能需要大约 10 秒才能被很好地“解锁”并可以再次使用，这对我来说是不可接受的。

所以我有两个问题：

*   有没有办法解决这个问题？如何在 .exe 关闭后立即释放密钥？
*   如果我尝试通过代码获得相同的功能，会有什么改进吗？或者，如果我自己创建钩子，我会遇到与 AutoHotkeys 相同的问题吗？

谢谢，

莫默吉尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T19:59:53.597

[`ExitApp`](http://l.autohotkey.net/docs/commands/ExitApp.htm)AutoHotkey 有一个用于终止脚本的内置命令。
此示例使`Esc`您的终止热键：

```
Esc::ExitApp 
```

似乎您遇到的延迟可能与关闭流程所需的时间有关。[`#If`](http://l.autohotkey.net/docs/commands/_If.htm)您可以尝试使用command*使热键有条件
（即它们仅在 时被阻止`Flag = 1`）。
然后，您可以让脚本快速更改之前`ExitApp`使用的上下文[`OnExit`](http://l.autohotkey.net/docs/commands/OnExit.htm)。当脚本以任何方式退出时调用 OnExit 子例程（除非它被诸如“结束任务”之类的东西杀死）。您可以使用命令调用带有热键的子例程[`GoSub`](http://l.autohotkey.net/docs/commands/Gosub.htm)。

```
Flag := 1
OnExit, myExit

Esc::GoSub, myExit

#If Flag
LAlt::return
LCtrl::return
x::return
#If

myExit:
Flag := 0
Exitapp 
```

`*`该`#If`命令需要[Autohotkey_L](http://l.autohotkey.net/)。
另一个更详细但适用于 AHK basic 的选项是[`hotkey`](http://l.autohotkey.net/docs/commands/Hotkey.htm)命令。

* * *

另一种选择是让 AutoHotkey 运行目标应用程序，并且在应用程序退出时，AutoHotkey 也会退出。这是记事本的示例。当用户关闭记事本时，脚本会优雅地退出。

```
RunWait, Notepad.exe
ExitApp ; Run after Notepad.exe closes

LAlt::return
RAlt::return
LControl::return
RControl::return
RWin::Return
LWin::Return 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T08:08:38.780

我会使用 winactive 禁用这些键。在此示例中，“Evernote”的修饰符键被禁用。一旦你切换到另一个程序，按键就会恢复，而当你切换回 Evernote 时，修饰键会再次被禁用。

```
SetTitleMatchMode, 2 ; Find the string Evernote anywhere in the windows title
#ifWinActive Evernote
    LAlt::return
    RAlt::return
    LControl::return
    RControl::return
    RWin::Return
    LWin::Return
#ifWinActive 
```

# java - 在 Java 中返回 IPv6

> ID：11974232
> 
> 赞同：4
> 
> 时间：2012-08-15T17:37:13.033
> 
> 标签：java, ipv6

Java中有没有办法告诉它只返回IPv6？我已经尝试了一切，但无法让它工作。

```
try
    {
        InetAddress inet = InetAddress.getByName(hostName);

        boolean status = inet.isReachable(5000);

        if (status)
        {
            System.out.println(inet.getCanonicalHostName() + " Host Reached\t" + java.net.Inet6Address.getByName(hostName).getHostAddress());
        }
        else
        {
            System.out.println(inet.getCanonicalHostName() + " Host Unreachable");
        }

    }
    catch (UnknownHostException e)
    {
        System.err.println("Host does not exists");
    }
    catch (IOException e)
    {
        System.err.println("Error in reaching the Host");
    } 
```

我用来尝试仅返回 IPv6 的行：

```
System.out.println(inet.getCanonicalHostName() + " Host Reached\t" + java.net.Inet6Address.getByName(hostName).getHostAddress()); 
```

这会不断返回 IPv4。任何人都知道它为什么这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T18:14:10.360

`java.net.Inet6Address`不会覆盖`getByName()`
，因此它将始终返回特定的 IPv4-Address，除非您的参数本身采用有效 IPv6-Address 的形式，在这种情况下，此方法将返回 Inet6Address-Object。

例如：
`getByName("stackoverflow.com")`--> Inet4Address
`getByName("2001:0db8:85a3:08d3:1319:8a2e:0370:7344")`--> Inet6Address

**InetAddress.getByName()-文档**

> 给定主机名，确定主机的 IP 地址。主机名可以是机器名，例如“java.sun.com”，也可以是其 IP 地址的文本表示。如果提供了文字 IP 地址，则仅检查地址格式的有效性。
> 
> **> 对于以文字 IPv6 地址指定的主机，接受 RFC 2732 中定义的形式或 RFC 2373 中定义的文字 IPv6 地址格式。<**

因此，如果您想获得 IPv6-Address，您需要在参数中定义它，或者配置 DNS-Server 以返回 IPv6-Address 而不是 IPv4-Address。

检索 IPv6 地址的另一种方法是使用`InetAddress.getAllByName("www.google.at")`它返回主机的所有已知 IP 地址。

例如，您可以使用此方法过滤返回的数组，该数组返回第一个 IPv6 地址，或者`null`如果主机没有：

```
public Inet6Address getIPv6Addresses(InetAddress[] addresses) {
    for (InetAddress addr : addresses) {
        if (addr instanceof Inet6Address) {
            return (Inet6Address) addr;
        }
    }
    return null;
} 
```

**更新：** 对于更多功能，尤其是那些影响 DNS-Servers 的功能，我建议使用外部库 DNSJava，因为 DNS 支持的普通 Java 实现很差。
[http://www.dnsjava.org/](http://www.dnsjava.org/)

当前代码：

```
public class Ping 
{
public void pingHost (String hostName)
{
    try
    {
        InetAddress[] inet = InetAddress.getAllByName(hostName);

        String address = this.getIPv4Addresses(inet).getHostAddress();

        boolean status = this.getIPv6Addresses(inet).isReachable(5000);

        if (status)
        {

            System.out.println(reverseDns(address) + " Host Reached\t" + this.getIPv6Addresses(inet).getHostAddress());
        }
        else
        {
            System.out.println(this.getIPv6Addresses(inet).getCanonicalHostName() + " Host Unreachable");
        }

    }
    catch (UnknownHostException e)
    {
        System.err.println("Host does not exists");
    }
    catch (IOException e)
    {
        System.err.println("Error in reaching the Host");
    }
}

public Inet6Address getIPv6Addresses(InetAddress[] addresses) 
{
    for (InetAddress addr : addresses) 
    {
        if (addr instanceof Inet6Address) 
        {
            return (Inet6Address) addr;
        }
    }
    return null;
}

public Inet4Address getIPv4Addresses(InetAddress[] addresses) 
{
    for (InetAddress addr : addresses) 
    {
        if (addr instanceof Inet4Address) 
        {
            return (Inet4Address) addr;
        }
    }
    return null;
}

public static String reverseDns(String hostIp) throws IOException 
{
    Resolver res = new ExtendedResolver();

    Name name = ReverseMap.fromAddress(hostIp);
    int type = Type.PTR;
    int dclass = DClass.IN;
    Record rec = Record.newRecord(name, type, dclass);
    Message query = Message.newQuery(rec);
    Message response = res.send(query);

    Record[] answers = response.getSectionArray(Section.ANSWER);
    if (answers.length == 0)
       return hostIp;
    else
       return answers[0].rdataToString();
  }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-10T10:27:18.087

您可以尝试定义 JVM_ARGS

`-Djava.net.preferIPv4Stack=false -Djava.net.preferIPv6Addresses=true`

有了这些道具，它会更喜欢 IPv6 addr`InetAddress#getByName`

更多信息：[https ://docs.oracle.com/javase/8/docs/technotes/guides/net/ipv6_guide/](https://docs.oracle.com/javase/8/docs/technotes/guides/net/ipv6_guide/)

# javascript - AJAX 调用在获得响应并执行成功时冻结浏览器一段时间

> ID：11974237
> 
> 赞同：11
> 
> 时间：2012-08-15T17:37:33.460
> 
> 标签：javascript, jquery, ajax

我正在对获取大量数据的网络服务器进行 AJAX 调用。我显示了一个加载图像，该图像在执行 ajax 调用时旋转然后消失。

我注意到的是，此特定呼叫中的所有浏览器都会使其无响应约 7 秒。话虽如此，加载图像并没有像我在获取时所计划的那样旋转。

我不知道这是否会发生，或者是否有办法解决，在某种意义上导致有一个 fork() 以便它做 1 件事，而我的加载图标仍在旋转。

想法？想法？

下面是有人想看到的代码：

```
$("div.loadingImage").fadeIn(500);//.show();
            setTimeout(function(){
            $.ajax({
                type: "POST",
                url: WEBSERVICE_URL + "/getChildrenFromTelTree",
                dataType: "json",
                async: true,
                contentType: "application/json",
                data: JSON.stringify({
                    "pText": parentText,
                    "pValue": parentValue,
                    "pr_id": LOGGED_IN_PR_ID,
                    "query_input": $("#queryInput").val()
                }),
                success: function (result, textStatus, jqXHR) {
                    //alert("winning");
                    //var childNodes = eval(result["getChildrenFromTelTreeResult"]);
                    if (result.getChildrenFromTelTreeResult == "") {
                        alert("No Children");
                    } else {
                        var childNodes = JSON.parse(result.getChildrenFromTelTreeResult);
                        var newChild;
                        //alert('pText: '+parentText+"\npValue: "+parentValue+"\nPorofileID: "+ LOGGED_IN_PR_ID+"\n\nFilter Input; "+$("#queryInput").val() );
                        //alert(childNodes.length);
                        for (var i = 0; i < childNodes.length; i++) {
                            TV.trackChanges();
                            newChild = new Telerik.Web.UI.RadTreeNode();
                            newChild.set_text(childNodes[i].pText);
                            newChild.set_value(childNodes[i].pValue);
                            //confirmed that newChild is set to ServerSide through debug and get_expandMode();
                            parentNode.get_nodes().add(newChild);
                            TV.commitChanges();
                            var parts = childNodes[i].pValue.split(",");
                            if (parts[0] != "{fe_id}" && parts[0] != "{un_fe_id}") {
                                newChild.set_expandMode(Telerik.Web.UI.TreeNodeExpandMode.ServerSide);
                            }
                        }
                    }
                    //TV.expand();
                    //recurseStart(TV);
                },
                error: function (xhr, status, message) {
                    alert("errrrrror");
                }
            }).always(function () {
                    $("div.loadingImage").fadeOut();
                });
                },500); 
```

我的一个同事注意到了这个问题，并建议我添加一个 setTimeout(function(){..},500); 但它不能解决手头的问题，因此很可能会被删除。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-15T20:33:13.473

由于 JavaScript 是单线程的，所以很多同步处理会挂起事件队列并阻止其他代码执行。在您的情况下，它是在执行时锁定浏览器的 for 循环。

您可以尝试将所有迭代放入事件队列中。

```
for (var i = 0 ; i < childNodes.length ; i = i + 1) {
    (function(i) {
        setTimeout(function(i) {
            // code-here
        }, 0)
    })(i)
} 
```

这应该将处理间隔开，而不是强制浏览器一次完成所有处理。自执行函数用于创建一个闭包以保持循环计数器 i 的值。

# java - 仅通过代理启用外部服务器访问？

> ID：11974238
> 
> 赞同：0
> 
> 时间：2012-08-15T17:37:41.587
> 
> 标签：java, apache, proxy

设置：我在服务器上部署了一个 webapp。我还有另一台机器是代理。问题：如何确保只能通过代理访问网络服务器？

例如：用户转到`www.myproxy.com`，并被重定向到`www.mywebserver.com`

但是他不应该先去`www.mywebserver.com`代理就不能直接访问。

那有可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T17:45:05.763

您的问题不清楚，您的网络服务器是始终应该通过反向代理访问还是只重定向一次？

如果您的网络服务器始终位于代理后面，您应该检查网络服务器上的“Via”和“x-forwarded-for”标头。标头 via 应包含您的代理服务器 IP 地址。

# c# - 构建失败：Visual Studio 2010

> ID：11974243
> 
> 赞同：0
> 
> 时间：2012-08-15T17:37:58.133
> 
> 标签：c#, visual-studio, visual-studio-2010, build

当我尝试在 Visual Studio 2010 Professional 上编译我的项目时，我收到此错误：

> 编译完成 -- 1 个错误，0 个警告构建开始于 15/08/2012 19:30:23。ResolveAssemblyReferences：将生成一个 TargetFramework 配置文件排除列表。CoreResGen: "c:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\bin\NETFX 4.0 Tools\resgen.exe" /useSourcePath /r:"C:\Program Files (x86)\Reference Assemblies\Microsoft \Framework.NETFramework\v4.0\Profile\Client\Microsoft.CSharp.dll" /r:"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETFramework\v4.0\Profile\Client\mscorlib .dll" /r:"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETFramework\v4.0\Profile\Client\System.Core.dll" /r:"C:\Program Files (x86 )\Reference Assemblies\Microsoft\Framework.NETFramework\v4.0\Profile\Client\System.Data.DataSetExtensions.dll" /r:"C: 因为所有输出文件相对于输入文件都是最新的。核心编译：C:\Windows\Microsoft.NET\Framework\v4.0.30319\Csc.exe /noconfig /nowarn:1701,1702 /nostdlib+ /platform:x86 /errorreport:prompt /warn:4 /define:DEBUG;TRACE /reference :"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETFramework\v4.0\Profile\Client\Microsoft.CSharp.dll" /reference:"C:\Program Files (x86)\Reference Assemblies\ Microsoft\Framework.NETFramework\v4.0\Profile\Client\mscorlib.dll" /reference:"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETFramework\v4.0\Profile\Client\System. Core.dll" /reference:"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETFramework\v4.0\Profile\Client\System.Data.DataSetExtensions.dll" /reference:"C:

构建失败。

有人可以帮我告诉我问题是什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T18:16:35.820

我已经找到了解决方案！

```
this.Load += new System.EventHandler(this.Form1_Load); 
```

这是错误...我忘了删除那行代码！;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T20:14:03.757

通常（对我而言），创建一个新的 .NET 项目会使目标框架默认为 .NET Framework 4.0（客户端配置文件）——这可能会产生一些错误（我自己尝试过）。您可以在项目选项中将其更改为 .NET Framework 4.0。

您还可以在按下 Create 之前让新项目使用 .NET Framework 4.0，如果我没记错的话，它应该位于 New Project 窗口的顶部。

# sql - 将数据库模式中的所有“SMALLINT”列转换为“BIT”的最佳方法？(SQL)

> ID：11974244
> 
> 赞同：0
> 
> 时间：2012-08-15T17:38:00.670
> 
> 标签：sql, sql-server, database, sql-server-2008

如何将`smallint`数据库中的所有类型列转换为`bit`类型？我正在使用 SQL Server 2008。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:37:13.237

请小心执行此操作并首先在备份数据库上进行测试。以下查询将为数据库中具有 SMALLINT 数据类型的每一列创建 ALTER 语句，以将它们转换为 BIT。

```
select 'ALTER TABLE ' + QUOTENAME(o.Name) + ' ALTER COLUMN ' + QUOTENAME(c.Name) + ' BIT' as Command
from sys.objects o
inner join sys.columns c
on o.object_id = c.object_id
where system_type_id = 52
and o.Type = 'U' 
```

此外，请确保列出的每一列仅包含 1 或 0，否则在运行脚本时会出现截断错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T19:04:22.307

在 SQL Server 中，您可以使用`ALTER TABLE my_table ALTER COLUMN my_column [new_datatype]`.

请注意默认值之类的东西，因为我没有用它们进行测试。

示例 1 - 将提供一个查询列表供您查看/修改/执行（更安全的选项）。

```
DECLARE @TableSchema VARCHAR(100)
DECLARE @TableName VARCHAR(100)
DECLARE @ColumnName VARCHAR(100)
DECLARE @Query NVARCHAR(1000)

DECLARE @FromDataType NVARCHAR(50)
DECLARE @ToDataType NVARCHAR(50)

SET @TableSchema = 'dbo';
SET @FromDataType = 'smallint';
SET @ToDataType = 'bit';

DECLARE c CURSOR FAST_FORWARD FOR 
    SELECT TABLE_NAME, COLUMN_NAME 
    FROM   INFORMATION_SCHEMA.COLUMNS 
    WHERE  TABLE_SCHEMA = @TableSchema 
       AND TABLE_NAME <> 'sysdiagrams' 
       AND DATA_TYPE = @FromDataType

OPEN c;

FETCH NEXT FROM c INTO @TableName, @ColumnName;

WHILE @@FETCH_STATUS = 0
BEGIN
    SET @Query = N'ALTER TABLE ' + @TableName + N' ALTER COLUMN ' + @ColumnName + N' ' + @ToDataType -- + CHAR(13) + N'GO'
    PRINT @Query

    EXEC sp_EXECUTESQL @Query

    FETCH NEXT FROM c INTO @TableName, @ColumnName;
END

CLOSE c;
DEALLOCATE c; 
```

示例 2 - 将执行（建议先运行示例 1！）

```
DECLARE @TableSchema VARCHAR(100)
DECLARE @TableName VARCHAR(100)
DECLARE @ColumnName VARCHAR(100)
DECLARE @Query NVARCHAR(1000)

DECLARE @FromDataType NVARCHAR(50)
DECLARE @ToDataType NVARCHAR(50)

SET @TableSchema = 'dbo';
SET @FromDataType = 'smallint';
SET @ToDataType = 'bit';

DECLARE c CURSOR FAST_FORWARD FOR 
    SELECT TABLE_NAME, COLUMN_NAME 
    FROM   INFORMATION_SCHEMA.COLUMNS 
    WHERE  TABLE_SCHEMA = @TableSchema 
       AND TABLE_NAME <> 'sysdiagrams' 
       AND DATA_TYPE = @FromDataType

OPEN c;

FETCH NEXT FROM c INTO @TableName, @ColumnName;

WHILE @@FETCH_STATUS = 0
BEGIN
    SET @Query = N'ALTER TABLE ' + @TableName + N' ALTER COLUMN ' + @ColumnName + N' ' + @ToDataType + CHAR(13) + N' GO'
    PRINT @Query

    FETCH NEXT FROM c INTO @TableName, @ColumnName;
END

CLOSE c;
DEALLOCATE c; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-15T18:17:51.843

如果您询问转换列数据类型，我不认为您可以直接这样做。您可以添加一个新列作为 BIT 并从旧列填充它，然后删除旧列并将新列重命名为旧名称。

有关更多信息，请参阅[在线文档](http://msdn.microsoft.com/en-us/library/ms190273%28v=sql.100%29.aspx)。

# java - Java 字符串，每 8 个字符后插入一个破折号，从右开始

> ID：11974251
> 
> 赞同：9
> 
> 时间：2012-08-15T17:38:52.650
> 
> 标签：java, string

从右边开始，在 Java 字符串中每 8 个字符之后插入一个（破折号/减号字符）的**最佳**方法是什么？`-`

例子：

```
1111 -> 1111
111111111 -> 1-11111111
1111111111111111 -> 11111111-11111111
100001111111111111111 -> 10000-11111111-11111111 
```

我的尝试，以表明我已经尝试过自己做（下面的评论问：“这是作业吗？”：

```
import junit.framework.TestCase;
public class InsertCharacterAfterEveryNCharacters extends TestCase {
  public static String insertSpacerAfterNCharactersFromTheRight(char spacer,
      int spacing, String string) {
    final int length = string.length();
    final int newStringCapacity = length + (int) Math.ceil(length / (double) spacing);
    StringBuilder stringBuilder = new StringBuilder(newStringCapacity);
    for (int i = length - 1; i >= 0; i--) {
      stringBuilder.append(string.charAt(i));
      if (i % spacing == 0 && i > 0) {
        stringBuilder.append(spacer);
      }
    }
    return stringBuilder.toString();
  }
  public static void testInsertSpacerAfterNCharactersFromTheRight() {
    assertEquals("", insertSpacerAfterNCharactersFromTheRight('-', 8, ""));
    assertEquals("1", insertSpacerAfterNCharactersFromTheRight('-', 8, "1"));
    assertEquals("11", insertSpacerAfterNCharactersFromTheRight('-', 8, "11"));
    assertEquals("11111111",
        insertSpacerAfterNCharactersFromTheRight('-', 8, "11111111"));
    assertEquals("1-11111111",
        insertSpacerAfterNCharactersFromTheRight('-', 8, "111111111"));
    assertEquals("11111111-11111111",
        insertSpacerAfterNCharactersFromTheRight('-', 8, "1111111111111111"));
  }
} 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-09-26T12:11:59.463

对于需要做的事情，所有答案似乎都有很多代码。您可以使用正则表达式来做到这一点。

假设您有一个返回格式化字符串的方法。

一个简单明了的例子：

```
String myString = "00000000000111111111111100000000001111111000011000000";
String newString = myString.replaceAll("(.{8})(?!$)", "$1-");
return newString; 
```

以上等于以下较短的符号：

```
return myString.replaceAll("(.{8})(?!$)", "$1-"); 
```

另一个类似的短符号（在固定的硬编码字符串的情况下）：

```
return "00000000000111111111111100000000001111111000011000000".replaceAll("(.{8})(?!$)", "$1-"); 
```

每段代码都返回以下字符串：

```
00000000-00011111-11111111-00000000-00111111-10000110-00000 
```

有关正则表达式的更多信息，请参见例如[http://www.regular-expressions.info/java.html](http://www.regular-expressions.info/java.html)

希望这对将来的任何人都有帮助。

编辑说明：最后一组没有 8 个字符。但是，如果它会，它不会添加另一个破折号。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-08-15T17:44:25.843

`char[]`从原始构建一个`String`：

```
String str = "100001111111111111111";

// add enough space for an additional "-" for every 8 chars:
char[] chars = new char[str.length() + (str.length() / 8)];

// this offset will give us the first "-" position from the LEFT:
int offset = str.length() % 8;
int idx = 0, strIdx = 0;

for (; strIdx < str.length(); idx++, strIdx++)
{
    if (((strIdx % 8) == offset) && (strIdx != 0))
        chars[idx++] = '-';
    chars[idx] = str.charAt(strIdx);
}

String str2 = new String(chars);

System.out.println(str2); 
```

或者您可以使用 a `StringBuilder`，这可能涉及`(length / 8)`数组复制操作：

```
StringBuilder str = new StringBuilder("100001111111111111111");
int idx = str.length() - 8;

while (idx > 0)
{
    str.insert(idx, "-");
    idx = idx - 8;
}

System.out.println(str.toString()); 
```

两种情况下的输出：

> 10000-11111111-11111111

请注意，这不会在 index 处插入连字符，`0`如果有必要，您需要调整代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-27T13:25:51.427

上述解决方案很好，但非常复杂且冗长，我写了这个，它适用于您的输入。

```
public static String insertCharacterForEveryNDistanceFromRight(int distance, String original, char c){
    StringBuilder sb = new StringBuilder();
    char[] charArrayOfOriginal = original.toCharArray();
    for(int ch = charArrayOfOriginal.length ; ch > 0 ; ch--){
        if(ch % distance == 0 && ch != charArrayOfOriginal.length)
            sb.append(c).append(charArrayOfOriginal[charArrayOfOriginal.length - ch]);
        else
            sb.append(charArrayOfOriginal[charArrayOfOriginal.length - ch]);
    }
    return sb.toString();
} 
```

并这样称呼它...

```
String rightResult = InsertSpaces.insertCharacterForEveryNDistanceFromRight(8, "100001111111111111111", '-');
System.out.println(rightResult); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T17:42:27.297

您不能从字面上将 a`-`插入现有的 Java String，因为 String 是不可变的。但是，您可以创建一个新的 String 实例来满足您的输出格式要求。

从输入字符串的结束索引循环到 0。对于每次迭代：

*   将当前索引处的值插入到[StringBuilder](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/StringBuilder.html)实例的开头。
*   使用模运算符查看是否插入了 8 个字符的倍数。如果是这样，请插入破折号。

如果需要，请使用 StringBuilder 实例的“toString()”方法获取字符串。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-15T17:43:48.773

大概是这样的？

```
for(int i = s.length() - 1; i > 0; i -= 8)
{
    s = new StringBuffer(s).insert(i, "-").toString();
    i--;
} 
```

# asp.net - ASP.NET 动态数据 - 派生类型的自定义页面

> ID：11974255
> 
> 赞同：1
> 
> 时间：2012-08-15T17:39:06.433
> 
> 标签：asp.net, dynamic-data, derived-types, custom-pages

我能够为基本类型创建自定义页面，但不能为其任何派生类型创建自定义页面。

我有一个产品类和派生类型 LightPipe 和 CardGuide。我在 CustomPages/Products/List.aspx 下创建了一个自定义页面。这工作正常；动态数据在显示基本产品实体时使用自定义页面。

但是，当我在 CustomPages/LightPipes/List.aspx 下为 LightPipe 创建自定义页面时，动态数据仍然使用 PageTemplages/List.aspx 下的标准页面模板，而不是我的自定义模板。

这是动态数据的限制吗？

感谢您的时间。

编辑：添加说明。

# javascript - 如何克隆或重新调度 DOM 事件？

> ID：11974262
> 
> 赞同：86
> 
> 时间：2012-08-15T17:40:04.100
> 
> 标签：javascript, events, dom, webkit

我正在寻找一种简单而抽象的方式来克隆或重新调度 DOM 事件。我对克隆 DOM 节点不感兴趣。

我做了一些实验，阅读了[DOM 事件规范](http://www.w3.org/TR/DOM-Level-2-Events/events.html)，但没有找到明确的答案。

理想情况下，我正在寻找以下直截了当的东西：

```
handler = function(e){
  document.getElementById("decoy").dispatchEvent(e)
}
document.getElementById("source").addEventListener("click", handler) 
```

当然，此代码示例不起作用。有一个 DOM 异常表明该事件当前正在被调度 - 显然。

我想避免使用 手动创建新事件`document.createEvent()`、初始化它们并分派它们。

这个用例有一个简单的解决方案吗？

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2013-12-12T10:41:30.877

我知道，这个问题很老，OP 想避免创建/初始化方法，但是有一种相对简单的方法来复制事件：

```
new_event = new MouseEvent(old_event.type, old_event) 
```

如果您想要的不仅仅是鼠标事件，您可以执行以下操作：

```
new_event = new old_event.constructor(old_event.type, old_event) 
```

在原始上下文中：

```
handler = function(e) {
  new_e = new e.constructor(e.type, e);
  document.getElementById("decoy").dispatchEvent(new_e);
}
document.getElementById("source").addEventListener("click", handler); 
```

（对于 jQuery 用户：您可能需要使用`e.originalEvent.constructor`代替`e.constructor`）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-08-20T17:00:23.877

# Internet Explorer 的修复

Alexis 发布了一个不错的解决方案，但他的解决方案在 Internet Explorer 中不起作用。以下解决方案将。不幸的是，没有像 Internet Explorer 中的事件构造函数那样一致的系统，所以下面的代码膨胀是必要的。

```
var allModifiers = ["Alt","AltGraph","CapsLock","Control",
                    "Meta","NumLock","Scroll","Shift","Win"];
function redispatchEvent(original, newTargetId) {
  if (typeof Event === "function") {
    var eventCopy = new original.constructor(original.type, original);
  } else {
    // Internet Explorer
    var eventType = original.constructor.name;
    var eventCopy = document.createEvent(eventType);
    if (original.getModifierState)
      var modifiersList = allModifiers.filter(
        original.getModifierState,
        original
      ).join(" ");

    if (eventType === "MouseEvent") original.initMouseEvent(
      original.type, original.bubbles, original.cancelable,
      original.view, original.detail, original.screenX, original.screenY,
      original.clientX, original.clientY, original.ctrlKey,
      original.altKey, original.shiftKey, original.metaKey,
      original.button, original.relatedTarget
    );
    if (eventType === "DragEvent") original.initDragEvent(
      original.type, original.bubbles, original.cancelable,
      original.view, original.detail, original.screenX, original.screenY,
      original.clientX, original.clientY, original.ctrlKey,
      original.altKey, original.shiftKey, original.metaKey,
      original.button, original.relatedTarget, original.dataTransfer
    );
    if (eventType === "WheelEvent") original.initWheelEvent(
      original.detail, original.screenX, original.screenY,
      original.clientX, original.clientY, original.button,
      original.relatedTarget, modifiersList,
      original.deltaX, original.deltaY, original.deltaZ, original.deltaMode
    );
    if (eventType === "PointerEvent") original.initPointerEvent(
      original.type, original.bubbles, original.cancelable,
      original.view, original.detail, original.screenX, original.screenY,
      original.clientX, original.clientY, original.ctrlKey,
      original.altKey, original.shiftKey, original.metaKey,
      original.button, original.relatedTarget,
      original.offsetX, original.offsetY, original.width, original.height,
      original.pressure, original.rotation,
      original.tiltX, original.tiltY,
      original.pointerId, original.pointerType,
      original.timeStamp, original.isPrimary
    );
    if (eventType === "TouchEvent") original.initTouchEvent(
      original.type, original.bubbles, original.cancelable,
      original.view, original.detail, original.screenX, original.screenY,
      original.clientX, original.clientY, original.ctrlKey,
      original.altKey, original.shiftKey, original.metaKey,
      original.touches, original.targetTouches, original.changedTouches,
      original.scale, original.rotation
    );
    if (eventType === "TextEvent") original.initTextEvent(
      original.type, original.bubbles, original.cancelable,
      original.view,
      original.data, original.inputMethod, original.locale
    );
    if (eventType === "CompositionEvent") original.initTextEvent(
      original.type, original.bubbles, original.cancelable,
      original.view,
      original.data, original.inputMethod, original.locale
    );
    if (eventType === "KeyboardEvent") original.initKeyboardEvent(
      original.type, original.bubbles, original.cancelable,
      original.view, original.char, original.key,
      original.location, modifiersList, original.repeat
    );
    if (eventType === "InputEvent" || eventType === "UIEvent")
      original.initUIEvent(
        original.type, original.bubbles, original.cancelable,
        original.view, original.detail
      );
    if (eventType === "FocusEvent") original.initFocusEvent(
        original.type, original.bubbles, original.cancelable,
        original.view, original.detail, original.relatedTarget
    );
  }

  document.getElementById(newTargetId).dispatchEvent(eventCopy);
  if (eventCopy.defaultPrevented)  newTargetId.preventDefault();
}
```

```
<button onclick="redispatchEvent(arguments[0], '2nd')">Click Here</button>
<button id="2nd" onclick="console.log('Alternate clicked!')">Alternate Button</button>
```

# 更通用的解决方案

根据您的需要，比重新调度原始事件更好的解决方案可能是合成事件传播。我们创建了特殊的方法来注册事件侦听器，这些侦听器也将这些侦听器暴露给我们的代码，以便我们可以手动调用它们。事实上，有一个`getEventListeners`函数可以用来检索当前的事件监听器。但是，`getEventListeners`仅 Chrome/Safari 支持。因此，我设计了以下替换。虽然下面的代码看起来太大了，但下面的代码主要是变量名，所以缩小后会很小。

```
/**@type{WeakMap}*/ var registeredListeners = new WeakMap();

hearEvent(document.getElementById("1st"), "click", function propagate(evt) {
  fireEvent(document.getElementById("2nd"), evt, propagate);
});

hearEvent(document.getElementById("2nd"), "click", function(evt) {
  console.log( evt.target.textContent );
});

/**
 * @param{Element} target
 * @param{string} name
 * @param{function(Event=):(boolean|undefined)} handle
 * @param{(Object<string,boolean>|boolean)=} options
 * @return {undefined}
 */
function hearEvent(target, name, handle, options) {
  target.addEventListener(name, handle, options);
  var curArr = registeredListeners.get(target);
  if (!curArr) registeredListeners.set(target, (curArr = []));

  curArr.push([
    "" + name,
    handle,
    typeof options=="object" ? !!options.capture : !!options,
    target
  ]);
}

/**
 * @param{Element} target
 * @param{string} name
 * @param{function(Event=):(boolean|undefined)} handle
 * @param{(Object<string,boolean>|boolean)=} options
 * @return {undefined}
 */
function muteEvent(target, name, handle, options) {
  name += "";
  target.removeEventListener(name, handle, options);
  var capturing = typeof options=="object"?!!options.capture:!!options;
  var curArr = registeredListeners.get(target);
  if (curArr)
    for (var i=(curArr.length|0)-1|0; i>=0; i=i-1|0)
      if (curArr[i][0] === name && curArr[i][2] === capturing)
        curArr.splice(i, 1);

  if (!curArr.length) registeredListeners.delete(target);
}

/**
 * @param{Element} target
 * @param{Event} eventObject
 * @param{Element=} caller
 * @return {undefined}
 */
function fireEvent(target, eventObject, caller) {
  var deffered = [], name = eventObject.type, curArr, listener;
  var immediateStop = false, keepGoing = true, lastTarget;
  var currentTarget = target, doesBubble = !!eventObject.bubbles;

  var trueObject = Object.setPrototypeOf({
    stopImmediatePropagation: function(){immediateStop = true},
    stopPropagation: function(){keepGoing = false},
    get target() {return target},
    get currentTarget() {return currentTarget}
  }, eventObject);

  do {
    if (curArr = registeredListeners.get(currentTarget))
      for (var i=0; i<(curArr.length|0) && !immediateStop; i=i+1|0)
        if (curArr[i][0] === name && curArr[i][1] !== caller) {
          listener = curArr[i];
          if (listener[2]) {
            listener[1].call(trueObject, trueObject);
          } else if (doesBubble || currentTarget === target) {
            deffered.push( listener );
          }
        }

    if (target.nodeType === 13) {
      // for the ShadowDOMv2
      deffered.push([ target ]);
      currentTarget = target = currentTarget.host;
    }
  } while (keepGoing && (currentTarget = currentTarget.parentNode));

  while (
    (listener = deffered.pop()) &&
    !immediateStop &&
    (lastTarget === listener[3] || keepGoing)
  )
    if (listener.length === 1) {
      // for the ShadowDOMv2
      target = listener[0];
    } else {
      lastTarget = currentTarget = listener[3];
      listener[1].call(trueObject, trueObject);
    }
}
```

```
<button id="1st">Click Here</button>
<button id="2nd">Alternate Button</button>
```

请注意，在缩小之后，所有这些代码都整齐地适合单个千字节（在 gzip 之前）。

```
var k=new WeakMap;m(document.getElementById("1st"),"click",function q(a){r(document.getElementById("2nd"),a,q)});m(document.getElementById("2nd"),"click",function(a){console.log(a.target.textContent)});function m(a,c,f,b){a.addEventListener(c,f,b);var d=k.get(a);d||k.set(a,d=[]);d.push([""+c,f,"object"==typeof b?!!b.capture:!!b,a])}
function r(a,c,f){var b=[],d=c.type,n=!1,p=!0,g=a,t=!!c.bubbles,l=Object.setPrototypeOf({stopImmediatePropagation:function(){n=!0},stopPropagation:function(){p=!1},get target(){return a},get currentTarget(){return g}},c);do{if(c=k.get(g))for(var h=0;h<(c.length|0)&&!n;h=h+1|0)if(c[h][0]===d&&c[h][1]!==f){var e=c[h];e[2]?e[1].call(l,l):(t||g===a)&&b.push(e)}13===a.nodeType&&(b.push([a]),g=a=g.host)}while(p&&(g=g.parentNode));for(;(e=b.pop())&&!n&&(u===e[3]||p);)if(1===e.length)a=e[0];else{var u=g=
e[3];e[1].call(l,l)}}function z(a,c,f,b){c+="";a.removeEventListener(c,f,b);f="object"==typeof b?!!b.capture:!!b;if(b=k.get(a))for(var d=(b.length|0)-1|0;0<=d;d=d-1|0)b[d][0]===c&&b[d][2]===f&&b.splice(d,1);b.length||k.delete(a)}
```

```
<button id="1st">Click Here</button>
<button id="2nd">Alternate Button</button>
```

# ios - 禁用与 UIBarButtonItem 的用户交互

> ID：11974270
> 
> 赞同：1
> 
> 时间：2012-08-15T17:40:34.563
> 
> 标签：ios, cocoa-touch, uiview, uiviewcontroller, uibarbuttonitem

当我的应用程序运行一个简短的动画时，我不希望用户能够点击任何东西。在我的视图控制器中，我可以使用

```
 self.view.userInteractionEnabled = NO; 
```

阻止大多数交互，但它不会阻止工具栏/导航栏中的按钮触发事件。

我不能只禁用按钮，因为这会产生分散注意力的视觉影响（按钮变灰）。

我如何才能短暂暂停与所有控件的交互？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-15T17:46:18.110

在您`-beginIgnoringInteractionEvents`的. 这正是类在动画推送到新视图控制器时所做的事情。要获取您的特定实例，请使用类上的方法。考虑这个例子。`-endIgnoringInteractionEvents``UIApplication``UINavigationController``UIApplication``+sharedApplication``UIApplication`

```
[[UIApplication sharedApplication] beginIgnoringInteractionEvents];
[[UIApplication sharedApplication] endIgnoringInteractionEvents]; 
```

# php - 在 php 中解码使用 encodeURI 编码的文本

> ID：11974276
> 
> 赞同：-1
> 
> 时间：2012-08-15T17:40:43.150
> 
> 标签：php, mysql, actionscript-3

我使用 encodeURI 和 decodeURI 将法语重音文本从 AS3 发送到我的 mysql 数据库并在 AS3 中取回它，它工作正常。除了我还需要处理服务器上的文本，它已经无可救药地被破坏了。php 函数 urldecode 和 rawurldecode 只完成部分工作。一些编码仍然存在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T17:45:30.957

你可以在js端使用：encodeURIComponent()，然后在php端使用urldecode()吗？

# c# - 我可以将列表绑定到 SSRS 报告吗

> ID：11974281
> 
> 赞同：0
> 
> 时间：2012-08-15T17:40:59.280
> 
> 标签：c#, reporting-services

我总是以这种方式将数据集绑定到报告

```
string exeFolder = Path.GetDirectoryName(Application.StartupPath);
string reportPath = Path.Combine(GetRootPath(), @"Report1.rdlc");
DataTable dt = GetDataSet();

List<ReportParameter> parameters = new List<ReportParameter>();
parameters.Add(new ReportParameter("ReportParameter1", "Hello"));

reportViewer1.Reset();
reportViewer1.ProcessingMode = ProcessingMode.Local;
reportViewer1.LocalReport.DataSources.Clear();
reportViewer1.LocalReport.DataSources.Add(new ReportDataSource("dsJobs", dt));
reportViewer1.LocalReport.ReportPath = reportPath;
reportViewer1.LocalReport.SetParameters(parameters);
reportViewer1.RefreshReport();

so want to know can i bind list like

public class Person
{
public string Name1{get; set;}
public string Address{get; set;}
public string Email{get; set;}
}
List<Person> p = new List<Person>();
reportViewer1.LocalReport.DataSources.Add(new ReportDataSource(p)); 
```

请指导我。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T12:22:02.990

我创建了一个类，它可以帮助您模拟报告的页面代码隐藏类：

```
public abstract class ReportGenerator
{
    private readonly List<ReportParameter> _reportParameters;
    private readonly List<ReportDataSource> _reportDataSources;
    private readonly LocalReport _report;
    private readonly string _friendlyName;
    private IList<ReportGenerator> _subReports;
    private readonly string _repName;

    internal string ReportName
    {
        get { return _repName; }
    }

    public List<ReportDataSource> ReportDataSources
    {
        get { return _reportDataSources; }
    }

    public List<ReportParameter> ReportParameters
    {
        get { return _reportParameters; }
    }

    public abstract void SetParamsAndDataSources();

    protected ReportGenerator(string friendlyName, string reportName)
    {
        _friendlyName = friendlyName;
        _report = new LocalReport { ReportPath = string.Format("Reports/{0}.rdlc", reportName) };
        _repName = reportName;
        _reportParameters = new List<ReportParameter>();

        foreach (var paramIter in _report.GetParameters())
        {
            _reportParameters.Add(new ReportParameter(paramIter.Name));
        }

        _reportDataSources = new List<ReportDataSource>();
        foreach (var dsName in _report.GetDataSourceNames())
        {
            _reportDataSources.Add(new ReportDataSource { Name = dsName });
        }
    }

    private void report_SubreportProcessing(object sender, SubreportProcessingEventArgs e)
    {
        if(_subReports == null)
        {
            throw new ApplicationException(string.Format("Report '{0}' has subreport(s) which are not properly set up.", _repName));
        }

        var srLst = _subReports.Where(srIter => srIter.ReportName.Equals(e.ReportPath)).ToList();
        if (!srLst.Any())
        {
            return;
        }

        var srFound = srLst[0];

        foreach (var dsIter in srFound.ReportDataSources)
        {
            e.DataSources.Add(dsIter);
        }
    }

    public void RefreshReportViewer(out ReportViewer rvw)
    {
        InitReport();
        rvw = new ReportViewer();
        rvw.LocalReport.ReportPath = _report.ReportPath;
        rvw.LocalReport.SetParameters(ReportParameters);
        foreach (var dsIter in ReportDataSources)
        {
            rvw.LocalReport.DataSources.Add(dsIter);
        }
        rvw.LocalReport.SubreportProcessing += report_SubreportProcessing;
        rvw.LocalReport.Render("Word");
    }

    public byte[] GenerateReport(Formats reportFormat, out string mimeType, out string fileName)
    {
        SetParamsAndDataSources();

        ValidateReportParameters();
        ValidateReportDataSources();

        _report.SetParameters(_reportParameters);
        foreach (var dsIter in _reportDataSources)
        {
            _report.DataSources.Add(dsIter);
        }

        _report.SubreportProcessing += report_SubreportProcessing;

        Warning[] warnings;
        string[] streamIds;
        string encoding;
        string extension;

        fileName = string.Format("{0}_{1}.", _friendlyName, DateTime.Now.ToString("ddMMyyhhmmss"));

        var repExp = _report.Render(reportFormat.ToString("G"), null, out mimeType, out encoding, out extension, out streamIds, out warnings);
        fileName += extension;

        return repExp;
    }

    private void InitReport()
    {
        SetParamsAndDataSources();

        ValidateReportParameters();
        ValidateReportDataSources();

        _report.SetParameters(_reportParameters);
        foreach (var dsIter in _reportDataSources)
        {
            _report.DataSources.Add(dsIter);
        }
    }

    protected void SetSubReports(params ReportGenerator[] subReports)
    {
        _subReports = subReports.ToList();
    }

    private void ValidateReportParameters()
    {
        var paramsMetaData = _report.GetParameters();

        foreach (var paramIter in _reportParameters.Where(paramIter => paramIter.Values.Count == 0 && !paramsMetaData[paramIter.Name].AllowBlank))
        {
            throw new ApplicationException(string.Format(
                "Report {0}: Value not supplied for the parameter: {1}", _report.ReportPath, paramIter.Name));
        }
    }

    private void ValidateReportDataSources()
    {
        foreach (var dsIter in _reportDataSources.Where(paramIter => paramIter.Value == null))
        {
            throw new ApplicationException(string.Format("Report {0}: Value not supplied for the DataSource: {1}", _report.ReportPath, dsIter.Name));
        }
    }

    internal void SetReportParameterValue(string paramName, params string[] paramValues)
    {
        foreach (var paramIter in _reportParameters.Where(paramIter => paramIter.Name.Equals(paramName)))
        {
            paramIter.Values.AddRange(paramValues.ToArray());
            return;
        }
    }

    internal void SetDataSourceValue(string dataSourceName, object dataSourceValue)
    {
        foreach (var dsIter in _reportDataSources.Where(dsIter => dsIter.Name.Equals(dataSourceName)))
        {
            dsIter.Value = dataSourceValue;
            return;
        }
    }

    public enum Formats
    {
        PDF = 1,
        Excel,
        Word
    }
} 
```

报告的示例代码隐藏：

```
public class YourReport: ReportGenerator
{
    public string Parameter1 { get; set; }
    public string Parameter2 { get; set; }
    public string Parameter3 { get; set; }
    public string SubReportParameter1 { get; set; }
    public string SubReportParameter2 { get; set; }

    public List<SomeEntity> EntityList { get; set; }
    public List<SomeOtherEntity> SubReportEntityList { get; set; }

    private readonly CodeBehindClassForAnySubReport _anySubReport;

    public YourReport():base("ReportName", "ReportFileName")
    {
        _anySubReport = new YourReport();
        SetSubReports(_anySubReport);
    }

    public override void SetParamsAndDataSources()
    {
        SetReportParameterValue("Param1NameInReport", Parameter1);
        SetReportParameterValue("Param2NameInReport", Parameter2);
        SetReportParameterValue("Param3NameInReport", Parameter3);
        SetReportParameterValue("SubParam1NameInReport", SubReportParameter1);
        SetReportParameterValue("SubParam2NameInReport", SubReportParameter2);

        base.SetDataSourceValue("DataSourceNameInReport", EntityList);

        _anySubReport.EntityList = this.SubReportEntityList;
        //Call this only when subreport contains any datasource.
        //Parameters for subreports should be chained in the report design
        _anySubReport.SetParamsAndDataSources();
    }
} 
```

前端代码隐藏类的示例用法：

```
var repGen = new YourReport
                             {
                                 Parameter1 = someValue1,
                                 Parameter2 = someValue2,
                                 Parameter3 = someValue3,
                                 SubReportParameter1 = someValue4,
                                 SubReportParameter2 = someValue5,
                                 EntityList = someList1,
                                 SubReportEntityList = someList2
                             };

var repExp = repGen.GenerateReport(format, out mimeType, out fileName);

Response.Buffer = true;
Response.Clear();
Response.ContentType = mimeType;
Response.AddHeader("content-disposition", "attachment; filename=" + fileName);
Response.BinaryWrite(repExp);
Response.Flush(); 
```

## 还有一些说明可以帮助您：

## 什么是报告生成器？

Report Generator 是一个类似于 MS-Reports 代码隐藏的库。它使报表导出在 web 层中易于使用。

* * *

## 如何使用报告生成器？

对于任何新报告，请按照以下步骤模拟代码隐藏类：

1.  对于报告中的每个子报告，确保以下内容： (a) 报告生成器代码隐藏类已经使用与主报告相同的步骤进行编码。(b) 在报表设计器中，主报表的参数被链接到子报表参数。因此，子报告参数应该冒泡并作为主要报告参数公开。
2.  为派生自“ReportGenerator”类的主报表创建一个新类。
3.  对于主报告中的每个参数（其中一些是从 1b 中提到的子报告中冒出来的），为新类添加一个新属性。
4.  为每个子报表创建一个只读字段。字段的类型应该是子报表的代码隐藏类。
5.  将任何子报表数据源属性公开为主报表属性
6.  主报表类的构造函数应该： (a) 调用基类构造函数，将报表的物理名称作为方法参数。(b) 初始化所有子报表字段，并通过调用 SetSubReports 方法添加到子报表列表中。
7.  覆盖方法“SetParamsAndDataSources”。此方法应调用： (a) SetReportParameterValue 为每个报告参数设置值。请注意，这些值将是相应的类属性的值。(b) SetDataSourceValue 为每个报告数据源设置值。请注意，这些值将是相应的类属性的值。(c) 每个子报告字段的 SetParamsAndDataSources。

按照以下简单步骤使用在 web 层中创建的新类：

1.  创建新报告生成器类的实例
2.  为参数和数据源属性赋值
3.  调用 GenerateReport 方法，将导出的报告作为字节数组返回。将此作为文件附件级联到响应。

* * *

## 使用报告生成器有什么好处？

1.  它消除了 Web 层中参数名称和数据源的所有硬编码。即使这些在报告生成器类中再次被硬编码，我们也可以控制我们正在编码的内容。
2.  mocked-code-behind 类是相应报告的对象表示，因此使任何面向对象的开发人员的生活更轻松。
3.  报告生成的所有复杂功能都隐藏在 ReportGenerator 基类中，因此对于任何新报告只需进行有限的编码。

* * *

## 报告生成器基类是否可在任何其他项目中重用？

是的。

* * *

## 有什么可以改进的吗？

是的，很多。其中很少有： 1\. 向 ReportGenerator 基类添加一个可以将报表附加到报表查看器的方法。2\. 目前，基类将所有报告参数视为“字符串”类型。可以修改以适应任何类型的参数。

# sql-server-2008 - 奇怪的 SQL 行为

> ID：11974282
> 
> 赞同：0
> 
> 时间：2012-08-15T17:41:02.797
> 
> 标签：sql-server-2008

已运行多年的视图从多个表中选择特定列并将它们连接起来。最近，我在其中一个表中添加了一列，vew 不再正常工作。查询结果中的一列包含来自表中另一列的数据。我从脚本重建了视图 - 没有更改脚本 - 问题就消失了。该视图不查看新列。

到底是怎么回事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T20:05:09.393

您的查询正在使用 SELECT *。你只需要重新编译它。

编译视图时，它编译记录中字段的偏移量，而不是字段的名称。如果基础表发生变化。. . 好吧，偏移量不再到达正确的位置。

不幸的是，我在尝试弄清楚为什么一个数字会出现数字错误大约 5 个小时后才知道这一点——从早上 6:00 开始。所以，这个问题甚至会影响不同类型的数据。

我通过使用 SQL Server Management Studio 将视图编写为变更脚本，然后运行代码（不做任何更改）来进行重新编译。但是，您可以通过放入列的显式列表来更改代码，并且将来不会出现此问题。

您还可以设置一个脚本，每天晚上重新编译您的所有视图，以防止将来出现此问题。我们现在也有这样的脚本。

# android - 创建返回在应用程序开始时获得的值的方法

> ID：11974285
> 
> 赞同：0
> 
> 时间：2012-08-15T17:41:13.327
> 
> 标签：android, integer, return, call, oncreate

我正在开发一个应用程序，我想找出用户从不是 onCreate() 的方法启动我的应用程序时的音量。我根据 onCreate 中的当前卷创建了一个 int，但由于它无法返回任何内容，我不知道如何从那里获取我的 int。使用在 onCreate() 中生成的 int 非常重要。

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T17:48:18.637

如果我很好理解你，你应该使用：[SharedPreferences](http://developer.android.com/reference/android/content/SharedPreferences.html)来保存该值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T18:12:47.770

@pawegio 对，如果您想使用用户设置的相同音量级别，请使用首选项。这是如何：

写入首选项

```
SharedPreferences pref =
            context.getSharedPreferences("MyAppPreferences", Context.MODE_PRIVATE);

    /*
     * Get the editor for this object. The editor interface abstracts the implementation of
     * updating the SharedPreferences object.
     */

    SharedPreferences.Editor editor = pref.edit();

    /*
     * Write the keys and values to the Editor
     */

    editor.putInt("VolumLevel", 60);
    /*
     * Commit the changes. Return the result of the commit.
     */

    e.commit(); 
```

从偏好中读取

```
 SharedPreferences pref = context.getSharedPreferences("MyAppPreferences", MODE_PRIVATE);
 int volLevel = pref.getInt("VolumLevel", 50 /*Default if value wasn't setup yet*/);

 return volLevel; 
```

# objective-c - 隐藏 UIKeyboard

> ID：11974287
> 
> 赞同：7
> 
> 时间：2012-08-15T17:41:21.447
> 
> 标签：objective-c, uikeyboard

我试图在我的 SplitView 应用程序中隐藏键盘（因为它覆盖了根菜单的一部分）。但是，我唯一能找到的是如何在使用文本字段后隐藏键盘`[TextField resignFirstResponder]`。

有没有其他方法可以隐藏键盘？
理想情况下，我想使用显示菜单的 barButtonItem 作为隐藏键盘的触发器。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-15T18:06:19.263

用这个：

```
[[[UIApplication sharedApplication] keyWindow] endEditing:YES]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T17:43:27.033

您需要将`-resignFirstResponder`消息发送到当前具有第一响应者状态的任何 UI 元素的实例。因此，如果`firstNameTextField`您的类上有一个与 的实例相对应的属性，则`UITextField`需要将消息发送到该对象。

`[self.firstNameTextField resignFirstResponder];`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T18:01:58.280

`resignFirstResponder`是这样做的。如果您的 firstResponder 没有设置为实例变量（可能是它生成的），您可以使用[这个 answer](https://stackoverflow.com/a/1823360/442328)来“获取”您的 firstResponder 。获得第一响应者对象后，只需将其辞职！

希望这可以帮助。

# sql - SQL 2005 列表中的动态字符串替换

> ID：11974290
> 
> 赞同：0
> 
> 时间：2012-08-15T17:41:29.303
> 
> 标签：sql, string, sql-server-2005

我有一列可以产生如下结果：

```
ER

ER,ER,ER

ER,ER,OR,OR

OR

OR,OR

OR,OR,OR,ER,ER 
```

我正在寻找一种方法来替换任何字符串，`"ER,ER,ER,OR,OR"`例如`"ER,OR"`. 无论出现多少次`ER`或`OR`出现，我只希望每个只显示一次。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:57:41.463

创建一个拆分函数（或在此站点上搜索数百个变体）：

```
CREATE FUNCTION [dbo].[SplitStrings_XML]
(
   @List       NVARCHAR(MAX),
   @Delimiter  NVARCHAR(255)
)
RETURNS TABLE
WITH SCHEMABINDING
AS
   RETURN 
   (  
      SELECT Item = y.i.value(N'./text()[1]', N'nvarchar(4000)')
      FROM 
      ( 
        SELECT x = CONVERT(XML, '<i>' 
          + REPLACE(@List, @Delimiter, '</i><i>') + '</i>').query('.')
      ) AS a 
      CROSS APPLY x.nodes('i') AS y(i)
   );
GO 
```

然后你可以这样做：

```
DECLARE @x TABLE(foo VARCHAR(32));

INSERT @x SELECT 'ER'
UNION ALL SELECT 'ER,ER,ER'
UNION ALL SELECT 'ER,ER,OR,OR'
UNION ALL SELECT 'OR'
UNION ALL SELECT 'OR,OR'
UNION ALL SELECT 'OR,OR,OR,ER,ER';

;WITH g AS 
(
  SELECT x.foo, s.Item
    FROM @x AS x 
    CROSS APPLY dbo.SplitStrings_XML(x.foo, ',') AS s
    GROUP BY x.foo, s.Item
)
SELECT original = x.foo, new = STUFF((SELECT ',' + Item FROM g
  WHERE foo = x.foo GROUP BY Item 
  FOR XML PATH(''), 
    TYPE).value(N'./text()[1]', N'nvarchar(max)'), 1, 1, '')
  FROM @x AS x; 
```

结果几乎完全符合您的要求，除了不保留初始字符串的顺序：

```
original          new
----------------- ----------
ER                ER
ER,ER,ER          ER
ER,ER,OR,OR       ER,OR
OR                OR
OR,OR             OR
OR,OR,OR,ER,ER    ER,OR 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T17:54:18.190

一种快速而肮脏的方式是这样的......尽管它仅限于您在问题中提供的示例。从概念上讲，KM 对您的问题的评论中提供了更好的方法。

```
update mytable 
set mycolumn = 
case when (mycolumn like '%er%' and not mycolumn like '%or%') then 'ER'
when (mycolumn like '%or%' and not mycolumn like '%er%') then 'OR'
when (mycolumn like '%er%' and mycolumn like '%or%') then 'ER,OR' end 
```

# javascript - 如果不是来自引用域，则重定向

> ID：11974293
> 
> 赞同：0
> 
> 时间：2012-08-15T17:41:33.830
> 
> 标签：javascript

我想设置一个 javascript 来完成以下任务：

用户打开一个带有书签的网页，脚本会检查它是否来自引用域（例如，site.com），如果不是，则将它们自动重定向到 anothersite.com。目标是只有当用户来自 anothersite.com 站点时，site.com 页面才会出现。希望这是有道理的。

我通常会为此使用 PHP，但不能用于这个项目，所以我们只能用 javascript 来做这件事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T17:47:44.450

查看[**document.referrer**](http://www.w3schools.com/jsref/prop_doc_referrer.asp)以获取引荐来源网址，从中提取域，然后进行验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T17:48:09.023

我没有完全理解“打开书签”的部分，因为有人说知道很多事情并不容易完成[有没有办法知道是否有人为您的网站添加了书签？](https://stackoverflow.com/questions/1393618/is-there-a-way-to-know-if-someone-has-bookmarked-your-website)

..但是要检查它的来源，我会研究[如何在 Javascript 中获取以前的 url？](https://stackoverflow.com/questions/3528324/how-do-you-get-the-previous-url-in-javascript)

再加上你自己的 if else 东西，并用它`window.location.href = "your_site_url";`来引导他你想要的页面，工作完成！

# linux - cron 作业：监控作业完 成所需的时间

> ID：11974296
> 
> 赞同：5
> 
> 时间：2012-08-15T17:41:42.317
> 
> 标签：linux, shell, ubuntu, cron

我正在做一个研究项目，需要我在 Ubuntu Linux 系统上监控 cron 作业。我收集了有关作业任务的数据，当它们开始时，我只是不知道有一种方法可以监控它们完成运行所需的时间。

我可以计算完成任务的时间减去以这样的方式启动它[，](https://serverfault.com/questions/151109/bash-how-do-i-get-current-unix-time-in-milliseconds "像这样的东西")但这需要在每个 cron 作业的 Shell 脚本上执行此操作。无论如何这并不一定很困难，但是cron不会以某种方式记录这个似乎有点愚蠢，所以我试图找到一种更简单的方法：P

tl;dr 计算出 cron 作业从开始到结束所花费的时间

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-15T17:52:13.180

你可以把它放在`time`你的 crontab 前面，如果你收到关于 cron 脚本输出的通知，它会被发送给你。

例如，如果您有：

```
0 1,13 * * * /maint/run_webalizer.sh 
```

`time`在前面加上

```
0 1,13 * * * time /maint/run_webalizer.sh 
```

你会得到一些看起来像的输出（“真实”是你想要的时间）：

```
real    3m1.255s
user    0m37.890s
sys     0m3.492s 
```

如果您没有收到 cron 通知，则可以将输出通过管道传输到文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T17:50:52.600

`man time`. 也许您可以创建一个包装器并告诉 Cron 将其用作您的“外壳”或类似的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-30T23:24:29.820

我使用 Jenkins CI 通过它的 external-monitor-job 插件来做到这一点。Jenkins 可以跟踪开始和结束时间，跟踪一段时间内的整体执行时间，保存它跟踪的所有作业的输出，并以图形方式呈现成功/失败条件。

[https://wiki.jenkins-ci.org/display/JENKINS/Monitoring+external+jobs](https://wiki.jenkins-ci.org/display/JENKINS/Monitoring+external+jobs)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-29T16:50:06.933

Cronitor ( [https://cronitor.io](https://cronitor.io) ) 是我专门为此目的而构建的工具。它使用 http 请求来记录工作的开始和结束。

如果您的作业未按计划运行，或者运行时间过长/过短，您将收到通知。您还可以将其配置为通过电子邮件、短信以及 Slack、Hipchat、Pagerduty 等方式向您发送警报。

# ruby-on-rails - 下拉，空字段作为第一个使用选择选项

> ID：11974299
> 
> 赞同：0
> 
> 时间：2012-08-15T17:42:00.910
> 
> 标签：ruby-on-rails, select

嗨，我有以下显示下拉菜单

```
<p><%= f.select :depGroupname, options_for_select(@dep_group_name, :inlcude_blank => true) %></p> 
```

在这里，我需要第一个选项是空白的。但在上面的代码中，下拉列表从 @dep_group_name 数组中的第一个元素开始。

让我知道如何使用 options_for_select 标签包含空白

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T17:51:34.373

将 include_blank 部分移到`options_for_select`

```
<p><%= f.select :depGroupname, options_for_select(@dep_group_name), {:include_blank => true} %></p> 
```

您还可以通过将 true 替换为字符串来设置空白提示

```
<p><%= f.select :depGroupname, options_for_select(@dep_group_name), {:include_blank => "Choose Your Department"} %></p> 
```

# jquery - jQuery查找下拉列表，最大选择“rel”属性

> ID：11974301
> 
> 赞同：1
> 
> 时间：2012-08-15T17:42:08.197
> 
> 标签：jquery, rel

我有一堆（确切的数字可能会有所不同）带有此代码的下拉列表：

```
<div id="wrapf">
  <div class="dropf">
    <select name="number" id="number" class="options">
      <option value="" rel="">Choose option!</option>
      <option value="1" rel="20">Option 1</option>
      <option value="2" rel="30">Option 2</option>
      <option value="3" rel="40">Option 3</option>
    </select>
  </div>
</div> 
```

我正在尝试设置一个函数，如果我有 2 个（或更多）这些下拉列表显示，具有不同的选定值，我可以突出显示具有最高`rel`属性的选定选项的下拉列表......我将添加类`.highlight`到`#wrapf`包含最大下拉列表的那个`rel`....到目前为止我有这个：

突出显示 CSS

```
.highlight {
   box-shadow: 0px 0px 15px rgba(255, 40, 50, 0.4);
   -webkit-box-shadow: 0px 0px 15px rgba(255, 40, 50, 0.4);
   background: rgba(255, 40, 50, 0.4);
} 
```

这是 jQuery：

```
$("#getMax").click(function () {
    var values = $.map($(".options"), function(el, index) {
        return parseInt($(el).find('option:selected').attr('rel')); 
});        

var max = Math.max.apply(null, values);
var opt = "[rel=" + max + "]";

//doesn't work :(
$('#wrapf').find('option:selected').attr(opt).addClass('highlight');

});​ 
```

我想我已经接近了，只需要最终的功能`.addClass('highlight')`！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:51:20.820

[**jsFiddle 演示**](http://jsfiddle.net/zCFpj/6/)

```
 $("#getMax").click(function (e) {
    var values = $.map($(".options"), function(el, index) {
        return $(el).find('option:selected').attr('rel'); 
        // parseInt() was originally creating a problem as [] turned into NaN
    });     

    var max = Math.max.apply(null, values);

    //works :)
    $('.wrapf').removeClass('highlight'); // remove all other references of highlight
    $('.wrapf').find('select option:selected[rel="' + max + '"]').closest('.wrapf').addClass('highlight');

    e.preventDefault(); // stops anchor from happening

}); 
```

# perforce - Perforce 将文件夹添加到仓库

> ID：11974304
> 
> 赞同：19
> 
> 时间：2012-08-15T17:42:25.783
> 
> 标签：perforce

我是 Perforce 的新手。你能在仓库的分支下添加一个新文件夹吗？我也尝试在我的工作场所添加一个，但我怎样才能将它送到仓库？我是否必须进行合并/集成或其他操作？

谢谢。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-12-03T23:49:10.270

**p4 add**不支持递归 add 。

这是从要添加的根文件夹中运行的 unix shell 解决方法：

```
find . -type f -print | p4 -x - add 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-08-15T17:47:12.240

从您的本地工作区，创建您的文件夹和一个您想要放入其中的文件。然后要么从可视化客户端将其标记为添加，要么从命令行进入文件夹，然后键入...

```
p4 add ./new_folder/new_file_name.ext 
```

当您提交时，新文件和文件夹将在您的存储库中。这假定这`new_folder`是您现有工作区的子文件夹。如果不是，请告诉我，我会更新我的答案。

上面的命令将在默认更改列表下添加文件。稍后，如果您想查看 if 文件确实添加到默认更改列表中

```
p4 opened 
```

而对于打开的文件的提交，在默认的changelist下，到depot

```
p4 submit 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2015-05-05T16:29:12.747

如果您的服务器版本是 2012.1 或更高版本，您可以使用[reconcile](http://www.perforce.com/perforce/r14.2/manuals/cmdref/p4_reconcile.html)命令执行此操作，并提供完整的通配符支持：

```
p4 reconcile //depot/path/to/folder/... 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2018-02-13T13:06:51.613

使用命令

```
p4 add directory_to_be_added/... 
```

这将递归地添加从 drom "directory_to_be_added" 开始的所有内容

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-02-03T00:11:55.890

在 perforce 中从目录添加文件

> `p4 reconcile -f -c [changeList] -a <dir_path_to add>`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-12-08T22:38:29.310

我有一种情况，我需要添加带有通配符名称的文件的整个文件夹，所以必须通过命令行使用 -f （强制）来完成，我使用了“dir /b /s /ad | p4 -x - add -f "

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-12-15T21:36:41.683

如果是使用p4v递归添加文件夹，需要点击：

`"Connection" -> "Edit Current Workspace"`

然后*手动*将新文件夹的映射添加到您的仓库。

然后转到您的“工作区”视图并右键单击根文件夹，单击“标记为添加”并发表评论。它下面的所有文件都应该显示在新的挂起更改列表中。

# jquery - 提交表格并获得回复

> ID：11974311
> 
> 赞同：0
> 
> 时间：2012-08-15T17:42:50.663
> 
> 标签：jquery, html, forms, post, same-origin-policy

我有一个用 HTML 创建的表单，该表单发布到外部域

```
<form method="post" action="someExternalDomain.com/submit"> 
```

我想用这个提交它（我不能使用 JQuery，因为[同源策略](https://stackoverflow.com/questions/9033513/why-is-post-subject-to-same-origin-policy-but-submitting-a-form-with-method)）但使用 JQuery 捕获来自服务器的响应。我该怎么做？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T18:03:57.547

没有 CORS 就不能跨域发布，jQuery 也无法访问响应，除非它是使用`jQuery.ajax`iframe 或 iframe 完成的，这两者都受同源策略的限制。

如果您确实希望实现 CORS，还需要进行一些其他修改才能使其在所有版本的 IE 中工作。

# python - 如何在 jinja python 模板中输出逗号分隔列表？

> ID：11974318
> 
> 赞同：228
> 
> 时间：2012-08-15T17:43:18.290
> 
> 标签：python, jinja2

如果我有一个`users`say列表`["Sam", "Bob", "Joe"]`，我想做一些可以在我的 jinja 模板文件中输出的事情：

```
{% for user in userlist %}
    <a href="/profile/{{ user }}/">{{ user }}</a>
    {% if !loop.last %}
        , 
    {% endif %}
{% endfor %} 
```

我想让输出模板为：

```
Sam, Bob, Joe 
```

我尝试了上面的代码来检查它是否在循环的最后一次迭代中，如果不是，则不要插入逗号，但它不起作用。我该怎么做呢？

* * *

## 回答 #1

> 赞同：397
> 
> 时间：2012-08-15T17:49:34.080

你希望你的`if`支票是：

```
{% if not loop.last %}
    ,
{% endif %} 
```

请注意，您还可以使用[If Expression](https://jinja.palletsprojects.com/templates/#if-expression)缩短代码：

```
{{ ", " if not loop.last else "" }} 
```

* * *

## 回答 #2

> 赞同：236
> 
> 时间：2014-04-03T08:04:44.957

你也可以使用内置的“加入”过滤器（[http://jinja.pocoo.org/docs/templates/#join](http://jinja.pocoo.org/docs/templates/#join)像这样：

```
{{ users|join(', ') }} 
```

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2015-11-26T14:15:39.130

并使用`joiner`来自[https://jinja.palletsprojects.com/templates/#joiner](https://jinja.palletsprojects.com/templates/#joiner)

```
{% set comma = joiner(",") %}
{% for user in userlist %}
    {{ comma() }}<a href="/profile/{{ user }}/">{{ user }}</a>
{% endfor %} 
```

它正是为此目的而设计的。通常，对于单个列表，连接或检查 forloop.last 就足够了，但对于多组事物，它很有用。

关于为什么要使用它的更复杂的示例。

```
{% set pipe = joiner("|") %}
{% if categories %} {{ pipe() }}
    Categories: {{ categories|join(", ") }}
{% endif %}
{% if author %} {{ pipe() }}
    Author: {{ author() }}
{% endif %}
{% if can_edit %} {{ pipe() }}
    <a href="?action=edit">Edit</a>
{% endif %} 
```

# android - 需要实例化一个 Android 活动以传递给另一个方法

> ID：11974321
> 
> 赞同：0
> 
> 时间：2012-08-15T17:43:28.120
> 
> 标签：android, android-activity, parameter-passing

我正在尝试调用此方法：

```
 public static void trackFunXStartActivity(Activity a)
{
    s.startFunXActivity(a);
} 
```

我试图在我的 LayoutsActivity.java 中使用此代码来调用它：

```
public void onStart() {
    TrackFunX.trackFunXStartActivity(LayoutsActivity);
} 
```

但我不确定如何创建或引用可以传递给 trackFunXStartActivity(Activity a) 的 Activity。我认为我不能将 LayoutsActivity 作为 Activity 传递。

如何实例化或引用 LayoutsActivity.java 中的活动以传递给 trackFunXStartActivity。

我是一名 Android 新手，在 StackOverflow 上进行了一些搜索，但没有看到任何可以帮助解决这个问题的东西。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T17:48:31.547

为 LayoutsActivity 获取静态上下文，例如

```
static Context context; 
```

并在 oncreate 方法中使用

```
context = LayoutsActivity.this 
```

最后你可以在你需要的类中使用这个上下文

# javascript - ajaxslt 无法使用 XPATH 获取节点

> ID：11974329
> 
> 赞同：1
> 
> 时间：2012-08-15T17:44:03.437
> 
> 标签：javascript, xml, xpath

我正在使用 ajaxslt javascript 库。(http://code.google.com/p/ajaxslt/) 我正在尝试使用 XPATH 获取节点

我的 XML 如下：

```
 <page>
            <message>
              Hello World.
            </message>
          </page> 
```

我正在尝试使用 //page 以便我可以在页面下方的所有节点，即消息节点。当我尝试打印相同的。我只得到 Hello World 作为输出。

以下是我使用的代码片段。

```
<script src="./js/xpath.js" language="JavaScript"></script>
<script src="./js/xpath_script.js" language="JavaScript"></script>
<script type="text/javascript"> 
```

`function showMessage(){ var xml = document.getElementById('xml'); var ctx = new ExprContext(xmlParse(xml.value)); var expr = xpathParse("//page"); var result = expr.evaluate(ctx); alert("res:"+result.stringValue()); }`

谁能告诉我我在这里做错了什么？

提前致谢。

萨拉瓦南 K

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T03:20:37.627

**您必须使用：**

```
//page/message 
```

这通常选择多个`message`元素。您需要遍历返回的节点列表并生成每个选定`message`元素的字符串值。

# javascript - 从未隐藏的列表项中获取项目

> ID：11974330
> 
> 赞同：0
> 
> 时间：2012-08-15T17:44:05.020
> 
> 标签：javascript, jquery, css, html

```
<ul id="component-list" class="no-left-margin">
    <li class="component-items hide">
        <span>Login</span>
            <a href="#">
            <i class="icon-remove"></i>
            </a>
    </li>
    <li class="component-items">
        <span>Register</span>
        <a href="#">
            <i class="icon-remove"></i>
        </a>
    </li>

</ul> 
```

我正在尝试获取可见项目的列表（没有隐藏类的 li 标签内的跨度标签）

```
$('.component-items span').not('.hide'); 
```

上面的选择器给了我一个空数组。

`<li>`我需要选择器在没有隐藏类的情况下给我跨度标签。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T17:45:19.163

```
$('.component-items').not('.hide').find('span'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T17:46:23.710

```
$('.component-items:visible span') 
```

[http://api.jquery.com/visible-selector/](http://api.jquery.com/visible-selector/)

干杯!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-20T14:52:25.633

我喜欢使用 css 伪类：not()。

```
$(".component-items").find("span:not(.hide)") 
```

希望对你有帮助

# ruby-on-rails - 如何在一些 Ruby 文件中使用对象（例如用户）并执行它？

> ID：11974331
> 
> 赞同：0
> 
> 时间：2012-08-15T17:44:10.680
> 
> 标签：ruby-on-rails, object

我有这样的问题：我需要让所有用户及其关联对象与他们一起执行一些操作。该文件应每月执行一次（用于付款）。我在 Windows 中编程，但服务器可能在 *nix 上。

这是我想在代码中做的事情：

```
 @users = User.all
       @emails ||= Array.new
       @amounts||= Array.new
      @users.each do |user|
      emails.push(user.email)//array of emails
      amounts.push(user.websites.amount)//it will be arrray of amounts
      //then I will make post request, which I do can with static values 
```

我如何使用 User.all ？有人可以帮我弄这个吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:02:10.307

我认为您想在 Rails 应用程序中为此创建自定义 rake 任务。看看这个关于如何创建任务的[railscast 。](http://railscasts.com/episodes/66-custom-rake-tasks/)

# c++ - 使用 boost 设置 gamma_distribution 的参数

> ID：11974335
> 
> 赞同：0
> 
> 时间：2012-08-15T17:44:28.947
> 
> 标签：c++, boost, random, boost-random, gamma-distribution

我正在尝试使用 Boost 1.5 中的 Gamma 分布。现在我希望*k*和*theta*的值分别为 4 和 0.5。但是，每当我设置*theta* < 1 的值时，都会出现编译错误。

```
/usr/local/include/boost/random/gamma_distribution.hpp:118: boost::random::gamma_distribution<RealType>::gamma_distribution(const RealType&, const RealType&) [with RealType = double]: Assertion `_beta > result_type(0)' failed. 
```

有什么办法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T19:21:56.603

看起来您没有将参数正确传递给分布函数。这是 C++11 版本（Boost 等效）：

```
#include <random>
#include <iostream>
int main()
{   
    std::random_device rd;
    std::mt19937 gen(rd());
    double alpha = 4.0;
    double theta = 0.5;
    std::gamma_distribution<> gamma(alpha, 1.0 / theta);
    auto value = gamma(gen);

    // May print: 6.94045.
    std::cout << value << std::endl;

    return 0;
} 
```

注意参数化：

*   `alpha`是相同的`k`
*   `beta`逆尺度参数 和 相同`1 / theta`。

# c# - 使用 FileHelper 库解析 CSV 字符串，但需要忽略换行符

> ID：11974341
> 
> 赞同：1
> 
> 时间：2012-08-15T17:45:05.030
> 
> 标签：c#, parsing, csv, filehelpers

我已经逐行读取了一些具有以下格式的 CSV 值：

`30: "NY", 41: "JOHN S.", 36: "HAMPTON", 42: "123 Road Street, NY", 68: "Y"`

为了进一步解析这些项​​目，我需要将其分解为以下内容：

`30: "NY"`

`41: "JOHN S."`

`36: "HAMPTON"`

`42: "123 Road Street, NY"`（注意逗号）

`...`

我正在使用[FileHelper](http://filehelpers.sourceforge.net)库，但它似乎喜欢逐行阅读内容，尽管我希望它被分隔的`,`逗号分隔。

我有记录类：

```
[DelimitedRecord(",")]
class BoxRecord
{
    public String record;
} 
```

我通过以下方法检索了我希望数组中的几个对象，但它只返回了原始行：

```
DelimitedFileEngine engine = new DelimitedFileEngine(typeof(BoxRecord));
BoxRecord[] boxes = (BoxRecord[])engine.ReadString(boxLine); 
```

我想要`boxes[].record`包含的内容：

`30: "NY"`

`41: "JOHN S."`

`36: "HAMPTON"`

`42: "123 Road Street, NY"`

`...`

它实际包含的内容：

`30: "NY", 41: "JOHN S.", 36: "HAMPTON", 42: "123 Road Street, NY", 68: "Y"`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T18:35:18.200

得到线路后，你可以根据下面的 linq 换行得到你想要的：

```
string input = "30: \"NY\", 41: \"JOHN S.\", " +
   "36: \"HAMPTON\", 42: \"123 Road Street, NY\", 68: \"Y\"";

var tempList = input.Split('\"').ToList();

var result = Enumerable.Range(0, tempList.Count/2)
    .Select(i => string.Join(": "
        , tempList[2*i].Split(new[] { ',', ':' })
           .Single(ss => !string.IsNullOrWhiteSpace(ss))

        , tempList[2*i + 1])); 
```

* * *

**更新：**对我来说似乎很有趣，这段代码是为了处理这个案例作为你的评论：

```
var tempList1 = input.Split(':').ToList();

var tempList2 = tempList1.SelectMany((s, index) =>
 {
     if (index == 0 || index == tempList1.Count - 1)
         return new List<string>() { s };

     var subList = s.Split(',');
     return new List<string>
           { 
                string.Concat(subList.Take(subList.Length - 1)),
                subList.Last()
           };
 }).ToList();

var result = Enumerable.Range(0, tempList2.Count / 2)
         .Select(i => string.Join(": ", tempList2[2 * i], tempList2[2 * i + 1])); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T22:29:23.763

从技术上讲，您正在查看的示例不是有效的 CSV 格式文件。基本上，提供文件的人以非标准方式使用了文本限定符符号 - 双引号 "。使用它的传统方式是这样的：

```
123,"Sue said, ""Hi, this is a test!""",2012-08-15 
```

此语句应解析为：

```
Assert.AreEqual(line.Length, 3);
Assert.AreEqual(line[0], @"123");
Assert.AreEqual(line[1], @"Sue said, ""Hi, this is a test!""");
Assert.AreEqual(line[2], @"2012-08-15"); 
```

根据我看到的标准，从您的问题中提供的示例 CSV 来看，正确的处理基本上应该将引号视为字符串中的常规字符，而不是文本限定符。这就是我如何解释你的台词——如果我错了，请告诉我！

```
Assert.AreEqual(line.Length, 6);
Assert.AreEqual(line[0], @"30: ""NY""");
Assert.AreEqual(line[1], @" 41: ""JOHN S.""");
Assert.AreEqual(line[2], @" 36: ""HAMPTON""");
Assert.AreEqual(line[3], @" 42: ""123 Road Street");
Assert.AreEqual(line[4], @" NY""");
Assert.AreEqual(line[5], @" 68: ""Y"""); 
```

我想 FileHelper 正在破坏，因为它无法确定文本是文本限定的还是正确分隔的。你最好使用自定义代码来处理这个；Cuong Le 提供的解决方案似乎适合您的解决方案。

作为参考，我的 C# CSV 库在这里：[https ://code.google.com/p/csharp-csv-reader/](https://code.google.com/p/csharp-csv-reader/)

编辑：为了好玩，我想知道是否可以使用正则表达式对此进行解码。您的数据的格式是一致的，即使它不是严格的 CSV，所以也许这对您的工具箱来说是别的东西：

```
String mystring = @"30: ""NY"", 41: ""JOHN S."", 36: ""HAMPTON"", 42: ""123 Road Street, NY"", 68: ""Y""
    20: ""STEVE"", 12: ""JONES"", 96: ""1600 PENNSYLVANIA AVE, NW""
    30: ""NY"", 41: ""JOHN S."", 36: ""HAMPTON"", 42: ""123 Road Street, NY"", 68: ""Y"", 40: 12345";
Regex r = new Regex(@"(?<id>\d*): (""(?<field>[^""]*)""|(?<field>[\d]*))");
MatchCollection mc = r.Matches(mystring);
foreach (Match m in mc) {
    Console.WriteLine("{0}: {1}", m.Groups["id"], m.Groups["field"]);
} 
```

基本上，正则表达式通过查找两个十进制数字，后跟冒号 - 空格 - 双引号来工作。然后它会查找所有文本，直到它到达另一个双引号。根据我的测试，这也会为您在问题中描述的两条测试线产生正确的匹配。

如果我的正则表达式不太正确，这里有一个漂亮的在线正则表达式测试器：http: [//gskinner.com/RegExr/](http://gskinner.com/RegExr/) - 尝试将数据复制并粘贴到搜索区域，然后使用这个正则表达式字符串作为起点：

```
(?<id>\d*): ("(?<field>[^"]*)"|(?<field>[\d]*)) 
```

EDIT2：我修复了正则表达式，还考虑了您在下面的评论中引用的“40：12345”值。它现在可以正确检测所有示例中的所有字段。

EDIT3：从另一个请求，这个正则表达式现在支持冒号前的无限长度数字。以下是正则表达式如何工作的快速解释：

*   `(?<id>\d*)`- 第一个块称为捕获组 - 捕获组用括号括起来。它尝试捕获`*`十进制数字 ( ) 的重复字符串 ( `\d`) 并将其命名为“id” ( `?<id>`)。
*   `:`- 匹配记录之间的冒号空格。
*   `"(?<field>[^"]*)"`- 查找开头的引号，然后查找除引号 ( ) 之外的大量字符`[^"]`，并以另一个引号结尾。将结果保存在“字段”中。
*   `(?<field>[\d]*)`- 查找任意数量的十进制数字并将结果保存在“字段”中。请注意，某些正则表达式引擎不支持拥有两个具有相同名称的捕获组；您可能必须调用一个“field1”和另一个“field2”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T22:09:15.613

尽管我遇到了所有“不要重新发明轮子”的帖子（所有这些帖子），但这对我来说是最好的解决方案，也是我发现的唯一一个有效的解决方案。

我尝试使用 FileHelper 框架、Cuong Le 的答案和 VB `TextFieldParser`。每个都以不同的方式工作和不工作。

我需要能够解析这个（“非标准”CSV 格式）。这些行是来自文件的输入，但不是 CSV 文件。它们是更大结构的一部分：

`30: "NY", 41: "JOHN S.", 36: "HAMPTON", 42: "123 Road Street, NY", 68: "Y", 40: 12345`

* * *

FileHelper 会在引号中用逗号分隔，例如：

`123 Road Street, NY`

变成

`213 Road Street`

`NY`

Cuong Le的回答没有处理这种情况：（`40: 12345`不带引号的数据值）

TextFieldParser 也可以用逗号分隔引号，例如 FileHelper。

* * *

我的快速、肮脏、自己动手的解决方案（它有效！）：

```
 private List<KeyValuePair<string, string>> SplitBoxLine(String input)
    {
        //SAMPLE input:
        //30: "NY", 41: "JOHN S.", 36: "HAMPTON", 42: "123 Road Street, NY", 68: "Y", 40: 12345

        List<KeyValuePair<string, string>> boxes = new List<KeyValuePair<string, string>>();

        int quoteCount = 0;
        String buffer = "";
        String boxNum = "";
        String boxValue = "";

        for (int i = 0; i < input.Length; i++)
        {
            if (i == input.Length - 1)
            {
                //if the input character at the end ISN'T a quote or comma, add it to the buffer
                //supports the case where the last item is 40: 12345
                if (input[i] != ',' && input[i] != '\"')
                {
                    buffer += input[i];
                }
                boxValue = String.Copy(buffer.Trim());

                //once we have the value, we can create the pair
                KeyValuePair<string, string> pair = new KeyValuePair<string, string>(boxNum, boxValue);
                boxes.Add(pair);

                Console.WriteLine("BOX VALUE [LAST ITEM]: " + boxValue);
            }

            if (input[i] == ':')
            {
                boxNum = String.Copy(buffer.Trim());
                buffer = "";
                Console.WriteLine("BOX NUM: " + boxNum);
            }
            else if (input[i] == '\"')
            {
                quoteCount++;
            }
            else if (input[i] == ',')
            {
                if (quoteCount % 2 == 0) //comma occurs outside of quotes
                {
                    boxValue = String.Copy(buffer.Trim());
                    buffer = "";

                    //once we have the value, we can create the pair
                    KeyValuePair<string, string> pair = new KeyValuePair<string, string>(boxNum, boxValue);
                    boxes.Add(pair);

                    Console.WriteLine("BOX VALUE: " + boxValue);
                }
                else //the comma occurs in some quotes
                {
                    buffer += input[i]; //add the comma, it's just part of the boxValue
                }
            }
            //nothing special about this chacter, add it to the buffer and continue
            else
            {
                buffer += input[i];
            }
        }

        return boxes;
    } 
```

# html - HTML实体到十六进制等效

> ID：11974343
> 
> 赞同：1
> 
> 时间：2012-08-15T17:45:06.777
> 
> 标签：html, xml, encoding

我有带有 html 实体等的旧 xml 文件`&mdash;`。如何将此实体转换为十六进制等效项，例如`&#8212;`. 有没有简单的方法可以使用批处理命令或其他方法来做到这一点？我不是高级程序员，因此将不胜感激任何详细的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T17:59:23.630

只需简单的查找和替换即可。大多数（如果不是所有的话）文本/代码编辑器都具有查找/替换功能。

可能只有少数字符串构成了您需要替换的大部分内容，幸运的是，它们都非常独特，因此您不太可能有任何意外替换。

# javascript - Ti.Storekit 钛

> ID：11974346
> 
> 赞同：0
> 
> 时间：2012-08-15T17:45:20.740
> 
> 标签：javascript, ios, titanium, in-app-purchase, storekit

我在购买基于订阅的项目时遇到了 Titanium 中的 Storekit 模块的问题（可能也会影响其他项目）。

我在购买商品时收到的错误代码是：

```
[WARN] error in transaction: Error Domain=SSServerErrorDomain Code=5002 "An unknown error has occurred" UserInfo=0x9b3a660 {NSLocalizedDescription=An unknown error has occurred} 
```

我用来引用产品的代码在这里：（Javascript）

```
requestProduct('553XXXXXX.testproductname', function (product) {
    var buySingleItem = Ti.UI.createButton({
        title: 'Buy ' + product.title + ', ' + product.formattedPrice,
        top: 60, left: 5, right: 5, height: 40
    });
    buySingleItem.addEventListener('click', function () {
        purchaseProduct(product);
    });
    win.add(buySingleItem);
}); 
```

一些注意事项：

```
Tested with iPad Simulator and iPhone 4S running 5.1.1
Module is called Ti.Storekit version 1.5 
Titanium SDK version is 2.1.1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T20:42:37.600

您无法在模拟器中使用 StoreKit 测试应用内购买：[请参阅此文档：](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/StoreKitGuide/DevelopingwithStoreKit/DevelopingwithStoreKit.html#//apple_ref/doc/uid/TP40008267-CH103-SW1)

> 注意：Store Kit 不能在 iOS 模拟器中运行。在 iOS 模拟器中运行您的应用程序时，如果您的应用程序尝试检索支付队列，Store Kit 会记录一个警告。必须在实际设备上测试商店。

另请参阅此[stackoverflow 问题](https://stackoverflow.com/questions/11558929/in-app-purchase-in-ios-suddenly-stop-working-error-code-5002-occurred)。

# ruby-on-rails - 通过rails连接表检索属性

> ID：11974349
> 
> 赞同：0
> 
> 时间：2012-08-15T17:45:36.563
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

我有 3 个模型：产品、标签和 products_tags：

标签型号：

```
class Tag < ActiveRecord::Base
        has_many :products, :through => :products_tags
        has_many :products_tags
end 
```

产品型号：

```
class Product < ActiveRecord::Base
  has_many :tags, :through => :products_tags
  has_many :products_tags
  accepts_nested_attributes_for :tags
  accepts_nested_attributes_for :products_tags 
```

加入：

```
class ProductsTag < ActiveRecord::Base
  belongs_to :product
  belongs_to :tag
end 
```

我需要一个查询，它将检索与标签和产品模型相关的属性，作为 AREL 对象。

例如：

我的标签表有 1 个字段：Cat_name 我的产品表有：标题、URL、Image_url。

如何将所有这些属性检索为 AREL 记录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T08:03:11.130

您可以使用

以下**加入关系**

```
 @producttag=Tag.find(:all,:joins => :Product ,:select => "*")

 @producttag 
```

包含您需要的内容

让我知道你的意见......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T19:33:34.980

你没有说明你想从哪里开始搜索来检索它，所以让我们来看看所有这些。

## 从标签开始

作为 ActiveRecord 对象的特定标签和关联产品：

```
Tag.find(params[:id], include: :products) 
```

特定标签和关联产品作为 arel 对象：

```
Tag.where(id: params[:id]).includes(:products) 
```

所有标签和相关产品作为 ActiveRecord 对象的数组：

```
Tag.includes(:products) 
```

所有标签和关联产品作为一个 arel 对象：

```
Tag.includes(:products).arel 
```

## 从产品开始

作为 ActiveRecord 对象的特定产品和关联标签：

```
Product.find(params[:id], include: :tags) 
```

特定产品和关联标签作为 arel 对象：

```
Product.where(id: params[:id]).includes(:tags) 
```

所有产品和相关标签作为 ActiveRecord 对象的数组：

```
Product.includes(:tags) 
```

所有产品和相关标签作为一个 arel 对象：

```
Product.includes(:tags).arel 
```

Rails 有一个[很好的指南](http://guides.rubyonrails.org/association_basics.html)，涵盖了多对多的关联和连接。

# iphone - 无法从 uiview 顶部的 webView 识别触摸

> ID：11974353
> 
> 赞同：0
> 
> 时间：2012-08-15T17:46:02.073
> 
> 标签：iphone, objective-c, ios, cocoa, ipad

目前我已经将 webview 子类化，并添加到另一个 uiview 之上。我试图调试 webview 的子类中的 touches 事件，或者将 webview 添加到 uiview 的另一个类，但显然，没有调用 touches 事件，除非我将 webview 设置为`[self.webView setUserInteractionEnabled:YES];`但是，这样做之后我无法滚动或获取任何触摸事件都可以工作。这里的任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T17:49:30.193

`UIWebView`在吃东西方面做得非常好..在这种情况下我所做的是使用透明`UIView`来覆盖`UIWebView`（如果WebView`userInteractionEnabled`关闭，也可以做一个底层。

只要您的`UIView`和`UIWebView`具有相同的框架，您应该能够从中获取触摸对象`UIView`并使用其坐标对您的`UIWebView`.

-D

# c# - WriteableBitmapEx GetPixel() 返回错误值

> ID：11974359
> 
> 赞同：3
> 
> 时间：2012-08-15T17:46:25.437
> 
> 标签：c#, silverlight, writeablebitmapex

我需要组合来自两个 WriteableBitmap 对象的两个颜色值并用它们计算一些东西。因此，我在第一个对象上运行 ForEach 循环并将其颜色值和第二个对象的颜色值解析为一个方法。

```
writeableBitmap.ForEach((x, y, color) => 
    MergePixelColor(color, mergedWriteableBitmap.GetPixel(x, y))); 
```

我直接从委托中获得第一个值，但要访问第二个颜色值，我使用 WriteableBitmap 扩展中的 GetPixel 方法。

这实际上应该像那样工作，但似乎 GetPixel 方法返回了错误的数据（颜色以某种方式错误地“黄色”或“红色”）。

我查了一下，发现下面的文章：

[http://forums.silverlight.net/t/250392.aspx/1?WriteableBitmap+GetPixel+](http://forums.silverlight.net/t/250392.aspx/1?WriteableBitmap+GetPixel+)

那里提到图像格式可能存在问题。我的问题是虽然我无法直接访问生成图像的点。我从网络服务中提取它们，我不知道是否可以调整该部分（至少不能从我这里）。

我现在的问题是，是否有任何其他方法或解决方法来解决此问题？你有什么想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T06:11:02.257

此解决方案可能只是一种解决方法，但我无法在给定的时间内想出更好的方法。我只是预先循环合并的WriteableBitmap并将其颜色值保存到字典中：

```
IDictionary<int, Color> mergedWriteableBitmapMapping = new Dictionary<int, Color>();
mergedWriteableBitmap.ForEach((x, y, color) =>
{
    int index = GetIndex(x, y, mergedWriteableBitmap.PixelWidth);
    mergedWriteableBitmapMapping.Add(index, color);
    return color;
}); 
```

之后我使用这个字典值将正确的颜色值解析为方法：

```
writeableBitmap.ForEach((x, y, color) => 
    MergePixelColor(color, mergedWriteableBitmapMapping[GetIndex(x, y, mergedWriteableBitmap.PixelWidth)])); 
```

# javascript - 从 iframe 访问某些值并在父页面 Javascript 中使用它

> ID：11974360
> 
> 赞同：0
> 
> 时间：2012-08-15T17:46:24.953
> 
> 标签：javascript

在我的 iframe 内，我有一个刻度盘，当针移动时会吐出角度。是否可以在 iframe 之外的父页面中的其他位置显示角度值，而不是在框架内同时获取表盘和针。这是我的代码。

```
function showIframeContent(id) {
  var iframe = document.getElementById(id);
    try {
      var doc = (iframe.contentDocument)? window.frames[clkwise1].document.getElementId("demo").value;
      alert(doc.body.innerHTML);
    }
    catch(e) {
       alert(e.message);
    }
  return false;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:05:47.870

访问 iframe 内容的标准和跨浏览器方法是：

```
iframe.contentWindow.document 
```

我希望这适用于您的情况：

```
document.getElementById("clkwise1").contentWindow.document.getElementById("demo").value 
```

（我需要查看页面本身来确认它 - 例如，我假设“demo”是一个输入元素。另外，请注意您在 getElementById 中的错字）

现场演示：http: [//jsfiddle.net/ZWC6v/](http://jsfiddle.net/ZWC6v/)

# javascript - javascript没有显示警报

> ID：11974362
> 
> 赞同：0
> 
> 时间：2012-08-15T17:46:33.330
> 
> 标签：javascript

此代码未向我显示警报：-

```
<script type="text/javascript">
var wloc = window.parent.location;
var abcd = wloc.substring(0,24);
alert(wloc);
alert(abcd);
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T17:52:36.487

确保您的脚本可以访问`parent`. 然后修改脚本如下

```
<script type="text/javascript">
window.onload = function(){
    var wloc = window.parent.location.href;
    var abcd = wloc.substring(0,24);
    alert(wloc);
    alert(abcd);
}
</script> 
```

对于当前窗口的位置，请尝试以下脚本

```
<script type="text/javascript">
window.onload = function(){
    var wloc = window.location.href;
    var abcd = wloc.substring(0,24);
    alert(wloc);
    alert(abcd);
}
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T17:48:12.270

`.href`之后添加`window.parent.location`：

```
<script type="text/javascript">
window.onload = function(){
    var wloc = window.parent.location.href;
    var abcd = wloc.substring(0,24);
    alert(wloc);
    alert(abcd);
}
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T17:51:59.160

下面的行给出错误。这就是为什么它没有显示警报。

```
var abcd = wloc.substring(0,24); 
```

改用这个

```
<script type="text/javascript">
  window.onload = function(){
    var wloc = window.parent.location.href;
    var abcd = wloc.substring(0,24);
    alert(wloc);
    alert(abcd);
 }
</script> 
```

# ruby - 是否有一个良好的 EC2 映像用于仅包括 ruby 但不包括 rails、mysql 等的微实例

> ID：11974367
> 
> 赞同：1
> 
> 时间：2012-08-15T17:47:17.473
> 
> 标签：ruby, amazon-ec2

我只想整理一些微实例并安装一些 gem。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T23:07:04.687

I recommend you just start an instance of a clean base AMI running the Linux distro of your preference from a trusted source. Then run the standard commands (e.g., apt-get, yum) to install the standard Ruby provided by the distro and go from there.

You don't need to find an AMI that has exactly the set of packages you want to run. Modern Linux makes it easy to install these cleanly.

With AMIs like the official Ubuntu or Amazon Linux you can even pass in a script as user-data and it will run it on first boot. You can use this to make sure that your desired packages and gems are installed when the instance runs.

# javascript - d3 进入/追加/退出/删除序列仅追加

> ID：11974369
> 
> 赞同：1
> 
> 时间：2012-08-15T17:47:23.923
> 
> 标签：javascript, d3.js

最初使用以下进入/追加/退出/删除顺序绘制一组矩形，没问题。当我传递不同的数据（旨在完全替换现有数据）时，新矩形将绘制在现有矩形之上。

我选择“lgnds”而不是 rect，因为我已经绘制了其他不想打扰的矩形。

`var svg = d3.select("#graph").append("svg")`

```
elements = svg
    .selectAll("lgnds")
    .data(data, function(d){return d;});

elements
    .enter()
    .append("rect")
    .attr("width", 15)
    .attr("height", rectHeight)
    .attr("x", 5)
    .attr("y", function (d,i){return ((i*rectHeight)+(gap*(i+1)));})
    .style("fill", function(d){ return d.color;});

elements
    .exit()
    .remove(); 
```

# c# - 在 C# 中实现模板方法模式

> ID：11974371
> 
> 赞同：6
> 
> 时间：2012-08-15T17:47:36.667
> 
> 标签：c#, design-patterns, template-method-pattern

*模板方法*模式规定抽象基类有一个不可覆盖的方法：这个方法实现了通用算法，不应该在子类中被覆盖。在 Java 中，模板方法`final`在抽象基类中声明，在 C# 中`sealed`关键字具有类似的含义，但不能声明未覆盖的方法`sealed`。

```
public abstract class Base
{
    protected abstract AlgorithmStep1();

    protected abstract AlgorithmStep2();

    public sealed void TemplateMethod()   // sealed: compile error
    {
        AlgorithmStep1();
        AlgorithmStep2();
    }
} 
```

我怎么解决这个问题？为什么不能阻止一个方法可以被子类覆盖（在 C# 中）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-15T17:50:44.667

该[`sealed`](http://msdn.microsoft.com/en-us/library/88c54tsw.aspx)修饰符仅对覆盖基类成员的函数成员有效，以阻止它们对派生类来说是虚拟的。默认情况下，函数成员在 C# 中是非虚拟的（与 Java 不同）。不过，您仍然需要*类*`sealed`的修饰符- 默认情况下，类不是密封的。

 *只需`sealed`从您的方法中删除修饰符就可以了。

有关密封方法的更多详细信息，请参阅 C# 4 规范的第 10.6.5 节（密封属性和事件分别在第 10.7.5 节和 10.8.4 节中）。

> 当实例方法声明包含`sealed`修饰符时，该方法称为密封方法。如果实例方法声明包含`sealed`修饰符，则它还必须包含`override`修饰符。使用`sealed`修饰符可防止派生类进一步覆盖该方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T17:50:53.050

只需删除`sealed`关键字。默认情况下，方法是不可覆盖的；子类不能覆盖它们，只能隐藏它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T17:51:08.477

C# 方法默认是密封的*

# c - 为什么要传递指向全局结构的指针？

> ID：11974372
> 
> 赞同：8
> 
> 时间：2012-08-15T17:47:38.757
> 
> 标签：c, pointers

这可能是一个愚蠢的问题，但我正在审查一些代码，我只是不明白这个人在做什么。在一个 C 文件中，他定义了一个具有多种类型的许多元素的全局结构。所以从函数“A”调用函数“B”。在调用中，他们传递了一个指向全局结构的指针，然后在函数“B”中完成了一些事情并更新了全局的一部分。现在这一切似乎都是多余的，因为它已经是全球性的了。如果结构是函数“A”的本地结构，我完全可以看到将结构的地址传递给函数“B”。但是，内存已在 C 文件的最顶部永久分配。

所以我确信有一个“良好的编码实践”BKM 或类似的东西可以做到这一点，但我只是看不到它。简而言之，当变量已经是全局变量时，为什么要创建地址指针并将其不必要地传递给函数？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-15T17:50:21.290

传递指针是好的风格，主要是因为全局变量是不好的风格。也许最初的开发人员正在考虑全局可能不是全局的可能性，或者接受它的函数可能对不同的变量进行操作（可能也可能不是全局的，但仍需要识别）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T19:11:12.943

Function B was most likely being written with an eye towards reusability, and for whatever reason was never actually re-used.

*Ideally*, functions should communicate with each other exclusively through parameters and return values (and exceptions, where supported), rather than sharing global data. This allows you to more easily re-use code in other programs where the global data variables are not present (or have different names).

If you're *really* squeezed for stack space, or have some other real technical limitation that makes using global data a significantly more attractive / less expensive option than passing arguments around, then globals are the right answer, but that should be *rare*.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T17:57:39.657

如果结构实例是全局的，并且两个代码文件可以访问它，那么显然这是一些不需要的编码。但可能存在前一个开发人员计划创建其他实例的情况，在这种情况下，他的功能可重用性受到了挑战。

在函数互通期间使用对结构的引用是一个很好的做法，但是如果未来没有大规模代码更改的计划，那么直接使用全局变量并不是一个坏主意。

# actionscript-3 - 简单的使用 uint 的奇怪行为

> ID：11974376
> 
> 赞同：0
> 
> 时间：2012-08-15T17:47:48.593
> 
> 标签：actionscript-3

这按预期工作：

```
for (var i:uint = 5; i >= 1; i-- ) 
{   
    trace(i);  // output is from 5~1, as expected
} 
```

* * *

这是奇怪的行为：

```
for (var i:uint = 5; i >= 0; i-- ) 
{   
    trace(i)
}

// output:
5
4
3
2
1
0
4294967295
4294967294
4294967293
... 
```

低于 0 时，会出现类似 MAX_INT 的内容，并且会一直递减。为什么会这样？

**编辑**

我使用 C++ 测试了一个类似的代码，带有一个 unsigned int，我得到了相同的结果。可能在递减后评估条件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T17:49:21.147

您描述的行为与任何编程语言都没有多大关系。对于 C、C++、actionscript 等来说都是如此。不过，让我这么说吧，您看到的是非常正常的行为，并且与数字的表示方式有关（请参阅 wiki 文章并阅读有关无符号整数的信息）。

因为您使用的是`uint`（[无符号整数](http://en.wikipedia.org/wiki/Integer_%28computer_science%29)）。只能是正数，您使用的类型不能表示负数，因此如果您采用这样的 uint：

`uint i = 0;`

你从上面减去 1

`i = i - 1;`

在这种情况下`i`不代表负数，因为它是无符号的。然后将显示一个数据类型`i`的最大值。`uint`

您在上面发布的编辑，

> “......在 C++ 中，......同样的结果......”

应该为您提供有关为什么会发生这种情况的线索，它与您使用的语言或比较何时完成无关。它与您使用的数据类型有关。

作为练习，再次启动该 C++ 程序并编写一个显示 a 最大值的程序`uint`。该程序不应该显示任何定义的常量:)..它也应该带你一行代码！

# entity-framework - EF 代码优先和数据库视图

> ID：11974384
> 
> 赞同：3
> 
> 时间：2012-08-15T17:48:30.173
> 
> 标签：entity-framework, ef-code-first

我刚刚开始使用 Code First 来查看数据库视图......并尝试决定是否应该使用它们。

[在这里](https://stackoverflow.com/a/10102679/1600894)，Ladislav 建议对表和 Db-View 使用 NotMapped 继承父级（我的视图只添加子实体的总和）......但这如何与 CF 迁移一起使用？我真的很想使用它们。

另外...导航属性可以在 Db-View 实体上使用吗？

有没有办法将数据直接保存到 Db-View 实体（和它的表）中？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-15T17:58:50.463

如果您想首先使用代码和迁移，则不应使用视图。视图是数据库“逻辑”结构，代码优先不是创建数据库逻辑的方法。首先使用代码，您应该使用链接答案中也提到的投影。

迁移将无法检测与您的视图相关的更改。您必须手动为视图编写所有迁移代码。

如果您想使用视图，您应该首先执行数据库（= 不迁移），然后使用 EDMX 或代码映射来映射它们。

> 另外...导航属性可以在 Db-View 实体上使用吗？

这是代码映射提供比 EDMX 更好的支持的唯一场景。即使数据库中不存在关系，您也可以在模型中定义关系（但您的数据库必须确保数据完整性）。理论上 EDMX 也可以，但需要手动更改 EDMX。

> 有没有办法将数据直接保存到 Db-View 实体（和它的表）中？

是的，但您的视图必须是可更新的。我不认为具有聚合值的视图是可更新的。

# c - 套接字错误 10047

> ID：11974389
> 
> 赞同：1
> 
> 时间：2012-08-15T17:48:46.167
> 
> 标签：c, sockets

所以我真的被困在这里，只是试图制作一个简单的 C 程序，将网页的内容放入缓冲区，但我遇到了一些问题；考虑以下：

```
WORD wVersionRequested;
WSADATA wsaData;
int err;

wVersionRequested = MAKEWORD( 2, 2 );
err = WSAStartup( wVersionRequested, &wsaData );
if(err != 0)
{
    printf("could not find a usable winsock.dll");
    return NULL;
}
if(LOBYTE(wsaData.wVersion) != 2 || HIBYTE(wsaData.wVersion) != 2) 
{
    printf("could not find a usable winsock.dll");
    WSACleanup();
    return NULL;
}
SOCKET sock = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);
struct sockaddr_in sa = { 0 };
sa.sin_port = htons(port);
sa.sin_addr.s_addr = inet_addr(ip);
connect(sock, (struct sockaddr*)&sa, sizeof(sa)); 
```

变量`ip`和`port`是从 main 传递的。正如你在这里看到的：

```
readsite("http://www.pagetutor.com/html_tutor/index.html", "68.71.137.60", 80); 
```

`printf("\n%d", GetLastError());`我从该行的正下方执行得到错误代码“10047”，`connect(sock, (struct sockaddr*)&sa, sizeof(sa));`根据微软的这个代码意味着“指定系列中的地址不能与这个套接字一起使用”所以我完全不知道从这里做什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T17:51:04.070

你没有设置`sin_family`所以它设置为`AF_UNSPEC`（因为你 0-initialized `sa`）。在连接之前，请尝试：

```
sa.sin_family = AF_INET; 
```

# python - 导入错误 - 发生了什么？

> ID：11974395
> 
> 赞同：2
> 
> 时间：2012-08-15T17:49:21.153
> 
> 标签：python, python-3.x

Python 导入。再次...

我有这个文件结构：

```
[test]
    start.py (from scripts import main)
    [scripts]
        __init__.py (empty)
        main.py (from . import install)
        install.py (from scripts import main # or # from . import main) 
```

我收到导入错误：

```
vic@wic:~/projects/test$ python3 start.py 
Traceback (most recent call last):
  File "start.py", line 2, in <module>
    from scripts import main
  File "/home/vic/projects/test/scripts/main.py", line 1, in <module>
    from . import install
  File "/home/vic/projects/test/scripts/install.py", line 1, in <module>
    from scripts import main
ImportError: cannot import name main
vic@wic:~/projects/test$ 
```

我不明白：第一次`from scripts import main`工作（通过“工作”我的意思是它没有失败`ImportError`），第二次相同的代码给出`ImportError: cannot import name main`

到底是怎么回事？

更新：

我的问题与循环进口无关。我对完全相同的代码`from scripts import main`第一次工作正常，然后第二次失败这一事实感到困惑。

我想有一些我不明白的内部导入机制。

第一次语句导入模块，第二次完全相同的代码尝试从模块导入名称。这是如何工作的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T17:52:57.593

您创建了循环导入。你不能那样做。避免`main`从`install`.

发生的情况是模块在导入时是不完整的，直到整个顶层都已执行。如果在执行期间它导入另一个模块（直接或间接）尝试再次导入原始模块，这将失败。原始模块尚未完成导入。

换句话说，您正在创建一个圆形图：

```
start -> scripts.main -> scripts.install
              ^                |
              |                |
               ---------------- 
```

您需要重新安排您的代码，以便不需要`main`从您的`scripts`包中导入。

请参阅[在模块中使用 import 的“最佳实践”是什么？](http://docs.python.org/faq/programming.html#what-are-the-best-practices-for-using-import-in-a-module)有关如何处理此问题的一些提示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T18:10:44.960

`main`进口`install`和`install`进口`main`：

*   `from scripts import main`在`start.py`导致
*   `from . import install`在`main.py` 导致
*   `from scripts import main`in——`install.py`循环导入

要解决循环导入问题，要么合并`main`到`install`一个模块中，要么创建两个模块都可以导入的第三个模块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T18:03:15.410

这应该有效：

开始.py：

```
from scripts import main 
```

脚本/main.py：

```
import install 
```

脚本/安装.py：

```
import main 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-03T09:45:15.350

这是我用来覆盖默认行为的补丁：

```
import sys
import builtins
import importlib

def _import(name, globals=None, locals=None, fromlist=None, level=0, __import__=__import__):
    """A hack to to make names of imported modules to be available in the parent package before
    they are fully imported. If a module is present in sys.modules event if it's not fully
    imported, it should not be a problem.
    I.e. ``from package import module1, module2`` will create variables ``package.module1`` and
    ``package.module2`` at start of the import, not when it's finished.
    This helps in some situations with circular import.
    """
    module = __import__(name, globals, locals, fromlist, level)
    for attr in fromlist or ():
        sub_module = sys.modules.get(module.__name__ + '.' + attr)
        if sub_module:  # is this a module?
            # if subpackage is already being imported, even if not finished,
            # inject its name into the parent package
            setattr(module, attr, sub_module)
    return module

builtins.__import__ = _import 
```

这是一个测试这个的项目：[https ://github.com/warvariuc/python_import_improver](https://github.com/warvariuc/python_import_improver)

# html - HTML5 标记化有多少种标记类型？

> ID：11974398
> 
> 赞同：3
> 
> 时间：2012-08-15T17:49:31.443
> 
> 标签：html, html-parsing, token, tokenize

我正在学习 HTML 解析。在标记化阶段，字节流被标记化为标记。标准 HTML 标记化支持多少种标记类型？它是否包括诸如开始标签令牌、评论令牌之类的东西？

评论是否会被视为令牌并附加到 DOM 树上？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T17:58:47.487

[HTML 规范说：](http://www.whatwg.org/specs/web-apps/current-work/multipage/tokenization.html)

> 标记化步骤的输出是一系列零个或多个以下标记：DOCTYPE、开始标记、结束标记、注释、字符、文件结尾。

所以有六种不同的令牌。

回答你的最后一个问题：评论是令牌，并且有一个[DOM 接口](http://dvcs.w3.org/hg/domcore/raw-file/tip/Overview.html#interface-comment)。

# mysql - 查询以获取存在于一个表中但不在另一个表中的记录

> ID：11974400
> 
> 赞同：2
> 
> 时间：2012-08-15T17:49:36.440
> 
> 标签：mysql, sql, left-join, exists

我有两张桌子：teacher_lm 和teacher。这些表都有“teacher_email”列

我需要的是获取teacher_lm 中存在但teacher 中没有的电子邮件。

我有两种不同的方法来解决这个问题，但我不明白为什么其中一种没有给出任何结果而另一种返回很多行。

第一个：842行

```
SELECT   DISTINCT lm.teacher_email
FROM       teacher_lm as lm
WHERE      NOT EXISTS (SELECT  * FROM teacher as lt
       WHERE lt.teacher_email = lm.teacher_email         
      ) 
```

第二个：没有结果

```
SELECT DISTINCT lm.teacher_email FROM
teacher_lm AS lm
WHERE lm.teacher_email NOT IN
(SELECT lt.teacher_email FROM 
teacher AS lt) 
```

你能告诉我我在这里做错了什么，最好的方法是什么？

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T17:52:17.927

“in”子查询中可能有一个 NULL。

试试这个：

```
SELECT DISTINCT lm.teacher_email
FROM teacher_lm AS lm
WHERE lm.teacher_email NOT IN (SELECT coalesce(lt.teacher_email, '')
                               FROM  teacher AS lt) 
```

顺便说一句，我认为第一个版本是 mysql 出于优化原因推荐的版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T17:58:45.787

您的第一个查询正在处理整行的存在。

第二个查询可能返回空值。我不相信 NOT IN 子句在存在空值的情况下效果很好。

戈登的回答通过用空字符串替换空值来纠正这个问题。

# java - 如何仅在检查某些条件后调用日志构造函数？

> ID：11974407
> 
> 赞同：0
> 
> 时间：2012-08-15T17:50:00.273
> 
> 标签：java, logging, log4j

我正在使用 RollingFileAppender 编写日志。RollingFileAppender 的构造函数在我的应用程序启动后立即被调用。但我不希望它在应用程序重新启动时发生，我需要检查数据库中的一些标志，如果它设置为某个特定值，则只启动此日志记录，否则不启动。那么如何处理这种情况呢？

# javascript - 什么 javascript prototype.constructor 用于？

> ID：11974408
> 
> 赞同：1
> 
> 时间：2012-08-15T17:50:02.197
> 
> 标签：javascript, constructor, prototype

> **可能重复：**
> [JavaScript .prototype 是如何工作的？](https://stackoverflow.com/questions/572897/how-does-javascript-prototype-work)

这是我为测试设置的继承结构：

```
function A() {
    this.a = 1;
}

function B() {
    this.b = 2;
}

B.prototype = new A();
//B.prototype.constructor = B; 
```

以下是我在 Chrome 的 JavaScript 控制台中尝试的内容：

```
>var b = new B;
>b instanceof A
true

>B.prototype.constructor
function A() {
    this.a = 1;
} 
```

我的问题是设置 B.prototype.constructor = B 的目的是什么？我已经注释掉了哪个？它似乎没有破坏继承。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:04:51.573

`B.prototype.constructor = B`结果`instanceof`'给出了预期的结果，但有更好的方法来做到这一点。在以下位置对此进行了一些讨论：[JavaScript 中的原型继承约定](https://stackoverflow.com/questions/402538/convention-for-prototype-inheritance-in-javascript/402919#402919)

# java - 需要Java代码片段输出说明

> ID：11974428
> 
> 赞同：17
> 
> 时间：2012-08-15T17:51:16.997
> 
> 标签：java, inheritance, polymorphism

我的代码是：

```
class Foo {
  public int a=3;
  public void addFive() {
    a+=5;
    System.out.print("f ");
  }
}

class Bar extends Foo {
  public int a=8;
  public void addFive() {
    this.a += 5;
    System.out.print("b ");
  }
}

public class TestClass {
  public static void main(String[]args) {
    Foo f = new Bar();
    f.addFive();
    System.out.println(f.a);
  }
} 
```

输出：

```
b 3 
```

请向我解释，为什么这个问题的输出是“b 3”而不是“b 13”，因为该方法已被覆盖？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-15T17:54:09.907

`F`是 type 的引用`Foo`，并且变量不是多态的，因此`f.a`指的是来自的`Foo`变量`3`

**如何验证？**

要对此进行测试，您可以从中删除`a`变量 `Foo`，它会给您编译时错误

**注意：**制作成员变量`private`并使用访问器访问它们

* * *

**另见**

*   [为什么要使用 getter 和 setter？](https://stackoverflow.com/questions/1568091/why-use-getters-and-setters)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-08-15T17:56:33.757

您不能覆盖 Java 中的变量，因此您实际上有两个`a`变量 - 一个 in`Foo`和一个 in `Bar`。另一方面`addFive()`，方法是多态的，因此它修改了`Bar.a`（`Bar.addFive()`被调用，尽管是静态类型`f`）`Foo`。

但最终您访问`f.a`并在编译期间使用已知类型解析此引用`f`，即`Foo`. 因此`Foo.a`从未被触及。

顺便说一句，Java 中的非最终变量**永远不**应该公开。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-08-15T19:19:11.333

有了这样一个问题，SCJP 考试将评估您对所谓的*隐藏*知识的了解。考官故意把事情复杂化，试图让你相信程序的行为只取决于多态性，而事实并非如此。

`addFive()`当我们删除该方法时，让我们试着让事情变得更清楚一些。

```
class Foo {
  public int a = 3;
}

class Bar extends Foo {
  public int a = 8;
}

public class TestClass {
  public static void main(String[]args) {
    Foo f = new Bar();
    System.out.println(f.a);
  }
} 
```

现在事情变得不那么令人困惑了。该`main`方法声明了一个类型的变量，在运行时`Foo`为其分配了一个类型的对象。`Bar`这是可能的，因为`Bar`继承自`Foo`. 程序然后引用`a`类型变量的公共字段`Foo`。

**这里的错误是相信被称为*覆盖*的同一种概念适用于类字段。**但是字段没有这样的概念：类的公共字段`a`并`Bar`没有*覆盖*类的公共字段`a`，`Foo`但它做了所谓的*隐藏*。顾名思义，就是在类的范围内`Bar`，`a`会引用`Bar`自己的字段，与自己的字段无关`Foo`。（[JLS 8.4.8 - 继承、覆盖和隐藏](http://docs.oracle.com/javase/specs/jls/se7/jls7.pdf)）

那么，当我们写作`f.a`时，`a`我们指的是哪个？回想一下，字段的解析`a`是在**编译时**使用对象的声明类型完成的`f`，即`Foo`. 结果，程序打印“3”。

现在，让我们在类中添加一个`addFive()`方法并在类中`Foo`覆盖它，`Bar`就像在考试问题中一样。这里应用了多态性，因此调用`f.addFive()`不是使用编译时间而是使用 object 的运行时类型来解决的`f`，即`Bar`，因此打印为'b'。

但是还有一点我们必须明白：为什么`a`增加了 5 个单位的 field 仍然坚持值 '3'？在这里*躲起来*玩。因为 this 是`Bar`被调用的 class 的方法，并且因为在 class 中`Bar`，every`a`指`Bar`的是 的 public 字段`a`，所以 this 实际上`Bar`是递增的字段。

**1）现在，一个附属问题：**我们如何从方法中访问`Bar`'s public 字段？我们可以这样做：`a``main`

```
System.out.println( ((Bar)f).a ); 
```

这会强制编译器解析as字段`a`的字段成员。`f``Bar``a`

**这将在我们的示例中打印“b 13”**。

**2）还有一个问题：**我们如何才能绕过*隐藏*在`addFive()`类的方法中`Bar`而不是指代`Bar`'`a`领域，而是指代它的超类同名领域？只需`super`在字段引用前添加关键字即可：

```
public void addFive() {
  super.a += 5;
  System.out.print("b ");
} 
```

**这将在我们的示例中打印 'b 8'**。

注意初始语句

```
public void addFive() {
  this.a += 5;
  System.out.print("b ");
} 
```

可以细化为

```
public void addFive() {
  a += 5;
  System.out.print("b ");
} 
```

因为当编译器解析字段`a`时，它会从方法内部开始查找最近的封闭范围`addFive()`，并找到`Bar`类实例，从而无需显式使用`this`。

但是，好吧，`this`可能是考生解决这个考试问题的线索！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-15T18:37:40.413

既然你在做`f.a`，你就会`a`从 class中获得价值`Foo`。如果您调用了一个方法来获取值，例如，`getA()`那么您将从类中获取值`Bar`。

# c# - Javascript 错误：消息：应为 ')'

> ID：11974431
> 
> 赞同：2
> 
> 时间：2012-08-15T17:51:23.687
> 
> 标签：c#, javascript, asp.net

我在下面收到一个 javascript 错误，但我似乎找不到问题所在：

*消息：预期 ')' 行：431 字符：220 代码：0

```
URI: http://mywebsite/CustomerLogin.aspx* 
```

第 431 行是这个 javascript 行：

```
<script language='Javascript'>
    var varDateNow = new Date();
    var varTimeNow = varDateNow.getTime();
    var varAlertTime = document.getElementById('cphTopContent_AlertTime').value;
    if(varTimeNow - varAlertTime < 1500)
        {alert('2' values you entered were not valid:\n\nLog In -  This value requires at least 6 characters. \nPassword -  This value requires at least 4 characters. \n');}
</script> 
```

是什么导致了javascript错误？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-15T17:53:09.067

您缺少未结报价。`2`尝试在警报中取出关闭报价。以下是幕后发生的事情：由于您在 2 之后关闭了引号，因此您实际上在 .之后的行尾*打开*`\n`了一组新引号。因此，编译器将该点之后的所有内容解释为字符串，因此它永远不会找到右括号。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-15T17:53:09.503

```
<script language='Javascript'>
    var varDateNow = new Date();
    var varTimeNow = varDateNow.getTime();
    var varAlertTime = document.getElementById('cphTopContent_AlertTime').value;
    if(varTimeNow - varAlertTime < 1500)
        {alert('2 values you entered were not valid:\n\nLog In -  This value requires at least 6 characters. \nPassword -  This value requires at least 4 characters. \n');}
</script> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-15T17:54:42.723

```
{alert('2' values you entered were not valid:\n\nLog In -  This value requires at least 6 characters. \nPassword -  This value requires at least 4 characters. \n');} 
```

应该

```
{ alert("2 values you entered were not valid:\n\nLog In -  This valid requires at least 6 characters.\nPassword -  This value requires at least 4 charactersn\n"); } 
```

你搞砸了几个引号，所以应该结束 alert() 的括号实际上是一个字符串。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-15T17:53:51.200

警报消息必须是字符串。因此，在“2”之后，它只是不明白你想对所有字符和东西做什么。

```
alert("blah blah '2' more blah and blah " + variableSomething + "finalBlah"); 
```

# php - Javascript php onclick

> ID：11974436
> 
> 赞同：-1
> 
> 时间：2012-08-15T17:51:47.333
> 
> 标签：php, javascript, html

嘿伙计们，我正在尝试制作一个将执行 php 代码的 javscript 函数。这就是我认为应该起作用的东西。

```
<script type="text/javascript">
function doit()
{

  $.get("dumplings.php");
    return false; } 

</script> 
```

Dumplings.php 包含这个

```
<?php 
$format = '<OBJECT style="z-index:2; position:absolute; top:20%; left:44%;" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" WIDTH="320" HEIGHT="240" id="rice" ALIGN="">
<PARAM NAME=movie VALUE="rice.swf"> <PARAM NAME=quality VALUE=high> <PARAM NAME=bgcolor VALUE=#333399> <EMBED src="rice.swf" quality=high bgcolor=#333399 WIDTH="320" HEIGHT="240" NAME="rice" ALIGN="" TYPE="application/x-shockwave-flash" PLUGINSPAGE="http://www.macromedia.com/go/getflashplayer"></EMBED> </OBJECT>';
echo $format;
?> 
```

这是我的单选按钮：

```
<input name="sample_check3" id="sample_check3" value="1" type="radio" onclick="doit();"/> 
```

基本上，它什么也不做。知道为什么它不起作用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T17:55:17.080

它可能会做一些事情，但是当您使用 php 代码获取页面时，您对结果什么也不做

试着把它改成这样

```
$.get("dumplings.php", function (data){
  $('body').append(data);
}); 
```

数据将包含来自您的 php 页面的数据。在这个例子中，我只是将它添加到正文中。但你可以用它做任何事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-07T12:19:10.063

您必须在您的页面元素之一上使用 $.get (

> `<span>,<div>,<p>`

) 单选按钮后添加

```
<div id="loadobjecthere"></div> 
```

并将脚本更改为

```
<script type="text/javascript">
function doit()
{    
  $("#loadobjecthere").get("dumplings.php");
    return false;
}    
</script> 
```

也尝试将 onclick 属性更改为

```
"javascript:return doit();" 
```

# javascript - JQuery将Div值的百分比添加到另一个

> ID：11974438
> 
> 赞同：2
> 
> 时间：2012-08-15T17:51:58.877
> 
> 标签：javascript, jquery

使用 JQuery，我试图设置一个 div 的 id 值的百分比并将其写入另一个 div。

这是我当前的代码...

```
 $("#percentage").text(
    parseFloat($("#total").text(percentage calculation here?))
    ); 
```

因此，如果 #capacity 的值为 100，而 #total 的值为 10，那么 #percentage 的值将是 10

我怎样才能得到这个结果？

希望这是有道理的

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T17:54:06.267

```
$("#percentage").text(function() {
    var result = (parseInt($("#capacity").text(), 10) / parseInt($("#total").text(), 10));
    if (!isFinite(result)) result = 0;
    return result;
});​ 
```

[**小提琴**](http://jsfiddle.net/baVVf/1/)

# c# - 在 EF5 Code First 中更改列默认值

> ID：11974439
> 
> 赞同：11
> 
> 时间：2012-08-15T17:52:02.727
> 
> 标签：c#, entity-framework-5, entity-framework-migrations

我正在尝试使用 CF 为现有数据库构建模型。我有一列忘记设置合理的默认值。而不是通过更改初始迁移的纯度来妥协，我只是想我会创建另一个迁移（这就是迁移的目的，对吧？:)

```
public override void Up()
{
    AlterColumn("Config", "DefaultTaxPerDollar", c => c.Decimal(nullable: false, precision: 19, scale: 5, defaultValue: 0.087m));
}

public override void Down()
{
    AlterColumn("Config", "DefaultTaxPerDollar", c => c.Decimal(nullable: false, precision: 19, scale: 5, defaultValue: 0.0m));

} 
```

但这会`Column already has a DEFAULT bound to it.`从 SQL Server 产生错误。

如何使用 CF 迁移更改默认值？或者，如何简单地删除默认值（然后用不同的值重新创建它）？

**编辑：**

下面是生成的 SQL：

```
ALTER TABLE [Config] ADD CONSTRAINT DF_DefaultTaxPerDollar DEFAULT 0.087 FOR [DefaultTaxPerDollar]
ALTER TABLE [Config] ALTER COLUMN [DefaultTaxPerDollar] [decimal](19, 5) NOT NULL 
```

我想我可能已经找到了一个解决方案，使用受[这篇](http://thisisnotcnn.blogspot.com/2011/03/get-default-constraint-name-for.html)`Sql()`文章启发的一些复杂 SQL 的方法。问题源于 SQL Server 使用约束来实现默认值（哦！我多么想念 MySQL！）并为约束生成名称。因此，Code First 团队不能简单地更改或删除/重新创建默认值。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-07T17:59:13.957

删除受 SQL Server 实体框架生成的反向迁移启发的默认约束

```
 public static void DropDefaultConstraint(string tableName, string columnName, Action<string> executeSQL)
    {
        string constraintVariableName = string.Format("@constraint_{0}", Guid.NewGuid().ToString("N"));

        string sql = string.Format(@"
            DECLARE {0} nvarchar(128)
            SELECT {0} = name
            FROM sys.default_constraints
            WHERE parent_object_id = object_id(N'{1}')
            AND col_name(parent_object_id, parent_column_id) = '{2}';
            IF {0} IS NOT NULL
                EXECUTE('ALTER TABLE {1} DROP CONSTRAINT ' + {0})",
            constraintVariableName,
            tableName,
            columnName);

        executeSQL(sql);
    } 
```

它稍微短一些，但用法是一样的。

```
DropDefaultConstraint(TableName, "DefaultTaxPerDollar", q => Sql(q)); 
```

Guid 用于创建一个唯一的变量名称，以防您要在一次迁移中删除多个约束。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-15T23:57:06.023

这是一个受[这篇文章](http://thisisnotcnn.blogspot.com/2011/03/get-default-constraint-name-for.html)启发的解决方案。这不完全是一种优雅的方法，但它对我有用。

```
 public static void DropDefaultConstraint(string tableName, string columnName, Action executeSQL)
        {
            // Execute query that drops the UDF that finds the default constraint name
            var query = @"
                    -- recreate UDF 
                    if object_id('[dbo].[GetDefaultConstraintName]') is not null
                    begin 
                        drop function [dbo].[GetDefaultConstraintName]
                    end
                ";
            executeSQL(query);

            // Execute query that (re)creates UDF that finds the default constraint name
            query = @"
                    create function [dbo].[GetDefaultConstraintName] (
                        @TableName varchar(max),
                        @ColumnName varchar(max))
                    returns varchar(max)
                    as
                    begin
                        -- Returns the name of the default constraint for a column

                        declare @Command varchar(max)
                        select
                            @Command = d.name
                        from
                            ((
                            sys.tables t join
                            sys.default_constraints d
                                on
                                    d.parent_object_id = t.object_id) join
                            sys.columns c
                                on
                                    c.object_id = t.object_id and
                                    c.column_id = d.parent_column_id)
                        where
                            t.name = @TableName and
                            c.name = @ColumnName
                        return @Command
                    end
                ";
            executeSQL(query);

            // Execute query that actually drops the constraint
            query = string.Format(@"
                    -- Use UDF to find constraint name
                    DECLARE @Constraint_Name VARCHAR(100)
                    SET @Constraint_Name = [dbo].GetDefaultConstraintName('{0}','{1}')

                    if LEN(@Constraint_Name) > 0 
                    BEGIN
                        DECLARE @query VARCHAR(300)
                        SET @query = 'ALTER TABLE {0} DROP CONSTRAINT ' + @Constraint_Name

                        execute(@query)
                    END", tableName, columnName);
            executeSQL(query);
        } 
```

在您的迁移中，您可以这样称呼它：

```
DropDefaultConstraint(TableName, "DefaultTaxPerDollar", q => Sql(q)); 
```

使用 lamba 的原因是因为您必须对`Sql()`. 我永远无法让它作为一个长查询工作 -`GO`在许多不同的地方尝试了许多关键字组合。我还尝试反转第一个查询的逻辑，以便仅在 UDF 不存在时才重新创建它，并且它不起作用。无论如何，我想每次都重新创建它会更强大。

# python - Wxpython：如何将windows os的键盘事件直接与Application绑定

> ID：11974442
> 
> 赞同：0
> 
> 时间：2012-08-15T17:52:09.317
> 
> 标签：python, python-3.x, wxpython

我在**Wxpython**中设计了一个带有 GUI 的 python**文件复制软件**。现在我想将 Windows 标准键盘事件**“CTRL+V”**绑定到我的应用程序，这样当任何用户按下“CTRL+V”时，我的应用程序就会自动将该文件复制到它的目的地。

 ***** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:20:38.350

使用加速器表

```
def OnPaste(evt):
    pass #do something

pasteID = wx.NewId()
aTable = wx.AcceleratorTable([(wx.ACCEL_CTRL,  ord('V'), pasteID ),])
my_main_frame.SetAcceleratorTable(aTable)
my_main_frame.Bind(wx.EVT_MENU,OnPaste,pasteID ) 
```****

# c# - 无法通过将 xml 字符串转换为流来验证 xml

> ID：11974459
> 
> 赞同：-1
> 
> 时间：2012-08-15T17:53:41.077
> 
> 标签：c#, xml, xsd

![我找不到确切的异常，调试时，我只能找到这个信息](../Images/4560cfcd089cde819a131d202793f931.png)我通过 Web 服务以字符串格式获取 xml 并通过 xmlreader，我将字符串转换为流对象。但无法弄清楚我错过了什么。这里提到的 xml 和 schema 是一个示例。

```
class Program
{
    static void Main(string[] args)
    {
        try
        {

            XmlDocument doc = new XmlDocument();

            doc.Load("books.xml");
            StringWriter sw = new StringWriter();
            XmlTextWriter tx = new XmlTextWriter(sw);
            doc.WriteTo(tx);
            string leadxml = sw.ToString();

            XmlReaderSettings xmlSettings = new XmlReaderSettings();
            xmlSettings.Schemas = new System.Xml.Schema.XmlSchemaSet();
            xmlSettings.Schemas.Add(string.Empty,"books.xsd");
            xmlSettings.ValidationType = ValidationType.Schema;
            byte[] byteArray = Encoding.ASCII.GetBytes(leadxml);
            MemoryStream stream = new MemoryStream(byteArray);
            XmlReader reader = XmlReader.Create(stream, xmlSettings);

            // Parse the file.
            while (reader.Read());

        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);

        }
    }

} 
```

xml 是：

```
 <?xml version="1.0" encoding="utf-8" ?>
<bookstore>
  <book genre="autobiography" publicationdate="1981-03-22" ISBN="1-861003-11-0"/>
</bookstore> 
```

xsd 是：

```
 <?xml version="1.0" encoding="utf-8"?>
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="bookstore">
    <xs:complexType>
      <xs:sequence>
        <xs:element maxOccurs="unbounded" name="book">

        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:55:58.563

`StringWriter`默认情况下采用 UTF-16 编码，这意味着您将获得一个包含 UTF-16 的 XML 声明。然后，您将使用`Encoding.ASCII`获取二进制表示，这与 UTF-16 声明不兼容。

老实说，你并不清楚你为什么要这样做——几乎可以肯定有更好的方法来实现你的目标，但我们不能真正说出你的目标*是*什么，所以我们不能建议那是什么更好的方法可能是。

编辑：例如，这*可能*是你真正追求的：

```
XmlReaderSettings xmlSettings = new XmlReaderSettings
{
    Schemas = { { "", "books.xsd" } },
    ValidationType = ValidationType.Schema
}
using (var reader = XmlReader.Create("books.xml", xmlSettings))
{
    while (reader.Read()) {}
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T18:33:22.847

首先，如果您所做的只是将 Xml 转换为字符串，那么整个代码块是不必要的：

```
 XmlDocument doc = new XmlDocument();
          doc.Load("books.xml");
          StringWriter sw = new StringWriter();
          XmlTextWriter tx = new XmlTextWriter(sw);
          doc.WriteTo(tx);
          string leadxml = sw.ToString(); 
```

相反，只需执行以下操作：

```
 string leadxml = File.ReadAllText("books.xml"); 
```

其次，如果您已经有一个字符串，则完全没有必要对字符串进行所有这些转换。XmlReader.Create 方法具有接受 TextReader 的签名。StringReader 派生自 TextReader。因此，这：

```
 byte[] byteArray = Encoding.ASCII.GetBytes(leadxml);
             MemoryStream stream = new MemoryStream(byteArray);
             XmlReader reader = XmlReader.Create(stream, xmlSettings); 
```

可以用这个代替：

```
 StringReader leadxmlStringReader = new StringReader(leadXml);
             XmlReader reader = XmlReader.Create(leadxmlStringReader, xmlSettings); 
```

有关此问题的任何进一步帮助，您将需要提供异常详细信息和/或特定错误消息。

# java - 一个窗口上的多个 JFreeCharts

> ID：11974463
> 
> 赞同：1
> 
> 时间：2012-08-15T17:53:58.240
> 
> 标签：java, swing, jfreechart

我正在尝试在单个窗口中显示多个 jfreecharts。显然，这对于包含的 ChartFrame 是不可能的，所以我尝试将同一个图表的多个副本添加到一个不起作用的 JFrame。有任何想法吗？

```
JFrame frame = new JFrame("Chart");
frame.getContentPane().add(new ChartPanel(chart1));
frame.getContentPane().add(new ChartPanel(chart2));
frame.pack();
frame.setVisible(true); 
```

使用此代码，我只能在 JFrame 中获得一个图表。

编辑：我添加了另一个数据集和图表，但它仍然只显示其中一个。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T18:35:18.747

您的问题的原因是`frame.getContentPane()`. `JFrame`内容窗格的默认布局- `BorderLayout`。阅读更多关于`BorderLayout` [这里](http://docs.oracle.com/javase/7/docs/api/java/awt/BorderLayout.html)。这个操作

```
frame.getContentPane().add(new ChartPanel(chart)); 
```

等于

```
frame.getContentPane().add(new ChartPanel(chart), BorderLayout.CENTER); 
```

并添加`ChartPanel`到内容窗格的 CENTER 区域。其次`ChartPanel`，您也添加到 CENTER 区域。然后将两个组件添加到同一区域，最后一个添加的组件隐藏了之前添加的所有组件。因此第二个 ChartPanel 隐藏了第一个。

您需要更改布局`frame.getContentPane()`。

你可以用同一张图来两张`ChartPanel`。尝试将您的代码更改为

```
JFrame frame = new JFrame("Chart");
frame.getContentPane().add(new ChartPanel(chart), BorderLayout.WEST);
frame.getContentPane().add(new ChartPanel(chart), BorderLayout.EAST);
frame.pack();
frame.setVisible(true); 
```

它不是生产代码。`ChartPanel`它只是在框架上显示两个的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T18:05:55.717

您需要有不同的图表实例。如果您使用相同的引用，将显示添加到 ChartPanel 的最后一个引用。

# jqgrid - jqGrid如何在不调用loadComplete的情况下删除所有行

> ID：11974464
> 
> 赞同：0
> 
> 时间：2012-08-15T17:53:59.043
> 
> 标签：jqgrid

有没有办法删除 jqGrid 中的所有行，而不调用 jqgrid 的 loadComplete 方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T18:13:37.847

您可以使用[`clearGridData`](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3amethods). 从 jqGrid 文档：

> 从网格中清除当前加载的数据。如果 clearfooter 参数设置为 true，则该方法会清除放置在页脚行上的数据。

对代码的快速检查似乎可以确认该方法没有调用`loadComplete`，尽管它会调用`gridComplete`。

# backbone.js - Backbone JS 如何将新模型添加到视图以自动重新渲染模板

> ID：11974470
> 
> 赞同：0
> 
> 时间：2012-08-15T17:54:38.407
> 
> 标签：backbone.js, backbone-views

我想将新模型附加到视图并重新渲染视图。我能够首先渲染视图，但是我无法将该视图中的数据更改为新模型。

```
my_model_1 = Backbone.Model.extend({});
my_model_2 = Backbone.Model.extend({});

my_view = Backbone.View.extend({
    initialize : function() {
        _.bindAll(this, 'render');
        this.model.bind('change', this.render);
    },

    render : function(){

    }
});

var view_instance = new my_view({ model: my_model_1 });

//Template gets rendered

try{
    view_instance.changeModel(my_model_2);
}catch(e){console.log(e)};
try{
    view_instance.set(my_model_2);
}catch(e){console.log(e)};
try{
    view_instance.fetch(my_model_2);
}catch(e){console.log(e)};
try{
    view_instance.model = my_model_2;
}catch(e){console.log(e)};  

//Template should get updated with data from model 2 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:02:20.963

`change`如果在模型中的数据发生更改时触发该事件，在您的情况下，您的视图不会“重新更新”，因为它的模型的数据没有改变，而您只是切换了模型。您可以做的是在切换视图模型或调用它的方法后手动[触发](http://documentcloud.github.com/backbone/#Model-change)更改事件`render`

例如

```
view_instance.model = my_model_2;
my_model_2.change(); 
```

# jquery - 根据绝对定位的子 IMG 的高度设置 DIV 高度

> ID：11974472
> 
> 赞同：0
> 
> 时间：2012-08-15T17:54:41.450
> 
> 标签：jquery, css, css-position

我有一个相对定位的 div，其中包含许多绝对定位的图像。div 和图像都设置为 100% 的宽度以填充布局（这是流动的），但我需要能够设置父 DIV 的高度，以便它显示整个图像。

我尝试了类似于[CSS 的方法 - 相对定位的父 div 不拉伸到绝对子 div 高度](https://stackoverflow.com/questions/8184919/css-relative-positioned-parent-div-not-stretching-to-absolute-child-div-height)和[调整父 div 大小以匹配绝对定位的子 div 高度](https://stackoverflow.com/questions/5359574/resize-parent-div-to-match-absolutly-positioned-child-div-height)，但子图像的高度返回为 0。

我什至尝试过 clearfixes，即使我没有使用浮点数。这些图像需要绝对定位，所以我无法用浮点数解决。

有任何想法吗？

[http://jsfiddle.net/sdowswell/XmVu7/1/](http://jsfiddle.net/sdowswell/XmVu7/1/)

**HTML**

```
<div id="banner">
    <a href="newpage.html"><img src="images/banners/image1.jpg" /></a>
    <a href="othernewpage.html"><img src="images/banners/image2.jpg" /></a>
</div> 
```

**CSS**

```
#banner {
    width:100%; 
    position:relative; 
}

#banner>a>img {
    width:100%; 
} 
```

**查询**

```
$(document).ready(function(){

        $('#banner').css('overflow', 'hidden');
        $('#banner img')
            .css('position', 'absolute')
            .css('display', 'none');
    $('#banner img').first().css('display', 'block');
}); 
```

​</p>

（编辑以摆脱无关的额外内容。再次编辑以包括 jQuery。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T20:16:12.037

在第一张图片完成加载后，我可以通过设置#banner 高度来找到解决方案

```
$(window).load(function() {
     $('#banner').css('height', $('#banner img:first').css('height'))
}); 
```

（使用 window.load 来确保 chrome 从完全加载的图像中收集信息）

这并不理想，但它现在正在发挥作用。

# c# - 动态加载 dll，包括对外部库的引用

> ID：11974477
> 
> 赞同：0
> 
> 时间：2012-08-15T17:54:56.147
> 
> 标签：c#, .net, dll, .net-assembly

我动态加载 dll (dll_1) 并从中运行代码。当这个 (dll_1) 使用另一个 dll (dll_2) 时会出现问题。我无法在 dll_1 中嵌入 dll_2。

我使用`Assembly.LoadFile`then`CreateInstance`和`InvokeMember`.

我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T17:58:14.503

如果我正确理解了您的问题，您希望检测何时未解析对程序集的引用并能够进行调解以确保正确加载程序集。

您可以使用[AppDomain.AssemblyResolveEvent](http://msdn.microsoft.com/en-us/library/system.appdomain.assemblyresolve.aspx)来做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T18:04:07.123

最简单的选择是不使用 LoadFile 而是使用 Load，因为它解析程序集的方式与正常程序集解析的工作方式相同。

下一个选项是预加载依赖项或按照 Eric J 的建议使用 AssemblyResolveEvent。如果你走这条路，请阅读[Suzanne Cook](http://blogs.msdn.com/b/suzcook/archive/2003/05/29/57143.aspx)关于加载程序集和绑定上下文的文章（请注意，同一博客中有更多相关文章）。

除了链接的文章：

> LoadFrom 优势：
> 
> 可以从多个路径加载程序集，而不仅仅是从 ApplicationBase 下方加载。
> 
> 将自动找到已在此上下文中加载的依赖项。
> 
> 将自动找到与请求的 LoadFrom 上下文程序集相同的目录中的依赖项。

# python - 如何从 ubuntu 服务器以编程方式登录到 Yahoo

> ID：11974478
> 
> 赞同：7
> 
> 时间：2012-08-15T17:54:59.403
> 
> 标签：python, authentication, beautifulsoup, mechanize, scrapy

我想从运行在 ubuntu 服务器上的脚本登录到我的雅虎帐户。我曾尝试将 python 与 mechanize 一起使用，但我的计划存在缺陷。

这是我目前拥有的代码。

```
 loginurl = "https://login.yahoo.com/config/login"
        br = mechanize.Browser()
        cj = cookielib.LWPCookieJar()
        br.set_cookiejar(cj)
        br.set_handle_equiv(True)
        br.set_handle_gzip(True)
        br.set_handle_redirect(True)
        br.set_handle_referer(True)
        br.set_handle_robots(False)
        br.set_handle_refresh(mechanize._http.HTTPRefreshProcessor(), max_time=1)
        br.addheaders = [('User-agent', 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.1) Gecko/2008071615 Fedora/3.0.1-1.fc9 Firefox/3.0.1')]
        r = br.open(loginurl)
        html = r.read()
        br.select_form(nr=0)
        br.form['login']='[mylogin]'
        br.form['passwd']='[mypassword]'
        br.submit()

        print br.response().read() 
```

我得到的响应是一个带有粗体红色文本的雅虎登录页面。“必须在您的浏览器上启用 Javascript”或类似内容。mechanize docs 上有一个部分提到了使用 JS 创建 cookie 的页面，但是帮助页面返回 HTTP 400（只是我的运气）

弄清楚 javascript 做了什么，然后手动执行，这听起来是一项非常困难的任务。我非常愿意切换到任何工具/语言，只要它可以在 ubuntu 服务器上运行。即使这意味着使用不同的登录工具，然后将登录 cookie 传递回我的 python 脚本。任何帮助/建议表示赞赏。

更新：

*   我不想使用 Yahoo API

*   我也尝试过使用scrapy，但我认为会出现同样的问题

我的scrapy脚本

```
class YahooSpider(BaseSpider):
name = "yahoo"
start_urls = [
    "https://login.yahoo.com/config/login?.intl=us&.lang=en-US&.partner=&.last=&.src=&.pd=_ver%3D0%26c%3D%26ivt%3D%26sg%3D&pkg=&stepid=&.done=http%3a//my.yahoo.com"
]

def parse(self, response):
    x = HtmlXPathSelector(response)
    print x.select("//input/@value").extract()
    return [FormRequest.from_response(response,
                formdata={'login': '[my username]', 'passwd': '[mypassword]'},
                callback=self.after_login)]

def after_login(self, response):
    # check login succeed before going on
    if response.url == 'http://my.yahoo.com':
        return Request("[where i want to go next]",
                  callback=self.next_page, errback=self.error, dont_filter=True)
    else:
        print response.url
        self.log("Login failed.", level=log.CRITICAL)

def next_page(sekf, response):
    x = HtmlXPathSelector(response)
    print x.select("//title/text()").extract() 
```

scrapy 脚本只输出“https://login.yahoo.com/config/login”......嘘

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T23:17:09.123

我很惊讶这有效：

```
Python 2.6.6 (r266:84292, Dec 26 2010, 22:31:48)
[GCC 4.4.5] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> from BeautifulSoup import BeautifulSoup as BS
>>> import requests
>>> r = requests.get('https://login.yahoo.com/')
>>> soup = BS(r.text)
>>> login_form = soup.find('form', attrs={'name':'login_form'})
>>> hiddens = login_form.findAll('input', attrs={'type':'hidden'})
>>> payload = {}
>>> for h in hiddens:
...     payload[str(h.get('name'))] = str(h.get('value'))
...
>>> payload['login'] = 'testtest481@yahoo.com'
>>> payload['passwd'] = '********'
>>> post_url = str(login_form.get('action'))
>>> r2 = requests.post(post_url, cookies=r.cookies, data=payload)
>>> r3 = requests.get('http://my.yahoo.com', cookies=r2.cookies)
>>> page = r3.text
>>> pos = page.find('testtest481')
>>> print page[ pos - 50 : pos + 300 ]
   You are signed in as: <span class="yuhead-yid">testtest481</span>        </li>    </ul></li><li id="yuhead-me-signout" class="yuhead-me"><a href="
http://login.yahoo.com/config/login?logout=1&.direct=2&.done=http://www.yahoo.com&amp;.src=my&amp;.intl=us&amp;.lang=en-US" target="_top" rel="nofoll
ow">            Sign Out        </a><img width='0' h
>>> 
```

请试一试：

```
"""                                                                        
ylogin.py - how-to-login-to-yahoo-programatically-from-an-ubuntu-server    

http://stackoverflow.com/questions/11974478/                               
Test my.yahoo.com login using requests and BeautifulSoup.                  
"""                                                                        

from BeautifulSoup import BeautifulSoup as BS                              
import requests                                                            

CREDS = {'login': 'CHANGE ME',                                             
         'passwd': 'CHANGE ME'}                                            
URLS = {'login': 'https://login.yahoo.com/',                               
        'post': 'https://login.yahoo.com/config/login?',                   
        'home': 'http://my.yahoo.com/'}                                    

def test():                                                                
    cookies = get_logged_in_cookies()                                      
    req_with_logged_in_cookies = requests.get(URLS['home'], cookies=cookies)    
    assert 'You are signed in' in req_with_logged_in_cookies.text
    print "If you can see this message you must be logged in." 

def get_logged_in_cookies():                                               
    req = requests.get(URLS['login'])                                      
    hidden_inputs = BS(req.text).find('form', attrs={'name':'login_form'})\
                                .findAll('input', attrs={'type':'hidden'}) 
    data = dict(CREDS.items() + dict( (h.get('name'), h.get('value')) \    
                                         for h in hidden_inputs).items() ) 
    post_req = requests.post(URLS['post'], cookies=req.cookies, data=data) 
    return post_req.cookies                                                

test() 
```

根据需要添加错误处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T06:22:22.907

如果页面使用 javascript，您可能会考虑使用[ghost.py](http://jeanphix.me/Ghost.py/)之类的东西，而不是 requests 或 mechanize。ghost.py 托管一个 WebKit 客户端，应该能够以最小的努力处理这些棘手的情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T21:36:26.540

当需要启用 js 并且没有显示可用时，phantomjs 是一个不错的解决方案，认为它是 js，而不是 python :$

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T14:08:46.603

你的 Scrapy 脚本对我有用：

```
from scrapy.spider import BaseSpider
from scrapy.http import FormRequest
from scrapy.selector import HtmlXPathSelector

class YahooSpider(BaseSpider):
    name = "yahoo"
    start_urls = [
        "https://login.yahoo.com/config/login?.intl=us&.lang=en-US&.partner=&.last=&.src=&.pd=_ver%3D0%26c%3D%26ivt%3D%26sg%3D&pkg=&stepid=&.done=http%3a//my.yahoo.com"
    ]

    def parse(self, response):
        x = HtmlXPathSelector(response)
        print x.select("//input/@value").extract()
        return [FormRequest.from_response(response,
                    formdata={'login': '<username>', 'passwd': '<password>'},
                    callback=self.after_login)]

    def after_login(self, response):
        self.log('Login successful: %s' % response.url) 
```

输出：

```
stav@maia:myproj$ scrapy crawl yahoo
2012-08-22 20:55:31-0500 [scrapy] INFO: Scrapy 0.15.1 started (bot: drzyahoo)
2012-08-22 20:55:31-0500 [scrapy] DEBUG: Enabled extensions: LogStats, TelnetConsole, CloseSpider, WebService, CoreStats, SpiderState
2012-08-22 20:55:31-0500 [scrapy] DEBUG: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, RedirectMiddleware, CookiesMiddleware, HttpCompressionMiddleware, ChunkedTransferMiddleware, DownloaderStats
2012-08-22 20:55:31-0500 [scrapy] DEBUG: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2012-08-22 20:55:31-0500 [scrapy] DEBUG: Enabled item pipelines:
2012-08-22 20:55:31-0500 [yahoo] INFO: Spider opened
2012-08-22 20:55:31-0500 [yahoo] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2012-08-22 20:55:31-0500 [scrapy] DEBUG: Telnet console listening on 0.0.0.0:6023
2012-08-22 20:55:31-0500 [scrapy] DEBUG: Web service listening on 0.0.0.0:6080
2012-08-22 20:55:32-0500 [yahoo] DEBUG: Crawled (200) <GET https://login.yahoo.com/config/login?.intl=us&.lang=en-US&.partner=&.last=&.src=&.pd=_ver%3D0%26c%3D%26ivt%3D%26sg%3D&pkg=&stepid=&.done=http%3a//my.yahoo.com> (referer: None)
[u'1', u'', u'', u'', u'', u'', u'', u'us', u'en-US', u'', u'', u'93s42g583b3cg', u'0', u'L0iOlEQ1EbZ24TfLRpA43s5offgQ', u'', u'', u'', u'', u'', u'0', u'Y', u'http://my.yahoo.com', u'_ver=0&c=&ivt=&sg=', u'0', u'0', u'0', u'5', u'5', u'', u'y']
2012-08-22 20:55:32-0500 [yahoo] DEBUG: Redirecting (meta refresh) to <GET http://my.yahoo.com> from <POST https://login.yahoo.com/config/login>
2012-08-22 20:55:33-0500 [yahoo] DEBUG: Crawled (200) <GET http://my.yahoo.com> (referer: https://login.yahoo.com/config/login?.intl=us&.lang=en-US&.partner=&.last=&.src=&.pd=_ver%3D0%26c%3D%26ivt%3D%26sg%3D&pkg=&stepid=&.done=http%3a//my.yahoo.com)
2012-08-22 20:55:33-0500 [yahoo] DEBUG: Login successful: http://my.yahoo.com
2012-08-22 20:55:33-0500 [yahoo] INFO: Closing spider (finished)
2012-08-22 20:55:33-0500 [yahoo] INFO: Dumping spider stats:
    {'downloader/request_bytes': 2447,
     'downloader/request_count': 3,
     'downloader/request_method_count/GET': 2,
     'downloader/request_method_count/POST': 1,
     'downloader/response_bytes': 77766,
     'downloader/response_count': 3,
     'downloader/response_status_count/200': 3,
     'finish_reason': 'finished',
     'finish_time': datetime.datetime(2012, 8, 23, 1, 55, 33, 837619),
     'request_depth_max': 1,
     'scheduler/memory_enqueued': 3,
     'start_time': datetime.datetime(2012, 8, 23, 1, 55, 31, 271262)} 
```

环境：

```
stav@maia:myproj$ scrapy version -v
Scrapy  : 0.15.1
lxml    : 2.3.2.0
libxml2 : 2.7.8
Twisted : 11.1.0
Python  : 2.7.3 (default, Aug  1 2012, 05:14:39) - [GCC 4.6.3]
Platform: Linux-3.2.0-29-generic-x86_64-with-Ubuntu-12.04-precise 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-29T16:21:09.793

你可以试试 PhantomJS，一个带有 Javascript API [http://phantomjs.org/](http://phantomjs.org/)的无头 webkit，它支持支持 Javascript 的编程浏览。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-29T17:06:22.597

为什么不使用[`FancyURLOpener`](http://docs.python.org/library/urllib.html#urllib.FancyURLopener)？它处理标准 HTTP 错误并具有`prompt_user_passwd()`功能。从链接：

> 执行基本身份验证时，`FancyURLopener`实例调用其`prompt_user_passwd()`方法。默认实现在控制终端上要求用户提供所需的信息。如果需要，子类可以覆盖此方法以支持更合适的行为。

# html - 火狐没有显示

> ID：11974479
> 
> 赞同：0
> 
> 时间：2012-08-15T17:55:08.183
> 
> 标签：html, css, cross-browser

[http://client.henrybuilt.com/login.php](http://client.henrybuilt.com/login.php)

出于某种原因，页面上没有显示任何内容。

在 Chrome 中运行良好，但不知道 Firefox 发生了什么。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T17:57:29.277

您的身体标签上`display:none`设置了属性。从`styles/main.css`文件中的这个块中删除它：

```
body{
    margin:0;
    padding:0;
    background-color:#FCFCFC;
    display:none;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T18:07:05.923

Firefox 抛出此警告

```
The character encoding of the HTML document was not declared. The document will render
with garbled text in some browser configurations if the document contains characters from
outside the US-ASCII range. The character encoding of the page must to be declared in the 
document or in the transfer protocol. 
```

这可能是一个原因。

我附上了视图源代码的样子。该`html`标签以红色突出显示，指出存在一些错误。

![错误](../Images/64f25414d0c341196f4f8d7cea5e29de.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T12:07:12.060

你可以试试这个而不是fadeIn ..

```
$('body').css('display','block'); 
```

# android - 三个问题

> ID：11974483
> 
> 赞同：0
> 
> 时间：2012-08-15T17:55:29.933
> 
> 标签：android, forms, loops, focusable

首先，我想使用这样的循环设置未选中的所有 8 个复选框：

```
 for (int i=1;i<8;++i){
    CheckBox view1 = (CheckBox) findViewById(R.id.CheckBox0+String.valueOf(i));
    view1.setChecked(false);
    } 
```

它不起作用，但你明白我的意思。怎么解决？

第二：使用 Eclipse 我设置了一个表单列表。是什么导致应用程序启动时，它立即显示键盘并聚焦在编辑字段中？我希望键盘仅在用户触摸编辑字段后出现。

第三：我如何设置编辑字段的属性，当用户触摸输入时，焦点不会传递到下一个编辑字段。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T18:14:25.090

首先，一起问多个问题是不好的；当人们只知道一种解决方案时，它会阻止人们回答。

**1** - 依靠 ID `CheckBox0`, `CheckBox1`, `CheckBox2`, ... 来保持秩序是非常危险的，而且是不好的做法。在这种情况下，您应该使用`getIdentifier`; 这将可靠地获取 IDs `CheckBox1`， then`CheckBox2`等。

```
for (int i=1;i<8;++i){
    CheckBox view1 = (CheckBox) findViewById(getResources().getIdentifier("CheckBox" + i, "id", getPackageName()));
    view1.setChecked(false);
} 
```

**2** - 您需要为此使用`stateHidden`修饰符：

```
<activity
    android:name="com.example.NoKeyboardActivity"
    android:windowSoftInputMode="stateHidden" /> 
```

**3** -`imeOptions`用于此；`actionNone`是您正在寻找的那个，或者（根据评论）`actionDone`启用“完成”按钮。

```
<TextView
    ...
    android:imeOptions="actionNone" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T18:03:13.380

每次构建后资源都有固定的 id，你必须在 public.xml 中声明资源，然后你可以顺序访问 id。[在这里](https://stackoverflow.com/questions/9348614/what-is-the-use-of-the-res-values-public-xml-file-on-android)检查

R.id.CheckBox0 也是一个 int 也是如此

```
findViewById(R.id.CheckBox0+ i) 
```

在 public.xml 中声明所有复选框之后

对于活动清单中的第二个问题，添加 [android:windowSoftInputMode="stateHidden"](http://developer.android.com/guide/topics/manifest/activity-element.html#wsoft)

第三：我认为您必须在 android:nextFocusDown 的布局中引用相同的编辑文本。不确定这是否可行，试一试

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T18:13:46.047

1 - 请记住，这是 Java 而不是 Javascript，您不能这样做 (R.id.CheckBox0+String.valueOf(i))。通常我会创建一个包含所有 R.id 的 int 数组并循环遍历它们。

2 - 如果键盘已经显示，您也可以使用 android:windowSoftInputMode="stateUnchanged" 来隐藏键盘。

3 - 这就是它应该的方式，但你可以在edittext上使用属性android：imeOptions =“actionNone”，所以输入按钮不会做任何事情。

# google-chrome - 套接字 API：打包的应用程序中不允许？

> ID：11974487
> 
> 赞同：5
> 
> 时间：2012-08-15T17:55:43.040
> 
> 标签：google-chrome, google-chrome-extension, google-chrome-app

我正在尝试将新的[Socket API](https://developer.chrome.com/trunk/extensions/apps/socket.html)用于 Chrome 扩展，但遇到了一个令人困惑的错误。我的示例应用程序清单如下所示：

```
{
  "name":"Yet Another Socket App",
  "version":"0.0.1",
  "manifest_version":2,
  "permissions":[
    "experimental", "socket"
  ],
  "app":{
    "launch":{
        "local_path":"index.html"
    }
  }
} 
```

应用程序正在加载（即没有错误警报），但在其条目下方出现警告`chrome://extensions`：`'socket' is not allowed for specified package type (theme, app, etc.).`

**注意：** `index.html`存在并且是一个简单的 HTML 文档（并且`chrome.socket`确实`undefined`在其中）。我已经通过`chrome://flags`. 我`v22.0.1229.6 dev`在 Ubuntu 上运行 Chrome ( ) 的 Dev 频道。

这是套接字支持中的一个短暂的打嗝（毕竟这是开发通道），还是我以某种方式错误地设置了我的应用程序？另外，我必须卸载 Chrome Stable 才能安装 Dev；是否有可能`apt-get purge google-chrome-stable`并且`rm -rf ~/.config/google-chrome`不足以清除稳定通道的每一块？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T13:31:19.063

我在尝试从 Google 重新创建此示例时遇到了同样的问题：http: [//developer.chrome.com/trunk/apps/app_network.html](http://developer.chrome.com/trunk/apps/app_network.html)

Chrome总是说

> “权限[1]”的值无效

他们的示例应用程序中提供了正确的清单文件： [https ://github.com/GoogleChrome/chrome-app-samples/tree/master/udp](https://github.com/GoogleChrome/chrome-app-samples/tree/master/udp)

换上`permissions`后`manifest.json`_

```
"permissions": [
    "experimental",
    {"socket": [
        "udp-send-to"
    ]},
    "app.window"
] 
```

我现在可以`socket`在 Chrome **23 或更高版本**中访问该对象：

```
var socket = chrome.socket || chrome.experimental.socket; 
```

# matlab-load - load() - 忽略给定的字符串

> ID：11974488
> 
> 赞同：1
> 
> 时间：2012-08-15T17:55:43.897
> 
> 标签：matlab-load

我正在尝试使用 MATLAB 中的 load() 函数从文本文件中读取数据。但是，文本文件的每一行都以“...”结尾。数据文件不是由 MATLAB 生成的，所以我无法控制省略号的来源。

我正在加载的数据文件如下所示：

```
11191425        NaN     NaN     0.0 ...
11191426        NaN     NaN     0.0 ...
11191427        NaN     NaN     0.0 ...
11191428        NaN     NaN     0.0 ...
11191429     2280.5  1910.1   455.0 ...
11191430     2280.5  1910.1   455.0 ...
11191431     2298.0  1891.1   454.0 ...
11191432     2317.3  1853.7   453.0 ...
11191433     2335.6  1811.1   458.0 ...
11191434     2350.6  1769.8   466.0 ...
11191435     2365.3  1729.7   475.0 ...
11191436     2379.5  1691.2   485.0 ...
11191437     2378.3  1647.6   492.0 ...
11191438     2375.4  1621.3   499.0 ...
11191439     2372.7  1598.5   499.0 ...
11191440     2372.7  1598.5   499.0 ...
11191441        NaN     NaN     0.0 ...
11191442      294.9  1283.5  1163.0 ...
11191443      294.9  1283.5  1163.0 ... 
```

它的实际长度超过 100,000 行，但你明白了。使用 load() 命令会引发错误，因为每行末尾都有 '...'。我正在寻找的只是阅读前四列。

加载数据的最有效方法是什么，同时在最后完全省略掉流氓椭圆列？不涉及使系统两次解析整个文本文件的方法会更好，但不是必需的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T18:09:57.053

[如果您使用textscan](http://www.mathworks.com/help/techdoc/ref/textscan.html)而不是使用 load，这很容易。您可以将最后一列视为字符串列，然后忽略它。

```
fid = fopen('data.txt');
data = textscan(fid,'%d %f %f %f %s');
fclose(fid); 
```

然后，您可以通过连接要保持在一起的列来使输出成为单个矩阵。

```
data = [data{1:4}]; 
```

第五列只填充了“...”字符串。你可以忽略它。

# php - 将 Javascript 正则表达式转换为 PHP

> ID：11974490
> 
> 赞同：8
> 
> 时间：2012-08-15T17:55:55.820
> 
> 标签：php, javascript, regex

我知道这个问题已经被问了十几次了，但是这个问题在技术上并不是一个骗局（如果你愿意，请检查其他问题）；）

基本上，我有一个 Javascript 正则表达式来检查我用于前端验证的电子邮件地址，并且我使用 CodeIgniter 对后端进行双重检查，以防前端的验证无法正常运行（例如浏览器问题.) 这是一个很长的正则表达式，我不知道从哪里开始手动转换它。

**我正在寻找一种将 JS 正则表达式转换为 PHP 正则表达式的工具**——我在类似问题的任何答案中都没有找到一个（当然，这样的工具可能不存在。）好吧，我撒了谎——[其中一个人](https://stackoverflow.com/questions/1131918/converting-php-regexs-to-javascript-or-what-are-the-differences)建议了一个售价 39.95 美元的工具，但我真的不想花那么多钱来转换一个表达式（不，没有上述问题的答案所建议的免费试用。）

**[这是由 aSeptik 慷慨提供](https://stackoverflow.com/questions/2855865/jquery-validate-e-mail-address-regex)的**Javascript 表达式**：**

 **```
/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i 
```

还有 CodeIgniter 使用的那个，我不想使用它，因为它不遵循相同的规则（不允许某些有效地址）：

```
/^([a-z0-9\+_\-]+)(\.[a-z0-9\+_\-]+)*@([a-z0-9\-]+\.)+[a-z]{2,6}$/ix 
```

**我想在 PHP 中使用 Javascript 正则表达式设置的相同规则**。

在我的前端代码说电子邮件地址正常，然后 Codeigniter 说不是，这种不一致当然是我试图在我的应用程序中修复的行为。

感谢您提供的所有提示！:D

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T19:04:08.380

Javascript 和 PHP 中的正则表达式引擎之间存在一些差异。请查看[正则表达式引擎的比较](https://en.wikipedia.org/wiki/Comparison_of_regular-expression_engines) 文章以获取理论和[PHP 正则表达式和 JavaScript 正则表达式答案之间的差异](https://stackoverflow.com/a/9072234/935073)以获取实用信息。

大多数情况下，您只需稍加修改即可在 PHP 中使用 Javascript 正则表达式模式。作为一个根本的区别，PHP 正则表达式被定义为一个字符串（或在一个字符串中），如下所示：

```
preg_match('/^\(?(\d{3})\)?[- ]?(\d{3})[- ]?(\d{4})$/',$telephone); 
```

Javascript 正则表达式不是，它以自己的方式定义：

```
var ptr = new RegExp(/^\(?(\d{3})\)?[- ]?(\d{3})[- ]?(\d{4})$/);
// or
var ptr = /^\(?(\d{3})\)?[- ]?(\d{3})[- ]?(\d{4})$/; 
```

您可以通过在 PHP 上运行正则表达式来尝试一下。作为建议，不要在 Codeigniter 文件中替换它，您可以简单地扩展或替换本机库。您可以查看[创建库](http://codeigniter.com/user_guide/general/creating_libraries.html)以获取更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T21:03:15.303

我能够以比预期更好的方式解决这个问题。我无法转换我想使用的 Javascript 正则表达式（即使在购买了 RegexBuddy 之后——它会派上用场，但它无法产生正确的转换），所以我决定去查看[Regex Validate Email Address](http://ask.altervista.org/demo/jquery-validate-e-mail-address-regex/)网站，看看他们是否有任何关于好的正则表达式的建议。就在那时我发现了这个：

“目前得分最高的表达式是 PHP 使用的`filter_var()`”：

```
/^(?!(?:(?:\x22?\x5C[\x00-\x7E]\x22?)|(?:\x22?[^\x5C\x22]\x22?)){255,})(?!(?:(?:\x22?\x5C[\x00-\x7E]\x22?)|(?:\x22?[^\x5C\x22]\x22?)){65,}@)(?:(?:[\x21\x23-\x27\x2A\x2B\x2D\x2F-\x39\x3D\x3F\x5E-\x7E]+)|(?:\x22(?:[\x01-\x08\x0B\x0C\x0E-\x1F\x21\x23-\x5B\x5D-\x7F]|(?:\x5C[\x00-\x7F]))*\x22))(?:\.(?:(?:[\x21\x23-\x27\x2A\x2B\x2D\x2F-\x39\x3D\x3F\x5E-\x7E]+)|(?:\x22(?:[\x01-\x08\x0B\x0C\x0E-\x1F\x21\x23-\x5B\x5D-\x7F]|(?:\x5C[\x00-\x7F]))*\x22)))*@(?:(?:(?!.*[^.]{64,})(?:(?:(?:xn--)?[a-z0-9]+(?:-[a-z0-9]+)*\.){1,126}){1,}(?:(?:[a-z][a-z0-9]*)|(?:(?:xn--)[a-z0-9]+))(?:-[a-z0-9]+)*)|(?:\[(?:(?:IPv6:(?:(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){7})|(?:(?!(?:.*[a-f0-9][:\]]){7,})(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){0,5})?::(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){0,5})?)))|(?:(?:IPv6:(?:(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){5}:)|(?:(?!(?:.*[a-f0-9]:){5,})(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){0,3})?::(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){0,3}:)?)))?(?:(?:25[0-5])|(?:2[0-4][0-9])|(?:1[0-9]{2})|(?:[1-9]?[0-9]))(?:\.(?:(?:25[0-5])|(?:2[0-4][0-9])|(?:1[0-9]{2})|(?:[1-9]?[0-9]))){3}))\]))$/iD 
```

它只匹配 4/86 错误，而我使用的 Javascript 匹配 8/86 错误，所以 PHP 更准确一点。所以，我扩展了 CodeIgniter`Form_validation`库，改为使用`return filter_var($str, FILTER_VALIDATE_EMAIL);`.

...但它在 Javascript 中有效吗？

```
var pattern = new RegExp(/^(?!(?:(?:\x22?\x5C[\x00-\x7E]\x22?)|(?:\x22?[^\x5C\x22]\x22?)){255,})(?!(?:(?:\x22?\x5C[\x00-\x7E]\x22?)|(?:\x22?[^\x5C\x22]\x22?)){65,}@)(?:(?:[\x21\x23-\x27\x2A\x2B\x2D\x2F-\x39\x3D\x3F\x5E-\x7E]+)|(?:\x22(?:[\x01-\x08\x0B\x0C\x0E-\x1F\x21\x23-\x5B\x5D-\x7F]|(?:\x5C[\x00-\x7F]))*\x22))(?:\.(?:(?:[\x21\x23-\x27\x2A\x2B\x2D\x2F-\x39\x3D\x3F\x5E-\x7E]+)|(?:\x22(?:[\x01-\x08\x0B\x0C\x0E-\x1F\x21\x23-\x5B\x5D-\x7F]|(?:\x5C[\x00-\x7F]))*\x22)))*@(?:(?:(?!.*[^.]{64,})(?:(?:(?:xn--)?[a-z0-9]+(?:-[a-z0-9]+)*\.){1,126}){1,}(?:(?:[a-z][a-z0-9]*)|(?:(?:xn--)[a-z0-9]+))(?:-[a-z0-9]+)*)|(?:\[(?:(?:IPv6:(?:(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){7})|(?:(?!(?:.*[a-f0-9][:\]]){7,})(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){0,5})?::(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){0,5})?)))|(?:(?:IPv6:(?:(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){5}:)|(?:(?!(?:.*[a-f0-9]:){5,})(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){0,3})?::(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){0,3}:)?)))?(?:(?:25[0-5])|(?:2[0-4][0-9])|(?:1[0-9]{2})|(?:[1-9]?[0-9]))(?:\.(?:(?:25[0-5])|(?:2[0-4][0-9])|(?:1[0-9]{2})|(?:[1-9]?[0-9]))){3}))\]))$/i); 
```

劲！奇迹般有效！我不仅得到了我在前端和后端验证之间寻找的一致性，而且在这个过程中我也得到了一个更准确的正则表达式。双赢！

感谢所有提供建议的人！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-24T11:55:18.787

今天有一个站点[https://regex101.com/](https://regex101.com/)，您可以在其中将一个 JS 正则表达式转换为 PHP 或其他一些语言。**

# mysql - SQL：2个不同的计数在同一字段上具有不同的where子句

> ID：11974491
> 
> 赞同：1
> 
> 时间：2012-08-15T17:55:57.217
> 
> 标签：mysql

如何将下面的 2 个查询组合成一个查询？

```
select count(distinct user_id) as action_1_count, date  
from table    
where action = "action_1"  
group by date;

select count(distinct user_id) as action_2_count, date
from table  
where action = "action_2"  
group by date; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:01:44.820

这样做合并上面的查询：

```
SELECT date,
         CASE WHEN action  = "action_1" THEN COUNT(user_id) END AS Action1Count,
         CASE WHEN action  = "action_2" THEN COUNT(user_id) END AS Action2Count
  FROM table    
  WHERE action IN ("action_1", "action_2")
  GROUP BY date 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T18:05:05.703

上面的答案将为您提供 action_2 的多行，而您似乎只想要 action_2 的一行。

您可以使用联合：

```
select '1', count(distinct user_id), date
from table
where action = "action_1"
group by 3
union
select '2', count(distinct user_id), max(date)
from table
where action = "action_2"
group by 3; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T17:58:35.050

```
SELECT COUNT(user_id), date
FROM table
WHERE action IN ('action_1', 'action_2)
GROUP BY action, date 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T18:01:12.677

你的查询可以是这样的

```
SELECT COUNT(user_id), date FROM table WHERE action IN ('action_1', 'action_2') GROUP BY date 
```

这是使用`SUM()`功能的另一种方法，这应该可以解决问题

```
SELECT 
  SUM(action ='action_1') count_1,
  SUM(action ='action_2') count_2, 
  SUM(action ='action_1' OR action ='action_2') `full_count`,
  date 
FROM
 table 
GROUP BY date 
```

使用`SUM()`with 表达式将产生一个布尔值，如果`action ='action_1'`然后结果将为 1，如果不是则为 0，所有这些都被求和并根据表达式结果产生计数

# wpf - 从 WPF windw 访问 windows 窗体功能

> ID：11974494
> 
> 赞同：0
> 
> 时间：2012-08-15T17:56:01.430
> 
> 标签：wpf, vb.net

我正在尝试从 WPF 窗口调用 Form1 中的函数，但出现以下错误

“对非共享成员的引用需要对象引用。”

尝试从 wpf 窗口访问 Form1 中的公共变量时也会出现相同的错误。

不可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:07:15.793

所以根据 MSDN[这个错误](http://msdn.microsoft.com/en-us/library/zwwhc0d0%28v=vs.90%29.aspx)，这是尝试引用实例变量的问题，就好像它们是静态的一样。

如果你的类是`Form1`，你不能通过调用访问非静态的方法或变量`Form1.Method()`。这永远不会起作用，不仅仅是在 WPF 中。这是非常基本的东西，您可能想阅读更多关于 VB 的内容。查看[共享](http://msdn.microsoft.com/en-us/library/zc2b427x.aspx)和[静态](http://msdn.microsoft.com/en-us/library/z2cty7t8%28v=vs.110%29)文档。

例如，要访问`Show()`Form1 上的方法，您必须[实例化](http://msdn.microsoft.com/en-us/library/ms973814.aspx)（创建对象的实例），然后调用对象上的方法。像这样。

```
Dim frm As New Form1()
frm.Show() 
```

# ruby-on-rails - Mongoid 更新属性：当集合中不存在字段名称时如何不插入

> ID：11974495
> 
> 赞同：1
> 
> 时间：2012-08-15T17:56:03.073
> 
> 标签：ruby-on-rails, mongoid

我正在尝试在 Rails 3 应用程序中使用 Mongoid 执行 update_attributes

我遇到的问题是：

假设我的收藏有以下字段：

{“名称”：“foo”，“电子邮件”：“酒吧”}

**这是场景**

如果我这样做：

```
@person = Person.where(:Name => "foo", :_id = "some_id") 
```

然后我这样做：

```
@person.update_attributes(:Name => "baba-fooka", :Last_Name => "baba-bara") 
```

上面这行代码更新了 mongodb 中的记录，同时也在文档中**增加了一个新的字段**。

如何将 update_attributes 方法与不允许插入尚不存在的字段的验证一起使用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T18:31:05.347

听起来您想要的是在 mongoid 配置文件[中将 allow_dynamic_fields](http://mongoid.org/en/mongoid/docs/documents.html#dynamic_fields)设置为 false 。动态字段默认启用，即使没有为属性定义字段，也可以设置属性并将其保留在文档中。

进入`config/mongoid.yml`选项集下`allow_dynamic_fields: false`。它应该已经存在，但已注释掉并设置为 true。确保它说的是假的。

# windows-8 - Windows 8 Metro UI：托盘通知图标的新位置是什么？

> ID：11974496
> 
> 赞同：3
> 
> 时间：2012-08-15T17:56:14.337
> 
> 标签：windows-8

在 Windows 8 之前，如果应用程序想要非侵入式地通知用户发生了某事，它会显示托盘图标，可能是动画。例如，如果电子邮件应用程序发现一封新电子邮件，它会显示一个新的托盘图标（outlook）或在托盘中为其自己的图标设置动画（所有其他电子邮件客户端）。

使用新的 Windows 8 Metro UI，它是一个带有磁贴的新屏幕，应该是用户用来启动和切换应用程序的主要内容。在这种模式下，哪里没有托盘区域，但还有很多其他的东西 - 魅力区域，比如显示时钟和电池使用情况的状态区域等。

根据 Microsoft Metro UI 设计指南 - 糟糕的电子邮件应用通知图标的新位置是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T18:04:16.580

我想你想要的是一个[通知](http://msdn.microsoft.com/en-us/library/windows/apps/hh779722.aspx)。共有三种通知：磁贴更新、磁贴上的徽章更新或屏幕右上角的[“toast” （在另一个应用程序中时）。](http://msdn.microsoft.com/en-us/library/windows/apps/hh465448.aspx)[此处](http://msdn.microsoft.com/en-us/library/windows/apps/hh779721.aspx#notification_delivery_methods)列出了这些类型的通知的各种选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T17:59:50.043

让某人知道您的应用已更新信息的新位置是磁贴本身。

这些被称为“动态磁贴”，因为它们是动态的，并且随着新数据的可用而变化。

[http://www.winsupersite.com/article/windows8/windows-8-feature-focus-tiles-143175](http://www.winsupersite.com/article/windows8/windows-8-feature-focus-tiles-143175)

# nested - Watir-webdriver - 无法通过 id 访问嵌套框架

> ID：11974497
> 
> 赞同：0
> 
> 时间：2012-08-15T17:56:16.113
> 
> 标签：nested, frame, watir-webdriver

该网页具有嵌套的框架结构。框架`FCCBMain`嵌套在框架中`Main`。我可以通过这种方式访问​​它：

```
 browser.frame(:id => "FCCBMain").frames[0]
 => #<Watir::Frame:0x504e155578d49f34 located=false selector={:index=>0}>
 browser.frame(:id => "FCCBMain").frames[0].id
 => "MainLeft" 
```

但不是这样：

```
 brwoser.frame(:id => "FCCBMain").frame(:id => "MainLeft").id
 Selenium::WebDriver::Error::StaleElementReferenceError: Element belongs to a different frame than the current one - switch to its containing frame to use it
from [remote server] resource://fxdriver/modules/web_element_cache.js:5634:in `unknown'
from [remote server] file:///tmp/webdriver-profile20120816-21551-1a8xyvv/extensions/fxdriver@googlecode.com/components/driver_component.js:5329:in `unknown'
from [remote server] file:///tmp/webdriver-profile20120816-21551-1a8xyvv/extensions/fxdriver@googlecode.com/components/driver_component.js:6623:in `unknown'
from [remote server] file:///tmp/webdriver-profile20120816-21551-1a8xyvv/extensions/fxdriver@googlecode.com/components/command_processor.js:9924:in `unknown'
 ... 
```

我认为这两种方式非常相似。为什么后面的不起作用？

（如果有帮助，[这](https://ebank.bankoftaipei.com.tw/WWW/Default.asp?ITrnTm=1345024052593&Mode=NONE)是我正在处理的网页）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T12:16:24.993

首先，我认为您的“brwoser.frame”有错字

其次，如果您要使用链访问框架，则必须在路径 IE 中包含所有框架和框架集： browser.frame(:id => "FCCBMain").frameset.frameset.frame(:id => "MainLeft “）。ID

您的第二个解决方案不起作用的原因是因为它正在寻找 frame(FCCBMain) 的直接子级以具有“MainLeft”的 id。Frame(FCCBMain) 只有一个框架集子，框架集没有 ID。如果框架集的 ID 为“MainLeft”并且是框架（不是框架集），那么 browser.frame(:id => "FCCBMain").frame(:id => "MainLeft").id 行将工作。

# php - 验证用户时遇到问题

> ID：11974499
> 
> 赞同：1
> 
> 时间：2012-08-15T17:56:19.437
> 
> 标签：php, mysql

我在`$_SESSION`变量方面遇到了很多麻烦。我正在尝试为用户创建一种登录和注销方式。我可以登录用户，但切换页面时似乎无法维持会话。当用户正确登录时，他们将被带到`profile.php`. 但是，如果我返回`index.php`打印以下错误：

`Notice: Undefined index: login in /Applications/MAMP/htdocs/www/Shared sites/userlogreg/index.php on line 3`

我对此很陌生，但从 SO 和其他地方看，我似乎无法弄清楚。任何帮助，将不胜感激。

**索引.php**

```
<?php
session_start();
if ($_SESSION['login'] == 1) {
    echo "<h1>Logged in!</h1>"; 
} else {
    echo "<h1>Not logged in</h1><br/>";
}

?>
<!DOCTYPE HTML>
<html>
<head>
    <title>Index page</title>
</head>
<body>
    <h2>Login</h2>
    <form action="login.php" method="POST">
        <div>
            <label for="emailSignIn">Email:</label>
            <input type="email" name="email" placeholder="Email" required="required" />
        </div>
        <div>
            <label for="passwordSignIn">Password:</label>
            <input type="password" name="password" placeholder="Password" required="required" />
        </div>
        <input type="submit" name="submit" value="Sign in" />
    </form> 

    <h2>Register</h2>
    <form action="register.php" method="POST">
        <div>
            <label for="firstnameRegister">First name:</label>
            <input type="text" name="firstname" placeholder="First name" required="required" />
        </div>
        <div>
            <label for="lastnameRegister">Last name:</label>
            <input type="text" name="lastname" placeholder="Last name" required="required" />
        </div>
        <div>
            <label for="emailRegister">Email:</label>
            <input type="email" name="email" placeholder="Email" required="required" />
        </div>
        <div>
            <label for="passwordRegister">Password:</label>
            <input type="password" name="password" placeholder="Password" required="required">
        </div>
        <input type="submit" name="submit" value="Create account" />
    </form>

</body>

</html> 
```

**登录.php**

```
<?php

$email = sanitize_input($_POST['email']); //echo "Sanitized email: ".$email; echo "<br/>";
$password = $_POST['password']; //echo "Inputted password: ".$password; echo "<br/>";

if ((!isset($email)) || (!isset($password))) {
    // VISITOR NEEDS TO ENTER AN EMAIL AND PASSWORD
    //echo "Data not provided";
} else {
    // CONNECT TO MYSQL
    $mysql = mysqli_connect("localhost", "root", "root");
    if(!$mysql) {
    //echo "Cannot connect to PHPMyAdmin.";
    exit;
    } else {

    }
}
// SELECT THE APPROPRIATE DATABASE
$selected = mysqli_select_db($mysql, "languageapp");
if(!$selected) {
    //echo "Cannot select database.";
    exit;
} else {

}

// GET THE USER'S UNIQUE SALT FROM THE DATABASE
$unique_salt = mysqli_query($mysql, "select uniqueSalt from user where email = '".$email."'");
$row = mysqli_fetch_array($unique_salt);
//echo "Salt: ".$row['uniqueSalt']; echo "<br/>";

// HASH THE PASSWORD 
$iterations = 10;
$hashed_password = crypt($password,$row['uniqueSalt']); 
for ($i = 0; $i < $iterations; ++$i)
{
    $hashed_password = crypt($hashed_password . $password,$row['uniqueSalt']);
}

//echo "Password entered by user: ".$hashed_password; echo "<br/>";

$user_db_password = mysqli_query($mysql, "select password from user where email = '".$email."'");
$row = mysqli_fetch_array($user_db_password);
//echo "User's password: ".$row['password']; echo "<br/>";

// query the database to see if there is a record which matches
$query = "select count(*) from user where email = '".$email."' and password = '".$hashed_password."'";
$result = mysqli_query($mysql, $query);
if(!$result) {
    //echo "Cannot run query.";
    exit;
}

$row = mysqli_fetch_row($result);
$count = $row[0];

if ($count > 0) {
    session_start();
    $_SESSION['login'] = 1;
    $_SESSION['email'] = $email;
    $_SESSION['errors'] = "";
    header("location:profile.php");
    //echo "<h1>Login successful!</h1>";
    //echo "<p>Welcome.</p>";
    //echo "<p>This page is only visible when the correct details are provided.</p>";
} else {
    session_start();
    $_SESSION['login'] = '';
    header("location:index.php");
    //echo "<h1>Login unsuccessful!</h1>";
    //echo "<p>The email and password combination entered was not recognized</p>";
}

// CLEAN THE INPUT
function sanitize_input($data)
{
    $data = trim($data);
    $data = stripslashes($data);
    $data = htmlspecialchars($data);
    return $data;
}

?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T17:57:49.030

更改此行：

```
if ($_SESSION['login'] == 1) { 
```

..对此：

```
if (isset($_SESSION['login']) && $_SESSION['login'] == 1) { 
```

这样，您`'login'`在访问之前检查是否已设置。

# php - 使用 base64 预加载图像

> ID：11974502
> 
> 赞同：1
> 
> 时间：2012-08-15T17:56:30.107
> 
> 标签：php, javascript, animation, base64, preload

我为我的用户制作了一个“拖放”文件上传实用程序。我用 13 张 PMG 图片制作了一个上传进度条，并使用 jQuery 对其进行动画处理。如果用户只是同时删除一个或两个文件，那效果很好。但我注意到，如果用户删除了 10 个文件，浏览器会为每张图片发出请求（130 个请求）。有时浏览器会从缓存中获取这些图像，但有时不会。所以，我的解决方案是像这样预加载图像：

```
function preload()
{ 
    // create object
    imageObj = new Image();

    // set image list
    images = new Array();
    images[0]="img/ProgressBarContent.png";
    images[1]="img/ProgressbarEndEffect.png";
    images[2]="img/0.png";
    images[3]="img/1.png";
    images[4]="img/2.png";
    images[5]="img/3.png";
    images[6]="img/4.png";
    images[7]="img/5.png";
    images[8]="img/6.png";
    images[9]="img/7.png";
    images[10]="img/8.png";
    images[11]="img/9.png";
    images[12]="img/percentIcon.png";
    images[13]="img/ProgressBar.png";

    // start preloading
    for(var i = 0; i < images.length; i++) 
    {
        imageObj.src=images[i];

        if(i == (images.length-1))
        {
        //preloading done, give a visual feedback and droping functionality can be activated 
        hideLoadingOverlay();
        }     
     }
 } 
```

但这并没有什么不同。
所以我想我可以让 PHP 脚本读取我需要的图像，将它们编码为 base64 并将它们输出为 JavaScript 数组，如下所示：

```
$file= base64_encode( file_get_contents ( 'img/0.png') );
echo 'images["img/0.png"] = "data:image/png;base64,'.$file.'";'; 
```

这样我也可以将图像直接“硬编码”到我的 HTML 中，对吧？
我认为在 JavaScript 中我可以这样做：

```
$(".selector").attr("src", images['filename']); 
```

这是一个好的解决方案吗？还是有“正确”/更好的方法？

谢谢！

编辑：如果旧浏览器不支持这个也没关系。这些脚本用于管理区域，仅由我认识的人使用。（而且他们都有现代浏览器。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:02:49.340

IE 不支持 URI 方案（或者如果支持，`data`它是最近添加的）。

我会解决浏览器并不总是从缓存中获取图像的事实，因为它应该是。仔细检查您没有为某些调用使用 URI 的变体，然后检查发送的标头是否合适，并给出至少一个小时的 max-age，如果不是更多的话。

对于这种用途的图像，使用 pngslim 或类似的东西来刮掉将要发送的每个字节也不会受到伤害。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T18:01:15.023

一个更好的主意可能是确保您的 Web 服务器为您的图像发出正确的缓存标头，一旦您这样做，浏览器只会请求它们一次，并从缓存中拉取后续请求。如果您对配置缓存设置没有任何帮助，请随时使用您使用的 Web 服务器对此答案发表评论，我将编辑我的答案。

此外，您可以在页面加载时使用 javascript 预加载所有图像，以确保浏览器在需要显示它们时将它们缓存，如下所示：

```
var imageObj = new Image();
var images = new Array();
images[0]="image1.jpg"
images[1]="image2.jpg"
images[2]="image3.jpg"
images[3]="image4.jpg"

for(var i=0; i < images.length; i++) {
    imageObj.src=images[i];
} 
```

**编辑，在 apache2 中设置缓存**

您可以使用 .htaccess 文件在每个目录/每个文件的基础上配置这些设置，您可以在[此处](http://httpd.apache.org/docs/trunk/howto/htaccess.html)阅读更多信息。基本上，您要做的是在文档根目录中创建一个 .htaccess 文件，然后放入如下内容：

```
# cache images for 10 days
<FilesMatch "\.(ico|jpg|jpeg|png|gif)$">
  Header unset Pragma
  FileETag None
  Header unset ETag
  Header set Cache-Control "max-age=864000, public, must-revalidate"
  Header unset Last-Modified
</FilesMatch> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T18:43:22.690

最好的方法是创建一个精灵，所以如果图像是 10x10 并且您的动画中有 10 帧，您将创建一个 10x100 的精灵。

然后你做一个类，每个类偏移背景 10 个像素。不是为每一帧加载单独的图像，而是偏移相同的图像以创建动画。

我们情况下的 css 如下所示：

```
.sprite {
    background: url('/images/sprite.png');
    display: block;
    width: 10px;
    height: 10px;
}
.sprite.frame1 {
    background-position: 0 -10px;
}
.sprite.frame2 {
    background-position: 0 -20px;
}
... 
```

js 可能看起来像这样：

```
for (i=0;i!=11;i++) {
    document.getElementById("MyElement").className = "sprite frame" + i;
} 
```

你得到图片。即使屏幕上有 100 个动画，图像也只会加载一次。

# birt - Birt - 交叉表被夹在 PDF 上

> ID：11974504
> 
> 赞同：4
> 
> 时间：2012-08-15T17:56:46.227
> 
> 标签：birt

我的交叉表在 Web 查看器中看起来不错，但是当我导出为 PDF 时，它会像在图像中显示的那样对其进行剪辑。它还使列比它们需要的宽得多。（网络版没有这样做。）

有谁知道如何修理它？我试图寻找答案，但什么也没看到。![在此处输入图像描述](../Images/9f432504dabab6e01cad0e396635c22a.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T22:19:55.113

如果没有看到您传递给 RenderTask 的参数，很难准确判断，所以我猜测您已`PAGE_OVERFLOW`设置为`CLIP_CONTENT`而不是`FIT_TO_PAGE_SIZE`.

不过要注意。[Eclipse 论坛上的这个讨论](http://www.eclipse.org/forums/index.php/m/815848/)提到分页间隔设置可能会覆盖页面大小呈现选项。请注意，链接讨论中的 OP 对从 HTML 查看器导出的 PDF 有问题。

编辑：根据里面的文档，`genReport.sh`您可以在命令行（）上传递参数，`-p pageOverflow=FIT_TO_PAGE_SIZE`或者您可以创建参数文件（`-F params.txt`）

我不清楚您是否可以传递常量 ( `FIT_TO_PAGE_SIZE`) 或必须传递其预期值 ( `2`)，因此您可能必须同时尝试两者。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T12:42:54.860

我认为您已将报告的宽度/高度限制为
转到母版页，然后单击常规设置，然后在该类型下拉列表中选择自定义。
通过此自定义选项，您可以在报告布局中提供自己的报告高度/宽度。通过这样做，您可以扩展报告宽度

注意：母版页宽度应等于布局的宽度。

# vb.net - 使用后台工作器 (VB.NET) 更新控件

> ID：11974507
> 
> 赞同：1
> 
> 时间：2012-08-15T17:57:05.660
> 
> 标签：vb.net, multithreading, backgroundworker

我搜索了该站点并找到了类似的主题，但我的问题是该解释/解决方案目前有点超出我的技术理解。

我刚刚注意到 Visual Studio 中有一个“后台工作人员”，我正在使用它来登录我的数据库并保持 UI 正常运行（用于显示加载等的 GIF 图像）。

我遇到的问题是，一旦登录完成，我将更新一个标签以显示“登录完成”等。

我收到错误“跨线程操作无效”

如果可能的话，谁能告诉我一种可以通过后台工作器更新控件的方法，或者提供一个可以用作资源的源？

我以前从未使用过多线程，我理解问题的原因，但我不知道如何解决它。

谢谢你的时间！

汤姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:00:50.637

您必须在和事件的`BackgroundWorker`事件处理程序中更新您的显示。这将消除您遇到的跨线程问题。`ProgressChanged``RunWorkerCompleted`

```
Private Sub backgroundWorker1_RunWorkerCompleted(ByVal sender As System.Object, _
ByVal e As RunWorkerCompletedEventArgs) Handles backgroundWorker1.RunWorkerCompleted
    If e.Cancelled = True Then
        resultLabel.Text = "Canceled!"
    ElseIf e.Error IsNot Nothing Then
        resultLabel.Text = "Error: " & e.Error.Message
    Else
        resultLabel.Text = "Done!"
    End If
End Sub 
```

[http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx#Y2497](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx#Y2497)。

# c# - 为 Parallel.ForEach 和 Task.Factory.StartNew 中的每个项目记录异常

> ID：11974509
> 
> 赞同：1
> 
> 时间：2012-08-15T17:57:14.957
> 
> 标签：c#, task-parallel-library

我正在尝试对列表和列表中的每个项目使用 Parallel.ForEach，尝试进行数据库调用。我正在尝试记录每个项目是否有错误。只是想在这里与专家核对一下，如果我以正确的方式做事。对于此示例，我使用文件访问而不是数据库访问来模拟 I/O。

```
 static ConcurrentQueue<IdAndErrorMessage> queue = new ConcurrentQueue<IdAndErrorMessage>();
    private static void RunParallelForEach()
    {
      List<int> list = Enumerable.Range(1, 5).ToList<int>();
      Console.WriteLine("Start....");
      Stopwatch stopWatch = new Stopwatch();
      stopWatch.Start();
      Parallel.ForEach(list, (tempId) =>
      {
        string errorMessage = string.Empty;
        try
        {
          ComputeBoundOperationTest(tempId);
           try
           {
              Task[] task = new Task[1]
              {
               Task.Factory.StartNew(() =>  this.contentFactory.ContentFileUpdate(content, fileId))
              };
           }
           catch (Exception ex)
           {
              this.tableContentFileConversionInfoQueue.Enqueue(new ContentFileConversionInfo(fileId, ex.ToString()));
           }
        }
        catch (Exception ex)
        {
          errorMessage = ex.ToString();
        }
        if (queue.SingleOrDefault((IdAndErrorMessageObj) => IdAndErrorMessageObj.Id == tempId) == null)
        {
            queue.Enqueue(new IdAndErrorMessage(tempId, errorMessage));
        }
     }
     );
     Console.WriteLine("Stop....");
     Console.WriteLine("Total milliseconds :- " + stopWatch.ElapsedMilliseconds.ToString());
} 
```

以下是辅助方法：-

```
private static byte[] FileAccess(int id)
{
    if (id == 5)
    {
      throw new ApplicationException("This is some file access exception");
    }
     return File.ReadAllBytes(Directory.GetFiles(Environment.SystemDirectory).First());
            //return File.ReadAllBytes("Files/" + fileName + ".docx");
}

 private static void ComputeBoundOperationTest(int tempId)
 {
    //Console.WriteLine("Compute-bound operation started for :- " + tempId.ToString());
    if (tempId == 4)
    {
       throw new ApplicationException("Error thrown for id = 4 from compute-bound operation");
    }
    Thread.Sleep(20);
 }

 private static void EnumerateQueue(ConcurrentQueue<IdAndErrorMessage> queue)
 {
    Console.WriteLine("Enumerating the queue items :- ");
    foreach (var item in queue)
    {
      Console.WriteLine(item.Id.ToString() + (!string.IsNullOrWhiteSpace(item.ErrorMessage) ? item.ErrorMessage : "No error"));
    }
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T18:05:47.483

没有理由这样做：

```
/*Below task is I/O bound - so do this Async.*/
Task[] task = new Task[1]
{
    Task.Factory.StartNew(() => FileAccess(tempId))
};
Task.WaitAll(task); 
```

通过将其安排在一个单独的任务中，然后立即等待它，您只是占用了更多线程。您最好将其保留为：

```
/*Below task is I/O bound - but just call it.*/
FileAccess(tempId); 
```

话虽如此，鉴于您正在为*每个*项目创建一个记录值（异常或成功），您可能需要考虑将其写入一个方法，然后将整个事物作为 PLINQ 查询调用。

例如，如果您将其写入处理 try/catch（没有线程）的方法中，并返回“记录的字符串”，即：

```
string ProcessItem(int id) { // ... 
```

您可以将整个操作编写为：

```
var results = theIDs.AsParallel().Select(id => ProcessItem(id)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T18:53:37.380

You might want to remove `Console.WriteLine` from thread code. Reason being there can be only one console per windows app. So if two or more threads going to write parallel to console, one has to wait.

In replacement to your custom error queue you might want to see [.NET 4's Aggregate Exception](http://msdn.microsoft.com/en-us/library/system.aggregateexception%28v=vs.100%29.aspx) and catch that and process exceptions accordingly. The `InnerExceptions` propery will give you the necessary list of exceptions. More [here](http://msdn.microsoft.com/en-us/library/system.aggregateexception.innerexceptions.aspx)

And a general code review comment, don't use magic numbers like `4` in `if (tempId == 4)` Instead have some const defined which tells what 4 stands for. e.g. `if (tempId == Error.FileMissing)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T18:18:12.583

`Parallel.ForEach`最多同时运行一个动作/函数到一定数量的同时实例。如果这些迭代中的每一个在本质上都不是相互独立的，那么您就不会获得任何性能提升。而且，可能会通过引入昂贵的上下文切换和争用来降低性能。你说你想做一个“数据库调用”并用一个文件操作来模拟它。如果每次迭代都使用相同的资源（例如，数据库表中的同一行；或尝试写入同一位置的同一文件），那么它们实际上不会并行运行。一次只会运行一个，其他的将只是“等待”获取资源 - 不必要地使您的代码变得复杂。

您还没有详细说明每次迭代要做什么；但是当我和其他程序员遇到这样的情况时，他们几乎总是不会真正并行地做事情，他们只是简单地经历并替换`foreach`s 以`Parallel.ForEach`希望神奇地获得性能或神奇地利用多 CPU /核心处理器。

# nhibernate - nHibernate 命名查询、结果转换和带空格的列名

> ID：11974513
> 
> 赞同：1
> 
> 时间：2012-08-15T17:57:36.647
> 
> 标签：nhibernate, nhibernate-mapping, whitespace, named-query

我有一个命名的 nHibernate 查询，它返回自定义数据。所以我决定做一个bean类来封装数据。这是一些代码：

```
public IList<Report> GetReport(int reportId)
{
   return Session.GetNamedQuery("GetReport")
                 .SetParameter("Id", reportId)
                 .List<Report>();
}

public class Report
{
   public virtual string Id { get; set; }
   ...
   public virtual string CustomColumn { get; set; }
} 
```

和映射：

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" assembly="MyAssembly" 
namespace="MyAssembly.Model">
    <class name="Report" table="Report">
        <id name="Id" column="Id">
            <generator class="assigned"/>
        </id>
                ...
        <property column="`Custom column`" name="CustomColumn" />
    </class>

    <sql-query name="GetReport">
       <return class="Report"/>
       <query-param name="Id" type="int" />
       exec GetReport :Id
    </sql-query>
</hibernate-mapping> 
```

但是当我调用这个方法时，我遇到了一个异常：

NHibernate.Exceptions.GenericADOException：无法执行查询----> System.IndexOutOfRangeException：[自定义列]

帮助，有人吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T11:34:13.340

好的，我自己发现了问题。我想，我需要转义包含空格的列名，就像我对表名所做的那样。但显然我不应该。

这个语法很好。

```
<property column="Custom column" name="CustomColumn" /> 
```

# wordpress - Wordpress Walker_Nav_Menu 根据页面 id 在菜单中选择子元素

> ID：11974517
> 
> 赞同：1
> 
> 时间：2012-08-15T17:57:46.703
> 
> 标签：wordpress, menu

我很难通过[Walker_Nav_Menu 文档](http://phpdoc.wordpress.org/trunk/WordPress/Nav_Menus/Walker_Nav_Menu.html)工作。我想要一个助行器，它可以放置具有特定 id 元素的子元素，但我不确定从哪里开始。

我做了一些研究，但找不到任何基于页面 ID 的东西。有没有人有任何关于如何让它工作的链接或参考？

谢谢（你的）信息

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T19:13:46.450

**Solved!**

I was looking a it all wrong, i was trying to compare post ID instead of menu ID

here's my full walker, modified version of [Stephen Harris wp.tutsplus tutorial](http://wp.tutsplus.com/tutorials/creative-coding/understanding-the-walker-class/)

if you don't pass an menu item ID it resorts to the current posts tree.

```
<?php

/* Walker Class for selecting only current nav children.
 * Modified version of Stephen Harris class that adds in support for selecting based on menu_item_id
 *
 * @param int $menu_item_id ID of the menu item you want to select off of (optional)
 *
 * @author Jake Chamberlain
 * @link http://jchamb.com
 * @author Stephen Harris
 * @link http://wp.tutsplus.com/tutorials/creative-coding/understanding-the-walker-class/
 */

class Selective_Walker extends Walker_Nav_Menu
{
    var $menu_item;

    function __construct($menu_item_id = false) {

        $this->menu_item = $menu_item_id;
    }

    // Don't start the top level
    function start_lvl(&$output, $depth=0, $args=array()) {
        if( 0 == $depth )
            return;
        parent::start_lvl($output, $depth,$args);
    }

    // Don't end the top level
    function end_lvl(&$output, $depth=0, $args=array()) {
        if( 0 == $depth )
            return;
        parent::end_lvl($output, $depth,$args);
    }

    // Don't print top-level elements
    function start_el(&$output, $item, $depth=0, $args=array()) {
        if( 0 == $depth && !$this->menu_item )
            return;
        parent::start_el($output, $item, $depth, $args);
    }

    function end_el(&$output, $item, $depth=0, $args=array()) {
       if( 0 == $depth && !$this->menu_item )
          return;
        parent::end_el($output, $item, $depth, $args);
    }

    // Only follow down one branch
    function display_element( $element, &$children_elements, $max_depth, $depth=0, $args, &$output ) {

         // Check if element as a 'current element' class
         $current_element_markers = array( 'current-menu-item', 'current-menu-parent', 'current-menu-ancestor' );
         $current_class = array_intersect( $current_element_markers, $element->classes );

         if( !$this->menu_item)
         {                      
            // If element has a 'current' class, it is an ancestor of the current element
            $ancestor_of_current = !empty($current_class);       

            // If this is a top-level link and not the current, or ancestor of the current menu item - stop here.
            if ( 0 == $depth && !$ancestor_of_current)
                return;

            parent::display_element( $element, $children_elements, $max_depth, $depth, $args, $output );
         }
         else
         {       
            if ( $this->menu_item != $element->menu_item_parent )
                return;

             parent::display_element( $element, $children_elements, $max_depth, $depth, $args, $output );
         }
    }
} 
```

# java - 检测端口扫描

> ID：11974520
> 
> 赞同：0
> 
> 时间：2012-08-15T17:57:57.810
> 
> 标签：java, pcap, jnetpcap

我想通过分析 pcap 文件来检测是否进行了端口扫描。我无法理解正确的算法。会像一个源 ip 映射到不同的 IP 一样吗？这会被视为端口扫描吗？如果您能在这方面指导我，将不胜感激。我正在使用 jnetpcap 库在 java 中执行此操作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T19:07:49.407

首先，我不会在没有防火墙的情况下将我的电脑暴露在互联网上，在这种情况下就没有机会被扫描。

大多数路由器/防火墙可以告诉您它已被端口扫描。

如果要检测端口扫描，则需要在多个端口上的连接 IP 地址中查找模式。什么可以作为模式因端口扫描程序而异。即扫描仪故意采取措施避免检测，因此您不能说您可以寻找一种简单的模式。

# r - R ggplot2改变轴的单位

> ID：11974524
> 
> 赞同：2
> 
> 时间：2012-08-15T17:58:11.527
> 
> 标签：r, ggplot2

在谷歌搜索中找不到这个，所以我想我会在这里记录下来。

我的问题是我需要将我的 y 轴标签更改为基点，而不是标准单位，但我找不到解决这个简单问题的方法，我的情节是这样的：

```
p <- ggplot(plotdat, aes(x = name, y = value, fill = variable)) + 
      geom_bar(position = "dodge") 
```

但我一直在尝试使用这条线，但我一直收到错误消息。

```
p + scale_y_continuous(labels = function(x) as.character(x*10000), breaks = 10)
Error in as.vector(x, "character") : 
  cannot coerce type 'closure' to vector of type 'character' 
```

如何更改 y 轴刻度标签的格式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T17:58:11.527

要格式化轴刻度标签，请使用 中的`formatter`选项`scale_continuous`。所以：

```
p = p + scale_y_continuous(formatter = function(x) format(x*10000)) 
```

这应该给你基点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-04T05:24:22.187

这里[投票最多的答案](https://stackoverflow.com/a/11974525/6873133)有点过时，该`formatter`选项不再存在。它似乎已更新为`labels`。下面是一个之前和之后的最小示例演示。

```
# Load libraries
library(dplyr)   # CRAN v1.0.6
library(ggplot2) # CRAN v3.3.5
library(scales)  # CRAN v1.1.1

# Without transformation
iris %>%
    ggplot(aes(Sepal.Length, Sepal.Width)) +
    geom_point() 
```

![](../Images/3c8ae7dff2847503618a2ff104fade13.png)

```
# With transformation
iris %>%
    ggplot(aes(Sepal.Length, Sepal.Width)) +
    geom_point() +
    scale_y_continuous(labels = scales::label_comma(scale = 1000)) 
```

![](../Images/ff805170d72ad207d85eb3d4588261c5.png)

^(由[reprex 包](https://reprex.tidyverse.org)创建于 2022-02-03 (v2.0.1))

# python - 在 Python 中定义过程的基础知识？

> ID：11974531
> 
> 赞同：1
> 
> 时间：2012-08-15T17:58:34.537
> 
> 标签：python, procedures

嘿伙计们，我对 Python 很陌生，我正在学习这种编程语言。我正在使用 Python IDE (GUI) 来运行我的所有代码。我已经介绍了定义自定义过程的主题。但是在执行时它没有给出任何输出。

下面是我的代码。我想定义一个添加两个数字的过程，然后打印我输入的任何两个数字的结果。

```
def sum(a,b):
    print "The Sum Program"
    c = sum(10,14)
    print "If a is "+a+" and b is "+b++ then sum of the them is "+c 
```

你觉得我在这里做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T18:01:30.040

您在这里创建了一个无限循环；在`sum`方法中，您始终调用该`sum`方法。

您应该做的是将您的打印语句移到`sum`方法之外。该`sum`方法中的内容是`return`返回总和的语句。

所以，你的整个程序应该是这样的（编辑：添加`str()`调用，感谢@DSM）：

```
# The procedure declaration
def sum(a,b):
    return a+b

# Your output code
print "The Sum Program"
a = 10
b = 14
c = sum(a, b)
print "If a is "+str(a)+" and b is "+str(b)+" then sum of the them is "+str(c) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T18:03:45.520

您可能想尝试的一件事是调用您的函数（因为`sum`它是一个内置的 Python 函数，正如您似乎知道的那样，因为您也在使用它:)）。你可以这样做：

```
def my_sum(a, b):
    return a + b

print 'The Sum Program'
a = 10
b = 14
c = my_sum(a, b)
print ('If a is ' + str(a) + 
       ' and b is ' + str(b) + 
       ' then the sum of them is ' + str(c)) 
```

注意`str()`'s - 这用于将整数转换为字符串，以便它们可以连接到整个字符串中。有一些更优雅的方法可以做到这一点，但一次一步:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T18:02:26.987

```
def sum(a, b):
   print "The Sum Program"
   c = a + b
   print "If a is " + str(a) + " and b is " + str(b) + " then the sum of them is " + str(c)

# call it somewhere else with parameters:
sum(10, 14) 
```

不过，您应该将 IO 从计算中分离出来。

我推荐关于 Python 的 Wikibooks。但是有几个教程涵盖了基础知识等等。

# c# - 尝试从表格 2 中的数据表中获取信息并使用 C# 在表格 1 中设置文本框

> ID：11974533
> 
> 赞同：0
> 
> 时间：2012-08-15T17:58:37.110
> 
> 标签：c#, sql, forms, textbox, dialog

我有两个表格（表格 1 和表格 2），通过在对话框中填充数据网格视图，我成功地将数据表从表格 1 传递到表格 2。我还有一个事件处理程序来捕获选定行上的双击事件。当事件发生时，我想从表单 2 中的单击事件中设置表单 1 中的文本框。无论我尝试什么，我似乎都无法在文本框中显示文本。下面是我的代码：

```
 //Code begins here
    //....Function to fill data table from form 1 and pass to form 2
    private void buttonNewEntryLookUp_Click(object sender, EventArgs e)
    {

        try
        {
            cs.Open();
            da.SelectCommand = new SqlCommand("Select ctx_customername AS Customer, ctx_contactname AS Contact, ctx_custaddress1 AS Address, ctx_custcity AS City, ctx_custstate AS State, nno_custzip AS ZIP, ctx_custemail AS Email FROM Customers WHERE nno_custphone = '" + maskedTextBoxNewLogTel.Text + "'", cs);
            dt.Clear();
            da.Fill(dt);
        }
        catch
        {
            MessageBox.Show("Connection to Database could not be established, please close this application and try again. If problem continues please contact server Admin. Thank you.", "AAMP");
            //Display this message if connection could not be made
        }
        cs.Close();//close connection to db
        if (dt.Rows.Count == 0)//if there are no returned results then this must be a new entry into the database
        {
            MessageBox.Show("Phone Number Not Found in Database.", "AAMP");
        }
        else//number was found
        {
            Form2 form2 = new Form2(dt);//create object of form 2 and pass the data table.
            form2.ShowDialog();//show form 2 with data table in the grid view.

        }
    }
    public void getContactInfo(string[] contactInfo)
    {
        textBoxNewLogCustomerName.Text = contactInfo[0];
        textBoxNewLogContactName.Text = contactInfo[1];
        textBoxNewLogAddress.Text = contactInfo[2];
        textBoxNewLogCity.Text = contactInfo[3];
        textBoxNewLogState.Text = contactInfo[4];
        textBoxNewLogZIP.Text = contactInfo[5];
        textBoxNewLogEmail.Text = contactInfo[6];
    }

    //code for form 2
    public partial class Form2 : Form
{  
    /*Globals for Form 2*/
    DataTable g_dt;
    public Form2(DataTable dt)
    {
        InitializeComponent();
        dataGridViewLookUp.DataSource = dt;
        g_dt = dt;
    }

    private void dataGridViewLookUp_RowHeaderMouseDoubleClick(object sender, DataGridViewCellMouseEventArgs e)
    {
        Form1 form1 = new Form1();
        string[] contactInfo = new string[7];
        contactInfo[0] = Convert.ToString(g_dt.Rows[e.RowIndex]["Customer"]);
        contactInfo[1] = Convert.ToString(g_dt.Rows[e.RowIndex]["Contact"]);
        contactInfo[2] = Convert.ToString(g_dt.Rows[e.RowIndex]["Address"]);
        contactInfo[3] = Convert.ToString(g_dt.Rows[e.RowIndex]["City"]);
        contactInfo[4] = Convert.ToString(g_dt.Rows[e.RowIndex]["State"]);
        contactInfo[5] = Convert.ToString(g_dt.Rows[e.RowIndex]["ZIP"]);
        contactInfo[6] = Convert.ToString(g_dt.Rows[e.RowIndex]["Email"]);
        form1.getContactInfo(contactInfo);//return the row number being clicked.
        this.Close();

    }
} 
```

我成功地将数据表传递给表单 2 并捕获了正确的信息来填充字符串数组，但是当我通过调用 getContactInfo 函数将字符串数组传回时，我似乎无法使用数据设置我的文本框。有人可以请，请帮助！

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:58:06.130

您将数据表传递给 Form2 的构造函数：

```
Form2 form2 = new Form2(dt); 
```

您可以改为传递对整个 Form1 的引用：

```
Form2 form2 = new Form2(this); 
```

然后，在 Form1 上创建 Form2 可用于更新数据的公共方法。像这样的东西：

```
//In Form1
public DataTable getDataTable(){
  //return datatable
}

public void setTextBoxValue(string Value){
  //Set the value
} 
```

然后在 Form2

```
private Form1 _form1;

public Form2(Form1 form1){
  _form1 = form1;
  dataGridViewLookUp.DataSource = _form1.getDataTable();
  g_dt = dt;
}

private void dataGridViewLookUp_RowHeaderMouseDoubleClick(object sender, DataGridViewCellMouseEventArgs e)
{
  _form1.setTextBoxValue(Convert.ToString(g_dt.Rows[e.RowIndex]["Customer"]));
  //etc
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T18:46:30.943

你的 OP 有点含糊，但我有一些代码可以做到这一点，在表格 2 中获取一些数据并将其发送回表格 1。

这是来自form1的代码：

```
 private void btnGroupNameLookup_Click(object sender, EventArgs e)
    {
        //instantiate an instance of the grp name lookup form
        frmGroupNameLookup lookupName = new frmGroupNameLookup();
        //add an event handler to update THIS form when the lookup
        //form is updated. (This is when LookupUpdated fires
        lookupName.GroupNamesFound += new frmGroupNameLookup.LookupHandler(lookupName_GroupNamesFound);
        //rc.ReconCFUpdated += new ReconCaseFileChecklist.ReconCFListHandler(ReconCFForm_ButtonClicked);

        lookupName.Show();

    }

    void lookupName_GroupNamesFound(object sender, GroupNameLookupUpdateEventArgs e)
    {
        //update the list boxes here            
        foreach (string s in e.Parents)
        {
            lstFilteredGroupParents.Items.Add(s);
        }

        foreach (string s in e.Groups)
        {
            lstFilteredGroups.Items.Add(s);
            //link supgroups and plan ids
            GetFilteredSubgroupNos(s);
            GetFilteredPlanIds(s);
        }

        //ensure dupes are stripped out
        //filter out duplicates 
        var noDupeSubgroups = subgroupList.Distinct().ToList();
        noDupeSubgroups.Sort();

        foreach (string s in noDupeSubgroups)
        {
            lstFilteredSubgroups.Items.Add(s);
        }

        var noDupePlanIDs = planIDList.Distinct().ToList();
        noDupePlanIDs.Sort();

        foreach (string s in noDupePlanIDs)
        {
            lstFilteredPlanID.Items.Add(s);
        }

    } 
```

来自 Form2

```
public partial class frmGroupNameLookup : Form
{
    //add a delegate, the GroupNameLookupUpdateEventArgs class is defined at the bottom
    //of this file
    public delegate void LookupHandler(object sender, GroupNameLookupUpdateEventArgs e);

    //add an event of the delegate type
    public event LookupHandler GroupNamesFound;

    //this event closes the forms and passes 2 lists back to form 1
    private void btnCommit_Click(object sender, EventArgs e)
    {
        List<string> prnt = new List<string>();
        List<string> grp = new List<string>();
        //get selected rows
        if (grdLookup.SelectedRows.Count > 0)
        {

            foreach (DataGridViewRow row in grdLookup.SelectedRows)
            {
                prnt.Add(row.Cells[0].Value.ToString());
                grp.Add(row.Cells[1].Value.ToString());
            }

            //filter out duplicates 
            var noDupeParentGroups = prnt.Distinct().ToList();
            noDupeParentGroups.Sort();
            // instance the event args and pass it each value
            GroupNameLookupUpdateEventArgs args =
                new GroupNameLookupUpdateEventArgs(noDupeParentGroups, grp);

            // raise the event with the updated arguments
            this.GroupNamesFound(this, args);

            this.Dispose();
        }
    }
}

public class GroupNameLookupUpdateEventArgs : System.EventArgs
{
    // add local member variables to hold text
    private List<string> mParents = new List<string>();
    private List<string> mGroups = new List<string>();

    // class constructor
    public GroupNameLookupUpdateEventArgs(List<string> sParents, List<string> sGroups)
    {
        this.mParents = sParents;
        this.mGroups = sGroups;
    }

    // Properties - Viewable by each listener
    public List<string> Parents
    {
        get { return mParents; }
    }

    public List<string> Groups
    {
        get { return mGroups; }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T19:02:10.433

简单的。在 Form2 中将联系信息设为公开的方法，然后在 form1 中的 ShowDialog() 之后将其分配。

```
else//number was found  
        {  
            Form2 form2 = new Form2(dt);//create object of form 2 and pass the data table.  
            form2.ShowDialog();//show form 2 with data table in the grid view.  
            getContactInfo(form2.ContactInfoFromForm2);
        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T18:17:20.197

您是遇到错误还是数据没有显示。也许尝试`ToString()`方法中每个字符串数组索引后面的`getcontactinfo`方法。（即`contactInfo[0].ToString();`）

# firefox - Selenium Webdriver 测试期间的多个 Firefox 实例未正确处理焦点。

> ID：11974538
> 
> 赞同：8
> 
> 时间：2012-08-15T17:59:01.040
> 
> 标签：firefox, selenium, webdriver, ui-automation, selenium-webdriver

我注意到，在网格上并行运行多个 selenium firefox 测试时，焦点事件处理无法正常工作。我已经确认，当我的每个测试都单独运行并关注操作系统时，测试通过 100% 的时间。我还使用 Chrome 在网格上并行运行了测试，但没有发现问题。

我在 google groups 上发现了以下线程，这表明在单独的 xvfb 实例中启动每个浏览器可能是一个可行的解决方案。 [https://groups.google.com/forum/?fromgroups#!topic/selenium-developers/1cAmsYCp2ho%5B1-25%5D](https://groups.google.com/forum/?fromgroups#!topic/selenium-developers/1cAmsYCp2ho%5B1-25%5D)

测试失败的部分是由于项目中使用的 jquery 日期选择器。日期选择器在焦点事件上启动，并且由于同时执行多个 selenium 测试，因此 webdriver 测试执行 .click() 命令，但焦点没有保持足够长的时间以显示日期选择器小部件。

.focus(function(){ $input.trigger("focus"); });

*   jQuery 时间选择器插件
*   作者：特伦特理查森 [ [http://trentrichardson.com]](http://trentrichardson.com])

我的问题是，是否有人以前见过这个并通过一些 Firefox 配置文件设置解决了这个问题。我尝试加载以下对问题没有影响的属性。

```
profile.setAlwaysLoadNoFocusLib(true); 
```

测试失败的方式与之前在远程驱动程序 Firefox 配置文件中启用并加载该属性的方式相同。

我需要一种方法来确保 100% 的时间触发焦点事件，或者解决多个 Firefox 浏览器争夺焦点的问题。考虑到 Chrome 没有显示这些问题，我想知道它是否也可能被视为 Firefox 中的错误。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-15T19:42:11.600

@djangofan：错了。您无法锁定焦点。在您在一个窗口中请求焦点并触发操作之前，另一个窗口请求焦点，并且您的操作（例如将键发送到输入字段）不起作用。这在我们的测试中每天都会发生几次。很难重现，因为每次测试运行都会在不同的地方失败。一种解决方案是在单独的显示中执行每个浏览器。例如，您可以使用 Xvfb：

```
 Xvfb ... -screen 1 1200x800x24 -screen 2 1200x800x24 ... 
```

然后，当您启动浏览器时，为其分配一个单独的屏幕：

```
 browser.setEnvironmentProperty("DISPLAY", ":N.1");
  browser.setEnvironmentProperty("DISPLAY", ":N.2");
  ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-16T13:49:59.527

我在与 Jenkins 的持续集成环境中遇到了同样的问题。经过长时间的研究，我发现了[Firefox](https://bugzilla.mozilla.org/show_bug.cgi?id=566671)中的一个旧错误，它导致了一个[新的配置标志](https://bugzilla.mozilla.org/show_bug.cgi?id=704583)来避免这些问题。

解决方案是在测试使用的 firefox 配置文件上启用此标志。标志是**focusmanager.testmode**，将其设置为 true。

[![在此处输入图像描述](../Images/6729920ad6acf7cdb18db4d6f25dc5e4.png)](https://i.stack.imgur.com/Iyqee.png)

解释是只有在firefox窗口处于活动状态时才会触发焦点事件。如果您运行多个测试，则您有多个窗口，因此只有活动的一个会触发焦点事件。使用此参数，即使对于非活动窗口也会触发事件。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-06-25T23:14:26.353

您可以对此进行争论，并毫无问题地控制它。首先编写一个方法，通过其窗口句柄 id 来识别弹出窗口。然后，使用 JavaScriptExecutor 在 javascript 中执行“window.focus()”以强制窗口在您执行另一个操作之前聚焦。然后，如有必要，您可以通过其窗口句柄名称关闭弹出窗口。

# wix - 向项目添加新的自定义操作会阻止运行现有的自定义操作

> ID：11974539
> 
> 赞同：2
> 
> 时间：2012-08-15T17:59:07.673
> 
> 标签：wix, custom-action, wix3.6

我有一个自定义操作项目，其中包含我公司创建的安装程序使用的各种 CA，其中一些用于通过 Microsoft.Web.Administration API 操作 IIs7。

我在包含 IIs 相关 CA 的类中添加了一个名为 SetApplicationAutoStart 的新自定义操作。此自定义操作用于设置强制 II 预加载和启动 WCF 服务的 autoStart 属性，以缩短初始响应时间。

添加此操作后，名为 SetAppPoolLoadUserProfileTrue 的现有 CA 停止工作。这个 CA 强制站点上的设置为 true，即使计算机上的默认站点已更改，因此此设置为 false，所以我们确实需要它来工作。

当操作失败时，日志文件包含以下行。

```
MSI (s) (A0:18) [15:02:43:639]: Executing op: ActionStart(Name=SetAppPoolLoadUserProfileTrue,,)
Action 15:02:43: SetAppPoolLoadUserProfileTrue. 
MSI (s) (A0:18) [15:02:43:641]: Executing op: CustomActionSchedule(Action=SetAppPoolLoadUserProfileTrue,ActionType=3073,Source=BinaryData,Target=SetAppPoolLoadUserProfileTrue,CustomActionData=AppPoolName=xxxxx)
MSI (s) (A0:18) [15:02:43:670]: Creating MSIHANDLE (377) of type 790536 for thread 50712
MSI (s) (A0:C8) [15:02:43:670]: Invoking remote custom action. DLL: C:\Windows\Installer\MSIBD82.tmp, Entrypoint: SetAppPoolLoadUserProfileTrue
CustomAction SetAppPoolLoadUserProfileTrue returned actual error code 1154 (note this may not be 100% accurate if translation happened inside sandbox)
MSI (s) (A0:C8) [15:02:43:673]: Closing MSIHANDLE (377) of type 790536 for thread 50712
MSI (s) (A0:18) [15:02:43:674]: Note: 1: 1723 2: SetAppPoolLoadUserProfileTrue 3: SetAppPoolLoadUserProfileTrue 4: C:\Windows\Installer\MSIBD82.tmp 
Error 1723\. There is a problem with this Windows Installer package. A DLL required for this install to complete could not be run. Contact your support personnel or package vendor.  Action SetAppPoolLoadUserProfileTrue, entry: SetAppPoolLoadUserProfileTrue, library: C:\Windows\Installer\MSIBD82.tmp 
MSI (s) (A0:18) [15:20:25:139]: Product: xxxxxxx -- Error 1723\. There is a problem with this Windows Installer package. A DLL required for this install to complete could not be run. Contact your support personnel or package vendor.  Action SetAppPoolLoadUserProfileTrue, entry: SetAppPoolLoadUserProfileTrue, library: C:\Windows\Installer\MSIBD82.tmp 
Action ended 15:20:25: InstallFinalize. Return value 3. 
```

这看起来像是从 PE 中提取 dotnet PE 以执行此操作的问题。二进制文件中的所有其他 CA 都可以正常工作，包括新的 CA。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-04T15:00:48.467

我遇到了和你描述的**完全一样的症状。**WiX 工具集似乎有问题。我的 WiX tolset 版本是 3.8，而且我还有一个自定义操作，它不会运行，并且更改它的名称解决了这个问题。SFX 编译器只是简单地编译损坏的 DLL，而没有任何问题的迹象。更糟糕的是，在我的情况下，这是一个应该在 Result="ignore" 的情况下在卸载时运行的函数，所以在我运行实际安装程序后，我什至没有任何直接的迹象表明存在问题。

我尝试尝试了解名称的确切问题，但没有找到任何令人满意的解释。有问题的函数在源代码中的哪个位置似乎并不重要，它按字母顺序是什么（例如：函数成功，它按字母顺序在它之前和之后）。将 DLL 加载到depends.exe 表明存在导出，但尝试运行dll32 却找不到该导出。更改其名称可以解决问题。此外，有时您可以添加另一个功能，失败的功能会成功，但您刚刚添加的功能会失败。

以下是我为解决此问题所做的工作：我编写了一个 C++ 程序，它加载已编译的自定义操作并验证导出。然后我编写了一个单元测试，它验证了自定义操作中的所有导出。这显然不能解决问题，但至少您会遇到单元测试失败并且知道您的安装程序已损坏。如果您有兴趣，这里是 c++ 代码：

```
typedef int(__stdcall *CustomActionProc)(HANDLE);

int _tmain(int argc, _TCHAR* argv[])
{
    if (argc != 3)
    {
        _tprintf(_T("Parameters: DLL, EntryPoint\n"));
        return 1;
    }

    LPCTSTR dllName = argv[1];
    LPCTSTR entryPoint = argv[2];

    HMODULE hLib = LoadLibrary(dllName);
    if (hLib == NULL)
    {
        _tprintf(_T("Error loading %s\n"), dllName);
        return 1;
    }

    CustomActionProc procAddress = 
        (CustomActionProc) GetProcAddress(hLib, CStringA(entryPoint));
    if (procAddress == NULL)
    {
        _tprintf(_T("Error locating entrypoint %s\n"), entryPoint);
        return 1;
    }

    return 0;
} 
```

单元测试是：

```
 [TestMethod]
    public void TestCustomActionCanBeInvoked()
    {
        var asm1 = typeof(MyCustomActionsClass).Assembly;
        var methods = asm1.GetTypes().SelectMany(t =>
            t.GetMethods().Where(m => m.GetCustomAttributes(false)
                    .Where(a => a.GetType().Name == "CustomActionAttribute").Any()));

        var binFolder = (new FileInfo(this.GetType().Assembly.Location)).DirectoryName;
        var customActionsSfx = Path.Combine(binFolder, "MyCustomAction.CA.dll");
        var testMsiExport = Path.Combine(binFolder, "TestMsiExport.exe");

        foreach (var m in methods)
        {
            Trace.WriteLine("Method Name: " + m.Name);

            var p = Process.Start(new ProcessStartInfo()
            {
                FileName = testMsiExport,
                Arguments = "\"" + customActionsSfx + "\" " + m.Name,
                UseShellExecute = false,
                RedirectStandardOutput = true,
            });

            p.OutputDataReceived += (s, d) => Trace.WriteLine(d.Data);
            p.BeginOutputReadLine();
            p.WaitForExit();

            if (p.ExitCode != 0)
            {
                Assert.Fail("Bad Sfx export detected! Export name: " + m.Name);
            }
        }
    } 
```

希望这对我的情况有所帮助。试图确定这一点是非常令人沮丧的一天。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-14T03:23:39.357

同样的事情发生在我身上。“galets”已经指向正确的方向，让我走上正轨（没有代表支持，抱歉）。

简洁版本：

MakeSfxCA 生成不遵循 PE / COFF 规范的本机 dll，从而导致观察到的行为。

长版：

1.  构造一个CA，例如“HavocAction”，具有三个导出的入口点（即用“CustomAction”属性标记），命名为“HavocEntryPointa”、“HavocEntryPointB”、“HavocZappEntryPoint”（注意准确的拼写）。这些方法可能只返回“ActionResult.Success”。
2.  提出简单的设置，a) 仅调用“HavocEntryPointa”，b) 仅调用“HavocEntryPointB”
3.  ==> 设置“a)”将起作用，设置“b)”将失败
4.  取消注释“HavocZappEntryPoint”上的“CustomAction”属性，行为被反转，即
5.  ==> 设置“a)”将失败，设置“b)”将起作用

进一步的分析

当您转储包装的 CA.dll 文件时

转储/出口 HavocAction.CA.dll

你会得到类似的东西（摘录）

```
125   7C 00003A36 
126   7D 00003A4C HavocEntryPointa
127   7E 00003A62 HavocEntryPointB
128   7F 00003A78 HavocZappEntryPoint
129   80 000042FC zzzEmbeddedUIHandler
130   81 000043B8 zzzInitializeEmbeddedUI
131   82 0000467F zzzShutdownEmbeddedUI
132   83 00003AA5 zzzzInvokeManagedCustomActionOutOfProcW 
```

这是错误的（搜索“pecoff_v83.docx”，参见[未按词法排序的导出的 DLL 函数？](https://stackoverflow.com/questions/11107095)）。当从 dll 加载方法时（条目“HavocEntryPointa”和“HavocEntryPointB”互换），条目应该被排序（按 ASCII）以便进行二进制搜索。

我有根据的猜测是，当从 dll 加载代码时，二进制搜索失败，导致错误。由于二分搜索的性质，删除“HavocZappEntryPoint”会反转效果。

关于OP的备注

Kjartan首先使用了“SetApplicationAutoStart”和“SetAppPoolLoadUserProfileTrue”，由于排序错误，没有正确导出到CA.dll；大写字母“P”出现在小写字母“l”之前，但这已被 MakeSfxCA 互换。他的后一个选择“ConfigureApplicationAutoStart”和“SetAppPoolLoadUserProfileTrue”是按照 PE / COFF 规范排序的。

PS：现在是[http://wixtoolset.org/issues/4502](http://wixtoolset.org/issues/4502)。

**更新**

PPS：从 WiX 3.9 RC3 版本开始，包含此问题的错误修复；一切都按预期工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T18:01:12.900

这实际上很奇怪，但是经过很长时间寻找答案并尝试了很多不同的事情后，我尝试将新 CA 的名称从 SetApplicationAutoStart 更改为 ConfigureApplicationAutoStart 并导致 SetAppPoolLoadUserProfileTrue 再次开始正常工作

# list - 灯开关选择列表

> ID：11974541
> 
> 赞同：2
> 
> 时间：2012-08-15T17:59:17.390
> 
> 标签：list, visual-studio-lightswitch, choice

当我们将一个字段配置为选择列表并设置一些初始值时，它们存储在哪里？我知道我们可以通过使用单独的表格将它们配置为动态列表。我试图了解静态列表会发生什么。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T01:44:35.727

选择列表数据存储在*lsml*文件中，这就是为什么它只是**非常**静态数据的合理选项。

要添加/删除值，开发人员必须进行更改并重新部署整个应用程序。

这对你想知道的有帮助吗？

# jsf - JSF-2 自定义标签更改子元素的 styleClass

> ID：11974542
> 
> 赞同：0
> 
> 时间：2012-08-15T17:59:21.023
> 
> 标签：jsf, jsf-2, tags

我使用 JSF 2。我需要编写一个自定义标签来更改其中消息的样式类。所以如果我有这样的代码：

```
<my:errorGrid errorClass="#{richBean.erClass}" >
   <my:inputField id="pid1" value="#{richBean.pid}" fsType="pid">
   </my:inputField>

  <h:message for="pid1" ajaxRendered="true"/>

</my:errorGrid> 
```

错误消息应与附加样式类一起输出。此 styleClass 的名称取自自定义标签**my:errorGrid的属性***errorClass*

 **据我了解，我需要在模板中使用**vcp:body**标记并在*encodeChildren()*方法中处理子项。拜托，谁能给我一些提示如何实现它？也许一些建议或链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:15:42.837

为什么不使用复合组件？

**错误网格.xhtml**

```
<composite:interface>
    <composite:attribute name="errorClass"/>
</composite:interface>

<composite:implementation>
    <my:inputField id="pid1" value="#{richBean.pid}" fsType="pid">
    </my:inputField>

    <h:message for="pid1" ajaxRendered="true" errorClass="#{cc.attrs.errorClass}"/>
</composite:implementation> 
```

如果你有一个经典组件，你只需要`HtmlMessage.setErrorClass()`在渲染之前调用你的错误类。例如：

```
for (UIComponent child : getChildren()){
    if(child instanceof HtmlMessage) {
        HtmlMessage msgComp = (HtmlMessage) child;
        msgComp.setErrorClass(getErrorClass());
    }
} 
```**

# python - 在 Python 中通过引用传递

> ID：11974543
> 
> 赞同：-1
> 
> 时间：2012-08-15T17:59:22.243
> 
> 标签：python, pass-by-reference

我有两个代码用于将参数传递给 Python 中的函数。1-

```
def changeme( mylist ):
   mylist.append([1,2,3,4]);
   print "Values inside the function: ", mylist
   return

mylist = [10,20,30];
changeme( mylist );
print "Values outside the function: ", mylist 
```

2-

```
def changeme( mylist ):
   mylist = [1,2,3,4]; 
   print "Values inside the function: ", mylist
   return

mylist = [10,20,30];
changeme( mylist );
print "Values outside the function: ", mylist 
```

为什么在第一个代码中 mylist 是通过引用传递的，而在第二个代码中它是通过值传递的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T18:01:38.763

在第一个示例中，您将信息附加到传入的列表中。在第二个示例中，您`mylist`在返回之前重新分配本地值。两者不是在做同样的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T18:05:30.603

您需要意识到 python 中的赋值不会对左侧的对象进行操作。赋值在右侧创建对对象的新引用，并将该引用存储在左侧的名称中。因此，在您的第一个示例中，您更改了输入的列表，稍后您会看到该更改。在第二个示例中，在您的函数中，您创建一个对列表（在右侧创建）的新引用并将其绑定到本地（到函数）变量`mylist`。因此`mylist`不再引用您输入到函数的对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T18:01:58.733

这是因为您在函数 2 中将 mylist 分配给了其他对象：

在python中，如果你将一个可变对象传递给一个函数，那么它被称为通过引用传递，如果你传递一个不可变对象，那么它被称为按值传递。

```
mylist = [1,2,3,4]

def changeme( mylist ):
   print (id(mylist))  #prints 180902348

   #at this point the local variable mylist points to [10,20,30] 
   mylist = [1,2,3,4];  #this reassignment changes the local mylist, 

   #now local mylist points to [1,2,3,4], while global mylist still points to [10,20,30] 
   print (id(mylist)) #prints 180938508 #it means both are different objects now 

   print ("Values inside the function: ", mylist)
   return

mylist = [10,20,30];
changeme( mylist );
print ("Values outside the function: ", mylist) 
```

第一：

```
def changeme( mylist ):
   print (id(mylist))      #prints 180902348

   mylist.append([1,2,3,4]);  #by this it mean [10,20,30].append([1,2,3,4])
   #mylist is just a label pointing to [10,20,30]
   print (id(mylist))       #prints 180902348  , both point to same object
   print ("Values inside the function: ", mylist)
   return

mylist = [10,20,30];
changeme( mylist );
print ("Values outside the function: ", mylist) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-15T18:07:46.113

修改对象和将名称重新分配给不同的对象是有区别的。对代码进行简单的更改，它可以始终如一地工作，因为现在它正在修改原始对象：

```
def changeme( mylist ):
   mylist[:] = [1,2,3,4]; 
   print "Values inside the function: ", mylist 
```

`return`PS除非您返回一个值，否则函数末尾不需要a 。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-15T18:45:32.223

Python 具有**按值传递的**语义。总是。对象不是 Python 中的值。语言中的所有值都是引用（又名指针）。对象总是通过引用来操作的。人们为此提出了不同的名称，但无论他们如何称呼它，他们所描述的在语义上都等同于通过对象引用的值传递。

每当您传递或分配时，都会复制值（引用）。这意味着被调用的函数有自己的参数副本（这是一个引用）。因此分配给这个变量对调用者没有影响。绝不。

在您的第一个代码中，您没有分配给参数。相反，您通过它指向的对象上的引用来调用方法。此方法修改对象。因此，当然，任何其他拥有指向同一对象的引用的人都会看到它。

# java - 在 JSF 页面设置“全局”访问的“局部”变量

> ID：11974546
> 
> 赞同：0
> 
> 时间：2012-08-15T17:59:27.297
> 
> 标签：java, jsf, jsf-2, primefaces

我有以下情况：

有一个JSF页面：

```
<h:form id="form">

            <!-- MENU SHOULD GOES HERE -->
            <p:commandButton action="#{bean.sched.addWeek}" value="Add week" update="weeksTab" />

            <p:tabView id="weeksTab" value="#{bean.sched.weekList}" var="week" >

                <p:tab title="#{week.name}" >

                    <!-- THIS BUTTONS SHOULD BE IN MENU -->
                    <p:commandButton action="#{week.addDay}" value="Add day" update="weeksTab" />
                    <p:commandButton action="#{bean.sched.removeWeek(week)}" value="Remove week" update="weeksTab" />

                    <p:tabView id="daysTab" value="#{week.dayList}" var="day" >
                        <p:tab title="#{day.name}">

                        <!-- THIS BUTTON SHOULD BE IN MENU -->
                        <p:commandButton action="#{week.removeDay(day)}" value="Remove day" update="weeksTab" />

                        <!-- PROCESSING DAY : ADDING MEETINGS, ROUTINES ETC.
                            THOSE FUNCTIONS SHOULD BE ALSO AVAILABLE
                            IN MENU -->

                        </p:tab>
                    </p:tabView>
                </p:tab>
            </p:tabView> 
```

我想将所有操作控件（例如添加/删除/编辑周、天和用户的每日活动按钮）放在页面顶部的菜单中。问题是如何传递给 p:tabView 内部管理的外部标签变量？有可能吗？我在 h:form 中添加这样的东西：

```
<p:toolbar>
                <p:toolbarGroup align="left">
                    <p:commandButton
                        onclick="jQuery('#hiddenAddWeekButton').click();return false;"
                        value="Add week" icon="ui-icon-circle-plus" ajax="false" />

                </p:toolbarGroup>
            </p:toolbar>

            <p:commandButton id="hiddenAddWeekButton"
                action="#{bean.sched.addWeek}" value="add week"
                update="weeksTab" style="display:none" /> 
```

但它仍然无法正常工作..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:07:13.567

尝试这样的事情

隐藏你的内部按钮

```
<p:commandButton id="myHiddenButton" action="#{week.removeDay(day)}" value="Remove day" update="weeksTab" style="display:none"/> 
```

而不是在选项卡上方放置新按钮

```
<p:commandButton value="Remove day" onclick="jQuery('#weeksTab\\:myHiddenButton').click();return false;" /> 
```

要确定为隐藏按钮生成的正确 ID，只需在浏览器中查看源代码，我认为它应该类似于 weekTab:myHiddenButton （使用 \:) 来逃避：

* * *

**更新**

由于它位于选项卡中，您应该尝试使用带有选择器的结尾，就像这样

```
<p:commandButton value="Remove day" onclick="myJsFunctionThatSitsInMyJsFile();return false;" /> 
```

在哪里`myJsFunctionThatSitsInMyJsFile`

如下

```
function myJsFunctionThatSitsInMyJsFile(){
    jQuery('input[id$="hiddenAddDayButton"]:visible').click(); //added visible selector , so the only button that being visible , should be clicked
} 
```

# php - PHP 简单的 HTML DOM 在外部主机上不起作用

> ID：11974554
> 
> 赞同：-1
> 
> 时间：2012-08-15T18:00:27.483
> 
> 标签：php, html, parsing, dom

我开发了一个在我自己的本地 Apache 上运行良好的代码，但是一旦我传输了文件，它就停止了工作。没有错误信息，页面是空白的！

我正在使用 HostGator，我联系了他们的支持，他们非常无用！并且几乎告诉我我一个人。我很确定代码没问题，我的代码中的所有链接和配置也都经过验证，所以我很确定 hostgator 有问题。

我在 ezConfig 中检查了“allow_url_fopen”，它是 ON.. 你们有什么可以帮助我的吗？！有人有同样的问题吗？！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:02:22.320

您确定您主机上的php版本与本地相同吗？

# javascript - 在拖动过程中释放鼠标时忽略 JavaScript mouseUp 事件

> ID：11974556
> 
> 赞同：2
> 
> 时间：2012-08-15T18:00:35.580
> 
> 标签：javascript, html, dom-events, mouseevent

我有一个`<div>`在我的脚本中创建并附加到另一个`<div>`. 我有：

```
 coverElm.onmousedown = mouseDownEventHandeler;
 document.onmouseup = mouseUpEventHandeler;
 document.onmousemove = mouseMoveEventHandeler; 
```

我定义了函数并且工作得很好，并跟踪鼠标是否用 boolean 关闭`mouseDown`。

**问题**- 当鼠标被按下并被释放时，`document.onmouseup`它永远不会被处理。我认为这是因为它对`<div>`女巫中的任何东西的拖累只是几句话。我也有这个没有文字的问题。

所以我正在寻找一种防止这种奇怪的拖动行为的方法，或者`onmousedrag`查看鼠标是否被按下的方法 -**不使用鼠标向上和鼠标向下方法**

这是我的功能：

```
function mouseUpEventHandeler(e) {
        mouseDown = false;
}
function mouseDownEventHandeler(e) {
        mouseDown = true;
}
function mouseMoveEventHandeler(e) {
        if (mouseDown) {
               coverElm.innerHTML ="<p>Mouse down and dragging</p>";
        }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T18:09:49.190

90% 的情况下，这是因为被拖动的元素位于带有事件侦听器的元素的前面`mouseup`，所以下面的父元素永远不会收到事件。

通常，这可以通过使用`addEventListener`而不是事件的内联形式来解决。解决此问题的另一种方法是在`eventListener`释放鼠标时为拖动的元素提供一个 for 。此外，`div`只要元素开始拖动（通过`zIndex`属性），您就可以将它放在所有其他元素的前面。

编辑：我编写了一些概念验证代码：http: [//jsfiddle.net/2BkEM/5/](http://jsfiddle.net/2BkEM/5/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T18:45:57.270

```
$j(divID).bind('dragstart', function (event) { event.preventDefault() }); 
```

谢谢大家

# c# - C# Getter-Setter 竞争条件

> ID：11974560
> 
> 赞同：2
> 
> 时间：2012-08-15T18:00:50.777
> 
> 标签：c#, multithreading, exception, runtime, race-condition

假设我有两个线程，线程 A 和线程 B。在 C# 中，当线程 A 将一个对象（称为对象 X）设置为一个值并且线程 B 出现并尝试在线程设置该对象时获取该对象时会发生什么一种？C# 会抛出异常，B 会在 A 对其进行更改之前接收对象 X，还是 B 会在 A 对其进行更改后接收对象 X？

我认为这很清楚，但这里是代码（即使添加了同步，我仍然不能 100% 确定这会导致我上面提到的确切情况发生）：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Threading;

namespace WindowsFormsApplication8 {
    public partial class Form1 : Form {
        private AutoResetEvent waitEvent = new AutoResetEvent(false);
        int objectX = 0;

        public Form1() {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e) {
            DateTime startTime = DateTime.Now;
            Console.WriteLine("---------------------------- START @ " + startTime + " ----------------------------------------------------------------------");
            Thread A = new Thread(ThreadAWorkMethod);
            Thread B = new Thread(ThreadBWorkMethod);
            objectX = 0;
            waitEvent = new AutoResetEvent(false);
            A.Start();
            B.Start();
            A.Join();
            B.Join();
            Console.WriteLine("---------------------------- FINISHED AFTER " + (DateTime.Now - startTime).TotalMilliseconds + " ----------------------------");
        }

        public void ThreadAWorkMethod() {
            waitEvent.WaitOne();
            objectX = 5;
            Console.WriteLine("Value has been changed to: " + objectX + " in thread A at " + DateTime.Now);
            return;
        }

        public void ThreadBWorkMethod() {
            waitEvent.Set();
            string xInThreadB = objectX.ToString();
            Console.WriteLine("Value in thread B: " + xInThreadB + " at " + DateTime.Now);
            return;
        }
    }
} 
```

线程 B 到控制台的输出看起来是 0 或 5，但即使通过检查 DateTime，您仍然不能确定哪个线程首先得到服务，因为两个线程将具有相同的时间戳......并且一个输出总是使它首先到控制台，所以谁说哪个先得到服务，以及线程是否真的在 get-set 上发生了冲突。因此，最终似乎正如某些人所提到的，锁定是从较低的框架级别对 C# 中的变量实现的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T18:09:53.083

> C#会抛出异常吗

不，它可能不会。运行时中没有任何东西会自动检查这种情况并引发异常。

但是，此时设置的“值”可能会或可能不会处于有效状态，因此一旦*使用*结果，无论使用该值的任何内容都可能很容易引发异常。

> B 会在 A 对其进行更改之前接收对象 X，还是 B 会在 A 对其进行更改之后接收对象 X？

任何一个都是可能的。根据“对象”的类型，B 也有可能收到处于无效状态的对象。

如果您知道多个线程将访问一个值，则应始终注意同步对您的属性的访问。同步有很多选项，从使用（相对）简单的[`lock`语句](http://msdn.microsoft.com/en-us/library/c5kehkcz%28v=vs.100%29.aspx)到其他更复杂的同步选项（例如`ReaderWriterLock`/ `ReaderWriterLockSlim`、`Mutex`、`Semaphore`等）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T18:09:19.900

那么，像这样的事情？

```
public class Test
{
    public Test()
    {
        DateTime now = DateTime.Now;
        Debug.WriteLine("Test started.");
        A.Start();
        B.Start();
        A.Join();
        B.Join();
        Debug.WriteLine("Total time, in milliseconds, that you just spent in order to save StackOverflow members several minutes of their time: " + (DateTime.Now - now).TotalMilliseconds + " :)");
    }

    int objectX = 0;

    Thread A = new Thread(ThreadAWorkMethod);
    Thread B = new Thread(ThreadBWorkMethod);

    public void ThreadAWorkMethod()
    {
        objectX = 5;
        Debug.WriteLine("Value has been changed to: " + objectX.ToString() + "at " DateTime.Now.Milliseconds);
        return;
    }
    public void ThreadBWorkMethod()
    {
        string xInThreadB = objectX.ToString();
        Debug.WriteLine("Value in thread b: " + xInThreadB + "at " DateTime.Now.Milliseconds);
        return;
    }
} 
```

不知道，试试看：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T18:09:23.760

可能与[C# Threading: a race condition example](https://stackoverflow.com/questions/1315835/c-sharp-threading-a-race-condition-example)类似的问题。

PS：这就是.NET Framework 中有`lock`and的原因。`mutex`

# objective-c - MPMoviePlayerController 全屏不工作

> ID：11974565
> 
> 赞同：1
> 
> 时间：2012-08-15T18:01:12.540
> 
> 标签：objective-c, ios, mpmovieplayercontroller, fullscreen

我的代码可以正确播放视频，但不能全屏播放。

```
-----------  
|_______  |  
|XXXXXXX| |  
|XXXXXXX| |    
----------- 
```

它的大小大约是 X 字段区域的大小。
我在 ipad2 上运行它。

```
 NSString *urlStr = [[NSBundle mainBundle] pathForResource:@"movie.mp4" ofType:nil];
    NSURL *url = [NSURL fileURLWithPath:urlStr];
    videoPlayer = [[MPMoviePlayerController alloc] initWithContentURL:url];
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(movieFinishedCallback:)
                                                 name:MPMoviePlayerPlaybackDidFinishNotification
                                               object:videoPlayer];
    [self.view addSubview:videoPlayer.view];
    [videoPlayer setFullscreen:YES];
    videoPlayer.view.frame = [[UIScreen mainScreen] bounds];  
    [videoPlayer play];    
    [super viewDidLoad]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T18:03:19.510

将您的框架设置`MPMoviePlayerController`为 1024x768。

```
videoPlayer.view.frame = CGRectMake(0,0,1024,768); //748 if you have status bar. 
```

希望这就是你要找的。*编辑：试试这种方式，这是我使用的一种。

```
UIView *tempView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 1024, 768)];
[self.view addSubview:tempView];

playerViewController = [[MPMoviePlayerViewController alloc] initWithContentURL:[NSURL URLWithString:@"www.orangebob.com/files/movie.mp4"]];

[[NSNotificationCenter defaultCenter]
 addObserver:self
 selector:@selector(movieFinishedCallback:)
 name:MPMoviePlayerPlaybackDidFinishNotification
 object:[playerViewController moviePlayer]];

playerViewController.view.frame = CGRectMake(0, 0, 1024, 768);
[tempView addSubview:playerViewController.view]; //This *fixes* it, but it's kinda dirty.

MPMoviePlayerController *player = [playerViewController moviePlayer];

[player play]; 
```

# mysql - 尝试在 MySQL 中加入 3 个表

> ID：11974568
> 
> 赞同：0
> 
> 时间：2012-08-15T18:01:16.470
> 
> 标签：mysql, sql, join

我有三个连接的表。我几乎有了解决方案，但这里似乎出现了一个小问题。这是声明：

```
SELECT items.item,
COUNT(ratings.item_id) AS total,
COUNT(comments.item_id) AS comments,
AVG(ratings.rating) AS rate
FROM `items`
LEFT JOIN ratings ON (ratings.item_id = items.items_id)
LEFT JOIN comments ON (comments.item_id = items.items_id)
WHERE items.cat_id = '{$cat_id}'  AND items.spam < 5
GROUP BY items_id ORDER BY TRIM(LEADING 'The ' FROM items.item) ASC;"); 
```

我有一个名为 items 的表，每个项目都有一个名为 items_id 的 id（注意它是复数）。我有每个项目的个人用户评论表，以及每个项目的评分表。（最后两个有一个名为“item_id”的对应列）。

我只是想分别计算评论和评分总数（每项）。以我上面的 SQL 语句的方式，它们是一个总数。

*   注意，total 是评分的总和。这是一个糟糕的命名方案，我需要修复！

更新：“总计”似乎算不错，但是当我向“评论”表添加评论时，COUNT 函数会影响“评论”和“总计”，并且似乎等于组合输出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:19:04.170

问题是您正在计算所有 3 个加入的表的结果。尝试：

```
SELECT i.item,
r.ratetotal AS total,
c.commtotal AS comments,
r.rateav AS rate
FROM items AS i
LEFT JOIN
    (SELECT item_id, 
    COUNT(item_id) AS ratetotal, 
    AVG(rating) AS rateav 
    FROM ratings GROUP BY item_id) AS r 
ON r.item_id = i.items_id
LEFT JOIN
    (SELECT item_id, 
    COUNT(item_id) AS commtotal 
    FROM comments GROUP BY item_id) AS c
ON c.item_id = i.items_id
WHERE i.cat_id = '{$cat_id}'  AND i.spam < 5
ORDER BY TRIM(LEADING 'The ' FROM i.item) ASC;"); 
```

在这个查询中，我们让子查询正确地进行计数，然后将该值发送到主查询并过滤结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T18:19:30.083

我猜这是一个基数问题。尝试`COUNT(distinct comments.item_id)`

# git - 使用 shell 脚本自动化 git 提交和 ssh apache 服务器部署？

> ID：11974574
> 
> 赞同：0
> 
> 时间：2012-08-15T18:01:46.503
> 
> 标签：git, apache, shell, ssh

我试图弄清楚如何使用脚本来自动化这个过程。

我不知道我会使用什么，也不知道该怎么做。我正在寻找正确的方向。

**在 git 中：**

```
git commit -am "my commit"
git pull origin my_branch
git push origin my_branch
git archive --format zip --output /c/git/(environment)_(date)_(commithash).zip my_branch
scp (environment)_(date)_(hash).zip root@12.3.4.56:/var/www/html-(domain)
password123 
```

**在 apache 中：（**通常我在...中使用腻子）

```
root
password123
cd /var/www/html-(domain)/(environment)
unzip ../(environment)_(date)_(commithash).zip
n
n
A
cd ..
cp -pr (environment) (environment)_(date)_(commithash)
exit 
```

为了解释发生了什么，我正在推送我的最新提交，SCPing 到 apache 服务器 docroot，部署并使用提交哈希进行备份。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:12:32.210

您可以按照计划使用 shell 脚本——只需将要运行的命令（每行一个）保存在文件中，`#!/bin/bash`在顶部添加，使其可执行`chmod +x myscript.sh`（`.sh`不需要文件扩展名），然后运行它与`./myscript.sh`.

您可能会发现使用专门协助部署的脚手架更容易。其中一个使用 shell 脚本的漂亮系统（我还没有尝试过）是[`deliver`](https://github.com/gerhard/deliver).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T22:13:58.517

[您正在朝着持续集成](http://www.martinfowler.com/articles/continuousIntegration.html)迈出第一步。

我使用我设置的[Jenkins ：](http://jenkins-ci.org/)

*   git pull 起源大师
*   运行单元测试
*   部署代码
*   运行数据库部署
*   成功/失败更新票证系统

还有很多扩展和工具，适用于任何语言等。

# c++ - boost ptr_vector 迭代器

> ID：11974576
> 
> 赞同：1
> 
> 时间：2012-08-15T18:01:58.390
> 
> 标签：c++, algorithm, boost, tree, ptr-vector

我正在遍历树节点的子节点。孩子们存储在 ptr_vector 中，在整个迭代过程中的某个时刻，我陷入了无限递归，但我不知道为什么。

这是发生无限递归的方法（该方法仅用于将树结构打印到 中`cout`）：

```
std::ostream& operator<<(std::ostream &strm, const node &n) {
    if (n.children_.empty())
        return strm << "[]";

    for (boost::ptr_vector<node::edge>::const_iterator iter = n.children_.begin(); iter != n.children_.end(); ++iter)
    {
        if (iter != n.children_.begin())
            strm << ", ";
        strm << "-" << iter->distance << "->[ " << *(iter->dest) << "]";
    }

    return strm;
} 
```

这是我正在导航的树结构（请注意，嵌套的目的`edge`是表示父节点和子节点之间的距离）：

```
class node
{
public:
    node(void);
    ~node(void);

    node* add_child(unsigned int d);
    node* get_closest(void);

    friend std::ostream& operator<<(std::ostream&, const node&);

private:
    class edge
    {
    public:
        edge(node* n, unsigned int d);
        ~edge(void);

        unsigned int distance;
        node* dest;
    };

    boost::ptr_vector<edge> children_;
}; 
```

此外，我注意到这种无限递归仅在调用以下方法后发生：

```
node* node::get_closest(void) const
{
    if (children_.empty())
        return NULL;

    boost::ptr_vector<node::edge>::const_iterator iter = children_.begin();
    node::edge closest = *iter;
    ++iter;

    if (iter != children_.end())
    {
        for (; iter != children_.end(); ++iter)
        {
            if (iter->distance < closest.distance)
                closest = *iter;
        }
    }

    return closest.dest;
} 
```

为什么这种方法会导致无限递归？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T19:14:04.573

根据@RobI 的建议，原始指针和共享指针的混合导致了问题。我`node::edge closest = *iter;`改为`const node::edge* closest = &(*iter);`. 这是该方法的新（和工作）版本：

```
node* node::get_closest(void) const
{
    if (children_.empty())
        return NULL;

    boost::ptr_vector<node::edge>::const_iterator iter = children_.begin();
    const node::edge* closest = &(*iter);
    ++iter;

    if (iter != children_.end())
    {
        for (; iter != children_.end(); ++iter)
        {
            if (iter->distance < closest->distance)
                closest = &(*iter);
        }
    }

    return closest->dest;
} 
```

# javascript - 在页面加载时触发 jQuery

> ID：11974585
> 
> 赞同：0
> 
> 时间：2012-08-15T18:02:27.923
> 
> 标签：javascript, jquery, ruby-on-rails-3, coffeescript

2012 年 8 月 18 日更新：有什么方法可以让以下问题更容易回答？

我在 js.coffee 文件中有以下代码，它适用于向表单添加衬里。我希望它在加载时自动添加第一行，但不知道如何让它做到这一点......

```
$('form').on 'click', '.add_fields', (event) ->
 time = new Date().getTime()
 regexp = new RegExp($(this).data('id'), 'g')
 $(this).before($(this).data('fields').replace(regexp, time))
 event.preventDefault() 
```

（如果这看起来很熟悉，它是从[Ryan Bates 的 Railscast #196 修订](http://railscasts.com/episodes/196-nested-model-form-revised)中逐字窃取的）

更新：我尝试了@Baldrick 的以下建议，但仍然没有骰子：

```
jQuery ->
  $('form').on 'click', '.add_fields', (event) ->
    time = new Date().getTime()
    regexp = new RegExp($(this).data('id'), 'g')
    $(this).before($(this).data('fields').replace(regexp, time))
    event.preventDefault()

$(document).ready '.receive-form', (event) ->
    time = new Date().getTime()
    regexp = new RegExp($(this).data('id'), 'g')
    $(this).before($(this).data('fields').replace(regexp, time))
    event.preventDefault() 
```

更新2：这里有更多信息：

我的html（重要部分）：

```
<div class="modal-body ">
<%= @company.haves.new.warehouse_transactions.new %>
<%= form_for @company do |f| %>

  <div class="form-inline receive-form">
    <h4>Part Details:</h4>
  <%= f.fields_for :haves do |builder| %>
      <%#= render 'have_fields', f: builder %>
    <% end %>
  <%= link_to_add_fields "+", f, :haves, :warehouse_transactions %>
  </div>
</div> 
```

有字段：

```
<fieldset>
<%= f.text_field :product_title, :class => 'input-small text_field', :placeholder => "Product Title" %>
<%= f.fields_for :warehouse_transactions do |builder| %>
<%= render 'wht_fields', :f => builder %>
<% end %>
<%= f.hidden_field :_destroy %>
<%= link_to "-", '#', class: "remove_fields" %>
</fieldset> 
```

wht_fields：

```
<fielset>
  <%= f.number_field :quantity, :class => 'input-small number_field', :placeholder => "Quantity" %>
  <%= f.text_field :cost, :class => 'input-small text_field', :placeholder => "Cost" %>
  <%= f.text_field :location, :class => 'input-small text_field', :placeholder => "Location" %>
  <%= f.text_field :batch, :class => 'input-small text_field', :placeholder => "Batch" %>
  <%= f.select :condition, ['Condition'] + WarehouseTransaction::CONDITIONS %>
  <%= f.hidden_field :_destroy %>
  <%= link_to "remove", '#', class: "remove_fields" %>
</fieldset> 
```

这里也是与 link_to_add_fields 关联的 rails 助手：

```
 def link_to_add_fields(name, f, association, child_association = nil)
    new_object = f.object.send(association).klass.new
    id = new_object.object_id
    new_object.send(child_association).new if child_association
    fields = f.fields_for(association, new_object, child_index: id) do |builder|
      render(association.to_s.singularize + "_fields", f: builder)
    end
    link_to(name, '#', class: "add_fields", data: {id: id, fields: fields.gsub("\n", "")})
  end 
```

我希望避免把这个问题变成小说，但它就是……我希望这些信息足以让这件事发挥作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:36:15.313

以下代码将在页面加载时执行：

```
$(document).ready(function () {
  // put here code to execute on page loading
}); 
```

如果代码应该只在一个页面上执行，把它放在一个只被这个页面调用的javascript文件中，或者在方法中添加一个测试，只在需要的时候执行代码。

# ruby-on-rails-3 - Sarah Mei 的“Outside-In BDD：How？！”中的新手陷阱 黄瓜教程

> ID：11974588
> 
> 赞同：1
> 
> 时间：2012-08-15T18:02:49.700
> 
> 标签：ruby-on-rails-3, cucumber

我正在努力学习黄瓜。在[SO 上浏览了一下](https://stackoverflow.com/a/6357384/765287)之后，我找到了[本教程](http://www.sarahmei.com/blog/2010/05/29/outside-in-bdd/)的链接。这很有帮助（我强烈推荐它！），但是对于像我这样的初学者来说，一些早期的步骤是不透明的。我想我会在这里解释这两个陷阱，以免未来的 Cucumber 学生让我头疼。

这两个问题都出现在本节中：

> **启动故障修复周期**
> 
> 我使用 cucumber 特性运行它，但它在第一行失败——假设我转到新书页——因为 cucumber 不知道“新书页”在哪里。所以我将它添加到黄瓜路径助手中。
> 
> ```
> when /the new book page/
>   new_book_path 
> ```

我在解释这一部分和运行她的代码时遇到了麻烦。

我的第一个问题是：*我在哪里可以找到`cucumber paths helper`文件*？

一旦我弄清楚并运行`cucumber features`，我得到了一个语法错误。

我的第二个问题是*如何调试她的代码引发的语法错误*？我试图在下面回答这两个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:06:18.517

**第一个问题：*“黄瓜路径助手”到底在哪里*？**

首先，她谈到在`cucumber paths helper`. 我挣扎了一会儿才弄清楚这个文件的位置。我在我的应用程序中找不到任何具有相似名称的东西，并且谷歌搜索没有产生任何有用的结果。发生了什么事？

事实证明，我找不到该文件，因为它不是自动生成的——您需要自己创建它。此外，文件的名称是完全任意的：不需要调用`cucumber_paths_helper`. 这就是为什么我的谷歌搜索没有结果。

要执行她的代码片段，它只需要位于文件夹中的*某个*文件中即可`features/support`。此目录中的所有代码都在运行任何黄瓜测试之前执行。解决方案？我把她的代码放到了一个新文件中`features/support/manage_books_steps.rb`。

好吧，下一个...

**第二个陷阱：语法错误，意外的keyword_when**

当我尝试运行时出现了下一个问题`cucumber features`。我懂了：

```
/Users/dB/myApp/features/support/manage_books_steps.rb:1: syntax error, unexpected keyword_when
when /the new book page/
    ^ (SyntaxError) 
```

由于某种原因，我的系统无法解析此代码。我不确定究竟是为什么，但我猜测 Sarah 正在使用一些 gem 或工具来预处理我没有安装的代码，不幸的是，她没有在文章中详细介绍她的 gemset。[（也许她是在黄瓜的辅助轮脱落](http://aslakhellesoy.com/post/11055981222/the-training-wheels-came-off)之前写的？）无论如何，在咨询了其他一些黄瓜教程之后，我尝试像这样重新格式化她的片段。

```
When /^I go to the new book page$/ do
  visit new_book_path
end 
```

这行得通。

在克服了这两个小障碍之后，本教程的其余部分是同步的。

无论如何，我希望这对某个地方的人有所帮助。并感谢莎拉，提供了一个很棒的教程。

欢迎编辑/评论/更正。

# c# - 显示 WiFi 信号强度的表单上的管理对象异常错误

> ID：11974593
> 
> 赞同：0
> 
> 时间：2012-08-15T18:03:19.390
> 
> 标签：c#, textbox, wmi, wifi

在我的 windows 窗体中，应用程序应该提取 wifi 信号强度并将结果输出到文本框中。

它运行良好，没有错误，但是当我运行它时，我得到一个管理异常未处理错误，突出显示以下语句中的**“in” ：**

```
foreach (ManagementObject mo in searcher.Get()). 
```

我不确定如何编辑代码来解决这个问题，最终允许我在表单的文本框中显示当前的 wifi 信号强度。

代码：

```
class NativeWiFi
{
    public string wifiStatus;

    public NativeWiFi() //gets signal strength
    {
       ManagementObjectSearcher searcher = new
       ManagementObjectSearcher(@"root\WMI", "select Ndis80211ReceivedSignalStrength
       from MSNdis_80211_ReceivedSignalStrength where active=true");
       StringBuilder sb = new StringBuilder(); 

        //output as a string 
        foreach (ManagementObject mo in searcher.Get()) //**PROBLEM IS HERE**
        {
            sb.Append( mo["Ndis80211ReceivedSignalStrength"]);

        }
        wifiStatus = sb.ToString();  
    }

} 
```

形式：

```
private void Form1_Load(object sender, EventArgs e) // on load, create timer
{          
    var timer = new Timer();
    timer.Tick += new EventHandler(timer_Tick);
    timer.Interval = 2000; //2 seconds
    timer.Start();
}

//after 2 seconds, update the text box called 'wifi' to output current wifi strength

void timer_Tick(object sender, EventArgs e) 
{
  wifi.Text = signal.wifiStatus;
} 
```

有什么想法可以让这些一起工作吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-05T06:14:58.673

我也被一些关于`WMI`. 我发现 WMI 功能在**Windows** * *7* * 和**Windows 8**`Ndis80211ReceivedSignalStrength`上无法获取信息 。我尝试使用 WLAN SDK 成功获取 WIFI 信号质量。您可以参考以下网址。 [http://msdn.microsoft.com/en-us/library/windows/desktop/ms706765%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms706765%28v=vs.85%29.aspx)

# java - Spring：映射请求中的错误（未找到带有 URI 的 HTTP 请求的映射）

> ID：11974594
> 
> 赞同：2
> 
> 时间：2012-08-15T18:03:19.670
> 
> 标签：java, spring

很抱歉再次问这种问题，但我无法解决查看其他线程和 Spring 文档的问题。

我正在使用 3.1.0.RELEASE 和 maven 并尝试使用注释和 java 配置。

这是我的 web.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" version="2.5">

<servlet>
    <servlet-name>WebAppServlet</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
            /WEB-INF/servletConf/web-application-config.xml<!-- ,
            /WEB-INF/servletConf/application-security.xml -->
        </param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>WebAppServlet</servlet-name>
    <url-pattern>/*</url-pattern>
</servlet-mapping> 
```

这是我的文件 web-application-config.xml。

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:aop="http://www.springframework.org/schema/aop" xmlns:context="http://www.springframework.org/schema/context"
    xmlns:jee="http://www.springframework.org/schema/jee" xmlns:tx="http://www.springframework.org/schema/tx"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xsi:schemaLocation="http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.1.xsd         http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd         http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd         http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-3.1.xsd         http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.1.xsd">

<context:property-placeholder location="classpath*:META-INF/spring/*.properties" />

<context:spring-configured />

<context:component-scan base-package="testspring">
    <context:exclude-filter expression=".*_Roo_.*" type="regex" />
    <context:exclude-filter expression="org.springframework.stereotype.Controller" type="annotation" />
</context:component-scan>

<mvc:annotation-driven /> 
```

我有两节课。第一个配置视图解析器

```
package testspring.web;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.ViewResolver;
import org.springframework.web.servlet.view.InternalResourceViewResolver;

@Configuration
public class CostManagerConfig {

 // Resolve logical view names to .jsp resources in the /WEB-INF/jsp directory
    @Bean
    ViewResolver viewResolver() {
        InternalResourceViewResolver resolver = new InternalResourceViewResolver();
        resolver.setPrefix("WEB-INF/jsp/");
        resolver.setSuffix(".jsp");
        return resolver;
        }
} 
```

第二个定义我的控制器：

```
package testspring.web;

import java.util.Comparator;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;

/**
 * Handles requests for the application home page.
 */
@Controller

public class HomeController {

/**
     * Default page when no mapping found.
     * @return
     */
    @RequestMapping("/*")
    public String home() {
        System.out.println("HomeController: Passing through...");
        return "home";
    }

} 
```

根据我的配置，我想一切都应该指向我的 home() 函数。但是，Apache 输出的日志并非如此：

调试 DispatcherServlet - 名称为“WebAppServlet”的 DispatcherServlet 处理 [/testSpring/] 的 GET 请求

DEBUG RequestMappingHandlerMapping - 查找路径的处理程序方法 / DEBUG RequestMappingHandlerMapping - 未找到 [/] 的处理程序方法

WARN PageNotFound - 在名为“WebAppServlet”的 DispatcherServlet 中未找到带有 URI [/testSpring/] 的 HTTP 请求的映射

DEBUG DispatcherServlet - 成功完成请求

我试图更改@RequestMapping 中的参数，但它没有改变任何东西......我尝试了以下

@RequestMapping("/*")

@RequestMapping()

@RequestMapping("/")

@RequestMapping("/home")

@RequestMapping("/home.html")

我试图到达的网址是

```
http://localhost:8080/testSpring/

http://localhost:8080/testSpring/home

http://localhost:8080/testSpring/home.html 
```

你能帮帮我吗？

非常感谢您的阅读！

祝你今天过得愉快;）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T19:32:11.900

当然你不能进入 HomeController 因为你从组件扫描中排除了它：

```
<context:component-scan base-package="testspring">
  <context:exclude-filter expression=".*_Roo_.*" type="regex" />
  <context:exclude-filter expression="org.springframework.stereotype.
  Controller" type="annotation" />
</context:component-scan> 
```

所以只需评论这一行：

```
<context:exclude-filter expression="org.springframework.stereotype.
Controller" type="annotation" /> 
```

# iphone - 未调用 tableviewcellForRowAtIndexPath

> ID：11974600
> 
> 赞同：-1
> 
> 时间：2012-08-15T18:03:49.573
> 
> 标签：iphone, ios5, xcode4

我有这个基本的购物清单应用程序，在第一个视图中有两个文本字段。一个是项目名称，另一个是项目数量。一旦用户键入这两个条目并按下保存按钮，应用程序就会转到表视图控制器，其中条目首先存储到一个名为 item 的对象中，然后将该对象存储到一个项目数组中。然后我实现了所有必需的表格视图方法并将项目显示在表格视图中。可悲的是，没有显示任何内容。当我保存条目时，表格视图显示为空白。在使用 NSLog 进行一些调试后，我发现关键方法 tableviewcellForRowAtIndexPath 没有被调用。我发现其他人也有类似的问题，解决方案是将 tableviewcontroller 设置为委托，我尝试过，但没有奏效。你知道我的代码有什么问题吗？谢谢。

这是我的第一张图片的视图控制器，然后我将向您展示我的 tableviewController 代码

```
 #import "TVViewController.h"
#import "TableViewController.h"
//#import "TableViewController.m"

@implementation TVViewController
@synthesize title;//one of the text fields
@synthesize subtitle;//the other text field

-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"Save"]) {
        NSString *string1 = self.title.text;
        NSString *string2 = self.subtitle.text;
        [segue.destinationViewController addName: string1 andNumber:string2];
    }
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Release any cached data, images, etc that aren't in use.
}

#pragma mark - View lifecycle

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)viewDidUnload
{
    [self setTitle:nil];
    [self setSubtitle:nil];
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
}

- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];
}

- (void)viewWillDisappear:(BOOL)animated
{
    [super viewWillDisappear:animated];
}

- (void)viewDidDisappear:(BOOL)animated
{
    [super viewDidDisappear:animated];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // Return YES for supported orientations
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

@end 
```

那是我的视图控制器这是我的表视图控制器，忽略那些用于调试目的的 nslog

```
 #import "TableViewController.h"
#import "Item.h"

@implementation TableViewController

@synthesize items;

-(void) addName:(NSString *) name
      andNumber:(NSString *) numberOfItems
{
    Item *item = [[Item alloc] init];
    item.itemName = name;
    item.itemQuantity = numberOfItems;
    [self.items addObject:item];
    NSLog(@"Data has been passed");

}

- (id)initWithStyle:(UITableViewStyle)style
{
    self = [super initWithStyle:style];
    if (self) {

    }

    return self;
}

- (void)didReceiveMemoryWarning
{
    // Releases the view if it doesn't have a superview.
    [super didReceiveMemoryWarning];

    // Release any cached data, images, etc that aren't in use.
}

#pragma mark - View lifecycle

- (void)viewDidLoad
{
    [super viewDidLoad];

    NSLog(@"VIew is ready");
    //[self.tableView reloadData];

    // Uncomment the following line to preserve selection between presentations.
    // self.clearsSelectionOnViewWillAppear = NO;

    // Uncomment the following line to display an Edit button in the navigation bar for this view controller.
    // self.navigationItem.rightBarButtonItem = self.editButtonItem;
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];

}

- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];
}

- (void)viewWillDisappear:(BOOL)animated
{
    [super viewWillDisappear:animated];
}

- (void)viewDidDisappear:(BOOL)animated
{
    [super viewDidDisappear:animated];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // Return YES for supported orientations
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

#pragma mark - Table view data source

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    NSLog(@"list initialized by count");
    // Return the number of rows in the section.

    return [self.items count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Item in cart";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    // Configure the cell...

    Item *item = [self.items objectAtIndex:indexPath.row];
    cell.textLabel.text = item.itemName;
    cell.detailTextLabel.text = item.itemQuantity;
    return cell;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T19:17:26.017

据我记得你需要为此设置tableVeiw的数据源，委托用于接收事件

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewDataSource_Protocol/Reference/Reference.html#//apple_ref/occ/intf/UITableViewDataSource](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewDataSource_Protocol/Reference/Reference.html#//apple_ref/occ/intf/UITableViewDataSource)

# haskell - 堆剖面图的可读性

> ID：11974602
> 
> 赞同：4
> 
> 时间：2012-08-15T18:03:54.267
> 
> 标签：haskell

我想证明我的应用程序的堆配置文件随着时间的推移大致保持不变。尽管如此，随着时间的推移，没有空间泄漏。如果我让应用程序运行几秒钟，我使用 hp2ps 获得的图形堆配置文件很好且可读，但如果我让应用程序运行半小时或更长时间，它就会变得一团糟。我该怎么做才能提高可读性？我可以降低样品密度吗？

![堆配置文件](../Images/2ea991e28b818ec1304bc635f2ee1e9b.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:23:47.827

您可以使用“-in”选项将采样间隔更改为 RTS，例如“-i10”以每 10 秒采样一次，而不是默认的 0.1 秒。有关详细信息，请参阅[GHC 手册](http://www.haskell.org/ghc/docs/7.0.1/html/users_guide/prof-heap.html#rts-options-heap-prof "GHC手册")。

或者，您可以更改 hp2ps 输出的方向和大小或更改显示波段的数量（请参阅“hp2ps -?”），尽管在这种情况下很难说这是否会对您有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T09:03:01.073

我建议使用[ekg](http://hackage.haskell.org/package/ekg/)并以您希望的任何频率通过 JSON 对堆使用情况进行采样。然后，您可以使用 gnuplot 或 R 绘制数据。

这种方法的另一个好处是您不需要分析构建，因此您的数据将更加准确。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-16T09:08:23.970

我认为这个数字没有任何问题——是的，它“不整洁”，不管这意味着什么，但它也表明没有失控的曲线。

# php - PHP GD - jpeg 图像的 imagerotate 不起作用

> ID：11974606
> 
> 赞同：0
> 
> 时间：2012-08-15T18:04:00.993
> 
> 标签：php, image-rotation, php-gd

标题说 JPEG。但我尝试了PNG。它没有用。GD 支持 imagerotate 功能。

```
 if (function_exists('imagerotate')) { 
     echo "test";
 } 
```

它输出单词test。所以我假设我有 imagerotate 功能。

```
$im = imagecreatetruecolor($width + 10, $height + 10);
... 
```

我做了一些图像处理。我可以毫无问题地看到处理后的图像。但我想旋转最终图像。所以我做了以下。

```
 imagerotate($im,180,0);
 imagepng($im,$png,9);
 imagedestroy($im); 
```

但我仍然得到没有旋转的图像。我什至只是尝试在不做任何处理的情况下旋转图像。它也没有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T07:53:39.950

在创建 png 之前，您需要将旋转后的图像分配给另一个变量。

```
$rotatedImage = imagerotate($im,180,0);
 imagepng($rotatedImage,$png,9);
 imagedestroy($rotatedImage); 
```

# php - 如何使用 PDO 检查数据库中是否存在行？

> ID：11974613
> 
> 赞同：33
> 
> 时间：2012-08-15T18:04:39.820
> 
> 标签：php, pdo, row

我想要一个条件，当该行根本不存在时执行一些操作。

```
$stmt = $conn->prepare('SELECT * FROM table WHERE ID=?');
$stmt->bindParam(1, $_GET['id'], PDO::PARAM_INT);
$stmt->execute();
$row = $stmt->fetch(PDO::FETCH_ASSOC); 
```

试过了`if (count($row) == 0)`，`if($stmt->rowCount() < 0)`但没有一个有效。

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-08-15T18:07:17.103

您可以直接检查返回值。

```
$stmt = $conn->prepare('SELECT * FROM table WHERE ID=?');
$stmt->bindParam(1, $_GET['id'], PDO::PARAM_INT);
$stmt->execute();
$row = $stmt->fetch(PDO::FETCH_ASSOC);

if( ! $row)
{
    echo 'nothing found';
}

/*
$rows = $stmt->fetchAll(PDO::FETCH_ASSOC); // Same here
if( ! $rows)
{
    echo 'nothing found';
}
*/ 
```

如果您询问*不获取*的检查，那么只需让 MySQL 返回 a `1`（或使用`COUNT()`命令）。

```
$sql = 'SELECT 1 from table WHERE id = ? LIMIT 1';
//$sql = 'SELECT COUNT(*) from table WHERE param = ?'; // for checking >1 records
$stmt = $conn->prepare($sql);
$stmt->bindParam(1, $_GET['id'], PDO::PARAM_INT);
$stmt->execute();

if($stmt->fetchColumn()) echo 'found'; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-15T18:12:16.193

```
if($stmt->rowCount() == 0) 
```

应该可以正常工作，因为无论如何行数都不能小于零。

从手册：

> 对于大多数数据库，`PDOStatement::rowCount()`不返回受`SELECT`语句影响的行数。相反，使用 `PDO::query()`发出`SELECT COUNT(*)`与预期语句具有相同谓词的`SELECT`语句，然后使用 `PDOStatement::fetchColumn()`检索将返回的行数。然后，您的应用程序可以执行正确的操作。

我建议在[这里](http://php.net/manual/en/pdostatement.rowcount.php)阅读。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-05T16:39:25.077

这是我在对象类中使用的内容：

```
function exists_by_id () {
    // check if object exists by id
    $stm = DB::$pdo->prepare('select count(*) from `table` where `column`=:column');
    $stm->bindParam(':column', $this->column);
    $stm->execute();
    $res = $stm->fetchColumn();

    if ($res > 0) {
        return true;
    }
    else {
        return false;
    }
} 
```

# java - Java - 转换“this[int x, int y]”

> ID：11974619
> 
> 赞同：1
> 
> 时间：2012-08-15T18:05:01.400
> 
> 标签：java, this

我正在做的是将 ac# 项目转换为 java 以练习编写自定义类。不幸的是，我无法弄清楚这个人在构造函数中使用“this”关键字做什么。

```
// C# Code - How is this written in Java?
public Player this[int x, int y] 
{ 
    get { return squares[x, y]; } 
    set { squares[x, y] = value; } 
} 
```

我已经转置了很多代码并且有点卡住了。我似乎无法在 Java 中找到有关此特定实例的任何信息。有人对我有好的线索吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-15T18:08:36.930

那不在构造函数中。那是[*indexer*](http://msdn.microsoft.com/en-us/library/6x16t2tx.aspx)的声明。Java 等价物类似于：

```
public Player getPlayer(int x, int y)
{
    // Note: Java doesn't have "real" multidimensional arrays,
    // only arrays of arrays.
    return squares[x][y];
}

public Player setPlayer(int x, int y, Player player)
{
    squares[x][y] = player;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T18:08:28.387

这是[使用索引器（C#）](http://msdn.microsoft.com/en-us/library/2549tw02%28v=vs.80%29.aspx)。

这个[博客](http://codeporting.com/blog/csharp-to-java-conversion/archive/2012/06/13/migrating-csharp-indexers-to-java-using-codeporting-csharp2java.html)有一些关于如何将 C# 索引器移植到 java 代码的想法。

基本上它可以在java getter/setter中实现：

```
public Player get(int x, int y) { return squares[x][y];}

public Player set(int x, int y, Player p) { squares[x][y] = p;} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T18:08:38.370

那不是构造函数，那是[indexer](http://msdn.microsoft.com/en-us/library/6x16t2tx%28v=vs.100%29.aspx)。基本上，此定义允许您执行以下操作：

```
Player playerAtOrigin = myGameBoard[0, 0]; 
```

在Java 中，只有数组有索引器（例如`myArray[i]`），您不能定义自己的索引器。最有可能的是，您需要将其转换为两种方法`getPlayerAt(int x, int y)`和`setPlayerAt(int x, int y, Player player)`.

# javascript - 哪个 JavaScript MVC/MVVM 对 SEO 友好？

> ID：11974623
> 
> 赞同：2
> 
> 时间：2012-08-15T18:05:33.987
> 
> 标签：javascript, model-view-controller, node.js, backbone.js, knockout.js

现在有很多基于 JS 的 MVC 框架，例如 Knockout.j、Backbone.js，但似乎大多数都不是 SEO 友好的，可以很容易地被 Go​​ogle 索引。

我错过了默认支持 SEO 的框架吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T18:24:54.903

在搜索引擎学会索引 JS 应用程序之前，您不能拥有纯 JavaScript 网络应用程序（即服务器是 API-only）。

但是，如果您可以在服务器和客户端之间共享视图模板，那将减轻拥有非 JS 版本的大部分负担。你可以使用任何你喜欢的 JS 框架。

[例如， Mustache](http://mustache.github.com/ "胡子")具有多种语言（Ruby、PHP 和 JS）的实现，并且可以从 JavaScript 轻松使用。

[在 Node 和浏览器之间共享代码的管道梦想演讲](http://www.youtube.com/watch?v=jbn9c_yfuoM)探讨了在 Node.js 和 Backbone.js 之间共享路由、控制器、模板甚至模型代码代码的可能性，并[在 GitHub 上进行了概念演示](https://github.com/keithnorm/SpainJS-Pipedream-Demo)。

如果您只是想构建一些带有非 JS 回退的简单 AJAX，您可能需要查看[jquery-pjax](https://github.com/defunkt/jquery-pjax/)，它使用新的 pushState API 来获取漂亮的 URL：

> 它是带有真正永久链接、页面标题和完全降级的工作返回按钮的 ajax。

# f# - 开始使用 F#

> ID：11974624
> 
> 赞同：144
> 
> 时间：2012-08-15T18:05:39.037
> 
> 标签：f#

如何进入 F# 编程？

有哪些好的入门示例可以学习该语言，或者了解它相对于其他语言的一些优势？

我需要什么工具（例如 Windows、Visual Studio、...）？

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2012-08-15T18:05:39.037

官方入口在这里：[微软F#开发者中心](https://msdn.microsoft.com/visualfsharpdocs/conceptual/visual-fsharp)

为了快速体验，请考虑[在您的浏览器](http://www.tryfsharp.org/)(Silverlight) 中尝试 F#。（包含交互式教程演练）

从观看视频和演示开始（顺便说一句， Luca Bolognese 的[Microsoft F# 简介](https://channel9.msdn.com/blogs/pdc2008/tl11)仍然是该主题的最佳演示之一）。然后阅读以下两本必读书籍：

*   [Programming F#：编写简单代码以解决复杂问题的综合指南，](https://rads.stackoverflow.com/amzn/click/0596153643) Chris Smith
*   [专家 F# 2.0](https://rads.stackoverflow.com/amzn/click/1430224312)（F# 中的专家之声），作者：Don Syme、Adam Granicz 和 Antonio Cisternino

除此之外……

## 快速链接

*   [Visual Studio](https://www.microsoft.com/visualstudio/en-us)（F#是VS2010和VS2012专业版的标准功能）
*   获取适用于 Web 的 Visual Studio 2012 Express 的 F# 工具（免费 2012 工具[发布信息](https://www.microsoft.com/en-us/download/details.aspx?id=34675)）
*   下载[F# 2010 年 11 月 CTP](https://www.microsoft.com/downloads/en/details.aspx?FamilyID=effc5bc4-c3df-4172-ad1c-bc62935861c5&displaylang=en)（免费 2010 工具[发布信息](https://blogs.msdn.microsoft.com/dsyme/2010/11/09/november-2010-f-2-0-free-tools-update/)）
*   通过 MSDN 资源[学习 F#](https://msdn.microsoft.com/visualfsharpdocs/conceptual/visual-fsharp)
*   [F# 2.0 语言规范](https://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/spec.html)( [PDF](https://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/spec.pdf) )（将出现 F# 3.0 规范）
*   [F# 的 MSDN 文档](https://msdn.microsoft.com/en-us/library/dd233154%28v=vs.110%29.aspx)（[语言参考](https://msdn.microsoft.com/en-us/library/dd233181%28v=vs.110%29.aspx)、[库参考](https://msdn.microsoft.com/en-us/library/ee353567%28v=vs.110%29.aspx)）
*   [F# Programming](https://en.wikibooks.org/wiki/Programming:F_Sharp) at Wikibooks（有很多示例）
*   [F# 示例和演练](https://msdn.microsoft.com/en-us/library/ee241126%28v=vs.110%29)
*   [F# 3.0 示例包](https://archive.codeplex.com/?p=fsharp3sample)
*   [Try F#的浏览器内教程](http://tryfsharporg.cloudapp.net/Tutorials.aspx)（需要 Silverlight）
*   [F# 基金会](http://fsharp.org/)有很多资源

## 社区

问答

*   StackOverflow 上的 [F# 标签](https://stackoverflow.com/questions/tagged/f%23)
*   [F# MSDN 论坛](http://social.msdn.microsoft.com/Forums/en-US/fsharpgeneral/threads)
*   [F# 在 fpish 上](http://fpish.net/home/1/f~23)

博客/出版

*   [F# 社区博客](http://feeds.feedburner.com/planet_fsharp)
*   [fpound.net](http://fpound.net/)聚合器
*   [推特上的 F#](https://twitter.com/#!/search?q=%23fsharp)
*   [github 上的 F#](https://github.com/fsharp/) ( [fsharpx](https://github.com/fsharp/fsharpx) )
*   [F# 团队博客](https://devblogs.microsoft.com/dotnet/tag/visual-f/)

聚会小组

*   [纽约市 F# 用户组](https://www.meetup.com/nyc-fsharp/)
*   [芝加哥 F# 用户](https://www.meetup.com/Chicago-F-Users/)
*   [F# 西雅图用户组](https://www.meetup.com/FSharpSeattle/)
*   [旧金山湾区 F# 用户组](http://www.sfsharp.org/)
*   [F#unctional 伦敦人聚会小组](https://www.meetup.com/FSharpLondon/)
*   [苏黎世 FSharp 用户聚会小组](https://www.meetup.com/zurich-fsharp-users/)

## 视频

*   [Channel9 上的 F# 视频](http://channel9.msdn.com/Search?term=F%23&type=All)
*   [F#“我怎么……？”](https://msdn.microsoft.com/en-us/vstudio/ff759495) MSDN 上的[视频](https://msdn.microsoft.com/en-us/vstudio/ff759495)

## 其他书籍

*   [F# 的基础](https://rads.stackoverflow.com/amzn/click/1590597575)（.Net 中的专家之声）Robert Pickering（2007 年 5 月）
*   [罗伯特·皮克林（Robert Pickering）的《开始 F#](https://rads.stackoverflow.com/amzn/click/1430223898)》（2009 年 12 月）
*   [Tomas Petricek 和 Jon Skeet 的真实世界函数式编程](https://rads.stackoverflow.com/amzn/click/1933988924)（2010 年 1 月）
*   [由 Jon Harrop 博士撰写的Visual F# 2010 技术计算](http://www.ffconsultancy.com/products/fsharp_for_technical_computing/)（2010 年 4 月）
*   [Giulia Costantini 和 Giuseppe Maggiore 的友好 F#](https://rads.stackoverflow.com/amzn/click/com/B005HHYIWC)（2011 年 8 月）

## 所需工具

视觉工作室：

*   F# 内置于 VS2010 和 VS2012 的专业版中。
*   F# 可作为 Visual Studio 2012 Express for Web 的附加组件使用。
*   或者，您也可以安装 VS2010 集成外壳（[免费下载](https://www.microsoft.com/downloads/details.aspx?FamilyID=8e5aa7b6-8436-43f0-b778-00c3bca733d3&displaylang=en)）。然后安装[CTP MSI](http://www.microsoft.com/downloads/en/details.aspx?FamilyID=effc5bc4-c3df-4172-ad1c-bc62935861c5&displaylang=en)，获得免费的 VS2010 版本的 F# 2.0。

单声道开发：

*   [您可以在此处](http://functional-variations.net/monodevelop/)找到有关在 MonoDevelop 中使用 F# 的大量信息。F# 编译器和 fsi.exe 现在是 Mono 发行版的[一部分](http://tirania.org/blog/archive/2011/Feb-16-1.html)。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-08-15T18:46:33.420

我学习 F# 的方式是通过以下 3 个步骤。

首先，我浏览了[Try F#](http://www.tryfsharp.org/Learn)网站上的介绍，该网站对语言的语法和风格进行了很好（但很轻松）的交互式介绍。

接下来，为了感受用语言实际解决问题，我开始解决[Project Euler](http://projecteuler.net/problem=11)网站上的一些难题。[我解决了前十个问题，在每个成功的问题之后，我在这里](http://fsharp-euler.wikispaces.com/)查找了一个替代的 F# 实现。这为如何使用序列和使用递归提供了很好的感觉，并且通常对语法感到满意。

[最后，我阅读了http://fsharpforfunandprofit.com/](http://fsharpforfunandprofit.com/)上真正优秀的 30 点指南[Why use F#](http://fsharpforfunandprofit.com/why-use-fsharp/)。它带您逐步了解该语言的所有主要部分，描述如何利用它们 - 着眼于 C# 开发人员。之后，我鼓励您在网站上四处寻找其他资源，它们都写得很好，而且很有见地。

完成这些步骤后，您应该准备好开始在 F# 中创建一个真正的项目。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2012-08-16T02:17:46.483

Brian 已经列出了一个很棒的列表，但我谦虚地提交我自己对 F# 学习材料的丰富生态系统[F# Koans](https://github.com/ChrisMarinos/FSharpKoans)的小贡献- 一种通过测试学习 F# 语言的简单、有趣和互动的方式。

# oracle - 将 .jpx 文件导入 Oracle 时出现未定义错误

> ID：11974627
> 
> 赞同：0
> 
> 时间：2012-08-15T18:05:44.583
> 
> 标签：oracle

我的公司正在运行一个 Oracle 电子商务套件。我已经根据[Oracle Applications Hack](http://oracle-hack.blogspot.com/2009/05/how-to-extend-view-object-in-oa.html)的代码扩展了一个视图对象。

我已经编译了我的对象，但是当我尝试运行命令行脚本来导入我的 .jpx 文件以进行替换时，它会引发“未定义的错误”。有没有人看到这个并解决它？

我的导入命令：

```
C:\jdeveloper\jdevbin\oaext\bin\jpximport C:\jdeveloper\jdevhome\jdev\myclasses\ORAR12DEV.jpx -username username -password password -dbconnection "(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=mydb.mycompany.com)(PORT=1523))(CONNECT_DATA=(DEV)))" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T20:32:44.577

您缺少关键字`SID`（假设`DEV`是您的`SID`）。像下面

```
(CONNECT_DATA=(DEV)) 
```

更正的命令

```
C:\jdeveloper\jdevbin\oaext\bin\jpximport C:\jdeveloper\jdevhome\jdev\myclasses\ORAR12DEV.jpx -username username -password password -dbconnection "(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=mydb.mycompany.com)(PORT=1523))(CONNECT_DATA=(SID=DEV)))" 
```

# android - 创建具有相同布局的活动应该怎么做？

> ID：11974633
> 
> 赞同：1
> 
> 时间：2012-08-15T18:06:12.053
> 
> 标签：android, android-activity

我有一些`Acitivity`带有`ListView`.

我希望在单击该`ListView`项目后应该有新`Activity`的具有相同类型的布局包含`ListView`与单击的项目相关的另一个信息（例如）。

我知道没有办法动态创建`Activities`。我应该怎么做才能从一个布局转到另一个（通过单击`ListView`项目）并且应该能够通过后退键返回相同的后退序列？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T01:42:27.757

您可以使用 A Fragment 来实现您的 ListView： http:
[//developer.android.com/reference/android/app/ListFragment.html](http://developer.android.com/reference/android/app/ListFragment.html)
然后您可以使用 FragmentManager 类和 FragmentTransation 类简单地将当前 ListFragment 替换为新的. 这样，当您按下后退按钮时，FragmentManager 将负责用旧的 ListFragment 替换新的 ListFragment。
请注意，如果您使用 ListFragment，您的 SDK 目标必须为 11 或更多。如果这对您来说是一个问题，您可以使用支持库中的 Fragment 类，在其中放置一个 ListView。FragmentManager 和 FragmentTransation 也是支持库的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T18:37:52.037

> 我知道没有办法动态创建活动。我应该怎么做才能从一个布局转到另一个布局（通过单击 ListView 项目）并且应该能够通过返回键返回相同的反向序列？

为什么不能动态创建活动？您可以轻松地从您的 ListView onclick 监听器创建一个新的

```
lv.setOnItemClickListener(new OnItemClickListener(){
        public void onItemClick(AdapterView<?> parent, View view, int position, long id){

         //Based on the position of the clicked item create a new activity with the position id
         Intent intent = new Intent(currentActivity.this, newActivity.this);
         intent.putExtra("id", position);
         startActivity(intent);
   }
}; 
```

现在在 newActivity 中，您将通过执行检查传递的 id 是什么

```
 Bundle bundle = getIntent().getExtras();
        theId = bundle.getInt("id");

            //Now do something based on that id 
```

在新活动中按后退键应该带您回到上一个活动

# visual-studio - Visual Studio解决方案秘密的解决方案文件（.sln）中的全局部分？

> ID：11974638
> 
> 赞同：3
> 
> 时间：2012-08-15T18:06:19.810
> 
> 标签：visual-studio, solution

最近我试图加载一个由 TFS 控制的解决方案源，但该解决方案中的一些项目没有被加载到 Visual Studio 内的解决方案资源管理器中。在花费了数小时的时间后，出于临时原因，当我通过在记事本中手动编辑它并重新启动 Visual Studio 删除了 .sln （解决方案文件）末尾的整个“全局部分”并重新启动 Visual Studio 时，所有项目都按预期显示。我正在使用 VS 2008。它还没有表现出任何奇怪的行为，但无法理解原因。

解决方案文件中的“全局部分”是否发挥重要作用？删除全局部分有什么害处吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T18:07:11.087

好吧，您刚刚删除了所有源代码控制绑定，以及构建配置和一些特定于解决方案的设置。

如果 VS 没有找到该部分，它应该恢复为默认值，但我想如果你知道导致问题的原因会更好。如果问题出在 TFS 上，那么可能重置该问题可以解决问题。

至于伤害，再次，如果 VS 能够应对该部分的删除并且可以恢复为默认值，那么我认为没有任何伤害。当然，您可能会丢失配置信息，必须重新应用。

# android - Fragment启动后Activity中的按钮不起作用

> ID：11974641
> 
> 赞同：0
> 
> 时间：2012-08-15T18:06:43.297
> 
> 标签：android, android-intent, android-fragments, fragment

我是Android编程的新手，我遇到了这个问题：

在这个简单的例子中，当我点击开始按钮时，我运行了一个片段。当我单击警报按钮时，我会写入一个日志文件。

现在，如果我先单击开始按钮，稍后警报按钮将不会运行。我认为问题在于片段不离开与用户的交互。你能帮助我吗？最好的问候 A.

```
public class MainActivity extends FragmentActivity {
private static final String FRAG1_TAG = MainActivity.class.getCanonicalName() +".fragment1";
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    Button buttonStart = (Button) findViewById(R.id.buttonStart);
    buttonStart.setOnClickListener(new OnClickListener() {

        public void onClick(View arg0) {
            Log.i("exemple", "start button Start !!!!!!");
            goFragment();

        }
    }); 
    Button buttonAllarm = (Button) findViewById(R.id.buttonAllarm);
    buttonAllarm.setOnClickListener(new OnClickListener() {

        public void onClick(View arg0) {            
        Log.i("exemple", "start button allarm !!!!!!");
        }// fine onClick    
    });// fine onClickListner
}

void goFragment() {

    FragmentManager fm = getSupportFragmentManager();
    FragmentTransaction xact = fm.beginTransaction();
    if (null == fm.findFragmentByTag(FRAG1_TAG)) {
        xact.replace(android.R.id.content, new ListFramment(), FRAG1_TAG);
         xact.addToBackStack (null);   // questo serve devi metterlo
            xact.commit();
    }
} 
```

这是片段

```
 public class ListFramment extends ListFragment {
       // onCreate     
        @Override
   public void onCreate(Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);
   }

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
    View view = inflater.inflate(R.layout.activity_main, null);
    AppLog.logString("Parte onCreateView");
    return view;
}   

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);
    AppLog.logString("Parte onActivityCreated");
    ArrayList<Map<String, String>> list = buildData();

    String[] from = { "name", "purpose" };
    int[] to = { android.R.id.text1, android.R.id.text2 };

    SimpleAdapter adapter = new SimpleAdapter(getActivity(), list,
    android.R.layout.simple_list_item_2, from, to);
    setListAdapter(adapter);

}

    private ArrayList<Map<String, String>> buildData() {
    ArrayList<Map<String, String>> list = new ArrayList<Map<String, String>>();
    list.add(putData("Android", "Mobile"));
    list.add(putData("iPhone", "iPhone"));
    return list;
    // TODO Auto-generated method stub

}

private HashMap<String, String> putData(String name, String purpose) {
    HashMap<String, String> item = new HashMap<String, String>();
    item.put("name", name);
    item.put("purpose", purpose);
    return item;
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T20:29:49.717

你的问题在这里：

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
    Bundle savedInstanceState) {
View view = inflater.inflate(R.layout.activity_main, null);
AppLog.logString("Parte onCreateView");
return view;
} 
```

您的 Fragment 正在膨胀与创建它的 Activity 相同的布局。但是 Fragment 没有任何 onClickListener。我怀疑 Fragment 布局正在覆盖 Activity 布局，并使用非功能按钮完全复制它。这可以解释为什么按钮单击只在第一次起作用。

Fragment 有自己的布局是正常的，与 Activity 不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T19:04:59.153

看不到您的布局文件没有帮助。但我怀疑它与碎片无关。

# c# - 如何从gridview asp.net c#中的特定单元格获取值？

> ID：11974643
> 
> 赞同：1
> 
> 时间：2012-08-15T18:06:53.733
> 
> 标签：c#, asp.net, gridview, row

之前我问过这个问题...

[在asp.net c#上的gridview上更改行或记录的颜色？](https://stackoverflow.com/questions/11974025/change-the-color-of-a-row-or-record-on-a-gridview-on-asp-net-c)

我正在尝试其中一个答案，但是现在我偶然发现了一个问题...

在为行分配颜色之前，首先我必须确保字段 Estado 等于“Pendiente”，并且字段 Fecha（这是一个日期）低于今天的日期......

我只是找不到一种方法来消除这两个值`gridview`

我需要为每一行都这样做，所以我使用的是涉及`RowDataBound`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:09:30.760

比您显示的只需检查 gridrow 单元格的文本值。

就像在你的行列中，如果它`BoundColumn`

```
string value = e.Row.Cells[1].Text;//here 1 is you column number 
```

如果存在`TemplateColumn`并包含类似标签的控件，则

```
string value = (e.Row.FindControl("lableid") as Label).Text; 
```

而不是写你的登录信息。

# algorithm - 数组越界 F#

> ID：11974644
> 
> 赞同：1
> 
> 时间：2012-08-15T18:07:02.283
> 
> 标签：algorithm, sorting, f#, runtime-error

在尝试了解有关排序算法和 F# 的更多信息时，我在 F# 中编写了一个插入排序。我完全是 F# 和函数式编程的菜鸟。

```
let insert (a: array<int>) i item =
    i = i - 1
    while i >= 0 && item < a.[i] do
        a.[i + 1] = a.[i]
        i = i - 1
    a.[i + 1] = item
    a

let sort (a: array<int>) =
    for i in 1 .. (a.Length - 1) do
        a = insert a i a.[i]
    a
let a = [|3; 4; 1; 3;|]
a = sort a
for i in a do
    printfn "%d" i 
```

代码编译得很好，但是当我运行可执行文件时......

```
Unhandled Exception: System.IndexOutOfRangeException: Index was outside the boun
ds of the array.
   at Isort.insert(Int32[] a, Int32 i, Int32 item)
   at Isort.sort(Int32[] a)
   at <StartupCode$isort>.$Isort.main@() 
```

该异常有点无益，因为它没有说明超出范围的异常在哪里......有没有办法在我的代码中修复这个错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T18:18:56.573

几条评论：

*   默认情况下，F# 值是不可变的。如果要修改值，请将它们声明为`mutable`.
*   `=`是相等，而`<-`赋值给可变值。
*   注意 F# 中的警告。在这种情况下，由于您忽略了比较值，因此会出现很多错误。

改进版：

```
let insert (a: int []) j item =
    let mutable i = j - 1
    while i >= 0 && item < a.[i] do
        a.[i + 1] <- a.[i]
        i <- i - 1
    a.[i + 1] <- item

let sort (b: int []) =
    let a = Array.copy b
    for i in 1 .. (a.Length - 1) do
        insert a i a.[i]
    a
let a = [|3; 4; 1; 3; 5; 6; 5|]
let a' = sort a
for i in a' do printfn "%d" i 
```

为了清楚起见，我修改了一些变量的名称。此外，辅助函数`insert`可以返回`unit`，而`sort`最好返回一个新副本，而不是改变输入数组。

# css - 如何使用 CSS 格式化表格，使表格在屏幕内，并且单元格使用尽可能多的必要宽度？

> ID：11974646
> 
> 赞同：0
> 
> 时间：2012-08-15T18:07:12.407
> 
> 标签：css, formatting, width, scrollbar, css-tables

如何使用 CSS 格式化表格：

1.  表格在屏幕内，浏览器的水平滚动条不显示，用户无需水平滚动即可看到表格的右侧；

2.  单元格根据需要使用尽可能多的宽度，包含仅具有诸如“1”、“21”之类的数字的单元格的列将不会使用比显示该列中所有单元格中的所有数字所需的宽度大得多的宽度，例如4个字符宽度，即使用多于它意味着浪费水平空间；

3.  对于包含非常宽的单元格的列，或者更准确地说，如果允许将占据较大宽度的内容，请使用尽可能多的宽度，以便不违反 1) 和 2)，并且如果单元格的全部内容无法显示，让该单元格显示水平滚动条。

这在 Windows 和 Mac OS X 上最新的 Firefox 和 Google chrome 的 CSS 中可行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T19:13:19.493

我的[第一次尝试](http://jsfiddle.net/tpnyH/1/)是基于[CSS：Constrain a table with long cell contents to page width?](https://stackoverflow.com/a/7569436/7570613) , 使用嵌套`div`的 s 和`position: relative`then `position: absolute`。不考虑绝对定位的 div 的大小，这对表格的宽度有利，但对行的高度不利：它不会扩展到包含滚动条。

然后我按照[如何设置 <td> 宽度以在视觉上截断其显示的内容](https://stackoverflow.com/a/480903/230170)中的建议进行[尝试？](http://jsfiddle.net/vyjbC/1/) . 这也实现了忽略单元格内容大小的目标，但这样做使我们无法像以前一样指定最后一列应该占据所有*剩余*宽度。`table-layout: fixed`

 *另请参阅：[为什么溢出：隐藏在 <td> 中不起作用？](https://stackoverflow.com/q/509711/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T18:21:17.653

这些提示可能会有所帮助：

1-不要为您的单元格指定任何宽度 2-当您自动插入页面时，会创建一个样式并分配给它，上面写着：宽度：100%；

继续删除它。这样，您的表格将变得非常小并适应单元格的内容。

3- 将单元格的 nowrap 属性用于要保留在一行中的字段，例如数字，但不要将其设置为较大的文本并允许它是多行的。

4-您可能想要为表格设置宽度或将表格放在面板中并为面板设置宽度。

我不确定如何仅显示一行的滚动条，但我认为如果您以多行显示它们，则不需要该选项。*

# php - 语句不能正常工作

> ID：11974651
> 
> 赞同：0
> 
> 时间：2012-08-15T18:07:17.627
> 
> 标签：php, class

我在课堂上有一个脚本，当我尝试让脚本检查它没有完成的东西时。它只是由于某种原因停止，这是我的脚本：

```
case 'f':
    if (isset($this->packet['f']['v'])) {
        return $this->sendMessage("user  is online");
    }
    $this->sendMessage("User is offline.");
break; 
```

所以基本上如果用户在线，它会返回用户在线，它确实如此。但如果他不是，它不会说“用户离线”有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:10:56.883

尝试这个：

```
case 'f':
    return (isset($this->packet['f']['v']) ? $this->sendMessage("User is online") : $this->sendMessage("User is offline."));
    break; 
```

# keyboard-shortcuts - 有没有一种方法可以将 SSMS 2012 键盘快捷键绑定到过程，以便我可以传递完全限定的对象名称？

> ID：11974652
> 
> 赞同：3
> 
> 时间：2012-08-15T18:07:24.253
> 
> 标签：keyboard-shortcuts, sql-server-2012, ssms

在 SSMS 2012 中，有什么方法可以绑定键盘快捷键（例如`Ctrl`- `5`），以便我可以突出显示合格的对象名称（例如`master.sys.objects`）并使用该对象名称作为参数调用我自己的过程？

我知道如果我在使用键盘快捷键之前明确地在对象名称周围添加引号或括号，这确实有效（例如，突出显示字符串`'sys.objects'`，但是当想要通过直接突出显示现有查询中的表来轻松使用我的快捷方式时，这会变得乏味。

对于更多上下文，我注意到`Alt`- `F1`（sp_help 的快捷方式）现在支持完全限定的对象名称。例如，突出显示`sys.objects`和按下`Alt`-`F1`在 SSMS 2012 中完美运行（在 SSMS 2008 中没有）。这是描述此增强功能的[相关连接问题。](https://connect.microsoft.com/SQLServer/feedback/details/349116/keyboard-shortcut-alt-f1-sp-help-doesnt-work-for-tables-belonging-to-non-default-schemas)

但是，当查看此快捷方式的键盘绑定时，看起来此操作应该与在突出显示的文本上调用 sp_help 同义：

![在此处输入图像描述](../Images/a085d1b9265d41f655de9359ce850756.png)

事实并非如此，正如您通过运行以下两个 sp_help 调用可以看到的那样，这两个调用都失败并出现错误`Incorrect syntax near '.'.`：

```
USE master
GO
EXEC sp_help sys.objects
GO
EXEC sp_help master.sys.objects
GO 
```

如果有办法让我能够调用我自己的过程，类似于可以在没有括号或引号的合格对象上调用 sp_help 的方式，我很想知道！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-15T12:51:19.597

SSMS 2012 支持 2 个不带引号的部件名称，对于 3 个部件名称，您仍然需要引号。

我仍然没有找到任何支持你想要的插件，也许你可以在 SSMS Boost( [http://www.ssmsboost.com/](http://www.ssmsboost.com/) ) 上制作一个宏来自动添加括号，运行你的命令然后删除括号。我没有尝试用它做这样的事情，但它应该是可能的

# mysql - mysql加入两个非常复杂的查询

> ID：11974655
> 
> 赞同：2
> 
> 时间：2012-08-15T18:07:44.927
> 
> 标签：mysql, join

我目前有两个非常复杂的查询，我用它们来获得排名分数。第一个是所有参与者及其分数与阶段排名，第二个是按每个参与者分组并计算他们的整体排名（阶段总和）。

第一个查询以获取每个阶段的所有参与者的分数和排名

```
SELECT * FROM (
  SELECT alias, catabbr, sh_dq, raw, sdq, dnf, 
@rownum := IF(@stage != stage_name, 1, @rownum + 1) AS rowNum,
@rank := IF(@prevVal != cTime, @rownum, @rank) AS rank,
@stage := stage_name as stage_name,
@prevVal := cTime AS cTime,
id, zeroTime
  FROM 
(SELECT @rownum:= 0) rn,
(SELECT @rank:= 1) av,
(SELECT @stage:= '') sv,
(SELECT @prevVal:= 0) pv,
(SELECT s.stage_name stage_name, sc.alias alias, sc.catAbbr catabbr, sc.sh_dq sh_dq, sc.time raw, sc.id id, sc.sdq sdq, sc.dnf dnf, 
    IF(sc.time = "0", 1, 0) AS zeroTime,
    ((ROUND(sc.time, 2) + (sc.miss * 5)) + ((sc.proc * 10) + (sc.saf * 10) + (sc.sog * 30)) - (sc.bthPoints)) cTime
    FROM matches m
    LEFT JOIN stages s ON s.match_id = m.id
    LEFT JOIN scores sc ON sc.stage_id = s.id
    WHERE m.matchuuid = 'E13A4C61-A2B8-48E2-BE1B-1FFB77CC5849'
    GROUP BY sc.alias, s.stage_name
    ORDER BY s.stage_name, zeroTime, cTime
) tv
) t
ORDER BY zeroTime, alias, stage_name; 
```

输出：

```
+-----------+---------+-------+-----------------+-----+-----+--------+------+-----------------------+-------+----------+
| alias     | catabbr | sh_dq | raw             | sdq | dnf | rowNum | rank | stage_name            | cTime | zeroTime |
+-----------+---------+-------+-----------------+-----+-----+--------+------+-----------------------+-------+----------+
| Back Bob  | S       | 0     | 52.9799995422   | 0   | 1   | 54     | 54   | Stage 1               | 92.98 | 0        |
+-----------+---------+-------+-----------------+-----+-----+--------+------+-----------------------+-------+----------+
| Back Bob  | S       | 0     | 43.9099998474   | 0   | 0   | 46     | 46   | Stage 2               | 48.91 | 0        |
+-----------+---------+-------+-----------------+-----+-----+--------+------+-----------------------+-------+----------+
| Ben Scal  | ES      | 0     | 26.9699993134   | 0   | 0   | 27     | 27   | Stage 1               | 31.97 | 0        |
+-----------+---------+-------+-----------------+-----+-----+--------+------+-----------------------+-------+----------+
| Ben Scal  | ES      | 0     | 32.8800010681   | 0   | 0   | 38     | 38   | Stage 2               | 42.88 | 0        |
+-----------+---------+-------+-----------------+-----+-----+--------+------+-----------------------+-------+----------+ 
```

第二个查询按姓名对参与者进行分组，并将他们的排名相加得出最终排名

```
SELECT alias, catabbr, SUM(cTime) fTime, SUM(rank) fRank, zeroTime, rank
FROM (
  SELECT alias, catabbr, sh_dq, raw, sdq, dnf, 
@rownum := IF(@stage != stage_name, 1, @rownum + 1) AS rowNum,
@rank := IF(@prevVal != cTime, @rownum, @rank) AS rank,
@stage := stage_name as stage_name,
@prevVal := cTime AS cTime,
id, zeroTime
  FROM 
(SELECT @rownum:= 0) rn,
(SELECT @rank:= 1) av,
(SELECT @stage:= '') sv,
(SELECT @prevVal:= 0) pv,
(SELECT s.stage_name stage_name, sc.alias alias, sc.catAbbr catabbr, sc.sh_dq sh_dq, sc.time raw, sc.id id, sc.sdq sdq, sc.dnf dnf, 
    IF(sc.time = "0", 1, 0) AS zeroTime,
    ((ROUND(sc.time, 2) + (sc.miss * 5)) + ((sc.proc * 10) + (sc.saf * 10) + (sc.sog * 30)) - (sc.bthPoints)) cTime
    FROM matches m
    LEFT JOIN stages s ON s.match_id = m.id
    LEFT JOIN scores sc ON sc.stage_id = s.id
    WHERE m.matchuuid = 'E13A4C61-A2B8-48E2-BE1B-1FFB77CC5849'
    GROUP BY sc.alias, s.stage_name
    ORDER BY s.stage_name, zeroTime, cTime
) tv
) t
GROUP BY alias
ORDER BY zeroTime, fRank, fTime; 
```

输出：

```
+-----------+-----------+-----------+-------+-----------+
| alias     | catabbr   | fTime     | fRank | zeroTime  |
+-----------+-----------+-----------+-------+-----------+
| Back Bob  | S         | 141.89    | 100   | 0         |
+-----------+-----------+-----------+-------+-----------+
| Ben Scal  | ES        | 74.85     | 68    | 0         |
+-----------+-----------+-----------+-------+-----------+ 
```

zeroTime 列使我可以按大于 0 的时间排序，并正确计算排名。

当我尝试加入他们时，我没有得到任何结果或任何东西。有没有办法将这两个查询组合/加入一个查询，以便它们输出以下内容？

```
+-----------+-----------+-----------+-------+-----------+---------------+---------------+---------------+---------------+
| alias     | catabbr   | fTime     | fRank | zeroTime  | Stage 1 Time  | Stage 1 Rank  | Stage 2 Time  | Stage 2 Rank  |
+-----------+-----------+-----------+-------+-----------+---------------+---------------+---------------+---------------+
| Ben Scal  | ES        | 74.85     | 68    | 0         | 31.97         | 27            | 42.88         | 38            |
+-----------+-----------+-----------+-------+-----------+---------------+---------------+---------------+---------------+
| Back Bob  | S         | 141.89    | 100   | 0         | 92.98         | 54            | 48.91         | 46            |
+-----------+-----------+-----------+-------+-----------+---------------+---------------+---------------+---------------+ 
```

这将进入一个 php 页面，所以我可以循环并拉入我需要的内容，我想做的主要事情是加入这两个查询。

我的结构和数据对于 sqlfiddle 来说太大了。这是比赛和阶段的结构和插入：http: [//pastebin.com/YvZevd5j](http://pastebin.com/YvZevd5j) 这是得分的结构和插入：http: [//pastebin.com/jLBYxMvc](http://pastebin.com/jLBYxMvc)

还需要注意的一件事是，游戏可以有 1 个或多个阶段以及 1 个或多个参与者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:34:28.900

这个答案可能无法很好地扩展，因为您需要知道阶段的数量，但也许您可以在应用程序中使用循环或其他东西来构建它。这是一个简化版本，您可以对其进行修改以处理您的数据。

```
SELECT 
  alias,
  catAbbr,
  sum(fTime) as fTime,
  sum(fRank) as fRank,
  sum(zeroTime) as zeroTime,
  sum(Stage_1_Time) as stage_1_Time,
  sum(Stage_1_Rank) as Stage_1_Rank,
  sum(Stage_2_Time) as stage_2_Time,
  sum(Stage_2_Rank) as Stage_2_Rank
FROM (
  SELECT 
    alias,
    catAbbr,
    0 as fTime,
    0 as fRank,
    0 as zeroTime,
    Stage_1_Time as stage_1_Time,
    Stage_1_Rank as Stage_1_Rank,
    0 as stage_2_Time,
    0 as Stage_2_Rank
  FROM (query that gets stage 1 info)
  UNION
  SELECT
    alias,
    catAbbr,
    0 as fTime,
    0 as fRank,
    0 as zeroTime,
    0 as stage_1_Time,
    0 as Stage_1_Rank,
    stage_2_Time as stage_2_Time,
    Stage_2_Rank as Stage_2_Rank
  FROM (query that gets stage 2 info)
  UNION
  SELECT
    alias,
    catAbbr,
    fTime as fTime,
    fRank as fRank,
    zeroTime as zeroTime,
    0 as stage_1_Time,
    0 as Stage_1_Rank,
    0 as stage_2_Time,
    0 as Stage_2_Rank
  FROM (query that gets averaged info)
) temp
GROUP BY alias, catAbbt 
```

# eclipse - 如何在新版本的 Eclipse 中按字母顺序对选项卡进行排序

> ID：11974657
> 
> 赞同：4
> 
> 时间：2012-08-15T18:07:48.467
> 
> 标签：eclipse, editor

> **可能重复：**
> [我可以按字母顺序对 Eclipse 中的选项卡进行排序吗？](https://stackoverflow.com/questions/2613060/can-i-sort-the-tabs-in-eclipse-alphabetically)

有没有办法在 Eclipse 中的下拉雪佛龙中按字母顺序对打开的选项卡（编辑器）进行排序？我似乎记得在旧版本的 Eclipse 中做过，但在 Juno 中似乎无法弄清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:49:16.750

我已经安装了**[Extended VS Plugin](http://andrei.gmxhome.de/eclipse/)**，并想分享一些屏幕截图，因为它可以满足您的要求。

安装插件后，您必须像这样启用它：

```
First time after plugin installation please enable Extended VS Presentation under:    
Window->Preferences->General->Appearance->Current presentation. 
```

然后，您可以通过右键单击其中一个选项卡来按需对选项卡进行排序，如下所示： ![在此处输入图像描述](../Images/b5a9415ccf033935418b1c5149e1fa73.png)

或者，您可以选择让选项卡自动排序，`Preferences -> Appearance -> Extended VS Presentation`如下所示：

![在此处输入图像描述](../Images/da2d3c272d9b057dcd2aa20bca5a8af7.png)

我最初安装它是为了它的`Session Save`功能，它允许您轻松地将打开的编辑器选项卡列表保存为以后可以恢复的会话。如果您打开了许多与任务或错误相关的文件并且需要稍后参考它们，那么 Uber 很有用。

# c# - 服务引用为 ServiceStack 生成了不正确的代理

> ID：11974659
> 
> 赞同：2
> 
> 时间：2012-08-15T18:08:01.947
> 
> 标签：c#, servicestack

我有一个服务堆栈服务，在同一个命名空间中具有以下请求和响应类

```
public class GetContactMasterData
{

}

public class GetContactMasterDataResponse
{
    public IdDescription[] EntityTypes { get; set; }
    public IdDescription[] NameTypes { get; set; }
    public IdDescription[] AddressTypes { get; set; }
    public ResponseStatus MyResponseStatus { get; set; }
} 
```

我使用soapUI成功测试了该服务。这是回应

```
<s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope">    
   <s:Body>
      <GetContactMasterDataResponse xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.servicestack.net/types">
         <AddressTypes>
            <IdDescription>
               <Description>Home</Description>
               <Id>1</Id>
            </IdDescription>
            ...
         </AddressTypes>
        <EntityTypes>
           <IdDescription>
              <Description>Corporation</Description>
              <Id>1</Id>
           </IdDescription>
           ... 
        </EntityTypes>
        <MyResponseStatus i:nil="true" />
        <NameTypes>
           <IdDescription>
              <Id>4</Id>
              <Description>Other</Description>
           </IdDescription>
           ...
        </NameTypes>
      </GetContactMasterDataResponse>
   </s:Body>
</s:Envelope> 
```

当我创建控制台应用程序来测试此服务时，服务引用会生成一个代理对象。这就是智能感知如何引导您调用 GetContactMasterData 方法

GetContactMasterData(out IdDescription[], out ResponseStatus myResponseStatus, out IdDescription[] NameTypes):IdDescription[] addressTypes

我的问题是：为什么 EntityTypes 和 NameTypes 变成了参数，而 addressTypes 变成了方法的返回类型？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T18:19:34.183

ServiceStack 的[SOAP 支持 wiki](https://github.com/ServiceStack/ServiceStack/wiki/SOAP-support)中包含使用 SOAP 需要注意的限制：

> 由于 VS.NET 的 Add Service Reference 已针对使用 .asmx 或 WCF RPC 方法调用进行了优化，因此它不能正确支持多个返回值（例如，当您还需要 ResponseStatus 属性时），它将生成一个丑陋的代理 API，完全没有参数。
> 
> 如果你想确保生成一个漂亮的代理，你应该只有一个包含你想要返回的所有数据的一级属性。

# hadoop - 猪没有加载 csv

> ID：11974681
> 
> 赞同：1
> 
> 时间：2012-08-15T18:09:50.687
> 
> 标签：hadoop, hdfs, apache-pig

我正在尝试使用以下命令在 pig 中加载管道分隔文件（'|'）： `A = load 'test.csv' using PigStorage('|');`

但我不断收到此错误：[main] ERROR org.apache.pig.tools.grunt.Grunt - ERROR 2999: Unexpected internal error。java.net.URISyntaxException 不能转换为 java.lang.Error

我已经看遍了，但我找不到任何会发生这种情况的原因。我上面的测试文件是一个简单的文件，只包含`1|2|3`用于测试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-07-01T11:44:32.227

如果您在 MAPREDUCE 作为 ExecType 模式下运行 Pig，那么以下命令应该可以工作

```
A = LOAD '/user/pig/input/pipetest.csv' USING PigStorage('|');
DUMP A; 
```

这是屏幕上的输出

```
(1,2,3) 
```

请注意，我在 LOAD 命令中包含了我的 csv 文件的 HDFS 中的完整路径

# git - Github fork 的解释以及它们如何存储文件

> ID：11974686
> 
> 赞同：12
> 
> 时间：2012-08-15T18:10:01.600
> 
> 标签：git, version-control, github, git-svn

我只是想知道在 github 上完成分叉时会发生什么。

例如，当我 fork 一个项目时，它是在 github 服务器上复制所有代码，还是只创建一个链接？

所以另一个问题：在 git 中，因为如果您向其中添加相同的文件，它会对所有文件进行哈希处理，因此不需要再次存储文件内容，因为哈希值已经在系统中，对吗？

github是这样的吗？因此，如果我碰巧上传了与另一个用户完全相同的代码，当 github gits 时，它实际上只是创建了一个指向该文件的链接，因为它具有相同的哈希值，或者它是否再次单独保存其所有内容？

任何启发都会很棒，谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2017-06-15T22:11:23.743

根据[https://enterprise.github.com/releases/2.2.0/notes](https://enterprise.github.com/releases/2.2.0/notes) GitHub Enterprise（我假设是 GitHub）以某种方式在分叉之间共享对象以减少磁盘空间使用：

> 此版本改变了 GitHub Enterprise 存储仓库的方式，通过在分叉之间共享 Git 对象来减少磁盘使用量，并在读取仓库数据时提高缓存性能。

[在https://githubengineering.com/counting-objects](https://githubengineering.com/counting-objects)上还有更多关于他们如何做到这一点的详细信息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-15T18:24:33.930

[github.com](http://github.com)与 git 的语义完全相同，但它周围有一个基于 Web 的 GUI 界面。

[存储](http://en.wikipedia.org/wiki/Git_%28software%29#Data)：“Git 将文件的每个修订版存储为唯一的 blob 对象”
因此每个文件都是唯一存储的，但它使用 SHA-1 哈希来确定文件之间的更改。

对于 github，fork 本质上是一个克隆。这意味着一个新的分叉是他们服务器上的一个新存储区域，并引用了它的 ORIGIN。它绝不会在两者之间建立联系，因为 git 本质上可以跟踪遥控器。每个分叉都知道上游。

当您说“如果我碰巧上传与另一个用户完全相同的代码”时，“上传”一词在“git”意义上有点模糊。如果您正在处理同一个存储库并且 git 甚至允许您提交同一个文件，这意味着它是不同的并且它签入了该修订版。但是，如果您的意思是在另一个 repo 的克隆/fork 上工作，那将是同样的情况，但文件系统上也不会建立到另一个 repo 的链接。

我不能声称对 github 可能在其内部系统上进行的优化有任何深入的了解。他们可能正在执行中间自定义操作以节省磁盘空间。但是他们所做的任何事情对你来说都是透明的，并且没有多大关系，因为它应该总是在预期的 git 语义下运行。

github 的一位开发人员[写了一篇](http://scottchacon.com/2011/08/31/github-flow.html)关于他们如何在内部完成自己的 git 工作流的博客文章。虽然它与您关于他们如何管理服务的实际工作流程的问题无关，但我认为结论中的这句话非常有用：

> Git 本身理解起来相当复杂，使您使用它的工作流程比必要的复杂得多，这只会给每个人的一天增加更多的精神开销。我总是提倡使用最简单的系统，为你的团队工作，直到它不再工作，然后只在绝对需要时增加复杂性。

我从中得到的是，他们承认 git 本身是多么复杂，所以他们很可能会采取尽可能轻的接触来围绕它来提供服务，并让 git 做它本机最擅长的事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-10-24T14:32:40.370

我不知道 GitHub 究竟是如何做到的，但这是一种可能的方法。它需要了解 git 存储数据的方式。

简短的回答是 repos 可以*共享*数据库，`objects`但每个都有自己的引用。
我们甚至可以在本地对其进行模拟以进行概念验证。

在裸仓库的目录中（`.git/`如果不是裸仓库，则在子目录中）有三件事是仓库工作的最低要求：

*   `objects/`存储所有对象（提交、树、blob ...）的子目录。它们可以单独存储为名称等于对象哈希的文件，也可以存储在`.pack`文件中。
*   `refs/`子目录，它存储简单文件，例如其`refs/heads/master`内容是它引用的对象的哈希值。
*   该`HEAD`文件，其中说明了当前提交是什么。它的值要么是原始散列（对应于*分离的头*，即我们不在任何命名的分支上），要么是指向可以找到实际散列的参考的文本链接（例如`ref: refs/heads/master`- 这意味着我们在分支上`master`）

假设有人`orig`在 Github 上创建了他的原始（非分叉）回购。
为了模拟，我们在本地做

```
$ git init --bare github_orig 
```

我们假设上述情况发生在 Github 服务器上。现在有一个空的 github 存储库。然后我们想象从我们自己的 PC 上克隆 github repo：

```
$ git clone github_orig local_orig 
```

当然在现实生活中`github_orig`我们会用`https://github...`. 现在我们已经克隆了 github 仓库`local_orig`。

```
$ cd local_orig/
$ echo zzz > file
$ git add file
$ git commit -m initial
$ git push
$ cd .. 
```

this 之后`github_orig`的`object`目录将包含我们推送的提交对象、一个 blob 对象`file`和一个树对象。该`refs/heads/master`文件将包含提交哈希。

`Fork`现在让我们想象一下当有人按下按钮时会发生什么。我们将*手动*创建一个 git repo ：

```
$ mkdir github_fork
$ cd github_fork/
$ cp ../github_orig/HEAD .
$ cp -r ../github_orig/refs .
$ ln -s ../github_orig/objects
$ cd .. 
```

请注意，我们*复制* `HEAD`了，`refs`但*我们*为`objects`. 正如我们所见，制作*叉子*非常便宜。即使我们有数十个分支，每个分支都只是`refs/heads`目录中的一个文件，其中包含一个简单的十六进制散列（40 字节）。因为`objects`我们只链接到原始对象目录——我们不复制任何东西！

现在我们模拟创建分叉的用户，在本地克隆分叉的 repo：

```
$ git clone github_fork local_fork
$ cd local_fork
$ # ls
.git/  file 
```

我们可以看到我们已经成功克隆了虽然我们克隆的 repo 没有自己的`objects`但链接到原始 repo 的 repo。
现在分叉用户可以创建分支、提交，然后将它们推送到`github_fork`. 对象将被推送到与!`objects`相同的目录中。`github_orig`但是`refs`and`HEAD`将被修改并且将不再匹配`github_orig`.

所以底线是属于同一分叉树的所有存储库共享一个*公共对象池*，而每个存储库都包含自己的引用。任何将提交推送到自己的分叉存储库的人都会修改自己的引用，但会将对象放入共享池中。

当然，要真正可用，必须注意更多的事情——最重要的是，除非调用它的 repo 知道*所有引用的知识，否则**不得*调用 git 垃圾收集器——而不仅仅是它自己的。否则，它可能会丢弃共享池中无法从其引用访问但可以从其他 repos 的引用访问的对象。

# spring - NoSuchBeanDefinitionException 与 spring 和 gwt (requestFactory)

> ID：11974688
> 
> 赞同：0
> 
> 时间：2012-08-15T18:10:29.743
> 
> 标签：spring, gwt, requestfactory

我用 gwt（使用 requestfactory）和 spring 得到这个错误

```
org.springframework.beans.factory.NoSuchBeanDefinitionException: No unique bean of type [org.calibra.server.service.AccountService] is defined: expected single bean but found 0: 
at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBean(DefaultListableBeanFactory.java:271)
at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1101)
at org.calibra.server.SpringServiceLocator.getInstance(SpringServiceLocator.java:24)
at com.google.web.bindery.requestfactory.server.LocatorServiceLayer.createServiceInstance(LocatorServiceLayer.java:56) 
```

我的服务定位器

```
public class SpringServiceLocator implements ServiceLocator {
    @Override
    public Object getInstance(Class<?> clazz) {
        ApplicationContext context = WebApplicationContextUtils.getWebApplicationContext(                
            RequestFactoryServlet.getThreadLocalServletContext());
        return context.getBean(clazz);
    }
} 
```

我的春季服务

```
@Service
public class AccountServiceImpl implements AccountService{
     @Override
     public void addNewAccount(Account account) {
       ...
     }

     @Override
     public List<Account> loadAllAccounts() {
        ...
     }

} 
```

gwt requestContext，参考我的spring服务

```
@Service(value=AccountService.class, locator=SpringServiceLocator.class)
public interface AccountRequest extends RequestContext {

    Request<Void> addNewAccount(AccountProxy account);

    Request<List<AccountProxy>> loadAllAccounts();

} 
```

我的 web.xml

```
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/applicationContext.xml</param-value>
</context-param>

<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>

<servlet>
    <servlet-name>gwtRequest</servlet-name>
    <servlet-class>com.google.web.bindery.requestfactory.server.RequestFactoryServlet</servlet-class>
</servlet>

<servlet-mapping>
    <servlet-name>gwtRequest</servlet-name>
    <url-pattern>/gwtRequest</url-pattern>
</servlet-mapping>

<welcome-file-list>
    <welcome-file>welcomeGWT.html</welcome-file>
</welcome-file-list> 
```

我不明白我怎么能有 0 个 AccountService bean？

我试图添加调度程序-servlet

```
<bean id="accountService" class="org.calibra.server.service.AccountServiceImpl"/> 
```

我得到了同样的结果

任何想法？

编辑：如果有人有一个完整的例子，那可能很有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T09:17:52.220

我认为仅使用 ContextLoaderListener 是不够的，因为您似乎没有使用 DispatcherServlet（有吗？）。以下几行对我有用：

```
<filter>
    <filter-name>springRequestContextFilter</filter-name>
    <filter-class>org.springframework.web.filter.RequestContextFilter</filter-class>
</filter>

<filter-mapping>
    <filter-name>springRequestContextFilter</filter-name>
    <url-pattern>/gwtRequest</url-pattern>
</filter-mapping> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T16:30:22.453

我在其他几个地方看到过这个问题。您应该首先尝试在 applicationContext.xml（而不是 dispatch-servlet.xml）中明确地将 AccountServiceImpl 定义为 bean，然后查看是否仍然出现错误，如果没有，那么您知道这是您缺少组件- 在您的应用程序上下文 xml 中扫描，这就是我认为的情况。

希望这可以帮助

# sockets - Heroku postgres 连接：“服务器是否在本地运行并接受 Unix 域套接字上的连接”

> ID：11974689
> 
> 赞同：3
> 
> 时间：2012-08-15T18:10:32.107
> 
> 标签：sockets, heroku

我正在设置一个新的开发环境，遵循 django 设置教程并遇到问题。这是我尝试运行syncdb时得到的

```
Running `python doccal/manage.py syncdb` attached to terminal... up, run.1
Traceback (most recent call last):
  File "doccal/manage.py", line 14, in <module>
    execute_manager(settings)
  File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/__i
nit__.py", line 459, in execute_manager
    utility.execute()
  File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/__i
nit__.py", line 382, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/bas
e.py", line 196, in run_from_argv
    self.execute(*args, **options.__dict__)
  File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/bas
e.py", line 232, in execute
    output = self.handle(*args, **options)
  File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/bas
e.py", line 371, in handle
    return self.handle_noargs(**options)
  File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/com
mands/syncdb.py", line 57, in handle_noargs
    cursor = connection.cursor()
  File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/backends/__init_
_.py", line 306, in cursor
    cursor = self.make_debug_cursor(self._cursor())
  File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/backends/postgre
sql_psycopg2/base.py", line 177, in _cursor
    self.connection = Database.connect(**conn_params)
  File "/app/.heroku/venv/lib/python2.7/site-packages/psycopg2/__init__.py", lin
e 179, in connect
    connection_factory=connection_factory, async=async)
psycopg2.OperationalError: could not connect to server: No such file or director
y
        Is the server running locally and accepting
        connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"? 
```

在使用相同的步骤之前，我已经设置了相同的项目并且从未遇到过问题。几周前，我确实收到了一封电子邮件，说 Heroku 正在从共享数据库中迁移出来，并假设这以某种方式涉及。

另外，我确实注意到教程中有两个新步骤，即安装 dj-database-url 并将这些行添加到 settings.py

```
import dj_database_url
DATABASES = {'default': dj_database_url.config(default='postgres://localhost')} 
```

我试图在有和没有这些行的情况下运行它，无论如何都会遇到同样的问题。

另一篇文章建议修复是这样做

```
heroku addons:add shared-database 
```

试过了，得到一条消息，共享数据库已被弃用并使用 heroku-postgresql，但这没有效果。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-25T09:46:10.830

将 HOST 配置为 localhost，例如：

```
'HOST': 'localhost', 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-06T18:34:42.393

此错误的最简单（不全面，但可以让您尽快启动并运行）解决方案是，在您的 settings.py 文件中，在您设置数据库设置的部分将设置恢复为

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': BASE_DIR / 'db.sqlite3',
    }
} 
```

进行迁移（即 python manage.py makemigrations 然后 python manage.py migrate）将您的更改推送到 GitHub，在您的 Heroku 帐户中，创建一个新应用程序，然后移动到新应用程序的设置部分，连接到 GitHub 并从 GitHub 部署，然后将为您提供数据库资源（即，将使用与本地 SQLite 数据库相同的模式和数据创建 PostgreSQL 数据库）。

# django - values() 和 only() 的区别

> ID：11974691
> 
> 赞同：29
> 
> 时间：2012-08-15T18:10:39.500
> 
> 标签：django, django-queryset

使用有什么区别：

```
Blabla.objects.values('field1', 'field2', 'field3') 
```

和

```
Blabla.objects.only('field1', 'field2', 'field3') 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-08-15T18:19:08.587

假设`Blabla`您的问题中有字段，以及`field4`，

```
Blabla.objects.only('field1', 'field2', 'field3')[0].field4 
```

将返回该对象的值`field4`（使用新的数据库查询来检索该信息），而

```
Blabla.objects.values('field1', 'field2', 'field3')[0].field4 
```

会给

```
AttributeError: 'dict' object has no attribute 'field4' 
```

这是因为`.values()`返回一个`QuerySet`返回字典的 a，它本质上是一个字典列表，而不是模型实例 ( `Blabla`)。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-08-15T18:17:50.750

`.values()`给你“不到一个模型”；它返回的项目比完整模型更接近字典，这意味着您不会获得模型属性，但您也不必初始化完整模型。

`.only()`将 SQL 中的字段列表限制为您关心的特定字段，但仍会初始化完整模型；它会延迟加载其他字段，直到您访问它们（如果有的话）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2021-04-16T08:52:54.017

到目前为止给出的答案是正确的，但他们没有提到查询方面的一些差异。我只会报告他们。

### `.get()`

```
# User.objects.get(email='user@email.com').username
SELECT "users_user"."id", "users_user"."password", "users_user"."last_login", 
"users_user"."is_superuser", "users_user"."username", "users_user"."first_name", 
"users_user"."last_name", "users_user"."email", "users_user"."is_staff", "users_user"."is_active", 
"users_user"."date_joined", "users_user"."name"
FROM "users_user" 
WHERE "users_user"."email" = 'user@email.com'; args=('user@email.com',) 
```

### `.only().get()`

```
# User.objects.only('username').get(email='user@email.com')
SELECT "users_user"."id", "users_user"."username" 
FROM "users_user" 
WHERE "users_user"."email" = 'user@email.com'; args=('user@email.com',) 
```

### `.values().get()`

```
# User.objects.values('username').get(email='user@email.com')
SELECT "users_user"."username" 
FROM "users_user" 
WHERE "users_user"."email" = 'user@email.com'; args=('user@email.com',) 
```

如您所见，`only()`还将选择`id`记录的。这可能是因为它会输出一个您以后可以使用的模型，正如其他答案所提到的那样。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-15T18:18:55.453

`values()`return - 迭代时返回`QuerySet`表示模型的字典。它不返回模型对象。

`only()`是一种限制返回的列，并确保*只**立即*返回那些列的方法——这就是为什么它有时被称为它的对立面，`defer()`它相当于说`SELECT foo, bar, zoo FROM`而不是正常的`SELECT [all columns] FROM`。它将返回一个`QuerySet`可以进一步链接的。

# javascript - 如果列包含特定值，则更改表格行的颜色

> ID：11974692
> 
> 赞同：0
> 
> 时间：2012-08-15T18:10:43.607
> 
> 标签：javascript, jquery, asp.net, html, jquery-selectors

我有一个看起来像这样的表：

```
<asp:Repeater ID="myRepeater" runat="server">
    <div id="divTable" class="divTable">
    <table id="myTable">
        <thead>
        <tr>
            <td>A</td>
        </tr>
        <tr>
            <td>B</td>
        </tr>
        <tr>
            <td>C</td>
        </tr>
        <tr>
            <td>D</td>
        </tr>                        
    </thead>
    <tbody id="myContent">
        <tr>
            <td>Some Text</td>
        </tr>
        <tr>
            <td>Some Text</td>
        </tr>
        <tr>
            <td>Some Text</td>
        </tr>
        <tr>
            <td id="findMe">
                <%#Eval("IsFlagged")%>
            </td>
        </tr>                            
    </tbody>
    </asp:Repeater>
    </table>
    </div> 
```

现在，这就是我想要做的。如果 <%#Eval("IsFlagged")%> 返回**任何东西**，我想让表格行中的所有单元格都具有某种颜色。

我一直在阅读有关 .contains() 的内容，但我还没有找到一个简单地询问“如果不是 null，则将 .css 样式应用于表格行的其余单元格”的示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T18:25:10.270

我在 jsfiddle 中放了一个例子：http: [//jsfiddle.net/aMR5r/](http://jsfiddle.net/aMR5r/)

**编辑：**您的编辑使代码更简单，但原理相同。

```
$(function(){
    var isFlagged = $('#findMe').text();
    if(isFlagged.length > 0)
    {
        $('#findMe').parent().addClass('yellow');
    }
}); 
```

[http://jsfiddle.net/aMR5r/1/](http://jsfiddle.net/aMR5r/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T18:24:41.600

首先，尝试给特定的 td 一个类或其他东西，以便您可以定位它。然后你可以检查 $('td.yourclassname').html(); 的长度

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T18:32:21.287

如果您使用的是 VB.Net，那么您可以使用此代码..

```
<tr style="background-color:<%# IIF(IsDBNull(Eval("IsFlagged"),"none","yellow") %>"> 
```

您也可以将此逻辑应用于 TD。

# .net - 在 C# 中进行大量、快速和频繁的内存分配期间避免 OutOfMemoryException

> ID：11974694
> 
> 赞同：12
> 
> 时间：2012-08-15T18:10:46.423
> 
> 标签：.net, windbg, out-of-memory, fragmentation, large-object-heap

我们的应用程序不断地为大量数据（比如数十到数百兆字节）分配数组，这些数据在被丢弃之前的生存时间很短。

天真地这样做可能会导致大对象堆碎片，最终导致应用程序崩溃并出现 OutOfMemoryException，尽管当前活动对象的大小并不过分。

过去我们成功管理此问题的一种方法是将数组分块以确保它们不会最终出现在 LOH 上，其想法是通过允许垃圾收集器压缩内存来避免碎片。

我们最新的应用程序处理的数据比以前更多，并且在托管在单独的 AppDomain 或单独的进程中的加载项之间非常频繁地传递这些序列化数据。我们采用了与以前相同的方法，确保我们的内存始终被分块，并非常小心地避免大型对象堆分配。

但是，我们有一个必须托管在外部 32 位进程中的加载项（因为我们的主应用程序是 64 位的，并且加载项必须使用 32 位库）。在特别重的负载下，当大量 SOH 内存块被快速分配并在不久之后被丢弃时，即使我们的分块方法也不足以保存我们的 32 位加载项，它会因 OutOfMemoryException 而崩溃。

在发生 OutOfMemoryException 时使用 WinDbg，`!heapstat -inclUnrooted`显示如下：

```
Heap             Gen0         Gen1         Gen2          LOH
Heap0           24612      4166452    228499692      9757136

Free space:                                                 Percentage
Heap0              12           12      4636044        12848SOH:  1% LOH:  0%

Unrooted objects:                                           Percentage
Heap0              72            0         5488            0SOH:  0% LOH:  0% 
```

`!dumpheap -stat`显示这个：

```
-- SNIP --

79b56c28     3085       435356 System.Object[]
79b8ebd4        1      1048592 System.UInt16[]
79b9f9ac    26880      1301812 System.String
002f7a60       34      4648916      Free
79ba4944     6128     87366192 System.Byte[]
79b8ef28    17195    145981324 System.Double[]
Total 97166 objects
Fragmented blocks larger than 0.5 MB:
    Addr     Size      Followed by
18c91000    3.7MB         19042c7c System.Threading.OverlappedData 
```

这些告诉我，我们的内存使用并没有过多，而且我们的大对象堆像预期的那样非常小（所以我们绝对不会在这里处理大对象堆碎片）。

但是，`!eeheap -gc`显示了这一点：

```
Number of GC Heaps: 1
generation 0 starts at 0x7452b504
generation 1 starts at 0x741321d0
generation 2 starts at 0x01f91000
ephemeral segment allocation context: none
 segment     begin allocated  size
01f90000  01f91000  02c578d0  0xcc68d0(13396176)
3cb10000  3cb11000  3d5228b0  0xa118b0(10557616)
3ece0000  3ece1000  3fc2ef48  0xf4df48(16047944)
3db10000  3db11000  3e8fc8f8  0xdeb8f8(14596344)
42e20000  42e21000  4393e1f8  0xb1d1f8(11653624)
18c90000  18c91000  19c53210  0xfc2210(16523792)
14c90000  14c91000  15c85c78  0xff4c78(16731256)
15c90000  15c91000  168b2870  0xc21870(12720240)
16c90000  16c91000  17690744  0x9ff744(10483524)
5c0c0000  5c0c1000  5d05381c  0xf9281c(16328732)
69c80000  69c81000  6a88bc88  0xc0ac88(12627080)
6b2d0000  6b2d1000  6b83e8a0  0x56d8a0(5691552)
6c2d0000  6c2d1000  6d0f2608  0xe21608(14816776)
6d2d0000  6d2d1000  6defc67c  0xc2b67c(12760700)
6e2d0000  6e2d1000  6ee7f304  0xbae304(12247812)
70000000  70001000  70bfb41c  0xbfa41c(12559388)
71ca0000  71ca1000  72893440  0xbf2440(12526656)
73b40000  73b41000  74531528  0x9f0528(10421544)
Large object heap starts at 0x02f91000
 segment     begin allocated  size
02f90000  02f91000  038df1d0  0x94e1d0(9757136)
Total Size:              Size: 0xe737614 (242447892) bytes.
------------------------------
GC Heap Size:            Size: 0xe737614 (242447892) bytes. 
```

这里让我印象深刻的是，我们最终的 SOH 堆段从 0x73b41000 开始，这正好是我们 32 位加载项中可用内存的限制。

所以如果我没看错的话，我们的问题似乎是我们的虚拟内存已经被托管堆段碎片化了。

我想我的问题是：

*   我的分析正确吗？
*   我们使用分块避免 LOH 碎片的方法是否合理？
*   有没有一个好的策略来避免我们现在看到的内存碎片？

我能想到的最明显的答案是池化和重用我们的内存块。这可能是可行的，但我宁愿避免这样做，因为它涉及我们自己有效地管理那部分记忆。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-20T16:47:40.070

对于那些感兴趣的人，这里是我发现的关于这个问题的更新：

似乎最好的解决方案是实现块池化以减轻垃圾收集器的压力，所以我这样做了。

结果是加载项在其任务中稍微进一步，但不幸的是它仍然很快耗尽了内存。

再次查看 WinDbg，我能看到的唯一真正区别是我们合并的托管堆大小始终较小，约为 200MB，而池化前约为 250MB。

似乎 .NET 可用的内存量随着时间的推移而减少，因此实现池化只是延迟了内存耗尽。

如果这是真的，那么明显的罪魁祸首就是我们用来将数据加载到内存中的 COM 组件。我们对 COM 对象进行了一些缓存，以改善对数据的重复访问时间。我删除了所有缓存，并确保在每次查询数据后释放所有内容。

现在就内存而言，一切看起来都很好，只是速度要慢得多（接下来我必须解决这个问题）。

我想事后看来，COM 组件应该是内存问题的第一个嫌疑人，但是嘿，我学到了一些东西 :) 从好的方面来说，池化仍然有助于减少 GC 开销，所以这也是值得的。

谢谢大家的评论。

# javascript - 使用 javascript/jquery 加载文件

> ID：11974696
> 
> 赞同：0
> 
> 时间：2012-08-15T18:10:52.490
> 
> 标签：javascript, jquery, variables

这是我正在使用的功能：

```
jOWL.load("owldoc.owl", function(){}); 
```

jOWL.load 将 owl 文档作为参数（如上所示）。我在服务器上有 3 个这样的文档，并且希望用户能够通过按下按钮来选择要加载的文档。

我想知道是否可以将字符串“owldoc.owl”、“owldoc2.owl”或“owldoc3.owl”传递给javascript变量，然后可以将其作为参数传递给jOWL.load

我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T18:33:40.370

`onclick='loadFile("1"); return false;'`使用相应链接内部调用以下函数。

IE：

```
 <a href="" id='load1'>Load 1</a>
    <a href="" id='load2'>Load 2</a>
    <a href="" id='load3'>Load 3</a> 
```

功能：

```
 function loadFile(param){
        jOWL.load("owldoc"+param+".owl", function(){});
    } 
```

要让 onclicks 不在线显示，最简单的方法是将 id 添加到锚点并在页面加载时调用此函数`manageOnclicks();`：

```
 function manageOnclicks(){
        document.getElementById('load1').onclick = function(){loadFile('1'); return false;}
        document.getElementById('load2').onclick = function(){loadFile('2'); return false;}
        document.getElementById('load3').onclick = function(){loadFile('3'); return false;}
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T18:17:15.903

示例 HTML

```
<input type='button' onclick="loadFile('owldoc.owl')" value='Load Owldoc'/>
<input type='button' onclick="loadFile('owldoc2.owl')" value='Load Owldoc2'/>
<input type='button' onclick="loadFile('owldoc3.owl')" value='Load Owldoc3'/> 
```

Javascript

```
function loadFile(fileName) {
    // filename contains the variable
    // you can now do        
    //jOWL.load(filename, function(){}

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T18:19:35.663

就像是：

HTML：

```
<h3>Choose a file to load</h3>
<ul id='choose_file'>
    <li><a data-file='1'>File 1</a></li>
    <li><a data-file='2'>File 2</a></li>
    <li><a data-file='3'>File 3</a></li>
</ul> 
```

JS

```
document.addEventListener('DOMContentLoaded', function() {
    document.querySelector('#choose_file').addEventListener('click', function(evt) {
        var file_to_load = evt.target.getAttribute('data-file');
        jOWL.load('owldoc'+file_to_load+'.owl', function() {
            /* callback code here */
        });
    }, false);
}, false); 
```

# haskell - Haskell FFI - mallocForeignPtr 用法

> ID：11974697
> 
> 赞同：2
> 
> 时间：2012-08-15T18:10:54.653
> 
> 标签：haskell, ffi

我是 Haskell 编程、外部函数接口和 Stackoverflow 的新手。我正在尝试为基于 C 的库构建 Haskell FFI 绑定。请在下面找到一个与我当前的问题非常相似的假设示例：

考虑我有一个 C 结构和一个像这样的函数：

```
typedef struct {
      int someInt;
      void *someInternalData;
   } opaque_t;

int bar (opaque_t *aPtr, int anArg); 
```

不透明的 C 结构是这里的 out 参数。我应该将相同的内容传递给其他 API。调用者不需要取消引用不透明结构。

在下面找到带有 FFI 导入的 myFFI.hsc 文件：

```
{-# LANGUAGE CPP, ForeignFunctionInterface #-}
module MyFFI where
import Foreign
import Foreign.Ptr
import Foreign.ForeignPtr
import Foreign.C.Types
import Foreign.C
import System.IO.Unsafe
import Foreign.Marshal
import qualified Foreign.ForeignPtr.Unsafe (unsafeForeignPtrToPtr)
import qualified System.IO (putStrLn)

#include "myclib.h"

newtype OpaquePtr = OpaquePtr (ForeignPtr OpaquePtr)

#let alignment t = "%lu", (unsigned long)offsetof(struct {char x__; t (y__); }, y__) 
instance Storable OpaquePtr where
    sizeOf _ = #{size opaque_t}
    alignment _ = #{alignment opaque_t}
    peek _ = error "Cant peek"

foreign import ccall unsafe "myclib.h bar"
    c_bar :: Ptr OpaquePtr
                -> CInt
                -> CInt

barWrapper :: Int -> (Int, ForeignPtr OpaquePtr)
barWrapper anArg = System.IO.Unsafe.unsafePerformIO $ do
    o <- mallocForeignPtr
    let res = c_bar (fromIntegral anArg) (Foreign.ForeignPtr.Unsafe.unsafeForeignPtrToPtr o)
    return ((fromIntegral res), o) 
```

在我的实际代码中，上述类似的实现似乎有效。但是当我传递不透明的结构引用时，我会得到奇怪的输出，有时还会出现 ghci 崩溃。

我不确定 mallocForeignPtr 和 ForeignPtr 在 FFI 调用中的用法。对于长期引用，我们应该使用 ForeignPtr + mallocForeignPtr，但我们不能在 ccall 中传递 ForeignPtr。那怎么办呢？我上面的逻辑正确吗？任何形式的帮助都会非常棒。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-12T00:28:57.700

我试图提出一个可以显示典型用例的示例。由于使用阶乘作为函数式语言示例的传统由来已久，因此我决定不打破它。

下面的这两个文件（factorial.h 和 factorial.c）使用表格来帮助计算整数的阶乘。他们首先建立并用阶乘填充一个表；那么这个表用来求阶乘；然后在不再需要时将其释放。我们还将消息打印到标准输出，以便能够知道我们的表何时初始化和释放。

阶乘.h：

```
/* A table of factorials. table[i] is the factorial of i. The
 * max field is calculated so that its factorial would not be an
 * integer overflow.
 */

typedef struct {
    unsigned max;
    unsigned *table;
} factorial_table;

int factorial_table_init(factorial_table *t);
int factorial_get(factorial_table *t, int n);
void factorial_table_free(factorial_table *t); 
```

阶乘.c：

```
#include <stdio.h>
#include <stdlib.h>
#include <limits.h>
#include <factorial.h>

/* Calculates max and allocate table. Returns !0 if
 * memory could not be allocated.
 */

int factorial_table_init(factorial_table *t)
{
    unsigned i, factorial;

    t->max = factorial = 1;
    while (INT_MAX / factorial > t->max + 1)
        factorial *= ++t->max;
    t->table = malloc((t->max + 1)*sizeof(unsigned));
    if (!t->table) return !0;
    t->table[0] = 1;
    for (i = 1; i <= t->max; i++)
        t->table[i] = i * t->table[i-1];
    fprintf(stdout,"A factorial table was just allocated.\n");
    return 0;
}

/* Uses a table to get the factorial of an integer number n. Returns
 * (-1) if n is negative and (-2) if n is too big.
 */

int factorial_get(factorial_table *t, int n)
{
    if (n < 0) return (-1);    
    if (n > t->max) return (-2);
    return t->table[n];
}

/* Frees the table we used. */

void factorial_table_free(factorial_table *t)
{
    free(t->table);
    fprintf(stdout,"A factorial table was just freed.\n");
} 
```

现在，我们的 Haskell 代码。

```
{-# LANGUAGE CPP, ForeignFunctionInterface, EmptyDataDecls #-}

#include <factorial.h>

#let alignment t = "%lu", (unsigned long)offsetof(struct {char x__; t (y__); }, y__) 

module Factorial (factorial) where
import Control.Monad
import Foreign.Ptr
import Foreign.ForeignPtr
import Foreign.C
import Foreign.Storable
import System.IO.Unsafe
import Foreign.Marshal

data Factorial_table

instance Storable Factorial_table where
    sizeOf _ = #{size factorial_table}
    alignment _ = #{alignment factorial_table}
    peek _ = error "Cant peek"

foreign import ccall factorial_table_init :: Ptr Factorial_table -> IO CInt
foreign import ccall factorial_get :: Ptr Factorial_table -> CInt -> IO CInt
foreign import ccall "&factorial_table_free" funptr_factorial_table_free
    :: FunPtr (Ptr Factorial_table -> IO ())

factorialIO :: IO (CInt -> IO CInt)
factorialIO = do
    tableFgnPtr <- mallocForeignPtr :: IO (ForeignPtr Factorial_table)
    withForeignPtr tableFgnPtr $ \ptr -> do
        status <- factorial_table_init ptr
        when (status /= 0) $ fail "No memory for factorial table"
    addForeignPtrFinalizer funptr_factorial_table_free tableFgnPtr
    let factorialFunction n = do
        r <- withForeignPtr tableFgnPtr $ \ptr -> factorial_get ptr n
        when (r == (-1)) $ fail
            "Factorial was requested for a negative number"
        when (r == (-2)) $ fail
            "Factorial was requested for a number that is too big"
        return r
    return factorialFunction

factorial :: CInt -> CInt
factorial = unsafePerformIO . unsafePerformIO factorialIO 
```

首先，注意 Factorial_table 实例是如何存储的。另请注意，所有函数绑定都返回 IO。

所有相关代码都在 factorialIO 中。它首先 malloc 一个指针（这里是使用 Storable 的大小和对齐信息的地方。我写了那个调用的类型，但这不是必需的）。然后它添加终结器，它将在指针内存被释放之前运行。我们将该指针封装在一个整数函数 (factorialFunction) 中，始终使用 withForeignPtr，然后返回它。

因为我们知道我们的函数没有重要的副作用，所以最后两行只是把我们刚刚创建的东西变成了一个纯函数。让我们测试一下：

```
ghci
    Prelude> :m + Factorial 
Prelude Factorial> factorial 5
    A factorial table was just allocated.
    120
Prelude Factorial> factorial 10
    3628800
Prelude Factorial> factorial 13
    *** Exception: user error (Factorial was requested for a number that is too big)
Prelude Factorial> factorial 12
    479001600
Prelude Factorial> :q
    Leaving GHCi.
    A factorial table was just freed. 
```

我希望这很有用。当然，这是一种完全人为的计算阶乘的方法，但这就是上帝创造阶乘的目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T09:19:59.213

好吧，我想我找到了正确使用 ForeignPtr 和 mallocForeignPtr 的解决方案：

```
barWrapper :: Int -> (Int, Either error (ForeignPtr OpaquePtr))
barWrapper anArg = System.IO.Unsafe.unsafePerformIO $ do
    o <- mallocForeignPtr
    withForeignPtr o $ \opaque_ptr -> do
        let res = c_bar (fromIntegral anArg) opaque_ptr
        if res /= (-1)
            then return ((fromIntegral res), Right o)
        else
            return ((fromIntegral res), Left $ error "some problem") 
```

问题是：

1.  我忽略了 Haskell 的懒惰评估：只有在访问“res”时，才会执行外部调用。所以，我不得不使用 if / else 块来让它调用 ccall
2.  我应该使用 withForeignPtr 而不是 unsafeForeignPtrtoPtr

# ios - iOS 5：numberOfRowsInSection 不起作用

> ID：11974699
> 
> 赞同：1
> 
> 时间：2012-08-15T18:10:58.090
> 
> 标签：ios, cocoa-touch, uitableview

我在 storybord 和 UISegmentedControl 中有一个 tableView 来用不同的数据和不同的设计填充上面提到的表。我的问题是 numberOfRowsInSection 方法在我切换 UISegmentedControl 时没有反应。

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
if(self.segment.selectedSegmentIndex==0)
{
    return [self.items count];
    NSLog(@"Nominals: %d",self.items.count);
}
if(self.segment.selectedSegmentIndex==1)
{
    return [self.coinageArr count];
    NSLog(@"Coinage: %d",self.coinageArr.count);
}
//return 0; Complains about no return.
} 
```

好吧，NSLogs 在导航时不起作用。在这种情况下如何返回 NSInteger ？

提前谢谢。

编辑：对于shannoga

段控制器切换方法：

```
-(IBAction)segmentValueChaged:(id)sender
{
switch (self.segment.selectedSegmentIndex) 
{
    case 0:
    {
         DBAccess *access=[[DBAccess alloc]init];
        self.items=[access returnNominals:self.entityID nk:fromPeriod];
        [access closeDataBase];            
        self.tableView.hidden=NO;
        [self.tableView reloadData];
         break;
    }
    case 1:
    {
        DBAccess *access=[[DBAccess alloc]init];
        self.coinageArr=[access returnCoinage:fromPeriod period:self.entityID];
        self.tableView.hidden=NO;
        [self.tableView reloadData];

        break;
    }
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T18:23:14.780

*   NSLog 不起作用，因为返回在您到达此行之前生效，并且永远不会执行。

将其更改为：

```
 - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
if(self.segment.selectedSegmentIndex==0)
{
     NSLog(@"Nominals: %d",self.items.count);
    return [self.items count];
}
if(self.segment.selectedSegmentIndex==1)
{
   NSLog(@"Coinage: %d",self.coinageArr.count);
    return [self.coinageArr count];
}
//return 0; Complains about no return.
} 
```

*   您能否显示更改 UISegmentedControl 时调用的方法？
*   请注意，您不需要设置 2 个 if 语句，您可以使用`else`.
*   正如@Ryan 所说，您应该`[tableview reloadData]`在 UISegmentedControl 更改中使用。那么如果你 在你的方法中改变`self.items`数组并且不做任何改变就更好了，所以它看起来像这样：`valueChanged``numberOfRowsInSection`

    ```
     - (void)valueChanged:(id)sender
      {
        if(self.segment.selectedSegmentIndex==0)
        {
            self.items = what ever
        }else{
            self.items = what ever
        }
        [tableview reloadData];
       }

        - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
         return [self.items count];
       } 
    ```

祝你好运

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T18:24:12.740

更改 UISegmentedControl 的值后，您需要更新表。你可以很容易地做到这一点，`[tableView reloadData];`或者你可以使用类似的东西`[tableView reloadSection:0 withTableViewAnimation:UITableViewRowAnimationAutomatic];`

执行此操作的最佳位置可能是您的控件的 valueChanged 方法。

```
// Wherever you init your UISegmentedControl
segmentedControl addTarget:self selector:@selector(valueChanged:) forEvent:UIControlEventValueChanged];

- (void)valueChanged:(id)sender
{
    [tableview reloadData];
} 
```

# android - Nexus 7 通过 Windows 7 x64 的“adb 设备”在 USB 上不可见

> ID：11974700
> 
> 赞同：182
> 
> 时间：2012-08-15T18:11:16.893
> 
> 标签：android, adb, sideloading

我已经做了很明显的事情——USB驱动程序是从最新的Android SDK安装的，并且平板电脑中的USB调试已打开。

连接[Nexus 7](https://en.wikipedia.org/wiki/Nexus_7_%282012_version%29)后，设备在 Windows[设备管理器](http://en.wikipedia.org/wiki/Device_Manager)中显示为“Android Phone”/“Android Composite ADB Device”，其属性显示驱动程序版本 6.0.0.0，因此正确的驱动程序已安装并正常工作。

这也证明设备处于 USB 调试模式，因为如果不是，它会显示在 Windows 的“便携式设备”/“Nexus 7”下。

问题是`adb devices`没有显示任何设备，而且[Eclipse](http://en.wikipedia.org/wiki/Eclipse_%28software%29)也（毫不奇怪）也不提供 Nexus 7 作为运行应用程序的硬件设备。

我已经重新启动了两个设备但没有效果。

我能弄清楚的唯一调试是 enable `ADB_TRACE=all`，但这什么也没告诉我：

```
mkh@MULE ~/AppData/Local/Android/android-sdk/platform-tools
$ export ADB_TRACE=all

mkh@MULE ~/AppData/Local/Android/android-sdk/platform-tools
$ adb devices
system/core/adb/adb.c::main():Handling commandline()
system/core/adb/adb_client.c::adb_query():adb_query: host:devices
system/core/adb/adb_client.c::_adb_connect():_adb_connect: host:version
system/core/adb/sysdeps_win32.c::socket_loopback_client():socket_loopback_client: port 5037 type tcp => fd 100
system/core/adb/transport.c::writex():writex: fd=100 len=4: 30303063 000c
system/core/adb/transport.c::writex():writex: fd=100 len=12: 686f73743a76657273696f6e host:version
system/core/adb/transport.c::readx():readx: fd=100 wanted=4
system/core/adb/transport.c::readx():readx: fd=100 wanted=4 got=4
4f4b4159 OKAY
system/core/adb/adb_client.c::_adb_connect():_adb_connect: return fd 100
system/core/adb/adb_client.c::adb_connect():adb_connect: service host:devices
system/core/adb/transport.c::readx():readx: fd=100 wanted=4
system/core/adb/transport.c::readx():readx: fd=100 wanted=4 got=4
30303034 0004
system/core/adb/transport.c::readx():readx: fd=100 wanted=4
system/core/adb/transport.c::readx():readx: fd=100 wanted=4 got=4
30303164 001d
system/core/adb/sysdeps_win32.c::adb_close():adb_close: 100(lo-client:5037)
system/core/adb/adb_client.c::_adb_connect():_adb_connect: host:devices
system/core/adb/sysdeps_win32.c::socket_loopback_client():socket_loopback_client: port 5037 type tcp => fd 101
system/core/adb/transport.c::writex():writex: fd=101 len=4: 30303063 000c
system/core/adb/transport.c::writex():writex: fd=101 len=12: 686f73743a64657669636573 host:devices
system/core/adb/transport.c::readx():readx: fd=101 wanted=4
system/core/adb/transport.c::readx():readx: fd=101 wanted=4 got=4
4f4b4159 OKAY
system/core/adb/adb_client.c::_adb_connect():_adb_connect: return fd 101
system/core/adb/adb_client.c::adb_connect():adb_connect: return fd 101
system/core/adb/transport.c::readx():readx: fd=101 wanted=4
system/core/adb/transport.c::readx():readx: fd=101 wanted=4 got=4
30303030 0000
system/core/adb/transport.c::readx():readx: fd=101 wanted=0
system/core/adb/transport.c::readx():readx: fd=101 wanted=0 got=0

system/core/adb/sysdeps_win32.c::adb_close():adb_close: 101(lo-client:5037)
List of devices attached
***NOTHING SHOWN***** 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：268
> 
> 时间：2012-08-16T16:29:51.960

When the Nexus 7 is plugged in there is a persistent notification that indicates "**CONNECT AS / Media Device (MTP)**". In this state `adb devices` will not show the Nexus, or undoubtedly any other device. Not exactly obvious, but if you select the second option "Camera (PTP)" the device is available for debugging (the lesson is ignore the camera, and focus on the protocol PTP).

This configuration is persistent, and I'm guessing that with a brand new device it will connect as MTP until told otherwise.

Thanks to [@Ciaran Gallagher](https://stackoverflow.com/users/606602/ciaran-gallagher) `Settings --> Storage --> Top Left Option (Computer USB Connection) tap--> choose MTP`

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2013-01-01T00:04:11.950

除了将 USB 连接/存储模式设置为“相机 (PTP)”之外，我还必须启用开发者模式，该模式从 4.2 开始就被隐藏了。

1.  转到“设置”菜单，然后向下滚动到“关于手机/平板电脑”。点击它。
2.  再次向下滚动到底部，您会看到“内部版本号”。
3.  点击它七 (7) 次。第三次点击后，您会看到一个有趣的对话框，说您距离成为开发人员还有四次点击。继续点击，你就有了开发者设置。
4.  现在在“设置”下有“开发者选项”。点击它。
5.  点击“USB 调试”以启用它。

来源：*[如何在 Android 4.2 上启用开发者设置](http://www.androidcentral.com/how-enable-developer-settings-android-42)*

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2012-12-29T16:12:55.017

在**Windows 7/8 32bit/64bit**上修复/安装 Android USB 驱动程序：

1.  将 Android 设备连接到计算机的 USB 端口。
2.  从桌面或 Windows 资源管理器中右键单击计算机，然后选择**管理**。
3.  在左侧窗格中选择设备。
4.  在右侧窗格中找到并展开其他设备。
5.  右键单击设备名称（**Nexus 7** / **Nexus 5** / **Nexus 4**）并选择**更新驱动程序软件**。这将启动硬件更新向导。
6.  选择**浏览我的计算机以查找驱动程序软件**，然后单击下一步。
7.  单击**浏览**并找到 USB 驱动程序文件夹。（Google USB 驱动程序位于`<sdk>\extras\google\usb_driver\`.）
8.  单击**下一步**安装驱动程序。

如果它仍然不起作用，请尝试从**MTP**更改为**PTP**。

![MTP -> PTP](../Images/bce9592115b8dd929f40c47d09f011ee.png)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-11-16T01:37:02.363

我发现您还可以执行设备管理器->更新驱动程序软件->浏览我的计算机以查找驱动程序软件->让我从计算机上的设备驱动程序列表中选择-> Android手机-> [ADB驱动程序版本6靠近顶部名单...对不起，我不记得确切的名字]

一旦我这样做了，它就连接了，我能够在 Windows 7 64 位上侧载 4.2 版。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-12-19T14:08:43.163

我在 Windows 7 x64 上使用 Nexus 7 (4.2)。这里描述的其他方法都不适合我。该选项卡已处于 PTP 模式。最后，当我将以下行添加到 <android-sdk>\extras\google\usb_driver 下的“android_winusb.inf”并执行“更新驱动程序”时，我可以让它工作：

```
%CompositeAdbInterface%     = USB_Install, USB\VID_18D1&PID_4E44&REV_9999&MI_01 
```

要获取确切的硬件 ID（在我的情况下为 USB\VID_18D1&PID_4E44&REV_9999&MI_01），您可以转到*计算机管理*->*设备管理器*->*详细信息*选项卡 -> 从下拉列表中选择硬件 ID。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-11-13T20:20:49.487

我有一个类似的问题并尝试了其他建议。

利用从[http://www.junefabrics.com/android/download.php](http://www.junefabrics.com/android/download.php)下载的 PdaNet 驱动程序最终完成了这项工作，并允许我最终通过 ADB 连接。在从这里安装驱动程序之前，我无法识别我的 Nexus，以便在我的设备上加载新的 Android 4.2。

我正在使用 Nexus 7 运行 Windows 7 64 位。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-08-21T02:21:40.760

我有类似的问题，我发现取消选中所有选项（MTP 和 PTP）允许设备从我的计算机获取 RSA 指纹，然后“adb 设备”工作。

请记住，在 Android 4.2+ 设备可以通过 ADB 连接之前，必须接受 RSA 指纹，这显然是出于安全原因。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-08-15T18:27:26.947

尝试这个。如果未检测到您的设备，请使用`PdaNet`. 你可以从[这里](http://download.cnet.com/PdaNet/3000-10440_4-75059341.html)下载。下载并安装在您的机器上。连接手机。它会自动检测来自 Internet 的驱动程序。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-12-16T22:06:09.960

PDANet 驱动程序是我在 Windows 7 x64 上成功连接到 Google Galaxy Nexus 4.2.1 的唯一解决方案，它拒绝/忽略来自最新 4.2 ADK（修订版 7）的官方 USB 驱动程序 - [http://junefabrics.com/android/索引.php](http://junefabrics.com/android/index.php)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-12-22T23:16:29.613

我也有一个 Nexus 7 和 Windows 7 64 位，并且大约一个月前在这个线程和其他线程中磕磕绊绊让 ADB 工作。然后它停止工作。我记得之前发生的唯一一件奇怪的事情是 Windows 在我启动时安装了一些蓝牙驱动程序（我没有蓝牙设备）。

这次我折腾了一天。现在它又开始工作了！我做的最后一件事是使用设备管理器“禁用”设备并重新启动。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-12-28T22:54:03.153

我安装了[HTC One](https://en.wikipedia.org/wiki/HTC_One)驱动程序，我认为这是无法正常工作的原因。然而，事实证明，原因是我禁用了 MTP/PTP。

我没有找到设置的地方，但后来我找到*[了 How to Configure the USB on Your Nexus 7](http://www.dummies.com/how-to/content/how-to-configure-the-usb-on-your-nexus-7.html)*。

这让我很困惑，它位于“*存储*”选项卡中。MTP 或 PTP 都适合我。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-04-23T18:59:38.580

就我而言，我有两个问题：

1.  我的电脑有一个以前的“Samsung Galaxy II”驱动程序并将其分配给我的 Nexus 7。我需要多次卸载它。最后我可以绑定正确的 Nexus 7 驱动程序。

2.  需要设置 PTP 选项。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-04-29T20:05:16.633

另一种选择是，如果您的 PC 上的 Windows 更新完全关闭。在这种情况下，即使您下载了 USB 驱动程序并尝试如上所述手动更新它，它也不起作用。在这种情况下，唯一的方法是启用 Windows 自动更新驱动程序。启用此功能后，请从设备管理器中删除不工作的驱动程序并通过 USB 电缆将平板电脑连接到 PC。驱动程序将由 Windows 自动下载和安装。这种方式适用于我的 Windows 7 PC。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-06-05T01:51:54.027

我在 Win 7 64 位上，我看到大多数人在这里遇到同样的问题也在 64 位上。为了排除硬件和操作系统，我使用 VMware 在同一台 PC 上运行 Win 7 32 位。除了必须使用正确的 VID/PID 编辑 .inf 文件外，其他一切都在 Win 7 32 位上完美运行，这告诉我 PC 很好，Win 7 32 位也很好。

回到我的 Win 7 64 位，上面的建议都不适合我。但是我注意到一件事，ADB 安装在 Program Files (x86) 下，但驱动程序安装程序正在安装 64 位。Win 7 64 位将 Nexus 7 识别为 Android 复合 ADB 接口，但 ADB 未检测到它。

那么某处是否有 ADB 64 位版本？如果我的安装在 Win 7 64 位上的 (x86) 下，这是否意味着我在某处搞砸了安装。

我的问题是否与安装了 64 位的 USB 驱动程序但 ADB 是 32 位有关？

我在属性中安装 Nexus 7 USB 驱动程序时注意到的另一个问题我只看到用于设备功能的 Android 复合 ADB 接口。在 Win 7 32 位属性下显示 3 个设备功能。

![赢 7 64b](../Images/9515e70f8065d534e3bde34483d306c2.png) ![赢 7 32b](../Images/85db93e00b3ba9a26a4fc69de2b4c842.png)

看起来问题仍然是USB驱动程序。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-02-12T21:15:28.783

完整清单：

1.  在设备上[启用调试](https://stackoverflow.com/questions/18103117/how-to-enable-usb-debugging-in-nexus-7)
2.  选择 USB 连接作为 PTP（相机）
3.  从[http://developer.android.com/sdk/win-usb.html](http://developer.android.com/sdk/win-usb.html)**安装****[驱动程序](https://dl-ssl.google.com//android/repository/latest_usb_driver_windows.zip)**

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-06-15T08:48:01.380

在 PTP 之上似乎为我解决此问题的解决方案`Always allow from this computer`在允许 USB 调试时未选择。每次连接设备时撤销授权并手动接受为我解决了这个问题。( `Settings -> Developer options -> Revoke USB debugging authorisations`)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-10-27T01:21:32.730

对于那些只`Kedacom usb device`在设备管理器中看到并且无法让 adb 看到手机的 Nexus 5x 的人......诀窍是`Update driver...`在 Kedacom 设备上并将其更改为“Android ADB 接口/设备”

# objective-c - NSmanagedObject copyWithZone 问题

> ID：11974701
> 
> 赞同：2
> 
> 时间：2012-08-15T18:11:20.547
> 
> 标签：objective-c, ios, core-data, copywithzone

我有一个自定义类 Thing:NSManagedObject，其属性为 adminName。

我试图在这个 Thing 类中创建一个 copyWithZone 函数，但是当我运行应用程序时，它说 setAdminName 不存在。

在我正在使用的实现文件中

```
@dynamic adminName;

-(id) copyWithZone: (NSZone *) zone
{
Thing *regCopy = [[Thing allocWithZone: zone] init];
regCopy.attendeeNum = [self adminName];

return regCopy;
} 
```

我不相信我可以将@dynamic 更改为@synthesize，因为我使用的是Core Data。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T18:49:54.077

NSManagedObject 不符合 NSCopying 协议。如果要创建具有相同数据的新记录，只需插入一个新对象并将第一个对象的值分配给第二个对象即可。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-15T18:45:38.677

您将需要以与创建原始事物相同的方式创建新事物，例如

事物 *regCopy = [NSEntityDescription insertNewObjectForEntityForName:@"Thing" inManagedObjectContext:self.managedObjectContext]

# ipad - iPad3 可以模拟 iPad2 进行应用测试吗？

> ID：11974702
> 
> 赞同：2
> 
> 时间：2012-08-15T18:11:21.740
> 
> 标签：ipad, mobile

我必须开发一个 iPad 应用程序，而我实际上并没有 iPad，所以我现在买了一个，最好是 iPad3，因为它是最新最好的。但是，该应用程序的许多潜在用户可能会在一段时间内使用他们的旧 iPad2。而且由于 iPad3 比 iPad2 好得多（一方面是分辨率的两倍），我担心如果我在 iPad3 上进行测试，我将无法了解 iPad2 上的应用程序会是什么样子.

所以问题是：是否有可能做一些事情，比如将分辨率设置为非视网膜显示设置，一般来说，为了应用程序测试目的，让 iPad3 表现得像 iPad2？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:17:14.347

除了分辨率，我看不出 iPad 2 和 3 之间的主要区别。模拟器可以覆盖分辨率差异。至于处理器和速度等，除非您的应用程序是“内存怪物”，否则我看不出有什么大问题。

顺便说一句，您始终可以使用[Test Flight](https://testflightapp.com)之类的服务来吸引使用其他设备的用户并运行测试版。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T18:17:41.337

不可能将 iPad 3 的分辨率降低到 iPad 2 的分辨率，但是在性能方面，它在大多数情况下应该在 iPad 2 上工作得差不多或更好，因为额外的 iPad 3 马力都花在了额外的像素上。

我也不会担心太多。iPad 3 在上市的短时间内已经比 iPad 2 售出更多的单位。我认为使用物理 iPad 3 和 iOS 模拟器，您应该能够合理地确保您的应用程序正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T15:15:17.327

如果它们之间的一切都相同，那就太好了，但我们在 ipad2 和 ipad3 之间的 Web 应用程序肯定存在问题。我们有一项工作是为了让 ipad2 工作，后来导致 ipad3 出现问题。希望应用程序开发比 Web 应用程序更好。

# php - 评论表单的验证

> ID：11974703
> 
> 赞同：2
> 
> 时间：2012-08-15T18:11:22.563
> 
> 标签：php, validation, codeigniter

我正在 Codeigniter 中开发一个评论系统，希望能得到一些关于我应该采用什么样的验证规则的建议。我不想允许任何图像或其他任何 HTML。

到目前为止，我只有`trim`并`max_length`设置。`htmlspecialchars`在插入数据库之前，我还会运行内容。我在全球范围内启用了 XSS 过滤。

我还应该采取哪些其他预防措施？htmlspecialchars 是否足以防止输入 Javascript 或其他恶意代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T19:08:26.023

您可能应该对 required 和 max_length 进行常规[表单验证](http://codeigniter.com/user_guide/libraries/form_validation.html)，并且显然在将内容推送到数据库之前进行 xss 过滤。htmlspecialchars 应该只应用于不在标签中的字符，所以你不能直接做 htmlspecialchars。你需要：

`<br/>`1 - 像“ ”或“ ”一样剥离标签元素（并存储它们）`<b>`，但不剥离它们的内容，这意味着“ `<b>`”和“ `</b>`”内没有任何内容。您可以使用[preg_match](http://php.net/manual/en/function.preg-match.php)来做到这一点。

2 - 对所有剩余文本执行 htmlentities

3 - 删除所有不需要的显式标签（从存储的标签束中）

```
strip_tags ( string $str [, string $allowable_tags ] ) 
```

4 - 然后过滤属性和内容的允许标签。黑客使用类似代码的情况并不少见

```
<b onMouseOver="window.open(..)"></b> 
```

要解决这个问题，要么你必须做一些额外的工作，并且可能使用一些正则表达式。如果您希望我编写更多示例代码，请告诉我。

6 - 将标签元素重新添加回文档。

我现在基本上就是把这个煮熟了。该算法可以提高效率（即先去除不需要的标签，然后继续过滤 html 实体和标签内容），但我会留给你。

据我所知，这是目前潜在的黑客攻击。不过，可能还有其他方法可以破解您的输入，因此您可能想检查一下其他评论框系统使用哪些其他评论框系统进行验证，例如[phpbb 论坛系统](http://www.phpbb.com/)。另一种选择可能是使用 phpbb 方括号格式来处理标签，这样您就不会让用户输入任何 html 标签，而是使用您控制的方括号标签。

这回答了你的问题了吗 ？

# javascript - Jcrop 与主干/jquery

> ID：11974706
> 
> 赞同：0
> 
> 时间：2012-08-15T18:11:57.650
> 
> 标签：javascript, jquery, backbone.js, jcrop

我正在使用 jquery，我想为我的项目实现 Jcrop。但是在我看到的所有示例中，它都是在 php.ini 中实现的。我不太擅长 php。有人可以帮助我了解如何将 Jcrop 与 JQuery 一起使用吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:51:36.100

I don't think backbone.js has anything to do with it unless you're uploading images with it. What you do is use Jcrop to set the crop parameters (x,y, w,h) etc and send that to the server along with the image, the server then crops the image based on that parameter.

# powershell - Powershell：简单的 Foreach 添加

> ID：11974707
> 
> 赞同：1
> 
> 时间：2012-08-15T18:12:07.310
> 
> 标签：powershell, addition

所以我尝试`.Responsetime's`使用`foreach`循环简单地将 5 的值相加，但我无法让它工作：

```
function go
{
$ping_cycle = test-connection -count 5 -computername www.google.com | select Responsetime
$sum = 0
foreach($item in $ping_cycle)
{
[void]$sum +$item.responsetime
}
$sum
} 
```

去

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T18:18:35.867

```
(test-connection www.google.com -count 5 | `
      Measure-Object -Property ResponseTime -sum).sum 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T18:20:34.103

您必须增加 $sum 而不是重新分配它：

```
$sum += $item.responsetime 
```

# python - 为什么 Tkinter 画布要求 4 个额外像素的宽度和高度？

> ID：11974710
> 
> 赞同：5
> 
> 时间：2012-08-15T18:12:21.373
> 
> 标签：python, tkinter, tk

```
>>> import Tkinter
>>> c = Tkinter.Canvas(width=100, height=100)
>>> c.winfo_reqwidth()
104
>>> c.winfo_reqheight()
104 
```

如果我将边框宽度设置为零，结果是相同的。我找不到解释或控制这 4 个额外像素的设置或属性。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-15T18:50:54.570

知道了！

```
c = Tkinter.Canvas(width=100, height=100, highlightthickness=0)
>>> c.winfo_reqwidth()
100 
```

我调试问题的方式也可能对其他有需要的人有用：

```
import pprint
pprint.pprint(c.configure())
{'background': ('background',
                'background',
                'Background',
                'SystemButtonFace',
                'SystemButtonFace'),
 'bd': ('bd', 'borderWidth'),
 'bg': ('bg', 'background'),
 'borderwidth': ('borderwidth', 'borderWidth', 'BorderWidth', '0', '0'),
 'closeenough': ('closeenough', 'closeEnough', 'CloseEnough', '1', '1.0'),
 'confine': ('confine', 'confine', 'Confine', '1', '1'),
 'cursor': ('cursor', 'cursor', 'Cursor', '', ''),
 'height': ('height', 'height', 'Height', '7c', '100'),
 'highlightbackground': ('highlightbackground',
                         'highlightBackground',
                         'HighlightBackground',
                         'SystemButtonFace',
                         'SystemButtonFace'),
 'highlightcolor': ('highlightcolor',
                    'highlightColor',
                    'HighlightColor',
                    'SystemWindowFrame',
                    'SystemWindowFrame'),
 'highlightthickness': ('highlightthickness',
                        'highlightThickness',
                        'HighlightThickness',
                        '2',
                        '0'),
 'insertbackground': ('insertbackground',
                      'insertBackground',
                      'Foreground',
                      'SystemButtonText',
                      'SystemButtonText'),
 'insertborderwidth': ('insertborderwidth',
                       'insertBorderWidth',
                       'BorderWidth',
                       '0',
                       '0'),
 'insertofftime': ('insertofftime', 'insertOffTime', 'OffTime', '300', '300'),
 'insertontime': ('insertontime', 'insertOnTime', 'OnTime', '600', '600'),
 'insertwidth': ('insertwidth', 'insertWidth', 'InsertWidth', '2', '2'),
 'offset': ('offset', 'offset', 'Offset', '0,0', '0,0'),
 'relief': ('relief', 'relief', 'Relief', 'flat', 'flat'),
 'scrollregion': ('scrollregion', 'scrollRegion', 'ScrollRegion', '', ''),
 'selectbackground': ('selectbackground',
                      'selectBackground',
                      'Foreground',
                      'SystemHighlight',
                      'SystemHighlight'),
 'selectborderwidth': ('selectborderwidth',
                       'selectBorderWidth',
                       'BorderWidth',
                       '1',
                       '1'),
 'selectforeground': ('selectforeground',
                      'selectForeground',
                      'Background',
                      'SystemHighlightText',
                      'SystemHighlightText'),
 'state': ('state', 'state', 'State', 'normal', 'normal'),
 'takefocus': ('takefocus', 'takeFocus', 'TakeFocus', '', ''),
 'width': ('width', 'width', 'Width', '10c', '100'),
 'xscrollcommand': ('xscrollcommand',
                    'xScrollCommand',
                    'ScrollCommand',
                    '',
                    ''),
 'xscrollincrement': ('xscrollincrement',
                      'xScrollIncrement',
                      'ScrollIncrement',
                      '0',
                      '0'),
 'yscrollcommand': ('yscrollcommand',
                    'yScrollCommand',
                    'ScrollCommand',
                    '',
                    ''),
 'yscrollincrement': ('yscrollincrement',
                      'yScrollIncrement',
                      'ScrollIncrement',
                      '0',
                      '0')} 
```

因此，在查看了全套配置之后，我猜它要么是 highlight 要么是 closeenough 参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T18:52:12.393

Because that `winfo_reqwith()` and `winfo_reqheight()` methods doesn't return actual width and height of a widget. This is what documentation says:

> ```
> winfo_reqheight(), winfo_reqwidth(). 
> ```
> 
> Return the "natural" height (width) for self. The natural size is the **minimal size needed to display the widget's contents, including padding, borders, etc**. This size is calculated by the widget itself, based on the given options. The actual widget size is then determined by the widget's geometry manager, based on this value, the size of the widget's master, and the options given to the geometry manager.

# excel - 如何在excel中从姓氏，名字创建帐户名

> ID：11974717
> 
> 赞同：0
> 
> 时间：2012-08-15T18:12:59.127
> 
> 标签：excel, concatenation

我在 Excel 中有一个 FullName 列。此列中的数据类似于 LastName、FirstName。

我需要在需要连接 First Initial 和 lastName 的地方添加第二列“AccountID”。

例如，史密斯，约翰应该是 jSmith

我试过 Left(fullname) 但它不起作用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:18:04.967

您可以使用该`FIND`命令查找逗号的位置。从那里，您可以使用`MID`and`LEFT`提取第一个名字的首字母和姓氏。把它们放在一起，你会得到：

```
=MID(A1, FIND(",",A1) + 2,1) & LEFT(A1,FIND(",",A1)-1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T18:19:02.747

如果您的数据在单元格 A1 中，请尝试以下操作：

`=MID(A1,FIND(", ",A1)+2,1)&LEFT(A1,FIND(",",A1)-1)`

*   *根据您上面的格式*

# c - C中的Realloc错误

> ID：11974719
> 
> 赞同：1
> 
> 时间：2012-08-15T18:13:07.207
> 
> 标签：c, pointers, malloc, void, realloc

我刚刚开始 C 阅读手册页，但找不到正确的答案。所以代码如下

```
void *p = malloc(10*sizeof(int));
int *q = p;
int NUMOFINT = 10;
for (int i = 0; i < NUMOFINT; i++){
printf("%i ", q[i]);
}
void *realloc(void *p, 20*sizeof(int));
for (int i = 0; i < 21; i++){
printf("%i ", q[i]); 
```

它给出了这个错误：

```
malloc.c: In function ‘main’:
malloc.c:31:24: error: expected declaration specifiers or ‘...’ before numeric constant 
```

我不太明白大小格式对于 realloc 是可以的，`malloc()`但对于 realloc 是不行的。那么我该如何纠正错误呢？

编辑：

所以当我把它变成：

```
void *morep = realloc(p, 20*sizeof(int));
int *q2 = morep;
for (int i = 0; i < 20; i++){
printf("%i ", q2[i]);
} 
```

它打印`q2[11]`为`135121`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:36:27.247

这个

```
void *realloc(void *p, 20*sizeof(int)); 
```

是错的。你要

```
p = realloc(p, 20*sizeof(int)); 
```

顺便说一句，这一行也是一个问题（但会编译得很好）：

```
for (int i = 0; i < 21; i++){ 
```

您将 p 分配给 20*sizeof(int) 字节，因此元素 20 超出了数组的末尾。你要：

```
for (int i = 0; i < 20; i++){ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T11:29:55.510

`realloc`可以尝试扩展堆中的现有内存块，如果不可能，它将为新大小分配一个新的单独内存块，并将数据从旧内存块复制到新内存块。

因此，如果 realloc 返回的地址与`p`然后它只是扩展旧的内存块相同。否则我们必须释放旧的内存块并开始使用`realloc`.

```
#define NUMOFINT 10
#define NUMOFINT_NEW 20

void *p = malloc(NUMOFINT * sizeof(int)); 
int *q = p; 
void *temp = NULL;

for (int i = 0; i < NUMOFINT; i++)
{ 
    printf("%i ", q[i]); 
} 

temp = realloc(p, NUMOFINT_NEW * sizeof(int)); 
if (temp == NULL)
{
    exit(0);
}
else if (temp != p)
{
    free(p);
    p = temp;
}

//else temp is equal to p

for (int i = 0; i < NUMOFINT_NEW; i++)
{ 
    printf("%i ", q[i]); 
} 
```

这里`q[0]`to`q[9]`将`0, 1, 2..9`分配值（），其余的（`q[10]`to `q[19]`）将具有垃圾值。我们还没有`memset`新分配的内存`0`。

你也可以在memset之前`for loop`，

```
memset((q + NUMOFINT), 0, (NUMOFINT_NEW - NUMOFINT)); 
```

## 您的程序中的错误是

1) 编译错误，因为 `void *realloc(void *p, 20*sizeof(int));`该语句看起来不像函数调用。

2) `for (int i = 0; i < 21; i++)`- 内存重新分配给`20`元素后，您只能访问 upto `19th`，访问`20th`可能会导致崩溃（未定义的行为）。

3) `it prints out q2[11] as 135121`- 新分配的内存既不`memset`分配`0`也不分配任何有意义的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T18:41:19.693

```
#include <stdlib.h>
#include <string.h>
#include <errno.h>
#include <stdio.h>

int main(int argc, char **argv)
{
        int *temp;  /* To use with realloc, it's more secure */
        void *p = malloc(10*sizeof(int));
        int *q = p;
        int NUMOFINT = 10;

        /* dont forget to compile with -std=99 flag, if you use this kind of for loop */
        for (int i = 0; i < NUMOFINT; i++){
                printf("%i ", q[i]);
        }
        printf("\n");

        /* It's more secure to use this kind of realloc */
        temp = realloc (p, 20 * sizeof(int) );
        if (temp == NULL)
        {
                fprintf(stderr,"Reallocation failed --> %s\n", strerror(errno));
                free(p);

                exit(EXIT_FAILURE);
        }
        else
        {
                p = temp;
        }

        /* Zeroing after realloc */
        for (int i = NUMOFINT; i < 21; i++)
                q[i] = 0;

        for (int i = 0; i < 21; i++)
        {
                printf("%i ", q[i]);
        }
        printf("\n");

        return 0;
} 
```

# php - 将复选框添加到 PHP 表单

> ID：11974720
> 
> 赞同：-1
> 
> 时间：2012-08-15T18:13:07.773
> 
> 标签：php, html

我有一个使用 PHP 创建的表单（我对它的理解几乎没有我想要的那么多） - 我不久前使用在线教程制作了表单，不太记得来自哪里，也找不到了，但是表格可以正常工作，所以我很满意。

唯一的事情是，我需要在我的表单中添加复选框，**它们不需要验证**（如果没有选中，表单仍然可以发送，如果它们都被选中，表单仍然可以发送..）

我需要做的是发回给我的电子邮件，让我知道哪些复选框被勾选了。

这是我的 HTML/PHP 页面：

```
<!--Contact Form Section -->    
<div id="contact-form" class="clearfix">  

        <?php  
//init variables  
$cf = array();  
$sr = false;  

if(isset($_SESSION['cf_returndata'])){  
$cf = $_SESSION['cf_returndata'];  
$sr = true;  
}  
?>

<form method="post" action="process.php">  

    <input type="email" id="email" name="email" placeholder="Your e-mail" value="    <?php echo ($sr && !$cf['form_ok']) ? $cf['posted_form_data']['email'] : '' ?>" required="required" />  

    <input type="text" id="name" name="name" placeholder="Your name" value="<?php echo ($sr && !$cf['form_ok']) ? $cf['posted_form_data']['name'] : '' ?>" required="required" />  

    <textarea id="message" name="message" placeholder="Your message..." required="required" data-minlength="20"><?php echo ($sr && !$cf['form_ok']) ? $cf['posted_form_data']['message'] : '' ?></textarea>  

<span id="loading"></span>  
<input type="submit" value="&nbsp;" id="submit-button" /> 

    <ul id="errors" class="<?php echo ($sr && !$cf['form_ok']) ? 'visible' : ''; ?>">  
    <li id="info">There is a problem:</li>  
<?php  
if(isset($cf['errors']) && count($cf['errors']) > 0) :  
    foreach($cf['errors'] as $error) :  
?>  
    <li><?php echo $error ?></li>  
<?php  
    endforeach;  
endif;  
?>  
</ul>  

<p id="success" class="<?php echo ($sr && $cf['form_ok']) ? 'visible' : ''; ?>">Thanks for your message!</p>
</div>

</form>  
<?php unset($_SESSION['cf_returndata']); ?>   
<!--End Contact Form Section --> 
```

这是我的过程PHP文档：

```
<?php  
if( isset($_POST) ){  

//form validation vars  
$formok = true;  
$errors = array();  

//submission data  
$ipaddress = $_SERVER['REMOTE_ADDR'];  
$date = date('d/m/Y');  
$time = date('H:i:s');  

//form data  
$name = $_POST['name'];  
$email = $_POST['email'];  
$telephone = $_POST['telephone'];  
$enquiry = $_POST['enquiry'];  
$message = $_POST['message'];  

//validate form data  

//validate name is not empty  
if(empty($name)){  
    $formok = false;  
    $errors[] = "You have not entered a name";  
}  

//validate email address is not empty  
if(empty($email)){  
    $formok = false;  
    $errors[] = "You have not entered an email address";  
//validate email address is valid  
}elseif(!filter_var($email, FILTER_VALIDATE_EMAIL)){  
    $formok = false;  
    $errors[] = "You have not entered a valid email address";  
}  

//validate message is not empty  
if(empty($message)){  
    $formok = false;  
    $errors[] = "You have not entered a message";  
}  
//validate message is greater than 20 characters  
elseif(strlen($message) < 20){  
    $formok = false;  
    $errors[] = "Your message must be greater than 20 characters";  
}  

//send email if all is ok  
if($formok){  
    $headers = "From: Goldie Locks online contact form" . "\r\n";  
    $headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";  

    $emailbody = "<p>You have received a new message from the enquiries form on your website.</p> 
                  <p><strong>Name: </strong> {$name} </p> 
                  <p><strong>Email Address: </strong> {$email} </p> 
                  <p><strong>Message: </strong> {$message} </p> 
                  <p>This message was sent from the IP Address: {$ipaddress} on {$date} at {$time}</p>";  

    mail("MY EMAIL!","New Enquiry",$emailbody,$headers);  

}  

//what we need to return back to our form  
$returndata = array(  
    'posted_form_data' => array(  
        'name' => $name,  
        'email' => $email,  
        'telephone' => $telephone,  
        'enquiry' => $enquiry,  
        'message' => $message  
    ),  
    'form_ok' => $formok,  
    'errors' => $errors  
);  

//if this is not an ajax request  
if(empty($_SERVER['HTTP_X_REQUESTED_WITH']) &&     strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) !== 'xmlhttprequest'){  
    //set session variables  
    session_start();  
    $_SESSION['cf_returndata'] = $returndata;  

    //redirect back to form  
    header('location: ' . $_SERVER['HTTP_REFERER']);  
}  
} 
```

从 html 代码中可以看出，我取出了 PHP 的一些功能，但将它们留在了 PHP 进程中（例如查询类型和电话号码），因为我完全不确定什么会破坏什么。

我需要做的就是在 html/php 文档中添加复选框（准确地说是 5 个），并在有人填写页面时将勾选的复选框显示在我收到的电子邮件中。

希望这对于具有 PHP 知识的人来说是一件容易的事，但遗憾的是我知道的很少。希望有人可以提供帮助，如果您需要更多信息，请发表评论，我会尽力而为。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T18:27:51.097

您可以通过简单地添加复选框输入元素来向表单添加复选框：

```
<input type="checkbox" name"myCheckbox" value="true" /> 
```

设置`value=""`为任何你想要的。然后你可以`value`在你的 PHP 脚本中使用：

```
$myCheckbox = $_POST['myCheckbox']; 
```

如果选中，该变量`$myCheckbox`将包含表单中名为“myCheckbox”的复选框的值，如果未选中该复选框，它将为空。

然后，您可以像使用其他变量一样将值添加到电子邮件中，即

```
$emailbody = "<p>You have received a new message from the enquiries form on your website.</p> 
    <p><strong>Name: </strong> {$name} </p> 
    <p><strong>Email Address: </strong> {$email} </p> 
    <p><strong>Message: </strong> {$message} </p>
    <p><strong>myCheckbox value: </strong> {$myCheckbox}</p>
    <p>This message was sent from the IP Address: {$ipaddress} on {$date} at {$time}</p>"; 
```

如果您想在表单已提交并且无论出于何种原因验证失败时保持已选中/未选中状态，则可以将复选框值添加到`$returndata`变量中：

```
$returndata = array(
    'posted_form_data' => array(  
        'name' => $name,  
        'email' => $email,  
        'telephone' => $telephone,  
        'enquiry' => $enquiry,  
        'message' => $message,
        'myCheckbox' => $myCheckbox,
    ),  
    'form_ok' => $formok,  
    'errors' => $errors
); 
```

这会将其发送回表单，然后您需要更改复选框以像其他元素一样查找此值，如果之前已选中，则将值“checked=Checked”添加到复选框：

```
<input type="checkbox" name"myCheckbox" value="true" <?php echo ($sr && !$cf['form_ok'] && $cf['posted_form_data']['myCheckbox]=="true") ? 'checked="checked"' : '' ?> /> 
```

其中`true`行的一部分`$cf['posted_form_data']['myCheckbox]=="true"`是复选框的`value=""`值。

我希望这是有道理的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T18:23:24.040

您只需将复选框输入添加到表单中，然后在 PHP 中检索它们：

的HTML：

```
<form method="post" action="process.php">  

<input type="email" id="email" name="email" placeholder="Your e-mail" value="    <?php echo ($sr && !$cf['form_ok']) ? $cf['posted_form_data']['email'] : '' ?>" required="required" />  

<input type="text" id="name" name="name" placeholder="Your name" value="<?php echo ($sr && !$cf['form_ok']) ? $cf['posted_form_data']['name'] : '' ?>" required="required" />  

<input type="checkbox" id="CHECKBOX1" name="CHECKBOX1" value="" />Checkbox 1 
```

（用您想要的复选框重复最后一次输入）

和 PHP：

```
<?php  
if( isset($_POST) ){  

//form validation vars  
$formok = true;  
$errors = array();  

//submission data  
$ipaddress = $_SERVER['REMOTE_ADDR'];  
$date = date('d/m/Y');  
$time = date('H:i:s');  

//form data  
$name = $_POST['name'];  
$email = $_POST['email'];  
$telephone = $_POST['telephone'];  
$enquiry = $_POST['enquiry'];  
$message = $_POST['message']; <br />
**$checkbox1 = $_POST['CHECKBOX1'];**

//validate form data  

//validate name is not empty  
if(empty($name)){  
    $formok = false;  
    $errors[] = "You have not entered a name";  
}  

//validate email address is not empty  
if(empty($email)){  
    $formok = false;  
    $errors[] = "You have not entered an email address";  
//validate email address is valid  
}elseif(!filter_var($email, FILTER_VALIDATE_EMAIL)){  
    $formok = false;  
    $errors[] = "You have not entered a valid email address";  
}  

//validate message is not empty  
if(empty($message)){  
    $formok = false;  
    $errors[] = "You have not entered a message";  
}  
//validate message is greater than 20 characters  
elseif(strlen($message) < 20){  
    $formok = false;  
    $errors[] = "Your message must be greater than 20 characters";  
}  

//send email if all is ok  
if($formok){  
    $headers = "From: Goldie Locks online contact form" . "\r\n";  
    $headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";  

    $emailbody = "<p>You have received a new message from the enquiries form on your website.</p> 
                  <p><strong>Name: </strong> {$name} </p> 
                  <p><strong>Email Address: </strong> {$email} </p> 
                  <p><strong>Message: </strong> {$message} </p> 
                  **<p><strong>Checkbox1: </strong>{$checkbox1}</p>**
                  <p>This message was sent from the IP Address: {$ipaddress} on {$date} at {$time}</p>";  

    mail("MY EMAIL!","New Enquiry",$emailbody,$headers);  

}  

//what we need to return back to our form  
$returndata = array(  
    'posted_form_data' => array(  
        'name' => $name,  
        'email' => $email,  
        'telephone' => $telephone,  
        'enquiry' => $enquiry,  
        'message' => $message  
    ),  
    'form_ok' => $formok,  
    'errors' => $errors  
);  

//if this is not an ajax request  
if(empty($_SERVER['HTTP_X_REQUESTED_WITH']) &&     strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) !== 'xmlhttprequest'){  
    //set session variables  
    session_start();  
    $_SESSION['cf_returndata'] = $returndata;  

    //redirect back to form  
    header('location: ' . $_SERVER['HTTP_REFERER']);  
}  
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T18:26:25.157

添加复选框：

```
<input type="checkbox" name="someName" id="someId" value=""/>Checkboxtitle 
```

用于生成复选框的 HTML 代码。然后，要将值添加到您的电子邮件中，您需要做的就是像调用常规文本框一样调用它。

# jquery - 包含样式表中提到的“td”样式的 jQuery 选择器

> ID：11974721
> 
> 赞同：1
> 
> 时间：2012-08-15T18:13:07.670
> 
> 标签：jquery

假设，我在一个名为 custom.css 的包含样式表中以及在下面的代码中的样式部分中提到了“td”样式，那么在 jQuery 中有一种方法可以获取样式表中提到的样式。

```
<!DOCTYPE html>
<html>
 <head>
   <link type="text/css" href="../custom.css" rel="stylesheet" />
    <style type="text/css">
      td {border: 2px solid red;background-color:lightyellow;}
    </style>
 </head> 
```

在 custom.css 中有一个 td 样式定义如下。

```
 td {border: 1px dashed black;background-color:pink;} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:39:06.110

没有 jQuery 选择器可以做到这一点。Javascript 访问 DOM，它并不*直接*“知道”**为什么**一个元素具有它所具有的计算样式。此外，正因为如此，如果没有给定的样式声明，DOM 不会跟踪计算出的样式。

也就是说，**可以**禁用给定的样式表：

[http://jsfiddle.net/dPA9u/](http://jsfiddle.net/dPA9u/)

您可以使用此方法关闭给定样式表，检查目标元素的计算样式，然后重新启用样式表。您最终会使用以前的样式，但用户不会看到任何事情发生：

```
var ele = document.getElementById('my_div');
document.styleSheets[3].disabled = true;
var bg_color = window.getComputedStyle(ele).backgroundColor;
document.styleSheets[3].disabled = false;
alert('Original background color is: '+bg_color); 
```

试试看：http: [//jsfiddle.net/GDSEK/1/](http://jsfiddle.net/GDSEK/1/)

将它们放在一起，您可以制作一个循环`document.styleSheets`查找目标工作表的脚本，禁用它，测量目标元素的计算样式，然后重新启用目标工作表。

这不与内联样式抗衡——但您也可以通过禁用**所有**样式表来检查这些样式，然后检查`element.style`

**文档**

*   `document.styleSheets`在 MDN - [https://developer.mozilla.org/en-US/docs/DOM/document.styleSheets](https://developer.mozilla.org/en-US/docs/DOM/document.styleSheets)
*   `stylesheet`MDN 上的对象 - [https://developer.mozilla.org/en-US/docs/DOM/stylesheet](https://developer.mozilla.org/en-US/docs/DOM/stylesheet)
*   `window.getComputedStyle`在 MDN - [https://developer.mozilla.org/en-US/docs/DOM/window.getComputedStyle](https://developer.mozilla.org/en-US/docs/DOM/window.getComputedStyle)
*   `element.style`在 MDN - [https://developer.mozilla.org/en-US/docs/DOM/element.style](https://developer.mozilla.org/en-US/docs/DOM/element.style)

# java - 从 Eclipse 创建一个可运行的 jar

> ID：11974728
> 
> 赞同：0
> 
> 时间：2012-08-15T18:13:19.860
> 
> 标签：java, executable-jar

过去 2 天我一直在尝试这个，但我无法到达任何地方。我正在使用 Eclipse，我有 4 个`src`文件和几个正在使用的外部库文件。现在我已经完成了我的应用程序，我正在尝试从 Eclipse 创建一个可运行的 jar。当我在家用电脑上执行此操作时，它工作正常，但是当我将该 jar 文件复制并粘贴到我的工作电脑中时，它根本无法加载。此外，当我尝试创建 jar 文件时，从我的工作 PC 上`JFrame`加载所有 GUI 界面，界面中的其他选项似乎不起作用。

我希望能够创建一个 .jar 或某种可执行文件，我提供该 ONE 文件的任何人都可以在没有任何 JRE、JDK 等的情况下使用它。我认为在计算机上安装 Java 会起作用，他们需要吗？所有这些工具包？`cmd`我希望它在不通过IDE使用源文件和库的情况下使其工作。

编辑：

```
java -Xmx1024m -jar filename.jar 
```

在命令行上工作。但如果我这样做，它会给我带来堆空间错误

```
java -jar filename.jar 
```

确切的错误：

```
Exception in thread "AWT-EVENTQUEUE-0" java.lang.OutOfMemoryError: Java heap space 
```

创建jar时是否可以通过eclipse进行VM参数？我不想创建一个`exe`来提出论点。

# actionscript-3 - 多次执行相同功能后，逐帧播放影片剪辑

> ID：11974731
> 
> 赞同：0
> 
> 时间：2012-08-15T18:13:37.570
> 
> 标签：actionscript-3, function, frame, add, movieclip

我有一个名为 failure_mc 的 MovieClip，它由 3 个足球组成，在我的游戏中，每次我的球员失败时，我都需要在 1 个球上添加一个 X 标记，我有一个 hitTestObject 检测球何时击中目标区域，但当球走到外面我需要在fails_mc中播放1帧并将X标记添加到一个球上（我在fails_mc中有3个不同的png文件，每帧1个），这是我正在使用的代码，但我不知道如何逐帧播放fails_mc（请记住，每次都会使用相同的函数，这就是为什么必须将每一帧添加到最后播放的帧：

```
if (ball.hitTestObject(goalie))
{
    goal_mc.play();
    net_mc.play();
}
else
{
    fails_mc.play(+=1); // This is not working

    trace("It’s a fail");
} 
```

在 3 次失败后，我必须触发另一个功能来完成游戏，但稍后我会弄清楚如何做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T19:28:32.953

我认为您所寻找的只是电影剪辑的 nextFrame() 函数。

您也可以使用 gotoAndStop("x1") - 其中“x1”是您希望电影剪辑转到的帧标签（或数字，如果不是引号）。您可以使用变量来跟踪当前状态。

```
var misses:int = 0;

if (ball.hitTestObject(goalie))
{

    goal_mc.play();
    net_mc.play();

}
else
{
    misses++;
    trace("It’s a fail");

    if(misses > 3){
        //do your game over stuff
    }else{
        fails_mc.gotoAndStop(misses)
    }
} 
```

# arrays - 安排 N 人的会议

> ID：11974732
> 
> 赞同：1
> 
> 时间：2012-08-15T18:13:38.570
> 
> 标签：arrays, algorithm, list

问题：有 N 个人和 S 个插槽。每个人都有一个他正在忙的插槽列表。我们必须找到一个算法来找到一个所有这些都是免费的插槽。

我已经知道一个复杂度为 O(NS) 的算法。需要更好的算法。

您可以自由地动态维护不同的数据结构（无论何时安排会议，它们都会更新），这些数据结构可用于最终找到一个空闲位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T18:57:27.520

为每个插槽保留一个插槽计数器。为每个繁忙的插槽添加一个到该插槽插槽计数器；为所有人忙碌的插槽。

任何在考虑了所有人的繁忙时段之后仍然为零的槽计数器是所有人空闲的槽的计数器。可能是 O(k) 算法。

您可以设置一个位掩码/位集，而不是计数，其中人 N 的位掩码在他们忙碌的所有位置都设置了位 S。所有人的位掩码的按位或将具有对应于所有空闲槽的零位。

更新：您陈述问题的方式，您不必跟踪人员，只需保留一系列插槽占用指标。最初都标记为免费；当您浏览每个人的忙碌时段时，将相应的占用指示器标记​​为忙碌。完成后，任何仍然可用的数组指标都是您的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T20:37:22.733

生成一个大小为 S 的位掩码，其中设置了 S 忙时的位。按位或所有位掩码一起，然后提取未设置的位。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T19:04:20.720

编辑：假设我们对每个人都有一个排序的插槽列表，算法将起作用

1.  现在您有 N 个大小为 S（最大）的列表。合并排序此列表：[http ://en.wikipedia.org/wiki/Merge_algorithm](http://en.wikipedia.org/wiki/Merge_algorithm)
2.  典型的合并排序（使用堆）将导致复杂度 NlogK，其中 N 是所有“K”列表中元素的总数。但是，如果您的版本，N 列表中的每个元素都限制在 0 和 s-1 之间。因此，复杂度也受 S*log(N) 的限制。以最大“N”的堆大小迭代 N 列表，以 S 迭代为界。说得通？

因此，整体复杂度 = N*log(S) + S*log(N)

这是假设原始列表已排序，否则复杂度会上升到 N(SlogS)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-15T20:32:43.373

请记住，很可能没有解决方案，[匈牙利算法](http://en.wikipedia.org/wiki/Hungarian_algorithm)将提供最接近的答案

# message-queue - Rabbitmq 监听 UDP 连接

> ID：11974734
> 
> 赞同：7
> 
> 时间：2012-08-15T18:13:49.187
> 
> 标签：message-queue, rabbitmq

有没有办法让 RabbitMQ 监听 UDP 连接并将这些数据包放入某种默认队列中，然后可以由标准客户端从中提取？ActiveMQ 或 ZeroMQ 会更好吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-17T14:46:05.983

考虑使用一个简单的代理前端来接收传入的 UDP 数据包并通过 AMQP 将它们发送到 RabbitMQ。例如，在 Python 中，您可以设置一个 UDP 服务器，然后使用 AMQP Pika 库与您的 RabbitMQ 服务器对话。

干杯!

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-09T02:11:39.053

有人还为rabbitMQ构建了一个udp-exchange插件。我没有亲自使用过它，但它似乎可以为您完成这项工作，而无需将您自己的 udp 编写到 amqp 转发器 ..

[https://github.com/tonyg/udp-exchange](https://github.com/tonyg/udp-exchange)

这是摘录

> 扩展 RabbitMQ 服务器，支持新的实验性交换类型 x-udp。每个创建的 x-udp 交换器在指定的 UDP 端口上侦听传入消息，并将它们中继到绑定到交换器的队列。它还接收发布到交换器的消息并将它们中继到指定的 IP 地址和 UDP 端口。

# jquery - 来自 ASHX 处理程序的 AJAX 返回类型

> ID：11974736
> 
> 赞同：0
> 
> 时间：2012-08-15T18:13:52.947
> 
> 标签：jquery, asp.net, .net, html, ajax

我正在编写一个需要与 SQL 服务器交换一些信息的页面。出于可移植性的原因，并且因为我讨厌编写 ASP，但我被告知要在 IIS 7 服务器上执行此操作，所以我正在用纯 HTML 编写页面，使用 C# .NET 中的通用处理程序 (ASHX) 来执行服务器-侧面的东西，并使用AJAX在它们之间进行通信。我已经让这种方法使用`Response.ContentType = "text/plain";`，但我想用一个请求返回几条信息，所以我切换到 XML 或 JSON，倾向于 XML。

因此，要返回 XML，我更改为 .NET `"text/xml"`，但是我只是`Response.Write`逐字记录整个 XML 代码，还是在 .NET 中内置了更简洁的方法？JSON的同样问题。我知道 jQuery（甚至只是 JavaScript）中有用于解析返回数据的特定方法，所以我想知道 .NET 中是否有类似的东西可以编码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T18:17:07.167

> 但是我只是 Response.Write 整个 XML 代码逐字写入，还是有更简洁的方式内置到 .NET 中？

您可以使用[XmlWriter](http://msdn.microsoft.com/en-us/library/system.xml.xmlwriter.aspx)、[XDocument](http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.aspx)甚至[XmlSerializer](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)来构建 XML，然后将其写入`Response.OutputStream`.

这是一个带有的示例`XDocument`：

```
public void ProcessRequest(HttpContext context)
{
    var doc = new XDocument(
        new XElement(
            "messages",
            new XElement(
                "message", 
                new XAttribute("id", "1"), 
                new XAttribute("value", "message 1"), 
            ),
            new XElement(
                "message", 
                new XAttribute("id", "2"), 
                new XAttribute("value", "message 2")
            )
        )
    );
    context.Response.ContentType = "text/xml";
    using (var writer = XmlWriter.Create(context.Response.OutputStream))
    {
        doc.WriteTo(writer);
    }
} 
```

> JSON的同样问题

You would use a Json serializer such as [JavaScriptSerializer](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx) and then write it to the output stream:

```
public void ProcessRequest(HttpContext context)
{
    var serializer = new JavaScriptSerializer();
    string json = serializer.Serialize(new
    {
        messages = new[]
        {
            new { id = 1, value = "message 1" },
            new { id = 2, value = "message 2" },
        }
    });
    context.Response.ContentType = "application/json";
    context.Response.Write(json);
} 
```

This being said, you should be aware that [ASP.NET MVC](http://www.asp.net/mvc) or the knocking on the door [Web API](http://www.asp.net/web-api) are now the preferred ways to expose such data instead of writing generic handlers.

# asp.net - 替换下拉列表中的项目

> ID：11974738
> 
> 赞同：1
> 
> 时间：2012-08-15T18:13:57.513
> 
> 标签：asp.net, drop-down-menu

我有一个绑定到某些项目的下拉列表。我想用文本框值替换所选项目，并再次想用新值绑定下拉列表。为此，我目前将下拉列表项存储在临时列表中。如何用文本框值替换当前选定的项目。

```
for (int i = 0; i < DropDownEmail.Items.Count; i++)
          {

                if (?)
                {
                    ObjRegistration = new ClassRegistration();
                    ObjRegistration.UserName = TextBoxEmail.Text;
                    tempEmailList.Add(ObjRegistration)
                }
                else{
                    ObjRegistration = new ClassRegistration();
                    ObjRegistration.UserName = DropDownEmail.Items[i].Text;
                    tempEmailList.Add(ObjRegistration);  
               }                     
          } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:33:13.430

您的代码现在写的没有多大意义，但一般来说，如果您想替换下拉列表中的项目，您需要执行以下操作：

```
 var selectedItem = tempEmailList.SelectedItem; //returns a ListItem object
 selectedItem.Text=txtField.Text;
 dropDownList.DataBind();  //Rebind it so you see the change. 
```

在您的情况下，您似乎正在绑定到自定义集合，`ClassRegistration`但由于您是在代码隐藏上执行此操作，因此一旦您第一次将元素绑定到下拉列表，您只有`Items`在下拉列表都是 type `ListItem`。

或者，您可以更新您的基础自定义集合并将其重新绑定到下拉列表：

```
var tempEmailList= ... //get it from DB or whatever

tempEmailList.Find(x => x.ID == int.Parse(ddl.SelectedItem.Value)).UserName = txtBox.Text;

ddl.DataSource = tempEmailList;//re-assing the datasource
ddl.DataBind();//rebind 
```

# cuda - red.shared 指令

> ID：11974739
> 
> 赞同：2
> 
> 时间：2012-08-15T18:13:58.533
> 
> 标签：cuda, gpgpu

我正在学习 CUDA，在查看了 PTX 手册后，我发现有一条名为 red.shared 的指令可以在扭曲中执行缩减。

我很好奇硬件是否具有对减少的本机支持。如果是这样，如何在 CUDA 代码中使用它？也许有人已经尝试过了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T19:52:32.877

实际上恰好是这样，我出于好奇也尝试了“红色”指令。我不知道这在开普勒上是怎么回事，但在费米架构上，“红色”指令只是映射到另一个指令序列。也许他们把它留给了未来的 GPU。这是我玩过的代码：

```
#define WS 32
#define HF 16

__global__ void test_red_kernel(unsigned *g_R, const unsigned *g_U) {

  extern __shared__ unsigned shared[];

  unsigned thid = threadIdx.x, bidx_x = blockIdx.x;
  unsigned *r = shared;
  unsigned ofs = bidx_x << 7, thid_in_warp = thid & WS-1;

  unsigned a = (g_U + ofs)[thid];

  volatile unsigned *t = (volatile unsigned *)r + HF + UMUL(thid >> 5,
        WS + HF + 1) + thid_in_warp;

  t[-HF] = 0;
t[0] = a;
// warp reduction
a = a + t[-HF], t[0] = a;
a = a + t[-8], t[0] = a;
a = a + t[-4], t[0] = a;
a = a + t[-2], t[0] = a;
a = a + t[-1], t[0] = a;

CU_SYNC

volatile unsigned *t2 = r + HF + UMUL(WS*4 >> 5, WS + HF + 1);

if(thid < 4) {

    unsigned loc_ofs = HF + WS-1 + UMUL(thid, WS + HF + 1);
    unsigned a2;

    volatile unsigned *ps = t2 + thid;
    ps[-2] = 0;

    a2 = r[loc_ofs]; ps[0] = a2;
    a2 = a2 + ps[-2], ps[0] = a2;
    a2 = a2 + ps[-1], ps[0] = a2;
}

CU_SYNC

a = a + t2[(thid >> 5) - 1];

unsigned b;      
asm volatile("mov.u32 %r11, shared;" : );
asm volatile("red.shared.add.u32 [%r11], %0;" :
            "+r"(b) : );

b = r[0]; // results of 'red.shared', compare it with a

(g_R + ofs)[thid] = a - b; 
} 
```

要查看“红色”指令是如何在硬件中实现的，您可以在生成的“cubin”文件上使用 cuobjdump 工具（使用选项 -keep 和 nvcc）

# android - Android非常简单的在线高分

> ID：11974741
> 
> 赞同：0
> 
> 时间：2012-08-15T18:14:10.290
> 
> 标签：android, variables

我基本上写完了我的第一个安卓应用程序，剩下的就是一个全球高分。我想保持简单。

我只想在线存储一个分数最高的变量，就是这样。

然后我的应用程序可以检查您的本地分数是否更高并更新变量。

最简单的方法是什么？我必须使用 mysql 数据库还是可以使用更简单的东西？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:19:31.187

您可以查看[scoreninja](http://scoreninja.appspot.com/)、[scoreloop](http://www.scoreloop.com/)或[parse](http://www.parse.com)。

`scoreninja`或者`scoreloop`可能是您的最佳选择。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T18:26:30.937

您可以使用 mySQL 数据库和 php 非常简单地做到这一点。只需创建一个包含一个字段（高分）的数据库。然后创建一个接受 $_GET['score'] 变量并将其与存储的分数进行比较的 php 脚本。如果它更高，则存储新分数。

然后，您可以在您的应用程序中调用 .../storeScore.php?score=XXXX。

您可以轻松地编写另一个仅用于获取分数的脚本。

这是一个很好的起点： [http ://www.freewebmasterhelp.com/tutorials/phpmysql/](http://www.freewebmasterhelp.com/tutorials/phpmysql/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T18:19:58.597

您可以使用[Google App Engine](https://developers.google.com/appengine/) + [Objectify](http://code.google.com/p/objectify-appengine/)来完成。这一切都是免费的。

# android - “Kill App”和“Force Stop” android 应用程序有什么区别？

> ID：11974746
> 
> 赞同：2
> 
> 时间：2012-08-15T18:14:29.557
> 
> 标签：android

在我的设备中，在任务杀手应用程序中，我可以选择“杀死”应用程序或“强制停止”它。这两者之间究竟有什么区别？

# php - 在 PHP (APC/memcached) 中使用分段缓存是否值得？

> ID：11974748
> 
> 赞同：1
> 
> 时间：2012-08-15T18:14:41.757
> 
> 标签：php, caching, memcached, apc

我主要想知道访问APC v.memcached（不是操作码缓存）的对象缓存的速度差异是什么。memcached 的主要优点是它是分布式的并且不限于本地机器。但是，由于它是通过网络传输的，因此存在某种延迟。

我想知道访问 APC（在机器上）和 memcached（在另一台服务器上）之间的速度差异是否足够大，足以保证有一个分阶段的缓存方案，程序首先尝试 APC，然后是 memcached，最后是数据库，如果所有其他失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:26:11.380

像大多数其他事情一样：这取决于。

如果您有很多计算并且可以存储结果，那么缓存将加快速度。如果您基本上只是从数据库中存储行，那么在内存缓存中会有所帮助，但 memcached 与数据库相比可能不会增加大量差异（假设数据库查询都很简单）。另一方面，如果您正在执行复杂的查询，或者进行大量编程工作来创建某些内容，那么缓存就更有意义了。

举个例子，我最近在一个由第三方承包商编写的网站上工作，他在设计期间没有做任何性能工作。它像牛一样慢，因为它有很多未优化的包含等。添加 APC 基本上将性能提高了 10 倍。添加 memached 可将加载时间减少 10 - 20 毫秒。

如果你已经足够远，那么做一些性能测试（查找 xdebug 或其他工具）并查看你的瓶颈在哪里，然后做出相应的计划。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T18:18:26.517

请记住，如果您用其他东西填满了 APC 缓存，那么 APC 将不得不再次为您的页面重新计算操作码。如果页面不断删除对象，这可能会导致问题，然后一旦页面运行，对象就会继续删除页面。不好玩。

请注意安全，不要试图将 APC 用于除配置值之外的任何内容，这不会导致您的页面被删除以腾出空间。

*TL;DR 一旦 APC 装满，您的网站将变慢，您的服务器将更加努力地工作。*

# css - 选择具有特定 id 且属于类的元素的正确方法是什么

> ID：11974750
> 
> 赞同：0
> 
> 时间：2012-08-15T18:14:54.063
> 
> 标签：css

就我而言，我有一个 class="fusion-module rt-center" 和一个#modlgn-remember。当#modlgn-remember 也是类 fusion-module rt-center 时，如何指定它来创建规则？

我会想这样的事情，但它不起作用：

```
.fusion-module rt-center #modlgn-remember {
xxx:xx;
xxx:xx;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T18:17:44.510

```
#modlgn-remember.fusion-module.rt-center { ... } 
```

空格用于后代选择器，因此您的原始选择器将选择位于 a`#modlgn-remember`内的`rt-center`元素（此处缺少点）内的元素`.fusion-module`。

另外，考虑重新考虑你的风格规则。页面上只能有一个带有 ID`modlgn-remember`的元素，因此在规则中添加类限定符似乎是多余的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T18:17:02.927

您需要将各种选择器链接在一起：

```
#modlgn-remember.fusion-module.rt-center 
```

这将搜索具有*和*`id="modlgn-remember`类的元素。`fusion-module` *`rt-center`*

 *CSS 选择器中的空格意味着一个后代元素，因此您的原始选择器 ( `.fusion-module rt-center #modlgn-remember`) 会查找位于元素`id="modlgn-remember"`内的`rt-center`元素，即位于 的元素内的元素`class="modlgn-remember"`。

显然，您的原始选择器不太可能返回您正在寻找的元素。

当然，请记住，an`id`在文档中是唯一的；因此，如果您只想获取该特定元素，则`id`只需*使用*`id`. `id`将选择器与类选择器耦合的唯一原因是`id` *只有当*它*也*有这些类时才选择它。这在 JavaScript 中通常很有用，尤其是。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T18:18:06.183

尝试这个：

```
#modlbn-remember.fusion-module.rt-center {
   ...
} 
```

选择具有该 id 的元素，并且必须分配两个类。

如果您想选择它，如果其中至少一个被分配使用：

```
#modlbn-remember.fusion-module,
#modlbn-remember.rt-center {
   ...
} 
```*

# android - 在微调器之间交换所选项目

> ID：11974753
> 
> 赞同：1
> 
> 时间：2012-08-15T18:15:08.190
> 
> 标签：android, spinner

将项目从 spinner1 更改为`spinner2`. 好的，我正在创建一个翻译器。我有`spinner1`一些语言和第二个使用相同语言的微调器。我从中选择一种“来自”语言，`spinner1`并从中选择一种“至”语言`spinner2`。好的，我想做的就是当我按下按钮时，它会交换选定的微调器项目。我不知道如何实现这一点。这是我的代码：

```
public class Example extends Activity {

ImageView MyChangeButton;
Spinner spinner1, spinner2;

@Override
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

MyChangeButton = (ImageView)findViewById(R.id.imageView1);
    MyChangeButton.setOnClickListener(MyChangeButtonOnClickListener);

    ArrayAdapter<CharSequence> adapter
    = ArrayAdapter.createFromResource(this,
    R.array.firstlanguage, android.R.layout.simple_spinner_item);

    spinner1 = (Spinner) findViewById(R.id.spinner1);
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    spinner1.setAdapter(adapter);

    spinner2 = (Spinner) findViewById(R.id.spinner2);
    adapter2.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    spinner2.setAdapter(adapter);

   }
 private ImageView.OnClickListener MyChangeButtonOnClickListener = new ImageView.OnClickListener(){

   public void onClick(View v) {

      ------>//Here the code that i want to do

       }

   };

   }; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T18:37:17.620

我从您的问题中了解到的是，您想在两个微调器之间交换值。

如果这两个微调器都使用相同的源，您可以执行以下操作。

```
int spinner1Index = spinner1.getSelectedItemPosition();

spinner1.setSelection(spinner2.getSelectedItemPosition());
spinner2.setSelection(spinner1Index ); 
```

让我知道这是否适合您，否则我们会找到另一种解决方案。

# javascript - FileReaderSync undefined inside Web Worker in Firefox extension using Add-on SDK

> ID：11974756
> 
> 赞同：2
> 
> 时间：2012-08-15T18:15:14.740
> 
> 标签：javascript, firefox-addon, firefox-addon-sdk

我设法使用插件 SDK 在我的 Firefox 插件中获得了 Web Worker（不是内容/工作者）。我在这里按照弗拉基米尔的建议让 Worker 类正常工作：[Concurrency with Firefox add-on script and content script](https://stackoverflow.com/questions/9216984/concurrency-with-firefox-add-on-script-and-content-script)

现在，我可以在我的代码中启动一个工作者，并可以通过发送/接收消息与它交谈。

这是我的 main.js 文件：

```
// spawn our log reader worker
var worker = new Worker(data.url('log-reader.js'));

// send and respond to some dummy messages
worker.postMessage('halo');
worker.onmessage = function(event) {
    console.log('received msg from worker: ' + event.data);
}; 
```

这是我的 log-reader.js 文件：

```
// this function gets called when main.js sends a msg to this worker
// using the postMessage call

onmessage = function(event) {
    var info = event.data;

    // reply back
    postMessage('hey addon, i got your message: ' + info);
    if (!!FileReaderSync) {
        postMessage('ERROR: FileReaderSync is not supported');
    } else {
        postMessage('FileReaderSync is supported');
    }

//    var reader = new FileReaderSync();
//    postMessage('File contents: ' + reader.readAsText('/tmp/hello.txt'));
}; 
```

我的问题是 log-reader.js 文件中没有定义 FileReaderSync 类，因此我收到了错误消息。如果我取消注释实际使用 FileReaderSync 的最后几行，我将永远不会在我的插件中收到消息。

我尝试使用与 Worker 相同的技巧，通过创建一个 dummy.jsm 文件并在 main.js 中导入，但 FileReaderSync 仅在 main.js 中可用，而在 log-reader.js 中不可用：

```
// In dummy.jsm
var EXPORTED_SYMBOLS=["Worker"];
var EXPORTED_SYMBOLS=["FileReaderSync"];

// In main.js
var { Worker, FileReaderSync } = Cu.import(data.url('workers.jsm'));
Cu.unload(data.url("workers.jsm")); 
```

我认为必须有一个解决方案，因为[这里](https://developer.mozilla.org/en-US/docs/DOM/FileReaderSync)的文档似乎表明 FileReaderSync 类应该对 Firefox 中的 Web Worker 可用：

> 此接口仅在工作人员中可用，因为它启用了可能会阻塞的同步 I/O。

那么，有没有办法让 FileReaderSync 在我的 Web Worker 代码中可用和可用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T07:06:44.190

`FileReaderSync` *实际上，如果*定义了，您的工作人员会发送“错误”，因为您两次否定了它。更改`!!FileReaderSync`为`!FileReaderSync`，它将正常工作。

我猜你试图找到你注释掉的代码的问题。问题是，`reader.readAsText('/tmp/hello.txt')`行不通 - 此方法需要一个 blob （或[file](https://developer.mozilla.org/en-US/docs/DOM/File)）。worker 本身无法构建文件，但您可以在扩展中创建它并通过消息发送给 worker：

```
worker.postMessage(new File("/tmp/hello.txt")); 
```

*注意*：我不确定附加 SDK 是否定义了`File`构造函数，您可能必须使用与构造函数相同的技巧`Worker`。

然后工作人员可以从此文件中读取数据：

```
onmessage = function(event)
{
    var reader = new FileReaderSync();
    postMessage("File contents: " + reader.readAsText(event.data));
} 
```

# c# - SharePoint 在页面加载时打开功能区

> ID：11974757
> 
> 赞同：0
> 
> 时间：2012-08-15T18:15:17.430
> 
> 标签：c#, javascript, sharepoint-2010, schema

我面临的问题是当我加载页面时功能区会自动打开，比如我点击快速启动菜单中的“客户信息”链接，我希望客户信息页面的功能区出现在加载页面。

我们有一些 javascript 可以在带有 webpart 的自定义页面上执行此操作，如下所示：

```
<script type="text/javascript">

$(document).ready(function () {
    WpClick({
        srcElement: $(".s4-wpcell").get(0),
        target: $(".s4-wpcell").get(0)
    });

    $(".item-select").click(function () {
        RefreshCommandUI();
    });
}); 
```

我正在尝试执行的页面只是您运行的带有“添加新项目”链接等的 SharePoint 页面。有没有办法通过架构文件执行此操作？或者有什么方法可以将上面的 javascript 代码放入模式文件中，这样它就可以做到这一点？

我愿意接受建议。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T01:08:31.237

我认为你有几个选择。

1.  如果您需要在该站点内的页面加载时始终打开功能区，则将 javascript 放在该站点的母版页中（这可能意味着您需要创建一个自定义母版页，该母版页源自您现在拥有的包含此 javascript 的母版页）
2.  如果这是在少数页面上（并且这个数字在未来不会增长），那么我建议将 javascript 放在内容编辑器 webpart 中。如果您希望网站上许多新创建的页面都需要此要求，这可能很难维护。
3.  如果您需要为多种页面类型加载功能区，请考虑为这些页面类型创建自定义页面布局（如果您还没有）并将 javascript 添加到您需要的页面布局中。如果您正在处理一堆已经使用开箱即用模板创建的页面，这可能不是一个好的选择，因为您需要进行某种迁移到新的页面布局。

# php - 计算日期之间的天数

> ID：11974758
> 
> 赞同：0
> 
> 时间：2012-08-15T18:15:28.023
> 
> 标签：php, mysql

我试图找出两个日期之间有多少天，下面的代码是我所说的一个例子，但它不起作用我在数据库中得到的所有内容都是 0

```
 <?php 
   $hotel_name = $_POST['hotelName'];
   $room_type  = $_POST['roomType'];
   //date From value
   $dayfrom    = $_POST['dayfrom'];
   $monthfrom  = $_POST['monthfrom'];
   $yearfrom   = $_POST['yearfrom'];  
   //date To value
   $dayto      = $_POST['dayto'];
   $monthto    = $_POST['monthto'];
   $yearto     = $_POST['yearto'];
   $arivDate = sprintf('%04d-%02d-%02d',  $yearfrom, $monthfrom, $dayfrom);
   $depDate  =  sprintf('%04d-%02d-%02d',   $yearto, $monthto, $dayto);
   $child = $_POST['child'];
   $adult = $_POST['adult'];
   $days = $arivDate - $depDate; 
   //$sortedfromdate  = strtotime($arivDate);
   //$sortedtodate = strtotime($depDate);
   $query = "INSERT INTO tempbooking( book_date, Ariv_date, dep_date, hotel_name
            )VALUES(
            CURDATE(), '{$arivDate}',  '{$depDate}', '{$hotel_name}')";
            if(mysql_query($query,$connection)){
                         $booking_id = mysql_insert_id();
            }else{
            die("The Booking was not successful". mysql_error());
            }
                        $queryres="INSERT INTO ro_reservation( booking_id, children, adult, room_type, number_days
                                  )VALUES(
                                  {$booking_id}, {$child}, {$adult}, '{$room_type}',{$days})";
                        if(mysql_query($queryres,$connection)){
                        header("Location:index.php");
                        //echo"<a href=\"index.php\"> Reservation Inserted</a>";
                        }else{
                        echo "Nothing was inserted in to the ro_reservation";
                        }        
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:20:53.967

```
 $arivDate = strtotime("2012-01-01");
 $depDate = strtotime("2012-08-14");
 $datediff = abs($arivDate - $depDate)
 echo floor($datediff/(60*60*24)); 
```

# php - 使用逗号将标签保存在数据库中的任何更好方法？

> ID：11974769
> 
> 赞同：0
> 
> 时间：2012-08-15T18:16:47.123
> 
> 标签：php, database, tags

目前我正在使用逗号“，”将标签保存为文本，当我需要它们处理和使用某处时，我需要分解字符串，例如“美国，加拿大，犯罪，多伦多，音乐，秋天”。

我在想是否有更好的方法（更少的资源和耗时的友好）来做这个标签，或者这是每个人都使用的唯一解决方案。

**编辑：我有一个小项目，在管理员中没有标签管理。我不需要三个表只用于数据库中的标签。我只是在寻找一些更聪明的解决方案，如何从数据库中保存的字符串中保存和分解标签。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T18:40:13.050

使用三表方法，真的！真的真的！

否则，您将如何查询带有“usa”标签的项目而不获取带有“usable”标签的项目？`LIKE %usa%`将返回两者。

有关在 db 中实现标签的三种方法的讨论，请参阅此： [http ://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html](http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html)

**编辑**回应评论：

> 逗号，逗号，逗号……

逗号无济于事 无济于事 无济于事。示例标签字段：`culture,usa`. 你会怎么`LIKE`做？

您可以按以下格式保存标签：（`,culture,usa,`声明并以逗号结尾）。

恕我直言，这将带来一些特殊情况，最终会变得比三表方法更复杂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T18:38:04.733

假设标签与某些项目（用户、博客等）相关，有一种简单的方法可以做到这一点

```
Table_Tags 
{ 
   tag_id:index for the table entries,
   item_id, 
   tag_code: usa,
   source: app_system, comment, fb, twitter etc
   <other audit fields>
} 
```

在处理项目/填充项目时，也可以填充标签。

希望这可以帮助

# c# - 创建物理文件

> ID：11974770
> 
> 赞同：0
> 
> 时间：2012-08-15T18:16:51.160
> 
> 标签：c#, wpf

在学习如何处理 WPF 上的可视对象时，我遇到了 MSDN 上的一个片段，如下所示。它运行但不确定我如何序列化它。问题是如何在这里物理创建文件 (*.bmp)？

[网址](http://msdn.microsoft.com/en-us/library/system.windows.media.drawingvisual.aspx)

谢谢！

```
Image myImage = new Image();
FormattedText text = new FormattedText("ABC",
        new CultureInfo("en-us"),
        FlowDirection.LeftToRight,
        new Typeface(this.FontFamily, FontStyles.Normal, FontWeights.Normal, new FontStretch()),
        this.FontSize,
        this.Foreground);

DrawingVisual drawingVisual = new DrawingVisual();
DrawingContext drawingContext = drawingVisual.RenderOpen();
drawingContext.DrawText(text, new Point(2, 2));
drawingContext.Close();

RenderTargetBitmap bmp = new RenderTargetBitmap(180, 180, 120, 96, PixelFormats.Pbgra32);
bmp.Render(drawingVisual);
myImage.Source = bmp; 
```

添加 Save() 方法后：

```
 Image myImage = new Image();
    FormattedText text = new FormattedText("ABC",
        new CultureInfo("en-us"),
        FlowDirection.LeftToRight,
        new Typeface(this.FontFamily, FontStyles.Normal, FontWeights.Normal, 
        new FontStretch()),
        this.FontSize,
        this.Foreground);
    DrawingVisual drawingVisual = new DrawingVisual();
    DrawingContext drawingContext = drawingVisual.RenderOpen();
    drawingContext.Close();

    RenderTargetBitmap bmp = 
         new RenderTargetBitmap(180, 180, 120, 96, PixelFormats.Pbgra32);
    bmp.Render(drawingVisual);
    myImage.Source = bmp;

    var enc = new PngBitmapEncoder();
    enc.Frames.Add(BitmapFrame.Create(bmp));
    using (var fs = new FileStream("c:\\temp\\Test.png", 
                   FileMode.Create, FileAccess.Write))
    {
        enc.Save(fs);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:33:25.507

您应该使用[`BitmapEncoder`](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapencoder.aspx)([`BmpBitmapEncoder`](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bmpbitmapencoder.aspx)对于 *.bmp 文件，但我建议您使用，[`PngBitmapEncoder`](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.pngbitmapencoder.aspx)因为您的图像具有透明度并将转换为完全黑色的 .bmp)：

```
var enc = new PngBitmapEncoder();
enc.Frames.Add(BitmapFrame.Create(bmp));
using(var fs = new FileStream("Test.png", FileMode.Create, FileAccess.Write))
{
    enc.Save(fs);
} 
```

# c++ - 如何将 auto_ptr 设置为 NULL

> ID：11974771
> 
> 赞同：3
> 
> 时间：2012-08-15T18:16:50.810
> 
> 标签：c++, stl, struct, binary-tree, auto-ptr

有没有办法将 auto_ptr 设置为 NULL 或等效项？例如，我正在创建一个由节点对象组成的二叉树：

```
struct Node {
    int weight;
    char litteral;
    auto_ptr<Node> childL;
    auto_ptr<Node> childR;
    void set_node(int w, char l, auto_ptr<Node> L, auto_ptr<Node> R){
        weight = w;
        litteral = l;
        childL = L;
        childR = R;
    }
}; 
```

对于不是父节点的节点，我计划这样做：

```
auto_ptr<Node> n(new Node);
(*n).set_node(i->second, i->first, NULL, NULL); 
```

这会引发错误。有没有办法将其设置为 NULL，或者是否有其他有意义的行动方案？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T18:19:50.430

采用指针的`std::auto_ptr`构造函数是显式的，以帮助防止意外将所有权转移到`std::auto_ptr`. 您可以传入两个默认构造的`std::auto_ptr`对象：

```
(*n).set_node(i->second, i->first, std::auto_ptr<Node>(), std::auto_ptr<Node>()); 
```

如果您的目标标准库实现包括`std::unique_ptr`，请考虑改用它。它没有 有问题的复制语义`std::auto_ptr`，因此`std::auto_ptr`已被弃用并被`std::unique_ptr`.

`std::unique_ptr`还有一个转换构造函数，允许从空指针常量进行隐式转换，因此`NULL`如果您使用`std::unique_ptr`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T19:11:41.757

如果您的编译器工具集支持它（例如 Visual C++ 10/11、Gcc 4.5？或更高版本），或者使用 boost::scoped_ptr（如果您使用 Visual C++ 9 或更早版本以及最新版本，我建议切换到 std::unique_ptr boost)，以避免 std::auto_ptr 的基本复制语义问题。

注意：std::unique_ptr 是一个 C++11 特性，它可能对选择编译器有额外的要求。

# html - Jquery Mousedown 和 Mouseover 问题

> ID：11974774
> 
> 赞同：1
> 
> 时间：2012-08-15T18:17:03.300
> 
> 标签：html, javascript-events, jquery

我编写了一个 jquery 函数来绑定 mousedown 上的 mouseover 事件，以获得单击并拖动以选择 td 的效果。我在表格行中有 10 个 td。这段代码的问题是，如果我想从 1 到 5 选择 td，并且我在 td1 上执行 mousedown 和 mouseover 直到 td5，td1 没有被选中（我正在检查/取消选中一个复选框）而是从 td2 中选择到td5。我如何解决它？任何建议表示赞赏。

这是代码：

```
$("#custom-interval-tbl td").mousedown(function() {
     $('#custom-interval-tbl td').bind('mouseover',function(){
            if($(this).find('input:checkbox').is(':checked')) {
                       $(this).find('input:checkbox').attr("checked", "");
                       $(this).css({background:"white"});
            } else {
                       $(this).find('input:checkbox').attr("checked", "checked");
                       $(this).css({background:"#6D7B8D"});
            }
     });
}); 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:21:04.493

分配`mouseover`事件时，它永远不会被鼠标已经按下的事件激活。（由于鼠标已经结束，它永远不会被调用。）

您可以强制在您已经选择的 TD 上调用它。

```
$("#custom-interval-tbl td").mousedown(function() {
     $('#custom-interval-tbl td').bind('mouseover',function(){
            if($(this).find('input:checkbox').is(':checked')) {
                       $(this).find('input:checkbox').attr("checked", "");
                       $(this).css({background:"white"});
            } else {
                       $(this).find('input:checkbox').attr("checked", "checked");
                       $(this).css({background:"#6D7B8D"});
            }
     });
     $(this).mouseover(); // This part will call the mouseover event on your clicked TD
}); 
```

# c++ - VS2010 链接器错误

> ID：11974780
> 
> 赞同：0
> 
> 时间：2012-08-15T18:17:22.740
> 
> 标签：c++, visual-studio-2010, header-files, linker-errors

**已解决**我的“WorkoutGeneratorMain.cpp”被 IDE 归类为 C++ 头文件。我不知道为什么会这样，但我修复了它。现在我要处理我所有的其他错误。

谢谢大家！

==================================================== =

在 Visual Studio 2010 Professional 中编译我的程序时出现以下错误：

> ------ 构建开始：项目：WorkoutGenerator，配置：调试 Win32 ------
> 构建开始于 2012 年 8 月 15 日下午 12:19:18。
> InitializeBuildStatus：
>   触摸“Debug\WorkoutGenerator.unsuccessfulbuild”。
> ClCompile：
>    LiftClass.cpp
> ManifestResourceCompile：
>    所有输出都是最新的。
> MSVCRTD.lib(crtexe.obj) : 错误 LNK2019: unresolved external symbol *main referenced in unction _* _tmainCRTStartup
> C:\Users\Shanalex\Documents\Programming\C++Programming\WorkoutGenerator\WorkoutGenerator\Debug\WorkoutGenerator.exe：致命错误 LNK1120 : 1 未解决的外部问题

在我的搜索中，我找到了几个解决此问题的指南；但是，他们几乎都建议该文件是设置为控制台设置的 Windows 应用程序，反之亦然。我的程序是一个控制台应用程序，所有设置对于一个 win32 控制台应用程序来说似乎都是正确的。有些地方存在链接错误，但我的项目设置似乎没有其他人有的任何问题。

我对 C++ 和 VS2010 中的多部分程序相当陌生。我很容易犯一个基本错误，但是在将我的代码与各种教程和书籍的代码进行比较时，我无法找到它。

我有三个代码文件，如下：

电梯类.h

```
//Lift Classes
//Defines the Lift Class

#ifndef LIFTCLASSHEADER_H_INCLUDED
#define LIFTCLASSHEADER_H_INCLUDED

#include <iostream>
#include <string>
#include <vector>
#include <random>
#include <ctime>

using namespace std;

class Lift
{
public:
    string LName;
    string LType;
    string LBody;
    vector<double> LLoadScale;

    Lift(string Name, string Type, string Body, 
        double Pawn, double Bishop, double Knight, double Rook, double Royal);
};

Lift::Lift(string Name, string Type, string Body, 
    double Pawn, double Bishop, double Knight, double Rook, double Royal)
{
    LName = Name,

    LType = Type,

    LBody = Body,

    LLoadScale.push_back(Pawn),
    LLoadScale.push_back(Bishop),
    LLoadScale.push_back(Knight),
    LLoadScale.push_back(Rook),
    LLoadScale.push_back(Royal);
}

#endif 
```

然后，我有电梯类的 .cpp 实现，以及随机化它们的函数。

电梯类.cpp

```
//Exercise Randomizer using Lift Class
//Initializes Lifts for use in Workout Generator
//Version 2.0 will reference Database

#include "LiftClass.h"

Lift exerciseRandomizer() //Define database of exercise & randomly select one
{    
    vector<Lift> LiftDatabase;

    Lift Clean("Clean", "Olympic", "Full", .33, .66, 1, 1.33, 1.66);
    Lift Bench("Bench Press", "Heavy", "Upper", .33, .66, 1, 1.5, 2);

    LiftDatabase.push_back(Clean);
    LiftDatabase.push_back(Bench);

    srand(static_cast<unsigned int>(time(0))); //Seed random number

    unsigned randomNumber = rand(); //Generate Random Number

    //Get random between 1 and total lift count
    unsigned randomSelector = (randomNumber % LiftDatabase.size()); 

    return LiftDatabase[randomSelector];
} 
```

最后，我有我的主要功能 WorkoutGeneratorMain.cpp

WorkoutGeneratorMain.cpp

```
//Workout Generator
//Generates workouts based on goal and fitness level

#include "LiftClass.h"

int main()
{
    exerciseRandomizer();

    Lift LiftA = exerciseRandomizer();

    cout << "\n\nYour first lift is: " << LiftA.LName << "\n\n Its lift type is: " << LiftA.LType << endl;
    cout << "\n\nGood Luck!" << endl;

    system("pause");
    return 0;
} 
```

非常感谢任何建议。

谢谢，

-亚历克斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T18:22:08.113

你会认为这`int main()`是可执行文件的入口点，但它不是（必然）。:) 根据项目设置，运行时可能会调用`wmain`或`main`。这就是您改用它的原因`_tmain`，它是一个扩展到运行时期望的宏。

尝试将其更改为：

```
int _tmain(int argc, _TCHAR* argv[]) 
```

PS - 这应该是自动生成的，也许你删除了它而不是替换`_tmain`.

# iphone - iPhone中的sqlite中的“数据库已锁定”

> ID：11974781
> 
> 赞同：2
> 
> 时间：2012-08-15T18:17:27.140
> 
> 标签：iphone, ios, sqlite

你好朋友我已经搜索了很多关于这个错误的信息。我找到了一些建议，例如您必须使用 sqlite_finalize() 语句，并且我使用了它。看看我的代码。

> -(void) updatePostingsForLike:(NSString *)postingKey isLiked:(NSString *)isLiked{
> 
> ```
>  [self initWithDB]; 
>   sqlite3_stmt *stmt;
> 
>   if(sqlite3_open([[self dbPath] UTF8String],&(db)) == SQLITE_OK) {
> 
>       NSString *str=[@"" stringByAppendingFormat:@"update posting set isLiked='%@' where postKey='%@'",isLiked,postingKey];
>       const char *sql=[str cStringUsingEncoding:NSUTF8StringEncoding];
>       int status;
>       status= sqlite3_prepare_v2(db,sql, -1, &stmt, NULL);
> 
>       if(SQLITE_DONE != sqlite3_step(stmt))
>       {
>           NSLog(@"%s",sqlite3_errmsg(db));
> 
>       }
> 
>       sqlite3_finalize(stmt);
> 
>       [self closeConnection];
> 
>   }} 
> ```

我遵守了所有的规则。我只能更新一次记录。仅限第一次。它第二次抛出错误。应该是什么解决方案？自过去 2 天以来，我一直陷入这样的问题！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T07:35:54.483

尝试这个，

```
-(void) updatePostingsForLike:(NSString *)postingKey isLiked:(NSString *)isLiked
{

   [self initWithDB]; 
   sqlite3_stmt *statement;

   if(sqlite3_open([[self dbPath] UTF8String],&db) == SQLITE_OK)
   {
      NSString* query=[NSString stringWithFormat: @"update posting set isLiked='%@' where   postKey='%@'",isLiked,postingKey];
      const char *query_stmt = [query UTF8String];

     if (sqlite3_prepare_v2(db, query_stmt, -1, &statement, NULL) == SQLITE_OK)
     {
        while (sqlite3_step(statement) == SQLITE_ROW)
        { 
            sqlite3_column_text(statement, 0);
        } 
        sqlite3_finalize(statement);
     }
    sqlite3_close(db);
  }
} 
```

# java - 将数组中的每个元素添加到列表中

> ID：11974787
> 
> 赞同：1
> 
> 时间：2012-08-15T18:17:44.763
> 
> 标签：java, arrays, list

将数组中的所有元素添加到列表中的最简单方法是什么？

例如

```
List<Byte> l = new ArrayList<Byte>();
//Want to add each element in below array to l
byte[] b = "something".getBytes("UTF-8"); 
```

是否有一些实用方法或这样做的东西。我尝试使用 addAll，但它想将实际数组添加到集合中。

谢谢你。

编辑：

澄清一下，我确实想使用 byte[] 来执行此操作，因为我最终会将列表转换回 byte[] 并将其提供给 MessageDigest.update()。这有助于澄清吗？

编辑2：

所以看起来`List<Byte>`很糟糕；很坏。如果我基本上是添加字节数组（我正在对一些 SALTS 和用户信息进行哈希处理）以馈入 MessageDigest，那么建议使用哪种数据结构？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T18:23:18.210

因为`byte[]`，你有麻烦了。`Arrays.asList`不会工作，因为你有 a`byte[]`而不是 a `Byte[]`。

这是那些“原始与阶级”问题之一。您可能会找到支持此功能的 3rd 方集合库（例如[Apache Commons Lang 项目](http://commons.apache.org/lang/)），但我不相信有任何开箱即用的东西。或者，您总是可以自己编写代码：

```
List<Byte> l = new ArrayList<Byte>();
for (byte b : "something".getBytes("UTF-8"))
{
    l.add(b);
} 
```

请注意，对于字节序列，这是一种非常低效的*存储*格式。尽管自动装箱将确保您不会创建任何额外的`Byte`对象，但每个元素仍然会有 4 或 8 个字节，因为它们将是引用。a 是非常罕见的`List<Byte>`——你*确定*你需要它吗？

如果您*实际上是*在处理课程，例如您有 a`String[]`并且想要 a`List<String>`那么您可以使用`Arrays.asList()`：

```
String[] array = ...;
List<String> list = Arrays.asList(array); 
```

这将返回一个包装数组的只读列表 - 如果你想要一个*可变*列表，你可以将该包装器传递给`ArrayList`构造函数：

```
String[] array = ...;
List<String> list = new ArrayList<String>(Arrays.asList(array)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T18:25:41.897

除非您想在循环中一次添加每个元素，否则可以使用 Apache commons 的[ArrayUtils](http://commons.apache.org/lang/api-2.5/org/apache/commons/lang/ArrayUtils.html)将原始数组转换为 Object 数组，然后使用`addAll()`：

```
byte[] b = "something".getBytes("UTF-8");
Byte[] bArray = ArrayUtils.toObject(b);

List<Byte> l = new ArrayList<Byte>();
l.addAll(bArray); 
```

# spring - @ModelAttribute spring mvc portlet 和 ajax 表单提交

> ID：11974797
> 
> 赞同：1
> 
> 时间：2012-08-15T18:18:09.003
> 
> 标签：spring, jquery, spring-mvc, websphere-portal, spring-portlet-mvc

对不起我糟糕的英语。我有很多事情在我的脑海里，从字面上让我感到困惑。我想将表单提交的值作为@ModelAttribute 处理，这首先让我感到困惑。不使用 @ModelAttribute 我很好，并且一切正常。

我的要求是在 portlet 和 spring mvc 3.0 注释中处理 ajax 表单提交

我有的表格

```
<portlet:resourceURL var="userURL" id="addUser" escapeXml="false" />

<form id="<portlet:namespace />User>
<table>
<tr><td>First Name: </td>
    <td><input type="text" name="fname"></td></tr>
<tr><td>Last Name: </td>
    <td><input type="text" name="lname"></td></tr>
<tr><td>Address 1: </td>
    <td><input type="text" name="address_1"></td></tr>
<tr><td>Address 2: </td>
    <td><input type="text" name="address_2"></td></tr>
<tr><td>Zipcode </td>
    <td><input type="text" name="zipcode"></td></tr>
<tr><td>&nbsp; </td>
    <td><button id="submit">Submit</td></tr>

</table>
</form> 
```

我使用以下 jQuery 将表单作为 ajax 调用提交

```
$('#submit').on('click',function() {
   var fname = $('#fname').val();
   var lname = $('#lname').val();
   var address_1 = $('#address_1').val();
   var address_2 = $('#address_2').val();
   var zipcode = $('#zipcode').val();

   $.ajax({
      type: "POST"
      url: "<c:out value="${userURL}" />"
      data: {fname: fname, lname: lname, address_1: address_1, address_2: address_2,         zipcode: zipcode }
      success: function(data) {
                   if(data == "success") {
                      $('#showError').hide();
                   } else {
                      $('#showError').show();
                   }
      } 
   })

}); 
```

我有以下控制器来处理 ajax 调用

```
@Controller
@RequestMapping("VIEW")
public class UserController {

       @ResourceMapping("addUser")
       public String addUser(ResourceRequest request, ResourceResponse response) {
            String fName = request.getParameter("fname");
            String lName = request.getParameter("lname");
            String address_1 = request.getParameter("address_1");
            String address_2 = request.getParameter("address_2");
            String zipcode = request.getParameter("zipcode");

            // I do the processing of the form and add the user attributes to the database.
       }

} 
```

我创建了一个 User 类，我想使用 @ModelAttribute 来设置/获取值。我已经通过许多链接试图弄清楚如何使用它。其中一个示例使用了 taglib 格式。我有 jQuery 将表单作为 ajax 调用提交，我不确定是否将表单更改为这种模式，它会破坏我的代码。

```
<%@taglib uri="http://www.springframework.org/tags/form" prefix="form"%>
<form:form method="post" action="addContact.html">

    <table>
    <tr>
        <td><form:label path="firstname">First Name</form:label></td>
        <td><form:input path="firstname" /></td> 
    </tr>
    <tr>
        <td><form:label path="lastname">Last Name</form:label></td>
        <td><form:input path="lastname" /></td>
    </tr>
    <tr>
        <td><form:label path="lastname">Email</form:label></td>
        <td><form:input path="email" /></td>
    </tr>
    <tr>
        <td><form:label path="lastname">Telephone</form:label></td>
        <td><form:input path="telephone" /></td>
    </tr>
    <tr>
        <td colspan="2">
            <input type="submit" value="Add Contact"/>
        </td>
    </tr>
</table>    

</form:form> 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-31T06:11:12.980

我假设您可能正在使用一个名为 User.class 的模型类使用用户用户`@SessionAttributes(types = User.class)` 注释您的资源映射方法注释您的控制器类`@ModelAttribute("<model_attribute_name>")`

在你的 JSP 中，

```
<form:form method="post" commandName="<model_attribute_name>" action="addContact.html">

    <table>
    <tr>
        <td><form:label >First Name</form:label></td>
        <td><form:input path="firstName" /></td> 
    </tr>
.... 
```

在您的资源映射方法中，您可以使用以下代码访问表单数据

```
 @ResourceMapping("addUser")
       public String addUser(ModeAttribute("<model_attribute_name>") User user ,ResourceRequest request, ResourceResponse response) {
            String fName = user.getFirstName();
           ...

            // I do the processing of the form and add the user attributes to the database.
       } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-29T16:26:46.753

为了使@modelAttribute 正常工作，我认为您需要在表单标签中添加一个modelAttribute 属性以将ModelAttribute 映射到用户：

```
<form:form modelAttribute="User" action="yourResourceUrl"> 
```

我在这个答案中使用了足够多的“属性”这个词吗？

您最终可能希望使用 Command 或 FormBackingObject 填充表单，这也是 User 的实例。在这种情况下，您可以使用 commandName 属性代替 modelAttribute，它将表单映射到 User 以进行填充，并将 User 映射到控制器上的 @ModelAttribute 注释。

# python - 在虚拟机中使用 GDB 调试 Python ctypes segfaults

> ID：11974798
> 
> 赞同：0
> 
> 时间：2012-08-15T18:18:10.213
> 
> 标签：python, gdb, virtual-machine, ctypes

我一直在从事一个在专用 Linux CentOS 系统上运行良好的项目。

一般的想法是有一个 Python 工作流管理器，而不是使用 ctypes 调用用 C 编写的共享库。它工作正常。

但是，出于开发目的，我需要有一个项目的本地实例。我在 Windows 7 下使用 VMWare 设置了 Linux Mint 虚拟机。在大多数情况下，一切正常。

问题是一个模块在调用其中一个共享库中的函数时因分段错误而崩溃。通常这没问题，在专用的 Linux 机器上，使用“gdb python corename”之类的东西可以让我准确地看到它崩溃的位置并解决问题。

但是，使用本地设置时我遇到了问题。我最注意到的是 GDB 没有报告正确的内存地址。这是一个巨大的项目，所以我不能发布所有代码，但我会给出一个纲要：

Python 模块创建一个“file_path”变量，一个字符串。它首先将其传递给某个共享库以加载文件。如果我执行命令，在 python

```
hex(id(file_path)) 
```

它会返回类似'46cb4ec'的东西。在第一个共享库中，即 C，我开始使用

```
printf("file_pathaddress = %x\n", &file_path[0]); 
```

它输出'file_path address = 46cb4ec'，这与我通过Python的'id()'函数得到的结果相同。我想这是预期的......？

无论如何..我将这个相同的变量发送到另一个共享库，但它在此调用时立即崩溃。如果我分析核心文件，它会显示它在函数调用本身上崩溃，而不是函数内的一行。但是，奇怪的是它输出如下内容：

```
Program terminated with signal 11, Segmentation fault.
#0  0x00007f124448c9fc in seam_processor (irm_filename=<error reading variable: Cannot access memory at address 0x7fff5fab51b8>, 
seam_data_path=<error reading variable: Cannot access memory at address 0x7fff5fab51b0>, 
    full_data_path=<error reading variable: Cannot access memory at address 0x7fff5fab51a8>, ranges=<error reading variable: Cannot access memory at address 0x7fff5fab51a0>, 
    job_id=<error reading variable: Cannot access memory at address 0x7fff5fab519c>, job_owner=<error reading variable: Cannot access memory at address 0x7fff5fab5198>, 
    y_tile_in=1, x_tile_in=1, fc_int=10650000000, atmos_props=..., surf_props=..., extra_props=<error reading variable: Cannot access memory at address 0x7fff5fab5190>, 
    gascalc_ftype=513, len_gas_sectrum=16, vect_spec_fq=<error reading variable: Cannot access memory at address 0x7fff5fab5188>, surfscat_theta_inc_vector_size=6, 
    surfscat_theta_inc_vector=<error reading variable: Cannot access memory at address 0x7fff5fab5180>, surfscat_phi_inc_vector_size=6, 
    surfscat_phi_inc_vector=<error reading variable: Cannot access memory at address 0x7fff5fab5178>, surfscat_theta_scat_vector_size=6, 
    surfscat_theta_scat_vector=<error reading variable: Cannot access memory at address 0x7fff5fab5170>, surfscat_phi_scat_vector_size=6, 
    surfscat_phi_scat_vector=<error reading variable: Cannot access memory at address 0x7fff5fab5168>) at src/seam_processor.c:47 
```

所以，我不明白为什么 GDB 会报告这些内存地址。在这种情况下，'irm_filename' 变量是 Python 作为 'file_path' 传入的，因此它的地址应该是其他库和 id() 函数报告的内容，0x46CB4EC。为什么不一样？然而，奇怪的是，有些变量很好，比如'y_tile_in'。如果我在 gdb 中这样做：

```
(gdb) print &y_tile_in
$1 = (int *) 0x7fff60543f80 
```

因此，尽管它可以读取此内存地址，但这与 Python 的 id() 将报告的内容不同，或者该地址的类似 C printf() 将在不会崩溃的库中报告的内容不同。此外，这些内存地址是非常大的数字，比我目前拥有的内存量还要大......它们的真正含义是什么？

那么，我的问题是，这里到底发生了什么？这是在虚拟机中运行的事实吗？有一些映射正在进行吗？如果在虚拟机中使用 gdb，我无法在网上找到任何关于我必须做的不同的事情，所以我很茫然......

有谁知道发生了什么？

谢谢。

*编辑*

所以，这个问题变得陌生了。基本上，我注释掉了库中所有可以做任何事情的代码，并让函数调用保持不变。当我这样做并在带有断点的 gdb 中运行它时，它在函数调用中打印的所有内存地址都是正常的，匹配 Python id() 函数并匹配地址上的 printf()。

我开始取消注释代码以查看问题可能是什么。问题在于声明：

```
double nrcs_h_d[MAX_NINC_S*MAX_SCAT_S];
double nrcs_v_d[MAX_NINC_S*MAX_SCAT_S]; 
```

如果我注释掉这两行，就不会崩溃。如果我只注释掉第二行，就不会崩溃。但是，如果没有注释掉任何行，它就会崩溃。

奇怪的是 MAX_NINC_S 和 MAX_SCAT_S 都等于 500。所以，这些数组的大小只有几兆字节……在代码的其他地方，几百兆字节的数组分配得很好。

另外，如果我将上面的行替换为：

```
double *nrcs_h_d, *nrcs_v_d;
nrcs_h_d = (double *)malloc(MAX_NINC_S*MAX_SCAT_S*sizeof(double));
nrcs_v_d = (double *)malloc(MAX_NINC_S*MAX_SCAT_S*sizeof(double)); 
```

它似乎工作正常......所以显然问题与试图在堆栈上分配太多有关。

所以，问题变成了：

为什么 gdb 没有显示这是发生分段错误的代码行，而是说它是函数调用？

如果进行了分配，为什么核心转储文件的内存地址似乎全部搞砸了？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T20:07:41.863

回想一下，堆栈空间向下增长，而堆空间向上增长；靠近虚拟内存空间顶部的地址（例如`0x7fff5fab51b0`）是堆栈分配的变量，而靠近底部的地址（例如`0x46cb4ec`）是堆分配的变量。请注意，虚拟内存空间通常比物理内存大得多；看起来您的操作系统和架构支持高达 128 GiB 的虚拟内存。

由于 Python 严重依赖动态内存分配，它最终会将其对象放在堆上，这就是为什么`id()`倾向于返回低端地址的原因。如果 C 代码将任何值复制到堆栈分配的变量并随后尝试使用这些本地副本调用函数，您将再次看到高端地址。

提供了一个行号：`src/seam_processor.c:47`。~~那里有什么有趣的吗？~~GDB 抱怨的各种内存地址*是堆栈上的*各种内存地址，它们都是连续的，而且几乎所有这些地址本身看起来都是指针（因为它们都是 8 字节宽）。

（这是我可以根据手头的信息给出的最佳答案；请随时提出修改建议或提供更多信息。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-25T09:51:16.640

一种可能的解释是，函数中局部变量的数据分配发生在执行特定函数中的任何代码之前。

编译器计算出所需的堆栈空间量并在到达函数中的语句之前分配它。所以你的函数的实际执行有点像这样：

1.  为所有局部函数变量分配存储量，
2.  开始执行函数中的语句

这样，当你从 fucntion1 调用另一个 say function2 时，function1 的局部变量不会被来自 function2 的局部变量的数据干扰。

因此，在您的情况下，本地数据变量所需的空间超过了堆栈可用的空间，并且在函数代码开始执行之前的某个时间点引发了异常。

# c++ - 在不使用轮廓提取的情况下提取最外层边界

> ID：11974804
> 
> 赞同：1
> 
> 时间：2012-08-15T18:18:24.863
> 
> 标签：c++, opencv

我正在做一个项目，我有一张手的二进制图像（如下图），我只想提取边界来训练机器学习算法。

由于我是实时实现的，并且边界内可能有很多错误轮廓，因此在 opencv 中使用轮廓提取技术会减慢程序的速度。

我尝试过使用形态闭合操作，然后进行简单的边缘检测，但是我仍然在外边界内发现了很多信息。

![在此处输入图像描述](../Images/2f497632bc5e7e14b5a85d92e7bc6fca.png) ![这是提取的剪影图像的示例](../Images/cf3294142b4c358736d12739a38cf96c.png) ![在此处输入图像描述](../Images/207dcac14de3c7df2b98c560b767f51b.png) ![在此处输入图像描述](../Images/4648b4d0165262e6d840e57d055fd912.png)

我正在使用 kinect 传感器来跟踪手部，因此无法使用预处理技术纠正这些误差值。

我写的试图解决这个问题的函数是：

```
Mat CvHandRegion::sampleBoundaryPoints(Mat input)
{
        Mat sampledOut;
sampledOut.create(input.rows, input.cols, CV_8U);
sampledOut.setTo(0);

for( int x = 0; x < input.cols; x += C_SAMPLING_STEP)
{
    for( int y = 0; y < input.rows; y += C_SAMPLING_STEP)
    {
        if(input.at<uchar>(y,x) == 255)
        {
            sampledOut.at<uchar>(y,x) = 255;
            break;
        }
    }
}

for( int x = 0; x < input.cols; x += C_SAMPLING_STEP)
{
    for( int y = input.rows-1; y > 0; y -= C_SAMPLING_STEP)
    {
        if(input.at<uchar>(y,x) == 255)
        {
            sampledOut.at<uchar>(y,x) = 255;
            break;
        }
    }
}

for( int y = 0; y < input.rows; y += C_SAMPLING_STEP)
{
    for( int x = 0; x < input.cols; x += C_SAMPLING_STEP)
    {
        if(input.at<uchar>(y,x) == 255)
        {
            sampledOut.at<uchar>(y,x) = 255;
            break;
        }
    }
}

for( int y = 0; y < input.rows; y += C_SAMPLING_STEP)
{
    for( int x = input.cols-1; x > 0; x -= C_SAMPLING_STEP)
    {
        if(input.at<uchar>(y,x) == 255)
        {
            sampledOut.at<uchar>(y,x) = 255;
            break;
        }
    }
}
return sampledOut;
    } 
```

这里 C_SAMPLING_STEP 保持为 4。这个想法基本上是从所有方面到达并在检测到从 0 到 255 的变化时终止循环。

有没有其他方法可以更有效和更健壮？

更新：我尝试使用不同的半径进行形态关闭操作，MORPH_ELLIPSE 的 Size(5,5) 输出是：

![在此处输入图像描述](../Images/d4e1fbf67c2e657107296a7ff67ef772.png) ![在此处输入图像描述](../Images/058d62457be4227b35ff9d73317ff363.png)

和尺寸（7,7）

![在此处输入图像描述](../Images/8b6f6d0555613af9e77deed4bb62a751.png) ![在此处输入图像描述](../Images/41df5d435455227b1a68239a178b970e.png)

和大小（9,9）

![在此处输入图像描述](../Images/13051be486ecb0ee6089bc602def30e6.png)

这在一定程度上解决了这个问题，但是我不确定要使用哪个大小，因为数据中的噪声变化很大（取决于手的姿势）。

# c++ - 从 C++ 访问表中的 Lua 表

> ID：11974806
> 
> 赞同：0
> 
> 时间：2012-08-15T18:18:28.090
> 
> 标签：c++, lua

我有一个返回字典表的 Lua 函数，并且放入返回表的值之一是另一个表，如下面的 Lua 函数所示。

```
function tableWithinTable()
    local ret = {}
    ret["a"] = 1
    ret["b"] = {1,2,3}
    ret["c"] = 3
    return ret
end 
```

我将如何访问该内表？

我知道我可以上桌，因为我可以输入下面的 if 语句。我目前阅读表格的尝试也包括在内。

```
lua_pushstring("b");
lua_gettable(lua,1);
if(lua_istable(lua,-1))
{
    //whatever is in here is executed.
    lua_pushnumber(lua,1);
    lua_gettable(lua,-1); //crashes to desktop here
    std::cout << lua_tonumber(lua,-1) << std::endl;
    lua_pop(lua,1);
} 
```

我很确定有一个简单的解决方案，但我完全被难住了。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T03:17:46.643

推入索引后，该表在堆栈中又多了一个插槽。所以这样的事情应该有效：

```
if(lua_istable(lua,-1)) {
  lua_pushnumber(lua,1);
  lua_gettable(lua,-2);
  ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T15:19:52.953

通常使用函数`lua_getfield`（用于字符串索引）或`lua_rawgeti`（用于数字索引）比使用原始`lua_gettable`函数更容易。

特别是，这避免了堆栈上导致索引错误的额外值。

该示例可以重写为：

```
lua_getfield(lua, 1, "b");
if(lua_istable(lua, -1))
{
    lua_rawgeti(lua, -1, 1);
    std::cout << lua_tonumber(lua,-1) << std::endl;
    lua_pop(lua, 1);
} 
```

# google-chrome-extension - 在页面加载时动态播放 HTML5 音频

> ID：11974815
> 
> 赞同：1
> 
> 时间：2012-08-15T18:19:02.810
> 
> 标签：google-chrome-extension, playback, html5-audio, pageload

我知道如果嵌入在正文中，我可以在正文中使用以下内容在页面加载时自动播放声音，但我想动态尝试。

我所说的动态是指找到音频文件，并使用 JavaScript 或 JQuery 播放 onload。

任何人都可以帮忙吗？

```
<audio preload="auto" tabindex="0" autoplay="true" loop="true">
    <source src="shorttones.mp3" type="audio/mpeg" />
    <source src="shorttones.ogg" type="audio/ogg" />
    Your browser does not support the audio element.
</audio> 
```

我试过这个，不工作。

```
<html>
<head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script src="js/buzz.js" type="text/javascript"></script>
<script type="text/javascript">
if (!buzz.isSupported()) {
    alert("Your browser does not support the audio element, ogg, or mp3.");
    return;
}

buzz.defaults.formats = [ 'ogg', 'mp3' ];
buzz.defaults.preload = 'metadata';

var mySound = new buzz.sound( "sounds/highpitchsound");

mySound.play();
mySound.loop();
</script>
</head>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T18:27:19.957

如果您的意思是在没有自动播放的情况下播放，这将是一种方法：

```
<html><body onload="playSound();">
<audio id="noise"></audio>
</body>
<script>
function playSound(){
    var snd=document.getElementById('noise');
    canPlayMP3 = (typeof snd.canPlayType === "function" && snd.canPlayType("audio/mpeg") !== "");
    snd.src=canPlayMP3?'shorttones.mp3':'shorttones.ogg';
    snd.load();
    snd.play();
}
</script></html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T18:27:11.873

你可能想看看buzz.js：[http ://buzz.jaysalvat.com/](http://buzz.jaysalvat.com/)

```
if (!buzz.isSupported()) {
    alert("Your browser does not support the audio element, ogg, or mp3.");
    return;
}

var sound = new buzz.sound( "shorttones", {
    formats: [ "ogg", "mp3" ]
});

sound.play(); 
```

# java - 通过ip限制tomcat访问

> ID：11974820
> 
> 赞同：3
> 
> 时间：2012-08-15T18:19:28.023
> 
> 标签：java, jakarta-ee, tomcat

我想通过 IP 地址限制对在 tomcat 服务器上运行的 web 应用程序的访问。发现我必须使用`org.apache.catalina.valves.RemoteAddrValve`并将其设置在 tomcat 中`context.xml`

但在我的 tomcat 文件夹中，我有 4 个：

```
\conf
\backup
\webapps\host-manager\META-INF
webapps\manager\META-INF 
```

我必须在哪里放置我的规则？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T19:42:01.217

这是[RemoteAddressFilter](http://tomcat.apache.org/tomcat-6.0-doc/config/valve.html#Remote_Address_Filter)
的配置 您可以添加`Valve`到`%CATALINA_HOME%\conf\server.xml`
但是如果您需要按 IP 过滤，我建议您改用防火墙。这就是它首先应该做的事情

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T19:06:49.250

它应该在 YOUR_WEBAPP/META-INF/context.xml 中

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T19:13:49.357

如果您想将此限制应用于在您的 tomcat 上运行的所有 Web 应用程序，您必须选择`context.xml`哪个。`TOMCAT_HOME/conf/`

选择`yourapp/META-INF/context.xml`是否仅用于应用。如果 Web 应用程序被打包为 WAR，那么`/META-INF/context.xml`将被复制并重`$TOMCAT_HOME/conf/[enginename]/[hostname]/`命名以匹配应用程序的上下文路径。

`webapps\manager\META-INF`=> 如果您在此处添加限制，您`tomcat manager`将受到限制，即`tomcat administration`。

# iphone - 将价值从一个视图转移到另一个视图

> ID：11974829
> 
> 赞同：1
> 
> 时间：2012-08-15T18:19:52.813
> 
> 标签：iphone, objective-c, ios, ipad

> **可能重复：**
> [在视图之间传递变量的最佳方式](https://stackoverflow.com/questions/6716855/best-way-to-pass-variables-between-views)

有没有办法从 IBOutlet TextField 获取信息并在另一个视图中使用其中的信息？这是我目前正在使用的，但由于设置变量在不同的页面上，我试图弄清楚如何让应用程序保留和传输信息。

H。

```
@interface ViewController : UIViewController {
    IBOutlet UITextField *one;
    IBOutlet UITextField *two;
    IBOutlet UILabel *three;
    IBOutlet UILabel *four;
    IBOutlet UITextField *settings;
    IBOutlet UITextField *label1;
    IBOutlet UITextField *label2;

}

-(IBAction)Button;

@end 
```

米。

```
@implementation ViewController

int VarOne = 0;
int VarTwo = 0;
int VarThree =0;
int VarFour =0;
int VarSettings =0;
int VarLabel1 =0;
int VarLabel2 =0;

-(IBAction)Button{
    VarOne = ([one.text intValue]);
    VarTwo = ([two.text intValue]);

    VarLabel1 = (VarTwo - (VarTwo * (VarSettings / 100)) - VarOne);
    VarLabel2 = (VarThree / ((100 - VarSettings) / 100 - VarFour));
    three.text = [[NSNumber numberWithInt:VarLabel1] stringValue];
    four.text = [[NSNumber numberWithInt:VarLabel2] stringValue];
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T09:03:37.533

您可以通过 3 种方式使用将数据传输到其他视图：

1）使用键值观察

2) 使用 NSNotificationCenter 发布通知

3）如果您的视图是自定义视图，您可以编写如下方法：

```
myCustomView = [[CustomView alloc] initWithFrame....];

[myCustomView rememberThisValue:myTextField.text];

[self.view addSubview:myCustomView]; 
```

# vb.net - 我无法使用 vb.net 将整数插入到 sqlite 表中

> ID：11974830
> 
> 赞同：0
> 
> 时间：2012-08-15T18:19:55.993
> 
> 标签：vb.net, sqlite

在 vb.net 中，下面的代码有效

```
cmd.CommandText = "CREATE TABLE Notes ( num INTEGER, name TEXT)"
Try
      cmd.ExecuteNonQuery()
Catch ex As Exception
      MsgBox("Error during save operation: " & ex.Message)
End Try

cmd.CommandText = "insert into Notes(num , name ) VALUES( 3, 'Bob') "
Try
    Console.WriteLine(cmd.ExecuteNonQuery())
Catch ex As Exception
    MsgBox("Error during save operation: " & ex.Message)
End Try 
```

但我想放置一个整数变量而不是插入数字 3。我试过这个：

```
Dim count As Integer = 1
cmd.CommandText = "insert into Notes(num , name ) VALUES(" + count " + , 'Bob') "

Try
     Console.WriteLine(cmd.ExecuteNonQuery())
Catch ex As Exception
      MsgBox("Error during save operation: " & ex.Message)
End Try 
```

但后来我有一个例外：

```
Conversion from string "insert into Notes(isFirst" to type 'Double' is not valid. 
```

我知道这条线：

```
"insert into Notes(num , name ) VALUES(" + count + ", 'Bob') " 
```

似乎完全错误，但我找不到任何其他解决方案，因为我都尝试了。

如何将计数变量插入表中？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:44:12.627

您应该参数化查询。我不确定 SQLite 的确切语法，因为我使用的是 Oracle，但这肯定会让你走上正轨。

```
Dim count As Integer
'Whatever code you need to get the count from the user.

cmd.CommandText = "insert into Notes(num , name ) VALUES( @count, 'Bob')"

Dim myParam As New SQLiteParameter("@count")
cmd.Parameters.Add(myParam)

'Continue with executing the query, storing the result, etc. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T18:48:22.690

您在双引号的错误一侧有“+”号：

```
cmd.CommandText = "insert into Notes(num , name ) VALUES(" + count " + , 'Bob') " 
```

应该

```
cmd.CommandText = "insert into Notes(num , name ) VALUES(" & count & ", 'Bob') " 
```

正如 ChrisStauffer 提到的，使用参数。总是。

# xcode - 键盘事件不适用于 Xcode 上的 irrlicht

> ID：11974831
> 
> 赞同：1
> 
> 时间：2012-08-15T18:19:56.953
> 
> 标签：xcode, cocoa, events, command-line, irrlicht

当我在**Xcode中运行****Irrlicht**应用程序时，我无法使用**键盘****输入**：

 ******如果我在应用程序运行时按下一个键，我最终会在应用程序之前打开的任何窗口上写下该字母，例如：我正在编辑我的代码，而不是按 Build/run，应用程序打开（我按鼠标在窗口上只是为了确保它被聚焦）然后我按下一个键并且那个字母被写在编辑器窗口中......

我确定问题不在于代码，因为如果我按下应用程序窗口的顶部栏，按下键，然后释放鼠标按钮（快速动作），事件就会被触发。

现在，从我在[这个链接](http://irrlicht.sourceforge.net/forum/viewtopic.php?t=36796)（第四篇文章）中读到的内容来看，命令行应用程序与 Xcode 和 irrlicht 之间似乎存在不兼容。这家伙更改为 Cocoa 应用程序并让它工作。我不知道该怎么做，因为 Irrlicht 使用了很多命名空间，而且使用 cocoa 我遇到了很多问题。

任何的想法？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T09:42:26.857

经过随机搜索，我找到了本指南：

[http://irrlicht.sourceforge.net/forum/viewtopic.php?f=5&t=13890&start=60](http://irrlicht.sourceforge.net/forum/viewtopic.php?f=5&t=13890&start=60)

我的 Xcode 3.2.6 有一些不同之处（例如，我没有 *AppDelegate.m、*AppDelegate.h 或 *.xib 文件），但很容易读完本教程。

最后我得到了大约 1000 个错误，与预编译 appkit.h 错误有关，快速搜索这里是所有这些错误的解决方案：

[http://www.cocoabuilder.com/archive/cocoa/194905-xcode-cocoa-project-with.html#195211](http://www.cocoabuilder.com/archive/cocoa/194905-xcode-cocoa-project-with.html#195211)

十分简单 ：）******

# c# - C# RSA 使用私钥解密

> ID：11974837
> 
> 赞同：4
> 
> 时间：2012-08-15T18:20:22.927
> 
> 标签：c#, rsa, private, encryption

我一直在搜索，但似乎找不到使用 RSA 进行解密的简单方法。

我已经生成了一个公钥和私钥，它们存储在两个单独的文件中，并且是 XML 格式。我可以使用 FromXmlString 将公钥与 RSACryptoServiceProvider 对象相关联，然后加密字符串。尝试解密加密字符串时，我感到困惑。我不确定如何将私钥数据与 RSACryptoServiceProvider 相关联，以便可以使用 Decrypt 函数。

任何帮助，将不胜感激。

编辑：

公钥和私钥的格式是 RSACryptoServiceProvider 对象生成的 XML，我只是把它放到一个文件中：

```
<RSAKeyValue><Modulus>vS7Y5up+6kHMx7hQjKA6sKlIVASaw  ... etc ... 
```

我使用以下代码加载公钥：

```
StreamReader sr = new StreamReader(HttpContext.Current.Server.MapPath("public.key"));
RSACryptoServiceProvider rsa = new RSACryptoServiceProvider();
rsa.FromXmlString(sr.ReadToEnd().ToString()); 
```

我目前还没有尝试使用私钥，因为我不确定从哪里开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T21:28:56.210

我不知道您的情况，但我建议您将关键信息存储在 KeyContainer 中。如果您这样做，您可以按名称访问 keyContainer 并可以执行类似的操作。

```
// retrieves the maximum number of characters that can be decrypted at once
private int getMaxBlockSize(int keySize){
    int max = ((int)(keysize/8/3) )* 4
    if (keySize / 8 mod 3 != 0){
        max += 4
    }
    return max;
}

public string decrypt(string msg, string containerName){
    CspParameters params = new CspParameters();
    params.KeyContainerName = containerName;
    RSACryptoServiceProvider rsa = new RSACryptoServiceProvider(params);
    StringBuilder decryptedMsg = new StringBuilder();
    int maxDecryptSize = getMaxBlockSize(rsa.KeySize);
    int iterationCount = Math.Floor(msg.length / maxDecryptSize)
    for(int i=0; i<iterationCount; i++){
        int start = i * maxDecryptSize;
        int blkSize = Math.min(start + maxDecryptSize, msg.Length);
        Byte[] msgBytes = System.Convert.FromBase64String(msg.Substring(start, blkSize));

        decryptedMsg.Append(System.Text.Encoding.Unicode.GetString(RSAProvider.Decrypt(msgBytes, false));
    }
    return decryptedMsg.ToString();
} 
```

我还没有对此进行测试，所以这里可能存在错误，但你明白了。

# objective-c - Xcode 4.4 中的链接器错误

> ID：11974847
> 
> 赞同：7
> 
> 时间：2012-08-15T18:20:56.023
> 
> 标签：objective-c, ios, xcode4.4

从 Xcode 4.3 升级到 Xcode 4.4 后，我开始在构建我的 iPhone 应用程序时遇到以下错误：

`ld: section __objc_const (address=0x0010C720, size=7265990088) would make the output executable exceed available address range for architecture i386 clang: error: linker command failed with exit code 1 (use -v to see invocation)`

内存地址和编号对我来说没有任何意义，但它们在清理和重建过程中保持一致。我不清楚如何找到他们可能引用的内容。

该代码在 XCode 4.3 中已经并且仍然在编译。

有谁知道我如何追踪导致此错误的原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-17T05:38:32.073

我有同样的错误。幸运的是，我能回忆起它出现、回滚并比较修订的那一刻。它是 Google Analytics`GAI`类中具有静态方法的类别。我不知道为什么会这样，因为项目中的其他类别工作得很好，但希望它也能帮助别人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T17:25:28.780

**您可以在Link Map File**中查看所有符号（包括全局变量）的大小：

*   在您的目标的构建设置中，转到“链接”部分并将“写入链接映射文件”设置为“是”。
*   构建程序。链接器将失败，但会写入链接映射文件。
*   找到链接映射文件。链接器的日志输出显示了参数`-map -Xlinker -/path/to/linkmapfile.txt`。它位于项目的 DerivedData 文件夹中。
*   链接映射文件显示所有符号的地址（第一列）和大小（第二列）。对于全局变量，它显示名称和它们所在的目标文件。
*   您应该在链接映射文件中找到错误消息的地址（在您的示例中为 0x0010C720）。
*   您可以检查链接映射文件中是否有其他大尺寸符号。

所以也许这有助于缩小问题的范围。

# python - Python 导入是否实例化了一个神秘类？

> ID：11974848
> 
> 赞同：2
> 
> 时间：2012-08-15T18:21:02.033
> 
> 标签：python

想了很久，想不出更好的标题，抱歉。

我对 Python 很陌生，而且（就像许多其他人一样）我只是无法理解`import`。

我想我理解“模块”和“包”、类和属性等等。这是我需要澄清的一种具体行为。

假设我有一个文件 foo.py。它有一行：

```
x = 1 
```

如果在另一个文件中，我“导入 foo”，我可以引用 x。而且，奇妙的是，在另一个文件中，我可以导入 foo，现在这两个文件可以共享 x。为简单起见，将类排除在讨论之外，我相信这是在文件之间共享属性的pythonic方式。

问题来了：公平地说，当i 时`import foo`， foo.py 本身（因为没有更好的比喻）是由解释器秘密*实例化*的？

我意识到如果我在模块中定义一个类，它会遵循传统规则，并且只有在我明确这样做时才会被实例化。但是，python 解释器（通过`import`语句）在全局命名空间中实例化我的模块实例是解释属性共享行为的唯一方法。

这是真的？半真？还是我和迷失之地的 Sleestaks 一起游荡？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T18:28:26.027

导入模块时：

1.  如果该模块以前没有被导入，则该文件被解析为一个`module`对象，该对象被添加到`sys.modules`一个键中，该键是从 pythonpath 到您的模块的导入路径
2.  该模块对象（或其某些成员）在导入命名空间中具有别名，被引用的别名和对象由`import`您使用 的特定形式确定

因此，当您使用该名称时`import foo`，解释器会检查`sys.modules`注册的内容`foo`。如果找到它，它会`foo`在模块的本地命名空间中提供一个标签`foo`。如果没有，它会向下搜索pythonpath，直到找到一个`foo`模块，将其解析为一个`module`对象，将该对象添加到`sys.modules`，并在该模块对象的本地命名空间中添加一个标签。

`import foo as foof`做同样的事情，只有创建的本地命名空间标签是`foof`. `from foo import x`遵循相同的过程，直到在本地命名空间中创建标签和引用，而不是在命名空间中为模块 `x`中的属性提供标签。只是结合了2个想法。`x``foo``from foo import x as foox`

`__module__`使用类，您实际上可以通过使用属性在树上上下爬行来探索整个系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T18:40:30.293

导入创建一个“模块”对象的实例。值得知道的是，这仅在第一次导入模块时创建。在以下导入时，您将获得对原始文件的引用。您可以通过一些自省来动态创建自己的模块对象。

```
import glob  # Import any python module
moduleType = type(glob)

onTheFly = moduleType("OnTheFly", "Docstring for this module") 
```

尽管创建这些并没有太多好处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T18:28:07.660

是的，确实如此。如果您执行`import foo`一个模块对象`foo`，并且您的文件的内容（例如类栏）被添加为该对象的成员。

# ios - FDT - 如何让我的 IOS 项目以标准模式打包和编译

> ID：11974849
> 
> 赞同：0
> 
> 时间：2012-08-15T18:21:01.617
> 
> 标签：ios, actionscript-3, fdt

我刚刚开始在那里使用 FDT 和 Actionscript 测试我的第一个 ISO 应用程序。我认为我已经正确配置了所有内容。在 IOS 调试的调试配置中，我选择了标准打包，调试时出现以下错误。

```
Packaging command: /Users/mwallace/Development/sdks/flex/flex_sdk_4.6.0.23201B/bin/adt
    -package
    -target
    ipa-debug
    -connect
    192.168.5.208
    -storetype
    pkcs12
    -keystore
    ../../../../../dev_certs/MWallaceCert.p12
    -storepass
    *************
    -provisioning-profile
    ../../../../../dev_certs/Snapverse.mobileprovision
    /Users/mwallace/Development/dev/wiretree/snapverse/apps/ScrollingListTest/deploy/ScrollingListTest.ipa
    bin/ScrollingListTest-app.xml
    -C
    bin
    ScrollingListTest.swf
Packaging failed!
Packaging error message: 
Compilation failed while executing : as 
```

但是，如果我选择“快速”进行调试，一切似乎都可以正常工作，我可以将应用程序部署到我的手机并运行它。只是运行时超级慢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T19:05:24.787

发现将我的 AIR SDK 升级到 3.3 解决了这个问题。

# android - 你能指出这段代码中 ListView 的问题吗？

> ID：11974852
> 
> 赞同：1
> 
> 时间：2012-08-15T18:21:10.703
> 
> 标签：android, listview

以下是一些测试代码，用于重现一个奇怪的错误：从 ListView 中删除一些项目后，当数据无效时它会停止刷新。更多项目被删除，但列表不刷新。甚至 Log cat 也不会显示用于删除的调试消息。如果有人能找出问题所在，我将不胜感激。

物品布局：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:layout_width="fill_parent"
              android:layout_height="fill_parent"
        android:orientation="horizontal">

    <TextView android:id="@+id/nameTextView"
              android:layout_width="wrap_content"
              android:layout_height="wrap_content"
              />
    <Button android:id="@+id/deleteButton"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Delete"
            />
</LinearLayout> 
```

物品类别：

```
import android.content.Context;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;

public class Item implements View.OnClickListener {
    private String name;
    private View itemView;
    private MyActivity owner;

    //--- getters--
    public String getName() {
        return name;
    }
    public View getView() {
        return itemView;
    }

    public Item(String n, Context c , MyActivity o)
    {
        //---store the name given--
        name = n;
        //---store reference to the owner activity--
        owner = o;

        //--- create a View for this item----
        LayoutInflater inflater = (LayoutInflater) c.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        itemView = inflater.inflate(R.layout.item,null);

        //---set up data to show--
        TextView nameTextView = (TextView) itemView.findViewById(R.id.nameTextView);
        Button deleteButton = (Button) itemView.findViewById(R.id.deleteButton);
        nameTextView.setText(name);

        //---set up events to be handled--
        deleteButton.setOnClickListener(this);

        Log.d("My_Test","Item: Hello world, my name is " + name);
    }

    //----request owner to delete this item---
    @Override
    public void onClick(View view) {
        Log.d("My_Test","Item:"+name+" requesting owner to delete me");
        owner.deleteItem(this);
    } 
```

活动布局：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:orientation="vertical"
              android:layout_width="fill_parent"
              android:layout_height="fill_parent"
        >
<ListView android:id="@+id/myListView"
          android:layout_width="fill_parent"
          android:layout_height="fill_parent"
          />
</LinearLayout> 
```

活动类：

```
import android.app.Activity;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.ListView;

import java.util.ArrayList;

public class MyActivity extends Activity {
    private ArrayList<Item> myItems;
    private ListView myListView;
    private ArrayAdapter<Item> myArrayAdapter;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        //-----adapter for item list----
        //----since each item has its own view , it just returns the same---
        myArrayAdapter = new ArrayAdapter<Item>(this,0){

            @Override
            public View getView(final int position, View convertView, ViewGroup parent)      {
              Item item = getItem(position);
              Log.d("My_Test","Adapter : View for Item: " + item.getName() +"is requested." );
              return item.getView();
            }

        };

        //-----set up my list view with the adapter------
        myListView = (ListView) findViewById(R.id.myListView);
        myListView.setAdapter(myArrayAdapter);

        //------add items-------
        //----each item has its own view and a reference to this activity as their owner----
        myArrayAdapter.add(new Item("Sunday", this, this));
        myArrayAdapter.add(new Item("Monday", this, this));
        myArrayAdapter.add(new Item("Tuesday", this, this));
        myArrayAdapter.add(new Item("Wednesday", this, this));
        myArrayAdapter.add(new Item("Thursday", this, this));
        myArrayAdapter.add(new Item("Friday", this, this));
        myArrayAdapter.add(new Item("Saturday", this, this));

        myArrayAdapter.notifyDataSetChanged();

    }

    //----- called by items requesting to be deleted from the item list----
    public void deleteItem(Item item) {
        myArrayAdapter.remove(item);
        Log.d("My_Test","Owner : Deleted item :" + item.getName());
        myArrayAdapter.notifyDataSetChanged();
    }
} 
```

看起来 ListView 停止重新绘制它自己。即使列表项不再在项数组中并被`myAdapter.notifyDataSetInvalidated();`调用，列表项仍然可见，进一步的代码执行有些受阻。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:55:14.880

使用 ArrayAdapter 来执行此操作。试试这样的东西......

```
 import android.app.Activity;
import android.content.Context;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.ListView;
import android.widget.TextView;

public class MyActivity extends Activity{
    private ListView myListView;
    private ArrayAdapter<Item> myArrayAdapter;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        myArrayAdapter = new ArrayAdapter<Item>(this,R.layout.item){    
            @Override
            public View getView(int position, View convertView, ViewGroup parent) {
                View returnedView = convertView;

                //inflate your view here
                if(returnedView == null){
                    LayoutInflater inflater = (LayoutInflater)getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                    returnedView = inflater.inflate(R.layout.item,null);
                }

                final Item item = getItem(position);

                //set the views
                if(returnedView != null){
                    TextView nameTextView = (TextView) returnedView.findViewById(R.id.nameTextView);
                    nameTextView.setText(item.getName());
                    Button deleteButton = (Button) returnedView.findViewById(R.id.deleteButton);
                    deleteButton.setOnClickListener(new OnClickListener() {
                        public void onClick(View v) {
                            remove(item);
                            notifyDataSetChanged();
                        }
                    });

                }

                return returnedView;
            }
        };

        myArrayAdapter.add(new Item("Sunday"));
        myArrayAdapter.add(new Item("Monday"));
        myArrayAdapter.add(new Item("Tuesday"));
        myArrayAdapter.add(new Item("Wednesday"));
        myArrayAdapter.add(new Item("Thursday"));
        myArrayAdapter.add(new Item("Friday"));
        myArrayAdapter.add(new Item("Saturday"));

        myListView = (ListView) findViewById(R.id.myListView);
        myListView.setAdapter(myArrayAdapter);

    }
}

public class Item{

    private String name;

    public Item(String n){
        this.name = n;
    }

    public String getName() {
        return name;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:43:26.317

查看 ListViews 和 ListAdapters 的工作原理，我了解到有很多对象回收，特别是适配器产生的 List View Item Objects。以下是原始问题的解决方案以及经验教训：

*   当 a`ListView`必须绘制/显示一个列表项时，它会请求 a `View`from `ListAdapter`，并且有时（不总是）还提供一个旧`View`对象以供重用。对象的这种重用是为了提高性能，有一个内置的Re *-Cycler*`ListView`可以做到这一点，为什么要为每个新列表项膨胀新的布局，当已经有一些属性可以修改以使它们看起来像新的视图项目。到目前为止，适配器可以更改旧视图上的一些文本并将它们返回，或者如果没有可用的回收视图可用，则创建新视图，甚至丢弃可回收视图并始终创建新视图。

*   但是，如果您的列表项的状态不仅仅是 a 中的一些文本`TextView`，也就是说，另一个对象被注册`onClickListener`为您的列表项，或者您的列表项在某处引用了某个对象，反之亦然；适配器只改变可重用视图的外观或简单地丢弃它们是不行的。**适配器必须更新可重用项目的整个状态。**这包括取消注册旧的事件侦听器、重新注册新的事件侦听器以及更新对可能存在的外部对象的所有引用。

将适配器的方法更改`getView()`为：

```
@Override
public View getView(int position, View convertView, ViewGroup parent)      {

    Item item = getItem(position);
    Log.d("My_Test","Adapter : View for Item: " + item.getName() +"is requested." );

    if(convertView != null)
    {
        (convertView.findViewById(R.id.deleteButton))
                .setOnClickListener(item);
        ((TextView)convertView.findViewById(R.id.nameTextView))
                .setText(item.getName());
        return convertView;
    }
    else
    {
        return item.getView();
    }
} 
```

注意：虽然在这种情况下始终创建新项目不会导致任何错误，但`ListView`无法检测到更改并重绘。利用回收物品似乎可以解决这个问题。

# c# - 关闭 Windows 时不显示警告框？

> ID：11974853
> 
> 赞同：0
> 
> 时间：2012-08-15T18:21:15.657
> 
> 标签：c#, windows, c#-4.0, windows-7, process

当我打电话时：

```
Process.Start("shutdown", "/s /t 60"); 
```

将出现一个警告消息框，其中包含“您的计算机将在 1 分钟内关闭”之类的消息。如何防止它出现？还有其他方法可以关闭窗口吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T18:33:16.443

你可以写：

```
Process.Start("shutdown", "/p"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T18:26:47.947

尝试：

```
 Process.Start("shutdown", "-f -t 0"); 
```

# javascript - jquery移动加载图像未显示

> ID：11974854
> 
> 赞同：0
> 
> 时间：2012-08-15T18:21:16.400
> 
> 标签：javascript, jquery, jquery-mobile

我的代码：

```
<!DOCTYPE html> 
<html> 
<head>
<title>a</title> 
<meta name="viewport" content="width=device-width, initial-scale=1"> 
<link rel="stylesheet" href="jquery.mobile-1.2.0-alpha.1.min.css" />
<script src="jquery-1.8.0.min.js"></script>
<script src="jquery.mobile-1.2.0-alpha.1.min.js"></script>
</head>
</html>

<script>
$(document).ready(function(){
$.mobile.loading('show');});
</script> 
```

但是漂亮的微调器图像没有显示出来。它只是在屏幕中间显示一个灰色圆圈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:27:16.937

我认为您的语法已关闭，要显示加载消息，您应该使用[$.mobile.showPageLoadingMsg](http://jquerymobile.com/demos/1.1.1/docs/api/methods.html)还要确保包含图像文件夹。

编辑：

抱歉，我看到您使用的是 JQM 1.2 的 alpha，看起来该`$.mobile.loading`方法已添加到此版本中。无论如何，请确保您拥有 JQM 图像文件夹，并且它与 js 文件位于同一文件夹中。要测试尝试用指向 CDN 的链接替换您的链接

```
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0-alpha.1/jquery.mobile-1.2.0-alpha.1.min.css" />
<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<script src="http://code.jquery.com/mobile/1.2.0-alpha.1/jquery.mobile-1.2.0-alpha.1.min.js"></script> 
```

# asp.net - 每个请求都执行 SetAuthCookie 的缺点

> ID：11974859
> 
> 赞同：2
> 
> 时间：2012-08-15T18:21:34.423
> 
> 标签：asp.net, forms-authentication

在过去的几个月里，尽管我们将身份验证超时设置为 30，但我们有用户抱怨他们的身份验证有时会提前到期 - 仅在 20 分钟不活动之后。我今天发现 SlidingExpiration 仅在小于时重置剩下一半的身份验证时间，留下做某事的可能性，等待十分钟，做其他事情，等待 21 分钟，并获得“提前”超时。

在我的母版页的 Page_Load 中做这样的事情有什么潜在的缺点吗？

```
if(CurrentUser != null) {
    FormsAuthentication.SetAuthCookie(CurrentUser.UserName, false);
} 
```

...并因此重置每个请求的滑动到期？

**编辑：**

这段代码是我最终使用的；它每分钟只重置一次令牌。

```
var cookie = Request.Cookies[FormsAuthentication.FormsCookieName];
var ticket = FormsAuthentication.Decrypt(cookie.Value);

if (ticket.IssueDate.AddMinutes(1) < DateTime.Now && ticket.IssueDate.AddMinutes(30) > DateTime.Now) {
    FormsAuthentication.SetAuthCookie(currentUser.UserName, false);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T18:03:29.073

最大的缺点是它将禁用缓存，例如 <%@ OutputCache %> 指令将不再正常工作。因此，由于缓存未命中，您可能会开始看到性能下降。

如果可以的话，最简单的做法是增加过期超时。

# c# - C# 数组是一个字段，但用作类型

> ID：11974867
> 
> 赞同：-2
> 
> 时间：2012-08-15T18:22:15.483
> 
> 标签：c#, arrays, string, variables

> **可能重复：（**
> [对象）是一个“字段”，但用作“类型”](https://stackoverflow.com/questions/8908803/object-is-a-field-but-is-used-like-a-type)

正如您可能已经从标题中猜到的那样，我收到此错误：

```
Invasion_server.variables.resources is a field but is used like a type 
```

给我这个错误的代码是：

```
class variables
{
    ....
    public static string[] resources = new string[30];
    resources[0] = "cities_wood";
    ....
} 
```

有人可以告诉我是什么导致了这个问题，因为它在代码的其他地方工作......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T18:23:09.600

你应该用某种方法做到这一点

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T18:24:49.927

试试这个：

```
class variables
{
    public static string[] resources = new string[30];

    static void doSomething() {
        resources[0] = "cities_wood";
    }
} 
```

您没有在类构造函数或方法中分配变量。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-15T18:32:33.633

如果您想在构造函数或方法主体之外初始化数组的成员，则需要使用带有声明的初始化器语法来执行此操作：

```
class variables
{ 
  public static string[] resources = new string[30] 
  { 
    "item one",
    "item two",
    ...
  }
} 
```

这样做的缺点是您需要填充所有 30 个值。如果您只想填充第一个，那么您需要在构造函数或方法体中这样做。您可以考虑一个静态构造函数，它与声明时的初始化具有相同的净效果；静态构造函数在第一次访问该类的成员时运行。例如：

```
class variables
{
  public static string[] resources;

  static variables()
  {
    resources = new string[30];
    resources[0] = "item one";
  }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-15T18:27:57.317

这是因为您试图对类主体中的变量而不是方法中的变量进行操作。您的班级主体中应该只有几件事：

1.  领域： `int myField = 0;`
2.  方法： `public void myMethod(){ }`
3.  构造函数/析构函数（只是一种特殊类型的方法）：`public MyClass(){}`

因此，当编译器看到 a 之后的第一个单词`;`（意味着它是新代码行的第一个单词）时，它希望看到一个标识符，如`public`,`static`等，或 a `Type`，如`int`。因为它不是一个标识符，所以它寻找一个类型，因为它不是一个类型，你得到了你的错误。

希望能很好地解释它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-15T18:25:19.677

你不能做

```
resources[0] = "cities_wood"; 
```

在你的类定义中。在静态构造函数或使用列表初始化程序中执行此操作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-15T18:26:10.100

您必须初始化方法或构造函数中的字段或声明中的所有字段，例如

```
class variables

    {
         public static string[] resources = new string[30];

        public variables()
        { 
           resources[0] = "cities_wood";
        }
    } 
```

或者

```
 public static string[] resources = {"cities_wood", "....", "more stuff", "and more stuff"};//Your 30 or les or more variables separated by a comma 
```

# sql - SQL - 查询中的用户输入

> ID：11974873
> 
> 赞同：5
> 
> 时间：2012-08-15T18:23:13.410
> 
> 标签：sql, sql-server

我有这个。“详细说明俱乐部在任何两个给定日期之间放映的所有电影，由用户输入。例如，俱乐部成员必须能够输入查询参数的开始日期和结束日期”

现在，我将如何进行用户输入？我能想到的唯一方法是使用php或带有html表单的东西来获取值，然后将它们作为查询中的变量提交。然而，这不是我们所需要的。那么，这是如何完成的，以便查询会询问值？或者你不能？

到目前为止，我的查询看起来像这样。

```
SELECT film.title, film.desc, show.sdate, show.fdate
FROM film
INNER JOIN show
ON film.ID=show.filmID
WHERE sdate = '&userstart' AND fdate = '&userend' 
```

我该如何处理用户输入？另外，查询是否正确？我没有办法测试，我只有一个设计而不是一个实现。

非常感谢

编辑：使用 Windows 系统，MS SQL Server。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T19:27:21.043

这是存储过程的代码：

```
CREATE PROCEDURE SomeName(@UserStart DATETIME, @UserEnd DATETIME) 
AS BEGIN

SELECT somestuff
FROM sometable
WHERE somedate BETWEEN @UserStart AND @UserEnd

END 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T19:15:11.567

@Kyle93 - 查看您的 WHERE 子句：

**WHERE sdate = '&userstart' AND fdate = '&userend'**

这只会让您获得 sdate（开始日期？）等于输入日期值的电影。您可能想要使用大于、小于运算符....

如：

**WHERE sdate <= '&userend' AND fdate >= '&userstart'**

（注意将 sdate 与 UserEnd Date 进行比较，以确保电影放映开始早于 UserEnd Date...等）

这样 - 当节目在日期范围内开始或结束时 - 它将被选中。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-08-15T18:26:36.157

你对 LINQ 很熟悉吗？这是一种从 c# 进行数据库调用的方法。

-- 我会按照您的想法使用 HTML 来处理这个问题，并使用 Javascript/Ajax 来引用使用 LINQ 进行 db 调用的 c# 代码。但是，如果您不熟悉其中的大部分内容，可能会有点复杂。如果有兴趣，我可以推荐好的教程。

# python - 如何使用 python 构建一个 int 数组并像 C 一样高效地操作它？

> ID：11974877
> 
> 赞同：2
> 
> 时间：2012-08-15T18:23:18.587
> 
> 标签：python

来自[http://www.cs.bell-labs.com/cm/cs/pearls/sol01.html](http://www.cs.bell-labs.com/cm/cs/pearls/sol01.html)：

C代码是这样的：

```
#define BITSPERWORD 32
#define SHIFT 5
#define MASK 0x1F
#define N 10000000
int a[1 + N/BITSPERWORD];

void set(int i) {        a[i>>SHIFT] |=  (1<<(i & MASK)); }
void clr(int i) {        a[i>>SHIFT] &= ~(1<<(i & MASK)); }
int  test(int i){ return a[i>>SHIFT] &   (1<<(i & MASK)); } 
```

我找到了[ctypes](http://docs.python.org/library/ctypes)、[BitArrays](http://wiki.python.org/moin/BitArrays)、[numpy](http://docs.scipy.org/doc/numpy/reference/routines.bitwise.html) ，但我不确定它们是否能像上面的 C 代码一样高效。

例如，如果我编写这样的代码：

```
from ctypes import c_int
a=[c_int(9)]*1024*1024 
```

使用的空间是 1M 字节还是更多？

有谁知道一些可以在 Python 中做同样事情的好库？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T18:26:18.520

Numpy 或 ctypes 都是不错的选择。但是你确定你的 Python 代码真的需要像 C 一样高效吗，你确定这段代码是性能热点吗？

最好的办法是使用 Python 分析器来确保此代码确实需要与 C 一样高效。如果确实如此，那么将代码保留在 C 中并使用某些东西链接到它可能是最简单的像 ctypes 或 SWIG。

**编辑**：为了回答您更新的问题，一个大小为 N 且元素大小为 M 的 numpy 数组将包含 N*M 字节的连续内存，以及一个标题和一些用于视图的字节。

以下是几个相关链接：

*   [numpy 数组的 Python 内存使用情况](https://stackoverflow.com/questions/11784329/python-memory-usage-of-numpy-arrays)
*   [numpy-arrays 的内存使用情况](http://old.nabble.com/Memory-usage-of-numpy-arrays-td29107053.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T18:29:34.530

您还可以检查内置`array`模块：

```
>>> import array
>>> help(array)
Help on built-in module array:

NAME
    array

FILE
    (built-in)

DESCRIPTION
    This module defines an object type which can efficiently represent
    an array of basic values: characters, integers, floating point
    numbers.  Arrays are sequence types and behave very much like lists,
    except that the type of objects stored in them is constrained.  The
    type is specified at object creation time by using a type code, which
    is a single character.  The following type codes are defined:

        Type code   C Type             Minimum size in bytes 
        'b'         signed integer     1 
        'B'         unsigned integer   1 
        'u'         Unicode character  2 (see note) 
        'h'         signed integer     2 
        'H'         unsigned integer   2 
        'i'         signed integer     2 
        'I'         unsigned integer   2 
        'l'         signed integer     4 
        'L'         unsigned integer   4 
        'f'         floating point     4 
        'd'         floating point     8 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-15T18:52:12.923

This:

```
a=[c_int()] 
```

makes a list which contains a reference to a c_int object.

Multiplying the list merely duplicates the references, so:

```
a = [c_int()] * 1024 * 1024 
```

actually creates a list of 1024 * 1024 references to the *same* single c_int object.

If you want an array of 1024 * 1024 c_ints, do this:

```
a = c_int * (1024 * 1024) 
```

# google-maps-api-3 - 如何修改谷歌地图上显示的天气信息

> ID：11974878
> 
> 赞同：1
> 
> 时间：2012-08-15T18:23:21.627
> 
> 标签：google-maps-api-3, google-weather-api

我使用 Google Maps API V3 创建了一个显示标记和天气层的谷歌地图。

天气层非常适合在知名地点显示天气信息；但是，对于我的地图，我只关心风速而不是预报（例如晴天、下雨等）。有什么方法可以修改天气图层，使其直接在地图上显示“风：s 5m/s”而不是太阳/雨图标？

我知道您可以单击图标来获取风信息，但鉴于我们不关心实际天气，我们不希望人们必须单击才能获得信息。相反，我们希望直接显示风。

（如果不可能，那么任何替代建议也将不胜感激:)）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T12:13:28.173

我在 mashape 上提供了一个[Weather API ，他们有一个可以使用的简单 PHP SDK。](http://metwit.com/developers/)这个 api 使用起来非常简单，因为我们使用了当今可用的很酷的标准，比如 JSON 和 REST。

如果您喜欢它，请在[mashape上尝试一下](http://www.mashape.com/metwit/weather-and-forecast)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T22:42:46.337

我已经尝试过，但还没有找到一种方法来更改加载天气图标时的外观。

当单击天气图标时，可以（您可能知道）使用离散天气数据项（如风速）创建自定义叠加层，但这似乎无法解决您的问题。[请参阅V3 API 参考](https://developers.google.com/maps/documentation/javascript/reference#WeatherLayer)
中的 “ *google.maps.weather.WeatherConditions 对象规范*”

像许多这类事情一样，我想理论上可以扫描 DOM，找到天气“标记”，提取你想要的信息并按照你希望它们的样子重新绘制它们，但你可能（不确定）找到天气图标实际上是图像，并且像风速这样的数据实际上并不存在于 DOM 中，直到单击天气图标：离散数据可能是响应单击事件的 ajax 负载的产物。即使你有一个 DOM 爬虫工作，它也可能被新版本的 API 破坏，你永远不知道是什么击中了你。

最好的办法可能是向 API 开发人员提交更改请求，要求能够格式化天气图标并指定其内容。

或者

使用其他一些 json 或 xml 天气数据的在线资源，并在地图上创建您自己的天气标记、标签或任何内容。

抱歉，我无法提供更具建设性的答案:-(

# python - 如何在 Python Logging 中设置源主机地址？

> ID：11974882
> 
> 赞同：6
> 
> 时间：2012-08-15T18:23:54.720
> 
> 标签：python, logging, syslog-ng

有一个用 Python 编写的脚本，它通过 IPMI 解析来自多个服务器的传感器数据和事件。然后它将图形数据发送到一台服务器，并将错误日志发送到另一台服务器。日志服务器是 Syslog-ng+Mysql

所以任务是按所有者存储日志，而不是按脚本主机存储日志。

一些代码示例：

```
import logging
import logging.handlers

loggerCent = logging.getLogger(prodName + 'Remote')
ce = logging.handlers.SysLogHandler(address=('192.168.1.11', 514), facility='daemon')
formatter = logging.Formatter('%(name)s: %(levelname)s: %(message)s')
loggerCent.setLevel(logging.INFO)

loggerCent.addHandler(ce)

loggerCent.warning('TEST MSG') 
```

所以我需要扩展代码，以便告诉 syslog-ng，该日志属于另一台主机。或者其他一些设计。

有任何想法吗？

升级版：

所以看起来有使用LogAdapter的方法。但是如何使用它：

```
loggerCent = logging.getLogger(prodName + 'Remote')
ce = logging.handlers.SysLogHandler(address=('192.168.1.11', 514), facility='daemon')
logging.basicConfig(level=logging.DEBUG,
                        format='%(asctime)-15s %(name)-5s %(levelname)-8s host: %(host)-15s %(message)s')
loggerCent.addHandler(ce)
loggerCent2 = logging.LoggerAdapter(loggerCent,
                               {'host': '123.231.231.123'})
loggerCent2.warning('TEST MSG') 
```

通过 TcpDump 查找消息我在 LoggerAdapter 中看不到有关主机的任何信息我做错了什么？

UPD2：

好吧，我没有找到将主机发送到 syslog-ng 的方法。虽然可以在链中发送第一个主机，但我真的找不到通过 Python Logging 发送它的方法。

无论如何，我在 syslog-ng 中制作了解析器： [CSV Parser](http://www.balabit.com/sites/default/files/documents/syslog-ng-ose-3.3-guides/syslog-ng-ose-v3.3-guide-admin-en.html/reference_parsers_csv.html)

```
parser ipmimon_log {
        csv-parser(
    columns("LEVEL", "UNIT", "MESSAGE")
    flags(escape-double-char,strip-whitespace)
        delimiters(";")
        quote-pairs('""[](){}')
    );
};

log {
    source(s_net);
    parser(ipmimon_log);
    destination(d_mysql_ipmimon);
};

log {
    source(s_net);
    destination(d_mysql_norm);
    flags(fallback);
}; 
```

然后我将日志发送到由 ; 分隔的 syslog-ng

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:47:26.297

编辑-重写

您错过了将您的实际添加`Formatter`到您的`Handler`. 尝试：

```
loggerCent = logging.getLogger(prodName + 'Remote')
loggerCent.setLevel(logging.DEBUG)
ce = logging.handlers.SysLogHandler(address=('192.168.1.11', 514), facility='daemon')
formatter = logging.Formatter('%(host)s;%(message)s')
ce.setFormatter(formatter)
loggerCent.addHandler(ce)
loggerCent2 = logging.LoggerAdapter(loggerCent, {'host': '123.231.231.123'})
loggerCent2.warning('TEST MSG') 
```

请注意，您将不再运行`basicConfig`，因此您将负责`Handler`自己为根记录器附加并设置日志级别（否则您将收到“无处理程序”错误）。

# javascript - 通过 Javascript 在 Windows Metro App 中打开一个 url

> ID：11974883
> 
> 赞同：1
> 
> 时间：2012-08-15T18:23:58.323
> 
> 标签：javascript, windows-8, microsoft-metro

通常，当我`<a href="_URL_"></a>`在 Metro 应用程序中使用时，URL 会在默认 Web 浏览器中打开。我不想用锚做这个，我想通过 Javascript 和异步做同样的行为。但我不知道如何使用默认浏览器打开网址。

这是我的代码：

```
var $aTag = $("<a/>").click(function (event) {
    showYesNoDialog(
        "Do you approve?", 
        "The link will be opened in another window. Do you approve?", 
        "Yes", // Text of yes button
        "No",  // Text of no button
        function () { // Behavior of yes button
            // I tried this but nothing happened.
            window.location.href = _URL_; // Should open in chrome or default web browser
        },
        function () { // Behavior of no button
            // do nothing
        }
    );
}); 
```

我还尝试过的是：

```
$("<a href='" + _URL_ + "'></a>").click(); 
```

但这也没有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:51:43.913

最后，我在谷歌搜索时找到了答案。 [使用 JavaScript 在新选项卡（而不是新窗口）中打开 URL](https://stackoverflow.com/questions/4907843/open-url-in-new-tab-using-javascript)

我用这段代码打开了地铁应用程序的网址，它在我的情况下工作：

```
window.open(_URL_, '_blank');
window.focus(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T18:49:54.087

您无法从 Metro 中启动实际的应用程序，但您可以做的是启动带有关联程序的文件，这应该会为您提供所需的功能。

[检查样品](http://code.msdn.microsoft.com/windowsapps/Association-Launching-535d2cec)

该示例涵盖文件和 URI - [http://msdn.microsoft.com/library/windows/apps/Hh701476](http://msdn.microsoft.com/library/windows/apps/Hh701476)

# c - 为什么许多初始化函数需要一个指针来初始化，而不是返回一个有效的？

> ID：11974884
> 
> 赞同：3
> 
> 时间：2012-08-15T18:23:58.450
> 
> 标签：c, pointers, init

> **可能重复：**
> [指针作为第二个参数而不是返回指针？](https://stackoverflow.com/questions/2520777/pointer-as-second-argument-instead-of-returning-pointer)

我经常看到这个：

```
Monkey* test = malloc(sizeof(Monkey));
Monkey_New(test); 
```

让 init 函数返回指针不是更干净吗？

```
Monkey* test = Monkey_New(); 
```

为什么经常以第一种方式进行？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T18:32:23.790

这两种设计在功能上截然不同。你要问的那个把分配的负担放在调用者身上。这有一个巨大的优势，即`malloc`如果对象不必超过调用者，则可以避免动态存储（）；它可以存储在自动变量中。这也意味着，假设 init 函数不必获取更多资源，您可以拥有一个无故障 API，调用者不必检查故障。另一方面，它要求将结构的定义（至少大小）暴露给调用模块，这意味着如果更新库代码以使用更大大小的对象，则必须重新编译调用者；因此，对于旨在拥有长期稳定 ABI 的共享库来说，这可能是负面的。

在您指出的替代设计中，获取存储的负担由被调用者（库函数）承担，并且它必须使用动态存储（`malloc`），因为自动存储在返回给调用者后无法生存。这个更抽象更干净，

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-15T18:31:20.343

这完全取决于开发人员使用的命名约定。考虑到这一点：

[http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml#Default_Constructors](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml#Default_Constructors)

对于 c++ 和 c，告诉你使用 new 并接受参数来帮助初始化，返回初始化的值。以前不是这样的，因为那时候是个蛮荒的世界。为了体面，使用 Monkey_New();

# xcode - 如何沙箱包含的框架

> ID：11974885
> 
> 赞同：1
> 
> 时间：2012-08-15T18:23:58.680
> 
> 标签：xcode, frameworks, app-store, sandbox

在我的沙盒应用程序多次成功提交到 App Store 后，今天 Apple 决定拒绝我的应用程序，因为它包含和链接的第三方框架没有沙盒。我不记得单独听说过沙盒框架。我知道他们需要进行代码签名，而这个就是。

通过文档和在线搜索不会找到有关框架沙盒的任何信息。

任何人都可以向我指出有关如何对我的第三方框架进行沙箱化的文档或教程。（如果有必要，我确实可以访问它的源代码，但是当我在 Xcode 中打开并检查框架的项目时，我没有看到任何明显的沙箱选项。

# xcode - NSZombies 是如何运作的？

> ID：11974890
> 
> 赞同：0
> 
> 时间：2012-08-15T18:24:18.320
> 
> 标签：xcode, memory-management, nszombie

我找不到任何关于`NSZombie`真正功能的详细苹果文档。我知道它的设计目的是不实际释放对象，而只是维护引用计数以捕获任何额外的版本，但是这样的事情将如何工作：

```
for(int i = 1; i < 10; i++)
{
NSMutableArray *array = [[NSMutableArray alloc] initWithCapacity: i];

[array release];

} 
```

由于同一个变量/对象在同一个应用程序中被分配/初始化和释放，在`NSZombie`技术上将如何处理这个？我知道这不应该标记任何僵尸，因为每个`alloc`都有一个`release`，但是 Xcode 如何在技术上处理重新分配具有不同容量的相同内存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T22:07:18.040

使用 Zombies，实际上不需要释放对象 [1] - 在对象的保留计数达到 0 后的某个时刻，对象只是简单地变成了“Zombie”。当您向“Zombified”实例发送消息时，会出现特殊错误处理程序被执行。

1) 释放僵尸是可选的。除非您真的需要内存来执行长时间运行或内存密集型任务，否则*不*释放僵尸 ( `NSDeallocateZombies`= `NO`)是一种更有效的测试

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T22:02:17.147

[Brad Larson](https://stackoverflow.com/users/19679/brad-larson)在评论中回答了这个问题。

引用：

> 那不是同一个对象，也不是同一个记忆。每次通过该循环时，您都会创建一个独特的新 NSMutableArray 实例。仅仅因为将每个指针分配给数组并不会使它们成为同一个对象。
> 
> 指针仅指向内存中存在对象的特定位置。内存中的给定对象可以有多个指向它的指针，甚至没有（当它被泄露时）。NSZombie 作用于对象本身，而不是指向它的指针。

# jersey - WS02 是否支持 Jersey 服务？

> ID：11974892
> 
> 赞同：0
> 
> 时间：2012-08-15T18:24:25.993
> 
> 标签：jersey, wso2, axis2, wso2carbon

WS02 是否支持 Jersey 服务？我可以在 WS02 中为 Axis2 设置代理服务，我想对 Jersey 做同样的事情。是否有任何有关在 WSo2 中设置 Jersey 代理服务的文档？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T11:43:23.837

我猜当你说泽西服务时 - 你的意思是说 RESTful 服务 - JAX-RS (JSR 311)。是的，WSO2 ESB 可以将流量路由到 RESTful 服务，并且您可以使用 ESB 中的 API 元素以 RESTful 方式公开后端服务。

# junit - lein 和 lein-test-out 插件

> ID：11974893
> 
> 赞同：1
> 
> 时间：2012-08-15T18:24:26.753
> 
> 标签：junit, clojure, leiningen

我想使用来自[https://github.com/arohner/lein-test-out/](https://github.com/arohner/lein-test-out/)或来自[https://clojars.org/org.clojars.jaley/lein-test-out的 lein-test-out 插件](https://clojars.org/org.clojars.jaley/lein-test-out)

但是当我在 dev-dependecty 中使用 [lein-test-out "0.1.0"] 时，什么都没有，当我使用

> :profiles {:dev { :dependencies [[junit/junit "4.10"] [lein/test-out "0.2.0"]] :plugins [[lein-test-out "0.2.0"]]

我得到了：leiningen.test-out 加载问题：在类路径上找不到 clojure/contrib/find_namespaces__init.class 或 clojure/contrib/find_namespaces.clj：

完整的项目.clj：

```
(defproject dataserver "0.1.0-SNAPSHOT"
:aot                [#"a\.b\..*"]
:omit-source         true
:warn-on-reflection  true
:min-lein-version    "2.0.0"
:source-paths       ["src-clj"]
:resource-paths     ["/home/storm/storm/conf/storm.yaml" "resources"]
:uberjar-name        "b.jar"
:uberjar-exclusions [#"log4j.properties"]
:main         a.b.repl
:ring         {:handler a.b.topmanager.core/app}
:dependencies [[org.clojure/clojure "1.4.0"]
             [org.clojure/data.json "0.1.3"]
             [org.clojure/data.priority-map "0.0.1"]
             [com.rabbitmq/amqp-client "2.8.4"]
             [org.scribe/scribe "1.3.1"]
             [http.async.client "0.4.5"]
             [org.clojure/tools.logging "0.2.4"]
             [clj-redis "0.0.12"]]
:profiles {:dev {
:dependencies [[storm "0.7.3" :exclusions [org.clojure/tools.loggin org.clojure/tools.cli  compojure  hiccup
                                            ring/ring-jetty-adapter  backtype/jzmq]]
               [org.clojure/data.xml "0.0.6"]
               [org.clojure/data.zip "0.1.1"]
               [compojure "1.0.4"]
               [ring/ring-jetty-adapter "1.1.1"]
               [org.slf4j/slf4j-log4j12 "1.6.6"]
               [junit/junit "4.10"]
               [org.clojars.jaley/lein-test-out "0.1.1-SNAPSHOT"]]                                                                                               
:plugins [[lein-ring "0.6.7"]
          [lein-test-out "0.1.1"]]
}}  
:jvm-opts     ["-Dfile.encoding=UTF-8"
             "-Dstorm.jar=target/b.jar"]
:repl-options {:timeout 60000}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:33:58.260

lein-test-out 似乎期望`clojure.contrib.find-namespaces`从`clojure.contrib`. 您可以尝试将`clojure.contrib`1.2 添加到您的依赖项中，但请记住，clojure.contrib 与 clojure 1.3 及更高版本不完全兼容，而`lein-test-out`它本身需要 1.3，所以看起来如果您需要可靠的东西，您可以自己修复它，找人否则为您修复或不使用`lein-test-out`.

# android - 在 Imageview 上合并两个 ColorMatrix 或同时应用两个或多个 ColorMatrix

> ID：11974895
> 
> 赞同：3
> 
> 时间：2012-08-15T18:24:38.567
> 
> 标签：android, image-processing, android-imageview, android-image, colormatrix

我正在更改 ImageView 的亮度、对比度、饱和度和色调。我已经搜索了很多。

我得到了一些适用于**ColorMatrix 的代码。**

**[1.]**对于**Brightness** ColorMatrix 有点像

```
 float brightness = (-50F * 1.5F);
    ColorMatrix cmB = new ColorMatrix();
    cmB.set(new float[] { 1, 0, 0, 0, brightness,
    0, 1, 0, 0,brightness,
    0, 0, 1, 0, brightness,
    0, 0, 0, 1, 0 });
    myImageView.setColorFilter(new ColorMatrixColorFilter(cmB)); 
```

哪个工作正常。

**[2.]**对于**对比度**ColorMatrix 是**不同**的东西，它也可以正常工作。

但是，所有这些 ColorMatrix 都是**单独**工作的。意味着最后应用的 ColorMatrix 的效果只是 ImageView 上的场景，因为它确实做到了，这**消除了之前应用的**ColorMatrix 的效果，并且设置最后应用了 ColorMatrix。

**现在我想同时合并或混合所有颜色矩阵。**表示要对 Brightnrs/Saturation/Hue 的 ColorMatrix 的效果应用对比度的 ColorMatrix。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T18:55:36.453

如果要应用两个颜色矩阵，只需将它们相乘即可。

如果您有颜色矩阵 A 和颜色矩阵 B，则：

```
C = B * A;
outpixel = C * inpixel 
```

相当于

```
outpixel = B * A * inpixel 
```

编辑

我刚刚注意到那些是 5x4 矩阵（最初我认为它们是 4x4）。由于您不能直接将它们相乘，我认为在相乘之前向两个矩阵添加第 5 行 (0,0,0,0,1) 是合适的（使它们都为 5x5），并在之后丢弃第 5 行倍增。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-31T12:31:36.480

您可以像这样应用多个矩阵：

```
ColorMatrix colorFilterMatrix = new ColorMatrix();
colorFilterMatrix.postConcat(getContrastMatrix(contrast));
colorFilterMatrix.postConcat(getBrightnessMatrix(brightness));

imageView.setColorFilter(new ColorMatrixColorFilter(colorFilterMatrix)); 
```

# objective-c - Cocoa 框架：在另一个框架中使用一个框架

> ID：11974906
> 
> 赞同：2
> 
> 时间：2012-08-15T18:25:07.790
> 
> 标签：objective-c, macos, cocoa

我正在构建一个使用另一个框架（子）的框架（主）。然后将在不同的应用程序中使用主框架。主框架目标构建没有错误。但是，如果我尝试构建一个使用主框架的应用程序，我会收到一个错误 -> 主框架中的类无法找到/导入子框架...如何配置主框架以便它可以找到子框架？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T07:30:31.420

据我了解，您想在另一个框架中创建一个框架。它被称为“伞框架”，这不是一个好主意。

文档说：

> **不要创建伞式框架**
> 
> 虽然可以使用 Xcode 创建伞式框架，但对于大多数开发人员来说，这样做是不必要的，也不推荐这样做。Apple 使用伞式框架来掩盖操作系统中库之间的一些相互依赖关系。在几乎所有情况下，您都应该能够将您的代码包含在单个标准框架包中。或者，如果您的代码足够模块化，您可以创建多个框架，但在这种情况下，模块之间的依赖关系将是最小的或不存在的，并且不应保证为它们创建一个保护伞。

您可以在另一个框架中使用一个框架，但两个框架都必须包含在您的应用程序目标中，并且必须复制到应用程序包的 /Contents/Frameworks/ 目录中。此外，您必须为这两个框架设置`Installation directory`为`@executable_path/../Frameworks`。

# selenium - 验证始终在变化的元素编号

> ID：11974911
> 
> 赞同：0
> 
> 时间：2012-08-15T18:25:28.957
> 
> 标签：selenium, selenium-ide

如果随着我通过电子邮件邀请更多人而增加，我如何编写 Selenium IDE 命令来验证该数字是否存在？

例如总人数：30 例一：如果我邀请1人，如何验证总人数为31人？例2：如果我邀请5个人，如何验证总人数是35人？

这是代码：

```
 <div style="color:#777; font-size:1.3em; float:right; margin-top:5px;">
    Total number of people:
    <span style="color:red;">30</span> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T14:17:59.770

我相信你必须：

1.  存储您将要进行多少次邀请的值
2.  存储预期人数的值（即当前加上邀请）
3.  去做邀请
4.  为新的总人数存储一个值
5.  将新数字与预期数字进行比较

下面对数字进行捕获和比较。您只需添加执行实际邀请的部分。

```
<tr>
    <td>store</td>
    <td>5</td>
    <td>people_invited</td>
</tr>
<tr>
    <td>storeText</td>
    <td>//div[contains(text(),'Total number of people')]</td>
    <td>original_count_text</td>
</tr>
<tr>
    <td>storeEval</td>
    <td>parseInt(storedVars['original_count_text'].match(/\d+/))+parseInt(storedVars['people_invited'])</td>
    <td>expected_count</td>
</tr>
<tr>
    <td>echo</td>
    <td>Go invite 5 people</td>
    <td></td>
</tr>   
<tr>
    <td>storeText</td>
    <td>//div[contains(text(),'Total number of people')]</td>
    <td>new_count_text</td>
</tr>
<tr>
    <td>storeEval</td>
    <td>parseInt(storedVars['new_count_text'].match(/\d+/))</td>
    <td>new_count</td>
</tr>
<tr>
    <td>verifyExpression</td>
    <td>${expected_count}</td>
    <td>${new_count}</td>
</tr> 
```

# windows-phone-7 - 工具包组件给出错误消息 windows phone

> ID：11974918
> 
> 赞同：0
> 
> 时间：2012-08-15T18:25:57.070
> 
> 标签：windows-phone-7, datepicker, silverlight-toolkit, assembly-references

我正在开发一个同时使用 DatePicker 和 LoopSelector 的应用程序。查看他们每个人的教程，我被建议添加程序集引用，第一个用于 DatePicker，第二个用于 Loopselector：

```
xmlns:toolkit="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone.Controls.Toolkit"

xmlns:toolkit="clr-namespace:Microsoft.Phone.ControlsPrimitives;assembly=Microsoft.Phone.Controls.Toolkit" 
```

然后我收到错误消息说`The type 'toolkit:Selector' wasn't found.`

我欢迎任何想法。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T19:17:38.817

您不能为它们使用相同的名称（“工具包”）！

# api - REST API 的正确资源名称

> ID：11974920
> 
> 赞同：0
> 
> 时间：2012-08-15T18:26:10.783
> 
> 标签：api, rest

假设我们正在制作发票 API。什么是更合适的资源？

`GET`

*   支付发票
*   到期发票
*   all_invoices

或者

`GET`

*   发票/全部
*   发票/到期
*   发票/已付

* * *

附加问题：如果您的 API 允许将发票标记为已付款，那么合适的资源是什么？

`PUT` `//where 3 is the id`

*   发票/3

或者

`PUT`

*   pay_invoice/3

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T08:45:54.200

我会说：

*   `GET /invoices`退回**所有**发票；
*   过滤器可以返回**已付**或**到期**的发票：`GET /invoices?state=paid`where `state`can be`paid`或`due`。

要将发票标记为已付款，您可以将相应的状态设置为您的资源，然后您只需使用`PUT /invoices/<id>`.

或者，您可以修补您的资源：`PATCH /invoices/<id>`. 这种方法需要一个差异`state=paid`，例如。

这只是您要发送到 API 的内容（完整的资源，或者只是要应用的更改）的问题。

非 REST 解决方案可能是`PATCH`对`/invoices/<id>/paid`. 这不是纯 REST，但没关系。

# django - 如何将参数传递给表单集中的表单？

> ID：11974924
> 
> 赞同：1
> 
> 时间：2012-08-15T18:26:24.453
> 
> 标签：django, formset

我想创建一个表单集，其中每个表单都有一个指向一组销售项目的下拉列表。

**模型：**

```
class SalesItem(models.Model):        
    item_description    = models.CharField(max_length=40)
    company             = models.ForeignKey(Company) 
```

在这里我创建了一个带有下拉列表的表单，希望将公司作为下拉列表的来源。坚持这个想法，因为我认为这在我的场景中是不可能的。

**形式：**

```
class SalesItemFSForm(Form):        
    sales_item      =   forms.ModelChoiceField(required=False, queryset = '')

    def __init__(self, company, *args, **kwargs):
        super(SalesItemFSForm, self).__init__(*args, **kwargs)
        self.fields.sales_item.queryset = company.salesitem_set.all() 
```

现在在我看来，我想用这个表单创建一个表单集：

```
formset_type = formset_factory(SalesItemFSForm, extra=0) 
```

问题马上就清楚了，因为我似乎无法通过公司来确定下拉菜单的来源。

我该怎么做？

非常感谢，

**更新：**

金戈似乎破解了它。:)

ModelForm 比 Form 更有效。最重要的是，我必须添加`fields = {}`到 SalesItemFSForm，以确保 SalesItem 的字段没有显示在模板中。因为我们感兴趣的只是我们的下拉列表（SalesItem）。

到目前为止，一切都很好。但现在我看到显示的下拉菜单与销售项目一样多。它不应该显示任何内容，除非用户按下 jquery 按钮。

我认为这是问题所在，我们不应该通过

```
formset_type = modelformset_factory(SalesItem, form=SalesItemFSForm, extra=0) 
```

因为我们的表单不需要任何 SalesItem 实例。我们需要一个虚拟模型。

这就是我最初尝试使用经典 Formset 而不是 ModelFormset 来解决它的原因。所以它有点一半。:)

**更新 2：**

金戈，说得好。实际上，我正在考虑自定义保存，在这里我只看到用户通过 jQuery 添加了多少表单集并将其保存在视图中。从字面上看，SalesItem 是一个多对多字段。但是标准的 M2m 小部件是可怕的。因此，我想用表单集替换它，其中每个 salesItem 都是一个下拉列表。然后，用户可以向页面添加尽可能多的下拉列表（formset 中的表单）并提交它们。然后我会在视图中添加关系。

```
class DealType(models.Model):    
    deal_name           = models.CharField(_(u"Deal Name"), max_length=40)
    sales_item          = models.ManyToManyField(SalesItem)    
    price               = models.DecimalField(decimal_places=2, max_digits=12) 
```

希望这可以说清楚。也许有一种更简单的方法可以做到这一点。:)

顺便说一句，我还发现了这个优秀的 jquery[片段代码](http://djangosnippets.org/snippets/1389/)如何在表单集中添加/删除表单。

**更新 3：**

实际上，当像这样实例化对象时，我们只会在表单集中获得一个表单，并且可以通过 jquery 添加更多表单。完美的！！除非有更简单的方法来实现这一点。:)

```
salesitem_formsets = formset_type(queryset=SalesItem.objects.filter(pk=1)) 
```

但是，这会在 request.POST 中重新搜索您，因为您不能只做：

```
salesitem_formsets = formset_type(request.POST) 
```

它仍然需要设置查询集。棘手的情况...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T19:59:55.543

我希望我理解你想要实现的目标是正确的。那么也许您可以像这样使用 ModelForm 及其可用实例：

```
class SalesItemFSForm(forms.ModelForm):
    class Meta:
        model = SalesItem

    def __init__(self, *args, **kwargs):
        super(SalesItemFSForm, self).__init__(*args, **kwargs)
        self.sale_items = self.instance.company.salesitem_set.all()
        self.fields['sales_item'] = forms.ModelChoiceField(queryset=self.sale_items) 
```

虽然这是未经测试的，只是一个想法。我希望这会导致正确的方向，但是如果完全错误，请告诉我，我将删除我的答案，以免其他人感到困惑:)。

# sql - 是否可以在 Access 2003 上使用 CROSS JOIN + INNER 和/或 OUTER 连接？如果是这样，怎么做？可能还需要子查询...？

> ID：11974925
> 
> 赞同：0
> 
> 时间：2012-08-15T18:26:26.303
> 
> 标签：sql, subquery, ms-access-2003, cross-join

我有一个包含几个表的数据库：[Plan Revenue]、[Plan Revenue Expense]、[Support Provider]、[Z Service Codes New]

我已经编写了一个查询，可以让我计算在过去 6 个月的特定服务代码中为每个提供商列出了多少费用记录。唯一的问题是，理想情况下，我希望它还列出过去 6 个月内未记录任何费用的服务代码的 0。

因此，基本上，我想将 [Z Service Codes New] 表与 [Support Providers] 表交叉，以获得提供者和所有服务代码之间的所有可能匹配。然后，在每个服务代码中，我希望它计算过去 6 个月内的费用记录数（嗯，我实际上已经设置了自定义日期，所以它更灵活）。

但是我一直坚持如何做到这一点，因此它不会将所有费用记录与所有服务代码匹配，而是仅将那些属于正确服务代码的费用记录（如果有）匹配。

[Plan Revenue].[Service] 是与 [Z Service Codes New] 匹配的外键。[Service Code] [Plan Revenue].[Rev ID] 是与 [Plan Revenue Expense] 匹配的外键。 [RevID] [Plan Revenue Expense].[SP] 是与 [Support Provider].[ID] 匹配的外键

不要问我为什么为了简单起见，数据库构建器没有让他们的键从一个表匹配到下一个表。就是这样……

我当前的查询看起来像这样：

* * *

```
SELECT [support provider].[sp last],
       [support provider].[sp first],
       [support provider].[sp mi],
       [support provider].[agency],
       [support provider].[de?],
       [support provider].[ic?],
       [support provider].[agency?]     AS [AG?],
       [support provider].[generalbus?] AS [GB?],
       [ExpsToCount].[counted svc],
       Iif(Count([ExpsToCount].[exptocountid]) = 0, 0, Count(
       [ExpsToCount].[exptocountid]))   AS ExpCount
FROM   [support provider]
       LEFT JOIN (SELECT [plan revenue expense].[sp]          AS [Counted SP],
                         [z service codes new].[service code] AS [Counted Svc],
                         [plan revenue expense].[exp id]      AS [ExpToCountID]
                  FROM   [z service codes new]
                         LEFT JOIN ([plan revenue]
                                    LEFT JOIN [plan revenue expense]
                                           ON [plan revenue].[rev id] =
                                              [plan revenue expense].[revid])
                                ON [z service codes new].[service code] =
                                   [plan revenue].[service]
                  WHERE  ( [plan revenue expense].[checkdt] >=
                           Format([period beginning "mm/dd/yyyy"], "short date")
                           AND [plan revenue expense].[checkdt] <=
                 Format([periond ending "mm/dd/yyyy"], "short date") ))
                             AS ExpsToCount
              ON [ExpsToCount].[counted sp] = [support provider].[id]
WHERE  [support provider].[inactive?] = false
       AND ( [support provider].[de?] = true
              OR [support provider].[ic?] = true )
GROUP  BY [support provider].[sp last],
          [support provider].[sp first],
          [support provider].[sp mi],
          [support provider].[agency],
          [support provider].[de?],
          [support provider].[ic?],
          [support provider].[agency?],
          [support provider].[generalbus?],
          [ExpsToCount].[counted svc]
ORDER  BY [ExpsToCount].[counted svc],
          [support provider].[agency],
          [support provider].[sp last],
          [support provider].[sp first],
          [support provider].[sp mi],
          [ExpsToCount].[counted svc]; 
```

* * *

`[IC?], [DE?], [Agency?], [GeneralBus?]`只是表示支持提供者类型的布尔字段。同样，为什么数据库人员选择这个而不是带有外键的单个字段，所以你只能是一种类型的提供者，我不知道......只是滚动它。

所以，我目前也在使用子查询。

但是，它并没有给我没有费用相关的服务代码零。它只是给我计算实际费用，如果我不关心 0 就好了，我有点这样做......如果只是为了我自己的教化。

我觉得我在最后一天左右一直在玩这个东西，我的大脑是朋友。需要第二双眼睛。

我觉得我需要将 [Support Provider] 与 [Z Service Codes New] 交叉加入，以便获得所有可能的匹配项，然后以某种方式选择性地给出 0（如果没有相关的费用记录）或 COUNT（如果有费用）记录。但无论如何，我都希望每个支持提供商都有一个服务代码。

不确定在 Access 中将 CROSS JOIN 与某种 INNER JOIN 或 OUTER JOIN 组合的语法是什么？对于我的目的来说，最好的组合是什么。我可以在没有子查询的情况下以某种方式逃脱，还是我仍然需要它？与 CROSS JOIN 相比，有没有更好的方法来做到这一点？（我认为这就是 CROSS JOIN 的设计目的......但我可能错了吗？）

希望一切都说得通。想法？哦，我正在使用 Access 2003 Professional SP3。

* * *

编辑：

好的，我自己的优雅解决方案（好吧，好吧，我不知道它是否优雅，但它有效！）是在我的主 FROM 行中创建两个自定义 SELECT 语句，然后根据两个匹配条件加入两个 SELECT 语句：

* * *

```
SELECT [ProvidersXCodes].[SP Last], [ProvidersXCodes].[SP First], [ProvidersXCodes].[SP MI], [ProvidersXCodes].[Agency], [ProvidersXCodes].[SvcCode], IIf(COUNT([ExpsToCount].[ExpCountID])=0,0,COUNT([ExpsToCount].[ExpCountID])) AS [Exp Count]

FROM (SELECT [Support Provider].[ID] AS [CodeProvider], [Support Provider].[SP Last], [Support Provider].[SP First], [Support Provider].[SP MI], [Support Provider].[Agency], [Z Service Codes New].[Service Code] AS [SvcCode]

FROM [Support Provider], [Z Service Codes New]

WHERE [Support Provider].[Inactive?]=FALSE
AND ([Support Provider].[DE?]=TRUE OR [Support Provider].[IC?]=TRUE)
AND NOT ([Z Service Codes New].[Service Code] LIKE '111*'
OR [Z Service Codes New].[Service Code] LIKE '222*'
OR [Z Service Codes New].[Service Code] LIKE '333*')

GROUP BY [Support Provider].[ID], [Support Provider].[SP Last], [Support Provider].[SP First], [Support Provider].[SP MI], [Support Provider].[Agency], [Z Service Codes New].[Service Code]) AS [ProvidersXCodes] 

LEFT JOIN (SELECT [Support Provider].[ID] AS [ExpCountProv], [Plan Revenue].[Service] AS [ExpCountSvc], [Plan Revenue Expense].[Exp ID] AS [ExpCountID]

FROM [Plan Revenue], [Plan Revenue Expense], [Support Provider]

WHERE [Plan Revenue].[Rev ID]=[Plan Revenue Expense].[RevID]
AND [Plan Revenue Expense].[SP]=[Support Provider].[ID]
AND [Support Provider].[Inactive?]=FALSE
AND ([Support Provider].[DE?]=TRUE OR [Support Provider].[IC?]=TRUE)
AND ([Plan Revenue Expense].[CheckDt]>=Format([Period Beginning "MM/DD/YYYY"],"Short Date") AND [Plan Revenue Expense].[CheckDt]<=Format([Periond Ending "MM/DD/YYYY"],"Short Date"))

GROUP BY [Support Provider].[ID], [Plan Revenue].[Service], [Plan Revenue Expense].[Exp ID]) AS [ExpsToCount] ON ([ProvidersXCodes].[CodeProvider]=[ExpsToCount].[ExpCountProv] AND [ProvidersXCodes].[SvcCode]=[ExpsToCount].[ExpCountSvc])

GROUP BY [ProvidersXCodes].[SP Last], [ProvidersXCodes].[SP First], [ProvidersXCodes].[SP MI], [ProvidersXCodes].[Agency], [ProvidersXCodes].[SvcCode]

ORDER BY [ProvidersXCodes].[SvcCode], [ProvidersXCodes].[Agency], [ProvidersXCodes].[SP Last], [ProvidersXCodes].[SP First], [ProvidersXCodes].[SP MI]; 
```

* * *

问题解决了！

我认为必须用语言表达问题有助于解决问题，因为我让自己考虑实际问题是什么，哪些特定信息需要成为交叉产品，哪些信息需要更标准的连接操作以及如何正确链接这两组...

〜MG（我）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T06:33:45.717

好吧，我自己看似优雅的解决方案（好吧，好吧，我不知道它是否优雅，但它似乎有效！）是在我的主 FROM 子句中创建两个自定义 SELECT 语句，然后加入两个 SELECT 语句基于两个匹配标准：

* * *

```
SELECT [ProvidersXCodes].[SP Last], [ProvidersXCodes].[SP First], [ProvidersXCodes].[SP MI], [ProvidersXCodes].[Agency], [ProvidersXCodes].[SvcCode], IIf(COUNT([ExpsToCount].[ExpCountID])=0,0,COUNT([ExpsToCount].[ExpCountID])) AS [Exp Count]

FROM (SELECT [Support Provider].[ID] AS [CodeProvider], [Support Provider].[SP Last], [Support Provider].[SP First], [Support Provider].[SP MI], [Support Provider].[Agency], [Z Service Codes New].[Service Code] AS [SvcCode]

FROM [Support Provider], [Z Service Codes New]

WHERE [Support Provider].[Inactive?]=FALSE
AND ([Support Provider].[DE?]=TRUE OR [Support Provider].[IC?]=TRUE)
AND NOT ([Z Service Codes New].[Service Code] LIKE '111*'
OR [Z Service Codes New].[Service Code] LIKE '222*'
OR [Z Service Codes New].[Service Code] LIKE '333*')

GROUP BY [Support Provider].[ID], [Support Provider].[SP Last], [Support Provider].[SP First], [Support Provider].[SP MI], [Support Provider].[Agency], [Z Service Codes New].[Service Code]) AS [ProvidersXCodes] 

LEFT JOIN (SELECT [Support Provider].[ID] AS [ExpCountProv], [Plan Revenue].[Service] AS [ExpCountSvc], [Plan Revenue Expense].[Exp ID] AS [ExpCountID]

FROM [Plan Revenue], [Plan Revenue Expense], [Support Provider]

WHERE [Plan Revenue].[Rev ID]=[Plan Revenue Expense].[RevID]
AND [Plan Revenue Expense].[SP]=[Support Provider].[ID]
AND [Support Provider].[Inactive?]=FALSE
AND ([Support Provider].[DE?]=TRUE OR [Support Provider].[IC?]=TRUE)
AND ([Plan Revenue Expense].[CheckDt]>=Format([Period Beginning "MM/DD/YYYY"],"Short Date") AND [Plan Revenue Expense].[CheckDt]<=Format([Periond Ending "MM/DD/YYYY"],"Short Date"))

GROUP BY [Support Provider].[ID], [Plan Revenue].[Service], [Plan Revenue Expense].[Exp ID]) AS [ExpsToCount] ON ([ProvidersXCodes].[CodeProvider]=[ExpsToCount].[ExpCountProv] AND [ProvidersXCodes].[SvcCode]=[ExpsToCount].[ExpCountSvc])

GROUP BY [ProvidersXCodes].[SP Last], [ProvidersXCodes].[SP First], [ProvidersXCodes].[SP MI], [ProvidersXCodes].[Agency], [ProvidersXCodes].[SvcCode]

ORDER BY [ProvidersXCodes].[SvcCode], [ProvidersXCodes].[Agency], [ProvidersXCodes].[SP Last], [ProvidersXCodes].[SP First], [ProvidersXCodes].[SP MI]; 
```

* * *

问题解决了！

我认为必须用语言表达问题有助于解决问题，因为我让自己考虑实际问题是什么，哪些特定信息需要成为交叉产品，哪些信息需要更标准的连接操作以及如何正确链接这两组...

〜MG（OP）

# ruby - 如何在 Ruby 中按数值对哈希进行排序而不转换为数组？

> ID：11974927
> 
> 赞同：4
> 
> 时间：2012-08-15T18:26:33.093
> 
> 标签：ruby, sorting, hash

我有一个哈希：`{"spider" => 213, "frog" => 128, "apple" => 812}`。

如何重新排序，以便按值按降序对它们进行排序，而不将其转换为数组？因此，将其更改为`{"apple" => 812, "spider" => 213, "frog" => 128}`不将其放入数组中。

我试过`.sort_by`了，但这会将其转换为数组。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T18:38:13.240

在 Ruby 1.9 中，“[哈希按照插入相应键的顺序枚举它们的值](http://ruby-doc.org/core-1.9.3/Hash.html)”，因此只需确保以正确的方式插入它们：

```
Hash[h.sort_by { |_, v| -v }]
#=> > {"apple"=>812, "spider"=>213, "frog"=>128} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T20:30:37.057

您是否需要对哈希本身进行排序，或者只是按排序顺序对其内容进行操作？如果是后者，那么这个片段将起作用：

```
myhash.keys.sort.each { |k| .... do something with myhash[k] .... } 
```

除了简单地按排序顺序填充散列之外，我能看到的唯一方法是使用中间数组：

```
Hash[myhash.sort] 
```

但是，作为程序员，您不会“看到”中间状态。对散列使用 sort 方法会将散列转换为已排序的数组数组，而 #[] 方法将数组强制转换为散列。至少在 Ruby-1.9.3 上。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-15T18:39:13.830

所以这个问题不是无关紧要的。但为什么？重新排序是什么意思？就地重新排序？无论您做什么，都必须以某种方式从哈希中提取值。为什么害怕数组？你知道小散列现在在 Ruby 中实现为数组吗？（或者会在 2.0 中？）Matz 没有故意向哈希添加排序方法，我阅读了他关于这个主题的帖子......

# sql - 添加 uniqueidentifier 列并添加默认值以生成新的 guid

> ID：11974939
> 
> 赞同：27
> 
> 时间：2012-08-15T18:27:18.380
> 
> 标签：sql, sql-server, sql-server-2008

我有以下 SQL 命令：

```
ALTER TABLE dbo.UserProfiles
ADD ChatId UniqueIdentifier NOT NULL,
UNIQUE(ChatId),
CONSTRAINT "ChatId_default" SET DEFAULT newid() 
```

我希望能够使该列独一无二，并且我希望它能够在每次向表中添加一行时生成一个新的 guid。此列不是 IDENTITY 列，因为我已经有了一个。这是分开的。我将如何将此列添加到已经有用户的表中。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-15T18:36:40.430

看到这个样本：

```
create table test (mycol UniqueIdentifier NOT NULL default newid(), name varchar(100))
insert into test (name) values ('Roger Medeiros')
select * from test 
```

要在填充表上添加非空字段，您需要这个。

```
alter table test add mycol2 UniqueIdentifier NOT NULL default newid() with values

CREATE UNIQUE NONCLUSTERED INDEX IX_test ON dbo.test
(
mycol
) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON,    ALLOW_PAGE_LOCKS = ON) ON [PRIMARY] 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-08-15T19:09:41.197

不要`newid()`默认使用，而是使用[newsequentialid()](http://msdn.microsoft.com/en-us/library/ms189786.aspx)。`newid()`会产生很多碎片，这对索引不利。

至于将新列添加到具有现有数据的表中，只需执行以下操作：

```
 ALTER TABLE your_table
    ADD your_column UNIQUEIDENTIFIER DEFAULT newsequentialid() NOT null 
```

# jpa - 从播放框架中的fixture / yaml加载时关系破裂

> ID：11974941
> 
> 赞同：0
> 
> 时间：2012-08-15T18:27:21.377
> 
> 标签：jpa, playframework, yaml, fixtures

我发现播放框架有问题。我也可以重现它，所以在这里我将展示一个简化的重现场景。

启动播放应用程序时，我想从 yaml 文件中读取示例数据。因此，我使用类 Fixtures。在 yaml 文件中，我准备了相互关联的对象的数据结构。

数据结构的模型类如下所示：

```
@Entity
public class Album extends Model{
 public String name;
 @ManyToOne
 public Artist artist;
}
@Entity
public class Artist extends Model{
 public String name;
 @OneToMany(mappedBy="artist")
 public List<Album> albums = new ArrayList<Album>();
} 
```

我用来加载 yaml 文件并控制结果的作业如下所示：

```
@OnApplicationStart
public class Bootstrap extends Job {
@Override
public void doJob(){
    Fixtures.deleteAllModels();
    Fixtures.loadModels("sample.yml");
    List<Artist> artists = Artist.findAll();
    for (Artist artist : artists) {
        play.Logger.info(artist.name + " has " + artist.albums.size() + " albums");
    }        
}
} 
```

如果我在我的 yml 文件中使用以下结构，那么它可以工作：

```
Artist(b1):
  name: Nirvana
Artist(b2):
  name: ACDC
Album(a1):
  name: Back in Black
  artist: b2
Album(a2):
  name: Highway to Hell
  artist: b2
Album(a3):
  name: Nevermind
  artist: b1
Album(a4):
  name: Bleach
  artist: b1 
```

但是，如果我这样做，那么它将无法正常工作：

```
Album(a1):
  name: Back in Black
Album(a2):
  name: Highway to Hell
Album(a3):
  name: Nevermind
Album(a4):
  name: Bleach
Artist(b1):
  name: Nirvana
  albums: [a3,a4]
Artist(b2):
  name: ACDC
  albums: [a1,a2] 
```

但是，[此处](http://www.playframework.org/documentation/1.2.1/yaml)的文档告诉我们，第二种方法应该有效。

我在示例代码中是否犯了错误，或者这真的是播放框架或 JPA 的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T07:15:37.020

不，根据文档，您的第二次尝试不应该奏效。问题在于*关系所有者*的概念。保持双向关系时，仅会咨询所有者方（由 mappedby 引用的一方）。

在你的情况下

```
Artist(b1):
  name: Nirvana
  albums: [a3,a4] 
```

对以下列表进行操作，该列表不是关系所有者：

```
 //owner of this relationship if attribute artist in Album entity.
 @OneToMany(mappedBy="artist")
 public List<Album> albums = new ArrayList<Album>(); 
```

您的第一次尝试使用`artist`. `Album`它有效，因为它是和`artist`之间双向关系的所有者。由于同样的原因，您链接的文档中的示例也有效。`Album``Artist`

# javascript - jquery-1.7.1.min 上的第 3 行访问被拒绝

> ID：11974944
> 
> 赞同：-1
> 
> 时间：2012-08-15T18:27:27.540
> 
> 标签：javascript, jquery, internet-explorer

```
function(a){return f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.makeArray(a.childNodes) 
```

这是 IE9 脚本调试中的违规行

我正在使用**jquery-1.7.1.min**

在 Windows 7（64 位）上使用 IE9（32 位）进行测试

```
<!DOCTYPE HTML>
<html dir="ltr" lang="en-US">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Hitachi Password Manager</title>
    <!--- CSS --->
    <link rel="stylesheet" href="style.css" type="text/css" />
    <!--- jQuery --->
    <script type="text/javascript" src="jquery-1.7.1.min"></script>
    <!--- Javascript libraries (jQuery and Selectivizr) used for the custom checkbox --->
    <!--[if (gte IE 6)&(lte IE 8)]>
        <script type="text/javascript" src="jquery-1.7.1.min.js"></script>
        <script type="text/javascript" src="selectivizr.js"></script>
        <script type="text/javascript" src="IE7.js"></script>

        <noscript><link rel="stylesheet" href="fallback.css" /></noscript>
    <![endif]-->

    <script type="text/javascript">
        var isIFrameLoad, myPassword;

        $(document).ready(function () {
            $('#hitachiIFrame').load(function () {
                //alert('loaded!'); 
                isIFrameLoad = true;
            });
            $("#container").load("login.html");
        });
    </script>
</head>
<body>
    <div id="overlay" style="display:none;">
        <div style=" filter: Alpha(Opacity=80); opacity:0.7; width:100%; height:100%; background-color:white; top:0; position:absolute;" >
            <center><img src="images/loader.gif" /></center>
        </div>
    </div>
    <div id="container">
    </div>
    <!-- <iframe id="hitachiIFrame" src="test/test.html" /> -->
    <iframe id="hitachiIFrame" src="#" height="0px" width="0px"/>
    <div id="footer">
        copyright(c) 2012 Company Name
    </div>
</body>
</html> 
```

我也用这个替换了一行（脚本行）

```
<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.0.js"></script> 
```

我仍然收到错误说访问被拒绝，但它是不同的行号

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T13:48:17.363

```
window.frames[1].document.getElementBy… 
```

这应该可以帮助你。

# node.js - Everyauth vs Passport.js？

> ID：11974947
> 
> 赞同：123
> 
> 时间：2012-08-15T18:27:53.790
> 
> 标签：node.js, connect, everyauth, passport.js

[Everyauth](https://github.com/bnoguchi/everyauth/)和[Passport.js](http://passportjs.org/)似乎具有非常相似的功能集。两者之间有哪些正面和负面的比较会让我想使用其中的一个？

* * *

## 回答 #1

> 赞同：192
> 
> 时间：2012-08-15T23:01:38.587

作为[Passport](http://passportjs.org/)的开发人员，请用我的两分钱插话。

在开发 Passport 之前，我评估了everyauth 并确定它不符合我的要求。所以，我着手实施一个不同的解决方案。我想解决的主要问题是：

**惯用的 Node.js**

everyauth 广泛使用 Promise，而不是 Node 使用回调和闭包的方法。Promise 是异步编程的另一种方法。虽然在某些高级情况下很有用，但我对将这种选择强加于我的应用程序的身份验证库感到不舒服。

此外，我发现正确使用回调和闭包会产生简洁、架构良好（几乎是函数式风格）的代码。Node 本身的大部分功能都来自这一事实，Passport 也效仿。

**模块化的**

Passport 采用一种策略设计模式来定义核心模块和各种身份验证机制之间的关注点的清晰分离。这有很多好处，包括更小的整体代码大小和定义良好且可测试的接口。

对于基本说明，比较 running`$ npm install passport`和`$ npm install everyauth`. Passport 允许您仅使用您实际需要的依赖项来制作您的应用程序。

这种模块化架构已证明自己具有适应性，有助于实现对各种身份验证机制（包括 OpenID、OAuth、BrowserID、SAML 等）的支持的社区。

**灵活的**

Passport*只是中间件*，使用`fn(req, res, next)`Connect 和 Express 建立的约定。

这意味着*没有意外*，因为您定义了您想要路由的位置以及何时要使用身份验证。也不依赖于特定的框架。人们成功地将 Passport 与[Flatiron等其他框架一起使用](http://flatironjs.org/)

相反，everyauth 中的任何模块都可以将路由插入到您的应用程序中。这会使调试变得困难，因为路由将如何分派并导致与特定框架的紧密耦合并不明显。

Passport 也以完全传统的方式出错，仅次于 Express 定义的[错误处理中间件。](http://expressjs.com/guide.html#error-handling)

相比之下，everyauth 有自己的约定，不能很好地适应问题空间，导致长期存在的开放问题，例如[#36](https://github.com/bnoguchi/everyauth/issues/36)

**API 认证**

任何身份验证库的最高成就是它能够像基于 Web 的登录一样优雅地处理 API 身份验证。

关于这一点我不会过多阐述。但是，我鼓励人们研究 Passport 的兄弟项目[OAuthorize](https://github.com/jaredhanson/oauthorize)和[OAuth2orize](https://github.com/jaredhanson/oauth2orize)。使用这些项目，您可以为基于 HTML/会话的 Web 应用程序和 API 客户端实现“全栈”身份验证。

**可靠的**

最后，身份验证是应用程序的关键组件，您希望完全放心地依赖它。everyauth 有一长串[问题](https://github.com/bnoguchi/everyauth/issues)，其中许多问题随着时间的推移仍然存在并重新浮出水面。在我看来，这是由于单元测试覆盖率低，这本身表明everyauth 中的内部接口没有适当定义。

相比之下，Passport 的接口及其策略定义良好，并且被单元测试广泛覆盖。 针对 Passport 提出的[问题大多是次要功能请求，而不是与身份验证相关的错误。](https://github.com/jaredhanson/passport/issues)

尽管是一个年轻的项目，但这种质量水平表明更成熟的解决方案更容易维护和信任。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-08-15T19:43:07.167

## 护照

*   模块化和透明
*   好的文档
*   社区贡献（由于它的模块化）
*   与每个人和他们的狗一起工作（同样，由于它的模块化）

## 所有人

*   发展历史悠久，成熟。
*   不再维护
*   很棒的文档
*   与广泛的服务合作

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-05-26T22:49:14.190

刚完成从everyauth到passport的更改。原因如下。

1.  Everyauth 不够稳定。最后一根稻草是上周我被一个神秘的问题咬住了，Facebook 身份验证可以在 local.host 和生产环境上工作，但不能在我的 heroku 测试环境中工作，即使使用相同的代码和数据库以及新的 heroku 应用程序实例。那时我已经没有关于如何隔离问题的理论，因此删除everyauth 是合乎逻辑的下一步。
2.  它为使用用户名/密码凭据的标准身份验证提供支持的方式不容易与单页 Web 应用程序方法集成。
3.  我无法让everyauth 使用 Google 帐户。
4.  everyauth 的积极发展似乎正在下降。

该端口出奇地无痛，只需要几个小时，包括手动测试。

所以很明显，我建议去办护照。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-08-15T19:40:14.080

我首先尝试了 Everyauth，然后就去了 Passport。它让我觉得更灵活，尤其是。如果（例如）我需要为不同的提供者提供不同的逻辑。它还使 (imo) 更容易配置自定义身份验证策略。另一方面，它没有视图助手，如果这些对你很重要的话。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-02-14T02:10:46.273

这个答案有点晚了，但我发现了这个线程并且（在听到所有关于 Everyauth 的负面反馈之后）决定使用 Passport ......然后讨厌它。它是不透明的，只能用作中间件（例如，您无法从 GraphQL 端点进行身份验证），而且我遇到了不止一个难以调试的错误（例如，[我如何拥有两个 Express 会话？](https://stackoverflow.com/questions/48777201/how-do-i-have-two-express-sessions/48777400#48777400)）。

所以我去寻找并找到了[https://github.com/jed/authom](https://github.com/jed/authom)。对于我的需要，这是一个更好的图书馆！它比其他两个库要低一些，所以你必须自己做一些事情，比如让用户进入会话……但这只是一行，所以真的没什么大不了的。

更重要的是，它的设计为您提供了更多控制权，使您可以轻松地以您想要的方式而不是 Passport 预期的方式实施您的授权。另外，与 Passport 相比，它更简单、更容易学习。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-04-16T14:37:19.067

我曾经更具体地说是使用 Everyauth mongoose-auth。我发现在不拆除everyauth 模块的情况下很难正确拆分我的文件。在我看来，Passport 是一种更简洁的创建登录的方法。有一篇文章我觉得很有帮助[http://rckbt.me/2012/03/transitioning-from-mongoose-auth-to-passport/](http://rckbt.me/2012/03/transitioning-from-mongoose-auth-to-passport/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-06T19:55:58.280

注意这篇文章的日期，它将表明这篇文章的相关性。

以我的经验，Everyauth 的密码登录方式并不是开箱即用的。我正在使用 express3 并且我像这样声明了我的中间件`app.use(everyauth.middleware(app));`，但它仍然没有将 everyauth 本地传递给我的模板。最后一次 git 提交是一年前，我认为新包已经破坏了everyauth。现在我要试试护照。

# dictionary - lua 5.2 改变表格中元素的顺序

> ID：11974950
> 
> 赞同：4
> 
> 时间：2012-08-15T18:28:02.990
> 
> 标签：dictionary, lua, lua-table

在 lua 5.1 中，代码：

```
sums = { 
    ["LD1"] = { }, 
    ["LD2"] = { }, 
    ["LD3"] = { }, 
    ["LD4"] = { }, 
    ["I1"] = { }, 
    ["I2"] = { }, 
    ["I3"] = { }
}

for fld = 1, 22, 1 do
    table.insert( sums["LD1"] , 0 );
    table.insert( sums["LD2"] , 0 );
    table.insert( sums["LD3"] , 0 );
    table.insert( sums["LD4"] , 0 );
    table.insert( sums["I1"] , 0 );
    table.insert( sums["I2"] , 0 );
    table.insert( sums["I3"] , 0 );
end

for i,O in pairs(sums) do
    print(i)
end 
```

显示顺序：

*（第一次执行）*

```
LD1
LD2
LD3
LD4
I1
I2
I3 
```

*（第二次执行）*

```
LD1
LD2
LD3
LD4
I1
I2
I3 
```

在 lua 5.2 中，序列以随机顺序呈现：

*（第一次执行）*

```
I1
I2
LD4
I3
LD1
LD2
LD3 
```

*（第二次执行）*

```
LD2
LD3
LD4
I3
I1
I2
LD1 
```

为什么当我使用 lua 5.2 时会发生此错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T18:41:54.143

Lua 5.1 和 5.2 在[`next`函数](http://www.lua.org/manual/5.1/manual.html#pdf-next)（`pairs`函数使用）中都提到了以下内容：

> *未指定枚举索引的顺序，即使对于数字索引也是如此。*

请注意，许多编程语言的基于散列的结构（Lua 表*就是*这样）不保证其值的任何特定（插入）顺序。

换句话说：这不是错误。您不应该期望表格中插入元素的任何特定顺序。您可以期望的唯一顺序是当您使用数字作为键时，并使用将迭代对 ( )、( )、的[`ipairs`函数](http://www.lua.org/manual/5.2/manual.html#pdf-ipairs)，直到表中缺少的第一个整数键。`1,t[1]``2,t[2]``...`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-15T18:56:52.160

Lua 5.2.1 为散列引入了一些随机化种子。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-15T18:56:05.067

表的元素没有指定的顺序。

您需要创建一个表，将数字索引映射到`sums`. 您甚至可以使用该`sums`表来保存子表和对它们的排序。

例如：

```
-- create table with sum ids in a specific order
sums = { "LD1", "LD2", "LD3", "LD4", "I1", "I2", "I3" }

-- create subtables in sums for each id
for i,id in ipairs(sums) do
    sums[id] = {}
end

-- stick some data in the sum tables
for fld = 1, 22 do
    table.insert( sums["LD1"] , 0 );
    table.insert( sums["LD2"] , 0 );
    table.insert( sums["LD3"] , 0 );
    table.insert( sums["LD4"] , 0 );
    table.insert( sums["I1"] , 0 );
    table.insert( sums["I2"] , 0 );
    table.insert( sums["I3"] , 0 );
end

-- show sum tables in order
for i,id in ipairs(sums) do
    print(id, sums[id])
end 
```

# github - 安装：GitHub gamejs

> ID：11974951
> 
> 赞同：0
> 
> 时间：2012-08-15T18:28:05.677
> 
> 标签：github, installation

我今天开始为一个小项目使用 gamejs。我看到大多数项目都是 github dot com 上的存储库文件，所以我下载了 github for windows 和 git bash。

然后我使用 git bash 克隆 gamejs 存储库。我对一些存储库的东西进行同样的处理。但是，我似乎忘记安装一些东西......因为我无法启动服务器，我缺少 gjs-server.sh 或 .cmd。bash 无法识别该命令。我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T00:13:53.460

由于您克隆了代码而不是下载发行版压缩包，因此您需要先[构建](http://gamejs.org/installation/)GameJS：

> 切换到 GameJs 目录
> 
> ```
> cd gamejs 
> ```
> 
> 使用 git 获取所有需要的子模块：
> 
> ```
> git submodule init git submodule update 
> ```
> 
> 编译 RingoJs：
> 
> ```
> ant -f ./server/ringojs/build.xml jar 
> ```

**编辑：**在构建之前，您需要安装[Apache Ant](http://ant.apache.org/)构建工具。由于它是一个 Java 应用程序，因此只需从他们的[下载页面](http://ant.apache.org/bindownload.cgi)下载二进制分发包并解压缩即可。

# google-bigquery - bq 命令行工具用 --format=none 暂时挂起吃内存

> ID：11974956
> 
> 赞同：0
> 
> 时间：2012-08-15T18:28:35.843
> 
> 标签：google-bigquery

我正在使用 bq 运行 BigQuery 查询，该查询从一个表中选择行的子集到目标表中。

我们的命令看起来像：

```
bq --format=none query --destination_table=dpm_legacy.unique_test [query] 
```

在命令行我得到：

```
Waiting on job_cda83335e0a4416ea9d4a2a0262d1ec7 ... (0s) Current status: RUNNING
Waiting on job_cda83335e0a4416ea9d4a2a0262d1ec7 ... (10s) Current status: DONE 
```

但是随后该进程会挂起一段时间，并且它的 CPU 和内存使用率开始攀升，直到它最终存在而没有输出。

从经验上看，工具挂起的时间似乎与目标表的大小成正比，所以即使使用 --format=none 标志，它仍有可能返回数据吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T19:44:39.303

bq 确实会尝试在回复时读取整个表格，即使格式设置为无。防止这种情况的一种方法是使用 --nosync 它将立即退出而不等待查询完成。我正在添加一个 --max_rows 标志，该标志将允许您指定结果中所需的行数（因此，如果您不需要任何行，则只需指定 0）。

# javascript - JavaScript 关闭 onclick

> ID：11974959
> 
> 赞同：1
> 
> 时间：2012-08-15T18:28:45.267
> 
> 标签：javascript

我看到了很多例子并试图效仿，但没有一个能奏效。所以我终于把它们贴在这里了。我无法理解我做错了什么。

有一个常见问题解答列表，其中包含答案的显示/隐藏功能。

这是我没有应用闭包的代码（这当然只针对最后一个问题）

```
for(var i = 1; i <= faqCount; i++) {
    question = '#' + i + ' .faq_question';
    answer = '#' + i + ' .faq_answer';
    $(question).click(function () {
        $(answer).toggle();
        $(question).toggleClass('down');
    });
} 
```

但是查看其他示例，我尝试这样做但没有奏效：

```
var funcs = [];
function createfunc(i) {
    return function() {
        question = '#' + i + ' .faq_question';
        answer = '#' + i + ' .faq_answer';
        $(question).click(function () {
            $(answer).toggle();
            $(question).toggleClass('down');
        }); 
    };
}   
for (var i = 0; i < faqCount; i++) {
    funcs[i] = createfunc(i);
}
for (var j = 1; j < faqCount; j++) {
    funcs[j]();                        
} 
```

任何帮助，将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T18:31:34.477

有几种方法可以使用闭包来解决这个问题。我发现这种使用自执行函数的方法最容易记住如何做。只有答案字符串必须在闭包中，因为问题会立即执行，然后您可以`$(this)`在事件处理程序中使用。这是一个使用自执行函数的闭包：

```
for(var i = 1; i <= faqCount; i++) {
    (function(a) {
        $('#' + i + ' .faq_question').click(function () {
            $(a).toggle();
            $(this).toggleClass('down');
        });
    })('#' + i + ' .faq_answer');
} 
```

我有时会发现一种非封闭方式使代码更具可读性，将索引存储为问题上的 .data() 项，其工作方式如下：

```
for(var i = 1; i <= faqCount; i++) {
    $('#' + i + ' .faq_question').data("answerIndex", i).click(function () {
        $('#' + $(this).data("answerIndex") + ' .faq_answer').toggle();
        $(this).toggleClass('down');
    });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T18:31:49.453

您需要添加`var`到闭包中`question`和内部。`answer`否则，您每次都只是覆盖全局变量。

```
var funcs = [];
function createfunc(i) {
    return function() {
        var question = '#' + i + ' .faq_question';
        var answer = '#' + i + ' .faq_answer';
        $(question).click(function () {
            $(answer).toggle();
            $(question).toggleClass('down');
        }); 
    };
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T18:35:53.163

第一个示例的问题是当事件触发时 i 具有循环中的最后一个值。

第二个与我认为没有 var 的全局变量有关。

我会使用这样的闭包来解决它：-

这使用循环中 i 的当前值调用一个函数，并用闭包封装它。

```
for(var i = 1; i <= faqCount; i++) {
  $(question).click((function(question, answer) {
    return function() {
      $(answer).toggle();
      $(question).toggleClass('down');
    }
  })('#' + i + ' .faq_question', '#' + i + ' .faq_answer' ))
} 
```

我建议查看[http://ejohn.org/apps/learn/](http://ejohn.org/apps/learn/)这是很棒的学习材料！其中一个例子就是这个问题。

# java - Java：2D int 数组的固定大小数组

> ID：11974964
> 
> 赞同：3
> 
> 时间：2012-08-15T18:29:17.123
> 
> 标签：java, performance, multidimensional-array

是否可以创建一个二维 int 数组，例如：

```
int n = 100;
int[][] [] a = new int[][] [n]; 
```

数组具有固定长度`n`，矩阵（2D 数组）具有不同的非零大小（至少`1 x 1`）。

为了性能，我想将其存储在堆栈中，而不是：

```
ArrayList<int[][]> a = new ArrayList<int[][]>(n); 
```

据我所知，它将存储在堆上。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T18:36:24.177

创建 3D 阵列

```
int n = 100;
int[][][] a = new int[n][][]; 
```

这将创建 100 个任意维度的数组。

这几乎和（低）效率一样

```
List<int[][]> a = new ArrayList<int[][]>(n); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T18:40:12.787

> 是否可以创建一个二维 int 数组，例如：
> 
> ```
> int n = 100;
> int[][] [] a = new int[][] [n]; 
> ```

--> 这对语法无效，你会得到编译器错误。利用 ：

```
int n = 100;
int[][] [] a = new int[n][] []; 
```

但是`a`是一个对象，因为java中的数组是对象，因此`a`将存储在堆上而不是堆栈上。

# linux - 使用 AWK 的多个字段分隔符

> ID：11974968
> 
> 赞同：0
> 
> 时间：2012-08-15T18:29:49.123
> 
> 标签：linux, awk, grep

我试图分离 ifconfig 并给我输出当前的 IP、广播和网络掩码。我遇到的问题是输出在空格和冒号中。我一定错过了什么，因为我似乎无法绕过这部分。我的 OFS 声明似乎不起作用。

```
ifconfig eth0 | grep "inet addr" | awk -F ':' 'BEGIN{OFS=" ";}{print $2}' 
```

输出这个：

```
127.0.0.1  Bcast 
```

以上是本机的IP。我真的只是想让它输出

```
127.0.0.1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:39:37.793

一些简单的解决方案：

```
ifconfig eth0 | tr : \  | awk '/inet addr/{ print $3 }' 
```

和

```
ifconfig eth0 | tr -s \  | awk '/inet addr/{print $4 }' FS=':| ' 
```

还：

```
ifconfig eth0 | awk '/inet addr/{print $13 }' FS=':| ' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T18:41:05.043

如果您知道您将始终拥有一个静态字符串，那么也许只是替换对您有用？

```
ifconfig eth0 | awk '/inet addr/{ sub(/addr:/, "", $2); print $2; }' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T18:41:55.560

您还可以使用 sed：

```
ifconfig eth0 | sed -n '/inet addr/{s/[^:]*:\([^ ]*\).*/\1/p}' 
```

# objective-c - 使用新的 iOS Facebook SDK API (3.0) 上传照片

> ID：11974972
> 
> 赞同：5
> 
> 时间：2012-08-15T18:30:13.977
> 
> 标签：objective-c, ios, facebook, facebook-ios-sdk

如何使用他们的新 API/SDK 从 iOS 应用程序将照片上传到 Facebook？我已经尝试过了，但我没有得到任何地方，只是继续绕圈跑。这是我目前拥有的代码：

```
-(void)dataForFaceboo{
    self.postParams =
    [[NSMutableDictionary alloc] initWithObjectsAndKeys:
     self.uploadPhoto.image, @"picture", nil];
}

-(void)uploadToFacebook{

    [self dataForFacebook];

    NSLog(@"Going to facebook: %@", self.postParams);

    // Hide keyboard if showing when button clicked
    if ([self.photoCaption isFirstResponder]) {
        [self.photoCaption resignFirstResponder];
    }
    // Add user message parameter if user filled it in
    if (![self.photoCaption.text
        isEqualToString:kPlaceholderPostMessage] &&
        ![self.photoCaption.text isEqualToString:@""]) 
    {
        [self.postParams setObject:self.photoCaption.text forKey:@"message"];
    }
    [FBRequestConnection startWithGraphPath:@"me/feed"
        parameters:self.postParams
        HTTPMethod:@"POST"
        completionHandler:^(FBRequestConnection *connection,
                            id result,
                            NSError *error) 
    {
        NSString *alertText;
        if (error) {
            alertText = [NSString stringWithFormat:
                         @"error: domain = %@, code = %d",
                      error.domain, error.code];
        } else {
            alertText = [NSString stringWithFormat:
                         @"Posted action, id: %@",
                         [result objectForKey:@"id"]];
        }
        // Show the result in an alert
        [[[UIAlertView alloc] initWithTitle:@"Result"
                              message:alertText
                              delegate:self
                              cancelButtonTitle:@"OK!"
                              otherButtonTitles:nil] show];
    }];
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-16T12:23:03.903

您的代码很好，需要进行一些细微的更改：

`NSData`以格式将图像添加到字典中，例如

```
[params setObject:UIImagePNGRepresentation(_image) forKey:@"picture"]; 
```

并将图形路径更改为`"me/photos"`而不是`"me/feed"`

进行这些更改，它对我有用。请记住，您需要使用**“publish_actions”**权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T19:34:37.593

“我/照片”是指照片实际上位于您 Facebook 个人资料的“照片”列表中。“我/饲料”只是时间线上的一个帖子。

# android - 在phonegap android应用程序中是否可以将文件下载到特定文件夹

> ID：11974974
> 
> 赞同：0
> 
> 时间：2012-08-15T18:30:18.413
> 
> 标签：android, pdf, cordova, download

用户是否有可能从网站下载文件并将其放入应用程序根目录。我让用户从网站下载一个 pdf 文件，它应该直接进入特定文件夹，以便应用程序可以控制下载的文件而不会分散。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:34:27.393

不，应用程序根目录不可写。你应该把它放进去

/data/data/{包名}

这是您的应用程序的私有存储目录​​或

/sdcard/Android/data/{包名}/files

这是您的应用程序的公共存储目录。

# php - 以 (PHP) 形式使用的 JQuery

> ID：11974978
> 
> 赞同：0
> 
> 时间：2012-08-15T18:30:48.267
> 
> 标签：php, javascript, jquery

我一直在构建一个页面，该页面的管理员可以查看已提交的一些摘要。我使用 jquery 插入了一个模态表单，他们可以在其中对摘要进行分类以适应五个选择之一（四个会话，一个不适用）。但是，我被困在脚本中的函数上。

我想要它做的是转到 .php 页面，在那里我将编写适当的代码来更新数据库中的记录，然后将管理员送回主页，如果他们愿意，继续对摘要进行分类。

我有表格：

```
<div id="dialog-form" title="Categorize this abstract">

    <p class="validateTips">Please select one session for this abstract.</p>

     <form method="post" action="savecat.php">
     <fieldset>

          <label><input type="radio" name="abstractcategory" value="session1" />Session 1</label>
          <label><input type="radio" name="abstractcategory" value="session2" />Session 2</label>
          <label><input type="radio" name="abstractcategory" value="session3" />Session 3</label>
          <label><input type="radio" name="abstractcategory" value="session4" />Session 4</label>
          <label><input type="radio" name="abstractcategory" value="NULL" />Irrelevant</label>

        </fieldset>
  </form>
 </div> 
```

在脚本中，我有分类按钮：

```
 $( "#categorize" )
        .button()
        .click(function() {
            $( "#dialog-form" ).dialog( "open" );
        }); 
```

这就是我不知道该怎么做的地方，在 dialog-form 函数中：

```
 $( "#dialog-form" ).dialog({
      autoOpen: false,
          height: 300,
      width: 350,
      modal: true,
      buttons: {
       "Categorize this abstract": function() { 
```

我应该在这里放什么？我不知道。我希望它重新定向（？）到作为表单操作的 savecat.php。

然后是其余的，取消，关闭等。

```
$( this ).dialog( "close" );
}
  },
Cancel: function() {
$( this ).dialog( "close" );
}
},
close: function() {
  allFields.val( "" ).removeClass( "ui-state-error" );
  }
 }); 
```

谁能指出我正确的方向？我有一种感觉，这是一件我不知道的简单事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:39:23.970

我猜你只是想提交表格？

```
$(this).find('form').submit(); 
```

# encryption - 椭圆曲线密码学可以用作分组密码吗？

> ID：11974981
> 
> 赞同：2
> 
> 时间：2012-08-15T18:31:02.080
> 
> 标签：encryption, embedded, elliptic-curve

我正在尝试使用非对称加密来加密固件。引导加载程序将解密并更新闪存。这是在具有 32 位 CPU 以 60MHz 执行的嵌入式设备上。

我想使用 ECC，因为它具有多种优势。我是加密新手，我对 ECIES 中实现的 ECC 的理解是使用 ECC 生成密钥并使用 AES 进行实际数据加密。由于代码和内存大小，我不能支持多种加密算法。

是否有可以像 AES 一样使用的 ECC 实现。我所寻找的只是使用“私钥”来加密固件，而引导加载程序使用“公钥”来解密它。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T06:52:57.610

让我们从问题的最后一句话开始：

> 我所寻找的只是使用“私钥”来加密固件，而引导加载程序使用“公钥”来解密它。

这里的术语有些混乱。私钥用于解密（或签名），公钥用于加密（或验证）。如果我理解正确，您想要的是引导加载程序验证固件上的签名，以便引导加载程序只接受您自己正确签名的固件。

有多种非对称签名方案可用于此目的，包括一些基于椭圆曲线密码学的签名方案。例如，您可以使用 ECDSA 的 OpenSSL 实现（参见[http://www.openssl.org/docs/crypto/ecdsa.html](http://www.openssl.org/docs/crypto/ecdsa.html)）。

恐怕问题中没有足够的信息来正确选择最佳签名方案（如果需要对固件保密，也可能是加密方案）。在任何情况下，良好的密码学都不足以使系统安全，其他考虑因素（如安全实施）同样重要。

如果这对您来说很重要，并且您担心黑客可能会尝试破解，我强烈建议您购买安全专业人员的服务。正确使用密码学是一项非常棘手的工作，需要对系统有充分的了解——否则你可能会遇到这样的[情况](http://www.securecoding.cert.org/confluence/download/attachments/2426/kurios119.jpg)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T13:41:56.587

如果您寻找“身份验证”，您必须使用像 EC 这样的非对称算法，这通常是因为如果用户或进程想要更新“固件”，他应该通过他的“签名”向引导加载程序标识他自己，以检查谁请求这个更新。

完成后，引导加载程序将从安全存储器加载对称密钥以解密您想要执行的操作。

因此，您有一个用于加密 (AES) 的对称密钥和两个用于身份验证的非对称密钥（=您是谁？）。

注意：EC 在 32 位 CPU 上以 60MHz 执行加密没有优势，除非您的应用程序需要非对称加密而不是身份验证，这是由于用户和引导加载程序之间的线路不安全而发生的。

因此，您可以使用引导加载程序的“公钥”对固件进行加密，引导加载程序使用其“私钥”对其进行解密，但是由于非对称算法的高计算量，实现成本很高。

寻找“轻量级密码学”，这对于您的应用程序来说是典型的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-15T19:20:56.003

我不确定您是否完全了解 ECIES 的组成部分：

[http://en.wikipedia.org/wiki/Integrated_Encryption_Scheme](http://en.wikipedia.org/wiki/Integrated_Encryption_Scheme)

这是一项相当多的工作，在我看来，它需要大量的原语，包括至少一个对称原语。那也可能是AES。

# c# - 在 C# 的 CMD 窗口中生成命令提示符应用程序

> ID：11974983
> 
> 赞同：0
> 
> 时间：2012-08-15T18:31:12.767
> 
> 标签：c#

我需要运行一个使用 Process 类从 cmd 窗口运行的旧版应用程序。

```
ProcessStartInfo startInfo = new ProcessStartInfo();
startInfo.FileName = "cmd.exe";
startInfo.Arguments = "/C \"C:\\MySys\\My2Com.exe –r " + Parameters.FullPath;
startInfo.CreateNoWindow = true;
startInfo.UseShellExecute = false;

try
{
    // Start the process with the info we specified.
    // Call WaitForExit and then the using statement will close.
    using (Process exeProcess = Process.Start(startInfo))
    {
        exeProcess.WaitForExit();
    }
}
catch (Exception e)
{
    string sMsg = "Error copying the files to " + Parameters.FullPath + ".";
    HandleErrorMsg(e, sMsg);
    return;
} 
```

My2Com.exe 进程应该在后台运行，但是，我始终收到一条消息，即在从具有不同标志的 cmd 行运行时使用的文件丢失。如果我按照 cmd 窗口中的指示运行命令 C:\MySys\My2Com.exe –r FullyQualPath，它会按预期工作。我尝试了几种不同的方法来设置 Process 类，但均未成功。

任何建议，将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:36:12.600

试试这个——

```
startInfo.Arguments = "/C \"C:\\MySys\\My2Com.exe –r\" " + Parameters.FullPath; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T18:40:04.953

如果您执行以下操作，这将起作用

```
startInfo.Arguments = @"/C "C:\MySys\My2Com.exe /r" " + Parameters.FullPath +"\""; 
```

请记住，如果文件路径中有空格，则需要将 """ 括起来，例如，如果文件路径是这样的 @"""C:\Wolf Lair\WorkDeskTemp\"

**注意 @ 和 """**

您需要将结束引号附加到字符串 +"\""; 在 Parameters.FullPath; 之后

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T18:41:27.823

你知道为什么它不起作用，因为

*   您还没有完成报价

尝试这个：-

```
startInfo.Arguments = "/C \"C:\\MySys\\My2Com.exe\" –r \"" + Parameters.FullPath+"\""; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T18:51:38.960

```
startInfo.Arguments = @"/C ""C:\MySys\My2Com.exe –r """ + Parameters.FullPath + "\""; 
```

Also, see [Sending commands to cmd prompt in C#](https://stackoverflow.com/questions/11767654/sending-commands-to-cmd-prompt-in-c-sharp/11768260#11768260). I'd recommended using some of the code from my answer there so that you can intercept the standard output and standard error to see what you're getting.

# python - 按谓词拆分列表

> ID：11974985
> 
> 赞同：7
> 
> 时间：2012-08-15T18:31:21.380
> 
> 标签：python

有没有更简洁的方法通过谓词将列表分成两个列表？

```
errors, okays = [], []
for r in results:
    if success_condition(r):
        okays.append(r)
    else:
        errors.append(r) 
```

我知道这可以变成一个丑陋的单线使用`reduce`; 这不是我要找的。

*更新：*每个元素只计算`success_condition`一次是可取的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T18:37:16.237

也许

```
for r in results:
    (okays if success_condition(r) else errors).append(r) 
```

但这看起来/感觉不是很 Pythonic。

* * *

不直接相关，但如果要寻找效率，缓存方法查找会更好：

```
okays_append = okays.append
errors_append = errors.append

for r in results:
    (okays_append if success_condition(r) else errors_append)(r) 
```

这更不像 Pythonic。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-15T18:33:35.987

怎么样

```
errors = [ r for r in results if not success_condition(r)]
okays = [ r for r in results if success_condition(r)] 
```

或者

```
bools = [ success_condition(r) for r in results ] 
```

如果success_condition是一个昂贵的电话，然后替换上面（通过`zip`或）。`enumerate`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-15T19:38:54.210

```
errors, okays = [], []
for r in results:
    (errors, okays)[success_condition(r)].append(r) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-15T18:43:03.427

使用具有副作用的生成器表达式或列表推导。（只是为了使其看起来简洁）：

```
>>> errors, okays = [], []
>>> [okays.append(r) if success_condition(r) else errors.append(r)  for r in results] 
```

使用生成器表达式：

```
>>> errors, okays = [], []
>>> list(okays.append(r) if success_condition(r) else errors.append(r)  for r in results) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-15T18:36:19.667

`filter`功能呢？

```
okays = filter(success_condition, results)
errors = filter(lambda (x): not success_condition(x), results) 
```

# forms - 从表单输入输入 iFrame 源

> ID：11974990
> 
> 赞同：0
> 
> 时间：2012-08-15T18:31:42.627
> 
> 标签：forms, iframe

我希望我的 iFrame 窗口显示我从表单文本框中输入的 URL，为此我希望将 iframe src="" 更改为表单字段输入。我怎样才能做到这一点？这是我打算使用的示例代码。

```
<html>
<head>
<title>Blah.</title>
<link href="style.css"rel="stylesheet" type="text/css" />
</head>
<body>
<form>
Enter URL: <input type="text" />
<input type="submit" value="GO" />
</form>
<iframe src="" frameborder="0" marginwidth="0" scrolling="yes"></iframe>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T18:50:43.943

尝试这个。

```
<html>
<head>
    <title>Blah.</title>
    <link href="style.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript">
        function SetSrc()
        {
            document.getElementById("myIfreme").src = document.getElementById("txtSRC").value;
        }
    </script>
</head>
<body>
    <form>
    Enter URL:
    <input type="text" id="txtSRC" />
    <input type="button" value="GO" onclick="SetSrc()" />
    </form>
    <iframe id="myIfreme" src="" frameborder="0" marginwidth="0" scrolling="yes"></iframe>
</body>
</html> 
```

# perl - 给定日期，以 mm/dd/yyyy 为单位查找一年中的星期

> ID：11974992
> 
> 赞同：7
> 
> 时间：2012-08-15T18:31:56.657
> 
> 标签：perl, date, time, dayofweek

我试图找到某个日期所在的星期，在某一年。我有一堆文件需要分类到“week1-2012”和“week34-2011”等文件夹中。我尝试搜索，但很多结果并没有真正帮助，因为我目前使用的是 perl v5.6.1，超级旧，我无法下载任何模块。我还发现了这个链接（[如何计算给定日期的周数？](https://stackoverflow.com/questions/274861/how-do-i-calculate-the-week-number-given-a-date)），但我想知道如何轻松获得一年中的某一天和一周。正在考虑获取月份，并添加适当的天数以找出一年中的哪一天。任何帮助，将不胜感激。我正在寻找的年份格式的一个例子是

```
//year 2012
S  M  T  W  R  F  S
            1  2  3    <-- week #1 
4  5  6  7  8  9 10    <-- week #2 //came from the link

//dec year 2011
S   M  T  W  T  F  S
27 28 29 31            <-- week #52 or 53, not to sure the actual week 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-15T18:53:33.210

您可以使用核心模块：`POSIX`和`Time::Local`

1.将您的日期解析为 (sec, min, hour, mday, month, year)

2.将您的日期转换为秒（纪元）

3.使用函数strftime从当前日期获取星期

```
use strict;
use Time::Local;
use POSIX qw(strftime);

my $date = '08/15/2012';
my ($month, $day, $year) = split '/', $date;

my $epoch = timelocal( 0, 0, 0, $day, $month - 1, $year - 1900 );
my $week  = strftime( "%U", localtime( $epoch ) );

printf "Date: %s № Week: %s\n", $date, $week; 
```

**输出**

```
Date: 08/15/2012 № Week: 33 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-16T09:32:39.950

Perl 5.6.1 可以追溯到 2001 年 4 月。有人不给你现代工具来使用，让你的生活变得比它需要的更艰难。我建议花一些时间解决这个问题是值得的。

如果您有 Perl 5.10 或更高版本，那么它将包括[Time::Piece](http://perldoc.perl.org/perlunicode.html)模块。你的问题将变得微不足道。

```
#!/usr/bin/perl

use strict;
use warnings;
use 5.010;

use Time::Piece;

my $date = '08/15/2012';

my $dt = Time::Piece->strptime($date, '%m/%d/%Y');

say $dt->strftime('week%W-%Y'); 
```

运行它给出：

```
$ ./week 
week33-2012 
```

这将一周视为周一至周日，而不是周日至周六。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-15T18:57:47.530

这是一个替代解决方案，使用[`DateTime`](https://metacpan.org/module/DateTime)：

```
use strict;
use warnings;
use DateTime;

my $dt=DateTime->now(time_zone=>"local");
print $dt->week_number . "\n"; 
```

输出当然是：

```
33 
```

**编辑：** [当然](https://metacpan.org/module/App%3a%3aperlbrew) [你可以下载模块！](https://metacpan.org/module/local%3a%3alib)如果不出意外，您可以从`DateTime`.

# java - SNMP 代理和 SNMP 适配器有什么区别

> ID：11974994
> 
> 赞同：1
> 
> 时间：2012-08-15T18:32:08.447
> 
> 标签：java, jboss, snmp, mib

我正在寻找在 Java 中使用 SNMP 为项目设置监控。我一直在环顾四周，发现了一些软件包：**JBossSNMPAdapter**和**SNMP4J-Agent**。我不确定这两者之间有什么区别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:50:49.870

SNMP4j-Agent 本身不支持 JMX，它只帮助实现工作的通用 SNMP 部分。有一个 SNMP4j-Agent-JMX 包，但它不是免费的。这对您来说可能是最重要的区别。

# c# - DataGridView CurrentRow Cell Value=null 但它没有

> ID：11974995
> 
> 赞同：0
> 
> 时间：2012-08-15T18:32:08.447
> 
> 标签：c#, datagridview

我对这段代码有疑问：

```
cell_0_value= dgv.CurrentRow.Cells[0].Value.ToString(); 
```

它在 dgv.CurrentRow.Cells[0].Value 处显示为空，但我的表有 6 列并且它已经具有值。

我该如何克服它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T19:11:34.343

Since you are using `CurrentRow` you must have a cell selected first. Otherwise, `CurrentRow` returns null.

[http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.currentrow(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.currentrow(v=vs.90).aspx)

# c# - .Net/C# 是否有工具来捕获类之间的*运行时*依赖关系？

> ID：11974999
> 
> 赞同：8
> 
> 时间：2012-08-15T18:32:19.760
> 
> 标签：c#, code-analysis, static-analysis, dynamic-analysis

我可以为 .Net/C# 项目使用什么工具来捕获类之间的运行时依赖关系？我发现[这个](https://stackoverflow.com/q/38635/226895)问题非常有用，但建议的工具会捕获静态依赖图。我只是想看看类的实例化图。

我正在使用 VS 2008（但如果需要可以安装其他版本）。

UPD：我的目标是这个。我有巨大的旧代码库。它有（例如）500 个类，但是因为 DB 驱动的工作流多年来发生了变化，现在只（例如）使用了 100 个类。这就是为什么静态依赖分析将难以消化的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T03:34:35.537

CLRProfiler 可以捕获/显示 CallGraph：[http](http://www.scribd.com/doc/3376247/CLRProfiler) ://www.scribd.com/doc/3376247/CLRProfiler 。

文件格式已记录在案，因此您可以添加自己的 analisys。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T23:08:11.357

[ANTS](http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/features/key-features)让您可视化调用图。不完全是您正在寻找的东西，但它可能会有所帮助。他们有 14 天的试用期，如果您决定购买它，那么对您的 .NET 应用程序进行性能分析是非常值得的。

[.NET Memory Profiler](http://memprofiler.com/)还允许您查看实例图。比 ANTS 少花钱，可能会做你需要做的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-25T00:43:54.820

不是调用图而是调用列表，但 VS 中的 IntelliTrace 可以告诉您调用历史记录。如果您过滤对构造函数的调用，您可能可以获得大部分的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-16T07:23:12.513

[Doxygen](http://www.doxygen.org)是一个免费工具，它还可以生成调用图以及一些基本文档。