# StackOverflow 问答 000525000-000525999

# xml - 从 XML 中解析带有 & 的 URL

> ID：525001
> 
> 赞同：0
> 
> 时间：2009-02-08T02:09:19.673
> 
> 标签：xml, cocoa-touch

我正在尝试使用 URL 解析`&amp;`URL：

```
ViewArticle.dbml?DB_OEM_ID=1800&amp;ATCLID=3664162 
```

..但是使用 NSXMLParser，我得到的只是`1800ATCL`. 它完全忽略了`&amp;`.

```
- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict
{
    if (qName) {
        elementName = qName;
    }

    if ([elementName isEqualToString:@"title"]) {
        self.contentOfCurrentNewsProperty = [NSMutableString string];
    }else if ([elementName isEqualToString:@"link"]){
        self.contentOfCurrentNewsProperty = [NSMutableString string];
    }else {
        self.contentOfCurrentNewsProperty = nil;
    }
}

- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName
{     
    if (qName) {
        elementName = qName;
    }

    _currentElement = elementName;

    if ([elementName isEqualToString:@"title"]) {
        self.currentNewsObject.title = self.contentOfCurrentNewsProperty;
    } else if ([elementName isEqualToString:@"link"]){
        self.currentNewsObject.link = self.contentOfCurrentNewsProperty;
    }
}

- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string
{
    if (self.contentOfCurrentNewsProperty) {
        [self.contentOfCurrentNewsProperty appendString:string];
    }
} 
```

有任何想法吗？谢谢

**编辑：**我做了更多的测试，这行`<?xml version="1.0" encoding="windows-1252"?>` 是什么搞砸了，但这嵌入在 xml 文件中，有什么办法可以绕过它？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-08T16:57:02.143

感谢你们的帮助，我能够使用它

```
 NSData *myData = [NSData dataWithContentsOfURL:URL];
    NSString *myStr = [[NSString alloc] initWithData:myData encoding:NSWindowsCP1252StringEncoding];
    myStr = [myStr stringByReplacingOccurrencesOfString:@"encoding=\"windows-1252\"" withString:@""];
NSLog(@"my str is %@", myStr);

NSData* aData = [myStr dataUsingEncoding:NSUTF8StringEncoding];

NSXMLParser *parser = [[NSXMLParser alloc] initWithData:aData]; 
```

现在一切正常，再次感谢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T13:33:23.023

（dbr：原发帖人使用的是NSXMLParser，而不是NSXMLDocument，所以`setCharacterEncoding`他没有办法覆盖。）

致 OP：为了测试您的情况，我编写了一个简单的命令行实用程序，它使用 NSXMLParser 来解析带有`<?xml version="1.0" encoding="windows-1252"?>`处理指令的 XML 文档。解析总是失败，错误码是31，对应枚举`NSXMLParserUnknownEncodingError`。

要解决此问题，您可能必须对输入数据进行预处理。这样做的一种方法可能是使用`[NSString stringWithCString:yourCstring encoding:NSWindowsCP1252StringEncoding]`，其中是包含您的 XML`yourCstring`的标准 C。`char*`然后，您可以删除`<?xml version="1.0" encoding="windows-1252"?>`处理指令，将 NSString 转换为 NSData，并将其传递给 NSXMLParser。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T09:24:51.527

也许您可以使用覆盖编码[`setCharacterEncoding`](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSXMLDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSXMLDocument/setCharacterEncoding:)

> 设置字符编码：
> 
> 将接收方的字符编码设置为encoding，
> 
> `- (void)setCharacterEncoding:(NSString *)encoding`
> 
> 参数：
> 
> *   编码
>     
>     
>     
>     一个指定编码的字符串；它必须与 IANA 字符集的名称匹配。有关有效编码说明符的列表，请参见[http://www.iana.org/assignments/character-sets](http://www.iana.org/assignments/character-sets)。
>     
>     
>     
>     通常，编码在所处理文档的 XML 声明中指定，但可以随时设置。如果指定的编码与实际编码不匹配，则文档解析可能会失败。

# regex - 正则表达式转换为状态机的简短示例？

> ID：525004
> 
> 赞同：22
> 
> 时间：2009-02-08T02:11:15.473
> 
> 标签：regex, state-machine, fsm

在 Stack Overflow 播客 #36 ( [https://blog.stackoverflow.com/2009/01/podcast-36/](https://blog.stackoverflow.com/2009/01/podcast-36/) ) 中，表达了这种观点：一旦您了解设置状态机是多么容易，您就会永远不要再尝试不恰当地使用正则表达式。

我做了一堆搜索。我找到了一些学术论文和其他复杂的例子，但我想找到一个简单的例子来帮助我理解这个过程。我使用了很多正则表达式，并且我想确保我永远不会再“不恰当地”使用一个。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-08T02:36:43.613

当然，尽管您需要更复杂的示例才能真正理解 RE 的工作原理。考虑以下 RE：

```
^[A-Za-z][A-Za-z0-9_]*$ 
```

这是一个典型的标识符（必须以 alpha 开头，并且可以有任意数量的字母数字和取消划线字符，包括没有）。以下伪代码显示了如何使用有限状态机完成此操作：

```
state = FIRSTCHAR
for char in all_chars_in(string):
    if state == FIRSTCHAR:
            if char is not in the set "A-Z" or "a-z":
                error "Invalid first character"
            state = SUBSEQUENTCHARS
            next char
    if state == SUBSEQUENTCHARS:
            if char is not in the set "A-Z" or "a-z" or "0-9" or "_":
                error "Invalid subsequent character"
            state = SUBSEQUENTCHARS
            next char 
```

现在，正如我所说，这是一个非常简单的例子。它没有展示如何进行贪婪/非贪婪匹配、回溯、一行内（而不是整行）匹配以及状态机的其他更深奥的特性，这些特性很容易被 RE 语法处理。

这就是 RE 如此强大的原因。执行单行 RE 可以执行的操作所需的实际有限状态机代码通常非常长且复杂。

您可以做的最好的事情是获取特定简单语言的一些 lex/yacc（或等效）代码的副本，然后查看它生成的代码。它不漂亮（它不一定是因为它不应该被人类阅读，他们应该查看 lex/yacc 代码）但它可能会让你更好地了解它们是如何工作的。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-02-08T03:01:01.723

在任何模式上使用 python 鲜为人知的 re.DEBUG 标志的一种相当方便的方法来帮助查看这一点：

```
>>> re.compile(r'<([A-Z][A-Z0-9]*)\b[^>]*>(.*?)</\1>', re.DEBUG)
literal 60
subpattern 1
  in
    range (65, 90)
  max_repeat 0 65535
    in
      range (65, 90)
      range (48, 57)
at at_boundary
max_repeat 0 65535
  not_literal 62
literal 62
subpattern 2
  min_repeat 0 65535
    any None
literal 60
literal 47
groupref 1
literal 62 
```

'literal' 和 'range' 后面的数字是指它们应该匹配的 ascii 字符的整数值。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-02-08T02:46:18.227

让你自己在飞行中！

[http://osteele.com/tools/reanimator/???](http://osteele.com/tools/reanimator/???)

![有限状态机](https://i622.photobucket.com/albums/tt302/gefafwisp/fsm.png)

这是一个非常好的组合工具，可以将正则表达式可视化为 FSM。它不支持您在现实世界的正则表达式引擎中找到的某些语法，但肯定足以准确理解正在发生的事情。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-08T02:49:36.253

问题是“我如何选择状态和转换条件？”还是“我如何在 Foo 中实现我的抽象状态机？”

## 如何选择状态和转换条件？

我通常将 FSM 用于相当简单的问题并直观地选择它们。在[我对关于正则表达式的另一个问题的回答中](https://stackoverflow.com/questions/328387/regex-to-replace-all-n-in-a-string-but-no-those-inside-code-code-tag/328403#328403)，我只是将解析问题视为其中之一**`Inside`**或**`outside`**标记对，并从那里写出转换（具有开始和结束状态以保持实现干净）。

## 如何在 Foo 中实现我的抽象状态机？

如果您的实现语言支持像`c`'`switch`语句这样的结构，那么您打开当前状态并处理输入以查看接下来执行的操作和/或转换。

如果没有`switch`-like 结构，或者如果它们在某些方面存在缺陷，则可以设置`if`分支样式。*啊。*

在我链接的示例中全部写在一个地方`c`看起来像这样：

```
token_t token;
state_t state=BEGIN_STATE;
do {
   switch ( state.getValue() ) {
   case BEGIN_STATE;
      state=OUT_STATE;
      break;
   case OUT_STATE:
      switch ( token.getValue() ) {
         case CODE_TOKEN:
            state = IN_STATE;
            output(token.string());
            break;
         case NEWLINE_TOKEN;
            output("<break>");
            output(token.string());
            break;
         ...
      }
      break;
   ...
   }
} while (state != END_STATE); 
```

这非常混乱，所以我通常将这些`state`案例撕成单独的功能。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-08T02:18:00.530

我敢肯定有人有更好的例子，但你可以[查看 Phil Haack 的这篇文章](http://haacked.com/archive/2009/01/14/named-formats-redux.aspx)，它有一个正则表达式的例子和一个做同样事情的状态机（之前的一篇文章也有几个正则表达式的例子我认为..）

检查该页面上的“HenriFormatter”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-08T02:43:52.600

我不知道您已经阅读了哪些学术论文，但理解如何实现有限状态机确实并不难。有一些有趣的数学，但想法实际上很容易理解。理解 FSM 最简单的方法是通过输入和输出（实际上，这包含了大部分正式定义，我不会在这里描述）。“状态”本质上只是描述一组已经发生并且可以从某个点发生的输入和输出。

有限状态机通过图表最容易理解。例如：

[替代文字 http://img6.imageshack.us/img6/7571/mathfinitestatemachinedco3.gif](http://img6.imageshack.us/img6/7571/mathfinitestatemachinedco3.gif)

这就是说，如果您从某个状态 q0（旁边带有 Start 符号的状态）开始，您可以转到其他状态。每个状态都是一个圆圈。每个箭头代表一个输入或输出（取决于您如何看待它）。考虑有限状态机的另一种方法是根据“有效”或“可接受”输入。某些输出字符串不可能是某些有限状态机；这将允许您“匹配”表达式。

现在假设您从 q0 开始。现在，如果您输入 0，您将进入状态 q1。但是，如果您输入 1，您将进入状态 q2。您可以通过输入/输出箭头上方的符号看到这一点。

假设您从 q0 开始并获得此输入

0, 1, 0, 1, 1, 1

这意味着你已经经历了状态（没有输入 q0，你只是从那里开始）：

q0 -> q1 -> q0 -> q1 -> q0 -> q2 -> q3 -> q3

如果没有意义，请用手指跟踪图片。请注意，对于输入 0 和 1，q3 会返回到自身。

另一种说法是“如果您处于状态 q0 并且您看到 0 转到 q1，但如果您看到 1 转到 q2。” 如果您为每个状态都设置了这些条件，那么您几乎完成了对状态机的定义。您所要做的就是拥有一个状态变量，然后是一种输入输入的方法，基本上就是这样。

好的，那么为什么这对于乔尔的声明很重要？好吧，建立“一个真正的正则表达式来统治他们所有人”可能非常困难，也很难维护修改，甚至很难让其他人回来理解。此外，在某些情况下它更有效。

当然，状态机还有许多其他用途。希望这在一些小方面有所帮助。请注意，我没有费心深入理论，但有一些关于 FSM 的有趣证明。

# vb.net - 当我使用 DirectoryServices“成员”属性时，“域用户”组为空

> ID：525021
> 
> 赞同：9
> 
> 时间：2009-02-08T02:30:54.013
> 
> 标签：vb.net, active-directory, directoryservices

我正在使用以下代码来获取我域中组的成员：

```
 Dim de As New DirectoryEntry("LDAP://" & GroupDN)

  For Each user As String In CType(de.Properties("member"), IEnumerable)

          GroupCollection.Add(Username, Username)

  Next 
```

我的问题是，当 GroupDN（组的专有名称）是“ **CN=Domain Users,CN=Users,DC=Mydomain,DC=local** ”时，For...Each 循环不执行，当我检查手动属性语句，它的计数为零。这似乎适用于我域中的所有其他组，但“域用户”组应该包含所有人，并且似乎不包含任何人。

我已经检查过了，该组在我的 Windows AD 工具中正确列出了每个人。我在这里有什么明显的遗漏吗？附带说明一下，是否有更好的方法来获取组的所有成员？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-08T04:02:06.857

除非您更改用户的主要组 id，否则用户不会存储在域用户组的成员属性中，而是使用主要组 id 设置为域用户 RID 的事实来确定域用户中的成员身份。正常情况是Domain Users成员属性为空；它需要您对默认的 Active Directory 实现进行一些更改才能避免这种情况。

> Domain Users 组使用基于用户“主要组 ID”的“计算”机制来确定成员资格，并且通常不将成员存储为多值链接属性。如果用户的主要组发生更改，则他们在 Domain Users 组中的成员资格将写入该组的链接属性并且不再计算。这对于 Windows 2000 是正确的，对于 Windows Server 2003 并没有改变。

[参考](http://support.microsoft.com/kb/322692)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-25T17:26:37.763

公认的[答案](https://stackoverflow.com/q/525021/1574221)是绝对正确的。默认情况下，每个（用户）对象都`513`在属性[primarygroupid](https://docs.microsoft.com/en-us/windows/win32/adschema/a-primarygroupid)中设置，这是[域用户 sid](https://docs.microsoft.com/en-us/troubleshoot/windows-server/identity/security-identifiers-in-windows)的固定“尾部” 。但是：这可以更改，并且可以在那里配置所有其他组，所以我们不能依赖它。

这是一个如何获取`group members`无论如何的示例方法（不管默认值是保留还是更改）。**在对活动目录组的成员进行任何查询后，**我都会调用这样的方法。在此示例中，我得到了一个可分辨名称数组作为结果。但是所有其他属性都是可能的，只需将它们添加到`dSearcher.PropertiesToLoad.Add(...)`并修改结果即可。

我知道，这是一个关于 VB 的问题，我希望它易于移植。

```
 using System.DirectoryServices;
    using System.Security.Principal;

    public static string[] GetMembersDnByPrimaryGroupId(string domainName, SecurityIdentifier sidOfGroupToGetMembersByPrimaryGroupId)
    {
        // In a single domain environement the domain name is probably not needed, but
        // we expect a multy domain environement
        if (string.IsNullOrWhiteSpace(domainName) || sidOfGroupToGetMembersByPrimaryGroupId == null)
        {
            throw new ArgumentNullException($"Neither domainName nor sid may be null / blank: DomainName: { domainName }; sid: { sidOfGroupToGetMembersByPrimaryGroupId }");
            //<----------
        }

        List<string> membersDnResult = new List<string>();
        // Get the last segment of the group sid, this is what is stored in the "primaryGroupId"
        string groupSidTail = sidOfGroupToGetMembersByPrimaryGroupId.Value.Split('-').Last();
        string path = $"LDAP://{ domainName }";
        DirectoryEntry dEntry = new DirectoryEntry(path);

        SearchResultCollection adSearchResult = null;
        DirectorySearcher dSearcher = new DirectorySearcher(dEntry);

        // For this example we need just the distinguished name but you can add
        // here the property / properties you want
        dSearcher.PropertiesToLoad.Add("distinguishedName");

        // set the filter to primarygroupid
        dSearcher.Filter = $"(&(primarygroupid={ groupSidTail }))";

        // May die thousand deaths, therefore exception handling is needed. 
        // My exception handling is outside of this method, you may want
        // to add it here
        adSearchResult = dSearcher.FindAll();

        // Get the domains sid and check if the domain part of the wanted sid
        // fits the domain sid (necesarry in multy domain environments)
        byte[] domainSidBytes = (byte[])dEntry.Properties["objectSid"].Value;
        SecurityIdentifier domainSid = new SecurityIdentifier(domainSidBytes, 0);
        if (sidOfGroupToGetMembersByPrimaryGroupId.AccountDomainSid != domainSid)
        {
            throw new ArgumentException($"Domain sid of the wanted group { sidOfGroupToGetMembersByPrimaryGroupId.AccountDomainSid } does not fit the sid { domainSid } of the searched through domain \"{ domainName }\"");
            //<----------
        }

        // We found entries by the primarygroupid
        if (adSearchResult.Count > 0)
        {
            foreach (SearchResult forMemberByPrimaryGroupId in adSearchResult)
            {
                // Every AD object has a distinguishedName, therefore we acess "[0]" 
                // wihtout any further checking
                string dn = forMemberByPrimaryGroupId.Properties["distinguishedName"][0].ToString();
                membersDnResult.Add(dn);
            }
        }

        return membersDnResult.ToArray();
    } 
```

# .net - 为更新的 WinForms 应用程序创建安装程序

> ID：525022
> 
> 赞同：0
> 
> 时间：2009-02-08T02:32:01.470
> 
> 标签：.net, winforms, installation, patch

我发布了一个应用程序，并实现了用户请求的功能，并希望发布一个新版本。我不确定这通常是如何完成的 - .NET 安装项目中是否有一些设置可以用来告诉它在应用程序已安装的情况下仅覆盖某些文件，或者我是否必须以某种方式生成补丁？

如果您要建议自动更新，我同意这是个好主意，但原始版本只是检查应用程序网站以查看是否有新版本，并将用户引导至下载页面以获取更新版本- 它不会为您下载和自动更新。即使我将它添加到这个版本中，我仍然需要一种友好的方式来向我现有的用户提供更新。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-08T02:55:23.060

我假设您的意思是 Windows Installer 中使用户在安装“新版本”之前卸载“当前版本”的功能？

在 Installer Project 属性中，查看“ProductCode”和“UpgradeCode”的属性。这些是定义安装程序如何查找以前版本的指南。

为了简单地为用户提供安装程序以安装更新版本，增加“版本”属性/编号，安装程序应更新文件系统上的文件，而不在开始菜单、添加/删除程序等中创建重复条目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T08:49:59.213

ClickOnce 发布模型适用于小型应用程序。在您的项目中，只需右键单击它转到属性，然后单击“发布”选项卡。

# iis - IIS 电子邮件被防病毒阻止

> ID：525026
> 
> 赞同：0
> 
> 时间：2009-02-08T02:34:33.430
> 
> 标签：iis

我在使用我们的 Intranet 的 Web 服务器时遇到了问题。它上面有一些防病毒软件，可以阻止大量电子邮件。

所以我写了一个快速的 C# winforms 应用程序，在服务器上运行它以尝试发送电子邮件，但它失败了。它被服务器上的防病毒软件阻止，我将 exe 添加到允许列表中，它工作正常。我尝试添加服务`inetinfo.exe`，这是我能看到的唯一与 IIS 相关的服务，它似乎没有启用电子邮件。

asp.net 代码会以不同的 exe 名称发送电子邮件吗？我看到了对`aspnet_wp.exe`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T06:56:05.897

ASP.NET 在 Windows Server 2003 上运行在“w3wp.exe”下，在 Windows 2000 下运行在“aspnet_wp.exe”下。因此，您需要为这些进程打开扫描仪。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T02:50:56.673

您是否将端口 25 或任何 smtp 服务器正在使用的端口添加到允许列表中？

# css - 图像中的 CSS 不透明度

> ID：525027
> 
> 赞同：3
> 
> 时间：2009-02-08T02:35:19.170
> 
> 标签：css, image, transparency

使内盒透明的最佳方法是什么（如果有的话），这样可以看到没有不透明的图像（清晰的图像），而外盒的其余部分不透明。到目前为止，这就是我正在做的事情：

```
<style>
#a {
  background-color: black;
  float: left;
} #b {
    opacity : 0.4;
    filter: alpha(opacity=40); 
} #div {
    position: absolute;
    height: 30px;
    width: 30px;
    top: 90px;
    left: 90px;
    border: 1px solid #FFF;
    background: transparent;
}
</style>

<div id="a">
  <div id="b">    
    <img src="http://clagnut.com/images/ithaka.jpg" />
  </div>
</div>
<div id="div"></div> 
```

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-08T02:43:16.750

元素的最大不透明度是其父元素的不透明度。因此，如果 div#b 的不透明度为 40%，如果他的孩子在样式上具有 100% 的不透明度，那么他们的绝对不透明度也将是 40%。

要完成您所描述的内容（至少我认为您所描述的内容），一种方法可能是同时拥有透明包装器和具有相对定位的父 div 的图像子项。您绝对可以将两个孩子都放置在该包装内，以便图像显示在透明框的顶部。

**编辑**：这是您描述的效果的代码。我的示例有一个 480 x 320 的图像和一个 30 像素的边框：

```
<style>
    #back {background-image:url(mypicture.jpg);
               width:480px;
               height:320px;
               position:relative;}
    #middle {position:absolute;
                 width:480px;
                 height:320px;
                 background-color:#000;
                 opacity:0.4;
                 filter:alpha(opacity=40);
                 top:0;
                 left:0;}
    #front {position:absolute;
                width:420px; /* 30px border on left & right */
                height:260px; /* 30px border on top & bottom */
                background-image:url(mypicture.jpg);
                background-position:-30px -30px; /* compensate for the border */
                top:30px;
                left:30px;}
</style>

<div id="back">
    <div id="middle">
    </div>
    <div id="front">
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T02:48:28.800

如果我理解正确，请尝试仅使用一个 div（即去掉 ID 为“a”的外部 div）并在其周围设置彩色边框。或者，您可以通过使用 4 个 div 用于左、右、上和下边缘以及 4 个用于角的“伪造”边框来获得更大的灵活性。

如果没有示例页面或您所期望的和实际得到的屏幕截图，很难知道您的意思。

*编辑*：我正要编辑 Rex M 写的基本相同的东西。这是另一种（虽然理想上较差）的方法：

```
<style>
#a {
    float: left;
    position: relative;
}
div.overlay {
    opacity: 0.4;
    background-color: black;
    position: absolute;
}
#t {
    left: 0; top: 0; height: 90px; width: 450px;
}
#b {
    left: 0; top: 120px; height: 218px; width: 450px;
}
#l {
    left: 0; top: 90px; height: 30px; width: 90px;
}
#r {
    left: 120px; top: 90px; height: 30px; width: 330px;
}
</style>
<div id="a">
    <div id="t" class="overlay"></div>
    <div id="b" class="overlay"></div>
    <div id="l" class="overlay"></div>
    <div id="r" class="overlay"></div>
    <img src="http://clagnut.com/images/ithaka.jpg">
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T02:49:04.070

要遵循**Rex M**所说的内容，您需要进行一些更改，以使非透明元素不是透明元素的子元素。

您可以使用绝对或相对定位将“边框”与图片对齐，尽管这通常会在浏览器之间产生不一致。

最轻松的方法是使用 javascript 获取图像的顶部和左侧像素位置，并将边框的顶部/左侧 css 属性设置为匹配（并将边框的大小设置为图片）。

更新：

提问者展示了一个他试图重建的例子。在链接的示例中，图片的阴影区域（“未选择”区域）由 4 个 div 创建。

顶部和底部 div 是图像的全宽，并且设置的高度分别是选择框的顶部/底部和图像的顶部/底部之间的差异。

侧面 div 的高度和宽度已修改，以便它们填充图像的“侧面区域”。

大小通过 mousemove 事件更新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-08T02:49:52.447

如果您想确保图像具有特定的背景颜色，您也可以将背景粘贴到样式表中的所有 IMG 元素：

```
div#a img { background: #FFF; } 
```

无论如何，不​​应依赖 CSS 中的 filter-property，因为它不是 CSS 2.1 官方规范的一部分。

不过，我可能误解了这个问题。您能否改写它或提供预期结果的图片？

# functional-programming - 有哪些令人印象深刻的函数式代码示例？

> ID：525042
> 
> 赞同：10
> 
> 时间：2009-02-08T02:43:39.293
> 
> 标签：functional-programming

如果我想要更快的速度，我已经有点厌倦了必须为多核显式编码，特别是当我只是编写一次性脚本时。我的开发盒已经有 8 个内核，而且这个数字的上升速度比时钟速度快得多。函数式语言似乎提供了一个潜在的逃生口，但我还没有努力掌握其中的一个。

我很想看到一些实际代码的示例块，它们比非功能性替代方案更好和/或更可并行化。我对语言并不挑剔——我对概念更感兴趣。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-08T03:02:14.590

[MapReduce](http://labs.google.com/papers/mapreduce.html)怎么样？它具有令人难以置信的可并行性，尽管就本文而言它没有用函数式语言实现，但它的灵感来自 Lisp`map`和`reduce`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-08T07:00:06.607

这段（很长，但非常棒）视频既介绍了[F#](http://msdn.microsoft.com/en-us/fsharp/default.aspx)，也介绍了在语言中并行化代码是多么容易的引人入胜的演示：

[http://channel9.msdn.com/pdc2008/TL11/](http://channel9.msdn.com/pdc2008/TL11/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-08T03:03:09.660

您的问题是要求最先进的材料。我认为您对该领域的最佳介绍以及示例是Nikhil 和 Arvind所著的《 [pH 中的隐式并行编程》一书。](http://tinyurl.com/aepumf)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-08T03:15:23.830

[在Erlang](http://www.pragprog.com/titles/jaerlang/programming-erlang)编程的第 20 章（“多核 CPU 编程”）中有一个使用 mapreduce 的文本索引器/搜索器的扩展示例。我不知道这有多令人印象深刻，但看起来代码凡人可以编写。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T06:47:29.627

LINQ 是主流语言中函数式编程的一个很好的例子。物化代码和单子？在我的 C# 中？:) 无论如何，wrt threading，提到了[Parallel LINQ](http://msdn.microsoft.com/en-us/magazine/cc163329.aspx)。通过使用不变性和高阶函数（也许还有表达式），库可以为我们并行处理。

还有另一个指向 F# 的链接，带有[异步工作流](http://blogs.msdn.com/dsyme/archive/2007/10/11/introducing-f-asynchronous-workflows.aspx)。令人印象深刻的是采用同步代码的能力，并通过一些小注释将其转换为异步代码。该代码保留了您可能正在使用的许多命令式特性。您不必完全改变事物来利用这一点；编译器通过处理这一切。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-09T15:09:39.060

[纯功能数据结构](http://www.cs.cmu.edu/~rwh/theses/okasaki.pdf)（长 PDF），作者：Chris Okasaki。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-09T19:11:43.893

我的一位老师曾经开玩笑说，函数式代码的最大例子就是未编写的代码。

# python - 对于 Python 沙盒，是否有替代 rexec 的方法？

> ID：525056
> 
> 赞同：6
> 
> 时间：2009-02-08T02:51:32.087
> 
> 标签：python, security, sandbox, rexec

在 Python 中实现“沙盒”环境通常是通过 rexec 模块 ( [http://docs.python.org/library/rexec.html](http://docs.python.org/library/rexec.html) ) 完成的。不幸的是，由于一些安全漏洞，它已被弃用/删除。有替代方案吗？

我的目标是让 Python 代码执行半可信的 Python 脚本。在一个完美的世界中，对预定义集合之外的任何函数的调用都会引发异常。从我读到的关于 rexec 的弃用的内容来看，这可能是不可能的。所以我会尽量满足。我可以生成一个单独的进程来运行脚本，这很有帮助。但他们仍然可以滥用 I/O 或处理器/内存资源。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-08T03:18:33.950

您可能希望提供自己的`__import__`以防止包含您认为“滥用 I/O 或处理器/内存资源”的任何模块。

您可能希望从[pypy](http://codespeak.net/pypy/dist/pypy/doc/)开始，并创建自己的解释器，但对资源使用有限制和约束。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T09:51:57.230

出于安全原因，在cpython“沙盒”中是： **“*不要在你的公司孩子这样做*”-thing**。

尝试 ：

*   带有java“沙盒”的jython
*   pypy -> 见答案 S.Lott
*   也许 Ironpython 有解决方案？

见[警告](http://www.wingware.com/psupport/python-manual/2.6/library/restricted.html)：

***警告***

在 Python 2.3 中，由于各种已知且不易修复的安全漏洞，这些模块已被禁用。这些模块仍然记录在此处，以帮助阅读使用 rexec 和 Bastion 模块的旧代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-12-08T18:32:34.547

cPython 中安全性的最佳选择是使用操作系统级别的沙盒机制，并在受操作系统约束的单独进程中运行不受信任的代码。

[根据上面的答案](https://stackoverflow.com/questions/525056/is-there-an-alternative-to-rexec-for-python-sandboxing/#answer-525472)，这相当于使用'jython with java "sandboxing"'，但配置起来可能有点困难。

# apache - 为什么我不能让 Apache 的 CustomLog 指令工作？

> ID：525057
> 
> 赞同：13
> 
> 时间：2009-02-08T02:52:05.610
> 
> 标签：apache, logging, ubuntu

我正在尝试使用 Apache 的`CustomLog`指令来创建一些自定义日志文件，但无法使其正常工作。这是我用于自定义日志的配置：

```
LogFormat "%h %l %u %t \"%r\" %>s %b" common
LogFormat "%{Referer}i -> %U" referer
LogFormat "%{User-agent}i" agent

CustomLog /var/log/apache2/jb_common common
CustomLog /var/log/apache2/jb_referer referer 
```

Apache 在启动时会创建这两个自定义日志文件，因此它肯定会看到`CustomLog`指令，但它从不向这些文件写入任何内容；`access.log`但是，正在写入默认访问日志 ( )。

有任何想法吗？我在 Ubuntu 8.10 上运行 Apache 2.2。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-01-10T05:43:53.367

我对 Ubuntu 9.10 服务器和 Apache 2.2.12 有同样的问题。我正在设置一个 Subversion 服务器，`mod_dav_svn`并添加了一个`CustomLog`指令来`/etc/apache2/mods-available/dav_svn.conf`记录 Subversion 请求，但遇到了同样的问题（日志文件是在 Apache 启动时创建的，但从未写入）：

```
<Location /svn>
  ...
</Location>

LogFormat "%t %u %{SVN-ACTION}e" svn_log
CustomLog /var/log/apache2/svn_access.log svn_log env=SVN-ACTION 
```

我发现的问题有两种解决方法，它们基本上是同一件事。我在这里记录两者，因为它们有不同的优点和缺点。

### 解决方法 1

1.  `CustomLog`如果您在单独的配置文件中设置了该指令，请从配置文件中删除该指令。

2.  `CustomLog`将该指令添加到您网站的`VirtualHost`条目中。对我来说，这是`/etc/apache2/sites-available/default-ssl`因为我只允许 SSL 访问 Subversion 存储库。如果您正在使用`/etc/apache2/sites-available/default`，您将需要编辑该文件（或者`default-ssl`如果您同时使用这两个文件）。

3.  重启阿帕奇：

`sudo /etc/init.d/apache2 restart`

**临**

您可以在站点的条目中包含多个`CustomLog`指令，它们都可以工作。`VirtualHost`

**骗局**

您必须将您的`CustomLog`条目移动到您站点的`VirtualHost`条目中，而不是将其放在单独的配置文件中。

### 解决方法 2

1.  注释掉您网站条目`CustomLog`中的指令。`VirtualHost`如果您使用的是默认站点配置之一（`default`或`default-ssl`），则会有一个`CustomLog`访问日志指令，您需要将其注释掉（是的，这会关闭 Apache 的默认访问日志）。

2.  将您的`CustomLog`指令添加到适当的配置文件中。对我来说这是`/etc/apache2/mods-available/dav_svn.conf`.

3.  重启阿帕奇：

`sudo /etc/init.d/apache2 restart`

**临**

您可以将`CustomLog`指令保存在单独的配置文件中。

**骗局**

这种解决方法有一个明显的缺点，即您必须禁用 Apache 的默认访问日志记录，但对我来说，我并不在意，因为我只使用服务器进行 Subversion 访问。

## 结论

这些解决方法都不是真正理想的，但到目前为止，除了上述两种解决方法之外，我还没有找到让它工作的方法。我想我们必须等待 Apache 的下一个版本才能解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-03-25T22:26:42.813

您可能遇到的一个问题是，如果您通过重写规则将 http 请求重定向到 https，您可能对同一个 VirtualHost 有两个不同的配置文件，一个服务 *:80，另一个服务 *:443

所以也许检查你没有只在服务 http 的 VirtualHost 配置文件中编写 CustomLog 指令！

（是的，它确实发生在我身上）

# android - Android Respond To URL in Intent

> ID：525063
> 
> 赞同：155
> 
> 时间：2009-02-08T02:55:56.867
> 
> 标签：android, url, android-intent, intentfilter, launch

I want my intent to be launched when the user goes to a certain url: for example, the android market does this with [http://market.android.com/](http://market.android.com/) urls. so does youtube. I want mine to do that too.

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2009-02-08T03:16:46.060

I did it! Using [`<intent-filter>`](https://developer.android.com/guide/topics/manifest/intent-filter-element.html). Put the following into your manifest file:

```
<intent-filter>
  <action android:name="android.intent.action.VIEW" />
  <category android:name="android.intent.category.DEFAULT" />
  <category android:name="android.intent.category.BROWSABLE" />
  <data android:host="www.youtube.com" android:scheme="http" />
</intent-filter> 
```

This works perfectly!

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-07-09T21:26:25.230

You might need to allow different combinations of data in your intent filter to get it to work in different cases (`http/` vs `https/`, `www.` vs no `www.`, etc).

For example, I had to do the following for an app which would open when the user opened a link to Google Drive forms (`www.docs.google.com/forms`)

Note that path prefix is optional.

```
 <intent-filter>
            <action android:name="android.intent.action.VIEW" />
            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.BROWSABLE" />

            <data android:scheme="http" />
            <data android:scheme="https" />

            <data android:host="www.docs.google.com" />
            <data android:host="docs.google.com" />

            <data android:pathPrefix="/forms" />
        </intent-filter> 
```

# c# - 为什么在从同一解决方案中引用另一个项目时会出现 FileNotFound 异常？

> ID：525064
> 
> 赞同：5
> 
> 时间：2009-02-08T02:56:01.513
> 
> 标签：c#, .net, nunit

我正在学习如何使用 NUnit。我在它的解决方案中有我的主要项目，并在同一个解决方案中创建了一个单独的项目，它将保存我的单元测试，它有自己的命名空间。从该项目中，我添加了对主项目的引用并添加了

```
using MainProjectNamespace; 
```

到它的顶部。

当我去 NUnit 时，我所做的任何测试都没有引用主项目的工作。这些是我为了习惯 NUnit 而设置的测试，几乎没用。当 NUnit 运行真正的测试时，测试会抛出这个异常：

> TestLibrary.Test.TestMainProject：System.IO.FileNotFoundException：无法加载文件或程序集“WpfApplication2，版本 = 1.0.0.0，Culture=neutral，PublicKeyToken=null”或其依赖项之一。系统找不到指定的文件。

为什么我会收到此异常？

编辑：

现在，当我尝试将程序集加载到 NUnit 中时，它甚至不会加载（所以我什至没有机会运行测试）

这是出现的异常，以及堆栈跟踪：

System.IO.DirectoryNotFoundException：找不到路径“我不想输入的长路径”的一部分

```
System.IO.DirectoryNotFoundException...

Server stack trace: 
    at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
    at System.IO.Directory.SetCurrentDirectory(String path)
    at NUnit.Core.DirectorySwapper..ctor(String directoryName)
    at NUnit.Core.Builders.TestAssemblyBuilder.Load(String path)
    at NUnit.Core.Builders.TestAssemblyBuilder.Build(String assemblyName, Boolean autoSuites)
    at NUnit.Core.Builders.TestAssemblyBuilder.Build(String assemblyName, String testName, Boolean autoSuites)
    at NUnit.Core.TestSuiteBuilder.Build(TestPackage package)
    at NUnit.Core.SimpleTestRunner.Load(TestPackage package)
    at NUnit.Core.ProxyTestRunner.Load(TestPackage package)
    at NUnit.Core.ProxyTestRunner.Load(TestPackage package)
    at NUnit.Core.RemoteTestRunner.Load(TestPackage package)
    at System.Runtime.Remoting.Messaging.StackBuilderSink._PrivateProcessMessage(IntPtr md, Object[] args, Object server, Int32 methodPtr, Boolean fExecuteInContext, Object[]& outArgs)
    at System.Runtime.Remoting.Messaging.StackBuilderSink.PrivateProcessMessage(RuntimeMethodHandle md, Object[] args, Object server, Int32 methodPtr, Boolean fExecuteInContext, Object[]& outArgs)
    at System.Runtime.Remoting.Messaging.StackBuilderSink.SyncProcessMessage(IMessage msg, Int32 methodPtr, Boolean fExecuteInContext)

Exception rethrown at [0]: 
    at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)
    at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type)
    at NUnit.Core.TestRunner.Load(TestPackage package)
    at NUnit.Util.TestDomain.Load(TestPackage package)
    at NUnit.Util.TestLoader.LoadTest(String testName) 
```

EDIT2：上面的路径显然在我的硬盘中

EDIT3：我刚刚在NUnit上从Debug切换到Release，并从TestingLibrary的发布文件夹中加载了dll......它加载了！3 个特定于命名空间的测试中有 1 个有效。到达某个地方，我在。

EDIT4: Wellllllllll ...我现在实际上可以运行测试，但我又回到了原来的错误。IT 没有找到主要项目的程序集

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-08T03:08:28.447

编译器会删除所有未使用的引用，并且不会不必要地部署 dll。A `using`（本身）不算作使用。通过“复制到输出目录”设置标记要部署的 dll，或者添加一些*真正*使用 dll 中声明的类型的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T07:14:26.860

您是否重命名了源项目中输出程序集或命名空间的名称？

看起来您的源文件是“WPFApplication1”，我推测您可能已将输出类型从 dll 更改为 exe？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-13T18:39:25.790

我遇到了同样的问题，RKitsons 的回答帮助了我。

基本上，我将我的项目所依赖的所有 dll 以及 nunit.framework.dll 复制到同一目录中...obj/debug/ 这是一种方法。

优雅的方法是更改​​项目配置，在 Visual Studio 中，在 Build 选项卡下将项目设置为发布模式，如果项目设置正确，则应将所有依赖 dll 复制到适当的“out”或“release”目录中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T00:59:27.553

看起来您在应用程序中引用的程序集之一依赖于不在您的 bin 文件夹中的另一个程序集。

# c - 哪个能够存储 1 亿条记录的嵌入式数据库具有高效的 C 或 C++ API

> ID：525065
> 
> 赞同：20
> 
> 时间：2009-02-08T02:57:07.767
> 
> 标签：c, database, performance, cross-platform

我正在寻找一个跨平台的数据库引擎，它可以处理数亿条记录的数据库，而不会严重降低查询性能。它需要有一个 C 或 C++ API，这将允许轻松、快速地构造记录和解析返回的数据。

非常不鼓励将数据转换为字符串或从字符串转换为将其输入数据库的产品。存储 IP 地址等内容的技术用户不希望或不需要这种开销。这是一个非常重要的标准，因此如果您要提及产品，请明确说明它们如何提供如此直接的 API。不想粗鲁，但我可以使用 Google - 请假设我已经找到了大多数主流产品，我之所以问，是因为通常很难弄清楚它们提供的直接 API，而不仅仅是 SQL 的 C 包装器。

它不需要是 RDBMS - 一个简单的 ISAM 面向记录的方法就足够了。

虽然主要需求是单用户数据库，但将来可能会扩展到某种共享文件或服务器操作。

如果数据库来自小公司，则非常需要访问源代码，无论是开源还是通过许可。它不能是 GPL 或 LGPL。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-08T06:27:38.810

您可能会考虑[FairCom](http://www.faircom.com/)的[C-Tree](http://en.wikipedia.org/wiki/C-tree) - 告诉他们我寄给您的 ;-)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-02-21T14:30:56.893

我是 hamsterdb 的作者。

东京内阁和 berkeleydb 应该可以正常工作。hamsterdb 肯定会工作。它是一个简单的 C API，开源，独立于平台，速度非常快，并且经过数百 GB 和数亿个项目的数据库测试。

如果您愿意评估并需要支持，请给我发邮件（hamsterdb.com 上的联系表格） - 我会尽我所能提供帮助！

再见克里斯托夫

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-08T05:29:59.067

你没有提到你在什么平台上，但如果只有 Windows 就可以，看看[可扩展存储引擎](http://msdn.microsoft.com/en-us/library/ms684493(VS.85).aspx)（以前称为 Jet Blue），Windows 2000 及更高版本中包含的嵌入式 ISAM 表引擎。它用于 Active Directory、Exchange 和其他内部组件，针对少量大型表进行了优化。

它有一个 C[接口并且](http://msdn.microsoft.com/en-us/library/ms683070(VS.85).aspx)[本机](http://msdn.microsoft.com/en-us/library/ms684167(VS.85).aspx)支持二进制数据类型。它支持[索引](http://msdn.microsoft.com/en-us/library/ms683120(VS.85).aspx)、[事务](http://msdn.microsoft.com/en-us/library/ms683098(VS.85).aspx)并使用日志来确保原子性和持久性。没有查询语言；您必须自己直接使用[表](http://msdn.microsoft.com/en-us/library/ms684002(VS.85).aspx)和[索引](http://msdn.microsoft.com/en-us/library/ms684059(VS.85).aspx)。

ESE 不喜欢通过网络打开文件，也不支持通过文件共享来共享数据库。您将很难找到任何支持通过文件共享进行共享的数据库引擎。Access Jet 数据库引擎（AKA Jet Red，完全独立的代码库）是我所知道的唯一一个，它因通过网络破坏文件而臭名昭著，尤其是当它们很大（> 100 MB）时。

无论您使用什么引擎，您很可能必须自己在自己的网络服务器进程中实现共享使用功能，或者使用离散的数据库引擎。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-10-08T13:48:19.280

For anyone finding this page a few years later, I'm now using LevelDB with some scaffolding on top to add the multiple indexing necessary. In particular, it's a nice fit for embedded databases on iOS. I ended up writing a book about it! (Getting Started with LevelDB, from Packt in late 2013).

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-08T03:40:06.310

一种选择可能是[Firebird](http://www.firebirdsql.org)。它既提供基于服务器的产品，也提供嵌入式产品。

它也是开源的，并且有大量针对所有类型语言的提供程序。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-08T05:41:51.257

我相信您正在寻找的是 BerkeleyDB： [http ://www.oracle.com/technology/products/berkeley-db/db/index.html](http://www.oracle.com/technology/products/berkeley-db/db/index.html)

别介意它是 Oracle，许可证是免费的，而且它是开源的——唯一的问题是，如果你重新分发使用 BerkeleyDB 的软件，你必须同时提供你的源代码——或者购买许可证。

它不提供 SQL 支持，而是直接查找（通过 b-tree 或哈希表结构，以更适合您的需要为准）。它非常可靠、快速、ACID、内置复制支持等等。

这是我上面提到的页面的一小段引述，其中列出了一些功能：

> ## 数据存储
> 
> Berkeley DB 可以快速轻松地存储数据，而不会产生其他数据库中的开销。Berkeley DB 是一个 C 库，它与您的应用程序在同一进程中运行，避免了使用远程数据库服务器的进程间通信延迟。共享缓存将最活跃的数据保存在内存中，避免了昂贵的磁盘访问。
> 
> *   本地、进程内数据存储
> *   模式中立的应用程序本机数据格式
> *   索引和顺序检索（Btree、Queue、Recno、Hash）
> *   每个应用程序多个进程和每个进程多个线程
> *   高并发系统的细粒度和可配置锁定
> *   多版本并发控制（MVCC）
> *   支持二级索引
> *   内存中、磁盘上或两者兼有
> *   在线 Btree 压缩
> *   在线Btree磁盘空间回收
> *   在线弃锁清除
> *   磁盘数据加密 (AES)
> *   高达 4GB 的记录和高达 256TB 的表格

**更新：**刚刚跑过这个项目，想到了你发布的问题：http: [//tokyocabinet.sourceforge.net/index.html](http://tokyocabinet.sourceforge.net/index.html)。它在 LGPL 下，因此与您的限制不兼容，但仍然是一个值得一试的有趣项目。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-08T03:48:31.610

SQLite 将满足这些标准，除了未来最终的共享文件场景（实际上，如果网络文件系统正确实现文件锁，它可能会这样做）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-08T11:26:59.847

已经提到了许多好的解决方案（例如 SQLite）。让我添加两个，因为您不需要 SQL：

*   [HamsterDB](http://www.hamsterdb.com/)速度快，使用简单，可以存储任意二进制数据。没有提供共享数据库。
*   [Glib](http://library.gnome.org/devel/glib/stable/) HashTable 模块似乎也很有趣并且很常见，因此您不会冒险陷入死胡同。另一方面，我不确定是否有简单的方法将数据库存储在磁盘上，它主要用于内存中的东西

我已经在数百万个记录项目上进行了测试。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-02T08:31:11.927

既然您熟悉 Fairtree，那么您可能也熟悉 Raima RDM。

几年前它开源了，然后 dbstar 声称他们以某种方式获得了版权。不过，这似乎值得商榷。从阅读原始的 Raima 许可证来看，这似乎是不可能的。当然，可以保留原始代码版本。这是相当罕见的，但我有一个副本存档了。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-08T06:13:45.080

SQLite 往往是第一选择。它不会将数据存储为字符串，但我认为您必须构建一个 SQL 命令来进行插入，并且该命令将构建一些字符串。

如果您不需要关系数据库，BerkeleyDB 是一个精心设计的产品。我不知道 Oracle 对此收取什么费用，以及您是否需要为您的应用程序提供许可证。

我个人会考虑为什么你有一些你的要求。您是否进行过测试以验证您需要直接插入数据库的要求？似乎您可能需要几个小时来编写一个包装器，该包装器可以从您想要的任何 API 转换为 SQL，然后查看 SQLite、MySql...是否满足您的速度要求。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-07-17T14:28:23.623

曾经有一个产品叫 b-trieve，但我不确定是否包含源代码。我认为它已经停产了。我所知道的唯一一个面向 ISAM 的数据库引擎是 c-tree。

# python - python编码速度和最干净

> ID：525080
> 
> 赞同：0
> 
> 时间：2009-02-08T03:14:04.770
> 
> 标签：python

Python 非常干净，我可以快速编写简洁的应用程序。但我注意到我在某个地方有一些小错误，我在编译时没有发现错误，而是在运行时发现了错误。然后我需要更改并再次运行脚本。有没有办法让它中断并让我修改和运行？

另外，我不喜欢 python 没有枚举。如果我要编写需要大量枚举和类型的代码，我应该用 C++ 来编写吗？感觉我可以在 C++ 中更快地做到这一点。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-08T03:25:30.440

**“我在编译时没有发现错误，但在运行时没有发现错误”**

正确的。对于所有非编译的解释语言都是如此。

**“我需要更改并再次运行脚本”**

也正确。对于所有非编译的解释语言都是如此。

**“有没有办法让它中断，让我修改并运行？”**

什么？

如果它是运行时错误，则脚本会中断，您修复它并再次运行。

如果这不是一个正确的错误，而是某种逻辑问题，那么程序会结束，但不能正常工作。任何语言都无法预测您的希望并为您打破。

或者你的意思是别的。

**“...需要大量枚举的代码”**

您需要提供需要大量枚举的代码示例。我多年来一直在编写 Python，并且没有使用枚举。确实，我一直在编写 C++，也没有使用枚举。

您必须提供需要大量枚举的代码作为特定示例。也许在另一个类似“什么是所有这些枚举的 Pythonic 替代品”的问题中。

它通常是多态类定义，但没有示例，很难确定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-08T04:05:03.013

使用解释语言，您有很大的自由度。自由在这里也不是免费的。虽然解释器不会在它认为你的代码值得运行之前折磨你打点每个 i 并交叉每个 T，但它也不会尝试静态分析你的代码以解决所有这些问题。所以你有几个选择。

1) {Pyflakes, pychecker, pylint} 将对您的代码进行静态分析。这主要解决了语法问题。

2) 使用鼻子测试或类似的测试驱动开发将对您有所帮助。如果您进行的代码更改破坏了现有代码，则测试将失败，您将知道这一点。这实际上比静态分析更好，并且可以同样快。如果您先测试，那么您将在*测试*运行时而不是程序运行时检查所有代码。

请注意，使用 1 和 2 比仅使用静态类型编译器要好一些。即便如此，它也不会创建正确性证明。

您的测试可能会错过应用程序实际运行所需的一些管道。如果发生这种情况，您通常通过编写更多测试来修复它。但是您仍然需要启动应用程序并点击它来查看您应该编写和没有编写的测试。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-08T05:24:30.793

您可能想研究类似[nosy](http://jeffwinkler.net/2006/04/27/keeping-your-nose-green/)的东西，当您保存对文件的更改时，它会定期运行您的单元测试。您还可以设置一个保存事件触发器，以便在您保存文件时在后台运行您的单元测试（例如可能使用 Komodo Edit）。

也就是说，我所做的是绑定 F7 键以在当前目录和子目录中运行单元测试，并绑定 F6 键以在当前文件上运行[pylint 。](http://www.logilab.org/857)经常使用这些可以让我很快发现错误。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-08T03:28:24.193

Python 是一种解释性语言，*没有*编译阶段，至少对用户不可见。如果出现错误，请返回，修改脚本，然后重试。如果您的脚本执行时间很长，并且您不想停止重启，您可以尝试使用 pdb 之类的调试器，使用它可以在运行时修复一些错误。

有很多方法可以实现枚举，在谷歌上快速搜索“python enums”可以提供你可能需要的一切。但是，您应该检查您是否真的需要它们，以及是否有更好、更“pythonic”的方式来做同样的事情。

# html - css格式是否影响表单的有效性

> ID：525088
> 
> 赞同：1
> 
> 时间：2009-02-08T03:17:31.423
> 
> 标签：html, css

如果我有一个带有一些嵌入`div`s 的 HTML 表单，并且在应用 CSS 之后，表单的各个部分最终会散布在原始`<form>`边界之外的整个页面上，那么该表单是否/将继续工作。HTML 规范对这种事情有什么看法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-08T03:22:44.470

是的，该表格将继续有效。CSS 定位不影响 HTML 的有效性。唯一关心的是可用性或清晰度。如果一个元素不属于表单，你可能会混淆用户。或者，如果您在无法点击的位置放置/分层，也会导致问题。

但是 HTML 和 CSS 是不同的东西…… HTML 规范在这件事上没有什么可说的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T03:26:44.010

只要元素仍然是表单标签的子元素，什么都不会改变。显示不会影响功能，因此它们是否看起来与表单不在同一区域并不重要。

但是，如果您通过 javascript 操作 DOM 并将元素移出表单，（在表单之外，我的意思是它们不再是该表单的子元素，而不是它们在视觉上是外部的），那么它们会'不再与该表格一起提交。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T03:27:44.727

定位没有影响。标签的嵌套确实如此。所有表单元素都需要在里面，但我认为这是唯一的要求。

# nhibernate - 使用外键将一对多集合映射到外键

> ID：525097
> 
> 赞同：1
> 
> 时间：2009-02-08T03:23:54.377
> 
> 标签：nhibernate, nhibernate-mapping, legacy-database

我正在使用 nhibernate 映射旧数据库，并且在映射关系时遇到了一些问题。

这两个类看起来像这样

```
public class Questionnaire
{
    public int Id {get; set;}
    public string FormCode {get; set;}
    public IList<Question> Questions {get; set;}
}

public class Question
{
    public int Id{get; set;}
    public Questionnaire Questionnaire {get;set;}
    public string QuestionText{get;set;}
} 
```

像这样的表

```
Questionnaire Table  
Id int  
FormCode varchar(100)  

Question Table  
Id int  
FormCode varchar(100)  
QuestionText varchar(max) 
```

两个表之间的关系是 formcode 列。

我现在的映射是这样的

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="QDesign.Core.Models" assembly="QDesign.Core">
<class name="Questionnaire" table="_questionnaire_list">
    <id column="Id" name="Id">
            <generator class="identity"/>
    </id>
        <property name="FormCode" column="FormCode"/>
        <bag name="Questions" >
            <key foreign-key="FormCode" property-ref="FormCode" />
            <one-to-many class="Question" />            
        </bag>
</class>
</hibernate-mapping>

<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="QDesign.Core.Models" assembly="QDesign.Core">
<class name="Question" table="_questionnaire_items">
    <id column="ID" name="Id" unsaved-value="-1">
            <generator class="identity" />
        </id>
        <property name="QuestionText" column="QuestionText" />
</class>
</hibernate-mapping> 
```

当我运行映射时，假设它试图将表单代码放入问题的 ID 中，我得到一个标识符类型不匹配。不幸的是，我无法更改表格的结构，我不知道如何映射它，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-08T10:38:35.387

您的关系是没有中间实体的 m:n 关系。以这种方式定义 m:n 关系是一个典型的错误，因为它切除了一个 pk 端，这导致存在两个具有相同属性/字段的表并且它们恰好在语义上表示相同事物的情况。但是，因为它们在双方都是非 pk 值，所以存在冗余和不准确的可能。您可以通过两个字段将两个表连接在一起，但在语义上它没有任何意义：对于将实体 X 与 Y 相关联的实体模型，FK 端将关系的 PK 端作为 FK 字段，而对于 m:n 关系，您需要两个源自中间实体的 m:1 关系。就是*这样*，没有例外。

因此，尽管您想按照您建议的方式进行映射，但由于 o/r 映射器无法保证正确性，因为建议的关系根本不正确，因此无法完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T03:44:24.320

这就是 ORM 的“问题”。我说“问题”是因为 Hibernate 在技术上是正确的：外键应该是主键。但是，正如你所看到的，情况并非总是如此。

ID实际上用于任何事情吗？如果没有，阻力最小的路径是使 FormCode 成为主键。这是一个选择吗？

如果不是，我真的不确定除了查询问题而不是将它们视为子实体之外还能做什么。

# .net - 白名单模型绑定似乎不适用于复杂的属性

> ID：525098
> 
> 赞同：2
> 
> 时间：2009-02-08T03:24:41.800
> 
> 标签：.net, asp.net-mvc, modelbinders, whitelist

我有一个如下所示的 POST 操作：

```
public ActionResult Create([Bind(Include="userrole,credentials.emailAddress,credentials.password")]User u, string confirmPassword, bool agreeToTerms) 
```

我正在使用默认模型绑定器，并且凭据是我的 User 对象上的一个属性。凭据有两个字段（电子邮件地址和密码）。如果我删除白名单，凭据对象会被绑定并且一切都按预期工作。但是，如果我提供该白名单，用户角色会被绑定，但复杂属性上的电子邮件和密码不会。我检查了表单值，当我列出它们并且它们与我的对象匹配时，它们很关心。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-01-04T12:33:17.477

我知道你在二月份问过这个问题，但如果它仍然有效，你是否将你的文本框都指定为: `<%= Html.TextBoxFor(x => x.credentials.emailAddress) %>`或
`<%= Html.TextBox("credentials.emailAddress") %>`类似的东西？

关键是您需要确保您的文本框设置了`credentials`前缀。

# java - LdapContext，如何做选择计数（*）

> ID：525100
> 
> 赞同：5
> 
> 时间：2009-02-08T03:25:52.030
> 
> 标签：java, ldap

我在 java 中使用 LdapContext 来查询 LDAP 服务器（我认为服务器是 Sun 服务器版本 5.2）。我对常规查询使用 LdapContext.search(String name, String filter, SearchControls cons) 方法，但我不知道如何运行相当于 sql 的“select count(*)”的查询。任何的想法？性能很重要，所以我不想只运行常规查询并计算结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T07:25:02.877

您是否尝试过 Context.list(String name) 方法？我不知道性能，你不能应用过滤器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T18:51:34.283

我不相信 SQL 中有与“select count(*)”函数等效的函数。

我认为您必须将查询结果检索到某些数据结构中，并计算其中的节点数。

据我所知，LDAP 命令集中没有任何东西允许这样做，因此，如果您碰巧在 LDAP 服务器中找到了这样的功能，那么如果您关心跨服务器兼容性，您将不得不测试它是否可以在其他任何地方工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-15T13:59:37.783

您不能直接计算来自`LDAP`. 例如你必须把你想统计的所有数据都带入数据结构中`LIST`并统计它。

# dynamic-linq - 使用属性的动态 LINQ 查询

> ID：525111
> 
> 赞同：1
> 
> 时间：2009-02-08T03:37:14.193
> 
> 标签：dynamic-linq

我已经成功地让 MSFT Dynamic Linq 的东西工作了，但现在我需要创建一个包含属性的“Where”子句。

我得到的错误是“不存在适用的聚合方法'First'”

这是我的代码：

```
where = "Element(XName.Get(\"procedure\")).Attributes(XName.Get(\"code\")).First() = \"28002\"";

var q2 = doc.Elements().Descendants("vocabularybody").AsQueryable().Where(where);

if (q2 != null && q2.Count() > 0)
foundItems.Add(item); 
```

这是我的 XML

```
<vocabulary>
<vocabularyheader>
<vocabularyid>5</vocabularyid>
<vocabularyname>Scheduled Procedure</vocabularyname>
</vocabularyheader>
<vocabularybody>
<procedure code="28002" type="Surgery"/>
</vocabularybody>
</gazoontvocabulary> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T05:56:52.570

我还不熟悉动态 LINQ 库，但是对于 where 子句，您不应该需要相等运算符 (==) 而不是赋值运算符 (=) 吗？

# c - memchr() 如何在后台工作？

> ID：525123
> 
> 赞同：14
> 
> 时间：2009-02-08T03:52:49.107
> 
> 标签：c, performance, d, standard-library

**背景：** 我正在尝试创建一个纯 D 语言实现的功能，它大致相当于[C 的 memchr](http://en.cppreference.com/w/c/string/byte/memchr)，但使用数组和索引而不是指针。原因是 std.string 将与编译时函数评估一起使用。对于那些不熟悉 w/D 的人，如果满足某些限制，可以在编译时评估函数。一个限制是它们不能使用指针。另一个是他们不能调用 C 函数或使用内联汇编语言。在编译时让字符串库工作对于一些编译时代码生成黑客很有用。

**问题：** memchr 是如何在幕后工作的，以实现如此快速的性能？在 Win32 上，我能够使用简单循环在纯 D 中创建的任何内容都至少慢 2 倍，即使使用明显的优化技术，例如禁用边界检查、循环展开等。有哪些不明显的技巧可用于像在字符串中查找字符一样简单？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-08T03:56:04.857

我建议看一下[GNU libc](http://www.gnu.org/software/libc/)的源代码。对于大多数函数，它将包含该函数的通用优化 C 版本，以及为尽可能多的受支持架构优化的汇编语言版本，利用机器特定的技巧。

[x86-64 SSE2 版本](https://github.com/lattera/glibc/blob/master/sysdeps/x86_64/memchr.S)一次组合[`pcmpeqb`](http://www.felixcloutier.com/x86/PCMPEQB:PCMPEQW:PCMPEQD.html)了整个缓存行数据的结果（四个 16B 向量），以分摊提前退出//`pmovmskb`的开销`test`。`jcc`

gcc 和 clang 目前无法对具有`if() break`提前退出条件的循环进行自动矢量化，因此它们从明显的 C 实现中生成了简单的 byte-at-a-time asm。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-08T03:59:58.717

[这个来自 newlib 的 memchr 实现](https://sourceware.org/viewvc/src/newlib/libc/string/memchr.c?revision=1.4&view=markup)是某人优化 memchr 的一个例子：它一次读取和测试 4 个字节（除了 memchr，newlib 库中的其他函数都[在这里](http://sourceware.org/cgi-bin/cvsweb.cgi/src/newlib/libc/string/?cvsroot=src)）。

顺便说一句，MSVC 运行时库的大部分源代码都是可用的，作为 MSVC 安装的可选部分（因此，您可以查看它）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-08T04:09:04.767

[**这是来自memchr.c**](http://svn.freebsd.org/viewvc/base/stable/7/lib/libc/string/memchr.c?view=markup)的 FreeBSD（BSD 许可）memchr() 。FreeBSD 的在线源代码浏览器是经过时间考验的、获得 BSD 许可的代码示例的一个很好的参考。

```
void *
memchr(s, c, n)
    const void *s;
    unsigned char c;
    size_t n;
{
    if (n != 0) {
        const unsigned char *p = s;

        do {
            if (*p++ == c)
                return ((void *)(p - 1));
        } while (--n != 0);
    }
    return (NULL);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-08T05:15:06.600

像 memset 和 memcpy 这样的 memchr 通常会减少到相当少量的机器代码。[如果不内联类似的汇编代码](http://sourceware.org/ml/newlib/2008/msg00290.html)，您不太可能重现这种速度。在实现中要考虑的一个主要问题是[数据对齐](http://en.wikipedia.org/wiki/Packed)。

[您可以使用](http://smallcode.weblogs.us/sentinel_for_string_manipulations)的一种通用技术是在要搜索的字符串的末尾插入一个[标记](http://en.wikipedia.org/wiki/Sentinel_(computer_science))，以保证您会找到它。它允许您将字符串结尾的测试从循环内部移动到循环之后。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-11-24T23:10:19.137

GNU libc 肯定使用 memchr() 的**汇编**版本（在任何常见的 linux 发行版上）。这就是为什么它如此之快令人难以置信。

例如，如果我们计算 11Gb 文件中的行数（如“ *wc -l* ”所做的），使用来自 GNU libc 的 memchr() 的**汇编**版本大约需要**2.5**秒。**但是如果我们用 FreeBSD 的 memchr() C 实现**替换 memchr() 程序集调用- 速度将降低到**30**秒左右。这相当于用一个 while 循环替换 memchr() ，该循环一个接一个地比较一个字符。

 ******# python - 枚举的pythonic替换

> ID：525134
> 
> 赞同：0
> 
> 时间：2009-02-08T04:04:44.370
> 
> 标签：python, enums

在我的 python 脚本中，我正在解析用户创建的文件，通常会出现一些错误，并且在某些情况下我会警告用户更清楚。在 ci 中会有一个枚举，如 eAssignBad、eAssignMismatch、eAssignmentSignMix（符号与无符号混合）。然后我会查找该值以打印错误或警告消息。我将warningMsg链接在一个地方，我喜欢名称的可读性而不是文字值。这是什么pythonic替代品？

**重复**：[如何在 Python 中表示“枚举”？](https://stackoverflow.com/questions/36932/whats-the-best-way-to-implement-an-enum-in-python/38092#38092)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-08T05:50:32.490

这是迄今为止我发现的最好的枚举实现之一：http: [//code.activestate.com/recipes/413486/](http://code.activestate.com/recipes/413486/)

但是，我敢问，你需要一个枚举吗？

您可以使用带有错误消息的简单 dict 和带有错误编号的一些整数常量。

```
eAssignBad = 0
eAssignMismatch = 1
eAssignmentSignMix = 2

eAssignErrors = {
    eAssignBad: 'Bad assignment',
    eAssignMismatch: 'Mismatched thingy',
    eAssignmentSignMix: 'Bad sign mixing'
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-08T04:21:36.600

您可以尝试制作一堆异常类（Exception 的所有子类，也许通过您自己的一些公共父类）。每个人都会有一个适合该场合的错误消息文本......

# javascript - 使用 jQuery 将 javascript id 放入 div

> ID：525139
> 
> 赞同：2
> 
> 时间：2009-02-08T04:09:11.070
> 
> 标签：javascript, jquery

```
$('div.box').html("hello") 
```

把你好这个词放在我所有的'box'类的div中。他们都有一个分配的ID。

我试图弄清楚如何将每个 div 的 id 而不是 'hello' 放在 div 中。也许这真的很容易，但我无法弄清楚。我也是 jQuery 的新手。有任何想法吗？我试过了：

```
$("div.box").html("id: " + $(this).attr("id")); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-08T04:12:52.420

试试这个：

```
$("div.box").each(function() {
  $(this).html("Id: " + this.id);
}); 
```

完整示例：

```
<html>
<head>
  <title>Layout</title>
</head>
<body>
  <div id="id1" class="box">Box One</div>
  <div id="id2" class="box">Box Two</div>
  <div id="id3">Box Three</div>
  <div id="id4" class="box">Box Four</div>
<script src="http://www.google.com/jsapi"></script>
<script>
  google.load("jquery", "1.3.1");
  google.setOnLoadCallback(function() {
    $(function() {
      $("div.box").each(function() {
        $(this).html("ID: " + this.id);
      });
    });
  });
</script>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-08T04:14:56.427

您将要遍历每个项目。

```
$("div.box").each(function()
{
  $(this).html("id: " + this.id);
}); 
```

# blackberry - 黑莓 API 是否允许黑莓通过 TCP/IP 连接到桌面？

> ID：525143
> 
> 赞同：1
> 
> 时间：2009-02-08T04:12:52.873
> 
> 标签：blackberry, connection, tcp

想知道如何通过 tcp/ip 将黑莓连接到桌面或其他设备？我假设桌面和黑莓都连接到同一个路由器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-08T18:27:28.607

如果我正确阅读了您的问题，并且您希望通过与桌面相同 LAN 上的 WiFi 路由器建立 TCP 连接，那么您只需从 BlackBerry 应用程序执行以下操作：

```
javax.microedition.io.Connector.open("socket://<your desktop's IP/hostname>:<port>;interface=wifi"); 
```

（对于 TLS 或 SSL3 套接字连接，您可以将 socket:// 替换为 tls:// ssl://）

如果您要通过蜂窝网络，情况会稍微复杂一些 - 如果您的设备连接到与桌面相同的 LAN 上的 BES，或者如果您的桌面有公共 IP，但基本语法是相同的（显然减去 interface=wifi）。

# wpf - 如何克隆整个控件网格？

> ID：525144
> 
> 赞同：1
> 
> 时间：2009-02-08T04:13:47.053
> 
> 标签：wpf, grid, clone

我有以下代码，基本上我无法弄清楚的是如何克隆整个网格并并排制作它们的空白副本....为了清楚地理解这与医院申请和网格与怀孕有关，所以当说“添加孩子”按钮时，应该在运行时创建一个全新的网格，感谢下面的帮助是一个可能对人们有所帮助的链接，因为我试过但不知道如何显示它

[如何克隆 WPF 对象？](https://stackoverflow.com/questions/32541/how-can-you-clone-a-wpf-object)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T11:07:39.587

You should put the object you are want to "clone" in a `DataTemplate` and reference this template from an `ItemsControl`, then when you need another grid add another item to the items control (or even better to the list the control is bound to) and the `ItemsControl` will create a new grid and bind it the new object.

For an example take a look at [this post](http://www.nbdtech.com/blog/archive/2007/08/23/WPF-Image-Viewer-Part-4-Data-Templates-and-Resources.aspx) on my blog.

Here is an example for this application (I left only the relevant parts and I didn't test it, so there are probably some typos there):

```
<Window ... >
   <Window.Resources>
      <DataTemplate x:Key="ChildTemplate">
         <Grid>
            ...
            <TextBlock Text="Delivery Date:" Grid.Column="0" Grid.Row="0"/>
            <TextBox Text="{Binding DeliveryDate}" Grid.Column="1" Grid.Row="0"/>
            <TextBlock Text="Delivery Time:" Grid.Column="0" Grid.Row="1"/>
            <TextBox Text="{Binding DeliveryTime}" Grid.Column="1" Grid.Row="1"/>
            ...
         </Grid>
      </DataTemplate>
   </Window.Resources>
   ...
      <Button Content="AddChild" Click="AddChildClick"/>
   ...
      <ScrollViewer>
          <ItemsControl ItemsSource="{Binding AllChildren}" ItemsTemplate="{StaticResource ChildTemplate}">
              <ItemsControl.PanelTemplate>
                  <ItemsPanelTemplate><StackPanel Orientation="Horizontal"/></ItemPanelTemplate>
              <ItemsControl.PanelTemplate>
      </ScrollViewer>
    ...
</Window> 
```

And in cs:

1.  Set an object with all the form data as the Window's `DataContext`. I'll call this class `PostDelveryData`.
2.  Create another class with the repeating data. I'll call it `ChildDeliveryData`.
3.  Add a property of type `ObservableCollection<ChildDeliveryData>` called `AllChildren` to `PostDeliveryData`; it's important it'll be `ObservableCollection` and not any other type of collection.
4.  Now, for the magic:

    ```
    private void AddChildClick(object sender, RoutedEvetnArgs e)
    {
       ((PostDeliveryData)DataContext).AllChildren.Add(new ChildDeliveryData());
    } 
    ```

And when you add the new item to the list another copy of the entire data template will be added.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T10:34:58.390

If I am understanding correctly, you should create a UserControl, which wraps your Grid and subsequent controls inside. And use this User control anywhere you wanted to replicate that UI.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T04:24:13.100

我不确定您在这里使用的方法是否正确。我会通过创建一个带有 Child 属性的“ChildGridControl”来解决这个问题，并让 Child 属性处理数据绑定。向 GUI 添加新的子项将涉及创建 ChildGridControl 的新实例。

# resources - 并发和协调运行时 (CCR) 学习资源

> ID：525154
> 
> 赞同：17
> 
> 时间：2009-02-08T04:26:05.420
> 
> 标签：resources, ccr

我最近一直在学习[并发和协调运行时（CCR）的进出。](http://msdn.microsoft.com/en-us/library/bb905450.aspx) 为这种相对较新的技术找到好的学习资源非常困难。

（快速谷歌搜索将“Creedence Clearwater Revival”作为最佳结果！）

我发现的一些资源：

*   来自 WROX 的关于 Robotics Developer Studio 的[免费电子书章节](http://www.robochamps.com/rc/data/learningarea/141076-cover-df.pdf)
*   InfoQ 上[的好文章/帖子](http://www.infoq.com/articles/Using-CCR)
*   [机器人的会员博客](http://blogs.msdn.com/pollrobots/archive/2008/07/22/ccr-utilities-part-1.aspx)
*   非常活跃的[MSDN CCR 论坛](http://social.msdn.microsoft.com/forums/en-US/roboticsccr/threads/)- 从这里获得了很多帮助！
*   杰弗里·里希特 (Jeffrey Richter) 的[伟大 MSDN 杂志](http://msdn.microsoft.com/en-au/magazine/cc163556.aspx)
*   官方[CCR 用户指南](http://msdn.microsoft.com/en-us/library/bb905450.aspx)- 没有发现这很有帮助
*   关于 CCR 的精彩博客[系列](http://iodyne.blogspot.com/)
*   iodyner [CCR 相关博客](http://iodyne.blogspot.com/)- 更新：[移至此处](http://iodyner.spaces.live.com/)
*   Channel9.msdn.com 上有八个左右的[视频](http://channel9.msdn.com/tags/CCR/)
*   [MS Robotics Studio 上的CCR 模式页面](http://channel9.msdn.com/wiki/ccrpatterns/)- 我还没有读过这个
*   Stackoverflow 上的4 个[CCR 问题](https://stackoverflow.com/questions/tagged/ccr)- 大多数问题都是我的！哈哈
*   [CCR 和 DSS 工具包](http://blogs.msdn.com/msroboticsstudio/archive/2009/04/22/rds-2008-standard-edition-and-ccr-and-dss-toolkit-2008-available-on-msdn.aspx)现已发布给 MSDN 会员

CCR 有什么好的学习资源吗？

我真的希望微软能发布更多的材料，到目前为止它已经太针对机器人技术了。我相信 MS 需要承认大多数人在使用 CCR 时与 DSS 和 Robotics Studio 是隔离的。

## 更新

在 Mix 2010 会议上，Myspace 介绍了他们如何在中间层使用 CCR 框架。他们还开源了代码库。

*   [MySpace 数据中继](http://datarelay.codeplex.com/)
*   [混合视频演示](http://live.visitmix.com/MIX10/Sessions/EX04)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-06-12T21:03:50.263

Microsoft Robotics Studio 2008 R3 现已上市并免费供所有人使用。

在这里[http://www.microsoft.com/robotics/](http://www.microsoft.com/robotics/)或直接在这里[http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=c185a802-5bbe-4f28-b448-aefe63a7eff7](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=c185a802-5bbe-4f28-b448-aefe63a7eff7)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T17:38:51.030

*   [Licensing](http://blog.aheil.de/2007/08/08/TheMicrosoftRoboticsStudioLicensingModel.aspx)
*   [CCR PowerPoint presentation](http://igor.moochnick.googlepages.com/ccrpresentation1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T17:25:16.537

We recently completed a project using DSS (Built on top of CCR). It seemed to be a great framework. One issue we had was going from 32bit to 64bit which meant all threads were duplicated.

(Dev was done on a 32bit Mac using Vista. Deployment on Win08 64bit)

I'd suggest the DSS tutorials as a nice way to see how the CCR lib's can be used within that environment.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T15:21:09.760

[3 个帖子系列](http://www.lnbogen.com/Part1SpawnEnumeratorDealingWithBillionsOfIndependentItems.aspx)

# oracle - 全新安装 Oracle Express 后的默认用户名是什么？

> ID：525156
> 
> 赞同：8
> 
> 时间：2009-02-08T04:26:57.680
> 
> 标签：oracle, authentication, credentials, oracle-xe

我刚刚安装了 Oracle Express 版本。在安装过程中，它要求我设置密码而不是用户名。安装完成后，它引导我进入浏览器窗口并要求我使用用户名和密码登录。密码我知道，但用户名我不知道。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-08T04:31:02.820

您是否尝试过标准的 oracle 帐户，..“sys”和“system”？

# c# - 可以强制泛型类从两个接口之一继承类型吗？

> ID：525158
> 
> 赞同：2
> 
> 时间：2009-02-08T04:33:18.323
> 
> 标签：c#, .net, generics

我有一个泛型类，但我希望我的类型被迫从一个或另一个接口继承。例如：

```
public class MyGeneric<T> where T : IInterface1, IInterface2 {} 
```

以上将强制 T 从 IInterface1 和 IInterface2 继承，但我可以强制 T 从 IInterface1 或 IInterface2（或两者）继承吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-08T04:48:01.897

定义一个基本接口——它甚至不必有任何成员，而是让 Interface1 和 Interface2 扩展它。然后范围 T 为基本接口类型。这仅在您希望从您的接口而不是框架中现有的任何接口派生泛型时才有效。

```
public interface BaseInterface
{
}

public interface Interface1 : BaseInterface
{
    void SomeMethod();
}

public interface Interface2 : BaseInterface
{
    void SomeOtherMethod();
}

public class MyGenericClass<T> where T : BaseInterface
{
    ...
}

var myClass1 = new MyGenericClass<Interface1>();

var myClass2 = new MyGenericClass<Interface2>(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T04:39:13.740

不，你不能这样做。这根本没有意义。

你能做的最好的事情是创建你的泛型类的 2 个空子类，并使泛型类抽象。像这样：

```
abstract class MyGenericClass<T>
{
  ...
}

public class MyClass1<T> : MyGenericClass<T>, IInterface1
{ }

public class MyClass2<T> : MyGenericClass<T>, IInterface2
{ } 
```

# c# - WPF：使用计时器在线程中构建队列

> ID：525161
> 
> 赞同：3
> 
> 时间：2009-02-08T04:36:13.403
> 
> 标签：c#, wpf, multithreading, timer, dispatcher

参考[我目前正在从事的软件项目](https://stackoverflow.com/questions/505040/developing-a-robocode-type-game-with-net-for-a-school-assignment)。

我有以下方法，它们基本上使用计时器移动画布：

```
DispatcherTimer dt = new DispatcherTimer(); //global
public void Ahead(int pix)
    {
            var movx = 0;
            var movy = 0;
            dt.Interval = TimeSpan.FromMilliseconds(5);
            dt.Tick += new EventHandler((object sender, EventArgs e) =>
            {
                if (movx >= pix || movy >= pix)
                {
                    dt.Stop();
                    return;
                }
                Bot.Body.RenderTransform = new TranslateTransform(movx++, movy++);
            });
            dt.Start();
    }
public void TurnLeft(double deg)
    {

        var currAngle = 0;
        dt.Interval = TimeSpan.FromMilliseconds(5);
        dt.Tick += new EventHandler(delegate(object sender, EventArgs e)
        {
            if (currAngle <= (deg - (deg * 2)))
            {
                dt.Stop();
            }
            Bot.Body.RenderTransform = new RotateTransform(currAngle--, BodyCenter.X, BodyCenter.Y);
        });
        dt.Start();
    } 
```

现在，从另一个库中，这些方法的调用方式如下：

```
public void run()
{
    Ahead(200);
    TurnLeft(90);
} 
```

现在当然，我希望这些动画一个接一个地发生，但是发生的情况是，当调用第二个方法（在本例中为）时，`dt.Tick`事件处理程序被覆盖，因此，只有第二个方法被执行应该。`DispatchTimer``TurnLeft(90)`

我需要创建某种队列，允许我将方法推送和弹出到该队列，以便`dt`（`DispatchTimer`计时器）一个接一个地执行它们……按照它们在“队列”中的顺序

我有什么办法可以做到这一点？我是在正确的轨道上，还是完全偏离了轨道？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T07:01:46.167

当您在 Dispatcher 上调用 Invoke() 或 BeginInvoke() 时，操作将排队并在与 Dispatcher 关联的线程空闲时运行。因此，不要使用 Tick 事件，而是使用采用 Timespan 的 Dispatcher.Invoke 的重载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T05:33:50.233

我自己解决了这个问题。我所做的是创建一个全局`Queue`类型`Delegate`，而不是直接执行这些方法，而是将它们添加到这个队列中。

然后我将在构造函数中有一个单独的线程，它将逐个出列方法并执行它们：

```
 Queue<TimerDelegate> eventQueue = new Queue<TimerDelegate>();

    public Vehicle(IVehicle veh, Canvas arena, Dispatcher battleArenaDispatcher)
    {
         DispatcherTimer actionTimer = new DispatcherTimer() { Interval = TimeSpan.FromMilliseconds(100) };
         actionTimer.Tick += new EventHandler(delegate(object sender, EventArgs e)
    {
        if (IsActionRunning || eventQueue.Count == 0)
        {
            return;
        }
        eventQueue.Dequeue().Invoke(new DispatcherTimer() { Interval = TimeSpan.FromMilliseconds(5) });
    });
    actionTimer.Start();
    }

    public void TurnRight(double deg)
    {
        eventQueue.Enqueue((TimerDelegate)delegate(DispatcherTimer dt)
        {
            IsActionRunning = true;
            var currAngle = 0;
            dt.Tick += new EventHandler(delegate(object sender, EventArgs e)
            {
                lock (threadLocker)
                {
                    if (currAngle >= deg)
                    {
                        IsActionRunning = false;
                        dt.Stop();
                    }
                    Rotator_Body.Angle++;
                    currAngle++;
                }
            });
            dt.Start();
        });
    } 
```

# jquery - PartialView 是否做我认为应该做的事情（但没有做）？

> ID：525162
> 
> 赞同：3
> 
> 时间：2009-02-08T04:36:33.340
> 
> 标签：jquery, asp.net-mvc, ajax

我在 ASP.NET MVC 页面上有一个 div，我想使用 jQuery 动态填充（根据用户请求）。我目前有 jQuery 对我的控制器进行 JSON 调用，它返回一个 JSON 对象，然后我使用 Javascript 手动构建 HTML，然后将其放置在 div 中。

等一下。让控制器自己生成 HTML（使用自定义控件（.ascx 文件））然后只返回要放置在 div 中的字符串不是更容易吗？

更简单，更简单！

我目前的尝试涉及以下 javascript：

```
$('#MyDiv').load("/MyController/GetList"); 
```

调用以下控制器方法：

```
public PartialViewResult GetList()
{
    ... create model ...
    var result = PartialView("CategoryList", model);
    return result;
} 
```

问题是，我完全没有得到控制器的响应。它被正确调用（如断点所证明），但 Firebug 甚至没有在 Net 视图中注册对控制器的调用（尽管调用确实显示了 Firebug 控制台窗口，但响应为空白）。

此外，.ascx 文件中的 Debug.Print 命令会产生输出，因此 jQuery 调用和 PartialView 方法肯定会触发。

PartialView（和 PartialViewResult）是用来做什么的，我应该做什么来代替它？

提前致谢。

哦，它正在使用候选发布版......如果这有所作为。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T00:05:43.697

在我发现的最奇怪的修复之一中，似乎（在我的情况下）添加一个

```
<html><head><title></title></head><body> 
```

在用户控制代码之前，以及

```
</body></html> 
```

在用户控制代码之后，解决了这个问题。没有这些，控件将不返回任何内容。

现在，这很可能是由于网站从 Preview 3 -> Preview 4 -> Preview 5 -> Beta -> RC1 演变而导致的一些奇怪问题，所以如果我是唯一的人，我不会感到惊讶在世界上得到这个问题，但你有它。

如果有人确实找到了更好的答案，请在此处添加...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T06:55:30.750

它在这里工作。你确定调用了 jquery load() 吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T07:49:23.670

我不想问，但是您是否在某处包含 jquery 脚本？其他人多次问我为什么 jQuery 不使用他们的 MVC 项目。解决方案是向他们的母版页添加标签。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T23:56:28.233

嘿，Darren，你可以尝试使用[Fiddler2](http://www.fiddler2.com/fiddler2/)并查看它显示的响应吗？我有一种感觉，如果正在执行部分视图，如您所说，这可能不是 MVC 的问题。这里有一些尝试将问题归结为核心的东西。

当您向 /MyController/GetList 发出直接请求时，它是否返回正确的 HTML？

将“foo.html”文件添加到您的网站，其中包含您期望从部分获得的 HTML 输出。更改您的 jQuery 代码以请求该 foo.html 代替：

```
$('#MyDiv').load("/foo.html"); 
```

那样有用吗？使用 jQuery 中的 load 方法可以做的一件事是提供一个 CSS 选择器。因此，作为一种解决方法，您可以像在其他答案中所做的那样用 HTML 头、正文标签包装部分内容，然后将 CSS 选择器添加到 load 方法中以仅获取您想要的部分，如下所示：

```
$('#MyDiv').load("/MyController/GetList #stuff-i-want"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T16:30:03.300

它对我有用。我创建了一个示例

风景

```
<div id="sam"></div>

<% var url = Url.Action("GetList"); %>
<script type="text/javascript">
    $(document).ready(function() {
        $('#sam').load('<%=url%>');
    });
</script> 
```

部分视图 - GetList.ascx

```
<%@ Control Language="C#" Inherits="ViewUserControl<IEnumerable<string>>" %>
<ul>
<% foreach (var s in Model) { %>
    <li><%=Html.Encode(s)%></li>
<% } %>
</ul> 
```

控制器

```
[AcceptVerbs(HttpVerbs.Get)]
public PartialViewResult GetList()
{
    return PartialView(new[] { "Hello", "Foo", "Bar" });
} 
```

希望这可以帮助。

# html - 为什么是 邪恶的，而不是？

> ID：525168
> 
> 赞同：22
> 
> 时间：2009-02-08T04:46:27.330
> 
> 标签：html, css

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-02-08T05:03:39.713

如果为每个先前存在的样式标签创建一个语义双胞胎，我们要做的就是同样的旧事情，尽管有了新的名称。

`<strong>`并`<em>`用于为标记的文本赋予意义。他们的默认样式对应于`<b>`并且`<i>`因为这是大多数人在印刷品中展示力量和重点的方式——但这可以改变。而使用 CSS 更改 a`<b>`可能看起来违反直觉。

因此，您的问题的直接答案是：赋予文本*含义*，而`<strong>`其他赋予文本*样式*，现在由 CSS 完成。其他人应用的样式是偶然的。`<em>`*`<u>`*

 *** * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-08T04:48:07.967

它被误认为是超链接。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-08T04:53:24.397

`font-weight:bold`不等于`strong`。该`strong`标签默认具有该属性，但您可以随意将其设为下划线或变为红色或其他任何您喜欢的内容。这就是重点：它没有指定样式。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-08T13:00:51.137

> <strong> 是什么语义？强烈强调文字？<em> 是什么语义？

“强调”和“强调”的定义不明确，语义含量很低。

您可以提出自己的解释：例如，我个人使用：

*   <em> 用于在大声说出时会*强调的句子部分*

*   <strong> 用于需要视觉挑选的文本片段：例如**特别重要的句子**和视觉扫描**关键字**。

这是一致的，并且在某种程度上符合典型用途，但它不是 HTML 强制要求的。

> 和 <i> 作为 <em>

<em> 即使不考虑样式问题，也不是与斜体的 1:1 匹配。使用斜体还有其他原因，包括：

*   <cite>其他作品，根据*HTML 4.01 规范*

*   从其他语言中挑选短语到正文中，这是 <span lang="fr">*存在的理由*

> 为什么 <u> 没有语义双胞胎

因为每个人都讨厌<u>。

即使在 HTML2 时代，它也很少使用，因为它太丑了。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-08T13:25:28.530

下划线是打字机时代遗留下来的。当时没有斜体和粗体的选项，所以强调单词的唯一方法是使用下划线。下划线的好处（从打字机设计师的角度来看）是您可以修改现有字符，因此您不需要一整套额外的字符。

它不漂亮，不再需要它，所以请改用斜体或粗体。

这个问题更加明显，因为下划线是 HTML 中链接的标准装饰。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-08T14:05:33.067

> 在造型方面：
> 
> 所以有一个 CSS 样式的 text-decoration:underline for ， `<u>`但现在还没有吗？也如此。`font-weight:bold``<strong>``<em>`

`<strong>`不， or没有 CSS 样式`<em>`。有粗体的 CSS 标签，但这不是一回事。strong 和 em*并不*意味着大胆。他们的意思是强调。强调可以在文本媒体中使用下划线、斜体或粗体来完成，这取决于样式表来决定哪一个。但语义只是“强调此文本”。您将如何在屏幕阅读器中实现“下划线”？这没有意义。下划线特定于文本媒体，因此属于用于文本呈现的特定样式表，而不属于可用于通过语音或任何其他媒体呈现数据的语义 HTML。

> 在语义上：
> 
> `<strong>`语义是为了什么？强烈强调文字？`<em>`语义是为了什么？强调文字？有什么根本不同且相互排斥的吗？不。为什么不能有其他方法来强调文本？你知道，就像 `<u>`这样

因为 strong 和 em 没有指定文本应该*如何*强调，只是应该强调它。下划线指定*如何*强调它，因此它与表示有关，而不是语义，并且属于 CSS 文件。我同意 strong 和 em 之间的区别是模糊的，但话又说回来，我们也有 h1-h7。关键是即使没有样式表，读者也应该能够推断出“这个标题比那个大”，因此“这个文本比那个大*”*强调比那更重要”。标签的语义不必彼此根本不同。具有仅表示“比其他语义标签更重要”的语义标签是完全有意义的。因为有时我们需要多层我们的文本中的标题，所以我们有 h1-h7。有时我们需要强调的文本，以及*非常*强调的文本。但即使我们没有，它仍然不会成为添加的借口`<u>`作为“另一个语义双胞胎”，因为它不是。它不是语义双胞胎，它*什么都不是*在语义上。下划线不一定意味着强调。它也可能意味着标题，或者它可能意味着“这是一个链接”，或者它可能意味着你想要它意味着的任何其他东西。这是一个演示细节。在非文本媒体中是没有意义的。“强调”不是演示细节。它带有一种语义，无论媒体如何，它都是有意义的。您也可以在电影、视频游戏或朗读文本中强调信息。

您似乎认为 strong 和 em 只是粗体或斜体的简写（或速记）。这不是真的。它们可用于显示粗体文本、带下划线的文本、斜体文本或更大的文本。或者可以完全忽略它们。或者他们可能只是改变屏幕阅读器中的发音。如果您曾经在 中编写过文档`LaTeX`，您会注意到那里的`\emph`命令通常呈现为斜体，而不是粗体。当然不是必须的，但这是对语义“强调”命令的完全合法解释。类似地，还有许多其他标签可能最终呈现为斜体（引号，或具有某些 CSS 类甚至标题的跨度标签。
`<u>`另一方面，在表示中具有非常特定的含义，但没有语义价值。它向读者传达了什么信息？`<strong>`带有“此文本被突出显示，应引起注意”的意思，因为它被强烈强调。文本加下划线是什么意思？它可能毫无意义，也可能意味着十几种不同的东西。“斜体”、“粗体”或“下划线”是没有语义意义的表示属性。它们可以应用于您喜欢的任何语义 HTML 标记。像 strong 或 em 这样的语义标签可以使用任何你喜欢的展示 CSS 规则。您似乎相信没有 1:1 映射。它们是不同的概念。浏览器默认选择将强文本呈现为粗体这一事实完全无关紧要。那'*something*，它可以在 CSS 中被覆盖。

这不是“这可以在 CSS 中完成”或“这是它的语义孪生吗”的问题，而只是“它是否具有语义意义？它是否具有表示意义”？如果两者都是，则应完全更改和/或删除它。如果前者是，它属于 HTML，如果是后者，它属于 CSS。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-17T22:30:00.600

<u> 的语义孪生是<a>。^_^ 这有点滑稽，但这是真的。在网络上，带下划线的文本默认表示链接；这种模式非常古老和成熟，几乎网络上的每个（有视力的）人都会自动将其作为他们与页面交互的一部分。

HTML5 为 <em> 和 <strong> 定义了稍微不同的含义，特别是这样您*就不会*只有两个标签在语义上做同样的事情。这只会引发像你这样的问题，你想知道为什么不只有第三种方式来强调默认情况下带有下划线的演示文稿（或你有什么）。

在 HTML5 中，<em> 仍然表示强调。使用 <em> 通过将焦点放在特定的单词或短语上来改变句子的含义。另一方面，<strong> 表示*重要性*。将单词或短语标记为重要不会改变句子的含义，它只会引导您的注意力。

像往常一样，关于 <em> 默认以斜体呈现并且 <strong> 默认以粗体文本呈现的标准警告，但是完全有可能并且适当地更改两者的呈现方式，适用。例如，屏幕阅读器可能对两个标签使用不同的变形。这就是语义存在的全部原因——这样我们就可以让演示者决定呈现数据的最佳方式；我们这些凡人作家不可能在所有可能的媒介中都得到正确的呈现。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-23T15:36:16.753

对于排版师来说，下划线和粗体是增强内容的两种方法。大多数人认为下划线比粗体文本更难看，因此它通常保留在粗体不可用的情况下——例如在打字机上、手写内容或用铅笔标记内容时。

如果你真的想要下划线，这样做是完全有效的：

```
<style>
    strong {
        font-weight: normal;
        text-decoration: underline;
    }
</style> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-08T05:36:46.463

网络只是不适合带下划线的文本。我同意 Greg 的观点，它很容易与链接混淆。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-08T05:40:06.363

它不是语义的。我们生活在一个代码中语义越来越重要的世界，因为我们厌倦了试图破译其他一些编码人员“这对我来说很有意义”的混乱。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-08T07:33:23.140

**下划线很丑陋**，无论是在书本上还是在网络上。所以它应该只用于强调手写文本，没有其他选择。

# c# - 在 URL 或 Session 或其他中存储语言

> ID：525176
> 
> 赞同：10
> 
> 时间：2009-02-08T05:03:24.580
> 
> 标签：c#, asp.net, internationalization, multilingual

我正在开发一个多语言网站，想知道存储用户选择的语言的最佳方式是什么？

通过 QueryString 还是应该在 Session.. 或任何其他选项中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-12-29T11:52:15.563

其他任何答案中未提及的另一个考虑因素是搜索引擎友好性。如果您为每种语言使用不同的网址，例如

```
http://{en|cy}.example.com/subdir/ 或http://example.com/ {en|cy}/subdir)
```

然后搜索引擎可以用多种语言为您的网站编制索引。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T07:15:21.617

我认为这在很大程度上取决于您的应用程序如何处理（希望处理）用户语言。如果您的用户必须登录到您的站点，那么您可能在某个地方有一个帐户设置页面，其中包含适当的用户配置文件对象或类似的东西。在这种情况下，我猜您会将这些设置保存在数据库中，当用户返回您的站点时，您会以某种方式（即从 cookie）获取用户信息，然后从数据库中加载您的用户配置文件对象。这些信息将保存在一个会话中，因为我认为这最适合这种情况。如果您的用户不必登录，因此您基本上无法直接识别他们，我会将语言设置存储在 cookie 中。这为您的用户提供了这样的价值，即当他稍后回来时，他将始终以他的首选语言找到该网站（假设他没有 t 删除 cookie 并且 cookie 的生命周期足够长）。作为第三种可能性，您可以根据用户的默认浏览器设置来识别用户语言（就像上面提到的“正则表达式”）。

正如我所说，这实际上取决于您的应用程序的需求。你必须记住的是

*   存储在会话中的对象使用服务器内存保存在服务器端。因此，如果您不需要它们，请不要将无用的东西保留在内存中。然而，会话对象适用于存储与用户访问和配置相关的数据。
*   存储在 cookie 或 Viewstate 对象中的数据在客户端浏览器和 Web 服务器之间来回发送。因此，这会导致额外的流量并可能降低性能。

再见

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-08T17:00:14.190

如果您考虑这种情况，其中用户浏览了“en”中的一系列页面并且语言信息存储在 cookie 会话中并且页面已被缓存（http、浏览器、应用程序）.​​.

当用户将语言切换到“cy”时，当前页面会发生变化，但是当用户跳回到他们之前访问过的页面时（标题缓存已过期但尚未过期），它会加载“en”中的页面，因为查询字符串没有说​​明语言 - 因为它以该语言提供内容。

用户不太可能想要如此频繁地更改语言 - 但作为开发人员，这是一个应该处理的场景。

任何想法请随时大喊。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-08T05:08:42.137

[配置文件属性](http://msdn.microsoft.com/en-us/library/at64shx3(VS.85).aspx)是专门创建的，允许您存储特定于用户的首选项。这将是存储此类数据的好地方。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-08T05:14:11.517

当浏览器发出您可以使用的请求时，会传递一个属性。此属性在您的代码中通过引用来引用：

```
Request.UserLanguages // returns an array 
```

或者，您可以提示用户指定首选语言，并将其保存在 cookie 中。

在您的 Page.Load 处理程序中放置如下内容：

```
string prefLan;    
if(Request.Cookies["preferedLanguage"] != null)
        prefLan = Server.HtmlEncode(Request.Cookies["preferedLanguage"].Value); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-08T05:25:47.390

Querystring 不适合这样做，除非它最初是从查询字符串中读取并存储在其他地方的。

将其存储在 cookie 中，或者如果 cookie 已关闭，则将其存储在 session 或 viewstate 中。

Kevin 的回答“配置文件属性”是一种简单的方法，可以让已建立的库以最少的努力为您完成繁重的工作。

# sql-server - 如何删除数据库，错误5030 数据库无法锁定

> ID：525185
> 
> 赞同：9
> 
> 时间：2009-02-08T05:14:26.180
> 
> 标签：sql-server

我正在尝试删除 SQL Server 2005 中的现有数据库。我的第一次尝试产生了以下错误：

> 5030: 无法以独占方式锁定数据库以执行操作。

我已经杀死了所有正在访问数据库的进程。我还删除了它之前参与的复制订阅。

除了 SQL Server 进程和复制之外，还有什么其他可能会锁定它的想法？

**更新**：我重新启动了服务器，并修复了它。我试图避免这种情况，因为这是一个生产服务器，但是你能做什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-11-23T20:05:04.280

有这么多连接使用数据库的生产服务器，但您想删除它吗？:)

尽管如此，如何从数据库中踢出所有人：

```
USE [dbname];
ALTER DATABASE [dbname] SET SINGLE_USER WITH ROLLBACK IMMEDIATE; 
```

然后删除数据库：

```
USE [master];
DROP DATABASE [dbname]; 
```

`USE [master];`在其他连接可以获取数据库上的 1 个允许锁的位置和其他连接之间仍然有一个非常小的机会窗口`DROP DATABASE ...`，但通常不值得解决这个问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-08T05:19:26.403

我不想这么说，但一个快速的解决方案是重新启动系统，确保 sql server server 服务没有启动，然后你应该可以删除。

另外，如果您的数据库连接到网络应用程序，IIS 是否会停止？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-08T05:34:17.623

您不知道是否有人将事务留在未完成的回滚状态（或未完成）？不妨也检查一下锁列表。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-08T05:19:55.297

在管理工作室中，转到管理-> 活动监视器（右键单击）-> 查看进程。这将为您提供所有正在运行的所有内容的完整列表，您可以按数据库对列表进行排序以查看仍然附加的内容，您还可以终止任何连接。很容易以孤立的连接结束，这将阻止您获得所需的独占访问权限。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-08T05:19:53.720

没有人应该使用数据库，包括你自己。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-16T05:37:19.053

当您的数据库处于多用户模式时，通常会发生此错误，其中用户正在访问您的数据库或某些对象正在引用您的数据库。首先，您应该将数据库设置为单用户模式：

```
ALTER DATABASE dbName
SET SINGLE_USER WITH ROLLBACK IMMEDIATE 
```

现在我们将尝试删除数据库

```
delete DATABASE ... 
```

最后将数据库设置为多用户模式

```
ALTER DATABASE dbName
SET MULTI_USER WITH ROLLBACK IMMEDIATE 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-13T07:55:41.020

为什么我们要将已删除的数据库设为多用户模式。

```
ALTER DATABASE dbName SET MULTI_USER WITH ROLLBACK IMMEDIATE 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-10-28T20:26:16.550

为避免此错误，请在 master 数据库中使用以下 T-SQL 脚本。确保为您正在运行 ALTER DATABASE 命令的每个数据库运行此命令（并修改 @dbname）。

> “无法以独占方式锁定数据库以执行操作”

如果 Windows 已建立到数据库的 JDBC 连接，则此“连接杀手”脚本将起作用。但是这个脚本无法终止 Linux 服务（例如 JBoss）的 JDBC 连接。因此，如果您不手动停止 JBoss，您仍然会收到该错误。我没有尝试过其他协议，但是如果您在构建新系统时发现更多信息，请发表评论。

```
USE master;

DECLARE @dbname sysname

Set @dbname = 'DATABASE_NAME_HERE-PROD'

Declare @spid int
Select @spid = min(spid) from master.dbo.sysprocesses
where dbid = db_id(@dbname)
While @spid Is Not Null
Begin
        Execute ('Kill ' + @spid)
        Select @spid = min(spid) from master.dbo.sysprocesses
        where dbid = db_id(@dbname) and spid > @spid
End 
```

# anti-patterns - 拥有一个无处不在的基础对象是一种反模式吗？

> ID：525186
> 
> 赞同：4
> 
> 时间：2009-02-08T05:14:50.407
> 
> 标签：anti-patterns, oop

我记得在某处看到过关于此的辩论，并且目前正在考虑删除我正在处理的系统中的每个业务对象继承的基础对象。它包含一些属性、一些数据库逻辑和一些构造函数逻辑。

这是一个反模式，还是陪审团还在外面？有一个基础合同来继承会更好吗，这需要在每个对象中完成一定数量的样板编码？

**编辑**：我确实喜欢 dsimcha 并且觉得它很好地反映了这个问题，我仍然很高兴听到任何进一步的答案

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-08T05:17:57.670

标准的经验法则是仅使用继承通过多态性为类的用户提供灵活性，如果您想重用来自其他类的代码，则使用组合。但是，只要您不违反[Liskov 替换原则](http://en.wikipedia.org/wiki/Liskov_substitution_principle)，它可能还不错。编写大量样板代码本质上也是一件坏事，因为它会掩盖代码中发生实际操作的部分并且是反 DRY 的。但是，如果您违反了 Liskov 替换原则，那么这绝对是一个坏主意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T06:04:51.430

> 我也想了解我可能会遇到什么问题，或者应该注意什么

一个潜在的问题是，如果您使用多重继承：您的子类会继承“Eve”类的两个实例……这就是 C++ 支持所谓的虚拟继承的原因。

这是一个常用的习惯用法：例如，在 .Net 中，一切都派生自`System.Object`... 和/或，所有 COM 对象都实现 IQueryInterface 接口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-08T05:47:31.310

没有什么是真空中的反模式。你的“夏娃课”给你带来麻烦了吗？您希望从删除它中获得什么好处？询问它是否在[一些标准的反模式列表中](http://en.wikipedia.org/wiki/Anti-pattern)只有在有助于识别实际问题时才有帮助。

# c# - LINQ 内连接与左连接

> ID：525194
> 
> 赞同：42
> 
> 时间：2009-02-08T05:21:46.277
> 
> 标签：c#, .net, linq, left-join

使用扩展语法我试图在我拥有的两个列表上使用 LINQ 创建左连接。以下来自 Microsoft 帮助，但我已对其进行了修改以显示宠物列表没有任何元素。我最终得到的是一个包含 0 个元素的列表。我认为这是因为内部连接正在发生。我想要结束的是一个包含 3 个元素（3 个 Person 对象）的列表，其中为缺失的元素填充了空数据。即左连接。这可能吗？

```
Person magnus = new Person { Name = "Hedlund, Magnus" };
Person terry = new Person { Name = "Adams, Terry" };
Person charlotte = new Person { Name = "Weiss, Charlotte" };

//Pet barley = new Pet { Name = "Barley", Owner = terry };
//Pet boots = new Pet { Name = "Boots", Owner = terry };
//Pet whiskers = new Pet { Name = "Whiskers", Owner = charlotte };
//Pet daisy = new Pet { Name = "Daisy", Owner = magnus };

List<Person> people = new List<Person> { magnus, terry, charlotte };
//List<Pet> pets = new List<Pet> { barley, boots, whiskers, daisy };
List<Pet> pets = new List<Pet>();

// Create a list of Person-Pet pairs where 
// each element is an anonymous type that contains a
// Pet's name and the name of the Person that owns the Pet.
var query =
    people.Join(pets,
                person => person,
                pet => pet.Owner,
                (person, pet) =>
                    new { OwnerName = person.Name, Pet = pet.Name }).ToList(); 
```

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-02-08T06:04:55.533

我认为如果你想使用扩展方法，你需要使用[GroupJoin](http://msdn.microsoft.com/en-us/library/bb534805.aspx)

```
var query =
    people.GroupJoin(pets,
                     person => person,
                     pet => pet.Owner,
                     (person, petCollection) =>
                        new { OwnerName = person.Name,
                              Pet = PetCollection.Select( p => p.Name )
                                                 .DefaultIfEmpty() }
                    ).ToList(); 
```

您可能不得不使用选择表达式。我不确定在你有一对多关系的情况下它会满足你想要的。

我认为使用 LINQ 查询语法会更容易一些

```
var query = (from person in context.People
             join pet in context.Pets on person equals pet.Owner
             into tempPets
             from pets in tempPets.DefaultIfEmpty()
             select new { OwnerName = person.Name, Pet = pets.Name })
            .ToList(); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-08T06:50:38.250

您需要将连接的对象放入一个集合中，然后像JPunyon 所说的那样应用 DefaultIfEmpty：

```
Person magnus = new Person { Name = "Hedlund, Magnus" };
Person terry = new Person { Name = "Adams, Terry" };
Person charlotte = new Person { Name = "Weiss, Charlotte" };

Pet barley = new Pet { Name = "Barley", Owner = terry };
List<Person> people = new List<Person> { magnus, terry, charlotte };
List<Pet> pets = new List<Pet>{barley};

var results =
    from person in people
    join pet in pets on person.Name equals pet.Owner.Name into ownedPets
    from ownedPet in ownedPets.DefaultIfEmpty(new Pet())
    orderby person.Name
    select new { OwnerName = person.Name, ownedPet.Name };

foreach (var item in results)
{
    Console.WriteLine(
        String.Format("{0,-25} has {1}", item.OwnerName, item.Name ) );
} 
```

输出：

```
Adams, Terry              has Barley
Hedlund, Magnus           has
Weiss, Charlotte          has 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-02T17:08:39.487

我遇到同样的问题时出现以下错误消息：

**join 子句中的表达式之一的类型不正确。调用“GroupJoin”时类型推断失败。**

当我使用相同的属性名称时解决了，它起作用了。

(...)

```
join enderecoST in db.PessoaEnderecos on 
    new 
      {  
         CD_PESSOA          = nf.CD_PESSOA_ST, 
         CD_ENDERECO_PESSOA = nf.CD_ENDERECO_PESSOA_ST 
      } equals 
    new 
    { 
         enderecoST.CD_PESSOA, 
         enderecoST.CD_ENDERECO_PESSOA 
    } into eST 
```

(...)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-10T19:49:20.387

这是一篇很好的博客文章，刚刚由 Fabrice（LINQ in Action 的作者）发布，其中涵盖了我提出的问题中的材料。我把它放在这里供参考，因为问题的读者会发现这很有用。

[将 LINQ 查询从查询​​语法转换为方法/运算符语法](http://weblogs.asp.net/fmarguerie/archive/2009/02/06/converting-linq-queries-from-query-syntax-to-method-operator-syntax.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-08T05:30:03.873

使用 DefaultIfEmpty() 方法可以在 LINQ 中进行左连接。不过，我没有适合您的情况的确切语法...

实际上，我认为如果您只是在查询中将 pets.DefaultIfEmpty() 更改为它可能会起作用......

编辑：我真的不应该在很晚的时候回答事情......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-08-18T08:21:43.503

如果你真的有一个数据库，这是最简单的方法：

```
var lsPetOwners = ( from person in context.People
                    from pets in context.Pets
                        .Where(mypet => mypet.Owner == person.ID) 
                        .DefaultIfEmpty()
                     select new { OwnerName = person.Name, Pet = pets.Name }
                   ).ToList(); 
```

# sharepoint - SharePoint/MOSS 的默认日志位置在哪里？

> ID：525197
> 
> 赞同：24
> 
> 时间：2009-02-08T05:25:17.360
> 
> 标签：sharepoint, moss

我在挖掘后找到了答案，并认为我将它存储在这里。C:\Program Files\Common Files\Microsoft Shared\web 服务器扩展\12\LOGS

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-09T07:33:27.427

SharePoint 使用许多不同的日志记录机制。最重要的是，您可以通过 Central Admin 配置日志的位置。为了让您了解所涉及的日志，这里引用了[http://raiumair.wordpress.com/2007/06/19/quick-a-to-z-of-sharepoint-logs/](http://raiumair.wordpress.com/2007/06/19/quick-a-to-z-of-sharepoint-logs/)

> 所有基于文件的日志都可以由文本编辑器读取，并且可以使用流行的日志解析工具（Microsoft 的 Log Parser 2.2 或 Funnel Web）进行解析。阅读通常保存在（系统驱动器）：\WINDOWS\system32\LogFiles 的 IIS 日志也是一个好主意
> 
> a) 诊断日志
> 
> · 事件限制日志——这些最终进入 Windows 事件日志并且可以在事件查看器中查看。它们显示错误和警告。
> 
> · 跟踪日志——这些显示在 Web 请求或服务执行期间发出的详细的逐行跟踪信息。它们最终存储在前端服务器上的已知位置。默认位置：（系统驱动器）：\Program Files\Common Files\Microsoft Shared\Web Server Extensions\12\LOGS\
> 
> b) 审核日志 - 它们最终出现在关联的内容数据库表中，并且可以使用 Web 浏览器在站点集合级别和站点级别进行查看。WSS 3.0 和 MOSS 2007 使用不同的页面来显示审核日志报告。
> 
> c) 使用日志——它们本地存储在前端服务器上，并通过 SSP 在本地和场级别进行处理（这是基于设置，因为我了解本地处理的结果由 SSP 合并）并且可以在站点级别和站点集合级别查看。默认位置：（系统驱动器）：\Program Files\Common Files\Microsoft Shared\Web Server Extensions\12\Logs
> 
> d) 搜索\查询日志 - 这些保存在相关的 SSP 数据库中，但可以通过 Web 浏览器在 SSP 级别查看，也可以通过转到设置页面在站点集合级别的 MOSS 中查看。
> 
> e) 信息管理日志——存储在相关的内容数据库中，可以在站点集合级别查看。
> 
> f) 内容和结构日志 - 此选项仅在启用发布功能后可用。此商店保存在与网站集关联的内容数据库中，并且可以通过转到设置页面在网站集级别查看。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-08T14:04:25.860

默认情况下，它们存储在这里：
**%commonprogramfiles%/Microsoft Shared/web server extensions/12/Logs**

使用**%commonprogramfiles%**使其适用于非英语系统。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-04-30T13:18:23.190

在 SharePoint 2013 中，它们存储在：

`%COMMONPROGRAMFILES%\Microsoft Shared\web server extensions\15\LOGS`

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-02-08T21:03:38.907

在 Sharepoint Server 2010 中，它们存储在这里：

```
"c:\Program Files\Common Files\Microsoft Shared\web server extensions\14\LOGS" 
```

要查看它们，您可以使用 Microsoft 的 ULS Viewer（不支持）。[http://ulsviewer.codeplex.com/](http://ulsviewer.codeplex.com/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-08T05:35:05.813

对于 Sharepoint 2007

**`C:\Program Files\Common Files\Microsoft Shared\web server extensions\12\LOGS`**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-13T11:03:47.060

**对于 SharePoint 2016**

```
%COMMONPROGRAMFILES%\Microsoft Shared\Web Server Extensions\15\Logs 
```

**对于 SharePoint 2013**

```
%COMMONPROGRAMFILES%\Microsoft Shared\Web Server Extensions\15\Logs 
```

**对于 SharePoint 2010**

```
%COMMONPROGRAMFILES%\Microsoft Shared\Web Server Extensions\14\Logs 
```

**对于 SharePoint 2007**

```
%COMMONPROGRAMFILES%\Microsoft Shared\Web Server Extensions\12\Logs 
```

> **注意：**可以通过打开管理中心 > 监控 > 报告 > 配置诊断日志来更改 sharePoint 跟踪日志路径
> 
> 有关更多详细信息，请查看[SHAREPOINT ULS查看器](https://blog.devoworx.net/2012/12/15/uls-viewer-tool/)

# wpf - 将 ControlTemplate 与用户控件混合使用是个好主意吗？

> ID：525198
> 
> 赞同：1
> 
> 时间：2009-02-08T05:25:44.083
> 
> 标签：wpf, user-controls, controltemplate

拥有同时支持s 和现有内容的用户控制 ( )是否可能并且是个**好主意？**我知道s 应该只在您从 Control ( ) 继承时使用，但我发现如果您的 UserControl.xaml 为空，您也可以使用它们。`public MyControl: UserControl``ControlTemplate``ControlTemplate``public MyControl: Control``UserControl`

想象一下，我有一个控件，它有两个并排的矩形，如下所示：

```
<Page xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"> 
    <Grid ShowGridLines="true" Height="100" Width="100"> 
        <Grid.ColumnDefinitions> 
            <ColumnDefinition/> 
            <ColumnDefinition/> 
        </Grid.ColumnDefinitions> 
        <Rectangle Name="left" Grid.Column="0" Height="90" Fill="LightBlue"/> 
        <Rectangle Name="right" Grid.Column="1" Height="100" Fill="LightGreen"/> 
    </Grid> 
</Page> 
```

我希望控件的用户能够用`FrameworkElement`他想要使用的任何东西替换这些矩形。所以我需要一个`ControlTemplate`.

但在 99% 的情况下，控件的用户对现有功能感到满意，所以我希望他能够说：

后面的代码：

```
mycontrol.Left.Fill = .... 
```

XAML：

```
<mycontrol>
<mycontrol.Left.Fill = "Red"/>
</mycontrol> 
```

这似乎是不可能的，因为如果我支持控件模板，我真的没有任何 UI 元素或 xaml。我只有文件后面的代码。我想我可以有一个`DependencyProperty` `Left`，但只要我没有某种容器来保存不会有多大好处的内容。我必须在文件后面的代码中创建网格。似乎不是一个好主意。

最后，我希望能够使用泛型，以便用户可以指定部件的类型：

```
MyControl mycontrol<TLeft, TRight> = new MyControl<Rectangle, Button>(); 
```

由于类型安全（无需`FrameworkElement`转换为正确的类型），这将有助于代码背后的代码。不幸的是，我认为 XAML 方面并不真正支持泛型。

有没有解决这个问题的方法，还是真的“从 Control 继承以支持`ControlTemplate`s 但失去控件的易用性。从 UserControl 继承以支持易用性但失去`ControlTemplate`支持”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-08T11:01:16.073

Add a dependency property to the control:

```
public static DependencyProperty LeftFillProperty = DependencyProperty.
   Register("LeftFill", typeof(Brush), typeof(MyControl));

public Brush LeftFill
{
   get { return (Brush)GetValue(LeftFillProperty); }
   set { SetValue(LeftFillProperty,value); }
} 
```

Then in the default control template use:

```
<Rectangle Name="left" Grid.Column="0" Height="90" Fill="{TemplateBinding LeftFill}"/> 
```

This will left you use (C#)

```
ctrl.LeftFill = Brushes.Red; 
```

or (XAML)

```
<c:MyControl LeftFill="Red"/> 
```

when you use the default template and when someone writes a new control template it's their responsibility to decide what to do with the LeftFill property (or to ignore it completely).

BTW, you should consider changing the names from "left" and "right" to something else ("MasterPanel" and "DetailPanel", "FoldersArea" and "FilesArea", whatever the logical usage in your control is), this will solve the issue of someone replacing the default template with a template that displays the same data in a different layout (top and bottom instead of left and right for example).

# android - Android 下载意图

> ID：525204
> 
> 赞同：36
> 
> 时间：2009-02-08T05:29:49.363
> 
> 标签：android, url, browser, download, android-intent

我想知道下载 URL 的目的是什么？在浏览器中，它将下载带有小通知图标的内容。我想知道我是否可以使用那个意图（以及它是什么）。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-01-27T12:25:15.660

应用程序可以像浏览器和 gmail 一样使用下载管理器下载文件。这可以从姜饼开始。

您的应用需要*INTERNET*权限才能启动下载。要将文件保存在默认下载目录中，它还需要*WRITE_EXTERNAL_STORAGE*权限。

下载 URI 的方法如下：

```
DownloadManager.Request r = new DownloadManager.Request(uri);

// This put the download in the same Download dir the browser uses
r.setDestinationInExternalPublicDir(Environment.DIRECTORY_DOWNLOADS, "fileName");

// When downloading music and videos they will be listed in the player
// (Seems to be available since Honeycomb only)
r.allowScanningByMediaScanner();

// Notify user when download is completed
// (Seems to be available since Honeycomb only)
r.setNotificationVisibility(DownloadManager.Request.VISIBILITY_VISIBLE_NOTIFY_COMPLETED);

// Start download
DownloadManager dm = (DownloadManager) getSystemService(DOWNLOAD_SERVICE);
dm.enqueue(r); 
```

还有许多其他选项可用于自定义通知、查询下载状态和设置下载位置。

[这篇博](http://blog.lytsing.org/archives/135.html)文展示了如何通过隐藏的 API 在早期版本的 Android 上使用下载管理器。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2010-05-30T09:09:34.023

虽然我不相信浏览器中有下载 Intent，但您可能可以使用普通`ACTION_VIEW`Intent 并让浏览器根据内容类型决定是下载还是查看 url。

所以从你的代码触发器

```
new Intent(Intent.ACTION_VIEW, Uri.parse(url)) 
```

并希望这会触发浏览器中的下载。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-08T06:18:37.970

你想做什么？如果您的应用想要下载文件，您可以使用 UrlConnection 代码。如果你想下载一个包，那么`ACTION_PACKAGE_INSTALL`应该做你想做的事。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-08T05:56:30.167

[在这里](http://developer.android.com/reference/android/content/Intent.html)查看所有 Android Intents。

# java - 如何从 Java 代码运行 Unix shell 脚本？

> ID：525212
> 
> 赞同：168
> 
> 时间：2009-02-08T05:32:25.037
> 
> 标签：java, unix, shell

从 Java 运行 Unix 命令非常简单。

```
Runtime.getRuntime().exec(myCommand); 
```

但是有可能从 Java 代码运行 Unix shell 脚本吗？如果是，从 Java 代码中运行 shell 脚本是否是一个好习惯？

* * *

## 回答 #1

> 赞同：182
> 
> 时间：2009-02-08T20:18:08.907

你真的应该看看[Process Builder](http://docs.oracle.com/javase/6/docs/api/java/lang/ProcessBuilder.html)。它真的是为这种事情而建造的。

```
ProcessBuilder pb = new ProcessBuilder("myshellScript.sh", "myArg1", "myArg2");
 Map<String, String> env = pb.environment();
 env.put("VAR1", "myValue");
 env.remove("OTHERVAR");
 env.put("VAR2", env.get("VAR1") + "suffix");
 pb.directory(new File("myDir"));
 Process p = pb.start(); 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2014-02-15T04:15:25.843

您也可以使用[Apache Commons exec 库](https://commons.apache.org/proper/commons-exec/)。

例子 ：

```
package testShellScript;

import java.io.IOException;
import org.apache.commons.exec.CommandLine;
import org.apache.commons.exec.DefaultExecutor;
import org.apache.commons.exec.ExecuteException;

public class TestScript {
    int iExitValue;
    String sCommandString;

    public void runScript(String command){
        sCommandString = command;
        CommandLine oCmdLine = CommandLine.parse(sCommandString);
        DefaultExecutor oDefaultExecutor = new DefaultExecutor();
        oDefaultExecutor.setExitValue(0);
        try {
            iExitValue = oDefaultExecutor.execute(oCmdLine);
        } catch (ExecuteException e) {
            System.err.println("Execution failed.");
            e.printStackTrace();
        } catch (IOException e) {
            System.err.println("permission denied.");
            e.printStackTrace();
        }
    }

    public static void main(String args[]){
        TestScript testScript = new TestScript();
        testScript.runScript("sh /root/Desktop/testScript.sh");
    }
} 
```

[为了进一步参考， Apache Doc](https://commons.apache.org/proper/commons-exec/commandline.html)上也给出了一个示例。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-02-08T05:41:23.973

我会说从 Ja​​va 运行 shell 脚本不*符合 Java 的精神。*Java 是跨平台的，运行 shell 脚本会将其使用限制在 UNIX 上。

话虽如此，绝对可以从 Java 中运行 shell 脚本。您将使用您列出的完全相同的语法（我自己没有尝试过，但尝试直接执行 shell 脚本，如果这不起作用，请执行 shell 本身，将脚本作为命令行参数传入） .

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-02-08T05:39:17.753

我想你已经回答了你自己的问题

```
Runtime.getRuntime().exec(myShellScript); 
```

至于这是否是一种好习惯......你想用一个你不能用Java做的shell脚本做什么？

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2013-03-04T14:25:57.113

是的，可以这样做。这对我有用。

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

import org.omg.CORBA.portable.InputStream;

public static void readBashScript() {
        try {
            Process proc = Runtime.getRuntime().exec("/home/destino/workspace/JavaProject/listing.sh /"); //Whatever you want to execute
            BufferedReader read = new BufferedReader(new InputStreamReader(
                    proc.getInputStream()));
            try {
                proc.waitFor();
            } catch (InterruptedException e) {
                System.out.println(e.getMessage());
            }
            while (read.ready()) {
                System.out.println(read.readLine());
            }
        } catch (IOException e) {
            System.out.println(e.getMessage());
        }
    } 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2016-07-27T06:09:07.903

这是我的例子。希望它有意义。

```
public static void excuteCommand(String filePath) throws IOException{
    File file = new File(filePath);
    if(!file.isFile()){
        throw new IllegalArgumentException("The file " + filePath + " does not exist");
    }
    if(isLinux()){
        Runtime.getRuntime().exec(new String[] {"/bin/sh", "-c", filePath}, null);
    }else if(isWindows()){
        Runtime.getRuntime().exec("cmd /c start " + filePath);
    }
}
public static boolean isLinux(){
    String os = System.getProperty("os.name");  
    return os.toLowerCase().indexOf("linux") >= 0;
}

public static boolean isWindows(){
    String os = System.getProperty("os.name");
    return os.toLowerCase().indexOf("windows") >= 0;
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-10-14T16:25:14.403

Yes, it is possible and you have answered it! About good practises, I think it is better to launch commands from files and not directly from your code. So you have to make Java execute the list of commands (or one command) in an existing `.bat`, `.sh` , `.ksh` ... files. Here is an example of executing a list of commands in a file `MyFile.sh`:

```
 String[] cmd = { "sh", "MyFile.sh", "\pathOfTheFile"};
    Runtime.getRuntime().exec(cmd); 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-11-18T23:16:02.430

为了避免硬编码绝对路径，您可以使用以下方法来查找并执行您的脚本（如果它位于您的根目录中）。

```
public static void runScript() throws IOException, InterruptedException {
    ProcessBuilder processBuilder = new ProcessBuilder("./nameOfScript.sh");
    //Sets the source and destination for subprocess standard I/O to be the same as those of the current Java process.
    processBuilder.inheritIO();
    Process process = processBuilder.start();

    int exitValue = process.waitFor();
    if (exitValue != 0) {
        // check for errors
        new BufferedInputStream(process.getErrorStream());
        throw new RuntimeException("execution of script failed!");
    }
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-07-10T09:47:23.457

对我来说，一切都必须简单。对于运行脚本只需要执行

```
new ProcessBuilder("pathToYourShellScript").start(); 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-07-30T14:34:27.273

[ZT Process Executor](https://github.com/zeroturnaround/zt-exec)库是 Apache Commons Exec的替代品。它具有运行命令、捕获其输出、设置超时等功能。

我还没有使用它，但它看起来相当有据可查。

文档中的一个示例：执行命令，将标准错误发送到记录器，将输出作为 UTF8 字符串返回。

```
 String output = new ProcessExecutor().command("java", "-version")
    .redirectError(Slf4jStream.of(getClass()).asInfo())
    .readOutput(true).execute()
    .outputUTF8(); 
```

其文档列出了与 Commons Exec 相比的以下优势：

*   改进了流的处理
    *   读/写流
    *   将标准错误重定向到标准输出
*   改进了超时处理
*   改进了退出代码的检查
*   改进的 API
    *   用于相当复杂的用例的一个衬垫
    *   一个内衬将过程输出转换为字符串
    *   访问可用的**Process**对象
    *   支持异步进程（**未来**）
*   [使用SLF4J API](http://www.slf4j.org/)改进了日志记录
*   支持多进程

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2018-10-25T08:24:06.643

这是一个如何从 Java 运行 Unix bash 或 Windows bat/cmd 脚本的示例。可以在脚本上传递参数并从脚本接收输出。该方法接受任意数量的参数。

```
public static void runScript(String path, String... args) {
    try {
        String[] cmd = new String[args.length + 1];
        cmd[0] = path;
        int count = 0;
        for (String s : args) {
            cmd[++count] = args[count - 1];
        }
        Process process = Runtime.getRuntime().exec(cmd);
        BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        try {
            process.waitFor();
        } catch (Exception ex) {
            System.out.println(ex.getMessage());
        }
        while (bufferedReader.ready()) {
            System.out.println("Received from script: " + bufferedReader.readLine());
        }
    } catch (Exception ex) {
        System.out.println(ex.getMessage());
        System.exit(1);
    }
} 
```

在 Unix/Linux 上运行时，路径必须是类 Unix（以 '/' 作为分隔符），在 Windows 上运行时 - 使用 '\'。Hier 是一个 bash 脚本 (test.sh) 的示例，它接收任意数量的参数并将每个参数加倍：

```
#!/bin/bash
counter=0
while [ $# -gt 0 ]
do
  echo argument $((counter +=1)): $1
  echo doubling argument $((counter)): $(($1+$1))
  shift
done 
```

打电话时

```
runScript("path_to_script/test.sh", "1", "2") 
```

在 Unix/Linux 上，输出为：

```
Received from script: argument 1: 1
Received from script: doubling argument 1: 2
Received from script: argument 2: 2
Received from script: doubling argument 2: 4 
```

Hier 是一个简单的 cmd Windows 脚本 test.cmd，它计算输入参数的数量：

```
@echo off
set a=0
for %%x in (%*) do Set /A a+=1 
echo %a% arguments received 
```

在 Windows 上调用脚本时

```
 runScript("path_to_script\\test.cmd", "1", "2", "3") 
```

输出是

```
Received from script: 3 arguments received 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-06-04T12:09:40.123

这是一个迟到的答案。但是，我想到了为未来的开发人员从 Spring-Boot 应用程序中获取要执行的 shell 脚本而付出的努力。

1.  我在 Spring-Boot 中工作，我无法从我的 Java 应用程序中找到要执行的文件，它正在抛出`FileNotFoundFoundException`. 我必须将文件保存在`resources`目录中，并且必须在应用程序启动时设置要扫描的文件，`pom.xml`如下所示。

    ```
    <resources>
        <resource>
            <directory>src/main/resources</directory>
            <filtering>true</filtering>
            <includes>
                <include>**/*.xml</include>
                <include>**/*.properties</include>
                <include>**/*.sh</include>
            </includes>
        </resource>
    </resources> 
    ```

2.  之后我在执行文件时遇到了麻烦，它正在返回`error code = 13, Permission Denied`。然后我必须通过运行这个命令来使文件可执行 -`chmod u+x myShellScript.sh`

最后，我可以使用以下代码片段执行该文件。

```
public void runScript() {
    ProcessBuilder pb = new ProcessBuilder("src/main/resources/myFile.sh");
    try {
        Process p;
        p = pb.start();
    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

希望能解决某人的问题。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-08T07:49:24.887

有可能，只需像任何其他程序一样执行它。只要确保你的脚本有正确的 #! (she-bang) 行作为脚本的第一行，并确保该文件具有执行权限。

例如，如果它是一个 bash 脚本，请将 #!/bin/bash 放在脚本的顶部，也可以 chmod +x 。

另外，如果这是一种好的做法，不，不是，尤其是对于 Java，但是如果它可以节省您大量移植大型脚本的时间，并且您不会为此获得额外的报酬；) 节省您的时间，执行脚本，并将移植到 Java 放在您的长期待办事项列表中。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-05-19T14:57:36.193

```
 String scriptName = PATH+"/myScript.sh";
  String commands[] = new String[]{scriptName,"myArg1", "myArg2"};

  Runtime rt = Runtime.getRuntime();
  Process process = null;
  try{
      process = rt.exec(commands);
      process.waitFor();
  }catch(Exception e){
      e.printStackTrace();
  } 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-10-10T00:59:34.243

就像 Solaris 5.10 一样，它的工作原理是这样`./batchstart.sh`的，我不知道你的操作系统是否接受它`\\. batchstart.sh`来代替它。这个双斜杠可能会有所帮助。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-06-10T09:39:33.390

我认为与

```
System.getProperty("os.name"); 
```

如果支持，检查操作系统可以管理 shell/bash 脚本。如果需要使代码可移植。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-03-29T08:06:27.460

供 Linux 使用

```
public static void runShell(String directory, String command, String[] args, Map<String, String> environment)
{
    try
    {
        if(directory.trim().equals(""))
            directory = "/";

        String[] cmd = new String[args.length + 1];
        cmd[0] = command;

        int count = 1;

        for(String s : args)
        {
            cmd[count] = s;
            count++;
        }

        ProcessBuilder pb = new ProcessBuilder(cmd);

        Map<String, String> env = pb.environment();

        for(String s : environment.keySet())
            env.put(s, environment.get(s));

        pb.directory(new File(directory));

        Process process = pb.start();

        BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        BufferedWriter outputReader = new BufferedWriter(new OutputStreamWriter(process.getOutputStream()));
        BufferedReader errReader = new BufferedReader(new InputStreamReader(process.getErrorStream()));

        int exitValue = process.waitFor();

        if(exitValue != 0) // has errors
        {
            while(errReader.ready())
            {
                LogClass.log("ErrShell: " + errReader.readLine(), LogClass.LogMode.LogAll);
            }
        }
        else
        {
            while(inputReader.ready())
            {
                LogClass.log("Shell Result : " + inputReader.readLine(), LogClass.LogMode.LogAll);
            }
        }
    }
    catch(Exception e)
    {
        LogClass.log("Err: RunShell, " + e.toString(), LogClass.LogMode.LogAll);
    }
}

public static void runShell(String path, String command, String[] args)
{
    try
    {
        String[] cmd = new String[args.length + 1];

        if(!path.trim().isEmpty())
            cmd[0] = path + "/" + command;
        else
            cmd[0] = command;

        int count = 1;

        for(String s : args)
        {
            cmd[count] = s;
            count++;
        }

        Process process = Runtime.getRuntime().exec(cmd);

        BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        BufferedWriter outputReader = new BufferedWriter(new OutputStreamWriter(process.getOutputStream()));
        BufferedReader errReader = new BufferedReader(new InputStreamReader(process.getErrorStream()));

        int exitValue = process.waitFor();

        if(exitValue != 0) // has errors
        {
            while(errReader.ready())
            {
                LogClass.log("ErrShell: " + errReader.readLine(), LogClass.LogMode.LogAll);
            }
        }
        else
        {
            while(inputReader.ready())
            {
                LogClass.log("Shell Result: " + inputReader.readLine(), LogClass.LogMode.LogAll);
            }
        }
    }
    catch(Exception e)
    {
        LogClass.log("Err: RunShell, " + e.toString(), LogClass.LogMode.LogAll);
    }
} 
```

和使用；

```
ShellAssistance.runShell("", "pg_dump", new String[]{"-U", "aliAdmin", "-f", "/home/Backup.sql", "StoresAssistanceDB"}); 
```

或者

```
ShellAssistance.runShell("", "pg_dump", new String[]{"-U", "aliAdmin", "-f", "/home/Backup.sql", "StoresAssistanceDB"}, new Hashmap<>()); 
```

# delphi - 虚拟键盘 - 将按钮点击发送到备忘录的最佳方式？

> ID：525215
> 
> 赞同：2
> 
> 时间：2009-02-08T05:35:46.450
> 
> 标签：delphi

我还在 D2007 上，需要创建一个支持 unicode 的虚拟键盘。所以我使用 TMS 的 unicode 按钮来模拟按键，但我想避免的是必须分配

```
mmo.Lines.Text := mmo.Lines.Text + Button1.Caption; 
```

约50次。必须有一种更好的方法来一次将一个字符发送到备忘录。有没有办法在 Object Inspector 中使用 Tag 属性并从那里分配一个值，或者如何？

你会怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-08T06:08:28.303

`OnClick`为所有按钮分配相同的事件处理程序。不要像上面那样用名称来引用每个按钮，而是`Button1`使用`Sender`参数。这就是它的用途。它告诉您触发了哪个控件的事件以导致处理程序运行。

`Sender`具有静态类型`TObject`。单击其中一个按钮时，`Sender`将具有运行时类型`TButton`或您正在使用的任何实际类。要让您的代码编译，您需要进行类型转换。例如：

```
procedure TKeyboardForm.ButtonClick(Sender: TObject);
begin
  mmo.Lines.Text := mmo.Lines.Text + (Sender as TButton).Caption;
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T18:14:56.853

某种速度按钮可能是按钮的更好选择，因为它们不会抓住焦点。然后闪烁的光标将保留在备忘录中。

您可以通过调整您使用的按钮的属性来获得相同的结果。我不知道 tms 按钮，但您可以尝试将 tabstop 设置为 false。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T21:41:01.500

我可能有点老了，我住在乡下，所以我可能只是落后于时代。我不知道“snarg”是指“我还是没听懂”还是“对不起，我发现了我的错误”。如果这意味着后者，那么 Rob Kennedy 的这个建议似乎是正确的：

```
procedure TKeyboardForm.ButtonClick(Sender: TObject);
begin
  mmo.Lines.Text := mmo.Lines.Text + (Sender as TButton).Caption;
end; 
```

如果您在事件处理程序内的行上放置一个断点并评估 TButton(Sender).Caption，它不会显示您按下的按钮的标题吗？我看到您现在正在遍历所有按钮。如果您想要的只是标题，那么该代码似乎应该解决它。

杰克

# c++ - 控制台菜单更新 OpenGL 窗口

> ID：525227
> 
> 赞同：4
> 
> 时间：2009-02-08T05:46:54.447
> 
> 标签：c++, multithreading, opengl, console

我正在制作一个执行一些自定义图像处理的应用程序。该程序将由控制台中的一个简单菜单驱动。用户将输入图像的文件名，该图像将使用 openGL 在窗口中显示。当用户选择对图像进行一些处理时，处理完成，openGL窗口应该重新绘制图像。

我的问题是我的图像从未被绘制到窗口上，而是窗口始终是黑色的。我认为这可能与我在程序中组织线程的方式有关。主执行线程处理菜单输入/输出和图像处理并调用 Display 方法，而第二个线程运行 openGL 主循环。

这是我的主要代码：

```
#include <iostream>
#include <GL/glut.h>
#include "ImageProcessor.h"
#include "BitmapImage.h"

using namespace std;

DWORD WINAPI openglThread( LPVOID param );
void InitGL();
void Reshape( GLint newWidth, GLint newHeight );
void Display( void );

BitmapImage* b;
ImageProcessor ip;

int main( int argc, char *argv[] ) {
    DWORD threadID;
    b = new BitmapImage();

    CreateThread( 0, 0, openglThread, NULL, 0, &threadID );

    while( true ) {
        char choice;
        string path = "TestImages\\";
        string filename;
        cout << "Enter filename: ";
        cin >> filename;
        path += filename;
        b = new BitmapImage( path );
        Display();

        cout << "1) Invert" << endl;
        cout << "2) Line Thin" << endl;
        cout << "Enter choice: ";
        cin >> choice;

        if( choice == '1' ) {
            ip.InvertColour( *b );
        }
        else {
            ip.LineThinning( *b );
        }
        Display();
    }

    return 0;
}

void InitGL() {
    int argc = 1;
    char* argv[1];
    argv[0] = new char[20];
    strcpy( argv[0], "main" );

    glutInit( &argc, argv );

    glutInitDisplayMode( GLUT_DOUBLE | GLUT_RGB | GLUT_DEPTH);
    glutInitWindowPosition( 0, 0 );
    glutInitWindowSize( 800, 600 );
    glutCreateWindow( "ICIP Program - Character recognition using line thinning, Hilbert curve, and wavelet approximation" );

    glutDisplayFunc( Display );
    glutReshapeFunc( Reshape );

    glClearColor(0.0,0.0,0.0,1.0);

    glEnable(GL_DEPTH_TEST);
}

void Reshape( GLint newWidth, GLint newHeight ) {
    /*  Reset viewport and projection parameters  */
    glViewport( 0, 0, newWidth, newHeight );
}

void Display( void ) {
    glClear (GL_COLOR_BUFFER_BIT); // Clear display window.
    b->Draw();
    glutSwapBuffers();
}

DWORD WINAPI openglThread( LPVOID param ) {
    InitGL();
    glutMainLoop();
    return 0;
} 
```

这是我的 BitmapImage 绘制方法：

```
void BitmapImage::Draw() {
    cout << "Drawing" << endl;
    if( _loaded ) {
        glBegin( GL_POINTS );
            for( unsigned int i = 0; i < _height * _width; i++ ) {
                glColor3f( _bitmap_image[i*3] / 255.0, _bitmap_image[i*3+1] / 255.0, _bitmap_image[i*3+2] / 255.0 );
                // invert the y-axis while drawing
                glVertex2i( i % _width, _height - (i / _width) );
            }
        glEnd();
    }
} 
```

关于这个问题的任何想法？

编辑：从技术上通过从 openglThread 启动一个 glutTimer 解决了这个问题，它每 500 毫秒调用一次 glutPostRedisplay() 。现在还可以，但我更喜欢这样一种解决方案，在这种解决方案中，每次更改位图时我只需要重新显示（以节省处理时间），并且我不必运行另一个线程（计时器是我假设的另一个线程）。这主要是因为主处理线程将做大量密集的工作，我想将大部分资源专用于该线程而不是其他任何东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-08T06:34:11.387

我以前遇到过这个问题 - 这很烦人。问题是您的所有 OpenGL 调用都必须在您启动 OpenGL 上下文的线程中完成。因此，当您希望您的主（输入）线程更改 OpenGL 线程中的某些内容时，您需要以某种方式向线程发出信号，表明它需要做一些事情（设置标志或其他内容）。

注意：我不知道你的`BitmapImage`加载函数（这里是你的构造函数）做了什么，但它可能有一些 OpenGL 调用。以上也适用！因此，您需要向其他线程发出信号来`BitmapImage`为您创建一个，或者至少在创建位图时执行与 OpenGL 相关的部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T10:45:59.320

几点：

*   一般来说，如果你要走多线程路线，最好是你的主线程是你的 GUI 线程，即它只做最少的任务来保持 GUI 响应。在您的情况下，我建议将密集的图像处理任务移到一个线程中，并在您的主线程中进行 OpenGL 渲染。

*   为了绘制图像，您使用的是顶点而不是纹理四边形。除非您有充分的理由，否则使用单个纹理四边形（处理后的图像是纹理）要快得多**。**查看[glTexImage2D](http://opengl.org/documentation/specs/man_pages/hardcopy/GL/html/gl/teximage2d.html)和[glTexSubImage2D](http://www.opengl.org/documentation/specs/man_pages/hardcopy/GL/html/gl/texsubimage2d.html)。

*   如果您使用的是加速的 OpenGL 实现（在任何现代系统上几乎可以保证），并且如果您使用带纹理的四边形而不是每个像素的顶点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T08:16:43.317

您的问题可能在 Display() 中

b->绘制（）；

我看不到 b 在哪里传递到 Display() 的范围内。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T03:06:46.397

您需要在创建上下文的线程上进行 OpenGL 调用 (glutInitDisplayMode)。因此，不会定义位于不同线程上的 Display 方法内部的 glXX 调用。您可以通过转储函数地址轻松看到这一点，希望它是未定义的或 NULL。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T03:50:10.427

听起来 500 毫秒计时器定期调用 Display()，在 2 次调用后，它以相同的渲染填充后缓冲区和前缓冲区。Display() 会继续被调用，直到用户输入了一些 OpenGL 线程永远不知道的内容，但是，由于全局变量 b 现在不同，线程在 Display() 中盲目地使用它。

那么如何按照 Jesse Beder 所说的那样使用全局 int（称为 flag）来标记用户输入内容的时间。例如：

设置标志 = 1; 在你做 b = new BitmapImage( path );

然后设置标志= 0；从 OpenGL 线程调用 Display() 之后。

您在计时器上循环，但是，现在检查 flag = 1。您只需要在 flag = 1 时调用 glutPostRedisplay()，即用户输入了一些内容。

似乎是不使用睡眠/唤醒机制的好方法。在多个线程之间访问全局变量也可能是不安全的。我认为这里可能发生的最坏情况是 OpenGL 线程未读标志 = 0，而它应该读取标志 = 1。然后它应该在不超过几次迭代后捕获它。如果你有奇怪的行为去同步。

使用您显示的代码，您在 main() 中调用 Display() 两次。实际上，main() 甚至不需要调用 Display()，OpenGL 线程就可以做到。

# ms-access - 如何在 MS Access 中格式化联合查询的日期字段？

> ID：525229
> 
> 赞同：3
> 
> 时间：2009-02-08T05:49:12.693
> 
> 标签：ms-access

我有两个带有日期字段的表。每个表都以短日期格式 (MM/DD/YYYY) 显示日期。

我编写了一个联合查询来组合这些表，但联合查询以通用日期（长）格式 (MM/DD/YYYY HH:MM:SS) 显示日期。我将不胜感激以短日期格式从联合查询中获取日期的解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-08T05:58:03.753

在联合上进行选择并在末尾格式化日期列：

```
select format(foo, "short date")
from (
    blah
union
    blah
) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T06:44:55.780

您可以使用一个很好的内置 Jet 功能：

从表中选择格式（myDate，'mm/dd/yyyy'）

希望这可以帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-08T05:53:02.797

如果您使用的是 querydef，您可以在设计模式下右键单击该列，您将找到一个 Format 属性。

# product-development - 作为初创公司的产品开发

> ID：525235
> 
> 赞同：7
> 
> 时间：2009-02-08T05:57:11.070
> 
> 标签：product-development

**我正在向社区领袖提出一些答案。**

我们朋友们决定打造已经在业内有一些大牌的产品。我们的座右铭不是打败所有这些玩家（因为我们不能），而是开发对某些细分客户具有成本效益的基本产品。

***我们在第一步中试图实现的是更便宜的选择，因为我们都知道产品会随着时间的推移而增长，而不是一次增长。***

现在我们的catch-22部分-

1.  我们应该开始构建产品，因为已经有大牌了吗？
2.  价格是 USP（唯一销售点）的正确选择。
3.  由于我们都依赖于工作，那么前进的最佳选择是什么。
4.  由于我们也有一些通过口头确认的客户，我们应该继续吗？
5.  ***在产品开发过程中，我们应该牢记哪些主要原则。***

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-08T06:23:46.493

请对产品的定义进行头脑风暴。交付的不仅仅是一张 CD，还有支持和信任。

使用这个扩展的定义，如果你仍然可以击败现有的产品，那就去吧。

另外，不要忘记产品的摊销开发成本可能已经被现有公司收回，因此他们可以随时降低成本。

所有人都说，不要让这种分析瘫痪阻止你……去吧。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-08T09:27:59.337

### 市场上的大牌

我正处于这样一家创业公司的前夜，有时规模小是一个决定性的优势。如果你相信你*不仅可以在价格方面*使用它，而且可以灵活使用，那么做核心工作可能比大牌更好。如果你愿意的话，我认为你可以很容易地渗透到市场中。

### 工作依赖

取决于你做什么？如果您要打开 next-digg 或 YACW2A（*又一个很酷的 web 2.0 应用程序*），那么请继续您的日常工作，因为通常您可以两者兼得，特别是如果您有朋友在身边。如果它是一个更大的范围，你可能想要坚持你的日常工作，直到你得到一个**几乎那里**的产品。

别忘了，你也可以找到投资人，有时这是最好的选择。**所以你可以辞职，在自己的**工作中仍然有薪水。

### 口头确认

很高兴您已经有几个潜在客户，现在您需要研究并制定商业计划。了解您的每月成本，包括工资，并查看您可以从这些客户那里获得多少百分比。如果它很好，那么从这些客户那里得到一些更确定的答案，然后继续。如果可能，请事先建立公司并让他们购买产品。（你的一个朋友可以做到，并不是所有人都需要马上离开你的日常工作）

### 产品开发

做大市场，就是**把核心功能做的很完善**，应该能行，而且应该更容易。除非您获得正确的核心功能，否则价格本身并不能证明购买的合理性。忽略无用的企业功能或任何无用的功能。您需要意识到您比竞争对手获得的资源有限得多，因此 20/80 规则（帕累托原则）适合您。不要试图通过包含疯狂的功能来满足 20% 的市场，坚持 80% 的要求。大玩家可以满足或可以尝试满足 100% 的市场，如果你尝试做同样的事情，你会惨败。

### 最后

阅读《[变得真实](http://gettingreal.37signals.com/toc.php)》，不要虔诚地追随，但这本书会给你很好的想法，并解释做小事的好处。

你没有提到，但我想写。在您和您的朋友之间达成适当的协议，在做任何事情之前确保一切都在纸上！我已经看到很多类似的初创公司因为这个原因在开始之前就被搞砸了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-08T10:08:17.990

Well. Me and my fellows from our current company having the similar aims.

Here's few our ideas about it:

1.  We are developing (web-based) **product that we will use** too. This is important for us and hope will help to improve our own performance in some areas and will give inspiration for new features.
2.  We are going to develop product in stages. Not just sit and code silver bullet for industry. Going to start with core and minimal feature set.
3.  Pricing. We are going to **give options**: use product on our hosting or purchase own copy and install it on own server. Additional and obivious things are different feature sets (technically -- different plugins integration).
4.  Even more, think we'll make the core (as framework) and some plugins public. It'd be good (even neccesary in our case) to **create community**.
5.  We already have few customers that would like to have highly **customised versions** of product. If this will have progress, we're going to focus on such activity and provide community with more and more free basic plugins.

That's just general ideas set. Hope you'll find some of them useful.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-08T07:02:54.370

> 我们的座右铭是不要击败所有这些玩家（因为我们不能）

首先，改变你的座右铭。没有一种产品可以一直完美地适合所有人。总有一个利基可以利用。当前的产品如何改进或简化？

第二，不要关注价格。客户希望为优质产品支付公平的价格，但他们不会以任何价格购买劣质软件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-08T05:59:09.180

如果您认为您可以打造比市场上已有产品更好的产品，请以合理的价格出售，并以有限的营销预算覆盖您的目标受众。 **绝对**的，加油！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-08T06:58:08.373

写一份合适的商业计划书。一定要包括关键风险和可防御的进入壁垒。如果您的团队中没有人知道如何做到这一点，那么您现在可以停下来，因为您还没有合适的团队。

商业计划书不仅仅是另一本针对 VC 的营销手册。说实话。完成后，将其交给您信任的人并要钱。如果他们不投资，那你为什么要投资？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-08T08:44:41.653

您是否确定了功能减少（因此价格降低）产品的市场？听起来你没有。

您的团队是否对特定产品充满热情？听起来不像你。您小组中的每个人都可能很难仅从某个程序中获得真正的启发。特别是如果你没有做过市场调查。

我不会指望“口头确认”的客户。当然，这取决于涉及的金额。产品的价格越高，你让它真正发挥作用所需的时间越长，当你准备好它时，他们实际购买的机会就越小。你有理由相信会有更多的人感兴趣并且会真正购买你的产品吗？

如果你有足够的市场研究和营销计划，你可能会获得一些风险投资，辞掉目前的工作，全职工作，获得报酬，并希望在发展壮大时赚到大钱。

祝你好运。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-08T06:13:28.027

1.  如果这样做可以满足您自己的要求（例如风险+成本与回报）
2.  您可能还需要另一个 USP：例如，易用性
3.  在业余时间从事这项工作，或从事兼职工作
4.  ?
5.  如果你没有完成，或者如果客户不想要你提供的东西，那么你就不会得到报酬

# google-app-engine - 使用 SMTP 参数配置 Google App Engine 生产服务器

> ID：525238
> 
> 赞同：0
> 
> 时间：2009-02-08T06:00:21.050
> 
> 标签：google-app-engine, smtp

我的 Google App Engine 应用程序需要发送电子邮件。在我的开发服务器上，我在启动服务器时指定了我的 SMTP 配置（主机、端口、用户、密码），并且 App Engine 使用指定的 SMTP 参数发送电子邮件。

我怎样才能对我的生产服务器做同样的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T14:09:36.137

您无需对其进行配置 - App Engine 使用 Google 自己的 SMTP 基础架构自动发送通过邮件 API 发送的电子邮件。

# variables - 如何从 GM_xmlhttprequest 返回值？

> ID：525243
> 
> 赞同：5
> 
> 时间：2009-02-08T06:05:53.863
> 
> 标签：variables, greasemonkey, global-variables, alert, undefined

我在这里有这段代码：

```
var infiltrationResult;

while(thisOption) {
    var trNode = document.createElement('tr');
    var tdNode = document.createElement('td');
    var hrefNode = document.createElement('a');

    infPlanetID = thisOption.getAttribute('value');

  var myURL = "http://www.hyperiums.com/servlet/Planetinf?securitylevel=90&newinfiltr=New+infiltration&planetid=" + PlanetID + "&infplanetid=" + infPlanetID;

    GM_xmlhttpRequest({
        method: 'GET',
        url: myURL,
        headers: {
            'User-agent': 'Mozilla/4.0 (compatible) Greasemonkey',
            'Accept': 'application/atom+xml,application/xml,text/xml',
        },
        onload: function(responseDetails) {
                if (responseDetails.responseText.match(/<b>Invalid order<\/td><\/tr><tr><td><BR><center><font color=#AAAA77 face=verdana,arial size=2>The target planet is blocking all infiltrations[\s\S]<BR><BR>/im)) {
                    // Successful match
                    infiltrationResult = 'Invalid Order';
                } else {
                    // Match attempt failed
                    infiltrationResult = 'Infiltration Successfully Created';
                }
        }
    }); 
```

当我添加

> 警报（渗透结果）；

分配后，我正确地看到了字符串。

但是，在函数退出后，我尝试了相同的警报，我得到：

```
undefined 
```

任何想法我做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-08T06:21:55.937

请求异步运行。这*就是*该函数首先采用`onload`回调函数的原因。如果它是同步的，那么`GM_xmlhttpRequest`将像普通函数一样简单地返回响应详细信息。

在等待请求返回时，调用后的代码`GM_xmlhttpRequest`继续运行。您的脚本正确识别出`infiltrationResult`未定义的内容，因为请求尚未完成。

如果您需要做的不仅仅是在请求返回时分配变量，请在`onload`回调中执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-26T12:36:43.937

试试这个：

```
var infiltrationResult;

while(thisOption) {
    var trNode = document.createElement('tr');
    var tdNode = document.createElement('td');
    var hrefNode = document.createElement('a');

    infPlanetID = thisOption.getAttribute('value');

  var myURL = "http://www.hyperiums.com/servlet/Planetinf?securitylevel=90&newinfiltr=New+infiltration&planetid=" + PlanetID + "&infplanetid=" + infPlanetID;

    GM_xmlhttpRequest({
        method: 'GET',
        url: myURL,
        headers: {
            'User-agent': 'Mozilla/4.0 (compatible) Greasemonkey',
            'Accept': 'application/atom+xml,application/xml,text/xml',
        },
        onload: function(responseDetails) {
                        if (responseDetails.responseText.match(/<b>Invalid order<\/td><\/tr><tr><td><BR><center><font color=#AAAA77 face=verdana,arial size=2>The target planet is blocking all infiltrations[\s\S]<BR><BR>/im)) {
                                // Successful match
                                infiltrationResult = 'Invalid Order';
                        } else {
                                // Match attempt failed
                                infiltrationResult = 'Infiltration Successfully Created';
                        }
                        sentback(infiltrationResult);//Sent it when it loads only
        }
    });

function sentback(x){
    alert(x);
} 
```

# python - pycurl 和 unescape

> ID：525244
> 
> 赞同：2
> 
> 时间：2009-02-08T06:08:00.223
> 
> 标签：python, pycurl

curl_unescape 似乎不在 pycurl 中，我用什么代替？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-08T06:34:39.483

你试过`urllib.quote`吗？

```
import urllib
print urllib.quote("some url")

some%20url 
```

[这](http://docs.python.org/library/urllib.html)是文档

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T10:30:13.640

curl_unescape 是一个过时的函数。请改用[curl_easy_unescape](http://curl.haxx.se/libcurl/c/curl_easy_unescape.html) 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-09T18:46:46.483

我们计划在一两个月内发布新版本的 pycURL。新版本将在您的机器上安装 libcurl 的所有功能。-:)

# perl - 如何在 unix 中守护任意脚本？

> ID：525247
> 
> 赞同：96
> 
> 时间：2009-02-08T06:11:08.080
> 
> 标签：perl, unix, scripting, sysadmin, daemon

我想要一个可以将任意通用脚本或命令转换为[daemon](http://en.wikipedia.org/wiki/Daemon_(computer_software))的守护程序。

我想处理两种常见的情况：

1.  我有一个应该永远运行的脚本。如果它死了（或在重新启动时），请重新启动它。不要让两个副本同时运行（检测一个副本是否已经在运行，在这种情况下不要启动它）。

2.  我有一个简单的脚本或命令行命令，我想永远重复执行（运行之间有短暂的停顿）。同样，不要让脚本的两个副本同时运行。

当然，在案例 2 中围绕脚本编写一个“while(true)”循环然后为案例 1 应用解决方案是微不足道的，但更通用的解决方案将直接解决案例 2，因为这适用于案例 1 中的脚本好吧（如果脚本不打算死掉，你可能只需要更短的暂停或没有暂停（当然，如果脚本真的永远*不会*死，那么暂停实际上并不重要））。

请注意，该解决方案不应涉及，例如，将文件锁定代码或 PID 记录添加到现有脚本。

更具体地说，我想要一个可以运行的程序“守护进程”

```
% daemonize myscript arg1 arg2 
```

或者，例如，

```
% daemonize 'echo `date` >> /tmp/times.txt' 
```

这将使越来越多的日期列表附加到 times.txt。（请注意，如果 daemonize 的参数是一个像上面的情况 1 一样永远运行的脚本，那么 daemonize 仍然会做正确的事情，在必要时重新启动它。）然后我可以在我的 .login 中放置一个类似上面的命令和/或每小时或每分钟 cron 它（取决于我对它意外死亡的担心程度）。

注意： daemonize 脚本需要记住它正在守护的命令字符串，这样如果相同的命令字符串再次被守护，它就不会启动第二个副本。

此外，理想情况下，该解决方案应该适用于 OS X 和 linux，但欢迎使用其中一种或另一种的解决方案。

编辑：如果您必须使用`sudo daemonize myscript myargs`.

（如果我认为这一切都错了，或者有快速而肮脏的部分解决方案，我也很想听听。）

* * *

PS：如果它有用，[这里](https://stackoverflow.com/questions/473620/how-do-you-create-a-daemon-in-python)有一个类似的问题特定于 python。

[这个](https://stackoverflow.com/questions/38596/whats-the-best-way-to-keep-a-php-script-running-as-a-daemon/39609#39609)对类似问题的回答似乎是一个有用的习语，可以快速而肮脏地妖魔化任意脚本：

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2010-03-11T08:44:53.467

您可以使用 nohup 和 & 运算符来守护 Unix 中的任何可执行文件：

```
nohup yourScript.sh script args& 
```

nohup 命令允许您在不杀死脚本的情况下关闭您的 shell 会话，而 & 将您的脚本置于后台，以便您获得 shell 提示以继续您的会话。唯一的小问题是标准输出和标准错误都被发送到./nohup.out，所以如果你在这个庄园中启动多个脚本，它们的输出将交织在一起。更好的命令是：

```
nohup yourScript.sh script args >script.out 2>script.error& 
```

这会将标准输出发送到您选择的文件，并将标准错误发送到您选择的不同文件。如果您只想对标准输出和标准错误使用一个文件，您可以使用以下命令：

```
nohup yourScript.sh script args >script.out 2>&1 & 
```

2>&1 告诉 shell 将标准错误（文件描述符 2）重定向到与标准输出（文件描述符 1）相同的文件。

要仅运行一次命令并在它死后重新启动它，您可以使用此脚本：

```
#!/bin/bash

if [[ $# < 1 ]]; then
    echo "Name of pid file not given."
    exit
fi

# Get the pid file's name.
PIDFILE=$1
shift

if [[ $# < 1 ]]; then
    echo "No command given."
    exit
fi

echo "Checking pid in file $PIDFILE."

#Check to see if process running.
PID=$(cat $PIDFILE 2>/dev/null)
if [[ $? = 0 ]]; then
    ps -p $PID >/dev/null 2>&1
    if [[ $? = 0 ]]; then
        echo "Command $1 already running."
        exit
    fi
fi

# Write our pid to file.
echo $$ >$PIDFILE

# Get command.
COMMAND=$1
shift

# Run command until we're killed.
while true; do
    $COMMAND "$@"
    sleep 10 # if command dies immediately, don't go into un-ctrl-c-able loop
done 
```

第一个参数是要使用的 pid 文件的名称。第二个参数是命令。所有其他参数都是命令的参数。

如果您将此脚本命名为 restart.sh，您可以这样称呼它：

```
nohup restart.sh pidFileName yourScript.sh script args >script.out 2>&1 & 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2010-03-18T04:21:26.757

对于冗长的答案，我深表歉意（请参阅有关我的答案如何确定规范的评论）。我试图做到全面，所以你有尽可能好的一面。:-)

如果您能够安装程序（具有 root 访问权限），并且愿意一次性完成设置脚本以执行守护程序（即，比简单地指定要在命令行上运行的命令行参数更复杂，但每次服务只需要完成一次），我有一种更强大的方法。

它涉及使用[daemontools](http://cr.yp.to/daemontools.html)。这篇文章的其余部分描述了如何使用 daemontools 设置服务。

### 初始设置

1.  按照[如何安装 daemontools](http://cr.yp.to/daemontools/install.html)中的说明进行操作。一些发行版（例如，Debian、Ubuntu）已经有它的软件包，所以就使用它。
2.  创建一个名为`/service`. 安装程序应该已经这样做了，但只需验证，或者手动安装。如果你不喜欢这个位置，你可以在你的`svscanboot`脚本中改变它，尽管大多数 daemontools 用户习惯使用`/service`并且如果你不使用它会感到困惑。
3.  如果您使用的是 Ubuntu 或其他不使用标准的发行版（即`init`不使用. 这并不难，但您需要知道如何配置您的操作系统使用的。 是一个调用 的脚本，它完成了寻找服务的主要工作；如果它因任何原因死亡，它将安排重新启动它。`/etc/inittab``inittab``svscanboot``init``init``svscanboot``svscan``init``init`

### 按服务设置

1.  每个服务都需要一个*服务目录*，其中存储有关服务的内务信息。您还可以创建一个位置来存放这些服务目录，以便它们都在一个地方；通常我使用`/var/lib/svscan`，但任何新位置都可以。
2.  我通常使用[脚本](http://codepad.org/9CgRVihO)来设置服务目录，以节省大量手动重复工作。例如，

    ```
    sudo mkservice -d /var/lib/svscan/some-service-name -l -u user -L loguser "command line here" 
    ```

    `some-service-name`您要为服务提供的名称是哪里，`user`是运行该服务`loguser`的用户，是运行记录器的用户。（稍后会解释日志记录。）

3.  您的服务必须**在前台**运行。如果您的程序默认为背景，但可以选择禁用它，请执行此操作。如果您的程序后台无法禁用它，请继续阅读[`fghack`](http://cr.yp.to/daemontools/fghack.html)，尽管这是一个权衡：您不能再使用`svc`.
4.  编辑`run`脚本以确保它正在执行您想要的操作。`sleep`如果您希望您的服务经常退出，您可能需要在顶部拨打电话。
5.  一切设置正确后，创建一个`/service`指向您的服务目录的符号链接。（不要将服务目录直接放在 中`/service`；这会使从`svscan`的监视中删除服务变得更加困难。）

### 日志记录

1.  daemontools 的日志记录方式是让服务将日志消息写入标准输出（或标准错误，如果您使用生成的脚本`mkservice`）；`svscan`负责将日志消息发送到日志服务。
2.  日志服务从标准输入中获取日志消息。生成的日志服务脚本`mkservice`将在目录中创建自动轮换的时间戳日志文件`log/main`。当前日志文件称为`current`.
3.  日志服务可以独立于主服务启动和停止。
4.  通过管道传输日志文件[`tai64nlocal`](http://cr.yp.to/daemontools/tai64nlocal.html)会将时间戳转换为人类可读的格式。（TAI64N 是一个 64 位原子时间戳，具有纳秒计数。）

### 控制服务

1.  用于[`svstat`](http://cr.yp.to/daemontools/svstat.html)获取服务的状态。请注意，日志服务是独立的，并且有自己的状态。
2.  您可以使用[`svc`](http://cr.yp.to/daemontools/svc.html). 例如，要重新启动您的服务，请使用`svc -t /service/some-service-name`; `-t`意思是“发送`SIGTERM`”。
3.  其他可用信号包括`-h`( `SIGHUP`)、`-a`( `SIGALRM`)、`-1`( `SIGUSR1`)、`-2`( `SIGUSR2`) 和`-k`( `SIGKILL`)。
4.  要关闭服务，请使用`-d`. `down`您还可以通过在服务目录中创建一个名为的文件来防止服务在启动时自动启动。
5.  要启动服务，请使用`-u`. 除非您之前已将其关闭（或将其设置为不自动启动），否则这不是必需的。
6.  要让主管退出，请使用`-x`; 通常也用于`-d`终止服务。这是允许删除服务的常用方法，但您必须先取消链接服务`/service`，否则`svscan`将重新启动主管。此外，如果您使用日志服务 ( ) 创建了服务，请记住在删除服务目录之前`mkservice -l`还要退出日志主管（例如，`svc -dx /var/lib/svscan/some-service-name/log`

### 概括

优点：

1.  daemontools 提供了一种创建和管理服务的防弹方法。我将它用于我的服务器，我强烈推荐它。
2.  它的日志系统非常强大，服务自动重启工具也是如此。
3.  因为它使用您编写/调整的 shell 脚本启动服务，所以您可以根据需要定制服务。
4.  强大的服务控制工具：您可以向服务发送几乎任何信号，并且可以可靠地启动和关闭服务。
5.  保证您的服务有一个干净的执行环境：它们将在与所提供的环境、进程限制等相同的环境下执行`init`。

缺点：

1.  每个服务都需要一些设置。值得庆幸的是，每次服务只需执行一次。
2.  服务必须设置为在前台运行。此外，为了获得最佳结果，应将它们设置为记录到标准输出/标准错误，而不是 syslog 或其他文件。
3.  如果您不熟悉 daemontools 的做事方式，学习曲线陡峭。您必须使用 重新启动服务`svc`，并且不能直接运行运行脚本（因为它们将不受主管的控制）。
4.  大量的内务管理文件和大量的内务处理流程。每个服务都需要自己的服务目录，每个服务使用一个主管进程在服务死亡时自动重启服务。（如果你有很多服务，你会在你的进程表中看到很多进程。*）*`supervise`

总的来说，我认为 daemontools 是满足您需求的优秀系统。我欢迎任何关于如何设置和维护它的问题。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2010-03-17T02:52:10.557

你应该看看[daemonize](http://www.clapper.org/software/daemonize/)。它允许检测第二个副本（但它使用文件锁定机制）。它也适用于不同的 UNIX 和 Linux 发行版。

如果您需要自动启动您的应用程序作为守护进程，那么您需要创建适当的初始化脚本。

您可以使用以下模板：

```
#!/bin/sh
#
# mydaemon     This shell script takes care of starting and stopping
#               the <mydaemon>
#

# Source function library
. /etc/rc.d/init.d/functions

# Do preliminary checks here, if any
#### START of preliminary checks #########

##### END of preliminary checks #######

# Handle manual control parameters like start, stop, status, restart, etc.

case "$1" in
  start)
    # Start daemons.

    echo -n $"Starting <mydaemon> daemon: "
    echo
    daemon <mydaemon>
    echo
    ;;

  stop)
    # Stop daemons.
    echo -n $"Shutting down <mydaemon>: "
    killproc <mydaemon>
    echo

    # Do clean-up works here like removing pid files from /var/run, etc.
    ;;
  status)
    status <mydaemon>

    ;;
  restart)
    $0 stop
    $0 start
    ;;

  *)
    echo $"Usage: $0 {start|stop|status|restart}"
    exit 1
esac

exit 0 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-02-09T01:25:44.127

我想你可能想试试[`start-stop-daemon(8)`](http://man.he.net/man8/start-stop-daemon)。查看`/etc/init.d`任何 Linux 发行版中的脚本以获取示例。它可以通过调用的命令行或 PID 文件找到已启动的进程，因此它符合您的所有要求，除了作为脚本的看门狗。但是您总是可以启动另一个守护程序看门狗脚本，在必要时重新启动您的脚本。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-06-09T14:46:06.790

作为已经提到的`daemonize`and的替代方案`daemontools`，还有 libslack 包的[daemon](http://libslack.org/daemon/)命令。

`daemon`是相当可配置的，并且确实关心所有繁琐的守护进程，例如自动重启、日志记录或 pidfile 处理。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-08T08:33:25.983

如果你专门使用 OS X，我建议你看看 launchd 是如何工作的。它将自动检查以确保您的脚本正在运行，并在必要时重新启动它。它还包括各种调度功能等。它应该满足要求1和2。

至于确保您的脚本只能运行一个副本，您需要使用 PID 文件。通常我将一个文件写入 /var/run/.pid ，其中包含当前正在运行的实例的 PID。如果程序运行时文件存在，它会检查文件中的 PID 是否实际运行（程序可能已经崩溃或忘记删除 PID 文件）。如果是，则中止。如果没有，开始运行并覆盖 PID 文件。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2010-03-17T05:11:50.143

Daemontools ( [http://cr.yp.to/daemontools.html](http://cr.yp.to/daemontools.html) ) 是一组用于执行此操作的非常核心的实用程序，由 dj bernstein 编写。我已经成功地使用了它。令人讨厌的部分是，当您运行它们时，没有任何脚本返回任何可见的结果 - 只是不可见的返回码。但是一旦它运行它是防弹的。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-08T09:20:16.433

首先`createDaemon()`从[http://code.activestate.com/recipes/278731/](http://code.activestate.com/recipes/278731/)

然后是主要代码：

```
import subprocess
import sys
import time

createDaemon()

while True:
    subprocess.call(" ".join(sys.argv[1:]),shell=True)
    time.sleep(10) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-03-18T00:48:13.547

这是一个完整的工作版本，带有一个示例，您可以将其复制到一个空目录并试用（在安装 CPAN 依赖项之后，它们是[Getopt::Long](http://search.cpan.org/perldoc/Getopt::Long)、[File::Spec](http://search.cpan.org/perldoc/File::Spec)、[File::Pid](http://search.cpan.org/perldoc/File::Pid)和[IPC::System ： :Simple](http://search.cpan.org/perldoc/IPC::System::Simple) —— 所有这些都非常标准，强烈推荐给任何黑客：您可以使用 ) 一次性安装它们`cpan <modulename> <modulename> ...`。

* * *

**keepAlive.pl:**

```
#!/usr/bin/perl

# Usage:
# 1\. put this in your crontab, to run every minute:
#     keepAlive.pl --pidfile=<pidfile> --command=<executable> <arguments>
# 2\. put this code somewhere near the beginning of your script,
#    where $pidfile is the same value as used in the cron job above:
#     use File::Pid;
#     File::Pid->new({file => $pidfile})->write;

# if you want to stop your program from restarting, you must first disable the
# cron job, then manually stop your script. There is no need to clean up the
# pidfile; it will be cleaned up automatically when you next call
# keepAlive.pl.

use strict;
use warnings;

use Getopt::Long;
use File::Spec;
use File::Pid;
use IPC::System::Simple qw(system);

my ($pid_file, $command);
GetOptions("pidfile=s"   => \$pid_file,
           "command=s"   => \$command)
    or print "Usage: $0 --pidfile=<pidfile> --command=<executable> <arguments>\n", exit;

my @arguments = @ARGV;

# check if process is still running
my $pid_obj = File::Pid->new({file => $pid_file});

if ($pid_obj->running())
{
    # process is still running; nothing to do!
    exit 0;
}

# no? restart it
print "Pid " . $pid_obj->pid . " no longer running; restarting $command @arguments\n";

system($command, @arguments); 
```

* * *

**例子.pl：**

```
#!/usr/bin/perl

use strict;
use warnings;

use File::Pid;
File::Pid->new({file => "pidfile"})->write;

print "$0 got arguments: @ARGV\n"; 
```

* * *

现在您可以使用：调用上面的示例，`./keepAlive.pl --pidfile=pidfile --command=./example.pl 1 2 3`文件`pidfile`将被创建，您将看到输出：

```
Pid <random number here> no longer running; restarting ./example.pl 1 2 3
./example.pl got arguments: 1 2 3 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-04-13T13:51:55.600

你也可以试试[Monit](http://mmonit.com)。Monit 是一项监视和报告其他服务的服务。虽然它主要用作通知（通过电子邮件和短信）有关运行时问题的一种方式，但它也可以执行这里大多数其他建议所提倡的。它可以自动（重新）启动和停止程序、发送电子邮件、启动其他脚本以及维护您可以获取的输出日志。此外，我发现它很容易安装和维护，因为有可靠的文档。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-09-07T19:07:14.667

你可以试试[immortal](https://immortal.run)它是一个 *nix 跨平台（与操作系统无关）的主管。

在 macOS 上快速尝试：

```
brew install immortal 
```

如果您从端口或使用 pkg使用[FreeBSD ：](https://immortal.run/freebsd/)

```
pkg install immortal 
```

对于[Linux](https://github.com/immortal/immortal/releases)，通过下载预编译的二进制文件或从源代码：[https ://immortal.run/source/](https://immortal.run/source/)

您可以像这样使用它：

```
immortal -l /var/log/date.log date 
```

或者通过[配置 YAML](https://immortal.run/post/run.yml/)文件，它为您提供更多选项，例如：

```
cmd: date
log:
    file: /var/log/date.log
    age: 86400 # seconds
    num: 7     # int
    size: 1    # MegaBytes
    timestamp: true # will add timesamp to log 
```

如果您还想将标准错误输出保存在单独的文件中，您可以使用以下内容：

```
cmd: date
log:
    file: /var/log/date.log
    age: 86400 # seconds
    num: 7     # int
    size: 1    # MegaBytes
stderr:
    file: /var/log/date-error.log
    age: 86400 # seconds
    num: 7     # int
    size: 1    # MegaBytes
    timestamp: true # will add timesamp to log 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-07-06T20:18:03.480

我对[另一个答案](https://stackoverflow.com/a/2423550/340947)进行了一系列改进。

1.  此脚本中的标准输出完全由来自其子级的标准输出组成，除非它由于检测到该命令已在运行而退出
2.  终止时在其 pidfile 后清理
3.  可选的可配置超时期限（接受任何正数参数，发送到`sleep`）
4.  使用提示开启`-h`
5.  任意命令执行，而不是单个命令执行。最后一个 arg 或剩余的 args（如果有多个最后一个 arg）被发送到`eval`，因此您可以将任何类型的 shell 脚本作为字符串发送到该脚本作为最后一个 arg（或尾随 args），以便它进行守护进程
6.  参数计数比较用`-lt`代替`<`

这是脚本：

```
#!/bin/sh

# this script builds a mini-daemon, which isn't a real daemon because it
# should die when the owning terminal dies, but what makes it useful is
# that it will restart the command given to it when it completes, with a
# configurable timeout period elapsing before doing so.

if [ "$1" = '-h' ]; then
    echo "timeout defaults to 1 sec.\nUsage: $(basename "$0") sentinel-pidfile [timeout] command [command arg [more command args...]]"
    exit
fi

if [ $# -lt 2 ]; then
    echo "No command given."
    exit
fi

PIDFILE=$1
shift

TIMEOUT=1
if [[ $1 =~ ^[0-9]+(\.[0-9]+)?$ ]]; then
        TIMEOUT=$1
        [ $# -lt 2 ] && echo "No command given (timeout was given)." && exit
        shift
fi

echo "Checking pid in file ${PIDFILE}." >&2

#Check to see if process running.
if [ -f "$PIDFILE" ]; then
    PID=$(< $PIDFILE)
    if [ $? = 0 ]; then
        ps -p $PID >/dev/null 2>&1
        if [ $? = 0 ]; then
            echo "This script is (probably) already running as PID ${PID}."
            exit
        fi
    fi
fi

# Write our pid to file.
echo $$ >$PIDFILE

cleanup() {
        rm $PIDFILE
}
trap cleanup EXIT

# Run command until we're killed.
while true; do
    eval "$@"
    echo "I am $$ and my child has exited; restart in ${TIMEOUT}s" >&2
    sleep $TIMEOUT
done 
```

用法：

```
$ term-daemonize.sh pidfilefortesting 0.5 'echo abcd | sed s/b/zzz/'
Checking pid in file pidfilefortesting.
azzzcd
I am 79281 and my child has exited; restart in 0.5s
azzzcd
I am 79281 and my child has exited; restart in 0.5s
azzzcd
I am 79281 and my child has exited; restart in 0.5s
^C

$ term-daemonize.sh pidfilefortesting 0.5 'echo abcd | sed s/b/zzz/' 2>/dev/null
azzzcd
azzzcd
azzzcd
^C 
```

请注意，如果您从不同的目录运行此脚本，它可能会使用不同的 pidfile，并且不会检测到任何现有的正在运行的实例。由于它旨在运行和重新启动通过参数提供的临时命令，因此无法知道某事是否已经启动，因为谁能说它是否是*相同的命令*？为了改进这种仅运行单个实例的强制执行，需要针对具体情况的解决方案。

此外，要使其充当适当的守护程序，您必须（至少）使用 nohup 作为其他答案提到的。我没有努力为过程可能收到的信号提供任何弹性。

还有一点需要注意的是，杀死这个脚本（如果它是从另一个被杀死的脚本调用的，或者有一个信号）可能无法成功杀死孩子，特别是如果孩子是*另一个*脚本。我不确定这是为什么，但这似乎与`eval`工作方式有关，这对我来说很神秘。因此，谨慎的做法是将该行替换为仅接受单个命令的内容，例如另一个答案。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-12-29T20:33:44.490

还有一种非常简单的双叉+`setsid`方法可以将任何脚本与其父进程分离

```
( setsid my-regular-script arg [arg ...] 1>stdout.log 2>stderr.log & ) 
```

`setsid`是标准`util-linux`软件包的一部分，自诞生以来就与 linux 一起使用。`POSIX`这在我知道的任何兼容的 shell 中启动时都有效。

另一种基于双叉的方法甚至不需要任何额外的可执行文件或包，并且完全依赖于`POSIX`基于 shell

```
( my-regular-script arg [arg ...] 1>stdout.log 2>stderr.log & ) & 
```

当父进程离开阶段时，它也可以成为孤儿

# html - 如何在邮件服务器上的 HTML 电子邮件中嵌入图像？

> ID：525256
> 
> 赞同：5
> 
> 时间：2009-02-08T06:21:19.743
> 
> 标签：html, email

如何在 HTML 中嵌入图像，以便图像与 html 文件内容一起交付，并且不需要单独访问服务器来检索图像？我们需要在签名离开邮件服务器之前将其嵌入到签名中。我们不想使用 Thunderbird 或 Outlook 功能之类的客户端解决方案来添加签名。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-08T06:27:14.927

您需要做的是将文件编码为 Base64，并像这样包含它：

```
<img src="data:image/gif;base64,R0lGODlhUAA..(the rest of your base64 encoded file).."> 
```

[http://www.sweeting.org/mark/blog/2005/07/12/base64-encoded-images-embedded-in-html](http://www.sweeting.org/mark/blog/2005/07/12/base64-encoded-images-embedded-in-html)

[http://dean.edwards.name/weblog/2005/06/base64-ie/](http://dean.edwards.name/weblog/2005/06/base64-ie/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-08T07:13:00.293

标准解决方案是将图像添加为附件。每个附件都有一个 ContentID，因此您可以使用以下方法嵌入图像：`<img src="cid:ContentID" />`。
这会将图像嵌入到电子邮件中，而不是 html 中。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-08T06:26:53.180

我不认为 W3C HTML 规范真的允许你这样做。

但如果你真的想要，你可以创建一个像素宽度和像素高度的表格，并一个一个地设置单元格背景颜色来创建你的图像。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-08T06:26:09.593

不能这样做，但这没关系，因为现代浏览器使用 KeepAlive 功能，以便保留与服务器的连接以进行图像加载。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-08T06:32:16.273

这是一个方便的[图像到 HTML 转换器](http://neil.fraser.name/software/img2html/)- 警告会创建 NASTY HTML！:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-08T06:44:24.750

我想到的问题是 - 为什么你不希望在你的 html 中有一个*普通* `<img>`的标签？

将图像附加到 html 正文可能听起来很诱人，但它肯定会减慢电子邮件下载时间，并且有些人使用 gprs 连接之类的东西，所以他们想限制他们的带宽。

IMO*在*您的 html 中有图像是**纯粹的邪恶**。但这只是出于好奇，问你为什么想要这样一个解决方案 - 似乎@nickf alredy 给了你一个很好的解决方案:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-07-22T15:43:08.320

我最近重新评估了这个解决方案。

根据[这个博客](http://lindsaar.net/2010/6/7/inline-attachments-for-actionmailer)，对内联附件的支持得到了改进，新的东西被推送到了主线 Rails 仓库。

不过，我没有检查哪个 Rails 版本足够幸运地包含此更改。

对于我的 2.3.x 部署，我使用了[inline_attachment gem](http://github.com/JasonKing/inline_attachment)。

# css - 非艺术网页开发者有什么好的 CSS 设计吗？

> ID：525261
> 
> 赞同：7
> 
> 时间：2009-02-08T06:26:23.820
> 
> 标签：css

老实说，我非常不擅长 CSS，也不擅长处理颜色/设计。

是否有任何有用的网站，例如预制、漂亮的皮肤组件或整个网站的布局？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-08T06:30:57.523

这里有几个：

[http://www.oswd.org/](http://www.oswd.org/)

[http://openwebdesign.org/](http://openwebdesign.org/)

[http://www.solucija.com/free-templates](http://www.solucija.com/free-templates)

[http://www.opensourcetemplates.org/](http://www.opensourcetemplates.org/)

对于骨骼布局：[http ://blog.html.it/layoutgala/](http://blog.html.it/layoutgala/)

和一些 css 教程[http://www.cssplay.co.uk/layouts/index.html](http://www.cssplay.co.uk/layouts/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T06:41:04.260

我使用了“[免费 CSS 模板](http://www.freecsstemplate.net/)”网站。当我创建我的网站时，他们没有很多设计，但他们拥有的设计是干净、完整和优雅的。纯 XHTML 和 CSS。我可以毫不费力地调整以满足我的需求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-08T07:24:45.607

有点切线，但您可能会发现[《美丽网页设计的原则》](http://www.sitepoint.com/books/design1/)一书很有趣。它更多地针对希望扩大其设计意识的非设计师。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-30T19:03:01.720

[http://twitter.github.com/bootstrap/](http://twitter.github.com/bootstrap/)

# python - Python 在读取行时截断行

> ID：525272
> 
> 赞同：14
> 
> 时间：2009-02-08T06:34:52.820
> 
> 标签：python, file-io

我有一个应用程序，它从文件中读取行并在读取时在每一行上运行它的魔法。读取并正确处理该行后，我想从文件中删除该行。已保留已删除行的备份。我想做类似的事情

```
file = open('myfile.txt', 'rw+')
for line in file:
   processLine(line)
   file.truncate(line) 
```

这似乎是一个简单的问题，但我想把它做对，而不是大量复杂的 seek() 和 tell() 调用。

也许我真正想做的就是从文件中删除特定的行。

在这个问题上花了很长时间后，我认为每个人都可能是对的，而这只是做事的好方法。它只是看起来如此优雅的解决方案。我正在寻找的是类似于 FIFO 的东西，它可以让我从文件中弹出行。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-08T07:08:14.923

### 完成后删除所有行：

```
with open('myfile.txt', 'r+') as file:
    for line in file:
        processLine(line)
    file.truncate(0) 
```

### 单独删除每一行：

```
lines = open('myfile.txt').readlines()

for line in lines[::-1]: # process lines in reverse order
    processLine(line)
    del lines[-1]  # remove the [last] line

open('myfile.txt', 'w').writelines(lines) 
```

### 您只能留下那些导致异常的行：

```
import fileinput

for line in fileinput.input(['myfile.txt'], inplace=1):
    try: processLine(line)
    except Exception:
         sys.stdout.write(line) # it prints to 'myfile.txt' 
```

一般来说，正如其他人已经说过的那样，您尝试做的事情是个坏主意。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-08T09:25:03.693

**你不能**。当前文件系统上的实际文本文件实现是不可能的。

文本文件是连续的，因为文本文件中的行可以是任意长度。删除特定行将意味着从那时起重写整个文件。

假设您有一个包含以下 3 行的文件；

```
'line1\nline2reallybig\nline3\nlast line' 
```

要删除第二行，您必须移动磁盘中第三行和第四行的位置。唯一的方法是将第三行和第四行存储在某处，在第二行截断文件，然后重写丢失的行。

如果您知道文本文件中每一行的大小，则可以在任何位置使用截断文件，`.truncate(line_size * line_number)`但即便如此，您也必须重写该行之后的所有内容。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-08T06:55:36.210

您最好在文件中保留一个索引，这样您就可以从上次停止的地方开始，而不会破坏文件的一部分。像这样的东西会起作用：

```
try :
    for index, line in enumerate(file) :
        processLine(line)
except :
    # Failed, start from this line number next time.
    print(index)
    raise 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-08T06:47:38.007

在阅读时截断文件似乎有点极端。如果您的脚本有一个不会导致错误的错误怎么办？在这种情况下，您需要在文件开头重新启动。

让你的脚本打印它中断的行号并让它把一个行号作为参数，这样你就可以告诉它从哪一行开始处理呢？

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-08T06:54:25.947

首先，调用操作`truncate`可能不是最好的选择。如果我正确理解了这个问题，你想删除文件中当前位置的所有内容。（我希望`truncate`剪切从当前位置到文件末尾的所有内容。这就是标准 Python`truncate`方法的工作原理，至少如果我正确地用 Google 搜索的话。）

其次，我不确定在使用`for`循环进行迭代时修改文件是否明智。保存处理的行数并在主循环完成后删除它们不是更好吗，异常与否？文件迭代器支持[就地过滤](http://docs.python.org/library/fileinput.html)，这意味着之后删除已处理的行应该相当简单。

PS我不了解Python，对此持保留态度。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-05-13T13:56:53.927

一个相关的帖子似乎是一个很好的策略，请参阅 [如何从存储在文件中的进程列表中运行第一个进程并立即删除第一行，就好像文件是一个队列并且我称之为“pop”？](https://stackoverflow.com/questions/366533/how-can-i-run-the-first-process-from-a-list-of-processes-stored-in-a-file-and-imm/366604#366604)

我使用它如下：

```
 import os;

  tasklist_file = open(tasklist_filename, 'rw');  
  first_line = tasklist_file.readline();
  temp = os.system("sed -i -e '1d' " + tasklist_filename); # remove first line from task file; 
```

我不确定它是否适用于 Windows。在 Mac 上试了一下，果然成功了。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-03-15T21:14:15.037

这就是我用于基于文件的队列的方法。它返回第一行并用其余部分重写文件。完成后返回无：

```
def pop_a_text_line(filename):
    with open(filename,'r') as f:
        S = f.readlines()
    if len(S) > 0:
        pop = S[0]
        with open(filename,'w') as f:
            f.writelines(S[1:])
    else:
        pop = None
    return pop 
```

# c++ - 是否有一个 C 预处理器可以根据定义/未定义的值消除 #ifdef 块？

> ID：525283
> 
> 赞同：39
> 
> 时间：2009-02-08T06:45:56.653
> 
> 标签：c++, c, preprocessor

### 原始问题

我想要的不是标准的 C 预处理器，而是它的变体，它可以从某个地方接受 - 可能是通过 -DNAME1 和 -UNAME2 选项的命令行 - 定义了哪些宏的规范，然后将消除死代码。

通过一些示例可能更容易理解我所追求的：

```
#ifdef NAME1
#define ALBUQUERQUE "ambidextrous"
#else
#define PHANTASMAGORIA "ghostly"
#endif 
```

如果该命令使用“-DNAME1”运行，则输出为：

```
#define ALBUQUERQUE "ambidextrous" 
```

如果该命令使用“-UNAME1”运行，则输出为：

```
#define PHANTASMAGORIA "ghostly" 
```

如果该命令在没有任何选项的情况下运行，则输出将与输入相同。

这是一个简单的案例 - 我希望代码也可以处理更复杂的案例。

用一个真实但仍然简单的例子来说明：

```
#ifdef USE_VOID
#ifdef PLATFORM1
#define VOID void
#else
#undef VOID
typedef void    VOID;
#endif /* PLATFORM1 */
typedef void *  VOIDPTR;
#else
typedef mint     VOID;
typedef char *  VOIDPTR;
#endif /* USE_VOID */ 
```

我想运行命令`-DUSE_VOID -UPLATFORM1`并获取输出：

```
#undef VOID
typedef void    VOID;
typedef void *  VOIDPTR; 
```

另一个例子：

```
#ifndef DOUBLEPAD
#if (defined NT) || (defined OLDUNIX)
#define DOUBLEPAD 8
#else
#define DOUBLEPAD 0
#endif /* NT */
#endif /* !DOUBLEPAD */ 
```

理想情况下，我想运行`-UOLDUNIX`并获得输出：

```
#ifndef DOUBLEPAD
#if (defined NT)
#define DOUBLEPAD 8
#else
#define DOUBLEPAD 0
#endif /* NT */
#endif /* !DOUBLEPAD */ 
```

这可能会推动我的运气！

动机：具有大量条件代码的大型古老代码库。许多条件不再适用 - 例如，OLDUNIX 平台不再制造且不再受支持，因此无需在代码中引用它。其他条件始终为真。例如，通过条件编译添加功能，以便单个版本的代码可用于该功能不可用的旧版本软件和可用（或多或少）的新版本。最终，不再支持没有该功能的旧版本 - 一切都使用该功能 - 因此应该删除该功能是否存在的条件，并且“当功能不存在时”代码也应该删除。一世'

（该工具的一个非常聪明的版本可能会读取`#include`'d 文件以确定控制宏（在命令行上由 -D 或 -U 指定的那些）是否在这些文件中定义。我不确定这是否真的有用，除非备份诊断。不过，无论它做什么，伪预处理器都不能逐字扩展宏或包含文件。输出必须是类似于输入代码的源代码，但通常比输入代码更简单。）

### 状态报告（一年后）

经过一年的使用，我对所选答案推荐的“ [sunifdef](https://sourceforge.net/projects/sunifdef/) ”感到非常满意。它还没有出错，我也不希望它出错。我对它的唯一质疑是风格。给定一个输入，例如：

```
#if (defined(A) && defined(B)) || defined(C) || (defined(D) && defined(E)) 
```

并使用“-UC”运行（C 从未定义），输出为：

```
#if defined(A) && defined(B) || defined(D) && defined(E) 
```

这在技术上是正确的，因为 '&&' 比 '||' 绑定得更紧密，但这是一个公开的混淆邀请。我更希望它在 '&&' 条件集周围包含括号，如原文所示：

```
#if (defined(A) && defined(B)) || (defined(D) && defined(E)) 
```

然而，鉴于我必须使用的一些代码的晦涩难懂，因为这是最大的挑剔是一种强烈的赞美；它对我来说是很有价值的工具。

* * *

### 街区新来的

在检查了上述信息中包含的 URL 后，我看到（如预期的那样）有一个名为[Coan](http://coan2.sourceforge.net/)的新程序，它是 'sunifdef' 的继承者。它在 SourceForge 上可用，自 2010 年 1 月以来一直可用。我会检查它...今年晚些时候，或者明年，或者某个时候，或者永远不会有进一步的报告。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-08T07:09:13.017

我对 C 完全一无所知，但听起来你正在寻找类似[`unifdef`](https://github.com/fanf2/unifdef). 请注意，它自 2000 年以来一直没有更新，但有一个后继者称为["Son of unifdef" (sunifdef)](https://sourceforge.net/projects/sunifdef/)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-06-20T15:58:53.303

你也可以试试这个工具[http://coan2.sourceforge.net/](http://coan2.sourceforge.net/)

这样的事情将删除 ifdef 块：

coan source -UYOUR_FLAG --filter c,h --recurse YourSourceTree

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-08T07:37:46.033

几年前我使用 unifdef 来解决您描述的那种问题，并且效果很好。即使它自 2000 年以来没有更新，预处理器 ifdefs 的语法从那时起也没有发生实质性的变化，所以我希望它仍然会做你想做的事。我想可能会有一些编译问题，尽管这些包是最近出现的。

我从来没有用过 sunifdef，所以我不能直接评论它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-08T07:36:21.557

大约在 2004 年，我编写了一个工具，它完全符合您的要求。我从来没有分发该工具，但可以在这里找到代码：

[http://casey.dnsalias.org/exifdef-0.2.zip](http://casey.dnsalias.org/exifdef-0.2.zip)（这是一个 dsl 链接）

它大约有 1.7k 行，并实现了足够的 C 语法来使用 bison 和 flex 解析预处理器语句、注释和字符串。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-10T14:39:57.370

如果您需要类似于预处理器的东西，灵活的解决方案是[Wave](http://www.boost.org/doc/libs/1_37_0/libs/wave/index.html)（来自 boost）。它是一个库，旨在构建类似 C 预处理器的工具（包括诸如 C++03 和 C++0x 预处理器之类的东西）。由于它是一个库，因此您可以挂钩它的输入和输出代码。

# ruby-on-rails - 我们可以将 RubyOnRails 用于银行和金融交易领域吗

> ID：525288
> 
> 赞同：3
> 
> 时间：2009-02-08T06:48:24.917
> 
> 标签：ruby-on-rails, frameworks, dsl, financial

我们可以使用 RubyOnRails 框架来开发金融交易和银行交易的网站吗？

RubyonRails 是银行领域的 DSL。

在 DSL 上的某些日子里，我相信银行系统的大部分事实都是静态的，它们可能不需要任何后续更改......同时。因此，定义 DSL，必须采用一种方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T05:23:04.213

银行交易都是在软件和数据库中的存储过程中完成的，独立于您银行帐户的 Web 界面，因此您可以使用任何 Web 框架，但这是您拥有 J2EE 堆栈实际上足够复杂的交易规则的唯一领域之一说得通。另一方面，RAILS 针对简单的 CRUD 进行了优化，而银行业务则不是。它是可能的，但可能不是适合这项工作的工具。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T05:20:39.320

当然可以。Ruby on Rails 可以执行与任何其他 Web 框架相同的任务。也许您应该提出一个关于您认为对于 Ruby on Rails 来说很难的特定任务的问题，我们可以解决这个问题。

Ruby on Rails 不是用于银行业务的 DSL。Ruby 使定义自己的 DSL 变得容易，而 Ruby on Rails 是一种通过 Internet 获取业务逻辑的好方法。

# asp.net - 许可 .Net 网站

> ID：525317
> 
> 赞同：2
> 
> 时间：2009-02-08T07:13:14.303
> 
> 标签：asp.net, licensing

我想知道获得网站许可的首选方法是什么？

我使用可编辑的 APSX 文件分发我的网站的预编译版本，后面的代码被编译成每个页面的单独 DLL。

在使用试用版时，我曾想过在每个页面中实现某种文本注入，类似于 Telerik 控件所做的那样。如果使用许可版本，此演示文本将消失。

我认为的一种方法是让网站联系网络服务以确定许可证状态，但如果网络服务因任何原因而关闭，这将是一个问题。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-08T21:58:45.047

让您的控件依赖外部 Web 服务来检查许可证是绝对不能接受的。你唯一能摆脱的就是惹恼客户和自己的维护问题。

我强烈建议您使用荣誉系统或非常简单的许可密钥文件（永不过期）。您销售的是网站，而不是视频游戏。除非您知道您因产品盗版而损失大量金钱，否则不要浪费您的时间。记住优化的第一条规则！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T08:02:16.623

您可以在您的网站中构建某种许可控制机制。因此，您可以使用该站点的 URL（通常您将您的 asp.net 应用程序出售给某人或两个 url），例如，您还可以在您的许可证机制中构建一些硬件密钥引用，以便您的副本软件不可能在不同的机器上运行。

但请记住，您建立的所有限制都会为您的付费客户带来更多的工作，并且总有人想尝试使用您的软件而不付费！

# c# - 属性名与类名匹配时怎么办

> ID：525319
> 
> 赞同：14
> 
> 时间：2009-02-08T07:15:14.533
> 
> 标签：c#, web-services, properties

在我们的 C# 代码中，我们有一个名为 Project 的类。我们的基础 BusinessObject 类（所有业务对象都继承自）定义了一个属性：

```
public Project Project { get; set; } 
```

只要我们留在 C# 代码库中，这通常不是问题。但是，这些业务对象类通过网络在 Web 服务中公开。一些消费语言（例如 Flex 的动作脚本）无法处理具有与其类同名的属性。

这种命名冲突在我们的代码中随处可见。有时更改属性或类的名称很容易。有时候真的很难。我们绞尽脑汁，想不出一个好的标准方法来处理这个问题。可以将 Project 类重命名为 ProjectType 或 ProjectInfo，但这很丑陋并且破坏了我们所有消费者现有的代码。我们可以保持类型名称不变并将属性名称更改为 ProjectInfo，但这会导致同样的问题。

有没有人对这种情况有任何指导或最佳实践？

编辑：

回应给出的一些建议：

*   方法不会通过网络暴露出来，所以我们不能使用方法。
*   我更喜欢一个标准的命名约定，它也符合微软自己的命名标准。
*   为 Flex 提供不同的合同可能是一种选择。但是，我们将 Weborb 用于 Flex 互操作。Weborb 使用反射来精确匹配属性名称，而不是使用 XML 或 SOAP 序列化。如果有人知道更多关于使用 Weborb 进行自定义序列化的信息，那将会很有帮助。

编辑＃2：

作为参考，我们最终将属性重命名为：

```
public Project ProjectInfo { get; set; } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-08T07:50:09.643

如果您已经使用有问题的名称提供了 Web 服务，那么听起来您遇到了一个棘手的问题。如果你不能在不破坏现有客户的情况下改变任何东西，并且你不能在不破坏 Flex 的情况下保持原样，那么就会*有人*被破坏。

您*可能*会在不同的 URL 上公开并行 API。我同意 shahkalpesh 关于属性会出现问题的 Get/Set 方法的建议。这样做的好处是您可以做出*一次*决定，然后保持一致，而不是每次都需要考虑。这也意味着您可能可以在第一个 API 的基础上自动创建第二个 API。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T16:58:24.823

我认为最好的解决方案是重构您的项目，将对象 Project 重命名为 WnProject、ProjectBase 或与项目的确切含义相关的其他名称。

这是您的 API，任何使用它的人都必须了解，可能会发布重大更改，这是依赖外部资源的成本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T07:28:13.180

好的旧方法怎么样？（GetProject/SetProject 或 .net 的方式 - Thread.CurrentThread）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T08:44:30.743

我知道这是一个老问题，但它可能对其他人有所帮助。

为什么不为不支持相同道具名称和类型的消费者提供不同的 WSDL？
重命名 WSDL 中的复杂类型（不是元素名称！）

从你现在（应该）拥有的：

```
<xs:element name="Project" type="Project"/>

<xs:complexType name="Project">
  <xs:sequence>
    <xs:element name="Title" type="xs:string"/>
    <xs:element name="Description" type="xs:string"/>
  </xs:sequence>
</xs:complexType> 
```

至：

```
<xs:element name="Project" type="ProjectType"/>

<xs:complexType name="ProjectType">
  <xs:sequence>
    <xs:element name="Title" type="xs:string"/>
    <xs:element name="Description" type="xs:string"/>
  </xs:sequence>
</xs:complexType> 
```

在这种情况下，SOAP 消息将保持完全相同，这意味着您不必重新编译您的解决方案，也不必提供其他服务。
此外，其他消费者无需更改任何内容。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-08T10:13:32.863

Although it's not really of help for external languages it is possible to alias namespaces (presumming the class Project is in a difference namespace to the class with the property Project), like so:

```
using ns = MyProject.Namespace; 
```

Then you just have to do:

```
var newProject = new ns.Project(); 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-02-08T09:52:56.727

WTF has the name of a variable in one language got to do with a web service?

Someone has to be really lazy in their XML binding for implementation details to be exposed on the wire.

The whole point of WSDL/SOA is that you have a spec for a message which is independent of implementation. If you generate message specifications from source code, or generate source from the specifications without allowing for variation of the generated objects, you end up with tightly coupled systems. One symptom of this tight coupling is getting variable/property names that aren't legal identifiers. A service (rather than an RPC) is not tightly coupled. You should not have to vary your service implementation to cater for the implementation of the service - if you have to, something in your stack is broken. That goes for member variables/properties as well as methods.

# ruby - Procs的绑定

> ID：525324
> 
> 赞同：36
> 
> 时间：2009-02-08T07:20:47.923
> 
> 标签：ruby, binding

是否可以在另一个对象的上下文中执行 proc？

我知道通常你会做 proc.call(foo)，然后块应该定义一个参数。我想知道是否可以让“self”绑定到 foo，这样就不需要块参数。

```
proc = Proc.new { self.hello }

class Foo
  def hello
    puts "Hello!"
  end
end

foo = Foo.new

# How can proc be executed within the context of foo
# such that it outputs the string "Hello"?

proc.call 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-02-08T08:07:21.993

```
foo.instance_eval &proc 
```

`instance_eval`可以采用块而不是字符串，并且`&`运算符将 proc 转换为块以与方法调用一起使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-02T01:57:06.920

这适用于 ruby​​ 1.9：

```
class MyCat
  def initialize(start, &block)
    @elsewhere = start
    define_singleton_method(:run_elsewhere, block) if block_given?
  end
end
MyCat.new('Hello'){ @elsewehere << ' world' }.run_elsewhere 
```

# python - 使用py2exe在.exe中嵌入图标，在Vista中可见？

> ID：525329
> 
> 赞同：17
> 
> 时间：2009-02-08T07:26:06.103
> 
> 标签：python, windows-vista, embed, icons, py2exe

我一直在尝试使用 py2exe 将图标 (.ico) 嵌入到我的“编译”.exe 中。

Py2Exe 确实有嵌入图标的方法：

```
windows=[{
    'script':'MyScript.py',
    'icon_resources':[(1,'MyIcon.ico')]
}] 
```

这就是我正在使用的。该图标在 Windows XP 或更低版本上显示正常，但在 Vista 上根本不显示。我想这是因为新的 Vista 图标格式，它可以是 PNG 格式，最大 256x256 像素。

那么，如何让 py2exe 将它们嵌入到我的可执行文件中，而不会破坏 Windows XP 上的图标？

我很喜欢使用外部实用程序而不是 py2exe 来做这件事——我已经尝试过[这个命令行实用程序](http://www.rw-designer.com/compile-vista-icon)来嵌入它，但它总是会破坏我的 exe 并由于某种原因截断它的大小。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-08T10:06:26.560

Vista 使用高分辨率*256x256*像素图像的图标，它们使用*基于 PNG 的*压缩存储。问题是，如果您只是制作图标并将其保存为标准 XP`ICO`格式，则生成的文件将`400Kb`在磁盘上。解决方案是压缩图像。使用的压缩方案是`PNG`（Portable Network Graphic），因为它具有良好的无损率并且支持alpha通道。

并使用

```
png2ico myicon.ico logo16x16.png logo32x32.png logo255x255.png 
```

它从 1 个或多个 's 创建一个`ICO`文件`PNG`并处理多种大小等。我猜 XP 对此没有问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-06-01T09:21:52.467

正如 Helmut 所说，似乎图标大小的顺序是关键。反转页面（首先是较大的页面）解决了 Windows 7 上的“include_resources”问题（使用 Py2exe 0.6.9）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-01T21:49:00.807

我在使用包含 32x32 像素图像的 .ico 文件在 Windows7 上使用 py2exe 嵌入图标资源时遇到问题。我使用的方法与原始问题相同。

编译后，exe上的图标消失。根据[Resource Hacker](http://www.angusj.com/resourcehacker/)工具，在调查时，图标被添加到索引 0，但如果我使用相同的工具替换图标，它会被添加到索引 1。一旦在索引 1，图标就会神奇地出现在资源管理器中，再次与 exe 相对。

如果绝望，您可以使用 Resource Hacker 来修改 exe post-build，它可以通过命令行界面编写脚本，但我尝试了上面解释的方法，并在像这样反转 png 文件后设法让它工作。

```
png2ico.exe myico.ico myico248x248.png myico48x48.png myico32x32.png myico16x16.png 
```

顺便说一句，通过将多个图标添加到 ico 文件，您将在图标索引 1 处填充资源，在本例中为 myico248x248.png。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-01-30T23:38:49.003

Greenfish Iceon Editor Pro 的链接已损坏。我扫描了网络，发现[下载 IcoFX](http://icofx.ro/downloads.html) 在我的 .exe 文件中使用了 IcoFX 程序，可以看到它确实包含我的图标。

使用菜单 Image->Create Windows Icons from Image，然后接受选择，我得到了一个新的 .ico 文件，该文件可在 win7 和 win xp 上运行。

在此之前，我的单个 48x48.ico 文件只是没有显示为程序的图标。

# c - 复制堆栈是什么意思？

> ID：525333
> 
> 赞同：2
> 
> 时间：2009-02-08T07:33:23.030
> 
> 标签：c, stack

我正在阅读**The C Programming Language**并学习了如何使用堆栈制作逆波兰计算器。以下是其后的练习之一：

> **练习 4-4。**添加命令以打印堆栈的顶部元素而不弹出，复制它，并交换顶部的两个元素。添加清除堆栈的命令。

他们所说的“重复”是什么意思？这意味着打印出整个堆栈，还是将整个堆栈压入自身（例如，“1 2 3”将变为“1 2 3 1 2 3”），还是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-08T07:38:15.250

不，在堆栈顶部复制*单个*元素更有意义。我怀疑“打印顶部元素”是一个错字，应该是单数的“打印顶部元素”。

这种情况更有可能发生的*原因*是因为打印“顶级元素”本身没有任何意义。如果它是堆栈的某个子集而不仅仅是顶部元素，则需要指定一个计数（并且它不需要），或者，如果它意味着它们全部，则根本不需要“顶部”限定符。

这意味着在这种情况下，主题“它”是指“堆栈的顶部元素”，而不是“堆栈”。

因此，如果您的堆栈是：

```
[1,2,3,4,5] 
```

`1`作为第*一个*被推送的元素和最后一个元素`5`，复制会给你：

```
[1,2,3,4,5,5]. 
```

* * *

假设您已经具备基本操作`push`，`pop`您可能需要添加`count`和`peek`，这将分别为您提供当前元素计数和堆栈的顶部元素（基本上是 a`pop`但不删除它）。

然后可以从这些基本操作（伪代码）构建其余代码，例如：

```
def printTop(stack):
    print stack.peek()

def duplicateTop(stack):
    stack.push(stack.peek())

def swapTopTwo(stack):
    one = stack.pop()
    two = stack.pop()
    stack.push(one)
    stack.push(two)

def clear(stack):
    while stack.count() > 0:
        junk = stack.pop() 
```

这可能是实现它们的*最简单*方法，尽管如果您编写函数并假设您拥有比调用基本操作更多的功能，则可能会提高效率。例如，您可以`swapTopTwo`通过就地交换两个元素而不是弹出和推送（以 开头的变量`_`是以下实现的内部变量）：

```
def swapTopTwo(stack):
    if stack._count < 2: raise error
    temp = stack.data[_count - 2]
    stack.data[_count - 2] = stack.data[_count - 1]
    stack.data[_count - 1] = temp 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T07:43:08.987

维基百科中[面向堆栈的编程语言](http://en.wikipedia.org/wiki/Stack-oriented_programming_language)条目包含对堆栈操作操作的描述：

> 堆栈操作
> 
> 由于堆栈是面向堆栈的编程语言中数据操作的关键手段，因此这些语言通常提供某种堆栈操作运算符。常用的有**dup，复制栈顶元素**，exch（或swap），交换栈顶元素（第一个变成第二个，第二个变成第一个），roll，循环置换堆栈中的元素或堆栈的一部分，pop（或drop），丢弃堆栈顶部的元素（push是隐式的），以及其他。这些成为学习程序的关键。

# jquery - 我是否需要包含 jquery 版本文件才能使用 jquery.ui.js？

> ID：525336
> 
> 赞同：8
> 
> 时间：2009-02-08T07:34:08.847
> 
> 标签：jquery, jquery-ui

我想使用 jquery-ui 小部件，所以我包括 jquery.ui.js。我还需要包含 jquery 版本文件吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-08T07:46:01.383

如果你想使用 jQuery.UI，你必须包含 jQuery.js。

[jQuery.UI](http://plugins.jquery.com/project/ui)是一个 jQuery 插件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-08T07:46:56.263

这真的取决于你想做什么。如果你只需要基本的 DOM 操作，甚至处理，以及类似的东西，那么使用 jquery.js。如果您需要高级 UI 组件和功能（拖放、排序等），那么您可能需要 jquery.ui.js。

**编辑**我误读问题的错误。是的，对于 jquery.ui.js，您需要 jquery.js

# ruby - rspec 和 heckle 的兼容性如何？

> ID：525362
> 
> 赞同：2
> 
> 时间：2009-02-08T07:51:12.543
> 
> 标签：ruby, rspec, cucumber, mutation-testing, heckle

我目前正在使用测试/单元，并且正在考虑使用 rspec。但是，我注意到 rspec[目前](http://github.com/dchelimsky/rspec/blob/6b35223b547488e024c0d86b0ca9298437e49769/TODO.txt)在 ruby​​ 1.9.1 中不支持 heckle，并且除了目标模块/类/方法之外，不支持将任何参数传递给 heckle。

使用 heckle 和 rspec 是否还有其他当前问题，或者除了这两个问题之外它们是否可以很好地协同工作？

另外，如果我暂时使用测试/单元，我应该考虑将它与黄瓜一起使用吗？

**编辑**：1.9.1 的问题不是 rspec 的错 - heckle 不能在[ruby​​ 1.9.1](http://rubyforge.org/tracker/index.php?func=detail&aid=24550&group_id=1513&atid=5924)上运行，因为 parsetree 不能在 ruby​​ 1.9.1 上运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T09:35:15.237

上次查的时候，Heckle+RSpec 效果不是很好，想来也没有多少人一起用。

早在 2008 年春天，我对此进行了调查，并注意到 RSpec 和 Heckle 已经有一段时间没有一起工作了。我做了一个补丁，它被 RSpec 1.1.14 接受。即使在进行了这些更改之后，我也没有发现 Heckle 很有用。如果我没记错的话，问题是 Heckle 本身会因非平凡的程序而崩溃。

真是可惜，情况就是这样。如果您想提供帮助，您可能需要查看 boo-hiss 项目：http: [//github.com/halorgium/boo_hiss/tree/master](http://github.com/halorgium/boo_hiss/tree/master)。

**更新：**经过两年的中断，上周发布了新版本的 Heckle ( [Heckle 1.4.2 )。](http://rubyforge.org/frs/shownotes.php?group_id=1513&release_id=31191)也许这解决了我遇到的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T18:30:34.187

我目前正在运行 heckle 1.4.2 和 rspec 1.2.4 来测试[Addressable](http://addressable.rubyforge.org/)。我建议直接使用 spec 命令来解决任何问题，而不是通过 rake 任务进行设置。Heckling 是我通常在发布之前做的事情，而不是在常规开发期间，因为它非常耗时。当你试图追踪幸存的突变时，你可能想要逐个方法。

旧版本的 RSpec 更加健谈——为所有失败的规范倾倒完整的规范结果——但我发送了一个修复该问题的补丁。任何最近的版本都没有这个问题，并且质问应该可以正常工作。

例如：

```
spec spec/**/*_spec.rb --heckle Addressable::URI#normalize 
```

输出：

```
**********************************************************************
***  Addressable::URI#normalize loaded with 25 possible mutations
**********************************************************************

25 mutations remaining...
24 mutations remaining...
23 mutations remaining...
22 mutations remaining...
21 mutations remaining...
20 mutations remaining...
19 mutations remaining...
18 mutations remaining...
17 mutations remaining...
16 mutations remaining...
15 mutations remaining...
14 mutations remaining...
13 mutations remaining...
12 mutations remaining...
11 mutations remaining...
10 mutations remaining...
9 mutations remaining...
8 mutations remaining...
7 mutations remaining...
6 mutations remaining...
5 mutations remaining...
4 mutations remaining...
3 mutations remaining...
2 mutations remaining...
1 mutations remaining...
No mutants survived. Cool! 
```

（结果不典型。）

# c# - 如何在 C# 中从网站下载文件

> ID：525364
> 
> 赞同：66
> 
> 时间：2009-02-08T07:52:23.973
> 
> 标签：c#, download, windows

是否可以从 Windows 应用程序表单中的网站下载文件并将其放入某个目录？

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2009-02-08T07:56:59.583

使用[WebClient 类](http://msdn.microsoft.com/en-us/library/ez801hhe.aspx)：

```
using System.Net;
//...
WebClient Client = new WebClient ();
Client.DownloadFile("http://i.stackoverflow.com/Content/Img/stackoverflow-logo-250.png", @"C:\folder\stackoverflowlogo.png"); 
```

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2009-02-08T07:54:27.513

使用[`WebClient.DownloadFile`](http://msdn.microsoft.com/en-us/library/system.net.webclient.downloadfile.aspx)：

```
using (WebClient client = new WebClient())
{
    client.DownloadFile("http://csharpindepth.com/Reviews.aspx", 
                        @"c:\Users\Jon\Test\foo.txt");
} 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2016-01-19T14:27:55.810

在发出请求之前，您可能需要知道文件下载期间的状态或使用凭据。

**这是一个涵盖这些选项的示例：**

```
Uri ur = new Uri("http://remotehost.do/images/img.jpg");

using (WebClient client = new WebClient()) {
    //client.Credentials = new NetworkCredential("username", "password");
    String credentials = Convert.ToBase64String(Encoding.ASCII.GetBytes("Username" + ":" + "MyNewPassword"));
    client.Headers[HttpRequestHeader.Authorization] = $"Basic {credentials}";

    client.DownloadProgressChanged += WebClientDownloadProgressChanged;
    client.DownloadDataCompleted += WebClientDownloadCompleted;
    client.DownloadFileAsync(ur, @"C:\path\newImage.jpg");
} 
```

回调函数实现如下：

```
void WebClientDownloadProgressChanged(object sender, DownloadProgressChangedEventArgs e)
{
    Console.WriteLine("Download status: {0}%.", e.ProgressPercentage);

    // updating the UI
    Dispatcher.Invoke(() => {
        progressBar.Value = e.ProgressPercentage;
    });
}

void WebClientDownloadCompleted(object sender, DownloadDataCompletedEventArgs e)
{
    Console.WriteLine("Download finished!");
} 
```

**(Ver 2) - Lambda 表示法：处理事件的其他可能选项**

```
client.DownloadProgressChanged += new DownloadProgressChangedEventHandler(delegate(object sender, DownloadProgressChangedEventArgs e) {
    Console.WriteLine("Download status: {0}%.", e.ProgressPercentage);

    // updating the UI
    Dispatcher.Invoke(() => {
        progressBar.Value = e.ProgressPercentage;
    });
});

client.DownloadDataCompleted += new DownloadDataCompletedEventHandler(delegate(object sender, DownloadDataCompletedEventArgs e){
    Console.WriteLine("Download finished!");
}); 
```

**(Ver 3) - 我们可以做得更好**

```
client.DownloadProgressChanged += (object sender, DownloadProgressChangedEventArgs e) =>
{
    Console.WriteLine("Download status: {0}%.", e.ProgressPercentage);

    // updating the UI
    Dispatcher.Invoke(() => {
        progressBar.Value = e.ProgressPercentage;
    });
};

client.DownloadDataCompleted += (object sender, DownloadDataCompletedEventArgs e) => 
{
    Console.WriteLine("Download finished!");
}; 
```

**（版本 4）- 或**

```
client.DownloadProgressChanged += (o, e) =>
{
    Console.WriteLine($"Download status: {e.ProgressPercentage}%.");

    // updating the UI
    Dispatcher.Invoke(() => {
        progressBar.Value = e.ProgressPercentage;
    });
};

client.DownloadDataCompleted += (o, e) => 
{
    Console.WriteLine("Download finished!");
}; 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-02-08T07:54:53.627

当然，您只需使用[`HttpWebRequest`](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest(VS.71).aspx).

`HttpWebRequest`设置完成后，您可以将响应流保存到一个文件（`StreamWriter`取决于mimetype`BinaryWriter`或 a ），并且您的硬盘驱动器上有一个文件。`TextWriter`

编辑：忘记了`WebClient`。除非您只需要使用`GET`来检索文件，否则效果很好。如果该站点要求您向其`POST`提供信息，则您必须使用 a `HttpWebRequest`，因此我将保留我的答案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-10-07T09:29:56.873

您可以使用此代码将文件从网站下载到桌面：

```
using System.Net;

WebClient client = new WebClient ();
client.DownloadFileAsync(new Uri("http://www.Address.com/File.zip"), Environment.GetFolderPath(Environment.SpecialFolder.Desktop) + "File.zip"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-16T17:28:20.907

试试这个例子：

```
public void TheDownload(string path)
{
  System.IO.FileInfo toDownload = new System.IO.FileInfo(HttpContext.Current.Server.MapPath(path));

  HttpContext.Current.Response.Clear();
  HttpContext.Current.Response.AddHeader("Content-Disposition",
             "attachment; filename=" + toDownload.Name);
  HttpContext.Current.Response.AddHeader("Content-Length",
             toDownload.Length.ToString());
  HttpContext.Current.Response.ContentType = "application/octet-stream";
  HttpContext.Current.Response.WriteFile(patch);
  HttpContext.Current.Response.End();
} 
```

实现如下：

```
TheDownload("@"c:\Temporal\Test.txt""); 
```

来源：[http ://www.systemdeveloper.info/2014/03/force-downloading-file-from-c.html](http://www.systemdeveloper.info/2014/03/force-downloading-file-from-c.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-16T06:05:47.387

您也可以在课堂上使用`DownloadFileAsync`方法。`WebClient`它将具有指定的资源下载到本地文件`URI`。此方法也不会阻塞调用线程。

样本：

```
 webClient.DownloadFileAsync(new Uri("http://www.example.com/file/test.jpg"), "test.jpg"); 
```

**了解更多信息：**

> [http://csharpexamples.com/download-files-synchronous-asynchronous-url-c/](http://csharpexamples.com/download-files-synchronous-asynchronous-url-c/)

# c++ - std::stack 是否公开迭代器？

> ID：525365
> 
> 赞同：38
> 
> 时间：2009-02-08T07:53:06.830
> 
> 标签：c++, stl, stack

C++ STL 中的是否`std::stack`公开了底层容器的任何迭代器，还是应该直接使用该容器？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-02-08T08:02:06.357

根据堆栈的定义，堆栈没有迭代器。如果您需要带有迭代器的堆栈，您需要自己在其他容器（std::list、std::vector 等）之上实现它。 [堆栈文档在这里](http://en.cppreference.com/w/cpp/container/stack)。

PS 根据我从 Iraimbilanja 得到的评论，std::stack 默认使用 std::deque 来实现。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-08T18:01:10.767

如果你需要一个带有迭代器的栈，你有两种选择：

*   `std::vector`使用`push_back()`, `pop_back()`.

*   `std::deque`使用`push_back()`/`pop_back()`或`push_front()`/ `pop_front()`。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-02-27T05:43:23.850

确实通过其受保护的接口将`std::stack`其底层容器（以及迭代器）暴露给*子类。*的`std::stack`基础容器对象对应于（受保护的）数据成员`c`。所以如果你想访问它们，你可以扩展`std::stack`一点。

```
template<typename T, typename Container = std::deque<T>>
class iterable_stack
: public std::stack<T, Container>
{
    using std::stack<T, Container>::c;

public:

    // expose just the iterators of the underlying container
    auto begin() { return std::begin(c); }
    auto end() { return std::end(c); }

    auto begin() const { return std::begin(c); }
    auto end() const { return std::end(c); }
};

int main()
{
    iterable_stack<int> st;

    st.push(2);
    st.push(5);
    st.push(3);
    st.push(7);
    st.push(9);

    for(auto i: st)
        std::cout << i << ' ';
    std::cout << '\n';
} 
```

**输出：**

```
2 5 3 7 9 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-08T08:01:08.917

在[SGI](http://www.sgi.com/tech/stl/stack.html)、[MSDN](http://msdn.microsoft.com/en-us/library/h9sh48d5.aspx)和[GNU](http://gcc.gnu.org/onlinedocs/libstdc++/latest-doxygen/a00530.html)文档中，`stack`不提供迭代器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-10T12:16:09.613

你在问

> std::stack 是否公开迭代器？

很多人给出了答案。如果我的英语更好，我可能也会理解“暴露”的确切含义。

如果我们指的是 STL 和类 s​​td::stack 以及这里定义的预定义函数，答案是否定的。

我的猜测是你在问，因为你想要迭代器。

所以，如果我们更进一步，我们就有了函数 top()。并且 top() 可以解释为取消引用的迭代器。有了它，我们可以很容易地定义迭代器来堆叠元素。堆栈的内存保证是连续的。

见下文。我们正在为 std::copy 定义和使用迭代器：

```
#include <vector>
#include <stack>
#include <iostream>
#include <algorithm>
#include <iterator>
#include <sstream>

using Number = int;
using UnderlyingContainer = std::vector<Number>;
using Stack = std::stack< Number, UnderlyingContainer>;

using StackIterator = const Number *;

std::istringstream testData("5 8 1 4 9 3");

int main()
{
    // Put the test data onto the stack
    Stack stack{ UnderlyingContainer {std::istream_iterator<Number>(testData),std::istream_iterator<Number>()} };

    // Print the test data
    // Get iterators
    StackIterator end = &stack.top() + 1;
    StackIterator begin = end - stack.size();

    if (not stack.empty())
        std::copy(begin, end, std::ostream_iterator<Number>(std::cout, "\n"));
    return 0;
} 
```

因此，您可以为堆栈创建迭代器。但是，请注意：

std::stack 故意将其元素隐藏在引擎盖下。因此，如果您对数据进行写访问，我会将其视为设计错误。通过 const 指针/迭代器进行读取访问对我来说是可以的。但也许你应该更好地使用 std::vector 。. .

# c# - 使用哪种设计模式来过滤查询？C＃

> ID：525370
> 
> 赞同：13
> 
> 时间：2009-02-08T07:55:33.593
> 
> 标签：c#, asp.net, design-patterns

我有一个包含产品（服装）列表的数据库表。产品属于类别，来自不同的商店。

样品类别：上衣、下装、鞋子

示例商店：gap.com、macys.com、target.com

我的客户可以通过以下方式请求过滤产品：

*   所有产品（无过滤器）
*   按类别
*   按商店
*   按类别和商店

现在我的“产品”类中有一个方法，它根据用户请求的过滤器类型返回产品。我使用 FilterBy 枚举来确定需要退回哪些产品。

例如，如果用户想要查看“tops”类别中的所有产品，我调用此函数：

```
Products.GetProducts(FilterBy.Category, "tops", ""); 
```

我将最后一个参数设为空，因为它是包含要过滤的“商店”的字符串，但在这种情况下没有商店。但是，如果用户想按类别过滤并存储，我会这样调用该方法：

```
Product.GetProducts(FilterBy.CategoryAndStore, "tops", "macys.com"); 
```

我的问题是，有什么更好的方法来做到这一点？我刚刚了解了策略设计模式。我可以用它以更好（更容易扩展和更容易维护）的方式来做到这一点吗？

我问这个问题的原因是因为我认为这一定是人们反复解决的一个非常普遍的问题（以各种方式过滤产品）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-08T12:18:14.297

根据 Eric Evan 的“域驱动设计”，您需要规范模式。像这样的东西

```
public interface ISpecification<T>
{
  bool Matches(T instance);
  string GetSql();
}

public class ProductCategoryNameSpecification : ISpecification<Product>
{
  readonly string CategoryName;
  public ProductCategoryNameSpecification(string categoryName)
  {
    CategoryName = categoryName;
  }

  public bool Matches(Product instance)
  {
    return instance.Category.Name == CategoryName;
  }

  public string GetSql()
  {
    return "CategoryName like '" + { escaped CategoryName } + "'";
  }
} 
```

现在可以使用规范调用您的存储库

```
var specifications = new List<ISpecification<Product>>();
specifications.Add(
 new ProductCategoryNameSpecification("Tops"));
specifications.Add(
 new ProductColorSpecification("Blue"));

var products = ProductRepository.GetBySpecifications(specifications); 
```

您还可以创建一个通用的 CompositeSpecification 类，该类将包含子规范和一个关于将哪个逻辑运算符应用于它们的指示符 AND/OR

不过，我更倾向于结合 LINQ 表达式。

**更新 - 运行时的 LINQ 示例**

```
var product = Expression.Parameter(typeof(Product), "product");
var categoryNameExpression = Expression.Equal(
  Expression.Property(product, "CategoryName"),
  Expression.Constant("Tops")); 
```

你可以像这样添加一个“和”

```
var colorExpression = Expression.Equal(
  Expression.Property(product, "Color"),
  Expression.Constant("Red"));
var andExpression = Expression.And(categoryNameExpression, colorExpression); 
```

最后，您可以将此表达式转换为谓词，然后执行它...

```
var predicate = 
  (Func<Product, bool>)Expression.Lambda(andExpression, product).Compile();
var query = Enumerable.Where(YourDataContext.Products, predicate);

foreach(Product currentProduct in query)
  meh(currentProduct); 
```

可能不会编译，因为我直接在浏览器中输入了它，但我相信它通常是正确的。

**另一个更新**:-)

```
List<Product> products = new List<Product>();
products.Add(new Product { CategoryName = "Tops", Color = "Red" });
products.Add(new Product { CategoryName = "Tops", Color = "Gree" });
products.Add(new Product { CategoryName = "Trousers", Color = "Red" });
var query = (IEnumerable<Product>)products;
query = query.Where(p => p.CategoryName == "Tops");
query = query.Where(p => p.Color == "Red");
foreach (Product p in query)
    Console.WriteLine(p.CategoryName + " / " + p.Color);
Console.ReadLine(); 
```

在这种情况下，您将在内存中进行评估，因为源是一个列表，但是如果您的源是支持 Linq2SQL 的数据上下文，我**认为**这将使用 SQL 进行评估。

您仍然可以使用规范模式来明确您的概念。

```
public class Specification<T>
{
  IEnumerable<T> AppendToQuery(IEnumerable<T> query);
} 
```

这两种方法的主要区别在于后者基于显式属性构建已知查询，而第一种可用于构建任何结构的查询（例如完全从 XML 构建查询。）

这应该足以让你开始:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T08:04:56.790

策略模式不一定与通用的基于接口的存储库方法结合得很好。就个人而言，我可能会在这里采取以下两种方式之一：

*   一种支持选项组合的搜索方法：

    `IList<Product> GetProducts(string category, string store, ...);`

（然后有选择地应用过滤器的**组合**（即`null`表示“任何”） - 无论是在构建命令时，还是传递给执行类似操作的 SPROC。

*   使用 LINQ，也许是谓词表达式？

    `IList<Product> GetProducts(Expression<Func<Product,bool>> predicate);`

当然，使用 LINQ，您还可以使用调用者的组合，但是要为以下内容编写一个封闭的/经过全面测试的存储库更难：

```
 `IQueryable<Product> Products {get;}` 
```

（并让调用者使用 .Where(x=>x.Category == "foo")） - 我不太确定最后一个长期...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-08T08:10:38.557

我想我会创建一个 Category 类和一个 Store 类，而不仅仅是字符串：

```
class Category
{
  public Category(string s)
  {
    ...
  }
  ...
} 
```

然后也许：

```
Product.GetProducts(
  Category category, //if this is null then don't filter on category
  Store store //if this is null then don't filter on store
  )
{
  ...
} 
```

`Category`和类可能是相关的`Store`（它们可能都是类的子`Filter`类）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-08T08:05:30.627

我是根据我对模式的一点了解来回答这个问题的。

装饰器模式在这里可能会有所帮助（考虑到您可以添加过滤器并获取结果。在其上应用新过滤器并获取新结果）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-08T08:28:32.717

我会采用类似于过滤器本身的策略并编写**CategoryFilter**和**StoreFilter**类。然后我会使用复合或装饰器来组合过滤器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-08T18:55:13.233

你不能在这里添加 Where 的东西吗？

```
var products = datacontext.Products;

if(!String.IsNullOrEmpty(type))
  products = products.Where(p => p.Type == type);

if(!String.IsNullOrEmpty(store))
  products = products.Where(p => p.Store == store);

foreach(var p in products)
  // Do whatever 
```

或类似的东西...

# windows - 如何诊断 Windows 访问/权限错误

> ID：525376
> 
> 赞同：0
> 
> 时间：2009-02-08T08:01:18.013
> 
> 标签：windows, permissions, registry, dns, profile

标题说了算。我正在寻找一种方法来确定该可执行文件正在尝试访问哪个文件/注册表项。我尝试使用 Windows[审核功能](http://support.microsoft.com/kb/315416)和[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)来确定故障发生的位置，但是，此故障不会产生审核失败事件或在 Process Monitor 中显示为拒绝访问。

当然，如果有人经历过这种情况并且可以提供直接解决错误的解决方案，那将几乎一样好。

背景：

我正在使用 moveuser.exe，它是[Windows Server 2003 资源工具包工具](http://www.microsoft.com/downloads/details.aspx?familyid=9d467a69-57ff-4ae7-96ee-b18c4790cffd&displaylang=en)的一部分，用于转换多个 Windows XP 工作站上本地用户配置文件的安全性。

症状：

有时，moveuser.exe 将无法转换配置文件的安全性，并出现错误“错误：5 访问被拒绝”。我无法确定失败帐户或它们所在的计算机之间的任何共性。一台给定的计算机可能有 6 个主机配置文件，其中 5 个转换没有问题，1 个产生错误。

我确信有几个因素：

- 我用来运行 moveuser.exe 的帐户对本地计算机和配置文件安全性转换到的域具有完全的管理员权限。

- 失败与配置文件目录中的文件权限无关（整个目录可以移动、重命名、删除或通过变通方法成功转换）。

我已经为这些情况开发了一个可靠的解决方法，但是它相当复杂，我更愿意了解这个错误的根本原因并先发制人地纠正它。

我的解决方法（很高兴分享它，为了简洁而省略）似乎表明失败与 HKEY_LOCAL_MACHINE \ SOFTWARE\ Microsoft\ Windows NT \ CurrentVersion \ ProfileList 注册表项有关，但是我无法确定确切的方式/原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-08T09:28:40.007

您是否尝试使用“regini”命令行工具来获取管理员帐户的注册表权限？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T19:13:20.880

使用 FileMon 和 RegMon（现在是 Microsoft，以前的 SysInternals，仍然免费）监控正在访问的内容、方式以及请求的权限/访问权限。

我没有方便的 URL，但 Google 搜索应该能够让您使用这些工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T02:36:39.500

我会尝试一些项目。首先，可能是用户已登录并且计算机尚未重新启动。Microsoft 有一个名为[UPHClent](http://www.microsoft.com/downloadS/details.aspx?familyid=1B286E6D-8912-4E18-B570-42470E2F3582&displaylang=en)的产品，它有助于卸载不需要的用户配置单元。

接下来我想知道的是，如果您在运行 moveuser 可执行文件之前尝试重新启动。此[对话](http://www.eggheadcafe.com/forumarchives/windowsservermigration/Oct2005/post24224418.asp)似乎表明这将有助于解决此类错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T06:47:44.037

发布此消息两天后，我找到了问题的根源。事实证明，正如 Rob Haupt 建议的与卡住的用户蜂巢有关。我正在运行的程序 moveuser 正在读取在下面找到的 Refcount 键`HKEY_LOCAL_MACHINE\ SOFTWARE\ Microsoft\ Windows NT\ CurrentVersion\ ProfileList\ <SID>\`并立即结束。

将 Refcount 设置为 0 立即解决了问题

先发制人地向所有目标机器推出[UPHClean几乎消除了问题，上周我们能够在数百台机器上成功转换配置文件。](http://www.microsoft.com/downloadS/details.aspx?familyid=1B286E6D-8912-4E18-B570-42470E2F3582&displaylang=en)

关于 UPHClean 的重要说明：

我之前尝试过安装它，但它似乎没有帮助。我太不耐烦了，[UPHClean 自述文件](http://download.microsoft.com/download/a/8/7/a87b3d05-cd04-4743-a23b-b16645e075ac/readme.txt)显示该服务只需要时间来完成它的工作。

# asp.net - 如何更改动态数据为我生成的实体关系 URL？

> ID：525397
> 
> 赞同：1
> 
> 时间：2009-02-08T08:17:40.663
> 
> 标签：asp.net, dynamic-data

我正在使用 ASP.NET 动态数据创建一个具有两个方面的网站 - 一个只能查看数据的公共视图，以及一个发生所有 CRUD 操作的管理站点。我希望这是一个单一的 DD 网站。

我设置了两条路线：

```
 routes.Add(new DynamicDataRoute("admin/{table}/{action}.aspx")
    {
        Constraints = new RouteValueDictionary(new { action = "List|Details|Edit|Insert" }),
        Model = model
    }); 
```

和

```
 routes.Add(new DynamicDataRoute("{table}")
    {
        Action = PageAction.List,
        ViewName = "ListPublic",
        Model = model
    }); 
```

问题是，当我查看我的公共页面 ListPublic（原始 List.aspx 的副本）时，它可以正常工作，只是到相关实体的链接使用**admin/Suppliers/Details.aspx?SupplierId=1**的 URL 。 . 当我希望他们指向的是 **Suppliers/Details.aspx?SupplierId=1**

如何控制如何为动态数据中的关系呈现 URL？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-08T08:30:30.263

好的，事实证明，我通过谷歌搜索帮助了自己。似乎实际上有一个名为 ForeignKey.aspx 的字段模板，它将 URL 绑定到 GetNavigateUrl() 的值。

我想我现在的问题是：

*   GetNavigateUrl 做什么？
*   使用动态数据实现公共和私人网站的结果的最佳方法是什么

# jsp - 是否可以在 Web Session 中进行会话

> ID：525398
> 
> 赞同：0
> 
> 时间：2009-02-08T08:18:15.250
> 
> 标签：jsp, url-rewriting, session

我正在开发一个应用程序，我需要在同一台机器上支持多个浏览器实例，但用户登录不同！就我们打开两个不同的 IE 进程实例而言，服务器端会有不同的会话，但 Firefox 的情况并非如此（如果我错了，请纠正我）。那么有什么方法可以以某种方式将登录特定信息与进入 Web 服务器的每个 HTTP 请求（GET / POST）链接起来。我正在探索 URL 重写/cookie，但没有得到正确的想法。

请分享您的想法/观点。

谢谢，

贾坦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T08:44:44.773

虽然这可以通过在应用程序中使用的所有 URL 中传递某种令牌来实现，但它会非常脆弱。

你真的，真的需要回到那些赞助需求的人那里，让他们知道这个特殊的需求非常昂贵，他们真的想继续吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T09:24:30.170

如果您使用 NT 身份验证，它将自动工作。用户必须使用“以用户身份运行”来启动 IE 或 FireFox。

使用 Forms 身份验证，一个想法是让人们通过组合框轻松切换用户。使用会话对象来记住会话可以切换到哪些用户。

另一种选择是更改身份验证系统。允许用户使用一个新角色来完成这两个角色。

另一种选择是告诉您的用户运行不同的 IE 实例，默认情况下它们将支持不同的表单登录。或者一个Firefox和一个IE。

我拒绝采用动态链接或会话 ID 的方式。那不值得努力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T08:34:04.530

编辑：再三考虑，我认为您将不得不动态更改所有链接以在变量中包含会话 ID。

更多分析：

这是在评论中进行的，然后太长了。

我想你可以像传统一样使用一个会话和 cookie 来做到这一点。当用户第二次登录时，您将其记录为“2”集或一些通用标识符。然后使用像（我只知道 php）“...index.php?user=2”这样的 url。然后，当用户点击链接时，它可以与手头的数据相关联。这样，会话 ID 就不会出现在 URL 之外，并且每个用户只需要一个会话。

还有一个想法：由于它是同一个现实生活中的人，因此可能在页面顶部有一个下拉菜单：“执行操作为：”。

# c# - C# 中的 OnUpdateMenuUI？

> ID：525403
> 
> 赞同：1
> 
> 时间：2009-02-08T08:28:55.697
> 
> 标签：c#, menu

当用户尝试打开菜单项时，是否有任何机制可以让我获得更新通知，例如在 MFC 中。我知道没有直接的方法，但应该有很多黑客，这就是我要问的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-08T09:21:42.173

什么架构？

在 winforms ( `MenuStrip`) 中你可以使用`DropDownOpening`事件 - 那可以吗？

在较旧的 上`MenuItem`，有`Popup`类似的事件。

我不确定WPF ...

这证明了两者（`MenuItem`首先，然后`ToolStripMenuItem`）：

```
using System;
using System.Windows.Forms;
static class Program {
    [STAThread]
    static void Main() {
        // older menuitem
        MenuItem mi;
        using (Form form = new Form {
            Menu = new MainMenu {
                MenuItems = {
                    (mi = new MenuItem("abc"))
                }
            }
        })
        {
            mi.MenuItems.Add("dummy");
            mi.Popup += delegate {
                mi.MenuItems.Clear();
                mi.MenuItems.Add(DateTime.Now.ToLongTimeString());
            };
            Application.Run(form);
        }

        MenuStrip ms;
        ToolStripMenuItem tsmi;
        using (Form form = new Form {
            MainMenuStrip = (ms = new MenuStrip {
                Items = {
                    (tsmi = new ToolStripMenuItem("def"))
                }
            })
        })
        {
            form.Controls.Add(ms);
            tsmi.DropDownItems.Add("dummy");
            tsmi.DropDownOpening += delegate {
                tsmi.DropDownItems.Clear();
                tsmi.DropDownItems.Add(DateTime.Now.ToLongTimeString());
            };
            Application.Run(form);
        }
    }
} 
```

# python - 标头函数中存在pycurl请求吗？

> ID：525405
> 
> 赞同：2
> 
> 时间：2009-02-08T08:32:58.153
> 
> 标签：python, libcurl, pycurl

当我想在标题或写入函数中取消下载时，在 C 中返回 -1。在 pycurl 我得到这个错误

```
pycurl.error: invalid return value for write callback -1 17 
```

我不知道 17 是什么意思，但我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-08T10:00:13.483

来自 pycurl.c：

```
else if (PyInt_Check(result)) {
    long obj_size = PyInt_AsLong(result);
    if (obj_size < 0 || obj_size > total_size) {
        PyErr_Format(ErrorObject, "invalid return value for write callback %ld %ld", (long)obj_size, (long)total_size);
        goto verbose_error;
    } 
```

这意味着 17 是 total_size - 这可能吗？-1（结果）是您的回调返回的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-21T05:05:28.803

```
import pycurl
import StringIO

c = pycurl.Curl()
s = StringIO.StringIO()
c.setopt(pycurl.URL, url)
c.setopt(pycurl.HEADER, True)
c.setopt(pycurl.NOBODY, True)
c.setopt(pycurl.WRITEFUNCTION, s.write)
c.perform()

print(s.getvalue()) 
```

# java - 将 Spring Web App 从 tomcat 5.5 迁移到 tomcat 6.0 的问题

> ID：525408
> 
> 赞同：3
> 
> 时间：2009-02-08T08:38:29.607
> 
> 标签：java, spring, tomcat, spring-security

我有一个在 tomcat 5.5 上运行良好的 Spring Web 应用程序。我试图将相同的 Web 应用程序部署到 tomcat 6 容器并遇到一些问题。

我遇到的主要两个问题与为 jstl 配置容器和让 spring 安全登录正常工作有关。

我相信我已经通过在 $CATALINA_HOME/lib 目录中包含[这里](https://maven-repository.dev.java.net/repository/jstl/jars/)的 jstl-1.2.jar lib 解决了 jstl 配置问题（尽管它确实看起来很奇怪，很难找到如何让它工作）。

现在的主要问题是，当我尝试使用基于表单的身份验证登录时，当登录表单提交到“j_spring_security_check”时出现 HTTP 404 错误。

我已经根据 spring 安全文档在 web.xml 文件中设置了过滤器，但似乎 tomcat 没有按预期调用它。

我希望有人可以在这里分享他们的经验，因为我肯定在我的配置中缺少一些基本的东西。

谢谢。

**更新：**虽然根据此处的响应进行故障排除，但我最终做的一件事是下载一个新的 tomcat 6.0.18 副本，并确保我在 WEB-INF/lib 目录中有 jstl-1.2.jar 文件。有趣的是，现在该应用程序似乎运行良好。

我有点难过，但我现在将尝试找出导致错误的两个 tomcat 安装的差异，并在此处发布进一步的更新。

感谢您对这些家伙的回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T12:33:28.837

根据您提供的信息，很难判断出了什么问题。

Tomcat 5.x 及更早版本中常用的共享库位于 common/lib 中；现在它们属于 /lib 目录。

就个人而言，我更喜欢在部署的 WEB-INF/lib 中尽可能多地放置，因为我不想依赖以特定方式设置服务器。如果类加载器可以在我的 WAR 文件中找到它需要的所有 JAR，我很高兴。

Tomcat 5.x 和 6.x 都使用 JSTL 1.2 版 JAR，所以这很常见。就是位置变了。我建议在 WEB-INF/lib 中使用您需要的 JAR 构建您的 WAR 文件。

如果您使用的是 Spring Security（以前称为 ACEGI 的模块），请确保您也有这些 JAR 可用。

HTTP 404 - 确定不只是部署或 URL 问题？

尝试通过将 Spring 安全性从配置文件中注释掉并重新启动来关闭它。如果其他一切正常，您的应用程序应该会立即启动。然后你就会知道你必须集中精力。如果没有，您可以继续搜索还有什么问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T08:51:17.897

如果您使用 maven，则需要 jstl ：

```
 <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>jstl</artifactId>
        <version>1.2</version>
        <scope>runtime</scope>
    </dependency> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T00:55:03.687

我同意达菲莫，没有足够的信息。尝试在您的应用程序中打开详细日志记录，看看日志中是否有任何明显的内容。

# .net - .NET 远程线程模型

> ID：525413
> 
> 赞同：2
> 
> 时间：2009-02-08T08:44:04.540
> 
> 标签：.net, multithreading, remoting, marshalbyrefobject

我想知道如何使用 MarshalByRef 对象在服务器端处理线程。

鉴于我的远程 MarshalByRef 课程：

```
public class MyRemotedClass : MarshalByRef
{
  public int MyInt;
  public string MyString;
} 
```

客户端代码（单线程）：

```
MyRemotedClass m = GetSomehowMyRemotedClass(); 
m.MyInt = 5; // Write operation 1
m.MyString = "Hello World"; // Write operation 2 
```

在服务器端，我们有两个写操作。我假设线程来自线程池。但是，由于该类是 MarshalByRef，因此两个操作都是单独的远程过程调用。他们会在单独的线程上运行吗？如果是，是否会在操作 1 完成之前执行操作 2？

PS：制作 MyRemotedClass MarshalByRef 是错误的决定。但我不能改变它，所以请不要提出这个建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-08T08:49:29.693

我不是这方面的专家，但我真的*希望*在`MyInt`客户端事件尝试写入之前可靠地完成写入，`MyString`除非您正在进行一些时髦的异步行为。

毕竟，如果分配由于某种原因失败，唯一明智的处理方法是在继续之前抛出异常，IMO。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T09:24:18.250

事实上，就我的想法而言，设置 2 个属性并不是异步发生的，因此客户端会等到第 1 个 RPC 完成后才会从 RPC 2 开始。

无论如何，如果您的 MyRemotedClass 未配置为单例服务器激活对象，请记住，对于您在 MyRemotedClass 上执行的每个 RPC，将在服务器上创建一个新实例。这意味着远程对象不应包含任何状态。

# delphi - Delphi中的定时器

> ID：525416
> 
> 赞同：4
> 
> 时间：2009-02-08T08:45:35.850
> 
> 标签：delphi

考虑以下代码

```
Timer1 .Enabled := False;
Timer1.Interval : = 300;
For I := 1 to NumberOfTimesNeed do
Begin

   Timer1 .Enabled := False;    //  
   Timer1 .Enabled := True;     // reset the timer to 0.30 seconds

   TakesToLong     := False;
   DoSomethingThatTakesTime;    // Application.ProcessMessages is called in the procedure

   If TakesToLong = True then 
      TakeAction;
End;

procedure Timer1Timer(Sender: TObject);
begin
   TakesToLong:= True;
end; 
```

**问题 ：**

当我禁用然后启用 Timer1 时

```
Timer1.Enabled := False;
Timer1.Enabled := True; 
```

这会重置计时器吗？

即它会在超时前总是等待 0.30 秒。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-08T09:01:03.323

是的，它会。如果之前启用了计时器，将 Enabled 设置为 False 将调用 Windows API 函数 KillTimer()。如果之前未启用计时器，将 Enabled 设置为 True 将调用 Windows API 函数 SetTimer()。

这是一个标准的习惯用法，从 Delphi 1 时代就开始使用了。

但是，我会以不同的方式实现您的代码：

```
Start := GetSystemTicks;
DoSomethingThatTakesTime;
Duration := GetSystemTicks - Start;

if Duration > 300 then
  TakeAction; 
```

它可以在没有计时器的情况下工作，也不需要在 long-taking 方法中调用 ProcessMessages()。GetSystemTicks() 是我在库中的一个函数，它在 Windows 中调用 timeGetTime()，并且为 Kylix 实现了不同的实现（不记得如何，我很久以前清除了该代码）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T11:12:28.880

要注意的另一件事是计时器是系统上最低优先级的通知。因此，如果计算机很忙，其中可能包括此处的应用程序正在执行其工作，则计时器可能会在很长一段时间内不会触发。因此，即使计时器设置为 300 毫秒，也可能需要几秒钟的时间才能将 TakesToLong 变量设置为 true。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T02:02:16.067

我建议阅读线程。长时间的操作（我并不是说 300 毫秒很长，但听起来它显然可以比这更长）往往会冻结 GUI 并导致应用程序不稳定。现在，您可以将 application.processmessages 放在那里以保持 GUI 运行，但它很容易摆脱您想要的程序编码风格。

我认为**Application.ProcessMessages**应该被**禁止**，除非你是一个试图使用 Delphi 来模仿**DoEvents**的 VB 程序员并且你还没有摆脱 VB 的思维方式。

产生一个线程并在该线程中完成您的工作。如果要在完成后更新 GUI 端，请调用 Synchronize 以“安全地”执行此操作。与线程来回交流正在进行的状态带来了一个全新的对话，这与使用计时器控件相比是一个很大的飞跃。

# compiler-construction - 你自己的编程语言会是什么样子？

> ID：525425
> 
> 赞同：25
> 
> 时间：2009-02-08T08:53:43.650
> 
> 标签：compiler-construction, programming-languages, syntax, language-design

你自己的（我认为是完美的）编程语言会是什么样子？举一个小例子，解释你的**新奇**想法！

我真的对语法很感兴趣。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-02-08T15:37:32.927

有点神秘，但这就是我想要的：

![乐高积木！](https://smartpei.typepad.com/robert_patersons_weblog/lego%20bricks.jpg)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-09T14:10:42.260

Jon 说得对，“[d]不同的任务适合不同的语言和范式。” 但是，有一些考虑因素在很大程度上与领域无关。这些主要与语法有关，但由于代码的阅读频率高于编写频率，因此我实际上认为语法很重要。

一方面，许多语言都做错了，将语法基于 C 是完全任意的。C 实际上有一个非常糟糕的语法。我只举两个例子。

第一个是毫无争议的：分号是不必要的。采取以下代码；语法是完全明确的，并且易于编译器解析。分号和显式续行都不是必需的。

```
answer = 42
fraction = answer * 2 /
           (answer + 1)
Console.WriteLine(
    "Some funny number: {0}",
    fraction
) 
```

这实际上与 Python 非常相似，但更为宽松：`fraction`跨多行的定义。这是合乎逻辑的，因为第一行尚未完成。

对于类 C 语法，我必须选择的另一个重点是它们在很大程度上是隐含的变量声明。他们没有明确地宣布“我正在声明一个`variable`类型`Foo`”，而是害羞地低声说“<sub> `Foo var`”。由于`Foo`在大多数情况下甚至不是保留字，因此这里没有向程序员提供单一的视觉提示。我更喜欢 VB 的显式`Dim var As Foo`，甚至认为他在这里使用的关键字非常暗淡。

（实际上，C++ 引入了许多几乎相同且通常含糊不清的语法，这些语法意味着完全不同的东西，从变量初始化到函数声明，实际上让事情变得更糟了）。

*我的*语言必须具备的另一件事是静态类型。动态类型确实*有*它的用途，但它们非常罕见。即使是大多数“脚本语言”也并不真正需要它们。我认为这经常与具有更多用途的*隐式类型混淆。*以（再次）Python 为例。为什么它不提供静态类型？它已经是强类型的，静态类型检查只会随之而来，并且会大大减少调试。显式变量声明也是如此。我看不到隐含的变量声明提供了哪些优势。

所以我们已经有了一个语言的大纲：

*   语法简洁，避免历史混乱。尤其：
    *   没有分号
    *   没有明确的行延续à la VB
*   显式变量声明
*   静态类型

此外，我非常喜欢某些 C++ 概念，例如通用模板、RAII（即避免垃圾而不是收集垃圾）、不变性和通过迭代器定义的值范围的概念。我在其他地方说过，我相信迭代器是有史以来最基本的创新之一。给他们一点口红，你甚至不会认出丑陋的 C++ 野兽：

```
for i in MyVector:
    print(i) 
```

而不是

```
for (typename vector<T>::const_iterator i = MyVector.begin();
     i != MyVector.end();
     ++i)
    cout << *i << endl; 
```

当然，我知道许多语言都提供了上述语法。但是它们都只提供了 C++ 强大的迭代器概念的淡化版本（使用 C++ 术语，大多数语言知道的唯一一种迭代器是输入迭代器，它基本上是最不强大的迭代器）。

在这一点上，我可能应该说所有这些想法的唯一版权是我的，正在申请专利（特别是对于不真正比较对象引用的[`MayOrMayNotBe`操作员）。](http://appft1.uspto.gov/netacgi/nph-Parser?Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=1&f=G&l=50&s1=%2220040230959%22.PGNR.&OS=DN/20040230959&RS=DN/20040230959)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-08T08:57:30.707

我没有“完美”编程语言的概念，因为要执行的任务不止一个。

不同的任务适合不同的语言和范式。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-08T10:12:55.360

它看起来像 C#。我很想拥有微软！

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-08T15:18:33.670

我完美的语言可以让我根据需要增加功能。如果我需要编写一个没有类的小型直接实用程序，我可以。如果我需要使用类，我也可以这样做，如果我想编写一个完全面向对象的解决方案，我也可以这样做。链接器足够聪明，可以让我创建小型快速命令行实用程序（没有运行时依赖项）或我能想象的最大的臃肿 OOP GUI 应用程序。

问题是我喜欢的东西有相反的目标，因此我总是被迫使用完全不同的语言。我目前不按特定顺序使用 PowerShell、VBScript、PowerBasic、Java 和 C#（有时还有 VB .NET、VB 6、C++、Python 和 Perl）。

现在，如果我可以在创建这些小型应用程序时使用一种类似 C# 的语言来完成这一切，该语言具有全局函数且没有运行时依赖项，但让我在需要时充分利用 .NET Framework 和 Java SDK 的强大功能，我' d快乐。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-08T09:12:34.423

完美的编程语言往往出现在科幻小说中。例如：

*   Orson Scott Card 的**Ender 系列**- 要进行创作，您必须前往不同的维度并在脑海中形成纯粹的思想。当你回来时，它是。
*   **Robbert A. Heinlein 在《野兽的数量》中**探索了世界作为神话的概念
***   David Brin 的**Earth**通过子声结合眼睛和手指的动作进行编程。**

 **这一切仍然归结为同样的基本困境。任何不强迫人类学习技能的编程语言都会限制思想自由。自然语言也不好，因为它有很多歧义。

我不介意将自由与力量和最少的语法结合起来。我最近开始学习 lisp，到目前为止它似乎非常好。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-08T09:15:16.430

[Amazon Mechanical Turk 支持](http://en.wikipedia.org/wiki/Amazon_Mechanical_Turk)的大规模并行性。

```
job = "Upvote this answer"
@price = "$0.01"
fork(10000, job, @price) 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-02-08T10:22:31.473

我是 C 宏的忠实粉丝，但我认为如果你能用你正在使用的相同语言编写宏或“元代码”可能会很好。（C 是一个不好的例子；这在脚本语言中可能很好。）

在这些示例中，我使用大括号来标识元代码。您将能够通过“预处理器”运行源代码以扩展元代码。否则它只会在运行时扩展一次。

```
print "Your product ID is: ", { print '"', generateGUID(), '"' } 
```

或者

```
lookupTable[] = {
                  /* insert code to generate table here
                   *
                   * This lets you modify the algorithm easily
                   * but speeds up the final program.
                   * 
                   * This would be especially appropriate in
                   * cases where you would otherwise type out
                   * the table as a literal (yuck)
                   */
                } 
```

有时我们必须编写几行非常重复的代码；现在想不出一个好的例子，但这种想法在这种情况下也会很有帮助。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-02-11T08:54:31.340

这与采用 Eiffel 和 C# 的最佳想法并没有太大区别（因为，很明显，我没有提出更好的知识——我一开始没有学过 CS）。

但是，我主要的实际问题是**超越经典的“源代码文本”方法**。我知道这是（或听起来像）一个 IDE 的东西，但为什么我不能有一个可配置的代码视图，其中包含诸如前置条件/​​主体/后置条件之类的列，而不是“线性”形式 (i)：

```
 function f
  // f's preconditions
  // f's body
  // f's postconditions
  end

  function g
  // g's preconditions
  // g's body
  // g's postconditions
  end 
```

为什么不 (ii) - 想象这是一张**桌子**（带边框）：

```
f      f's parameters    f's prec      f's body      f's postc    f's comments
g      g's parameters    g's prec      g's body      g's postc    g's comments 
```

而且，为什么我不能在样式 (i) 中选择函数“开始”和“结束”（大括号、关键字...）的方式？为什么我不能立即显示或隐藏私人或受保护成员？为什么我不能立即看到包含所有继承功能的“平面版本”？等等

重点不是拥有一个您可以编辑的神圣代码文件，然后是多个“酷视图”，而是能够以 (i)、(ii) 以及对您最有用的任何形式编辑和添加代码。

在某种程度上，在这里谈论“IDE”似乎是题外话。但是OTOH，我认为这迟早会改变我们编写和阅读代码的方式。这将最终影响语言的发展方式。未来的目标将不仅是提高可读性，还要提高“可理解性”和交互性。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-08T14:22:25.700

我想我的会在[Brainf*ck](http://en.wikipedia.org/wiki/Brainfuck)和[LOLCODE](http://en.wikipedia.org/wiki/LOLCODE)之间，除了更多的[括号](http://en.wikipedia.org/wiki/Scheme_(programming_language))。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-02-08T15:36:21.793

多媒体。

我希望能够涂鸦一些图形符号，快速绘制连接，然后切换到其他模式，例如需要精确的打字。

我还认为编程语言应该支持不会用英语思考的人（是的，甚至美国人......开玩笑！）。我学了足够多的日语并尝试学习一些印尼语——我希望看到一种语言支持具有不同语法结构和顺序的人。

我在最近参加的一个关于网络未来的论坛上提出了一个问题，问一位来访的中国教授，他是否认为中文书面语言比英语更有可能实现一个可行的语义网络。他对这个概念很感兴趣。

我读过的很多 SF 都谈到了未来的计算机交互 UI：

*   David Drake 的[Lt Leary 系列](http://www.baen.com/series_list.asp#LL)中的数据棒（其中一些可[从 Baen 免费获得](http://www.baen.com/library/)）
*   斗牛士中多模态最喜欢的手势和发声集[以及](http://en.wikipedia.org/wiki/Steve_Perry_%28author%29#Matadora)佩里斗牛士系列中的其他随意提及
*   基于笔和手势的用户界面，包括签名以*密封*[愚人战争中](https://rads.stackoverflow.com/amzn/click/com/0446602930)的日志

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-02-09T14:25:32.317

Python 对我来说非常接近理想...

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-08T09:29:02.470

一种没有结构或变量，只有一个功能的语言。

doEverything();//根据已经预测的输入自动生成所有内容

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-02-08T09:51:40.350

我设想一种语言必须被告知输入和变量以及执行顺序的精确限制，因此可以编译成快速的多线程（或可集群）软件。

这里有一个有趣的想法：想象一个“函数”中的所有“语句”都可以按任何顺序执行。如果某些东西依赖于其他东西，您需要显式地“调用”依赖项。这将使并行设计成为语言的一个组成部分。

不幸的是，我没有投入足够的想象力来想出更具体的东西。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-02-08T15:19:36.803

[Clojure](http://clojure.org/)已经非常接近了……

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-02-08T17:14:40.830

我不确定我梦寐以求的语言会是什么样子，但我对 C 风格的语言有一点改进。我写过多少次这样的东西：

```
Node foundNode = null;  // need stupid null value here to keep track if it was not found
foreach (Node testNode in nodes) {
  if (testNode.YesItsMe) {
    foundNode = testNode;
    break;
  }
}
if (foundNode == null) {
  // create new instance
  foundNode = new Node(blabla);
} 
```

我知道有更优雅的功能方法，但有时你仍然会得到这样的代码。一个简单的“守卫”声明在这里会有所帮助：

```
Node foundNode;  // no need to initialize anymore
foreach (Node testNode in nodes) {
  if (testNode.YesItsMe) {
    foundNode = testNode;
    break;
  }
} guard {  // we get here if break was never called
  // create new instance
  foundNode = new Node(blabla);
} 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-02-08T13:35:06.687

我理想的编程语言，代码会很聪明，它会告诉我它是否与另一段代码有问题，我们会坐下来交谈，它会告诉我它的问题是什么，这样我们就可以解决它......我称之为“情感人++”

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-02-08T17:43:43.143

我想要一种使工具非常容易正确编写的编程语言。提取方法、着色、自动完成、编译等。

我希望这种情况发生，同时仍然易于编写和阅读。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-02-11T08:53:37.957

它看起来与 Scheme 完全一样。只有它会编译为 IL 和 Java 字节码和程序集，所以我可以使用所有这些库。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-06-17T09:21:57.413

一种设计语言以满足特定目标。语法和语义应遵循所需的功能。

就我而言，我想要一种具有细粒度并行性的语言，即每粒度的开销非常低，以允许并行化小块代码。

我在 x86 SMP 系统上设计并实现了它，它作为大型软件分析工具的基础已经使用了大约 10 年。

重点是让我（我们）轻松指定并行性：

```
(|| A B) 
```

并行执行 A 和 B，并让编译器生成所有使这成为可能的 crud。我们不关心语法是否是中缀的，所以我们采用 LISP 风格来避免参数。

可以在 [http://www.semanticdesigns.com/Company/Publications/parallelism-in-symbolic-computation.pdf找到描述该语言和许多并行应用程序的论文](http://www.semanticdesigns.com/Company/Publications/parallelism-in-symbolic-computation.pdf)

这篇论文简要讨论了尽管我们做出了决定，但我们未能成功地避免对语法的争论。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2012-02-07T03:41:53.980

我将从主要功能开始：

*   它应该是一种对基于宏的元编程具有强大支持的同型**[语言。](http://en.wikipedia.org/wiki/Homoiconicity)**这对生产力来说是一个巨大的优势（参见 Paul Graham[超越平均水平](http://www.paulgraham.com/avg.html)）
*   它应该**可以在任何平台上运行，并且对****运行分布式代码**有很好的支持。设置机器云应该是一项简单的任务。
*   它应该是**开源**的。
*   它应该有尽可能大的**库和工具生态系统**。实际上，这意味着您需要访问 Java 生态系统，因此出于这个原因，它可能需要成为一种 JVM 语言。
*   它应该**支持类型推断**。生命太短了，不能让编译器为你整理出类型细节......
*   它应该是**功能性**的，强调数据结构的不可变性。这是高级语言的未来（我并不认为函数式语言很难掌握，但这种语言不适合初学者......）
*   它应该支持**交互式开发**，最好在类似 REPL 的环境中与正在运行的（可能是分布式的）代码环境进行交互。
*   它应该提供出色**的无锁并发**支持。随着我们进入大规模多核世界，基于锁的方法根本无法扩展。软件事务内存*可能*是前进的方向。
*   它应该支持性能需要的**低级编码。**高级编码在 95% 的情况下都很棒，但有时您只需要直接操作字节......

目前我发现的最接近我的愿望清单的是**[Clojure](http://clojure.org/)**，它满足了大多数这些要求。

由于 OP 指的是语法，我将给出一些代码示例：

适当的变量 arity 函数，支持大型参数列表：

```
(+ 1 2 3 4 5)
=> 15

(apply + (range 10000))
=> 49995000 
```

在运行时交互式访问编译器：

```
(def function-string "+")

(def function (compile-string function-string))

(function 7 8 9)
=> 24 
```

分布式代码执行（MapReduce 风格）。请注意，这意味着语言/库能够采用本地定义`some-long-running-function`并透明地将其分发到集群中的所有节点，以便*在运行时*执行。

```
(def my-cluster 
     (create-compute-cluster :nodes 100 :service "Amazon"))

(defn some-long-running-function [input]
  ....)

(def reduction-function 
  (fn [a b] 
    (do-something-to-reduce a b)))

(def lots-of-inputs (range 10000))

(distributed-map-reduce
  my-cluster
  some-long-running-function
  inputs
  reduction-function)
=> (whatever the result of the mapreduce is over the cluster) 
```

正确的类型推断（即编译器计算出 my-function 总是返回一个 String 并相应地进行优化/推断：

```
(def my-function [name]
   (str "Hello " name "!"))

(my-function "Bob")
=> "Hello Bob!"

(compile-time-type my-function)
=> [java.lang.String :not-null] 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-02-08T09:15:12.357

我的最佳语言看起来很像 Nemerle（减去任意限制）。真的归结为元编程设施；我应该能够以我认为合适的任何方式（句号）任意扩展或修改语言以完美地适应域。

给我宏，让我可以按照我的意愿处理所有代码的 AST，我可以构建*我的*完美语言。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-02-08T21:56:45.517

它将是机器可读/可写的，它将由智能软件编写，该软件通过语音接收指令。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-07-03T09:31:27.537

唔。这是困难的一个。我的口味倾向于易于人类理解的轻量级脚本风格的语言（尽管我相信这适用于更大的应用程序）。见代码片段：

```
function Foo takes x as string, y as boolean //can add returns [return type] if one wishes to be explicit
    //explicit variable declaration
    z as number
    //explicit cast from boolean to number
    z is y as number
    //implicit variable declaration
    bar is 3 * 5
    //function call
    print x
    return z / bar //since we casted z to a number, it returns a number 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2011-08-30T04:19:22.843

我希望看到一个函数能够包含任意数量的引用参数并将它们传递给嵌套函数调用。在 .net 中，可以通过以下方式对任何固定数量的通用参数执行此操作（显示了两个额外参数版本）：

```
// 我忘记了代表的 C# 语法，因为我通常在 vb 中编码
委托 void RefAction<T1, T2, T3>(ref T1 p1, ref T2 t2, ref T3 p3);

点 m​​yPoints[];

void DoSomethingWithIndexedPoint<XT1, XT2>(int index,
  RefAction<Point, XT1, XT2) theAction,
  参考 XT1 xp1,
  参考 XT2 xp2)
{
  theAction(myPoints[index], xp1, xp2);  
}

```

我的首选语法类似于：

```
委托 void RefAction<T1, T2, T3>(ref T1 p1, ref T2 t2, ref T3 p3);

点 m​​yPoints[];

void DoSomethingWithIndexedPoint<ref ...>(int index,
  RefAction<Point, ref ...>, ref ...) theAction,
  参考 XT1 xp1,
  参考 XT2 xp2)
{
  theAction(myPoints[index], ...);  
}

```

其中“...”将由​​编译器以任何合适的方式自动扩展。这样的设施可以在许多情况下使用 Lambda，而不必生成闭包实例，并且还可以执行以下代码：

```
  Interlocked.CompareExchange(SomeObject["George"], SomeValue, SomeOtherValue);

```

编译器可以将其重写为类似于：

```
  SomeObject.ActUponProperty("乔治",
    (ref dest, ref p1, ref p2) => {Interlocked.CompareExchange(dest, p1, p2);},
    一些价值，一些其他价值）；

```

请注意，由于 lambda 表达式不会使用任何实例成员或变量，而不是作为 ref 参数传递的那些，它可以实现为静态函数并且不需要生成闭包。

# java - Java：在桌面上放置窗口时考虑任务栏/菜单栏/等？

> ID：525430
> 
> 赞同：2
> 
> 时间：2009-02-08T09:04:07.840
> 
> 标签：java, swing

当我的程序启动时，主窗口将自己放置在上次关闭时的位置。我想修改一些这种行为，所以如果窗口在屏幕外（或部分在屏幕外），它会自行移动到完全在屏幕上。

我已经完美地完成了这个工作。这是代码：

```
 int x = gameConfig.windowX;
    int y = gameConfig.windowY;
    int width = gameConfig.windowWidth;
    int height = gameConfig.windowHeight;

    if( x < 0 ) x = 0;
    if( y < 0 ) y = 0;

    Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();

    if( x + width > screenSize.width ) x = screenSize.width - width;
    if( y + height > screenSize.height ) y = screenSize.height - height;

    if( width > screenSize.width ) width = screenSize.width;
    if( height > screenSize.height ) height = screenSize.height;

    this.setLocation(x, y);
    this.setSize(width, height );

    if( gameConfig.screenMaximized ) {
        this.setExtendedState(getExtendedState() | MAXIMIZED_BOTH );
    } 
```

这按预期工作，但有一个很大的例外；它不考虑任务栏。在 Windows 上，如果窗口超出屏幕底部，此代码将更正它，但仍会留下一块窗口被任务栏挡住。

我不知道该怎么做。有没有办法向java询问系统中的任何任务栏，以及它们的宽度/高度是多少？

* * *

谢谢，效果很好。

您知道如何获取它，以便在我调用 getScreenSize() 时 Java 将反映我的两个显示器的总屏幕大小吗？现在它返回 1600x1200，而实际上它是 3200x1200，跨越两台显示器。

Java API 建议 GraphicsConfiguration.getBounds() 可以解决问题，但仍会返回矩形 {0, 0, 1600, 1200}。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-08T09:09:10.060

使用 getScreenInsets (Java 4+)：

```
static public Insets getScreenInsets(Window wnd) {
    Insets                              si;

    try {
        if(wnd==null) { si=Toolkit.getDefaultToolkit().getScreenInsets(new Frame().getGraphicsConfiguration()); }
        else          { si=wnd.getToolkit()           .getScreenInsets(wnd.getGraphicsConfiguration());         }
        } catch(NoSuchMethodError thr) { si=new Insets(0,0,0,0); }
    return si;
    } 
```

（此方法允许多个屏幕和不支持 API 的旧 JVM）。

而且，永远记住任务栏可能位于屏幕的任何边缘，而不仅仅是底部。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-01-09T14:03:11.170

下面的代码对我有用，甚至通过将工具栏移动到右侧进行了测试。但没有尝试使用多个屏幕。

```
public class Scene extends JFrame {
private static final long serialVersionUID = 42L;

public Scene() {
    Canvas canvas = new Canvas();
    this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    this.setContentPane(canvas);
    this.pack();
    this.putFrameInRightCorner();
    this.setVisible(true);
}

protected void putFrameInRightCorner(){
    Rectangle winSize = GraphicsEnvironment.getLocalGraphicsEnvironment().getMaximumWindowBounds();
    Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize(); 
    Dimension frameSize = this.getSize();
    int taskBarWidth = screenSize.width - winSize.width;
    int taskBarHeight = screenSize.height - winSize.height;
    this.setLocation((screenSize.width - frameSize.width - taskBarWidth), 
                      (screenSize.height - frameSize.height - taskBarHeight));
}

public static void main(String[] args) {
    SwingUtilities.invokeLater(new Runnable() {
        @Override
        public void run() {
            new Scene();
        }
    });
}
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T14:37:37.643

通过关注 Pavan Kumar Kundagol Sundara 的帖子，在 1 月 9 日 14:03 回答，我得到了这个好看且工作完美的代码：

```
import java.awt.GraphicsEnvironment;
import java.awt.Rectangle;

Rectangle janelSOdisponivel = GraphicsEnvironment.getLocalGraphicsEnvironment().getMaximumWindowBounds();
int janelaSOaltura = janelSOdisponivel.height;
int janelaSOlargura = janelSOdisponivel.width; 
```

然后使用我需要的两个变量（`janelaSOaltura`, ）。`janelaSOlargura`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-08T21:45:28.463

关于多屏问题，我实际上并没有这样做，但我相信每个屏幕都有自己的图形配置。据我了解，您可以枚举配置以找到您想要的配置 - 然后您使用我们已经讨论过的相同 API。

看起来 GraphicConfiguration 的文档具有您需要的详细信息：

```
GraphicsEnvironment ge=GraphicsEnvironment.getLocalGraphicsEnvironment();
GraphicsDevice[]    gs=ge.getScreenDevices();
for(int j = 0; j<gs.length; j++) { 
    GraphicsDevice gd=gs[j];
    GraphicsConfiguration[] gc=gd.getConfigurations();
    for (int i=0; i<gc.length; i++) {
        ...
        }
    } 
```

# asp.net - 无法在 Web 服务器上开始调试。底层连接被关闭：连接被意外关闭

> ID：525433
> 
> 赞同：4
> 
> 时间：2009-02-08T09:08:08.173
> 
> 标签：asp.net, visual-studio

因此，我将一大堆“不必要的”Windows服务设置为禁用，然后我遇到了：“无法在Web服务器上开始调试。底层连接已关闭：连接意外关闭。” 错误。

我认为这个特定的错误与典型的“无法在 Web 服务器上开始调试”有点不同，我在 google 上发现很少点击。

无论如何，事实证明调试依赖于“COM+事件系统”windows服务。

仅供参考。

# javascript - Javascript 和 MySQL

> ID：525441
> 
> 赞同：6
> 
> 时间：2009-02-08T09:15:25.850
> 
> 标签：javascript, mysql

我想只使用 Javascript 和 MYSQL 构建一个完整的网络应用程序。如果可能的话，我该怎么做。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-08T09:40:59.763

试试[Jaxer](http://www.aptana.com/jaxer)之类的东西，它允许您在 Web 服务器上执行 JavaScript 并查询数据库。

以下是一些语法示例和用法：

* * *

**从 JavaScript 访问数据库、文件和套接字**

[替代文字 http://jaxer.org/images/Picture+4_0.png](http://jaxer.org/images/Picture+4_0.png)

* * *

**轻松创建 RESTful JSON 数据服务**

[替代文字 http://jaxer.org/images/Picture+6.png](http://jaxer.org/images/Picture+6.png)

* * *

**直接从浏览器调用服务器端函数**

[替代文字 http://jaxer.org/images/Picture+2_0.png](http://jaxer.org/images/Picture+2_0.png)

* * *

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T09:51:09.447

如果您可以在服务器上运行 javascript，则可以使用它构建一个 Web 应用程序（不需要任何其他语言，如 PHP 等）。在网络上搜索“连接字符串 mysql”以了解如何连接到您的 mySQL 数据库并使用 ADO/ODBC。您需要 MySQL 服务器上的 MySQL ODBC 连接器。

这是一个示例数据库连接（其中 MySQL 服务器与 Web 服务器位于同一台服务器上）：

```
function connectDB()
{
   var connectStr = "DRIVER={MySQL ODBC 3.51 Driver}; " +
                    "SERVER=localhost; "                +
                    "PORT=[MySQL server port];"         +
                    "DATABASE=[your database]; "        +
                    "UID=[username];PWD=[password];"    +
                    "OPTION=3",
       conection  = Server.CreateObject("ADODB.Connection"); 

  //ERRID=>lib::connectDB::open
   try       {connection.Open(connectStr)             }
   catch(e)  {errAlert(e,'rs::connectDB','connection failed',1) }        
   return connection;
} 
```

（`errAlert`返回错误的自定义函数在哪里）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-08T16:19:56.353

You can do it with [Jaxer](http://www.aptana.com/jaxer). There are some screencasts that'll get you started. Also check out project [Phobos](https://phobos.dev.java.net/). Jaxer integrates nicely in Aptana studio, Phobos in Netbeans.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-08T15:48:26.213

您可以完全在客户端 JavaScript 中编写您的应用程序，并通过 AJAX / REST 调用您的数据库服务器 - 在您的服务器上使用[CloudKit](http://getcloudkit.com/)（或 CouchDB，它具有本机 JSON HTTP 接口）之类的东西。在客户端，Dojo 或 YUI 抽象出大量的 IO 处理……</p>

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-08T09:53:08.567

仅使用 javascript 编写 Web 应用程序是完全可能的。这样做的一个主要好处是，由于所有代码都在本地运行，因此您可以制作不需要在线连接的应用程序。

但是，主要的批评者是您无法将其连接到数据库。但是您可以使用其他数据存储技巧。

这种 javascript 应用程序的一个示例是[TiddlyWiki](http://www.tiddlywiki.com/)，它是一个个人 wiki，包含在单个 html 文件中。javascript 应用程序会重写该 html 文件，因此您可以将它放在 USB 驱动器或其他东西上。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-08T10:21:55.390

您可以查看应该将您的数据库公开为 json 和 rdf的[triplify 。](http://triplify.org/Overview)我实际上并没有使用过它，但我想这会让你绕过编写任何服务器端 js，并使用 ajax 请求和 json 以 javascript 理解的语言直接与数据库对话。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-08T10:23:27.633

您可以使用 javascript 构建带有嵌入式数据库的客户端应用程序。HTML 5 支持数据库，一些浏览器已经实现了规范的这一部分（safari、firefox 和 gears 插件）。

但这仅适用于客户端使用。您将无法与其他用户共享数据库。您还可以选择要使用的数据库。我认为齿轮使用 sqlite。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-02-08T09:19:10.197

如果不在服务器端使用诸如 PHP 之类的东西来弥合数据库和客户端 Javascript 之间的差距，您将无法使用 Javascript 和 MYSQL。

编辑：我可能是错的，但是我不知道你将如何在服务器端运行 Javascript。

# c# - 如何用基本的 C# 和 ASP .NET 知识编写这个游戏？

> ID：525475
> 
> 赞同：3
> 
> 时间：2009-02-08T09:54:20.390
> 
> 标签：c#, asp.net

我很想和你们一起集思广益，讨论如何用 C# 编写这个游戏（最初是一个 Flash 游戏）。我现在正在学习 C#，但我的知识非常有限：我知道 C# 的基本知识，但我需要你对这个概念的帮助。这是游戏： http: [//www.composica.com/product/samples/AstroHops/content/scaler.html](http://www.composica.com/product/samples/AstroHops/content/scaler.html) [alt text http://img12.imageshack.us/img12/5735/frogim3.jpg](http://img12.imageshack.us/img12/5735/frogim3.jpg)

我考虑过为每个 lilypad 使用 imagebutton 来触发一个有问题的模态窗口。我还考虑在每个睡莲上放一张青蛙的照片，设置为 visible = false。选择某个LilyPAD时，Frog的可见性将设置为TRUE。

关于如何更好地做到这一点的任何想法、想法和建议？也许链接到用 c# 编码的类似游戏？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-08T10:00:31.907

ASP.NET（和一般的 HTML）并不直接适合与 flash 竞争——它们只是工作方式不同。也许看看[Silverlight](http://silverlight.net/)；那是最接近闪存的MS产品，您可以使用C#。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T10:28:59.323

Marc 解决方案似乎是最好的解决方案，但如果你真的需要它在 C# 中（在 ASP.NET 中对吗？），那么你可能会考虑 AJAX，但它是一种糟糕的方法。

如果您正在谈论的是winforms，那么我会考虑为此使用一些2d图形引擎。否则你的想法可以使用默认的 .net 表单，它看起来不会很好......

[您可能会看一下这个，这似乎是使用 directX 和 c# http://www.csharp-home.com/index/tiki-print_article.php?articleId=146](http://www.csharp-home.com/index/tiki-print_article.php?articleId=146)的一个不错的起点

祝你的项目好运！

# pthreads - pthread 条件变量

> ID：525478
> 
> 赞同：8
> 
> 时间：2009-02-08T09:54:55.273
> 
> 标签：pthreads

我正在实现一个带有任务队列的线程。一旦第一个任务被添加到队列中，线程就开始运行它。

我应该使用 pthread 条件变量来唤醒线程还是有更合适的机制？

如果我`pthread_cond_signal()`在另一个线程没有被阻塞`pthread_cond_wait()`而是在做某事时调用，会发生什么？信号会丢失吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-08T10:22:57.853

从[pthread_cond_signal 手册](http://linux.die.net/man/3/pthread_cond_signal)：

> 如果当前没有线程阻塞在 cond 上，pthread_cond_broadcast() 和 pthread_cond_signal() 函数将无效。

我建议你使用[信号量](http://linux.die.net/man/7/sem_overview)。基本上，每次将任务插入队列时，您都会“启动”信号量。工作线程通过“关闭”信号量来阻塞信号量。由于每个任务都会“向上”一次，因此只要队列中有任务，工作线程就会继续运行。当队列为空时，信号量为 0，工作线程阻塞，直到有新任务到达。信号量也很容易处理当工作人员忙时有超过 1 个任务到达的情况。请注意，您仍然必须锁定对队列的访问以保持插入/删除的原子性。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-08T14:44:43.253

如果您的队列已经是线程安全的，那么信号量是好的。此外，一些信号量实现可能会受到最高计数器值的限制。即使您不太可能超过最大值。

执行此操作的最简单和正确的方法如下：

```
pthread_mutex_t queue_lock;
pthread_cond_t  not_empty;
queue_t queue;

push()
{
  pthread_mutex_lock(&queue_lock);
  queue.insert(new_job);
  pthread_cond_signal(&not_empty)
  pthread_mutex_unlock(&queue_lock);
}
pop()
{
  pthread_mutex_lock(&queue_lock);
  if(queue.empty()) 
     pthread_cond_wait(&queue_lock,&not_empty);
  job=quque.pop();
  pthread_mutex_unlock(&queue_lock);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-02T11:03:11.267

信号将丢失，但您希望在这种情况下丢失信号。如果没有要唤醒的线程，则该信号毫无用处。（如果没有人在等待某事，那么当它发生时也不需要通知任何人，对吧？）

使用条件变量，丢失的信号不会导致线程“睡过火”。除非您在已经发生火灾时实际编写线程以进入睡眠状态，否则无需“保存信号”。当火灾开始时，您的广播将唤醒所有休眠线程。当已经发生火灾时，您必须非常愚蠢地编写一个线程以进入睡眠状态。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T08:33:44.427

如前所述，信号量应该是最佳选择。如果您需要一个固定大小的队列，只需使用 2 个信号量（如在经典的生产者-消费者中）。

在 artyom 代码中，最好将 pop() 函数中的“if”替换为“while”，以处理虚假唤醒。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-11T09:50:57.260

没有影响。

如果你检查 pthread_condt_signal 是如何实现的，condt 使用几个计数器来检查是否有任何等待线程唤醒。例如，glibc-nptl

```
 /* Are there any waiters to be woken?  */
 if (cond->__data.__total_seq > cond->__data.__wakeup_seq){
    ...
 } 
```

# javascript - open file select dialog with javascript

> ID：525490
> 
> 赞同：1
> 
> 时间：2009-02-08T10:15:21.660
> 
> 标签：javascript, mootools

I have hidden input type=file field, and i want to open its select dialog with javascript. I tried to fire click event on this element, but without luck.

Im using mootools.

```
$('input_id').fireEvent('click'); 
```

This is possible at all?

# html - Displaying HTML node in tree - height issue

> ID：525492
> 
> 赞同：1
> 
> 时间：2009-02-08T10:17:32.280
> 
> 标签：html, apache-flex

Grrr so close yet still failing...

I display this tree, in Flex, which contains two nodes types:

1.  Regular nodes, which are rendered normally like text (because they are!)
2.  Rich (HTML) nodes - that's where things get twisted

Note that my issue is when I **dynamically add** a new (HTML) node to my tree.

* * *

So... How do I display HTML nodes?

1.  I subclass TreeItemRenderer
2.  In that subclass, I override set data() and add a text child to my renderer

Therefore I now have:

[icon] [label]

[text component]

Why?

The default label is a pure text component, not HTML-capable, hence the extra component: I want to display the new guy and forget the default label.

3.  (continued) I override `updateDisplayList()` and, if the node is a rich one, I set label's height to zero, set my component's x and y to label'x and and y.

So...what am I missing? Ah, yes: I need to set my node's height since HTML text can be bigger or smaller than its text counterpart.

4.  (continued) I override `measure()`
5.  If my node is not a rich one, I simply invoke super.measure() and return
6.  If it *is* a rich one, I give my html component a width (htmlComponent.width = explicitWidth - super.label.x;) and its height should be automatically computed.

This gives me a fairly reliably unreliable result!

When I fold/unfold my tree, every other time, I seem to get a correct height for my HTML node. The other time I get a height of '4' which happens to be the HTML component's padding alone, without content.

I know that I must be doing something fairly stupid here...but I am not sure what. I will post my code if my rambling is too incoherent to make any sense of...

**** EDIT: here is the source code for my renderer As you can see, only 'notes' nodes use HTML. I add a 'htmlComponent' child that will display the rich text while the default label is zero-sized and disappears. It's definitely very raw code, as it's in progress!

```
 package com.voilaweb.tfd
{
    import mx.collections.*;
    import mx.controls.Text;
    import mx.controls.treeClasses.*;
    import mx.core.UITextField;
    import mx.core.UIComponent;
    import flash.text.TextLineMetrics;

    public class OutlinerRenderer extends TreeItemRenderer
    {
        private function get is_note():Boolean
        {
            return ('outlinerNodeNote' == XML(super.data).name().localName);
        }

        override public function set data(value:Object):void
        {
            super.data = value;
            var htmlComponent:Text = super.getChildByName("htmlComponent") as Text;
            if(!htmlComponent)
            {
                htmlComponent = new Text();
                htmlComponent.name = "htmlComponent";
                addChild(htmlComponent);
            }
            if(is_note)
                htmlComponent.htmlText = XML(super.data).attribute('nodeText');
            else
                htmlComponent.htmlText = null;
            setStyle('verticalAlign', 'top');
        }

 /*
  * Today we've learnt a valuable lesson: there is no guarantee of when createChildren() will be invoked.
  * Better be dirty and add children in set data()
        override protected function createChildren():void
        {
            super.createChildren();
            var htmlComponent:Text = new Text();
            htmlComponent.name = "htmlComponent";
            addChild(htmlComponent);
        }
*/
        override protected function measure():void
        {
          if(is_note)
          {
            super.measure();
            var htmlComponent:Text = super.getChildByName("htmlComponent") as Text;
            //Setting the width of the description field
            //causes the height calculation to happen
            htmlComponent.width = explicitWidth - super.label.x;
            //We add the measuredHeight to the renderers measured height
            //measuredHeight += (htmlComponent.measuredHeight - label.measuredHeight);
            // Note the silly trick here...hopefully in the future I figure out how to avoid it
            //
            // Here is what happens: we check if measuredHeight is equal to decoration such as margin, insets...rather than that + some height
            // If so, then we need to come up with an actual height which we do by adding textHeight to this height

            // Note that I care about text being equal to margin etc but do not have proper access to these
            // For instance UITextField.TEXT_HEIGHT_PADDING == 4 but is not accessible
            // I am going to check if "<10" that will cover this case...
            trace("For text " + htmlComponent.htmlText);
            trace("width = " + htmlComponent.getExplicitOrMeasuredWidth()+" x height = " + htmlComponent.getExplicitOrMeasuredHeight());
            var m:TextLineMetrics = htmlComponent.measureHTMLText(htmlComponent.htmlText);
            //if(10 > htmlComponent.measuredHeight && !isNaN(htmlComponent.explicitHeight))
            //htmlComponent.explicitHeight = m.height + htmlComponent.measuredHeight;
            //if(htmlComponent.measuredHeight < 10) htmlComponent.explicitHeight = 50;

            //measuredHeight += (htmlComponent.getExplicitOrMeasuredHeight() - super.label.getExplicitOrMeasuredHeight());
            measuredHeight += (htmlComponent.getExplicitOrMeasuredHeight() - label.getExplicitOrMeasuredHeight());
            trace("m:"+m.height+" Height: " + htmlComponent.getExplicitOrMeasuredHeight());
          }
          else
          {
            super.measure();
          }
        }     

        override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number):void
        {
            super.updateDisplayList(unscaledWidth, unscaledHeight);
            label.height = label.getExplicitOrMeasuredHeight(); // If you tell me my height, then I shall use my variable height!

            graphics.clear();

            if(is_note)
            {
                label.height = 0;
                var htmlComponent:Text = super.getChildByName("htmlComponent") as Text;
                htmlComponent.x = label.x;
                htmlComponent.y = label.y;
                htmlComponent.height = htmlComponent.getExplicitOrMeasuredHeight();

                graphics.beginFill(0x555555);
                graphics.drawRect(0, 0, unscaledWidth, unscaledHeight);
                graphics.endFill();
            }

            var complete:XMLList = XML(super.data).attribute('complete');
            if(complete.length() > 0 && true == complete[0])
            {
                var startx:Number = data ? TreeListData(listData).indent : 0;
                if(disclosureIcon)
                    startx += disclosureIcon.measuredWidth;
                if(icon)
                    startx += icon.measuredWidth;
                graphics.lineStyle(3, getStyle("color"));
                var y:Number = label.y + label.getExplicitOrMeasuredHeight() / 2;
                graphics.moveTo(startx, y);
                graphics.lineTo(startx + label.getExplicitOrMeasuredWidth(), y);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-03-18T15:54:19.090

您对默认渲染器中的标签组件做出了错误的假设 - 它能够显示 html 内容。这个渲染器对我有用：

```
public class HtmlTreeItemRenderer extends TreeItemRenderer {
    override protected function commitProperties():void {
        super.commitProperties();
        label.htmlText = data ? listData.label : "";
        invalidateDisplayList();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T20:39:33.377

如果您可以发布一些代码，那肯定会有所帮助。

我想知道您为什么要使用自定义 html 渲染器。是不是因为你提到 [icon] [label] 就想在标签旁边显示一个图标？如果是这样，您最好使用 iconField 或 iconFunction。

想到的另一件事是 variableRowHeight 属性。如果您的节点有不同的高度，您可能需要设置它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-12T12:36:54.133

试试看。

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml"
           width="100%" height="100%" verticalScrollPolicy="off"
           horizontalScrollPolicy="off">

<mx:Script>
   <![CDATA[ 
```

```
 import mx.core.UITextField;

      private var texto:UITextField;

      override protected function createChildren():void
      {
         super.createChildren();

         texto = new UITextField();

         texto.setColor(0xFFFFFF);

         texto.multiline = true;
         texto.wordWrap = true;

         texto.autoSize = TextFieldAutoSize.LEFT;

         this.addChild(texto);

         //texto.text = data.title;
      }

      override public function set data(value:Object):void
      {
         super.data = value;
         if (value)
         {
          texto.htmlText = value.title;
          this.invalidateDisplayList();
         }
      }

      override protected function measure():void
      {
        super.measure();
      }

      override protected function updateDisplayList(unscaledWidth:Number,
                                       unscaledHeight:Number):void
      {
         super.updateDisplayList(unscaledWidth, unscaledHeight);

         if (texto)
          texto.width = this.width;
      } 
```

```
 ]]>
</mx:Script>   

</mx:Canvas> 
```

# c# - 在 VisualStudio 2008 中启用对 UserControl 的设计时支持

> ID：525498
> 
> 赞同：0
> 
> 时间：2009-02-08T10:22:26.170
> 
> 标签：c#, visual-studio-2008, devexpress

我创建了用户控件 GridEx:UserControl。在那个控件上，我放置了 GridControl（DevExpress 数据网格控件）。我创建了返回内部数据网格控件的属性 DataGrid（以前添加） 如何启用对 DataGrid 的设计支持？我试着把

```
[Designer("DevExpress.XtraGrid.Design.GridControlDesigner,
    DevExpress.XtraGrid.v8.2.Design", typeof(IDesigner))] 
```

但我收到此错误：无法创建组件“DataGridControl”。
错误信息如下：

```
System.NullReferenceException: Object reference not set to an instance of an object.
  at DevExpress.XtraGrid.Design.GridControlDesigner.Initialize(IComponent component)
  at System.ComponentModel.Design.DesignerHost.AddToContainerPostProcess(IComponent component, String name, IContainer containerToAddTo)
  at System.ComponentModel.Design.DesignerHost.Add(IComponent component, String name)
  at System.ComponentModel.Design.DesignerHost.System.ComponentModel.Design. IDesignerHost.CreateComponent(Type componentType, String name)
   at System.ComponentModel.Design.DesignerHost.System.ComponentModel. Design.IDesignerHost.CreateComponent(Type componentType)
   at System.Drawing.Design.ToolboxItem.CreateComponentsCore(IDesignerHost host)
   at System.Drawing.Design.ToolboxItem.CreateComponentsCore(IDesignerHost host, IDictionary defaultValues)
   at System.Drawing.Design.ToolboxItem.CreateComponents(IDesignerHost host, IDictionary defaultValues)
   at System.Windows.Forms.Design.OleDragDropHandler.Cre... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-09T09:25:31.493

尝试从 DevExpress 网格控件而不是“UserControl”类派生用户控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T08:20:14.360

可以在这里建立解决方案：

[http://www.devexpress.com/kb=A577](http://www.devexpress.com/kb=A577)

# sql - 删除所有表命令

> ID：525512
> 
> 赞同：95
> 
> 时间：2009-02-08T10:34:02.400
> 
> 标签：sql, sqlite, rdbms, database

在 SQLite 中删除所有表的命令是什么？

同样，我想删除所有索引。

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2009-02-14T01:08:38.190

虽然确实没有 DROP ALL TABLES 命令，但您可以使用以下命令集。

**注意：**这些命令可能会损坏您的数据库，因此请确保您有备份

```
PRAGMA writable_schema = 1;
delete from sqlite_master where type in ('table', 'index', 'trigger');
PRAGMA writable_schema = 0; 
```

然后你想恢复删除的空间

```
VACUUM; 
```

并进行良好的测试以确保一切正常

```
PRAGMA INTEGRITY_CHECK; 
```

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2009-02-08T10:42:27.360

我认为您不能一次删除所有表，但您可以执行以下操作来获取命令：

```
select 'drop table ' || name || ';' from sqlite_master
    where type = 'table'; 
```

其输出是一个脚本，它将为您删除表。对于索引，只需将表替换为索引即可。

您可以使用该`where`部分中的其他子句来限制选择哪些表或索引（例如“ `and name glob 'pax_*'`”用于以“pax_”开头的那些）。

您可以将此脚本的创建与在一个简单的 bash（或 cmd.exe）脚本中运行它结合起来，这样只需运行一个命令。

如果您不关心数据库中的**任何**信息，我认为您可以删除它存储在硬盘上的文件 - 这可能更快。我从来没有测试过这个，但我不明白为什么它不起作用。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2009-02-09T03:41:15.893

```
rm db/development.sqlite3 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2013-04-27T09:58:43.457

我对 SQLite 和 Android 有同样的问题。这是我的解决方案：

```
List<String> tables = new ArrayList<String>();
Cursor cursor = db.rawQuery("SELECT * FROM sqlite_master WHERE type='table';", null);
cursor.moveToFirst();
while (!cursor.isAfterLast()) {
    String tableName = cursor.getString(1);
    if (!tableName.equals("android_metadata") &&
            !tableName.equals("sqlite_sequence"))
        tables.add(tableName);
    cursor.moveToNext();
}
cursor.close();

for(String tableName:tables) {
    db.execSQL("DROP TABLE IF EXISTS " + tableName);
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-11-16T17:48:04.740

使用 pysqlite：

```
tables = list(cur.execute("select name from sqlite_master where type is 'table'"))

cur.executescript(';'.join(["drop table if exists %s" %i for i in tables])) 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-02-09T12:03:05.843

我想添加其他涉及删除表而不删除文件的答案，您也可以执行这些答案`delete from sqlite_sequence`来重置自动增量序列。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-08T14:27:08.123

一旦你删除了所有表（当表消失时索引将消失），据我所知，SQLite 数据库中没有任何内容，尽管文件似乎没有缩小（从我刚刚做的快速测试）。

所以删除文件似乎是最快的——它应该在你的应用程序尝试访问 db 文件时重新创建。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-08-31T18:08:14.503

我在 Android 中遇到了这个问题，我写了一个类似于 it-west 的方法。

因为我`AUTOINCREMENT`在表中使用了主键，所以有一个名为`sqlite_sequence`. 当例程试图删除该表时，SQLite 会崩溃。我也无法捕捉到异常。查看[https://www.sqlite.org/fileformat.html#internal_schema_objects](https://www.sqlite.org/fileformat.html#internal_schema_objects)，我了解到可能有几个我不想删除的*内部模式表。*文档说这些表中的任何一个都有以*sqlite_*开头的名称所以我写了这个方法

```
private void dropAllUserTables(SQLiteDatabase db) {
    Cursor cursor = db.rawQuery("SELECT name FROM sqlite_master WHERE type='table'", null);
    //noinspection TryFinallyCanBeTryWithResources not available with API < 19
    try {
        List<String> tables = new ArrayList<>(cursor.getCount());

        while (cursor.moveToNext()) {
            tables.add(cursor.getString(0));
        }

        for (String table : tables) {
            if (table.startsWith("sqlite_")) {
                continue;
            }
            db.execSQL("DROP TABLE IF EXISTS " + table);
            Log.v(LOG_TAG, "Dropped table " + table);
        }
    } finally {
        cursor.close();
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-01-18T20:22:16.740

我不能说这是最防弹或最便携的解决方案，但它适用于我的测试脚本：

```
.output /tmp/temp_drop_tables.sql
select 'drop table ' || name || ';' from sqlite_master where type = 'table';
.output stdout
.read /tmp/temp_drop_tables.sql
.system rm /tmp/temp_drop_tables.sql 
```

这段代码将输出重定向到一个临时文件，构造我想要运行的“drop table”命令（将命令发送到临时文件），将输出设置回标准输出，然后执行文件中的命令，最后删除文件。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-10-11T22:45:35.213

或者在 shell 提示符下，只需两行，没有命名的临时文件，假设 $db 是 SQLite 数据库名称：

```
echo "SELECT 'DROP TABLE ' || name ||';' FROM sqlite_master WHERE type = 'table';" |
    sqlite3 -readonly "$db" | sqlite3 "$db" 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-01-05T11:06:36.730

要删除视图，请添加“视图”关键字：

```
delete from sqlite_master where type in ('view', 'table', 'index', 'trigger'); 
```

# testing - 软件开发测试人员

> ID：525514
> 
> 赞同：11
> 
> 时间：2009-02-08T10:36:32.130
> 
> 标签：testing, project, product

在我公司，我们开发软件产品。到目前为止，我们还没有任何测试人员，所以基本上开发人员就是测试人员，当然还有客户和用户（不好）。

我们的团队现在由 4 名开发人员组成，主要使用 Cruisecontrol、Flex、ASP.NET、IIS、MSSQLServer 和 WebORB。我敦促经理们聘请测试人员，但我想知道测试人员在软件开发中是否正常。所以：

1.  产品（或大型项目）开发中是否需要测试人员？
2.  测试人员应该只做测试工作吗？或者您可以期望开发人员或图形设计师在半周内进行测试吗？
3.  你在哪里可以找到好的测试人员（我想没有软件开发测试学位）？
4.  测试一切是否是技术团队项目经理的任务？

谢谢，列文卡登

ps：谢谢，Vinay，我们确实有单元测试，但实际上，单元测试不能涵盖测试人员可以做什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-08T12:10:48.883

1) 产品（或大型项目）开发是否需要测试人员？

是的。有人必须负责评估什么时候测试了足够多的东西，并找出哪些错误需要修复或可以发布，因为有变通方法。

2）测试人员应该只做测试工作吗？您能期望开发人员或图形设计师在半周内进行测试吗？

测试人员经常做客户支持工作或与客户一起开发需求。测试人员可以充当客户的内部声音……如果他们与客户进行了足够多的互动，他们应该有责任感，从他们知道客户想要的开发中获得合适的优质产品。

3) 你在哪里可以找到好的测试人员（我想没有软件开发测试的学位）？

我敢打赌，某处有学位。我们的很多测试人员都是计算机科学专业的大学生，他们在工业领域工作了一年，然后再回到大学的最后一年。

4) 测试一切是否是技术团队项目经理的任务？

不必要。这取决于团队有多大，如果它很小，那么是的，有人可以加倍并担任这两个角色。但是，对于更大的项目，这些是不同的人。

* * *

**记住。**拥有测试人员并不是开发人员/程序员在编写代码或创建单元测试时不测试代码的借口。开发人员仍然有责任开发一个好的产品。他们永远不应该试图通过指责测试人员没有找到它来为他们创建的错误找借口。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-08T11:14:12.773

这是 Joel 测试的第 10 题：

[http://www.joelonsoftware.com/articles/fog0000000043.html](http://www.joelonsoftware.com/articles/fog0000000043.html)

应该告诉你你需要知道的一切。:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-08T10:43:42.147

团队中最好有测试人员。我们，开发人员在测试时不能得到这么多的缺陷，但是如果它是由测试人员测试的，那么他会在发布缺陷之前捕捉到这么多的缺陷。

最好也有单元测试用例。当我们开发一个新特性时，我们只需要更新测试用例并运行它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-08T10:51:27.983

在这两种情况下都需要测试人员。即使您的开发是测试驱动的，我认为测试人员的角色通常侧重于项目的外部需求——项目是否交付了能够满足需求的预期产品？

我发现在大型企业环境中，呼叫中心或提供客户服务的人员通常拥有一批优秀的测试人员。他们通常对业务流程、问题和需求有非常深刻的理解。

在这种情况下，我们经常让测试人员在后端系统中构建真实的测试用例，有时这些甚至被开发人员编写的集成测试使用。我们在让开发人员*向*测试人员询问数据/场景以测试基于 CI 的自动化测试方面取得了巨大成功。

您*可以*期望其他角色参与测试。我真的认为每个人都应该专注于质量和测试，但不幸的是*每个人*都不能负责。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-08T10:52:46.450

1.  从一定规模开始，绝对是（我会说大约 10 个开发人员）。

2.  测试人员还可以进行构建和集成工作。在较小的小组中，开发人员必须进行测试，因为没有其他人可以这样做。

3.  好问题。也许您的一些开发人员喜欢测试。

4.  不，尤其是当项目变得更大时。

我参与过一个大型项目（数百名开发人员），在我们的团队中大约有 50 名。我们小组有一个由两三个全职人员和一群学生组成的集成和测试小组。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-08T11:56:19.270

1.  大规模，是的。然而，有许多不同的方法和类型的测试。这些包括用户、回归、单元和集成测试。尽可能多地尝试自动化。查看 Selenium (IDE)、Molydbenum、使用场景和敏捷开发。

2.  开发人员或设计师应该确定他们是否符合验收标准，但如果他们测试自己的工作，那么这有点像在你参加考试之前编写自己的考试。在我看来，测试其他开发人员工作的开发人员并没有好多少。

3.  不知道

4.  我认为项目经理没有时间进行严格的测试。这确实是一个敬业的测试人员的工作，他知道要勤奋，并且可以与项目经理互动。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-08T12:32:21.930

> 1.  产品（或大型项目）开发中是否需要测试人员？
> 2.  测试人员应该只做测试工作吗？您能期望开发人员或图形设计师在半周内进行测试吗？
> 3.  你在哪里可以找到好的测试人员（我想没有软件开发测试学位）？
> 4.  测试一切是否是技术团队项目经理的任务？

1 - 当您拥有超过 10 个客户时进行产品开发：地狱是的。基本的。在大型项目中也是如此。当你很小的时候你可以吝啬，但是一旦你超过了一定的规模，更新（例如）全球 100 个客户的痛苦甚至超过了一个测试员的薪水。

2 - 是的，虽然支持工作也有一些重叠。开发人员应该进行基本测试——它有效吗？- 但由测试人员进行详尽的、端到端的、奇怪的用例类型测试。我认为这样做是在浪费开发人员的时间。平面设计师不应该测试——好吧，我希望他们是用户测试，但那是在它到达开发人员之前。

3 - 一些开发人员是优秀的测试人员。一些支持人员会成为优秀的测试人员。除此之外 - 只是随机找到它们。广告。等等。没有学位，但是一个迂腐的人，可以坚持自己，并且比每一行代码的工作方式更了解最终环境如何组合在一起。

4 - 没有。PM 将项目放在一起，并协调测试人员、开发人员等。技术负责人应该，你知道，领导技术团队。不测试。

显然，角色之间存在泄漏。有时，每个人都应该做一些测试，但这更多是为了在 RTM 之前获得最大的覆盖率，而不是每天或每周。

单元测试是一个很好的开始，因为它们会捕捉到逻辑错误，但不能指望它们捕捉到疯狂的用户交互，或者只有在你的应用程序运行 72 小时后才会出现的问题——单元测试永远不会捕捉到这些. 您的客户会，但是您不会有很长时间的客户:)

顺便说一句，我“去过那里，做到了”。我已经在客户身上进行了测试，并且在同一产品的不同阶段（初创公司收购了一家大公司）有合适的测试人员。一旦我们有了测试人员，产品就会变得更加可靠，客户也更开心（另外，很难将一个小的关键补丁推广到全球 400 个站点 - 在它发货之前抓住它！）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-08T14:08:26.040

永远不要低估专家的价值。

大多数不是测试人员的人，尤其是开发人员，不喜欢测试，也不会做好。如果您要求平面设计师或开发人员将一半的时间用于测试，那么您最多会损失 50% 的优秀设计师/开发人员的输出，而获得 50% 的差劲、昂贵的测试人员。在最坏的情况下，你会完全失去他们，因为他们会找到更好的工作场所。

对于开发人员来说，他们通常离代码太近而无法客观地对其进行测试。他们将根据对内部的了解做出假设。开发人员测试自己的代码尤其糟糕。

项目经理应该负责确保一切都经过测试，但他们不应该自己做。他们将没有足够的时间或必要的专业知识。

我之前在一家咨询公司工作。我们没有专业的测试人员，而是使用目前没有项目的顾问。他们都没有任何测试专业知识，因此他们中的大多数都不是很好的测试人员。我们会收到诸如“系统不再工作”之类的错误报告或我个人最喜欢的错误报告：显示它有多慢的应用程序屏幕截图（快速运行的应用程序屏幕截图看起来不会有任何不同）。他们也会滥用错误跟踪系统（或完全绕过它，转而使用他们自己的自制 Excel 电子表格）。这是一场噩梦。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-08T14:26:11.200

我认为测试人员（可以）带来的是对产品的全新看法。我发现在运行软件时我可能会走上幸福的道路，无论是通过 UI 交互还是使用我编写的类。当您知道某件事情应该如何工作时，以错误的方式做事，以非预期的方式使用产品或以没有人知道它如何工作的人的顺序尝试事物，这有点不自然做。

我对您的问题的回答如下：

1.  是的。测试是必要的，因此需要某种测试仪。通常，单元测试会发现很多低级问题，但可用性测试和“需求”测试会确定它是否满足光面手册上的要求。如果您声称您的软件执行“X”，那么测试人员的部分工作就是确保它确实执行“X”。我们让测试人员在我通常不使用的平台上发现了一些问题。尽早发现这些问题是件好事。

2.  也许。我们在内部交叉测试我们的产品，但也有一个单独的测试组。我们倾向于（内部）发现大部分问题，但全职测试人员有时会发现我们可能从未发现的东西。如果您在开发和测试之间分配时间，则需要明确测试不是事后的想法。如果我的开发工作负担过重并且很难花费必要的时间来测试您的产品，那么我作为测试人员就不会那么有效。如果您要让开发人员兼任测试人员，时间管理是必不可少的。

3.  没有把握。组织中的某些组（例如 IV 和 V 组）只进行测试。我怀疑有很多人没有业务或没有编写软件的愿望，但可以测试产品的性能。在我上一份工作中，我们一些最好的测试人员根本没有编写任何代码。

4.  取决于你的项目，但我一般会说不。责任是在我的店里传播的东西。领导不负责所有测试。我们都有责任。

无论如何，那是我的两分钱。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-09T14:47:54.917

每个人都会说需要测试人员，这是政治正确的答案。但测试人员只是质量保证工具箱中可用的众多工具之一。您可以在没有测试人员的情况下发布完美的软件。例如，我想知道 Stackoverflow 是否有测试部门？

测试人员将**测量**您的开发人员生成的代码的质量。但是质量测量的可用性对提高质量没有任何帮助。

测试人员不是免费来的。您必须更改开发以交付给测试团队而不是客户。这可能导致客户和开发人员之间的脱节：测试人员可能会发现客户不关心的错误，而忽略对客户非常重要的错误。此外，您还必须创建和维护一个单独的测试环境。

好的测试人员会帮助你更好地开发，尤其是更顺利地发布。但是你的里程会有所不同。

PS 在大公司中，测试人员是必不可少的：他们可以转移责任。说一个错误会导致客户伤害-> 高管很不高兴。在这一点上，高管已经准备好对你的团队做一些讨厌的事情了。有了测试团队，你可以把责任推给测试团队，测试团队又把责任推给你。妥协推出：你引入新流程，测试团队雇佣更多的测试人员，主管说他个人改进了东西。

# perl - 如何将常量导入 Perl 中的多个模块？

> ID：525515
> 
> 赞同：5
> 
> 时间：2009-02-08T10:37:07.107
> 
> 标签：perl, constants, activeperl

我正在用 Perl 编写一个包含多个模块的应用程序。我想编写一些在任何地方都可见的全局常量，如下所示：

```
#Constants.pm
$h0 = 0;
$scale = 20; 
```

然后在没有限定条件的情况下使用它们，`main::`或者`Constants::`在几个模块中使用它们。但是，如果我编写`use Constants;`多个模块，它们只会被导入一个命名空间。有没有办法解决？

我正在使用最新的 ActivePerl。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-08T14:15:55.353

查看[Exporter](http://search.cpan.org/dist/Exporter/lib/Exporter.pm)和`perlmod`手册页。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-07-06T02:25:22.467

这段代码应该完全符合您的要求。向[lkundrak 致敬](http://v3.sk/~lkundrak/)。

```
package Constants;

use base qw/Exporter/;

use constant BOB => 666;
use constant ALICE => 555;

sub import {
    no strict "refs";

    ${[caller]->[0].'::'}{$_} = ${__PACKAGE__."::"}{$_}
        foreach grep { not /^(ISA|isa|BEGIN|import|Dumper)$/ } 
            keys %{__PACKAGE__."::"};
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-09T07:28:28.810

不要告诉任何人我告诉过你这个，但是 Perl 的特殊变量无处不在。您可能已经注意到这不起作用：

```
{ package Foo;
our $global = 42; }

{ package Bar;
say "global is $global"; } 
```

那是因为`$global`实际上被称为`$Foo::global`. 您可能还注意到，此“规则”不适用于 `@INC`, `%ENV`,`$_`等。那是因为这些变量总是假定在`main`.

但实际上，它不仅仅是那些变量。整个 glob 被“强制”进入`main`. 这意味着您可以编写如下内容：

```
{ package Constants;
  $_{PI} = 3.141592; }

{ package Foo;
  say "pi is $_{PI}"; } 
```

它会起作用。

（同样适用于`$ENV`,`&INC`等）

但是，如果您曾经在真实代码中这样做过，预计有人会谋杀您 :) 不过，很高兴知道，以防万一您看到其他人这样做。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-08T11:31:25.513

你可以把它放在顶部`Constants.pm`：

```
package main; 
```

在这种情况下，您定义的所有变量都将位于`main`命名空间中：

```
$main::x 
```

或者如果你觉得勇敢：

```
package; 
```

在这种情况下，您定义的所有变量都将位于一个空的命名空间中：

```
$::x 
```

请注意，`package`不鼓励使用没有命名空间，并且在某些 Perl 版本中显然不推荐使用。请参阅下面的报价。

* * *

引自`man perlfunc`：

```
       包命名空间
       package 将编译单元声明为在给定的
               命名空间。包声明的范围是
               从声明本身到结束
               封闭块、文件或 eval（与“my”相同）
               操作员）。所有其他不合格的动态标识符
               将在此命名空间中。包声明影响
               只有动态变量——包括你使用过的变量
               “local” on--但不是词法变量，它们是 cre？
               与“我的”一起吃。通常它会是第一个声明？
               配给文件中的“要求”或
               “使用”运算符。您可以在更多中切换到一个包
               不止一处；它只影响哪个符号表
               由编译器用于该块的其余部分。
               您可以参考其他变量和文件句柄
               通过在标识符前面加上包的前缀来打包
               名称和双冒号：$Package::Variable。如果
               包名称为空，假定为“主”包。
               也就是说，$::sail 等价于 $main::sail（同样
               至于 $main'sail，仍然可以在旧代码中看到）。

               如果 NAMESPACE 被省略，那么没有当前包？
               年龄，并且所有标识符必须是完全限定的或
               词汇。但是，强烈建议您不要
               使用此功能。它的使用可能会导致意外
               行为，甚至使某些版本的 Perl 崩溃。这是
               已弃用，并将从将来的版本中删除。

```

* * *

**编辑：**这个问题也可能有帮助：[如何使用 Perl 模块中的常量？](https://stackoverflow.com/questions/193020/how-do-i-use-constants-from-a-perl-module "如何使用 Perl 模块中的常量？")

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-11T20:37:53.053

您可以像这样使用[导出器](http://search.cpan.org/dist/Exporter/lib/Exporter.pm)：

在常量.pm 中：

```
#Constants.pm
require Exporter;
@ISA = qw(Exporter);
@EXPORT = qw($h0 $scale);
@EXPORT_OK = qw(myfunc);

$h0 = 0;
$scale = 20;
sub myfunc {...}

```

注意：
* 数组中的in`&`是可选的，建议不要使用。* 这将在默认情况下导出和，并且只有在明确请求时才会导出 &myfunc（请参阅下文如何指定客户端模块导入的符号）`&myfunc``@EXPORT``$h0``$scale`

然后在导入 Constants.pm 并希望使用的模块中`$h0`，`$scale`或者`&myfunc`添加以下内容以导入Constants.pm 中的**所有**符号`@EXPORT`。

```
#MyModule.pm
use Constants qw(; 
```

如果您只想导入一些符号，请使用：

```
#MyModule.pm
use Constants qw($h0); 
```

最后，如果您不想导入任何 Constant.pm 的符号，请使用：

```
#MyModule.pm
use Constants (); 
```

# windows-vista - 为什么我的带有右锚定控件的 Borland C++Builder 5 表单在 Vista 上显示不正确？

> ID：525517
> 
> 赞同：1
> 
> 时间：2009-02-08T10:37:31.973
> 
> 标签：windows-vista, anchor, c++builder, vcl

我花了很长时间寻找解决方案并现在找到了它，我认为这对于 Stack Overflow 来说是很好的记录。所以我的回答将在这个问题之后紧随其后。

我使用的是 Borland C++ Builder 5。这可能也适用于 Delphi 的等效版本。我在 TPanel 上有一个带有 TButton 的表单。按钮设置为 akRight,akBottom。在 XP 和以前的 Windows 上，一切都很好。在 Vista 上，使用 Aero 时，按钮出现在右侧太远 4 个像素。锚定继续正常工作。

另一个例子是一个 TComboBox 的表单，它有 akTop、akRight、akLeft。该组合在 Vista 上显得太宽了 4 个像素。

回到 Vista 上的“经典”外观使一切看起来都正确。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-08T10:51:38.263

我尝试的第一件事没有奏效：我猜这个问题与 Vista 上较宽的窗口边框有关。我认为 VCL 中的 UpdateAnchorRules 由于设计宽度与 Vista 上窗口的实际宽度之间的差异而以某种方式计算不正确。查看 VCL 源代码，很明显更改锚点会导致再次调用 UpdateAnchorRules 并（希望）正确计算，因为它现在具有可用表单的实际宽度。

我添加了

```
TAnchors t = BlahBtn->Anchors;
t >> akRight;
BlahBtn->Anchors = t;
t << akRight;
BlahBtn->Anchors = t; 
```

到我的表单的构造函数。

没有喜悦。行为完全不受影响。

我认为这在此过程中可能为时过早，因此将相同的代码移至 FormShow 方法，同样不成功。作为最后一次尝试，我将表单的设计更改为按钮不再具有 akR​​ight 并将代码更改为

```
TAnchors t = BlahBtn->Anchors;
t << akRight;
BlahBtn->Anchors = t; 
```

...这也失败了 - 行为完全不受影响，除了我打破了 XP 上按钮的定位，以防保存的表单大小（我从注册表中读取并应用于 FormShow 中的表单）不是默认值。

在表单生命周期的各个时间点添加了一吨的调试代码，输出表单的宽度、按钮的宽度、按钮的左侧、表单的 ClientRect 等，我发现了问题。出于某种原因（可能仍然与窗口边框相关 - 我没有设法找出确切的原因），VCL 正在打开窗口，其宽度低于应有的 4 个像素。此后不久，宽度得到了纠正，但到那时，锚定（和 UpdateAnchorRules）已经将按钮的位置固定在右侧太远 4 个像素处。

解决方法是：

```
void __fastcall TFooBarDlg::CreateParams(TCreateParams &Params)
{
    TForm::CreateParams(Params);
    int i = GetSystemMetrics(SM_CXSIZEFRAME);
    Params.Width=Params.Width+(2*(i-4));
} 
```

这使用 Vista 报告的不同边框大小来更正表单的初始宽度。它会在 Vista 上导致正确的行为，同时在其他 Windows 版本（以及具有“经典”外观的 Vista）上保留它。

希望这可以帮助某人。

# html - HTML：iframe 像框架一样坚固

> ID：525522
> 
> 赞同：0
> 
> 时间：2009-02-08T10:41:55.303
> 
> 标签：html, iframe, frame

我正在寻找像框架一样实现 iframe 的方法。

当我更新它的 src 时，滚动条出现问题。它有时会在某些网页（如 Yahoo.com）中消失。我也必须对抗框架破坏者。

有一个非常好的实现可以满足我的需要。它是 EyeOS 的导航器。我想知道是否有任何类似的独立和现成的实现。

我不使用框架的原因是我不允许在框架上使用 JavaScript 下拉菜单。就我的研究而言，除了 HTML 组合框控件之外，这是不可能的。如果我不正确，请告诉我。:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T11:46:06.703

对不起，我不得不质疑你实现目标的方法。为什么首先需要一个`iframe`？有问题的问题可以用 ajax 和/或可滚动`div`元素解决吗？

和

```
div.scroll { overflow: scroll; } 
```

在您的 css 中，您可以使任何`div`滚动的内容就像`iframe`. [在jQuery](http://www.jQuery.com)的帮助下，使跨浏览器兼容的 AJAX 请求变得轻而易举。=)

请更具体一点：您到底*想*用 完成`iframe`什么？

# ruby-on-rails - 在迁移中填充 Rails 类

> ID：525534
> 
> 赞同：4
> 
> 时间：2009-02-08T10:56:13.387
> 
> 标签：ruby-on-rails, database-design, migration

我正在尝试为仅用作枚举的简单表创建迁移。所以我想立即用它的值填充表格。我尝试了以下方法：

```
class CreateUserTypes < ActiveRecord::Migration

def self.up
    create_table :user_types do |t|
      t.column :type, :string
      t.timestamps
    end
  end

  def self.down
    drop_table :user_types
  end

  UserType.create :type => "System administrator"
  UserType.create :type => "Simulation controller"
end 
```

但我收到此错误：

```
rake aborted!
An error has occurred, all later migrations canceled:

Could not find table 'user_types' 
```

我正在关注[Rails wiki](http://wiki.rubyonrails.com/rails/pages/UnderstandingMigrations)并希望它能够工作。

* * *

谢谢。但是您的建议似乎不起作用。好吧，我看不到琴弦。

```
sqlite> select * from user_types; 
1||2009-02-08 12:00:56|2009-02-08 12:00:56 
2||2009-02-08 12:00:57|2009-02-08 12:00:57 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-08T17:59:09.617

这是已经给出的两个答案的组合，但这应该适合您：

```
class CreateUserRoles < ActiveRecord::Migration
  def self.up
    create_table :user_roles do |t|
      t.string :role
      t.timestamps
    end

    UserRole.create :role => "System administrator"
    UserRole.create :role => "Simulation controller"
  end

  def self.down
    drop_table :user_roles
  end
end 
```

将您的类 UserType 重命名为 UserRole（连同相关的测试类，假设您使用生成器创建了所有这些类）。Rails 使用 'type' 列进行单表继承，并在您拥有派生自基类的模型时自动使用类名填充该字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T10:59:22.770

试试这个

```
class CreateUserTypes < ActiveRecord::Migration

  def self.up
    create_table :user_types do |t|
      t.string :role
      t.timestamps
    end

    UserType.create :role => "System administrator"
    UserType.create :role => "Simulation controller"
  end

  def self.down
    drop_table :user_types
  end

end 
```

它是调用 rake db:migrate 时默认运行的 self.up 方法

编辑：将列名更改为“角色”，因为“类型”保留用于单表继承。（看评论）。向 Kyle Boon 道歉，最终得到了一个非常相似的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T02:25:34.793

有点离题但值得一提：在迁移中实例化数据被认为是一种糟糕的形式，因为在生产环境中创建数据库的“官方”方式是

```
rake db:schema:load 
```

这当然不会从迁移文件中加载您的数据。你可能想看看我最喜欢的插件之一：Seed_Fu。

使用 Seed_fu，您可以在 YAML 中创建数据夹具，然后发出

```
rake db:seed 
```

当您想要设置数据时。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-08T17:49:22.257

HermanD 的答案应该有效。不过我想指出，您应该小心使用名为 'type' AFAIK 的列，Rails 使用该列名作为 STI。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T10:53:20.090

1.  将 create 语句放在 self.up 中
2.  **`UserType.reset_column_information`** 在创建表之后和填充它之前调用。模型 UserType 在创建表之前加载，因此 rails 在表存在之前收集了有关数据库结构的信息。您需要重置它，以便 Rails 再次检查表属性。
3.  不要使用“类型”作为属性名称。它用于性病。

    类 CreateUserTypes < ActiveRecord::Migration

    ```
    def self.up
      create_table :user_types do |t|
        t.column :role, :string
        t.timestamps
      end

      UserType.reset_column_information

      UserType.create :role => "System administrator"
      UserType.create :role => "Simulation controller"

    end

    def self.down
      drop_table :user_types
    end 
    ```

    结尾

# java - Default constructors and inheritance in Java

> ID：525548
> 
> 赞同：51
> 
> 时间：2009-02-08T11:10:36.307
> 
> 标签：java, inheritance, initialization, default-constructor

I have a question about default constructors and inheritance in Java.

Generally, if you write a class and do not include any constructor, Java provides automatically for you a default constructor (one without parameters), which initializes all instance variables of the class (if there are any) with some default values (0, null, or false). If you write a constructor, however, with some parameters, and you don't write any default constructor, then Java does not provide a default constructor. My question is: what is the case with classes, which inherit from other classes - if I write a constructor with some parameters in them, but don't include a default constructor, do they inherit the default constructor of the super class?

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-02-09T03:38:14.807

1.  如果不创建构造函数，[则会自动创建默认的空构造函数](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.8.9)。

2.  如果任何构造函数没有显式调用 super 或 this 构造函数作为其第一条语句，[则会自动添加对 super() 的调用](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.8.7)。

总是。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2009-02-08T11:17:28.693

**Constructors are not inherited.**

Also, the initialization of fields is done by the virtual machine, not the default constructor. The default constructor just invokes the default constructor of the superclass, and the default constructor of Object is empty. The good point of this design is that there is no way to ever access uninitialized fields.

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-08T11:18:28.770

Unless you use super(...) a constructor calls the empty constructor of its parent. Note: It does this on all you classes, even the ones which extend Object.

This is not inheriting, the subclasses don't get the same constructors with the same arguments. However, you can add constructors which call one of the constructors of the super class.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-11-29T18:49:47.957

基本规则是对构造函数的调用（或调用）应该是 JVM 需要执行的第一条语句，

所以当你有一个只有参数化构造函数而没有默认构造函数的超类，并且基类没有显式调用超类的参数化构造函数时，JVM 提供了 super(); call 抛出错误，因为超类没有默认构造函数，因此我们要么在超类中提供默认构造函数，要么在基类构造函数中显式调用超类的参数化构造函数。当我们进行显式调用时，JVM 不会费心放置 super(); 行。因为构造函数调用应该是方法的第一条语句，这不可能发生（因为我们显式调用）。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-02-13T15:37:28.607

Java 语言规范的第 8.8.9 节详细解释了发生了什么：

> 如果类不包含构造函数声明，则隐式声明默认构造函数。顶级类、成员类或本地类的*默认构造函数*形式如下：
> 
> *   默认构造函数具有与类相同的可访问性（第 6.6 节）。
> *   默认构造函数没有形式参数，除非在非私有内部成员类中，默认构造函数隐式声明一个形式参数，表示该类的直接封闭实例（§8.8.1、§15.9.2、§15.9.3 ）。
> *   默认构造函数没有 throws 子句。
> *   如果声明的类是原始类 Object，则默认构造函数的主体为空。否则，默认构造函数只是调用不带参数的超类构造函数。

你可以看到这里没有继承：所有的一切都是带有隐式声明的默认构造函数的“编译器魔法”。规范还明确指出，只有当类根本没有构造函数时才会添加默认构造函数，这意味着您的问题的答案是“否”：一旦你给一个类一个构造函数，访问它的默认构造函数超类丢失了。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-08T11:25:48.910

如果您提供构造函数，那么 Java 不会为您生成默认的空构造函数。所以你的派生类只能调用你的构造函数。

默认构造函数不会将您的私有变量初始化为默认值。证明是可以编写一个没有默认构造函数并将其私有成员初始化为默认值的类。这是一个例子：

```
public class Test {

    public String s;
    public int i;

    public Test(String s, int i) {
        this.s = s;
        this.i = i;
    }

    public Test(boolean b) {
        // Empty on purpose!
    }

    public String toString() {
        return "Test (s = " + this.s + ", i = " +  this.i + ")";
    }

    public static void main (String [] args) {
        Test test_empty = new Test(true);
        Test test_full = new Test("string", 42);
        System.out.println("Test empty:" + test_empty);
        System.out.println("Test full:"  + test_full);
    }
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-06-23T11:22:01.277

拇指规则是子类应该从基类调用任何构造函数。因此，如果您没有默认的 const ，则从子类中调用现有的 const 。其他明智的做法是在基类中实现空 const 以避免编译问题

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-03-23T09:31:11.230

你的问题的答案很简单。隐式（不可见），任何构造函数中的第一条语句都是 'super();' 即对超类的无参数构造函数的调用，直到您将其显式更改为 'this();','this(int)','this(String)','super(int)','super(String )' 等 'this();' 是当前类的构造函数。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-01-26T09:46:27.013

当我们不创建构造函数时，Java 会自动创建一个默认构造函数。但是当我们创建一个或多个带有参数的自定义构造函数时，Java 不会创建任何默认构造函数。如果我们创建一个或多个构造函数并且我们想要创建一个没有任何构造函数参数的对象，我们必须声明一个空的构造函数。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-08-30T18:37:07.610

会有编译时错误...因为编译器会寻找默认的构造函数他的超类，如果它不存在......它是一个错误......并且程序将不会编译......

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-05-19T07:47:32.400

子类中的任何构造函数都会调用父类的无参数构造函数（或默认构造函数）。如果在父类中定义参数化构造函数，则必须使用 super 关键字显式调用父类构造函数，否则会产生编译错误。

```
class Alpha 
{ 
    Alpha(int s, int p) 
    { 
        System.out.println("base");
    }

} 

public class SubAlpha extends Alpha 
{ 
    SubAlpha() 
    { 
        System.out.println("derived"); 
    } 
    public static void main(String[] args) 
    { 
        new SubAlpha(); 
    } 
} 
```

上面的代码会给出编译错误：

```
prog.java:13: error: constructor Alpha in class Alpha cannot be applied to given types;
    { 
    ^
  required: int,int
  found: no arguments
  reason: actual and formal argument lists differ in length
1 error 
```

发生上述错误是因为我们在父类中没有任何无参数构造函数/默认构造函数，也没有从子类调用参数化构造函数。

现在要解决这个问题，可以像这样调用参数化构造函数：

```
class Alpha 
{ 
    Alpha(int s, int p) 
    { 
        System.out.println("base");
    }

} 

public class SubAlpha extends Alpha 
{ 
    SubAlpha() 
    { 
        super(4, 5); // calling the parameterized constructor of parent class
        System.out.println("derived"); 
    } 
    public static void main(String[] args) 
    { 
        new SubAlpha(); 
    } 
} 
```

输出

```
base
derived 
```

或者

在父类中定义一个无参数构造函数，如下所示：

```
class Alpha 
{ 
    Alpha(){

    }
    Alpha(int s, int p) 
    { 
        System.out.println("base");
    }

} 

public class SubAlpha extends Alpha 
{ 
    SubAlpha() 
    { 
        System.out.println("derived"); 
    } 
    public static void main(String[] args) 
    { 
        new SubAlpha(); 
    } 
} 
```

输出

```
derived 
```

# sql-server - How can a Table's Last Modified date be returned in SQL Server 2005?

> ID：525558
> 
> 赞同：0
> 
> 时间：2009-02-08T11:21:18.390
> 
> 标签：sql-server, sql-server-2005

How can a Table's **Last Modified date** be returned in SQL Server 2005?

I did see one on the **Table Properties** page. There is a **Created Date** but no **Modified date**.

If it is not available, what would be some other ways to add this functionality?

Here are a few that come to mind:

1.  Add another column, to the table, that a trigger would update whenever the record was added or changed. The one con, to this approach, is Deletes would not be tracked.
2.  Add another table (TableModifiedDate) that would contain a Table Name and Modified Date. Then add a trigger to the tables that you want to track which will update TableModifiedDate.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-08T11:52:56.127

[此博客条目](https://sqlblog.org/2008/05/06/when-was-my-database-table-last-accessed)包含有关如何在 SQL Server 2008 和 2005 上执行此操作的信息。

*   2008 年：使用新的服务器审计功能
*   2005 年：使用动态管理视图 (DMV)

SQL Server 2000 没有内置的可能性来做到这一点，所以你需要一个解决方法，就像你已经提到的那样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T11:24:59.817

Paul Nielson 的[AutoAudit](http://www.codeplex.com/AutoAudit)是一种快速有效地将其改装到数据库的方法。[他在这里](http://www.screencast.com/users/PaulNielsen/folders/ScreenCasts/media/9a08e3c0-6193-41e5-b697-f4d1d6c21ef3)有一个演示截屏。

# algorithm - Equal sum subsets hybrid

> ID：525559
> 
> 赞同：7
> 
> 时间：2009-02-08T11:21:27.687
> 
> 标签：algorithm, complexity-theory, subset-sum

The problem is the following:

You are given a set of positive integers { a1 , a2 , a3 , ... , an } in which there are no same numbers ( a1 exists only once ,a2 exists only once,...) eg A = {12 , 5 ,7 ,91 }. Question: Are there two disjoint subsets of A , A1 = { b1,b2,...,bm } and A2 = { c1,c2,...,ck} so that b1+b2+...+bm = c1+c2+...+ck ?

Note the following: It is not obligatory for A1 and A2 to cover A, so the problem isn't automatically reduced to the subset sum problem. eg A = {2,5,3,4,8,12} A1= {2,5} so sum of A1 is 7 A2= {3,4} so sum of A2 is 7 We found two disjoint subsets of A with the described property so the problem is solved.

How can I solve this problem? Can I do something better than find all possible (disjoint)subsets, calculate their sums and find two equal sums?

Thank you for your time.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-08T12:49:46.713

没问题，这里有一个`O(1)`解决方案。

```
A1 = {}; 
A2 = {};
sum(A1) == sum(A2) /* == 0 */ 
```

QED。

* * *

说真的，您可以进行的一项优化（假设我们谈论的是正数）是只检查小于或等于`sum(A)/2`.

对于其中的每个元素，`A`都有三个选项可以使它`O(3^N)`：

1.  把它放进去`A1`
2.  把它放进去`A2`
3.  丢弃它

这是 Perl 中的一个幼稚解决方案（计算匹配项，如果您只想测试存在性，则可以提前返回）。

```
use List::Util qw/sum/;

my $max = sum(@ARGV)/2;
my $first = shift(@ARGV); # make sure we don't find the empty set (all joking aside) and that we don't cover same solution twice (since elements are unique)
my $found = find($first,0, @ARGV);
print "Number of matches: $found\n";

sub find {
    my ($a, $b, @tail) = @_;
    my $ret = $a == $b? 1 : 0; # are a and b equal sub-sets?
    return $ret unless @tail;

    my $x = shift @tail;
    $ret += find($a + $x, $b, @tail) if $a + $x <= $max; # put x in a
    $ret += find($a, $b + $x, @tail) if $b + $x <= $max; # put x in b
    return $ret + find($a, $b, @tail); # discard x
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T13:11:28.153

如果答案是否定的，那么所有 n 个数字的总和至少为 2^n-1。因此，如果 n 很大，并且数字是 32 位整数，那么答案几乎总是肯定的。如果 n 很小，您可能可以蛮力。

最困难的情况可能是当 n 约为 30 时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-08T20:49:05.570

我认为您可以像子集和问题一样解决它。取布尔函数 Q(i,s)，如果 a0,a1,...,ai 有一个总和为 s 并包含 ai 的子集，则该函数为真。您可以使用动态编程为所有 i 和 s 计算它（这是标准方法）。然后，您可以扫描 Q 的所有值以查找在其关联行中具有多个真值的 s。

如果存在这样的 s，则意味着您找到了两个具有相同总和的不同子集。它们可能不是不相交的，但是您可以从每个集合中删除公共元素并获得两个总和相等的不相交集合。不过，其中一个可能是空的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T05:09:23.910

这个问题似乎至少和 SUBSET-SUM 一样难。如果我们可以找到 A 的两个子集：B = {b1,...,bp} 和 C = {c1,...,cq} 使得 b1+...+bp = -c1-...-cq，或者如果我们确定不存在，那么我们已经解决了 SUBSET-SUM(A)（忽略 0 ∈ A 的平凡情况）。

我不确定您的意思是 B 和 C 没有义务覆盖 A，因此问题不会自动归结为子集和问题。请检查 SUBSET-SUM 的定义。

# git - 使用 git 与服务器同步文件

> ID：525576
> 
> 赞同：4
> 
> 时间：2009-02-08T11:41:45.213
> 
> 标签：git

Git新手在这里。有没有办法同步两个存储库，以便当前签出的文件将是所有更改的最新版本？

我所拥有的是：

```
Desktop       Server
-------       ------
Change_X      Change_Y 
```

我想输入一些“魔术”命令，然后合并更改

```
Desktop       Server
-------       ------
Change_X      Change_X
Change_Y      Change_Y 
```

问题之一是桌面是 NAT 后面的 Windows 机器，我想避免在其上设置 sshd。基本上我想使用 ssh 从桌面到服务器来完成这一切。

这似乎对 git 来说应该是微不足道的，但我不知道该怎么做。

（我认为`git push`可以解决问题，但事实证明它不会对当前签出的分支进行更改，因此来自桌面的更改不会到达服务器）

有没有办法用 git 做到这一点，还是我偏离了轨道？

**解决方案：我从**[这里](http://utsl.gen.nz/git/post-update)下载了更新后脚本并将其放在服务器上的 hooks 目录中，现在`git push`使服务器随着更改进行更新。所以基本上“魔术命令”解析为：

```
git pull server:scripts/ master
git push server:scripts/ 
```

（`scripts`是我正在同步的文件夹）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-08T12:00:05.487

应该可以创建一个提交后挂钩，该挂钩将在更改时更新服务器的工作副本（我对 mercurial 做了完全相同的事情，所以我认为它也可以使用 git）。所以在你推送之后，工作副本会自动更新。

创建将运行的提交后挂钩`git up`或 git 的任何等效命令。
对不起，我不知道还能说什么。
**更新：**[官方 git faq](http://git.or.cz/gitwiki/GitFaq#head-b96f48bc9c925074be9f95c0fce69bcece5f6e73)中有一些解释。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T12:28:05.917

> *问题之一是桌面是 NAT 后面的 Windows 机器，我想避免在其上设置 sshd。基本上我想使用 ssh 从桌面到服务器来完成这一切。*

不是对您的问题的直接回答，但如果您在 NAT 后面，更容易做的是使用 Putty 或其他东西而不是 sshd 服务器运行反向 SSH 隧道。

```
ssh -R3333:127.0.0.1:9418 <user>@<server> 
```

现在，连接到`<server>`的端口 3333 将被转发到您的 NAT-ed 机器的 git 端口。

# c# - 为什么我的所有 Visual Studio 测试结果都是“未执行”

> ID：525578
> 
> 赞同：22
> 
> 时间：2009-02-08T11:42:37.987
> 
> 标签：c#, unit-testing, visual-studio-2008

当我在我的项目中运行我的单元测试时，我看到每个结果都“未执行”。我已经重新启动了我的计算机，所以我怀疑这是某种挂起的进程问题。

谷歌什么也没透露。有没有人有任何想法？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-02-09T10:14:19.427

什么皮塔饼！IDE 没有显示任何错误。为了确定错误，您必须这样做

1.  打开 Visual Studio 命令提示符
2.  切换到测试项目的二进制输出所在的目录。
3.  键入 mstest /testcontainer:The.Name.Of.Your.Test.Assembly.dll

在输出的底部，您将看到以下文本

> 运行有以下问题：

在我的情况下，它是以下内容：

未能将测试运行 'Peter Morris@PETERMORRIS-PC 2009-02-09 10:00:37' 排队：测试运行部署问题：文件或目录的位置 'C:\SomePath\SomeProject.Tests\bin\Debug\ Rhino.Mocks.dll' 不受信任。

现在，如果 VS 在 IDE 中告诉我这一点，我可以在几分钟内修复它！您所要做的就是打开 Windows 资源管理器并找到该 DLL。右键单击它并转到属性。然后单击“取消阻止”按钮。

真是浪费我的时间！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-21T22:40:14.590

**未执行单元测试**

我发现最好不要为单元测试类创建构造函数。如果构造函数中的任何东西抛出，测试将被报告为“未执行”。将测试初始化​​放在 TestInitialize 方法中。IDE 报告那里引发的异常。

**被阻止的二进制文件**

通常，您必须先解锁 ZIP 文件本身，然后再从中提取二进制文件，然后所有二进制文件都将被解锁。如果您尝试解锁二进制文件本身，则解锁不会“粘住”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T20:49:33.810

**“未能将测试运行 'XXX' 排队。路径不是合法形式。** ”的另一个原因是该帐户没有加载配置文件。

例如，当您使用 CreateProcessAsUser() 启动 mstest.exe 并忘记调用 LoadUserProfile() 时。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-03-15T17:29:25.140

如果您尝试从**IIS**开始测试运行，则会出现**“无法将测试运行 'XXX' 排队。路径不是合法形式。”** **如果运行应用程序池的用户没有用户配置文件**，则可以抛出。为了解决这个问题，只需在应用程序池高级设置中将 Load User Profile 设置为 true。

请参阅[https://social.msdn.microsoft.com/Forums/vstudio/en-US/7bb32a2d-7d10-4b8e-b743-e5beb1175917/trigger-mstest-from-app-hosted-on-iis?forum=csharpgeneral](https://social.msdn.microsoft.com/Forums/vstudio/en-US/7bb32a2d-7d10-4b8e-b743-e5beb1175917/trigger-mstest-from-app-hosted-on-iis?forum=csharpgeneral)

和[https://blogs.msdn.microsoft.com/vijaysk/2009/03/08/iis-7-tip-3-you-can-now-load-the-user-profile-of-the-application-pool -身份/](https://blogs.msdn.microsoft.com/vijaysk/2009/03/08/iis-7-tip-3-you-can-now-load-the-user-profile-of-the-application-pool-identity/)

了解更多信息

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-20T15:14:23.420

有时错误也可能是“**无法将测试运行'XXX'排队。路径不是合法形式。** ”

解决方案可能是更改 .testsettings 文件中的 TRX 命名模式。

来自[http://social.msdn.microsoft.com/Forums/da-DK/vststest/thread/c6efa2ba-1657-41bc-85b1-5a889d111e2f](http://social.msdn.microsoft.com/Forums/da-DK/vststest/thread/c6efa2ba-1657-41bc-85b1-5a889d111e2f)的报价：

> 如果要控制此 .trx 文件的名称，请打开解决方案资源管理器，在解决方案项目中打开 Local.testsettings，选择常规，将默认命名方案更改为用户定义方案。进而，
> 
> 1.  您可以使用 VS 运行测试以获取您定义的 .trx 文件。
>     
>     
> 2.  如果你想在命令行中得到这个结果，你可以使用 /testsettings:Local.Testsettings 运行它。有关详细信息，请参阅 [http://msdn.microsoft.com/en-us/library/ms182489.aspx#testsettings](http://msdn.microsoft.com/en-us/library/ms182489.aspx#testsettings)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-31T23:24:07.567

确保您的测试类和测试方法是公开的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-06-04T14:54:01.613

In my case I had a circular reference in my code. Compile worked, but the tests just marked as "Not run".

# c# - 使用 C# 的 GUI 问题

> ID：525583
> 
> 赞同：0
> 
> 时间：2009-02-08T11:47:15.343
> 
> 标签：c#, winforms

在我的应用程序开始时，我禁用了一些按钮，并根据某些条件启用了这些按钮。我的问题是当用户点击一个按钮然后它执行我的操作时它的颜色变成灰色并且当我再次禁用它时。更多解释：

按钮.启用 = 假；

如果（条件）{ button.enabled =true; }

// 用户点击了按钮

// 做按钮的功能

按钮.启用=假；// 这里按钮的颜色变成灰色，我不想启用这种态度，我希望在应用程序开始时，当所有按钮都被禁用时，它的颜色类似于按钮的背景。那么为什么是这个颜色呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T11:59:05.647

我不完全确定我是否正确阅读了您的问题，但在我看来，您可能想要这样的东西：

```
button.Enabled = Condition; // Initial value

// user clicked on button
button.Enabled= false; 
 ... do button's function ...
button.Enabled = Condition 
```

这应该像单击之前一样恢复按钮的状态，基本上只是在处理过程中禁用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T12:26:34.203

大多数 winform 控件的禁用状态在很大程度上由 Win32 控件集修复。如果你不喜欢它，那么：

*   **实际上**不要禁用它 - 只需手动更改颜色，禁用制表位，并在“有点禁用”时忽略点击
*   使用 WPF，它具有完全独立的实现并且不受 Win32 根目录的影响
*   从头开始编写自己的按钮控件（不要碰 Win32 的）
*   使用第 3 方按钮控件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T11:56:53.780

禁用按钮后更改颜色

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-08T14:36:50.867

我之前对 TextBox 有过类似的问题。避免此问题的最佳方法是在禁用按钮后重置颜色。

```
var color = button.BackgroundColor;
button.Enabled = false;
button.BackgroundColor = color; 
```

[http://blogs.msdn.com/jaredpar/archive/2007/02/12/readonly-textbox-that-doesn-t-look-funny.aspx](http://blogs.msdn.com/jaredpar/archive/2007/02/12/readonly-textbox-that-doesn-t-look-funny.aspx)

# php - Fusebox 框架的未来

> ID：525589
> 
> 赞同：4
> 
> 时间：2009-02-08T11:55:14.937
> 
> 标签：php, coldfusion, frameworks, comparison

好旧的[Fusebox](http://fusebox.org/)是我的第一个框架，我仍然非常喜欢它。从 PHP 版本开始，目前使用最新的 CFML 版本。

但时间过去了，我想知道：也许我应该切换到另一个框架？好吧，我不想在这里发动圣战。我只想知道继续使用FB的利弊。

说，我认为无 XML 控制器是一个非常好的主意，并且迈向了未来。或者也许我错了，这还不够，我应该专注于 Mach-II 或者 Model-Glue 或......（输入你的最爱）？

但是 PHP 呢？似乎它已经过去了一点。Symfony、CakePHP、Zend 等现在看起来好多了，而且发展迅速。

因此，比较方面的粗略列表如下：

1.  用于开发和维护的时间。对我来说，FB 在这里似乎已经足够好了。
2.  ORM 集成。目前我正在使用自己的组件（顺便说一句，很惊讶在 cf9 预览中看到非常相似的语法），但担心它们的性能。
3.  整体应用性能。缓存？“解析”文件还不够好？
4.  与其他产品集成。例如，使用单元测试工具——有没有人有这方面的经验？

任何想法和意见表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-09T03:16:09.463

Fusebox 仍在积极开发中，最近才易手，因此首席开发人员现在是[Adam Haskell](http://cfrant.blogspot.com/)。

**你应该切换到另一个框架吗？**

这是一个主观的问题。唯一好的答案是——给定无限的时间和机会——你应该尝试所有这些，看看你喜欢什么。它们各有利弊，但大多数人都同意，这不是框架的问题，*而是**框架*的问题。你已经决定这是你腰带上的工具，对你有好处。让它成为你理解和享受的工具。

 *也就是说，时间和机会并不总是可用的。在这种情况下，您可能最好坚持您所知道的，并通过对 Fusebox 的最新更改来了解新功能。我没有时间自己学习它们，所以我自己也是一个模型胶人。我在不久的将来会看到一些 Fusebox，但同样，它是主观的，重要的是你正在做最适合你的情况的事情。

**PHP**

由于我是一名 CFML 开发人员，因此我无法真正谈论 PHP 框架的现状。同样，如果您有时间，请与他们一起玩并评估他们所处的位置以及它们是否是您有兴趣使用的工具。

**ORM 集成**

我知道 Model-Glue 具有 ORM 集成[——Reactor](http://www.alagad.com/go/products-and-projects/reactor-for-coldfusion)和[Transfer](http://www.transfer-orm.com/)都非常容易挂钩。我怀疑 Mach-II 也可以这样说，可能还有 Fusebox，但我对任何一个都不乐观。

在 Hibernate 中烘焙的 ColdFusion 9 可能在任何框架中都能很好地工作，但这还有待观察。

**性能/缓存；解析文件？**

这更像是一个 ColdFusion 与 .Net 的问题，对吧？PHP 也是一种“已解析”的语言。预编译的二进制代码在运行时总是至少有一点优势，但考虑到对于大多数 Web 应用程序来说，添加一些功能更强大的硬件比花费额外的几个月（或更长时间）开发软件更容易，也更便宜。

“解析”文件是否仍然足够好？是的！哎呀是的！

**集成和测试框架**

有多种测试框架，包括用于单元测试的 CFUnit、CFCUnit 和 MXUnit（适用于[TDD](http://en.wikipedia.org/wiki/Test_Driven_Development)），以及用于[BDD的](http://en.wikipedia.org/wiki/Behavior_Driven_Development)[CFSpec](http://cfspec.riaforge.org/)。我敢肯定还有很多其他人。

CF8 带来了与 .Net 和 Exchange 的集成（可能还有一些我忘记的东西），并且我们从版本 6 开始就与 Java 进行了集成。“混搭”一些用这些不同语言编写的组件从未如此简单语言以获得最好的世界。

**结论**

你的问题标题是关于 Fusebox 框架的未来，我可以告诉你它不会去任何地方（除了继续成长和改进，就像其他 CFML 框架......）。如果您对 Fusebox 感到满意，可能没有理由离开它。这并不意味着您不应该尝试一切，但没有理由放弃船舶。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T03:42:14.923

**扩大视野不会有什么坏处：**

比较的范围是如此之大，以至于您不可能在单个 SO 线程中获得针对您的四个标准的全面且精确定制的答案。这是一个很好的问题，但没有一个单一的答案是确定的。

相反，我会问什么（如果有的话）会阻止你尝试不同的框架并扩大你的视野（假设你的独家或主要经验是 FB）。

没有什么能超越您根据第一手经验对您的四个标准的评估，尤其是当您询问那些非常主观或由每个“高调”Web 应用程序框架合理解决的因素时。

**特别向 FB 致敬：**

甚至在大多数人听说过 XML 或 Web 框架之前，Fusebox 框架就已经产生并获得了发展势头。它是第一个“消除烦恼”的 web 开发框架之一，旨在真正让 web 应用程序开发更“有趣”（目标是从 ColdFusion 中消除一些烦恼和乏味，它本身就是当时的一个特殊框架） .

因此，它已经取得了长足的进步，并且拥有相对稳健的业绩记录（就像 ColdFusion 一样）。

然而，这可能被一些人认为是对 FB 的重大损害（就像 ColdFusion 一样）。框架中有很多“包袱”，坦率地说，如果它与许多其他 MVC 框架的年龄相同，这些框架作为“新手”正在获得信誉。有很多方面（从语言设计的角度来看）揭示了一些粗糙的边缘，如果您选择 FB 作为完成工作的唯一方式，这些可能会对您对 Web 应用程序框架的思考方式产生负面影响。

如果没有命名，（您已经听说过）我建议您最好将 FB 保留在您的工具带上，但也可以分支到较新的框架，*尤其是*那些基于PHP 和 ColdFusion 以外*的编程语言的框架。*

这样，您也将扩展您作为程序员的视野和理解。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T14:21:14.263

在工作中，我们使用 Fusebox (php)……太糟糕了！

如果可能的话，我肯定会建议迁移一个更“时髦”的框架。

虽然.. 我所做的，而且这似乎减轻了我对框架的大部分不满，是编写模板文件，包括来自开关的模板文件，并且还在同一个 case 语句中计算任何“运行时间”参数。这促进了良好的代码重用。

但我的意思是.. 有 1 个巨大的 switch 语句？这不是“这应该是一个对象”的代码味道吗？它让我想起了 RoR 控制器类的程序版本。（我不是一个 RoR 人..只是说）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T14:02:20.313

如果您正在寻找一个多合一的 Rails 类型框架，请查看 cfwheels。

[http://www.cfwheels.com](http://www.cfwheels.com)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-18T22:20:03.617

一段时间后，我们可以说 Fusebox 是死的比活着的还多。

1.  A.Haskell的[FuseNG 更新](http://cfrant.blogspot.com/2009/11/fuseng-update.html)

2.  Google Groups[中 FuseNG 的状态。](http://groups.google.com/group/fuseng/browse_thread/thread/1eeb65b02450c968)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-19T18:00:53.763

我在上一份工作中几乎只使用 FB。我们的大部分代码库都是非 OO（cfc 尚不存在），因此模型/视图的区别确实帮助了我们。设计师知道直接前往视图文件夹，而不是在其他地方闲逛太多。与简单地使用目录相比，Circuits 为我们提供了一种更好的方式来映射站点区域。一般来说，它解决了页面作为构建工作方式的很多问题。

随着时间的推移，我发现大多数模型/控制器代码最终都在 cfc 和 dao 中，只有视图文件，而索引确实保留在 .cfm 中，因此这种分离几乎是自然发生的。这产生了一种新的问题，FB 并没有真正帮助解决 - 管理所有 cfc 和生成的对象以及初始化和继承。正因为如此，我开始使用[冷泉](http://www.coldspringframework.org/)框架，它感觉更专注于现代 OO CF 中出现的问题，与我们多年前编写的基于页面的 CF 相对。

# bash - 通过 Bash 命令在文本文件中查找和替换

> ID：525592
> 
> 赞同：664
> 
> 时间：2009-02-08T11:57:39.143
> 
> 标签：bash, replace, scripting, ironpython

对给定的输入字符串进行查找和替换的最简单方法是什么，比如在文件中`abc`替换为另一个字符串？`XYZ``/tmp/file.txt`

我正在编写一个应用程序并使用 IronPython 通过 SSH 执行命令——但我不太了解 Unix，也不知道要寻找什么。

我听说 Bash 除了作为命令行界面之外，还可以是一种非常强大的脚本语言。所以，如果这是真的，我假设你可以执行这样的操作。

我可以用 bash 来做吗，实现我的目标的最简单（一行）脚本是什么？

* * *

## 回答 #1

> 赞同：1119
> 
> 时间：2009-02-08T12:20:29.707

最简单的方法是使用 sed（或 perl）：

```
sed -i -e 's/abc/XYZ/g' /tmp/file.txt 
```

`-i`由于该选项，它将调用 sed 进行就地编辑。这可以从 bash 中调用。

如果您真的真的只想使用 bash，那么以下方法可以工作：

```
while IFS='' read -r a; do
    echo "${a//abc/XYZ}"
done < /tmp/file.txt > /tmp/file.txt.t
mv /tmp/file.txt{.t,} 
```

这会遍历每一行，进行替换，然后写入临时文件（不想破坏输入）。最后的移动只是临时移动到原始名称。（为了稳健性和安全性，临时文件名不应该是静态的或可预测的，但我们不要去那里。）

### 对于 Mac 用户：

`sed -i '' 's/abc/XYZ/g' /tmp/file.txt`（请参阅下面的评论为什么）

* * *

## 回答 #2

> 赞同：177
> 
> 时间：2009-02-08T12:10:32.440

文件操作通常不是由 Bash 完成，而是由 Bash 调用的程序完成，例如：

```
perl -pi -e 's/abc/XYZ/g' /tmp/file.txt 
```

该`-i`标志告诉它进行就地替换。

有关`man perlrun`更多详细信息，包括如何备份原始文件，请参阅。

* * *

## 回答 #3

> 赞同：75
> 
> 时间：2013-04-09T15:35:27.373

当我偶然发现这个时，我很惊讶...

`replace`软件包附带了一个命令`"mysql-server"`，因此如果您已安装它，请尝试一下：

```
# replace string abc to XYZ in files
replace "abc" "XYZ" -- file.txt file2.txt file3.txt

# or pipe an echo to replace
echo "abcdef" |replace "abc" "XYZ" 
```

有关`man replace`更多信息，请参阅。

* * *

## 回答 #4

> 赞同：69
> 
> 时间：2015-12-07T12:48:56.783

这是一篇旧帖子，但对于任何想要使用变量的人来说，@centurian 说单引号意味着什么都不会被扩展。

获取变量的一种简单方法是进行字符串连接，因为这是通过 bash 中的并置完成的，以下应该可以工作：

```
sed -i -e "s/$var1/$var2/g" /tmp/file.txt 
```

* * *

## 回答 #5

> 赞同：43
> 
> 时间：2009-02-08T12:13:13.807

Bash 和其他 shell 一样，只是一个协调其他命令的工具。通常你会尝试使用标准的 UNIX 命令，但你当然可以使用 Bash 来调用任何东西，包括你自己编译的程序、其他 shell 脚本、Python 和 Perl 脚本等。

在这种情况下，有几种方法可以做到这一点。

如果您想读取一个文件，并将其写入另一个文件，同时进行搜索/替换，请使用 sed：

```
 sed 's/abc/XYZ/g' <infile >outfile 
```

如果您想就地编辑文件（就像在编辑器中打开文件，编辑它，然后保存它），请向行编辑器“ex”提供说明

```
 echo "%s/abc/XYZ/g
    w
    q
    " | ex file 
```

示例就像`vi`没有全屏模式。你可以在`vi`'s`:`提示符下给它同样的命令。

* * *

## 回答 #6

> 赞同：36
> 
> 时间：2013-02-07T14:48:02.140

我发现了这个线程，我同意它包含最完整的答案，所以我也添加了我的：

1.  `sed`并且`ed`非常有用......手工制作。看看@Johnny 的这段代码：

    ```
    sed -i -e 's/abc/XYZ/g' /tmp/file.txt 
    ```

2.  当我的限制是在 shell 脚本中使用它时，不能在内部使用任何变量来代替“abc”或“XYZ”。BashFAQ似乎[至少](http://mywiki.wooledge.org/BashFAQ/021)与我的理解一致。所以，我不能使用：

    ```
    x='abc'
    y='XYZ'
    sed -i -e 's/$x/$y/g' /tmp/file.txt
    #or,
    sed -i -e "s/$x/$y/g" /tmp/file.txt 
    ```

    但是，我们能做些什么呢？正如@Johnny 所说，使用 a`while read...`但是，不幸的是，这并不是故事的结局。以下对我很有效：

    ```
    #edit user's virtual domain
    result=
    #if nullglob is set then, unset it temporarily
    is_nullglob=$( shopt -s | egrep -i '*nullglob' )
    if [[ is_nullglob ]]; then
       shopt -u nullglob
    fi
    while IFS= read -r line; do
       line="${line//'<servername>'/$server}"
       line="${line//'<serveralias>'/$alias}"
       line="${line//'<user>'/$user}"
       line="${line//'<group>'/$group}"
       result="$result""$line"'\n'
    done < $tmp
    echo -e $result > $tmp
    #if nullglob was set then, re-enable it
    if [[ is_nullglob ]]; then
       shopt -s nullglob
    fi
    #move user's virtual domain to Apache 2 domain directory
    ...... 
    ```

3.  正如人们所看到的那样，如果`nullglob`设置了，当有一个包含 a 的字符串时，它的行为很奇怪`*`：

    ```
    <VirtualHost *:80>
     ServerName www.example.com 
    ```

    变成

    ```
    <VirtualHost ServerName www.example.com 
    ```

    没有结束尖括号，Apache2 甚至无法加载。

4.  这种解析应该比一次性搜索和替换要慢，但是，正如您已经看到的，在一个解析周期内有四种不同的搜索模式有四个变量。

对于给定的问题假设，我能想到的最合适的解决方案。

* * *

## 回答 #7

> 赞同：29
> 
> 时间：2017-01-14T09:45:22.140

您可以使用`sed`：

```
sed -i 's/abc/XYZ/gi' /tmp/file.txt 
```

如果您不知道文件名`find`，您可以使用：`sed`

```
find ./ -type f -exec sed -i 's/abc/XYZ/gi' {} \; 
```

在所有 Python 文件中查找和替换：

```
find ./ -iname "*.py" -type f -exec sed -i 's/abc/XYZ/gi' {} \; 
```

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2015-07-27T19:08:59.727

如果用“/”字符替换 URL，请小心。

如何做到这一点的一个例子：

```
sed -i "s%http://domain.com%http://www.domain.com/folder/%g" "test.txt" 
```

摘自：[http ://www.sysadmit.com/2015/07/linux-remplazar-texto-en-archivos-con-sed.html](http://www.sysadmit.com/2015/07/linux-reemplazar-texto-en-archivos-con-sed.html)

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2017-04-15T02:09:16.660

如果您正在处理的文件不是那么大，并且将其临时存储在变量中没有问题，那么您可以一次对整个文件使用 Bash 字符串替换 - 无需逐行检查：

```
file_contents=$(</tmp/file.txt)
echo "${file_contents//abc/XYZ}" > /tmp/file.txt 
```

整个文件内容将被视为一个长字符串，包括换行符。

XYZ 可以是变量，例如`$replacement`，这里不使用 sed 的一个优点是您不必担心搜索或替换字符串可能包含 sed 模式分隔符（通常但不一定是 /）。一个缺点是不能使用正则表达式或 sed 的任何更复杂的操作。

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2009-06-14T16:37:52.863

您还可以使用该`ed`命令进行文件内搜索和替换：

```
# delete all lines matching foobar 
ed -s test.txt <<< $'g/foobar/d\nw' 
```

[在“通过脚本编辑文件`ed`](http://wiki.bash-hackers.org/howto/edit-ed?s[]=ed)”中查看更多信息。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2015-05-11T20:21:39.390

要以非交互方式编辑文件中的文本，您需要就地文本编辑器，例如 vim。

这是如何从命令行使用它的简单示例：

```
vim -esnc '%s/foo/bar/g|:wq' file.txt 
```

这相当于[前编辑器的](https://en.wikipedia.org/wiki/Ex_(text_editor))[@slim 答案](https://stackoverflow.com/a/525606/55075)，基本上是一样的。

这里有几个`ex`实际的例子。

将文件中的文本替换`foo`为`bar`：

```
ex -s +%s/foo/bar/ge -cwq file.txt 
```

删除多个文件的尾随空格：

```
ex +'bufdo!%s/\s\+$//e' -cxa *.txt 
```

故障排除（终端卡住时）：

*   添加`-V1`参数以显示详细消息。
*   强制退出：`-cwq!`。

也可以看看：

*   [如何以非交互方式编辑文件（例如在管道中）？](https://vi.stackexchange.com/q/788/467)在 Vi SE

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2016-05-31T23:55:34.583

尝试以下 shell 命令：

```
find ./  -type f -name "file*.txt" | xargs sed -i -e 's/abc/xyz/g' 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2016-05-03T18:44:19.903

您也可以在 bash 脚本中使用 python。我在这里的一些最重要的答案并没有取得太大的成功，并且发现它不需要循环就可以工作：

```
#!/bin/bash
python
filetosearch = '/home/ubuntu/ip_table.txt'
texttoreplace = 'tcp443'
texttoinsert = 'udp1194'

s = open(filetosearch).read()
s = s.replace(texttoreplace, texttoinsert)
f = open(filetosearch, 'w')
f.write(s)
f.close()
quit() 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2021-07-01T04:17:35.933

使用 sed 命令替换文件中多个文本的最简单方法

**命令 -**

**sed -i 's#a/b/c#D/E#g;s#/x/y/z#D:/X#g;' 文件名**

在上面的命令 s#a/b/c#D/E#g 中，我将 a/b/c 替换为 D/E，然后在 ; 我们再次做同样的事情

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-02-12T08:34:49.443

您可以使用 rpl 命令。例如，您想在整个 php 项目中更改域名。

```
rpl -ivRpd -x'.php' 'old.domain.name' 'new.domain.name' ./path_to_your_project_folder/ 
```

这不是明确的原因，但它非常快速且有用。:)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-11-25T20:11:18.103

对于 MAC 用户，以防您不阅读评论 :)

正如@Austin 所述，如果您收到`Invalid command code`错误消息

对于就地替换，`BSD sed`需要`-i`标志后的文件扩展名以保存到具有给定扩展名的备份文件。

`sed -i '.bak' 's/find/replace' /file.txt`

`''`如果要跳过备份，可以使用空字符串。

`sed -i '' 's/find/replace' /file.txt`

@Austin 的所有优点

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2022-02-02T14:13:41.373

如果一起对多个文件进行更改，我们可以在一行中执行以下操作：-

```
user_name='whoami'
for file in file1.txt file2.txt file3.txt; do sed -i -e 's/default_user/${user_name}/g' $file; done 
```

添加如果以防万一可能有用。

# sql-server - 客户端网络上的 C# 到 SQL Server

> ID：525600
> 
> 赞同：0
> 
> 时间：2009-02-08T12:06:39.047
> 
> 标签：sql-server, visual-studio-2008

我有一个客户，有一个已建立的会计数据库，我想为其编写报告。我打算使用 VS 2008。对于在我自己的机器上运行的 SQL Server 执行此操作没有任何困难，但想知道如何最好地发布 ac# 程序以在客户端的网络 SQL Server 上运行。所以有两个主要问题：1.）如何为远程环境调整连接字符串？2.) 为在他人网络上工作的新兴承包商推荐良好的远程协助方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T12:19:19.850

将连接字符串存储在配置文件中（Visual Studio 现在大部分时间都会为您执行此操作），并在您在客户端网络上部署应用程序时对其进行调整。

远程协助方法 - 查看 Microsoft SharedView，如果您想购买更高端的解决方案，请查看 LogMeIn Rescue。编辑 - 另外，请查看 TeamViewer (www.teamviewer.com)。

远程客户端的附加信息：

**SharedView** - [http://connect.microsoft.com/site/sitehome.aspx?SiteID=94](http://connect.microsoft.com/site/sitehome.aspx?SiteID=94) - 免费，需要 Windows Live ID，最多 15 人可以观看一个屏幕，您可以随时更换演示者。

**TeamViewer** - [http://www.teamviewer.com](http://www.teamviewer.com) - 免费（和/或付费版本） - 在“远程支持”、“演示者”、“文件传输”或“VPN”模式下启动。可以轻松地与伴侣换边。（警告 - 我在 Vista 中使用 UAC 命令提示时遇到了问题）。

**LogMeIn Rescue** - [http://www.logmein.com](http://www.logmein.com) - 付费产品（昂贵但非常好的专业客户支持工具）。单向（不能与客户改变立场）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T12:18:03.080

您可以使用这种连接字符串来连接客户端 SqlServer ：

```
Data Source=190.190.200.100,1433;Network Library=DBMSSOCN;Initial Catalog=myDataBase;User ID=myUsername;Password=myPassword; 
```

有关更多连接字符串[，请单击此处](http://www.connectionstrings.com/)。

我想你知道这一点，但我想提一下，你应该把它保存在你的 web.config 中。您可能需要将您的产品部署到客户端网络。那么配置您的应用程序将很容易。

希望这可以帮助 ！

# asp.net - ASP.NET 自定义配置条目/ConfigurationSections + 业务逻辑验证？

> ID：525601
> 
> 赞同：-1
> 
> 时间：2009-02-08T12:07:53.680
> 
> 标签：asp.net, configurationsection

我的 .config 文件中有一些自定义配置条目。所有负载/工作正常。我想知道是否有适当的方法来检查已提供的数据——添加一些业务逻辑。例如...

```
<logFileSettings>
    <logFile fileName="foo.log" uniqueName="log1">
        <alerts>
             -= snip =-
        </alerts>
    </logFile>
    <logFile fileName="bar.log" uniqueName="log2">
        <alerts>
             -= snip =-
        </alerts>
    </logFile>
</logFileSettings> 
```

现在，我想确保每个自定义部分的 uniqueName 都是唯一的。我是否需要在隐含 ConfigurationSection 的自定义类之外手动执行此操作，或者我可以在其中执行此操作吗？（例如，在读取配置文件或其他内容后，有点像委托？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-09-21T04:21:29.083

这听起来像是数据消费者的工作，而不是数据存储（在本例中为 web.config）。

可以从代码**中**读取/写入 web.config，但这几乎总是一个非常糟糕的主意（一方面，写入总是会重新启动 Web 应用程序，有时甚至读取也会重新启动）。我知道这不是您要问的，但我想指出这一点，因为我对不计后果地读/写 web 和 app.config 文件的人数感到震惊。

对于您在解析文件时是否引发事件的原始问题，我做了一些阅读并且找不到任何东西。但是，您可能可以修改 web.config 的 Visual Studio XML 架构，至少您会遇到设计时错误。

或者更重要的是，我建议将验证逻辑移至数据的消费者（看起来像一个日志记录类）。

# c++ - 将 C++ 与 Cocoa 一起使用而不是 Objective-C？

> ID：525609
> 
> 赞同：129
> 
> 时间：2009-02-08T12:18:24.967
> 
> 标签：c++, objective-c, cocoa, language-interoperability

我想编写使用 C++ 和 Cocoa 框架的应用程序，因为 Apple 不支持 Carbon 64 位。C++ 在 Linux 和 Windows 上的实现似乎相当普通，但在 Mac OS X 上，似乎需要额外的 Apple 特定代码（如 Obj-C 包装器）。Apple 似乎也在强迫开发人员使用 Objective-C 而不是 C++ 编写，尽管我可能是错的。

我正在尝试找到一种在 Mac 上编写代码的路径，该路径很容易保持跨平台。必须用 C++ 为 Linux/Windows 编写代码，然后用 Objective-C 重写大部分代码，效率非常低。

有没有一种方法可以用 C++ 编写将来支持并在 Xcode 中支持的代码？另外，如果这是可能的，我将如何在 Xcode 中混合 C++ 和 Objective-C？谢谢。

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2009-02-09T17:11:00.453

您不能完全用 C++ 编写 Cocoa 应用程序。Cocoa 的许多核心技术都严重依赖于 Objective-C 的后期绑定功能，例如键值绑定、委托（Cocoa 风格）和目标动作模式。后期绑定要求使得在编译时绑定的类型化语言（如 C++ⁱ）中实现 Cocoa API变得*非常困难。*当然，您可以编写一个在 OS X 上运行的纯 C++ 应用程序。它只是不能使用 Cocoa API。

因此，如果您想在其他平台上的 C++ 应用程序和基于 Cocoa 的应用程序之间共享代码，您有两种选择。首先是用C++写模型层，用Cocoa写GUI。这是一些非常大的应用程序使用的常用方法，包括[Mathematica](http://wolfram.com)。您的 C++ 代码可以保持不变（您不需要“时髦”的苹果扩展来在 OS X 上编写或编译 C++）。您的控制器层可能会使用 Objective-C++（也许是您所指的“时髦”Apple 扩展）。Objective-C++ 是 C++ 的超集，就像 Objective-C 是 C 的超集一样。在 Objective-C++ 中，您可以`[some-objc-object callMethod];`在 C++ 函数中进行 objc 样式的消息传递调用（如 ）。相反，您可以从 ObjC 代码中调用 C++ 函数，例如：

```
@interface MyClass {
    MyCPPClass *cppInstance;
}
@end

@implementation MyClass
- (id)init {
    if(self = [super init]) {
        cppInstance = new MyCPPClass();
    }
    return self;
}
- (void) dealloc {
    if(cppInstance != NULL) delete cppInstance;
    [super dealloc];
}
- (void)callCpp {
    cppInstance->SomeMethod();
}
@end 
```

[您可以在 Objective-C 语言指南](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/chapter_14_section_1.html#//apple_ref/doc/uid/TP30001163-CH10-SW1)中找到有关 Objective-C++ 的更多信息。视图层可以是纯Objective-C。

第二种选择是使用跨平台的 C++ 工具包。[Qt](http://qt.nokia.com/) _工具包可能符合要求。跨平台工具包通常受到 Mac 用户的鄙视，因为它们没有完全正确地获得所有外观和感觉细节，而 Mac 用户期望 Mac 应用程序的 UI 得到润色。然而，Qt 的表现出人意料地好，并且根据受众和应用程序的使用情况，它可能已经足够好了。此外，您将失去一些 OS X 特定的技术，例如 Core Animation 和一些 QuickTime 功能，尽管在 Qt API 中有近似的替代品。正如您所指出的，Carbon 不会被移植到 64 位。由于 Qt 是在 Carbon API 上实现的，因此 Trolltech/Nokia 不得不将 Qt 移植到 Cocoa API 以使其与 64 位兼容。我的理解是 Qt 的下一个版本（目前在[发布候选](http://qt.nokia.com/about/news/qt-4.5-release-candidate-available)) 完成了这个转换并且在 OS X 上是 64 位兼容的。如果你对集成 C++ 和 Cocoa API 感兴趣，你可能想看看 Qt 4.5 的源代码。

* * *

ⁱ 有一段时间，Apple 将 Cocoa API 提供给 Java，但该桥需要大量的手动调整，并且无法处理更高级的技术，例如上述键值绑定。目前，动态类型、运行时绑定的语言，如 Python、Ruby 等，是编写没有 Objective-C 的 Cocoa 应用程序的唯一真正选择（当然，这些桥在底层使用了 Objective-C）。

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2012-12-29T15:40:31.503

好吧，这听起来可能很傻，但实际上我们可以编写纯 C++ 代码来为 Mac OS X 创建 GUI，但我们必须链接到 Cocoa 框架。

```
/*
 * test1.cpp
 * This program shows how to access Cocoa GUI from pure C/C++
 * and build a truly functional GUI application (although very simple).
 * 
 * Compile using:
 *   g++ -framework Cocoa -o test1 test1.cpp
 *
 * that will output 'test1' binary.
 */

#include <CoreFoundation/CoreFoundation.h>
#include <objc/objc.h>
#include <objc/objc-runtime.h>
#include <iostream>

extern "C" int NSRunAlertPanel(CFStringRef strTitle, CFStringRef strMsg,
                               CFStringRef strButton1, CFStringRef strButton2, 
                               CFStringRef strButton3, ...);

int main(int argc, char** argv)
{
    id app = NULL;
    id pool = (id)objc_getClass("NSAutoreleasePool");
    if (!pool)
    {
        std::cerr << "Unable to get NSAutoreleasePool!\nAborting\n";
        return -1;
    }
    pool = objc_msgSend(pool, sel_registerName("alloc"));
    if (!pool)
    {
        std::cerr << "Unable to create NSAutoreleasePool...\nAborting...\n";
        return -1;
    }
    pool = objc_msgSend(pool, sel_registerName("init"));

    app = objc_msgSend((id)objc_getClass("NSApplication"),
                       sel_registerName("sharedApplication"));

    NSRunAlertPanel(CFSTR("Testing"),
                    CFSTR("This is a simple test to display NSAlertPanel."),
                    CFSTR("OK"), NULL, NULL);

    objc_msgSend(pool, sel_registerName("release"));
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-02-08T12:31:47.327

是的，您可以只使用 C++（即在 *.cpp 文件中编写它），甚至可以在 *.mm 文件中混合 C++ 和 Objective-C（标准的 Objective-C 代码存储在 *.m 文件中）。

当然，您仍然必须为您的用户界面使用 Objective-C 并为您的 C++ 对象创建 Objective-C 包装器。另一种选择是切换到[Qt](https://www.qt.io)，它是一个支持 Windows、Mac OS X 和 Linux 的 C++ 框架——将在 LGPL 下发布，下一个版本为 4.5。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-08T13:37:30.753

是的，你可以混合它们。

您需要使用 Objective-C 直接操作您的 GUI 对象并接收来自它们的通知。

如果将这些 Objective-C 对象放在 .mm 文件中，而不是纯粹的 Objective-C .m 文件，它们可以直接调用 C++ 逻辑。请注意，您可能会看到（很多）较旧的建议，建议使用大写的 .M 来表示 Objective-C++，但这非常不稳定，可能会使您和编译器感到困惑。

您不需要包装每个 C++ 对象，但您的 Objective-C 代码需要包含指向它们的指针。

Apple 不再发布任何展示如何执行此操作的示例。

在 Realm [[Objective] C++：什么可能出错？](https://academy.realm.io/posts/altconf-peter-steinberger-objective-c++-what-could-possibly-go-wrong/)我强烈推荐给仍在使用 Objective-C++ 的任何人，您可以快速浏览成绩单。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-08T18:24:57.363

如果您只是想使用普通的 C++，这是绝对支持的，并且与任何其他平台没有什么不同。Xcode 甚至在 File > New Project > Command Line Utility > C++ Tool 下都有一个模板。此外，许多流行的开源库（libcurl、libxml2、sqlite 等）随 OS X 一起提供，可用于动态链接。如果您不想使用，则不必使用 Cocoa 或任何特定于 Apple 的东西。

如果您确实想在应用程序的某些部分使用 Cocoa，请查看[Objective-C++](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/chapter_14_section_1.html)。您可以在同一个文件中混合 C++ 和 Objective-C，方法是给它一个 .mm 的扩展名，或者在 Xcode 中右键单击该文件并选择 Get Info > General，然后将文件类型更改为 sourcecode.cpp.objcpp。如果您有一个 .cpp 文件，并且您想在 Mac 特定的 #ifdef 中使用 Objective-C，则第二个选项很有用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-11-02T17:59:11.610

虽然这是多年前的问题......

我[试图制作一些 Cocoa 类的 C++ 包装器](https://github.com/Eonil/CocoaPlusPlus)。

这是相当不错的经历。C++ 提供了比 Objective-C 更好的类型安全性，并且让我编写的代码更少。但是编译时间和内存安全性更差。这是可能的，但一些基于动态的功能不容易处理。我认为在 C++ 上处理它没有意义。

无论如何，由于 Swift 的发布，我的项目最终被放弃了。它清除了我最初想使用 C++ 的所有原因，并提供了更多更好的功能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-01T04:37:04.217

如果您正在编写一个纯图形应用程序，即您正在使用代码绘制所有内容，请考虑使用[openFrameworks](http://www.openframeworks.cc/)。它是一种建立在 C/C++ 之上的开源图形编程语言。它有允许人们扩展语言的[插件。](http://www.openframeworks.cc/addons)他们有[一个用于 iphone 的插件](http://code.google.com/p/ofxiphone/)。我相信它附带的库和 XCode 项目将帮助您为 iPhone 和 iPod touch 编译应用程序。

# sql - 如何从 SQL Server 中删除图表支持对象？

> ID：525610
> 
> 赞同：23
> 
> 时间：2009-02-08T12:18:28.570
> 
> 标签：sql, sql-server, sql-server-2005, sql-server-2008, diagram

我需要使用 TSQL 脚本从 SQL Server 中删除图表支持表、存储过程、视图等。

有没有这样的脚本可用？

SQL 2005 和 2008。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2011-05-27T00:40:00.263

```
DROP PROCEDURE dbo.sp_alterdiagram;  
DROP PROCEDURE dbo.sp_creatediagram;  
DROP PROCEDURE dbo.sp_dropdiagram; 
DROP PROCEDURE dbo.sp_helpdiagramdefinition; 
DROP PROCEDURE dbo.sp_renamediagram; 
DROP PROCEDURE dbo.sp_upgraddiagrams; 
DROP PROCEDURE dbo.sp_helpdiagrams;
DROP FUNCTION dbo.fn_diagramobjects;
DROP TABLE dbo.sysdiagrams; 
```

这将删除所有这些。如果有像添加这样的删除图表引用向导会很好。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-08T12:31:16.923

您可以删除对象，但是当用户单击图表节点时，系统会提示用户重新创建它们。

对象：

*   sp_upgraddiagrams
*   sp_helpdiagrams
*   sp_helpdiagram 定义
*   sp_creatediagram
*   sp_renamediagram
*   sp_alterdiagram
*   sp_dropdiagram
*   fn_diagramobjects
*   系统图
*   dt_properties (?)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-08T11:37:48.683

```
DELETE FROM sysdiagrams -- remove all diagram
DELETE FROM sysdiagrams WHERE name = 'yourDiagram' -- remove with condition 
```

# ruby-on-rails - Rails 迁移如何强制关系？

> ID：525615
> 
> 赞同：3
> 
> 时间：2009-02-08T12:24:29.010
> 
> 标签：ruby-on-rails, database-design, web-applications, migration

当你运行时：

```
rake db:migrate 
```

正在处理的唯一文件是 db/migrate/ 中的文件，对吗？

好吧，既然在 app/models/ 中定义了诸如一对一、一对多和多对多之类的关系，那么 Rails 是如何执行这种关系的呢？在我进行迁移并查看生成的数据库模式后，我看不到任何外键约束。所以我很困惑这一切是如何运作的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-08T12:27:27.883

很简单，它没有。

这是由于必须支持多个数据库。有些，例如 sqlite，不支持外键。

要添加外键，您必须为它们执行原始 SQL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T13:47:30.297

正如其他人所说，Rails 根本没有真正使用 SQL 关系，而只是在代码中模仿它。它实际上并没有强制执行参照完整性，而是让它看起来确实如此。

有一个小流派认为，出于这个原因，您不应该**使用**迁移，而是使用原始 DDL 创建和保护您的数据库，因为 Rails 哲学存在缺陷，它仍然让您的数据模型完全开放，同时提供一些安全措施（一个由激光保护的开放式保险箱，我喜欢这样说）。显然，您失去了迁移的好处（我想您也可以保留迁移并手动添加执行语句）。请参阅Dan Chak所著的*Enterprise Rails一书；*他有几章讨论这个问题并展示了他的想法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-08T13:02:37.967

Garry 是对的，约束是由应用程序本身强制执行的。但是，如果您真的希望设置外键，该[`foreign_key_migrations`](http://github.com/harukizaemon/foreign_key_migrations/tree/master)插件可以为您提供很好的服务。

# django - Django 链接模型 - 管理员中的可用字段

> ID：525616
> 
> 赞同：0
> 
> 时间：2009-02-08T12:26:05.060
> 
> 标签：django, models

我正在为朋友的艺术展览建立一个网站。我目前定义了一个名为 Participant 的模型，每个参与者也应该能够登录到系统，所以当创建 Participant 时也会创建一个新用户。

现在在编辑或创建新参与者时，我希望能够显示用户的某些字段，例如电子邮件地址。这样使用管理员的人只需编辑参与者，链接的用户就会被更新。

我的问题是在管理员中显示这些字段。我尝试将电子邮件添加为 Participant 模型的属性，从相关用户中查找其值，但这些未显示在 Admin 中。我还尝试为这个模型定义我自己的管理表单，但是我无法预先填充它，因为它只适用于字段。

到目前为止，从我的谷歌搜索来看，在当前版本中似乎无法预填充管理表单，使用字段等属性似乎也不起作用，或者至少不是我想要的方式。

谁能指出我正确的方向？

大卫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T12:30:52.150

检查这个：

[内联模型管理员](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#inlinemodeladmin-objects)

# mysql - 具有大量连接的 Web 服务

> ID：525618
> 
> 赞同：3
> 
> 时间：2009-02-08T12:26:58.227
> 
> 标签：mysql, web-services

我正在计划开发一个必须非常可扩展的 Web 服务，以便处理许多并发连接，可能是数千个。该服务将充当 API。它必须是高度响应的，请求和回复之间 3 秒的延迟被认为太多了。

也许服务可以分布在许多内部服务器之间，负载平衡网关充当流管理，因此服务所做的实际处理不会占用网关服务器。我正在考虑使用 Amazon EC2，但我也可以使用一系列内部服务器，只要我能找到它们的好用处。数据库可能是 MySQL（除非您有更好的主意）。

我意识到最好的解决方案是开发自己的 Web 服务器，但我会花费太多时间，而且我怀疑我是否能比其他一些我不知道的 Web 服务器做得更好。

另外，我目前正在尝试在持久连接之间做出决定，但我可能会坚持后者。

那么，对于一个好的、可扩展的解决方案有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-08T12:36:47.397

我不同意开发自己的 Web 服务器是“最好的解决方案”。使用一个存在的。您不应该仅仅为了部署 Web 服务而编写服务器。

.NET 和 Java EE 都提供了创建和部署 Web 服务的方法。您不会说您选择哪种语言，但您当然可以在 Java EE 中编写 Web 服务并将其部署在 Tomcat 上，而无需编写自定义 Web 服务器。

就负载平衡而言，如果您负担得起， [F5是一个很好的硬件解决方案。](https://www.f5.com/ppc/load-balancing-whitepaper.php?sc=279923&gclid=CIa5oID4zJgCFQxKGgodWTf_1A)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-08T12:45:25.850

你没有提到协议。如果您使用 RESTful 方法，那么这是一段非常容易编写的代码。如果您使用 SOAP 方法，这将更加复杂。

Apache + FastCGI 将执行此操作，但您的服务将是 CGI 程序。您必须使用 C 或 C++ 编写，这可能会令人不快。您可以使用 Apache + mod_wsgi 加上 Python 框架之一；它没有那么快，但它会非常快，而且您不必编写太多代码。

Glassfish 将执行此操作，您可以使用 Java 编写代码。

商业产品（如 Sun 的 JCAPS）可以做到这一点。

有许多 Web 服务框架——发明你自己的不是一个好主意。

**编辑** “MaxClients”问题。

Web 服务请求应该很快——它是一种资源——你从缓存或数据库中获取它并做出响应。限制因素不是 MaxClients——它是可以成功共存的线程，它是套接字协商。

如果您的 GET 请求是幂等的，它们可以缓存在 squid（或其他一些反向代理服务器）中。您可以拥有大量这些。*请注意，使用反向代理服务器与您的 Web 服务本身*无关；然而，它与整体吞吐量有关。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-08T16:09:11.727

Amazon EC2 运行良好，但不要将您的定价基于 0.10 美元的实例——它们的功能非常不足。我建议至少从 c1.mediums 开始。我喜欢在 m1.small 的 c1.medium Web 服务器实例前面使用 nginx 实例作为负载平衡（我最近构建的所有应用程序都是 CPU 绑定的，而不是内存绑定的）。

3秒是很长的时间。我通常将 200ms-400ms 用于性能目标。当然，这取决于您的应用程序对时间的敏感程度以及必须完成的工作量。

如果真的有 3 秒的工作要做，你可能有一个后端网格预处理数据。然后您可能需要更少的 Web 服务器，因为它们主要返回预制数据。

如果我站在你的立场上，我会用我最熟悉的任何语言/平台构建一个原型。然后你就可以知道你需要把它带到哪里去。

不要忘记构建高性能 Web 应用程序需要时间。您需要编码、基准测试、重复以扩展并缩短响应时间。

您需要编写自己的网络服务器的实例数量非常少。这不是其中的一个。有很多可供选择。假设一个基于 nix 的平台，您可以使用 Apache、nginx 或 lighttpd。还有很多其他的，但它们通常用作应用服务器（tomcat、zope、mongrel 等）并在它们前面有 apache/nginx/lighttpd/squid 代理。

我还没有真正使用现成的平台（解决方案）来构建 Web 应用程序（我假设您的意思是某种 java 堆栈或 .Net 堆栈）。我真的帮不了你。我使用的大多数工具（LAMP 类型的东西）都是组件化的，并且允许在堆栈的每一部分进行替换。超出一个组件并不得不用另一个替换它的情况并不少见。

例如，无负载均衡器 -> 软件负载均衡器 -> 能够缓冲的软件负载均衡器 -> 硬件负载均衡器。所有这些对于不同规模的规模都具有成本效益。

# c++ - 在 C++ 中读入数组

> ID：525625
> 
> 赞同：0
> 
> 时间：2009-02-08T12:32:06.673
> 
> 标签：c++, arrays, file-io

我正在为比赛练习（这就是[我上一个问题](https://stackoverflow.com/questions/502443/prime-numbers)的来源）。我为这个问题整理了算法，但我在实际编程中遇到了一些问题。这是一场个人比赛，所以我真的需要在参加比赛之前解决这个问题。这就是问题。

> **任务 3：壁虎**在雨季，房子里的一堵墙上到处都是蚊子。墙由 h×w 方砖覆盖，从上到下有 h 行方砖，从左到右有 w 列方砖。每块瓷砖上都有 1 到 1000 只蚊子。壁虎想吃尽可能多的蚊子，但要遵守以下限制。它首先选择顶行中的任何瓷砖，然后吃掉该瓷砖中的蚊子。然后，它移动到下一行的一块瓷砖上，吃掉瓷砖上的蚊子，依此类推，直到它到达地板。当它从一个瓦片移动到下一行的瓦片时，它只能垂直向下或沿对角线向左或向右移动（见图 1）。给定 h 和 w 的值，以及每块瓷砖上的蚊子数量，
> 
> 示例输入文件将是：
> 示例
> 
> 6 5
> 3 1 7 4 2
> 2 1 3 1 1
> 1 2 1 1 8
> 2 2 1 5 3
> 2 1 4 4 4
> 5 7 2 5 1

我遇到的问题是阅读数字（或问题列表的顶部）。我目前的阅读代码是：

```
ifstream read;
read.open("input.txt");
write.open("output.txt");
int width, height, wall[500][500];
read >> height;
read >> width;
for ( int count1 = 0; count1 < height; count1++)
{
   for ( int count2 = 0; count2 < width; count2++)
      { 
         read >> wall[count1][count2];
       }
} 
```

当我用 a 测试它`cout`以打印所有读入的数字时，我得到的只是乱码。现在我无法发现任何错误，任何人都可以看到问题吗？谢谢。（固定）再次感谢。

我测试了读入，现在很完美。但是，我得到的苍蝇数量仍然不足。例如输入
1 1
23
应该给出输出 23，但我得到 0 作为输出。这是我的代码：

```
int h = 0, w = 0, compare1, compare2, compare3, currentInt;
for ( int count3=( height-2 ); count3 >= 0; count3--)
{  
   for( int count4 = 0; count4 < width; count4++)
     {
     h = count3;
     w = count4;
      currentInt = wall[h][w];   // read in affected integers.
      if( w != 0 )
       { compare1 = wall[h+1][w-1];
       }
       compare2 = wall[h+1][w];
       compare3 = wall[h+1][w+1]; 
       if( w!= 0)                     // Compare and replace. 
       {  
          if((( currentInt + compare1) >=(currentInt + compare2)) && ((currentInt + compare1)>=(currentInt + compare3)))
          { 
             wall[h][w] = ( currentInt+compare1);
          }
          if((( currentInt + compare2) >(currentInt + compare1)) && ((currentInt + compare2)>(currentInt + compare3)))
          { 
             wall[h][w] = ( currentInt+compare2);
          }
          if((( currentInt + compare3) >=(currentInt + compare2)) && ((currentInt + compare1)>(currentInt + compare1)))
          { 
             wall[h][w] = ( currentInt + compare3);
          }
       }
       else
       { 
          if ((currentInt + compare2) >= ( currentInt + compare3))
          {
             wall[h][w] = ( currentInt + compare2);
          }
          else
          {
             wall[h][w] = ( currentInt + compare3);
          }
       }
      }
}
int maxFlies=0;
for (int count5 = 1; count5 < width;count5++)
   {
   maxFlies = wall[0][0] ;
   if ( maxFlies < wall[0][count5])
   { maxFlies = wall[0][count5] ; }
   }
write<<maxFlies<<endl;
read.close();
write.close();
return 0; 
```

我要做的基本上是：从倒数第二行读入。将它与它可以在下面到达的唯一块一起添加。然后向上移动，最后测试最上面一行的哪一个是最大的整数。感谢您的快速回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T12:42:58.380

在 C++ 中，二维数组不作为 Array[alpha,beta] 访问。

**它以 Arrayαβ 的形式完成。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T06:34:13.233

你的循环开始于

```
for ( int count3=( height-2 ); count3 >= 0; count3--)
{  
    ....
} 
```

如果您的输入是 1x1 数组，则 (height-2) == -1 因此循环将永远不会执行（因为条件 (count3 >= 0) 永远不会为真。

# python - 正则表达式：匹配开始或空格

> ID：525635
> 
> 赞同：81
> 
> 时间：2009-02-08T12:38:08.797
> 
> 标签：python, regex

**正则表达式可以匹配空格*或*字符串的开头吗？**

我正在尝试用 £ 符号替换货币缩写 GBP。我可以匹配任何以 GBP 开头的东西，但我想更保守一点，并在它周围寻找某些定界符。

```
>>> import re
>>> text = u'GBP 5 Off when you spend GBP75.00'

>>> re.sub(ur'GBP([\W\d])', ur'£\g<1>', text) # matches GBP with any prefix
u'\xa3 5 Off when you spend \xa375.00'

>>> re.sub(ur'^GBP([\W\d])', ur'£\g<1>', text) # matches at start only
u'\xa3 5 Off when you spend GBP75.00'

>>> re.sub(ur'(\W)GBP([\W\d])', ur'\g<1>£\g<2>', text) # matches whitespace prefix only
u'GBP 5 Off when you spend \xa375.00' 
```

我可以同时做后两个例子吗？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-02-08T12:46:54.427

使用 OR " `|`" 运算符：

```
>>> re.sub(r'(^|\W)GBP([\W\d])', u'\g<1>£\g<2>', text)
u'\xa3 5 Off when you spend \xa375.00' 
```

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2009-02-08T12:42:22.393

`\b`是单词边界，可以是空格、行首或非字母数字符号 ( `\bGBP\b`)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-08T12:46:39.373

如果它前面是字符串的开头或[单词边界](http://www.regular-expressions.info/wordboundaries.html)（字符串的开头已经是），这将替换 GBP，并且在 GBP 之后是数值或单词边界：

```
re.sub(u'\bGBP(?=\b|\d)', u'£', text) 
```

[这通过使用前瞻](http://www.regular-expressions.info/lookaround.html)消除了对任何不必要的反向引用的需要。足够包容吗？

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-04-20T20:47:54.383

左侧空白边界 - 字符串中的位置，可以是字符串开头或空白字符之后的右侧 - 可以表示为

```
(?<!\S)   # A negative lookbehind requiring no non-whitespace char immediately to the left of the current position
(?<=\s|^) # A positive lookbehind requiring a whitespace or start of string immediately to the left of the current position
(?:\s|^)  # A non-capturing group matching either a whitespace or start of string 
(\s|^)    # A capturing group matching either a whitespace or start of string 
```

查看[正则表达式演示](https://regex101.com/r/9TNlEp/1)。[Python 3 演示](https://ideone.com/7vInLS)：

```
import re
rx = r'(?<!\S)GBP([\W\d])'
text = 'GBP 5 Off when you spend GBP75.00'
print( re.sub(rx, r'£\1', text) )
# => £ 5 Off when you spend £75.00 
```

请注意，您可以在替换模式中使用`\1`而不是，`\g<1>`因为当后面没有数字时，不需要明确的反向引用。

奖励：右侧空白边界可以用以下模式表示：

```
(?!\S)   # A negative lookahead requiring no non-whitespace char immediately to the right of the current position
(?=\s|$) # A positive lookahead requiring a whitespace or end of string immediately to the right of the current position
(?:\s|$)  # A non-capturing group matching either a whitespace or end of string 
(\s|$)    # A capturing group matching either a whitespace or end of string 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-08T12:47:27.780

我想你正在寻找`'(^|\W)GBP([\W\d])'`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-08T12:43:25.777

是的，为什么不？

```
re.sub(u'^\W*GBP... 
```

匹配字符串的开头，0 个或多个空格，然后是 GBP...

*编辑*：哦，我想你想要交替，使用`|`：

```
re.sub(u'(^|\W)GBP... 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-08T12:44:29.843

如果不是需要整行的匹配/分组情况，您始终可以在搜索之前从令牌中修剪前导和尾随空格。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-08T13:10:56.360

它在 Perl 中工作：

```
$text = 'GBP 5 off when you spend GBP75';
$text =~ s/(\W|^)GBP([\W\d])/$1\$$2/g;
printf "$text\n"; 
```

输出是：

```
$ 5 off when you spend $75 
```

请注意，我规定匹配应该是全局的，以获取所有匹配项。

# sql-server - SQL Server 中使用镜像、日志传送、复制和集群的场景有哪些

> ID：525637
> 
> 赞同：24
> 
> 时间：2009-02-08T12:39:35.580
> 
> 标签：sql-server, replication, cluster-computing, mirroring

据我所知，SQL Server 提供了 4 种技术来提高可用性。

我认为这些是主要的使用场景，总而言之：-

1）复制将主要适用于在线离线数据同步场景（笔记本电脑、移动设备、远程服务器）。

2) 日志传送可用于具有手动切换的故障转移服务器，而

3) 数据库镜像是一种自动故障转移技术

4) Failover Clustering 是一种高级的数据库镜像。

我对吗 ？

谢谢。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-08T16:56:06.187

故障转移群集是一种在硬件级别提供冗余的可用性技术，它建立在 Windows 群集技术之上，即它并不特定于 SQL Server。

例如，服务器 A 上的处理器发生故障。幸运的是，服务器 A 是 SQL Server 群集的一部分，因此服务器 B 在几秒钟内就接管了提供 SQL Server 服务的工作。所有这些都是自动发生的，并且对集群服务的数据库用户和/或应用程序是透明的。

数据库镜像和集群之间的主要区别在于 SQL 集群在实例级别提供冗余，而数据库镜像在数据库级别提供冗余。

以下链接提供了您可能会发现使用的这两种技术之间的比较。

[http://msdn.microsoft.com/en-us/library/ms191309(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms191309(SQL.90).aspx)

日志传送更多地被认为是一种冗余技术。

例如，它可用于提供主环境的完整副本，通常用作可以手动联机的热备用。这可用于为您的备份策略提供额外的冗余。通过在备用位置/服务器上创建生产数据库的只读副本，日志传送还可用于从主服务器卸载报告。

复制是一种非常多样化的技术，可用于满足许多不同的场景，其中的选择将决定所实现的特定复制类型。

例如，合并复制可用于通过将应用程序的工作负载分散到多个服务器（即分布式处理架构）来支持分布式处理。

合并复制通常需要一个相对了解其环境的应用程序。还必须考虑冲突解决等技术，以确保整个集成环境中的数据一致性。

事务复制可以以与日志传送类似的方式使用，但是您可以限制复制到订阅者的特定对象。如果报告目的只需要表格的一个子集，这将很有用。

我希望这可以为您解决一些问题。您可以在 SQL Server 在线书籍中找到有关每种技术的大量文档，或者在 Google 中搜索每种技术。也就是说，如果您有任何具体疑问，我很乐意为您提供帮助，因此请随时联系我。

干杯，约翰

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T12:53:43.133

在 SQL 2008 Enterprise 中，还有一个叫做变更数据捕获 (CDC) 的东西，我们在我工作的地方成功使用了它。

我们有一个过度规范化的数据库，这使得获取信息变得太难了。我们需要在将这些数据复制到另一台服务器以获取报告等的同时更改数据结构。

它对我们非常有效。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-02-08T13:34:39.433

相反，AFAIK 日志传送和复制可能更适合。

日志传送是计划同步，因此复制更适合手动切换，因为备份服务器将尽可能保持最新，除非您有任何通信问题（但是，日志传送也会有同样的问题）。

离线数据不像备份服务器那样对延迟敏感，但我个人认为根本不需要日志传送，我看不出它何时会成为复制的更合适的替代方案（但可能是在 sql2005 之前没有实现复制）

也许我将复制与镜像混淆了，并且作为说明，镜像不会为您提供自动故障转移，只有 HA-cluster 为您提供该功能，这意味着：

至少使用 SQL Server 2005 标准、Windows Enterprise 和共享数据存储（如 SAN）。

# .net - 允许用户定义表顺序的最佳方法？

> ID：525652
> 
> 赞同：1
> 
> 时间：2009-02-08T12:48:27.527
> 
> 标签：.net, sql, sql-server, vb.net, devexpress

允许用户定义表顺序的最佳方法？

我们正在使用 SQL Server 2005 和 DevExpress 控件。

我们有一个包含以下内容的表：

1.  过程A
2.  工艺 B
3.  过程 C
4.  报告 A
5.  报告 B
6.  报告 C

我们希望允许用户将订单更改为他们想要的任何东西。

这是一个例子：

1.  过程 C
2.  过程A
3.  工艺 B
4.  报告 B
5.  报告 A
6.  报告 C

为了适应这一点，我们在由我们的应用程序维护的表中添加了一个 DisplayOrder (INT) 字段。

使用 INT 字段是用户定义订单的最佳解决方案吗？

有没有其他方法可以做到这一点？

我要问的原因是，在我们当前的应用程序中，向下（或向上）移动一行大约需要 1 秒。我即将破解代码，看看为什么要花这么长时间，如果你 Stack Overflow 大师有什么好主意，我可能会在那个时候实现它们。

如果您好奇，我认为我们的应用程序允许编辑 DisplayOrder：

1.  将表格加载到 GridView
2.  选择一行
3.  单击“下移”按钮（还有一个“上移”按钮）
4.  Click 事件会将当前行的 DisplayOrder 与其下方的行交换。
5.  对两条记录的更改都写回数据库
6.  每次点击大约需要 1 秒（即 10 次点击等于 10 秒）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T12:56:57.323

因为每次点击都在更新数据库，每次交换是否需要 1 秒？也许甚至再次重新选择数据？

为什么不选择数据到本地对象。绑定到网格中的那些对象。当您上下移动对象时，调整它们的显示顺序属性。然后只更新数据库

1.  当用户最终点击保存时。
2.  如果对象的任何值发生了变化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T13:12:09.603

我会将保存决定移动到一个明确的保存按钮中以进行重新排序，因为用户可能会改变主意，正如彼得莫里斯所建议的那样，这将解决您的性能问题。

需要考虑的其他事项 - 显式移动到顶部和移动到底部项目。

我在企业系统中使用这种方法实现了一个非常成功的 UI，用于用户驱动的可搜索项目和报告项目的选择。UI 的更多细节[可供您查看](http://www.oofile.com.au/adsother/SearchAndReport.html)（请记住，它大约有 15 年的历史 - 回到平坦的单声道时代！）。许多用户测试的一个关键改进 - 保存此订单的最佳点不是每个用户或每个公司，而是每个组。小组是一起工作的人，他们有相同的起始页面（在大规模连接的图中基本上是相同的根）。我们在组织中有大约 7 个独特的小组。

因此，如果您采用按用户或按组的方法，则需要将排序数据提取到一个单独的表中，该表将数据键映射到序数整数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T16:04:46.230

如果您在谈论用户想要设置和保留的显示顺序，则需要在一个单独的表中，其中包含用户 ID 和他或她想要查看的记录的 ID 以及显示顺序列。然后将数据获取到该页面的查询将使用用户首选项表的连接。

如果您只想暂时设置人们正在看屏幕的时间顺序，请通过用户界面进行。

无论如何，不​​要对基表中的记录重新排序，这是一个糟糕的选择，因为您将遇到用户 a 想要一个设置而用户 b 同时试图更改为不同设置的竞争条件。

# java - 有谁知道如何成功集成 Seam 和 Spring MVC？

> ID：525655
> 
> 赞同：0
> 
> 时间：2009-02-08T12:51:17.757
> 
> 标签：java, spring-mvc, seam

正如标题所说。有没有办法将两者结合起来？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-08T13:00:43.743

我敢肯定，如果你对两者都很熟练，这是可能的，但我和所有 Seam 开发人员的问题是“为什么？”

Seam 结合了 JSF 和 Hibernate。春天适合哪里？Seam 堆栈没有为您提供什么？

我没做过。我使用 Spring 和 Hibernate，但不使用 Seam。据我所知，这是一个仅限 JBOSS 的解决方案。

您当然可以同时使用 Spring、Hibernate 和 JSF。您只是不能使用任何特定于 Seam 的代码。如果您选择采用这种方式，您可以将代码部署在任何 Java EE 应用服务器上，包括 JBOSS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T23:45:21.140

Seam 的重点在于它是一个结合了 JSF 和 Hibernate 的封闭（-ish）技术栈。我说“关闭”是因为它以这种方式开始但不再严格正确。例如，您可以在不是 JBoss 的应用服务器上运行它并使用不同的 JPA 提供程序。话虽如此，它主要用于 JBoss+JSF+Hibernate。

至于如何将它与 Spring MVC 集成，那并没有多大意义。如果你真的想要，为什么不直接使用 Spring MVC + Hibernate + JSF（我不是 JSF 的忠实粉丝，但每个人都喜欢）。

# c# - 在有线数据模型上公开您的核心

> ID：525656
> 
> 赞同：1
> 
> 时间：2009-02-08T12:52:45.913
> 
> 标签：c#, model

我有一个 C# 客户端和一个 java 服务器。我有来回传输的数据对象。让我们称它们为 FooData.cs，其中一切都只是一个 get 和一个 set（没有逻辑）

```
FooData data = new FooData();
data.Price = 10;
data.Quantity = 20; 
```

我有其他派生字段，我想在应用程序中使用，但不需要通过网络发送，所以我有另一个类

FooWrapper.cs。

我将数据对象注入到包装器中

```
FooWrapper wrapper = new FooWrapper(Foodata);
wrapper.Price = 10;
wrapper.Quantity = 20;
double total  = wrapper.GetTotal(); 
```

并且包装器具有许多与数据对象相同的属性（我们只是向下委托），或者包装器也具有许多计算属性。包装器的唯一状态是数据对象（没有其他成员变量）

我们就使用此模型与使用转换器进行了辩论。转换器的方式是使用 FooBusinessObject 代替 FooWrapper，而不是注入“在线”对象，我们调用一个转换方法，将所有数据从在线对象传递到业务对象。

```
FooData data = new FooData();
FooBusinessObject busObj = new FooBusinessObject();
busObj.Price = data.Price;
busObj.Quant= data.Quantity;
double total  = busObj.GetTotal(); 
```

关于更好的任何想法（包装器与业务对象/转换器）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T13:04:23.517

编写问题的方式，我能看到的唯一真正区别是您是通过构造函数传递 fooData 实例还是调用构造它的单独方法，但在第一个方法中隐含的是 Wrapper 对象保留对原始对象，而在第二种方法中，在我看来，您似乎避免了这种联系。

I think the underlying issue is really if you want to keep a reference to the original object. This *may* sometimes be relevant if the original object contains state that you will not be exposing to your application but *could* be necessary to perform updates.

If this is not the case then I would try to hide the wire-level objects away from your business logic. Part of the intention of wrapping is to protect your code from the details of the wire-level stuff, and the further up in the stack you let these things seep, the greater the chance they'll be used where not intended, increasing unintentional coupling.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T13:26:00.493

(edit) What version of C# are you using? With C# 3.0 you could place the "logic" bits (calculations etc) in extension methods in a busines logic assembly, but still see them via the DTO - i.e.

(data layer)

```
public class Foo {
    public int Bar {get;set;}
} 
```

(business layer)

```
static class FooExt {
    public static int Blop(this Foo foo) {return 2 * foo.bar;}
} 
```

(ui layer)

```
Foo foo = ...
int blop = foo.Blop(); 
```

* * *

What model are you using to transfer the data? web services? xml? data-contracts? binary? Most would allow you to ignore the extra properties without any extra code (i.e. no need for a wrapper/facade object):

`XmlSerializer`:

```
[Serializable]
public class MyData {
    public int Foo {get;set;} // is sent
    [XmlIgnore]
    public int Bar {get {...} set {...}} // is ignored
} 
```

`DataContractSerializer`:

```
[DataContract]
class MyData {
    [DataMember]
    public int Foo {get;set;} // is sent
    public int Bar {get {...} set {...}} // is ignored
} 
```

If you are talking binary, there are portable java/C#-friendly models such as "[protocol buffers](http://code.google.com/p/protobuf/)" - Jon Skeet has a [C# port](http://github.com/jskeet/dotnet-protobufs/tree/master) of the official java version (allowing you to use very similar code on both sides) - or I have a more C#-idiomatic version ([protobuf-net](http://code.google.com/p/protobuf-net/)):

`ProtoSerializer`:

```
[ProtoContract]
class MyData {
    [ProtoMember(1)]
    public int Foo {get;set;} // is sent
    public int Bar {get {...} set {...}} // is ignored
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T15:00:28.587

Rather than thinking in terms of objects that go back and forth, could you think instead of the business events that one side needs to notify the other and the minimum amount of data required to describe each one?

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-06T05:27:26.663

I'd tend to use the wire object to build the other one, and not wrap it. "How the data is transferred" and "how the object is stored in memory" are two different concerns, and not mixing them is a generally good idea. At some point, you may use a different 'wire' technology not compatible with your existing wire objects, and if that happens, I'd rather modify a converter class than my core business logic.

This also gives you the flexibility to modify your wire objects to contain more/less/different data without having to impact your core business functionality. An all-around win, in my book.

# testing - 测试人员做什么？

> ID：525658
> 
> 赞同：8
> 
> 时间：2009-02-08T12:56:51.613
> 
> 标签：testing

我在一家公司工作，开发人员 QA 对其他开发人员的工作进行检查，例如遵守编码标准到它是否有效。

现在这对我们来说似乎工作得非常好，但我不禁感到我们正在将开发时间浪费在专门的测试人员或测试人员可以做的事情上。

问题是我一直在这家公司工作，所以我从来没有和测试人员一起工作过，所以除了“他们做测试”这一英里高的观点之外，我不知道他们在开发团队中有什么功能。

我们还倾向于雇用研究生水平的人，因此必须有人在一段时间内指导他们完成所有任务。

总之，测试人员在您的公司内做什么以及他们如何适应您的开发和发布流程？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-08T13:05:47.383

他们的工作简单明了。打破应用程序。你总是知道你什么时候有一个好的测试人员，因为当那个人来到你的办公桌/立方体周围时，你总是有点生气。这样做的原因是您知道如果测试人员在您附近，他们会发现您所写的内容有问题。所有的借口开始堆积在你的脑海中，“好吧，你没有正确使用它！”等等，但最终，你知道测试人员是对的，而你只是在编程中犯了一个错误.

优秀的测试人员可以*发现*错误。他们可以像用户一样思考，验证业务规则等，但是当他们以不寻常的模式点击以强制您的应用程序中断时，他们也会像用户一样行事。看起来他们在滥用应用程序并以不应该使用的方式使用它，但这是他们的工作，这就是他们作为测试人员获得报酬的原因。

您知道当他们找不到任何错误时需要更换您的测试仪。相信我，在任何复杂的系统中，总会有问题发生，而测试人员的工作就是找出问题所在 *。*

话虽如此，使用专门的测试人员至关重要，尤其是在处理任何具有大量 UI 组件的应用程序时。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-08T13:32:09.687

继[大卫的回答](https://stackoverflow.com/questions/525658/what-do-testers-do/525673#525673)之后，一个好的测试人员值得他或她的黄金重量 - 好的合同测试人员可能非常昂贵。

几年前，我与一位出色的测试人员一起工作。当时我是技术主管，他是我生命中的祸根，但他的价值是无法估量的。

他非常有条理，而且非常聪明。他根据有限的需求和功能文档编写了自己的测试计划。大多数情况下，他运行应用程序，并根据他对业务的理解，计算出它应该做什么，以及它的不足之处。

他对细节的关注简直太棒了。他报告的所有内容都是完全可重复的、记录在案的，并且不仅带有错误报告，而且还带有替代行为的建议。当然，这非常有用，因为并非所有错误都会导致应用程序崩溃。

他也足够灵活，可以识别出哪些事情是高优先级的，并且（暂时！）停止为我们没有时间做的事情而烦扰我们。

所以我们得到了 UI 反馈、错误报告，甚至是关于需求被误解的地方的建议。

他用他发现的东西努力工作，但我们对我们的共同目标有强烈的认识，即高质量的系统。如果你在外面，尼古拉斯，我祝你好运。

对于OP，我建议您寻找具有这些技能的人。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-08T13:27:12.910

一个好的质量保证部门会做几件事：

1.  根据产品的功能规范编写测试计划。这有助于清除功能规范并找到需要改进/更改的区域。
2.  查找产品中的错误这一点很明显。
3.  从非开发人员的角度测试产品的可用性。这远远超出了寻找错误的范围——如果没有人能弄清楚如何使用它，那么拥有一个没有错误的产品对你没有任何好处。

至于它们如何融入流程：

1.  一旦开发团队觉得功能规范已经完成，就会将其提供给 QA 团队，以便他们编写测试计划
2.  当开发团队有一个相对稳定的构建并具有合理数量的功能时，可以将其提供给 QA，以便他们可以开始查看它。在这一点上，QA 的重点只是熟悉新版本并指出任何明显的可用性缺陷，而不是锤击事物来寻找错误。
3.  一旦开发人员说“好的，我想我们已经准备好了”，QA 就会开始寻找错误的任务。
4.  开发人员和 QA 致力于解决所有问题。错误都已修复、删除或推迟到将来的版本。
5.  QA 对是否发布发布有最终决定权

请注意，上面的 3 和 4 可能会有很大差异，具体取决于您是在谈论新产品还是现有产品的发布。如果您有一个现有的产品，并且可以在开发的同时进行大量测试。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-08T13:34:07.967

理想情况下，测试人员应该从项目的早期就参与进来，这样他们就可以制定测试计划。除其他外，这将涉及编写测试脚本。实际编写的测试脚本对于可重复测试很重要（例如，对于新版本的回归测试）。除了测试功能外，该计划还将涵盖不同平台的测试、可用性测试和性能测试。

测试人员执行测试计划并找到并报告足够详细的错误，以最大限度地减少开发人员修复错误的工作。这意味着要花时间弄清楚如何重现问题。测试人员的成本通常低于开发人员，因此如果测试人员这样做比留给开发人员做对公司来说更好。测试人员往往也更擅长于此，因为他们不会做出开发人员所做的假设。

测试人员不应该真正进入检查是否遵守编码标准的领域——这最好留给自动化工具。测试人员永远不需要查看源代码。

当您有优秀的测试人员在项目上全职工作时，他们很快就会成为需求方面的专家（比只在系统的一部分上工作的开发人员更重要）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-08T13:06:56.977

程序员测试代码，测试人员测试应用程序。测试人员阅读规范，考虑可能导致问题的场景（如果两个人同时这样做会怎样？）等。

然后，他们记录一系列测试，进行测试，报告结果，等等。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-08T13:13:59.457

请参阅 Joel 的[您没有测试人员的五个（错误）原因](http://www.joelonsoftware.com/articles/fog0000000067.html)，以了解测试人员的工作以及他们为何对软件公司有利的说明。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-08T14:13:22.787

开发者任务：

*   从内向外——专注于代码
*   断言 - 验证数据流和结构
*   调试器 - 验证代码流和数据
*   单元测试 - 验证每个功能
*   集成测试 - 验证子系统
*   系统测试 - 验证功能

测试员任务：

*   从外到内 - 专注于功能
*   场景 - 验证真实世界的情况
*   全局测试 - 验证可行的输入
*   回归测试 - 验证缺陷保持不变
*   代码覆盖率 - 测试未触及的代码
*   兼容性 - 与以前的版本
*   寻找怪癖和粗糙的边缘

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-08T14:33:08.597

传统上，在大型 IT 服务公司中，测试人员的角色往往会随着所采用的开发过程的性质而略有不同。传统的瀑布或迭代项目往往涉及测试人员设计测试计划、编写测试用例并在该过程中阐明需求、执行它们（手动和自动）并清除应用程序以进行生产移动。他们还对可能受到影响的其他应用程序进行回归测试。在大多数情况下，他们从不查看代码，但在某些特殊情况下，他们会验证数据库条目，尤其是在涉及批处理作业或其他遗留系统的情况下。

另一方面，敏捷项目越来越多地导致测试人员和开发人员的职责之间的模糊。使用 Rails 或 Django 之类的框架，开发人员比以往任何时候都可以更好地了解“大局”，因此拥有一个庞大的、专门的、纯粹的测试团队通常是没有意义的。并且采用永久 beta 理念，测试的很大一部分是由实际的最终用户完成的。因此，一个更精简、更精通开发的测试团队往往会帮助敏捷项目（至少在企业内部）。除其他外，当测试人员可以将脚本组合在一起以自动化常规测试用例时，它会有所帮助，而不必依赖昂贵的工具（如 Win/Loadrunner）

On an average, a tester's motivation levels tend to be lower than developers. At least in my organization, a lot of testers want to "grow up" to be developers, although some of them do understand that becoming a QA/Assurance consultant is a career in its own right.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-08T13:02:54.520

你应该雇人做测试。

测试人员使用该应用程序并报告他们发现的错误。如果您有规范，他们可以针对它测试应用程序以报告任何不一致之处。

如果没有经过测试，任何产品发布都不可能有质量。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-08T13:30:11.670

实际上，最近我开始意识到如何区分一个坏测试员和一个好测试员。当由于没有发现错误而关闭任务时，一个小时后您自己使应用程序崩溃，因为您觉得“这很愚蠢，但是如果进行这种输入会发生什么？” 并且做到了，这是一个好兆头，表明某人（测试人员）没有完成他们的工作。

我经常报告我们软件中的某个地方的错误，并且一直觉得“这不是我应该做的”。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-08T13:44:11.377

为了更好地处理这个问题，我强烈推荐 Gerry Weinberg 的书“完美软件：和其他关于测试的幻想”（[经过消毒的亚马逊链接](https://rads.stackoverflow.com/amzn/click/com/0932633692)）。

它充满了出色的见解，会让您以全新的方式思考测试。

高温高压

干杯，

抢

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-08T13:46:57.083

与您的情况相反，我一直在与测试人员密切合作。我发现它们非常有帮助，因为它们非常了解我的软件在整体方案中的位置。他们更了解与我交互的应用程序。这方面的输入非常有价值。

# variables - 如何访问堆栈上的变量？

> ID：525660
> 
> 赞同：6
> 
> 时间：2009-02-08T12:58:14.467
> 
> 标签：variables, stack, low-level, memory-access

假设我们有这些局部变量：

```
int a = 0;
int b = 1;
int c = 2;
int d = 3; 
```

据我所知，这些将分配在系统堆栈上，如下所示：

```
|   |
| 3 | d
| 2 | c
| 1 | b
|_0_| a 
```

这是否意味着为了得到a的值，必须首先将d、c和b的值从堆栈中弹出？如果是这样，这些值在哪里？这是否意味着访问最近声明的变量会更快？还是我错过了什么（我怀疑是这种情况），而整个事情以其他方式起作用？

**编辑：**谢谢，伙计们！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-08T13:02:59.043

堆栈上的局部变量通常是相对于所谓的*帧指针*访问的，它指向堆栈帧的开头。也可以相对于堆栈指针执行此操作，但由于它在表达式评估期间移动，因此更难以跟踪。

实际上，这些变量也可以保存在处理器寄存器中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-08T13:02:30.307

> 或者我错过了什么

你错过了堆栈驻留在常规内存中，它允许随机访问 - 只需将适当的偏移量添加到帧指针（“本地”堆栈的底部），你就会得到一个指向保存该值的内存单元的指针。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-08T13:56:51.073

> 这是否意味着为了得到a的值，必须首先将d、c和b的值从堆栈中弹出？

The code emitted simply moves the [stack pointer](http://en.wikipedia.org/wiki/Stack_pointer#Structure) the correct number of bytes when entering the function. It moves it back the same distance when leaving the function. Thus, it does not pop off the variables individually. Assuming an int is 4 bytes, the example you gave would move the stack pointer 16 bytes. It actually moves it further than this because of other information in the stack frame such as the return address.

# wpf - 虚拟机下WPF开发可行吗？

> ID：525664
> 
> 赞同：6
> 
> 时间：2009-02-08T13:01:55.300
> 
> 标签：wpf, vmware, development-environment

在阅读[了如何防止你的开发机器变慢之后](https://stackoverflow.com/questions/420572/how-do-you-keep-your-windows-development-machine-from-slowing-down)，我想起了一年前我为我的开发机器构建一个 VM 的良好意图。

但是，我正在 Vista x64 上开发 WPF 和 SilverLight GUI。我可以在 VM 下运行 x64 版本的操作系统，但我担心 WPF 的图形性能，尤其是运行 Expression Blend。我希望需要 GPU！

我目前有用于 XP 32 位测试的 Virtual PC VM。那个版本或 VMWare 的某个版本是否可能更适合 WPF，如果是，是否有任何版本差异？我已经可以在 OS/X 上使用我的 VMWare Fusion 创建 VM，因此只需使用免费的 VMWare Player 就可以了——我无法找到任何关于 Player 和 Workstation 之间的 GPU 支持差异的评论。

我的主要 Windows 开发机器只是一台具有 4GB RAM 的戴尔笔记本电脑（Latitude 830），但我必须在笔记本电脑上工作以进行客户访问，所以我不倾向于购买额外的台式机。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-09T09:33:27.793

自己尝试过之后，我建议避免使用 VM 进行 WPF 开发。WPF 引擎依赖 DirectX 加速来呈现内容，并且 VMWare 上的 DirectX 支持不完整（尽管比 MS Virtual PC 不存在的 DirectX 支持好几英里）。

您将面临的问题是，Visual Studio 和 Expression 在您处理 XAML 时都会不断地重新呈现您的 XAML，这需要大量的 GPU 带宽。在 VM 中工作并不能解决问题，并且根据您的设置，您将在 VS 2008 中体验黑色/空白或无响应的设计器窗口。

如果可能的话，坚持在本地桌面上进行开发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T15:50:39.797

将您的开发环境放入 VM 中如何提高您的工作效率？

如果您的开发工具使您的计算机变慢，这将使主机操作系统快速而快速，但是您必须在开发工具所在的慢速 VM 中工作 - 所以我怀疑您保留了用于快速玩纸牌的计算机部分通过使您使用的部分工作更慢。

这是如何生产的？

此外，当您拥有大量内存并且 VM 文件位于与 Windows 安装不同的物理磁盘上时，VM 工作得最好——两者都不容易在笔记本电脑上完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-02T17:46:20.790

Parallels 5 似乎比我在 WPF 中的 Fusion VM 快得多。VS2010 加载速度要快得多，并且没有所有的视频故障......这有点糟糕，因为我过去几年一直在使用 Fusion，不想切换，但到目前为止，P5 使用 WPF 似乎好多了.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T03:21:22.117

这真的不应该那么糟糕 - 我希望注意到细微的差异，但出于开发目的，使用本地 VM 播放器将起作用。

您真正遇到的唯一问题是尝试通过带有大量动画/视频等的远程桌面开发 WPF。

顺便说一句，作为一种可能的替代方案，让 VM 与您的大多数开发工具共享一个逻辑磁盘分区，并在必要时在本地运行 Expression Blend 并打开项目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-15T15:47:16.333

VirtualBox 3.0 在 Windows 中增加了对 DirectX 8/9 的支持 - 请参阅[http://www.virtualbox.org/manual/UserManual.html#guestadd-3d](http://www.virtualbox.org/manual/UserManual.html#guestadd-3d)这可能会有所帮助。我还没有亲自尝试过。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-25T12:26:53.127

目前我只找到了一种解决方案：通过 RDP 连接到 VMWare。这样 Microsoft Expression 就不会出现故障。

（第一次看到还以为微软真的发布了这么不成熟的产品）

我将尝试找出是否可以在不通过 RDC 登录的情况下关闭 DirectX（或强制 DirectX 8）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-02-26T10:38:03.710

我找到了一个更好的方法：拒绝访问`d3d9.dll`. 删除它或编辑安全权限（就像我一样），使其无法访问。中有好几层`WPF: 0, 1, 2`。

2 把一切都搞砸了。0 不如 1 快。`DisableHWAcceleration`强制 tier 为 0。除了 forbidding 之外，我没有找到任何方法`d3d9.dll`。

令人高兴的是，它奏效了。Microsoft Expression 开始工作时没有杂乱无章。虽然我不确定层级是否真的是 1。

# linux - 有没有办法以非 root 用户身份在 linux 上启动/重启/停止 apache 服务器？

> ID：525672
> 
> 赞同：18
> 
> 时间：2009-02-08T13:04:46.887
> 
> 标签：linux, apache

我想知道 linux 上的非 root 用户（我正在使用 openSUSE）是否可以在不使用 sudo 命令的情况下运行 apache。考虑到用户与 apache (wwwrun) 位于同一组中。
提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-08T13:16:12.620

您可以以任何用户身份运行 Apache。只需确保将其设置为仅使用允许的资源（目录、文件，最重要的是侦听非特权端口）。

要让它出现在 HTTP 的标准端口 80（这是特权）上，您必须以**root**身份设置重定向到您的真实 Apache 服务器。最简单的方法可能是使用 iptables。例如，如果您的 Apache 服务器正在侦听端口 8080：

```
iptables -t nat -A PREROUTING -p tcp --dport 80 --syn -j REDIRECT --to-port 8080 
```

如果您不能像这样配置服务器（或者让您的系统管理员一次性完成），您将不得不使用非特权端口（类似`Listen 8080`）并使用类似于[http://www.example 的 URL 访问它。 com:8080/](http://www.example.com:8080/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-09-15T05:44:54.200

如果您安装了 sudo，您可以创建一个文件：/etc/suduers.d/apache2reload，其中包含以下内容：

```
username    ALL=NOPASSWD:/usr/bin/service apache2 reload 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-08T13:18:18.513

简短的回答：没有

原因是只有root才能绑定1024以下的端口。

长答案：查看[http://www.debian-administration.org/articles/386](http://www.debian-administration.org/articles/386 "http://www.debian-administration.org/articles/386")

一旦你克服了端口的问题，我认为不会有更多的麻烦。请记住，运行 apache 的用户需要对日志文件以及其他一些文件具有写访问权限。

但是，如果您在没有 sudo 的情况下运行它，spawner 可能无法更改用户，因此 apache 将作为启动它的用户运行，而不是 apache 用户。

但是你不想运行 sudo 的原因是什么？只有 spawner 进程以 root 身份运行，其余进程在 apache 用户下运行。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-11-25T16:36:29.003

如果您不想授予 sudo 访问权限，您还可以创建一个 setuid 包装程序。例如：

httpdctrl.c

```
#include <stdio.h>
#include <sys/types.h>
#include <unistd.h>
#include <signal.h>
#include <strings.h>

// allow start/stop/restart of apache by non-root users

int main(int argc, char **argv)
{
  char *cmd, *cmd2, *usage;

  // UPDATE THIS LINE:
  cmd = "/your/path/to/httpd/sbin/apachectl";
  cmd2 = "apachectl";
  usage = "Usage: COMMAND [start|stop|restart]\n";

  if ( argc != 2 ) {
    printf(usage);
    exit(1);
  }

  setegid(0);
  seteuid(0);
  setgid(0);
  setuid(0);

  if ( strncmp(argv[1], "start", 5) == 0 ) {
    if (execl(cmd, cmd2, "start", (char*)0) < 0) {
     perror("Error");
    }
  } else if ( strncmp(argv[1], "stop", 4) == 0 ) {
    if (execl(cmd, cmd2, "stop", (char*)0) < 0) {
     perror("Error");
    }
  } else if ( strncmp(argv[1], "restart", 7) == 0 ) {
    if (execl(cmd, cmd2, "restart", (char*)0) < 0) {
     perror("Error");
    }
  } else {
    printf(usage);
    exit(1);
  }
  exit(0);
} 
```

更新路径：

```
 // UPDATE THIS LINE:
  cmd = "/your/path/to/httpd/sbin/apachectl"; 
```

然后编译和更改权限

```
gcc -o httpdctrl httpdctrl.c
sudo chown root:root httpdctrl
sudo chmod u+s httpdctrl 
```

现在 httpdctrl 归 root 所有，setuid 将作为 root 运行它。

重要提示：确保启动/停止脚本和所有父目录也归 root 所有。还删除对“其他”的文件和目录的写访问权限。基本上，您不希望有人能够编辑或更改使用 root 执行的目录/文件。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-08T13:40:03.367

上面benlumley 指出的问题，即日志文件和保留端口，可以通过在httpd.conf 中配置日志目录和端口来轻松解决。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-08T13:09:23.057

我能想到你需要克服的两个问题是：

1.  日志文件的权限 - 这些可能已经设置为允许 wwwrun 访问它们，但这通常是一个问题。

2.  非 root 用户访问特权端口 (80) - 不确定是否/如何更改此设置。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-08T13:17:33.290

我认为您应该能够通过授予拥有 Apache 控制程序的组执行访问权限来做到这一点（例如，“chmod g+x apachectl”）。如果这本身不起作用，请尝试在程序上设置所有者 SUID 位（类似于“chmod u+s apachectl”的内容）。

第一步允许您 wwwrun 组中的用户执行 apachectl 程序。第二步使得当组运行程序时，它以程序所有者权限运行。

让我知道这是否可行，我对文件执行 SUID 有点生疏，但如果您仍有问题，我可以帮助您进一步调查。

不过，请确保在执行此操作之前了解设置 SUID 位的后果。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-17T15:11:17.533

您可以“setuid”以允许非 root 用户以 root 身份运行 apachectl（无需以 root 身份进行身份验证）。

[例子](http://en.wikipedia.org/wiki/Setuid#Demonstration)

编辑：应该提到您首先需要root访问权限才能进行设置:-)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-09-06T10:19:42.630

您可以使用 sudo -l 查看您的权限，从这里您可能会发现您可以访问重新启动命令，但可能无法启动和停止。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-06-12T00:51:23.900

我发现的一些链接对此给出了最有益的答案。从技术上讲，它仍然以 root 身份运行，但您可以 chmod u+s apache2 和 apache2ctl（如果您还使用第二个）加载文件。这允许您以 root 访问权限运行它们，但仍然是拥有相同权限的用户，保持安全性不变（除非 apache 或 apache2ctl 会做我怀疑的更疯狂的事情）。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2014-03-26T06:35:25.290

你可以使用supervisor来运行apache

# c++ - 有没有办法用编译指示禁用所有警告？

> ID：525677
> 
> 赞同：43
> 
> 时间：2009-02-08T13:08:41.980
> 
> 标签：c++, visual-c++, pragma

我已经开始了一个新项目，并决定确保它在启用 /Wall 选项的情况下干净地构建。唯一的问题是并非所有 3rd 方库（如 boost）都在没有警告的情况下编译，所以我求助于在共享标头中执行此操作：

```
#pragma warning(push)

#pragma warning(disable:4820)
#pragma warning(disable:4619)
#pragma warning(disable:4668)
#pragma warning(disable:4625)
#pragma warning(disable:4626)
#pragma warning(disable:4571)
#pragma warning(disable:4347)
#pragma warning(disable:4640)
#pragma warning(disable:4365)
#pragma warning(disable:4710)
#pragma warning(disable:4820)
#pragma warning(disable:4350)
#pragma warning(disable:4686)
#pragma warning(disable:4711)
#pragma warning(disable:4548)

#include <boost/array.hpp>
#include <boost/assert.hpp>
#include <boost/assign.hpp>
#include <boost/bind.hpp>
#include <boost/lexical_cast.hpp>
#include <boost/filesystem.hpp>
#include <boost/foreach.hpp>
#include <boost/format.hpp>
#include <boost/function.hpp>
#include <boost/integer.hpp>
#include <boost/optional.hpp>
#include <boost/regex.hpp>
#include <boost/smart_ptr.hpp>
#include <boost/algorithm/string.hpp>
#include <boost/tuple/tuple.hpp>
#include <boost/utility.hpp>
#include <boost/variant.hpp>

#pragma warning(pop) 
```

这工作得很好，但每次我添加新的提升标题时，我都必须将它们生成的任何警告添加到列表中。有没有办法说禁用这段代码的所有警告？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-02-08T13:32:48.373

您可以推送/弹出低级别的警告，如下所示：

```
#pragma warning(push, 0)        

#include <boost/bind.hpp>
#include <boost/shared_ptr.hpp>
// ...

#pragma warning(pop) 
```

但要知道，不可能禁用*所有*警告。例如，某些链接器警告是无法关闭的。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-03-08T01:01:13.660

```
#pragma warning(disable:4820)
#pragma warning(disable:4619)
#pragma warning(disable:4668) 
```

为了更少的线路......

```
#pragma warning (disable : 4820 4619 4668) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-15T19:38:17.503

我之前所做的是设置“W3”选项而不是“Wall”，然后在我放置的每个源 .cpp 文件中

```
#pragma warning(push, 4) 
```

在所有“#include ...”行之后的顶部，然后

```
#pragma warning(pop) 
```

作为文件的最后一行。

通过这种方式，您可以在代码中获得第 4 级警告，在第 3 方代码中获得第 3 级警告，而您对此无能为力。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-05-30T16:17:26.267

使用[Assaf Lavie 的回答](https://stackoverflow.com/a/525712/7585517)中描述的技术，可以创建辅助宏：

```
#define DISABLE_ALL_WARNINGS_BEGIN \
    __pragma(warning(push, 0))

#define DISABLE_ALL_WARNINGS_END \
    __pragma(warning(pop)) 
```

它们可以通过以下方式使用（[在线演示](https://godbolt.org/z/XEcCMk)）：

```
DISABLE_ALL_WARNINGS_BEGIN
void foo(int a)
{
    // this function should generate the following warning
    // "warning C4100: 'a': unreferenced formal parameter"
    // unless it is wrapped inside "DISABLE_ALL_WARNINGS" section
}
DISABLE_ALL_WARNINGS_END 
```

# asp.net - 了解 ASP.Net 和数据库

> ID：525678
> 
> 赞同：1
> 
> 时间：2009-02-08T13:08:53.900
> 
> 标签：asp.net, database

我可以通过一些指导来了解 asp.net 和数据库的世界。

似乎有很多选择，我不确定要研究什么以及在不同情况下使用什么。

我创建的网站过去使用过数据集，但我从来没有真正理解发生了什么，或者为什么我应该或不应该使用它们，而不是仅仅创建一个 sql 连接和运行 sql 语句。

据我了解，有标准的 SQLReader、数据集、实体框架和 LINQ。

这些如何相互关联？什么推荐和什么时候？

在某个地方有所有这些的指南吗？（我并不是真的在寻找 www.asp.net/learn 向您展示的如何做某事，而是何时以及为什么要做某事）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-08T13:45:21.360

对于每种方法的优缺点，网络上有大量信息可供使用，但简而言之，按以下顺序排列：

```
sqlreader
datasets
Linq
entity framework 
```

您将从最快到最慢（就原始性能而言）、最少功能和最低复杂性到大多数功能和最高复杂性。这是一个巨大的简化，但我认为它非常有效。原始性能并不总是最重要的问题，因此它不像选择最快的方法那么容易。其他因素也会起作用，例如您正在处理的应用程序的大小和复杂性，程序员是否也是 DBA（或者您是否有专门的 DBA，他对数据库访问有自己的要求），无论您是否愿意被要求或允许使用存储过程等。

我认为作为一名开发人员，了解所有 4 种方法（和其他方法）很重要，并且能够选择最适合您正在从事的项目的一种。

我已经使用了前 3 个（并计划很快学习 EF），最终大部分时间都使用 sqlreader。Datareader 的开销最少，并且在大多数情况下运行速度最快，代价是您需要编写更多自己的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T18:00:51.127

阅读此[ADO.NET](http://www.csharp-station.com/Tutorials/AdoDotNet/Lesson01.aspx)简介；它是 ASP.NET 数据访问的隐含部分，应该可以帮助您理解数据流。

# php - RegEx：匹配和替换“AB ABC D”中的ABC

> ID：525681
> 
> 赞同：0
> 
> 时间：2009-02-08T13:10:24.003
> 
> 标签：php, regex, preg-replace

我需要关于这个片段的建议

```
$text = preg_replace('|(A.*)?A(.*)C|', '$1foo$2bar', $text); 
```

这将匹配“AB ABC D”中的 ABC，并将其替换为“AB fooBbar D”；正如您所看到的，这也与开头的“AB”部分匹配，我必须在替换字符串中用 $1 重复它，以免丢失它。

这是获得这种结果的最佳方式吗？

是否有一个标志 X 使得

```
$text = preg_replace('|A(.*)C|X', 'foo$1bar', $text); 
```

产生相同的结果？

我希望我已经清楚了

谢谢！

**编辑**：将 A、B、C 视为任意字符的原子字符串，它们也可以包含空格

此外，给出的示例实际上是错误的，因为它仅匹配“ABC ABC”中的第二个“ABC”。

**EDIT2**：对不起，我可能已经非常糟糕地解释了这个问题。关键是我想匹配两个 A,C 字符串之间的**任何**内容，以便匹配中没有子字符串 A

再次感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T13:18:33.223

这个怎么样：

```
$text = preg_replace('|A(\S*)C|', 'foo$1bar', $text); 
```

匹配非空白字符，因此`\S`您不会替换不同的单词。

* * *

在看到一些OP的评论后，我会冒险另一个猜测：

```
$text = preg_replace('|A(B)C|', 'foo$1bar', $text); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T13:22:01.500

`*`使用量词的非贪婪版本：

```
$text = preg_replace('|(.*)(A.*?C)|', '$1foo$2bar', $text); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T13:25:47.470

由于问题已得到澄清，请尝试以下表达式：

```
preg_replace('/(?:A)+(.+?)(?:C)+/', 'foo$1bar', $text) 
```

一个例子：

```
$A = 'abc'; $B = '123'; $C = 'xyz';
$text = "$A$B$C $A$A$B$C $A$B$C$C";
echo preg_replace("/(?:$A)+(.+?)(?:$C)+/", 'foo$1bar', $text); 
```

# sql - SQL 中的大文本和图像

> ID：525690
> 
> 赞同：9
> 
> 时间：2009-02-08T13:15:26.677
> 
> 标签：sql, mysql, sql-server

在 SQL 数据库中存储大量文本（例如 html 页面）是个好主意吗？还是将其作为 html 文件存储在文件系统中是一个更好的主意？

图像也是如此 - 将图像数据存储在数据库中还是将它们放在磁盘上更好？

例如，存储大量数据会导致性能问题吗？每种存储方法的优缺点是什么？

就数据大小而言，在这种情况下，我正在查看 HTML 的“几页”区域和小于约 500kb 的图像（尽管可能要小得多）。足以生成您的平均文章/博客条目/等规模的网页。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-08T13:43:47.790

在数据库中存储二进制数据（文档、图像等）有一些优势。

*   您可以在与要存储的有关文档的信息（名称、日期等）相同的事务中提交文档本身的更新。这意味着您不必担心编写自己的两阶段提交（尽管 ISTR 认为 SQL Server 2008 对此有解决方案）。

*   您可以一次备份全部（文档和元数据），而不必担心必须将数据库与文件系统同步

*   您可以通过 .NET Web 服务非常简单地交付文档，因为它们直接进入 DataTables，并且只需将 DataTables 放入 DataSet 并传递它即可轻松进行序列化。

*   您可以将数据库安全性应用于对象以及其余数据，而不必担心网络文件权限。

它也有一些缺点：

*   备份可能会变得非常大

*   数据库中二进制对象的大小可能比它最初来自的文件大很多，因此在客户端-服务器环境中，它会增加通过网络打开它们所需的时间。

*   根据应用程序，如果数据库服务器必须提供大量大型文档，您可能需要考虑它的负载。

综上所述，这是我广泛使用的一种技术，而且效果很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T13:23:04.277

你投入的越多，你移动的越多，所以你创造的开销就越多。

如果您有一个出色的 Web 服务器，那么当您可以将所有这些压力都委托给 Web 服务器时，无缘无故地向数据库添加所有额外压力是没有意义的。

即使从维护的角度来看，移动并以良好的逻辑结构处理文件也比不断地使用数据库要容易得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-08T13:28:58.943

这是大小问题。这取决于您的图像/文本到底有多大。

与基于文件系统的方法相比，将这些值存储在数据库中具有许多优势，但在某些时候它变得低效。例如，我不会在数据库中存储极高分辨率的图像。

所以这是一个程度的问题，而这反过来又意味着答案取决于您的硬件资源和系统架构。所以我不相信你的问题有一个正确的答案。也许您可以告诉我们更多有关您尝试存储的内容以及您的服务器外观的详细信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-08T13:34:52.177

我认为你可以争论任何一方，但我认为大量文本是可以的（因此变得可搜索），但图像应该作为单独的文件存储在数据库中并带有链接。我从来没有想出任何令人信服的理由将图像存储在数据库中，即使它是可能的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T12:42:03.987

其他需要考虑的是这些大块文本和图像的更改频率。数据的变化是导致碎片化的原因。数据文件和数据库结构中都可能出现碎片。文件系统比数据库更适合处理碎片。文件更改的频率越高，系统碎片化的速度就越快。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-07-07T08:07:19.757

**将文本存储到数据库中**

是的，您应该将尽可能多的 HTML 内容存储到数据库中 => 它简化了备份。您可能应该使用模板系统，这样您就不会将整个网页结构与每个文档一起存储，只需将从一页到下一页的内容存储到数据库中。

实际上，我们部署的大多数网站的文本内容都不超过 10MB（我们使用自己的自定义模板系统）。10MB 的纯文本是很多内容（信不信由你）

**在文件系统上存储图片**

通常，将图像存储在数据库中只是一个坏主意，因为您失去了使用 FTP 快速交换照片的能力。

这样维护也会更容易。徽标、文章照片和支持图形在网站的生命周期中发生了很大变化。与文本不同，您不能将照片的二进制数据完全剪切粘贴到数据库编辑器中......

此外，如果您的数据库损坏 - 这种情况经常发生，那么如果您将图像存储在数据库中，您就会遇到麻烦。而文件系统损坏只影响有限数量的文件。数据库损坏会让您获取备份，这很浪费时间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-08T13:36:14.187

这是我以前编写 PHP 时的困境之一。在数据库中存储像 blob 这样的图像可以更容易地管理安全性和权限，但成本很高。我总是习惯在数据库上存储一些元数据，在文件系统上存储二进制内容。对图像的访问不是直接的 ( `<img src="image/path" />`)，而是由 PHP 脚本提供的，该脚本在显示图像 ( `<img src="showimage.php?id=$id" />`) 之前通过会话检查用户身份验证和授权。我建议您这样做（无论您使用哪种应用程序）。

# c# - 将多个结果集从 ASP.NET MVC 中的控制器传递到视图？

> ID：525701
> 
> 赞同：0
> 
> 时间：2009-02-08T13:23:27.130
> 
> 标签：c#, sql, asp.net-mvc, view, controller

所以我有一个控制器设置如下：

```
using NonStockSystem.Models;

namespace NonStockSystem.Controllers
{
    [Authorize(Users = "DOMAIN\\rburke")]
    public class AdminController : Controller
    {    
        private NonStockSystemDataContext db = new NonStockSystemDataContext();

        public ActionResult Index()
        {
            var enumProducts = from p in db.Products select p;
            ViewData["Title"] = "Administration";
            return View(enumProducts.ToList());
        }
    }
} 
```

Admin 控制器上的 Index 视图仅列出系统中的产品，并允许我们单击产品以查看/编辑/删除它。真的很简单。然而，每个产品都有一个 CategoryID，它告诉我们它属于哪个类别，它存储在一个单独的表中。

（非常简化的）当前视图是这样的：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" AutoEventWireup="true" CodeBehind="Index.aspx.cs" Inherits="NonStockSystem.Views.Home.Admin" %>
<%@ Import Namespace="NonStockSystem.Models" %>
<asp:Content ID="Content1" ContentPlaceHolderID="MainContent" runat="server">

<%
foreach (Product p in (IEnumerable)ViewData.Model)
{ %>

    <%=p.Name.ToString() %> (<a href="/Admin/Edit/<%=p.ID.ToString() %>">Edit</a> - <a href="/Admin/Delete/<%=p.ID.ToString() %>">Delete</a>)<br />

<%
} %>   

</asp:Content> 
```

目前这很好，因为在我开发和测试它时系统中只有 10 或 15 个产品，但是一旦我部署它，就会有大约 15 个产品。数据库中有 300 种产品。我可以将它们全部显示在一个页面上，但是我想使用 (a href="#category") 链接，就像 Wikipedia 在页面顶部使用的那样，我可以拥有类别列表，当您单击一个它将您带到页面的适当部分。因此，在这种情况下，我的观点将如下所示：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" AutoEventWireup="true" CodeBehind="Index.aspx.cs" Inherits="NonStockSystem.Views.Home.Admin" %>
<%@ Import Namespace="NonStockSystem.Models" %>
<asp:Content ID="Content1" ContentPlaceHolderID="MainContent" runat="server">

<ul>
<%
foreach (Category c in (IEnumerable)ViewData.Model)
{ %>
    <li><a href="#<%=c.Name.ToString() %>"><%=c.Name.ToString() %></a></li>
<%
} %>
</ul>

<hr />

<%
foreach (Category c in (IEnumerable)ViewData.Model)
{ %>
    <% // Display the category name above all products from that category %>
    <h2><a name="<%=c.Name.ToString() %>"><%=c.Name.ToString() %></a></h2>

    <% // Need to limit the following foreach to grab only products in this category
    foreach (Product p in (IEnumerable)ViewData.Model)
    { %>
        <%=p.Name.ToString() %> (<a href="/Admin/Edit/<%=p.ID.ToString() %>">Edit</a> - <a href="/Admin/Delete/<%=p.ID.ToString() %>">Delete</a>)<br />
    <%
    } %>
} %>

</asp:Content> 
```

首先，我不完全确定这是做到这一点的“正确”方式，所以我绝对愿意接受不同做事方式的建议，但如果这是要走的路，那么我需要知道如何（1 ）将两个结果集传递给视图（产品和类别）和（2）循环遍历每个 foreach 循环中的产品子集，仅获取适当类别中的产品？

干杯!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-08T13:48:54.007

你有两个选择。首先，您可以创建一个包含 Products 和 Categories 集合的仅查看模型。其次，您可以在 ViewData 中传递一个或两个模型，而不是设置为页面的模型。

```
public class CategoryProduct
{
    public IEnumerable<Product> Products { get; set; }
    public IEnumerable<Category> Categories {get; set; }
}

....

return View( new CategoryProduct { Products = products,
                                   Categories = categories } ); 
```

这允许您使用强类型视图模型并获得智能感知，但需要额外维护一个类。

或（一个选项）

```
ViewData["categories"] = categories;
return View( products ); 
```

这需要为类别转换 ViewData，以便您可以使用强类型。在这种情况下的产品是模型。您可以交换这些或将两者都放入 ViewData。

至于你的方法，我可以接受。一种替代方法是对其进行分页，以便并非所有类别都存在于同一页面上以降低页面长度。您仍然会在顶部列出所有类别，但有些可能需要回发来获取新的数据页面。这可能有点复杂，但是当产品数量增加时会加快加载时间。另一种方法是使用向下钻取。首先选择一个类别，然后只显示该类别中的产品。这些也可以被分页。我认为这更像是亚马逊、Buy.com 等网站的典型做法。它们还允许额外的过滤（类别只是顶级）。

# sql - SQL查询返回相对顺序的int列

> ID：525702
> 
> 赞同：0
> 
> 时间：2009-02-08T13:23:45.537
> 
> 标签：sql, mysql

假设我有两列的表：姓名，年龄。

我想设计一个查询，该查询将返回按年龄排序的姓名和年龄，但还有一个额外的列，该列将从 1 运行到 N（最后一行）。

因此，对于具有以下行的表：

```
John, 28
Jim, 30
Mike, 28 
```

将返回以下行

```
John, 28, 1
Mike, 28, 2
Jim, 30, 3 
```

我怎样才能做到这一点？（顺便说一句，我正在使用 MySQL，如果它有差异的话）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-08T13:28:29.867

不了解 MySQL，但在 SQL Server 中，您可以这样做：

```
SELECT Name, Age, ROW_NUMBER() OVER (ORDER BY AGE) AS RunningCount
FROM MyTable 
```

在“mysql and ROW_NUMBER()”上快速谷歌搜索我发现了这个：

```
set @num = 0;
select *, @num := @num + 1 as row_number from TABLE 
```

所以大概你可以使用那个语法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T13:34:03.113

在 mysql 中，您可以：

```
SELECT Row,Name,Age
FROM (SELECT @row := @row + 1 AS Row, Name,Age FROM table1 ) 
As derived1 
```

但是，下一种方法是通用的（但您需要在表的一个列中具有唯一值，在此示例中，我使用了 name 但它可以是任何唯一列）

```
 select rank=count(*), a1.name, a1.age
   from table1 a1, table1 a2
   where a1.name >= a2.name
   group by a1.name , a1.age
   order by rank 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T14:19:19.310

如果您正在寻找一种适用于任何 SQL 平台的通用方法，那么以下方法应该有效。我从来没有在很大的桌子上使用过它，所以我不知道性能如何。此外，如果您的姓名和年龄在两行之间可能相同，那么您将得到一个重复的数字（例如，1、2、3、3、5...）。如果您愿意，可以通过在其中添加 PK 或其他一些保证唯一的列来避免这种情况。

```
SELECT
     T1.name,
     T1.age,
     COUNT(T2.name) + 1
FROM
     My_Table T1
LEFT OUTER JOIN My_Table T2 ON
     T2.age < T1.age OR
     (
          T2.age = T1.age AND
          T2.name < T1.name
     )
GROUP BY
     T1.name,
     T2.age
ORDER BY
     T1.age,
     T2.name 
```

# c# - Java 比 C# 更优雅的例子在哪里？

> ID：525711
> 
> 赞同：3
> 
> 时间：2009-02-08T13:32:45.537
> 
> 标签：c#, java, jakarta-ee

自从我上次使用 Java 已经过去几年了。你能告诉我在Java中可以更优雅地解决哪些问题吗？

我知道 Java 的以下好处：

*   Java“无处不在”，
*   Java 支持[单位和度量](http://www.javaworld.com/javaworld/jw-10-2007/jw-10-jsr275.html)
*   （据说）Java 中更好的延迟
*   [J2EE](http://en.wikipedia.org/wiki/J2EE)（我认为 .Net 中没有等价物）
*   泛型的不同方法（具有奇怪的循环定义，例如“Enum>”，请参阅[Ken Arnold](http://weblogs.java.net/blog/arnold/archive/2005/06/generics_consid_1.html)）

那么泛型呢 - 有没有不能用 C# 表示的优雅的 Java 示例？还是其他 API 或库？

谢谢，

吉日

PS一些通用链接：

*   维基百科[比较文章](http://en.wikipedia.org/wiki/Comparison_of_C_Sharp_and_Java)
*   [比较 Java 和 C# 泛型](http://www.jprl.com/Blog/archive/development/2007/Aug-31.html)- Jonathan Pryor 的网络日志

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-08T13:46:46.287

Java 泛型与 C# 泛型*非常不同。*是的，在某些地方这意味着它可以更优雅——通常是在通配符和方差方面。另一方面，通配符通常不太了解（我非常肯定地将自己包括在那个阵营中），类型擦除的整个业务意味着总的来说我*更*喜欢 .NET 泛型。

Java“赢得”IMO的一个完全不同的地方是它的枚举支持。C# 枚举基本上是命名的数字——Java 更加面向对象。在 C# 中使用嵌套类可以实现类似的效果*，*但更多的框架支持（相当于`EnumSet`）和开关支持将受到欢迎。

我也喜欢在 Java 中限制对包（命名空间）的可见性的能力——尽管这是我更喜欢 C# 的 Java 访问规则的唯一方面。

在大量使用 Java 和 C# 多年之后，我自己的感觉是，在语言级别上，C# 远远领先于 Java。确实，良好的跨平台支持和庞大的现有代码库是目前 Java 相对于 C# 和 .NET 的两个*显着*优势。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-08T14:12:48.060

What does "better latency" even mean in this context?

Other than that, I agree with Jon Skeet. On the whole, C# is lightyears ahead of Java. There are a few tricks in Java that are neat (enums for example), but they're very much the exception, not the rule.

# c# - 从 ASP.NET MVC 中的 Url 获取 Html

> ID：525718
> 
> 赞同：9
> 
> 时间：2009-02-08T13:34:40.430
> 
> 标签：c#, asp.net, html, asp.net-mvc

我需要从 url 保存一个页面 - 此页面在我自己的应用程序中 - 以 html 格式。然后，此 html 将通过电子邮件发送给用户。有谁知道怎么做？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-08T13:53:23.433

好吧，您必须在服务器上执行此操作才能发送电子邮件 - 所以在最坏的情况下，只需：

```
using(WebClient client = new WebClient()) {
    string html = client.DownloadString(address);
} 
```

也可以*直接*在 MVC 中进行 - 也许`RenderPartial`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T15:40:00.350

您可以创建一个结果过滤器或覆盖控制器的 OnResultExecuted 方法以访问呈现的页面。

# ruby - 运行 minitest 测试用例时出现 Pathname.rb 错误

> ID：525730
> 
> 赞同：0
> 
> 时间：2009-02-08T13:45:11.347
> 
> 标签：ruby, minitest

我正在运行 Ruby 1.8.6。

我安装了 minitest 1.3.1 gem，它实际上是 Ruby 1.9 中 Test::Unit 框架的新替代品。API 应该是相同的。

我写了一个小测试来让事情顺利进行：

```
require 'rubygems'
gem 'minitest'
require 'minitest/unit'

MiniTest::Unit.autorun

class CategoryMiniTest < MiniTest::Unit::TestCase
  def test_twoCategoriesCannotHaveSameName
    assert_equals(2,2)
  end
end 
```

这导致：

```
>ruby test\unit\category_mini_test.rb
l:/ruby_home/lib/ruby/1.8/pathname.rb:709:in `relative_path_from': different prefix: "l:/" and "L:/Gishu/Ruby/Rails/ShowMeTheMoney" (ArgumentError)
        from l:/ruby_home/lib/ruby/gems/1.8/gems/minitest-1.3.1/lib/minitest/unit.rb:17 
```

是什么赋予了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T14:39:53.357

I can't see anything wrong with your code. It looks almost exactly the same as the Ruby 1.8.6 & MiniTest example in my blog post: [Test::Unit and MiniTest with different Ruby versions](http://blog.floehopper.org/articles/2009/02/02/test-unit-and-minitest-with-different-ruby-versions).

So I wonder if it is:

1.  something to do with your environment,
2.  something to do with how you are running the test, or
3.  a bug in MiniTest.

Looking at the error message, I wonder whether the problem is with case-sensitivity - the upper-case and lower-case `L` drive letters may not match.

# c - DES 加密和密码模式

> ID：525734
> 
> 赞同：2
> 
> 时间：2009-02-08T13:47:04.930
> 
> 标签：c, encryption, cryptography, ecb

我需要加密[ISO 8583](http://www.iso.ch/iso/iso_catalogue/catalogue_tc/catalogue_detail.htm?csnumber=31628)消息...这里的问题是消息比密钥长。我需要有人帮助我如何加密这个字符串。

例如：我的字符串中有 300 个字符；我应该单独加密每个 16 个字符然后连接它们，因为我的主密钥长度是 16 个字节？

我感谢您的帮助...

* * *

ISO 8583-1:2003 金融交易卡发起的消息——交换消息规范——第 1 部分：消息、数据元素和代码值。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-08T13:51:56.323

DES is a block cipher, and block ciphers have different modes of operation.

The mode you mentioned is known as ECB (Electronic Codebook), and is not very secure (actually, neither is DES, but more on that later).

I'd suggest you use CBC or some other mode.

You can read about block cipher modes of operation here: [Block cipher modes of operation](http://en.wikipedia.org/wiki/Block_cipher_modes_of_operation)

As for the cipher itself, I'd suggest you avoid using DES if this is at all possible. DES is extremely easy to crack nowadays. Please use AES, or at least 3DES if AES is not available.

**EDIT:** In response to the [updated question](https://stackoverflow.com/questions/525734/des-encryption-and-cipher-modes/525792#525792), yes, you would need to pad the last block if the plaintext size is not a multiple of the block size.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-08T14:15:37.213

There are many different modes of operation for a block cipher. If you just need to applay ECB to your plain text, just split the plain text into equally sized blocks of size 8 bytes (DES block size) and encrypt each separately.
Depending on what you want to achieve, you could also use

*   **ECB** which encrypts block wise with each block being independent from all other (previous) blocks. Drawback: known plain text attacks can reveal patterns in your cipher text because the same plain text will always be encrypted to the same cipher text
*   **CBC** here you have an initialization vector and each blocks depends on all previously encrypted blocks. This is why you need an [IV](http://en.wikipedia.org/wiki/Initialization_vector) for the first block.
*   **CFB** this is an interesting one because it allows you to turn your block cipher into a stream cipher, which might be useful if you want to encrypt a video stream or whatever (similarly for OFB which basically generates a key stream)
*   **CTS** cipher text stealing might be of use if you want to encrypt data but want to avoid padding. A usage example might be to encrypt a blob in your database, which you cannot resize after it has been written to the DB.

There are still many more modes, but these are the most commonly used ones (imho).
As others have pointed out visit [Wikipedia](http://en.wikipedia.org/wiki/Cipher_block_chaining) for all the details.

**Update:**
As for the padding, you have different [possibilities](http://en.wikipedia.org/wiki/Padding_(cryptography)). I'd recommend to use the ANSI X.923 standard which basically requires you to pad the last buffer with zeroes and append a counter in the last byte which gives you the number of valid bytes in the last block. The same idea is used in ISO10126 but this time padding is done with random bytes. Note that you can avoid padding at all when using CTS.

Maybe ask yourself if it's actually easier to use a crypto library to do the job for you.
If you're using C++ go for [Crypto++](http://www.cryptopp.com/) (not so straightforward, but consistent c++ style), Java and .NET have built in crypto providers. If you want to use plain C i can recommend [libTomCrypt](http://libtomcrypt.com/index.old.html) (very easy to use).

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-08T13:50:10.493

The key length does not impose a limit on the message size. The message can be as long as you want, and your 128-bit key (nonstandard for DES?) will still be good. The [DES cipher](http://en.wikipedia.org/wiki/Data_Encryption_Standard) operates on blocks of bytes, one block at a time. [Standard DES](http://www.itl.nist.gov/fipspubs/fip46-2.htm) uses a 56-bit key (plus 8 parity bits) and 64-bit blocks.

> should I encrypt each 16 chars alone then concat them, since my master key length is 16 bytes?

Ciphers in general do not require the key and block sizes to be the same; they can define complicated operations taking a given block of cleartext and transforming it with the key to a block of ciphertext (usually of the same size). When multiple blocks need to be encrypted, a [mode of operation](http://en.wikipedia.org/wiki/Block_cipher_modes_of_operation) is specified to describe how one block relates to the next block in the process.

When operating in the *electronic codebook* (ECB) mode, the message is divided into blocks, and each block of cleartext is encrypted separately with the same key (the resulting blocks of ciphertext are then concatenated). Like other [modes of operation for DES](http://www.itl.nist.gov/fipspubs/fip81.htm) (i.e. CBC, CFB, OFB), this approach has its pros and cons. You will need to pick the mode most suitable for your application.

Btw, you should also be aware that DES is now [considered insecure](http://en.wikipedia.org/wiki/EFF_DES_cracker).

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-08T13:50:55.873

You need to look up [encryption modes](http://en.wikipedia.org/wiki/Block_cipher_modes_of_operation) - which have names such as Cipher Block Chaining (CBC) and the 'do not use' mode Electronic Code Book (ECB), and even some exotic names like the Infinite Garble Extension (IGE). That page has a beautiful illustration of why the ECB mode should not be used.

CBC is a standard, solid mode of operation. OFB and CFB are also widely used.

You realize that the US Federal Government no longer uses plain DES because it is not secure enough (because it uses a 56-bit key and can be broken by brute force)? Triple-DES is just about tolerated - it has a 112-bit or 168-bit key, depending on which way you use it. The standard, though, is Advanced Encryption System, AES. Unless you have backwards compatibility reasons, you should use AES and not DES in new production code.

Also, you should know the answers to these questions before trying to write production code. I trust this is in the nature of homework or personal interest.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-17T16:18:17.880

您可能出于以下原因需要加密：

1.  传输安全数据，即 PIN 块（数据元素 52），当您从收单方密钥转换为发行方密钥时，该数据由 HSM 处理。
2.  或对消息进行 MAC 处理，然后您将选择一些字段进行散列并附加到消息的末尾（通常是数据元素 124 或 128）
3.  或者您想存储 ISO 8583 消息并希望遵守 PCI DSS 法规，在这种情况下，您将加密以下数据元素（如果存在）
    *   DE 2 - 卡号
    *   DE 14 - 到期日
    *   DE 35 - 第二轨
    *   DE 45 - 轨道 I
    *   DE 48 - EMV（芯片）数据（MasterCard TLV）
    *   DE 52 - PIN 块
    *   DE 55 - EMV（芯片）数据（签证）

还有一件事，您的主密钥应该是 128 位以符合 Visa 的要求（三重 DES 要求 LMK 至少是双倍长度的密钥，即 32 位 - 128 位密钥）

# iphone - iPhone Landscape-Only Utility-Template Application

> ID：525737
> 
> 赞同：4
> 
> 时间：2009-02-08T13:49:25.237
> 
> 标签：iphone, landscape

I'm trying to create an iPhone application that is always in landscape mode, using the Utility application template. Here's what I did:

*   Create a new iPhone application project, using the Utility Application template
*   In Interface Builder, rotate all the views 90 degrees.
*   In Interface Builder, add a label to the middle of the MainView. Stretch it all the way across the view, set the alignment to centered, and set the autosizing springs so that it can stretch horizontally.
*   In Info.plist, add the key "UIInterfaceOrientation" with value "UIInterfaceOrientationLandscapeRight"
*   In the controller classes, change the shouldAutorotateToInterfaceOrientation methods to "return (interfaceOrientation == UIInterfaceOrientationLandscapeRight) || (interfaceOrientation == UIInterfaceOrientationLandscapeLeft);"
*   Run the app.

When I launch my app, it comes up in landscape orientation, but the main view only covers the top half of the display, and it is stretched horizontally. I get the same results in both the simulator and on an actual device. I've seen it with versions 2.2 and 2.2.1 of the SDK.

I have been able to work around the problem by adding the following step to the above:

*   Add "self.view.autoresizesSubviews = NO;" to RootViewController's viewDidLoad method after "[super viewDidLoad];".

If I do this, then it works as expected. But this feels like a hack. Why should this be necessary?

I don't think it is a transformation issue. All elements are drawn in the proper orientation and with the proper scaling. The problem seems to be that the bounds rectangles of the main view gets funky. It looks like the height of the main view is being cut by a little more than half, and the width is being increased by about 50%.

If I do the exact same set of steps using the View-based Application template instead of Utility, then everything works as expected. So I'm pretty sure the problem is specific to how a Utility application manages its views.

Anybody understand what's going on here?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-08T17:23:51.917

我要说的是设置这个键不会旋转你的界面；您仍然需要以横向模式布置内容并使用 CFaffineTransform 进行适当的旋转 - 请参阅 iPhone OS 编程指南中的“以横向模式启动”。为您查找参考资料时，我发现了这条评论：“要在 v2.1 之前的 iPhone OS 版本中以横向模式启动基于视图控制器的应用程序，您需要对应用程序的变换应用 90 度旋转根视图除了前面的所有步骤。在 iPhone OS 2.1 之前，视图控制器不会根据 UIInterfaceOrientation 键的值自动旋转它们的视图。但是，在 iPhone OS 2.1 及更高版本中，此步骤不是必需的。

因此，如果您运行的是 2.1 之前的版本，则需要将此代码添加到视图控制器中的 viewDidLoad 方法中。（否则，您可以发布一些代码吗？）

```
-(void)viewDidLoad 
// After loading the view, transform the view so that the co-ordinates are right for landscape
// As described in iPhone Application Programming Guide
// Weird, I'm sure this used to be needed, but it doesn't now. The one in CardScrollViewController is needed though.
{
    [super viewDidLoad];

    CGAffineTransform transform = self.view.transform;
    CGPoint center = CGPointMake(kScreenHeight / 2.0, kScreenWidth / 2.0);

    // Set the center point of the view to the center point of the window's content area.
    self.view.center = center;

    // Rotate the view 90 degrees around its new center point.
    transform = CGAffineTransformRotate(transform, (M_PI / 2.0));
    self.view.transform = transform;    
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T20:02:05.013

Jane 将 UIInterfaceOrientation 的设置描述为 UIInterfaceOrientationLandscapeRight（或 UIInterfaceOrientationLandscapeLeft），以及文档中推荐的旋转设置，但我在根视图控制器中使用了稍微不同的代码块（到同一端）：

```
- (void)loadView 
{
    UIView *primaryView = [[UIView alloc] initWithFrame:[[UIScreen mainScreen] applicationFrame]];
    primaryView.backgroundColor = [UIColor clearColor];

    // Start in landscape orientation, and stay that way
    UIInterfaceOrientation orientation = [[UIApplication sharedApplication] statusBarOrientation];
    if (orientation == UIInterfaceOrientationLandscapeRight) 
    {
        CGAffineTransform transform = primaryView.transform;

        // Use the status bar frame to determine the center point of the window's content area.
        CGRect statusBarFrame = [[UIApplication sharedApplication] statusBarFrame];
        CGRect bounds = CGRectMake(0, 0, statusBarFrame.size.height, statusBarFrame.origin.x);
        CGPoint center = CGPointMake(60.0, bounds.size.height / 2.0);

        // Set the center point of the view to the center point of the window's content area.
        primaryView.center = center;

        // Rotate the view 90 degrees around its new center point.
        transform = CGAffineTransformRotate(transform, (M_PI / 2.0));
        primaryView.transform = transform;
    }   

    self.view = primaryView;
    [primaryView release];  
} 
```

除此之外，我在根视图控制器中实现了以下委托方法：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation 
{
    return ( (interfaceOrientation == UIInterfaceOrientationLandscapeLeft) || (interfaceOrientation == UIInterfaceOrientationLandscapeRight));
} 
```

最后，我遇到了模拟器无法正确自动旋转的奇怪故障，因此我需要在我的 UIApplicationDelegate 中实现以下委托方法：

```
- (void)application:(UIApplication *)application willChangeStatusBarOrientation:(UIInterfaceOrientation)newStatusBarOrientation duration:(NSTimeInterval)duration;
{
    // This prevents the view from autorotating to portrait in the simulator
    if ((newStatusBarOrientation == UIInterfaceOrientationPortrait) || (newStatusBarOrientation == UIInterfaceOrientationPortraitUpsideDown))
        [application setStatusBarOrientation:UIInterfaceOrientationLandscapeRight animated:NO];
} 
```

毕竟，我的应用程序能够以横向（右）启动，并在 2.0 固件和模拟器中保持该方向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-11T03:52:41.013

尝试在笔尖中将视图的方向属性设置为横向。该属性可以在 Simulated Metrices 下 UIView 的 Info View 的第 4 个选项卡[Attributes Inspector] 中找到。

# wpf - 将 silverlight 应用程序转换为视频格式

> ID：525742
> 
> 赞同：2
> 
> 时间：2009-02-08T13:51:33.517
> 
> 标签：wpf, visual-studio, silverlight, video, expression-blend

我打算用 Silverlight 制作动画，我想将动画导出为视频格式，以便能够在视频共享网站上分享。

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T13:53:28.613

您可以使用像 Camtasia 这样的工具来记录您的屏幕或屏幕的一部分。然后可以将其导出为一堆不同的视频格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T22:12:50.457

纯代码方法是编写一系列图像，然后将这些图像组合在一起作为视频文件。Eric Gunnerson 有[从动画中捕获图像的](http://blogs.msdn.com/ericgu/archive/2007/02/27/taking-snapshots-of-wpf-animation.aspx)代码，它的 WPF 但可能在 Silverlight 中工作？Codeproject 有一个使用C#将[图像流转换为 AVI 视频文件的示例。](http://www.codeproject.com/KB/audio-video/avifilewrapper.aspx)它创建一个 AVI 输出。直接进入 mpg 会很棒，但是由于它是压缩的，因此输入需要是视频流。如果您确实需要 mpg 作为最终输出，请寻找现成的 avi->mpg 转换器。

顺便说一句 - 让我知道你的进展情况，我对这个解决方案的性能/功能感兴趣。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T05:40:59.943

MrTelly：这种方法行不通，因为 Silverlight 不公开 RenderTargetBitmap 类。（嗯，这并不完全正确，类是存在的，但是它的构造函数和方法都被标记为 SecurityCritical，因此通常无法访问。）

Jakers 提出的 Camtasia 解决方案可能是最简单的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T22:51:57.300

在**Silverlight**中没有一种简单的方法可以做到这一点，这真是太疯狂了，这在 Flash 中很容易。

# c# - C# convert object array into datatable

> ID：525744
> 
> 赞同：4
> 
> 时间：2009-02-08T13:51:54.327
> 
> 标签：c#

I failed to find a sample about how to convert an array instances of user defined types into a (C# ADO.Net) datatable -- I want to use the datatable to bind to ASP.Net data bound controls (e.g. gridview). Could anyone provide a sample or recommend me to some simple samples?

Another question is, whether it is a must to convert to datatable in order to bound to controls in ASP.Net? Could I bound to any array of user defined types?

thanks in advance, George

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-08T13:56:07.563

No, you don't need a `DataTable` to do binding - in fact, most binding now is object based, especially with LINQ (which generates an object model, not a `DataTable`). Just use the public property names (from your class) as the data-members for different columns, etc.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-01-15T01:09:40.390

我有同样的要求，我在 Pauls 博客上找到了一篇不错的文章。如果您仍然想要它，您可以查看以下链接

[http://weblogs.asp.net/psperanza/archive/2005/05/18/407389.aspx](http://weblogs.asp.net/psperanza/archive/2005/05/18/407389.aspx)

这是我在项目中使用的代码。希望有帮助

```
Public Function ConvertArrayToDatatable(ByVal arrList As ArrayList) As DataTable
    Dim dt As New DataTable
    Try
        If arrList.Count > 0 Then
            Dim arrype As Type = arrList(0).GetType()
            dt = New DataTable(arrype.Name)

            For Each propInfo As PropertyInfo In arrype.GetProperties()
                dt.Columns.Add(New DataColumn(propInfo.Name))
            Next

            For Each obj As Object In arrList
                Dim dr As DataRow = dt.NewRow()

                For Each dc As DataColumn In dt.Columns
                    dr(dc.ColumnName) = obj.GetType().GetProperty(dc.ColumnName).GetValue(obj, Nothing)
                Next

                dt.Rows.Add(dr)
            Next
        End If

        Return dt
    Catch ex As Exception
        Return dt
    End Try

End Function 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-08T16:06:03.573

我建议使用[ObjectDataSource](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasource.aspx)类来做你想做的事。然后，您根本不需要使用 DataTable，您仍然可以获取数据绑定。ObjectDataSource 允许你将用户定义的类型暴露给数据绑定，而不管这些类型是如何获得的；如果您需要的话，它们根本不需要来自数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-15T01:53:42.150

关于评论“由于非技术原因不能使用 LINQ”：

我认为您不想使用 LINQ to SQL，因为您想维护您的三层架构。但是您可能不知道您可以使用 LINQ to Objects 并提供您所寻求的灵活性。

假设您有一个中间层方法：List Tier2.SomeMethod()。您可以将该方法的返回值指定为 GridView 数据源，然后在 GridView 控件中指定 SomeObject 方法/属性： gvSomeGridView.DatasSource = Tier2.SomeMethod(); gvSomeGridView.DataBind();

此外，您可以从 GridView 回调中的 DataItem 检索 SomeObject。

HTH。

# excel - expand data into unmerged cells

> ID：525749
> 
> 赞同：0
> 
> 时间：2009-02-08T13:54:47.970
> 
> 标签：excel

I have a spreadsheet that has merged cells in it an I want to unmerge the cells and have the data expanded into the unmerge rows. How can I do this programetically or through macros?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T14:03:11.747

The way to un-merge cells is (through VBA scripting):

```
Range("A1").MergeCells = False 
```

# c# - 从系统托盘恢复应用程序

> ID：525751
> 
> 赞同：7
> 
> 时间：2009-02-08T13:56:15.817
> 
> 标签：c#, winapi, process

以编程方式恢复并关注系统托盘中运行的第三方应用程序（例如，GoogleTalk 或 Twhirl）的最佳方法是什么？我正在用 C# 编写我的实用程序，但我显然无法控制第三方应用程序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-08T22:08:52.230

使用 FindWindow / [FindWindowEx](http://msdn.microsoft.com/en-us/library/ms633500.aspx)之类的东西来查找隐藏的窗口并获取其窗口句柄，然后调用[ShowWindow](http://msdn.microsoft.com/en-us/library/ms633548(VS.85).aspx) (handle, SW_NORMAL) 来取消隐藏它。

使用 Spy++ 之类的工具（可以在 Visual Studio 工具菜单中找到）来查找可以传递给 FindWindow 以定位所需窗口的参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T15:16:04.610

使用 API 调用将鼠标点击事件发送到系统托盘？Google WM_SENDMSG SendMessage Win32 API 为起点

一旦窗口备份，还有另一个[API 调用用于设置焦点。](http://www.xmlauthor.com/help/Extensions/WindowsAPI/SetFocus.htm)

# ruby - 如何在 Google 中搜索语言语法？

> ID：525755
> 
> 赞同：4
> 
> 时间：2009-02-08T13:59:03.313
> 
> 标签：ruby, operators

我目前的问题是 << 运算符在 Ruby 中的作用是什么？但我真正的问题是如何搜索谷歌来找到答案？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-08T14:02:47.567

谷歌搜索“ruby 运算符”（不带引号），在新窗口中打开第一个链接，使用浏览器搜索“<<”（不带引号）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-08T14:03:10.420

“左移运算符红宝石”

如果您搜索单词和数字，Google 只会找到一些东西......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-08T23:33:04.697

如果您乐于使用 Google 以外的搜索引擎进行谷歌搜索，请尝试使用 symbolhound.com

[<< 红宝石](http://www.symbolhound.com/?q=%3C%3C%20ruby)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-08T18:07:39.053

[Google Code Search](http://www.google.com/codesearch)允许您搜索公共源代码存储库，因此也许您可以[在 Ruby 中找到“<<”的示例，](http://www.google.com/codesearch?q=%22%3C%3C%22+lang%3Aruby&hl=en&btnG=Search+Code)以帮助您了解发生了什么。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-08T23:19:00.500

使用“ruby 运算符”搜索 Joe Casadonte 建议找到您要查找的单词，然后使用这些单词进行谷歌搜索？

# makefile - Boost::Jam (bjam) 有“提问模式”吗？

> ID：525756
> 
> 赞同：1
> 
> 时间：2009-02-08T13:59:30.520
> 
> 标签：makefile, codeblocks, bjam

我将 Code::Blocks 与 Boost::Jam 一起使用。最近对 C::B 的更新添加了一些新的“自定义生成文件”命令，其中之一是“询问是否需要重建”。根据[此消息](http://forums.codeblocks.org/index.php?topic=9941.msg69682#msg69682)，它意味着以`make`“问题模式”调用：

> -q, --question
> ''问题模式''。不要运行任何命令，或打印任何东西；如果指定的目标已经是最新的，则只返回一个退出状态为零，否则返回非零。

不幸的是，Boost::Jam 文档没有在`bjam`. 我已经通过使用这个命令来解决它......

```
bjam -error 
```

...这会强制`bjam`返回 1 的错误级别（因为它无法识别 option `-e`）并使 C::B 始终运行构建命令，但我更愿意按预期使用它。

**我的问题：**确实`bjam`有这样的“问题模式”，但我还没有找到它，或者 Jamfile 中有什么方法可以让它以这种方式工作？该`-n`选项不起作用，因为它总是返回零，C::B 将其解释为“所有文件都是最新的”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T18:06:57.630

显然它没有。

# python - Accept Cookies in Python

> ID：525773
> 
> 赞同：11
> 
> 时间：2009-02-08T14:09:04.790
> 
> 标签：python, cookies

How can I accept cookies in a python script?

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-08T23:49:44.670

尝试这个：

```
import urllib2 
import cookielib

jar = cookielib.FileCookieJar("cookies")
opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(jar))

print "Currently have %d cookies" % len(jar)
print "Getting page"
response = opener.open("http://google.com")
print response.headers
print "Got page"
print "Currently have %d cookies" % len(jar)
print jar 
```

它应该打印

```
Currently have 0 cookies
...
Currently have 2 cookies 
```

（谷歌总是设置一个 cookie）。除非您想将 cookie 保存到磁盘并稍后使用它们，否则您实际上并不需要这么多。你应该发现

```
urllib2.build_opener(HTTPCookieProcessor).open(url) 
```

照顾你想要的大部分。

更多信息在这里：

*   [HTTPCookie处理器](http://docs.python.org/library/urllib2.html#urllib2.HTTPCookieProcessor)
*   [build_opener](http://docs.python.org/library/urllib2.html#urllib2.urlopen)
*   [文件CookieJar](http://docs.python.org/library/cookielib.html#cookielib.FileCookieJar)
*   [Urllib2 - 丢失的 maual](http://www.voidspace.org.uk/python/articles/urllib2.shtml)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-17T09:02:21.267

**最简单的方法是使用[请求](http://docs.python-requests.org/)库。**

```
import requests
url = 'http://www.google.com/doodles/'
r = requests.get(url)
print r.cookies 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-08T14:15:20.207

You might want to look at [cookielib](http://docs.python.org/library/cookielib.html).

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-08T16:49:40.410

目前尚不清楚您是否需要客户端或服务器端解决方案。

对于客户端，[cookielib](http://www.docs.python.org/library/cookielib.html)可以正常工作。 [这个答案](https://stackoverflow.com/questions/189555/how-to-use-python-to-login-to-a-webpage-and-retrieve-cookies-for-later-usage#answer-189580)和一些网络教程提供了更深入的解释。

如果这是服务器端问题，您应该使用处理所有样板的框架。我真的很喜欢[CherryPy](http://www.cherrypy.org/wiki/Cookies)和[web.py](http://webpy.org/cookbook/cookies)处理它们的方式，但是 API 在任何库中都非常简单。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-08T16:14:19.453

我相信您的意思是拥有一个尝试使用 HTTP 的 Python 脚本。我建议您使用自动处理 cookie 的高级库。pycurl、mechanize、twill - 你选择。

对于尼基尔切利亚：

我看不出这里有什么不清楚的地方。

**接受**cookie 发生在客户端。服务器可以**设置**cookie。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-08T16:24:59.493

有 cookielib 库。你也可以实现自己的cookie存储和策略，cookie是在响应的set-cookie header中找到的（Set-Cookie:name=value），然后你在一个或多个cookie header中发送回服务器请求（Cookie：名称=值）。

# c# - 可以在 .net 中扩展 String 类

> ID：525797
> 
> 赞同：6
> 
> 时间：2009-02-08T14:26:07.423
> 
> 标签：c#, .net

如何覆盖或扩展 .net 主类。例如

```
public class String
{
    public boolean contains(string str,boolean IgnoreCase){...}
    public string replace(string str,string str2,boolean IgnoreCase){...}
} 
```

后

```
string aa="this is a Sample";
if(aa.contains("sample",false))
{...} 
```

是否可以？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-08T14:33:05.507

String 类是密封的，因此您不能从它继承。扩展方法是您最好的选择。它们具有与实例方法相同的**感觉**，而无需继承成本。

```
public static class Extensions {
  public static bool contains(this string source, bool ignoreCase) {... }
}

void Example {
  string str = "aoeeuAOEU";
  if ( str.contains("a", true) ) { ... }
} 
```

您需要使用 VS 2008 才能使用扩展方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T14:29:13.923

String 类是密封的，因此您不能扩展它。如果您想添加功能，您可以使用扩展方法或将其包装在您自己的类中并提供您需要的任何附加功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-08T16:58:51.330

一般来说，您应该尝试看看是否有另一种方法可以以类似的方式满足您的需求。对于您的示例，`Contains`实际上是一个包装器方法`IndexOf`，`true`如果返回值大于 0，则返回，否则`false`。碰巧，该`IndexOf`方法有许多重载，其中之一是`IndexOf( string, StringComparison ): Int32`，它可以指定为尊重或忽略大小写。

See [String.IndexOf Method (String, StringComparison) (System)](http://msdn.microsoft.com/en-us/library/ms224425.aspx) for more information, although the example is a little weird.

See [StringComparison Enumeration (System)](http://msdn.microsoft.com/en-us/library/system.stringcomparison.aspx) for the different options available when using the `StringComparison` enumeration.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-08T15:12:14.587

您还可以使用适配器模式来添加其他功能。您可以进行运算符重载，使其感觉像内置字符串。当然，对于“字符串”的现有使用，这不会是自动的，但如果可能的话，您直接从它继承的解决方案也不会。

# c++ - 如何信任声明 const 的 C++ 函数的行为？

> ID：525803
> 
> 赞同：4
> 
> 时间：2009-02-08T14:28:28.700
> 
> 标签：c++, memory-management

这是一场 C++ 灾难，请查看以下代码示例：

```
#include <iostream>

void func(const int* shouldnotChange)
{
    int* canChange = (int*) shouldnotChange;
    *canChange += 2;
    return;
}

int main() {
    int i = 5;
    func(&i);
    std::cout << i;
    return 0;
} 
```

输出为 7！

那么，如果 C++ 函数能够更改一个假定为常量的参数，我们如何确保它的行为！？

编辑：我不是在问如何确保**我的**代码按预期工作，而是我想知道如何相信其他人的函数（例如某些 dll 库中的某些函数）不会更改参数或拥有一些行为...

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-08T15:38:46.280

根据您的编辑，您的问题是“我怎么能相信 3rd 方代码不愚蠢？”

简短的回答是“你不能”。如果您无法访问源代码，或者没有时间检查它，您只能相信作者编写了健全的代码。在您的示例中，函数声明的作者明确声称代码不会使用 const 关键字更改指针的内容。你可以相信这个说法，也可以不相信。正如其他人所建议的那样，有一些测试方法，但是如果您需要测试大量代码，这将是非常劳动密集型的。也许比阅读代码更重要。

如果你在一个团队中工作并且你有一个团队成员在写这样的东西，那么你可以和他们谈谈并解释它为什么不好。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-08T14:32:08.303

通过编写理智的代码。如果您编写的代码无法信任，那么显然您的代码将不值得信任。几乎任何语言都可能出现类似的愚蠢技巧。在 C# 中，您可以通过反射在运行时修改代码。您可以检查和更改私人班级成员。你如何防止这种情况发生？你不需要，你只需要编写行为符合你期望的代码。

除此之外，编写一个单元测试测试该函数不会更改其参数。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-08T18:08:13.187

C++ 的一般规则是该语言旨在保护您免受[Murphy](http://en.wikipedia.org/wiki/Murphys_law)的侵害，而不是[Machiavelli](http://en.wikipedia.org/wiki/Niccol%C3%B2_Machiavelli)的侵害。换句话说，它的目的是防止维护程序员意外更改标记为 const 的变量，而不是防止某人故意更改它，这可以通过多种方式完成。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-08T14:58:23.927

C 风格的演员表意味着所有的赌注都被取消了。这有点像告诉编译器“相信我，我知道这看起来很糟糕，但我需要这样做，所以不要告诉我我错了。” 此外，您所做的实际上是未定义的。抛弃 const-ness 然后*修改*值意味着编译器/运行时可以做任何事情，包括例如使您的程序崩溃。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-08T14:53:23.813

不要在 C++ 中使用 C 风格的强制转换。
我们在 C++ 中有 4 个强制转换运算符（此处按危险顺序列出）

*   static_cast<> 安全（用于“转换数字数据类型”时）。
*   dynamic_cast<> 安全（但抛出异常/返回 NULL）
*   const_cast<> 危险（删除 const 时）。
*   static_cast<> 非常危险（当用于转换指针类型时。不是一个好主意！！！！！！）
*   reinterpret_cast<> 非常危险。仅当您了解后果时才使用它。

您总是可以告诉编译器您比它更了解，并且编译器会从表面上接受您（原因是您不希望编译器在您实际了解更多时妨碍您）。

对编译器的控制是一把两刃剑。如果你知道你在做什么，它是一个强大的工具，它会有所帮助，但如果你做错了，它会在你的脸上炸开。

不幸的是，编译器对大多数事情都有原因，所以如果你覆盖它的默认行为，那么你最好知道你在做什么。演员是其中之一。很多时候都很好。但是，如果您开始抛弃 const(ness)，那么您最好知道自己在做什么。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-08T15:24:27.230

我唯一能建议的是`shouldNotChange`从标记为只读的内存页面分配变量。如果应用程序尝试写入该内存，这将强制 OS/CPU 引发错误。我真的不建议将其作为验证函数的通用方法，就像您可能会发现有用的想法一样。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-08T18:27:14.707

执行此操作的最简单方法是不传递指针：

```
void func(int shouldnotChange); 
```

现在将复制该论点。该函数可以随意更改值，但不会修改原始值。

如果您不能更改函数的接口，那么您可以在调用函数之前复制该值：

```
int i = 5;
int copy = i
func(&copy); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-08T14:36:05.750

`(int*)`是来自 C 的强制转换语法。C++ 完全支持它，但不推荐。

在 C++ 中，等效的强制转换应该是这样编写的：

```
int* canChange = static_cast<int*>(shouldnotChange); 
```

事实上，如果你这样写，编译器就不会允许这样的转换。

您正在做的是编写 C 代码并期望 C++ 编译器能够发现您的错误，如果您考虑一下，这有点不公平。

# ruby-on-rails - 您如何指定模型的“只读”行为？

> ID：525805
> 
> 赞同：1
> 
> 时间：2009-02-08T14:28:59.790
> 
> 标签：ruby-on-rails, rspec, bdd

例如，假设我有一个`Question`模型，它具有布尔字段`answered`和`closed`. `should be read only when marked as answered`我将如何使用 RSpec测试问题的行为？这似乎是模型的行为，但我不确定如何最好地测试它。我是否应该为此行为使用 before 过滤器，并添加一个错误，说明您无法修改已回答的问题？或者有更好的方法吗？我只学习 RSpec 和 BDD。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T06:51:49.397

取决于你需要它如何工作，但是......

```
describe Question do
  it "should be read only when marked as answered" do
    question = Question.new(:title => 'old title')
    question.answered = true
    question.save

    # this
    lambda {
      question.title = 'new title'
    }.should raise_error(ReadOnlyError)

    # or
    question.title = 'new title'
    question.save
    question.title.should == 'old title'

    # or
    quesiton.title = 'new title'
    question.save.should be_false
  end
end 
```

或者您可能希望在保存时引发错误？或者也许没有错误，它只是默默地不改变值？如何实现它取决于您，但方法是相同的。

1.  将您的对象设置为您想要指定它们的状态
2.  确保你的对象在那个状态下做你所期望的

所以设置一个已回答的问题，然后看看你是否可以更改它的数据。如果你不能，那么规范通过了。这取决于您希望模型的行为如何工作。BDD 的伟大之处在于您首先考虑这个接口，因为您必须实际使用对象 API 才能对其进行规范。

# windows - 干扰性能测量的 Windows 系统空闲进程

> ID：525807
> 
> 赞同：1
> 
> 时间：2009-02-08T14:30:10.803
> 
> 标签：windows, performance, python-idle

我正在 Windows 机器上对我的代码进行一些性能测量，我发现我在测量之间得到了截然不同的结果。在任务管理器系统空闲进程中显示了一个缓慢的临时探索，占用了几乎 100% 的 CPU。

有谁知道系统空闲进程的实际含义以及它可能运行的 Windows 功能？

注意：我没有使用任务管理器来衡量性能，我只是用它来看看在特别慢的测量期间还有什么正在运行。

在说这与编程无关并结束问题之前请三思。除非我认为有理由说它是，否则我不会问它。在这种情况下，我认为这显然是因为它对我的开发和测试环境产生了不利影响，为了解决这个问题，我需要更多地了解它。编程不以编写代码开始和结束。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-08T15:36:00.310

空闲进程通常不做任何有用的工作，除了执行`HLT`指令，这会使 CPU 内核进入低功耗状态 ( [C1](http://en.wikipedia.org/wiki/C_state#Power_States) )。但是，您的基准测试并未消耗 100% 的 CPU 时间这一事实确实为推测正在发生的事情打开了大门。

如果您的应用程序是单线程的并且您的测试系统是多核/超线程/多 CPU，那么您应该会看到大约 50% 的空闲 CPU 时间用于两个内核，75% 用于四个内核，等等。这是因为 CPU 时间百分比在任务管理器中包括所有核心。（我相信旧版本的 Windows 可以选择更改这一点，但我在 Vista 上看不到它。）

如果空闲进程消耗大量 CPU，这可能表明您的应用程序正在花费大量时间休眠。它可能正在等待来自某些外部源（例如磁盘或网络）的数据。它可能会花费大量时间等待同步对象（例如互斥锁或事件）。它也可能会花费大量时间调用该`Sleep()`函数。分析您的代码应该确定它在哪里花费时间。

获得完全可重现的基准测试结果可能需要您禁用处理器/磁​​盘/网络密集型后台应用程序和服务（例如搜索索引、SMS 软件清单、病毒扫描、Windows 更新下载、IncrediBuild/distcc）或将计算机连接到隔离网络（或根本没有网络）。

我假设您为您的应用程序编写了一个基准测试，并且您只是尝试使用任务管理器来诊断为什么基准测试结果与您的预期不符。任务管理器不是衡量应用程序性能的准确方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T14:44:07.887

系统空闲进程是一种默认进程，当 Windows 没有其他计划运行时，它会在处理器上运行。这个过程就像一个管家，做一些事情，比如试图节省系统电源等。

如果您要测量程序的性能，请不要使用 Windows 任务管理器。改用性能监视器（您可以通过在命令行中键入“perfmon”开始）。或者更好的是，使用[profiler](http://en.wikipedia.org/wiki/Profiler_(computer_science))。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-08T15:48:44.747

如果你的“系统空闲进程”占用了 100%，那么基本上你的机器很无聊，什么都没有发生。如果您将任务管理器中发生的所有事情加起来，从 100% 中减去这个数字，那么您将得到“系统空闲进程”的值。请注意，它几乎不消耗任何内存，并且不会影响性能。

# common-lisp - 我可以在 defstruct 中引用其他插槽吗？

> ID：525815
> 
> 赞同：4
> 
> 时间：2009-02-08T14:33:25.320
> 
> 标签：common-lisp

在普通的 lisp 中，我注意到我可以这样写：

```
(defun foo (&key (a 1) (b 2) (c (+ a b))) (print (+ a b c))) 
```

当我打电话时`(foo)`，`6`会打印出来。所以参数`c`可以引用为`a`和设置的值`b`。但我似乎无法找到一种方法来做类似的事情`defstruct`。就像是：

```
CL-USER> (defstruct thing a b c)
THING
CL-USER> (setq q (make-thing :a 1 :b 2 :c (+ a b)))
; Evaluation aborted
CL-USER> (setq q (make-thing :a 1 :b 2 :c (+ :a :b)))
; Evaluation aborted 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-09T09:10:13.463

您可以使用`:constructor`的选项来执行此操作`defstruct`。

```
CL-USER> (defstruct (thing
                      (:constructor make-thing (&key a b (c (+ a b)))))
           a b c)
THING
CL-USER> (make-thing :a 1 :b 2)
#S(THING :A 1 :B 2 :C 3) 
```

For more info, see CLHS entry for [`defstruct`](http://www.lispworks.com/documentation/HyperSpec/Body/m_defstr.htm#defstruct).

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-08T14:36:47.230

不是那样的。但是使用 Lisp 阅读器技巧，您可以做到：

```
(make-thing :a #1=1 :b #2=2 :c (+ #1# #2#)) 
```

否则使用`defclass`并专门化泛型函数`shared-initialize`。

请注意，这些阅读器宏将引用*表单*，而不是评估它的结果。因此

```
(make-thing :id #1=(generate-unique-id) :my-id-is #1#) 
```

将对 a`thing`进行*两次不同的*调用`generate-unique-id`。

# javascript - 在 IE7 中显示 javascript 生成的 div

> ID：525816
> 
> 赞同：0
> 
> 时间：2009-02-08T14:33:38.500
> 
> 标签：javascript, html, internet-explorer-7

下面的代码展示了我对 Firefox 和 Chrome 的期望：一个绿色的大矩形中的一个白色小方块。我没有看到 IE7 中的小方块。我怎样才能让它出现？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Insert title here</title>
<script type="text/javascript">
<!--
function start()
{
    var g_Div = document.getElementById("bigdiv");
    var littleDiv = document.createElement('div');
    littleDiv.setAttribute('style', 
        'position:absolute;'+
        'left:300px;'+
        'top:300px;'+
        'width:5px;'+
        'height:5px;'+
        'clip:rect(0pt,5px,5px,0pt);'+
        'background-color: rgb(255, 255, 255);');
    g_Div.appendChild(littleDiv);
}
//-->
</script>
</head>
<body>
<div 
    id="bigdiv" 
    style="border: 1px solid ; margin: auto; height: 600px; width: 800px; background-color: green;" 
    >   
</div>
<script type="text/javascript">
<!--
start();
//-->
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-08T14:43:17.810

这应该可以满足您的需求，并且应该可以在主要浏览器中使用：

```
function start()
{
    var g_Div = document.getElementById("bigdiv");
    var littleDiv = document.createElement('div');
    littleDiv.style.background = 'rgb(255, 255, 255)';
    littleDiv.style.width = '5px';
    littleDiv.style.height = '5px';
    littleDiv.style.left = '300px';
    littleDiv.style.top = '300px';
    littleDiv.style.position = 'absolute';
    g_Div.appendChild(littleDiv);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T14:48:31.607

使用这种方法来改变元素的样式：-

```
littleDiv.style.cssText = 'position:absolute;'+
    'left:300px;'+
    'top:300px;'+
    'width:5px;'+
    'height:5px;'+
    'clip:rect(0pt,5px,5px,0pt);'+
    'background-color: rgb(255, 255, 255)'; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-08T14:50:22.383

`setAttribute`在 IE 中非常没用，尤其是对于 style 属性。
您可能必须使用`class`或`element.style."propertyName"`

[quirksmode 兼容性图表](http://www.quirksmode.org/dom/w3c_core.html#t1010)

# .net - 使用 Reflector，为什么我看不到我的 .NET 应用程序中嵌入的 app.manifest？

> ID：525829
> 
> 赞同：3
> 
> 时间：2009-02-08T14:41:11.967
> 
> 标签：.net, visual-studio, windows-vista, uac, reflector

我有一个 WinForms .NET 应用程序，根据启用了 UAC 的 Vista 任务管理器，即使我不记得向应用程序添加带有“asInvoker”的清单，它也会在虚拟化“已禁用”的情况下运行。VS.NET（这个项目已经通过了所有四个版本的 VS.NET）必须添加了我在解决方案资源管理器中看到的**\Properties\app.manifest**文件，但是这个文件不包含我希望禁用虚拟化的**trustinfo**元素. 所以我启动了 Reflector 以查看可能嵌入到我的实际可执行文件中的内容，但我找不到 app.manifest 文件。我应该能够在可执行文件中找到它的清单或标志吗？根据 VS 2008，构建动作是**BaseApplicationManifest**，但这是否意味着它没有嵌入到可执行文件中？如果我没有要求，有人可以解释为什么我的应用程序在禁用虚拟化的情况下运行，并且一旦解释，有人可以指出我在哪里找到通过反射器在我的应用程序中导致此问题的工件？

作为 app.manifest 在我的解决方案中的后续行动，谁知道多久，它充满了我不确定我是否需要的各种 IPermissions。什么向这个文件添加了内容，它是否可以包含我不再需要的权限？应该修剪还是管理？我应该明确添加 trustinfo 吗？我猜 app.manifest 只是一个我需要进一步了解的谜团。

**更新：**从[这篇文章中](http://technet.microsoft.com/en-us/magazine/2007.06.uac.aspx)，我了解到我可以使用 SysInternals/Microsoft Sigcheck 实用程序来查看以下信息，但我不知道我的应用程序是如何使用 MyApplication.app 进行签名的。这在构建过程中发生在哪里？

```
c:\Users\Public\Programs\SysinternalsSuite>sigcheck.exe -m ceo.exe

sigcheck v1.54 - sigcheck
Copyright (C) 2004-2008 Mark Russinovich
Sysinternals - www.sysinternals.com

"c:\Users\Public\Programs\SysinternalsSuite\ceo.exe":
        Verified:       Unsigned
        File date:      1:47 PM 2/6/2009
        Publisher:      CEO Image Systems
        Description:    Main Menu
        Product:        Image Executive CEO
        Version:        2.0.0.0
        File version:   2.0.0.0
        Manifest:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
  <assemblyIdentity version="1.0.0.0" name="MyApplication.app"/>
  <trustInfo xmlns="urn:schemas-microsoft-com:asm.v2">
    <security>
      <requestedPrivileges xmlns="urn:schemas-microsoft-com:asm.v3">
        <requestedExecutionLevel level="asInvoker" uiAccess="false"/>
      </requestedPrivileges>
    </security>
  </trustInfo>
</assembly> 
```

**更新2：**看起来我最终会到达那里。VS 2008在可执行文件的项目页面上添加了一个**Manifest选项，我的项目为此选择了“使用默认设置嵌入清单”。**所以这回答了它是如何到达那里的，但是我如何在 Reflector 中看到它呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-09T19:30:58.637

反射器不允许您查看非托管资源。您不需要特殊工具，只需使用 Visual Studio 的 File + Open + File 并选择您的 .exe 即可浏览资源。清单可通过 RT_MANIFEST 节点访问。观众不是很友好，你会得到一个十六进制转储。您可以使用上下文菜单将其导出到文本文件。

C# 和 VB.NET 编译器会自动生成与 Vista 兼容的清单。[您可以使用/win32manifest 命令行选项](http://msdn.microsoft.com/en-us/library/bb545961.aspx?ppud=4)覆盖它。当您使用 Project + Add New Item + Application Manifest File 时，IDE 会自动执行此操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-08T17:02:36.440

也许它是一个win32资源，因此反射器看不到？[您可以使用像这样](http://www.wilsonc.demon.co.uk/d10resourceeditor.htm)的 win32 资源编辑器查看 win32 资源。

# .net - 检测并重新启动我崩溃的 .NET 应用程序

> ID：525832
> 
> 赞同：11
> 
> 时间：2009-02-08T14:42:38.920
> 
> 标签：.net

如何检测到我的 .NET 应用程序已崩溃，然后重新启动它？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-08T14:44:09.103

另一种解决方案（基于[此示例](http://community.bartdesmet.net/blogs/bart/archive/2006/08/30/4366.aspx)）是创建一个控制应用程序的启动器：

```
class LauncherProgram
{
    static int count = 3;

    static void Main()
    {
        Launch();
        Thread.Sleep(Timeout.Infinite);
    }

    static void Launch()
    {
        Process process = new Process();
        process.StartInfo.FileName = "MyApp.exe";
        process.EnableRaisingEvents = true;
        process.Exited += LaunchIfCrashed;
    }

    static void LaunchIfCrashed(object o, EventArgs e)
    {
        Process process = (Process) o;
        if (process.ExitCode != 0)
        {
            if (count-- > 0) // restart at max count times
                Launch();
            else
                Environment.Exit(process.ExitCode);
        }
        else
        {
            Environment.Exit(0);
        }
    } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-08T17:18:05.160

如果这是一个 Windows 窗体应用程序：

*   在 App.Config 中设置**jitDebugging = true**。这可以防止触发内置的 Windows 窗体未处理的异常处理程序。

现在无论这是 Windows 窗体应用程序还是控制台应用程序：

*   注册**Application.ThreadException**事件，例如在 C# 中：

    Application.ThreadException += new Threading.ThreadExceptionHandler(CatchFatalException);

此时，您的应用程序已经进入黑洞。接下来会发生什么取决于这是否是 Windows 窗体应用程序：

*   如果它是 Windows 窗体应用，请在**CatchFatalException**事件处理程序中调用[Application.Restart](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.restart.aspx)方法。
***   Otherwise you will instead need to p/invoke to the [application restart and recovery](http://community.bartdesmet.net/blogs/bart/archive/2006/11/11/Windows-Vista-Application-Recovery-with-C_2300_.aspx) native functions. That link discusses Vista, but in my tests it works just fine on XP as well.**

 *** * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-08T14:44:44.563

*   在 AppDomain 中运行工作；使用主 AppDomain 来监控它（虽然不能防止进程终止）
*   大量异常处理！即不要让致命错误破坏进程
*   在已经内置回收的东西中运行它 - 例如 IIS

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-08T14:43:25.597

一个可能的解决方案是创建另一个进程来监视您的应用程序，并在它终止时重新启动它：

```
class ProcessMonitorProgram
{
    const string myProcess = "MyApp.exe";

    static void Main()
    {
        new Timer(CheckProcess, null, 0, 60 * 1000);
        Thread.Sleep(Timeout.Infinite);
    }

    static void CheckProcess(object obj)
    {
        if (Process.GetProcessesByName(myProcess).Length == 0)
            Process.Start(myProcess);
    }
} 
```

此解决方案的问题之一是它将使进程永远重新启动，直到此监视应用程序本身终止。

# java - 使用 Tab 键从 JTextArea 移动焦点

> ID：525855
> 
> 赞同：32
> 
> 时间：2009-02-08T14:50:19.733
> 
> 标签：java, swing, netbeans

如前所述，我想更改 a 中的默认 TAB 行为`JTextArea`（使其像一个`JTextField`或类似的组件一样）

这是事件动作

```
private void diagInputKeyPressed(java.awt.event.KeyEvent evt) {
    if(evt.KEY_PRESSED == java.awt.event.KeyEvent.VK_TAB) {
        actionInput.transferFocus();
    }
} 
```

这是听众

```
diagInput.addKeyListener(new java.awt.event.KeyAdapter() {
    public void keyPressed(java.awt.event.KeyEvent evt) {
        diagInputKeyPressed(evt);
    }
}); 
```

我也没有高兴地尝试过 evt.KEY_TYPED 。

有任何想法吗？

快速编辑：我也试过`requestFocus()`代替`transferFocus()`

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-08T14:56:57.520

根据[这个类](http://www.koders.com/java/fidEFE6DD3BBD50DC8AAAE60012E847110CBE3EF7A8.aspx?s=mdef%3Ainsert)：

```
/**
 * Some components treat tabulator (TAB key) in their own way.
 * Sometimes the tabulator is supposed to simply transfer the focus
 * to the next focusable component.
 * <br/>
 * Here s how to use this class to override the "component's default"
 * behavior:
 * <pre>
 * JTextArea  area  = new JTextArea(..);
 * <b>TransferFocus.patch( area );</b>
 * </pre>
 * This should do the trick. 
 * This time the KeyStrokes are used.
 * More elegant solution than TabTransfersFocus().
 * 
 * @author kaimu
 * @since 2006-05-14
 * @version 1.0
 */
public class TransferFocus {

    /**
     * Patch the behaviour of a component. 
     * TAB transfers focus to the next focusable component,
     * SHIFT+TAB transfers focus to the previous focusable component.
     * 
     * @param c The component to be patched.
     */
    public static void patch(Component c) {
        Set<KeyStroke> 
        strokes = new HashSet<KeyStroke>(Arrays.asList(KeyStroke.getKeyStroke("pressed TAB")));
        c.setFocusTraversalKeys(KeyboardFocusManager.FORWARD_TRAVERSAL_KEYS, strokes);
        strokes = new HashSet<KeyStroke>(Arrays.asList(KeyStroke.getKeyStroke("shift pressed TAB")));
        c.setFocusTraversalKeys(KeyboardFocusManager.BACKWARD_TRAVERSAL_KEYS, strokes);
    }
} 
```

请注意，根据[Joshua Goldberg](https://stackoverflow.com/users/411282/joshua-goldberg)在[评论](https://stackoverflow.com/questions/525855/moving-focus-from-jtextarea-using-tab-key/525867#comment37587468_525867)`patch()`中的说法，它可以更短，因为目标是恢复被以下内容覆盖的默认行为：`JTextArea`

```
component.setFocusTraversalKeys(KeyboardFocusManager.FORWARD_TRAVERS‌​AL_KEYS, null);
component.setFocusTraversalKeys(KeyboardFocusManager.BACKWARD_TRAVERS‌​AL_KEYS, null); 
```

这用于问题“[如何修改选项卡键的行为`JTextArea`？](https://stackoverflow.com/a/5043957/6309) ”

* * *

[以前](http://www.koders.com/java/fid0F02F3C453624EDF1564C356CC30EFC1561774E9.aspx?s=mdef%3ainsert)的实现确实涉及 a`Listener`和 a `transferFocus()`：

```
 /**
     * Override the behaviour so that TAB key transfers the focus
     * to the next focusable component.
     */
    @Override
    public void keyPressed(KeyEvent e) {
        if(e.getKeyCode() == KeyEvent.VK_TAB) {
            System.out.println(e.getModifiers());
            if(e.getModifiers() > 0) a.transferFocusBackward();
            else a.transferFocus(); 
            e.consume();
        }
    } 
```

`e.consume();`可能是您错过了使其适用于您的情况的原因。

# .net - Bind POCO to UserControl

> ID：525870
> 
> 赞同：2
> 
> 时间：2009-02-08T15:00:35.063
> 
> 标签：.net, data-binding, poco

Hi I am in the process of writing my first .net gui. I am wondering if there is some specific way I need to apply to my poco objects for them to be bindable to a usercontrol. I have a few objects but I seem to be unable to bind them to my usercontrol.

I read somewhere that they need to implement IBindable but I can't shake the feeling that someone already has eliminated all that duplicate code I would have to input into all my classes. Is there a way to easily bind these or would I have to use datasets or the like to be easily get this binding working. I have an extreme distaste for datasets to please present some other decent options ;-)

I am trying to bind to usercontrols from the devexpress toolkit.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T15:40:46.557

哪种架构？

对于单向绑定，除了公共属性之外，您不需要任何其他东西 - 可能还有任何定制数据类型（ s 等）的一些`TypeConverter`实现`struct`

对于完整的 2 路绑定，您需要一个事件实现 - 任何一个：

*   每个属性“Foo”的“公共事件 EventHandler FooChanged”
*   一个`INotifyPropertyChanged 实现
*   一个定制的组件模型（不要去那里 - 矫枉过正）

对于`INotifyPropertyChanged`实现的示例（请注意，您可能希望移动一些代码以供重用）：

```
public class Foo : INotifyPropertyChanged
{
    private string bar;
    public string Bar
    {
        get { return bar; }
        set { UpdateField(ref bar, value, "Bar"); }
    }
    // other properties...

    public event PropertyChangedEventHandler PropertyChanged;

    protected virtual void OnPropertyChanged(string propertyName)
    {
        if (PropertyChanged != null) PropertyChanged(this,
            new PropertyChangedEventArgs(propertyName));
    }
    protected bool UpdateField<T>(ref T field, T value,
        string propertyName)
    {
        if (!EqualityComparer<T>.Default.Equals(field, value))
        {
            field = value;
            OnPropertyChanged(propertyName);
            return true;
        }
        return false;
    }
} 
```

要绑定数据*集*（网格等），最简单的方法是使用泛型；基本上，*最小值*是`IList`- 但你从`public T this[int index]`索引器获得额外的元数据 -`List<T>`等等`Collection<T>`都有。更多 -`BindingList<T>`实现`IBindingList`允许基于集合的通知事件（但仅限于`INotifyPropertyChanged`- 不是`FooChanged`模式）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T15:11:00.797

使用 WPF，您将需要[`INotifyPropertyChanged`](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)Dependency [Properties](http://msdn.microsoft.com/en-us/library/ms750428.aspx)。还可以查看[`INotifyCollectionChanged`](http://msdn.microsoft.com/en-us/library/system.collections.specialized.inotifycollectionchanged.aspx)收藏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T15:25:13.030

[BindingList](http://msdn.microsoft.com/en-us/library/ms132683.aspx)可用于绑定到通用对象列表。

# bash - bash脚本中的回显制表符

> ID：525872
> 
> 赞同：388
> 
> 时间：2009-02-08T15:05:27.533
> 
> 标签：bash, tabs, echo, spaces

如何使用 bash 脚本回显一个或多个制表符？当我运行这段代码

```
res='       'x # res = "\t\tx"
echo '['$res']' # expect [\t\tx] 
```

我明白了

```
res=[ x] # that is [<space>x] 
```

* * *

## 回答 #1

> 赞同：641
> 
> 时间：2009-02-08T15:08:03.160

```
echo -e ' \t ' 
```

将回显“空格制表符空格换行符”（`-e`表示“启用反斜杠转义解释”）：

```
$ echo -e ' \t ' | hexdump -C
00000000  20 09 20 0a                                       | . .| 
```

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2011-11-17T01:59:09.597

使用`printf`，不使用`echo`。

该命令有多个不同版本`echo`。有`/bin/echo`（可能是也可能不是 GNU Coreutils 版本，具体取决于系统），并且该`echo`命令内置于大多数 shell 中。不同的版本有不同的方式（或没有方式）来指定或禁用控制字符的转义。

`printf`，另一方面，变化要小得多。它通常可以作为命令存在`/bin/printf`，并且它内置在某些 shell 中（bash 和 zsh 有它，tcsh 和 ksh 没有），但各种版本彼此之间的相似性远高于`echo`are 的不同版本。而且您不必记住命令行选项（除了少数例外；GNU Coreutils printf 接受`--version`and `--help`，并且内置 bash printf 接受`-v var`将输出存储在变量中）。

对于您的示例：

```
res='           'x # res = "\t\tx"
printf '%s\n' "[$res]" 
```

现在是时候让我承认这`echo`对于您所询问的示例也同样有效；你只需要在参数周围加上双引号：

```
echo "[$res]" 
```

正如 kmkaplan 所写（两年半前，我才注意到！）。您原始命令的问题：

```
res='           'x # res = "\t\tx"
echo '['$res']' # expect [\t\tx] 
```

不与`echo`; 这是外壳在`echo`看到它之前用空格替换了选项卡。

`echo`适用于简单的输出，例如，但是当你想做更复杂的事情时`echo hello world`，你应该使用它。`printf`您*可以*开始`echo`工作，但是当您使用不同的`echo`实现或不同的 shell 运行生成的代码时，它可能会失败。

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2009-12-10T23:07:53.937

你也可以试试：

```
echo Hello$'\t'world. 
```

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2009-02-08T15:10:12.937

把你的字符串放在**双**引号之间：

```
echo "[$res]" 
```

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2009-02-08T15:10:12.873

你需要使用 -e 标志来回显然后你可以

```
echo -e "\t\t x" 
```

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2015-12-02T10:43:41.190

从 bash 手册页：

> $'string' 形式的单词被特殊处理。该单词扩展为字符串，并按照 ANSI C 标准的规定替换反斜杠转义字符。

所以你可以这样做：

```
echo $'hello\tworld' 
```

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2016-05-06T02:48:37.140

使用逐字击键`^V`( `CTRL+V`, `C-v`,*不管*)。

当您`^V`在终端（或在大多数 Unix 编辑器中）键入时，以下字符将被*逐字*显示。您可以使用它在要回显的字符串中键入文字制表符。

类似以下的工作：

```
echo "^V<tab>"     # CTRL+V, TAB 
```

[Bash 文档](http://web.mit.edu/gnu/doc/html/features_7.html#SEC54)( *qv* , "quoted-insert")

> 引用插入 (Cq, Cv) 将您键入的下一个字符逐字添加到行中。例如，这就是插入 Cq 等键序列的方法。

*旁注：根据这个，* `ALT+TAB` *应该做同样的事情，但我们都将该序列绑定到窗口切换，所以我们不能使用它*

> 制表符插入 (M-TAB) 插入制表符。

--

注意：您可以将此策略用于各种不寻常的字符。像回车一样：

```
echo "^V^M"        # CTRL+V, CTRL+M 
```

这是因为回车是 ASCII 13，而**M**是字母表的第 13 个字母，所以当你输入 时`^M`，你会得到第 13 个 ASCII 字符。您可以`ls^M`在空提示符下使用 , 来查看它的运行情况，这将插入一个回车符，使提示符的行为就像您按回车键一样。当这些字符通常被解释时，*逐字*让你得到文字字符。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2009-02-08T16:10:00.570

使用 echo 打印变量的值是一个常见的 Bash 陷阱。参考链接：

[http://mywiki.wooledge.org/BashPitfalls#echo_.24foo](http://mywiki.wooledge.org/BashPitfalls#echo_.24foo)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-11-16T23:32:15.397

如果要`echo "a\tb"`在脚本中使用，请将脚本运行为：

```
# sh -e myscript.sh 
```

或者，您可以授予 myscript.sh 执行权限，然后运行该脚本。

```
# chmod +x myscript.sh
# ./myscript.sh 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-02-15T12:44:25.600

```
res="\t\tx"
echo -e "[${res}]" 
```

# asp.net - 在 Linq 中删除数据库

> ID：525882
> 
> 赞同：0
> 
> 时间：2009-02-08T15:13:59.433
> 
> 标签：asp.net, database, linq

在正常情况下，我可以使用下面的代码将 dbml 文件中的模式添加到空数据库。

但是现在当我运行这段代码时，我收到错误“无法删除数据库“测试”，因为它当前正在使用中。” 我该怎么做？

```
Dim db As New UI_Class.UIData
        If db.DatabaseExists Then
            db.DeleteDatabase()
        End If

    db.CreateDatabase() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T16:03:16.917

当您的 SQL Server Management Studio (SSMS) 必须持有它时，它可能会发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-02T15:13:51.550

Most likely something is connected to the db.

Common causes are:

1.  Some other tool connected
2.  Trying to delete the database you connected to.
3.  Another user connected to the db.

# .net - 好的 MVC 项目

> ID：525888
> 
> 赞同：1
> 
> 时间：2009-02-08T15:17:11.190
> 
> 标签：.net, asp.net-mvc

我正在考虑使用 MVC 框架构建一个小型 Web 应用程序，以此来介绍自己。让自己开始的项目的想法是一个小型赌博监控软件，我可以输入我与其他朋友一起拥有的所有小赌注的列表。我希望使用这个网络应用程序捕捉到的一些事情是： - 记录投注 - 输入球队的赢-平-输 - 投注 PnL - 朋友之间的比较，所以我认为有相当多的范围。

我的经验是一些 c# asp.net winforms dev 并且我在 TSQL 中有更多的 sql server 后端开发背景。

我只是想知道人们用 asp.net mvc 测试水域的经验是什么，如果我的项目处于正确的水平......还是我有点过头了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-08T15:34:16.413

我强烈建议您阅读 Rob Conery 的[MVC Storefront 系列](http://blog.wekeroad.com/mvc-storefront/mvc-storefront-part-1/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-08T15:35:08.987

大多数人首先访问的应用程序是博客——新的 Hello World。它们足够简单，同时可以很好地介绍在框架样式之间发生变化的几个概念。

我可能不会使用未经测试的应用程序一头扎进它。如果你已经设计和编写了它，移植它可能没问题，但如果你还没有，可能会有太多未知数，你可能会迷路。

但这只是我的立场。如果您有足够的决心来确定您的应用程序应该如何与框架同时工作 - 那也很好。什么最适合你。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-08T16:01:59.743

[Kigg](http://dotnetslackers.com/articles/aspnet/KiggBuildingADiggCloneWithASPNETMVC1.aspx)可能会很有趣。它是 MVC 中的 digg 克隆。

# asp.net - ASP.Net 应用程序有内存限制吗？

> ID：525894
> 
> 赞同：2
> 
> 时间：2009-02-08T15:23:36.403
> 
> 标签：asp.net, large-files, out-of-memory, swfupload

我有一个允许用户上传图像的 ASP.Net MVC 应用程序。当我尝试上传一个非常大的文件 (400MB) 时，我收到一个错误。

我认为我的图像处理代码（自制）效率非常低，所以我决定尝试使用第三方库来处理图像处理部分。

因为我使用的是 TDD，所以我想先写一个失败的测试。但是当我用同一个大文件测试控制器动作时，它能够毫无问题地完成所有图像处理。

我得到的错误是“内存不足”。

我确定我的代码使用的内存可能比它需要的多得多，但我只想知道为什么我的测试通过了。

另一个区别是我使用的是未用于测试的 SWFUpload。这可能是原因吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-08T16:02:13.690

可以在 web.config 或 machine.config 或两者中配置内存限制。

在 web.config 中，该部分是：

```
<httpRuntime 
executionTimeout="3600" 
maxRequestLength="102400"
/> 
```

在 machine.config 中，该部分也可以是 httpRunTime 部分，类似于：

```
<httpRuntime 
executionTimeout="90" 
maxRequestLength="4096"
useFullyQualifiedRedirectUrl="false" 
minFreeThreads="8" 
minLocalRequestFreeThreads="4"
appRequestQueueLimit="100"
/> 
```

也可以使用 processModel 部分将 aspnet 进程限制为总内存的百分比，请参阅：

[http://msdn.microsoft.com/en-us/library/7w2sway1.aspx](http://msdn.microsoft.com/en-us/library/7w2sway1.aspx)

我遇到了与您描述的这些设置引起的类似问题。
特别是 ProcessModel memorylimit 属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T16:04:54.060

上传大小确实没有硬性限制。但是，如果您使用的是 32 位进程，您可能会受到 asp.net 工作进程可以处理的内存量的限制。一旦达到 800mb 左右，它就会变得非常不稳定。

Bravax 提到的超时设置也是检查的好地方。

为使用 TDD 干杯！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-08T16:13:42.513

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.fileupload.aspx)：

> 防止拒绝服务攻击的一种方法是使用 FileUpload 控件限制可以上传的文件的大小。您应该设置适合您希望上传的文件类型的大小限制。默认大小限制为 4096 千字节 (KB) 或 4 兆字节 (MB)。您可以通过设置 httpRuntime 元素的 maxRequestLength 属性来允许上传较大的文件。要增加整个应用程序的最大允许文件大小，请在 Web.config 文件中设置 maxRequestLength 属性。要增加指定页面的最大允许文件大小，请在 Web.config 中的 location 元素内设置 maxRequestLength 属性。有关示例，请参阅位置元素（ASP.NET 设置架构）。
> 
> 上传大文件时，用户可能还会收到以下错误消息：
> 
> aspnet_wp.exe (PID: 1520) 被回收，因为内存消耗超过 460 MB（可用 RAM 的 60%）。
> 
> 如果您的用户遇到此错误消息，请在应用程序的 Web.config 文件的 processModel 元素中增加 memoryLimit 属性的值。memoryLimit 属性指定工作进程可以使用的最大内存量。如果工作进程超过 memoryLimit 数量，则会创建一个新进程来替换它，并将所有当前请求重新分配给新进程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-08T15:44:43.990

异常究竟来自哪里？

AFAIK ASP.net/.Net 中的图像大小没有 400MB 口径限制。我正在编写一个项目，其中一些文件要大得多。当然，可能有一些我不知道的更高限制，但它看起来很奇怪和随意。

你是在 64 位机器上运行的吗？您的图像文件 - 未压缩（在 jpg 中是 400MB 吗？） - 测试您的进程地址空间的 2GB 限制吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-08T16:11:52.953

您需要确保将输入流中的数据通过管道传输到某种形式的文件流中，以便内存中不需要整个请求实体。

# qt4 - QT4 设计器在信号/槽编辑器中不接受“&”参考和“”空格字符

> ID：525896
> 
> 赞同：1
> 
> 时间：2009-02-08T15:24:31.723
> 
> 标签：qt4

QT4 设计器在信号/槽编辑器中不接受“&”参考和“”空格字符？由于 XML 模式也不支持它......有没有办法使用 QT4 设计器或编辑 ui-xml 创建自定义插槽，如 onClickMyCustorSlot(const QStringList &)

-Himadri Sekhar

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T22:59:45.823

信号通常被剥离所有`&`和`const`。如果您在代码中连接它们，则必须以相同的方式使用它们，在您的示例中如下所示：

```
SIGNAL("onClickMyCustomSlot(QStringList)") 
```

另一方面，指针 (*) 应保留在信号名称中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T22:54:50.140

尽管许多标准 Qt 类的信号使用包含“const”和“&”的符号，但这些签名的规范化版本不包含这些。您应该能够创建仅包含类名的自定义插槽，并且在运行时建立的连接应该可以正常工作。

当然，这可能无法完全满足您的需求。在这种情况下，您可能需要提交对 Qt Designer 进行改进的建议：

[http://www.qtsoftware.com/developer/task-tracker](http://www.qtsoftware.com/developer/task-tracker)

# c - 如何知道 C 函数中局部声明/循环的行号

> ID：525899
> 
> 赞同：0
> 
> 时间：2009-02-08T15:25:16.043
> 
> 标签：c

我想知道给定 C 函数中的声明在哪一行。还有哪些行有 if/while/for 循环或哪些行跨越多行（即它们不在同一行结束）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-08T15:43:40.513

我认为我们需要知道您为什么需要行号才能为您提供帮助。

各种：

1）您可以[`__LINE__`](http://www.decompile.com/cpp/faq/file_and_line_error_string.htm)在代码中使用来获取当前行号。2) 大多数编辑器可以在代码旁边显示行号。

如果您想编写断点脚本，我不确定这是否可能 - 我建议在文件名和函数上设置断点，然后拆分代码直到足够为止。或者研究完成测试的其他方法 - 例如拆分代码以便单元测试可以检查它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T16:05:51.687

也许我不明白你的问题，但你可以使用[ctags](http://en.wikipedia.org/wiki/Ctags)（或其变体之一）来获取声明列表及其行号。

例如[exuberant ctags](http://ctags.sourceforge.net/desire.html)能够为所有类型的 C/C++ 语言标签生成标签（行号），包括以下所有内容：

*   类名
*   宏定义
*   枚举名称
*   枚举器
*   函数定义
*   函数原型/声明
*   类、接口、结构和联合数据成员
*   结构名称
*   类型定义
*   工会名称
*   变量（定义和外部声明）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T16:06:34.273

如果可以，请使用差异工具。它提供行号作为输出的一部分。然后，您的工具可以解析该输出，查找声明或主要代码。

# nhibernate - HQL“包含”语句如何？

> ID：525900
> 
> 赞同：4
> 
> 时间：2009-02-08T15:26:21.407
> 
> 标签：nhibernate, hql, contains, icriteria

我有一个实体，它有一个名为标签的字符串属性。我想根据某个字符串是否位于 Tags 属性中来查询此实体。

因此，例如，我将有一个函数 IList GetEntityByTag(string tag)，这将返回在其“Tags”属性中具有 tag 值的所有实体。

我尝试通过 ICriteria 方法... Expression.In(PropertyName, Value) 但这恰恰相反。我需要像 Expression.In(Value, PropertyName) 这样的东西。

也许 IQuery 会是一个更好的策略，但我无法为 Property CONTAINS 'abc' 找到任何类型的 HQL 语句。

任何帮助或方向都将非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T15:57:36.683

如果您想知道标签是否是您的 Tags 属性中的子字符串，您可能需要考虑以下提示：

*   您可能希望先将要搜索的字符串和要搜索的字符串都转换为小写。Expression.ilike 为您执行此操作。分数。
*   要确定您的搜索词是否在字段中的任何位置，您可以将 ilike 函数中的 MatchMode 参数设置为 MatchMode.ANYWHERE。

如果，正如你之前评论的那样，

> 假设我的财产，“标签”= a;b;c;d;e。我想知道标签中是否存在“a”。Expression.Like("Tags", "a") 会返回 true 吗？

如果 'a;b;c;d;e' 是一个字符串，Expression.ilike("Tags", "a", MatchMode.ANYWHERE) 将返回 true。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T15:51:24.617

你是说 Expression.Like(PropertyName, Value) 吗？

# vb.net - 适用于 Office 2008 的 Visual Studio 工具 - 使用功能区按钮与活动文档进行交互

> ID：525901
> 
> 赞同：1
> 
> 时间：2009-02-08T15:26:36.320
> 
> 标签：vb.net, ms-word, vsto, ribbon

我用几个按钮创建了自己的功能区工具栏选项卡。我可以将文本和类似操作添加到我正在处理的文档中。现在我想添加一个按钮来保存我正在处理的文档而不使用 Word 保存按钮，因为我想设置一些参数。

我发现的每个示例都显示了如何保存由我的代码启动的文档（Dim MyDoc As New Word.Application），但是当我从功能区按钮使用此类语法时 - ActiveDocument 表示没有活动文档。

有任何想法吗？

`ThisAddIn.vb`包含：

```
Protected Overrides Function CreateRibbonExtensibilityObject() As  _
Microsoft.Office.Core.IRibbonExtensibility
    Return New MyRibbon()
End Function 
```

MyRibbon.xml 非常基础（取自 MS 示例）

```
<group id="ContentGroup" label="Content">
    <button id="textButton" label="Insert Text"
        screentip="Text" onAction="OnTextButton"
        supertip="Inserts text at the cursor location."
    />
</group> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-08T17:39:53.227

您创建的新文档不会是 Word.Application 类型。您的功能区/加载项正在当前 Word.Application 上下文中运行。

如果这确实是您正在做的事情，您应该创建 Word.Document 的实例并保存它们。

您用于创建文档、功能区和保存更改的代码到底是什么？

# c# - 如何合并数据库调用的结果？

> ID：525902
> 
> 赞同：0
> 
> 时间：2009-02-08T15:29:06.143
> 
> 标签：c#, asp.net, ado.net, .net-2.0

我有一个网络报告需要返回来自不同地区的多个产品。简化的查询将如下所示：

```
Select ProductName, ProductPrice 
from Product
where Region in (Region1, Region2, Region 3) 
```

区域由用户从 UI 中选择。结果绑定到数据网格。它可能是多个区域。但结果看起来像

```
 ProductName,  ProductPrice [Region 1] ProductPrice [Region 2] ...
Prod1
Prod2
.... 
```

同一地区的产品不一样。在某些地区，有些可能为空。要动态绑定到网格，我使用的是 DataTable，然后为区域字段动态添加数据列。最简单的方法是循环每个区域查询的结果，然后按 Product (1, 2, 3...) 合并。它可以工作，但速度很慢，尤其是对于超过 2K 的行。我想知道是否有任何方法可以避免做嵌套循环。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T17:42:34.937

你在使用 SQL Server 吗？如果是这样，您可以使用[`PIVOT`运算符](http://msdn.microsoft.com/en-us/library/ms177410.aspx)在该区域上进行旋转。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T15:50:11.547

我认为我们可能需要更多关于您正在使用的查询和循环的信息，但是您可以使用 AJAX 吗？听起来您想让 UI 体验更愉快，并且可以“按需”获取区域信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T16:35:04.730

对不起，下面的第一个答案是一个哑巴。如果我理解正确，您可以按产品顺序填写 DataRows，循环以下结果集：

```
Select ProductName, ProductPrice, Region 
from Product
where Region in (Region1, Region2, Region 3)
ORDER BY ProductID, Region 
```

为每个新的 productID 创建一个新的 DataRow，每个区域都有一个带有 ProductPrice 值（或没有）的 DataColumn。

* * *

问题中缺少基本细节，但总的来说，我建议让 DBMS 处理聚合（如果您使用的是数据库？）。二维聚合应该很快。

1.  在 SQL 查询中按地区和按产品分组并使用聚合函数来计算您的金额（例如货币、数量）。您应该得到 (product, group, amount) 元组的结果集，其中 amount 是所需的聚合，或 NULL
2.  在 ASP.NET 中循环遍历结果集并构建数据表
3.  将数据表绑定到网格控件

即使这种方法不合适，也要尽量减少来自数据源**的查询数量。**查询的数量永远不应依赖于网格列/行数。

# c++ - 使用 std::string 打开文件

> ID：525903
> 
> 赞同：2
> 
> 时间：2009-02-08T15:29:10.980
> 
> 标签：c++, stl, file-io

这应该是一个相当琐碎的问题。我正在尝试使用 std::string （或 std::wstring ）打开一个 ofstream 并且在没有混乱转换的情况下让它工作时遇到问题。

```
std::string path = ".../file.txt";

ofstream output;

output.open(path); 
```

理想情况下，如果有更好的方法，我不想手动转换它或涉及 c 样式的 char 指针？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-08T15:31:58.120

在路径字符串中，使用两个点而不是三个点。

您也可以在字符串上使用 'c_str()' 方法来获取底层 C 字符串。

```
output.open(path.c_str()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T15:33:00.097

这应该工作：

`output.open(path.c_str())`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T15:39:38.430

恐怕这根本不可能。你必须使用 c_str，是的，它很糟糕。

顺便说一句，使用 char* 也意味着 fstream 不支持 Unicode 文件名……真可惜。

# regex - 使用正则表达式替换 url 路径

> ID：525907
> 
> 赞同：0
> 
> 时间：2009-02-08T15:34:43.137
> 
> 标签：regex

我怎样才能改变我的图片的网址：

[http://www.myOLDwebsite.com/](http://www.myOLDwebsite.com/) **********.***（我有 gif、jpg、png）

对此：

[http://www.myNEWwebiste.com/somedirectory/](http://www.myNEWwebiste.com/somedirectory/) **********.***

使用 REGexp 文本编辑器？

非常感谢您的时间

[]的

马特乌斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-08T15:51:37.207

为什么使用正则表达式？

使用常规方法，替换：

```
src="http://www.myOLDwebsite.com/
```

和：

```
src="http://www.myNEWwebiste.com/somedirectory/
```

当然，这假设您的图像标签始终遵循`'src="<url>"'`模式，带有双引号和所有内容。

当然也可以使用正则表达式。替换这个：

```
(src\s*=\s*["'])http://www\.myOLDwebsite\.com/
```

和：

```
\1http://www.myNEWwebiste.com/somedirectory/
```

或者，如果您的文本编辑器使用 $ 标记反向引用：

```
$1http://www.myNEWwebiste.com/somedirectory/
```

*再想一想 - 为什么你的图片首先有绝对 URL？这不是不必要的吗？*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T15:38:18.073

好吧，最简单的方法可能是在就地模式下使用 sed：

```
sed -ir \
 's@http://www[.]myOLDwebsite[.]com/@http://www.myNEWwebsite.com/subdirectory/@g' \
 file1 file2 ... 
```

如果由于某种原因您需要实际解释 HTML（而不仅仅是进行简单的字符串替换），围绕[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)构建的快速脚本会更安全——很多人尝试通过正则表达式进行 HTML 或 XML 解析，但是即使不是不可能，也很难涵盖所有极端情况。

综上所述，如果您使用相对链接不让您的 HTML 依赖于它所在的服务器，那就更好了。另请参阅`<BASE HREF="...">`您可以放入的元素`<HEAD>`以指定所有 URL 的相对位置；如果您正在使用它，您只需要进行一次更换。

# c++ - Linux 与 Windows 中的窗口消息过程

> ID：525926
> 
> 赞同：6
> 
> 时间：2009-02-08T15:49:37.943
> 
> 标签：c++, windows, linux, cross-platform

在 Windows 中创建窗口时，必须定义一个 (c++)

```
LRESULT CALLBACK message_proc(HWND Handle, UINT Message, WPARAM WParam, LPARAM LParam); 
```

处理从操作系统发送到窗口的所有消息，如按键等。

我希望阅读一些关于同一系统在 Linux 中如何工作的文章。也许是因为我在术语上有点不足，但我无法通过谷歌找到任何关于此的内容（尽管我确信一定有很多！）。

*   它仍然只是一个处理所有通信的 C 函数吗？
*   函数定义在不同的 WM（Gnome、KDE）上是否不同，还是在操作系统的较低级别上处理？

**编辑**：我研究过 QT 和 WxWidgets 等工具，但这些框架似乎更适合开发 GUI 广泛的应用程序。我宁愿寻找一种方法来为我的 OGL 图形创建一个基本窗口（限制调整大小、边框/装饰）并在多个平台上检索输入。根据我最初的研究，这种函数是检索该输入的唯一方法。

最好的路线是什么？阅读、学习然后使用 QT 或 WxWidgets？或者学习系统如何工作并实现我自己想要的那些基本功能？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-08T16:12:29.130

好吧，在最基本的层面上，您拥有 X Window 协议[http://en.wikipedia.org/wiki/X_Window_System_core_protocol](http://en.wikipedia.org/wiki/X_Window_System_core_protocol)，如果您想做任何应用程序，我们可能会非常复杂地处理它。接下来是 Xlib [http://en.wikipedia.org/wiki/Xlib](http://en.wikipedia.org/wiki/Xlib)，它是围绕 X 协议的“方便”包装器，但对于“现实生活”应用程序仍然很复杂。大多数其他框架都是在 Xlib 之上构建的，旨在简化应用程序开发。最了解的有：Xt、Gtk、Qt等。

就像在窗口中一样，你有一个“事件循环”，如果你愿意，你可以在它上面实现一个 GetMessage/DispachMessage 隐喻来模仿窗口的行为。这样你可能有一个 WNDPROC，但 X 本身不提供这样的东西。

在重新发明轮子之前，最好先看看类似的应用程序，它们正在使用什么。

如果您需要一些简单的东西，您可以尝试 SDL [http://www.libsdl.org/](http://www.libsdl.org/)，这是一个旨在开发游戏/简单应用程序的跨平台库。另一种选择是 Allegro 游戏库[http://www.talula.demon.co.uk/allegro/](http://www.talula.demon.co.uk/allegro/)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-08T21:07:57.540

原则上是完全一样的。但是，它与与操作系统的通信无关（在win32上也没有，使用user32.dll是完全可选的）

GUI 应用程序在某处有一个事件循环，它在某个级别处理来自队列的消息。

有很多库通常用于“隐藏”这种行为 - 您可以使用它们（实际上，您应该使用它们）。如果有的话，Xlib 事件系统比 Win32 的 user32.dll 更变态，并且没有被广泛理解，因此很少有人直接使用它。

* * *

在 Linux 或 Windows 中，应用程序可以使用低级 GUI，也可以使用库。大多数人使用图书馆。应用程序也可以选择不做任何事情并在没有 GUI 的情况下运行（服务器应用程序通常这样做）。应用程序可以创建多个线程，其中一个位于事件循环中，而其他的工作方式不同。这也是一种流行的方法。

*   大多数 GUI 应用程序为其 GUI 使用更高级别的库
*   非交互式应用程序，例如服务器应用程序，根本不使用 GUI，也不使用库（例如 XLib、user32.dll）
*   Applications which don't lend themselves to an "Event loop" (e.g. Games) typically use a separate thread to process their event loop.
*   These things are largely true on Win32 and Linux.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-08T15:52:34.503

这是完全不同的。该窗口过程是 100% 特定于 Windows 操作系统的。对于 linux，它将取决于窗口管理器（gnome、kde - 正如您已经提到的）。如果你想做跨平台开发，你可能想看看 QT 之类的东西。

您可能希望查看以下 URL：

[http://www.qtsoftware.com/products/appdev](http://www.qtsoftware.com/products/appdev)
[http://en.wikipedia.org/wiki/Qt_toolkit](http://en.wikipedia.org/wiki/Qt_toolkit)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-08T16:34:39.367

正如 xhantt 所说，传输您正在寻找的等效消息的是 X Window 系统。确实，这可能有点复杂。

使用 XLib，您将需要在主循环中处理事件注册和出队。有关如何进行的完整说明，请参阅[XLib 手册。](http://tronche.com/gui/x/xlib/)但不要忘记，您只会以这种方式捕获窗口和输入事件。不是每个操作系统消息。

您还可以查找[XCB](http://xcb.freedesktop.org/)，它是一个更新的、可能更简单的库。

如果您在这两个库之上构建您的应用程序，它将在（几乎，我们永远无法确定）每个 WM 下顺利运行。而且您不需要任何大多数 linux 用户在安装时还没有的依赖项。如果您使用 Qt、GTK 等...在任何 WM 下都会更容易并且可以工作，但它们可能没有安装库。

# linux - 我应该为守护进程使用 c++ 还是脚本？

> ID：525928
> 
> 赞同：0
> 
> 时间：2009-02-08T15:50:35.337
> 
> 标签：linux, unix

我需要实现一个守护进程，它需要从数据库中提取数据，将数据加载到内存中，并根据这些数据执行发送电子邮件或写入/更新文件等操作。这些操作需要每 30 分钟执行一次。

我真的不知道该怎么做决定。编译一个 c++ 程序来完成任务或使用脚本和其他 Linux 工具（sed/awk）。

最快的方法是什么？节省cpu和内存。

困境在于如果它是不需要编译的脚本，我可以将它放入任何机器 linux/unix 中，但如果它是本机的，那就更难了。

你怎么看？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-08T15:57:38.863

使用 cron(1) 每 30 分钟启动一次程序。

所谓的脚本语言肯定会让你比 C++ 更快地编写程序。但是，使用 shell 和 sed 和/或 awk 执行此操作虽然绝对可行，但当您必须处理所有极端情况时非常困难，尤其是在字符串转义方面（想想引号、“&”的“;”......） .

我建议您使用功能更全的“脚本”语言，例如 Perl 或 Python。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T15:58:38.313

你为什么要节省 CPU 和内存？您是否绝对确定这是一个真正的要求（或只是“过早的优化”）？

除非性能至关重要，否则绝对没有理由在 C++ 中编写这样的代码。这似乎是一种维护过程（对吧？）。我说用你知道的最高级别的脚本语言编写它。Python 或 PHP 似乎是不错的选择。即使您不了解这些语言，熟悉它们所花费的时间仍然比使用 C++ 所花费的时间要少。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T00:00:59.197

我会使用带有 cron 条目的 Python/Perl/Ruby 实现来安排脚本每 30 分钟运行一次。

如果性能成为问题，您可以在数据库中添加一个列来跟踪您上次为该帐户运行计算的时间，然后将您的记录处理分成 2 或 3 或 4 组，每 15、10、5 分钟运行一次分别。

如果在将计算分组后，您仍然有性能需求，那么请考虑 C++/C/Java。

不过，我仍然会使用 cron 运行它。除非您提供按需服务，否则无需成为守护程序。

# c++ - std::map 中的内存分配

> ID：525934
> 
> 赞同：3
> 
> 时间：2009-02-08T15:57:28.100
> 
> 标签：c++, stl, map, complexity-theory

我正在对各种 C++ 字典实现（地图、字典、向量等）进行报告。

使用 std::map 插入的结果表明性能为 O(log n)。性能也有持续的峰值。我不是 100% 确定是什么原因造成的；我认为它们是由内存分配引起的，但我未能找到任何文献/文档来证明这一点。

任何人都可以解决这个问题或指出我正确的方向吗？

干杯。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-08T16:07:30.683

你是对的：它是 O(log n) 复杂度。但这是由于 map 的排序特性（通常基于二叉树）。

另请参阅[http://www.sgi.com/tech/stl/UniqueSortedAssociativeContainer.html](http://www.sgi.com/tech/stl/UniqueSortedAssociativeContainer.html)有关于插入的说明。如果您可以提示在哪里进行插入，最坏的情况是 O(log n) 和摊销 O(1)。

地图通常基于二叉树，需要平衡以保持良好的性能。您观察到的负载峰值可能与此平衡过程相对应

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T16:01:22.710

对于 STL，经验方法并不是绝对必要的。当标准明确规定诸如 std::map 插入之类的操作的最小复杂性时，进行试验是没有意义的。

我敦促您阅读该标准，以便在继续实验之前了解最低复杂性保证。当然，您碰巧测试的任何 STL 实现都可能存在错误。但是流行的 STL 是经过良好调试的生物并且使用非常广泛，所以我对此表示怀疑。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-08T16:04:10.130

如果我没记错的话，std::map 是一棵平衡的红黑树。当 std::map 确定底层树需要平衡时，可能会导致一些尖峰。此外，当分配新节点时，操作系统可能会在分配部分造成一些峰值。

# jsp - JSP——EL 函数参数的默认值

> ID：525940
> 
> 赞同：0
> 
> 时间：2009-02-08T16:01:03.333
> 
> 标签：jsp

有没有办法为 EL 函数参数（例如，可选参数）设置默认值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T17:03:05.500

您可以制作自己的标签，这些标签提供这些值，这些值将包装您尝试调用的函数。JSP2.1 具有基本上是 jsp 文件的 .tag 文件，使用这些文件定义默认值非常容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T11:09:59.783

像这样的表达？

```
#{foo.bar('argument')} 
```

不，至少现在还没有。这是为[JSR 245](http://jcp.org/en/jsr/detail?id=245)提出的，它应该是[Java EE 6](http://jcp.org/en/jsr/detail?id=316)的一部分。[Kin-Man Chung 在这里解释。](http://blogs.oracle.com/kchung/entry/jsr_245_mr_part_i)

# c# - 如何扫描 MSIL 代码以查找某些函数调用

> ID：525953
> 
> 赞同：0
> 
> 时间：2009-02-08T16:08:32.727
> 
> 标签：c#, .net, reflection, soa, cil

我要构建一个 SOA gui 框架，我想从客户端模块自动检测服务和服务依赖项。到目前为止，我有这样的代码，它使用属性工作，放置在类模块上：

```
[ServiceProvider(typeof(DemoService3))]
[ServiceConsumer(typeof(DemoService1))] 
```

我想知道如何自动扫描这些，这样人们就不会忘记添加标记并可能在运行时获得空引用。在代码中，服务通过以下命令注册和获取：

```
Services.RegisterService(new DemoService1());
Services.FetchService<DemoService3>(); 
```

我想找到这些调用，以及传入的类型（都采用类型参数，第一个是隐式的）......用于执行我的依赖项和构造的其余代码已经完成:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-08T16:32:17.327

您需要在 CLR 级别而不是 C# 级别分析 IL 来解决这个问题。

您应该能够利用[Mono Cecil](http://www.mono-project.com/Cecil:FAQ)来实现这一目标。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T16:43:02.860

您可以使用 Mono.Cecil 或 .NET 反射来完成此操作。

推荐使用 Mono.Cecil，因为它具有更好的性能和灵活性。以下是一些可以帮助您入门的示例（Cecil + 顶部的简单扩展）：

*   [如何找到针对对象的扩展方法？](http://abdullin.com/journal/2009/1/10/how-to-find-extension-methods-targeting-object.html)
*   [如何使用 NotImplementedException 计算方法？](http://abdullin.com/journal/2009/1/9/how-to-count-methods-with-notimplementedexception.html)
*   [如何确保标有 ImmutableAttribute 的类确实是不可变的？](http://abdullin.com/journal/2008/10/14/writing-net-code-analysis-rules-as-unit-tests.html)
*   [如何更改 .NET 程序集的命名空间？](http://abdullin.com/journal/2009/1/30/how-to-change-namespace-of-net-assembly.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T10:22:24.587

如果由于某种原因您无法使用 Mono.Cecil，您可以考虑手动解析 IL：您实际上只需要 find`call`和`callvirt`指令，可能进行足够的静态分析以理解`new DemoService1()`.

`typeof(YourClass).GetMethod("YourMethod").GetMethodBody().GetILAsByteArray()`是你的朋友。

# ruby - 在 Ruby 中使用元组？

> ID：525957
> 
> 赞同：72
> 
> 时间：2009-02-08T16:11:00.410
> 
> 标签：ruby, tuples, relational

有人在 Ruby 中使用元组吗？如果是这样，如何实现一个元组？Ruby 散列很好，而且工作起来几乎一样好，但我真的很想看到类似 Python 中的 Tuple 类的东西，您可以在其中使用`.`符号来查找您正在查找的值。我想要这个，以便我可以创建[D](https://rads.stackoverflow.com/amzn/click/com/0321399420)的实现，类似于 Python 的[Dee](http://www.quicksort.co.uk/)。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-02-08T16:23:40.730

[开放结构](http://www.ruby-doc.org/stdlib/libdoc/ostruct/rdoc/classes/OpenStruct.html)？

简要示例：

```
require 'ostruct'

person = OpenStruct.new
person.name    = "John Smith"
person.age     = 70
person.pension = 300

puts person.name     # -> "John Smith"
puts person.age      # -> 70
puts person.address  # -> nil 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-02-08T16:26:34.780

基于您谈论哈希和 . 符号我将假设您的意思是与`(1\. "a")`排序不同的元组。您可能正在寻找`Struct`课程。例如：

```
Person = Struct.new(:name, :age)
me = Person.new
me.name = "Guy"
me.age =  30 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2014-04-30T02:13:40.530

虽然这不是严格意义上的元组（不能对成员进行点表示法），但您可以从列表中分配变量列表，这通常可以解决当您在列表之后 ruby​​ 是按值传递的问题返回值。

例如

```
:linenum > (a,b,c) = [1,2,3]
:linenum > a
  => 1
:linenum > b
  => 2
:linenum > c
  => 3 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2020-02-05T21:53:27.863

由于解构，数组用作元组很酷

```
a = [[1,2], [2,3], [3,4]]
a.map {|a,b| a+b } 
```

结构为您提供方便的`.`访问器

```
Person = Struct.new(:first_name, :last_name)
ppl = Person.new('John', 'Connor')
ppl.first_name 
ppl.last_name 
```

您可以通过以下方式获得两全其美的便利`to_ary`

```
Person = Struct.new(:first_name, :last_name) do
  def to_ary
    [first_name, last_name]
  end
end
# =>
[
  Person.new('John', 'Connor'), 
  Person.new('John', 'Conway')
].map { |a, b| a + ' ' + b  }
# => ["John Connor", "John Conway"] 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2015-06-12T05:51:01.230

我是[Gem for Ruby tuples](https://github.com/KamilLelonek/ruby-tuples)的作者。

为您提供两个课程：

*   `Tuple`一般来说
*   `Pair`尤其

你可以用不同的方式初始化它们：

```
Tuple.new(1, 2)
Tuple.new([1, 2])
Tuple(1, 2)
Tuple([1, 2])
Tuple[1, 2] 
```

这两个类都有一些辅助方法：

*   `length`/ `arity`- 返回元组内的值的数量
*   `first`// `last`( `second`only pair) - 返回一个对应的元素
*   `[]`这使您可以访问特定元素

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2016-12-06T15:14:31.300

你可以用这个技巧来模拟 Scala 元组：

```
Tuple = Struct.new(:_1, :_2)

2.2.5 :003 > t = Tuple.new("a", "b")
 => #<struct Tuple _1="a", _2="b">
2.2.5 :004 > t._1
 => "a"
2.2.5 :005 > t._2
 => "b" 
```

但在这里你不能有解构：

```
2.2.5 :012 > a, b = t
 => {:_1=>"a", :_2=>"b"}
2.2.5 :013 > a
 => {:_1=>"a", :_2=>"b"}
2.2.5 :014 > b
 => nil 
```

但是由于这个技巧：[https](https://gist.github.com/stevecj/9ace6a70370f6d1a1511) ://gist.github.com/stevecj/9ace6a70370f6d1a1511 解构将起作用：

```
2.2.5 :001 > Tuple = Struct.new(:_1, :_2)
 => Tuple
2.2.5 :002 > t = Tuple.new("a", "b")
 => #<struct Tuple _1="a", _2="b">
2.2.5 :003 > t._1
 => "a"
2.2.5 :004 > class Tuple ; def to_ary ; to_a ; end ; end
 => :to_ary
2.2.5 :005 > a, b = t
 => #<struct Tuple _1="a", _2="b">
2.2.5 :006 > a
 => "a"
2.2.5 :007 > b
 => "b" 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-05-26T09:07:40.950

你可以做一些与解构类似的事情：

```
def something((a, b))
  a + b
end

p something([1, 2]) 
```

`3`这按预期打印出来。

# assemblies - 如何卸载 Win32 程序集并清理 WinSxS？

> ID：525958
> 
> 赞同：11
> 
> 时间：2009-02-08T16:11:25.247
> 
> 标签：assemblies, wix, windows-installer, uninstallation, winsxs

经过大量的试验和错误（主要是由于缺乏文档和示例），我设法创建了将自定义 DLL 作为并行程序集安装到 WinSxS 的 MSI 安装程序。只有一个问题：卸载会将所有文件（DLL、清单和目录）留在 WinSxS 目录中。我怎样才能或应该最好地清理它？我确信没有其他东西引用它。

我在某处读到 WinSxS 有一个自我清理过程，随着时间的推移会清理，但我找不到更多信息。你可以手动调用它来清理东西吗？

我看到的唯一其他方法是手动删除这些位。首先，您必须将所有文件（程序集、目录、清单及其各自目录）的所有者从 SYSTEM 更改为管理员帐户，调整权限并删除它们。注册表中还剩下一些部分（我认为 HKLM\COMPONENTS\DerivedData\Components 可能是一个地方），但由于 WinSxS 应该被视为不透明，因此很难找到任何信息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-08T17:24:44.133

我所知道的任何地方都没有进行清除。我什至不确定它何时自动启动。也许在卸载服务包？也许一些工具管理员可以运行？我真的忘记了。

无论如何，我的建议是不要打它。那里有很多曲折的转弯，以至于不值得尝试恢复磁盘空间。一旦卸载，仍然在 SxS 缓存中的位将不会被激活，因此它们只是在浪费空间。

这是一个愚蠢的设计，但归咎于微软，不要试图过度补偿。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-08-31T15:08:59.670

这是一篇[文章](http://blogs.technet.com/b/askcore/archive/2008/09/17/what-is-the-winsxs-directory-in-windows-2008-and-windows-vista-and-why-is-it-so-large.aspx)，它是 WinSxS 的完整指南。

因此，很快，您只能卸载某些组件（它们的所有版本都在此文件夹中），并且您可以运行 Service Pack 桥接刻录实用程序（在 Vista 中它被命名为 VSP1CLN.EXE，并与 SP1 一起提供）。请注意，执行后，您应该无法在 SP 发布日期之前卸载 SP 或任何要声明的组件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-08T17:24:53.070

没有人相信你可以 - 没有完全重新安装，你臃肿的 WinSxS 目录就在那里。

在 technet 上对这个问题进行了长时间的[“讨论”](http://social.technet.microsoft.com/Forums/en-US/itprovistaannouncements/thread/9411dbaa-69ac-43a1-8915-749670cec8c3/)。

没有有关格式的文档，也没有任何说明如何删除不再需要的文件 - MS 似乎认为磁盘空间很便宜。有一个自我清除功能，但没有人相信它有效，或者如果有效，它非常保守（正如您希望的那样，因为您不希望它破坏您的操作系统）

您可以通过检查“C:\Windows\winsxs\Temp\PendingDeletes”来判断清道夫正在工作。文件夹，因为这是 Windows 更新或安装程序将文件移动到的位置 - 清道夫只会删除此处的文件。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-13T08:50:50.020

您会注意到，在您卸载程序集后，虽然文件仍然存在，但它们不再被绑定 - 所以它们只是“暂存”或缓存，但并未真正安装。

Rob & gbjbaanb 是正确的——你不能自己手动调用清除。不要尝试自己删除文件 - 注册表中有多个注册它们的位置，DerivedData\Components 只是众多引用之一。

我认为 Vista 的规则是在机器不活动 10 分钟后，在最后一次服务操作（服务包、修补程序等）之后，由 TrustedInstaller 服务启动清理。但它非常善变，因此它不会像应有的那样频繁运行。所以请耐心等待，文件会自行消失。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-03-27T06:28:49.307

Well i was having some issues as i have an 80GB SSD for my windows and the WinSxs folder was about 12gb's

I was searching the net and i found this command:

> DISM.exe /online /Cleanup-Image /spsuperseded

And now my WinSxs is 7gb which was wonderful news.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-09-25T11:15:35.117

有一些关于适用于较新操作系统的清理方法的更新。检查[http://www.karafilis.net/winsxs-cleanup](http://www.karafilis.net/winsxs-cleanup)

# css - CSS 同行对齐

> ID：525961
> 
> 赞同：8
> 
> 时间：2009-02-08T16:12:20.173
> 
> 标签：css, user-interface, alignment, positioning

有没有一种优雅的方法可以将 3 个元素左、中、右对齐在同一行上？

现在我正在使用 3`<div>`的宽度：33%;float:left; 而且效果不太好。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-08T16:17:49.697

这对我行得通：

```
<html>
  <head>
    <style>
      div.fl {
        float: left;
        width: 33%;
      }
      div.fr {
        float: right;
        width: 33%;
      }
    </style>
  </head>
  <body>
    <div class="fl">
      A
    </div>
    <div class="fl">
      B
    </div>
    <div class="fr">
      C
    </div>
  </body>
</html> 
```

你的意思是一样的吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T16:23:04.350

如果要添加的元素中有任何边距，您可能会得到奇怪的结果。这是`width: 33%`可能不起作用的地方，因为您需要考虑元素的边距量。

```
<html>
<head>
<title></title>
<style type="text/css">
div { float: left; width: 33%; margin: 4px; }
</style>
</head>
<body>

<div style="border: 1px solid #ff0000;">1</div>
<div style="border: 1px solid #00ff00;">2</div>
<div style="border: 1px solid #0000ff;">3</div>

</body>
</html> 
```

由于每个 div 添加了边距，这将导致它无法按预期工作。同样，如果您为每个 div 添加过多的边框，您将得到类似的结果`border: 5px solid !important;`

一旦您从上面的代码中删除边距，它应该按预期工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-08T16:38:26.270

尝试这个：

```
<div style="float: left; width: 100px;">
    left
</div>
<div style="float: right; width: 100px;">
    right
</div>
<div style="width: 100px; margin: 0 auto;">
    center
</div> 
```

您需要考虑到左右 div 不会将容器框（上面代码周围的一个 div）高度向下推，即使它们的内容比中心 div 多，唯一一个不浮动。clearfix 会解决这个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T00:36:50.810

[我在http://www.salestime.com/Ref/LeftCenterRight.html](http://www.salestime.com/Ref/LeftCenterRight.html)创建了一个包含所有三种比较方法的页面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-28T02:33:17.480

这对我有用。我不知道它是否是最优雅的，但它确实有效：它对“单元格”内容和调整大小反应良好。

```
<html>
    <head>
        <style>
            .a {
                border: 1px dotted grey;
                padding: 2px;
                margin: 2px;
            }
            .l {
                border: 1px solid red;
                background-color: #fee;
                float:left;
            }
            .c {
                border: 1px solid green;
                background-color: #efe;
                text-align:center;
            }
            .r {
                border: 1px solid blue;
                background-color: #eef;
                float:right;
            }
        </style>
    </head>
    <body>
        <div class="a">
            <div class="l">
                &nbsp;
            </div>
            <div class="r">
                toto v.2 adfsdfasdfa sdfa dfas asdf 
            </div>
            <div class="c">
                item 1 | tiem 2 | asdf 3 | asdfad asd | aasdfadfadfads
            </div>
        </div>
    </body>
</html> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-08T16:17:06.857

将前两个向左浮动，第三个向右浮动，同时确保宽度适合您放置它们的线。

如果您的设计允许，请使用像素宽度。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-08T16:19:49.083

浮动 LeftBlock 'left'、CenterBlock 'none' 和 RightBlock 'right'。但**请确保 Center 元素最后出现在您的 HTML 页面上**，否则它将不起作用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-08T16:41:28.523

这是主题的另一个变体：-

```
<html>
<head>
<style type="text/css">
    div div {border:1px solid black}
    div.Center {width:34%; float:left; text-align:center}
    div.Left {float:left; width:33%; text-align:left}
    div.Right {float:right; width:33%; text-align:right}
</style>
</head>
<body>
<div class="Left"><div>Left</div></div><div class="Center"><div>Center</div></div><div class="Right"><div>Right</div></div>
</body>
</html> 
```

请注意，可以通过为每个“面板”div 使用内部 div 来设置边框。还为中心提供剩余 1% 的像素。

# sharepoint - 关于 MOSS 或 WSS 3.0，API 的哪些部分可能实现得更好？

> ID：525968
> 
> 赞同：5
> 
> 时间：2009-02-08T16:15:57.890
> 
> 标签：sharepoint, api, moss

如：

*   您可能喜欢扩展的密封方法
*   抛出的异常比有用的更模糊
*   消除**连接内容**，这是**MCMS 2002的主要功能**
*   HTML 在存储和返回时会从字段中删除。解决这个问题没有简单的选择
*   创建 SPWeb 需要很长时间。
*   MCMC 2002 中不存在的迁移路径

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-08T17:51:46.073

我希望 Sharepoint 对象模型是纯托管代码。尽管拥有 .NET 包装器很方便，但不得不担心释放许多实现 IDisposable 的对象是一件痛苦的事情。当 WSS 应用程序中没有调用 dispose 时，很容易遇到内存问题。而且我认为迁移到 .NET 的原因是让开发人员不必处理内存管理......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T16:22:56.300

如何重构导致对方法的额外数据库调用的属性，例如 SPList 上的 Items 属性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-08T21:35:42.853

任何 SPList API 都可以使用完全重写。试图处理带有嵌套文件夹的库是一场彻头彻尾的噩梦，列表完全扁平化，没有明显的层次结构。

另一个精彩的补充是向 SPWeb、SPList 和其他 Sharepoint 类添加接口以帮助测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-08T21:34:04.823

有没有人见过这种方法：http: [//msdn.microsoft.com/en-us/library/microsoft.sharepoint.spsecurity.runwithelevatedprivileges.aspx](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spsecurity.runwithelevatedprivileges.aspx) 这个方法显示了Sharepoint 向开发人员公开的难以置信的废话。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T08:48:18.043

我个人最喜欢的是[SPField.GetFieldValue 方法](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spfield.getfieldvalue.aspx)。我不知道他们为什么按照他们的方式设计它，但对我来说这几乎没有意义。要从 ListItem 中获取对象，您必须执行以下操作：

```
SPField field = ((SPList)list).Fields.GetField("FieldName"); 
object fieldValue = field.GetFieldValue(((SPListItem)item)[field.Title].ToString()); 
```

从 ListItem 中获取对象是 IMO 的一项基本操作，因此这不应该那么复杂。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-24T14:10:22.897

将字段名称传递给方法或数组时出现不一致。例如：

*   [SPFieldCollection.ContainsField()](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spfieldcollection.containsfield.aspx)：内部名称或显示名称
*   [SPFieldCollection.GetField()](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spfieldcollection.getfield.aspx)：内部名称或显示名称
*   [SPFieldCollection.GetFieldByInternalName()](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spfieldcollection.getfieldbyinternalname.aspx)：内部名称
*   [SPFieldCollection.Item](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spfieldcollection.item.aspx)：显示名称
*   [SPListItem.Item](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.splistitem.item.aspx)：内部名称或显示名称
*   [SPListItem.GetFormattedValue()](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.splistitem.getformattedvalue.aspx)：内部名称或显示名称
*   [SPViewFieldCollection.Exists](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spviewfieldcollection.exists.aspx)：内部名称

为了锦上添花，通常没有关于方法是否采用内部和/或显示名称的文档。

# delphi - 如何将背景图像添加到 Delphi 表单

> ID：525970
> 
> 赞同：2
> 
> 时间：2009-02-08T16:17:21.583
> 
> 标签：delphi, background, wallpaper

如何将背景图像添加到我的 delphi 表单？我添加了一个 TImage，但现在标签不再可见，我的复选框文本位于蓝色“框”中（蓝色是我选择的背景颜色）。这个蓝色在背景图上看起来不太好看，隐藏的标签也不好看。我该如何解决这些问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-08T16:38:39.060

对于标签：确保它们是透明的（对象检查器中的透明属性），并且它们在控件的 Z 顺序中位于 TImage 的顶部。要纠正这个问题，您可以在设计模式下对 TImage 组件执行“发送到后面”命令，它将使所有其他非窗口控件出现在其顶部。

对于复选框，我不知道您的情况是什么问题，在 Delphi 2007 中，当放置在 TImage 上时，复选框看起来正确透明。也许您使用的是较早的 Delphi 版本？如果是这样，最好在问题中提及这一点。根据主题是否处于活动状态，也可能存在不同的行为。同样，如果没有进一步的信息，很难说。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T16:43:44.870

将 TImage 移动到表单的后面（右键单击，订购 -> 发送到后面）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T16:45:09.530

对于标签，将透明属性设置为 true。对于复选框和单选按钮，至少在我可以访问的 Delphi 6 中，没有透明属性。解决这个问题的方法是将控件标签减小到零大小并提供您自己的附加 TLabel，它可以是透明的。

我也可以说我发现带有背景图像的窗口非常糟糕，而且我知道我并不孤单。

# parsing - EBNF 到 Scala 解析器组合器

> ID：525973
> 
> 赞同：11
> 
> 时间：2009-02-08T16:19:18.943
> 
> 标签：parsing, scala, parser-combinators

我有以下要解析的 EBNF：

```
PostfixExp      -> PrimaryExp ( "[" Exp "]" 
                                | . id "(" ExpList ")" 
                                | . length )* 
```

这就是我得到的：

```
def postfixExp: Parser[Expression] = (
    primaryExp ~ rep(
        "[" ~ expression ~ "]"
        | "." ~ ident ~"(" ~ repsep(expression, "," ) ~ ")" 
        | "." ~ "length") ^^ {
        case primary ~ list =>  list.foldLeft(primary)((prim,post) =>
                post match {
                    case "[" ~ length ~ "]" => ElementExpression(prim, length.asInstanceOf[Expression])
                    case "." ~ function ~"(" ~ arguments ~ ")" =>  CallMethodExpression(prim, function.asInstanceOf[String], arguments.asInstanceOf[List[Expression]])
                    case _ => LengthExpression(prim)
                }
            )
    }) 
```

但我想知道是否有更好的方法，最好不必求助于强制转换（asInstanceOf）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-08T22:30:10.430

我会这样做：

```
type E = Expression

def postfixExp = primaryExp ~ rep(
    "[" ~> expr <~ "]" ^^ { e => ElementExpression(_:E, e) }
  | "." ~ "length" ^^^ LengthExpression
  | "." ~> ident ~ ("(" ~> repsep(expr, ",") <~ ")") ^^ flatten2 { (f, args) =>
      CallMethodExpression(_:E, f, args)
    }
) ^^ flatten2 { (e, ls) => collapse(ls)(e) }

def expr: Parser[E] = ...

def collapse(ls: List[E=>E])(e: E) = {
  ls.foldLeft(e) { (e, f) => f(e) }
} 
```

为简洁起见缩短`expressions`为，并出于同样的原因`expr`添加了类型别名。`E`

我在这里用来避免丑陋的案例分析的技巧是从内部生产中返回一个*函数值。*此函数接受一个`Expression`（将是`primary`），然后`Expression`基于第一个返回一个新的。这统一了点调度和括号表达式的两种情况。最后，该`collapse`方法用于将`List`函数值的线性合并为适当的 AST，从指定的主表达式开始。

请注意，`LengthExpression`它只是`^^^`从其各自的生产中作为一个值（使用 ）返回。这是因为案例类的伴随对象（假设它`LengthExpression`确实是一个案例类）扩展了委托给它们的构造函数的相应函数值。因此，由 表示的函数`LengthExpression`接受一个`Expression`并返回一个新的实例`LengthExpression`，精确地满足了我们对高阶树构造的需求。

# c# - 反序列化验证

> ID：525977
> 
> 赞同：2
> 
> 时间：2009-02-08T16:21:20.483
> 
> 标签：c#, validation, serialization

我正在使用我序列化和反序列化的字体列表`DataContractSerializer`。在这两个步骤之间，可以想象用户已经从他们的机器中删除了一种字体。我想在反序列化时检查字体名称，以确保它仍然存在于系统中。如果它不存在，则该元素不包含在`DataContractSerializer.ReadObject()`.

具体来说，我正在存储一个`FontFamily`并序列化一个获取`FontFamily.Name`. 在此属性的 set 访问器中，我将字符串转换回`FontFamily`.

我能想到的唯一合理的验证替代方法是让属性的 set 访问器忽略无效值，然后过滤掉无效的反序列化对象。但是，我不喜欢这个选项 - 有没有更合适的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-08T17:20:21.300

为什么不利用 OnDeserializedAttribute？让您的回调执行对客户端环境无效的项目的验证和删除。

[http://msdn.microsoft.com/en-us/library/ms733734.aspx](http://msdn.microsoft.com/en-us/library/ms733734.aspx)

如果您删除或修改幕后的数据，我确实担心您将如何往返数据。

（例如：我记得当我在连接到两台不同打印机的两台不同机器上处理文档时，我对旧版本的 MS Publisher 感到特别沮丧。每当我在一台机器上修改文件时，Publisher 都会重新格式化文档以定位连接到那台机器的打印机。当我回到另一台我要进行实际打印的机器时，Publisher 会再次重新格式化，但边距不太正确，所以我需要再调整一些。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T17:50:59.383

您还可`IXmlSerializable`以为您的类实现，这将包括您自己的实现`ReadXml`，允许您在对象被反序列化时进行任何您想要的验证。

# apache - .htaccess 中的 Apache 重定向问题

> ID：525978
> 
> 赞同：1
> 
> 时间：2009-02-08T16:22:11.573
> 
> 标签：apache, mod-rewrite, redirect

我在获取一个简单的重定向语句以在我的 Godaddy 帐户上生效时遇到问题。我的 .htaccess 文件中有以下语句：

```
RewriteEngine On

RewriteCond %{HTTP_HOST} ^www.mydomain.net$ [NC]
RewriteRule ^(.*)$ http://mydomain.net/$1 [R=301,L]

RewriteCond %{HTTP_HOST} ^mydomain.net$ [NC]
RewriteRule ^/lists/$ / [R=301]

RewriteCond %{HTTP_HOST} ^mydomain.net$ [NC]
RewriteRule ^/blog/$ http://myotherdomain.net/ [R=301] 
```

第一次重定向总是有效的。然而，第二和第三个，永远不会工作。我刚从服务器得到一个404。Apache 日志没有显示任何有用的信息 - 只是 404。

任何想法，任何人？对你的帮助表示感谢。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-08T16:52:09.033

对于像这样的简单重定向，最好使用简单的`RedirectMatch`指令：

```
RedirectMatch 301 ^/lists/$ http://mydomain.net/
RedirectMatch 301 ^/blog/$ http://myotherdomain.net/ 
```

如果您坚持使用重写，请确保将`L`标志添加到您的规则中。

[Apache mod_rewrite Flags](http://httpd.apache.org/docs/2.2/rewrite/rewrite_flags.html#flags)说：

> 您几乎总是希望将 [R] 与 [L] 一起使用（即使用 [R,L]），因为 [R] 标志[本身会将 http://thishost[:thisport] 附加](http://thishost[:thisport])到 URI ，但随后将其传递给规则集中的下一条规则，这通常会导致“请求中的 URI 无效”警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T17:10:03.240

> **每个目录的重写**
> 当在文件中使用重写引擎时`.htaccess`，每个目录的前缀（对于特定目录总是相同的）被自动*删除*以进行模式匹配，并在替换完成后自动*添加。*
> – [http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriterule](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriterule)

因此，只需将前导斜线留在模式之外。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T17:14:03.997

只需删除开头的斜线即可。使末尾的斜线可选也可能很有用。

```
RewriteCond %{HTTP_HOST} ^mydomain.net$ [NC]
RewriteRule ^lists/{0,1}$ / [R=301]

RewriteCond %{HTTP_HOST} ^mydomain.net$ [NC]
RewriteRule ^blog/{0,1}$ http://myotherdomain.net/ [R=301] 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-08T16:31:17.470

把第一个放在最后。一旦遇到重定向匹配，它就会运行它并忽略其余部分。

# asp.net-mvc - .NET MVC 是否具有强类型的 RedirectToAction？

> ID：525986
> 
> 赞同：19
> 
> 时间：2009-02-08T16:32:56.123
> 
> 标签：asp.net-mvc, mvccontrib, url-redirection

由于我决定暂时放弃 RC 并继续使用 Beta，因此我无法知道是否`RedirectToAction`添加了强类型。有没有人尝试过它并且在 RC 中是否有强类型`RedirectToAction`（也许）？`ActionLink`

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-12-01T16:26:12.353

这也包含在[MVC Contrib](http://www.codeplex.com/MVCContrib)中，作为控制器上的扩展方法，以及许多其他用于 ModelState 处理、测试等的强类型好东西。它提供的额外依赖是非常值得的。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-08T16:36:44.323

不，它没有。

```
protected RedirectToRouteResult RedirectToAction<T>(Expression<Action<T>> action, RouteValueDictionary values) where T : Controller
{
    var body = action.Body as MethodCallExpression;

    if (body == null)
    {
        throw new ArgumentException("Expression must be a method call.");
    }

    if (body.Object != action.Parameters[0])
    {
        throw new ArgumentException("Method call must target lambda argument.");
    }

    string actionName = body.Method.Name;

    var attributes = body.Method.GetCustomAttributes(typeof(ActionNameAttribute), false);
    if (attributes.Length > 0)
    {
        var actionNameAttr = (ActionNameAttribute)attributes[0];
        actionName = actionNameAttr.Name;
    }

    string controllerName = typeof(T).Name;

    if (controllerName.EndsWith("Controller", StringComparison.OrdinalIgnoreCase))
    {
        controllerName = controllerName.Remove(controllerName.Length - 10, 10);
    }

    RouteValueDictionary defaults = LinkBuilder.BuildParameterValuesFromExpression(body) ?? new RouteValueDictionary();

    values = values ?? new RouteValueDictionary();
    values.Add("controller", controllerName);
    values.Add("action", actionName);

    if (defaults != null)
    {
        foreach (var pair in defaults.Where(p => p.Value != null))
        {
            values.Add(pair.Key, pair.Value);
        }
    }

    return new RedirectToRouteResult(values);
} 
```

那应该行得通。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-03-04T09:47:23.033

您可以使用`return RedirectToAction(nameof(Index));`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-04T04:04:09.473

如果您不想要完整的 MvcContrib 库，您可以使用[MvcNavigationHelpers](https://github.com/uglybugger/MvcNavigationHelpers) NuGet 包获得此功能。

# asp.net - 使用 ASP.NET 成员身份将用户重定向到多个登录页面

> ID：525988
> 
> 赞同：2
> 
> 时间：2009-02-08T16:34:49.507
> 
> 标签：asp.net, login, asp.net-membership

根据用户所在的文件夹将用户重定向到登录页面。我有一个带有根目录的 Web 应用程序，所有用户和管理站点都使用它。

对于需要网站认证功能的人，他们需要登录并被重定向到 root/login.aspx。但是，当管理员需要登录到站点的 root/admin/ 部分时，我希望他们被重定向到 root/admin/login.aspx 上的登录表单

```
 <configuration>
      <appSettings/>
      <connectionStrings/>
    <system.web>
      <authorization>
        <deny users="?" />
      </authorization>
    </system.web>
  </configuration> 
```

我在 root/admin 目录中有这个文件。我尝试添加以下行，但它给出了错误。

```
 <authentication>
    <forms defaultUrl="default.aspx" loginUrl="default.aspx"></forms>
  </authentication> 
```

基本上我正在尝试覆盖主应用程序中存在的 defaulturl 和 loginurl。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-08T16:54:37.640

您需要`<location>`在 web.config 中使用该元素。您可以使用`<location>`标签将授权设置应用于单个文件或目录。

```
<location path="/root">
  <system.web>
      <authentication mode="Forms" >
        <forms name="LoginForm" defaultUrl="default.aspx" 
        loginUrl="/root/login.aspx" protection="Encryption" 
        timeout="30" path="/"/>
      </authentication>
    <authorization>
      <allow users="?" />
    </authorization>
  </system.web>
</location>
<location path="/root/admin">
  <system.web>
    <authentication mode="Forms" >
      <forms name="formName" defaultUrl="login.aspx" 
      loginUrl="/root/admin/login.aspx" protection="Encryption"
      timeout="30" path="/"/>
    </authentication>
    <authorization>
      <allow users="?" />
    </authorization>
  </system.web>
</location> 
```

[MSDN](http://msdn.microsoft.com/en-us/library/aa302435.aspx#c19618429_012)

> 对于集中管理，可以在 Machine.config 文件中应用设置。Machine.config 文件中的设置定义机器范围的策略，也可用于使用`<location>` 元素应用特定于应用程序的配置。开发人员可以提供应用程序配置文件来覆盖机器策略的各个方面。对于 ASP.NET Web 应用程序，Web.config 文件位于应用程序的虚拟根目录中，也可以在虚拟根目录下的子目录中。

如果您想要 1 个登录位置和不同的访问级别，您可能需要使用[角色](http://msdn.microsoft.com/en-us/library/system.web.security.roles.aspx)。

```
<location path="/root">
  <system.web>
    <authorization>
       <allow roles="admin,root" />/*admin, root is allowed */
       <deny users="*" /> 
   </authorization>
  <system.web>
</location>  

<location path="/root/admin">
  <system.web>
    <authorization>
       <allow roles="admin" />/*admin is allowed */
       <deny users="*" /> 
   </authorization>
  <system.web>
</location> 
```

> 用户可以属于多个角色。例如，如果您的站点是一个讨论论坛，则某些用户可能同时担任成员和版主的角色。您可以将每个角色定义为在站点上具有不同的权限，并且同时担任这两个角色的用户将拥有两组权限。
> 
> 如果您想以编程方式操作角色/身份验证，您可以在代码级别访问所有这些元素

```
Page.User.Identity.Name
Page.User.Identity.IsAuthenticated
Page.User.Identity.AuthenticationType
Page.User.IsInRole("string"); 
```

**教程**

[来自 Rolla 教程的 4 个人](http://www.4guysfromrolla.com/webtech/121901-1.2.shtml)

[揭秘 ASP.NET web.config 文件](http://www.sitepoint.com/article/web-config-file-demystified/)

# entity-framework - Linq-to-entities：如何创建对象（new Xyz() vs CreateXyz()）？

> ID：525990
> 
> 赞同：3
> 
> 时间：2009-02-08T16:35:23.530
> 
> 标签：entity-framework

在实体框架中添加新对象的最佳方法是什么。设计师添加了所有这些创建方法，但对我来说，在对象上调用 new 更有意义。生成的 CreateCustomer 方法例如可以这样调用：

```
Customer c = context.CreateCustomer(System.Guid.NewGuid(), "Name"));
context.AddToCustomer(c); 
```

对我来说，在哪里做更有意义：

```
Customer c = new Customer {
    Id = System.Guid.NewGuid(),
    Name = "Name"
};
context.AddToCustomer(c); 
```

后者更加明确，因为在构造时设置的属性是命名的。我假设设计者故意添加了 create 方法。我为什么要使用这些？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T14:56:28.327

正如 Andrew 所说（赞成），使用常规构造函数是完全可以接受的。至于为什么存在“创建”方法，我*相信*其目的是明确需要哪些属性。如果您使用这些方法，您可以放心，您没有忘记设置任何在 SaveChanges 时会引发异常的属性。但是，实体框架的代码生成器并没有完全正确地做到这一点。它还包括服务器生成的自动增量属性。这些在技术上是“必需的”，但您不需要指定它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T22:59:21.717

您绝对可以使用第二种更自然的方式。我什至不确定为什么第一种方式存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T20:28:09.420

我想这与很多事情有关。对我来说它看起来像工厂方法，因此允许一个扩展点。第二，在你的构造函数中拥有所有这些并不是真正的最佳实践，尤其是在初始化时做很多事情时。是的，你的问题似乎很合理，我什至同意它，但是，就对象设计而言，它比他们做的更实用。

问候， Marius C. (c_marius@msn.com)

# php - 根据其中的内容高度调整 iframe 高度

> ID：525992
> 
> 赞同：69
> 
> 时间：2009-02-08T16:36:24.870
> 
> 标签：php, javascript, ajax, iframe

我正在我的网站上打开我的博客页面。问题是我可以给 iframe 一个宽度，但高度应该是动态的，这样 iframe 中就没有滚动条，它看起来像一个页面......

我尝试了各种 JavaScript 代码来计算内容的高度，但它们都给出了*拒绝访问权限*错误并且没有用。

```
<iframe src="http://bagtheplanet.blogspot.com/" name="ifrm" id="ifrm" width="1024px" ></iframe> 
```

我们可以使用 Ajax 来计算高度还是使用 PHP？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-02-08T21:00:45.043

直接回答你的两个子问题：不，你不能用 Ajax 做这个，也不能用 PHP 计算它。

我过去所做的是使用 iframe'd 页面中的触发器`window.onload`（不是`domready`，因为加载图像可能需要一段时间）将页面的正文高度传递给父级。

```
<body onload='parent.resizeIframe(document.body.scrollHeight)'> 
```

然后`parent.resizeIframe`看起来像这样：

```
function resizeIframe(newHeight)
{
    document.getElementById('blogIframe').style.height = parseInt(newHeight,10) + 10 + 'px';
} 
```

等等，你有一个强大的调整器，一旦页面完全呈现，就会触发，没有讨厌的`contentdocument`vs`contentWindow`摆弄:)

当然，现在人们会首先在默认高度看到您的 iframe，但这可以通过首先隐藏您的 iframe 并仅显示“加载”图像来轻松处理。然后，当`resizeIframe`函数启动时，在其中添加两行额外的行，以隐藏加载图像，并显示假 Ajax 外观的 iframe。

当然，这只适用于同一个域，因此您可能需要一个代理 PHP 脚本来嵌入这些东西，一旦您到那里，您还不如直接使用 PHP 将您博客的 RSS 提要嵌入到您的站点中。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-08T16:58:58.270

你可以用 JavaScript 做到这一点。

```
document.getElementById('foo').height = document.getElementById('foo').contentWindow.document.body.scrollHeight + "px"; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-08T16:57:48.617

适合 IFRAME 内容[在 Google 上很容易找到](http://www.google.com/search?q=fit+iframe+to+contents)。这是[一个解决方案](http://www.kaali.co.uk/article-Cross-bowser-iframe-auto-resize-script-94.htm)：

```
<script type="text/javascript">
    function autoIframe(frameId) {
       try {
          frame = document.getElementById(frameId);
          innerDoc = (frame.contentDocument) ? frame.contentDocument : frame.contentWindow.document;
          objToResize = (frame.style) ? frame.style : frame;
          objToResize.height = innerDoc.body.scrollHeight + 10;
       }
       catch(err) {
          window.status = err.message;
       }
    }
</script> 
```

这当然不能解决您遇到的跨域问题...`document.domain`如果这些站点位于同一位置，设置可能会有所帮助。如果您是 iframe-ing 随机网站，我认为没有解决方案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-03-01T23:16:10.530

这是我使用在 Firefox 3.6、Safari 4.0.4 和 Internet Explorer 7 中运行的 MooTools 解决问题的方法：

```
var iframe_container = $('iframe_container_id');
var iframe_style = {
    height: 300,
    width: '100%'
};
if (!Browser.Engine.trident) {
    // IE has hasLayout issues if iframe display is none, so don't use the loading class
    iframe_container.addClass('loading');
    iframe_style.display = 'none';
}
this.iframe = new IFrame({
    frameBorder: 0,
    src: "http://www.youriframeurl.com/",
    styles: iframe_style,
    events: {
        'load': function() {
            var innerDoc = (this.contentDocument) ? this.contentDocument : this.contentWindow.document;
            var h = this.measure(function(){
                return innerDoc.body.scrollHeight;
            });            
            this.setStyles({
                height: h.toInt(),
                display: 'block'
            });
            if (!Browser.Engine.trident) {
                iframe_container.removeClass('loading');
            }
        }
    }
}).inject(iframe_container); 
```

设置“加载”类的样式以在 iframe 容器的中间显示 Ajax 加载图形。然后对于 Internet Explorer 以外的浏览器，一旦其内容的加载完成，它将显示全高 IFRAME，并删除加载图形。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-28T21:18:27.957

@SchizoDuckie 的答案非常优雅和轻量级，但由于 Webkit 缺乏对 scrollHeight 的实现（参见[此处](https://developer.mozilla.org/en/DOM/element.scrollHeight)），因此不适用于基于 Webkit 的浏览器（Safari、Chrome、各种和各种移动平台）。

要使这一基本思想与 Gecko 和 Trident 浏览器一起在 Webkit 上运行，只需替换

```
<body onload='parent.resizeIframe(document.body.scrollHeight)'> 
```

和

```
<body onload='parent.resizeIframe(document.body.offsetHeight)'> 
```

只要一切都在同一个域上，这工作得很好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-29T07:52:21.927

下面是我的`onload`事件处理程序。

[我在jQuery UI](http://en.wikipedia.org/wiki/JQuery_UI)对话框中使用 IFRAME 。不同的用法需要一些调整。在 Internet Explorer 8 和 Firefox 3.5 中，这似乎对我（目前）有用。它可能需要一些额外的调整，但总体思路应该很清楚。

```
 function onLoadDialog(frame) {
    try {
        var body = frame.contentDocument.body;
        var $body = $(body);
        var $frame = $(frame);
        var contentDiv = frame.parentNode;
        var $contentDiv = $(contentDiv);

        var savedShow = $contentDiv.dialog('option', 'show');
        var position = $contentDiv.dialog('option', 'position');
        // disable show effect to enable re-positioning (UI bug?)
        $contentDiv.dialog('option', 'show', null);
        // show dialog, otherwise sizing won't work
        $contentDiv.dialog('open');

        // Maximize frame width in order to determine minimal scrollHeight
        $frame.css('width', $contentDiv.dialog('option', 'maxWidth') -
                contentDiv.offsetWidth + frame.offsetWidth);

        var minScrollHeight = body.scrollHeight;
        var maxWidth = body.offsetWidth;
        var minWidth = 0;
        // decrease frame width until scrollHeight starts to grow (wrapping)
        while (Math.abs(maxWidth - minWidth) > 10) {
            var width = minWidth + Math.ceil((maxWidth - minWidth) / 2);
            $body.css('width', width);
            if (body.scrollHeight > minScrollHeight) {
                minWidth = width;
            } else {
                maxWidth = width;
            }
        }
        $frame.css('width', maxWidth);
        // use maximum height to avoid vertical scrollbar (if possible)
        var maxHeight = $contentDiv.dialog('option', 'maxHeight')
        $frame.css('height', maxHeight);
        $body.css('width', '');
        // correct for vertical scrollbar (if necessary)
        while (body.clientWidth < maxWidth) {
            $frame.css('width', maxWidth + (maxWidth - body.clientWidth));
        }

        var minScrollWidth = body.scrollWidth;
        var minHeight = Math.min(minScrollHeight, maxHeight);
        // descrease frame height until scrollWidth decreases (wrapping)
        while (Math.abs(maxHeight - minHeight) > 10) {
            var height = minHeight + Math.ceil((maxHeight - minHeight) / 2);
            $body.css('height', height);
            if (body.scrollWidth < minScrollWidth) {
                minHeight = height;
            } else {
                maxHeight = height;
            }
        }
        $frame.css('height', maxHeight);
        $body.css('height', '');

        // reset widths to 'auto' where possible
        $contentDiv.css('width', 'auto');
        $contentDiv.css('height', 'auto');
        $contentDiv.dialog('option', 'width', 'auto');

        // re-position the dialog
        $contentDiv.dialog('option', 'position', position);

        // hide dialog
        $contentDiv.dialog('close');
        // restore show effect
        $contentDiv.dialog('option', 'show', savedShow);
        // open using show effect
        $contentDiv.dialog('open');
        // remove show effect for consecutive requests
        $contentDiv.dialog('option', 'show', null);

        return;
    }

    //An error is raised if the IFrame domain != its container's domain
    catch (e) {
        window.status = 'Error: ' + e.number + '; ' + e.description;
        alert('Error: ' + e.number + '; ' + e.description);
    }
}; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-19T17:57:30.137

我刚刚花了 3 天的大部分时间来解决这个问题。我正在开发一个应用程序，该应用程序将其他应用程序加载到自身中，同时保持固定的页眉和固定的页脚。这就是我想出的。（我也使用了 EasyXDM，成功了，但后来把它拿出来使用这个解决方案。）

`<iframe>`确保在 DOM中存在之后运行此代码。将其放入拉入 iframe（父级）的页面中。

```
// get the iframe
var theFrame = $("#myIframe");
// set its height to the height of the window minus the combined height of fixed header and footer
theFrame.height(Number($(window).height()) - 80);

function resizeIframe() {
    theFrame.height(Number($(window).height()) - 80);
}

// setup a resize method to fire off resizeIframe.
// use timeout to filter out unnecessary firing.
var TO = false;
$(window).resize(function() {
    if (TO !== false) clearTimeout(TO);
    TO = setTimeout(resizeIframe, 500); //500 is time in miliseconds
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-07-06T15:07:20.213

诀窍是从外部脚本获取所有必要的 iframe 事件。例如，您有一个使用 document.createElement 创建 iFrame 的脚本；在同一个脚本中，您暂时可以访问 iFrame 的内容。

```
var dFrame = document.createElement("iframe");
dFrame.src = "http://www.example.com";
// Acquire onload and resize the iframe
dFrame.onload = function()
{
    // Setting the content window's resize function tells us when we've changed the height of the internal document
    // It also only needs to do what onload does, so just have it call onload
    dFrame.contentWindow.onresize = function() { dFrame.onload() };
    dFrame.style.height = dFrame.contentWindow.document.body.scrollHeight + "px";
}
window.onresize = function() {
    dFrame.onload();
} 
```

这是因为 dFrame 保持在这些函数的范围内，使您可以从框架范围内访问外部 iFrame 元素，允许您查看实际文档高度并根据需要展开它。这个例子可以在 Firefox 中工作，但不能在其他地方工作；我可以给你解决方法，但你可以弄清楚其余的；）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-02-14T15:46:11.783

试试这个，你可以随时改变。这个例子使用 jQuery。

```
$('#iframe').live('mousemove', function (event) {   
    var theFrame = $(this, parent.document.body);
    this.height($(document.body).height() - 350);           
}); 
```

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2009-02-08T16:46:28.390

尝试`scrolling=no`在 iframe 标记上使用属性。Mozilla 还有一个你可以查看的 CSS 属性`overflow-x`。`overflow-y`

在高度方面，您也可以尝试`height=100%`使用 iframe 标签。

# mysql - SSIS - 从 MySql 到 MsSql 的数据有些字符是什么？

> ID：525998
> 
> 赞同：0
> 
> 时间：2009-02-08T16:40:11.320
> 
> 标签：mysql, sql-server, ssis

我刚刚在文本字段中将一些数据从 MySql 传输到 MsSql (2K5)，我的一些字符，例如撇号，现在是？（问号）对我来说，这表明某种排序规则或字符集错误，对吧？

老实说，我不知道我应该使用哪个

MySql db 正确字符集是 utf8_general_ci 而在 ms sql 中是 SQL_Latin1_General_CP1_CI_AS 。

我尝试将 mysql 表的字符集更改为 latin1_swedish_ci，但这没有帮助

感谢您的输入

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T16:47:29.293

您是否尝试将目标（SQL Server）列数据类型更改为 NVARCHAR？

MySQL 列上的`utf8_general_ci`排序规则表示 Unicode 数据类型。如果源是 Unicode，那么目标也应该是 - 最简单的转换。

排序规则本身在这里扮演次要角色。它们只会影响比较和排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T18:22:27.120

您可能还需要检查数据流中列的 SSIS 类型。请记住，数据类型和字符集是在源上的连接管理器中设置的（这可能涉及从原始本机字符集的转换）。此外，任何操作（如派生列或转换）都将具有可以更改的字符集，并将在数据流中沿该列的沿袭延续。最后，当它到达目的地时，可能会有额外的字符集强制/转换。*************