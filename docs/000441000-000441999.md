# StackOverflow 问答 000441000-000441999

# mysql - 可以对两个可能的表之一执行 MySQL 外键吗？

> ID：441001
> 
> 赞同：198
> 
> 时间：2009-01-13T22:02:16.577
> 
> 标签：mysql

好吧，这是我的问题，我有三张桌子；地区、国家、州。国家可以在区域内，州可以在区域内。地区是食物链的顶端。

现在我要添加一个包含两列的 Popular_areas 表；region_id 和 Popular_place_id。是否有可能使 popular_place_id 成为国家***或***州的外键。我可能必须添加一个 popular_place_type 列来确定 id 是描述一个国家还是一个州。

* * *

## 回答 #1

> 赞同：317
> 
> 时间：2009-01-13T22:32:08.203

您所描述的称为多态关联。也就是说，“外键”列包含必须存在于一组目标表中的一个 id 值。通常，目标表以某种方式相关，例如作为某些常见数据超类的实例。您还需要外键列旁边的另一列，以便在每一行上，您可以指定引用哪个目标表。

```
CREATE TABLE popular_places (
  user_id INT NOT NULL,
  place_id INT NOT NULL,
  place_type VARCHAR(10) -- either 'states' or 'countries'
  -- foreign key is not possible
); 
```

无法使用 SQL 约束对多态关联进行建模。外键约束总是引用**一个**目标表。

多态关联由 Rails 和 Hibernate 等框架支持。但他们明确表示您必须禁用 SQL 约束才能使用此功能。相反，应用程序或框架必须做等效的工作以确保满足引用。也就是说，外键中的值存在于可能的目标表之一中。

多态关联在强制数据库一致性方面很弱。数据完整性取决于所有访问数据库的客户端都强制执行相同的引用完整性逻辑，并且强制执行必须没有错误。

以下是一些利用数据库强制引用完整性的替代解决方案：

**为每个目标创建一个额外的表。**例如`popular_states`and `popular_countries`，分别引用`states`and `countries`。这些“流行”表中的每一个也都引用了用户的个人资料。

```
CREATE TABLE popular_states (
  state_id INT NOT NULL,
  user_id  INT NOT NULL,
  PRIMARY KEY(state_id, user_id),
  FOREIGN KEY (state_id) REFERENCES states(state_id),
  FOREIGN KEY (user_id) REFERENCES users(user_id),
);

CREATE TABLE popular_countries (
  country_id INT NOT NULL,
  user_id    INT NOT NULL,
  PRIMARY KEY(country_id, user_id),
  FOREIGN KEY (country_id) REFERENCES countries(country_id),
  FOREIGN KEY (user_id) REFERENCES users(user_id),
); 
```

这确实意味着要获取用户最喜欢的所有热门地点，您需要查询这两个表。但这意味着您可以依靠数据库来强制执行一致性。

**创建一个`places`表作为超级表。** 正如 Abie 提到的，第二种选择是您的热门地点引用了一个类似 的表格`places`，它是`states`和的父级`countries`。也就是说，州和国家都有一个外键`places`（你甚至可以使这个外键也成为`states`and的主键`countries`）。

```
CREATE TABLE popular_areas (
  user_id INT NOT NULL,
  place_id INT NOT NULL,
  PRIMARY KEY (user_id, place_id),
  FOREIGN KEY (place_id) REFERENCES places(place_id)
);

CREATE TABLE states (
  state_id INT NOT NULL PRIMARY KEY,
  FOREIGN KEY (state_id) REFERENCES places(place_id)
);

CREATE TABLE countries (
  country_id INT NOT NULL PRIMARY KEY,
  FOREIGN KEY (country_id) REFERENCES places(place_id)
); 
```

**使用两列。** 使用两列，而不是可能引用两个目标表中的任何一个的列。这两列可能是`NULL`; 事实上，其中只有一个应该是非`NULL`.

```
CREATE TABLE popular_areas (
  place_id SERIAL PRIMARY KEY,
  user_id INT NOT NULL,
  state_id INT,
  country_id INT,
  CONSTRAINT UNIQUE (user_id, state_id, country_id), -- UNIQUE permits NULLs
  CONSTRAINT CHECK (state_id IS NOT NULL OR country_id IS NOT NULL),
  FOREIGN KEY (state_id) REFERENCES places(place_id),
  FOREIGN KEY (country_id) REFERENCES places(place_id)
); 
```

就关系理论而言，多态关联违反了[第一范式](http://en.wikipedia.org/wiki/First_normal_form)，因为`popular_place_id`它实际上是一个具有两种含义的列：它是一个州或一个国家。您不会将一个人和`age`他们的信息存储`phone_number`在一个列中，出于同样的原因，您也不应该将两者都存储`state_id`在`country_id`一个列中。这两个属性具有兼容的数据类型的事实是巧合。它们仍然表示不同的逻辑实体。

多态关联也违反了[第三范式](http://en.wikipedia.org/wiki/Third_normal_form)，因为列的含义取决于命名外键引用的表的额外列。在第三范式中，表中的属性必须仅依赖于该表的主键。

* * *

来自@SavasVedova 的重新评论：

我不确定我是否在没有看到表定义或示例查询的情况下遵循您的描述，但听起来您只是有多个`Filters`表，每个表都包含一个引用中央`Products`表的外键。

```
CREATE TABLE Products (
  product_id INT PRIMARY KEY
);

CREATE TABLE FiltersType1 (
  filter_id INT PRIMARY KEY,
  product_id INT NOT NULL,
  FOREIGN KEY (product_id) REFERENCES Products(product_id)
);

CREATE TABLE FiltersType2 (
  filter_id INT  PRIMARY KEY,
  product_id INT NOT NULL,
  FOREIGN KEY (product_id) REFERENCES Products(product_id)
);

...and other filter tables... 
```

如果您知道要加入哪种类型，则将产品加入特定类型的过滤器很容易：

```
SELECT * FROM Products
INNER JOIN FiltersType2 USING (product_id) 
```

如果您希望过滤器类型是动态的，则必须编写应用程序代码来构造 SQL 查询。SQL 要求在您编写查询时指定并修复该表。您不能根据`Products`.

唯一的其他选择是使用外连接连接到*所有*过滤表。那些没有匹配 product_id 的将仅作为单行空值返回。但是您仍然必须对*所有*连接的表进行硬编码，并且如果您添加新的过滤器表，则必须更新您的代码。

```
SELECT * FROM Products
LEFT OUTER JOIN FiltersType1 USING (product_id)
LEFT OUTER JOIN FiltersType2 USING (product_id)
LEFT OUTER JOIN FiltersType3 USING (product_id)
... 
```

加入所有过滤表的另一种方法是串行执行：

```
SELECT * FROM Product
INNER JOIN FiltersType1 USING (product_id)
UNION ALL
SELECT * FROM Products
INNER JOIN FiltersType2 USING (product_id)
UNION ALL
SELECT * FROM Products
INNER JOIN FiltersType3 USING (product_id)
... 
```

但是这种格式仍然需要您编写对所有表的引用。没有办法解决这个问题。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-13T22:16:37.593

这不是世界上最优雅的解决方案，但您可以使用[具体的表继承](http://martinfowler.com/eaaCatalog/concreteTableInheritance.html)来完成这项工作。

从概念上讲，您提出了一类“可以成为流行区域的事物”的概念，您的三种类型的地方都从该类继承。例如，您可以将其表示为一个名为的表，其中每一行与、或`places`中的行具有一对一的关系。（在地区、国家或州之间共享的属性，如果有的话，可以被推到这个地方表中。）然后，你将成为地方表中一行的外键引用，然后将你带到一个地区、国家，或状态。`regions``countries``states``popular_place_id`

您提出的第二列描述关联类型的解决方案恰好是 Rails 如何处理多态关联，但我一般不喜欢这种方法。Bill 非常详细地解释了为什么多态关联不是你的朋友。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-10-21T12:55:57.797

这是对 Bill Karwin 的“supertable”方法的更正，使用复合键`( place_type, place_id )`来解决感知到的范式违规：

```
CREATE TABLE places (
  place_id INT NOT NULL UNIQUE,
  place_type VARCHAR(10) NOT NULL
     CHECK ( place_type = 'state', 'country' ),
  UNIQUE ( place_type, place_id )
);

CREATE TABLE states (
  place_id INT NOT NULL UNIQUE,
  place_type VARCHAR(10) DEFAULT 'state' NOT NULL
     CHECK ( place_type = 'state' ),
  FOREIGN KEY ( place_type, place_id ) 
     REFERENCES places ( place_type, place_id )
  -- attributes specific to states go here
);

CREATE TABLE countries (
  place_id INT NOT NULL UNIQUE,
  place_type VARCHAR(10) DEFAULT 'country' NOT NULL
     CHECK ( place_type = 'country' ),
  FOREIGN KEY ( place_type, place_id ) 
     REFERENCES places ( place_type, place_id )
  -- attributes specific to country go here
);

CREATE TABLE popular_areas (
  user_id INT NOT NULL,
  place_id INT NOT NULL,
  UNIQUE ( user_id, place_id ),
  FOREIGN KEY ( place_type, place_id ) 
     REFERENCES places ( place_type, place_id )
); 
```

这种设计不能确保对于其中的每一行都`places`存在一行`states`或`countries`（但不是两者）。这是 SQL 中外键的一个限制。在一个完全符合 SQL-92 标准的 DBMS 中，您可以定义可延迟的表间约束，这将允许您实现相同的目标，但它很笨重，涉及事务，并且这样的 DBMS 尚未上市。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2022-01-04T02:02:01.627

## 关系答案

注意`mysql`标签，这意味着，因为 SQL 是 Codd 的***关系模型***`relational`中定义的数据子语言。

 ***   该解决方案简单明了，我们在*RM*之前就有它，并且自 1981 年以来我们就有了一个关系解决方案。
*   关系解决方案提供参照完整性（物理，在 SQL 级别）和关系完整性（逻辑）。
*   遵守[**开放架构标准**](https://www.softwaregems.com.au/Documents/Article/Application%20Architecture/Open%20Architecture.pdf)（健全性），所有约束；商业规则; 管理数据的等，以及所有事务，应该部署在数据库中，而不是框架，不是应用程序 GUI，而不是应用程序中间层。请注意，它是一个单独的恢复单元。

标签是假的`polymorphic-associations`，它不是 OP 要求的。强迫它进入 OO/ORM 思维模式，然后以这种思维模式证明解决方案，超出了问题的范围。

*   此外，它需要一个框架和代码来强制执行约束；等，在数据库之外，这是不合标准的。
*   此外，它不具备关系解决方案的基本完整性，更不用说关系完整性了。
*   此外，它违反了`1NF`and `3NF`（如 Karvan 答案中详述）。
*   Null 是规范化错误，它们不应该被存储。
*   Nullable`FOREIGN KEY`是一个严重的标准化错误。

## 解决方案

> 好吧，这是我的问题，我有三张桌子；地区、国家、州。国家可以在区域内，州可以在区域内。地区是食物链的顶端。

**使其具有关系**

让我们了解一下关系上下文中的含义。它是典型的表层次结构。

*   不要使用`ID`字段。不要将它们声明为`PRIMARY KEY`，这只会让您感到困惑，因为它不是键，它不提供*关系模型*中要求的**行唯一性**
**   密钥必须*由数据组成**   `ID`字段不是数据。它始终是一个*附加*字段，一个*附加*索引*   使用`ID`字段，您可能能够实现参照完整性（物理、SQL），但您没有机会实现关系完整性（逻辑）*   有关完整的讨论，包括 SQL 代码，请参阅：
    [**Creating a Relational table with 2 different auto_increment**](https://stackoverflow.com/questions/29639121/sql-creating-a-relational-table-with-2-different-auto-increment/29726132#29726132)，仅限 §1 和 2。*

 ***基表**

![富](https://www.softwaregems.com.au/Documents/Student_Resolutions_2020/Andrew%20G%20Johnson/Base%20TA.png)

**符号**

*   **[我所有的数据模型都在IDEF1X](https://www.iso.org/standard/60614.html)**中呈现，关系数据建模的表示法，我们自 1980 年代初以来就有，在 1993 年制定了关系数据建模标准，最后更新于 2016 年。

*   对于不熟悉*关系模型*或其建模方法的人来说， **[IDEF1X 简介](https://www.softwaregems.com.au/Documents/Documentary%20Examples/IDEF1X%20Introduction.pdf)**是必不可少的读物。请注意，IDEF1X 模型具有丰富的细节和精确度，显示*了所有*必需的细节，而本土模型由于不了解标准的要求，因此定义要少得多。这意味着，符号需要被完全理解。  

***   ERD 不是标准，它不支持关系模型，完全不适合建模。

    *   学者和“教科书”教授并将反关系营销为“关系”是犯罪行为。** 

 **## 亚型

> 现在我要添加一个包含两列的 Popular_areas 表；region_id 和 Popular_place_id。是否有可能使 popular_place_id 成为国家或州的外键。

完全没有问题。*关系模型*建立在数学之上；逻辑，它完全是逻辑的。**OR**或**XOR**门是逻辑的基础。在关系或 SQL 范式中，它被称为**子类型**集群。

*   即使在不符合 SQL 的免费软件“SQL”中，它也具有完全的参照完整性

    *   认为它无法完成，或者它需要学术界推销的可怕的额外领域和指数的想法是错误的。
*   有关完整的实现细节，包括 SQL 代码的链接，请参阅[**子类型**](https://www.softwaregems.com.au/Documents/Article/Database/Relational%20Model/Subtype.pdf)文档。

*   有关示例和讨论，请参阅：
    [**如何在子类型中实现参照完整性**](https://stackoverflow.com/a/4898314/484814)

*   为了澄清混淆这个问题的问题，以及其他答案：
    [**书籍图的关系模式**](https://stackoverflow.com/a/70518591/484814)

> 我可能必须添加一个 popular_place_type 列来确定 id 是描述一个国家还是一个州。

没错，你是在逻辑思考。这里我们需要一个**XOR** Gate，它需要一个**Discriminator**。

**添加地点表**

![富](https://www.softwaregems.com.au/Documents/Student_Resolutions_2020/Andrew%20G%20Johnson/Popular%20Place%20TA.png)

### 关系完整性

参照完整性是 SQL 中提供的物理特性，而关系完整性（即逻辑）则位于此之上（正确建模时，逻辑先于物理）。  

这是关系完整性的一个很好的简单示例。注意`FOREIGN KEY`子类型中的第二个。

*   `PlaceCountry`被限制在`Country`一个`Region`与`Place.Region`

*   `PlaceState`被限制在`State`一个`Region`与`Place.Region`

*   请注意，这仅适用于关系键（复合）

    *   关系完整性在原始的记录归档系统中是不可能的，这些系统以`ID`字段为“键”，并被学者和作者大力推销为“关系”
    *   在这样的原始文件（它们不是表）中，将`PlaceCountry`允许任何.`Country``Country``Region``Place.Region`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-23T06:11:14.977

我意识到这个线程很旧，但我看到了这个并且想到了一个解决方案，我想我会把它扔在那里。

地区、国家和州是位于层次结构中的地理位置。

您可以通过创建一个名为 george_location_type 的域表来完全避免您的问题，您将使用三行（地区、国家、州）填充该表。

接下来，创建一个外键为 geo_location_type_id 的单个 geo_location 表，而不是三个位置表（这样您就知道该实例是区域、国家还是州）。

通过使该表自引用来对层次结构进行建模，以便 State 实例将 fKey 保存到其父 Country 实例，而后者又将 fKey 保存到其父 Region 实例。区域实例将在该 fKey 中保存 NULL。这与您对三个表所做的没有什么不同（您将有 1 - 地区和国家之间以及国家和州之间的许多关系），除了现在它们都在一张表中。

popular_user_location 表将是 user 和 georgraphical_location 之间的范围解析表（很多用户可能喜欢很多地方）。

呜呜呜……</p>

[![在此处输入图像描述](https://i.stack.imgur.com/ALAJl.jpg)](https://i.stack.imgur.com/ALAJl.jpg)

```
CREATE TABLE [geographical_location_type] (
    [geographical_location_type_id] INTEGER NOT NULL,
    [name] VARCHAR(25) NOT NULL,
    CONSTRAINT [PK_geographical_location_type] PRIMARY KEY ([geographical_location_type_id])
)

-- Add 'Region', 'Country' and 'State' instances to the above table

CREATE TABLE [geographical_location] (
   [geographical_location_id] BIGINT IDENTITY(0,1) NOT NULL,
    [name] VARCHAR(1024) NOT NULL,
    [geographical_location_type_id] INTEGER NOT NULL,
    [geographical_location_parent] BIGINT,  -- self referencing; can be null for top-level instances
    CONSTRAINT [PK_geographical_location] PRIMARY KEY ([geographical_location_id])
)

CREATE TABLE [user] (
    [user_id] BIGINT NOT NULL,
    [login_id] VARCHAR(30) NOT NULL,
    [password] VARCHAR(512) NOT NULL,
    CONSTRAINT [PK_user] PRIMARY KEY ([user_id])
)

CREATE TABLE [popular_user_location] (
    [popular_user_location_id] BIGINT NOT NULL,
    [user_id] BIGINT NOT NULL,
    [geographical_location_id] BIGINT NOT NULL,
    CONSTRAINT [PK_popular_user_location] PRIMARY KEY ([popular_user_location_id])
)

ALTER TABLE [geographical_location] ADD CONSTRAINT [geographical_location_type_geographical_location] 
    FOREIGN KEY ([geographical_location_type_id]) REFERENCES [geographical_location_type] ([geographical_location_type_id])

ALTER TABLE [geographical_location] ADD CONSTRAINT [geographical_location_geographical_location] 
    FOREIGN KEY ([geographical_location_parent]) REFERENCES [geographical_location] ([geographical_location_id])

ALTER TABLE [popular_user_location] ADD CONSTRAINT [user_popular_user_location] 
    FOREIGN KEY ([user_id]) REFERENCES [user] ([user_id])

ALTER TABLE [popular_user_location] ADD CONSTRAINT [geographical_location_popular_user_location] 
    FOREIGN KEY ([geographical_location_id]) REFERENCES [geographical_location] ([geographical_location_id]) 
```

不确定目标数据库是什么；以上是MS SQL Server。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-06T15:32:56.410

好吧，我有两张桌子：

1.  歌曲

a) 歌曲编号 b) 歌曲标题 ....

2.  播放列表 a) 播放列表编号 b) 播放列表标题 ...

我有第三个

3.  song_to_playlist_relation

问题是某些类型的播放列表链接到其他播放列表。但是在 mysql 中，我们没有与两个表关联的外键。

我的解决方案：我将在songs_to_playlist_relation 中添加第三列。该列将是布尔值。如果为 1 则为歌曲，否则将链接到播放列表表。

所以：

3.  song_to_playlist_relation

a) Playlist_number (int) b) 是歌曲 (boolean) c) 相对编号（歌曲编号或播放列表编号）（int）（**不是**任何表的外键）

```
#创建餐桌歌曲
    query.append("SET SQL_MODE = NO_AUTO_VALUE_ON_ZERO;")
    query.append("CREATE TABLE songs( NUMBERint(11) NOT NULL, SONG POSITIONint(11) NOT NULL, PLAY SONGtinyint(1) NOT NULL DEFAULT '1', SONG TITLEvarchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL, DESCRIPTIONvarchar(1000) CHARACTER SET ARTISTUTF8 COLLATE UTF8_GENERAL_CI NOT NULL，VARCHAR（255）UTF8 COLLATE UTF8_GENERAL_CI NOT NULL默认值'άΓνωστου®， varchar（255）字符集UTF8 COLLATE UTF8_GENERAL_CI NOT NULL默认'άΓνωστοςστιμουργί'，varcar （255）字符AUTHOR集UTF8 Collat​​e UTF8 COLLITE COMPOSERNOT NULL DEFAULT 'Άγνωστος συνθέτης', ALBUMvarchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT 'Άγνωστοάλμπουμ', YEARint(11) NOT NULL DEFAULT '33',RATINGint(11) NOT NULL DEFAULT '5',IMAGEvarchar(600) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL，SONG PATHvarchar(500) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL，SONG REPEATint(11) NOT NULL DEFAULT'0'，VOLUMEfloat NOT NULL DEFAULT'1'，SPEEDfloat NOT NULL DEFAULT'1' ) 引擎=InnoDB 默认字符集=utf8;")
    query.append("ALTER TABLE songsADD PRIMARY KEY( NUMBER), ADD UNIQUE KEY POSITION( SONG POSITION), ADD UNIQUE KEY TITLE( SONG TITLE), ADD UNIQUE KEY PATH( SONG PATH);")
    query.append("ALTER TABLE songsMODIFY NUMBERint(11) NOT NULL AUTO_INCREMENT;")

```
#create table playlists
queries.append("CREATE TABLE `playlists` (`NUMBER` int(11) NOT NULL,`PLAYLIST POSITION` int(11) NOT NULL,`PLAYLIST TITLE` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,`PLAYLIST PATH` varchar(500) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8;")
queries.append("ALTER TABLE `playlists` ADD PRIMARY KEY (`NUMBER`),ADD UNIQUE KEY `POSITION` (`PLAYLIST POSITION`),ADD UNIQUE KEY `TITLE` (`PLAYLIST TITLE`),ADD UNIQUE KEY `PATH` (`PLAYLIST PATH`);")
queries.append("ALTER TABLE `playlists` MODIFY `NUMBER` int(11) NOT NULL AUTO_INCREMENT;")

#create table for songs to playlist relation
queries.append("CREATE TABLE `songs of playlist` (`PLAYLIST NUMBER` int(11) NOT NULL,`SONG OR PLAYLIST` tinyint(1) NOT NULL DEFAULT '1',`RELATIVE NUMBER` int(11) NOT NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8;")
queries.append("ALTER TABLE `songs of playlist` ADD KEY `PLAYLIST NUMBER` (`PLAYLIST NUMBER`) USING BTREE;")
queries.append("ALTER TABLE `songs of playlist` ADD CONSTRAINT `playlist of playlist_ibfk_1` FOREIGN KEY (`PLAYLIST NUMBER`) REFERENCES `playlists` (`NUMBER`) ON DELETE RESTRICT ON UPDATE RESTRICT") 
```

就这样！

```
playlists_query = "SELECT s1.*, s3.*, s4.* FROM song as s1 INNER JOIN `songs of playlist` as s2 ON s1.`NUMBER` = s2.`RELATIVE NUMBER` INNER JOIN `playlists` as s3 ON s3 .`NUMBER` = s2.`PLAYLIST NUMBER` INNER JOIN `playlists` as s4 ON s4.`NUMBER` = s2.`RELATIVE NUMBER` ORDER BY s3.`PLAYLIST POSITION`,`s1`.`SONG POSITION`"
```

        iphone - 是否存在用于 obj-c 的通用验证器库？

ID：441005

赞同：1

时间：2009-01-13T22:03:33.533

标签：iphone, objective-c, cocoa-touch, validation

我想知道是否已经存在适用于 obj-c 的 iPhone 项目（或更好的业务对象）的通用验证器库。

像：

```
Validator.IsNotEmpty..
Validator.IsValidEmail..
Validator.IsValidZipCode..
Validator.IsValidRegex..
Validator.IsInRange.. 
```

            回答 #1

赞同：4

时间：2009-01-14T06:33:48.247

Cocoa 中有一个标准的*验证模式*，包括 Cocoa Touch，称为[Key-Value Validation](http://developer.apple.com/iphone/library/documentation/Cocoa/Conceptual/KeyValueCoding/Concepts/Validation.html "键值验证 (iPhone)")，如果你想验证用户输入而不是通过 NSFormatter，你应该遵守它。

本质上，对于`name`您想要验证的属性，您可以按照以下模式实现一个方法：

```
- (BOOL)validateName:(id *)ioValue error:(NSError **)error; 
```

然后，当您想在从 UI 设置属性之前对其进行验证时，您只需使用：

```
NSString *proposedName = [[nameField.stringValue copy] autorelease];
NSError *nameError;

if ([person validateValue:&proposedName forKey:@"name" error:&nameError]) {
    person.name = proposedName;
} else {
    // present nameError to the user in a reasonable way
} 
```

请注意，您**不会**在方法中调用`-validateValue:forKey:error:`或方法。相反，一旦你知道你为它传递的值是有效的，你就会调用你的方法（就像我通过上面的点语法所做的那样）。`-validateName:error:``-setName:``-setName:`

另外，请阅读我上面提到的关于键值验证的文档，以了解为什么`proposedName`是字段字符串值的自动发布副本，而不仅仅是其字符串值。

如果您正在实现比每个属性验证更复杂的东西，例如整个对象验证甚至对象图验证，请务必查看 Mac OS X 上的 Core Data 框架如何处理它。  

            回答 #2

赞同：0

时间：2009-01-13T22:16:36.987

我什么都没听说过。如果这是您想要的东西，我会使用可用于 Cocoa Touch 的正则表达式库之一，您应该能够很容易地找到这些测试的正则表达式示例。

        javascript - 在 JavaScript 中用下划线替换空格？

ID：441018

赞同：419

时间：2009-01-13T22:07:30.233

标签：javascript, string

我正在尝试使用此代码用_替换空格，它适用于字符串中的第一个空格，但所有其他空格实例保持不变。有人知道为什么吗？

```
function updateKey()
{
    var key=$("#title").val();
    key=key.replace(" ","_");
    $("#url_key").val(key);
} 
```

            回答 #1

赞同：816

时间：2009-01-13T22:10:27.780

尝试`.replace(/ /g,"_");` 

*编辑*：或者`.split(' ').join('_')`如果您厌恶 RE

*编辑*：[John Resig 说](http://ejohn.org/blog/javascript-micro-templating/)：

如果您使用静态搜索和静态替换来搜索和替换字符串，则使用 .split("match").join("replace") 执行操作会更快 - 这似乎违反直觉，但它可以工作在大多数现代浏览器中都是这样。（在 Firefox 的下一个版本中进行了一些更改以显着提高 .replace(/match/g, "replace") 的性能 - 因此之前的声明不会长期存在。）

            回答 #2

赞同：84

时间：2009-01-13T22:11:26.263

试试这个：

```
key=key.replace(/ /g,"_"); 
```

这将进行全局查找/替换

[javascript替换](http://www.w3schools.com/jsref/jsref_replace.asp)

            回答 #3

赞同：65

时间：2009-02-13T06:02:51.547

在下面回答 Prasanna 的问题：

如何在 Javascript 中用单个空格替换多个空格？

您将使用`replace`具有不同正则表达式的相同函数。空格`\s`的表达式是，而“1 次或多次”的表达式是`+`加号，因此您只需将 Adam 的答案替换为以下内容：

```
key=key.replace(/\s+/g,"_"); 
```

            回答 #4

赞同：45

时间：2014-05-23T10:11:13.717

你可以试试这个

```
 var str = 'hello     world  !!';
 str = str.replace(/\s+/g, '-'); 
```

它甚至会用单个“-”替换多个空格。

            回答 #5

赞同：18

时间：2011-06-08T22:52:35.197

我为它创建了 JS 性能测试[http://jsperf.com/split-and-join-vs-replace2](http://jsperf.com/split-and-join-vs-replace2)

            回答 #6

赞同：15

时间：2016-03-21T05:42:46.563

用下划线替换**空格**  

```
var str = 'How are you';
var replaced = str.split(' ').join('_'); 
```

**输出：** How_are_you

            回答 #7

赞同：3

时间：2014-12-16T15:11:13.473

我知道这很旧，但我没有看到有人提到扩展 String `prototype`。

```
String.prototype.replaceAll = function(search, replace){
    if(!search || !replace){return this;} //if search entry or replace entry empty return the string
    return this.replace(new RegExp('[' + search + ']', 'g'), replace); //global RegEx search for all instances ("g") of your search entry and replace them all.
}; 
```

            回答 #8

赞同：3

时间：2018-06-25T05:09:22.993

只需使用`replace`：

```
var text = 'Hello World';

new_text = text.replace(' ', '_');

console.log(new_text);
```

            回答 #9

赞同：3

时间：2021-04-22T05:27:21.390

替换所有出现
发生这种情况是因为`replace()`方法是这样设计的，以便**在您使用字符串查找匹配**项时仅替换第一次出现。检查[替换方法](https://www.tutorialstonight.com/replace-string-javascript.php)。
要替换所有匹配项，您可以**使用以下 3 种方法**：

1.  ## 在方法中使用带有全局标志的正则表达式`replace()`：

    当您使用`replace`带有`/g`标志的正则表达式的方法时，它会替换字符串中的所有匹配项。

    ```
     function updateKey()
        {
            var key=$("#title").val();
            key=key.replace(/ /g,"_");
            $("#url_key").val(key);
        }
        // Show case
        let title = "Your document title";
        console.log(title.replace(/ /g,"_"));
    ```

2.  ## 使用[replaceAll 方法](https://www.tutorialstonight.com/replace-all-string-javascript.php)：

    该`replaceAll`方法将删除所有带下划线的空格。（使用正则表达式时必须使用全局标志）

    ```
     function updateKey()
        {
            var key=$("#title").val();
            key=key.replaceAll(/ /g,"_");
            // key=key.replaceAll(" ","_"); also valid
            $("#url_key").val(key);
        }
        // Show case
        let title = "Your document title";
        console.log(title.replaceAll(/ /g,"_"));
    ```

3.  ## 使用`split`和`join`方法的组合：

    在空格处拆分您的字符串，并在 join 方法中使用 _ 作为分隔符来连接它。

    ```
     function updateKey()
        {
            var key=$("#title").val();
            key=key.split(" ").join("_");
            $("#url_key").val(key);
        }
        // Show case
        let title = "Your document title";
        console.log(title.split(" ").join("_"));
    ```

            回答 #10

赞同：0

时间：2020-08-07T17:19:00.550

```
const updateKey = key => console.log(key.split(' ').join('_'));
updateKey('Hello World');
```

            回答 #11

赞同：0

时间：2021-12-28T18:39:53.183

```
$(function() {
    $('#title').keyup(function() {
        var value = $(this).val().toLowerCase();
        $('#url_key').val(value.split(' ').join('_'));
    }).keyup();
}); 
```

-- 或者你可以使用：

```
$(function() {
    $('#title').keyup(function() {
        var value = $(this).val().toLowerCase();
        $('#url_key').val(value.replace(/ /g,"_"));
    }).keyup();
}); 
```

        sql - 在Oracle中，为什么删除表分区时公共同义词会失效

ID：441021

赞同：3

时间：2009-01-13T22:07:46.177

标签：sql, oracle, database-partitioning, synonym

有人可以告诉我为什么会发生以下行为（Oracle 10.2）：

```
SQL> create table part_test (
        i int primary key,
        d date
)
partition by range (d) (partition part_test_1 values less than (to_date('  2    3    4    5  1980-01-01', 'yyyy-mm-dd')));

create public synonym part_test for part_test;

select object_name, object_type, status from all_objects where object_name = 'PART_TEST';

alter table part_test add partition part_test_2 values less than (to_date('1981-01-01', 'yyyy-mm-dd'));

select object_name, object_type, status from all_objects where object_name = 'PART_TEST';

alter table part_test drop partition part_test_1;

select object_name, object_type, status from all_objects where object_name = 'PART_TEST';

drop public synonym part_test;
drop table part_test;

Table created.

SQL> SQL> 
Synonym created.

SQL> SQL> 
OBJECT_NAME                    OBJECT_TYPE         STATUS
------------------------------ ------------------- -------
PART_TEST                      TABLE               VALID
PART_TEST                      TABLE PARTITION     VALID
PART_TEST                      SYNONYM             VALID

SQL> SQL> 
Table altered.

SQL> SQL> 
OBJECT_NAME                    OBJECT_TYPE         STATUS
------------------------------ ------------------- -------
PART_TEST                      TABLE               VALID
PART_TEST                      TABLE PARTITION     VALID
PART_TEST                      TABLE PARTITION     VALID
PART_TEST                      SYNONYM             VALID

SQL> SQL> 
Table altered.

SQL> SQL> 
OBJECT_NAME                    OBJECT_TYPE         STATUS
------------------------------ ------------------- -------
PART_TEST                      TABLE               VALID
PART_TEST                      TABLE PARTITION     VALID
PART_TEST                      SYNONYM             INVALID

SQL> SQL> 
Synonym dropped.

SQL> 
Table dropped.

SQL> 
```

删除分区后同义词变得无效，我不知道为什么。

感谢您的任何想法。

            回答 #1

赞同：6

时间：2009-01-14T06:37:46.943

我已经用 Oracle 10.2 对其进行了测试，同义词确实无效，但是当其他用户使用同义词时

从 part_test 中选择 count(*)；

Oracle 自动编译同义词，同义词变为有效。

包、过程和函数也是如此。当您执行它们并且它们无效时，Oracle 将尝试自动编译它们。  

            回答 #2

赞同：2

时间：2009-01-14T04:44:22.803

它不在 11.1.0.6 中它可能是一个已修复的错误。这可能是必要的（例如，基于同义词重新验证视图......）但使用了改进的技术。

        .net - 将数据表转换为通用列表的最快方法

ID：441023

赞同：6

时间：2009-01-13T22:08:10.263

标签：.net, .net-2.0, datatable, n-tier-architecture

我有一个返回数据表的数据层选择方法。它是从一个业务层方法调用的，然后应该返回一个强类型的泛型列表。

我想做的与这个问题非常相似（但不一样）：

[How do you convert a DataTable into a generic list?](https://stackoverflow.com/questions/208532/how-do-you-convert-a-datatable-into-a-generic-list)

不同的是我希望列表包含强类型对象而不是数据行（另外，我这里还没有可用的 linq）。  

我担心性能。业务层方法将依次从表示层调用，结果将被迭代以显示给用户。在业务层添加一个额外的迭代似乎非常浪费，只是为了演示而立即再做一次，所以我希望这尽可能快。

这是一个常见的任务，所以我真的在寻找一个可以一遍又一遍地重复的好模式。

            回答 #1

赞同：9

时间：2010-05-21T14:43:37.533

上面示例的问题是它非常慢。我有一个大约 400 行的 DataTable，这个转换需要 5 到 6 秒！  

这似乎是一项非常常见的任务，所以我很惊讶在这里没有看到有人提供更高性能的解决方案。

*** 更新！！***
只是为了好玩，我想我会尝试使用 LINQ 进行转换，而不是遍历 DataTable 并添加到我的列表中。以下是我所做的：

```
 List<MyObject> returnList = new List<MyObject>();

   MyDataTable dtMyData = new MyTableAdapter().GetMyData();

   returnLists = (from l in dtMyData
                 select new MyObject
                 {
                    Active = l.IsActive,
                    Email = l.Email,
                    //...
                    //About 40 more properties
                    //...
                    ZipCode = l.Zipcode
                  }).ToList(); 
```

第一种方法（遍历每一行）耗时 5.3 秒，使用 LINQ 的方法耗时 1.8 秒！

            回答 #2

赞同：7

时间：2009-01-13T22:18:24.703

你`DataTable`提前知道了和类型化对象的结构吗？您可以使用委托来进行映射。如果您不这样做（即您只知道 a`Type`和属性），则有一些方法可以加速动态成员访问（例如`HyperDescriptor`）。

无论哪种方式，考虑一个迭代器块；这样您就不必第二次缓冲对象；当然，如果您只处理较小的行数，这不是问题。

你能澄清其中的任何一点吗？我可以添加更多细节...

最简单的是，有什么问题：

```
DataTable table = new DataTable {
    Columns = {
        {"Foo", typeof(int)},
        {"Bar", typeof(string)}
     }
};
for (int i = 0; i < 5000; i++) {
    table.Rows.Add(i, "Row " + i);
}

List<MyType> data = new List<MyType>(table.Rows.Count);
foreach (DataRow row in table.Rows) {
    data.Add(new MyType((int)row[0], (string)row[1]));
} 
```

（上述问题可能会引导正确的方法......）

            回答 #3

赞同：1

时间：2019-10-29T12:50:32.143

我知道这个答案很晚了，但我花了一个多小时来准备这段代码，因为我首先需要这个，然后我认为寻找这个问题的解决方案的人可能会使用这个..

为了使我的答案正常工作，您的列表属性的名称需要与 DataBase 表列（字段）或 DataTable 列名称中的名称相同。

**解决方案：**

```
public List<dynamic> GetListFromDT(Type className, DataTable dataTable)
        {
            List<dynamic> list = new List<dynamic>();
            foreach (DataRow row in dataTable.Rows)
            {
                object objClass = Activator.CreateInstance(className);
                Type type = objClass.GetType();
                foreach (DataColumn column in row.Table.Columns)
                {
                    PropertyInfo prop = type.GetProperty(column.ColumnName);
                    prop.SetValue(objClass, row[column.ColumnName], null);   
                }
                list.Add(objClass);
            }
            return list;
        } 
```

**如何使用 ？**

假设您有一个名为 dtPersons 的填充数据表

```
DataTable dtPersons; //populate this datatable 
```

然后假设您有一个具有以下属性的类。

```
public class Persons{
    public string Name {get; set;}
    public int Age {get; set;}
} 
```

现在打包并将方法放入您的模型中。调用方法如下。

```
List<dynamic> dynamicListReturned = GetListFromDT(typeof(Persons), dataTable);
List<Persons> listPersons = dynamicListReturned.Cast<Persons>().ToList(); 
```

就是这样，现在您从***listPersons***的数据表中获得了您的列表。

请记住：类属性和 DataTable/Database 中的名称应该相同

            回答 #4

赞同：0

时间：2009-01-13T22:31:24.243

无论如何，您将需要遍历数据行并将它们转换为您的对象，但是您可以使用构造函数编写一个自定义集合，该构造函数采用数据行的集合，并在请求时将每个项目转换为您的对象类型，而不是全部一次。

假设您定义了实现`IList<T>`. 然后它可以有两个内部字段——一个对数据行集合的引用和一个`List<T>`. 将`List<T>`被初始化为数据行集合的长度，但具有空值。

现在在索引器中，您可以检查该索引`List<T>`处是否包含值，如果没有，您可以使用任何有用的方法创建对象并将其存储在那里，然后再返回它。

这将推迟对象的创建，直到它们被请求，并且您只会创建被请求的对象。

您的对象可能需要使用 DataRow 的构造函数，或者您需要某种工厂来创建它们，但这是另一个主题。

            回答 #5

赞同：0

时间：2010-01-26T07:36:13.263

只是为了在一个简单的控制台应用程序中为 Mark 的回答提供更多的用户友好性：

```
class Program
{
    static void Main(string[] args)
    {
        //define a DataTable obj
        DataTable table = new DataTable
        {
            Columns = {
            {"Foo", typeof(int)},
            {"Bar", typeof(string)}
         }
        };
        //populate it the DataTable 
        for (int i = 0; i < 3; i++)
        {
            table.Rows.Add(i, "Row " + i);
        }

        List<MyType> listWithTypedObjects= new List<MyType>(table.Rows.Count);
        foreach (DataRow row in table.Rows)
        {
            listWithTypedObjects.Add(new MyType((int)row[0], (string)row[1]));
        }

        Console.WriteLine(" PRINTING THE POPULATED LIST ");
        foreach (MyType objMyType in listWithTypedObjects)
        {
            Console.Write(" I have object of the type " + objMyType.ToString() + " => " );
            Console.Write(" with Prop1OfTypeInt " + objMyType.Prop1OfTypeInt.ToString() + " , ");
            Console.WriteLine(" with Prop1OfTypeInt " + objMyType.Prop2OfTypeString.ToString() + "  "); 
        }

        Console.WriteLine(" \n \n \n HIT A KEY TO EXIT THE PROGRAM ");
        Console.ReadKey();
    }
}

class MyType {

    public int Prop1OfTypeInt { get; set; }
    public string Prop2OfTypeString { get; set; } 

    /// <summary>
    /// Note the order of the passed parameters is important !!!
    /// </summary>
    public MyType( int prop1OfTypeInt , string prop2OfTypeString)
    {
        this.Prop1OfTypeInt = prop1OfTypeInt;
        this.Prop2OfTypeString = prop2OfTypeString; 

    }
} 
```

            回答 #6

赞同：-5

时间：2015-04-10T07:42:55.317

```
public partial class issuereceive_manageroffice_bal
{
    public int issue_id{get;set;}
    public string process{get;set;}
    public DateTime issue_date{get;set;}
    public TimeSpan issue_time{get;set;}
    public string eg_no{get;set;}
    public string lotno{get;set;}
    public string clarity{get;set;}
    public string sieves{get;set;}
    public string shape{get;set;}
    public double issue_carat{get;set;}
    public int issue_pieces{get;set;}
    public int receive_pieces{get;set;}
    public double receive_carat{get;set;}
    public int kp_pieces{get;set;}
    public decimal kp_carat{get;set;}
    public double loss{get;set;}
    public string issue_manager{get;set;}
    public string issue_by{get;set;}
    public string receive_by{get;set;}
    public int status{get;set;}
    public DateTime receive_date{get;set;}
    public string receive_time{get;set;}
    public int factory_id{get;set;}

}

List<issuereceive_manageroffice_bal> issue_receive_list = new List<issuereceive_manageroffice_bal>();
issue_receive_list =
      (from DataRow dr in DataTable.Rows
      select new issuereceive_manageroffice_bal()
           {
               issue_id = 0,
               issue_time = TimeSpan.Parse("0"),
               receive_time = null,
               shape = null,
               process = dr["process"].ToString(),
               issue_date = Convert.ToDateTime(dr["issue_date"]),
               eg_no = dr["eg_no"].ToString(),
               lotno = dr["lotno"].ToString(),
               clarity = dr["clarity"].ToString(),
               sieves = dr["sieves"].ToString(),
               issue_carat = dr["issue_carat"].ToString() != "" ? double.Parse(dr["issue_carat"].ToString()) : 0,
               issue_pieces = dr["issue_pieces"].ToString() != "" ? int.Parse(dr["issue_pieces"].ToString()) : 0,
               receive_carat = dr["receive_carat"].ToString() != "" ? double.Parse(dr["receive_carat"].ToString()) : 0,
               kp_pieces = dr["kp_pieces"].ToString() != "" ? int.Parse(dr["kp_pieces"].ToString()) : 0,
               kp_carat = dr["kp_carat"].ToString() != "" ? decimal.Parse(dr["kp_carat"].ToString()) : 0,
               loss = dr["loss"].ToString() != "" ? double.Parse(dr["loss"].ToString()) : 0,
               issue_manager = dr["lotno"].ToString(),
               issue_by = dr["issue_by"].ToString(),
               receive_by = dr["receive_by"].ToString(),
               status = dr["status"].ToString() != "" ? int.Parse(dr["status"].ToString()) : 0,
               receive_date = Convert.ToDateTime(dr["receive_date"]),
               factory_id = dr["factory_id"].ToString() != "" ? int.Parse(dr["factory_id"].ToString()) : 0,

           }).ToList(); 
```

        dojo - 您使用 Dojo 小部件的最终开发环境是什么？

ID：441037

赞同：3

时间：2009-01-13T22:11:31.817

标签：dojo

我是使用 Dojo 库的新手，我想知道：在 Dojo 小部件上工作的最终开发环境是什么？

我希望至少有 JavaScript 语法检查，以及对标准 Dojo 小部件和函数的代码完成支持。

什么样的开发环境——无论是免费的还是购买的——你对这样的工作最满意？

            回答 #1

赞同：1

时间：2009-01-19T08:21:05.957

[Aptana Studio](http://www.aptana.com/studio)具有 dojo 的语法检查和代码完成功能。有关其他想法，请参阅此线程：[JavaScript IDEs](https://stackoverflow.com/questions/41880/javascript-ides)。

            回答 #2

赞同：0

时间：2009-02-04T18:01:05.467

我使用 AJAX 工具包框架：来自 Eclipse 的 JavaScript 开发工具。

[http://wiki.eclipse.org/index.php/ATF/JSDT](http://wiki.eclipse.org/index.php/ATF/JSDT)

            回答 #3

赞同：0

时间：2012-01-19T21:40:23.990

JetBrains 制作了一个名为 WebStorm 的工具，强烈推荐它：

[http://www.jetbrains.com/webstorm/](http://www.jetbrains.com/webstorm/)

如果您在 J2EE 领域工作，您可以将这些功能与 IDEA 集成，这是他们的 Java IDE。

        asp.net - ASP.NET UpdatePanel 错误 htmlfile：未知的运行时错误，updatePanelElement.innerHTML=rendering

ID：441038

赞同：2

时间：2009-01-13T22:11:58.570

标签：asp.net, ajax, updatepanel

在触发 UpdatePanel 后调试 ASP.NET Web 应用程序时出现此错误：

![ASP.NET htmlfile：未知的运行时错误 updatePanelElement.innerHTML=rendering](https://i.stack.imgur.com/CqrGC.gif)

htmlfile：未知的运行时错误

并且“updatePanelElement.innerHTML=rendering”在 ScriptResource.axd 文件中突出显示。

            回答 #1

赞同：4

时间：2009-10-21T16:01:00.107

我遇到了同样的问题。在我的情况下，页面（表格）的设计不正确。这是我的场景中的问题详细信息：

```
 <table>
<tr>
<td>
    <asp:Label id="Lb1" runat="server"/>
</td>
</tr>
<asp:UpdatePanel id="UP1" runat="server">
<ContentTemplate>
       <!-- controls in Update Panel-->
</ContentTemplate>
</asp:UpdatePanel>
<tr>
<td>
    <asp:Button id="btn" OnClick="btn_Click" runat="server"/>
</td>
</tr>
</table> 
```

我已更改为

```
<table>
<tr>
<td>
    <asp:Label id="Lb1" runat="server"/>
</td>
</tr>
**<tr>
<td>**
<asp:UpdatePanel id="UP1" runat="server">
<ContentTemplate>
       <!-- controls in Update Panel-->
</ContentTemplate>
</asp:UpdatePanel>
**</td>
</tr>**
<tr>
<td>
    <asp:Button id="btn" OnClick="btn_Click" runat="server"/>
</td>
</tr>
</table> 
```

问题已解决，将更新面板移动到另一个表格行。所以我坚信适当的屏幕设计应该解决这类问题。

            回答 #2

赞同：2

时间：2009-10-08T14:47:50.663

感谢上面的解释-我找到了一个解决方案，方法是用需要由事件更新的 li 包装 UpdatePanel。希望有帮助。

例如

```
<li>
<asp:UpdatePanel runat="server" ID="UpdatePanelCustInfo" UpdateMode="Conditional" RenderMode="Inline">
    <Triggers>
        <asp:AsyncPostBackTrigger ControlID="ddlCountry" />
    </Triggers>
    <ContentTemplate>
        <label>State:</label>
        <asp:DropDownList ID="ddlStateProvince" AutoPostBack="False" runat="server" CssClass="adminInput">
        </asp:DropDownList>
    </ContentTemplate>
</asp:UpdatePanel>
</li> 
```

            回答 #3

赞同：2

时间：2010-12-21T07:41:31.837

有同样的错误错误地将更新面板放置在标签之间，而不是嵌套标签。那个修复做到了，所以我从这里拿走了它：

```
<table>
<tr>
<asp:UpdatePanel runat="Server">
<ContentTemplate>
<td>

    //code here

</td>
</ContentTemplate>
</asp:UpdatePanel>
</td>
</table> 
```

到 ：

```
<table>
<tr>
<td>
<asp:UpdatePanel runat="Server">
<ContentTemplate>

    //code here

</ContentTemplate>
</asp:UpdatePanel>
</td> 
```

            回答 #4

赞同：1

时间：2009-03-08T15:25:47.233

我得到了同样的错误，但解决了。

我在 UpdatePanel 中嵌套了 html 表单。只需删除 Form 标签即可解决问题。

            回答 #5

赞同：0

时间：2009-01-13T22:15:03.713

这似乎是因为我的 UpdatePanel 在有序列表 <ol> 容器中。我的 UpdatePanel 的 ContentTemplate 中有列表项 <li> 标签。

```
<ol>
    <li>...</li>
    <asp:UpdatePanel ...>
        <ContentTemplate>
            <li id="lione" runat="server">...</li>
            <li id="litwo" runat="server">...</li>
        </ContentTemplate>
        <Triggers>
            ...
        </Triggers>
    </asp:UpdatePanel>
    <li>...</li>
</ol> 
```

这种方式对我来说很有意义，但我想我需要重新考虑我的页面布局。

            回答 #6

赞同：0

时间：2013-06-07T17:31:12.573

说这让我发疯是轻描淡写。我收到了与 OP 描述的相同的错误，并玩弄了我的 HTML，试图找出为什么我无法写入 ap 标记中的 div。最后，我复制了我的页面 HTML，只是为了弄乱我页面上排列的 HTML，发现它与我正在摆弄的特定 UpdatePanel 无关。我的页面底部的正文内容中有 javascript 脚本标签，我不知道具体原因，但 IE8 讨厌这种安排。我能够删除正文内容中的所有脚本，并将其放在页面的 head 标签中，这个问题就消失了。高温高压

        architecture - 新公司基础设施的企业服务/数据总线？

ID：441042

赞同：2

时间：2009-01-13T22:12:49.723

标签：architecture

我正在为一项新业务设计一个系统，并且处于一个独特的“全权委托”位置。  

就像每家企业一样，它计划持续很长时间并发展到不确定的规模。

是否值得全力以赴并开发具有显式数据和服务总线的完整企业架构，其中每一层都是某种网络服务......或者我应该设计一个可能工作的最小系统并计划有机地发展它时间流逝。

根据我的经验，我认为*有机种植*™ 系统是最难继承的，所以我想知道社区的想法是什么？

我们是否处于发展没有这些层次的业务是一种不好的做法的阶段，即使它很小？

谢谢

            回答 #1

赞同：4

时间：2009-01-13T22:21:15.150

作为一般经验法则，在不知道您的项目细节的情况下，我会选择最小/最简单的可行解决方案。如果他们期望在很长一段时间内成长，他们应该期望他们的 IT 解决方案与他们一起成长。

这很不幸，但似乎大多数软件都需要尝试几次才能正确处理，即使这样，将发生的自然变化也很难处理。

因此，除非您可以非常清楚地说明为什么将大量精力投入到将来可能/发生/需要的事情上，否则我会保持简单。

至于继承有机增长的™系统，我认为如果利益相关者不知道你从简单的东西开始，一旦需求改变可能会被抛弃（但经验不会！！！！ ) 那么它可能是噩梦，因为你不能做正确的事。但是，如果每个人从一开始就知道这个想法是什么，并且他们应该期待 IT 解决方案的变化以及业务的变化/增长，那么在我的拙见中不应该有任何大问题。

总结做最简单的事情，并确保利益相关者明白这不是一次性的事情。

            回答 #2

赞同：2

时间：2009-01-14T05:17:22.363

做最简单的解决方案。如果您现在创建一个“完整的解决方案”，您很可能会错过一些重要的需求，或者浪费时间和金钱来添加不需要的功能。也就是说，设计您的解决方案，以便可以相当容易地修改部分。  

作为一个实际示例，如果您使用 .NET 进行编码，请为每个“服务”创建一个接口和默认实现。尽可能针对界面编程。稍后，如果您需要中断服务，您将能够轻松地放入实现您的接口的 WCF 客户端。控制反转也可以帮助您解决这个问题。

            回答 #3

赞同：0

时间：2009-01-13T22:20:42.873

有机增长本身并不坏。只有做得不好的时候才不好。然而，话虽如此，我会展望未来 3 到 5 年，并对公司的计算需求和架构做出最佳估计。尝试从管理团队那里获得诚实和现实的信息，以作为您的估计基础。

        php - 使用 PHP 检查远程文件是否是格式正确的 XML

ID：441044

赞同：8

时间：2009-01-13T22:14:08.503

标签：php, xml, feed

我有一个 PHP 驱动的站点，其中包含一个 XML 股票提要，它是从 ASP 远程提供的（即 XML 提要 url 的顺序是：[http](http://remote.com/client.asp) ://remote.com/client.asp ）。

由于提要经常不可用（我的意思是网站返回 ASP 错误），我想在包含提要之前检查提要是否是格式正确的 XML。我常用的 url_exists 函数并不能解决问题，因为即使“出错”，URL 也确实存在。

TIA。

            回答 #1

赞同：21

时间：2009-01-13T22:21:26.697

使用[cURL](http://au2.php.net/curl)获取结果，使用[simplexml](http://au2.php.net/simplexml)检查 XML 是否[格式](http://en.wikipedia.org/wiki/XML#Well-formed_and_Valid_XML_documents)正确。

```
$curl = curl_init();
curl_setopt($curl, CURLOPT_URL, "http://remote.com/client.asp");
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
$output = curl_exec($curl);
curl_close($curl);
if (simplexml_load_string($output)) {
  // well-formed XML
} else {
  // it isn't
} 
```

        wcf - WCF 安全性：对于以 Java 客户端为主的 Intranet，什么最适合？

ID：441052

赞同：1

时间：2009-01-13T22:16:12.480

标签：wcf, security

数据不敏感，我真的只考虑安全性，以便我可以跟踪谁在调用我们的系统。

我想只让每个“客户端”在请求中发送一个“api-key”，然后对有效密钥列表进行交叉检查。

然后我可以记录请求并监控客户端的活动。

注意：性能非常关键，所以我负担不起很多开销。

有任何想法吗？

            回答 #1

赞同：1

时间：2009-04-28T23:24:25.893

HTTP 的 Basic auth 相当轻量级，可用于 RESTful 服务和 SOAP。请参阅[Windows 帐户以外的 WCF REST 服务的基本身份验证？](https://stackoverflow.com/questions/660445/)详情。

        delphi - 在 Delphi 项目中更改多个表单的属性的快速方法？

ID：441060

赞同：5

时间：2009-01-13T22:18:28.200

标签：delphi, delphi-2007

我认为 GExperts 中有一些东西可以做到这一点，但如果有的话我看不到。

我必须在包含大约 100 个不同表单的项目中更改每个表单中的 SCALED 属性（从默认值 TRUE 到 FALSE）。因为 SCALED 的默认值为 TRUE，它实际上并没有在 .DFM 文件中显示为一行（当以文本形式查看时），所以我无法使用 GREP（等）“获取”任何内容。

谁能建议一种以所有这些形式设置此属性的快速方法？表单是各种不同类的子类，我真的不想制作某种覆盖 SCALED 属性的中间 TForm 后代 - 部分原因是我尝试（简要地）这样做并发现将 SCALED 属性设置为 false*在*继承创建之后对表单没有影响，并且在继承创建*之前*设置它会导致异常。:-)

有人有什么建议吗？如果可以的话，我真的很想避免一一打开所有这些表格，如果只是因为我一定会错过一个！

            回答 #1

赞同：8

时间：2009-01-14T01:02:54.280

我建议您将所有表格更改为来自共同祖先。然后在未来你可以改变基类，它会在任何地方修复它。  

通常，我更喜欢始终使用自定义后代类，而不是出于这个特定原因我将经常使用的股票类。  

            回答 #2

赞同：7

时间：2009-01-14T08:05:35.860

如果您所有的 DFM 文件不是二进制文件，而是文本文件（这是个好主意，除非您需要与 Delphi 4 或更早版本兼容），您当然可以使用 grep / sed / awk。DFM 的格式不固定，取而代之的是

```
 OldCreateOrder = False
  Scaled = False 
```

它还可以包含

```
 OldCreateOrder = False Scaled = False 
```

因此，您可以使用 grep 查找只有 TForm 具有的另一个属性，该属性在您的所有表单中设置为存储在 DFM 中的值（OldCreateOrder 将是候选对象），并用包含两个属性的另一行替换这些行。

下次您在 IDE 中保存该表单时，将更正该格式。

**编辑：**

如果您的表单是二进制的，则使用 Delphi bin 目录中的 convert.exe 工具（使用完整路径，因为 Windows 中有另一个 convert.exe）将 DFM 转换为文本，然后添加缺少的属性，然后（可选）转换将 DFM 恢复为二进制。如果您对奇怪的格式不满意 - 将 DFM 从文本转换为二进制再转换回文本，这将为您提供格式正确的文本 DFM 文件。所有这些都很容易编写脚本。

            回答 #3

赞同：2

时间：2009-04-01T05:22:30.773

是的，GExpert 包括一个“设置组件属性”专家。它有一个“模拟”模式来看看它会做什么。此工具可用于在编译应用程序之前停用数据集或数据库连接。

        python - 分布式python服务器的高效布局？

ID：441061

赞同：2

时间：2009-01-13T22:18:32.553

标签：python, multiprocessing

如果我想让 Python 分布在多台计算机上的多个处理器上，我最好的方法是什么？如果我有 3 个八核服务器，那意味着我必须运行 24 个 python 进程。我将使用[多处理库](http://docs.python.org/library/multiprocessing.html)，并共享对象，看起来最好的主意是使用管理器。我希望所有节点作为一个大进程一起工作，所以一个管理器是理想的，但这会给我的服务器带来单点故障。有更好的解决方案吗？复制经理的对象存储是个好主意吗？

此外，如果经理要进行所有数据库查询，那么将它与数据库放在同一台机器上是否有意义？

            回答 #1

赞同：3

时间：2009-01-13T22:38:10.907

我认为更多信息会有所帮助，例如您正在提供什么服务，您将使用哪种数据库，您有什么样的延迟/吞吐量要求等等。很多东西取决于您的要求：例如。如果您的系统是一个典型的服务器，它有很多读取而不是很多写入，并且您在读取稍微陈旧的数据方面没有问题，您可以对每个进程的缓存执行本地读取，并且只将写入推送到数据库，将结果广播回缓存。

首先，我认为这取决于经理必须做什么。毕竟，如果您的系统是如此微不足道，以至于在没有灾难性硬件故障的情况下不会发生故障，那么担心单点故障可能毫无意义。但是如果你只有一个，把它和数据库放在同一台机器上是有意义的。你减少了延迟，如果一个没有另一个就宕机了，你的系统就无法生存。

            回答 #2

赞同：3

时间：2009-01-13T22:45:17.333

您在分配流程时面临两个主要挑战：

1.  协调正在拆分、分发和重新收集的工作（您可能会说，映射和缩减）
2.  在相互依赖的进程之间共享正确的实时数据

＃1的答案将在很大程度上取决于您正在执行的处理类型。如果它很容易水平分区（即您可以将较大的任务拆分为几个*独立*的较小任务），那么像[HAProxy](http://haproxy.1wt.eu/)这样的负载均衡器可能是分散负载的便捷方式。

如果该任务不能简单地水平分区，我首先会看看现有的工具，如[Hadoop](http://hadoop.apache.org/core/)是否适合我。分布式任务管理是一项难以完成的任务，而轮子已经被发明出来了。

至于#2，在进程之间共享状态，如果你共享一个绝对最小值，然后只以明确定义的方式共享它，你的生活会容易得多。即使是最小的任务，我也会亲自使用由您选择的 RDBMS 支持的[SQLAlchemy 。](http://www.sqlalchemy.org/)对于小型和大型项目，查询界面功能强大且无痛。

            回答 #3

赞同：0

时间：2009-01-14T07:48:08.610

似乎您的问题的要点是如何共享对象和状态。更多信息，特别是大小、频率、变化率和数据来源将非常有帮助。

对于跨机器共享内存，您可能想查看[memcached](http://www.danga.com/memcached/)。您可以存储数据并从任何工作进程快速轻松地访问它。

如果您的场景更像是一个简单的作业分配模型，您可能希望查看排队服务器 - 将您的作业及其相关数据放入队列中，并让工作人员从队列中提取作业。[Beanstalkd](http://xph.us/software/beanstalkd/)可能是队列的一个不错的选择，这里有一个[入门](http://parand.com/say/index.php/2008/10/12/beanstalkd-python-basic-tutorial/)教程。

        c++ - c++ push_back，非 const 复制构造函数

ID：441067

赞同：2

时间：2009-01-13T22:20:35.667

标签：c++, copy-constructor

我有一个类，我想 push_back 到一个双端队列中。问题是当我向后推时，我需要更改原始对象，因此我需要一个非 const 复制 ctor。现在，如果我实现我的 const 复制 ctor 被调用。如果我删除了 const ctor，我会收到一个关于没有可用 ctors 的编译错误。我如何以一种在我传入时可以修改原始结构的方式来实现它？我需要修改它，因为该类在超出范围时会破坏对象，并且我想告诉它在周围有另一个实例时不要这样做。我不能使用 boost，因为我的平台不支持它。

            回答 #1

赞同：8

时间：2009-01-13T22:34:09.417

您的问题是标准容器的基本要求是对象是可复制构造的。这不仅意味着它们具有复制构造函数，而且还意味着如果复制对象，则副本和原始对象是相同的。

但是，您的对象类似于移动构造函数语义。也就是说，移动后，新对象拥有资源，而旧对象为空。从 C++03 开始​​，deque 不支持这一点。也就是说，顺便说一下，禁止将 auto_ptr 放入容器的原因相同。

名为 c++0x 的下一个 C++ 版本将通过引入特殊的移动构造函数来支持这些移动语义。在那之前，当您想将其放入标准容器中时，您必须使用*共享所有权的对象。*这意味着如果您复制您的对象，并且原始对象超出范围，则在所有副本超出范围之前不会释放拥有的资源。例如，考虑使用 boost::shared_ptr，或者将其包装到您的类中，如果您不想编写自己的类来管理它。

            回答 #2

赞同：2

时间：2009-01-14T02:30:23.167

如果您没有对资源做任何狡猾的事情（请参阅其他评论），那么使您想要更改的成员变量*可变*将允许您在 const 函数中更改它。

            回答 #3

赞同：1

时间：2009-01-13T22:30:15.850

根据您要执行的操作（更多详细信息会很好），您可以在调用之前/之后修改对象，也可以`push_back`编写一个简单的包装类，该类接受指向您的类的指针并可以插入到`deque`. 然后，该对象可以在构造/破坏/等方面对您的类执行适当的操作。

            回答 #4

赞同：1

时间：2009-01-13T22:34:56.403

你不能做你想做的事。您必须使用指针，无论是普通的还是智能的（但不是 auto_ptr<>）。为什么不能使用 Boost 智能指针？它们非常轻量级，应该可以在所有合理的标准 C++ 编译器中工作。您不必使用所有的 Boost。

        ruby - Ruby 风格问题：块还是继承？

ID：441071

赞同：4

时间：2009-01-13T22:21:23.093

标签：ruby, oop, coding-style

我有一些课程会根据某些条件做一些事情。条件作为参数发送给某些方法。我的问题与 ruby​​ 编码风格有关：

*   条件应该作为 lambdas/blocks 发送，还是作为从条件类继承的某些对象发送？

*   在 OOP 方面哪个更有效？

谢谢 ！

            回答 #1

赞同：6

时间：2009-01-13T22:28:48.413

从执行时间的角度来看，我不知道哪个更有效，但从用户界面的角度来看，块更有效。使用您的方法的人只需将条件写入一个块中，而不必定义一个全新的类、创建一个实例并将其传递给您的方法。

            回答 #2

赞同：4

时间：2009-01-14T00:02:06.413

这一切都可以忽略不计，这取决于您实际在做什么以及是否可以缓存条件对象或过程，但通常**块是 Ruby 方式**，它们比对象创建更快。

这是一个无用的基准：

```
require 'benchmark'

# Useless parent class
class Condition; end

# Useless inheritance.  Duck typing FTW.
class AddCondition < Condition  
  def call
    1 + 1
  end
end

def with_object(condition)
  condition.call
end

def with_block
  yield
end

n = 100000
Benchmark.bm(10) do |x|
  x.report("object:") do
    n.times do; with_object(AddCondition.new); end
  end
  x.report("block:") do
    n.times do; with_block { 1 + 1 };          end
  end
end 
```

结果：

```
 user     system      total        real
object:     0.090000   0.000000   0.090000 (  0.087227)
block:      0.060000   0.000000   0.060000 (  0.063736) 
```

            回答 #3

赞同：3

时间：2009-01-13T22:38:26.023

Lambda 更像是 Ruby 的方式——除此之外，为什么要为一个简单的 lambda 就可以的东西定义一个完整的大类？或者，你可以像 Rails 那样传递条件。

            回答 #4

赞同：1

时间：2009-01-13T23:24:22.137

在这种情况下我会使用继承的唯一情况是，如果条件本身使用许多通用代码，可以在超类中**完全**实现（无需覆盖子类中的任何内容），但是使用 java 继承的做法样式接口在 Ruby 中并不常见。

无论如何，您正在做的事情被称为控制和策略模式的反转，请阅读以获取更多信息。关键是让代码的用户决定代码的最终行为的（好的）决定，而不是配置参数或实现中的某种其他类型的分支。

        c - vim / ubuntu中的双引号？

ID：441075

赞同：4

时间：2009-01-13T22:22:16.897

标签：c, linux, vim

我为我要问的这个令人难以置信的新问题深表歉意，但由于某种原因，我的大脑被锁住了：

我试图在运行 Ubuntu 的虚拟机上的 gvim 上用 C 语言编写代码，但是我的 Hello World 引发编译器错误，我怀疑这与引号与标准引号不同的 ascii（unicode？）代码有关。它不会将“Hello World”识别为字符串，并且`"stray \250 in program" as well as "stray \302 in program"`每次都说两次。  

要输入双引号，我必须按住`Shift`并双击引号键。这似乎是所有程序（终端、开放式办公室等）的全局设置

我是否正确假设这是引号的问题，如果是这样，你们中的任何人会碰巧知道我的问题的解决方案吗？

            回答 #1

赞同：11

时间：2009-01-13T22:28:07.617

听起来您设置了错误的键盘映射。我在使用“英国（带死键的国际）”键盘映射时遇到了与您相同的症状。将其更改为标准的英国版本，效果很好。

高温高压

抢

            回答 #2

赞同：0

时间：2009-01-13T22:23:58.313

双引号字符（靠近回车键）不是更合适吗？

        c++ - 提升精简版？

ID：441078

赞同：5

时间：2009-01-13T22:23:09.797

标签：c++, boost

我听说有一个简单的 boost 实现，它只有智能指针和其他一些非常基本的东西。我想我听说它也不使用任何操作系统功能。我试图寻找它，但什么也没找到。有谁知道它叫什么或不需要操作系统调用的boost风格的智能指针的实现？

            回答 #1

赞同：14

时间：2009-01-13T22:32:14.223

您可以使用 bcp，但请记住，*使用*Boost 库只会让您为使用的内容付费 - 智能指针都以仅头文件的方式实现，这意味着没有操作系统调用，没有可链接到的编译库等。因此，如果您不分发源代码，则可以下载完整的 boost 集，并仅使用您需要的部分，而不会给您的应用程序带来任何（不经要求的）痛苦。

            回答 #2

赞同：7

时间：2009-01-13T22:27:57.183

您可以使用[bcp 实用程序](http://www.boost.org/doc/libs/1_52_0/tools/bcp/doc/html/index.html)仅提取支持给定库所需的完整树的子集。不过，我不知道有任何独立的精简 Boost 实现。

            回答 #3

赞同：4

时间：2009-01-15T13:55:34.033

“boost lite”通常用于指代一种提升使用方式，您将自己限制为“仅标题”提升组件。因此，这包括大量模板化的智能指针标头和 boost::bind，但不包括 regex 或 program_options 之类的东西，它们需要您与库链接才能获得大部分功能。

如果您正在构建和发布 .libs，boost-lite 样式意味着您不会引入对 boost libs 的链接依赖（下游用户的麻烦更少），如果您广泛使用[pimpl 习惯用法](http://en.wikipedia.org/wiki/Opaque_pointer)，您可以只使用 smart ptrs等内部和lib用户甚至不会在你的标题中看到提升类型。这可能是一种有用的变更管理技术，用于在保守环境中引入隐身提升。

即，它只是使用普通 boost 安装的一种特殊方式，而不是一些单独的包。

            回答 #4

赞同：1

时间：2009-01-13T22:38:00.377

智能指针是[标准库 tr1 扩展的](http://en.wikipedia.org/wiki/Technical_Report_1)一部分。如果您的编译器供应商包含它，那可能就是要走的路。我知道 gcc 和 Visual Studio 2008 有 2 个支持它们的示例。

            回答 #5

赞同：0

时间：2009-01-13T22:27:47.603

将 boost 与[boost bcp一起使用](http://www.boost.org/doc/libs/1_37_0/tools/bcp/bcp.html) 

            回答 #6

赞同：0

时间：2012-04-30T15:42:03.327

如果我没记错的话，我认为你可以只链接你需要使用的增强部分？我认为您不能像以前那样链接太多 boost*。

        asp.net - Visual Studio 2008 中出现“无法解析符号”错误？

ID：441079

赞同：5

时间：2009-01-13T22:23:34.507

标签：asp.net, code-generation, resharper, dataset

我已经开始处理以前开发人员留下的一些代码，但我遇到了一个奇怪的问题。代码是 ASP.NET 2.0 中的 C#，我在 Visual Studio 2008 中使用 ReSharper 4.1。

这段代码编译得很好，并且可以在我的 Web 应用程序中运行，但是 ReSharper 对它发出了“无法解析符号`'<name of class here>'`”的消息。这不是世界末日，但我宁愿在我的代码文件中没有大量的红色错误。

示例行：

`InvoiceItem invoiceItems = GetInvoiceItems(serviceLineItemID);`

`InvoiceItem`是一个带有自动生成的 .cs 代码隐藏的 .xsd 数据集。过去，我使用 xsd.exe 为数据集创建 .cs 文件，并将 .cs 包含在我的项目中，但这在这种情况下不起作用。我一直是 .NET 开发人员很长一段时间，但这是我第一次遇到这个问题。

有任何想法吗？

            回答 #1

赞同：8

时间：2009-01-13T22:29:54.837

这可能是 resharper 中的一个错误，禁用 resharper 并查看它是否仍然发生。如果是这样，请将错误报告给 resharper。他们通常反应灵敏。

            回答 #2

赞同：1

时间：2009-03-21T14:20:24.520

我知道这有点晚了，但我刚刚确认构建 1212 似乎正在使用自动生成的代码。

            回答 #3

赞同：0

时间：2009-01-14T07:35:43.050

可能是 ReSharper 中的错误。您可以尝试 ReSharper 4.5 [nightly builds](http://www.jetbrains.net/confluence/display/ReSharper/ReSharper+4.5+Nightly+Builds) (pre-release)，看看它是否已经针对这个版本进行了修复。如果没有，请在我们的问题跟踪器中提交错误（[说明](http://www.jetbrains.net/confluence/display/ReSharper/ReSharper+Issue+Tracker)）。谢谢。

            回答 #4

赞同：0

时间：2011-04-07T17:36:51.313

如果您使用 ReSharper 清理代码，它有时会更新代码页上的命名空间，但不会更新设计端。这一切都会缩短引用 dll 的控制注册。有时有效，有时无效。

编辑：哇，这是旧的......需要开始查看日期......

        ajax - 检索表单数据的最佳策略是什么？客户端ajax/服务器

ID：441084

赞同：1

时间：2009-01-13T22:26:07.217

标签：ajax, callback, interaction

最近向我介绍了 Ajax 表单数据处理，包括使用 jTemplates 来保证一些可重复性和 jQuery，一个很棒的库。

但我有点困惑。对于表单用户交互，我使用 Ajax 调用并处理纯 HTML 标记。因此**，如果我想在加载表单时绑定表单数据，我需要通过 jQuery/JS 使用 Ajax 来实现。**  这对我来说似乎不太好。  **我觉得 onLoad 初始化应该只发生在服务器上**。但是，我需要找到一些方法来公开表单标记，以便以后的 Ajax 交互变得简单。

**例如，如果我想在服务器上绑定一些列表，什么控件可以处理这个，以便我以后可以使用 Ajax 添加/删除项目？**

我希望我的观点很清楚。谢谢您的帮助！

            回答 #1

赞同：1

时间：2009-01-20T06:36:31.423

@Rex 做你的例子的方法很简单。做一些中继器控制

```
 <table id="suppliers" >
                                <tbody>
                            <asp:Repeater ID = "rptSuppliers" runat = "server">
                                <ItemTemplate>
                                    <tr style = "padding:10px;" class = "supplier" tag = '<%# Eval("ID") %>' id = 'supplier_<%# Eval("ID") %>'>
                                        <td style = "width:200px;">ספק:&nbsp;<%# Eval("Supplier.Group.GroupName") %></td>
                                        <td style = "width:200px;">איש קשר:&nbsp;<%# Eval("Supplier.Profile.ProfileData.FullName")%></td>
                                        <td>מחיר:&nbsp;
                                        <%--כדי שהולדיאציה תבוצע כיאות לשדה צריך להיות שם ומזהה זהים אבל ייחודיים--%>
                                        <input class = "required price" name ="price<%# Eval("Supplier.ID") %>" id = "price<%# Eval("Supplier.ID") %>"  type="text" value = '<%# Eval("Price","{0:n2}") %>' min ="0"  style ="width:60px;"/>
                                        <input class ="supplier_id" type ="hidden" value = '<%# Eval("Supplier.ID") %>' />
                                        </td>
                                        <td style = "padding-right:10px;">
                                        <img src ="../../Images/remove40_32x32.gif" height ="16" width = "16" title = 'הסר' style = "float:right;" id = "sremove"
                                        onclick = "removeClick(this)"
                                        onmouseout = "removeOut(this)"
                                         onmouseover = "removeOver(this)" />
                                         </td>
                                    </tr>
                                </ItemTemplate>
                            </asp:Repeater>

                                                    </tbody>
                            </table> 
```

只是绑定onload一些数据

```
 rptSuppliers.DataSource = product.Suppliers;
    rptSuppliers.DataBind(); 
```

最重要的是客户端。您可以为转发器制作一些相同的内容模板，模板由 mTamplate jquery 插件生成。

```
 <script type="text/html" id="suppliers_tmpl">   
<tr style = "padding:10px;" class = "supplier" tag = '<#= ID #>' id = 'supplier_<#= ID #>'>
    <td style = "width:200px;">ספק:&nbsp;<#= Supplier #></td>
    <td style = "width:200px;">איש קשר:&nbsp;<#= Contact #></td>
    <td>מחיר:&nbsp;
    <input class = "required price" name ="price<#= SupplierID #>" id = "price<#= SupplierID #>" type="text" value = '<#= Price #>' min ="0" style ="width:60px;"/>
    <input class ="supplier_id"  type ="hidden" value = '<#= SupplierID #>'  />
    </td>
    <td style = "padding-right:10px;"><img src ="../../Images/remove40_32x32.gif" height ="16" width = "16" title = 'הסר' style = "float:right;" id = "sremove"
        onclick = "removeClick(this)"
        onmouseout = "removeOut(this)"
        onmouseover = "removeOver(this)" />
    </td>
</tr>
</script> 
```

然后如果你想把这个模板附加到你的桌子上

```
function UpdatesupplierItem(supplier) {
// Retrieve the Item template
var template = $("#suppliers_tmpl").html();
// Parse the template and merge stock data into it
var html = parseTemplate(template, supplier);
// Create jQuery object from gen'd html
var newItem = $(html);

var item_id = "supplier_" + supplier.SupplierID;
//נוסיף פריט רק במידה ואיננו קיים
var origItem = $("#" + item_id);
if (origItem.length < 1)
    newItem.appendTo("#suppliers tbody");
else
    origItem.after(newItem).remove();
return newItem; 
```

}

使您的 html 元素可用于 jquery（通过 id 或类）。去吧。

更多信息[west-wind](http://www.west-wind.com/presentations/jQuery/jQueryPart2.aspx)
那里你可以得到一些指向源的链接，你有很多例子..

            回答 #2

赞同：1

时间：2009-01-20T14:08:55.067

实现此目的的最简单方法是使用更新面板。

如果您将转发器放在更新面板中，当您的删除回发被触发时，更新面板只会刷新该更新面板中的内容。

因此，使用中继器构建行，添加删除按钮，然后从数据库中删除该行。

如果你让它在没有 ajax 的情况下工作（整个页面回发）然后添加更新面板，它“应该”直接开箱即用。

以[http://www.asp.net/ajax/documentation/live/Tutorials/CreatingPageUpdatePanel.aspx](http://www.asp.net/ajax/documentation/live/Tutorials/CreatingPageUpdatePanel.aspx)为例。

问候

加文

        asp.net - Windows 运行 ASP.NET 的 IIS 替代方案

ID：441085

赞同：36

时间：2009-01-13T22:26:23.720

标签：asp.net, windows, iis

是否有任何替代 IIS 的 Windows 来运行 ASP.NET？
CassiniEx 似乎很老了？

            回答 #1

赞同：20

时间：2009-01-13T22:29:04.543

UltiDev [Cassini](http://www.ultidev.com/products/Cassini/)是一个“免费、轻量级和可再分发的 Web 服务器，可以托管 ASP.NET 3.5、3.0、2.0 和 1.1 应用程序和静态 HTML 站点”。（它基于原始的 Cassini Web 服务器）。

除此之外，还有 Visual Studio 附带的开发 Web 服务器。但据我所知，这只能在开发期间/从 Visual Studio 中使用。

ps [UtilDev PRO](http://www.ultidev.com/products/UWS-Cassini-Pro/Default.aspx)支持asp.net 4.0。

            回答 #2

赞同：10

时间：2010-02-22T07:00:40.557

您还可以使用与 ASP.NET 兼容的Abyss [Web](https://aprelium.com/abyssws/aspnet/ "ASP.NET compability page")[服务器](https://aprelium.com/abyssws/)。

            回答 #3

赞同：7

时间：2009-01-13T22:32:31.667

我认为 Apache 2 可以做到这一点。至少在 Linux 上运行时可以。

不过，您将需要一个插件。[Mod_aspdotnet](http://sourceforge.net/projects/mod-aspdotnet)是你的朋友 :-)

            回答 #4

赞同：6

时间：2011-06-19T04:12:16.523

UltiDev 发布了其 Web 服务器产品的新版本 - [UltiDev Web Server Pro](http://ultidev.com/Forums/Default.aspx?g=posts&t=633)。它确实支持 .NET Framework 4。它是一个非常先进但又很小的可再分发 Web 服务器，适合在 Visual Studio 中调试或像 IIS 一样托管 Web 应用程序。

            回答 #5

赞同：5

时间：2009-12-01T16:46:10.043

有一些用 C# 实现的轻量级 Web 服务器的开源项目。

1.  Codeplex 上有[C# WebServer](http://www.codeplex.com/webserver)
    项目。
2.  Google Code 上的[Kayak](http://code.google.com/p/kayak/)项目。

Kayak 项目看起来很有希望，但 C# WebServer 项目目前似乎更强大。

            回答 #6

赞同：1

时间：2009-01-13T22:36:22.093

您可以将 Apache 和 mono 与 mod_mono 一起使用。看起来工作量很大，但应该完成工作。我想这取决于您需要 IIS 以外的其他东西的原因，这是否是一种可行的方法。

            回答 #7

赞同：0

时间：2019-12-16T18:04:34.517

如果您安装了任何 VisualStudio 组件，这将为您提供[http://localhost:8080/](http://localhost:8080/)上的 IIS 功能
，当然，开发服务器版本可能会有所不同（下例中为 10.0）。

```
mkdir c:\inetpub\wwwroot
cd "C:\Program Files (x86)\Common Files\microsoft shared\DevServer\10.0"
WebDev.WebServer40 /port:8080 /path:"c:\inetpub\wwwroot" /vpath:"/" 
```

        download - 使用 Adob e AIR 下载文件

ID：441090

赞同：2

时间：2009-01-13T22:27:19.883

标签：download, air

当我使用 URLStream 下载文件并使用 FileStream 写入文件时，文件还会缓存在哪里？它肯定会被缓存在某个地方，因为我第二次尝试下载相同的文件时，它就像灯光一样落下。

            回答 #1

赞同：2

时间：2009-01-16T15:51:04.590

AIR 为此使用操作系统网络堆栈，因此缓存位置将取决于操作系统缓存文件的位置。

在 Windows 上，检查 Internet Explorer 设置，在 Mac 上检查 Safari。我不确定Linux。

迈克室

        c# - 无论本地时区如何，获取另一个时区的 DateTime

ID：441109

赞同：50

时间：2009-01-13T22:31:49.310

标签：c#, datetime, .net-2.0

无论用户的本地时区设置为什么，使用 C# (.NET 2.0) 我都需要确定东部时区的时间（DateTime 对象）。

我知道这些方法，但似乎没有一种明显的方法可以获取与用户所在时区不同的时区的 DateTime 对象。

```
 DateTime.Now
 DateTime.UtcNow
 TimeZone.CurrentTimeZone 
```

当然，解决方案需要了解夏令时。

            回答 #1

赞同：95

时间：2009-01-13T22:39:16.630

在 .NET 3.5 中，有[`TimeZoneInfo`](http://msdn.microsoft.com/en-us/library/system.timezoneinfo.aspx)，它在这方面提供了很多功能；2.0SP1 有[`DateTimeOffset`](http://msdn.microsoft.com/en-us/library/system.datetimeoffset.aspx)，但这要有限得多。

获取`UtcNow`和添加固定偏移量是工作的一部分，但不支持 DST。

因此，在 3.5 中，我认为您可以执行以下操作：

```
DateTime eastern = TimeZoneInfo.ConvertTimeBySystemTimeZoneId(
    DateTime.UtcNow, "Eastern Standard Time"); 
```

但这在 2.0 中根本不存在；对不起。

            回答 #2

赞同：8

时间：2009-01-20T11:49:19.810

正如其他人所提到的，.NET 2 不包含任何时区信息。但是，信息存储在注册表中，围绕它编写一个包装类相当简单：

```
SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Time Zones 
```

包含所有时区的子键。TZI 字段值包含时区的所有转换和偏差属性，但它们都填充在二进制数组中。最重要的位（偏差和日光）是 int32，分别存储在位置 0 和 8：

```
int bias = BitConverter.ToInt32((byte[])tzKey.GetValue("TZI"), 0);
int daylightBias = BitConverter.ToInt32((byte[])tzKey.GetValue("TZI"), 8); 
```

[这是如何从注册表获取时区信息 (DST)](https://web.archive.org/web/20090807133141/http://burks.brighton.ac.uk/burks/language/pascal/uddf/pages/registry.htm)的存档？

            回答 #3

赞同：7

时间：2009-01-13T22:50:00.710

来自 - [http://msdn.microsoft.com/en-us/library/system.timezoneinfo.converttimefromutc.aspx](http://msdn.microsoft.com/en-us/library/system.timezoneinfo.converttimefromutc.aspx)

这允许通过名称找到时区，以防美国从伦敦子午线向西或向东浮动 15 度。

```
DateTime timeUtc = DateTime.UtcNow;
try
{
   TimeZoneInfo cstZone = TimeZoneInfo.FindSystemTimeZoneById("Central Standard Time");
   DateTime cstTime = TimeZoneInfo.ConvertTimeFromUtc(timeUtc, cstZone);
   Console.WriteLine("The date and time are {0} {1}.", 
                     cstTime, 
                     cstZone.IsDaylightSavingTime(cstTime) ?
                             cstZone.DaylightName : cstZone.StandardName);
}
catch (TimeZoneNotFoundException)
{
   Console.WriteLine("The registry does not define the Central Standard Time zone.");
}                           
catch (InvalidTimeZoneException)
{
   Console.WriteLine("Registry data on the Central STandard Time zone has been corrupted.");
} 
```

            回答 #4

赞同：2

时间：2009-01-13T22:51:24.327

我会为您节省时间并告诉您，在 .net 版本 2.0 中无法获取与运行软件的时区不同的另一个时区（UTC 除外）的 DateTime 对象。

但是，这并不意味着在 .net 之外没有办法做到这一点。看一下[TimeZoneInformation](http://www.codeproject.com/KB/dotnet/WorldClock.aspx)类。此类将一些 p/invoke 内容包装到 Win O/S 以从 O/S 获取时区信息。当 2.0 是新的时候，我成功地使用了它，并且效果很好。我正在处理的网站必须能够向用户显示本地的每个日期/时间，并且必须能够感知 DST，而这个课程为我们填补了账单。

            回答 #5

赞同：1

时间：2009-01-13T22:36:50.503

怎么样

```
 DateTime lclTime = DateTime.Now;
 DateTime ept = lclTime.ToUniversalTime().AddHours(
                   IsEasternDaylightSavingTime(
                       lclTime.ToUniversalTime())? -5: -4) 
```

或者如果您已经有本地 UTC，只需

```
 DateTime lclUtc = DateTime.UtcNow;
 DateTime ept = lclUtc.AddHours(
                  IsEasternDaylightSavingTime(lclUtc)? -5: -4) 
```

使用硬编码值的静态字典作为未来 50 年东部时间的 Spring-forward 和回退日期。这只有 300 个字节左右......然后对其进行索引以确定它是否是东海岸的夏令时。 ..正如所指出的，您不在乎本地区域是否为dST...

```
 private static bool IsEasternDaylightSavingTime(DateTime utcDateTime)
   {
        // hard coded method to determine 
        // whether utc datetime is Eastern Standard time
        // or Eastern Daylight Time
   } 
```

            回答 #6

赞同：0

时间：2014-12-12T01:24:51.020

日期比较是日期比较。DateTime 只是包装了一个以刻度定义的内存结构，并提供了访问内存常用部分的方法，例如日或年或时间或 TimeOfDay 等。

此外，只有在您知道源 snd 目标偏移量并且计算始终如给定的情况下才能进行转换`-1 * (sourceOffset - destOffset)`

其中括号中的部分代表时区差异。

另请参阅

[在c#中获取东部时间而不转换当地时间](https://stackoverflow.com/questions/27415652/get-eastern-time-in-c-sharp-without-converting-local-time)

        active-directory - 为什么我从 LDAP 属性中获取“System.__ComObject”？

ID：441110

赞同：4

时间：2009-01-13T22:31:53.617

标签：active-directory, ldap

我将是第一个承认这是削减和过去编程的人。我以前从未看过AD，真的不明白。我想这是我下一个研究...

无论如何，这是一些测试代码，它应该显示到期日期——可以是可读的，也可以是刻度——没关系。（这是一个 Web 表单，在开发网络服务器上运行。）

我得到的是：“System.__ComObject”

```
DirectorySearcher searcher = new DirectorySearcher();
searcher.Filter = String.Format( "(SAMAccountName={0})", "TestA33" );
searcher.PropertiesToLoad.Add( "cn" );

SearchResult result = searcher.FindOne();
DirectoryEntry uEntry = result.GetDirectoryEntry();

String expiry = uEntry.Properties["accountExpires"].Value.ToString(); 

Response.Write( expiry ); 
```

            回答 #1

赞同：6

时间：2009-01-14T15:29:16.917

Dave Cluderay 推荐的文章是个好主意。需要注意的一件重要事情是，如果将过期设置为从不，那么您获得的日期可能没有意义。

根据 MS 文档，来自 ADSI 调用的 IADsLargeInteger 表示自 1601 年 1 月 1 日（UTC）以来的 100 纳秒间隔数，“0 或 0x7FFFFFFFFFFFFFFF (9223372036854775807) 的值表示该帐户永不过期”。

            回答 #2

赞同：5

时间：2009-01-13T22:55:42.133

这是因为属性值是使用 ADSI IADsLargeInteger COM 接口表示的，需要转换为 .NET 日期。虽然我还没有尝试过，但是有一个示例显示了这里的方法：
 [http ://www.simple-talk.com/dotnet/.net-framework/building-active-directory-wrappers-in-.net/](http://www.simple-talk.com/dotnet/.net-framework/building-active-directory-wrappers-in-.net/)

            回答 #3

赞同：-1

时间：2010-10-13T14:59:11.940

有了这个，你可以获得真正的价值

```
Microsoft.VisualBasic.Information.TypeName(item); 
```

        python - 如何向多对多关系添加附加信息？

ID：441114

赞同：1

时间：2009-01-13T22:32:28.593

标签：python, database, sqlite, orm, storm-orm

我正在编写一个程序来管理订单然后打印它们。

订单是一个包含订购人、日期和此人订购的产品的对象。我想添加一个订购者的某个产品的数量。例如3个鸡蛋，2个面包。

有没有更简单的方法来使用storm（我正在使用的ORM）而不是将订单分成更小的部分，以便每个订单只包含1个产品？

            回答 #1

赞同：3

时间：2009-01-13T22:55:01.963

在多对多关系的交集表中添加额外的列有什么问题？  

```
CREATE TABLE orders (
  person_id INT NOT NULL,
  product_id INT NOT NULL,
  quantity INT NOT NULL DEFAULT 1,
  PRIMARY KEY (person_id, product_id),
  FOREIGN KEY (person_id) REFERENCES persons(person_id),
  FOREIGN KEY (product_id) REFERENCES products(product_id)
); 
```

如果您使用的 ORM 在执行多对多查询时无法访问此表中的其他列，您应该仍然能够简单地作为`products`or 或的依赖表来访问它`persons`。

        f# - F# 错误：参数数量错误

ID：441121

赞同：1

时间：2009-01-13T22:34:41.707

标签：f#

我对我之前遇到的 SO 问题中给我的一些代码感到困惑。[代码在这里](https://stackoverflow.com/questions/291445/f-beginner-retrieving-an-array-of-data-from-a-server#295788)

在这一行，我收到一条错误消息，指出我的参数数量无效。我不完全理解错误是什么，因为我所做的所有研究都认为这是该功能的正确应用。

```
let result = Seq.to_list(Microsoft.FSharp.Compatibility.Seq.generate_using opener generator) 
```

这里发生了什么？为什么我会收到这种错误？

编辑：我使用 PowerPack.dll 参考和 MySQL.Data 参考

以下开启器和生成器的代码：

```
 let opener() = 
        let command = connection.CreateCommand(CommandText = sql, CommandType = System.Data.CommandType.Text)
        command.ExecuteReader() 
```

和发电机...

```
let generator<'a> (reader : System.Data.IDataReader) =
    if reader.Read() then
        let t = typeof<'a>
        let props = t.GetProperties()
        let types = props
                    |> Seq.map (fun x -> x.PropertyType)
                    |> Seq.to_array
        let cstr = t.GetConstructor(types)
        let values = Array.create reader.FieldCount (new obj())
        reader.GetValues(values) |> ignore
        let values = values
                     |> Array.map (fun x -> match x with | :? System.DBNull -> null | _ -> x)
        Some (cstr.Invoke(values) :?> 'a)
    else
        None 
```

            回答 #1

赞同：1

时间：2010-03-10T17:55:42.100

这篇文章已经过时了，但是您确定无效的参数数量错误不是来自 Oracle 命令吗？

基本上：您是否在 SQL 查询中指定参数？opener 函数没有应用任何参数。

            回答 #2

赞同：0

时间：2009-01-14T08:25:27.287

The following type checks for me:

```
#light
open System.Data
open System.Data.SqlClient
open System.Configuration

type Employee =
    { FirstName: string;
      LastName: string; }

let generator<'a> (reader: IDataReader) =
    if reader.Read() then
        let t = typeof<'a>
        let props = t.GetProperties()
        let types = props
                    |> Seq.map (fun x -> x.PropertyType)
                    |> Seq.to_array
        let cstr = t.GetConstructor(types)
        let values = Array.create reader.FieldCount (new obj())
        reader.GetValues(values) |> ignore
        let values = values
                     |> Array.map (fun x -> match x with | :? System.DBNull -> null | _ -> x)
        Some (cstr.Invoke(values) :?> 'a)
    else
        None

let opener() = 
    let sql = "select * from employees"
    let connection = new SqlConnection(ConfigurationManager.ConnectionStrings.["myConnection"].ConnectionString)
    let command = connection.CreateCommand(CommandText = sql, CommandType = System.Data.CommandType.Text)
    command.ExecuteReader()

let result = Seq.to_list(Microsoft.FSharp.Compatibility.Seq.generate_using opener (generator<Employee>)) 
```

It looks like your missing a type annotation to tell the generator what type of list your generating ie: `generator<Employee>`

        c# - 使用 OLE 时如何绕过 MS Access 启动？

ID：441126

赞同：1

时间：2009-01-13T22:36:03.623

标签：c#, ms-access, automation, ms-office, ole

我正在尝试使用 C# 和 OLE 从访问数据库中自动导出 xml。除了显示启动表单并且在没有用户干预的情况下不会关闭之外，一切都运行良好。

到目前为止，这是我正在做的事情：

```
objAccess = CreateObject("Access.Application");
objAccess.OpenCurrentDatabase("C:\\MYDB.mdb", true); //true = open in exclusive mode
objAccess.ExportXML(0, "TestTable", "c:\\test.xml");
objAccess.CloseCurrentDatabase();
objAccess.Quit(); 
```

            回答 #1

赞同：3

时间：2009-01-14T00:02:13.340

无需打开 Access 即可将表输出到 XML，例如，在 VBScript 中：

```
Const adOpenStatic = 3
Const adLockOptimistic = 3
Const adPersistXML = 1

Dim strCon, cn, rs

Set cn = CreateObject("ADODB.Connection")
Set rs = CreateObject("ADODB.Recordset")
strCon = "Provider= Microsoft.Jet.OLEDB.4.0; Data Source=" & "C:\Docs\LTD.mdb"

cn.Open strCon
rs.Open "Select * from Table1", cn, adOpenStatic, adLockOptimistic

If Not rs.EOF Then
    rs.MoveFirst 
    rs.Save "C:\Docs\Table1.xml", adPersistXML
End If

rs.Close
cn.Close 
```

            回答 #2

赞同：0

时间：2009-01-13T23:01:33.650

据我所知，唯一的方法是使用 msaccess.exe 上的 /nostartup 开关

所以你必须使用shell命令来获取访问对象

我有一个打开数据库并返回对象的函数（这是您必须转换为 C# 的 VBA 代码）

```
Private Function OpenDatabaseWithShell(pDatabaseFullPath As String) As Access.Application

Dim AccObj As Access.Application

    On Error GoTo ErrorHandler

    Set OpenDatabaseWithShell = Nothing

    Dim cmd As String

    On Error Resume Next

    ' basically build full msaccess.exe path and append database name and command switches
    cmd = SysCmd(acSysCmdAccessDir) & "MSAccess.exe """ & psDatabaseFullPath & """"
    cmd = cmd & " /nostartup /excl"

    'start ms access with shell
    Shell PathName:=cmd

    Do 'Wait for shelled process to finish.
      Err = 0
      Set AccObj = GetObject(pDatabaseFullPath)
    Loop While Err <> 0

    On Error GoTo ErrorHandler

    'return access object
    Set OpenDatabaseWithShell = AccObj

NormalExit:
    Exit Function

ErrorHandler:
    'error logging here
    Exit Function

End Function 
```

编辑：这是一些 VB.NET 代码的[链接](http://support.microsoft.com/kb/317113)，它做类似的事情。向下滚动到“创建完整的示例 Visual Basic .NET 项目”并查找“ShellGetDB”函数

        .net - 需要帮助将 nUnit 测试移动到单独的项目中

ID：441127

赞同：2

时间：2009-01-13T22:36:05.607

标签：.net, visual-studio, visual-studio-2005, nunit, filenotfoundexception

当单元测试类是主项目（TestAccount）的一部分时，一切正常。  

我读过的每一篇关于单元测试的文章都建议将测试放在一个单独的项目中，所以我...  

*   向解决方案添加了另一个项目 (TestAccount.UnitTests)
*   将单元测试类 (AccountTests.vb) 移至 TestAccount.UnitTests  
*   并在 TestAccount.UnitTests 中添加了对 TestAccount 的引用（复制本地 = true）

该解决方案在没有任何警告的情况下编译。但是，nUnit 无法访问主项目并为每个测试提供以下错误：

System.IO.FileNotFoundException：无法加载文件或程序集“TestAccount，Version=1.0.0.0，Culture=neutral，PublicKeyToken=null”或其依赖项之一。该系统找不到指定的文件。    

我究竟做错了什么？

（在将 nunit.framework.dll 添加到 GAC 之前，我遇到了类似的问题）

[解决方案资源管理器的屏幕截图 http://img440.imageshack.us/img440/4862/nunitsolutionexploreree3.jpg](http://img440.imageshack.us/img440/4862/nunitsolutionexploreree3.jpg) 

Visual Studio 2005 

.NET 2.0 

nUnit 2.4.8（.NET 2.0 版本）  

[编辑] 从 Visual Studio 运行 nUnit 时（作为外部命令）我只有这个问题。如果我独立加载 nUnit 控制台，它工作正常。

[编辑] Omar：是的，我参考了另一个项目。这是[我的解决方案资源管理器的屏幕截图](http://img440.imageshack.us/img440/4862/nunitsolutionexploreree3.jpg) 

我想我可能只需要单独运行 nUnit 控制台（而不是通过 VS 的外部工具）。

            回答 #1

赞同：2

时间：2009-01-14T15:49:34.927

我发现了一个[错误报告](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=271421&wa=wsignin1.0)，指出 Visual Studio 错误地扩展了 TargetPath 和 TargetDir 宏。它们扩展到 obj\ 目录，而不是 bin\

[更新] 问题/解决方案实际上在文档的[Visual Studio 支持](http://www.nunit.com/index.php?p=vsSupport&r=2.5)部分进行了讨论。由于“目标”宏指向 obj\，因此您不能直接使用它们。我最终在 Arguments 字段中使用了以下表达式：

```
$(ProjectDir)bin/Debug/$(TargetName)$(TargetExt) 
```

            回答 #2

赞同：0

时间：2009-01-14T15:46:10.847

这可能听起来很傻，但我会很明显你给你的测试项目一个对另一个项目的引用吗？

此类问题常见的其他问题是使用无法从另一个项目/命名空间访问的内部类。

            回答 #3

赞同：0

时间：2009-01-14T15:53:42.453

还要确保您的程序集输出路径与您的 NUnit 配置中设置的内容相对应。我有相同的设置，但我不必设置 'copy local = true'

            回答 #4

赞同：0

时间：2009-01-14T22:51:59.130

问题是找不到应用程序本身还是应用程序的依赖项之一？您可以尝试使用 FileMon 或 Fusion Log Viewer 来查看到底是什么失败了。问题可能不在于找到应用程序本身，而在于找到另一个依赖项。确保所有依赖项都将 Copy Local 设置为 True。

您究竟是如何在 VisualStudio 中启动 NUnit GUI 的？如果您在项目属性下设置“启动外部程序”，它会为您提供指定工作目录的选项。您可能需要将其更改为测试 dll 的构建位置。

        c++ - 如何在 mac os x 上使用 g++ 编译一个简单的 Qt 和 c++ 应用程序？

ID：441128

赞同：20

时间：2009-01-13T22:36:20.317

标签：c++, macos, qt, makefile, qmake

我正在尝试将 Qt 用于学校的一个项目，但遇到了问题。我开始按照教程进行操作，但遇到了 Makefile 问题。大多数教程都说运行`qmake -project`，然后`qmake`和最后`make`。但是当我尝试这个时，我遇到了`make: *** No targets specified and no makefile found.  Stop.`我对 Makefiles 了解不多的错误。有人可以帮我指出正确的方向吗？

            回答 #1

赞同：24

时间：2009-01-14T20:56:48.737

OS X 上的 qmake 创建 Xcode 项目文件。您可以使用以下命令创建 Makefile：

```
qmake -spec macx-g++ 
```

如果您不希望 Makefile 创建应用程序包，您还可以删除“app_bundle”您的配置，例如通过将以下行添加到您的项目文件中。

```
mac {
  CONFIG -= app_bundle
} 
```

            回答 #2

赞同：10

时间：2009-04-03T00:53:04.677

正如其他发帖者所指出的，Mac 上 qmake 的默认行为是创建 xCode 项目文件。您可以在每次运行 qmake 时输入一些特殊的内容，或者在每个项目文件中添加几行。有一个更永久的解决方案。每次我在我的 Mac 上安装 Qt 时都会遇到这个问题。从命令行键入以下内容：

cd /usr/local/Qt4.5/mkspecs/

sudo rm 默认

sudo ln -sf macx-g++ 默认

第一个在线命令中指定的目录可能需要一些调整。第一个“sudo”需要管理密码。
这样做是删除指定默认 -spec 开关为 mac-xcode 或类似内容的违规文件。然后我们用一个文件替换它，指定我们默认使用 macx-g++ 开关。

            回答 #3

赞同：2

时间：2009-01-13T22:58:55.903

听起来您的 Qt 安装可能有问题。你是自己构建的，还是从别人那里安装的？另外，您是否有一个给您带来麻烦的示例 .pro 文件？

            回答 #4

赞同：2

时间：2009-01-14T16:09:24.857

已经有一段时间了，但我认为您的问题是 Mac OS X 上的 qmake 默认创建 xcode 项目文件，而不是 makefile。这就是为什么运行 make 时没有找到 makefile 的原因。相反，请在命令行中查找 qmake 以指定如何定位 makefile。此外，您可能还可以将一个选项添加到 .pro 文件中，以便每次都强制生成一个 makefile 输出。

            回答 #5

赞同：2

时间：2011-09-08T06:50:07.247

配置-platform macx-g++ gmake

这应该足以解决所有问题

        python - 在 Python 中对 CSV 文件使用“with”语句

ID：441130

赞同：21

时间：2009-01-13T22:36:28.303

标签：python, csv, with-statement

是否可以将`with`语句直接用于 CSV 文件？能够做这样的事情似乎很自然：

```
import csv
with csv.reader(open("myfile.csv")) as reader:
    # do things with reader 
```

但是 csv.reader 不提供`__enter__`and`__exit__`方法，所以这不起作用。但是，我可以分两步完成：

```
import csv
with open("myfile.csv") as f:
    reader = csv.reader(f)
    # do things with reader 
```

这第二种方式是理想的方式吗？他们为什么不让 csv.reader 直接与 with 语句兼容？

            回答 #1

赞同：21

时间：2009-01-14T00:24:41.657

语句的主要用途是对`with`语句中使用的对象进行异常安全的清理。`with`确保关闭文件、释放锁、恢复上下文等。

[如果出现异常， csv.reader](http://docs.python.org/library/csv.html#csv.reader)是否有需要清理的东西？

我会去：

```
with open("myfile.csv") as f:
    for row in csv.reader(f):
        # process row 
```

您无需将补丁使用`csv.reader`和`with`声明一起提交。

```
import contextlib 
```

[关于模块contextlib](http://docs.python.org/library/contextlib.html)中函数 contextmanager 的帮助：

```
contextmanager(func)
    @contextmanager decorator. 
```

典型用法：

```
 @contextmanager
    def some_generator(<arguments>):
        <setup>
        try:
            yield <value>
        finally:
            <cleanup> 
```

这使得：

```
 with some_generator(<arguments>) as <variable>:
        <body> 
```

相当于：

```
 <setup>
    try:
        <variable> = <value>
        <body>
    finally:
        <cleanup> 
```

这是我如何使用它的具体示例：[curses_screen](https://stackoverflow.com/questions/327026/attribute-bold-doesnt-seem-to-work-in-my-curses#327072)。

            回答 #2

赞同：4

时间：2009-01-13T22:45:20.360

是的。第二种方法是正确的。

至于为什么？谁知道。你是对的，这可能是一个简单的改变。它不像其他事情那样优先。

您可以轻松制作自己的补丁包并提交。

            回答 #3

赞同：2

时间：2009-01-14T04:57:06.507

问题是 csv.reader 并没有真正管理上下文。它可以接受任何可迭代的，而不仅仅是文件。因此它不会在其输入上调用 close（顺便说一下，如果它调用了，您可以使用 contextlib.closure）。因此，对 csv.reader 的上下文支持实际上会做什么并不明显。

            回答 #4

赞同：1

时间：2011-06-01T21:11:58.500

```
import csv

class CSV(object):
    def __init__(self,path,mode):
        self.path = path
        self.mode = mode
        self.file = None

    def __enter__(self):
        self.file = open(self.path,self.mode)
        if self.mode == 'r':
            return csv.reader(self.file)
        elif self.mode == 'w':
            return csv.writer(self.file)

    def __exit__(self, exc_type, exc_val, exc_tb):
        self.file.close()   

with CSV('data.csv','r') as reader:
    for row in reader:
        print row 
```

            回答 #5

赞同：0

时间：2009-01-14T02:01:06.800

使用生成器函数很容易创建您想要的内容：

```
 import csv
from contextlib import contextmanager

@contextmanager
def opencsv(path):
   yield csv.reader(open(path))

with opencsv("myfile.csv") as reader:
   # do stuff with your csvreader 
```

        jquery - 更改克隆的隐藏字段值

ID：441138

赞同：1

时间：2009-01-13T22:37:39.033

标签：jquery

我正在使用 JQuery 克隆一个表行，除其他外，该行包含一个隐藏字段。我想在克隆行时更改隐藏字段的值。

表单域：

```
<input type="hidden" name="items.Index" id="items.Index" value="0" /> 
```

jQuery：

```
var id = document.getElementById("id").value;
var newId = parseInt(id) + 1;
var clonedRow = $("#myTable tr:last").clone();
$("#items.Index", clonedRow).attr({ "value": newId });
$("#myTable").append(clonedRow); 
```

我也尝试`$("#items.Index", clonedRow).val(newId);`过代替`$("#items.Index", clonedRow).attr({ "value": newId });`我在表格行中成功操作的其他项目，但此表单字段的值永远不会改变。

有任何想法吗？

            回答 #1

赞同：3

时间：2009-01-13T22:42:56.543

#it​​ems.index 正在寻找您的示例中不存在的 id 为“#items.index”的元素，我认为这是一个无效的 id，这将在同一页面中产生具有相同 id 的多个元素（即'无效）。

您可能想尝试：

```
$(clonedRow).find("input:hidden").val(newId); 
```

        wpf - 用于创建视频缩略图的 WCF 服务

ID：441141

赞同：0

时间：2009-01-13T22:38:25.740

标签：wpf, wcf, thumbnails

我正在尝试创建一个 WCF 服务，该服务利用服务器上的 WPF MediaPlayer 为用户上传的视频生成缩略图。我发现了很多关于如何渲染帧并将其保存到文件的 oif 信息。但问题是我需要绑定的关键事件 MediaOpened （实际上没有任何事件）**-** EDIT 触发。

有谁知道如果在 WCF 服务的上下文中使用 WPF MediaPlayer 事件是否不会触发？

谢谢迈克尔

            回答 #1

赞同：1

时间：2009-01-14T04:09:17.727

我决定尝试使用 Expression Media Encoder 2 SDK，效果很好。

从视频生成缩略图的代码很少 - 这是一个片段

```
public void GenerateThumbnails(string fileName, int numberOfThumbnails) 
```

{ 队列 _positionsToThumbnail = 新队列（）；Microsoft.Expression.Encoder.MediaItem video = new Microsoft.Expression.Encoder.MediaItem(fileName);

```
var totalMilliseconds = video.FileDuration.TotalMilliseconds;

//create a queue of timespans for the thumbnails
for (int i = 0; i < numberOfThumbnails; i++)
{
    _positionsToThumbnail.Enqueue(TimeSpan.FromMilliseconds((((2 * i) + 1) * totalMilliseconds) / (2 * numberOfThumbnails)));
}

//create the thumbnails and save them to disk
while(_positionsToThumbnail.Count > 0)
{

    Bitmap bitMap = video.GetThumbnail(_positionsToThumbnail.Dequeue(), new System.Drawing.Size(100,100));
    bitMap.Save(@"F:\thumbs\" + _positionsToThumbnail.Count.ToString() + ".png", ImageFormat.Png);
} 
```

}

            回答 #2

赞同：0

时间：2009-01-13T23:11:02.493

您可能需要在屏幕上呈现数据，以便触发这些事件——这一切都与 WPF 可视化树的一部分有关；当作为服务运行时，它不是。

有很多方法可以尝试解决这个问题，所有这些方法都很复杂，而且可能无法扩展。我建议使用普通的 Windows Media API（来自 Windows Media SDK）来深入了解它。

        silverlight - Silverlight - 与浏览器框架大小相同

ID：441143

赞同：1

时间：2009-01-13T22:38:34.180

标签：silverlight

有没有办法将 Silverlight 应用程序缩放到应用程序嵌入的浏览器框架的 100% 宽度和 100% 高度？

我知道全屏功能，我希望它可以很好地放在浏览器中。

            回答 #1

赞同：4

时间：2009-01-13T23:07:50.003

            回答 #2

赞同：2

时间：2009-01-13T23:37:52.797

Remove the Width and Height attributes from the root UserControl.

            回答 #3

赞同：0

时间：2010-05-20T14:07:43.523

This Javascript will do it, [see this answer](https://stackoverflow.com/questions/726964/filling-browser-window-with-silverlight-application/2874443#2874443):

```
private bool _hasResized;

protected override Size ArrangeOverride(Size finalSize)
{
    if (!_hasResized)
    {
        HtmlPage.Document.GetElementById("silverlightControlHost").SetStyleAttribute("height", finalSize.Height.ToString());
        _hasResized = true;
    }

    return base.ArrangeOverride(finalSize);
} 
```

        javascript - 如何定义 JavaScript 中对象的比较方式

ID：441144

赞同：8

时间：2009-01-13T22:38:56.910

标签：javascript, comparison, equals

我想定义一个 JavaScript 类，Foo。

```
Foo = function(value){
    this.value = value;
}; 
```

我将创建我的 Foo 的“实例”：

```
foo1 = new Foo(1);
foo2 = new Foo(1); 
```

我希望我的 Foo 实例可以使用标准 == 相等运算符相互比较：

```
foo1 == foo2;      // this should be true 
```

我找不到办法做到这一点。我以为我对`valueOf()`函数有所了解，但这仅在比较的一侧是原始比较时才有用，而不是像上面两者都是对象类型的情况。

我是否错过了类似于 Ruby 的非常简单的东西

```
def ==(obj); end 
```

            回答 #1

赞同：7

时间：2009-01-13T22:44:29.067

JavaScript 没有运算符重载。请参阅涵盖您的问题的[讨论。](https://stackoverflow.com/questions/27030/comparing-arrays-of-objects-in-javascript)

            回答 #2

赞同：4

时间：2009-01-13T23:57:28.653

不是以干净的方式...

```
Foo = function (value){
    this.value = value;
}; 
```

覆盖你自己对象的 toString 函数：

```
Foo.prototype.toString = function( ){ return this.value.toString(); } 
```

创建两个测试对象：

```
foo1 = new Foo(1);
foo2 = new Foo(1); 
```

如果您的对象的值是字符串或数字，您可以让 javascript 引擎通过将对象添加到空字符串来将它们转换为字符串：

```
alert( ""+foo1 === ""+foo2 ); //Works for strings and numbers 
```

相同但更清洁：

```
alert( foo1.toString() === foo2.toString() ); //Works for strings and numbers 
```

如果对象的值仅为数字，则可以使用一元 + 运算符将对象转换为数字：

```
alert( +foo1 === +foo2 ); //Works for numbers 
```

但是，我建议您既定义上述 toString 又定义一个等于：

```
Foo.prototype.equals=function(b){return this.toString() === b.toString();} 
```

然后这样称呼它：

```
alert ( foo1.equals(foo2) ); 
```

由于您现在已经定义了 toString，您可以：

```
alert(foo1); // Alerts the value of foo1 instead of "[Object object]"
alert("foo1: " + foo1); // Alerts "foo1: 1". Useful when debugging. 
```

            回答 #3

赞同：1

时间：2009-01-13T22:42:12.130

我认为使用 javascript 是不可能的。您必须编写自己的函数，例如`isEqual()`

            回答 #4

赞同：1

时间：2009-01-13T22:43:43.453

JavaScript 在这方面就像它的同名 Java：没有运算符重载。改用自定义方法`equals()`。

        python - 如何从日期中减去一天？

ID：441147

赞同：986

时间：2009-01-13T22:39:36.473

标签：python, datetime, date

我有一个 Python[`datetime.datetime`](https://docs.python.org/library/datetime.html#datetime-objects)对象。减去一天的最佳方法是什么？

            回答 #1

赞同：1695

时间：2009-01-13T22:41:39.213

您可以使用一个[`timedelta`](http://docs.python.org/library/datetime.html#timedelta-objects)对象：

```
from datetime import datetime, timedelta

d = datetime.today() - timedelta(days=days_to_subtract) 
```

            回答 #2

赞同：97

时间：2009-01-13T22:42:03.673

减去`datetime.timedelta(days=1)`

            回答 #3

赞同：76

时间：2014-08-21T13:38:27.043

如果您的 Python 日期时间对象是时区感知的，那么您应该小心避免 DST 转换的错误（或由于其他原因而更改 UTC 偏移量）：

```
from datetime import datetime, timedelta
from tzlocal import get_localzone # pip install tzlocal

DAY = timedelta(1)
local_tz = get_localzone()   # get local timezone
now = datetime.now(local_tz) # get timezone-aware datetime object
day_ago = local_tz.normalize(now - DAY) # exactly 24 hours ago, time may differ
naive = now.replace(tzinfo=None) - DAY # same time
yesterday = local_tz.localize(naive, is_dst=None) # but elapsed hours may differ 
```

通常，如果本地时区的 UTC 偏移量在最后一天发生变化，则可能会有所不同`day_ago`。`yesterday`

例如，夏令时/夏令时在美国/洛杉矶时区的 2014 年 11 月 2 日星期日凌晨 02:00:00 结束，因此如果：

```
import pytz # pip install pytz

local_tz = pytz.timezone('America/Los_Angeles')
now = local_tz.localize(datetime(2014, 11, 2, 10), is_dst=None)
# 2014-11-02 10:00:00 PST-0800 
```

然后`day_ago`和`yesterday`不同：

*   `day_ago`正好是 24 小时前（相对于`now`），但在上午 11 点，而不是上午 10 点`now`
*   `yesterday`是昨天上午 10 点，但它是 25 小时前（相对于`now`），而不是 24 小时。

[`pendulum`模块](https://pendulum.eustace.io/)自动处理它：

```
>>> import pendulum  # $ pip install pendulum

>>> now = pendulum.create(2014, 11, 2, 10, tz='America/Los_Angeles')
>>> day_ago = now.subtract(hours=24)  # exactly 24 hours ago
>>> yesterday = now.subtract(days=1)  # yesterday at 10 am but it is 25 hours ago

>>> (now - day_ago).in_hours()
24
>>> (now - yesterday).in_hours()
25

>>> now
<Pendulum [2014-11-02T10:00:00-08:00]>
>>> day_ago
<Pendulum [2014-11-01T11:00:00-07:00]>
>>> yesterday
<Pendulum [2014-11-01T10:00:00-07:00]> 
```

            回答 #4

赞同：48

时间：2014-06-04T18:48:53.453

只是为了详细说明**一种替代方法**和一个有用的用例：

*   从当前日期时间减去 1 天：

```
from datetime import datetime, timedelta
print datetime.now() + timedelta(days=-1)  # Here, I am adding a negative timedelta 
```

*   **在案例中很有用**，如果您想从当前日期时间增加 5 天并减去 5 小时。即从现在起 5 天后的日期时间是多少，但少了 5 小时？

```
from datetime import datetime, timedelta
print datetime.now() + timedelta(days=5, hours=-5) 
```

它可以类似地与其他参数一起使用，例如秒、周等

            回答 #5

赞同：10

时间：2015-03-17T16:36:15.367

当我想计算即上个月的第一天/最后一天或其他相对时间增量等时，我也喜欢使用另一个不错的功能......

[dateutil](https://dateutil.readthedocs.org/en/latest/)函数中的relativedelta函数（对 datetime 库的强大扩展）

```
import datetime as dt
from dateutil.relativedelta import relativedelta
#get first and last day of this and last month)
today = dt.date.today()
first_day_this_month = dt.date(day=1, month=today.month, year=today.year)
last_day_last_month = first_day_this_month - relativedelta(days=1)
print (first_day_this_month, last_day_last_month)

>2015-03-01 2015-02-28 
```

            回答 #6

赞同：7

时间：2017-04-06T11:23:45.350

存在通用箭头模块

```
import arrow
utc = arrow.utcnow()
utc_yesterday = utc.shift(days=-1)
print(utc, '\n', utc_yesterday) 
```

输出：

```
2017-04-06T11:17:34.431397+00:00 
 2017-04-05T11:17:34.431397+00:00 
```

            回答 #7

赞同：-4

时间：2021-06-15T13:15:58.410

```
class myDate:

    def __init__(self):
        self.day = 0
        self.month = 0
        self.year = 0
        ## for checking valid days month and year
        while (True):
            d = int(input("Enter The day :- "))
            if (d > 31):
                print("Plz 1 To 30 value Enter ........")
            else:
                self.day = d
                break

        while (True):
            m = int(input("Enter The Month :- "))
            if (m > 13):
                print("Plz 1 To 12 value Enter ........")
            else:
                self.month = m
                break

        while (True):
            y = int(input("Enter The Year :- "))
            if (y > 9999 and y < 0000):
                print("Plz 0000 To 9999 value Enter ........")
            else:
                self.year = y
                break
    ## method for aday ands cnttract days
    def adayDays(self, n):
        ## aday days to date day
        nd = self.day + n
        print(nd)
        ## check days subtract from date
        if nd == 0: ## check if days are 7  subtracted from 7 then,........
            if(self.year % 4 == 0):
                if(self.month == 3):
                    self.day = 29
                    self.month -= 1
                    self.year = self. year
            else:
                if(self.month == 3):
                    self.day = 28
                    self.month -= 1
                    self.year = self. year
            if  (self.month == 5) or (self.month == 7) or (self.month == 8) or (self.month == 10) or (self.month == 12):
                self.day = 30
                self.month -= 1
                self.year = self. year

            elif (self.month == 2) or (self.month == 4) or (self.month == 6) or (self.month == 9) or (self.month == 11):
                self.day = 31
                self.month -= 1
                self.year = self. year

            elif(self.month == 1):
                self.month = 12
                self.year -= 1    
        ## nd == 0 if condition over
        ## after subtract days to day io goes into negative then
        elif nd < 0 :   
            n = abs(n)## return positive if no is negative
            for i in range (n,0,-1): ## 

                if self.day == 0:

                    if self.month == 1:
                        self.day = 30

                        self.month = 12
                        self.year -= 1
                    else:
                        self.month -= 1
                        if(self.month == 1) or (self.month == 3)or (self.month == 5) or (self.month == 7) or (self.month == 8) or (self.month == 10) or (self.month ==12):
                            self.day = 30
                        elif(self.month == 4)or (self.month == 6) or (self.month == 9) or (self.month == 11):
                            self.day = 29
                        elif(self.month == 2):
                            if(self.year % 4 == 0):
                                self.day == 28
                            else:
                                self.day == 27
                else:
                    self.day -= 1

        ## enf of elif negative days
        ## adaying days to DATE
        else:
            cnt = 0
            while (True):

                if self.month == 2:  # check leap year

                    if(self.year % 4 == 0):
                        if(nd > 29):
                            cnt = nd - 29
                            nd = cnt
                            self.month += 1
                        else:
                            self.day = nd
                            break
                ## if not leap year then
                    else:  

                        if(nd > 28):
                            cnt = nd - 28
                            nd = cnt
                            self.month += 1
                        else:
                            self.day = nd
                            break
                ## checking month other than february month
                elif(self.month == 1) or (self.month == 3) or (self.month == 5) or (self.month == 7) or (self.month == 8) or (self.month == 10) or (self.month == 12):
                    if(nd > 31):
                        cnt = nd - 31
                        nd = cnt

                        if(self.month == 12):
                            self.month = 1
                            self.year += 1
                        else:
                            self.month += 1
                    else:
                        self.day = nd
                        break

                elif(self.month == 4) or (self.month == 6) or (self.month == 9) or (self.month == 11):
                    if(nd > 30):
                        cnt = nd - 30
                        nd = cnt
                        self.month += 1

                    else:
                        self.day = nd
                        break
                ## end of month condition
        ## end of while loop
    ## end of else condition for adaying days
    def formatDate(self,frmt):

        if(frmt == 1):
            ff=str(self.day)+"-"+str(self.month)+"-"+str(self.year)
        elif(frmt == 2):
            ff=str(self.month)+"-"+str(self.day)+"-"+str(self.year)
        elif(frmt == 3):
            ff =str(self.year),"-",str(self.month),"-",str(self.day)
        elif(frmt == 0):
            print("Thanky You.....................")

        else:
            print("Enter Correct Choice.......")
        print(ff)

dt = myDate()
nday = int(input("Enter No. For Aday or SUBTRACT Days :: "))
dt.adayDays(nday)
print("1 : day-month-year")
print("2 : month-day-year")
print("3 : year-month-day")
print("0 : EXIT")
frmt = int (input("Enter Your Choice :: "))
dt.formatDate(frmt)

    enter code here 
```

        asp.net - 页面间更新进度

ID：441149

赞同：0

时间：2009-01-13T22:41:09.730

标签：asp.net

我有一个使用 ajax UpdateProgress 和 UpdatePanel 控件的网站。我知道我不能使用相同的方法在页面之间显示进程指示器。但是，用户希望在他们前往新链接时看到正在完成的一些工作。有哪些方法可以做到这一点？

谢谢！

            回答 #1

赞同：0

时间：2009-01-13T23:00:40.143

我最近所做的是使用 jQuery 显示动画 gif（例如旋转圆圈）（对于我知道的链接需要一段时间才能加载）。

        java - 为什么 Java Swing 是可序列化的？

ID：441151

赞同：8

时间：2009-01-13T22:41:31.133

标签：java, swing, serialization

当我为远程用户创建 Swing 应用程序时，我只是创建 jar 文件并创建一个 WebStart 文件让用户下载应用程序然后运行它。我还没有听说过提供 JFrame 等的应用程序服务器，比如 JSP。这就是初衷吗？

            回答 #1

赞同：7

时间：2009-01-13T22:49:24.237

坚持。

如果您只想拥有 UI，则可以将其保存到磁盘，然后在下次运行程序时将其恢复。

它会完全按照您离开的方式恢复所有内容。

不需要花哨的东西。

            回答 #2

赞同：6

时间：2009-01-13T23:34:18.797

我过去确实使用过它。构建一个编译器，接收 XML 数据，配置和构建您的显示对象，将它们序列化，然后将它们传递给一个瘦客户端，该客户端除了 UI 和简单的回调之外什么都不知道。

当然，它被证明是非常低效的。我们最终将数据分离到不同的类中，并使用该类的实例作为显示对象构造函数的参数。

除了易于使用之外，我没有想到让摆动对象本身可序列化的充分理由。事实上，事实证明它有点危险，因为我们认为“如果他们一开始就让它可序列化，那么这个想法就不会那么糟糕了。”

        c# - 如何将代码从 C# 转换为 PHP

ID：441161

赞同：11

时间：2009-01-13T22:44:12.983

标签：c#, php, parsing, converter

我有一个用纯 C# 编写的业务逻辑类（没有这种语言的任何特定内容），我会将此代码转换为 PHP。我可以编写自己的解析器，但想想是否有人能在我之前完成它。

你能告诉我在哪里可以找到这种转换器吗？

附言。正如我所写的，我只使用这种语言的纯 C# 编程。只有参数、变量声明、方程和控制语句。

            回答 #1

赞同：18

时间：2010-01-29T08:38:22.080

jsc 项目可以为您将 .net/C# 转换为 PHP。

1.  概述：http: [//jsc.sf.net](http://jsc.sf.net)
2.  来源：http: [//jsc.sourceforge.net/examples/web/OrcasAvalonWebApplication/](http://jsc.sourceforge.net/examples/web/OrcasAvalonWebApplication/)
3.  示例：http: [//jsc.svn.sourceforge.net/viewvc/jsc/templates/OrcasAvalonWebApplication/](http://jsc.svn.sourceforge.net/viewvc/jsc/templates/OrcasAvalonWebApplication/)
    [![替代文字](https://i.stack.imgur.com/LJ62v.png)](https://i.stack.imgur.com/LJ62v.png)

            回答 #2

赞同：7

时间：2009-01-13T22:58:42.020

我知道你希望有经验的人，但万一没有人站出来......

您可能会考虑将代码复制并粘贴到 PHP 脚本中并检查中断的地方。编写一个解析器来解决这个问题，在整个脚本中运行它，看看接下来会发生什么。继续，直到脚本按预期运行。

如果您不使用任何更复杂的 .Net 类，我无法想象您会遇到太多麻烦。

            回答 #3

赞同：3

时间：2013-12-17T13:09:54.800

刚刚开始的项目**cs2php**。来源可在[https://github.com/isukces/cs2php](https://github.com/isukces/cs2php)上找到，主页是[http://www.cs2php.com/](http://www.cs2php.com/)。

            回答 #4

赞同：2

时间：2009-01-13T22:49:34.220

您是否需要一种工具来将您的 C# 代码直接转换为 PHP？我怀疑是否有一个可用的，我会有点担心使用一个（根据我对 C# 的了解，它不容易转移到 PHP）。

根据项目的大小，我更倾向于重写它。我确实看过但找不到任何东西（虽然有很多工作请求 - 看起来像那里的企业=P）。

            回答 #5

赞同：2

时间：2011-08-10T17:04:20.780

您现在可以在 .NET 上运行 PHP 代码，使用 phalanger.codeplex.com 调用您的业务类

        mysql - 将 MySQL 迁移到 PostgreSQL - SQL 代码中不可见的哪些特性很重要？

ID：441168

赞同：3

时间：2009-01-13T22:45:27.287

标签：mysql, postgresql, data-migration

我们正在将 MySQL 迁移到 PostgreSQL。我可以轻松地审核整个 (REALbasic) 程序中使用的模式和 SQL 语句。大多数 SQL 是由构建字符串变量组成的。

我已经知道需要用`SELECT LAST_INSERT_ID()`具有 UNIQUE 约束的 SERIAL 列替换我们的使用。

两者之间在 SQL 语句中不明显可见的差异**（**如果*有的*话）可能会咬我们？我正在寻找关于行为的（可能是微妙的）假设，例如自动提交中的任何差异，需要添加 MySQL 中没有的约束等。 我试图为几个在这两个数据库中都不是专家的相当聪明、细心的人梳理出任何问题。

这是一项单向承诺，因此如果有重大好处，我们将通过添加新声明获得重大好处，我会感谢他们指出。

注意：我们没有使用任何形式的参数化查询，是的，我已经指出注入攻击的问题是对代码的必需审计。

是的，出于好奇，这个决定是由 GPL 问题促成的，并不是我们反对为许可证付费，但不幸的是，MySQL 的唯一 REALbasic 驱动程序是 GPL。截至 2009 年 5 月，Real Software 发布了一个新的社区驱动程序，它是 GPL，并正确包含源代码。他们承诺在不久的将来推出非 GPL Enterprise 驱动程序。

我准备相信答案可能是*床下没有看不见的怪物，*但我想我会要求确定。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-02-04T09:58:34.770

*   > `select count(*) from table;`

    会很慢，因为它需要读取整个表。如果您需要经常计算大表，则需要解决方法。这是确保[多版本并发控制](http://en.wikipedia.org/wiki/Multiversion_concurrency_control)所必需的。

*   在最新版本（8.3）中，没有隐式转换为文本，这意味着例如

    > `select 234 like '2%';`

    会抛出错误。你需要明确的演员，如：

    > `select 234::text like '2%';`

*   更新实际上是删除+插入。由于已删除行使用的空间不会立即释放，因此如果您在一个事务中更新整个表，那么您将需要双倍的空间。

Postgresql 是一个非常好的数据库，你很快就会爱上它。它有几个非常有用的特性，你会在其他甚至是商业数据库中错过这些特性。例如事务数据定义语言或保存点。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T13:37:34.647

[http://wiki.postgresql.org/wiki/Converting_from_other_Databases_to_PostgreSQL](http://wiki.postgresql.org/wiki/Converting_from_other_Databases_to_PostgreSQL)

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-02-25T20:17:06.860

当我从 MySQL 迁移到 PostgreSQL 时，有几件事确实阻碍了我：

1) 写入 MySQL 数据库的代码被破坏，并且将数据库垃圾提供给具有外键的真实数据库会阻止。加入参照完整性后，准备好发现“意外”的垃圾数据。

2) MySQL 的字符串索引不区分大小写！如果您在用户名之类的东西上有一个主键，那么根据 MySQL，“Coryking”和“CORYKING”是相同的。在 PostgreSQL 上，它们是不同的。直到有人开始注册应该已经在数据库中的重复用户名，我才意识到这一点。

3) MySQL 喜欢自动将无意义的默认值添加到您指定为“NOT NULL”的列。例如，如果您指定 VARCHAR(255) NOT NULL，它将将该列定义转换为“VARCHAR(255) NOT NULL DEFAULT ''”。

4) PostgreSQL 喜欢大查询——MySQL 不喜欢。迁移改进数据库查询后，您将获得很多乐趣——也不要害羞。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T07:27:23.957

除非您的列类型与 SQL92 兼容，否则您**将**遇到两者之间类型名称的差异。

查询中的变量修改在 postgreSQL 中不起作用，例如，这将在 MySQL 中起作用，但在 postgreSQL 中不起作用（我最近没有测试过，也许现在可以了。）

SET @a:=1 SELECT ID,@a:=@a+1 FROM some_table;

我个人也认为 postgreSQL 可以更好地处理复杂的查询，包括子选择等（大多数 MySQL 用户过去常常避免）。

编辑：哦，我差点忘了！postgreSQL 存储表的方式与 MySQL 完全不同。这也可能会影响您的备份/恢复策略。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-05-14T22:58:59.023

我不知道您是否使用 PHP，但我发现 addlashes 对 MySQL 的效果相对较好，但在 Postgres 中却很快。使用 pg_escape_string() 或更好的准备好的语句。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-01-13T23:35:38.747

根据所涉及的查询数量（如果您有内部人员这样做），提取所有查询，根据需要调整它们并在现有数据库的两个副本上运行它们可能是明智之举，一个正在运行 mysql，一个正在运行后格雷斯尔。查看生成的日志并比较结果数据可能会显示一些有趣的提示。第一步也可以通过执行单元测试、手动或基于脚本的应用程序测试来完成。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-02-08T04:45:13.073

基于[WikiVS 比较](http://www.wikivs.com/wiki/MySQL_vs_PostgreSQL)，我发现了一些有趣的点，大多数不是真正的问题，例如： - Postgres 中的子查询要快得多，这并不是真正的问题，但意味着可以删除一些解决方法

该站点确实将我带到了[Postgres Gotchas](http://sql-info.de/postgresql/postgres-gotchas.html)列表，其中包含有关 count(*) 速度和另一个顺序扫描问题的更多详细信息：Max 和 Min 是顺序扫描。与迄今为止发现的任何其他事情相比，这更有可能损害我们的绩效。但是，该文章包含 Max(col) 解决方法：

```
SELECT col FROM table ORDER BY col DESC LIMIT 1 
```

# asp.net - 在文本框中输入按键时避免发出哔声

> ID：441185
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-01-13T22:51:44.747
> 
>         
> 
> 标签：asp.net, javascript, onkeypress

当您创建一个 aspx 页面时：

```
<%@ Page Language="C#" AutoEventWireup="true"  CodeFile="Default.aspx.cs" Inherits="_Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Untitled Page</title>
</head>
<body>
    <form id="form1" runat="server">
    <div>

        <asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
        <asp:TextBox ID="TextBox2" runat="server"></asp:TextBox>

    </div>
    </form>
</body>
</html> 
```

当您在文本框中并按 Enter 键时，如何避免发出哔哔声。

另一方面，我想处理 enter onkeypress 事件。

发送！

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-07-29T03:09:25.057

首先，在网页上的文本框中按下回车键时发出哔哔声不是标准行为。试试谷歌的搜索页面，或者试试这个页面底部的名称、电子邮件和主页字段。在任何浏览器中按下回车键时，它们都不会发出哔哔声。

为防止发出哔声，请处理标签上的 onKeyDown 事件，`<INPUT>`并在按下回车键时返回 false：

```
<input type="text" name="TextBox1" value="" onKeyDown="return StopBeepOnEnter(event)" />

<script type="text/javascript">
    function StopBeepOnEnter(event)
    {
        if (event.keyCode == 13)
        {
            // Do Whatever...

            return false; // This stops the beep
        } 
    }
</script> 
```

这是使用 jQuery 的相同内容（我实际上已经对此进行了测试，它为我解决了问题）：

```
<script type="text/javascript">
    $("#<%=TextBox1.ClientID %>").keydown(function(event)
    {
        if (event.keyCode == 13)
        {
            // Do Whatever...

            return false; // This stops the beep
        }
    });
</script> 
```

我在这个线程上找到了解决方案 - 归功于 Tharn Jaggar：

[http://codingforums.com/showthread.php?t=36491](http://codingforums.com/showthread.php?t=36491)

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2011-05-24T17:26:10.487

这里有几点需要注意...

1.  如果提交按钮被隐藏或根本没有提交按钮，则会出现警报。如果您`<a>`像我通常那样手动滚动自己的按钮，通常会出现这种情况（因为默认的操作系统按钮很难看）。您可能想要研究的一件事是使用`<button type="submit"></button>`，因为您可以为它们设置比标准输入按钮更多的样式，并且它们将有机地处理关键事件。

2.  如果您在`keyup`或上拦截 keyCode 13，警报仍然会发生`keydown`。我不知道这些事件是什么，但你必须使用`keypress`. 这就是我通常在全球范围内使用 jQuery 所做的事情......

    ```
    $("input[type=text],input[type=password]").keypress(function(e) {    
      if(e.keyCode == 13) {
        $(this).closest("form").trigger("submit");
        e.preventDefault();
      }
    }); 
    ```

    然后在页面级别我捕获提交事件并执行我的验证例程......

    ```
    $("form").submit(function(e) {
      var txt = $("#txtUser");
      if(txt.val().length == 0) {
        alert("Who are you?");
        txt.focus();
        e.preventDefault();
      }
    }); 
    ```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-08T21:23:32.570

把它放在你的表单标签中`onkeypress="if(event.keyCode==13)return false;"`

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-13T23:51:41.117

您必须在操作系统的声音首选项中将其关闭。这是 Internet Explorer 的事情。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T01:00:59.790

如果它与您的受众正在使用的浏览器有关，那么他们已经习惯了它的发生，因为它发生在除您之外的所有其他网站上。我会说这不值得担心 - 有点像关闭 JavaScript 的人。他们知道他们已将其关闭，因此他们习惯了缺乏某些功能的网站。你不能强迫他们打开它，也不能强迫他们把声音关掉。这是您必须在网络应用程序中接受的体验之一。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T02:34:08.073

我没有在asp中做过很多事情，但我的第一个想法是它类似于Winforms应用程序。我解决它的第一步是将键（代码、键码、事件中的任何名称）var 设置为#0 或 null，以及返回之前在事件调用中的任何 var，例如 e.handled。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-11-25T10:53:50.860

最后，我可以在文本字段或组合或任何组件中按 Enter 键时禁用页面所有组件上的哔声，这是必需的。我所做的是在我的正文标签中添加了 [onkeypress="if(event.keyCode==13)return false;"] ，如下所示：

```
 <body onkeypress="if(event.keyCode==13)return false;"> 
```

我在我的 GWT GXT 应用程序中使用了上面的代码。

克里尚巴巴尔

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2010-01-28T10:44:44.347

`KeyPressEvent.preventDefault()`  似乎在 GWT 中成功了

# cryptoapi - Microsoft 是否提供连接到其自己的 MS CryptoAPI 的 PKCS #11 提供程序？

> ID：441194
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-01-13T22:55:01.153
> 
>         
> 
> 标签：cryptoapi, pkcs#11, mscapi

我希望使用 PKCS #11 接口运行一些测试，并且想知道 Microsoft 是否提供了基于软件的实现来提供 PKCS #11 功能？

与其等待 HSM 到达并正确配置，我宁愿现在就开始测试与接口的交互。

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-12-10T03:28:34.460

微软没有。Microsoft 已拒绝 PKCS11 支持智能卡微型驱动程序/基本智能卡 CSP。但是，您可以从许多供应商处获得支持 PKCS11 的智能卡，以便您测试代码。有些甚至有模拟智能卡的“软令牌”。请注意，大多数智能卡相对于完整的 HSM 支持的内容非常有限。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2019-07-30T12:05:53.120

它不是由 Microsoft 提供的，但您可以使用第三方实现，例如：

*   [p11-capi](https://github.com/risacher/p11-capi)

*   [pvpkcs11](https://github.com/PeculiarVentures/pvpkcs11)

# java - 为什么 Java 需要 Serializable 接口？

> ID：441196
> 
>         
> 
> 赞同：119
> 
>         
> 
> 时间：2009-01-13T22:55:28.077
> 
>         
> 
> 标签：java, serialization

我们大量使用序列化，并且必须在我们使用的每个对象上指定 Serializable 标记是一种负担。尤其是当它是我们无法真正改变的第 3 方课程时。

问题是：既然 Serializable 是一个空接口，而 Java 在添加后提供了强大的序列化  `implements Serializable`- 为什么他们不让所有东西都可序列化，仅此而已？  

我错过了什么？

* * *

## 回答 #1

> 赞同：122
> 
>             
> 
> 时间：2009-01-13T23:37:46.543

序列化充满了陷阱。这种形式的自动序列化支持使类内部成为公共 API 的一部分（这就是 javadoc 为您[提供类的持久形式的](http://java.sun.com/javase/6/docs/api/serialized-form.html#java.net.URL)原因）。

为了长期保持，类必须能够解码这种形式，这限制了您可以对类设计进行的更改。这打破了封装。

序列化也可能导致安全问题。通过能够序列化它所引用的任何对象，一个类可以访问它通常无法访问的数据（通过解析结果字节数据）。

还有其他问题，例如内部类的序列化形式没有很好地定义。

使所有类可序列化会加剧这些问题。查看[Effective Java Second Edition](http://java.sun.com/docs/books/effective/)，特别是*第 74 条：明智地实现 Serializable*。

* * *

## 回答 #2

> 赞同：32
> 
>             
> 
> 时间：2009-01-13T23:59:28.120

我认为这次 Java 和 .Net 的人都搞错了，最好让所有东西都默认可序列化，而只需要标记那些不能安全序列化的类。

例如，在 Smalltalk（一种 70 年代创建的语言）中，默认情况下每个对象都是可序列化的。我不知道为什么在 Java 中不是这种情况，考虑到绝大多数对象可以安全地序列化而只有少数对象不是这样的事实。

将对象标记为可序列化（带有接口）并不会神奇地使该对象可序列化，**它一直是可序列化**的，只是现在您表达了系统可以自己找到的东西，所以我认为没有真正好的理由序列化就是现在的样子。

我认为这要么是设计人员做出的错误决定，要么是序列化是事后才想到的，或者该平台从未准备好在默认情况下安全一致地对所有对象进行序列化。

* * *

## 回答 #3

> 赞同：21
> 
>             
> 
> 时间：2009-01-13T22:59:00.397

并非所有内容都是真正可序列化的。以网络套接字连接为例。您可以序列化套接字对象的数据/状态，但活动连接的本质将会丢失。

* * *

## 回答 #4

> 赞同：13
> 
>             
> 
> 时间：2009-01-14T00:07:23.800

Serializable 在 Java 中的主要作用是在默认情况下实际上使所有其他对象不可序列化。序列化是一种非常危险的机制，尤其是在其默认实现中。因此，就像 C++ 中的友谊一样，默认情况下它是关闭的，即使使事情可序列化需要一点成本。

序列化增加了约束和潜在的问题，因为没有保证结构兼容性。很好，默认情况下它是关闭的。

我不得不承认，我见过很少有标准序列化可以满足我的要求的非平凡类。特别是在复杂数据结构的情况下。因此，您为使类可正确序列化而付出的努力使添加接口的成本相形见绌。

* * *

## 回答 #5

> 赞同：9
> 
>             
> 
> 时间：2009-01-13T23:04:13.007

对于某些类，尤其是那些代表更物理的东西（如文件、套接字、线程或数据库连接）的类，序列化实例绝对没有意义。对于许多其他人来说，序列化可能是有问题的，因为它破坏了唯一性约束或只是迫使您处理您可能不希望的类的不同版本的实例。

可以说，默认情况下使所有内容都可序列化并通过关键字或标记接口使类不可序列化可能会更好 - 但是，那些应该使用该选项的人可能不会考虑它。事实上，如果你需要实现 Serializable，你会被一个异常告知。

* * *

## 回答 #6

> 赞同：4
> 
>             
> 
> 时间：2009-01-13T22:59:05.840

我认为这样做是为了确保作为程序员的你知道你的对象是我被序列化的。

* * *

## 回答 #7

> 赞同：3
> 
>             
> 
> 时间：2013-03-06T16:16:31.427

显然，在一些初步设计中，一切都是可序列化的，但由于安全性和正确性问题，最终设计最终如我们所知。

资料来源：[为什么类必须实现 Serializable 才能写入 ObjectOutputStream？](http://docs.oracle.com/javase/7/docs/technotes/guides/rmi/faq.html#whyserial).

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T12:18:36.130

必须明确声明某个类的实例是可序列化的，语言迫使您考虑是否应该允许这样做。对于简单的值对象，序列化是微不足道的，但在更复杂的情况下，您需要真正考虑清楚。

仅仅依靠 JVM 的标准序列化支持，您就会面临各种讨厌的版本控制问题。

唯一性、对“真实”资源的引用、计时器和许多其他类型的工件都不是序列化的候选对象。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2014-12-10T08:59:54.757

阅读本文以了解 Serializable Interface 以及为什么我们应该只创建几个类 Serializable 并且我们还需要注意在哪里使用瞬态关键字，以防我们想从存储过程中删除几个字段。

[http://www.codingeek.com/java/io/object-streams-serialization-deserialization-java-example-serializable-interface/](http://www.codingeek.com/java/io/object-streams-serialization-deserialization-java-example-serializable-interface/)

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T00:04:18.390

好吧，我的回答是，这没有充分的理由。从您的评论中，我可以看到您已经了解到这一点。其他语言愉快地尝试序列化所有在你数到 10 后不会跳到树上的东西。对象应该默认是可序列化的。

因此，您基本上需要做的是自己阅读 3rd-party 类的所有属性。或者，如果这是您的选择：反编译，将该死的关键字放在那里，然后重新编译。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2009-08-27T14:55:19.720

Java 中有一些东西根本无法序列化，因为它们是特定于运行时的。流、线程、运行时等，甚至一些 GUI 类（连接到底层操作系统）都无法序列化。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2013-10-02T05:31:56.257

虽然我同意此处其他答案中的观点，但真正的问题在于反序列化：如果类定义发生变化，那么反序列化将存在真正的风险。永远不要修改现有字段是图书馆作者做出的一项重大承诺！保持 API 兼容性已经足够了。

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2016-07-08T17:15:31.150

需要持久化到文件或其他媒体的类必须实现 Serializable 接口，以便 JVM 可以允许对类对象进行序列化。为什么 Object 类没有序列化，那么没有一个类需要实现接口，毕竟 JVM 仅在我使用*ObjectOutputStream*时才序列化该类，这意味着控制权仍在我手中，让 JVM 序列化。

Object 类默认不可序列化的原因在于类版本是主要问题。因此，每个对序列化感兴趣的类都必须显式标记为 Serializable 并提供版本号 serialVersionUID。

如果未提供*serialVersionUID*，那么我们在反序列化对象时会得到意外结果，这就是如果*serialVersionUID*  不匹配，JVM 会抛出*InvalidClassException的原因。*因此每个类都必须实现*Serializable*接口并提供*serialVersionUID*以确保两端呈现的 Class 相同。

 ***# c++ - 使用 C++/STL 存储二进制数据的“正确”方式

> ID：441203
> 
>         
> 
> 赞同：48
> 
>         
> 
> 时间：2009-01-13T22:58:11.583
> 
>         
> 
> 标签：c++, stl, binary-data

一般来说，在 C++ 中存储二进制数据的最佳方式是什么？据我所知，这些选项几乎可以归结为使用字符串或向量<char>。（我将省略 char*s 和 malloc()s 的可能性，因为我专门指的是 C++）。

通常我只使用一个字符串，但是我不确定是否缺少开销，或者 STL 在内部进行的转换可能会破坏二进制数据的完整性。有没有人对此有任何指示（har）？以一种或另一种方式提出建议或偏好？

* * *

## 回答 #1

> 赞同：43
> 
>             
> 
> 时间：2009-01-13T23:02:39.733

char 的向量很好，因为内存是连续的。因此，您可以将它与许多 C API 一起使用，例如 berkley 套接字或文件 API。例如，您可以执行以下操作：

```
 std::vector<char> vect;
  ...
  send(sock, &vect[0], vect.size()); 
```

它会正常工作。

您基本上可以像对待任何其他动态分配的字符缓冲区一样对待它。您可以上下扫描寻找神奇的数字或模式。您可以部分就地解析它。对于从套接字接收，您可以很容易地调整它的大小以附加更多数据。

缺点是调整大小不是非常有效（谨慎调整大小或预分配），从数组前面删除也将非常低效。例如，如果您需要非常频繁地从数据结构的前面一次弹出一个或两个字符，那么在此处理之前复制到双端队列可能是一种选择。这会花费您一个副本，并且双端队列内存不是连续的，因此您不能只将指针传递给 C API。

最重要的是，在深入研究之前了解数据结构及其权衡，但是我在一般实践中看到的通常是 char 向量。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2009-01-14T02:31:17.580

std::string 最大的问题是当前标准不能保证其底层存储是连续的。但是，没有已知的字符串不连续的 STL 实现，因此在实践中它可能不会失败。事实上，新的 C++0x 标准将通过强制 std::string 使用连续缓冲区（例如 std::vector）来解决这个问题。

反对字符串的另一个论点是它的名字暗示它包含一个字符串，而不是二进制缓冲区，这可能会使阅读代码的人感到困惑。

也就是说，我也推荐vector。

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2009-01-14T02:10:57.480

我也用`std::string`这个，从来没有遇到过问题。

一个“指针”，我昨天在一段代码中收到了一个尖锐的提醒：当从一个二进制数据块创建一个字符串时，使用`std::string(startIter, endIter)`构造函数形式，而不是`std::string(ptr, offset, length)`形式——后者假设指针指向到 C 风格的字符串，并忽略第一个零字符之后的任何内容（它复制“直到”指定的`length`，而不是`length`字符）。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T02:18:18.807

您当然应该使用一些 char 容器，但您要使用的容器取决于您的应用程序。

Chars 有几个属性使它们对保存二进制数据很有用：标准不允许对 char 数据类型进行任何“填充”，这很重要，因为这意味着您不会在二进制布局中得到垃圾。每个 char 也保证恰好是一个字节，使其成为唯一具有设置宽度的普通旧数据类型 (POD)（所有其他都是根据上限和/或下限指定的）。

关于存储字符的适当 stl 容器的讨论由上面的 Doug 处理。您需要哪一个完全取决于您的用例。如果你只是持有一个你迭代的数据块，没有任何特殊的查找、追加/删除或拼接需求，我更喜欢向量，它比 std::string 更清楚你的意图，许多库和函数都会假设包含一个以 null 结尾的 c 样式字符串。

# c# - 将所有变量粘贴在类下的结构中或将它们留在类中？

> ID：441206
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-13T22:58:42.330
> 
>         
> 
> 标签：c#

我有一门数学非常密集的课程，并对一个对象执行许多公式/方程式（对象不是我的代码中的一个类，而是一个真实世界的对象）。

无论如何，我想知道，在我的班级下，我应该将所有属性和字段移动到一个结构中吗？这会是一个糟糕的设计吗？

从我所学的内容来看，一个结构应该对这样的事情有用。这也意味着我可以从方法中返回结构并使代码更具原子性（结构有数据，类有逻辑）。如果我保持当前的设计并返回一个带有书面变量的类，这对返回一个结构有什么影响？我知道结构和类之间的区别，但我不确定它们是否会产生很大的影响。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-13T23:04:42.147

您对 .NET 的 struct vs class 定义（“结构有数据，类有逻辑”）不正确；结构可以很好地具有逻辑。结构定义了具有值类型语义的类型。类定义具有引用类型语义的类型。**这是唯一的（尽管是主要的）区别**。

我不会，不。.NET 中的结构通常应该是不可变的；这将迫使您一次更新所有值。使用可变类，您可以根据需要更新各个属性/字段。在围绕变异对象设计的 CPU 密集型用例中，这可能会产生很大的不同。当然，如果你不改变状态，那也没那么重要，但我可能仍然倾向于坚持使用一个类：

当你传递一个类实例时，你传递的只是引用；对于结构，您需要克隆和传递与结构中一样多的数据。这可以在使用 struct 时使密集的工作*更加*密集（除非你使用`ref`很多）。

重新“并返回一个带有书面变量的类” - 你的意思是公共领域吗？不建议这样做。[由于无数次重复的原因](https://stackoverflow.com/questions/295104/what-is-the-difference-between-a-field-and-a-property-in-c)，属性要好得多。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-13T23:16:31.407

“结构有数据，类有逻辑”的想法是对这个概念的误解。**这在 C# 中是不正确的。**从[C# 语言规范 3.0](http://msdn.microsoft.com/en-us/vcsharp/aa336809.aspx)：

> 与类一样，结构是可以包含数据成员和函数成员的数据结构，但与类不同的是，结构是值类型，不需要堆分配。结构类型的变量直接存储结构的数据，而类类型的变量存储对动态分配对象的引用。

Jon Skeet在 Stack Overflow 上写了一个[关于类和结构的优秀答案。](https://stackoverflow.com/questions/203695)我建议阅读它。在这里复制它是没有意义的。该问题中的其他答案也质量非常好。

回答你的问题：仅仅因为你可以将一个类中的所有数据分组到另一个类中是没有意义的。相信我，即使这会加快速度（我对此表示怀疑），但这**不会**成为瓶颈。如果可以将某些数据分组为子组，则您可能无论如何都需要将您的类重构为更小的类。（不仅仅是数据，也可能是函数成员）

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-13T23:14:14.640

多谢你们。

出于上述实质性原因，我将坚持返校。

重新返回一个带有书面变量的类 - 我总是使用属性来读/写。最直接的原因是我可以在需要时为属性提供逻辑（例如，如果值小于 18，则抛出某种异常）。当然，更多的控制，比如让它只对程序集可见等。

# .net - 单例 DAL 类

> ID：441214
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-01-13T22:59:37.757
> 
>         
> 
> 标签：.net, singleton, data-access-layer

DAL (customerDAL) 中的类不应该是单例的吗？由于我的控制器 (customerController) 公开了“Shared Subs”，因此在每次调用时，如果已经存在，则无需创建新的 DAL 对象。正确的？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-13T23:04:08.763

如果你有一个网站，单例 dal 对象是非常危险的，因为对网站的每个请求都是同一个应用程序的一部分。如果构建错误，它们可能会成为访问数据库的瓶颈。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-01-13T23:06:11.083

这在很大程度上取决于您的完整解决方案的架构。当您有很多消费者时，可能很难获得一个单身人士。[以下](http://www.codeplex.com/AppArch/Wiki/View.aspx?title=Checklist%20-%20Data%20Access%20Layer&referringTitle=Checklists)是您在设计 DAL 时可能需要考虑的事项清单。此外，还有很多 DAL 模式，如 Repository 和一些外观模式。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-01-13T23:06:54.950

众所周知，单例对象很难测试。我会考虑以一种不昂贵的方式创建 DAL，然后根据需要创建一个新的。通过这种方式，您将能够更轻松地为 DAL 编写单元测试，并且仍然不会产生太多开销。此外，如果您将 DAL 创建为单例，则在多线程环境（例如 Web 应用程序）中使用它时，您需要更加关注使其线程安全。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-13T23:14:52.267

只有当您想确保在您的应用程序实例中只实例化一个类的实例时，才应使用单例。

单身人士几乎不能被认为是代码气味。大多数使用 Singleton 的人都使用得很糟糕。因此，当您看到一个时，很有可能它没有正确使用。

至于 DAL，对象的创建并不广泛。他们应该依赖于使用连接池，然后在每次需要执行命令时从池中请求连接。

当然，有不同的模式可用，您应该主要使用 ORM，除非需要调整请求以提高性能。

请参阅[NHibernate](http://www.hibernate.org/343.html)、[SubSonic](http://subsonicproject.com/)、[Linq2Sql](http://msdn.microsoft.com/en-us/library/bb386976.aspx)、[Entity Framework](http://msdn.microsoft.com/en-us/library/aa697427(VS.80).aspx)（尚未发布？）等。

# wcf - 企业级数据合同是一种好的做法吗？

> ID：441216
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-13T23:00:09.660
> 
>         
> 
> 标签：wcf, datacontract

在企业级程序集中定义 DataContracts 然后在 WCF 服务项目中引用它们而不是在单个 WCF 服务解决方案级别定义它们是一种好习惯吗？我看到的所有 WCF 示例都避开了该主题，并且仅在服务解决方案中定义了 DataContracts。我与之交谈的一些程序员希望将 DataContracts 视为企业级规范数据模型的不同风格，而不是服务本地合同。我还没有找到任何支持或反对这种观点的论据。

这个问题可能很难选择正确的答案，但我会努力的。我至少会对任何我觉得能增加我对这个话题的理解的东西投赞成票。   

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-01-13T23:29:30.630

我真的很喜欢将 DataContracts（和服务合同）放入程序集中，然后与服务和客户端等共享它们的想法，但我认为没有任何充分的理由将它们全部放入一个整体程序集中。

根据它们的使用方式将它们放入程序集中更有意义。如果有一组在多个服务和客户端之间共享，那么这就是一个程序集，等等。  

这样做消除了暴露元数据的需要，我认为它可以让你做一些漂亮的事情，比如在服务器端和客户端连接到序列化事件。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T23:28:18.527

IDesign.net 上的人们建议跨项目共享合同程序集。我个人建议不要为所有内容创建代理。真的没有令人信服的理由*不*这样做。

确保您的关注点在这里分开很重要。你提议的程序集应该只包含类型而不是任何实现，以免你被更频繁地重新分发 DLL 所困扰。

I would also recommend that you group contracts that will version together into assemblies, rather than one monolithic assembly.  This will reduce your overhead when making very small changes to your enterprise-level contracts.

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-13T23:30:04.013

与计算机科学中的大多数事情一样，答案是 - 这取决于:)

您的数据合同类别是否仅在一项、两项服务或整个企业范围内相关？他们有可能改变吗？想想这类问题。

如果您确实想让它们成为全局程序集的一部分，并且您使用的是 .NET 3.5 Sp1，请知道您不再需要数据类上的 DataContract/DataMember 属性。如果您不想依赖 System.ServiceModel （并且在大多数情况下您不需要），它可能很有用。

# weblogic - Weblogic wlserver内存设置？

> ID：441237
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-13T23:04:28.030
> 
>         
> 
> 标签：weblogic

当我们从命令行启动 Weblogic (8.1) 时，我们将“-Xms256m -Xmx1024m”形式的内存使用参数传递给它，这给它一个 GB 的空间来玩。

当我们从 ANT 启动它时，我们使用的是“wlserver”任务，我猜它会实时启动它。那么它使用什么内存参数呢？我将如何告诉它使用 1GB 选项？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T19:01:40.733

类`weblogic.ant.taskdefs.management.WLServer`扩展`org.apache.tools.ant.taskdefs.Java`，因此应该可以为它提供与 java ant 任务相同的参数（请参阅[http://ant.apache.org/manual/Tasks/java.html](http://ant.apache.org/manual/Tasks/java.html)）。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T00:44:53.020

我认为 wldeploy 允许您将新应用程序部署到 WebLogic：

[http://e-docs.bea.com/wls/docs90/programming/wldeploy.html](http://e-docs.bea.com/wls/docs90/programming/wldeploy.html)

至少我是这样使用它的。

最大和最小内存要求是在启动脚本中设置的，不是吗？  

# java - JavaBeans 的替代品？

> ID：441240
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2009-01-13T23:05:05.657
> 
>         
> 
> 标签：java, properties, javabeans

我讨厌 JavaBeans 模式，我的热情就像一千个太阳的火焰一样燃烧。为什么？

*   **详细**。现在是 2009 年。我不应该为房产写 7 LOC。如果他们有事件监听器，那么请抓住你的帽子。

*   **没有类型安全的引用**。没有类型安全的方式来引用属性。Java 的全部意义在于它是类型安全的，它最流行的模式根本不是类型安全的。

我想要的是这样的：

```
class Customer {
    public Property<String> name = new Property();
} 
```

我主要是 Web 开发人员，所以它需要 JPA 和 Wicket 支持。

帮我下javabean火车！

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-01-14T01:43:30.110

我认为您与那里的声明非常接近（请参见下面的草图）。但是，通过使用非 bean 方法，您可能会失去大多数假定 JavaBeans 协议有效的工具所提供的支持。请善待。下面的代码不在我的脑海中......

```
public class Property<T> {
    public final String name;
    T value;
    private final PropertyChangeSupport support;

    public static <T> Property<T> newInstance(String name, T value, 
                                              PropertyChangeSupport support) {
        return new Property<T>(name, value, support);
    }

    public static <T> Property<T> newInstance(String name, T value) {
        return newInstance(name, value, null);
    }

    public Property(String name, T value, PropertyChangeSupport support) {
        this.name = name;
        this.value = value;
        this.support = support;
    }

    public T getValue() { return value; }

    public void setValue(T value) {
        T old = this.value;
        this.value = value;
        if(support != null)
            support.firePropertyChange(name, old, this.value);
    }

    public String toString() { return value.toString(); }
} 
```

然后继续使用它：

```
public class Customer {
    private final PropertyChangeSupport support = new PropertyChangeSupport();

    public final Property<String> name = Property.newInstance("name", "", support);
    public final Property<Integer> age = Property.newInstance("age", 0, support);

    ... declare add/remove listenener ...
}

Customer c = new Customer();
c.name.setValue("Hyrum");
c.age.setValue(49);
System.out.println("%s : %s", c.name, c.age); 
```

因此，现在声明一个属性是一行代码，并且包括属性更改支持。我调用了 setValue() 和 getValue() 方法，所以它看起来仍然像一个 bean 来编写 Rhino 之类的代码，但为了简洁起见，您可以只添加 get() 和 set()。其余的留给读者练习：

*   正确处理序列化

*   处理空值检查

*   如果您关心自动装箱开销，可能会为原子类型添加专业化。

*   ?? 我敢肯定还有更多的陷阱

另请注意，您可以子类化（通常作为匿名类）并覆盖 setValue() 以提供额外的参数检查。

我认为您无法真正摆脱“字符串引用”，因为这几乎就是反射的全部内容。

可悲的是，在这个时代，这仍然有点像汇编编程......如果你有选择的话，Groovy、C# 等可能仍然是更好的选择。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-01-14T22:20:05.137

在以下位置查看我的 Bean 注释

[http://code.google.com/p/javadude/wiki/Annotations](http://code.google.com/p/javadude/wiki/Annotations)

基本上你会做这样的事情：

```
@Bean(
  properties={
    @Property(name="name"),
    @Property(name="phone", bound=true),
    @Property(name="friend", type=Person.class, kind=PropertyKind.LIST)
  }
)
public class Person extends PersonGen {} 
```

而不是自己定义所有这些额外的 get/set 等方法。

还有其他属性可以定义equals/hashCode、observers、delegate、mixins等。

它是一组注解和一个注解处理器，可以在 eclipse 或命令行构建中运行（例如在 ant 中）。处理器生成一个超类来包含所有生成的代码（注释处理器不能更改包含注释的类，顺便说一句）

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-01-13T23:12:50.633

您可能想查看[Groovy](http://groovy.codehaus.org/) - 一种动态类型、基于 JVM（并且完全兼容 Java）的语言，具有“真实”属性。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T00:06:08.623

对于网络，我建议使用[JSON](http://www.json.org/)（JavaScript Object Notation），

> 一种轻量级的数据交换格式

. 这是对 JSON?Bean[转换](http://ajaxian.com/archives/gwt-jsonizer-jsonjavabeans-translator)器的引用。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T12:58:32.417

使用 Spring 框架。它的目的是通过抽象您抱怨的大量基础工作来简化 Java 开发。

您可以将它与 Hibernate 一起使用，这将为您简化与数据源的交互。

有用的网站：

www.springsource.org/download

www.hibernate.org/

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-07-27T13:35:42.193

当我第一次使用 C# 时，我喜欢这些属性，但现在，在 VS 2008 中使用它们一段时间后，我不得不说我更喜欢 set-/get-methods。

重点是我个人的工作方式。当我有一个新类并且我想知道我可以用它做什么时，我只需键入 classname.set，Eclipse 就会向我显示我可以更改哪些“属性”。get 也是一样。也许它只是糟糕的 VS 方式，但是我必须浏览一长串这个 itelisense （所有东西都是混合的，而不是先显示属性），只是为了在我编译后发现我想要设置的属性是只读的。 ..doh！

是的，在 Java 中您需要很多行，但我只是编写属性并告诉 IDE“请为我创建 getter 和 setter”。但是这些方法往往会占用大量空间，这就是为什么我希望在 Java 中也有可以在 IDE 中折叠的区域。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-01-13T23:15:46.540

您还可以构建一个代码生成器，从您编写的 DSL 创建您的 .java 类。您可以使用某种标记来描述您的类的名称、您想要的属性以及它们的类型。然后，使用生成 javabean 的程序处理该文件。或者您可以使用注释，并使用 ASM 之类的东西对类文件进行后处理，以注入访问器和修改器。我也相信 Spring 提供了其中一些功能，但我没有使用过它们。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T07:50:30.870

试试JBoss 的[SEAM](http://www.seamframework.org/)框架，你应该会喜欢的。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T12:39:56.930

一旦我尝试了这个：

```
interface IListenable {
    void addPropertyChangeListener( PropertyChangeListener listener );
    void removePropertyChangeListener( PropertyChangeListener listener );
}

abstract class MyBean extends IListenable {
    public abstract void setName(String name);
    public abstract String getName();

    // more things
}

public class JavaBeanFactory {

   public <T> Class<T> generate(Class<T> clazz) {
      // I used here CGLIB to generate dynamically a class that implements the methods:
      // getters
      // setters
      // addPropertyChangeListener
      // removePropertyChangeListener
   }
} 
```

我用它作为这个（这只是一个例子）：

```
public class Foo {
    @Inject
    public Provider<MyBean> myBeanProvider;

    public MyBean createHook(MyBean a) {
        final MyBean b  = myBeanProvider.get();
        a.addPropertyChangeListener(new PropertyChangeListener() {
             public void propertyChange(PropertyChangeEvent evt) {
                 b.setName((String) evt.getNewValue());
             }
        });
        return b;
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2013-05-02T13:10:02.987

我在模型实体（使用 JPA 注释）上大量使用 JavaBean 属性，以便能够将它们数据绑定到 UI（使用 JFace）。

不幸的是，我没有第二个问题的解决方案（也许除了定义包含属性名称的常量）。

我生成侦听器样板的方法是让我的模型实体从使用反射处理它的 AbstractJavaBean 超类扩展。然后我可以使用创建 getter/setter 的默认方式，除了 setter 需要重写如下：

```
public void setRemarks(String remarks) {
    set("remarks", remarks);
} 
```

AbstractJavaBean.set 然后使用反射（通过 Apache commons beanutils）通过其 getter 读取属性“remarks”的旧值，将新值设置为名为“remarks”的字段，并使用旧值和新值触发属性更改事件. 事实上，这个想法可以扩展为使依赖的“派生”属性能够在属性之一基于更改时自动触发属性更改，例如在属性“birthDate”更改时更改“age”。所有这些逻辑都可以在 AbstractJavaBean 内的一个地方编码，并由任何模型对象使用。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2014-12-23T16:22:00.243

我正在寻找同样的东西，我真的很惊讶我找不到合适的图书馆。由于我经常感到疼痛，因此我在 2 年前开始了一个解决这些问题的小项目：正确地

可在以下网址获得：
 [https](https://github.com/aditosoftware/propertly) ://github.com/aditosoftware/propertly 。我们现在在我们的产品中使用它。

它提供了带有泛型的静态类型、不同级别的侦听器、树导航、动态模型等等。主要优点是模型的描述是静态完成的，因此信息始终可用，并且在设计时考虑了可扩展性。因此，您可以使用自己的注释进行验证或定义数据从哪里读取和存储到哪里。

**使用示例：**

一个简单的 IPropertyPitProvider。属性是名字、姓氏和年龄。

```
// Generics describe parent, self and children
public class StudentPropertyPitProvider 
    extends AbstractPPP<IPropertyPitProvider, StudentPropertyPitProvider, Object>
{
  // IPropertyDescription gives static access to an IProperty's meta data like name and type.
  public static final IPropertyDescription<StudentPropertyPitProvider, String> FIRST_NAME =
      PD.create(StudentPropertyPitProvider.class);

  public static final IPropertyDescription<StudentPropertyPitProvider, String> LAST_NAME =
      PD.create(StudentPropertyPitProvider.class);

  public static final IPropertyDescription<StudentPropertyPitProvider, Integer> AGE =
      PD.create(StudentPropertyPitProvider.class);

  // Getters and setters can of course still be used for easier access. 
  public String getFirstName()
  {
    // getValue and setValue is available at AbstractPPP. That class is used for easier access. 
    // Propertly can be used without inheriting from that class, too.
    return getValue(FIRST_NAME);
  }

  public void setFirstName(String pFirstName)
  {
    setValue(FIRST_NAME, pFirstName);
  }

  public String getLastName()
  {
    return getValue(LAST_NAME);
  }

  public void setLastName(String pLastName)
  {
    setValue(LAST_NAME, pLastName);
  }

  public Integer getAge()
  {
    return getValue(AGE);
  }

  public void setAge(Integer pAge)
  {
    setValue(AGE, pAge);
  }

} 
```

使用定义的提供者：

```
public class Sample
{

  public static void main(String[] args)
  {
    // Hierarchy is necessary to initialize the IPropertyPitProviders and for advanced features.
    Hierarchy<StudentPropertyPitProvider> hierarchy =
        new Hierarchy<>("student1", new StudentPropertyPitProvider());
    // The created student can be accessed from the hierarchy.
    StudentPropertyPitProvider student = hierarchy.getValue();
    // Listeners can be added.
    student.addPropertyEventListener(new PropertyPitEventAdapter()
    {
      @Override
      public void propertyChanged(IProperty pProperty, Object pOldValue, Object pNewValue)
      {
        System.out.println(pProperty.getName() + "=" + pNewValue);
      }
    });

    // The following calls will cause
    //  FIRST_NAME=Nils
    //  LAST_NAME=Holgersson
    //  AGE=32
    // to be printed on console through the listener.
    student.setFirstName("Nils");
    student.setLastName("Holgersson");
    student.setAge(32);
  }

} 
```

# vba - Office VBA 会发生什么？

> ID：441248
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2009-01-13T23:07:29.893
> 
>         
> 
> 标签：vba, ms-office

我工作的公司是在 Excel 表格上运行的。其中一些表格嵌入了某种形式的 VBA 代码。我正在对它们进行一些维护，但感觉确实过时了。

Office VBA 会发生什么？

为什么微软没有为 Office 发布嵌入式 .NET 宏语言？

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-01-14T00:06:20.337

简短的回答：你可能暂时还好。

长答案：VB6（这就是 VBA 的真正含义）几乎是一种死的、不受支持的语言，最后一次更新是十年前的同一时期的 IDE。它仍然存在，因为它嵌入在 Office 中，如果删除或更改 VBA，数百万个 Office 应用程序将停止工作。更不用说数百万非常恼火的用户了。

那么如何前进呢？Office 可以在托管代码中重新实现吗？微软真的想这样做吗？他们是否会做出比 Ribbon 更大的向后兼容性中断，并放弃宏记录和解释嵌入式代码的概念？我只是看不到我的用户在 Visual Studio 中使用 COM 互操作和诸如此类的东西使用 VB.NET。

如果我必须在一个结果上投入资金（即使那时我也不想赌太多），我会关注[动态语言运行时](http://en.wikipedia.org/wiki/Dynamic_Language_Runtime)以及多种语言处于不同准备状态以运行它的事实。假设 DLR 以及 Office 应用程序 COM 模型的一些合适的替换或包装器将替换 VB6 运行时。此外，假设 VBA 被实现为 DLR 语言。现在，传统 VBA 将继续运行，只是在不同的（现代的、受支持的）解释器上运行，我们可以用 Python、Ruby 或任何其他我们喜欢的 DLR 语言编写 Excel 宏。

但这只是我最好的猜测——我不知道它是否真的会发生。不过，我当然希望能够在 Ruby 中编写 Excel 宏。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-01-13T23:14:16.620

他们正在[为下一版 Office for Mac 添加 VBA 支持](http://www.microsoft.com/Presspass/press/2008/may08/05-13MacBU2008PR.mspx)，所以我怀疑它会存在一段时间。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-01-13T23:12:50.850

我想说现在是你深入研究 .NET 的时候了。

您可以从 Excel 调用 .NET 库。

[http://richnewman.wordpress.com/2007/04/15/a-beginner%E2%80%99s-guide-to-calling-a-net-library-from-excel/](http://richnewman.wordpress.com/2007/04/15/a-beginner%E2%80%99s-guide-to-calling-a-net-library-from-excel/)

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T20:54:41.347

好吧，我是一位经验丰富的 .NET 程序员。我尝试了 Office 工具，它使用起来很痛苦，它需要您分发程序集（LOL。）财务或交付无法使用它。在点击卸载之前，我们笑得很开心。

我们尝试了 Google Docs，它非常灵活，但仍然不如 Excel 宏强大。微软自 2000 年以来一直停滞不前，而谷歌正在快速发展，所以几年后答案可能会有所不同。由于所有的安全废话，VBA 本身在今天实际上已经*不那么强大了。*

最后，我仍然在他们的工作表中获得了一个按钮来做他们想做的事情，如果他们愿意，他们可以对代码进行微小的更改。奇怪的是，VBA 是我怀疑世界上所有财务部门都在使用的方法。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T00:05:19.980

昨天我也遇到了同样的想法。多么巧合。突然间，我兼职工作的老板正在寻找我 3 年前创建的 Excel 应用程序（2007 年离开公司，然后作为兼职员工回到他们那里，以增加我的全职工作）。我记得我已将其转换为 MS Access 2003 应用程序；但该应用程序需要更新以满足新的要求。你猜怎么着，我想我已经忘记了VBA。现在不是返回并从头开始重新学习的合适时机。我正在继续使用 C# 2.0/3.0。我敢肯定，用 C# 3.0 重建 MS Access 2003 应用程序将是一次很好的学习体验！

@IainMH 是对的……“是时候深入了解 .NET”了

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2019-01-21T11:57:45.750

在 Excel 出现之前，VBA 是值得学习的，因为无论您在 Excel 中做什么，VBA 都可以自动执行该操作以节省您的时间并减少出错的机会。您可以简单地运行代码并坐在椅子上休息任务将由 VBA 代码完成。... 使用 VBA，您可以学习 SQL 和 Excel（如果您已经知道那就太好了）。

# c# - 在 C# 中获取全局设置

> ID：441251
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-13T23:08:39.753
> 
>         
> 
> 标签：c#, global-variables

以这篇关于类和结构的文章为例：

[http://msdn.microsoft.com/en-us/library/ms173109.aspx](http://msdn.microsoft.com/en-us/library/ms173109.aspx)

```
namespace ProgrammingGuide
{
    // Class definition.
    public class MyCustomClass
    {
        // Class members:
        // Property.
        public int Number { get; set; }

        // Method.
        public int Multiply(int num)
        {
            return num * Number;
        }

        // Instance Constructor.
        public MyCustomClass()
        {
            Number = 0;
        }
    }
    // Another class definition. This one contains
    // the Main method, the entry point for the program.
    class Program
    {
        static void Main(string[] args)
        {
            // Create an object of type MyCustomClass.
            MyCustomClass myClass = new MyCustomClass();

            // Set the value of a public property.
            myClass.Number = 27;

            // Call a public method.
            int result = myClass.Multiply(4);
        }
    }
} 
```

假设我想使用在程序其他地方的 Main 例程中定义的“myClass”，就好像它是一个全局类一样。

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-13T23:11:57.797

```
static MyCustomClass myClass;
public static MyCustomClass MyClass {get {return myClass;}}
static void Main(string[] args)
{
    // Create an object of type MyCustomClass.
    myClass = new MyCustomClass();

    ...
} 
```

现在你可以使用`Program.MyClass`

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-13T23:12:07.203

类似于下面的示例。

```
class Program
{
    public MyCustomClass myClass;

    public Program()
    {
        // Create an object of type MyCustomClass.
        myClass = new MyCustomClass();

        // Set the value of a public property.
        myClass.Number = 27;

        // Call a public method.
        int result = myClass.Multiply(4);
    }

    static void Main(string[] args)
    {
        Program program = new Program();
    }
} 
```

# sharepoint - 在 SharePoint 中，创建自定义列表“schema.xml”文件的最简单方法是什么？

> ID：441252
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-01-13T23:10:21.823
> 
>         
> 
> 标签：sharepoint, list, sharepoint-2007, wss-3.0

与许多其他 SharePoint 用户一样，我必须创建自定义列表定义。经过一番麻烦，我设法创建了一个（我想，让我先解决所有错误），但是我可以从那里开始使用“基本”模式，还是专门为`Schema.xml`生成而构建的编辑器？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T01:17:19.103

我的建议以及最接近最终版本的方法是使用 SharePoint Web 界面，根据需要设置列表，包括视图、自定义列等。然后，将列表另存为模板。

你得到的 .stp 文件基本上只是一个名字很有趣的 .cab 文件。重命名为 cab 并提取清单，其中将包含一个几乎可以使用的 schema.xml 文件供您使用。

您需要更改的是列表表单的路径或设置路径。您将在 manifest.xml 文件的底部找到这些内容。如果您使用默认的 SharePoint 列表，这些表单可以设置为 SetupPath="pages/form.aspx"。以下是自定义列表表单元素的示例：

```
 <Form Type="DisplayForm" Url="DispForm.aspx" 
SetupPath="pages\form.aspx" WebPartZoneID="Main" />
    <Form Type="EditForm" Url="EditForm.aspx" 
SetupPath="pages\form.aspx" WebPartZoneID="Main" />
    <Form Type="NewForm" Url="NewForm.aspx" 
SetupPath="pages\form.aspx" WebPartZoneID="Main" /> 
```

您还需要更新每个视图的视图路径，如果在原始站点中使用默认表单，则应该是 SetupPath="pages/viewpage.aspx"。

请注意，您还需要修改其他属性，但如果您确保遵循 wss.xsd 架构并且您的自定义列表 schema.xml 验证到 wss.xsd 架构，那么您应该没问题。

.b

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T07:43:39.900

要创建自定义列表定义，我总是使用一些内置列表定义作为模板。

创建新功能，然后从现有功能复制 schema.xml（可能还有其他文件，如果存在），并使用一些文本编辑器直接修改 schema.xml 文件。我没有为此尝试过任何自定义编辑器，并且总是通过复制粘贴和更改属性值来完成工作。

内置列表定义作为功能位于 12 个配置单元中：

*   自定义列表——Features/CustomList/CustList/schema.xml；

*   文档库——Features/DocumentLibrary/DocLib/schema.xml；

*   日历 – Feature/EventsList/Events/schema.xml；

*   使用搜索来寻找其他人。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T00:06:42.460

您可以使用[SharePoint 管理器](http://www.codeplex.com/spm)选择您想要架构的列表并将其用作模板。

任何架构生成都将依赖于上下文，因为任何自定义字段的 GUID 将特定于该 SharePoint 网站集，除非它们是作为先前指定功能的一部分安装的（依赖于已创建的 XML 架构）。

SharePoint 管理器是一个很好的工具，不是因为它专门针对这个问题，而是因为它是一种从 SharePoint 实例中获取各种信息（如架构）的*非常有用的方法。*

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T11:10:22.323

借助[Windows SharePoint Services 3.0 工具：Visual Studio 2008 Extensions，版本 1.2](http://www.microsoft.com/downloads/details.aspx?FamilyID=7bf65b28-06e2-4e87-9bad-086e32185e68&displaylang=en)附带了一个名为“SharePoint Solution Generator 2008”的应用程序。这个应用程序有一些限制（最糟糕的是*[查找列消失](http://www.mtelligent.com/journal/2007/10/14/adding-back-lookup-columns-in-the-provisioning-handler.html#comments)**的 IMO*），但它会创建您需要创建的文件，即现有 SharePoint 列表中的一个功能。这包括 schema.xml。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2009-01-18T20:35:14.760

我总是使用 Gary Lapointes STSADM 扩展来提取这类东西。也就是说，我首先使用 GUI 创建它，然后使用适当的方法提取列表、内容类型、网站栏等。

查看*[STSADM/PowerShell 命令](http://stsadm.blogspot.com/2007/08/stsadm-commands_09.html)*中的 Garys 扩展列表。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-07-15T16:31:17.397

您通常复制的所有 schema.xml 文件的一个大问题是 90% 的代码驻留在各种视图元素中。有一个非常简单的解决方案 - 使用默认的 ViewStyles 之一。

这是一个简单易读的简约模式。阅读[http://mo.notono.us/2009/02/moss-dreaded-schemaxml.html](http://mo.notono.us/2009/02/moss-dreaded-schemaxml.html)了解详情。除非你真的，真的需要调整呈现的 html，否则不要打扰视图 caml：

```
<?xml version="1.0" encoding="utf-8"?>
<List xmlns:ows="Microsoft SharePoint" Id="{AB426CDE-98F2-432A-B296-880C7931DEF3}"
     Title="Setting" Url="Lists/Setting" BaseType="0"
     FolderCreation="FALSE" DisableAttachments="TRUE" VersioningEnabled="FALSE"
     Direction="$Resources:Direction;"
     xmlns="http://schemas.microsoft.com/sharepoint/">
       <MetaData>
              <Fields>
                     <Field Type="Text" Name="Title" DisplayName="Name" Required="TRUE" />
                     <Field Type="Text" Name="Value" DisplayName="Value" Required="TRUE" />
              </Fields>
              <Views>
                     <View BaseViewID="0" Type="HTML" WebPartZoneID="Main" DisplayName="All Items" DefaultView="TRUE"
                         MobileView="True" MobileDefaultView="False" SetupPath="pages\viewpage.aspx"
                         ImageUrl="/_layouts/images/issues.png" Url="AllItems.aspx">
                           <ViewStyle ID="17"/>
                           <RowLimit Paged="TRUE">100</RowLimit>
                           <Toolbar Type="Standard" />
                           <ViewFields>
                                  <FieldRef Name="Edit" />
                                  <FieldRef Name="Title"/>
                                  <FieldRef Name="Value"/>
                           </ViewFields>
                           <Query>
                                  <OrderBy>
                                         <FieldRef Name="Title"/>
                                  </OrderBy>
                           </Query>
                     </View>
              </Views>
              <Forms>
                     <Form Type="DisplayForm" Url="DispForm.aspx" SetupPath="pages\form.aspx" WebPartZoneID="Main" />
                     <Form Type="EditForm" Url="EditForm.aspx" SetupPath="pages\form.aspx" WebPartZoneID="Main" />
                     <Form Type="NewForm" Url="NewForm.aspx" SetupPath="pages\form.aspx" WebPartZoneID="Main" />
              </Forms>
              <DefaultDescription>Settings used in the application.</DefaultDescription>
       </MetaData>
</List> 
```

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-08-18T13:33:50.327

我自己和 Rich Finn 编写了一个名为 SPSource 的工具，它可以对列表进行逆向工程以列出模板、内容类型和站点列。[请在http://spsource.codeplex.com/](http://spsource.codeplex.com/)上查看它，那里有详细的用户指南和网络广播向您展示如何使用它。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-01-20T15:15:40.487

添加到 EG 的答案中，如果您只想更改附加到现有列表的字段（但使视图等基本相同），您必须在两个地方进行更改：列表/元数据/字段和列表/元数据/视图/视图/视图字段。

[假设您遵循文档](http://msdn.microsoft.com/en-us/library/ms451470.aspx)，字段部分相对简单。

要让列显示在给定视图中，您必须编辑给定视图的 ViewFields 部分。例如，如果您想要在视图中显示名为 Title、Author 和 Publisher 的列，请找到该视图的 ViewFields 部分并按如下方式进行编辑：

```
<ViewFields>
  <FieldRef Name="Title" />
  <FieldRef Name="Author" />
  <FieldRef Name="Publisher" />
</ViewFields> 
```

然后，这些字段（并且只有那些字段）应显示在该视图中。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2011-11-04T12:15:08.060

使用浏览器选项创建要在本地开发环境中开发的列表。将网站另存为模板。将其下载到本地文件系统。

现在使用模板创建一个新的 Visual Studio 项目，从解决方案包中导入。找到存储在文件系统上的解决方案包。现在，当您看到解决方案时，您将找到您创建的列表。文件`schema.XML`将位于列表定义中。复制内容类型、字段和视图内容并将其粘贴到您的`schema.xml`文件中。

# python - Py2Exe - “应用程序配置不正确。”

> ID：441256
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-01-13T23:11:01.760
> 
>         
> 
> 标签：python, wxpython, compilation, py2exe

我已经使用 Py2Exe 编译了我的 Python 程序，并且在客户端的计算机上，我们使用依赖遍历器满足了所有依赖关系，但我们仍然得到“应用程序配置不正确。重新安装应用程序可能会解决问题。” 我也在使用 wxPython。

客户端没有管理员访问权限。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T00:39:30.520

[试一试](http://code.google.com/p/gui2exe/)GUI2exe ；它是由 wxpython 社区中的大人物 Andrea Gavana 开发的，他封装了一堆冰柜，包括 py2exe。可能是 dll 问题，尝试[搜索 wxpython 列表存档](http://www.google.com/search?hl=en&client=firefox-a&rls=org.mozilla%3Aen-US%3Aofficial&hs=90t&q=site%3Ahttp%3A%2F%2Flists.wxwidgets.org%2Fpipermail%2Fwxpython-users%2F+%2B%22py2exe%22+%2Bdll&btnG=Search)。  [这个线程](http://lists.wxwidgets.org/pipermail/wxpython-users/2008-November/081956.html)可能有用。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T01:33:58.477

我自己也遇到过这个问题，我的随机谷歌搜索向我指出了几个人说要将 python 2.6 降级到 2.5，这对我有用。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-08-19T12:15:28.780

刚刚在 python 2.6、PyQt 和 py2exe 中遇到了同样的问题。根本原因是缺少依赖项，通过安装[Visual Studio 2008 SP1 redist(x86)](http://www.microsoft.com/downloads/details.aspx?familyid=A5C84275-3B97-4AB7-A40D-3802B2AF5FC2&displaylang=en)解决了。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-30T13:58:04.413

几分钟前我遇到了类似的问题。我无法运行 py2exe 安装文件，它一直说应用程序配置不正确。降级到 python 2.5 对我不起作用，因为我在代码中使用了 'with' 语句并且不想更改它。

我重新安装了 python 2.6，并检查了计算机上的任何人都可以使用 python 的选项。工作得很好。

# c# - C#中的核心类是什么？

> ID：441264
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-01-13T23:12:58.200
> 
>         
> 
> 标签：c#, .net

对于有抱负的 C# 桌面应用程序程序员来说，为了更好地掌握 C#，哪个类层次结构是最必要的？不只是完全明显的东西。

**编辑：**  澄清一下，我的意思是，当我学习 C# 时，我想知道我应该熟悉哪些类，对于没有足够经验的人来说，这不一定是显而易见的。是，学习并不重要。

**EDIT2：**还有更多晦涩的课程吗？到目前为止，我对其中许多已经给出的内容了解很多。

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-01-13T23:16:35.460

System.Collections

System.Data（许多应用程序都有数据库后端）

System.Windows（因为它是一个桌面应用程序）

System.Graphics（如上）

System.Diagnostics（提供对日志记录和调试有用的各种对象和方法，在商业代码中始终很重要）。

这些命名空间包含重要的类，可以在大多数应用程序中完成许多日常工作，无论应用程序是基于 Web 还是基于桌面。Windows 几乎只适用于桌面应用程序（就像你说的那样），图形将密切配合（也恭维网络应用程序）。您最好学习这些名称空间中的所有类，即使您只要求类。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T09:08:12.770

刚刚在另一个线程中找到了这个链接：[map](http://www.geekpedia.com/gallery/fullsize/net-framework-3.5-types-and-namespaces-poster.jpg)

此外，下载[Reflector](http://www.red-gate.com/products/reflector/)并浏览 .NET Framework 类，从 mscorlib.dll 和 System.dll 开始。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-01-13T23:36:19.603

```
System.Collections

System.Collections.Generic

System.IO

System.Diagnostics 
```

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T01:12:43.870

[System.Text](http://msdn.microsoft.com/en-us/library/system.text.aspx)有人吗？

这是最重要的之一，至少对我而言，您将需要它来对文本执行基本操作，例如在编码之间转换文本......

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-01-13T23:28:32.147

对于桌面应用程序，我会在 GSS 中添加评论：System.Windows.Forms。这些类是桌面开发的基础。

最好的祝愿，西尔万。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-01-13T23:31:46.070

StringBuilder 是一个非常重要的类。

基本上，当您想使用 + 运算符进行大量动态字符串连接时，您真正想要做的是使用 StringBuilder。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T10:16:02.197

我可以提出以下建议：

*   系统.Windows.Form

*   System.Windows.FileDialog

*   System.Windows.Forms.MDIClient

*   System.Windows.Forms.MessageBox

*   系统.XML.XML文档

*   System.XML.XMLNodeReader

*   System.XML.XMLReader

*   System.Drawing.Text

*   System.Collections.*

*   System.Diagnostics.Trace/Debug

*   System.Configuration.* - System.Component.ComponentModel

*   System.Text.*

*   System.Timers.Timer

*   系统.数据.*

# c# - 如何在 C# 中设置对象创建接口“规则”？

> ID：441265
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-13T23:13:14.343
> 
>         
> 
> 标签：c#, class, oop, interface, static-methods

一般规则是我想说，“T 有一个带有 String 参数的方法，它将返回 List。” 详细地说，我们可以调用接口 ICanCreateListOfObjectsFromString。一个可能的应用可能是搜索。

感觉在我的界面中有一个静态方法会很好，但我知道这在 C# 中是不允许的。在类上指定这种合同实现的另一种方法是什么？

编辑：我想要以下代码：

```
public interface ISearch
{
    static List<T> Search<T>(String s);
}

public class MyObject : ISearch {
    List<MyObject> Search(string s) {
        //...
    }
}

public List<T> DoFooSearch<T:ISearch> () {
        return T.Search("Foo");
}

public List<T> DoBarSearch<T:ISearch> () {
        return T.Search("Bar");
} 
```

您可能会看到为什么这段代码无法编译，但它表达了我想要实现的精神。我希望这能澄清我的意图。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T07:00:31.687

听起来您正在尝试实现一个 Mixin... 这种东西存在于 C# 3.0 中，它们被命名为“扩展方法”。

允许你做什么？好吧，它们允许您创建以您指定的类型工作的函数，并向它们“添加”方法。由于该类型可以是接口，因此您可以为接口定义具体函数。

诚然，这些函数不是接口代码本身的一部分，但它们也不是任何接口实现的一部分。所以这是一个“杯子半满”的场景。

（一个简短的搜索让我找到了[使用 C# 扩展方法实现 Mixins](http://www.zorched.net/2008/01/03/implementing-mixins-with-c-extension-methods/)。）

或者：如果您不需要对实现接口的类进行多重继承，则可以使用抽象类而不是接口，并直接在其中实现具体功能。但是话又说回来，这意味着您放弃从该类以外的任何东西继承（并实现其他接口。）

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-13T23:17:54.617

也许[工厂模式](http://en.wikipedia.org/wiki/Factory_method_pattern)就是您正在寻找的。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-13T23:18:46.173

第一个选项是将两个问题分开：

*   一种类型是实体

*   一种是工厂

然后你可以为工厂创建一个接口，并使用它（基本上就像实体上以前的静态方法一样）。

另一种选择是在代表中交谈 - 即 a `Func<string,List<...>>`（对于某些列表类型）；然后你可以简单地创建一个委托：

```
Func<string,List<...>> func = SomeType.SomeMethod; // static method 
```

然后您可以传递`func`，并（稍后）将其用作：

```
List<...> data = func("abc"); 
```

# c# - 无法解析日期时间

> ID：441270
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-01-13T23:15:03.297
> 
>         
> 
> 标签：c#, datetime, parsing, settings, date

我正在尝试使用`DateTime.ParseExact`. 它可以在任何地方工作，除了在一台机器上 - 它只是不会在那台机器上解析。问题是：为什么？那台机器上可能有什么不同，以至于它会导致这种行为？

以下是我已经看过的一些内容：

*   被`CultureInfo`传递给`DateTime.ParseExact`，即`CultureInfo.InvariantCulture`

*   流氓机器上的区域设置与解析工作的机器上的设置相同。

*   是的，字符串格式正确，即`dd/MM/yyyy HH:mm:ss`

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-01-14T03:10:22.150

我总是发现区域设置可能很棘手，而且您永远不能假设您的应用程序的用户甚至会首先正确设置他们的机器！

如果日期必须是字符串，我一直在用它来解析日期的全部内容是以“dd/MMM/yyyy”格式解析它，例如“14/JAN/2009”无论如何都会很好地翻译设置是。

顺便说一句，这个技巧也适用于 SQL Server :)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T00:45:34.253

如果没有异常信息（Marc Gravell 询问）和/或一些示例代码，很难猜测解决方案可能是什么。

根据我的经验，由于文化问题，我在日期/时间方面遇到了问题。你说过你已经尝试过硬编码。

流程在其中运行的实际文化如何？如果此代码位于 asp.net 网站中，则根据用户浏览器设置（在请求中传递）设置文化。

尝试在您的代码中执行此操作以对当前线程文化进行硬编码，以查看这是否有助于进一步调试此问题。

```
// Replace the culture with whatever you required.
System.Threading.Thread.CurrentThread.CurrentCulture = 
    CultureInfo.CreateSpecificCulture("en-GB"); 
```

告诉我们当你尝试时会发生什么？** 当我们没有足够的信息时，我讨厌输入答案。这更像是一个建议而不是一个答案:)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T01:13:59.780

确保不工作的机器上的区域设置与工作的机器相匹配。为避免将来出现此类问题，请在解析时指定文化。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T01:49:48.007

我同意 Pure.Krome 需要更多信息。为此，问题：

*   抛出了什么异常？

*   您正在调用哪个方法重载，以及您传递给它的具体内容是什么？

*   您是否验证过所有机器上的 .NET 运行时版本都相同？包括服务包版本？

*   您正在解析的字符串是由您的程序生成的还是来自外部来源？如果它是外部的，您是否验证过该字符串在流氓盒子上没有以某种方式不恰当地转义？可能创建字符串的任何程序的版本都已过时并且其中存在错误。

# java - 使用简单 XML 反序列化时出现未知异常

> ID：441272
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-13T23:15:46.273
> 
>         
> 
> 标签：java, exception, serialization, simple-framework

我正在使用 Java 中的简单 XML 反序列化数据，但我得到一个异常告诉我：

```
protokolsimulering.model.Terminal.<init>() 
```

这是我的序列化代码：

```
public void saveSimulationState(String simulationFile) {
    try{
        Strategy strategy = new CycleStrategy("id", "ref");
        Serializer serializer = new Persister(strategy);
        File result = new File(simulationFile);
        serializer.write(this.sm, result);
    }
    catch(Exception ex)
    {
        System.out.println(ex.getMessage());
    }
}

public void loadSimulationState(String simulationFile) {
    try {
        Strategy strategy = new CycleStrategy("id", "ref");
        Serializer serializer = new Persister(strategy);
        File source = new File(simulationFile);
        this.sm = serializer.read(Simulation.class, source);
    } catch (Exception ex) {
        System.out.println(ex.getLocalizedMessage());
    }
} 
```

Terminal.java 的代码是：

```
package protokolsimulering.model;

import java.util.ArrayList;
import protokolsimulering.model.DataPacket.*;

public class Terminal extends Sensor {

    public Terminal(int x, int y, double r) {
        super(x,y,r);
        learnPosition();
    }

    @Override
    public void init() {
        this.broadcast(PacketFactory.newRutePacket(this,0));
    }

    @Override
    public void step() {
        ArrayList<AbstractPacket> packetsThisStep = (ArrayList<AbstractPacket>) this.getPackages();

        for(AbstractPacket p : packetsThisStep) {
            if(p instanceof HalloPacket) {    
                // Rutningsprotokol
                send(p.getSender(),PacketFactory.newRutePacket(this,0));

                // Lokaliseringsprotokol
                send(p.getSender(), PacketFactory.newHerPacket(this, this.getKnownPosition()));
        }
    }
} 
```

}

完整的源代码可以在以下位置找到：

[http://code.google.com/p/sensor-protocol-simulation/source/browse/#svn/trunk/src/protokolsimulering](http://code.google.com/p/sensor-protocol-simulation/source/browse/#svn/trunk/src/protokolsimulering)

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T18:08:24.817

异常意味着问题与调用终端构造函数有关。

通常，要在反序列化时构造对象，必须有一个无参数构造函数，如下所示：

```
public Terminal() {
    ...
} 
```

# c# - 如何在 C# winforms 控件上嵌入 Java 控件？

> ID：441275
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-13T23:16:18.037
> 
>         
> 
> 标签：c#, java, winforms, controls, embed

我可以将 Java 控件（SWT、Swing、...）放在 C# 控件上吗？

我知道使用 Web 控件可以实现，但我不喜欢这种方式。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-01T19:58:56.480

我写了一些例子：

- Java 组件嵌入到 .NET GUI，

- .NET WinForm 组件嵌入到 Java GUI。

您可以在产品中找到它们：

[http://www.simtel.net/product.php[id]95126[SiteID]simtel.net](http://www.simtel.net/product.php[id]95126[SiteID]simtel.net) 

[http://www.simtel.net/product.php[id]98653[SiteID ]simtel.net](http://www.simtel.net/product.php[id]98653[SiteID]simtel.net) 

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-08-11T23:42:33.900

您可以使用 JNBridge 来做到这一点。

[http://www.jnbridge.com/jnbp-examples.htm#JinN](http://www.jnbridge.com/jnbp-examples.htm#JinN)

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T16:13:26.907

我已经重新检查过了，看起来 IKVM 目前在它的 AFT 程序集中没有足够的支持。我认为做你需要的唯一方法是在带有隐藏主窗口的单独进程中运行你的java控件，并以某种方式将该控件的句柄传递给你的C#应用程序。

* * *

原答案：

我不确定你是否可以“添加”它，但你可以尝试这个方向：

有必要通过 IKVM 将 java 类转换为 .Net 程序集。

1.  首先你需要得到java控件的句柄。如果您需要有关如何执行此操作的信息，可以查看[此帖子。](http://www.jguru.com/faq/view.jsp?EID=44507)这一步我失败了，因为我没有在 IKVM 的库中找到 Win32DrawingSurface 和 DrawingSurfaces，也许只在 java 端创建一些静态 getHandle() 方法就足够了。

2.  获取您的父 C# 控件的句柄。这很简单，因为 Control 有它的 Handle 属性。

3.  获得两个句柄后，您可以将其中一个设置为父级。为此，您需要从 WINAPI 调用 SetParent 函数。

    [DllImport("user32.dll")] private static extern IntPtr SetParent(IntPtr hWndChild, IntPtr hWndNewParent);

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T00:19:19.063

查看[IKVM](http://www.ikvm.net/)项目。它是一个在.net 中实现的Java 虚拟机，它允许java 和.net 互操作性。

不确定它到底有多完整，以及它是否启用了您需要的功能，但值得一看。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-01-21T14:34:46.200

如果控件不是自定义控件并且只是在摇摆不定，您可能会发现它在 Microsoft 的 Visual J# 中可用（版本 2.0 或 1.1 的补充插件 
[http://msdn.microsoft.com/en-us/vjsharp/ bb188695.aspx](http://msdn.microsoft.com/en-us/vjsharp/bb188695.aspx) )

请注意，J# Swing 控件不会直接在 WinForms 应用程序中播放球，您可能需要提供一个宿主控件，该控件将所有绘画委托给从隐藏的 J# 控件复制图像，该 J# 控件放置在简单的 j# 表单中（也隐藏在表单的视图区域被调整大小以匹配主机控件的视图区域。这至少可以消除对单独进程的需要。这种用法有几个限制，我怀疑您要使用的控件很复杂（或者您只是重新实现了它）。

请注意，J# 正在正式消亡（不再进行严重的维护），并且在 2015 年将正式不再支持它。预计长期使用它会给您带来相当大的痛苦，但如果您真的需要它的某些部分，这可能会有所帮助。

# css - Firefox 3 使用 display:inline-block 为 span 添加间距

> ID：441279
> 
>         
> 
> 赞同：23
> 
>         
> 
> 时间：2009-01-13T23:16:52.310
> 
>         
> 
> 标签：css, firefox

在我的测试中，我有 2 个跨度都设置为 display:inline-block，带有可见性边框。Firefox 在每个跨度之间呈现空间。甚至设置 margin:0;padding:0; 没有做任何事情来解决这个问题。在将内联 span 元素设置为 display:inline-block 时，我的期望是 2 个 span 彼此齐平呈现，就好像您向左或向右浮动 2 个 div 一样。我发现的唯一“修复”是将 float:left 或 right 添加到跨度中，但这违背了我试图根本不使用浮点数的最初目的。有任何想法吗？

```
<style>
span{
    border:2px solid #000;
    display:inline-block;
    padding:0;
    margin:0;
}
</style>
<span>Test</span>
<span>Test2</span> 
```

* * *

## 回答 #1

> 赞同：25
> 
>             
> 
> 时间：2009-01-13T23:19:43.707

将它们分开是因为它们之间有空格-换行符。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-08-18T14:05:47.050

您还可以使用注释来删除行之间的空白。

```
 <span>hou</span><!--
--><span>se#</span><!--
--><span>316</span><!-- outputs house#316 without spaces --> 
```

对丑陋没有评论（双关语），但有时这是一种可以接受的方式来保持标记正确排列，同时仍然正确显示。

离题但重要：在跨度上使用 inline-block 时，打开 box-sizing (-moz-box-sizing: border-box; etc) 通常非常有用，它可以从元素内部测量边框和填充. 这是在行内块跨度中使用百分比的唯一实用方法，并且可以省去许多相关的麻烦。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T09:17:41.067

> 我不认为有办法允许标记中的多行跨度而不让它们呈现空间？

不完全是，但是：

```
<span>...</span
><span>...</span> 
```

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2010-10-12T18:49:56.390

Ryan Mitchell 的解决方案对我来说效果很好。我最终得到了这样的结果：

```
.container { word-spacing: -1em; }
.container * { word-spacing: normal; } 
```

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-04-02T14:54:25.980

不爱这个bug。您可能需要考虑的是将容器元素上的字间距设置为 -1em。我自己刚刚遇到了这个错误，所以我不确定它是否实用，但它会隐藏那个空间。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2011-02-20T01:18:34.540

修复 FF2.0 FireFox 2.0 的修复有点棘手，您无法在不影响新版本浏览器的情况下应用标准浏览器 hack 来定位 FireFox 2。你可以走 JS 路线，但这些类型的浏览器定位似乎很啰嗦，而且有点古怪。解决此问题的最佳方法是为“display”属性使用“-moz-inline-stack”值。

由于 FireFox 2 不支持 inline-block，但它确实支持 Mozilla 特定的显示属性“-moz-inline-stack”，它的显示方式与 inline-block 一样。当我们在“display:inline-block”之前添加它时，FF2 会忽略“inline-block”声明并保留 -moz-inline-stack。支持 inline-block 的浏览器将使用它并忽略以前的显示属性。

这是一个例子：

.itemname { 显示：-moz-inline-stack; 显示：内联块；}

* * *

这个答案直接取自[http://www.soak.co.uk/blog/firefox-2-ie6-and-inline-block/](http://www.soak.co.uk/blog/firefox-2-ie6-and-inline-block/)

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-04-02T14:58:08.903

如果您正在呈现纯 XHTML（很可能您不是，即使设置 doctype 也不会，除非您将页面作为 XML，而不是 HTML 提供给用户），那么它将按您的预期显示。

然而，由于上面提到的 HTML / XHTML 差异，它将被呈现为单个空格。

# asp.net-mvc - 在 ASP.NET MVC 中将信息传递给用户控件

> ID：441282
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-13T23:17:45.677
> 
>         
> 
> 标签：asp.net-mvc, user-controls, viewdata

我知道如何将 viewdata 传递给像这样的用户控件

```
<% Html.RenderPartial("someUserControl.ascx", viewData); %> 
```

这就是我想要做的：

在当前情况下，我有事件日历，并且我的事件日历的每个部分都连接到用户控件，所以理想情况下，当我将日期值传递给我的用户控件时，我想获取该特定日期发生的所有事件（通过一些数据库活动）..所以实际控制器并没有真正来自..

有人可以给我一些想法，告诉我如何去做这件事，最好的方法是什么..  

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-13T23:22:00.647

这可能打破了 MVC 范式。虽然完全可以使用用户控件本身中的数据上下文动态获取数据，但要坚持 MVC 范例，建议您在控制器中执行 DB 活动并将其传递`ViewData`给页面和用户控件。

# namespaces - 你如何使用命名空间？

> ID：441289
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-13T23:21:44.250
> 
>         
> 
> 标签：namespaces

命名空间非常酷：使用它们，您可以组织您的库并避免名称冲突。

嗯，这就是意图，我想。我认为很多人并没有像应该使用的那样使用它……每天，我都会看到 95 个字符长的命名空间分散了代码并隐藏了真正重要的信息。

这是一个例子：

```
BigCorp.FrontOffice.MyApp.MySubDomain.Controllers.MyControllerXYZ xyzController = new 
    BigCorp.FrontOffice.MyApp.MySubDomain.Controllers.MyControllerXYZ( 
        BigCorp.FrontOffice.MyApp.MySubDomain.Const.MyValue1,
        BigCorp.FrontOffice.MyApp.MySubDomain.Const.MyValue2 ); 
```

你有这个意图吗？不，当然。它是：

MyControllerXYZ xyzController = new MyControllerXYZ(MyValue1, MyValue2);

没有命名空间非常简单，但使用...

那么，你如何使用命名空间呢？您对它们的最佳实践是什么？我们应该使用命名空间还是内部类？您的主项目使用了多少个命名空间？（目前，我正在使用 210 个接口（！）和更多的命名空间——无法维护！）

在此先感谢您的回答，

Sylvain。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-13T23:27:22.677

假设您正在谈论 C# 中的命名空间，除了显而易见的用法

```
using Namespace; 
```

你也可以有别名：

```
using ShortCut = Really.Complicated.Namespace.Its.Just.Terrible; 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-13T23:58:49.777

一个问题帖子中有很多问题！

1) 为什么使用命名空间？正如您在问题中所述，它们是代码的一种组织化方法。确实没有“一种方法”来组织代码，因此通常命名的对象不会给您带来问题。创建一个类库可能使用与另一个库完全不同的机制。

2）我应该如何使用命名空间？我更喜欢 Microsoft 如何对它们的命名空间进行分组（[参见 3.5 命名空间映射！](http://www.geekpedia.com/gallery/fullsize/net-framework-3.5-types-and-namespaces-poster.jpg)）。按功能、继承等分组！命名空间只是另一个要使用的组织工具。话虽这么说，我在少即是多方面犯了错误。正如你所说，命名空间可以隐藏代码，以及隐藏其他开发人员的功能代码（哪个命名空间有我需要的 gridrow 类？Grid 还是 Row？）。我尝试仅在需要时使用名称空间。叫我马虎，但到目前为止它对我有用！

总结：避免复杂。不要过度分类你的代码。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T00:01:46.057

从理论上考虑这一点（我自己很少使用命名空间），我不确定命名空间有多少帮助。为了保持代码的可读性，无论如何您都将尝试为您的函数和变量选择清晰的名称。除此之外，大多数语言都支持范围设置，以某种方式限制函数或变量的可见性。在大多数语言中，函数本身为其中的变量提供了一个自然的命名空间。

这是关于如何命名变量的一般问题。是一个声明

`int x;`

最好被视为一种易于验证的形式

`intx;`?

当程序员已经知道它是一个 int 时，写类似

`int myint;`

是重言式的。比这更糟糕的是，将变量声明为

`int x;` 

阻止你写作

`double x;` 

在下一行中，同时将它们保留为一个单词。除此之外，您必须记住在编码时 x 是 int 或 y 是 double。这就是人们写作的原因

`ByteArrayOutputStream myByteArrayOutputStream = new ByteArrayOutputStream(size);`,

以便他们确切地知道变量是什么。这最终变得非常重复。如果你无论如何都要把它叫做 myByteArrayOutputStream ，为什么语言的语法会强制你显式地进入这个类？

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-01-13T23:26:47.047

这取决于组织和代码的语言和广度。您是对的，在整个代码中散布一长串名称空间会使代码更难阅读。但它们确实有一个很好的目的：代码组织。您的语言是否使您能够为这些域起别名，或者只是通过“使用”或“导入”语句在文件开头包含一次名称？如果是这种情况，那么在代码主体中，您只需要它们冲突的名称空间。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T00:15:01.880

我们这里的人倾向于这样做。他们还倾向于继续使用“使用”子句来摆脱粗俗。愚蠢的部分是，这只是让他们回到他们开始的地方。

一般来说，我喜欢看到的是一层，在极少数情况下是两层命名空间。你应该做的是：每次你想坚持

> foo_

在一堆标识符的前面（或后面），而不是将它们全部放在命名空间“foo”中并用

> 富::

这样一来，无论如何你要放在那里的疣现在都有一些句法意义。更好的是，在“foo_”内容的内部代码中，您不再需要使用前导“foo”。可以理解，因为您已经在处理“foo”命名空间中的项目。这使得内部代码更容易阅读，客户端代码更容易理解。

# linq-to-sql - LinqToSQL 和异常“ExecuteReader 需要打开且可用的连接”。

> ID：441293
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-13T23:23:45.150
> 
>         
> 
> 标签：linq-to-sql, exception, executereader

我有一个名为 dbUsers 的 IQueryable 类型的集合

这些是从 linqtosql 数据库上下文中提取的，即

```
IQueryable<Data.LinqToSQL.User> dbUsers = DBContext.Users 
```

在此对象上调用 ToList：

```
IList<Data.LinqToSQL.User> users = dbUsers.ToList(); 
```

导致异常：

ExecuteReader 需要一个打开且可用的连接。连接的当前状态是正在连接。

我在这里做错了什么？

干杯

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-13T23:44:49.833

看看这是否适合你：

```
IList<Data.LinqToSQL.User> users = (from u in DBContext.Users select u).ToList(); 
```

如果不是，您可能需要执行以下操作：

```
DBContext context = new DBContext();
IList<Data.LinqToSQL.User> users = (from u in context.Users select u).ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-19T11:58:26.880

我认为这是 DataContext 的线程问题。我遇到了类似的问题。检查[此问题](https://stackoverflow.com/questions/650059/strange-behaviour-with-structuremap-asp-mvc-visual-studio-linqtosql#651424)以获取更多详细信息。

另外[阅读 this](http://www.west-wind.com/weblog/posts/246222.aspx)和[this](http://www.tigraine.at/2009/04/22/locking-with-linq-to-sqls-deferred-execution-in-an-iqueryablet-szenario/)。

# asp.net-mvc - 在返回 JSON 的 ASP.NET MVC 应用程序中每 5 次调用返回 401

> ID：441294
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-01-13T23:24:12.763
> 
>         
> 
> 标签：asp.net-mvc, json, extjs, http-status-code-401

这是疯了。

我有一个使用 Windows 身份验证的 ASP.NET MVC 应用程序，除其他外，它通过向它们返回 JSON 数据与许多 ExtJs Javascript 组件进行交互。

问题是，即使在用户成功通过身份验证后，从 MVC 获取一些 JSON 数据的每 5 个请求都会导致两个“401 Unauthorized”响应，然后是一个“200 OK”响应。再一次，这发生在每 5 次调用......为什么？我不知道。

有趣的是，每个响应都包含预期的 JSON！！！

是否有其他人经历过这种行为或对它发生的原因有任何想法？

谢谢-wg

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-03-10T15:30:31.807

这似乎是 Windows 身份验证的设计方式：

[如何停止来自 TFS 2008 的 401 响应](https://stackoverflow.com/questions/581090/how-do-i-stop-401-responses-from-tfs-2008/581275#581275)

我在 IIS 6 上运行但使用 Forms 身份验证的 ASP.NET MVC 应用程序时遇到了同样的问题。它让我发疯，直到我意识到我们的服务器设置为通过 NTLM 对每个请求进行身份验证，因为它是一个内部 Intranet 服务器。所以这真的不是问题，因为请求在 200 响应之后处理得很好，而且似乎根本没有拖慢加载时间。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T06:48:08.373

我曾经遇到过这种情况，就我而言，这是因为我让虚拟 Web 文件夹使用了两种不同的身份验证方法：Windows 身份验证和基本身份验证。

每隔一段时间，IIS 就会尝试使用 Windows 身份验证而不是我打算使用的基本 HTTP 身份验证来对用户进行身份验证（这种情况最常发生在 Internet Explorer 中）并返回“未经授权”响应。

尝试禁用您不使用的身份验证方法，看看会发生什么。

# svn - 复制 SVN 存储库

> ID：441297
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-01-13T23:25:07.393
> 
>         
> 
> 标签：svn, import, repository, export

我在托管的 SVN 服务上有一个 SVN 存储库，我需要将其转移到我们本地托管的 SVN 服务。主机提供了我使用过的导出功能。但是我如何获取导出的文件并将其导入新的存储库？

编辑

我尝试使用 svnadmin load，但收到错误消息：

```
% svnadmin load . < ~/ss2_14066_rev36
svnadmin: Malformed dumpfile header 
```

我导出的服务是[http://beanstalkapp.com](http://beanstalkapp.com)，他们[的导出帮助页面](http://help.beanstalkapp.com/kb/managing-repositories/can-i-export-my-repository)说这个导出的文件可以重新导入到另一个 svn 服务器。这可能是服务器版本不匹配吗？

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-01-13T23:30:25.527

如果导出是使用创建的，`svnadmin dump`您可以使用将其导入到新的空存储库中

```
# cd /path/to/new/repo
# svnadmin load . < /path/to/dumpfile 
```

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T23:55:14.243

如果您的托管服务提供商使用 Subversion 1.4 或更高版本，您还可以使用 svnsync 从存储库创建副本。

有关详细信息，请参阅[The Subversion Book 。](http://svnbook.red-bean.com/en/1.5/svn.ref.svnsync.c.copy-revprops.html)

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T14:35:17.697

它可能不是转储文件而是存储库本身的 tar.gz 吗？

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2011-09-20T13:39:04.987

这一点：

```
/path/to/dumpfile 
```

必须是（.dmp）文件的绝对路径，该文件可以流式传输回 svnadmin load 命令，而不仅仅是目录位置。

# asp.net - 当我在运行时实例化 ASP.NET 用户控件时，为什么它会忽略 ASCX 文件？

> ID：441299
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-13T23:25:36.130
> 
>         
> 
> 标签：asp.net, user-controls, render, ascx

我创建了一个常规的 ASP.NET 用户控件，包括 ascx 文件。例如：

```
MyUserControl.ascx
MyUserControl.ascx.cs 
```

然后我尝试在运行时使用类似于以下代码的代码手动呈现控件：

```
var testMyUserControl = new MyUserControl();
var textWriter = 
    new HtmlTextWriter(
        new System.IO.StringWriter(new StringBuilder()));
testMyUserControl.RenderControl(textWriter);
Console.Write(textWriter.InnerWriter.ToString()); 
```

我放入 ASCX 文件中的任何内容似乎都无法呈现 - 静态 HTML 或任何 .NET 控件。

但是，如果我在代码隐藏中覆盖 Render() 方法并手动输出内容，它会呈现。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-01-13T23:33:20.357

你不需要自己渲染你的控件。如果您需要将其动态添加到页面，您可以这样做：

```
UserControl myControl = (UserControl) Page.LoadControl("~/Controls/MyControl.ascx");
Page.Controls.Add(myControl); 
```

您很可能希望将其放置在页面的某个部分，因此不要使用 Page.Controls，而是使用占位符：

```
<asp:Placeholder ID="myPlaceHolder" runat="server" /> 
```

并使用这样的代码：

```
myPlaceholder.Controls.Add(myControl); 
```

*这是动态*添加控件的最佳方式，但如果您可以以声明方式进行，那将会容易得多。

```
<%@ Register TagPrefix="my" TagName="Control" Src="~/Controls/MyControl.ascx" %>

<my:Control ID="myControl" runat="server" /> 
```

请记住：如果您要动态添加控件，请务必[在每次页面加载时重新添加控件](https://stackoverflow.com/questions/440854)。

# sql - SQL语法问题

> ID：441302
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-13T23:25:58.953
> 
>         
> 
> 标签：sql, oracle

以下在 sql 语法中的含义是什么：

1.  (+) 在条件之后，例如：“WHERE table1.col1 = table2.col2 (+)

2.  /* */ 在 select 之后是什么意思，我依稀记得这是对优化器的建议，但是我在哪里可以找到更多关于此的参考，例如：select /* */ ...

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-01-13T23:26:49.467

1.  这`(+)`意味着 Oracle 上 SQL 的外连接语法。

2.  `/*`更改 SELECT 表示注释。在 Oracle 中，如果注释以`/*+`（注释标记后的加号开头，则表示提示，例如`/*+ORDERED*/`

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-13T23:31:11.970

如果我们在谈论 oracle，那么这`(+)`是一个外部连接并且`/* some stuff */`是一个评论。如果评论是形式，`/*+ hint* */`那么评论可能是一个提示。[google 上的 oracle 提示](http://www.google.co.uk/search?source=ig&hl=en&rlz=1G1GGLQ_ENUK243&q=oracle+hint&meta=lr%3D)

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T00:00:52.597

顺便说一句，很多商业智能在 SQL 查询中是隐秘的——而且大多数查询，只要可以，根本没有注释！

这是一个耻辱:o)

每次查询不明显时，都应在查询中添加 /* */ 注释。也就是说，大多数时候...

A+西尔万。

# windows - 有没有办法在 Windows XP 上立即删除文件？

> ID：441304
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-13T23:26:39.217
> 
>         
> 
> 标签：windows

在我的 Mac 和任何其他 Unix 机器上，当我通过几种可用方法中的任何一种（`rm`在命令行上，拖动到垃圾箱，按删除键）删除文件时，通常会立即发生。如果文件很大，有时需要几秒钟。

在 Windows 上，当我尝试删除某些内容时，会出现一个带有进度条的对话框。在我的机器上，在某些情况下，删除可能需要 10 到 20 秒甚至更长时间。

有没有办法在 Windows XP 上执行删除操作而无需等待？

另外，有没有办法不必点击那些“你确定……”对话框？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-13T23:30:13.140

你试过命令行吗？

```
del /q filename 
```

或者，您还可以安装 MinGW 或 Cygwin 以在 Windows 中获得与 Linux/Unix 中相同的可用命令。

请注意，如果您**在回收站中保留许多文件，文件删除可能会很****慢**。清空垃圾箱将解决问题。

 **您可以通过更改回收站的配置**永久绕过回收站。**您还可以配置 Windows XP 以**跳过确认消息**。有关详细信息，请查看 Microsoft 的知识库：

> [如何：在 Windows XP 中删除文件和文件夹时绕过回收站](http://support.microsoft.com/kb/320031)

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-01-13T23:53:27.947

你试过shift + DEL吗？

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-01-13T23:55:03.263

很多时候，使用垃圾桶会增加删除时间。在这些情况下，直接删除（Shift - Delete）将以不可恢复为代价加快删除速度（这是正确的英语吗？）

缓慢删除的另一个常见原因是 Windows 不会删除打开的文件。万一一个进程正在退出并且有一个打开的文件，默认的资源管理器行为是等待几秒钟（我相信它是 3 秒）并重试文件上的删除操作。这种行为克服了令人讨厌的事实，即有时打开文件进行预览的是同一个资源管理器。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-01-13T23:32:10.220

我已经使用免费软件 Fastcopy 来实现这一点。查看：
 [http ://www.themisteriosos.com/delete-large-files-faster.htm](http://www.themisteriosos.com/delete-large-files-faster.htm)

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-01-13T23:59:30.740

您可以右键单击垃圾桶并关闭“您确定”的唠叨。您还可以选择先在垃圾桶处不停止删除。

# c++ - 使 shared_ptr 不使用删除

> ID：441306
> 
>         
> 
> 赞同：41
> 
>         
> 
> 时间：2009-01-13T23:26:47.530
> 
>         
> 
> 标签：c++, boost

在我的代码中，我希望 boost::shared_ptr 不调用 delete 而是调用 ptr->deleteMe() 。

我也有一些返回 ptr 的 C 风格的函数。我可以叫它 lib_freeXYZ(ptr); 而不是试图删除？

* * *

## 回答 #1

> 赞同：56
> 
>             
> 
> 时间：2009-01-14T03:24:17.270

或者如何使用 stl 提供包装函子 - Doug T. 描述但没有自定义调用者。

```
boost::shared_ptr<T> ptr( new T, std::mem_fun_ref(&T::deleteMe) );
boost::shared_ptr<S> ptr( new S, std::ptr_fun(lib_freeXYZ) ); 
```

* * *

## 回答 #2

> 赞同：37
> 
>             
> 
> 时间：2009-01-13T23:30:18.850

您可以为 shared_ptr 模板提供一个具有签名的自定义删除函数

```
 void Deleter( T* ptr); 
```

为了提升::shared_ptr

所以对于 Deleter 你会做

```
 boost::shared_ptr<T> ptrToT( new T, Deleter ); 
```

然后在 Deleter 的正文中：

```
 void Deleter( T* ptr);
   {
        ptr->deleteMe();
        // And make sure YOU ACTUALLY DELETE (or do whatever else you need to
        // do to release the resource)
        delete ptr;
   } 
```

对于您需要简单的东西（如 ptr->deleteMe）的特定情况，请参阅 Greg 的解决方案，它非常好。

* * *

## 回答 #3

> 赞同：10
> 
>             
> 
> 时间：2009-01-14T00:21:51.570

*Doug T.*很好地回答了你的问题。我会告诉你有关 intrusive_ptr 的信息。也许你也可以在你的项目中使用它。

如果你有一些 C 库已经有引用计数，但你必须手动调用这些函数，你也可以使用`boost::intrusive_ptr`，并为其 add_ref 和 release 函数提供适当的定义。intrusive_ptr 会找到并调用它们。他们负责增加和减少引用计数，在需要时释放资源：

```
void intrusive_ptr_add_ref(foo *f) {
    lib_add_ref(f);
}

void intrusive_ptr_release(foo *f) {
    if(lib_dec_ref(f) == 0) 
        lib_free(f);
} 
```

然后，您可以从 type 的原始指针创建对象`foo*`。[intrusive_ptr](http://www.boost.org/doc/libs/1_37_0/libs/smart_ptr/intrusive_ptr.html)将在复制/破坏时调用您的函数：

```
intrusive_ptr<foo> f(lib_alloc());

// can wrap raw pointers too, which already may be referenced somewhere else
foo *p = get_foo_from_somewhere();
function_taking_intrusive_ptr(p); 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-01-13T23:31:52.607

对于 C 风格的数据，像 @Doug 一样做。T建议。

对于您的班级，为什么不在析构函数中进行清理？即使这在析构函数中包含 deleteMe()。

# c# - 为什么可变结构是“邪恶的”？

> ID：441309
> 
>         
> 
> 赞同：533
> 
>         
> 
> 时间：2009-01-13T23:27:47.780
> 
>         
> 
> 标签：c#, struct, immutability, mutable

在关于 SO 的讨论之后，我已经多次阅读了可变结构是“邪恶”的评论（就像在这个[问题](https://stackoverflow.com/questions/292676/is-there-a-workaround-for-overloading-the-assignment-operator-in-c)的答案中一样）。

C# 中的可变性和结构的实际问题是什么？

* * *

## 回答 #1

> 赞同：310
> 
>             
> 
> 时间：2009-01-13T23:42:58.573

结构是值类型，这意味着它们在传递时会被复制。

因此，如果您更改副本，您只会更改该副本，而不是原始副本，也不会更改可能存在的任何其他副本。

如果您的结构是不可变的，那么所有由值传递产生的自动副本将是相同的。

如果你想改变它，你必须有意识地通过使用修改后的数据创建一个新的结构实例来做到这一点。（不是副本）

* * *

## 回答 #2

> 赞同：177
> 
>             
> 
> 时间：2009-01-13T23:31:02.467

从哪里开始;-p

[Eric Lippert 的博客](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/mutating-readonly-structs)总是很适合引用：

> 这是可变值类型邪恶的另一个原因。尝试始终使值类型不可变。

首先，您往往很容易丢失更改...例如，从列表中取出内容：

```
Foo foo = list[0];
foo.Name = "abc"; 
```

那改变了什么？没什么用...

与属性相同：

```
myObj.SomeProperty.Size = 22; // the compiler spots this one 
```

强迫你做：

```
Bar bar = myObj.SomeProperty;
bar.Size = 22;
myObj.SomeProperty = bar; 
```

不太重要的是，存在尺寸问题；可变对象**往往**具有多个属性；然而，如果你有一个带有两个`int`s、a `string`、a`DateTime`和 a 的结构`bool`，你可以很快消耗大量内存。使用一个类，多个调用者可以共享对同一个实例的引用（引用很小）。

* * *

## 回答 #3

> 赞同：76
> 
>             
> 
> 时间：2009-01-13T23:34:40.277

我不会说*邪恶*，但可变性通常是程序员过度渴望提供最大功能的标志。实际上，这通常是不需要的，这反过来又使界面更小、更容易使用和更难错误使用（= 更健壮）。

其中一个例子是竞态条件下的读/写和写/写冲突。这些根本不可能出现在不可变结构中，因为写入不是有效的操作。

[此外，我声称**实际上几乎不需要可变性**](https://stackoverflow.com/questions/406760/whats-your-most-controversial-programming-opinion/407007#407007)，程序员只是*认为*它*可能*在未来出现。例如，更改日期根本没有意义。相反，根据旧日期创建一个新日期。这是一个廉价的操作，所以性能不是考虑因素。

* * *

## 回答 #4

> 赞同：56
> 
>             
> 
> 时间：2013-06-04T08:10:46.807

可变结构并不邪恶。

它们在高性能环境中是绝对必要的。例如，当缓存行和/或垃圾收集成为瓶颈时。

我不会将在这些完全有效的用例中使用不可变结构称为“邪恶”。

我可以看到，C# 的语法无助于区分值类型或引用类型的成员的访问，所以我完全*赞成*不可变结构，它强制不可变，而不是可变结构。

然而，与其简单地将不可变结构标记为“邪恶”，我建议接受这种语言并提倡更有帮助和建设性的经验法则。

例如：*“结构是值类型，默认复制。如果您不想复制它们，则需要参考”*或
*“首先尝试使用只读结构”*。

* * *

## 回答 #5

> 赞同：46
> 
>             
> 
> 时间：2011-09-29T03:28:55.557

**具有公共可变字段或属性的结构并不邪恶。**

改变“this”的结构方法（与属性设置器不同）有些邪恶，只是因为.net 没有提供一种将它们与没有的方法区分开来的方法。不改变“this”的结构方法即使在只读结构上也应该是可调用的，不需要防御性复制。改变“this”的方法根本不应该在只读结构上调用。由于 .net 不想禁止不修改“this”的结构方法在只读结构上被调用，但又不想允许只读结构发生突变，它防御性地复制只读结构中的结构。只有上下文，可以说是两全其美。

然而，尽管在只读上下文中处理自变异方法存在问题，但可变结构通常提供远优于可变类类型的语义。考虑以下三个方法签名：

```
结构 PointyStruct {public int x,y,z;};
类 PointyClass {public int x,y,z;};

无效方法1（PointyStruct foo）；
void Method2(ref PointyStruct foo);
void Method3(PointyClass foo);

```

对于每种方法，请回答以下问题：

1.  假设该方法不使用任何“不安全”代码，它可能会修改 foo 吗？

2.  如果在调用方法之前不存在对“foo”的外部引用，那么之后是否存在外部引用？

[答案：]

> 问题 1：：
> 
>    `Method1()`否*（明确意图）*
> 
>    `Method2()`：是*（明确意图）*
> 
>    `Method3()`：是*（不确定意图）*
> 
>  问题 2：：
> 
>    `Method1()`否
> 
>    `Method2()`：否*（除非不安全）*
> 
>    `Method3()`：是

Method1 无法修改 foo，并且永远不会获得引用。Method2 获取对 foo 的短期引用，它可以使用它以任何顺序修改 foo 的字段任意次数，直到它返回，但它不能持久化该引用。在 Method2 返回之前，除非它使用了不安全的代码，否则任何和所有可能由其 'foo' 引用制作的副本都将消失。Method3 与 Method2 不同，它获得对 foo 的混杂可共享的引用，并且不知道它可以用它做什么。它可能根本不会改变 foo，它可能会改变 foo 然后返回，或者它可能会将 foo 的引用提供给另一个线程，这可能会在未来的某个任意时间以某种任意方式对其进行变异。

结构数组提供了美妙的语义。给定 Rectangle 类型的 RectArray[500]，如何将元素 123 复制到元素 456，然后在一段时间后将元素 123 的宽度设置为 555，而不干扰元素 456，就很清楚了。“RectArray[432] = RectArray[321 ]; ...; RectArray[123].Width = 555;". 知道 Rectangle 是一个带有一个名为 Width 的整数字段的结构体，这将告诉人们所有需要了解的上述语句。

现在假设 RectClass 是一个与 Rectangle 具有相同字段的类，并且想要对 RectClass 类型的 RectClassArray[500] 执行相同的操作。也许该数组应该包含 500 个对可变 RectClass 对象的预初始化不可变引用。在这种情况下，正确的代码将类似于“RectClassArray[321].SetBounds(RectClassArray[456]); ...; RectClassArray[321].X = 555;”。也许该数组被假定包含不会更改的实例，因此正确的代码更像是“RectClassArray[321] = RectClassArray[456]; ...; RectClassArray[321] = New RectClass(RectClassArray[321] ]); RectClassArray[321].X = 555;" 要知道一个人应该做什么，就必须对 RectClass 有更多的了解（例如，它是否支持复制构造函数、复制源方法等？) 和数组的预期用途。远没有使用结构那么干净。

可以肯定的是，不幸的是，除了数组之外的任何容器类都没有很好的方法来提供结构数组的清晰语义。最好的办法是，如果想要用例如字符串对集合进行索引，可能会提供一个通用的“ActOnItem”方法，该方法将接受一个字符串作为索引、一个通用参数和一个将被传递的委托通过引用通用参数和集合项。这将允许与结构数组几乎相同的语义，但除非 vb.net 和 C# 人员能够提供良好的语法，否则即使性能合理（传递泛型参数会允许使用静态委托，并避免任何需要创建任何临时类实例）。

就个人而言，我对 Eric Lippert 等人的仇恨感到恼火。spew 关于可变值类型。与到处使用的混杂引用类型相比，它们提供了更清晰的语义。尽管 .net 对值类型的支持存在一些限制，但在许多情况下，可变值类型比任何其他类型的实体更适合。

* * *

## 回答 #6

> 赞同：26
> 
>             
> 
> 时间：2011-07-14T10:26:04.653

从程序员的角度来看，还有一些其他极端情况可能会导致不可预测的行为。

# 不可变值类型和只读字段

```
 // Simple mutable structure. 
    // Method IncrementI mutates current state.
    struct Mutable
    {
        public Mutable(int i) : this() 
        {
            I = i;
        }

        public void IncrementI() { I++; }

        public int I { get; private set; }
    }

    // Simple class that contains Mutable structure
    // as readonly field
    class SomeClass 
    {
        public readonly Mutable mutable = new Mutable(5);
    }

    // Simple class that contains Mutable structure
    // as ordinary (non-readonly) field
    class AnotherClass 
    {
        public Mutable mutable = new Mutable(5);
    }

    class Program
    {
        void Main()
        {
            // Case 1\. Mutable readonly field
            var someClass = new SomeClass();
            someClass.mutable.IncrementI();
            // still 5, not 6, because SomeClass.mutable field is readonly
            // and compiler creates temporary copy every time when you trying to
            // access this field
            Console.WriteLine(someClass.mutable.I);

            // Case 2\. Mutable ordinary field
            var anotherClass = new AnotherClass();
            anotherClass.mutable.IncrementI();

            // Prints 6, because AnotherClass.mutable field is not readonly
            Console.WriteLine(anotherClass.mutable.I);
        }
    } 
```

# 可变值类型和数组

假设我们有一个`Mutable`结构数组，并且我们正在调用该`IncrementI`数组的第一个元素的方法。您期望从这个电话中获得什么行为？它应该改变数组的值还是只改变一个副本？

```
 Mutable[] arrayOfMutables = new Mutable[1];
    arrayOfMutables[0] = new Mutable(5);

    // Now we actually accessing reference to the first element
    // without making any additional copy
    arrayOfMutables[0].IncrementI();

    // Prints 6!!
    Console.WriteLine(arrayOfMutables[0].I);

    // Every array implements IList<T> interface
    IList<Mutable> listOfMutables = arrayOfMutables;

    // But accessing values through this interface lead
    // to different behavior: IList indexer returns a copy
    // instead of an managed reference
    listOfMutables[0].IncrementI(); // Should change I to 7

    // Nope! we still have 6, because previous line of code
    // mutate a copy instead of a list value
    Console.WriteLine(listOfMutables[0].I); 
```

因此，只要您和团队的其他成员清楚地了解您在做什么，可变结构就不是邪恶的。但是当程序行为与预期不同时，有太多的极端情况，这可能导致难以产生和难以理解的细微错误。

* * *

## 回答 #7

> 赞同：23
> 
>             
> 
> 时间：2009-01-13T23:52:30.163

值类型基本上代表了不可变的概念。Fx，拥有一个整数、向量等数学值然后能够对其进行修改是没有意义的。这就像重新定义一个值的含义。与其更改值类型，不如分配另一个唯一值更有意义。考虑一下通过比较其属性的所有值来比较值类型的事实。关键是，如果属性相同，那么它就是该值的相同通用表示。

正如 Konrad 提到的那样，更改日期也没有意义，因为该值表示唯一的时间点，而不是具有任何状态或上下文相关性的时间对象的实例。

希望这对你有意义。可以肯定的是，它更多的是关于你试图用值类型捕捉的概念，而不是实际的细节。

* * *

## 回答 #8

> 赞同：18
> 
>             
> 
> 时间：2013-10-18T11:22:12.110

如果您曾经使用 C/C++ 之类的语言进行过编程，那么结构体可以用作可变结构。只需将它们与 ref 一起传递，就不会出错。我发现的唯一问题是 C# 编译器的限制，在某些情况下，我无法强迫愚蠢的东西使用对结构的引用，而不是复制（比如当结构是 C# 类的一部分时）。

因此，可变结构并不邪恶，C#*使*它们变得邪恶。我一直在 C++ 中使用可变结构，它们非常方便和直观。相比之下，C# 让我完全放弃将结构作为类的成员，因为它们处理对象的方式。他们的便利使我们付出了代价。

* * *

## 回答 #9

> 赞同：14
> 
>             
> 
> 时间：2015-12-02T15:29:37.410

如果您坚持结构的用途（在 C#、Visual Basic 6、Pascal/Delphi、C++ 结构类型（或类）中，当它们不用作指针时），您会发现结构只不过是一个*复合变量*. 这意味着：您将它们视为一组打包的变量，在一个通用名称下（您引用成员的记录变量）。

我知道这会让很多深深习惯于 OOP 的人感到困惑，但如果使用得当，这还不足以说明这些事情本质上是邪恶的。一些结构按照它们的意图是不可变的（这是 Python 的情况`namedtuple`），但它是另一种需要考虑的范式。

是的：结构涉及大量内存，但通过执行以下操作不会精确地增加内存：

```
point.x = point.x + 1 
```

相比：

```
point = Point(point.x + 1, point.y) 
```

在不可变的情况下，内存消耗将至少相同，甚至更多（尽管对于当前堆栈而言，这种情况是暂时的，具体取决于语言）。

但是，最后，结构是*结构*，而不是对象。在 POO 中，对象的主要属性是它们的*身份*，大多数时候不超过其内存地址。struct 代表数据结构（不是一个适当的对象，因此它们无论如何都没有身份），并且可以修改数据。在其他语言中，*记录*（而不是*struct*，就像 Pascal 的情况一样）是这个词并且具有相同的目的：只是一个数据记录变量，旨在从文件中读取、修改并转储到文件中（这是主要的使用，并且在许多语言中，您甚至可以在记录中定义数据对齐，而正确调用的对象不一定是这种情况）。

想要一个好例子吗？结构用于轻松读取文件。Python 有[这个库](https://docs.python.org/2/library/struct.html)，因为它是面向对象的并且不支持结构，它必须以另一种方式实现它，这有点难看。实现结构的语言具有该功能......内置。尝试用 Pascal 或 C 等语言读取具有适当结构的位图标头。这会很容易（如果结构正确构建和对齐；在 Pascal 中，您不会使用基于记录的访问，而是使用函数来读取任意二进制数据）。因此，对于文件和直接（本地）内存访问，结构比对象更好。至于今天，我们已经习惯了 JSON 和 XML，因此我们忘记了二进制文件的使用（以及作为副作用，结构的使用）。但是，是的：它们存在，并且有目的。

他们不是邪恶的。只需将它们用于正确的目的。

如果你用锤子来思考，你会想把螺丝当钉子，发现螺丝更难插进墙里，那就是螺丝的错，是恶的。

* * *

## 回答 #10

> 赞同：12
> 
>             
> 
> 时间：2010-03-21T22:37:02.790

想象一下，您有一个包含 1,000,000 个结构的数组。每个结构体都代表一个包含bid_price、offer_price（可能是小数）等内容的股权，这是由C#/VB 创建的。

想象一下，该数组是在非托管堆中分配的一块内存中创建的，以便其他一些本机代码线程能够同时访问该数组（可能是一些执行数学运算的高性能代码）。

想象一下，C#/VB 代码正在监听价格变化的市场反馈，该代码可能必须访问数组的某些元素（无论是哪种证券），然后修改某些价格字段。

想象一下，每秒执行数万甚至数十万次。

好吧，让我们面对事实，在这种情况下，我们确实希望这些结构是可变的，它们必须是可变的，因为它们被其他一些本机代码共享，因此创建副本无济于事；他们需要这样做，因为以这些速率复制大约 120 字节的结构是疯狂的，尤其是当更新实际上可能只影响一两个字节时。

雨果

* * *

## 回答 #11

> 赞同：10
> 
>             
> 
> 时间：2013-10-02T13:52:23.493

当某些东西可以变异时，它就会获得一种认同感。

```
struct Person {
    public string name; // mutable
    public Point position = new Point(0, 0); // mutable

    public Person(string name, Point position) { ... }
}

Person eric = new Person("Eric Lippert", new Point(4, 2)); 
```

因为`Person`是可变的，所以想*改变 Eric 的位置*比克隆*Eric、移动克隆体、破坏原来的*. 这两种操作都可以成功地改变 的内容`eric.position`，但一种比另一种更直观。同样，传递 Eric（作为参考）以获取修改他的方法更直观。给一个方法一个 Eric 的克隆几乎总是令人惊讶。任何想要变异的人都`Person`必须记得要求参考，`Person`否则他们会做错事。

如果你使类型不可变，问题就消失了；如果我不能修改`eric`，无论我收到`eric`还是克隆`eric`. 更一般地说，如果一个类型的所有可观察状态都保存在以下成员中，则该类型可以安全地按值传递：

*   不可变

*   引用类型

*   按值安全传递

如果满足这些条件，那么可变值类型的行为类似于引用类型，因为浅拷贝仍然允许接收者修改原始数据。

不可变的直观性`Person`取决于您尝试做什么。如果`Person`只是代表一*组*关于一个人的数据，那并没有什么不直观的；`Person`变量真正代表抽象*值*，而不是对象。（在这种情况下，将其重命名为 可能更合适`PersonData`。）如果`Person`实际上是对一个人本身进行建模，即使您避免了认为自己正在修改的陷阱，不断创建和移动克隆的想法也是愚蠢的原本的。`Person`在这种情况下，简单地创建一个引用类型（即一个类）可能会更自然。

诚然，正如函数式编程告诉我们的那样，使*一切*不可变是有好处的（没有人可以偷偷地持有对他的引用`eric`并改变他），但是由于这在 OOP 中不是惯用的，因此对于其他任何与您合作的人来说仍然是不直观的代码。

* * *

## 回答 #12

> 赞同：6
> 
>             
> 
> 时间：2009-01-13T23:34:17.610

它与结构无关（也与 C# 无关），但在 Java 中，当可变对象是哈希映射中的键时，您可能会遇到可变对象的问题。如果您在将它们添加到地图后更改它们并更改其[哈希码](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html#hashCode())，则可能会发生邪恶的事情。

* * *

## 回答 #13

> 赞同：6
> 
>             
> 
> 时间：2009-01-13T23:45:53.827

可变数据有很多优点和缺点。百万美元的劣势是混叠。如果在多个地方使用相同的值，并且其中一个更改了它，那么它似乎已经神奇地更改为正在使用它的其他地方。这与竞态条件有关，但并不完全相同。

有时，百万美元的优势是模块化。可变状态可以让您从不需要知道的代码中隐藏变化的信息。

[The Art of the Interpreter](http://dspace.mit.edu/handle/1721.1/6094)详细介绍了这些权衡，并给出了一些例子。

* * *

## 回答 #14

> 赞同：6
> 
>             
> 
> 时间：2011-02-07T17:31:08.410

就我个人而言，当我查看代码时，以下代码对我来说看起来很笨拙：

data.value.set (data.value.get () + 1) ;

而不是简单的

数据.值++；或 data.value = data.value + 1 ；

当传递一个类并且您希望确保以受控方式修改值时，数据封装很有用。然而，当你有公共的 set 和 get 函数只是将值设置为传入的值时，与简单地传递公共数据结构相比，这有什么改进？

当我在类中创建私有结构时，我创建了该结构以将一组变量组织到一个组中。我希望能够在类范围内修改该结构，而不是获取该结构的副本并创建新实例。

对我来说，这阻止了有效使用用于组织公共变量的结构，如果我想要访问控制，我会使用一个类。

* * *

## 回答 #15

> 赞同：6
> 
>             
> 
> 时间：2015-05-12T18:02:54.160

Eric Lippert 先生的例子有几个问题。它旨在说明复制结构的要点以及如果您不小心，这可能会成为问题。看这个例子，我认为它是由于不良的编程习惯造成的，而不是结构或类的问题。

1.  结构应该只有公共成员，不需要任何封装。如果是这样，那么它真的应该是一个类型/类。你真的不需要两个结构来说同样的事情。

2.  如果你有一个包含结构的类，你会调用类中的一个方法来改变成员结构。这就是我会做的一个好的编程习惯。

正确的实现如下。

```
struct Mutable {
public int x;
}

class Test {
    private Mutable m = new Mutable();
    public int mutate()
    { 
        m.x = m.x + 1;
        return m.x;
    }
  }
  static void Main(string[] args) {
        Test t = new Test();
        System.Console.WriteLine(t.mutate());
        System.Console.WriteLine(t.mutate());
        System.Console.WriteLine(t.mutate());
    } 
```

看起来这是编程习惯的问题，而不是结构本身的问题。结构应该是可变的，这就是想法和意图。

更改的结果瞧，表现如预期：

1 2 3 按任意键继续。. .

* * *

## 回答 #16

> 赞同：1
> 
>             
> 
> 时间：2013-12-19T12:25:48.977

如果使用得当，我不相信它们是邪恶的。我不会将它放在我的生产代码中，但我会使用结构化单元测试模拟之类的东西，其中结构的生命周期相对较小。

使用 Eric 示例，也许您想创建该 Eric 的第二个实例，但要进行调整，因为这是您的测试的本质（即复制，然后修改）。如果我们只是将 Eric2 用于测试脚本的其余部分，那么 Eric 的第一个实例会发生什么并不重要，除非您打算将他用作测试比较。

这对于测试或修改浅层定义特定对象（结构点）的遗留代码非常有用，但是通过具有不可变结构，这可以防止它令人讨厌地使用。

# url-rewriting - 使用重写 URL 的 URL 是否仍可被搜索引擎搜索？

> ID：441340
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-13T23:36:17.090
> 
>         
> 
> 标签：url-rewriting

我的开发人员做了以下事情：

如果有人键入 public.sample.com/user/chumbawumba，它会重定向到 stage.sample.com/profile.php?username=chumbawumba

我想确保配置文件的内容（例如包含公司信息）可在 public.sample.com 域名上搜索。

他使用了重写规则。

我想我并没有预料到这种方法，但只要页面可以随着更多信息的输入而被爬取并排名，我就很喜欢它。

我试图在该网站上运行一个在线站点地图，但我认为它没有提出任何问题，因此我提出了问题。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-13T23:55:11.547

您可以访问 google 并输入“site: public.sample.com”以查看您网站上使用 google 搜索的所有页面。另请参阅[Google 网站管理员工具](https://www.google.com/webmasters/tools/)。

请告诉规则是重定向还是重写请求？那么您能否在浏览器中看到“stage.sample.com/profile.php?username=chumbawumba”或“public.sample.com/user/chumbawumba”。

如果您看到的只是“public.sample.com/user/chumbawumba” - 没关系。如果不是 - 搜索机器人也会看到相同的结果。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T00:57:40.513

无论如何，网址带有“？” 被谷歌索引。查看[带有查询的 URL 的常见问题解答](http://www.google.com/support/webmasters/bin/answer.py?answer=76329)。

搜索“个人资料测试”，您将看到带有“？”的结果 内部网址。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-13T23:41:53.680

这种技术是 SEO 人员/公司常用的技术，因为这样搜索引擎就不会发送 ?... 并且许多搜索引擎会忽略，所以是的。

# iphone - Does UIActivityIndicator require manual threading on iPhone

> ID：441345
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-01-13T23:37:44.280
> 
>         
> 
> 标签：iphone, cocoa-touch, multithreading

I am running creating an iPhone application which performs a costly operation and I wanted to create an activityIndicator to let the user know the application has not frozen.

The operation is performed entirely in one event call... so there is no chance for the UI framework to receive control to actually display and animate this indicator.

The sample apps which use the UIActivityIndicator (or any other similar animation) start and stop the animation in different events, triggered separately at different stages of the program.

Do I need to manually create a separate thread to run my operation in, or is there already default support for this kind of behavior?

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2009-01-14T00:36:30.230

I just found someone asking a very similar question with a good answer on the apple iPhone forums.
[https://devforums.apple.com/message/24220#24220](https://devforums.apple.com/message/24220#24220) #Note: you have to have an appleID to view it.

Essentially, yes, you do need to start your process running in a different thread, but its quite easy to do (as paraphrased from user 'eskimo1')

```
- (IBAction)syncOnThreadAction:(id)sender
{
    [self willStartJob];

    id myObject = [MyObjectClass createNewObject];
    [self performSelectorInBackground:
        @selector(inThreadStartDoJob:)
        withObject:myObject
    ];
}

- (void)inThreadStartDoJob:(id)theJobToDo
{
    NSAutoreleasePool * pool;
    NSString *          status;

    pool = [[NSAutoreleasePool alloc] init];
    assert(pool != nil);

    status = [theJobToDo countGrainsOfSandOnBeach];

    [self performSelectorOnMainThread:
        @selector(didStopJobWithStatus:)
        withObject:status
        waitUntilDone:NO
    ];

    [pool drain];
} 
```

where `-willStartJob` and `-didStopJobWithStatus` are my own methods that:

*   disable the UI, to prevent the user from kicking off two jobs at once

*   set up the activity indicator

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2009-01-14T00:35:44.023

Yes, you need to put your operation in a separate thread while the UIActivityIndicatorView calls remain on the main thread.

Here's why: If you start animating your indicator view then immediately begin your process, your process will block until finished, and the user will never see any "activity."

Instead, start animating the indicator, then pop a new thread for your process. Use notifications, a delegate pattern, or `performSelectorOnMainThread:withObject:waitUntilDone:` to let the main thread know that the process is finished. Then stop the animation and continue.

This will ensure that the user knows something is happening while your process does its thing.

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2010-05-06T11:45:06.320

Starting a new thread can be overkilling and a source of complexity if you want to do things that are supposed to start on the main thread.

In my own code, I need to start a MailComposer by pushing a button but it can take some time to appear and I want to make sure the UIActivityIndicator is spinning meanwhile.

This is what I do :

```
-(void)submit_Clicked:(id)event
{
    [self.spinner startAnimating];
    [self performSelector:@selector(displayComposerSheet) 
               withObject:nil afterDelay:0];    
} 
```

It will queue displayComposerSheet instead of executing it straight away. Enough for the spinner to start animating !

* * *

## 回答 #4

> 赞同：-1
> 
>             
> 
> 时间：2009-01-14T00:17:31.500

An UIProgressView (the progress bar) can not run by itself, you need to periodically increment its value.

An UIActivityIndicatorView (the spinning gear) can run by itself: just call **startAnimating** when you start your operation and **stopAnimating** when you're done.

So an UIActivityIndicatorView may be what you're looking for.

* * *

## 回答 #5

> 赞同：-1
> 
>             
> 
> 时间：2010-09-16T02:48:03.523

Which is easier:

```
1> Have 1 method that starts the spinner (in the background).
2> Run your long-running code right here.
3> Have 1 method that ends the spinner. 
```

or....

```
A> Have 1 method that starts the spinner.
B> Have 20 methods (1 for each thing you want to do in the background)
C> Have 1 method that ends the spinner. 
```

I always see everyone suggest A,B,C... the hard way.

# asp.net - “此页面包含安全和非安全项目”主题和 SSL

> ID：441348
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-13T23:39:06.743
> 
>         
> 
> 标签：asp.net, ssl, https, themes

所以我有这个网站，可以通过 SSL 连接访问（“ [https://mystupidwebsite/etc](https://mystupidwebsite/etc) ...”）

我将主题与单个 css 文件结合使用。但是，当页面呈现时，标题中的 CSS 链接标记仍然具有[http://mystupidwebsite/etc](http://mystupidwebsite/etc) ... 完整路径。

如何使用 https 或使用相对路径正确地注册 css 文件？

谢谢，

内特

编辑：哦！我刚刚发现了我的问题。主题正确地添加了具有相对路径的 css。母版页中有一个链接标记，它使用相同 css 的绝对路径。很抱歉浪费您的时间！

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-13T23:40:46.317

使用相对路径

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-13T23:50:25.783

只需链接到`/path/to/style.css`而不是完整的`http://example.com/path/to/style.css`. 这假设您为 HTTPS 和 HTTP 请求提供了相同的内容。如果没有，您将需要创建别名或符号链接或其他东西。

# asp.net - 使用 SQL Server 寻找示例 Delphi Prism ASP.Net 应用程序

> ID：441350
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-13T23:39:46.210
> 
>         
> 
> 标签：asp.net, sql-server, web-applications, oxygene

我是 ASP.NET 处女，想尝试在后端使用 SQL Server 创建 ASP.Net 应用程序。

我找不到用于执行此操作的单个示例应用程序或代码。有人有任何指示吗？

TIA

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-13T23:46:33.450

Delphi Prism 只是一种语言，连接到 SQL 数据库的方式与 C# 完全相同。我会寻找一个这样做的 C# 示例并将语法转换为 Delphi（很容易做到）。如果您打算使用 Delphi Prism，您将花费大量时间将 C# 语法示例转换为 Delphi，因此您应该进行一些练习。

# sharepoint - TFS 安全性：TFS 组可以访问 Reporting Services 和 Sharepoint？

> ID：441352
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-13T23:41:05.037
> 
>         
> 
> 标签：sharepoint, reporting-services

MSDN 上有关于将开发人员添加到 TFS 的“操作方法”。
[http://msdn.microsoft.com/en-us/library/bb668968.aspx](http://msdn.microsoft.com/en-us/library/bb668968.aspx)

它有 3 个主要部分： 第 1 步 - 授予对团队项目的访问权限 第 2 步 - 授予对 SharePoint 项目站点的访问权限 第 3 步 - 授予对 SQL Server Reporting Services 的访问权限

很公平，它适用于个人开发人员。

现在，如果我通过在 TFS 中的项目/服务器级别创建组来管理我的开发人员，即在我的 Project1 中，我将开发人员添加到 [Project1]\Contributors TFS 组。

有没有办法为此 [Project1]\Contributors 组授予对 Sharepoint 和 Reporting Services 的访问权限，或者我是否仅限于添加 Windows 用户/组？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T23:29:58.117

如果有人有兴趣，我找到了一个名为 TFS Admin Tool 的工具

[http://www.codeplex.com/TFSAdmin](http://www.codeplex.com/TFSAdmin)
它有问题且不稳定，并不能完全满足我的需求，但非常接近。

“TFS 管理工具允许 TFS 管理员通过一个通用界面快速将用户添加到 Team Foundation Server 使用的所有三个平台：Team Foundation Server、Sharepoint 和 SQL Reporting Services。该工具还允许管理员更改当前权限在三层中的任何一层上，识别任何错误，并查看 Team Foundation Server、Sharepoint 和 SQL Reporting Services 中的所有用户及其权限集。”

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T00:09:32.860

SharePoint 仅允许您在 SharePoint 中创建组。然后，您可以像您所期望的那样对该组进行许可，如果它是一个 AD (windows) 组。

# c# - .NET 中的 MVC：如何不重复类？

> ID：441358
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-13T23:44:34.330
> 
>         
> 
> 标签：c#, .net, model-view-controller, architecture, model

我在模型中有一个 Person 类，并希望将其 15 个属性分配给视图中的标签。视图不应访问模型。这意味着控制器将处理创建人。View 是如何从 Controller 中获取这些 Person 属性的呢？如果 Controller 包含 Type Person 的成员，则 View 可以执行以下操作：

lblFirstName.Text = theController.Person.FirstName;

lblLastName.Text = theController.Person.LastName;

lblCity.Text = theController.Person.City;

但是，View 仍然是直接访问 Model（即 Person）。Controller 可以有自己的 Person 类，将 Model 的所有 Person 属性复制到其中，并具有上面的 View 使用语法。但这种设计有很多重复之处。有什么建议么？

* * *

顺便说一句，这是一个winform。该模型也是一个单独的项目/DLL。什么是 DTO？

Model 中的 Person 属性有特殊的逻辑，我不希望 View 遇到问题。例如，视图可能会：

字符串 fn = myController.Firstname;

并且由于 FirstName 属性中的逻辑而引发异常。因此，Person 对象的 Controller 轻量级（重复）版本不会有任何这些问题，因为它的属性只是字符串。

另请注意，您的 View 将需要对 Model 的引用来处理来自 Controller 的隐藏 Person 属性。我不喜欢它。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T01:18:18.523

稍微偏离主题（在 MVC 上），但关于您的问题的主题：

为什么不使用不那么麻烦的解决方案？如果您需要简单地为 15 个标签分配 15 个值，您可以为控制器提供一个索引属性或方法，该属性或方法使用 Label 对象的设计时名称作为键，以使用字典或实体属性名称的反射从模型中检索适当的值或一个大开关语句：

```
foreach(Control control in myLabelsPanel.Controls)
{
    Label label = control as Label;
    if(label != null)
    {
        label.Text = myController.TextForKey[label.Name];
    }
} 
```

编辑：我只是忘了补充一点，我认为访问我的模型实体类的视图并不是一件坏事。毕竟，它们是模型，它们可以成为 ViewModel 的一部分（如果您正在使用该范例），并且 MVC 鼓励 View 了解模型（但不是相反）。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-13T23:49:26.270

该人可能在视图数据中。我个人不认为视图访问控制器已经获得的模型类型的实例有很大的问题，所以我*个人*会让视图`Person`直接看到。

如果需要很多深层属性，例如在视图模型中，则可能需要将模型展平为`person.Foo.Bar.Blip`视图`obj.Blip`模型。

如果您正在处理单个对象，另一种选择是将每个值分别放入字典中 - 但这有点混乱。

另一种选择是滥用匿名类型；但不要这样做！我什至不会在这里重复细节，这太恶心了；但[这里是](http://msmvps.com/blogs/jon_skeet/archive/2009/01/09/horrible-grotty-hack-returning-an-anonymous-type-instance.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-13T23:51:19.837

如果您使用[DTO](http://en.wikipedia.org/wiki/Data_Transfer_Object)类，这些类是具有属性的对象，或者更严格的构造函数和一堆只读属性，您甚至可以深入分离模型中的关注点。起初它可能看起来像重复代码，但它成为处理模型预期的不同类型视图和结果的一种非常灵活的方式。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-13T23:55:47.707

我不确定为什么你不能在你的视图中分享你的模型。不需要重复，而且您似乎不需要使用 DTO，所以我只需通过状态包中的 Person 就可以了。

我认为您正在更多地考虑您的服务。您不希望您的视图访问您的服务，但您的控制器会将其打包然后发送到视图。就简单的模型而言，尽管通过恕我直言发送它确实没有任何退路。唯一的另一种方法是在与您的视图相同的项目中拥有一个模型，该模型本质上是您的模型的副本，除了您要发送的值。在那种情况下，我可以看到好处，但同样......你的例子不是那么专业。

# windows - 当请求的缓冲区大小大于可用数据量时，为什么 recv 会失败？

> ID：441361
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-01-13T23:45:50.427
> 
>         
> 
> 标签：windows, winapi, tcp, winsock

TCP 传输堆栈的基础是他们的作者有时记录的许多缓冲区限制。在 WinXP SP3 上，我认为我遇到过其中之一，但不知道为什么。

我已经实现了一个简单的客户端来从服务器获取数据（由一位同事用 Java 编写）。该协议是将数据的长度（按网络顺序）写入四个字节，然后写入数据。服务器将数据以 1024 字节块的形式写入 TCP 流。客户端正确接收到数据缓冲区的长度，分配内存并循环重复调用recv获取所有数据：

```
unsigned int TCP_BlockSize = 4096;
unsigned int len;
int result;

...code to request len...
unsigned char *buf = new unsigned char[len];

if( len > TCP_BlockSize)
{
Uint32 currentLen = 0;
result = 0;
Uint32 failCount = 0;
while( currentLen < len && result >= 0)
{
        result = recv( sock, buf + currentLen, TCP_BlockSize );
        if( result > 0 )
    {
        currentLen = currentLen + result;
    }
    else
        {
    break;
        }
}
} 
```

如果我将 TCP_BlockSize 设置为 4095 或更低，一切都很好，我可以接收数兆字节的传输。当我尝试 4096 大小的接收块时，对剩余数据的最后一个请求，即 len - currentLen < TCP_BlockSize，总是失败，返回值为 -1，errno = 0。我尝试了一些实验，比如修剪传输的数据在 815054 和 834246 字节之间，对于 4096 字节的接收块，一切都变得繁荣起来。

另一个细节：服务器在发送最后一个字节后关闭套接字。这就引出了一个问题，为什么不返回剩余的数据？*在流为空并*关闭之前不从recv返回-1感觉像是一种缺陷，因为当流不为空*并且*关闭以从recv接收-1时这是不明确的。

那么如何获取最后的数据呢？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T01:15:18.640

尝试类似...

```
to_rcv = (len - currentlen < TCP_BlockSize) ? len - currentlen : TCP_BlockSize;
result = recv( sock, buf + currentLen, to_rcv); 
```

这样，最终的 recv 将只要求所需的数量，否则它将要求 TCP_BlockSize。

# python - 为什么我看到“对等方重置连接”错误？

> ID：441374
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-01-13T23:52:10.537
> 
>         
> 
> 标签：python, sockets, network-programming, system

我正在使用 python 2.6.1 在 Mac OS X 10.5机器上测试[cogen 。](http://code.google.com/p/cogen/)我有一个简单的回显服务器和客户端泵，可以创建 10,000 个客户端连接作为测试。1000、5000 等都非常出色。然而，在大约 10,000 个连接时，服务器开始丢弃随机客户端 - 客户端会看到“对等方重置连接”。

我在这里缺少一些基本的网络背景知识吗？

请注意，我的系统配置为处理打开的文件（launchctl 限制、sysctl（maxfiles 等）和 ulimit -n 都是有效的；去过那里，做到了）。此外，我已经证实 cogen 正在选择在幕后使用 kqueue。

如果我在 client-connect() 调用中添加一点延迟，一切都会很好。因此，我的问题是，为什么在短时间内有高频率连接时，处于压力下的服务器会丢弃其他客户端？还有其他人遇到过这个吗？

为了完整起见，这是我的代码。

这是服务器：

```
# echoserver.py

from cogen.core import sockets, schedulers, proactors
from cogen.core.coroutines import coroutine
import sys, socket

port = 1200

@coroutine
def server():
    srv = sockets.Socket()
    srv.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
    addr = ('0.0.0.0', port)
    srv.bind(addr)
    srv.listen(64)
    print "Listening on", addr
    while 1:
        conn, addr = yield srv.accept()
        m.add(handler, args=(conn, addr))

client_count = 0

@coroutine
def handler(sock, addr):
    global client_count
    client_count += 1
    print "SERVER: [connect] clients=%d" % client_count
    fh = sock.makefile()
    yield fh.write("WELCOME TO (modified) ECHO SERVER !\r\n")
    yield fh.flush()
    try:
        while 1:
            line = yield fh.readline(1024)
            #print `line`
            if line.strip() == 'exit':
                yield fh.write("GOOD BYE")
                yield fh.close()
                raise sockets.ConnectionClosed('goodbye')
            yield fh.write(line)
            yield fh.flush()
    except sockets.ConnectionClosed:
        pass
    fh.close()
    sock.close()
    client_count -= 1
    print "SERVER: [disconnect] clients=%d" % client_count

m = schedulers.Scheduler()
m.add(server)
m.run() 
```

这是客户：

```
# echoc.py

import sys, os, traceback, socket, time
from cogen.common import *
from cogen.core import sockets

port, conn_count = 1200, 10000
clients = 0

@coroutine
def client(num):
    sock = sockets.Socket()
    sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
    reader = None
    try:
        try:
            # remove this sleep and we start to see 
            # 'connection reset by peer' errors
            time.sleep(0.001)
            yield sock.connect(("127.0.0.1", port))
        except Exception:
            print 'Error in client # ', num
            traceback.print_exc()
            return
        global clients
        clients += 1
        print "CLIENT #=%d [connect] clients=%d" % (num,clients)
        reader = sock.makefile('r')
        while 1:
            line = yield reader.readline(1024)
    except sockets.ConnectionClosed:
        pass
    except:
        print "CLIENT #=%d got some other error" % num
    finally:
        if reader: reader.close()
        sock.close()
        clients -= 1
        print "CLIENT #=%d [disconnect] clients=%d" % (num,clients)

m = Scheduler()
for i in range(0, conn_count):
    m.add(client, args=(i,))
m.run() 
```

感谢您提供任何信息！

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-01-13T23:56:45.397

Python 的套接字 I/O 有时会受到对等方连接重置的影响。它与全局解释器锁以及线程的调度方式有关。我[在博客](http://homepage.mac.com/s_lott/iblog/architecture/C551260341/E20081031204203/index.html)上写了一些关于这个主题的参考资料。

这`time.sleep(0.0001)`似乎是推荐的解决方案，因为它调整线程调度并允许套接字 I/O 完成。

# python - SCons：如果目标是在另一个存储库中构建的，我如何创建指向另一个存储库目标的链接

> ID：441397
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-01-14T00:02:40.767
> 
>         
> 
> 标签：python, build-process, build, build-automation, scons

当我将 a 添加`Repository`到`SConstruct`文件（[link](http://www.scons.org/doc/1.2.0/HTML/scons-user/c3810.html#AEN3814)）时，如果我的存储库中的任何目标已在另一个存储库中构建（并且依赖项没有更改），那么`SCons`将*不会*构建目标 - 这真的很酷。不幸的是，我有一些工具依赖于放置在某个位置的目标。`SCons`当由于其他存储库已经构建了目标而决定不在本地构建时，如何在当前存储库中创建指向该其他存储库目标的链接？

**编辑：**
它看起来`SCons`有一个“本地”功能，它将文件从另一个存储库复制到本地存储库（[链接](http://www.scons.org/doc/1.2.0/HTML/scons-user/x3986.html)）。我真正需要的是软链接，因为这些目标很大，而且有很多冗余。

# java - 关于 Java 和 C++ 中的内存管理

> ID：441400
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-01-14T00:05:06.953
> 
>         
> 
> 标签：java, c++, memory-management

好吧，我被分配了一项任务，主要是弄清楚我将使用的任何语言的内存分配是如何工作的。经过一些研究，我有一些问题和疑问，我想了解一下。例如：

[我在这里](http://en.citizendium.org/wiki/Stack_frame)读到Java 明确指定了堆栈内容的组织方式。查看[JVM 规范结构](http://java.sun.com/docs/books/jvms/second_edition/html/Overview.doc.html#17257)，它基本上说堆栈包含帧，并且通过正确分配变量和函数，这些帧包含类内部的任何内容。也许我在这里遗漏了一些东西，但我不明白这与 C++ 所做的有什么不同。我问是因为第一个链接说 Java 的堆栈内容规范避免了编译器不兼容。

此外，我还没有找到内存段是如何准确组织在一起的。例如，我知道内存分为全局变量、调用堆栈、堆和 C++ 代码，但我不知道堆的地址是否高于堆栈的地址，或者是否取决于实现。我还想知道 Java 程序是否具有更多功能，以及如何布局。我想有一个标准，因为 JVM 必须知道它在哪里使用它，尽管我想它可能只有指针，其余的留给操作系统。我也想，至少必须有一个事实上的标准。

我不明白的另一件事是运行时常量池。它应该是“类文件中常量池表的每个类或每个接口的运行时表示”，但我认为我不明白它的作用。它似乎有一个标签来指示所讨论的结构是什么类型？然后是结构的名称（由程序员给出还是由底层系统分配？）然后它的其余部分似乎随标签描述的任何内容（线程、数组等）而变化。

如果我对运行时常量池的解释是正确的，那么为什么它们和堆栈帧一样需要呢？是不是因为栈帧只处理栈段，而运行时常量池也必须有堆分配内存的指针？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-01-14T01:17:18.853

> 查看 JVM 规范结构，它基本上说堆栈包含帧，并且通过正确分配变量和函数，这些帧包含类内部的任何内容。也许我在这里遗漏了一些东西，但我不明白这与 C++ 所做的有什么不同。我问是因为第一个链接说 Java 的堆栈内容规范避免了编译器不兼容。

在实践中，C++ 编译器遵循相同的基本策略。但是，标准委员会不认为这是语言问题。相反，C++ 编译器遵循这个系统，因为这是大多数 CPU 和操作系统的设计方式。不同的平台在数据是通过堆栈还是通过寄存器（RISC机器）传递给函数，堆栈是向上还是向下，是否有不同的调用约定允许“正常”调用使用堆栈而其他调用使用某些方面存在分歧else（如[__fastcall](http://msdn.microsoft.com/en-us/library/6xa169sk.aspx)和[裸](http://msdn.microsoft.com/en-us/library/5ekezyy2.aspx)），是否有[嵌套函数](http://gcc.gnu.org/onlinedocs/gcc/Nested-Functions.html)、[尾调用支持](http://home.in.tum.de/%7Ebaueran/thesis/)等。

事实上，符合标准的 C++ 编译器可以编译成类似于 Scheme VM 的东西，其中“堆栈”有很大不同，因为 Scheme 需要实现来支持尾调用和延续。我从未见过这样的事情，但这是合法的。

[如果您尝试编写垃圾收集器，则“编译器不兼容”最为明显](http://blog.mozilla.com/jorendorff/2007/08/09/conservative-stack-scanning-101/)：

> 当前函数及其所有调用者的所有局部变量都在 ["the" 堆栈中，但请考虑[ucontext.h](http://www.opengroup.org/onlinepubs/007908775/xsh/ucontext.h.html)和[Windows Fibers](http://msdn.microsoft.com/en-us/library/ms682661(VS.85).aspx) ]。对于每个平台（即 OS + CPU + 编译器），都有一种方法可以找出 ["the" stack] 的位置。Tamarin 会这样做，然后它会在 GC 期间扫描所有内存以查看本地人指向的位置。...
> 
> 这个魔法存在于一个宏 MMGC_GET_STACK_EXTENTS 中，该宏定义在 MMgc/GC.h 头文件中。... [T]这是每个平台的单独实现。
> 
> 在任何给定时刻，一些本地变量可能在 CPU 寄存器中而不是在堆栈中。为了解决这个问题，宏使用几行汇编代码将所有寄存器的内容转储到堆栈中。这样 MMgc 就可以扫描堆栈，它会看到所有的局部变量。

* * *

此外， Java 中的*对象*通常不会分配在堆栈上。相反，对它们的引用是。整数、双精度、布尔值和其他原始类型确实在堆栈上分配。在 C++ 中，任何东西都可以在堆栈上分配，它有自己的优缺点列表。

> 我不明白的另一件事是运行时常量池。它应该是“类文件中常量池表的每个类或每个接口的运行时表示”，但我认为我不明白它的作用。

考虑：

```
String s = "Hello World";
int i = "Hello World".length();
int j = 5; 
```

s、i 和 j 都是变量，可以在程序稍后的某个时间点进行更改。但是，“Hello World”是一个不能更改的 String 类型的对象，5 是一个不能更改的 int，并且“Hello World”.length() 可以在编译时确定始终返回 11。这些常量是有效的对象和方法可以在它们上调用（嗯，至少在字符串上），所以它们需要被分配到某个地方。但它们永远无法改变。如果这些常量属于一个类，那么它们将被分配到每个类的常量池中。其他不属于类的常量数据（如 main() 线程的 ID）分配在每个运行时常量池中（“运行时”在本例中表示“JVM 的实例”）。

C++ 标准有一些关于类似技术的语言，但实现由二进制格式（ELF、a.out、COFF、PE 等）决定。该标准期望整数数据类型（bool、int、long 等）或 c 样式字符串的常量实际保存在二进制的常量部分中，而其他常量数据（双精度、浮点数、类）可能被存储作为一个变量以及一个表示“变量”不可修改的标志（也可以将它们与整数和 c 样式的字符串常量一起存储，但许多二进制格式不会使这个选项成为一个选项）。

一般来说，当一次打开多个程序副本时，可以共享二进制文件的“常量数据部分”（因为程序的每个副本中的常量数据都是相同的）。  [在 ELF 上，这部分称为 .rodata 部分](http://wiki.osdev.org/ELF)。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T00:17:28.303

你被赋予的具体任务是什么？

Java 和 C++ 的主要区别在于 Java 是由 VM 收集的垃圾，而在 C++ 中，程序直接在机器上执行，内存是通过 OS 服务管理的。

关于堆栈，框架只是 C++ 编译器所做的更“官方”和标准的形式。当您从一个调用移动到另一个调用时，C++ 编译器只是将堆栈中的东西放在一起。在 Java 中，这个术语是框架，因为编译后的 Java 代码应该在任何平台上运行，所以对于如何发生有非常明确的标准。在 C++ 中，每个编译器可以不同地处理堆栈（例如，甚至根据字长的性质）。

在 Java 中，一切都在管理一切的虚拟机中运行，尽管它将一些东西委托给环境。换句话说，您无法访问 JVM 将您的数据和代码放在哪里，您的代码甚至可能永远不会成为真正的“代码段”。换句话说，这真的无法回答。在 C++ 中，一切都在硬件上运行，因此您将拥有堆栈段、数据段等。查看有关 C++ 的信息。

在 C++ 中，类在运行时在内存中没有表示；实际上，您可以将 C++ 编译成 C，然后将结果编译成程序集。在 Java 中，一切都在运行时表示，因此您可以询问对象它属于什么类以及支持什么方法。因此，每个类文件都有一个“常量池”，其中出现了表示方法名称、字段名称等内容的字符串。实际的类定义是指池。换句话说，这与堆栈帧几乎没有关系。堆栈帧是存储方法参数、局部变量和返回值的地方。

# php - 正则表达式查找和替换 HTML 注释标签的内容

> ID：441404
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-14T00:05:48.170
> 
>         
> 
> 标签：php, html, regex, non-greedy

我有一个 CMS，它使用基于 HTML 注释的语法让用户插入 Flash 视频播放器、幻灯片和其他用户无法轻松编写的“硬”代码。

一部 FLV 电影的语法如下所示：
`<!--PLAYER=filename.flv-->`

我使用这段代码：

`$find_players = preg_match("/<!--PLAYER\=(.*)-->/si", $html_content, $match);`

如果只有一个玩家，这很好用， $match[1] 包含文件名（这就是我所需要的）

我对正则表达式的了解正在消失，因此我无法对其进行调整以获取多个匹配项。

如果页面上还有更多，它会完全中断，因为它太贪婪地匹配（从第一个`<!--PLAYER`到最后一个`-->`

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T00:16:01.737

您可能希望正则表达式修饰符 U（PCRE_UNGREEDY，不贪婪地匹配）。这将获取最短的匹配，这意味着您不会从第一个 <!--PLAYER= 的开头匹配到最后一个 -->

一个简短的例子：

```
<?php
$text = "blah\n<!-x=abc->blah<!-x=def->blah\n\nblah<!-x=ghi->\nblahblah" ;
$reg  = "/<!-x=(.*)->/U" ;
preg_match_all( $reg, $text, $matches ) ;
print_r( $matches ) ; 
```

然后您的代码变为：

```
$find_players = preg_match_all("/<!--PLAYER=(.*)-->/Ui", $html_content, $matches);
// print $matches[1] ; 
```

您使用的 's' 修饰符 (PCRE_DOTALL) 也可能没有帮助；您不太可能有一个带有换行符的文件名。

编辑：@Stevens 建议使用这种语法，我同意它更清晰 - 将 U 修饰符移动到捕获括号。

```
$find_players = preg_match_all("/<!--PLAYER=(?U)(.*)-->/i", $html_content, $matches); 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T00:33:11.423

使用正则表达式时，通常使用更具体的表达式而不是“惰性点”会更高效，这通常会导致过度回溯。您可以使用负前瞻来实现相同的结果，而不会使正则表达式引擎负担过重：

```
$find_players = preg_match("/<!--PLAYER=((?:[^-]+|-(?!->))*)-->/ig", $html_content, $match); 
```

请注意，对于像这样的简单案例，使用惰性点不太可能导致明显的问题，但始终告诉正则表达式引擎您的意思是一个好**习惯**。在这种情况下，您希望在不传递注释终止符的情况下收集尽可能多的字符（“贪婪”）。终止符是一个破折号，后跟另一个破折号和一个大于号。因此，我们允许任何数量的任何字符，*除了*破折号或*不*开始注释终止符的破折号。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T00:11:26.507

```
$find_players = preg_match("/<!--PLAYER\=(.*?)-->/i", $html_content, $match); 
```

(. ***?** )

应该可以正常工作。

# java - 它为代码生成器节省了多少时间？

> ID：441410
> 
>         
> 
> 赞同：-1
> 
>         
> 
> 时间：2009-01-14T00:07:41.083
> 
>         
> 
> 标签：java, code-generation

我的问题似乎很简单，但比看起来更具理论性。有一些代码生成软件或应用程序构建软件可以在不使用编程语言的情况下完成。[Intelliun](http://www.intelliun.com/)的 VE Server 和 VE Designer 等应用程序应该可以完成这项任务。我的问题是，实际上有人跟踪这种工具与拥有开发团队和源代码进化过程相比的实际节省量。

对于 VE 设计器的特定示例，应用程序从设计器完成，您看不到它的代码，您只需在 VE 服务器中运行应用程序。所有代码看起来都像 XML 内部命令。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T00:41:51.140

这取决于我们如何衡量那个时间。

如果你比较两个控制组——一个手动输入所有代码，另一个使用代码生成器——我毫不怀疑使用代码生成器的组将需要更少的时间，放下手来。当然，这取决于你想用生成器走多远，但毫无疑问，随着生成代码的百分比上升，手动输入看起来越来越糟糕。

我唯一关心的是代码生成器来自哪里以及它的设计有多少想法。

如果您因为不理解而不想接触向导/代码生成器生成的代码，则应该将其计入代码生成器。

如果代码生成器迫使您进行糟糕的设计，则应该将其计入代码生成器。

如果代码生成器吐出的类太多以至于没有人可以跟踪正在发生的事情，那么它应该计入代码生成器。

如果代码生成器使您的维护生活成为人间地狱，那么它应该计入代码生成器。

如果可以的话，我喜欢理解和创建自己的工具的想法。其他人提供的向导可能会导致问题。支持或反对他们的会计应该反映问题。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T01:04:37.787

您可能想看看“[代码生成器坏吗？ ”这个问题的一些答案。](https://stackoverflow.com/questions/202871/are-code-generators-bad)'。虽然问题本身更多地与我应该/不应该使用代码生成器有关，但许多回复都有关于代码生成器使用的不利方面以及生成的代码如何经常必须由实际的人查看/编辑的注释存在。情况并非总是如此，并且很大程度上取决于生成代码的质量（毕竟它实际上只是由一个可能很糟糕的程序员编写的随地吐痰的模板，他真的想成为一名伐木工人，不应该被允许靠近键盘）。如果它生成高质量的代码，那么您可能会节省时间。否则，重构结果所花费的时间最终可能与最初实际编写代码所花费的时间相同或更大。

我个人对代码生成器的结果好坏参半。例如，由 Visual Studio 自动生成的代码（特别是表单设计器）我发现可能是一场噩梦，如果我需要突然实现一些特殊行为，表单看起来或行为不符合预期，这通常最终会让我付出代价更多时间。我喜欢eclipse中的那个（不是真正的全自动代码生成工具），因为它可以让我布局一个类，然后使用内置的可编辑模板构造所有方法签名等（我也知道，如果它吐出废话，那就是我自己的错）。我发现通用框架比获得一些认为它很好并且*完全按照*你想要的但没有做到的东西（例如，获得汽车底盘）更有用的时间节省*完全*' 构造的汽车，只有三个轮子，只能右转）。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T01:45:42.633

我在两种情况下使用过代码生成（即自动生成 2/3 左右的代码并让程序员填写其余代码的程序），一次是在一家拥有巨大产品的大公司，另一次是使用我自己写的工具。在这两种情况下，我发现结果好坏参半。  

1) 它节省了我们开发当时需要完成的工作的时间。  

2）然而，它把我们锁在了我们的设计中，使代码变得不那么灵活。它给了我们很多无法轻易修改的重复逻辑。

据我所知，虽然我确信会有例外，但从长远来看，如果你使用一个代码生成工具来输出人类以后必须修改的代码，你会浪费时间。从本质上讲，如果它不像编译器并且不允许您轻松重构，那么它可能会进行上述权衡。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T02:04:47.057

“代码生成器”和“编程语言”之间并没有明显的区别。如果你使用软件生成代码，你就是在编程，即使你不了解细节。C++、Java 和 C# 是“代码生成器”，因为它们被编译成低级语言，如果程序员选择这样做，这些低级语言本身可以手动编码。许多编程语言一开始是作为宏工具开始的，使用基于 XML 的工具编写脚本并不比用 Perl、Python 或 Ruby 编写相同的脚本更不像一个“程序”。

一般来说，通过使用软件生成高度重复的代码来节省时间是一个好主意。潜在的缺点是您可能会将自己锁定在一个平台中——也就是说，您仅限于代码生成器提供的功能。代码生成器（或编程语言）是否值得使用完全取决于它对给定问题的有效性。

不要误以为某些格式（如 XML 甚至 HTML）是死“数据”，而其他格式（如 C++ 和 Python）是“代码”。数据和代码是可以互换的。需要 HTML 中的“代码”示例吗？考虑以下：

HTML 是一种声明性语言。在其中，您以“这是一个段落，这是一个标题”等方式指定存在的事物。Python 和其他编程语言具有命令式部分，您可以在其中指定“现在添加 x 和 y，现在将 x 写入内存”等等。

但是，您可以颠倒这种关系。在 HTML 的情况下，当通过浏览器输入时，它变得势在必行。“这是一个具有这些属性的段落”被 Firefox 解释为“现在使用这些参数呈现一段文本”。作为一个文件，HTML 只是死数据，但在解释器的上下文中，它变成了活代码。反过来，Python 也会发生同样的情况。在执行期间，您的 Python 指令成为解释器的指令，但 Python 文件本身只是死文本。从某种意义上说，您的 Python 程序作为数据形式的潜在指令的集合坐在那里，直到您通过 Python 解释器运行它。以完全相同的方式，HTML 作为文件中的数据存在，直到浏览器需要对其进行操作为止。

XML 是一种数据格式，但指令是一种数据。您可以使用 XML 来包含命令式语句，例如数学运算或函数调用。您是否将该 XML 解释为数据或代码完全取决于上下文；从某种意义上说，所有计算机数据既是数据又是代码。数据和代码之间的区别是人类的惯例，而不是计算机固有的现实。

**Edit**: I guess I should concede here that on the processor architecture level, there is often a very concrete distinction between code and data.  Code is what gets fed through the processor core and changes the state of the machine.  A typical architecture keeps the bits that are waiting for execution in a separate area of memory from other data which does not represent executable code.  But this distinction quickly becomes blurred when you start talking about interpreters.

# javascript - 是否有指向 Google API 上“最新”jQuery 库的链接？

> ID：441412
> 
>         
> 
> 赞同：801
> 
>         
> 
> 时间：2009-01-14T00:08:57.947
> 
>         
> 
> 标签：javascript, jquery, google-api

我在`<script>`标签中使用以下 jQuery 链接：

```
http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.js 
```

是否有“最新”版本的链接？类似于以下内容（不起作用）：

```
http://ajax.googleapis.com/ajax/libs/jquery/latest/jquery.js 
```

（显然，将您的代码链接到可能更改的库但在开发中有用的计划不一定是一个很好的计划。）

* * *

## 回答 #1

> 赞同：1019
> 
>             
> 
> 时间：2009-01-14T00:16:33.953

**在 jQuery 1.11.1 之前**，您可以使用以下 URL 来获取最新版本的 jQuery：

*   [https://code.jquery.com/jquery-latest.min.js](https://code.jquery.com/jquery-latest.min.js) - jQuery 托管（缩小）

*   [https://code.jquery.com/jquery-latest.js](https://code.jquery.com/jquery-latest.js) - jQuery 托管（未压缩）

*   [https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js](https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js) - 谷歌托管（缩小）

*   [https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js](https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js) - Google 托管（未压缩）

例如：

```
<script src="https://code.jquery.com/jquery-latest.min.js"></script> 
```

* * *

然而，从 jQuery 1.11.1 开始，jQuery 和 Google 都停止了更新这些 URL；它们将*永远*固定在 1.11.1。没有支持的备用 URL 可供使用。有关为什么会这样的解释，请参阅此博客文章；[不要使用 jquery-latest.js](http://blog.jquery.com/2014/07/03/dont-use-jquery-latest-js/)。

两个主机都支持`https`以及`http`，因此可以根据需要更改协议（或使用[协议相对 URI](http://www.paulirish.com/2010/the-protocol-relative-url/)）

另请参阅：[https ://developers.google.com/speed/libraries/devguide](https://developers.google.com/speed/libraries/devguide)

* * *

## 回答 #2

> 赞同：94
> 
>             
> 
> 时间：2010-10-30T16:58:43.613

不要使用这个答案。URL 指向 jQuery 1.11（并且[总是会](http://blog.jquery.com/2014/07/03/dont-use-jquery-latest-js/)）。

> 以上代码段的基本功劳

[http://code.jquery.com/jquery-latest.min.js](http://code.jquery.com/jquery-latest.min.js)是缩小版，始终保持最新。

* * *

## 回答 #3

> 赞同：60
> 
>             
> 
> 时间：2009-05-11T12:07:58.587

请注意，当您使用来自谷歌的“直接”和“最新”链接时，缓存标头是不同的。

使用[http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js时](http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js)

```
Cache-Control: public, max-age=31536000 
```

使用[http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js时](http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js)

```
Cache-Control: public, max-age=3600, must-revalidate, proxy-revalidate 
```

* * *

## 回答 #4

> 赞同：36
> 
>             
> 
> 时间：2014-07-17T11:57:09.293

**不要使用 jquery-latest.js**

此文件不再更新（它将永远在 v1.11.1 上）。此外，它的缓存寿命很短，（消除了使用 CDN 的好处），因此您最好选择 jQuery 版本。

有关 jQuery 博客的更多详细信息：http:
 [//blog.jquery.com/2014/07/03/dont-use-jquery-latest-js/](http://blog.jquery.com/2014/07/03/dont-use-jquery-latest-js/)

* * *

## 回答 #5

> 赞同：31
> 
>             
> 
> 时间：2010-10-30T17:04:39.557

并非没有，但您不应该只是自动使用最新的库。如果他们明天发布最新的库并且它破坏了您的一些脚本，那么您就是[SOL](https://en.wiktionary.org/wiki/SOL#Adjective)，但是如果您使用用于开发脚本的库，您将确保它们能够正常工作。

* * *

## 回答 #6

> 赞同：18
> 
>             
> 
> 时间：2011-02-02T09:23:00.083

采用：

```
<script type="text/javascript" src="//www.google.com/jsapi"></script>
<script type="text/javascript">
//<![CDATA[
    google.load("jquery", "1");
    //google.load("jqueryui", "1");
    //google.load("swfobject", "1");
//]]>
</script> 
```

注意：以上代码段将坚持 1.7.1 或 1.11.1。

我对生产的建议是对 CDN jQuery 版本进行硬编码：`<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>`

您可以在这里找到最新的 Google CDN 库：
 [https ://developers.google.com/speed/libraries/](https://developers.google.com/speed/libraries/)

或者使用 jQuery CDN：
 [https ://code.jquery.com/](https://code.jquery.com/)

* * *

## 回答 #7

> 赞同：7
> 
>             
> 
> 时间：2012-01-31T12:07:44.437

jQuery 也不允许您通过 SSL 调用他们的最新文件，如果您想在购物车等中使用 jQuery，这是一个考虑因素。

例如

```
<script type="text/javascript" src="https://code.jquery.com/jquery-latest.min.js"></script> 
```

会给你一个安全错误。

Google 的 API 将允许您通过 SSL 调用：

```
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">
  google.load("jquery", "1.7");
</script> 
```

* * *

## 回答 #8

> 赞同：6
> 
>             
> 
> 时间：2010-12-17T21:41:55.697

就在这里。

[http://code.jquery.com/jquery-latest.min.js](http://code.jquery.com/jquery-latest.min.js)

* * *

## 回答 #9

> 赞同：5
> 
>             
> 
> 时间：2009-01-14T01:17:10.773

不，没有。。

[但是，对于开发， jQuery 代码站点](http://code.jquery.com/jquery-latest.js)上有这样的链接。

* * *

## 回答 #10

> 赞同：4
> 
>             
> 
> 时间：2012-09-19T07:52:06.913

这个如何？

[http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js](http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js)

我认为这始终是最新版本 - 如果我错了，请纠正我。

* * *

## 回答 #11

> 赞同：1
> 
>             
> 
> 时间：2012-05-14T15:53:24.680

[http://lab.abhinayrathore.com/jquery_cdn/](http://lab.abhinayrathore.com/jquery_cdn/)是一个页面，您可以在其中找到最新版本的 jQuery、[jQuery UI](http://en.wikipedia.org/wiki/JQuery_UI)和 Google 和 Microsoft [CDN](http://en.wikipedia.org/wiki/Content_delivery_network)主题的链接。

此页面使用来自 CDN 的最新链接自动更新。

* * *

## 回答 #12

> 赞同：-1
> 
>             
> 
> 时间：2012-06-02T05:46:09.263

您可以通过以下任何方式使用最新版本的 jQuery 库。

*   Google Ajax API CDN（也支持通过 HTTPS 的 SSL）

    ```
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2"></script> 
    ```

    /jquery.min.js

*   Microsoft CDN（也支持通过 HTTPS 的 SSL）

    ```
    <script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.2.min.js"></script> 
    ```

    Ajax CDN 公告，Microsoft Ajax CDN 文档

*   jQuery CDN（通过 Media Temple）

    ```
     <script type="text/javascript" src=" http://code.jquery.com/jquery-1.7.2.min.js"></script> 
    ```

    ** 缩小版

    ```
     <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.js"></script> 
    ```

    ** 开发（完整）版本

# c# - 为什么 C# 限制可以声明为 const 的类型集？

> ID：441420
> 
>         
> 
> 赞同：34
> 
>         
> 
> 时间：2009-01-14T00:13:00.573
> 
>         
> 
> 标签：c#, constants, compiler-errors

编译器错误[CS0283](http://msdn.microsoft.com/en-us/library/ms228656(VS.80).aspx)表明只有基本的 POD 类型（以及字符串、枚举和空引用）可以声明为`const`. 有人对这种限制的基本原理有理论吗？例如，如果能够声明其他类型的 const 值，例如 IntPtr，那就太好了。

我相信 of 的概念`const`实际上是 C# 中的语法糖，它只是用字面值替换了名称的任何使用。例如，给定以下声明，任何对 Foo 的引用都将在编译时替换为“foo”。

```
const string Foo = "foo"; 
```

这将排除任何可变类型，所以也许他们选择了这个限制，而不是必须在编译时确定给定类型是否可变？

* * *

## 回答 #1

> 赞同：33
> 
>             
> 
> 时间：2009-01-14T00:41:26.663

来自[C# 规范，第 10.4 章 - 常量](http://msdn.microsoft.com/en-us/library/aa645749(VS.71%29.aspx)：

*（C# 3.0 规范中的 10.4，2.0 在线版本中的 10.3）*

> 常量是表示常量值的类成员：可以在编译时计算的值。

这基本上是说您只能使用仅由文字组成的表达式。不能使用对任何方法、构造函数（不能表示为纯 IL 文字）的任何调用，因为编译器无法在编译时执行该执行，从而计算结果。此外，由于无法将方法标记为不变（即输入和输出之间存在一对一映射），编译器执行此操作的唯一方法是分析 IL 以查看是否它取决于输入参数、特殊情况处理某些类型（如 IntPtr）或只是禁止对任何代码的每次调用。

例如，IntPtr 虽然是一种值类型，但仍然是一种结构，而不是内置文字之一。因此，任何使用 IntPtr 的表达式都需要调用 IntPtr 结构中的代码，这对于常量声明是不合法的。

我能想到的唯一合法的常量值类型示例是仅通过声明它就用零初始化的示例，这几乎没有用。

至于编译器如何处理/使用常量，它将使用计算值代替代码中的常量名称。

因此，您有以下效果：

*   没有对原始常量名称、声明它的类或命名空间的引用被编译到此位置的代码中

*   如果你反编译代码，它会在其中包含幻数，只是因为如上所述，对常量的原始“引用”不存在，只有常量的值

*   编译器可以使用它来优化甚至删除不必要的代码。例如`if (SomeClass.Version == 1)`，当 SomeClass.Version 的值为 1 时，实际上会删除 if 语句，并保留正在执行的代码块。如果常量的值不是 1，则整个 if 语句及其块将被删除。

*   由于常量的值被编译到代码中，而不是对常量的引用，因此如果常量的值发生变化（它不应该发生变化！），使用来自其他程序集的常量将不会以任何方式自动更新编译的代码

换句话说，在以下情况下：

1.  程序集 A，包含一个名为“Version”的常量，值为 1

2.  程序集 B，包含一个表达式，该表达式从该常量分析程序集 A 的版本号并将其与 1 进行比较，以确保它可以与程序集一起使用

3.  有人修改程序集 A，将常量的值增加到 2，并重建 A（但不是 B）

在这种情况下，程序集 B 的编译形式仍会将 1 的值与 1 进行比较，因为在编译 B 时，常量的值是 1。

事实上，如果这是在程序集 B 中唯一使用程序集 A 的任何内容，则程序集 B 将在不依赖程序集 A 的情况下编译。在程序集 B 中执行包含该表达式的代码将不会加载程序集 A。

因此，常量应该只用于永远不会改变的事物。如果它是一个可能或将在未来某个时间更改的值，并且您不能保证同时重建所有其他程序集，则只读字段比常量更合适。

所以这没关系：

*   公共常量 Int32 NumberOfDaysInAWeekInGregorianCalendar = 7;

*   公共常量 Int32 NumberOfHoursInADayOnEarth = 24;

虽然这不是：

*   公共常量 Int32 AgeOfProgrammer = 25;

*   公共常量字符串 NameOfLastProgrammerThatModifiedAssembly = "乔程序员";

* * *

**编辑 2016 年 5 月 27 日**

好的，刚刚获得了赞成票，所以我在这里重新阅读了我的答案，这实际上有点错误。

现在，C# 语言规范的*意图就是我在上面写的所有内容。*您不应该使用不能用文字表示的东西作为`const`.

但是你可以吗？嗯，是....

我们来看看`decimal`类型。

```
public class Test
{
    public const decimal Value = 10.123M;
} 
```

*让我们*看看这个类在使用 ildasm 时的样子：

```
.field public static initonly valuetype [mscorlib]System.Decimal X
.custom instance void [mscorlib]System.Runtime.CompilerServices.DecimalConstantAttribute::.ctor(int8, uint8, uint32, uint32, uint32) = ( 01 00 01 00 00 00 00 00 00 00 00 00 64 00 00 00 00 00 ) 
```

让我为你分解一下：

```
.field public static initonly 
```

对应于：

```
public static readonly 
```

没错， a`const decimal`实际上是 a `readonly decimal`。

这里真正的事情是编译器将使用它`DecimalConstantAttribute`来发挥它的魔力。

现在，这是我所知道的唯一一个使用 C# 编译器的魔法，但我认为值得一提。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T00:16:29.880

> 我相信 const 的概念实际上是 C# 中的语法糖，它只是用字面值替换名称的任何使用

编译器对其他语言的 const 对象做了什么？

您可以将 readonly 用于我在运行时评估的可变类型。有关差异，请参阅[本文](http://en.csharp-online.net/const,_static_and_readonly)。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T00:26:39.673

> 有人对这种限制的基本原理有理论吗？

如果允许它只是一个理论，我的理论是原始类型的 const 值可以在 MSIL 中的文字操作码参数中表示......但其他非原始类型的值不能，因为 MSIL 没有将用户定义类型的值表示为文字的语法。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T00:44:36.157

在我看来，只有值类型可以表示为常量（字符串除外，它位于值和对象类型之间）。

对我来说没问题：必须在堆上分配对象（引用），但根本不分配常量（因为它们在编译时被替换）。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2017-05-02T12:50:48.300

简而言之，所有简单类型、枚举和字符串都是不可变的，但例如 Struct 不是。您可以拥有一个状态可变的结构（字段、属性，甚至对引用类型的引用）。所以编译器不能确保（在编译时）结构变量的内部状态不能改变。所以编译器需要确保一个类型在定义上是不可变的，以便在常量表达式中使用。

* * *

## 回答 #6

> 赞同：-1
> 
>             
> 
> 时间：2009-01-14T00:23:19.977

const 仅限于 C# 中的数字和字符串，因为编译器将变量替换为 MSIL 中的文字值。换句话说，当你写：

```
const string myName = "Bruce Wayne";
if (someVar == myName)
{
   ...
} 
```

实际上被视为

```
if (someVar == "Bruce Wayne")
{
   ...
} 
```

是的，C# 编译器足够聪明，可以将字符串上的相等运算符 (==) 视为

```
string1.Equals(string2) 
```

# asp.net - HTTPModule 事件执行顺序？

> ID：441421
> 
>         
> 
> 赞同：60
> 
>         
> 
> 时间：2009-01-14T00:13:00.807
> 
>         
> 
> 标签：asp.net, httpmodule, httpapplication

有谁知道站点或页面，或者知道 HTTPModule 事件执行的 HTTPApplication 类事件的执行顺序？

我找到了所有事件的[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.web.httpapplication_events.aspx)，但它没有显示流程步骤列表，我也找不到。

* * *

## 回答 #1

> 赞同：84
> 
>             
> 
> 时间：2009-01-14T00:32:46.540

也许这有帮助

[http://support.microsoft.com/kb/307985/en-us/](http://support.microsoft.com/kb/307985/en-us/)

> HttpApplication 类提供了许多模块可以与之同步的事件。以下事件可供模块在每个请求上同步。这些事件按顺序列出：

1.  开始请求

2.  验证请求

3.  授权请求

4.  解析请求缓存

5.  获取请求状态

6.  PreRequestHandlerExecute

7.  PostRequestHandlerExecute

8.  释放请求状态

9.  更新请求缓存

10.  结束请求

> 以下事件可用于模块同步每个请求传输。这些事件的顺序是不确定的。

*   PreSendRequestHeaders

*   预发送请求内容

*   错误

有关完整信息，请参阅文章。

* * *

## 回答 #2

> 赞同：51
> 
>             
> 
> 时间：2012-01-22T00:02:20.483

MSDN 库文档：

*   [IIS 5.0 和 6.0 的 ASP.NET 应用程序生命周期概述](http://msdn.microsoft.com/en-us/library/ms178473.aspx)

*   [IIS 7.0 的 ASP.NET 应用程序生命周期概述](http://msdn.microsoft.com/en-us/library/bb470252.aspx)

以下是 ASP.NET 4.0 请求管道中的事件（粗体）和其他步骤：

> 1.  验证请求，它检查浏览器发送的信息并确定它是否包含潜在的恶意标记。
> 
> 2.  如果在 Web.config 文件的 UrlMappingsSection 部分中配置了任何 URL，则执行 URL 映射。
> 
> 3.  引发**BeginRequest**事件。
> 
> 4.  引发**AuthenticateRequest**事件。
> 
> 5.  引发**PostAuthenticateRequest**事件。
> 
> 6.  引发**AuthorizeRequest**事件。
> 
> 7.  引发**PostAuthorizeRequest**事件。
> 
> 8.  引发**ResolveRequestCache**事件。
> 
> 9.  引发**PostResolveRequestCache**事件。
> 
> 10.  **[IIS 5.0/6.0]**根据请求资源的文件扩展名（映射在应用程序的配置文件中），选择一个实现IHttpHandler的类来处理请求。如果请求是针对从 Page 类派生的对象（页面）并且需要编译页面，则 ASP.NET 在创建页面实例之前编译页面。**[IIS 7.0]**引发**MapRequestHandler**事件。根据所请求资源的文件扩展名选择适当的处理程序。处理程序可以是本机代码模块，例如 IIS 7.0 StaticFileModule，也可以是托管代码模块，例如 PageHandlerFactory 类（处理 .aspx 文件）。
> 
> 11.  引发**PostMapRequestHandler**事件。
> 
> 12.  引发**AcquireRequestState**事件。
> 
> 13.  引发**PostAcquireRequestState**事件。
> 
> 14.  引发**PreRequestHandlerExecute**事件。
> 
> 15.  为请求调用相应 IHttpHandler 类的 ProcessRequest 方法（或异步版本 IHttpAsyncHandler.BeginProcessRequest）。例如，如果请求是针对某个页面的，则当前页面实例会处理该请求。
> 
> 16.  引发**PostRequestHandlerExecute**事件。
> 
> 17.  引发**ReleaseRequestState**事件。
> 
> 18.  引发**PostReleaseRequestState**事件。
> 
> 19.  如果定义了 Filter 属性，则执行响应过滤。
> 
> 20.  引发**UpdateRequestCache**事件。
> 
> 21.  引发**PostUpdateRequestCache**事件。
> 
> 22.  **[IIS 7.0]**引发**LogRequest**事件。
> 
> 23.  **[IIS 7.0]**引发**PostLogRequest**事件。
> 
> 24.  引发**EndRequest**事件。
> 
> 25.  引发**PreSendRequestHeaders**事件。
> 
> 26.  引发**PreSendRequestContent**事件。
> 
>   
>   
> 
> 注意：仅当应用程序在 IIS 7.0 和 .NET Framework 3.0 或更高版本中以集成模式运行时，才支持 MapRequestHandler、LogRequest 和 PostLogRequest 事件。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2019-03-28T22:48:35.360

接受的答案已过时。以下是根据[文档](https://docs.microsoft.com/en-us/dotnet/api/system.web.httpapplication?view=netframework-4.7.2#remarks)提出的事件列表：

> 1.  开始请求
>     
>     
> 
> 2.  验证请求
>     
>     
> 
> 3.  PostAuthenticateRequest
>     
>     
> 
> 4.  授权请求
>     
>     
> 
> 5.  PostAuthorizeRequest
>     
>     
> 
> 6.  解析请求缓存
>     
>     
> 
> 7.  PostResolveRequestCache
>     
>     
>       
>       
>     
>     在 PostResolveRequestCache 事件之后和 PostMapRequestHandler 事件之前，会创建一个事件处理程序（即与请求 URL 对应的页面）。当服务器以集成模式运行 IIS 7.0 并且至少运行 .NET Framework 3.0 版时，会引发 MapRequestHandler 事件。当服务器以经典模式或早期版本的 IIS 运行 IIS 7.0 时，无法处理此事件。
>     
>     
> 
> 8.  PostMapRequestHandler
>     
>     
> 
> 9.  获取请求状态
>     
>     
> 
> 10.  PostAcquireRequestState
>     
>     
> 
> 11.  PreRequestHandlerExecute
>     
>     
> 
> 12.  PostRequestHandlerExecute
>     
>     
> 
> 13.  释放请求状态
>     
>     
> 
> 14.  PostReleaseRequestState
>     
>     
> 
> 15.  更新请求缓存
>     
>     
> 
> 16.  PostUpdateRequestCache
>     
>     
> 
> 17.  日志请求
>     
>     
> 
> 18.  PostLogRequest
>     
>     
> 
> 19.  结束请求

# perl - 如何在 Perl 中实现带有超时读取的“tail -f”？

> ID：441437
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-01-14T00:19:21.450
> 
>         
> 
> 标签：perl, timeout

我的问题是[如何立即处理输入而不是等待换行符](https://stackoverflow.com/questions/213901/in-perl-how-do-i-process-input-as-soon-as-it-arrives-instead-of-waiting-for-new)的对立面。我想继续阅读不断增长的日志文件，但在文件没有增长指定的秒数后停止。

我在 CPAN 找到了[Sys::AlarmCall](http://search.cpan.org/~abh/Sys-AlarmCall-1.2/AlarmCall.pm)，并尝试如下所示，但运行时它不会超时：

```
perl progress.tracker.pl progress.tracker.pl 
```

我猜这与与 ' `<>`' 运算符相关的自动魔法有关。但我不确定如何重写代码。我可以只显式打开一个文件（而不是任意数量的文件），如果没有指定文件，则默认为标准输入 - 我只希望将它与一个文件名一起使用。

（该脚本为读取的每一行生成一个点，每读取 50 行生成一个换行符，并每 25 行点输出一个时间戳。我用它来跟踪长时间运行的构建的进度。当前的化身由`tail -f`, 但是当此脚本执行时，它不会退出，主要是因为它永远不会再获得任何输入来写入现在不存在的进度跟踪器。“最后”行的东西是我通常处理的日志文件中的一个标记；我想删除它. 超时将按分钟计算，而不是亚秒级。）

```
#!/usr/perl/v5.10.0/bin/perl -w
#
# @(#)$Id: progress.tracker.pl,v 1.3 2009/01/09 17:32:45 jleffler Exp jleffler $
#
# Track progress of a log-generating process by printing one dot per line read.

use strict;
use constant DOTS_PER_LINE => 50;
use constant LINES_PER_BREAK => 25;
use constant debug => 0;
use POSIX qw( strftime );
use Sys::AlarmCall;

sub read_line
{
    print "-->> read_line()\n" if debug;
    my $line = <STDIN>;
    printf "<<-- read_line(): %s", (defined $line) ? $line : "\n" if debug;
    return $line;
}

my $line_no = 0;
my $timeout = 30;
my $line;

$| = 1;     # Unbuffered output

while ($line = alarm_call($timeout, 'read_line', undef))
{
    $line_no++;
    print ".";
    print "\n" if ($line_no % DOTS_PER_LINE == 0);
    printf "%s\n", strftime("%Y-%m-%d %H:%M:%S", localtime(time))
        if ($line_no % (DOTS_PER_LINE * LINES_PER_BREAK) == 0);
    last if $line =~ m/^Trace run finished: /;
}

print "\n";
print $line if defined $line && $line =~ m/^Trace run finished: /; 
```

有什么建议么？（最好除了'下车并用C编码'！）

* * *

[File::Tail](http://search.cpan.org/~mgrabnar/File-Tail-0.99.3/Tail.pm)似乎很好地满足了我的要求。修改后的代码是：

```
#!/usr/perl/v5.10.0/bin/perl -w
#
# @(#)$Id: progress.tracker.pl,v 3.2 2009/01/14 07:17:04 jleffler Exp $
#
# Track progress of a log-generating process by printing one dot per line read.

use strict;
use POSIX qw( strftime );
use File::Tail;

use constant DOTS_PER_LINE   => 50;
use constant LINES_PER_BREAK => 25;
use constant MAX_TIMEOUTS    => 10;
use constant TIMEOUT_LENGTH  => 30; # Seconds

my $timeout    = TIMEOUT_LENGTH;
my $line_no    = 0;
my $n_timeouts = 0;
my $line;

sub print_item
{
    my($item) = @_;
    $line_no++;
    print "$item";
    print "\n" if ($line_no % DOTS_PER_LINE == 0);
    printf "%s\n", strftime("%Y-%m-%d %H:%M:%S", localtime(time))
        if ($line_no % (DOTS_PER_LINE * LINES_PER_BREAK) == 0);
}

$| = 1;     # Unbuffered output

# The foreach and while loops are cribbed from File::Tail POD.
my @files;
foreach my $file (@ARGV)
{
    push(@files, File::Tail->new(name=>"$file", tail => -1, interval => 2));
}

while (1)
{
    my ($nfound, $timeleft, @pending) = File::Tail::select(undef, undef, undef, $timeout, @files);
    unless ($nfound)
    {
        # timeout - do something else here, if you need to
        last if ++$n_timeouts > MAX_TIMEOUTS;
        print_item "@";
    }
    else
    {
        $n_timeouts = 0;  # New data arriving - reset timeouts
        foreach my $tail (@pending)
        {
            # Read one line of the file
            $line = $tail->read;
            print_item ".";
        }
    }
}

print "\n";
print $line if defined $line && $line =~ m/^Trace run finished: /; 
```

有改进的空间；特别是，超时应该是可配置的。但是，它似乎可以按我的意愿工作。需要更多的实验和调整。

似乎 $tail->read() 函数一次读取一行；这在 POD 中并不完全明显。

* * *

可悲的是，在进一步的实际使用中，我使用 File::Tail 代码的方式似乎并没有按照我需要的方式工作。特别是，一旦它停在一个文件上，它似乎就不会再次恢复。我没有花时间试图找出问题所在，而是选择了替代方案 - 自己用 C 编写代码。不到 2 小时就得到了一个带有我想要添加的花里胡哨的版本。除了调试（我使用的）File::Tail 之外，我不确定我是否能够尽快将它们放入 Perl。一个奇怪的地方：我将我的代码设置为使用 4096 字节的缓冲区；我发现我监控的构建过程中有一行超过 5000 字节长。嗯，代码仍然使用 4096 字节的缓冲区，但会为这样的超长行发出一个点。对我的目的来说已经足够好了。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-01-14T00:23:37.230

您是否尝试过[File::Tail](http://search.cpan.org/~mgrabnar/File-Tail-0.99.3/Tail.pm)来处理实际拖尾，而不是试图强制 <STDIN> 完成这项工作？

或者，如果那件作品确实有效，那么这会以什么方式失败？

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2010-02-25T13:16:39.337

该问题很可能与输出缓冲有关。如果您想获得详尽的解释，请阅读：

[http://www.pixelbeat.org/programming/stdio_buffering/](http://www.pixelbeat.org/programming/stdio_buffering/)

在我的情况下（在 RHEL 上，我想`tail -n 0 -f file | grep -m 1 pattern`在增长的文件中出现模式时立即终止），建议的 LD_PRELOADED 库没有帮助，从 Expect 包中直接使用**unbuffer实用程序也没有帮助。**

但是基于一篇博文（[http://www.smop.co.uk/blog/index.php/2006/06/26/tail-f-and-awk/](http://www.smop.co.uk/blog/index.php/2006/06/26/tail-f-and-awk/)）我发现从tail重定向输入启动在一个子shell中做了诀窍：

```
grep -m 1 pattern <(tail -n 0 -f file) 
```

不过，这并不是那么简单。在交互式 shell 中工作时，使用 SSH 远程运行相同的命令时，仍然像往常一样冻结：

```
ssh login@hostname 'grep -m 1 pattern <(tail -n 0 -f file)' 
```

我发现，在这种情况下，必须使用Expect的**unbuffer实用程序对 tail 的输出进行解缓冲：**

```
ssh login@hostname 'grep -m 1 pattern <(unbuffer -p tail -n 0 -f file)' 
```

这**不能**在交互式 shell 上使用 - unbuffer 会导致`ioctl(raw): I/O error`!

# algorithm - 我应该使用哪种算法进行信号（声音）分类？

> ID：441438
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2009-01-14T00:19:44.443
> 
>         
> 
> 标签：algorithm, audio, pattern-matching, signal-processing, pattern-recognition

**更新**这个问题以前的标题为“**给我一个简单的信号（声音）模式检测算法的名称**”

1.  我的目标是检测噪声信号中给定模式的存在。我想检测一种用麦克风记录声音的昆虫的存在。我之前以数字格式录制了昆虫的声音。

2.  我不想做语音识别。

3.  我已经在输入信号和模式之间使用卷积来确定它们的相似度。但我认为这种技术更适合离散时间（即数字通信，其中信号以固定间隔出现）并区分两个给定模式之间的输入信号（我只有一个模式）。

4.  我害怕使用神经网络，因为我从未使用过它们，而且我不知道是否可以嵌入该代码。

您能否指出一些其他方法，或者试图说服我我目前的方法仍然是一个好主意，或者神经网络可能是一种可行的方法？

**更新**我已经有 2 个很好的答案，但另一个会受到欢迎，甚至会得到奖励。

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2009-01-14T00:52:09.527

卷积的一个进步是[动态时间扭曲](http://en.wikipedia.org/wiki/Dynamic_time_warping)，它可以被认为是一个卷积算子，它拉伸和收缩一个信号以最佳匹配另一个信号。

也许更简单的方法是对样本进行 FFT 并确定您的昆虫是否有任何可以过滤的特定频率。

在更复杂但不完全是神经网络的方面，是 SVM 工具包，如[libsvm](http://www.csie.ntu.edu.tw/~cjlin/libsvm/)和[svmlight](http://svmlight.joachims.org/)，您可以将数据投入其中。

无论您尝试哪种方式，我都会花时间探索昆虫使用 FFT 等工具发出的声音的本质。毕竟，如果你能自己做的话，教计算机对声音进行分类会更容易。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-01-27T13:02:30.027

需要更多信息。

当您说噪声信号时，背景噪声是什么？初步近似，它是静止的（在统计意义上，即恒定）还是非静止的（即可能包含其他声音，例如其他动物叫声等？）

如果背景噪音是非平稳的，那么您最好的选择可能是使用称为[独立成分分析](http://en.wikipedia.org/wiki/Independent_component_analysis)的东西，它试图将给定的声音混合物分成其成分源，您甚至不需要昆虫本身的原始录音。许多 ICA 软件都链接自 Wikipedia 页面。

（编辑：ICA 是[盲源分离](http://cnl.salk.edu/~tewon/Blind/blind_intro.html)(BSS) 的一个案例，还有许多其他的 BSS 方法，它也可能有助于搜索这些方法。）

但是，如果背景噪声是固定的，那么问题就容易多了（尽管仍然非常困难）：

在这种情况下，我将使用的方法如下。分析一点噪声的幅度谱和昆虫叫声的幅度谱。如果幸运的话，昆虫的叫声通常可能与噪音处于不同的频段。如果是这样，请使用合适的高通、低通或带通滤波器过滤输入信号。

然后，您可以尝试将包含“更多能量”的过滤信号部分与（过滤的）昆虫呼叫进行比较。可能通过使用 A. Rex 建议的图像相似性算法。

**编辑**：由于您的背景噪声是非平稳的，因此我只能建议搜索[非高斯源的盲源分离](http://www.google.com/search?q=Blind+Source+Separation+of+non-gaussian+sources)可能会导致您使用更多算法。恐怕答案是**没有简单的**算法可以做你想做的事。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-01-27T15:33:04.387

听起来像一个典型的[一类分类问题](http://www-ict.ewi.tudelft.nl/~davidt/oneclass.html)，即你想在一大堆你不关心的其他事情中搜索一件事情。

您要做的是找到一组特征或描述符，您可以为原始录音的每一小段计算这些特征或描述符，然后您可以将其与干净录音产生的特征相匹配。我不认为卷积一定是坏的，尽管它对噪声相当敏感，所以它可能不是你的情况的最佳选择。在您的情况下实际可行的是合并傅立叶变换上的模式匹配。您对信号进行傅立叶变换，为您提供功率与频率图（而不是功率与时间图），然后将频率划分为频带，并将每个频带的平均功率作为特征。如果您的数据主要包含白噪声，那么您从相似长度的原始昆虫声音中获得的模式将非常接近您的参考声音的模式。[最后一个技巧已成功使用](http://vorm.net/captchas)（带有一些窗口）来破解 google 等人使用的音频验证码，以使盲人可以访问他们的网站。

顺便说一句，因为你的原始音频信号是数字的（否则用计算机处理将不起作用;-)）卷积是合适的。您应该在您的参考信号和从每个样本开始的原始输入中执行相同长度的样本之间的卷积。因此，如果您的参考信号的长度为 N，而您的原始样本的长度为 M，其中 M>=N，那么您应该在参考信号和原始输入中的 P 个样本之间执行 M-N+1=P 卷积，从 1.. P。原始样本中参考声音位置的最佳可能性是卷积分数最高的样本。请注意，这会很快变得非常耗时。

正如我在上面解释的那样，基于傅里叶变换的匹配使用来自参考样本长度两倍的原始数据中的 50% 重叠样本至少会更快（尽管不一定更好）

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T00:51:56.547

如果我是您，您会开始阅读一些有关诸如汉明窗之类的[窗函数](http://en.wikipedia.org/wiki/Window_function)的信息，这是声音识别的一个很好的起点。（当然，这与[傅里叶变换](http://en.wikipedia.org/wiki/Fourier_transformation)相结合）

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-01-27T13:51:13.500

您可以尝试匹配过滤器。虽然我从来没有真正使用过，但我听说过好东西。

另外，虽然不简单，但我认为隐马尔可夫模型（HMM，我知道你说没有语音识别，但听我说完！）会为你提供最好的结果。再说一次，我从来没有真正使用过，但是到处都有开源实现。您只需要使用现有的“干净”昆虫记录来训练它。这是一个开源实现：[通用隐马尔可夫模型库](http://sourceforge.net/projects/ghmm)。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-01-27T15:57:02.450

诚然，这不是我的专业领域，但我的第一个想法是[递归最小二乘滤波器](http://en.wikipedia.org/wiki/Recursive_least_squares_filter)——它执行自相关。它类似于您现在使用的卷积过滤器，但更高级一些。卡尔曼滤波是对此的扩展——它用于从多个噪声测量中重新生成信号，因此在这种情况下它可能没有用。我不会拒绝临时神经网络——它们在这类事情上非常有用（前提是你正确地训练它们）。  

更深入地考虑这一点，我可能会建议使用 FFT。您正在寻找的信号可能是非常带限制的，您可能会更幸运地对数据使用带通滤波器，然后使用 FFT，最后在该数据上使用简单的卷积滤波器而不是时域数据点。或者两者都做并拥有两倍的数据。我对数学不感兴趣，所以我不能告诉你使用这种方法是否会得到显着的（不是线性相关的）结果，但你唯一失去的就是时间。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-01-27T12:38:43.287

您可能对[MA Toolbox](http://www.ofai.at/~elias.pampalk/ma/index.html)感兴趣，它是相似性度量的 Matlab 实现。

我个人觉得这篇论文，[MPEG-7 中的一般声音分类和相似性](http://journals.cambridge.org/production/action/cjoGetFulltext?fulltextid=96196)，很有趣。但是，它可能在付费墙后面（我不知道），并且在实践中可能没有那么有用。

GPL-ed 框架[Marsyas](http://marsyas.sness.net/)有一个用于机器学习分类的工具，称为 kea。我的猜测是，这可能无法满足您的要求，或者需要付出太多努力才能实现。

我唯一的想法是进行傅里叶变换，有效地将你的声音转换成灰度图像。然后使用许多[图像相似性算法](http://en.wikipedia.org/wiki/Image_registration)中的一种。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-01-27T15:45:05.470

[朴素贝叶斯分类](http://en.wikipedia.org/wiki/Naive_Bayesian_classification)器在这里可能是值得的，它将声音样本分类为包含您感兴趣的物种的样本和不包含的样本。它对复杂现象非常有效；我曾经用它来确定给定的毫米波雷达数据集是否包含障碍物，例如刷子、坦克陷阱等。至于如何将连续数据分解为贝叶斯分类器的离散块，您可能只是滑行连续数据集并分解与昆虫样本长度相等的块。例如，如果您要比较的样本是 2 秒长，您可能会向鉴别器提供 0-2 秒、0.5-2.5 秒、1-3 秒等。您需要训练鉴别器，但这是常见的任何基于机器学习的解决方案的要求。

如果您的昆虫物种没有您正在寻找的单一、相对独特的声音，那么这些方法几乎是唯一可行的方法。如果您正在寻找比可能更高或更低音量的单个声音更复杂的东西，则互相关/卷积的效用有限。

有几种语言的朴素贝叶斯分类器实现，例如[nbc](http://web.cecs.pdx.edu/~timm/dm/nbc.html)。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2009-01-29T20:55:49.347

您可能需要[Wiener 滤波器](http://en.wikipedia.org/wiki/Wiener_filter)方法。

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2014-02-28T12:49:49.567

谷歌：FastICA 算法。有些可互换使用 ICA 和盲源信号分离。该算法的作者写了一本很棒的关于 ICA 的书，在亚马逊上使用的价格约为 40-60 美元。

# database - 为什么我应该使用基于文档的数据库而不是关系数据库？

> ID：441441
> 
>         
> 
> 赞同：202
> 
>         
> 
> 时间：2009-01-14T00:21:48.840
> 
>         
> 
> 标签：database, couchdb, relational, non-relational-database

为什么我应该使用像 CouchDB 这样的基于文档的数据库而不是使用关系数据库。是否存在基于文档的数据库比关系数据库更适合的典型应用程序或领域？

* * *

## 回答 #1

> 赞同：181
> 
>             
> 
> 时间：2009-01-20T22:21:48.427

可能你不应该:-)

第二个最明显的答案是，如果您的数据不是关系数据，您应该使用它。这通常表现为没有简单的方法将您的数据描述为一组列。一个很好的例子是您实际存储纸质文档的数据库，例如通过扫描办公室邮件。数据是扫描的 PDF，您有一些始终存在的元数据（扫描于、扫描于、文档类型）和许多可能存在的元数据字段（客户编号、供应商编号、订单编号、保留文件直到， OCRed 全文等）。通常您事先不知道您将在未来两年内添加哪些元数据字段。对于这种数据，CouchDB 之类的东西比关系数据库好得多。

我个人也喜欢这样一个事实，即我不需要任何 CouchDB 的客户端库，除了 HTTP 客户端，现在几乎所有编程语言都包含它。

可能最不明显的答案：如果您使用 RDBMS 没有任何痛苦，请继续使用它。如果您总是需要围绕 RDBMS 来完成工作，那么面向文档的数据库可能值得一看。

有关更详细的列表，请查看[Richard Jones 的此帖子](http://www.metabrew.com/article/anti-rdbms-a-list-of-distributed-key-value-stores/)。

* * *

## 回答 #2

> 赞同：47
> 
>             
> 
> 时间：2009-01-14T00:36:39.777

CouchDB（来自他们的[网站](http://couchdb.apache.org/docs/intro.html)）

*   一个文档数据库服务器，可通过 RESTful JSON API 访问。通常，关系数据库不是简单地通过 REST 服务访问，而是需要更复杂的 SQL API。通常这些 API（JDBC、ODBC 等）非常复杂。REST 非常简单。

*   具有平坦地址空间的 Ad-hoc 和无模式。关系数据库具有复杂、固定的模式。你定义表、列、索引、序列、视图和其他东西。Couch 不需要这种复杂、昂贵、脆弱的高级计划。  

*   分布式，具有强大的增量复制和双向冲突检测和管理功能。一些 SQL 商业产品提供此功能。由于 SQL API 和固定模式，这是复杂、困难和昂贵的。对于 Couch 来说，它看起来既简单又便宜。

*   可查询和可索引，具有使用 Javascript 作为查询语言的面向表的报告引擎。SQL 和关系数据库也是如此。这里没有什么新鲜事。

所以。为什么选择 CouchDB？

*   REST 比 JDBC 或 ODBC 更简单。

*   没有 Schema 比 Schema 更简单。

*   以一种看似简单且便宜的方式分发。

* * *

## 回答 #3

> 赞同：29
> 
>             
> 
> 时间：2009-02-15T09:47:43.040

用于愚蠢地存储和提供其他服务器数据。

在过去的几周里，我一直在玩一个 lifestream 应用程序，它会轮询我的提要（delicious、flickr、github、twitter...）并将它们存储在 couchdb 中。couchdb 的美妙之处在于它让我可以将原始数据保持在其原始结构中，而不会产生任何开销。我为每个文档添加了一个“类”字段，存储源服务器，并为每个源编写了一个 javascript 渲染类。

概括地说，每当您的服务器与另一台服务器通信时，最好使用无模式存储，因为您无法控制模式。作为奖励，couchdb 使用服务器和客户端的本机协议 - JSON 用于表示，HTTP REST 用于传输。

* * *

## 回答 #4

> 赞同：22
> 
>             
> 
> 时间：2009-01-22T03:13:33.627

快速应用程序开发浮现在脑海中。

当我不断地发展我的模式时，我总是因为必须在 MySQL/SQLite 中维护模式而感到沮丧。虽然我还没有对 CouchDB 做太多事情，但我确实喜欢在 RAD 过程中演化模式是多么简单。

当您有很多多对多关系时，您可能不想使用非关系数据库。我还没有弄清楚如何围绕这些类型的关系创建良好的 MapReduce 函数，特别是如果您需要在连接关系中包含元数据。我不确定，但我不认为 CouchDB Map 函数可以在数据库上调用自己的查询，因为这可能会导致无限循环。

* * *

## 回答 #5

> 赞同：7
> 
>             
> 
> 时间：2010-01-27T02:49:14.703

当您不需要将数据存储在每个记录具有统一大小字段的表中时，请使用基于文档的数据库。相反，您需要将每条记录存储为具有某些特征的文档。可以随时将任意长度的任意数量的字段动态添加到文档中，而无需先“修改表格”。基于文档的字段也可以包含多条数据。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2019-10-31T18:55:59.810

详细说明 smdelfin：灵活性。您可以以任何结构（非结构化和所有）存储数据，并且每个文档都可以完全不同。CouchDB 特别有用，因为使用它们的“视图”索引，您可以过滤掉特定文档并在需要数据库的这些子集时仅查询该视图。

我在以 JSON 格式存储数据的文档数据库中最大的赢家是：这是 JavaScript 的原生格式。因此，JavaScript Web 应用程序与 CouchDB 配合得非常好。我最近制作了一个使用 CouchDB 的 Web 应用程序，它速度飞快，同时还能够处理不断变化的数据结构。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2020-05-03T16:22:55.093

基于文档的数据库比关系数据库有很大的优势，因为它们不需要在能够输入任何数据之前预先定义模式。

此外，如果您的数据不是关系数据并且不能存储在表格中而是一组图像或例如报纸文章，则应该使用文档数据库。

另一个优点是在 Web 开发中易于使用基于文档的数据库。有关更深入的 NoSQL 数据库模型，请查看以下来源：[https ://arxiv.org/ftp/arxiv/papers/1509/1509.08035.pdf](https://arxiv.org/ftp/arxiv/papers/1509/1509.08035.pdf)

# c# - C# 子字符串和 ToUpper

> ID：441448
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-14T00:25:42.967
> 
>         
> 
> 标签：c#, substring

我正在使用 substring 和 IndexOf 来定位字符串中的值，但如果下面的字符串 (strOldValue) 包含不同情况下的任何字符串，我的代码将不起作用。因此，如果 strOldValue 包含 Test 或 TEST 那么我的子字符串将失败。在这种情况下如何添加 ToUpper？原谅我的无知我是.Net 的新手。

```
String strValue = strOldValue.Substring(strOldValue.IndexOf(@"test")); 
```

谢谢 C

* * *

## 回答 #1

> 赞同：16
> 
>             
> 
> 时间：2009-01-14T00:29:24.893

使用 ToUpper，可以这样完成：

```
String strValue = strOldValue.Substring(
                    strOldValue.ToUpper().IndexOf(@"TEST")); 
```

但是，最简单的方法是指定比较不应区分大小写：

```
String strValue = strOldValue.Substring(strOldValue.IndexOf(@"TEST",
          StringComparison.CurrentCultureIgnoreCase)); 
```

*IndexOf*方法的第二个*compareType*参数指定如何搜索 value 参数：使用当前或不变的区域性，使用区分大小写或不区分大小写的搜索，或者使用单词或序数比较规则（请参阅[http://msdn. microsoft.com/en-us/library/ms224425.aspx](http://msdn.microsoft.com/en-us/library/ms224425.aspx)获取完整文档）。

 ** * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T00:28:14.380

```
String strValue 
    = strOldValue.Substring(strOldValue.ToUpper().IndexOf(@"TEST")); 
```

注意：我直接回答了这个问题（“在这种情况下我将如何添加 ToUpper？”）。

这不是我编写不区分大小写的子字符串的方式。

divo/TheSoftwareJedi 的答案显然更胜一筹。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-04-12T15:46:17.063

使用`String.IndexOf(String,StringComparison)`可能是最好的答案。在某个地方使用`ToUpper()`只会创建一个额外的 String 对象，该对象必须被垃圾收集器销毁。几乎所有 String 比较方法都有一个重载，它接受一个指示如何进行比较的标志。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T00:31:23.453

```
strValue.Substring(strValue.IndexOf("TEST", StringComparison.OrdinalIgnoreCase)); 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T00:43:05.443

作为一个正则表达式爱好者，我会使用以下代码：

```
String strValue = new Regex("test.*",
       RegexOptions.IgnoreCase).Match(strOldValue).Value; 
```

# asp.net - 有没有一种简单的方法在 .NET 中使用 TinyMCE 进行拼写检查

> ID：441450
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-01-14T00:27:18.547
> 
>         
> 
> 标签：asp.net, tinymce, spell-checking

有什么方法可以在 .NET 中使用 TinyMCE 并在不安装 PHP 的情况下使用拼写检查器？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T01:04:38.753

您始终可以使用适用于 .NET 的[Netspell拼写检查器。](http://www.loresoft.com/Applications/NetSpell/default.aspx)我们将它与 TinyMCE 结合使用。它运作良好。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2014-06-01T05:37:53.690

如果您想要浏览器内部的拼写检查器，我可以通过从 tinymce:init 插件部分中删除“contextmenu”插件来实现它。

我使用 Chrome 并且还必须在 tinymce:init 中添加以下内容以启用 Chrome 的内部拼写检查器。

壁虎拼写检查：真

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2010-12-10T06:19:43.447

我也使用这个[http://www.spellchecker.net/v3/editors/tinymce.html](http://www.spellchecker.net/v3/editors/tinymce.html) TnyMCE 插件希望有所帮助

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2010-11-17T13:54:45.000

实际上有几种使用tinymce进行拼写检查的可能性：

*   拼写检查插件（您可以指定哪个外部网络地址应该检查拼写（即谷歌拼写检查））

*   firefox 拼写检查器（您需要激活配置设置“gecko_spellcheck: true”）

*   Spellcatcher（一种基于操作系统的软件，即使在浏览器中也可以进行拼写检查，但也有类似的程序）

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2015-07-22T16:00:06.287

您还可以添加`browser_spellcheck: true`选项。

**例如**

```
tinymce.init({
    browser_spellcheck: true
}); 
```

注意：我认为是 TinyMCE 4 的版本，但它适用于大多数现代浏览器。

# c - 你知道 C 语言的一个好的 REGEX 库吗？

> ID：441459
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-14T00:32:35.870
> 
>         
> 
> 标签：c, regex

我在 Ansi C 中找到了两个使用正则表达式的库：

**[轻量级 C++]**

http://students.ceid.upatras.gr/~sxanth/lwc/

这不是一个真正的正则表达式库，但我可以用它在上面写我的表达式，然后执行预处理器来获取生成的 C 代码.

**[Real Regex Lib]**

http://www.osix.net/modules/article/?id=349

但是我没有找到太多关于它的参考资料。

那么，这里有人用吗？你知道任何其他的库吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T00:40:09.240

许多项目都在使用[libpcre](http://www.pcre.org/)。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T00:39:40.193

有 POSIX 正则表达式（regex.h）：

[http://www.gnu.org/software/libtool/manual/libc/Regular-Expressions.html](http://www.gnu.org/software/libtool/manual/libc/Regular-Expressions.html)

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T00:41:32.450

[http://www.pcre.org/](http://www.pcre.org/)

Perl Compatible - 所以如果这很糟糕，我想这是一个非首发。BSD 许可证，维基百科页面 - 合理的手册页条目。

# algorithm - 字符串匹配

> ID：441476
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-14T00:40:38.037
> 
>         
> 
> 标签：algorithm, search, matching

让我解释一下问题：

1.  假设我有一个图书馆，图书馆包含很多书，每本书包含章节，每章包含字符串（字符串以点“.”开头和结尾）。

2.  再次顺序，图书馆 -> 书 -> 章节 -> 字符串。

3.  我从书籍中提取字符串，我们称它们为“书籍字符串”。

4.  我有一个系统，用户可以在搜索表单中输入一个字符串，系统应该从“书籍字符串”返回输入字符串的完全匹配。如果输入的字符串与书籍字符串中的任何字符串都不匹配，则不会返回任何内容。

我想了想，找到了一个解决方案，我将对所有书籍字符串进行 MD5 并保存散列的书籍字符串。当用户输入要搜索的字符串时，我也会对其进行散列并在散列的书籍字符串中搜索匹配项。它更便宜（每个字符串 32 或 64 个字符），比普通搜索更快，并且只返回完全匹配。

有任何意见、想法、更好的解决方案吗？

PS这样的算法叫什么名字？搜索或匹配？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T00:47:10.083

这还不错，但您应该调查一下 Lucene。它是一个以多种语言实现的公共共享软件文本索引和搜索工具，其中之一是 .Net..（您在使用什么平台/语言？）我用它在公共互联网上对网站内容进行自由文本搜索，其主要模型是在特定的细分市场中提供内容（大量杂志文章、书籍摘录等）。Lucene 对我们非常有效。

[Lucene](http://lucene.apache.org/java/docs/index.html)

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T01:21:03.603

有许多用于在字符串中搜索的算法，从像[Boyer-Moore算法这样的简单方法到像](http://en.literateprograms.org/Boyer-Moore_string_search_algorithm_%28Java%29)[后缀树](http://en.literateprograms.org/Suffix_tree_%28Java%29)这样的复杂数据结构。可以在以下位置找到这些内容的完整介绍：

*   Gusfield, Dan (1999)，关于字符串、序列和树的算法。剑桥：大学出版社。

但是，对于您的情况，将书籍文本拆分为单独的标记（单词）并将它们存储在索引中（例如，简单地存储在 Map 中，或使用完整的索引和搜索框架（如[Lucene](http://lucene.apache.org/)））可能更有意义。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T04:49:52.403

它被称为[散列](http://en.wikipedia.org/wiki/Hash_function)，可以被认为是搜索或匹配。

您应该通过比较用于生成哈希的字符串来验证您的 MD5 哈希是否正确，这样您就没有任何[误报](http://en.wikipedia.org/wiki/False_positive)。

要考虑的另一件事是，支持某种**从搜索开始可能是有益的。**  考虑

```
Mary Queen of Scots
Mary Livingston
Mary Had a Little Lamb, and other silly stories 
```

A**以搜索**Mary 开始，应该返回这三个记录并且可能更多。尽管 MD5 类型的哈希很快，但也应考虑其他答案中介绍的技术，以找到适合您情况的最佳收益/成本平衡。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T01:04:32.263

您应该将每本书的章节转换为[后缀树](http://en.wikipedia.org/wiki/Suffix_tree)。后缀树是 Trie 的一种（由 divo 提到）。

后缀树专门用于快速文本搜索。后缀树的一个优点是搜索长度为 n 的字符串是 O(n) 时间。这和你的算法想法一样好（渐近）（因为散列一个字符串需要 O(n) 时间），但更灵活，因为它甚至适用于部分句子。如果您以句点开始/结束搜索，它会简化为句子搜索。

澄清：更准确地说，您将拥有一棵后缀树。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T00:51:28.827

您可能希望使用[Trie](http://en.wikipedia.org/wiki/Trie)或其他基于树的数据结构来存储字符串数据。

> trie 还可用于替换哈希表，它具有以下优点：
> 
> *   与不完美的哈希表相比，在最坏的情况下（O(m) 时间）在 trie 中查找数据会更快。一个不完美的哈希表可能有键冲突。键冲突是不同键到哈希表中相同位置的哈希函数映射。在不完美的哈希表中，最坏情况下的查找速度是 O(N) 时间，但更常见的是 O(1)，其中 O(m) 时间花费在评估哈希上。
>     
>     
>     
> 
> *   在 trie 中没有不同键的冲突。
>     
>     
>     
> 
> *   仅当单个键与多个值相关联时，才需要类似于存储键冲突的哈希表存储桶的树中的存储桶。
>     
>     
>     
> 
> *   无需提供散列函数或更改散列函数，因为将更多键添加到树中。
>     
>     
>     
> 
> *   trie 可以通过键提供条目的字母顺序。
>     
>     
>     
> 
> 尝试也有一些缺点：
> 
> *   在某些情况下，尝试查找数据的速度可能比哈希表慢，尤其是当数据直接在硬盘驱动器或其他随机访问时间比主存储器长的辅助存储设备上访问时。
> 
> *   将所有键都表示为字符串并不容易，例如浮点数，对于同一个浮点数可以有多个字符串表示，例如 1、1.0、1.00、+1.0 等。
> 
> *   尝试的空间效率通常低于哈希表。

（见[http://en.wikipedia.org/wiki/Trie](http://en.wikipedia.org/wiki/Trie)）

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T02:44:08.380

[Trie](http://en.wikipedia.org/wiki/Trie)是最好的方法。这也称为后缀映射。使用 Trie 相对于散列的想法的优势在于，使用 Trie 可以非常轻松地显示自动完成类型语法。找到一个单词的时间是 O(n)，其中 n 是单词的长度。在 Trie 中的每个节点上，您都需要存储包含特定单词的书籍列表。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T19:58:27.327

我同意 Trie - 再加上一个，使用 soundx 算法将字符串转换为 trie id/node - 所以会考虑拼写错误

* * *

## 回答 #8

> 赞同：-1
> 
>             
> 
> 时间：2009-01-14T02:14:27.600

首先，听起来您应该使用的是数据库——这几乎正是数据库的用途。（如果您希望将其嵌入到您自己的应用程序中，请查看[SQLite](http://www.sqlite.org)，这是一种轻量级 DBMS，旨在用作嵌入式库。）

其次，您的哈希解决方案仅返回完全匹配并不完全正确......因为 MD5 摘要是 128 位，这意味着任何给定的字符串对都有 1-in-2^128 的机会产生相同的哈希值. 是的，这是一个很小的数字，但如果你有很多书，你就会有*很多*对字符串。因此，一旦您比较了哈希值，您就需要进行全文比较以消除误报。

* * *

## 回答 #9

> 赞同：-1
> 
>             
> 
> 时间：2009-01-14T00:46:58.540

这称为散列。您的方法可能有效，但不是很灵活。同样，您只会检索*完全*匹配。也有可能两个原像共享同一个图像（两个不同的字符串散列到相同的值），但这极不可能，所以这不是一个真正的问题。由于缺乏灵活性，我建议不要这样做，但如果这不打扰您，那么我想这对您有用。这与人们用于存储和验证密码的技术基本相同（除非，您显然没有使用任何“盐”值）。

# php - 在 PHP 中从 HTTP 切换到 HTTPS 时会话丢失

> ID：441496
> 
>         
> 
> 赞同：64
> 
>         
> 
> 时间：2009-01-14T00:47:06.543
> 
>         
> 
> 标签：php, session, ssl, https

当将用户发送到结帐页面时，他们会从 切换`http://sitename.com`到`https://sitename.com`。

结果，`$_SESSION`变量丢失。

该站点具有有效的 SSL 证书，该证书可能有用也可能没有用。

* * *

## 回答 #1

> 赞同：71
> 
>             
> 
> 时间：2009-01-14T03:06:10.490

当您在同一服务器上的 HTTP 和 HTTPS 服务之间切换时，您的 HTTP 会话 ID 不会传递给 HTTPS 会话。您可以通过以下三种可能方式之一将会话 ID 从 HTTP 页面传递到 HTTPS 页面来设置它：

从[PHP： session_start](http://us.php.net/session_start)：

> `session_start()`根据通过请求（例如 GET、POST 或 cookie）传递的当前会话 ID 创建会话或恢复当前会话

当您使用会话时，您通常会以`session_start()`. 如果浏览器设置了会话 ID cookie，`session_start()`将使用该会话 ID。如果浏览器没有设置会话 ID cookie，`session_start()`将创建一个新的。

如果未设置会话 ID（在您的示例中，浏览器正在为 HTTPS 会话创建新的会话 ID cookie），您可以使用该`session_id()`函数进行设置。`session_id()`还可以方便地将会话 ID 作为字符串返回。所以

```
...

$currentSessionID = session_id();

... 
```

将`$currentSessionID`变量设置为等于当前会话 ID，并且

```
...

session_id($aSessionID);

... 
```

将浏览器中的 sessionID cookie 设置为`$aSessionID`. 来自[PHP：session_id](http://us.php.net/manual/en/function.session-id.php)

这是一个包含两个脚本的示例。一种通过 HTTP 访问，另一种通过 HTTPS 访问。它们必须在同一台服务器上才能维护会话数据。

**脚本 1（HTTP）**：

```
<?php

// This script will create a session and display a link to your secure server address
// to transfer your session ID. In this example, the secure page to receive the session
// ID is located at http://www.yoursite.com/safePages/securePage.php

// Start a session using the current session ID stored in a cookie, or create
// a new session if none is set.
session_start();

$currentSessionID = session_id();

// Set a variable that will be retrieved with the HTTPS script.
$_SESSION['testvariable'] = 'It worked';

// $secureServerDomain is the domain of your secure server
$secureServerDomain = 'www.yoursite.com';

// $securePagePath is the path to the page that will receive and set the session ID.
$securePagePath = '/safePages/securePage.php'

echo '<a href="https://' . $secureServerDomain . $securePagePath . '?session="' . $currentSessionID . '">Click here to transfer your session to the secure server</a>';

?> 
```

**脚本 2（HTTPS）**：

```
<?php

// Retrieve the session ID as passed via the GET method.
$currentSessionID = $_GET['session'];

// Set a cookie for the session ID.
session_id($currentSessionID);

// Start a session.
session_start();

// Test retrieval of variable set when using HTTP.
if (!empty($_SESSION['testvariable'])) {
      echo $_SESSION['testvariable'];
} else {
      echo 'It did not work.';
}

?> 
```

为此，HTTP 和 HTTPS 服务器必须使用相同的会话数据存储基板（即，对于默认文件处理程序，运行在具有相同 php.ini 的相同物理机器上）。这里有一些安全漏洞，所以我不会使用这个代码来传输敏感信息。它只是作为一个可行的例子。

当我之前遇到这个问题时，我想出了上面的快速解决方案，但我只记得问题的原始原因。我从[http://www.example.com/page.php](http://www.example.com/page.php)转到[https://example.com/page.php](https://example.com/page.php)（注意缺少“www”）。确保[http://www.example.com/page.php](http://www.example.com/page.php)将链接到[https://www.example.com/page.php](https://www.example.com/page.php)并且[http://example.com](http://example.com)将链接到[https://example.com /page.php](https://example.com/page.php)。

**PS，我实际上并没有运行这些脚本，所以可能有一两个错字阻止它们按原样正常运行。**

* * *

## 回答 #2

> 赞同：16
> 
>             
> 
> 时间：2009-01-14T03:15:18.617

听起来会话 cookie 设置为安全的。Cookie 有一个[“安全”](http://www.cgisecurity.com/owasp/html/ch07.html#id2857913)标志，如果设置为 true，则意味着 cookie 不会发送到非 https 站点。PHP 可能将其用于其会话 cookie。您可以使用[session_set_cookie_params](http://www.php.net/session-set-cookie-params)函数或php.ini 中的[session.cookie_secure设置来更改它。](http://www.php.net/session.configuration#ini.session.cookie-secure)

* * *

## 回答 #3

> 赞同：12
> 
>             
> 
> 时间：2010-07-16T20:17:43.157

我们也有这个问题。原来是因为我们在 PHP 安装中使用了[suhosin补丁。](http://www.hardened-php.net/suhosin/)我们通过设置`suhosin.session.cryptdocroot = Off`来修复它`/etc/php.d/suhosin.ini`。

有关 suhosin 手册，`suhosin.session.cryptdocroot`请参阅[http://www.hardened-php.net/suhosin/configuration.html#suhosin.session.cryptdocroot](http://www.hardened-php.net/suhosin/configuration.html#suhosin.session.cryptdocroot)。

我们最初从这篇博客文章中找到了修复：[http](http://www.yireo.com/blog/general-news/315-switch-between-http-and-https-looses-php-session) ://www.yireo.com/blog/general-news/315-switch-between-http-and-https-looses-php-session 。

* * *

## 回答 #4

> 赞同：6
> 
>             
> 
> 时间：2011-11-15T20:43:56.030

以下解决方案假定安全和非安全服务器可以访问相同的后端服务（缓存、数据库存储等）。

在用户完成购物后将其发送到我们的结帐流程时，我们必须处理同样的问题。为了解决这个问题，我们放置了一个缓存层并缓存了所有相关数据。例如，我们将从会话值中收集产品 ID 和用户 ID，将它们序列化，创建哈希，最后使用哈希作为键将会话数据存储在缓存中。然后，我们会将用户重定向到带有 url 中的哈希的安全站点。

当用户最终访问安全站点时，我们将尝试根据哈希将数据从缓存中提取出来。然后使用用户 ID 和产品 ID，我们可以从数据库中加载所有定价和描述数据并呈现给用户以供最终结帐审查。

缓存数据易失性存在继承风险，但我们从未遇到过任何问题，因为重定向发生得很快。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T21:42:39.190

看起来您的会话 cookie 是使用安全标志创建的，但是由于会话 cookie 没有被传递，因此您的结帐页面的 url 有一些东西。

或者可能，您的会话 cookie 不安全 - 只是结帐页面的 url 不同（[http://mysite.com](http://mysite.com)与[http://www.mysite.com](http://www.mysite.com)）浏览器没有发送 cookie。

如果您想阅读更多关于从 http 切换到 https 的信息，反之亦然 - 请查看[我关于选择性 ssl 的文章](http://niftybits.wordpress.com/articles-2/selective-ssl/):-)

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2011-11-17T09:48:23.573

您可以管理 HTTP 到 HTTPS 或 HTTPS 到 HTTP 之间的会话：

1.  使用 GET 在页面之间传输会话 ID

2.  通过 POST POST 会话 ID

3.  使用文件保存会话

4.  使用 Cookie 进行会话

5.  使用数据库保存会话

下面的示例可用于使用 GET... 进行传输。

文件：http.php………………</p>

```
<?php

session_start();

$sessionID = session_id();

$_SESSION['demo'] = ‘Demo session between HTTP HTTPS’;

echo ‘&lt;a href=”https://www.svnlabs.com/https.php?session=’.$sessionID.’”&gt;Demo session from HTTP to HTTPS</a>’;

?> 
```

文件：https.php………………</p>

```
<?php

$sessionID = $_GET['session'];

session_id($sessionID);

session_start();

if (!empty($_SESSION['demo'])) {
echo $_SESSION['svnlabs'];
} else {
echo ‘Demo session failed’;
}

?> 
```

IE7：此页面包含安全和非安全项目

您必须对页面上的所有静态资源（如 css、js、图像、flash 等）使用相对路径，以避免 IE 消息安全和非安全项目...</p>

![IE消息](https://i.stack.imgur.com/kF09c.jpg)
IE消息

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2011-11-16T12:14:09.217

我建议，除了这里大多数人所说的关于传输加密信息的内容外，将其视为通过 3rd 方 API 传输敏感信息的方式。你怎么知道有人没有欺骗请求？有许多协议可以真正确认请求的真实性，具体取决于您的设置有多敏感。如果你不小心，你就会让自己的账户被盗。

即使它在同一台服务器上，请考虑：

当有人跟踪传递加密密钥的链接、表单操作等时，什么可以防止有人在访问您网站的安全版本之前对其进行嗅探？如果我在公共 WIFI 点，那也不会太牵强。我可以假装是您的站点，将请求重新路由到我自己的笔记本电脑，获取令牌，然后将访问者重定向回他们来的地方。他们会认为这是一个小故障，并且不知道。现在我可以以他们的身份登录，可能会用他们的信用卡购买价值 10,000 美元的东西，然后将其运送到其他地方。您在此处采取的谨慎程度应与敏感程度相匹配。

另外，请确保您的令牌过期（仅使用一次，在 X 秒后等），但我也会考虑在两端使用 Post-Redirect-Get 模式，即：

不要在页面上或以不安全站点的形式显示直接链接，而是显示一个链接，然后将在后端重定向（并处理所有令牌/加密内容）。当您到达安全版本时，请执行相同操作（不要将“?token=asdfjalksfjla”参数留在 URL 中；重定向它）。

因此，正式的基于令牌的系统旨在解决这个问题，但仅仅为此实施 OAuth 可能是矫枉过正。在执行之前花一些时间计划潜在的漏洞。仅仅因为**很难**猜测令牌并不意味着它是不可能的（或者不可能有冲突等），所以要相应地计划。

您可能还需要一个比 PHP 的内置处理程序更复杂的会话管理系统。我不知道您是否可以强制 PHP 在多次访问中继续会话（以这种方式处理切换协议）。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2011-11-15T19:42:13.543

您不能在不同域之间传递会话值。您必须使用 http post-get 或数据库来传递您的值。为了安全起见，您可以将所有值连接到一个字符串中并使用

```
sha1($string) 
```

并将其与您的值一起发布并计算其他页面获得的值的 sha1，然后比较哈希值。

不同域上的 Post 方法会导致浏览器显示安全消息，所以不要使用它。

将 url 用于 get 方法是不安全的，您需要在重定向页面上要求输入密码才能允许系统中的 get 参数。

如果您需要安全，请勿使用 cookie。

我建议的方法是，将值保存在数据库中并生成一个密钥，然后使用您的密钥创建重定向链接，使用具有密钥的 get 参数转发用户页面，然后将页面用户重定向到获取该密钥，获取数据并删除密钥。您可以使用 sha1 生成密钥

```
PAGE 1---
$key=sha1($allvalsconcat);
//insert your session values to a database also the key in a column
header("Location: page2.php?key=".$key);

PAGE 2---
// select from database where key=$_GET["key"];
// delete from table where key=$key 
```

这是相当安全的。

可能发生的事情：为参数“key”输入随机值以使您的网站将数据加载到内存中的脚本？

这不会发生，因为您在使用后删除了该条目。一些常见的误解是获取值是不安全的，应始终避免。

如果您想要完美的性能，您可以在 mysql 中将表引擎类型设置为“内存”。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2011-11-16T12:48:43.347

考虑对所有页面使用 HTTPS，这是避免此问题的最简单方法，它将提高您网站的安全性。

如果您不能选择所有页面的 SSL，那么您可以使用以下方法：
[使用安全 session-cookie 在 HTTP 和 HTTPS 页面之间切换](https://stackoverflow.com/questions/5843305/switching-between-http-and-https-pages-with-secure-session-cookie)。背后的想法是，您让会话 cookie 不安全（因此可用于 HTTP 和 HTTPS 页面），但有第二个安全 cookie 来处理身份验证。这是将“维护会话”和“身份验证”这两个关注点分开的好方法。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T02:29:10.907

默认情况下，我希望浏览器将与 http 和 https 的连接视为完全不同的会话。尽管约定是[http://someUrl/](http://someUrl/)和[https://someUrl/](https://someUrl/)将指向同一页面，但不能保证。您可以在端口 80 (http) 和端口 443 (https) 上运行完全不同的站点。

我不知道 PHP，但通常我不希望会话变量可以在安全会话和非安全会话之间免费使用，例如，我不希望我上次结帐时的信用卡号可用于所有后续的不安全页面访问。

原谅非权威的答案，但我想我会放弃我的 2c，因为答案不多。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T01:00:28.857

这可能是不可能的，因为 cookie 似乎正在丢失。您使用的浏览器必须认为它适用于完全不同的域。

你具体用的是什么浏览器？

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2015-07-13T16:40:22.390

你有专用IP吗？在某些共享环境中，https 和 http 是通过不同的服务器路由的，因此切换实际上会失去对 cookie 的访问权限，因为它们位于不同的域中。

解决方案是：专用IP

始终在所有页面上强制 https

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2020-02-11T16:37:44.943

我遇到了从 http 转移到 https 的问题，我能够解决这个问题，将网站 URL 从[http://example.com](http://example.com)更改为[https://www.example.com](https://www.example.com) 

将 www 添加到 URL 为我解决了这个问题。

谢谢。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2016-07-26T19:21:07.227

我有类似的问题，但是，这个解决方案对我有好处，也许将来会帮助其他人

在你的 php.ini 中添加这个

suhosin.session.cryptdocroot = 关闭

suhosin.cookie.cryptdocroot = 关闭

* * *

## 回答 #15

> 赞同：0
> 
>             
> 
> 时间：2016-09-18T06:59:07.503

我有一个解决方案..试试看。

```
$_SESSION['test'] = 'test';
session_regenerate_id(true);

header("Location: /");// the header must be sent before session close
session_write_close(); // here you could also use exit(); 
```

* * *

## 回答 #16

> 赞同：-1
> 
>             
> 
> 时间：2011-11-16T11:36:05.443

不要担心这是一种正常的行为，因为 HTTPS 是为了保证安全，它正在发挥作用。

下面是一些技巧，您可以通过这些技巧在从 HTTP 切换到 HTTPS 时保持会话。

1.  使用 GET 在页面之间传输会话 ID

2.  通过 POST POST 会话 ID

3.  使用文件保存会话

4.  使用 Cookie 进行会话

5.  使用数据库保存会话

希望你能通过我的回复有所收获。

# javascript - 当用户点击返回时，阻止 jQuery 自动完成插件忘记文本

> ID：441502
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-01-14T00:48:45.633
> 
>         
> 
> 标签：javascript, jquery, browser, autocomplete

我正在使用[jQuery 自动完成插件](http://docs.jquery.com/Plugins/Autocomplete)来获取位置列表，效果很好。但是，如果用户在提交带有自动完成文本框的页面后单击浏览器的后退按钮，则文本框为空。如果我从文本框中取消自动完成并提交并单击返回，它会记住文本。

有没有办法在页面加载时阻止自动完成清除文本框？

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-09-30T19:11:56.163

我今天遇到了同样的问题，并找到了解决方法。

```
$("#search_form").submit(function() {
    $("#location")[0].removeAttribute("autocomplete");
}); 
```

此代码将在提交表单之前删除自动完成属性。您将不得不更改选择器，以使它们与您的表单和输入相匹配。

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2009-01-14T01:36:41.357

好吧，我发现了这个问题。它似乎在 Firefox 上，而不是 IE 上，而且在技术上不是由于自动完成插件。这是因为插件将属性添加`autocomplete="off"`到文本框。

这样浏览器的自动完成历史不会与 jquery 的自动完成冲突，但在 Firefox 中，当用户单击后退按钮时，不会预先填充具有此属性的字段。

我猜没有办法解决这个问题，它似乎是默认的浏览器行为。如果有人知道不同，请发表评论。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T01:06:26.347

在`$.autocompleter`插件的函数中，有一个变量`previousValue`在解压缩版本的第 72 行调用`jquery.autocomplete.js`。此变量在初始化时设置为空字符串。

如果您有野心，您可以尝试编辑此脚本并检查文本框是否已经有值，如果有，则将 previousValue 设置为它。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2010-02-12T10:07:49.893

发布的所有解决方案都不适合我，因为我的高度 AJAX 驱动的应用程序只是在离开页面之前以其最后一个已知状态缓存（使用 autocomplete="off"），并且当用户使用后退按钮时，浏览器正确地没有'不要将前一个值插入搜索字段（因为属性自动完成设置为关闭）。因此，在这种情况下，唯一的解决方案是让我的 JS 运行，为此我必须防止缓存。我发现这个简单的片段效果很好。只需将其插入您的主页（用户在单击任何链接时都会离开），您应该可以很好地防止缓存。然后使用 JS 填充所有你想要的值，包括自动完成字段的值。

```
 window.onbeforeunload = function () {
    // Empty function, but it prevents the browser caching this anyway!
  } 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2011-09-11T14:57:21.727

尽管 heyman & Glenn 的代码有效，但在提交后仍显示表单时禁用提交可能还不够，例如因为它使用 AJAX 更新页面的另一部分。此外，当使用另一个链接（不提交表单）离开页面时，会保留自动完成属性，使用后退按钮将删除输入的值。

我使用下面的代码来解决这个问题。它仅在输入元素处于活动状态（具有焦点）时添加自动完成属性。我已将属性的删除和添加放在命名函数中，因为我有多个具有不同设置的自动完成字段。如果您只有一个自动完成字段，您可以将函数体放在事件语句中。

```
var autoCompleteFixSet = function() {
    $(this).attr('autocomplete', 'off');
};
var autoCompleteFixUnset = function() {
    $(this).removeAttr('autocomplete');
};

$('#elem').autocomplete({
    minLength : 1,
    source: '/values.php'
}).focus(autoCompleteFixSet).blur(autoCompleteFixUnset).removeAttr('autocomplete'); 
```

* * *

## 回答 #6

> 赞同：-3
> 
>             
> 
> 时间：2009-03-11T17:50:33.273

这实际上是 IE 的一种不良行为，“记住”功能应该使用服务器端语言来完成。

其中一些（ASP.NET）会自动执行此操作，除非您告诉不要这样做。

使用 PHP，您需要使用 GET 或 POST 超级变量。

如果您不使用任何服务器端语言，则可以使用 javascript 访问 GET 查询字符串，并在页面之间传递一些参数，这些参数可用于获取文本框值，然后预填充它。

# c - Linux内核（或其他低级的东西）是如何编写C的“好”例子

> ID：441505
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-01-14T00:51:01.557
> 
>         
> 
> 标签：c, linux-kernel

在“C 的最佳用途是什么”问题之后。

Linux内核似乎是一个著名且思想很好的C程序。但它是主流“最佳实践”C 的一个很好的例子吗？

* * *

## 回答 #1

> 赞同：18
> 
>             
> 
> 时间：2009-01-14T03:59:04.797

我已经准备好为此而烦恼，但 Linux 内核是一个失控的学生项目。更严重的是，从编程的角度来看，Linux 内核做得很好的是，它制定了一套非常严格的设计和编码指南，使大量人员可以做出贡献，同时仍然让所有东西组合在一起。

我信任的那些将操作系统作为他们毕生工作的人告诉我，BSD 内核是良好的 C 编程和良好的操作系统设计的一个更好的例子*。*我对伯克利的教授们了解得够多了，所以我对这种说法并不感到惊讶。

更广泛地说，操作系统内核是高度专业化的东西——内核没有什么*主流*的东西。如果您想了解良好的 C 实践示例，您可以尝试 Kernighan 和 Pike 关于[编程实践](https://rads.stackoverflow.com/amzn/click/com/020161586X)的书。或者，如果你想研究一个真实的系统，[Lua 的实现](http://www.lua.org/)足够小，你可以阅读所有内容，设计得非常好，并且*非常*便携——可以在任何带有 ANSI C 编译器的平台上运行。

为主观和争论的答复道歉:(

* * *

## 回答 #2

> 赞同：16
> 
>             
> 
> 时间：2009-01-14T00:56:09.630

你说的好例子是什么意思？我相信 Linux 内核是一个用 C 语言编写的非常好的内核，但存在一些问题，其中许多问题正在清理中。但是，就使用它作为如何编写通用 C 代码的示例而言，我认为它不太合适。阅读和理解内核会教你很多关于 C 的知识。但是你在内核中找不到任何可以谈论的库。标准库不可用。因此，例如，您将看到“printk”而不是“printf”等等。还有一些黑魔法。内核是一个非常特殊的情况。我不会用它来寻找最佳实践，比如说，如果你正在编写一些通用应用程序，比如文件管理器或数据库。

* * *

## 回答 #3

> 赞同：9
> 
>             
> 
> 时间：2009-01-14T00:55:27.460

是的。

如果您不想被内核的细节淹没，您可以从一些用 C 编写的 Linux 实用程序函数开始。有关如何获取源代码的详细信息，请参阅[此问题的答案。](https://stackoverflow.com/questions/433670/where-do-you-download-linux-source-code)

另一个阅读 C 源代码的好地方是 C 自己的[标准库](http://www.utas.edu.au/infosys/info/documentation/C/CStdLib.html)。

最后，我听说的另一个最近的 C 项目是[Git](http://git-scm.com/)。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T03:37:39.083

我建议查看 gnu 实用程序（例如，标准 unix 实用程序的源代码，例如“ls”和“awk”），因为它们将更容易理解并且更有可能以更简洁的方式编写（内核与其他类型的软件具有不同的性能需求和兼容性问题）。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T09:37:29.420

对于主流节目？不。 *nix 内核代码通常不在[用户空间](http://en.wikipedia.org/wiki/Userland_(computing))中，因此与大多数“主流”编程相比，它具有不同的约定和要求。然而，它是一些你可以学习学习的最好和最高质量的 C 代码。它有它的弱点，而且它不是完全写得很好，但在大多数情况下，它是非常有效的、干净的代码。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T01:19:28.600

它是否是“最佳实践”取决于你问的是谁。在 Windows 平台上也有很多低级 C 程序，但是如果你看一下它们（例如，来自 WINDDK 的设备驱动程序示例），你会发现微软已经成功地*发明了*另一种他们称之为 C 的语言 :-)但是，如果您想在 Windows 上开发设备驱动程序，这些可能应该被视为“最佳实践”。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T00:57:32.060

如果您是从学习 C 的角度来问，那么一开始可能会觉得太难了。就 C 的使用而言，它最适合需要可移植性和性能的应用程序。它通常用于系统级编程。但是，这样做是以牺牲抽象为代价的。因此，您必须自己完成大部分编码工作，这与 Java 甚至 C++ 等语言不同。理想情况下，您的应用程序类型应该决定语言的选择，并且使用操作系统 C 是要走的路。

了解 Linux 内核的一种方法是从一个非常旧的 linux 内核版本开始。这将包含肉并隐藏当前内核中存在的额外复杂性。这应该足以理解基础知识。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2010-07-08T16:53:10.247

我发现内核是如何编写模块化代码的一个很好的例子。尽管是 C，但它在某种程度上是面向对象的。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T03:43:28.620

一个很好的地方是查看一些正在使用的开源编译器的代码。您需要出色的数据结构和指针技能来编写编译器。

# c# - 如何在对象上实现 GetHashCode()？

> ID：441529
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-01-14T01:04:44.433
> 
>         
> 
> 标签：c#, .net

**重复**：[覆盖 System.Object.GetHashCode 的最佳算法是什么？](https://stackoverflow.com/questions/263400/what-is-the-best-algorithm-for-an-overridden-systemobjectgethashcode)

* * *

如果您编写了一个包含多种数据成员的对象，您如何智能地实现 GetHashCode()？

一位开发人员告诉我他只是对相关数据字段的哈希进行异或（^ 运算符），但我不相信这是一个“最佳实践”实现。

如果我按照自己的方式行事，就会有函数 Object.CombineHashes(Object[]) 和/或 Object.CombineHashes(int[]) 来帮助智能地构建复杂对象的散列。

你将如何编写这些函数？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T01:09:14.890

我通过将它们与管道连接起来，然后得到了它的hascode，对一堆成员进行了快速而肮脏的实现：

```
(Member1.ToString() + "|" + Member2.ToString()).GetHasCode(); 
```

就我而言，我知道我永远不会在成员中使用管道，所以我知道结果会非常好。

实际上，就我而言，我实现了 ToString 以进行调试，所以我只是使用了它：

```
this.ToString().GetHashCode(); 
```

Xors 是我经常看到的另一种方法。

# c# - 使用一次数据库调用加载业务对象层次结构

> ID：441532
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-01-14T01:05:52.963
> 
>         
> 
> 标签：c#, database, data-access-layer, business-objects

我想知道填充业务对象层次结构（父/子/孙子）结构的最佳实践来自单个数据库调用。

我可以想到几种方法来完成它，例如：

左连接我的 sql 语句中的所有关系，然后使用循环和逻辑来填充业务对象

**或者** 

使用几个 select 语句和 1 个 datareader 并使用其 NextResult() 方法遍历每个结果集并填充相应的 BO

只是想知道最好的做法是什么

我正在为我的 DAL 使用 DAAB 和 c#

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T01:55:20.227

没有通用的食谱。它取决于数据库架构、数据库大小和您的应用程序在典型场景中读取的记录数。您在这里有两个过程：

*   从数据库中获取数据

*   填充业务对象

从数据库中获取数据比在内存中创建对象要慢几个数量级。最好的方法是构造选择语句以实现最快的数据访问。

查询可以通过三种方式构建：

*   一个在单次执行中获取所有内容的大型查询 - 您将获得最复杂的 SQL，并且可能是最快的执行（取决于 DB 模式）

*   主/详细方法 - 简单查询。大量的数据库流量。仅当您获取少量记录时才可以接受，否则会非常慢。

*   混合：对层次结构的每一层进行一次查询。如果前两种方法要慢，请考虑这种方法。这种方法需要更复杂的逻辑来填充业务对象。

您应该决定哪种解决方案是可以接受的。需要考虑的一些关键点：

*   哪个 SQL 更容易创建和维护 - 一个大的可以一次读取所有内容，或者几个较小的。  

*   当您选择上一点时，您应该衡量性能并做出最终决定

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T01:39:33.253

我曾经使用多个返回的数据集，但开销和不断变化的 API 最终让我回到只使用连接来一次性返回所有数据集。

我密切关注结果集的大小，但在我遇到的任何应用程序的上下文中，这都不是问题。总的来说，我并不后悔这样做，但 YMMV。

如果父级选择子句涉及子级选择规则，则多个结果集会变得特别松散。

这种方式处理所有情况；有时将其拆分是可行的，但在某些情况下您最终会需要单组查询；并且只有一种模式很好——尤其是如果你有时被从一种模式重构到另一种模式所困。

最后，您最终会减少对数据库的访问，并且事务管理更简单。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T01:11:39.487

DataReader NextResult 是最好的，因为通过管道的数据量不会像连接方法那样快速增长。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T02:14:17.647

您是否考虑过使用诸如 NHibernate 之类的 OR 映射器？急切加载可以在一次调用数据库时完成您所要求的事情。

如果 OR Mapper 不是一个选择，那么我将投票支持 datareader.NextResultSet。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T02:25:12.023

如果所有行都来自同一个表（或看起来是），那么您可以将数据拉入具有一元关系的数据集，ADO.NET 将为您链接层次结构

# c# - C# treeview 线程安全操作

> ID：441534
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-14T01:07:19.933
> 
>         
> 
> 标签：c#, treeview, thread-safety

我正在寻找有关以安全线程方式使用树视图的信息。有没有人有这方面的经验或知道一些在线研究链接。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T01:16:37.373

从[System.Windows.Forms.TreeView 上的 MSDN 文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.treeview.aspx)：

> 此类型的任何公共**静态**（ Visual Basic 中为**Shared**）成员都是线程安全的。不保证任何实例成员都是线程安全的。

幸运的是，Windows 窗体中有一种机制可以以线程安全的方式处理来自多个线程的控件：

```
public delegate void TreeActionDelegate(WhatToDo details);

public void DoSomethingWithThisTree(WhatToDo details)
{
    // Assuming that 'this' points to a TreeView
    if (this.InvokeRequired) this.Invoke(new TreeActionDelegate(),
        new object[] { details });
    else
    {
        // The body of your function
    }
} 
```

现在您可以从任何线程调用此函数：

```
DoSomethingWithThisTree(new WhatToDo("something")); 
```

这将保证操作树的代码将在创建 TreeView 的线程中执行，因此它将是线程安全的。如果您不想从 TreeView 继承，您可以使用`treeInstance.InvokeRequired`and `treeInstance.Invoke(`)。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T01:24:07.560

谢谢...

“//你的函数的主体”这行给了我一个开始。

我总是通过这种方法将一些信息传递给GUI对象来实现这一点......我从没想过将整个函数体放在那里

谢谢

布拉德

# c# - VB/C# 中的“生成调试信息”是什么意思？

> ID：441535
> 
>         
> 
> 赞同：21
> 
>         
> 
> 时间：2009-01-14T01:07:25.783
> 
>         
> 
> 标签：c#, vb.net

VB/C# 中的“生成调试信息”是什么意思？

“none”和“pdb-only”之间的区别非常明显。但是“pdb-only”和“full”呢？

* * *

## 回答 #1

> 赞同：22
> 
>             
> 
> 时间：2009-01-14T01:23:03.880

编译器会在您构建时为您生成一个 pdb 文件，其中包含应用程序的符号，Visual Studio 调试器和外部调试器可以使用它来轻松查找出错的地方。

“完整”意味着在您构建应用程序时将生成完整的调试信息，因此代码本身将是可调试的，其中包括将`[DebuggableAttribute]`代码链接到调试信息的链接，例如符号。

“pdb-only”表示在构建时只生成 pdb 调试信息，不会将调试信息添加`[DebuggableAttribute]`到 JIT 编译器用来链接代码的编译代码中。

更多信息可以在[这里找到](https://web.archive.org/web/20090206175153/http://www.rp2c.com/blogofbob/VisualStudioTheBreakpointWillNotCurrentlyBeHitNoSymbolsHaveBeenLoadedForTheDocument.aspx) 

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2017-07-11T09:30:42.377

从[我应该将调试信息编译为“完整”还是“仅 pdb”？](https://stackoverflow.com/questions/7713514/should-i-compile-release-builds-with-debug-info-as-full-or-pdb-only)

另请参阅[https://docs.microsoft.com/en-us/cpp/build/reference/debug-generate-debug-info](https://docs.microsoft.com/en-us/cpp/build/reference/debug-generate-debug-info)

> 我会用 pdb-only 构建。您将无法将调试器附加到已发布的产品，但如果您获得崩溃转储，您可以使用 Visual Studio 或 WinDBG 检查崩溃时的堆栈跟踪和内存转储。
> 
>   
>   
> 
> 如果您使用 full 而不是 pdb-only，您将获得相同的好处，除了可执行文件可以直接附加到调试器。考虑到您的产品和客户，您需要确定这是否合理。

# php - 返回字符串第一次出现之前和之后的单词

> ID：441536
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-14T01:07:40.417
> 
>         
> 
> 标签：php, string

我有一个从搜索查询返回的文本正文，我们称之为 $body。现在，我要做的是让脚本找到第一次出现的搜索查询 $query。我知道我可以用 strripos 找到第一次出现。  

一旦找到，我希望脚本在第一次出现字符串之前返回几个单词，以及在第一次出现结束后返回几个单词。  

本质上，我正在尝试做谷歌对其搜索结果所做的事情。  

关于我应该从哪里开始的任何想法？我的问题是我一直返回部分单词。  

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T01:19:22.953

你可以：

```
$words = explode(" ", $body); 
```

在 $body 中创建一个包含所有单词的数组。

```
$index  = array_search($query, $words);  
$string = $words[$index - 1]." ".$words[$index]." ".$words[$index + 1]; 
```

但是，如果查询包含超过 1 个单词，您会遇到麻烦。

[爆炸](http://php.net/explode)- [array_search](http://php.net/array_search)

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-12-17T14:44:44.980

在我看来，您可以使用它`strpos`来查找搜索词的开头并`strlen`获取其长度，这将使您...

*   创建一个从文本开头到搜索词的数组，然后显示该数组中的最后一个单词，并且，

*   `strpos`从+之后的单词创建第二个数组`strlen`并显示该数组中的第一个单词。

或者，如果您已经掌握了搜索词前后的一些字符，如果将它们分解成一个数组，您可以提取一两个词。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T01:23:29.043

我不知道 PHP，但如果你可以使用正则表达式，你可以使用以下一个：

```
string query = "search";
int numberOfWords = 2;
Regex(
       "([^ \t]+\s+){"
     + numberOfWords
     + "}\w*"
     + query
     + "\w*(\s+[^ \t]+){"
     + numberOfWords
     + "}"
); 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T01:30:41.727

两边的几句话怎么样：

```
<?php

$subject= "Four score and seven years ago, our forefathers brought forth upon this continent a new nation";
$pattern= "/(\w+\s){3}forth(\s\w+){3}/";

preg_match($pattern, $subject, $matches);

echo("... $matches[0] ..."); 
```

给出：

```
... our forefathers brought forth upon this continent ... 
```

# c++ - 在 C++ 中从命令行处理参数的最有效方法

> ID：441547
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-01-14T01:14:42.367
> 
>         
> 
> 标签：c++, windows

在 C++ 中高效处理**命令行参数的**建议：

**注意**：仅限 Windows

```
 1:     #include <iostream.h>
 2:     int main(int argc, char **argv) 
```

而不是，例如：

```
 if ( argc != 3 )  {
      ....
 } 
```

问候

# linq-to-sql - 如何通过 LINQ to Sql 结果上的数据对分组进行 lambda？

> ID：441549
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-14T01:15:28.920
> 
>         
> 
> 标签：linq-to-sql, lambda, group-by

1.  我像这样从数据库中获取数据。

    ```
     Dim query = From t1 In TBL1 _
                 Join t2 In TBL2 On t1.ID Equals t2.ID _
                 Join t3 In TBL3 On t1.ID Equals t3.ID _
                 Group Join t4 In t1 _
                       On t1.ID Equals t4.ID _
                       Into t4_Grp = Group _
                 Select t1, t2, t3, t4_Grp 
    ```

2.  当用户执行搜索时，我可以像这样过滤查询结果。

    ```
    query = query.Where(Function(o) o.t1.ID = lngID) 
    ```

3.  上面一切正常。直到我想 lambda t4_Grp。我不知道如何在 t4_Grp 上做一个 lambda 表达式？

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2011-08-25T15:59:37.233

我过去用它来做一些权力分组。

```
private void ProducePivotAnalytic <T, K>(IEnumerable<T> colletion, Func<T, K> pivot)
{
    var grouped =
        from n in colletion
            group n by pivot(n) into g
            select new { theKey = g.Key, theValue = g };
    // do some stuff with your grouped collection.
}

ProducePivotAnalytic<List<DateTime>, DayOfWeek>(
        myDates,
            (x) => (x.DayOfWeek) ); 
```

# c++ - 枚举上的范围解析运算符特定于编译器的扩展？

> ID：441552
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-01-14T01:16:58.090
> 
>         
> 
> 标签：c++, standards

在[这个问题](https://stackoverflow.com/questions/438192/using-declaration-with-enum)上，有[一个答案](https://stackoverflow.com/questions/438192/using-declaration-with-enum#439055)指出：

> 您可以使用 typedef 使 Color 枚举类型可访问，而无需指定它的“全名”。
> 
> ```
> typedef Sample::Colour Colour;
> Colour c = Colour::BLUE; 
> ```

这对我来说听起来是正确的，但有人否决了它并留下了这条评论：

> 在枚举上使用范围解析运算符 ::（如“Colour::BLUE”）是特定于编译器的扩展，而不是标准 C++

真的吗？我相信我在 MSVC 和 GCC 上都使用过它，尽管我不确定。

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-01-14T01:50:35.930

我尝试了以下代码：

```
enum test
{
    t1, t2, t3
};

void main() 
{
    test t = test::t1;
} 
```

Visual C++ 9 编译它时出现以下警告：

> 警告 C4482：使用了非标准扩展：限定名称中使用了枚举“测试”

看起来不是标准的。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2009-01-14T02:40:36.937

**那不是标准的。**

在 C++11 中，您将能够使用[枚举类](http://en.wikipedia.org/wiki/C%2B%2B0x#Strongly_typed_enumerations)声明创建范围枚举。

对于 C++11 之前的编译器，要确定枚举的范围，您需要在结构或命名空间内定义枚举。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T01:49:37.120

在标准 c++ 中，“::”左边的东西必须是类或命名空间，枚举不计算在内。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2019-02-28T17:25:11.373

这在 C++98 中是不允许的。但是，从 C++11 开始，您可以*选择*将范围解析运算符与“旧式”枚举一起使用

```
enum E { A };

int main()
{
  A;    // OK
  E::A; // Also OK
} 
```

`A`在 C++11 及更高版本中，两种引用方式都是正确的。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T01:52:25.053

您可以做的就是创建一个与枚举同名的命名空间。这将有效地将枚举值添加到它们自己的范围中，您可以使用枚举/命名空间的名称来引用它们。当然，它仅适用于否则将存在于全局（或另一个命名空间）范围内的枚举。

还有一篇关于这个问题的文章。

# c# - 如何使用 .NET / C# 进行健壮的 SerialPort 编程？

> ID：441559
> 
>         
> 
> 赞同：26
> 
>         
> 
> 时间：2009-01-14T01:19:03.250
> 
>         
> 
> 标签：c#, .net, serial-port

我正在编写一个 Windows 服务，用于与串行磁条阅读器和中继板（访问控制系统）进行通信。

在另一个程序通过打开与我的服务相同的串行端口“中断”进程后，我遇到了代码停止工作（我得到 IOExceptions）的问题。

部分代码如下：

```
public partial class Service : ServiceBase
{
    Thread threadDoorOpener;
    public Service()
    {
        threadDoorOpener = new Thread(DoorOpener);
    }
    public void DoorOpener()
    {
        while (true)
        {
            SerialPort serialPort = new SerialPort();
            Thread.Sleep(1000);
            string[] ports = SerialPort.GetPortNames();
            serialPort.PortName = "COM1";
            serialPort.BaudRate = 9600;
            serialPort.DataBits = 8;
            serialPort.StopBits = StopBits.One;
            serialPort.Parity = Parity.None;
            if (serialPort.IsOpen) serialPort.Close();
            serialPort.Open();
            serialPort.DtrEnable = true;
            Thread.Sleep(1000);
            serialPort.Close();
        }
    }
    public void DoStart()
    {
        threadDoorOpener.Start();
    }
    public void DoStop()
    {
        threadDoorOpener.Abort();
    }
    protected override void OnStart(string[] args)
    {
        DoStart();
    }
    protected override void OnStop()
    {
        DoStop();
    }
} 
```

我的示例程序成功启动了工作线程，并且 DTR 的打开/关闭和升高导致我的磁条阅读器通电（等待 1 秒）、关闭（等待 1 秒）等等。

如果我启动超级终端并连接到同一个 COM 端口，超级终端会告诉我该端口当前正在使用中。如果我在超级终端中反复按 ENTER，尝试重新打开端口，它会在重试几次后成功。

这会在我的工作线程中导致 IOExceptions，这是预期的。但是，即使我关闭了超级终端，我的工作线程中仍然会收到相同的 IOException。唯一的治疗方法实际上是重新启动计算机。

其他程序（未使用 .NET 库进行端口访问）此时似乎可以正常工作。

关于造成这种情况的任何想法？

* * *

## 回答 #1

> 赞同：24
> 
>             
> 
> 时间：2010-07-05T01:32:39.393

@thomask

是的，Hyperterminal 实际上在 SetCommState 的 DCB 中启用了 fAbortOnError，这解释了 SerialPort 对象抛出的大多数 IOExceptions。一些 PC / 手持设备还具有默认打开错误中止标志的 UART - 因此串行端口的 init 例程必须清除它（微软忽略了这样做）。我最近写了一篇很长的文章来更详细地解释这一点（如果你有兴趣，请看[这个）。](http://zachsaw.blogspot.com/2010/07/net-serialport-woes.html)

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T01:33:25.187

您不能关闭其他人与端口的连接，以下代码将永远无法工作：

```
if (serialPort.IsOpen) serialPort.Close(); 
```

因为您的对象没有打开端口，所以您无法关闭它。

即使发生异常，您也应该关闭并处理串行端口

```
try
{
   //do serial port stuff
}
finally
{
   if(serialPort != null)
   {
      if(serialPort.IsOpen)
      {
         serialPort.Close();
      }
      serialPort.Dispose();
   }
} 
```

如果您希望该过程是可中断的，那么您应该检查端口是否打开，然后退出一段时间，然后重试，例如。

```
while(serialPort.IsOpen)
{
   Thread.Sleep(200);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T01:50:17.913

您是否尝试过在应用程序中打开端口，只打开/关闭 DtrEnable，然后在应用程序关闭时关闭端口？IE：

```
using (SerialPort serialPort = new SerialPort("COM1", 9600))
{
    serialPort.Open();
    while (true)
    {
        Thread.Sleep(1000);
        serialPort.DtrEnable = true;
        Thread.Sleep(1000);
        serialPort.DtrEnable = false;
    }
    serialPort.Close();
} 
```

我不熟悉 DTR 语义，所以我不知道这是否可行。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-01-28T06:46:53.357

# 如何进行可靠的异步通信

不要使用阻塞方法，内部帮助类有一些微妙的错误。

将 APM 与会话状态类一起使用，其实例管理跨调用共享的缓冲区和缓冲区游标，以及包装`EndRead`在`try...catch`. 在正常操作中，`try`块应该做的最后一件事是设置下一个重叠 I/O 回调并调用`BeginRead()`.

当事情出错时，`catch`应该异步调用一个委托来重新启动方法。回调实现应该在块之后立即退出，`catch`以便重新启动逻辑可以破坏当前会话（会话状态几乎肯定已损坏）并创建一个新会话。*不能*在会话状态类上实现重启方法，因为这会阻止它破坏和重新创建会话。

当 SerialPort 对象关闭时（这将在应用程序退出时发生），很可能会有一个挂起的 I/O 操作。在这种情况下，关闭 SerialPort 将触发回调，并且在这些情况下`EndRead`会抛出一个与一般的 comms shitfit 无法区分的异常。您应该在会话状态中设置一个标志以禁止`catch`块中的重新启动行为。这将阻止您的重启方法干扰自然关机。

可以依赖此架构不会意外地持有 SerialPort 对象。

restart 方法管理串行端口对象的关闭和重新打开。`Close()`在你呼唤`SerialPort`对象之后，打电话`Thread.Sleep(5)`给它一个放手的机会。其他东西可能会抢占端口，因此请准备好在重新打开它时处理这个问题。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T02:00:02.153

我试过像这样改变工作线程，结果完全相同。一旦超级终端成功“捕获端口”（当我的线程处于睡眠状态时），我的服务将无法再次打开端口。

```
public void DoorOpener()
{
    while (true)
    {
        SerialPort serialPort = new SerialPort();
        Thread.Sleep(1000);
        serialPort.PortName = "COM1";
        serialPort.BaudRate = 9600;
        serialPort.DataBits = 8;
        serialPort.StopBits = StopBits.One;
        serialPort.Parity = Parity.None;
        try
        {
            serialPort.Open();
        }
        catch
        {
        }
        if (serialPort.IsOpen)
        {
            serialPort.DtrEnable = true;
            Thread.Sleep(1000);
            serialPort.Close();
        }
        serialPort.Dispose();
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T02:13:55.680

这段代码似乎工作正常。我已经在我的本地机器上的控制台应用程序中对其进行了测试，使用 Procomm Plus 打开/关闭端口，并且程序一直在运行。

```
 using (SerialPort port = new SerialPort("COM1", 9600))
    {
        while (true)
        {
            Thread.Sleep(1000);
            try
            {
                Console.Write("Open...");
                port.Open();
                port.DtrEnable = true;
                Thread.Sleep(1000);
                port.Close();
                Console.WriteLine("Close");
            }
            catch
            {
                Console.WriteLine("Error opening serial port");
            }
            finally
            {
                if (port.IsOpen)
                    port.Close();
            }
        }
    } 
```

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T15:14:11.940

我想我已经得出结论，超级终端玩得不好。我已经运行了以下测试：

1.  以“控制台模式”启动我的服务，它开始打开/关闭设备（我可以通过它的 LED 来判断）。

2.  启动超级终端并连接到端口。设备保持打开状态（超级终端引发 DTR）我的服务写入事件日志，它无法打开端口

3.  停止超级终端，我使用任务管理器验证它已正确关闭

4.  设备保持关闭状态（超级终端降低了 DTR），我的应用程序继续写入事件日志，说它无法打开端口。

5.  我启动了第三个应用程序（我需要与之共存的那个），并告诉它连接到端口。我这样做。这里没有错误。

6.  我停止上述应用程序。

7.  瞧，我的服务再次启动，端口成功打开，LED 亮/灭。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T14:21:23.717

这个答案很长才能成为评论......

我相信，当您的程序处于 Thread.Sleep(1000) 并且您打开超级终端连接时，超级终端会控制串行端口。当您的程序唤醒并尝试打开串行端口时，会引发 IOException。

重新设计您的方法并尝试以不同的方式处理端口的打开。

编辑：关于当您的程序失败时您必须重新启动计算机...

那可能是因为您的程序并没有真正关闭，请打开您的任务管理器并查看是否可以找到您的程序服务。确保在退出应用程序之前停止所有线程。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T15:05:21.490

是否有充分的理由阻止您的服务“拥有”端口？看看内置的 UPS 服务——一旦你告诉它有一个 UPS 连接到，比如说，COM1，你就可以和那个端口说再见了。我建议您也这样做，除非对共享端口有很强的操作要求。

# c# - 如何在 C# 中将不可读的字符串转换回 UTF-8 字节

> ID：441563
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-14T01:19:59.410
> 
>         
> 
> 标签：c#, string, utf-8

我有一个字符串看起来像机场目标├⌐

我知道它是法语，我想将此字符串转换回可读格式。有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-01-14T02:13:53.543

那不是法语，“机场”的法语单词是“aéroport”。

如果要将字符串转换为可读格式，则必须知道原始字符串的编码是什么，而不是什么语言。“机场目标├⌐”是一个合法的 UTF8 字符串。

你在哪里看到这个字符串？在 Windows 命令提示符下？这显示了高 ASCII 字符的有趣字符，例如“├⌐”。命令提示符使用 CP437，而不是 UTF8，如果您有 UTF8 字符串“aimé”，它将在 CP437 中显示为“aim├⌐”。

如果这是您的情况，请尝试将字符串写入文件并在记事本中打开该文件。如果看起来正确，您的字符串是正确的，则显示它的应用程序是错误的。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2010-10-14T09:24:50.330

这在类似的情况下帮助了我：

```
string ok_string = System.Text.Encoding.UTF8.GetString(
System.Text.Encoding.Default.GetBytes(bad_string)); 
```

* * *

## 回答 #3

> 赞同：-1
> 
>             
> 
> 时间：2009-01-14T01:35:54.447

呵呵。这是简单的密码分析任务。您应该收集字符串中字母使用的统计信息。它可以是单个字母、两个或更好的树字母组。比你应该收集相同主题的大量文本的相同统计数据。然后你应该通过使用来排列法语的树形语法和你喜欢的文本并解码你的密码。当然一开始会出错，但是您可以应用字典来确定故障率并应用某种遗传算法来找到最佳马赫。

顺便说一下。如果最初的文本是 UTF-8，但被“强制”为单字节代码页文本，则应该以字节而不是符号来操作。

# php - 我怎样才能改变
tag dynamically in php based on the URL values</h1> <div id="body"><p>I want the title page to be changed so that a crawler can see it.</p> <p>The URL is of the format: public.sample.com/account/Disney</p&g

> ID：441565
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-14T01:20:12.060
> 
>         
> 
> 标签：php, meta-title, html-title

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-01-14T01:40:49.820

让您入门的超级简单示例。

```
<title><?php
if ( preg_match('/([^\/]+)\/([^\/]+)$/', $_SERVER['PHP_SELF'], $matches) ) {
    list($dummy, $profileType, $profileName) = $matches;
    $safeProfileType = htmlentities($profileType);
    $safeProfileName = htmlentities ($profileName);
    echo "This is an $safeProfileType profile for $safeProfileName";
} else {
    echo "Unknown profile!";
}
?></title> 
```

根据 Alllain Lalonde 的评论进行编辑。（希望这就是他的意思）

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T01:23:53.550

我不确定您在此处寻找的确切内容，但是要拥有动态标题，您可以执行以下操作：

```
<title><?php echo $theDynamicTitle; ?></title> 
```

# c++ - 什么时候可以在#include 指令中省略文件扩展名？

> ID：441568
> 
>         
> 
> 赞同：48
> 
>         
> 
> 时间：2009-01-14T01:21:00.453
> 
>         
> 
> 标签：c++, include, c-preprocessor, standards

我正在玩 gmock 并注意到它包含这一行：

```
#include <tuple> 
```

我会预料到`tuple.h`的。

什么时候可以排除扩展名，它是否赋予指令不同的含义？  

* * *

## 回答 #1

> 赞同：67
> 
>             
> 
> 时间：2009-01-14T02:14:02.203

C++ 标准头文件没有“.h”后缀。我相信原因是该标准会破坏许多不同的标准前实现。因此，标准委员会没有要求供应商将其现有的“iostream.h”（例如）标头更改为符合标准（这将破坏其现有用户的代码），而是决定他们将删除后缀（我相信不会那么现有的实施已经完成）。  

这样，现有的非标准程序将继续使用供应商的非标准库工作。当用户想要使他们的程序符合标准时，他们将采取的步骤之一是更改“ `#include`”指令以删除“.h”后缀。

所以

```
#include <iostream>     // include the standard library version
#include <iostream.h>   // include a vendor specific version (which by 
                        //      now might well be the same) 
```

正如其他答案所提到的，非标准库的编写者可以选择任一命名约定，但我认为他们希望继续使用“.h”或“.hpp”（正如 Boost 所做的那样），原因有几个：

1.  如果 & 当库标准化时，标准版本不会自动覆盖以前的非标准版本（很可能会导致用户代码损坏）

2.  似乎（或多或少）没有后缀的标头是标准库，而带有后缀的标头（旧的 C 标头除外）是非标准的。

请注意，当委员会将哈希映射添加到 STL 时，发生了类似的问题——他们发现已经存在许多（不同的）`hash_map`实现，所以今天没有提出一个标准的实现，它破坏了很多东西，他们称标准实现为“ `unordered_map`”。命名空间应该有助于防止这种类型的跳跃，但它似乎不够好（或使用得不够好）以允许他们在不破坏大量代码的情况下使用更自然的名称。

请注意，对于“C”标头，C++ 允许您包含 a`<cxxxxxx>`或`<xxxxxx.h>`变体。以“c”开头且没有“.h”后缀的将其声明放入`std`命名空间（可能还有全局命名空间），带有“.h”后缀的将名称放入全局命名空间（一些编译器也将名称放在名称`std`空间中-我不清楚这是否符合标准，尽管我没有看到危害）。

* * *

## 回答 #2

> 赞同：20
> 
>             
> 
> 时间：2009-01-14T01:25:44.063

如果文件被命名`tuple`，那么你需要`#include <tuple>`
如果它被命名`tuple.h`，那么你需要`#include <tuple.h>`

就这么简单。您没有省略任何扩展名。

* * *

## 回答 #3

> 赞同：15
> 
>             
> 
> 时间：2009-01-14T01:27:34.010

它包括一个简单命名为“元组”的文件——文件本身没有扩展名。

C++ 包含文件的假定标准是命名它们时不带 .h 扩展名；许多库编写者遵循这个标准（STL 等），但有些不遵循。

* * *

## 回答 #4

> 赞同：8
> 
>             
> 
> 时间：2009-01-14T02:57:14.113

没有什么特别的事情发生。该文件被简单命名为`tuple`.

原因...标准库头文件没有文件扩展名是因为`namespace`s.

命名空间是在游戏后期与 C++98 标准一起添加到 C++ 标准的，包括`std`所有标准库实体所在的命名空间。

当标准库移到`std`命名空间时，这意味着所有现有的 C++ 代码都会中断，因为所有代码都希望该库位于全局命名空间中。解决方案是不理会旧的“dot-h”头文件，并在没有扩展名的文件中提供命名空间库。

这样，旧代码`#include<iosteam.h>`可以期待一个全局的`cout`，而新代码可以`#include<iostream>`并且期待一个`std::cout`.

* * *

## 回答 #5

> 赞同：5
> 
>             
> 
> 时间：2009-01-14T02:59:31.673

除了已经发布的很好的答案之外，应该注意的是，C++ 标准不需要指令“#include `<iostream>`”来读取名为“iostream”甚至“iostream.h”的文件。它可以被命名为“fuzzball”。或者，可能不存在相应的文件，并且定义被构建到编译器中并由 include 指令激活。

* * *

## 回答 #6

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T01:35:07.647

我的理解是#include 元组将“指向” tuple.h。

看看这个：[iostream vs iostream.h](http://members.gamedev.net/sicrane/articles/iostream.html)

* * *

## 回答 #7

> 赞同：-3
> 
>             
> 
> 时间：2009-05-23T10:10:15.357

伙计们，

我认为交易是：#include <lib> 总是将 /lib/include 附加到搜索路径（.h 是**infrerred**），而 #include <lib.h> 只搜索 -I<pathname>。

请注意，我可能是错的......这就是我认为它的工作方式（在 Solaris 上的 Forte cc 中）。

# c# - 如何使用 lambda/linq 从集合中提取一些数据到对象？

> ID：441576
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-14T01:24:22.613
> 
>         
> 
> 标签：c#, .net, lambda, linq-to-objects

我有一个`IList<Animals> farmAnimals;`

这个列表有三种类型，

*   奶牛

*   羊

*   鸡

如何使用*lambda 查询*或*linq-to-objects*从列表中删除所有鸡，所以我有一个单独的鸡列表，而原始列表现在只有牛和羊。

我是否必须制作三个列表（原始列表 + 2 个新列表，已过滤），然后将原始列表清空？还是有更棘手的方法？

结果必须是

```
IList<Aniamls> chickens;
IList<Animals> farmAnimals; // only contains the cows and sheep, now. 
```

干杯！

## 澄清问题：

什么性能更高？FindAll 和 RemoveAll 与 Where 建议？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T01:47:13.067

假设：

```
public abstract class Animal {}

public class Chicken : Animal {} 
```

你可以做：

```
var chickens = animals.OfType<Chicken>().Cast<Animal>().ToList();

var nonChickens = animals.Except(chickens).ToList(); 
```

**编辑**

任何合理的答案都应该是[O(n)](http://en.wikipedia.org/wiki/Big_O_notation)，这意味着原始列表中的每个项目只处理一次。因此，我建议采用一种必要的方法：

```
var chickens = new List<Animal>();
var nonChickens = new List<Animal>();

foreach(var animal in animals)
{
    var list = animal is Chicken ? chickens : nonChickens;

    list.Add(animal);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T01:33:25.840

```
var chickens = farmAnimals.ToList().FindAll (c => c.Type == "Chicken");
farmAnimals.RemoveAll(a => a.Type=="Chicken"); 
```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T01:40:05.623

```
var chickens = farmAnimals.Where(a => a.GetType() == typeof(Chicken)).ToList();
farmAnimals = farmAnimals.Where(a => a.GetType() != typeof(Chicken)).ToList(); 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T01:44:19.530

var Chickens = farmAnimals.FindAll(a=>a is Chicken);

我有一种可怕的倾向，倾向于尽可能简单的解决方案。在这种情况下，使用 lambda 只需要 .NET Framework 2.0。LINQ 扩展方法需要 3.5。

# php - 我应该如何计算PHP中字符串开头的字符出现次数

> ID：441581
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-14T01:28:31.577
> 
>         
> 
> 标签：php, string, count, character

我能想到的最好的是：  

`strlen(preg_replace('/^([\\*]*)\s(.+)/',"$1",$line));`

^^这似乎给出了字符串的长度。^^

编辑：我认为我应该澄清我要查找的字符是'*'

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T01:41:42.017

preg_match 允许使用匹配项填充的输出参数，因此您可以简单地将匹配项的 strlen 用于模式 /^**/：

```
$matches = array();
preg_match("/^\**/", $string, $matches);
$result =  strlen($matches[0]) ; 
```

...

```
"***Hello world!*" -> 3
"Hello world!" -> 0 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T01:37:18.780

这有点奇怪，但它可能会起作用——它计算第一个字符重复的次数：

```
strlen($line) - strlen(ltrim($line, $line[0])); 
```

如果您只想从头开始删除所有星星，那么这会容易一些

```
strlen($line) - strlen(ltrim($line, '*')); 
```

# iphone - 如何检索标准 iPhone tabitem 图像？

> ID：441592
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-01-14T01:34:28.100
> 
>         
> 
> 标签：iphone, icons, tabbar

我想使用搜索、下载、联系人、设置和列表等标准图标。它们中的大多数存在于 App Store 等应用程序中，但我不知道如何检索它们。

谢谢

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-07-14T04:50:01.160

见这里：
 [http ://www.alexcurylo.com/blog/2009/01/03/extracting-sdk-icons/](http://www.alexcurylo.com/blog/2009/01/03/extracting-sdk-icons/)

> 例如，让我们决定我们希望在我们的一个选项卡上放置一个相机图像。因此，我们挖掘了模拟器资源，这些资源位于
> 
>   
>   
> 
> /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library
> 
>   
>   
> 
> 我们在上面找到了一个看起来像我们想要的东西
> 
>   
>   
> 
> /PrivateFrameworks/PhotoLibrary.framework/CameraIcon.png
> 
>   
>   
> 
> 但是等等，这并不那么容易！模拟器 SDK 中所有据称的 PNG 图像实际上都是 Apple 的 PNG 格式的古怪 iPhone 变体，所以我们必须以某种方式处理它......
> 
>   
>   
> 
> [更新：或者，另一方面，将相机图标用于与相机相关的功能实际上在苹果看来可能是[一大堆 FAIL](http://www.alexcurylo.com/2009/01/23/icon-fail/)。所以要小心你如何使用这些图标，孩子们！]

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2009-01-14T12:52:53.973

不确定您是否可以在 Interface Builder 中执行此操作，但您当然可以通过编程方式使用“系统”图标，例如：

```
[[UITabBarItem alloc] initWithTabBarSystemItem:UITabBarSystemItemDownloads tag:0]; 
```

还有许多其他图标：

```
typedef enum {
   UITabBarSystemItemMore,
   UITabBarSystemItemFavorites,
   UITabBarSystemItemFeatured,
   UITabBarSystemItemTopRated,
   UITabBarSystemItemRecents,
   UITabBarSystemItemContacts,
   UITabBarSystemItemHistory,
   UITabBarSystemItemBookmarks,
   UITabBarSystemItemSearch,
   UITabBarSystemItemDownloads,
   UITabBarSystemItemMostRecent,
   UITabBarSystemItemMostViewed,
} UITabBarSystemItem; 
```

如果你想要其他任何我想你必须自己画它们！

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-04-18T17:11:42.283

再一次，在视觉上：在 Interface Builder 中，选择您的选项卡栏或工具栏项目，然后在检查器 (⌘1) 中调出属性选项卡，在标识符下，选择您要使用的系统图标。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T08:37:01.197

每个应用程序的图标都在该应用程序的目录中。只需使用 SCP 将它们复制到您的计算机上。

例如，应用商店的图标位于`/Applications/MobileStore.app`

# c++ - 如何在 WinCE 中创建 .bmp

> ID：441599
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-14T01:36:30.607
> 
>         
> 
> 标签：c++, image-processing, windows-ce, bmp

我有一个返回原始图像的相机，这些图像可以很容易地转换为位图，可以通过以下 C# 方法（我没有写）保存到文件中。从各种来源，我已经确定图片每个像素有 8 位，并且可能是也可能不是灰度。

```
private void rawImgToBmp(byte[] imgData, String fname) {
        Bitmap bmp = new Bitmap(getWidth(), getHeight(), 
            System.Drawing.Imaging.PixelFormat.Format8bppIndexed);
        for (int i = 0; i < 256; i++)
            { bmp.Palette.Entries[i] = Color.FromArgb(255, i, i, i); }
        //Copy the data from the byte array into the bitmap
        BitmapData bmpData = 
            bmp.LockBits( new Rectangle(0, 0, bmp.Width, bmp.Height),
                          ImageLockMode.WriteOnly, bmp.PixelFormat);
        Marshal.Copy(imgData, 0, bmpData.Scan0, getWidth() * getHeight());
        bmp.UnlockBits(bmpData); //Unlock the pixels
        bmp.Save(FileName);
    } 
```

我的问题是：我将如何使用 Windows CE 4.2 的内置函数在 C++ 中编写等效方法？

erisu：感谢调色板代码，我认为它是正确的。[根据维基百科](http://en.wikipedia.org/wiki/BMP_file_format)页面，我已经手动填写了其余的结构。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T04:18:52.527

通常我使用 CreateBitmap 或 CreateCompatibleBitmap 在 Windows 中生成位图。我不熟悉 WinCE，但功能似乎存在。您的数据看起来是每像素 8 位，带有 256 个调色板，因此您很可能还需要 CreatePalette、SelectPalette 和 RealizePalette 函数。

类似（警告：未经测试的代码）：

```
HBITMAP hBmp=CreateBitmap(width, height, 1, 8, imgData);

LOGPALETTE logpal=(LOGPALETTE)new BYTE[sizeof(LOGPALETTE)+256*sizeof(PALETTEENTRY)];
logpal.palVersion=0x300;
logpal.palNumEntries=256;
int i=0;
do {  //no idea your palette's format, however it looks to be greyscale?
    logpal->mypal[i].peRed=i;
    logpal->mypal[i].peGreen=i;
    logpal->mypal[i].peBlue=i;
    logpal->mypal[i].peFlags=NULL;
while(++i<256);
HPALETTE hPal=CreatePalette(logpal);

//If your trying to display it to a window's DC called mywindowsDC
HDC hBmpDC = CreateCompatibleDC(mywindowsDC);
SelectObject(hBmpDC, hBmp);
SelectPalette(hBmpDC, hPal, TRUE);
BitBlt(mywindowsDC, 0, 0, width, height, hBmpDC, 0, 0, SRCCOPY);
RealizePalette(mywindowsDC);
//clean up
DeleteDC(hBmpDC);
delete [](BYTE *)logpal;
DeleteObject(hPal);
DeleteObject(hBmp); 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-15T06:50:52.143

这是对我有用的代码。它基于 erisu 的回答和[维基百科对 BMP 格式的描述](http://en.wikipedia.org/wiki/BMP_file_format)。对于使用此答案的其他任何人，我建议您尽可能全面地了解 BMP 格式，以便您可以相应地调整标题字段。

最后的复杂循环是我的硬件/操作系统问题的解决方法，它不会写入我提供给 fwrite 的所有数据。不过，它应该可以在任何环境中工作。

```
#if _MSC_VER > 1000
#pragma once
#endif // _MSC_VER > 1000

#define WIN32_LEAN_AND_MEAN

#include <windows.h>
#include <tchar.h>

#define NPAL_ENT 256

INT WINAPI WinMain( HINSTANCE hInstance,
                    HINSTANCE hPrevInstance,
                    LPTSTR lpCmdLine,
                    INT nShowCmd )
{
    int w = 1920, h = 1080; // My values, yours may vary

//////////////////////// File Operations ///////////////////////////////

    // Reading raw img
    FILE* f = fopen("\\FlashDisk\\raw_img.bin","r");
    if(NULL == f){printf("BAD");exit(1);}

    // Obtaining size of raw img
    fseek (f , 0L , SEEK_END);
    DWORD fsize = (DWORD)ftell (f);
    fseek (f , 0L , SEEK_SET);

    char *imgData = (char*) malloc (sizeof(char)*fsize);
    if(NULL == imgData) {printf("NOT imgData");exit(2);}

    // Copy contents of file into buffer
    DWORD result = fread(imgData,1,fsize,f);
    if (result != fsize) {
        printf ("Reading error. Expected: %d, Got: %d\n",fsize, result ); 
        if(ferror(f)){printf("An error: %d\n", ferror(f)); }
        if(feof(f)) {printf("EOF\n");}
        delete[] imgData;
        fclose(f);
        exit (3);
    }
    fclose(f);

//////////////////////// BMP Operations ///////////////////////////////

    /* A bitmap has the following components:
     *  1\. BMP file header
     *  2\. Bitmap Information (DIB) header
     *  3\. Color Palette
     *  4\. Raw Data
     */
    BITMAPFILEHEADER bmfh;
    ZeroMemory( &bmfh, sizeof( bmfh ) );
    bmfh.bfType = 0x4D42; // Magic #
    bmfh.bfSize = sizeof( bmfh ) + sizeof( BITMAPINFOHEADER )
        + NPAL_ENT*sizeof(PALETTEENTRY) + w*h; // Or total file size if w/h not known
    bmfh.bfOffBits = sizeof( bmfh ) + sizeof( BITMAPINFOHEADER )
        + NPAL_ENT*sizeof(PALETTEENTRY);

    BITMAPINFOHEADER bmih;
    ZeroMemory( &bmih, sizeof( bmih ) );
    bmih.biWidth = w;
    bmih.biHeight = h;
    bmih.biSize = sizeof(bmih);
    bmih.biPlanes = 1;
    bmih.biBitCount = 8;
    bmih.biCompression = BI_RGB;
    bmih.biSizeImage = w * h;

    int palSize = NPAL_ENT*sizeof(PALETTEENTRY);
    LOGPALETTE *logpal=(LOGPALETTE*)new BYTE[sizeof(LOGPALETTE)+palSize];
    if(!logpal) {delete [] imgData; printf("!logpal\n"); exit(4);}
    logpal->palVersion=0x300;
    logpal->palNumEntries=NPAL_ENT;
    int i=0;
    do {  // Exact palette format varies. This is what worked for me
        logpal->palPalEntry[i].peRed=i;
        logpal->palPalEntry[i].peGreen=i;
        logpal->palPalEntry[i].peBlue=i;
        logpal->palPalEntry[i].peFlags=NULL;
    } while(++i<NPAL_ENT);

    // Complete bitmap is now in memory, time to save it
    TCHAR bmpfname[80];
    wsprintf( bmpfname, (TCHAR*) TEXT( "\\USBDisk\\out.bmp" ) );

    // open the file for writing
    FILE *bmpFile = _wfopen(bmpfname,L"wb"); 
    if(!bmpFile) { delete[] imgData; delete[] logpal; exit(6); }

    // write the bitmap to file, in whatever chunks WinCE allows
    size_t totWrit = 0, offset = 0, writeAmt = 0;
    while(totWrit < bmfh.bfSize){
        if(totWrit < sizeof(bmfh)){ // File header
            offset = totWrit;
            totWrit += fwrite( ((char*)&bmfh)+offset, 1, sizeof(bmfh)-offset, bmpFile );
        }
        else if(totWrit<sizeof(bmfh)+sizeof(bmih)){ // Image header
            offset = totWrit - sizeof(bmfh);
            totWrit += fwrite( ((char*)&bmih)+offset, 1, sizeof(bmih)-offset, bmpFile );
        }
        else if(totWrit<sizeof(bmfh)+sizeof(bmih)+palSize) { // Pallette
            offset = totWrit - sizeof(bmfh) - sizeof(bmih);
            totWrit += fwrite( ((char*)&logpal->palPalEntry)+offset, 1, palSize-offset, bmpFile );
        }
        else { // Image data
            offset = totWrit - sizeof(bmfh) - sizeof(bmih) - palSize;
            if(bmfh.bfSize-totWrit >= IO_SIZE) {
                writeAmt = IO_SIZE;
            }
            else {
                writeAmt = bmfh.bfSize-totWrit;
            }
            totWrit += fwrite( &imageBuffer[offset], 1, writeAmt, bmpFile );
        }

        // Close and open after each iteration to please WinCE
        fflush(bmpFile);
        fclose(bmpFile);
        Sleep(4000); 
        bmpFile = _wfopen(bmpfname,L"ab");
        if(!bmpFile) {flog->lprintf("Couldn't reopen bmpfile"); delete [] logpal; return 0;}
    }
    fclose(bmpFile);

    if(totWrit != bmfh.bfSize) {
        printf("BMP Size mismatch: %d/%d.",totWrit,bmfh.bfSize);
        delete [] imgData;
        delete [] logpal;
        exit(-1);
    }
   // Cleanup
    delete [] imgData;
    delete [] logpal;

    return 0;

} 
```

* * *

## 回答 #3

> 赞同：-2
> 
>             
> 
> 时间：2009-09-22T16:34:36.287

我不会使用`FILE*`操作读取图像数据：你可以让它工作，但它很冗长并且容易出现问题，比如`fread()`认为 Ctrl-Z 意味着文件结束，另外你必须记住在你关闭文件时关闭文件完成的。相反，我会使用 MFC`CFile`类。这看起来像

```
 BYTE* pbyImageData = NULL;
CFile fileImage;
if(fileImage.Open(_T("\\rawimage.dat"), CFile::modeRead, NULL))
{
     pbyImageData = new BYTE[fileImage.GetLength()];
     fileImage.Read(pbyImageData, fileImage.GetLength());
} 
```

`CDIBSectionCE`使用该类在 Windows CE 中很容易处理位图。这可从 CodeGuru 获得（['A DIBSection wrapper for Win32 and WinCE'](http://www.codeguru.com/cpp/w-p/ce/bitmapsandthegdi/print.php/c3)）。使用 CDIBSectionCE，你会做这样的事情......

```
// The BITMAPINFO struct is almost completely unusable because it has
// space for a less-than-generous 1-colour palette, so I always end up
// creating a home-grown version with room for 256 colours:
struct BITMAPINFO256
{
    BITMAPINFOHEADER bmiHeader;
    RGBQUAD          bmiColors[256];
} stcBmpInfo;

// ...Fill in the BITMAPINFO structure -- bitmap size etc.
stcBmpInfo.bmiHeader.biSize = sizeof(BITMAPINFOHEADER);
stcBmpInfo.bmiHeader.biWidth = .... 
/// etc ... keep the code you have for filling in bitmap info at present

// Now load up the image into the DIB Section
CDIBSectionCE bmp;
bmp.SetBitmap((BITMAPINFO*)&stcBmpInfo, pbyImageData);

// Now write the bitmap out as a file
bmp.Save(_T("\\mybitmap.bmp"); 
```

请注意，它`CDIBSectionCE`处理所有文件头的东西。您需要做的就是读入图像数据，将其铲入 DIB 部分，然后要求其将自身保存为位图文件。

# sql - 写一个带两位小数的数字 SQL Server

> ID：441600
> 
>         
> 
> 赞同：177
> 
>         
> 
> 时间：2009-01-14T01:36:40.063
> 
>         
> 
> 标签：sql, sql-server, decimal, number-formatting

sql server 怎么写一个小数点后两位的数字？

* * *

## 回答 #1

> 赞同：234
> 
>             
> 
> 时间：2009-02-12T13:35:30.470

尝试这个

```
SELECT CONVERT(DECIMAL(10,2),YOURCOLUMN) 
```

如

```
SELECT CONVERT(DECIMAL(10,2),2.999999) 
```

将导致输出`3.00`

![在此处输入图像描述](https://i.stack.imgur.com/jmOD8.png)

* * *

## 回答 #2

> 赞同：74
> 
>             
> 
> 时间：2009-01-14T01:42:10.923

使用`Str()`功能。它需要三个参数（数字、要显示的总字符数和要显示的小数位数

```
 Select Str(12345.6789, 12, 3) 
```

显示：“12345.679”（3 个空格、5 个数字 12345、一个小数点和三个小数位 (679)。 - 如果必须截断，则舍入，（除非整数部分对于总大小来说太大，在这种情况下而是显示星号。）

共 12 个字符，小数点右边 3 个字符。

* * *

## 回答 #3

> 赞同：38
> 
>             
> 
> 时间：2009-01-14T01:40:00.663

通常，您可以通过使用参数定义数字来定义 SQL 中数字的精度。在大多数情况下，这将是`NUMERIC(10,2)`或`Decimal(10,2)`- 将列定义为具有 10 位总位数且精度为 2（小数位）的数字。

*为清晰起见进行了编辑*

* * *

## 回答 #4

> 赞同：22
> 
>             
> 
> 时间：2017-07-10T21:21:49.000

这就是今天孩子们的做法：  

```
DECLARE @test DECIMAL(18,6) = 123.456789
SELECT FORMAT(@test, '##.##') 
```

123.46

* * *

## 回答 #5

> 赞同：20
> 
>             
> 
> 时间：2011-06-19T12:10:06.663

这对我有用，并且总是保留两位小数

23.1 ==> 23.10

25.569 ==> 25.56

1 ==> 1.00

```
Cast(CONVERT(DECIMAL(10,2),Value1) as nvarchar) AS Value2 
```

[代码截图](https://i.stack.imgur.com/WyBiN.jpg)

* * *

## 回答 #6

> 赞同：16
> 
>             
> 
> 时间：2016-12-07T11:09:49.780

如果您只需要两位小数，最简单的方法是..

```
SELECT CAST(12 AS DECIMAL(16,2)) 
```

或者   

```
SELECT CAST('12' AS DECIMAL(16,2)) 
```

*输出*

```
12.00 
```

* * *

## 回答 #7

> 赞同：7
> 
>             
> 
> 时间：2016-10-05T22:16:46.823

如果您对数字**舍入**而不是截断它感到满意，那么它只是：

```
ROUND(column_name,decimals) 
```

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2017-03-27T05:17:04.583

尝试这个：

```
 declare @MyFloatVal float;

    set @MyFloatVal=(select convert(decimal(10, 2), 10.254000))

    select  @MyFloatVal

    Convert(decimal(18,2),r.AdditionAmount) as AdditionAmount 
```

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2012-04-03T15:21:49.160

将要插入的值（例如 2.99）乘以 100

然后插入除以 100 的结果，并在末尾添加 .01：

```
299.01/100 
```

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2012-02-16T14:44:13.660

这将允许总共 10 位数字，小数点后有 2 个值。这意味着它可以容纳小数点前最多8位和小数点后2位的值。

要进行验证，请将值放入以下查询中。

```
DECLARE vtest  number(10,2);
BEGIN
SELECT 10.008 INTO vtest FROM dual;
dbms_output.put_line(vtest);
END; 
```

# iphone - 通过 SDK 访问 iPhone 的蓝牙功能？

> ID：441609
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-01-14T01:40:35.857
> 
>         
> 
> 标签：iphone, bluetooth

有没有办法从 iPhone SDK 使用蓝牙？我对涉及蓝牙的应用程序有一些很酷的想法，但我没有找到任何搜索结果。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-01-14T01:49:37.120

没有！您可以提交错误报告，但这只是一个遥不可及的愿望。弄清楚如何使用 WiFi Bonjour 网络来实现您的想法。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-06-20T00:38:28.593

我认为这些天的答案*可能*是 3.0 操作系统。

问题是 API 似乎不允许完全控制蓝牙硬件。相反，您会获得打包的*用途*，例如将数据包发送到另一部 iPhone 进行点对点游戏。

这可能意味着我们不会看到支持蓝牙耳机的 VOIP 应用程序，这真是令人遗憾。

# msbuild - 如何查询 MSBUILD 文件以获取支持的目标列表？

> ID：441614
> 
>         
> 
> 赞同：24
> 
>         
> 
> 时间：2009-01-14T01:43:28.113
> 
>         
> 
> 标签：msbuild

有什么办法可以问msbuild 哪些构建目标提供了msbuild 文件支持？如果没有办法在命令提示符下做到这一点？可能它可以以编程方式完成吗？

除了解析msbuild XML之外没有其他办法吗？

* * *

## 回答 #1

> 赞同：19
> 
>             
> 
> 时间：2009-01-27T18:07:08.943

当然，MS 提供了 api 来执行此操作，而无需自己解析 xml。查找 microsoft.build.buildengine

改编自[msdn 上](http://msdn.microsoft.com/en-us/library/ms221763(VS.85).aspx)的一些 C# 代码……通常值得探索。需要引用 microsoft.build.engine dll 进行编译。用您的值替换下面的框架版本和路径。这适用于示例项目文件，尽管列表可能比您预期的要长。

```
using System;
using Microsoft.Build.BuildEngine;
class MyTargets
{        
  static void Main(string[] args)
  {
    Engine.GlobalEngine.BinPath = @"C:\Windows\Microsoft.NET\Framework\v2.0.NNNNN";
    Project project = new Project();
    project.Load(@"c:\path\to\my\project.proj");
    foreach (Target target in project.Targets)
    {
      Console.WriteLine("{0}", target.Name);
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：17
> 
>             
> 
> 时间：2014-08-06T23:03:38.060

我喜欢使用 PowerShell 的想法，但是纯 XML 解决方案不起作用，因为它只输出在*该*项目文件中定义的目标，而不是导入。当然，每个人都提到的 C# 代码非常简单，而在 .Net 4.5 中只有两行（您应该考虑将第一行添加到您的个人资料中）：

```
Add-Type -As Microsoft.Build
New-Object Microsoft.Build.Evaluation.Project $Project | Select -Expand Targets 
```

### 是的。真的。这就是全部。

由于输出非常冗长，您可能希望限制您正在查看的内容：

```
New-Object Microsoft.Build.Evaluation.Project $Project | 
    Select -Expand Targets |
    Format-Table Name, DependsOnTargets -Wrap 
```

### 然而，有一个问题。

当您像这样加载构建时，`GlobalProjectCollection`只要您打开该 PowerShell 窗口，它们就会一直存在，并且在卸载它们之前您无法重新打开它们。要卸载它们：

```
[Microsoft.Build.Evaluation.ProjectCollection]::GlobalProjectCollection.UnloadAllProjects() 
```

考虑到这一点，可能值得将其包装在一个可以接受部分和相对路径甚至管道项目文件作为输入的函数中：

```
Add-Type -As Microsoft.Build
Update-TypeData -DefaultDisplayPropertySet Name, DependsOnTargets -TypeName Microsoft.Build.Execution.ProjectTargetInstance

function Get-Target {
    param(
        # Path to project file (supports pipeline input and wildcards)
        [Parameter(ValueFromPipelineByPropertyName=$true, ValueFromPipeline=$true, Position=1)]
        [Alias("PSPath")]
        [String]$Project,

        # Filter targets by name. Supports wildcards
        [Parameter(Position=2)]
        [String]$Name = "*"

    )
    begin {
        # People do funny things with parameters
        # Lets make sure they didn't pass a Project file as the name ;)
        if(-not $Project -and $Name -ne "*") {
            $Project = Resolve-Path $Name
            if($Project) { $Name = "*" }
        }
        if(-not $Project) {
            $Project = Get-Item *.*proj
        }
    }
    process {
        Write-Host "Project: $_ Target: $Name"
        Resolve-Path $Project | % {
            # Unroll the ReadOnlyDictionary to get the values so we can filter ...
            (New-Object Microsoft.Build.Evaluation.Project "$_").Targets.Values.GetEnumerator()
        } | Where { $_.Name -like $Name }
    }
    end {
        [microsoft.build.evaluation.projectcollection]::globalprojectcollection.UnloadAllProjects()
    }
} 
```

现在你甚至不需要手动格式化表格......

## 附录：

显然，您可以使用该 Update-TypeData 将任何您想要的内容添加到输出中，例如，如果您想查看条件，或者可能是 BeforeTargets 或 AfterTargets...

您甚至可以提取嵌套信息。例如，您可以将`Update-TypeData`上面的调用替换为以下两个：

```
Update-TypeData -MemberName CallTargets -MemberType ScriptProperty -Value {
    $this.Children | ? Name -eq "CallTarget" | %{ $_.Parameters["Targets"] } 
} -TypeName Microsoft.Build.Execution.ProjectTargetInstance

Update-TypeData -DefaultDisplayPropertySet Name, DependsOnTargets, CallTargets -TypeName Microsoft.Build.Execution.ProjectTargetInstance 
```

您会看到第一个添加了一个计算的 CallTargets 属性，该属性枚举直接子代并查找 CallTarget 任务以打印其目标，然后我们只需将该 ind 包含在`DefaultDisplayPropertySet`.

**注意：**在构建任何特定目标时，需要大量逻辑才能看到将要执行的*每个*目标（为此，我们必须**递归**处理 DependsOnTargets 并且我们还需要寻找任何在*其*BeforeTargets 或 AfterTargets中具有此目标的目标（也是递归的），那是在我们执行实际上可以调用目标的任务之前，例如 CallTargets*和**MSBuild*** ......所有这些事情都可能取决于如此复杂的条件如果不实际执行它，就不可能知道会发生什么；）

* * *

## 回答 #3

> 赞同：14
> 
>             
> 
> 时间：2012-03-31T09:43:24.400

已针对 .NET Framework 4 进行了更新，因为上述内容已被弃用。导入microsoft.build.dll，代码如下：

```
using System;
using Microsoft.Build.Evaluation;
class MyTargets
{
  static void Main(string[] args)
  {
    Project project = new Project(args[0]);
    foreach (string target in project.Targets.Keys)
    {
      Console.WriteLine("{0}", target);
    }
  }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2012-10-16T22:32:35.867

我建议你使用 PowerShell：

```
Select-Xml `
    -XPath //b:Target `
    -Path path-to-build-file `
    -Namespace @{ b = 'http://schemas.microsoft.com/developer/msbuild/2003' } |
    Select-Object -ExpandProperty Node |
    Format-Table -Property Name, DependsOnTargets -AutoSize 
```

XPath 查询将查找所有`Target`元素并以表格格式显示目标名称和依赖关系。这是一个从 中选择前 10 个目标的示例`Microsoft.Web.Publishing.targets`：

```
PS C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v11.0\Web> Select-Xml `
    -XPath //b:Target `
    -Path Microsoft.Web.Publishing.targets `
    -Namespace @{ b = 'http://schemas.microsoft.com/developer/msbuild/2003' } |
    Select-Object -ExpandProperty Node |
    Sort-Object -Property Name |
    Select-Object -First 10 |
    Format-Table -Property Name, DependsOnTargets -AutoSize

Name                                    DependsOnTargets                       
----                                    ----------------                       
_CheckPublishToolsUpToDate                                                     
_CheckRemoteFx45                                                               
_CleanWPPIfNeedTo                                                              
_DetectDbDacFxProvider                                                         
_WPPCopyWebApplication                  $(_WPPCopyWebApplicationDependsOn)     
AddContentPathToSourceManifest          $(AddContentPathToSourceManifestDepe...
AddDeclareParametersItems               $(AddDeclareParametersItemsDependsOn)  
AddDeclareParametersItemsForContentPath $(AddDeclareParametersItemsForConten...
AddDeclareParametersItemsForIis6        $(AddDeclareParametersItemsForIis6De...
AddDeclareParametersItemsForIis7        $(AddDeclareParametersItemsForIis7De... 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2017-04-13T19:58:20.320

这是按执行顺序获取所有目标的代码片段。

```
 static void Main(string[] args)
    {
        Project project = new Project(@"build.core.xml");
        var orderedTargets = GetAllTargetsInOrderOfExecution(project.Targets, project.Targets["FinalTargetInTheDependencyChain"]).ToList();
        File.WriteAllText(@"orderedTargets.txt", orderedTargets.Select(x => x.Name).Aggregate((a, b) => a + "\r\n" + b));
    }

    /// <summary>
    /// Gets all targets in the order of their execution by traversing through the dependent targets recursively
    /// </summary>
    /// <param name="allTargetsInfo"></param>
    /// <param name="target"></param>
    /// <returns></returns>
    public static List<ProjectTargetInstance> GetAllTargetsInOrderOfExecution(IDictionary<string, ProjectTargetInstance> allTargetsInfo, ProjectTargetInstance target)
    {
        var orderedTargets = new List<ProjectTargetInstance>();

        var dependentTargets =
            target
            .DependsOnTargets
            .Split(';')
            .Where(allTargetsInfo.ContainsKey)
            .Select(x => allTargetsInfo[x])
            .ToList();

        foreach (var dependentTarget in dependentTargets)
        {
            orderedTargets = orderedTargets.Union(GetAllTargetsInOrderOfExecution(allTargetsInfo, dependentTarget)).ToList();
        }

        orderedTargets.Add(target);

        return orderedTargets;
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2019-03-26T21:20:57.903

如果您从命令行构建，您可以通过在构建之前设置环境变量来生成元项目文件。该文件将详细说明解决方案文件将针对的所有内容，并概述其目标顺序。

它并不是一个真正易于阅读的诊断文件，但它确实包含您可能需要的 XML 格式的所有信息。

例如来自 CMD 和典型的 VS2017 安装；用您使用的任何构建工具加载器替换第 1 行

```
call "%ProgramFiles(x86)%\Microsoft Visual Studio\2017\Enterprise\Common7\Tools\VsDevCmd.bat"
set MSBuildEmitSolution=1
call MSBuild SolutionFile.sln /t:rebuild 
```

举一个真实的例子，我制作了一个 SLN 文件，它以一个名为 的 C# 项目开头`mixed_proj`，所以我有`mixed_proj.sln`, `mixed_proj.csproj`，然后是我添加的两个 C++ 项目`ConsoleApplication1`和`DLL1`.

我已将构建依赖顺序设置为`ConsoleApplication1`仅在之后构建的位置`DLL1`

这是构建它的命令行：

```
call "%ProgramFiles(x86)%\Microsoft Visual Studio\2017\Enterprise\Common7\Tools\VsDevCmd.bat"
set MSBuildEmitSolution=1
call MSBuild miced_proj.sln /t:rebuild 
```

[Here](https://gist.github.com/the-nose-knows/b2262c96c2c1ee7d1180e55514aa8fed#file-mixed_proj-sln-metaproj) is the generated metaproject file content (*too big to paste here*)

# php - 实现下载计数器的最佳方法？

> ID：441618
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-14T01:45:21.353
> 
>         
> 
> 标签：php

假设用户单击链接以下载文件。用户获得另存为对话框，然后单击取消。你如何检测到这一点？这意味着如果用户点击取消链接或没有获得整个文件，服务器不应记录该文件已下载。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T11:14:14.950

过去我这样做过：

```
header('Content-Description: File Transfer');
header('Content-Type: application/octet-stream');
header('Content-Disposition: attachment; filename='.basename($file));
header('Content-Transfer-Encoding: binary');
header('Expires: 0');
header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
header('Pragma: public');
header('Content-Length: ' . filesize($file));
ob_clean();
flush();
readfile($file);
flush()
log()
exit; 
```

日志只应在 readfile 完成后运行，这意味着整个文件已流式传输给用户。自从我这样做以来已经有一段时间了，我不知道确切的代码在哪里，所以这可能不准确，但它应该能让你继续前进。

编辑我在 php.net 上找到了上面的代码，它或多或少是我所描述的，这种方法**应该**有效。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T02:03:03.597

我认为某些 HTTPd 在请求完成之前不会将文件记录到访问日志中。您可以尝试编写解析日志、greps 文件名并计算行数的内容。

编辑：刚刚尝试使用 nginx。证实了我的理论。我相信 Apache 也是如此。

编辑#2：为什么要修改这个？根据 SO 上的 dupe-link，这实际上是正确的答案。我的立场是正确的。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T02:18:15.267

当服务器发送文件时，它不仅会立即通过网络流式传输，而且必须在客户端和服务器之间传递确认数据包，一次将文件发送出一个块。

所要做的就是拥有某种以托管方式将文件发送给用户的过程，这样您就可以在文件的“最后一个”块刷新给用户的任何地方挂钩一个事件。

现在授予，用户可能永远不会收到最后一个块，但是如果他们要求最后一个块（这是 ack 数据包正在做的事情），那么他们或者底层网络协议已经接受他们已经收到了之前的所有块最后一个块，并且可以继续发送最后一个块。

现在假设

1.  您的网络服务器*没有*缓冲。

2.  当您的网络服务器在中继您发送的信息时阻止您的程序执行时。

所有人都需要一个像这样的简单结构：（伪代码）。

```
1: Open File $foo; 
2: Loop while $foo is not EOF
     3: read  700kilobits from file $foo; 
     4: print 700kilobits of read data to web server
     5: execute webserver 'flush' which blocks until flush is complete. 
     6: <-- Loop
7: If all chunks of 700kilobits were read before user aborted transaction
     8: report file was downloaded. 
```

**编辑** [Unkwntech](https://stackoverflow.com/questions/441618/best-way-to-implement-a-download-counter#442618)的答案实际上与我自己的相同。

然而，他的回答是 PHP 特定的，我想提供一个更通用的语言解决方案，主要是因为我对 PHP 产生了厌恶，并且不愿意为它编写代码并设置一个 Web 服务器并测试它是否有效只是为了证明我从经验中知道的一点。

抱歉在这方面太懒了。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T01:59:26.490

你在说任何文件吗？如果它是一个程序，您可以让它在安装时调用服务器？除此之外，我同意乔纳森的观点，不确定您是否可以访问它。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T02:08:24.507

一种方法是编写一些 PHP 来处理实际交付作为 $_REQUEST 参数提供的相关文件。该脚本将完成记录下载的实际工作

# asp.net - 什么是类型
Web.config 中的部分？

> ID：441621
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-14T01:46:48.263
> 
>         
> 
> 标签：asp.net, web-config, types, location

我期待在“System.Web.Configuration”命名空间中找到该部分，就像其他 Web.config 部分一样

“位置”驻留在哪个名称空间下，该部分的类型是什么？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T02:28:30.130

我认为[System.Configuration.ConfigurationLocation](http://msdn.microsoft.com/en-us/library/system.configuration.configurationlocation.aspx)是您正在寻找的。

# firefox - Firefox 中的复选框表单验证

> ID：441622
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-14T01:46:51.837
> 
>         
> 
> 标签：firefox, forms, checkbox

复选框的表单验证似乎只在 IE 中工作......？有人有它在 FF 中工作的样本吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T02:59:55.790

```
var isChecked = document.forms['myform'].elements['mycheckbox'].checked;
if (!isChecked) {
  alert('You must agree');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T01:52:04.803

嗯...您的问题并不完全清楚。

如果它是检查中的表单验证，那么你不应该做这个服务器端吗？这将是独立于浏览器的。

如果您正在使用 Javascript 进行任何表单验证，然后将其传递给服务器，您还必须始终检查服务器端...一个简单的 http 请求很容易弄乱一个没有验证的系统。

如果您有一个用于验证表单的 Javascript 库，那么提供更多详细信息可能是一个好主意。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T03:04:05.987

要获得您的元素（复选框）值，您可以使用更兼容跨浏览器的东西....

var CheckBox = document.all ? document.all["checkbox"] : document.getElementById("checkbox"); var isChecked = CheckBox.checked;

# javascript - 如何使用 JavaScript 检测鼠标右键单击+粘贴？

> ID：441631
> 
>         
> 
> 赞同：47
> 
>         
> 
> 时间：2009-01-14T01:51:51.887
> 
>         
> 
> 标签：javascript, jquery

有没有办法检测右键单击，然后在 IE 和 Firefox 上粘贴 JavaScript？

更新：

我决定使用 Jquery 来做到这一点：

```
$('#controlId').bind('paste', null, function() {
    // code
}); 
```

这不完全是我想要的（因为它会在“ctrl + v”以及“右键单击 + 粘贴”中触发，但我可以解决它。

在 Chrome、Firefox 3、IE 7 和 IE 6 上对其进行了测试，并且可以正常工作

* * *

## 回答 #1

> 赞同：81
> 
>             
> 
> 时间：2011-11-17T12:22:10.103

我喜欢这个解决方案：

```
$('#txt_field').bind('input propertychange', function() {
   console.log($(this).val());
}); 
```

* * *

## 回答 #2

> 赞同：23
> 
>             
> 
> 时间：2010-01-18T22:21:32.567

```
$('#controlId').bind('paste', null, function(e) {
    if(!e.keyCode){
       /*
          since no key was down at the time of the event we can assume it was
          from the toolbar or right click menu, and not a ctrl+v
       */
    }
}); 
```

* * *

## 回答 #3

> 赞同：9
> 
>             
> 
> 时间：2009-01-14T01:58:30.157

使用 IE 你有 onpaste

使用 Mozilla，您可以查看 oninput 和

```
elementReference.addEventListener("DOMCharacterDataModified", function(e){ foo(e);}, false); 
```

没有简单的解决方案。

埃里克

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2014-10-13T11:15:42.973

使用`setTimeout()`，设置小超时，直到 .val() 函数可以被填充。

```
$(document).on('paste blur keyup', '#controlId', function(event) {
    var element = $(event.target);
    setTimeout(function() {
        var text = $(element).val();
        // do something with text
    }, 100);
}); 
```

来源：[捕捉粘贴输入](https://stackoverflow.com/questions/686995/catch-paste-input)

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2015-03-24T15:29:22.490

我在 IE8 中遇到了同样的问题。Chrome 允许我识别右键单击粘贴，但 IE8 没有。

我能够使用 Aaron 描述的鼠标离开功能解决 JQUERY 的问题，但这里是代码：

```
for IE8:
    $( "#field" ).mouseleave(function() {
                doStuff());
            });

for Chrome:
    $('#field').bind('input',function() {
                doStuff();
            }); 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2015-08-04T15:30:36.963

我做了以下仅在 mouseup 上触发的操作：

```
onmouseup="jQuery(this).on('paste',function(event){setTimeout(function(){alert('Paste detected!');},100);});" 
```

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2019-12-18T21:59:41.197

如果您使用的是 vue，您可以像这样发出并传递粘贴的值：

```
 <v-text-field 
   @input="$emit('rightclickpaste',$event)"  
 >             
 </v-text-field> 
```

* * *

## 回答 #8

> 赞同：-1
> 
>             
> 
> 时间：2009-06-03T00:12:30.947

您可以尝试的廉价黑客（有效）是：

*   jQuery 的 mouseleave 函数。

我在 IE8 中注意到，如果您右键单击文本框，然后选择“粘贴”，它会延迟“鼠标离开”事件，直到粘贴完成。所以它会在粘贴后立即触发！:) 对我有用，实际上让我完全摆脱了麻烦。

这仅适用于 Intranet 应用程序，我尚未在 Firefox 等中进行测试。

干杯

# javascript - 在 3rd 方域上调用 JavaScript

> ID：441636
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-14T01:53:30.760
> 
>         
> 
> 标签：javascript, dom, cross-domain-proxy

我想编写一些 javascript 并让它调用我从 3rd 方域加载的页面的 DOM。这可以做到吗？[这](https://stackoverflow.com/questions/335817)看起来像是我已经尝试过使用的`IFRAME`，但似乎不起作用。这些是其他方式吗，比如让 FF 直接运行一些 javascript 而不是作为页面的一部分？

我知道这有各种各样的安全问题，但我是编写代码的人，也是唯一会运行它的人。

* * *

背景故事：我正在尝试自动化一些网站迭代。

我的第`IFRAME`一次通过没有奏效，因为来自`file:////....`的网页与`http://whatever.com`. 惊喜，惊喜。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T06:30:34.087

如果我正确理解了这个问题，由于您遇到的域限制，您可能无法单独使用 Javascript 来完成。但是，如果您对使用 shell 脚本或任何脚本语言有一定的了解，那应该没问题，您需要做的就是调用古老的 curl。

PHP 中的示例：

```
<?php
$url = "http://www.example.com/index.html";
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.5) Gecko/20041107 Firefox/1.0');
$fp = curl_exec($ch);
curl_close($ch);
?> 
```

差不多就是这样。您在 $fp 变量中有实际的 HTML 代码。所以，总而言之，我要做的是向 PHP 编写一个小的 Javascript Ajax 函数，该函数执行 curl，然后通过 echo 将 $fp 变量返回给 Javascript 回调，然后可能将其插入到文档中（使用 innerHTML 或DOM）和 bam，你可以访问所有的东西。或者你可以只用 PHP 解析它。无论哪种方式，如果您通过 curl 进行操作，应该可以正常工作。希望有帮助。

**编辑**：经过一番思考，我似乎记得 Safari 删除了 localhost 的跨域限制。在研究了更多之后，我找不到任何支持我的这个理论的文档，所以我挖得更深一点，找到了一个更好（虽然更黑客）的方法来通过 Apache 完成这整个混乱，如果你正在使用它（哪个你可能是）。

> Apache 的 mod_proxy 将接受“/foo”之类的请求，并将请求通过隧道传送到某个远程目标，例如“<a href="http://dev.domain.com/bar" rel="nofollow noreferrer">http: //dev.domain.com/bar”。最终结果是您的 Web 浏览器认为您已经调用了[http://localhost/foo](http://localhost/foo)，但实际上您正在从远程服务器发送和检索数据。安全隐患已解决！

例子：

```
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_http_module modules/mod_proxy_http.so
LoadModule rewrite_module modules/mod_rewrite.so 
```

假设我想访问[http://dev.domain.com/remote/api.php](http://dev.domain.com/remote/api.php)上的文件。您可以将以下所有内容放入 a 中：

```
# start mod_rewrite
RewriteEngine On
ProxyRequests Off
<Proxy>
   Order deny,allow
   Allow from all
</Proxy>

ProxyPass /apitest/ http://dev.domain.com/remote/api/
ProxyPassReverse /apitest/ http://dev.domain.com/remote/api/
RewriteRule ^/apitest/(.*)$ /remote/api/$1 [R] 
```

[来源](http://www.ghidinelli.com/2008/12/27/how-to-bypass-cross-domain-restrictions-when-developing-ajax-applications)

**更多编辑：**

看到你想如何避免整个服务器设置的事情，我在 Safari (Mac) 上使用 IFRAME 试了一下，它工作，至少对于我尝试过的域：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">
<html>
<head>
</head>
    <body>
        <iframe src="http://www.stackoverflow.com/"></iframe>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T02:03:23.720

阅读[书签](http://en.wikipedia.org/wiki/Bookmarklet)。基本思想是您创建一个书签，该书签执行一些 Javascript 代码，该代码将 Javascript 动态注入到您浏览器中当前加载的页面中。大多数网页剪辑应用程序都是这样做的。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T02:02:58.650

JavaScript 具有相同的域策略。您将无法访问其他域。这是为了保护你有黑客/坏人。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T06:34:14.300

看看[Selenium 远程控制](http://seleniumhq.org/projects/remote-control/)。服务器充当浏览器绕过同域策略的代理：

> 最后，Selenium 服务器充当客户端配置的 HTTP 代理，位于浏览器和您的网站之间。这允许支持 Selenium 的浏览器在任意网站上运行 JavaScript。

您可能会考虑应用相同的方法并编写自己的代理，或者甚至是一个简单的 Web 应用程序来回显来自其他域的页面（请参阅[Dave 的回答](https://stackoverflow.com/questions/441636/invoke-javascript-on-3rd-party-domain#442108)）。

或者，只需使用 Selenium 进行自动化。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T06:50:26.543

有一种方法可以放松 Firefox 的域安全性。

1 将此行添加到 Firefox 的 user.js。

user_pref("signed.applet.codebase_principal_support", true);

2 将此行添加到需要跨域的每个 javascript 函数中。

netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead UniversalBrowserWrite");

3 Firefox 第一次尝试跨域时，它会警告您尝试跨域并提示您的许可。

好消息，阻止它与 Firefox 3 一起使用的错误似乎已修复。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T02:06:30.937

我不确定我是否完全理解这个问题，也许你可以更详细地描述这种情况......但我猜如果你跨域访问，你会遇到跨站点脚本安全问题。

所以..

也许签出`document.domain`可以在大多数浏览器中跨窗口对象启用脚本访问的属性。

两个站点必须通过同一个主域访问，但可以有不同的子域，只要`document.domain`在两个站点上都设置为域的“主”部分。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T06:23:46.270

不是我想的，而是：[iMacros](https://addons.mozilla.org/en-US/firefox/addon/3863)可能会做一些我想做的事情。

看起来它似乎有点有限，而且文档有点金光闪闪而且肉不够。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2010-03-22T18:02:14.173

[http://en.wikipedia.org/wiki/JSONP#JSONP](http://en.wikipedia.org/wiki/JSONP#JSONP)

# .net - F# - 按间隔将列表分解为串联的字符串

> ID：441651
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-14T01:59:12.840
> 
>         
> 
> 标签：.net, f#, list, concatenation, fold

我有一个电子邮件地址列表，我需要向每个地址发送电子邮件通知。我想一次在 25 个地址块中执行此操作。在像 F# 这样的函数式语言中有什么快速的方法可以将 25 个电子邮件地址“折叠”（连接）在一起……每个电子邮件地址用分号分隔。我知道 .NET 中有 String.Split 方法，但我需要一次连接 25 个。

在 F# 中执行此操作的最优雅方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2011-06-28T18:35:04.890

如果这仍然相关，这里是一个使用分隔符连接字符串序列但不转换为数组的函数。

```
open System
open System.Text

/// Join a sequence of strings using a delimiter.
/// Equivalent to String.Join() but without arrays.
let join (items : seq<string>) (delim : string) =
    // Collect the result in the string builder buffer
    // The end-sequence will be "item1,delim,...itemN,delim"
    let buff = 
        Seq.fold 
            (fun (buff :StringBuilder) (s:string) -> buff.Append(s).Append(delim)) 
            (new StringBuilder()) 
            items

    // We don't want the last delim in the result buffer, remove
    buff.Remove(buff.Length-delim.Length, delim.Length).ToString() 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T07:34:40.073

这是一种分成最多 N 组的方法：

```
// break a sequence up into a sequence of arrays, 
// each of length at most 'n'
let Break n (s:seq<_>) =
    seq {
        use e = s.GetEnumerator()
        while e.MoveNext() do
            let i = ref 0
            yield [|
                yield e.Current
                i := !i + 1
                while !i < n && e.MoveNext() do            
                    yield e.Current
                    i := !i + 1 |] } 
```

然后你的解决方案就像

```
let Sendmail addr = printf "%A\n\n" addr
let allMails = [for i in 1..25 -> sprintf "a%i@example.com" i]
allMails 
|> Break 5
|> Seq.map (fun arr -> System.String.Join(";", arr))
|> Seq.iter Sendmail 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-15T08:32:48.223

Seq 模块有一个窗口函数，但它给你一个滑动窗口，所以对这个问题没有好处。

这是我的版本，我没有测试性能与其他答案的比较，但它更漂亮（我认为！）

```
//Add an "extension function" to the Seq module
module Seq = 
    let rec chunks n (s:#seq<_>) =
        seq {
                 if Seq.length s <= n then
                    yield s
                 else
                    yield Seq.take n s
                    yield! chunks n (Seq.skip n s)           
            }

//Make curried version of String.Join
let join sep (s:#seq<string>) = System.String.Join(sep, Array.of_seq s)

//Compose the bits together
let mailMerge n = Seq.chunks n >> Seq.map (join ";")

//Test
mailList |> mailMerge 25 
```

您也可以查看[Array 切片](http://blogs.msdn.com/chrsmith/archive/2008/12/09/f-zen-array-slices.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T03:50:01.867

它不是很漂亮，但它有效：

```
let breakWords separator groupSize (input : string) =
    let words = input.Split([| separator |])
    let arraySize = words.Length / groupSize + (if words.Length % groupSize > 0 then 1 else 0)
    let groups = Array.init arraySize (fun index ->
        let startIndex = index * groupSize
        let endIndex = Math.Min(startIndex + groupSize - 1, words.Length - 1)
        words.[startIndex .. endIndex])
    groups |> Seq.map (fun x -> String.Join(";", x)) 
```

# linux - 如何在 Microsoft VC 中使用这个 makefile？

> ID：441668
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-14T02:07:21.793
> 
>         
> 
> 标签：linux, makefile, nmake

在下面的程序中，有两件事我不明白。

1.  如何在 Microsoft VC 中使用这个 makefile？

2.  为什么有一个'？在'='之前？

程序：

```
ifeq ($(TARGET_COMPILER),ms)    

   include ../makefile.ms.config

    DBG?= /Zi

    OPT= /Ox

    CXXFLAGS += $(COMMON_FLAGS) $(OPT) $(DBG)

    EEXT = $(EXT).dll

    ifeq ($(GZSTREAM),1)

      MYLIBS = src/gzstream/lib/zlib.lib

    endif
endif 
```

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-01-14T02:14:34.587

1.  Visual Studio 中有一个 makefile 项目类型。否则，makefile 很可能打算由 nmake 运行。

2.  语法 '?=' 表示如果变量未定义，则赋值。也就是说，如果没有设置DBG，则将其设置为/Zi，否则如果DBG 当前值为/Z0，则保持当前值为/Z0。

# winforms - 视觉继承在 VS2008 中有效吗？

> ID：441676
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-14T02:11:23.597
> 
>         
> 
> 标签：winforms, visual-studio-2008, visual-inheritance

我有一个基本形式。我将“确定”和“取消”按钮放在表单的右下方，并将它们锚定在底部和右侧。

继承的表单不支持 Ok 和 Cancel 按钮的锚属性。以下是复制的确切步骤。

1-使用位于底部/右侧的按钮创建一个基本表单。将其固定在底部，对。3- 创建一个继承自步骤 1 中创建的基本表单的新表单。 4- 增加（在设计器中）第二个表单的高度或宽度。5- 你会看到按钮没有完全移动，因此破坏了它的锚属性。

我做错了什么，还是 VS2008 根本不尊重基本表单上控件的锚属性？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T02:48:53.833

嗯，按照你的步骤，完美地工作......

确保继承的表单没有覆盖设计器中的某些属性......我的“继承表单”只有这个：

```
private void InitializeComponent()
{
    this.SuspendLayout();
    // 
    // Form2
    // 
    this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
    this.ClientSize = new System.Drawing.Size(296, 154);
    this.Name = "Form2";
    this.ResumeLayout(false);

} 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T04:53:34.143

一定要观察一些非常顽皮的事情正在发生。基类的私有字段的属性正在发生变化（Location 属性），这完全违反了 .NET 可访问性规则。这在一定程度上是可行的，但是一旦你运行你的项目就会耗尽气体。修复很简单，将按钮的修饰符属性从私有更改为受保护。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T02:23:06.083

这个对我有用。

你是如何创建继承形式的？我去

1.  建造

2.  添加新 -> Windows 窗体

3.  选择 Windows 窗体

4.  选择继承的表单

5.  选择原始表格

按钮按预期移动。

# c# - 如何检索程序集的限定类型名称？

> ID：441680
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-01-14T02:13:27.150
> 
>         
> 
> 标签：c#, asp.net, configuration, powershell, web-config

如何生成程序集限定类型名称？

例如，在配置成员资格提供程序时，我必须在“类型”属性中为“SqlMembershipProvider”（在此示例中，我从某处复制以下配置）提供程序集限定类型名称。

您如何生成该程序集限定类型名称？是否每次都必须通过检查程序集类型手动输入？

> ```
> <membership>
>   <providers>
>     <clear />
>     <add name="AspNetSqlMembershipProvider"
>            type="System.Web.Security.SqlMembershipProvider,
>            System.Web, Version=2.0.0.0,
>            Culture=neutral,PublicKeyToken=b03f5f7f11d50a3a"
>            connectionStringName="LocalSqlServer"/>
>   </providers>
> </membership> 
> ```

***[更新]***：[更简单的 PowerShell 版本](https://stackoverflow.com/questions/622902/powershell-tips-tricks-for-net-developers/622976#622976)

```
PS>([System.String]).AssemblyQualifiedName
System.String, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089 
```

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-01-14T02:39:24.523

这是一个[非常方便的工具](http://www.lennybacon.com/CommentView,guid,d571c376-42d0-427a-a7d0-ef9d22eab52c.aspx)（带有源代码的 shell 扩展），用于通过右键单击任何程序集将完全限定名称复制到剪贴板。

**更新**：在看到 dance2die 的评论后，想到了组合一个示例 powershell 脚本来将类型名称导出到 csv 文件。

```
> [System.Reflection.Assembly]::LoadWithPartialName("System.Web")

> [System.Web.Security.SqlMembershipProvider] | select {$_.UnderlyingSystemType.AssemblyQualifiedName } | export-csv c:\typenames.csv 
```

使用 C#，如果要生成具有所有引用集的程序集限定类型名称，使用反射构建测试脚本很容易。

```
using System;
using System.Reflection;
........

Type ty = typeof(System.Web.Security.SqlMembershipProvider);
string fullname = ty.AssemblyQualifiedName;
//"System.Web.Security.SqlMembershipProvider, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T02:21:06.277

查找该信息的最简单方法是使用[Reflector](http://www.red-gate.com/products/reflector/)，加载程序集，然后`Name`从程序集的清单中复制出来。在上面的窗口中选择您的程序集时，清单信息将显示在 Reflector 的底部窗格中。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2015-03-05T08:58:13.690

好的，就像 Gulzar Nazim 写的那样使用它

$ String typeName = typeof(AssemblyName.ClassName).AssemblyQualifiedName);

为您提供全名，您可以在 type.getType() 中使用它；这对我有用，不再为空

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T02:30:12.107

AFAIK 完全限定类型名称包含在类名称和程序集签名中。我不认为你可以生成它......

类型是命名空间。

您可以在 AssemblyInfo.cs 中设置的版本（删除 * 以保持相同）

您在项目属性中设置的公钥令牌。

这是我记得的

获取程序集限定名称的其他方法可能是：

```
class Program
    {
        static void Main(string[] args)
        {
            string assemblyPath = args[0];
            Assembly loadedAssembly = Assembly.LoadFrom(assemblyPath);
            Module[] modules = loadedAssembly.GetModules();
            Console.WriteLine("Assembly: " + loadedAssembly.GetType().Name);
            foreach (Module module in modules)
            {
                Console.WriteLine("Module: {0}\nFullyQualifiedName: {1}", module.Name, module.FullyQualifiedName);
                Type[] types = module.GetTypes();
                foreach (Type type in types)
                {
                Console.WriteLine("Type: {0}\n FullName: {1}", type.Name, type.FullName);    
                }
            }
            Console.ReadLine();
        }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2016-11-15T14:24:57.067

在命令中使用添加类型：

```
add-type -assemblyname "system.example" 
```

# linq - Linq-to-Sql 是否缺少任何主要功能？

> ID：441684
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-14T02:14:08.707
> 
>         
> 
> 标签：linq, linq-to-sql

Linq-to-Sql 缺少哪些主要功能？

*   与其他主要 SQL 数据库引擎（MySQL 等）的兼容性

*   映射多对多关系

*   还有其他人吗？

我已经在 DAL Heart 开发了一个带有 Linq-to-Sql 的大型项目。我之前没有使用关系数据映射器进行开发，所以它是来自数据集的学习曲线。但是我没有发现任何使用 Linq-to-Sql 无法解决的重大问题。我的测试得出结论，它比 Linq-to-Entities 快得多。

那么 Linq-to-Sql 缺少哪些主要功能呢？

我想我想问的是是否停止了 Linq-to-Sql 的开发 - 这有关系吗？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-15T04:12:50.450

*   对急切加载的良好支持

*   高级映射（即不是类和表之间的一对一映射）

*   使用数据库更改刷新映射的能力

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T04:02:45.413

[也许最缺的就是未来](http://codebetter.com/blogs/david.hayden/archive/2008/10/31/linq-to-sql-is-dead-read-between-the-lines.aspx)

我倾向于同意我链接到的这篇文章，MS 说 Linq to SQL 将会有持续的发展，但他们的行动（或更具体地说是非行动）讲述了一个不同的故事。MS 当然希望你赌的是 Linq to Entities。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-07-30T04:50:22.440

首先，它没有死。尽管它在 4.0 中没有获得任何新功能，但他们已经修复了许多错误和怪癖，我相信他们会继续这样做。

查看 .net 4.0 的 Linq-to-SQL 更改列表：http: 

[//damieng.com/blog/2009/06/01/linq-to-sql-changes-in-net-40](http://damieng.com/blog/2009/06/01/linq-to-sql-changes-in-net-40)

IMO 他们没有接触太多核心可能是一件好事 - 它是可靠的，高效的并且在大多数情况下会生成非常好的 SQL，因此任何大手术都会冒着破坏一些好东西的风险。设计器和运行时中缺少的一些位可以用螺栓固定或解决。

此外，最初在 MSFT 编写 L2S 的人 Matt Warren 编写了一个“版本 2”，他已在他的博客和 codeplex.com 上作为开源 (MS-PL) 发布。他称其为 IQToolkit，但我想将其称为 L2Sv2 ... :)

请访问：http: 

[//blogs.msdn.com/mattwar/](http://blogs.msdn.com/mattwar/) 

[http://www.codeplex.com/IQToolkit/](http://www.codeplex.com/IQToolkit/)

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2010-01-08T06:22:34.983

Linq to SQL 对多层架构的支持并不容易。

实体框架从一开始就是为了支持分布式场景而设计的。虽然在 .Net 3.5 EF 中并不完全存在（至少以自动方式），但它为进一步改进奠定了基础。因此，在 .Net 4.0 中，EF 将 T4 模板添加到代码生成自我跟踪实体和 DTO。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-06-16T14:00:17.560

几个月来，我一直在大量使用 linq to sql。我发现的唯一问题是，在存储过程和以编程方式生成的结果的混合中添加谓词将尝试在计算编程结果之前将查询推送到 SQL。这很容易通过首先调用 .ToList() 来解决。

每隔一段时间，我都希望有一个 Linq to Entity 功能，但是 linq to sql 完成了我想要的 95%。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T04:56:26.383

我最近一直在开发一个使用它的系统。我设计它所连接的数据库的同事也为它完成了一些 L2S 编码。他（不停地）抱怨的两件事是：

1/ 没有根据某些条件进行批量删除的烘焙方式。L2S 最终将单独删除行，这是非常低效的。有许多博客讨论了各种解决方法。

2/ 更新需要查询对象、更新对象然后提交更改的繁琐机制，即不需要初始查询。如果您知道一行的键，您应该能够直接更新它而无需事先查询。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-07-30T06:05:34.837

我不认为它已经死了。我认为它会得到解决，当前的问题可能会消失。但我不认为它会比现在更多。有关系吗？我个人认为不会。我认为这个框架很好。我发现 L2S 的两个主要问题是无法轻松分离实体和笨拙的更新机制。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T02:27:53.907

除非微软可以在速度和简单性方面使实体框架比 linq to sql 更好，否则恕我直言。

# jquery - 找到下一个不是立即的元素？

> ID：441687
> 
>         
> 
> 赞同：21
> 
>         
> 
> 时间：2009-01-14T02:14:32.433
> 
>         
> 
> 标签：jquery, traversal

我想在类计数器之后找到第一个 span 元素，代码如下：

```
<div class="counter"></div>
<p></p>
<span></span> 
```

看起来 next() 函数只找到紧邻的下一个元素，所以是这样的：

```
$(".counter").next("span") 
```

不会工作。我一直在使用的方式有点冗长，我想知道是否有更短的方式，就是这样：

```
$(".counter").nextAll("span").eq(0) 
```

我认为`closest()`jQuery 3 中的方法可以解决问题，但我使用的是 1.2.6——有没有更好的方法来做到这一点（我只是用`next()`错了吗？）

* * *

## 回答 #1

> 赞同：17
> 
>             
> 
> 时间：2011-08-24T22:20:21.410

类似于标记的答案，但使用 :first 选择器看起来更干净一些：

```
$('.counter').nextAll('span:first') 
```

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2009-03-18T20:56:53.850

我认为你的方法是最好的方法。如果你觉得它看起来不太好，就把它变成一个插件：

```
jQuery.fn.firstAfter = function(filter){
 return this.nextAll(filter).eq(0);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T02:35:49.677

我认为该`siblings()`功能是您正在寻找的。尝试这样的事情：

```
$(".counter").siblings("span"); 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T02:35:35.420

我不确定最接近的方法是否可以解决问题，但如果是这样......也许你可以从 1.3 中提取最接近的方法并将其转换为插件？

我还没有机会尝试这个，但试一试。它不会伤害：

```
(function($) {
  $.fn.closest = function (selector) {
    return this.map(function(){
      var cur = this;
      while ( cur && cur.ownerDocument ) {
        if ( $(cur).is(selector) )
          return cur;
        cur = cur.parentNode;
      }
    });
  }
})(jQuery); 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T02:48:01.073

尝试这样的事情：

```
$(".counter ~ span:first"); 
```

希望有帮助！

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-03-19T14:54:50.700

$(".counter + span")

# javascript - 如何存储与网页任何部分相关的用户反馈？

> ID：441689
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-14T02:14:39.097
> 
>         
> 
> 标签：javascript, jquery, feedback

我希望用户能够双击屏幕上的任意位置以显示允许提交有关该地点的反馈的表单。

我可以想到2个解决方案：

1.  存储 X,Y 坐标。由于并非所有浏览器都支持 X,Y 坐标，因此必须排除这一点。

2.  使用 Jquery 将详尽的 html 实体列表绑定到 dblClick 事件，如下所示：

    ```
    $(document).ready(function() {
    $("p,label,input,textarea").bind("dblclick", function(e) {
        $("#feedback_form").show();
    }); 
    ```

    });

因此，在上面的示例中，当双击任何 p、label、input 或 textarea 时，将显示反馈表单（为简单起见，我的示例中不包含传递被双击项目 ID 的代码）。

所以 2 并不完美，但它似乎可以解决对受支持的 html 实体列表的任何反馈。

我忽略了一些更简单的解决方案吗？

另外，如果我选择 2，双击是参与此反馈表的最佳方法，还是您会推荐其他活动？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T02:16:24.833

您应该能够编写/获取一个命中测试函数，以查看双击鼠标光标时的 DOM 元素，然后将评论/反馈文本与所选元素的 ID 相关联

这假设您的所有 DOM 元素都有唯一的 ID

（并且您的用户知道他们可以做到这一点！）

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T02:25:54.737

我建议不要在网站上设置*任何*可评论的位置，而是允许对特定元素进行评论。例如，如果它是一个博客，您可以将每个段落用作可以评论的元素。如果它是代码存储库，则可以将注释添加到单独的代码行中。

看看[The Django Book 是如何评论段落的](http://www.djangobook.com/en/2.0/chapter01/)。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T02:49:50.850

我希望你的大部分布局都使用 <div> 和 <table> 标签。正如 Steven 建议的那样，为每个块元素或作为网页不可或缺的一部分的任何其他元素（可能是图像）关联唯一的 id。

有一个与块/布局元素关联的 onclick 事件以打开另一个窗口或 javascript 弹出窗口，捕获元素 id 并在弹出窗口中有一个表单，用户可以在其中提交他们的反馈。

我还建议一个 onmouseover 甚至与所有这些元素相关联，并显示一个工具提示，指示用户可以留下有关该布局小部件/元素的反馈。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T09:46:34.427

你可以这样做：  

您想要评论的块有一个“可评论”类并有一个 id。

下面的脚本是适用于 W3C 兼容浏览器的大纲，即需要使用 attachEvent 和全局事件对象。

事件的传播不会被取消，因此可评论块中的可评论块将每个触发一次事件。

事件的默认操作也不会取消，因此双击的文本仍将突出显示 - 也许您的对话框可能具有“单击转义以取消”操作？

```
function CommentDialog() {
    //this is a fake CommentDialog object constructor
    this.display = function( id ) {
        alert( 'you want to comment on the block with id: '+id+', which is outlined in red' );
    } 
}

window.addEventListener( 'dblclick', function(e){ 
    var target = e.target;
    while( /commentable/.test( target.className ) == false ) {
        // if we've hit the body tag then bomb out
        if( target == document.body ) {
            return;
        }
        target = target.parentNode;
    }
    target.style.border = '1px solid red';
    var cmt = new CommentDialog();
    cmt.display( target.id );
 }, false ); 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-01-15T11:31:38.550

我有点喜欢第二种解决方案，但我不会将该函数附加到某些 html 实体，而是附加到一个定义良好的 div 上，例如：

```
$(document).ready(function() {
    $("div .commentable").each().bind("dblclick", function(e) {
        $("#feedback_form").show();
});
}); 
```

所以你只需要包装你想要评论的所有元素`<div class="commentable"> .. </div>`

使用第一个解决方案，如果您希望页面的每个地方都有反馈，而不仅仅是指定的元素，JQuery 可以帮助您

```
jQuery(document).ready(function(){
   $().click(function(e){
      alert(e.pageX +', '+ e.pageY);
   }); 
}) 
```

有关更多信息，请参阅[JQuery 文档](http://docs.jquery.com/Tutorials:Mouse_Position)。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T07:51:42.410

双击不好，因为在大多数浏览器中，您可以通过双击来选择单词。

相反，页面上应该有一些特殊的地方，您可以单击以提供反馈。请参阅 Soviut 的答案以获取一个很好的示例。

# domain-driven-design - 业务逻辑应该放在领域还是服务中？

> ID：441692
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-01-14T02:15:00.873
> 
>         
> 
> 标签：domain-driven-design

假设您有一个域实体用户，并且您希望支持用户将商品添加到他们的购物车的能力。现在，我们要确保购物车中的商品是唯一的，因此我们在 User 类中创建以下函数：

```
function AddItemToCart(Item item)
{
    // Add business logic to make sure item is unique
} 
```

这很好用。但是，如果我们现在还想在将商品添加到购物车时向用户发送电子邮件怎么办？我们可以将它添加到 AddItemToCart 中，但它需要将某种 IEmailer 依赖项注入到 User 类中。

另一种方法是创建一个服务来处理此事务（例如 ShoppingCartService），该服务将执行业务逻辑并发送电子邮件。然而，这导致了一个相当贫乏的领域（即 User 类只不过是 getter/setter）

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T03:59:14.453

作为用户域逻辑的一部分的逻辑应该留在用户中。这可能涉及也可能不涉及向用户实体注入服务。我认为这取决于服务是否是 User 类的业务逻辑的一部分，以及这样做是否符合您的普遍语言。

我会这样写：

```
class ShoppingCartService
{
    private EmailService emailer;

    public void addItemToUserCart(User u, Item i)
    {
        u.addItemToCart(i);
        this.emailer.sendEmailTo(u, "Item " + i.toString() + " was added to your cart");
    }
} 
```

[这个相关的问题](https://stackoverflow.com/questions/437067/domain-objects-and-services#437431)进行了讨论，您可能会觉得有帮助。

我还建议您尽可能限制 getter 和 setter 的范围以减少耦合。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T02:25:16.720

“然而，这导致了一个相当贫乏的领域（即 User 类只不过是 getter/setter）”

用户不是整个域。

您有购物车、物品和`Cart.add()`将物品放入购物车的复杂功能。  

那么如果 User 类看起来很简单怎么办？

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T02:18:03.957

保持方法不变，然后创建一个服务类来处理事务。当调用服务类方法时，您可以在那里注入您的电子邮件逻辑。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T11:18:25.583

在大型系统中，用户类最终会拥有许多不同类型的操作。班级可能会变得太大。为了避免这种情况，应该有其他类为用户做事。

# ruby-on-rails - “魔术”有什么问题？

> ID：441717
> 
>         
> 
> 赞同：34
> 
>         
> 
> 时间：2009-01-14T02:31:02.887
> 
>         
> 
> 标签：ruby-on-rails, django, black-box

我正在尝试决定是使用 Rails 还是 Django 大师来为我创建一个 Web 应用程序。我被推荐使用 Django，因为它使用较少的“魔法”。然而，从我的角度来看，Rails 的“魔力”似乎是一件好事，因为它可以使我的承包商的开发更加简洁，从而减少我的计费时间。我知道 Django 的优势可能是更精细的控制，但我怎么知道我是否需要这个控制？“魔法”是否存在固有问题？

* * *

## 回答 #1

> 赞同：81
> 
>             
> 
> 时间：2009-01-14T06:22:08.317

好吧，考虑一下 Rails 的一些“魔法”：当你编写一个控制器类时，它的方法可以访问某些变量和某些其他类。但是这些变量和类既不是由您正在查看的 Ruby 代码文件中的任何内容定义或导入的；Rails 在幕后做了很多工作，以确保它们会自动出现。当你从控制器方法返回某些东西时，Rails 会确保将结果传递给适当的模板；您不必编写任何代码来告诉它要使用哪个模板、在哪里可以找到它等等。

换句话说，就好像这些事情是通过“魔法”发生的；你不必抬起手指，它们就发生在你身上。

相比之下，当您编写 Django 视图时，您必须导入或定义您计划使用的任何内容，并且您必须明确地告诉它要使用哪个模板以及模板应该能够访问哪些值。

Rails 的开发人员认为，这种“魔法”是一件好事，因为它可以让您更轻松地快速完成某些工作，并且不会让您厌倦很多细节，除非您想深入了解并开始覆盖某些东西。

Django 的开发人员认为，这种“魔法”是一件坏事，因为并没有真正节省那么多时间（`import`在宏伟的计划中，一些语句并不是什么大不了的事），并且具有以下效果：隐藏真正发生的事情，使得更难弄清楚如何覆盖东西，或者如果出现问题更难调试。

当然，这两种立场都是有效的，而且通常人们似乎只是自然地倾向于其中一种。那些喜欢“魔法”的人聚集在 Rails 或试图模仿它的框架周围，那些不聚集在 Django 或试图模仿它的框架周围的人（从更广泛的意义上说，这些立场有点刻板印象 Ruby 和 Python开发人员；Ruby 开发人员倾向于以一种方式做事，Python 开发人员倾向于以另一种方式做事）。

从长远来看，它可能不会对你所说的你关心的因素产生巨大的影响——计费时间——所以让你的开发人员选择他或她最喜欢的任何东西，因为这样更有可能得到对*你*有用的结果。

* * *

## 回答 #2

> 赞同：36
> 
>             
> 
> 时间：2009-01-14T02:33:05.737

当您不了解魔术时，就会出现主要问题。这可能导致任何事情，从严重绝育的应用程序到零星的致命崩溃。

* * *

## 回答 #3

> 赞同：23
> 
>             
> 
> 时间：2009-01-14T06:27:25.200

魔法是伟大的，直到某些东西破裂。然后，您必须弄清楚所有这些技巧是如何工作的。

更多信息，请阅读 Joel Spolsky 的[泄漏提取定律](http://www.joelonsoftware.com/articles/LeakyAbstractions.html)

* * *

## 回答 #4

> 赞同：13
> 
>             
> 
> 时间：2009-01-14T03:07:11.220

魔术混淆了功能。它隐式地而不是显式地创建行为，这样程序员就不需要了解行为是如何工作的，更重要的是，他们不需要了解如何去改变它。

当编码人员完全掌握了他们正在使用的代码库时，“魔法”可以极大地提高生产力。但是，当使用具有高度复杂性的第三方系统（如 Web 框架）时，可能需要更长的时间才能获得这种水平的专业知识。

现在，关于你应该聘请谁来做这项工作：如果你担心其他程序员理解你的承包商代码的长期能力，那么使用 Django 可能是有意义的（这当然是我的偏好）。但是，有很多很多 Rails 专家可以在未来很好地维护您的网站。

选择应归结为您正在评估的承包商中的谁，a）具有可靠的记录，b）您信任。优秀的开发人员在 Rails 或 Django 上都能做得很好。

* * *

## 回答 #5

> 赞同：10
> 
>             
> 
> 时间：2009-01-14T02:39:13.710

使用魔法时……为了确保理解系统的一部分，您必须了解整个系统。因为很难确定是否没有魔法影响您正在检查的作品。

这就像阅读一个故事并让作者省略相关的情节曲折，因为它们是重复的。

沙赞

* * *

## 回答 #6

> 赞同：9
> 
>             
> 
> 时间：2009-01-14T03:04:19.497

“魔术”的问题在于它向您隐藏了很多东西，一旦您开始“跳出框框”思考并最终陷入“死”，IMO 就会更难追踪问题或知道要做什么/优化魔法区”（即魔法无法帮助您的部分）。

IMO 这是 Ruby on Rails 的主要问题（别误会，我**真的很**喜欢 Ruby on Rails）；开始使用它太容易了，然后一旦遇到障碍，Rails 无法为您完成工作，或者 Rails 的约定不适合……除非您'重新成为 Ruby 大师，因为你不能再依赖魔法了，因为它从你身上抽象了一切，你不知道如何以“艰难的方式”去做

* * *

## 回答 #7

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T02:58:16.763

魔术通常真正意味着“使用嵌入式假设来优化性能或语法”。当然，在有据可查的代码中，这些假设被称为显式约束。

有时魔术很棒，因为它确实减少了您必须编写的内容或显着提高了速度。但是您可能会以无数种方式违反这些假设，或者遇到意外错误，或者更糟糕的是，出现不明显的错误。

* * *

## 回答 #8

> 赞同：3
> 
>             
> 
> 时间：2009-06-09T21:41:29.730

谈到魔术，我相信 Rails、Django 和大多数（如果不是所有）框架都在做某种魔术。他们抽象事物的方式，在 API 中封装低级服务，集成路由和控制器等，对于那些对背后知之甚少的人来说是一种魔力。我承认 Rails 有更多的魔力，人们有时会迷路。然而，我们不应该仅仅因为这个而放弃 Rails。就像我说的，并不是说魔法很糟糕，只有 Rails 会魔法，大多数都可以。我们应该看到 Rails 发展得非常快，它的代码质量越来越好，它变得越来越模块化。Rails 周围的资源是巨大的。这些也应该考虑在内。

* * *

## 回答 #9

> 赞同：3
> 
>             
> 
> 时间：2012-11-29T21:53:00.820

正如曹国亮指出的那样，您总是依赖某种“魔法”，首先是操作系统“神奇地”获取您的键盘输入并将其呈现在屏幕上的适当位置。每个 Web 框架都会解析发布到网页的参数，并将它们放入数据结构中以便于访问。Rails 对可以神奇地完成的事情更加激进，因为它的创建者（我倾向于同意他）对应该如何开发 Web 应用程序有非常强烈的意见。所以问题应该是“多少魔法”是合适的，而不是它是否存在固有问题。

# sql-server - 如何优化我的存储过程？

> ID：441721
> 
>         
> 
> 赞同：-3
> 
>         
> 
> 时间：2009-01-14T02:33:36.857
> 
>         
> 
> 标签：sql-server, optimization, stored-procedures

我今天运行了一个分析器，发现我的一个存储过程占用了非常高的 CPU 读取 (1899999) 和持续时间 (3233333)。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T02:36:47.023

您可以从向我们展示您的存储过程的内容开始......否则，必须使用诸如“检查正在执行的操作并进行相应优化”之类的通用答案。

# sql - 控制 Windows 服务的启动顺序

> ID：441723
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-01-14T02:34:59.477
> 
>         
> 
> 标签：sql, windows-services, autostart, installutil

我使用 installutil 安装了一个 Windows 服务并设置为“自动启动”。我的问题是，当某些服务器重新启动时，它会在“Microsoft SQL 服务”启动之前尝试启动——我可以通过在系统重新启动期间查看事件日志来看到这一点。Sql server 服务启动后使我的服务“自动启动”的最佳方法是什么？

我正在玩弄创建一个 SQL 作业集的想法，该作业集在“SQL 服务器代理”启动时启动，然后启动 Windows 服务。但希望有一种简单有效的方法来控制自动服务的启动顺序。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-01-14T02:47:41.340

每个 Windows 服务都有一个它所依赖的其他服务的列表。这意味着它会等到它的依赖项启动后才会尝试启动，如果在您启动时它们没有自动启动，它会为您启动它们。

如果您在 .NET 中创建 Windows 服务，这里有一篇博文可能会有所帮助：

[如何：编码服务依赖项](http://jschreuder.bloggingabout.net/2006/12/07/how-to-code-service-dependencies/)

否则这里有一个 Microsoft kb 条目，详细说明了通过注册表添加服务依赖项的方法：

[如何延迟加载特定服务](http://support.microsoft.com/kb/193888)

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T02:45:14.790

您可以设置服务之间的依赖关系。

[看这里：](http://support.microsoft.com/kb/193888)

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2010-05-11T15:57:03.957

如果您想使用批处理脚本执行此操作，那么以下内容将有所帮助

`REG ADD "HKLM\SYSTEM\CurrentControlSet\Services\%ServiceKey%" /v "DependOnService" /t REG_MULTI_SZ /d "Service Number 01\0Service Number 02"`

这使用**reg.exe** [见这里](http://www.petri.co.il/reg_command_in_windows_xp.htm "看这里")

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2010-10-18T17:50:57.743

依赖关系很诱人，但在 SQL Server 的情况下，可能对系统的长期设计有害。考虑一下您的应用程序是否成功并且您的客户是否希望移动到另一个盒子上的单独 SQL 服务器或故障转移集群。

更好的设计可能是在您的服务启动时加入一些重试/超时逻辑，以便它尝试联系 SQL Server（甚至可能在另一台机器上），等待，尝试，然后优雅地失败。

# regex - 使用部件捕获进行 url 验证的正则表达式

> ID：441739
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-01-14T02:42:06.903
> 
>         
> 
> 标签：regex, validation, url

可以使用单个正则表达式来验证网址并匹配所有部分吗？我一直在研究一个，到目前为止我想出的是：

```
(?:(?P<scheme>[a-z]*?)://)?(?:(?P<username>.*?):?(?P<password>.*?)?@)?(?P<hostname>.*?)/(?:(?:(?P<path>.*?)\?)?(?P<file>.*?\.[a-z]{1,6})?(?:(?:(?P<query>.*?)#?)?(?P<fragment>.*?)?)?)? 
```

但是这不起作用，它应该匹配以下所有示例：

> [http://username:password@hostname.tld/path?arg=value#anchor](http://username:password@hostname.tld/path?arg=value#anchor) 
> 
>   [http://www.domain.com/](http://www.domain.com/) 
> 
>   [http://www.doamin.co.uk/](http://www.doamin.co.uk/) 
> 
>   [http://www.yahoo.com /](http://www.yahoo.com/) 
> 
>   [http://www.google.au/](http://www.google.au/) 
> 
>   [https://username:password@domain.com/](https://username:password@domain.com/) 
> 
>   [ftp://user:password@domain.com/path/](ftp://user:password@domain.com/path/) 
> 
>   [https://www.blah1.subdoamin.doamin.tld /](https://www.blah1.subdoamin.doamin.tld/)
>  
>   domain.tld/#anchor 
> 
>   doamin.tld/?query=123 
> 
>   domain.co.uk/ 
> 
>   domain.tld 
> 
>   [http://www.domain.tld/index.php?var1=blah](http://www.domain.tld/index.php?var1=blah) 
> 
>   [http://www.domain.tld /path/to/index.ext](http://www.domain.tld/path/to/index.ext)
>  
>   mailto://user@unkwndesign.com

并为所有组件提供命名捕获：

> 计划例如。http https ftp ftps callto mailto 和任何其他未列出的
> 
>   用户名
> 
>   密码
> 
>   主机名，包括子域、域和 tld
> 
>   路径，例如 /images/profile/
> 
>   文件名，例如 file.ext
> 
>   查询字符串，例如。?foo=bar&bar=foo
> 
>   片段，例如。＃锚

将主机名作为唯一的必填字段。

我们可以假设这来自一个专门要求 url 的表单，并且不会用于在文本中查找链接。

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-01-14T09:01:06.593

> 可以使用单个正则表达式来验证 url 并匹配所有部分

不。

strager 的正则表达式令人印象深刻，但归根结底，它的可读性、可维护性和可靠性不如仅使用适当的 URI 解析器。它必然拒绝有效的 URI 并接受不是 URI 的字符串，因为格式化 URI 的规则不能在正则表达式中完全表达。

> mailto://user@unkwndesign.com

mailto URI 中不应有“//”。在您阅读方案之前，您无法判断 URI 的其余部分（post-:) 将是什么格式；许多 URI 方案不符合 credentials@host/path 格式。最好只接受您知道如何解析其 URI 的特定方案。

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-01-14T03:08:13.013

[明辉正则表达式](https://stackoverflow.com/questions/27745/getting-parts-of-a-url-regex#309360)修改版：

```
/^((?P<scheme>https?|ftp):\/)?\/?((?P<username>.*?)(:(?P<password>.*?)|)@)?(?P<hostname>[^:\/\s]+)(?P<port>:([^\/]*))?(?P<path>(\/\w+)*\/)(?P<filename>[-\w.]+[^#?\s]*)?(?P<query>\?([^#]*))?(?P<fragment>#(.*))?$/ 
```

# delphi - TAggregateField.IsNull 和 (TAggregateField.Value = Null) 有什么区别

> ID：441743
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-14T02:44:55.743
> 
>         
> 
> 标签：delphi

我在客户端数据集中有一个聚合字段，我使用一个函数来获取聚合值，如果客户端数据集为空，则该函数应返回 0。

如果我这样做：

```
if MyClientDataSet.AggregateField.IsNull then
   Result := 0
else
   Result := MyClientDataSet.AggregateField.Value; 
```

当客户端数据集为空时，执行 else 部分并引发异常（无法将 Variant 转换为 Currency 错误）。

但如果我这样做

```
if MyClientDataSet.AggregateField.Value = Null then
   Result := 0
else
   Result := MyClientDataSet.AggregateField.Value; 
```

它工作正常！

所以我的问题是：IsNull 属性与在 TAggregateField 中将 Value 属性与 Null 值进行比较有什么区别？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T03:21:04.983

当您没有记录（数据集为空）时，您没有值为空的字段（从记录缓冲区读取），因此字段的 IsNull 函数返回 false。

在另一种情况下，您测试您有一个空变体，这是数据集在 GetAggregateValue 中返回的内容。

# c++ - 继承而不是 typedef

> ID：441744
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2009-01-14T02:45:07.227
> 
>         
> 
> 标签：c++, inheritance, templates, typedef

C++ 无法从 typedef 或 typedef 模板类中生成模板。我知道如果我继承并使我的类成为模板，它将起作用。

例子：

```
// Illegal
template <class T>
typedef MyVectorType vector<T>;

//Valid, but advantageous?
template <class T>
class MyVectorType : public vector<T> { }; 
```

这样做是有利的，以便我可以“伪造” typedef 还是有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2009-01-14T03:07:04.997

C++0x 将使用`using`关键字添加模板类型定义。

您的解决方案声明了一种新类型，而不是类型“别名”，例如，您不能`MyVectorType &`使用`vector<T>`. 这对您来说可能不是问题，但如果是，但您不想在代码中引用向量，您可以这样做：

```
template <typename T>
class MyVectorType {
public:
  typedef std::vector<T> type;
}; 
```

* * *

## 回答 #2

> 赞同：10
> 
>             
> 
> 时间：2009-01-14T03:06:23.423

继承不是你想要的。模拟模板化 typedef 的一种更惯用的方法是：

```
template <typename T> struct MyVectorType {
    typedef std::vector<T> t;
}; 
```

像这样引用typedef：

```
MyVectorType<T>::t; 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T08:20:35.800

> C++ 无法从 typedef 或 typedef 模板类中生成模板。

这取决于你的意思`typedef`:  `std::vector<size_t>`是合法的——即使`size_t`是 typedef ——并且`std::string`是`typedef`for `std::basic_string<char>`。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2018-07-31T16:53:17.993

您应该使用什么取决于它的行为方式（例如重载解决方案）：

*   如果您希望它成为一种新的独特类型

    ```
    class Foo : public Whatever {}; 
    ```

    但是，您现在可以将 , 的指针或引用传递`Foo`给接受 的函数`Whatever`，因此这变成了混合体。因此，在这种情况下，请使用`private`继承`using Whatever::Foo`或自定义实现来公开您想要的方法。

*   如果你想要一个类型同义词

    ```
    using Foo = Whatever; 
    ```

前者的优点是可以预先声明一个类，但不能预先声明一个 typedef。

# javascript - 从 URL 中删除主机名和端口的正则表达式？

> ID：441755
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2009-01-14T02:51:43.873
> 
>         
> 
> 标签：javascript, regex

我需要编写一些 javascript 来从 url 中去除 hostname:port 部分，这意味着我只想提取路径部分。

即我想写一个函数 getPath(url) 使得 getPath(" [http://host:8081/path/to/something](http://host:8081/path/to/something) ") 返回 "/path/to/something"

这可以使用正则表达式来完成吗？

* * *

## 回答 #1

> 赞同：28
> 
>             
> 
> 时间：2009-01-14T05:19:28.507

RFC 3986 ( [http://www.ietf.org/rfc/rfc3986.txt](http://www.ietf.org/rfc/rfc3986.txt) ) 在附录 B 中说

以下行是将格式良好的 URI 引用分解为其组件的正则表达式。

```
 ^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?
   12            3  4          5       6  7        8 9 
```

上面第二行中的数字只是为了便于阅读；它们指示每个子表达式的参考点（即每个成对的括号）。我们将与子表达式匹配的值称为 $。例如，将上面的表达式匹配到

```
 http://www.ics.uci.edu/pub/ietf/uri/#Related 
```

导致以下子表达式匹配：

```
 $1 = http:
  $2 = http
  $3 = //www.ics.uci.edu
  $4 = www.ics.uci.edu
  $5 = /pub/ietf/uri/
  $6 = <undefined>
  $7 = <undefined>
  $8 = #Related
  $9 = Related 
```

where`<undefined>`表示该组件不存在，如上例中查询组件的情况。因此，我们可以将五个分量的值确定为

```
 scheme    = $2
  authority = $4
  path      = $5
  query     = $7
  fragment  = $9 
```

* * *

## 回答 #2

> 赞同：14
> 
>             
> 
> 时间：2009-01-14T08:59:27.267

我知道正则表达式很有用，但在这种情况下它们不是必需的。Location 对象是 DOM 中所有链接的固有属性，并且具有路径名属性。

因此，要访问某个随机 URL 的该属性，您可能需要创建一个新的 DOM 元素，然后返回其路径名。

一个总是能完美运行的例子：

```
function getPath(url) {
    var a = document.createElement('a');
    a.href = url;
    return a.pathname.substr(0,1) === '/' ? a.pathname : '/' + a.pathname;
} 
```

jQuery 版本：（如果需要，使用正则表达式添加前导斜杠）

```
function getPath(url) {
    return $('<a/>').attr('href',url)[0].pathname.replace(/^[^\/]/,'/');
} 
```

* * *

## 回答 #3

> 赞同：12
> 
>             
> 
> 时间：2009-01-14T02:58:21.550

快速'n'脏：

```
^[^#]*?://.*?(/.*)$
```

主机名和端口（包括初始 /）之后的所有内容都被捕获在第一组中。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T09:19:49.487

window.location 对象具有路径名、搜索和散列属性，其中包含您需要的内容。

对于这个页面

```
location.pathname = '/questions/441755/regular-expression-to-remove-hostname-and-port-from-url'  
location.search = '' //because there is no query string
location.hash = '' 
```

所以你可以使用

```
var fullpath = location.pathname+location.search+location.hash 
```

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2017-05-24T04:51:23.193

这很简单：

```
^\w+:.*?(:)\d* 
```

试图找到第二次出现的“：”，后跟数字，前面是 http 或 https。

这适用于以下两种情况

前任：

[http://localhost:8080/myapplication](http://localhost:8080/myapplication)

[https://localhost:8080/myapplication](https://localhost:8080/myapplication)

希望这可以帮助。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T03:02:39.780

这个正则表达式似乎有效：( **http [://[](http://[) ^/] *)(/.* )**

作为测试，我在文本编辑器中运行了这个搜索和替换：

```
 Search: (http://[^/]*)(/.*)
Replace: Part #1: \1\nPart #2: \2 
```

它转换了这个文本：

```
http://host:8081/path/to/something 
```

进入这个：

```
Part #1: http://host:8081
Part #2: /path/to/something 
```

并将其转换为：

```
http://stackoverflow.com/questions/441755/regular-expression-to-remove-hostname-and-port-from-url 
```

进入这个：

```
Part #1: http://stackoverflow.com
Part #2: /questions/441755/regular-expression-to-remove-hostname-and-port-from-url 
```

# c++ - 使用 Boost 库 (C++) 进行简单的选项处理

> ID：441757
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-14T02:52:29.970
> 
>         
> 
> 标签：c++, boost

例如，使用以下语法：

```
 -I [file] -A 1 2 3 
```

问题：

如何检查是否指定了**文件**以及是否指定了**三个**（整数）值。

我理解以下内容：

```
po::options_descriptions desc("Allowed options");
desc.add_options() 
```

然后如何使用指定的参数，例如：

```
 if (argv[3] == 1) {
        ...
    } 
```

问候

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-17T19:19:17.650

您使用`variables_map`来检查是否指定了选项。如果您添加了一个名为的选项`"file"`并且您的`variables_map`被称为`vm`：

```
if(vm.count("myoption")) { ... } // Returns 0 if myoption not specified. 1 or more if it was. 
```

一旦你习惯`add_options`了添加一些选项，你可以像这样访问它们，假设你已经设置了一个`variables_map`命名`vm`：

```
vm["myoption"].as<int>() // Will return an int, assuming your option is an int
vm["myoption"].as<std::string>() // Will return an std::string, assuming your option is an int 
```

在您的情况下，您希望将指定的选项之一转换为整数序列。你可以这样做：

```
vm["myoption"].as< std::vector<int> >() 
```

这将返回一个包含 3 个整数的向量，您可以像任何法线向量一样对其进行索引和使用。看具体有没有3个，用`size()`vector成员函数就行了。

这方面的提升教程位于[此处](http://www.boost.org/doc/libs/1_37_0/doc/html/program_options/tutorial.html)。

# python - 在 Windows 中从 Python 驱动 Excel

> ID：441758
> 
>         
> 
> 赞同：44
> 
>         
> 
> 时间：2009-01-14T02:53:26.723
> 
>         
> 
> 标签：python, excel, scripting

我们有各种电子表格，它们使用极其复杂的宏和第三方扩展来生成复杂的模型。我正在开展一个项目，该项目涉及稍微调整各种输入并查看结果。与其手动执行此操作或编写 VBA，我想看看是否可以编写一个 python 脚本来驱动它。换句话说，python 脚本将启动，加载 excel 工作表，然后通过在某些单元格中进行微小更改并查看它们如何影响其他单元格来与工作表交互。

所以，我的问题是双重的：

*   以这种方式从 python 驱动 excel 的最佳库是什么？

*   使用该库的最佳文档/示例在哪里？

干杯，/YGA

* * *

## 回答 #1

> 赞同：48
> 
>             
> 
> 时间：2009-01-15T07:48:43.977

要控制 Excel，请使用 pywin32，就像 @igowen 建议的那样。

请注意，可以使用静态调度。使用`makepy.py`pywin32 项目创建一个带有 python 包装器的 python 模块。使用生成的包装器简化了开发，因为例如 ipython 在开发过程中为您提供了制表符补全和帮助。

静态调度示例：

```
x:> makepy.py "Microsoft Excel 11.0 对象库"
...
生成...
导入模块
x:> ipython

```

```
> from win32com.client import Dispatch
> excel = Dispatch("Excel.Application")
> wb = excel.Workbooks.Append()
> range = wb.Sheets[0].Range("A1")
> range.[Press Tab]
range.Activate                 range.Merge
range.AddComment               range.NavigateArrow
range.AdvancedFilter           range.NoteText
...
range.GetOffset                range.__repr__
range.GetResize                range.__setattr__
range.GetValue                 range.__str__
range.Get_Default              range.__unicode__
range.GoalSeek                 range._get_good_object_
range.Group                    range._get_good_single_object_
range.Insert                   range._oleobj_
range.InsertIndent             range._prop_map_get_
range.Item                     range._prop_map_put_
range.Justify                  range.coclass_clsid
range.ListNames                range.__class__
> range.Value = 32
... 
```

文档链接：

*   O'Reilly[的 Win32 上的 Python 编程](http://my.safaribooksonline.com/1565926218)一书有一章[与 Excel 集成](http://my.safaribooksonline.com/1565926218/ch09-84996)。

*   同一本书，免费示例章节[Advanced Python and COM](http://oreilly.com/catalog/pythonwin32/chapter/ch12.html)详细介绍了 makepy。

*   [教程](http://www.google.com/search?q=python+excel+tutorial)

*   [win32com 文档](http://docs.activestate.com/activepython/2.4/pywin32/html/com/win32com/HTML/docindex.html)，我建议你先阅读[这个](http://docs.activestate.com/activepython/2.4/pywin32/html/com/win32com/HTML/QuickStartClientCom.html)。

* * *

## 回答 #2

> 赞同：21
> 
>             
> 
> 时间：2009-01-14T03:11:30.433

我已经通过使用[pywin32](http://python.net/crew/mhammond/win32/Downloads.html)完成了这项工作。这不是一个特别愉快的体验，因为没有任何抽象；这就像使用 VBA，但使用 python 语法。您不能依赖文档字符串，因此您需要方便地使用 MSDN Excel 参考（如果我没记错的话，我使用的是[http://msdn.microsoft.com/en-us/library/aa220733.aspx](http://msdn.microsoft.com/en-us/library/aa220733.aspx) 。如果您稍微挖掘一下，您应该能够找到 Excel 2007 文档。）。

请参阅[此处](http://web.archive.org/web/20090916091434/http://www.markcarter.me.uk/computing/python/excel.html)以获取一个简单的示例。

```
from win32com.client import Dispatch

xlApp = Dispatch("Excel.Application")
xlApp.Visible = 1
xlApp.Workbooks.Add()
xlApp.ActiveSheet.Cells(1,1).Value = 'Python Rules!'
xlApp.ActiveWorkbook.ActiveSheet.Cells(1,2).Value = 'Python Rules 2!'
xlApp.ActiveWorkbook.Close(SaveChanges=0) # see note 1
xlApp.Quit()
xlApp.Visible = 0 # see note 2
del xlApp 
```

祝你好运！

* * *

## 回答 #3

> 赞同：8
> 
>             
> 
> 时间：2012-06-11T09:43:42.793

查看[DataNitro](http://datanitro.com/)项目（以前的名称 IronSpread）。它是 Excel 的 Python 插件。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-01-15T12:41:21.733

去年我参与了一个家庭项目，其中涉及一个编写为 Python Excel 插件的客户端。该项目本质上是一个为最终用户访问而简化的在线数据库。Excel 插件允许用户从数据库中查询数据以在 Excel 中显示。

Excel 插件我从来没有走得太远，而且我的代码有点难看。但是，我所拥有的是 BSD 许可证，可通过 Bazaar 在

[http://www.launchpad.net/analyz/trunk](http://www.launchpad.net/analyz/trunk)

客户端将无法工作，因为我现在没有运行公共服务器，但至少你可以看看我对代码做了什么，以了解它是如何工作的。该代码还将向您展示如何在 100% Python 中构建 MFC 对话框。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2014-02-10T11:15:53.970

我编写了允许通过 Windows 中的 COM 接口使用 Excel 的 python 类[http://sourceforge.net/projects/excelcomforpython/](http://sourceforge.net/projects/excelcomforpython/)

该类使用 win32com 与 Excel 交互。您可以直接使用类或将其用作示例。实现了很多选项，如数组公式、条件格式、图表等。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2015-08-27T07:36:55.530

我花了大约一个星期，这是我的实现（或者更确切地说是概念验证）：[https ://github.com/Winand/SimplePython](https://github.com/Winand/SimplePython)

主要思想是使 Python 代码像 VBA 宏一样易于编写和从 Microsoft Office 调用（我只为 Excel 制作了加载项）。

*   客户端-服务器架构（通过 TCP），因此 Python 只启动一次

*   如果服务器没有运行，它会自动启动

*   当用户更改宏模块时，服务器会自动重新加载它们

*   Office 功能区上易于使用的控制界面

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2014-02-14T16:43:51.307

有一个有趣的项目将 python 作为进程内 DLL 集成到 excel 中，可以在以下位置找到：

[http://opentradingsystem.com/PythonForExcel/main.html](http://opentradingsystem.com/PythonForExcel/main.html)

另一个基于相同想法的更简单的项目存在于：

[http://www.codeproject.com/Articles/639887/Calling-Python-code-from-Excel-with-ExcelPython](http://www.codeproject.com/Articles/639887/Calling-Python-code-from-Excel-with-ExcelPython)

这些项目似乎有很多希望，但需要更多的发展。

# sql - Django 自定义 SQL 返回 QuerySet，其中每个对象都有附加属性

> ID：441760
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-14T02:56:20.963
> 
>         
> 
> 标签：sql, django, postgresql

假设我有以下对象：

```
squirrel_table 
  - name
  - country_of_origin
  - id

nut_table
  - id
  - squirrel_who_owns_me[fk to squirrel] 
```

我想检索特定国家/地区所有松鼠的列表。返回的 squirrel 对象可以在 QuerySet 中，但不需要。一份清单就足够了。每只松鼠都会有一个额外的属性调用 nut_count。用于此的 SQL 将类似于以下内容（请注意，我使用子查询是为了不枚举所有 squirrel 的列，因为实际上会有很多）（我使用 PostgreSQL）：

```
select sq.*,
       nut_counts.nut_count
  from squirrel_table sq,
      (select sq2.id as squirrel_id,
              count(nuts) as nut_count
         from squirrel_table sq2,
              nut_table nuts
        where nuts.squirrel_who_owns_me = sq2.id
          and sq.country_of_origin = 'USA'
        group by sq2.id) as nut_counts
 where sq.id = nut_counts.squirrel_id 
```

有没有办法执行 SQL，获取它生成的游标，并将其转换为 squirrel 对象列表，并将 nut_count 添加到每个 squirrel？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T06:09:47.373

您可能想通读[“extra()”方法的文档](http://docs.djangoproject.com/en/dev/ref/models/querysets/#extra-select-none-where-none-params-none-tables-none-order-by-none-select-params-none)，其中包括一个类似的“选择其他内容并将其附加到每个对象”情况的示例。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2010-10-05T20:07:06.247

如果需要执行 SQL，请使用 raw()。如果您添加一个 pk "select table.id as pk, table.* ..."，那么它将像您可能习惯的 QuerySet 一样工作。

```
sql = 'select sq.id as pk, sq.* ... %s'
squirreled = squirrel_table.objects.raw(sql, ["arg1"]) 
```

# c# - 如何在 Vista 中停止 Ideablade DevForce 写入 C:\Program Files\AppName\debuglog.xml

> ID：441770
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-14T03:01:02.730
> 
>         
> 
> 标签：c#, winforms, windows-vista, uac, devforce

我有一个使用 Ideablade Devforce 作为 OR 映射器的应用程序。当应用程序启动时，它想写入 C:\Program Files\Application Name\ 中的 debuglog.xml 文件。这在 Windows XP 中运行良好，但由于 Vista 锁定了对 Program Files 的写访问权限，应用程序会抛出错误。

有没有办法阻止 Ideablade 想要写入这个文件？

或者

是否有其他地方推荐安装想要写入其安装路径中文件的应用程序？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-15T01:34:56.400

我通过在 IdeaBlade.ibconfig 文件中将日志文件选项设置为空白字符串来修复它。

它在帮助中提到，如果您不提供路径，它会将文件保存在应用程序的目录中，但如果您甚至不提供文件名，它将不会将其保存在任何地方。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2012-11-20T09:22:21.920

csjohnst 是正确的。在 ibconfig 文件中将 logfile 元素设置为空字符串将禁止创建调试日志。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T08:10:14.837

您可以在 C:\ApplicationName 下拥有自己的目录，或者在部署期间设置对 C:\Program Files\ApplicationName 文件夹的写访问权限。

我希望这有帮助。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T22:19:10.553

你最好的选择是和沃德贝尔谈谈；）（[http://neverindoubtnet.blogspot.com/](http://neverindoubtnet.blogspot.com/)）

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2014-03-25T14:01:08.423

在 IdeaBlade.ibconfig 文件中，将 logFile 设置为空字符串：例如，

```
<logging> 
    <archiveLogs>false</archiveLogs> 
    <logFile></logFile> 
</logging> 
```

# security - 处理机密财务数据时是否有任何法律？

> ID：441777
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-01-14T03:06:59.427
> 
>         
> 
> 标签：security

我被要求构建一个 Web 应用程序，用于为一家私人借贷公司存储和操作敏感的财务数据。在我咬下更多我可以咀嚼的东西之前，我想弄清楚我是否应该了解有关合法托管和保护此类信息的任何信息。在处理信用卡信息时，我已经阅读了很多关于 PCI 合规性的信息，但这些数据有点不同。不会在网上进行任何金融交易，客户只需查看余额、利率、贷款等，并由管理员处理这些数据。我会将这些数据的敏感性等同于银行的敏感性。

所以我的最终问题是是否有任何关于存储和传输这些数据的法律。显然，SSL 证书是有序的，但托管呢？我应该得到一个专用的私人服务器还是共享主机合适？

对于这种情况的任何其他意见将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：17
> 
>             
> 
> 时间：2009-01-14T03:16:33.497

在这个问题上，你应该从程序员那里接受的唯一真正的建议是：

**找个律师。**

和你一样，我们是编码员，而不是律师，而且我们真的不适合提供法律建议。也许我们中间有律师，也许他们会给我们所有人提供一些免费的法律建议，但根据我的经验，法律领域的建议通常不像代码领域的建议那样自由流动。

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2009-01-14T03:22:26.977

简短的回答：是的

曾在银行机构（美国）工作过，我可以说有很多法律规范金融信息的存储、显示和分发。如果您托管该站点，则需要处理更多的监管/合规问题。

长答案：找律师并为您的客户开具律师费**。**客户应该预先为您提供所有与合规性相关的规范。如果他们没有为您提供适当的信息，请***逃跑***。

如果您选择继续进行项目，请确保您有一份责任保险单，该保险单将涵盖您的客户可能遭受的任何损失，并确保向他们收取保单费用。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T03:14:38.163

如果客户是一家上市公司，则[萨班斯-奥克斯利法案](http://en.wikipedia.org/wiki/Sarbanes_oxley)的某些条款可能适用于会计和数据保护领域。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T03:17:47.847

“这么说吧：如果你要问律师你做的事情是否“正确”，你就是道德败坏了。我们不要去那里。我们的道德不以法律为基础。” ——莱纳斯·托瓦兹

我有一个朋友制作网络应用程序，该应用程序与验证卡安全码的信用卡公司进行通信。他没有将卡安全码存储到他的数据库中，他的网络应用程序只是从信用卡公司查询信用卡是否有效。

让您的信念指导您和您的团队存储什么，不存储什么。无论如何，请律师也不会受到伤害。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T03:16:54.010

求律师！！在银行数据保护方面有非常严格的规定。如果违反这些规则，您最终可能会入狱！

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T03:17:14.743

有很多法律可能适用，具体取决于信息。例如，有关于要求提供个人身份信息、社会安全号码等的法律。  

我希望您不打算依靠 SO 寻求建议。最好找个懂法律的律师。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T03:15:24.997

我不会像担心如果客户发现他们的敏感信息被黑客入侵会发生什么那样担心法律。我不是说这会发生，但它可能会发生。

您可能会被追究责任和义务，这可能会损害您的声誉和/或通过诉讼导致您破产。

因此，如果您构建的 Web 应用程序是安全的，那么您应该没问题。

根据您所在的国家、州和/或公司政策，某些法律可能适用。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T03:23:41.280

Sarbannes Oxley 想到这里：数据保护，但我同意这里的普遍观点，**找一个律师**

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T04:03:29.923

此外，您需要考虑法律管辖权。如果您持有来自不同国家/地区的实体的财务数据，您需要知道适用哪些国家/地区的法律。无论数据托管在哪个国家/地区，这都可能会发生变化。同样，您需要**聘请律师**，但是当您这样做时，如果这是您需要考虑的标准，请告知他们。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T04:39:51.003

"Laws" also depends on which countries you're talking about (your profile & the question doesn't explicitly say). Also, since SO is an online forum, the answers you get may vary depending on country (eg I'm in Australia)

Whenever you start talking online and laws, you may need to consider more than just local laws.

# asp.net - 诊断“请求超时”HttpExceptions

> ID：441792
> 
>         
> 
> 赞同：26
> 
>         
> 
> 时间：2009-01-14T03:16:08.880
> 
>         
> 
> 标签：asp.net, httpexception, request-timed-out

在 StackOverflow 上，我们每天都会看到一些“请求超时”异常。

事实：

*   请求超时是默认的 90 秒

*   仅在 POST 上发生

*   发布的数据是文本，通常很小 (< 1KB)，但可以达到几 KB

*   服务器变量中未捕获任何表单数据

*   客户端 UA 多种多样：IE5.5 - 7、Firefox 3.0.5、iPhone、Chrome

*   客户地点多种多样：英国、法国、美国 - 北卡罗来纳州、俄亥俄州、内布拉斯加州、印第安纳州

我们已经测试了基于服务器的超时（即使用 Thread.Sleep）并且**所有表单变量都被正确捕获**在异常日志中——这使我们相信客户端在分配的时间内发送请求时遇到了问题。

任何关于如何捕获/调试这种情况的想法都非常受欢迎！

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-04-02T14:05:28.170

我在使用小型 AJAX 网络服务的生产服务器上遇到了同样的问题。在我们的防火墙外进行数据包捕获后，我们发现服务的 POST 来自两个 TCP 段，而第二个段从未到达我们。（第一个数据包只包含标头，第二个丢失的数据包应该是 json 正文）所以基本上 IIS 只是坐在那里等待其余的 POST。在配置的超时之后，服务器向客户端发送一个 RST 数据包并记录“请求超时”错误 - 这是正确的行为。

我们试图在没有太多运气的情况下获得客户端复制，但在我们的情况下，这似乎完全与网络相关（或者可能是一些不喜欢帖子内容的“安全”软件）。

* * *

## 回答 #2

> 赞同：10
> 
>             
> 
> 时间：2009-01-14T04:53:17.433

如果您正在运行 IIS 7，则可以使用[Failed Request Tracing](http://learn.iis.net/page.aspx/266/troubleshooting-failed-requests-using-tracing-in-iis7/)。我实际上并没有将它用于超时，我主要将其设置为仅捕获特定的 http 错误代码。但我知道你可以让它转储任何花费超过 X 时间的请求的痕迹。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T03:41:05.787

您是否尝试过通过 telnet 手动发布，而根本没有完成 POST。我很想看看你是否可以复制你所看到的行为。鉴于该站点的性质，如果您故意收到一些格式错误的 POST 来尝试破解系统，我不会感到惊讶。  

我注意到有时我需要重新启动 Safari 以便在某些操作挂起后让 SO 再次工作，但我认为这是我的问题。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2013-02-02T21:06:03.927

本文介绍了如何使用 windbg 捕获此问题：

[http://blogs.msdn.com/b/asiatech/archive/2012/06/21/how-to-troubleshoot-httpexception-request-timed-out-asp-net-4-0-64-bit.aspx](http://blogs.msdn.com/b/asiatech/archive/2012/06/21/how-to-troubleshoot-httpexception-request-timed-out-asp-net-4-0-64-bit.aspx)

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T04:53:15.860

我们过去经常在我们非常高流量的网络客户端上看到这些——想知道它是否相关。据说发生的是 HttpWebRequest（我假设您在使用 HttpWebResponse 时遇到问题？也许他们也有同样的问题）在幕后使用了一些 janky 线程池，*即使您的请求是同步的。*有时某些东西会死锁，因为堆栈中更高的一些其他 .NET 对象正在使用相同的系统线程池，一个会饿死另一个，最终导致超时。我认为这个问题在这里描述得更好：http: [//www.deez.info/sengelha/2005/03/03/beware-threadpools-and-httpwebrequest/](http://www.deez.info/sengelha/2005/03/03/beware-threadpools-and-httpwebrequest/)

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T10:10:32.630

我还会扫描您日志中的 IP 地址，以查看是否是同一个人反复出现问题。您知道，可能有些人仍在使用拨号帐户，或者他们的终端可能存在其他网络问题。但是，当然，不要在没有尽可能多的调查的情况下将其注销。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-02-17T14:21:47.577

从 IIS6 切换到 IIS7 后，我们的网络服务器遇到了同样的“请求超时”问题。我相信这个问题是特定于 IIS7 的。我的猜测是，在将请求移交给 ASP.Net 进行处理之前，这些错误在 IIS6 的处理链中被进一步吞没或忽略了。我今天打开失败的请求跟踪，看看是否可以捕获有关该问题的更多信息。到目前为止，您对客户端原因的解释似乎是最有效的。

# c++ - 完全线程安全的 shared_ptr 实现

> ID：441814
> 
>         
> 
> 赞同：13
> 
>         
> 
> 时间：2009-01-14T03:28:41.833
> 
>         
> 
> 标签：c++, boost, thread-safety, shared-ptr

有人知道完全线程安全的`shared_ptr`实现吗？例如 boost 的实现`shared_ptr`对于目标（引用计数）是线程安全的，并且对于同时`shared_ptr`实例读取也是安全的，但对于写入或读/写则不是。

（参见[Boost 文档](http://www.boost.org/doc/libs/1_37_0/libs/smart_ptr/shared_ptr.htm#ThreadSafety)，示例 3、4 和 5）。

`shared_ptr`是否存在对实例完全线程安全的 shared_ptr 实现？

奇怪的是 boost 文档说：

> shared_ptr 对象提供与内置类型相同级别的线程安全。

但是，如果将普通指针（内置类型）与 进行比较`smart_ptr`，则同时写入普通指针是线程安全的，但同时写入 a`smart_ptr`则不是。

编辑：我的意思是 x86 架构上的无锁实现。

EDIT2：这种智能指针的一个示例用例是有许多工作线程使用它们当前的工作项更新全局 shared_ptr 和一个对工作项进行随机采样的监视器线程。shared-ptr 将拥有该工作项，直到另一个工作项指针被分配给它（从而破坏先前的工作项）。监视器将通过将工作项分配给它自己的 shared-ptr 来获得工作项的所有权（从而防止工作项被销毁）。可以通过 XCHG 和手动删除来完成，但如果 shared-ptr 可以做到这一点会很好。

另一个例子是全局 shared-ptr 拥有一个“处理器”，并由某个线程分配，并由某个其他线程使用。当“用户”线程看到处理器 shard-ptr 为 NULL 时，它使用一些替代逻辑来进行处理。如果它不是 NULL，它会通过将处理器分配给它自己的 shared-ptr 来防止处理器被破坏。

* * *

## 回答 #1

> 赞同：18
> 
>             
> 
> 时间：2009-05-21T01:30:01.323

为这种完全线程安全的 shared_ptr 实现添加必要的障碍可能会影响性能。考虑以下比赛（注意：伪代码比比皆是）：

线程 1：global_ptr = A；

线程 2: global_ptr = B;

线程 3：local_ptr = global_ptr；

如果我们把它分解成它的组成操作：

线程 1：

```
A.refcnt++;
tmp_ptr = exchange(global_ptr, A);
if (!--tmp_ptr.refcnt) delete tmp_ptr; 
```

线程 2：

```
B.refcnt++;
tmp_ptr = exchange(global_ptr, B);
if (!--tmp_ptr.refcnt) delete tmp_ptr; 
```

线程 3：

```
local_ptr = global_ptr;
local_ptr.refcnt++; 
```

显然，如果线程 3 在 A 的交换之后读取指针，然后 B 在引用计数可以增加之前删除它，就会发生不好的事情。

为了处理这个问题，我们需要在线程 3 进行 refcnt 更新时使用一个虚拟值：（注意：compare_exchange(variable, expected, new) 如果变量中的值当前等于 new，则自动将变量中的值替换为 new，然后返回 true如果它成功了）

线程 1：

```
A.refcnt++;
tmp_ptr = global_ptr;
while (tmp_ptr == BAD_PTR || !compare_exchange(global_ptr, tmp_ptr, A))
    tmp_ptr = global_ptr;
if (!--tmp_ptr.refcnt) delete tmp_ptr; 
```

线程 2：

```
B.refcnt++;
while (tmp_ptr == BAD_PTR || !compare_exchange(global_ptr, tmp_ptr, A))
    tmp_ptr = global_ptr;
if (!--tmp_ptr.refcnt) delete tmp_ptr; 
```

线程 3：

```
tmp_ptr = global_ptr;
while (tmp_ptr == BAD_PTR || !compare_exchange(global_ptr, tmp_ptr, BAD_PTR))
    tmp_ptr = global_ptr;
local_ptr = tmp_ptr;
local_ptr.refcnt++;
global_ptr = tmp_ptr; 
```

您现在必须在 /read/ 操作的中间添加一个循环，其中包含原子。这不是一件好事——在某些 CPU 上它可能非常昂贵。更重要的是，你也在忙着等待。你可以开始使用 futexes 和诸如此类的东西变得聪明——但到那时你已经重新发明了锁。

这个成本必须由每个操作承担，并且本质上与锁给您的成本非常相似，这就是为什么您通常看不到这种线程安全的 shared_ptr 实现的原因。如果您需要这样的东西，我建议将互斥锁和 shared_ptr 包装到一个便利类中以自动锁定。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T03:58:13.147

同时写入内置指针当然不是线程安全的。如果你真的想把自己逼疯（例如，你可能有两个线程认为同一个指针有不同的值），那么考虑写入相同值对内存屏障的影响。

回复：评论 - 内置不是双重删除的原因是因为它们根本没有删除（并且我使用的 boost::shared_ptr 的实现不会双重删除，因为它使用特殊的原子增量和减量，所以它只会单次删除，但结果可能会有一个指针和另一个的引用计数。或者两者的几乎任何组合。这会很糟糕。）。boost 文档中的声明是正确的，你得到与内置相同的保证。

RE：EDIT2-您描述的第一种情况在使用内置函数和 shared_ptrs 之间非常不同。在一个（XCHG 和手动删除）中没有引用计数；当你这样做时，你假设你是唯一的所有者。如果使用共享指针，您是说其他线程可能拥有所有权，这使事情变得更加复杂。我相信通过比较和交换是可能的，但这将是非常不便携的。

C++0x 推出了一个原子库，它应该使编写通用多线程代码变得更加容易。您可能必须等到它出来才能看到线程安全智能指针的良好跨平台参考实现。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T06:57:53.830

我不知道这样的智能指针实现，但我不得不问：这种行为怎么会有用？我能想到的唯一可以同时发现指针更新的场景是竞争条件（即错误）。

这不是批评——很可能有一个合法的用例，我只是想不出。请告诉我！

回复：EDIT2 感谢您提供几个场景。听起来原子指针写入在这些情况下会很有用。（一件小事：对于第二个例子，当你写“如果它不是 NULL，它通过将它分配给它自己的 shared-ptr 来防止处理器被破坏”，我希望你的意思是你将全局共享指针分配给首先本地共享指针，*然后*检查本地共享指针是否为 NULL - 您描述它的方式容易出现竞争条件，即全局共享指针在您对其进行测试之后变为 NULL，然后再将其分配给本地共享指针。）

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2010-05-04T19:41:06.227

您可以使用此实现[原子引用计数指针](http://www.drdobbs.com/architecture-and-design/184401888)来至少实现引用计数机制。

* * *

## 回答 #5

> 赞同：-1
> 
>             
> 
> 时间：2009-01-14T08:39:31.457

您的编译器可能已经在较新的 C++ 标准中提供了线程安全的智能指针。我相信[TBB](http://www.threadingbuildingblocks.org/)正计划添加一个智能指针，但我认为它还没有被包括在内。不过，您也许可以使用 TBB 的线程安全容器之一。

* * *

## 回答 #6

> 赞同：-1
> 
>             
> 
> 时间：2009-05-21T01:45:46.487

您可以通过在每个共享指针中包含一个互斥对象并使用锁包装递增/递减命令来轻松地做到这一点。

* * *

## 回答 #7

> 赞同：-1
> 
>             
> 
> 时间：2009-09-11T13:48:34.307

我不认为这很容易，用 CS 包装你的 sh_ptr 类是不够的。确实，如果您为所有共享指针维护一个单一的 CS，它可以确保避免不同线程之间相互访问和删除 sh_ptr 对象。但这会很糟糕，每个共享指针的一个 CS 对象将是一个真正的瓶颈。如果每个可包装的新 ptr -s 具有不同的 CS ' 将是合适的，但是这样我们应该动态地创建我们的 CS，并确保 sh_ptr 类的复制 ctor 来传输这个共享的 C。现在我们遇到了同样的问题：谁来保证这个 Cs ptr 是否已经被删除。我们可以更聪明地使用每个实例的 volatile m_bReleased 标志，但这样我们就不能在检查标志和使用共享 Cs 之间留下安全漏洞。我可以' 看不到这个问题的完全安全的解决方案。也许那个可怕的全局 Cs 会像杀死应用程序那样是次要的坏事。（对不起我的英语不好）

* * *

## 回答 #8

> 赞同：-1
> 
>             
> 
> 时间：2013-03-16T03:17:51.547

这可能不是您想要的，但`boost::atomic`文档提供了一个示例，说明如何将原子计数器与`intrusive_ptr`. `intrusive_ptr`是 Boost 智能指针之一，它执行“侵入式引用计数”，这意味着计数器“嵌入”在目标中，而不是由智能指针提供。

提升`atomic`使用示例：

[http://www.boost.org/doc/html/atomic/usage_examples.html](http://www.boost.org/doc/html/atomic/usage_examples.html)

* * *

## 回答 #9

> 赞同：-3
> 
>             
> 
> 时间：2011-01-17T09:24:40.457

在我看来，最简单的解决方案是使用 a`intrusive_ptr`并进行一些小的（但必要的）修改。

我在下面分享了我的实现：

[http://www.philten.com/boost-smartptr-mt/](http://www.philten.com/boost-smartptr-mt/)

# python - Pythoncard 项目设置大小

> ID：441815
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-14T03:29:10.350
> 
>         
> 
> 标签：python, wxpython, pythoncard

下面是我的 pythoncard 应用程序的基类：

```
class MyBackground(model.Background):

    def on_initialize(self, event):
        # if you have any initialization
        # including sizer setup, do it here
        self.setLayout()

    def setLayout(self):
        sizer1 = wx.BoxSizer(wx.VERTICAL)   # main sizer

        for item in self.components.itervalues():
            item.SetSize(item.GetBestSize())
            print item.GetBestSize(),item.GetSize() # here
            sizer1.Add(item, 0, wx.ALL, 10)

        sizer1.Fit(self)
        self.panel.SetSizer(sizer1)
        self.panel.Layout()
        self.visible = 1 
```

它使用具有以下内容的资源文件：

```
{'application':{'type':'Application',
      'name':'Template',
'backgrounds': [
{'type':'Background',
      'name':'bgTemplate',
      'title':u'Standard Template with no menus',
      'size': (800, 600),
      'statusBar':1,
      'style':['wx.MINIMIZE_BOX', 'wx.CLOSE_BOX', 'wx.MAXIMIZE_BOX', 'wx.FRAME_SHAPED', 'wx.CAPTION',
               'wx.DEFAULT_FRAME_STYLE', 'wx.FULL_REPAINT_ON_RESIZE', 'wx.HW_SCROLLBAR_AUTO'],

     'components': [

 {'backgroundColor': '&H00FFFFFF&',
  'name': 'MinMax0',
  'position': (1080, 9900),
  'size': (732, 220),
  'text': '10000',
  'type': 'TextField'}]}]} 
```

在我标有“这里”的评论的行上打印`(80, 21) (732, 220)`，这是我所期望的`(80, 21) (80, 21)`。如何在 pythoncard 应用程序中设置组件的大小？

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-10-23T15:55:26.990

为什么是 80,21？您告诉它制作项目 732,220，这就是它所做的。

或者还有什么你没有告诉我们的？

# user-interface - 在编程中应该采用哪些替代的用户输入技术？

> ID：441816
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-01-14T03:31:03.653
> 
>         
> 
> 标签：user-interface, hci, input-devices

由于需要输入大量特殊符号等，编程与例如文字处理特别不同。

在当前的新用户界面技术中，哪些适合编程，为什么？

或者语言语法的想法是问题所在，我们是否应该更符号化地编程，如果是这样，这将如何影响用户界面？

编辑：*当我指定用户界面技术时，我将它开放给使用现有硬件（鼠标/键盘）和其他一些东西，如多点触控、手势识别、增强现实（参见 HitLabNz 以获得一些很好的例子）。我对我们如何将这些应用于编程很感兴趣。*

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T04:41:34.073

我只是在想这个。我打算写一篇关于它的博客文章，我不妨从这里开始。在编程中，我认为我们需要的不仅仅是一种新的输入法，还需要一个新的隐喻来配合它。这是一个三层的东西。模型-隐喻-界面。

我最近越来越多地认为*语言*是表示计算的糟糕隐喻。语言是我们用来交流的东西。您可以将程序视为与计算机的通信，同时也是与其他程序员的通信。但是除了文字之外，还有其他的交流方式。我正在这里制作一个列表，请随时编辑这篇文章以向列表中添加更多内容。

**沟通方式**

*   演讲

*   身体语言，暗示

*   手势

*   面部表情

*   标志语言

*   绘画/绘图

*   拨盘、按钮、滑块、指向、拖动 (gui)

编程的另一个比喻是构建。以下是构建功能性事物的一些可能方法，它们可以构成编程接口的基础

**构建功能性事物的方法**

*   齿轮/弹簧和其他机械

*   折纸/裁切/胶合

*   跳线

*   电子电路

*   铰链、滚珠轴承、车轮

*   喷泉阀门和管道

*   阿基米德机器：滑轮、杠杆、螺丝

*   乐高

指定计算的另一种方式是通过定义。

**定义方法**
 - 约束 - 分类 - 集合论 - 属性 - 症状 - 逻辑表 - 规则 - 铁路（如铁路图）

但请记住我们为什么要这样做。现在编程语言的工作方式显然存在一些弱点，（否则我们不想制作新语言）所以让我们在设计新语言时牢记它们

**当前语言的问题**

*   界面隐藏

*   API 被隐藏

*   副作用是导致错误的一个重要原因——程序的任何部分都可能影响任何其他部分。

*   重构——有时你发现你在重复自己，所以你需要一种简单的方法将重复分解成一个宏、一个函数或其他一些隐喻。这主要是通过大量的文本操作工作手动完成的（或在 java 中半自动完成）。有没有一个新的比喻会让这样的事情看起来非常愚蠢？

*   您需要一种简单的方法来定义自己的构建块或“单词”或习语，以用于构建更复杂的结构。您自己的工具，您自己的环境部分。许多语言不允许你以一流的方式做到这一点。

*   编译器会因为最轻微的错误而严厉惩罚程序员。

*   变量缺乏时间感 - 无法查询变量过去设置的所有值的历史记录。换句话说，我们能否拥有一种可以“倒带”程序进度的编程语言？变量可以经常更改为意外值的事实是另一个错误来源。这是副作用问题的另一半

*   大多数编程语言都有相当陡峭的学习曲线

*   在整个代码中引用库或小部件 X 在很大程度上使您与该库结合——如果不进行大量重构，就很难切换到类似的等效库。这主要与库有名称这一事实有关，为了使用库，我们在整个代码中硬编码了该库的名称及其方法。有没有更好的办法？

*   并行性差，多线程会导致错误、竞争条件、死锁。是否有更好的并行性方法可以使此类错误成为不可能？仅这个问题就导致了许多新语言的创建。

*   超越电脑屏幕思考，人们。也许键盘是输入复杂关系和符号的最有效界面。你确定吗？除了鼠标、触摸屏或平板电脑之外，还有更多的选择。数以万计的与计算机交互的方式——我们都只选择了一种或两种相当普通的方式。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T04:02:58.317

几乎所有的非文本编程语言的努力都失败了。没有文本语言，很难既精确又高效。  

很多 UI 工作都用于制作更好的工具。例如，您可以只使用简单的文本编辑器进行编程，也可以拥有成熟的 IDE，如 Visual Studio 或 Eclipse。除此之外，还有像 Rational Rose 这样的可视化和设计工具。这些工具提供了探索和/或修改底层代码的补充方式。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T15:34:03.570

诸如多点触控之类的东西可能会提高代码创建的机械效率，但我认为这不是编程中的主要问题。当您考虑分析、设计、记录和测试算法所需的所有工作时，实际输入代码所花费的时间比例是如此之小，以至于在此处或此处节省按键或鼠标点击不会太多.

在我看来，这些天编程的主要挑战不是特殊符号或语法，它们相对较少，主要是直观的，并且接近接近 C 约定的事实上的标准。在我看来，编程的主要挑战是理解更大的代码单元，即 API 和程序本身的函数和类：什么是可用的，每个类做什么，每个函数需要和返回什么，在哪里相同点和不同点，以及它们如何组合成一个架构。我相信最严重的问题是由于不了解代码可能遇到的所有可能条件组合的类和函数中的微妙之处。

也许 AR 可视化技术可以帮助程序员和分析师查看和操作代码结构或流程的更大图景，但坦率地说，可以使用更传统的 UI 技术和控件来完成很多工作，例如表格、表单和菜单，使其进入编码世界。晚期的 Gupta/Centura 编程语言使用树状控件来更容易查看更大的代码结构。Intellisense 是促进代码创建的正确想法，但可以做更多工作来为开发人员提供工具来理解和分析更大规模的代码。Roedy Green 的 Source Code in Database 是一个良好的开端 ( [http://mindprod.com/project/scid.html](http://mindprod.com/project/scid.html) )，允许开发人员智能地查询代码库。更好的是一个*推动的编程 UI*对开发人员的分析，明确开发人员在给定程序设计中需要考虑的内容。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T04:41:22.903

我认为，即使您使用非文本（例如图形、语音识别、直接神经接口）输入法，对您的编程内容进行文本表示也是非常重要的。

程序基本上就像一个食谱：“要实现这一点，请完成这些步骤”。文本表示是这个食谱的一个书面记录。如果您需要制作配方的配方（“单击此菜单，使用此对话框...”），并且无法进行文本交互，那么您将与您生产的产品失去联系。

我认为程序员对替代输入/编程方法的愿望与他使用的语言的概念缺陷有关。最近我读到有人受命编写一堆 setter 和 getter——用更好的语言，这将是它的元编程设施的工作。

关于图形编程的主题：我可以更快地输入“for”这个词，而不是用鼠标绘制类似三角形的东西。即使通过让我从某个菜单中获取此三角形来“简化”此绘图也是如此。编程时，您使用数百种不同的符号；如何组织它们以在不输入的情况下访问？嘿，我知道，键盘快捷键怎么样......等等......

键盘是目前向计算机传达意义的最快工具，而一段文本是在计算机上存储意义的最简洁和有用的表示。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T15:52:44.483

对此进行了多次尝试。

APL 使用一组特殊符号来表示每个操作。这仍然以“J”语言的形式存在——等待它——用两个或三个字母的 ASCII 字符组合替换所有符号。

IBM 的 Visual Age 大约在 1998 年。有一个图形 IDE，您可以在其中执行诸如将“套接字”图标拖到您的工作空间并将其连接到“流”图标的操作。不过它只是生成了 C++，并且在最初的 g-whizz 之后，大多数程序员找到了“文本视图”选项并坚持使用它。

Suns Fortress - 仍然是文本的，但它允许您使用像 √ 这样的 unicode 符号作为运算符。不过，大多数已发布的示例程序似乎都坚持使用 ASCII 字符集。

这里有两个问题。

文字非常非常好！几千年来，人们已经能够画出相当不错的图片，但亚马逊销售的 99% 的书籍都只包含简单的文字。这可能是有充分理由的。

虽然“插座”的图形和相关的“连接”点可能很容易使用，但它的开发并非易事。您现在需要一个图形设计师来设计一个“错误消息显示图标”并定义一组关于如何以及在何处使用图形的规则，而不是做一个方法签名和一些 Javadoc。    

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T15:57:29.107

等等...您需要的不仅仅是文本编辑器和编译器/链接器？

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T04:13:21.930

好吧，某种符号场景的全部目的实际上只是归结为基于 GUI 的开发，这是 Visual Studio 慢慢调情的主题，但我们距离我们还有很多年的时间。

创建某种表示 FOR 循环的符号不会加快开发速度。如果您想更快地编写代码，只需使用任何体面的 IDE 已经支持的拖放代码块。

# jquery - 将一个元素的事件处理程序复制到另一个？

> ID：441821
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2009-01-14T03:36:45.000
> 
>         
> 
> 标签：jquery, events

**如何将事件处理程序从一个元素复制到另一个元素？**例如：

```
$('#firstEl')
    .click(function() {
        alert("Handled!");
    })
;

// here's where the magic happens 
$('#secondEl').click = $('#firstEl').click; // ???? 
```

请注意，第二个元素的处理时间与第一个元素获取其处理程序的时间不同，这意味着：

```
$('#firstEl, #secondEl').click(function() { ... }); 
```

……行不通。

* * *

## 回答 #1

> 赞同：24
> 
>             
> 
> 时间：2012-04-26T11:33:52.360

这个问题已经得到回答，但供将来参考：您可以通过迭代原始元素的事件并将它们的处理程序绑定到目标来复制它们。

**> 请参阅下面的编辑！**

```
// iterate event types of original
$.each($('#original').data('events'), function() {
  // iterate registered handler of original
  $.each(this, function() {
    $('#target').bind(this.type, this.handler);
  });
}); 
```

当您无法控制原始元素（例如使用插件时）并且只想克隆某个元素的行为时，这很方便。

**编辑：**在以后的 jQuery 版本中更改了对元素事件处理程序的访问。这应该适用于较新的版本：

```
$.each($._data($('#original').get(0), 'events'), function() {
  // iterate registered handler of original
  $.each(this, function() {
    $('#target').bind(this.type, this.handler);
  });
}); 
```

干杯

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T03:44:13.720

您不能轻易（也可能不应该）“复制”该事件。您可以做的是使用相同的函数来处理每个：

```
var clickHandler = function() { alert('click'); };
// or just function clickHandler() { alert('click'); };

$('#firstEl').click(clickHandler);

// and later
$('#secondEl').click(clickHandler); 
```

或者，您实际上可以为第二个处理程序中的第一个元素触发事件：

```
$('#firstEl').click(function() {
    alert('click');
});

$('secondEl').click(function() {
    $('#firstEl').click();
}); 
```

编辑：@nickf 担心污染全局命名空间，但这几乎总是可以通过将代码包装在对象中来避免：

```
function SomeObject() {
    this.clickHandler = function() { alert('click'); };
}
SomeObject.prototype.initFirstEvent = function() {
    $('#firstEl').click(this.clickHandler);
};
SomeObject.prototype.initSecondEvent = function() {
    $('#secondEl').click(this.clickHandler);
}; 
```

或将您的代码包装在匿名函数中并立即调用它：

```
(function() {
    var clickHandler = function() { alert('click'); };
    $('#firstEl').click(clickHandler);
    $('#secondEl').click(clickHandler);
})(); 
```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T08:43:58.483

You might be interested in the [triggerHandler method](http://docs.jquery.com/Events/triggerHandler)

```
// here's where the magic happens 
//$('#secondEl').click = $('#firstEl').click; // ????
$('#secondEl').click(function() {
    $('#firstEl').triggerHandler('click');
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T03:44:38.620

这是你想要的？

```
var clickHandler = function() { alert("Handled!"); }
$('#firstEl').click(clickHandler);
$('#secondEl').click(clickHandler); 
```

* * *

## 回答 #5

> 赞同：-2
> 
>             
> 
> 时间：2009-12-30T20:54:09.927

[http://www.learningjquery.com/2007/01/copy-events-from-one-element-to-another](http://www.learningjquery.com/2007/01/copy-events-from-one-element-to-another)

* * *

## 回答 #6

> 赞同：-3
> 
>             
> 
> 时间：2009-01-14T03:45:52.907

$('#secondEl').click = $('#firstEl').click.bind($('#secondEl'));

假设您使用的是 Prototype JS ( [http://www.prototypejs.org/api/function/bind](http://www.prototypejs.org/api/function/bind) )

# java - Java“虚拟机”与 Python“解释器”的说法？

> ID：441824
> 
>         
> 
> 赞同：230
> 
>         
> 
> 时间：2009-01-14T03:39:32.513
> 
>         
> 
> 标签：java, python, jvm

在 Java 中一直使用“虚拟机”时，似乎很少阅读 Python“虚拟机”。

两者都解释字节码；为什么将一个称为虚拟机而另一个称为解释器？

* * *

## 回答 #1

> 赞同：180
> 
>             
> 
> 时间：2009-11-13T22:47:18.057

在这篇文章中，“虚拟机”是指进程虚拟机，而不是像 Qemu 或 Virtualbox 这样的系统虚拟机。进程虚拟机只是一个提供通用编程环境的程序——一个可以编程的程序。  

Java 有解释器和虚拟机，Python 有虚拟机和解释器。“虚拟机”在 Java 中是一个更常见的术语，而“解释器”在 Python 中是一个更常见的术语，这与两种语言之间的主要区别有很大关系：静态类型 (Java) 与动态类型 (Python)。在这种情况下，“类型”指的是
[原始数据类型](http://en.wikipedia.org/wiki/Data_type)——表明数据在内存中存储大小的类型。Java虚拟机很容易。它要求程序员指定每个变量的原始数据类型。这为 Java 字节码提供了足够的信息，不仅可以被 Java 虚拟机解释和执行，甚至可以[编译成机器指令](http://gcc.gnu.org/java/). Python 虚拟机更复杂，因为它在执行每个操作之前承担额外的暂停任务，以确定操作中涉及的每个变量或数据结构的原始数据类型。Python 将程序员从原始数据类型的思维中解放出来，并允许在更高层次上表达操作。这种自由的代价是性能。“解释器”是 Python 的首选术语，因为它必须停下来检查数据类型，还因为动态类型语言相对简洁的语法非常适合交互式接口。构建交互式 Java 接口没有技术障碍，但尝试以交互方式编写任何静态类型的代码将是乏味的，所以不是那样做的。

在 Java 世界中，虚拟机抢尽风头，因为它运行用一种语言编写的程序，实际上可以编译成机器指令，结果是速度和资源效率。Java字节码可以由Java虚拟机执行，性能相对而言接近编译程序。这是由于字节码中存在原始数据类型信息。Java 虚拟机将 Java 归入一个自己的类别：

**可移植解释静态类型语言**

下一个最接近的是 LLVM，但 LLVM 在不同的级别上运行：

**可移植的解释性汇编语言**

Java 和 Python 都使用术语“字节码”，但并非所有字节码都是平等的。字节码只是编译器/解释器使用的中间语言的通用术语。甚至像 gcc 这样的 C 编译器也使用一种[（或几种）中间语言](http://gcc.gnu.org/onlinedocs/gccint/RTL.html)来完成工作。Java 字节码包含有关原始数据类型的信息，而 Python 字节码不包含。在这方面，Python（以及 Bash、Perl、Ruby 等）虚拟机确实从根本上比 Java 虚拟机慢，或者更确切地说，它只是有更多的工作要做。考虑不同字节码格式中包含哪些信息很有用：

*   **llvm:** cpu 寄存器

*   **Java：**原始数据类型

*   **Python：**用户定义的类型

打一个现实世界的类比：LLVM 处理原子，Java 虚拟机处理分子，Python 虚拟机处理材料。由于一切最终都必须分解为亚原子粒子（真机操作），因此 Python 虚拟机的任务最为复杂。

静态类型语言的解释器/编译器与动态类型语言的解释器/编译器没有相同的包袱。静态类型语言的程序员必须弥补这一不足，而回报就是性能。然而，正如所有非确定性函数都是秘密确定性的一样，所有动态类型语言都是秘密静态类型的。因此，这两个语言家族之间的性能差异应该会在 Python 更名为 HAL 9000 时趋于平稳。

Python等动态语言的虚拟机实现了一些理想化的逻辑机器，不一定与任何真实的物理硬件非常接近。相比之下，Java 虚拟机在功能上更类似于经典的 C 编译器，只是它不是发出机器指令，而是执行内置例程。在 Python 中，整数是一个带有一堆属性和方法的 Python 对象。在 Java 中，int 是指定的位数，通常为 32。这并不是一个公平的比较。Python 整数确实应该与 Java Integer 类进行比较。Java 的“int”原始数据类型无法与 Python 语言中的任何内容进行比较，因为 Python 语言只是缺少这一层原始数据，Python 字节码也是如此。

因为 Java 变量是显式类型的，所以可以合理地期望[Jython](http://www.jython.org/)性能与
[cPython](http://www.python.org/)处于同一水平。另一方面，用 Python 实现的 Java 虚拟机几乎可以保证比泥巴慢。不要指望 Ruby、Perl 等会更好。他们不是为此而设计的。它们是为“脚本”而设计的，这就是所谓的动态语言编程。

在虚拟机中发生的每一个操作最终都必须命中真实的硬件。虚拟机包含预编译的例程，这些例程足够通用，可以执行任何逻辑操作的组合。虚拟机可能不会发出新的机器指令，但它肯定会以任意复杂的顺序一遍又一遍地执行自己的例程。Java 虚拟机、Python 虚拟机和所有其他通用虚拟机在某种意义上是相同的，因为它们可以被诱使执行您可以梦想的任何逻辑，但它们在执行任务方面是不同的承担，以及他们留给程序员的任务。

Psyco for Python 不是一个完整的 Python 虚拟机，而是一个即时编译器，它在它认为可以编译几行代码的地方劫持常规 Python 虚拟机——主要是在它认为某些原始类型的地方循环即使值随着每次迭代而变化，变量也将保持不变。在这种情况下，它可以放弃常规虚拟机的一些持续类型确定。但是，您必须小心一点，以免您将类型从 Psyco 脚下拉出来。然而，如果 Pysco 不能完全确定类型不会改变，Pysco 通常只知道回退到常规虚拟机。

这个故事的寓意是原始数据类型信息对编译器/虚拟机非常有帮助。

最后，从长远来看，考虑一下：一个 Python 程序由 Python 解释器/虚拟机执行，该虚拟机在 Java 中运行，在 Java 解释器/虚拟机上运行，​​在 LLVM 中运行，在 iPhone 上运行的 qemu 虚拟机中运行。

[永久链接](http://www.darkarchive.org/w/Pub/ProcessVirtualMachine)

* * *

## 回答 #2

> 赞同：145
> 
>             
> 
> 时间：2009-01-14T05:06:47.097

虚拟机是一个虚拟计算环境，具有一组特定的原子定义明确的指令，这些指令独立于任何特定语言而受到支持，并且通常被认为是其自身的沙箱。VM 类似于特定 CPU 的指令集，并且倾向于在更基本的级别上工作，这些指令（或字节码）的非常基本的构建块独立于下一个。一条指令仅根据虚拟机的当前状态确定性地执行，而不依赖于该时间点指令流中其他地方的信息。

另一方面，解释器更复杂，因为它适合解析某些语法流，这些语法属于特定语言和特定语法，必须在周围标记的上下文中解码。您不能孤立地查看每个字节甚至每一行，并确切地知道下一步该做什么。语言中的标记不能像它们相对于 VM 的指令（字节码）那样孤立。

Java 编译器将 Java 语言转换为字节码流，这与 C 编译器将 C 语言程序转换为汇编代码没有什么不同。另一方面，解释器并没有真正将程序转换为任何定义良好的中间形式，它只是将程序动作作为解释源代码的过程。

VM 和解释器之间差异的另一个测试是您是否认为它与语言无关。我们所知道的 Java VM 并不是真正的 Java 特定的。您可以使用其他语言制作编译器，生成可以在 JVM 上运行的字节码。另一方面，我认为我们不会真正考虑将 Python 以外的其他语言“编译”成 Python 以供 Python 解释器进行解释。

由于解释过程的复杂性，这可能是一个相对缓慢的过程......特别是解析和识别语言标记等，并了解源的上下文以便能够在解释器中承担执行过程。为了帮助加速此类解释语言，我们可以在这里定义更容易直接解释的预解析、预标记源代码的中间形式。这种二进制形式仍然在执行时被解释，它只是从一种人类可读性差得多的形式开始以提高性能。然而，执行该形式的逻辑不是虚拟机，因为这些代码仍然不能孤立地看待——周围令牌的上下文仍然很重要，它们只是现在处于一种不同的计算机效率更高的形式。

* * *

## 回答 #3

> 赞同：67
> 
>             
> 
> 时间：2009-01-14T03:56:21.230

使用不同术语的一个原因可能是人们通常认为向 python 解释器提供原始的人类可读源代码，而不用担心字节码和所有这些。  

在 Java 中，您必须显式编译为字节码，然后只运行字节码，而不是 VM 上的源代码。  

尽管 Python 在幕后使用了虚拟机，但从用户的角度来看，大部分时间都可以忽略这个细节。  

* * *

## 回答 #4

> 赞同：19
> 
>             
> 
> 时间：2009-01-14T07:44:54.187

**解释器**，将源代码翻译成一些有效的中间表示（代码）并立即执行。

**虚拟机**，显式执行由编译器构建的存储的预编译代码，该编译器是解释器系统的一部分。

虚拟机的一个非常重要的特点是，里面运行的软件，受限于虚拟机提供的资源。准确地说，它无法脱离它的虚拟世界。想想远程代码的安全执行，Java Applet。

在 python 的情况下，如果我们保留*pyc*文件，正如这篇文章的评论中所提到的，那么该机制将变得更像一个虚拟机，并且这个字节码执行得更快——它仍然会被解释，但从一个对计算机更友好的形式. 如果我们从整体上看，PVM 是 Python Interpreter 的最后一步。

底线是，当提到 Python Interpreter 时，这意味着我们将其作为一个整体来引用，而当我们说 PVM 时，这意味着我们只是在谈论 Python Interpreter 的一部分，即运行时环境。与Java类似，我们指代不同的部分differyl、JRE、JVM、JDK等。

有关更多信息，请参阅 Wikipedia Entry: [Interpreter](http://en.wikipedia.org/wiki/Interpreter_(computing))和[Virtual Machine](http://en.wikipedia.org/wiki/Virtual_machine)。[这里](http://www.kinabaloo.com/jvm.html)还有一个。在这里您可以找到[应用程序虚拟机的比较](http://en.wikipedia.org/wiki/Comparison_of_application_virtual_machines)。它有助于理解编译器、解释器和虚拟机之间的区别。

* * *

## 回答 #5

> 赞同：14
> 
>             
> 
> 时间：2018-11-17T23:10:36.683

*为了对“为什么是 Java 虚拟机，而使用 Python 解释器？* ”这个问题提供一个深刻的答案，让我们试着回到编译理论领域作为讨论的起点。

程序编译的典型过程包括以下步骤：

1.  *词法分析*。将程序文本拆分为有意义的“单词”，称为**标记**（作为该过程的一部分，所有注释、空格、换行符等都将被删除，因为它们不会影响程序行为）。结果是有序的令牌流。

2.  *语法分析*。从标记流构建所谓的**抽象语法树 (AST) 。**AST 建立令牌之间的关系，并因此定义程序的评估顺序。

3.  *语义分析*。使用有关类型的信息和一组编程语言的语义规则来验证 AST 的语义正确性。（例如，从语法的角度来看是正确的陈述，但如果被声明为常量对象`a = b + c`，则从语义的角度来看是完全错误的）`a`

4.  *中间代码生成*。将 AST 序列化为与机器无关的“原始”操作的线性排序流。事实上，代码生成器会遍历 AST 并记录评估步骤的顺序。结果，从程序的树状表示中，我们实现了更简单的列表状表示，其中保留了程序评估的顺序。

5.  *机器码生成*。机器独立“原始”字节码形式的程序被翻译成特定处理器架构的机器码。

行。现在让我们定义这些术语。

**解释器**，在该词的经典含义中，假定基于直接从程序**文本**产生的 AST 的程序评估执行。**在这种情况下，程序以源代码**的形式分发，解释器由程序文本提供，通常以动态方式（逐语句或逐行）。对于每个输入语句，解释器构建它的 AST 并立即评估它以改变程序的“状态”。这是脚本语言所展示的典型行为。例如考虑 Bash、Windows CMD 等。从概念上讲，Python 也采用这种方式。

如果我们在解释器中生成与机器无关的中间二进制字节码步骤替换基于 AST 的执行步骤，我们会将程序执行的整个过程分成两个独立的阶段：编译和执行。在这种情况下，以前的解释器将变成字节码编译器，它将程序从**文本**形式转换为某种**二进制**形式。然后程序以二进制形式分发，而不是以源代码的形式分发。在用户机器上，该字节码被输入一个新实体——**虚拟机**，它实际上解释了该字节码。因此，虚拟机也被称为**字节码解释器**。但是把你的注意力放在这里！古典口译员是**文本解释器**，但虚拟机是**二进制解释器**！这是 Java 和 C# 采用的方法。

最后，如果我们将机器代码生成添加到字节码编译器中，我们就可以实现我们所说的经典**编译器**。经典编译器将程序源代码转换为特定处理器的**机器代码。**然后，该机器代码可以**直接**在目标处理器上执行，无需任何额外的中介（无需任何类型的解释器，既没有文本解释器，也没有二进制解释器）。

现在让我们回到最初的问题，考虑 Java 与 Python。

*Java*最初被设计为具有尽可能少的实现依赖项。它的设计基于“一次编写，随处运行”（WORA）的原则。为了实现它，*Java*最初被设计为一种编程语言，可以编译成与机器无关的**二进制字节码**，然后可以在所有支持*Java*的平台上执行，而无需重新编译。您可以像考虑基于 WORA 的*C++一样考虑**Java*。实际上，*Java*更接近于*C++*，而不是像*Python*这样的脚本语言。但与*C++*相比，*Java*******被设计为编译成**二进制字节码**，然后在**虚拟机**环境中执行，而*C++*被设计为编译成机器码，然后直接由目标处理器执行。******

 ***Python*最初被设计为一种脚本编程语言，它解释脚本（按照编程语言规则编写的**文本形式的程序）。**因此，Python 最初支持单行命令或语句的动态解释，就像 Bash 或 Windows CMD 所做的那样。出于同样的原因，Python 的初始实现没有任何类型的字节码编译器和用于执行此类字节码的虚拟机，但从一开始，*Python*就需要能够理解和评估 Python 程序**文本的****解释器**。

 **正因为如此，历史上，*Java*开发者倾向于谈论**Java 虚拟机**（因为最初，*Java*是作为*Java*字节码编译器和**字节码解释**器的包**JVM**出现的），而*Python*开发者倾向于谈论*Python*解释器（因为最初*Python*有不是任何虚拟机，而是一种经典的**文本解释器**，它直接执行程序**文本**，无需任何类型的编译或转换为任何形式的二进制代码）。

目前，Python 也有底层的虚拟机，可以编译和解释 Python 字节码。这一事实对“*为什么是 Java 虚拟机，而是 Python 解释器？*并且程序将展示完全相同的行为并从相同的输入产生相同的输出。唯一可观察到的区别是程序执行的速度和解释器消耗的内存量。因此，Python 中的虚拟机并不是语言设计中不可避免的一部分，而只是主要 Python 解释器的一个可选扩展。

可以以类似的方式考虑 Java。Java底层有一个JIT编译器，可以选择性地将Java类的方法编译成目标平台的机器码，然后直接执行。但！Java 仍然使用字节码解释作为 Java 程序执行的主要方式。与专门利用底层虚拟机作为优化技术的 Python 实现一样，Java 虚拟机专门使用即时编译器进行优化。同样，只是因为直接执行机器码至少比解释 Java 字节码快十倍。和 Python 一样，JVM 底层 JIT 编译器的存在对于 Java 语言设计者和 Java 程序开发者来说都是绝对透明的。使用和不使用 JIT 编译器的 JVM 都可以实现相同的 Java 编程语言。同样，相同的程序可以在内部有或没有 JIT 的 JVM 中执行，并且相同的程序将展示完全相同的行为，并从两个 JVM（有和没有 JIT）上的相同输入产生相同的输出。和 Python 一样，它们之间唯一可观察到的区别在于执行速度和 JVM 消耗的内存量。最后，就像 Python 一样，Java 中的 JIT 也不是语言设计中不可避免的一部分，而只是主要 JVM 实现的可选扩展。并且相同的程序将展示完全相同的行为，并从两个 JVM（使用和不使用 JIT）上的相同输入产生相同的输出。和 Python 一样，它们之间唯一可观察到的区别在于执行速度和 JVM 消耗的内存量。最后，就像 Python 一样，Java 中的 JIT 也不是语言设计中不可避免的一部分，而只是主要 JVM 实现的可选扩展。并且相同的程序将展示完全相同的行为，并从两个 JVM（使用和不使用 JIT）上的相同输入产生相同的输出。和 Python 一样，它们之间唯一可观察到的区别在于执行速度和 JVM 消耗的内存量。最后，就像 Python 一样，Java 中的 JIT 也不是语言设计中不可避免的一部分，而只是主要 JVM 实现的可选扩展。

从 Java 和 Python 虚拟机的设计和实现的角度来看，它们有很大的不同，而（注意！）两者仍然是虚拟机。JVM是一个基本操作简单、指令调度成本高的低级虚拟机的例子。反过来，Python 是一个高级虚拟机，指令表现出复杂的行为，指令调度成本并不那么重要。Java 以非常低的抽象级别运行。JVM 在少量定义良好的原始类型集上运行，并且在字节码指令和本机机器码指令之间具有非常紧密的对应关系（通常是一对一的）。相反，Python 虚拟机运行在高抽象级别，它运行复杂的数据类型（对象）并支持 ad-hoc 多态性，而字节码指令暴露了复杂的行为，可以用一系列多条本机机器码指令来表示。例如，Python 支持无限范围数学。因此，Python VM 被迫利用长算法来处理可能会导致机器字溢出的大整数。因此，Python 中用于算术的一条字节码指令可以暴露在 Python VM 内部的函数调用中，而在 JVM 中，算术运算将暴露为由一条或几条本机机器指令表示的简单操作。因此，Python VM 被迫利用长算法来处理可能会导致机器字溢出的大整数。因此，Python 中用于算术的一条字节码指令可以暴露在 Python VM 内部的函数调用中，而在 JVM 中，算术运算将暴露为由一条或几条本机机器指令表示的简单操作。因此，Python VM 被迫利用长算法来处理可能会导致机器字溢出的大整数。因此，Python 中用于算术的一条字节码指令可以暴露在 Python VM 内部的函数调用中，而在 JVM 中，算术运算将暴露为由一条或几条本机机器指令表示的简单操作。

因此，我们可以得出下一个结论。Java 虚拟机但 Python 解释器是因为：

1.  虚拟机术语假定二进制字节码解释，而术语解释器假定程序文本解释。

2.  从历史上看，Java 是为解释二进制字节码而设计和实现的，而 Python 最初是为解释程序文本而设计和实现的。因此，“Java 虚拟机”这个术语在 Java 社区中具有历史意义并且非常成熟。类似地，“Python 解释器”这个术语在 Python 社区中具有历史意义并且非常成熟。人们倾向于延长传统并使用很久以前使用的相同术语。

3.  最后，目前，对于 Java，二进制字节码解释是程序执行的主要方式，而 JIT 编译只是一种可选的和透明的优化。而对于 Python，目前，程序文本解释是 Python 程序执行的主要方式，而编译成 Python VM 字节码只是一种可选且透明的优化。

* * *

因此，Java 和 Python 的虚拟机都是二进制字节码解释器，这会导致诸如“*为什么是 Java 虚拟机，但是 Python 解释器？*”。这里的重点是，对于Python来说，虚拟机并不是程序执行的主要或必要手段；它只是经典文本解释器的可选扩展。另一方面，虚拟机是核心，不可避免Java 程序执行生态系统的一部分。编程语言设计的静态或动态类型选择主要影响虚拟机抽象级别，但不决定是否需要虚拟机。使用这两种类型系统的语言可以设计为可编译、解释或在虚拟机环境中执行，具体取决于它们所需的执行模型。

* * *

## 回答 #6

> 赞同：12
> 
>             
> 
> 时间：2009-01-14T04:27:47.767

术语解释器是可以追溯到早期的 shell 脚本语言的遗留术语。随着“脚本语言”已经发展为功能齐全的语言，并且其相应的平台变得更加复杂和沙盒化，虚拟机和解释器（在 Python 意义上）之间的区别非常小或不存在。

Python 解释器仍然以与 shell 脚本相同的方式运行，因为它可以在没有单独的编译步骤的情况下执行。除此之外，Python 的解释器（或 Perl 或 Ruby 的）和 Java 的虚拟机之间的区别主要在于实现细节。（有人可能会争辩说，Java 比 Python 更完全沙盒化，但两者最终都通过原生 C 接口提供对底层架构的访问。）

* * *

## 回答 #7

> 赞同：11
> 
>             
> 
> 时间：2009-01-14T03:41:23.023

它们之间没有真正的区别，人们只是遵循创作者选择的约定。

* * *

## 回答 #8

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T04:36:21.493

不要忘记 Python 有可用于 x86 的 JIT 编译器，这进一步混淆了这个问题。（见心理）。

只有在讨论 VM 的性能问题时，对“解释性语言”的更严格解释才会有用，例如，与 Python 相比，Ruby 被（是？）认为速度较慢，因为它是一种解释性语言，与 Python 不同——在其他方面话，上下文就是一切。

* * *

## 回答 #9

> 赞同：3
> 
>             
> 
> 时间：2019-09-15T09:33:01.583

**Python 可以**解释代码而无需将其编译为字节码。**Java 不能**。

> Python 是一种解释语言，而不是编译语言，尽管由于字节码编译器的存在，区别可能会很模糊。这意味着可以直接运行源文件，而无需显式创建随后运行的可执行文件。

（来自文档）。

在java中，每个文件*都*必须编译成一个`.class`文件，然后在JVM上运行。相反，python 会由您的主脚本导入，以帮助加快这些文件的后续使用。

但是，在典型情况下，大多数 python（至少是 CPython）代码在模拟堆栈机器中运行，它的指令与 JVM 的指令几乎相同，因此没有太大区别。

然而，造成这种差异的真正原因是，从一开始，java 就将自己标榜为“可移植、可执行的字节码”，而 python 将自己标榜为带有 REPL 的动态解释语言。名字贴！

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2019-10-02T10:41:02.450

我认为两者之间的界限很模糊，人们大多围绕“解释器”一词的含义以及该语言与“解释器...编译器”范围的每一方的接近程度争论不休。然而，没有人能做到 100%。我认为编写具有任何价值的 Java 或 Python 实现都很容易。

目前，Java 和 Python 都有虚拟机和字节码，虽然其中一个通过具体的值大小（如 32 位整数）进行操作，而另一个则必须确定每个调用的大小，我认为这并没有定义术语之间的边界。

Python没有官方定义的字节码，它只存在于内存中的论点也不能说服我，只是因为我打算开发只能识别Python字节码的设备，编译部分将在浏览器JS机器中完成。

性能仅与具体实现有关。我们不需要知道对象的大小就可以使用它，最后，在大多数情况下，我们使用的是结构，而不是基本类型。可以通过重用现有对象来优化 Python VM，从而消除在表达式计算期间每次创建新对象的需要。一旦完成，计算两个整数之和之间就没有全局性能差异，这就是 Java 的亮点。

两者之间没有致命的区别，只有一些与最终用户无关的实现细微差别和缺乏优化，也许在她开始注意到性能滞后的时候，但同样是实现而不是架构问题。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2016-10-01T09:06:40.623

首先，您应该了解编程或计算机科学一般不是数学，我们对我们经常使用的大多数术语没有严格的定义。

现在回答你的问题：

**什么是口译员**（计算机科学）

它按最小的可执行单元翻译源代码，然后执行该单元。

**什么是虚拟机**

在 JVM 的情况下，虚拟机是一个包含解释器、类加载器、垃圾收集器、线程调度器、JIT 编译器和许多其他东西的软件。

如您所见，解释器是一部分或 JVM，而整个 JVM 不能称为解释器，因为它包含许多其他组件。

**为什么在谈论 python 时使用“解释器”这个词**

使用 java，编译部分是明确的。另一方面，python 并不像 java 那样明确其编译和解释过程，从最终用户的角度来看，解释是用于执行 python 程序的唯一机制

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2018-03-12T17:46:44.020

不，它们都不解释字节码。

如果您使用 pypy 运行，Python 只会解释字节码。否则，它将被编译成 C 并在该级别进行解释。

Java 编译为字节码。

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2020-01-13T23:52:24.180

对于提到 python 不需要生成字节码的帖子，我不确定这是真的。似乎 Python 中的所有可调用对象都必须具有`.__code__.co_code`包含字节码的属性。我没有看到一个有意义的理由将 python 称为“未编译”，只是因为编译的工件可能无法保存；并且通常不是通过设计在 Python 中保存的，例如，所有理解都会为其输入编译新字节码，这就是理解变量范围在运行 python 脚本和使用 pdb之间`compile(mode='exec, ...)`和编译之间不一致的原因`compile(mode='single', ...)`

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2021-04-02T09:45:11.077

实际上，HotSpot 运行时被称为虚拟机而 CPython 仅被称为解释器可能是有原因的

首先，CPython 只是普通的、基于堆栈的字节码解释器。您将 Python 操作码输入其中，CPython 中的软件堆栈机器会评估您的代码，就像普通的解释器一样。

Java HotSpot 运行时不同。首先，Java 有 3 个即时编译器，C1、C2 和一个尚未使用的实验性编译器。但这不是主要原因。JVM 内部的解释器是一种非常特殊的解释器，称为模板解释器。JVM 中的模板解释器包含一个巨大的数组列表，而不是像 CPython（实际上几乎所有其他解释器都这样做）那样直接在大量操作码 switch case 语句中执行字节码。它包含什么？字节码和本机 CPU 指令的键值对！数组列表在启动时是空的，并且充满了指向本地机器语言的字节码映射，以便在应用程序启动之前直接在硬件上运行，这意味着 JVM 内的“解释器”不是 t 实际上是一个解释器 - 它实际上是一个折扣编译器！当 Java 字节码运行时，“解释器”只是简单地将输入字节码直接映射到本机机器语言并直接执行本机映射，而不是在软件中实现。我不确定为什么 JVM 是这样制作的，但我怀疑它是为了轻松地无缝执行“解释”代码和 JIT 编译代码，并提高速度/性能。如果您将没有 JIT 的 JVM 与 CPython 或大多数其他解释器进行比较，它可能仍然会领先于它们，因为它的巧妙设计据我所知是其他语言以前没有使用过的。简单地将输入字节码直接映射到本机机器语言并直接执行本机映射，而不是在软件中实现它。我不确定为什么 JVM 是这样制作的，但我怀疑它是为了轻松地无缝执行“解释”代码和 JIT 编译代码，并提高速度/性能。如果您将没有 JIT 的 JVM 与 CPython 或大多数其他解释器进行比较，它可能仍然会领先于它们，因为它的巧妙设计据我所知是其他语言以前没有使用过的。简单地将输入字节码直接映射到本机机器语言并直接执行本机映射，而不是在软件中实现它。我不确定为什么 JVM 是这样制作的，但我怀疑它是为了轻松地无缝执行“解释”代码和 JIT 编译代码，并提高速度/性能。如果您将没有 JIT 的 JVM 与 CPython 或大多数其他解释器进行比较，它可能仍然会领先于它们，因为它的巧妙设计据我所知是其他语言以前没有使用过的。

# c++ - 在堆栈上分配的变量上调用 delete

> ID：441831
> 
>         
> 
> 赞同：80
> 
>         
> 
> 时间：2009-01-14T03:41:58.687
> 
>         
> 
> 标签：c++, stack, heap-memory, delete-operator

忽略编程风格和设计，在堆栈上分配的变量上调用 delete 是否“安全”？

例如：

```
 int nAmount;
   delete &nAmount; 
```

或者

```
class sample
{
public:
    sample();
    ~sample() { delete &nAmount;}
    int nAmount;
} 
```

* * *

## 回答 #1

> 赞同：130
> 
>             
> 
> 时间：2009-01-14T03:44:51.737

[不](https://msdn.microsoft.com/en-us/library/h6227113(v=vs.140).aspx)`delete`，调用堆栈分配的变量是不安全的。你应该只调用`delete`由`new`.

*   对于每个`malloc`or `calloc`，都应该有一个`free`。  

*   每一个都`new`应该有一个`delete`。  

*   每一个都`new[]`应该有一个`delete[]`。  

*   对于每个堆栈分配，不应该有明确的释放或删除。在适用的情况下，会自动调用析构函数。  

通常，您不能混合和匹配其中的任何一个，例如 no `free`-ing 或`delete[]`-ing`new`对象。这样做会导致未定义的行为。

* * *

## 回答 #2

> 赞同：57
> 
>             
> 
> 时间：2009-01-14T03:47:23.747

好吧，让我们尝试一下：

```
jeremy@jeremy-desktop:~$ echo 'main() { int a; delete &a; }' > test.cpp
jeremy@jeremy-desktop:~$ g++ -o test test.cpp
jeremy@jeremy-desktop:~$ ./test
Segmentation fault 
```

所以显然它根本不安全。

* * *

## 回答 #3

> 赞同：18
> 
>             
> 
> 时间：2009-01-14T05:11:47.677

请记住，当您使用 new （或 malloc ）分配内存块时，实际分配的内存块将大于您要求的内存块。内存块还将包含一些簿记信息，因此当您释放块时，它可以很容易地放回空闲池并可能与相邻的空闲块合并。

当您尝试释放您没有从 new 接收到的任何内存时，该簿记信息将不存在，但系统将按原样运行，结果将是不可预测的（通常是坏的）。

* * *

## 回答 #4

> 赞同：11
> 
>             
> 
> 时间：2012-09-20T13:19:15.450

是的，这是未定义的行为：传递给`delete`任何不是来自`new`UB 的东西：

> C++ 标准，第 3.7.3.2.3 节：提供给标准库中提供的一个释放函数的第一个参数的值可以是`null`指针值；如果是这样，并且如果释放函数是标准库中提供的函数，则对释放函数的调用无效。否则，提供给`operator delete(void*)`标准库的值应是先前调用标准库中的一个`operator new(std::size_t)`或一个返回的值之一`operator new(std::size_t, const std::nothrow_t&)`。

未定义行为的后果是未定义的。“什么都没有发生”与其他任何事情一样有效。然而，它通常是“什么都不会立即发生”：释放无效的内存块可能会在随后调用分配器时产生严重的后果。

* * *

## 回答 #5

> 赞同：8
> 
>             
> 
> 时间：2011-05-17T19:37:00.573

在 windows 中玩了一下 g++ 4.4 之后，我得到了非常有趣的结果：

1.  在堆栈变量上调用 delete 似乎没有做任何事情。没有错误抛出，但我可以在删除后毫无问题地访问变量。

2.  如果对象在堆中分配，则具有方法的类`delete this`会成功删除对象，但如果在堆栈中分配则不会（如果在堆栈中，则不会发生任何事情）。

* * *

## 回答 #6

> 赞同：5
> 
>             
> 
> 时间：2012-09-20T13:18:56.750

没有人能知道会发生什么。这会调用未定义的行为，因此实际上任何事情都可能发生。**不要这样做。**

* * *

## 回答 #7

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T10:02:15.657

不，使用 new 分配的内存应该使用 delete 运算符删除，使用 malloc 分配的内存应该使用 free 删除。并且无需释放分配在堆栈上的变量。

* * *

## 回答 #8

> 赞同：3
> 
>             
> 
> 时间：2012-09-20T13:19:03.360

天使失去了它的翅膀......你只能调用`delete`分配有的指针`new`，否则你会得到未定义的行为。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T10:28:16.183

这里的内存是使用堆栈分配的，所以不需要从外部删除它，但如果你已经动态分配

像 int *a=new int()

那么你必须删除 a 而不是删除 &a（a 本身是一个指针），因为内存是从自由存储区分配的。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2012-09-20T13:19:46.573

你已经自己回答了这个问题。`delete`只能用于通过`new`. 做任何其他事情都是简单明了的未定义行为。

因此，真的没有说会发生什么，从代码正常工作到崩溃到擦除硬盘驱动器的任何事情都是这样做的有效结果。所以请*永远不要这样做*。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2012-09-20T13:19:51.613

这是 UB，因为您不能对尚未动态分配 new 的项目调用 delete。就是这么简单。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2021-07-14T10:47:02.203

动机：我有两个对象，`A`和`B`。我知道`A`之前必须实例化`B`，可能是因为`B`需要由`A`. 然而，我想破坏`A`之前`B`。也许我正在编写一个集成测试，我希望服务器 A 先关闭。我该如何做到这一点？

```
A a{};
B b{a.port()};

// delete A, how? 
```

解决方案：不要`A`在堆栈上分配。相反，使用`std::make_unique`并保留一个堆栈分配的智能指针，指向堆分配的`A`. 这种方式是最不混乱的选择，IMO。

```
auto a = std::make_unique<A>();
B b{a->port()};

// ...

a.reset() 
```

或者，我考虑将销毁逻辑移出`A`' 析构函数并自己显式调用该方法。析构函数只有在之前没有被调用过时才会调用它。

# python - ASP.NET MVC 上的 IronPython

> ID：441838
> 
>         
> 
> 赞同：24
> 
>         
> 
> 时间：2009-01-14T03:45:24.467
> 
>         
> 
> 标签：python, asp.net-mvc, linq, dynamic, ironpython

有没有人尝试过使用 IronPython 的 ASP.NET MVC？最近做了很多 Python 开发，在我进入一个潜在的 ASP.NET MVC 项目时继续使用该语言会很好。

我对利用 .NET 功能（例如 LINQ）利用 Python 的动态方面特别感兴趣，并且想知道这是否可行。对于某些动态编程可能可行的另一条路线是 C# 4.0 及其`dynamic`关键字。

想法、经验？

* * *

## 回答 #1

> 赞同：14
> 
>             
> 
> 时间：2009-01-14T14:16:01.120

是的，[DLR 团队有一个 MVC 示例](http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=17613)。

您可能还对[Spark](http://sparkviewengine.com/documentation/ironpython)感兴趣。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2010-11-19T08:59:15.513

在 ASP.NET MVC 中使用 IronPython：http: [//www.codevoyeur.com/Articles/Tags/ironpython.aspx](http://www.codevoyeur.com/Articles/Tags/ironpython.aspx) 

此页面包含以下文章：

*   一个用于 ASP.NET MVC 的简单 IronPython ControllerFactory

*   用于 ASP.NET MVC 的简单 IronPython ActionFilter

*   一个用于 ASP.NET MVC 的简单 IronPython 路由映射器

*   用于 ASP.NET MVC 的不显眼 IronPython ViewEngine

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2016-02-23T16:41:54.200

我目前正在做这件事。它已经支持了很多东西：[https ://github.com/simplic-systems/ironpython-aspnet-mvc](https://github.com/simplic-systems/ironpython-aspnet-mvc)

更多信息：

导入`aspnet`模块

```
import aspnet 
```

您可以编写自己的控制器

```
class HomeController(aspnet.Controller):

    def index(self):
        return self.view("~/Views/Home/Index.cshtml") 
```

您可以自动注册所有控制器

```
aspnet.Routing.register_all() 
```

您可以使用不同的 http 方法

```
@aspnet.Filter.httpPost
    def postSample(self):
        return self.view("~/Views/Home/Index.cshtml") 
```

还有更多。这是一个非常简短的示例

```
# ------------------------------------------------
# This is the root of any IronPython based
# AspNet MVC application.
# ------------------------------------------------

import aspnet

# Define "root" class of the MVC-System
class App(aspnet.Application):

    # Start IronPython asp.net mvc application. 
    # Routes and other stuff can be registered here
    def start(self):

        # Register all routes
        aspnet.Routing.register_all()

        # Set layout
        aspnet.Views.set_layout('~/Views/Shared/_Layout.cshtml')

        # Load style bundle
        bundle = aspnet.StyleBundle('~/Content/css')
        bundle.include("~/Content/css/all.css")

        aspnet.Bundles.add(bundle)

class HomeController(aspnet.Controller):

    def index(self):
        return self.view("~/Views/Home/Index.cshtml")

    def page(self):
        # Works also with default paths
        return self.view()

    def paramSample(self, id, id2 = 'default-value for id2'):
        # Works also with default paths
        model = SampleModel()
        model.id = id
        model.id2 = id2
        return self.view("~/Views/Home/ParamSample.cshtml", model)

    @aspnet.Filter.httpPost
    def postSample(self):
        return self.view("~/Views/Home/Index.cshtml")

class SampleModel:
    id = 0
    id2 = ''

class ProductController(aspnet.Controller):

    def index(self):
        return self.view("~/Views/Product/Index.cshtml") 
```

# python - 用于构建 TCP 服务器的好的 Python 网络库？

> ID：441849
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2009-01-14T03:51:13.877
> 
>         
> 
> 标签：python, networking, twisted

我只是想知道有哪些网络库可用于 Python 构建 TCP/IP 服务器。我知道 Twisted 可能会跳到我的脑海中，但文档对我来说似乎稀缺、草率和分散。

此外，使用 Twisted 甚至比使用 select.select() 滚动我自己的服务器有好处吗？

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-01-14T04:06:30.930

我必须同意文档有点简洁，但教程可以让你快速上手。

[http://twistedmatrix.com/projects/core/documentation/howto/tutorial/index.html](http://twistedmatrix.com/projects/core/documentation/howto/tutorial/index.html)

Twisted 的基于事件的编程范式和它的延迟在一开始可能有点奇怪（对我来说），但值得学习曲线。

与编写自己的框架相比，您将能够更快地启动并运行更复杂的东西，并且这也意味着寻找错误的事情少了一件，因为 Twisted 已经在生产中得到了很好的证明。

我真的不知道另一个框架可以提供 Twisted 所能提供的那么多，所以我的投票肯定会投给 Twisted，即使文档不适合胆小的人。

我同意 Greg 的观点，即 SocketServer 是一个不错的中间地带，但取决于您的应用程序的目标受众及其设计，您可能会在 Twisted 中有一些值得期待的好东西（想到非常有用的 PerspectiveBroker - [http： //twistedmatrix.com/projects/core/documentation/howto/pb-intro.html](http://twistedmatrix.com/projects/core/documentation/howto/pb-intro.html) )

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-01-14T04:00:44.670

标准库包括 SocketServer 和相关模块，可能足以满足您的需求。这是在像 Twisted 这样的复杂框架和滚动你自己的 select() 循环之间的一个很好的中间地带。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T04:13:47.873

如果您不愿意使用 Twisted，您可能需要查看[SocketServer.ThreadingTCPServer](http://danieldandrada.blogspot.com/2007/09/python-socketserverthreadingtcpserver.html)。它很容易使用，并且可以*用于*许多目的。

在大多数情况下，Twisted 可能会更快、更可靠，所以如果可以的话，我会接受文档 :)

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T06:19:12.923

只需添加一个答案以重新迭代其他海报 - 使用 Twisted 是值得的。没有理由编写另一个 TCP 服务器，它最终会像使用 twisted 的那样工作。唯一的原因是，如果编写自己的代码更快，对开发人员来说更快，但如果你现在咬紧牙关学习扭曲，你未来的项目将受益匪浅。而且，正如其他人所说，如果你从一开始就使用twisted，你将能够做更复杂的事情。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-01-15T02:50:14.000

我尝试了 3 种方法：

*   编写我自己的 select() 循环[框架](http://sourceforge.net/projects/joeagent/)（几乎死了，我不一定推荐它。）

*   使用套接字服务器

*   [扭曲的](http://twistedmatrix.com/trac/)

我将 SocketServer 用于流量相当低的内部 Web 服务。用于相当高流量的内部日志服务。两者都表现得非常好，并且对于生产使用来说似乎非常可靠。对于任何需要高性能的东西，我认为 Twisted 的东西要好得多，但要了解架构还需要做更多的工作。

# python - 哪个新的 mp3 播放器可以运行旧的 Python 脚本

> ID：441864
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-14T04:01:29.490
> 
>         
> 
> 标签：python, embedded, mp3

我可以购买哪个 mp3/媒体播放器，它可以让我运行现有的一组 python 脚本。

现有的脚本控制 linux 上的 xmms：提供“下一个曲目”给定关于收视率/上次播放/流派/获得多长时间/....的数据，以便它全部在楼上某处的服务器上运行，我不需要选择任何事物。

我想在车上使用这些脚本，我希望有一些媒体播放器可以让我从 Python 更改其播放列表/当前歌曲。你能推荐这样的机器吗？

（我宁愿避免使用各种类型的 iPod - 它们对我来说有点过于“以最终用户为中心”）

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T04:59:55.550

我知道的唯一可能性是使用[Rockbox](http://www.rockbox.org/)，然后[将 Python 解释器移植](http://www.rockbox.org/mail/archive/rockbox-dev-archive-2008-08/0111.shtml)到它，或者只是将功能移植到某些 C 程序集，以最适合您的方式。它甚至可能带有您已经需要的功能，因此您只需要调整一些配置文件。

> Rockbox 是用于 mp3 播放器的开源固件，从头开始编写。它适用于广泛的播放器：
> 
>   
>   
> 
> *   Apple：第 1 代至第 5.5 代 iPod、iPod Mini 和第 1 代 iPod Nano（不是 Shuffle、第 2/3/4 代 Nano、Classic 或 Touch）
> 
> *   爱可视：点唱机 5000、6000、工作室、录音机、FM 录音机、录音机 V2 和 Ondio
> 
> *   Cowon：iAudio X5、X5V、X5L、M5、M5L、M3 和 M3L
> 
> *   iriver：H100、H300 和 H10 系列
> 
> *   奥林巴斯：M:Robe 100
> 
> *   SanDisk：Sansa c200、e200 和 e200R 系列（不是 v2 型号）
> 
> *   东芝：Gigabeat X 和 F 系列（不是 S 系列）

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-20T03:41:11.793

另一种可能性是使用旧的 iPod 和[iPod Linux](http://ipodlinux.org/)以及[用于 iPod Linux 的 Python 端口](http://ciberjacobo.com/en/linux_on_ipod.html#python)。

您将使用 Podzilla 的 Media Player Daemon 作为播放器，并且您必须弄清楚如何让您的 python 脚本向它发送控制消息而不是 xmms。  

# sql-server-2005 - 在日期时间创建计算列

> ID：441869
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-14T04:03:04.243
> 
>         
> 
> 标签：sql-server-2005, calculated-columns

我的 SQL Server 2005 表中有一个可以为空的 DateTime 列，名为 DateTimeDeleted。

我想要一个 BIT 类型的计算列，如果 DateTimeDeleted 不为空，则为 1，否则为 0。但是，我似乎无法正确获取公式的语法。

我试过了：

```
(TsDeleted IS NULL) = 0 
```

但它给了我一个语法错误。

帮助！:)

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-01-14T05:09:04.157

```
Alter Table MyTableName 
  Add IsDeleted As 
     (Case When [DateTimeDeleted] Is Null 
       Then (0) Else (1) End) 
```

这将输出为一个整数......如果你真的希望它有点，那么：

```
Alter Table MyTableName 
  Add IsDeleted As 
     cast( (Case When [DateTimeDeleted] Is Null 
       Then (0) Else (1) End) as Bit) 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T04:10:51.747

我认为这应该有效：

```
update table
set IsDeleted = case when DateTimeDeleted is null then 0 else 1 end 
```

* * *

## 回答 #3

> 赞同：-1
> 
>             
> 
> 时间：2009-01-14T05:25:07.590

这将起作用，基本上，如果它不为空，它会自行除法，然后如果它为 NULL，则将 0 除以 1

```
CONVERT(INT,IsNULL(DateTimeDeleted,0))/CONVERT(INT,IsNULL(DateTimeDeleted,1)) 
```

# sql - 相等的？不，但为什么？

> ID：441880
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-14T04:13:27.267
> 
>         
> 
> 标签：sql, tsql, date

T-SQL：

1（ANSI）：    `convert(varchar(10),@DueDate, 102) < convert(varchar(10),getdate(), 102)`

2（美国）：    `convert(varchar(10),@DueDate, 101) < convert(varchar(10),getdate(), 101)`

请注意，当考虑年份时，这些将返回不同的结果。

为什么？

有什么不同？为什么运营商在使用#2 时不考虑年份？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T04:22:30.257

你想做什么？你在那里比较varchars。查看这些语句的输出：

```
print convert(varchar(10), getdate(), 101)
print convert(varchar(10), getdate(), 102) 
```

打印这个：

```
01/14/2009
2009.01.14 
```

比较第一个表格实际上只是检查一个日期的月份是否小于当前日期的月份。

是否有理由需要将日期转换为 varchar？为什么不直接比较呢？

```
@DueDate < getdate() 
```

# debugging - 使用可互换的单例简化调试？

> ID：441884
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-14T04:16:40.583
> 
>         
> 
> 标签：debugging, configuration, module

我有一些类，例如那些概述数据库表结构的类或那些概述应用程序配置的类，它们在整个程序执行过程中根本不会改变状态。我目前将这些类作为单例，希望检索信息的类请求类实例（例如，从常见的 getInstance() 方法），然后继续检索他们想要的信息。虽然这可行，但我希望在配置方面允许更多的模块化，这就是我卡住的地方。

我的主要目标是通过模块化配置更轻松地进行调试，同时仍然保持代码的可读性。我不确定我将如何允许交换配置以进行调试，而不包括另一个 Singleton(tm)，使用配置设置的类可以从中检索正确的配置实例。

这是针对 PHP Web 应用程序的，但没有这样标记，因为我猜该解决方案很可能与语言无关。

**编辑：**为了澄清我的问题，尽管就我的问题的答案而言，依赖注入让我很喜欢，但让我提供一个（可能过于简单化）的例子。

假设我有一个 PHP 的 Mysqli 类的包装器，它将简单地使用 Config 单例中标识的任何连接信息......

```
class Mysql {
    // ...
    private $mysqli;

    public function __construct() {
        $conf = Config::getInstance(); // Get the configuration
        $this->mysqli = new Mysqli(
            $conf->getHost(),
            $conf->getUsername(),
            $conf->getPassword()
        );
        // ...
    }
    // ...
} 
```

在这个例子中，Mysql 类将只接受 Config 中包含的设置，并且不能使用除了 Config 中包含的任何配置。在此示例中，将主机/用户名/密码/其他任何内容简单地传递给构造函数可能更有意义，但随后它落在使用 Mysql 类从 Config 单例中检索它的客户端上，并且问题在许多方面再次表现出来更多课程。因为它最终总是从 Config 中检索依赖项，所以无法通过此设置轻松尝试不同的设置。

从我在几个地方读到的内容，包括这里的精彩评论，似乎依赖注入是我最好的选择。[对于未来的潜在读者，我在这里](http://www.developertutorials.com/tutorials/php/the-zend-framework-dependency-injection-and-zend-di-8-02-07/page1.html)找到了一篇关于 PHP 依赖注入的好文章，以及对概念的简化介绍（在 Java 中）[。](http://www.theserverside.com/tt/articles/article.tss?l=IOCBeginners)

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T04:23:46.480

这是依赖注入的主要规则。这个想法是在运行时注入一个类的实例。在测试期间，您注入具有相同接口的其他东西。它可以是虚拟类、模拟对象或由测试创建的具有预期状态的常规实例。

# javascript - 哪个更快： Math.abs(value) 或 value * -1 ？

> ID：441893
> 
>         
> 
> 赞同：42
> 
>         
> 
> 时间：2009-01-14T04:22:38.260
> 
>         
> 
> 标签：javascript, performance

很简单，但我只想知道哪个更快。

我认为简单地将一个数字乘以`-1`比调用预定义的方法要快得多，前提是您确定该值为负数。

但如果是这样的话，那么这个`abs()`功能有什么用呢？是否只是为了确保无论值的符号如何，返回的值始终为正？

* * *

## 回答 #1

> 赞同：77
> 
>             
> 
> 时间：2009-01-14T07:55:57.673

*2012 年 8 月更新*：

我对这些实现做了一些分析：

```
/* Test 1: */ b = Math.abs(a);
/* Test 2: */ b = abs(a); //local copy: abs = Math.abs;
/* Test 3: */ b = a < 0 ? a * -1 : a;
/* Test 4: */ b = a < 0 ? -a : a; 
```

我在 Windows 7 上得到了以下结果。在每个浏览器的最快结果之后对值进行标准化，以便更容易比较哪种方法更快：

```
 1:Math 2:abs 3:*-1  4:-    1.0=   Version
Chrome    1.0   1.0   1.0   1.0    111ms  21.0.1180.75 m
Firefox   1.0   1.0   1.2   1.2    127ms  14.0.1
IE        1.4   1.0   1.1   1.0    185ms  9.0.8112
Opera     1.9   1.6   1.1   1.0    246ms  12.00
Safari    1.6   1.6   1.1   1.0    308ms  5.1.7 
```

**结论：** 
3 年前我做这个测试时，-a 是最快的，但现在 Math.abs(x) 在 Firefox 中更快！在 Chrome中`abs(a)`并且`-a`得到了相同的时间，当我用 10 000 000 个数字测试它时，与最慢的方法只有 3 毫秒的差异。  

**我的建议**：使用**Math.abs(a)**。如果你在一个紧密的循环中并且通过分析发现它太慢了，你可以使用对 abs 函数的本地引用：

```
var abs=Math.abs; //A local reference to the global Math.abs function
for (i=0;i<1234567890;++i) if ( abs( v[i] ) > 10) ++x; 
```

* * *

## 回答 #2

> 赞同：27
> 
>             
> 
> 时间：2009-01-14T04:47:29.193

我建议选择更清楚地表明您的意图的方法，而不是担心性能。在这种情况下，乘以 -1 的性能增益可能是最小的。

当你使用`Math.abs()`时，很明显你想要一个正值。使用`* -1`时不清楚，需要更多调查才能确定输入值是否始终为负。

* * *

## 回答 #3

> 赞同：11
> 
>             
> 
> 时间：2009-01-14T04:32:04.700

我想这取决于实现，但`Math.abs`可能很简单：

```
function abs(x) {
    return x < 0 ? x * -1 : x;
} 
```

所以，理论上，它只是在乘法之前添加一个快速测试。

但是，是的，否定负号是唯一的目的。关键是，`x * -1`对于正值，简单也会适得其反。

* * *

@olliej [评论]

真的。不过，简单的编辑。;)

```
function abs(x) {
    return Number(x < 0 ? x * -1 : x);
} 
```

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2009-01-14T08:48:59.253

只是`*-1`操作可能更快，但请记住，最终结果*与*math.abs() 的结果不同。

`math.abs(-5)`并且`math.abs(5)`都返回 5。

`-5 * -1`也返回 5。

`5 * -1`返回 -5。

So unless you're absolutely sure that the number is negative to begin with, you have to do some tests, which cost more time. Might as well do math.abs().

But really, if the performance difference between abs() and *-1 matters in your JS, your probably have more serious issues.

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T09:03:33.857

A style question: Why use `a * -1` instead of `-a`?
Apart from that I agree that you should use `abs()` if you don't know the sign of the number beforehand. I would not care for speed but for readability.

# asp.net - 在没有网站项目的情况下使用 ASP.NET 用户控件进行模板？

> ID：441898
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-14T04:26:28.347
> 
>         
> 
> 标签：asp.net, ascx, templating

有没有一种方法可以使用 ASP.NET 用户控件（.ascx 文件）来满足我自己在 .NET 应用程序中的模板需求，而无需将该应用程序作为网站？

它实际上是一个类库，它将接收数据，将其与模板组合，然后将其吐出。

我不想从头开始编写我自己的模板系统，所以我希望重新使用 ASP.NET 功能来满足我的需要。

有人告诉我 ASP.NET 用户控件渲染依赖于 IIS。是否有一些技巧可以让它在 .NET 类库中工作？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T04:30:04.627

这可能对你有用......可能不是你正在寻找的......

[使用 VS 2005 构建可重用的 ASP.NET 用户控件和页面库](http://weblogs.asp.net/scottgu/archive/2005/08/28/423888.aspx)

也看看

[将 .ascx 用户控件转换为可再发行的自定义控件](http://msdn.microsoft.com/en-us/library/aa479318.aspx)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T04:58:24.897

我不完全确定我是否正确地关注了这个问题，但如果你只是在寻找一个模板引擎，你可能想查看[NVelocity](http://www.castleproject.org/others/nvelocity/index.html)，它是 Castle Project 的一部分。

它允许您创建这样的模板（摘自他们在网站上的入门指南）：

```
From: $from
To: $to
Subject: $subject

Hello $customer.Name

We're please to yada yada yada. 
```

然后像这样推广它：

```
Template template = velocity.GetTemplate(@"path/to/myfirsttemplate.vm");
VelocityContext context = new VelocityContext();
context.Put("from", "somewhere");
context.Put("to", "someone");
context.Put("subject", "Welcome to NVelocity");
context.Put("customer", new Customer("John Doe") );

StringWriter writer = new StringWriter();
template.Merge(context, writer);
Console.WriteLine(writer.GetStringBuilder().ToString()); 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T07:34:46.063

除了[Rajsh 的回答](https://stackoverflow.com/questions/441898/using-asp-net-usercontrols-for-templating-without-having-a-website-project#441906)，我想指出 Visual Studio 有一个[Web 部署项目模板](http://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx)，它允许您将.ascx 文件**预编译**到单个程序集中。

它简化了您的部署/安装过程。您不必复制/同步新的 ascx 文件，只需创建 DLL。

这是[MSDN 文章](http://msdn.microsoft.com/en-us/library/aa479568.aspx)的链接。

# internet-explorer - Firefox 和 IE 以不同的方式呈现相同的图像！

> ID：441910
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-01-14T04:31:16.840
> 
>         
> 
> 标签：internet-explorer, image, firefox, rendering

这是一个完全相同的副本：[IE6 issues with transparent PNGs](https://stackoverflow.com/questions/130161/ie6-issues-with-transparent-pngs)

* * *

火狐：![替代文字](https://i377.photobucket.com/albums/oo218/prakashrajgopal/FirefoxP.jpg)

IE 6：![替代文字](https://i377.photobucket.com/albums/oo218/prakashrajgopal/IEP.jpg)
图像的背景是透明的。然而 IE 似乎把它搞砸了。有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-01-14T04:32:32.377

IE6 无法正确呈现透明 PNG。有一个 javascript 修复程序或[类似](http://24ways.org/2007/supersleight-transparent-png-in-ie6)的修复程序，但如果您不使用 PNG 会更容易。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T04:32:45.387

毫无疑问是PNG。IE6 本身并不处理 PNG alpha 透明度，尽管有一些 hack 可以工作。这是[一个](http://bjorkoy.com/past/2007/4/8/the_easiest_way_to_png/)。这是[另一个](http://24ways.org/2007/supersleight-transparent-png-in-ie6)。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T04:35:30.280

我认为 IE 直到 IE8 才完全修复 PNG。

IE6 存在透明度问题

IE7 有调色板问题

如果您需要透明图像并且需要它在 IE6 上运行，请使用 GIF。它们在所有浏览器上都能正确呈现。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T04:34:57.893

好吧，您可以在 IE6 中使用 PNG，但不能使用 24 位 PNG，因为 alpha 通道会变成灰色块。您可以使用 Javascript 来解决此问题，但并非在所有情况下都有效（例如重复背景）。查看此链接： http: [//www.twinhelix.com/css/iepngfix/](http://www.twinhelix.com/css/iepngfix/)

# language-agnostic - 您的软件开发目录结构是什么？

> ID：441931
> 
>         
> 
> 赞同：23
> 
>         
> 
> 时间：2009-01-14T04:38:01.007
> 
>         
> 
> 标签：language-agnostic, directory-structure, project-structure

我一直在尝试目录结构，目前正在使用以下结构：

```
|
 |_项目__
 | |
 | |_blog.com_
 | | |_模型
 | | |_用户故事
 | | |_....
 | |
 | |_noteapp__
 | |_模型
 | |_....
 |
 |_网络______
 | |
 | |_开发者______
 | | |_blog.com_
 | | |_app
 | | |_配置
 | | |_....
 | |
 | |_产品___
 | | |_blog.com_
 | | |_app
 | | |_....
 | |_qe_....
 | |_uat_....
 |
 |
 |_桌面__
             |
             |_开发者______
             | |_noteapp_
             | |_app
             | |_配置
             | |_....
             |
             |_产品...
             |_qe....
             |_uat....

                                                 钥匙
                                                 开发 - 开发
                                                 产品 - 生产
                                                 qe - 质量工程
                                                 uat - 用户验收测试

```

Web 存储 Web 应用程序，桌面存储桌面应用程序。dev 目录受版本控制，而其他目录（prod、qe、uat）存储它们各自的当前版本。项目目录存放非代码相关的项目项。

您的软件开发目录结构是什么？您推荐该结构有什么原因？

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-01-14T06:21:13.450

我执行以下操作：

*   项目

    *   项目一

        *   设计

        *   文档

        *   代码

    *   项目 n

        *   设计

        *   文档

        *   代码

    *   不活跃

        *   项目一

            *   设计

            *   文档

            *   代码

        *   项目 n

            *   设计

            *   文档

            *   代码

出于某种原因，将所有文件按项目分组，并将我的非活动项目（我目前未处理的项目）保存在更下方的文件夹中对我有很大帮助。我想我会被他们分心，否则。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-01-14T06:15:25.723

我非常喜欢你更细粒度的叶子，但在顶层，我在按项目组织文件系统时表现得更好。我更有可能在代码目录中思考，“嘿，这个规范是什么？” 而不是在规范目录中思考，“我想要哪个项目的规范？” 要重新排列图表：

```
|
|___webs____
|           |
|           |_blog.com_
|           |          |
|           |          |_docs_
|           |          |      |
|           |          |      |_mockups
|           |          |      |_user stories
|           |          |      |_...
|           |          |
|           |          |_code_
|           |          |      |
|           |          |      |_dev_
|           |          |      |     |
|           |          |      |     |_app
|           |          |      |     |_cfg
|           |          |      |     |_...
|           |          |      |
|           |          |      |_prod_ 
|           |          |      |_qa_
|           |          |      |_uat_
|           |
|           |_blah.com_
|           |          |
|           |          |_...
|
|_desktop___
|           |
|           |_noteapp__
|           |          |
|           |          |_...
|           |_...

                                                KEY
                                                dev  - development
                                                prod - production
                                                qe   - quality engineering
                                                uat  - user acceptance testing 
```

也就是说，我办公室的组织遵循您的方法，并且似乎支持较大的开发环境。就个人而言，我发现必须在我的项目所在目录之外的目录中搜索模型和其他案例真的很令人沮丧（具体来说，作为分析师，规范与营销模型分开，但我离题了），但是从一个过程 -将这些概念分开的委派立场可能很有意义。

只是我的两分钱。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2009-01-14T06:18:38.107

我将所有内容存储在我的 Windows 机器上的“c:\projects”目录中，并将 ~/projects 存储在我们的 unix-oid（linux 和 solaris）环境中。下面我有一个“学习”（用于代码实验和片段/目录），然后是每个项目的一个目录。一段时间后，当一个项目失效时，我删除了本地存储，代码仅存档在 SVN 中。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2010-10-09T17:01:46.000

我通常使用这个目录结构：

*   项目名称

    *   代码

        *   源代码

        *   测试

        *   建造

    *   设计

    *   文档

    *   工具

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-04-21T07:28:34.577

*   src\ <- 多个项目的源代码（下）

*   测试\

    *   test_a <- 用于研发的模块测试（使用 src 文件夹中的一些代码）

    *   test_b <- 用于研发的 b 模块测试（使用 src 文件夹中的一些代码）

    *   ...

*   main_app_folder <- 用于生产的主要项目文件（使用 src 文件夹中的大部分代码）

*   doc\ <- 文档

*   工具\

    *   tool_a <- tool a（使用 src 文件夹中的一些代码）

    *   tool_b <- tool b（使用 src 文件夹中的一些代码）

*   cleanup.exe / .ini <- 用于清理临时构建文件的实用程序。

项目（在 main_app_folder、测试或工具中）可以是 .vcproj（visual studio c/c++）、.mmp（Symbian makefile）、Makefile（linux makefile）。每个项目都有自己的主 .cpp 文件 - 始终包含最少的功能集，其他所有内容都或多或少可重用（在 src\ 文件夹中）。

测试应用程序和工具应用程序之间的区别在于工具显示的东西或多或少有用，而测试只检查它是否有效。

测试应用程序和主应用程序之间的区别在于测试应用程序不包含全部功能，而且测试应用程序可能会启用一些特殊的#define 来进行测试。通常测试应用程序是减少的主要应用程序集，没有额外的#define。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2012-06-02T00:24:07.200

我倾向于将我所有的项目分组到三个主要目录中：

*   网页设计 => 任何与网页相关的东西；

*   编程 => 对于任何与网络无关的东西（即使它具有网络功能）；

*   研究 => 对于我必须阅读论文才能做到的任何事情；

然后在这些文件夹中，我有：

*   孵化器 => 对于新项目或我采用的项目；

*   退休（或 atic）=> 对于不活跃的项目；

*   我每个积极开发的项目的目录；

此外，每个项目都维护在一个 git 存储库中，并带有一个描述它的 doap 文件（以及通常的东西，如 README、INSTALL、NEWS、AUTHORS、LICENSE（通常是 apache2）、一个 docs 目录和 srcs 目录以及可选的 libs 目录和一个构建文件）。如果连接了任何项目，那么 doap 文件会说明它（或者我只是为根项目创建一个文件夹并将所有相关项目放入其中）。上面这两段的唯一例外是 atic 中的一些项目（其中一些是用 Delphi 2 编写的......）。

此外，只存储源，因为我可以快速创建二进制文件。

PS：如果这让你想起了一些你知道的事情，那是因为我在 apache 软件基金会中启发了自己来组织我的项目，所以我有实验室（或研究）、atic、孵化器、doap 文件等。因为这些天我主要是一个java人，我想到了apache......

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-04-19T16:15:58.477

svn中的文件：

```
SomeLibraryX
  SomeLibraryX.sln
  SomeFunctionA.cs
  SomeFunctionB.cs
  ..

SomeApplicationY
  SomeApplicationY.sln
  SomeApplicationY.cs          <-- might use SomeLibraryX as one of the dependencies

SomeApplicationZ
.. 
```

一些共享的 \\intra-pc\Releases\ 中的文件

```
SomeApplicationY 1         <-- folder used to execute compiled binary. Contains all the necessary input files needed for execution.
  Model                    <-- all input files like xml:s and 3ds:s 
  Textures                 <-- all pictures 
  Depencies                <-- all dependency executables and dlls
  SomeApplicationY.exe     <-- main exe
  SomeApplicationY.ini     <-- execution parameters file, that can be drag&dropped onto main exe

SomeApplicationY 2
  Model 
  Textures
  Depencies
  SomeApplicationY.exe
  SomeApplicationY.ini

SomeApplicationY 3            <-- the last demo-release of this project that is currently under construction (used for executing and debugging the exe)

  Model 
  Textures
  Depencies
  SomeApplicationY.exe
  SomeApplicationY.ini

SomeApplicationZ 1
... 
```

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T06:56:45.050

我倾向于更扁平的目录结构，并建议尽可能简单。请记住，至少在 Windowsland 中，命令行长度是有限制的。因此，具有非常深的结构可能会产生一些令人讨厌的构建错误。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T06:56:52.240

我只是为每个项目使用一个简写名称，并将所有相关文件和目录扔到那个目录中。像这样的东西：

*   project_name（项目名称，“简写”）

    *   dir1/ （实际上不是这样命名的。）

    *   目录2/

    *   目录/

    *   文件 1

    *   文件2

    *   文件 3

    *   文件N

# sql - 连接 3 个表并从所有表中检索所有记录

> ID：441939
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-14T04:42:49.810
> 
>         
> 
> 标签：sql, database, join, multiple-tables

我正在连接三个表（执行完全外部连接），以便可以从所有表中检索所有记录。我面临的问题是我加入表格的顺序。

表信息

[替代文字 http://img235.imageshack.us/img235/7980/tableinfoow1.png](http://img235.imageshack.us/img235/7980/tableinfoow1.png)

(1) 如果我以 TABLE1、TABLE2、TABLE3 的顺序连接表，我会得到两行记录，用于团队 B 和级别 1。

```
SELECT DISTINCT 
    (CASE WHEN T0.[TEAM] IS NOT NULL THEN T0.[TEAM] WHEN T1.[TEAM] IS NOT NULL THEN T1.[TEAM] WHEN T2.[TEAM] IS NOT NULL THEN T2.[TEAM] ELSE T0.[TEAM] END) AS [TEAM], 
    (CASE WHEN T0.[LEVEL] IS NOT NULL THEN T0.[LEVEL] WHEN T1.[LEVEL] IS NOT NULL THEN T1.[LEVEL] WHEN T2.[LEVEL] IS NOT NULL THEN T2.[LEVEL] ELSE T0.[LEVEL] END) AS [LEVEL], 
    T0.[VALUE1] AS [VALUE1], 
    T1.[VALUE2] AS [VALUE2], 
    T2.[VALUE3] AS [VALUE3] 

FROM TABLE1 T0
FULL JOIN TABLE2 T1 ON T0.[TEAM] = T1.[TEAM] AND T0.[LEVEL] = T1.[LEVEL] 
FULL JOIN TABLE3 T2 ON T0.[TEAM] = T2.[TEAM] AND T0.[LEVEL] = T2.[LEVEL] 
```

(2) 如果我在 TABLE2、TABLE3、TABLE1 序列中加入表，我会在输出中得到正确的行数。

```
SELECT DISTINCT 
    (CASE WHEN T0.[TEAM] IS NOT NULL THEN T0.[TEAM] WHEN T1.[TEAM] IS NOT NULL THEN T1.[TEAM] WHEN T2.[TEAM] IS NOT NULL THEN T2.[TEAM] ELSE T0.[TEAM] END) AS [TEAM], 
    (CASE WHEN T0.[LEVEL] IS NOT NULL THEN T0.[LEVEL] WHEN T1.[LEVEL] IS NOT NULL THEN T1.[LEVEL] WHEN T2.[LEVEL] IS NOT NULL THEN T2.[LEVEL] ELSE T0.[LEVEL] END) AS [LEVEL], 
    T0.[VALUE1] AS [VALUE1], 
    T1.[VALUE2] AS [VALUE2], 
    T2.[VALUE3] AS [VALUE3] 

FROM TABLE2 T0
FULL JOIN TABLE3 T1 ON T0.[TEAM] = T1.[TEAM] AND T0.[LEVEL] = T1.[LEVEL] 
FULL JOIN TABLE1 T2 ON T0.[TEAM] = T2.[TEAM] AND T0.[LEVEL] = T2.[LEVEL] 
```

我面临的问题是我不知道输入表并在运行时将所有这些表作为用户的输入并执行连接。我不能一次合并两个表，因为从技术上讲，我的表一次可以合并三个以上的表（最多 9 个或 10 个）。

如何确保从所有表中获取所有记录（使用完全外连接），但不要像 #1 中那样获取两行。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T12:50:29.577

如果这是您需要的：

```
TEAM LEVEL  Value1  Value2  Value3
A   1        1       NULL    NULL
B   1        NULL    1000    900 
```

然后，您可以通过以下方式实现：

```
SELECT [TEAM], [LEVEL], MAX(v1) Value1, MAX(v2) Value2, MAX(v3) Value3
FROM (
    SELECT [TEAM], [LEVEL], Value1 v1, NULL v2, NULL v3
    FROM TABLE1
    UNION
    SELECT [TEAM], [LEVEL], NULL, Value2, NULL
    FROM TABLE2
    UNION
    SELECT [TEAM], [LEVEL], NULL, NULL, Value3
    FROM TABLE3
) t0
GROUP BY [TEAM], [LEVEL] 
```

您可以根据需要使用任意数量的表格。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-09-24T20:58:39.790

您需要在第二个连接表达式上添加一个额外的匹配条件，以允许它匹配第二个表的团队/级别值。我还使用 ISNULL 简化了团队/级别列表达式：

```
SELECT DISTINCT 
    ISNULL(T0.[TEAM],ISNULL(T1.[TEAM],T2.[TEAM])) AS [TEAM],
    ISNULL(T0.[LEVEL],ISNULL(T1.[LEVEL],T2.[LEVEL])) AS [LEVEL],
    T0.[VALUE1], T1.[VALUE2], T2.[VALUE3]     
FROM TABLE1 T0
FULL JOIN TABLE2 T1 ON T0.[TEAM] = T1.[TEAM] AND T0.[LEVEL] = T1.[LEVEL] 
FULL JOIN TABLE3 T2 ON (T0.[TEAM] = T2.[TEAM] AND T0.[LEVEL] = T2.[LEVEL])
                    OR (T1.[TEAM] = T2.[TEAM] AND T1.[LEVEL] = T2.[LEVEL]) 
```

看？T1 没有与 T2 显示在同一行，因为您从未允许将其作为匹配的可能性。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T04:54:34.017

这就是 FULL OUTER JOIN 的定义（当使用它时，几乎总是表明设计不佳 - 我大约每年使用一次 FULL OUTER JOIN）。

也许如果你给出了你正在寻找的结果？

我在想 UNION、GROUP BY 和 COALESCE。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2013-03-20T11:09:06.270

正如你在 yru 查询中定义的不同，这意味着在这个联合中沿着一个有 r 多个条目都是最好的，因为数据中有重复。

```
SELECT [TEAM], [LEVEL], MAX(v1) Value1, MAX(v2) Value2, MAX(v3) Value3
FROM (
    SELECT [TEAM], [LEVEL],  v1, NULL v2, NULL v3
    FROM TABLE1
    UNION ALL
    SELECT [TEAM], [LEVEL], NULL v1, V2, NULL v3
    FROM TABLE2
    UNION ALL
    SELECT [TEAM], [LEVEL], NULL V1, NULL V2, V3
    FROM TABLE3
) t0
GROUP BY [TEAM], [LEVEL] 
```

# cocoa-touch - 我无法在代码和 Interface Builder 之间建立连接

> ID：441941
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-14T04:44:49.713
> 
>         
> 
> 标签：cocoa-touch, interface-builder

我对 iPhone SDK 有一个特殊的问题。

我试图在我的开发机器上运行来自不同来源的几个教程。问题似乎总是在于将代码连接到 Interface Builder 中的视图。如果我有一个按钮或数据字段（或其他一些库函数）并且我在`viewcontroller.h`文件中声明了一些属性，我会通过单击文件启动 Interface Builder`.xib`并尝试通过从连接查看器中的引用插座拖动来建立连接，然后唯一可能出现的连接（出现在弹出框中的是`view`）。无论有什么代码可用，都没有其他选项可用。有没有人经历过这个或者我错过了一些明显的东西？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-01-14T05:19:32.420

在您的控制器的头文件中，确保您使用`IBOutlet`的是您的控件和`IBAction`您希望链接到 Interface Builder 中的方法。此外，请确保您的控制器类在 Inspector 窗口（又名 File's Owner）中定义为 XIB 的“类”

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-03-15T18:52:04.477

您可以使用代码向界面添加控件，然后在无需使用 IB 的情况下以代码链接到它们吗？

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-20T06:56:07.360

您确定 Interface Builder 在类定义上是最新的吗？尝试`File`>`Reload All Class Files`更新它。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-06-25T03:54:24.363

还要确保您的属性类型与您要连接的对象的类型相匹配。我刚刚遇到了同样的问题，结果发现 Interface Builder 拒绝将我的图像视图连接到相应的属性，因为该属性是 UIImage * 而不是 UIImageView *。  

如果您只是在编写教程，也许您的问题会有所不同，但我想输入错误的属性类名称很容易。

# linq - Sql 到 Linq - 反向

> ID：441942
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-14T04:45:01.493
> 
>         
> 
> 标签：linq, linq-to-sql

我有一卡车带有普通 SQL 查询的 xsd。我想迁移到 LINQ。

是否有从 SQL 语句生成 LINQ 等效项的自动化方法？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T06:25:24.753

从 SQL 到 LINQ 的机械转换没有简单的方法。但是，您可以重复使用您的 SQL，只需使用 LINQ-to-SQL 进行管道：

```
ctx.ExecuteQuery<Foo>(sql, arg1, arg2, ...); 
```

这将执行 TQSL `sql`，使用`arg1`并`arg2`替换参数占位符（{0}、{1} IIRC），并将结果网格视为一系列`Foo`实例（因此您不必编写解析代码）。

还有：

```
ctx.ExecuteCommand(sql, arg1, arg2, ...); 
```

当您的 sql 不返回结果时。

或者，从您的 SQL 创建 SPROC 并使用来自 LINQ-to-SQL 或实体框架的那些。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T07:31:50.827

如果您只关心将 LINQ to SQL 查询的结果放入`IEnumberable`或类似中，那么您可以将它们包装在`ExecuteQuery`：

```
var Space = db.ExecuteQuery<Astronaut>("SELECT TOP 10 * FROM dbo.Astronauts"); 
```

如果你想真正有正确的 LINQ 查询，那么也许一个选项，至少是一个可能的路径，是 c# 示例附带的 LINQ 表达式树可视化器。[http://blogs.msdn.com/charlie/archive/2008/01/31/expression-tree-basics.aspx](http://blogs.msdn.com/charlie/archive/2008/01/31/expression-tree-basics.aspx)

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T06:19:54.937

我知道那里没有图书馆，但可以做一些工作。

我认为将 sql 文本（有限但有用的子集）解析为[动态 linq](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)不会太难。这可能无法解决 100% 的用例，但很可能您可以满足 80-90%

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-03-06T17:37:13.223

There is a .take(10), or a skip(10).take(10), probably incorrect syntax, but that's how you would do it.

# c# - 我可以在 C# 中声明一个全局推断变量吗？

> ID：441946
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-14T04:46:31.893
> 
>         
> 
> 标签：c#, linq, types, type-inference

我需要在 switch 语句之外声明查询变量，这样我就只有一个变量可以处理 LINQ 查询的不同结果。请看下面的代码。这里的问题是我无法在不初始化变量的情况下推断它

```
var query;

Switch(filter)
{

case 1:
    var query = from c in Customers 
                where c.Type equals == 'ABC'
                select c; 
     break;
case 2:
    var query = from c in Customers
                where c.Type equals == 'CDE'
                select c;
     break;
 }

foreach(var custrow in query)
{
    //Do Logic
}

} 
```

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-01-14T04:54:07.620

您可能想要`IEnumerable<Customer>`or`IQueryable<Customer>`而不是 var。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T04:56:26.803

不，因为它们必须在声明它们的同时进行初始化，编译器不知道分配给变量的类型。

我想你会想要类似的东西。

```
IQueryable<Customers> query; 
```

这是假设查询返回一个 IQueryable 的客户。

像这样的整体设计可能会更好。

```
IQueryable<Customers> query;

Switch(filter)
{

case 1:
    query = Customers.Where(c => c.Type == "ABC");
    break;
case 2:
    query = Customers.Where(c => c.Type == "CDE");
    break;
}

foreach(var custrow in query)
{
    //Do Logic
} 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T05:54:47.793

讨厌指出这一点，但是，这个：

```
var query; 
```

不会编译。推断变量需要立即赋值。

我同意上述答案。您需要将其声明为`IEnumerable<Customer>`或`IQueryable<Customer>`使其工作。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T06:20:50.893

除了同意 Scott、Nathan 和 Jon 的观点外，我还想指出，稍微重构一下也许是个好主意。让函数只做一件事总是一个好习惯：

```
private IEnumerable<Customer> FetchCustomers(FilterType filter)
{
    switch (filter)
    {
       // Switch logic comes here
    }
}

private void ProcessCustomers(IEnumerable<Customer> customers)
{
    foreach (var customer in customers)
    {
       // Process logic comes here
    }
}

private void FetchAndProcessCustomers(FilterType filter)
{
    ProcessCustomers(FetchCustomers(filter));
} 
```

现在它看起来更好更简单了，而且作为奖励，你关于推断变量的问题已经消失了！

# winapi - 如何获得更大的图标

> ID：441948
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-14T04:48:01.050
> 
>         
> 
> 标签：winapi, shell

我可以很好地获取关联的图标，并相应地绘制它，但是，我想提取完整的图标信息，而不仅仅是 SHGetFileInfo 允许的 32x32（或 16x16）像素。

例如，我可能想要显示存储在可执行文件内的图标文件中的 128x128 图标（甚至 256x256）。我只能使用完整的文件名来完成此操作。

谁能帮我？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T09:21:28.110

根据[http://msdn.microsoft.com/en-us/library/ms648045(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms648045(VS.85).aspx)，LoadImage() 在加载图标时使用 cxDesired 和 cyDesired 参数来选择尺寸。  

# webforms - 哪个是构建 HTML 调查构建器的更好框架？

> ID：441949
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-14T04:49:35.070
> 
>         
> 
> 标签：webforms, frameworks, survey

我必须构建一个带有 AJAXified 用户界面的 HTML 调查构建器应用程序（即*Wufoo*，...）。

典型的调查将是多步骤的，表单字段/问题之间存在多重依赖关系，大部分时间都是公共访问，并将结果导出为 PDF + CSV。

一直在研究/测试一些 PHP 框架（CodeIgniter、Symfony 和 CakePHP）。我喜欢 CakePHP，但我读了很多关于 Django 和 RoR 的好东西（尤其是用于表单构建的 RoR...）...

...所以问题是：哪个是构建 HTML 调查构建器的更好框架？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T05:10:35.950

我想说你提到的所有框架都非常适合这样的应用程序。所以问题主要变成：你的专长是哪一套？如果您非常精通 PHP 并且从未见过 Ruby 或 Python，那么如果您希望快速开发，那么其中一个 PHP 肯定更适合您。

我会坚持使用我最熟悉的语言编写的框架。

此外，根据我的经验，当您将执行可变长度的自动生成表单时，最好避免使用 RoR 的脚手架（自动创建表单）。您可以查看[Railscasts](http://railscasts.com/)以获取更多信息以及如何去做。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T17:06:00.887

我个人的看法是 Zend Framework 在这种情况下是最好的。它非常模块化，并且还提供了不错的导出组件。

您可能会对 Zend Ajax 和 Zend_Pdf 组件感兴趣。您还可以将它们中的大多数用作独立类。

[您可以在此处](http://framework.zend.com/manual/en/)找到包含所有 Zend Frameworks 组件示例的列表和文档。

# java - 是否有一个使用 Clojure 的真实世界项目，它利用了我可以查看的多核系统？

> ID：441952
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-14T04:51:06.083
> 
>         
> 
> 标签：java, clojure

是否有一个使用 Clojure 的真实世界项目，它利用了我可以查看的多核系统？

如果 Clojure 仍然是一个玩具语言短语，或者它真的“即将发生”，我想这样做。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T05:36:18.597

今天在 Clojure 小组上有一个关于一个人正在这样做的[帖子。](http://groups.google.com/group/clojure/browse_thread/thread/85649a134cf22655?tvc=2&pli=1)它看起来像是兽医医院的很多中间件胶水，但不幸的是，没有关于它的数据（它说这将在未来几个月内改变）。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T16:45:57.073

您应该查看 Google 讨论组中发布的许多示例。它们很有趣，其中一些在另一种语言中并不平凡。我认为这些例子足以证明 Clojure 是否是一种“玩具”语言。

设计师 Rich Hickey 自己在他的作品中使用了这种语言，所以如果你发现它已经做好了生产准备，我不会感到惊讶。由于事情正朝着 1.0 版本发展，此时的 API 并没有太大变化，因此您不必太担心地毯会被拉到您的脚下。如果你打算在 Emacs 中进行 Lisping，现在可能最不稳定的部分是 SLIME 和 swank-clojure。直接从它们的存储库中使用两者的最新版本是非常必要的（我使用 GitHub 镜像）。

趁热拿。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-01-18T22:36:08.680

考虑查看[enclojure](http://enclojure.org/)的源代码 --a Netbeans IDE for Clojure。您可以[在这里](http://code.google.com/p/enclojure-nb-clojure-plugin/source/browse/#svn/trunk)浏览或通过 svn[在这里](http://code.google.com/p/enclojure-nb-clojure-plugin/source/checkout)下载。您会发现 Java 和 Clojure 的健康组合用于实现。[如您所见，](http://code.google.com/p/enclojure-nb-clojure-plugin/source/list)它似乎正在积极开发中。

[似乎这里](http://code.google.com/p/clojure-dev/)正在开发 Eclipse 特性，但从代码的外观来看，它几乎完全是在 Java 中。

或许更具启发性的是查看[Clojure](http://clojure.org/)本身的源代码。除了核心实现之外，大部分代码都是[自己](http://code.google.com/p/clojure/source/browse/#svn/trunk/src/clj/clojure)编写的。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-01T16:31:08.217

我写 Mire 就是为了这个目的的一个例子。这是一个简单的应用程序，但它涉及并发处理和共享状态。它由一系列小步骤构建，每个步骤都建立在最后一个步骤上，并且每个步骤都存储为一个单独的 git 分支，因此您可以逐步跟随开发。

[http://github.com/technomancy/mire](http://github.com/technomancy/mire)

# c# - 如何为 IGrouping 设置 NUnit 模拟对象

> ID：441965
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-14T04:59:11.540
> 
>         
> 
> 标签：c#, unit-testing, nunit, mocking

```
public myReturnObj MethodA(System.Linq.IGrouping<string, MyObject> group){
 ...
foreach (MyObject o in group)
{
    //business process
}
...
return myReturnObj; } 
```

我想设置 NUnit Mock 对象作为参数传递，然后在我的单元测试中检查 MethodA 的结果。

我如何模拟这个 IGrouping？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T05:19:53.637

您可以像模拟任何接口一样模拟 IGrouping(string, MyObject) 吗？

```
DynamicMock myMockGrouping = new DynamicMock(typeof IGrouping<string, MyObject>); 
```

或者，您可以使用更实时的版本：

```
List<MyObject> inputs = GetInputs();
IGrouping<string, MyObject> myLiveGrouping = inputs
  .GroupBy(o => "somestring").First(); 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T08:23:41.160

I'm very new to mock object. First time in my head is try to instantiate
a DynamicMock() object and then continue with it's ExpectAndReturn() method.

For IGrouping interface, there's only one property, Key. So if I want to set up ExpectAndReturn to make it work in foreach, maybe I have to go to implement the Current, Next(), Reset() of IEnumerator.

That's not easy to set up mock object and waste a lot of development time.

Now my solution is like this:

```
 //prepare expected list of objects that want to be tested
        List<MyObject> list = new List<MyObject>();
        list.Add(new MyObject() {BookingNo="111",...});
        list.Add(new MyObject() {BookingNo="111",...});

        // grouping objects in list
        IEnumberable<IGrouping<string, MyObject>> group = list.GroupBy(p => p.BookingNo);

//in my test method
myReturnObj  obj = MethodA(group.First());
Assert.xx(...); 
```

Thank you very much, David B!

# language-agnostic - 你用什么类型的变量名来比较两个对象

> ID：441976
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-01-14T05:08:20.947
> 
>         
> 
> 标签：language-agnostic, scripting, variables

我做了很多数据分析脚本，比较两个对象或字符串以确定差异或提出需要填补的空白。

当您处于循环中，比较对象 a 和对象 b 时，您是否有一个有意义的首选编码标准（即它是自文档化的）并且可以很好地适用于其他代码？或者变量名在这种类型的代码中无关：

```
for (String a : TreeMapvar) {  
    // Read b from data source  
    if (a.equals(b)) {  
        // Update a  
    }  else {
        TreeMapvar.add(b);
} 
```

一个不同的例子：

```
TreeMap<String, MyObject> TreeMapvar = new TreeMap<String, Object>();
File f = "Somefile";
// Open the file with bufferedReader br  
while ((line=br.readLine)!=null)) {  
    //insert code parse line to get object a  
    if (TreeMapvar.containsKey(a)) {  
        if (TreeMapvar.get(a).somefield.equals(a.somefied)) {  
            //insert code to update a  
        } else {  
            //insert code to insert new object  
        }  
     }  
} 
```

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-14T14:14:58.940

在您的示例中，变量名称应增强代码的可读性（无需尝试修改代码）：

1.  a 可以命名为 baseValue

2.  b 可以命名为 compareToValue 或 testValue  

所以 if (a.equals(b)) {

变成 if (baseValue.equals(compareToValue)) {

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T05:15:27.513

我认为**变量名并非无关紧要**，而且在这样的循环中没有适合所有可能情况的通用名称。这取决于*TreeMap 中存储的*内容以及*数据源包含的内容*。不过，我们可以说类似

```
for (String localData : TreeMapvar) {  
    // Read remoteData from data source  
    if (localData.equals(remoteData)) {  
        // Update or add to a counter  
    }  
} 
```

如果我得到你的漂移。

问题是使用 .equals() 使比较变得明显，因此我们不需要使用变量名（通常）来说明将要比较的值，不明显的（因此更重要） ) 是正在比较的值。

编辑：您的第二个示例没有任何改变。您仍在使用糟糕的变量名 a 和 b，而您应该使用描述性的变量名来显示 a 和 b 实际代表的内容。我仍然清楚地看到比较，所以这与命名无关。

编辑（重新，您的评论）：这很容易。唯一需要的是一些上下文，假设地图包含与您喜欢的任何内容相关联的用户名，并且您正在将它们与现有用户信息进行比较。

```
for (String a : TreeMapvar) {  
    // Read b from data source  
    if (a.equals(b)) {  
        // Update or add to a counter  
    }  
}

for (String userName : TreeMapvar) {  
    String existingUserName = getNextUserName();
    if (userName.equals(existingUserName)) {  
        // Update or add to a counter  
    }  
} 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T13:53:55.347

好吧，如果您需要 2 个变量名，我们称它们为 a 和 b，那么您可能涉及 3 个对象：self、a、b。

现在，这对我来说是一大堆，我尽量让事情变得更小。

所以，考虑你的第一个例子：

```
for (String a : TreeMapvar) {  
    // Read b from data source  
    if (a.equals(b)) {  
        // Update a  
    }  else {
        TreeMapvar.add(b);
} 
```

那么，为什么不让你的整个片段成为 b 类定义的一部分并将 b 重命名为“this”呢？

```
lookAtYourTreeMap() {
    for( String a : TreeMapvar) {
      this.accomodateTreemapIfNecessaryTo(a);
    }
} 
```

然后我会有一个方法

```
accomodateTreemapIfNecessaryTo(a) {
  if(a .equals( this)) {
     a.update();
  } else {
    TreeMapVar.add(a);
  }
} 
```

请注意，现代计算机的发明者肯特贝克说，方法需要简短。

在你的第三个组件中开始整个事情，如下所示：

```
B b = loadBFromSource();
b.lookAtYourTreemap(); 
```

像你这样的循环我称之为“结构代码”。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T05:18:48.430

如果所讨论的语言实现了运算符重载，那么我将实现 == 运算符。如果没有，那么您可以使用上面的 equals 或实现“比较”功能

您的语言或框架可能已经为字符串实现了这两个。您必须记住，大多数语言中的“等于”功能实际上是比较参考（浅）和实例（深）。

比较函数如下所示：

```
int Compare(string a, string b)
{
  if(a < b) return -1;
  else if (a == b) return 0;
  else return 1;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-01-14T05:32:43.220

简而言之，上下文（变量的名称代表它所拥有的内容）和可读性是我认为重要的。

```
 foreach(Order order in Orders)
{
    if (order.ID == queriedOrderID)....
} 

```

# c++ - 带接口的动态转换

> ID：441983
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-01-14T05:12:44.557
> 
>         
> 
> 标签：c++, casting, dynamic-cast

我有一个实现 2 个接口并继承 1 个类的类。所以，通常它看起来像这样：

```
class T : public A, public IB, public IC {
}; 
```

代码中有一点我有一个`IB *`，但实际上可以使用一个`A *`. 我希望动态演员是这样的：

```
IB *b_ptr = new T; // it's really more complicated, but serves the example
A *a_ptr = dynamic_cast<A *>(b_ptr); 
```

不幸的是，这不起作用。有没有合适的方法来做到这一点？还是我应该实施解决方法？我曾考虑过同时拥有`IB`并`IC`从虚拟继承`A`，但上次我尝试 IIRC 时，有一些并发症使其不受欢迎。

有什么想法吗？

**编辑**：哦，是的，这是插件 API 的一部分，所以不幸的是我无法直接访问`T`我需要的类型`A *`。我的示例彼此相邻，但如前所述，它更复杂。基本上我有 2 个共享库。`T`和`T1`（我有一个`IB *`）都是实现插件 API 的类，并且是共享库的内部。

澄清一下：这是我的典型插件的更具体示例（它们位于单独的库中）：

插件A：

```
class PluginA : public QObject, public PluginInterface, public OtherInterface {
}; 
```

插件 B：

```
class PluginB : public QObject, public PluginInterface {
    // in here, I have a PluginInterface *, but really could use a QObject *
    // unfortunately, PluginB has absolutely no knowledge of the "PluginA" type
    // it just so happens that my PluginInterface * pointer points to an object of type
    // PluginA.
}; 
```

**编辑**：我猜问题是 pluginA 和 pluginB 在不同的共享库中。也许 rtti 不跨越模块边界。我认为可能是这种情况，因为人们的示例在我的测试中似乎运行良好。具体来说，如果我对它执行“nm”，pluginB 就没有“PluginA 的类型信息”。这可能是问题的核心。如果是这种情况，我只需通过虚拟继承或`cast_to_qobject()`我的一个接口中的虚拟函数来解决它。

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-01-14T05:37:54.100

每个类是否至少有一个虚拟方法？如果没有，那就是你的问题。为每个类添加一个虚拟析构函数应该可以解决这个问题。

以下很高兴为我工作：

```
class IC
{
public:
    virtual ~IC() {}
};

class IB
{
public:
    virtual ~IB() {}
};

class A
{
public:
    virtual ~A() {}
    void foo() { /* stick a breakpoint here to confirm that this is called */ }
};

class T : public A, public IB, public IC 
{
public:
    virtual ~T() {}
};

int main(void)
{
    IB *b_ptr = new T;
    A *a_ptr = dynamic_cast<A *>(b_ptr);
    a_ptr->foo();
    return 0;
} 
```

编辑：

在所有新信息和异常行为之后（您的代码应该可以正常工作！），以下有帮助吗？我引入了一个名为 IObject 的接口并使用虚拟继承来确保这个基类只有一个副本。您现在可以先转换为 IObject，然后再转换为 A 吗？

```
class IObject
{
public:
    virtual ~IObject() {}
};

class IC : virtual public IObject
{
public:
    virtual ~IC() {}
};

class IB : virtual public IObject
{
public:
    virtual ~IB() {}
};

class A : virtual public IObject
{
public:
    virtual ~A() {}
    void foo() { /* stick a breakpoint here to confirm that this is called */ }
};

class T : virtual public A, virtual public IB, virtual public IC
{
public:
    virtual ~T() {}
};

int main()
{
    IB *b_ptr = new T;
    A *a_ptr = dynamic_cast<A *>( dynamic_cast<IObject *>(b_ptr) );
    a_ptr->foo();
    return 0;
} 
```

我并不是说这是正确的解决方案，但它可能会提供一些关于正在发生的事情的信息......

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-01-14T05:41:45.573

> 有没有合适的方法来做到这一点？还是我应该实施解决方法？我曾考虑过让 IB 和 IC 都从 A 虚拟继承，但 IIRC 上次我尝试时发现有一些复杂性使其不受欢迎。

我认为 IB 和 IC 的定义在你的控制之下。

这是 COM 接口在 Windows 上的工作方式；这些做你想做的事，即：

*   从一个界面投射到另一个界面

*   实现对调用者是不透明的

*   只有实现知道它实现了哪些接口

这样做，你可以做类似（未经测试的代码）......

```
interface IQueryInterface
{
  IQueryInterface* queryInterface(const Guid* interfaceId);
};

interface IB : public abstract IQueryInterface
{
  ...
};

interface IC : public abstract IQueryInterface
{
  ...
};

//within your implementation class
IQueryInterface* T::queryInterface(const Guid* interfaceId)
{
  if (matches(interfaceId,GUID_IB))
    return (IB*)this;
  if (matches(interfaceId,GUID_IC))
    return (IC*)this;
  if (matches(interfaceId,GUID_A))
    return (A*)this;
  return 0;
} 
```

一个更简单、更硬编码的版本是：

```
class A; //forward reference
interface IB
{
  virtual A* castToA() { return 0; }
};
class T : public A, IB, IC
{
  virtual A* castToA() { return this; }
}; 
```

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-01-24T02:51:23.950

我终于明白了，[丹尼尔·保尔](https://stackoverflow.com/questions/441983/dynamic-cast-with-interfaces#442025)是正确的，`dybnamic_cast`应该允许“横向”。我的问题是因为我的代码涉及共享库。PluginA 中的 typeinfo 在 PluginB 中不可用。我的解决方案是有效地添加`RTLD_NOW`并添加`RTLD_GLOBAL`到我的加载过程中

从技术上讲，它是

```
loader.setLoadHints(QLibrary::ResolveAllSymbolsHint | QLibrary::ExportExternalSymbolsHint); 
```

因为我使用的是 Qt 的插件系统但同样的区别。这些标志强制加载库中的所有符号立即解析并对其他库可见。因此，让需要它的每个人都可以使用 typeinfo。一旦这些`dynamic_cast`标志到位，就会按预期工作。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-01-14T05:16:53.190

先转换为 T*，然后转换为 A：

```
IB *b_ptr = new T; // it's really more complicated, but serves the example
A *a_ptr = dynamic_cast<T *>(b_ptr); 
```

如果 IB 通常应该可以转换为 A，那么 IB 可能应该从 A 继承。

编辑：我刚刚尝试过它并且它有效 - 请注意 E 在编译 main 方法时是未知的。

```
struct A
{
    virtual ~A() {}
};

struct C
{
    virtual ~C() {}
};

A* GetA();

int main()
{
    C *y = dynamic_cast<C *>(GetA());
    if (y == NULL)
        cout << "Fail!";
    else
        cout << "Ok!";
}

struct E : public A, public C
{
}; 

A* GetA() { return new E(); } 
```

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-07-20T13:54:44.183

我最近也被同样的问题困扰。有关详细信息，请参阅 GCC 的常见问题解答条目：

[http://gcc.gnu.org/faq.html#dso](http://gcc.gnu.org/faq.html#dso)

除了使用 RTLD_* 标志指示 dlopen 之外，链接器也可以解决此问题的一些化身，请参见其 -E 和 -Bsymbolic 选项。

# mysql - MySQL外键允许NULL？

> ID：441988
> 
>         
> 
> 赞同：64
> 
>         
> 
> 时间：2009-01-14T05:16:59.557
> 
>         
> 
> 标签：mysql, database, null, foreign-keys, referential-integrity

我正在拼凑一个图像网站。基本架构非常简单的 MySQL，但我在尝试表示与图像关联的可能管理标志时遇到了一些麻烦（“不适当”、“受版权保护”等）。我目前的想法如下：

```
tblImages (
    imageID INT UNSIGNED NOT NULL AUTO_INCREMENT,
    ...
);

tblImageFlags (
    imageFlagID INT UNSIGNED NOT NULL AUTO_INCREMENT,
    imageID INT UNSIGNED NOT NULL,
    flagTypeID INT UNSIGNED NOT NULL,
    resolutionTypeID INT UNSIGNED NOT NULL,
    ...
);

luResolutionTypes (
    resolutionTypeID INT UNSIGNED NOT NULL AUTO_INCREMENT,
    resolutionType VARCHAR(63) NOT NULL,
    ...
); 
```

（为了便于阅读而被截断；我发誓，各种外键和索引都是有序的）

`tblImageFlags.flagTypeID`在标志类型的查找表上是外键的，你可以想象`tblImageFlags.resolutionTypeID` *应该*是外键的`luResolutionTypes.resolutionTypeID`. 手头的问题是，当第一次发出标志时，没有逻辑解析类型（我会声明这是一个很好的用途`NULL`）；但是，如果设置了一个值，它应该是查找表的外键。

我找不到针对这种情况的 MySQL 语法解决方法。它存在吗？最好的亚军是：

*   添加“无节制”分辨率类型

*   添加一个`NULL`条目`luResolutionTypes.resolutionTypeID`（这甚至可以在`AUTO_INCREMENT`列中工作吗？）

感谢您的洞察力！

PS Bonus 指向谁告诉我，在数据库的情况下，它是“索引”还是“索引”。

* * *

**跟进**：感谢 Bill Karwin 指出表结构中的语法错误（`NOT NULL`如果您希望允许，请不要将列设置为`NULL`！）。一旦我有足够的业力给你这些奖励积分，我会:)

* * *

## 回答 #1

> 赞同：98
> 
>             
> 
> 时间：2009-01-14T05:22:02.790

`NULL`您可以通过在外键列中允许来解决此问题`tblImageFlags.resolutionTypeID`。

* * *

*PS Bonus 指向谁告诉我，在数据库的情况下，它是“索引”还是“索引”。*

*index*的复数形式应该是*index*。

根据 Bryan A. Garner 的“[现代美国用法](https://rads.stackoverflow.com/amzn/click/com/0195161912)”：

> 对于一般目的，*index*是更可取的复数形式，而不是*indices*。...
>   *指数*，虽然不如*论坛*或*教条*那么自命不凡，但仍然是自命不凡的。一些作者更喜欢技术背景下的*索引*，如数学和科学。*尽管 index 不是index*的最佳复数形式，但是从“指标”的意义上说，*indices*是允许的。...避免单数索引，从复数*索引的反向**格式*。

 *# java - 需要帮助使用 dom4j 处理文档

> ID：441990
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-14T05:17:45.263
> 
>         
> 
> 标签：java, xml, dom4j

```
import java.util.Iterator;

import org.dom4j.Document;
import org.dom4j.DocumentHelper;
import org.dom4j.Element;
import org.dom4j.io.XMLWriter;

public class Main {
    public static void main(String[] args){
        Company cp17 = new Company();
        Person ps1 = new  Person("Barry","15900000000");
        Person ps2 = new Person("Andy","15800000000");
        cp17.employee.add(ps1);
        cp17.employee.add(ps2);

        Document document = DocumentHelper.createDocument();
        Element companyElement = document.addElement("company");
        for(Iterator<Person> personIter = cp17.employee.iterator();personIter.hasNext();){
            Person nextEmployee = personIter.next();
            Element employee = companyElement.addElement("employee");
            employee.addAttribute("name",nextEmployee.name);
            employee.addAttribute("phoneNumber",nextEmployee.phoneNumber);
        }

        Document document2 = DocumentHelper.createDocument();
        Element compnies = document.addElement("companies");
        //move cp17 to document2 as a child of companies.
        //ERROR companies.add(cp17);
        XMLWriter xmlWriter = new XMLWriter();
        try{
        xmlWriter.write(document2);
        xmlWriter.close();
        }
        catch(Exception e){
            e.printStackTrace();
        }
    }
} 
```

我创建了两个文档对象，现在我想将一个元素和它的子元素移动到另一个元素。我该怎么做。谁能告诉我，谢谢。^_^

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-14T08:40:28.037

Use the standard DOM method Document.importNode to bring content from one document into another. [http://www.dom4j.org/dom4j-1.6.1/apidocs/org/dom4j/dom/DOMDocument.html#importNode%28org.w3c.dom.Node,%20boolean%29](http://www.dom4j.org/dom4j-1.6.1/apidocs/org/dom4j/dom/DOMDocument.html#importNode%28org.w3c.dom.Node,%20boolean%29)

```
Element companyElement2= document2.importNode(companyElement, true);
companies.appendChild(companyElement2); 
```

(Assuming that this line:

```
Element compnies = document.addElement("companies"); 
```

is supposed to read:)

```
Element companies = document2.addElement("companies"); 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-09-09T11:38:06.793

[Element.createCopy()](http://www.dom4j.org/dom4j-1.6.1/apidocs/org/dom4j/Element.html#createCopy%28%29)可能是您应该使用的：*********** 
```*****