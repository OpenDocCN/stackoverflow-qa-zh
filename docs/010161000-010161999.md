# StackOverflow 问答 10161000-10161999

# c# - 使用 PNRP HostName 成功托管 WCF 服务？

> ID：10161001
> 
> 赞同：3
> 
> 时间：2012-04-15T09:50:10.877
> 
> 标签：c#, wcf, service, p2p, pnrp

我想做的是 p2p 聊天应用程序，公平而简单。它在一台或多台计算机上的多个实例中使用一个程序。所以没有特定的“服务器/主机”应用程序。另请注意，我没有使用对等通道。

所以这是我在聊天应用程序中的服务主机：

```
 //wcf host
        WCFService srvc= new WCFService();

        tcpUri = new Uri(string.Format("net.p2p://{0}:{1}/ProjectSandSevice", peerName.PeerHostName, port));

        NetPeerTcpBinding tcpPeerBinding = new NetPeerTcpBinding();
        tcpPeerBinding.Security.Mode = SecurityMode.None;
        tcpPeerBinding.Resolver.Mode = System.ServiceModel.PeerResolvers.PeerResolverMode.Pnrp;

        host = new ServiceHost(srvc);
        host.AddServiceEndpoint(typeof(IWCFService), tcpPeerBinding, tcpUri);
        host.Open(); 
```

PeerHostName（DNS 名称）是不安全的，它看起来像“hatest-hna3l.p0.pnrp.net”。因此，有时当聊天应用程序在不同 NAT（路由器）后面的不同机器上运行时，它不起作用（PNRP 找到它，但 WCF 无法连接）。我认为这是因为重复的不安全 DNS 名称。请注意，这有时有效，有时无效！

所以我想使用 2 个 PNRP 注册的对等名称，一个不安全（用于 PNRP 解析），一个安全（因此具有比“hatest-hna3l.p0.pnrp.net”更多的唯一主机名）来实际托管 WCF 服务。

请告诉我您对这种方法的看法，它将解决我的 WCF 连接不可靠的问题。

# sql - sp_executesql 中的语法错误

> ID：10161004
> 
> 赞同：0
> 
> 时间：2012-04-15T09:50:45.290
> 
> 标签：sql, sql-server

您好我正在尝试运行以下 SQL，它将通过遍历名称为“Pull”的所有数据库来提取名为 SourceDestination 的表名。

但是我在'+@db_name+'.sys.tables 附近的加号处遇到错误。我在两边都试过 N'' 但我似乎无法让它工作。

它给出了这个错误消息 102，级别 15，状态 1，第 20 行“+”附近的语法不正确。

需要知道我错在哪里。谢谢您的帮助。

```
declare db_names cursor for
select name
from master.sys.databases
where name like 'Pull_%'

declare @db_name varchar(50)
declare @table_name varchar(50)
declare @sql nvarchar(100)
DECLARE @ParmDefinition NVARCHAR(500);
open db_names

fetch next from db_names into @db_name

while @@FETCH_STATUS = 0
begin
print @db_name  

    --  set @sql = 'select '+@table_name+'=name from '+@db_name+'.sys.tables'
    --  set @sql = N'select @table_name=name from @db_name.sys.tables where name =    ''SourceDestinations'' '
execute sp_executesql N'select @tbl_name=name from '+@db_name+'.sys.tables where name = ''SourceDestinations'' ', N'@tbl_name varchar(50) OUTPUT', @tbl_name=@table_name OUTPUT
--exec(@sql)o
print @table_name
FETCH NEXT FROM db_names INTO @db_name
    end

    close db_names
    deallocate db_names 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T10:11:30.860

您需要将命令字符串构建为与调用分开的步骤`sp_executesql`：

```
set @sql = N'select @tbl_name=name from '+@db_name+'.sys.tables where name = ''SourceDestinations'' '
execute sp_executesql @sql, N'@tbl_name varchar(50) OUTPUT', @tbl_name=@table_name OUTPUT 
```

**编辑** 第二次迭代可能没有设置变量。
尝试添加

```
SET @table_name = NULL 
```

后

```
print @table_name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T20:54:05.350

如果您只想打印该表所在的数据库的名称，那么您的脚本可以简单得多（我看不到每次都检索表名并打印它的意义——除了它还能是什么`SourceDestinations`？） ：

```
DECLARE @sql NVARCHAR(MAX);
SET @sql = N'';

SELECT @sql = @sql + 'IF EXISTS (SELECT 1 FROM ' + QUOTENAME(name) 
    + '.sys.tables WHERE name = ''SourceDestinations'')
    PRINT ''' + name + ''';'
FROM sys.databases
WHERE name LIKE 'PULL_%';

EXEC sp_executesql @sql; 
```

我怀疑，一旦您确定了实际表的位置，您想对此做更多的事情。Ed 是绝对正确的，您不能在执行时连接字符串以传递给 sp_executesql，您必须事先构建它。对于所有存储过程调用都是如此，例如，您不能说：

```
EXEC sp_who2 'act' + 'ive'; 
```

即使它应该与以下内容相同：

```
EXEC sp_who2 'active'; 
```

至少在某种程度上，您似乎已经知道这一点，因为您声明了一个`@sql`变量（尽管您从未使用它）。

我会将您的代码更改为：

```
DECLARE d CURSOR
  LOCAL STATIC FORWARD_ONLY READ_ONLY 
  FOR SELECT name FROM sys.databases
  WHERE name LIKE 'Pull_%';

DECLARE 
  @db_name NVARCHAR(128),
  @sql     NVARCHAR(MAX);

OPEN d;

FETCH NEXT FROM d INTO @db_name;

WHILE @@FETCH_STATUS = 0
BEGIN
  PRINT @db_name;

  SET @sql = N'IF EXISTS (SELECT 1 FROM ' + QUOTENAME(@db_name)
    + '.sys.tables WHERE name = ''SourceDestinations'')
        PRINT ''' + @db_name + ''';'

  EXEC sp_executesql @sql;

  FETCH NEXT FROM d INTO @db_name;
END

CLOSE d;
DEALLOCATE d; 
```

几个关键点：

1.  不要使用默认的光标选项。在这种情况下，这可能不是什么大不了的事，但这是一个坏习惯。我在这篇博文中强调了一个影响性能的案例：[https ://sqlblog.org/2011/03/08/t-sql-tuesday-16-this-is-not-the-aggregate-youre-looking-for](https://sqlblog.org/2011/03/08/t-sql-tuesday-16-this-is-not-the-aggregate-youre-looking-for)
2.  不要`varchar(50)`用于数据库/表名。这些应该`nvarchar(128)`根据[标识符的规则](https://docs.microsoft.com/en-us/sql/relational-databases/databases/database-identifiers)。
3.  此外，您还应该检查架构。`SourceDestinations`如果有人无意中在他们自己的默认架构中创建了一个，您可能会获得多次点击。
4.  您的`@sql`字符串可能应该超过 100 个字符。我通常`MAX`在这些情况下使用，因为性能差异不值得坐在那里想知道 255 或 1024 等是否足够字符。

# android - 单击时如何检索按钮的名称（android）

> ID：10161005
> 
> 赞同：1
> 
> 时间：2012-04-15T09:51:14.637
> 
> 标签：android, button

我有一个包含 4 个 RadioButtons 的 RadioGroup。单击时它们都调用相同的方法，我知道如何获取与按钮关联的文本，但我不知道如何获取所选按钮的名称。

一定有办法吗？

谢谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T09:57:11.207

也许这可以帮助您：

```
// radioGroup - you need to set this after creating the radiogroup, by findViewById done in the right place or just assigning upon creating it, depending on how you create your layouts.
RadioButton radioButton = (RadioButton) findViewById(radioGroup.getCheckedRadioButtonId());
String text = radioButton.getText().toString(); 
```

让我知道它是否有效 :) 总是渴望学习和帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T10:25:37.993

我假设您正在使用`View.OnClickListener`每个`RadioButton`. 正确的？

如果是这样，请不要这样做。处理`RadioButton`点击的最简单方法是使用`RadioGroup.OnCheckedChangeListener`。

在你`onCreate(...)`打电话后`setContentView(...)`找`RadioGroup`...

```
RadioGroup rg = (RadioGroup) findViewById(R.id.my_rg);
rg.setOnCheckedChangeListener(...); 
```

`onCheckedChanged`听者长这样...

```
public void onCheckedChanged(RadioGroup group, int checkedId) 
```

...所以在听众中只需执行以下操作...

```
RadioButton radioButton = (RadioButton) findViewById(checkedId);
String text = radioButton.getText(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T09:53:08.920

您可以使用开关盒来执行此操作，并且 onclick 只需将 view.getId() 与单选按钮的每个 id 进行比较，然后执行需要完整获取按钮名称的操作。

下面是示例代码::

```
switch (checkedRadioButton) {
  case R.id.radiobutton1 : radioButtonSelected = "radiobutton1";
                                  break;
  case R.id.radiobutton2 : radioButtonSelected = "radiobutton2";
                              break;
  case R.id.radiobutton3 : radioButtonSelected = "radiobutton3";
                              break;
} 
```

使用[链接](http://developer.android.com/resources/samples/ApiDemos/src/com/example/android/apis/view/RadioGroup1.html)

或者您也可以使用以下代码

```
RadioGroup rg = (RadioGroup)findViewById(R.id.radiogroup);
RadioButton radioButton = (RadioButton) findViewById(rg.getCheckedRadioButtonId());
Log.d("checked",radioButton.getText().toString()); 
```

# java - 在 jar 中列出和加载类

> ID：10161007
> 
> 赞同：0
> 
> 时间：2012-04-15T09:51:25.027
> 
> 标签：java, jar, classloader

在一个项目中，我需要`jar`在特定目录下加载不同的文件。然后我将搜索`.class`实现特定`interface`. 当我找到搜索的一个时，我需要用`Class.forName()`. 有没有一种简单的方法可以做到这一切？你能提出一些示例代码吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T10:00:26.347

看看[ServiceLoader](http://docs.oracle.com/javase/6/docs/api/java/util/ServiceLoader.html)。这确实需要这些类的实现者提供一个描述性文件，`/META-INF/services/<fqn-of-interface>`列出 jar 为该接口提供的所有实现类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T09:54:04.947

我很确定如果不先加载类就无法检查该类是否实现了特定接口。所以，我认为你必须加载每个类文件或尝试以不同的方式解决你的问题/实现你的目标。

您可以尝试读取 .class 文件二进制文件并在字节码中找出它实现了哪个接口，但不要问我如何做到这一点。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-15T18:21:10.160

如果您在一个普通的 Java 应用程序中并且想要预先定义接口 <-> 实现映射，我也喜欢 Mark 的方法。

我认为做你想做的另一种方法是修改类路径扫描，你考虑当前运行的类路径并使用它通过注释或接口查找组件。

流行的例子是[Spring](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/beans.html#beans-classpath-scanning)。

要在 Spring 之外使用它，您可以尝试使用诸如[Reflections](http://code.google.com/p/reflections/)或[Class-Search](http://code.google.com/p/class-search/)之类的库，它们提供了在类路径中搜索的 API。

由于我最近修改了 Vaadin/GWT 以及他们在当前类路径中查找内容的方法，因此如果您想手动实现类似的东西，他们工具中的[这个类对您来说也可能很有趣。](http://dev.vaadin.com/svn/versions/6.8/src/com/vaadin/terminal/gwt/widgetsetutils/ClassPathExplorer.java)

但是就像 Martijn 已经提到的那样，这些解决方案需要将 JAR 添加到您的类路径中，以便加载类，然后解释找到的组件。

如果这很关键，并且您无法预先加载类并稍后对其进行解释，则可以尝试在[ASM](http://asm.ow2.org)之类的库之上构建一些东西，它可能可以在不加载类的情况下提供`.class`-file 的解释。

# haskell - Haskell 数据构造函数中的输入检查

> ID：10161009
> 
> 赞同：13
> 
> 时间：2012-04-15T09:52:00.137
> 
> 标签：haskell, constructor, validation

如何向 Haskell 数据构造函数添加输入检查？假设我有

```
import Data.Time.Calendar

data SchedulePeriod = SchedulePeriod { startDate :: Day
    , endDate :: Day
    , accrualStart :: Day
    , accrualEnd :: Day
    , resetDate :: Day
    , paymentDate :: Day
    , fraction :: Double }
    deriving (Show) 
```

我想施加一个约束`startDate < endDate`。有没有办法在不创建抽象数据类型的情况下做到这一点？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-15T09:55:58.380

标准方法是使用[智能构造函数](http://www.haskell.org/haskellwiki/Smart_constructors)在创建值之前检查先决条件，并且不导出它使用的真实构造函数。当然，正如您所说，这是创建一个抽象数据类型。

在没有智能构造函数的情况下实现此目的的唯一方法是*非常*邪恶的类型系统黑客（并且您将无法使用标准`Day`类型）。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-04-16T02:50:57.573

接受 ehird 的回答。我只是写这个，所以我可以解释我在评论中提到的智能析构函数，我无法在评论中解释。

假设您有以下类型：

```
data T x y z = A | B x | C y z 
```

ehird 已经解释了如何抽象出构造函数，这只是为了提供“智能”构造函数。就像您提到的那样，这需要隐藏构造函数，然后您不能使用它们进行模式匹配。但是，您可以使用“智能”析构函数来解决这个问题，这相当于对每个可能的构造函数进行模式匹配。

为了解释这一点，让我们首先从如果构造函数被暴露，我们将如何编写一个 T 类型的函数开始：

```
myFunction :: T x y z -> d
myFunction t = case t of
    A     -> f1
    B x   -> f2 x
    C y z -> f3 y z 
```

我们从函数的类型签名中知道`f1`、`f2`和的类型`f3`必须是：

```
f1 :: d
f2 :: x -> d
f3 :: y -> z -> d 
```

因此，如果我们要概括`myFunction`为一个智能析构函数，我们只需将`f1`、`f2`和`f3`作为参数传递给它：

```
smartDestructor :: d -> (x -> d) -> (y -> z -> d) -> t -> d
smartDestructor f1 f2 f3 t = case t of
    A     -> f1
    B x   -> f2 x
    C y z -> f3 y z 
```

So if you export `smartDestructor`, then people can basically pattern-match against your type without needing access to the constructors.

If you've ever used the `maybe` or `either` functions, before, then you've used a smart destructor, although in those cases the constructors are not hidden, so they are mainly provided as convenience functions:

```
maybe :: b -> (a -> b) -> Maybe a -> b
maybe f1 f2 m = case m of
    Nothing -> f1
    Just  a -> f2 x

either :: (a -> c) -> (b -> c) -> Either a b -> c
either f1 f2 e = case e of
    Left  a -> f1 a
    Right b -> f2 b 
```

In your case, the purpose of the smart destructor is just so you can hide the constructors and not expose the constructors.

# javascript - 如何将图像添加到谷歌地图 v3 中标记的信息窗口？

> ID：10161013
> 
> 赞同：13
> 
> 时间：2012-04-15T09:53:06.337
> 
> 标签：javascript, html, google-maps

我有一个要添加到标记的图像 stagleton.png，并且我有一个创建标记的函数。如何更改 InfoWindow 方法以使图像也与 InfoWindow 中的文本一起显示？

```
function createMarker(name, latlng, mapsent)
{
    var marker = new google.maps.Marker({
                       position: latlng,
                       map: mapsent,
                       title: name   
                       });
    marker.info = new google.maps.InfoWindow({
              //when I add <IMG BORDER="0" ALIGN="Left" SRC="stagleton.jpg"> the maps will not load
      content: <IMG BORDER="0" ALIGN="Left" SRC="stagleton.jpg"> "My name is " + name

    });

    google.maps.event.addListener(marker, 'click', function(){
        marker.info.open(mapsent, marker);
    });
    return marker;
} 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-15T10:06:13.343

尝试：

```
content: '<IMG BORDER="0" ALIGN="Left" SRC="stagleton.jpg"> My name is ' + name 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-24T18:17:51.580

@Dr.Molle，您在 IE 中尝试过吗？我无法让 infoWindows 在 IE 中打开任何时候他们里面有图像。它们只是很小，用 X 来关闭它，但没有其他内容。

删除图像后，其余内容（h1 标签、链接、文本）显示正常，并且 infoWindow 打开。

有什么线索吗？？

* * *

编辑：您必须在 IMG 标记中指定高度和宽度属性，以便 IE 能够呈现带有图像的 infoWindow。IE是史上最差的浏览器，什么POS...

希望这可以帮助某人！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-24T01:06:25.433

```
 var contentString = "<a href=/popups/" + id + '>' + name + "</a>" + '<br>' + address
  + '<br>' + category + '<br>' + "<img width='80' src=" + image + ">" ; 
```

这对我有用。

# rest - ASP.NET Web Api 路由无法捕获参数

> ID：10161026
> 
> 赞同：1
> 
> 时间：2012-04-15T09:55:00.690
> 
> 标签：rest, routes, asp.net-mvc-routing, asp.net-web-api, input-parameters

我在 global.asax.cs 文件中有一些路由设置，如下所示：

```
routes.MapHttpRoute(
            name: "ColorsRoute",
            routeTemplate: "api/{controller}/{action}/{styleId}",
            defaults: new
            {
                controller = "Cars",
                action = "Colors"
            }
        ); 
```

控制器：

```
 public Dictionary<string, string> Colors(string styleid)
    {
        //returns a dictionary of colors and ids
    } 
```

问题是当使用这样的网址时：

```
localhost:58645/api/cars/colors/18752867 
```

不选择 styleId，但它通常像这样使用它：

```
localhost:58645/api/cars/colors?styleid=18752867 
```

关于为什么会发生这种情况的任何想法？

更新：

这些路由可以很好地处理像“domain.com/api/cars/makes/new”这样的调用：

```
 routes.MapHttpRoute(
            name: "MakesRoute",
            routeTemplate: "api/{controller}/{action}/{state}",
            defaults: new
            {
                controller = "Cars",
                action = "Makes"
            }
        ); 
```

控制器：

```
 public Dictionary<string, string> Makes(string state)       
    {
        //return dictionary of makes and ids
    } 
```

以下是我拥有的其他路线：

```
 routes.MapHttpRoute(
            name: "ModelsRoute",
            routeTemplate: "api/{controller}/{action}/{make}/{state}",
            defaults: new
            {
                controller = "Cars",
                action = "Models"
            }
        );

        routes.MapHttpRoute(
            name: "YearsRoute",
            routeTemplate: "api/{controller}/{action}/{modelId}/{state}",
            defaults: new {
                controller = "Cars",
                action = "Years"
            }
        );

        routes.MapHttpRoute(
            name: "StylesRoute",
            routeTemplate: "api/{controller}/{action}/{make}/{model}/{year}",
            defaults: new {
                controller = "Cars",
                action = "Styles"
            }
        ); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T02:04:21.647

根据您定义路线的顺序，匹配的路线可能不是您希望将请求发送到的路线。特别是您的 YearsRoute 和 ModelsRoute。您有相同数量的段，但没有指定任何路由约束。

尝试将 MapHttpRoute 作为您的第一个注册路由，并添加正则表达式约束

```
routes.MapHttpRoute(
        name: "ColorsRoute",
        routeTemplate: "api/{controller}/{action}/{styleId}",
        defaults: new
        {
            controller = "Cars",
            action = "Colors"
        },
      constraints: new { styleId = @"\d+" }
    ); 
```

看看现在是否匹配。

**更新**
另一种选择是专门为您的 URI 定义一个路由，该路由直接映射到您想要使用的 ApiController 和 Action 方法。这样，请求总是转到您希望它执行的操作

# css - 无图像纯 CSS 箭头标签

> ID：10161028
> 
> 赞同：5
> 
> 时间：2012-04-15T09:55:38.200
> 
> 标签：css

有没有一种方法可以在不使用图像的情况下创建类似 Delicious 的“箭头标签”： ![美味的标签](../Images/9551ba868365b530c2a86114d0090bc9.png)

我熟悉[边框三角形技术](http://css-tricks.com/snippets/css/css-triangle/)，但无法让它看起来不错（部分原因是我们需要一个额外的外边框来框住整个组件）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-15T10:16:21.013

我创建一个小例子可能就是你想要的。

**CSS**

```
div{
    padding:5px 10px;
    font-size:12px;
    -moz-border-radius:0 5px 5px 0;
    -webkit-border-radius:0 5px 5px 0;
    float:left;
    margin-left:30px;
    margin-top:20px;
    position:relative;
    font-family:verdana;
    color:#3b3d3c;
    border:1px solid #d5d5d7;
    border-left:0;
}

div{
    background: -moz-linear-gradient( top , #fbfdfc 0%,#f6f5f5 100%);
    background: -webkit-linear-gradient( top , #fbfdfc 0%,#f6f5f5 100%);  
}

div:after{
    content:"";
     width:18px;
     height:18px;
     background: -moz-linear-gradient( left top , #fbfdfc 0%,#f6f5f5 100%);
    background: -webkit-linear-gradient( left top , #fbfdfc 0%,#f6f5f5 100%);
     -moz-transform: rotate(45deg);
     -webkit-transform: rotate(45deg);
     display:block;
    position:absolute;
    top:3px;
    left:-10px;
    z-index:-1;
    border:1px solid  #d5d5d7;
} 
```

检查这个[http://jsfiddle.net/9EEEP/76/](http://jsfiddle.net/9EEEP/76/)

**更新** 现在也可以在 chrome 中工作

[http://jsfiddle.net/9EEEP/77/](http://jsfiddle.net/9EEEP/77/)

有关更多信息，您还可以查看我的这个答案[如何编码某些 css 形状？](https://stackoverflow.com/questions/8009587/how-to-code-certain-css-shapes/8009869#8009869)

我使用在浏览器下的 IE8 中不起作用的 css3。

# machine-learning - 让 grid.py 在 LIBSVM 中工作以进行网格搜索

> ID：10161038
> 
> 赞同：2
> 
> 时间：2012-04-15T09:57:33.597
> 
> 标签：machine-learning, computer-vision, svm, libsvm

我已经看到很多人，尤其是那些没有 python 经验的人，都在努力让 grid.py 工作并面临很多错误。即使到今天，我也无法让它运行。我觉得如果能成功运行它的人详细解释一下每个步骤会更好，以便以后运行它有困难的人可以看看这个帖子。

提前致谢

例子：

[查询 grid.py](https://stackoverflow.com/questions/8937358/query-over-grid-py)

[如何使用 grid.py 进行参数选择？](https://stackoverflow.com/questions/9948034/how-can-i-use-grid-py-for-parameter-selection)

# sql - 处理虚拟货币——elance、odesk和其他人是怎么做的？

> ID：10161039
> 
> 赞同：0
> 
> 时间：2012-04-15T09:58:24.307
> 
> 标签：sql, transactions, nosql, currency

我想知道 elance、odesk 和类似网站是如何处理金钱的……

当您将钱存入该站点时，钱是否会进入他们的银行帐户并且您会获得虚拟货币（附加到数据库中的用户实体或其他东西）？当有人完成工作时，用户之间的资金转移如何工作？

你是否一定需要数据库事务来做这种事情，这样它就不会失败或被滥用？而且，由于它们不支持事务，因此可以使用 No SQL 解决方案来完成吗？

在我看来，两次取款（没有交易）的问题可以通过锁定来解决。您可以通过组合用户 ID（从和到 Id）锁定传输过程。

我是否在正确的轨道上，我真的需要为此部分使用一些带有事务支持的数据库吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T12:15:04.557

世界上几乎所有的财务会计都是使用 RBDMS（如 Oracle、SQL Server、DB2 或 MySQL）完成的。但是，如果您想使用 NoSQL，您可以考虑使用 CQRS 解决方案，例如 CouchDB。

# mod-rewrite - 使用 mod rewrite 清理 url

> ID：10161040
> 
> 赞同：0
> 
> 时间：2012-04-15T09:58:47.667
> 
> 标签：mod-rewrite

嗨道歉，如果这是某个地方，但我找不到适用于我的设置的答案。

我有一个网站，我想从 url 中删除文件名，这样`www.example.co.uk/products/products.php`就变成`www.example.co.uk/products/`. 我习惯于从主页中删除 /index.php，但我无法让它与文件夹中的文件一起使用。

这是从主页 url 中删除我的 index.php 的工作代码我如何修改它以从我的其他页面中删除 products.php 等？

```
RewriteEngine on
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /([^/]+/)*index\.php\ HTTP/
RewriteRule ^(([^/]+/)*)index\.php$ http://%{HTTP_HOST}/$1 [R=301,L] 
```

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T10:13:19.907

此规则将适用于指向 PHP 文件的每个 URL，剥离后者并重定向到其余部分。

```
RewriteEngine on

RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /.*\/[^/]+\.php\ HTTP/
RewriteRule ^(.*)/[^/]+\.php$ http://%{HTTP_HOST}/$1 [R=301,L] 
```

**编辑**
@Ashley Briscoe：我认为你在这里有点搞砸了。假设您的客户请求的初始 URL 是`http://www.example.com/products/products.php`. 这将被上述规则重写为`http://www.example.com/products/`。

由于现在重写的 URL 指向一个目录（尾部斜杠表示）而不是文件资源，因此 Apache 正在尝试提供[目录索引文件](http://httpd.apache.org/docs/2.2/mod/mod_dir.html)（例如 index.html 或 index.php）以防使用**mod_dir**（我们可以放心地假设它是）。

您现在得到的`403 Forbidden`响应表明您的 Web 服务器正在运行的用户没有足够的权限来读取目录索引文件和/或打开其包含的文件夹。

要解决此问题，您需要确保确实存在目录索引文件（因此重命名`products.php`为`index.php`products 目录中）并且 Web 服务器有权读取该文件。

**编辑 2**
关于您的最后一条评论：如果重命名不是一个选项，那么您必须让 Apache 知道它应该提供什么文件。因此添加另一个规则，如下所示：

```
RewriteEngine on

RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /.*\/[^/]+\.php\ HTTP/
RewriteRule ^(.*)/[^/]+\.php$ http://%{HTTP_HOST}/$1 [R=301,L]

RewriteRule ^products/?$ /products/products.php [L] 
```

# zend-framework - 获取zend框架同名的元素

> ID：10161042
> 
> 赞同：0
> 
> 时间：2012-04-15T09:59:33.377
> 
> 标签：zend-framework, zend-form

我有一个场景，我要添加多个资格，我将值保存在隐藏字段中，例如

```
 $("<input/>",{type:'hidden',value:deg,name:'degree[]'}).attr("data-deg",deg).appendTo("form");

$("<input/>",{type:'hidden',value:year,name:'year[]'}).attr("data-year",year).appendTo("form");

$("<input/>",{type:'hidden',value:inst,name:'inst[]'}).attr("data-inst",inst).appendTo("form"); 
```

如果我做 var_dump 它会显示以下输出

```
["degree"]=> array(2) { [0]=> string(4) "M.Sc" [1]=> string(4) "B.Sc" } 
```

在控制器中我得到它喜欢

```
$Degree = $form->getValue('degree[]'); 
```

但是 var_dump($Degree) 给了我NULL，我怎样才能得到值请帮忙

编辑

这是我的表格

```
$degreename = $this->createElement('select', 'degreename')
        ->setRequired(true);
        $degreename->removeDecorator('label');
        $degreename->removeDecorator('htmlTag');
        $degreename->removeDecorator('Errors');
        $ddloptions = $this->db->GetDegrees();
        $degreename->setMultiOptions($ddloptions);
        $degreename->addMultiOptions(array(
                '0'=>'--Select Degree--'
        ));
        $degreename->setValue(0);

        $passingyear = $this->createElement('select', 'passingyear')
        ->setRequired(true);
        $passingyear->removeDecorator('label');
        $passingyear->removeDecorator('htmlTag');
        $passingyear->removeDecorator('Errors');
        $passingyear->addMultiOptions(array(
                '0'=>'--Select Passing Year--',
                '1950'=>'1950',
                '1951'=>'1951',
                '1952'=>'1952',
        )
        );
        $passingyear->setValue('0');

$institute = new Zend_Form_Element_Text('institute');
$institute->setRequired(false)
->addFilter('StripTags')
->addFilter('StringTrim');
$institute->removeDecorator('label');
$institute->removeDecorator('htmlTag');
$institute->removeDecorator('Errors'); 
```

尽管 the`degreename`和 the`passing year`是必需的，但它们始终具有`0` `institute`我`false`为用户设置的值，可以添加多个资格，并且在每个用户选择时，我添加一个隐藏字段，如上所示

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T06:26:55.203

当您创建学位实例时，请务必将其设置为数组

```
 $degree = new Zend_Form_Element_Hidden('degree');
  $degree->setIsArray(true); 
```

现在`$form->degree->getValue() ; //will return array ;`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T15:52:28.320

怎么样

```
$Degree = $form->getValue('degree'); 
'degree[]' is not a proper key in php and the POST request 
```

**UPDATE1：**
你的隐藏元素的Javascript片段仍然让我有点困惑，我想知道你是否在$form中有一个“学位”元素。要获得最终答案，最好了解您在 $form 中使用的内容。

如果您只需要提交的数据（原样），您可以从 $_POST 获取信息。你不需要 Zend_Form 。

**UPDATE2：**
现在看到你的表单代码，如果解除的话；您缺少隐藏元素的元素。当您打电话`isValid($_POST)`时，表单中没有任何内容可以验证数据。调用`getValue('degree')`或实际上任何隐藏元素都将返回 NULL。

如果您只想要数据，只需 $_POST 就可以了，但这并不是真正安全的数据处理。Zend_Form 元素允许您添加过滤器和验证器来清理数据。为此，您必须使用 Zend_Form 创建隐藏元素（仅使用 Javascript 来添加值）或在表单中包含仅用于验证的元素。您可以使用类似`if ( !empty($_POST) )`添加它们进行验证的东西。

# javascript - 打开一个新的谷歌浏览器标签并获取源

> ID：10161044
> 
> 赞同：2
> 
> 时间：2012-04-15T09:59:48.920
> 
> 标签：javascript, ajax, google-chrome-extension

我正在开发一个 Google Chrome 扩展程序，我想知道如何打开一个新选项卡（好的，这很简单：） `chrome.tabs.create({'url': chrome.extension.getURL(mypage)}, function(tab) { /* ... */ });` 并检索该页面的源代码。

我知道我可以使用 AJAX 来获取源代码，但问题是网页包含一些编辑页面的 Javascript 代码，我需要编辑后的页面。

可能吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-15T13:06:52.533

要序列化完整的实时 HTML 文档，请使用以下代码：

```
// @author Rob W <http://stackoverflow.com/users/938089/rob-w>
// Demo: var serialized_html = DOMtoString(document);

function DOMtoString(document_root) {
    var html = '',
        node = document_root.firstChild;
    while (node) {
        switch (node.nodeType) {
            case Node.ELEMENT_NODE:
                html += node.outerHTML;
            break;
            case Node.TEXT_NODE:
                html += node.nodeValue;
            break;
            case Node.CDATA_SECTION_NODE:
                html += '<![CDATA[' + node.nodeValue + ']]>';
            break;
            case Node.COMMENT_NODE:
                html += '<!--' + node.nodeValue + '-->';
            break;
            case Node.DOCUMENT_TYPE_NODE:
                // (X)HTML documents are identified by public identifiers
                html += "<!DOCTYPE "
                     + node.name
                     + (node.publicId ? ' PUBLIC "' + node.publicId + '"' : '')
                     + (!node.publicId && node.systemId ? ' SYSTEM' : '') 
                     + (node.systemId ? ' "' + node.systemId + '"' : '')
                     + '>\n';
            break;
        }
        node = node.nextSibling;
    }
    return html;
} 
```

现在，在 Chrome 扩展程序中，您必须向扩展程序页面添加一些事件，例如背景页面或弹出页面：

```
/**
 * Get the HTML source for the main frame of a given tab.
 *
 * @param {integer} tabId - ID of tab.
 * @param {function} callback - Called with the tab's source upon completion.
 */
function getSourceFromTab(tabId, callback) {
    // Capture the page when it has fully loaded.
    // When we know the tab, execute the content script
    chrome.tabs.onUpdated.addListener(onUpdated);
    chrome.tabs.onRemoved.addListener(onRemoved);
    function onUpdated(updatedTabId, details) {
        if (details.status == 'complete') {
            removeListeners();
            chrome.tabs.executeScript(tabId, {
                file: 'get_source.js'
            }, function(results) {
                // TODO: Detect injection error using chrome.runtime.lastError

                var source = results[0];
                done(source);
            });
        }
    }
    function removeListeners() {
        chrome.tabs.onUpdated.removeListener(onUpdated);
        chrome.tabs.onRemoved.removeListener(onRemoved);
    }

    function onRemoved() {
        removeListeners();
        callback(''); // Tab closed, no response.
    }
} 
```

上面的函数在一个选项卡中返回主框架的源代码。如果要获取子框架的来源，请[`chrome.tabs.executeScript`](https://developer.chrome.com/extensions/tabs#method-executeScript)带`frameId`参数调用。

下一个片段显示了您的扩展程序如何使用该功能的示例。将代码段粘贴到[后台页面的控制台](https://stackoverflow.com/questions/10257301/where-to-read-console-messages-from-background-js-in-a-chrome-extension/10258029#10258029)中，或声明一个[browserAction](https://developer.chrome.com/extensions/browserAction)，将代码段放入`onClicked`监听器并单击扩展按钮。

```
var mypage = 'https://example.com';
var callback = function(html_string) {
    console.log('HTML string, from extension: ', html_string);
};
chrome.tabs.create({
    url: mypage
}, function(tab) {
    getSourceFromTab(tab.id, callback);
}); 
```

引用**`get_source.js`**包含以下代码：

```
function DOMtoString(document_root) {
    ... see top of the answer...
}
// The value of the last expression of the content script is passed
// to the chrome.tabs.executeScript callback
DOMtoString(document); 
```

不要忘记添加适当的[主机权限](https://developer.chrome.com/extensions/match_patterns)，以便您可以从页面读取 DOM。在上面的示例中，您必须添加`"https://example.com/*"`到 manifest.json 的“权限”部分。

## 相关文档

*   [`Node`](https://developer.mozilla.org/en-US/docs/Web/API/Node) ^(MDN)
*   [`DocumentType`](https://developer.mozilla.org/en-US/docs/Web/API/DocumentType)( `document.doctype`, `<!DOCTYPE ... >`) ^(MDN)
*   [内容脚本](https://developer.chrome.com/extensions/content_scripts) ^(Google Chrome 扩展文档)
*   [匹配模式](https://developer.chrome.com/extensions/match_patterns) ^(Google Chrome 扩展文档)
*   [清单 > 权限](https://developer.chrome.com/extensions/declare_permissions) ^(Google Chrome 扩展文档)
*   [`chrome.tabs.create`](https://developer.chrome.com/extensions/tabs#method-create) ^(谷歌浏览器扩展文档)
*   [`chrome.tabs.executeScript`](https://developer.chrome.com/extensions/tabs#method-executeScript) ^(谷歌浏览器扩展文档)
*   [`chrome.tabs.onUpdated`](https://developer.chrome.com/extensions/tabs#event-onUpdated) ^(谷歌浏览器扩展文档)
*   [`chrome.tabs.onRemoved`](https://developer.chrome.com/extensions/tabs#event-onRemoved) ^(谷歌浏览器扩展文档)
*   [消息传递](https://developer.chrome.com/extensions/messaging) ^(Google Chrome 扩展文档)

# c++ - 基类指针的 std::map

> ID：10161047
> 
> 赞同：2
> 
> 时间：2012-04-15T09:59:56.837
> 
> 标签：c++, pointers, map, base-class

我正在编写代码来存储不同学位的考试结果（目前是物理和化学）。

我有一个抽象基类`student`，如下所示：

```
class student{
public:
    virtual ~student(){}
    //virtual function to add course + mark
    virtual void addresult(std::string cName,int cCode,double cMark)=0;
    //virtual function to print data
    virtual void printinfo()=0;     //to screen
    virtual void outputinfo(std::string outputfilename)=0;      //to file
}; 
```

然后我有一个物理派生类（并且会有一个类似的化学类）：

```
class physics : public student{
protected:
    std::string studentname;
    int studentID;
    std::map<int,course> courses; //map to store course marks
public:
    //constructors/destructors
    void addresult(std::string cName,int cCode,double cMark){course temp(cName,cCode,cMark);courses[cCode]= temp;}

    void printinfo(){
        //function to output information to screen      
    }

    void outputinfo(std::string outputfilename){
        //function to write student profile to file
    }
}; 
```

然后，我主要希望有一张地图，可以在其中存储所有学生（物理和化学）。学生 ID 作为键，带有指向物理或化学的基类指针。学生是，我猜，要走的路。

我尝试了以下代码：

```
map<int,student*> allstudents;
physics S1(sName,sID);
physics* S2 = &S1;
allstudents.insert(pair<int,student*>(sID,S2)); 
```

但这没有用。我想我对应该指向什么有点困惑。你甚至可以用地图做到这一点吗？如果我存储信息，是否还需要任何“清理”。这边走？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T10:03:42.647

你可以，但你错过了几件事：

*   你不尊重**三法则**。您还需要在类中定义赋值运算符和复制构造函数。

*   您可能会遇到内存损坏问题：

以下

```
physics S1(sName,sID);
physics* S2 = &S1;
allstudents.insert(pair<int,student*>(sID,S2)); 
```

将插入一个指针，当`S1`超出范围时会变得悬空。您应该使用智能指针或将内存管理委托给映射 - 即在映射超出范围时使用它`new`创建对象。`delete`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-15T10:04:15.233

如果您使用指针超过一秒钟，您不应该在堆栈上创建对象然后指向它！下一个一出现就消失`}`了，你的指针就失效了！

改为使用`physics* S2 = new physics(sName, sID);`。使用`delete`地图中的所有指针（迭代器在这里很方便）进行清理！

# ruby-on-rails - 寻找表演动作的 Rails 路线

> ID：10161048
> 
> 赞同：1
> 
> 时间：2012-04-15T10:00:12.470
> 
> 标签：ruby-on-rails, routes, conflict

我对 Rails 很陌生，基本上我想制作一个用户注册表单。

我目前正在使用 rails 3.2.3

基本上，我想在用户的基本 REST 路由之上创建基本路由，例如用户/注册。

这是我的路线.rb

```
resources :user do
  collection do
    get 'register'
  end
end 
```

这是我的 rake 路线：

```
 register_user_index GET    /user/register(.:format)   user#register
     user_index GET    /user(.:format)            user#index
                POST   /user(.:format)            user#create
       new_user GET    /user/new(.:format)        user#new
      edit_user GET    /user/:id/edit(.:format)   user#edit
           user GET    /user/:id(.:format)        user#show
                PUT    /user/:id(.:format)        user#update
                DELETE /user/:id(.:format)        user#destroy 
```

根据我的理解，由于注册用户在显示之上，所以在显示之前应该先与注册匹配。

但是，当我尝试执行 localhost:3000/user/register 时，它给了我这个错误：

没有路由匹配 {:action=>"show", :controller=>"user"}

有人可以帮我吗？

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T11:26:50.227

（我会将此作为评论，但我需要代码示例的标记。）

我使用 Rails 3.1.4 尝试了您的路线，它的工作方式与您预期的一样。

我注意到您使用的是字符串而不是符号。更标准的方法是：

```
resources :users do
  collection do
    get :register
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T10:30:00.243

你拼错了你的资源吗？它通常是复数，`users`。但这不是重点——这只是一个惯例。关键是您可能创建了一个名为的控制器`UsersController`，并且该控制器不遵循您的资源名称。检查它，或将其命名为 name `UserController`。但我强烈建议你**不**要这样做——如果你需要`/user`路径，只需使用`:path`你的资源的选项，你会没事的：

```
resources :users, path: 'user' do 
```

同样，如果还不算太晚，请使用：

```
resources :users do 
```

您的注册路径将是`/users/register`.

# sql - SQL 查询或过程，每个不同的行具有不同的和逗号分隔的值

> ID：10161049
> 
> 赞同：0
> 
> 时间：2012-04-15T10:00:14.390
> 
> 标签：sql, sql-server-2008-r2

我有一张这样的桌子：

```
218 4   AudioVerse     https://www.audioverse.org/english/podcasts/latest   Latest      NULL    2012-03-29 15:32:44.287
222 7   TPB            http://rss.thepiratebay.se/0             Alt     NULL    2012-03-31 17:55:49.223
223 7   EZTV           http://www.ezrss.it/feed/                Alt     NULL    2012-03-31 17:56:41.573
226 11  The Piratebay  http://rss.thepiratebay.se/100               Audio Only  NULL    2012-04-04 14:57:45.377
227 11  The Piratebay  http://rss.thepiratebay.se/200               Video Only  NULL    2012-04-04 14:58:04.650
229 15  ThePirateBay   http://rss.thepiratebay.se/200                       NULL    2012-04-06 22:40:12.730
230 14  The Pirate Bay http://rss.thepiratebay.se/0                     NULL    2012-04-08 00:59:13.217
232 14  AudioVerse     https://www.audioverse.org/english/podcasts/latest           NULL    2012-04-08 01:03:22.787
233 14  EZTV           http://www.ezrss.it/feed/                        NULL    2012-04-08 01:20:55.860
234 17  Twit           http://twit.tv/node/feed                     NULL    2012-04-13 18:59:23.037
235 17  Diggnation     http://revision3.com/diggnation/feed/MP4-Large       Video Large NULL    2012-04-13 19:01:52.817 
```

我想要一个查询或存储过程返回一个返回不同的表，以及一个具有该 url 共同的 id 的列，（第二个 id 列 (4,7,11,15,14,17) 是 id 在问题）以逗号分隔的形式，如下所示：

```
http://rss.thepiratebay.se/0    3   4,5,7,7,11,11,15,14,14,14,17,17
http://rss.thepiratebay.se/200  2   4,5,7,7,11,11,15,14,14,14,17,17
http://www.ezrss.it/feed/   2   4,5,7,7,11,11,15,14,14,14,17,17
https://www.audioverse.org/english/podcasts/latest  2   4,5,7,7,11,11,15,14,14,14,17,17
http://revision3.com/diggnation/feed/MP4-Large  1   4,5,7,7,11,11,15,14,14,14,17,17
http://twit.tv/node/feed    1   4,5,7,7,11,11,15,14,14,14,17,17
http://rss.thepiratebay.se/100  1   4,5,7,7,11,11,15,14,14,14,17,17 
```

这里第一列是不同的 url，接下来是 url 出现的次数（与上面的主表不同，但你明白了），以及这些 url 共有的 id 的逗号分隔字符串。

在这种情况下，逗号分隔的字符串不正确。

我用来创建此表的查询是：

```
DECLARE @listStr VARCHAR(MAX)
SELECT @listStr = COALESCE(@listStr+',' ,'') + cast(userid as varchar)
FROM sites

select url, COUNT(*), (@listStr)
from sites
group by url
order by COUNT(*) desc 
```

我正在使用 SQL Server 2008 R2。

我向您提出的问题是：如何做到这一点，哪种方式（如果有多个）最有效？

任何帮助，将不胜感激。我可以在 C# 代码中执行此操作，但我更愿意在存储过程或查询中使用它，这是最简单和/或更快的：P

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T09:37:15.330

我使用合并方法。我发现生成的连接字符串取决于在使用 COALESCE 之前是否使用值声明了该字符串。以下脚本演示了这一点：

```
DECLARE @Mystring nvarchar( 500 ); --declare but do not set inital value

CREATE TABLE dbo.mytable( id int IDENTITY(1 , 1) PRIMARY KEY , name nvarchar( 40 ));

INSERT INTO mytable( name )
VALUES( 'Peter' ) , ( 'Paul' ) ,( 'Mary' );

SELECT @Mystring = COALESCE( @Mystring + ',' , '' ) + name
  FROM dbo.mytable
  ORDER BY id;

PRINT @Mystring; -- will print 'Peter,Paul,Mary' with no leading comma

SET @Mystring = ''; --now set to initial empty string
SELECT @Mystring = COALESCE( @Mystring + ',' , '' ) + name
  FROM dbo.mytable
  ORDER BY id;

PRINT @Mystring; --will print ',Peter,Paul,Mary' ie with leading comma 
```

我不知道为什么 tsql 会这样做（我使用的是 2008 R2 Express），但值得了解。我现在将字符串变量初始化为空字符串，并使用 SUBSTRING() 函数删除前导分隔符以确保一致的行为。

我对 tsql 很陌生，所以如果这是旧帽子的东西，我很抱歉，但我没有发现它在其他地方被覆盖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T21:22:35.260

@BjørnØyvind Halvorsen

这个问题相对来说是旧的，但是遇到了它并想对此有所了解。

--- 创建表

创建表 test_kin (id int, location varchar(max), url varchar(max)) go

--- 插入一些值

插入 test_kin 值（4，'AudioVerse'，'https://www.audioverse.org/english/podcasts/latest'）
插入 test_kin 值（7，'TPB'，'http://rss.thepiratebay.se /0')
插入 test_kin 值 (7 ,'EZTV' ,'http://www.ezrss.it/feed/')
插入 test_kin 值 (11 ,'The Piratebay' ,'http://rss.thepiratebay .se/100')
插入 test_kin 值 (11 ,'The Piratebay' ,'http://rss.thepiratebay.se/200')
插入 test_kin 值 (15 ,'ThePirateBay' ,'http://rss. thepiratebay.se/200')
插入 test_kin 值 (14,'海盗湾','http://rss.thepiratebay.se/0')
插入 test_kin 值 (14,'AudioVerse'，'https://www.audioverse.org/english/podcasts/latest'）
插入 test_kin 值 (14 ,'EZTV' ,'http://www.ezrss.it/feed/')
插入 test_kin 值 (17 ,'Twit' ,'http://twit.tv/node/feed' )
插入 test_kin 值 (17,'Diggnation','http://revision3.com/diggnation/feed/MP4-Large')

--- 查询产生结果

```
select distinct url
,count(*) as ID
,stuff((
        select ',' + cast([id] as varchar(max))
        from test_kin
        for xml path('')
        ), 1, 1, '') as Result 
```

从 test_kin group by url order by ID

HTH，健

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T10:02:57.000

尝试这个：

```
select url, count(*), group_concat(userid) 
from sites
group by url
order by COUNT(*) desc 
```

# facebook - Open Graph 操作未获批准，我看到 Facebook 测试用户使用它并且有效，反馈消息错误

> ID：10161053
> 
> 赞同：1
> 
> 时间：2012-04-15T10:01:02.220
> 
> 标签：facebook, facebook-opengraph, tagging

我已经提交了一个标记用户的 Open Graph 操作。之前没有被批准，因为他们无法执行这些操作。我使（仍在测试的）界面更可用，因此可以轻松执行操作。

当使用**Facebook 测试用户**登录时，我可以看到他们**完美地执行了操作**（他们标记了用户，操作出现在他们的提要中等），但它再次没有被批准。

更奇怪的是，我得到的矛盾信息是：

> *状态：需要更改*
> 
> **恭喜，您的 Open Graph 操作提交已获得批准。感谢您对 Facebook 平台的贡献**。
> 
> 请在下面进行更改并重新提交以供审核。

我现在该怎么办？

# entity-framework - 使用 Table per Hierarchy 可以为基类设置鉴别器吗？

> ID：10161055
> 
> 赞同：0
> 
> 时间：2012-04-15T10:01:30.567
> 
> 标签：entity-framework, entity-framework-4, entity-framework-4.1

我正在使用 EF 4.3 和 TPH。

我的基类是`User`，我也有一个`Customer`派生自`User`几个附加字段的类。

在我的数据库中，我有一个名为的列`UserType`，我将其用作鉴别器。我希望客户 = 'C' 和用户 = 'U'

我希望应用程序的“常规”用户属于 type `User`，而 Customers 属于 type `Customer`。他们都以相同的方式登录，除了几个字段之外，他们的主要区别是权限，所以我用这种方式建模很方便。

`Customer`通过像这样设置我的上下文，我可以正常工作：

```
mb.Entity<User>().Map<Customer>(m=>m.Requires("UserType").HasValue("C")); 
```

我的问题是，如果我想创建一个常规`User`实体，我如何告诉 EF 使用“U”作为鉴别器。

我试图避免从 User 派生另一个类，因为 User 已经满足我的需求。但也许那是不可能的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T12:57:30.157

您可以为您的基本类型设置鉴别器值：

```
mb.Entity<User>().Map(m => m.Requires("UserType").HasValue("U")); 
```

# java - 如何：ListPreference 上的侦听器更改 Google 地图模式？

> ID：10161057
> 
> 赞同：0
> 
> 时间：2012-04-15T10:02:36.683
> 
> 标签：java, android, google-maps

我想**用键“map_mode”使 ListPreference在我的****MapActivity.java**中设置实际的地图模式。因此，例如，当我在“首选项”屏幕中单击“卫星”时，它会在地图上发生变化。

**我有一个像这样settings.xml** (preference.xml)的 ListPreference 设置：

```
 <PreferenceCategory
        android:key="settings"
        android:title="Settings" >
    <CheckBoxPreference
        android:defaultValue="true"
        android:key="map_settings"
        android:summary="Enable or Disable Map Settings"
        android:title="Enable Map Settings" />

    <ListPreference
        android:defaultValue="Map"
        android:dependency="map_settings"
        android:entries="@array/mapMode"
        android:entryValues="@array/mapModeValues"
        android:key="map_mode"
        android:summary="Change the display of the map"
        android:title="Map Mode" />
</PreferenceCategory> 
```

“map_mode”正在从此 arrays.xml 中读取数组**值**：

```
<string-array name="mapMode">
    <item name="Map">Map</item>
    <item name="Satellite">Satellite</item>
    <item name="Traffic">Traffic</item>
</string-array>

<string-array name="mapModeValues">
    <item name="Map">Map</item>
    <item name="Satellite">Satellite</item>
    <item name="Traffic">Traffic</item>
</string-array> 
```

谢谢你。

**这是偏好屏幕。当用户按下这些选项之一时，我希望它更新 MapActivity。**

![偏好屏幕](../Images/f59efebbf3350c727600e87f8d0b82a4.png)![地图活动](../Images/5c7b733722574f75a2318e12b74373d5.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T17:00:49.683

接听您的`MapActivity`电话`registerOnSharedPreferenceChangeListener()`，然后处理`SharedPreference`您的`OnSharedPreferenceChangeListener`.

或者，只需重新阅读并应用 中的首选项`onResume()`，因为您的`PreferenceActivity`和您的`MapActivity`不会同时出现在屏幕上。

# android - 将密码放在android类上

> ID：10161062
> 
> 赞同：0
> 
> 时间：2012-04-15T10:04:07.830
> 
> 标签：android

我一直在开发一个短信应用程序，我想为用户提供一些私人空间......只有在用户输入正确的用户名和密码时才能访问......我怎样才能做到这一点......？有人告诉我，我可以使用，`AccountManager`但我怎么能把它和`my class or activity`我要输入密码的地方联系起来……

```
public class PrivateSpace extends Activity{

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState); 
```

任何帮助将不胜感激...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T10:23:20.267

我认为可以通过使用共享首选项轻松实现..像这样存储您的应用程序的密码..

```
 SharedPreferences settings = getSharedPreferences("my_shared_pref", 0);
  String password = settings.getString("password", "empty");
  if(password == "empty"){

   //store the value in your edittext as password

   }
 else{
    //if string in edittext matches with the password value.. let the user enter the activity.. else make a toast of wrong password..
 } 
```

# javascript - WHILE 循环中的 GM_xmlhttpRequest

> ID：10161063
> 
> 赞同：2
> 
> 时间：2012-04-15T10:04:10.380
> 
> 标签：javascript, while-loop, greasemonkey, fetch, gm-xmlhttprequest

我有一个相当简单的任务来替换页面上的特定文本。假设有 10 个 DIV，每个 DIV 都包含特定信息。我想根据数据库检查此信息，并将文本替换为数据库中的结果。

我将 GM_xmlhttpRequest 放在一个循环中，该循环应该检查此信息并为 10 个 DIV 中的每一个替换它。不幸的是，这不起作用，最后一个 DIV 包含 10 个完全相同的信息。也就是说，当 i=10 时，GM_xmlhttpRequest 被执行了 10 次。

下面是一个简化的代码：

```
var i=1;
while (i<=10) {
  var id = 'div-' + i; //This sets the name of the DIV
  var ShowContent = document.getElementById(id);
  GoToURL = "http://domain.com/?=" + id; //This specifies a URL that changes on every loop
  GM_xmlhttpRequest({
    method: "GET",
    url: GoToURL,
    onload: function(response) {
      ShowContent.innerHTML = response; //This should replace the information for each DIV
      alert(i); //TEST: this shows always 11 (even not 10!). Why?
    }
  });
  i++;
) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T10:28:31.747

Ajax 是异步的，所以当响应被传递时，你的循环已经结束（所以`i=11`）。

但是您可以使用闭包来处理`'i'`响应函数：

```
 var i=1;
 while (i<=10) {
   (function(i){
     var id = 'div-' + i; //This sets the name of the DIV
     var ShowContent = document.getElementById(id);
     GoToURL = "http://domain.com/?=" + id; //This specifies a URL       
     GM_xmlhttpRequest({
         method: "GET",
         url: GoToURL,
         onload: function(response) {
            ShowContent.innerHTML = response; //This should replace the information for each DIV
            alert(i); 
         }
     });
   })(i);
  i++;
} 
```

# android - 如何使用 SimpleAdapter 中的 ImageLoader 类从 ImageUrl 显示 ImageView？

> ID：10161064
> 
> 赞同：0
> 
> 时间：2012-04-15T10:04:13.453
> 
> 标签：android, imageview, listactivity, simpleadapter, image-loading

我有以下类来解析 JSON 并显示名称和其他详细信息，我在列表视图中没有提到。
**ShowViewActivity.java**

```
public class ShowViewActivity extends ListActivity {

private static String url = "http://example.com/myfile.php";
private static final String TAG_ROOT = "root";
private static final String TAG_NAME = "name";
private static final String TAG_IMAGE = "image";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    ArrayList<HashMap<String, String>> myList = new ArrayList<HashMap<String, String>>();
    JSONParser jParser = new JSONParser();
    JSONObject json = jParser.getJSONFromUrl(url);
    try {
        root = json.getJSONArray(TAG_ROOT);
        for (int i = 0; i < root.length(); i++) {
            JSONObject c = root.getJSONObject(i);
            String name = c.getString(TAG_NAME);
            String image = c.getString(TAG_IMAGE);
            HashMap<String, String> map = new HashMap<String, String>();
            map.put(TAG_NAME, name);
            map.put(TAG_IMAGE, image);
            myList.add(map);
        }
    } catch (JSONException e) {
        e.printStackTrace();
    }

    myAdapter adapter = new myAdapter(this, myList, R.layout.list_item,
            new String[] {}, new int[] {});

    setListAdapter(adapter);
    final ListView lv = getListView();

    // Launching new screen on Selecting Single ListItem
    lv.setOnItemClickListener(new OnItemClickListener() {

        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {

        }

    });

}

private class myAdapter extends SimpleAdapter {

    public myAdapter(Context context, List<? extends Map<String, ?>> data,
            int resource, String[] from, int[] to) {
        super(context, data, resource, from, to);

    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {

        if (convertView == null) {
            convertView = getLayoutInflater().inflate(R.layout.list_item,
                    null);
        }

        HashMap<String, Object> data = (HashMap<String, Object>) getItem(position);

        TextView nameTextView = (TextView) convertView
                .findViewById(R.id.name);
        ImageView iconImageView = (ImageView) convertView
                .findViewById(R.id.listicon);

        String nameString = (String) data.get(TAG_NAME);
        nameTextView.setText(nameString);
        String imageUrl = (String) data.get(TAG_IMAGE);

        return convertView;
    }
}
} 
```

我想实现以下 ImageDownloader 类来显示来自 web url 的图像。

**ImageDownloader.java**

```
public class ImageLoader {

// the simplest in-memory cache implementation. This should be replaced with
// something like SoftReference or BitmapOptions.inPurgeable(since 1.6)
private HashMap<String, Bitmap> cache = new HashMap<String, Bitmap>();

private File cacheDir;

public ImageLoader(Context context) {
    // Make the background thead low priority. This way it will not affect
    // the UI performance
    photoLoaderThread.setPriority(Thread.NORM_PRIORITY - 1);

    // Find the dir to save cached images
    if (android.os.Environment.getExternalStorageState().equals(
            android.os.Environment.MEDIA_MOUNTED))
        cacheDir = new File(
                android.os.Environment.getExternalStorageDirectory(),
                "LazyList");
    else
        cacheDir = context.getCacheDir();
    if (!cacheDir.exists())
        cacheDir.mkdirs();
}

final int stub_id = R.drawable.icon;

public void DisplayImage(String url, Activity activity, ImageView imageView) {
    if (cache.containsKey(url))
        imageView.setImageBitmap(cache.get(url));
    else {
        queuePhoto(url, activity, imageView);
        imageView.setImageResource(stub_id);
    }
}

private void queuePhoto(String url, Activity activity, ImageView imageView) {
    // This ImageView may be used for other images before. So there may be
    // some old tasks in the queue. We need to discard them.
    photosQueue.Clean(imageView);
    PhotoToLoad p = new PhotoToLoad(url, imageView);
    synchronized (photosQueue.photosToLoad) {
        photosQueue.photosToLoad.push(p);
        photosQueue.photosToLoad.notifyAll();
    }

    // start thread if it's not started yet
    if (photoLoaderThread.getState() == Thread.State.NEW)
        photoLoaderThread.start();
}

private Bitmap getBitmap(String url) {
    // I identify images by hashcode. Not a perfect solution, good for the
    // demo.
    String filename = String.valueOf(url.hashCode());
    File f = new File(cacheDir, filename);

    // from SD cache
    Bitmap b = decodeFile(f);
    if (b != null)
        return b;

    // from web
    try {
        Bitmap bitmap = null;
        InputStream is = new URL(url).openStream();
        OutputStream os = new FileOutputStream(f);
        Utils.CopyStream(is, os);
        os.close();
        bitmap = decodeFile(f);
        return bitmap;
    } catch (Exception ex) {
        ex.printStackTrace();
        return null;
    }
}

// decodes image and scales it to reduce memory consumption
private Bitmap decodeFile(File f) {
    try {
        // decode image size
        BitmapFactory.Options o = new BitmapFactory.Options();
        o.inJustDecodeBounds = true;
        BitmapFactory.decodeStream(new FileInputStream(f), null, o);

        // Find the correct scale value. It should be the power of 2.
        final int REQUIRED_SIZE = 70;
        int width_tmp = o.outWidth, height_tmp = o.outHeight;
        int scale = 1;
        while (true) {
            if (width_tmp / 2 < REQUIRED_SIZE
                    || height_tmp / 2 < REQUIRED_SIZE)
                break;
            width_tmp /= 2;
            height_tmp /= 2;
            scale++;
        }

        // decode with inSampleSize
        BitmapFactory.Options o2 = new BitmapFactory.Options();
        o2.inSampleSize = scale;
        return BitmapFactory.decodeStream(new FileInputStream(f), null, o2);
    } catch (FileNotFoundException e) {
    }
    return null;
}

// Task for the queue
private class PhotoToLoad {
    public String url;
    public ImageView imageView;

    public PhotoToLoad(String u, ImageView i) {
        url = u;
        imageView = i;
    }
}

PhotosQueue photosQueue = new PhotosQueue();

public void stopThread() {
    photoLoaderThread.interrupt();
}

// stores list of photos to download
class PhotosQueue {
    private Stack<PhotoToLoad> photosToLoad = new Stack<PhotoToLoad>();

    // removes all instances of this ImageView
    public void Clean(ImageView image) {
        for (int j = 0; j < photosToLoad.size();) {
            if (photosToLoad.get(j).imageView == image)
                photosToLoad.remove(j);
            else
                ++j;
        }
    }
}

class PhotosLoader extends Thread {
    public void run() {
        try {
            while (true) {
                // thread waits until there are any images to load in the
                // queue
                if (photosQueue.photosToLoad.size() == 0)
                    synchronized (photosQueue.photosToLoad) {
                        photosQueue.photosToLoad.wait();
                    }
                if (photosQueue.photosToLoad.size() != 0) {
                    PhotoToLoad photoToLoad;
                    synchronized (photosQueue.photosToLoad) {
                        photoToLoad = photosQueue.photosToLoad.pop();
                    }
                    Bitmap bmp = getBitmap(photoToLoad.url);
                    cache.put(photoToLoad.url, bmp);
                    if (((String) photoToLoad.imageView.getTag())
                            .equals(photoToLoad.url)) {
                        BitmapDisplayer bd = new BitmapDisplayer(bmp,
                                photoToLoad.imageView);
                        Activity a = (Activity) photoToLoad.imageView
                                .getContext();
                        a.runOnUiThread(bd);
                    }
                }
                if (Thread.interrupted())
                    break;
            }
        } catch (InterruptedException e) {
            // allow thread to exit
        }
    }
}

PhotosLoader photoLoaderThread = new PhotosLoader();

// Used to display bitmap in the UI thread
class BitmapDisplayer implements Runnable {
    Bitmap bitmap;
    ImageView imageView;

    public BitmapDisplayer(Bitmap b, ImageView i) {
        bitmap = b;
        imageView = i;
    }

    public void run() {
        if (bitmap != null)
            imageView.setImageBitmap(bitmap);
        else
            imageView.setImageResource(stub_id);
    }
}

public void clearCache() {
    // clear memory cache
    cache.clear();

    // clear SD cache
    File[] files = cacheDir.listFiles();
    for (File f : files)
        f.delete();
}

} 
```

我看到了扩展 BaseAdapter 的延迟加载示例，但在这里我使用的是扩展 SimpleAdapter 的自定义适配器名称 myAdapter ？
如何实现此 ImageLoader 类以从 Web 图像 url 显示图像视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T12:07:22.587

第一步是获取一个`ImageDownloader`实例。我建议您为实例使用一些集中位置，例如您自己的`Application`. 这样，您只需创建一次，然后在需要的任何地方使用它。此外，如果您在每次调用时（重新）构造此对象，则提供的缓存将仅限于无用。或者，您可以将课程设置为单例，尽管我个人更喜欢前者。

拥有`ImageDownloader`对象后，只需按如下所述对自定义适配器进行更改。由于您需要传入一个`Activity`引用，因此请保留一个句柄来处理`Context`您传递给`myAdapter`. 在正常情况下，这实际上是`Activity`运行时的引用。

```
private class myAdapter extends SimpleAdapter {

    private Context mContext;

    public myAdapter(Context context, List<? extends Map<String, ?>> data, int resource, String[] from, int[] to) {
        super(context, data, resource, from, to);
        mContext = context;

    }

    ...

    @Override public View getView(int position, View convertView, ViewGroup parent) {
        ...

        // assuming you have an instance of ImageDownloader here
        // 
        mImageDownloader.DisplayImage(imageUrl,(Activity)mContext, iconImageView);
    }

    ...
} 
```

# java - java中的数据库

> ID：10161071
> 
> 赞同：0
> 
> 时间：2012-04-15T10:05:00.963
> 
> 标签：java, sql, database, jsp

我正在寻找一个Java框架或环境来加快在数据库中创建表以及相应的数据类和网页的过程......

所以我基本上是在寻找比编写 sql 命令更快的方法来构建数据库表，然后实现数据类以在查询中使用它们，然后创建 JSP 页面来处理数据......

[我的环境设置：JAVA、Ubuntu、Apache-Tomcat、mySQL]

有什么建议么？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T10:12:49.600

以下是一些可以帮助您入门的名称：

```
JPA - Java Persistence API  
Hibernate - JPA implementation. Especially good for use with J2EE  
EclipseLink - Non J2EE implementation of JPA 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T10:14:37.537

您可以使用[ORM](http://en.wikipedia.org/wiki/List_of_object-relational_mapping_software#Java)（即 Hibernate），但我会推荐它用于复杂且广泛链接的表，因为它是值得的。

我喜欢使用[JdbcTemplate](http://static.springsource.org/spring/docs/2.5.x/reference/jdbc.html)。它非常快速，使用简单，您可以完全控制整个过程。与 ORM 框架相比，它的级别有点低，但对于简单的数据库来说，它很棒。[您可以在本教程](http://www.mkyong.com/spring/spring-jdbctemplate-querying-examples/)中看到它的样子，也可以阅读[这篇文章](http://www.mkyong.com/spring/spring-jdbctemplate-jdbcdaosupport-examples/)，其中 JdbcTemplate 与标准 Java 访问进行了比较

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-15T10:15:31.523

NetBeans IDE 有很好的支持；从数据库生成 JPA 实体类，反之亦然从实体类生成表。此外还有精美的教程。

# c++ - 在 C++ 中与复制构造函数作斗争

> ID：10161072
> 
> 赞同：0
> 
> 时间：2012-04-15T10:05:10.223
> 
> 标签：c++, visual-c++

我正在尝试为我的结构编写一个复制构造函数，但我似乎并没有做到这一点，并且希望能提供任何帮助。我想递归地做一个深拷贝，但我不断收到在初始化列表中初始化的建议，而且这似乎也不是很好。

```
struct Node
{
    Node* left; // will be our previous
    Node* right;// will be our next
    Node* previous;// get a handle to the previous node
    string value;

    Node(string nval): left(NULL), right(NULL), previous(NULL), value(nval)
    {

    }

    Node(Node const& node)
     : previous(new Node(node.previous)), 
       left(new Node(node.left)), 
       right(new Node(node.right)), 
       value(node.value)
    {
    }

    Node& operator=(const Node&)
    {
       // ...
    }
}; 
```

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-15T10:09:08.660

为避免这种无限递归，您需要测试是否为空。您还需要取消引用 RHS 节点中的对象。

```
 Node(Node const& node) :
     previous(node.previous ? new Node(*node.previous) : NULL),
     left(node.left ? new Node(*node.left) : NULL),
     right(node.right ? new Node(*node.right) : NULL), 
     value(node.value)
 {
 } 
```

但这只有在`previous != next != previous`始终成立并且您的节点不指向对方的情况下才有效。如果这是一个链表结构，这将不起作用。

我猜您的节点确实指向在一起，而您在这里尝试做的是在复制一个节点时克隆整个数据结构。在那种情况下，我看不出有一种方法可以在复制构造函数中明智地做到这一点。我建议使类不可复制并编写一个单独的函数来克隆整个数据结构。如果您提供更多关于如何构建`Node`s 结构的上下文，我也许可以提供更具体的建议。

**编辑**

您在评论中指出这是一棵树，那`previous`是父节点指针。这个复制构造函数应该做一个子树克隆：

```
Node(Node const& node) :
    previous(NULL),
    left(node.left ? new Node(*node.left) : NULL),
    right(node.right ? new Node(*node.right) : NULL), 
    value(node.value)
{
    if (left)
        left->previous = this;
    if (right)
        right->previous = this;
} 
```

请注意，它没有分配新`Node`的 for `previous`，而是将其留空并让其父级设置它。

# c - C递归函数

> ID：10161073
> 
> 赞同：-1
> 
> 时间：2012-04-15T10:05:38.133
> 
> 标签：c, function, recursion

我有这个代码：

```
#include <stdio.h>
#include <stdlib.h>

int func(int n0, int n);

int main ()
{
    int n0, n, nFinal=0;
    printf ("Enter constant (n0): ");
    scanf ("%d", &n0);
    printf ("Enter the number of iteractions (n): ");
    scanf ("%d", &n);
    nFinal = func(n0, n);
    printf ("nFinal after %d iteractions is %d: \n", n, nFinal);
    return 0;
}

int func(int n0, int n){
    int i,nFinal=0;

    for (i = 0; i < n; i++){
        nFinal = (nFinal*nFinal) + n0;
    }

    return nFinal;
} 
```

nFinal 在 for 循环中计算。我想实现相同的结果，但执行递归函数。

从我所见，我无法更改函数调用，因为我总是需要起始编号和迭代次数。因此，在第一次迭代之后，程序将不得不再次调用，`nFinal = func (n0, n);`但由于我需要在每次迭代 nFinal 的计算值时，我将不得不改变它。

是否可以创建递归函数但将函数保持为`nFinal = func (n0, n);`？

有人可以指点我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T10:24:43.037

我想你正在寻找这个：

```
int func(int n0, int n){
    if (n > 1){
        int nFinal = func(n0, --n);
        return (nFinal*nFinal) + n0;
    }
    return n0; // (0*0) + n0
} 
```

请注意，`if (n == 1)`它返回`n0`，否则它调用`func`，将其返回值存储在`nFinal`并返回`(nFinal*nFinal) + n0`。

此函数的等效版本也可以调用自身 for`n == 1`和`return 0`for `n == 0`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T10:25:44.457

查看您的功能

```
int func(int n0, int n){
    int i,nFinal=0;

    for (i = 0; i < n; i++){
        nFinal = (nFinal*nFinal) + n0;
    }

    return nFinal;
} 
```

如果 n 为（小于）0，则您的结果为 0。那么 nFinal 的新值是 nFinal^2 + n0 的旧值，因此您得到：

```
int func(int n0, int n){
    if (n <= 0) return 0;

    int f = func(n0, n-1);
    return f*f + n0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T10:29:17.170

在每次迭代中，您对原始值（和参数）进行一些数学运算，然后将其存储。关于如何使其递归，您有两种广泛的选择。

1.  首先进行所有迭代`n-1`，然后在返回之前对其进行更多数学运算。这似乎更自然地首先使它成为递归。

2.  首先执行此迭代的数学运算，然后将结果传递给递归调用以执行其余的计算。`n`这是尾递归（除非会变得非常大并且您知道编译器将对其进行优化以节省堆栈空间，否则这不太重要；-)。

递归就像数学归纳法。你需要考虑你的基本情况和你的归纳步骤。在您的功能中，您的基本情况类似于：

*   如果`n = 0`，则`func(n0, n)`返回`0`。

你的步骤是：

*   `func(n0, n)`返回`func(n0,n-1) * func(n0,n-1) + n0`。（您可以只调用一次函数并将其保存到局部变量中。）

这转化为标准的 if-else 构造。看看你到目前为止是否能理解它，如果你卡住了，请告诉我。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-15T10:30:59.233

```
#include <stdio.h>
#include <stdlib.h>

int func_r(int n0, int n, int acc);

int main (){
    int n0, n, nFinal;
    printf ("Enter constant (n0): ");
    scanf ("%d", &n0);
    printf ("Enter the number of iteractions (n): ");
    scanf ("%d", &n);
    nFinal = func_r(n0, n, 0);
    printf ("nFinal after %d iteractions is %d: \n", n, nFinal);
    return 0;
}

int func_r(int n0, int n, int acc){
    if(n == 0)
        return acc;
    return func_r(n0, n-1, acc*acc + n0);
} 
```

# php - PHP PDO，需要确保我理解我编码的内容吗？

> ID：10161074
> 
> 赞同：0
> 
> 时间：2012-04-15T10:05:47.327
> 
> 标签：php, pdo, mysqli

有人可以告诉我什么时候你`prepare()`有一个语句（在我的例子中是一个更新语句）然后`execute()`它，然后我`rowCount()`在更新查询之后检查使用（见下面的代码），`rowCount() > 0`如果它是然后找到匹配并且更新发生了，但是我然后得到一个 else 声明。

为了确保我不会对语句中的语法错误和条件感到困惑，我想在下面的代码中询问（已详细评论特定区域） else 语句是否基本上意味着**无法更新，因为找不到匹配项**和/或可能的语法错误或其他错误？我认为这意味着我加粗的只是想确保我不会让自己感到困惑。

请忽略准备语句中的 SQL UPDATE 语法本身，因为它是错误的，稍后会处理。我认为代码解释得更好，并在我正在谈论的区域中提供了详细的评论。

```
// check if key is set and alphanumeric and equals 40 chars long
// we use sha1 so it will always be 40 chars long.
if(isset($_GET['key']) && ctype_alnum($_GET['key']) && strlen($_GET['key']) == 40){
$key = trim($_GET['key']);
}

// if key isset and valid
if(isset($key)){

try {
    // connect to database
    $dbh = sql_con();

    // checke if activation key matches and user_uid matches
    $stmt = $dbh->prepare("
            SELECT
              users_status.user_uid,
              users_status.user_activation_key
            FROM
              users_status
            JOIN
              users
            ON
              users_status.user_activation_key = ?
            AND
              users_status.user_uid = users.user_uid LIMIT 1");

    // execute query
    $stmt->execute(array($key));

    // if row count greater than 0 then match found
    if ( $stmt->rowCount() > 0 ) {

        // user verified; we now must update users status in users table to active = 1
        // and set the user_activation_key in the users_status to NULL
        $stmt = $dbh->prepare("
            UPDATE
              users.user_status,
              users_status.user_activation_key
            SET
              user_status = ".USER_STATUS_ACTIVE.",
              user_activation_key = NULL
            JOIN
              users
            ON
              users_status.user_activation_key = ?
            AND
              users_status.user_uid = users.user_uid LIMIT 1");

        // execute query
        $stmt->execute(array($key));

        if ( $stmt->rowCount() > 0 ) {

            echo 'account now activated';
            exit;

        } else {
            // update not sucessful
            // THIS IS THE BIT IM CONFUSED WITH;
            // IF RETURNED RESULT IS 0 (WHICH IT WILL BE IF I GET HERE WHEN RUNNING SCRIPT)
            // THEN I GUESS THAT MEANS THERE WAS NOT AN ERROR IN SQL SYNTAX BUT
            // CONDITION IN SQL STATEMENT COULD NOT BE MATCHED ? IS THAT CORRECT WHAT I AM THINKING ?
            // IF I AM CORRECT THEN OBVIOUSLY I WILL DISPLAY A MESSAGE TO USER AND EXIT HERE;
            // AS IF I AM THINKING RITE ANY SYNTAX ERROR WOULD BE CAUGHT BY CATCH BLOCK AND THIS ELSE STATEMENT
            // MEANS COULD NOT UPDATE BECAUSE NO MATCH IN UPDATE QUERY COULD BE FOUND ?
        }

    } // else no match found
    else {

        // no match found invalid key
        echo '<h1>Invalid Activation Link</h1>';

        $SiteErrorMessages =
        "Oops! Your account could not be activated. Please recheck the link in your email.
        The activation link could not be found or the account has already been activated.";

        SiteErrorMessages();

        include($footer_inc);
        exit;

    }

    // close database connection
    $dbh = null;

} // if any errors found log them and display friendly message
catch (PDOException $e) {
    ExceptionErrorHandler($e);
    require_once($footer_inc);
    exit;
}

} else {

// else key not valid or set
echo '<h1>Invalid Activation Link</h1>';

$SiteErrorMessages =
"Oops! Your account could not be activated. Please recheck the link in your email.
The activation link appears to be invalid.<br /><br />
If the problem persists please request a new one <a href='/member/resend-activation-email'>here</a>.";

SiteErrorMessages();

include($footer_inc);
exit;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T10:25:08.047

如果您要进行多次更新，那么您应该真正使用事务。

但请注意，默认 MyISAM 引擎不支持事务，因此`ALTER TABLE tbl_name ENGINE=InnoDB`如果您希望它工作，则需要：

```
$success = false;
$dbh->beginTransaction();
# perform your first query
if ($query->rowCount() == 1) {
   # something was updated/inserted/deleted
   # perform second query
   if ($query->rowCount() == 1) {
       $success = true;
   }
}

if ($success) $dbh->commit();
else $dbh->rollBack(); 
```

至于你的问题，你可能需要围绕你的 ? 使用单引号，因此将您的声明更改为：

```
users_status.user_activation_key = '?'; 
```

您可能没有得到结果的另一个原因是，如果您的 $key 是一个整数并且您使用该`PreparedStatement::execute($array)`方法绑定您的参数，您需要确保将值转换为正确的类型以使其工作，例如：

```
$query->execute(array((int)$key)); 
```

否则只需使用`$query->bindParam($key)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T10:13:34.323

你说的对：

```
if $stmt->rowCount() == 0 
```

那么这意味着没有行被更新。

如果您在执行查询时遇到 sql 错误或错误，您会在执行时收到 FALSE 返回值或 PDO EXCEPTION

```
 execute(array($key)); 
```

# c# - Crystal Reports 代码合同冲突

> ID：10161078
> 
> 赞同：2
> 
> 时间：2012-04-15T10:06:29.497
> 
> 标签：c#, .net-4.0, crystal-reports, code-contracts

我们有一个在 .NET 4 上使用 C# 和代码合同构建的解决方案。我们希望使用 Crystal Reports 13，但遇到了一个主要问题。

当我们尝试使用水晶报表时，会出现以下异常：

> 程序集引用未解决：BusinessObjects.Licensing.KeycodeDecoder，版本=13.0.2000.0，文化=中性，PublicKeyToken=692fbea5521e1304。

当 Code Contracts 运行时检查被禁用（未选中）时，不会发生此异常；但代码合同抱怨必须启用重写器。不幸的是，代码库中充斥着`Contract.Requires<TException>(bool)`调用，如果更改为 if-then-throws 样式将是一场噩梦。

有没有其他人遇到过这种不兼容？如果是这样，他们是如何克服的？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:40:57.600

您是否尝试向 ContractProperties 添加一个额外的库路径，该路径指向您计算机上包含丢失的 dll 的目录？重写器有时会比 C# 编译器追逐更多的引用，从而导致这个问题浮出水面。

# android - 添加一些图像按钮时Android中的内存不足异常

> ID：10161079
> 
> 赞同：1
> 
> 时间：2012-04-15T10:06:40.207
> 
> 标签：android

我编写了一个显示一些（图像）按钮的小型 Android 项目。它在我的手机（ Galaxy S ）上运行良好，但是当我尝试在模拟器上运行它时，它给出了以下错误： Caused by: java.lang.OutOfMemoryError: bitmap size exceeded VM budget

请注意，第一个活动，有 8 个图像按钮，它给出了内存不足的异常。当我删除 3 个按钮时，它工作正常。实际上，只要 scrollView 是不可见的，它就可以正常工作，如果我添加这 3 个已删除的按钮（因此，scrollView 将可见），它会给出内存不足错误。我认为，这种“内存不足”异常与（图像）按钮的数量无关，而是与背景图像有关。这是我的 XML 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/rootid"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <FrameLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >

        <ImageView
            android:id="@+id/image"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:scaleType="center"
            android:src="@drawable/backgrounmobile" />

        <ScrollView
            android:id="@+id/ScrollView01"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:layout_gravity="left|top|bottom|right" >

            <LinearLayout
                xmlns:android="http://schemas.android.com/apk/res/android"
                android:id="@+id/centerlayout"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_gravity="right|top|bottom"
                android:layout_marginBottom="10dip"
                android:layout_marginLeft="10dip"
                android:layout_marginRight="20dip"
                android:layout_marginTop="0dip"
                android:orientation="vertical" >

                <Button
                    android:id="@+id/divan"
                    android:layout_width="160dip"
                    android:layout_height="110dip"
                    android:layout_gravity="center|top"
                    android:background="@drawable/divanbtn" />

                <Button
                    android:id="@+id/boostan"
                    android:layout_width="160dip"
                    android:layout_height="110dip"
                    android:layout_gravity="center|top"
                    android:background="@drawable/boostanbtn" />

                <Button
                    android:id="@+id/mavaez"
                    android:layout_width="160dip"
                    android:layout_height="110dip"
                    android:layout_gravity="center|top"
                    android:background="@drawable/mavaezbtn" />

                <Button
                    android:id="@+id/hekayat"
                    android:layout_width="160dip"
                    android:layout_height="110dip"
                    android:layout_gravity="center|top"
                    android:background="@drawable/hekayatbtn" />

                <Button
                    android:id="@+id/saadiname"
                    android:layout_width="160dip"
                    android:layout_height="110dip"
                    android:layout_gravity="center|top"
                    android:background="@drawable/saadinamebtn" />

                <Button
                    android:id="@+id/settings"
                    android:layout_width="160dip"
                    android:layout_height="110dip"
                    android:layout_gravity="center|top"
                    android:background="@drawable/settingsbtn" />

                <Button
                    android:id="@+id/about"
                    android:layout_width="160dip"
                    android:layout_height="110dip"
                    android:layout_gravity="center|top"
                    android:background="@drawable/aboutbtn" />
            </LinearLayout>
        </ScrollView>
    </FrameLayout>

</LinearLayout> 
```

你能帮帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T10:11:03.513

定义按钮的文件有多大（文件大小，而不是图像尺寸）？看起来那些太大了。Android 需要一次将它们全部加载到主内存中才能显示它们。

对于我的应用程序，所有这些文件都在 0.5~2kB 范围内

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-15T10:11:11.630

您的内存不足，最好的补救方法是使用更少的内存，加载较小的图像在这里会有很大帮助，谷歌的 android 团队已经很友好地对如何做到这一点进行了简短的描述： )

[http://developer.android.com/training/displaying-bitmaps/load-bitmap.html](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-15T10:12:41.427

我想你可能会发现这个有用[http://mobi-solutions.blogspot.com/2010/08/how-to-if-you-want-to-create-and.html](http://mobi-solutions.blogspot.com/2010/08/how-to-if-you-want-to-create-and.html)

# opengl - 为什么 OpenGL + GLSL 着色器不输出任何东西？

> ID：10161084
> 
> 赞同：2
> 
> 时间：2012-04-15T10:07:21.690
> 
> 标签：opengl, glsl, shader

总之，我的全屏着色器没有输出任何东西，

我正在用 GLSL 编写一个延迟着色器，并且已经到了在屏幕空间中应用灯光的阶段。我有一个环境通道，我基本上将 GBuffer 中的漫反射强度写入默认 FBO，这工作正常。然后我应用另一个全屏四边形来计算场景中的定向光，这也是来自 GBUffer 的样本，应该与默认的 FBO 混合。

我遇到的问题是定向光着色器不输出任何东西。我使用与环境通道相同的矩阵和变换，但没有任何变化。

我尝试了以下方法；

1.  在环境通道中的每个片段上输出相同的颜色，以确保它完全输出。（作品）
2.  在定向光通道中的每个片段输出相同的颜色。（仍然一无所获）
3.  将屏幕分辨率用于 XY 顶点坐标，而不是归一化坐标；
    *   这适用于环境通道，因为我可以看到结果按预期变化。
    *   它对定向光通过没有任何改变，我得到相同的输出。
4.  将环境着色器更改为从法线或位置缓冲区中采样，以确保可以从（工作）中采样纹理

这是应用程序代码；

```
glBindFramebuffer(GL_READ_FRAMEBUFFER, m_GeometryBuffer->m_Name);
glBindFramebuffer(GL_DRAW_FRAMEBUFFER, 0);
glDrawBuffers(1,draw_buffers);
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

m_AmbientShader->Begin();
    m_AmbientShader->SetUniformInt1("Diffuse",m_DiffuseTexture->m_TextureUnit);
    // Draw full screen quad
    glBegin(GL_QUADS);
        glMultiTexCoord2i(GL_TEXTURE0,0,0);
        glVertex2i(-1,-1);
        glMultiTexCoord2i(GL_TEXTURE0,1,0);
        glVertex2i(1,-1);
        glMultiTexCoord2i(GL_TEXTURE0,1,1);
        glVertex2i(1,1);
        glMultiTexCoord2i(GL_TEXTURE0,0,1);
        glVertex2i(-1,1);
    glEnd();
m_AmbientShader->End();

const DirectionalLight& dl = scene.GetDirectionalLight();

glDrawBuffers(1, draw_buffers);
m_DirectionalLightShader->Begin();
m_DirectionalLightShader->SetUniformInt1("Diffuse",m_DiffuseTexture->m_TextureUnit);
m_DirectionalLightShader->SetUniformInt1("Position",m_PositionTexture->m_TextureUnit);
m_DirectionalLightShader->SetUniformInt1("Normal",m_NormalTexture->m_TextureUnit);
m_DirectionalLightShader->SetUniformFloat3("LightDir",dl.GetDirection());
m_DirectionalLightShader->SetUniformFloat3("LightAmb",dl.GetAmb());
m_DirectionalLightShader->SetUniformFloat3("LightDiff",dl.GetDiff());
m_DirectionalLightShader->SetUniformFloat3("LightSpec",dl.GetSpec());
m_DirectionalLightShader->SetUniformFloat3("LightAtt",dl.GetAtt());
m_DirectionalLightShader->SetUniformFloat1("LightIntensity",dl.GetIntensity());
    // Draw full screen quad
    glBegin(GL_QUADS);
        glMultiTexCoord2i(GL_TEXTURE0,0,0);
        glVertex2i(-1,-1);
        glMultiTexCoord2i(GL_TEXTURE0,1,0);
        glVertex2i(1,-1);
        glMultiTexCoord2i(GL_TEXTURE0,1,1);
        glVertex2i(1,1);
        glMultiTexCoord2i(GL_TEXTURE0,0,1);
        glVertex2i(-1,1);
    glEnd();
m_DirectionalLightShader->End(); 
```

如果我的数学错误，请原谅，我一直在搞乱着色器以尝试获得任何类型的输出，但这里是着色器源文件；

<-- 方向光.vert -->

```
varying out vec2 ScreenPos;

varying out vec3 VSLightDir;

uniform vec3 LightDir;
uniform vec3 LightAmb;
uniform vec3 LightDiff;
uniform vec3 LightSpec;
uniform float LightIntensity;

void main()
{
    gl_Position = gl_Vertex;
    ScreenPos = gl_MultiTexCoord0.st;
    VSLightDir = normalize((gl_ModelViewMatrix * vec4(LightDir,0.0)).xyz);
} 
```

<-- 方向光.frag -->

```
// Gbuffer textures
uniform sampler2D Diffuse;
uniform sampler2D Position;
uniform sampler2D Normal;

in vec2 ScreenPos;
uniform vec3 LightDir;
uniform vec3 LightAmb;
uniform vec3 LightDiff;
uniform vec3 LightSpec;
uniform float LightIntensity;

in vec3 VSLightDir;
out vec4 OutColour;

void main()
{
    // Sample from the GBuffer
    vec4 Diffuse = texture2D(Diffuse, ScreenPos);
    vec4 VSPos = texture2D(Position, ScreenPos);
    vec4 MRT2 = texture2D(Normal, ScreenPos);
    vec3 VSNormal = normalize(MRT2.xyz);
    float Shininess = MRT2.w;

    float LDotN = dot(VSNormal, VSLightDir);

    vec3 View = -normalize(VSPos.xyz);

    // Compute ambient contribution
    vec3 ambient = LightIntensity * LightAmb * Diffuse.xyz;

    // Compute diffuse contribution
    vec3 diffuse = LightIntensity * LightDiff * Diffuse.xyz * max(0.0, LDotN);

    // Compute specular contribution
    vec3 HalfWay = normalize(LightDir + View);
    vec3 specular = (LDotN <= 0.0)
                ? vec3(0.0)
                : LightIntensity * LightSpec * Diffuse.xyz * pow(max(0.0, dot(VSNormal,HalfWay)), Shininess);

    OutColour = vec4(ambient + diffuse + specular, Diffuse.a);
    //OutColour = vec4(0.0,0.0,1.0,1.0); //Debug line
} 
```

<-- 环境.vert -->

```
varying out vec2 ScreenPos;

void main()
{
    gl_Position = gl_Vertex;

    // Used for the position to sample from GBuffer
    ScreenPos = gl_MultiTexCoord0.st;
} 
```

<-- 环境.frag -->

```
// Gbuffer textures
uniform sampler2D Diffuse;

in vec2 ScreenPos;

out vec4 OutColour;

void main()
{
    OutColour = texture2D(Diffuse, ScreenPos);
    //OutColour = vec4(0.0,0.0,1.0,1.0);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T19:28:38.223

您是否启用了深度测试？我看到您正在清除深度缓冲区，所以我怀疑也许，但是您正在以与第一个完全相同的深度绘制第二个纹理。`glDepthFunc`默认情况下会`GL_LESS`导致第二次抽奖被完全拒绝。

或者，您希望如何将这两个平局结合起来？是否应该涉及一些混合？

# video - 来自 VLC 的 HTTP 流在 15 秒后冻结

> ID：10161085
> 
> 赞同：4
> 
> 时间：2012-04-15T10:07:30.660
> 
> 标签：video, video-streaming, vlc

我正在尝试使用 VLC 创建从 ubuntu 桌面到 html5 视频标签的实时 http 流。

这是我用来创建流的命令：

```
me@kaffeesatz:~$ vlc screen:// --screen-left=67 --screen-top=53 --screen-width=800 --screen-height=600 --screen-fps=15 --sout '#transcode{vcodec=theo,vb=800,scale=0.25,width=800,height=600,acodec=none}:http{mux=ogg,dst=:8181/graph.ogg}' --ttl=3 
```

出于测试目的，我使用 VLC 在另一台机器上打开了流，所以我排除了它；是挂起的视频标签。播放器在打开的流的开头附近显示一个帧，但随后不会更新。

在 Firefox 视频元素中打开文件时，会显示 15 秒的流，而不是更多。

我的流媒体设置错了吗？

更多信息：我使用 Ubuntu 11.10 流式传输窗口，使用 Windows 7 播放流。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T15:18:28.583

这可能会对您有所帮助：[如何将 VLC 直播流与 HTML5 视频一起使用？](https://stackoverflow.com/questions/7917905/how-to-use-vlc-live-streams-with-html5-video)

实时/实时流媒体：使用了 VLC，为了使其正常工作，我必须绕过 WebGL/HTML5 视频安全限制。

由于安全限制，可能不会播放并非源自相同 Web 服务器和 Web 上下文或子上下文的视频流。

# c# - 获取应用程序启动后经过的时间

> ID：10161088
> 
> 赞同：26
> 
> 时间：2012-04-15T10:08:06.323
> 
> 标签：c#, .net, wpf, timer

我正在将一个应用程序从 ActionScript3.0 (Flex) 移植到 C# (WPF)。AS3.0 有一个名为[getTimer()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/utils/package.html#getTimer%28%29)的方便实用程序，它返回自 Flash 虚拟机启动以来的时间（以毫秒为单位）。我在 C# 中通过类搜索

```
DateTime
DispatcherTimer
System.Diagnostics.Process
System.Diagnostics.Stopwatch 
```

但没有找到这样的东西。这对我来说似乎是一个非常基本的功能。例如在 Mono 上运行的 Unity3D 有一些熟悉的东西。我在这里错过了一些实用程序吗？

提前致谢。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-04-15T10:15:40.227

`Process.GetCurrentProcess().StartTime`是你的朋友。

..so 获取自开始以来经过的时间：

```
DateTime.UtcNow - Process.GetCurrentProcess().StartTime.ToUniversalTime() 
```

或者，如果您需要更多定义，`System.Diagnostics.Stopwatch`可能更可取。如果是这样，请在您的应用启动时启动秒表：

```
Stopwatch sw = Stopwatch.StartNew(); 
```

`sw.Elapsed`然后在执行运行期间查询该属性。

# objective-c - XCode MVC 说明

> ID：10161090
> 
> 赞同：0
> 
> 时间：2012-04-15T10:08:23.717
> 
> 标签：objective-c, xcode, cocoa, model-view-controller

我无法理解 XCode/Cocoa/Objective-C 编程中讨论的 MVC 概念。

这只是使用的术语吗？或者 XCode 中是否真的有一些函数可以让你构建一个组织良好的程序？

如果有人能澄清我真的很感激，我也无法澄清模型、“视图”和控制器的含义。

我认为模型是数据存储，就像数据库一样。最终这不是作为普通的类文件保存的吗？视图是您在界面生成器中创建的界面吗？最后，控制器只是你程序的主要代码，由几个方法组成吗？

对不起，如果这似乎是一个愚蠢的问题，来自 shell 脚本我只是觉得这一切都令人费解。

提前谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T10:25:14.390

在 XCode 中，您构建视图并将它们连接到控制器。所以你可以说它鼓励 MVC 设计。模型部分有点模糊。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T10:48:21.373

我建议您阅读*Cocoa Design Patterns*一书的前两章。它帮助我理解了 MVC 如何应用于 Cocoa。

# assembly - x86汇编，如何添加存储在内存中的变量？

> ID：10161104
> 
> 赞同：0
> 
> 时间：2012-04-15T10:10:44.707
> 
> 标签：assembly, x86, masm, masm32

平台：奔腾 4 处理器（我真的需要升级 :) 运行 Windows XP。我目前正在用 MASM32 组装。

我是汇编的绝对初学者，我正在尝试弄清楚如何添加变量。我了解如何定义变量、将数据放入寄存器以及如何将寄存器放入堆栈，但我不知道如何组合两个变量的值（通过相加）。

另外，任何人都可以给我一个链接或一些易于理解的x86汇编教程，到目前为止我发现的所有这些都是非常高级的东西，他们没有解释太多。那将不胜感激。

在此先感谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T15:01:49.630

简单加法：

```
add eax, ebx   ; Adds eax and ebx and stores the result in eax 
```

从内存中加载，然后添加，然后存储在内存中：

```
mov eax, DWORD PTR [esi]    ; Load a double word from memory into eax
mov ebx, DWORD PTR [edi]    ; Load a double word from memory into ebx
add eax, ebx                ; Adds eax and ebx and stores the result in eax
mov DWROD PTR[esi], eax     ; Store a double word in eax into memory 
```

在上面的示例中，DWORD PTR 并不是绝对需要的，但它是一个很好的练习习惯，因为它消除了任何歧义并使代码更易于阅读。

重要的是要记住，您只能添加相同大小的寄存器（上面示例中的 DWORD）。如果要添加两个不同大小的寄存器：

```
mov al, BYTE PTR [esi]    ; Loads a single byte from memory into al
mov bx, WORD PTR [edi]    ; Loads a word from memory into bx
movzx eax, al             ; Zero extends al into the entire eax register
movzx ebx, bx             ; Zero extends bx into the entire ebx register
add eax, ebx              ; Adds eax and ebx and stores the result in eax 
```

这不是一个非常好的例子，因为有更简单的方法来做同样的事情，但希望它会展示一些你可以使用的技巧。

您还可以将内存值添加到寄存器：

```
mov eax, DWORD PTR [esi]     ; Load a double word from memory into eax
add eax, DWORD PTR [edi]     ; Add a double word in memory to eax 
```

这是一个可以用作参考的好网站：[http ://ref.x86asm.net/](http://ref.x86asm.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T10:13:30.320

我怀疑你的概念有问题。x86 值存在于寄存器或内存中，变量的概念是更高级别的。添加值的一种方法是将它们放入寄存器中，然后调用添加操作。

[http://computertech.createmybb3.com/showthread.php?tid=116](http://computertech.createmybb3.com/showthread.php?tid=116)

# html - 类的 HTML 安全概念

> ID：10161114
> 
> 赞同：0
> 
> 时间：2012-04-15T10:11:59.767
> 
> 标签：html

所以我教了一门 HTML 编程课。我们学习了人们会使用的所有标准 HTML 标签。正在翻阅教科书，我注意到在安全性方面没有太多重点。到目前为止，我唯一能想到的安全方面就是确保将图像和脚本托管在服务器上。我应该教他们哪些其他安全措施？请记住，他们只知道 HTML - 没有别的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T10:26:41.650

安全性通常不能通过 HTML 实现。HTML 仅被设计为显示数据的标记语言。在 Web 开发中，它被称为专门的前端语言。

HTML 完全传递给客户端。您永远不应该在 HTML 或 java 脚本中隐藏数据。用户可以使用开发工具查看您的代码。

如果你想教你的学生有关网络安全的知识，我会开始研究 PHP、asp.net、jsp 和 ruby​​ 语言 HTML 几乎没有威胁，因为它的作用是格式化和显示信息。处理和数据检索由更高级的后端语言完成。

我不想指出这一点，但 HTML 不是一种编程语言。它只是标记。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T10:15:57.783

HTML 不是一种编程语言。几乎没有什么可以保证的。您已经用“不要加载不受信任的资源”涵盖了所有内容。

# google-app-engine - 什么算作“渠道开放”？

> ID：10161116
> 
> 赞同：0
> 
> 时间：2012-04-15T10:12:27.507
> 
> 标签：google-app-engine, channel-api

在[计费](https://developers.google.com/appengine/docs/billing)页面上，我看到“打开”一个频道需要 0.00001 美元。但这意味着什么？这是创建令牌的成本，还是在客户端使用它来打开套接字的成本？

如果是在客户端打开套接字的成本，这是否意味着创建令牌是免费的？

如果用户刷新页面呢？这会算作另一个开口，并再次收费吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T16:29:30.997

问题是，创建令牌而不是在客户端使用它有什么意义？

“用户刷新页面”的一般解决方案是将新创建的令牌存储在 Memcache、Datastore 或用户会话等某处，并使用它而不是每次同一用户刷新页面时创建新令牌。

请注意，令牌的有效期最长为 2 小时，因此您需要每 2 小时创建另一个令牌（假设您的用户每天 24 小时刷新页面）。

# ruby - Datamapper 在续集中的 first_or_create 等价物？

> ID：10161119
> 
> 赞同：1
> 
> 时间：2012-04-15T10:12:50.860
> 
> 标签：ruby, datamapper, sequel

是否有实现 Datamapper`first_or_create`方法的原生 Sequel 方式？

还是我必须结合选择和插入？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T12:08:44.913

我认为[find_or_create](http://rubydoc.info/gems/sequel/Sequel/Model/ClassMethods#find_or_create-instance_method)应该适合你。

> 与 find 类似，但在记录不存在时使用给定条件调用 create。与 find 不同的是，此方法中使用的块不传递给 find，而是仅在 find 不返回对象时传递给 create。

# ios - 使用 Core Animation 的循环、可逆动画

> ID：10161120
> 
> 赞同：6
> 
> 时间：2012-04-15T10:12:52.733
> 
> 标签：ios, cocoa-touch, ios5, core-animation, cabasicanimation

在我的 iOS 5 应用程序中，我有一个`UIButton`以红色球体为图像的自定义项。点击按钮时，我希望球体开始在红色和绿色之间跳动/褪色。我有红色和绿色图像，并且可以使用以下代码在两者之间成功交叉溶解：

```
CABasicAnimation *imageSwitchAnimation = [CABasicAnimation animationWithKeyPath:@"contents"];       
imageSwitchAnimation.fromValue = (id)[UIImage imageNamed:@"red.png"].CGImage;
imageSwitchAnimation.toValue = (id)[UIImage imageNamed:@"green.png"].CGImage;
imageSwitchAnimation.duration = 1.5f;        
[self.button.imageView.layer addAnimation:imageSwitchAnimation forKey:@"animateContents"]; 
```

但是，我希望动画永远继续下去（好吧，直到我告诉它停止），也希望动画能够反转和循环。换句话说，淡出红色 -> 绿色 -> 红色，然后重复。

我尝试将上面的动画块放入一个无限循环中（连同一些逻辑来确定褪色是应该从红色 -> 绿色还是绿色 -> 红色），但这只会锁定整个应用程序。

其他解决方案似乎使用 Cocos2d，它似乎相当重量级，因为这是我在应用程序中唯一需要的动画（所以我不想使用这样的框架，除非绝对需要）。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-15T10:53:32.953

是的，您可以在`CABasicAnimation`. 诀窍是它的许多最重要的方法不在[CABasicAnimation 类参考](https://developer.apple.com/library/mac/#documentation/GraphicsImaging/Reference/CABasicAnimation_class/Introduction/Introduction.html)中，甚至不在它的超类中。CABasicAnimation 实现了一个名为`CAMediaTiming`. 请参阅[CAMediaTiming 协议参考](https://developer.apple.com/library/mac/#documentation/GraphicsImaging/Reference/CAMediaTiming_protocol/Introduction/Introduction.html#//apple_ref/occ/intf/CAMediaTiming)。

您想特别了解两个属性：`autoreverses`和`repeatCount`。两者都是不言自明的，但是如果您想要无限重复怎么办？从条目中`repeatCount`：

> 可能是分数。如果repeatCount 为0，则忽略它。默认为 0。如果同时指定了 repeatDuration 和 repeatCount，则行为未定义。
> 
> 将此属性设置为 HUGE_VALF 将导致动画永远重复。

你能从那里解决吗？

# ios - 如何为 iPhone 应用程序添加背景声音

> ID：10161126
> 
> 赞同：1
> 
> 时间：2012-04-15T10:14:18.760
> 
> 标签：ios

我需要在我的应用程序中添加背景声音。我可以在哪里添加它以及如何添加？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T10:27:39.580

干得好：

将声音添加到 xcode 中的资源文件夹中，然后将此代码添加到您想要播放声音的任何位置的代码中。（以按钮单击方法为例）

```
NSString *path = [[NSBundle mainBundle]pathForResource:@"NameOfSoundfile" ofType:@"mp3"];
AVAudioPlayer *audioPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:[NSURL fileURLWithPath:path] error:NULL];
[audioPlayer play]; 
```

# iphone - 如何从凹凸中获取多个块的 NSKeyedUnarchiver？

> ID：10161128
> 
> 赞同：0
> 
> 时间：2012-04-15T10:14:26.703
> 
> 标签：iphone, ios, xcode, nskeyedarchiver

遇到这个问题我想通过bump发送图像，但是bump api的最大块是256kb

```
 if([[NSKeyedArchiver archivedDataWithRootObject:self.selectedImg]length] > 262144)
    {
        int dlen = [[NSKeyedArchiver
                     archivedDataWithRootObject:self.selectedImg] length];
        NSLog(@"Sending data: %i bytes in %d chunks",dlen,
              (int)ceil(((float)dlen / 262144.0f)));
        for (int i=1; i <= (int)ceil(((float)dlen / 262144.0f)); i++) {
            int maxr=0;
            if ((262144*i) > dlen) {
                maxr = dlen-(262144*(i-1));
            } else {
                maxr = 262144;
            }

            NSData *moveChunk = [[NSKeyedArchiver
                                  archivedDataWithRootObject:self.selectedImg]
                                 subdataWithRange:NSMakeRange(262144*(i-1),maxr)];
            NSLog(@"Sending Chunk: %d, %d bytes",i,[moveChunk length]);
            [bumpObject sendData:moveChunk];
        }
    }
    else
    {
        //Data is 254kb or under
        NSData *moveChunk = [NSKeyedArchiver
                             archivedDataWithRootObject:self.selectedImg];
        [bumpObject sendData:moveChunk];
    } 
```

我如何将所有块编译在一起？

花了3个小时，但无法解决。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T10:44:43.823

好的，我实际上还没有尝试过，但是这里有。

在接收端，获取接收到的 NSData 对象，并将它们合并为 NSMutableData 的实例，使用`-[NSMutableData appendData:]`or `-[NSMutableData appendBytes:length:]`。`-[NSData bytes]`（从和获取字节`-[NSData length]`

然后，使用`+[NSKeyedUnarchiver unarchiveObjectWithData:]`.

...像这样（设置了一个 NSMutableData 属性，假设为`receivedImageData`）...

```
- (void) bumpDataReceived:(NSData *)chunk {
    if (!self.receivedImageData) {
        self.receivedImageData = [NSMutableData dataWithCapacity:[chunk length]];
        [self.receivedImageData setData:chunk];
    } else {
        [self.receivedImageData appendData:chunk];
    }
} 
```

...然后，当您获得最后一个块（它的大小不等于 262144？在`-bumpSessionEnded:`？）时，将图像对象返回

```
UIImage* receivedImage = [NSKeyedUnarchiver unarchiveObjectWithData:self.receivedImageData]; 
```

完毕！

# entity-framework - c#中实体之间的关系，有必要吗？

> ID：10161129
> 
> 赞同：0
> 
> 时间：2012-04-15T10:14:31.850
> 
> 标签：entity-framework, oop, entity-relationship, object-oriented-database

关于主题，一些实体具有多重关系

我在学习中学到了所有这些，但是，是否有必要在 c# 编程中进行维护，例如在本示例中使用实体框架？：

[http://www.asp.net/web-forms/tutorials/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-1](http://www.asp.net/web-forms/tutorials/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-1)

这是因为我对实体更新的工作原理感到困惑，例如级联以及为什么它很重要。

我发现将实体彼此独立编码更容易，尽管它们在现实生活中实际上是相关的，例如类别产品。

谁能在问题中简要说明 CRUD 如何处理这种关系？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T10:23:41.957

实体框架及其实体及其相互之间的关联为您提供了框架本身 - OR - 映射器 - 为您处理所有更新、删除和插入的优势。它负责维护实体和实体本身之间的关系。您“只”需要定义模型。

您总是可以走手动路线并自己编写所有代码。但在大多数情况下，定义实体及其属性和它们之间的关系并让实体框架或任何其他 OR-Mapper（如 nHibernater）处理所有这些，在开发速度、可维护性和一致性方面是一个巨大的优势。

如果您定义彼此分开的实体 - 换句话说，您不使用它们之间的关联 - 您无法从一个对象导航到另一个对象。请参阅示例：

**示例 a) 定义了关联：**

2 个实体：order 和 orderitem 一个订单最多可以有 n 个订单项目。您可以从特定订单遍历/导航到所有关联的订单项目，例如

```
var myOrder = Repository.FindOrderById(15);
var orderItems = myorder.OrderItems; 
```

**示例 b) 未定义关联：**

2 个实体：order 和 orderitem 没有定义关联，您不能从一个实体导航到另一个实体。您需要分别查询所有订单项目，例如

```
var myOrder = Respository.FindOrderById(15);
var orderItems = Repository.FindOrderItemsByOrder(15); 
```

这并不是说实体是如何加载的。在示例 b 中，为了查询订单和相关的订单项目，OR-Mapper 对数据库执行 2 次查询。在示例 a 中，您可以定义是在 2 个查询中*延迟加载*实体还是在 1 个查询中*急切加载*。定义了关联后，您可以选择是否加载相关实体*eagerly*或*lazy*。

一般来说，这是实体框架的一个很好的起点：http: [//msdn.microsoft.com/en-us/library/bb386876.aspx](http://msdn.microsoft.com/en-us/library/bb386876.aspx)

这是一个很好的概述实体之间的关系如何工作以及您有哪些选项：http: [//msdn.microsoft.com/en-us/library/ee373856.aspx](http://msdn.microsoft.com/en-us/library/ee373856.aspx)

# linux - 如何读取动态变化的文件

> ID：10161136
> 
> 赞同：2
> 
> 时间：2012-04-15T10:15:04.547
> 
> 标签：linux, bash

我正在尝试读取一个不断变化的日志文件（即文本文件）并对该文件中的某些文本生成警报。我想通过 bash 脚本来做到这一点，但我很困惑，一旦一些文本进入该日志文件，我将如何调用我的程序。

换句话说，我怎样才能一直检查该文件，以便每当某些特定文本进入该文件时，我都会收到有关该文本的警报。任何函数调用？或者是其他东西？请指教。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-15T10:27:44.570

也许这可以让你开始。试试这个 test.sh 脚本：

```
#/bin/sh

while read line
do
 echo `date` " $line"
done 
```

现在尝试像这样调用它（qwe 是一个带有一些行的简单文本文件）：

```
./test.sh < qwe 
```

它将从 qwe 读取行并打印它们直到 EOF。

现在像这样调用它：

```
tail -f qwe | ./test.sh 
```

现在它将读取这些行，但它不会在 EOF 处停止，而是等待下一行。

如果您在单独的终端中执行此操作：

```
`echo "hi" >> qwe` 
```

你看..

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-15T10:29:17.320

我想我会这样做的方式是：

首先，我将创建一个 bash 脚本和一个文本文件，bash 脚本将首先将该日志文件的行数存储在文本文件中，然后添加该脚本的 cron。

该脚本将计算该文件的行数并将其与存储在文本文件中的行数进行比较

你可以使用命令来做到这一点

```
wc -l filename 
```

如果行数较大，则日志已更新，我将计算当前行数减去存储在文本字段中的数字，由此我将知道自上次检查以来添加了多少行，然后使用它获取这些行的命令

```
tail -n $number_of_lines filename 
```

如果其中一行符合您的条件，我将遍历输出并执行所需的操作，然后更新包含行数的文本文件，我会为您编写 bash 脚本，但我想您明白了

编辑：您可以执行此脚本（只需编写搜索匹配项等的代码）

```
#!/bin/bash

NUMBER=`/bin/cat ./numberoflines`
LINES=`/usr/bin/wc -l < /var/log/messages`

DIFFERENCE=$(($LINES-$NUMBER))

if [ $DIFFERENCE != 0 ]; then
tail -n $DIFFERENCE /var/log/messages |while read line
do
if $( echo $line | grep --quiet 'New USB device found' )
then
        # Email text/message
        EMAIL='youremail@gmail.com'
        SUBJECT="New USB device found"
        EMAILMESSAGE="/tmp/emailmessage.txt"
        echo "New USB device found etc ..." > $EMAILMESSAGE
        /bin/mail -s "$SUBJECT" "$EMAIL" < $EMAILMESSAGE
fi
done
echo "$LINES" > ./numberoflines
fi 
```

即使您无法向 crons 添加任何内容，您仍然可以执行此脚本，查看您想要匹配的内容并检查并执行您需要的代码

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-15T06:54:59.657

```
watch -n 0.1 cat /proc/uptime 
```

其中 n 是以秒为单位的间隔时间。

`man watch` 了解更多信息。

# c++ - 如何在 C++ 中获取 typeof 变量

> ID：10161141
> 
> 赞同：0
> 
> 时间：2012-04-15T10:15:44.907
> 
> 标签：c++, typeof

我需要知道一个内置函数或者无论如何要在 C++ 中获取变量的类型

我想在泛型方法中检查变量的类型。

例如

```
template<class Numbers> bool Matrix(Numbers matrix[] ,int matrixsize)
{
 if (/* type of matrix is int */)
   return false;
 else
   return true;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T10:26:59.287

执行您在评论中所说的更好的方法是使用模板专业化：

```
template<class Numbers>
bool Matrix(Numbers matrix[] ,int matrixsize) {
  return true;
}

template<> // full specialziation on int
bool Matrix(int matrix[] ,int matrixsize) {
  return false;
} 
```

*这将在编译时*分支使用哪个模板：第一个（通用）或第二个（专用）。如果需要，您也可以拥有多个专业

如果您想根据*动态*类型进行分支（例如，指向基类的指针是否实际上指向其派生类之一的基类），您应该能够`dynamic_cast<>`在大多数情况下使用：

```
class Base {
  public: virtual ~Base();
};
class Derived : public Base {
  public: void mySpecialMethod();
};
void f(Base* b) {
  Derived* d = dynamic_cast<Derived*> (b);
  if (d != NULL) {
    // *b's actual type is (derivative of) Derived
    d->mySpecialMethod();
  }
} 
```

请注意，最好的方法是进行适当的继承：

```
class Base {
  public:
    virtual Base();
    virtual void myMethod();
};
class Derived : public Base {
  public: void myMethod();
};
void f(Base* b) {
  b->myMethod();
} 
```

如果`*b`的实际类型是`Derived`，则调用 Derived::myMethod() ；如果`*b`的实际类型是`Base`，则调用 Base::myMethod()；`myMethod`等等如果调用一个对象没有意义`Base`（但对它的所有派生类都有效），你可以通过`=0`在`Base`. 或者只是定义一个空主体（如果它需要返回一个值可能效果不佳）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T10:20:20.860

### 新答案

就我的解密技巧而言，评论使问题更加清晰。你想要的是模板专业化。

```
template<class Numbers>
bool Matrix(Numbers matrix[] ,int matrixsize) {
  return true;
}

template<>
bool Matrix(int matrix[] ,int matrixsize) {
  return false;
} 
```

* * *

### 旧答案

如果您想在编译时执行此操作，在 C++11 中您可以使用它`decltype`来获取任何表达式的类型：

```
int my_variable;
decltype(my_variable) other_variable; // has type int 
```

我不知道在 C++03 中有任何方法可以（轻松地）做到这一点。

* * *

如果您想在运行时获取对象的类型（有时这在处理多态性时很有用），您可以使用`typeid()`运算符 and [`std::type_info`](http://en.cppreference.com/w/cpp/types/type_info)。

```
#include <type_info>
// ...

void foo(some_virtual_class& base) {
  const std::type_info& info = typeid(base);
  // Do something with the type info.
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-15T10:35:52.383

在 C++ 中，类型的操作属于“元编程”的总称，您描述的函数将是“元函数”。

新标准定义了各种元函数，包括一种去除数组边界的元函数和一种检查类型等价的元函数。

此表达式的计算结果为常量`true`：

```
std::is_same< typename std::remove_extent< int[] >::type, int >::value 
```

使用 C++11，您可以将其与`#include <type_traits>`. 使用较旧的编译器，您可能可以通过`#include <tr1/type_traits>`or访问它`#include <type_traits>`，然后使用`std::tr1::is_same`and `std::tr1::remove_extent`。

如果你想封装表达式而不是每次都写出来（因为它相当难看），定义你自己的元函数很简单：

```
template< typename T >
struct array_is_int {
    enum { value =
        std::is_same< typename std::remove_extent< int[] >::type,
                         int >::value
    };
}; 
```

如果稍后您也想返回`true`，`unsigned int`只需修改表达式：

```
template< typename T >
struct array_is_int {
    enum { value =
        std::is_same< typename std::remove_extent< int[] >::type,
                         int >::value
        || std::is_same< typename std::remove_extent< int[] >::type,
                         unsigned int >::value
    };
}; 
```

这比处理依赖于函数重载规则的特化更容易。

# java - Android 就像 Toast in Swing

> ID：10161149
> 
> 赞同：10
> 
> 时间：2012-04-15T10:18:07.803
> 
> 标签：java, swing

我正在尝试在我的 Swing 应用程序中开发类似 Toast (Android) 的功能。作为一个独立的，它完美地工作。但是当集成到应用程序中时，它会带来问题。

类文件是：

```
import java.awt.*;
import java.awt.event.ComponentAdapter;
import java.awt.event.ComponentEvent;
import java.awt.geom.RoundRectangle2D;
import javax.swing.ImageIcon;
import javax.swing.JDialog;
import javax.swing.JLabel;
import net.mindcrew.utils.LayoutHelper.Packer;

public class Toast extends JDialog {

    String text;

    public Toast(String text) {
        this.text = text;
        initComponents();
    }

    private void initComponents(){
        setLayout(new GridBagLayout());
        addComponentListener(new ComponentAdapter() {
            // Give the window an rounded rect shape. LOOKS GOOD
            // If the window is resized, the shape is recalculated here.
            @Override
            public void componentResized(ComponentEvent e) {
                setShape(new RoundRectangle2D.Double(0,0,getWidth(),getHeight(),50,50));
            }
        });

        setUndecorated(true);
        setSize(300,100);
        setLocationRelativeTo(null);
        getContentPane().setBackground(Color.BLACK);

        // Determine what the GraphicsDevice can support.
        GraphicsEnvironment ge = 
            GraphicsEnvironment.getLocalGraphicsEnvironment();
        GraphicsDevice gd = ge.getDefaultScreenDevice();
        final boolean isTranslucencySupported = 
            gd.isWindowTranslucencySupported(GraphicsDevice.WindowTranslucency.TRANSLUCENT);

        //If shaped windows aren't supported, exit.
        if (!gd.isWindowTranslucencySupported(GraphicsDevice.WindowTranslucency.PERPIXEL_TRANSPARENT)) {
            System.err.println("Shaped windows are not supported");
        }

        //If translucent windows aren't supported, 
        //create an opaque window.
        if (!isTranslucencySupported) {
            System.out.println(
                "Translucency is not supported, creating an opaque window");
        }

        // Set the window to 70% translucency, if supported.
        if (isTranslucencySupported) {
            setOpacity(0.9f);
        }

        ImageIcon loading = new ImageIcon(Toast.class.getResource("/net/mindcrew/utils/userinterface/resources/loading-photo.gif"));

        JLabel label = new JLabel(text);
        label.setForeground(Color.WHITE);
        label.setIcon(loading);
        Packer packer = new Packer(this);
        packer.pack(label).fillboth().west().inset(0, 50, 0, 20);
    }

    public static Toast showDailog(String textToDisplay){
        final Toast toast = new Toast(textToDisplay);
        // Display the window.
        Thread thread = new Thread(new Runnable() {
            @Override
            public void run() {
                toast.setVisible(true);
            }
        });
        thread.start();
        return toast;
    }

    @Override
    public void hide(){
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                setVisible(false);
                dispose();
            }
        });
    }

    public static void main(String... args){
        Toast toast = Toast.showDailog("Display");
        try{
            Thread.sleep(5000);
        }
        catch (Exception e){}
        toast.hide();
    }

} 
```

可能存在一些实现错误，但这是基本的事情。

这很好用。但是，当我试图以资源密集型操作的方式进行操作时，它会跳闸。由于 GIF 动画没有出现，我认为这意味着它有点停滞不前。

用途是：

```
 Toast toast = Toast.showDailog("Generating PDF");

//resource intensive operation. Takes about 3-5seconds to execute

    toast.hide(); 
```

更让我痛苦的是，即使在“Toast”被处理之后，应用程序也变得非常缓慢。我很确定减速不是因为有问题的操作，因为如果我取消“吐司”，它可以完美地工作。

有人可以指出这里有什么问题吗？？？

我经历了[这个问题](https://stackoverflow.com/questions/2668790/equivalent-to-androids-toast-or-mac-osx-growl-in-java-swing)。但是那里的事情比我要找的要复杂得多。我正在寻找的是一个简单的对话框。不是需要容纳多个组件的完整框架。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-11-21T12:54:08.033

试试这个代码吐司：

```
public class Test extends JFrame {

    private JPanel contentPane;

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {
            public void run() {
                try {
                    Test frame = new Test();
                    frame.setVisible(true);
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        });
    }

    public Test() {
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setBounds(100, 100, 450, 300);
        contentPane = new JPanel();
        contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
        contentPane.setLayout(new BorderLayout(0, 0));
        setContentPane(contentPane);

        JButton btnTestToast = new JButton("Test Toast");
        btnTestToast.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                ToastMessage toastMessage = new ToastMessage("Sample text to toast ",3000);
                toastMessage.setVisible(true);
            }
        });
        contentPane.add(btnTestToast, BorderLayout.SOUTH);
    }

}

public class ToastMessage extends JDialog {
    int miliseconds;
    public ToastMessage(String toastString, int time) {
        this.miliseconds = time;
        setUndecorated(true);
        getContentPane().setLayout(new BorderLayout(0, 0));

        JPanel panel = new JPanel();
        panel.setBackground(Color.GRAY);
        panel.setBorder(new LineBorder(Color.LIGHT_GRAY, 2));
        getContentPane().add(panel, BorderLayout.CENTER);

        JLabel toastLabel = new JLabel("");
        toastLabel.setText(toastString);
        toastLabel.setFont(new Font("Dialog", Font.BOLD, 12));
        toastLabel.setForeground(Color.WHITE);

        setBounds(100, 100, toastLabel.getPreferredSize().width+20, 31);

        setAlwaysOnTop(true);
        Dimension dim = Toolkit.getDefaultToolkit().getScreenSize();
        int y = dim.height/2-getSize().height/2;
        int half = y/2;
        setLocation(dim.width/2-getSize().width/2, y+half);
        panel.add(toastLabel);
        setVisible(false);

        new Thread(){
            public void run() {
                try {
                    Thread.sleep(miliseconds);
                    dispose();
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        }.start();
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-09-28T07:23:35.753

您可以使用圆形自处置 JFrame 作为相对于您的应用程序窗口定位的覆盖。通过淡入淡出，它看起来像一个 Android Toast。这是代码：

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.geom.RoundRectangle2D;

class Toast extends JFrame {

    private final float MAX_OPACITY = 0.8f;
    private final float OPACITY_INCREMENT = 0.05f;
    private final int FADE_REFRESH_RATE = 20;

    private final int WINDOW_RADIUS = 15;
    private final int CHARACTER_LENGTH_MULTIPLIER = 9;
    private final int DISTANCE_FROM_PARENT_BOTTOM = 100;

    public Toast(JFrame owner, String toastText) {
        setTitle("Transparent JFrame Demo");
        setLayout(new GridBagLayout());

        setDefaultCloseOperation(EXIT_ON_CLOSE);
        setUndecorated(true);
        setFocusableWindowState(false);

        setOpacity(0.4f);

        // setup the toast lable
        JLabel b1 = new JLabel(toastText);
        b1.setForeground(Color.WHITE);
        b1.setOpaque(false);
        add(b1);

        setSize(toastText.length() * CHARACTER_LENGTH_MULTIPLIER, 50);

        int x = (int) (owner.getLocation().getX() + (owner.getWidth() / 2));
        int y = (int) (owner.getLocation().getY() + owner.getHeight() - DISTANCE_FROM_PARENT_BOTTOM);
        setLocation(new Point(x, y));

        // configure frame
        setShape(new RoundRectangle2D.Double(0, 0, getWidth(), getHeight(), WINDOW_RADIUS, WINDOW_RADIUS));
        getContentPane().setBackground(new Color(0, 0, 0, 170));

    }

    public void fadeIn() {
        setOpacity(0);
        setVisible(true);

        final Timer timer = new Timer(FADE_REFRESH_RATE, null);
        timer.setRepeats(true);
        timer.addActionListener(new ActionListener() {
            private float opacity = 0;

            @Override
            public void actionPerformed(ActionEvent e) {
                opacity += OPACITY_INCREMENT;
                setOpacity(Math.min(opacity, MAX_OPACITY));
                if (opacity >= MAX_OPACITY) {
                    timer.stop();
                }
            }
        });

        timer.start();
    }

    public void fadeOut() {
        final Timer timer = new Timer(FADE_REFRESH_RATE, null);
        timer.setRepeats(true);
        timer.addActionListener(new ActionListener() {
            private float opacity = MAX_OPACITY;

            @Override
            public void actionPerformed(ActionEvent e) {
                opacity -= OPACITY_INCREMENT;
                setOpacity(Math.max(opacity, 0));
                if (opacity <= 0) {
                    timer.stop();
                    setVisible(false);
                    dispose();
                }
            }
        });

        setOpacity(MAX_OPACITY);
        timer.start();
    }

    public static void makeToast(final JFrame owner, final String toastText, final int durationSec) {

        new Thread(new Runnable() {
            @Override
            public void run() {
                try {
                    Toast toastFrame = new Toast(owner, toastText);
                    toastFrame.fadeIn();
                    Thread.sleep(durationSec * 1000);
                    toastFrame.fadeOut();
                } catch (Exception ex) {
                    ex.printStackTrace();
                }
            }
        }).start();

    }

    public static void main(String args[]) {
        final JFrame frame = new JFrame("Cloud Tester");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JPanel jPanel = new JPanel();
        jPanel.setLayout(new FlowLayout(FlowLayout.LEFT));
        JButton toastButton = new JButton("show toast");
        jPanel.add(toastButton);

        toastButton.addActionListener(new AbstractAction() {
            @Override
            public void actionPerformed(ActionEvent e) {
                Toast.makeToast(frame, "a toast!", 3);
            }
        });

        frame.add(jPanel);
        frame.setSize(800, 600);
        frame.setVisible(true);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-12T18:51:13.380

我实现它与工具提示类似。它已经过测试并且可以正常工作。

```
import java.awt.Color;
import java.awt.Label;
import java.awt.Point;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JComponent;
import javax.swing.Popup;
import javax.swing.PopupFactory;

public class Toast {

    private final JComponent component;
    private Point   location;
    private final String  message;
    private long duration; //in millisecond

    public Toast(JComponent comp, Point toastLocation, String msg, long forDuration) {
        this.component = comp;
        this.location = toastLocation;
        this.message = msg;
        this.duration = forDuration;

        if(this.component != null)
        {

            if(this.location == null)
            {
                this.location = component.getLocationOnScreen();
            }

            new Thread(new Runnable()
            {
                @Override
                public void run() 
                {
                    Popup view = null;
                    try 
                    {
                        Label tip = new Label(message);
                        tip.setForeground(Color.red);
                        tip.setBackground(Color.white);
                        view = PopupFactory.getSharedInstance().getPopup(component, tip , location.x + 30, location.y + component.getHeight() + 5);
                        view.show();
                        Thread.sleep(duration);
                    } catch (InterruptedException ex) 
                    {
                        Logger.getLogger(Toast.class.getName()).log(Level.SEVERE, null, ex);
                    }
                    finally
                    {
                        view.hide();
                    }
                }
            }).start();
        }
    }

    public static void showToast(JComponent component, String message)
    {
        new Toast(component, null, message, 2000/*Default 2 Sec*/);
    }

    public static void showToast(JComponent component, String message, Point location, long forDuration)
    {
        new Toast(component, location, message, forDuration);
    }
} 
```

要使用这个类，你只需要调用`showToast()`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-03-26T13:44:39.017

[![在此处输入图像描述](../Images/56496129c79b10fbf37f575ede6b950d.png)](https://i.stack.imgur.com/afJzb.jpg)

下面的类是 ToastMessage.java，应该提供一个 Android-ish toast 消息。`new ToastMessage(this, "Short message here!");`使用Note从您的项目中调用它`this`可以是调用 JFrame 中的任何组件或面板，用于确定屏幕上的位置。

```
import java.awt.Color;
import java.awt.GridBagLayout;
import java.awt.Window;
import java.awt.geom.RoundRectangle2D;

import javax.swing.*;

public class ToastMessage extends JDialog {

    private static final long serialVersionUID = 1L;
    private static Boolean spamProtect = false;
    private final int milliseconds = 1500;

    public ToastMessage(JComponent caller, String toastString) {
        if(spamProtect) {
            return;
        }
        setUndecorated(true);
        setAlwaysOnTop(true);
        setFocusableWindowState(false);
        setLayout(new GridBagLayout());

        JPanel panel = new JPanel();
        panel.setBorder(BorderFactory.createEmptyBorder(5, 10, 5, 10));
        panel.setBackground(new Color(160, 160, 160));
        JLabel toastLabel = new JLabel(toastString);
        toastLabel.setForeground(Color.WHITE);
        panel.add(toastLabel);
        add(panel);
        pack();

        Window window = SwingUtilities.getWindowAncestor(caller);
        int xcoord = window.getLocationOnScreen().x + window.getWidth() / 2 - getWidth() / 2;
        int ycoord = window.getLocationOnScreen().y + (int)((double)window.getHeight() * 0.75) - getHeight() / 2;
        setLocation(xcoord, ycoord);
        setShape(new RoundRectangle2D.Double(0, 0, getWidth(), getHeight(), 30, 30));
        setVisible(true);

        new Thread(){
            public void run() {
                try {
                    spamProtect = true;
                    Thread.sleep(milliseconds);
                    dispose();
                    spamProtect = false;
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        }.start();
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-28T23:52:14.477

`Dialog`我认为您可以通过不覆盖 hide 方法并将该方法修改为如下方式来解决您的问题`showDialog`：

```
public static void showDailog(String textToDisplay){
    final Toast toast = new Toast(textToDisplay);
    // Display the window.
    Thread thread = new Thread(new Runnable() {
        @Override
        public void run() {
            try{
                toast.setVisible(true);
                Thread.sleep(5000);
                toast.setVisible(false);
                toast.dispose();
            }
            catch(Exception ex){
                ex.printStackTrace();
            }
        }
    });
    thread.start();
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-26T11:53:59.157

我做了一些对我有用的更改，希望这会对 [使用 Java Swing 的 Toast 等 Android有所帮助](http://javaknowledge.info/?p=862)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-15T13:16:14.083

可能 JOptionPane 是您需要的吗？

# c# - 创建一个代表一系列后续任务的任务

> ID：10161150
> 
> 赞同：4
> 
> 时间：2012-04-15T10:18:11.760
> 
> 标签：c#, .net-4.0, task-parallel-library

例如，假设我正在编写一个具有以下签名的方法（C#4 所以没有异步关键字）：

```
public Task Refresh(); 
```

它将调用一个方法（也返回 a `Task`）来执行通信工作，然后运行任务继续以根据检索到的数据更新一些内部状态。例如：

```
public Task Refresh()
{
    Task<MyData> commsTask = datasource.LoadData();
    Task handleDataTask = commsTask.ContinueWith( HandleNewData );

    return ?;
} 
```

如果我返回`handleDataTask`它的完成状态正确跟踪“刷新”操作的结果，但它没有正确报告它的启动状态。

我可以将它们包装在一个`Task.Factory.StartNew`新线程中并将它们创建为子任务，但是为了链接一些任务延续而设置一个新线程似乎很浪费。

使用 TPL 确实有一种简洁有效的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T12:00:38.937

通常，`Task.Status`仅用于了解**最终状态**。无论如何，您都不能依赖任务蜂`Started`，因为该状态可能随时更改。

因此，您返回的任务在完成之前是否处于“奇怪”状态并不重要。只有三个已完成的状态 ( `Completed`, `Canceled`, `Faulted`) 很重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T10:48:23.920

我做了一些进一步的研究，发现了一个类似的 SO 问题和一些博客文章：

[没有 TaskCompletionSource 的任务链？](https://stackoverflow.com/questions/6884470/task-chaining-without-taskcompletionsource)

[http://blogs.msdn.com/b/pfxteam/archive/2010/11/21/10094564.aspx](http://blogs.msdn.com/b/pfxteam/archive/2010/11/21/10094564.aspx)

[http://msmvps.com/blogs/jon_skeet/archive/2011/05/20/eduasync-part-7-generated-code-from-a-simple-async-method.aspx](http://msmvps.com/blogs/jon_skeet/archive/2011/05/20/eduasync-part-7-generated-code-from-a-simple-async-method.aspx)

所以有一半的答案 - 您可以创建一个代表所有子任务的任务实例，而无需假脱机一个新线程并将它们附加为子任务：只需使用 TaskCompletionSource。下面的简单示例适用于我上面的问题，没有失败或取消处理：

```
public Task Refresh()
{
    var refreshTaskSource = new TaskCompletionSource<object>();

    Task<MyData> commsTask = datasource.LoadData();
    Task handleDataTask = commsTask.ContinueWith( HandleNewData );
    handleDataTask.ContinueWith( t => refreshTaskSource.SetResult(null) );

    return refreshTaskSource.Task;
} 
```

**但是**，此方法返回的任务现在直接从 转换`TaskStatus.WaitingForActivation`为`TaskStatus.RanToCompletion`（如果我处理过这些场景，则为故障/取消）。

# ruby - 在 Set 中存储浮点数？

> ID：10161152
> 
> 赞同：2
> 
> 时间：2012-04-15T10:18:37.500
> 
> 标签：ruby, floating-point, set

在 Ruby 核心库中，有一个非常有用的`Set`类。它可以存储任何类型的对象。

但如您所知，浮点数（`Float`在 Ruby 中）存在一些准确性问题。`1.2-1.0`不等于`0.2`。

```
s = Set.new()
s.add(1.2-1.0)
s.add(0.2)
s.size
=> 2 
```

是的，我可以使用`BigDecimal`type 来获取精确的数字。但是是否有可能给出`Set`一个特定的比较函数，以便它可以承受一个小错误（例如`1e-9`）？

（我知道这个问题与语言无关。欢迎使用其他常用语言的解决方案）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T14:12:44.953

有趣的问题，我想我已经找到了一个潜在的解决方案，这取决于你想要做什么。Ruby 在底层使用 a`Hash`来存储 a 的元素`Set`。在 Ruby 中，`Hash`键相等是由方法`hash`和`eql?`. 因此，如果您在`Float`(caveat emptor!) 中重新定义这些方法，您可以使`Set`考虑合理地接近`Float`s 相等：

```
class Float

  def eql?(other)
    other.is_a?(Float) && self.round(9) == other.round(9)
  end

  alias :old_hash :hash

  def hash
    self.round(9).old_hash
  end

end

s = Set.new
s.add(0.2)
s.include?(0.2)       # => true
s.include?(1.2 - 1.0) # => true
s.include?(0.2001)    # => false 
```

# sql - SQLite Exists 关键字：如何查询最高平均值？

> ID：10161153
> 
> 赞同：4
> 
> 时间：2012-04-15T10:18:42.477
> 
> 标签：sql, sqlite, average, exists, highest

在具有“mID”和“stars”两列的 SQLite 数据库表中，我必须返回“mID”的平均值最高的“stars”。

拥有以下数据：

```
 评级
mID  星
101 2
101 4
106 4
103 2
108 4
108 2
101 3
103 3
104 2
108 4
107 3
106 5
107 5
104 3

```

我会首先通过按“mID”对每个“mID”进行分组来平均“星”，例如

```
select mID, avg(stars) theAvg
from Rating
group by mID; 
```

结果，我会得到每个“mID”的平均“星”值表。

```
mID  平均（星）
101 3.0
103 2.5
104 2.5
106 4.5
107 4.0
108 3.33333333333

```

如果我只返回'stars'的最高平均值，
那么我可以只取select max(theAvg)之类的东西，然后是我刚刚计算的东西。
但是，为了获得与其“mID”相关的最高平均“星星”，我需要其他东西。

因此，我使用了“不存在”关键字，后跟一个子查询，该子查询生成另一个“mID”和“stars”表。此子查询与原始表进行比较，以验证对于原始表 R1 中的某些平均“星”值，不存在大于 R1 的平均“星”值的新表 R2 的平均“星”值

```
select mID, theAvg
from (select mID, avg(stars) theAvg
from Rating
group by mID) as R1
where not exists(select * from 
(select mID, avg(stars) theAvg
from Rating
group by mID) as R2
where R2.theAvg > R1.theAvg); 
```

我认为作为这个查询的结果，我会得到最高的平均星数，它是 mID，但我得到的是两个元组 ('mID':106, 'theAvg':4.5) 和 ('mID':107, ' theAvg':4.0)，当期望的答案只有一个元组 ('mID':106, 'theAvg':4.5)，因为我们正在寻找所有“stars”平均值的最高平均值。

```
我的查询结果（错误）：
mID   theAvg
106 4.5
107 4.0

期望的结果：
mID   theAvg
106 4.5

```

你认为我做错了什么步骤？有什么建议你会怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-21T00:38:26.277

抱歉，我对 SQL 和 SO 有点陌生，但我找到了一个解决方案，该解决方案适用于最高 avg(stars) 的平局（或者更具体地说是未知数量的平局，在这种情况下你不能轻易设置有序输出的限制）。就像我说的，我有点笨，所以有点乱：

```
select title, avg(stars)
from movie join rating using(mID)
where mID not in (select R1.mID  
from (select avg(stars) theAvg, mID, ratingDate from Rating group by mID) 
as R1
join (select avg(stars) theAvg, mID, ratingDate from Rating group by mID)
as R2 
where R1.theAvg < R2.theAvg)
group by mID; 
```

子查询返回平均星级低于任何其他电影的平均星级的任何电影的 mID，主查询的 where 语句采用子查询未返回的任何 mID。逻辑与您最初的逻辑非常相似。

至于二元组问题：我真的不明白你哪里出错了，但如果我弄明白了我会告诉你的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T14:09:28.230

`order by desc`平均而言，您可以添加一个`limit`子句，如下所示：

```
select mID, avg(stars) theAvg
from Rating
group by mID
order by theAvg desc limit 1; 
```

应该给你这个：

```
sqlite> create table Rating (mID INT, stars INT);
sqlite> 
sqlite> insert into Rating values (101, 2);
sqlite> insert into Rating values (101, 4);
sqlite> insert into Rating values (106, 4);
sqlite> insert into Rating values (103, 2);
sqlite> insert into Rating values (108, 4);
sqlite> insert into Rating values (108, 2);
sqlite> insert into Rating values (101, 3);
sqlite> insert into Rating values (103, 3);
sqlite> insert into Rating values (104, 2);
sqlite> insert into Rating values (108, 4);
sqlite> insert into Rating values (107, 3);
sqlite> insert into Rating values (106, 5);
sqlite> insert into Rating values (107, 5);
sqlite> insert into Rating values (104, 3);
sqlite> 
sqlite> select mID, avg(stars) theAvg
   ...> from Rating
   ...> group by mID
   ...> order by theAvg DESC LIMIT 1;
106|4.5 
```

以这种方式记录文档：[http ://www.sqlite.org/lang_select.html#orderby](http://www.sqlite.org/lang_select.html#orderby)

# c# - Application.Run 后的 Application.Exit 不起作用

> ID：10161154
> 
> 赞同：3
> 
> 时间：2012-04-15T10:19:24.477
> 
> 标签：c#, winforms

上下文：我正在尝试制作的应用程序最初不显示表单，而只显示一个打开的文件对话框。选择文件后，应用程序可能会退出或打开表单。

调用 Application.Run() 后，我无法关闭我的应用程序。下面的示例不会生成会自行终止的应用程序。

```
static class Program
{
    /// <summary>
    /// The main entry point for the application.
    /// </summary>
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        var context = new Context();
        Application.Run(context);
        Console.Beep();
    }
}

class Context : ApplicationContext
{
    public Context()
    {
        Application.Exit();
    }
} 
```

附带说明一下，在打开表格之前我需要做哪些准备工作？我是否需要先调用 Application.Run 才能显示表单？

非常感谢！XOXO

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T10:27:06.990

```
var context = new Context(); 
```

使用此语句，您的应用程序将执行 Application.Exit(); 之后您的语句 Application.Run 执行。这可能是原因

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T10:43:15.847

您可以尝试将退出逻辑移至新方法：

```
class Context : ApplicationContext 
{ 
  public void Exit() 
  { 
    Application.Exit(); 
  } 
} 
```

并在需要时`Application.Run`打电话`context.Exit()`

原始方法的问题在于您将退出逻辑放在 的构造函数中`Context`，这意味着每次创建`Context`对象时，您都有可能退出程序（在您发布的代码的情况下这是确定的）。而是`Context`捕获所有相关（上下文）信息，并在创建后进行显式方法调用时根据该信息决定退出。

# php - 在 Windows 上配置 Apache/PHP/mySQL .. 几乎完成

> ID：10161156
> 
> 赞同：0
> 
> 时间：2012-04-15T10:19:36.440
> 
> 标签：php, apache, mysqli

我已按照以下指南设置本地主机

[http://www.1stwebdesigner.com/tutorials/how-to-setup-local-web-server-with-latest-apache-php-and-mysql-packages/](http://www.1stwebdesigner.com/tutorials/how-to-setup-local-web-server-with-latest-apache-php-and-mysql-packages/)

我想使用 PHP 5.3.10 来使用与我的实时站点相同的版本，尽管当我使用较新的版本并导航到 localhost/pma 时，我收到以下错误：

```
The mysqli extension is missing. Please check your PHP configuration. <a href="Documentation.html#faqmysql" target="documentation"><img src="themes/dot.gif" title="Documentation" alt="Documentation" class="icon ic_b_help" /></a> 
```

任何人都知道正确配置 mySQLi 还需要做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T10:22:39.810

打开你的**php.ini**文件并确保**extension=mysqli.so**（或windows 上的**extension=mysqli.dll**）没有被注释掉。

还要确保在 php 安装的扩展文件夹中有 mysqli.so 或 mysqli.dll 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T10:49:05.440

是的，首先检查您的“服务”并确保 MySQL 运行正常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-07T15:13:30.850

查看您的防火墙设置并为 MySQL.exe 创建入站/出站规则

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-15T10:26:07.817

我记得，这是因为 mySQL 服务没有安装或运行正常

# c++ - GNU MAKE - 从我自己的 Makefile 创建 getoptpp 库或为 C++ 建议命令行选项库

> ID：10161157
> 
> 赞同：0
> 
> 时间：2012-04-15T10:19:36.973
> 
> 标签：c++, command-line, makefile, gnu

描述如何从我自己的 GNU Makefile 将“getoptpp”编译为着色库并将其静态链接到我的程序？

**我所做的：**

在我的程序目录中，我将 getoptpp 库解压缩到具有相同名称的子目录中。比向我的 Makefile 添加新目标：（自述文件说我使用 SHARED 标志来制作。$> make SHARED=n）

```
getoptpp:
     cd getoptpp; $(MAKE) SHARED=n 
```

比我将此目标添加到我的程序的请求目标列表中：

```
 myprogram: getoptpp
     g++ **** myprogram 
```

但是在调用 make myprogram 之后 - 根本没有创建新的 .so 。调用“make getoptpp”时 - 说“是最新的”

**添加：.PHONY 的建议后有一个错误 **

```
cd getoptpp; make SHARED=n
"Makefile", line 15: Missing dependency operator
"Makefile", line 19: Need an operator
"Makefile", line 24: Need an operator
"Makefile", line 45: Missing dependency operator
"Makefile", line 47: Need an operator
make: fatal errors encountered -- cannot continue
*** Error code 1 
```

[http://code.google.com/p/getoptpp/](http://code.google.com/p/getoptpp/)

或者

请为我的 c++ 程序建议非常好的命令行解析库。我可以简单地编译为链接到我的程序的 .o 对象。没有升压！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T10:23:13.180

该目录存在且未更新，所以是的，它是最新的。也许您想将其[声明为`.PHONY`](http://www.gnu.org/savannah-checkouts/gnu/make/manual/html_node/Phony-Targets.html).

# django - Django 表单 - DELETE 和 PUT http 方法

> ID：10161158
> 
> 赞同：1
> 
> 时间：2012-04-15T10:19:45.070
> 
> 标签：django, rest

我想在 Django 表单中使用中间件或类似的东西，以获得 PUT 和 DELETE HTTP 方法的支持。

**我的第一个问题是：** 最好和最简单的方法是什么？

谷歌建议我使用类似的东西：[https ://gist.github.com/1161423](https://gist.github.com/1161423)

这真的是最好的方法吗？没有其他的 ？

**我的第二个问题是**：它安全吗？（例如csrf）

# javascript - youtube视频播放完毕后如何自动退出浏览器

> ID：10161159
> 
> 赞同：0
> 
> 时间：2012-04-15T10:19:45.473
> 
> 标签：javascript, flash, firefox, youtube, bandwidth

视频播放完毕后是否可以自动退出浏览器（firefox）？通过一些扩展/脚本？

我需要这个，因为我想自动测量在 Firefox 中播放 youtube 视频时使用的带宽。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T10:33:35.187

这是 youtube 的 javascript API：

[https://developers.google.com/youtube/js_api_reference](https://developers.google.com/youtube/js_api_reference)

```
player.getPlayerState():Number
    Returns the state of the player. Possible values are unstarted (-1), ended (0), playing (1), paused (2), buffering (3), video cued (5). 
```

您可以通过javascript处理它并在完成后关闭页面。

# mysql - 使用 MySQL 查询查找活跃和不活跃的学生

> ID：10161161
> 
> 赞同：0
> 
> 时间：2012-04-15T10:20:04.077
> 
> 标签：mysql, join

我`students`在学生表中有一个列表，在表中有一个他们的课程列表，这些课程中的`students_courses`每一个都可能是活动的或非活动的。
我想知道是否有一种快速找到“活跃”用户的方法，这意味着他们至少有 1 门活跃课程（sc. `active`= 1）以及非活跃用户。非活跃用户是那些没有课程的人（没有一行）或者他们所有的课程都是`active`= 0

我还想在获取实际列表之前获取行数。
提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T10:35:40.460

这个查询可能有点慢，因为它使用子查询，但假设你有一个字段`studentId`，你可能会使用这个：

```
SELECT
   students.*,
   IF (
       studentId IN (
           SELECT
               studentId
           FROM
               students_courses
           WHERE
               active=1
   ),1,0) AS hasCourses
FROM
    students 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T10:36:37.947

```
SELECT sum(students_courses.active) as sum, student_id FROM 
    students JOIN students_courses 
    ON students.student_id =  students_courses.student_id
    GROUP BY students_courses.student_id 
```

如果 sum = 0 这意味着没有课程，大于 0 意味着有些课程

对于非活动用户，获取所有不在 student_course 中的 student_id

```
SELECT student_id FROM students WHERE student_id NOT IN 
     (SELECT DISTINCTROW student_id FROM students) 
```

# linux - 在 bash linux 中为 linux 中的多媒体文件（不是图像）编辑元数据

> ID：10161162
> 
> 赞同：7
> 
> 时间：2012-04-15T10:20:07.257
> 
> 标签：linux, bash, metadata, exif, ogg

我已经搜索过stackoverflow，我一直在谷歌和duckduckgo上，似乎没有人有一个很好的方法来做这件事。

唯一可能起作用的工具是 Exiftool，它只具有读取 ogg 文件的能力（这是我目前正在使用的）。我想通过命令行执行此操作，因为 mp3s/oggs 及其名称是元数据，但元数据是空白的。我已经知道如何在 bash 中解析文件名，但我找不到将其放回文件的方法。我可以手动做这种事情，但这几乎不值得，因为我必须手动做。

由于某些奇怪的原因，Musicbrainz picard 也没有正确标记它们，所以这就是我必须这样做的原因。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-15T12:57:29.983

`ID3`标签是特定于 MP3 的。有关 Ogg Vorbis 注释字段规范，请参阅：[字段名称](http://www.xiph.org/vorbis/doc/v-comment.html)

`vorbiscomment`(package *vorbis-tools* ) 可以修改和查询 `ogg`标签信息。
`mp3info`是使用 wirh`mp3`标签的众多工具之一。

* * *

# .ogg

```
# Clear all info
printf ''| vorbiscomment -w  test.ogg
           vorbiscomment -l  test.ogg
# modify info
echo ========
printf 'TITLE=The Last Saskatchewan Pirate
ARTIST=Captain Tractor
ALBUM=East of Edson
DATE=2000-01-01
COMMENT=Just another TEST comment
DESCRIPTION=*** Hello ***
'|vorbiscomment -w  test.ogg
  vorbiscomment -l  test.ogg
echo ======== 
```

输出 (.ogg)

```
========
TITLE=The Last Saskatchewan Pirate
ARTIST=Captain Tractor
ALBUM=East of Edson
DATE=2000-01-01
COMMENT=Just another TEST comment
DESCRIPTION=*** Hello ***
======== 
```

* * *

# mp3

```
# Delete the entire ID3 tag
mp3info -d test.mp3   
echo  ========
# modify info
mp3info -t "The Last Saskatchewan Pirate" \
        -a "Captain Tractor" \
        -l "East of Edson" \
        -g "Folk/Rock" \
        -y "2000" \
        -n "1" \
        -c "Just another TEST comment" \
        test.mp3
mp3info test.mp3
echo  ======== 
```

输出 (.mp3)

```
========
File: test.mp3
Title:   The Last Saskatchewan Pirate   Track: 
Artist:  Captain Tractor
Album:   East of Edson                  Year:  2000
Comment: Just another TEST comment      Genre: Folk/Rock [81]

======== 
```

# backbone.js - 检索添加到 Backbone.js 集合的项目的索引位置

> ID：10161164
> 
> 赞同：10
> 
> 时间：2012-04-15T10:20:13.047
> 
> 标签：backbone.js, underscore.js, backbone.js-collections

如果我将一个项目添加到集合中，我如何找到它被添加的位置？用于 add的[Underscore.js 文档](http://documentcloud.github.com/backbone/#Collection-add)建议实现此目的的唯一方法是绑定到 add 事件。

还有其他方法吗？如果没有，那么我如何从回调中获取索引？我尝试提供以下回调：

```
foo:function(model, options) {
  console.log("foo: " + options.index);
}, 
```

但 options.index 是`undefined`. 我使用以下代码绑定到事件：

```
this.collection.bind('add', this.foo); 
```

并使用此代码添加一个项目：

```
this.collection.add(myNewItem); 
```

集合中的模型是：

```
MyModel = Backbone.Model.extend({
defaults : {
   key:undefined,
   myObj:undefined,
}, 
```

该系列是：

```
MyModel List = Backbone.Collection.extend({
      model: MyModel,

initialize: function() {
   this.comparator = function(aModel) {
   return aModel.get('key'); 
  };
 }}); 
```

我将模型添加到集合中：

```
 var key = "always_the_same";
var mm = new MyModel({key:key});
this.collection.add(mm);
var index = this.collection.sortedIndex(mm , this.collection.comparator)); 
```

## 更新

问题是（我认为），比较器函数用于 indexOf 和 sortedIndexOf，因此就比较器函数而言，具有相同键的两个对象实际上是同一个对象。

我曾希望* CID 将用于确保对象实际上是我在已经排序的集合中寻找的对象。然而似乎不是。我想一种可能的解决方案是更改我的比较器函数以包含 CID：

```
initialize: function() {
        this.comparator = function(aModel) {
          return aModel.get('key') + aModel.cid; 
        };
      }, 
```

模型仍然根据它们的`key`值排序，但以下代码返回正确的索引位置：

```
this.collection.sortedIndex(myModel, this.collection.comparator); 
```

感觉 hacky :( 任何人都可以对此发表意见吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-15T14:27:51.097

如果您正在处理使用该`add`方法将模型添加到集合的简单场景，那么您只需要`indexOf`在添加后使用该模型调用该方法。

```
var myModel = new MyModel({some: "data"});

var myCollection = new MyCollection();
myCollection.add(myModel);

var index = myCollection.indexOf(myModel); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T10:42:30.453

**更新**

如果您想知道带有下划线的集合中元素的“索引”，您可以使用`indexOf`.

您能否在小提琴中添加更大的代码示例，以便我可以更好地理解您想要做什么？因为例如，如果集合中的元素不是原始类型（不是整数或字符串，而是 javascript 对象）`indexOf`可能会出现问题，因为具有相同值的不同引用的对象不会被视为相等`indexOf`。

**更新 2**

你可以尝试这样做：

```
var cids = this.collection.map(function(elem){ return elem.cid; });
var index = _(cids).indexOf(myModel.cid); 
```

# hibernate - JPA：哪些实现支持延迟加载外部事务？

> ID：10161165
> 
> 赞同：14
> 
> 时间：2012-04-15T10:20:18.693
> 
> 标签：hibernate, jpa, eclipselink, openjpa, datanucleus

EclipseLink 可以在实体中加载惰性关系，即使在创建它们的实体管理器不再可用之后也是如此。对于 Hibernate ，[这不起作用](http://softaria.com/2011/07/26/eclipselink-versus-hibernate/)，或者至少在那篇文章的时候没有。

其他供应商呢？特别是 OpenJPA 和 DataNucleus？

这有什么缺点（除了更复杂的实现）？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-16T00:40:03.553

尽管 Hibernate 确实需要相同的 EntityManager 才能延迟加载对象，但使用[Open Session in View Pattern](https://community.jboss.org/wiki/OpenSessionInView)很容易实现灵活的延迟加载。本质上，只要需要，您就可以保持 EntityManager 处于打开状态。我开发了客户端应用程序，只要应用程序处于打开状态，它们就会保持相同的 EntityManager 处于打开状态。这将为您提供与文章中描述的基本相同的行为。但是，它肯定比 Roman 描述的“开箱即用”延迟加载更难实现。

话虽如此，[延迟加载也有缺点](https://stackoverflow.com/a/1103371/836738)。开发人员必须了解他的获取策略，并且必须能够区分每种策略最适用的时间和地点。否则，您可能会遇到严重的性能问题，例如[N+1 Select Problem](https://stackoverflow.com/questions/97197/what-is-the-n1-selects-problem)。另外，在呈现视图期间，您总是有可能遇到数据库异常。

关于 OpenJPA 和 DataNucleus：虽然我从未使用过，[但这篇文章](http://vard-lokkur.blogspot.com/2010/12/jpa-lazy-loading-and-view-rendering.html)表明 OpenJPA 也需要`OpenSessionInViewFilter`延迟加载。[这个 SO 答案](https://stackoverflow.com/a/9051089/836738)和[这个论坛帖子](http://groups.google.com/group/google-appengine-java/browse_thread/thread/576930e42eaf4819)表明 DataNucleus 需要`OpenPersistenceManagerInViewFilter`延迟加载。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-11-12T11:17:25.973

请注意，Hibernate 4.1.6 添加了对通过`hibernate.enable_lazy_load_no_trans`JPA 属性在事务外部加载惰性数据的支持。

似乎没有被广泛使用/知道 - 唯一的官方文档似乎是一张[功能票](https://hibernate.atlassian.net/browse/HHH-7457)- 所以可能值得谨慎使用。

在我（有限的）经验中，它通常似乎运行良好，只是它似乎没有在双向关系的“映射”端获取实体。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-16T07:31:27.097

如果您没有 EntityManager，则您不了解数据存储、EMF 或任何东西。所以不，如果你想要便携，你就不能做延迟加载（除了你自己在你的对象中体现该信息）......即这超出了JPA规范。

[DataNucleus JPA](http://www.datanucleus.org/products/accessplatform_3_1)可以很好地执行事务之外的字段延迟加载。显然，您需要说明您是使用 TRANSACTION 还是 EXTENDED*持久性上下文*运行，因为在前一种情况下，对象在事务提交时被分离（一旦分离就不能延迟加载），而在后者中，对象仍然存在MANAGED（在这种情况下您可以延迟加载）。

# iphone - 在 UIImage（核心图形）或使用 ImageMagick 库上填充 Photoshop 效果

> ID：10161166
> 
> 赞同：0
> 
> 时间：2012-04-15T10:20:20.043
> 
> 标签：iphone, objective-c, core-graphics, imagemagick, photoshop

如何在 UIImage 或使用 ImageMagick 库上复制 Photoshop 填充效果？如果您使用 Photoshop，我的要求类似于：[填充 Photoshop 效果](http://www.thegraphicmac.com/layer-opacity-vs-layer-fill-photoshop)

# python - 转换 HTML 列表 ( ) 到制表符（即缩进）

> ID：10161168
> 
> 赞同：3
> 
> 时间：2012-04-15T10:20:45.210
> 
> 标签：python, html, regex, tabs

曾使用过数十种语言，但对 Python 不熟悉。

我在这里的第一个（也许是第二个）问题，所以要温柔......

试图有效地将类似 HTML 的 markdown 文本转换为 wiki 格式（特别是 Linux Tomboy/GNote 到 Zim 的注释）并且一直卡在转换列表上。

对于像这样的 2 级无序列表...

*   第一级
    *   第二级

Tomboy/GNote 使用类似...

`<list><list-item>First level<list><list-item>Second level</list-item></list></list-item></list>`

然而，Zim 个人 wiki 希望这是……

```
* First level
  * Second level 
```

...带有前导标签。

我探索了正则表达式模块函数 re.sub()、re.match()、re.search() 等，并发现了很酷的 Python 功能，可以将重复文本编码为...

```
 count * "text" 
```

因此，看起来应该有一种方法可以做类似的事情......

```
 newnote = re.sub("<list>", LEVEL * "\t", oldnote) 
```

其中 LEVEL 是`<list>`注释中的序数（出现）。因此`0`，对于第一个`<list>`遇到的，`1`对于第二个，等等。

`</list>`每次遇到时， LEVEL 都会递减。

`<list-item>`标签被转换为项目符号的星号（在适当的情况下以换行符开头）和`</list-item>`标签被删除。

最后……问题……

*   如何获得 LEVEL 的值并将其用作制表符乘数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T12:19:19.967

您确实应该使用 xml 解析器来执行此操作，但要回答您的问题：

```
import re

def next_tag(s, tag):
    i = -1
    while True:
        try:
            i = s.index(tag, i+1)
        except ValueError:
            return
        yield i

a = "<list><list-item>First level<list><list-item>Second level</list-item></list></list-item></list>"

a = a.replace("<list-item>", "* ")

for LEVEL, ind in enumerate(next_tag(a, "<list>")):
    a = re.sub("<list>", "\n" + LEVEL * "\t", a, 1)

a = a.replace("</list-item>", "")
a = a.replace("</list>", "")

print a 
```

这将适用于您的示例，并且**仅**适用于您的示例。使用 XML 解析器。您可以使用`xml.dom.minidom`（它包含在 Python 中（至少 2.7），无需下载任何东西）：

```
import xml.dom.minidom

def parseList(el, lvl=0):
    txt = ""
    indent = "\t" * (lvl)
    for item in el.childNodes:
        # These are the <list-item>s: They can have text and nested <list> tag
        for subitem in item.childNodes:
            if subitem.nodeType is xml.dom.minidom.Element.TEXT_NODE:
                # This is the text before the next <list> tag
                txt += "\n" + indent + "* " + subitem.nodeValue
            else:
                # This is the next list tag, its indent level is incremented
                txt += parseList(subitem, lvl=lvl+1)
    return txt

def parseXML(s):
    doc = xml.dom.minidom.parseString(s)
    return parseList(doc.firstChild)

a = "<list><list-item>First level<list><list-item>Second level</list-item><list-item>Second level 2<list><list-item>Third level</list-item></list></list-item></list></list-item></list>"
print parseXML(a) 
```

输出：

```
* First level
    * Second level
    * Second level 2
        * Third level 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T11:30:15.520

使用[Beautiful](http://www.crummy.com/software/BeautifulSoup/) soup ，它允许您在标签中迭代，即使它们是海关。做这种类型的操作非常实用

```
from BeautifulSoup import BeautifulSoup
tags = "<list><list-item>First level<list><list-item>Second level</list-item></list></list-item></list>"
soup = BeautifulSoup(tags)
print [[ item.text for item in list_tag('list-item')]  for list_tag in soup('list')]

Output : [[u'First level'], [u'Second level']] 
```

我使用了嵌套列表推导，但您可以使用嵌套 for 循环

```
for list_tag in soup('list'):
     for item in list_tag('list-item'):
         print item.text 
```

我希望这对你有帮助。

在我的示例中，我使用了 BeautifulSoup 3，但该示例应该与 BeautifulSoup4 一起使用，但只有导入更改。

```
from bs4 import BeautifulSoup 
```

# java - android javabinder失败的活页夹事务

> ID：10161174
> 
> 赞同：0
> 
> 时间：2012-04-15T10:21:48.343
> 
> 标签：java, android

试图获得我的第一个 android 小部件，让我告诉你从 Visual Studio Pro 迁移到 eclipse**并不是一件顺利的事情**！无论如何，我遇到了上述错误，这给我解决了一些麻烦。我搜索了所有可能的重复项，似乎当应用程序达到 IPC 大小（即大图像）时会发生此错误

我的小部件启动了一个意图服务来从网络上下载一些信息和一个图像。png的原始图像大小约为100k。然而，在我更新小部件之前，我缩小到 17k 左右。（检查内存跟踪器大小为 16400bytes[]）。但更新失败。如果我删除图像，则更新成功。

这是在 widgetprovider 中执行的监听器：

```
public void onHttpLoaded(Bitmap image, String titlestring, String subtitlestring)
    {
        Context context = getApplicationContext();          

        if (image == null) //no data?
        {
            Toast.makeText(context, context.getResources().getString(R.string.null_data_toast), Toast.LENGTH_LONG);
            return;// exit!
        }

        try
        {
            RemoteViews widgetView = new RemoteViews(this.getPackageName(), R.layout.main);             
            widgetView.setTextViewText(R.id.title, titlestring);

            //all other comment out

            //The problem!
            widgetView.setImageViewBitmap(R.id.main_icon, image);

            //Get global  appwidgetmanager
            AppWidgetManager manager = AppWidgetManager.getInstance(this);

            //update widget
            manager.updateAppWidget(Constants.THIS_APPWIDGET, widgetView);
        }
        catch (Exception e)
        {
            Log.d("onHttpLoaded", e.toString());
        }

    } 
```

以及我的服务中调用上述代码的 onHandleIntent ：

```
protected void onHandleIntent(Intent intent)
    {
        resources = getApplicationContext().getResources();
        int iAppWidgetId;           
        try
        {
            iAppWidgetId = intent.getIntExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, AppWidgetManager.INVALID_APPWIDGET_ID);
        }
        catch (Exception e)
        {
            Log.d("Service", "WidgetID not found");
        }
        //comment out stuff...

        //launch new httpTask 
        httpTask myhttpTask = new httpTask(tittlestring, subtitlestring, (myHttpListener) MyUpdateService.this, MyUpdateService.this);
        //limit size of bitmap
        myhttpTask.setSampleSize(Constants.BITMAP_SAMPLE_SIZE); //size = 4
        myhttpTask.execute();

    } 
```

所有测试都在模拟器中完成。可能很重要的一个细节是，在 logcat 中，我收到 20-30 条失败消息“！！！活页夹事务失败！！！” 关于我是如何搞砸的有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-15T16:42:50.933

解决了。这是模拟器的内存问题。

# url - 带有多个正斜杠的网址，它会破坏什么吗？

> ID：10161177
> 
> 赞同：43
> 
> 时间：2012-04-15T10:22:11.137
> 
> 标签：url, browser, url-routing, server-side

```
http://example.com/something/somewhere//somehow/script.js 
```

双斜杠是否会破坏服务器端的任何内容？我有一个解析 URL 的脚本，我想知道如果我用一个斜杠替换多个斜杠，它是否会破坏任何东西（或更改路径）。特别是在服务器端，一些框架，如 CodeIgniter 和 Joomla 使用分段 url 方案和路由。我只想知道它是否会破坏任何东西。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-04-15T10:37:42.240

HTTP [RFC 2396](http://www.ietf.org/rfc/rfc2396.txt)将路径分隔符定义为*单斜杠*。

但是，除非您使用某种 URL 重写（在这种情况下，重写规则可能会受到斜杠数量的影响），否则 uri 会映射到磁盘上的路径，但在（大多数？）现代操作系统（Linux/ Unix, Windows)，一行中的多个路径分隔符没有任何特殊含义，所以 /path/to/foo 和 /path//to////foo 最终会映射到同一个文件。

可能会受到影响的另一件事是缓存。*由于您的浏览器和服务器都会缓存单个页面（根据它们的缓存设置），通过稍微*不同的 URI多次请求同一个文件可能会影响缓存（取决于服务器和客户端的实现）。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-11-18T17:46:00.793

这个问题的正确答案是*它取决于服务器的实现*！

前言：根据定义 URL 路径语法的 RFC 2396，双斜杠在语法上是有效的。正如**amn 所**解释的，它因此意味着一个空的 URI 段。但是请注意，RFC 2396 只定义了*语法*，而不是路径的语义，包括空路径段，因此由您的服务器决定空路径的*语义*。

你没有提到你正在使用的服务器软件堆栈，也许你甚至在滚动你自己的？所以请用你的想象力来想象语义可能是什么！

实际上，我想指出一些与语义相关的日常原因，这意味着您应该避免使用双斜线，即使它们在*语法上*是有效的：

1.  由于不是每个人都期望空有效，因此可能会导致错误。即使您今天的服务器技术可能与它兼容，您明天的服务器技术或您今天的服务器技术的下一个版本可能决定不再支持它。示例：当您尝试使用双斜杠指定路由模板时，ASP.NET MVC Web API 库会引发错误。

2.  一些服务器可能将 // 解释为指示根路径。这可能是故意的，也可能是错误 - 然后很可能是安全错误，即目录遍历漏洞。

3.  因为它有时是一个错误和一个安全错误，一些聪明的服务器堆栈和防火墙会看到子字符串'//'，推断你可能正在尝试*利用这样的错误*，因此他们会返回`403 Forbidden`or `400 Bad Request`etc，并拒绝实际对 URI 进行任何进一步的处理。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-04-15T10:34:44.827

URL 不必映射到文件系统路径。因此，即使文件系统路径中的 // 等同于 /，您也不能保证所有 URL 都相同。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-07-27T21:54:55.597

考虑[“RFC3986：统一资源标识符（URI）：通用语法”中相关](https://www.rfc-editor.org/rfc/rfc3986)`path-absolute` [非终结](https://en.wikipedia.org/wiki/Terminal_and_nonterminal_symbols#Nonterminal_symbols)符的声明（如典型的那样，以[ABNF](https://www.rfc-editor.org/rfc/rfc2234)语法指定）：

```
path-absolute = "/" [ segment-nz *( "/" segment ) ] 
```

然后考虑`segment`在同一个文档中再往下几行的声明：

```
segment       = *pchar 
```

如果您可以阅读 ABNF，星号 ( `*`) 指定以下元素`pchar`可以重复多次以组成 a `segment`，包括*零次*。学习这一点并重新阅读`path-absolute`上面的声明，您可以看到一个可能为空`segment`的imples，即第二个可能*无限*`"/"`重复，因此允许有效的组合，如（至少一个的任意长度）作为（其本身用于指定规则）的一部分描述一个URI）。*`//////``/``path-absolute`*

 *由于所有 URL 都是 URI，我们可以得出结论，是的，根据引用的 RFC，URL 允许使用多个连续的正斜杠。

但并不是每个人都遵循或实现每个规范的 URI 解析器，所以我相当确定存在不兼容的 URI/URL 解析器和各种堆叠在这些之上的软件，这些极端情况会破坏更大的系统。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-11-02T02:13:41.753

您可能要考虑的一件事是它*可能会*影响您在搜索引擎中的页面索引。根据[这个](https://www.deepcrawl.com/knowledge/best-practice/never-repeat-pathnames-in-urls-more-than-twice/)网页，

> 同一路径重复 3 次的 URL 将不会在 Google 中编入索引

他们使用的例子是：

```
example.com/path/path/path/ 
```

如果您使用 ，我还没有确认这也是正确的`example.com///`，但我当然想知道 SEO 优化是否对我的网站至关重要。

他们提到“这是因为 Google 认为它遇到了 URL 陷阱。” 如果其他人肯定知道答案，请对此答案添加评论；否则，我认为将这个案例包括在内以供考虑是相关的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-10-08T06:24:02.217

是的，它绝对可以破坏事物。

该规范认为`http://host/pages/foo.html`和`http://host/pages//foo.html`是不同的 URI，服务器可以自由地为它们分配不同的含义。`/pages/foo.html`但是，大多数服务器会以相同的方式处理路径`/pages//foo.html`（因为底层文件系统也是如此）。但是即使在处理这样的服务器时，额外的斜线也很容易破坏事情。考虑服务器返回相对 URI 的情况。

```
http://host/pages/foo.html  + ../images/foo.png = http://host/images/foo.png
http://host/pages//foo.html + ../images/foo.png = http://host/pages/images/foo.png 
```

让我解释一下这意味着什么。假设您的服务器返回一个包含以下内容的 HTML 文档：

```
<img src="../images/foo.png"> 
```

如果您的浏览器使用

```
http://host/pages/foo.html          # Path has 2 segments: "pages" and "foo.html" 
```

您的浏览器将尝试加载

```
http://host/images/foo.png          # ok 
```

但是，如果您的浏览器使用

```
http://host/pages//foo.html         # Path has 3 segments: "pages", "" and "foo.html" 
```

您可能会得到相同的页面（因为服务器可能无法区分`/pages//foo.html`）`/pages/foo.html`，但您的浏览器会错误地尝试加载

```
http://host/pages/images/foo.png    # XXX 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-03-08T13:07:26.900

例如，在您的应用程序中为资源构建链接时，您可能会感到惊讶。

```
<script src="mysite.com/resources/jquery//../angular/script.js"></script> 
```

**不会解决，** `mysite.com/resources/angular/script.js` **而是解决** `mysite.com/resources/jquery/angular/script.js` **您可能不想要的**

双斜线是邪恶的，尽量避免它们。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2017-03-06T01:08:44.223

你的问题是“它会破坏任何东西”。根据 URL 规范，允许使用额外的斜杠。不要阅读 RFC，这是一个快速实验，您可以尝试查看您的浏览器是否会默默地破坏 URL：

```
echo '<?= $_SERVER['REQUEST_URI'];' > tmp.php                                   
php -S localhost:4000 tmp.php 
```

我用 Safari 12.0 (14606.1.36.1.9) 和 Chrome 69.0.3497.100 测试了 macOS 10.14 (18A391)，都得到了结果：

> /你好世界

这表明使用额外的斜线对 Web 应用程序*是*可见的。

使用双斜杠时，某些用例会被破坏。这包括需要单斜杠 URL 的 URL 重定向/路由或其他直接分析 URI 的 CGI 应用程序。

但是对于提供静态内容的正常情况，例如您的示例，这仍然会获得正确的内容。但是对于使用不同斜杠访问的相同内容，客户端将获得缓存未命中。*

# android - 使用带有视图的选项卡

> ID：10161178
> 
> 赞同：1
> 
> 时间：2012-04-15T10:22:24.993
> 
> 标签：android

我在使用带有视图的选项卡时遇到了一点问题。首先，我只是复制了 Tabs 与活动一起使用的示例代码：

我的 LayoutFile 看起来像这样：

```
<?xml version="1.0" encoding="utf-8"?>
<TabHost xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@android:id/tabhost"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
    <LinearLayout
        android:orientation="vertical"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:padding="5dp">
        <TabWidget
            android:id="@android:id/tabs"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" />
        <FrameLayout
            android:id="@android:id/tabcontent"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:padding="5dp" />
    </LinearLayout>
</TabHost> 
```

这是我的 Java 代码：

```
public class MyActivity extends TabActivity{
    public void onCreate(Bundle savedInstanceState){
        super.onCreate(savedInstanceState)
        setContentView(R.layout.main);
        TabHost tH = getTabHost();

        Indent intent = new Intent().setClass(this, AnotherActivity.class);

        // Initialize a TabSpec for each tab and add it to the TabHost
        //TextView Test = new TextView(this);
        //Test.setText("test");

        tH.addTab(tH.newTabSpec("t1").setIndicator("Tab1").setContent(intent));
        tH.setCurrentTab(0);
    }
} 
```

这按预期工作。但是，当我取消注释 TextView 行并调用 setContent(Test.getId()) 而不是 setContent(intent) 时，应用程序崩溃。我还尝试在布局文件中创建一个文本视图，并调用 setContent(R.id.test)，这也会使其崩溃。

所以这是一个问题。

第二点是。我不想使用活动，因为我希望能够在这些类上调用方法，这些方法应代表 Tab 内容。所以我最初的想法是，从视图中派生一些类。1 为每个选项卡，并传递他们的 id。但因此上面的代码示例需要首先工作。

问候宇扎库

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T11:50:32.253

我知道你说你`TextView`在布局文件中尝试过，但这应该可以工作......

更改`FrameLayout`部分如下...

```
<FrameLayout
    android:id="@android:id/tabcontent"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:padding="5dp" >
    <TextView 
        android:id="@+id/test"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" 
        android:text="TEST" />
</FrameLayout> 
```

然后在您的代码中执行以下操作...

```
tH.addTab(tH.newTabSpec("t1").setIndicator("Tab1").setContent(R.id.test)); 
```

# c - fseek 出错

> ID：10161184
> 
> 赞同：0
> 
> 时间：2012-04-15T10:23:22.010
> 
> 标签：c

使用以下代码，我尝试从文件中读取 4 个字节：

```
FILE *f

uint32_t read_program(int A)
{
    long i;
    uint32_t strofprog;
    uint8_t tmp;
    i = 4*A;
    fseek(f,i,0);// set a position in file
    if((tmp = getc(f)) != EOF)
    {
        while((i%(4*A)) < 4)
        {
            fseek(f, i, SEEK_SET);
            tmp = getc(f);
            strofprog = tmp;
            strofprog <<= 8;
            i++;
        }
        return strofprog;
    }
    else
    { 
        fclose(f);
        return -1; 
    };
} 
```

但是，当我运行它时，会导致以下错误：

```
main.c: In function ‘read_program’:
main.c:77: error: incompatible type for argument 1 of ‘fseek’
/usr/include/stdio.h:722: note: expected ‘struct FILE *’ but argument is of type ‘FILE’ 
```

我做错了什么，我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T14:23:26.840

粘贴中的第 85 行：

```
fseek(*f,i,0);// set a position in file 
```

正如@unwind 所怀疑的那样。

# php - 快速创建动态可编程php-mysql博客的推荐方法？

> ID：10161189
> 
> 赞同：0
> 
> 时间：2012-04-15T10:24:22.360
> 
> 标签：php, mysql, blogs

我想创建一个类似博客的网站。一开始我需要一个简单的单人博客软件，但在未来我想拥有对代码和数据库的完全访问权限（控制帖子的组织方式，提供创建新帖子的特殊表格，允许用户注册，实施评级系统等）

什么是最好的解决方案？是否有特定的工具可以生成数据库和 php 文件，我可以访问它们，或者我应该从 zip 编码所有内容？

我知道 Wordpress 和 Joomla 是很好的博客工具，但不知道我是否能够自由地重新设计使用这些工具创建的博客。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T10:28:19.830

Wordpress 是一个开源的、灵活的、可插拔的网站基础设施；而且设置起来也很简单，无需任何代码修改。它将生成自己的数据库文件，并且能够以最少的管理开销进行自我升级。

如果您选择在以后扩展博客，您可以按照您认为合适的方式操作和自定义主题（最终用户看到的 100%）。

Wordpress 还有一个强大的插件库，可以提供扩展功能而无需任何编码。例如，已经存在一个不需要编码来实现的帖子评分插件；

*   [http://wordpress.org/extend/plugins/rate-this-page-plugin/](http://wordpress.org/extend/plugins/rate-this-page-plugin/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T10:28:37.223

只需安装 wordpress，您就可以完全访问代码和数据库，并且它支持编写插件来扩展功能。您可以使用他们的模板引擎更改页面布局。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T10:32:16.910

从头开始写博客不是一件简单的工作现在只需使用 Wordpress。有很多插件可以自定义 Wordpress 您可以稍后开发自己的插件或编写新的博客系统并迁移到它。我会在熟悉 Wordpress 时保证。你不会再离开它了！

# java - PreparedStatement 可以不考虑 WHERE 子句中的某些条件吗？

> ID：10161191
> 
> 赞同：4
> 
> 时间：2012-04-15T10:24:47.443
> 
> 标签：java, mysql, sql, prepared-statement, dao

例如，我有一个声明

`"SELECT * FROM Reports WHERE StartDate >= ? WHERE EndDate <= ? AND Performer = ?"`

但是有时网页上的某些输入字段没有填写，所以我必须不考虑这种情况。即我没有填写开始日期，所以声明必须是

`"SELECT * FROM Reports WHERE EndDate <= ? AND Performer = ?"`

有3种不同的条件。那么，我是否必须编写 8 种不同的语句和 DAO 方法才能完成任务？真的吗？也许还有其他解决方案？

**编辑：**我使用 MySQL/

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-15T10:30:02.723

更改您的 SQL 以适应空值。因为您没有告诉我们您使用的是*哪个*数据库，所以我将使用“vanilla”SQL：

```
SELECT * 
FROM Reports
WHERE (EndDate <= ? OR ? is null)
AND (Performer = ? OR ? is null) 
```

每次将参数传递两次。

另一种选择是根据参数为空来更改 SQL（例如`Performer = ?`从 where 子句中省略），但这可能需要大量代码和测试。我会使用适应性强的 SQL，如果它表现不佳，*那么*尝试更高级的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T10:37:26.480

您不需要 8 种不同的语句。您可以使用 if 语句构建查询。例如，

```
String query = "SELECT * FROM Reports where true";
if(startDate != null)
  query = query + " and startDate <= ?";
if(endDate != null)
  query = query + " and endDate <= ?";
if(performer != null)
  query = query + " and performer = ?"; 
```

希望对你有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T10:43:35.403

没有准备好的语句不能单独排除条件。构造查询以避免不必要的条件。

您可以使用以下代码生成 SQL：

```
StringBuilder whereClause = new StringBuilder();
String and = "";

if(EndDate == null || EndDate.length == 0)
{
    whereClause.append(your condition);
    and = " and";
}

if(StartDate == null || StartDate.length == 0)
{
    whereClause.append(and).append(your condition);
    and = " and";
}

if(Performer == null || Performer.length == 0)
{
    whereClause.append(and).append(your condition);
} 
```

并根据您生成的查询，您需要将参数设置为准备好的语句。

# graph - 创建包含多个调查结果的 Excel 图表

> ID：10161192
> 
> 赞同：2
> 
> 时间：2012-04-15T10:25:00.720
> 
> 标签：graph, charts, excel, pie-chart, vba

我最近做了一个调查，最多有 10 个问题。现在我需要根据这些值创建一个图表，但我被卡住了。数据如下：

```
Customer ID Q1  Q2  Q3  Q4  Q5                      Q6  Q7  Q8  Q9  Q10
1797493605  Yes Yes Yes Yes Compare totals          Yes Yes Yes Yes None of the above
1797155787  Yes Yes Yes Yes Compare prices          Yes Yes No  Yes None of the above
1797116920  Yes Yes Yes Yes Compare totals          No  No  Yes No  Catalogues
1797105343  Yes Yes Yes Yes Compare prices          Yes Yes Yes Yes None of the above
1797076252  Yes Yes Yes Yes Same places             Yes Yes Yes No  None of the above
1797015113  No  No  No  No  Everything online       No  No  No  No  None of the above
1796959310  Yes Yes Yes Yes Compare prices          Yes No  No  Yes None of the above
1796950913  Yes Yes Yes Yes Compare prices          Yes Yes Yes Yes Catalogues
1796931846  Yes Yes No  Yes Compare prices          Yes No  Yes Yes Email/SMS 
```

我尝试使用 Excel 正常功能，但它只是没有提供正确的图表。

想要得到一个条形图，每个问题都有 2 个条形 - 每个答案。X 轴代表问题，Y 轴代表回答的人数？

那么数据值是否应该是实际的 Yes, No, ？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T16:51:13.257

如果我理解正确，您不关心客户 ID。

您想要获得的是这种格式的网格，其中第 1 行是您的标题（我在这里捏造数字）：

```
|     |  A   |  B  |  C   |
===========================
|  1  |  Q   |  #Y |  #N  |
|  2  |  Q1  |  6  |  1   |
|  3  |  Q2  |  5  |  2   |
|  4  |  Q3  |  2  |  5   | 
```

为了填充单元格`B2`（其中包含 的`YES`答案# `Q1`，您可以对您的网格使用像这样的公式：

```
=SUMIF($B$2:$B$10,"YES") 
```

该`SUMIF()`公式计算网格 Q1 列中“是”响应的数量。

（我假设在您的网格中，“Q1”响应包含在 Cells `B2`thru`B10`中。）

构建该表，然后您将能够突出显示该表，单击 Excel 图表向导，并将其操作到您正在寻找的条形图中。

如果这不是您的答案，您将需要更具体地说明您想要实现的目标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-01-05T13:19:31.057

如果我正确理解您的问题，您希望使用您显示的数据格式创建一个特定的条形图。

正如 Marc 指出的那样，要在原生 excel 中创建所需的图形，您必须重新排列数据。

但是，如果您想保持数据格式相同，我建议您编写 Javascript 以在 excel 中绘制此图表。这是我为您编写的工作代码：

[https://www.funfun.io/1/edit/5a463a3fb848f771fbcdef58](https://www.funfun.io/1/edit/5a463a3fb848f771fbcdef58)

我在这个例子中所做的首先是使用 json 文件获取数据：

`{ "data": "=A1:J9" }`

访问它后，我使用 javascript 选择我需要的数据并选择一个库来创建我的条形图（这里我使用了 chart.js，它很容易使用）：

```
 var myBarChart = new Chart(ctx, {
  type: 'bar',
  data: data,
  options: {
    title: {
        display: true, 
       text: "Excel chart with multiple survey results" 
      },
    barValueSpacing: 20,
    scales: {
      yAxes: [{
        ticks: {
          min: 0,
          max: 10
        }
      }]
    }
  }
}); 
```

如果这是您想要的图表，您可以通过将 URL 粘贴到[Funfun 插件中](https://www.funfun.io/1/msaddin)，直接将我的代码与您的电子表格一起加载。这是它的样子：

[![https://i.stack.imgur.com/LWjZc.png](../Images/d0f2e5b868ab25fca2c939cc71b5d702.png)](https://i.stack.imgur.com/LWjZc.png)

您当然可以在在线编辑器或 Excel 的嵌入式编辑器中修改代码。您可以添加不同于`Yes`或的其他标签`No`，您可以为每个名为 的问题添加第三条`Compare price`。

理论上，您可以编写任何您想要的代码，包括使用强大的库（如 chart.js 和 plotly.js）创建复杂的图表。

我希望我回答了你的问题，如果没有，请不要犹豫在下面发表评论。

**披露：我是 Funfun 的开发者。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T18:07:58.860

听起来你想要一张桌子。客户 ID 作为列标题，Q1-Q10 作为行标题。你所呈现的内容的转置版本。

# c++ - Eclipse MinGW：如何在一个项目中拥有多个主

> ID：10161194
> 
> 赞同：1
> 
> 时间：2012-04-15T10:25:09.760
> 
> 标签：c++, c, mingw, eclipse-cdt, main

当我在 Eclipse 上运行 Java 程序时，每次运行文件时，Compiler 都会检查它是否有`main`，如果有，我可以运行。如果没有，我不能。

但是当我使用 MinGW 在 Eclipse 上运行 C++ 程序 (CDT) 时，在 Compiler 中并不能那样工作。编译后，无论我从哪个文件运行，编译器都会搜索整个项目以查找**ONE MAIN**所以，如果我有很多主文件，我会收到错误消息。

请在 Eclipse 中告诉我，如何处理 C++ 编译器以拥有多个主文件并像在 Java 上一样工作：它只是找到`main`我从哪个文件运行。

@：我有多个主文件仅用于调试目的。！！！

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T23:03:14.190

与 C/C++ 中的 java 不同，您只能拥有*一个*main：

> main() 函数比较特殊；通常每个 C 和 C++ 程序都必须只定义**一次**。

^(（[来源](https://en.wikipedia.org/wiki/Main_function_%28programming%29#C_and_C.2B.2B)）)

**但是：**作为一种解决方法，您可以使用预处理器来决定`main`您要使用哪个。

**例子：**

```
#ifdef FIRST_MAIN
int main(int argc, char** argv)
{
    printf("first");

    return (EXIT_SUCCESS);
}
#elif SECOND_MAIN
int main(int argc, char** argv)
{
    printf("second");

    return (EXIT_SUCCESS);
}
#else
int main(int argc, char** argv)
{
    printf("default");

    return (EXIT_SUCCESS);
}
#endif 
```

现在您可以通过在编译时设置适当的标志来决定要使用的那个。如果没有设置，您将使用*默认*的（`#else`部分）。

*替代方案：*`main`从编译中排除所有包含 -function 的文件，仅包含您需要的文件。但是，这仅在这些文件不包含超过`main`.

# git - 有没有办法使用 GPG 密钥在 Git 中“自动签名”提交？

> ID：10161198
> 
> 赞同：278
> 
> 时间：2012-04-15T10:26:03.610
> 
> 标签：git, public-key-encryption, gnupg

有没有一种简单的方法可以让 Git 总是对创建的每个提交或标签进行签名？

我尝试过类似的东西：

```
别名提交 = 提交 -S
```

但这并没有奏效。

我不想安装不同的程序来实现这一点。是否可以轻松实现？

只是一个附带问题，也许不应该签署提交，只有标签，我从未创建过，因为我为 Homebrew 等项目提交单个提交。

* * *

## 回答 #1

> 赞同：345
> 
> 时间：2013-12-17T07:40:05.073

注意：如果您不想一直添加`-S`以确保您的提交已签名，则有一个提案（分支 ' `pu`' 现在，2013 年 12 月，因此不能保证它会进入 git 版本）添加一个config 它将为您处理该选项。
2014 年 5 月更新：它在 Git 2.0 中（[在此补丁系列中重新发送](http://permalink.gmane.org/gmane.comp.version-control.git/242137)后）

请参阅[Nicolas Vigier (boklm)](https://github.com/boklm)的[提交 2af2ef3](https://github.com/git/git/commit/2af2ef3c85612946cac3f16143b4875c9f31c4d2)：

## 添加对`commit.gpgsign`所有提交进行签名的选项

> 如果您想对所有提交进行 GPG 签名，则必须`-S`始终添加该选项。config 选项允许自动签署所有提交
> 。`commit.gpgsign`

```
commit.gpgsign 
```

> 一个布尔值，用于指定是否所有提交都应该是 GPG 签名的。
> 在执行 rebase 等操作时使用此选项可能会导致大量提交被签名。使用代理来避免多次输入您的 GPG 密码可能会很方便。

* * *

该配置通常是按 repo 设置的（您不需要签署您的私有实验性本地 repos）：

```
cd /path/to/repo/needing/gpg/signature
git config commit.gpgsign true 
```

您可以将其与`user.signingKey`用作全局设置相结合（用于您要签署提交的所有 repo 的唯一密钥）

```
git config --global user.signingkey F2C7AB29!
                                           ^^^ 
```

正如[ubombi](https://stackoverflow.com/users/3861851/ubombi)在[评论](https://stackoverflow.com/questions/10161198/is-there-a-way-to-autosign-commits-in-git-with-a-gpg-key/20628522#comment123857639_20628522)中所建议的（并在“ [GPG 硬件密钥和 Git 签名](https://vitalii.kozlovskyi.dev/posts/gpg-hardware-key-and-git-signing/)”中解释，基于“[如何指定用户 ID](https://www.gnupg.org/documentation/manuals/gnupg/Specify-a-User-ID.html) ”）

> 使用 gpg 时，可能会附加感叹号 ( `!`) 以强制使用指定的主键或辅助键，而不是尝试计算要使用的主键或辅助键。

* * *

`user.signingKey`在 git 1.5.0（2007 年 1 月）中引入并[提交 d67778e](https://github.com/git/git/commit/d67778eccdf778f0fc252aaade8a47c23bfebbd6)：

> 不应该要求我在我的 git 存储库和我的 gpg 密钥中使用相同形式的我的名字。
> 此外，我的密钥环中可能有多个密钥，并且可能想要使用与我在提交消息中使用的地址不匹配的一个。

> 此补丁添加了一个配置条目“ `user.signingKey`”，如果存在，它将传递给 gpg 的“-u”开关，从而允许覆盖标记签名密钥。

这是通过[提交 aba9119](https://github.com/git/git/commit/aba91192ae39cd1a2f79e7ed91e966df3cfe10b7) (git 1.5.3.2) 强制执行的，以捕捉如果用户`user.signingKey`在他们的密钥环上配置错误`.git/config`或只是没有任何密钥的情况。

笔记：

*   按照惯例，[自 git 2.4.0 March 2015 以来](https://github.com/git/git/commit/da0005b8853137c91e44867d899910d5c7eb4425)，它是[`signingKey`，不是`signingkey`](https://github.com/git/git/commit/da0005b8853137c91e44867d899910d5c7eb4425#diff-ba92ef40c548c691816362bbdc35a613R2554)，即使`git config`键不区分大小写。仅当您这样做时才重要`git config --get-regexp`，这*是*区分大小写的，否则，它只是一个可读性约定；
*   如果您希望[git 服务器检查每次推送的签名，](https://stackoverflow.com/q/27299355/6309)则至少需要 git 2.2+（2014 年 10 月）（[提交 b945901](https://github.com/git/git/commit/b9459019bbb7b864cf59fa307953834996ab4dbe)），因为[`git push --signed`](https://git-scm.com/docs/git-push)未考虑`user.signingKey`配置值；
*   git 2.9（2016 年 6 月）将用于`user.signingKey`强制签署带注释的*标签*以及提交：[commit 61c2fe0](https://github.com/git/git/commit/61c2fe0c2984a7785e2ac803ce33e23663295b24)。

* * *

## 回答 #2

> 赞同：243
> 
> 时间：2015-05-26T20:01:06.500

```
git config --global user.signingKey 9E08524833CB3038FDE385C54C0AFCCFED5CDE14
git config --global commit.gpgSign true 
```

将 9E08524833CB3038FDE385C54C0AFCCFED5CDE14 替换为您的密钥 ID。请记住：[使用短 ID 绝不是一个好主意](https://evil32.com/)。

**更新：**根据[新的 git edict](https://github.com/git/git/commit/da0005b8853137c91e44867d899910d5c7eb4425)，所有配置键都应该在 camelCase 中。

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2012-04-15T22:59:29.300

编辑：从 Git 版本 1.7.9 开始，[*可以*](http://thread.gmane.org/gmane.linux.kernel/1245104)[签署](http://thread.gmane.org/gmane.linux.kernel/1245104)*Git 提交 ( [)](http://thread.gmane.org/gmane.linux.kernel/1245104)`git commit -S`。稍微更新答案以反映这一点。*

 *问题标题是：

> 有没有办法在 Git 中使用 GPG 密钥“自动签名”提交？

简短的回答：是的，但不要这样做。

解决问题中的错字：`git commit -s`不签署提交。相反，从[`man git-commit`](http://linux.die.net/man/1/git-commit)页面：

> -s, --signoff
> 在提交日志消息的末尾添加由提交者签名的行。

这将提供类似于以下内容的日志输出：

```
 ± $ git log                                                                                 [0:43:31]
commit 155deeaef1896c63519320c7cbaf4691355143f5
Author: User Name 
Date:   Mon Apr 16 00:43:27 2012 +0200

    Added .gitignore

    Signed-off-by: User Name 
```

注意“Signed-off-by: ...”位；这是由`-s`.`git-commit`

引用[发布公告电子邮件](http://thread.gmane.org/gmane.linux.kernel/1245104)：

> *   “git commit”学习了“-S”来对提交进行 GPG 签名；这可以通过“git log”的“--show-signature”选项来显示。

所以是的，你可以签署提交。但是，我个人强烈建议谨慎使用此选项；*自动*签署提交几乎没有意义，见下文：

> 只是一个附带问题，也许不应该签署提交，只有标签，我从不创建，因为我提交单个提交。

这是正确的。提交未签名；标签是。原因可以在[Linus Torvalds](http://git.661346.n2.nabble.com/GPG-signing-for-git-commit-td2582986.html)的这条消息中找到，该消息的最后一段说：

> 签署每个提交是完全愚蠢的。这只是意味着您将其自动化，并使签名的价值降低。它也没有增加任何真正的价值，因为 SHA1 的 git DAG 链的工作方式，你只需要*一个* 签名来使从那个可以到达的所有提交都被那个有效地覆盖。所以签署每个提交只是错过了重点。

我鼓励浏览链接的消息，它以比我更好的方式阐明*了为什么自动签署提交不是一个好主意。*

**但是**，如果您想自动签署一个*标签*，您可以通过将 包装`git-tag -[s|u]`在别名中来做到这一点；如果您要这样做，您可能希望在`~/.gitconfig`特定于项目的`.git/config`文件中设置您的密钥 ID。有关该过程的更多信息，请参阅[git community book](http://book.git-scm.com/3_git_tag.html)。签署标签比签署您所做的每个提交都有用得多。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2016-10-19T11:01:04.083

要使自动签名在 git 版本 2.0 之前工作，您必须为提交添加 git 别名。

```
# git config --global alias.commit commit -S
[alias]
    commit = commit -S 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2021-12-26T07:25:36.703

首先设置您要用来签署所有提交、标签和推送的公钥。要获取公钥，请使用以下命令

```
% gpg --list-keys --keyid-format=short
/home/blueray/.gnupg/pubring.kbx
-------------------------------
pub   rsa3072/F6EED39A 2021-12-25 [SC] [expires: 2023-12-25] 
```

在这种情况下，公钥是`F6EED39A`。现在运行以下命令。

```
git config --global user.signingkey F6EED39A
git config --global commit.gpgSign true // sign all commits
git config --global tag.gpgSign true // sign all tags
git config --global push.gpgSign true // sign all push 
```

现在您的所有提交、标签和推送都将由您给定的公钥自动签名。

有时您可能需要**覆盖这些设置**。

对于提交，使用`git commit --no-gpg-sign -m "Unsigned commit"`

对于标签，使用`git tag --no-sign <tag-name>`

对于推送，使用`git push --no-signed`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-19T01:17:41.273

您需要明确指出，如果您签署提交或标签，并不意味着您批准了整个历史记录。在提交的情况下，您只需对手头的更改进行签名，而在标签的情况下，嗯..您需要定义您的意思。您可能已经提取了一个声称它来自您但不是来自您的更改（因为其他人将其推送到您的遥控器）。或者这是您不想参与的更改，但您只是签署了标签。

在典型的 OSS 项目中，这可能不太常见，但在企业场景中，您只是不时地接触代码并且您没有阅读整个历史，它可能会被忽视。

如果他们将被重新定位或挑选给其他父母，那么签署提交是一个问题。但是，如果修改后的提交可以指向实际验证的“原始”提交，那就太好了。*

# c# - 即使启用了 ClearTypeHinting，WPF 中的文本也会变得模糊？

> ID：10161200
> 
> 赞同：6
> 
> 时间：2012-04-15T10:26:18.393
> 
> 标签：c#, .net, wpf, xaml, cleartype

我在 WPF/XAML 中有一个带有此模板和样式的网格：

```
<Setter Property="TextOptions.TextFormattingMode" Value="Display" />
<Setter Property="RenderOptions.ClearTypeHint" Value="Enabled" />
<Setter Property="Template">
    <Setter.Value>
        <ControlTemplate TargetType="{x:Type DataGridCell}">
            <Border Padding="{TemplateBinding Padding}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" SnapsToDevicePixels="True">
                <ContentPresenter x:Name="CellContent" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" RenderOptions.ClearTypeHint="Enabled" />
            </Border>
            <ControlTemplate.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter TargetName="CellContent" Property="TextOptions.TextFormattingMode" Value="Display" />
                    <Setter TargetName="CellContent" Property="RenderOptions.ClearTypeHint" Value="Enabled" />
                    <Setter TargetName="CellContent" Property="Effect">
                        <Setter.Value>
                            <DropShadowEffect ShadowDepth="2" BlurRadius="2" Color="Black" RenderingBias="Quality" />
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
    </Setter.Value>
</Setter> 
```

当`DropShadowEffect`您选择网格行时，我有，似乎使文本渲染模糊（灰色抗锯齿）：

![在此处输入图像描述](../Images/e915176be123aa01a7c6437052ef8187.png)

当我删除阴影效果时，它看起来很清晰，因为它现在使用 ClearType 而不是灰色子像素抗锯齿：

![在此处输入图像描述](../Images/7d36afc5ff0d47dff726f47ac7812f0a.png)

我已经尝试申请`RenderOptions.ClearTypeHint="Enabled"`如上`ContentPresenter`所示，但它没有帮助。

如何强制 WPF 呈现以投影效果显示的文本以保留 Cleartype 抗锯齿，而不是那种丑陋的模糊灰色亚像素抗锯齿？

有些人认为它是模糊的，因为有阴影——这不是真的。只是因为没有使用 ClearType 才模糊。这是阴影和 ClearType 在 Firefox 中的样子：

![在此处输入图像描述](../Images/034d754c3f0f0ecaee9473426e9788b0.png)

启用 ClearType 的文本是彩色的——但模糊文本不是，因为它不使用 ClearType——它使用灰色亚像素抗锯齿，这不是 ClearType 的工作方式：[http ://en.wikipedia.org/wiki/清除类型](http://en.wikipedia.org/wiki/ClearType)

问题是：如何为此文本启用 ClearType？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-21T14:17:18.190

设置`TextOptions.TextFormattingMode`to`Display`和`RenderOptions.BitmapScalingMode`to`NearestNeighbor`怎么样？后者是 WPF 3.5 SP1 中的新功能，我通常使用它来消除模糊。:)

```
<TextBlock Text="Hello world" TextOptions.TextFormattingMode="Display"
           RenderOptions.BitmapScalingMode="NearestNeighbor"
           HorizontalAlignment="Center" TextWrapping="Wrap"
           VerticalAlignment="Center" Foreground="White" FontFamily="Microsoft Sans Serif">
    <TextBlock.Effect>
        <DropShadowEffect ShadowDepth="2" BlurRadius="2" Color="Black"
                          RenderingBias="Quality"/>
    </TextBlock.Effect>
</TextBlock> 
```

下面是它的样子。

![在此处输入图像描述](../Images/395a16abbb7971d99eca11ee7def0051.png)

这就是它在 FireFox 中的样子。

![在此处输入图像描述](../Images/479ddabdc9f37b4d3d165479ffea43e1.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-15T11:24:58.790

DropShadowEffect对象不能与 ClearType 一起使用*。*这在 MSDN 页面[How to: Create Text with a Shadow 上有](http://msdn.microsoft.com/en-us/library/ms748273.aspx)说明：

> 这些阴影效果不通过 Windows Presentation Foundation (WPF) 文本呈现管道。因此，ClearType 在使用这些效果时被禁用。

毕竟*DropShadowEffect*是位图效果，不是文字效果。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-15T16:25:14.633

要在不使用效果的情况下获得类似的结果，您可以渲染文本两次，一次稍微偏移另一次：

```
<Grid>
    <TextBlock Text="Here is some sample text" Foreground="Black" Margin="1,1,0,0"/>
    <TextBlock Text="Here is some sample text" Foreground="White"/>
</Grid> 
```

这产生了预期的结果：

![在此处输入图像描述](../Images/c7ec9a9a7641eef44f09f484d5710f25.png)

![在此处输入图像描述](../Images/28a0a8a1bbfc31287ea51db5e16b7fe6.png)

您还可以将其封装到一个控件中（`ShadowTextBlock`也许称为 ），这样您就不必到处重复自己了。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-19T20:49:27.087

把这两个想法结合起来怎么样。使用 DropShadowEffect 绘制文本，并将其与绘制的没有效果的相同文本覆盖，如下面的第三行所示：

![文本](../Images/70d4990168ce99c82cb49a53e811386b.png)

仍然不完美，我觉得它有点大胆。但也许你可以忍受的东西。XAML：

```
<StackPanel Background="LightSteelBlue" RenderOptions.ClearTypeHint="Enabled" SnapsToDevicePixels="True" >
    <Grid Margin="5">
        <TextBlock Foreground="Black" Text="Here is some sample text" Margin="1"/>
        <TextBlock Foreground="White" Text="Here is some sample text"/>
    </Grid>
    <TextBlock Margin="5" Foreground="White" Text="Here is some sample text">
        <TextBlock.Effect>
            <DropShadowEffect ShadowDepth="2" BlurRadius="2" Color="Black" RenderingBias="Quality"/>
        </TextBlock.Effect>
    </TextBlock>
    <Grid Margin="5">
        <TextBlock Foreground="White" Text="Here is some sample text">
            <TextBlock.Effect>
                <DropShadowEffect ShadowDepth="2" BlurRadius="2" Color="Black" RenderingBias="Quality"/>
            </TextBlock.Effect>
        </TextBlock>
        <TextBlock Foreground="White" Text="Here is some sample text"/>
    </Grid>
</StackPanel> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-25T21:05:55.370

这不起作用的原因，以及您无法让它工作的原因，与 ClearType 对它所呈现的内容的敏感性有关。为了让 ClearType 看起来正确，它本质上需要进行每个组件的 alpha 混合。也就是说，红色、绿色和蓝色的单独 alpha 值（通常 alpha 适用于所有 3 个）。这意味着 ClearType 绝对必须被渲染成一个已经不透明的位图（所有 alpha 值都是 255）（你会注意到窗口标题栏仍然有 ClearType，但它们使用了一些超级秘密技巧来做到这一点）。

理解这一点的下一步是 WPF 效果首先呈现为屏幕外位图，然后与下方的内容组合（在这种情况下，纯白色，或者如果选择它，则可能是蓝色）。

因此，首先将文本呈现为清晰、透明的位图。因为它不知道最终会在它下面是什么，所以它必须使用灰度而不是 ClearType 进行渲染。然后，效果将应用于该位图。然后将位图绘制到您期望它在屏幕上的位置，即使它位于没有透明度的纯色之上，也没有机会获得 ClearType。

作为一种可能的解决方法，请尝试使用 2 个文本副本。首先，将效果应用于文本的“较低”版本（“较低”是指它应该具有较低的 Z-index 值，如果它在 XAML 中是“第一个”则就是这种情况）。然后，在其上绘制普通文本（将获得 ClearType）。我认为这会起作用，但我还没有尝试过，您可能需要进行试验，直到获得所需的视觉效果。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-07-12T16:24:58.823

我知道这篇文章很旧，但如果有人遇到模糊文本的问题，那么边框阴影可能是罪魁祸首。我有带有阴影的自定义面板，只有当面板并排放置时，文本才会模糊。我从这个[为什么 WPF 中的一切都是模糊的？](https://stackoverflow.com/questions/805677/why-everything-in-wpf-is-blurry)邮政。对我来说，解决方案是 ecreif 的答案，而不是公认的答案。将此添加到您的控件

```
 UseLayoutRounding="True"
    RenderOptions.BitmapScalingMode="NearestNeighbor"
    SnapsToDevicePixels="True
    RenderOptions.ClearTypeHint="Enabled" 
```

# javascript - 在 HTML 5/Javascript 中批量插入到客户端数据库（WEB SQL）

> ID：10161206
> 
> 赞同：4
> 
> 时间：2012-04-15T10:27:26.093
> 
> 标签：javascript, html

是否可以在 HTML 5 的客户端数据库中使用批处理操作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-15T13:18:52.473

我假设您指的是[WebSQL](http://www.w3.org/TR/webdatabase/)？

此时，WebSQL 基本上是包装器中的 SQLite。SQLite[不支持](http://www.sqlite.org/cvstrac/wiki?p=UnsupportedSql)`INSERT`在一个语句中插入多行。但是您可以[使用占位符进行一次查询并在单个事务中执行多次，](https://stackoverflow.com/questions/10031605/optimizing-websql-local-database-population/10031717#10031717)以提高性能并确保完整性。

如果这不能回答您的问题，您应该澄清您遇到的确切问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-12T01:07:18.903

我迟到了几年，但我想用一些（额外的）建议和代码来补充 DCoder 的答案！

首先，如果您正在阅读本文，您可能不应该使用 WebSQL。它已被[弃用](http://caniuse.com/#search=websql)，取而代之的是 IndexedDB，此时它是 W3C 标准轨道上的唯一数据库。

如果出于某种原因，您打算继续使用 WebSQL，您可能会意识到其默认 API 的异步性意味着多语句事务代码很可能变得复杂且笨拙。

如果您想省去编写此类代码的麻烦，请查看[BakedGoods 。](https://github.com/klawson88/Baked-Goods)例如，使用该库，将一个或多个项目插入到表中非常简单：

```
bakedGoodsd.set({
    data: [{key: "key1", value: "value1"}, {key: "key2", value: "value2"}]
    storageTypes: ["webSQL"],
    complete: function(byStorageTypeStoredItemRangeDataObj, byStorageTypeErrorObj){}
}); 
```

...这比使用原始 API 必须编写的内容要简洁得多：

```
function insertData(transaction)
{
    var dataInsertStatement = "INSERT INTO Main(key, value) VALUES (?, ?)";
    var dataArray = [{key: "key1", value: "value1"}, {key: "key2", value: "value2"}];

    int i = 0;

    function advance()
    {
        if(++i < dataArray.length)
            insertDataItem();
    }

    function insertDataItem()
    {
        transaction.executeSql(
            dataInsertStatement, 
            [dataArray[i].key, dataArray[i].value], 
            advance
        );
    }

    insertDataItem();
}

function conductDataInsertTransac(database)
{
    database.transaction(insertData);
}

window.openDatabase("Baked_Goods", "", "Baked Goods", 1024*1024, conductDataInsertTransac); 
```

BakedGoods 的简单界面和无与伦比的存储设施支持是以缺乏对某些存储设施特定配置的支持为代价的。例如，它不支持在具有多列主键的 WebSQL 表中进行存储操作。

因此，如果您大量使用这些类型的功能，您可能想看看其他地方。

哦，为了完全透明，BakedGoods 由您真正维护 :) 。

# ajax - 形式中的形式 - 以不同的方式解决？

> ID：10161207
> 
> 赞同：0
> 
> 时间：2012-04-15T10:27:32.037
> 
> 标签：ajax, asp.net-mvc-3

我有这样的情况：

1.  带有文本框、两个下拉列表和带有选定值的网格的表单
2.  带有搜索文本框的表单，它需要知道在上述表单的下拉列表中选择的值才能进行搜索

第一种形式是将整个数据保存到数据库。第二种形式用于在数据库中搜索，显示搜索值并将所选值添加到第一种形式的网格中。

如果允许形式中的形式，它可以工作，但事实并非如此。我试图在此下拉列表中为选定的 id 添加隐藏值，但这些值未绑定。

有任何想法吗？

编辑：

我已经用下面的代码解决了这个问题，用于表单的搜索部分：

Javascript：

```
$('#wsSearch').click(function(e) {
    $.ajax({
        type: "POST",
        url: '@Url.Action("Search", "Definition")',
        data: {
            word: $('#wsSearchWord').val(),
            firstId: $('#wsFirstDropdown').val(),
            secondId: $('#wsSecondDropdown').val()
        },
        success: function(data) {
            $('#wsSearchResultContainer').html(data);
        }
    });

    e.preventDefault();
}); 
```

控制器：

```
[HttpPost]
public virtual PartialViewResult Search(string word, int firstId, int secondId)
{
    var model = this.service.Search(word, firstId, secondId);
    return PartialView("_SearchResult", model.ToList());
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T11:06:55.803

我很害怕，但我想如果没有 JavaScript，你将无法得到这个。使用 JavaScript，您可以绑定搜索表单的提交事件，然后从第一个表单中获取数据，或者您可以绑定下拉列表的更改事件，然后更改搜索表单。

# asp.net - 首先在实体框架模型中设计“热与否”风格的数据库

> ID：10161210
> 
> 赞同：1
> 
> 时间：2012-04-15T10:27:50.417
> 
> 标签：asp.net, .net, entity-framework, database-design, ef-model-first

我想在电影之间设计一种决斗，让两部电影相互对抗，用户选择更好的，然后得到一分。在数据库中，我想要一个列表，列出所有已决斗的电影以及它们分别获胜的次数。

**电影**

```
 Id
    Name
    Duels 
```

**决斗**

```
 ContenderOne
    ContenderTwo
    NumberOfDuels
    ContenderOneWins
    ContenderTwoWins 
```

我正在尝试进行设置，以便电影实体具有 1 个名为 Duels 的属性，我可以在其中获取涉及它的所有决斗实体，无论它是竞争者一还是竞争者二。ContenderOne 和 ContenderTwo 应该链接回电影。

任何想法如何实现这一目标？我难住了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T11:57:31.917

你不能只有一个财产。您将需要两个：`DuelsAsContenderOne`和`DuelsAsContenderTwo`。如果您需要不考虑位置的所有决斗，您可以使用表达式`x.DuelsAsContenderOne.Concat(x.DuelsAsContenderTwo)`

# java - Java 是否有任何用于 Gmail 聊天的 API？

> ID：10161214
> 
> 赞同：-1
> 
> 时间：2012-04-15T10:28:29.687
> 
> 标签：java, oauth

我正在尝试在 Java 上为 Gmail 制作聊天应用程序，但我找不到任何用于此目的的 API。有人告诉我 OAuth，但我认为它没有任何此类功能。请向我推荐一个 API 或帮助我在这种情况下使用 OAuth。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T10:33:24.413

Google 使用 XMPP 协议进行聊天。

*   [XMPP Java API 概述](https://developers.google.com/appengine/docs/java/xmpp/overview)
*   使用[Smack](http://www.igniterealtime.org/projects/smack/index.jsp)库的[简单教程](http://www.andrejkoelewijn.com/wp/2008/12/30/using-google-talk-from-java-example/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T10:33:59.483

Gmail 使用基于网络的 Google Talk (GTalk) 版本。GTalk 是一个基于 Jabber/XMPP 的聊天系统。

我建议查看用于 Java 的 Jabber/XMPP 库，例如 Smack，在这个问题中被注明为答案；[最好的 java jabber 客户端库](https://stackoverflow.com/questions/1091625/best-java-jabber-client-library)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T10:35:45.263

Google Chat 和 Google Talk 使用 XMPP 协议。您可能会发现在这里阅读 Google 文档很有用... [https://developers.google.com/talk/](https://developers.google.com/talk/)

# c - 未声明的变量

> ID：10161216
> 
> 赞同：1
> 
> 时间：2012-04-15T10:28:31.693
> 
> 标签：c, linux, sockets

我正在尝试创建套接字，我应该描述一些结构：

```
(struct in_addr) addr;
addr.s_addr = INADDR_ANY; 
```

我也包括了标题

```
#include <sys/socket.h>
#include <sys/types.h> 
```

但是 gcc 说有一个错误：

```
error: ‘addr’ undeclared (first use in this function) 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T10:32:02.783

要声明一个新`in_addr`结构，您需要删除这些括号：

```
struct in_addr addr;
addr.s_addr = INADDR_ANY; 
```

您目前拥有的是一个演员表，这意味着（大约）“假设`addr`已经是某种其他类型的声明变量，请尝试将其转换为`struct in_addr`”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T10:32:23.553

把括号去掉。写吧

`struct in_addr addr;`

# android - 如何在 Android 中创建类似货架的视图？

> ID：10161225
> 
> 赞同：16
> 
> 时间：2012-04-15T10:29:33.933
> 
> 标签：android, listview, horizontal-scrolling, vertical-scrolling

如何在android中创建一个类似书架的视图，在任何一行显示几本书？此外，它应该像moon+reader 应用程序那样具有水平和垂直功能。

我可以编写一个水平移动的架子视图，但它不能完全工作。我使用 xml 文件来查看包含图像、文本和按钮的项目。我编写了一个类，该类扩展`AdapterView`以创建`ListView`我称为的自定义`"shelf view"`。不幸的是，我的程序显示一排，我不能使用它多排。

![在此处输入图像描述](../Images/149a12af54623fb8fed256edd8f73a45.png)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-22T06:47:36.107

**最近更新：**现在，我可以检测到比以前的解决方案更好的创建货架视图的新方法。我在[CodeProject中描述了它](http://www.codeproject.com/Articles/389071/Create-a-dynamic-shelfview-in-Android)

顺便说一句，在这个应用程序中，我使用了两个类：

*   Horizo​​ntalListView 扩展 AdapterView 的类。它是从[GitHub下载的](https://github.com/dinocore1/DevsmartLib-Android)

*   Quaere 库的使用与 .Net 中的 Linq2Object 几乎相同。你可以[在这里](http://quaere.codehaus.org/)下载。

* * *

2012 年 4 月 22 日：

有一些方法可以实现货架视图，它具有两个功能（水平和垂直滚动）。我尝试编写一个可以动态运行的程序。这个示例应用程序有一个 XML 文件和一个*showShelfView java*类。

所以你可以看到我的应用程序：

**主 XML 文件：** 首先，在*main.XML中添加以下代码*

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:id="@+id/sclView">
    <TableLayout
            android:id="@+id/tblLayout"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" 
           android:padding="0dp">
    </TableLayout>
</ScrollView> 
```

**showShelfView 类：**内部 TableLayout 添加几个 Horizo​​ntalScroll 等于行数。还在任何 TableRow 内部添加图像。

不要忘记为 Row 的背景设置一个架子图像：

![在此处输入图像描述](../Images/a285e5c95513557786cd64d7c6af8e10.png)

```
public class showShelfView extends Activity {

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        int numRow = 4;
        int numCol = 8;

        TableLayout tblLayout = (TableLayout) findViewById(R.id.tblLayout);

        for(int i = 0; i < numRow; i++) {
            HorizontalScrollView HSV = new HorizontalScrollView(this);
            HSV.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT));

            TableRow tblRow = new TableRow(this);
            tblRow.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));
            tblRow.setBackgroundResource(R.drawable.bookshelf);

            for(int j = 0; j < numCol; j++) {
            ImageView imageView = new ImageView(this);
                imageView.setImageResource(R.drawable.book1);

                TextView textView = new TextView(this);
                textView.setText("Java Tester");
                textView.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));

                tblRow.addView(imageView,j);
            }

            HSV.addView(tblRow);
            tblLayout.addView(HSV, i);
        }
    }

} 
```

# macos - Qt：Mac 上的 Phonon 示例代码崩溃

> ID：10161227
> 
> 赞同：0
> 
> 时间：2012-04-15T10:29:57.083
> 
> 标签：macos, qt, phonon

我尝试运行 sdk 附带的声子示例代码 Music player Example。它在 Windows 上运行良好，但在 Mac OS Snow Leopard 10.6.8 上启动时崩溃。这是崩溃的详细信息：

**崩溃线：**

```
audioOutput = new Phonon::AudioOutput(Phonon::MusicCategory, this); 
```

**崩溃日志和调用堆栈：**

```
Exception Type: EXC_BAD_ACCESS (SIGSEGV)
Exception Codes: KERN_INVALID_ADDRESS at 0×0000000000000008
Crashed Thread: 0 Dispatch queue: com.apple.main-thread

Thread 0 Crashed: Dispatch queue: com.apple.main-thread
0 QtCore 0×0000000100e9c8f2 QObject::moveToThread(QThread*) + 34
1 QtDBus 0×00000001010b4912 _q_sessionBus() + 162
2 QtDBus 0×00000001010b4a71 QDBusConnection::sessionBus() + 17
3 phonon 0×000000010001beab Phonon::FactoryPrivate::FactoryPrivate() + 219
4 phonon 0×000000010001edc2 Phonon::Factory::registerFrontendObject(Phonon::MediaNodePrivate*) + 146
5 phonon 0×0000000100028f92 Phonon::MediaNodePrivate::MediaNodePrivate(Phonon::MediaNodePrivate::CastId) + 82
6 phonon 0×00000001000137bf Phonon::AudioOutput::AudioOutput(Phonon::Category, QObject*) + 63
7 com.yourcompany.qmusicplayer 0×00000001000026cc MainWindow::MainWindow() + 108
8 com.yourcompany.qmusicplayer 0×00000001000024a2 main + 114
9 com.yourcompany.qmusicplayer 0×0000000100002404 start + 52 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T15:10:03.897

我相信这是 Qt 4.8.0 的问题。它需要在您的机器上安装 dbus。有一些解决方法，例如在您的机器上安装 dbus 或使用补丁重建 Qt，但我相信它已在 Qt 4.8.1 中修复，因此可能只是使用它。

# android - 禁用三星 Galaxy Tab 2.3.3 android 上的列表视图过度滚动

> ID：10161232
> 
> 赞同：6
> 
> 时间：2012-04-15T10:31:19.220
> 
> 标签：android

我需要在我的列表视图中完全禁用过度滚动，这样我才能实现自己的过度滚动功能。

查看核心列表视图类时似乎很简单，只需将`overscroll`模式设置为 OVERSCROLL_NEVER。这在我的三星 Galaxy s2 上做得很好。但不起作用`Galaxy Tab 2.3.3.`

有没有人对可以帮助我的三星 ListView 自定义有很多经验？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T15:36:02.100

它适用于三星 Galaxy Tab（使用 Android 2.2）：

```
try {

    // list you want to disable overscroll
    // replace 'R.id.services' with your list id
    ListView listView = ((ListView)findViewById(R.id.services)); 

    // find the method
    Method setEnableExcessScroll =
            listView.getClass().getMethod("setEnableExcessScroll", Boolean.TYPE);

    // call the method with parameter set to false 
    setEnableExcessScroll.invoke(listView, Boolean.valueOf(false)); 

}
catch (SecurityException e) {}
catch (NoSuchMethodException e) {}
catch (IllegalArgumentException e) {}
catch (IllegalAccessException e) {}
catch (InvocationTargetException e) {} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-22T17:11:45.613

您必须将列表视图的高度设置为固定值。如果您的内容是动态的，则有一个很好的函数可以在重置适配器后测量实际的列表大小：

```
 public static void setListViewHeightBasedOnChildren(ListView listView) {
    ListAdapter listAdapter = listView.getAdapter();
    if (listAdapter == null) {
        // pre-condition
        return;
    }

    int totalHeight = 0;
    int desiredWidth = MeasureSpec.makeMeasureSpec(listView.getWidth(), MeasureSpec.AT_MOST);
    for (int i = 0; i < listAdapter.getCount(); i++) {
        View listItem = listAdapter.getView(i, null, listView);
        listItem.measure(desiredWidth, MeasureSpec.UNSPECIFIED);
        totalHeight += listItem.getMeasuredHeight();
    }

    ViewGroup.LayoutParams params = listView.getLayoutParams();
    params.height = totalHeight + (listView.getDividerHeight() * (listAdapter.getCount() - 1));
    listView.setLayoutParams(params);
    listView.requestLayout();
} 
```

设置适配器后，您必须使用列表视图作为参数调用此静态方法。您现在可以添加一个滚动视图（里面是您的列表视图和其他视图）。我会说 2.3.3 之前的这种行为是一个小错误......除了我描述的方式之外，没有简单的方法可以将列表视图包含在滚动视图中。出于这个原因，他们引入了 OVERSCROLL_NEVER 模式:)

代码来自 DougW！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-22T17:49:12.283

不是我的解决方案，但对我有用:)

[https://gist.github.com/DHuckaby/3919939](https://gist.github.com/DHuckaby/3919939)

# asp.net-mvc-3 - Telerik 网格外键绑定过滤器

> ID：10161234
> 
> 赞同：0
> 
> 时间：2012-04-15T10:32:00.093
> 
> 标签：asp.net-mvc-3, grid, telerik, foreign-key-relationship, viewdata

我有一个显示来自客户的订单的网格，其中包含一个 ItemID。现在，我使用 mvc 的 Telerik 网格在第二个网格上执行 CRUD 操作，对于 ItemID 的列，我使用 ForeignKey 没有问题，就像这段代码一样：

```
cols.ForeignKey(c => c.ItemID, (System.Collections.IEnumerable)ViewData["rcItems"],
                    "ItemID", "Name").Width(200).Title("Description"); 
```

现在我的问题是每次我执行编辑时，所有项目都会从下拉列表中显示。我想要的是只显示可用的项目，这将取决于网格上的客户。也就是说，customer1可能只得到(100, 101), customer2(100)和customer3(102, 103)

我有两张表 CustomerOrders 和 DeliveredItemstoCustomers

```
--CustomerOrders table
CustomerID      ItemID
1                     100
1                     101
2                     100
3                     102
3                     103

--Item table
ItemID   Name
100      Apple
101      Orange
102      Banana
103      Grapes

--DeliveredItemstoCustomers Table
CustomerID      ItemID
1                     101
3                     103

--How I load the Items to Viewdata
ViewData["rcItems"] = db.Items.ToList(); 
```

基本上，我想阻止用户输入所选用户不可用的项目。我正在尝试使用 ajax 在客户端更改 Viewdata，但没有运气

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T10:31:31.750

在动态绑定网格上应用 ForeignKey 的任何方法？

# objective-c - 具有背景图像水平滚动的网格视图

> ID：10161239
> 
> 赞同：1
> 
> 时间：2012-04-15T10:32:37.403
> 
> 标签：objective-c, ios

我正在尝试实现一个网格视图菜单，通过滑动手势触发三个图像的水平背景滚动，因此只有背景图像被滚动，而图标保持静止。我调查了 AQGridView、GMGridView、OHGridView，但它们似乎不包含此功能，因此我决定使用以网格形式放置的自定义按钮来实现我自己的网格视图。我的疑问是如何实现背景图像滚动。我已经搜索了不同的解决方案，但我无法弄清楚如何解决它。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T10:48:50.113

如果我正确理解您的问题，您可以制作一个包含 2 个子视图的视图：a) 图标网格 ( `UIImageView`) 和 b) 在分页模式下带有背景图像的滚动视图 ( `UIScrollViewController`)。

只需确保您的图标没有收到触摸，以便滚动视图得到触摸。

如果你想让图标可以点击，那就有点复杂了；您可以在顶部创建一个不可见的图层，然后手动处理触摸，这将变得复杂。或者，我会做什么，将图标作为子视图放置在普通滚动视图上，然后将图标沿滚动视图移动的相同和相反方向移动，以创建图标静止不动的错觉，这将最容易实现但有点破解。从数学上讲，您希望对滚动视图应用变换，并对滚动视图坐标系中的图标应用相反的变换，以便在全局坐标系（屏幕）中，您的图标不会移动。

# php - SimpleXMLElement 如何更改标签内容（值）

> ID：10161241
> 
> 赞同：0
> 
> 时间：2012-04-15T10:33:15.257
> 
> 标签：php, xml-parsing, simplexml

我需要知道如何更改标签的内容（不是属性，只是内容）。我不需要这个父标签内的内部标签。我只需要在里面放一些文字。（替换“1.Hello World”）下一个xml文件：

```
<config name="THIS" type="string">1\. Hello World)</config>
<config name="IS" type="string">2\. Hello World!</config>
<config name="SPARTA" type="string">3\. Hello World?</config> 
```

```
// create simple xml object
$xml = new SimpleXMLElement(file_get_contents('file.xml'));

// new names and values
$names  = array('THIS', 'SPARTA');
$values = array('1\. Good bye world(', '3\. Good bye world?');

// replace here
foreach($xml as $a => $xmlElement) {
     $indexOfName = array_search($names, (string)$xmlElement['name']);
     if ($indexOfName !== false) {
          // here I need to replace the value (e.g. 1\. Hello World)) of config
          // with the attribute @name == $names[$i] with the new value
          // $values[$i] (3\. Good bye world?)
     }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T10:42:07.327

通常，您需要父元素，或者如果您知道父元素的结构，您可以尝试 xpath。除此之外，你可能想试试这个黑客：

```
$xmlElement->{0} = $values[$indexOfName]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T13:07:14.300

我找到了临时解决方案。它创建一个新的简单 xml 并从当前简单 xml 中复制所有内容并替换内容值

```
$newXml = new SimpleXMLElement('<' . $xml->getName() . '></' . $xml->getName() . '>');
foreach($xml as $a => $xmlElement) {
    $attr = $newXml->addChild($a, 'New content of the tag');
    foreach($xmlElement->attributes() as $k => $v) {
        $attr->addAttribute($k, $v);
    }
}
echo $newXml->asXML(); 
```

然而它是暂时的。我希望如果有人能提出更好的解决方案

# ios5 - 如何在耗时的 ui 元素实例化期间更新进度条？

> ID：10161244
> 
> 赞同：0
> 
> 时间：2012-04-15T10:33:28.360
> 
> 标签：ios5, uikit

我想在实例化一些需要一些时间的 ui 元素时更新进度条。我首先在 viewLoad 方法中创建我的视图并在那里添加我的进度条。一旦我的视图出现在 viewDidAppear 方法中，我正在实例化几个 uikit 对象，但我想同时更新进度条。我不确定如何继续，因为一切都应该发生在主线程中，因为它是 ui 元素。

这是我的代码的一部分：

```
-(void) viewDidAppear:(BOOL)animated
{
    // precompute the source and destination view screenshots for the custom segue
    self.sourceScreenshotView = [[UIImageView alloc] initWithImage:[self.view pw_imageSnapshot]];

    [self.progressBar setProgress:.3];

    SCLViewController *rvc = [[SCLViewController alloc] init];
    UIView *destinationView = rvc.view;
    destinationView.frame = CGRectMake(0, 0, kWidthLandscape, kHeightLandscape);

    self.destinationScreenshotView = [[UIImageView alloc] initWithImage:[destinationView pw_imageSnapshot]];

    [self.progressBar setProgress:.5];

} 
```

在上面的代码中，我只需要创建两个视图的屏幕截图，以便以后使用它们。问题是我在将进度设置为进度条时只看到最后一次更新（.5）。进行此更新的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T10:44:46.777

您可以使用[performSelectorInBackground:withObject:](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsobject_Class/Reference/Reference.html)方法来实例化繁重的视图。该方法（实例化视图的方法）必须在主线程中设置进度条进度。

所以你的代码看起来像这样：

```
- (void)viewDidAppear:(BOOL)animated
{
    [self performSelectorInBackground:@selector(instantiateHeavyViews) withObject:nil];
}

- (void)instantiateHeavyViews
{
    self.sourceScreenshotView = [[UIImageView alloc] initWithImage:[self.view pw_imageSnapshot]];
    [self performSelectorOnMainThread:@selector(updateMyProgressView:) withObject:[NSNumber numberWithFloat:0.3f] waitUntilDone:YES];

    SCLViewController *rvc = [[SCLViewController alloc] init];
    UIView *destinationView = rvc.view;
    destinationView.frame = CGRectMake(0, 0, kWidthLandscape, kHeightLandscape);

    self.destinationScreenshotView = [[UIImageView alloc] initWithImage:[destinationView pw_imageSnapshot]];

    [self performSelectorOnMainThread:@selector(updateMyProgressView:) withObject:[NSNumber numberWithFloat:0.5f] waitUntilDone:YES];
}

- (void)updateMyProgressView:(NSNumber *)progress
{
    [self.progressBar setProgress:[progress floatValue]];
} 
```

编辑：当然，它不会为您的进度条设置动画（我不知道这是否是您想要的）。如果您希望它在创建视图时继续前进，您应该使用委托来通知进度，这可能会有点困难。这样您就可以在每次通知委托时更新进度条。

# c++ - 转换等轴测坐标

> ID：10161247
> 
> 赞同：2
> 
> 时间：2012-04-15T10:34:21.917
> 
> 标签：c++, ios, cocos2d-x

我决定使用 c++ 和 cocos2d-x 制作一个等距游戏。每个等距图块都有一个 X 和一个 Y 坐标，每移动一个图块就增加 1。这就是我将平铺转换为屏幕坐标的方式。

```
cocos2d::CCPoint WorldPos::convertToScreen(){
    cocos2d::CCPoint posScreen;; 
    posScreen.x=(this->x)*(TILE_WIDTH/2) + (this->y)*-TILE_HEIGHT;
    posScreen.y=(this->x)*(TILE_HEIGHT/2) + (this->y)*(TILE_HEIGHT/2);

    return posScreen;
} 
```

瓷砖都是 40 像素宽和 20 像素高。

现在我需要一个函数将这些世界坐标（等轴坐标）转换回屏幕坐标。就像是

```
WorldPos* WorldPos::convertToWorld(cocos2d::CCPoint &point) 
```

我似乎无法弄清楚这一点，我做错了，我应该做定位是一种不同的方式还是有某种我无法弄清楚的计算？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T10:56:31.300

尝试：

```
WorldPos WorldPos::convertToWorld(cocos2d::CCPoint &point) {
  int x = (point.x + 2*point.y)/40;
  int y = (2*point.y - point.x)/40;
  return WorldPos(x, y);
} 
```

逻辑：

```
Px = 20*Wx - 20*Wy
Py = 10*Wx + 10*Wy, thus

Px + 2*Py = 40*Wx -> Wx = (Px + 2*Py) / 40
Px - 2*Py = -40*Wy -> Wy = (2*Py - Px) / 40 
```

其中`Px`, `Py`, `Wx`,分别 `Wy`是`CCpoint::x`, `CCPoint::y`, `WorldPos::x`, ,`WorldPos.y`

# php - MVC PHP 设计注册表格

> ID：10161251
> 
> 赞同：1
> 
> 时间：2012-04-15T10:35:28.050
> 
> 标签：php, forms, model-view-controller, registration

我正在使用 PHP 中的 MVC 设计模式构建一个简单的用户注册表单。

有人可以建议我是否选择了正确的代码实现区域，因为经过大量阅读后，我知道人们经常以不同的方式解释文档。

我知道这里可能没有正确/错误的答案，但我只是想获得一些关于大多数人将如何实施它的反馈。

非常感谢。

**包含 PDO mysql 插入查询的**模型函数****

 ****使用 PHP 自我操作和控制器**查看HTML 表单标记，包括****

 ****控制器** 数据验证和 php 包含模型功能

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T10:48:02.267

是的，MVC 有不同的方法……除了不应该包含控制器的视图之外，您的概念看起来是正确的。它是包含模型和视图的控制器。此外，我会在模型本身中进行验证。

**模型**：验证函数（如果错误则返回真或假）和插入查询

**视图**：仅包含从控制器传递的数据的 html 表单

**控制器**：主入口点/文件（例如registration.php）

控制器是包含视图和模型的入口点。

基本上在控制器中，

你检查表单是否提交。

如果未提交，则显示视图（即表单）

如果提交了数据，则使用模型的验证功能进行验证。

如果验证成功，请在模型中执行 sql 并重定向到成功页面或显示成功消息。

如果验证不正确，请显示您的视图并使用提交的数据填写您的表单。

但正如我所说，MVC 有不同的方法。例如，您可以在控制器本身而不是您建议的模型中进行所有验证。****

# debugging - 开发者连接代理工具

> ID：10161256
> 
> 赞同：0
> 
> 时间：2012-04-15T10:36:16.137
> 
> 标签：debugging, proxy, web

前段时间我使用了一个工具（我认为它是用 Java 编写的），它有一个通用的“蓝色”主题，并允许抓取传出的 HTTP 请求并根据某些标志/正则表达式更改请求/响应中的值，各种好的网络调试东西。

有谁偶然记得那个工具的名字是什么？:)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T10:54:19.630

以下是两个 HTTP 代理工具，可以满足您的需求；

*   [帕罗斯代理](http://www.parosproxy.org/)
*   [打嗝套房](http://portswigger.net/burp/)

它们都是用 Java 编写的——Paros 是蓝色的，几乎是紫色的。也许这就是你所指的那个？这些天打嗝似乎有点橙色主题:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T13:44:51.447

*Paros多年*未更新。

看看[OWASP Zed Attack Proxy](https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project) - 它是 Paros 的一个分支，完全免费和开源，并且得到了显着增强。

西蒙（ZAP 项目负责人）

# ruby-on-rails-3 - 将机架中间件文件放在 rails 3 的什么位置？

> ID：10161263
> 
> 赞同：2
> 
> 时间：2012-04-15T10:37:29.740
> 
> 标签：ruby-on-rails-3, rack, middleware, rack-middleware

我想在我的 rails 应用程序中使用[这个](https://gist.github.com/206529)机架中间件，遵循[另一个 SO 帖子](https://stackoverflow.com/questions/3428343/where-do-you-put-your-rack-middleware-files-and-requires)上的所有解决方案，但仍然没有运气，继续出现**未初始化的持续**错误。

那么，在 Rails 3.2.3中放置 rack 中间件文件并包含*config.middleware.use的准确位置是什么？*谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T14:37:53.047

我怀疑您收到此错误是因为您在任何地方都不需要该文件。有两种方法可以解决这个问题。

第一个是实际需要定义常量的文件，在`config/application.rb`引用常量之前的位置。

第二个是将`lib`目录添加到`autoload_paths`您的应用程序（[我在此处解释](https://github.com/radar/guides/blob/master/rails-lib-files.md)），以便在引用此常量时，将加载匹配的文件。

你的选择。

# php - 使用现有数据库迁移到 FuelPHP

> ID：10161265
> 
> 赞同：3
> 
> 时间：2012-04-15T10:38:37.397
> 
> 标签：php, codeigniter, orm, fuelphp

我正在从 Codeigniter 迁移到 FuelPHP。我喜欢 Fuel 的 ORM 和其他不错的东西，如果你从头开始创建应用程序，它就足够了。就我而言，我有一个填充的 MySQL 数据库，并且正在寻找一种正确的方法来使用 Fuel 的 ORM 并使用现有的数据库模式和数据生成控制器、模型和视图。FuelPHP 论坛似乎关闭了一段时间，我无法在那里搜索。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T20:34:15.843

石油不能用于对现有数据库进行逆向工程。

但是没有人会阻止您编写自己的任务来执行此操作，或者甚至只是根据现有的表格布局为您生成 oil 命令行。

[例如，此任务](https://github.com/SicoAnimal/fuel-model-generator)可以从现有表生成模型...

# android - 如何在 Android 中安全地存储访问令牌和秘密？

> ID：10161266
> 
> 赞同：138
> 
> 时间：2012-04-15T10:38:38.247
> 
> 标签：android, security, oauth, preferences, token

我将使用 oAuth 从 google 获取邮件和联系人。我不想每次都要求用户登录以获取访问令牌和秘密。据我了解，我需要将它们与我的应用程序一起存储在数据库或`SharedPreferences`. 但我有点担心安全方面的问题。我读到您可以加密和解密令牌，但攻击者很容易只需反编译您的 apk 和类并获取加密密钥。
**在 Android 中安全存储这些令牌的最佳方法是什么？**

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2012-04-15T16:03:52.883

将它们存储为[共享首选项](https://developer.android.com/reference/android/content/SharedPreferences)。这些默认情况下是私有的，其他应用程序无法访问它们。在有根设备上，如果用户明确允许访问某些试图读取它们的应用程序，则该应用程序可能能够使用它们，但您无法防止这种情况发生。至于加密，您必须要求用户每次都输入解密密码（从而破坏了缓存凭据的目的），或者将密钥保存到文件中，您会遇到同样的问题。

存储令牌而不是实际的用户名密码有一些好处：

*   第三方应用程序不需要知道密码，用户可以确保他们只将密码发送到原始站点（Facebook、Twitter、Gmail 等）
*   即使有人窃取了令牌，他们也看不到密码（用户也可能在其他网站上使用该密码）
*   令牌通常有生命周期，并在一定时间后过期
*   如果您怀疑令牌已被泄露，则可以撤销令牌

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2017-03-14T17:09:51.860

您可以将它们存储在[AccountManager](https://developer.android.com/reference/android/accounts/AccountManager.html)中。根据这些人的说法，这被认为是最佳实践。

[![在此处输入图像描述](../Images/d8c29c629020cad8a71ecf292886aaf9.png)](https://i.stack.imgur.com/oT3jR.png)

这是官方定义：

> 此类提供对用户在线帐户的集中注册表的访问。用户为每个帐户输入一次凭据（用户名和密码），通过“一键式”批准授予应用程序访问在线资源的权限。

有关如何使用 AccountManager 的详细指南：

*   [乌迪科恩教程](http://blog.udinic.com/2013/04/24/write-your-own-android-authenticator/)
*   [皮兰尼特博客](http://www.pilanites.com/android-account-manager/)
*   [Google IO 演示文稿](https://www.youtube.com/watch?v=9fBcrzA-hWY)

但是，最终 AccountManager 仅将您的令牌存储为纯文本。所以，我建议在将它们存储在 AccountManager 之前加密你的秘密。您可以使用各种加密库，如[AESCrypt](https://github.com/scottyab/AESCrypt-Android)或[AESCrypto](https://github.com/tozny/java-aes-crypto)

另一种选择是使用[隐藏库](https://github.com/facebookarchive/conceal)。它对 Facebook 来说足够安全，并且比 AccountManager 更容易使用。这是使用 Conceal 保存秘密文件的代码片段。

```
byte[] cipherText = crypto.encrypt(plainText);
byte[] plainText = crypto.decrypt(cipherText); 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2018-03-01T09:13:25.473

SharedPreferences本身[并不是](https://github.com/OWASP/owasp-mstg/blob/master/Document/0x05d-Testing-Data-Storage.md#shared-preferences)一个安全的位置。在有根设备上，我们可以轻松地读取和修改所有应用程序的 SharedPrefereces xml。所以令牌应该相对频繁地过期。但即使令牌每小时过期，更新的令牌仍然可以从 SharedPreferences 中窃取。Android KeyStore 应该用于长期存储和检索加密密钥，这些密钥将用于加密我们的令牌，以便将它们存储在 SharedPreferences 或数据库中。密钥不存储在应用程序的进程中，因此它们[更难](https://developer.android.com/training/articles/keystore.html#SecurityFeatures)被破坏。

比一个地方更重要的是它们本身如何安全，例如使用加密签名的短期 JWT，使用 Android KeyStore 加密它们并使用安全协议发送它们

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-01-04T06:18:30.430

1.  从 Android Studio 的项目窗格中，选择“项目文件”并在项目的根目录中创建一个名为“keystore.properties”的新文件。

[![在此处输入图像描述](../Images/37792739ce17d1c4a57cfb773a14e5f4.png)](https://i.stack.imgur.com/69UJB.png)

2.  打开“keystore.properties”文件并将您的访问令牌和秘密保存在文件中。

[![在此处输入图像描述](../Images/446724b48522077acfc8d3684b1217ff.png)](https://i.stack.imgur.com/y9wld.png)

3.  **现在在您的应用程序**模块的**build.gradle**文件中加载读取访问令牌和秘密。然后，您需要为您的访问令牌和秘密定义 BuildConfig 变量，以便您可以直接从您的代码中访问它们。您的**build.gradle**可能如下所示：

    ```
    ... ... ... 

    android {
        compileSdkVersion 26

        // Load values from keystore.properties file
        def keystorePropertiesFile = rootProject.file("keystore.properties")
        def keystoreProperties = new Properties()
        keystoreProperties.load(new FileInputStream(keystorePropertiesFile))

        defaultConfig {
            applicationId "com.yourdomain.appname"
            minSdkVersion 16
            targetSdkVersion 26
            versionCode 1
            versionName "1.0"
            testInstrumentationRunner "android.support.test.runner.AndroidJUnitRunner"

            // Create BuildConfig variables
            buildConfigField "String", "ACCESS_TOKEN", keystoreProperties["ACCESS_TOKEN"]
            buildConfigField "String", "SECRET", keystoreProperties["SECRET"]
        }
    } 
    ```

4.  您可以在代码中使用您的访问令牌和秘密，如下所示：

    ```
    String accessToken = BuildConfig.ACCESS_TOKEN;
    String secret = BuildConfig.SECRET; 
    ```

这样您就不需要在项目中以纯文本形式存储访问令牌和秘密。因此，即使有人反编译了您的 APK，当您从外部文件加载它们时，他们也永远不会获得您的访问令牌和秘密。

# facebook - Facebook Like 和 Share Iframe 位于内容下方

> ID：10161269
> 
> 赞同：0
> 
> 时间：2012-04-15T10:39:11.563
> 
> 标签：facebook

我有以下[网站](http://www.wettgutschein.de/index.php/en/)，我只是添加了 facebook 的点赞按钮，但是点击点赞按钮后，iframe 会出现在内容下方。我还添加了 google 分享，效果很好。喜欢/发送按钮可能有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T10:46:49.797

也许是因为在您的 CSS 中，您`overflow:hidden`的`#maincolumn_middle`. 它将隐藏其中的任何元素，包括弹出的 iframe 窗口。删除`overflow:hidden`将显示它。

# html - 带有 html 页面的 Web 存储

> ID：10161270
> 
> 赞同：0
> 
> 时间：2012-04-15T10:39:19.387
> 
> 标签：html, web-storage

我创建了多个 html 页面，我需要像在 HTML5 中一样使用会话存储（Web 存储）来存储这些页面。我不是很清楚它是什么以及如何实现它。请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T10:42:31.827

使用[Web Storage](http://dev.w3.org/html5/webstorage/)，您可以在浏览器中保存数据。如文档中所述，有几个可用的存储位置可以通过 javascript 界面访问。

您选择的接口（sessionStorage、localStorage）取决于数据的生命周期。例如，您是否需要数据仅在会话打开（用户已登录）时可用？或者您是否也想保存数据以供以后访问？

需要记住的重要一点是旧版浏览器不支持此功能，因此尤其是旧版 IE 浏览器将无法保存数据。

这是使用 localStorage 的示例（根据您在下面的评论，这应该适合您）：

```
//save data
localStorage.setItem("indexName","Hello World");

//retrieve data
var value=localStorage.getItem("indexName"); 
```

您可以在文档的 beforeunload 事件中使用它来在页面关闭之前保存数据。

# c# - 菜单工具条悬停启用？

> ID：10161274
> 
> 赞同：-1
> 
> 时间：2012-04-15T10:39:47.940
> 
> 标签：c#, winforms, c#-4.0, toolstrip

我在表单中使用了菜单工具条！我希望当我的光标悬停在菜单上时下拉菜单！这该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-15T14:02:53.687

您可以尝试使用`MouseHover`菜单项的事件：

```
public Form1() {
  InitializeComponent();
  fileToolStripMenuItem.MouseHover += fileToolStripMenuItem_MouseHover;
}

private void fileToolStripMenuItem_MouseHover(object sender, EventArgs e) {
  fileToolStripMenuItem.ShowDropDown();
} 
```

或 lambda 版本：

```
public Form1() {
  InitializeComponent();
  fileToolStripMenuItem.MouseHover += (s, e) => fileToolStripMenuItem.ShowDropDown();
} 
```

# c# - 是否可以使字体可缩放？

> ID：10161279
> 
> 赞同：1
> 
> 时间：2012-04-15T10:40:04.167
> 
> 标签：c#, .net, wpf, fonts, scaling

我所有的网格可能很小也可能很大，具体取决于窗口大小，但里面的文本在大网格大小上看起来非常小。

我目前的想法（但我还不知道如何实现）是将所有 Grid 元素绑定为单一字体，然后通过

```
override void OnRender(DrawingContext dc) { 
```

取决于窗口大小。

问题是：这个想法是否合理，还有其他方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T10:50:05.980

如果您没有明确设置内部元素的字体，它们会继承父字体。因此，您可以更改其中一个父元素（例如`Window`自身或`Grid`）的字体大小。这会更改所有未明确指定字体大小的内部元素的字体大小。

但是，如果您的字体应该具有不同的大小，我认为最好的解决方案是将元素的字体大小绑定到父窗口的字体大小，并使用值转换器对字体大小进行缩放：

像这样定义一个值转换器：

```
using System;
using System.Windows.Data;

namespace WPFTest
{
    public class FontSizeConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            if (value == null)
                return null;
            double windowFontSize = (double)value;
            var scale = System.Convert.ToDouble(parameter);
            return windowFontSize * scale;
        }

        public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    }
} 
```

并在您的 xaml 中使用它：

```
<Window x:Class="WPFTest.Window1"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:test="clr-namespace:WPFTest"
        Title="Window1" Height="300" Width="300" FontSize="20" x:Name="window1">
    <Window.Resources>
        <test:FontSizeConverter x:Key="fontSizeConverter"/>
    </Window.Resources>
    <Grid>
        <StackPanel Grid.Row="0" Grid.Column="0">
            <TextBlock
                FontSize="{Binding ElementName=window1, Path=FontSize, Converter={StaticResource ResourceKey=fontSizeConverter}, ConverterParameter=1.5}">
                Text 1
            </TextBlock>
            <TextBlock FontSize="{Binding ElementName=window1, Path=FontSize, Converter={StaticResource ResourceKey=fontSizeConverter}, ConverterParameter=0.7}">
                Text 2
            </TextBlock>
            <TextBlock >Text 3</TextBlock>
        </StackPanel>
    </Grid>
</Window> 
```

`ConverterParameter`用作与窗口相关的元素字体的比例（在`ElementName`绑定的属性中指定）。

在此示例中，第一个字体`TextBlock`是窗口字体的 150%，第二个字体是窗口字体的`TextBlock`70%。第三个`TextBlock`跟随窗口的字体大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T12:51:43.087

我更喜欢 roberther 建议的这个解决方案。它更加简洁和干净。

```
<Viewbox>
    <TextBlock Text="Hello World" />
</Viewbox> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-07T22:39:48.093

我知道这是一篇旧帖子，但这是我搜索该主题时首先出现的内容之一，所以这是我的解决方案：

我最近在一个项目中完成了这项工作，用于处理文本框并相对于屏幕缩放其内容字体大小。为此，我设置了一个整数值并绑定了字体大小。

在我的例子中，我的屏幕高度从 800x650 开始，我希望我的字体默认大小为 12，因此我将整数值 (_ScaledFontSize) 设置为 WindowHeight/(650/12)。

每次屏幕大小改变时，都会调用一个函数来重新计算字体大小，并调用一个属性更改事件。在这个函数中，您可以使用简单的方法为最小和最大字体大小添加约束，例如：

```
//Set a minimum font size
if(_ScaledFontSize < 12)
    _ScaledFontSize = 12; 
```

为了强制执行此缩放大小，您想要缩放字体大小的每个控件都必须绑定到 ScaledFontSize 属性。

**最后结果：**

[应用程序启动时的文本](https://i.stack.imgur.com/VfKUi.png)

[大约 1920x1080 的文字（略小，因为不是全屏）](https://i.stack.imgur.com/FtwqM.png)

我一直在努力寻找这样的东西，最后这就是我的选择。幸运的是，代码非常简单： **MainWindow.xaml.cs：**

```
using System.Windows;
using System.ComponentModel;

namespace FontScaling
{
    public partial class MainWindow : Window, INotifyPropertyChanged
    {
        public event System.ComponentModel.PropertyChangedEventHandler PropertyChanged;

        private int _ScaledFontSize;

        public int ScaledFontSize
        {
            get => _ScaledFontSize;
            set => _ScaledFontSize = value;
        }

        public void PropChange(string name)
        {
            System.ComponentModel.PropertyChangedEventArgs propertyChangedEvt = new System.ComponentModel.PropertyChangedEventArgs(name);

            if (PropertyChanged != null)
            {
                PropertyChanged.Invoke(this, propertyChangedEvt);
            }

        }
        public MainWindow()
        {
            InitializeComponent();
            _ScaledFontSize = (int)Application.Current.MainWindow.Height / 54;
        }

        private void Window_SizeChanged(object sender, SizeChangedEventArgs e)
        {
            _ScaledFontSize = (int)Application.Current.MainWindow.ActualHeight / 54;
            PropChange("ScaledFontSize");
        }
    }
} 
```

**MainWindow.xaml：**

```
<Window x:Class="FontScaling.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:FontScaling"
        mc:Ignorable="d"
        Title="MainWindow" Height="650" Width="800"
        SizeChanged="Window_SizeChanged"
        Name="_This">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="10*"/>
            <RowDefinition Height="10*"/>
            <RowDefinition Height="10*"/>
            <RowDefinition Height="200*"/>
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="15*"/>
            <ColumnDefinition Width="10*"/>
            <ColumnDefinition Width="1*"/>
            <ColumnDefinition Width="10*"/>
            <ColumnDefinition Width="15*"/>
        </Grid.ColumnDefinitions>

        <TextBlock 
            VerticalAlignment="Bottom"
            Grid.Row="1"
            Grid.Column="1"
            Text="Non Scaled TextBlock"/>
        <TextBox 
            Grid.Row="2"
            Grid.Column="1" 
            Text="Non Scaled Text"/>

        <TextBlock
            VerticalAlignment="Bottom"
            Grid.Row="1"
            Grid.Column="3" 
            Text="Scaled TextBlock"
            FontSize="{Binding ScaledFontSize, ElementName=_This}"/>
        <TextBox 
            Grid.Row="2" 
            Grid.Column="3" 
            Text="Scaled TextBox"
            FontSize="{Binding ScaledFontSize, ElementName=_This}"/>
    </Grid>
</Window> 
```

# opengl - 什么更快？帧缓冲颜色附件或全屏纹理四边形？

> ID：10161280
> 
> 赞同：0
> 
> 时间：2012-04-15T10:40:54.013
> 
> 标签：opengl, opengl-es, textures, framebuffer

我想绘制一个序列的全屏帧，并在它们之间快速切换。我看到我可以将多种颜色的附件附加到帧缓冲区。

我想知道使用渲染缓冲区附件而不是当前的纹理四边形方法是否会便宜得多。

顺便说一下，如何在附件之间切换？附件数量是否有上限？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T13:08:00.633

> 我想绘制一个序列的全屏帧，并在它们之间快速切换。

绘制图像总是意味着将数据上传到纹理并使用该纹理绘制四边形。查看 Pixel Buffer Objects 以实现异步数据上传和 glTexStorage（OpenGL-4.2 功能），了解如何固定内存布局。

> 我看到我可以将多种颜色的附件附加到帧缓冲区。

这适用的帧缓冲区是屏幕外帧缓冲区对象，而不是屏幕上帧缓冲区。即这不会以任何方式帮助你。

# java - 为什么在java中没有办法通过引用传递

> ID：10161282
> 
> 赞同：-2
> 
> 时间：2012-04-15T08:42:25.553
> 
> 标签：java

我猜java没有“按引用传递”选项。但是为什么呢？因为有时它是非常需要的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-15T09:32:18.703

任何时候你觉得需要通过引用传递一个值，而不是通过值传递一个引用。虽然 Java 没有“按引用传递”机制，但它确实有引用。所以只需按值传递这些引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T10:33:19.393

我想您真正需要通过引用传递的唯一地方是从函数中返回多个值，例如`out`C 中的关键字。要在 Java 中执行此操作，您可以创建一个类来保存对象或使用许多提供的现有 Pair 类图书馆。

同样，您可以传递一个引用其他内容的存根对象，然后您可以更改对象中的引用并查看它在外部的反映：

```
public static class Holder<T> {
    public T value;

    public Holder(T value) {
        this.value = value;
    }
}

private Holder<Object> itsValueCanBeSeenAsPassedByReferencce
= new Holder<Object>("a");

public void doSomething(Holder<Object> holder) {
    holder.value = "b";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T06:33:26.923

在Java 中，无论您传递什么类型的参数，相应的参数（原始变量或对象引用）都会得到该数据的副本，这正是按值传递（即按值复制）的工作原理。在 Java 中，如果调用方法将对象的引用作为参数传递给被调用方法，则传入的引用首先被复制，然后传递给被调用方法。传入的原始引用和复制的引用都将指向同一个对象。因此，无论您使用哪个引用，您都将始终修改相同的原始对象，这也是传递引用的工作方式。

# html - HTML 相对居中对齐

> ID：10161285
> 
> 赞同：4
> 
> 时间：2012-04-15T10:41:43.827
> 
> 标签：html, css, center, alignment

我正在尝试使用 div 和 CSS 类将图像居中对齐（标签包含在 div class="center" 标签中）。我目前使用的是在 Dreamweaver 中工作（当我进入设计视图时），但不是在我在 Safari 中加载页面时。这是我的代码：

```
.center {
  display:inline; 
  text-align:center; 
  -webkit-inline; 
  -webkit-center; 
  background-color:transparent;
} 
```

很抱歉问了这么简单的问题，我对 HTML 完全陌生，我的经验是在 Objective-C 中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-15T10:51:26.587

`text-align: center`导致内容居中（在容器内），而不是容器本身居中。

既然你使用`display: inline`了，容器的大小就会和里面的内容一样，居中不会有你想要的效果。

要么，您使用 使`margin: 0 auto`容器居中（朝向其父容器），或者您更改`display: inline`为`display: block`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-15T10:44:19.613

给`text-align:center;`它的`.center`父 DIV。像这样写：

**HTML**

```
<div class="parent">
 <div class="center"></div>
</div> 
```

**CSS**

```
.parent{
 text-align:center;
}

.center {
 display:inline;
 background-color:transparent;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-15T22:14:15.117

您可以使用 margin : 0 auto 来进行垂直对齐，但是如果您想要垂直水平对齐，则需要这样的代码：

```
.center{
width:200px;
height:200px;
margin-left:-100px;
margin-top:-200px;
position:absolute;
top :50%;
left:50%;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-15T10:48:26.403

边距：0 自动。是你要找的。你还需要一个宽度。

div.center { 边距：0 自动；宽度：20%；背景：橙色；}

# c# - 生成随机mac地址

> ID：10161291
> 
> 赞同：6
> 
> 时间：2012-04-15T10:42:34.353
> 
> 标签：c#, networking

我正在寻找 C# 中生成随机 MAC 号的方法。谷歌在那个方面相当薄弱。

多谢

**解决方案：**

在 Yahia 的帮助下，我能够编写以下解决方案。再次感谢！

```
public static string GenerateMACAddress()
    {
        var sBuilder = new StringBuilder();
        var r = new Random();
        int number;
        byte b;
        for (int i = 0; i < 6; i++)
        {
            number = r.Next(0, 255);
            b = Convert.ToByte(number);
            if (i == 0)
            {
                b = setBit(b, 6); //--> set locally administered
                b = unsetBit(b, 7); // --> set unicast 
            }
            sBuilder.Append(number.ToString("X2"));
        }
        return sBuilder.ToString().ToUpper();
    }

    private static byte setBit(byte b, int BitNumber)
    {
        if (BitNumber < 8 && BitNumber > -1)
        {
            return (byte)(b | (byte)(0x01 << BitNumber));
        }
        else
        {
            throw new InvalidOperationException(
            "Der Wert für BitNumber " + BitNumber.ToString() + " war nicht im zulässigen Bereich! (BitNumber = (min)0 - (max)7)");
        }
    }

    private static byte unsetBit(byte b, int BitNumber)
    {
        if (BitNumber < 8 && BitNumber > -1)
        {
            return (byte)(b | (byte)(0x00 << BitNumber));
        }
        else
        {
            throw new InvalidOperationException(
            "Der Wert für BitNumber " + BitNumber.ToString() + " war nicht im zulässigen Bereich! (BitNumber = (min)0 - (max)7)");
        }
    } 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-10-31T00:01:36.213

一个稍微不那么冗长的解决方案（我认为仍然可以达到相同的结果）：

```
public static string GetRandomMacAddress()
{
    var random = new Random();
    var buffer = new byte[6];
    random.NextBytes(buffer);
    var result = String.Concat(buffer.Select(x => string.Format("{0}:", x.ToString("X2"))).ToArray());
    return result.TrimEnd(':');
} 
```

这给出了一个格式化的 MAC，如果需要未格式化，则删除 string.Format 和 Trim

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-15T10:49:00.740

.NET 框架中没有这样的方法...

您需要自己编写一个 - 阅读[格式说明](http://en.wikipedia.org/wiki/MAC_address)，使用[随机生成器](http://msdn.microsoft.com/en-us/library/system.random.aspx)获取 0 到 255 之间的 6 个随机数，根据需要设置 2 个相关位（用于全局唯一/本地管理），然后[将数字转换为十六进制](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx#XFormatString)（即`X2`，每个数字 2 位，左侧填充 0）并将[它们连接在一起`:`作为分隔符](http://msdn.microsoft.com/en-us/library/57a79xd0.aspx)...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-22T22:15:19.897

MUG4N 的解决方案有问题。您必须调整最低有效两位而不是最高有效两位。

所以而不是

```
b = setBit(b, 6); //--> set locally administered
b = unsetBit(b, 7); // --> set unicast 
```

它应该是

```
b = setBit(b, 1); //--> set locally administered
b = unsetBit(b, 0); // --> set unicast 
```

也是`unsetBit()`不正确的。相关行应该是

```
return unchecked((byte)(b & (byte)~(0x01 << BitNumber))); 
```

当然，将其更改为这样可能会更简单：

```
if (i == 0)
{
    b = (byte)((b & 0xFE) | 0x02) //-->set locally administered and unicast
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-05T07:19:40.683

为您在为 Wifi 适配器生成新 MAC 地址时遇到问题的人提供小更新。您只需要将 MAC 地址的第一个八位字节设置为“02”，而不是通常设置为“00”。设置第一个八位字节“02”实际上设置了 b2 位，指示 MAC 地址是本地管理的。

[![在此处输入图像描述](../Images/fbe3954527e852f2a123053a6a1d700e.png)](https://i.stack.imgur.com/C9XFy.png)

您可以在这里阅读更多相关信息：http: [//blog.technitium.com/2011/05/tmac-issue-with-wireless-network.html](http://blog.technitium.com/2011/05/tmac-issue-with-wireless-network.html)

代码：

```
public static string GetRandomWifiMacAddress()
{
    var random = new Random();
    var buffer = new byte[6];
    random.NextBytes(buffer);
    buffer[0] = 02;
    var result = string.Concat(buffer.Select(x => string.Format("{0}", x.ToString("X2"))).ToArray());
    return result;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-12-14T08:49:08.940

这是一个生成随机mac的助手类。

```
public static class MacAddress
{
    private static readonly Random Random = new Random();

    public static string GetSignatureRandomMac(string generic = "AA")
    {
        string[] macBytes = new[]
        {
            generic,
            generic,
            generic,
            Random.Next(1, 256).ToString("X"),
            Random.Next(1, 256).ToString("X"),
            Random.Next(1, 256).ToString("X")
        };

        return string.Join("-", macBytes);
    }

    public static string GetRandomMac()
    {
        string[] macBytes = new[]
        {
            Random.Next(1, 256).ToString("X"),
            Random.Next(1, 256).ToString("X"),
            Random.Next(1, 256).ToString("X"),
            Random.Next(1, 256).ToString("X"),
            Random.Next(1, 256).ToString("X"),
            Random.Next(1, 256).ToString("X")
        };

        return string.Join("-", macBytes);
    }
} 
```

用法：

```
Console.WriteLine(MacAddress.GetRandomMac());
Console.WriteLine(MacAddress.GetSignatureRandomMac());
Console.WriteLine(MacAddress.GetSignatureRandomMac("BB")); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-03-02T03:07:28.633

我们可以生成一个随机数，并且我们可以使用按位运算符仅修改第一个字节的最后 2 位：

```
 public string GetRandomWifiMacAddress()
    {
        var random = new Random();
        var buffer = new byte[6];
        random.NextBytes(buffer);
        buffer[0] &= 0b11111110;
        buffer[0] |= 0b00000010;
        var result = string.Concat(buffer.Select(x => string.Format("{0}", x.ToString("X2"))).ToArray());
        return result;
    } 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-04-15T10:49:01.600

.NET 中没有生成 MAC 地址的功能。它必须写出来。

MAC 地址通常是唯一的，由 NIC 的 OEM 设置。不同的制造有一定的分配前缀。可以在此处找到示例列表；[https://code.wireshark.org/review/gitweb?p=wireshark.git;a=blob_plain;f=manuf](https://code.wireshark.org/review/gitweb?p=wireshark.git;a=blob_plain;f=manuf)

在我的脑海中，我不知道存在任何用于生成 MAC 地址的库（因为这不是一个常见的要求），但是创建一个库并不难，因为地址只是 6 个十六进制值00 到 FF 用冒号隔开。

# apache - 在 Web 服务器文件夹上使用“chown apache”时出现“无效参数”错误

> ID：10161297
> 
> 赞同：0
> 
> 时间：2012-04-15T10:43:40.797
> 
> 标签：apache, chown

执行时在终端的 mac 上：

```
chown apache uploads/ 
```

我得到错误：

```
chown: apache: Invalid argument 
```

饲料位于共享的 Web 服务器上。我需要更改文件夹的所有者，否则我用于创建简单文本文件的 PHP 脚本将返回权限被拒绝错误。请不要建议将文件夹更改为 777（这确实有效），因为几乎所有建议都反对它。

服务器是否有可能不以用户“apache”的身份运行脚本？我怎样才能找到这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T10:46:36.450

您可能需要检查两件事：

1) 有用户叫`apache`吗？也许是`httpd`。你可以搜索`/etc/passwd`。（或者无论你的平台使用什么来存储用户名，你都没有提到你的操作系统。）

2) 脚本以什么用户身份运行？您可以通过运行测试脚本来检查这一点。例如：

```
 #/bin/bash
 echo Content-Type: text/plain
 echo
 id -a 
```

如果你`test.cgi`把它保存为 CGI 目录，你应该能够运行它并让它告诉你它以什么用户身份运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T10:49:26.180

“无效参数”让我认为该目录位于禁用所有者的 HFS+ 卷上；在这种情况下，您将无法更改它。您也许可以打开所有者，但可能需要重新格式化。

（在 OS X 上检查的建议`/etc/passwd`是错误的，或者至少是不准确的；你需要`dscl . list /Users`。）

# php - 在 ZF 中的其他控制器之间共享通用控制器操作很热门吗？

> ID：10161302
> 
> 赞同：0
> 
> 时间：2012-04-15T10:44:49.330
> 
> 标签：php, zend-framework

假设我有一个控制器来处理我的应用程序中的登录/注册/密码恢复等。我想在不同的模块和控制器之间共享它。最好的方法是什么？

我应该做一个动作助手，还是使用继承？当然，我不是指这些动作的逻辑，它们是由模型实现的（每个模块都不同），我只是想共享通用参数、解释并将结果传递给视图。

我的目标是为我的项目中的那些东西做某种通用库。所以我会有一些抽象的用户模型，所有其他想要使用登录/注册功能的模型都将从中继承，但我想知道控制器的东西是什么。

任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T12:00:57.073

基本上我认为您要创建的是 widgets 。[这是 ZF 团队负责人http://weierophinney.net/matthew/archives/246-Using-Action-Helpers-To-Implement-Re-Usable-Widgets.html](http://weierophinney.net/matthew/archives/246-Using-Action-Helpers-To-Implement-Re-Usable-Widgets.html)的一篇很棒的文章如何使用动作助手创建它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T05:45:53.340

创建可重用的身份验证服务是您想要做的。将其创建为服务允许您单独测试它。将服务注入前端控制器插件，以便在每个请求期间运行它。实际检查可以封装到自定义验证器中，因此您可以简单地调用 ->isValid()。如果无效，请重新路由到登录页面。

# php - 为什么这些代码片段有风险？（SQL 注入）

> ID：10161303
> 
> 赞同：-1
> 
> 时间：2012-04-15T10:45:08.447
> 
> 标签：php, mysql, sql

```
 1\. 

    ' union select 1, 'users (user, password) values (\'haxor\',
            \'1337\') #', 2 #

 2\. 

    ' union select 1, 'modules (plugin) values (\'if
       (isset($_GET[\\\'cmd\\\'])) {passthru($_GET[\\\'cmd\\\']);}\') #', 2
       # 
```

*   这些代码片段是做什么的？
*   如何防止它们出现在我的`php`文件中？
*   什么是1337？为什么有很多 \ ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T11:05:09.650

> 这些代码是做什么的？

好吧，这取决于具体情况，但从外观上看，第一个代码是试图绕过登录系统。第二个将允许黑客在服务器上执行命令并将输出直接显示回浏览器。

PHP 的文档：http `passthru()`: [//php.net/manual/en/function.passthru.php](http://php.net/manual/en/function.passthru.php)

> 如何防止它们出现在我的 php 文件中？

有很多方法可以防止 SQL 注入。最推荐的一种是使用 PDO 库或 MySQLi 并利用准备好的语句。

> 什么是1337？为什么有很多 \ ？

取自 Urban Dictionary（来源：[http](http://www.urbandictionary.com/define.php?term=1337) ://www.urbandictionary.com/define.php?term=1337 ）

> > leet 或精英的黑客“Sp33k”。源自黑客组织 Dead Cow Cult 使用的 UDP 端口 31337 “eleet”，以使用臭名昭著的黑客程序 Back Orifice 访问 Windows 95。

反斜杠用于转义特殊字符。查看此 WikiPedia 文章了解更多详细信息： [http ://en.wikipedia.org/wiki/Escape_character](http://en.wikipedia.org/wiki/Escape_character)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T10:50:40.800

启动 SQL 注入的示例的主要部分是开头的 '。它会更改您的服务器读取的查询。

清理所有用户输入非常重要。

# plot - 如何创建带有最大值的滑块的图？

> ID：10161305
> 
> 赞同：4
> 
> 时间：2012-04-15T10:45:19.143
> 
> 标签：plot, slider, maxima

为了说明具有无限系列解决方案的一阶 ode 的柯西问题，我将绘制参数化解决方案并有可能通过滑块控制参数值。

完整的柯西问题是y'=sqrt(|y|), y(0)=0, 参数解是y_c(x):={0, if c=>x; (xc)^2/4，如果 x=>c}。
所以我会用一个滑块来绘制 y=y_c(x) 来控制 c 的值。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-12-22T12:24:52.013

您可以在 wxMaxima 中使用 with_slider_draw 来执行此操作。

```
 Y(c,x) := if c>x then 0 else (x-c)^2/4;
   with_slider_draw(
       c, /* the name of the variable to attach to the slider */
       makelist(i,i,0,1,0.1), /* a list of values that the variable can have */
       explicit(Y(c,x), x, 0, 2) /* plot the function */
   )$ 
```

在 wxMaxima 中，点击图形，然后点击工具栏上的 Play 按钮播放动画，或者使用工具栏上的滑块改变 c 的值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-15T15:58:34.673

您可以在[Sage 笔记本](http://www.sagemath.org)中使用 Maxima并使用[交互命令](http://wiki.sagemath.org/interact)。另请参阅[Sage 与 Maxima 的接口](http://sagemath.org/doc/reference/sage/interfaces/maxima.html)。

# php - 从 wordpress 中的自定义 $_GET 变量中清除 URL

> ID：10161306
> 
> 赞同：0
> 
> 时间：2012-04-15T10:45:25.063
> 
> 标签：php, wordpress, .htaccess, mod-rewrite

我正在使用 wordpress 漂亮的永久链接，我的 .htaccess 文件如下所示：

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /nafham/
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /nafham/index.php [L]
</IfModule>

# END WordPress 
```

我正在使用一种显示带有 url 变量的索引页面的表单，如下所示：

```
http://www.nafham.com/?edu_year_selectionreal=79&semester_selectionreal=15&subject_selectionreal=80 
```

我想让网址显示如下：

```
http://www.nafham.com/79/15/80 
```

有可能这样做吗？为了不让wordpress已经应用的重写条件出错，最好的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T10:53:50.933

因为您已经设置了重写，所以您需要做的就是解析 index.php 中的 url

```
if (preg_match("#(\d+)/(\d+)/(\d+)#", $_SERVER['REQUEST_URI'], $regs)) {

    $edu_year_selection_real = $regs[1]
    $semester_selectionreal = $regs[2];
    $subject_selectionreal = $regs[3];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T10:57:49.403

添 像这样到.htaccess：

```
RewriteRule ^/([0-9-]+)/([0-9-]+)/([0-9-]+)$ index.php?var1=$1&var2=($2)&var3=($3) [L] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T13:59:15.587

您需要在 Wordpress 中设置自定义重写规则，否则 Wordpress 会将您带到错误页面。

这是设置自定义重写规则的示例：

```
 <?php

  add_filter('rewrite_rules_array', 'insert_custom_rules');
  function insert_custom_rules($rules)
  {
$newrules = array();
$newrules['(.+?)/(.+?)/(.+?)/?$'] =
'index.php?edu_year_selectionreal=$matches[1]&semester_selectionreal=$matches[2]&subject_selectionreal=$matches[3]';
return $newrules + $rules;
  }
  ?> 
```

希望这会有所帮助。

# php - mysql update 语句给了我一个错误

> ID：10161309
> 
> 赞同：0
> 
> 时间：2012-04-15T10:45:31.960
> 
> 标签：php, mysql

我正在尝试一次更新多个列：

```
 $query="UPDATE search_page
     SET search_page_description='".$search_page_description."',
     SET title='".$title."',
     SET h1='".$h1."',
     SET meta_description='".$metadata."'
     WHERE features_id=".$id;
     $result_update_query=databaseConn :: dbDelta($query); 
```

我明白了：

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SET title='fasdf', SET h1='fasdfas', SET meta_description='fas' at line 3 
```

我的代码哪里出错了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-15T10:46:48.493

您只需要一个`SET`关键字

```
 $query="UPDATE search_page
     SET search_page_description='".$search_page_description."',
     title='".$title."',
     h1='".$h1."',
     meta_description='".$metadata."'
     WHERE features_id=".$id;
     $result_update_query=databaseConn :: dbDelta($query); 
```

见参考：[http ://dev.mysql.com/doc/refman/5.5/en/update.html](http://dev.mysql.com/doc/refman/5.5/en/update.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T10:48:39.473

错误显示第 3 行：

> "SET title='".$title."',"

问题是这一行包含一个不期望的“SET”关键字。

```
 $query="UPDATE search_page
 SET search_page_description='".$search_page_description."',
 title='".$title."',
 h1='".$h1."',
 meta_description='".$metadata."'
 WHERE features_id=".$id;
 $result_update_query=databaseConn :: dbDelta($query); 
```

请参阅[MySQL 参考](http://dev.mysql.com/doc/refman/5.5/en/update.html)或尝试[SQL UPDATE 语句](http://www.w3schools.com/sql/sql_update.asp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-15T10:48:55.710

试试这些：

```
>   $query="UPDATE search_page
>      SET search_page_description='".$search_page_description."',
>      title='".$title."',
>      h1='".$h1."',
>      meta_description='".$metadata."'
>      WHERE features_id=".$id;
>      $result_update_query=databaseConn :: dbDelta($query); 
```

# python - 生菜：在场景大纲之前运行代码

> ID：10161319
> 
> 赞同：3
> 
> 时间：2012-04-15T10:46:52.487
> 
> 标签：python, testing, scenarios, lettuce

我将生菜 0.1.35 与 Python 2.6 一起使用，我注意到当我定义场景大纲时，使用`@lettuce.before.each_scenario`装饰器定义的代码不会在场景大纲的每个实例之前运行 - 当我将每个场景定义重复为不同的场景时，这代码运行。

如何在同一场景大纲定义的每个场景之间运行一些代码？

# java - 是否可以通过 JPA 和 CriteriaBuilder 的复合键进行排序

> ID：10161320
> 
> 赞同：5
> 
> 时间：2012-04-15T10:46:57.303
> 
> 标签：java, jpa, criteria-api

我想使用 JPA CriteriaBuilder 创建一个查询，并且我想添加一个`ORDER BY`子句。这是我的实体：

```
@Entity
@Table(name = "brands")
public class Brand implements Serializable {

    public enum OwnModeType {
        OWNER, LICENCED
    }

    @EmbeddedId
    private IdBrand id;
    private String code;
    //bunch of other properties
} 
```

嵌入式类是：

```
@Embeddable
public class IdBrand implements Serializable {

    @ManyToOne
    private Edition edition;
    private String name;
} 
```

我构建查询的方式是这样的：

```
CriteriaBuilder cb = em.getCriteriaBuilder();
CriteriaQuery<Brand> q = cb.createQuery(Brand.class).distinct(true);
Root<Brand> root = q.from(Brand.class);
if (f != null) {
    f.addCriteria(cb, q, root);
    f.addOrder(cb, q, root, sortCol, ascending);
}
return em.createQuery(q).getResultList(); 
```

这里是调用的函数：

```
public void addCriteria(CriteriaBuilder cb, CriteriaQuery<?> q, Root<Brand> r) {
}

public void addOrder(CriteriaBuilder cb, CriteriaQuery<?> q, Root<Brand> r, String sortCol, boolean ascending) {
    if (ascending) {
        q.orderBy(cb.asc(r.get(sortCol)));
    } else {
        q.orderBy(cb.desc(r.get(sortCol)));
    }
} 
```

如果我尝试设置`sortCol`为类似`"id.name"`我收到以下错误：

> javax.ejb.EJBException：java.lang.IllegalArgumentException：无法针对路径解析属性 [id.name]

知道我怎么能做到这一点吗？我试着在网上搜索，但我找不到关于这个的提示......如果我能`ORDER BY`在有`@ManyToOne`关系时做类似的事情也会很棒（例如，`"id.edition.number"`）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T13:39:39.880

**问题是**您对 JPA 路径使用的理解。[JPA 手册](http://www.objectdb.com/java/jpa)说：

> 可以通过重用点 (.) 运算符进一步扩展其类型为可持久用户类的路径表达式。例如，c.capital.name 是一个嵌套路径表达式，它从 Capital 实体对象延续到其名称字段。**仅当路径表达式的类型也是用户定义的可持久类时，才能进一步扩展路径表达式。**点 (.) 运算符不能应用于简单类型（数字、布尔值、字符串、日期）的集合、映射和值。

在您的情况下，您使用了 id.edition.number，其中**IdBrand (id) 不是用户可持久类。**

**解决方案是以**这种方式构建路径表达式：`root.get("id").get("edition.number");`

* * *

为避免此类问题，您可以编写一个路径构建器，它基于`javax.persistence.metamodel.Attribute.PersistentAttributeType`将决定路径的构建方式。对于基本元素 - 使用 .get()，对于集合元素使用 .join()。

为了让您了解您的错误，您需要阅读有关 JPA 路径的更多信息。[这是一本关于 JPA 路径的好手册](http://www.objectdb.com/java/jpa/query/jpql/path#Navigation_through_Path_Expressions_)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T11:26:47.370

我实际上在另一个类似问题上找到了答案：[JPA - Criteria API and EmbeddedId](https://stackoverflow.com/questions/4084431/jpa-criteria-api-and-embeddedid)

这是我修复代码的方法：

```
public void addOrder(CriteriaBuilder cb, CriteriaQuery<?> q, Root<Brand> r, String sortCol, boolean ascending) {
    Path<?> p = r;
    String []sortCols = sortCol.split("\\."); // This is a regexp, hence the escape backslash
    for(String sc: sortCols) {
        p = p.get(sc);
    }
    if (ascending) {
        q.orderBy(cb.asc(p));
    } else {
        q.orderBy(cb.desc(p));
    }
} 
```

# .net - VB表单验证问题

> ID：10161321
> 
> 赞同：-1
> 
> 时间：2012-04-15T10:47:15.867
> 
> 标签：.net, vb.net, winforms, validation, focus

我在 VB 中进行表单验证，我使用`txtName_LostFocus`函数验证文本字段数据，并在错误输入时使用`txtName.Focus()`. 这对我来说很有用。但问题是，至于用户没有输入有效文本，我的退出按钮也不起作用。是否有任何解决方案来纠正此解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T10:58:33.543

您遇到的问题是由于没有仔细阅读文档造成的。该[`LostFocus`事件](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.lostfocus.aspx)的文档非常清楚地表明，您不应*尝试*在此事件的处理程序方法中设置焦点（例如，通过调用[`Focus`method ）：](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.focus.aspx)

> **警告**
> 
> 不要尝试从 Enter、GotFocus、Leave、LostFocus、Validating 或 Validated 事件处理程序中设置焦点。这样做可能会导致您的应用程序或操作系统停止响应。有关详细信息，请参阅“键盘输入参考”部分中的主题，以及位于[http://msdn.microsoft.com/library](http://msdn.microsoft.com/library)`WM_KILLFOCUS`的 MSDN 库中“关于消息和消息队列”主题的“消息死锁”部分。

更好的解决方案是处理[`Validating`事件](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.validating.aspx)。您将在`Validating`由 .NET Framework 自动引发的事件处理程序方法中执行输入验证。

如果输入有效，则您什么也不做。如果输入*无效*，则将参数的`Cancel`属性设置为，从而抑制所有下游事件。`CancelEventArgs``true`

```
Private Sub myTextBox_Validating(ByVal sender As Object, _
                                 ByVal e As ComponentModel.CancelEventArgs) _
                             Handles myTextBox.Validating
    If Not Valid(myTextBox.Text) Then
        ' Validation failed, so cancel the event and pre-select the text.
        e.Cancel = True
        myTextBox.Select(0, myTextBox.Text.Length)

        ' Optionally (but recommended): Set an ErrorProvider control.
        ' errorProvider.SetError(myTextBox, "Invalid input")
    End If
End Sub 
```

# node.js - 用户会话管理nodejs

> ID：10161322
> 
> 赞同：1
> 
> 时间：2012-04-15T10:47:16.370
> 
> 标签：node.js, session, client-server, restful-authentication, express

我一直在尝试了解 nodeJS 和 expressJS，并且发现了一些非常好的[示例](http://chat.nodejs.org/)。

我可以理解 nodeJS 中的聊天，但我无法弄清楚 [1](https://github.com/Marak/session.js/blob/master/README.md)或[2 个](https://github.com/akdubya/rbytes)模块。

有没有一个很好的例子来解释如何做到这一点？

这是我第一次使用它。

# javascript - 是否可以在 Javascript 中使用 for 循环创建多个函数？

> ID：10161323
> 
> 赞同：0
> 
> 时间：2012-04-15T10:47:32.100
> 
> 标签：javascript, function, for-loop

我正在尝试创建与按钮 ID 同名的函数

```
var a = ["ab1","aj6","yt5","gf5","js9"]
for (i = 0; i < a.length; i++) {
    var el = a[i];
    function el(){
        list.find(el);
    }
    $(function() {
        $("#"+el).click(el);
    }
} 
```

当我这样做时，我得到一个

> 未捕获的类型错误：无法读取匿名函数上未定义的属性“处理程序”

. 但是，当我将函数名称更改为“计算”而不是 var`el`时，它可以正常工作。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T10:52:48.767

如果您尝试将单击处理程序绑定到数组中具有“id”的每个元素，则：

```
var a = ["ab1","aj6","yt5","gf5","js9"]

$.each(a,function(i,val){               //for each item
    $("#"+val).on('click',function(){   //bind a click handler
        list.find(val);                 //that finds that element in "list"
    });

    //or

    $("#"+val).click(function(){ 
        list.find(val); 
    });

    //or

    $("#"+val).bind('click',function(){ 
        list.find(val); 
    });

    //or

    $('body').delegate('#'+val,'click',function(){ 
        list.find(val); 
    });
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T11:01:05.363

我不知道您要实现什么，但是“是的，可以使用数组值创建函数”：

```
var a = ["ab1","aj6","yt5","gf5","js9"];
for (var i = 0; i < a.length; i++) {        
    window[a[i]] = function(){
    };
} 
```

`"ab1","aj6","yt5","gf5","js9"`在此之后，您有 5 个带名称的全局函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T10:53:06.567

您不能有两个具有相同名称的变量。`var el`和都`function el`称为`el`。JavaScript 将函数名称视为分配函数的变量名称（某种意义上）。

此外，您可能应该使用函数语句而不是函数声明。有关更多信息，请参阅[http://kangax.github.com/nfe/](http://kangax.github.com/nfe/)。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-15T10:52:39.800

这样做是这样的：

```
var a = ["ab1","aj6","yt5","gf5","js9"]
for (i = 0; i < a.length; i++) {
    var el = a[i];

    $("#"+el).click(functon(){
        list.find(el);
    });

} 
```

# java - Java 编译是如何工作的？

> ID：10161324
> 
> 赞同：2
> 
> 时间：2012-04-15T10:47:36.013
> 
> 标签：java, compilation

我有一个关于 java 编译或 java 文件编译序列的问题。

问题 - 我有一个面向对象的小型程序，其中有三个类。我为最大的一个编写了 java 代码，我在其中为其他两个类创建对象并调用其他两个类的方法。其他两个班级都很小。当我编译第一个类文件（没有编写其他两个类文件）时，我收到了一些编译错误消息。然后我编写了两个新的类文件（但我没有编译它们，只有 .java 文件），我的第一个类文件编译得很好。

--所以我想了解，我是否需要编译所有 Java 文件以使这些类中的所有对象引用正常工作，或者只编写 Java 文件就可以编译其中的任何一个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T10:52:17.823

如果你编译引用所有其他的那个，一旦编译器在你的代码中遇到它们，它们就会自动编译。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T10:52:50.690

我会使用像 maven、ant 或您的 IDE 构建系统这样的构建系统。这意味着您无需担心这些问题。

回答你的问题；这取决于。你通常不需要编译所有东西，javac 可以一次编译多个源文件，有时你必须重新构建依赖项。

# iphone - iPhone：在 NSUserDefaults 和内存问题上存储音频数据

> ID：10161326
> 
> 赞同：1
> 
> 时间：2012-04-15T10:48:09.973
> 
> 标签：iphone

我正在从服务器下载几首小型歌曲并将（NSData）存储到 NSUserDefaults 中，以便在需要时可以使用它来缓存并直接在设备上播放，而不是从服务器再次下载和播放。问题是，如果我在 NSUserDefaults 中存储几首较小尺寸的歌曲作为数据格式，它会减少大量设备内存并引发内存警告或崩溃等。

你能指导我如何解决它吗？我怎样才能将歌曲数据持久地存储在设备上以用于缓存目的，同时以更少的内存使用存储？

**更新：**根据建议，我尝试将歌曲数据作为文件添加到字典中，并尝试按如下方式检索它。但是，我仍然面临同样的问题，在检索到大约 30mb 的数据后出现内存警告。有人可以帮我解决这个问题吗？我需要存储大约 40 mb 的歌曲数据并存储它。

```
 NSURL *songurl = [NSURL URLWithString:downloadSOngUrl];
            NSMutableData *songdata = [NSMutableData dataWithContentsOfURL:songurl];

NSString *fileName = [downloadSOngUrl lastPathComponent];
            NSLog(@"fileName: %@",fileName);

            [appDelegate writeSongIntoDocsDirectory :songdata :fileName];

-(void) writeSongIntoDocsDirectory :(NSData *) inSongData :(NSString *) songNamePath
{
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES); 
    NSString *documentsDirectory = [paths objectAtIndex:0]; 

    NSLog(@"songNamePath: %@", songNamePath);

    songNamePath = [songNamePath stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceCharacterSet] ];
    NSLog(@"songNamePath: %@", songNamePath);

    if ( [inSongData writeToFile:[documentsDirectory stringByAppendingPathComponent:songNamePath] atomically:YES] ) 
    {
        // Success !
        NSLog(@"Successfully saved the song into documents directory");

    } 
    else 
    {
        // Error !  
        NSLog(@"Error when Successfully saving song into documents directory");
    }
}
-(NSData *) readSongDataFromDocsDirectory :(NSString *) filePath
{
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES); 
    NSString *documentsDirectory = [paths objectAtIndex:0]; 

    NSData *readData = [NSData dataWithContentsOfFile:[documentsDirectory stringByAppendingPathComponent:filePath]];

    return readData;
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T11:01:31.203

最好将这些音频文件存储在文档目录中，因为这将减小应用程序的大小，NSUserDefaults 通常用于存储在特定于应用程序的小设置中，例如应用程序特定用户的首选项和所有设置。希望这会有所帮助。. :)

无论您存储在 NSUserDefaults 中的任何内容都会增加应用程序的大小，因为该对象在应用程序运行时始终处于活动状态......

# maven - Maven 发布执行提交附加文件

> ID：10161340
> 
> 赞同：15
> 
> 时间：2012-04-15T10:49:40.250
> 
> 标签：maven, maven-plugin, maven-3, maven-release-plugin

我正在使用`preparationGoals`Maven 发布插件的配置选项来转换其他文件以反映正在发布的项目的版本。这很好用。

问题是在执行提交时，插件明确指定只`pom.xml`应包含文件，从而使我的其他文件未提交：

`[INFO] Executing: /bin/sh -c cd /Users/jw/dev/Test && git commit --verbose -F /var/folders/w0/hr1h_7h50f3_pwd_nrk9l808000195/T/maven-scm-114713951.commit pom.xml library/pom.xml sample/pom.xml`

我有什么方法可以覆盖此行为并指定要包含在提交中的其他文件或 glob？

*（我也需要这种行为，`completionGoals`因为我已配置为进行相同的转换）*

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2017-12-14T15:51:55.937

我还需要提交一些额外的文件（由 Maven Replacer 插件更改）。我是通过以下方式做到的：

首先我配置了[Maven Release 插件](http://maven.apache.org/maven-release/maven-release-plugin/)来执行额外的目标：

```
<plugin>
    <artifactId>maven-release-plugin</artifactId>
    <version>2.5.3</version>
    <configuration>
        <preparationGoals>-Prelease -DreplacerVersion="${releaseVersion}" clean replacer:replace scm:checkin verify</preparationGoals>
        <completionGoals>-Prelease -DreplacerVersion="${developmentVersion}" clean replacer:replace scm:checkin verify</completionGoals>
    </configuration>
</plugin> 
```

*   `release`profile 定义了 Maven SCM 插件的配置
*   `replacerVersion`Maven Replacer 插件使用参数在某些文件中设置正确的版本
*   `clean`是由 Maven Release 插件运行的标准目标（默认`clean verify`：）
*   `replacer:replace`目标负责修改文件
*   `scm:checkin`确实提交并推送
*   `verify`是由 Maven Release 插件运行的标准目标（默认`clean verify`：）

接下来我配置[了 Maven Replacer 插件](https://code.google.com/archive/p/maven-replacer-plugin/)：

```
<plugin>
    <groupId>com.google.code.maven-replacer-plugin</groupId>
    <artifactId>replacer</artifactId>
    <version>1.5.3</version>
    <configuration>
        <includes>
            <include>${basedir}/file1.txt</include>
            <include>${basedir}/file2.txt</include>
        </includes>
        <replacements>
            <replacement>
                <token><![CDATA[<pattern>.*</pattern>]]></token>
                <value><![CDATA[<pattern>${replacerVersion}</pattern>]]></value>
            </replacement>
        </replacements>
    </configuration>
</plugin> 
```

`${replacerVersion}`允许使用相同的配置从开发更改为发布，然后从发布更改为下一个开发版本。

最后我定义了我想使用的[Maven SCM 插件版本：](https://maven.apache.org/scm/maven-scm-plugin/)

```
<plugin>
    <artifactId>maven-scm-plugin</artifactId>
    <version>1.9.5</version>
</plugin> 
```

并在配置文件中配置它`release`（我在配置文件中定义它以防止在非发布构建期间意外提交）：

```
<profile>
    <id>release</id>
    <build>
        <pluginManagement>
            <plugins>
                <plugin>
                    <artifactId>maven-scm-plugin</artifactId>
                    <configuration>
                        <message>[maven-scm-plugin] set ${replacerVersion} version in files</message>
                        <includes>file1.txt, file2.txt</includes>
                    </configuration>
                </plugin>
            </plugins>
        </pluginManagement>
    </build>
</profile> 
```

感谢执行命令后：

```
mvn release:prepare -DdevelopmentVersion=1.2.1-SNAPSHOT -DreleaseVersion=1.2.0 -Dtag=1.2.0 
```

我看到 4 个提交：

1.  [maven-scm-plugin] 在文件中设置 1.2.0 版本
2.  [maven-release-plugin] 准备发布 1.2.0
3.  [maven-scm-plugin] 在文件中设置 1.2.1-SNAPSHOT 版本
4.  [maven-release-plugin] 为下一次开发迭代做准备

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-18T03:19:26.230

你可以使用[maven-scm-plugin](http://maven.apache.org/scm/maven-scm-plugin/)吗？添加运行`scm:checkin`目标的插件执行以提交您想要的文件。将其绑定到将在运行时执行的阶段`preparationGoals`（如果您指定一个或多个阶段作为该元素的值），或直接包含`scm:checkin`目标`preparationGoals`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-02T00:45:06.003

似乎不允许指定附加标记文件实际上是 Maven 中的一个错误。[在 Maven Release Plugin 的org.apache.maven.shared.release.phase.AbstractScmCommitPhase](http://grepcode.com/file/repo1.maven.org/maven2/org.apache.maven.release/maven-release-manager/2.5.2/org/apache/maven/shared/release/phase/AbstractScmCommitPhase.java#AbstractScmCommitPhase.runLogic%28org.apache.maven.shared.release.config.ReleaseDescriptor%2Corg.apache.maven.shared.release.env.ReleaseEnvironment%2Cjava.util.List%2Corg.apache.maven.shared.release.ReleaseResult%2Cboolean%29)类中的第 130 行，引用了在 Maven 2.0-beta-7 中首次引入的“commitByProject”标志。

分支用于确定将文件添加到 Maven 版本的机制：准备提交。[SCM 插件使用SCMFileSet 类](http://grepcode.com/file/repo1.maven.org/maven2/org.apache.maven.scm/maven-scm-api/1.9.4/org/apache/maven/scm/ScmFileSet.java#ScmFileSet)在提交之前加载文件。该类的分支实例之一可能一直在尝试将所有文​​件添加到基目录中，但它在 SCM 中不起作用。

这是可以实施修复以获取文件列表或添加要提交的文件目录的点。

最重要的是，在深入研究 Maven 发布插件的调试执行之后，它正在调用 SCM 插件以仅添加来自存储库的 POM。更改记录不充分的“commitByProject”标志对将哪些文件添加到 SCM 提交中的结果的影响为零。

# php - 函数返回码块查询

> ID：10161346
> 
> 赞同：1
> 
> 时间：2012-04-15T10:50:45.993
> 
> 标签：php, function, return

关于 php 函数的快速问题，对你们中的一些人来说可能听起来很傻，但我不想养成坏习惯。执行以下操作有什么问题吗？

```
function do_something($val)
{
  $a = 1;
  if ($val==$a)
  {
    return true;
  }
  return false;
} 
```

代替;

```
function do_something($val)
{
  $a = 1;
  if ($val==$a)
  {
    return true;
  }
  else
  {
    return false;
  }
} 
```

对不起，伙计们，我认为我的例子不是很好。基本上，该函数可以将数据插入数据库或发送电子邮件等。使用这些函数，我现在可能只需要通过返回 true 或 false 来判断它是否成功。我想知道我可以使用更短的方法而不是 if-else 块是否合适。

我希望这能让它更清楚。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T10:52:54.163

并不真地。两者的工作原理相同。但是，这样写会更干净：

```
function do_something($val)
{
  $a = 1;
  return ($val==$a) ? true : false;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T10:53:17.057

这太酷了，因为当返回一个值时，函数会被留下，接下来的内容并不重要。

但是你可以用

```
function do_something($val)
{
  $a = 1;
  return $val == $a; // this condition will be evaluated to true/false
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-15T10:56:25.687

最短的方法：

```
function do_something($val)
{
  return ($val==1) ;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-15T10:52:40.513

不，这很好，实际上在多种情况下都建议这样做。:)

# multithreading - 是否应该将 double 或 long 变量声明为 volatile 以在 64 位操作系统和 64 位 cpu 中实现读\写原子性？

> ID：10161348
> 
> 赞同：2
> 
> 时间：2012-04-15T10:51:25.710
> 
> 标签：multithreading, synchronization

是否应该将 double 或 long 变量声明为 volatile 以在 64 位操作系统和 64 位 cpu 中实现读\写原子性？对于 32 位操作系统和 32 位处理器也是如此吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T10:55:59.477

对此有两个答案，也不是您希望听到的：

*   不，`volatile`不**保证**原子性，所以如果你需要原子性，`volatile`不会帮助你。
*   有或没有`volatile`，原子性实际上是由实现定义的。在几乎所有的 CPU 上，原生字大小的变量都是以原子方式读取和写入的（至少在它们正确对齐的情况下，通常是这种情况）。在 x86 上，较小的也可以原子访问。所以是的，在 x86 上，32 位变量将被原子读/写，而在 x86 上，64 位变量*也*将被原子读/写。但同样，它取决于 CPU（和编译器）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T13:15:53.030

`volatile`在这里无济于事。如果一个操作是非原子的，它需要一个完整的锁来防止并发访问问题。

话虽如此，在 32 位系统上撕裂`long`变量是一个众所周知的问题，您可以找到示例来证明这一点（参见下面的链接）。

`double`变量也可能导致撕裂，但复制起来有点困难，因为浮点单元寄存器在 x86 系统上是 80 位的。看看这里：[模拟在 C# 中撕开双倍以](https://stackoverflow.com/questions/9008454/simulate-tearing-a-double-in-c-sharp)获得 Hans Passant 的一个很好的答案。

# c++ - OpenCV如何在使用单个静态图像时将速度矢量绘制为箭头

> ID：10161351
> 
> 赞同：17
> 
> 时间：2012-04-15T10:52:09.367
> 
> 标签：c++, opencv, vector

我正在尝试绘制速度矢量，就像在 matlab 中我们使用“quiver”函数[http://www.mathworks.com/help/techdoc/ref/quiver.html](http://www.mathworks.com/help/techdoc/ref/quiver.html)

我需要使用 OpenCV 库在 C++ 中移植相同的方法。

听说有几种光流方法，即Lucas and Kanade (cvCalOpticalFlowLK) or Horn and Schunck (cvCalOpticalFlowHS) or Block Matching method (cvCalOpticalFlowBM)

但是所有这些功能都需要两张图像，而我需要使用一张图像，因为我正在处理指纹。

请帮助我...

[编辑] 找到解决方案

```
void cvQuiver(IplImage*Image,int x,int y,int u,int v,CvScalar Color,
                                            int Size,int Thickness){
cv::Point pt1,pt2;
double Theta;
double PI = 3.1416;

if(u==0)
    Theta=PI/2;
else
    Theta=atan2(double(v),(double)(u));

pt1.x=x;
pt1.y=y;

pt2.x=x+u;
pt2.y=y+v;

cv::line(Image,pt1,pt2,Color,Thickness,8);  //Draw Line

Size=(int)(Size*0.707);

if(Theta==PI/2 && pt1.y > pt2.y)
    {
    pt1.x=(int)(Size*cos(Theta)-Size*sin(Theta)+pt2.x);
    pt1.y=(int)(Size*sin(Theta)+Size*cos(Theta)+pt2.y);
    cv::line(Image,pt1,pt2,Color,Thickness,8);  //Draw Line

    pt1.x=(int)(Size*cos(Theta)+Size*sin(Theta)+pt2.x);
    pt1.y=(int)(Size*sin(Theta)-Size*cos(Theta)+pt2.y);
    cv::line(Image,pt1,pt2,Color,Thickness,8);  //Draw Line
  }
else{
    pt1.x=(int)(-Size*cos(Theta)-Size*sin(Theta)+pt2.x);
    pt1.y=(int)(-Size*sin(Theta)+Size*cos(Theta)+pt2.y);
    cv::line(Image,pt1,pt2,Color,Thickness,8);  //Draw Line

    pt1.x=(int)(-Size*cos(Theta)+Size*sin(Theta)+pt2.x);
    pt1.y=(int)(-Size*sin(Theta)-Size*cos(Theta)+pt2.y);
    cv::line(Image,pt1,pt2,Color,Thickness,8);  //Draw Line
    }

} 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-06-06T19:26:09.443

我在这里完成了当前的答案，但未能给出每个箭头尖端的正确大小。MATLAB 这样做的方式是，当箭头接近一个点时，它没有任何尖端，而对于长箭头，它会显示一个大尖端，如下图所示。

![在此处输入图像描述](../Images/097ef291cfa1a8ac32168ca7fa2db80b.png)

为了获得这种效果，我们需要在箭头长度范围内对每个箭头的“尖端大小”进行归一化。以下代码可以解决问题

```
 double l_max = -10;

    for (int y = 0; y < img_sz.height; y+=10)                                                           // First iteration, to compute the maximum l (longest flow)
    {
        for (int x = 0; x < img_sz.width; x+=10)
        {
            double dx = cvGetReal2D(velx, y, x);                                                        // Gets X component of the flow
            double dy = cvGetReal2D(vely, y, x);                                                        // Gets Y component of the flow

            CvPoint p = cvPoint(x, y);

            double l = sqrt(dx*dx + dy*dy);                                                             // This function sets a basic threshold for drawing on the image

            if(l>l_max) l_max = l;
        }
    }

    for (int y = 0; y < img_sz.height; y+=10)
{
    for (int x = 0; x < img_sz.width; x+=10)
    {
        double dx = cvGetReal2D(velx, y, x);                                                        // Gets X component of the flow
        double dy = cvGetReal2D(vely, y, x);                                                        // Gets Y component of the flow

        CvPoint p = cvPoint(x, y);

        double l = sqrt(dx*dx + dy*dy);                                                             // This function sets a basic threshold for drawing on the image
        if (l > 0)
        {
            double spinSize = 5.0 * l/l_max;                                                        // Factor to normalise the size of the spin depeding on the length of the arrow

            CvPoint p2 = cvPoint(p.x + (int)(dx), p.y + (int)(dy));
            cvLine(resultDenseOpticalFlow, p, p2, CV_RGB(0,255,0), 1, CV_AA);

            double angle;                                                                           // Draws the spin of the arrow
            angle = atan2( (double) p.y - p2.y, (double) p.x - p2.x );

            p.x = (int) (p2.x + spinSize * cos(angle + 3.1416 / 4));
            p.y = (int) (p2.y + spinSize * sin(angle + 3.1416 / 4));
            cvLine( resultDenseOpticalFlow, p, p2, CV_RGB(0,255,0), 1, CV_AA, 0 );

            p.x = (int) (p2.x + spinSize * cos(angle - 3.1416 / 4));
            p.y = (int) (p2.y + spinSize * sin(angle - 3.1416 / 4));
            cvLine( resultDenseOpticalFlow, p, p2, CV_RGB(0,255,0), 1, CV_AA, 0 );

        }
   }
} 
```

这是 OpenCV 代码的外观示例

![在此处输入图像描述](../Images/7e735042d5ae1858a66cb559358b0bd1.png)

我希望这可以帮助其他人在谷歌上搜索同样的问题。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-06-28T12:05:23.227

根据 Dan 的代码和 mkuse 的建议，这里有一个与 cv::line() 语法相同的函数：

```
static void arrowedLine(InputOutputArray img, Point pt1, Point pt2, const Scalar& color,
int thickness=1, int line_type=8, int shift=0, double tipLength=0.1)
{
    const double tipSize = norm(pt1-pt2)*tipLength; // Factor to normalize the size of the tip depending on the length of the arrow
    line(img, pt1, pt2, color, thickness, line_type, shift);
    const double angle = atan2( (double) pt1.y - pt2.y, (double) pt1.x - pt2.x );
    Point p(cvRound(pt2.x + tipSize * cos(angle + CV_PI / 4)),
    cvRound(pt2.y + tipSize * sin(angle + CV_PI / 4)));
    line(img, p, pt2, color, thickness, line_type, shift);
    p.x = cvRound(pt2.x + tipSize * cos(angle - CV_PI / 4));
    p.y = cvRound(pt2.y + tipSize * sin(angle - CV_PI / 4));
    line(img, p, pt2, color, thickness, line_type, shift);
} 
```

我们将看看那些维护 OpenCV 存储库的人是否会喜欢它:-)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-15T16:00:42.540

cvCalOpticalFlowLK不绘制速度矢量，它*计算***这些**速度矢量。如果您没有这些向量，则必须使用两个图像调用此函数。我猜你已经有了这些向量，你只想绘制它们。

在这种情况下，您可以使用[cv::line 函数](http://opencv.willowgarage.com/documentation/cpp/drawing_functions.html#cv-line)，例如：

```
cv::line(yourImage, cv::Point(baseX, baseY), cv::Point(endX, endY)); 
```

我希望这能帮到您！

# c++ - 如何在 g++ 中选择处理器（MIPS R2000）？

> ID：10161353
> 
> 赞同：1
> 
> 时间：2012-04-15T10:52:39.210
> 
> 标签：c++, g++

在 g++ 中选择处理器（MIPS R2000）的命令是什么？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T11:02:23.500

您可能需要针对您的目标平台的交叉编译环境。您可能会找到一个现有的，或者您可能需要使用 gcc 工具链构建自己的交叉编译器。没有单一的方法可以做到这一点 - 这将取决于目标架构的细节。具体来说，您的目标系统上是否已经有操作系统（例如 Linux、BSD 等）在运行？它使用什么样的用户空间 - 您的构建链将需要相关的 C 和 C++ 库以及构建和运行软件所需的任何其他库。或者你是直接在金属上编码吗？在这种情况下，您将需要找到现有的引导代码，以使系统进入可运行代码的合理状态 - 滚动您自己的代码并不容易。

通常，您最好找到一个以相关平台为中心的现有开发人员社区，并在那里寻求建议。他们可能有入门的分步说明。

请注意，仅 CPU 只是图片的一部分——例如，ARM 架构非常流行，但为 Android 设备（带有 Android 用户空间的 Linux 内核）、iOS 设备（带有 BSD 和 OSX 派生的 iOS 用户空间的 xnu 内核）编译代码)，Nintendo DS 或 Playstation Vita（可能根本没有多任务操作系统）将*大不相同*，即使它们都使用 ARM 芯片，在许多情况下甚至是相同的指令集生成。

# java - Java：在这种情况下我应该使用多线程吗？

> ID：10161365
> 
> 赞同：2
> 
> 时间：2012-04-15T10:53:17.493
> 
> 标签：java, multithreading

我正在使用 Java 编写服务器端应用程序。

服务器拥有系统的许多用户。对于每个用户，我想将其磁盘空间与远程网络存储同步。因为同步是独立的，所以我想同时进行。

我正在考虑为每个用户创建一个线程并让同步任务同时触发。

但是该系统可以拥有数以万计的用户。这意味着一次创建数万个线程并同时触发。我不确定这是否是 JVM 可以处理的。

即使它可以处理这个问题，这是否会节省内存，因为每个线程都有自己的堆栈，这可能是一个很大的内存命中！

请让我知道你的意见。

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T11:21:29.313

您可以查看一个固定大小的线程池，提供一个线程池来执行您的任务。这将给多线程带来合理限制的好处。

查看`Executors.newFixedThreadPool()`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-15T10:58:32.207

您应该查看非阻塞 IO。

这是一篇由谷歌提供的关于它的“随机”文章：http: [//www.developer.com/java/article.php/3837316/Non-Blocking-IO-Made-Possible-in-Java.htm](http://www.developer.com/java/article.php/3837316/Non-Blocking-IO-Made-Possible-in-Java.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T10:58:08.147

就我个人而言，我不会在一台机器上拥有成千上万的用户。有这么多活跃用户，您将无法为每个用户提供太多服务。您应该能够买得起不止一台机器。

您可以在 Java 中拥有这么多线程，但正如您所说，这效率不高。您可以使用 NIO 库来管理每个线程的多个连接。

图书馆喜欢

[http://mina.apache.org/](http://mina.apache.org/)

[http://www.jboss.org/netty](http://www.jboss.org/netty)

都合适。

也很有趣[http://code.google.com/p/nfs-rpc/](http://code.google.com/p/nfs-rpc/)

# java - 奇怪的行为：将图像从 Android 手机发送到 Java 服务器（代码工作）

> ID：10161371
> 
> 赞同：3
> 
> 时间：2012-04-15T10:53:55.723
> 
> 标签：java, android, sockets

我正在编写一个 android 应用程序，它将图像发送到运行 java 应用程序的服务器，它以一种非常奇怪的方式工作！

这是我所做的

1.  在桌面上编译并运行 Java 应用程序，接收部分充当服务器
2.  编译、部署并运行必须将图像发送到服务器的 android 部分。android 应用程序完成执行，但 java 应用程序没有
3.  运行具有再次发送图像的代码的 android 应用程序活动，这一次，android 应用程序进度对话框卡住了，但是，java 应用程序完成执行并且图像被成功传输...

以下是 Java 应用程序的 RECEIVE 部分的代码：

```
class ProjectServer
{
    ServerSocket serSock;
    Socket  sock;

    BufferedReader in;
    PrintWriter out;
    public static void main(String ar[])
    {
        try
        {
            ProjectServer cs=new ProjectServer();
            cs.startServer();
        }
        catch(Exception e)
        {

        }
    }

    public void startServer()
    {
        try
        {
            serSock=new ServerSocket(8070);
            System.out.println("Waiting for client...");
            sock=serSock.accept();

            System.out.println("Connections done");

        //Accept File
            System.out.println("Connected");

            //receive code
            int filesize=450660;
            int bytesRead;
            int current=0;
            // receive file
            byte [] mybytearray  = new byte [filesize];
            InputStream is = sock.getInputStream();
            FileOutputStream fos = new FileOutputStream("C:\\Project Server\\Capture.png");
            BufferedOutputStream bos = new BufferedOutputStream(fos);
            bytesRead = is.read(mybytearray,0,mybytearray.length);
            current = bytesRead;

            do {
               bytesRead =
                  is.read(mybytearray, current, (mybytearray.length-current));
               if(bytesRead >= 0) current += bytesRead;
            } while(bytesRead > -1);

            bos.write(mybytearray, 0 , current);
            bos.flush();

            System.out.println("end-start");    
        }
        catch(Exception e)
        {
            System.out.println(e);
            e.printStackTrace();
        }

    }
} 
```

以下是 Android 应用上 SEND 部分的代码：

```
package com.site.custom;
public class Act2 extends Activity
{
    private ProgressDialog pd;
    private String serverIP="58.146.100.187";
    private BufferedReader in;
    private PrintWriter out;
    private String path;
    private Socket cliSock;

    public void onCreate(Bundle onCreateInstance)
    {
        super.onCreate(onCreateInstance);
        setContentView(R.layout.act2);
        this.setTitle("This has started");
        path=getIntent().getStringExtra("path");

        //Establish Connection
        try
        {
            cliSock=new Socket(serverIP,8070);
            in=new BufferedReader(new InputStreamReader(cliSock.getInputStream()));

            ((TextView)findViewById(R.id.tview)).setText(path);
        }
        catch(Exception e)
        {
            Log.v("MERA MSG",e.toString());
        }

        //Send file
        ProgressDialog pd=ProgressDialog.show(this, "Sending image", "Image chosen:"+path.substring(path.lastIndexOf("//")+1),false,true);

        try
        {
            File myFile = new File (path);
            System.out.println((int)myFile.length());
            byte[] mybytearray  = new byte[450560];
            FileInputStream fis = new FileInputStream(myFile);
            BufferedInputStream bis = new BufferedInputStream(fis);
            bis.read(mybytearray,0,mybytearray.length);
            OutputStream os = cliSock.getOutputStream();
            System.out.println("Sending...");
            os.write(mybytearray,0,mybytearray.length);
            os.flush();
            System.out.println("Completed");

            pd.dismiss();
            System.out.println("Done");
        }
        catch(Exception e)
        {
            Log.v("MERA MSG",e.toString());
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T11:01:46.603

您没有关闭任何连接。您的服务器可能正在等待连接关闭，然后才知道数据已完成发送。当您的客户端第二次运行时，第一个连接可能会被 Android 自动关闭，这允许您的服务器处理图像。但是，如果您的服务器处理图像的速度不够快，则您的客户端可能会在第二次运行时“卡住”，因为它正在等待与服务器的成功端口连接但服务器正忙。

长话短说，`close()`完成后尝试连接客户端怎么样。调用`flush()`并没有真正告诉服务器数据已经发送完毕。

如果您希望套接字在关闭时仍保持打开状态`OutputStream`，则可以编写一个`Socket`仅覆盖该`close()`方法的自定义，如下所示...

```
public class MySocket extends Socket {

    public MySocket(String ipAddress, int port){
        super(ipAddress,port);
    }

    public void close(){
        // do nothing
    }

    public void reallyClose(){
        super.close();
    }
} 
```

在您的代码中，更改`cliSock=new Socket(serverIP,8070);`为`cliSock=new MySocket(serverIP,8070);`

当您调用 时`OutputStream.close()`，它会调用`close()`，`MySocket`但正如您所见，它实际上并没有做任何事情。完成后`Socket`，您可以调用`MySocket.reallyClose();`它，它会正确关闭它。

# jquery - 如何在 jquery 自动完成中设置第一个列表项的样式？

> ID：10161372
> 
> 赞同：1
> 
> 时间：2012-04-15T10:54:07.703
> 
> 标签：jquery, jquery-ui, jquery-autocomplete, jquery-ui-autocomplete

我正在使用 jquery-ui 自动完成生成一个列表。我想对这个列表应用一个自定义类，这样我就可以使用像 my_list:first-child 这样的 css 选择器来引用这个列表中的第一项。

我已经尝试了以下代码，但是 li 标签上的类说明符正在丢失。有什么建议么？这里的类似问题讨论了用猴子补丁重载renderItem，但考虑到我想要做的就是指定一个类属性，这似乎过分了。

```
.data('autocomplete')._renderItem = ( ul, item ) ->
  $( "<li class='my_list'></li>" )
    .data( "item.autocomplete", item )
    .append( '<a>' + item.label + '</a>' )
    .appendTo( ul ) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T11:57:32.587

如果您深入查看[输出](http://jqueryui.com/demos/autocomplete/)，您会得到如下信息：

```
<ul class="ui-autocomplete ui-menu ui-widget ui-widget-content ui-corner-all" role="listbox" aria-activedescendant="ui-active-menuitem" style="z-index: 1; display: block; width: 108px; top: 275px; left: 576px; ">
    <li class="ui-menu-item" role="menuitem">
        <a class="ui-corner-all ui-state-hover" tabindex="-1" id="ui-active-menuitem">ActionScript</a></li>
    <li class="ui-menu-item" role="menuitem">
        <a class="ui-corner-all" tabindex="-1">AppleScript</a></li>
    <li class="ui-menu-item" role="menuitem">
        <a class="ui-corner-all" tabindex="-1">Asp</a></li>
    <li class="ui-menu-item" role="menuitem">
        <a class="ui-corner-all" tabindex="-1">BASIC</a></li>
</ul> 
```

对于这样的风格，如：

```
.ui-autocomplete li:first-child { background-color: red; } 
```

会成功的：

![在此处输入图像描述](../Images/e64f576f847a7c566fabdb1e06475b76.png)

*我在你的问题上遗漏了什么吗？*

# javascript - 是否可以在 Jquery/Javascript 中的 $(document) 以外的元素上捕获滚动启动？

> ID：10161374
> 
> 赞同：1
> 
> 时间：2012-04-15T10:54:17.167
> 
> 标签：javascript, jquery, jquery-mobile, scroll, jquery-events

我正在尝试使用[Overthrow](https://github.com/filamentgroup/Overthrow/)插件，它是用于移动设备上的溢出：自动的 polyfill。样品[在这里](http://filamentgroup.github.com/Overthrow/)。

**我的问题：**
如何检测`div.element`可滚动的滚动启动/滚动停止？这是否可能，或者滚动/滚动启动/滚动停止事件仅适用于`$(document)`？

具体来说，如果我的页面上有两个面板，它们都是可滚动的，有什么办法可以使这项工作：

```
 $(document).on('scrollstart','div:jqmData(panel="main"), div:jqmData(panel="menu")'), function() {
    console.log("scroll detected");
    }); 
```

**编辑：**
我的 HTML 如下所示：

```
<html class="ui-popover-mode">
// OR depending on screen size
<html class="ui-splitview-mode">
   // panel 1
   <div data-panel="main" class="ui-panel">
       <div data-role="page" class="ui-page" id="mainOne">
           <div data-role="content" class="ui-content"></div>
       </div>
       <div data-role="page" class="ui-page" id="mainTwo">
           <div data-role="content" class="ui-content"></div>
       </div>
   </div>
   // panel 2
   <div data-panel="menu" class="ui-panel">
       <div data-role="page" class="ui-page" id="menuOne">
           <div data-role="content" class="ui-content"></div>
       </div>
       <div data-role="page" class="ui-page" id="menuTwo">
           <div data-role="content" class="ui-content"></div>
       </div>
   </div>
   // panel 3
   <div data-panel="pop" class="ui-panel">
       <div data-role="page" class="ui-page" id="popOne">
           <div data-role="content" class="ui-content"></div>
       </div>
       <div data-role="page" class="ui-page" id="popTwo">
           <div data-role="content" class="ui-content"></div>
       </div>
   </div>
</html> 
```

屏幕模式根据屏幕尺寸设置。在每个面板中可以有多个页面，每个页面都有一个内容部分，可以使用翻转滚动。

我想绑定到*splitview* -mode的 main 和 menu content 部分中的scrollstart 和**popover-mode 的****main** content 部分。

最初我的选择器试图捕获这一点，并且只附加到相关的内容元素：

```
$(document).on('scrollstart','.ui-splitview-mode div:jqmData(panel="main") .ui-content,  .ui-splitview-mode div:jqmData(panel="menu") .ui-content, .ui-popover-mode div:jqmData(panel="main") .ui-content, ', function() {
        // do sth
    }); 
```

同意这很复杂，没有用。但它只将事件附加到必要的元素上。现在我这样做：

```
$('.ui-content').on('scrollstart', function() {
        // check here if .ui-content is on the correct panel
    }); 
```

所以我现在有很多不必要的绑定，并且只在检测到事件后检查绑定是否正确，而另一种方式我只会将事件附加到所需的元素。

这就是我想知道的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T10:58:23.710

您可以直接选择元素并附加滚动事件。简单的例子

```
$("#selector").on('scrollstart', function() {
    //...do stuff
}); 
```

# java - Struts2 动作 - 测试它与否？

> ID：10161379
> 
> 赞同：3
> 
> 时间：2012-04-15T10:55:49.140
> 
> 标签：java, unit-testing, junit, struts2, struts

我目前正在开发一个使用 Struts2 框架的项目。我们使用单独的组件进行数据库访问，这是经过良好测试的。同时，我们从事的项目有很多未经测试的动作。在大多数操作中，我们至少使用一个 DB 服务调用。因此，一方面，这些操作非常简单。我不确定 - 是否应该为此编写单元测试？

我认为好的做法是始终编写单元测试，但是这些操作非常简单，我现在承受着来自管理层的巨大压力。那么，是否重要 - 让 Struts2 动作没有单元测试？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-15T12:43:15.277

以下是编写单元测试的三个主要原因。

*   它可以帮助您知道您的代码现在可以工作。
*   当将来添加或更改功能时，它有助于保护您的代码免受回归错误的影响。
*   如果您在编写代码之前编写单元测试，它会以一种非常好的方式关注您的设计过程——阅读 TDD 以了解更多关于这样做的好处。

所以问问自己这三个编写单元测试的原因是否适用于这里。如果所有三个问题的答案都是“否”，那么请考虑编写单元测试并将它们保存在代码库中的成本。将此成本与可能的收益进行比较。对是否应该编写单元测试做出明智的决定，并准备好向你的经理捍卫这个决定。

但是不要有一个先入为主的观念，即“单元测试总是好的，对于每个班级”。并且不要携带相反的概念——“单元测试总是不必要的”。两者都不是真的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T02:37:08.560

我和在 Guice 和 Google Wave 工作的[Dhanji Prasanna在同一个阵营。](http://rethrick.com/#unit-tests-false-idol)它不是关于 100% 的覆盖率，而是关于编写有价值的测试，以帮助开发和防止代码回归的方式为正确的组件提供正确的反馈。

对于我的一个 Struts2 应用程序，我们有非常非常复杂的数据验证要求。数千。我们使用 struts2-junit-plugin 通过 Spring 3 IoC 和 Struts2 验证以及用于填充具有许多不同数据场景的模拟请求的自定义机制在其集成上下文中测试动作类。这些测试在开发过程中和作为维护工具都是非常宝贵的。

但是对于我们一些更简单的操作，与编写它们所花费的时间相比，我认为没有多少价值。但是，如果它们非常简单，它们也不会花费太长时间来编写。

我还看到过 100% 覆盖率概念导致 100% 的类为他们编写了轻率、毫无价值的测试。为了我的钱，我投票赞成预先确定测试将提供最大价值的领域，并专注于做好这些领域。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T18:15:30.720

必须为函数编写单元测试可能会出现问题，但无论如何，将来可能会在 Actions 中进行验证，这样可以很好地测试它。测试动作所花费的时间必须一点点，我建议这样做，你的应用程序中的每一层都必须有一些功能，如果不是不必要的，并且必须审查架构。

# android - 以编程方式使用蓝牙连接两个 Android 设备

> ID：10161382
> 
> 赞同：4
> 
> 时间：2012-04-15T10:56:08.943
> 
> 标签：android

我正在做一个蓝牙项目，我想在其中以编程方式使用蓝牙连接两个设备。

我正在遵循 tf developer.android.com 的指南和代码。有人可以帮我解决这个问题吗？这是我尝试过的代码。

谁能告诉我构造函数从哪里接收设备对象？

```
private class ConnectThread extends Thread {
        private final BluetoothSocket mmSocket;
        private final BluetoothDevice mmDevice;

<!-- can anyone tell me from where device object comes here   --!>
        public ConnectThread(BluetoothDevice device) {
            // Use a temporary object that is later assigned to mmSocket,
            // because mmSocket is final
            BluetoothSocket tmp = null;
            mmDevice = device;

            // Get a BluetoothSocket to connect with the given BluetoothDevice
            try {
                // MY_UUID is the app's UUID string, also used by the server code
                tmp = device.createRfcommSocketToServiceRecord(MY_UUID);
            } catch (IOException e) { }
            mmSocket = tmp;
        }

        public void run() {
            // Cancel discovery because it will slow down the connection
            mBluetoothAdapter.cancelDiscovery();

            try {
                // Connect the device through the socket. This will block
                // until it succeeds or throws an exception
                mmSocket.connect();
            } catch (IOException connectException) {
                // Unable to connect; close the socket and get out
                try {
                    mmSocket.close();
                } catch (IOException closeException) { }
                return;
            }

            // Do work to manage the connection (in a separate thread)
            manageConnectedSocket(mmSocket);
        }

        /** Will cancel an in-progress connection, and close the socket */
        public void cancel() {
            try {
                mmSocket.close();
            } catch (IOException e) { }
        }
    }

Thanks inadvance 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T10:04:56.837

这是我完成任务的一些代码。

```
 /**
     * Searches the list of paired devices for the device. Returns
     * if found, throws Exception otherwise.
     * 
     * @param sTargetDeviceName
     * @return BluetoothDevice 
     */
    private BluetoothDevice findDevice(String sTargetDeviceName) 
    throws Exception {

            BluetoothAdapter adapter = BluetoothAdapter.getDefaultAdapter();

            Set<BluetoothDevice> devices = adapter.getBondedDevices();

            for (BluetoothDevice device : devices) {

                    String sDeviceName = device.getName().trim();

                    if (sDeviceName.startsWith(sTargetDeviceName)) {
                            return device;
                    }
            }

            throw new Exception("Device " + sTargetDeviceName + " not found");
    } 
```

要使用上述代码，设备必须已经配对。

请参阅文档：

[http://developer.android.com/guide/topics/wireless/bluetooth.html](http://developer.android.com/guide/topics/wireless/bluetooth.html)

特别是“查找设备”部分。

# php - PHP MySQL表单值到数据库

> ID：10161383
> 
> 赞同：-2
> 
> 时间：2012-04-15T10:56:13.123
> 
> 标签：php, mysql

我想将所有表单值添加到我的数据库中，我知道如何插入新记录，但是对于我想上传的“图像”，我被卡住了。

插入所有值并上传图像并将图像网址插入数据库中的最简单方法是什么？

表格来源：

```
<form action="_eventcreate.php" id="contactform" method="POST">
<p>
<label for="event_name">Event Name:</label>
<input type="text" name="event_name" class="input" value="">
</p><p>
<label for="event_description">Description:</label>
<input type="text" name="event_description" cols="88" rows="6" class="input" value="">
</p><p>
<label for="event_date">Event Date:</label>
<input type="text" name="event_date" class="input" value="">
</p><p>
<label for="event_time">Event Time:</label>
<input type="text" name="event_time" class="input" value="">
</p><p>
<label for="event_cost">Event Cost:</label>
<input type="text" name="event_cost" class="input" value="">
</p><p>
<label for="event_image">Upload Image:</label>
<input type="file" name="fileField" id="fileField" />
</p>
<input type="submit" name="submit" value="Create Event" class="submit">                    
</form> 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T11:02:15.117

1)`<input type="file" name="image"/>`用于上传。

2）在表单标签中添加：`enctype="multipart/form-data"`

3) 使用[`$_FILES`](http://php.net/manual/en/reserved.variables.files.php)集合获取有关上传文件的信息。

4) 使用`is_uploaded_file()`,`move_uploaded_file()`检查文件并将其移动到最终目的地。

5) 确保将文件保存在可通过网络访问的目录中，并创建一个 URL 以将其保存在数据库中。

查看：[http ://www.php.net/manual/en/features.file-upload.post-method.php](http://www.php.net/manual/en/features.file-upload.post-method.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T11:01:22.700

查一下这个网址

```
http://www.w3schools.com/php/php_file_upload.asp 
```

你会更好地了解如何做到这一点..

并且您可以嵌入代码以在检查 $_FILES 没有错误后插入带有图像名称及其其他详细信息的所有表单数据...

尽管有许多库和框架可以管理内部结构，但您只需要调用一个或 2 个函数......就像

```
http://pear.php.net/HTTP_Upload 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T11:01:24.080

此链接可能有用：
[PHP File Upload](http://www.w3schools.com/php/php_file_upload.asp)
Use $_FILES["file"]["name"] to insert to "image" field in your DB table

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-15T11:05:03.640

甚至更好的是，您可以尝试在网上以振幅形式提供的 jquery 文件上传器，例如 valium-file-uploader

# iphone - 即使用户滚动表格，如何在 UITableViewCell 中填充图像

> ID：10161385
> 
> 赞同：0
> 
> 时间：2012-04-15T10:56:28.870
> 
> 标签：iphone, objective-c, uitableview, grand-central-dispatch

我会试着解释一下我自己，我有`ContactsViewController`一个带有联系人列表的表格视图（模型是一个`Contact`对象数组），每个单元格都显示一个联系人的图像。

目前我填充单元格的`UIImageView`方法是：
1\. 我覆盖`Contact`图像属性 getter -

```
- (UIImage *)contactImage
 {
     if (!_contactImage) {
        _contactImage = [[UIImage imageNamed:@"placeHolder.png"] retain];
       [self asyncDownloadContactImageFromServer];
     }
     return _contactImage;
 } 
```

1.  然后，当我完成下载图像时，我将其设置为`contactImage`属性并发布`ContactUpdatedImageNotification`.

2.  然后我`ContactsViewController`收到此通知并重新加载此联系人的单元格，这会将下载的图像设置为单元格的 imageView。

这样做的结果是在用户滚动表格视图时很好地异步获取图像而不会阻塞 UI。
**但是**有一些小问题困扰着我，当用户滚动表格视图并显示新单元格时，新单元格的图像会按预期下载，但单元格的 imageView 不会更新为新下载的图像，直到用户拿起他的手指。
我想我需要在另一个线程中做一些事情才能产生这种效果，但我不知道怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T12:47:11.920

由于代码在默认运行循环中执行，直到用户停止滚动，图像才会更新，该运行循环会延迟到滚动完成。这个另一个问题涉及runloops之间的区别，[NSDefaultRunLoopMode vs NSRunLoopCommonModes](https://stackoverflow.com/questions/7222449/nsdefaultrunloopmode-vs-nsrunloopcommonmodes)，它精确地建议不要在滚动时更新图像，因为如果你不小心，这可能会在滚动本身中引入抖动。

此外，既然您知道这些 runloop 模式的存在，您将能够在 xcode 文档或 Internet 中找到有关它们的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T11:13:54.503

嘿 Eyal 访问以下网址...您将获得答案以及示例代码...

[具有不同单元格和不同图像的表格视图](http://www.raywenderlich.com/4295/multithreading-and-grand-central-dispatch-on-ios-for-beginners-tutorial)

希望对你有帮助...

# c++ - 当我有表面声明时，如何为 sm_1X 和 sm_2X 编译 CUDA 程序

> ID：10161387
> 
> 赞同：3
> 
> 时间：2012-04-15T10:56:42.617
> 
> 标签：c++, cuda, macros, c-preprocessor, nvcc

我正在编写一个使用表面（重新采样并写入纹理）以获得性能提升的库：

```
...
surface<void,  2> my_surf2D; //allows writing to a texture
... 
```

目标平台 GPU 具有计算能力 2.0，我可以使用以下代码编译我的代码：

```
nvcc -arch=sm_20 ... 
```

它工作得很好。

问题是当我尝试在我的笔记本电脑上开发和调试库时，它有一个具有计算能力 1.1 的 NVIDIA ION GPU（我还希望我的库向后兼容）。我知道这个架构不支持表面，所以我在我的设备代码中使用了 nvcc 宏来为这个旧架构定义一个备用代码路径：

```
#if (__CUDA_ARCH__ < 200)
#warning using kernel for CUDA ARCH < 2.0
...
temp_array[...] =  tex3D(my_tex,X,Y,Z+0.5f);
#else
...
surf2Dwrite( tex3D(my_tex,X,Y,Z+0.5f), my_surf2D, ix*4, iy,cudaBoundaryModeTrap);
#endif 
```

问题是当我这样做时：

```
nvcc -gencode arch=compute_11,code=sm_11 
```

我收到此错误：

```
ptxas PTX/myLibrary.ptx, line 1784; fatal  : Parsing error near '.surf': syntax error 
```

当我查看 PTX 文件时，可以看到表面声明：

```
.surf .u32 _ZN16LIB_15my_surf2DE; 
```

如果我尝试在源代码中的表面声明周围放置一个类似的宏：

```
#ifdef __CUDACC__
#if __CUDA_ARCH__ < 200
#warning skipping surface declaration for nvcc trajectory
#else
surface ...
#endif
#else
#warning keeping surface declaration by default
surface ...
#endif 
```

我收到一条错误消息，指出在将 cuda 表面绑定到数组的主机代码调用中未定义表面变量。我也应该**在绑定函数周围添加宏**吗？

我不确定这是否可能，或者如果我在某个地方搞砸了，请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T07:44:14.297

认为该线程应显示为已回答...

我让它工作（实际上很简单）。您必须在使用表面参考的**所有三个**可能的位置放置一个宏，并小心正确使用宏（事实证明，__CUDACC__ 不是必需的）。

**以下仅在编译计算能力 < 2.0 时更改代码**

表面声明：

```
//enable backwards compatability:
#if defined(__CUDA_ARCH__) & (__CUDA_ARCH__ < 200)
#warning skipping surface declarations for compute capability < 2.0
#else
surface<void,  2> my_surf2D; //allows writing to a texture
#endif 
```

表面绑定：

```
#if defined(__CUDA_ARCH__) & (__CUDA_ARCH__ < 200)
#warning skipping cudaBindSurfaceToArray for compute capability < 2.0
...
#else
errorCode = cudaBindSurfaceToArray(my_surf2D, my_cudaArray2D);
#endif 
```

和表面写作：

```
#if defined(__CUDA_ARCH__) & (__CUDA_ARCH__ < 200)
#warning using kernel for compute capability < 2.0
...
temp_array[...] =  tex3D(my_tex,X,Y,Z+0.5f);
#else
...
surf2Dwrite( tex3D(my_tex,X,Y,Z+0.5f), my_surf2D, ix*4, iy,cudaBoundaryModeTrap);
#endif 
```

这适用于虚拟和真实目标（分别为 -arch=compute_XX 和 -arch=sm_XX）。

感谢[talonmies](https://stackoverflow.com/users/681865/talonmies)和[Roger Dahl](https://stackoverflow.com/users/442006/roger-dahl)为我指明了正确的方向，以及来自[talonmies的](https://stackoverflow.com/users/681865/talonmies)[回答](https://stackoverflow.com/a/8809924/1297040)，其中也对 nvcc/CUDA 宏进行了很好的解释。

# c++-cli - C++ cli 纯虚函数重载（或禁用？）

> ID：10161391
> 
> 赞同：1
> 
> 时间：2012-04-15T10:57:22.923
> 
> 标签：c++-cli, virtual, overloading

我不知道是否可能，但是有一个简单的例子我应该实现：我必须使用第一个纯虚函数，因为有很多派生类需要它。但是一些派生类也需要第二个参数。

有基类 Car：

```
public ref class Car abstract
{
.....
public:
  virtual void move(Road ^ road) = 0; //I am not allowed to delete this line
  //virtual void move(Road ^ road, Parameter2 ^ parameter2) = 0; //overload
} 
```

是否可以重载纯虚函数？或者在最坏的情况下，在需要两个参数的少数类中禁用该功能？

我只是学习，对不起愚蠢的问题..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T11:02:58.847

重载虚函数当然是可能的。调用哪一个取决于函数参数的数量（和类型）。请注意，纯虚函数（'=0'）要求所有派生类实现基类的所有纯虚函数（或者本身也是抽象的，将要求传递给进一步的派生类）。

如果您可以修改第一个声明的签名/正文，则可以只使用一个函数，但是：

```
 virtual void move(Road ^ road, Parameter2 ^ parameter2 = 0) = 0; 
```

`parameter2`当在调用时没有明确提供时，它将默认参数分配给。然后让逻辑与您的第一个案例（否`parameter2`）相同，当值为`parameter2`0 时。

# c# - C# 更改 Rectangle 类型列表中元素的值

> ID：10161400
> 
> 赞同：0
> 
> 时间：2012-04-15T10:58:37.153
> 
> 标签：c#, list, properties, readonly

我正在努力将列表中特定索引处的元素值设置为新值。

该列表是对象矩形类型，当我尝试更改列表中矩形的任何值时出现以下错误，例如

> 无法将属性或索引器“System.Drawing.Rectangle.Bottom”分配给 - 它是只读的

我尝试将列表转换为数组，但我仍然遇到相同的值是只读的问题。

基本上，该应用程序接受用户定义数量的矩形并绘制具有不同宽度和高度但沿相同基线的矩形。我试图实现的代码需要获取这些矩形并从底部向上垂直重绘它们，同时保持相同数量的矩形并保持与先前创建的矩形相同的外部形状。

代码：

```
public void RotateRectangles(List<Rectangle> Rectangles, int startPositionX, int userInput, Graphics DrawingSurface)
    {
        Graphics RectangleGraphics = DrawingSurface;

        try
        {
            // loop in reverse to compare one rectangle to all the other rectangles in the vector

            for (int i = Rectangles.Count - 1; i > -1; --i)
            {
                bool mustChange = true;

                for (int t = Rectangles.Count - 1; t > -1; --t)
                {
                    // only compare if the current position in the vector A if different to the position in vector B.
                    if (i > t)
                    {
                        if (mustChange == true)
                        {
                            // If the top Y coordinate of RECT at Position i in vector A is bigger than Y coordinate
                            // at Position t in vector B

                            if (Rectangles[i].Top >= Rectangles[t].Top)
                            {
                                //adjusting points accordingly
                                Rectangles[i].Left = (Rectangles[t].Left);
                                Rectangles[t].Bottom = (Rectangles[i].Top);
                            }
                            else
                            {
                                // If the Y coordinate is not bigger, then we need to stop checking
                                mustChange = false;
                            }
                        }
                    }
                }
            }

            // loop forward to compare one rectangle to all the other rectangles in the vector
            for (int i = 0; i < Rectangles.Count; ++i)
            {
                bool forwardChange = true;

                for (int t = 0; t < Rectangles.Count; ++t)
                {
                    // If the top Y coordinate of RECT at Position i in vector A is bigger than Y coordinate at Position t
                    // in vector B AND the two rectangales touch

                    if (i < t && Rectangles[i].Top <= Rectangles[t].Bottom)
                    {
                        if (forwardChange == true)
                        {

                            // If the top Y coordinate of RECT at Position i in vector A is bigger than Y coordinate at Position t 

                            // in vector B

                            if (Rectangles[i].Top > Rectangles[t].Top)
                            {
                                //adjusting points accordingly
                                Rectangles[i].Right = (Rectangles[t].Right);
                                Rectangles[t].Bottom = (Rectangles[i].Top);
                            }
                            else
                            {
                                // If the Y coordinate is not bigger, then we need to stop checking
                                forwardChange = false;
                                // Addjust the Y position of each rectangle so it does not overlap with the first drawing

                                for (int z = 0; z < Rectangles.Count; ++z)
                                {
                                    Rectangles[z].Top = (250 - Rectangles[z].Top);
                                    Rectangles[z].Bottom = (250 - Rectangles[z].Bottom);
                                }
                            }
                        }
                    }
                }
            }
            for (int z = 0; z < Rectangles.Count; ++z)
            {

                Rectangle DrawRec = myRectangleClass.MyRectangle(Rectangles[z].Left, Rectangles[z].Top, Rectangles[z].Right, Rectangles[z].Bottom);
                RectangleGraphics.DrawRectangle(Pen, DrawRec);

                ReadWrite.writeOutput(Rectangles[z].Left, Rectangles[z].Top, Rectangles[z].Right, Rectangles[z].Bottom);
            }
        }
        catch (Exception e)
        {
        }
    } 
```

给出错误的部分是：

```
Rectangles[i].Left = (Rectangles[t].Left);
Rectangles[t].Bottom = (Rectangles[i].Top);

Rectangles[i].Right = (Rectangles[t].Right);
Rectangles[t].Bottom = (Rectangles[i].Top);

Rectangles[z].Top = (250 - Rectangles[z].Top);
Rectangles[z].Bottom = (250 - Rectangles[z].Bottom); 
```

请有人可以帮助我或至少将我引向正确的方向

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T11:05:22.913

属性 Right、Left、Top、Bottom 是只读的。您可以使用 Offset 和 Inflate 方法以及 Location、Size、Width 和 Height 属性来调整矩形的位置和大小，或者您可以用新创建的矩形替换现有矩形。

例如

```
Rectangle ri = Rectangles[i];
Rectangle rt = Rectangles[t];

Rectangle[i] = new Rectangle( rt.Left, ri.Bottom, rt.Height, rt.Width ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T13:20:43.177

问题不在于矩形的值类型，而在于 List[] 运算符返回一个新的值对象。

```
List<Rectangle> a; 

a[4].X += 4; // does the same like the following code:

var r = a[4] 
r.X += 4; // will change r, but not a[4] 
```

所以你需要将矩形值存储在列表中

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-15T11:05:24.237

```
Rectangles[i] = new Rectangle(Rectangles[t].Left, Rectangles[i].Top, Rectangles[i].Width, Rectangles[i].Height); 
```

为所需索引分配一个新矩形。

# iphone - Sharekit、GoogleMaps 能否开源用于制作 iPhone App 的资源？

> ID：10161401
> 
> 赞同：0
> 
> 时间：2012-04-15T10:58:42.180
> 
> 标签：iphone, ios, ipad, google-maps, xcode4

我正在使用 sharekit 开源进行 facebook/twitter 共享，还使用 ​​Google 地图在我的 iPhone 应用程序中显示地图以及行车路线、当前位置、注释等所有内容。我只是想知道它在 iTunes 上被苹果接受。

Apple Approve 是否共享套件？谷歌地图可以在 iPhone 上使用吗？请给我任何想法

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T09:39:45.570

尽管 ShareKit 已经过时了，而且自古以来都没有更新（最近一次更新是一年多前），Apple 仍然没有理由在使用它时不批准您的应用程序。就个人而言，我强烈建议不要使用 ShareKit，因为它是超级错误的，并且没有跟上 Twitter API 的最新变化，但这是你的选择。

谷歌地图也根本不是一个展示者。正如其他人所说，AppStore 上有很多应用程序在使用它。

# jquery - Ajax 发布后未显示 Mvc3 目标页面

> ID：10161402
> 
> 赞同：1
> 
> 时间：2012-04-15T10:58:47.500
> 
> 标签：jquery, ajax, asp.net-mvc-3

我已经为此绞尽脑汁了一天半，我被难住了。

我有一个 Mvc3 站点，并且正在实现一个向导（多步骤表单）。

第一个页面从控制器接收视图模型，并将其序列化为 Javascript。

下面的 post 方法一切顺利：

```
$('#nextButton').click(function (evt) {
    // Validate the form, if validation passes, submit the form.
    evt.preventDefault();
    var $form = $('form');
    if ($form.valid()) {
        var viewModel = JSON.stringify(model);
        $.post(
            "SampleSubmission/Home/Index",
            { 'viewModel': viewModel }
        );
    }
}); 
```

然后它点击下面的控制器动作：

```
 [HttpPost]
    public ActionResult Index(string viewModel)
    {
        _viewModel = JsonConvert.DeserializeObject<SampleSubmissionViewModel>(viewModel);

        // Save Model to Session.
        Session[SessionViewModel] = _viewModel;

        // If platform Id != null, workflow has already begun.
        if (ModelState.IsValid)
        {
            return RedirectToAction("SystemDetail");
        }
        return View(_viewModel);
    }

    [HttpGet]
    public ActionResult SystemDetail()
    {
        // Page 2- System Details.
        return View(_viewModel);
    } 
```

重定向有效，但没有显示第二页。

如果我查看 Fiddler，页面会按原样返回。

我将模型存储在 Session 中，因为它是一个 Intranet 站点，在任何人说之前:-)

关于如何显示第二页的任何想法？

干杯，

朱尔斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:56:20.053

*将所有笔记合并为一个答案。*

当调用 ajax 操作来创建向导时，处理服务器响应并将其以某种方式附加到 dom 是很重要的。感谢@pilavdzice 发布完整的解决方案。

但是，如果没有 javascript，这种创建向导的方式是不可用的，恕我直言，维护起来更复杂，验证也会更复杂。

根据我的经验，使用多个视图并使用简单帖子的解决方案（如@Darin Dimitrov[多步骤注册过程](https://stackoverflow.com/questions/6402628/multi-step-registration-process-issues-in-asp-net-mvc-splitted-viewmodels-sing)的帖子中所述或 Steven Sanderson MVC2 书中所述）更简单且更强大的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T22:56:15.013

安德烈亚斯上面的评论是正确的。

为了进一步解释，您的页面没有显示任何内容，因为您需要一个 onsuccess 处理程序来获取从您的 ajax 返回的结果并将其显示在您的页面上，您可以执行以下操作：

```
 $.post(
        "SampleSubmission/Home/Index",
        { 'viewModel': viewModel },
        //onsuccess handler
        function(data) {
             $('#result').html(data);
         };
    ); 
```

在您的 HTML 页面中，如果您有：

`<div id="result"></div>`

无论您传回什么，都将被放入该 div 中。

如果您在尝试此操作后仍然遇到问题，请告诉解释您遇到的问题，我会进一步提供帮助。

# javascript - IE8 上的 JS：删除终止逗号仍然给出“预期的标识符、字符串或数字”

> ID：10161404
> 
> 赞同：0
> 
> 时间：2012-04-15T10:58:50.560
> 
> 标签：javascript, internet-explorer-8, cross-browser

在 IE8 上测试我的网站会引发一个奇怪的错误；我首先认为这是由于在“class：'deflect'”之后留下了一个逗号，但它仍然抱怨“Expected identifier, string or number”：

```
 var deflector =
    jQuery('<div/>', {
        style: 'left: ' + x + 'px; top: ' + y + 'px',
        class: 'deflector'
    }); 
```

清除缓存，没有运气。那会是什么？

（顺便说一句，真正的浏览器不会抱怨任何事情；）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T11:00:27.440

`class`是[**保留关键字** *^([MDN])*](https://developer.mozilla.org/en/JavaScript/Reference/Reserved_Words)。使用字符串：

```
jQuery('<div/>', {
    style: 'left: ' + x + 'px; top: ' + y + 'px',
    'class': 'deflector'
}); 
```

至少 Firefox（自 FF5 起）也会抱怨这一点，并且有充分的理由。

# javascript - 简单的 if/else 形式检查（应该很简单）

> ID：10161406
> 
> 赞同：1
> 
> 时间：2012-04-15T10:59:36.627
> 
> 标签：javascript, jquery

简单的 if/else 对我进行了转储.....它工作正常（从 prev proj 复制），进行了一些更改，现在什么也没有。

我将其全部删除，并编写了一个简单的函数来检查是否为空，表格仍将转到下一页……而且它正在工作。

所以现在我做了最简单的一个，所以......它仍然搞砸了，我错过了什么。应该是简单的。

我需要休息一下哈哈

继承人的代码。

html:

```
<form name="mainForm" action="formProc.php" method="get"  id="mainForm" onSubmit="return allChecks();" >

<input type="text" name="name" id="name"/>

</form> 
```

js：

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script type="text/javascript">

$(document).ready( function(){
    //formVars
    var name = $('#name');

function allChecks(){
    if(name.val()==""){
        alert("lopan"); 
        return false;
    }

        if(name.val()===""){
        alert("lopan"); 
        return false;
    }

        if(name.val()== null){
        alert("lopan"); 
        return false;
    }
return false;
}

});
</script> 
```

正如你所看到的......我基本上试图在表格上强制“假”，它仍然进入下一页。

所以把它弄得更远了。

我在 type="button" 的表单中创建另一个按钮，声明它，好吧，这个

```
var btn= $('#clearF');

btn.click(allChecks); 
```

然后这个工作......所以我迷路了。

编辑***我试图强制错误/防止进入下一页，因为当我向字段添加验证时，我注意到无论值是否为真，它都会进入下一页......在排除一段时间后我决定看看为什么它会自己进入下一页......因此试图强制错误并失败阻止它进入下一页。

***结束编辑

任何提示/想法/指出我正在做的一些愚蠢的事情....不要犹豫指出它在先谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T11:06:21.197

`allChecks`对您的标记不“可见”。它在`$(document).ready()`处理程序内部。要使其“可见”，只需像这样声明它：

```
window.allChecks=function(){ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T11:08:37.793

而不是`onsubmit`在标记上，为什么不使用 jQuery 创建处理程序？

```
$(document).ready(function(){

    $('#mainForm').on('submit',function(){
        //whatever you want to do on submit
    });

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T11:15:51.293

你可以这样处理提交事件：

```
$(document).ready( function(){
    //formVars

    var name = $('#name');

    $("#mainForm").submit( function() {

    if ( name.val() === "" ) {
        alert("lopan");
        return false;
    }

    else {
      return true;
    }
  });
}); 
```

[http://jsfiddle.net/YMg9V/1/](http://jsfiddle.net/YMg9V/1/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-15T11:16:17.767

前段时间有类似的东西，生产代码突然改变了提交行为。我现在做的是代替您的（相当正常的）代码。

```
<form name="mainForm" action="formProc.php" method="get"  id="mainForm" >
<input type="text" name="name" id="name"/>
var btn= $('#clearF');
btn.click(allChecks);

$(document).ready( function(){
    //formVars
    var name = $('#name');

function allChecks(){
    if(name.val()==""){
      alert("lopan"); 
      return false;
    }else{
      mainForm.submit();
    }
return false;
}

});
</script> 
```

# algorithm - 打印最大列表

> ID：10161407
> 
> 赞同：1
> 
> 时间：2012-04-15T10:59:36.813
> 
> 标签：algorithm

给定 N 个水果的集合 F={a1,a2,a3,…,aN}。每个水果都有价格 Pi 和维生素含量 Vi。现在我们必须以这样的方式排列这些水果，列表包含价格升序，列表包含维生素降序排列。

例如:: N=4

圆周率：2 5 7 10

六：8 11 9 2

这是确切的问题[https://cs.stackexchange.com/questions/1287/find-subsequence-of-maximal-length-simultaneously-satisfying-two-ordering-constr/1289#1289](https://cs.stackexchange.com/questions/1287/find-subsequence-of-maximal-length-simultaneously-satisfying-two-ordering-constr/1289#1289)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T11:03:22.563

我会尝试将问题减少到[最长增加的后续问题](http://en.wikipedia.org/wiki/Longest_increasing_subsequence)。

1.  根据第一个标准对列表进行排序 [维生素]
2.  然后，根据第二个标准[价格]，在修改后的列表中找到最长的后续

这个解决方案是`O(nlogn)`，因为步骤 (1) 和 (2) 都可以在`O(nlogn)`每个中完成。
看看维基百科的文章，在[高效算法](http://en.wikipedia.org/wiki/Longest_increasing_subsequence#Efficient_algorithms)下- 你如何实现最长的后续增加

**编辑：**

如果您的列表允许重复，则您的排序 [步骤 (1)] 将必须按第二个参数作为次要标准进行排序，以防主要标准相等。

**示例**[您的示例 2]：

```
Pi::99 12 34 10 87 19 90 43 13 78
Vi::10 23 4 5 11 10 18 90 100 65 
```

在第 1 步之后，您会得到 [排序何时`Vi`是主要标准，降序]：

```
Pi:: 013 43 78 12 90 87 87 99 10 34
Vi:: 100 90 65 23 18 11 10 10 05 04 
```

第二步找到 Pi 中最长的递增子序列，你得到：

```
(13,100), (43,90), (78,65), (87,11), (99,10) 
```

作为一种可行的解决方案，因为它是排序列表中的递增子序列 [根据`Pi`]。

PS在这里我假设你想要的增加的子序列是严格增加的，否则结果是`(13,100),(43,90),(78,65),(87,11),(87,10),(99,10)`- 这是更长的子序列，但它不是根据`Pi`和严格增加/减少`Vi`

# java - Java：在子类下使用带有枚举的switch语句

> ID：10161408
> 
> 赞同：350
> 
> 时间：2012-04-15T10:59:38.043
> 
> 标签：java, enums, switch-statement

首先，我要声明我对 C# 中的枚举更加熟悉，而且似乎 java 中的枚举非常混乱。

如您所见，我尝试在下一个示例中使用 switch 语句 @ enums，但无论我在做什么，我总是会收到错误消息。

**我收到的错误是：**

> 合格的 case 标签`SomeClass.AnotherClass.MyEnum.VALUE_A`必须替换为不合格的枚举常量`VALUE_A`

问题是我*很*理解这个错误，但我不能只写 VALUE_A 因为枚举位于另一个子类中。有没有办法解决这个问题？为什么它会发生在 Java 中？

```
//Main Class
public class SomeClass {

    //Sub-Class
    public static class AnotherClass {
        public enum MyEnum {
            VALUE_A, VALUE_B
        }    
        public MyEnum myEnum;
    }

    public void someMethod() { 
        MyEnum enumExample //...

        switch (enumExample) {
            case AnotherClass.MyEnum.VALUE_A: { <-- error on this line
                //..
                break;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：717
> 
> 时间：2012-04-15T11:05:13.293

将其更改为：

```
switch (enumExample) {
    case VALUE_A: {
        //..
        break;
    }
} 
```

线索在错误中。您不需要`case`使用枚举类型来限定标签，只需使用它的值即可。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2012-04-15T11:03:53.283

Java 会自动推断 中元素的类型`case`，因此标签必须是不合格的。

```
int i;
switch(i) {
   case 5: // <- integer is expected
}
MyEnum e;
switch (e) {
   case VALUE_A: // <- an element of the enumeration is expected
} 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2019-03-07T22:15:41.997

错误的：

```
case AnotherClass.MyEnum.VALUE_A 
```

正确的：

```
case VALUE_A: 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-04-15T11:09:04.313

这应该这样做：

```
//Main Class
public class SomeClass {

    //Sub-Class
    public static class AnotherClass {
        public enum MyEnum {
            VALUE_A, VALUE_B
        }    
        public MyEnum myEnum;
    }

    public void someMethod() { 
        AnotherClass.MyEnum enumExample = AnotherClass.MyEnum.VALUE_A; //...

        switch (enumExample) {
            case VALUE_A: { //<-- error on this line
            //..
            break;
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-03-30T09:30:12.593

这就是我使用它的方式。它工作得非常好——

```
public enum Button {
        REPORT_ISSUES(0),
        CANCEL_ORDER(1),
        RETURN_ORDER(2);

        private int value;

        Button(int value) {
            this.value = value;
        }

        public int getValue() {
            return value;
        }
    } 
```

如下`switch-case`图所示

```
@Override
public void onClick(MyOrderDetailDelgate.Button button, int position) {
    switch (button) {
        case REPORT_ISSUES: {
            break;
        }
        case CANCEL_ORDER: {
            break;
        }
        case RETURN_ORDER: {
            break;
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-03-25T08:59:35.987

从**Java 14**开始，可以使用 switch 表达式。

对于这篇文章

```
public enum MyEnum {
    VALUE_A, VALUE_B;
} 
```

```
public void someMethod() { 
    MyEnum enumExample //...

    switch (enumExample) {
        case VALUE_A -> {
            // logic
        }
        case VALUE_B -> {
            // logic
        }   
    }
} 
```

开关表达式

> 与所有表达式一样，switch 表达式计算为单个值并且可以在语句中使用。它们可能包含“case L ->”标签，无需使用 break 语句来防止失败。您可以使用 yield 语句来指定 switch 表达式的值。

```
public enum Month {
    JAN, FEB, MAR, APR, MAY, JUN, JUL, AUG, SEP, OCT, NOV, DEC;
} 
```

示例 1：返回值。

```
public static int getNoOfDaysInAMonth(Month month, boolean isLeapYear) {
    return switch(month) {
        case APR, JUN, SEP, NOV -> 30;
        case FEB -> (isLeapYear)? 29: 28;
        case JAN, MAR, MAY, JUL, AUG, OCT, DEC -> 31;
    };
} 
```

示例 2：不返回值。

```
public static void printNoOfDaysInAMonth(Month month, boolean isLeapYear) {
    switch(month) {
        case APR, JUN, SEP, NOV -> {
            System.out.println("30 days");
        }
        case FEB -> {
            System.out.println(((isLeapYear)? 29: 28) + " days");
        }
        case JAN, MAR, MAY, JUL, AUG, OCT, DEC -> {
            System.out.println("31 days");
        }
    };
} 
```

参考

[切换表达式](https://docs.oracle.com/en/java/javase/15/language/switch-expressions.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-15T11:07:58.270

这样写`someMethod()`：

```
public void someMethod() {

    SomeClass.AnotherClass.MyEnum enumExample = SomeClass.AnotherClass.MyEnum.VALUE_A;

    switch (enumExample) {
    case VALUE_A:
        break;
    }

} 
```

在 switch 语句中，您必须仅使用常量名称。

# view - CakePHP 2.0 css 和元素中的脚本未添加到 css/script 块中

> ID：10161410
> 
> 赞同：0
> 
> 时间：2012-04-15T11:00:00.933
> 
> 标签：view, element, block, cakephp-2.0, fetch

我刚刚开始了一个使用 cakePHP 2.0 的项目。我正在使用一个元素来呈现侧边栏菜单。我想在菜单元素中为菜单指定 css 和 JS 文件，而不是将它们添加到我的 head 标签中（以防我有条件地呈现不同的侧边栏）。出于某种原因，我的脚本和 CSS 没有被输出……有什么想法吗？

**布局/默认.ctp**

```
<head>
<?php
echo $this->fetch('css');
echo $this->fetch('script');
?>
</head>
....
<div id="leftcolumn">
<?php  echo $this->element('sidebar/menu'); ?>
</div> 
```

元素/侧边栏/menu.ctp

```
$this->Html->script('menu', array('inline' => false));
$this->Html->css('menu', null, array('inline' => false));
<div class="sidebarmenu"><ul><li>Menu Item</li></ul></div> 
```

CSS 和 javascript 分别位于 webroot/css/menu.css 和 webroot/js/menu.js 中。

如果我将 Html->script 和 Html->css 声明放在视图文件或 home.ctp 或 default.ctp 中，它们将被添加到 css 和脚本块中并且输出正常。当它们在元素文件 menu.ctp 中声明时，它们不起作用。有什么我想念的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T16:10:54.100

```
// css
$this->start('css');
echo $this->Html->css('additionalstyle');
echo $this->Html->css('anotherstyle');
echo $this->end()

// javascript
$this->start('script')
echo $this->Html->script('jquery');
$this->end() 
```

将此代码添加到您的 view.ctp

[http://book.cakephp.org/2.0/en/views.html](http://book.cakephp.org/2.0/en/views.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T15:37:41.443

```
echo $this->Html->script('menu', array('inline' => false));
echo $this->Html->css('menu', null, array('inline' => false)); 
```

我想我遇到了问题。主要问题是css和js调用的顺序。

```
echo $this->fetch('css');
echo $this->fetch('script'); 
```

这两行在 head 内呼应，即在调用你元素之前。所以这个问题有两种可能的解决方案：

1.  从 head上方剪切`fetch()`并将其附加到 body 标记的末尾，以便在所有 DOM 可用后加载脚本和 css。IE

    ... ... echo $this->fetch('css'); echo $this->fetch('script');

2.  使`"inline" => true`即

    ```
    echo $this->Html->script('myel', array('inline' => true));
    echo $this->Html->css('mycss', null, array('inline' => true)); 
    ```

我想这会解决你的问题......

# python - mongodb根据python函数更新所有键的值

> ID：10161411
> 
> 赞同：1
> 
> 时间：2012-04-15T11:00:26.707
> 
> 标签：python, datetime, mongodb, pymongo

我正在使用 pymongo

我有一个 mongo 数据库，其中所有文档都有一个“时间戳”：“25-OCT-2011”

所以一个字符串存储在`timestamp`所有文档的键中。

我想在这些字符串日期上应用下面提到的 python 函数并将它们转换为 datetime 对象。在 mongodb 中执行此操作的最佳方法是什么？

```
import datetime
def make_date(str_date):  
    return datetime.datetime.strptime(str_date, "%d-%b-%Y") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T11:08:35.327

为了满足您的需求：

```
import bson    

for document in list(database.collection.find({ })):
   converted_date = make_date(document['timestamp'])
   database.collection.update(
         { "_id": bson.objectid.ObjectId(document['_id']) },
         { "converted": converted_date }
   ) 
```

我使用 ObjectId 作为查询，以确保我更新了刚刚获得的文档。我这样做是因为我不确定时间戳冲突是否会导致不良后果。

# c# - C# (.NET) 的无头浏览器？

> ID：10161413
> 
> 赞同：39
> 
> 时间：2012-04-15T11:00:51.890
> 
> 标签：c#, .net, browser, automation, web-scraping

我（曾经）是一名 Python 开发人员，他正在构建一个 GUI Web 抓取应用程序。最近我决定迁移到 .NET 框架并用 C# 编写相同的应用程序（这个决定不是我的决定）。

在 Python 中，我使用了 Mechanize 库。但是，我似乎在 .NET 中找不到任何类似的东西。我需要的是一个以无头模式运行的浏览器，它能够填写表单、提交表单等。JavaScript 解析器不是必须的，但它会非常有用。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-04-15T11:04:16.667

有一些选项：

*   [WebKit.Net](http://sourceforge.net/projects/webkitdotnet/)（免费）

*   [Awesomium](http://awesomium.com/)
    它基于 Chrome/WebKit，工作起来就像一个魅力。有可用的免费许可证，但也有商业许可证，如果需要，您可以购买源代码 :-)

*   [HTML Agility Pack](http://html-agility-pack.net/?z=codeplex)（免费）（一个 HTML 解析器库，而**不是**无头浏览器）
    这有助于从 HTML 等中提取信息，并且可能对您的情况有用（可能与 结合使用[`HttpWebRequest`](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx)）

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-07-19T11:32:20.600

更多解决方案：

*   [PhantomJS](http://phantomjs.org/) - 全功能无头网络浏览器。通常与 Selenium 配对使用，允许您从 .NET 应用程序访问浏览器。
*   [Optimus](https://github.com/RusKnyaz/Optimus)（[nuget 包](https://www.nuget.org/packages/Knyaz.Optimus/)）- 轻量级无头网络浏览器。它处于测试阶段，但在某些情况下已经足够了。

我曾经将两者都用于网络测试。但它们也适用于网页抓取。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-01-06T11:32:17.427

您可能正在使用**[TrifleJS](http://triflejs.org)**（目前处于测试阶段），或使用[.NET WebBrowser](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.aspx)类的类似工具，该类通过无窗口 ActiveX/COM API 与 IE 通信。

您实际上将使用 Internet Explorer 的 Trident 引擎运行一个成熟的浏览器（不是 http 请求包装器），如果您对 JavaScript API（[phantomjs](https://github.com/ariya/phantomjs)的一个端口）不感兴趣，您仍然可以使用一些 C# 代码库绕过关键概念（自定义标题、cookie、脚本执行、屏幕截图渲染等）。

请注意，这也可以模拟不同版本的 IE，具体取决于您安装的内容。

[![在此处输入图像描述](../Images/8448c373cb22608a46cf6304ba4b432a.png)](http://triflejs.org)

# java - 按条件重定向？

> ID：10161415
> 
> 赞同：0
> 
> 时间：2012-04-15T11:01:05.763
> 
> 标签：java, jsf, xhtml

我写了一个返回的支持方法`boolean isLoggedIn`。我用它来渲染菜单。因此，如果未登录，则很少有菜单链接可见。

但是如果用户自己去地址栏进入xhtml网页，如果他没有登录应该无法访问呢？如何在这些页面上进行检查和自动重定向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T11:11:26.220

一旦用户成功登录，将一些属性存储到会话中。当用户尝试通过在地址栏中键入 URL 来访问任何页面时，检查该属性是否存在于会话中。基本上您需要为每个页面检查该属性.您可以将其包含在过滤器中。

# c - POSIX C 线程。互斥体示例。不按预期工作

> ID：10161425
> 
> 赞同：8
> 
> 时间：2012-04-15T11:02:02.027
> 
> 标签：c, multithreading, mutex, multitasking

我有一个大问题，我不明白为什么 C 中的互斥锁不能按我的预期工作。这是我的代码：

```
#include <stdlib.h>
#include <stdio.h>
#include <pthread.h>

pthread_t mythread;
pthread_mutex_t mymutex;

void *anotherFunc(void*)
{
    pthread_mutex_lock(&mymutex);

    for(int i = 0; i < 100; i++)
        printf("anotherFunc\n");

    pthread_mutex_unlock(&mymutex);

    pthread_exit(NULL);
}

void *func(void*)
{
    pthread_mutex_lock(&mymutex);

    for(int i = 0; i < 100; i++)
        printf("func\n");

    pthread_mutex_unlock(&mymutex);

    pthread_exit(NULL);
}

int main(int argc, char *argv[])
{
    pthread_mutex_init(&mymutex, NULL);

    pthread_create(&mythread, NULL, func, NULL);
    pthread_create(&mythread, NULL, anotherFunc, NULL);

    pthread_mutex_destroy(&mymutex);

    pthread_exit(NULL);
    return EXIT_SUCCESS;
} 
```

我期望发生的是程序先打印 100 条“func”消息，然后再打印 100 条“anotherFunc”消息。我期望的是执行到达 func 并锁定互斥锁。当执行到达 anotherFunc 时，我希望等到 func 解锁互斥锁。但我收到干扰消息，例如

func func func anotherFunc anotherFunc anotherFunc func anotherFunc

我不明白这东西是如何工作的。请帮忙！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-15T11:04:47.850

> ```
> pthread_create(&mythread, NULL, func, NULL);
> pthread_create(&mythread, NULL, anotherFunc, NULL);
> 
> pthread_mutex_destroy(&mymutex); 
> ```

你在线程完成*之前*破坏了互斥锁，所以所有的赌注都没有了。在销毁它之前，您可能需要`pthread_join`2 个线程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-11T07:00:21.507

我有几个编译错误

*   我无法在*for*循环中声明**int i**

**   使用参数名称**arg**作为线程“func”和“anotherFunc”的参数* 

 *我在销毁互斥锁**​​之前使用了 pthread_join 。**

这样**，在线程“func”和“anotherFunc”都完成执行后，我正在销毁我的互斥锁“mymutex”**

此外，每个线程现在都有自己的线程 ID **“mythread1”**和**“mythread2”**，所以这样我可以为每个线程使用 pthread_join() 函数

```
#include <stdlib.h>
#include <stdio.h>
#include <pthread.h>

pthread_t mythread1, mythread2;
pthread_mutex_t mymutex;

void *anotherFunc(void *arg)
{
    pthread_mutex_lock(&mymutex);
    int i;

    for(i = 0; i < 100; i++)
        printf("anotherFunc\n");

    pthread_mutex_unlock(&mymutex);

    pthread_exit(NULL);
}

void *func(void *arg)
{
    pthread_mutex_lock(&mymutex);
    int i;
    for(i = 0; i < 100; i++)
        printf("func\n");

    pthread_mutex_unlock(&mymutex);

    pthread_exit(NULL);
}

int main(int argc, char *argv[])
{
    pthread_mutex_init(&mymutex, NULL);

    pthread_create(&mythread1, NULL, func, NULL);
    pthread_create(&mythread2, NULL, anotherFunc, NULL);

    pthread_join(mythread1, NULL);
    pthread_join(mythread2, NULL);

    pthread_mutex_destroy(&mymutex);

   return EXIT_SUCCESS;
} 
```*

# iphone - 将视图缩放到中心子视图

> ID：10161429
> 
> 赞同：0
> 
> 时间：2012-04-15T11:02:21.717
> 
> 标签：iphone, cocoa-touch, uiview, cgaffinetransform, cgaffinetransformscale

我有一个我似乎无法解决的问题。

我想缩放我的应用程序的视图，以便看起来视图已经“放大”，从而保持其纵横比并填充屏幕的整个宽度。

我（认为）我有一些数学可以完成这项工作，但我不确定如何在 CGAffineTransform 语句中应用它，或者如何使视图居中。

**第 1 步**：
缩放视图：

```
float scaleFactor = (320 / boxWidth);

self.view.transform = CGAffineTransformMakeScale(scaleFactor, scaleFactor); 
```

**第 2 步**：
定位视图，使其看起来居中：

```
CGRect newFrame = self.view.frame;

newFrame.x = 20;
newFrame.y = mainBox.frame.origin.y;    

self.view.frame = newFrame; 
```

这就是我卡住的地方。我不确定如何定位视图以使其看起来居中。

这是一张图片来展示我想要实现的目标：

![例子](../Images/e61760d1a0e5f0c854453958740c356b.png)

基本上，我希望视图缩放，以便黑框动画到红框的位置和大小。

我有点坚持这一点，所以任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T12:23:24.477

在这种情况下，只计算视图的最终帧并将其设置在动画块中会更容易：

```
CGRect newFrame = self.view.frame;
newFrame.size.height *= 320.0f / newFrame.size.width;
newFrame.size.width = 320.0f;
newFrame.origin.x = 0.0f;
// Set newFrame.origin.y as desired

[UIView animateWithDuration: 0.5 animations: ^{
    self.view.frame = newFrame;
}]; 
```

# c++ - 在可变参数模板中使用垫片的更简洁的方法？

> ID：10161431
> 
> 赞同：7
> 
> 时间：2012-04-15T11:02:23.223
> 
> 标签：c++, c++11, variadic-templates, shim

C++ 模板通常被同化为膨胀的创造者，而 Shim 的想法正是针对这一点：使模板只是常规函数的薄包装。这是减少臃肿的好方法。

例如，让我们使用一个简单的垫片：

```
//
// Shim interface
//
struct Interface {
    virtual void print(std::ostream& out) const = 0;
}; // struct Interface

std::ostream& operator<<(std::ostream& out, Interface const& i) {
    i.print(out);
    return out;
}

template <typename T>
struct IT: public Interface {
    IT(T const& t): _t(t) {}
    virtual void print(std::ostream& out) const { out << _t; }
    T const& _t;
};

template <typename T>
IT<T> shim(T const& t) { return IT<T>(t); } 
```

现在，我可以像这样使用它：

```
void print_impl(Interface const& t);

template <typename T>
void print(T const& t) { print_impl(shim(t)); } 
```

而且无论如何`print_impl`实现，`print`仍然非常轻量级，应该内联。十分简单。

* * *

然而，C++11 引入了*可变参数*模板。典型的冲动是使用 C++11 可变参数模板重新实现所有不安全的 C 可变参数，甚至 Wikipedia 也建议[使用`printf`implementation](https://en.wikipedia.org/wiki/Variadic_template)。

不幸的是，维基百科的实现不处理位置参数：允许您指定打印第三个参数的类型，等等......如果我们有一个带有这个原型的函数，那就很容易了：

```
void printf_impl(char const* format, Interface const* array, size_t size); 
```

或类似的。

现在，**我们如何从原始界面桥接**：

```
template <typename... T>
void printf(char const* format, T const&... t); 
```

**到上面的签名？**

shims 的一个困难是它们依赖于对 const-ref 行为的绑定来延长临时包装器的生命周期，而不必动态分配内存（如果这样做的话，它们*不会*便宜）。

一步完成绑定+数组转换似乎很困难。特别是因为语言中不允许引用数组（和指向引用的指针）。

* * *

对于那些感兴趣的人，我有一个解决方案的开始：

```
//
// printf (or it could be!)
//
void printf_impl(char const*, Interface const** array, size_t size) {
    for (size_t i = 0; i != size; ++i) { std::cout << *(array[i]); }
    std::cout << "\n";
}

template <typename... T>
void printf_bridge(char const* format, T const&... t) {
    Interface const* array[sizeof...(t)] = { (&t)... };
    printf_impl(format, array, sizeof...(t));
}

template <typename... T>
void printf(char const* format, T const&... t) {
    printf_bridge(format, ((Interface const&)shim(t))...);
} 
```

但是您会注意到引入了一个补充步骤，这有点烦人。尽管如此，[它似乎](http://ideone.com/Mk9Kg)仍然有效。

如果有人提出更好的实施方案，我将不胜感激。

* * *

@Potatoswatter 建议使用初始化列表，这[有点帮助](http://ideone.com/QLJCQ)（没有范围）。

```
void printf_impl(char const*, std::initializer_list<Interface const*> array) {
    for (Interface const* e: list) { std::cout << *e; }
    std::cout << "\n";
}

template <typename... T>
void printf_bridge(char const* format, T const&... t) {
    printf_impl(format, {(&t)...});
} 
```

但仍然没有解决中间函数问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T11:13:10.997

使其轻量级取决于消除类型参数化。您的 shim 可能会使用表达式实例化一些重任务`out << _t`，因此它可能不是一个很好的例子。

C varargs 通过将所有内容隐式转换为`intptr_t`. 如果您只想复制 C`printf`功能，您可以使用`reinterpret_cast`和执行相同的操作`initializer_list`。

```
template <typename... T>
void printf(char const* format, T const&... t) {
    printf_impl(format, { reinterpret_cast< std::intptr_t >( t ) ... } );
} 
```

这显然不是最理想的，但垫片本质上是有限的。如果你愿意，你可以用多态类型做其他事情`initializer_list`。

无论如何，这正是`initializer_list`它的目的。它只能从一个花括号初始化列表构造，使其大小成为编译时常量。但是大小只能作为运行时常量读回。因此，它唯一的实际用途是将仅在列表长度上不同的模板汇集到常见的可变长度实现中。

再加上`initializer_list`参数的生命周期语义——对象在堆栈上的一个连续数组中创建，并在函数调用语句结束时死亡——`initializer_list`看起来很像`<varargs>`！（编辑：或您的解决方案，我现在实际上已经回去阅读：vP）

**编辑：**由于容器不能直接存储多态对象，并且智能指针不适合临时参数对象，因此实现多态需要将指针指向临时对象。丑陋，但由于临时对象的生命周期保证是合法的：

```
template <typename... T>
void printf(char const* format, T const&... t) {
    printf_impl(format, std::initializer_list< Interface const * >
        { & static_cast< Interface const & >( shim(t) )... } );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-18T12:44:39.200

如果您可以使用同质（内存中的大小和对齐方式相同）类型，请[查看](https://github.com/Darelbi/Infectorpp2/blob/master/include/Infectorpp/InfectorContainer.hpp)：

```
// thin template layer over regular class/methods
template< typename T, typename... Contracts>
inline void Container::bindSingleAs(){

isMultiBase< T, Contracts...>(); //compile time test

    priv::TypeInfoP         types[ sizeof...( Contracts)]
                            { &typeid( Contracts)... };

    priv::SharedUpcastSignature upcasts[ sizeof...( Contracts)]
                            { &priv::shared_upcast< T, Contracts>... };

    // dispatch over non-template method.
    container->bindSingleAs( &typeid(T), types, upcasts, sizeof...(   Contracts));
} 
```

**现在由于评论而编辑后，我认为有两个相互矛盾的要求。**

1.  想要一个数组参数
2.  不想要复制开销

如果`printf_impl`函数需要一个数组作为参数，那么这意味着数组元素应该在内存中具有相同的配置（这意味着如果 1 个元素是 64 字节，那么即使它们是 1 个字节，也会强制所有其他元素对齐 64 字节。 .)**因此需要一个副本**，或者至少需要一个指向固定位置的指针的副本，所以绝对**不可能**做 OP 想要的。

**我们仍然可以构建该数组，但我们受到限制**：

1.  我们根本不想复制，那么我们应该静态声明数组的类型，这迫使我们构建第三种类型。

    `auto Array = MakeArray( /* values*/);`

    `printf( Array);`

2.  我们接受复制，所以我们在函数内部构建数组，因为值未知，我们可以对用户隐藏数组，但我们必须将参数复制到固定的内存位置，但是我们仍然将数组隐藏在引擎盖下。

3.  堆分配，允许在一个非常紧凑的数组中传递参数，但是参数必须驻留在其他地方并且堆分配可能很昂贵。

第一个解决方案是通过创建一个静态类型的数组来接受额外的编码复杂性，该数组可以处理元素（全部与最大元素对齐），但是这是次优的，因为增加对象的大小可能会影响性能（如果即使在函数调用之后数组仍然存在）

第二种解决方案隐藏了模板接口背后的复杂性，但是它无法避免将值临时复制到与第一种解决方案相同的数组的性能成本。

**所以，这是不可能的，对不起。**另一个答案介于 2 和 3 之间。所有其他可能的答案都在 3 个类别之一内。

# c# - 想要在用户触摸显示屏的左侧时触发事件

> ID：10161435
> 
> 赞同：1
> 
> 时间：2012-04-15T11:03:16.597
> 
> 标签：c#, windows-phone-7, silverlight-4.0, windows-phone-7.1

我在我的应用程序中使用了滚动查看器来显示图像。当用户触摸显示屏的右侧时，我需要在滚动查看器右侧移动堆栈面板，并在用户触摸左侧时向左移动。我在 XNA 框架中尝试，但 vector2 类不检查手指的位置。如何实现这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T21:22:48.470

您应该能够挂钩`MouseLeftButtonDown`页面的事件。[然后使用MouseEventArgs.GetPosition 方法](http://msdn.microsoft.com/en-us/library/cc190492%28v=vs.95%29.aspx)计算用户触摸屏幕的位置。这是一个演示此概念的基本示例：

**XAML**

```
<ScrollViewer Background="Red">
    <StackPanel x:Name="MyStackPanel" 
                Orientation="Vertical" 
                Width="150" 
                Background="Black"  
                HorizontalAlignment="Left">
        <ItemsControl ItemsSource="{Binding Images}">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Image Source="{Binding}" Width="48" Height="48" />
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </StackPanel>                
</ScrollViewer> 
```

**代码背后**

```
public MainPage()
{
    InitializeComponent();

    this.MouseLeftButtonDown += OnMouseDown;
}

private void OnMouseDown( object sender, MouseButtonEventArgs e )
{
    Point pos = e.GetPosition( this );

    double half = this.ActualWidth / 2;

    if( pos.X < half )
    {
        MyStackPanel.HorizontalAlignment = HorizontalAlignment.Right;
    }
    else
    {
        MyStackPanel.HorizontalAlignment = HorizontalAlignment.Left;
    }
} 
```

# f# - 类型提供程序在 f# 中为我提供“不支持的常量类型：System.double”错误

> ID：10161437
> 
> 赞同：1
> 
> 时间：2012-04-15T11:03:23.370
> 
> 标签：f#, type-providers

我想知道这个错误来自哪里。这是代码，在使用 fsahrpx DSL 的 TP 下面

更新：我找到了一个“解决方案”，即在外面进行演员表，每次演员表构造一个吸气剂。如果有人知道为什么会发生这种情况，或者有更好的解决方案，我会很高兴知道。（ProvidedTypes-0.2.fs 中的有限引用模式？）

**编辑**：我绝望的失败尝试并不那么有趣。例如，两个有趣的是 Test93 或 Test92。他们为什么会失败？

**更新** 添加了最诉讼案件 90,91,92,93

```
module Module =
   open System.Reflection
   open Samples.FSharp.ProvidedTypes
   open FSharpx.TypeProviders.DSL
   open Microsoft.FSharp.Core.CompilerServices

   type ReflectiveBuilder = static member Cast<'a> (args:obj) = args :?> 'a
      static member BuildTypedCast lType (args: obj) = 
            typeof<ReflectiveBuilder>
               .GetMethod("Cast")
               .MakeGenericMethod([|lType|])
               .Invoke(null, [|args|])

   let bbgReference ns =
       erasedType<obj> (Assembly.GetExecutingAssembly()) ns "Reference"
       |> staticParameter "file"
          (fun typeName (parameterValues:string) ->
               let otwo = 2.0 :> obj
               let dtwo = 2.0 
               let dotwo = otwo :?> float

               let dcast = ReflectiveBuilder.BuildTypedCast typeof<float>

               let getter = match otwo with
                              | :? double as d -> (fun args -> <@@ d @@>)
                              | :? string as d -> (fun args -> <@@ d @@>)

               erasedType<string> (Assembly.GetExecutingAssembly()) ns typeName
           |+!> (   provideProperty 
                       "test90"                             //KO
                       (typeof<obj>)                   
                       (fun args -> <@@  otwo  @@>)     
                 )
           |+!> (   provideProperty 
                       "test91"                             //KO
                       (otwo.GetType())                  
                       (fun args -> <@@  otwo  @@>)     
                 )
           |+!> (   provideProperty 
                       "test92"                             //KO
                       (otwo.GetType())                  
                       (fun args -> <@@  otwo  @@>)     
                 )
           |+!> (   provideProperty 
                       "test93"                              //NO
                       typeof<float>                   
                       (fun args -> <@@  otwo :?> float  @@>)     
                 )

               |+!> (   provideProperty 
                           "test"                             //OK
                           typeof<float>                   
                           (fun args -> <@@  dtwo  @@>)      
                     )
               |+!> (   provideProperty 
                           "test2"                              //NO
                           typeof<float>                   
                           (fun args -> <@@  dtwo :> obj @@>)     
                     )
               |+!> (   provideProperty 
                           "test3"                              //NO
                           typeof<float>                   
                           (fun args -> <@@  otwo  @@>)     
                     )
               |+!> (   provideProperty 
                           "test4"                              //NO
                           typeof<float>                   
                           (fun args -> <@@  otwo :?> float  @@>)     
                     )
               |+!> (   provideProperty 
                           "test5"                              //OK
                           typeof<float>                   
                           (fun args -> <@@  dotwo  @@>)     
                     )
               |+!> (   provideProperty 
                           "test6"                              //OK
                           typeof<float>                   
                           (fun args -> <@@  dotwo :> obj  @@>)     
                     )
               |+!> (   provideProperty 
                           "test7"                              //NO
                           typeof<float>                   
                           (fun args -> <@@  dcast otwo  @@>)     
                     )
               |+!> (   provideProperty 
                           "test8"                              //OK
                           typeof<float>                   
                           getter    
                     )
               |+!> (provideConstructor
                        []
                        (fun _ -> <@@ "I will be the internal representation" @@>)))

   [<TypeProvider>]
   type public CustomTypeProvider(cfg:TypeProviderConfig) as this =
      inherit TypeProviderForNamespaces()

      do this.AddNamespace("TEST", [bbgReference "TEST"])

   [<TypeProviderAssembly>]
   do() 
```

测试

```
module Program =
   open System

   type t = TEST.Reference<"">
   let price = t().Test90
   let price = t().Test91
   let price = t().Test92
   let price = t().Test93
   let price = t().Test    //OK
   let price = t().Test2   //OK
   let price = t().Test3   //NO OK
   let price = t().Test4   //NO OK
   let price = t().Test5   //OK
   let price = t().Test6   //OK
   let price = t().Test7   //NO OK
   let price = t().Test8   //OK 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T14:05:33.280

可以出现在 F# 类型提供程序的属性和方法的引用代码中的表达式非常有限 - 我在编写类型提供程序时遇到了同样的问题。我不认为目前有一个精确的规范，所以找出答案的唯一方法是查看源代码或进行实验。

原因是，将 F# 引用编译为 IL 尚未在任何地方完全实现，因此类型提供程序的代码生成器可能只是实现了足以使其工作的基本功能。

在编写提供程序时，我通常遵循一种模式，即所有“运行时”代码都放在一个模块中，而传递给方法或属性的引用代码只是调用这个运行时。这是可行的，因为引用只是一个方法调用。就像是：

```
module CultureRuntime =
  let getCulture (name:string) = 
    // The runtime can contain arbitrary complex F# code
    CultureInfo.GetCultureInfo(name) 
```

向提供者添加属性时，引用仅调用`CultureRuntime.getCulture`：

```
for culture in CultureInfo.GetCultures(CultureTypes.AllCultures) do
  let id = culture.Name
  ProvidedProperty
    ( culture.DisplayName, typeof<CultureInfo>, IsStatic = true,
      GetterCode = fun args -> <@@ CultureRuntime.getCulture id @@>)
  |> sampleTy.AddMember 
```

**编辑：**我不太熟悉类型提供程序的代码生成在内部是如何工作的，但是您发现令人惊讶的情况几乎总是可以使用`<@ otwo @>`或类似`otwo`的，类型的东西在哪里`System.Object`。

当类型提供者从引用生成代码时，它需要为表达式生成 IL 代码`otwo`。但是，这通常没有意义，因为如果`otwo`是 type `System.Object`，那么您不能生成重新创建对象的 IL（或以其他方式序列化对象）。

出于这个原因，F# 类型提供程序机制（可能）只允许可以轻松转换为 IL 的原始值（例如`float`您的`<@ dtwo @>`示例中的类型值）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T21:50:36.960

我们计划在接下来的几周内在示例 codeplex 站点上发布对提供类型 API 的更新/修复。这个问题也将得到解决。

# python - “倒着”建树

> ID：10161440
> 
> 赞同：1
> 
> 时间：2012-04-15T11:03:52.517
> 
> 标签：python

我需要在 Python 中创建一个树状结构。我有一个函数 get(parentId)，它返回一个包含该父对象的对象列表——我认为这应该递归完成。

结果应该是这样的：`["root object", ["child1 of root", "child2 of root", ["child2-1", "child2-2"]]]`

每个对象都有一个属性 parent，即 get() 的 parentId，但作为起点，我只有根对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T11:21:47.897

树有一个标准的数据结构，它不是列表的列表。

创建一个 class `Node`，其属性`children`包含一个`list`（或者`set`，如果您不关心顺序）“子”节点。还要创建一个方法，该方法`add_child`采用一个节点，设置该节点的`parent`，并将其添加到`children`列表中。就像是：

```
class Node(object):
    def __init__(self, children={}):
        self.parent = None
        self.children = children

    def add_child(self, child):
        child.parent = self
        self.children.add(child) 
```

要遍历树，只需询问根的孩子，然后是他们的孩子，等等。这可以递归地完成，但为了速度和内存效率，您可能希望在 Python 中迭代地完成。

```
def walk(root):
    yield root
    for child in root.children:
        for elt in walk(child):
            yield elt 
```

* * *

当然，这已经做过很多次了，所以你不应该自己写它，除非它是家庭作业或学习练习。

由于 HTML/XML 文档的结构类似于树，因此您可能应该将许多 DOM 树库之一用于实际数据结构。尝试`xml.dom.minidom`或`lxml`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T11:23:31.770

假设您仍然对树的列表表示感兴趣（这不一定是无用的事情），这是一个递归函数定义，我相信它可以满足您的需求（前提是该`get()`函数确实之前已定义）：

```
def build_tree(node):
    return [node,[build_tree(child) for child in get(node)]] 
```

您可以以类似于以下方式使用它：

```
root = 1  # or whatever other representation you may use for root
list = build_tree(root)
print list 
```

# asp.net - ASP.NET 登录控件、页面回发和注销时呈现

> ID：10161442
> 
> 赞同：2
> 
> 时间：2012-04-15T11:03:55.703
> 
> 标签：asp.net, login, postback

我对默认 ASP.NET[身份验证控件](http://msdn.microsoft.com/en-us/library/ms178329.aspx)的行为感到有些困惑，确切地说是其生命周期。

在我的`MasterPage`中，我添加了一个`LoginView`控件，它显示了漂亮的 [Login] 或 [Logout] 链接。当我登录并单击 [注销] 时，我将控件设置为执行重定向到应用程序的主页。

在内部，当点击“注销”时，会触发回发。发生以下步骤（当然还有其他步骤）：

1.  触发回发的页面被重新初始化
2.  触发回发的页面被重新加载
3.  LoggingOut 事件被触发
4.  LoggedOut 事件被触发
5.  触发回发的页面是 PreRendered
6.  重定向发生
7.  目标页面已加载（在我的情况下为 LoggedOut.aspx）

在大多数页面上，这都很好。但是有些页面期望一些数据被初始化以使其渲染正确发生。发生此注销回发时，数据未正确初始化，但页面仍处于 PreRendered 状态，这会导致一些...“意外行为”>_<

因此，我的问题是双重的：

*   由于页面根本不会显示，为什么会发生此渲染步骤？
*   有没有办法防止渲染发生？

非常感谢。蒂姆

PS：如果您想自己尝试一下，这里有一个小的 VS2010 示例项目，向您展示调用顺序和页面生命周期[http://dl.dropbox.com/u/11764136/LoginTest.7z](http://dl.dropbox.com/u/11764136/LoginTest.7z)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T11:10:23.697

有一种方法可以防止页面的实际呈现。

重定向页面时停止处理当前请求。这可以通过为 Response.Redirect 方法提供一个 true 参数来完成：

```
Response.Redirect("http://somewhere", true); 
```

您也可以通过调用 Response.Close(); 手动执行此操作；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T11:33:20.087

您是否使用 if(!isPostBack) 测试来控制应该渲染/重新初始化什么以及不应该渲染什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T12:24:54.013

Venemo 的回答给了我一个似乎可行的想法。

我没有依赖`LoginStatus`组件来执行重定向，而是将托管`LoginStatus`组件的 MasterPage 注册到`LoginStatus.LoggedOut`事件并在调用 PreRender 步骤之前*“手动”触发重定向。*

```
protected void Page_Load(object sender, EventArgs e)
{
   MasterLoginStatus.LoggedOut += new EventHandler(OnUserLoggedOut);
}

private void OnUserLoggedOut(object sender, EventArgs e)
{
   Response.Redirect("~/LoggedOut.aspx", true);
} 
```

我担心这样做`LoginStatus`可能会使组件保持*肮脏*，但到目前为止我还没有发现任何问题，例如“在证明其他情况之前有效”。

仍然是“为什么组件的行为如此”的问题，但我想这是一个尚未得到解答的设计决策。

编辑：这工作正常，直到您遇到“登录”操作的相同问题。还没有找到解决这个问题的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T01:00:46.810

我有一个 DevExpress 控件（报告 DocumentMap）的严重问题，当最终用户单击 LoginStatus 控件上的注销链接时，它有时会绕过缓存机制请求整个报告。我已经尝试了很多方法来阻止“注销”回发，这样就不会生成报告（有些报告需要 5 分钟才能呈现，所以注销操作有时需要那么长时间）。我认为这与您的问题相似：如果用户正在注销，您不想进行任何繁重的处理。所以我尝试了一种不同的方法：为什么我没有认识到回发确实是注销回发？我的所有页面都继承自基本页面，因此我在基本页面中设置了以下代码：

```
public bool IsLoggingOut { get; private set; }

protected override void OnPreInit(EventArgs e)
{
    base.OnPreInit(e);
    var eventTarget = Request.Params.Get("__EVENTTARGET");
    IsLoggingOut = eventTarget != null && eventTarget.Contains("HeadLoginView$HeadLoginStatus");
} 
```

现在我需要在我的页面中做的就是用 !IsLoggingOut... 的测试来包围任何繁重的处理，您甚至可以重定向到 LoggedOut 页面而无需处理任何事件，就像这样：

```
protected override void OnLoad(EventArgs e)
{ 
    if (IsLoggingOut)
        Response.Redirect("~/LoggedOut.aspx", true);
} 
```

即使您更喜欢使用事件处理程序来执行重定向，能够知道回发确实是由于注销点击是一件好事！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-21T19:07:32.430

就我而言，我遇到了[LoginStatus](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.loginstatus(v=vs.110).aspx)控件的问题。`Render`我不明白为什么当用户单击“注销”时回发和页面是一个有用的设计。通过一些测试，我发现我必须让页面经历它的整个生命周期，所以`Reponse.End()`并`Response.Transfer()`没有工作。

我的解决方案是为 LoginStatus`LoggedOut`事件添加事件处理程序，然后在用户注销时覆盖`Render()`母版页中的方法以不执行*任何操作。*实际上，我将 LoginStatus 嵌套在母版页中的用户控件中，因此我不得不冒泡该事件。

在包含该控件的用户控件中`LoginStatus`，我为该事件添加了一个事件处理程序`LoggedOut`。在 UserStatus.aspx 文件中：

```
<asp:LoginStatus runat="server" ID="loginStatusDefault" OnLoggedOut="loginStatusDefault_LoggedOut" ... /> 
```

然后在代码隐藏中：

```
public event EventHandler LoggedOut;
protected void loginStatusDefault_LoggedOut(object sender, EventArgs e)
{
    if (this.LoggedOut != null)
     this.LoggedOut(sender, e);
} 
```

现在在母版页 default.master 中，我已经包含了 UserStatus 控件：

```
<c:userstatus ID="ctlUserStatus" runat="server" /> 
```

在代码隐藏中：

```
protected void Page_Init(object sender, EventArgs e)
{
    ctlUserStatus.LoggedOut += ctlUserStatus_LoggedOut;

    ...
}

bool IsLoggedOut { get; set; }

void ctlUserStatus_LoggedOut(object sender, EventArgs e)
{
    IsLoggedOut = true;
}

protected override void Render(HtmlTextWriter writer)
{
    if (!IsLoggedOut)
        base.Render(writer);
} 
```

对我来说，页面渲染是用户单击“注销”时爆炸的原因，因此这解决了所有页面的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-28T20:10:08.420

我所做的是让注销链接或注销控件重定向到另一个页面“Logout.aspx”，然后处理注销代码。实际上效果很好。

```
protected void LoginStatus1_LoggingOut(object sender, EventArgs e) 
        {

            Response.Redirect("~/Logout.aspx");
        } 
```

# java - JTable 使用数组字符串。这些数据在 try-catch

> ID：10161443
> 
> 赞同：1
> 
> 时间：2012-04-15T11:04:04.610
> 
> 标签：java, swing, jtable, try-catch, jlist

该程序必须从 MySQL 数据库下载数据。并填写`JList`. 我想绑定这些数据。

在这里你有一个代码：

```
 Connection connection = null;
    String dbtime;
    String query = "Select * FROM EMP";
    String[] celDatas = null;
    String[] celNames = null;
    try {

        (...)

        Statement stmt = connection.createStatement();
        ResultSet rs = stmt.executeQuery(query);
        ResultSetMetaData rsmd = rs.getMetaData();

        int NumOfCol = rsmd.getColumnCount();
        celNames = new String[NumOfCol];
        celDatas = new String[NumOfCol];

        for(int weq=1; weq<=NumOfCol; weq++) {
            System.out.println(rsmd.getColumnName(weq));
            celNames[weq-1] = rsmd.getColumnName(weq);
            while (rs.next()) {
                dbtime = rs.getString(weq);
                System.out.println(dbtime);
                celDatas[weq-1] = dbtime;
            }
            rs = stmt.executeQuery(query);
            System.out.println();
        }
    } catch (ClassNotFoundException e) {

    } catch (SQLException e) {

    }

final JList source = new JList(celDatas,celNames);
JScrollPane pane = new JScrollPane(source);
pane.setSize(f.getSize().width-60,300);
pane.setLocation(30,20); 
```

我有问题

```
final JList source = new JList(celDatas,celNames); 
```

它在 Netbeans 中显示了这个问题：http: [//dl.dropbox.com/u/8455739/Java-Problem.png](http://dl.dropbox.com/u/8455739/Java-Problem.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T11:13:36.333

```
//String[] celDatas = null;
String[][] celDatas = null;
String[] celNames = null;
...
//final JList source = new JList(celDatas,celNames);
final JTable source = new JTable(celDatas,celNames); 
```

# c++ - 点列表中的最佳路径c ++

> ID：10161445
> 
> 赞同：1
> 
> 时间：2012-04-15T11:04:12.523
> 
> 标签：c++, algorithm, path, euclidean-distance

我有这个要求：我有一个点列表，对于每个点我都有 X、Y 坐标。

我的目标是找到这些点之间的最佳路径（我必须使用所有点）。例如：

A(xa, ya), B(xb, yb), C(xc, yc), D(xd, yd), E(x, y) 我用两点之间的欧式距离计算

我的最佳路径是例如：D、E、A、C、B

我怎么能做这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T11:07:18.583

您正在描述一个被称为[**旅行商问题**](http://en.wikipedia.org/wiki/Travelling_salesman_problem)[的NP-Hard](http://en.wikipedia.org/wiki/NP-hard)问题。[](http://en.wikipedia.org/wiki/Travelling_salesman_problem)

 **这个问题**没有已知的多项式解决方案**，但它有一些启发式方法，它们在多项式时间内运行，但不能保证找到最佳路径。

如果您想要最佳 -可能需要[**蛮力搜索。**](http://en.wikipedia.org/wiki/Brute-force_search)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T04:37:20.307

问题确实是 NP-Hard，但是对于在欧几里得空间中有点并且使用欧几里得度量来测量距离的特殊情况，有多项式时间逼近方案可以任意接近最优解。查看[这篇](http://www-sop.inria.fr/members/Frederic.Havet/Cours/p753-arora.pdf)论文（欧几里得旅行商问题的一个相对著名的近似算法）。**

# android - 尝试将新事件插入日历时出错

> ID：10161447
> 
> 赞同：0
> 
> 时间：2012-04-15T11:04:16.780
> 
> 标签：android, calendar

我正在尝试向日历添加一个新事件（最小 sdk 版本为 2.2）。
那是我到目前为止的代码：

```
ContentValues event = new ContentValues();

event.put("calendar_id", 2);
event.put("title", "mytitle");
event.put("description", "desc");
event.put("eventLocation", "loc");
event.put("eventTimezone", Calendar.getInstance().getTimeZone().getDisplayName());

long startTime = System.currentTimeMillis() + 1000 * 60 * 60;
Long duration = 1000L * 60 * 30;

event.put("dtstart", startTime);
event.put("duration", duration);

Uri eventsUri = Uri.parse("content://com.android.calendar/events");
Uri insertedUri = getContentResolver().insert(eventsUri, event); 
```

但`insertedUri`始终为空。
我也可以在我的 logcat 中看到该行：

```
Failed to find provider info for calendar 
```

任何人都可以帮助我吗？
谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T11:08:59.580

Android中**没有**默认日历。所以，它总是找不到提供者。这就是为什么之前没有公共 API 的原因。您将必须安装一个日历应用程序，例如谷歌日历。对于其他第三方应用程序，请通过他们的 api。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T09:16:03.200

我在[这里](http://www.andreabaccega.com/blog/2010/08/09/add-events-on-google-calendar-on-android-froyo/)找到了答案。
谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T09:28:50.420

你也可以试试这个

```
public static void addToCalendar(Context ctx, final String title,
            final long dtstart, final long dtend, final String location) {

        Intent intent = new Intent(Intent.ACTION_EDIT);
        intent.setType("vnd.android.cursor.item/event");
        intent.putExtra("beginTime", dtstart);
        intent.putExtra("allDay", false);
        intent.putExtra("rrule", "FREQ=YEARLY");
        intent.putExtra("endTime", dtend);
        intent.putExtra("title", title);
        intent.putExtra("eventLocation", location);
        ctx.startActivity(intent);
    } 
```

# java - 如何在 windows-64bit“家庭高级版”中设置 javamail 路径和类路径

> ID：10161448
> 
> 赞同：2
> 
> 时间：2012-04-15T11:04:27.010
> 
> 标签：java, jakarta-mail

我已经在 Windows（64 位）上安装了 java。我的问题是：如何在我的 PC 上安装 Javamail？我用这种方式来创建类路径`%classpath%;c:\....`等。但仍然无法正常工作。我得到了错误

> 导入 javax.mail 无法解析

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T11:17:27.787

要安装 Javamail，您应该查看[自述](http://www.oracle.com/technetwork/java/javamail145readme-1562609.html)文件。其中指出：

> 请注意，如果您使用的是 JDK 1.5 或更早版本，JavaMail API 还需要安装 JavaBeans(TM) 激活框架包。从以下位置下载最新版本的 JavaBeans 激活框架
> 
> ```
> http://www.oracle.com/technetwork/java/javase/index-jsp-136939.html 
> ```
> 
> 并将其安装在合适的位置。

和

> 1.  解压缩 javamail1_4_5.zip 存档。（您可能已经这样做了。）
>     
>     
> 2.  设置您的 CLASSPATH 以包含从下载获得的“mail.jar”文件以及当前目录。
>     
>     
>     
>     假设您在 c:\download 中解压缩了 javamail1_4_5.zip，则以下内容将起作用：
>     
>     
>     
>     设置 CLASSPATH=%CLASSPATH%;c:\download\javamail-1.4.5\mail.jar;。
>     
>     
>     
>     此外，如果您使用的是 JDK 1.5 或更早版本，请将您从下载 JavaBeans 激活框架中获得的“activation.jar”文件包含在您的 CLASSPATH 中。
>     
>     
>     
>     设置 CLASSPATH=%CLASSPATH%;c:\download\activation\activation.jar
>     
>     
> 3.  进入演示目录
>     
>     
> 4.  使用您的 Java 编译器编译任何演示。例如：
>     
>     
>     
>     javac msgshow.java
>     
>     
> 5.  运行演示。'-' 选项列出了成功运行任何演示所需的和可选的命令行选项。例如：
>     
>     
>     
>     java msgshow -
>     
>     
>     
>     列出可用选项。和
>     
>     
>     
>     java msgshow -T imap -H -U -P -f INBOX 5
>     
>     
>     
>     使用 IMAP 协议显示收件箱中的第 5 条消息。

# eclipse - 通过命令行刷新eclipse项目

> ID：10161457
> 
> 赞同：8
> 
> 时间：2012-04-15T11:05:19.567
> 
> 标签：eclipse, command-line, batch-file

如何通过命令行刷新 eclipse 项目？

（相当于*右键单击>*在包视图中刷新）
我需要在 Maven 夜间构建之后从批处理中刷新 Eclipse。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T20:26:37.880

我知道有蚂蚁任务可以做到这一点：

```
<eclipse.convertPath fileSystemPath="/workspace/org.example.project"
                     property="resourcePath"/>
<eclipse.refreshLocal resource="${resourcePath}" depth="infinite"/> 
```

至于从命令行运行它，作为最坏的情况，您可以将其粘贴在 ant 脚本中调用 eclipse antrunner 应用程序：

> eclipse -nosplash -application org.eclipse.ant.core.antRunner -f refresh.xml

# iphone - 如何从通过 NSthread 调用的函数中获取返回值？

> ID：10161459
> 
> 赞同：6
> 
> 时间：2012-04-15T11:05:24.393
> 
> 标签：iphone, objective-c, ios, ipad, nsthread

我写了一个返回对象的函数。但它是一个从 web 获取数据的函数。所以 NSthread 用于调用该函数。

```
 NSThread* pageThread = [[NSThread alloc]initWithTarget:self selector:@selector(threadFunction) object:nil]; 
```

如何从通过 NSthread 调用的函数中获取返回值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T11:10:21.217

该方法不应该返回“返回值”，但它应该更新类 iVar 并通知正在等待对象的任何人它现在已准备好（通过通知我不一定是指 NSNotificationCenter）。祝你好运。

# xpages - 代理运行时 XPage 缓慢

> ID：10161461
> 
> 赞同：1
> 
> 时间：2012-04-15T11:05:42.303
> 
> 标签：xpages

我在具有长时间运行的导出代理的数据库中看到了一些奇怪的 XPage 缓慢。我解雇了导出代理，所有 xpages 开始在应用程序中变慢。如果我查看服务器，代理管理器正在使用 25% 的 CPU，因此剩余的 CPU 资源充足。我没有任何从 XPage 运行的代理。还有人看到这个吗？有没有办法防止这种情况发生？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T19:33:38.703

原因可能是众多原因之一。您需要开始诊断正在发生的事情以发现争用发生的位置。例如，如果您正在读取/写入大量文档，那么根据您的磁盘配置，磁盘子系统中可能存在争用。或者，如果您的内存太低，您可能会导致 JVM 中发生大量垃圾收集，这也可能导致缓慢。

我将从 XPages Toolbox 开始，看看您是否可以确定减速发生的位置并从那里进行调查。如果您需要深入了解，请查看 yourkit java profiler (http://www.yourkit.com)，它会为您提供大量信息以帮助识别来源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T06:21:37.343

...也许您应该尝试分析您的代理，看看代码中是否有任何明显的地方可以提高性能。对相同数据的并发访问可能会导致糟糕的响应时间（尤其是在写入访问可能会强制视图重建的情况下）。尝试在不访问与导出代理相同的数据的数据库中打开 XPage - 仍然很慢？

要配置代理，您可以在设计器中打开它，然后在属性的“基本”选项卡上启用“配置此代理”:-)

/约翰

# objective-c - 在 UIPopoverController 中添加一个视图

> ID：10161465
> 
> 赞同：0
> 
> 时间：2012-04-15T11:05:55.123
> 
> 标签：objective-c, ios, xcode, ipad, sdk

我创建了一个具有多个控制器的 UIView，有没有办法添加这个视图，`UIPopoverController`因为 UIPopoverController 只支持 ViewController！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T11:08:25.337

创建一个 UIViewController 并将您的 UIView 分配为它的 .view 属性。然后你可以在创建它时将它传递给 UIPopoverController。

# eclipse - eclipse中不同视角切换的捷径是什么

> ID：10161470
> 
> 赞同：53
> 
> 时间：2012-04-15T11:06:54.537
> 
> 标签：eclipse, debugging, shortcut, perspective

我的 Eclipse 上安装了 PyDev、Java 和 CDT，有时我需要在不同的视角之间切换；**例如，调试**到**Pydev**。Eclipse 是否有在它们之间切换的快捷方式？

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2012-04-15T11:11:34.530

在视角之间切换。

*   窗户：`Ctrl`+`F8`

*   麦克：`cmd`+`F8`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-06-26T15:47:00.450

您可以在 Window->Preferences 中为特定透视图指定热键：

[![在此处输入图像描述](../Images/77d582c5acae7af06156cba426d2766e.png)](https://i.stack.imgur.com/MA4Ew.png)  

您可以使用“导出 CSV ...”将这些导出到文件，如果有兴趣，这里是我的 -

*   [http://justinreina.com/misc/17_06_26_eclipse/jmr_hotkeys.csv](http://justinreina.com/misc/17_06_26_eclipse/jmr_hotkeys.csv)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-04-16T04:35:27.083

Ubuntu：`Ctrl`+`F8`与 windows 相同

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-08-16T21:08:41.803

Command-F8 允许您在 Eclipse for Mac 中更改透视图。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-04-11T17:51:15.437

Eclipse 允许您轻松更改透视图。`Ctrl + F8`仍然在默认/常规和最近的视角之间切换。工具栏快捷方式也可用。 [工具栏快捷方式图片](https://i.stack.imgur.com/e0MHE.jpg)

# c++ - 从普通函数调用虚函数

> ID：10161472
> 
> 赞同：2
> 
> 时间：2012-04-15T11:06:58.420
> 
> 标签：c++, polymorphism, virtual

```
class base
{
public:
    void virtual func(){cout<<"base";}
    void check()
    {
        func();
    }
};
class derived: public base
{
public:
    void func(){cout<<"dervied";}
};
int main()
{
    base *obj = new derived();
    obj->check();
    return 0;
} 
```

上面的代码打印在控制台上。现在，我理解了虚函数的概念，但我无法在这里应用它。在我的理解中，每当我们调用虚函数时，编译器都会修改调用`"this->vptr->virtualfunc()"`，这就是最重要的派生类函数被调用的方式。但是在这种情况下，既然`check()`不是虚函数，那么编译器如何确定它需要调用`func()`派生的呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-15T11:09:57.313

> 编译器如何确定它需要调用派生的 func() ？

以同样的方式 - 通过调用`this->vptr->virtualfunc()`. 回想一下，即使在基类内部也`this`属于*派生*类，因为每个派生类*也是一个*基类，因此访问虚函数的相同方式也适用于它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T11:09:57.407

完全按照您所说的方式，通过`vptr`在类成员中使用。它知道函数是`virtual`，因此它知道它必须通过虚函数表调用它。

# codeigniter - 使用表单更新记录 - Codeigniter 2.1

> ID：10161476
> 
> 赞同：0
> 
> 时间：2012-04-15T11:07:35.960
> 
> 标签：codeigniter, crud

我在 CI 2.1 中的更新有一些问题我按照用户指南“mini-tut”来创建电子新闻，但我不明白如何用表格更新记录。

我的更新模型是：

```
 // update dei record
public function update_news($id)
{
    $data = array(
        'title' => $this->input->post('title'),
        'slug' => $this->input->post('slug'),
        'text' => $this->input->post('text')
        );

    $this->db->where('id', $id);
    $this->db->update('news', $data); 
} 
```

我怎样才能使控制器更新？我尝试：

```
 public function update($id)
 {
  $this->load->helper('form');
  $this->load->library('form_validation');

  $data['title'] = 'Update an intem';

  $this->form_validation->set_rules('title', 'Title', 'required');
  $this->form_validation->set_rules('text', 'text', 'required');

  if ($this->form_validation->run() === FALSE)
  {
   $this->load->view('templates/header', $data); 
   $this->load->view('news/update');
   $this->load->view('templates/footer');
  }
 else
  {
   $this->news_model->update_news($id);
   $this->load->view('news/success');
  }
 } 
```

但我显示一个 404() 页面...

更新的意见是：

```
 <h2>Update an item</h2>

<?php echo validation_errors(); ?>

<?php echo form_open('news/update') ?>

 <label for="title">Title</label> 
 <input type="input" name="title" /><br />

 <label for="slug">Slug</label> 
 <input type="input" name="slug" /><br />

 <label for="text">Text</label>
 <textarea name="text"></textarea><br />

 <input type="submit" name="submit" value="Update an item" /> 

</form> 
```

任何人都可以帮助我如何进行“简单”更新以了解 CI 逻辑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T08:35:43.733

如果我明白你想要什么，那么你应该将 $this->input->post(x) 从你的控制器传递给模型。我个人一直这样使用它：

控制器：

```
$data = array(
   'title' => $this->input->post('title'),
   'text' => $this->input->post('text'),
   'slug' => $this->input->post('slug'),
);
if($this->my_model->exists($id)) {
    $this->my_model->update($id, $data);
} else {
    $this->my_model->insert($data);
} 
```

您的模型应如下所示：

```
// update dei record
public function update($id, $data)
{
    $this->db->where('id', $id);
    $this->db->update('news', $data); 
} 
```

您的控制器使用第一段作为控制器方法的参数：

```
public function update($id) 
```

您也可以尝试使用

```
$id = $this->uri->segment(3); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-07T04:04:52.763

//控制器 public function update($id) { $this->load->helper('form'); $this->load->library('form_validation');

```
 $data['title'] = 'Update an intem';

    $this->form_validation->set_rules('title', 'Title', 'required');
    $this->form_validation->set_rules('text', 'text', 'required');
    $data['news'] = $this->news_model->get_news_by_id($id);

    if ($this->form_validation->run() === FALSE)
    {
        $this->load->view('templates/header', $data); 
        $this->load->view('news/update', $data);
        $this->load->view('templates/footer');
    }
    else
    {
        $this->load->helper('url');
        $this->news_model->update_news($id);
        redirect('/news', 'refresh');
    }
} 
```

* * *

//模型 public function update_news($id) {

```
 $data = array(
        'title' => $this->input->post('title'),
        'slug' => $this->input->post('title'),
        'text' => $this->input->post('text')
    );
    $this->db->where('id', $id);
    $this->db->update('news', $data);
} 
```

* * *

看法

## 

```
<label for="title">Title</label>
<input type="input" name="title" value="<?php echo $news[0]['title'];?>" /><br />
<input type = "hidden" name="id" value="<?php echo $news[0]['id'];?>" />
<label for="text">Text</label>
<textarea name="text"><?php echo $news[0]['text'];?></textarea><br />

<input type="submit" name="submit" value="Create news item" /> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-16T09:05:24.203

在代码点火器中添加页面

我会给你我做过的例子

模型：

```
function add()      
{        
   $name=$_POST['name'];        
   $department=$_POST['dept'];      
   $degree=$_POST['degree'];        
   $mark=$_POST['mark'];    

   $this->db->query("INSERT INTO `simple`(name,department,degree,mark) VALUES('$name','$department','$degree','$mark')");       
} 
```

控制器：

```
public function add()   
{   
   $this->load->model('modd');      
   $this->modd->add();      
   $this->load->view('add');    
} 
```

意见：

添加.php

```
<form method="post" action="<?php base_url();?>index.php/contr/add">
    <table>
        <?php echo form_open('contr/add');?>
        <tr>
            <th>Name</th>
            <td><input type="text" name="name" /></td>
        </tr>
        <tr>
            <th>Department</th>
            <td><input type="text" name="dept" /></td>
        </tr>
        <tr>
            <th>Degree</th>
            <td><input type="text" name="degree" /></td>
        </tr>
        <tr>
            <th>Marks</th>
            <td><input type="text" name="mark" /></td>
        </tr>
        <tr>
            <td><input type="submit" name="add" value="Add" /></td>
        <?php echo form_close(); ?>
            <td>
                <a href="<?php echo base_url(); ?>index.php/contr/view"><input type="button" value="view" /></a>
            </td>
        </tr>
    </table> 
```

# performance - 哪个更好 - 浏览器内动画或嵌入式视频？

> ID：10161480
> 
> 赞同：0
> 
> 时间：2012-04-15T11:08:18.980
> 
> 标签：performance, html, memory, animation, html5-video

# 概括

当使用与音乐同步的在舞台上移动的大图像进行动画制作时，使用 HTML5 直接在浏览器中为图像制作动画还是使用视频标签生成要嵌入的动画剪辑更好？

## 多一点

我正在计划将基于 Flash 的部分动画网络漫画转换为 HTML5。我偶尔使用的动画元素非常简单，通过在舞台上移动/缩放/淡化分层的静态图像来完成。音乐同步到这些片段。

考虑到动画的简单性，我认为 Flash 是多余的，我可以使用 java、css 和 HTML 完成相同的效果。然后，我将受益于，例如，能够使用 Phonegap 创建应用程序版本。

但是，我不确定这是否是一种性能方面的好方法。生成可以嵌入在适当点的适当片段的视频动画（例如使用 Flash）或使用 HTML5 在浏览器中直接为图像本身制作动画会更好吗？就此而言，即使是简单的 HTML5 动画，在不同浏览器之间是否也能可靠地保持一致？

# eclipse - Eclipse CDT：停止配置 GDT

> ID：10161483
> 
> 赞同：0
> 
> 时间：2012-04-15T11:08:28.607
> 
> 标签：eclipse, debugging, mingw, eclipse-cdt

我已按照本指南配置 Eclipse CDT。[Eclipse CDT 指南](http://www.dcs.vein.hu/bertok/oktatas/cpp_by_eclipse/eclipse_for_cpp_on_windows.html#Install_gdb)

在我跟随之后，我可以在 C++ 上运行程序。但是，当我调试它时。进行中的窗口，它总是停在：`Configuring GDB`（84%）

请帮我。

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T15:39:24.000

您可能想查看：[http ://www.eclipse.org/forums/index.php/m/831861/?srch=configuring+GDB#msg_831861](http://www.eclipse.org/forums/index.php/m/831861/?srch=configuring+GDB#msg_831861)

我的解决方案是安装 eclipse helios。

# vb.net - 如何在 VB.NET 中绘制图片上方

> ID：10161486
> 
> 赞同：0
> 
> 时间：2012-04-15T11:08:49.950
> 
> 标签：vb.net, graphics, 2d

我正在构建一个 2D 游戏，其中用户是一个圆圈（：P），而敌人是朝他而来的矩形。然而，我的问题是，当我在互联网上放置一张非常漂亮的空间图片时，屏幕会在这张图片下方绘制它所拥有的任何内容。一切正常，当有什么东西撞到我身上时，我仍然可以看到我的生活正在走下坡路——除了这一切都被这张照片掩盖了。

简而言之，我的问题是：我如何在此之上绘制所有内容 - （我尝试使用“发送回”命令）

编辑：表单通过计时器绘制所有内容，用户通过键控制他的角色。这可能无济于事 - 但如果有，它就在这里。抱歉，人们认为您不需要代码。这里是：

在 mybase.load 过程中： `PicBackGround.Dock = DockStyle.Fill` PicBackGround 是带有图像的图片框。

在油漆过程中：

```
 e.Graphics.Clear(Color.Black)
        e.Graphics.FillEllipse(Brushes.Orange, Player)

        'Projectiles
        Dim i As Integer = 0
        Do
            If Current_Projectile(i).IsEmpty = False Then e.Graphics.FillRectangle(Brushes.Red, Current_Projectile(i))
            i += 1
        Loop Until i = UBound(Current_Projectile)

        'Objects
        i = 0
        Do
            If Objects(i).IsEmpty = False Then e.Graphics.FillRectangle(Brushes.Blue, Objects(i))
            i += 1
        Loop Until i = UBound(Objects) 
```

好的： Player 是一个在顶部声明的矩形， `Dim Player As New Rectangle(0, 0, 50, 50)`; 然后是数组 Objects，它存储有关向玩家攻击的敌人的所有数据，Current_Projectiles 只是一个数组，用于存储有关玩家发射的矩形（子弹）的数据。

还有什么你想知道的就告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T13:02:59.207

是的，控件与您在表单上绘制的任何内容重叠。一个简单的解决方案是改用表单的 BackgroundImage 属性。或者自己画图。

# ruby-on-rails - Devise 是否仅适用于 STI 模型？

> ID：10161501
> 
> 赞同：1
> 
> 时间：2012-04-15T11:11:41.877
> 
> 标签：ruby-on-rails, controller, devise, helper

当您尝试自定义其行为时，我无法理解设计的工作原理。

我有两种不同的模型要处理：**Society**和**Collaborator**，并且它们的注册表必须在相同的视图中。
所以我必须通过编写一个处理这两个模型的新控制器来覆盖**“设计注册控制器创建方法” 。**

痛苦来了。
从这里“[在不同的控制器中设计表单](https://stackoverflow.com/questions/4081744/devise-form-within-a-different-controller)”和[这里](http://pupeno.com/2010/08/29/show-a-devise-log-in-form-in-another-page/)，我知道我必须定义那些新的助手，以使设计工作：

```
module ContentHelper
  def resource_name
    :user
  end

  def resource
    @resource ||= User.new
  end

  def devise_mapping
    @devise_mapping ||= Devise.mappings[:user]
  end
end 
```

我要覆盖的创建方法是这样的：

```
def create
build_resource

if resource.save
  if resource.active_for_authentication?
    set_flash_message :notice, :signed_up if is_navigational_format?
    sign_in(resource_name, resource)
    respond_with resource, :location => after_sign_up_path_for(resource)
  else
    set_flash_message :notice, :"signed_up_but_#{resource.inactive_message}" if is_navigational_format?
    expire_session_data_after_sign_in!
    respond_with resource, :location => after_inactive_sign_up_path_for(resource)
  end
else
  clean_up_passwords resource
  respond_with resource
end 
```

结尾

我无法弄清楚如何在不影响守望者功能的情况下使其工作。（构建资源）。有什么建议吗？我找不到任何**不使用 STI**的解决方案！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-13T16:03:49.507

您可以在设计的所有视图中定义变量，例如

```
@type = :society 
```

和

```
def resource_name
    @type
end 
```

然后你可以使用原来的控制器和视图，只需将它添加到 AplicationHelper

PD：对于 User.new，您可以在 eval 条件中使用字符串，例如

```
@res = "Society" 
```

然后

```
@resource ||= eval(@res).new 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T13:05:38.417

听起来您将有一个复杂的模型设置，这可能会困扰您。如果您需要两个不同的“用户”模型，也许您仍然可以拥有一个用户模型，然后还拥有每个“has_one :user”的 Society 和 Collaborator 模型。这样在注册时您就可以创建用户记录，以及 Society 或 Collaborator 方法（无论选择哪个）。这样设计（以及您的所有身份验证）只是链接到用户模型并且它保持简单。

一般来说，如果你发现自己在与粮食作斗争，那么重新评估你正在做的事情是个好主意。除非您正在做一些开创性的事情，否则事情很可能不会那么困难。

# c# - 无法将类型“bool”隐式转换为“System.Windows.Forms.RightToLeft”

> ID：10161507
> 
> 赞同：0
> 
> 时间：2012-04-15T11:13:06.127
> 
> 标签：c#, .net, winforms, right-to-left

我有这个错误。我知道铸造转换和其他转换，但我怎样才能转换为`System.Windows.Forms.RightToLeft`？

**代码：**

```
this.RightToLeft = false; // Here is the problem
this.Text = "Do you speak english ?"; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-15T11:16:02.683

我怀疑你想要*这个*：

```
this.RightToLeftLayout = false; 
```

或这个：

```
this.RightToLeft = RightToLeft.No; 
```

该[`Form.RightToLeftLayout`](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.righttoleftlayout.aspx)属性*属于*type `bool`，但[`Control.RightToLeft`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.righttoleft.aspx)属于类型[`RightToLeft`](http://msdn.microsoft.com/en-us/library/system.windows.forms.righttoleft.aspx)（枚举）。仅根据您的问题很难判断您想要哪个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T11:15:53.197

您不想在此处强制转换，因为该[`Control.RightToLeft`属性](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.righttoleft.aspx)不**接受**type 的值`bool`。相反，它是一个枚举；具体来说，同名的枚举类型，[`RightToLeft`](http://msdn.microsoft.com/en-us/library/system.windows.forms.righttoleft.aspx).

您需要使用其中一个*值*。任何一个：

*   `RightToLeft.No`（默认）
*   `RightToLeft.Inherit`
*   `RightToLeft.Yes`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T11:16:10.667

正如您提到的，类型`this.RightToLeft`是 of ，它具有成员和（和，它使用父表单的值）。您可以使用此逻辑进行分配：`System.Windows.Forms.RightToLeft``Yes``No``Inherit`

```
this.RightToLeft = System.Windows.Forms.RightToLeft.No; 
```

您可以使用正确的`import`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-15T11:16:17.463

您必须使用[RightToLeft](http://msdn.microsoft.com/it-it/library/system.windows.forms.righttoleft.aspx)枚举，例如

```
RightToLeft.No 
```

# haskell - Haskell 条件错误

> ID：10161509
> 
> 赞同：2
> 
> 时间：2012-04-15T11:13:24.593
> 
> 标签：haskell, conditional-statements

我对 Haskell 代码有疑问，我有以下问题：

```
takeMeHere cs m =
    |(find (==E) cs == Nothing && (checkNextStep pozxCrt+1 pozyCrt m) == True) = (Just E,[(pozxCrt+1,pozyCrt)] ++ m)
    |(find (==S) cs == Nothing && (checkNextStep pozxCrt pozyCrt-1 m) == True) = (Just S,[(pozxCrt,pozyCrt-1)] ++ m)
    |(find (==W) cs == Nothing && (checkNextStep pozxCrt-1 pozyCrt m) == True) = (Just W,[(pozxCrt-1,pozyCrt)] ++ m)
    |(find (==N) cs == Nothing && (checkNextStep pozxCrt pozyCrt+1 m) == True) = (Just N,[(pozxCrt,pozyCrt+1)] ++ m)
    |otherwise = (Nothing,m)
where
    pozxCrt=fst(head m)
    pozyCrt=snd(head m)

checkNextStep x y m = if(find (== (x,y)) m == Nothing) then True
   else False 
```

我得到一个`parse error on input "|"`. 如果我用 if then else if then 之类的东西编写代码......它可以工作。但我想使用 | 以获得更紧凑的编码。这里似乎有什么问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-15T11:34:18.713

要修复解析错误，请从第一行删除 =。= 符号放在警卫之后。

Next, you should indent "where"

```
takeMeHere cs m
    |(find (==E) cs == Nothing && (checkNextStep pozxCrt+1 pozyCrt m) == True) = (Just E,[(pozxCrt+1,pozyCrt)] ++ m)
    |(find (==S) cs == Nothing && (checkNextStep pozxCrt pozyCrt-1 m) == True) = (Just S,[(pozxCrt,pozyCrt-1)] ++ m)
    |(find (==W) cs == Nothing && (checkNextStep pozxCrt-1 pozyCrt m) == True) = (Just W,[(pozxCrt-1,pozyCrt)] ++ m)
    |(find (==N) cs == Nothing && (checkNextStep pozxCrt pozyCrt+1 m) == True) = (Just N,[(pozxCrt,pozyCrt+1)] ++ m)
    |otherwise = (Nothing,m)
  where
    pozxCrt=fst(head m)
    pozyCrt=snd(head m) 
```

This will at least parse, yet it won't compile. The `(checkNextStep pozxCrt pozyCrt+1 m)` should be `(checkNextStep pozxCrt (pozyCrt+1) m)`.

Let me add that you can fix a lot of verbose code:

*   `find (==E) cs == Nothing` can be changed to `E `notElem` x`
*   You do not need to compare with True: change `x == True` to `x`
*   `if x then True else False` can be changed to `x`
*   `[x]++y` can be changed to `x:y`
*   You can use pattern matching like this: `(pozxCrt, pozyCrt) = head m` or `(pozxCrt, pozyCrt):_ = m`

The result is:

```
takeMeHere cs m                                                                 
    | E `notElem` cs && checkNextStep (pozxCrt+1) pozyCrt m = (Just E,(pozxCrt+1,pozyCrt):m)
    | S `notElem` cs && checkNextStep pozxCrt (pozyCrt-1) m = (Just S,(pozxCrt,pozyCrt-1):m)
    | W `notElem` cs && checkNextStep (pozxCrt-1) pozyCrt m = (Just W,(pozxCrt-1,pozyCrt):m)
    | N `notElem` cs && checkNextStep pozxCrt (pozyCrt+1) m = (Just N,(pozxCrt,pozyCrt+1):m)
    | otherwise = (Nothing,m)                                                   
  where                                                                         
    (pozxCrt, pozyCrt) = head m                                                 

checkNextStep x y m = (x,y) `notElem` m 
```

You have a lot of repetition in the guards. A lot of repetition is a sign to create new functions.

```
move E (x, y) = (x+1, y) 
move S (x, y) = (x, y-1)
move N (x, y) = (x, y+1)
move W (x, y) = (x-1, y)

takeMeHere cs m
    | canGo E = go E
    | canGo S = go S
    | canGo W = go W
    | canGo N = go N
    | otherwise = (Nothing,m)
  where
    pos = head m
    canGo dir = dir `notElem` cs && checkNextStep (move dir pos) m
    go dir = (Just dir, move dir pos:m)

checkNextStep (x, y) m = (x,y) `notElem` m 
```

Next step: use `find canGo [E,S,W,N]` to get rid of the guards:

```
 takeMeHere cs m =                                                               
    case find canGo [E,S,W,N] of                                                
      Just dir -> (Just dir, move dir pos:m)                                    
      Nothing -> (Nothing, m) 
    where ... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-15T11:23:38.303

我可以在您的代码中看到至少三个错误。

*   `=`必须删除第一行的。语法要求`=`每个`|`. 基本上，错误是说您`|`在 an 之后第一个管道符号是意外的，`=`因为后者在该位置使用时没有防护。
*   当您将数学表达式作为函数的输入时，您应该在数学表达式周围加上括号，因为像这样的中缀运算符`+`在函数应用方面具有较低的优先级。`checkNextStep pozxCrt+1 pozyCrt m`被评估为`(checkNextStep pozxCrt) + (1 pozyCrt m)`（这显然是一个错误），而不是`checkNextStep (pozxCrt+1) pozyCrt m`.
*   `where`应该相对于第一行缩进。

除非您省略的代码中有其他错误，否则它应该可以工作：

```
takeMeHere cs m    -- no more "=" here
    |(find (==E) cs == Nothing && (checkNextStep (pozxCrt+1) pozyCrt m) == True) = (Just E,[(pozxCrt+1,pozyCrt)] ++ m)
    |(find (==S) cs == Nothing && (checkNextStep pozxCrt (pozyCrt-1) m) == True) = (Just S,[(pozxCrt,pozyCrt-1)] ++ m)
    |(find (==W) cs == Nothing && (checkNextStep (pozxCrt-1) pozyCrt m) == True) = (Just W,[(pozxCrt-1,pozyCrt)] ++ m)
    |(find (==N) cs == Nothing && (checkNextStep pozxCrt (pozyCrt+1) m) == True) = (Just N,[(pozxCrt,pozyCrt+1)] ++ m)
    |otherwise = (Nothing,m)
  where -- indentation
    pozxCrt=fst(head m)
    pozyCrt=snd(head m) 
```

顺便说一句，您的代码非常多余，您应该对所有这些比较做一些事情`True`（请参阅@dbaupp 对您的问题的评论）。我建议你多学习一点 Haskell 的运算符优先级和语法，这将有助于你使你的代码更易于阅读:)

# javascript - 使用 Rangy 的 iOS 样式格式化标注

> ID：10161512
> 
> 赞同：2
> 
> 时间：2012-04-15T11:13:51.870
> 
> 标签：javascript, dom, positioning, rangy, callout

我正在查看 Rangy ( [http://code.google.com/p/rangy/](http://code.google.com/p/rangy/) )，它似乎有一堆 DOM 实用程序，但没有示例我无法理解它们。所以我带着我的想法转向 SO，希望你们能告诉我如何做到这一点：

![在此处输入图像描述](../Images/d6b3f478812b783b839ab641eab15a1e.png)

我需要对 Rangy 做的是用它来查找选择的位置和尺寸。我想获取选择的框架或矩形，无论是相对于文档还是父元素。然后我可以相应地定位我的标注。

![在此处输入图像描述](../Images/377e1d04369e57975241b8d728dd1bdb.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T23:34:19.737

我编写了一个未发布的早期 Rangy 模块，用于获取选择或范围的像素坐标。不幸的是，在所有浏览器和所有情况下都很难让它正常工作，这让我无法完成它，我基本上已经放弃了它。但是，如果您添加更多关于您正在尝试做的事情的详细信息，我可能会提出一些建议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T05:38:41.913

我相信 Rangy 附带的演示已经说明了你想要什么。特别是[http://rangy.googlecode.com/svn/trunk/demos/position.html](http://rangy.googlecode.com/svn/trunk/demos/position.html)里面的`showSelectionPosition`函数

考虑到选择可能分布在多个元素中这一事实，最好使用其中任何一个的坐标`startSelEl`或`endSelEl`将标注锚定到选择的开头或结尾。

# jquery - 固定侧边栏内部包装 div

> ID：10161514
> 
> 赞同：3
> 
> 时间：2012-04-15T11:13:55.330
> 
> 标签：jquery, css, scroll, sidebar, css-position

嗨，我一直在尝试在包装 div 内制作一个固定的侧边栏，但没有运气。该页面是[http://www.rayshaft.com/sample.html](http://www.rayshaft.com/sample.html)，当我向下滚动其他新闻部分时，我需要侧边栏保持固定。节结构是这样的：

```
<section class="secondary">
 <section id="sidebar">
 ...
 </section>
 <section id="othernews">
 ...
 </section> 
```

我在“辅助”部分尝试了绝对定位，已修复，它实际上相对于浏览器窗口修复了侧边栏，我尝试了这个查询，这似乎正是我需要的：http: [//jsfiddle.net/bryanjamesross/VtPcm/](http://jsfiddle.net/bryanjamesross/VtPcm/)但我无法使其与我的页面一起使用。知道我在做什么错吗？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T11:32:52.527

# javascript - 单击以 ajax 生成的“a”元素

> ID：10161516
> 
> 赞同：0
> 
> 时间：2012-04-15T11:14:30.040
> 
> 标签：javascript, ajax, google-chrome, click

无法`click()`在生成的 ajax`a`元素上执行。但我可以选择。

```
function cansel(){
    var cansel_button = document.getElementById('cansel_button');
    console.log(cansel_button);
    console.log('post');
    cansel_button.click();
} 
```

我得到了这个日志：

```
<a id=​"cansel_button" style=​"text-decoration:​none;​" class="" onclick="">​…​&lt;/a>​
post
extensions/event.js:185Error in event handler for 'undefined': TypeError: Object  has no method 'click'
    at cansel (unknown source)
    at unknown source
    at [object Object].dispatch (extensions/event.js:183:28)
    at Object.<anonymous> (extensions/miscellaneous_bindings.js:177:22) 
```

是的，这是来自 chrome 扩展的注入脚本。

UPD：注入的页面有类似触发器`$('#element').live('click', function(){ })`，我需要在没有任何黑客攻击的情况下执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T11:50:42.367

[document.getElementById](https://developer.mozilla.org/en/DOM/document.getElementById)方法返回[DOM Element](https://developer.mozilla.org/en/DOM/element)，它没有`"click"`您尝试调用的方法。如果你想调用`click`处理程序，那么你需要使用这个：

```
 cansel_button.onclick(); 
```

而不是`cansel_button.click();`.

# php - 使用 Ajax 或 Socket 的推拉技术

> ID：10161519
> 
> 赞同：4
> 
> 时间：2012-04-15T11:14:52.703
> 
> 标签：php, jquery, ajax

我有一个网站需要像 Facebook 一样实时向在线客户发送通知，经过更多的谷歌搜索，我发现了很多关于推送和拉取技术的文档。我从这个文档中找到了使用 Ajax 或 Sockets 实现它们的方法。我需要知道在我的情况下最好使用什么，以及它是如何使用 javascript 或 jquery 和 php 编码的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T12:18:24.383

如果您可以确保每个登录用户只打开一个浏览器，那么您可以轻松应用这种长轮询技术。

Ajax 调用策略：

1.  不要每 2 秒发出一次请求。
2.  但是，只有在从上一个请求获得响应后 2 秒才等待并发出请求。
3.  如果请求在 12 秒内未响应，则不要等待发送新请求。这是连接丢失的情况。

服务器响应策略：

1.  如果立即有更新响应。检查是否有更新依赖会话；（如果您可以从客户端发送一些提示，例如收到的最新消息，那就更好了；第二个更新检查机制将消除上面提到的单个浏览器打开的限制）

2.  否则 sleep() 1 秒；（不要使用无限循环而是使用sleep）然后检查是否有更新；如果有更新响应；如果没有再次睡眠 1 秒；重复此操作，直到总共 10 秒过去，然后在没有更新的情况下回复

如果应用此策略（通常称为长轮询），您会发现在重负载情况下处理器使用率从 95% 降低到 4%。

希望这能解释。祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T11:20:32.887

在不详细了解您的情况的情况下，我不能说您的最佳用途是什么。

在大多数情况下，让客户端每隔一两秒检查一次服务器，询问是否发生了新情况就足够了。大多数时候我更喜欢这个而不是套接字，因为它可以在每个 Web 服务器上运行而无需任何配置更改，并且可以在任何支持 AJAX 的浏览器中运行，甚至是旧的浏览器。

如果您的客户端很少（因为每个客户端都需要在服务器上打开一个套接字）并且您想要实时，您可以使用 websockets。有几种 PHP 实现，例如这个：[http ://code.google.com/p/phpwebsocket/](http://code.google.com/p/phpwebsocket/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T11:18:43.653

只需使用 jQuery 应用长轮询技术。

套接字尚不支持所有地方，您还需要在服务器上打开一个侦听套接字才能使其工作。

# playframework - ElementCollection 与 PlayFrameWork 一起使用

> ID：10161522
> 
> 赞同：2
> 
> 时间：2012-04-15T11:15:14.123
> 
> 标签：playframework, yaml

我有一些相关的课程。其中一个是有另一个类的对象集。像这样，

```
 @Entity
 public class Serving extends Model{

@Required
public Item item;
@Required
public Float amount;
@Required
public Date time;

public Serving(Item item, Float amount) {
    super();
    this.item = item;
    this.amount = amount;
    this.time = new Date();
}
}

 @Entity
 public class Receipt extends Model{

@Required
@ElementCollection
@NotNull
public Set<Serving> servings;
@Required
DiningTable dtable;

public Receipt(Set<Serving> servings, DiningTable dtable) {
    super();
    this.servings = servings;
    this.dtable = dtable;
}

//order'ın totalın hesaplamak lazım.

 } 
```

我也有一些 yaml 数据来初始化它。

> Serving(ser1): item : it1 amount : 1 time : 2012-04-05 12:10
> 
> Serving(ser2): item : it2 数量 : 0.5 时间 : 2012-04-05 12:11
> 
> Serving(ser3): item : it3 amount : 2 time : 2012-04-04 13:10
> 
> Serving(ser4): item : it4 amount : 1 time : 2012-04-04 13:10
> 
> Serving(ser5): item : it5 数量 : 0.5 时间 : 2012-04-04 14:00
> 
> Serving(ser6): item : it6 amount : 1 time : 2012-04-04 14:10
> 
> Serving(ser7): item : it7 amount : 1 time : 2012-04-03 16:00
> 
> Serving(ser8): item : it8 数量 : 2 time : 2012-04-03 16:01
> 
> Serving(ser9): item : it9 数量 : 1 time : 2012-04-03 16:30
> 
> Serving(ser10): item : it2 amount : 1 time : 2012-04-02 17:00
> 
> 收据（rec1）：dtable：tab1 份量：
> - ser1 - ser2 - ser3
> 
> 收据 (rec2): dtable : tab2 份量 : - ser4 - ser5
> 
> 收据（rec3）：dtable：tab3 份量：- ser6
> 
> 收据 (rec4): dtable : tab4 份量 : - ser7 - ser8
> 
> 收据 (5): dtable : tab4 份量 : - ser9 - ser10

当我尝试初始化此数据时，它会出现此错误，

> 14:13:01,200 WARN ~ SQL 错误：1364，SQLState：HY000 14:13:01,200 错误 ~ 字段 'servings_time' 没有默认值 14:13:01,200 错误 ~ 无法将数据库状态与会话 org.hibernate 同步.exception.GenericJDBCException：无法执行 JDBC 批量更新

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T13:13:59.977

你应该注释你的时间：

```
 @Temporal(TemporalType.TIME)
    public Date date;

or

    @Temporal(TemporalType.DATETIME)
    public Date date; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:11:49.470

在服务类构造函数中，必须获取日期作为参数。

```
public Serving(Item item, Float amount, Date date) {
super();
this.item = item;
this.amount = amount;
this.time = date;
} 
```

所以我也必须添加这个构造函数......

# google-app-engine - 无法访问数据的 AppEngine 部署角色

> ID：10161525
> 
> 赞同：0
> 
> 时间：2012-04-15T11:15:45.053
> 
> 标签：google-app-engine

Google appengine 中是否有一个角色，它只有权部署应用程序但无权访问数据。据我了解，查看者、开发者和所有者的所有角色都可以访问数据。

用例是，出于安全考虑，许多用户不想共享他们的数据，但开发人员希望提供更新的部署。

有没有办法解决这个问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T11:23:31.613

我不认为它可以通过 GAE 管理员角色来完成。最低权限角色：查看者有权查看数据（但无权修改）。另外不要忘记，如果您有权上传代码，您可以上传代码，让您可以访问数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T07:37:06.490

不，没有这样的角色。如果您想这样做，您需要将代码提供给您的用户以自行部署。

请注意，即使这样也不能解决您描述的问题，因为开发人员可以在后门中进行简单的编码，让他们检查用户的数据。最终，除非您准备好提供源代码，否则无法解决这个问题：您的用户必须信任您才能使用您的应用程序。

# php - 循环结果执行两次

> ID：10161534
> 
> 赞同：0
> 
> 时间：2012-04-15T11:16:17.543
> 
> 标签：php, mysql

我用 PHP 创建了一个简单的站点，用户可以在其中提交博客，而其他用户（已登录）可以对其发表评论。我在每个博客下方创建了一个名为“评论”的链接，单击该链接将显示/隐藏与特定博客相关的所有评论（如果用户登录，它将显示一个表单字段，他们可以在其中提交新评论） . 所以基本上每个博客都会有多个评论。我为此做了两个不同的代码，但它们都有相同的问题，即每个评论出现两次（其他一切正常）。谁能指出为什么？

```
mysql_select_db ("ooze"); 
$result = mysql_query ("select * from blog") or die(mysql_error()); 
$i = 1;   
 while($row = mysql_fetch_array($result)) 
 { 
  echo "<h1>$row[title]</h1>"; 
  echo "<p class ='second'>$row[blog_content]</p> ";  
  echo "<p class='meta'>Posted by .... &nbsp;&bull;&nbsp; $row[date] &nbsp;&bull;&nbsp; <a href='#' onclick=\"toggle_visibility('something$i'); return false\">Comments</a><div id='something$i' style='display: none;'>";     
  $i++; 
  $a = $row["ID"];
  $result2 = mysql_query ("select * from blog, blogcomment where $a=blogID") or die(mysql_error()); 
    while($sub = mysql_fetch_array($result2)) 
    { 
     echo "<p class='third' >$sub[commentdate] &nbsp;&bull;&nbsp; $sub[username]</p><p>said:</p> <p>$sub[comment]</p>"; 
     } 
 if ( isset ($_SESSION["gatekeeper"])) 
 { 
    echo '<form method="post" name="result_'.$row["ID"].'" action="postcomment.php"><input name="ID" type = "hidden" value = "'.$row["ID"].'" /><input name="comment" id="comment" type="text" style="margin-left:20px;"/><input type="submit" value="Add comment" /></form>'; 
 }  
 else 
 {  
    echo '<p class="third"><a href="register.html">Signup </a>to post a comment</p>'; 
 } 
echo "</div>"; 
}
mysql_close($conn); 
```

//第二个版本的内循环：//

```
if ( isset ($_SESSION["gatekeeper"])) 
{
  while($sub = mysql_fetch_array($result2)) 
  { 
    echo "<p class='third' >$sub[commentdate] &nbsp;&bull;&nbsp; $sub[username] said:</p> <p>$sub[comment]</p>"; 
   }
echo '<form method="post" name="result_'.$row["ID"].'" action="postcomment.php"><input name="ID" type = "hidden" value = "'.$row["ID"].'" /><input name="comment" id="comment" type="text" style="margin-left:20px;"/><input type="submit" value="Add comment" /></form>'; 
}  
else 
{
  while($sub = mysql_fetch_array($result2)) 
  { 
    echo "<p class='third' >$sub[commentdate] &nbsp;&bull;&nbsp; $sub[username] said:</p> <p>$sub[comment]</p>"; 
  }
echo '<p class="third"><a href="register.html">Signup </a>to post a comment</p>'; 
 } 
echo "</div>"; 
} 
mysql_close($conn); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T11:25:27.713

您的问题在于第一个示例中的此查询。

```
$result2 = mysql_query ("select * from blog, blogcomment where $a=blogID") 
```

您已经查询了 blog 表，因此无需再次查询。只需将其更改为

```
$result2 = mysql_query ("select * from blogcomment where $a=blogID") 
```

应该解决问题。

但是，您需要考虑很多事情。

*   你为什么要重新发明轮子？那里有很多不错的博客应用程序。你最好使用其中之一。
*   不建议再使用 mysql_ 系列函数。走开学习 mysqli_ 或更好的[PDO](http://uk.php.net/pdo)。
*   您应该了解[关注点分离](http://en.wikipedia.org/wiki/Separation_of_concerns)。至少您应该确保您的数据访问/业务逻辑与您的显示逻辑是分开的。[MVC](http://en.wikipedia.org/wiki/Model-view-controller)在 PHP 中很常见。
*   您还应该了解 JOIN。即使在这个简单的内联脚本中，您在循环中也有一个效率不高的查询。您可以将查询合并为一个（就像您尝试使用内部查询一样）。不同之处在于一个查询应该在您的主循环之外。

# architecture - 编译器与解释器

> ID：10161536
> 
> 赞同：3
> 
> 时间：2012-04-15T11:16:37.937
> 
> 标签：architecture, compiler-construction, operating-system, interpreter

所以，让我看看我是否明白这一点。

1.  当我们说编译器和解释器之间的区别时，解释器**将高级指令翻译成中间形式**，然后执行。[我认为编译器也将高级指令转换为中间形式，但此时它生成目标代码而不是执行它，对吗？]

2.  解释器一次读取一条指令或一行的源代码，**将这一行转换为机器代码并执行它。** [解释器本身不会将代码转换为机器代码，它使用自己的预编译函数来评估指令（在解析之后）。例如，高级语言中的 Add 表达式将使用先前编译的解释器 add 函数进行评估，对吗？]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T11:20:15.097

关键区别在于：解释器在运行源代码时对其进行处理。它不会将源代码转换为机器代码，它只是使用自己的代码来完成源代码的指示。编译器将源代码转换为可以直接运行的机器代码。

并非所有编译器都与执行过程分开。例如，大多数 Java 运行时都包含一个“JIT 编译器”，它根据需要在 Java 代码运行时对其进行编译。

你可以有一些介于两者之间的东西。本质上，可以首先使用类似于编译的过程将源代码转换为更小且更易于解释的东西。然后可以解释这个编译的输出。（例如，第一遍可以转换，比如 'if' 到 53，'else' 到 54，'for' 到 55，等等 - 这将使解释器不必处理代码中的可变长度字符串实际上并不处理字符串。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T11:22:52.270

我同意第一个，尽管解释器一次只处理一行并不一定是真的（它可以根据对整个代码的了解进行优化）。

我认为第二个有点偏离：编译器确实创建了“机器代码”（对于 JVM，它可能是字节码）。解释器根据输入执行自己程序的一部分（到目前为止与编译器相同），这些执行的部分正在执行输入中描述的计算（而不是执行计算以计算所需的机器代码）。

可能会模糊两者之间的界限，因为编译器可以生成将在执行时解释的代码（根据编译时不可用的因素提供运行时优化）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T11:23:16.680

你是对的（1）。

广告（2），解释器不需要一次读取一条指令的源代码，因为在解释包含循环的代码时这太昂贵了。更有可能的是，它读取整个表达式、语句、函数甚至源文件，将它们转换为中间格式并对其进行评估。

请注意，编译器和解释器都不需要在任何时候生成机器代码；许多编程语言，包括 Java、Python，以及像 Prolog 这样的旧语言，通常都被编译为虚拟机字节码。在 Python 和 Prolog 中，“解释器”通常是字节码编译器/字节码解释器的组合。

[*我所知道的关于编译和解释的最好的介绍是SICP*](http://mitpress.mit.edu/sicp/full-text/book/book.html)的第 4 章和第 5 章，它们从讨论一个非常简单的解释器开始，然后迭代地改进它，直到它成为一个成熟的编译器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-04T13:08:50.647

# **什么是翻译？**

> **S -> T 翻译器**接受以源语言 S 表达的代码，并将其翻译成以另一种（目标）语言 T 表达的等效代码。

**翻译示例：**

*   编译器 - 将高级代码转换为低级代码，即*Java -> JVM*
*   汇编程序 - 将汇编语言代码翻译成机器代码，即*x86as -> x86*
*   高级翻译器 - 将代码从一种 PL 翻译成另一种，即*Java -> C*
*   反编译器 - 将低级代码翻译成高级代码，即*JVM -> Java*

# **什么是口译员？**

> **S 解释器**接受用语言 S 表达的代码，并立即执行该代码。它通过一次获取、分析和执行一条指令来工作。

当用户以交互方式输入指令（想想 Python）并希望在输入下一条指令之前获得输出时非常棒。当程序只执行一次或需要可移植时也很有用。

*   解释程序比执行本机机器代码慢得多
    *   解释高级语言要慢约 100 倍
    *   解释中级（例如 JVM 代码）语言的速度要慢约 10 倍
*   如果一个指令被重复调用，就会被重复分析——很费时间！
*   无需编译代码

# **差异**

**行为**

*   编译器将源代码翻译成机器代码，但不执行源代码或目标代码。
*   解释器一次执行一条指令源代码，但不翻译源代码。

**表现**

*   编译器需要很长时间才能将源程序翻译成本地机器码，但后续执行速度很快
*   解释器立即开始执行源程序，但执行速度很慢

**解释性编译器**

解释性编译器是编译器和解释器之间的一个很好的折衷。它将源程序翻译成虚拟机代码，然后进行解释。

解释性编译器将快速翻译与适度快速执行相结合，前提是：

*   VM 代码低于源语言，但高于本机机器代码
*   VM 指令具有简单的格式（可以由解释器快速分析）

*示例：JDK 为 Java 提供了一个解释性编译器*

* * *

> **[来源](https://stackoverflow.com/a/23456402/3300831)**

# playframework - 重定向后保存的数据未准备好 - PlayFramework 1.2.4

> ID：10161537
> 
> 赞同：0
> 
> 时间：2012-04-15T11:16:43.073
> 
> 标签：playframework

使用 Play Framework 1.2.4，如果我将一些数据发布到一个动作，然后重定向到另一个动作，例如：

```
public static void post(Entity entity)
{
    entity.save();
    index();
} 
```

我刚刚保存的数据（entity.save()）此时还没有准备好。因此，如果 index() 应该列出所有实体，包括我刚刚创建的实体，它不会。我必须重新加载页面才能在列表中看到该实体。

有人经历过吗？有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T11:46:04.150

这不应该是这样。当您调用 时`index()`，Play 执行浏览器重定向，因此服务器已完全完成请求，并发出一个全新的请求来执行索引操作。

我认为您的错误一定出在其他地方，因为您所描述的在 Play 应用程序中是非常常见的做法，而且我以前从未见过您所描述的行为。

# php - 使用我的 Facebook 网站应用程序的人如何发布到他们的页面时间线

> ID：10161541
> 
> 赞同：0
> 
> 时间：2012-04-15T11:17:04.897
> 
> 标签：php, facebook, facebook-graph-api

我有一个网站，企业通过 PHP 后端系统创建内容。每次他们创建新内容时，我都希望将其发布到他们的 Facebook 页面时间线（而不是用户时间线）。

我已经创建了身份验证代码：

```
<div id="fb-root"></div>
<script>
    window.fbAsyncInit = function() {
        FB.init({
            appId      : 'XXXXXXXXXX',
            status     : true, 
            cookie     : true,
            xfbml      : true,
            oauth      : true,
        });
    };
    (function(d){
        var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
        js = d.createElement('script'); js.id = id; js.async = true;
        js.src = "//connect.facebook.net/en_US/all.js";
        d.getElementsByTagName('head')[0].appendChild(js);
    }(document));
</script>
<div class="fb-login-button" scope="manage_pages">
    Login with Facebook
</div> 
```

以 manage_pages 作为范围。我需要知道他们如何选择他们希望帖子转到哪个页面（如果他们有超过 1 页），以及如何在提交内容时自动发布到该页面墙（通过 PHP 表单完成）。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T11:32:27.543

他们给了你**manage_pages**权限吗？惊人的。这是您需要做的：

1.  一旦他们登录，您就可以掌握用户 access_token。
2.  使用该令牌，您将能够获取该用户的 Graph API，并获取帐户连接。参考 ->[用户 API](http://developers.facebook.com/docs/reference/api/user/)（查找“连接”）
3.  **该 API 调用将为您提供一个包含帐户名称、access_token、类别、id**的对象数组
***   您可以知道从给定的字段中选择哪个页面。所以，做出你的选择；）*   使用您选择的访问令牌发布到页面。参考 ->[页面 API（提要）](https://developers.facebook.com/docs/reference/api/page/#feed)**

 **对于另一个问题“*如何在提交内容时自动发布到该页面墙（通过 PHP 表单完成）。* ”我会做一些 JavaScript 逻辑，一旦提交表单就会触发并使用任何方法调用 Facebook API您要发布的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T11:31:45.520

一旦用户授权您的应用程序，您应该能够访问他们的“帐户”连接。使用它，您应该能够检索他们的页面列表（然后您可以使用它来填充下拉列表）和正确页面的 access_token。您可以在这里找到更多信息 [https://developers.facebook.com/docs/reference/api/page/](https://developers.facebook.com/docs/reference/api/page/) 尤其是在这里 [https://developers.facebook.com/docs/reference/api/page/#feed](https://developers.facebook.com/docs/reference/api/page/#feed)

请注意，提要位也将您指向帖子的主要文章，但请记住您需要使用正确的 access_token 和上面的 page_id

谢谢**

# visual-studio-2010 - 在 Mac Host 和 Vm Fusion Visual Studio 之间共享代码库

> ID：10161544
> 
> 赞同：4
> 
> 时间：2012-04-15T11:17:14.473
> 
> 标签：visual-studio-2010, macos, virtual-machine, code-sharing

我在 mac 上与我所有的 git 存储库保持一个共享文件夹。我还使用 Windows 7 虚拟机 (Vmware Fusion) 访问它来执行 Visual Studio Mvc 项目。

与直接在 Windows VM 内复制存储库文件夹相比，编译和调试要慢得多，IIS 存在限制，并且 VM 大小增长了很多。

有没有更好的方法来加快这个过程？

# php - 我可以使用 jquery ajax 从 php 类调用函数吗？

> ID：10161545
> 
> 赞同：-4
> 
> 时间：2012-04-15T11:17:17.197
> 
> 标签：php, jquery, login

我从 php 中的面向对象编程开始。

我想做记录 - 使用 ajax 和 jquery。

**编辑：**我可以从文件 jquery.php 调用函数 ajax - 使用 jquery AJAX 吗？

```
//FILE jquery.php

class jquery {

    public function ajax() {

    echo "result";      

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T11:39:23.303

如果您进行类似于此的 ajax 调用：

`http://example.com/ajax.php?firstParam=1`

在您的`ajax.php`文件中，您可以执行以下操作：

```
switch($_GET['firstParam']){
 case "1":
  callYourFunction();
 break;
 case "2":
  someOtherFunction();
 break;
} 
```

这是一个**非常**精简的例子......在现实世界的情况下，您必须考虑安全性并清理您从服务器外部（即来自用户）获得的任何信息。

我给出的名称只是占位符 - 您可以将函数/变量名称更改为您觉得舒服的任何名称。

我希望这能对你的难题有所启发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T11:41:07.537

不确定您是否完全理解 AJAX 是什么，但它是 Asynchronous JavaScript 和 XML 的首字母缩写。使用 Ajax，Web 应用程序可以异步（在后台）向服务器发送数据和从服务器检索数据，而不会干扰现有页面的显示和行为。而已。

我相信这就是您正在寻找的（尽管它不是 OOP，但我没有编写整个 OOP 登录来尝试回答您的问题）

文件：`login.php`

```
<?php
  $db = new PDO("mysql:host=localhost;dbname=database", SQL_USER, SQL_PASS );

  $stmt = $db->prepare('SELECT user_id, user_activated FROM users WHERE ( username = AND user_password = ? LIMIT 1');
  $stmt->execute( array( $_POST['u'], $_POST['p'] ) );

  if( $stmt->rowCount() == 1 )
  {
     // Authentication session storage stuff here
     echo 'Logged in';
  }
  else
  {
     echo 'bad login';
  }
?> 
```

因此，您可以拥有一个 HTML 页面，其中包含以下内容：

```
<div id="results"></div>

<input type="text" id="txtUsername" /> <br />
<input type="password" id="txtPassword" /><br />
<button id="cmdLogin">Login</button>

<script>
  $(document).ready(function(){
     $("#cmdLogin").click(function(){
        $u = $("#txtUsername").val();
        $p = $("#txtPassword").val();

        $.ajax({
              type: "POST",
              url: "http://yoursite.com/login.php",
              data: "u="+u+"&p="+p
            }).done(function(results) { 
                  $("#results").html(results).hide().fadeIn();
            });
     });
  });
</script> 
```

另外，请记住此代码未经测试并将其编写为对此的回复，因此不要将其视为您想要的解决方案，而是帮助您实现您的目标的资源要求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-15T11:23:11.660

您不能直接调用类 - 但您可以获取执行结果。

这里有一个例子，你可以如何*几乎*直接地调用它——但**不要将它用于关键的登录代码。**

```
<?php
$ftcn = $_GET['getname'];
$bc = new ReallyBadCode();
$bc->$ftcn();

class ReallyBadCode{
    function test(){
    }

    function __call($name, $args){
       $this->$name($args);
    }

} 
```

# jquery - 如何将滑动网格内容添加到我的网站中？

> ID：10161549
> 
> 赞同：0
> 
> 时间：2012-04-15T11:17:42.330
> 
> 标签：jquery

我遇到了这个网站（[http://wearehunted.com/ipad/index.html](http://wearehunted.com/ipad/index.html)），它似乎使用一些 jquery 将其内容排列成横向和纵向的可变网格，并允许用户左右滑动浏览内容ipad 而不是滚动。是否有可用的插件可以执行此类操作？

# c - 最佳实践：在头文件中使用 stdint 类型

> ID：10161550
> 
> 赞同：1
> 
> 时间：2012-04-15T11:17:53.673
> 
> 标签：c, header, stdint

确保`stdint.h`包含使用该标头类型的标头的最佳方法是什么？

我可以看到的替代方案是：

*   包括`stdint.h`标题本身（危险，不是吗？）
*   如果在解析标头时未包含某些内容，则将其标记给编译器（例如`#ifndef _STDINT_H`附带`#error "stdint.h not included"`
*   教育其他开发人员始终包括`stdint.h`在我需要它的任何标题之前，无论是使用评论、对话、文档还是三者的混合（最后一个更可取）。

如果还有其他值得一提的替代方案，请随意这样做 - 我只是在猜测我应该在这里做什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-15T11:52:57.477

如果您`stdint.h`在标题中使用类型，则确实*应该*包含`stdint.h`在该标题中。

通常最好在头文件中包含最少数量的文件以减少编译时间。因此，只要有可能，您应该在标头中转发声明类型。由于 from 的类型`stdint.h`不能被前向声明（它们只是原始类型的 typedef），除了包含`stdint.h`在标头中之外没有其他选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T11:29:31.100

我的意见是，如果您使用包含防护，则可以在头文件中包含头文件。

就像是

```
# ifndef HEADER
     # define HEADER
     # include header.h
# endif 
```

# javascript - 在 AIR 中卸载声音，系统内存已满

> ID：10161552
> 
> 赞同：0
> 
> 时间：2012-04-15T11:18:14.823
> 
> 标签：javascript, audio, air

我正在构建一个 AIR 应用程序，它可以从用户计算机加载和播放 mp3，我几乎直接使用书中的代码来执行此操作：

```
function startTrack()
{
    if (isStarted == 0)
    {
        theSound = new air.Sound();
        urlReq  = new air.URLRequest(...dynamicaly generated extension);
        theSound.load(urlReq);
        soundHandle = theSound.play();
        isStarted = 1;
    }
    else
    {
        soundHandle.stop();
        soundHandle = null;
        theSound = null;
        urlReq = null;
        isStarted = 0;
        startTrack();
    }
} 
```

应用程序的页面上有一系列播放不同 mp3 的链接，当您单击一个链接时，它会将声音的路径传递到`urlReq`并播放它。当您单击第二个声音时，它会停止第一个播放并播放下一个。我认为会发生的是旧声音会被调用`theSound = null`等破坏，但它似乎只是停止声音播放新声音并保持旧声音加载，因此在启动并保留大量曲目后您最终会耗尽系统内存加载。

因此，如果有人知道如何卸载声音或如何从应用程序正在使用的系统内存中转储内容，将不胜感激。

谢谢大家

将要

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T14:52:38.760

在删除所有相关元素后调用 air.System.gc()。

# c++ - 旋转一个向量以达到与另一个向量的正交性

> ID：10161553
> 
> 赞同：4
> 
> 时间：2012-04-15T11:18:26.677
> 
> 标签：c++, geometry

我有 2 个向量`(V1{x1, y1, z1}, V2{x2, y2, z2})`，我想`V1`绕*X 轴*、*Y 轴*和*Z 轴*旋转以平行于`V2`。我想找到3个旋转角度。有什么通用公式可以用来找到它们吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T11:38:05.770

我会这样做：

```
 A = V1xV2; //Cross product, this gives the axis of rotation
    sin_angle =  length(A)/( |V1| |V2|); //sine of the angle between vectors

    angle = asin(sin_angle);
    A_n = normalize(A); 
```

现在你可以用角度和 A_n 构建一个四元数。

```
 q = (A_n.x i + A_n.y j + A_n.z k)*sin(angle/2) + cos(angle/2); 
```

并使用[这些](http://en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles#Conversion)公式来获得你的欧拉角。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T12:25:19.220

Do you really need the rotation angles, or is it a rotation matrix you're looking for. If the latter, you can do it the way it's done in OpenFOAM: [http://github.com/OpenFOAM/OpenFOAM-2.1.x/blob/master/src/OpenFOAM/primitives/transform/transform.H#L45](http://github.com/OpenFOAM/OpenFOAM-2.1.x/blob/master/src/OpenFOAM/primitives/transform/transform.H#L45)

Note that in OpenFOAM for `vector` the `&` operator denotes the inner product, the `^` operator the cross product and `*` is the outer product. The `sqr` function computes the element-wise squares, `magSqr` the square of the magnitude of a `vector` (i.e. `v&v`).

# ruby-on-rails - 如何在 Rails 3.2 中转换旧 Rails 的形式

> ID：10161554
> 
> 赞同：0
> 
> 时间：2012-04-15T11:18:30.200
> 
> 标签：ruby-on-rails, forms

我想实现这个简单的形式，但它是在旧的轨道上。有人可以帮我在 Rails 3.2 中转换它吗？

```
<%= start_form_tag ({:action => 'uploadfile'},:multipart => true) %>
<p><label for="upload_file">Select File</label> : 
<%= file_field 'upload', 'datafile' %></p>
<%= submit_tag "Upload" %>
<%= end_form_tag %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T12:16:56.083

```
<%= form_for(:upload, :url => { :action => "uploadfile" }, :multipart => true) do |form| %>
  <p><%= form.label :datafile, "Select File" %> :
  <%= form.file_field 'datafile' %></p>
  <%= form.submit "Upload" %>
<% end %> 
```

# java - 解析动态 json

> ID：10161559
> 
> 赞同：2
> 
> 时间：2012-04-15T11:20:01.563
> 
> 标签：java, json, jackson

我有 json，我正在尝试使用 Jackson 解析它。JSON 看起来像 -

```
coupons: {
  1: {
     title: "Mode von",
     description: "",
     type: "offer",
     code: "-",
     expiry: "0000-00-00",
     link: ""
  },    
  2: {
     title: "Prime 1",
     description: "",
     type: "offer",
     code: "-",
     expiry: "0000-00-00",
     link: "http://test.com/"
  }
} 
```

优惠券的数量在这里不是恒定的，并且会因响应而异。我的困境是创建可以容纳此类对象的相应 java 类。

我尝试使用 Map 作为 -

```
public class Coupons {
   Map<String, String>coupons = new HashMap<String, String>();
   public Map<String, String> getCoupons() {
      return coupons;
   }
} 
```

但 -

```
System.out.println(coupons.getCoupons().get("type"));
System.out.println(coupons.getCoupons().get("code")); 
```

总是让我为空。这个json的正确java类是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T11:39:04.293

您的第一级键是索引号 1、2、3 等，因此为了获取类型和代码，您必须指定键。

你可以这样做：

```
var coupons = coupons.getCoupons(); //<--breakpoint to see if this is really populated.
foreach( String key in coupons.Keys ){ //<- pseudo code, iterate over keys  
  var obj = coupons.get(key);
  var type = obj.get("type");
  etc..
} 
```

希望这可以帮助您继续前进

# java - 当其中一个日期在 Android 中为字符串格式时，如何比较日期？

> ID：10161562
> 
> 赞同：0
> 
> 时间：2012-04-15T11:20:10.757
> 
> 标签：java, android, date

我对 Android 非常陌生。我从以下格式的服务器获取字符串形式的日期

```
2012-08-17 00:00:00 
```

我想将此字符串与当前日期进行比较，以查找年、月和日形式的日期之间的差异。

我尝试在下面的代码中玩它

```
Date currentDate = new Date(System.currentTimeMillis());
Log.v("@@@@@@@@@","Current Date: " + currentDate);
Date passDate = new SimpleDateFormat().parse(passDateString);
Log.v("@@@@@@@@@","Pass Date: " + passDate);
dateDifference = passDate.compareTo(currentDate); 
```

但它返回以下异常

```
04-15 12:08:29.101: V/@@@@@@@@@(1161): Current Date: Sun Apr 15 12:08:29 GMT+01:00 2012
04-15 12:08:29.101: W/System.err(1161): java.text.ParseException: Unparseable date: 2012-08-17 00:00:00
04-15 12:08:29.111: W/System.err(1161):     at java.text.DateFormat.parse(DateFormat.java:645)
04-15 12:08:29.111: W/System.err(1161):     at org.apis.PassesListItemAdapter.getView(PassesListItemAdapter.java:77)
04-15 12:08:29.111: W/System.err(1161):     at android.widget.AbsListView.obtainView(AbsListView.java:1315)
04-15 12:08:29.111: W/System.err(1161):     at android.widget.ListView.makeAndAddView(ListView.java:1727)
04-15 12:08:29.111: W/System.err(1161):     at android.widget.ListView.fillDown(ListView.java:652)
04-15 12:08:29.111: W/System.err(1161):     at android.widget.ListView.fillFromTop(ListView.java:709)
04-15 12:08:29.111: W/System.err(1161):     at android.widget.ListView.layoutChildren(ListView.java:1580)
04-15 12:08:29.111: W/System.err(1161):     at android.widget.AbsListView.onLayout(AbsListView.java:1147)
04-15 12:08:29.111: W/System.err(1161):     at android.view.View.layout(View.java:7034)
04-15 12:08:29.111: W/System.err(1161):     at android.widget.RelativeLayout.onLayout(RelativeLayout.java:909)
04-15 12:08:29.111: W/System.err(1161):     at android.view.View.layout(View.java:7034)
04-15 12:08:29.111: W/System.err(1161):     at android.widget.FrameLayout.onLayout(FrameLayout.java:333)
04-15 12:08:29.111: W/System.err(1161):     at android.view.View.layout(View.java:7034)
04-15 12:08:29.111: W/System.err(1161):     at android.widget.FrameLayout.onLayout(FrameLayout.java:333)
04-15 12:08:29.111: W/System.err(1161):     at android.view.View.layout(View.java:7034)
04-15 12:08:29.111: W/System.err(1161):     at android.view.ViewRoot.performTraversals(ViewRoot.java:1049)
04-15 12:08:29.111: W/System.err(1161):     at android.view.ViewRoot.handleMessage(ViewRoot.java:1744)
04-15 12:08:29.111: W/System.err(1161):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-15 12:08:29.111: W/System.err(1161):     at android.os.Looper.loop(Looper.java:144)
04-15 12:08:29.111: W/System.err(1161):     at android.app.ActivityThread.main(ActivityThread.java:4937)
04-15 12:08:29.111: W/System.err(1161):     at java.lang.reflect.Method.invokeNative(Native Method)
04-15 12:08:29.111: W/System.err(1161):     at java.lang.reflect.Method.invoke(Method.java:521)
04-15 12:08:29.111: W/System.err(1161):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
04-15 12:08:29.111: W/System.err(1161):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
04-15 12:08:29.111: W/System.err(1161):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T11:26:32.080

添加要解析的日期格式：

```
 passDate = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").parse("2012-08-17 00:00:00"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T11:30:43.073

```
Date currentDate = new Date(System.currentTimeMillis());
Log.v("@@@@@@@@@","Current Date: " + currentDate);
SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss"); 
Date passDate = dateFormat.parse(passDateString);
Log.v("@@@@@@@@@","Pass Date: " + passDate);
dateDifference = passDate.compareTo(currentDate); 
```

使用此[链接](http://www.roseindia.net/java/beginners/DateDifferent.shtml)获取两个日期之间的差异，目前您只是在比较日期。

# mysql - 如何轻松安全地远程连接到 postgres 或 mysql？

> ID：10161566
> 
> 赞同：4
> 
> 时间：2012-04-15T11:20:50.237
> 
> 标签：mysql, security, postgresql, ssh, database-connection

我想知道在这些情况下如何连接到 postgresql：

*   允许您从任何位置访问它们（进行 IP 过滤）
*   安全连接（没有被捕获密码的风险）
*   易于设置，最好只配置服务器。

我知道推荐的方法是使用 SSH 端口转发，但这需要您在尝试连接到这些数据库之前启动端口转发。

无需在客户端上进行复杂设置即可获得足够好的安全性的最简单方法是什么？

有没有办法按需自动启用端口转发？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T14:54:02.457

对于 PostgreSQL，您首先要确保您使用的是启用 SSL 的构建。（我认为这是大多数安装程序的默认设置。）

然后，您需要通过设置`listen_addresses`（指定服务器将*侦听*的 IP 地址）允许服务器接受远程连接：[http ://www.postgresql.org/docs/9.1/interactive/runtime-config-connection.html](http://www.postgresql.org/docs/9.1/interactive/runtime-config-connection.html)

**pg_hba.conf**文件允许您指定哪些用户可以使用哪些身份验证方法从哪些 IP 地址连接到哪些数据库。有很多身份验证方法可供选择：[http ://www.postgresql.org/docs/9.1/interactive/client-authentication.html](http://www.postgresql.org/docs/9.1/interactive/client-authentication.html)

关于客户端需要做什么，细节将取决于您在哪个环境中使用的连接器；例如，如果可用，PostgreSQL JDBC 驱动程序默认使用 SSL 连接。要告诉 JDBC 驱动程序不接受连接，除非它可以使用 SSL，请设置 JDBC 连接属性：`ssl=true`. [http://jdbc.postgresql.org/documentation/head/ssl-client.html](http://jdbc.postgresql.org/documentation/head/ssl-client.html)

抱歉，但我不知道 MySQL 是如何管理这些的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-06T08:35:04.710

我自己正在尝试为 Postgre 找到答案，但这是您可以为 MySQL 做的事情。

首先，您需要启用对数据库的远程访问。您可以按如下方式创建具有远程访问能力的用户。

```
GRANT ALL ON *.* to user@address IDENTIFIED BY 'password'; 
flush privileges; 
```

更多细节[在这里](https://stackoverflow.com/questions/10236000/allow-all-remote-connections-mysql)。

要为此添加安全性，您可以在 GRANT 命令中添加“REQUIRE SSL”，如下所示

```
GRANT ALL ON *.* to user@address IDENTIFIED BY 'password' REQUIRE SSL; 
```

所有这些都需要在服务器端完成。在客户端上，您只需要提供连接所需的证书。

有关创建证书的详细信息，MySQL 站点在[此处提供了分步指南](http://dev.mysql.com/doc/refman/5.0/en/creating-ssl-certs.html)

# python - 导入不在路径上的python模块

> ID：10161568
> 
> 赞同：56
> 
> 时间：2012-04-15T11:21:00.927
> 
> 标签：python, import, external, python-module

我有一个模块 foo，包含 util.py 和 bar.py。

我想在 IDLE 或 python 会话中导入它。我该怎么做？

我找不到有关如何导入不在当前目录或默认 python PATH 中的模块的文档。尝试后`import "<full path>/foo/util.py"`，和`from "<full path>" import util`

我能得到的最接近的是

```
import imp
imp.load_source('foo.util','C:/.../dir/dir2/foo') 
```

这给了我在 Windows 7 上被拒绝的权限。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-04-15T11:32:32.443

一种方法是简单地修改你的[路径](http://docs.python.org/library/sys.html#sys.path)：

```
import sys
sys.path.append('C:/full/path')
from foo import util,bar 
```

请注意，这要求 foo 是一个 python 包，即包含一个`__init__.py`文件。如果不想修改`sys.path`，也可以[修改`PYTHONPATH`环境变量](http://docs.python.org/tutorial/modules.html#the-module-search-path)或[在系统上安装模块](http://docs.python.org/install/index.html)。请注意，这意味着`.py`可能会无意中加载该目录中的其他目录或文件。

因此，您可能想[`imp.load_source`](http://docs.python.org/library/imp.html#imp.load_source)改用。它需要文件名，而不是目录（允许当前用户读取的文件）：

```
import imp
util = imp.load_source('util', 'C:/full/path/foo/util.py') 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-15T11:26:29.163

您可以使用环境变量自定义模块搜索路径`PYTHONPATH`，或手动修改`sys.path`目录列表。

请参阅python.org 上的[模块搜索路径文档。](http://docs.python.org/tutorial/modules.html#the-module-search-path)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-15T11:29:09.993

试试这个

```
import sys
sys.path.append('c:/.../dir/dir2')
import foo 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-01-01T16:27:58.497

按照 phihag 的提示，我有这个解决方案。只需提供源文件的路径，`load_src`它就会加载它。您还必须提供一个名称，以便您可以使用此名称导入此模块。我更喜欢这样做，因为它更明确：

```
def load_src(name, fpath):
    import os, imp
    return imp.load_source(name, os.path.join(os.path.dirname(__file__), fpath))

load_src("util", "../util.py")
import util

print util.method() 
```

另一种（不太明确的）方式是：

```
util = load_src("util", "../util.py")    # "import util" is implied here

print util.method()    # works, util was imported by the previous line 
```

*编辑：*重写该方法以使其更清晰。

# c# - 解析没有字符串拆分

> ID：10161572
> 
> 赞同：7
> 
> 时间：2012-04-15T11:21:11.697
> 
> 标签：c#, parsing

这是从[其他一些问题](https://stackoverflow.com/questions/10053449/extract-numbers-from-string)的讨论中衍生出来的。

假设我必须解析大量非常长的字符串。每个字符串都包含一个`double`由空格分隔的 s 序列（当然是在文本表示中）。我需要将`double`s 解析为`List<double>`.

标准解析技术（使用`string.Split`+ `double.TryParse`）似乎很慢：对于每个数字，我们需要分配一个字符串。

我试图使它成为类似 C 的旧方式：计算包含数字的子字符串的开头和结尾的索引，并“就地”解析它，而不创建额外的字符串。（见[http://ideone.com/Op6h0](http://ideone.com/Op6h0)，下面显示了相关部分。）

```
int startIdx, endIdx = 0;
while(true)
{
    startIdx = endIdx;
    // no find_first_not_of in C#
    while (startIdx < s.Length && s[startIdx] == ' ') startIdx++;
    if (startIdx == s.Length) break;
    endIdx = s.IndexOf(' ', startIdx);
    if (endIdx == -1) endIdx = s.Length;
    // how to extract a double here?
} 
```

有一个重载`string.IndexOf`，仅在给定的子字符串中搜索，但我找不到从子字符串中解析双精度的方法，而没有先实际提取该子字符串。

有人有想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-15T11:54:59.763

没有**托管 API**可以从子字符串中解析双精度。我的猜测是，与 double.Parse 中的所有浮点运算相比，分配字符串将是微不足道的。

无论如何，您可以通过创建一个长度为 100 的仅包含空格的“缓冲区”字符串来保存分配。然后，对于要解析的每个字符串，使用**unsafe code**将字符复制到此缓冲区字符串中。您用空格填充缓冲区字符串。对于解析，您可以使用 NumberStyles.AllowTrailingWhite 这将导致尾随空格被忽略。

获取指向字符串的指针实际上是一个完全受支持的操作：

```
 string l_pos = new string(' ', 100); //don't write to a shared string!
    unsafe 
    {
        fixed (char* l_pSrc = l_pos)
        {               
              // do some work
        }
    } 
```

C# 具有将字符串绑定到 char* 的特殊语法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T13:12:08.410

如果你想做得很快，我会使用状态机

这可能看起来像：

```
enum State
{
    Separator, Sign, Mantisse etc.
}
State CurrentState = State.Separator;
int Prefix, Exponent, Mantisse;
foreach(var ch in InputString)
{
    switch(CurrentState)
    { // set new currentstate in dependence of ch and CurrentState
        case Separator:
           GotNewDouble(Prefix, Exponent, Mantisse); 

    }

} 
```

# oracle10g - 更新克洛布？

> ID：10161573
> 
> 赞同：1
> 
> 时间：2012-04-15T11:21:13.267
> 
> 标签：oracle10g, clob

我有一个表 abc(serial int primary key,details clob)。我想更新表的详细信息字段。我要更新的数据超过 4000 个字符。所以请任何人详细告诉我如何更新 clob使用 pl/sql 或任何其他方法的列？

# java - 返回一个类的实例

> ID：10161574
> 
> 赞同：1
> 
> 时间：2012-04-15T11:21:21.973
> 
> 标签：java

我有以下课程：

MinMaxArray 类：

```
public class MinMaxArray
{
  public static <T> void MinMax(T[] anArray)
  {
    //return an instance of class Pair
  }//MinMax
}//class MinMaxArray 
```

对类：

```
//Two objects grouped into a pair.
public class Pair<FirstType, SecondType>
{
  //The first object.
  private final FirstType first;

  //The second object.
  private final SecondType second;

  //Constructor is given the two objects.
  public Pair(FirstType requiredFirst, SecondType requiredSecond)
  {
    first = requiredFirst;
    second = requiredSecond;
  }//Pair

  //Return the first object.
  public FirstType getFirst()
  {
    return first;
  }//GetFirst

  //Return the second object.
  public SecondType getSecond()
  {
    return second;
  }//GetSecond

}//class Pair 
```

我不确定如何返回 Pair 类的实例。不寻找答案，只是一个起点。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T11:55:54.487

一个提示是您可以创建一个 Pair，其中`T`有两种类型。

# http - 计算内容长度 POST

> ID：10161578
> 
> 赞同：15
> 
> 时间：2012-04-15T11:22:29.147
> 
> 标签：http, post

如何计算内容长度，例如：

```
POST /Upload/ HTTP/1.1
Host: test.lan
User-Agent: Shockwave Flash
Connection: Keep-Alive
Cache-Control: no-cache
Accept: text/*
Content-Length: ?????
Content-Type: multipart/form-data; boundary=----------------------------4d2179e6b3c0

------------------------------4d2179e6b3c0
Content-Disposition: form-data; name="Filename"

phpinfo.php
------------------------------4d2179e6b3c0
Content-Disposition: form-data; name="ASPSESSID"

6e223eb1c7561e9c599f03cc04e9444b
------------------------------4d2179e6b3c0
Content-Disposition: form-data; name="Filedata"; filename="phpinfo.php"
Content-Type: application/octet-stream

<? phpinfo(); ?>
------------------------------4d2179e6b3c0
Content-Disposition: form-data; name="Upload"

Submit Query
------------------------------4d2179e6b3c0-- 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-25T05:25:39.397

该`Content-Length`值应通过对消息头终止*后的所有数据进行总计来计算。*在您的示例中，这是此后的所有内容（`CRLF`为了便于阅读而包含字符）：

```
...
Content-Length: ?????\r\n
Content-Type: multipart/form-data; boundary=--------------------4d2179e6b3c0\r\n
\r\n 
```

第一个空行 ( `\r\n`) 之后的所有内容（包括边界分隔符）都应计入总长度。在实践中，这通常意味着您需要`Content-Length`在生成完整的消息实体正文后将标头值制成表格。获得完整的消息正文后，您可以在其前面加上标头以创建完整的 HTTP 消息。

根据 HTTP 规范，您在技术上*不需要*指定`Content-Length`标头。从[RFC 2616 14.13](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.13)：

> 应用程序应该使用这个字段来指示消息体的传输长度，除非这被第 4.4 节中的规则禁止。

`Content-Length`但是，对于大多数服务器来说，这是一个非常标准的要求，如果缺少或指定不正确，通常会发回错误响应。

# c++ - c ++在字符串中跳过ws？

> ID：10161582
> 
> 赞同：1
> 
> 时间：2012-04-15T11:23:07.960
> 
> 标签：c++, string, spaces

我知道如何输入文本并跳过空格，但是当它是一个字符串时呢？在代码中，我得到一个类似的字符串

> 阿斯达斯 阿斯达斯 阿斯达斯德 阿斯达斯德

所以我需要删除其中的所有空间。那么有什么写法`skipws(string_text);`吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T11:29:54.360

如果你想用 value 构造一个字符串`asdasdasdadsasdasdasdasd`，你可以使用 remove-erase idiom：

```
str.erase( std::remove( str.begin(), str.end(), ' ' ), str.end() ); 
```

或使用`::isspace`from `<ctype.h>`,

```
str.erase( std::remove_if( str.begin(), str.end(), ::isspace ), str.end() ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T11:26:53.630

没有通用的方法。您可以串联使用查找/替换来执行此操作，或者您可以使用`stringstream`（用您的输入字符串初始化）并使用`>>`来获取没有空格的单词并将结果连接到（另一个/相同的）字符串中

# c# - AndroidManifest.xml 在构建时不合并活动信息

> ID：10161592
> 
> 赞同：0
> 
> 时间：2012-04-15T11:23:43.267
> 
> 标签：c#, android, xamarin.android

Mono for Android (C#) 相当新，我似乎在他们的一个[教程](http://docs.xamarin.com/android/getting_started/Hello_Multiscreen_Applications)中遇到了麻烦，其中提到有关活动的信息在编译时被合并到 AndroidManifest.xml 中。

FirstActivity 类设置为 Compile on Build，但没有创建 AndroidManifest 文件。可以通过“项目”菜单创建一个，但它不包含有关活动的任何信息，并且在更改这些信息时不会更新。

在互联网上环顾四周，但我只找到了与 Visual Studio 相关的问题。

任何帮助，将不胜感激！：） 谢谢。

编辑：如果有任何问题，我现在正在使用评估版。

编辑：似乎遇到更多问题。通过 Mono 访问 AVD 时遇到问题，并决定将 Android SDK 重新安装到最新版本。尝试在模拟器上运行程序会导致“设备”列表在模拟器启动后不久消失（或者，在最好的情况下，它无法确认模拟器处于活动状态）。运行“adb devices”会吐出正确的模拟器“emulator-5554”或其他东西，但 Mono 只是反复没有注意到。

据我所知，它正确地指向了 Android SDK 和 Java。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T15:16:12.690

生成的 AndroidManifest.xml 在以下位置创建：

`obj\Debug\android\AndroidManifest.xml`

您项目中的那个没有被触及。

# android - 在 Android 项目上实现 DAO 模式

> ID：10161595
> 
> 赞同：5
> 
> 时间：2012-04-15T11:24:19.183
> 
> 标签：android, database, design-patterns, dao

我正在开发 Android 3.1 及更高版本。

我有以下软件包：

![在此处输入图像描述](../Images/b50a51ba6476968aa74a3ca510166afd.png)

`es.viacognita.models`包含用于存储通过 Web 服务检索到的数据的类。当我获得所有 Web 服务数据时，我需要将其插入数据库。

为了使它正确，我曾想过使用 DAO 模式，但我不知道该怎么做。

如果我使用 DAO 模式，我是否需要使用`es.viacognita.models`类？我认为这些类将成为 DAO 类，不是吗？

我必须在哪里实现插入、更新或删除？上课`DBManager`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-15T11:42:17.893

您可以在 DBManager 类中实现插入、更新、删除和所有其他操作，或者创建一个单独的类 dao 来执行您想要对数据库执行的所有操作...

```
 public class DAO {
private SQLiteDatabase database,customdb;
private DBManager dbHelper;

public DAO(Context context) {
    dbHelper = new DBManager(context);
}
public void open() throws SQLException {
    database = dbHelper.getWritableDatabase();

}
public void close() {
    dbHelper.close();
}
//insering,deleting and all other operations you want to perforem on the database
  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T11:41:37.703

我会使用 DBManager 的命名空间。我将您的模型类视为业务实体类，并为 DAO (DAL) 层创建一个单独的库。使用这种方法，您可以将业务逻辑与数据访问层分开。

# c# - 如何用此规则替换字符串？

> ID：10161598
> 
> 赞同：1
> 
> 时间：2012-04-15T11:24:28.523
> 
> 标签：c#, .net, string

我有一个可以包含任何字符的字符串。我想要：

1.  将重音字符替换为非重音字符（如 à 必须变为 a、é=>e 等）；
2.  仅在字符串中保留 a-zA-Z、数字和`-`;

我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T11:56:36.400

您可以尝试[`string.Normalize`](http://msdn.microsoft.com/en-us/library/system.string.normalize.aspx)（`NormalizationForm.FormD`将重音字符拆分为“基本”字符和一个或多个组合字符），然后过滤掉所有非字母字符。

编辑：

```
string s = "éäï";
var ca = s.Normalize(NormalizationForm.FormD)
          .ToCharArray()
          .Where(c => c >= 'a' && c <= 'z');
// ca contains eai now 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T11:31:06.827

以下内容应该适合您：

```
// Remove all accents
var bytes = Encoding.GetEncoding("Cyrillic").GetBytes(text);
text = Encoding.ASCII.GetString(bytes);

// Remove all unwanted characters
var regex = new Regex("[^a-zA-Z0-9-]");
text = regex.Replace(text, ""); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-15T11:29:42.677

您可以访问字符串中的每个字符。你取实际的字符，将它发送到一个方法。在这种方法中，您有一堆 if -lse 或 case 开关。那将是你的规则。如果其中一条规则接受您的字符，则返回该字符的替换。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-15T11:31:21.597

此功能将删除所有不允许的字符并替换您的重音符号。

```
private string FormatStringToAllowableCharacters(string inString) {
        string returnString;
        returnString = inString.Replace("é","e");
        returnString = returnString.Replace("ä","a");
        returnString = returnString.Replace("ï","i");
    returnString = Regex.Replace(returnString, "[^a-zA-Z0-9-]", "");
        return returnString;
    } 
```

# java - Objective C 中 Java 的 Matcher.lookingAt() 的等价物

> ID：10161599
> 
> 赞同：2
> 
> 时间：2012-04-15T11:24:36.217
> 
> 标签：java, objective-c

我正在将一个框架从 Java 移植到 Objective C，这在很大程度上依赖于正则表达式。不幸的是，Java 正则表达式 API 与 Objective C API 有很大不同。

我正在尝试使用**NSRegularExpression**类来评估正则表达式。在 Java 中这是完全不同的：您必须使用 Pattern 和 Matcher 类。

有些事情我无法弄清楚（除其他外）。Objective C 中 Matcher.lookingAt() 的等价物是什么？把它放在代码中。以下代码的 Objective C 翻译是什么？

```
Pattern pattern = Pattern.compile("[aZ]");
boolean lookingAt = pattern.matcher("abc").lookingAt(); 
```

感谢知道的人！（顺便说一句，上面的示例将 true 分配给 lookingAt 布尔值）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T14:07:32.633

我想到了！这是 Java 代码的 NSRegularExpression 等价物：

```
NSError *error = nil;
NSRegularExpression *expression = [NSRegularExpression regularExpressionWithPattern:@"[aZ]" options:0 error:&error];
if (error) {
    // Do something when an error occurs
}
NSString *candidate = @"abc";
BOOL lookingAt = [expression numberOfMatchesInString:candidate options:NSMatchingAnchored range:NSMakeRange(0, candidate.length)] > 0; 
```

这里的重点在于执行表达式时的**NSmatchingAnchored选项！**文档说：

> **NSMatchingAnchored**指定匹配仅限于搜索范围开始处的匹配。有关上下文中常量的描述，请参见 enumerateMatchesInString:options:range:usingBlock:。

这正是我一直在寻找的！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-15T11:33:03.207

你可以做类似的事情

```
NSString *regex = @"ObjC";
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"SELF CONTAINS %@", regex]; 

if( [predicate evaluateWithObject:myString]) 
    NSLog(@"matches");
else
    NSLog(@"does not match"); 
```

查看[谓词格式字符串语法](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/Predicates/Articles/pSyntax.html#//apple_ref/doc/uid/TP40001795)指南以获取更多选项。

# php - 在 CakePHP 中将标签保存到数据库表中

> ID：10161604
> 
> 赞同：0
> 
> 时间：2012-04-15T11:26:03.810
> 
> 标签：php, cakephp

我的 CakePHP 应用程序有以下设置：

```
Posts
id
title
content

Topics
id
title

Topic_Posts
id
topic_id
post_id 
```

所以基本上我有一个主题（标签）表，它们都是唯一的并且有一个 id。然后可以使用 Topic_Posts 连接表将它们附加到帖子。当用户创建新帖子时，他们将通过将主题输入到以逗号分隔的文本区域来填写主题，然后如果它们不存在，则将它们保存到主题表中，然后将引用保存到 Topic_posts 表中。我的模型设置如下：

岗位型号：

```
class Post extends AppModel
{
    public $name = 'Post';

    public $hasAndBelongsToMany = array(
        'Topic' => array('with' => 'TopicPost')
    );
} 
```

主题模型：

```
class Topic extends AppModel
{
    public $hasMany = array(
        'TopicPost'
    );
} 
```

主题帖子模型：

```
class TopicPost extends AppModel {
    public $belongsTo = array(
        'Topic', 'Post'
    );
} 
```

到目前为止，对于 New post 方法，我有这个：

```
public function add()
{
    if ($this->request->is('post'))
    {
        //$this->Post->create();

        if ($this->Post->saveAll($this->request->data))
        {

            // Redirect the user to the newly created post (pass the slug for performance)
            $this->redirect(array('controller'=>'posts','action'=>'view','id'=>$this->Post->id));
        }
        else
        {
            $this->Session->setFlash('Server broke!');
        }
    }
} 
```

如您所见，我已经使用过`saveAll`，但是如何处理 Topic 数据？

我见过这样的事情：[http](http://bakery.cakephp.org/articles/dooltaz/2007/05/02/simple-tagging-behavior) ://bakery.cakephp.org/articles/dooltaz/2007/05/02/simple-tagging-behavior但我希望这样做更简单、更现代（那篇文章的日期2007) 我也在使用 CakePHP 2.1

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T13:47:59.047

我会在主题（模型）中实现一个方法，如下所示：

```
/**
 * This methods saves the topics coming from a post save and associates them with the right post.
 * 
 * @param string $postId The post id to save associations to.
 * @param string $topics A comma seperated list of topics to save.
 * @param bool Save of all topics succeeded (true) or not (false).
 */
    public function savePostTopics($postId, $topics){
        // Explode the topics by comma, so we have an array to run through
        $topics = explode(',', $topics);
        // Array for collecting all the data
        $collection = array();

        foreach($topics as $topic){
            // Trim it so remove unwanted white spaces in the beginning and the end.
            $topic = trim($topic);

            // Check if we already have a topic like this
            $controlFind = $this->find(
                'first',
                array(
                    'conditions' => array(
                        'title' => $topic
                    ),
                    'recursive' => -1
                )
            );

            // No record found
            if(!$controlFind){
                $this->create();
                if(
                    !$this->save(
                        array(
                            'title' => $topic
                        )
                    )
                ){
                    // If only one saving fails we stop the whole loop and method.
                    return false;
                }
                else{
                    $temp = array(
                        'TopicPost' => array(
                            'topic_id' => $this->id,
                            'post_id' => $postId
                        )
                    )
                }
            }
            else{
                $temp = array(
                    'TopicPost' => array(
                        'topic_id' => $controlFind['Topic']['id'],
                        'post_id' => $postId
                    )
                )
            }
            $collection[] = $temp;
        }

        return $this->TopicPost->saveMany($collection, array('validate' => false));
    } 
```

我没有测试它，但它应该可以工作。

您可以在保存帖子本身后调用它，并为其提供帖子 ID 和数据数组中的主题。确保您处理该方法的返回。如果主题保存失败，这是删除整个帖子的原因吗？由于 cakephp 中没有很好的实现回滚 api，但如果需要，您可能必须从数据库中删除帖子。或者你只是给写帖子的用户一个成功的信息并记录错误？

顺便说一句：按照 cakephp 约定，模型和关联表也必须命名为**PostTopic**和**post_topic**。按字母顺序;) 您可能希望在项目的早期状态下更改它。

问候 func0der

# vba - 如何使用所有 Excel 的共享代码创建 VBA 加载项？

> ID：10161605
> 
> 赞同：1
> 
> 时间：2012-04-15T11:26:20.353
> 
> 标签：vba, excel, add-in

我正在为多个 Excel 电子表格编写 VBA 代码，这些代码将不时与他人共享。在某些时候，我发现我的作品中有很多重复。所以我想找到一种在某种 Excel 插件中共享代码的方法，比如 .xla 文件。

但是当我尝试将包含共享代码的 Excel 文件保存为 .xla 文件时，我遇到了一些问题：

1.  将文件保存在默认加载项文件夹中后无法再编辑
2.  如果我将 .xls 文件移动到加载项文件夹以外的文件夹并直接打开它 - 我无法使用它的类 - 这会为共享代码带来问题

请以灵活而强大的方式创建加载项的任何想法？

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T14:34:23.343

不完全确定这是您要找的东西，但是...

(1)通过单击 VBA 编辑器中的保存图标来保存*.xla/ .xlam 代码。*但是，保存的是当前在 Project Explorer 窗格中选择的东西，它列出了所有打开的 VB 项目，通常在左侧。即使您正盯着刚刚编辑的 VBA 代码，单击保存图标也不会保存您的代码，除非它也在 Project Explorer 窗格中被选中。您不会收到任何已保存的反馈 - 但您可以通过在单独的窗口中检查文件时间戳来验证。

(2) 如果您有一个 *.xls 文件（通过公式栏）从您的 *.xla / *.xlam 文件中引用 VBA 函数，那么如果您打开 *.xls 文件而不打开*.xla、* .xlam首先，Excel 可能会创建外部链接来解析公式（即引用未打开的文件）。如果您移动或重命名了 *.xla 文件，您可能会遇到那些“错误的公式”，并且需要使用全局替换来编辑 Excel 插入的路径名链接。如果您安排在使用它的任何 *.xls 文件之前打开*.xla、* .xlam，那么您应该没有问题（例如，通过使用默认文件夹）。

# python - 使用 Python C-API 的类属性

> ID：10161609
> 
> 赞同：8
> 
> 时间：2012-04-15T11:26:41.190
> 
> 标签：python, python-c-api

使用 Python C-API创建*类属性*（如此[处](https://stackoverflow.com/questions/3203286/how-to-create-a-read-only-class-property-in-python)和[此处）的最佳方法是什么？](https://stackoverflow.com/questions/2173206/is-there-any-way-to-create-a-class-property-in-python)静态属性也适用于我的情况。

**跟进：**

我试图实施牦牛的建议。我在其和槽中定义了一个`P`具有 get 和 set 函数的类。然后我在 key 下的类的类型对象的字典中添加了一个实例。然后`tp_descr_get``tp_descr_set``P``X``p`

```
x1 = X()
x2 = X()
x1.p = 10
print x1.p
print x2.p
print X.p
x2.p = 11
print x1.p
print x2.p
print X.p 
```

有效（前 10 打印 3 次，然后 11 打印 3 次），但是

```
X.p = 12 
```

失败并显示错误消息

```
TypeError: can't set attributes of built-in/extension type 'X' 
```

我该如何解决？

**跟进2：**

如果我分配类型对象`PyMem_Malloc`并设置`Py_TPFLAGS_HEAPTYPE`标志，那么一切正常；我可以做到`X.p = 12`预期的结果。

如果我将类型对象保存在静态变量中并设置`Py_TPFLAGS_HEAPTYPE`标志，事情也会起作用，但这显然不是一个好主意。（但是为什么类型对象是在静态内存还是动态内存中很重要？我从来没有让它的引用计数下降到 0。）

只能在动态类型上设置属性的限制看起来很奇怪。这背后的原因是什么？

**跟进3：**

不，它不起作用。如果我使类型`X`动态，`X.p = 12`则不将属性设置`X.p`为十二；它实际上将对象绑定`12`到 name `X.p`。换句话说，事后，`X.p`不是整数值属性，而是整数。

**跟进4：**

这是扩展的 C++ 代码：

```
#include <python.h>
#include <exception>

class ErrorAlreadySet : public std::exception {};

// P type ------------------------------------------------------------------

struct P : PyObject
{
    PyObject* value;
};

PyObject* P_get(P* self, PyObject* /*obj*/, PyObject* /*type*/)
{
    Py_XINCREF(self->value);
    return self->value;
}

int P_set(P* self, PyObject* /*obj*/, PyObject* value)
{
    Py_XDECREF(self->value);
    self->value = value;
    Py_XINCREF(self->value);
    return 0;
}

struct P_Type : PyTypeObject
{
    P_Type()
    {
        memset(this, 0, sizeof(*this));
        ob_refcnt = 1;
        tp_name = "P";
        tp_basicsize = sizeof(P);
        tp_descr_get = (descrgetfunc)P_get;
        tp_descr_set = (descrsetfunc)P_set;
        tp_flags = Py_TPFLAGS_DEFAULT;

        if(PyType_Ready(this)) throw ErrorAlreadySet();
    }
};

PyTypeObject* P_type()
{
    static P_Type typeObj;
    return &typeObj;
}

// P singleton instance ----------------------------------------------------

P* createP()
{
    P* p_ = PyObject_New(P, P_type());
    p_->value = Py_None;
    Py_INCREF(p_->value);
    return p_;
}

P* p()
{
    static P* p_ = createP();
    Py_INCREF(p_);
    return p_;
}

PyObject* p_value()
{
    PyObject* p_ = p();
    PyObject* value = p()->value;
    Py_DECREF(p_);
    Py_INCREF(value);
    return value;
}

// X type ------------------------------------------------------------------

struct X : PyObject {};

void X_dealloc(PyObject* self)
{
    self->ob_type->tp_free(self);
}

struct X_Type : PyTypeObject
{
    X_Type()
    {
        memset(this, 0, sizeof(*this));
        ob_refcnt = 1;
        tp_name = "M.X";
        tp_basicsize = sizeof(X);
        tp_dealloc = (destructor)X_dealloc;
        tp_flags = Py_TPFLAGS_DEFAULT | Py_TPFLAGS_HEAPTYPE;

        tp_dict = PyDict_New();
        PyObject* key = PyString_FromString("p");
        PyObject* value = p();
        PyDict_SetItem(tp_dict, key, value);
        Py_DECREF(key);
        Py_DECREF(value);

        if(PyType_Ready(this)) throw ErrorAlreadySet();
    }

    void* operator new(size_t n) { return PyMem_Malloc(n); }
    void operator delete(void* p) { PyMem_Free(p); }
};

PyTypeObject* X_type()
{
    static PyTypeObject* typeObj = new X_Type;
    return typeObj;
}

// module M ----------------------------------------------------------------

PyMethodDef methods[] = 
{
    {"p_value", (PyCFunction)p_value, METH_NOARGS, 0},
    {0, 0, 0, 0}
};

PyMODINIT_FUNC
initM(void)
{
    try {
        PyObject* m = Py_InitModule3("M", methods, 0);
        if(!m) return;
        PyModule_AddObject(m, "X", (PyObject*)X_type());
    }
    catch(const ErrorAlreadySet&) {}
} 
```

这段代码定义了一个带有类属性的模块`M`，`X`如前所述`p`。我还添加了一个函数`p_value()`，让您可以直接检查实现该属性的对象。

这是我用来测试扩展的脚本：

```
from M import X, p_value

x1 = X()
x2 = X()

x1.p = 1
print x1.p
print x2.p
print X.p
print p_value()
print

x2.p = 2
print x1.p
print x2.p
print X.p
print p_value()
print

X.p = 3
print x1.p
print x2.p
print X.p
print p_value()     # prints 2
print

x1.p = 4       # AttributeError: 'M.X' object attribute 'p' is read-only 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-16T00:06:03.107

与这些 Python 解决方案类似，您必须`classproperty`在 C 中创建一个类型并实现其`tp_descr_get`功能（对应`__get__`于 Python）。

然后，如果要在 C 类型中使用它，则必须创建`classproperty`类型的实例并将其插入类型的字典（类型的`tp_dict`插槽）。

**跟进：**

似乎不可能设置 C 类型的属性。对于所有非堆类型（没有标志的类型） `tp_setattro`，元类 ( )的函数`PyType_Type`会引发“无法设置内置/扩展类型的属性”异常。`Py_TPFLAGS_HEAPTYPE`该标志是为动态类型设置的。你可以让你的类型动态化，但它可能比它更有价值。

这意味着我最初给出的解决方案允许您在 C 类型对象上创建一个属性（如：计算属性），但限制它是只读的。对于设置，您可以使用类/静态方法（`METH_CLASS`/`METH_STATIC`方法上的标志`tp_methods`）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-09-14T12:30:30.207

我将尝试传达我发现的关于使用类静态属性的本质。

我的（编辑）代码如下：

```
// Prepare your type object, which you will no doubt complete 
// by calling PyType_Ready, as here.
if (PyType_Ready(typeObj) < 0)
{
  return;
}

Py_INCREF(typeObj);
PyModule_AddObject(module, typeName, (PyObject*) typeObj);

// Now we add static members directly to the type's tp_dict, but 
// only *after* we've registered the type (above)
PyObject* dict = typeObj->tp_dict;

// You'll have your own wrapper / C values in the line below. This is just
// a pseudo-version of what I am (successfully) using.
PyObject* tmp = MyCreateWrapper(myStaticValueInC);

// Py_INCREF(tmp); // You may need this, depending on how line above works.

PyDict_SetItemString(dict, staticPropertyName, tmp);

Py_DECREF(tmp); 
```

我相信所有要点都在这里，就构建代码以实现类属性的顺序而言。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-23T16:37:48.230

如果这是一个可接受的解决方案，您可以在包含声明的模块上创建一个方法，该方法`X`只是根据需要设置类变量。例如：

```
PyObject* set_p_value(PyObject*, PyObject* o) {
  if(PyDict_SetItemString(X_type()->tp_dict, "p", o) == -1) return 0;
  Py_RETURN_NONE; 
}

PyMethodDef methods[] = 
{
    ...
    {"set_p_value", (PyCFunction)set_p_value, METH_O, 0},
    {0, 0, 0, 0}
}; 
```

一旦那里，比：

```
from M import X, set_p_value
set_p_value(3)
print X.p #should print '3' 
```

应该按预期工作。一个缺点是，不幸的是，这个功能与类型对象本身无关。如果您提供了一个根据需要设置类变量的类方法，则可以部分避免这种情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-12T23:26:31.727

`tp_dict`只要在您调用之前发生，您就可以添加项目`PyType_Ready`：

```
int err;
PyObject *p;

if (!X_Type.tp_dict) {
    X_Type.tp_dict = PyDict_New();
    if (!X_Type.tp_dict)
        return NULL;
}

p = PyLong_FromLong(12);
if (!p)
    return NULL;

err = PyDict_SetItemString(X_Type.tp_dict, "p", p)
Py_DECREF(p);
if (err)
    return NULL;

m = PyModule_Create(&M_module);
if (!m)
    return NULL;

if (PyModule_AddType(m, &X_type));
    return NULL;

return m; 
```

# php - 调用 Web 服务时未获取数据

> ID：10161615
> 
> 赞同：1
> 
> 时间：2012-04-15T11:27:03.113
> 
> 标签：php, web-services, curl, file-get-contents

我正在使用 curl 进行后期 Web 服务调用。在本地我获取数据，但是当我将代码和 Web 服务转移到服务器时，我没有获取数据。

当我从为 firefox 添加的 rest 客户端调用时，我得到数据。

当我通过代码时，我得到以下消息。

```
Error:- 1.when using curl for post it reply:- Not Found.
        2\. when using file_get_contents it gives:-failed to open stream: HTTP request failed! HTTP/1.0 404 Not Found 
```

我现在能做什么

代码：-

```
<?php

            //$request =base_webservice_url.'User/getCountries/';
            $request ='***********/User/getcountries/';

            // Get the curl session object
            $session = curl_init($request);
            // Set the POST options.
            curl_setopt ($session, CURLOPT_POST, true);
            curl_setopt ($session, CURLOPT_POSTFIELDS,'');
            curl_setopt($session, CURLOPT_HEADER, false);
            curl_setopt($session, CURLOPT_RETURNTRANSFER, true);

            // Do the POST and then close the session
            $response = curl_exec($session);
            curl_close($session);
            $result= json_decode($response,true);
            $result1 = $result['result'];    
                print_r($response);

          ?> 
```

它给出错误：未能打开流：连接尝试失败，因为连接方在一段时间后没有正确响应，或者由于连接的主机未能响应而建立连接失败。文件名：views/personal_form.php

我正在使用 iis 进行托管

# java - java中文件夹的访问检查

> ID：10161617
> 
> 赞同：0
> 
> 时间：2012-04-15T11:27:07.073
> 
> 标签：java, permissions

> **可能重复：**
> [带有 AccessController.checkPermission 的 java 目录权限](https://stackoverflow.com/questions/4483303/java-directory-permissions-with-accesscontroller-checkpermission)

我正在使用以下代码检查所选文件夹的访问权限。但它不起作用。

```
private boolean writeAccess(String path){
    try {
        AccessController.checkPermission(new FilePermission(path, "read,write"));/*,*/
        // Has permission
        return true;

        } 
    catch (SecurityException e) {
        // Does not have permission
        return false;
    }   
} 
```

其中有什么问题。还有其他选项可以检查文件夹/目录的存在和访问吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T11:46:06.840

不，您的代码会检查代码本身是否具有与有效的 Java 安全策略相关的权限。很可能您甚至没有激活 Java 安全性。您正在寻找的是`File`类中的方法，请查看：[`canRead`](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#canRead%28%29),`canWrite`等。

# r - 相当于glm（）中的“PROC GLM; FREQ”？

> ID：10161619
> 
> 赞同：0
> 
> 时间：2012-04-15T11:27:41.203
> 
> 标签：r, sas

R 是否`glm()`有任何等效`FREQ`于 SAS 的切换，`PROC GLM`由此每个观察单位都被计数 N 次，由相应的`FREQ`变量定义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T13:22:06.537

如果您的数据设置正确，那么作为表示频率权重的整数向量给出的权重参数可能会成功。family="binomial" 的情况需要使响应计数为一列，权重为其他参数模式的出现次数。帮助页面中的相关两句稍作编辑：

“非空权重可用于表示 [当权重的元素是正整数 w_i] .... 每个响应 y_i 是 w_i 单位权重观测值的平均值。对于二项式 GLM，先验权重用于给出当响应是成功的比例时的试验次数：它们很少用于泊松 GLM。”

然而，在 Poisson GLM 的情况下，总体权重可以作为抵消项输入。

# unix - 如何使用 diff 命令忽略最后一次输入？

> ID：10161622
> 
> 赞同：0
> 
> 时间：2012-04-15T11:28:19.430
> 
> 标签：unix, io, comparison, diff

我想使用 diff Unix 命令来比较输出文件。

但是，有时输出末尾会有多余的“\n”，但我仍然想将文件视为相同。

说我有这个输出：

```
XXXXX
XXXXX 
```

和：

```
XXXXX
XXXXX\n 
```

（不能让它显示一个空行，所以我写了\n）

我希望能够使用 unix diff 命令，但仍将这两个输出视为相等。

为了让自己清楚，我只想忽略**最后**输入（“\ n”）。其余的不应该被忽视。

例如，这两个输出不应被视为相等：

```
XXXXX

XXXXX 
```

和

```
XXXXX
XXXXX 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T11:35:48.287

您是否尝试过以下`-b`选项：

```
-b, --ignore-space-change
          ignore changes in the amount of white space 
```

[http://unixhelp.ed.ac.uk/CGI/man-cgi?diff](http://unixhelp.ed.ac.uk/CGI/man-cgi?diff)

如果您只想排除最后一个可能的新行，请尝试在将结果传递给 diff 之前使用 sed 将其删除：

```
sed '${/^$/d}' file1 | diff - file2 
```

# ruby-on-rails - 在 Ubuntu 或 Mint 上安装 Ruby on Rails

> ID：10161625
> 
> 赞同：5
> 
> 时间：2012-04-15T11:28:57.123
> 
> 标签：ruby-on-rails, linux, installation

我已经在我的 Windows 7 分区上安装了 Rails，但它太慢了，所以我决定尝试在 Linux 上安装它。

我已经尝试过 Ubuntu 11.04 和 Mint 12，对于这两个版本，我都遇到了同样的问题。

我正在关注指南“Ruby On Rails 教程”，并且我还有一个名为“Ruby On Rails Ubuntu Linux Mint”的 PDF 安装指南。

我到达了它所说的部分`type rvm notes`- 列出了要安装的东西。然后我安装所有这些东西，然后当我输入`rvm`它时说“没有 rvm”。显然，有一个 rvm 供我输入`rvm notes`。

我搜索了驱动器（sudo find / -name *rvm*，我得到了 11 个条目，包括 /etc/profie.d/rvm.sh 和 /etc/rvmrc。还有一个`ruby-rvm`.

我给了自己一点时间来测试 Django 和 Ruby，但我似乎对 Ruby 毫无进展。

我即将尝试在 Virtual Box 中安装 Turnkey Ubuntu Rails，但我仍然想知道为什么我不能在 Ubuntu 或 Mint 中安装它。我怀疑两者都是同样的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T11:35:03.567

我最近没有尝试过，但它似乎是最新的，我相信 Ryan Biggs。请参阅他[关于在 Ubuntu 上安装 Ruby & Rails 的帖子，](http://ryanbigg.com/2010/12/ubuntu-ruby-rvm-rails-and-you/)我相信您会明白的。

# wordpress - 如何使用 WP 电子商务插件中添加的自定义元

> ID：10161626
> 
> 赞同：0
> 
> 时间：2012-04-15T11:28:59.140
> 
> 标签：wordpress

我想为通过 WP 电子商务插件添加的每个产品显示一个唯一的标题图像。

我在高级设置标题下的自定义元中添加了图像的 URL。

我无法弄清楚如何在 header.php 的 WP 电子商务插件的自定义元中添加数据？

请有任何建议。

* * *

更新：

我尝试了以下在 wpsc-single-product.php 中找到的代码

```
if (wpsc_have_custom_meta()) :
    while ( wpsc_have_custom_meta() ) : wpsc_the_custom_meta();
        $product_meta = wpsc_custom_meta_value();
    endwhile;
endif; 
```

这显示以下错误：致命错误：在第 1304 行的 wp-content/plugins/wp-e-commerce/wpsc-includes/product-template.php 中的非对象上调用成员函数 have_custom_meta()

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T13:40:06.883

这取决于您放置该代码的位置。如果在第 29 行之后没有输入：

```
while ( wpsc_have_products() ) : wpsc_the_product(); 
```

...那么它不在 The Loop 内，获取自定义元数据将导致错误。

# c# - WP7中父列表框垂直滚动时如何锁定水平滚动

> ID：10161629
> 
> 赞同：2
> 
> 时间：2012-04-15T11:29:40.263
> 
> 标签：c#, windows-phone-7, silverlight-3.0, silverlight-toolkit

我的列表框包含自定义模板。每个模板都可以使用 Toolkit GestureService 水平拖动。

我的目标是滚动列表框时，项目不能拖动。

我需要处理父列表框滚动吗？

如何处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T11:33:21.917

使用该`ScrollViewer.VerticalScrollBarVisibility`属性来禁用控件内的滚动条，`ListBox`如下所示：

```
<ListBox ScrollViewer.VerticalScrollBarVisibility="Disabled" ... >
    ...
</ListBox> 
```

# javascript - IE 中的 getElementById 问题？

> ID：10161631
> 
> 赞同：2
> 
> 时间：2012-04-15T11:29:46.503
> 
> 标签：javascript, getelementbyid

为什么下面的代码在 Firefox 和 Chrome 中运行良好，但在 IE6 和 IE8 中却报错？

```
<!DOCTYPE html>
<html>  
<head></head>  
<body>
<div id="abc"></div>
<script type="text/javascript">
var doLoad = function() {
  // error in ie6 and ie8
  abc = document.getElementById("abc"); 
  abc.innerHTML = "hello world!"; 
  // correct in ie6 and ie8
  /*
  var abc = document.getElementById("abc"); 
  abc.innerHTML = "hello world!";
  */
  // correct in ie6 and ie8
  /* 
  xyz = document.getElementById("abc"); 
  xyz.innerHTML = "hello world!";
  */
}
window.onload = doLoad;
</script>  
</body>  
</html> 
```

但是如果我在`var`之前添加`document.getElementById("abc");`或重命名`abc`为`xyz`，它将在 IE6 和 IE8 中运行良好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T11:35:48.143

IE 为每个具有 ID 的元素创建一个全局 JavaScript 变量。这些变量不能被覆盖 afaik 并导致各种问题。

要记住的事情：不要创建与元素 ID 同名的全局变量。根本不要创建全局变量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-15T11:35:59.953

当您错过 var 语句时，它会将变量分配给 window 对象。所以它是一样的`window.abc = document.getElementById('abc');`

但是 window.abc 正是 id 为 abc 的 div 并且在 IE 中你不能给它赋值。

# javascript - 显示特定类 Javascript(Jquery) 的元素

> ID：10161634
> 
> 赞同：1
> 
> 时间：2012-04-15T11:30:04.393
> 
> 标签：javascript, jquery, list, show

```
<div id=klik>KLIK   </div>
<div class="list">
    <div class="list-wrapper">
        <div class="line">1</div>
        <div class="line">2</div>
    </div>
    <div class="line">3</div>
    <div class="line">4</div>
</div> 
```

这是HTML。我首先使用 Javscript 隐藏整个列表。然后我想做一个 onclick 函数来显示前两个元素，两个在 div 列表包装器中。这是我写的代码。

```
$(document).ready(function(){
$(".list").hide();

$("#klik").click(function(){
$(".list-wrapper").show();

});
}); 
```

它从不显示元素的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T11:35:50.547

您正在尝试显示仍包裹在隐藏父元素中的元素。如果您隐藏并显示相同的选择，它就可以正常工作。你可以这样做：

```
$(document).ready(function(){
   $(".list").hide();

   $("#klik").click(function(){
      $(".list").show().children().not('.list-wrapper').hide(); //show .list, then hide everything that is not inside .list-wrapper
   });

});​ 
```

**[工作演示](http://jsfiddle.net/UgcZ2/)**

**编辑：**
并修复您的 HTML 标记（缺少引号`""`）`<div id=klik>KLIK</div>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T11:36:26.107

您正在隐藏要显示的内容的父元素。 `show`只会显示你调用它的元素，它不会级联 DOM 树。

```
$(document).ready(function(){
    $(".list").hide();
    $("#klik").click(function(){
         $(".list").show(); //Show .list elements instead

    });
}); 
```

# java - 获取当前年份和月份导致奇怪的结果

> ID：10161637
> 
> 赞同：27
> 
> 时间：2012-04-15T11:30:24.720
> 
> 标签：java, android, date, gregorian-calendar

我正在做一个与 Android 相关的学习项目。我正在尝试使用以下代码获取当前年份和月份，但它不适用于我。

```
GregorianCalendar gc = new GregorianCalendar();
gc.YEAR // returning 1       
gc.MONTH // returning 2

Calendar c = Calendar.getInstance();
c.YEAR // returning 1       
c.MONTH // returning 2 
```

有人能帮我吗？难道我做错了什么？请原谅我，我是 Java 开发的新手。谢谢。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-04-15T11:55:25.867

只是为了提供更多背景：

两者都`new GregorianCalendar()`将`Calendar.getInstance()`正确给出在当前日期和时间初始化的日历。

`MONTH`并且`YEAR`是类中的*常量*[`Calendar`](http://docs.oracle.com/javase/7/docs/api/java/util/Calendar.html)。您不应该*“*通过”引用来使用它们，这使得它们看起来像是对象状态的一部分。这是类设计的一个不幸部分`Calendar`，要访问不同字段的值，您需要`get`使用指定为这些常量之一的字段编号进行调用，如其他答案所示：

```
Calendar c = Calendar.getInstance();
int year = c.get(Calendar.YEAR);
int month = c.get(Calendar.MONTH); 
```

请注意，月份编号是从 0 开始的，因此在撰写本文时（4 月），月份编号将为 3。

Java 语言设计的一个不幸部分是，您*可以*通过该类型的表达式引用静态成员（例如常量），而*不仅仅是*通过类型名称。

我的建议：

*   如果您的 IDE 允许（就像 Eclipse 一样），请制作诸如`c.YEAR`给出编译时错误之类的表达式 - 如果您始终使用`Calendar.YEAR`.
*   在可能的情况下，使用[Joda Time](http://www.joda.org/joda-time/) - 一个更好的 Java 日期/时间库。诚然，在 Android 上，您可能会受到空间的限制，但如果您的应用程序执行大量日期/时间操作，它将为您省去很多麻烦。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-12-08T08:34:47.573

注意 MONTHS 从 0 开始..所以如果您需要将其映射到实际问题只需添加 +1

```
int month=c.get(Calendar.MONTH)+1; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-15T11:36:10.387

```
int year=c.get(Calendar.YEAR);
int month=c.get(Calendar.MONTH);

   System.out.println(year);
   System.out.println(month); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-15T11:36:28.360

```
Calendar c= Calendar.getInstance()
int cyear = c.get(Calendar.YEAR);//calender year starts from 1900 so you must add 1900 to the value recevie.i.e., 1990+112 = 2012
int cmonth = c.get(Calendar.MONTH);//this is april so you will receive  3 instead of 4.
int cday = c.get(Calendar.DAY_OF_MONTH); 
```

参考这个[链接](http://developer.android.com/reference/java/util/Calendar.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-12-16T03:33:24.850

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-12-15T19:18:53.063

### 如何获取当前年份和月份。

```
 Calendar calendar = Calendar.getInstance();             
        int month = calendar.get(Calendar.MONTH) + 1;
        int year = calendar.get(Calendar.YEAR); 
```

* * *

加 1 以获得正确的月份非常重要，因为第一个月的值为 0：

```
 int month = calendar.get(Calendar.MONTH) + 1; 
```

> [**MONTH**](https://developer.android.com/reference/java/util/Calendar.html#MONTH)：get 和 set 的字段编号，表示月份。这是特定于日历的值。公历和儒略历中的第一个月是 JANUARY，即 0；最后一个取决于一年中的月数。

# python - 管理助手死亡

> ID：10161638
> 
> 赞同：37
> 
> 时间：2012-04-15T11:30:25.687
> 
> 标签：python, emacs, rope, ropemacs, pymacs

我已经安装了 Pymacs、rope、ropemode、ropemacs，当我`pymacs-terminate-services`意外执行时，我无法保存修改过的缓冲区。它首先问我 - `The Pymacs helper died. Restart it? (yes or no)`。如果我回答“是”，它会抛出 - `Debugger entered--Lisp error: (error "There is no Pymacs helper!")`。如果我回答“不”，它会抛出：

```
Debugger entered--Lisp error: (error "Python: Traceback (most recent call last):
  File \"/usr/local/lib/python2.7/dist-packages/Pymacs.py\", line 258, in loop
    value = eval(text)
  File \"<string>\", line 1, in <module>
IndexError: list index out of range
") 
```

我设法通过执行`pymacs-load`、加载`os`模块并对 Pymacs 帮助程序重启问题回答“是”来解决问题。缓冲区已保存，但每次保存文件时我都开始收到另一个错误：

```
Debugger entered--Lisp error: (error "Python: Traceback (most recent call last):
  File \"/usr/local/lib/python2.7/dist-packages/Pymacs.py\", line 258, in loop
    value = eval(text)
  File \"<string>\", line 1, in <module>
TypeError: major() takes exactly 1 argument (0 given)
") 
```

这是我的初始化文件：

```
(load "~/.emacs.d/pymacs.el")
(autoload 'pymacs-apply "pymacs")
(autoload 'pymacs-call "pymacs")
(autoload 'pymacs-eval "pymacs" nil t)
(autoload 'pymacs-exec "pymacs" nil t)
(autoload 'pymacs-load "pymacs" nil t)
(autoload 'pymacs-autoload "pymacs")
(require 'pymacs)
 (pymacs-load "ropemacs" "rope-") 
```

[Pymacs 手册](http://pymacs.progiciels-bpi.ca/pymacs.html#pymacs-auto-restart)描述了 Pymacs 助手的死亡。它告诉我不应该关闭`*Pymacs*`缓冲区，因为这会杀死助手，并且如果助手被杀死，还应该重新启动 Emacs。这是不可接受的，因为我有不时关闭所有缓冲区并且很少重新启动 Emacs 的习惯。我现在有几个相关的问题：

*   处理 Pymacs 以尽量减少此类问题的最佳方法是什么？只有当我使用 Python 并再次安全终止它时才可以运行 Pymacs？
*   有什么`pymacs-terminate-services`用，我应该运行它吗？
*   如果我不小心跑了`pymacs-terminate-services`怎么办？我对如何编辑`before-save-hook`以使缓冲区保存成为可能而没有错误消息特别感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T17:22:56.200

我能想到的最简单的解决方案是使用`kill-buffer-query-functions`钩子来防止`*Pymacs*`被杀死。像这样：

```
(defun my-pymacs-saver ()
  (if (equal (buffer-name) "*Pymacs*")
      (yes-or-no-p "Really kill *Pymacs* buffer? ")
    t))

(add-hook 'kill-buffer-query-functions 'my-pymacs-saver) 
```

它会询问您是否真的要杀死`*Pymacs*`缓冲区。您甚至可以通过以下方式使其无法从键绑定中杀死：

```
(defun my-pymacs-saver ()
  (if (equal (buffer-name) "*Pymacs*")
      (progn
        (message "NEVER kill *Pymacs*!")
        nil)
    t)) 
```

我`pymacs-terminate-services`用来强制重新加载所有模块。我有一个类似于[http://www.emacswiki.org/emacs/AntonNazarov](http://www.emacswiki.org/emacs/AntonNazarov)`pymacs-reload-rope`的功能。

可能您可以添加`pymacs-terminate-services`到`kill-buffer-hook`（本地`*Pymacs*`缓冲区中）以获得更优雅的终止。但我不确定。对于您的其余问题，我想最好在 Pymacs[问题跟踪器](https://github.com/pinard/Pymacs/issues)中询问/请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T19:31:21.567

如果您不小心杀死了 *Pymacs* 缓冲区或执行`pymacs-terminate-services`，您可以通过执行以下命令并在提示符处回答“是”来恢复进程。

```
(pymacs-load "ropemacs" "rope-") 
```

您可以修改您的 init-file 函数以允许重新启动以交互方式调用`M-x python-restart`。以这种方式重新启动 Pymacs 将避免该`TypeError: major()...`错误。

```
(defun pymacs-restart ()
  (interactive)
  (pymacs-load "ropemacs" "rope-"))

(load "~/.emacs.d/pymacs.el")
(autoload 'pymacs-apply "pymacs")
(autoload 'pymacs-call "pymacs")
(autoload 'pymacs-eval "pymacs" nil t)
(autoload 'pymacs-exec "pymacs" nil t)
(autoload 'pymacs-load "pymacs" nil t)
(autoload 'pymacs-autoload "pymacs")
(require 'pymacs)
(pymacs-restart) 
```

# css - 带有 css 的模糊背景图像

> ID：10161639
> 
> 赞同：0
> 
> 时间：2012-04-15T11:30:26.917
> 
> 标签：css, image, background, blur

有没有用 模糊图像`CSS`，特别是背景？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T11:38:22.437

就在这里。
您可以使用两种不同的背景，一种具有鲜明的色彩（主图片），另一种是模糊的图片：

```
body  {
  background: url(images/bg-solid.jpg) no-repeat;
}

#page-wrap {
  background: url(images/bg-blurry.jpg) no-repeat fixed;
  width: 500px; margin: 40px auto;
} 
```

[要查看详细教程，请单击此处](http://css-tricks.com/blurry-background-effect/)

**编辑：**
对于图像，您可以使用 svg 过滤器，如下所示：
该`<feGaussianBlur>`元素用于创建模糊效果：

```
<svg xmlns="http://www.w3.org/2000/svg" version="1.1">
  <defs>
    <filter id="f1" x="0" y="0">
      <feGaussianBlur in="SourceGraphic" stdDeviation="15" />
    </filter>
  </defs>
  <rect width="90" height="90" stroke="green" stroke-width="3"
  fill="yellow" filter="url(#f1)" />
</svg> 
```

*   元素的 id 属性定义了过滤器的唯一名称
*   模糊效果是用元素定义的
*   in="SourceGraphic" 部分定义为整个元素创建效果
*   stdDeviation 属性定义模糊量
*   元素的filter属性将元素链接到“f1”过滤器
    [详细解释见这里](http://srufaculty.sru.edu/david.dailey/svg/SVGOpen2010/Filters2.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T10:36:09.230

是的，有过滤器模糊图像的方式，您可以在链接中阅读更多关于它们的信息。但是它们还不能在所有浏览器上正常工作！而且我没有找到让它们适用于背景图像的方法。

[检查这个](http://www.inserthtml.com/2012/06/css-filters/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T11:42:48.980

这是不可能通过**CSS 实现**的。

您必须使用服务器端语言处理图像并生成模糊图像，然后在 CSS 背景中使用它。

# ruby - RMagick：如何检查图像特定区域中的所有像素是否都是透明的？

> ID：10161650
> 
> 赞同：0
> 
> 时间：2012-04-15T11:32:05.350
> 
> 标签：ruby, png, imagemagick, rmagick

我想从给定的图像创建一个代码。例如，这张图片：

![在此处输入图像描述](../Images/f9d5044a4d0a3cdcad7177b7f90bacb3.png)

应该得到代码`111-111-010`。

（假设它是一个`png`图像，除了香蕉本身之外的所有像素都是透明的。）

如果特定正方形中的所有像素都是透明的，则该正方形的值为`0`，否则为`1`。

所以，给定一个图像，我想把它分成给定大小的正方形（例如香蕉图像是`300x300`像素，正方形是`100x100`），然后创建一个如上所述构建的代码（字符串）。

最简单的方法可能是使用`each_pixel`并手动检查正方形中的所有像素是否都是透明的。有没有更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T03:28:10.987

我会将您现有的图像缩小到 3x3 大小：

```
play = image.resize(3, 3, CubicFilter, 0.5) 
```

然后，您可以通过使用以下方法检查每个剩余像素来创建代码：

```
code = ""
(0..2).each do |ix|
  (0..2).each do |iy|
    code += play.pixel_color(ix,iy).opacity == 65535 ? "0" : "1"
    code += iy == 2 ? "-" : "" unless ix == 2 && iy == 2
  end
end 
```

我比较不透明度是`65535`因为当我检查一个我知道是透明的像素时，这是返回的：

```
=> red=65535, green=65535, blue=65535, opacity=65535 
```

# asp.net-mvc-3 - 如何在 MVC 3 中将 EntityFramework.patterns 与 ninject 一起使用？

> ID：10161655
> 
> 赞同：1
> 
> 时间：2012-04-15T11:32:33.667
> 
> 标签：asp.net-mvc-3, entity-framework, ninject

我正在尝试使用 nuget 的 EntityFramework.Patterns 包，但我被卡住了，这是我的

问题：如何使用 ninject 在 mvc 控制器中注入 productRepo 和 unitOfWork ？

这是教程链接：[http ://efpatterns.codeplex.com/wikipage?title=Pattern%20%3a%20Use%20Repository%20and%20UOF](http://efpatterns.codeplex.com/wikipage?title=Pattern%20%3a%20Use%20Repository%20and%20UOF)

```
DbContextAdapter adapter = new DbContextAdapter(ctx);
IRepository<Product> productRepo = new Repository<Product>(adp);
IUnitOfWork unitOfWork = new UnitOfWork(adp); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-23T15:13:29.633

*   从 nuget 下载 Ninject.MVC3 包。
*   从 AppStart 文件夹中删除“ninject web common”部分
*   打开您的 global.asax 并将您的代码更改为如下所示

```
namespace OnBoardingMVC
{
    public class MvcApplication : Ninject.Web.Common.NinjectHttpApplication
    {
        protected override IKernel CreateKernel()
        {
            var kernel = new StandardKernel();
            NinjectConfig.RegisterServices(kernel);
            return kernel;
        }    
        protected override void OnApplicationStarted()
        {
            base.OnApplicationStarted();
            AreaRegistration.RegisterAllAreas();
            WebApiConfig.Register(GlobalConfiguration.Configuration);
            FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);
            RouteConfig.RegisterRoutes(RouteTable.Routes);
            BundleConfig.RegisterBundles(BundleTable.Bundles);
        }
    }
} 
```

然后，您可以在 App_Start 文件夹中创建一个新的 NinjectConfig.cs 文件，并将以下代码添加到您的类中：

```
namespace OnBoardingMVC
{
    public class NinjectConfig
    {
        public static void RegisterServices(IKernel kernel)
        {
            // e.g. kernel.Load(Assembly.GetExecutingAssembly());
            kernel.Bind(typeof(IEmployeeUow))
                  .To(typeof(EmployeeUow))
                  .WithConstructorArgument("adapter", <Add new AdapterVariable here>)
            ;
        }
    }
} 
```

然后，您可以创建一个`EmployeeUow`从该类继承的`UnitOfWork`类，并创建一个`IEmployeeUow`从该类继承的类，`IUnitOfWork`并且上下文适配器将作为构造函数的参数，并且该构造函数还将适配器传递给该类的基本构造函数`UnitOfWork`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T22:33:49.673

添加一个构造函数，将它们作为控制器的参数。搜索构造函数注入以获取更多详细信息。

# jquery - 带有 Spring MVC 的 JQuery Full Calendar .. 无法将日历数据发送到控制器

> ID：10161656
> 
> 赞同：1
> 
> 时间：2012-04-15T11:32:52.300
> 
> 标签：jquery, json, spring-mvc, fullcalendar, freemarker

我正在尝试将 JQuery Full Calendar 与 Spring MVC + Freemarker 一起使用。

我做了一个这样的[演示](http://arshaw.com/js/fullcalendar-1.5.3/demos/selectable.html)。

目标：我需要将刚刚放入的日历数据发送给控制器进行处理。

问题：当我将数据发送到控制器时，我在控制器上收到的字符串参数有“undefined=undefined”！！

自由标记：

```
[#ftl /]
<script type="text/javascript">
    var calendar;
    var calendarData;
    function sendDataViaAjax() {
         $.ajax(
            {
              url:"[@spring.url '/vacation/setVacation'/]",
              type: "POST",
              data: calendarData,
              dataType: "json",
              contentType: "application/json"
            } );
    }

    $(document).ready(function() {
        var date = new Date();
        var d = date.getDate();
        var m = date.getMonth();
        var y = date.getFullYear();
        $.getJSON('[@spring.url '/vacation/getVacation'/]', function (data) {
            calendar = $('#calendar').fullCalendar({
                header: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'month,agendaWeek,agendaDay'
                },
                selectable: true,
                selectHelper: true,
                select: function(start, end, allDay) {
                    var title = prompt('Event Title:');
                    if (title) {
                        calendar.fullCalendar('renderEvent',
                        {
                            title: title,
                            start: start,
                            end: end,
                            allDay: allDay
                        },
                                true // make the event "stick"
                                );
                    }
                    calendar.fullCalendar('unselect');
                },
                editable: true,
                events:[data]
            });
          calendarData=data;
        });
    });

</script>
<style type='text/css'>

    body {
        margin-top: 40px;
        text-align: center;
        font-size: 14px;
        font-family: "Lucida Grande", Helvetica, Arial, Verdana, sans-serif;
    }

    #calendar {
        width: 900px;
        margin: 0 auto;
    }

</style>
<body>
<div id='calendar'></div>

<button value="Test" onclick="sendDataViaAjax()"
</body> 
```

其 String 参数为 "undefined=undefined" 的 Java 控制器：

```
 @RequestMapping(value = "/vacation/setVacation", method = RequestMethod.POST)
      public
      @ResponseBody
      String setVacation( @RequestBody String  response) {

       //Rest of code
      } 
```

* * *

我已经改变了一点我的freemarker，如下所示：

```
<script type="text/javascript">
    var calendar;
    var calendarData;

    function doAjax() {
        var test = JSON.stringify(calendarData);

        $.ajax(
        {
            url:"[@spring.url '/vacation/setVacation'/]",
            type: "POST",
            data :test ,
            dataType: "json",
            contentType: "application/json"
        });
    }

    $(document).ready(function() {
        var date = new Date();
        var d = date.getDate();
        var m = date.getMonth();
        var y = date.getFullYear();
        $.getJSON('[@spring.url '/vacation/getVacation'/]', function (data) {
            calendar = $('#calendar').fullCalendar({
                header: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'month,agendaWeek,agendaDay'
                },
                selectable: true,
                selectHelper: true,
                select: function(start, end, allDay) {
                    var title = prompt('Event Title:');
                    if (title) {
                        calendar.fullCalendar('renderEvent',
                        {
                            title: title,
                            start: start,
                            end: end,
                            allDay: allDay
                        },
                                true // make the event "stick"
                                );
                    }
                    calendar.fullCalendar('unselect');
                },
                editable: true,
                events:[data]   //To allow Calendar to render data ,I use events:data instead
            });
            calendarData = data;
        });
    });

</script> 
```

通过这种方式，我可以将 json String 发布到控制器，然后我可以继续我需要的东西。什么让我很生气，现在日历被渲染为空而没有我在初始化时传递的事件。但是，为了呈现日历数据，我做了一个小改动，正如上面评论中提到的那样。通过这种方式，每当我尝试发布 json String 时，都会收到以下错误：“Uncaught TypeError: Converting circular structure to JSON”。我做了很多试验，但我仍然有提到的问题！任何人都知道那里发生了什么！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T13:10:38.480

我能想到的一些可以帮助您解决的事情是

1.  请检查警报或萤火虫，变量“日历”的值是多少。那是您所期望的值。
2.  而不是 ajax POST，您可以尝试 REST 模式“PUT”的另一个选项，并在控制器中进行相同的更改。
3.  您可以尝试将 RequestParam 注释与 RequestBody 一起使用。

# ios - How to load an image file from a different project in MonoTouch

> ID：10161659
> 
> 赞同：1
> 
> 时间：2012-04-15T11:33:04.280
> 
> 标签：ios, xamarin.ios, uiimage, project, monodevelop

I have a main project. Then i want to have another project where i have only the images. This is because i have a tool that builds for me this project.

So the main project has the lohic, and the Data Project has the images.

Well, i can load images with `UIImage.FromFile`. But only is this images ARE in the main project.

When i take a look to the app generated, i can see that , even if i change the file properties to Content, and Copy always, no image files appear at all. It seems that they are embedded as a resource.

This is not what i want at all. I want to copy a bunch of files to the iPhone, and the load it using `UIImage.FromFile`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T16:14:05.683

尝试这个：

首先，在您的*图像*项目中将所有数据设置为**resources**。它们将嵌入到生产的组件中。

接下来，从您的主项目中，用于`UIImage.FromResource`创建图像。指定程序集（由您的图像项目创建）和图像文件的名称。

# asp.net - allowDefinition='MachineToApplication' 超出应用程序级别错误，但它是一个应用程序

> ID：10161666
> 
> 赞同：0
> 
> 时间：2012-04-15T11:33:43.533
> 
> 标签：asp.net, visual-studio, visual-studio-2010, iis-7, web-config

尝试在 Visual Studio 2010 中构建我的网站时，我收到以下错误：

*在应用程序级别之外使用注册为 allowDefinition='MachineToApplication' 的部分是错误的。此错误可能是由未在 IIS 中配置为应用程序的虚拟目录引起的。C:\Users\Owner\Documents\Visual Studio 2010\WebSites\ussvision\knowledgebase\web.config 20*

我的根目录中有一个 web.config - /ussvision/ - 子目录中有另一个 web.config - /knowledgebase/。

我知道这个错误通常意味着您没有将子目录配置为 IIS7 中的应用程序。 **但是我有！** 我打开IIS7，右键OWNER-PC，点击“添加网站”，指向物理路径，右键知识库，选择“转换为应用程序”。尝试构建时，它继续给我这个错误，指向我的知识库子目录中的 web.config。我应该在 IIS7 中以不同的方式做到这一点吗？

任何消除此错误的指导，以便我可以构建网站，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T11:38:52.077

你能发布 web.config 特别是在第 20 行附近吗？您那里有会员提供者登录重定向页面吗？

# javascript - 缩小iPhone视口的脚本？

> ID：10161668
> 
> 赞同：0
> 
> 时间：2012-04-15T11:33:48.093
> 
> 标签：javascript, iphone, css, viewport

是否有任何脚本可以在单击某些 HTML 元素时将 Safari 中的 iPhone 视口缩小到初始比例 = 1.0？

像：

```
jQuery('#element').click(function(){
    //scale is set to default, 1.0 here (it zooms out as much as possible)
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T12:58:03.723

像这样的东西：

```
-webkit-transform: scale(1.0); 
```

会做你要求的。但是，您需要检查您是否没有像大多数移动网络应用程序那样阻止用户在单击/拖动时进行缩放。

# c# - 如何从 RGB 像素数组中保存图像？

> ID：10161669
> 
> 赞同：1
> 
> 时间：2012-04-15T11:33:54.503
> 
> 标签：c#, image

最近我[学会](https://stackoverflow.com/q/10127871/1306322)了如何将图像保存为字节（文本文件中的 RGB 值），现在我想知道如何从 RGB 值数组创建一个完全有效的图像。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T11:58:54.900

您可以使用@dasblinkenlight 提到的方法：

```
int width = 1; // read from file
int height = 1; // read from file
var bitmap = new Bitmap(width, height, PixelFormat.Canonical);

for (int y = 0; y < height; y++)
   for (int x = 0; x < width; x++)
   {
      int red = 0; // read from array
      int green = 0; // read from array
      int blue = 0; // read from array
      bitmap.SetPixel(x, y, Color.FromArgb(0, red, green, blue));
   } 
```

# billing - Google Place API 使用限制和计费

> ID：10161672
> 
> 赞同：15
> 
> 时间：2012-04-15T11:34:16.500
> 
> 标签：billing, google-places-api

我开发了一款应用，其中使用了 Google Place API。这就是places doc所说的限制。

**Google Places API 具有以下查询限制：**

1.  拥有 API 密钥的用户每 24 小时允许 1000 个请求。

2.  还通过 API 控制台验证身份的用户每 24 小时允许 100 000 个请求。通过在控制台中启用计费，需要信用卡进行验证。使用 Places API 不会从您的卡中收取费用。

**所以我的问题是，如果我为 Place API 启用计费，那么它是免费的吗？这是真的吗？**

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-15T11:40:00.640

是的，你会明白他们在说什么。我已经这样做了，所以我可以确认...如果您输入您的信用卡信息，您就是在让他们知道您是经过验证的用户，因此您不会滥用他们的服务。

对于第二个问题，我们在这里谈论的是谷歌。这是真的，你不会被收费，他们可以从其他来源赚钱:)

**编辑：**

实际上，如果您需要的不仅仅是“已验证”选项，您似乎可以按照 Thor Mitchell（产品经理@Google）在 Quora 的本主题中所述与他们联系：[Pros and Cons of Places API](http://www.quora.com/What-are-the-pros-and-cons-of-each-Places-API)

> “使用限制（在身份验证后）是每天 100,000 个请求，我们很高兴与需要更多需求的开发人员交谈。”

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-11-01T08:41:06.050

截至今天，限制是每天[150,000次免费请求，但](https://developers.google.com/maps/pricing-and-plans/)[文档](https://developers.google.com/maps/premium/usage-limits)很难理解他们如何对超额收费。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2019-03-05T04:09:43.320

**2019 年 3 月**最新更新：

**“有关 Google Maps Platform 产品定价的概述，请参阅[定价表。](https://cloud.google.com/maps-platform/pricing/sheet/?__utma=102347093.803954946.1551756399.1551758908.1551758908.1&__utmb=102347093.0.10.1551758908&__utmc=102347093&__utmx=-&__utmz=102347093.1551758908.1.1.utmcsr=(direct)%7Cutmccn=(direct)%7Cutmcmd=(none)&__utmv=-&__utmk=125576330&_ga=2.237053059.2045150526.1551756604-803954946.1551756399)**

**要详细了解 Google Maps Platform API 的计费方式，请参阅[了解地图、路线和地点的计费。](https://developers.google.com/maps/billing/understanding-cost-of-use)"**

[![在此处输入图像描述](../Images/d01a42c15c959a8fcfa3a9125f69c353.png)](https://i.stack.imgur.com/afRD0.png)

# sql - 在连接表中选择记录

> ID：10161675
> 
> 赞同：0
> 
> 时间：2012-04-15T11:34:39.100
> 
> 标签：sql, ms-access, join, left-join

我在 MS Access 中有两个表。一个是 Appointment 表，一个是 Slot 表。像这样： ![表](../Images/59336df496d385472297f3f1ee59fce8.png)

现在我想从 slot 表中选择每条记录，如果约会表中有 TeacherID = "CR" 的记录，我希望它显示 StudentID。

这是我到目前为止的 SQL：

```
SELECT Slot.SlotNumber, Slot.SlotTime, Appointment.TeacherID
FROM Slot LEFT JOIN Appointment ON Slot.SlotNumber = Appointment.SlotNumber
WHERE Appointment.TeacherID="CR" 
```

但是，这只会选择 Appointment 表中有记录的位置。有什么建议么？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T11:36:04.367

如果我理解你是正确的。你不想要这个`where`声明。而是将其放在`LEFT JOIN`. 像这样：

```
SELECT 
  Slot.SlotNumber, 
  Slot.SlotTime, 
  Appointment.TeacherID
FROM 
  Slot 
  LEFT JOIN Appointment 
    ON (Slot.SlotNumber = Appointment.SlotNumber
    AND Appointment.TeacherID="CR") 
```

# .net - WCF 服务 400 错误请求

> ID：10161680
> 
> 赞同：1
> 
> 时间：2012-04-15T11:35:14.360
> 
> 标签：.net, wcf, exception

我创建了一个接收大文件的服务。之后，我将其发布在本地 IIS7 上。之后，我创建了带有服务参考的测试客户端。当我尝试将大文件发送到服务器时，我得到：**Bad request (400)**。

该异常的服务跟踪： **已超出传入消息的最大消息大小配额 (65536)。要增加配额，请在适当的绑定元素上使用 MaxReceivedMessageSize 属性。**

服务器配置：

```
 <system.web>
<compilation debug="true" targetFramework="4.0" />
<httpRuntime maxRequestLength="2097151" useFullyQualifiedRedirectUrl="true" executionTimeout="14400"/>
<customErrors mode="Off" /></system.web> 
```

捆绑

```
 <wsHttpBinding>
    <binding name="wsBufferedHttpsBinding" messageEncoding="Mtom" 
             maxReceivedMessageSize="11534336" maxBufferPoolSize="524288"
             sendTimeout="00:05:00" receiveTimeout="00:05:00" openTimeout="00:05:00" closeTimeout="00:05:00" >
      <readerQuotas maxDepth="64" maxStringContentLength="11534336" maxArrayLength="11534336"
          maxBytesPerRead="11534336" maxNameTableCharCount="16384" />
    </binding>
  </wsHttpBinding> 
```

服务

```
 <service name="MyService">
    <endpoint address=""
              binding="wsHttpBinding"
              bindingName="wsBufferedHttpsBinding"
              contract="IServiceContract">
    </endpoint>
    <endpoint address="mex" binding="mexHttpsBinding" contract="IMetadataExchange" />
    <endpoint address="soap12IssuedToken" binding="customBinding"
      bindingConfiguration="soap12IssuedToken" name="soap12IssuedToken"
      bindingNamespace="http://url"
      contract="IServiceContract" />
  </service> 
```

这项服务到底有什么问题？我在任何地方都设置了这个消息大小。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T12:57:25.217

看起来主要问题是您的端点没有引用绑定配置。因此，您使用的是默认值 65536。

还有一些其他的事情需要检查：

*   同一个合同有 2 个端点，您使用的是设置了 maxReceivedMessageSize 的那个吗？
*   客户端上的配置是否与服务器上的配置相匹配？
*   您可能还需要设置“maxBufferPoolSize”和“maxBufferSize”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T15:10:36.177

答案很简单：

```
 <endpoint address=""
          binding="wsHttpBinding"
          bindingName="wsBufferedHttpsBinding"
          contract="IServiceContract"> 
```

我没有看到有**bindingName**而不是**bindingConfiguration**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T03:31:50.677

后来我也遇到了这个问题，但后来我通过 在服务的**行为中添加****dataContractSerializer maxItemsInObjectGraph="2147483646"来解决它**

# security - 在不访问用户 IP 地址的情况下保护 HTTPS 互联网门户？

> ID：10161683
> 
> 赞同：0
> 
> 时间：2012-04-15T11:35:31.323
> 
> 标签：security, http, https, load-balancing

我正在尝试重新设计一个具有一些继承安全漏洞的小型在线门户。最值得注意的是，由于网络架构和负载平衡器，应用程序无法访问请求的 IP 地址。通常我会坚持对来自每个唯一地址的请求数量进行限制，但考虑到某些人可以访问的疯狂范围，这可能不是最终的最佳解决方案。

我可以限制平衡器上每个地址的打开连接数，但它仍然让我对蛮力开放。

显然，我在尝试 n 次后犹豫是否要锁定帐户，因为这会给任何合法用户带来不便，但这似乎是实现这一点的极少数方法之一。

简要地考虑为每个用户分配一个唯一的 id 并将它们短暂地反弹到 HTTP 连接以捕获 X-Forwarded-For 标头然后将它们跳过回 HTTPS 但似乎这可能是一个糟糕的选择并且 MITM 可以拦截这很容易劫持会话。IT 人员到底是如何处理这种限制的？

附加：似乎正在使用的负载平衡器将允许您限制每秒的连接数。这将有所帮助，但仍可能导致在一段时间内收到数量可疑的无效请求。然而，现在似乎时间是我们可以使用的一个因素。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T19:15:43.470

您描述的每个时间间隔对策的连接数最好在负载均衡器上实现；这是该技术的继承功能，是实现的理想场所。对于尝试登录次数过多但未成功的用户，您无需在多次尝试失败后将帐户锁定，而是执行验证码之类的操作，它会提示用户输入难以看到的内容代码。这将防止自动脚本/攻击启动暴力尝试以用户身份登录。

我不提倡出于任何原因将任何人从 HTTPS 连接反弹到 HTTP 连接。

# c++ - A* Jump Point Search - 修剪如何真正起作用？

> ID：10161689
> 
> 赞同：7
> 
> 时间：2012-04-15T11:35:58.280
> 
> 标签：c++, collision-detection, path-finding

我遇到了[Jump Point Search](http://harablog.wordpress.com/2011/09/07/jump-point-search/)，这对我来说似乎很甜蜜。但是，我不确定他们的修剪规则实际上是如何工作的。更具体地说，在图 1 中，它指出

> 我们可以立即修剪所有灰色邻居，因为这些邻居可以从 x 的父节点以最佳方式到达，而无需经过节点 x

然而，这似乎有些矛盾。在第二幅图像中，可以通过首先通过节点 7 并`x`完全跳过对称路径来到达节点 5，也就是说，`6 -> x -> 5`似乎与 对称`6 -> 7 -> 5`。这与无需通过`x`第一张图像即可到达节点 3 的方式相同。因此，我不明白这两个图像如何不完全等效，而不仅仅是彼此的旋转版本。

其次，我想了解如何将此算法推广到三维搜索量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T13:05:20.897

我理解这是关于优先事项。为了枚举每个非对称路径，您必须枚举所有节点 - 但您选择哪条路径并不重要，因为它们是对称的。因此，作者决定采用对角线优先——也就是说，任何对角线运动总是出现在路径中的任何直线运动之前。这就是为什么直线有更多的节点被修剪 - 因为它必须在考虑所有对角线之后发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T12:17:02.777

第二张图片显示不正确。如果您看一下随附的文本：“在这两种情况下，我们都可以立即修剪所有灰色邻居，因为这些邻居可以从 x 的父节点以最佳方式到达，而无需经过节点 x。”

强调“两种情况”。

就将概念应用于 3 维空间（或者说，甚至是 n 维空间）而言，该算法与 A* 没有什么不同，因为它只是一个节点和连接的网格。维度完全由您自行决定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-19T02:15:02.683

是的，JPS 很不错，但仅限于具有特定约束的地图：

1.  地图必须代表一个网格。
2.  网格中所有可访问的单元格必须具有相同的遍历成本。
3.  移动代理必须有 8 个可能的行进方向：4 个基本方向和 4 个对角线。

该算法的关键是这些约束允许一些关键假设：

1.  两点之间的最短几何路线（在没有障碍物的情况下）也是成本最低的路线。
2.  两点之间的最低成本路径（在没有障碍物的情况下）不需要不止一次改变方向。

这些假设允许算法忽略对称路径选项并按如下方式操作：

1.  当沿基本方向行驶时，您只需考虑在论文中所示位置之一遇到障碍物时改变方向。这些要考虑改变方向的点是“跳跃点”。
2.  当沿对角线行驶时，您只需考虑在两个包围“前视”基本方向之一中“看到”跳跃点时改变方向，再次如论文所示。

# sql - PostgreSQL - GROUP BY 子句或用于聚合函数

> ID：10161696
> 
> 赞同：30
> 
> 时间：2012-04-15T11:36:27.033
> 
> 标签：sql, ruby-on-rails-3, postgresql, heroku

我在 SO 上找到了一些主题，但我仍然找不到适合我的查询的设置。

这是查询，在 localhost 上效果很好：

```
@cars = Car.find_by_sql('SELECT cars.*, COUNT(cars.id) AS counter 
                         FROM cars 
                         LEFT JOIN users ON cars.id=users.car_id 
                         GROUP BY cars.id ORDER BY counter DESC') 
```

但是在 Heroku 上给了我上面的错误 - **GROUP BY 子句或在聚合函数中使用**。

然后我在某处读到，我应该指定表中的所有列，所以我尝试了这个：

```
@cars = Car.find_by_sql('SELECT cars.id, cars.name, cars.created_at, 
                                cars.updated_at, COUNT(cars.id) AS counter 
                         FROM cars 
                         LEFT JOIN users ON cars.id=users.car_id 
                         GROUP BY (cars.id, cars.name, cars.created_at, cars.updated_at) 
                         ORDER BY counter DESC') 
```

但这不适用于本地主机，也不适用于 Heroku ......

查询的正确配置应该是什么？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-04-16T00:01:54.843

**如果**您`GROUP`在`JOIN`. _ 像这样：

```
SELECT id, name, created_at, updated_at, u.ct
FROM   cars c
LEFT   JOIN (
    SELECT car_id, count(*) AS ct
    FROM   users
    GROUP  BY 1
    ) u ON u.car_id  = c.id
ORDER  BY u.ct DESC; 
```

这样，您需要的连接操作要少得多。并且表的行`cars`不必首先通过加入多个用户来相乘，然后再分组为唯一。
只需对正确的表进行分组，这也使逻辑更简单。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2012-04-15T11:45:14.207

我认为您正在尝试在同一列上进行聚合和分组。这取决于你想要什么数据。以太这样做：

```
SELECT 
 cars.name, 
 cars.created_at, 
 cars.updated_at, 
 COUNT(cars.id) AS counter 
FROM cars 
LEFT JOIN users 
  ON cars.id=users.car_id 
GROUP BY cars.name, cars.created_at, cars.updated_at 
ORDER BY counter DESC 
```

或者你想数一数？然后像这样：

```
SELECT
 cars.id,
 cars.name, 
 cars.created_at, 
 cars.updated_at, 
 COUNT(*) AS counter 
FROM cars 
LEFT JOIN users 
  ON cars.id=users.car_id 
GROUP BY cars.id, cars.name, cars.created_at, cars.updated_at 
ORDER BY counter DESC 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-04-15T11:51:42.197

您可以`MAX()`在汽车栏上使用技巧。

```
@cars = Car.find_by_sql('
SELECT cars.id, MAX(cars.name) as name, MAX(cars.created_at) AS 
created_at, MAX(cars.updated_at) as updated_at, COUNT(cars.id) AS counter 
FROM cars LEFT JOIN users ON cars.id=users.car_id 
GROUP BY cars.id ORDER BY counter DESC') 
```

# php - 检查是否已使用 PHP 删除了 YouTube 视频？

> ID：10161698
> 
> 赞同：3
> 
> 时间：2012-04-15T11:36:42.097
> 
> 标签：php, youtube

> **可能重复：**
> [检查 Youtube 和 Vimeo 剪辑是否有效](https://stackoverflow.com/questions/1362345/check-if-youtube-and-vimeo-clips-are-valid)

我有一个网站链接到很多 YouTube 视频，但很多时候这些视频被用户或 YouTube 删除。这意味着我的网站上有很多死视频，而且有很多，手动检查它们将是一场噩梦。

所以我正在寻找一种方法来使用 PHP 检查 YouTube 视频是否仍然有效。我看到很多人问同样的问题，但我无法让任何已发布的解决方案发挥作用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-15T11:41:25.813

使用 youtube V3 API 检查视频是否可以访问。有关更多信息，请参阅以下文档

> [https://developers.google.com/youtube/v3/docs/videos/list](https://developers.google.com/youtube/v3/docs/videos/list)

基本上，使用您的 API 密钥发出 GET 请求

```
GET https://www.googleapis.com/youtube/v3/videos?part=id&id={VIDEO_ID}&key={YOUR_API_KEY} 
```

您将收到一个示例响应，例如：

> ```
> {
>  "kind": "youtube#videoListResponse",
>  "etag": "\"sZ5p5Mo8dPpfIzLYQBF8QIQJym0/N6KWrfNRyfPOarHfhvNS7j4jfxM\"",
>  "pageInfo": {
>   "totalResults": 0,
>   "resultsPerPage": 0
>  },
>  "items": []
> }* 
> ```

如果您得到一个空数组`items`作为响应，则无法访问该视频。

* * *

下面介绍了 API 的 V2，现在已弃用。（[https://developers.google.com/youtube/2.0/developers_guide_protocol_video_entries](https://developers.google.com/youtube/2.0/developers_guide_protocol_video_entries)）。

> 注意：YouTube 数据 API (v2) 已于 2014 年 3 月 4 日正式弃用。有关更多信息，请参阅我们的弃用政策。请使用 YouTube 数据 API (v3) 进行新的集成，并将仍然使用 v2 API 的应用程序也迁移到 v3 API。

向此 URL 发送请求，以验证视频是否存在

```
http://gdata.youtube.com/feeds/api/videos/<videoid> 
```

这是它的用法。

```
$headers = get_headers('http://gdata.youtube.com/feeds/api/videos/' . $videoId);
if (!strpos($headers[0], '200')) {
    echo "The YouTube video you entered does not exist";
    return false;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-15T11:42:51.947

您可以简单地检查返回值`http://gdata.youtube.com/feeds/api/videos/$id`

例如你回来

*   私人视频
*   无效的 ID
*   找不到视频

所以最简单的检查是：

```
if (file_get_contents('http://gdata.youtube.com/feeds/api/videos/'.$videoId) == 'Video not found') {
  echo 'Video deleted';
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-15T11:44:53.180

使用 youtube api，您可以检查 yt:state 属性： [https ://developers.google.com/youtube/2.0/reference#youtube%5Fdata%5Fapi%5Ftag%5Fyt%3Astate](https://developers.google.com/youtube/2.0/reference#youtube%5Fdata%5Fapi%5Ftag%5Fyt%3Astate)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-15T11:48:55.490

Youtube 返回 HTTP 状态代码 404 是视频不存在。 [例如，请参阅这个组成的 url](http://www.youtube.com/watch?v=IytNBmyWA1c)。

具体的错误信息有所不同，但重要的是返回了非 200 代码。

所以在 PHP 中使用 Curl 来获取 url，然后检查返回的状态码。您可以通过以下方式从 Curl 获取状态代码：

```
$http_status = curl_getinfo( $handle, CURLINFO_HTTP_CODE ); 
```

您可以在数据库中存储每个 url 的 last_checked 时间戳，然后每 N 分钟运行一次 cronjob 以检查少量 url，并在完成后更新时间戳。确保也将状态代码存储在数据库中。

然后，在显示 url 时，您可以在代码中处理您喜欢的非 200 状态代码。

# memory - 使用自定义 Lua 分配器计算内存使用量，但其结果与 collectgarbage('count') 不同

> ID：10161699
> 
> 赞同：4
> 
> 时间：2012-04-15T11:37:17.543
> 
> 标签：memory, garbage-collection, lua, allocator

我最近正在尝试跟踪我们项目中的 lua 内存使用情况，并且我遇到了使用 lua_Alloc 自定义分配器来完成此任务的想法。好吧，分配器代码看起来很简单，而且看起来工作正常。

但是很快，这个小函数就遇到了两个挑战：
1.它输出的结果与collectgarbage('count')给出的值有很大的不同；
2.假设当前内存使用量是M字节，那么我们输入一些nil引用并调用gc，内存使用量会大于M字节。例如：A 返回，B 返回，C 返回，...，collectgarbage()

好吧，我听说如果你正确使用 lua，就不会有内存泄漏，所以我认为我在计算内存使用量时做错了。请帮我弄清楚。提前致谢。

下面附上可编译的代码：

```
extern "C"
{
#include "lua.h"
#include <lauxlib.h>
#include <lualib.h>
};

#include <cstdio>
#include <string>
#include <cstdlib>

using namespace std;

struct Tracker 
{
    size_t m_usage;
}g_tracker;

void*
Allocator(void* ud, void* ptr, size_t osize, size_t nsize)
{
    Tracker* pTracker = (Tracker*)ud;
    void* pRet = NULL;
    if( nsize == 0 )
    {
        pTracker->m_usage -= osize;
        //printf("Free %d bytes; ", osize);
        free(ptr);
    }
    else
    {
        pTracker->m_usage -= osize;
        //printf("first Free %d bytes; ", osize);
        pTracker->m_usage += nsize;
        //printf("then alloc %d bytes; ", nsize);
        pRet = realloc(ptr, nsize);
    }

    //printf("current usage: %d bytes\n", pTracker->m_usage);
    return pRet;
}

int main()
{
    lua_State* L = lua_newstate(Allocator, &g_tracker );
    luaL_openlibs(L);

    char buf[4096];
    while(true)
    {
        fgets(buf, 4096, stdin);                        

        if( strlen(buf) > 1 && 0 != luaL_dostring(L, buf) )
        {
            const char* errmsg = lua_tostring(L, -1);
            printf("%s\n", errmsg);
        }

        printf("current usage: %d bytes \n", g_tracker.m_usage);
    }
} 
```

关于#2的输入序列：

```
press enter
current usage: 18867 bytes
a=nil; b=nil; c=nil;
current usage: 19311 bytes
collectgarbage()
current usage: 18900 bytes
d=nil; e=nil; f=nil;
current usage: 19345 bytes
collectgarbage()
current usage: 18900 bytes
collectgarbage()
current usage: 18900 bytes  
for a = 1, 1000, 1 do b = nil end; collectgarbage()
current usage: 19206 bytes
collectgarbage()
current usage: 18900 bytes
for i = 1, 1000, 1 do X = {}; for j = 1, 1000, 1 do X[j] = j end ; X = nil; collectgarbage() ; end
current usage: 19391 bytes
collectgarbage()
current usage: 18900 bytes 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T02:31:54.213

如 Lua 文档中所述，`collectgarbage('collect')`返回一个以*千字节*为单位的值。1KiB == 1024 字节。因此，当`collectgarbage`说您正在使用 19.4775390625KiB 时，它转换为 19945 字节。这完全等于您的分配器获得的许多值之一。

你的内存检查函数只会匹配 Lua 在某一时刻得到的结果：`collectgarbage`返回的那一刻。在它之前或之后发生的任何 Lua 分配/解除分配（例如调用以`print`显示值所必需的那些）都会使您的计数失效。

简而言之，当这种准确性不可能时，您期望字节准确性。至少，不是你那里的代码。

一般来说，你不应该担心它。

# wpf - 没有事件处理程序的 Wpf

> ID：10161701
> 
> 赞同：0
> 
> 时间：2012-04-15T11:37:23.233
> 
> 标签：wpf, events, handler

编辑：我误读了作业....没有事件处理程序，因为他不希望我们继续工作，我们只是将一组数据绑定到要显示的控件。

wpf中作业的小问题。我们正在为每部作品建立一个程序，我们现在正在绑定。用户在文本框中输入数据，然后它将两组数据显示到两个数据网格中。现在，显示的内容是硬编码的，而不是从数据库中提取的。我可以让它显示数据，我可以让它根据文本框输入显示正确的数据，但我们不允许使用事件处理程序。那么如何在没有事件处理程序的情况下读取按钮单击呢？

我可以绑定文本框和窗口的标题，因此它会随着文本框中的文本更改而更改，但我无法获取文本框中的内容。我可能忽略了书中的某些内容，但我看不出至少没有按钮的事件处理程序是怎么可能的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T14:23:17.603

另一种方法是将按钮绑定到命令，这才是真正替换事件的方法

```
 <Button Command="{Binding ViewModel.YourCommand}"

 <Button Command="{Binding ViewModel.Cmd}" CommandParameter="{Binding ViewModel.CmdParam}"/> 
```

在 ViewModel 中，您执行所有逻辑。虽然您可以将命令放在 YourView.xaml.cs 中，但这取决于您的 MVVM 设计（意味着如果您觉得该功能不属于 ViewModel）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T11:48:36.373

您可以将数据网格多重绑定到两件事：源数据和文本框。在转换器中，您可以分析文本框的内容并选择要显示的数据的正确部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T15:01:01.650

如果您不允许使用事件并且需要在界面中使用按钮，那么命令绝对是要走的路。

实际上，自 WPF 发布以来，命令是交互而非事件的首选解决方案。由于我主要使用 MVVM 进行开发，所以我不记得我上一次挂钩按钮事件是什么时候了。

此外，将按钮链接到交互的所有其他方式都是一种肮脏的黑客行为。

也许这是您的课程向前迈出的一步，但仍然值得一读：http: [//msdn.microsoft.com/en-gb/magazine/cc785480.aspx](http://msdn.microsoft.com/en-gb/magazine/cc785480.aspx)

# asp.net - 动态交换用户控件

> ID：10161702
> 
> 赞同：0
> 
> 时间：2012-04-15T11:37:24.980
> 
> 标签：asp.net, user-controls

这是一个[类似的问题](https://stackoverflow.com/questions/987680/dynamically-change-user-control-in-asp-net)，但我在实施那里显示的解决方案时遇到了麻烦。

就我而言，我有两个链接，**User Settings**，**Space Settings**和两个**UserControls**，即`UserSettings.ascx`, `SpaceSettings.ascx`。

*   当用户第一次访问该页面时，他会看到**用户设置**。
*   根据单击这两个链接中的哪一个，**PlaceHolder**将交换**UserControl**。

我所做的如下所示：

```
public partial class SiteSettings : RefreshDitectedPage {   

    protected void Page_Load(object sender, EventArgs e) {

    }

    protected override void OnInit(EventArgs e) {
        base.OnInit(e);
        string key = Session["Settings"] as String;
        System.Diagnostics.Debug.WriteLine(key);
        if (key == null) {
        Session["Settings"] = "User";           
        AddUserSettings();
        } else {
        if (key.Equals("User")) {
            AddUserSettings();
        } else {
            AddSpaceSettings();
        }
        }
    }

    protected void SettingsLink_OnCommand(object sender, CommandEventArgs commandEventArgs) {
        switch (commandEventArgs.CommandName) {
        case "User":
            Session["Settings"] = "User";           
            AddUserSettings();
            break;

        case "Space":
            Session["Settings"] = "Space";
            AddSpaceSettings();
            break;
        }
    }

    private void AddUserSettings() {
        AddSettings(LoadControl("~/UserControls/UserSettings.ascx") as UserSettings);
    }

    private void AddSpaceSettings() {
        AddSettings(LoadControl("~/UserControls/SpaceSettings.ascx") as SpaceSettings);
    }

    private void AddSettings(UserControl control) {
        SettingsPlaceholder.Controls.Clear();
        SettingsPlaceholder.Controls.Add(control);
    }

    /*protected void Page_Unload(object sender, EventArgs e) {
        Session["Settings"] = null;
        System.Diagnostics.Debug.WriteLine("Unload called");
    }*/

    } 
```

这是行不通的。结果是：

*   第一次访问时，Session["Settings"] 为空，并且**UserControl** `UserSettings.ascx`已加载（右），并且来自`Page_Load`方法的日志`UserSettings.ascx.cs`已显示在输出窗口（右）中。
*   单击**空间设置**链接后，**用户控件** `SpaceSettings.ascx`已加载（右），但在输出窗口中，它正在打印*用户*（错误）`Page_Load`以及两者方法中的日志`UserSettings.ascx.cs`并`SpaceSettings.ascx.cs`已显示（`UserSettings.ascx.cs`的日志错误）。
*   单击**用户设置**链接后，**用户控件** `UserSettings.ascx`已加载（右），但在输出窗口中，它正在打印*空间*（错误）`Page_Load`以及两者方法中的日志`UserSettings.ascx.cs`并`SpaceSettings.ascx.cs`已显示（`SpaceSettings.ascx.cs`的日志错误）。
*   我已经为每个**UserControls添加了两个****Button**，例如，当单击 Button 时，它不会第一次在支持类中触发事件，但如果第二次单击它就会触发。第一次是记录*用户*（错误），第二次是*空间*（正确），然后事件将被触发。**`SpaceSettings.ascx`**
*****   当我第二次访问该页面时，我看到了最后加载的控件。既然`Session["Settings"]`不为空那么。我试图`Page_Unload`在方法中和`OnUnload`方法中将此值设置为空，但它们都不起作用。`Page_Unload`正在破坏系统，因为它每次都被调用而`PostBack`根本`OnUnload`没有被调用。****

 ****我尝试使用而`Request["Settings"]`不是`Session["Settings"]`，但是给了我编译时错误：`Request["Settings"] = "User"``Request["Settings"] = "Space"`

```
Property or indexer 'System.Web.HttpRequest.this[string]' cannot be assigned to 
```

我该如何解决这个问题？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T14:47:58.273

我尝试了一种不同的方法来解决我的要求，并且解决了**UserControl**的交换，但后来我遇到了**UserControls**的**按钮的****EventHandlers**不是第一次被触发，但是如果它被点击两次就会被触发。

 ****我在 ASP.NET 论坛上问过这个问题。但是没有人回答我的问题。但我一直在努力寻找解决方案，最后我做到了。问题出在身份证上。我已经在那个论坛上发布了解决方案。

这是[链接](http://forums.asp.net/t/1793056.aspx/1?Dynamically%20Swapped%20UserControl%20EventListeners%20of%20Buttons%20of%20UserControls%20are%20not%20firing)。这可能对未来的用户有用。********

# vba - 在 Microsoft Word 2007 文档中自动执行文本替换逻辑？

> ID：10161703
> 
> 赞同：0
> 
> 时间：2012-04-15T11:37:26.010
> 
> 标签：vba, ms-word, ms-office

我有一封用 MS Word 2007 写的信，我想修改并发送给几个不同的人。我需要通过更改几个单词、句子和段落来个性化每个字母，并满足一些逻辑（即句子构建逻辑和“如果这个词存在，那么打印那个”之类的东西），所以我想创建一个应用程序（Word 加载项、VBA 宏、模板，我假设的其他东西？），提示用户在文档中替换这些单词、句子、段落和其他选项。除了使用“查找和替换”（我必须为每个字母做几十次，而且我认为这不能满足更复杂的逻辑）之外，最快和最简单的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-25T14:42:30.683

所有这些选项都可以在 mailmerge 中使用，而无需编写任何代码。现在相信我！:)

# tomcat - 配置数据源 - Struts 1.3.8

> ID：10161710
> 
> 赞同：1
> 
> 时间：2012-04-15T11:38:57.483
> 
> 标签：tomcat, struts, datasource

如何在 struyts 1.3.8 的 struts-config.xml 中配置数据源？

我的示例数据源：

```
<data-sources>
 <data-source type="org.apache.commons.dbcp.BasicDataSource" key="dbSource">
            <set-property property="driverClassName" value="com.mysql.jdbc.Driver" />
            <set-property property="url" value="jdbc:mysql://localhost:3306/bookstore" />
            <set-property property="username" value="root" />
            <set-property property="password" value="sf~007tech" />
  </data-source>
  </data-sources> 
```

代码：

```
dataSource = (DataSource)servlet.getServletContext().getAttribute("dbSource"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T16:21:15.407

似乎 in 中的`data-sources`元素在`struts-config.xml`struts 1.3 中已被弃用和删除，如[升级说明](http://wiki.apache.org/struts/StrutsUpgradeNotes12to13)中所述。我认为最好在 Web 容器中配置数据源并通过 JNDI 进行查找。说明可以在[tomcat wiki](http://wiki.apache.org/tomcat/UsingDataSources)中找到。

# php - 根据第一个列表的选定值填充下拉列表

> ID：10161712
> 
> 赞同：0
> 
> 时间：2012-04-15T11:39:19.280
> 
> 标签：php, javascript

我有 2 个列表框，第一个用于国家，另一个用于城市，当用户选择一个国家时，它应该根据国家填充城市

县的数据库是( CountryID (pk), Code (pk), Name) city(CountryCode(pk),Name)

我创建了名为 reload 的 java 脚本函数，该函数加载页面 onChange 其工作良好，但城市列表中的问题没有填充国家项目..它仍然是空的..这是我的代码。我只是发布与问题相关的代码，它的页面太长了。此页面代码

dd-check.php

```
<?php
$cat = $_GET['Country'];
$subcat = $_POST['City'];
?> 
```

创建帐户.php

```
<script language=JavaScript>
function reload(form)
{
  var val = form.Country.options[form.Country.options.selectedIndex].value; 
  self.location = 'Create_Account.php?country=' + val ;
}
</script>

<form id="form2" method="post"  enctype="multipart/form-data" action="dd-check.php">
<?php
$Con= mysql_connect("localhost","root",""); 

if(!$Con) 
{ 
  die('Could not connect'.mysql_error());
}

if(!mysql_selectdb("rlounge",$Con))
{
  die(mysql_error());
}

@$cat = $_GET['Country'];

if(strlen($cat) > 0 and !is_numeric($cat))
{  
  echo "Data Error";
  exit;
}

$quer2 = "SELECT *  FROM country";
$result = mysql_query($quer2);
if(isset($cat) and strlen($cat) > 0)
{
  $quer = mysql_query(" SELECT city.`Name` ,  `CountryCode` 
                        FROM  `city` ,  `country` 
                        WHERE  `CountryCode` =  $cat
                        AND  `Code` =  `CountryCode` "); 
}
else
{
  $quer = mysql_query(" SELECT City.name
                      FROM  `city` ,  `country` 
                      WHERE  `Code` =  `CountryCode`"); 
} 
//$cat=$_GET['Country'];
//$subcat=$_POST['City'];
echo "<select name='Country' onchange=\"reload(this.form)\"><option value=''>Select     one</option>";
while($noticia2 = mysql_fetch_array($result)) 
{ 
  if($noticia2['Code'] == $cat)
  {
    echo "<option selected value='$noticia2[Code]'>$noticia2[Name]</option>"."<BR>";
  }
  else
  {
    echo "<option value='$noticia2[Code]'>$noticia2[Name]</option>";
  }
}
echo "</select>";
echo "<select name='City'><option value=''>Select one</option>";
while($noticia = mysql_fetch_array($quer)) 
{ 
  echo  "<option value='$noticia[CountryCode]'>$noticia[Name]</option>";
}
echo "</select>"; 
?>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T11:49:06.877

像这样创建一个 html 文件。

```
<html>
<head>
<script type="text/javascript">
function getcities(str)
{
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("result").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","getcities.php?q="+str,true);
xmlhttp.send();
}
</script>
</head>
<body>

<select name='Countries' onchange='getcities(this)'>
</select>
<p> <span id="result"></span></p>

</body>
</html> 
```

然后像这样编写php文件

```
<?php
$country=$_GET['q'];
get cities from database
while(cities)
{
    echo "<option>".$city."</option>";
}
?> 
```

在更改字段 country 时，它会使用该国家/地区名称调用 getcities.php....getcities.php 在 span 元素“result”中输出城市。这是您不需要重新加载页面的 ajax 方式。

# java - 使通过 SOAP 发送的对象的方法可见

> ID：10161719
> 
> 赞同：1
> 
> 时间：2012-04-15T11:40:07.263
> 
> 标签：java, soap, netbeans, netbeans-6.9, netbeans-7

我正在使用 Netbeans 创建一个 Web 应用程序项目。当我创建新的 Web 服务（代码优先 WS）时，IDE 会添加 METRO2.0 库。SOAP Web 服务很好地部署在我的 apache Tomcat 6 中。但是，当我发送复杂类型时，客户端无法访问客户端中发送对象的方法。假设我有一个名为**Person**的类和一个操作：

```
@WebMethod(operationName = "getOnePerson")
    public Person getOnePerson() {

        return new Person("MyName", "MySurname", 24);
    } 
```

和 Person 类：

```
public class Person {

    private String name, surname;
    private int age;

    public Person() {

    }
    public Person(String name, String surname, int age) {
        this.name = name;
        this.surname = surname;
        this.age = age;
    }

    public int getAge() {
        return age;
    }

    public String getName() {
        return name;
    }

    public String getSurname() {
        return surname;
    }
} 
```

那么如何让客户知道**Person**方法呢？谢谢编辑：我试图通过添加 Pesron 的属性来更新我的 XSD 文件：

```
<xs:complexType name="person">
        <xs:attribute name="name" type="xs:string" />
        <xs:attribute name="surname" type="xs:string" />
        <xs:attribute name="age" type="xs:int" />
    </xs:complexType> 
```

通过添加这部分，客户端知道了 Person 类的 getter 和 setter，但是当尝试运行程序时，所有的 getter 都返回 null（客户端）：

```
public class Main {

    public static void main(String[] args) {

        try {
            Person p = getOnePerson();
            System.out.println(p);
            System.out.println(p.getSurname());
            System.out.println(p.getName());
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    private static Person getOnePerson() {
        com.company.ws.BeanWebService_Service service = new com.company.ws.BeanWebService_Service();
        com.company.ws.BeanWebService port = service.getBeanWebServicePort();
        return port.getOnePerson();
    }
} 
```

返回： *com.company.ws.Person@d75415 null null* 那么你能告诉我为什么客户端不知道类属性的不同值吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T12:01:44.267

由于 JAX-WS 使用 JAXB 来编组/解组对象，我建议：

*   为 Person 定义一个 XSD
*   生成此 XSD 的 JAXB 类
*   使用生成的 Person 类作为 Web 服务的返回类型

如果您使用的是 Maven（强烈推荐），那么您可以使用以下插件从 XSD 生成 JAXB 类：

```
 <plugin>
            <groupId>org.jvnet.jaxb2.maven2</groupId>
            <artifactId>maven-jaxb2-plugin</artifactId>
            <version>0.8.1</version>
            <executions>
                <execution>
                    <id>generate</id>
                    <goals>
                        <goal>generate</goal>
                    </goals>
                    <configuration>
                        <generatePackage>com.yourcompany.somecomponent.somepackage.jaxb</generatePackage>
                    </configuration>
                </execution>
            </executions>
        </plugin> 
```

预期的 XSD 和 xjb（JAXB 自定义文件）位置：src/main/resources

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-06T23:02:31.070

我发现并解决了问题：

```
import javax.xml.bind.annotation.XmlAccessType;
import javax.xml.bind.annotation.XmlAccessorType;
import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlType;

@XmlAccessorType(XmlAccessType.FIELD)
@XmlType (name = "Person", propOrder = {"name","surname", "age"})
public class Person {
    @XmlElement(name="name",required = true)
    private String name;

    @XmlElement(name="surname",required = true)
    private String surname;

    @XmlElement(name="age",required = true)
    private int age;

//GETTER & SETTER
} 
```

谢谢！

# c - recv 函数不会阻塞并接收一些垃圾值

> ID：10161720
> 
> 赞同：1
> 
> 时间：2012-04-15T11:40:09.887
> 
> 标签：c, sockets, recv

**情况：**我正在进行客户端-服务器聊天。
最初它工作正常，然后我介绍了一个登录和注册系统。
**问题：** 我在寄存器中引入了两个功能：

1.  如果用户能够注册成功，则将其提升为登录。
    *问题在于*：在服务器代码中，成功注册新用户后，我正在调用 login_check() 函数。此函数首先阻止从客户端接收用户名。`But here recv get some garbage data which I haven't send from the client.`为了摆脱这种情况，我在其中放置了一个额外的 recv 来收集这些垃圾数据并忽略它。现在我的这部分代码工作正常，但是**`Why I need to put an extra recv there?`**

2.  案例：在注册过程中，用户输入了一个已经存在的用户名。如果发生这种情况，我将向客户端发送用户名已经存在的消息（有点信号）。收到此消息后，客户端会要求用户再次注册或退出。然后从客户端我将用户的选择发送回服务器。`But there in server my recv got some garbage data not the choice I am sending and also it doesn't block(i.e server recv reading garbage data before user enter the choice at client). I have also tried to put some extra recv functions to get rid of garbage data but it doesn't work.` **`So, why recv is not blocking here?`**

**源代码：**我在这里提供服务器和客户端的完整源代码。但我的问题要查看的相关功能是服务器：thread_function、rgstr、login_check 和客户端：registerYourself 和 login

**`SERVER CODE`**

```
#include <pthread.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <netdb.h>
#include <error.h>
#include<fcntl.h>

#define PORT "1618" //port we are listening on is a divine port

struct clients{
char name[50];
char password[20];
}client;

//get sockaddr , IPv4 or IPv6:
void *get_in_addr(struct sockaddr *sa)
{
    if (sa->sa_family == AF_INET){
        return &(((struct sockaddr_in*)sa)->sin_addr);
    }
    return &(((struct sockaddr_in6*)sa)->sin6_addr);
}

//need to add one more string argument to show which part is calling this func
void recv_err(int nbytes)
{
    //got an error or connection is closed by client
    if(nbytes == 0) 
    {
        //connection closed
        printf("selectserver: socket hung up\n");
    } 
    else 
    {
        perror("recv");
    }
}

int login_check(int fd)
{
    char data[50],choice[2],*name, *pass;
    int nbytes,ret_status,limit = 50;
    ///////////////////////////////////////   Here Problem        /////////////////////////////////////
    recv(fd,client.name,sizeof(client.name),0);//extra recv as mentioned in 1st doubt
    if(( nbytes = recv(fd,client.name,sizeof(client.name),0)) <= 0) //receiving username
    {
        recv_err(nbytes);
        return 0;
    }
    if(( nbytes = recv(fd,client.password,sizeof(client.password),0)) <= 0) //receiving password
    {
        recv_err(nbytes);
        return 0;
    }
    //opening file containing login info
    FILE * record = fopen("records.txt","r+");
    if(record == NULL)
    {
        //need to write errno to log
        return -1;
    }
    while(fgets(data,100,record)!=NULL)
    {//stored in file in one login info per lineas : username,password
        name = strtok(data,",");
        pass = strtok(NULL,",");
        pass = strtok(pass,"\n");
        if((strcmp(client.name,data)==0) && (strcmp(client.password,pass)==0))
        {
            if(send(fd,"1",2,0) == -1)//signaling client that everythin is fine
            {
                recv_err(-1);
                return 0;
            }
            return 1;
        }
    }
            if(send(fd,"0",2,0) == -1)//if username already exists
            {
                recv_err(-1);
                return 0;
            }
            //waiting for user chooice to enter pass again or not
            if((nbytes = recv(fd,choice,sizeof(choice),0)) <= 0)
            {
                recv_err(-1);
                return 0;
            }
            if(!strcmp(choice,"1"))
            {
                ret_status = login_check(fd);

                if(ret_status == 1)
                    return 1;
                else if(ret_status == 0)
                    return 0;
                else if(ret_status == -1)
                    return -1;      
            }
            else if(!strcmp(choice,"0"))
            {
                return 0;       
            }

    return 0;   

}

int rgstr(int fd)
{
    int nbytes,record_n,ret_status,limit = 50,passed =1;
    char data[50],choice[2], *name, *toBeWrit;

    if((nbytes = recv(fd,client.name,sizeof(client.name),0)) <= 0)//receiving username
    {
        recv_err(nbytes);
        return 0;
    }
    if((nbytes = recv(fd,client.password,sizeof(client.password),0)) <= 0) // receiving password
    {
        recv_err(nbytes);
        return 0;
    }
        //structing data to write in the file
    toBeWrit = (char *)malloc(strlen(client.name)+strlen(client.password)+3);
    strcpy(toBeWrit,client.name);
    strcat(toBeWrit,",");
    strcat(toBeWrit,client.password);
    strcat(toBeWrit,"\n");

    FILE * record = fopen("records.txt","r+");
    if(record == NULL)
    {
        //need to write errno to log
        return -1;
    }
    //checking if username already exists
    while(fgets(data,100,record)!=NULL)
    {
        name = strtok(data,",");
        if(strcmp(client.name,data)==0)
        {
            passed = 0;
            break;
        }
    }   
            //if everything work fine
    if(passed == 1)
    {
        if(send(fd,"1",2,0) == -1)//singaling client
        {
            recv_err(-1);
            return 0;
        }
        fclose(record);

        if((record_n = open("records.txt",O_WRONLY|O_APPEND)) == -1)
        {
            recv_err(-1);
            return 0;
        }
        if((nbytes =write(record_n,toBeWrit,strlen(toBeWrit))) <= 0)
        {
            recv_err(nbytes);
            return 0;
        }

        return 1;
    }
    else//if username already exists
    {
        if(send(fd,"0",2,0) == -1) //singaling client to again ask to user whether to rgstr agian or not
        {
            recv_err(-1);
            return 0;
        }
/////////////////////////////////////            Here the problem              ///////////////////////////////

        //waiting for user chooice to enter pass again or not
        if((nbytes = recv(fd,choice,sizeof(choice),0)) <= 0) // this recv getting garbage data before user select its choice
        {
            recv_err(nbytes);
            return 0;
        }printf("3 %s %d\n",choice,nbytes);

        printf("cc\n");
        if(!strcmp(choice,"1"))
        {
            ret_status = rgstr(fd);

            if(ret_status == 1)
                return 1;
            else if(ret_status == 0)
                return 0;
            else if(ret_status == -1)
                return -1;      
        }
        else if(!strcmp(choice,"0"))
        {
            return 0;       
        }
    }
    return 0;
}

void* thread_func(void* arg)// function that handles each connection
{
    int fd=(int)arg, login_status=0, rgstr_status=0, record_n;
    char choice[2];

    //opening record.txt- creating file
    record_n = open("records.txt",O_CREAT,0644);    
    close(record_n);

    printf("Set to receive the choice:\n");
    recv(fd,choice,sizeof(choice),0);
    printf("Received choice %s\n",choice);      
    if(!strcmp(choice,"1"))
    {
        rgstr_status = rgstr(fd);
        if(rgstr_status == 1)
        {
            printf("New User Registered\n");
            strcpy(choice,"2");
        }
        else if(rgstr_status == 0)
        {
            printf("rUsr close the connection\n");
            close(fd);
            return ((void*)0);
        }
        else if(rgstr_status == -1)
        {
            printf("There is some problem..\n");
            close(fd);
            return ((void*)0);
        }
    }
    if(!strcmp(choice,"2"))
    {
        login_status = login_check(fd);

        if(login_status == 1)
        {
            printf("HI %s\n",client.name);
            while(1);
        }
        else if(login_status == 0)
        {
            printf("lUsr close the connection\n");
            close(fd);
            return ((void*)0);
        }
        else if(login_status == -1)
        {
            printf("There is some problem..\n");
            close(fd);
            return ((void*)0);
        }
    }

    printf("Done with user\n");
    return ((void*)0);
}

int main(void)
{
//  fd_set updated_fds; //main file descriptor list which is updated continously on any change
//  fd_set read_fds; //temp file descriptor list for select() which always asiigned to updated_fds before call to select
//  int fdmax; //The maximum filedescriptor for select

    int listener_fd; //listening the socket descriptor which is listening for new calls
    int new_fd;    //newly accept()ed file descriptor , for each connection

    struct sockaddr_storage clientaddr; // client address is stored in this with a typecasting dependent on family of connection (IPv4 or IPv6)
    socklen_t addrlen;  //length of clientaddr for inet_ntoi

    char buf[256];  //buffer for client - reading buffer
    int nbytes;//return value of recv function

    char remoteIP[INET6_ADDRSTRLEN]; //store the ip of the remote client. Its size is defined as INET6_ADDRSTRLEN because now it can store both IP - IPv4 and IPv6

    int yes=1; // integer passed to setsockopt
    int i, j, rv;

    struct addrinfo hints, *link_struc, *struc_iter;// to use with getaddrinfo

    int err; // pthread_create error
    pthread_t ntid;
    void *a;

//  FD_ZERO(&updated_fds); //clear the updated_fds and temp sets
//  FD_ZERO(&read_fds);

    //get us a socket and bind it
    memset(&hints, 0, sizeof hints);

    hints.ai_family = AF_UNSPEC;
    hints.ai_socktype = SOCK_STREAM;
    hints.ai_flags = AI_PASSIVE;

    if((rv = getaddrinfo(NULL, PORT, &hints, &link_struc)) != 0) {
        fprintf(stderr, "selectserver : %s\n",gai_strerror(rv));
        exit(1);
    }

    for(struc_iter = link_struc;struc_iter != NULL ; struc_iter = struc_iter->ai_next) {
        listener_fd = socket(struc_iter->ai_family, struc_iter->ai_socktype, struc_iter->ai_protocol);
        if(listener_fd < 0){
            continue;
        }

        //lose the pesky "address already in use " error message
        setsockopt(listener_fd, SOL_SOCKET, SO_REUSEADDR, &yes, sizeof(int));

        if(bind(listener_fd, struc_iter->ai_addr, struc_iter->ai_addrlen) < 0) {
            close(listener_fd);
            continue;
        }

        break;
    }

    //if we got here, it means we didnot get bound
    if(struc_iter == NULL){
        fprintf(stderr, "selectserver: failed to bind\n");
        exit(2);
    }

    freeaddrinfo(link_struc); // all  done with this

    //listen
    if(listen(listener_fd, 10) == -1){ //make that socket active to listen with max connection queue - 10
        perror("listen");
        exit(3);
    }

    //add the listener_fd to the updated_fds set
//  FD_SET(listener_fd, &updated_fds);

    //keep track of the bigge file descriptor
//  fdmax = listener_fd; // so far it is this one

    //main loop
    for(;;){
        addrlen = sizeof clientaddr;
        new_fd = accept(listener_fd, (struct sockaddr *)&clientaddr, &addrlen);

        if(new_fd == -1){
            perror("accept");
            continue;
        }

        inet_ntop(clientaddr.ss_family, get_in_addr((struct sockaddr *)&clientaddr), remoteIP, INET6_ADDRSTRLEN);
        printf("server : got connection from %s\n", remoteIP);

        a=(void *)new_fd;

        err = pthread_create(&ntid, NULL, thread_func,a );
        if(err != 0)
        {
            printf("can't create thread: %s\n", strerror(err));
        }

        err = pthread_detach(ntid);
        if(err != 0)
        {
            printf("can't detaching thread: %s\n", strerror(err));
        }
    }//END for(;;)-- an you thought it would never end!

    return 0;
} 
```

**`Client Code`**

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <errno.h>
#include <string.h>
#include <netdb.h>
#include <sys/types.h>
#include <netinet/in.h>
#include <sys/socket.h>
#include <arpa/inet.h>

#define PORT "1618" //the port client will be connecting to
#define MAXDATASIZE 100 // max number of bytes we can get at once

static const int BUFFER_SIZE = 16*1024;
//get sockaddr ,IPv4 or IPv6:

void *get_in_addr(struct sockaddr *sa)
{
    if(sa->sa_family ==AF_INET) {
        return &(((struct sockaddr_in*)sa)->sin_addr);
    }

    return &(((struct sockaddr_in6*)sa)->sin6_addr);
}
void registerYourself(int sockfd)
{
    char username[50], password[50];
    printf("You have chosen to register yourself\n");
    printf("Please enter a username and password\n");
    printf("Username:");
    scanf("%s",username);
    //printf("You entered %s\n",username);
    send(sockfd,username,sizeof(username),0); // sending username
    printf("\nPassword:");
    scanf("%s",password);
    //printf("-- %s\n",password);
    send(sockfd,password,sizeof(password),0);       //sending password
}

void login(int sockfd)
{
    char username[50],password[50];
    printf("You have chosen to login yourself\n");
    printf("Please enter a username and password\n");
    printf("Username:");
    scanf("%s",username);
//  printf("-- %s\n",username);
    send(sockfd,username,sizeof(username),0);//send username
    printf("\nPassword:");
    scanf("%s",password);
    //printf("-- %s\n",password);
    send(sockfd,password,sizeof(password),0);//send password
}

int main(int argc, char *argv[])
{
    char fname[50], s[INET6_ADDRSTRLEN], buf[MAXDATASIZE], username[50], password[50], registerStatus[2], login_status[2];
    int sockfd, numbytes,fp,i,rv, choice;

    struct addrinfo hints, *servinfo, *p;

    if(argc != 2) 
        {
            fprintf(stderr,"usage: client hostname\n");
            exit(1);
        }

        memset(&hints, 0, sizeof hints);
        hints.ai_family = AF_UNSPEC;
        hints.ai_socktype = SOCK_STREAM;

        if((rv = getaddrinfo(argv[1], PORT, &hints, &servinfo)) != 0) 
        {
            fprintf(stderr,"getaddrinfo: %s\n",gai_strerror(rv));
            return 1;
        }

        //lopp through all the results and connect to the first we can
        for(p = servinfo; p != NULL; p = p->ai_next) 
        {
            if((sockfd = socket(p->ai_family, p->ai_socktype, p->ai_protocol)) == -1){
                perror("client: socket");
                continue;
            }

            if(connect(sockfd, p->ai_addr, p->ai_addrlen) == -1)
            {
                close(sockfd);
                perror("client: connect");
                continue;
            }
            break;
        }

        if(p ==NULL) 
        {
            fprintf(stderr,"client: failed to connect\n");
            return 2;
        }

        inet_ntop(p->ai_family, get_in_addr((struct sockaddr *)p->ai_addr), s, sizeof s);
        printf("client : connecting to %s\n", s);

        freeaddrinfo(servinfo); // all done with this structure

        printf("\n----------------Menu-------------------------\n1.Register\n2.Log in\n");
        scanf("%d",&i);

        switch(i)
        {
            case 1: 
                send(sockfd,"1", 2, 0);//sending server that user want to register
                registerYourself(sockfd);

                recv(sockfd,registerStatus,sizeof(registerStatus),0);//receiving from server that register is successful or not
                if(strcmp(registerStatus,"1")==0) //If register successful then promoting for log-in
                {
                    login(sockfd);
                    break;
                }
                else if(strcmp(registerStatus,"0")==0)// Asking user what to do
                {
                    printf("Username already taken...Please try again with other username...\nPress:\t 1 to try again\n\t2 to quit");
                    scanf("%d",&choice);
                    switch(choice)
                    {
                        case 1:
                            send(sockfd,"1", 2, 0);
                            login(sockfd);
                            break;
                        case 2:
                            send(sockfd,"0",2,0);
                            return;
                    }           
                }

            case 2:
                send(sockfd,"2", 2, 0); //sending server that user want to login
                login(sockfd);
                recv(sockfd,login_status,sizeof(login_status),0); // //receiving from server that login is successful or not
                if(strcmp(login_status,"1")==0)
                {
                    printf("login successfully\n");
                    while(1);// doing other job here
                }
                else if(strcmp(login_status,"0")==0)
                {
                    printf("Wrong Username And/Or Password\nPress:\n__1)__To Enter Again  |  __2)__To Quit");
                    scanf("%d",&choice);
                    switch(choice)
                    {
                        case 1:
                            send(sockfd,"1", 2, 0);// sending that user want to login again
                            login(sockfd);
                            break;
                        case 2:
                            send(sockfd,"0",2,0);// sending that user want to stop
                            return;
                    }
                }
                break;//case 2 ends
        }//switch ends

        while(1); //doing other job
        close(sockfd);

        return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-15T14:31:13.350

TCP 是一个“流”协议，没有消息边界的概念，所以当你有这样的代码时：

```
void login(int sockfd)
{
    char username[50],password[50];
    ...
    scanf("%s",username);
    send(sockfd,username,sizeof(username),0);//send username
    ...
    scanf("%s",password);
    send(sockfd,password,sizeof(password),0);//send password
} 
```

您尝试发送 50 个字节两次，但没有指示用户名在哪里结束，密码从哪里开始并导致`recv`以后出现问题。

`send`仔细 阅读文档。`send`返回成功发送的字节数，可以小于 50。在简单的测试中，这可能有效，但在高网络带宽期间`send`可以并且将发送少于请求的字节数。如果没有成功传输，您有责任检查返回值并发送其余数据。

另一个问题是你发送的是整个缓冲区`username`，`password`所以如果用户输入“Mark”和“123”作为用户名和密码，你仍然会发送 100 个字节。

在服务器端，您的缓冲区大小不同：

```
struct clients{
char name[50];
char password[20];
}client; 
```

所以当读取数据时：

```
recv(fd,client.name,sizeof(client.name),0);//extra recv as mentioned in 1st doubt
...
if(( nbytes = recv(fd,client.password,sizeof(client.password),0)) <= 0) //receiving password 
```

50 个字节，然后尝试读取 20 个字节，留下 30 个字节未读......调用时额外数据的来源`recv`。

请注意，它`recv`也没有消息边界的概念，并且可以返回少于请求的数据量，并且它可以包含一个的最后一部分`send`和另一个的第一部分。你有责任定义一个缓冲数据的协议，直到你有一个完整的消息。

由于您似乎总是发送以 nul 结尾的字符串，因此一种算法是：

1.  维护一个 recv 缓冲区和当前长度计数。
2.  当需要数据时，检查 recv 缓冲区中是否有空终止字节。
3.  如果没有空字节，则发出一个大`recv`请求，比如 4K 字节，否则转到 #5。
4.  将接收到的数据添加到 recv 缓冲区并返回#3。
5.  从缓冲区中删除最多为 nul 的数据，将任何剩余的数据留在缓冲区中以满足下一个请求。

还要确保只发送字符串和空终止字节，而不是整个缓冲区，并检查 send 的返回值。如果您发送 100 个字节并`send`返回 50，`send`则使用指向剩余 50 个字节的指针再次调用...重复直到发送所有数据。

# jquery - jQuery submit() 只发生一次，应该发生更多

> ID：10161721
> 
> 赞同：0
> 
> 时间：2012-04-15T11:40:22.903
> 
> 标签：jquery, ruby-on-rails

我想在我的帖子中添加评论功能。我可以添加一次评论，无需重新加载即可渲染部分，但是当我添加另一个评论时，它只渲染部分（没有别的）这是我正在调用的创建方法：

```
 def create
    @comment = Comment.new(params[:comment])
    @snippet = @comment.snippet
    @comment.save
    @comment = Comment.new
    render :partial => "snippets/comment"
  end 
```

Javascript：

```
$(document).ready( function(){
    save_comment();
});
function save_comment() {
    $("#new_comment").submit(function (e) {
        e.preventDefault();
        var url = "/comments/create";
        var post_data = $('#new_comment').serialize();
        logger(post_data);
        post_data = add_auth_token(post_data); // add authenticity token to post for forgery protection (works fine)
        $.post(url,
            post_data,
            function(data) {
                $("#comments_container").html(data);
                $("#comment_value").val("");
            });
    });
} 
```

和形式

```
<%= form_for(@comment) do |f| %>
  <%= f.text_field :value %>
  <%= f.hidden_field :user_id, :value => current_user.id %>
  <%= f.hidden_field :snippet_id, :value => @snippet.id %>
  <div class="actions">
    <%= f.submit "Post" %>
  </div>
<% end %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T11:51:34.833

由于 html 是在事件侦听器代码执行后添加的，因此无法为`submit`稍后在 DOM 中添加的元素附加事件处理程序。您需要使用[**on**](http://api.jquery.com/on/) api 来绑定事件，它将附加一个委托事件处理程序，该处理程序可以处理来自后代元素的事件，这些事件稍后会添加到文档中。

在您的情况下，您需要将代码更改为：

```
$(document).ready( function(){
    save_comment();
});
function save_comment() {
    $(document).on("submit","#new_comment",function (e) {
        e.preventDefault();
        var url = "/comments/create";
        var post_data = $('#new_comment').serialize();
        logger(post_data);
        post_data = add_auth_token(post_data); // add authenticity token to post for forgery protection (works fine)
        $.post(url,
            post_data,
            function(data) {
                $("#comments_container").html(data);
                $("#comment_value").val("");
            });
    });
} 
```

# c# - MVC3中的确认密码问题

> ID：10161725
> 
> 赞同：1
> 
> 时间：2012-04-15T11:41:30.377
> 
> 标签：c#, .net, asp.net-mvc-3

我使用以下模型来控制用户输入并注册他。但是，如果我输入相同的密码并按下按钮**，则会出现有关确认密码错误的消息。**

我确信该模型是正确的，因为它可以在其他页面中使用。在这种情况下， **RegisterModelSecond**是**EventFrontEndViewModel**的成员。

所以当我评论`[Compare("RegisterModel.Password", ErrorMessage = "The password and confirmation password do not match.")]`它有效但我不需要确认！

任何线索如何解决它？

```
public class EventFrontEndViewModel
    {
        public Page CurrentPage { set; get; }

        public List<Event> Events { set; get; }

        public List<Event> SubscribedEvents { set; get; }

        public RegisterModelSecond RegisterModel { set; get; }

        public EventFrontEndViewModel()
        {
            CurrentPage = new Page();
            Events = new List<Event>();
            RegisterModel = new RegisterModelSecond();
            SubscribedEvents = new List<Event>();
        }
    } 
```

注册模型

```
public class RegisterModelSecond
    {
        [Required]
        [Display(Name = "User name")]
        public string UserName { get; set; }

        [Required]
        [DataType(DataType.EmailAddress)]
        [Display(Name = "Email address")]
        public string Email { get; set; }

        [Required]
        [StringLength(100, ErrorMessage = "The {0} must be at least {2} characters long.", MinimumLength = 6)]
        [DataType(DataType.Password)]
        [Display(Name = "Password")]
        public string Password { get; set; }

        [Required]
        [DataType(DataType.Password)]
        [StringLength(100, ErrorMessage = "The {0} must be at least {2} characters long.", MinimumLength = 6)]
        [Display(Name = "Confirm password")]
        [Compare("Password", ErrorMessage = "The password and confirmation password do not match.")]
        public string ConfirmPassword { get; set; }
    } 
```

和 HTML

```
<div class="editor-label">
                                        @Html.LabelFor(m => m.RegisterModel.Password)
                                    </div>
                                    <div class="editor-field">
                                        @Html.PasswordFor(m => m.RegisterModel.Password)
                                        @Html.ValidationMessageFor(m => m.RegisterModel.Password)
                                    </div>
                                    <div class="clear">
                                    </div>
                                    <div class="editor-label">
                                        @Html.LabelFor(m => m.RegisterModel.ConfirmPassword)
                                    </div>
                                    <div class="editor-field">
                                        @Html.PasswordFor(m => m.RegisterModel.ConfirmPassword)
                                        @Html.ValidationMessageFor(m => m.RegisterModel.ConfirmPassword)
                                    </div>
                                    <div class="clear">
                                    </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T11:55:08.387

我在这里找到了正确的答案[MVC 3 Client-Side Compare Validation](https://stackoverflow.com/questions/6713872/mvc-3-client-side-compare-validation)

这是客户端验证脚本中的一个错误：jquery.validate.unobtrusive.js

在 ~284 行，你会发现：

```
element = $(options.form).find(":input[name=" + fullOtherName + "]")[0]; 
```

将其更改为：

```
element = $(options.form).find(":input[name='" + fullOtherName + "']")[0]; 
```

name 属性需要单引号。

* * *

I want to add if you use MIN version u have to change it there as well.

# javascript - 如何在 Firefox 中运行这个基于 ActiveX 的 javascript

> ID：10161727
> 
> 赞同：0
> 
> 时间：2012-04-15T11:41:40.603
> 
> 标签：javascript, firefox, firefox-addon, activex, activexobject

我正在尝试运行以下启动记事本的代码。IE 选项卡是不错的解决方案，但加载速度很慢。我尝试了ff-activex-host。我下载了二进制exe。我将 npffax.dll 复制到 firefox 插件文件夹(C:\Program Files\Mozilla Firefox\plugins) 。但是，上面的代码仍然不起作用。我在 Web 控制台中收到消息“ActiveXObject 未定义”。任何人都可以阐明这个问题吗？请清除我运行此代码。这是我正在尝试的代码。

```
var commandtoRun ="C:\\WINDOWS\\notepad.exe";
var oShell = new ActiveXObject("WScript.Shell");
oShell.run(commandtoRun); 
```

**编辑：** 欢迎任何在 Firefox 中运行上述代码的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T12:25:32.800

[这是来自MDN](https://developer.mozilla.org/en/Code_snippets/Running_applications)的示例代码：

```
var file = Components.classes["@mozilla.org/file/local;1"]  
                 .createInstance(Components.interfaces.nsILocalFile);  
file.initWithPath("c:\\myapp.exe");  
file.launch(); 
```

请记住，这不是跨浏览器，并且不适用于 Linux。如果这对您很重要， - 使用`nsIProcess`界面，[https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIProcess](https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIProcess)

# kinect - 在 kinect for windows 中使用 kinect sdk beta 1.0

> ID：10161733
> 
> 赞同：0
> 
> 时间：2012-04-15T11:42:50.277
> 
> 标签：kinect

不久前，我使用 Kinect SDK Beta（第一个版本，而不是第二个版本）在 C# 中创建了一个程序。

我现在拥有一台适用于 Windows 的 Kinect。我的疑问，一个严重的问题是，我还能使用 Kinect SDK Beta

为 Kinect for Windows 制作程序？因为我有点赶时间，我无力改变

再次完整的代码。请帮帮我。或建议一些替代方案（我的意思是简单的替代方案）

干杯

普拉泰克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T09:57:35.617

在 2016 年 6 月 16 日之前，您仍然可以将 SDK 测试版仅用于非商业项目。

资料来源：http: [//blogs.msdn.com/b/kinectforwindows/archive/2012/01/09/kinect-for-windows-commercial-program-announced.aspx](http://blogs.msdn.com/b/kinectforwindows/archive/2012/01/09/kinect-for-windows-commercial-program-announced.aspx)

# android - Android OpenCV 图像校正

> ID：10161734
> 
> 赞同：1
> 
> 时间：2012-04-15T11:42:51.030
> 
> 标签：android, opencv, matrix

我正在尝试在没有校准的情况下进行图像校正，只使用基本矩阵和使用 OpenCV 到目前为止我所做的事情：

1.  使用 SURF 和 FLANN 描述符匹配器查找两个图像之间的匹配项

    列出 good_match = getGoodMatch(img1,img2); --> 搞定了，效果不错

2.  获取 img1 和 img2 的匹配点

3.  使用 8 个匹配点 (Calib3D.FM_8PPoint) 获取基本矩阵 Mat F = getFundamentalMatrix(matchesKeyPoint1,matchesKeyPoint2,good_match)
4.  使用 StereorectufyUncalibrated OpenCV 获取 Homography 3x3 Matrix

我有来自 StereoRectifyUncalibrated 的单应矩阵 H1 和 H2，那么如何使用该单应矩阵来纠正我的真实图像？有什么方法可以知道基本矩阵和单应矩阵有很好的价值吗？到目前为止，SURF Image Matching 做得很好。有什么建议可以改善结果吗？

谢谢...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T14:18:35.273

## 纠正图像

给定一组 2D 点对应关系 X <-> X'，单应矩阵的变换是由 X' = H X 给出的*H。**这里*X 和 X' 是[齐次向量](http://en.wikipedia.org/wiki/Homogeneous_coordinates)，这意味着 3D 向量 X' 和*H* X 不必相等，但它们的大小可以相差一个*非零比例因子*。

所以基本上我们想做的是将图像中的每个像素与单应矩阵相乘。此外，我们希望在转换后的像素之间应用某种*插值*，以便我们获得没有“空”像素的平滑图像。幸运的是，OpenCV 中存在这样的函数：**cvWarpPerspective**。

此函数（在*OpenCV 2.0*中）需要 4 个参数：

*   const CvArr* src - 源图像，即您要纠正的图像。
*   CvArr* dst - 目标图像，即校正后的结果。此图像应与源图像的图像*类型相同。*并且尺寸应该适合校正后的图像（见下一段）。
*   const CvMat* mapMatrix - 3 X 3 单应矩阵。
*   int flags - 插值方法（例如 CV_INTER_LINEAR）与标志 CV_WARP_FILL_OUTLIERS 和 CV_WARP_INVERSE_MAP 的组合。

要确定目标图像的大小，可以对`corners`源图像应用单应矩阵的变换，并使用变换后的点来确定大小。左上角的变换如下：

```
CvMat* point = cvCreateMat(3, 1, CV_64FC1);
CvMat* pointTransform = cvCreateMat(3, 1, CV_64FC1);

cvmSet(point, 0, 0, 0); // The x coordinate of the top left corner is 0.
cvmSet(point, 1, 0, 0); // The y coordinate of the top left corner is 0.
cvmSet(point, 2, 0, 1.0);

// Perform the homography transformation
cvMatMul(homography, point, pointTransform);

// Get the transformed corner's x and y coordinates.
double x = cvmGet(pointTransform, 0, 0) / cvmGet(pointTransform, 2, 0); // Divide by the scale factor s.
double y = cvmGet(pointTransform, 1, 0) / cvmGet(pointTransform, 2, 0); // Divide by the scale factor s.

// Release memory
cvReleaseMat(&point);
cvReleaseMat(&pointTransform); 
```

接下来您应该注意的是，例如，像素 (0, 0) 可以转换为像素 (-5, -10)。如果您应用单应矩阵，然后尝试显示图像，它将无法正确显示。为了避免这种情况，您应该做的是根据校正图像的新角的位置计算一个 3 x 3[平移矩阵。](http://en.wikipedia.org/wiki/Translation_matrix)角落将为您提供信息，您必须将校正后的图像向上或向下和向左或向右移动多少像素。

然后，您可以将此转换矩阵与您找到的单应矩阵结合使用来计算最终的转换矩阵，如下所示：

```
// transformMat:
// [ 1 0 x ]
// [ 0 1 y ]
// [ 0 0 1 ]
// homography: Your homography matrix H1 or H2
// finalMatrix: the resulting matrix you will use in cvWarpPerspective.
// Compute the final transformation matrix based on homography matrix H1
// which can be used to rectify your first image.
cvMatMul(transformMat, H1, finalMatrix); 
```

现在您可以使用 cvWarpPerspective 来转换您的图像：

```
cvWarpPerspective(image, rectifiedImage, finalMatrix, 
CV_INTER_LINEAR+CV_WARP_FILL_OUTLIERS); 
```

请注意，您对第一张图像使用单应矩阵 H1，对第二张图像使用单应矩阵 H2。

## 基本矩阵和单应矩阵是否具有良好的值？

此外，要回答您的问题，看看基本矩阵*F*和单应矩阵*H1*和*H2*是否具有良好的值。基本矩阵*F*应满足对于任意一对对应点 X <-> X' 的条件：

X' *F* X = 0。

类似地，对于矩阵*H1*，应满足以下条件：

X' cross H1 X = 0，其中'cross'是[叉积](http://en.wikipedia.org/wiki/Cross_product)。

## 改善您的结果

为了进一步改善您的结果，您可以：

*   使用不同的描述符来查找两个图像之间的匹配。例如参见[SIFT](http://en.wikipedia.org/wiki/Scale-invariant_feature_transform)和[DAISY](http://cvlab.epfl.ch/alumni/tola/daisy.html)。
*   [使用RANSAC](http://en.wikipedia.org/wiki/RANSAC)或[LMS](http://en.wikipedia.org/wiki/Least_mean_squares_filter)算法查找两个图像之间超过 8 个点的对应关系并过滤异常值（请参阅 cvFindFundamentalMatrix 中的选项 CV_FM_RANSAC 和[CV_FM_LMEDS](http://opencv.willowgarage.com/documentation/cpp/camera_calibration_and_3d_reconstruction.html#cv-findfundamentalmat)）。

# java - 关于在比较中拆分字符串并忽略尾随字符

> ID：10161736
> 
> 赞同：0
> 
> 时间：2012-04-15T11:42:56.860
> 
> 标签：java, split

我正在使用两行的 string.split("") 并比较字符串是否相等，问题是生成的字符串有时在末尾有逗号，有时没有，这给出了假阴性。

```
String[] t1 = text.split(" ");
String[] t2 = str.split(" ");

for(int i=0;i<t1.length;i++)
{
    System.err.println("==============t1=====143"+t1[i]);
    for(int j=0;j<t2.length;j++)
    {
        if(t2[j].equals(t1[i]) || t2[j].equals(t1[i]+","))
        {
            x.add(str);
        }
    }
} 
```

如果出现逗号，我怎样才能让程序忽略它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T11:52:01.207

您也可以使用`java.String.matches`. 你可以在两者之间使用正则表达式

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T11:47:06.720

在比较字符串之前使用 java.lang.String.replace() 方法替换逗号

# java - 在 Java 中将字符串添加到 int 时会得到什么？

> ID：10161737
> 
> 赞同：1
> 
> 时间：2012-04-15T11:43:00.003
> 
> 标签：java

我正在浏览我的一些朋友 Java，他目前正在睡觉。我的计算机上没有 JDK，而且我一生中从未接触过 Java。checksum int 这个表达式的值是多少？

```
int score = 15;
String name = "Me";
String checksum = score + name + "salt";
//do stuff 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T11:45:01.667

这将是'15Mesalt'

它只是将整数作为数字添加到字符串中，没有多余的装饰，没有什么真正花哨的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T11:44:46.673

`checksum`in将被转换为字符串，因此 的值为`15Mesalt`。

来自关于字符串连接的[java语言规范（15.18.1） ：](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.18)

> 如果只有一个操作数表达式是字符串类型，则对另一个操作数执行字符串转换以在运行时生成字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-15T11:47:04.533

您正在连接字符串中的 int 。在 String 连接中将 int 转换为 String。

结果将是

```
15MEsalt 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-15T11:47:53.410

结果是`15Mesalt`。您的正确变量是`String`操作`+`员与操作数的联系。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-04-06T08:39:21.350

运算符在语法上`+` 是左结合的，无论是通过类型分析确定是表示字符串连接还是数值加法。如果一个运算符的任一操作数的类型`+`是String，那么该操作就是字符串连接。

所以表达式的结果`score + name + "salt"` = "15Mesalt";

这是另一种情况：

`System.out.println("Hello" + 'a' + 7);` `System.out.println('a' + 7 + "Hello");`

第一个输出是`Helloa7`，而第二个是`104Hello`。在第一个语句中，两个`+`运算符都表示字符串连接。

但是对于第二个，由于 + 运算符在语法上是左关联的，所以`'a'+7`首先被评估。现在它触发了 java 自动类型提升机制，将`'a'`其转换为相应的 ASCII 值`97`并将其添加到`7`。所以结果是`104`，即一个int值。然后`104 + "Hello"` 被评估。由于第二个操作数是一个字符串，该`+`运算符现在表示字符串连接。所以结果是`104Hello`。

# java - android额外发送意图

> ID：10161738
> 
> 赞同：0
> 
> 时间：2012-04-15T11:43:27.577
> 
> 标签：java, android, listview, android-intent

应用读取 JSON 数据。然后它会将它放到列表视图中（正确），但是在按下一个项目后，我总是会得到相同的值。在我认为是问题但我找不到的代码下方。

```
try{
    JSONArray jArray = new JSONArray(result);
    for(int ii=0;ii<jArray.length();ii++){
            JSONObject json_data = jArray.getJSONObject(ii);
            courseName = json_data.getString("fullname");

            HashMap<String,String> map = new HashMap<String, String>();
            map.put("fullname", courseName);
            myCoursesList.add(map);
    }
} catch(JSONException e){
    Log.e("log_tag", "Error parsing data "+e.toString());
}
ListAdapter adapter = new SimpleAdapter(this, myCoursesList,R.layout.my_courses_layout,
        new String[] {"fullname"}, new int[] { R.id.course});

setListAdapter(adapter);
ListView lv = getListView();
lv.setOnItemClickListener(new OnItemClickListener(){
    public void onItemClick(AdapterView<?> parent, View view, int position, long id){
        String fn = ((TextView)findViewById(R.id.course)).getText().toString();

        Intent in = new Intent(getApplicationContext(), courseActivity.class);
        in.putExtra("fullname", fn);
        startActivity(in);
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T11:52:58.243

我是一个普通的适配器/列表视图，我想你会想做这样的事情。

```
public void onItemClick(AdapterView<?> parent, View view, int position, long id){
     String fn = adapter.get(position);
     Intent in = new Intent(getApplicationContext(), courseActivity.class);
     in.putExtra("fullname", fn);
     startActivity(in);      
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T11:48:42.290

改变这个：

```
String fn = ((TextView)findViewById(R.id.course)).getText().toString(); 
```

对此：

```
String fn = ((TextView)view.findViewById(R.id.course)).getText().toString(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T11:49:00.470

尝试

```
String fn = ((TextView)view.findViewById(R.id.course)).getText().toString(); 
```

代替

```
String fn = ((TextView)findViewById(R.id.course)).getText().toString(); 
```

# php - Facebook 弃用了离线访问，有什么办法吗？

> ID：10161744
> 
> 赞同：0
> 
> 时间：2012-04-15T11:44:54.397
> 
> 标签：php, facebook, facebook-graph-api

我有一个 php 音乐网站。我可以让用户通过 facebook 进行身份验证，并通过 hybridauth 库登录到我的网站。

现在我想要的是，每次用户听一首歌时，我都会用歌曲链接更新他的状态。既然 Facebook 正在取消对离线访问的支持，这是否可以实现，或者这是否不需要离线访问权限？

我是 facebook api 的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T11:50:09.793

好吧，我不完全理解您的情况，但是如果用户在您想在他的墙上发布时正在使用您的应用程序，那么您就没有问题，并且您不需要“offline_access”或任何等效项..

您可以简单地将[javascript SDK](http://developers.facebook.com/docs/reference/javascript/)加载到页面，这将确保用户经过身份验证并且您拥有有效的访问令牌，如身份验证文档[处理无效和过期访问令牌](http://developers.facebook.com/docs/authentication/access-token-expiration/)中所述：

> **使用 Javascript SDK 实现身份验证的桌面 Web 和移动 Web 应用程序**
> 
> 调用 FB.getLoginStatus() 或确保 status: true 在您调用 FB.init() 时设置意味着下次用户登陆您的应用程序并登录 Facebook 时，您将通过这些调用传递 authResponse 对象将包含一个新的、有效的访问令牌。
> 
> 在这种情况下，它只是用户使用您的应用程序的行为，它隐式地生成了一个新的访问令牌。

* * *

# 编辑

如果您使用服务器端身份验证流程或使用为扩展有效访问令牌（使用客户端流程获得）提供的新端点 facebook，您可以获得相当长的访问令牌（大约 60 天），如发布[删除 offline_access 权限](http://developers.facebook.com/roadmap/offline-access-removal/)。

如果这对您有帮助，那很好，但我建议您确保您的应用程序可以处理令牌过期，因为您无法完全避免这种情况。

如何？好吧，你有几个选项，你需要找到一个适合你的特定场景的选项，但这里有一个选项：首先，正如我所看到的，你必须在客户端做事，因为令牌ca 在用户听歌时过期，为了从服务器端获取新令牌，您必须刷新页面并将用户发送到身份验证对话框，这会干扰他的体验。

这是一些使用 js sdk 的 js 代码，它不是完整的代码，我不希望它工作，但它应该让你知道你可以做什么：

```
FB.Event.subscribe("auth.statusChange", function(response) {
    if (response.status !== "connected") {
        FB.login(function(response2) {
            if (response2.authResponse) {
                // you now have a valid access token, you can update your server side with an ajax request for example
            }
            else {
                // user canceled login
            }
        });
    }
}); 
```

另外，请注意*FB.login*尝试打开一个弹出窗口，因此不应像这样调用它，只有在用户交互之后，所以不要只是调用它，您应该将其替换为向用户显示一条消息，如“请单击“确定”以便能够发布到 facebook...”，然后单击打开*FB.login*。

当然，您还可以使用其他方法或订阅其他事件，只需阅读文档并尝试您拥有的选项即可。

# actionscript-3 - 简单弹弓的 AS3 椭圆约束

> ID：10161748
> 
> 赞同：1
> 
> 时间：2012-04-15T11:45:21.853
> 
> 标签：actionscript-3, ellipse

我正在尝试改进一个简单的 AS3 弹弓，该弹弓可在[http://blog.shaperstudio.com/2010/10/as3-create-a-slingshot-with-an-elastic-effect/](http://blog.shaperstudio.com/2010/10/as3-create-a-slingshot-with-an-elastic-effect/)获得， 以便我可以做到更现实。

我已经对其进行了更改，以便可以将球瞄准任何方向，但现在我正在尝试创建一个函数，将弹弓的最大拉力限制在椭圆区域，最好具有与弹弓相同的两个点椭圆两个焦点：

```
if ( mouseX > centerX + _maximumPULL.x) _mouse_x = centerX + _maximumPULL.x;                
            else if ( mouseX < centerX - _maximumPULL.x) _mouse_x = centerX - _maximumPULL.x;
            else _mouse_x = mouseX;

if ( mouseY > centerY + _maximumPULL.y) _mouse_y = centerY + _maximumPULL.y;                
            else if ( mouseY < centerY - _maximumPULL.y) _mouse_y = centerY - _maximumPULL.y;
            else _mouse_y = mouseY; 
```

其中 _maximumPULL 是一个点变量，它返回我们可以拉弹性多远，像这样？：

```
_maximumPULL = new Point(200 * Math.cos(degree * Math.PI / 180), 100 * Math.sin(degree * Math.PI / 180)); 
```

我已经在代码上搞砸了太多小时了，我知道这对于像我这样没有编程背景的人来说太过分了，但我就是放不下，我上瘾了……

我一直试图在这里理解类似的问题：http: [//www.soundstep.com/blog/2011/04/08/knob-as3-drag-on-circle-or-ellipse/](http://www.soundstep.com/blog/2011/04/08/knob-as3-drag-on-circle-or-ellipse/)

在这里：[ActionScript 3 Trig Equations to create Ellipse](https://stackoverflow.com/questions/4986998/actionscript-3-trig-equations-to-create-ellipse)

你能帮帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T02:58:39.460

Might not be exactly what you're after but what about drawing the exact shape you want (be it in flash, or programatically using the `graphics` class) and then check for collision between the ball and the allowed area.

You can code that very simply by adding something like this inside your mouseMove event function:

```
if (theBall.hitTestObject( allowedRange )){
    //Put your code that figures out where the ball should be
}//otherwise, it won't alter the position of the ball :D 
```

# c++ - 无法运行 vc++，错误代码 0xc0150002

> ID：10161749
> 
> 赞同：0
> 
> 时间：2012-04-15T11:45:23.733
> 
> 标签：c++, visual-studio-2010, dll

我正在尝试在 Win7 企业版 VS2010 终极版 4.0.30319 上运行 vc++ 应用程序，但未能这样做。应用程序在运行时失败，说明：应用程序无法正确启动 (0xc0150002)。单击确定关闭应用程序。

我想我缺少一个系统 DLL，但不知道从哪里得到它。

完全相同的项目（相同的 dll、lib 文件和 h 文件）在不同的类似机器（x64、vs2010）上运行，但无法在我的机器上运行。我还运行了dependcy walker，这就是我所拥有的：

```
*****************************| System Information |*****************************

Dependency Walker:       2.2.6000 (64-bit)
Operating System:        Microsoft Windows NT/2000/XP/2003/Vista based Enterprise (64-bit)
OS Version:              6.01.7601 Service Pack 1
Processor:               Intel64 Family 6 Model 42 Stepping 7, GenuineIntel, ~2594MHz
Number of Processors:    4, Mask: 0x000000000000000F
Local Date:              Sunday, April 15, 2012
Memory Load:             92%
Physical Memory Total:   4,200,972,288 (4007 MB)
Physical Memory Used:    3,884,187,648
Physical Memory Free:    316,784,640
Page File Memory Total:  8,400,052,224
Page File Memory Used:   4,405,301,248
Page File Memory Free:   3,994,750,976
Virtual Memory Total:    8,796,092,891,136
Virtual Memory Used:     200,855,552
Virtual Memory Free:     8,795,892,035,584
Page Size:               0x00001000 (4,096)
Allocation Granularity:  0x00010000 (65,536)
Min. App. Address:       0x0000000000010000 (65,536)
Max. App. Address:       0x000007FFFFFEFFFF (8,796,092,956,671)

Side-by-Side components (Windows 2000/XP/2003/Vista/+)
   [F ] c:\windows\winsxs\amd64_microsoft.windows.common-controls_6595b64144ccf1df_5.82.7601.17514_none_a4d6a923711520a9\COMCTL32.DLL
   [F ] c:\windows\winsxs\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.7601.17514_none_fa396087175ac9ac\COMCTL32.DLL
   [F ] c:\windows\winsxs\amd64_microsoft.windows.gdiplus_6595b64144ccf1df_1.1.7601.17514_none_2b24536c71ed437a\GDIPLUS.DLL
The system's "KnownDLLs" list
   [F ] c:\windows\system32\ADVAPI32.DLL
   [F ] c:\windows\system32\CFGMGR32.DLL
   [F ] c:\windows\system32\CLBCATQ.DLL
   [F ] c:\windows\system32\COMCTL32.DLL
   [F ] c:\windows\system32\COMDLG32.DLL
   [F ] c:\windows\system32\CRYPT32.DLL
   [F ] c:\windows\system32\DEVOBJ.DLL
   [F ] c:\windows\system32\DIFXAPI.DLL
   [F ] c:\windows\system32\GDI32.DLL
   [F ] c:\windows\system32\IERTUTIL.DLL
   [F ] c:\windows\system32\IMAGEHLP.DLL
   [F ] c:\windows\system32\IMM32.DLL
   [F ] c:\windows\system32\KERNEL32.DLL
   [F ] c:\windows\system32\KERNELBASE.DLL
   [F ] c:\windows\system32\LPK.DLL
   [F ] c:\windows\system32\MSASN1.DLL
   [F ] c:\windows\system32\MSCTF.DLL
   [F ] c:\windows\system32\MSVCRT.DLL
   [F ] c:\windows\system32\NORMALIZ.DLL
   [F ] c:\windows\system32\NSI.DLL
   [F ] c:\windows\system32\NTDLL.DLL
   [F ] c:\windows\system32\NTDLL.DLL
   [F ] c:\windows\system32\OLE32.DLL
   [F ] c:\windows\system32\OLEAUT32.DLL
   [F ] c:\windows\system32\PSAPI.DLL
   [F ] c:\windows\system32\RPCRT4.DLL
   [F ] c:\windows\system32\SECHOST.DLL
   [F ] c:\windows\system32\SETUPAPI.DLL
   [F ] c:\windows\system32\SHELL32.DLL
   [F ] c:\windows\system32\SHLWAPI.DLL
   [F ] c:\windows\system32\URLMON.DLL
   [F ] c:\windows\system32\USER32.DLL
   [F ] c:\windows\system32\USP10.DLL
   [F ] c:\windows\system32\WININET.DLL
   [F ] c:\windows\system32\WINTRUST.DLL
   [F ] c:\windows\system32\WLDAP32.DLL
   [F ] c:\windows\system32\WS2_32.DLL
The application's registered "App Paths" directories
The system's "PATH" environment variable directories
   [  ] C:\Oracle11gR2_x64\product\11.2.0\client_1\bin\
   [  ] C:\Windows\system32\
   [  ] C:\Windows\
   [  ] C:\Windows\System32\Wbem\
   [  ] C:\Windows\System32\WindowsPowerShell\v1.0\
   [  ] C:\Program Files\WIDCOMM\Bluetooth Software\
   [  ] C:\Program Files\WIDCOMM\Bluetooth Software\syswow64\
   [  ] C:\Program Files\Intel\WiFi\bin\
   [  ] C:\Program Files\Common Files\Intel\WirelessCommon\
   [  ] C:\Program Files (x86)\Microsoft SQL Server\100\Tools\Binn\
   [  ] C:\Program Files\Microsoft SQL Server\100\Tools\Binn\
   [  ] C:\Program Files\Microsoft SQL Server\100\DTS\Binn\
   [  ] C:\Program Files (x86)\Microsoft SQL Server\100\Tools\Binn\VSShell\Common7\IDE\
   [  ] C:\Program Files (x86)\Microsoft SQL Server\100\DTS\Binn\
   [  ] C:\Program Files (x86)\Microsoft Visual Studio 9.0\Common7\IDE\PrivateAssemblies\
   [  ] C:\GTK2-Runtime\bin\
   [  ] c:\Program Files (x86)\Microsoft ASP.NET\ASP.NET Web Pages\v1.0\
   [  ] C:\Program Files\OpenCV2.3\build\bin\
   [  ] C:\Program Files\OpenCV2.3\build\x64\vc10\bin\
   [  ] C:\Program Files (x86)\Intel\OpenCL SDK\2.0\bin\x86\
   [  ] C:\Program Files (x86)\Intel\OpenCL SDK\2.0\bin\x64\

***************************| Module Dependency Tree |***************************
*                                                                              *
* Legend: F  Forwarded Module   ?  Missing Module        6  64-bit Module      *
*         D  Delay Load Module  !  Invalid Module                              *
*         *  Dynamic Module     E  Import/Export Mismatch or Load Failure      *
*                               ^  Duplicate Module                            *
*                                                                              *
********************************************************************************

[   ] GRASPVIEWER.EXE
     [   ] OPENCV_CORE230D.DLL
          [ E6] KERNEL32.DLL
               [FE6] NTDLL.DLL
          [ ? ] MSVCP90D.DLL
          [   ] LIBMMDD.DLL
               [ E6] KERNEL32.DLL
                    [FE6] NTDLL.DLL
          [ ? ] MSVCR90D.DLL

...

********************************| Module List |*********************************
*                                                                              *
* Legend: D  Delay Load Module   ?  Missing Module           6  64-bit Module  *
*         *  Dynamic Module      !  Invalid Module                             *
*                                E  Import/Export Mismatch or Load Failure     *
*                                                                              *
********************************************************************************
[ ? ]  MSVCP90D.DLL     Error opening file. The system cannot find the file specified (2).
[ ? ]  MSVCR90D.DLL     Error opening file. The system cannot find the file specified (2).
[D? ]  IESHIMS.DLL      Error opening file. The system cannot find the file specified (2).

...

************************************| Log |*************************************

Error: The Side-by-Side configuration information for "c:\users\ ...\OPENCV_CORE230D.DLL" contains errors. The application has failed to start because its side-by-side configuration is incorrect. Please see the application event log or use the command-line sxstrace.exe tool for more detail (14001).
Error: The Side-by-Side configuration information for "c:\users\ ...\debug\HANDSD.DLL" contains errors. The application has failed to start because its side-by-side configuration is incorrect. Please see the application event log or use the command-line sxstrace.exe tool for more detail (14001).
Error: The Side-by-Side configuration information for "c:\users\ ... \debug\CORE.DLL" contains errors. The application has failed to start because its side-by-side configuration is incorrect. Please see the application event log or use the command-line sxstrace.exe tool for more detail (14001).
Error: The Side-by-Side configuration information for "c:\users\ ... \debug\OPENCV_HIGHGUI230D.DLL" contains errors. The application has failed to start because its side-by-side configuration is incorrect. Please see the application event log or use the command-line sxstrace.exe tool for more detail (14001).
Error: The Side-by-Side configuration information for "c:\users\ ... \debug\OPENCV_IMGPROC230D.DLL" contains errors. The application has failed to start because its side-by-side configuration is incorrect. Please see the application event log or use the command-line sxstrace.exe tool for more detail (14001).
Error: The Side-by-Side configuration information for "c:\users\ ... \debug\FINGERTRACKER.DLL" contains errors. The application has failed to start because its side-by-side configuration is incorrect. Please see the application event log or use the command-line sxstrace.exe tool for more detail (14001).
Error: At least one required implicit or forwarded dependency was not found.
Error: At least one module has an unresolved import due to a missing export function in an implicitly dependent module.
Error: Modules with different CPU types were found.
Warning: At least one delay-load dependency module was not found.
Warning: At least one module has an unresolved import due to a missing export function in a delay-load dependent module. 
```

任何帮助，将不胜感激！谢谢，暗里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T11:57:33.357

您缺少的 DLL 是一个 VS 调试 DLL ......它通常与 VS 一起安装。如果你在这台机器上有一个特殊的配置，可能是DLL放错了地方或者干脆丢失了。如果它丢失，请尝试通过修复安装从 VS 安装程序中获取它。

编辑：

如果您不需要这个特定的 DLL，您可以随时删除项目配置中的依赖项

# mysql - 如何使用 Android/Java 应用程序连接在 Amazon EC2 上运行的 MySQL？

> ID：10161753
> 
> 赞同：0
> 
> 时间：2012-04-15T11:46:12.193
> 
> 标签：mysql, jdbc

```
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.net.ServerSocket;
import java.net.Socket;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import com.mysql.jdbc.Driver;

public class ClientHandler {
    static ServerSocket providerSocket;
    static Socket connection = null;
    static ObjectOutputStream out;
    static ObjectInputStream in;
    static String message;
    static DBProvider dbProvider;

    public static void main(String args[]) {

        // while (true) {
        ClientHandler.run();
        // }
    }

    static void run() {
        try {
            // 1\. creating a server socket
            providerSocket = new ServerSocket(4001, 10);
            // 2\. Wait for connection
            System.out.println("Waiting for connection at "
                    + providerSocket.getLocalPort());
            connection = providerSocket.accept();
            System.out.println("Connection received from "
                    + connection.getInetAddress().getHostAddress());

            // 3\. get Input and Output streams
            out = new ObjectOutputStream(connection.getOutputStream());
            out.flush();
            in = new ObjectInputStream(connection.getInputStream());
            sendMessage("Connection successful");

            // 4\. The two parts communicate via the input and output streams
            message = (String) in.readObject();

            dbProvider.connect();
            // gets the messages from client here
            dbProvider.insert_delete_entries(message);

        } catch (ClassNotFoundException e) {
            System.out.println(e.toString());
            e.printStackTrace();
        } catch (NullPointerException e) {
            System.out.println(e.toString());
            e.printStackTrace();
        } catch (IOException ioException) {
            System.out.println(ioException.toString());
            ioException.printStackTrace();
        } catch (SQLException e) {
            System.out.println(e.toString());
            e.printStackTrace();

        } catch (IllegalAccessException e) {
            // TODO Auto-generated catch block
            System.out.println(e.toString());
            e.printStackTrace();
        } finally {
            // 4: Closing connection
            try {
                dbProvider.disconnect();
                in.close();
                out.close();
                providerSocket.close();
            } catch (IOException ioException) {
                ioException.printStackTrace();
            } catch (NullPointerException e) {
                System.out.println(e.toString());
            } catch (SQLException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
    }

    static void sendMessage(String... msg) {
        try {
            out.writeObject(msg);
            out.flush();
            System.out.println("server>" + msg);
        } catch (IOException ioException) {
            ioException.printStackTrace();
        }
    }

    static void sendMessage(String msg) {
        try {
            out.writeObject(msg);
            out.flush();

        } catch (IOException ioException) {
            ioException.printStackTrace();
        }
    }

    public class DBProvider {
        final static String userName = "root";
        final static String password = "password";
        final static String url = "jdbc:mysql://localhost:3306/central_server";
        protected Connection conn = null;

        DBProvider() {

        }

        public void connect() throws ClassNotFoundException, SQLException,
                IllegalAccessException {
            // TODO Auto-generated method stub
            Class.forName("com.mysql.jdbc.Driver");
            conn = DriverManager.getConnection(url, userName, password);
            System.out.println("Database connection established");
            System.out.println(conn.toString());

        }

        public void disconnect() throws SQLException {
            // TODO Auto-generated method stub
            if (conn != null) {
                conn.close();
                System.out.println("Database connection terminated");

            }
        }

        public void insert_delete_entries(String string) throws SQLException {
            // TODO Auto-generated method stub

            Statement delete = conn.createStatement();
            int i = delete.executeUpdate(string);
            System.out.println(i + " row(s) affected");

        }

        public ResultSet display_results(String string) throws SQLException {
            // TODO Auto-generated method stub

            Statement displayStatement = conn.createStatement();
            ResultSet result = displayStatement.executeQuery(string);
            System.out.println(result.toString());
            return result;

        }
    }
} 
```

我在打开端口 4001 的 Amazon EC2 上运行它。

我在套接字通信中成功，但是当我连接到本地运行的 mysql 时，出现空指针异常

```
dpProvider.connect(); 
```

我使用名为 mysql_conn.jar 的 jdbc mysql 连接器调用它：

```
javac -classpath ./mysql_conn.jar ClientHandler.java 
```

编译得很好。

但是当我打电话时：`java ClientHandler`

出现空指针异常。。

请帮忙..！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T11:53:06.817

尝试在发出 java 命令时将 mysql_conn.jar 添加到类路径，例如 java -cp ClientHandler

# ruby-on-rails - 从 Ruby on Rails 应用程序中的串行端口读取挂起

> ID：10161758
> 
> 赞同：5
> 
> 时间：2012-04-15T11:46:48.840
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, serial-port, arduino

我正在使用`serialport` [gem](http://en.wikipedia.org/wiki/RubyGems)从我的 Ruby on Rails 3.2 应用程序中的串行端口读取数据。串行端口本身用于从 Arduino 板写入数据。宝石被添加到`Gemfile`. 端口在以下位置初始化`application.rb`：

```
config.serial_port = SerialPort.new "/devttyACM0", 9600
config.serial_port.read_timeout = 100 
```

当我尝试从此端口读取时出现问题。

```
@sp = ProjectName::Application::config.serial_port
@sp.read 
```

该应用程序挂起致命。我试图从`pry`会话中读取，一切都很好。如果我设置`read_timeout`为`0`，阅读`pry`也挂起。我已经尝试设置`read_timeout`为更大的值而没有结果。我应该怎么做才能让它工作？

**更新：**

我尝试使用`sinatra` [framework](http://www.sinatrarb.com/)执行相同的操作。它也挂了。

```
require "sinatra"
require "serialport"

get '/' do
  read_data
end

helpers do
  def read_data
    sp = SerialPort.new "/dev/ttyACM0", 9600
    sp.read_timeout = 1500
    t = sp.read.match(/\d+(\n|\r)+/)[0].gsub!(/(\n|\r)*/,"") rescue nil
    sp.close
    t
  end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T19:38:17.120

有同样的问题。修复实际上很简单，问题是您的 Rails 应用程序不断地从串行端口读取新值，并且只要读取这些输入，它就不会做任何其他事情，因此您的网站永远不会真正构建。

例如，如果您只是让它从串行端口读取固定次数，请尝试它是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T12:52:07.723

您能否使用简单的脚本与设备进行交互，如下所示：

```
require 'rubygems'
require 'serialport'
sp = SerialPort.new "/dev/ttyUSB0"
sp.write "AT\r"
while true do
   printf("%c", sp.getc)
 end 
```

在这种情况下，我使用的是 GSM 调制解调器。也许您的设备首先在等待某个命令。

# java - 登录时如何获取当前用户状态和存在？SMACK XMPP

> ID：10161759
> 
> 赞同：2
> 
> 时间：2012-04-15T11:46:53.057
> 
> 标签：java, android, xmpp, smack

我显然在Android BEEM中使用smack制作了一个聊天应用程序......我面临的问题是，当我的第一个用户登录并设置他的状态/存在时，登录时其他用户的状态将持续存在......我的用户状态就像 BEEM 一样存储在共享首选项文件中

这就是为什么我想获取我当前登录用户的状态，以便在其他用户登录时不会使用它......所以每次用户登录时状态总是新的......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:09:14.840

你不能。Smack 不会为您管理/记住用户的存在。它只管理您收到的存在（例如，来自公鸡中 JID 的存在）。

最简单的方法是创建对上次发送 Presence 的引用，并在每次发送新 Presence 时更新该引用。

# jquery - 如何在jquery中使用带有ajax的else语句

> ID：10161761
> 
> 赞同：0
> 
> 时间：2012-04-15T11:47:06.037
> 
> 标签：jquery, ajax

我正在使用javascript代码

```
function ajax()
 {

var xmlhttp;
if (window.XMLHttpRequest)
  {
  xmlhttp=new XMLHttpRequest();
  }
else
  {
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }

xmlhttp.onreadystatechange=function()
  {if (xmlhttp.readyState==4 && xmlhttp.status==200)
   document.getElementById('mydiv').innerHTML=xmlhttp.responseText;
   else
   document.getElementById('mydiv').innerHTML='Loading';
  }
  xmlhttp.open("GET",'welcome.html',true);
xmlhttp.send();
 } 
```

在页面处理期间的这段代码中，浏览器打印加载。但是现在我正在使用 `$('#mydiv').load('welcome.html');` ，我不知道如何在 jquery 中处理页面时打印加载

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-15T11:49:20.220

这：

```
$( '#mydiv' ).html( 'Loading...' ).load( 'welcome.html' ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T11:51:14.223

我会在 JS 中调用“加载”之前设置#mydiv 以包含文本/加载图像，然后在加载此内容后将其替换为“welcome.html”。

您可以将其用作触发负载的处理程序/函数的一部分，例如：

```
$('mybutton').click(function() {

    $('myDiv').html("Loading ... ");

    $('myDiv').load('welcome.html');

}); 
```

或类似的规定

# c++ - 打印所有可能的最长递减子序列

> ID：10161763
> 
> 赞同：1
> 
> 时间：2012-04-15T11:47:22.083
> 
> 标签：c++, algorithm

我有整数数组 A[1...N]。现在我想打印所有最长的递减子序列。我已经完成了大部分教程，但是所有教程都只打印一个 LDS。假设 LDS 的长度是 5，那么大多数只打印一个长度为 5 的 LDS。但我想打印所有可能的 LDS。怎么做这？？可以在 O(nlongn) 时间内完成。伪代码会更有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T12:01:06.737

您可以随时跟踪所有最长（到目前为止）的子序列：

```
// If you have only one element, that is the longest descending subsequence
// Otherwise store first element as previous

if: current element is less than (or equal to) previous
  // decreasing
  increase current subsequence length
  add element to current subsequence
else:
  // increasing
  set current subsequence length to 0
  empty current subsequence

if: current subsequence is longer than current maximum
  invalidate all current max subsequences
  set current maximum subsequence length to current subsequence length
  add current subsequence to set of longest subsequences
else if: current subsequence is same size as current maximum
  add current subsequence to set of longest subsequences 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T12:56:04.150

`N^2`如果您从教程中取消优化算法，并使用更简单的算法进行线性搜索而不是在地图中查找，则更容易理解这个想法。然后修改打印序列的代码以向后搜索先前的元素，而不是将其存储在`vector<int> pre`. 然后您可以使用简单的递归回溯器打印所有序列：

```
#include <iostream>
#include <vector>
#include <algorithm>
using namespace std;

void print_all(
    const vector<int> seq
,   const vector<int>& len
,   int max, int pos
,   vector<int>& sofar) {
    if (max == 0) {
        for (int i = sofar.size()-1 ; i >= 0 ; i--)
            cout << sofar[i] << " ";
        cout << endl;
        return;
    }
    int val = pos < seq.size() ? seq[pos] : -1;
    for (int i = pos-1 ; i >= 0 ; i--) {
        if (len[i] == max && seq[i] > val) {
            sofar.push_back(seq[i]);
            print_all(seq, len, max-1, i, sofar);
            sofar.erase(sofar.end()-1);
        }
    }
}

int main() {
    int data[] = {5, 30, 2, 17, 92, 11, 7, 10, 2, 1};
    vector<int> seq(data, data+10);
    vector<int> len(seq.size());
    for (int i = 0 ; i < seq.size() ; i++) {
        len[i] = 1;
        for (int j = i-1 ; j >= 0 ; j--)
            if (seq[j] > seq[i] && len[j]+1 > len[i])
                len[i] = len[j]+1;
    }
    int max = *max_element(len.begin(), len.end());
    cerr << max << endl;
    vector<int> sofar;
    print_all(seq, len, max, seq.size(), sofar);
} 
```

# c# - 模糊字符串比较 - 检测速记名称

> ID：10161770
> 
> 赞同：0
> 
> 时间：2012-04-15T11:48:44.487
> 
> 标签：c#, shorthand, similarity, fuzzy-comparison

这将是我第二次询问计算语言学/模糊字符串匹配，但这次不是关于词干。

我的第一个问题是使用模糊字符串匹配对数据库进行重复数据删除，我已经做到了。现在，我必须检测一个字符串是否是另一个字符串的简写。例如：

*   JOHN ADRIAN FREEMAN WELTER 等于 JAF Welter 或 JAFWelter
*   MICROSOFT OFFICE 等于 MS OFFICE
*   BUILDING 等于 BLDG

我目前正在使用 SimMetrics 的 .Net 版本来解决我的第一个问题。那么，SimMetrics 中有没有一种方法可以解决我的问题呢？如果没有，那么解决这个问题的最佳方法是什么？

以下是 SimMetrics 中实现的指标：

*   汉明距离
*   莱文斯坦距离
*   Needleman-Wunch 距离或卖方算法
*   史密斯-沃特曼距离
*   Gotoh 距离或 Smith-Waterman-Gotoh 距离
*   街区距离或L1距离或城市街区距离
*   蒙格埃尔坎距离
*   Jaro 距离度量
*   雅罗·温克勒
*   SoundEx 距离指标
*   匹配系数
*   骰子系数
*   Jaccard 相似度或 Jaccard 系数或 Tanimoto 系数
*   重叠系数
*   欧几里得距离或 L2 距离
*   余弦相似度
*   变分距离
*   海灵格距离或巴塔查亚距离
*   信息半径（Jensen-Shannon 散度）
*   谐波平均值
*   偏差散度
*   混淆概率
*   陶
*   Fellegi 和 Sunters (SFS) 指标
*   TFIDF 或 TF/IDF
*   快速A
*   爆破
*   最大匹配
*   q-gram
*   Ukkonen 算法

我对所有这些算法都不是很熟悉。我已经在这里使用的是 Leveshtein Distance、Needleman-Wunch、Jaro-Winkler、SoundEx 和 TF/IDF。而且我认为这些算法不足以解决这个简写名称问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T12:08:43.020

您很可能需要自定义方法。这是我要尝试的：

1.  JOHN ADRIAN FREEMAN WELTER 等于 JAF Welter 或 JAFWelter

在这里，您可以使用单词的第一个字母来获取缩写。如果所有出现的最后一个单词都是完整的，这很可能会为您提供独特的解决方案，否则您可能会找到具有相同缩写的其他单词序列（例如 JAFW：Java 作为外来词）

2.  MICROSOFT OFFICE 等于 MS OFFICE

在这里，您需要一个已知单词的字典，并认识到*Microsoft*可以从*Micro*和*Soft*放在一起（假设两者都在您的字典中）并在这些上使用第一种方法

3.  BUILDING 等于 BLDG

在这里，您将需要一个单词字典和自定义缩写（我认为您不会找到一个可以计算所有单词缩写的规则/算法）

# database - 在 Java EE 应用程序更新时迁移数据库模式

> ID：10161776
> 
> 赞同：4
> 
> 时间：2012-04-15T11:49:27.840
> 
> 标签：database, jakarta-ee, glassfish, dbmigrate

我有一个使用 SQL Server Express 作为后端数据库的 Java EE 应用程序。当我们部署新版本时，有时我们需要更改数据库：添加表、添加列、删除列、合并表、合并列等。

直到今天，我们都使用离线 SQL 脚本来修改数据库，但这种解决方案不可扩展且非常容易出错。

我们开始使用具有 @PostConstruct 装饰方法的单例启动 bean 来添加和删除系统在部署期间使用的数据。

我们现在还想发布 DML 语句，以便我们可以在部署期间升级我们的数据库并一劳永逸地消除 SQL 脚本。

1.  有没有人尝试过，这是好的方向吗？
2.  我们应该使用 entityManager.unwrap 方法还是简单地将 JDBC DataSource 资源注入我们的单例启动 bean？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-15T12:05:50.017

我们最近开始使用[flyway](/questions/tagged/flyway "显示标记为“flyway”的问题")并且对它非常满意。[文档非常](http://flywaydb.org/getstarted/whyDatabaseMigrations.html)好。简而言之：您包含一组带有版本的 SQL 脚本。Flyway 引擎将拾取尚未应用的 SQL 脚本（创建了一个特殊的元数据表）并运行它们。您可以使用带有版本的 SQL 或纯 Java。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-15T12:41:43.570

除了 Tomasz 的回答，您还可以使用[LiquiBase](http://www.liquibase.org/)。它提供的解决方案迫使开发人员对他们的模式更改进行“版本控制”，因此当您最终投入生产时，您将拥有一个完全可理解的模式更改日志。然后，您可以使用 LiquiBase 将该更改日志或其任何子集应用到生产数据库。您还可以回滚更改日志的子集。

它可以开箱即用地处理多种更改，还可以使用自定义迁移 java 类。

我自己从未使用过它，但它从 2007 年开始开源。

这是一个快速[概述](http://www.liquibase.org/swf/overview_short/liquibase%20overview.html)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-15T18:49:02.780

为了最终确定数据库迁移工具列表，我对[solidbase](https://github.com/sindicate/solidbase)非常满意。我们将它作为部署脚本的一部分启动，但在单例 bean 中启动它的想法非常有趣。Solidbase 的 wiki 没有记录这种嵌入式使用，但是从源代码类[Runner](https://github.com/sindicate/solidbase/blob/master/src/main/java/solidbase/core/Runner.java)的快速浏览中可以找到您正在寻找的东西。

# jquery - 在新行中获取代码

> ID：10161783
> 
> 赞同：1
> 
> 时间：2012-04-15T11:50:42.833
> 
> 标签：jquery

我有几个 div 其中之一如下

```
<div id="drawarea">    
<img class="draggable ui-droppable ui-draggable ui-draggable-dragging" id="image1"     src="user_2/1323384165.jpg" style="height: 40%; width: 50%; position: absolute; left: 0%; top: 0%;">
<label id="first">This is content of the div</label>
<input type="button" value="GO"/>

</div> 
```

我在下面的函数中使用 jquerys 来获取 div 内的 html 并放入文本区域

```
 html = $('#drawarea').html();

$('#codearea').text(html); 
```

问题是我在同一行中获取所有标签我想在一个中获取一个元素代码，然后在另一行中获取其他元素代码，这样它很容易阅读。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T11:54:55.583

```
<div id="drawarea">    
   <img class="draggable ui-droppable ui-draggable ui-draggable-dragging" id="image1"     src="user_2/1323384165.jpg" style="height: 40%; width: 50%; position: absolute; left: 0%; top: 0%;">
   <label id="first">This is content of the div</label>
   <input type="button" value="GO"/>
</div> 
```

这是修复

```
rawhtml = $('#drawarea').html();
html = rawhtml.replace('<br />', /\n/g);
$('#codearea').text(html); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T17:42:32.740

在 Chrome 18/Windows XP 中，这会自动发生，假设您要复制到的 HTML`textarea`在元素之间有换行符：

```
$('#codearea').text($('#drawarea').html());​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/AYUcN/5/)

或者，使用`val()`：

```
$('#codearea').val($('#drawarea').html());​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/AYUcN/4/)

这可能取决于您的浏览器/平台，但要尝试确保我已将 CSS 设置`textarea`为：

```
white-space: pre-wrap; 
```

这应该强制执行该行为，并防止空白折叠成单个空间。

# javascript - 日期验证 JavaScript

> ID：10161789
> 
> 赞同：-1
> 
> 时间：2012-04-15T11:52:05.420
> 
> 标签：javascript, validation, date

我正在用 JavaScript 编写生日验证表单，但它不起作用。你能帮忙找出哪一部分是错的吗？如何解决？

JavaScript

```
function onFormSubmit(form_element) {

    var slashcount = 0;
    if ((form_element.birthday.value =="")||(form_element.birthday.value ==null))
    {
        alert("This field is required. Please enter date mm/dd/yyyy!");
        false;
    }
    for (var i=0; i < birthday.length; i++)
    {
        temp = "" + birthday.substring(i, i+1);
        if (temp == "/")
        {
            slashcount++;
        }
        if (valid.indexOf(temp) == "-1")
        {
            alert("error1.");
            false;
        }
        if (slashcount != 2)
        {
            alert("error2");
            false;
        }
        if((birthday.charAt(2)!= '/')||( birthday.charAt(5) != '/'))
        {
            alert("error3");
            false;
        }
    }
    return true;
}​ 
```

HTML

```
<form onsubmit="return onFormSubmit(this)">

        Birthday:<input type="text" name="birthday" /><br />
        <input type="submit" value="submit" />
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T12:03:15.840

数组=date.split('/'); 如果日期正确，您将获得三个值。你可以对他们做任何你想做的事。

```
array=date.split('/');
if(array.length!=3)
{
alert('Not a valid date');
return false;
}
if(parseInt(array[0])>31)
{
alert('Not a valid day');
return false;
}
etc etc. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T11:53:25.810

首先，应该有`return false;`而不是仅仅`false;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-18T00:48:50.140

使用更容易的正则表达式。

将以下代码放入您的代码中：

此格式的日期：mm/dd/yyyy

^(0[1-9]|1[012])- /.- /.\d\d$

# c++ - 在 Windows XP 中获取 GPU 连接类型？

> ID：10161790
> 
> 赞同：6
> 
> 时间：2012-04-15T11:52:26.207
> 
> 标签：c++, windows, gpu

我需要在代码（C++）中检测显卡如何连接到显示器/s，即 vga 或 dvi 等。

我找到了两种方法可以做到这一点：

*   通过在 Windows Management Instrumentation 中查询[D3DKMDT_VIDEO_OUTPUT_TECHNOLOGY](http://msdn.microsoft.com/en-us/library/ff546605.aspx)或
*   使用 nVidia API 函数 NvAPI_DISP_GetMonitorCapabilities，

但这两者仅在 Windows Vista 或更高版本中受支持。

在 XP 中肯定有一种方法可以做到这一点，但是经过大量搜索后，我就是找不到，而且找到一种方法变得非常紧迫。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T12:41:11.993

可能您可以使用`EnumDisplayDevices`（[链接到 MSDN ）并按照](http://msdn.microsoft.com/en-us/library/dd162609%28v=vs.85%29.aspx)[此处](http://www.windows-api.com/microsoft/Win32-GDI/31775521/determining-physical-vgadvi-port-a-monitor-is-connected-to.aspx "这里")所述解析一些信息。它基本上是关于将物理显示器与逻辑显示器相匹配。

# node.js - Nodejs & Socket.io 可以支持多少用户？

> ID：10161796
> 
> 赞同：22
> 
> 时间：2012-04-15T11:53:21.200
> 
> 标签：node.js, socket.io

我有一个实现broadcast.emit的网站。向站点的所有用户发送消息。它只是 socket.io 的最简单实现，但我目前遇到了问题。当我达到大约 100 个并发用户时。nodejs 服务器开始滞后，直到它挂起，我无法再访问我的整个网站。当我们检查服务器时。nodejs 占用了 100% 的 CPU。正常吗？

我想知道 socket.io 可以支持多少用户？当这件事发生时，有没有办法以编程方式重新启动 nodejs 服务器？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-12T12:26:33.927

我有一个多人纸牌游戏。Socket.io 在大约 3000 个并发用户时最大化了我的 CPU。这是在英特尔 i7 CPU 上。因此，我必须运行多个 node/socket.io 进程来处理负载。

对于 100 个并发连接，您应该没问题。也许您正在使用一些 VPS 并且 CPU 与所有其他 VM 共享？您是否运行专用服务器？

另外，请检查您的代码。您可能正在同步做一些应该异步的事情。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-04-15T15:12:02.387

[至少 250k](http://blog.caustik.com/2012/04/10/node-js-w250k-concurrent-connections/)并发连接（对于大多数用例来说，瓶颈是内存）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-15T19:50:29.110

将消息传递给所有客户而不丢弃它对您来说至关重要吗？如果不是，我建议使用 socket.volatile.emit 调用。远程客户端和不稳定的连接可能会出现很多问题。

# android - Android - 当应用程序出现在人们下载的应用程序列表中时如何更改应用程序的名称

> ID：10161799
> 
> 赞同：0
> 
> 时间：2012-04-15T11:54:05.263
> 
> 标签：android

当用户下载并看到它正在浏览他们下载的应用程序后，如何更改手机上显示的应用程序名称？

我怎么知道这个名字现在是如何出现在他们面前的？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T11:57:20.483

你不能动态地改变它。编译后，它将保持不变。但是，您可以为不同的语言环境提供不同的名称。

读[这个](https://stackoverflow.com/questions/5339529/can-you-change-your-app-name-this-under-icon-in-list-of-application-dynamicall)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T12:07:23.233

在您的 android 清单中，您有： `<application android:icon="@drawable/app_icon" android:label="@string/app_name" >` 在项目的 res/values/strings.xml 下，您可以更改： `<string name="app_name">My title</string>`

# java - 如何在 LISP 解释器中实现闭包

> ID：10161802
> 
> 赞同：2
> 
> 时间：2012-04-15T11:55:05.267
> 
> 标签：java, lisp, closures, interpreter

我目前正在研究用 Java 编写的 LISP 解释器。现在我坚持关闭。我想启用这样的闭包：

```
(define a 1000)
(define closure (lambda (a) (lambda (b) (+ a b))))
(define x (closure 10))
(x 20) --> 30 
```

所以，`(x 20)`应该返回`30`。但是，你猜怎么着，它在我的解释器中返回 1020。我认为错误出在我的 lambda 类中。它看起来像这样：

```
public class LLambda extends LOperation {

    private LList parameters;
    private LList definitions;

    public LLambda(LList parameters, LList definitions) {

        this.parameters = parameters;
        this.definitions = definitions;
    } 

    public LObject eval(Environment environment, LObject tokens) {

        environment = environment.copy();

        for(int i = 0; i < parameters.size(); i++) {

            LSymbol key = LSymbol.create(parameters.get(i));
            LObject object = ((LList) tokens).get(i);
            object = object.eval(environment, tokens);  
            environment.put(key, object);
        }

        return definitions.eval(environment, tokens);
    }
} 
```

此类工作正常，但它不存储环境值以启用闭包。有人知道怎么做吗？在哪里做呢？在构造函数中还是在 eval 方法中？

而且，如果我不执行此操作：

```
environment = environment.copy(); 
```

闭包有效，但它破坏了其他一些测试。

谢谢。

（我也可以上传整个源代码或在 GIT 中免费提供）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T04:10:02.370

*此类工作正常，但它不存储环境值以启用闭包。有人知道怎么做吗？在哪里做呢？在构造函数中还是在 eval 方法中？*

是的，类应该存储环境。一般来说，一个成员变量。:)

它应该在构造函数中，因为环境是在构造 lambda 时绑定的，而不是在 eval 时绑定的。

在评估时，原始环境不可用：新环境可用。

如果您的方言是纯粹的词法范围，那么您的 lambda 不需要环境参数。记住，什么是 lambda？它是一个函数。*表单*的评估需要一个环境。*函数*的评估不；函数的评估是一个函数调用，它只需要参数。环境不传递给函数；功能体在具有自己私有环境的封装空间中进行评估。（在 lambda 上存在一个`eval`函数甚至看起来是错误的；您希望它被命名`call`或类似的名称。解释的 lambda*使用*评估器的服务；但它不是一个。）

在您的 lambda 中，操作将是评估 lambda 主体的形式。那些将使用存储的环境（不是传入的任何内容）。

您必须建立一个环境，其中 lambda 参数绑定到参数值。这嵌套在捕获的环境中。（即，一个称为`x`阴影的参数隐藏了一个名为 的捕获变量`x`）。

（您必须已经有某种嵌套环境的方法；即构造一些引用外部环境的新绑定。）

如果除了词法之外还想支持动态范围，则不需要为此传递环境；它可以隐式完成。线程局部变量可以维护动态环境或类似的东西。

（细节取决于解释器的设计；在某些设计中，总是有一些上下文对象被传递（代表解释器）。如果你去，比如说，一个带有显式堆栈的字节码虚拟机，你将需要它。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T15:05:49.307

我强烈建议阅读 Christian Queinnec 的书[Lisp in Small Pieces](http://pagesperso-systeme.lip6.fr/Christian.Queinnec/WWW/LiSP.html)，其中详细描述了许多实现 Lisp（或类似 Scheme）评估器、解释器和编译器的方法。

您需要处理与本地值不同的封闭值。

# jquery - 无法通过 jQuery POST 将参数传递给 Servlet

> ID：10161806
> 
> 赞同：0
> 
> 时间：2012-04-15T11:55:36.987
> 
> 标签：jquery, servlets, jsf-2, servlet-3.0

我正在使用 jQuery 发送 POST 请求：

```
$.post(
'test',
{ foo: 'bar'}
); 
```

我有一个简单的 servlet 来处理它：

```
@WebServlet("/test")
public class TestServlet extends HttpServlet {

  @Override
  protected void doPost(HttpServletRequest req, HttpServletResponse resp)
          throws ServletException, IOException {
      Map<String, String[]> parameterMap = req.getParameterMap();
  }

} 
```

但是 servlet 中的 requestMap 原来是空的。我究竟做错了什么？

**编辑**：忘了提到我从 JSF Facelet 页面调用这个脚本。不要问我为什么要手动发出 Ajax 请求，以及为什么要使用 servlet 来处理它们。说来话长。我知道这不是 JSF 的方式。

在@BalusC 回答之后，我尝试添加这样的 servlet 过滤器：

```
@WebFilter(urlPatterns="/test")
public class TestFilter implements Filter {
    @Override
    public void destroy() { }

    @Override
    public void doFilter(ServletRequest request, ServletResponse response,
            FilterChain chain) throws IOException, ServletException {
        Map<String, String[]> parameterMap = request.getParameterMap();
        chain.doFilter(request, response);
    }

    @Override
    public void init(FilterConfig filterConfig) throws ServletException { }
} 
```

它奏效了！我不仅能够获得过滤器中的参数，而且还可以在 servlet 中访问它们！那么，有人能解释一下这是什么魔法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T13:04:07.353

如果请求-响应链中的某些代码已调用`request.getReader()`或`request.getInputStream()`事先调用，则参数映射将为空。HTTP 请求正文只能被读取和解析一次（客户端不会根据服务器的需要多次重新发送它）。检查所有过滤器。

# r - 中间重新整形

> ID：10161807
> 
> 赞同：6
> 
> 时间：2012-04-15T11:55:52.027
> 
> 标签：r, reshape

作为试点调查的一部分，我向每个 Turker 提供了四个选项中的一组选项。数据如下所示：

```
> so
  WorkerId pio_1_1 pio_1_2 pio_1_3 pio_1_4 pio_2_1 pio_2_2 pio_2_3 pio_2_4
1        1     Yes      No      No      No      No      No     Yes      No
2        2      No     Yes      No      No     Yes      No     Yes      No
3        3     Yes     Yes      No      No     Yes      No     Yes      No 
```

我希望它看起来像这样：

```
WorkerId set pio1 pio2 pio3 pio4
       1   1  Yes   No   No   No
       1   2   No   No  Yes   No
... 
```

我可以通过多种方式来解决这个问题，但都不是很优雅：

*   用正则表达式和反向引用交换数字的顺序，然后使用 reshape()
*   编写我自己的小函数来解析下划线之间的第一个数字，然后将其重新整形
*   拆分然后堆叠列（依赖于正确的排序）

但在我看来，所有这些都忽略了你可能称之为“双宽”格式的数据有自己的结构的想法。我很想为此使用 reshape2 包，但是尽管使用 cast() 生成了数据，但我看不到任何可以帮助我真正融化这个 data.frame 的选项。

欢迎提出建议。

```
so <- structure(list(WorkerId = 1:3, pio_1_1 = structure(c(2L, 1L, 
2L), .Label = c("No", "Yes"), class = "factor"), pio_1_2 = structure(c(1L, 
2L, 2L), .Label = c("No", "Yes"), class = "factor"), pio_1_3 = structure(c(1L, 
1L, 1L), .Label = c("No", "Yes"), class = "factor"), pio_1_4 = structure(c(1L, 
1L, 1L), .Label = "No", class = "factor"), pio_2_1 = structure(c(1L, 
2L, 2L), .Label = c("No", "Yes"), class = "factor"), pio_2_2 = structure(c(1L, 
1L, 1L), .Label = c("No", "Yes"), class = "factor"), pio_2_3 = structure(c(2L, 
2L, 2L), .Label = c("No", "Yes"), class = "factor"), pio_2_4 = structure(c(1L, 
1L, 1L), .Label = "No", class = "factor")), .Names = c("WorkerId", 
"pio_1_1", "pio_1_2", "pio_1_3", "pio_1_4", "pio_2_1", "pio_2_2", 
"pio_2_3", "pio_2_4"), row.names = c(NA, 3L), class = "data.frame") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T12:40:20.543

如果我们调用您的原始数据集 dat，这将使用 base：

```
dat2 <- reshape(dat, 
    varying=list(pio_1= c(2, 6), pio_2= c(3,7), pio_3= c(4,8), pio_4= c(5,9) ),
    v.names=c(paste0("pio_",1:4)), 
    idvar = "WorkerId",
    direction="long", 
    timevar="set") 
row.names(dat2) <- NULL
dat2[order(dat2$WorkerId, dat2$set), ] 
```

产生：

```
 WorkerId set pio_1 pio_2 pio_3 pio_4
1        1   1   Yes    No    No    No
2        1   2    No    No   Yes    No
3        2   1    No   Yes    No    No
4        2   2   Yes    No   Yes    No
5        3   1   Yes   Yes    No    No
6        3   2   Yes    No   Yes    No 
```

编辑：（好吧，我忍不住想尝试让它更容易自动化）

```
y <- do.call('rbind', strsplit(names(dat)[-1], "_"))[, c(1, 3, 2)]
names(dat) <- c(names(dat)[1], paste0(y[, 1], "_", y[, 2], ".", y[, 3]))

dat2 <- reshape(dat, 
    varying=2:9, 
    idvar = "WorkerId",
    direction="long", 
    timevar="set")
row.names(dat2) <- NULL
dat2[order(dat2$WorkerId, dat2$set), ] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-15T13:15:23.970

我建议对你的名字做一些 gsub 以使它们变成 R 更喜欢的形式，换句话说，时间变量是最后一项，而不是中间项，并带有“。” 作为默认分隔符。

试试这个：

```
names(so) = gsub("([a-z])_([0-9])_([0-9])", "\\1_\\3\\.\\2", names(so))
so.l = reshape(so, direction="long", varying=2:9, timevar="set", idvar=1) 
```

然后，如果要按 WorkerId 排序：

```
so.l = so.l[order(so.l$WorkerId), ] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-16T08:10:41.673

Here's another solution using `reshape2` and `stringr`

```
melt.wide = function(data, id.vars, new.names) {
  require(reshape2)
  require(stringr)
  data.melt = melt(data, id.vars=id.vars)
  new.vars = data.frame(do.call(
    rbind, str_extract_all(data.melt$variable, "[0-9]+")))
  names(new.vars) = new.names
  cbind(data.melt, new.vars)
} 
```

Then, you use it like this:

```
> so.long = melt.wide(so, id.vars=1, new.names=c("set", "option"))
> dcast(so.long, WorkerId + set ~ option)
  WorkerId set   1   2   3  4
1        1   1 Yes  No  No No
2        1   2  No  No Yes No
3        2   1  No Yes  No No
4        2   2 Yes  No Yes No
5        3   1 Yes Yes  No No
6        3   2 Yes  No Yes No 
```

I think that using `stringr` might prove to be a more simple solution than those in the functions that have been suggested so far.

## A "triple wide" example

Here's why I like this solution: it also works if your data is, say, triple wide. Here's an example, (with data modified from [here](http://www.ats.ucla.edu/stat/stata/faq/doublewide.htm)):

```
triplewide = structure(list(ID = 1:4, w1d1t1 = c(4L, 3L, 2L, 2L), w1d1t2 = c(5L, 
4L, 3L, 3L), w1d2t1 = c(6L, 5L, 5L, 4L), w1d2t2 = c(5L, 4L, 5L, 
2L), w2d1t1 = c(6L, 5L, 4L, 3L), w2d1t2 = c(5L, 4L, 5L, 5L), 
    w2d2t1 = c(6L, 3L, 6L, 3L), w2d2t2 = c(7L, 4L, 3L, 2L)), .Names = c("ID", 
"w1d1t1", "w1d1t2", "w1d2t1", "w1d2t2", "w2d1t1", "w2d1t2", "w2d2t1", 
"w2d2t2"), class = "data.frame", row.names = c(NA, -4L)) 
```

This is what it looks like to start with:

```
> triplewide
  ID w1d1t1 w1d1t2 w1d2t1 w1d2t2 w2d1t1 w2d1t2 w2d2t1 w2d2t2
1  1      4      5      6      5      6      5      6      7
2  2      3      4      5      4      5      4      3      4
3  3      2      3      5      5      4      5      6      3
4  4      2      3      4      2      3      5      3      2 
```

A variable name like `w1d1t1` means "week 1, day 1, test 1". Let's say that your expected "tidy data" should be a dataset with the columns "ID", "week", "day", "trial 1", and "trial 2", then you can use the function as follows:

```
> triplewide.long = melt.wide(triplewide, id.vars="ID",
+                             new.names=c("week", "day", "trial"))
> dcast(triplewide.long, ID + week + day ~ trial)
   ID week day 1 2
1   1    1   1 4 5
2   1    1   2 6 5
3   1    2   1 6 5
4   1    2   2 6 7
5   2    1   1 3 4
6   2    1   2 5 4
7   2    2   1 5 4
8   2    2   2 3 4
9   3    1   1 2 3
10  3    1   2 5 5
11  3    2   1 4 5
12  3    2   2 6 3
13  4    1   1 2 3
14  4    1   2 4 2
15  4    2   1 3 5
16  4    2   2 3 2 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-15T13:40:59.330

I am not sure if this is too obvious, but here goes. It should be self-explanatory. Pass in your `so` dataframe and it returns the reshaped data.

```
library("reshape2")

reshape.middle <- function(dat) {
    dat <- melt(so, id="WorkerId")
    dat$set <- substr(dat$variable, 5,5)
    dat$name <- paste(substr(dat$variable, 1, 4),
                      substr(dat$variable, 7, 7),
                      sep="")
    dat$variable <- NULL

    dat <- melt(dat, id=c("WorkerId", "set", "name"))
    dat$variable <- NULL

    return(dcast(dat, WorkerId + set ~ name))
}

so # initial form
so <- reshape.middle(so)
so # as needed 
```

Hope this helps.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-16T01:39:44.570

Here's what I eventually went with, largely based off @gauden 's approach. In re-reading Hadley's tidy data pdf, it turns out he advises a similar course.

```
melt.wide <- function(data, id.vars, new.names, sep=".", variable.name="variable", ... ) {
  # Guess number of variables currently wide
  colnames(data) <- sub( paste0(sep,"$"), "",  colnames(data) )
  wide.vars <- colnames(data)[grep( sep, colnames(data) )]
  n.wide <- str_count( wide.vars, sep )
  stopifnot(length(new.names)==unique(n.wide))
  # Melt
  data.melt <- melt(data,id.vars=id.vars,measure.vars=wide.vars,...)
  new <- stack.list(str_split(data.melt$variable,sep))
  colnames(new) <- c(variable.name,new.names)
  data.melt <- subset(data.melt,select=c(-variable))
  cbind(data.melt,new)
}

# Stacks lists of data.frames (e.g. from replicate() )
stack.list <- function( x, label=FALSE, ... ) {
  ret <- x[[1]]
  if(label) { ret$from <- 1 }
  if(length(x)==1) return(ret)
  for( i in seq(2,length(x)) ) {
    new <- x[[i]]
    if(label) { new$from <- i }
    ret <- rbind(ret,new)
  }
  return(ret)
}

> dat<-melt.wide(so,id.vars="WorkerId",new.names=c("set","option"),sep="_")
> dcast(dat, WorkerId + set ~ option)
  WorkerId set   1   2   3  4
1        1   1 Yes  No  No No
2        1   2  No  No Yes No
3        2   1  No Yes  No No
4        2   2 Yes  No Yes No
5        3   1 Yes Yes  No No
6        3   2 Yes  No Yes No 
```

# java - 尝试使用 logback syslog appender 调试问题而不更新 syslog

> ID：10161809
> 
> 赞同：10
> 
> 时间：2012-04-15T11:55:55.807
> 
> 标签：java, logback, syslog

我正在使用 logback 来更新 syslog，这就是我配置 appender 的方式：

```
<appender name="SYSLOG" class="ch.qos.logback.classic.net.SyslogAppender">
        <syslogHost>localhost</syslogHost>
        <facility>LOCAL0</facility>
        <suffixPattern>[%thread] %logger %msg</suffixPattern>
    </appender> 
```

我更新了 rsyslog.conf 以监听 UDP 事件，取消注释以下行：

```
# Provides UDP syslog reception
$ModLoad imudp.so
$UDPServerRun 514 
```

conf 更改后重新启动 syslog 守护程序。

在我所有的测试盒上，它似乎工作得很好！但是，我的进程没有更新系统 syslog 上的一个（其他东西正在更新它就好了），我想知道如何调试这个问题？有什么我应该调查的吗？

感谢您的任何想法

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-15T19:22:48.083

当然。松散地按顺序尝试以下 4 个测试：

**1\. 测试 logback**：显而易见的一个：添加一个[FileAppender](http://logback.qos.ch/manual/appenders.html#FileAppender)作为第二个 appender 并确保事件出现在那里。您的帖子暗示“它”在 dev 中有效，但我不确定它是 logback 还是 appender，并且配置片段没有`appender-ref`将事件发送到`SYSLOG`.

如果您`FileAppender`什么也没收到，那是应用程序/环境问题，或者此服务器未生成提供给 appender 的事件。

**2.确认消息正在生成**：假设`FileAppender`收到消息但系统日志没有，运行：

```
tcpdump -n -i lo -X -s 1500
```

.. 输出 UDP 数据包的完整负载`lo`。让您的应用生成日志消息。您应该看到至少 1 个数据包发往`127.0.0.1:514`. 如果你不这样做，那就是发件人。如果你这样做了，那就是 rsyslog 配置。

**3\. 确认 rsyslog 绑定到 514 端口**：

```
lsof -i:514
```

或者如果您没有`lsof`并且确定另一个进程未绑定到 514：

```
netstat -ln | grep 514 
```

**4\. 查看 rsyslog 接收**到的内容：如果正在向端口 514 发送事件，则在停止实时 rsyslogd 后，以调试模式重新启动它并连接到终端：

```
/etc/init.d/rsyslog stop
rsyslogd -d 
```

您应该看到事件到达。如果这些都没有发现问题，那就是离奇的道路。我在已知良好的 J2EE 和 syslog 环境中有一个可用的[logback 配置。](http://wiki.cloudbees.com/bin/view/RUN/Logging+with+Logback+and+Papertrail)不过，希望上面的一件事能做到这一点。

# c# - 为什么我不能在 linq 查询中调用函数？

> ID：10161813
> 
> 赞同：2
> 
> 时间：2012-04-15T11:56:48.867
> 
> 标签：c#, .net, linq, linq-to-sql

这是我的 linq 查询（Linq to Sql）：

```
pagina = (from Pagine page in kDataBase.Pagines
          where prova(page.title_it) == urlSuddivisa[i].ToLower()
          select page).FirstOrDefault(); 
```

这是我调用的函数（在同一个类中）：

```
private string prova(string example)
{
    return example;
} 
```

它说 ：

> 方法'System.String prova（System.String）不支持转换为sql。

我哪里错了？我该如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T12:02:55.867

您的 linq 查询表达式在运行时被转换为 sql，框架不知道如何将 prova 方法调用转换为适当的 sql。相反，您可以执行以下操作：

```
pagina = (from Pagine page in kDataBase.Pagines select page).ToList().Where(p => prova(p.title_it) == urlSuddivisa[i].ToLower()).FirstOrDefault(); 
```

这将首先通过 toList 将页面拉入内存，然后可以评估 prova 方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-15T11:58:43.003

由于 linq 查询被转换为针对您的 dB 运行的 SQL 查询，因此无法将您的自定义函数转换为 SQL 查询。

解决问题的替代方法

*   使用存储过程并阅读有关在 linq 中使用存储过程的信息
*   将您的数据从 SQL 检索到内存，然后根据您的函数对其进行过滤。显然，这里的缺点是您将从数据库中检索的行数比所需的多得多

    `var paginas=(from Pagine page in kDataBase.Pagines).ToList().Where(p =>prova(p.title_it) == urlSuddivisa[i].ToLower()).FirstOrDefault();`

    是你想要的。

在旁注中，我猜您的方法`prova`不仅仅是返回字符串，否则该函数完全没用，您也可以摆脱该函数。此外，我相信您正在向您使用计数器的数组的数据库 cos 发起多个查询，`i`您始终可以使用`IN`查询并绕过它，记住`IN`查询中元素数量的限制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-15T11:59:06.127

使用get 解析为 SQL 查询`linq to sql`，`Expression tree`而不是像使用`linq to objects`.

您的 ORM 提供者不知道如何将方法转换为 SQL。

您不应该在`linq to SQL` `LINQ`查询中使用方法。

# php - Netbeans PHP/javascript 高亮显示

> ID：10161818
> 
> 赞同：4
> 
> 时间：2012-04-15T11:57:38.317
> 
> 标签：php, javascript, netbeans, highlighting

在将 PHP 与 Javascript 混合时，我一直在寻找解决 NetBeans (7.1.1) 代码突出显示错误错误的解决方案。我也使用 Notepad++，它对此没有任何问题。

例子：

```
function showUpload<?php echo $upload;?>(file) { /* JS-code */ } 
```

或者：

```
$('.option-help').qtip({
    content: function(api) { return $(this).parent().attr('data-tip'); },
<?php if ($help == 'icon') { ?>
    show: { event: 'click' },
<?php } ?>
    position: { my: 'bottom left', at: 'top left', of: $(this) }
}); 
```

我确实找到了一些[解决方法](https://stackoverflow.com/questions/3882790/how-do-i-tell-netbeans-that-a-section-of-code-is-javascript "问题 3882790")，但我拒绝为我的 IDE 更改代码！！！（IDE 应该帮助我编写代码，而不是让事情变得更困难）

有谁知道这个问题的实际解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-01-29T19:33:17.023

如果您在文件中仅使用 JavaScript + PHP 组合（没有 HTML），只需打开要突出显示 JavaScript 语法的文件，然后添加以下行：

```
//<script type="text/javascript"> 
```

在打开第一个 PHP 标记之前，在页面顶部，如下所示：

```
//<script type="text/javascript">
<?php
/*The rest of the code..*/
?> 
```

此文件中的所有 JavaScript 代码都应正确突出显示。

如果您在文件中间的某处有 HTML 代码，则需要在 HTML 代码之前关闭 JavaScript 标记，并在 HTML 代码之后重新打开它，如下所示：

```
//<script type="text/javascript">
<?php
/*The rest of the code..JavaScript + PHP*/

//</script>
<h1>HTML code</h1><!--HTML code only-->
<p>Bla bla..</p>
//<script type="text/javascript">

/*JavaScript + PHP code again*/

?> 
```

如果您不希望将这些注释打印到最终的 HTML 文档中，您可以在文档顶部创建永远不会被您使用的假 PHP 函数，只有 IDE 使用：

```
<?php
function higlightJavaScriptCode(){
    ?>
    //<script type="text/javascript">
    <?php
}
/*The rest of the code..*/
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-03-05T18:50:53.957

@gradosevic 在上面钉了它，我将添加我自己的超紧凑版本，它不会向浏览器输出任何内容：

```
// Fix Netbeans' jQuery highlighting in mixed PHP/JS. See https://stackoverflow.com/a/21440810/209859
function higlightJavaScriptCode(){?>//<script type="text/javascript"><?php } 
```

我想唯一的问题是每个项目只能有一个，或者你必须开始命名它们。

# qt - Qt：从listView中拖动项目时的KeyPressEvent

> ID：10161824
> 
> 赞同：2
> 
> 时间：2012-04-15T11:58:55.243
> 
> 标签：qt, drag-and-drop, keypress

我有一种情况，在将项目从 listView 拖动到我的小部件时，我需要处理 KeyPress。我已经覆盖了我的 listView 中的**KeyPressEvent()**函数，但是在拖动项目并按下任意键时，不会触发 keyPressEvent。但是，如果我按下键盘上的“escape”键，QDrag 图像 ior pixmap 就会消失。 拖动项目时我需要处理**keyPressEvent()**

提前致谢 ！！！！

# ruby-on-rails - 自动heroku每日postgres数据库复制

> ID：10161825
> 
> 赞同：2
> 
> 时间：2012-04-15T11:59:02.730
> 
> 标签：ruby-on-rails, database, postgresql, heroku, database-backups

我有 2 个 heroku 应用程序。`myapp`两者`myapp-sandbox`都是同一个存储库的分支，并且具有几乎相同的代码库。我目前有插件`pgbackups`进行每日备份，`myapp`它是实时生产站点。进行此备份后，我想自动重置数据库`myapp-sandbox`并恢复备份`myapp`。正如您可能已经猜到的那样，只是为它的 api`myapp-sandbox`提供了一个开发沙箱。`myapp`

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T21:15:05.757

您可以将 ssh、pg_dump 和 pg_restore 组合到一个管道中，一次性完成此操作。在 myapp-sandbox 所在的盒子上运行类似的东西（可能需要更多的调整，例如将最后的数据库重命名为 myapp-sandbox，因为它将使用原始名称重新创建它）：

```
ssh myapp.exmaple.com pg_dump -c -C dbname | pg_restore 
```

# objective-c - 在后台播放一系列音频文件

> ID：10161827
> 
> 赞同：0
> 
> 时间：2012-04-15T11:59:25.077
> 
> 标签：objective-c, ios, background, avfoundation, avaudioplayer

在我的应用程序中，我有一个**AVAudioPlayer**实例，它播放一系列 mp3，通过以下方式切换到下一个`initWithData`：

我想让用户即使关闭屏幕或进入后台也能继续收听播放器。我知道，`remotecontrolevents`当用户点击它时，我可以用来切换到其他音频，但我可以让它自动切换，就像在 iPod 播放器中一样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T13:37:45.303

您需要使用`AVAudioPlayerDelegate`协议。首先将其包含在您的界面中：

```
@interface MyAppViewController : UIViewController <AVAudioPlayerDelegate> {
    AVAudioPlayer   *yourPlayer;
}

@property (nonatomic, retain) AVAudioPlayer *yourPlayer; 
```

然后在您的实现中：

```
- (void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)player successfully:(BOOL)flag
{
//This method is called once the file has finished playing
//Insert code here to play the next file
} 
```

不要忘记在你的方法中设置`delegate`of `yourPlayer`to （或者你决定把它放在哪里）：`self``viewDidLoad`

```
- (void)viewDidLoad {
    [super viewDidLoad]

    [[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayback error:nil];
    [[AVAudioSession sharedInstance] setActive: YES error: nil];

    if ([[UIApplication sharedApplication] respondsToSelector:@selector(beginReceivingRemoteControlEvents)]){
        [[UIApplication sharedApplication] beginReceivingRemoteControlEvents];
        [self becomeFirstResponder];
    }

    self.yourPlayer = [[AVAudioPlayer alloc] init];
    self.yourPlayer.delegate = self;
} 
```

您还需要将info.plist 中的*所需***背景模式**更改为**App 播放音频**

 ***不要忘记取消注册远程控制事件（`viewDidUnload`）：

```
[[UIApplication sharedApplication] endReceivingRemoteControlEvents] 
```***

# iphone - 如何在表格视图单元格（每一行）中添加文本字段并为每个文本字段设置标签以访问它的文本

> ID：10161828
> 
> 赞同：3
> 
> 时间：2012-04-15T12:00:11.603
> 
> 标签：iphone, ios, uitableview, uitextfield

如何在表格视图单元格中添加文本字段（在每一行上）。此文本字段将位于每行的中间。并且还在单元格的每个文本字段上设置标签以访问其文本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T07:31:05.130

当然可以，举个小例子：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"test"];
    if(cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"test"] autorelease];

        UITextView *tv = [[UITextView alloc] initWithFrame:CGRectMake(0, (cell.contentView.bounds.size.height-30)/2, cell.contentView.bounds.size.width, 30)];
        [cell.contentView addSubview:tv];
        [tv setDelegate:self];
        tv.tag = indexPath.row;
    }

    return cell;
}

...
- (void)textViewDidEndEditing:(UITextView *)textView {
    NSLog(@"%d", textView.tag);

    [textView resignFirstResponder];
}
... 
```

# iphone - 如何在键入时获取当前的搜索栏字符串

> ID：10161833
> 
> 赞同：8
> 
> 时间：2012-04-15T12:00:54.590
> 
> 标签：iphone, objective-c, xcode, ios5

在按下搜索栏时，我想获取已经输入的字符串。为此，我目前正在使用这种方法：

```
- (BOOL)searchBar:(UISearchBar *)searchBar shouldChangeTextInRange:(NSRange)range     replacementText:(NSString *)text
{
    NSLog(@"String:%@",mainSearchBar.text);
    return YES;
} 
```

但它正在返回前一个字符串。例如，我输入“jumbo”，它显示 jum，当我按退格键删除一项并使其“jumb”时，它显示 jumbo。即搜索栏上的前一个字符串。

我应该怎么做才能得到当前的字符串？请帮忙。谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-15T12:06:39.540

在该方法中，您可以使用以下方法获取输入的文本：

```
NSString* newText = [searchBar.text stringByReplacingCharactersInRange:range withString:text] 
```

**斯威夫特 3：**

```
let newText = (searchBar.text ?? "" as NSString).replacingCharacters(in: range, with: text) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-15T12:39:12.833

从中检索新文本的最方便的委托方法是：

```
- (void)searchBar:(UISearchBar *)searchBar textDidChange:(NSString *)searchText 
```

两者都`[searchBar text]`将`searchText`返回新输入的文本。 `shouldChangeTextInRange`故意报告旧文本，因为它允许您在编辑发生之前取消编辑。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-15T12:06:51.350

尝试：

```
 - (BOOL)searchBar:(UISearchBar *)searchBar shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text
    {
        NSString *str = [mainSearchBar.text stringByReplacingCharactersInRange:range withString:text];
        NSLog(@"String:%@",str);
        return YES;
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-12-04T23:50:46.030

斯威夫特 3 版本：

```
func searchBar(_ searchBar: UISearchBar, textDidChange searchText: String){
    print("searchText: \(searchText)")
} 
```

只要搜索栏中的文本发生更改，就会触发。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-03-08T07:24:29.470

**斯威夫特 4.2**

```
func searchBar(_ searchBar: UISearchBar, shouldChangeTextIn range: NSRange, replacementText text: String) -> Bool {
        let newString = NSString(string: searchBar.text!).replacingCharacters(in: range, with: text)

        return true
    } 
```

# java - Eclipse：使用里面的类更改现有包的名称

> ID：10161840
> 
> 赞同：45
> 
> 时间：2012-04-15T12:02:15.807
> 
> 标签：java, eclipse

在 Eclipse 中，如果包有名称`(default package)`并且里面有类，是否可以更改包的名称？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-04-15T12:08:03.310

在我使用的 Eclipse 版本（Indigo 服务版本 1）中，默认包没有出现“重命名”选项（与其他包不同） - 但如果您选择所有类，然后右键单击并选择“移动”，您可以将它们放入新包装中。

（据我所知，Rename 选项用于在*不*更改包的情况下重命名类，但 Move 当然适用于在包*之间*移动。）

过程截图：

**原来的情况**

![前](../Images/47763ea03d7743673f28343885af677a.png)

**选择所有类并显示上下文菜单的重构部分**

![在此处输入图像描述](../Images/b4c08a8e596b2c6328006cfdc59c7553.png)

**选择“移动”，单击“创建包”并输入名称（在本例中为 mypackage）**

![移动对话框](../Images/5058667b32045d384b56eb1ebc20b2fb.png)

**最终结果**

![后](../Images/e67ec7a1f70155f0956d15f6e175eb64.png)

或者，如果您想将它们移动到现有包中，您只需拖放类即可。

对于那些在包上建议 Refactor -> Rename 的人，这是一个屏幕截图，显示在我的机器上不起作用*：*

![没有重命名选项](../Images/f70fb8c199a96be8e12b647d2b5e72a0.png)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-15T12:06:27.523

是的。

只需右键单击该类并选择 Refactor->Rename，或`package foo.bar`在顶部插入适当的并使用 Ctrl-1 进行快速修复。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-19T13:19:34.227

在 SRC 文件夹中创建一个新包，然后将您的类文件拖到新包中。这样默认包名称就会更改

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-19T07:17:24.507

另一种选择是进入工作区中相关项目文件夹中的 src 文件夹，并在那里创建一个新文件夹。将该文件夹命名为您想要的任何包名称，并将所有 .java 文件放入该文件夹中。刷新 eclipse，关闭 .java 文件并从新位置打开。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-13T19:14:40.137

我在“Java 包”下创建了一个具有所需名称的新包。然后从默认拖放源文件。IDE 会要求重构；然后继续它。默认包消失，源文件更新。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-06-22T19:49:31.877

Step 1\. 在同一个项目中新建一个包

步骤 2\. 单击保持并将类从默认包删除到新包

# ruby - 二维数组的平均值

> ID：10161841
> 
> 赞同：0
> 
> 时间：2012-04-15T12:02:21.950
> 
> 标签：ruby, arrays, multidimensional-array

嘿，我有一个数组“a”，如下所示：

```
[[5], [7], [8]] # result of "puts a.to_s" 
```

如何计算数组的平均值。我已经有一种适用于一维普通数组的方法：

```
def average
 return self.reduce(:+)/self.length.to_f
end 
```

如何将上面的数组转换为普通数组，或者如何将该方法用于更多维数组？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T12:04:44.677

使用`Array#flatten`您可以使用预定义的平均方法。

# flash - Actionscript 点击背景/舞台

> ID：10161843
> 
> 赞同：0
> 
> 时间：2012-04-15T12:02:26.820
> 
> 标签：flash, actionscript-2, flash-cs5

我正在尝试这个，但它不起作用：

```
_root.onPress = function(){
..
} 
```

我想点击任何我想要的地方，不仅在对象中，有什么办法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T12:20:24.563

“舞台”不会触发`onPress`AS2 中的事件（因为它假定没有任何内容可按 - 例如按钮或 MovieClip 或其他任何东西）。但是您仍然可以`onMouseDown`像这样捕获：

```
_root.onMouseDown = function(){
    trace('hello');
}; 
```

# c# - System.StackOverflowException 递归过多

> ID：10161845
> 
> 赞同：0
> 
> 时间：2012-04-15T12:02:49.520
> 
> 标签：c#, recursion, stack-overflow

我正在做一个算法课，我正在构建[Kosaraju 算法的实现](http://en.wikipedia.org/wiki/Kosaraju%27s_algorithm)作为作业的一部分。

我有几个小数据集，其中算法返回正确的结果并且性能良好。但是，当我尝试我的家庭作业时，它有 5,105,043 个边和 875,714 个节点，我得到一个 System.StackOverflowException，这似乎是因为递归太多。

然而，这个递归是解决这个问题所必需的。那么我要问的是有没有办法配置.Net 以允许更多递归？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T12:19:25.220

> 那么我要问的是有没有办法配置.Net 以允许更多递归？

递归限制基于为当前线程分配的堆栈大小。这可以[通过程序的 editbin /stack 进行更改](http://www.atalasoft.com/cs/blogs/rickm/archive/2008/04/22/increasing-the-size-of-your-stack-net-memory-management-part-3.aspx)，或者在线程构建时为特定线程进行编辑。

话虽如此，任何[递归算法都可以改为使用堆栈](http://haacked.com/archive/2007/03/04/Replacing_Recursion_With_a_Stack.aspx)。随着时间的推移，这可能会证明更易于维护，因为它不再依赖于有一个非常大的堆栈来适当地处理。

# matlab - 为什么crossvalind会失败？

> ID：10161848
> 
> 赞同：1
> 
> 时间：2012-04-15T12:02:56.523
> 
> 标签：matlab

我在非常小的数据上使用交叉 valind 函数......但是我观察到它给了我相同的错误结果。这应该发生吗？

我有 Matlab R2012a，这是我的输出

```
crossvalind('KFold',1:1:11,5)

ans =

 2
 5
 1
 3
 2
 1
 5
 3
 5
 1
 5 
```

注意没有`set 4`.. 这是一个错误吗？我预计每组至少有 2 个元素，但它给了我一个 0 ......而且它发生了很多，因为这些值在集合中分布不均匀。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T12:30:45.530

[crossvalind](http://www.mathworks.co.uk/help/toolbox/bioinfo/ref/crossvalind.html)的帮助说您使用的形式是：`crossvalind(METHOD, GROUP, ...)`. 在这种情况下，GROUP 是例如您的数据的类标签。所以 1:11 作为第二个论点在这里令人困惑，因为它表明没有两个示例具有相同的标签。我认为这是非常不寻常的，如果函数做了一些奇怪的事情，你不应该感到惊讶。

我试着做：

```
numel(unique(crossvalind('KFold', rand(11, 1) > 0.5, 5))) 
```

结果它可靠地给出`5`了，这是我所期望的；我的示例将对应于一个二分类问题（我猜想，作为一般规则，你会想要类似的东西`numel(unique(group)) <= numel(group) / folds`） - 我的假设是它试图在第 K 折叠中拥有每个类的一个示例，并且在至少有 2 个示例，折叠大小之间的差异不超过 1 - 但我没有查看代码来验证这一点。

您的意思可能是：

```
crossvalind('KFold', 11, 5); 
```

这将为 11 个数据点计算 5 次折叠 - 这不会尝试对标签进行任何巧妙的处理，因此您可以确定会有 K 次折叠。

但是，在您的问题中，如果您的数据点确实很少，那么最好进行留一交叉验证，您可以这样做：

```
crossvalind('LeaveMOut', 11, 1); 
```

虽然更好的方法是：

```
for leave_out=1:11
  fold_number = (1:11) ~= leave_out;
  <code here; where fold_number is 0, this is the leave-one-out example. fold_number = 1 means that the example is in the main fold.>
end 
```

# php - 自定义 mvc 应用程序中的 htaccess 文件

> ID：10161851
> 
> 赞同：-2
> 
> 时间：2012-04-15T12:03:39.440
> 
> 标签：php, .htaccess, url-rewriting

我正在用 php 构建自己的 MVC 应用程序。index.php 将是前端控制器。在 index.php 中，我将使用 $_SERVER['QUERY_STRING'] 获取参数，所以我需要我的

.htaccess 文件将 /attr1/attr2/attr3 重定向到 index.php?attr1/attr2/attr3。

（$_SERVER['PHP_SELF'] 不能正常工作）

如果我的 htaccess 文件（apache 服务器）是

```
<IfModule mod_rewrite.c>
RewriteEngine on
RewriteRule ^(.*)$ index.php?$1
</IfModule> 
```

query_string 输出 index.php 但如果我通过 localhost/something/attr1/attr2/attr3 访问 url 并且 .htaccess 是

```
<IfModule mod_rewrite.c>
RewriteEngine on
RewriteRule ^(something)\/(.*)$ index.php?$2
</IfModule> 
```

query_string 正在打印 attr1/attr2/attr3

怎么回事？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T12:09:26.187

我喜欢这样：

```
<IfModule mod_rewrite.c>
    RewriteEngine on
    RewriteBase /
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php?url=$1 [NC]
</IfModule> 
```

然后 url 将在 $_GET 数组中（第 4 行和第 5 行确保该规则在该路径中没有实际文件时适用）

# mysql - 从mysql表中选择每隔一行作为男性/女性

> ID：10161852
> 
> 赞同：1
> 
> 时间：2012-04-15T12:03:53.200
> 
> 标签：mysql, sql, select, modulo

我有一个表格，其中包含性别编码为 0 和 1 的人。我需要每隔一行选择男性/女性。我以为我可以通过使用模数和性别代码 0 和 1 以某种方式管理这个问题，但我还没有设法弄清楚......

我正在寻找的结果如下所示：

```
+-----+--------+--------+
| 行 | 性别 | 姓名 |
+-----+--------+--------+
| 1 | 女| 丽莎 |
| 2 | 男| 格雷格 |
| 3 | 女| 玛丽 |
| 4 | 男| 约翰 |
| 5 | 女| 珍妮 |
+-----+--------+--------+

```

等等

另一种方法是通过合并 2 个单独的数组在 PHP 中完成，但我真的很喜欢它作为 SQL 查询......

任何建议表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T12:50:14.043

做两个子查询来选择男性和女性。使用排名函数来枚举它们。

```
Males:
1 | Peter
2 | John
3 | Chris

Females:
1 | Marry
2 | Christina
3 | Kate 
```

然后按 x10 进行多人游戏排名结果，女性加 5。所以你有这个：

```
Males:
10 | Peter
20 | John
30 | Chris

Females:
15 | Marry
25 | Christina
35 | Kate 
```

然后执行 UNION ALL 并按新排序顺序/新 ID 排序。

一起应该是这样的（伪代码）

```
SELECT
Name
FROM
(subquery for Males: RANK() AS sortOrd, Name)
UNION ALL
(subquery for Females: RANK()+1 AS SortOrd, Name)
ORDER BY SortOrd 
```

结果应该是这样的：

```
Males and Females:
10 | Peter
15 | Marry
20 | John
25 | Christina
30 | Chris
35 | Kate 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T13:16:24.280

找到[Emulate Row_Number()](http://www.artfulsoftware.com/infotree/queries.php?&bw=1440#1098)并针对您的情况进行了一些修改。

```
set @rownum := 0;
set @pg := -1;

select p.name, 
       p.gender
from
  (
    select name,
           gender,
           @rownum := if(@pg = gender, @rownum+1, 1) as rn, 
           @pg := gender as pg 
    from persons
    order by gender
  ) as p
order by p.rn, p.gender 
```

试试[SQL Fiddle](http://sqlfiddle.com/#!2/05b02/8)

注意：从[9.4 开始。用户定义的变量](http://dev.mysql.com/doc/refman/5.0/en/user-variables.html)

> 作为一般规则，您永远不应为用户变量赋值并在同一语句中读取该值。您可能会得到预期的结果，但这不能保证。

我将由您决定是否可以使用它。我不使用 MySQL，所以我不能真正告诉你是否应该担心。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-15T13:34:27.753

类似于 Mikael 的解决方案，但无需多次订购结果集 -

```
SELECT *
FROM (
    SELECT people.*,
        IF(gender=0, @mr:=@mr+1, @fr:=@fr+1) AS rank
    FROM people, (SELECT @mr:=0, @fr:=0) initvars
) tmp
ORDER BY rank ASC, gender ASC; 
```

为了避免必须同时订购内部和外部选择，我在内部选择中使用了单独的计数器（@mr - 男性等级，@fr - 女性等级）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-15T12:57:42.800

> 我有一个表格，其中包含性别编码为 0 和 1 的人员

那你为什么要对结果集中的行顺序做出假设呢？在我看来，将 0/1 转换为“男性”/“女性”要强大得多：

```
select name, case gender when 0 then 'male' else 'female' end
from Person 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-12-15T13:05:14.967

```
SELECT alias.*, ROW_NUMBER() OVER (PARTITION BY GENDER ORDER BY GENDER) rnk
FROM TABLE_NAME
ORDER BY rnk, GENDER DESC 
```

# objective-c - 如何控制 MPMoviePlayerController 的播放时间？

> ID：10161854
> 
> 赞同：0
> 
> 时间：2012-04-15T12:04:32.090
> 
> 标签：objective-c, ios, mpmoviewcontroller

我正在开发一个使用 MPMoviePlayerController 播放视频的应用程序。

现在我正在使用自定义视图来显示播放器控制器。我使用滑块来显示视频传递的持续时间。现在如果我想再次播放视频的某些部分，我需要滑动我的滑块后退 5-6 秒，那么如何将视频的播放与那个相关联？

我被这个问题困住了..任何帮助将不胜感激..在此先感谢。

什雷亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T10:56:33.887

我通过以下代码使其工作..

它可能对其他人有帮助..这是我的解释

在您的 .h 文件中创建一个 UISlider 对象，并在 .m 文件中添加以下代码以使其工作，

```
 self.slider_Audio = [[MPVolumeView alloc] initWithFrame:
    CGRectMake(VolumeSliderX,VolumeSliderY,VolumeSliderWidth,VolumeSliderHeight)];
    [self.slider_Audio sizeToFit];

    //if you want it vertical

    CGAffineTransform trans = CGAffineTransformMakeRotation(M_PI * -0.5);
    self.slider_Audio.transform = trans;
    self.slider_Audio.hidden = YES;

    [self.view addSubview:self.slider_Audio]; 
```

然后运行你的代码..

# c# - 如何检测 WPF 中的 TreeNode 扩展？

> ID：10161856
> 
> 赞同：0
> 
> 时间：2012-04-15T12:05:26.250
> 
> 标签：c#, wpf, xaml, treeview

我正在使用 MVVM 将分层树结构绑定到 WPF 中的 TreeView。我正在使用 XAML 代码，如下所示：

```
<TreeView ScrollViewer.VerticalScrollBarVisibility="Auto"
        BorderThickness="0"
        ItemsSource="{Binding Items}"
        DataContext="{Binding ElementName=UserControl, Mode=OneWay}">
        <TreeView.Resources>
            <HierarchicalDataTemplate DataType="{x:Type local:MyStatistics}" ItemsSource="{Binding Items}" >                    
                    <TextBlock Text="{Binding Name}" />
            </HierarchicalDataTemplate> 
... 
```

我希望能够拦截节点扩展事件，并让绑定到正在扩展的 TreeView 节点的树的节点做一些检查，可能会询问用户是否确定（如果操作会花费很多内存）并取消扩展。

我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T21:33:43.253

此功能不是内置的，要实现此功能，您必须创建一个新控件`TreeView`，然后从扩展`TreeViewItem`.

实现这一目标涉及相当多的工作，所以我希望你能跟进；我不会解释所有内容，因此请提出问题或在 MSDN 上阅读您不了解的任何内容。

**创建树视图**

```
public class TreeViewEx : TreeView
{

    protected override bool IsItemItsOwnContainerOverride(object item) 
    {
        return (item is TreeViewItemEx);
    }

    protected override DependencyObject GetContainerForItemOverride() 
    {
        return new TreeViewItemEx(this);
    }

    internal bool PreviewExpandTreeViewItem(TreeViewItemEx item)
    {
        // return true to allow expansion, false to cancel
        return true;
    }

}

public class TreeViewItemEx : TreeViewItem
{
    private readonly TreeViewEx Owner;

    static TreeViewItemEx()
    {
        DefaultStyleKeyProperty.OverrideMetadata(typeof(TreeViewItemEx), 
            new FrameworkPropertyMetadata(typeof(TreeViewItemEx)));
    }

    public TreeViewItemEx(TreeViewEx owner)
    {
        Owner = owner;
    }

    private void OnPreviewExpansionMouseDown(object sender, MouseButtonEventArgs e)
    {
        // we do not care if it already expanded
        if (IsExpanded)
            return;

        e.Cancel = !Owner.PreviewExpandTreeViewItem(this);
    }

} 
```

现在，您要为新的`TreeViewItemEx`. 您可以[在 MSDN 上找到基本模板](http://msdn.microsoft.com/en-us/library/ms788727%28v=vs.90%29.aspx)。

为此，您需要从 MSDN 复制基本模板，将其更改`TargetType`为`{x:Type controls:TreeViewItemEx}`，然后将`PreviewMouseDown`事件添加到`ToggleButton`命名`Expander`并使用项目类中的事件处理程序，例如`PreviewMouseDown="OnPreviewExpansionMouseDown"`

**注意：**这将只允许您拦截由用户单击展开按钮 [+] 触发的展开事件。您需要几个键盘快捷键来为自己实现支持。

高温下，

# git - 从 Github 服务器导出 ssh 密钥

> ID：10161860
> 
> 赞同：2
> 
> 时间：2012-04-15T12:06:05.533
> 
> 标签：git, authentication, ssh, github, ssh-keys

我在我的 Github 服务器上设置了两个 ssh 密钥，我在 git kde 服务器上也有一个帐户，在我当前的机器上，github 使用了一个，它工作得很好，另一个由 kde 服务器同步，我从我的我正在寻找一种将其从 github 导出以与 kde 服务器重新同步的方法。我希望我很清楚。

编辑：我删除了 kde 服务器上的密钥，我需要将 Github 上的密钥导出到 kde 服务器

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-15T12:55:22.103

如果我正确理解了这个问题 - 你丢失了你的公钥。

如果你还有你的私钥，你可以很容易地重新生成你的公钥

```
 ssh-keygen -y [-f input_keyfile]
 -y      This option will read a private OpenSSH format file and print an
         OpenSSH public key to stdout. 
```

例如：

```
$ ssh-keygen -y -f myprivatekey > myregeneratedpublickey.pub 
```

如果你丢失了你的私钥，你就会被卡住。您必须生成一个新的密钥对。

# c# - 我无法理解这是如何工作的 x => x.Id == _purchase.Centre.Id？

> ID：10161861
> 
> 赞同：0
> 
> 时间：2012-04-15T12:06:06.433
> 
> 标签：c#, .net, linq, lambda

我无法理解以下行：`x => x.Id == _purchase.Centre.Id`

代码在这里：

```
private void LoadCentreOptions()
{
    MaterialCentreDataSource mcds = new MaterialCentreDataSource();
    List<MaterialCentre> centres = mcds.GetAll() as List<MaterialCentre>;

    _blankCentre = new MaterialCentre()
    {
        Name = Strings.JournalViewModel_CreditedPartyOption_NotSpecified
    };

    centres.Insert(0, _blankCentre);
    _centreOptions = new ReadOnlyCollection<MaterialCentre>(centres);

    if (_purchase.Centre == null)
        _purchase.Centre = _blankCentre;
    else
        _purchase.Centre = _centreOptions.First(x => x.Id == _purchase.Centre.Id);
} 
```

在调试时，我正在观察 X.Id 增加了。这怎么可能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-15T12:16:00.563

api`First`正在枚举集合并应用条件来检查哪个匹配，然后返回第一个匹配。所以代码有效地转换为

```
foreach(var centreOption in _centreOptions)
{
    if(centreOption.Id==_purchase.Centre.Id)
        return centreOption;
} 
```

如果您了解 LINQ，它基本上是缩写

```
_centreOptions.Where(x => x.Id == _purchase.Centre.Id).First(); 
```

要了解 First Read [Jon Skeets blogpost](https://msmvps.com/blogs/jon_skeet/archive/2010/12/29/reimplementing-linq-to-objects-part-11-first-single-last-and-the-ordefault-versions.aspx)的确切实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T12:11:03.300

`_centreOptions`此行适用于Enumerable中的每个元素：

```
_purchase.Centre = _centreOptions.First(x => x.Id == _purchase.Centre.Id); 
```

并检查`Id`对象是否等于`_purchase.Centre.Id`。
它将返回满足条件的第一个元素。

所以你会`id`在两次迭代中看到两个。

# android - 为什么 ASP MVC 会创建 Android 不喜欢的 JSON 格式？

> ID：10161869
> 
> 赞同：2
> 
> 时间：2012-04-15T12:06:35.617
> 
> 标签：android, json, asp.net-mvc-3

我有一个非常基本的 ASP MVC 应用程序，它公开了一个静态的出版物列表（参见下面的代码和结果）。

代码：

```
 public JsonResult Index()
    {
        List<Publication> list = new List<Publication>() {
            new Publication() { Id = 1, Name = "War and Peace" },
            new Publication() { Id = 2, Name = "Harry Potter" },
            new Publication() { Id = 3, Name = "Cat in the Hat" }
        };
        return this.Json(list, JsonRequestBehavior.AllowGet);
    } 
```

结果：

> [{"Id":1,"Name":"战争与和平"},{"Id":2,"Name":"哈利波特"},{"Id":3,"Name":"Cat in帽子”}]

当我尝试在 Android 中使用它时，出现以下错误：

> 04-15 12:00:57.331: W/System.err(209): org.json.JSONException: JSONObject 文本必须在 [{"Id":1,"Name":" 的字符 1 处以 '{' 开头战争与和平"},{"Id":2,"Name":"哈利波特"},{"Id":3,"Name":"戴帽子的猫"}]

我可以删除开始 [ 和结束 ] 并阻止错误出现。另一种选择是将 { Publications: 逻辑放在 android 代码的开头，但这似乎应该已经存在。

如何更新 MVC 应用程序中的代码以生成 JSON 的“可使用”版本？

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T12:11:09.583

首先，您不应该在收到时修改您的 json 字符串，因为它可能会干扰解析。

其次，您的 Json 字符串是数组格式，因为它以 . 开头`[`和结尾`]`。因此，您应该使用**JSONArray**而不是使用**JSONObject**。

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T14:19:12.500

我建议使用[GSON](https://sites.google.com/site/gson/Home)。它使用简单、快速且准确。**

# java - 具有自己的比较器实现的 TreeMap

> ID：10161872
> 
> 赞同：0
> 
> 时间：2012-04-15T12:06:43.577
> 
> 标签：java, map, compare, comparator, treemap

每个人。

我`TreeMap`用自己的方法实现编写了一个`compare()`。

目的是按顺序对映射的键进行排序：时间较短且位值较少的条目应位于顶部。所有条目都有唯一的时间。我想在有位的对象之间进行选择：`false`- 选择时间更短的对象。

但是下面的 Java 代码限制我添加一些新条目。

```
private TreeMap<Entry<K>,V>  map = new TreeMap<Entry<K>,V>(new Comparator<Entry<K>>() {

  @Override
  public int compare(Entry<K> entry1, Entry<K> entry2) {

    int time1 = entry1.getTime();        
    int time2 = entry2.getTime();

    boolean bit1 = entry1.isBit();
    boolean bit2 = entry2.isBit();

    if (time1 < time2) {
      if ( (bit1 == false && bit2 == true)
        || (bit1 == false && bit2 == false)
        || (bit1 == true && bit2 == true))
        return -1;
    } else if (time1 > time2) {
      if ( (bit1 == true && bit2 == false)
        || (bit1 == true && bit2 == true)
        || (bit1 == false && bit2 == false))
        return 1;
    }

    return 0;
  }

}); 
```

谁能解释一下为什么？

Ps 我用键添加条目：1、2、3、4、5。然后我尝试用键 4 添加条目，但没有添加。键 1、2 .. - 这意味着我创建具有 3 个字段的条目：键、位（假 - 默认）、时间（由计数器创建的唯一值）。所以我的所有条目都是独一无二的。

这是入门类：

```
public class Entry<K> {

private K id;
private boolean bit;
private int time;

public Entry(K id, Boolean bit, int time) {

    this.setId(id);
    this.setBit(bit);
    this.setTime(time);

}

public K getId() {
    return id;
}

public void setId(K id) {
    this.id = id;
}

public boolean isBit() {
    return bit;
}

public void setBit(boolean bit) {
    this.bit = bit;
}

public int getTime() {
    return time;
}

public void setTime(int time) {
    this.time = time;
}

public boolean equals(Object o){
    if (this.id == ((Entry)o).getId()){
        return true;
    }
    return false;
}   
} 
```

并以这种方式添加新条目：

```
public void put(K key, V value){
    entry = new Entry<K>(key, false, clock++);
    if (map.size() < initialCapacity){
        map.put(entry, value);
    } else {
        if (this.get(key) == null) {
            map.remove(map.firstEntry().getKey());
            map.put(entry, value);
        }
    }           
}

public V get(K key){
    Iterator it = map.keySet().iterator();
    while (it.hasNext()){
        Entry entry = (Entry) it.next();
        if (key.equals(entry.getId())){
            entry.setBit(true);
            return map.get(entry);
        }
    }       
    return null;
} 
```

运行代码：

```
ClockCacheMaximus<BigInteger, Object> ccm = new ClockCacheMaximus<BigInteger, Object>(3);;
    ccm.put(new BigInteger("1"), "aaa");
    System.out.println("map" + ccm.getAll());
    System.out.println();
    ccm.put(new BigInteger("2"), "bbb");
    System.out.println("map" + ccm.getAll());
    System.out.println();
    ccm.put(new BigInteger("3"), "ccc");
    System.out.println("map" + ccm.getAll());   
    System.out.println();
    ccm.put(new BigInteger("4"), "ddd");
    System.out.println("map" + ccm.getAll());
    System.out.println();
    ccm.put(new BigInteger("5"), "www");
    System.out.println("map" + ccm.getAll());
    System.out.println();
    ccm.put(new BigInteger("4"), "rrr");
    System.out.println("map" + ccm.getAll());
    System.out.println();
    ccm.put(new BigInteger("6"), "rrr");
    System.out.println("map" + ccm.getAll());
    System.out.println();
    ccm.put(new BigInteger("7"), "rrr");
    System.out.println("map" + ccm.getAll());
    System.out.println();
    ccm.put(new BigInteger("8"), "rrr");
    System.out.println("map" + ccm.getAll());
    System.out.println();
    ccm.put(new BigInteger("9"), "rrr");
    System.out.println("map" + ccm.getAll()); 
```

结果：

输入：key = 1；位=假；时间=0；Value = aaa --- 由于标准尺寸而放：aaa map[1]

输入：key = 2；位=假；时间=1；值 = bbb --- 由于标准大小而放置： bbb map[1, 2]

输入：key = 3；位=假；时间 = 2; 值 = ccc --- 由于标准大小而放置： ccc map[1, 2, 3]

输入：key = 4；位=假；时间 = 3; 值 = ddd --- put with remove map[2, 3, 4]

输入：key = 5；位=假；时间 = 4; 值 = www --- 使用删除地图 [3, 4, 5]

输入：key = 4；位=假；时间 = 5; Value = rrr !object 被发现 map[3, 4, 5]

输入：key = 6；位=假；时间 = 6; 值 = rrr --- 使用 remove map[4, 5] 放置

输入：key = 7；位=假；时间 = 7; Value = rrr --- 由于标准尺寸而放： rrr map[4, 5]

输入：key = 8；位=假；时间 = 8; Value = rrr --- 由于标准尺寸而放： rrr map[4, 5]

输入：key = 9；位=假；时间 = 9; Value = rrr --- 由于标准尺寸而放： rrr map[4, 5]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T12:27:51.787

TreeMap 仅使用比较器来检查唯一性。
如果您有 2 个根据您的比较器相等的键，则其中一个将不会添加到映射中。请参阅[SortedMap](http://docs.oracle.com/javase/6/docs/api/java/util/SortedMap.html)：

> 请注意，如果有序映射要正确实现 Map 接口，则有序映射维护的排序（无论是否提供显式比较器）必须与 equals 一致。（请参阅 Comparable 接口或 Comparator 接口以了解与 equals 一致的精确定义。）这是因为 Map 接口是根据 equals 操作定义的，但排序后的映射使用其 compareTo（或比较）方法执行所有键比较，因此从排序映射的角度来看，此方法认为相等的两个键是相等的。树形图的行为是明确定义的，即使它的排序与等号不一致；它只是不遵守 Map 接口的一般合同。

在您看来，键是唯一的（如果您使用 equals 检查，它们也是唯一的）但`TreeMap`仅使用比较器来检查唯一性。

# java - 是一种安全的网络服务；安全服务不支持测试仪功能

> ID：10161874
> 
> 赞同：0
> 
> 时间：2012-04-15T12:06:53.763
> 
> 标签：java, web-services, security, netbeans, netbeans-7

我是 JAVA 新手，在 NetBeans IDE 7.1.1 上开发 Web 服务。当我部署或运行​​服务并尝试从其测试器链接对其进行测试时，它会说

> CalculateInventoryService 是一个安全的网络服务；安全服务不支持测试仪功能

我想测试服务。我用谷歌搜索但找不到解决方案。

请帮助我如何从测试器页面测试它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T12:09:47.337

在项目视图中，右键单击 Web 应用程序 -> Web 服务 -> WebServiceNode

和

从列表中选择“编辑 Web 服务属性”

取消选中**安全服务**复选框

单击确定并再次部署

它应该工作。

# javascript - CSS HTML：Chome 中的文本换行：在 Firefox 和 IE 中运行良好

> ID：10161875
> 
> 赞同：0
> 
> 时间：2012-04-15T12:06:55.110
> 
> 标签：javascript, html, css

我在[http://jsfiddle.net/SLs47/](http://jsfiddle.net/SLs47/)中发布了 html 和 css 。**当我在 Chrome 中打开它时，标题文本会在缩放**增加时被换行（并且未对齐） 。但是它在 Firefox 中运行良好。请看以下图片。

需要更改哪些内容才能使其正常工作？

![在此处输入图像描述](../Images/826a50fbf8fb7d19aa8541eddb8439ad.png)

铬合金![在此处输入图像描述](../Images/a23451d0de62cb50b18d1e697d2f97e1.png)

* * *

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T12:15:53.277

虽然我无法重现该错误，但我认为将`#titleinfo`'`display`属性更改为`inline-block`from`inline`应该可以防止它换行。

# php - 如何在 PHP 中生成唯一的数字 id？

> ID：10161881
> 
> 赞同：2
> 
> 时间：2012-04-15T12:07:43.230
> 
> 标签：php, uniqueidentifier

> **可能重复：**
> [PHP：如何生成随机、唯一的字母数字字符串？](https://stackoverflow.com/questions/1846202/php-how-to-generate-a-random-unique-alphanumeric-string)

这个公式会产生碰撞吗？

```
substr(md5(uniqid(rand()))),0,6) 
```

如何生成只有数字（即 7 位数字）的唯一 ID？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T13:38:00.310

> uniqid 生成一个 13 个字符的字符串，如何将其减少到 7 个字符或 7 个数字而不会有冲突的风险？

只要您的意思是在将输出`uniqid`转换为新表示时发生碰撞，您就可以这样做：

*   [`uniqid`](http://php.net/uniqid)返回一个 13 个字符的字符串，每个字符可以是`0-9`或`a-f`，所以基本上是一个十六进制数，只有一位，十进制 0-15。
*   就好像您将其中两个可以转换为 0-255 范围内的一个字符或数字一样，将 13 个 0-15 值减少为 7 个 0-255 值真的很容易：

例子：

```
 $unique = uniqid(); # 13 characters
 $sevenPairs = array_map('hexdec', str_split($unique, 2));
 printf("Unique ID: %s\nSeven Pairs (digits): %s\n"
        , $unique, implode(', ', $sevenPairs)); 
```

输出：

```
Unique ID: 4f8ace1eb736a
Seven Pairs (digits): 79, 138, 206, 30, 183, 54, 10 
```

请注意，如果您使用前缀部分（在您的问题中使用`rand`），则返回的字符串的长度 by`uniqid`可以大于 13。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T12:20:55.500

最简单的方法是从数据库或文本文件中获取它，从 0 开始并为每个 ID 递增 1。

```
$id = strint(file_get_contents('counter.txt'));
file_put_content('counter.txt',++$id); 
```

使用 rand() 时，您将有更大的机会获得相同的数字。如果您不想要增量值，请使用 rand 并检查该数字是否已用于数据库。

# ios - 如何从 iOS 系统上的进程 pid 获取其他应用程序图标？

> ID：10161886
> 
> 赞同：2
> 
> 时间：2012-04-15T12:08:53.577
> 
> 标签：ios, macos, process, pid

我看过这个问题：

[如何在ios中获取当前应用程序图标](https://stackoverflow.com/questions/9419261/how-to-get-the-current-application-icon-in-ios)

现在我可以从进程 pid 获取应用程序路径，然后根据上面的问题，随着代码的崩溃，我无法获取应用程序图标。

```
NSBundle* bundle = [NSBundle bundleWithPath:apppath];
NSArray *infostmp = [[bundle infoDictionary] objectForKey:@"CFBundleIconFiles"];
if(infostmp){
     NSString* iconPath = [[NSString alloc] initWithString:[infostmp objectAtIndex:0]];
     UIImage*  icon =[UIImage imageWithContentsOfFile:iconPath];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T09:14:11.040

只能在越狱的 iOS 中获取 NSBundle 对象，在非越狱的 iOS 设备中，代码： NSBundle* bundle = [NSBundle bundleWithPath:apppath]; 得到捆绑是零。所以，你不能得到图标。

# postgresql - 提高通知未出现在屏幕上

> ID：10161887
> 
> 赞同：2
> 
> 时间：2012-04-15T12:08:58.690
> 
> 标签：postgresql

我有以下触发器检查已用空间 > 配额并将配额增加 5。配额已成功增加，但 RAISE NOTICE 未出现在屏幕上。

```
 CREATE OR REPLACE FUNCTION checkspaceused() RETURNS TRIGGER AS $cssubscription$
 DECLARE
 new_spaceused INTEGER; 
 new_id INTEGER; 
 new_quota INTEGER ;
 BEGIN
    IF(TG_OP='UPDATE') THEN
        IF NEW.spaceused > NEW.quota THEN
        RAISE NOTICE 'Limit breached';
        UPDATE subscription SET quota = NEW.spaceused + 5 where u_id = NEW.u_id; 
        END IF ; 

    END IF;

RETURN NEW; 
END;
$cssubscription$ LANGUAGE plpgsql;
CREATE TRIGGER checkspaceused AFTER UPDATE ON subscription FOR EACH ROW EXECUTE PROCEDURE checkspaceused(); 
```

请帮忙。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-15T12:22:58.680

检查[`client_min_messages`](http://www.postgresql.org/docs/current/static/runtime-config-logging.html#GUC-CLIENT-MIN-MESSAGES)会话中的值 - 应该`NOTICE`或稍后才能看到通知。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-06-13T14:47:01.660

在执行函数之前执行此操作..

```
SET client_min_messages TO NOTICE; 
```

...如果使用 pgAdmin，然后检查消息选项卡

# sql-server - 聚集索引 SQL Server

> ID：10161888
> 
> 赞同：5
> 
> 时间：2012-04-15T12:09:02.113
> 
> 标签：sql-server, database

我有 Oracle 背景，在 Oracle 中为每个表使用“索引组织表”(IOT) 听起来不合理，我从未真正见过这一点。在 SQL Server 中，我处理的每个数据库在每个表上都有一个聚集索引，这与 IOT（概念上）相同。

这是为什么？是否有任何理由到处使用聚集索引？在我看来，它们只适用于少数情况。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-15T16:18:22.540

聚集索引与索引组织表并不完全相同。对于 IOT，每个字段都必须参与 IOT 密钥。SQL Server 上的聚集索引不必是唯一的，也不必是主键。

聚集索引在 SQL Server 上被广泛使用，因为几乎总是存在一些自然排序，这使得常用查询更加高效。Oracle 中的 IOT 承载了更多的包袱，因此它们并没有那么有用，尽管它们可能比它们通常被认为的更有用。

从历史上看，SQL Server 6.5 或 7.0 IIRC 之前的真正旧版本不支持行级锁定，只能锁定在表或页面级别。通常会使用聚集索引来确保写入分散在表的物理存储周围，以最大程度地减少页面锁的争用。但是，SQL Server 6 几年前就停止了支持，因此存在此问题的应用程序将仅限于罕见的遗留系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T16:53:55.410

如果没有聚集索引，您的表将被组织为一个堆。这意味着插入的每一行都添加到表末尾的数据页中。此外，随着行的更新，如果更新的数据比以前大，它们将移动到表末尾的数据页。

**什么时候最好没有聚集索引**

如果您的表需要尽可能快的插入，但会牺牲更新和读取速度，那么没有聚集索引可能适合您。一个例子是，如果您有一个用作队列的表，例如，许多插入稍后会被读取并移动到另一个表。

**聚集索引**

聚集索引根据聚集索引中的列组织表中的数据。如果你聚集在错误的东西上，例如唯一标识符，这可能会减慢速度（见下文）。

只要您的聚集索引位于最常用于搜索的值上，并且它是唯一的并且不断增加，您就可以从聚集索引中获得一些惊人的性能优势。例如，如果您有一个名为 USERS 的表，您通常在其中根据 USER_ID 查找用户数据，那么在 USER_ID 上进行集群将加快所有这些查找的性能。这只是减少了为获取数据而需要读取的数据页的数量。

如果您的聚集索引中有太多键，这也会减慢速度。

聚集索引的一般规则：

不要聚集在任何 varchar 列上。

在 INT IDENTITY 列上进行聚类通常是最好的。

根据您通常搜索的内容进行聚类。

**基于 UniqueIdentifiers 的聚类**

在索引中使用唯一标识符时，它们的效率极低，因为没有自然的排序顺序。基于索引的 b 树结构，在使用 uniqueidentifiers 时，您最终会得到极其碎片化的索引。在重建或重组后，它们仍然极为分散。因此，您最终会得到一个较慢的索引，由于碎片，最终在内存和磁盘上非常巨大。同样在 uniqueidentifier 的插入中，您更有可能在索引上出现页面拆分，从而减慢您的插入速度。通常，唯一标识符对索引来说是个坏消息。

**概括**

我的建议是每个表都应该有一个聚集索引，除非有很好的理由不这样做（即表作为一个队列运行）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-15T14:22:32.487

我不知道为什么大多数时候你更喜欢堆而不是聚集索引。使用聚类，您可以免费获得一个您选择的索引。大多数情况下，这是主键（您可能无论如何都想强制执行！）。

堆主要用于特殊情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-15T13:13:43.377

我们在关系数据库中使用主键，通常关系是通过这些主键建立的。大多数人习惯将第一个字段命名为 TableID 并将其设为主键。当您在查询中加入两个或更多表时，如果使用聚集索引，您将获得最快的结果。

# mysql - 使用 DISTINCT 过滤重复项？

> ID：10161892
> 
> 赞同：0
> 
> 时间：2012-04-15T12:10:06.320
> 
> 标签：mysql, distinct

我有以下查询，并且只想列出第一个匹配项。

```
$first = $_GET['category'];
$first = $first[0] . "%";

$query = mysql_query("SELECT * FROM lyrics WHERE authorclean LIKE '".$first."'") or die(mysql_error()); 
```

(?category=b)

所以 DISTINCT 可以做到这一点吗？这是我尝试过的，但没有奏效：

```
$query = mysql_query("SELECT DISTINCT authorclean FROM lyrics WHERE authorclean LIKE '".$first."'") or die(mysql_error()); 
```

**编辑：这是完整的代码：**

```
function getCategory() {
$first = $_GET['category'];
$first = $first[0] . "%";

$query = mysql_query("SELECT DISTINCT authorclean FROM lyrics WHERE authorclean LIKE 'B%'") or die(mysql_error());
//$query = mysql_query("SELECT * FROM lyrics WHERE authorclean LIKE '".$first."'") or die(mysql_error());
if(mysql_num_rows($query) == 0) {
    echo "Geen resultaten gevonden.";
} else { 
while ($row = mysql_fetch_assoc($query)) { ?>
    <p><a href="/<?= $_GET['category']; ?>/<?= strtolower($row['authorclean']); ?>/"><?= $row['author']; ?></a></p>
    <?php }
    }
} 
```

（B% 仅用于测试）

如果我直接在数据库中运行以下查询，我会得到两个结果。如果我使用上面的代码运行，我只会得到一个空页面（除了已经存在的 html）。

```
SELECT DISTINCT authorclean FROM lyrics WHERE authorclean LIKE 'B%' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T12:12:44.733

您应该使用`LIMIT 1`仅列出第一个匹配项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T12:19:04.600

如果您有一个带有字段的表“tbl_lyrics”：作者歌词年份并填写例如如下：

```
author_A       lyrics_A        year_A
author_A       lyrics_A1       year_A1
author_A1       lyrics_A2       year_A
author_B        lyrics_B1       year_B1 
```

如果你这样做

```
select distinct(author) from tbl_lyrics where author like '%author_A%' 
```

您将获得：author_A 和 author_A1。不是第一个匹配的。

如果你想要第一个匹配的，你可以这样做：

```
select author from (select distinct(author) as author from tbl_lyrics where author like '%author_A%') where rownum <2; 
```

这将只返回 author_A。

Limit 与 MySql 一起使用，但不适用于 oracle 数据库

# node.js - 在 node.js 中使用递归模式循环

> ID：10161894
> 
> 赞同：8
> 
> 时间：2012-04-15T12:10:11.683
> 
> 标签：node.js, for-loop, design-patterns

我一直在尝试使用 node.js 遍历一系列城市并向谷歌发出迭代请求以获取每个城市的方向（然后我使用 JSON.parse 来抽象驾驶时间）。我需要找到一种同步执行此操作的方法，否则我将一次从谷歌请求每个城市的所有信息。我在[http://tech.richardrodger.com/2011/04/21/node-js-%E2%80%93-how-to-write-a-for-loop-with-callbacks找到了一个很好的模式/](http://tech.richardrodger.com/2011/04/21/node-js-%E2%80%93-how-to-write-a-for-loop-with-callbacks/)但不能让回调工作。如您所见，我使用“显示”功能进行测试。我的代码如下：

```
var request = require('request');
var fs = require('fs');
var arr = ['glasgow','preston','blackpool','chorley','newcastle','bolton','paris','york','doncaster'];
//the function I want to call on each city from [arr]
function getTravelTime(a, b,callback){
 request('https://maps.googleapis.com/maps/api/directions/json?origin='+a+'&destination='+b+'&region=en&sensor=false',function(err,res,data){
 var foo = JSON.parse(data);
 var duration = foo.routes[0].legs[0].duration.text;
 console.log(duration);
 });
};

function show(b){
 fs.writeFile('testing.txt',b);
};

function uploader(i){
 if( i < arr.length ){
   show( arr[i],function(){
   uploader(i+1);
   });
 }
}
uploader(0) 
```

我遇到的问题是仅输出数组中的第一个城市，并且回调/迭代永远不会进行。请问我哪里出错了？  

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-18T19:31:27.030

感谢您的指点，这显然是由于我对 javascript 中的回调理解不佳。只需阅读 O'Reilly 的 JavaScript 模式并点击“回调模式”部分 - 哦！

对于任何不知道的人，这就是代码的工作方式：

```
var arr = ['glasgow','preston','blackpool','chorley','newcastle','bolton','paris','york','doncaster'];

function show(a,callback){
    console.log(a);
    callback();
}

function uploader(i){
  if( i < arr.length ){
    show(arr[i],
         function(){
          uploader(i+1)
         });
   };
}
uploader(0) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-11T12:29:29.040

我也遇到过这样的问题，所以我编写了一个递归回调函数，它将充当一个 for 循环，但您可以控制何时递增。以下是该模块，名称为`syncFor.js`并将其包含在您的程序中

```
module.exports = function syncFor(index, len, status, func) {
    func(index, status, function (res) {
        if (res == "next") {
            index++;
            if (index < len) {
                syncFor(index, len, "r", func);
            } else {
                return func(index, "done", function () {
                })
            }
        }
    });
}

//this will be your program if u include this module
var request = require('request');
var fs = require('fs');
var arr = ['glasgow', 'preston', 'blackpool', 'chorley', 'newcastle', 'bolton', 'paris', 'york', 'doncaster'];
var syncFor = require('./syncFor'); //syncFor.js is stored in same directory
//the following is how u implement it

syncFor(0, arr.length, "start", function (i, status, call) {
    if (status === "done")
        console.log("array iteration is done")
    else
        getTravelTime(arr[i], "whatever", function () {
            call('next') // this acts as increment (i++)
        })
})

function getTravelTime(a, b, callback) {
    request('https://maps.googleapis.com/maps/api/directions/json?origin=' + a + '&destination=' + b + '&region=en&sensor=false', function (err, res, data) {
        var foo = JSON.parse(data);
        var duration = foo.routes[0].legs[0].duration.text;
        callback(); // call the callback when u get answer
        console.log(duration);
    });
}; 
```

# perl - 使用 perl 将响应标头添加到 302 响应

> ID：10161897
> 
> 赞同：0
> 
> 时间：2012-04-15T12:10:47.470
> 
> 标签：perl, http, http-headers, http-status-code-302

我正在尝试编写一个 perl 页面，该页面将 http 302 响应返回到不同的位置，并将自定义标头添加到该响应中。所以我想要的http响应应该是这样的：

```
HTTP/1.1 302 Moved
Date: Sun, 15 Apr 2012 10:59:02 GMT
Server: Apache
Location: http://www.google.com
Content-Length: 396
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
Content-Type: text/html; charset=iso-8859-1
CUSTOM_HEADER: CUSTOM_VALUE 
```

我尝试使用 CGI：

```
#!/bin/perl

use strict;
use APR::Request::Apache2;
my $r = shift;
$r->content_type('text/html; charset=utf-8');
$r->headers_out()->add("CUSTOM_HEADER", "CUSTOM_VALUE");
$r->headers_out()->add("Location", "http://www.google.com");
$r->status(302); 
```

我确实收到了对谷歌的 302 响应，但没有 CUSTOM_HEADER。一旦我将状态更改为 200， `$r->status(200);`我确实得到了 CUSTOM_HEADER。那么这种行为是怎么回事？如何将我的标题添加到 302 响应中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T12:59:13.660

你应该使用[`err_headers_out()`](http://perl.apache.org/docs/2.0/api/Apache2/RequestRec.html#C_err_headers_out_). 即使出现错误和重定向，这些也会被打印出来。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T13:59:12.203

使用`$r->err_headers_out->set`或`$r->err_headers_out->add`

```
my $r = shift;

$r->content_type('text/html; charset=utf-8');
$r->err_headers_out->set(Location => "http://www.google.com");
$r->status(302); 
```

# jquery - 使用jQuery悬停另一个div时div背景更改

> ID：10161904
> 
> 赞同：1
> 
> 时间：2012-04-15T12:11:40.207
> 
> 标签：jquery, hover, background-position

我试图让这个工作，但我对 jQuery 知之甚少。

当用户将鼠标悬停在 div“按钮”上时，div“幻灯片”的背景位置必须从“0 0”变为“0 -89px”，而将鼠标移动到另一点必须将背景位置重置为“0 0” .

那是代码（从stackoverflow上的另一个问题回收）：

```
 $(document).ready(function(){
    $('#button').hover(function(){
        $('#slide').css('backgroundPosition', newValue);
    }, function(){
        $('#slide').css('backgroundPosition', '0 -89px');
    });
}); 
```

我的 HTML：

```
<div id="container">
        <div id="slide"></div>
        <div id="button">Click me!</div>
</div> 
```

我的 CSS：

```
div#slide {
  background: url(base_slide.png) no-repeat;
  width: 629px;
  height: 89px;
  background-position: 0px 0px;
} 
```

它有效，但不如预期。当我将鼠标悬停在按钮 div 上时，没有任何反应，但是如果我将鼠标移动到另一个点，所有代码都可以正常工作并且背景会发生变化。

我确信有可能解决这个问题，但我昨天才开始探索一些 jQuery。另外我不知道如何将背景位置重置为 0 0。

请问你能帮帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T12:19:12.237

我认为 var newValue 应该替换为“0 0”。如果我正确理解您的需求。

检查这个例子：http: [//jsfiddle.net/VBEAQ/1/](http://jsfiddle.net/VBEaQ/1/)

更新：这是一个带有淡入淡出效果的完整示例；-)

```
$(document).ready(function(){
    $('#button').hover(function(){
        $('#slide').stop().fadeOut(function(){
            $(this).css('backgroundPosition', '0 -89px');
        }).fadeIn();
    }, function(){
        $('#slide').stop().fadeOut(function(){
            $(this).css('backgroundPosition', '0 0');
        }).fadeIn();
    });
});​ 
```

现场演示：http: [//jsfiddle.net/VBEAQ/9/](http://jsfiddle.net/VBEaQ/9/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-15T12:37:26.770

您应该尝试定义多个 css 属性和值，而不是您使用的 1 个函数 = 1 个 css 方法。jquery 文档应该有所帮助.. 还有它的背景位置而不是背景位置。

# asp.net - ASP.NET 4.0 中 SetSessionStateBehavior 方法的真实例子是什么？

> ID：10161905
> 
> 赞同：1
> 
> 时间：2012-04-15T12:11:45.020
> 
> 标签：asp.net

在 ASP.NET 4.0 中有一个新方法 HttpContext.SetSessionStateBehavior，我们可以通过它在运行时更改会话状态。但是在应用程序开发中我们需要使用这种方法的真实例子是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T12:22:32.883

在 4.0 之前，只有两种方法可以禁用会话状态。

*   Web.Config 中的应用程序级别
*   使用 Page 指令的页面级别

如果您的应用程序根据查询字符串动态生成页面，那么您没有办法选择性地禁用某些页面的会话状态以提高性能。因此，您只需禁用所有页面或启用所有页面。

有了这个，您可以编写一个可以拦截请求的 http 模块，查看查询字符串或 url 的路径并禁用/启用会话状态。

# c# - MonthCalendar 控件 - 使用 if 语句需要帮助

> ID：10161906
> 
> 赞同：0
> 
> 时间：2012-04-15T12:12:15.310
> 
> 标签：c#, winforms

基本上我已经使用工具箱将一个基本日历导入到我的 C# 表单中。我应用了一个 onclick 方法，所以当用户点击任何日期时，它会将其读入标签。到目前为止一切顺利，但我的目标是使用 if 语句将文本读入标签并在某个日期关闭表单。以下是我尝试过的。

```
if(label.Text == "14th-April-2012")
{
    this.hide();
}

private void monthCalendar1_DateChanged(object sender, DateRangeEventArgs e)
{
    monthCalendar1.MaxSelectionCount = 1;
    label9.Text = monthCalendar1.SelectionRange.End.ToString("dd-MMMM-yyyy", new System.Globalization.DateTimeFormatInfo());
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-15T12:43:36.870

用于`this.Close()`关闭您的表单。

此外，如果您确定您的标签中会列出日期，最好使用 DateTime 类型进行比较。例如，

```
var date = DateTime.ParseDate(label.Text);
if(date == new DateTime(2012, 4, 14))
{
     this.Close();
} 
```

# php - Yii 框架部署

> ID：10161907
> 
> 赞同：1
> 
> 时间：2012-04-15T12:12:32.543
> 
> 标签：php, deployment, yii

我正在生产服务器上部署一个新的 yii 应用程序，该服务器最近已配置为托管该应用程序，并且所有 yii 要求都已成功安装（运行 yii/requirements）。问题是整个站点中的所有控制器/操作都没有工作，但站点/默认/索引。我通过服务器IP访问，所以当我这样写62.75.203.71时，会显示主页（站点（默认/索引），但是当我点击任何链接或编写另一个路由时，则找不到错误是生成，例如 62.75.203.71/site/show

该站点在我的开发电脑中正常运行，不知道这是我缺少的 yii 配置还是服务器问题。

这也是我的配置文件：

```
'urlManager'=>array(
        'urlFormat'=>'path',
        'rules'=>array(
            '<controller:\w+>/<id:\d+>'=>'<controller>/view',
            '<controller:\w+>/<action:\w+>/<id:\d+>'=>'<controller>/<action>',
            '<controller:\w+>/<action:\w+>'=>'<controller>/<action>',
        ),
    ), 
```

这是我的 .htaccess 文件的内容

允许覆盖所有

我得到了 404-not found ngnix 1.14！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T00:44:28.597

我会寻找您的开发服务器和生产服务器之间的任何 http 配置差异。在两种环境中应用的 URL 重写规则之间可能存在差异。这将导致您的代码生成的 URL 无法正确解析。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T20:30:49.873

错误可能是您的`controller`姓名以及您在 URLS 中调用它们的名称。它们区分大小写。

我遇到的第二个问题是您修改了对搜索引擎友好的网址，然后您可能需要在那里查看正则表达式

但

我确定你的`controllers`名字`case`导致了这个有线问题

例如， `class BookingUsersController extends Controller` 这是您的控制器，您应该对字符和 url 使用相同的大小写

```
yii::app()->createUrl('BookingUsers') 
```

使用它是行不通的

```
yii::app()->createUrl('bookingusers') 
```

反之亦然改变该控制器的情况，到处查看

# ruby-on-rails - 调试 Rails 狂欢。可能与数据库有关

> ID：10161908
> 
> 赞同：0
> 
> 时间：2012-04-15T12:12:43.797
> 
> 标签：ruby-on-rails, spree

我的问题只是远程。

我的问题是在州控制器中，数据库中不存在**国家。**

但是如果我在远程`rails c`，Country 可以工作。国家与国家的关系有效。反之亦然，而且他们都有大量关于两者的信息。

**战场（SFW）：**

```
class Admin::StatesController < Admin::ResourceController
  #belongs_to :country
  # ^^ This default line with spree will break the app because once this controller is touched, Country is nil in this part of the app.
  before_filter :load_data, :except => [:index]

  def index
    #@country = Country.first
    #@country ||= Country.find_by_iso("US")
    # ^ Does not work because no countries are in the database from the app. Even though countries are accessible in rails console.

    @trip = "yes"
    @users = User.all
    @countries = Country.all
    # ^^ Country as a class exists but it is not populated in this part of the app. 
```

所以有了这个控制器代码，如果我把它扔到我的视图中，我可以看到：

1.  的值`@trip`。这意味着控制器可以发送数据。
2.  @users 的值。这意味着数据库正在工作。我可以列出所有用户及其电子邮件
3.  *我没有看到列出一个国家*。他们都没有出现。但同样，如果我将 c 放入控制台并尝试此操作，它工作正常。美国有 51 个州。他们都以完美的爱国婚姻召回自己的国家。

任何人都可以从这里发生的事情中得出正面或反面吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T13:20:48.463

我猜你在开发模式下运行控制台，在发布模式下运行你的应用程序。试试

```
rails c production 
```

我敢打赌你的国家在生产数据库中不存在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T13:02:42.657

我将这个答案归类为不比“部分和可能”更好。考虑发布您的视图代码以帮助澄清您的问题。无论哪种方式，也许这个调试建议可以让你得到你的答案。

您是否看到了与两种不同 Rails 环境相关的行为？尝试`Rails.env`在这两种情况下显示，然后查看您的 config/database.yml 文件。在该文件中，您可能会看到项目的每个 Rails 环境的不同数据库。不同的环境可能有“测试”、“生产”和“开发”等名称。您可能会注意到，为每个环境连接到的列出的数据库是不同的。如果您确保`countries`“rails c”和您的应用程序使用的环境的数据库中填充了“”（和其他相关表），那么行为应该相似。

更多关于 Rails.env[的信息](http://apidock.com/rails/Rails/env/class)。

# assembly - 将 XMM 寄存器压入堆栈

> ID：10161911
> 
> 赞同：16
> 
> 时间：2012-04-15T12:13:07.037
> 
> 标签：assembly, x86, simd, sse

有没有办法将压缩双字整数从 XMM 寄存器推送到堆栈？然后在需要时将其弹出？

理想情况下，我正在寻找通用寄存器的 PUSH 或 POP 之类的东西，我已经检查过英特尔手册，但我要么错过了命令，要么没有......

还是我必须将值解压缩到通用寄存器然后推送它们？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-15T12:36:15.977

不，x86 下没有这样的 asm 指令，但您可以执行以下操作：

```
//Push xmm0
sub     esp, 16
movdqu  dqword [esp], xmm0

//Pop xmm0
movdqu  xmm0, dqword [esp]
add     esp, 16 
```

**编辑：**

上面的代码示例是直接推送/弹出仿真。

如果您在堆栈上使用其他局部变量，则`ebp`首先必须正确设置寄存器，例如：

```
push ebp
mov  ebp, esp
sub  esp, LocaStackVariablesSize
//... your code
mov  esp, ebp
pop  ebp  
ret 
```

在这种情况下，您也可以使用 Daniels 解决方案！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-27T11:17:35.987

为此，我建议使用单独的 16 位对齐堆栈，这样您就可以使用 movdqa 而不是 movdqu。这两条指令的执行时间略有不同！

# oracle - 数据库中的并行流水线表函数

> ID：10161913
> 
> 赞同：-2
> 
> 时间：2012-04-15T12:13:32.460
> 
> 标签：oracle, function, postgresql, parallel-processing, pipelined-function

我想问一下这个并行流水线表函数功能是否也存在于 postgres 中。我敢肯定，postgres 中存在流水线表函数，但我不知道它们是否表现出并行性。有人可以帮我解决这个问题吗？

另外，另外，我想问一下，并行流水线表函数如何并行化查询。

有人可以明智地向我解释这一步吗，最好借助示例。

[http://oraganism.wordpress.com/2010/05/18/parallel-enabled-pipelined-plsql-functions-an-old-feature-thats-new-to-me/](http://oraganism.wordpress.com/2010/05/18/parallel-enabled-pipelined-plsql-functions-an-old-feature-thats-new-to-me/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T20:41:41.927

PostgreSQL 不支持一个查询的并行处理——所以没有像并行管道函数这样的特性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-29T02:59:33.523

PostgreSQL **9.6+**现在（在某种程度上）[并行化](https://dba.stackexchange.com/questions/55019/can-a-single-postgresql-query-use-multiple-cores/133243#133243)了单个查询（无需用户付出太多努力）。但是，由于新功能仍在熨烫中，这对您的给定查询有多大好处，可能会有所不同。

# makefile - 如何在 makefile 配方中设置环境变量？

> ID：10161915
> 
> 赞同：6
> 
> 时间：2012-04-15T12:13:53.507
> 
> 标签：makefile

这是一个简化的 Makefile：

```
all:
    @for (( i = 0; i < 5; ++i )); do \
         var="$$var $$i"; \
         echo $$var; \
     done
    @echo $$var 
```

我想“var”的值是“0 1 2 3 4”，但输出是：

```
0
0 1
0 1 2
0 1 2 3
0 1 2 3 4
               <--- NOTHING!!! 
```

如您所见，最后一个回声是“NOTHING”。怎么了？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-15T12:56:37.893

从[这里](http://www.gnu.org/software/make/manual/make.html#Execution)：

> 当需要执行配方来更新目标时，它们是通过为配方的每一行调用一个新的子shell来执行的......
> 
> **请注意：**这意味着设置 shell 变量和调用 shell 命令（例如为`cd`每个进程设置本地上下文）不会影响配方中的以下行。如果要用于`cd`影响下一条语句，请将两个语句放在一个配方行中。然后`make`将调用一个 shell 来运行整行，shell 将按顺序执行语句。

尝试以下操作：

```
all:
    @for (( i = 0; i < 5; ++i )); do \
         var="$$var $$i"; \
         echo $$var; \
     done; \
    echo $$var 
```

# prolog - 在 Prolog 中替换列表的元素

> ID：10161916
> 
> 赞同：4
> 
> 时间：2012-04-15T12:13:56.743
> 
> 标签：prolog

我有一个谓词`variablize/3`，它接受一个列表并用一个变量依次替换每个项目，例如：

```
% ?- 变量（[a,b,c], X, L）。
% L = [[X, b, c], [a, X, c], [a, b, X]]

```

现在我正在尝试扩展此谓词以接受变量列表，例如：

```
% ?- 变量（[a,b,c], [X,Y], L）。
% L = [[X, Y, c], [X, b, Y], [a, X, Y]]

```

到目前为止，我的代码是：

```
替换_at（[_|尾巴]，X，1，[X|尾巴]）。
replace_at([Head|Tail], X, N, [Head|R]) :- M 是 N - 1，replace_at(Tail, X, M, R)。

替换_每个（[]，_，_，[]，_）。
replace_each([_|Next], 原点, X, [Res|L], N) :-
    replace_at（原点，X，N，Res），
    M 是 N + 1，
    replace_each（下一个，原点，X，L，M）。

variablize(I, X, L) :- replace_each(I, I, X, L, 1)。

```

任何指针？我是否扩展`replace_at/4`了应该跳过的索引列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T14:49:23.380

一种简化的、基于内置的实现方式`variablize`/3

```
variablize(I, X, L) :-
    bagof(R, U^select(U, I, X, R), L). 
```

证明当 X 变成一个列表时，我们可以有一个distribute/3，而不是[select /4，它应用 X 的元素的替换。](http://www.swi-prolog.org/pldoc/doc_for?object=select/4)select/4 可以这样实现

```
myselect(B, I, X, R) :-
    append(A, [B|C], I), append(A, [X|C], R). 
```

这种形式很方便，因为我们有输入列表右侧的部分`I`，我想您需要在其中分配剩余的变量。然后对`X`元素的递归应该做：

```
distribute(I, [X|Xs], L) :-
    append(A, [_|C], I),
    distribute(C, Xs, R),
    append(A, [X|R], L).
distribute(I, [], I). 
```

Distribute/3 的行为是这样的：

```
?- distribute([a,b,c,d],[1,2],X).
X = [1, 2, c, d] ;
X = [1, b, 2, d] ;
X = [1, b, c, 2] ;
X = [a, 1, 2, d] ;
X = [a, 1, c, 2] ;
X = [a, b, 1, 2] ;
false. 
```

因此

```
variablize_l(I, X, L) :-
    bagof(R, distribute(I, X, R), L). 
```

给我们：

```
?- variablize_l([a,b,c],[X,Y],L).
L = [[X, Y, c], [X, b, Y], [a, X, Y]]. 
```

**编辑**

我最初是这样写的，因为这里有将分发阶段与列表构造分开的证据：

```
replace_v([_|T], X, [X|T]).
replace_v([L|T], X, [L|R]) :-
    replace_v(T, X, R).
variablize(I, X, L) :-
    bagof(E, replace_v(I, X, E), L). 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T05:22:36.380

```
variablize(L1,L2,L) :-
    append(L1,L2,L3),
    length(L1,Len1),
    length(L2,Len2),
    findall(L4,(combination(L3,Len1,L4),var_count(L4,Len2)),L).

combination(X,1,[A]) :-
    member(A,X).
combination([A|Y],N,[A|X]) :-
    N > 1,
    M is N - 1,
    combination(Y,M,X).
combination([_|Y],N,A) :-
    N > 1,
    combination(Y,N,A).

var_count([],0).
var_count([V|R],N) :-
    var(V),
    var_count(R,N1),
    N is N1 + 1,
    !.
var_count([A|R],N) :-
    var_count(R,N). 
```

# c# - 更改上传图片的名称

> ID：10161917
> 
> 赞同：0
> 
> 时间：2012-04-15T12:14:01.580
> 
> 标签：c#, asp.net-mvc-3

我想要实现的是将上传图像的名称更改为一个有点独特的字符串。

我创建了一个由数据库动态填充的图片库。画廊工作正常，但如果上传同名的图像，存储在数据库中的文件会出现问题！

控制器中用于文件上传的代码：

```
string AdvertImage = picture1.FileName;
                    advert.AdvertImage = AdvertImage;
                    var image1Path = Path.Combine(Server.MapPath("~/Content/Images"), AdvertImage);
                    picture1.SaveAs(image1Path); 
```

下面的代码是我正在处理的

```
 string BackImage = DateTime.Now.ToString("yyyyMMddhhmmssfffffff");
                    caradvert.BackImage = BackImage;
                    var image3Path = Path.Combine(Server.MapPath("~/Content/CarImages"), BackImage);
                    picture3.SaveAs(image3Path); 
```

我设法创建了一个唯一的文件名，但它没有将 .jpg 附加到图像的末尾。

欢迎任何关于该主题的帮助或建议

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T12:21:59.243

尝试这个：

```
 //save file in folder
    if (FileUpload1.PostedFile.ContentType.ToLower().StartsWith
            ("image") && FileUpload1.HasFile)
    {
        string savelocation = Server.MapPath("savedImages/");
        string fileExtention = System.IO.Path.GetExtension(FileUpload1.FileName);
        //creating filename to avoid file name conflicts.
        string fileName = Guid.NewGuid().ToString();
        //saving file in savedImage folder.
        string savePath = savelocation + fileName + fileExtention;
        FileUpload1.SaveAs(savePath);
    } 
```

# delphi - DSPack：如何将 PushSource 连接到 videocap？

> ID：10161920
> 
> 赞同：0
> 
> 时间：2012-04-15T12:14:17.983
> 
> 标签：delphi, dspack

我想使用`PushSource`过滤器来捕获，但我需要将它“连接”到“videocap”样本。这个过滤器不是一个独立的过滤器，所以它不能被枚举为捕获设备，我也不希望它像那样转换

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T13:33:35.830

好吧，我使用了 GraphEdit 中没有出现的 Nvidia Encoder Filter。为此，我只需定义 GUID：

```
Const
CLSID_NVIDIA_VideoEncoderFilter : TGUID = '{B63E31D0-87B5-477f-B224-4A35B6BECED6}'; 
```

然后我像这样在内存中创建过滤器：

```
Var
  N: IBaseFilter;
begin
  CoCreateInstance(CLSID_NVIDIA_VideoEncoderFilter, Nil, CLSCTX_INPROC_SERVER, IID_IBaseFilter, N);
  if Assigned(N) then
  Begin
  // connect to any filter that you can use in your system
  End; 
```

您现在也可以在 GraphEdit 中看到这个“隐藏”过滤器。

编辑：这是我链接过滤器的代码。它搜索可能连接到下一个过滤器的每个引脚。此代码将音频输出引脚连接到音频输入引脚，将视频输出引脚连接到视频输入引脚等。它非常灵活。

```
Procedure Connect(Builder: IGraphBuilder; SourceFilter, DestFilter: IBaseFilter);
Var
  SourceEnum, DestEnum: IEnumPins;
  SourcePin, DestPin: IPin;
  FI: _FilterInfo;
  S, D: String;
Begin
  SourceFilter.QueryFilterInfo(FI);
  S := FI.achName;
  DestFilter.QueryFilterInfo(FI);
  D := FI.achName;
  SourceFilter.EnumPins(SourceEnum);
  DestFilter.EnumPins(DestEnum);
  DestEnum.Reset;
  While DestEnum.Next(1, DestPin, Nil) = S_OK Do
  Begin
    SourceEnum.Reset;
    While SourceEnum.Next(1, SourcePin, Nil) = S_OK Do
      If Builder.Connect(SourcePin, DestPin) = S_OK Then
      Begin
        SourceEnum := Nil;
        DestEnum := Nil;
        SourcePin := Nil;
        DestPin := Nil;
        Exit;
      End;
  End;
  SourceEnum := Nil;
  DestEnum := Nil;
  SourcePin := Nil;
  DestPin := Nil;
  Raise Exception.Create(Format('There is no pin from %s to connect to %d', [S, D]));
End; 
```

现在您可以将此方法与您的过滤器一起使用，如下面的代码所示

```
Var
  SourceFilter, DestFilter: IBaseFilter;
  Builder: IGraphBuilder;
Begin
  SourceFilter := SrcFilter As IBaseFilter;
  DestFilter := DstFilter As IBaseFilter;
  Builder := FilterGraph As IGraphBuilder;
  Connect(Builder, SourceFilter, DestFilter);
End; 
```

希望这可以帮助。我们曾经都是新手；）

# azure - 从角色进程获取 Azure 日志

> ID：10161921
> 
> 赞同：0
> 
> 时间：2012-04-15T12:14:20.137
> 
> 标签：azure, azure-diagnostics

我已配置 Azure 诊断，以便将日志上传到存储表。我正在使用我的代码中的 Trace.TraceXxx 并且一切正常。

现在我正在尝试从 Role OnStart() 和 OnStop() 方法添加跟踪。我知道跟踪是有效的，因为我在模拟器中运行时看到了调试窗口中的行。但是从云部署来看，这些跟踪行似乎永远不会上传到表中。我的猜测是它与 TraceSources 有点相关，因为我在表中唯一的跟踪行来自 w3wp.exe 源......有什么提示吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T18:23:36.200

就像您说的那样，您可以使用**WaIISHost.exe.config**添加跟踪侦听器，但除此之外，您还可以在代码中添加跟踪侦听器（您需要引用**Microsoft.WindowsAzure.Diagnostics.dll**）：

```
public class WebRole : RoleEntryPoint
{
    public override void Run()
    {
        var listener = new Microsoft.WindowsAzure.Diagnostics.DiagnosticMonitorTraceListener();
        Trace.Listeners.Add(listener);

        ...
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T19:23:32.910

另一种设置诊断的方法是通过配置文件。如果您最近创建了 VS 解决方案，它将自动为跟踪侦听器创建诊断插件和配置。使用配置文件 (diagnostics.wadcfg)，不需要为不同的数据源编写代码。这是您可以开始使用的链接和示例文件：

[http://msdn.microsoft.com/en-us/library/gg604918.aspx](http://msdn.microsoft.com/en-us/library/gg604918.aspx)

您现在不能包含自定义性能计数器，并且您需要确保不要尝试为任何内容分配超过 4GB 的缓冲区（您可以保留为 0），否则它往往会失败。

注意，时间间隔格式（例如 PT1M）。那是一种序列化格式，所以 PTXM 是 X 分钟，而 PTXS 是 X 秒。您需要将其标记为内容并始终在 Visual Studio 中复制（位于项目的根目录），以便将其打包。

这是设置诊断的三种方法的链接 [http://msdn.microsoft.com/en-us/library/windowsazure/hh411541.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/hh411541.aspx)

兰吉斯
[http://www.opstera.com](http://www.opstera.com)

# c - 为什么我的#define 宏看起来是全局的？

> ID：10161922
> 
> 赞同：4
> 
> 时间：2012-04-15T12:14:27.027
> 
> 标签：c, gcc

当我遇到以下在头文件和源文件中定义的宏时，我正在调查程序中的编译和链接问题：

```
/* file_A.c */
#ifndef _NVSize    
   #define _NVSize 1
#endif

/* file_B.c */
#include "My_Header.h"
#ifndef _NVSize    
   #define _NVSize 1
#endif

/* My_Header.h */
#define _NVSize 1024 
```

没有什么异常，直到我在 GCC 输出映射文件中看到以下信息：

```
/* My Map File */
...
.rodata  0x08015694   _NVSize
... 
```

我对映射文件的理解是，如果您在映射文件的 .rodata 部分中看到一个符号，则该符号被编译器视为全局变量。但是，情况并非如此，因为宏应该在编译器解析文件之前由预处理器处理。这个宏应该在编译之前用它定义的值替换。

这是 GCC 处理宏的标准方式，还是 GCC 将其视为全局（可能是调试设置）的特定实现原因？另外，如果我的宏在不同的源文件中重新定义，这意味着什么？我只是为单个源文件重新定义它还是我修改了一个全局变量，从而在我的程序中使用它的任何地方更改 _NVSize？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T12:18:51.390

我认为编译器可以自由地将你的宏分配给一个全局变量*，只要它确保它产生与*文本替换完全相同的结果。

编译时编译器可以专门标记这个全局变量，表示它是一个宏常量值，所以不能重新赋值，不能取地址等。

如果您在源代码中重新定义宏，编译器可能不会执行此转换（并按照您的预期对待它：预编译器文本替换），对不同的值之一执行它（或对所有这些值执行，为每个事件使用不同的名称），或者做其他事情:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T13:02:57.777

宏在预处理器步骤中被替换，编译器只看到替换的结果。因此，如果它看到宏名称，那么我敢打赌，宏没有在使用时定义。`#define _NVSize`它在特定和一个之间定义`#undef _NVSize`。在不使用第一个宏的情况下重新定义现有宏`#undef`应该会导致预处理器错误，AFAIR。

顺便说一句，你不应该用下划线开始你的宏名称。这些是为实现而保留的。

# java - HashMap 只打印最后一个条目

> ID：10161923
> 
> 赞同：0
> 
> 时间：2012-04-15T12:14:48.387
> 
> 标签：java, hashmap

我正在编写用于显示时间与大小的代码。我正在使用哈希图进行条目。问题是它正确地进行了计算，但最后当我尝试打印出哈希图时，它不会显示 7 分钟内的所有结果。而是显示最后输入的结果7 次。我已经尝试了很多来找出问题，但不能。请帮助我

这是我的代码

```
public class Analysis
{
    public static class KeepTime
    {
        String time;
        long TotalSize;
    }

    Main f1 = new Main();
    public static int j = 0;
    public static int check = 0;
    public HashMap<String, KeepTime> hMap_time = new HashMap<String, KeepTime>();
    public KeepTime TimerInstance = new KeepTime();

    void TimeBasedReporting()
    {
        String skey;
        String key;
        int k;
        int y;

        for (k = 1; k <= f1.Flows().size(); k++)
        {
            check = 0;
            j = 0;

            skey = Integer.toString(k);

            if (hMap_time.isEmpty())
            {
                //some code
                key = Integer.toString(hMap_time.size() + 1);
                hMap_time.put(key, TimerInstance);
                j = 1;
            }
            else if (check == 0 && j == 0)
            {
                for (y = 1; y <= hMap_time.size(); y++)
                {
                    //some code
                    }
                }
            }

            if (check == 0 && j == 0)
            {
                // some code
                key = Integer.toString(hMap_time.size() + 1);
                hMap_time.put(key, TimerInstance);
            }
            else
            {}

        }

    }
} 
```

以下是输出

```
 03:08:39,AM  424
          03:08:39,AM  424
          03:08:39,AM  424
          03:08:39,AM  424
          03:08:39,AM  424
          03:08:39,AM  424
          03:08:39,AM  424
          03:08:39,AM  424
          03:08:39,AM  424
          03:08:39,AM  424 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T12:25:16.107

You're creating a *single instance* of `KeepTime` and using a reference to that object as the value in various key/value pairs.

You should be creating a *new* instance each time you add a new entry, if you want them to be independent. (And yes, I agree with the comment that you almost certainly *don't* want a map here - but you'd get the same problem if you added the same reference to a list multiple times, too.)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T12:25:43.183

The problem is that you are using the one `TimerInstance` and place that in the map for each key

You associate the same object with all keys, so of course you wil have the same value stored in the map.

Try:

```
KeepTime timer = new KeepTime(); 
```

at the top of the for loop and replace all `TimerInstance`s with `timer`.

You can do this without fear of changing your logic as you re-assing all members of the original `TimerInstance` every time you store it in the map.

Also, if you want the entries in ascending order, HashMap gives you the wrong order as it is ordered based on the hash code of the keys (`String` in this case). Use a TreeMap if you need proper ordering -- the default string comparison results in alphabetical ordering, or you can specify your own custom `Comparator` to provide the ordering you require.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T12:23:01.003

遍历映射条目的方法是遍历它的`map.keySet()`or `map.entrySet()`。使用其中之一。

# objective-c - HTML 字符详细文本

> ID：10161924
> 
> 赞同：2
> 
> 时间：2012-04-15T12:14:50.333
> 
> 标签：objective-c, xcode, ios5

我正在抓取带有 HTML 字符的 JSON 提要，在 web 视图中显示良好。但是在我的 TableView (detailtext) 中，我看到 HTML 字符就像`&#233;`需要的那样`é`。有没有办法显示`é`而不是`&#233;`

```
[[cell detailTextLabel] setText:[item objectForKey:@"description"]]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T12:33:51.353

尝试使用该类别，您一定会有所帮助：

[NSString+HTML](https://github.com/mwaterfall/MWFeedParser/blob/master/Classes/NSString+HTML.h)

# iphone - xcode NSArrayM insertObject:atIndex:]：对象不能为 nil

> ID：10161925
> 
> 赞同：1
> 
> 时间：2012-04-15T12:15:03.350
> 
> 标签：iphone, xcode, nsmutablearray, plist, nsdictionary

我是 Xcode 的新手。我想要的是在我的程序中本地读取 plist 数据。我有 `NSArrayM insertObject:atIndex:]: object cannot be nil`错误。这是我声明的内容和我的 plist 文件。谢谢

```
NSMutableArray *phoneArray;

NSString *path=[[NSBundle mainBundle] pathForResource:@"PhoneList" ofType:@"plist"];

phoneArray= [[NSMutableArray alloc]initWithContentsOfFile:path]; 
```

* * *

键类型 项目 0 字典 项目 1 字典

项目具有描述、名称键作为字符串类型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T12:21:36.917

验证您的 plist，很可能存在错误值。`NSArray`或中的项目`NSDictionary`不能为空。您可以使用 Xcode 打开 plist 文件进行验证。

我个人使用“PlistEdit Pro”，当 plist 无效时，它可以提供更好的诊断。PlistEdit Pro有[免费试用](http://www.fatcatsoftware.com/plisteditpro/)版。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T12:26:12.300

```
- (void)insertObject:(id)anObject atIndex:(NSUInteger)index 
```

The object to add to the array's content. This value must not be nil.

before any input from the plist file, please check to see that the element is not nil, to avoid the excetion

# c# - 任何人都可以解释图数据结构的java或C#实现吗

> ID：10161929
> 
> 赞同：2
> 
> 时间：2012-04-15T12:15:35.547
> 
> 标签：c#, java, algorithm, data-structures, graph-algorithm

任何人都可以解释图数据结构的java或C#实现（邻接表结构-有向图）我对图数据结构有一个直观的想法。但是，如果有人逐代码解释它。我可以很快理解它....任何人都可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T12:55:23.933

最低限度，您需要这个基本结构：

```
public class Graph{
    Set<Node> nodes;
}

public class Node{
    Set<Node> adjacent;
} 
```

剩下的就是构造函数和访问器方法，也许是一些基本的图形逻辑。如果您的算法需要一种有效的方法来找到指向*节点*的边，您将有`adjacent`两组（一组具有当前节点具有边缘的节点，另一组具有具有朝向当前节点的边缘的节点）。

如果您需要边缘权重：

```
public class Node{
    Set<Edge> adjacent;
}

public class Edge{
    Node target;
    double weight;
} 
```

# android - Android：如何为超过 2 个视图设置相同的可绘制选择器 xml

> ID：10161930
> 
> 赞同：4
> 
> 时间：2012-04-15T12:15:36.470
> 
> 标签：android, selector, drawable

假设有 2 个 ImageButtons。现在，要根据其状态显示图像，我应该为每个 ImageButton 编写一个选择器 xml。我们可以为两个视图编写相同的选择器吗？因为我的应用程序有很多按钮，并且必须为每个视图编写一个选择器 xml。我们可以优化它吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-15T12:25:11.100

如果您尝试使用 xml 文件，那么您必须为每个按钮创建每个选择器。

因此，尝试通过继承 StateListDrawable 或尝试以下动态创建选择器的代码来动态执行:::

```
StateListDrawable states = new StateListDrawable();
states.addState(new int[] {android.R.attr.state_pressed},
    getResources().getDrawable(R.drawable.pressed));
states.addState(new int[] {android.R.attr.state_focused},
    getResources().getDrawable(R.drawable.focused));
states.addState(new int[] { },
    getResources().getDrawable(R.drawable.normal));
imageView.setImageDrawable(states); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T14:14:39.167

您不必为每个按钮创建 xml 选择器，只需重新使用适合的选择器即可。我在我的项目中使用以下代码来处理具有相同选择器和其他属性的许多按钮。

```
<LinearLayout android:id="@+id/group_news" style="@style/main_button_group" >
    <ImageView android:id="@+id/image_news" style="@style/main_button_image" android:src="@drawable/news" />
    <TextView android:id="@+id/text_news" style="@style/main_button_text" android:text="@string/button_news" />
</LinearLayout> 
```

（注意：我使用带有 ImageView 和 TextView 的 LinearLayout 而不是带有 drawableLeft 属性的 TextView，因为我正在替换代码中的图像。更改 drawableLeft 无法正常工作）

然后在 res\values 文件夹中创建一个styles.xml，其中所有按钮的属性都相同，例如：

```
<resources>
    <style name="main_button_group">
        <item name="android:layout_width">fill_parent</item>
        <item name="android:layout_height">wrap_content</item>
        <item name="android:orientation">horizontal</item>
        <item name="android:layout_marginTop">2dp</item>
        <item name="android:paddingTop">10dp</item>
        <item name="android:paddingBottom">10dp</item>
        <item name="android:paddingRight">10dp</item>
        <item name="android:paddingLeft">25dp</item>
        <item name="android:background">@drawable/main_button_states</item>
        <item name="android:focusable">true</item>
        <item name="android:clickable">true</item>
    </style>
    <style name="main_button_image">
        <item name="android:layout_width">wrap_content</item>
        <item name="android:layout_height">wrap_content</item>
        <item name="android:layout_gravity">center_vertical</item>
        <item name="android:contentDescription">@string/empty</item>
    </style>
    <style name="main_button_text">
        <item name="android:layout_width">fill_parent</item>
        <item name="android:layout_height">wrap_content</item>
        <item name="android:layout_margin">10dp</item>
        <item name="android:layout_gravity">center_vertical</item>
        <item name="android:gravity">center_horizontal</item>
        <item name="android:textSize">20dp</item>
        <item name="android:textColor">@color/general_value</item>
    </style>
</resources> 
```

选择器**@drawable/main_button_states**如下所示：

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_pressed="true" android:drawable="@drawable/main_button_pressed" />
    <item android:state_focused="true" android:drawable="@drawable/main_button_focused" />
    <item android:state_hovered="true" android:drawable="@drawable/main_button_focused" />
    <item android:drawable="@drawable/main_button_normal" />
</selector> 
```

这完美地工作。

# java - 如何缩放和设置 MediaView 的坐标？

> ID：10161931
> 
> 赞同：2
> 
> 时间：2012-04-15T12:15:51.980
> 
> 标签：java, javafx-2

我想在我的 JavaFx 2.x 场景中嵌入一个视频，并调整它的大小并将其重新定位到我的需要。我遇到的问题是。如果我构建一个`MediaView`组件然后平移 X 或 Y 坐标，那么整个视图将被**正确移动**，如下所示：

```
MediaView mv = (...)
mv.setTranslateX(200);
mv.setTranslateY(200); 
```

我可以使用缩放属性进行类似的转换：

```
MediaView mv = (...)
mv.setScaleX(2);
mv.setScaleY(2); 
```

这将在维度上**正确缩放** `mv`实例两倍。

然而，问题是当我结合这两个翻译时。该`mv`实例正在缩放，但它**总是以屏幕坐标结束`(0,0)`**。从我的角度来看，这当然是不正确的行为。

我还尝试将我的`MediaView`组件包装在某个包装器节点中，例如`Group`并在此元素上执行翻译。行为是相同的。

**如何同时正确移动和缩放`MediaView`组件？**

编辑：

这是我的代码，虽然我在这里使用`ImageView`。然而，这无关紧要。运行此代码后，图像将被放置在`(0,0)`而不是`(100,100)`.

```
 @Override
    public void start(Stage stage) throws Exception {
        Group root = new Group();

        // Img's dimension is 200x200
        javafx.scene.image.Image img = new javafx.scene.image.Image("/home/bachman/projects/cs-player/src/main/resources/content.png");
        ImageView iv = new ImageView(img);
        root.getChildren().add(iv);

        // Move Image View
        iv.setTranslateX(100);
        iv.setTranslateY(100);

        // Scale Image View
        iv.setScaleX(2.0);
        iv.setScaleY(2.0);

        Scene scene = new Scene(root);
        stage.setWidth(600);
        stage.setHeight(600);
        stage.setScene(scene);
        stage.show();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T17:55:14.423

当您使用 setScaleX、setScaleY 时，从节点的中心开始进行缩放。

如果除了缩放之外还想平移一个量，则在设置所需的平移值时需要考虑缩放扩展。例如，如果节点的大小加倍（并且您希望将节点平移到相对于未缩放节点的左上角的位置），则需要额外平移一半的节点宽度和高度。

```
import javafx.application.Application;
import javafx.scene.*;
import javafx.scene.media.*;
import javafx.scene.transform.*;
import javafx.stage.Stage;

public class TransformedVideo extends Application {
  public static void main(String[] args) throws Exception { launch(args); }
  @Override public void start(final Stage stage) throws Exception {
    final MediaPlayer oracleVid = new MediaPlayer(new Media("http://download.oracle.com/otndocs/products/javafx/oow2010-2.flv"));
    final MediaView mediaView = new MediaView(oracleVid);
    mediaView.setFitWidth(320); mediaView.setFitHeight(240); mediaView.setPreserveRatio(false);

    mediaView.setTranslateX(mediaView.getFitWidth()  / 2 + 200); 
    mediaView.setTranslateY(mediaView.getFitHeight() / 2 + 200);
    mediaView.setScaleX(2); mediaView.setScaleY(2);

// alternative method of scaling and translating.    
//    mediaView.getTransforms().addAll(
//      new Translate(200, 200),
//      new Scale(2, 2)
//    );

    Group group = new Group(mediaView);
    stage.setScene(new Scene(group, 1250, 800));
    stage.show();

    oracleVid.play();

    System.out.println(group.getBoundsInParent());
  }
} 
```

在一个节点上执行多个变换时，而不是使用 setScale/setTransform/setRotate 方法，通常更容易将变换列表提供给 getTransforms() 方法。

# javascript - 正则表达式从 div 的内部 html 替换字符串

> ID：10161934
> 
> 赞同：0
> 
> 时间：2012-04-15T12:16:22.203
> 
> 标签：javascript, jquery, html, regex

我有一个包含一些 html 和文本的 div（html 是动态添加的）结构会像

```
 <div id="contentContainer">
&nbsp; <span>ProductA</span> ; <span>ProductB</span>; prod
</div> 
```

我想在提交按钮单击时从 div contentContainer 的内部 html 中删除最后一个不完整的文本（产品）

为此，我使用了正则表达式 **returnText.replace(/\w+$/, '');** 它工作正常，因为我无法将文本修剪到';'的最后一个索引

但不是问题是当用户在不完整的文本中放入一些特殊字符时，正则表达式失败

那么是否有任何解决方案可以将最后附加的文本修剪为 div 的内部 html，或者我可以将文本修剪到最后一个 html 标记并放置；之后

请提出任何解决方案

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T12:22:02.120

如果您使用的是 jquery，您可以提取所有 span 元素并用它们替换 innerHTML。

```
$("#contentContainer").html( $("#contentContainer span") ); 
```

那应该清理休息的东西。也许不是最好的，但我认为它比内容上的正则表达式更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T12:39:38.237

解决方案查看 DIV 中的最后一个 DOM 节点，如果是文本节点，则将文本更改为分号

```
var lastNode = $('#contentContainer').contents().last()[0]

if (lastNode.nodeType == 3) {
    lastNode.textContent=';'
} 
```

演示：http: [//jsfiddle.net/EhcLh/](http://jsfiddle.net/EhcLh/)

# php - 无法将php变量传递给javascript

> ID：10161936
> 
> 赞同：0
> 
> 时间：2012-04-15T12:16:29.230
> 
> 标签：php, javascript

我正在尝试通过 onClick 属性将 php 变量传递给 javascript 函数。这是我尝试过但无法正常工作的代码部分：

```
<li id="' . $todo1 . '" class="items">' . $todo1 . '<button onclick="ajaxdelete(' . $todo1   . ')">Delete</button></li> 
```

Javascript函数

```
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script language="JavaScript" type="text/javascript">

 function ajaxdelete(x){
   var todo = x;
   var hr = new XMLHttpRequest();
   var url = "ajaxtododelete.php";
   var vars = "todo="+todo;
   hr.open("POST", url, true);
   //Random Ajax stuff
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T12:21:10.700

您需要在变量之前和之后放置一些 php 标签。例如在你的情况下：

`<? $todo1 ?>`

或者

```
<?php $todo1 ?> 
```

并确保 $todo1 获得了您希望使用的值。

==在您发表评论后更新似乎您希望将JS变量传递给php端......在这种情况下，您需要解决您的问题并将您的ajax调用中的数据传递给类似的东西：

```
hr.open("GET", url + "/?" + vars, true); 
```

由于您使用的是 POST，因此您不能只将 vars 添加到 url 的末尾（顺便说一句，在您的情况下，您没有使用“vars”，这是您在服务器中没有得到任何东西的方式）。

顺便说一句，您的 html 输出也将在这里有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T12:24:05.343

为了打印 PHP 变量中包含的值，您必须调用`echo`等`print`或将其括在双引号（不是单引号）之间。另外，放置 Ido Green 提到的 php 标签。

# jquery - jQuery 函数不适用于 AJAX 加载的内容

> ID：10161938
> 
> 赞同：3
> 
> 时间：2012-04-15T12:16:50.083
> 
> 标签：jquery, ajax

我有一个页面`index.html`：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <title>Lufia</title>
    <script src="js/jquery.js" language="javascript"></script>
    <script language="javascript">

    $(document).ready(function() {
      $("button").click(function() {
        $('#mydiv').html( 'Loading... ').load('welcome.html');
        $(this).hide();
      });
    });

    </script>
  </head>
  <body>
    <button>ajax</button><div id="mydiv"></div>
  </body>
</html> 
```

**在此代码中，当单击按钮时`midiv` `welcome.html`加载并且按钮被隐藏。**

`welcome.html`如下：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <title>Lufia</title>
  </head>
  <body>
    <button>New Button</button>
  </body>
</html> 
```

这个新按钮`onClick`不起作用。为什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-15T12:19:41.960

这里的简单解决方案 - 您需要使用 jQuery`.live()`函数为新按钮添加事件处理程序。

```
$("#newButton").live('click',function(){
  // Do stuff here
}); 
```

当您最初创建`.click()`处理程序时，第二个`button`还没有在 DOM 中，因此 jQuery 无法将事件处理程序附加到它。该`.live()`函数适用于 DOM 中已经存在的任何元素以及将来添加的任何元素（例如，来自 ajax 调用）。

您可能希望为您的新按钮（来自 ajax 调用）提供一个新的不同 ID，因为选择器`$("button")`将捕获您的两个按钮（即使一个按钮被隐藏）。

* * *

## 笔记！

从 jQuery 1.7 版本开始，该`live()`方法[已被弃用！](http://api.jquery.com/live/). 从 1.9 版开始，该函数将被完全删除...处理这些动态添加元素的事件处理程序的正确方法是现在使用该[`on()`函数。](http://api.jquery.com/on/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-20T06:48:57.640

不推荐使用 Live。你应该使用。

**$(document).on("click","button", function () {**

是 on 的实时/委托格式。

[http://api.jquery.com/live/](http://api.jquery.com/live/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-15T12:20:08.407

因为按钮没有绑定任何东西。

所以在welcome.html 中你必须添加代码来处理它。

或者; 您可以在函数中绑定 onclick 处理程序，然后在 ajax.done() 方法上将该处理程序绑定到新按钮。

最好的方法是执行以下操作：*注意*这根本没有经过测试。

```
<script language="javascript">
$(document).ready(function(){

var buttonClickEvent = function(){
  $.ajax({
     url: "test.html",
  }).done(function(results) { 
    $('#mydiv').html(results);
    $('button').live('click',buttonClickEvent);
  });
}

$("button").click(buttonClickEvent);

</script> 
```

或者：

`welcome.html`

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
 <title>Lufia</title>

<body><button>New Button</button>

<script>
 $(document).ready(function(){
    $("button").click(function(){
       //do something
    });
 });
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-23T10:12:09.790

正确检查您是否在代码中为 jquery 提供了正确的路径。这可能是代码不起作用的原因......

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-04-30T15:48:23.397

这通常是因为包含的文件不正确。

我已经包含了 jquery.hotkeys-0.7.9.min.js 并且它混淆了我的掩饰。

经过 2 小时的代码检查后，当我删除了文件时。问题解决了；

:)

# matlab - 来自相同投影矩阵的不同基本矩阵

> ID：10161940
> 
> 赞同：5
> 
> 时间：2012-04-15T12:16:59.160
> 
> 标签：matlab, computer-vision, projection-matrix, perspectivecamera, projective-geometry

我使用两个投影矩阵 P1 和 P2（例如我使用[恐龙数据集](http://www.robots.ox.ac.uk/~vgg/data1.html)），我需要计算基本矩阵 F。所以我使用两个 Matlab 函数：

*   Peter Kovesi 的函数：www.csse.uwa.edu.au/~pk/Research/MatlabFns/Projective/fundfromcameras.m
*   齐瑟曼：www.robots.ox.ac.uk/~vgg/hzbook/code/vgg_multiview/vgg_F_from_P.m

这些函数应该做同样的事情，但**我有不同的 F 值**！怎么可能？哪个是正确的功能？

如果两个点 X1 和 X2 在两个不同的图像中“相同”，则 X2^T*F*X1 = 0 ... 所以我通过使用 SURF 从两个旋转图像（5 度）中找到了两个对应点，但是 X2^T *F*X1 在这两个函数中永远不会等于零。有任何想法吗？

相反，如果我使用这个从匹配点计算 F 的函数：

*   由 Peter Kovesi 编写的 ransac 拟合基本矩阵：[ransacfitfundmatrix.m](http://%20http://www.csse.uwa.edu.au/~pk/Research/MatlabFns/Robust/ransacfitfundmatrix.m)

我有那个 X2^T*F*X1 = 0 .... 显然 F 与其他两个函数的两个 FI 不同...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T08:04:49.603

**基本矩阵仅在一定范围内**是唯一的。

因此，即使您有不同的基本矩阵，两者都可能对您的图像是正确的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T22:00:49.017

一方面，这些点极有可能不是彼此完美旋转的版本。SURF 使用了很多近似值、双线性插值和一大堆打破真正旋转不变性的东西。所以可能不存在这样的基本矩阵（如果两组点之间没有线性关系。）是的，即使在进行点匹配之后也是如此。

也就是说，`X2^T*F*X1`如果匹配真的很好，你可能应该很小，但如果任何真实图像都完全为零，我会感到惊讶。

# javascript - Javascript，检查多个数组的数字

> ID：10161946
> 
> 赞同：1
> 
> 时间：2012-04-15T12:18:06.033
> 
> 标签：javascript, jquery

我在这里寻找最好的解决方案，我有一个想法，但认为它可以做得更漂亮。

我正在制作一个简单的天气应用程序。如果他们有天气条件的代码，我正在使用 Yahoo Weather api。

根据条件，我给出一个代码。现在，有 50 个代码，我将它们分为 5 个类别。在我的情况下，前。我的类别 Snow 包含 15 个 Yahoo 的条件代码。

好吧，如果您有更好的想法（我敢打赌有），可以自由提出建议。

我的想法是从一组数组中返回匹配值，但不知道如何去做。

我的代码现在看起来像这样：

```
function getCondition(code) {
   var snow = [1, 2, 3],
       sun = [4, 5, 6];
} 
```

我需要的是包含代码匹配号的变量名？

我制作了一个 JS-Fiddle [http://jsfiddle.net/BH8r6/](http://jsfiddle.net/BH8r6/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T12:31:36.233

最快的查找（将 Yahoo 代码转换为您的标签）是将代码用作数组键（如果它们是连续的）。

```
var weather = [];
weather[0] = "no_weather"; 
weather[1] = "snow"; 
weather[2] = "snow"; 
weather[3] = "snow"; 
weather[4] = "sun";
weather[5] = "sun";
weather[6] = "sun"; 

function getCondition(code) {
   return weather[code];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T12:36:21.143

为什么要把一切都复杂化？！只需使用`'switch'`：

```
function getCondition(code) {
switch( code ){
    case 1:
    case 2:
    case 4:
    case 6:
        return "snow";
    case 3:
    case 8:
    case 9:
        return "sun";
    case 5:
    case 7:
    case 10:
        return "cloudy";        
}
return "none";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T12:26:19.510

Why dont you try an associative array when your key is your variable name and your values is the corresponding code for the variable name, thus your code will be something like this:

```
var myCodeArray=[];

myCodeArray["snow"]=[1, 2, 3];

myCodeArray["sun"] = [4, 5, 6]; 
```

now your method getCondition will be

```
function getCondition(code) 
{
    for(var definedCodeName in myCodeArray)
    {
      if(myCodeArray.hasOwnProperty(definedCodeName))
      {          
        var array=myCodeArray[definedCodeName ];
        for(var i=0;i<array.length;i++)
        {
            if(array[i]==code){
                return definedCodeName ;}
        }
      }
    }
    return "Not found";
} 
```

[**Demo**](http://jsfiddle.net/BH8r6/2/)

# javascript - 如何删除特定元素中的特定字符

> ID：10161947
> 
> 赞同：1
> 
> 时间：2012-04-15T12:18:11.933
> 
> 标签：javascript

如何从 div 中删除字符“，”。例如，

```
<div class="something">This, is, the, text. </div> 
```

现在我想使用javascript从那个div中删除所有的“，”。

请原谅我在 javascript 中太菜鸟。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-15T12:30:18.077

```
var elements = document.getElementsByClassName("something");
elements[0].innerHTML = elements[0].innerHTML.replace(/,/g,''); 
```

看看这个例子：http: [//jsfiddle.net/QpJNZ/](http://jsfiddle.net/QpJNZ/)

更新：

```
var elements = document.getElementsByClassName("something");
for (var i = 0; i < elements.length; ++i) {
  elements[i].innerHTML = elements[i].innerHTML.replace(/,/g,'');
} 
```

这是如何使这项工作适用于多个元素。

看看这个例子：http: [//jsfiddle.net/VBEAQ/2/](http://jsfiddle.net/VBEaQ/2/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-15T12:25:25.327

如果元素*只*包含文本而没有其他元素，您可以简单地获取元素的内部内容，然后执行字符串替换：

```
element.innerHTML = element.innerHTML.replace(/,/g, ''); 
```

要替换所有出现的字符序列，您必须使用带有`g`lobal 修饰符的正则表达式。

如果元素包含其他元素，您可以遍历所有子文本节点：

```
function replace(element, needle, repl) {
    var children = element.childNodes,    // get a list of child nodes
        pattern = new RegExp(needle, 'g'),  // prepare pattern
        child, i, l;

    for(i = 0, l = children.length; i < l; i++) {
        child = children[i];
        if(child.nodeType === 3) {       // if we deal with a text node
            child.nodeValue = child.nodeValue.replace(pattern, repl); // replace
        }
    }
} 
```

需要注意的事项：

*   如果您要搜索的文本包含特殊的正则表达式字符，[您必须先正确转义它们](https://stackoverflow.com/questions/5663987/how-to-properly-escape-characters-in-regexp)。

*   如果您还想替换子元素内的文本，则必须为每个元素节点（`nodeType`is `1`）递归调用此函数。

**参考：** [`String.replace`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/replace) , [`Node.childNodes`](https://developer.mozilla.org/En/DOM/Node.childNodes), [`Node.nodeType`](https://developer.mozilla.org/En/DOM/Node.nodeType), [`Node.nodeValue`](https://developer.mozilla.org/En/DOM/Node.nodeValue),[`RegExp`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/RegExp)

# javascript - Twitter 引导按钮是否适用于 iPad？

> ID：10161948
> 
> 赞同：1
> 
> 时间：2012-04-15T12:18:16.963
> 
> 标签：javascript, html, twitter-bootstrap

Twitter 提供了这些[漂亮的按钮](http://twitter.github.com/bootstrap/javascript.html#buttons)，可以用来代替单选框/复选框。

![引导按钮](../Images/4cc4e3eff0e849f0bd95905964cfef8e.png)

有没有人在生产中使用过它们？如果是，那么它们的工作情况如何？特别是，我想知道这些按钮是否可以在 iPad 上使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T12:25:31.163

当然是。如果您查看他们的[Bootstrap，从 Twitter 主页](http://twitter.github.com/bootstrap/)您可以看到

> **跨越一切**
> 
> 最初只考虑现代浏览器构建，Bootstrap 已经发展到包括对所有主要浏览器（甚至 IE7！）的支持，并且使用 Bootstrap 2，平板电脑和智能手机也是如此。

还有 ipadzip.com，它以 nodejs 和 bootstrap 为例。

# ruby-on-rails - Phusion 乘客诉 WEBrick

> ID：10161950
> 
> 赞同：5
> 
> 时间：2012-04-15T12:18:25.207
> 
> 标签：ruby-on-rails, passenger, webrick

就生产环境而言，使用 Phusion Passenger 或仅使用 WEBrick（例如 rails s）有什么区别？

我知道 Phusion Passenger 在 Apache 或 Nginx 上安装了一个模块，但它是一个成熟的 ruby​​ 服务器吗？它只是将流量转发回 WEBrick 实例吗？

如果Passenger只是将流量转发回任何ruby服务器，为什么不直接使用`rvmsudo rails server -d -p80`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-15T12:26:40.587

Phusion Passenger is a full fledged rails server. When it is used WEBrick is not involved.

WEBrick is just a reference web server to be used temporarily until you set up a production level web server. It is not particularly optimized. It is intended for you to find a better web server for production.

# php - 如何恢复由于 PHP 错误而崩溃的 Symfony 应用程序？PHP 5.3.1 / 阿帕奇 2.2.14

> ID：10161951
> 
> 赞同：0
> 
> 时间：2012-04-15T12:18:35.167
> 
> 标签：php, apache, symfony-1.4

我在 Apache 2.2.14 上的 PHP 5.3.1 上遇到了这个奇怪的错误。我浏览了论坛，最怀疑这是一个 PHP 问题内存泄漏问题。在升级 PHP 时，我想知道是否有办法让服务器恢复 - 以编程方式重新启动。目前，我必须手动启动停止 Apache

```
Warning: Attempt to assign property of non-object in D:\xampp_ext\xampp\htdocs\soki\test.soki.com\symfony\lib\autoload\sfCoreAutoload.class.php on line 38

Warning: require(/config/sfProjectConfiguration.class.php) [function.require]: failed to open stream: No such file or directory in D:\xampp_ext\xampp\htdocs\soki\test.soki.com\symfony\lib\autoload\sfCoreAutoload.class.php on line 99

Fatal error: require() [function.require]: Failed opening required '/config/sfProjectConfiguration.class.php' (include_path='.;d:\xampp_ext\xampp\php\PEAR') in D:\xampp_ext\xampp\htdocs\soki\test.soki.com\symfony\lib\autoload\sfCoreAutoload.class.php on line 99 
```

我在 Apache 2.2.14 上使用 PHP 5.3.1![在此处输入图像描述](../Images/56b713228d094535684b6d035cfc6171.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T12:54:54.057

PHP 是由 Apache 运行的，所以如果 Apache 确实崩溃了，你不能轻易地使用 PHP 再次启动 Apache，**除非 PHP 被 Apache 之外的其他程序调用**（例如：通过调用 PHP 将 PHP 作为 cron 作业/计划任务运行.exe [script.php] 直接）。

我通过错误消息中的路径假设您正在使用 Windows 环境（显然）。如果进程没有运行，您不希望在后台一遍又一遍地启动 Apache 的脚本或程序；这很乱。你*可以*，但这远非理想。

你怎么知道 Apache 崩溃了？您提供的错误来自 PHP，而不是 Apache。如果您刷新页面并且仍然看到错误（或除了连接失败/强制拒绝/等之外的任何内容），那么 Apache 仍在运行。

*   仔细检查 Apache 确实不再运行
*   检查 Apache 日志文件夹中的错误日志
*   报告您的发现

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T16:52:39.733

假设您使用 mod_php 需要使用 Apache prefork worker 模型。有一个配置设置可用于实现解决方法：

使用[MaxRequestsPerChild](http://httpd.apache.org/docs/2.0/en/mod/mpm_common.html#maxrequestsperchild)指令，您可以设置在子进程被回收之前将处理的请求数量。**解决方法：**将其设置为较低的值，以便 Apache 更频繁地回收它的子代。

```
<IfModule prefork.c>
StartServers       2
MinSpareServers    3
MaxSpareServers    3
ServerLimit       30
MaxClients        30
MaxRequestsPerChild  200
</IfModule> 
```

请记住，这只是一个肮脏的黑客攻击，而不是您问题的严肃解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T13:06:19.733

我阅读了大量关于该错误的博客文章，我最好的选择是升级到 PHP 5.3 并解决了问题。这肯定是由于某处的内存泄漏导致无法加载其他文件

# jquery - jQuery UI 可排序窗口滚动

> ID：10161959
> 
> 赞同：3
> 
> 时间：2012-04-15T12:19:41.273
> 
> 标签：jquery, jquery-ui-sortable

我正在使用可排序的 jquery ui。在没有窗口滚动的情况下，我的可分类项目可以工作并留在安全壳中。但是，如果我滚动窗口并开始对项目进行排序，我的项目首先移动到与窗口滚动相同的高度，不再粘在鼠标指针上！！！我做错了什么？

```
 var purchased = [];
$("#listitems").sortable({
    revert: true,
    containment: '#drop',
    stop: function(event, ui) { 
        purchased = [];
        $("#listitems li").each(function () {
            var elem = $(this);
            var st = elem.attr('id');
            if (jQuery.inArray(st, purchased) == -1) {
                purchased.push(st);
            }
        });
        console.log(purchased);
    }
});

    <div id="drop" class="clearfix" style="position:relative;margin:0 auto;min-height:160px;height:auto!important;height:160px;;margin-bottom:20px; border-top:1px solid #D4D4D4;border-bottom:1px solid #DADADA">
        <div style="position:absolute;top:-31px;left:10px; z-index:0"><h1 id="depose" style="font-size:2.6em; line-height:1em; color:#EBEBEB; font-weight:700; z-index:0">DRAG HERE</h1></div>
        <ul id="listitems" style="position:relative;z-index:11" class="alt_content galerie-thumbs">
<li>image 1</li>
<li>image 2</li>
...
        </ul>
    </div> 
```

谢谢你的帮助...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-05-08T18:33:43.393

将 a 添加`overflow: auto;`到列表的父级/容器中。

# c# - 在gridview中更改页面时，如何通过或保留我的已选中复选框？

> ID：10161961
> 
> 赞同：1
> 
> 时间：2012-04-15T12:19:44.433
> 
> 标签：c#, asp.net, gridview, datagridviewcheckboxcell

我有一个包含复选框的gridview。当我单击它们时，它会转到 SelectedRss_Click 功能，因此我可以保留数据。但是，当我更改 gridview 的页面时，已选中的复选框未选中。我怎么解决这个问题。

我的 SelectedRss_Click 函数。

```
protected void SelectedRss_Click(object sender, EventArgs e)
{
    ArrayList list = new ArrayList();
    ArrayList listcategory = new ArrayList();
    list.Clear();
    listcategory.Clear();                
    foreach (GridViewRow row in GridView1.Rows)
    {
        // Access the CheckBox
        CheckBox cb = (CheckBox)row.FindControl("FeedSelector");
        if (cb != null && cb.Checked)
        {
            string feedURL = ((HiddenField)GridView1.Rows[row.RowIndex].FindControl("HiddenField1")).Value;
            string rsscategory = GridView1.Rows[row.RowIndex].Cells[2].Text.ToString();
            list.Add(feedURL);
            listcategory.Add(rsscategory);
            Session["SelectedFeedURL"] = list;
            Session["SelectedFeedCategory"] = listcategory;
         }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T12:32:14.607

**[视图状态](http://msdn.microsoft.com/en-us/library/ms972976.aspx)**

这是因为到[**页面生命周期**](http://msdn.microsoft.com/en-us/library/ms972976.aspx#viewstate_topic2)结束时，所有控件都会丢失`Disposed`和丢失。`State of the Page`

*   **预防措施**

    在更改页面时`GridView`，`PageindexChanging`如果出现`GridView`，保存当前页面的选中复选框行详细信息`ViewState`。`ViewState`同样，您可以从未选中的 GridView行中删除这些`CheckBox`行。

*   **纠正措施**

    保存的记录`ViewState`将在`PageIndexChanging`事件的 GridView 中检查。

# c# - 通过不同环境的代码检查 32 位？

> ID：10161962
> 
> 赞同：1
> 
> 时间：2012-04-15T12:19:47.447
> 
> 标签：c#, .net, .net-4.0, 32bit-64bit

我知道`IntPtr.Size` 可以检查64位或32位。（`8 || 4`字节）

问题 ：

是`IntPtr.Size`关于

*   操作系统平台

或者

*   .net 编译版本（我可以编译为 32 或 64）

*你能检查并更正这张表吗？*

```
compiled to | running OS | IntPtr.Size
______________________________________
      64             32       wont run
      64             64         8
      32             32         4
      32             64         4 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T12:34:07.800

我会这样写表格：

```
 target  |     OS     | IntPtr.Size
______________________________________
      x64          32       wont run
      x64          64         8
   AnyCPU          32         4
   AnyCPU          64         8
      x86          32         4
      x86          64         4 
```

强烈暗示您始终希望以 AnyCPU 为目标，而不是 x64。如果您知道需要使用仅在 32 位机器代码中可用的非托管代码（通常是 COM 服务器），则仅针对 x86。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T12:27:34.657

该表是正确的，只要您的“运行”列指的是操作系统的位数，而不是 CPU 的位数。

请记住，实际上有三个选项：32、64 和 AnyCPU：

```
 compiled to | running on      | IntPtr.Size
___________________________________________
      64        |    32           | won't run
      64        |    64           |  8
      32        |    32           |  4
      32        |    64           |  4
      AnyCPU    |    32           |  4
      AnyCPU    |    64           |  8 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-15T13:57:54.217

你必须以正确的顺序得到这个。将代码编译为 IL 时，可以选择 32、64 或 Any CPU。当 IL 将 JIT 编译为本机时，它会查看它在 PE 标头中）。如果您强制使用位数，它将 JIT（除非您强制使用 64 位并且您使用的是 32 位操作系统！）到操作系统的位数。

所以 sizeof 会告诉你你的 IL 已经编译成的本机代码的位数。

您不能依靠它来告诉您处理器的位数（64 位芯片上的 32 位操作系统）

并且您不能依靠它来告诉您操作系统的位数（64 位操作系统上的 32 位进程）

如果它返回为 8，那么您在 64 位操作系统上，因此必须在 64 位芯片上，因为没有其他方法可以发生，直到我们得到 128 位芯片和操作系统......

如果它返回 4，那么您必须进行不同的检查以发现操作系统或芯片的位数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-15T12:29:42.420

它取决于操作系统平台，而*不是*目标编译类型。

# regex - Perl 正则表达式匹配 IP 地址

> ID：10161963
> 
> 赞同：12
> 
> 时间：2012-04-15T12:20:02.990
> 
> 标签：regex, perl, ip

我已经编写了这段代码，但它不起作用。有人可以指出这个问题吗？

```
sub match_ip()
{
  my $ip = "The IP address is 216.108.225.236:60099";
  if($ip =~ /(\d{1-3}\.\d{1-3}\.\d{1-3}\.\d{1-3}\:\d{1-5})/)
  {
      print "$1\n";
  }
} 
```

编辑：我只想提取 IP 地址，不做任何验证。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-15T12:22:03.350

更改`{1-3}`为`{1,3}`相同`{1-5}`->`{1,5}`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-16T01:53:34.417

本着 TIMTOWTDI 的精神，这里是另一个： 的[`Regexp::Common::net`](https://metacpan.org/module/Regexp%3a%3aCommon%3a%3anet)部分[`Regexp::Common`](https://metacpan.org/module/Regexp%3a%3aCommon)可能有你想要的正则表达式。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-15T14:12:38.810

或者，您可以使用[`Data::Validate::IP`](https://metacpan.org/module/Data%3a%3aValidate%3a%3aIP), 并注意它无法识别端口，因此您必须`split`on `:`。

```
use strict;
use warnings;
use Data::Validate::IP;

my $ip_with_port="216.108.225.236:60099";
my $ip=(split /:/,$ip_with_port)[0];

my $validator=Data::Validate::IP->new;

if($validator->is_ipv4($ip))
{
  print "Yep, $ip is a valid IPv4 address.\n";
}
else
{
  print "Nope, $ip is not a valid IPv4 address.\n";
} 
```

输出是：

```
Yep, 216.108.225.236 is a valid IPv4 address. 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-15T12:23:29.670

用逗号替换破折号。

```
/(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\:\d{1,5})/ 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-16T20:43:28.090

虽然在 CPAN 有很好的文档和测试模块来匹配和验证 IP 地址，但你必须有充分的理由不使用它。就我个人而言，我从来没有真正的理由将它们用于验证目的，因为我信任/提供了输入。

这是您的正则表达式的较短版本，它有自己的缺陷：

```
while (my $ip = <DATA>)  {
    chomp $ip;
    # older version
    # if($ip =~ /(\d{1-3}\.\d{1-3}\.\d{1-3}\.\d{1-3}\:\d{1-5})/)

    # see below for explanation
    if ($ip =~ /\b(\d{1,3}(?:\.\d{1,3}){3}:\d{1,5})\b/)
    {
        print "$ip - matches\n";
    } else {
        print "$ip - does not match\n";
    }
}

__DATA__
216.108.225.236:60099
4.2.2.1:1
216.108.225.236:0
1216.1108.1225.1236:1234
216.108.225.236x:123
9216.108.225.236:8472
10.10.10.10 
```

结果：

```
216.108.225.236:60099 - matches
4.2.2.1:1 - matches
216.108.225.236:0 - matches
1216.1108.1225.1236:1234 - does not match
216.108.225.236x:123 - does not match
9216.108.225.236:8472 - does not match
10.10.10.10 - does not match 
```

解释：

```
/\b             # word boundary
(               # start memory capture group 1
\d{1,3}         # one to three digits, first octat
(:?             # start non memory capture group, notice ?:
  \.\d{1,3}     # a literal dot followed by an ip octet
)               # end non memory capture group
{3}             # three times of dots and ip octets
:               # match a colon
\d{1,5}         # port number, one to five digits
)               # end of memory capture group 1
\b              # word boundary 
```

希望这可以帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-11-26T11:15:01.537

这可能会有所帮助：

```
my $ip = "195.249.61.14";

my @ips = (
    "set protocols bgp group IBGP-RRCL-CUSTOMER neighbor 195.249.61.142",
    "set protocols bgp group IBGP-RRCL-CUSTOMER neighbor 195.249.61.14",
    "set protocols bgp group IBGP-RRCL-CUSTOMER neighbor 195.249.61.141"
);

foreach (@ips) {
   print "$_\n" if ( /\b$ip\b/ );
} 
```

输出：

```
set protocols bgp group IBGP-RRCL-CUSTOMER neighbor 195.249.61.14 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-09-20T11:50:35.307

```
#!/usr/bin/perl

$str = 'IP address is : 70.21.311.105';

    if ($str =~ m/(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})/) {
        if ($1 <= 255 && $2 <= 255 && $3 <= 255 && $4 <= 255 ) {
            print "Valid $str\n";
    } else {
          print "invalid IP $str\n";
    }
}

__END__ 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-05-15T11:55:28.543

试试这个：

```
$variablename=~m/((((0-9)|((1-9)(0-9))|(1([0-9]){2})|(2[0-4][0-9])|(2[5][0-5]))\.){3})((0-9)|((1-9)(0-9))|(1([0-9]){2})|(2[0-4][0-9])|(25[0-5]))/) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-05-02T09:09:44.847

```
use strict;
use warnings;
open(FH,"<fileName.txt") or die "file not found ,$_";
while(my $line=<FH>)
{
push(my @arr,($line));
foreach my $arrVal (@arr)
{           
if($arrVal=~/IPv4 Address(?=.*\b((25[0-5]|2[0-4]\d|[0-1]?\d?\d)(\.(25[0-5]|2  [0-4]\d|[0-1]?\d?\d)){3})\b)/)
{
print "$arrVal\n";
}
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2014-01-13T22:24:27.200

您还可以使用以下正则表达式来确保四边形不大于 255，它还“重用”数字匹配而不是复制粘贴 4 次。

```
my $rx = qr/^(?!(\.))(\.?(\d{1,3})(?(?{$^N > 255})(*FAIL))){4}$/;
if('192.168.1.2' =~ $rx){
  print "OK\n";
} 
```

它使用了 perl 正则表达式匹配（man perlre）的一些特性：

*   (*FAIL)：停止模式匹配并失败
*   (?(condition)...)：条件匹配
*   (?{ code })：在该条件下使用

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2013-08-13T05:45:45.010

```
$ip = "10.255.256.1";

# will accept valid ips
if ($ip =~ m/^([1|2][0-9]{1,2})\.([0-255]{1,3}\.){2}[0-255]{1,3}/ && ($1 <=255)) {

  print "This is a valid ip: $ip \n";
 } else {
   print "This is not a valid ip: $ip \n";
} 
```

# algorithm - 尝试字节编译时提高球拍代码和错误的性能

> ID：10161971
> 
> 赞同：10
> 
> 时间：2012-04-15T12:20:38.213
> 
> 标签：algorithm, scheme, racket

我将来自不同来源的几个代码片段拼凑在一起，并在[http://bit.ly/HWdUqK](http://bit.ly/HWdUqK)上创建了 Wolfram 博客文章的[粗略实现](http://dl.dropbox.com/u/10901898/yearcalc.rkt)- 对于那些有数学倾向的人来说，这非常有趣！

毫不奇怪，鉴于我仍然是 Racket 的新手，代码需要花费太多时间来计算结果（> 90 分钟而作者为 49 秒）并且会占用大量内存。我怀疑这完全是关于需要修改的定义（expListY）。

虽然我有它在 DrRacket 中工作，但我也遇到了字节编译源的问题，并且仍在处理它（错误消息`+: expects type <number> as 1st argument, given: #f; other arguments were: 1 -1`：）

有人想尝试提高性能和效率吗？对于难以理解的代码和缺乏更好的代码注释，我深表歉意。

PS：我应该直接在这里剪切和粘贴代码吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-16T07:54:19.613

可能类似于 soegaard 的解决方案，除了这个会推出自己的“解析器”，因此它是自包含的。它在我的机器上不到 6 秒就生成了完整的 100 年列表。这段代码使用了很多技巧，但实际上并不是以任何严肃的方式被称为“优化”的东西：我相信它可以通过一些记忆、关注最大化树共享等变得更快。但是对于这么小的域，不值得付出努力......（这段代码的质量也是如此......）

BTW#1，除了解析之外，使用的原始解决方案`eval`不会让事情变得更快......对于这样的事情，通常最好手动编写“评估器”。顺便说一句#2，这并不意味着 Racket 比 Mathematica 快——我确信那篇文章中的解决方案也让它磨削了多余的 CPU 周期，并且类似的解决方案会更快。

```
#lang racket

(define (tuples list n)
  (let loop ([n n])
    (if (zero? n)
      '(())
      (for*/list ([y (in-list (loop (sub1 n)))] [x (in-list list)])
        (cons x y)))))

(define precedence
  (let ([t (make-hasheq)])
    (for ([ops '((#f) (+ -) (* /) (||))] [n (in-naturals)])
      (for ([op ops]) (hash-set! t op n)))
    t))

(define (do op x y)
  (case op
    [(+) (+ x y)] [(-) (- x y)] [(*) (* x y)] [(/) (/ x y)]
    [(||) (+ (* 10 x) y)]))

(define (run ops nums)
  (unless (= (add1 (length ops)) (length nums)) (error "poof"))
  (let loop ([nums     (cddr nums)]
             [ops      (cdr ops)]
             [numstack (list (cadr nums) (car nums))]
             [opstack  (list (car ops))])
    (if (and (null? ops) (null? opstack))
      (car numstack)
      (let ([op    (and (pair? ops) (car ops))]
            [topop (and (pair? opstack) (car opstack))])
        (if (> (hash-ref precedence op)
               (hash-ref precedence topop))
          (loop (cdr nums)
                (cdr ops)
                (cons (car nums) numstack)
                (cons op opstack))
          (loop nums
                ops
                (cons (do topop (cadr numstack) (car numstack))
                      (cddr numstack))
                (cdr opstack)))))))

(define (expr ops* nums*)
  (define ops  (map symbol->string ops*))
  (define nums (map number->string nums*))
  (string-append* (cons (car nums) (append-map list ops (cdr nums)))))

(define nums  (for/list ([i (in-range 10 0 -1)]) i))
(define year1 2012)
(define nyears 100)
(define year2 (+ year1 nyears))
(define years (make-vector nyears '()))
(for ([ops (in-list (tuples '(+ - * / ||) 9))])
  (define r (run ops nums))
  (when (and (integer? r) (<= year1 r) (< r year2))
    (vector-set! years (- r year1)
                 (cons ops (vector-ref years (- r year1))))))

(for ([solutions (in-vector years)] [year (in-range year1 year2)])
  (if (pair? solutions)
    (printf "~a = ~a~a\n"
            year (expr (car solutions) nums)
            (if (null? (cdr solutions))
              ""
              (format " (~a more)" (length (cdr solutions)))))
    (printf "~a: no combination!\n" year))) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-15T22:42:20.193

下面是我的实现。我在你的代码中调整和优化了一两件事，在我的笔记本电脑上大约需要 35 分钟才能完成（当然是一个改进！）我发现表达式的评估是真正的性能杀手——如果不是因为调用该程序`to-expression`，程序将在一分钟内完成。

我想在原生使用中缀表示法的编程语言中，评估会快得多，但在 Scheme 中，解析然后评估带有中缀表达式的字符串的成本实在是太多了。

也许有人可以指出一个合适的[`soegaard/infix`](http://planet.racket-lang.org/package-source/soegaard/infix.plt/1/0/planet-docs/manual/index.html)包装替代品？或者，一种直接评估考虑运算符优先级的中缀表达式列表的方法，例如`'(1 + 3 - 4 & 7)`- where`&`代表数字连接并具有最高优先级（例如：）`4 & 7 = 47`，而其他算术运算符 ( `+, -, *, /`) 遵循通常的优先级规则。

```
#lang at-exp racket

(require (planet soegaard/infix)
         (planet soegaard/infix/parser))

(define (product lst1 lst2) 
  (for*/list ([x (in-list lst1)] 
              [y (in-list lst2)]) 
    (cons x y))) 

(define (tuples lst n)
  (if (zero? n)
      '(())
      (product lst (tuples lst (sub1 n)))))

(define (riffle numbers ops)
  (if (null? ops)
      (list (car numbers))
      (cons (car numbers)
            (cons (car ops)
                  (riffle (cdr numbers)
                          (cdr ops))))))

(define (expression-string numbers optuple)
  (apply string-append
         (riffle numbers optuple)))

(define (to-expression exp-str)
  (eval
   (parse-expression
    #'here (open-input-string exp-str))))

(define (make-all-combinations numbers ops)
  (let loop ((opts (tuples ops (sub1 (length numbers))))
             (acc '()))
    (if (null? opts)
        acc
        (let ((exp-str (expression-string numbers (car opts))))
          (loop (cdr opts)
                (cons (cons exp-str (to-expression exp-str)) acc))))))

(define (show-n-expressions all-combinations years)
  (for-each (lambda (year)
              (for-each (lambda (comb)
                          (when (= (cdr comb) year)
                            (printf "~s ~a~n" year (car comb))))
                        all-combinations)
              (printf "~n"))
            years)) 
```

像这样使用它来复制原始[博客文章](http://blog.wolfram.com/2012/02/02/happy-109876-54321/)中的结果：

```
(define numbers '("10" "9" "8" "7" "6" "5" "4" "3" "2" "1"))
(define ops '("" "+" "-" "*" "/"))
; beware: this takes around 35 minutes to finish in my laptop
(define all-combinations (make-all-combinations numbers ops))
(show-n-expressions all-combinations
                    (build-list 5 (lambda (n) (+ n 2012)))) 
```

**更新 ：**

我捕获了 Eli Barzilay 的表情评估器并将其插入我的解决方案中，现在所有组合的预计算大约在 5 秒内完成！该`show-n-expressions`过程仍然需要一些工作来避免每次迭代整个组合列表，但这留给读者作为练习。重要的是，现在对所有可能的表达式组合的值进行暴力破解的速度非常快。

```
#lang racket

(define (tuples lst n)
  (if (zero? n)
      '(())
      (for*/list ((y (in-list (tuples lst (sub1 n))))
                  (x (in-list lst)))
        (cons x y))))

(define (riffle numbers ops)
  (if (null? ops)
      (list (car numbers))
      (cons (car numbers)
            (cons (car ops)
                  (riffle (cdr numbers)
                          (cdr ops))))))

(define (expression-string numbers optuple)
  (string-append*
   (map (lambda (x)
          (cond ((eq? x '&) "")
                ((symbol? x) (symbol->string x))
                ((number? x) (number->string x))))
        (riffle numbers optuple))))

(define eval-ops
  (let ((precedence (make-hasheq
                     '((& . 3) (/ . 2) (* . 2)
                       (- . 1) (+ . 1) (#f . 0))))
        (apply-op   (lambda (op x y)
                      (case op
                        ((+) (+ x y)) ((-) (- x y))
                        ((*) (* x y)) ((/) (/ x y))
                        ((&) (+ (* 10 x) y))))))
    (lambda (nums ops)
      (let loop ((nums     (cddr nums))
                 (ops      (cdr ops))
                 (numstack (list (cadr nums) (car nums)))
                 (opstack  (list (car ops))))
        (if (and (null? ops) (null? opstack))
            (car numstack)
            (let ((op    (and (pair? ops) (car ops)))
                  (topop (and (pair? opstack) (car opstack))))
              (if (> (hash-ref precedence op)
                     (hash-ref precedence topop))
                  (loop (cdr nums)
                        (cdr ops)
                        (cons (car nums) numstack)
                        (cons op opstack))
                  (loop nums
                        ops
                        (cons (apply-op topop (cadr numstack) (car numstack))
                              (cddr numstack))
                        (cdr opstack)))))))))

(define (make-all-combinations numbers ops)
  (foldl (lambda (optuple tail)
           (cons (cons (eval-ops numbers optuple) optuple) tail))
         empty (tuples ops (sub1 (length numbers)))))

(define (show-n-expressions all-combinations numbers years)
  (for-each (lambda (year)
              (for-each (lambda (comb)
                          (when (= (car comb) year)
                            (printf "~s ~a~n"
                                    year
                                    (expression-string numbers (cdr comb)))))
                        all-combinations)
              (printf "~n"))
            years)) 
```

像这样使用它：

```
(define numbers '(10 9 8 7 6 5 4 3 2 1))
(define ops '(& + - * /))
; this is very fast now!
(define all-combinations (make-all-combinations numbers ops))
(show-n-expressions all-combinations numbers
                    (build-list 5 (lambda (n) (+ n 2012)))) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-16T07:32:47.150

正如 Óscar 指出的那样，问题在于 soegaard/infix 对于这类问题来说很慢。

我在 GitHub 上找到了一个用于中缀表达式的标准 shunting-yard 解析器，并在 Racket 中编写了以下程序：

```
#lang racket
(require "infix-calc.scm")

(define operators '("*" "/" "+" "-" ""))
(time
(for*/list ([o1  (in-list operators)]
            [o2  (in-list operators)]
            [o3  (in-list operators)]
            [o4  (in-list operators)]
            [o5  (in-list operators)]
            [o6  (in-list operators)]
            [o7  (in-list operators)]
            [o8  (in-list operators)]
            [o9  (in-list operators)]
            [expr (in-value
                  (apply string-append
                        (list "1" o1 "2" o2 "3" o3 "4" o4 "5" o5 "6" o6 "7" o7 "8" o8 "9" o9 "10")))]
             #:when (= (first (calc expr)) 2012))
 expr)) 
```

不到 3 分钟后，结果如下：

```
Welcome to DrRacket, version 5.2.900.2--2012-03-29(8c22c6c/a) [3m].
Language: racket; memory limit: 128 MB.
cpu time: 144768 real time: 148818 gc time: 25252
'("1*2*3+4*567*8/9-10"
  "1*2+34*56+7+89+10"
  "1*23+45*6*7+89+10"
  "1+2+3/4*5*67*8+9-10"
  "1+2+3+4*567*8/9-10"
  "1+2+34*56+7+8+9*10"
  "1+23+45*6*7+8+9*10"
  "1-2+345*6-7*8+9-10"
  "12*34*5+6+7*8-9*10"
  "12*34*5+6-7-8-9-10"
  "1234+5-6+789-10") 
```

中缀解析器由 Andrew Levenson 编写。解析器和上面的代码可以在这里找到：

[https://github.com/soegaard/Scheme-Infix-Calculator](https://github.com/soegaard/Scheme-Infix-Calculator)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-16T01:28:17.087

这不是一个完整的答案，但我认为这是 Óscar López 要求的图书馆的替代品。不幸的是它在clojure中，但希望它足够清楚......

```
(def default-priorities
  {'+ 1, '- 1, '* 2, '/ 2, '& 3})

(defn- extend-tree [tree priorities operator value]
  (if (seq? tree)
    (let [[op left right] tree
          [old new] (map priorities [op operator])]
      (if (> new old)
        (list op left (extend-tree right priorities operator value))
        (list operator tree value)))
    (list operator tree value)))

(defn priority-tree
  ([operators values] (priority-tree operators values default-priorities))
  ([operators values priorities] (priority-tree operators values priorities nil))
  ([operators values priorities tree]
    (if-let [operators (seq operators)]
      (if tree
        (recur
          (rest operators) (rest values) priorities
          (extend-tree tree priorities (first operators) (first values)))
        (let [[v1 v2 & values] values]
          (recur (rest operators) values priorities (list (first operators) v1 v2))))
      tree)))

; [] [+ & *] [1 2 3 4] 1+23*4
; [+ 1 2] [& *] [3 4] - initial tree
; [+ 1 [& 2 3]] [*] [4] - binds more strongly than + so replace right-most node
; [+ 1 [* [& 2 3] 4]] [] [] - descend until do not bind more tightly, and extend

(println (priority-tree ['+ '& '*] [1 2 3 4])) ; 1+23*4
(println (priority-tree ['& '- '* '+ '&] [1 2 3 4 5 6])) ; 12 - 3*4 + 56 
```

输出是：

```
(+ 1 (* (& 2 3) 4))
(+ (- (& 1 2) (* 3 4)) (& 5 6)) 
```

[**更新**]添加以下内容

```
(defn & [a b] (+ b (* 10 a)))

(defn all-combinations [tokens length]
  (if (> length 0)
    (for [token tokens
          smaller (all-combinations tokens (dec length))]
      (cons token smaller))
    [[]]))

(defn all-expressions [operators digits]
  (map #(priority-tree % digits)
    (all-combinations operators (dec (count digits)))))

(defn all-solutions [target operators digits]
  (doseq [expression
          (filter #(= (eval %) target)
            (all-expressions operators digits))]
    (println expression)))

(all-solutions 2012 ['+ '- '* '/ '&] (range 10 0 -1)) 
```

解决了问题，但速度很慢 - 28 分钟即可完成。这是在一台不错的、相当新的笔记本电脑（i7-2640M）上。

```
(+ (- (+ 10 (* 9 (& 8 7))) (& 6 5)) (* 4 (& (& 3 2) 1)))
(+ (- (+ (+ (* (* 10 9) 8) 7) 6) 5) (* 4 (& (& 3 2) 1)))
(- (- (+ (- (& 10 9) (* 8 7)) (* (& (& 6 5) 4) 3)) 2) 1) 
```

（我只打印了 2012 年 - 见上面的代码 - 但它会评估整个序列）。

所以，不幸的是，这并不能真正回答这个问题，因为它并不比 Óscar López 的代码快。我想下一步是在评估中加入一些聪明才智，这样可以节省一些时间。但是什么？

[**更新 2** ] 在阅读了这里的其他帖子后，我替换`eval`为

```
(defn my-eval [expr]
  (if (seq? expr)
    (let [[op left right] expr]
      (case op
        + (+ (my-eval left) (my-eval right))
        - (- (my-eval left) (my-eval right))
        * (* (my-eval left) (my-eval right))
        / (/ (my-eval left) (my-eval right))
        & (& (my-eval left) (my-eval right))))
    expr)) 
```

运行时间降至 45 秒。仍然不是很好，但它是一个非常低效的解析/评估。

[**更新 3** ] 为完整起见，以下是调车场算法（一个始终为左关联的简单算法）和相关评估的实现，但它仅将时间减少到 35 秒。

```
(defn shunting-yard
  ([operators values] (shunting-yard operators values default-priorities))
  ([operators values priorities]
    (let [[value & values] values]
      (shunting-yard operators values priorities nil (list value))))
  ([operators values priorities stack-ops stack-vals]
;    (println operators values stack-ops stack-vals)
    (if-let [[new & short-operators] operators]
      (let [[value & short-values] values]
        (if-let [[old & short-stack-ops] stack-ops]
          (if (> (priorities new) (priorities old))
            (recur short-operators short-values priorities (cons new stack-ops) (cons value stack-vals))
            (recur operators values priorities short-stack-ops (cons old stack-vals)))
          (recur short-operators short-values priorities (list new) (cons value stack-vals))))
      (concat (reverse stack-vals) stack-ops))))

(defn stack-eval
  ([stack] (stack-eval (rest stack) (list (first stack))))
  ([stack values]
    (if-let [[op & stack] stack]
      (let [[right left & tail] values]
        (case op
          + (recur stack (cons (+ left right) tail))
          - (recur stack (cons (- left right) tail))
          * (recur stack (cons (* left right) tail))
          / (recur stack (cons (/ left right) tail))
          & (recur stack (cons (& left right) tail))
          (recur stack (cons op values))))
      (first values)))) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-16T21:09:03.100

有趣的！我不得不尝试一下，它是用 Python 编写的，希望你不介意。它运行大约 28 秒，PyPy 1.8，Core 2 Duo 1.4

```
from __future__ import division
from math import log
from operator import add, sub, mul 
div = lambda a, b: float(a) / float(b)

years = set(range(2012, 2113))

none = lambda a, b: a * 10 ** (int(log(b, 10)) + 1) + b
priority = {none: 3, mul: 2, div: 2, add: 1, sub: 1}
symbols = {none: '', mul: '*', div: '/', add: '+', sub: '-', None: ''}

def evaluate(numbers, operators):
    ns, ops = [], []
    for n, op in zip(numbers, operators):
        while ops and (op is None or priority[ops[-1]] >= priority[op]):
            last_n = ns.pop()
            last_op = ops.pop()
            n = last_op(last_n, n)
        ns.append(n)
        ops.append(op)
    return n

def display(numbers, operators):
    return ''.join([
        i for n, op in zip(numbers, operators) for i in (str(n), symbols[op])])

def expressions(years):
    numbers = 10, 9, 8, 7, 6, 5, 4, 3, 2, 1
    operators = none, add, sub, mul, div
    pools = [operators] * (len(numbers) - 1) + [[None]]
    result = [[]]
    for pool in pools:
        result = [x + [y] for x in result for y in pool]
    for ops in result:
        expression = evaluate(numbers, ops)
        if expression in years:
            yield '%d = %s' % (expression, display(numbers, ops))

for year in sorted(expressions(years)):
    print year 
```

# c++ - 为什么要为 C++ 中的单例类重载复制赋值运算符？

> ID：10161977
> 
> 赞同：5
> 
> 时间：2012-04-15T12:21:22.427
> 
> 标签：c++, design-patterns

我知道为什么要将默认构造函数和复制构造函数设为私有以在 C++ 中实现单例类。但我不明白的是，为什么要将复制赋值运算符设为私有，因为不会有两个现有对象开始。

我的探索带来两点：

1.  根据 Alexandrescu 在“现代 C++ 设计”中的说法，赋值运算符应设为私有以防止自赋值。

2.  其次，根据[三规则](http://en.wikipedia.org/wiki/Rule_of_three_%28C++_programming%29)，如果你为一个类定义了ctor、copy ctor和赋值运算符之一，你应该明确定义所有三个。那么，是否仅遵循此规则。

那么，您对此有何看法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T12:31:23.747

我认为，禁止赋值的需要更多是出于语义考虑：由于单例是*唯一*的，因此对其进行赋值没有任何意义。因此，如果以合理的方式实现分配在技术上甚至是可能的，那么从逻辑上讲，无论如何您都需要禁止它。

因此，正是因为永远不需要复制单例，所以必须禁止该操作。否则会有混淆和错误的空间：如果允许，开发人员*会*尝试使用它（并想知道有什么问题）。

好的设计可以最大限度地减少 WTF 的数量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T12:25:42.673

No.

In a Singleton you want to manage all possible construction, assignment and destruction. By making all those operations `private` you actually just prevent others from using them.

Also note that typically copy construction and copy assignment will be declared `private` to prevent invocation from outside but will not be defined because they are not used in practice... and so if they were the linker would complain.

In C++11 you would declare copy construction and copy assignment as `delete`d.

# delphi - TVirtualStringTree：滚动到底部两次导致切换

> ID：10161984
> 
> 赞同：2
> 
> 时间：2012-04-15T12:22:28.867
> 
> 标签：delphi, scroll, virtualtreeview, tvirtualstringtree

我有可变高度节点。如果滚动节点高度大于 VST 客户区，第一次调用“ScrollIntoView(GetLast, False, False)”函数可以完美地完成工作，它会跳转到最后一个节点的**末尾**，这很好。

但是再次调用相同的函数会导致滚动到最后一个节点的**开头**。这是一种功能吗？我不想要这个，如何禁用？

我检查了 ScrollIntoView 函数以了解原因。第一次调用 R.Top 为 0，因此它分支到产生预期结果的 else 部分。但是在第二次调用时，它发现 R.Top 是负数，并且如果是部分，这会导致滚动到最后一个不需要的节点的开头。

有什么建议吗？

```
This is OnTimer event: (500ms)
procedure TMainForm.SyncHexLog;
begin
  Try
    if (HexLog.RootNodeCount <> FirpList.ComOperationCountLagged) then
      begin
        HexLog.RootNodeCount := FirpList.ComOperationCountLagged;

        // measure for fast scroling
        HexLog.ReInitNode(HexLog.GetLastNoInit(), True);

        if FAutoScroll then
          begin
            //HexLog.ScrollToTheBottom();
            HexLog.ScrollIntoView(HexLog.GetLast(), False, False);
          end;
      end;
  Finally
  End;
end;

function TBaseVirtualTree.ScrollIntoView(Node: PVirtualNode; Center: Boolean; Horizontally: Boolean = False): Boolean;

// Scrolls the tree so that the given node is in the client area and returns True if the tree really has been
// scrolled (e.g. to avoid further updates) else returns False. If extened focus is enabled then the tree will also
// be horizontally scrolled if needed.
// Note: All collapsed parents of the node are expanded.

var
  R: TRect;
  Run: PVirtualNode;
  UseColumns,
  HScrollBarVisible: Boolean;
  ScrolledVertically,
  ScrolledHorizontally: Boolean;

begin
  ScrolledVertically   := False;
  ScrolledHorizontally := False;

  if Assigned(Node) and (Node <> FRoot) then
  begin
    // Make sure all parents of the node are expanded.
    Run := Node.Parent;
    while Run <> FRoot do
    begin
      if not (vsExpanded in Run.States) then
        ToggleNode(Run);
      Run := Run.Parent;
    end;
    UseColumns := FHeader.UseColumns;
    if UseColumns and FHeader.FColumns.IsValidColumn(FFocusedColumn) then
      R := GetDisplayRect(Node, FFocusedColumn, not (toGridExtensions in FOptions.FMiscOptions))
    else
      R := GetDisplayRect(Node, NoColumn, not (toGridExtensions in FOptions.FMiscOptions));

    // The returned rectangle can never be empty after the expand code above.
    // 1) scroll vertically
    if R.Top < 0 then // <==== what is the purpose of this if, I need always else part
    begin
      if Center then
        SetOffsetY(FOffsetY - R.Top + ClientHeight div 2)
      else
        SetOffsetY(FOffsetY - R.Top);
      ScrolledVertically := True;
    end
    else
      if (R.Bottom > ClientHeight) or Center then
      begin
        HScrollBarVisible := (ScrollBarOptions.ScrollBars in [ssBoth, ssHorizontal]) and
          (ScrollBarOptions.AlwaysVisible or (Integer(FRangeX) > ClientWidth));
        if Center then
          SetOffsetY(FOffsetY - R.Bottom + ClientHeight div 2)
        else
          SetOffsetY(FOffsetY - R.Bottom + ClientHeight);
        // When scrolling up and the horizontal scroll appears because of the operation
        // then we have to move up the node the horizontal scrollbar's height too
        // in order to avoid that the scroll bar hides the node which we wanted to have in view.
        if not UseColumns and not HScrollBarVisible and (Integer(FRangeX) > ClientWidth) then
          SetOffsetY(FOffsetY - GetSystemMetrics(SM_CYHSCROLL));
        ScrolledVertically := True;
      end;

    if Horizontally then
      // 2) scroll horizontally
      ScrolledHorizontally := ScrollIntoView(FFocusedColumn, Center);

  end;

  Result := ScrolledVertically or ScrolledHorizontally;
end; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T12:50:39.137

我想是时候使用新的 delphi 功能了，比如类助手：p 我在 main.pas 中写了一些简单的东西，它看起来很有效，但我不确定它是否会涵盖所有情况。

```
 TBaseVirtualTreeHelper = class helper for TBaseVirtualTree
  public
    Procedure ScrollToTheBottom();
  end;

{ TBaseVirtualTreeHelper }
procedure TBaseVirtualTreeHelper.ScrollToTheBottom;
Var
  Node: PVirtualNode;
  R: TRect;

begin
  Node := Self.GetLast();

  if Assigned(Node) and (Node <> Self.FRoot) then
  begin
    R := GetDisplayRect(Node, NoColumn, True);

    if (R.Bottom > Self.ClientHeight) then
    begin
      Self.SetOffsetY(Self.FOffsetY - R.Bottom + Self.ClientHeight);
    end;
  end;
end; 
```

# c++ - 字符串末尾的 '\0' 是否也包含在此处？

> ID：10161988
> 
> 赞同：3
> 
> 时间：2012-04-15T12:22:56.627
> 
> 标签：c++, string, strlen

如果我声明一个包含 10 个元素的字符串，如下所示：

```
char s[10]; 
```

那么最后的'\0'是占据第10位还是第11位呢？基本上我的问题是我们是否在字符串中少了 1 个元素？

如果我使用 strlen() 函数来查找这个字符串的长度，返回值是否包含 null？即，如果字符串是“boy”，函数会给我 3 还是 4？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-15T12:27:48.963

没有第 11 位，也就是说，是的，那就是少了一个要使用的元素。

不要在其中放置超过 9 个字符的字符串。 `Strlen()`不包括空终止符。

例如：

```
char s[]="hello"; 
```

`s`是 6 个字符的数组，但`strlen()`of`s`是 5。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T12:28:56.790

是的，该`\0`角色将占据第 10 位。意思是，字符串将只包含 9 个输入字符。不，`strlen()`不计算空字符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-15T12:29:37.727

如果你声明一个这样的数组，它不需要在末尾有一个零字节。如果你调用任何需要字符串的函数，它几乎肯定会导致崩溃。您需要初始化数组：

```
char s[] = "This is a test." 
```

如果你做这样的事情：

```
char s[10] = "012345678"
printf("%d\n", strlen(s)); 
```

它显然会打印 9。您不能在该数组中放入 10 个字符，因为空字节会被写入数组边界之外。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-15T12:31:22.797

如果您声明一个 10 个字符的数组，您必须记住其中一个必须用作字符串终止符，因此您最多可以存储 9 个字符。

`strlen`, 相反，只返回“逻辑”字符的数量，即它不会计算空终止符。

# android - setProgressDrawable 填充整个 seekBar

> ID：10161992
> 
> 赞同：6
> 
> 时间：2012-04-15T12:23:34.770
> 
> 标签：android, progress-bar, progress, seekbar, fill

正如我在标题中所说，当我使用 setProgressDrawable 时，它​​会填充整个 SeekBar：如果进度为 34%，则进度显示为 100%，但拇指显示正确的百分比为 34%。我不知道可能是什么问题...

```
 done.setProgressDrawable(getResources().getDrawable(R.drawable.seekbar_progress));
   done.setThumb(getResources().getDrawable(R.drawable.seekbar_thumb)); 
```

seekbar_progress.xml

```
<shape xmlns:android="http://schemas.android.com/apk/res/android"
android:shape="line">
<stroke android:width="15dp"    android:color="#52a8ec"/> 
```

seekbar_thumb.xml

```
 <shape xmlns:android="http://schemas.android.com/apk/res/android"
 android:shape="rectangle">
<gradient android:startColor="#ffffffff" android:endColor="#ff585858" android:angle="270"/>
<size android:height="17dp" android:width="5dp"/>
</shape> 
```

任何想法？

先感谢您！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-06-16T21:09:42.627

尝试将填充形状像这样放在剪辑标签内

```
<clip>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
android:shape="line">
<stroke android:width="15dp"    android:color="#52a8ec"/>
</clip> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-30T07:01:32.363

我遇到了同样的问题，下面的代码解决了它。

无论您在何处使用代码来更改您的可绘制对象，只需执行以下操作（其中“p”是您的搜索栏）：

```
int currentProgress = p.getProgress();
p.setProgress(0);
Rect bounds = p.getProgressDrawable().getBounds();
p.setProgressDrawable(getResources().getDrawable(R.drawable.progress_drawable_orange));
p.getProgressDrawable().setBounds(bounds);
p.setProgress(currentProgress); 
```

并且不要忘记在您的`onProgressChanged` 方法中添加以下检查：

```
@Override
public void onProgressChanged(SeekBar seekBar, int progress, boolean fromUser) {
    if(!fromUser)
        return;
    // ... THE REST OF YOUR CODE
} 
```

[例子](http://mytechead.wordpress.com/category/android/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T09:41:41.443

我以与您相同的情况结束，并通过使用 layer-list XML 文件实现进度来解决问题。[在这里](https://stackoverflow.com/a/10615806/731314)查看我的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-27T21:47:28.933

您可以调整`progressTint`布局 xml 中的字段以更改进度颜色，而不会影响 SeekBar 的整个背景。

```
<SeekBar
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:progressTint="@color/seek_bar_progress"/> 
```

还有`thumbTint`和`progressBackgroundTint`。

# java - 在java中的类函数中更改布尔值

> ID：10161993
> 
> 赞同：15
> 
> 时间：2012-04-15T12:23:55.587
> 
> 标签：java

我们可以在 java 中的类函数中修改布尔值吗，这样的事情不会起作用，因为更改是本地函数。我们如何才能使以下更改传递的变量反映在方法调用之外？

```
public void changeboolean(Boolean b)
{
        if( somecondition )
        {
                b=true;
        }
        else
        {
                b=false;
        }
} 
```

编辑代码可能是这样的：

```
public String changeboolean(Boolean b,int show)
{
        if( somecondition )
        {
                b=true;
                show=1;
                return "verify again";
        }
        else
        {
                b=false;
                show=2;
                return "Logout";
        }
        show=3;
        return verifed;

} 
```

我正在寻找这样的东西

```
b.setvalue(true); 
```

是否可以？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-15T12:26:56.217

> 我们可以在java中修改类函数中的布尔值吗

不，`Boolean`是不可变的，就像原始类型的所有包装器一样。

选项：

*   从您的方法中返回 a `boolean`（最佳选择）
*   创建一个可变的等效项`Boolean`，允许您设置嵌入的值。然后，您需要修改参数引用*的实例*中的值 - 将参数的值更改为引用不同的实例对您没有帮助，因为在 Java 中参数始终按值传递。该值要么是原始值，要么是引用，但它仍然*是按值传递的*。改变参数的值永远不会改变调用者的变量。
*   使用`boolean[]`带有单个元素的 a 作为包装类型
*   用作`AtomicBoolean`包装器类型

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-01T10:06:05.373

布尔值是不可变的，就像原始类型的所有包装器一样。Soln：尝试使用 apacheCommon 的 MutableBoolean [http://commons.apache.org/proper/commons-lang/javadocs/api-2.6/org/apache/commons/lang/mutable/MutableBoolean.html](http://commons.apache.org/proper/commons-lang/javadocs/api-2.6/org/apache/commons/lang/mutable/MutableBoolean.html)

# javascript - 是否可以在 JQuery 中对输入到 textarea 中的文本进行实时检测？

> ID：10161995
> 
> 赞同：0
> 
> 时间：2012-04-15T12:24:39.523
> 
> 标签：javascript, jquery, jquery-selectors

我有一个“发布”按钮，当在文本区域中输入文本时，它会激活（从模糊变为彩色，从禁用变为启用）。

这工作正常，但我希望文本区域检测文本区域中什么时候没有。因此，假设我在文本区域中键入了“abc”。提交按钮将变为活动状态，但假设我现在删除了所有文本。按钮仍处于活动状态。。还没有完全，因为我有这个：

```
commentButton.prop({ disabled: commentBox.val() == 0 }); 
```

这会阻止表单在 textarea 中不提交任何内容。问题是提交按钮仍然是彩色的，并且没有像预期的那样返回到模糊的非活动状态。

所以这让我想到了我的问题..

我是否可以设置一些东西，一旦我专注于文本区域并输入并知道我何时从文本区域中删除了所有内容，它就会激活并开始收听？

这样，我可以设置一个 if 语句来说明是否所有文本都被删除，然后 removeClass 用于彩色状态按钮，addClass 用于模糊状态按钮。

这也应该适用于空白。

这是我当前的代码：

**.comment_box** = 我的文本区域

**.activeCommentButton** = 彩色提交按钮

**.commentButton** = 模糊提交按钮

```
$(".microposts").off().on("focus", ".comment_box", function () {
    $(this).prop("rows", 7);
    $(this).parent().find(".activeCommentButton").removeClass("activeCommentButton").addClass("commentButton");
    var commentBox = $(this),
        form = $(this).parent(),
        cancelButton = form.children(".commentButtons").children(".cancelButton"),
        commentButton = form.children(".commentButtons").children(".commentButton");
    $(this).removeClass("comment_box").addClass("comment_box_focused").autoResize();
    form.children(".commentButtons").addClass("displayButtons");
    commentButton.prop({
        disabled: true
    });
    commentBox.off().on("keyup keypress input change", function () {
        commentButton.prop({
            disabled: commentBox.val() == 0
        });
        commentButton.removeClass("commentButton").addClass("activeCommentButton");
    });
    cancelButton.click(function () {
        commentBox.removeClass("comment_box_focused").addClass("comment_box");
        form.children(".commentButtons").removeClass("displayButtons");
        commentBox.val("");
    });
}); 
```

亲切的问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T12:39:11.667

是的，试试这个，你可以修改它：

```
$(".commentButton").prop({ disabled: true });

$(".comment_box").keypress(function() {

    $(".commentButton").prop({ disabled: !$(this).val().length >= 1 })           

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T12:40:54.473

这对我有用，但有更清洁的方法吗？

```
 commentButton.prop({ disabled: true });

                commentBox.off().on("keyup keypress input change", function () {
                  commentButton.prop({ disabled: commentBox.val().length == 0 });
                  if ( commentBox.val().length > 1 ) {
                  commentButton.removeClass("commentButton").addClass("activeCommentButton");
              } else {
                commentButton.removeClass("activeCommentButton").addClass("commentButton");
              }
                }); 
```