# StackOverflow 问答 000810000-000810999

# php - PHP：会话二维数组 - 跟踪查看的产品

> ID：810003
> 
> 赞同：0
> 
> 时间：2009-05-01T02:46:17.310
> 
> 标签：php, arrays, session, multidimensional-array

我正在尝试创建一个数组来显示客户查看的最后 5 个产品。

该数组是一个二维数组，如下所示...

$RView=数组（数组（ID =>“1001”，RefCode =>“Ref_01”，名称=>“Name_01”），...数组（ID =>“1005”，RefCode =>“Ref_05”，名称= >“名称_05”））；

数组值是从产品记录集中检索的，旨在在客户访问产品页面时按以下方式运行。

*   页面将检查会话数组是否存在
*   如果是，则从现有 Session 创建一个数组变量。
    如果不是，则创建一个新数组。
*   Array 将添加新的产品详细信息。
*   如果阵列中有超过 5 个现有产品，则阵列将计数。
*   如果是，它将删除最旧的。
    如果否，则进行下一步。
*   从修改后的数组创建/更新会话。

我目前的努力附在下面...
非常感谢您的帮助。

```
 <?php 
    session_start() 
    // Get or Create Array
    IF (isset($_SESSION['sessRView'])) {
    $RView = ($_SESSION['sessRView']); } 
    ELSE {
    $RView = array(array()); 
    }

    // Append currently viewed Product to Array
    array(array_unshift($RView, $row_rsPrd['PrdID'], $row_rsPrd['RefCode'], $row_rsPrd['Name']));

    // Check if more than 5 products exist in Array, if so delete.
    IF (sizeof($RView) > 5) {
    array(array_pop($RView)); }

    // Update Session for next page
    $_SESSION['sessRView'] = $RView;

    // Display Array
    for ($row = 0; $row < 5; $row++)
    {
    echo "<ul>";
        echo "<li><a href='?PrdID=".$RView[$row]["PrdID"]."'>".$RView[$row]["RefCode"]."</a> : ".$RView[$row]["Name"]."</li>";
    echo "</ul>";
    }
    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T02:54:49.397

它或多或少是正确的 - 只需更改 2 行。

1.  array_unshift 和array_pop 周围不需要额外的array()。
2.  当您使用 array_unshift 时，您正在推送一组项目（而不是单独的 ID/代码）-我认为您的意思是`array_unshift($RView, array($prodid,$name,...))`
3.  如果 $RView 没有 5 个元素怎么办？在这种情况下，您正在访问未定义的数组索引（可能会或可能不会显示错误）。将其更改为 foreach 循环：例如
    `foreach ($Rview as $prod) echo $prod['Name']...`

进行这些更改后，它应该可以工作。不过，您可能想稍微清理一下编码风格:)

* * *

编辑：哦，我明白了，当您在 for 循环中引用数组时，它不知道该数组具有“ProdID”和“Name”索引。当您创建一个数组时，您必须使用 => 运算符定义索引。

*   在 array_unshift 时向数组添加索引：
    `array_unshift($RView, array("ProdID" => $row_rsProd["ProdID"], "Name"...))`

*   如果 row_rsProd 不是太大，您可以将整个 row_rsprod 粘贴到 $RView 上。
    所以将 array_unshift(...) 更改为 just`$RView[] = $row_rsProd`
    这样可以保留索引。

*   或者，您可以更改 for 循环中的索引以匹配。现在，您取消转移到 $RView 的数组是基于 0 的 - $RView[0][0] 是第一个产品的产品 ID，等等。
    因此您可以将 foreach 循环中的内容更改为
    `echo "<li>..." $prod[0] $prod[1] $prod[2]`

希望有帮助！

# emacs - Emacs中{{{对应的折叠方法是什么？

> ID：810007
> 
> 赞同：0
> 
> 时间：2009-05-01T02:46:54.110
> 
> 标签：emacs, syntax-error, code-folding

我在我的 .emacs 中使用了以下内容作为注释

```
// {{{
// }}} 
```

**我的 .emacs**

```
;; Basic Characteristics// {{{*/
(setq c-basic-offset 4) ; indents 4 chars
(setq tab-width 4)          ; and 4 char wide for TAB
(setq indent-tabs-mode nil) ; And force use of spaces

(turn-on-font-lock)       ; same as syntax on in Vim

(setq inhibit-splash-screen t)         ; hide welcome screen// }}}*/

;;;; For Emacs' org -mode// {{{*/
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;; The following lines are always needed.  Choose your own keys.
(add-to-list 'auto-mode-alist '("\\.org\\'" . org-mode))
(global-set-key "\C-cl" 'org-store-link)
(global-set-key "\C-ca" 'org-agenda)
(global-set-key "\C-cb" 'org-iswitchb)

(global-font-lock-mode 1)                     ; for all buffers
(add-hook 'org-mode-hook 'turn-on-font-lock)  ; Org buffers only

;; This is needed for Emacs 22, not for 23
(transient-mark-mode 1)

;; To load Lisp files 

;; includes only one folder
;; (add-to-list 'load-path "~/.lisp")
;// }}}*/
;; to include all subdirectories too// {{{*/
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;; 1\. color theme
;;; 2\. Google hyperlinks

;;; this code includes only one folder
(let ((base "/Users/Masi/.lisp"))
  (add-to-list 'load-path base)
  (dolist (f (directory-files base))
    (let ((name (concat base "/" f)))
      (when (and (file-directory-p name) 
                 (not (equal f ".."))
                 (not (equal f ".")))
        (add-to-list 'load-path name)))))

;// }}}*/
; customize hs-minor-mode// {{{*/
(add-hook 'c-mode-common-hook
  (lambda()
    (local-set-key (kbd "C-c <right>") 'hs-show-block)
    (local-set-key (kbd "C-c <left>")  'hs-hide-block)
    (local-set-key (kbd "C-c <up>")    'hs-hide-all)
    (local-set-key (kbd "C-c <down>")  'hs-show-all)
    (hs-minor-mode t)))
;// }}}*/
;; Folds// {{{*/

; to enable folding mode
(load "folding" 'nomessage 'noerror)
(folding-mode-add-find-file-hook)t

 ;;{{{ LaTeX mode stuff
 (add-hook 'TeX-mode-hook
                   '(lambda ()
                          (LaTeX-math-mode)
                          (turn-on-reftex)))
 ;;// }}}*/ 
```

我收到以下错误

```
Loading encoded-kb...done

An error has occurred while loading `/Users/Masi/.emacs':

error: Too many arguments

To ensure normal operation, you should investigate and remove the
cause of the error in your initialization file.  Start Emacs with
the `--debug-init' option to view a complete error backtrace. 
```

在调试模式下，它说

```
Debugger entered--Lisp error: (error "Too many arguments")
  (defvar folding-package-url-location "Latest folding is available at http://cvs.xemacs.org/-xemacs-p (or (boundp 'xemacs-logo)\n                         $
  eval-buffer(#<buffer  *load*<2>> nil "/Users/Masi/.lisp/folding.el" nil t)  ; Reading at buffer position 35362
  load-with-code-conversion("/Users/Masi/.lisp/folding.el" "/Users/Masi/.lisp/folding.el" t t)
  load("folding" nomessage noerror)
  eval-buffer(#<buffer  *load*> nil "/Users/Masi/.emacs" nil t)  ; Reading at buffer position 2224
  load-with-code-conversion("/Users/Masi/.emacs" "/Users/Masi/.emacs" t t)
  load("~/.emacs" t t)
  #[nil "^H\205\276^@   \306=\203^Q^@\307^H\310Q\202A^@ \311=\2033^@\312\307\313\314#\203#^@\315\202A^@\312\307\313\316#\203/^@\317\202A^@\315\202A^@   \32$
  command-line()
  normal-top-level() 
```

我的 ~/.lisp/folding.el

```
;;; folding.el --- A folding-editor-like minor mode.

;; This file is not part of Emacs

;; Copyright (C) 2000-2009
;;           Jari Aalto
;; Copyright (C) 1995, 1996, 1997, 1998, 1999
;;           Jari Aalto, Anders Lindgren.
;; Copyright (C) 1994
;;           Jari Aalto
;; Copyright (C) 1992, 1993
;;           Jamie Lokier, All rights reserved.
;;
;; Author:      Jamie Lokier <jamie A T imbolc.ucc dt ie>
;;              Jari Aalto <jari aalto A T cante dt net>
;;              Anders Lindgren <andersl A T csd.uu dt se>
;; Maintainer:  Jari Aalto <jari aalto A T cante dt net>
;; Created:     1992
;; Keywords:    tools
;;
;; [Latest XEmacs CVS tree commit and revision]
;; VCS-Version: $Revision: 3.42 $
;; VCS-URL:     http://savannah.nongnu.org/projects/emacs-tiny-tools/
;; VCS-Date:    $Date: 2007/05/07 10:50:05 $
;;
;; [Latest devel: Savannah emacs-tiny-tools revision]
;; Version:     git 56b3089

(defconst folding-version-time "2009.0220.1404"
  "Last edit time in format YYYY.MMDD.HHMM.")

;;{{{ GPL

;; This program is free software; you can redistribute it and/or
;; modify it under the terms of the GNU General Public License as
;; published by the Free Software Foundation,
;; or (at your option) any later version.
;;
;; GNU Emacs is distributed in the hope that it will be useful,
;; but WITHOUT ANY WARRANTY; without even the implied warranty of
;; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
;; GNU General Public License for more details.
;;
;; You should have received a copy of the GNU General Public License
;; along with program. If not, write to the
;; Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
;; Boston, MA 02110-1301, USA.
;;
;; Visit <http://www.gnu.org/copyleft/gpl.html> for more information

;;}}}

;;; Commentary:

;;{{{ Introduction

;; Preface
;;
;;      This package provides a minor mode, compatible with all major
;;      editing modes, for folding (hiding) parts of the edited text or
;;      program.
;;
;;      Folding mode handles a document as a tree, where each branch
;;      is bounded by special markers `{{{' and `}}}'. A branch can be
;;      placed inside another branch, creating a complete hierarchical
;;      structure.
;;
;;      Folding mode can CLOSE a fold, leaving only the initial `{{{'
;;      and possibly a comment visible.
;;
;;      It can also ENTER a fold, which means that only the current
;;      fold will be visible, all text above `{{{' and below `}}}'
;;      will be invisible.
;;
;;      Please note, that the maintainers do not recommend to use only
;;      folding for you your code layout and navigation. Folding.el is
;;      on its best when it can "chunk" large sections of code inside
;;      folds. The larger the chunks, the more the usability of
;;      folding will increase. Folding.el is not meant to hide
;;      individual functions: you may be better served by hideshow.el
;;      or imenu.el (which can parse the function indexes)

;;}}}
;;{{{ Installation

;;  Installation
;;
;;      To install Folding mode, put this file (folding.el) on your
;;      Emacs `load-path' (or extend the load path to include the
;;      directory containing this file) and optionally byte compile it.
;;
;;      The best way to install folding is the autoload installation,
;;      so that folding is loaded into your emacs only when you turn on
;;      `folding-mode'. This statement speeds up loading your .emacs
;;
;;          (autoload 'folding-mode          "folding" "Folding mode" t)
;;          (autoload 'turn-off-folding-mode "folding" "Folding mode" t)
;;          (autoload 'turn-on-folding-mode  "folding" "Folding mode" t)
;;
;;      But if you always use folding, then perhaps you want more
;;      traditional installation. Here Folding mode starts
;;      automatically when you load a folded file.
;;
;;          ;; (setq folding-default-keys-function
;;          ;;      'folding-bind-backward-compatible-keys)
;;
;;          (if (load "folding" 'nomessage 'noerror)
;;              (folding-mode-add-find-file-hook))
;;
;;      Folding uses a keymap which conforms with the new Emacs
;;      (started 19.29) style. The key bindings are prefixed with
;;      "C-c@" instead of old "C-c". To use the old keyboard bindings,
;;      uncomment the lines in the the above installation example
;;
;;      The same folding marks can be used in `vim' editor command
;;      "set fdm=marker".
;;
;;  Uninstallation
;;
;;      To remove folding, call `M-x' `folding-uninstall'.
;;
;;  To read the manual
;;
;;      At any point you can reach the manual with `M-x'
;;      `finder-commentary' RET folding RET.

;;}}}
;;{{{ DOCUMENTATION

;;  Compatibility
;;
;;      Folding supports following Emacs flavors:
;;
;;          Unix Emacs  19.28+ and Win32 Emacs  19.34+
;;          Unix XEmacs 19.14+ and Win32 XEmacs 21.0+
;;
;;  Compatibility not for old NT Emacs releases
;;
;;      NOTE: folding version starting from 2.47 gets around this bug
;;      by using adviced kill/yank functions. The advice functions are
;;      only instantiated under problematic NT Emacs versions.
;;
;;      Windows NT/9x 19.34 - 20.3.1 (i386-*-nt4.0) versions contained
;;      a bug which affected using folding. At the time the bug was
;;      reported by Trey Jackson <trey A T cs berkeley edu>
;;
;;          If you kill folded area and yank it back, the ^M marks are
;;          removed for some reason.
;;
;;          Before kill
;; packages or modes
;;
;;      Folding.el was designed tofor big files. Sometimes people misunderstand the
;;       better job. Trying to wrap
;;      individual functions insis not where folding is
;;      it's best. Grouping several f logical fold-block
;;      in the other is. So, to choose a our need,
;;      here are some suggestions,:
;;
;;      o  Naation of imenu.el, speedbar.el and
;;         hideshow.el
;;  ng.el
;;      o  For text, `outline-mode' is more non-intrusive.
;;         Look at Emacs NEWS file (`C-x' `n') and you can se: `M-x' `folding-mode'
;;      `RET'. The mode line should cont When loading a document containing fold marks, Folding mode ised. For example when
;;      loading my init file, only the follines
;;      of comments) are visible:
;;
;;          ;;{{{ Ge  ;;{{{ Keyboard...
;;          ;;{{{ Packages...
;;          ;;          ;;{{{ Minor modes...
;;          ;;{{{ Debug...
;;
;t entering,
;;      use `C-c @ C-s', which produces this displa
;;          ;;}}}
;;
;;      To show everything, just as the fook like if
;;      Folding mode hadn't been activated, give thT', normally bound to `C-c' `@'
;;      `C-o'.  To close all foevel, the
;;      command `folding-whole-buffer' could be used.ouse support
;;
;;      Folding mode v2.0 introduced mouse support. Folds can be shown
;;      or hidden by simply clicking ondidn't click on a
;;      fold mark.
;;
;;  The menu
;;
;;      placed in the "Tools" menu. Should no Tools menu exist
;;     he menu will be placed in the menu bar.
;;
;;  ISearch
;;
;;    incremental search (C-s) facilities,
;;      folds will be aut;;
;;  Problems
;;
;;     Uneven fold marks
;;
;;      Oops, I        ;;{{{
;;          ;;}}}
;;
;;     folding-whole-buffer d whole buffer
;;
;;      If you call commands `folding-open-bufd
;;      `folding-whole-buffer' and notice that there are open;;      sections in the buffer, then you have mismatch of foldspen or closing fold mark.
;;
;;  Folding and outline modes
;;
;ame as Outline mode, a major and
;;      minor mode which is pahe Emacs distribution. The two
;;      packages do, however, re other very much.  The main
;;      differences between the twore:
;;
;;      o   Folding mode uses explicit marks, `{{{' and `}}}', to
;;          mark the beginning and the end of a branch.
;;          Outline, on the other other hand, tries to use already
;;          existing marks, like the `\section' string in a TeX
;;          document.
;;
;;      o   Outline mode has no end marker which means that it is
;;          impossible for text to follow a sub-branch.
;;
;;      o   Folding mode use the same markers for branches on all depths,
;;          Outline mode requires that marks should be longer the
;;          further, down in the tree you go, e.g `\chap', \section',
;;          `\subsection', `\subsubsection'. This is needed to
;;          distinguish the next mark at the current or higher levels
;;          from a sub-branch, a problem caused by the lack of
;;        end-markers.
;;
;;      o   Folding mode has mouse suppoyou can navigate through a
;;          folded document by clicksion
;;          of Outline mode has mouse support.)
;;
;;      of Folding is capable of
;;          automatically to open folthe the entire
;;          document must be opened prior isearcutline mode is useful when the document being
;;      edited coers are hard to find, except if you're happy with
;;      one fn per fold.
;;
;;  Future development ideas
;;
;;      The planinning to rewrite the entire package.
;;      Including replacithe program, written using
;;      old Emacs technology (selectys or text-properties for
;;      Emacs and extents for XEmacs.;;
;;      It is not likely that any of this will come true coning
;;      the time required to rewrite the core of the package. Since
;;      the package, in it's current state, is much more powerful than
;;      the original, it would be appropriate to write such package
;;      from scratch instead of doing surgery on this one.

;;}}}

;;{{{ Customization

;;  Customization: general
;;
;;      The behavior of Folding mode is controlled mainly by a set of
;;      Emacs Lisp variables. This section will discuss the most
;;      useful ones, for more details please see the code. The
;;      descriptions below assumes that you know a bit about how to
;;      use simple Emacs Lisp and kt ~/.emacs, your
;;      init file.
;;
;;  Customization: hooks a
;;      function doing the customization. The function is the see
;;      the example section below.)  The following hooks lding mode is activated.
;;      o   `<major mode>-folding-hookjor
;;           mode set to <major mode>. (e.g. When editing C    the hook `c-mode-folding-hook' is called.)
;;      o   `fol        Called when folding mode is loaded into Emacs.
;;
;;  C     it is used by outline-minor-mode. It is not likely that fe try to use folding and outline at the same time.
;;
;;      Ho.  The
;;      variable `folding-default-keys-function' specifiing line to your
;;      init file:
;;
;;          (setq folding-default-keys-function
;;                'folding-bind-backward-compatible-keys)
;;
;;      To define keys similar to the keys used by Outline mode, use:
;;
;;          (setq folding-defaut-keys-function
;;                'folding-bind-outline-compati-keys)
;;
;;  Customization: adding new major modes
;;
;;      To add fold marks for a new major mode, use the function
;;      `folding-add-to-marks-list'. The command also replaces
;;     existing marks. An example:
;;
;;          (folding-add-to-marks-list
;;           'c-mode "/* {{{ " "/* }}} */" " */" t)
;;
;  Customization: ISearch
;;
;;      If you don't like the extension folding.el applies to isearch,
;;      set the variable `folding-isearch-install' to nil before
;;      loading this pacndard
;;      ones, you can do like this:
;;
;;           (setqs-function
;;               '(folding-bind-backward-compatible-   "Folding setup."
;;
;;             (folding-install)  ;; jus;; ............................................... markers ...
;;             ;;  sh/perl/awk code
;;
;;             (defvar f-marks-alist nil)
;;
;;             (let* ((ptr (assq 'text-mode folding-mode-marks-alist)))
;;               (setcdr ptr (list "# {{{" "# }}}")))
;;
;;             ;; .....................rrent-entry)
;;             (define-key folding-mode-prefix-map                        'folding-whole-buffer))
;;
;;  Example:;;          (defun my-folding-load-hook ()
;;            "Foldi;  Change marks for 'text-mode'
;;            (let* ((ptr (assqing-mode-marks-alist)))
;;              (setcdr ptr (list "# {{xample: choosing different fold marks for mode
;;
;;      Suppoerent fold marks for the
;;      major mode: e.g. to alternate             (defun my-folding-text-mode-setup (&optional use-cu             (interactive
;;                (list (y-or-n-p "Us;              (let* ((ptr (assq major-mode folding-mode-marks-          (when (eq major-mode 'text-mode)
;;                                  (setq  begin default-begin  end default-end)))
;;                (setcdr ptr (list begin end))
;;             f these 3 is to be folded at any
;;      one time, using a simpomment types, e.g., "unfold
;;      everything then fold on \x";;
;;          \O   ...  \endO
;;          \L   ...  \endL
;;         "Folding vars setup."
;;            (let ((ptr (assq 'te;;              (define-key folding-mode-prefix-map "C"
;;                         'my-folding-marks-change)))
;;
;;          ctive "P")
;;            (let ((ptr (assq major-mode folding-mome  major-mode))
;;                (setq input
;;              read-string "Latex \\end(X) Marker (default O): "
;;                       (setq input (upcase input))
;;                (turnncat "\\" input) (concat "\\end" input)))
;;                (tu      ;;  End of example
;;
;;  Bugs: Lazy-shot.el conflict in  in the minibuffer and XEmacs freezes.
;;
;;      The strange phat I have this bug only under Solaris
;;      2.5 sparc (binar.6 x86\. (XEmacs 20.4, folding 2.35). I will try to access
;;   ;;      the XEmacs people I you can reproduce it.

;;}}}
;;{{{  Documentation

;;  Old documentation
;;
;;      The following s written by Jamie Lokier for the release
;;      of Folding V1t is included here for no particular reason:
;;
;;      Emacs 1 frames, then move in
;;      and out of folds in the buffer. Tnerally in order to
;;      avoid some Emacs display "features"ome of it is specific to
;;      certain versions of Emacs. By ;;
;;  More known bugs
;;
;;      *** Needs folding-fold-regionk out what happens when you
;;      exit a fold with the file dat sometime.
;;
;;  Future features
;;
;;      *** I will add a earlier versions does not count line-numbers in the right
;;  ve.
;;
;;      *** Fold titles should be optionally allowed on invisible text-properties (I hope they are intended to
;;      sible; it isn't implemented like that yet), it
;;      will be ed text without affecting the
;;      text of the buffer. At thrns for line-feeds in the buffer. This isn't such
;;      a gooeven more text-properties, it may be possible to track
;;      and out of folds, and have Folding mode
;;      automatically e necessary to maintain a
;;      sensible display. Because the dified (if
;;      overlays are used to hide text), this is quiorward-char', `folding-goto-line' or
;;      `folding-next-erromight make it possible to
;;      avoid using narrowing. This m3cff7]
;; - Minor documentaton fixes.
;; - Add new `python-mode        [jari 3.36-3.37 2006.1118]
;; - Jeremy Hankins <nowan An org> sent a patch, which
;;   adds variable `folding-narrow-batch affects
;;   mostly `folding-shift-in'. This makes it possader to the beginning for canonnical location.
;;   Updated maid from bibtex-mode.
;;   Changed bib-mode '@comment' => '%'. Clian
;;   Bug#282388
;;
;; Sep  10  2004  21.3             [jari0]
;; - (folding-fold-region): caused to indent bottom fold
;; -mode. Disabled
;;   running `indent-according-to-mode' while i;   Bug reported by Uwe Brauer; oub A T mat dot ucm dot es
;; -whole buffer.
;; - Changed version scheme to date based YYYY.MMed unnecessary 'all rights reserved'.
;; - (folding-check-foldeter, which
;; - protected all email addresses by removing AT-si2.111-2.115]
;; - Merged in changes made by 2003-11-12  Adrian ;   using different expansion macros for XEmacs and Emacs.
;;  rg/xemacs-beta/199810/msg00039.html
;; - (folding-forward-char- 2.112 Renamed.
;;   Was `folding-forward-char'.
;;   (folding-ar-1): 2.112 Renamed.
;;   Was `folding-backward-char'.
;;   (fion with '_p' interactive spec.
;;   (folding-backward-char-macolding-interactive-spec-p): 2.112 New.
;;

[...] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T03:40:56.650

您的 .emacs 中的代码至少有一个错误，这里：

```
; to enable folding mode
(load "folding" 'nomessage 'noerror)
(folding-mode-add-find-file-hook)t 
```

这`t`是一个语法错误。可能只是一种类型的 frpom 剪切和粘贴。

关于错误，Trey 是对的，事实上我想我知道错误可能是什么：不知何故，字符串中的尾随引号

```
"Latest folding is available at http://cvs.xemacs.org/-xemacs-p 
```

失踪了。从这两个问题中，我怀疑您的来源已损坏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T03:10:41.793

您的折叠文件`/Users/Masi/.lisp/folding.el`似乎有问题，我们需要查看其中的内容以确定错误。我这么说的原因是堆栈跟踪通过调用`load-with-code-conversion`- 显示正在加载的 folding.el 文件。

如果您查看最新版本，在[此处](http://git.savannah.gnu.org/cgit/emacs-tiny-tools.git/tree/lisp/other/folding.el?h=devel)找到（版本 3.42），开始的行

```
(defvar folding-package-url... 
```

是正确形成的。但是，您的堆栈跟踪看起来像是有一些 lisp 代码以某种方式将其放入字符串中。即：

```
(or (boundp 'xemacs-logo) 
```

尝试下载新副本。

# date - 使用 Ajaxpro 的日期格式

> ID：810012
> 
> 赞同：0
> 
> 时间：2009-05-01T02:54:18.460
> 
> 标签：date, format, ajaxpro

我正在使用 AjaxPro 检索数据库，日期字段返回**Sat Apr 3 00:00:00 UTC+0700 1982**我想将其格式化为“dd/mm/yyyy”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T04:09:08.000

假设您从服务器获取 DateTime 值，您可以执行类似的操作：

访问[http://www.ajaxpro.info/Examples/DataType/default.aspx](http://www.ajaxpro.info/Examples/DataType/default.aspx) 并在 Firebug 中运行以下代码。

```
var result = AJAXDemo.Examples.DataType.Demo.GetDateTime(new Date()).value;
var year = result.getFullYear();
var month = result.getMonth() + 1;
var day = result.getDate();
var formattedDate = [day, month, year].join('/');
console.log(formattedDate); 
```

# c# - c#：从可为空的类型赋值

> ID：810015
> 
> 赞同：4
> 
> 时间：2009-05-01T03:01:00.257
> 
> 标签：c#, nullable

如果我有一个可以为空的“十进制？d”并且我想将 d 分配给不可为空的 e，那么正确的方法是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-01T03:14:11.393

```
decimal e = d ?? 0.0; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-01T03:04:10.327

```
decimal e;
if(d.HasValue) 
{
    e = d.Value;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T03:03:59.937

您需要确定是否可以，即可为空的 d 是否有值。

```
if (d.HasValue) { e = d.Value; } else { /* now what */ } 
```

另一个有趣的情况很常见，您想使用三元分配给可空值，在这种情况下，您必须强制转换以使两个分支具有相同的类型。

```
d = foo ? 45 : (int?)null; 
```

注意 null 到 (int?) 的情况，以便两个分支具有相同的类型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T03:02:14.060

```
decimal e;

if (d.HasValue)
{
    e = d.Value;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T03:20:14.233

我通常会这样：

```
decimal e = d.HasValue ? d.Value : decimal.Zero; 
```

这里的原因是我是三元运算的粉丝，如果我`TryParse()`为我正在处理的类型执行失败，我通常会分配我会得到的值。因为`decimal`那将是`decimal.Zero`，因为`int`它也会如此`0`。

# jquery - jQuery ScrollTo 禁用动画上的锚点

> ID：810017
> 
> 赞同：0
> 
> 时间：2009-05-01T03:01:54.823
> 
> 标签：jquery, scrollto

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T03:30:52.010

# macos - 无法在 Mac 的终端中有效使用 Screen

> ID：810025
> 
> 赞同：21
> 
> 时间：2009-05-01T03:06:18.043
> 
> 标签：macos, terminal, gnu-screen

当您的 .zshrc 中有以下内容时，该帖子总结了在 Mac 终端中使用 Screen 的问题

```
if [[ $STY = '' ]] then screen -xR; fi 
```

1.  **[解决方案 #1 不起作用，但解决方案 #2 起作用](https://stackoverflow.com/questions/810025/unable-to-use-screen-efficiently-in-macs-terminal/810395#810395)：**剪贴板程序：pbcopy、pbpaste 和 xsel 根本不起作用
2.  在 Mac 中使用 Vim 中的错误：[无法在 Screen by .Xresources 中没有分散的窗口。](https://stackoverflow.com/questions/809935/unable-to-solve-a-bug-in-vims-tlist-with-screen/809975#809975)
3.  **[已解决](https://stackoverflow.com/questions/810025/unable-to-use-screen-efficiently-in-macs-terminal/810069#810069)：** Ctrl A 在终端中停止工作。这表明我需要稍微更改 Screen 的键盘绑定。
4.  **[已解决](https://stackoverflow.com/questions/810025/unable-to-use-screen-efficiently-in-macs-terminal/3423480#3423480)：**使用触摸板滚动不起作用。通过编辑您的 .screenrc 回滚工作正常（包括触摸板）
5.  **[已解决](https://stackoverflow.com/questions/815915/unable-to-bind-hjkl-to-dlth-in-screens-c-a-esc-mode)**：无法在 Scrollback 模式中移动屏幕的 Dvorak 键绑定。
6.  [如何在 Screen 中使用 pbcopy/pbpaste/xsel？](https://stackoverflow.com/questions/816302/unable-to-pbcopy-xsel-inside-screen)

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2010-08-06T11:51:42.153

在`screenrc`：

```
# Make xterm scrolling work properly with screen.
termcapinfo xterm-256color|xterm-color|xterm|xterms|xs|rxvt ti@:te@ 
```

也适用于 Terminal.app。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-01T03:32:17.823

我通常通过将转义字符设置为 - 来解决 - 问题（`ctrl`在运行屏幕时通常不需要经常使用它，因为您可以启动一个新屏幕而不是后台进程）。在我的：`a``ctrl``z``.screenrc`

```
escape ^Zz 
```

使用触摸板滚动是行不通的；screen 在终端模拟器中充当终端模拟器，并且只要您在屏幕之间切换，屏幕就不可能在 Terminal.app 中切换回滚缓冲区。您将不得不使用屏幕的回滚功能。有关使用屏幕回滚功能的一些提示，请参阅[本文](http://www.samsarin.com/blog/2007/03/11/gnu-screen-working-with-the-scrollback-buffer/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T06:18:46.707

默认的 OS X 终端应用程序很弱。改为获取 iTerm：

[iTerm](http://iterm.sourceforge.net/)

如果我没记错的话，iTerm 开箱即用地解决了所有这些问题（我的安装已经有几年了，所以我现在无法测试这个理论）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T06:22:18.850

如果启用备用屏幕缓冲区，问题 #3 可能会得到解决。用于`altscreen on`_`.screenrc`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T06:25:47.377

**解决方案＃1不起作用**

为了能够在 OSX 中复制/粘贴，请将以下内容放入您的 .screenrc

```
bind b eval "writebuf" "exec sh -c 'pbcopy < /tmp/screen-exchange'" 
```

[> Th[e] 行 - - 将该文件发送到 pbcopy - -。](http://www.samsarin.com/blog/2007/03/11/gnu-screen-working-with-the-scrollback-buffer/)

该命令绑定到 Ca b（在我的例子中是 Cz b）。

**解决方案 #2 有效，但输入速度相当慢**

使用回滚模式，即复制模式

应对

```
C-A [ 
```

粘贴

```
C-A ] 
```

该解决方案很棒，因为它在所有终端应用程序中都是相同的。它类似于您使用鼠标使用的剪贴板。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-03T01:50:21.390

> Q5：不可能：触摸板滚动不起作用。

您可以使用 ^A Esc 向上滚动屏幕。您不能在屏幕中使用触摸板。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-11T05:00:26.513

这解决了回滚问题，尽管它有点坏，因为它不知道屏幕的缓冲区。 `env TERM=vt100 screen`

# asp.net - 在 WebApp 中搜索多个用户的 Active Directory

> ID：810034
> 
> 赞同：0
> 
> 时间：2009-05-01T03:12:29.090
> 
> 标签：asp.net, search, active-directory

我使用的 Web 应用程序需要一个表单，该表单允许管理员将用户添加到 Web 应用程序用户表中。该 Web 应用程序是基于 Intranet 的，并在全球多个国家/地区运行。

他们需要能够搜索 Active Directory 以查找要从多个域中添加的用户。搜索地理位置较远的域比搜索更近的域需要更长的时间...

是否有更快的方法来搜索 Active Directory，例如某些搜索参数或消除要搜索的字段？

以及您将如何填充会话数据集并让网格或其他控件刷新以检索从每个域中检索的数据...我不确定您如何做到这一点，因为它听起来是多线程的，我没有'没有在 asp.net webapp 中完成......

多谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T17:50:40.727

在 Active Directory 中，全局目录包含来自林中所有域的帐户属性的子集。因为看起来您只想找到信息应该在 GC 中的名称。如果您正在执行 LDAP 搜索绑定到端口 3268 而不是 389 以访问域控制器上的 GC。您可能需要与我们的 AD 管理员合作，以确保您绑定到也是 GC 的域控制器。

[http://technet.microsoft.com/en-us/library/cc978012.aspx](http://technet.microsoft.com/en-us/library/cc978012.aspx)

[http://technet.microsoft.com/en-us/library/cc737410.aspx](http://technet.microsoft.com/en-us/library/cc737410.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-30T03:48:31.657

此页面包含我所追求的大致信息......谈论优化搜索等

[http://www.informit.com/articles/article.aspx?p=30117&seqNum=5](http://www.informit.com/articles/article.aspx?p=30117&seqNum=5)

# shoes - 悬停和菜单和按钮

> ID：810035
> 
> 赞同：1
> 
> 时间：2009-05-01T03:12:44.267
> 
> 标签：shoes

我想设置一个矩形/插槽，当它悬停时，会创建一个小窗口悬停在矩形/插槽的侧面（有点重叠）。

我还想在小菜单中添加一些按钮。我希望这个小菜单比原来的矩形/插槽更长（宽度方向），以适应许多按钮，这意味着我不能使用 slot.hover，因为如果我从rect to the button thats off the rect... 有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T15:14:49.697

这是一个示例，应该向您展示完成此操作所需的逻辑。如果你有一堆这样的菜单，它显然会失控：

```
Shoes.app :title => "Test", :width => 1000, :height => 600 do
  @menu_hover = false
  @zone_hover = false
  @menu = nil
  @zone = stack :width => 200, :height => 100 do
    background '#DFA'
  end
  @zone.hover do
    @zone_hover = true
    app.append do
      break if not @menu.nil?
      @menu = stack :width => 230, :height => 35, :top => 50, :left => 150 do
        background '#F00'
        flow :margin => 5 do 
          button 'OK'
          button 'Cancel'
          button 'Ponies!'
        end
      end
      @menu.hover {@menu_hover = true}
      @menu.leave do
            @menu_hover = false
            break if @menu.nil? or @menu_hover or @zone_hover
            @menu.remove
            @menu = nil
      end
    end
  end

  @zone.leave do
    @zone_hover = false
    break if @menu.nil? or @menu_hover or @zone_hover
    @menu.remove
    @menu = nil
  end
end 
```

这是上述解决方案的一个重复，它扩展了 Shoes::Stack 和 Shoes::App 类以`hover?`向堆栈添加方法（我认为他们应该默认支持）。在您的情况下，我会考虑创建一个自定义小部件，但这显示了您可能可以使用的那种结构。

```
class Shoes::Stack
  def hover?
    @hover ||= false
  end

  alias_method :default_hover, :hover
  alias_method :default_leave, :leave

  def hover(*args, &block)
    new_block = lambda { @hover = true; block.call }
    default_hover(*args, &new_block)
  end

  def leave(*args, &block)
    new_block = lambda { @hover = false; block.call }
    default_leave(*args, &new_block)
  end
end

class Shoes::App
  alias_method :default_stack, :stack
  def stack(*args, &block)
    s = default_stack(*args, &block)
    s.hover {}
    s.leave {}
    s
  end
end

Shoes.app :title => "Test", :width => 1000, :height => 600 do
  @menu = nil
  @zone = stack :width => 200, :height => 100 do
    background '#DFA'
  end
  @zone.hover do
    app.append do
      break if not @menu.nil?
      @menu = stack :width => 230, :height => 35, :top => 50, :left => 150 do
        background '#F00'
        flow :margin => 5 do 
          button 'OK'
          button 'Cancel'
          button 'Ponies!'
        end
      end
      @menu.leave do
            break if @menu.nil? or @menu.hover? or @zone.hover?
            @menu.remove
            @menu = nil
      end
    end
  end

  @zone.leave do
    break if @menu.nil? or @menu.hover? or @zone.hover?
    @menu.remove
    @menu = nil
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T03:19:53.563

听起来您需要使用一些额外的东西来保持该矩形在按钮上和插槽上时保持打开和可见。

那应该在任何事情上都保留菜单。

# testing - 从哪里可以获得示例 3d 环境？

> ID：810041
> 
> 赞同：5
> 
> 时间：2009-05-01T03:15:37.897
> 
> 标签：testing, 3d, rendering, collada

我想在开发 3d 渲染引擎时对其进行测试，但我使用的是非常蹩脚的对象，例如 COLLADA 模型等。

我想知道是否有人知道一个可以下载完整 3d 场景的存储库，例如城市，但不能下载完整级别。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T09:24:38.010

经典的测试模型是 Marko Dabrovic 的 Sponza Atrium 场景 ( [http://hdri.cgtechniques.com/~sponza/files/](http://hdri.cgtechniques.com/~sponza/files/) )。

[![sponza](https://i.stack.imgur.com/XbBMm.jpg)](https://i.stack.imgur.com/XbBMm.jpg)
[（来源：[webfacional.com](http://roi.webfactional.com/img/so/sponza.jpg)）]

这个场景有很多很多来自不同渲染引擎的图像，所以你有很多可以比较你的结果。

否则，这里有一些其他有用的模型站点：

*   [http://www.turbosquid.com](http://www.turbosquid.com)
*   [http://www.modelup.com](http://www.modelup.com)
*   [http://www.archibase.net/gdl](http://www.archibase.net/gdl)
*   [http://modelsbank.3dm3.com](http://modelsbank.3dm3.com)
*   [http://www.max-realms.com](http://www.max-realms.com)
*   [http://www.3dlands.com](http://www.3dlands.com)
*   [http://www.evermotion.org/](http://www.evermotion.org/)
*   [http://archive3d.net/](http://archive3d.net/)

# javascript - 是否存在免费的通用 ASN.1 解码/转储/检查程序？

> ID：810043
> 
> 赞同：6
> 
> 时间：2009-05-01T03:17:45.457
> 
> 标签：javascript, cryptography, utility, asn.1

是否存在免费的通用 ASN.1 解码/转储/检查程序？我有一个可能解密失败的可疑 ASN.1 块，我想检查它以查看它是否有效，如果有效，它包含哪些元素。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-09-01T21:04:03.047

我也`dumpasn1`成功使用了几年），然后我决定在屏幕上看 200 行长的嵌套标签有点难以理解，我想要一些更动态的东西，这样我就可以折叠树的某些部分和类似的东西那。

这就是我试图用我自己的[asn1js](http://lapo.it/asn1js/)客户端 javascript ASN.1 解码器创建的。它也是开源的，并使用 dumpasn1 的巨大“已知 OID”配置文件。不尝试检测所有 ASN.1 格式错误，只检测无法解码的错误...（例如，不会费心将 DER 与 BER 区分开来，例如带有额外前导零的 INTEGER）

是的，这是无耻的自我推销，但我希望你能找到与你的问题相关的有用的软件。;-)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T06:58:29.060

我最喜欢的 ASN.1 查看工具是 Peter Gutmann 的[dumpasn1](http://www.cs.auckland.ac.nz/~pgut001/dumpasn1.c)。仅命令行，但非常灵活，并在出现错误时提供诊断。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T03:42:30.547

这个查看器实用程序是免费的，而且看起来相当不错。

[http://lipingshare.com/Asn1Editor/](http://lipingshare.com/Asn1Editor/)

# linq - 如何使用 LINQ 使用 (.Any()) 过滤子集合的属性

> ID：810045
> 
> 赞同：4
> 
> 时间：2009-05-01T03:19:04.300
> 
> 标签：linq, nhibernate

如何在 LINQ 中执行以下 SQL？我实际上正在使用 LINQ to NHibernate （但由于我认为嵌入的 lambda 表达式，在 NHibernate LINQ 中可能是不可能的）。但我想知道一般如何在 LINQ 中做到这一点。我以前从未遇到过这种情况。

```
SELECT c.CustomerID, c.CustomerName --etc
FROM   Customers c
       INNER JOIN Orders o
         ON c.CustomerID = o.CustomerID
WHERE  o.Status = 1

public class Customer
{
  public int CustomerID { get; set; }
  public string CustomerName { get; set; }  
  public IList<Order> Orders { get; set; }
}

public class Order
{
  public int OrderID { get; set; }
  public int CustomerID { get; set; }
} 
```

我想做类似的事情：

```
var customers = 
    (from c in Customers
    where c.Orders.Where(o => o.Status == 1)
    select c).ToList(); 
```

谢谢你！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-01T03:26:34.327

where 语句返回一个集合。你想使用 Any() 方法

```
var customers = from c in Customers
                where c.Orders.Any(o => o.Status = 1)
                select c 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T03:33:27.073

此解决方案要求订单和客户之间存在 LINQ 内的关系（即客户具有 Orders 属性），但您可以使用：

```
 var customers = 
        (From c in Customers, o In c.Orders
        Where o.Status == 1 
        Select c).ToList() 
```

干杯!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T03:38:44.300

您在寻找 LAMBDA 还是直接 LINQ to SQL？你只是想加入吗？

这将是一个使用 lambda 的连接：

```
var lambda =
Customers.Join (
    Orders,
    c => c.CustomerID,
    o => o.CustomerID,
    (c, o) => new { c, o }
)
.Where  (w => w.o.Status == 1)
.Select (s => s.c.CustomerID, s.c.CustomerName); 
```

# asp.net - 如何从其他 ASP.NET 页面引用公共对象

> ID：810048
> 
> 赞同：0
> 
> 时间：2009-05-01T03:20:13.063
> 
> 标签：asp.net, reference

我们如何在 ASP.NET 的不同页面中访问和引用类和变量？在 2003 版中，它是直截了当的，只需引用页面的类名，整个页面就可以由您指挥，但使用网站而不是 Web 应用程序，情况似乎并非如此。我有一个 App_Code 文件夹，其中有一个定义了以下字符串的类：

```
public string GetPath()
    {
         return mypage.thisUrl;
      } 
```

和另一个看起来像这样的页面：

```
public partial class mypage : System.Web.UI.Page
{
    public string thisUrl
    {
        get { return "/newfolder/mypage.aspx"; }
    }

    protected void Page_Load(object sender, EventArgs e)
    {

    }
} 
```

但显然它不起作用......如果有人能在我尝试 MSDN、这个网站和谷歌时向我推荐一个好的知识来源，那就太好了，而且我旁边还有一本书，找到你的方法是不容易 ：（

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T03:32:47.557

您将需要 mypage 类的实例或将 thisUrl 设为静态。

像恕我直言那样让页面相互依赖不是一个好主意

```
public partial class mypage : System.Web.UI.Page
{
    public static string thisUrl
    {
        get { return "/newfolder/mypage.aspx"; }
    }
}

public partial class mypage : System.Web.UI.Page 
{
   ... Page_Load() {
        mypage.thisUrl

        or

        new mypage().thisUrl
   }
} 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-05-01T03:28:45.260

```
public string GetPath()    
{
     return mypage.thisUrl;   
} 
```

看起来不像一个班级。也许这首先是你的问题。看起来您应该从 Microsoft 获得一些基本的虚拟实验室培训。

[微软虚拟实验室](http://msdn.microsoft.com/en-us/aa740364.aspx)

# php - PHP-Soap 传递方法参数

> ID：810054
> 
> 赞同：8
> 
> 时间：2009-05-01T03:24:01.743
> 
> 标签：php, soap

我相对没有使用 SOAP 的经验。我正在尝试使用 WSDL 模式为客户端使用 Web 服务。我在使用该方法传递参数并让它们根据需要出现在请求中的参数时遇到问题。我正在使用标准的 php 肥皂类。

我需要我的 SOAP 请求的结构如下：

```
 <?xml version="1.0" encoding="UTF-8"?>
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="http://hostserver/">
    <SOAP-ENV:Body>
        <ns1:DoLogin>
            <ns1:request>
                <ns1:Session>
                    <ns1:SessionId>00000000-0000-0000-0000-000000000000</ns1:SessionId>
                </ns1:Session>
                <ns1:UserCredential>
                    <ns1:UserName>username</ns1:UserName>
                    <ns1:Password>password</ns1:Password>
                    <ns1:ApplicationID>00000000-0000-0000-0000-000000000000</ns1:ApplicationID>
                    <ns1:ClientID>00000000-0000-0000-0000-000000000000</ns1:ClientID>
                    <ns1:ClientVersion>V1.0</ns1:ClientVersion>
                </ns1:UserCredential>
            </ns1:request>
        </ns1:DoLogin>
    </SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

在 php 中，我这样调用函数：

```
$client->DoLogin($args); 
```

请求最终是这样的：

```
<?xml version="1.0" encoding="UTF-8"?>
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="http://hostserver/"><SOAP-ENV:Body><ns1:DoLogin/></SOAP-ENV:Body></SOAP-ENV:Envelope> 
```

无论我如何传递参数（单个变量、数组、类对象），我都无法获得这样的结构请求。

谁能帮我？我敢肯定这将是一件非常简单的事情。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-05T20:01:04.667

今天在处理一个稍微相关的问题时，我发现以下 PHP 生成了如下所示的 SOAP 请求：

```
$sc = new SoapClient($url);
$params = array('step' => 'ShippingInfo', 'value' => "hello");
$result = $sc->__soapCall('runStep', array('parameters' => $params)); 
```

```
<?xml version="1.0" encoding="UTF-8"?>
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="http://tempuri.org/">
 <SOAP-ENV:Body>
  <ns1:runStep>
     <ns1:step>ShippingInfo</ns1:step>
     <ns1:value>hello</ns1:value>
  </ns1:runStep>
 </SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

我发现的一个问题是，如果我传递的参数 ($params) 不符合 WSDL 文件中指定的内容，那么 SOAP 客户端生成的消息将与您所抱怨的相似——带有正文的消息包含没有数据价值。我想知道你的问题是否在这里。

另外，请注意上面的 PHP 如何使用两个数组来传递参数。第一个数组包含参数及其名称。第二个包含第一个数组。有趣的语法，我知道。:-)

仅供参考，上面的示例代码用于与具有以下合同的 C# .Net WCF 服务进行通信：

```
[OperationContract]
string runStep(string step, string value); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-03-22T16:45:15.653

尝试这个：

```
$soapClient->__soapCall('methodToCall', array('parameters' => $yourParamsArray)); 
```

这对我来说适用于 .NET Web 服务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-07T10:39:38.930

```
This is valid way: right mr.bgondy
$result = $soapClient->methodsomefunction("params1"=>"value","params2"=>"value2"); 
```

我的问题是你说

```
$soapClient->__soapCall('methodToCall', array('parameters' => $yourParamsArray)); 
```

.net web 服务的上述代码，但是当我为 .net asp web 服务尝试此方法时，参数值不解析我认为是因为当我删除 params=value 时效果不一样“发生未知错误！” 来自 iframe 中的 .net asp Web 服务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-24T17:26:47.567

我有同样的问题。

这个为我解决了：

`$result = $soapClient->somefunction(array( "param1" => "value1", "param2" => "value2" ));`

参数类型（和顺序）必须与当前 wsdl 定义的相同。（字符串、对象等）

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2009-05-29T13:57:47.337

尝试这个，

```
$client->__soapCall('methodName',array('requestObj'=>$requestObj)); 
```

# python - 最大的python项目

> ID：810055
> 
> 赞同：21
> 
> 时间：2009-05-01T03:24:53.257
> 
> 标签：python

使用 Python 的最大软件开发团队是什么？我想知道动态类型系统如何扩展到大型开发团队。

很明显，在 Google，他们拥有数千名开发人员的 C++ 和 Java 代码库。他们对 Python 的使用要小得多。

是否有一些主要使用 Python 开发的大公司？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-01T03:28:24.260

[Youtube](http://www.youtube.com)可能是仅次于谷歌的最大用户（随后被他们收购）。

[Reddit](http://www.reddit.com)是一个类似于 digg 的网站，是用 Python 编写的。

[Eve](http://www.eveonline.com/faq/faq_07.asp)，一个用 Python 编写的大型多人在线游戏也非常令人印象深刻。

[https://en.wikipedia.org/wiki/Python_(programming_language)#Uses](https://en.wikipedia.org/wiki/Python_(programming_language)#Uses)

[https://en.wikipedia.org/wiki/List_of_Python_software](https://en.wikipedia.org/wiki/List_of_Python_software)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-01T04:55:05.333

在许多其他以 Python 为中心的公司中，除了 Unknown 已经提到的那些之外，我会提到像 Astra-Zeneca 这样的大型制药公司，像 Lucasfilm 这样的电影制片厂，以及像 NASA、Caltech、Lawrence Livermore NRL 这样的研究机构。

Pycon Italia Tre（下周在意大利佛罗伦萨举行——见 www.pycon.it）的赞助商包括 Qt/Trolltech（诺基亚的全资子公司），当然还有谷歌、Statpro、ActiveState、Wingware——此外，当然，还有几家意大利公司。

3 月份在芝加哥举行的 Pycon US 的赞助商包括（当然）谷歌，以及 Sun Microsystems、微软、Slide.com、沃尔特迪斯尼动画工作室、甲骨文、Canonical、VMWare——这些公司都认为值得花钱是为了让有经验的 Pythonistas 能看到，所以大概是那些大规模使用 Python 的人（在大多数情况下，特别是试图雇佣有经验的 Python 开发人员）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-01T11:06:16.580

我们的项目是超过 30,000 行 Python。按照某些标准，这可能很小。但它足够大，足以填满我的小脑袋。我们的年度报告中提到了该应用程序，因此在这个意义上它是“战略性的”。我们不是一家“巨大”的公司，所以我们真的没有资格。

一家“大公司”（财富 1000 强？）主要不是用任何一种语言开发的。大公司会有很多开发团队，每个团队都使用不同的技术，具体取决于——嗯——没有什么特别的。

当您进入“史诗公司”（财富 10 强）时，您会看到一个非常像由几家大公司组成的企业集团的组织。史诗般的公司中的每个大公司仍然是一个巨大的公司，有多个不协调的 IT 部门在做不相关的事情——没有“主要使用”任何特定语言或工具集的“开发”。

即使对于“大公司”和“小公司”（如我们的），您仍然存在碎片化。我们的内部 IT 主要是 Microsoft。我们的其他产品开发主要是 Java。然而，我的团队没有太多有用的规范，所以我们使用 Python。我们使用 python 是因为鸭子类型和动态编程特性。

（我不知道什么是动态类型系统——Python 类型是静态的——当你创建一个对象时，它的类型永远不会改变。）

由于没有大型公司主要使用任何特定语言或工具集进行开发，因此对于任何语言或工具，您的问题的简单答案都是“否”。尤其是 Python 不。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-11-10T19:15:50.993

Python 是非常强大的语言，许多大型和排名很高的网站都是基于 python 构建的。

python的一些大产品是：-

1.  谷歌（广泛使用）
2.  Youtube（广泛使用）
3.  迪克斯
4.  Eventbrite
5.  Pinterest
6.  红迪网
7.  知乎
8.  Mozilla
9.  体式（广泛使用）
10.  Dropbox（从 python 开始，一直使用 python）

甚至许多公司正在将他们的网站从 PHP 转移到 Python，因为它的效率、快速能力和可靠性，以及巨大的支持和许多好的框架，如 Django..

此外，我并不是说 PHP 不是一种好的服务器端脚本语言，但事实是，大多数用户都在使用 python 而不是 PHP。

# asp.net - VS 2008 中的 jQuery Intellisense 不适用于 ajax ToolkitScriptManager

> ID：810065
> 
> 赞同：0
> 
> 时间：2009-05-01T03:30:48.700
> 
> 标签：asp.net, jquery, visual-studio-2008, intellisense

我已经按照所有步骤让智能感知在 VS 2008 SP1（使用 vsdoc 修补程序）中为 jQuery 工作。当我在 asp:ScriptManager 控件中引用 jQuery 时，它可以工作，如下所示：

```
<asp:ScriptManager runat="server">
<scripts>
...
</scripts>
</asp:ScriptManager> 
```

但是我使用的是 ajax ToolkitScriptManager，而智能感知在使用此控件时似乎不起作用。它提供了一些更好的功能，所以我不愿意没有它。

看起来 VS 团队只对 jQuery 智能感知进行了编程以查找 asp ScriptManager 控件而不是 ToolkitScriptManager。有没有人找到解决这个特定问题的方法？

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T07:40:25.520

哇，我遇到了同样的问题，并使用以下方法来欺骗 Visual Studio：

```
<% if(false) { %>
    <script src="/scripts/jquery-1.3.2.js" type="text/javascript"></script>
<% } %> 
```

脚本标签永远不会被渲染，但 VS 会解释它并启用智能感知。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T03:45:45.063

如果该文件包含在您的项目中，最后带有 -vsdoc.js，则 IntelliSense 应该可以工作。[Rick Strahl 在http://www.west-wind.com/Weblog/posts/536756.aspx](http://www.west-wind.com/Weblog/posts/536756.aspx)上有一篇很棒的帖子

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-06T16:55:06.527

另一个问题：为什么要将 JQuery 库放在脚本管理器中？

脚本管理器可以做一些很酷的事情，比如为您压缩 javascript 文件——但这只有在 JavaScript 位于资源文件中时才有效。

此外，使用 ScriptManager 会添加一堆额外的 JavaScript，这些 JavaScript 不会被客户端下载（所有 Microsoft AJAX 库）。只要您使用 Microsoft AJAX 工具包，这很好，但如果您不使用，则会增加很多额外的负担。

编辑：如果您想要更好的相对位置，请从 Google Code 获取 JQuery。你可以在这里阅读：[http ://code.google.com/apis/ajaxlibs/](http://code.google.com/apis/ajaxlibs/)

# windows-xp - 远程桌面只显示桌面背景颜色

> ID：810068
> 
> 赞同：0
> 
> 时间：2009-05-01T03:32:17.280
> 
> 标签：windows-xp, remote-desktop

偶尔我会通过 RDP 连接到 Windows XP Pro，我会登录，但屏幕会变成浅蓝色 - 桌面背景的颜色。不显示任何窗口，对鼠标或键盘（包括 ctrl-alt-end）没有响应。如果另一个用户登录强制我注销，那么下次登录就可以了。这似乎是随机发生的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T05:10:52.160

我以前也见过...我认为它与屏幕保护程序有关。我通常只是用 RDP 标题栏上的 x 关闭会话，然后重新建立连接——这似乎可以解决它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T04:07:52.340

尝试将颜色降低到 16 位或更低，并关闭远程桌面连接设置中的所有附加功能。

# wpf - 如何阻止 WPF 绑定忽略它引起的 PropertyChanged 事件？

> ID：810077
> 
> 赞同：3
> 
> 时间：2009-05-01T03:36:05.367
> 
> 标签：wpf, data-binding

我有一个 TextBox 绑定到 ViewModel 的 Text 属性，设置如下：

*Xaml*

```
<TextBox Text="{Binding Text}"/> 
```

*C＃*

```
public class ViewModel : INotifyPropertyChanged
{
    public string Text
    {
        get
        {
            return m_Text;
        }
        set
        {
            if (String.Equals(m_Text, value))
            {
                return;
            }

            m_Text = value.ToLower();
            RaisePropertyChanged("Text");
        }
    }

    // Snip
} 
```

当我在 TextBox 中输入一些内容时，它成功地在 ViewModel 上设置了 Text 属性。问题是 WPF 忽略了由它自己的更新引发的属性更改事件。这导致用户看不到他们键入的转换为小写的文本。

**如何更改此行为以使 TextBox 更新为小写文本？**

*注意：这只是我用来说明 WPF 忽略事件问题的示例。我对将字符串转换为小写或 String.Equals(string, string) 的任何问题并不感兴趣。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T07:13:51.443

您可以通过使用 Dispatcher.BeginInvoke 在单独的调度程序调用中引发事件来实现此目的

定义一个委托：

```
private delegate void RaisePropertyChangedDelegate(string property); 
```

然后使用以下命令引发事件

```
Dispatcher.CurrentDispatcher.BeginInvoke(
    DispatcherPriority.Normal,
    new RaisePropertyChangedDelegate(RaisePropertyChanged), 
    "Text"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-12T23:28:04.300

显然，这已在 2010 年发布的 .NET Framework 4.0 中的 WPF 4.0 中得到修复： [Karl Shifflett 的博客](https://web.archive.org/web/20090601000000*/http://karlshifflett.wordpress.com/2009/05/27/wpf-4-0-data-binding-change-great-feature/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T09:23:15.233

我记得 Rocky Lhotka 在 .NET Rocks 的老一集中抱怨过这种行为。（搜索了半个小时……）啊，到了。[2006 年 3 月的第 169 集](http://www.dotnetrocks.com/text/0169/index.html)：

> 因此，如果您在 Windows 窗体中有详细的表单，那么您将所有属性绑定到这些不同的文本框，并且用户在文本框中输入内容并关闭标签，当然该值会放入您的对象中，但您的对象然后可能会更改值，可能存在某种操作，即所有字母都必须大写。这是一个业务规则，所以它进入你的对象。如果您这样做，它将不会显示在 UI 中。换句话说，用户可以键入 a、b、c，键入小写，关闭制表符。小写的 a、b、c 将留在文本框中。然后当他们改变其他一些字段时，他们会记住对象的值是大写的，对吧？所以对象有一个大写字母 a, b, c UI 错误地显示为小写字母，

洛基实际上并没有提出解决问题的方法，我敢说，如果他没有解决这个问题，也许就没有好的答案。也许您需要从代码隐藏中订阅对象的 PropertyChanged 事件，并在相关属性发生更改时手动刷新绑定。

附言。这不是直接回答您的问题，但在您给出的示例中，您可以在 TextBox 上设置[CharacterCasing](http://msdn.microsoft.com/en-us/library/system.windows.controls.textbox.charactercasing.aspx)以便它只接受小写字符。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-11T12:01:22.737

您需要强制更新绑定目标（请参阅[MSDN 上的这篇文章](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/c404360c-8e31-4a85-9762-0324ed8812ef/)）。但是，这在 WPF4 中已更改/损坏，因此您必须强制更新源代码（请参阅[此帖子](https://stackoverflow.com/questions/3905227/coerce-a-wpf-textbox-not-working-anymore-in-net-4-0)）。

# .net - 使用 Linq to SQL 搜索整个单词

> ID：810078
> 
> 赞同：1
> 
> 时间：2009-05-01T03:36:06.863
> 
> 标签：.net, linq, linq-to-sql

我正在使用 VB.NET 和 Linq to SQL 进行搜索查询。我正在使用 Linq 的 Contains 方法来查找输入关键字。就像这样`note.note_content.Contains(InputKeyWord)`。

问题是如果我搜索“cord”，那么“according”也会出现。我希望结果仅与关键字匹配。

如何使用 Linq 搜索整个关键字？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T03:44:53.333

我假设 inputKeyword 可以出现在开头、注释之间和末尾的任何位置，因此对于它可以出现的 3 个可能位置，您需要有 3 个 OR 子句。因此，您的 LINQ where 子句可能最终看起来像这样。

```
note.note_content.StartsWith(InputKeyword & " ") OR _
note.note_content.EndsWith(" " & InputKeyword) OR _
note.note_content.Contains(" " & InputKeyword & " ") 
```

这不是一个很好的解决方案，但它应该可以工作。如果您擅长使用正则表达式，那也是 LINQ 的一个选项。

阅读本文：[如何将 LINQ 与正则表达式结合使用](http://msdn.microsoft.com/en-us/library/bb882639.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T03:42:35.477

数据周围是分隔符还是空格？您可以使用 .Like (InputKeyword) 对其进行进一步细化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T04:01:29.050

我猜您的关键字在开头和结尾都有分隔符。如果这是真的，你可以使用

```
from n in note
where n.note_content.Contains(beginDelimiter + InputKeyWord + endDelimiter) ||
      n.note_content.StartsWith(InputKeyWord + endDelimiter) || 
      n.note_content.EndsWith(beginDelimiter + InputKeyWord)
select n 
```

# visual-studio-2008 - 如何使用 msbuild 构建一个包含多个 silverlight 项目的 ASP.Net 站点？

> ID：810079
> 
> 赞同：0
> 
> 时间：2009-05-01T03:36:40.683
> 
> 标签：visual-studio-2008, silverlight, msbuild

我有一个 VS2008 解决方案，其中包含 ASP.Net 网站、一个 ASP.Net WCF 服务和几个 silverlight 项目/应用程序。在我在 IDE 中定义的任何配置（调试、暂存、发布）下构建解决方案效果很好。我还有一个 MSbuild 项目，它使用 MSBuild 任务构建解决方案，运行所有单元测试，然后通过 FTP 部署站点和服务等。

如果我在 msbuild 项目中进行干净的构建，它会失败，因为它似乎无法将构建的 silverlight 库复制到依赖项目中，并且我得到很多缺少的参考错误。如果我只是在 IDE 中打开解决方案，切换到相同的配置并构建，它工作正常，然后 msbuild 项目工作正常。

我需要采取哪些特殊步骤来构建包含 silverlight 项目的解决方案？我是否需要专门构建所有项目并复制 dll 输出？

我是 msbuild 的新手。提前致谢。这是我在 msbuild 项目中构建 sln 文件的方式：

```
<MSBuild Projects="mainsite.sln" Properties="Configuration=$(Configuration)" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T06:54:20.070

与其将每个项目构建到不同的目录，然后依赖于在本地复制依赖程序集，我会将所有项目更改为输出到同一目录，然后关闭项目之间引用的 CopyLocal 选项。

# c++ - 函数后的 const 如何优化程序？

> ID：810082
> 
> 赞同：20
> 
> 时间：2009-05-01T03:38:18.590
> 
> 标签：c++, optimization, constants, keyword

我见过一些这样的方法：

```
void SomeClass::someMethod() const; 
```

这个 const 声明有什么作用，它如何帮助优化程序？

**编辑**

我看到这个问题的第一部分之前已经被问过......**但是**，它仍然没有回答第二部分：这将如何优化程序？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-01T04:53:18.783

如果编译器知道类实例的字段没有在 const 成员函数调用中被修改，它就不必重新加载它可能在 const 函数调用之前保存在寄存器中的任何字段。

[在 const_cast 的讨论](http://www.parashift.com/c++-faq-lite/const-correctness.html#faq-18.14)中，这有点像 C++ 中的常见问题解答。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T03:43:32.103

它告诉编译器该方法对类状态没有影响；你不能分配给它里面的任何东西。查看[C++ FAQ Lite 18.10](http://www.parashift.com/c++-faq-lite/const-correctness.html)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-01T04:47:32.730

无论 const 是否存在，为 const 方法生成的 asm 代码都是相同的。const 是编译器的函数而不是运行时，因此如果有任何性能提升，我认为编译器优化器可能会使用 const 作为内联或确定可能优化的副作用之类的提示。所以简而言之，优化器可能会有所帮助，但如果该方法是直接开始的，那么我怀疑从优化器生成的代码将是任何不同的 const 或没有 const。

这是我使用的一个简单的优化（而不是像 const 这样的事情），它需要一秒钟但得到回报。组织你的类变量，使它们更好地落在缓存行边界上，并将你最常访问的变量放在一起。为此，只需将整数、双精度、浮点数等放在类变量声明的顶部，并将奇数大小的变量放在底部，如下所示：

```
int foo; 
int bar;
double baz;
SomeObject obj;
char ch[14]; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-01T03:45:02.270

它允许您在对象上调用类成员函数`const`：

```
class SomeClass
{
public:
    void foo();
    void bar() const;
}

SomeClass a;
const SomeClass b;

a.foo();  // ok
a.bar();  // ok
b.foo();  // ERROR -- foo() is not const
b.bar();  // ok -- bar() is const 
```

还有`volatile`用于`volatile`对象的限定符，您还可以制作`const volatile`用于`const volatile`对象的函数，但这两个非常罕见。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T03:43:15.427

它可以防止 someMethod 更改该类对象的任何成员变量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T04:45:57.350

我对优化的第一个想法是，由于“const”表示实例的状态没有改变，编译器可能有更多的自由来重新排序对该实例上的方法的附近调用。

# mysql - 用于数据库分片的 MySQL 代理替代方案

> ID：810085
> 
> 赞同：3
> 
> 时间：2009-05-01T03:38:51.740
> 
> 标签：mysql, proxy, partitioning, sharding, load-balancing

MySQL 代理是否有任何替代方案。我不想使用它，因为它仍处于 alpha 阶段。

我将有 10 个 MySQL 服务器，其中 table_1 table_2 table_3 table_4 ... table_10 分布在 10 个服务器上。每个表的结构都是相同的，它们只是具有不同数据集的分片。

是否有 MySQL 代理的替代方案，我可以让我的客户端应用程序连接到单个 SQL Server（代理），它查看查询并代表它获取数据。

例如，如果客户端从 Proxy 请求“SELECT * FROM table_5 WHERE user=123”，它连接到包含 table_5 的第 5 个 SQL Server 并获取数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T03:44:47.763

[Spock 代理](http://spockproxy.sourceforge.net/)支持大型 MySQL 数据库的基于范围的水平分区。代理拦截来自客户端的 SQL 查询，根据数据库的分区方式将查询发送到正确的数据库，然后聚合来自每个数据库的结果并将它们作为常规 MySQL 结果集返回给客户端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T12:58:04.080

我可以看到添加代理可以让您在应用程序中更改很少或根本不更改，但值得考虑的是您正在添加一个大的单点故障。

我建议您将决定查找哪个数据库所需的逻辑移到应用程序层中。

# c# - 如何从 YAF.NET 论坛标题中删除登录链接？

> ID：810086
> 
> 赞同：2
> 
> 时间：2009-05-01T03:39:04.907
> 
> 标签：c#, asp.net, forum

对于这个问题，我在 YAF 支持论坛中找不到很好的参考。[我按照 YAF支持论坛](http://forum.yetanotherforum.net/yaf_postst6616_Remove-LoginLogout-Link-in-the-header.aspx)中的这些步骤...

注释掉这些行`pages/ForumPage.cs`。

```
if ( TransPage != "LOGIN" )
    header.AppendFormat( String.Format( " | <a href=\"{0}\">{1}</a>", Forum.GetLink( Pages.login, "ReturnUrl={0}", Server.UrlEncode( Utils.GetSafeRawUrl() ) ), GetText( "TOOLBAR", "LOGIN" ) ) ); 
```

构建解决方案并成功输出`yaf.dll`.

但它仍然不起作用。我正在使用 YAF 1.9.0 版。

我尝试了其他更改，但似乎输出`yaf.dll`对我的论坛没有影响。还有其他方法吗？

谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-25T17:53:22.830

最新版本 v1.9.4-BETA3 有一个进入 app.config 的设置

```
<add key="YAF.AllowLoginAndLogoff" value="false" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T03:52:39.540

不确定 YAF 解决方案是如何设置的，但我已经多次遇到这个问题。

尝试删除 web bin/ 目录中的 yaf.dll，然后将 yaf 引用重新添加到 web 项目，重建整个解决方案并部署。

# esb - Enterprise Service Bus 这是正确的解决方案吗？

> ID：810104
> 
> 赞同：2
> 
> 时间：2009-05-01T03:46:23.297
> 
> 标签：esb

C# 2008

我开发了一个需要连接到 Web 服务器才能工作的应用程序。如果 Web 服务器离线。必须通知该应用程序，以便使用该应用程序的用户可以知道发生了什么。

该应用程序将从我们的客户网站从互联网上下载。所以成百上千的用户可以拥有它。

我正在考虑可能每 5 秒 ping 一次 Web 服务器。但是，使用 100 或 1000 的应用程序会使 Web 服务器超载。

有人告诉我 ESB 可以解决这个问题。我正在考虑使用它的方式，我不完全确定。就是让每个应用都订阅 ESB。如果 Web 服务器离线，它将向所有应用程序发送消息。

但是，我知道 ESB 非常庞大且复杂，也许这对我的问题来说是多余的。

我理解正确吗。

如果 ESB 不是正确的选择，我可以使用另一种设计模式吗？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T04:22:44.957

为这个简单的目的指定 ESB 听起来是不恰当的。为什么不让客户端机器自己弄清楚，因为它们需要定期访问网站？与其一遍又一遍地 ping 网络服务器，在他们的正常活动过程中，他们将需要出于任何正常原因访问网络服务器，如果他们得到错误响应，他们可以分支到“网络服务器已关闭”代码路径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T04:26:31.143

ESB 听起来像是错误的解决方案。

想到了两种可能：

(1) 如果用户不需要知道他们实时离线，当您尝试访问服务器时，将检测推迟到通常的错误处理。

(2) 如果您必须知道实时，请在每个客户端站点使用一个小型代理，这样只有代理需要 ping 您的服务器，而不是每个桌面。

# eclipse - 在 Eclipse 中设置 ANT_OPTS

> ID：810114
> 
> 赞同：4
> 
> 时间：2009-05-01T03:51:36.077
> 
> 标签：eclipse, ant

有谁知道如何在 eclipse 的 ant runner 中设置 ANT_OPTS 并把它捡起来？

我尝试通过外部工具设置中的环境选项卡进行设置，但似乎没有被选中。

我正在尝试设置以下内容：

-Djava.util.logging.config.file=logging.properties

这样我就可以在一些 Oracle 部署 ant 任务中打开调试日志记录。他们的说明特别说明要设置 ANT_OPTS，尽管任何其他让 ant 获取设置的方法都可以。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T09:00:00.610

您是对的：*JRE*属性
的类型将在启动器的“参数”选项卡（ *VM*部分）中设置：

 **[![替代文字](https://i.stack.imgur.com/4clAa.png)](https://i.stack.imgur.com/4clAa.png)
[（来源：[sim-bio.org](http://www.sim-bio.org/javaspaces/quickstart/images/javaspaces/quickstart/RunArgumentsTab.png)）]

> Environment 选项卡定义了运行或调试 Java 应用程序时要使用的环境变量值。默认情况下，环境继承自 Eclipse 运行时。您可以覆盖或附加到继承的环境。

[![替代文字](https://i.stack.imgur.com/E4qYu.png)](https://i.stack.imgur.com/E4qYu.png)
[（来源：[eclipse.org](http://help.eclipse.org/help32/topic/org.eclipse.jdt.doc.user/tips/images/org.eclipse.jdt.debug.ui/env_tab.png)）]

# linq - Linq 中的 Foreach

> ID：810123
> 
> 赞同：2
> 
> 时间：2009-05-01T03:57:18.450
> 
> 标签：linq

我可以用 LINQ 或委托替换这些 foreach 吗？

```
 foreach (List<Shopping.BasketPayment> payList in Basket.basketPayments)
    { 
        foreach (var pay in payList)
        {
            if (pay.paymentMethod == "Money Order" 
            {
                foreach (OrderItem orderItem in order.Items)
                { 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T04:12:14.203

```
var qry = from payList in Basket.basketPayments
          from pay in payList
          where pay.paymentMethod == "Money Order"
          from orderItem in order.Items // where did "order" come from?
          ... etc ending in `select` of one or more articles

foreach(var item in qry) {
    // do something with item
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T04:22:37.063

```
var allPayments = Basket.basketPayments.SelectMany(p => p);
var moneyOrders = allPayments.Where(p => p.paymentMethod == "Money Order");

foreach(var payment in moneyOrders)
{
    foreach(OrderItem item in order.Items)
    {

    }
} 
```

# c++ - 这段代码有什么错误？

> ID：810125
> 
> 赞同：0
> 
> 时间：2009-05-01T03:58:11.367
> 
> 标签：c++, runtime-error

我在 C++ 中创建了一个代码，它应该显示一个 O 和一个 X，您可以使用 w/a/s/d 移动 O，并且 X 随机移动。它编译得很好，但是当我运行它时，有一个 O，但没有 X。我把源代码放在这里：

```
#include <iostream>
using namespace std;

//program class: defines player, enemies and powerups
#include<stdlib.h>
#include<time.h>
class prgm
{
    friend void set_pos(prgm*const nprgm,int px,int py){nprgm->x=px;nprgm->y=py;}
    friend void set_pos(prgm*const nprgm,int px,int py,int php){nprgm->x=px;nprgm->y=py;nprgm->hp=php;}
    friend void set_pos(prgm*const nprgm,int px,int py,int php,char psym){nprgm->x=px;nprgm->y=py;nprgm->hp=php;nprgm->sym=psym;}
protected:
    int x; //x-position
    int y; //y-position
    int hp; //health
    char sym; //single-character representation
public:
    prgm(){sym=' ';}
    prgm(int px,int py,int php,char psym):x(px),y(py),hp(php),sym(psym){};
    const int xpos(){return x;}
    const int ypos(){return y;}
    const char rsym(){return sym;}
    void up(int n){y-=n;} //move program up
    void left(int n){x-=n;} //move program left
    void down(int n){y+=n;} //move program down
    void right(int n){x+=n;} //move program right
    void mutate(char nsym){sym=nsym;} //change program's symbol
    void harm(int dam){hp-=dam;}
    void heal(int dam){hp+=dam;}
    prgm &prgm::operator=(const prgm&nprgm){x=nprgm.x;y=nprgm.y;hp=nprgm.hp;sym=nprgm.sym;}
};

//null program
prgm null();

//abstract enemy class for individual ai of each enemy
class enemy:public prgm
{
public:
    void move(){}; //what enemy will do during its move
};

prgm player(0,0,0,'O');

void pmove()
{
    char move;
    cin>>move;
    switch(move)
    {
    case 'w':
        player.up(1);
        break;
    case 'a':
        player.left(1);
        break;
    case 's':
        player.down(1);
        break;
    case 'd':
        player.right(1);
        break;
    case 'q':
        exit(0);
        break;
    }
    return;
}

//the X1 Virus Component, the simplest version of Virus X: moves in random directions, harms on contact.
class X1:public enemy
{
    static const char sym='X';
public:
    X1(){}
    X1(int px,int py){x=px;y=py;}
    void move();
};
void X1::move()
{
    srand(time(0));
    int dir=(rand()%2);
    int dis=(rand()%3)-1;
    while(dis=0)
    {
        dis=(rand()%3)-1;
    }
    if(dir=0)
    {
        y+=dis;
    }
    if(dir=1)
    {
        x+=dis;
    }
    return;
}

//sector 1
const int maxx=10; //length of sector
const int maxy=10; //height of sector
char sector[maxx][maxy];  //sector declaration
const int rsize=4;
prgm reactive_items[rsize];//array of powerups
X1 a(4,4);  //enemy(ies)
const int vsize=1;
X1 viruses[vsize]={a}; //array of enemies
int px=0,py=0,php=1;  //players position and hp

//function zeros-out the sector
void clear_sect()
{
    for(int i=0;i<maxy;i++)
    {
        for(int j=0;j<maxx;j++)
        {
            sector[j][i]=' ';
        }
    }
}

//function sets all the enemies/powerups/player in the sector
void set_sect()
{
    for(int i=0;i<rsize;i++)
    {
        int*tx=new int(reactive_items[i].xpos());
        int*ty=new int(reactive_items[i].ypos());
        char*ts=new char(reactive_items[i].rsym());
        sector[*tx][*ty]=*ts;
        delete tx;
        delete ty;
        delete ts;
    }
    for(int j=0;j<vsize;j++)
    {
        int*tx=new int(viruses[j].xpos());
        int*ty=new int(viruses[j].ypos());
        char*ts=new char(viruses[j].rsym());
        sector[*tx][*ty]=*ts;
        delete tx;
        delete ty;
        delete ts;
    }
    int*tx=new int(player.xpos());
    int*ty=new int(player.ypos());
    char*ts=new char(player.rsym());
    sector[*tx][*ty]=*ts;
    delete tx;
    delete ty;
    delete ts;
}

//function displays sector
void display_sect()
{
    for(int i=0;i<maxy;i++)
    {
        for(int j=0;j<maxx;j++)
        {
            cout<<sector[j][i];
        }
        cout<<endl;
    }
    return;
}

void vmove()
{
    for(int i=0;i<vsize;i++)
    {
        viruses[i].move();
    }
    return;
}

int main()
{
    //load the sector # from the .txt, load the sector
    set_pos(&player,px,py,php); //set the players x and y values
    while(true){//while the player is on this sector
    clear_sect();//clear the sector map
    set_sect();//use the set function
    display_sect();//use the display function
    pmove();//players move
    vmove();//enemy-ai move
    //check board; relocate whats needed, initiate powerups, etc.
    }//end of while
    //when player wins sector
    //write current sector to a .txt
    //load program: restart this/story program/APHQ
    return 0;
} 
```

我知道它很长而且很复杂，（它们最初是单独的 .h 文件，但我将它们放在一起以便我可以一次看到所有代码）但我真的需要一个答案。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T04:31:06.683

prgm() 的默认构造函数将 sym 成员设置为“”。静态 const char 字段不会覆盖基本 sym 成员，因此使用的字符可能是 ' '。

您的敌人构造函数实际上应该调用 (int,int,int,char) 基本构造函数来设置 sym 成员。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T04:34:07.833

检查你的`X1`班级。它声明了一段`static const char sym`时间，它从 class 继承了一个`protected char sym`成员变量`pgrm`。您的`display_sect`函数使用`prgm`'`rsym()`方法，该方法返回成员变量，而不是`static`成员。

# c - "while(*s++ = *t++)" 如何复制字符串？

> ID：810129
> 
> 赞同：63
> 
> 时间：2009-05-01T04:01:27.130
> 
> 标签：c

我的问题是，这段代码有什么作用（来自[http://www.joelonsoftware.com/articles/CollegeAdvice.html](http://www.joelonsoftware.com/articles/CollegeAdvice.html)）：

```
while (*s++ = *t++); 
```

该网站说上面的代码复制了一个字符串，但我不明白为什么......

它与指针有关吗？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-05-01T04:11:59.850

它等价于：

```
while (*t) {
    *s = *t;
    s++;
    t++;
}
*s = *t; 
```

当`t`指向的 char 为`'\0'`时，while 循环将终止。在那之前，它会将指向的字符复制到`t`指向的字符`s`，然后递增`s`并`t`指向其数组中的下一个字符。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-05-01T04:16:11.620

这在幕后发生了很多事情：

```
while (*s++ = *t++); 
```

和变量是指针（几乎可以肯定是字符），`s`是目标。以下步骤说明了正在发生的事情：`t``s`

*   t ( `*t`) 的内容被复制到 s ( `*s`) 中，一个字符。
*   `s`并且`t`都递增 ( `++`)。
*   赋值（复制）返回被复制的字符（到`while`）。
*   一直持续到该`while`字符为零（字符串结尾`C`）。

实际上，它是：

```
while (*t != 0) {
    *s = *t;
    s++;
    t++;
}
*s = *t;
s++;
t++; 
```

但以更紧凑的方式写出来。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-05-01T04:26:50.097

让我们假设`s`and `t`are `char *`s 指向字符串（假设`s`至少和 一样大`t`）。在C中，字符串都以`0`（ASCII“NUL”）结尾，对吗？那么这是做什么的：

```
*s++ = *t++; 
```

首先，它确实`*s = *t`将 的值复制`*t`到`*s`。然后，它确实`s++`，所以`s`现在指向下一个字符。然后它确实`t++`如此，所以`t`指向下一个字符。这与*运算符优先级*和*前缀与后缀增量/减量*有关。

运算符优先级是解析运算符的顺序。举个简单的例子，看：

```
4 + 2 * 3 
```

这是`4 + (2 * 3)`还是`(4 + 2) * 3`？好吧，我们知道它是第一个是因为*优先级*- 二元`*`（乘法运算符）比二元（加法运算符）具有更高的优先级`+`，并且首先被解析。

在`*s++`中，我们有一元`*`（指针取消引用运算符）和一元`++`（后缀增量运算符）。在这种情况下，`++`具有比 . 更高的优先级（也称为“绑定更紧密”）`*`。如果我们说`++*s`，我们将增加*at* `*s`而不是*指向的地址* `s`的值，因为*前缀*增量具有较低的优先级*作为解引用，但我们使用具有更高优先级的*后缀增量。*如果我们想使用前缀增量，我们可以这样做`*(++s)`，因为括号会覆盖所有较低的优先级并强制`++s`排在第一位，但这会产生不良的副作用，即在字符串的开头留下一个空字符。

请注意，仅仅因为它具有更高的优先级并不意味着它首先发生。后缀增量专门发生*在*使用该值之后，这就是为什么`*s = *t`发生在之前`s++`。

所以现在你明白了`*s++ = *t++`。但他们把它放在一个循环中：

```
while(*s++ = *t++); 
```

这个循环*什么*都不做- 动作都在条件中。但是请检查该条件 - 如果`*s`曾经为 0，则返回“false”，这意味着`*t`为 0，这意味着它们位于字符串的末尾（是的 ASCII“NUL”）。因此，只要 中有字符，此循环就会循环`t`，并将它们忠实地复制到中，并一直`s`递增。当这个循环退出时，已经被 NUL 终止，并且是一个正确的字符串。唯一的问题是，指向结尾。保留另一个指向开头（即循环之前）的指针 -*这*将是您复制的字符串：`s``t``s``s``s``s``while()`

 *```
char *s, *string = s;
while(*s++ = *t++);
printf("%s", string); // prints the string that was in *t 
```

或者，检查一下：

```
size_t i = strlen(t);
while(*s++ = *t++);
s -= i + 1;
printf("%s\n", s); // prints the string that was in *t 
```

我们从获取长度开始，所以当我们结束时，我们做了更多的指针算术来放`s`回到开始的地方，它开始的地方。

当然，为了简单起见，这个代码片段（以及我所有的代码片段）忽略了缓冲区问题。更好的版本是这样的：

```
size_t i = strlen(t);
char *c = malloc(i + 1);
while(*s++ = *t++);
s -= i + 1;
printf("%s\n", s); // prints the string that was in *t
free(c); 
```

但是你已经知道了，或者你很快就会在每个人最喜欢的网站上问一个关于它的问题。;)

* 实际上，它们具有相同的优先级，但由不同的规则解决。在这种情况下，它们实际上具有较低的优先级。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2011-09-20T12:02:58.137

```
while(*s++ = *t++); 
```

为什么人们认为它相当于：

```
while (*t) {
    *s = *t;
    s++;
    t++;
}
*s = *t; /* if *t was 0 at the beginning s and t are not incremented  */ 
```

当它显然不是。

```
char tmp = 0;
do {
   tmp = *t;
   *s = tmp;
   s++;
   t++;
} while(tmp); 
```

更像是

**编辑：**更正了编译错误。`tmp`变量必须在循环外声明。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-01T04:24:48.353

对此神秘的方面是操作顺序。如果您查看 C 语言规范，它指出在这种情况下，操作顺序如下：

```
1\. * operator
2\. = (assignment) operator
3\. ++ operator 
```

所以while循环就变成了英文：

```
而（某些条件）：
  获取地址“t”处的内容并将其复制到地址“s”处的位置。
  将“s”增加一个地址位置。
  将“t”增加一个地址位置。

```

现在，什么是“某些条件”？C 语言规范还说赋值表达式的值是赋值本身，在这种情况下是`*t`.

所以“某些条件”是“`t`指向非零的东西”，或者用更简单的方式，“而位置的数据`t`不是`NULL`”。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-09-20T10:28:18.893

*Brian W. Kernighan 和 Dennis M. Ritchie的 C 编程语言*(K&R) 对此进行了详细解释。

第二版，第 104 页：

> 5.5 字符指针和函数
> 
> 一个*字符串常量*，写成
> 
> ```
> "I am a string" 
> ```
> 
> 是一个字符数组。在内部表示中，数组以空字符终止，`'\0'`以便程序可以找到结尾。因此，存储的长度比双引号之间的字符数多一。
> 
> 也许最常见的字符串常量是作为函数的参数，如
> 
> ```
> printf("hello, world\n"); 
> ```
> 
> 像这样的字符串出现在程序中的地方，通过字符指针访问它；`printf`接收指向字符数组开头的指针。也就是说，通过指向其第一个元素的指针访问字符串常量。
> 
> 字符串常量不必是函数参数。如果`pmessage`声明为
> 
> ```
> char *pmessage; 
> ```
> 
> 然后声明
> 
> ```
> pmessage = "now is the time"; 
> ```
> 
> 分配`pmessage`一个指向字符数组的指针。这*不是*字符串副本；只涉及指针。C 没有提供任何运算符来将整个字符串作为一个单元进行处理。
> 
> 这些定义之间有一个重要的区别：
> 
> ```
> char amessage[] = "now is the time"; /* an array */
> char *pmessage = "now is the time"; /* a pointer */ 
> ```
> 
> `amessage`是一个数组，大到足以容纳字符序列并`'\0'`对其进行初始化。数组中的单个字符可能会被更改，它们`amessage`将始终引用相同的存储。另一方面，`pmessage`是一个指针，初始化为指向一个字符串常量；指针随后可能会被修改为指向别处，但如果您尝试修改字符串内容，则结果未定义。
> 
> ```
>  +---+       +--------------------+
> pmessage: | o-------->| now is the time \0 |
>           +---+       +--------------------+
> 
>           +--------------------+
> amessage: | now is the time \0 |
>           +--------------------+ 
> ```
> 
> 我们将通过研究改编自标准库的两个有用函数的版本来说明指针和数组的更多方面。第一个函数是`strcpy(s,t)`，它将字符串复制`t`到字符串中`s`。可以这么说`s = t`，但这会复制指针，而不是字符。要复制字符，我们需要一个循环。数组版本是第一个：
> 
> ```
> /* strcpy: copy t to s; array subscript version */
> void strcpy(char *s, char *t)
> {
>     int i;
> 
>     i = 0;
>     while((s[i] = t[i]) != '\0')
>         i ++;
> } 
> ```
> 
> 相比之下，这是一个`strcpy`带有指针的版本：
> 
> ```
> /* strcpy: copy t to s; pointer version 1 */
> void strcpy(char *s, char *t)
> {
>     while((*s = *t) != '\0')
>     {
>         s ++;
>         t ++;
>     }
> } 
> ```
> 
> 因为参数是按值传递的，所以可以以任何喜欢的方式`strcpy`使用参数。在这里，它们是方便地初始化的指针，它们一次沿着数组移动一个字符，直到终止的 被复制到.`s``t``'\0'``t``s`
> 
> 在实践中，`strcpy`不会像我们上面展示的那样写。有经验的 C 程序员更喜欢
> 
> ```
> /* strcpy: copy t to s; pointer version 2 */
> void strcpy(char *s, char *t)
> {
>     while((*s++ = *t++) != '\0')
>         ;
> } 
> ```
> 
> `s`这会将和的增量移动`t`到循环的测试部分。的值是之前指向`*t++`的字符被递增；在获取此字符之前，后缀不会更改。以同样的方式，字符在递增之前存储到旧位置。该字符也是用于控制循环的比较值。最终效果是字符从 to 复制到，直到并包括终止符。`t``t``++``t``s``s``'\0'``t``s``'\0'`
> 
> 作为最后的缩写，请注意比较`'\0'`是多余的，因为问题仅仅是表达式是否为零。所以这个函数可能会写成
> 
> ```
> /* strcpy: cope t to s; pointer version 3 */
> void strcpy(char *s, char *t)
> {
>     while(*s++ = *t++);
> } 
> ```
> 
> 虽然乍一看这可能看起来很神秘，但符号的便利性是相当大的，并且应该掌握这个成语，因为你会经常在 C 程序中看到它。
> 
> `strcpy`标准库中的 ( )`<string.h>`返回目标字符串作为其函数值。

本节相关部分到此结束。

PS：如果你喜欢阅读这篇文章，可以考虑购买一本 K&R——它并不贵。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-01T04:09:52.447

它通过将字符从''指向的字符串复制到' `t`'指向的字符串中来工作`s`。对于每个字符副本，两个指针都会递增。循环在找到一个字符时终止`NUL`（等于零，因此退出）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-01T04:15:15.163

提示：

*   运算符'='有什么作用？
*   表达式“a = b”的值是多少？例如：如果你执行“c = a = b”，c 会得到什么值？
*   什么终止了 C 字符串？它评估真还是假？
*   在“*s++”中，哪个运算符的优先级更高？

建议：

*   请改用 strncpy()。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-03-26T13:15:49.973

许多С语言的拥护者相信“while (* s ++ = * t ++)”是一种真正的优雅。

在循环“while”的条件表达式中，插入了三个副作用（一个指针的移位、第二个指针的移位、赋值）。

结果循环的主体是空的，因为所有的功能都放在一个条件表达式中。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-01T04:07:56.803

是的，它确实与指针有关。

阅读代码的方法是：“指针“s”指向的值（在此操作后递增）得到指针“t”指向的值（在此操作后递增） ; 此操作的整个值计算为复制的字符的值；遍历此操作，直到该值等于零”。由于字符串空终止符的值是零字符值 ('/0')，因此循环将迭代直到字符串从 t 指向的位置复制到 s 指向的位置。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-01T04:09:31.247

它复制一个字符串，因为数组总是通过引用传递，而字符串只是一个字符数组。基本上正在发生的是（如果我没记错的话）指针算术。这是[来自维基百科关于 c 数组的更多信息](http://en.wikipedia.org/wiki/Pointer_(computing)#C_arrays)。

您将从 t 取消引用的值存储在 s 中，然后通过 ++ 移动到下一个索引。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-01T04:15:41.713

假设你有这样的事情：

```
char *someString = "Hello, World!"; 
```

*someString*指向字符串中的第一个字符 - 在本例中为“H”。

现在，如果将指针加一：

```
someString++ 
```

*someString*现在将指向“e”。

```
while ( *someString++ ); 
```

将循环直到*someString*指向的任何内容变为 NULL，这表示字符串结束（“NULL 终止”）。

和代码：

```
while (*s++ = *t++); 
```

等于：

```
while ( *t != NULL ) { // While whatever t points to isn't NULL
    *s = *t;           // copy whatever t points to into s
    s++;
    t++;
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-03-26T11:00:21.103

1.  与**int i****一起**使用：

 **```
 char t[]="I am a programmer",s[20];
    for(int i=0;*(t+i)!='\0';i++)
        *(s+i)=*(t+i);
    *(s+i)=*(t+i); //the last char in t '\0'
    printf("t is:%s\n",t);
    printf("s is:%s\n",s); 
```

2.  用于指针**++**：**_**

 **```
 char t[]="I am a programmer",s[20];
    char *p1,*p2;
    p1=t,p2=s;
    for(;*p1!='\0';p1++,p2++)
        *p2 = *p1;
    *p2 = *p1;
    printf("t is:%s\n",t);
    printf("s is:%s\n",s); 
```

3.  与**指针++**一起使用**while**：

 **```
 char t[]="I am a programmer",s[20];
    char *p1,*p2;
    p1=t,p2=s;
    while(*p2++=*p1++);
    printf("t is:%s\n",t);
    printf("s is:%s\n",s);
    printf("t is:%s\n",p1-18);
    printf("s is:%s\n",p2-18); 
```

4.  使用**数组**初始化**指针**：

```
 char a[20],*t="I am a programmer",*s;
    s=a;
    while(*s++=*t++);
    printf("t is:%s\n",t-18);
    printf("s is:%s\n",s-18);
    printf("s is:%s\n",a); 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-05-01T04:12:34.733

是的，这使用了指针，并且在评估 while 条件时也完成了所有工作。C 允许条件表达式有副作用。

“*”运算符取消引用指针 s 和 t。

递增运算符 ("++") 在赋值后递增指针 s 和 t。

循环在一个空字符的条件下终止，在 C 中它的计算结果为 false。

附加评论....这不是安全代码，因为它无法确保 s 分配了足够的内存。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2009-05-01T04:24:53.487

开始一个while循环....

*s = *t 先行，这将 t 指向的内容分配给 s 指向的内容。即，它将一个字符从 t 字符串复制到 s 字符串。

分配的内容被传递给while条件......任何非零都是“真”，所以它会继续，0是假，它会停止......它只是发生在字符串的结尾也是零。

s++ 和 t++ 他们增加指针

一切重新开始

所以它不断分配循环，移动指针，直到它到达 0，这是字符串的结尾

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2013-05-16T16:27:22.153

*我提供以下答案的问题已作为该问题的副本关闭，因此我在此处复制答案的相关部分。*

while 循环的实际语义解释类似于：

```
for (;;) {
    char *olds = s;             // original s in olds
    char *oldt = t;             // original t in oldt
    char c = *oldt;             // original *t in c
    s += 1;                     // complete post increment of s
    t += 1;                     // complete post increment of t
    *olds = c;                  // copy character c into *olds
    if (c) continue;            // continue if c is not 0
    break;                      // otherwise loop ends
} 
```

`s`和`t`被保存的顺序和`s`和`t`递增的顺序可以互换。`*oldt`to的保存可以在保存之后和使用之前的`c`任何时间发生。to的分配可以在之后的任何时间发生并被保存。在我的信封背面，这至少有 40 种不同的解释。`oldt``c``c``*olds``c``olds`

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2014-11-07T23:53:24.990

好吧，仅在 char 的情况下，如果没有 \0 并且它是一个整数数组，程序就会崩溃，因为如果系统的元素不是数组或指针的一部分，那么程序将会崩溃具有使用 malloc 分配的内存，然后系统将继续提供内存

# c++ - C++ - 将数组传递给方法

> ID：810137
> 
> 赞同：0
> 
> 时间：2009-05-01T04:04:30.493
> 
> 标签：c++, arrays, argument-passing

这是一个类似于我定义的函数：

```
void Function( BYTE *data ); 
```

我想做的是这样的：

```
Function( new BYTE { 0x00, 0x00 } ); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T04:12:53.267

您不能将数组初始化器语法与动态分配的数组一起使用`new`。你可以这样做：

```
BYTE *ary=new BYTE[2];
ary[0] = 0;
ary[1] = 0;
Function(ary);
delete [] ary; 
```

但是你为什么在这里使用动态分配的内存呢？数组是否保留在当前函数的范围之外？如果没有，您可以使用在堆栈上分配的数组：

```
BYTE ary[2] = {0};
Function(ary); 
```

在 C++ 中，首选方法是使用 STL 类`std::vector`，它的作用类似于动态分配（但类型安全）的数组：

```
std::vector<BYTE> ary(2);
Function(&ary[0]); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T04:16:05.067

```
BYTE foo[] = { 0x00, 0x00 };
Function( foo ); 
```

C++0x 将引入初始化列表语法，这将允许更接近您上面想要的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T05:10:47.370

```
#include <windows.h>
#include <iostream>
using namespace std;
void foo(BYTE *d) {
    cout << (int)d[ 0 ] << " " << (int)d[ 1 ] << endl;
}
int main(void) 
{
    foo(new BYTE[ 2 ]());
    return 0;
} 
```

如果您想要的只是将`BYTE`数组初始化为全零，则上述方法有效。（我假设这是 Windows`BYTE`类型。）但是，如前所述，这很容易泄漏，最好避免。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T09:48:47.497

或者您可以使用省略号来模拟数组的构造：

看看这个：[http ://www.cplusplus.com/reference/clibrary/cstdarg/va_arg/](http://www.cplusplus.com/reference/clibrary/cstdarg/va_arg/)

如果你真的想在 0x 到达之前摆弄，看看[这段代码](http://codepad.org/2nZpjtLW)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-02T11:28:57.687

gcc 有一个名为“Compound literals”的扩展，它允许您编写：

```
Function((BYTE[]){1, 2, 3, 4}); 
```

Note that it is allocated on the stack, so it might not be suitable for your purposes.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T04:13:16.323

好吧，如果 BYTE 是一个类，你可以有一个构造函数

```
BYTE::BYTE(char c1,char c2){
 //something here.
} 
```

然后打电话

```
Function( new BYTE(0X00,0X00)) 
```

但是，这很容易泄漏。您应该在退出函数之前删除参数。这并不总是可能的（例如，如果您没有 Function 的源代码）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T04:22:28.110

辅助功能；

```
 BYTE* makeNaryByteArray( int n, BYTE exemplar = 0 ) {
    BYTE* r = new BYTE[ n ];
    for( int i = 0 ; i < n ; ++i )
       n[i] = exemplar;
    return r;
  }

  //call them:
  BYTE* myByteArray;
  Function( myByteArray = makeNaryByteArray(2) );

  // done with array:
  delete[] myByteArray; 
```

请记住，用 ; 创建的数组是用;`new[]`删除的。`delete[]`

# ruby-on-rails - 未初始化的常量 ActionController::Dispatcher::MiddlewareStack

> ID：810150
> 
> 赞同：1
> 
> 时间：2009-05-01T04:11:57.213
> 
> 标签：ruby-on-rails, environment, actioncontroller

我安装了一些新的 gem 进行测试并遇到了未初始化的常量 ActionController::Dispatcher::MiddlewareStack 错误。我按照 gem rdocs 上的说明在 environment.rb 文件中指定了 gem 依赖项，然后运行 ​​rake gems:install 和 rake gems:unpack。

我还一次将我的 environment.rb 文件复制到另一个项目中，但没有收到错误。我想知道还有什么其他事情可能会出错。

这是错误的更长版本（我首先在运行一个简单测试时遇到了错误；当我确实需要'active_support'时，控制台中也会发生同样的事情）：

```
$ ruby test/unit/user_test.rb 
** has_many_polymorphs: rails environment detected
/Users/thaiyoshi/.gem/ruby/1.8/gems/activesupport-2.3.2/lib/active_support/dependencies.rb:105:in `const_missing': uninitialized constant ActionController::Dispatcher::MiddlewareStack (NameError)
    from /Users/thaiyoshi/.gem/ruby/1.8/gems/actionpack-2.3.2/lib/action_controller/dispatcher.rb:71
    from /opt/local/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
    from /opt/local/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:31:in `require'
    from /Users/thaiyoshi/.gem/ruby/1.8/gems/activesupport-2.3.2/lib/active_support/dependencies.rb:156:in `require'
    from /Users/thaiyoshi/.gem/ruby/1.8/gems/activesupport-2.3.2/lib/active_support/dependencies.rb:521:in `new_constants_in'
    from /Users/thaiyoshi/.gem/ruby/1.8/gems/activesupport-2.3.2/lib/active_support/dependencies.rb:156:in `require'
    from /Users/thaiyoshi/.gem/ruby/1.8/gems/has_many_polymorphs-2.13/lib/has_many_polymorphs/autoload.rb:2
    from /opt/local/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
     ... 8 levels...
    from ./test/unit/../test_helper.rb:2:in `require'
    from ./test/unit/../test_helper.rb:2
    from test/unit/user_test.rb:1:in `require'
    from test/unit/user_test.rb:1 
```

这是我的 environment.rb 文件（删除了默认注释）：

```
RAILS_GEM_VERSION = '2.3.2' unless defined? RAILS_GEM_VERSION
# config.gem 'has_many_polymorphs', :version => "2.12"
# require ‘has_many_polymorphs‘

# Bootstrap the Rails environment, frameworks, and default configuration

require File.join(File.dirname(__FILE__), 'boot')
require 'has_many_polymorphs' 
require 'active_support'

Rails::Initializer.run do |config|

  config.time_zone = 'UTC'

  config.gem "thoughtbot-factory_girl",
             :lib    => "factory_girl",
             :source => "http://gems.github.com"

   config.gem 'thoughtbot-shoulda',
              :lib => false,
              :source => 'http://gems.github.com'

end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T17:02:45.893

我之前写了一些误导性的信息，但是，现在我设法坐下来不受干扰地看了几分钟，我通过编辑我的 environment.rb 来解决我的问题，并将**require 'has_many_polymorphs'**语句移到初始化程序*之后*堵塞。

答对了。**我用力**捂脸，但这就是我们学习的方式..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-05T16:25:56.533

关注这个线程有一段时间了 - 上面 ric 的回答在开发中对我们有用，但切换到生产模式会导致错误。将 require 放回初始化程序块上方并使用 Ric 的原始修复工作正常。他的编辑已将其删除-因此对于后面的任何人来说，这里又是：顺便说一句-我们现在在 hmp 上使用trunk而不是 johnsbrn 分支，现在似乎可以在 2.3.2 上正常工作

编辑：它几乎为我解决了这个问题。后来我发现迁移遇到了类似的问题。在查看了代码之后，我很快找到了一个答案，其中涉及需要缺少的类（action_controller/middleware_stack）。

快速而肮脏的解决方法是在相对路径下编辑文件：

“johnsbrn-has_many_polymorphs/lib/has_many_polymorphs/autoload.rb”

并在第一条两行之间插入以下行：

除非定义，否则需要'action_controller/middleware_stack'？::ActionController::MiddlewareStack

例如，它最终看起来像这样：

除非定义，否则需要“初始化程序”？::Rails::初始化器

除非定义，否则需要'action_controller/middleware_stack'？::ActionController::MiddlewareStack

除非定义，否则需要'action_controller/dispatcher'？::ActionController::调度程序

现在一切正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-02T12:43:40.407

如果其他人像我一样浏览此页面，我只需将我的 has_many_polymorphs gem 从 1.12.1 升级到 1.13 并将其重新冻结到我的供应商文件夹中（并更新 environment.rb 中的 config.gem 行以使用新版本号）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-24T09:43:48.883

在 environment.rb 中：

```
require File.join(File.dirname(__FILE__), 'boot')
require 'action_controller/middleware_stack' unless defined? ::ActionController::MiddlewareStack
require 'has_many_polymorphs' 
```

为我工作

# asp.net - asp.net 将许多下拉列表的模板字段项添加到 detailsview 控件

> ID：810154
> 
> 赞同：2
> 
> 时间：2009-05-01T04:12:20.083
> 
> 标签：asp.net, drop-down-menu, detailsview

如何以编程方式为详细信息视图中的每个下拉列表控件添加以下模板字段？

```
<asp:TemplateField HeaderText="Your Gender">
    <EditItemTemplate>
        <asp:DropDownList ID="ddlGender" runat="server" 
                        DataSourceid="ddlDAGender"
                        DataTextField="Gender" DataValueField="GenderID"
                        SelectedValue='<%#Bind("GenderID") %>'
            >
         </asp:DropDownList>
    </EditItemTemplate>

    <ItemTemplate >
        <asp:Label Runat="server" Text='<%# Bind("Gender") %>' ID="lblGender"></asp:Label>
    </ItemTemplate>
</asp:TemplateField> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T05:34:32.210

也许是这样的：

```
Dim tc As New System.Web.UI.WebControls.TemplateField

tc.HeaderTemplate = Page.LoadTemplate("Controls/DatagridCheckboxColumnHeader.ascx")
tc.ItemTemplate = Page.LoadTemplate("controls/DatagridCheckboxColumn.ascx")

tc.HeaderText = "Select"

grdView.Columns.Insert(0, tc) 
```

# objective-c - NSNumberFormatter 只四舍五入到小数点后 3 位

> ID：810161
> 
> 赞同：35
> 
> 时间：2009-05-01T04:15:26.783
> 
> 标签：objective-c, cocoa-touch

我正在尝试`NSNumberFormatter`在 iPhone 应用程序中将数字四舍五入到小数点后 5 位，但`[formatter stringFromNumber:]`总是返回四舍五入到 0.001（小数点后 3 位）的字符串。我究竟做错了什么？

```
formatter = [[NSNumberFormatter alloc] init];
[formatter setNumberStyle:NSNumberFormatterDecimalStyle];
[formatter setRoundingMode:NSNumberFormatterRoundHalfUp];
[formatter setSecondaryGroupingSize:3];
[formatter setRoundingIncrement:[NSNumber numberWithDouble:0.00001]]; 
```

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-05-01T13:10:14.660

试试[-setMaximumFractionDigits:](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSNumberFormatter_Class/Reference/Reference.html#//apple_ref/occ/instm/NSNumberFormatter/setMaximumFractionDigits:)和[-setMinimumFractionDigits:](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSNumberFormatter_Class/Reference/Reference.html#//apple_ref/occ/instm/NSNumberFormatter/setMinimumFractionDigits:)

这些配置小数分隔符后的位数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T04:29:23.990

尝试 [格式化程序 setFormat:@"0.00000"]; 而不是 setRoundingIncrement:.

# java - 如何从 Restlet 中读取上下文参数？

> ID：810171
> 
> 赞同：2
> 
> 时间：2009-05-01T04:17:44.923
> 
> 标签：java, servlets, restlet

使用[Restlets](http://restlet.org)时，如何读取通过 web.xml 传入的配置参数？对于 servlet，可以使用[context-param 。](https://stackoverflow.com/questions/520467/how-to-read-the-web-xml-from-a-webapp)如何从 Restlet 中读取上下文参数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T14:23:38.883

从[邮件列表](http://restlet.tigris.org/ds/viewMessage.do?dsForumId=4447&dsMessageId=12792)：

> 初始化参数在[应用程序的上下文](http://www.restlet.org/documentation/1.1/ext/com/noelios/restlet/ext/servlet/ServerServlet.html)中可用：getApplication().get​Context().getParamet​ers()。

在 web.xml 中：

```
 <context-param>
    <param-name>my.context.param</param-name>
    <param-value>Hello World</param-value>
  </context-param> 
```

在 Restlet 的表示方法中，使用：

```
// => "Hello World"
String result = 
  getApplication().getContext().getParameters().getFirstValue("my.context.param"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T04:49:22.693

`ServerServlet``servletConfig`将来自和的所有初始化参数添加`servletContext`到应用程序上下文中。

因此，根据您的需要，您可以检查 的源代码`ServerServlet`，并以相同的方式读取配置参数，或者只是从您的 restlet 或您的 restlet 的应用程序的上下文中获取值。

# python - python-beautifulsoup 是否误报了我的 html？

> ID：810173
> 
> 赞同：2
> 
> 时间：2009-05-01T04:19:02.300
> 
> 标签：python, macos, configuration, screen-scraping, beautifulsoup

据我所知，我每人有两台机器，运行 python 2.5 和 BeautifulSoup 3.1.0.1。

我正在尝试抓取[http://utahcritseries.com/RawResults.aspx](http://utahcritseries.com/RawResults.aspx)，使用：

```
from BeautifulSoup import BeautifulSoup
import urllib2

base_url = "http://www.utahcritseries.com/RawResults.aspx"

data=urllib2.urlopen(base_url)
soup=BeautifulSoup(data)
i = 0
table=soup.find("table",id='ctl00_ContentPlaceHolder1_gridEvents')
#table=soup.table
print "begin table"
for row in table.findAll('tr')[1:10]:
    i=i + 1
    col = row.findAll('td')
    date = col[0].string
    event = col[1].a.string
    confirmed = col[2].string
    print '%s - %s' % (date, event)
print "end table"
print "%s rows processed" % i 
```

在我的 Windows 机器上，我得到了正确的结果，即日期和事件名称的列表。在我的mac上，我没有。相反，我得到

```
3/2/2002 - Rocky Mtn Raceway Criterium
None - Rocky Mtn Raceway Criterium
3/23/2002 - Rocky Mtn Raceway Criterium
None - Rocky Mtn Raceway Criterium
4/2/2002 - Rocky Mtn Raceway Criterium
None - Saltair Time Trial
4/9/2002 - Rocky Mtn Raceway Criterium
None - DMV Criterium
4/16/2002 - Rocky Mtn Raceway Criterium 
```

我注意到的是，当我

```
print row 
```

在我的 Windows 机器上，tr 数据看起来与源 html 完全相同。请注意第二个表格行上的样式标记。这是前两行：

```
<tr>
<td>
 3/2/2002
</td>
<td>
 <a href="Event.aspx?id=226">
  Rocky Mtn Raceway Criterium
 </a>
</td>
<td>
 Confirmed
</td>
<td>
 <a href="Event.aspx?id=226">
  Points
 </a>
</td>
<td>
 <a disabled="disabled">
  Results
 </a>
</td>
</tr>

<tr style="color:#333333;background-color:#EFEFEF;">
<td>
 3/16/2002
</td>
<td>
 <a href="Event.aspx?id=227">
  Rocky Mtn Raceway Criterium
 </a>
</td>
<td>
 Confirmed
</td>
<td>
 <a href="Event.aspx?id=227">
  Points
 </a>
</td>
<td>
 <a disabled="disabled">
  Results
 </a>
</td>
</tr> 
```

在我的 Mac 上，当我打印前两行时，样式信息会从 tr 标签中删除，并移到每个 td 字段中。我不明白为什么会这样。每隔一个日期值我都会得到 None ，因为 BeautifulSoup 每隔一个日期就放置一个字体标签。这是mac的输出：

```
<tr>
<td>
 3/2/2002
</td>
<td>
 <a href="Event.aspx?id=226">
  Rocky Mtn Raceway Criterium
 </a>
</td>
<td>
 Confirmed
</td>
<td>
 <a href="Event.aspx?id=226">
  Points
 </a>
</td>
<td>
 <a disabled="disabled">
  Results
 </a>
</td>
</tr>

<tr bgcolor="#EFEFEF">
<td>
 <font color="#333333">
  3/16/2002
 </font>
</td>
<td>
 <font color="#333333">
  <a href="Event.aspx?id=227">
   Rocky Mtn Raceway Criterium
  </a>
 </font>
</td>
<td>
 <font color="#333333">
  Confirmed
 </font>
</td>
<td>
 <font color="#333333">
  <a href="Event.aspx?id=227">
   Points
  </a>
 </font>
</td>
<td>
 <font color="#333333">
  <a disabled="disabled">
   Results
  </a>
 </font>
</td>
</tr> 
```

我的脚本在 windows 下显示正确的结果 - 我需要做什么才能让我的 Mac 正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T05:13:48.737

BeautifulSoup 3.1 版存在[记录问题](http://www.crummy.com/software/BeautifulSoup/3.1-problems.html)。

您可能需要仔细检查您实际使用的版本，如果是，请降级。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T18:51:24.603

我怀疑问题出在 urllib2 请求中，而不是 BeautifulSoup：

如果您向我们展示与此命令在两台机器上返回的原始数据的相同部分，这可能会有所帮助：

```
urllib2.urlopen(base_url) 
```

此页面看起来可能会有所帮助： [http ://bytes.com/groups/python/635923-building-browser-like-get-request](http://bytes.com/groups/python/635923-building-browser-like-get-request)

最简单的解决方案可能只是检测脚本在哪个环境中运行并相应地更改解析逻辑。

```
>>> import os
>>> os.uname() 
('Darwin', 'skom.local', '9.6.0', 'Darwin Kernel Version 9.6.0: Mon Nov 24 17:37:00 PST 2008; root:xnu-1228.9.59~1/RELEASE_I386', 'i386') 
```

或者让微软使用网络标准:)

另外，您没有使用机械化来获取页面吗？如果是这样，问题可能就在那里。

# c++ - 便携式共享对象？

> ID：810177
> 
> 赞同：6
> 
> 时间：2009-05-01T04:20:50.780
> 
> 标签：c++, linux, portability, shared-objects, shared-libraries

是否可以像 Windows 中的 DLL 一样以可移植的方式使用共享对象文件？

我想知道是否有一种方法可以为 Linux 提供一个可立即使用的编译库。就像您可以在 Windows 中编译 DLL 一样，它可以在任何其他 Windows 上使用（好的，不是任何其他的，但在大多数 Windows 上都可以）。

这在Linux中可能吗？

**编辑：**
我刚刚醒来并阅读了答案。有一些非常好的。
我不是想隐藏源代码。我只是想提供一个已经编译好的可以使用的库，所以没有编译经验的用户不需要自己做。
因此，我们的想法是提供一个可以在尽可能多的不同 Linux 上运行的 .so 文件。
该库是用 C++ 编写的，使用 STL 和 Boost 库。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-01T07:47:20.660

我**强烈** **推荐**使用 LSB 应用程序/库检查器。如果您：

*   正在使用某些发行版上不可用的扩展
*   在安装脚本中引入 bash-isms
*   使用并非在所有最新内核中都可用的系统调用
*   依赖非标准库（它会告诉你发行版缺少它们）
*   还有很多，经过很多其他非常好的检查

您可以[在此处获取更多信息](http://ldn.linuxfoundation.org/lsb/check-your-app)以及下载该工具。它易于运行.. 只需解压它，运行 perl 脚本并将浏览器指向 localhost.. 其余部分由浏览器驱动。

使用该工具，您可以轻松获得库/应用 LSB 认证（适用于两个版本），并使发行版打包程序的工作更加轻松。

除此之外，只需使用 libtool（或类似工具）之类的工具来确保您的库安装正确，为不想链接 DSO 的人提供一个静态对象（您的库需要一段时间才能出现在大多数发行版中，所以编写一个可移植的程序，我不能指望它存在）并很好地评论你的公共界面。

对于图书馆，我发现[Doxygen](http://www.doxygen.nl/)效果最好。文档非常重要，它肯定会影响我选择用于任何给定任务的库。

真的，再次检查应用程序检查器，它会为您提供可移植性问题报告，而这些报告可能需要一年的时间才能让图书馆在野外获得。

最后，尝试让您的库易于“放入树中”，这样我就不必静态链接它了。正如我所说，它可能需要几年时间才能在大多数发行版中变得普遍。我更容易抓住你的代码，把它放到 src/lib 中并使用它，直到你的库是通用的。拜托，拜托..给我单元测试，[TAP](http://ccan.ozlabs.org/info/tap.html)（测试任何协议）是一种很好的便携方式。如果我破解了你的库，我需要（快速）知道我是否破坏了它，尤其是在树或 *原位*修改它时（如果 DSO 存在）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T07:29:55.537

如果您想通过给他们编译代码来帮助您的用户，我知道的最好的方法是给他们一个静态链接的二进制文件 + 文档他们如何运行二进制文件。（这可能是除了向他们提供源代码之外。）大多数静态链接的二进制文件适用于相同架构的大多数 Linux 发行版（+ 32 位（x86）静态链接的二进制文件适用于 64 位（amd64））。难怪 Skype 提供静态链接的 Linux 下载。

回到你的图书馆问题。即使您是在 Linux 上编写共享库的专家，并且您花时间最小化依赖关系，以便您的共享库可以在不同的 Linux 发行版（包括旧版本和新版本）上工作，但也无法确保它能够正常工作在未来（比如说，2 年）。您很可能最终会维护 .so 文件，即一遍又一遍地进行小修改，以便 .so 文件与较新版本的 Linux 发行版兼容。这在很长一段时间内都不是一件有趣的事情，而且它会大大降低您的工作效率：您花在维护库兼容性上的时间本可以更好地花在例如改进软件的功能、效率、安全性等方面。

另请注意，通过提供.so 格式的库很容易让您的用户感到不安，这在他们的系统上不起作用。（而且你没有超能力让它在*所有*Linux 系统上运行，所以这种情况是不可避免的。）你是否也提供 32 位和 64 位，包括 x86、PowerPC、ARM 等？如果 .so 文件仅适用于 Debian、Ubuntu 和 Red Hat（因为您没有时间将该文件移植到更多发行版），那么您很可能会让您的 SUSE 和 Gentoo 用户（以及更多用户）感到不安。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-01T20:50:24.973

理想情况下，您需要使用 GNU [autoconf](http://www.gnu.org/software/autoconf/)、[automake](http://www.gnu.org/software/automake/)和[libtool](http://www.gnu.org/software/libtool/)来创建 configure 和 make 脚本，然后将库作为源代码与生成的 configure 和 Makefile.in 文件一起分发。

这是一本关于他们的[在线书籍。](http://sources.redhat.com/autobook/)

`./configure; make; make install`在Linux中是相当标准的。

问题的根源在于 Linux 在许多不同的处理器上运行。您不能像 Windows 那样仅仅依赖支持 x86 指令的处理器（对于大多数版本：Itanium（XP 和更新版本）和 Alpha（NT 4.0）是例外）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-01T06:41:18.307

那么，问题来了，如何为 Linux 开发共享库？您可以查看[本教程](http://www.yolinux.com/TUTORIALS/LibraryArchives-StaticAndDynamic.html)或[Pogram Library Howto](http://www.tldp.org/HOWTO/Program-Library-HOWTO/)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-01T06:57:56.207

我知道你在问什么。对于 Windows，MSFT 仔细地使所有 DLL 都兼容，因此您的 DLL 通常与几乎每个版本的 Windows 兼容，这就是您称其为“便携式”的原因。

不幸的是，在 Linux 上有太多的变化（每个人都想“与众不同”来赚钱），因此你无法获得与 Windows 相同的好处，这就是为什么我们为不同的发行版、发行版编译了许多相同的包的原因， CPU类型，...

有人说问题是由（CPU）架构引起的，但事实并非如此。即使在同一个拱门上，分布之间仍然存在差异。一旦你真正尝试过发布一个二进制包，你就会知道它有多难——即使是 C 运行时库依赖也很难维护。Linux 操作系统缺少太多东西，所以几乎每个服务都涉及依赖问题。

通常你只能构建一些与某些发行版兼容的二进制文件（或者，如果你幸运的话，可以构建几个发行版）。这就是为什么以二进制形式发布 Linux 程序总是搞砸的原因，除非绑定到像 Ubuntu、Debian 或 RH 这样的发行版。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T06:41:08.183

只需将 .so 文件放入 /usr/lib*可能会*起作用，但您可能会弄乱您的发行版用于管理库的方案。

看看 linux 标准库——这是你会发现的最接近 linux 发行版中的通用平台的东西。

[http://www.linuxfoundation.org/collaborate/workgroups/lsb](http://www.linuxfoundation.org/collaborate/workgroups/lsb)

你想达到什么目的？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T23:25:22.933

Tinkertim 的回答很到位。我要补充一点，理解和计划对[gcc 的 ABI](http://gcc.gnu.org/onlinedocs/gcc/Compatibility.html)的更改很重要。最近情况相当稳定，我猜所有主要发行版都在 gcc 4.3.2 左右。然而，每隔几年[，对 ABI（尤其是与 C++ 相关的位）的一些更改](http://gcc.gnu.org/bugs.html#upgrading)似乎会造成混乱，至少对于那些想要发布跨发行版二进制文件的人和习惯于从其他发行版获取软件包而不是实际的用户而言运行并发现它们工作。虽然其中一个过渡正在进行（所有发行版都按照自己的节奏升级），但理想情况下，您希望发布带有 ABI 的库，以支持您的用户使用的所有 gcc 版本。

# java - 如何在 MAVEN 中保持更新的库？

> ID：810178
> 
> 赞同：2
> 
> 时间：2009-05-01T04:21:09.673
> 
> 标签：java, configuration, maven-2, version-control

在我工作的开发商店中，我们有一个内部 MAVEN 存储库，用于保存我们的库（专有和开源）。我们面临的一个常见问题是，有时，我们本地 MAVEN 存储库中的开源库会过时。有没有一种自动的方法来保持我在我的 MAVEN 存储库中使用的所有开源库总是更新？你有什么建议来解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T07:13:25.220

已经提到了Archiva，但[nexus](http://nexus.sonatype.org/)似乎更受欢迎。两者都旨在解决您遇到的问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T16:33:39.117

假设你：

*   不想下载所有内容
*   不想运行另一个服务器进程
*   只想跟踪有限数量的项目

您可能希望创建一个单独的 pom.xml 文件，其中包含如下依赖项：

```
<dependency>
    <groupId>org.openfoo</groupId>
    <artifactId>jfoo</artifactId>
    <version>[1.0.0,2.0.0)</version>
</dependency> 
```

这将告诉 maven 使用 jfoo 1.0.0 到 jfoo 2.0.0，因此当 jfoo 发布 1.2.17 版本时，假设您的设置设置为每次检查版本，您将在下一个构建中获取它。

这个 pom 不必实际构建任何东西。只需列出您要跟踪的内容即可。

跑步：

```
 cd the-path-to-the-project; mvn -q -B -U package 
```

通过 cron 每天一次将更新该 pom 中的所有依赖项，并且仅在出现问题时报告

顺便说一句，这是一个黑客。如果开发人员的数量 > 3 并且您有运行 nexus 的资源，请不要为 hack 烦恼。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T07:00:57.933

看看[Apache Archiva](http://archiva.apache.org/)，一个 Maven 的存储库管理器。

# sql - 如何防止删除表中的第一行（PostgreSQL）？

> ID：810180
> 
> 赞同：11
> 
> 时间：2009-05-01T04:21:36.817
> 
> 标签：sql, postgresql, rules

是否可以防止删除 PostgreSQL 端表中的第一行？

我有一个类别表，我想防止删除默认类别，因为它可能会破坏应用程序。当然，我可以在应用程序代码中轻松地做到这一点，但在数据库中做到这一点会好得多。

我认为这与删除语句的规则有关，但我在文档中找不到任何与我的问题很接近的东西。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-04T08:29:58.333

你对规则系统的思考是对的。[这](http://wiki.postgresql.org/wiki/Introduction_to_PostgreSQL_Rules_-_Making_entries_which_can%27t_be_altered)是与您的问题匹配的示例的链接。它甚至比触发器更简单：

```
create rule protect_first_entry_update as
  on update to your_table
  where old.id = your_id
  do instead nothing;
create rule protect_first_entry_delete as
  on delete to your_table
  where old.id = your_id
  do instead nothing; 
```

有些答案漏掉了一点：受保护行的更新也必须受到限制。否则，可以首先更新受保护的行，使其不再满足禁止删除标准，然后可以删除更新的行，因为它不再受保护。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-01T04:30:36.577

您想在表上定义一个 BEFORE DELETE[触发器](http://www.postgresql.org/docs/8.1/interactive/triggers.html)。当您尝试删除该行（通过 PK 匹配或具有单独的“保护”布尔列）时，[引发](http://www.postgresql.org/docs/8.1/static/plpgsql-errors-and-messages.html)异常。

我不熟悉 PostgreSQL 语法，但[看起来](http://www.postgresql.org/docs/8.1/static/plpgsql-trigger.html)你会这样做：

```
CREATE FUNCTION check_del_cat() RETURNS trigger AS $check_del_cat$
    BEGIN            
        IF OLD.ID = 1 /*substitute primary key value for your row*/ THEN
            RAISE EXCEPTION 'cannot delete default category';
        END IF;

    END;
$check_del_cat$ LANGUAGE plpgsql;

CREATE TRIGGER check_del_cat BEFORE DELETE ON categories /*table name*/
    FOR EACH ROW EXECUTE PROCEDURE check_del_cat(); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-01T04:32:06.730

我认为实现此目的的最佳方法是在此表上创建删除触发器。基本上，您必须编写一个存储过程以确保此“默认”类别将始终存在，然后使用此表上的触发器 ON DELETE 事件强制执行它。做到这一点的一个好方法是创建一个每行触发器，以保证在 DELETE 事件上永远不会删除“默认”类别行。

请查看 PostgreSQL 关于触发器和存储过程的文档：

[http://www.postgresql.org/docs/8.3/interactive/trigger-definition.html](http://www.postgresql.org/docs/8.3/interactive/trigger-definition.html)

[http://www.postgresql.org/docs/8.3/interactive/plpgsql.html](http://www.postgresql.org/docs/8.3/interactive/plpgsql.html)

这个 wiki 中也有一些有价值的例子：

[http://wiki.postgresql.org/wiki/A_Brief_Real-world_Trigger_Example](http://wiki.postgresql.org/wiki/A_Brief_Real-world_Trigger_Example)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-01T04:45:41.173

您可以在另一个表（称为默认值）中有一行引用默认类别。FK 约束不允许删除默认类别。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-06T18:33:49.473

请记住触发器的工作原理。他们将为您的删除语句将删除的每一行触发。这并不意味着您不应该使用触发器，只需牢记这一点，最重要的是测试您的使用场景并确保性能满足要求。

我应该使用规则还是触发器？

来自官方文档：“对于两者都可以实现的东西，最好取决于数据库的使用情况。触发器会为任何受影响的行触发一次。规则操纵查询或生成附加查询。所以如果许多行在一条语句中受到影响，发出一个额外命令的规则可能比为每一行调用并且必须多次执行其操作的触发器更快。但是，触发器方法在概念上比规则方法简单得多，并且新手更容易做对。”

有关详细信息，请参阅文档。
[http://www.postgresql.org/docs/8.3/interactive/rules-triggers.html](http://www.postgresql.org/docs/8.3/interactive/rules-triggers.html)

# c# - C# 中的 .Net/Mono Singleton (Service/Server?) - 检测我的 .net 应用程序是否已经在运行并将命令行参数传递给它

> ID：810181
> 
> 赞同：2
> 
> 时间：2009-05-01T04:21:38.143
> 
> 标签：c#, .net, mono

我想在 C# 中创建一个简单的单例命令行应用程序（服务？），当它运行时，它会检查它是否已经在运行，如果是，它将命令行参数传递给已经运行的实例并自行关闭。现在在已经运行的实例中，它将通过诸如“delegate void Command(string[] args);”之类的事件接收命令行参数。或类似的东西，所以我可以通过事件通过一个应用程序管理命令行。

例如在photoshop中，当你第一次打开一张图片时，它会加载一个新的photoshop实例，但是当你打开第二张图片时，它会检查是否已经运行了一个photoshop实例，如果是，则通过将图片复制到已经加载的 Photoshop 实例中，这样它就可以避免重新加载 Photoshop 的代价高昂的时间......

或者在网络浏览器中，您可以设置它，以便如果您打开一个新的 .html 文件，它会在新选项卡中打开它，而不是在新窗口实例中打开它。

或者许多文本编辑器的设置只允许打开文本编辑器的一个实例，当打开一个新文件时，它会加载到新选项卡中，而不是新窗口中......

许多像winamp这样的音乐播放器也这样做......

我最终将把它设置为服务，所以它应该在以后不断地监听命令行参数，但现在主要是为了让我可以在一个单例应用程序中管理打开特定类型的文件，或者让其他应用程序传递他们想要打开的文件的命令行参数......

此外，如果您知道更好的方法或 .Net 中的 api 来将所有传递的命令行参数重新路由到始终运行的服务事件，我可以使用它......但我也想保持这个跨平台，如果可能的话，它可以在 Mono 上的 Linux/Mac 上运行，而无需管理两个或多个代码库......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T23:18:06.863

这是我用来实现您正在寻找的确切功能的文章，它还允许您传输命令行参数。

[单实例 C# 应用程序 - 适用于 .NET 2.0](http://www.codeproject.com/KB/cs/CSSIApp.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T04:28:56.033

我们使用 1.0 / 1.1 框架上的 .net 远程处理做了一些类似的事情，尽管出于非常不同的目的。基本上我们会使用信号量来确保我们是唯一运行的实例。如果您希望每台机器只有一个实例，则您需要定位全局命名空间；如果您希望每个用户会话有一个实例（在终端服务和快速用户切换场景中），则需要定位本地实例。

如果您可以锁定信号量，您将设置远程处理并开始监听事件，然后继续使用您的代码。

如果您无法锁定，那么您可以假设您有另一个正在运行的实例，在这种情况下，您将打开一个远程通道到另一个实例，传递参数并关闭。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T04:57:23.923

您可以尝试使用命名互斥锁（命名它会使其在系统范围内，并且易于识别）。使用互斥锁，您可以运行实例（如果不存在同名互斥锁），也可以打开现有实例并传入参数。抱歉没有代码示例，用我的手机写这个。

编辑：nvrmnd。只需重读这篇文章，我认为这对你跨平台来说不起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T06:33:02.960

Visual basic 有这个内置的。看一眼：

Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase -- 公共事件 StartupNextInstance

# asp.net-mvc - 是否有与 ASP.Net MVC 框架的 Monorail 视图组件等效的组件？

> ID：810187
> 
> 赞同：4
> 
> 时间：2009-05-01T04:24:00.820
> 
> 标签：asp.net-mvc, castle-monorail, castle

我在 Monorail 中构建的一些较大的应用程序中大量使用了[视图组件](http://ayende.com/Blog/archive/2007/04/08/Building-View-Components-For-MonoRail.aspx)- 在 ASP.Net MVC 中，可以支持部分等的视图组件的等效方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T20:24:56.670

实际上，您有几个选项可以在 ASP.NET MVC 中创建等效的 ViewComponent，具体取决于组件的复杂性。我使用这两种方法，它们是我所知道的更多 mvc-ish 选项。

**1：** 最简单的事情是创建一个 ViewUserControl 并使用 Html.RenderPartial 和 helper 显示它。ViewUserControl 是一个没有后备控制器的简单标记（我认为您可以根据需要放置一个代码隐藏文件）。或者，您可以在调用 RenderPartial 时将模型对象或整个 ViewData 字典传递给视图，如下所示：

```
<% Html.RenderPartial("TopBar", model); %> 
```

“TopBar”是一个 ascx 页面。这适用于任何地方，在母版页和普通视图中。

2：如果您希望您的组件具有更复杂的逻辑或访问数据源、IoC 等，那么您可以使用 Html.RenderAction，它是 Microsoft.Web.Mvc 程序集中的扩展方法。我在 mvccontrib 发行版中使用它。它的工作原理是这样的，你需要创建一个包含所有你需要的逻辑的普通控制器，然后创建一些视图，所有这些东西都成为你的组件，例如：

```
public class AboutComponentController : Controller {
public IRepository Repository{ get; set; }

public ActionResult Detail() {
    var lastEvent = Repository.FindAll<Auditoria>().FirstOrDefault();
    return View(lastEvent);
} 
```

}

请注意我是如何引用 IRepository 的，该 IRepository 将被注入 IoC（在我的例子中是温莎），我可以做任何普通控制器会做的事情。

现在，在要使用组件的任何页面（主页面或普通页面）中，导入 Microsoft.Web.Mvc 并使用适当的参数调用 Html.RenderAction。这将创建一个迷你 mvc 管道，用于创建控制器、解析视图等，就像 Monorail ViewComponent 一样。我更喜欢使用该方法的基于 lambda 的变体，如下所示：

```
<% Html.RenderAction<AboutComponentController>(x => x.Detail("a message"));%> 
```

不幸的是，传递参数的唯一方法是使用方法调用本身，而这又在控制器中必须是唯一的。仍然需要一些工作来类似于 ViewComponent。

我不在组件视图中使用母版页或布局，因为它们本身就是组合元素。

请记住，在使用 Webforms 视图引擎时，如果您希望在代码块中使用 Model 变量时具有智能感知功能，则可以使用强类型视图。

这样做的好处是您可以将视图引擎与这些方法混合使用，我通常在 nvelocity 中创建组件并将它们显示在 aspx 页面等中。

我现在可能存在缓存部分视图的问题，但到目前为止我还没有遇到任何问题。我确信还有其他选项（例如 mvccontrib 中的子控制器），但这对于简单的情况通常就足够了。当然，您可以在您的 aspx 视图页面中使用普通的 ASP.net 组件，但那是作弊，对吧？呵呵。我希望它有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T03:06:41.573

Phil Haack写了一篇关于创建区域以将控制器分组到子文件夹/部分的[博客](http://haacked.com/archive/0001/01/01/areas-in-aspnetmvc.aspx)，类似于 MonoRails。

# objective-c - 调用 UIView 的 removeFromSuperview 是否足够，或者是否需要删除 UIViewController？

> ID：810194
> 
> 赞同：4
> 
> 时间：2009-05-01T04:27:10.267
> 
> 标签：objective-c, iphone, cocoa-touch, uiviewcontroller

我有一个手动创建 UIViewController（不是 UINavigationController）并将该控制器的视图添加为子视图的主视图。

然后子视图通过 [self removeFromSuperview] 自行关闭。我知道这会释放视图，所以这很好，但是我现在想摆脱 UIViewController 我在视图被删除以释放内存时立即分配，而不是等到主视图控制器被释放.

我可以避免使用 removeFromSuperview 并反向引用主视图控制器并让它关闭子视图并释放控制器，但感觉应该有一种更清洁的方式。

是否有既定的最佳实践来实现这一目标？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T04:53:10.767

正确的方法是让您的子控制器要求主控制器将其删除。如果您想减少两个控制器之间的耦合，请为您的子控制器创建一个委托协议：

```
// This forward declaration avoids having a circular dependency 
// between MySubcontroller and MySubcontrollerDelegate
@class MySubcontroller;

@protocol MySubcontrollerDelegate

- (void)hideMySubcontroller:(MySubcontroller*)subcontroller;

@end 
```

如果还有其他信息需要子控制器与超控制器通信，这是添加相关调用的好地方。您可能不需要立即这样做，但请记住您的应用程序的未来版本。

然后`delegate`给子控制器添加一个属性：

```
@interface MySubcontroller : UIViewController {
    id <MySubcontrollerDelegate> delegate;
    ...
}
@property (assign) id <MySubcontrollerDelegate> delegate;
...
@end 
```

子控制器不应调用`removeFromSuperview`其视图，而应调用其委托，并作为参数`hideMySubcontroller:`传递。`self`

然后你的主控制器应该声明它实现了委托协议：

```
@interface MyMainController : UIViewController <MySubcontrollerDelegate>
...
@end 
```

当主控制器创建子控制器时，它应该将子控制器的`delegate`属性设置为`self`。它应该实现一个`hideMySubcontroller:`方法来删除子控制器的视图，释放子控制器，并做任何其他需要的事情。

使用委托协议意味着子控制器不必知道什么样的对象会使用它；它只知道某处有这样一个对象，并且它将符合委托协议。因此，两个控制器之间的耦合保持尽可能小。

顺便说一句，如果您可以管理它，实际上最好保留子控制器以防您需要再次使用它；这将节省重新创建它所需的处理时间。（但是，如果收到内存警告，您应该释放它。）

# asp.net - 你必须编译.net 3.5代码吗

> ID：810195
> 
> 赞同：1
> 
> 时间：2009-05-01T04:28:44.867
> 
> 标签：asp.net, compilation

我们的 Web 应用程序中有一个 .net 2.0 文件夹和一个 .net 3.5 文件夹。我可以简单地上传一个新的 .vb 文件并查看 2.0 中的更改，而无需编译和上传构建。但是，在 3.5 中，我似乎只在编译和上传构建后才能看到我的更改。有谁知道是什么迫使我必须编译我的.net 3.5？

非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T04:37:11.053

在我看来，您的 3.5 项目是作为“Web 应用程序”而不是“网站”创建的。前者需要编译，而后者不需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T04:37:33.673

如果它是一个 ASP.NET 网站，那么没有。它会即时自动编译 .cs 或 .vb 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T05:16:38.323

听起来您有一个 Web 应用程序。有两种方法可以在 .net 2.0 和 3.5 中实现网站。一种是 Web 应用程序，其中所有代码都预先为站点编译并发布到某个位置。另一个是网站。每当应用程序池被回收时，都会编译网站。该网站提供了仅推送几个文件或页面的自由，其中需要完全编译 Web 应用程序并推送整个应用程序。两者之间的性能差异并不是很大，老实说，除非您的站点不经常被访问并且空闲的工作进程被回收，否则用户不会注意到差异，这将导致下一个用户不得不等待几秒钟让它编译。

这是一篇很好的小文章，解释了差异： [ASP.NET 网站与 Web 应用程序项目](http://www.c-sharpcorner.com/UploadFile/kalisk/website02232009162404PM/website.aspx)

# asp.net - 如何使 Asp.Net/WSE asmx 页面生成器在派生类中添加基类属性

> ID：810197
> 
> 赞同：0
> 
> 时间：2009-05-01T04:29:20.450
> 
> 标签：asp.net, web-services, inheritance, serialization

我有一个带有 2 个公共属性的简单基类 B。这个类被另一个类 D 继承，它添加了另一个公共属性。派生类由 Web 服务调用返回。ASP.Net 生成的页面如下所示：

```
'''<remarks/>
    <System.CodeDom.Compiler.GeneratedCodeAttribute("System.Xml", "2.0.50727.3074"), _
     System.SerializableAttribute(), _
     System.Diagnostics.DebuggerStepThroughAttribute(), _
     System.ComponentModel.DesignerCategoryAttribute("code"), _
     System.Xml.Serialization.XmlTypeAttribute([Namespace]:="")> _
    Partial Public Class D
        Inherits B

        Private guidField As String

        '''<remarks/>
        Public Property Guid() As String
            Get
                Return Me.guidField
            End Get
            Set(ByVal value As String)
                Me.guidField = value
            End Set
        End Property
    End Class

   '''<remarks/>
    <System.Xml.Serialization.XmlIncludeAttribute(GetType(D)), _
     System.Xml.Serialization.XmlIncludeAttribute(GetType(B)), _
     System.CodeDom.Compiler.GeneratedCodeAttribute("System.Xml", "2.0.50727.3074"), _
     System.SerializableAttribute(), _
     System.Diagnostics.DebuggerStepThroughAttribute(), _
     System.ComponentModel.DesignerCategoryAttribute("code"), _
     System.Xml.Serialization.XmlTypeAttribute([Namespace]:="")> _
    Partial Public MustInherit Class B

        Private nameField As String

        Private descriptionField As String

        '''<remarks/>
        Public Property Name() As String
            Get
                Return Me.nameField
            End Get
            Set(ByVal value As String)
                Me.nameField = value
            End Set
        End Property

        '''<remarks/>
        Public Property Description() As String
            Get
                Return Me.descriptionField
            End Get
            Set(ByVal value As String)
                Me.descriptionField = value
            End Set
        End Property
    End Class 
```

有什么方法可以显示所有公共属性（来自 D 类中的 B 类和 D 类）？只有 D 类对 Web 服务客户端有用，B 类甚至不应该是可见的。谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T05:08:27.563

您是否尝试过使用 IncludeInSchema=False 在 B 类上使用 XmlTypeAttribute？我不知道这是否可行，但这是一种可能。

[MSDN 上用于 .NET 2.0 的 XmlTypeAttribute](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmltypeattribute.includeinschema(VS.80).aspx ".NET 2.0 的 MSDN XmlTypeAttribute")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T06:35:54.390

您可以在您的类型上使用[XmlSchemaProviderAttribute](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlschemaproviderattribute.aspx)并实现一个返回 xsd 架构的方法，而无需分离基类。这有点工作，但您可以从现有的默认输出开始，并在进入方法实现之前进行一些复制和粘贴工作。

# php - 这是一个 jQuery 错误，还是我错过了什么？

> ID：810199
> 
> 赞同：0
> 
> 时间：2009-05-01T04:30:27.653
> 
> 标签：php, jquery, ajax

我在 AJAX Web 应用程序中使用 jquery-1.3.2。我使用 jQuery ajax`$.post()`方法向服务器提交请求。

在服务器上，我使用 php 来构建一个数组，然后`json_encode`是答案。然后在客户端我使用 AJAX post 方法的回调函数来处理响应。

在我使用该`$.post()`方法将变量发送到服务器之前，一切正常。如果我将变量发送到服务器，我得到的响应是 [object Object]，因此我无法解析它。目前我有一个解决方法，即在发布变量时我请求一个 HTML 响应，然后我解析它。

因此，从我的网站获取的代码是：

贾克斯电话：

```
$.post("inc/sendfeedback.php", {NAME: name,TYPE: type,EMAIL: email,COMMENT: comment}, function(data) {PostData(data);}, "json"); 
```

所以 PostData 代码如下所示：

```
function ProcessData(data)
{
    //alert(data);
    var jo = eval("(" + data + ")");
    if(jo.result == "true")
    {
        if(jo.data != "" && jo.element != "")
        {
            $(jo.element).html(jo.data);
        }
    }

    SMessage(jo.error);
} 
```

如果我取消注释上面的代码，则警报中包含 [object Object]。

如果我从调用中删除 Post 变量，它工作正常。

服务器代码如下所示：

```
$arr = array ("result" => $result,"data" => $data,"error" => $error,"element" => $element);
echo(json_encode($arr)); 
```

这是 jQuery 库的错误吗，我用 1.2 版本尝试过，但它仍然存在？我还搜索了 jQuery 站点，但找不到任何遇到此问题的人。

所以我假设我错过了一些东西。但是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T04:36:38.840

```
$.ajax({
      url: "script.php",
      global: false,
      type: "POST",
      data: {NAME: name,TYPE: type,EMAIL: email,COMMENT: comment},
      dataType: "json",
      contentType: "application/json",
      success: function(data){
         alert(data.result);
      }
   } 
```

无需评估，jQuery 在调用成功回调之前对其进行评估/解析。

eval = 纯粹的邪恶

[http://docs.jquery.com/Ajax/jQuery.ajax#options](http://docs.jquery.com/Ajax/jQuery.ajax#options)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T04:38:19.710

因为您使用的是关联 PHP 数组，所以 json_encode 将返回 Javascript 对象的字符串表示形式，而不是 Javascript 数组。但是，您仍然应该能够以与数组类似的方式处理它：

```
for (var key in data)
{
    var item = data[key];
} 
```

我强烈建议您下载 Firefox+Firebug 插件并使用[控制台 API](http://getfirebug.com/console.html)来调试/转储服务器返回的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T03:05:44.750

我已经注册了，现在不能在没有声誉的情况下在这个线程中发表评论，也看不到任何简单的方法来声称这个问题是我的。

越轨，您使用 $.ajax() 方法的建议奏效了。第一次对我不起作用的原因是，当服务器代码需要 POST 数据时，我将 post 数据作为 JSON 对象提交。

因此，我修复了我的 javascript 以正确调用服务器脚本，并且一切正常。

所以结论是， $.post() 方法有一个错误。我还没有找到它，但第 3633 行是 post 方法进行调用。我开始挖掘，但尚未发现问题。

我通过以下事实来限定这一点一个有效的 JSON 对象。

谢谢你们的帮助。现在去删除我对 $.ajax 调用的所有 $.post 调用。

所有这一切的结果可以在 www.pygames.net 上看到

干杯 Shane aka FrogSkin

# visual-studio - 以下模块是在启用优化或没有调试信息的情况下构建的

> ID：810203
> 
> 赞同：142
> 
> 时间：2009-05-01T04:31:34.717
> 
> 标签：visual-studio, debugging, visual-studio-2008, visual-studio-debugging

调试时，我无法在我的 VS 2008 Web 项目中摆脱这个问题。我已经检查过它在有问题的非 Web 项目上处于调试模式，并且它处于 Active(Debug) 状态。删除了 Windows 中我的 .NET 2.0 临时文件夹中的所有项目。不知道还能在这里做什么。

* * *

## 回答 #1

> 赞同：188
> 
> 时间：2010-04-23T16:36:50.067

尝试在工具/选项/调试/选项中禁用“仅启用我的代码”。

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2009-06-30T12:22:40.170

我遇到了同样的问题，发现我没有在我的构建中输出我的调试信息。如果您右键单击项目并转到“属性”，然后选择“构建”选项卡，在页面底部有一个“高级...”按钮，它将显示您的设置为您输出调试信息。将其设置为“完整”，错误应该会消失。

![在此处输入图像描述](https://i.stack.imgur.com/M3S1x.png)

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2011-10-25T19:09:27.493

我刚刚遇到了这个问题，并很快决定发布的其他答案不适用于我。

![禁用](https://i.stack.imgur.com/WBWo1.png)

我是该项目的所有者，我知道它是使用调试信息构建的，并且没有进行优化。此外，我从不乐意选择禁用警告作为我的第一选择。隐藏/忽略此警告可能会成为未来调试会话中的一个问题。

[由于这只是在我签署程序集](http://msdn.microsoft.com/en-us/library/wd40t7ad.aspx)后才开始发生，这让我了解了我的快速修复：暂时删除我的 DLL 的强名称（并使用 EXE）。瞧！问题解决了。

更好的长期解决方案可以采用添加构建后操作的形式来更新[GAC](http://msdn.microsoft.com/en-us/library/yf1d93sz.aspx)，使其具有最新版本的签名 DLL。

但就目前而言，我很高兴从这个转移中继续前进，并继续解决将我带到这个调试会话的问题。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-05-01T04:51:44.700

解决。删除了有问题的 dll 的所有出现（所有项目）。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2013-10-17T21:56:34.763

VS2012，清理和重建为我解决了这个问题。“属性”->“构建”->优化代码未选中。“属性”->“构建”->“高级”-> 调试信息：完整

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2010-10-16T14:52:28.777

看看这个链接

[http://social.msdn.microsoft.com/Forums/en-US/vsdebug/thread/43cb16ba-0759-42ab-8e7d-9f168ace3b6f](http://social.msdn.microsoft.com/Forums/en-US/vsdebug/thread/43cb16ba-0759-42ab-8e7d-9f168ace3b6f)

尝试在工具->选项->调试->常规中取消选中“只是我的代码”。

这个对我有用

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2010-06-16T16:52:30.630

猜测 VS 2008 没有正确重建 dll。

1）删除所有出现的dll

2）重建解决方案

那应该解决它。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2011-01-03T19:58:06.227

如果一切都失败了，请尝试在项目的属性中重命名程序集名称。这为我解决了这个问题。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-05-01T04:44:03.580

检查您的构建配置选项。确保关闭优化并定义 DEBUG 常量。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2013-01-24T15:33:59.450

我也遇到了这个问题，由于某种原因，它发生了 3 或 4 次；我认为它一定是 Visual Studio 2005 的错误/故障（或至少是我的安装）。

这每次都有效：要修复它，我

1.  右键单击我的解决方案，然后单击属性。
2.  打开配置管理器。
3.  在下拉菜单中选择调试（如果尚未选择）。
4.  取消选中构建。然后重新检查它。
5.  重建解决方案。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2013-03-07T05:30:32.533

工具 > 选项 > 调试 > 符号 > 指定排除模块查看排除模块列表中的 dll 或 exe

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2010-04-23T16:20:31.697

**至少对于非 Web 应用程序，这是有效的：**

来自：[http ://www.stellarpc.com/articles/board.aspx?id=40](http://www.stellarpc.com/articles/board.aspx?id=40)

2 - 允许调试...

由于在应用程序中构建了其中一个程序集的性质，您需要更改一些设置以允许 Visual Studio 调试器处理代码。

从解决方案资源管理器中右键单击任何有问题的项目，然后选择“属性”。这将打开项目属性面板，让我们可以访问项目的许多选项。导航到“编译”选项卡（如果您在 C# 环境中，则导航到“构建”）并从屏幕底部选择“高级编译选项...”。这为我们提供了一个提示，其中包含两个关键领域：

1) 优化 - 取消选中“启用优化”

2) 生成调试信息 - 确保该选项设置为“完整”

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2011-06-22T19:48:19.023

我在某个文件夹中的解决方案遇到了这个问题，但是如果我将它移到另一个文件夹或其他人构建它，我没有收到消息。我进行了清理、重建，甚至重新启动，但如果没有此消息，仍然无法调试原始文件。我在我的系统中搜索导致错误的文件的副本，发现副本保存在

c:\用户\用户名\AppData\Local\Assembly\dl3

这是在 Win7-64 上，但在其他 Windows 操作系统上也类似。我删除了在那里找到的所有副本，我不再收到消息。我不需要取消选中“仅启用我的代码”。

此外，这是针对 WPF 应用程序的，但我在搜索中遇到了这个线程，所以希望这对其他人有帮助。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2012-07-19T17:49:57.433

我能够通过以下步骤解决此问题：

1.  右键单击解决方案（不是项目），然后选择“属性”
2.  在左侧面板中，选择“配置属性”
3.  在右侧面板中，为您的项目选择“配置”列下的“调试”

如果您没有在解决方案资源管理器中看到该解决方案，请按照下列步骤操作：

1.  在菜单栏中，转到工具 -> 选项
2.  在左侧面板中，选择“项目和解决方案”（您可能需要选中窗口左下角的“显示所有设置”
3.  在右侧面板中，选中“始终显示解决方案”

我希望这有帮助。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2012-08-22T05:04:28.987

我在尝试远程调试属于不同子网的计算机上的应用程序时遇到了这个问题。如果机器在同一个子网上，我可以在通过网络运行代码时调试和单步调试代码。更改子网后，虽然我在从网络运行时无法单步执行并且得到“以下模块是在启用优化或没有调试信息的情况下构建的”。

解决方案？简单的。将构建的解决方案复制到托管远程调试的机器上并在本地运行。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2010-01-21T21:26:18.213

这些我也都有。而我已经完成了这一切。每次我从源代码控制中获得整个解决方案的新副本时，似乎都会发生这种情况。因此，如果我们已经完成了所有这些，删除了 web 项目中所有引用（程序集）的 dll 和 .pdb 文件，使用了解决方案上的 clean 选项，删除了临时文件，关闭了 VS 并重新打开，确保选择了调试模式并设置为满，优化关闭，还有什么？！？！？！

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2011-03-09T17:32:02.880

我在 Visual Studio 2010 中的 Web 项目中遇到了同样的问题，最后我找到了收到此消息的原因。我所做的是更改 Visual Studio 上现有的调试选项：

*   转到工具->选项->调试->符号->所有模块
*   检查“除非排除”单选按钮
*   单击链接“指定排除的模块”，然后删除要调试的 DLL。

就我而言，这是我的网络 dll 文件...

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2012-08-30T11:43:12.003

我在 VS 2010 winForms 项目中遇到过这种情况。看到这里的大多数人都有网络项目，我认为这与访问存储项目的文件夹有关。我这样说是因为当我遇到这个问题时，Google Drive 正在同步我保存项目的文件夹。似乎只是禁用同步并不能解决问题。

我的解决方案类似于上面的答案之一：

*   转到“项目属性>编译>高级编译选项”
*   选中“启用优化”
*   将“常规调试信息：”设置为“无”
*   未选中“定义调试常量”
*   然后按确定
*   然后返回并将选项返回到初始状态。

希望这对某人有所帮助，因为这似乎仍然会发生。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2016-02-15T10:09:09.100

按照这个：（首先停止调试）
1：右键单击**项目解决方案名称**或**项目**- >**属性**
2：在**配置属性**下选择**配置管理器**
3：更改**配置**以 **调试**并单击**关闭**
4：更改**配置**以**调试**并单击**应用 - > OK**
现在重建解决方案....！

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2013-06-17T00:17:18.140

我有同样的问题，但原因和解决方案不同。该窗口与 Gustavo（上图）显示的窗口相同，但路径位于： **“\users\zzz\AppSettings...”**（其中 zzz 是 Windows 用户名）

我有一个 Excel 插件 - 我正在测试插件的安装，所以我通过 VS 安装功能安装了一个副本。VS 显然是在尝试调试已安装的副本和我刚刚启动的副本，并且在已安装的副本上找不到调试符号。

上述解决方案均无效（无副作用），

**解决方案：** 卸载插件，并手动删除应用程序设置中的文件。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2012-06-11T14:14:59.410

对我来说，选中项目属性中的“优化代码”框，保存，取消选中，然后重新保存为我做了。

禁用“仅启用我的代码”也有效，但这更像是一种解决方法而不是修复，因为我不想要那个设置。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2013-01-19T13:54:06.053

如果您要发布到 IIS 并且不使用内置 Web 服务器 - 或 IIS express - 确保您的发布配置文件设置处于调试模式。默认情况下，在 vs 11 中它处于发布模式。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-10-08T12:12:18.890

我在 SVN 的存储库签出中有这个，随着时间的推移，项目的源代码被添加到解决方案中。

解决方案看起来像这样

```
solution
- project 1
  - Reference '..\assemblies\<companyname>.Customers.Adapter1.dll'
- project 2
  - Reference '<companyname>.Customers.Adapter1.dll' (project reference).
- project '<companyname>.Customers.Adapter1' 
```

要解决：

*   在项目 1 中，删除对程序集文件夹 dll 的引用。

*   在项目 1 中，添加对“.Customers.Adapter1”的项目引用。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2014-02-03T20:39:31.220

I had this problem with a project and it turned out commenting out the following line in AssemblyInfo.cs fixed the issue:

```
[assembly: Debuggable(DebuggableAttribute.DebuggingModes.IgnoreSymbolStoreSequencePoints)] 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2013-04-17T14:35:57.627

我正在创建一个 Windows 服务，这对我有用：

*   卸载服务。
*   打开命令提示符并转到 c:\Windows\Microsoft.NET\Framework64\v4.0.30319
*   installutil C:\MyFantabulusWindowService\bin\Debug\MyFantabulusWindowService.exe

大功告成！

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-05-01T04:37:04.080

你提到这是一个网络项目......你有吗

```
<compilation debug="true /> 
```

在您的 web.config 中？

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2013-02-27T10:53:46.463

只是补充一下，我正在查看此博客以找到解决我面临的相同问题的方法。不幸的是，上面提到的解决方案对我没有帮助。最后我发现，我正在通过安装程序安装我的位（连同 .pdb），并在安装文件夹上明确设置权限。

因此，即使文件浏览器显示正确的文件，VS 也无法加载 pdb，但它给出了上述相同的错误。

一旦我取消选中“仅启用我的代码”并从安装程序中删除权限设置，VS 就开始加载模块。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2013-03-02T18:24:41.307

对我有用的一种配置如下

项目-->（您的项目）属性-->调试选项卡确保配置设置为活动（调试）在“无法调试器”下，确保选中“启用非托管代码调试”

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2010-07-16T16:16:55.590

在使用 Release 配置构建后，我遇到了同样的问题。事实证明，当我切换回 Debug 时，VS 没有检测到任何差异，因此它没有更新 bin 文件夹中的 .dll 和 .pdb 文件。

这对我有用：

1.  运行 iisreset（清理临时文件夹）
2.  保存 web.config（强制 VS 实际重建）
3.  调试时重建
4.  启动项目

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2010-08-12T05:46:08.933

尝试重建然后调试。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2010-11-03T16:15:50.267

我的情况如下：webservice 引用了 lib1.dll。后来我删除了参考，因为它不再使用了。但是 lib1.dll 保留在 bin 文件夹中。因为没有引用库，所以重建和清理操作没有帮助。从 bin 文件夹中手动删除 lib1.dll 后，我摆脱了此消息。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2013-05-22T01:18:07.937

案例：在 SharePoint 开发中使用控制台项目测试程序集 - 如果您正在进行 SharePoint 开发并在 VS 中看到此警报，请确保在测试控制台应用程序之前将您的 SP 程序集部署到 GAC 如果您的核心 SP 项目具有您需要的方法在您的控制台测试应用程序中调用。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2020-11-06T05:18:05.250

我也有这个问题，解决这个问题的一种方法是以元数据形式打开文件的项目，将该项目添加为项目引用而不是文件引用，例如 dll 或 exe。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2016-11-28T10:04:57.873

对我来说，我删除了临时 asp.net 文件中的所有文件，并关闭了我的解决方案并重新打开它，它工作正常

# .net - 使用 ViewModel 中定义的 RelayCommand 传递参数（来自 Josh Smith 示例）

> ID：810208
> 
> 赞同：27
> 
> 时间：2009-05-01T04:37:05.580
> 
> 标签：.net, wpf, data-binding, mvvm, lambda

我想通过使用 RelayCommand 将我的应用程序的 XAML（视图）中定义的参数传递给 ViewModel 类。我关注[了 Josh Smith 关于 MVVM 的优秀文章，](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx#id0090030)并实现了以下内容。

XAML 代码

```
 <Button 
        Command="{Binding Path=ACommandWithAParameter}"
        CommandParameter="Orange"
        HorizontalAlignment="Left" 
        Style="{DynamicResource SimpleButton}" 
        VerticalAlignment="Top" 
        Content="Button"/> 
```

视图模型代码

```
 public RelayCommand _aCommandWithAParameter;
  /// <summary>
  /// Returns a command with a parameter
  /// </summary>
  public RelayCommand ACommandWithAParameter
  {
     get
     {
        if (_aCommandWithAParameter == null)
        {
           _aCommandWithAParameter = new RelayCommand(
               param => this.CommandWithAParameter("Apple")
               );
        }

        return _aCommandWithAParameter;
     }
  }

  public void CommandWithAParameter(String aParameter)
  {
     String theParameter = aParameter;
  }
  #endregion 
```

我在 CommandWithAParameter 方法中设置了一个断点，并观察到 ​​aParameter 设置为“Apple”，而不是“Orange”。这似乎很明显，因为使用文字字符串“Apple”调用了 CommandWithAParameter 方法。

但是，查找执行堆栈，我可以看到“橙色”，我在 XAML 中设置的 CommandParameter 是 ICommand Execute 接口方法的 RelayCommand 实现的参数值。

也就是执行栈下面方法中的参数值是“橙色”，

```
 public void Execute(object parameter)
  {
     _execute(parameter);
  } 
```

我想弄清楚的是如何创建 RelayCommand ACommandWithAParameter 属性，以便它可以使用 XAML 中定义的 CommandParameter“Orange”调用 CommandWithAParameter 方法。

有没有办法做到这一点？

我为什么要这样做？“即时本地化”的一部分 在我的特定实现中，我想创建一个可以绑定到多个按钮的 SetLanguage RelayCommand。我想将两个字符语言标识符（“en”、“es”、“ja”等）作为 CommandParameter 传递，并为 XAML 中定义的每个“设置语言”按钮进行定义。我想避免必须为每种支持的语言创建一个 SetLanguageToXXX 命令，并将两个字符语言标识符硬编码到 ViewModel 中的每个 RelayCommand 中。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-05-01T08:16:56.940

我不明白为什么你首先要指定 lambda 的额外复杂性。为什么不这样做：

```
if (_aCommandWithAParameter == null)
{           
    _aCommandWithAParameter = new RelayCommand<object>(CommandWithAParameter);
}

private void CommandWithAParameter(object state)
{
    var str = state as string;
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-01T05:01:47.063

您将 lambda 中的参数传递给命令，如下所示：

```
if (_aCommandWithAParameter == null)
{           
    _aCommandWithAParameter = new RelayCommand(               
        param => this.CommandWithAParameter(param)
        );        
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-12-18T16:03:54.733

之前在这里发布的任何内容都没有为我工作。

事实证明，所有答案都缺少`<object>`后面`RelayCommand`！

这对我有用：

```
public RelayCommand<object> OKCommand
{
    get
    {
        if (_okCommand == null)
            _okCommand = new RelayCommand<object>(OkCommand_Execute);
        return _okCommand;
    }
}
private RelayCommand<object> _okCommand = null;

private void OkCommand_Execute(object obj)
{
    Result = true;
} 
```

如果要使用`CanExecute`方法，请使用以下代码：

```
_okCommand = new RelayCommand<object>(OkCommand_Execute, OkCommand_CanExecute);

private bool OkCommand_CanExecute(object obj) { } 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-09T03:45:01.253

这是命令参数的简单解决方案，因为我正在寻求有关该主题的帮助。我在网上找不到任何足够简单的东西。当您使用中继命令时，以下解决方案效果很好。我有一些超链接需要获取使用命令参数单击的 url 值。

第 1 步：在您的中继命令中，创建一个简单的属性来保存参数对象的值。您可以将其称为参数值或您喜欢的任何名称。

```
public object ParameterValue
{
  get;
  set;
} 
```

第二步：在 RelayCommand 类的 Execute 方法中，将上面创建的值或属性设置为来自 Execute 方法的参数。

```
readonly Action<object> m_execute;       // Action to execute

public void Execute(object parameter)
 {
   this.ParameterValue = parameter;
   m_execute(parameter);
 } 
```

第 3 步：现在，您可以将 xaml 中的 CommandParameter 绑定到执行命令时要检索的任何值。例子：

```
<TextBlock>
  <Hyperlink Command="{Binding Path=NavigateUrlCmd}"
             CommandParameter="{Binding ElementName=tbwebsite, Path=Text}">
    <TextBlock Name="tbwebsite" Text="{Binding Path=website}"/>
  </Hyperlink>
</TextBlock> 
```

如果您有一个名为 chickenCommand 的命令，执行时您可以访问参数： chickenCommand.ParameterValue

我希望这对某人有所帮助。感谢您之前的所有帮助。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-12-22T09:01:32.587

我只是想推销我的观点，看看这是否有效......

[http://mywpf-visu.blogspot.com/2009/12/relay-command-how-to-pass-parameter.html](http://mywpf-visu.blogspot.com/2009/12/relay-command-how-to-pass-parameter.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-03-28T15:16:24.820

我不能用编译错误替换对 lamda 表达式的方法名称的引用。显然，并且毫不奇怪，不能使用非静态方法名称引用来代替 lambda。我几乎不认为它是“增加的复杂性”。持续传递 lamdas 对我来说很有意义。

# java - jvm间通信

> ID：810212
> 
> 赞同：7
> 
> 时间：2009-05-01T04:40:14.510
> 
> 标签：java, rpc

我正在寻找 Java 中的进程间通信库。我希望在 JVM 之间发送小消息，如果可以的话，我想使用共享内存来做。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-01T06:18:09.347

Java NIO 支持内存映射文件。如果多个 JVM 内存映射同一个文件，它们可以将其用作共享内存。

这是内存映射文件的示例。

```
try {
int shmSize = 1024;
RandomAccessFile file = new RandomAccessFile("shm.raw","rw");

// inialize file size
if(file.length() < shmSize) {
  byte[] tmp = new byte[shmSize];
  file.write(tmp);
  file.seek(0); // seek back to start of file.
}

// memory-map file.
FileChannel ch = file.getChannel();
MappedByteBuffer shm = ch.map(FileChannel.MapMode.READ_WRITE, 0, shmSize);
ch.close(); // channel not needed anymore.
shm.load(); // force file into physical memory.

// now use the ByteBuffer's get/put/position methods to read/write the shared memory

} catch(Exception e) { e.printStackTrace(); } 
```

在 Linux 上，您可以在 /dev/shm/ 一个基于内存的文件系统中创建 shm.raw 文件。这将有助于避免任何磁盘 I/O。

有关更多详细信息，请阅读这篇文章[Java 中的内存映射 IO 简介](http://www.developer.com/java/other/article.php/10936_1548681_1)

此外，您仍然需要一种方法来同步对共享内存的读/写。当一条完整的消息被写入时，发送方 JVM 需要向接收方 JVM 发出信号。

对于小消息，使用 Java NIO 的 SocketChannel 可能会更好，因为接收者可以在收到消息时得到通知。共享内存只有在发送大消息时才会真正有帮助。

对于不同机器上 JVM 之间的 IPC，请尝试 [JIPC](http://www.garret.ru/jipc/jipc.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T05:50:54.713

我建议你看看[兵马俑](http://www.terracotta.org/)。我不知道它是否符合您的要求，因为 Terracotta 的主要目标是无缝可扩展性（“api”只是内存访问），但它肯定有消息集成模块。它是开源的。

干杯。

# language-agnostic - 哪种编码风格更常见？

> ID：810214
> 
> 赞同：2
> 
> 时间：2009-05-01T04:42:21.353
> 
> 标签：language-agnostic, coding-style

我绝不以任何形式或形式宣传/推广我的编程风格，但就“多变量声明”而言，**这种情况在专业和普遍上更容易接受**：

情况1：

```
private $databaseURL   = "localhost"  ;
private $databaseUName = "root"       ;
private $databasePWord = ""           ;
private $databaseName  = "AirAlliance"; 
```

案例2：

```
private $databaseURL = "localhost";
private $databaseUName = "root";
private $databasePWord = "";
private $databaseName = "AirAlliance"; 
```

我喜欢案例 1 的原因是因为我可以略过它并看到一切都是正确的，比案例 2 更快。而且我可以直观地熟悉变量名，这使得在程序中使用它们更快。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-01T04:44:00.600

无论项目已经在使用哪种样式，因此您最终不会花费一整天的时间来*修复*您接触的每个文件。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-01T04:49:43.053

案例 1.5：

```
private $databaseURL   = "localhost";
private $databaseUName = "root";
private $databasePWord = "";
private $databaseName  = "AirAlliance"; 
```

我不认为对齐分号使其更具可读性，它只会让更改其中一个字符串的值变得烦人，然后必须添加或删除空格以重新排列分号。

在这种情况下，看起来变量名不太可能改变，所以排列等号应该没问题。但是，如果变量名称可能会改变，我会选择案例 2，因为（再次）必须重新排列所有内容会很烦人。（想象一下简单地添加一个名为 的新变量所涉及的工作`$databaseLongVariableName`。）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-01T04:47:19.220

案例 2。当您向“组”添加一个新变量，或者在其中一行添加/删除一个字符时，您不必花时间摆弄试图让事情排成一行。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-01T04:57:22.440

如果您在添加新变量时更改了它们的所有对齐方式，那么任何差异工具都会在那里显示多个更改。只是一个想法。

另外，我做过一次。当我不得不添加一个更长的变量时，这让我很头疼。用空格填充所有现有的以匹配使我关闭了这种技术。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-01T06:59:53.100

很好地对齐东西是很诱人的，我曾经在 PHP 中对齐我的访问器

```
function getName()  { return $this->name;   }
function getAge()   { return $this->age;    }
function getHeight(){ return $this->height; } 
```

当您添加更长的行时，问题就来了：

```
function getName()  { return $this->name;   }
function getAge()   { return $this->age;    }
function getNiNumber(){ return $this->ni_number; }
function getHeight(){ return $this->height; } 
```

如果我编辑其他三行，那么当我提交我的更改时，就更难看出谁写了特定的行，以及他们在哪个版本中写的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-01T04:47:35.477

有趣的问题。就我而言，没有充分的理由使用案例 1。我以前从未见过这种风格，除了可能在配置文件中，而且正确格式化代码需要额外的时间。一旦你改变了变量的内容，你也必须重新设置你的分号。

它仅在您也使用空格时才有效......使用制表符的任何人都可能设置了不同的制表位，因此在另一个编辑器中打开它看起来会完全不同。

我认为您提到的可读性优势在某种程度上被编写它所需的额外努力所抵消。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-04-04T05:01:36.513

对齐类似的东西`=`，`;`只会招致一大堆标签空间的错误，这些错误会被签入，然后必须稍后修复。

大多数人会使用一行左侧的制表符进行缩进，然后使用空格将内容对齐到右侧。

除了给文件增加膨胀之外，它只会变成一个大的、不一致的汤汁。对我来说，它不会使代码更具可读性。对于一些编辑来说，它使代码的可读性更*差。*

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-01T06:21:44.453

用例 2。这更加标准：[Google C++ 风格](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml)

真的，你甚至不应该关心这个。您的编辑器应该自动格式化您的代码。在 Eclipse 中尝试 ctrl+shift+F。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-05-04T10:42:03.017

您可以查看“Expert PHP 5 Tools”一书，以更详细地了解代码样式。*网上有电子书*

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-01T04:51:49.177

对齐分号对我来说似乎是浪费时间，除非您的 IDE/文本编辑器可以为您完成。特别是如果您稍后添加另一个比以前更长的条目；你必须重新调整*所有*这些。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-01T04:56:20.370

我刚刚启动了我的编辑器，它就击中了我。我喜欢案例 1 的所有原因都在于语法高亮而不浪费时间。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-01T05:28:16.283

案例 2\. 每次重新调整间距时，您的版本控制都会变得疯狂。除了带有突出显示的 IDE 和一些还显示变量列表的 IDE 之外，对齐 '=' 和 ';' 真的很浪费时间 在我看来。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-01T05:32:46.460

案例 2。如果我遗漏了分号，我有一个程序会告诉我。它是*编译器*。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-01T08:05:34.937

与您正在从事的项目一起工作是最好的选择。（如果项目没有一套编码指南，强烈建议花五分钟时间来定义它们）。

许多大型程序都有扫描代码以查找要分类和清理的东西的工具。在变量末尾添加空格*可能会*影响其中一些。

同样关于制表符，我从来没有参与过不能确定编辑制表符间距的项目。您始终可以使用您的个人文件并使用预提交挂钩在文件进入之前对其进行编辑，但是弄乱制表符间距会使人们无休止地烦恼。

# javascript - JavaScript/HTML 大写还是小写？

> ID：810218
> 
> 赞同：4
> 
> 时间：2009-05-01T04:44:43.580
> 
> 标签：javascript, html, case-sensitive, case-insensitive

为了兼容性/JIT 编译性能，在 JS/HTML 中使用大写还是小写会更好吗？例如：

```
 <DIV> my content </DIV>
 <div> my content </div>

 ALERT(DOCUMENT.LOCATION);
 alert(document.location); 
```

这不是一个新手问题，我知道小写是事实上的标准。但是因为我见过一些大写的 JS+HTML，我想知道哪个会更好。（比如 SQL 是完全大写的？）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T04:46:52.577

我不认为它会有所作为，速度方面。

XHTML：小写标记是 W3C 指定的。

JavaScript：它可能行不通，因为我*从未*见过任何人的代码在 JS 中使用全部大写。

SQL 完全大写，以便将操作、函数等与实际数据区分开来。您可以使用小写字母，但它的可读性会降低（对某些人来说，包括我在内）。

IMO，通过一堆大写标签的可读性低于小写标签。我会说用户代理不在乎标签是什么情况。这里有一点历史：当我在 1999 年创建网站时，大写标签是标准。

你仍然可以找到一些仍然在写的狡猾的未更新网站

> '`<B></B>`用于使文本加粗'

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T04:48:07.457

`<DIV>...</DIV>`使用;是不正确的（至少在 xhtml 中）它是一个`<div>...</div>`.

`alert(document.location);`同样，我会在 javascript (for )中使用小写字母，因为**那是他们的名字**；-p

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T04:48:10.903

我无法想象它在兼容性或性能方面有什么不同。我认为有些人发现大写字母更容易识别为标记或代码而不是内容。

如果必须，您可以进行一些基准测试。

（XHTML 将小写指定为标准，所以如果您的目标是满足验证器，那就去吧）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T05:53:49.107

JavaScript（使用 Fx3.0）区分大小写。

```
var myURL = document.URL; // sets myURL to the current URL
var myURL2 = DOCUMENT.URL; // ReferenceError: "DOCUMENT" is not defined 
```

HTML 允许混合大小写的标记，XHTML 只要求小写标记、属性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T04:49:31.897

它肯定会与 javascript 有所不同，因为它区分大小写。

公认的 html 社区标准是小写，即使浏览器不在乎。

所以请善待那些稍后必须阅读您的代码的人！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T05:02:46.780

我肯定会尽可能使用小写字母。我倾向于喜欢驼峰式多词变量名称，但即使这样也可以避免使用下划线。

# google-app-engine - 是否可以在 Google App Engine for Java 上部署 ColdFusion 代码？

> ID：810233
> 
> 赞同：4
> 
> 时间：2009-05-01T04:52:48.210
> 
> 标签：google-app-engine, coldfusion, bluedragon

由于 ColdFusion 本身是基于 Java 的，我想建议 CFML 代码可以部署在 Google App Engine 上并不过分。

BlueDragon 是用于在 Java 服务器上部署 CFML 代码的商业解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T05:00:59.123

在此线程中描述了有人如何在 App Engine 上运行 OpenBD（蓝龙）：

[Google App Engine for Java 上的 OpenBD](http://groups.google.com/group/openbd/browse_thread/thread/a9da36320b64d5d6)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T13:02:13.290

> 是否有任何可用于 App Engine 的开源替代方案？

[Railo](http://www.getrailo.com/index.cfm/products/railo-open-source/)是另一个明显的候选者，有些[人似乎正试图调整它](http://groups.google.com/group/railo/browse_thread/thread/1f2ce8522710fff1)以在 Google App Engine 上使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-12T05:07:24.967

我正在整理一些在 Open BlueDragon 上运行的演示，这些演示又在 Google App Engine 上运行。目前该列表很小，但最终它应该让您对 OpenBD 和 GAE 的可行性有一个很好的了解。

[http://www.brighthub.com/hubfolio/matthew-casperson/blog/archive/2010/05/12/cold-fusion-demos.aspx](http://www.brighthub.com/hubfolio/matthew-casperson/blog/archive/2010/05/12/cold-fusion-demos.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T22:27:27.890

查看 [http://www.stax.net/](http://www.stax.net/) - 由前 Allaire(r) 制作的 Stax 网络？

效果很好，支持 ..cloud 中的冷融合。你下载一个预编译的源文件，把你的东西放进去，上传它就可以了，不用和它打架。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-26T17:21:13.917

我知道谷歌应用引擎是相当严格的，它将涉及打开源代码并删除试图写入文件系统的所有内容，并更改您的数据库交互。

您可以签出[此线程](http://groups.google.com/group/openbd/browse_thread/thread/a9da36320b64d5d6?pli=1)和组作为[Open BlueDragon](http://openbluedragon.org/)和[wiki](http://wiki.openbluedragon.org/wiki/index.php/Category:GoogleAppEngine)的资源。看起来他们已经有一个致力于 GAE 兼容性的分支。

在CFML 开源池的[Railo方面，您可以参考这篇文章，帮助您](http://www.getrailo.org/)[从源代码](http://corfield.org/blog/index.cfm/do/blog.entry/entry/Building_Railo_from_Source)自行编译 Railo 。

加入他们各自的谷歌小组并提出问题也应该会产生丰硕的成果。

祝你好运！

# ruby - 什么时候在 Ruby 中使用 Struct 比使用 Hash 更好？

> ID：810243
> 
> 赞同：47
> 
> 时间：2009-05-01T04:57:20.490
> 
> 标签：ruby

Ruby Struct 允许使用一组访问器生成实例：

```
# Create a structure named by its constant
Customer = Struct.new(:name, :address)     #=> Customer
Customer.new("Dave", "123 Main")           #=> #<Customer name="Dave", address="123 Main"> 
```

这看起来既方便又强大，但是，Hash 做了一些非常相似的事情：

```
Customer = {:name => "Dave", :address => "123 Main"} 
```

在哪些实际情况下我应该更喜欢 Struct（以及为什么），在选择其中一个而不是另一个时有哪些注意事项或陷阱？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-01T07:41:05.090

就我个人而言，当我想让一段数据表现得像一个数据集合而不是松散耦合在`Hash`.

例如，我制作了一个从 Youtube 下载视频的脚本，其中我有一个结构来表示视频并测试所有数据是否到位：

```
 Video = Struct.new(:title, :video_id, :id) do
  def to_s
    "http://youtube.com/get_video.php?t=#{id}&video_id=#{video_id}&fmt=18"
  end

  def empty?
    @title.nil? and @video_id.nil? and @id.nil?
  end
end 
```

稍后在我的代码中，我有一个循环遍历视频源 HTML 页面中的所有行，直到`empty?`不返回 true。

我见过的另一个例子是[James Edward Gray IIs](http://blog.grayproductions.net/) [配置类](http://www.ruby-forum.com/topic/138141#614705)，它`OpenStruct`用于轻松添加从外部文件加载的配置变量：

```
#!/usr/bin/env ruby -wKU

require "ostruct"

module Config
  module_function

  def load_config_file(path)
    eval <<-END_CONFIG
    config = OpenStruct.new
    #{File.read(path)}
    config
    END_CONFIG
  end
end

# configuration_file.rb
config.db = File.join(ENV['HOME'], '.cool-program.db')
config.user = ENV['USER']

# Usage:
Config = Config.load_config('configuration_file.rb')
Config.db   # => /home/ba/.cool-program.db
Config.user # => ba
Config.non_existant # => Nil 
```

`[Struct](http://www.ruby-doc.org/core-1.8.7/classes/Struct.html)`和之间的区别在于`[OpenStruct](http://www.ruby-doc.org/stdlib/libdoc/ostruct/rdoc/index.html)`，`Struct`它只响应您设置的属性，`OpenStruct`响应任何属性集 - 但那些没有设置值的将返回`Nil`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-10-10T07:42:51.033

Struct 具有您可以通过索引和名称获取其元素的功能：

```
irb(main):004:0> Person = Struct.new(:name, :age)
=> Person
irb(main):005:0> p = Person.new("fred", 26)
=> #
irb(main):006:0> p[0]
=> "fred"
irb(main):007:0> p[1]
=> 26
irb(main):008:0> p.name
=> "fred"
irb(main):009:0> p.age
=> 26
```

这有时很有用。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2018-08-02T14:43:42.370

对于那些喜欢 IPS（每秒迭代次数）指标的人来说，这里是更具可读性的基准：

## 对于小型实例：

```
require 'benchmark/ips'
require 'ostruct'

MyStruct = Struct.new(:a)
Benchmark.ips do |x|
  x.report('hash') { a = { a: 1 }; a[:a] }
  x.report('struct') { a = MyStuct.new(1); a.a }
  x.report('ostruct') { a = OpenStruct.new(a: 1); a.a }

  x.compare!
end 
```

### 结果：

```
Warming up --------------------------------------
                hash   147.162k i/100ms
              struct   171.949k i/100ms
             ostruct    21.086k i/100ms
Calculating -------------------------------------
                hash      2.608M (± 3.1%) i/s -     13.097M in   5.028022s
              struct      3.680M (± 1.8%) i/s -     18.399M in   5.001510s
             ostruct    239.108k (± 5.5%) i/s -      1.202M in   5.046817s

Comparison:
              struct:  3679772.2 i/s
                hash:  2607565.1 i/s - 1.41x  slower
             ostruct:   239108.4 i/s - 15.39x  slower 
```

* * *

## 对于庞大的列表：

```
require 'benchmark/ips'
require 'ostruct'

MyStruct = Struct.new(:a, :b, :c, :d, :e, :f, :g, :h, :i, :j, :k, :l, :m, :n, :o, :p, :q, :r, :s, :t, :u, :v, :w, :x, :y, :z)

Benchmark.ips do |x|
  x.report('hash') do
    hash = { a: 1, b: 2, c: 3, d: 4, e: 5, f: 6, g: 7, h: 8, i: 9, j: 10, k: 11, l: 12, m: 13, n: 14, o: 15, p: 16, q: 17, r: 18, s: 19, t: 20, u: 21, v: 22, w: 23, x: 24, y: 25, z: 26 }
    hash[:a]; hash[:b]; hash[:c]; hash[:d]; hash[:e]; hash[:f]; hash[:g]; hash[:h]; hash[:i]; hash[:j]; hash[:k]; hash[:l]; hash[:m]; hash[:n]; hash[:o]; hash[:p]; hash[:q]; hash[:r]; hash[:s]; hash[:t]; hash[:u]; hash[:v]; hash[:w]; hash[:x]; hash[:y]; hash[:z]
  end

  x.report('struct') do
    struct = MyStruct.new(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26)
    struct.a;struct.b;struct.c;struct.d;struct.e;struct.f;struct.g;struct.h;struct.i;struct.j;struct.k;struct.l;struct.m;struct.n;struct.o;struct.p;struct.q;struct.r;struct.s;struct.t;struct.u;struct.v;struct.w;struct.x;struct.y;struct.z
  end

  x.report('ostruct') do
    ostruct = OpenStruct.new( a: 1, b: 2, c: 3, d: 4, e: 5, f: 6, g: 7, h: 8, i: 9, j: 10, k: 11, l: 12, m: 13, n: 14, o: 15, p: 16, q: 17, r: 18, s: 19, t: 20, u: 21, v: 22, w: 23, x: 24, y: 25, z: 26)
    ostruct.a;ostruct.b;ostruct.c;ostruct.d;ostruct.e;ostruct.f;ostruct.g;ostruct.h;ostruct.i;ostruct.j;ostruct.k;ostruct.l;ostruct.m;ostruct.n;ostruct.o;ostruct.p;ostruct.q;ostruct.r;ostruct.s;ostruct.t;ostruct.u;ostruct.v;ostruct.w;ostruct.x;ostruct.y;ostruct.z;
  end

  x.compare!
end 
```

### 结果：

```
Warming up --------------------------------------
                hash    51.741k i/100ms
              struct    62.346k i/100ms
             ostruct     1.010k i/100ms
Calculating -------------------------------------
                hash    603.104k (± 3.9%) i/s -      3.053M in   5.070565s
              struct    780.005k (± 3.4%) i/s -      3.928M in   5.041571s
             ostruct     11.321k (± 3.4%) i/s -     56.560k in   5.001660s

Comparison:
              struct:   780004.8 i/s
                hash:   603103.8 i/s - 1.29x  slower
             ostruct:    11321.2 i/s - 68.90x  slower 
```

* * *

## 结论

如您所见， struct 有点快，但它需要在使用之前定义 struct 字段，所以如果性能对您来说真的很重要，请使用 struct ;)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-12-11T09:22:28.600

主要是性能。结构要快得多，数量级。与 Hash 或 OpenStruct 相比，消耗的内存更少。更多信息：[我应该什么时候使用 Struct 与 OpenStruct？](https://stackoverflow.com/questions/1177594/ruby-struct-vs-openstruct)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-05-15T20:00:40.183

关于使用 Hashes、Struct 或 OpenStruct 的速度的评论：Hash 总是会在一般使用中获胜。它是 OpenStruct 的基础，没有额外的糖衣，所以它没有那么灵活，但它是精简和平均的。

使用 Ruby 2.4.1：

```
require 'fruity'
require 'ostruct'

def _hash
  h = {}
  h['a'] = 1
  h['a']
end

def _struct
  s = Struct.new(:a)
  foo = s.new(1)
  foo.a
end

def _ostruct
  person = OpenStruct.new
  person.a = 1
  person.a
end

compare do
  a_hash { _hash }
  a_struct { _struct }
  an_ostruct { _ostruct }
end

# >> Running each test 4096 times. Test will take about 2 seconds.
# >> a_hash is faster than an_ostruct by 13x ± 1.0
# >> an_ostruct is similar to a_struct 
```

使用更简洁的哈希定义和 OpenStruct：

```
require 'fruity'
require 'ostruct'

def _hash
  h = {'a' => 1}
  h['a']
end

def _struct
  s = Struct.new(:a)
  foo = s.new(1)
  foo.a
end

def _ostruct
  person = OpenStruct.new('a' => 1)
  person.a
end

compare do
  a_hash { _hash }
  a_struct { _struct }
  an_ostruct { _ostruct }
end

# >> Running each test 4096 times. Test will take about 2 seconds.
# >> a_hash is faster than an_ostruct by 17x ± 10.0
# >> an_ostruct is similar to a_struct 
```

如果结构体，Hash 或 Struct 或 OpenStruct 定义一次然后多次使用，那么访问速度就变得更加重要，一个 Struct 开始大放异彩：

```
require 'fruity'
require 'ostruct'

HSH = {'a' => 1}
def _hash
  HSH['a']
end

STRCT = Struct.new(:a).new(1)
def _struct
  STRCT.a
end

OSTRCT = OpenStruct.new('a' => 1)
def _ostruct
  OSTRCT.a
end

puts "Ruby version: #{RUBY_VERSION}"

compare do
  a_hash { _hash }
  a_struct { _struct }
  an_ostruct { _ostruct }
end

# >> Ruby version: 2.4.1
# >> Running each test 65536 times. Test will take about 2 seconds.
# >> a_struct is faster than a_hash by 4x ± 1.0
# >> a_hash is similar to an_ostruct 
```

但请注意，Struct 的访问速度仅比 Hash 快 4 倍，而 Hash 的初始化、赋值和访问速度则快 17 倍。您必须根据特定应用程序的需要找出最适合使用的方法。因此，我倾向于将哈希用于一般用途。

此外，多年来使用 OpenStruct 的速度有了很大提高；根据我过去看到的基准并与 1.9.3-p551 相比，它曾经比 Struct 慢：

```
require 'fruity'
require 'ostruct'

def _hash
  h = {}
  h['a'] = 1
  h['a']
end

def _struct
  s = Struct.new(:a)
  foo = s.new(1)
  foo.a
end

def _ostruct
  person = OpenStruct.new
  person.a = 1
  person.a
end

puts "Ruby version: #{RUBY_VERSION}"

compare do
  a_hash { _hash }
  a_struct { _struct }
  an_ostruct { _ostruct }
end

# >> Ruby version: 1.9.3
# >> Running each test 4096 times. Test will take about 2 seconds.
# >> a_hash is faster than a_struct by 7x ± 1.0
# >> a_struct is faster than an_ostruct by 2x ± 0.1 
```

和：

```
require 'fruity'
require 'ostruct'

def _hash
  h = {'a' => 1}
  h['a']
end

def _struct
  s = Struct.new(:a)
  foo = s.new(1)
  foo.a
end

def _ostruct
  person = OpenStruct.new('a' => 1)
  person.a
end

puts "Ruby version: #{RUBY_VERSION}"

compare do
  a_hash { _hash }
  a_struct { _struct }
  an_ostruct { _ostruct }
end

# >> Ruby version: 1.9.3
# >> Running each test 4096 times. Test will take about 2 seconds.
# >> a_hash is faster than a_struct by 7x ± 1.0
# >> a_struct is faster than an_ostruct by 2x ± 1.0 
```

和：

```
require 'fruity'
require 'ostruct'

HSH = {'a' => 1}
def _hash
  HSH['a']
end

STRCT = Struct.new(:a).new(1)
def _struct
  STRCT.a
end

OSTRCT = OpenStruct.new('a' => 1)
def _ostruct
  OSTRCT.a
end

puts "Ruby version: #{RUBY_VERSION}"

compare do
  a_hash { _hash }
  a_struct { _struct }
  an_ostruct { _ostruct }
end

# >> Ruby version: 1.9.3
# >> Running each test 32768 times. Test will take about 1 second.
# >> a_struct is faster than an_ostruct by 3x ± 1.0
# >> an_ostruct is similar to a_hash 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-01-03T14:34:59.560

我已在 Ruby 3.0.0p0（2020-12-25 修订版 95aff21468）[x86_64-darwin20] 上重新运行 @mpospelov 的[基准测试。](https://stackoverflow.com/questions/810243/when-is-it-better-to-use-a-struct-rather-than-a-hash-in-ruby/51656406#51656406)

**简单的**

```
Warming up --------------------------------------
                hash     1.008M i/100ms
              struct   423.906k i/100ms
             ostruct    16.384k i/100ms
Calculating -------------------------------------
                hash      9.923M (± 1.9%) i/s -     50.412M in   5.082029s
              struct      4.327M (± 2.6%) i/s -     22.043M in   5.097358s
             ostruct    158.771k (± 6.7%) i/s -    802.816k in   5.084066s

Comparison:
                hash:  9923144.6 i/s
              struct:  4327316.1 i/s - 2.29x  (± 0.00) slower
             ostruct:   158771.4 i/s - 62.50x  (± 0.00) slower 
```

**巨大的清单**

```
Warming up --------------------------------------
                hash    71.378k i/100ms
              struct    99.245k i/100ms
             ostruct   855.000  i/100ms
Calculating -------------------------------------
                hash    712.113k (± 4.9%) i/s -      3.569M in   5.024094s
              struct      1.098M (± 2.9%) i/s -      5.558M in   5.066160s
             ostruct      8.629k (± 4.8%) i/s -     43.605k in   5.066147s

Comparison:
              struct:  1098071.6 i/s
                hash:   712112.5 i/s - 1.54x  (± 0.00) slower
             ostruct:     8628.8 i/s - 127.26x  (± 0.00) slower 
```

**结论**

*   如果性能确实很重要，请使用 struct。
*   如果动态定义字段很重要，请使用开放结构。

# linq-to-sql - 业务逻辑对象是否应该了解其 LINQ-to-SQL 数据对象？

> ID：810260
> 
> 赞同：1
> 
> 时间：2009-05-01T05:06:21.297
> 
> 标签：linq-to-sql, orm, separation-of-concerns, decoupling

我看过几个类似的问题，但没有看到任何直接适用于我的问题，所以如果这是重复的，请原谅我。

为了分离关注点，我试图以某种方式将我的业务对象与逻辑映射到 .dbml 文件中的 LINQ to SQL 数据对象（这对这个 btw 来说是相当新的）。不过看起来我的业务对象需要了解相应的 LINQ2SQL 对象。我阅读[了这篇](http://www.sidarok.com/web/blog/content/2008/10/14/achieving-poco-s-in-linq-to-sql.html)关于尝试通过使用 xml 映射文件来使用 POCO 的文章，这似乎与我想要的相似，只是我没有从表到类的一对一映射，因为有很多我需要为其创建一个额外的表的多对多关系。

我可以很好地将数据访问封装在我的业务逻辑中，这样使用我的业务对象的代码不需要知道任何关于数据库的信息，这很好，但是业务层仍然与数据访问层紧密耦合，这样如果不更改我的业务层对象或为不同的数据提供者创建新的对象（实现相同的接口），我就无法更换 DAL。

我怎样才能解耦这些层？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-11T15:59:46.607

不确定您是否以某种方式与 LINQ to SQL 相关联，但您尝试完成的几乎是 NHibernate 中的默认设置。我建议看一下 NHibernate，看看它是否比使用 LINQ to SQL 更容易切换。

我发现与工具作斗争几乎总是一个坏主意。

# jquery - 使用 MVC for ddl/html.dropdownlist 将 jquery 与 AJAX 集成

> ID：810265
> 
> 赞同：0
> 
> 时间：2009-05-01T05:09:44.143
> 
> 标签：jquery, ajax, asp.net-mvc, linq-to-sql, drop-down-menu

情况：相关页面上的用户从下拉列表中选择一个类别，然后在旁边的第二个下拉列表中动态填充该类别的所有用户。

正在使用 LinqtoSQL 检索所有数据，我想知道这是否可以做到 a) 在强类型视图中使用 html.dropdownlist？b) 使用 jquery 来触发所选索引更改的 ajax 请求，而不是“填充”按钮触发器？

抱歉，我没有代码，因为我正在尝试的东西根本不起作用。我在如何从概念上和编程上做到这一点时遇到了麻烦！

将非常感谢任何指向示例等的链接！

提前致谢！

编辑：

这就是我想要实现的。Dirst ViewPage：

```
 <script type="text/javascript">
        $(document).ready
            function TypeSearch() {
                $.getJSON("/Home/Type", null, function(data) {
                    //dont know what to do here

                });

            }
        </script>

        <p>
              <label for="userType">userType:</label>
            <%= Html.DropDownList("userType") %>
            <%= Html.ValidationMessage("userType", "*") %>
          <input  type="submit" runat="server" onclick="TypeSearch()" />

            <label for="accountNumber">accountNumber:</label>
            <%= Html.DropDownList("accountNumber") %>
            <%= Html.ValidationMessage("accountNumber", "*") %>
        </p> 
```

然后家庭控制器动作：

```
 public ActionResult Type()
    {
        string accountType = dropdownvalue;
        List<Account> accounts = userRep.GetAccountsByType(accountType).ToList();

        return Json(accounts);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T06:39:37.297

只是在这里大声编码，但您可能想要执行以下操作

```
public void Type(string accountType)
{
    List<Account> accounts = userRep.GetAccountsByType(accountType).ToList();

    Json(accounts).ExecuteResults(this.ControllerContext);
} 
```

使用以下 jQuery 脚本

```
$(document).ready(function() {
    $("#dropdownid").change(function() {
        $.getJSON(
            "/Home/Type/" + $("#dropdownid :selected").val(),
            "[]",
            function(data) {
                $("#seconddropdownid").empty();
                $.each(data, function() {
                    $("#seconddropdownid").append("<option>" + this.Property + "</option>");
                });
            }
        );
    });
}); 
```

这完全不是我的想法，可能是一些语法错误，但是，你可以得到 jist。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T06:50:19.220

我会使用 jquery 和选择[框](http://www.texotela.co.uk/code/jquery/select/)插件。它有一个很好的界面，可以通过返回 json 的 ajax 调用来进行级联下拉菜单。代码看起来像：

```
$(document).ready(function() {
    function TypeSearch() {
        // remove any existing options
        $("#idOfSelect").removeOption(/./);
        var opts = { accountType : $("#idOfParent").val() };
        $("#idOfSelect").ajaxAddOption("/Home/Type", opts, false);
    }
}); 
```

# ruby-on-rails - 使用 will_paginate 对博客文章的随机列表进行分页

> ID：810267
> 
> 赞同：5
> 
> 时间：2009-05-01T05:10:20.397
> 
> 标签：ruby-on-rails, random, will-paginate

我想让用户能够以随机顺序翻阅我的博客文章。

我不能像这样实现它：

```
@posts = Post.paginate :page => params[:page], :order => 'RANDOM()' 
```

由于`:order`每个查询都会调用该参数，因此我冒着重复博客文章的风险。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-06T02:13:28.580

RAND 在 MySQL 中接受种子：

```
RAND(N) 
```

来自[MySQL 文档](http://dev.mysql.com/doc/refman/5.0/en/mathematical-functions.html#function_rand)：

> 兰德（），兰德（N）
> 
> 返回 0 <= v < 1.0 范围内的随机浮点值 v。如果指定了常量整数参数 N，则将其用作种子值，从而生成可重复的列值序列。在下面的示例中，请注意 RAND(3) 产生的值序列在它出现的两个地方都是相同的。

其他数据库应该具有类似的功能。

如果您每次调用 RAND 时都使用**相同的种子，则请求之间的顺序将是一致的，您可以相应地进行分页。**

然后，您可以将种子存储在用户的会话中 - 这样每个用户都会看到一组他们独有的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T07:37:28.100

为了避免每个页面（从新请求生成）可能有重复的帖子，您需要将帖子的顺序存储在某处以便在多个请求中检索。

如果您希望每个用户都有一个唯一的随机顺序，则将该顺序保存在 ID 的会话数组中。

如果您不介意所有用户都具有相同的随机顺序，那么在帖子表中有一个位置列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T15:41:12.737

您可以在填充@posts 的原始查询上使用 :order => RANDOM() ，然后在分页时不要指定顺序。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-05-01T15:52:26.173

在封装随机行为的 Post 模型上创建一个[命名范围：](http://railscasts.com/episodes/108-named-scope)

```
class Post < ActiveRecord::Base
  named_scope :random, :order => 'RANDOM()'
  .
  .
  .
end 
```

然后您的`PostsController`代码变为：

```
@posts = Post.random.paginate :page => params[:page] 
```

# user-interface - 对于需要即时更改语言的用户来说，最好的 UI 控件是什么？

> ID：810270
> 
> 赞同：2
> 
> 时间：2009-05-01T05:10:57.040
> 
> 标签：user-interface, localization, internationalization

显然是一个主观问题，但我认为这个网站已经建立了一个跨国受众，所以希望会有一些好的见解。

我正在考虑使用的选项是带有标志图像的组合框，以指示您要查看应用程序的语言。

优点

*   每个人都能识别图像，因此您不必担心有人无法选择语言，因为他们不了解框的用途。
*   组合框使用有限的屏幕空间支持许多（尽可能多地适合页面或更多，如果具有滚动能力）。

缺点

*   对于使用该应用程序的每个人来说，可能并不明显这是选择语言的方式。
*   选择代表该语言的国旗可能会冒犯未选择国旗的另一个国家的说该语言的人（您使用哪个国家的国旗来表示英语、西班牙语、葡萄牙语等）

另一种选择是使用组合框，其中每种语言都以其自己的语言表示，因此该语言的使用者将在下拉菜单中识别他们的语言。

我正在为一个桌面应用程序写这篇文章，我很好奇大多数人“得到”的 Web 或桌面世界是否出现了共识标准。

对我来说正确的答案是大多数用户立即了解预期目的以及如何使用该控件的控件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T09:47:25.807

我的投票：带有语言名称列表的组合框，然后是括号中的方言。

例如，要列出葡萄牙语：

*   英语（英国）
*   英语（美国）
*   葡萄牙语（巴西）
*   葡萄牙语（葡萄牙）

语言名称排在第一位，按字母顺序排列并以母语书写，这样最容易找到。第二个方言的名称，以便所有方言按字母顺序排列在一起，以便于查看，例如，是否有英国和美国英语，或者只有其中一种。小标志有时会有所帮助，但有时只会增加混乱。

另一件事：让用户在安装时选择语言。这一定是他看到的第一件事。Nullsoft 安装程序可以很好地做到这一点。期望用户使用外语导航工具->选项->配置->国际->语言等菜单是不可接受的！

永远不要假设您可以从区域设置中收集语言！即使用户不会说当地语言，Windows 也经常配置为当地货币。

感谢您认识到每种语言都应该用自己的语言编写！我经常看到一个语言列表，都是用某种外语写的，我不知道该选择哪一种。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T05:18:14.480

> 另一种选择是使用组合框，其中每种语言都以其自己的语言表示，因此该语言的使用者将在下拉菜单中识别他们的语言。

这是一种相当普遍的做法，而且很有意义。

在旗帜旁边，放上“语言”，不要本地化。几乎每个熟悉在软件中更改语言的人都知道这意味着什么，并且在它旁边加上标志将得到其余的 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T20:00:28.807

这不是一个容易的问题。旗帜的想法运作良好，但我需要训练自己寻找英国国旗。根据应用程序，我可能想要星条旗，因为英式英语和美式英语之间存在差异。如果您尝试将过多的含义重载到标志上，这可能会变得很棘手。例如，瑞士国旗是什么语言。或者，如果我只会说西班牙语，但希望应用程序使用美国日期和时间格式怎么办。更别想如果你本地化成中文会发生什么。（例如：你有没有台湾国旗？）

我更喜欢写出来的语言。它为您提供了很大的灵活性来准确指定语言的含义。此外，有时您还可以享受一些乐趣。Facebook 有一个海盗英语选项，很适合逗笑。谷歌有更多有趣的界面语言选择。每个需要 Español 选项的人都会知道它的含义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T10:53:15.437

我个人更喜欢能够最好地检测到我的语言的智能应用程序。当然，与菜单项（例如 Preferences/Language/）或工具栏按钮（图像是世界图标）紧密相关的语言子菜单必须在某个地方让用户覆盖自动选择。但在大多数情况下，他们不应该考虑这个问题。

重要提示：子菜单（或组合框等）应包含本地语言名称。这样，用户总能找到*他们的*语言。

标志不是一个好主意 IMO：非常小的标志图标不是很独特。此外，查找语言名称比查找标志更容易。国旗与国家有关，这与语言不太一样：您的一些英语用户可能不太喜欢美国国旗。

根据您使用的技术，您可能会发现我的 codeproject 文章很有趣：

[http://www.codeproject.com/KB/locale/LanguageMenu.aspx](http://www.codeproject.com/KB/locale/LanguageMenu.aspx)

# windows - 如何获取系统盘符？

> ID：810273
> 
> 赞同：17
> 
> 时间：2009-05-01T05:15:00.573
> 
> 标签：windows, winapi, hard-drive

如何在 Windows 操作系统上找到主硬盘的驱动程序盘符？

即带`Program Files`,`System32`等的驱动器。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-01T05:20:52.900

有一个名为的环境变量`SystemDrive`被设置为系统驱动器（令人惊讶的是）。`getenv()`电话是您可以接听电话的方式。

```
char *sysDrive = getenv ("SystemDrive");
if (sysDrive == NULL) {
    // vote me down.
} else {
    // vote me up and use it.
} 
```

如果您不能依赖系统驱动器上存在的特定目录，[此页面列出了一系列可用的环境变量。](http://kennethhunt.com/archives/000933.html)

或者，使用 Windows API 调用[SHGetSpecialFolderPath()](http://msdn.microsoft.com/en-us/library/bb762204(VS.85).aspx)并传入正确的[CSIDL](http://msdn.microsoft.com/en-us/library/bb762494(VS.85).aspx)。那么你不应该依赖环境变量。

尽管请注意那些页面上这已被 Vista 中的其他功能取代（它应该仍然有效，因为此功能成为新功能的包装器）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T05:20:52.790

API 调用[GetWindowsDirectory](http://www.codeguru.com/forum/showthread.php?t=52423)可能会有所帮助。您可以使用 API 进一步解析此信息以解析驱动器号信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T05:28:21.900

系统驱动

程序文件

系统根

风向

不要假设 Program Files 与 Windows 位于同一驱动器上。通常是这样。*通常。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-24T11:46:20.097

请参阅MSDN 上的[获取系统信息](https://msdn.microsoft.com/en-us/library/ms724426.aspx)。它在很大程度上解释了如何深入获取系统信息。信息量很大。

# mysql - 如何创建一个页面来编辑数据库

> ID：810283
> 
> 赞同：0
> 
> 时间：2009-05-01T05:22:46.357
> 
> 标签：mysql, database, web-applications

我正在尝试建立一个为用户提供登录的网站。一旦这些用户登录，他们将能够执行可能会查询数据库的功能。在某些时候，我需要在数据库中添加/修改/删除内容，我想知道如何在网站上创建一个我只能访问的页面。理想情况下，我不希望我的网站上有一个页面允许我编辑数据库中的信息，因为它可能容易受到攻击。那么来自 stackoverflow 的专家将如何创建一个页面来编辑他们数据库中的信息呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T05:34:23.100

获取具有登录功能的数据库管理软件，如[phpMyAdmin](http://www.phpmyadmin.net/home_page/index.php) （或利用 HTTP 服务器的身份验证）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T05:26:17.427

好吧，创建一个普通页面 - 但设置访问限制，以便您只有在登录帐户是管理员时才允许使用它。（您定义管理员角色，并确保您是其中之一。）

您可能还想确保该页面仅提供给一些已知的 IP 地址 - 尽管当您突然想从其他地方使用它时，这会变得很痛苦......

# java - 将bat文件放入jar文件中

> ID：810284
> 
> 赞同：1
> 
> 时间：2009-05-01T05:25:10.080
> 
> 标签：java, eclipse, batch-file

我有一个使用 bat 文件执行命令的 java 类。但是我在 Eclipse IDE 中开发了它。它在那里工作得很好。但是当我将它导出到一个 jar 文件中时，它找不到包含的 bat 文件。（给我一个 IOException）

eclipse中的文件结构如下：

```
Project1
---->src
------>com.myproj
-------->BatFileRead.java
----md.bat
----ul.bat 
```

md.bat 和 ul.bat 与 src 目录同级。震动后 src 文件夹消失。

有人可以帮我解决这个问题。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T05:27:09.500

为了执行该命令，您必须在之后提取 bat 文件。您无法运行 jar 文件中的可执行文件。基本上，您需要将 jar 文件中的批处理文件条目作为输入流打开，并将数据复制到`FileOutputStream`磁盘上。除非它是文件系统上正确的独立文件，否则您将无法执行它。

如果您已经在尝试提取它，那么您可能正在使用`getResource`或`getResourceAsStream`稍微不正确。这很容易做到，因为这取决于你是打电话`ClassLoader.getResourceAsStream`还是`Class.getResourceAsStream`. 第一个只使用绝对路径（隐式），第二个可以使用绝对或相对路径。例如，在您的情况下，您想要：

```
BatFileRead.class.getResourceAsStream("/md.bat") 
```

或者

```
BatFileRead.class.getClassLoader().getResourceAsStream("md.bat") 
```

您是否检查过 bat 文件肯定会在 jar 文件中结束？只需列出内容

```
jar tvf file.jar 
```

看看里面有什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T06:43:06.243

好吧，这可能非常危险。与 BAT 打交道时一定要戴上手套。他们咬人，非常痛苦。还可以尝试使用具有足够大开口的罐子，尽管蝙蝠几乎可以穿过任何孔。

祝你好运，不要在家里尝试这个。这是由专业人员完成的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T05:34:40.760

尝试复制`file.jar`到`file.zip`并打开`file.zip`（例如，只需双击，或使用例如 7-Zip）。你能在`.bat`里面找到你的文件吗？如果该`.bat`文件不存在，您必须将该`.bat`文件添加到您的 Eclipse 项目中，然后在 Eclipse 中重新构建。如果`.bat`文件在那里，但您仍然可以`IOException`从您的应用程序中打开它`.java`，那么请发布触发 的代码片段`IOException`，并提供完整`file.zip`的列表（通过提取`file.zip`到并在命令行中`C:\testdir`运行来获取列表）。`dir /s C:\testdir`

请注意，Jon Skeet 是对的，虽然可以使用和打开`.jar`文件中的任何文件（请参阅[教程](http://mindprod.com/jgloss/getresourceasstream.html)或在[Java API 文档](http://java.sun.com/javase/6/docs/api/)中找到它们），但为了执行其中的文件，您必须提取先存档。`InputStream``java.lang.Class.getResourceAsStream``java.lang.ClassLoader.getResourceAsStream``.bat``.jar`

# language-agnostic - 一个方法究竟什么时候有副作用？

> ID：810289
> 
> 赞同：7
> 
> 时间：2009-05-01T05:27:23.867
> 
> 标签：language-agnostic, oop, definition, side-effects

正如我一直理解的那样，对程序状态（或与 IO 相关的任何事情）的任何更改都是副作用。更改是发生在全局变量中还是发生在调用该方法的对象的私有字段中都没有关系。因此，所有不返回任何内容的方法要么什么都不做，要么有副作用。
我的困惑来自我们大学的一位讲师（他仍然是学生，因此还不是无所不知的；））告诉我二传手没有副作用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T05:32:44.900

你的导师搞错了。对于没有将整篇文章粘贴到此处的 SO 编辑表示歉意，这就是 Wikipedia 必须说的：

[http://en.wikipedia.org/wiki/Side_effect_(computer_science)](http://en.wikipedia.org/wiki/Side_effect_%28computer_science%29)

金钱报价#1：

> 在计算机科学中，如果一个函数或表达式除了产生一个值之外，它还修改了某些状态或与调用函数或外部世界有可观察的交互，则称它具有副作用。

金钱报价#2：

> 在存在副作用的情况下，程序的行为取决于过去的历史；也就是说，评估的顺序很重要。

非 NOP 设置器始终满足该标准。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T05:30:57.070

getter 和 setter 只是 get_ 和 set_ 方法的语法糖。它们*绝对*会产生副作用（尽管当调用者想要增加一个计数器或其他东西时开始调整大量字段可能是个坏主意）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-11T21:53:59.497

首先：**我知道与语言无关的标签！**“runako”非常正确地回答了这个问题。但通常你想将你的知识应用到现实世界中，所以我想我也很乐意提供一个以更务实的方式解决这个问题的答案。

在处理像 c++、c# 或 java 这样的现实世界语言时，即使是 nop 函数也会有实际的副作用，这可能会导致代码被执行！

想想静态构造函数。尽管规范并不总是指定为类运行静态构造函数的时间，但大多数时候它将是第一次访问该类的方法或成员的时间点。

C# 中的示例：

```
class NotSoObvious
{
    static NotSoObvious()
    {
        CauseSomeSideEffects();
    }

    // calling this can cause the constructor to run first!
    public static void DoNothing()
    {
        return;
    }
} 
```

更重要的是，即使是根本不被调用的方法也会导致副作用！想想反射（程序查询有关其自身结构的信息的能力）。当一个方法存在但没有被调用时，它仍然可以通过反射检测到。

没有调用的方法肯定会对输出内部方法数量的程序产生副作用！

这一切都归结为：如果您想了解一种方法的实际副作用，您首先必须确定您甚至认为是什么“副作用”。

# database - 如果没有 Google App Engine 上的联接，您的数据是否必须存在于一张大表中？

> ID：810303
> 
> 赞同：12
> 
> 时间：2009-05-01T05:34:11.353
> 
> 标签：database, database-design, google-app-engine, join, datatable

由于 Google App Engine 不允许加入，这是否意味着我必须获取我的网络应用程序中的所有表并找出将它们组合成一个大表的方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-01T09:33:27.457

仅仅因为您没有由 DBMS 实现的连接并不意味着您不能拥有多个表。在 App Engine 中，这些称为“实体类型”，您可以拥有任意数量的实体类型。

通常，您需要对数据进行非规范化以避免频繁连接的需要。在它们不可避免的少数情况下，您可以使用其他技术，例如在用户代码中进行连接。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T05:46:11.090

将它组合到一个大表中始终是一种选择，但它在大多数情况下会导致不必要的大表和冗余表，因此它会使您的应用程序变得缓慢且难以维护。

您还可以通过遍历查询结果并为第一个查询找到的每个结果运行第二个查询来模拟连接。如果您有 SQL 查询

```
SELECT a.x FROM b INNER JOIN a ON a.y=b.y; 
```

你可以用这样的东西来模拟它：

```
for b in db.GqlQuery("SELECT * FROM b"):
  for a in db.GqlQuery("SELECT * FROM a WHERE y=:1", b.y):
    print a.x 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-12-13T10:22:41.327

如果您正在寻找设计数据表的方法。我建议你在开始工作之前做一些研究。Google App Engine 有一些非常神奇的属性，例如：

*   自合并
*   多值列表属性

这对你的设计很有帮助。我在[这里分享了我的经验](http://akhilspassion.blogspot.in/2012/12/database-design-for-google-app-engine.html)。

要了解可扩展性，在 Udacity 中有一个关于该主题的独家[免费课程。](https://www.udacity.com/course/cs253)它是由 reddit.com 的创始人教授的，他清楚地解释了 reddit 中发生的整个扩展问题，reddit 是访问量最多的网站之一。他在 gae 中展示了整个课程演示实现（这对我来说是一个大奖！）。他们提供完整的课程视频[，可以在这里免费下载](https://www.udacity.com/wiki/cs253)。在获得这些资源之前，我一直在努力使用应用引擎。所以我认为分享这个可能会帮助其他涉足的人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T07:21:24.780

从关系数据库切换到 App Engine 数据存储区需要开发人员在对其数据建模时进行范式转换。看看[这里](http://research.google.com/archive/bigtable.html)以获得更好的主意。这将需要您更多地考虑如何将您的问题适应数据存储所施加的约束，但如果可以，那么您可以保证它将快速运行并扩展。

# php - 独立的 php 应用程序

> ID：810307
> 
> 赞同：5
> 
> 时间：2009-05-01T05:35:53.177
> 
> 标签：php

构建与某种数据库一起使用而无需用户安装数据库服务器的**非 Web 浏览器独立 php 应用程序的最佳方法是什么。**还是我要求太多？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-01T06:49:10.830

如果您的目标是 Windows，请尝试[WinBinder](http://winbinder.org)。它允许您使用 PHP 开发本机 Windows 应用程序。

它还支持 SQLite，因此您不需要数据库服务器。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T05:37:38.617

在您的应用程序中嵌入 SQLite 数据库，然后配置 PHP 以与 SQLite 数据库通信：

[http://us.php.net/sqlite](http://us.php.net/sqlite)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T23:55:17.073

看看 php 编译器，你最终会得到一个供人们运行的二进制文件。它可以是桌面 GUI 应用程序，也可以是“盒子中的 Web 服务器”类型的东西。

*   [编译](http://www.bambalam.se/bamcompile/)
*   [phc](http://www.phpcompiler.org/)
*   [路边](http://www.roadsend.com/home/index.php?SMC=1&pageID=press)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T23:34:43.550

我建议你试试[miniPHP](http://exvision.net/)。它基本上是一个围绕[Winbinder](http://winbinder.org/)的 IDE ；它使您可以专注于编写 PHP，同时它会处理诸如编译应用程序之类的细节。您可以创建 GUI 或命令行应用程序，它适用于 SQLite 和 MySQL。它也有预览模式和一些调试功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-02T00:13:24.830

这里有一个想法：信息可以存储在 XML 中，因此可以避免使用数据库。当然，这只适用于某些目的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-26T13:12:24.757

正如 Oakcool 所提到的，请查看 PHP-GTK。它是一个与 C/C++ 的 MFC 类似线路的 GUI 开发工具。

PHP-GTK 连同 SQLite 或上面提到的其他文本文件应该可以解决问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T06:39:50.010

看看这3个链接

PHP GTK `enter code here` [http://gtk.php.net/](http://gtk.php.net/)

FLEX [http://www.adobe.com/products/flex/?promoid=BPDEQ](http://www.adobe.com/products/flex/?promoid=BPDEQ)

空气 [http://www.adobe.com/products/air/](http://www.adobe.com/products/air/)

我认为任何这些都会对您有所帮助，请检查一下。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-01T06:51:13.557

我没有任何经验，但有一个便携式版本的[XAMPP](http://portableapps.com/apps/development/xampp)。

您不一定必须使用 Apache 部分。该应用程序可以只从命令行运行，具体取决于您要执行的操作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-04-18T06:32:31.090

我不知道如何使用 PHP 作为独立的编程语言，我的意思是不使用 Web 服务器和浏览器。我可以回答你的其他问题。

**SQLite 是一个数据库系统**（更具体地说：一个库！）它为您提供**SQL 数据库的所有基本功能，而无需安装任何特定的数据库服务器**。但是您确实需要复制一个小的 .dll 文件（sqlite3.dll i假设）进入您的工作目录。该文件只是一个非常小的文件，但您可以获得数据库的所有基本功能，例如 INSERT DELETE UPDATE SELECT 等。它是一个很棒的轻量级数据库..我是认真的..真的轻的。

PHP 还内置了对 SQLite 数据库的支持。所以兼容性永远不会成为问题

看看他们的主页[https://sqlite.org/](https://sqlite.org/)

他们是这样描述自己的：**SQLite 是一个软件库，它实现了一个自包含、无服务器、零配置、事务性 SQL 数据库引擎。SQLite 是世界上部署最广泛的 SQL 数据库引擎。**

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-06-17T11:45:21.733

结帐[phpdesktop](https://code.google.com/p/phpdesktop/)为您提供：

*   基于 Chromium 框架的嵌入式网页浏览器让您受益于 HTML5、javascript 和 jQuery。
*   带有 mongoose 的嵌入式 Web 服务器让您可以使用 php。
*   带有 SQLite 的嵌入式数据库引擎。

# python - 使用 SelectDateWidget 的 Django 表单字段

> ID：810308
> 
> 赞同：6
> 
> 时间：2009-05-01T05:36:12.050
> 
> 标签：python, django, forms, widget, admin

我已经从 Django 安装了最新的 SVN 分支，其中包括新的表单。我正在尝试使用 django.forms.extras.widgets 中的 SelectDateWidget，但该字段显示为普通的 DateInput 小部件。

这是我的应用程序中的 forms.py：

```
from django import forms
from jacob_forms.models import Client

class ClientForm(forms.ModelForm):
    DOB = forms.DateField(widget=forms.extras.widgets.SelectDateWidget)

    class Meta:
            model = Client 
```

我究竟做错了什么？检查 forms/extras/widgets.py 我看到 SelectDateWidget 类存在。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-01T18:12:11.733

真正的问题是不能以这种方式引用 SelectDateWidget。更改代码以不同方式引用它解决了我的问题：

```
from django.forms import extras
...
    DOB = forms.DateField(widget=extras.SelectDateWidget) 
```

这似乎是您无法从导入的包中引用 package.package.Class 的限制。该解决方案导入了 extras，因此引用只是 package.Class。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T05:45:29.580

来自票证：此处缺少 SelectDateWidget 的文档： [票证 #7437](http://code.djangoproject.com/attachment/ticket/7437/SelectDateWidget-doc.diff)

看起来您需要像这样使用它：

```
widget=forms.extras.widgets.SelectDateWidget() 
```

注意括号是例子。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-05-01T07:40:21.993

为什么不使用`forms.SelectDateWidget`. 只需将其用作参考。

```
import datetime

from django import forms

class HistDateForm(forms.Form):
    cur_year = datetime.datetime.today().year
    year_range = tuple([i for i in range(cur_year - 2, cur_year + 2)])
    hist_date = forms.DateField(initial=datetime.date.today() - datetime.timedelta(days=7),widget=forms.SelectDateWidget(years=year_range)) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-04T15:39:56.730

这是form.py

```
from django import forms
from django.forms import extras

DOY = ('1980', '1981', '1982', '1983', '1984', '1985', '1986', '1987',
       '1988', '1989', '1990', '1991', '1992', '1993', '1994', '1995',
       '1996', '1997', '1998', '1999', '2000', '2001', '2002', '2003',
       '2004', '2005', '2006', '2007', '2008', '2009', '2010', '2011',
       '2012', '2013', '2014', '2015')

DOB = forms.DateField(widget=extras.SelectDateWidget(years = DOY)) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T12:40:00.333

你写的代码对我来说很好。在这种情况下，检查模型中的字段名称和表单之间的不匹配（`DOB`与`dob`容易打错字），并且您已经在视图中实例化了正确的表单，并将其传递给模板。

# javascript - JSLint 说“var statements 太多”背后的原因是什么

> ID：810313
> 
> 赞同：63
> 
> 时间：2009-05-01T05:42:24.547
> 
> 标签：javascript, refactoring, jslint

JSLint（打开 onevar 标志）正在标记我拥有的一些 JavaScript 代码：

```
第 5 行字符 15 处的问题：var 语句太多。
```

我很高兴修复这些错误，但我想知道，我这样做是为了提高性能还是因为这只是一种不好的做法，并且更有可能在我的 javascript 代码中引入错误。onevar 标志背后的原因是什么？

我确实查看了[var 关键字](http://www.jslint.com/lint.html#var)的 JSLint 文档，但它没有具体讨论为什么同一函数中的多个 var 语句不好。

这是一个示例的尝试。解释代码将如何受益于只有 1 个 var 语句：

```
function Test(arg) {
   var x = arg + 1,
       y = cache.GetItem('xyz');
   if (y !== null) {
      // This is what would cause the warning in JSLint
      var request = ajaxPost(/* Parameters here */);

   }
} 
```

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2009-05-01T06:03:51.640

Javascript 没有块作用域。在其他带有它的语言中（如c），如果你在if语句中声明一个变量，你不能在它之外访问它，但在javascript中你可以。JSLint 的作者认为这是一种不好的做法，因为您（或其他读者）可能会感到困惑并认为您无法再访问该变量，但实际上您可以。因此，您应该在函数顶部声明所有变量。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-11-19T15:35:51.177

官方原因[在这里](http://www.jslint.com/lint.html#scope)，由 Douglas Crockford 撰写。

去引用：

> 在许多语言中，块引入了范围。块中引入的变量在块外是不可见的。
> 
> 在 JavaScript 中，块不引入范围。只有功能范围。在函数的任何地方引入的变量在函数的任何地方都是可见的。JavaScript 的块使有经验的程序员感到困惑并导致错误，因为熟悉的语法会做出错误的承诺。
> 
> JSLint 需要带有函数、if、switch、while、for、do 和 try 语句的块，而其他任何地方都没有。
> 
> 在具有块范围的语言中，通常建议在第一次使用的地方声明变量。但是因为 JavaScript 没有块作用域，所以在函数顶部声明函数的所有变量更为明智。建议每个函数使用单个 var 语句。这可以使用 vars 选项来拒绝。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-11-05T15:41:17.310

只需像这样在一个地方声明你的变量：

```
var request,x,y; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-01T05:50:14.030

如果每个函数只允许一个 var 语句，则 "onevar" 选项设置为 true。

```
if (funct['(onevar)'] && option.onevar) {
    warning("Too many var statements.");
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-13T23:08:51.463

推理已经描述。

建议使用这种形式：

```
var myVar1 = document.getElementById("myDiv1"),
  myVar2 = document.getElementById("myDiv2"); 
```

或这个：

```
var myVar1, myVar2;
myVar1 = document.getElementById("myDiv1");
myVar2 = document.getElementById("myDiv2"); 
```

但这看起来不太好，特别是如果您想记录变量。

所以你可以暂时禁用这个警告：

```
 /*jslint vars: true*/
  /**
   * @returns {HTMLDivElement}
   */
  var myVar1 = document.getElementById("myDiv1");
  /**
   * @returns {HTMLDivElement}
   */
  var myVar2 = document.getElementById("myDiv2");
  /*jslint vars: false*/ 
```

警告：确保这是在函数的顶部完成的。

我认为这样做是因为 jslint 无法可靠地确定 vars 是否在函数顶部声明。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-01T05:48:34.003

这里只是一个猜测，但可能是[功能分解](https://stackoverflow.com/questions/790703/tricks-to-refactor-a-piece-of-code-with-many-branches-if-then-else/790726#790726)的时候了。函数应该做*一*件事并做好。

太多的 vars 暗示了一个试图做太多事情的函数。或者您应该使用数组的情况。

* * *

## 回答 #7

> 赞同：-6
> 
> 时间：2009-09-20T22:26:34.087

这个想法是你应该使用一个对象而不是单个变量。所以你在哪里得到：

```
var x = arg + 1,
    y = cache.GetItem('xyz'); 
```

将其更改为：

```
var dimensions = {};
dimensions.x = arg + 1;
dimensons.y = cache.GetItem('xyz');
dimensions.request = ... 
```

然后，您可以通过对象访问这些变量，每个函数都有一个对象来包含该函数变量会更简洁。那么你将不会收到警告。

# regex - 使用 Perl，如何通过将参数传递给子例程来构建动态正则表达式？

> ID：810318
> 
> 赞同：7
> 
> 时间：2009-05-01T05:46:33.710
> 
> 标签：regex, perl, algorithm

我想用动态创建的 regxp 创建子例程。这是我到目前为止所拥有的：

```
#!/usr/bin/perl

use strict;

my $var = 1234567890;

foreach (1 .. 9){
    &theSub($_);
}

sub theSub {
    my $int = @_;
    my $var2 = $var =~ m/(??{$int})/;
    print "$var2\n";
} 
```

看起来它会起作用，但似乎一旦第一次对正则表达式中的 $int 进行评估，它就会永远存在。

有没有办法做类似的事情，但是每次调用 sub 时让正则表达式获取新参数？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-01T05:52:12.043

修复代码的最简单方法是在 周围添加括号`my`，然后删除`??{`。这是固定程序：

```
#!/usr/bin/perl
use strict;
my $var = 1234567890;
foreach (1 .. 9){
    theSub($_);
}
sub theSub {
    my($int) = @_;
    my($var2) = $var =~ m/($int)/;
    print "$var2\n";
} 
```

您的代码中有问题的行之一是`my $int = @_`，它等效于`my $int = 1`，因为它`@_`在标量上下文中进行评估，产生`@_`. 要获取 sub 的第一个参数，请使用，它在列表上下文`my($int) = @_;`中进行评估，或者使用 获取第一个元素，或者使用 fetch+remove 第一个元素`@_``my $int = $_[0];``my $int = shift;`

该行中有一个类似的问题`my $var2 =`，您还需要那里的括号来评估列表上下文中的正则表达式匹配，产生列表`($1, $2, ...)`并分配`$var2 = $1`。

您尝试使用的构造`(??{...})`与您想要的效果相反：（在做其他事情时）它在第一次用于匹配时编译了您的正则表达式。对于包含`$`or`@`但不包含`??{...}`的正则表达式，Perl 会为每个匹配项自动重新编译正则表达式，*除非*您指定`o`标志（例如`m/$int/o`）。

构造的`(??{...})`意思是：使用 Perl 代码`...`生成一个正则表达式，并在此处插入该正则表达式。要获取更多信息，请`??{`在[http://perldoc.perl.org/perlre.html](http://perldoc.perl.org/perlre.html)上搜索。它在您的示例中不起作用的原因是您需要额外的括号层来捕获`$1`，但即使使用`my ($var2) = $var =~ m/((??{$int}))/`它也不会起作用，因为`??{`它有一个未记录的属性：它首先强制编译其参数正则表达式用于匹配的时间，所以`my ($var2) = $var =~ m/((??{$int + 5}))/`总是match `6`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T06:00:49.183

```
my $int = @_; 
```

这将为您提供参数计数，在您的情况下始终为“1”。

我想你想要

```
my $int = shift; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-02T01:33:20.660

要将正则表达式动态传递给函数，而不是在函数中动态构建，请使用 qr//。

```
#!/usr/bin/perl

use strict;

my $var = 1234567890;

foreach (1 .. 9){
    &theSub(qr/$int/);
}

sub theSub {
    my($regexp) = @_;
    my($var2) = ($var =~ $regexp);
    print "$var2\n";
} 
```

qr// 接受与 m// 相同的尾随参数：i、m、s 和 x

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T07:07:34.420

我的 $int 是标量上下文，他有 ($int) 用于列表上下文并将 $_[0] 放入 $int。以下仅将 10 个放入 $int，其余 11 到 99 个丢失。

我的 ($int)=(10..99); 打印 $int; 10

# apache - HEAD GET 解码请求

> ID：810339
> 
> 赞同：0
> 
> 时间：2009-05-01T05:55:53.173
> 
> 标签：apache, servlets, jboss

我们在 JBoss 上运行服务。有时我们会收到参数完全解码的请求。以下是 apache 访问日志条目。查看以下 url 中的 redirect_url 参数。要使此类 url 起作用，需要对参数进行编码。我们发布的网址是经过编码的。要么有人在它到达我们之前明确解码，一些有问题的浏览器插件等，要么我们的服务器正在做我们不理解的事情。

```
78.150.249.12 - - [30/Apr/2009:19:44:58 +0000] "HEAD /r/?client_id=2&redirect_url=http://www.amazon.co.uk/gp/search?ie=UTF8&keywords=William+Kentridge&search-alias=stripbooks&tag=inhouse3408608&token=3to08p0nn54916kfc000db5gmf HTTP/1.1" 400 - "-" "User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)"

78.150.249.12 - - [30/Apr/2009:19:44:58 +0000] "GET /r/?client_id=2&redirect_url=http://www.amazon.co.uk/gp/search?ie=UTF8&keywords=William+Kentridge&search-alias=stripbooks&tag=inhouse3408608&token=3to08p0nn54916kfc000db5gmf HTTP/1.1" 400 965 "-" "User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T21:45:16.527

HEAD/GET 模式看起来像某种 Web 加速器插件/代理 - HEAD-ing 链接以查看它是否存在/被修改然后获取它。假设您的 JBoss 前面没有其他 Web 服务器，那么这不太可能是您的错。

此外，我不*认为*这实际上是一个真正的用户代理字符串（XP 上的真正 IE6 UA 通常也会发送其 CLR 版本），这将支持它是一个损坏的代理服务器的理论。

# linq-to-sql - IQueryable、Where、Guid 和

> ID：810342
> 
> 赞同：0
> 
> 时间：2009-05-01T05:56:15.200
> 
> 标签：linq-to-sql, guid, iqueryable

我正在通过 MVC Storefront 代码工作，并尝试在 dbml/data 上下文之外遵循存储库、服务和 poco 模型的路径。实际上这很容易理解，直到我开始编写测试并且事情以我不理解的方式失败。

在我的例子中，主键是一个 uniqueidentifier 而不是一个 int 字段。存储库返回一个 IQueryable：

```
public IQueryable<Restaurant> All()
{
    return from r in _context.Restaurants select new Restaurant(r.Id)
        {
             Name = r.Name
        };
 } 
```

在这种情况下，Restaurant 当然是 Models.Restaurant，而不是 _context.Restaurants.Restaurant。

针对 All() 在服务类（或存储库单元测试）中过滤，这正如预期的那样工作：

```
var results = Repository.All().Where(r => r.Name == "BW<3").ToList(); 
```

这工作得很好，有一个 Model.Restaurant。现在，如果我用 pkid 尝试同样的事情：

```
var results = Repository.All().Where(r => r.Id == new Guid("088ec7f4-63e8-4e3a-902f-fc6240df0a4b")).ToList(); 
```

如果失败：

```
The member 'BurningPlate.Models.Restaurant.Id' has no supported translation to SQL. 
```

如果看到一些类似的帖子，人们说这是因为 r => r.Id is [Model.Restaurants] 是 linq2sql 层不知道的类级别。对我来说，这意味着第一个版本也不应该工作。当然，如果我的 pk 是一个 int，它就可以正常工作。

这里到底发生了什么？上帝知道，有一份工作，一份不工作并不是很直观。我有什么误解？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T06:15:59.350

没有实际输入此代码，您尝试过吗

var results = Repository.All().Where(r => r.Id.Equals(new Guid("088ec7f4-63e8-4e3a-902f-fc6240df0a4b")).ToList()

忍者

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T06:26:44.987

这可能与您尝试在查询中实例化 guid 的事实有关，我认为 LINQ to SQL 正在尝试在创建对象之前将其转换为实际的 SQL 代码。

尝试在查询之前而不是在查询上实例化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T01:12:29.600

我认为这里的问题是由于使用了构造函数重载，并期望查询来填充它。当你做这样的投影时，你必须把所有你想在投影查询中的东西放在实际投影本身中. 否则，Linq 不会将其包含在 SQL 查询中。

所以，像这样重写你的位：

```
return from r in _context.Restaurants select new Restaurant()
        {
             Id=r.Id,
             Name = r.Name
        }; 
```

这应该解决它。

# c# - SEO标题制作功能？

> ID：810345
> 
> 赞同：1
> 
> 时间：2009-05-01T05:58:03.653
> 
> 标签：c#, regex, function, seo

我创建了一个函数，它将任何字符串转换为制表符分隔。

```
What's new in ASP.NET 4.0 
```

然后它将上面的标题转换为以下：

```
what-s-new-in-asp-net-4-0 
```

我正在使用它来制作我的 URL 的 SEO。但我不确定它是否在所有情况下都能正常工作。到目前为止，我已经在我的数据库中的大约 1000 条记录上测试了这个功能，并且它适用于所有标题。Guyz 请检查此功能并让我知道是否有可能使此功能失败，如果此功能可能失败，请告诉我可以在我的应用程序中使用的正确功能。

```
public string SEO_makeTitle(object objTitle)
    {
        string strTitle = Convert.ToString(objTitle);

        strTitle = Regex.Replace(strTitle.Trim(), @"\W", " "); //replace special chars
        strTitle = Regex.Replace(strTitle.Trim(), @"\s{2,}", " "); //replace double space
        strTitle = strTitle.Trim().Replace(" ", "-").ToLower();

        return strTitle; //return - delimited title
    } 
```

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T06:04:05.633

您可能需要考虑口音会是什么样子。您正在替换“特殊”字符，但我怀疑这是否包括非 ASCII 字母。

我会先尝试将重音字符转换为非重音字符。如果您知道诀窍，那么在 C# 中有一种相对简单的方法可以做到这一点：

```
 static string RemoveAccents (string input) 
 { 
     string normalized = input.Normalize(NormalizationForm.FormKD); 
     Encoding removal = Encoding.GetEncoding 
         (Encoding.ASCII.CodePage, 
          new EncoderReplacementFallback(""), 
          new DecoderReplacementFallback("")); 
     byte[] bytes = removal.GetBytes(normalized); 
     return Encoding.ASCII.GetString(bytes); 
 } 
```

`ToLower(CultureInfo.InvariantCulture)`如果您在土耳其运行代码，您可能还希望显式使用以避免出现问题。*如果您在运行之前*运行ToLower，这可能不会成为问题`RemoveAccents`。

# linux - 如何在 Mac/Linux 中创建一个难以杀死的进程？

> ID：810348
> 
> 赞同：2
> 
> 时间：2009-05-01T06:00:04.193
> 
> 标签：linux, macos, process

我意识到这听起来像是恶意软件程序会做的事情，所以我理解你们中的一些人是否对我的意图持怀疑态度。我永远不会为供其他人使用的程序这样做，但我也意识到其他人可能会查看答案并自己做。

当我在互联网上时，我的工作效率会下降很多，所以我想编写一个程序来每隔一段时间自动关闭我的连接。但是了解我，我可能会 sudo kill -9 一旦它变得烦人，我想让它稍微困难一点，这样我就不会一直这样做。对此有什么建议（或其他方法来实现我正在尝试做的事情）？我正在考虑将其命名为与另一个进程相同的东西，因此我必须花一些时间弄清楚我需要杀死什么，通过 cron 作业频繁生成一个进程等。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-01T06:14:43.160

来自[行话文件](http://www.catb.org/jargon/oldversions/jarg244.txt)，对于 IT 行业历史爱好者和那些想知道我们在谈论什么的人来说总是一本好书：

=====

早在 1970 年代中期，摩托罗拉的几名系统支持人员发现了一种相对简单的方法来破解施乐 CP-V 分时系统的系统安全性。通过简单的编程策略，用户程序可以欺骗系统以“主模式”（主管状态）运行程序的一部分，在这种模式下，内存保护不适用。然后，该程序可以在其“特权级别”字节（通常是写保护的）中插入一个大值，然后可以继续绕过文件管理系统中的所有安全级别，修补系统监视器，并执行许多其他有趣的事情。简而言之，谷仓的门是敞开的。

摩托罗拉通过官方的“1 级 SIDR”（具有“需要昨天修复”的紧迫性的错误报告）向施乐正确地报告了这个问题。因为每个 SIDR 的文本都输入了一个可供很多人查看的数据库，摩托罗拉遵循了批准的程序：他们只是将问题报告为“安全 SIDR”，并附上了所有必要的文档、方法-单独复制等。

施乐坐在他们的拇指上……他们要么没有意识到问题的严重性，要么没有分配必要的操作系统人员资源来开发和分发官方补丁。

几个月过去了。摩托罗拉的人纠缠了他们的施乐现场支持代表，但无济于事。最后，他们决定采取直接行动，向施乐管理层展示系统被破解的难易程度，以及系统安全系统被破坏的程度。

他们在操作系统列表中四处寻找，并设计了一套彻底邪恶的补丁。这些补丁随后被合并到一对名为 Robin Hood 和 Friar Tuck 的程序中。Robin Hood 和 Friar Tuck 被设计为作为“幽灵工作”（在 Unix 术语中为守护进程）运行；他们会利用现有漏洞破坏系统安全，安装必要的补丁，然后密切关注彼此的状态，以防止系统操作员（实际上是超级用户）中止它们。

所以……有一天，El Segundo 的主要 CP-V 软件开发系统的系统操作员对一些不寻常的现象感到惊讶。其中包括以下内容：

*   磁带驱动器会在工作过程中倒带和卸载磁带。
*   磁盘驱动器会如此快速地来回寻找，以至于它们会试图穿过地板。
*   打卡输出设备偶尔会自行启动并打孔（每个孔都打孔）。这些通常会卡在拳头上。
*   控制台会打印从罗宾汉到弗莱尔塔克的讽刺和侮辱信息，反之亦然。
*   施乐读卡器有两个输出堆叠器；除非卡片不可读，否则可以指示它堆叠到 A、堆叠到 B 或堆叠到 A，在这种情况下，坏卡被放入堆叠器 B。幽灵安装的一个补丁向卡片添加了一些代码-读卡器驱动……读完一张卡后，它会翻转到对面的堆垛机上。结果，卡片组在被读取时会将它们分成两半，让操作员手动重新整理它们。

还产生了一些其他效果。

自然地，运营商召集了操作系统开发人员。他们发现强盗幽灵工作正在运行，并X'ed他们......并且再次感到惊讶。当罗宾汉被 X'ed 时，发生了以下一系列事件：

```
`!X id1
id1: Friar Tuck... I am under attack!  Pray save me!
id1: Off (aborted)
id2: Fear not, friend Robin!  I shall rout the Sheriff of
     Nottingham's men!
id1: Thank you, my good fellow!` 
```

`每个幽灵作业都会检测到另一个已被杀死的事实，并会在几毫秒内启动最近被杀死的程序的新副本。杀死两个幽灵的唯一方法是同时杀死它们（非常困难）或故意使系统崩溃。`

 `最后，系统程序员做了后者……结果系统重启后，土匪又出现了！事实证明，这两个程序已经修补了启动时映像（/vmunix 文件，在 Unix 术语中），并将自己添加到要在启动时启动的程序列表中......

当系统工作人员从干净的引导磁带重新启动系统并重新安装显示器时，罗宾汉和弗莱尔塔克鬼魂终于被根除。不久之后，施乐针对这个问题发布了一个补丁。

据称，施乐向摩托罗拉管理层提出了有关两名员工的恶作剧行为的投诉。没有记录对他们中的任何一个采取任何严重的纪律处分。

=====

因此，结果是拥有多个作业（任意数量），相互监控并在必要时重新启动。您还需要防止 kill 语句的变体，这些变体可以一次杀死大量进程。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T06:03:39.473

获取一个小部件以在您的桌面上显示您的银行余额（或配偶皱眉的脸，或孩子饥饿的脸）。

当您意识到这与您浪费的互联网使用之间存在联系时，您将停止。您只需要创建适当的刺激/反应反馈回路，您就会做出适当的反应。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T06:03:48.427

把它作为一个内核模块来做，你不能简单地`kill`这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T06:01:41.350

让两个进程互相监视，当一个进程消失时，另一个立即重新启动它。让他们等待对方持有的信号量，或类似的东西，这样你就不会睡觉和轮询（有未观看的时段！）。

并使它们高于正常的优先级。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T06:27:33.630

你可以进入你的 crontab，每十分钟就有机会杀死 firefox。没有进程可以杀死以防止它发生。

就像是：

#!/usr/bin/perl -w 严格

我的 $random_number = rand()*10;

如果 (rand()*10 ==1) { `kill firefox-bin` }

并在 crontab 中： */10 * * * * * /home//maybe_kill_firefox.pl

# mysql - MySQL 跨服务器选择查询

> ID：810349
> 
> 赞同：28
> 
> 时间：2009-05-01T06:00:33.460
> 
> 标签：mysql, client, cross-server

是否可以使用 MySQL 客户端编写跨服务器选择查询。基本上设置如下。

服务器 IP 数据库
--------- --------
1.2.3.4 测试
abcd 测试

我想编写一个查询，该查询将从 1.2.3.4 上的测试数据库中的表中选择行并将结果插入到 abcd 上的测试数据库中
我的服务器相距数英里，因此我将打开一个 SSH 隧道进行连接他们俩。

任何指针？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-10-09T22:20:00.130

在其中一台服务器上使用联合表怎么样？根据您将在查询中使用的远程表创建联合表，并像您的数据库都是本地的一样运行您的查询。以下示例来自[MySQL 站点](http://dev.mysql.com/doc/refman/5.0/en/federated-use.html)

使用 FEDERATED 表的过程非常简单。通常，您有两台服务器在运行，它们要么在同一主机上，要么在不同的主机上。（一个 FEDERATED 表可以使用由同一服务器管理的另一个表，尽管这样做没有什么意义。）

首先，您必须在远程服务器上有一个要使用 FEDERATED 表访问的表。假设远程表在联邦数据库中，并且定义如下：

```
CREATE TABLE test_table (
    id     INT(20) NOT NULL AUTO_INCREMENT,
    name   VARCHAR(32) NOT NULL DEFAULT '',
    other  INT(20) NOT NULL DEFAULT '0',
    PRIMARY KEY  (id),
    INDEX name (name),
    INDEX other_key (other)
)
ENGINE=MyISAM 
CHARSET=latin1; 
```

该示例使用 MyISAM 表，但该表可以使用任何存储引擎。

接下来，在本地服务器上创建一个 FEDERATED 表，用于访问远程表：

```
CREATE TABLE federated_table (
    id     INT(20) NOT NULL AUTO_INCREMENT,
    name   VARCHAR(32) NOT NULL DEFAULT '',
    other  INT(20) NOT NULL DEFAULT '0',
    PRIMARY KEY  (id),
    INDEX name (name),
    INDEX other_key (other)
)
ENGINE=FEDERATED
DEFAULT CHARSET=latin1
CONNECTION='mysql://fed_user@remote_host:9306/federated/test_table'; 
```

（在 MySQL 5.0.13 之前，使用 COMMENT 而不是 CONNECTION。）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-01T09:37:08.010

`mysqldump`可能是已经提到的解决方案，或者您可以尝试使用`SELECT ... INTO OUTFILE`then`LOAD DATA INFILE ...`命令。

MySQL 确实有可能对您有用的联合存储引擎。这里有一些关于它的更多文档[http://dev.mysql.com/doc/refman/5.0/en/federated-storage-engine.html](http://dev.mysql.com/doc/refman/5.0/en/federated-storage-engine.html)我不得不承认我没有取得巨大的成功，但它可能适用于你。

第三种解决方案是在您的应用程序中完成这项工作。逐行读入`SELECT`查询结果并逐行读`INSERT`入另一个服务器。不过，您可能会在数据类型和 null 处理方面遇到一些问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T06:27:39.290

由于mysql客户端一次只能连接到一个服务器，简短的回答是否定的。但总有办法......

最新版本`mysqldump`支持`--where`可用于限制转储数据的参数。这意味着您有一种方法可以运行一个简单的`SELECT`（即一个表上的所有列）并为其生成有效的 SQL `INSERT`。`mysqldump`然后，您可以将源服务器的此类命令的输出通过管道`mysql`传输到目标服务器的命令。

您可能希望在命令中包含一些选项，例如`--no-create-info`和。对其进行测试，直到输出完全符合您的要求。`--no-add-locks``mysqldump`

# c++-cli - 如何将 System::IntPtr 转换为 char*

> ID：810354
> 
> 赞同：1
> 
> 时间：2009-05-01T06:02:44.017
> 
> 标签：c++-cli

任何人都可以告诉如何在托管 c++ 中将 System::IntPtr 转换为 char* 这是我的主要功能

```
int main(void) 
{
    String* strMessage = "Hello world";

    CManagedClass* pCManagedClass = new CManagedClass();//working
    pCManagedClass->ShowMessage(strMessage);//working

****above said error here***    
       char* szMessage = (char*)Marshal::StringToHGlobalAnsi(strMessage);
    CUnmanagedClass cUnmanagedClass; cUnmanagedClass.ShowMessageBox(szMessage);
    Marshal::FreeHGlobal((int)szMessage);

    return 0;
} 
```

提前致谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T06:06:48.513

我不是一个巨大的 C++/CLI 程序员，但以下应该可以正常工作。

```
IntPtr p = GetTheIntPtr();
char* pChar = reinterpret_cast<char*>(p.ToPointer()); 
```

IntPtr 类有一个名为 ToPointer 的方法，该方法将地址作为`void*`类型返回。这将可以转换为`char*`C++/CLI。

**编辑**

验证这适用于 VS2008 和 VS2015

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-10-10T02:02:47.217

代替

```
char* szMessage = (char*)Marshal::StringToHGlobalAnsi(strMessage).ToPointer();
Marshal::FreeHGlobal((int)szMessage); 
```

利用

```
marshal_context conversions.
const char* szMessage = conversions.marshal_as<const char*>(strMessage); 
```

它清理自己，C++ RAII 的魔力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T06:19:18.920

**注意力！**

我想在 JaredPar 答案中添加一些内容。我不知道您的 IntPtr 来自哪里，但您还应该使用 pin_ptr 以防止垃圾收集器弄乱您的内存。我过去做过很多 CLR/Native 互操作，使用 pin_ptr 是我通过艰苦的方式学会做的事情之一。

阅读以下内容： [点击我](http://msdn.microsoft.com/en-us/library/1dz8byfh(VS.80).aspx)

# .net - WinForm 可以执行控制台程序吗？如果是这样，怎么做？

> ID：810361
> 
> 赞同：1
> 
> 时间：2009-05-01T06:05:14.400
> 
> 标签：.net, command-line

我有一个名为[FW Tools](http://fwtools.maptools.org/)的免费命令行工具。效果很好。这是我在控制台窗口中输入的示例行：-

```
ogr2ogr -f "ESRI Shapefile" -a_srs "EPSG:26986" -t_srs "EPSG:4326"
    towns_geodetic.shp TOWNSSURVEY_POLY.shp 
```

我希望根据我动态生成的一些列表（我使用 Linq-to-Filesystem 并获取所有文件名）将最后一个更改为参数，然后调用这个程序'n'次。

我不在乎输出。

这可以做到吗？

顺便说一句，这都是在 .NET 环境下。

### 编辑

还有什么方法可以确保代码等待进程完成？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T06:24:50.407

我会对此采取更详细的方法并做类似的事情

```
string ApplicationName = "ogr2ogr";
string BaseOptions = "-f \"ESRI Shapefile\" -a_srs \"EPSG:26986\" 
                      -t_srs \"EPSG:4326\"";

//Start your loop here
ProcessStartInfo oStartInfo = new ProcessStartInfo()
oStartInfo.FileName = ApplicationName;
oStartInfo.Arguments = BaseOptions + MyLoopLoadedItemsHere;
Process.Start(oStartInfo)

//If you want to wait for exit, uncomment next line
//oStartInfo.WaitForExit();

//end your loop here 
```

至少在我看来，这样的东西更具可读性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T06:11:40.517

使用[Process.Start](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.start.aspx)。就像是 ...

```
Process.Start( "cmd /c Gregory -f \"ES RI Shape file\" 
      -a_Sirs \"PEGS:26986\" -t_Sirs \"PEGS:4326\"
      towns_geodetic.Shep TOWNS SURVEY_PLOY.Shep" ); 
```

[以下是一些如何做到更清洁的示例。](http://dotnetperls.com/Content/Process-Start-NET.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T06:12:32.650

我们走吧，我的朋友

```
Process.Start(@"C:\Windows\notepad.exe", @"C:\Windows\system.ini"); 
```

或者

```
System.Diagnostics.Process.Start(@"C:\Windows\notepad.exe", 
                                 @"C:\Windows\system.ini"); 
```

# cocoa - 从 IKImageBrowserView 获取 CGImageRef

> ID：810365
> 
> 赞同：1
> 
> 时间：2009-05-01T06:08:45.857
> 
> 标签：cocoa, core-animation, core-image

我用图像文件名提供图像浏览器视图，它管理加载它们。

有没有办法在加载它们后从浏览器中检索这些图像的 CGImageRef ？当用户单击图像时，我想用它们做一些核心动画。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T16:05:25.313

可能最简单的方法是使用 NSView 方法

-bitmapImageRepForCachingDisplayInRect：

为该区域构建一个 NSBitmapImageRep，然后

-cacheDisplayInRect:toBitmapImageRep:

画进去，然后是 NSBitmapImageRep 的

-CG图像

方法来获取 CGImageRef。

# windows - CPU使用率是如何计算的？

> ID：810370
> 
> 赞同：5
> 
> 时间：2009-05-01T06:12:13.133
> 
> 标签：windows, cpu-usage

Windows 任务管理器以百分比显示 CPU 使用率。这背后的公式是什么？是不是这个：

> 进程 A 的 CPU 使用率百分比 =（到现在为止给 A 的所有时间片的总和）/自机器启动以来的总时间

或者是别的什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T06:18:58.173

我不是 100% 确定使用的是什么，但我认为你对 CPU 计算有点偏离。

我相信他们正在做类似的事情。

```
Process A CPU Usage = (Cycles for A over last X seconds)/(Total cycles for last X seconds) 
```

我相信它与任务管理器中设置的“更新间隔”有关。

虽然我为您做了一些研究，但我发现[这篇 MSDN](http://msdn.microsoft.com/en-us/library/aa364157(VS.85).aspx)文章显示了微软推荐的计算一组指令的 CPU 时间的方法，这也可能会让您对他们的计算有所了解。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-01T06:18:19.627

不，这不是“自启动以来”——它对时间的敏感程度远不止于此。

它是“自上次刷新以来 CPU 在该进程中主动运行线程的时间比例”。（刷新率通常约为一秒。）在任务管理器中，我相信它会除以 CPU 的数量，所以总数最终为 100%（即在双核机器上，单线程 CPU 猪会显示50%）。其他类似的程序有时不这样做，总共提供 100% * 核心。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T06:22:03.313

您可能还想查看[这篇文章](http://technet.microsoft.com/en-us/magazine/2007.02.vistakernel.aspx)，因为与调度有关的 CPU 周期处理方式已作为 Vista 的一部分进行了更改。我想这也适用于Win7。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-01T10:00:25.240

查看任务管理器的源代码

# cell - 单元处理器上的直接 SPU 到 SPU DMA 请求？

> ID：810376
> 
> 赞同：1
> 
> 时间：2009-05-01T06:16:28.523
> 
> 标签：cell, dma, spu

单元上的正常 DMA 请求发生在 SPU 和 PPU 之间。但是，我读过可以直接在 SPU 之间设置 DMA。有人知道这是如何实现的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T06:39:50.120

看看 spe_get_ls()。这将帮助您设置可用于在本地商店之间传输数据的有效地址列表。您可能需要一些管理来将 spe 标识符映射到物理 SPU。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-30T12:10:43.287

诀窍本质上就是克里斯所说的。一个 SPE 的本地存储被内存映射到 PPE 的内存空间。然后，您只需执行从另一个 SPE 到 PPE 上该地址的常规 DMA 传输。

对不起，我没有确切的代码。自从我不得不做这件事以来，已经有一年左右的时间了。:)

# c# - 使基于 Nhibernate 的 DAL 混淆变得友好

> ID：810383
> 
> 赞同：2
> 
> 时间：2009-05-01T06:20:22.727
> 
> 标签：c#, nhibernate, obfuscation, orm

我希望混淆使用 NHibernate 编写的数据访问层。问题是，映射是在作为资源嵌入类库中的 XML 文件中完成的——这意味着映射是明文形式的。

有两种可能的解决方案：1\. Nhibernate 映射属性 (NHMA) 来装饰映射的实体（因此，当混淆代码运行时，NHibernate 会将其映射到混淆的类名） 2\. 流畅的 NHibernate（同样，映射在代码，所以混淆应该不是问题——我认为）。

现在，如果我们使用 HQL 进行查询，这两种解决方案都将不起作用 - 因为查询将引用原始类和字段/属性名称！

有解决方案吗？我们可以在 NHMA/Fluent 映射中使用别名的类/属性名称吗？

如果我们将 HQL 查询转换为使用 NHibernate Criteria API，Criteria API 会有所帮助吗？

（我确实知道混淆的优点和缺点/徒劳以及它有用的目的 - 所以这个问题根本不是要讨论这个问题。换句话说，请不要担心讨论“为什么”我想这样做！ )

谢谢，

克里希纳。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T17:47:31.450

我能想到的唯一解决方案是使用 Linq to NHibernate。目前它是[NHibernate Contrib 项目](http://sourceforge.net/projects/nhcontrib/)的一部分，并不完全稳定。它将成为 NHibernate 2.1 版本的一部分，该版本目前处于“Alpha”状态，应该很快就会稳定**下来**。

对于映射，我会使用 Fluent NHibernate。由于 Linq 和 Fluent NHibernate 都使用 Lambda 表达式，因此它应该可以进行混淆处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T19:39:54.073

NHibernate`Configuration`对象非常灵活。通过调用：

```
var lConfig = new Configuration();
lConfig.AddXmlString("whatever xml with config"); 
```

您可以从任何来源添加字符串。这意味着您的 xmls 可以在程序集中加密并在配置 NH 时解密。

但是，如果您只是在混淆之后，我认为 Fluent NH 是您的首选工具。

# sql-server - 如何在sql server08中的变量中存储多行

> ID：810384
> 
> 赞同：1
> 
> 时间：2009-05-01T06:21:10.523
> 
> 标签：sql-server

我想知道，如何将多行存储在一个变量中。即我的查询将返回多行，我想将它存储在一个变量中。谢谢你的建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T06:26:03.693

在 SQL Server 2008 中，有一个称为**[表值参数](http://www.sqlteam.com/article/sql-server-2008-table-valued-parameters)**的功能，它允许您将行存储到可以跨存储过程传递的变量中。

但是，如果您的意图是在同一个存储过程中操作数据，那么公共表变量就可以了。这是一个例子：

```
DECLARE @MyTableVariable TABLE
(
  Id int,
  FirstName varchar(10),
  LastName varchar(10)
);

INSERT @MyTableVariable(Id, FirstName, LastName)
SELECT Id, FirstName, LastName FROM SomeOtherTable WHERE SomeCriteria 
```

`@MyTableVariable`现在包含符合条件的所有行，您仍然可以继续添加更多行，进行进一步操作，甚至返回其内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T06:25:41.463

您可以使用[表值参数](http://msdn.microsoft.com/en-us/library/bb510489.aspx)，也可以使用旧的备用临时表。

# ruby-on-rails - 如何在 Rails 的 map.resources() 中重命名默认标识符参数“id”？

> ID：810385
> 
> 赞同：12
> 
> 时间：2009-05-01T06:21:27.667
> 
> 标签：ruby-on-rails, resources, routes, params

**我喜欢 Rail 的map.resources**生成的所有默认路线。但是，在某些情况下，我想在我的路线中使用非数字标识符。例如，如果有一个由用户及其文章组成的嵌套路由，则标准路由可以这样编写：

```
map.resources :users, :has_many => [:articles] # => e.g. '/users/:id/articles/:id' 
```

但是，不使用 Rails 生成的默认数字标识符有很多优点/理由。有没有办法将默认的 :id 参数替换为我选择的另一个规范标识符，而不会导致为每个标准操作编写自定义路由？假设我想要以下格式的路线：

```
'/users/:login/articles/:id' 
```

**使用map.resources**可以实现这种路线吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-03T00:05:30.800

从 Rails 2.3 开始，无法更改参数名称并仍然使用`#resources`提供的自动路由。

作为一种解决方法，您可以`articles`使用 a`:path_prefix`和进行映射`:name_prefix`：

```
map.resources :articles, :path_prefix => "/users/:login",
                         :name_prefix => "user_" 
```

`:path_prefix`影响 URL，并影响生成的`:name_prefix`命名路由，因此您最终会得到这些路由：

```
 user_articles GET    /users/:login/articles(.:format)          {:controller=>"articles", :action=>"index"}
                  POST   /users/:login/articles(.:format)          {:controller=>"articles", :action=>"create"}
 new_user_article GET    /users/:login/articles/new(.:format)      {:controller=>"articles", :action=>"new"}
edit_user_article GET    /users/:login/articles/:id/edit(.:format) {:controller=>"articles", :action=>"edit"}
     user_article GET    /users/:login/articles/:id(.:format)      {:controller=>"articles", :action=>"show"}
                  PUT    /users/:login/articles/:id(.:format)      {:controller=>"articles", :action=>"update"}
                  DELETE /users/:login/articles/:id(.:format)      {:controller=>"articles", :action=>"destroy"} 
```

不过，作为一般经验法则，我会坚持使用 Rails 默认约定`:user_id`，以及您在问题中发布的路由。人们普遍理解，`:id`并不`:user_id`一定暗示“数字标识符”——它们暗示“资源标识符”，不管它可能是什么。通过坚持默认约定，任何在 Rails 中使用资源路由的人都更容易理解您的代码。

要为资源使用非数字标识符，只需`#to_param`在模型中重新定义。然后，确保在控制器中使用查找器，该查找器将通过此标识符（而不是数字 ID）查找，例如`User#find_by_login!`.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-01T10:18:35.103

您可以通过覆盖模型中的 to_param 来更改在 URL 中使用 ID 的默认值。例如

```
class User < ActiveRecord::Base
  def to_param
    login
  end
end

user_articles_path(@user) => "/users/:login/articles" 
```

您需要做的唯一其他更改是通过登录而不是通过控制器中的 ID 来查找用户。

# google-app-engine - 在 Google App Engine 上构建应用程序的最简单、最简洁的网络技术是什么？

> ID：810386
> 
> 赞同：2
> 
> 时间：2009-05-01T06:21:44.157
> 
> 标签：google-app-engine, web-applications, programming-languages

既然 Java 允许在 Google App Engine 之上运行多种其他语言，那么哪些新可用的语言可以让应用程序的开发最简单、最简洁？假设大多数人都知道 Ruby on Rails、PHP、Coldfusion 和 Python/Django，我们可以理所当然地认为这些都非常简单和简洁。**排除这些**，现在由于 Java 而可用的技术会让人们惊讶地知道在其中开发 Web 应用程序是多么简单和简洁？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T07:06:12.427

我认为 JAX-RS 可能是 Java 中最简单和最简洁的。[Jersey](http://jersey.dev.java.net)和[Restlet](http://www.restlet.org)都可用于 google appe 引擎。

在此处查看 Google App Engine 中[支持的 Java 框架](http://groups.google.com/group/google-appengine-java/web/will-it-play-in-app-engine?version=26)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T07:08:03.983

Google 使用他们的 Eclipse 插件让 App Engine 在 GWT 中开发变得非常容易，它可以毫不费力地为 web 应用程序提供非常 AJAXy web 2.0 的感觉。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T09:32:01.673

目前尚不清楚您正在寻找什么具体属性。简洁性非常好，直到它干扰可读性。就简单性而言，Java 或 Python 将在一段时间内成为最简单的选择，这仅仅是因为它们受到官方支持并具有完全开发的 API。

# php - 如何对卡在重定向循环中的 CakePHP 应用程序进行故障排除？

> ID：810390
> 
> 赞同：5
> 
> 时间：2009-05-01T06:23:10.440
> 
> 标签：php, cakephp, redirect

我有一个陷入重定向循环的 CakePHP 站点。我已经删除了执行重定向的每一段代码，并且我已经关闭了 Auth 对象上的 autoRedirect。

这发生在我退出网站时，即使在删除所有 cookie 并尝试加载主页后仍然存在。索引动作在`$this->Auth->allow`.

我不应该，它一直试图将我重定向到 /users/login 然后重定向循环。登录操作也在允许列表中

有没有人有任何想法可能导致这种情况？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-11-07T21:43:32.777

如果您添加一个扩展**Component**而不是**Object**的自定义组件，CakePHP 1.3 也会出现这种情况。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-02T13:09:15.620

您`<cake>/app/app_controller`应该有一个具有**Auth**组件`beforeFilter()`所有行为的方法。其中一种行为是当用户未登录时发送到哪里。

 **你会寻找类似的东西：

```
// If cake should redirect automatically or you will do it in the User.login()
$this->Auth->autoRedirect = true; 
// And if the autoRedirect is true, where to redirect
$this->Auth->loginRedirect = '/user/login'; 
```

吉拉克

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-07-30T18:02:23.857

嘿，有时，如果您的数据库连接错误，应用程序将尝试连接到 mysql，并且将处于循环状态。因此，如果数据库配置正确，请始终查看。

再见。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-01T02:59:00.750

我最近遇到了这个问题，我不知道为什么，但是当我更改时它已修复（在我的 AppController beforeFilter() 方法中）：

```
$this->Auth->allow('*'); 
```

至

```
$this->Auth->allow(); 
```

当然，在我随后的控制器中，我否认了适当的行动。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-30T15:21:05.857

好吧，在我试图访问的情况下，这可能发生的原因似乎有很多

蛋糕应用程序/用户/添加

结果我失踪了

```
'add'=>'*', 
```

在 usersController.php 的权限数组中

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-08-26T14:12:36.640

我遇到了同样的问题，当我重新启动 mySql 服务时，重定向停止了。因此，将此添加到您要检查的事项列表中。

# flash - 使用 Flash 流式传输实时音频

> ID：810400
> 
> 赞同：3
> 
> 时间：2009-05-01T06:27:45.377
> 
> 标签：flash, audio, radio

有人找我建立一个互联网广播电台，该电台专注于德克萨斯州埃尔帕索的当地音乐场景。我查看了各种选项，但似乎大多数解决方案都是用于流式传输预先录制的音频。虽然我可能需要依靠这一点，但我想知道是否有人做过类似的项目，并且可能能够为我指明正确的方向。我希望能够在 Flash 中做到这一点，因为它似乎比几乎任何其他选项都得到更广泛的支持。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T10:42:01.723

首先，免费选项：

请记住，Flash“视频”(FLV) 文件只能包含音频。

FLV 文件是一种“渐进式”格式 - 您可以在收到整个文件之前开始播放它们。

FLV 文件可以通过普通的 http 进行“渐进式下载”。

开源 (GPL) [Movino](http://www.movino.org/)服务器就是这样做的——它从某个源接收音频数据包，并使用 FFMPEG 将它们转码为 FLV 格式；然后，Flash 播放器可以使用基本的 HTTP 服务器实时读取此内容。

[使用优秀的免费Haxe](http://haxe.org/)非常[容易](http://lists.motion-twin.com/pipermail/haxe/2007-October/012184.html)创建玩家。

（有一个[HaxeVideo](http://haxevideo.org/)程序可能也值得研究。）

现在，$$$ 选项：

[Wowza](http://www.wowzamedia.com/)，特别是在亚马逊的[EC2](http://www.wowzamedia.com/ec2.html)上，如果你想真正扩展的话！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T07:00:18.353

有为此做的软件，Flash 或 Silverlight 的问题是它必须有一个来源，这意味着你必须预先录制它。您可能能够做到的一种方法是，在您开发的任何应用程序或预开发的应用程序中即时构建一个 wav 文件，该文件将位于预定义的文件夹中，并且使用 flash 应用程序，您会一直关注该文件夹该文件，然后您在运行中加载声音以及添加您的应用程序，闪存读取它，您还可以放置一个标志文件，例如，recording.txt，如果该文件存在，那么您正在录制，这意味着对于它应该播放的 Flash 应用程序，就这样。

只是一个想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T06:35:12.330

看看 Adob​​e 的 Flash 媒体服务器。他们有免费的开发者许可证，因此您可以使用它进行开发。它支持流式音频和视频。非常好，效率很高。

# php - PHP 文件中注入的病毒代码

> ID：810402
> 
> 赞同：4
> 
> 时间：2009-05-01T06:28:12.737
> 
> 标签：php, server-side, shared-hosting, virus

我拥有一个在 LAMP 上运行的网站 - Linux、Apache、mySQL 和 PHP。在过去的 2-3 周内，我网站上的 PHP 和 jQuery 文件被来自一个名为 gumblar.cn 的网站的恶意软件感染

我不明白这个恶意软件是如何进入我的 PHP 文件的，以及如何防止它一次又一次地发生。

有任何想法吗？

更新：

[看起来这是一个cpanel漏洞](http://forums.hostgator.com/virus-issue-has-been-resolved-here-t10939.html)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-01T06:34:56.420

**您的网站已破解**，因此破解者只需替换您的文件。

每当发布安全警报时，您应该始终升级您的 Linux 操作系统、Apache、MySQL、PHP 和 Web PHP 程序。

运行开放服务而不定期升级的 Linux 服务器是互联网上最容易受到攻击的机器。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-02T18:11:52.290

这里没有人可以根据您提供的信息提供结论性的解决方案，因此我们只能建议您遵循良好的安全实践和标准并立即纠正任何弱点。

确保您的软件是最新的。很可能通过 PHP 程序中的漏洞访问本地文件，因此请保留您在其最新版本上运行的任何第三方应用程序（尤其是 Wordpress 和 phpBB 等非常普遍的程序），并尽一切可能确保您的服务器正在运行其服务的正确版本（PHP、Apache 等）。

使用强密码。强密码是一长串随机字符。它应该与你的生活无关，它应该没有现成的首字母缩写词或助记符，它不应该像字典中的单词，它应该包含不同字符的健康穿插；数字、不同大小写的字母和符号。它也应该相当长，最好超过 26 个字符。这应该有助于防止人们在足够的时间内暴力破解您的凭据，以便有能力的系统管理员对攻击者采取行动。

与您的托管服务提供商的管理员合作，了解在这种特殊情况下发生了什么，并采取措施纠正它。他们可能没有注意到任何异常；例如，如果您有一个简单的密码，或者如果此攻击是由受信任的个人实施的，或者如果您在自定义 PHP 应用程序中有未修补的漏洞，则没有任何迹象表明使用不当。

共享主机也有许多人可以访问同一台本地机器，因此文件权限和修补本地可访问漏洞等内容在您的应用程序中通常非常重要。确保您的主机对此有良好的政策，并确保您的任何软件都没有明确信任本地连接或用户。

攻击的性质（从一个似乎在做这种事情的网站导入恶意软件）表明您正在运行一个可利用的应用程序，或者您的用户名/密码组合不够强大，但是您提供商的管理员确实是唯一能够提供有关如何发生的准确细节的人。祝你好运。:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-04T06:34:21.060

很有可能，您的服务器上的某个应用程序存在已被攻击的已知漏洞，并且某些东西修改了您网站上的文件或安装了新文件。

在 gumblar.cn 上搜索信息时，看起来他们使用了一个名为 JS-Redirector-H 的木马。不确定这是否是这里所涉及的。

如果您无法知道已修改的内容，则解决此问题可能涉及从备份中恢复您的网站。如果您有源代码控制或最新版本，则可以进行整个站点的差异。但是您还需要首先修复导致这种情况发生的安全漏洞。

可能是某个不安全的应用程序，或者您之前安装但最近没有更新的应用程序。一些对此抱怨的人提到他们使用Gallery（即PHP Gallery）。虽然我不确定这是否相关。

如果您不是服务器管理员，请与服务器管理员交谈。他们或许能够提供帮助，明智的做法是让他们知道这一点。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-04T06:46:52.433

**谷歌咨询：** [http](http://safebrowsing.clients.google.com/safebrowsing/diagnostic?client=Firefox&hl=en-US&site=http://gumblar.cn) ://safebrowsing.clients.google.com/safebrowsing/diagnostic?client=Firefox&hl=en-US&site=http://gumblar.cn （链接不起作用）

首先，联系您的托管公司并报告此情况。如果这是服务器范围的，他们需要知道它。

此类感染的最常见原因是易受攻击的流行 PHP 软件（例如 PHPBB、Mamboserver 和其他流行系统）。如果您正在运行任何第 3 方 PHP 代码，请确保您拥有最新版本。

如果您确定这只会影响您的站点，请从备份中恢复。如果您没有任何备份，请尝试重新安装您拥有的所有内容（您可能可以迁移数据库）（到最新版本）并检查您自己的 PHP 代码（如果有）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-04T05:23:37.453

PHP 程序实际上是由 PHP 解释器在服务器上运行的简单文本文件。如果您的应用程序被感染，那么我认为有两个可能性：

1.他们在你的应用程序中使用了一些安全漏洞将一些代码注入你的服务器，所以现在他们已经改变了你的一些 PHP 文件，或者你的一些数据库信息。

如果是这种情况，您最好仔细检查您从用户那里获取信息的每个地方（文本输入、文件上传、cookie 值……），确保所有内容都经过良好过滤。这是过滤来自用户的任何内容的非常常见的安全做法。您还最好确保当前保存在数据库（或文件系统）中的数据是干净的。我建议使用[Zend Framework](http://framework.zend.com/)的 Zend_Filter 组件来过滤用户输入。那里有许多功能齐全的过滤器库。

2.他们可能在您的服务器上运行了一些程序，这会影响您的 PHP 源文件。所以他们以某种方式完成了在您的服务器上运行一些程序/脚本，这正在改变您的应用程序。

如果是这种情况，我建议您检查所有服务器进程并确保您知道每个正在运行的进程。虽然我认为这不太可能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-04T06:43:10.010

好的，这不是一个编程问题，所以不是这个地方，因为如果我们在这里容忍这样的问题，我们很快就会成为共享主机帐户不良的 ppl 的急救/支持站点。

我只是没有投票赞成关闭，因为我很难拒绝一些可能对他们没有知识解决的问题感到非常糟糕的人。

首先：google for gumblar.cn，随着我们说话，越来越多的潜在有用帖子正在积累。

如果您是一个真正的初学者，并且您觉得您在此处的答案中没有得到任何东西，那么只需执行以下操作：

1.  获取新主机
2.  谷歌搜索有关您所有软件的信息，直到您知道该软件是否安全为止。如果不是，请不要使用它，直到开发人员解决了问题。不安全软件的一个例子是“Galery”。
3.  安装所有软件（仅限安全软件）全新安装！！
4.  将静态文件（如图像）复制到新服务器。不要复制任何动态文件，例如 php 脚本，因为它们可能会被感染。
5.  在检查安全漏洞之前，请勿上传您自己的任何 PHP 脚本。如果您不知道如何执行此操作，请在了解这些内容之前不要上传任何内容。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-16T12:13:35.687

我受到这种病毒/恶意软件的影响，目前正在清理。我希望这会有所帮助：

1) 您很可能在您的 PC 上安装了 TROJAN。要验证这一点，只需运行（开始 > 运行...或 Windows 键 + R）并键入“cmd”或“regedit”。如果其中任何一个都没有按预期打开其窗口，则您有 Js:Redirector 特洛伊木马。您还可以验证防病毒程序 aVast 和 Malware Bytes 是否由于某种原因无法连接到更新（即偷偷摸摸的木马）。另外，您会注意到控制面板的安全程序已被禁用，您不会在托盘图标中看到通知告诉您病毒防护已被禁用。

2) 这是一个[最近的漏洞利用](http://blog.unmaskparasites.com/2009/05/07/gumblar-cn-exploit-12-facts-about-this-injected-script/)，显然是 inflash 或 pdf 插件的漏洞，因此即使你没有使用 Internet Explorer，你也不安全！

至于我，我相信因为我讨厌让我的电脑变慢的程序，我的 Windows 更新是“手动”的，而且我没有常驻保护（扫描所有网络连接等），我可能是通过访问感染了另一个尚未列入黑名单的被黑网站。我也对非 IE 浏览器过于自信了！我有时会忽略黑名单警告，因为我对脚本的作用等感到好奇，并再次忘记了 Windows 到底有多糟糕。结论：将 Windows 更新保持在自动状态，具有最小的常驻保护（aVast Web Shield + Network Shield）。

3) 因为这是一个发回您的 FTP 密码的木马，所以不管您的密码有多好！

4) 尝试使用 Malware 或 aVast 对您的 PC 进行 lceanup，它会找到一个以“.ctv”结尾的文件。您必须拥有 5 月 14 日或更晚的病毒数据库。如果您无法更新（如上所述），请按照[这些说明](http://www.malwarebytes.org/forums/lofiversion/index.php/t15460.html)进行操作（您需要推断，但基本上您有一个文件，名称可能会有所不同，在注册表中指出，然后使用 HiJackThis 将其删除一次你在没有执行这个文件的情况下重新开始，一切都很好）

5）当然要更新你的密码，但要确保先删除木马！

6) 要获得所有修改页面的准确列表，请尝试获取 FTP 日志，您将找到脚本/黑客的 IP 和所有触及的文件。

7）如果你有一个完整的“生产”环境的本地副本，那么最安全的方法是删除服务器上的所有站点，然后重新上传所有文件。

8) 在清理过程中不要访问您的受感染站点，否则您将重新安装木马！如果您拥有最新的 aVast Home Edition 和“Web Shield”保护，它将向您发出警告并阻止该页面被您的浏览器执行。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-16T12:29:27.460

我在一家旧的托管服务提供商身上发生过类似的事情。不知何故，有人能够以某种方式感染 Apache，从而将一个特殊的标头注入到我所有的 PHP 文件中，这导致浏览器尝试下载并在浏览器中运行。当他们修复它时，快速的解决方案是删除我所有的 PHP 文件，并将我的索引文件更改为纯 HTML 文件。这是否会为您解决问题取决于服务器是如何被感染的。您可以做的最好的也是最负责任的事情是通过关闭站点来保护您的访问者，并且如果可能（如果文本文件没有被感染），显示一条消息，说明如果他们最近访问过他们可能已被感染。

不用说，我的网站被感染后很快就更换了托管服务提供商。我的托管服务提供商在很多其他方面都很糟糕，但这几乎是最后一根稻草。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-03T02:27:44.623

该网站（您提到的gumblar.cn）正在接受恶意软件测试。您可以在这里监控结果：[http ://www.siteadvisor.com/sites/gumblar.cn/postid?p=1659540](http://www.siteadvisor.com/sites/gumblar.cn/postid?p=1659540)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-01T17:30:45.033

就像弗朗西斯提到的那样，尝试让您的托管公司确保他们的软件是最新的。

在您这边，尽快将您的 ftp 密码更改为完全模糊的密码。我以前见过这种情况发生在人们身上。这些“黑客”所做的是对您的 ftp 帐户进行暴力破解，下载几个文件，稍微修改它们，然后重新上传受感染的副本。如果您有权访问 ftp 日志文件，您可能会看到从您的 IP 以外的 IP 连接到您的帐户。您可以将其提交给您的托管公司，并要求他们将该 IP 列入黑名单以阻止其访问其服务器。

# hibernate - 休眠删除

> ID：810404
> 
> 赞同：0
> 
> 时间：2009-05-01T06:29:33.547
> 
> 标签：hibernate

我有一个课程对象。课程对象有一组教程和一组应用程序。当我删除课程对象时，我希望删除相关的教程和应用程序集。我的 course.hbm 如下

我的 application.hbm 包含

```
 <property name="appdatetime" type="timestamp">
        <column name="appdatetime" length="19" />
    </property>
    <property name="appstatus" type="java.lang.Integer">
        <column name="appstatus" />
    </property>
    <property name="apptype" type="java.lang.Integer">
        <column name="apptype" />
    </property>

    <many-to-one name="course" column="cid"/>
    <many-to-one name="employee" column="empid" />
</class> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T06:33:55.390

设置 cascade="delete-orphan,all" 并且删除操作将级联到教程和应用程序，如果它们是孤立的（未连接到任何其他课程），也会将它们删除。

我们使用休眠注释，所以我不确定要添加的确切 xml，但从文档中，看起来 cascade="all-delete-orphan" 应该在每个集合定义上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T12:33:06.213

虽然可以在休眠状态下执行此操作，但正确的方法（始终确保数据库的完整性）是在数据库级别使用 CASCADE ON DELETE 约束。检查您的数据库文档以获取详细信息

# c# - 尝试在 C# 中使 waveout 工作时 vhost.exe 崩溃

> ID：810405
> 
> 赞同：0
> 
> 时间：2009-05-01T06:29:34.263
> 
> 标签：c#, crash, waveout

我尝试在 C# 中使用 waveout 来同时播放更多的 wav 文件（至少是不同的文件）。（SoundPlayer 对象一次只播放一个，我不想为这个简单的目标使用 DirectSound 和 MediaPlayer 对象或任何其他高级技术。）

我将一个工作的 C++ 代码移植到 C# 并且它可以工作（在研究了如何编组和如何调用本机 win32 dll-s 以及如何分配和锁定非托管内存之后）但它以某种方式使 vhost.exe 崩溃，我不知道为什么这样做。（它不会抛出任何异常，只会出现标准的 windows 错误对话框并且程序崩溃并退出。）

有没有人有任何想法？

这是该类的来源：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;
using XiVo.PlayThrough;
using System.ComponentModel;
using System.Runtime.InteropServices;
using System.Timers;

namespace RTS
{
    class WaveObject
    {
        protected IntPtr wo;
        protected byte[] Adat=null;
        protected WaveNative.WaveHdr woh;
        protected int pgc;

        public class NotAWaveformFileException : Exception
        {
            public NotAWaveformFileException(string str) : base(str) { }
            public NotAWaveformFileException() { }
        }

        public class WaveFileIsCorruptedException : Exception
        {
            public WaveFileIsCorruptedException(string str) : base(str) { }
            public WaveFileIsCorruptedException() { }
        }

        public class WaveMapperCouldNotBeOpenedException : Exception
        {
            public WaveMapperCouldNotBeOpenedException(string str) : base(str) { }
            public WaveMapperCouldNotBeOpenedException() { }
        }

        public WaveObject() {}

        public WaveObject(string Fn) : this() { Load(Fn); }

        public void Load(string Fn)
        {
            IntPtr mmio;
            NativeMMIO.mmckInfo Main, Sub;

            WaveFormat wfx;
            StringBuilder str=new StringBuilder(Fn);
            int r;
            mmio = NativeMMIO.mmioOpen(str,IntPtr.Zero,NativeMMIO.MMIO_READ);
            if (mmio == IntPtr.Zero)
            {
                throw new FileNotFoundException(Fn + "not found!");
            }
            Main.fccType = NativeMMIO.mmioFOURCC('W', 'A', 'V', 'E');
            if (NativeMMIO.mmioDescend(mmio, out Main, IntPtr.Zero, NativeMMIO.MMIO_FINDRIFF) != 0)
            {
                throw new NotAWaveformFileException();
            }
            Sub.ckid = NativeMMIO.mmioFOURCC('f', 'm', 't', ' ');
            if (NativeMMIO.mmioDescend(mmio, out Sub, out Main, NativeMMIO.MMIO_FINDCHUNK) != 0)
            {
                throw new WaveFileIsCorruptedException("fmt chunk is not found!");
            }
            byte[] raw = new byte[Sub.cksize+2];
            NativeMMIO.mmioRead(mmio, raw, (int)Sub.cksize);
            GCHandle conv = GCHandle.Alloc(raw, GCHandleType.Pinned); // mapping a WaveFormat structure from the byte array
            wfx = (WaveFormat)Marshal.PtrToStructure(conv.AddrOfPinnedObject(), typeof(WaveFormat));
            conv.Free();
            Sub.ckid = NativeMMIO.mmioFOURCC('d', 'a', 't', 'a');
            if (NativeMMIO.mmioDescend(mmio, out Sub, out Main, NativeMMIO.MMIO_FINDCHUNK) != 0)
            {
                throw new WaveFileIsCorruptedException("data chunk is not found!");
            }
            Adat = new byte[Sub.cksize+2];
            NativeMMIO.mmioRead(mmio, Adat, (int)Sub.cksize);
            NativeMMIO.mmioClose(mmio, 0);
            wfx.cbSize = (short)Marshal.SizeOf(wfx);
            unchecked // WAVE_MAPPER is 0xFFFFFFFF and it does not let it convert to int otherwise
            {
                int res = WaveNative.waveOutOpen(out wo, (int)WaveNative.WAVE_MAPPER, wfx, null, 0, (int)WaveNative.CALLBACK_NULL);
                if (res != WaveNative.MMSYSERR_NOERROR)
                {
                    throw new WaveMapperCouldNotBeOpenedException();
                }
            }
            woh.lpData = Marshal.AllocHGlobal((int)Sub.cksize); // alloc memory for the buffer
            Marshal.Copy(Adat, 0, woh.lpData, (int)Sub.cksize);
            woh.dwBufferLength = (int)Sub.cksize;
            woh.dwBytesRecorded = 0;
            woh.dwUser = IntPtr.Zero;
            woh.dwFlags = 0;
            woh.dwLoops = 1000000;
            woh.reserved = 0;
            woh.lpNext = IntPtr.Zero;
            r = WaveNative.waveOutPrepareHeader(wo, ref woh, Marshal.SizeOf(woh));
            pgc = System.Environment.TickCount;
        }

        public void Play()
        {
            if (System.Environment.TickCount - pgc > 50)
            {
                if (wo == null) throw new Exception("wo somehow became null.");
                int res = WaveNative.waveOutReset(wo);
                if (res != WaveNative.MMSYSERR_NOERROR) throw new Exception(string.Format("waveOutReset {0}",res));
                res=WaveNative.waveOutWrite(wo, ref woh, Marshal.SizeOf(woh));
                if ((res != WaveNative.MMSYSERR_NOERROR) && (res!=33)) throw new Exception(string.Format("waveOutWrite {0}",res));
            }
        }

        ~WaveObject()
        {
            Marshal.FreeHGlobal(woh.lpData); // release memory
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-02T07:18:24.543

经过大量谷歌搜索后，我意识到该错误在 winmm.dll 本身中。在某些情况下，它的辅助线程也会崩溃并关闭主机应用程序。

[引文](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=412097)

# haskell - 适合初学者的 Haskell 还是标准 ML？

> ID：810409
> 
> 赞同：79
> 
> 时间：2009-05-01T06:31:16.863
> 
> 标签：haskell, functional-programming, sml, discrete-mathematics

我将教授离散结构的低年级课程。我之所以选择教科书《[离散结构、逻辑和可计算性](https://rads.stackoverflow.com/amzn/click/com/0763772062)》，部分原因是它包含有助于使用函数式编程语言实现的示例和概念。（我也认为这是一本很好的教科书。）

我想要一种易于理解的 FP 语言来说明 DS 概念并且学生可以使用。大多数学生最多只有一两个学期的 Java 编程。在查看了 Scheme、Erlang、Haskell、Ocaml 和 SML 之后，我选择了 Haskell 或 Standard ML。出于以下概述的原因，我倾向于 Haskell，但我希望那些在其中一个或另一个中活跃的程序员的意见。

*   Haskell 和 SML 都具有模式匹配，这使得描述递归算法变得轻而易举。
*   Haskell 有很好的列表推导，可以很好地匹配这些列表的数学表达方式。
*   Haskell 有惰性求值。非常适合使用列表理解技术构建无限列表。
*   SML 有一个真正的交互式解释器，可以在其中定义和使用函数。在 Haskell 中，函数必须在单独的文件中定义并在用于交互式 shell 之前进行编译。
*   SML 以易于理解的语法明确确认函数参数和返回类型。例如：val foo = fn : int * int -> int。Haskell 的隐式 curry 语法有点迟钝，但并不完全陌生。例如：foo :: Int -> Int -> Int。
*   Haskell 默认使用任意精度的整数。它是 SML/NJ 中的一个外部库。SML/NJ 默认将输出截断为 70 个字符。
*   Haskell 的 lambda 语法很微妙——它使用单个反斜杠。SML 更明确。不过，不确定我们是否会在这个类中需要 lambda。

本质上，SML 和 Haskell 大致等价。我倾向于 Haskell，因为我喜欢 Haskell 中的列表推导和无限列表。但我担心 Haskell 紧凑语法中大量的符号可能会给学生带来问题。根据我在 SO 上阅读其他帖子所收集到的信息，不建议从 FP 开始的初学者使用 Haskell。但我们不会构建成熟的应用程序，只是尝试简单的算法。

你怎么看？

* * *

编辑：在阅读了您的一些出色回复后，我应该澄清一些要点。

在 SML 中，在解释器中定义函数和在外部文件中定义函数之间没有语法上的区别。假设您要编写阶乘函数。在 Haskell 中，您可以将此定义放入文件中并将其加载到 GHCi 中：

```
fac 0 = 1
fac n = n * fac (n-1) 
```

对我来说，这很清楚、简洁，并且符合书中的数学定义。但是如果你想直接在 GHCi 中编写函数，你必须使用不同的语法：

```
let fac 0 = 1; fac n = n * fac (n-1) 
```

当使用交互式解释器时，从教学的角度来看，当学生可以在文件和命令行中使用相同的代码时，非常非常方便。

“显式确认函数”是指在定义函数时，SML 会立即告诉您函数的名称、参数的类型和返回类型。在 Haskell 中，你必须使用`:type`命令，然后你会得到有点令人困惑的咖喱符号。

Haskell 还有一件很酷的事情——这是一个有效的函数定义：

```
fac 0 = 1
fac (n+1) = (n+1) * fac n 
```

同样，这符合他们可能在教科书中找到的定义。在 SML 中不能这样做！

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2009-05-01T22:59:49.780

就像我喜欢 Haskell 一样，以下是我更喜欢将 SML 用于离散数学和数据结构课程（以及大多数其他初学者的课程）的原因：

*   Haskell 程序的时间和空间成本可能很难预测，即使对于专家来说也是如此。SML 提供了更多有限的方法来吹制机器。

*   交互式解释器中函数定义的语法与文件中使用的语法*相同*，因此您可以剪切和粘贴。

*   尽管 SML 中的运算符重载完全是假的，但它也很简单。在 Haskell 中教一整堂课而不必进入类型课程将是很困难的。

*   学生可以使用`print`. （尽管正如评论者指出的那样，在 Haskell 中使用 . 可以得到几乎相同的效果`Debug.Trace.trace`。）

*   无限的数据结构让人们大吃一惊。对于初学者，你最好让他们定义一个包含 ref 单元和 thunk 的流类型，这样他们就知道它是如何工作的：

    ```
    datatype 'a thunk_contents = UNEVALUATED of unit -> 'a
                               | VALUE of 'a
    type 'a thunk = 'a thunk_contents ref
    val delay : (unit -> 'a) -> 'a thunk
    val force : 'a thunk -> 'a 
    ```

    现在它不再是魔法了，你可以从这里转到流（无限列表）。

*   布局不像 Python 那样简单，而且可能会造成混淆。

Haskell 有两个优势：

*   在核心 Haskell 中，您可以在函数定义之前编写函数的类型签名。这对学生和其他初学者非常有帮助。在 SML 中没有一种处理类型签名的好方法。

*   Haskell 有更好的具体语法。Haskell 语法是对 ML 语法的重大改进。我写了一篇[关于何时在 ML 程序中使用括号的简短说明](http://www.cs.tufts.edu/~nr/cs152/readings/mlsupp.html#toc6)；这有点帮助。

最后，有一把双刃剑：

*   Haskell 代码默认是纯代码，因此您的学生不太可能偶然发现不纯的构造（IO monad、state monad）。但出于同样的原因，它们不能打印，如果你想做 I/O，那么至少你必须解释`do`符号，`return`这很令人困惑。

* * *

在一个相关主题上，这里有一些对你的课程准备的建议：不要忽视Chris Okasaki 的[Purely Functional Data Structures](https://rads.stackoverflow.com/amzn/click/com/0521663504)。即使您没有让您的学生使用它，您也一定会想要一份。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-05-01T13:11:49.443

我们在大学的第一年教 Haskell。我对此的感觉有点复杂。一方面，在第一年教 Haskell 意味着他们不必忘记命令式风格。Haskell 还可以生成非常简洁的代码，之前有一些 Java 的人可以欣赏。

我注意到学生经常遇到的一些问题：

*   起初，模式匹配可能有点困难。学生们最初在了解值构造和模式匹配之间的关系时遇到了一些问题。他们也有一些区分抽象的问题。我们的练习包括编写简化算术表达式的函数，一些学生很难看出抽象表示（例如`Const 1`）和元语言表示（`1`）之间的区别。

    此外，如果您的学生应该自己编写列表处理函数，请注意指出模式之间的区别

    ```
    []
    [x]
    (x:xs)
    [x:xs] 
    ```

    根据你想教他们多少函数式编程，你可以给他们一些库函数，让他们玩弄。

*   我们没有教我们的学生匿名函数，我们只是告诉他们`where`子句。对于某些任务，这有​​点冗长，但在其他方面工作得很好。我们也没有告诉他们部分申请；这在 Haskell 中可能很容易解释（由于其书写类型的形式），因此可能值得向他们展示。

*   他们很快发现了列表推导式，并且比高阶函数（如`filter`, `map`, `zipWith`.

*   我认为我们在教他们如何让他们按类型引导他们的思想方面错过了一点。不过，我不太确定这是否对初学者有帮助。

*   错误消息通常对初学者不是很有帮助，他们可能偶尔需要一些帮助。我自己没有尝试过，但是有一个专门针对新手的 Haskell 编译器，主要是通过更好的错误消息：[Helium](http://www.cs.uu.nl/wiki/Helium)

*   对于小程序，可能的空间泄漏之类的事情不是问题。

总的来说，Haskell 是一种很好的教学语言，但也有一些缺陷。鉴于学生对列表推导比高阶函数感觉更舒服，这可能是你需要的论据。我不知道你的课程有多长，或者你想教他们多少编程，但一定要计划一些时间来教他们基本概念——他们会需要的。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-01T14:54:52.113

顺便提一句，

> # SML 有一个真正的交互式解释器，可以在其中定义和使用函数。在 Haskell 中，函数必须在单独的文件中定义并在用于交互式 shell 之前进行编译。

是不准确的。使用 GHCi：

```
Prelude> let f x = x ^ 2
Prelude> f 7
49
Prelude> f 2
4 
```

在 haskell.org edu 上也有很好的 Haskell 教育资源。页面，来自不同老师的经验。[http://haskell.org/haskellwiki/Haskell_in_education](http://haskell.org/haskellwiki/Haskell_in_education)

最后，如果您使用 Haskell，您将能够仅仅为了好玩而教他们多核并行性 :-)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-05-01T07:14:38.803

许多大学将 Haskell 作为第一门函数式语言甚至第一门编程语言来教授，所以我认为这不会成为问题。

在完成了这样一门课程的一些教学之后，我不同意您发现的可能混淆的可能性。早期混淆的最可能来源是由错误的布局引起的解析错误，以及当数字文字使用不正确时有关类型类的神秘消息。

我也不同意任何关于不建议从 FP 开始的初学者使用 Haskell 的建议。这肯定是一种大爆炸式的方法，而具有突变的严格语言则不是，但我认为这是一种非常有效的方法。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-05-01T15:08:48.273

> *   SML 有一个真正的交互式解释器，可以在其中定义和使用函数。在 Haskell 中，函数必须在单独的文件中定义并在用于交互式 shell 之前进行编译。

虽然 Hugs 可能有这个限制，但 GHCi 没有：

```
$ ghci
GHCi, version 6.10.1: http://www.haskell.org/ghc/  :? for help
Loading package ghc-prim ... linking ... done.
Loading package integer ... linking ... done.
Loading package base ... linking ... done.
Prelude> let hello name = "Hello, " ++ name
Prelude> hello "Barry"
"Hello, Barry" 
```

我喜欢 GHC(i) 而不是 Hugs 的原因有很多，这只是其中之一。

> *   SML 以易于理解的语法明确确认函数参数和返回类型。例如：val foo = fn : int * int -> int。Haskell 的隐式 curry 语法有点迟钝，但并不完全陌生。例如：foo :: Int -> Int -> Int。

SML 也有你所说的“隐式 curry”语法。

```
$ sml
Standard ML of New Jersey v110.69 [built: Fri Mar 13 16:02:47 2009]
- fun add x y = x + y;
val add = fn : int -> int -> int 
```

> 本质上，SML 和 Haskell 大致等价。我倾向于 Haskell，因为我喜欢 Haskell 中的列表推导和无限列表。但我担心 Haskell 紧凑语法中大量的符号可能会给学生带来问题。根据我在 SO 上阅读其他帖子所收集到的信息，不建议从 FP 开始的初学者使用 Haskell。但我们不会构建成熟的应用程序，只是尝试简单的算法。

比起 SML，我更喜欢使用 Haskell，但我还是会先教 SML。

*   借用 nominolo 的想法，列表推导似乎*确实*会减慢学生学习某些高阶函数的速度。
*   如果您想要惰性和无限列表，那么明确地实现它是有益的。
*   因为 SML 被急切地评估，执行模型更容易理解，并且“通过 printf 调试”比在 Haskell 中工作得好得多。
*   SML 的类型系统也比较简单。虽然你的类可能无论如何都不会使用它们，但 Haskell 的类型类仍然是一个额外的障碍——让他们理解 SML 中的`'a`vs`''a`区别已经足够困难了。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-07-01T23:28:38.807

大多数答案都是技术性的，但我认为您至少应该考虑一个不是：Haskell（作为 OCaml），此时，有一个更大的社区在更广泛的环境中使用它。[Hackage](http://hackage.haskell.org)还有一个大型的库和应用程序数据库，这些库和应用程序是为了盈利和乐趣而编写的。这可能是让您的一些学生在课程结束后继续使用该语言的一个重要因素，并可能在以后尝试其他功能语言（如标准 ML）。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-05-12T19:44:26.273

我很惊讶你没有考虑 OCaml 和 F#，因为它们解决了你的许多问题。当然，体面和有用的开发环境是学习者的重中之重吗？在这方面，SML 远远落后，而 F# 则领先于所有其他 FPL。

此外，OCaml 和 F# 都有列表推导。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2015-03-11T21:10:39.757

哈斯克尔。由于我从使用 Haskell 中学到的东西，我在 CS 的算法/理论课上领先。它是如此全面的语言，*只要使用它*，它就会教你大量的 CS 知识。

但是，SML 更容易学习。Haskell 具有惰性求值和控制结构等特性，使其功能更加强大，但代价是陡峭的（ish）学习曲线。SML 没有这样的曲线。

也就是说，大多数 Haskell 都在从不太科学/数学的语言中学习东西，例如 Ruby、ObjC 或 Python。

# web-services - Web服务的测试框架

> ID：810410
> 
> 赞同：0
> 
> 时间：2009-05-01T06:32:59.590
> 
> 标签：web-services, testing, cucumber, dataflex

我们有一个用 Visual Dataflex 编写的整体应用程序，以及用其他 (.NET) 语言编写的各种补充应用程序。它们都共享同一个数据库，并且需要遵循相同的业务逻辑。促进跨这些统一业务逻辑的一种方法是提供 Web 服务作为测试接口。

当然，要做到这一点，我们需要一个好的框架来测试 Web 服务。有什么建议么？例如，Cucumber 可以“开箱即用”吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T17:05:37.200

我假设您在谈论 Soap Web 服务。您可以使用 Soap4R 与 Soap Web 服务通信。将这一切都包含在 Cucumber 场景中应该可以正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T06:40:21.413

[SoapUI](http://www.soapui.org/)是用于创建 web 服务测试的非常好的产品，它们可以通过 junit 或仅通过命令行轻松调用。它也有一些用于创建负载测试的东西。

他们有一个开源版本和一个专业版本。

# jquery - 持续通知

> ID：810422
> 
> 赞同：0
> 
> 时间：2009-05-01T06:38:40.043
> 
> 标签：jquery

嗨，我想知道是否有人知道一个 jquery 插件来创建类似于出现在 Stack Overflow 上的通知标题的行为。我了解如何隐藏和显示元素，但我不知道如何使其切换状态在整个站点中保持不变。我想基本上我要问的是如何在脚本中添加 cookie，以便通知不会继续显示是否有人关闭它然后转到另一个页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T07:04:43.587

您还可以使用**[jQuery Cookie 插件](http://plugins.jquery.com/project/cookie)**来读取和写入通知消息是否显示的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T06:50:07.850

我不是一个网络用户界面的人，但我会让通知上的“关闭”按钮向服务器发出 AJAX 请求，告诉它通知已被清除。（您是否使用该请求的结果来做任何事情取决于您 - 我无法想象您想做很多事情，除了可能刷新通知列表以防同时出现新通知.)

基本上保留“当前通知”列表以向用户显示，并在用户从 UI 中清除它们时将其删除。

# delphi - 如何在 win32pipe/console 上“窥探”？

> ID：810433
> 
> 赞同：2
> 
> 时间：2009-05-01T06:48:06.387
> 
> 标签：delphi, winapi, console, spying

我有一个应用程序，它调用另一个控制台应用程序并向它传递一些参数（控制台应用程序是一个视频/音频转换应用程序）.​​.....有没有办法以编程方式“间谍”或捕获传递的参数，而不是挂钩/监控 shellexecute/创建线程等？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T08:03:47.687

自己创建一个可执行文件，它只调用原始文件并将所有参数传递给它。然后将原件移到其他地方并用您的exe替换它。然后，您的程序可以记录对其的所有调用，包括所有参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T13:50:24.093

是的，有——当您编写 Process Explorer 时，它能够做到这一点，并且您可以使用相同的技术。但是 AFAIK 没有来自 Platform SDK 的*winternl.h*文件的 Delphi 翻译，因此更加繁琐和困难。这也是非常特定于版本的，并且有可能会在下一个 Windows 版本中中断。这是否适用于 64 位进程（来自 32 位进程）也不是很清楚。

如果您真的想这样做，您将在[Matt Pietrek 的这篇博客文章](http://blogs.msdn.com/matt_pietrek/archive/2004/08/25/220330.aspx)和 CodeProject 文章“[读取远程进程的环境字符串](http://www.codeproject.com/KB/threads/ReadProcEnv.aspx)”中找到必要的信息。

如果您不打算将它用于封闭源代码的商业程序，那么查看 ReactOS 项目中带有注释的（GPL 许可的）[*winternl.h*](http://www.reactos.org/generated/doxygen/db/d05/winternl_8h-source.html)[文件版本](http://www.reactos.org/generated/doxygen/db/d05/winternl_8h-source.html)*可能也会有所帮助。*

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T09:01:25.147

这是自 1992 年以来的 Win32 常见问题解答：只需阅读 PEB。
参见[Win32 专家组](http://groups.google.com/group/comp.os.ms-windows.programmer.win32/topics?lnk=srg)。

# javascript - 在 RoR 中，如何动态显示和限制允许的字符数？

> ID：810441
> 
> 赞同：0
> 
> 时间：2009-05-01T06:52:12.663
> 
> 标签：javascript, ruby-on-rails

例如，SO 中的注释显示了允许的剩余字符数。基本上，我如何在 ruby​​ on rails 中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T07:23:21.450

正如评论中提到的，这可以在 JavaScript 端完成。

此页面提供了很好解释的示例：[使用 jQuery 的 textarea 的交互式字符限制](http://www.ajaxray.com/blog/2007/11/09/interactive-character-limit-for-textarea-using-jquery/)（它还包含一个不使用 jQuery 的示例）。

# c# - 在 C# 中确定未修剪的字符串是否为空的最有效方法是什么？

> ID：810442
> 
> 赞同：14
> 
> 时间：2009-05-01T06:53:15.657
> 
> 标签：c#, performance, optimization, coding-style, string

我有一个字符串，它周围可能有空格字符，我想检查它是否基本上是空的。

有很多方法可以做到这一点：

```
1  if (myString.Trim().Length == 0)
2  if (myString.Trim() == "")
3  if (myString.Trim().Equals(""))
4  if (myString.Trim() == String.Empty)
5  if (myString.Trim().Equals(String.Empty)) 
```

我知道这通常是过早优化的明显案例，但我很好奇，并且有可能这样做足以对性能产生影响。

**那么，哪一个是最有效的方法呢？**

**有没有更好的方法我没有想到？**

* * *

**编辑：**此问题的访问者注意事项：

1.  已经对这个问题进行了一些非常详细的调查——尤其是来自 Andy 和 Jon Skeet。

2.  如果您在搜索某些内容时偶然发现了这个问题，那么至少完整阅读 Andy 和 Jon 的帖子是非常值得的。

似乎有一些非常有效的方法，*最*有效的取决于我需要处理的字符串的内容。

如果我不能预测字符串（在我的情况下我不能），Jon 的`IsEmptyOrWhiteSpace`方法通常似乎更快。

感谢大家的意见。我将选择安迪的答案作为“正确”答案，仅仅是因为他付出的努力值得声誉提升，而乔恩已经拥有 1100 亿的声誉。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-01T07:03:31.513

**编辑：新测试：**

```
Test orders:
x. Test name
Ticks: xxxxx //Empty String
Ticks: xxxxx //two space
Ticks: xxxxx //single letter
Ticks: xxxxx //single letter with space
Ticks: xxxxx //long string
Ticks: xxxxx //long string  with space

1\. if (myString.Trim().Length == 0)
ticks: 4121800
ticks: 7523992
ticks: 17655496
ticks: 29312608
ticks: 17302880
ticks: 38160224

2\.  if (myString.Trim() == "")
ticks: 4862312
ticks: 8436560
ticks: 21833776
ticks: 32822200
ticks: 21655224
ticks: 42358016

3\.  if (myString.Trim().Equals(""))
ticks: 5358744
ticks: 9336728
ticks: 18807512
ticks: 30340392
ticks: 18598608
ticks: 39978008

4\.  if (myString.Trim() == String.Empty)
ticks: 4848368
ticks: 8306312
ticks: 21552736
ticks: 32081168
ticks: 21486048
ticks: 41667608

5\.  if (myString.Trim().Equals(String.Empty))
ticks: 5372720
ticks: 9263696
ticks: 18677728
ticks: 29634320
ticks: 18551904
ticks: 40183768

6\.  if (IsEmptyOrWhitespace(myString))  //See John Skeet's Post for algorithm
ticks: 6597776
ticks: 9988304
ticks: 7855664
ticks: 7826296
ticks: 7885200
ticks: 7872776

7\. is (string.IsNullOrEmpty(myString.Trim())  //Cloud's suggestion
ticks: 4302232
ticks: 10200344
ticks: 18425416
ticks: 29490544
ticks: 17800136
ticks: 38161368 
```

并且使用的代码：

```
public void Main()
{

    string res = string.Empty;

    for (int j = 0; j <= 5; j++) {

        string myString = "";

        switch (j) {

            case 0:
                myString = "";
                break;
            case 1:
                myString = "  ";
                break;
            case 2:
                myString = "x";
                break;
            case 3:
                myString = "x ";
                break;
            case 4:
                myString = "this is a long string for testing triming empty things.";
                break;
            case 5:
                myString = "this is a long string for testing triming empty things. ";

                break;
        }

        bool result = false;
        Stopwatch sw = new Stopwatch();

        sw.Start();
        for (int i = 0; i <= 100000; i++) {

            result = myString.Trim().Length == 0;
        }
        sw.Stop();

        res += "ticks: " + sw.ElapsedTicks + Environment.NewLine;
    }

    Console.ReadKey();  //break point here to get the results
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-01T06:59:38.043

（编辑：有关该方法的不同微优化的基准，请参见帖子底部）

不要修剪它 - 这可能会创建一个您实际上不需要的新字符串。相反，请在字符串中查找任何*不是*空格的字符（对于您想要的任何定义）。例如：

```
public static bool IsEmptyOrWhitespace(string text)
{
    // Avoid creating iterator for trivial case
    if (text.Length == 0)
    {
        return true;
    }
    foreach (char c in text)
    {
        // Could use Char.IsWhiteSpace(c) instead
        if (c==' ' || c=='\t' || c=='\r' || c=='\n')
        {
            continue;
        }
        return false;
    }
    return true;
} 
```

`text`如果is ，您可能还会考虑您希望该方法执行的操作`null`。

可能的进一步微优化实验：

*   `foreach`比使用`for`下面的循环更快还是更慢？请注意，使用`for`循环，您可以在开始时删除“ `if (text.Length==0)`”测试。

    ```
    for (int i = 0; i < text.Length; i++)
    {
        char c = text[i];
        // ... 
    ```

*   与上述相同，但要提升`Length`呼叫。请注意，这*对*普通数组不利，但*可能*对字符串有用。我没有测试过。

    ```
    int length = text.Length;
    for (int i = 0; i < length; i++)
    {
        char c = text[i]; 
    ```

*   在循环的主体中，我们所拥有的和：

    ```
    if (c != ' ' && c != '\t' && c != '\r' && c != '\n')
    {
        return false;
    } 
    ```

*   开关/机箱会更快吗？

    ```
    switch (c)
    {
        case ' ': case '\r': case '\n': case '\t':
            return false;               
    } 
    ```

**更新修剪行为**

我一直在研究如何`Trim`能像这样高效。似乎`Trim`只有在需要时才会创建一个新字符串。如果它可以返回`this`或`""`它将：

```
using System;

class Test
{
    static void Main()
    {
        CheckTrim(string.Copy(""));
        CheckTrim("  ");
        CheckTrim(" x ");
        CheckTrim("xx");
    }

    static void CheckTrim(string text)
    {
        string trimmed = text.Trim();
        Console.WriteLine ("Text: '{0}'", text);
        Console.WriteLine ("Trimmed ref == text? {0}",
                          object.ReferenceEquals(text, trimmed));
        Console.WriteLine ("Trimmed ref == \"\"? {0}",
                          object.ReferenceEquals("", trimmed));
        Console.WriteLine();
    }
} 
```

这意味着这个问题中的任何基准测试都应该使用混合数据非常重要：

*   空字符串
*   空白
*   文本周围的空格
*   没有空格的文本

当然，这四者之间的“现实世界”平衡是无法预测的……

**基准** 我对原始建议与我的建议进行了一些基准测试，我的似乎在我投入的所有内容中都获胜，考虑到其他答案的结果，这让我感到惊讶。但是，我还对`foreach`、`for`using `text.Length`、`for`using`text.Length`一次然后反转迭代顺序和`for`提升长度之间的差异进行了基准测试。

基本上，`for`循环稍微快一点，但提升长度检查使其比`foreach`. 反转`for`循环方向比`foreach`太慢一点。我强烈怀疑 JIT 在这里做了一些有趣的事情，比如删除重复的边界检查等。

代码：（请参阅[我的基准测试博客条目](http://msmvps.com/blogs/jon_skeet/archive/2009/01/26/benchmarking-made-easy.aspx)，了解针对此编写的框架）

```
using System;
using BenchmarkHelper;

public class TrimStrings
{
    static void Main()
    {
        Test("");
        Test(" ");
        Test(" x ");
        Test("x");
        Test(new string('x', 1000));
        Test(" " + new string('x', 1000) + " ");
        Test(new string(' ', 1000));
    }

    static void Test(string text)
    {
        bool expectedResult = text.Trim().Length == 0;
        string title = string.Format("Length={0}, result={1}", text.Length, 
                                     expectedResult);

        var results = TestSuite.Create(title, text, expectedResult)
/*            .Add(x => x.Trim().Length == 0, "Trim().Length == 0")
            .Add(x => x.Trim() == "", "Trim() == \"\"")
            .Add(x => x.Trim().Equals(""), "Trim().Equals(\"\")")
            .Add(x => x.Trim() == string.Empty, "Trim() == string.Empty")
            .Add(x => x.Trim().Equals(string.Empty), "Trim().Equals(string.Empty)")
*/
            .Add(OriginalIsEmptyOrWhitespace)
            .Add(IsEmptyOrWhitespaceForLoop)
            .Add(IsEmptyOrWhitespaceForLoopReversed)
            .Add(IsEmptyOrWhitespaceForLoopHoistedLength)
            .RunTests()                          
            .ScaleByBest(ScalingMode.VaryDuration);

        results.Display(ResultColumns.NameAndDuration | ResultColumns.Score,
                        results.FindBest());
    }

    public static bool OriginalIsEmptyOrWhitespace(string text)
    {
        if (text.Length == 0)
        {
            return true;
        }
        foreach (char c in text)
        {
            if (c==' ' || c=='\t' || c=='\r' || c=='\n')
            {
                continue;
            }
            return false;
        }
        return true;
    }

    public static bool IsEmptyOrWhitespaceForLoop(string text)
    {
        for (int i=0; i < text.Length; i++)
        {
            char c = text[i];
            if (c==' ' || c=='\t' || c=='\r' || c=='\n')
            {
                continue;
            }
            return false;
        }
        return true;
    }

    public static bool IsEmptyOrWhitespaceForLoopReversed(string text)
    {
        for (int i=text.Length-1; i >= 0; i--)
        {
            char c = text[i];
            if (c==' ' || c=='\t' || c=='\r' || c=='\n')
            {
                continue;
            }
            return false;
        }
        return true;
    }

    public static bool IsEmptyOrWhitespaceForLoopHoistedLength(string text)
    {
        int length = text.Length;
        for (int i=0; i < length; i++)
        {
            char c = text[i];
            if (c==' ' || c=='\t' || c=='\r' || c=='\n')
            {
                continue;
            }
            return false;
        }
        return true;
    }
} 
```

结果：

```
============ Length=0, result=True ============
OriginalIsEmptyOrWhitespace             30.012 1.00
IsEmptyOrWhitespaceForLoop              30.802 1.03
IsEmptyOrWhitespaceForLoopReversed      32.944 1.10
IsEmptyOrWhitespaceForLoopHoistedLength 35.113 1.17

============ Length=1, result=True ============
OriginalIsEmptyOrWhitespace             31.150 1.04
IsEmptyOrWhitespaceForLoop              30.051 1.00
IsEmptyOrWhitespaceForLoopReversed      31.602 1.05
IsEmptyOrWhitespaceForLoopHoistedLength 33.383 1.11

============ Length=3, result=False ============
OriginalIsEmptyOrWhitespace             30.221 1.00
IsEmptyOrWhitespaceForLoop              30.131 1.00
IsEmptyOrWhitespaceForLoopReversed      34.502 1.15
IsEmptyOrWhitespaceForLoopHoistedLength 35.690 1.18

============ Length=1, result=False ============
OriginalIsEmptyOrWhitespace             31.626 1.05
IsEmptyOrWhitespaceForLoop              30.005 1.00
IsEmptyOrWhitespaceForLoopReversed      32.383 1.08
IsEmptyOrWhitespaceForLoopHoistedLength 33.666 1.12

============ Length=1000, result=False ============
OriginalIsEmptyOrWhitespace             30.177 1.00
IsEmptyOrWhitespaceForLoop              33.207 1.10
IsEmptyOrWhitespaceForLoopReversed      30.867 1.02
IsEmptyOrWhitespaceForLoopHoistedLength 31.837 1.06

============ Length=1002, result=False ============
OriginalIsEmptyOrWhitespace             30.217 1.01
IsEmptyOrWhitespaceForLoop              30.026 1.00
IsEmptyOrWhitespaceForLoopReversed      34.162 1.14
IsEmptyOrWhitespaceForLoopHoistedLength 34.860 1.16

============ Length=1000, result=True ============
OriginalIsEmptyOrWhitespace             30.303 1.01
IsEmptyOrWhitespaceForLoop              30.018 1.00
IsEmptyOrWhitespaceForLoopReversed      35.475 1.18
IsEmptyOrWhitespaceForLoopHoistedLength 40.927 1.36 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-01T06:56:55.727

我真的不知道哪个更快；虽然我的直觉说第一。但这里有另一种方法：

```
if (String.IsNullOrEmpty(myString.Trim())) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-01T07:08:42.890

**myString.Trim().Length == 0**耗时：421 毫秒

**myString.Trim() == '' 耗时：** 468 毫秒

**if (myString.Trim().Equals("")) 耗时：** 515 毫秒

**if (myString.Trim() == String.Empty)**耗时：484 毫秒

**if (myString.Trim().Equals(String.Empty))**耗时：500 毫秒

**if (string.IsNullOrEmpty(myString.Trim()))**耗时：437 毫秒

在我的测试中，它看起来像 myString.Trim().Length == 0 并且令人惊讶的是， string.IsNullOrEmpty(myString.Trim()) 一直是最快的。上面的结果是进行 10,000,000 次比较的典型结果。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-01T06:57:22.963

检查字符串的长度是否为零是测试空字符串的最有效方法，所以我会说数字 1：

```
if (myString.Trim().Length == 0) 
```

进一步优化这一点的唯一方法可能是通过使用编译的正则表达式来避免修剪（编辑：这实际上比使用 Trim().Length 慢得多）。

编辑：使用 Length 的建议来自 FxCop 指南。我也刚刚对其进行了测试：它比空字符串快 2-3 倍。然而，这两种方法仍然非常快（我们说的是纳秒） - 所以你使用哪一种并不重要。修剪更像是一个瓶颈，它比最后的实际比较慢数百倍。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-11-07T13:37:05.050

[.NET 4 Beta 2 中的 String.IsNullOrWhitespace](http://codebetter.com/blogs/patricksmacchia/archive/2009/10/21/interesting-findings-in-the-diff-between-net-fx-v4-beta1-and-beta2.aspx) 也在这个空间中发挥作用，不需要自定义编写

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-01T07:13:11.430

由于我刚开始，我无法发表评论，所以在这里。

```
if (String.IsNullOrEmpty(myString.Trim())) 
```

`Trim()`如果 myString 为 null，则调用将失败，因为您无法调用为 null ( [NullReferenceException](http://msdn.microsoft.com/en-us/library/system.nullreferenceexception.aspx) ) 的对象中的方法。

所以正确的语法应该是这样的：

```
if (!String.IsNullOrEmpty(myString))
{
    string trimmedString = myString.Trim();
    //do the rest of you code
}
else
{
    //string is null or empty, don't bother processing it
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-27T04:12:36.090

```
public static bool IsNullOrEmpty(this String str, bool checkTrimmed)
{
  var b = String.IsNullOrEmpty(str);
  return checkTrimmed ? b && str.Trim().Length == 0 : b;
} 
```

# delphi - 如何正确显示日文 RTF 字体

> ID：810445
> 
> 赞同：5
> 
> 时间：2009-05-01T06:54:44.157
> 
> 标签：delphi, unicode, fonts, rtf

我正在开发 Delphi 2009 中的一个应用程序，它大量使用 RTF，使用 TRichEdit 和 TLMDRichEdit 进行编辑。在这些 RTF 控件中输入日文文本的用户一直在提交关于在安装了东方语言支持的 Win XP 和 Vista 上重新加载内容时日文文本显示为乱码的间歇性报告。

通常情况下，英语和日语是混合的，并且大部分显示都没有问题，例如：

```
Inventory turns partnerships.  在庫回転率の 
```

（如果日语文本被错误地破坏，我深表歉意 - 我不会说或读这种语言）。

然而，很多时候，只有文本的日文部分会乱码，例如：

```
ŒÉñ?“]-¦Œüã‚Ì·•Ê‰?-vˆö‚ðŽû‰v‚ÉŒø‰?“I‚ÉŒ‹‚Ñ‚Â‚¯‚é’mŽ¯‚ª‘÷Ý‚·‚é?(マーケットセクター、
見込み客の優  先順位と彼らに販売する知識) 
```

从广泛的在线搜索来看，问题似乎是作为 RTF 的一部分保存的字体造成的。日文版 Windows 上显示的字体不一定与美国英文版相同。可以以编程方式替换 RTF 文件中的字体，这会产生几乎可以接受的结果，即

```
-D‚‚ｽƒIƒyƒŒ[ƒVƒ・“‚ﾆƒƒWƒXƒeƒBƒbƒN‚ﾌƒpƒtƒH[ƒ}ƒ“ƒX‚-˜‰v‚ﾉŒ‹‚ﾑ‚ﾂ‚ｯ‚ﾈ‚｢‚±ﾆ‚ﾍ?A‘‚｢‚ﾉ-ｳ‘ﾊ‚ﾅ‚ ‚驕B‚ｻ‚‚ﾍAl“ｾ‚ｵ‚ｽ・‘P‚ﾌˆﾛ‚ƒƒXƒN‚ﾉ‚ｳ‚‚ｷB 
```

但是，其中仍有不少“垃圾”字符无法正确识别为日文字符。查看原始 RTF，您将看到以下内容：

```
-D\'82\'82\u65405?\'83I\'83y\'83\'8c[\'83V\'83\u12539?\ldblquote\'82\u65414? 
```

显然，Unicode 字符被正确呈现，但例如 \'82\'82 对字符应该是别的东西吗？我的猜测是它实际上代表了某种双字节字符，出于某种神秘的原因，它被编码为两个单独的字符而不是单个 Unicode 字符。

是否有一种通用的（相对）万无一失的方法来获取包含东方语言的 RTF 并再次可靠地显示它？

*为了完整起见，我按以下方式更新了 RTF 字体表：*

 **   替换了字体名称“?l?r ?o?S?V?b?N;” 与“\'82\'6c\'82\'72\'82\'6f\'83\'53\'83\'56\'83\'62\'83\'4e;”
*   通过将“\froman\fprq1\fcharset0”替换为“\fnil\fprq1\fcharset128”来更新字体名称
*   通过将“\froman\fprq1\fcharset238”替换为“\fnil\fprq1\fcharset128”来更新字体名称
*   通过将“\froman\fprq1”替换为“\fnil\fprq1\fcharset128”来更新字体名称
*   替换字体名称“?? ?????;” 与“\'82\'6c\'82\'72\'82\'6f\'83\'53\'83\'56\'83\'62\'83\'4e;”*  *更新：单独更新字体名称不会产生影响。语言环境似乎是个大问题。我已经看到一些网站讨论如何将日文 RTF 的显示转换为大多数读者可以处理的内容，但我还没有找到解决方案，例如： [here](http://bbs.wankuma.com/index.cgi?mode=al2&namber=6185&KLOG=6)和[here](http://www.bekkoame.ne.jp/~n-iyanag/nisus/tips/macRTFtoWin.html)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T09:12:20.067

我的猜测是，更改 RTF 中的字体名称可能会使事情变得更糟。如果 RTF 中指定的字体不是 Unicode 字体，那么在该字体中渲染的字符肯定会被编码为 Shift-JIS，而不是 Unicode。文本中的其他字符也是如此。因此，将整个事物视为 Unicode，或附加 Unicode 文本，将导致您看到的损坏。您需要确定您导入的 RTF 是编码为 Shift-JIS 还是 Unicode，以及您正在运行的机器（以及因此 D2009 默认输入格式）是否为日语。在日本，如果文本文件没有 Unicode BOM，它通常是 Shift-JIS（但并非总是如此）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T23:05:46.520

我看到了类似的东西，但不是日文字体。只是特殊字符，如微（如微升）和上标。问题是即使我从 ASP.NET 网页发送给用户的 RTF 字符串是正确的（我可以看到使用 Fiddler2 编码的 RTF 流），当 MS Word 实际打开 RTF 时，它添加了一堆垃圾转义类似于我在您的示例中看到的代码。

我所做的是通过一个转换例程运行整个 RTF 文本，该例程将 ascii 127 上的所有字符交换为其特殊的 unicode 点等价物。所以我会得到类似 \uc1\u181 的东西？(micro) 用于特殊字符。当我这样做时，Word 能够毫无问题地打开文件。具有讽刺意味的是，它重新编码了 \uc1\uxxx? 回到他们的 RTF 转义等价物。

```
Private Function ConvertRtfToUnicode(ByVal value As String) As String

    Dim ch As Char() = value.ToCharArray()
    Dim c As Char
    Dim sb As New System.Text.StringBuilder()
    Dim code As Integer

    For i As Integer = 0 To ch.Length - 1
        c = ch(i)
        code = Microsoft.VisualBasic.AscW(c)
        If code <= 127 Then
            'Don't need to replace if one of your typical ASCII codes
            sb.Append(c)
        Else
            'MR: Basic idea came from here http://www.eggheadcafe.com/conversation.aspx?messageid=33935981&threadid=33935972
            '  swaps the character for it's Unicode decimal code point equivalent
            sb.Append(String.Format("\uc1\u{0:d}?", code))
        End If
    Next

    Return sb.ToString()

End Function 
```

不确定这是否会帮助您解决问题，但它对我有用。

# sql - MySQL中获得最佳结果的通用方法

> ID：810446
> 
> 赞同：1
> 
> 时间：2009-05-01T06:55:15.653
> 
> 标签：sql, mysql

比如说我有一张桌子，上面有人名和他们的年龄。我想要一个 MySQL 中的通用查询，它将拉出 n 个最老的人。

我可以使用这样的东西：

```
SELECT * FROM people ORDER BY age DESC LIMIT 1; 
```

假设弗兰克和艾米丽都 99 岁了。`limit 1`只会返回他们的名字之一。在 psuedo-sql 中，我希望查询看起来像这样：

```
SELECT * FROM people WHERE MAX(age); 
```

我知道您也可以使用子查询来做到这一点，但必须有一种更简单、更通用的方法来实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T06:58:55.237

不，是子查询。例如，年龄排名前 3 的所有人：

```
SELECT * FROM people WHERE age IN (SELECT DISTINCT age FROM people ORDER BY age DESC LIMIT 3) 
```

或只是最高年龄：

```
SELECT * FROM people WHERE age = (SELECT MAX(age) FROM people) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T06:59:53.550

> 我知道您也可以使用子查询来做到这一点，但必须有一种更简单、更通用的方法来实现这一点？

不在 ANSI SQL 中。

```
SELECT * FROM people WHERE age = 
  (select MAX(age) from people); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-02T04:24:48.510

@cletus -

```
SELECT * 
FROM people 
WHERE age IN (SELECT DISTINCT age 
              FROM people 
              ORDER BY age DESC LIMIT 3) 
```

LIMIT 在 MySQL 的子查询中不起作用。

# oracleportal - 如何从 Oracle Porta HTML Page Skin 的 url 获取请求参数？

> ID：810453
> 
> 赞同：0
> 
> 时间：2009-05-01T06:58:58.607
> 
> 标签：oracleportal

我希望这里的任何 Oracle Portal 专家都可以帮助我解决这个问题。

我有一个使用 HTML 页面皮肤的门户模板/页面。皮肤可能看起来像：

```
<html>
<head>
<title>#TITLE#</title>
</head>
<body>
#BODY#
</body>
</html> 
```

通过使用 Oracle Portal，我可以将 portlet（PL/SQL 和 Java portlet）添加到正文部分的相应模板/页面中。然而，据我所知，这不可能让我将 portlet 添加到 HTML Skin 中的其他部分，例如 section。

我需要使用从页面 URL 和查询字符串中获得的一些值来动态更改标题。

例如。如果页面的 url 是**[http://www.example.com/portal/page/portal/examplepagegroup/page1?param1=paramvalue](http://www.example.com/portal/page/portal/examplepagegroup/page1?param1=paramvalue)** ，那么标题将是“ *param1* ”，并且应该在没有javascript技术的情况下完成。

我怎样才能从 URL 中获取请求参数 param1 以便它可以用于 head 部分？我正在考虑在这里使用 PL/SQL 代码，但是，我不知道如何访问当前页面的查询字符串。

如果需要澄清问题，请在此处发表评论。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T19:55:32.587

页面标题是 Portal 页面的静态属性。不支持 portlet 在运行时动态更改页面标题的方式。呈现引擎将来自每个 portlet 的 HTML 与它自己构建的一些 HTML 结合起来，并且标题是呈现器构建的内容的一部分。

可以通过调用 WWSBR_API.ADD_FOLDER 动态构建具有特定名称的页面（文件夹与页面相同）。请参阅所以您的 portlet 可以构建一个页面，然后重定向到它。

[您可以在http://www.oracle.com/technology/products/ias/portal/html/plsqldoc/pldoc1014/index.html](http://www.oracle.com/technology/products/ias/portal/html/plsqldoc/pldoc1014/index.html)找到 Portal 10.1.4 API

# .net - 异常处理机制如何在.net 中真正起作用？

> ID：810454
> 
> 赞同：3
> 
> 时间：2009-05-01T06:59:01.180
> 
> 标签：.net, exception-handling

我想知道，异常处理机制实际上是如何在.net 中工作的？

只想知道，内部运行时会发生什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T07:04:20.590

CLR 在内部使用 Windows 的结构化异常处理。有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/ms680657(VS.85).aspx 。](http://msdn.microsoft.com/en-us/library/ms680657(VS.85).aspx)

您可能还会发现 Jeffrey Ricther 通过 C# 在 CLR 中的描述很有用。

# c# - 如何创建一个简单的示例控制台应用程序来为测试驱动开发开发单独的类？

> ID：810465
> 
> 赞同：1
> 
> 时间：2009-05-01T07:04:13.913
> 
> 标签：c#, unit-testing, logging, nunit, log4net

我的目的是创建一个简单、易于调试的控制台应用程序，它将作为 C# 中测试驱动开发单个类的模板（或起点）。目的是有一个简单的文件夹，这个控制台应用程序将驻留，只需复制粘贴文件夹打开新项目并开始编写新类。一旦测试了类的所有功能（最好测试应该在同一个文件（或至少命名空间）中），该类将被允许进入更大的项目。我正在使用 NUnit 和 log4net。如果你这样做“小型测试驱动单元构建”方法您是如何实现的。请发布一些代码或解释。如果您不使用，请提供解释为什么？这是代码（配置数据也粘贴为注释...）

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using log4net;
using log4net.Config;
using NUnit.Framework;

namespace NUnitSimple
{

  class TheClassToTest_Substractor
  {

    private static readonly ILog logger =
         LogManager.GetLogger ( typeof ( TheClassToTest_Substractor ) );

    public static void Substract ( int intToSusbractFrom , int intToSubstract , ref int intTheResult)
    {
     intTheResult = intToSusbractFrom - intToSubstract ; 
    }

    static void Main ( string[] args )
    {
      DOMConfigurator.Configure (); //tis configures the logger 

      logger.Info ( " START " );
      logger.Info ( " Hit a key to exit " );
      Console.ReadLine ();

    } //eof method 

  } //eof class 

  [TestFixture]//telling NUnit that this class contains test functions 
public class TestTheClassToTest_Substractor
{ 

     [Test]//telling NUnit that this function should be run during the tests 
    public void TestSubstractOk() 
    { 
       int intToSusbractFrom = 10 ; 
       int intToSubstract = 4 ; 
        int intTheResult = 0 ;
       TheClassToTest_Substractor.Substract ( intToSusbractFrom , intToSubstract , ref intTheResult ) ;
        Assert.AreEqual (  6 , intTheResult);
    }

     [Test]//telling NUnit that this function should be run during the tests 
     public void TestSubstractNOK ()
     {
       int intToSusbractFrom = 10;
       int intToSubstract = 4;
       int intTheResult = 0;
       TheClassToTest_Substractor.Substract ( intToSusbractFrom, intToSubstract, ref intTheResult );
       Assert.AreNotEqual ( 3, intTheResult );
     }

} //eof class 

} //eof namespace 

#region TheAppConfig
/*
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <configSections>
    <section name="log4net"
         type="log4net.Config.Log4NetConfigurationSectionHandler, log4net" />
  </configSections>
  <log4net>
    <appender name="LogFileAppender" type="log4net.Appender.FileAppender">
      <param name="File" value="Program.log" />
      <param name="AppendToFile" value="true" />
      <layout type="log4net.Layout.PatternLayout">
        <param name="Header" value="[Header] \r\n" />
        <param name="Footer" value="[Footer] \r\n" />
        <param name="ConversionPattern" value="%d [%t] %-5p %c %m%n" />
      </layout>
    </appender>

    <appender name="ColoredConsoleAppender" type="log4net.Appender.ColoredConsoleAppender">
      <mapping>
        <level value="ERROR" />
        <foreColor value="White" />
        <backColor value="Red, HighIntensity" />
      </mapping>
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline" />
      </layout>
    </appender>

    <appender name="AdoNetAppender" type="log4net.Appender.AdoNetAppender">
      <connectionType value="System.Data.SqlClient.SqlConnection, System.Data, Version=1.2.10.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
      <connectionString value="data source=ysg;initial catalog=DBGA_DEV;integrated security=true;persist security info=True;" />
      <commandText value="INSERT INTO [DBGA_DEV].[ga].[tb_Data_Log] ([Date],[Thread],[Level],[Logger],[Message]) VALUES (@log_date, @thread, @log_level, @logger, @message)" />

      <parameter>
        <parameterName value="@log_date" />
        <dbType value="DateTime" />
        <layout type="log4net.Layout.PatternLayout" value="%date{yyyy'-'MM'-'dd HH':'mm':'ss'.'fff}" />
      </parameter>
      <parameter>
        <parameterName value="@thread" />
        <dbType value="String" />
        <size value="255" />
        <layout type="log4net.Layout.PatternLayout" value="%thread" />
      </parameter>
      <parameter>
        <parameterName value="@log_level" />
        <dbType value="String" />
        <size value="50" />
        <layout type="log4net.Layout.PatternLayout" value="%level" />
      </parameter>
      <parameter>
        <parameterName value="@logger" />
        <dbType value="String" />
        <size value="255" />
        <layout type="log4net.Layout.PatternLayout" value="%logger" />
      </parameter>
      <parameter>
        <parameterName value="@message" />
        <dbType value="String" />
        <size value="4000" />
        <layout type="log4net.Layout.PatternLayout" value="%messag2e" />
      </parameter>
    </appender>
    <root>
      <level value="INFO" />
      <appender-ref ref="LogFileAppender" />
      <appender-ref ref="AdoNetAppender" />
      <appender-ref ref="ColoredConsoleAppender" />
    </root>
  </log4net>
</configuration>
 */
#endregion TheAppconfig

#region TheXmlReferingToTheNUnitAndLog4NetInNUnitSimple.csprojFile
/*
     <Reference Include="log4net, Version=1.2.10.0, Culture=neutral, PublicKeyToken=1b44e1d426115821, processorArchitecture=MSIL">
      <SpecificVersion>False</SpecificVersion>
      <HintPath>..\..\..\Log4Net\log4net-1.2.10\bin\net\2.0\release\log4net.dll</HintPath>
    </Reference>
    <Reference Include="nunit.framework, Version=2.4.8.0, Culture=neutral, PublicKeyToken=96d09a1eb7f44a77, processorArchitecture=MSIL" />
 */
#endregion 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T07:20:14.767

与其建立一个项目然后剪切和粘贴，不如看看像[Tree Surgeon](http://treesurgeon.codeplex.com/)这样的脚本工具来建立一个项目结构。这将设置您的解决方案、项目和项目文件夹。它包括 nUnit 和 nAnt 的功能。

请务必查看项目主页底部镜像的博客文章。

顺便说一句：我同意 Jon Skeet 关于控制台应用程序的观点。它们可能很有用，但是如果您有像[TestDriven.Net](http://www.testdriven.net/)这样的工具，用于 VS.2005 和更早版本，或者 VS.2008 测试工具，您可以在不创建自己的工具应用程序的情况下单步执行您的测试代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T07:11:47.237

我真的不明白在现有项目中包含新类、在现有测试项目中包含新测试类并在那里运行测试有什么好处。

为什么要引入控制台应用程序？您真的需要从控制台应用程序而不是现有的测试运行器之一运行测试吗？（不要误会我的意思，我是控制台应用程序的忠实粉丝 - 我只是不明白它们如何适合这里。）

# ruby-on-rails - 推荐的方式或插件为 ruby on rails 应用程序创建谷歌站点地图？

> ID：810478
> 
> 赞同：3
> 
> 时间：2009-05-01T07:11:40.853
> 
> 标签：ruby-on-rails, seo

我做了一个快速的谷歌搜索，并没有看到任何超级棒的东西可以自动创建和更新我的 ruby​​ on rails 应用程序的谷歌站点地图。有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T12:08:59.797

我真的不建议使用控制器并像'/sitemap.xml'那样简单地路由到它，因为如果您的站点地图会增长，它将浪费资源。最好每晚左右执行一个 rake 任务并重新生成站点地图，具体取决于内容更改的频率。

如果您的网站没有接近 50000 个页面并且您不打算拥有更多页面，那么您可以放入一个站点地图文件，那么我建议您使用“ [Google Sitemaps with Ruby on Rails、Capistrano 和 Cron](http://harrylove.org/2008/06/10/google-sitemaps-with-ruby-on-rails-capistrano-and-cron) ”我知道它工作得很好因为我成功地使用了它。

**注意：**我不建议每次运行部署任务时都使用作者复制站点地图的方式，在我看来这并不干净。最好在部署时使用共享目录和符号链接，那么您将确保只有一个版本的文件，如果留下额外的副本，现在会浪费空间。我的 deploy.rb 中有这个：

```
desc "Symlink the upload directories"
task :before_symlink do
  run "rm -drf #{release_path}/public/sitemaps"
  run "ln -s #{shared_path}/sitemaps #{release_path}/public/sitemaps"
end 
```

您也可以使用“[大站点地图](http://github.com/alexrabarts/big_sitemap/tree/master)”gem，但我刚刚找到它，无法告诉您它有多好。看起来设置这个 gem 真的很容易，它还使用你的 rails 路由来生成链接，所以你要解决的问题比第一个解决方案少。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T12:42:30.357

我最近在博客应用程序中添加了一个动态站点地图。这些步骤应该可以帮助您入门。

将此路线添加到文件底部`config/routes.rb`（更具体的路线应在其上方列出）：

```
map.sitemap '/sitemap.xml', :controller => 'sitemap' 
```

创建`SitemapController`（app/controllers/sitemap_controller）：

```
class SitemapController < ApplicationController
  layout nil

  def index
    headers['Content-Type'] = 'application/xml'
    last_post = Post.last
    if stale?(:etag => last_post, :last_modified => last_post.updated_at.utc)
      respond_to do |format|
        format.xml { @posts = Post.sitemap } # sitemap is a named scope
      end
    end
  end
end 
```

——如您所见，这是用于博客的，使用`Post`模型也是如此。

这是视图模板（app/views/sitemap/index.xml.builder）：

```
base_url = "http://#{request.host_with_port}"
xml.instruct! :xml, :version=>'1.0'
xml.tag! 'urlset', 'xmlns' => 'http://www.sitemaps.org/schemas/sitemap/0.9' do
  for post in @posts do
    xml.tag! 'url' do
      xml.tag! 'loc', "#{base_url}#{post.permalink}"
      xml.tag! 'lastmod', post.last_modified
      xml.tag! 'changefreq', 'monthly'
      xml.tag! 'priority', '0.5'
    end
  end
end 
```

就是这样！您可以通过在浏览器中打开[http://localhost:3000/sitemap.xml](http://localhost:3000/sitemap.xml)（如果使用 Mongrel）或使用 cURL 来测试它。

请注意，`stale?`如果自上次请求站点地图以来没有新帖子，控制器将使用该方法发出 HTTP 304 Not Modified 响应。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-15T03:33:30.177

Google 站点地图生成器是 Google 的正式版本。它易于设置和配置。

[http://code.google.com/p/googlesitemapgenerator/](http://code.google.com/p/googlesitemapgenerator/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-01T18:35:54.817

我建议您查看[sitemap_generator gem](http://github.com/kjvarga/sitemap_generator)。它为您处理所有这些问题……而且，真的，谁愿意在编写 XML 时搞乱？

下面是一个示例站点地图，展示了如何使用 Rails 模型和路径助手生成站点地图 URL：

```
# config/sitemap.rb
SitemapGenerator::Sitemap.default_host = "http://www.example.com"
SitemapGenerator::Sitemap.create do
  add '/contact_us'
  Content.find_each do |content|
    add content_path(content), :lastmod => content.updated_at
  end
end 
```

然后，您可以根据需要使用 Rake 任务刷新。真的就是这么简单:)

# macos - 无法通过 Mac 中的 termcap 关闭自动边距

> ID：810483
> 
> 赞同：0
> 
> 时间：2009-05-01T07:14:04.827
> 
> 标签：macos, terminal, margins, termcap

我需要根据我 Mac 中 Screen 手册中的以下语句关闭自动边距

> 如果您的终端是“真正的”自动边距终端（它不允许在不滚动屏幕的情况下更新屏幕上的最后一个位置），请考虑使用关闭了自动边距的终端 termcap 版本。

**如何通过终端的 termcap 关闭自动边距？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-09-28T01:42:48.693

大多数终端仿真器，包括 mac 默认终端，在此处讨论的意义上不是“真正的自动边距终端”——它们模拟具有“智能”环绕的 vt100 系列终端。您可以通过运行`cat`并键入到最后一行的末尾进行检查 - 键入最后一个字符后，光标将保持在该行的末尾（突出显示您刚刚键入的字符），直到您键入另一个字符。

“真正的自动边距终端”的唯一后果是字符不能显示在右下角（尽管有些程序可以通过使用`ich`/将字符移动到位来解决这个问题`ich1`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-28T20:30:18.453

根据[XTerm Control Sequences](http://invisible-island.net/xterm/ctlseqs/ctlseqs.html)，这个序列应该做被问到的事情：

```
CSI ? 7 l 
```

那是，

```
printf '\033[?7l' 
```

7**被**记录为

```
 Ps = 7  -> Wraparound Mode (DECAWM). 
```

最后一个字符**`l`**（小写 L）表示这是一个*重置*而不是*设置*控件。

无论出于何种原因，terminfo 的名称都比较模糊：“自动边距”。这些 terminfo 功能处理该功能（请参阅[terminfo(5)](http://invisible-island.net/ncurses/man/terminfo.5.html)）：

```
 auto_right_margin             am         am        terminal has auto‐
                                                      matic margins
   enter_am_mode                 smam       SA        turn on automatic
                                                      margins
   exit_am_mode                  rmam       RA        turn off automatic
                                                      margins 
```

有趣的是，ncurses 中的[vt100-nam](http://invisible-island.net/ncurses/terminfo.src.html#tic-vt100nam)终端描述（显然没有人使用）使用以下字符串初始化终端以**使用**automargins 边距：

```
rs2=\E>\E[?3l\E[?4l\E[?5l\E[?7h\E[?8h, 
```

（`\E[?7h`设置它），并断言终端不通过取消使用自动边距**`am`**。它还具有 terminfo 功能`rmam`和`smam`. 所以你可以这样做来证明它有效：

```
tput rmam
stty columns 999
ps -efwwwwwl 
```

并且（对于普通用户）看到`ps`列表很好地截断了终端窗口的右边距。

其他变体 vt220-nam 和 vt320-nam 似乎正确...

顺便说一句，对于**Mac**，您将使用**terminfo**名称，**`rmcup`**而不是**termcap** **`RA`**，因为 OSX 使用 ncurses 的 tput (terminfo) 而不是 BSD 变体。

进一步阅读：

*   [**`tput`**, **`reset`** - 初始化终端或查询 terminfo 数据库](http://invisible-island.net/ncurses/man/tput.1.html)
*   [历史部分**`tput`**](http://invisible-island.net/ncurses/man/tput.1.html#h2-HISTORY)
*   [历史部分**`tset`**](http://invisible-island.net/ncurses/man/tset.1.html#h2-HISTORY)

偶尔有人会询问有关抑制自动边距的问题，因为他们认为终端可以向左/向右平移/滚动以显示未换行的信息。这样做的终端很少见，OSX 终端不是其中*之一*。它的行为类似于 xterm 的一个子集，它本身模拟一系列 DEC 终端 vt52/vt100/vt220/等。在**这个**问题中，OP 对手册中的这一段感到担忧/困惑`screen`：

> 如果您的终端是“真正的”自动边距终端（它不允许 **屏幕上的最后一个位置**要在不滚动屏幕的情况下进行更新）考虑使用终端的 termcap 版本，该版本已关闭自动边距。这将确保在所有情况下都能准确和优化更新屏幕。现在大多数终端都有“神奇”的边距（自动边距加上可用的最后一列）。这是 VT100 风格类型，非常适合屏幕。如果您所拥有的只是一个“真正的”自动边距终端屏幕将满足于使用它，但是在屏幕滚动或角色移动到以其他方式的安全位置。使用具有插入字符功能的终端可以缩短此延迟。

**屏幕上的最后一个位置**是指终端的右下角。在正常情况下，如果您的光标位于右下角并且您打印一个字符，您会希望显示屏向上滚动一行并在下一行显示该字符。此外（因为终端可以以不同的方式实现），当您在**最后一个位置**打印一个字符时，有些*可能会*向上滚动。VT100 不这样做。在这种情况下，它不仅不会向上滚动，而且会在页边空白处忽略非打印字符**（**请参阅 xterm 常见问题解答[包装的描述很奇怪，说更多？](http://invisible-island.net/xterm/xterm.faq.html#vt100_wrapping)）。有一个 terminfo 标志****`xenl`设置为显示终端何时执行此特殊行为。终端数据库中大约三分之一的终端描述具有此标志。虽然其中大部分是针对您可能永远不会遇到的终端，但请记住，手册页中的建议是在其他终端与 VT100 相似的时代写的。screen 的早期变化历史很差，但该文本是 screen 在 1992 年第二次发布到 Usenet 的。1987 年的初始发布中说了类似的话：****

 ****> ***`LP`**除非在终端的 termcap 条目中找到 布尔功能，否则*屏幕永远不会写入屏幕的最后一个位置。*通常， 当最后一行的最后一列中写入一个字符时，*屏幕* 无法预测特定终端是否滚动； **`LP`**表示在此位置书写是安全的。请注意，该**`LP`**功能独立于**`am`**（自动边距）；对于某些终端，例如VT100，在对应的termcap条目中设置**`am`**以及设置是合理**`LP`**的（VT100在每行的最后一列写入字符时不会移动光标）。*

 *后面的措辞反映了`terminfo`系统流行的事实，并且名称**`LP`**不是为对应于`xenl`（它是**`xn`**）而选择的termcap名称。

所有这一切的重点是`screen`尝试在写入不同终端类型的程序之间进行转换，并使它们看起来都像一种终端类型——这意味着它试图在终端的所有位置显示文本。右下角是个问题，因为一些终端会向上滚动，破坏在那里写的尝试。作为一种解决方法，一些终端提供了替代方案：

*   使用不同的模式（插入），
*   将光标放在显示器**的倒数第二个位置**，
*   写入要填充的字符，将字符*推*到最后一个位置，然后
*   完成后关闭插入模式（否则很麻烦）。

终端数据库中大约三分之二的描述具有执行此插入模式 ( **`smir`**) 的能力。这仍然不完美，但在 1992 年确实值得一提。大约四分之一的人实现了类似的类似功能**`ich1`**。有些实现了两者（并且**`vi`**可能会通过尝试同时执行这两种方法而感到困惑）。

VT100-lookalikes 提供了写最后一个位置的第三种方法；`screen`检查并使用那里的任何东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T07:48:38.427

如果我理解正确，您希望使用 terminfo 数据库将自动换行功能设置为 NO。如果是这样，我相信您可以使用 -nam 标志将其关闭-应该使用 vt100-nam 之类的东西。您还可以通过查看 terminfo 的手册页进行检查。

如果这解决了您的问题，请标记它。(^_^) 如果不是...请回复评论，我会再次为您检查。干杯!

更新：还有一个快捷方式可能适用于您来关闭和打开换行。[在此处](http://www.scribd.com/doc/985314/Screen-VT100ANSI-Terminal-Emulator-Cheat-Sheet-Default-Keyboard-Shortcuts)查看快捷方式表。可以在[此处](http://swoolley.org/man.cgi/1/screen)找到有关 Screen 的其他信息（搜索 wrap）。您还可以[在此处](http://tldp.org/HOWTO/html_single/Text-Terminal-HOWTO/)查看如何使用 setterm（第 17.14 节更改终端设置）。另请[在此处](http://www.softpanorama.org/Utilities/Screen/screenrc_examples.shtml)查看更改设置的示例。

再次祝你好运。(^_^)

# vb.net - 如何在浏览器控件中禁用图像

> ID：810486
> 
> 赞同：3
> 
> 时间：2009-05-01T07:15:28.647
> 
> 标签：vb.net, webbrowser-control

在 vb.net 2003 中，如何在 webbrowser 控件中禁用图像加载

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-22T11:45:14.963

我过去这样做的方法是使用正则表达式用空引号替换图像标签。尝试以下方法，将其粘贴到您的 DocumentLoaded 事件中，或类似的：

```
origHTML = webBrowser.DocumentText
Dim newHTML as String

Dim regex as String = "<img.*/>"

newHTML = Regex.Replace(origHTML, regex, "", RegexOptions.Multiline)
webBrowser.DocumentText = newHTML 
```

这应该可以解决您的问题。

此致

# javascript - DIV 自动滚动

> ID：810492
> 
> 赞同：6
> 
> 时间：2009-05-01T07:20:09.243
> 
> 标签：javascript, html, dom

我有一个包含大量项目的 div。我通过单击按钮动态选择这些项目，在我的情况下溢出是自动的。我想要的是，选择不可见的项目以滚动div以便可以可见。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-01T07:37:09.110

您可以使用 HTMLElement 的[scrollTop](https://developer.mozilla.org/En/DOM/Element.scrollTop)属性来设置其内容的滚动量。

您可以从要滚动到的元素的[offsetTop中获取您需要滚动的量。](https://developer.mozilla.org/En/DOM/Element.offsetTop)

例如，使用此 HTML：

```
<div id="container">
  <p id="item-1">foo</p>
  <p id="item-2">bar</p>
  <p id="item-3">baz</p>
</div> 
```

您可以使用此 JavaScript 将容器 div 滚动到第三段：

```
document.getElementById("container").scrollTop = document.getElementById("item-3").offsetTop; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T07:28:08.927

另一个选择是使用**[jQuery](http://www.jquery.com)**和插件**[ScrollTo](http://plugins.jquery.com/project/ScrollTo)**。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T07:26:46.577

当您的按钮单击并选择一个项目时，调用此选定项目的 focus() 方法。这将导致自动滚动到您的元素：

```
<div style="height:80px; overflow:auto;">
    <input type="text" id="id1"><br><br>
    <input type="text" id="id2"><br><br>
    <input type="text" id="id3"><br><br>
    <input type="text" id="id4"><br><br>
    <input type="text" id="id5"><br><br>
    <input type="text" id="id6"><br><br>
</div>
<input type="button" onclick="document.getElementById('id6').focus();"> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-01T07:31:59.183

您还可以使用 DIV 的 scrollTop 或 scrollLeft 属性（取决于滚动是水平的还是垂直的）。

我以前做过这个，并使用了一个 setTimeout 事件让它流畅地滚动，而不是 1 次运动。这是没有 JQuery 的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-01T07:35:07.960

还有一个选择……锚。

为每个项目分配一个唯一 ID，当您想要滚动到特定项目时，执行以下 JavaScript 代码：

```
location.hash = itemID; 
```

...其中`itemID`是一个变量，其中包含要滚动到的元素的 ID。

史蒂夫

# java - java验证码库的推荐

> ID：810493
> 
> 赞同：66
> 
> 时间：2009-05-01T07:20:10.023
> 
> 标签：java, jakarta-ee, captcha, recaptcha, simplecaptcha

我正在寻找 JCaptcha 的替代品，它似乎不再被维护，而且一开始也不是很好。替代品必须与 JavaEE webapps 很好地集成。

如我所见，有三个选项：

*   JCaptcha - 不再维护的原始 API
*   SimpleCaptcha - 更好的 API，更好的验证码，但似乎只是 Java6
*   ReCaptcha - 易于使用，使用远程 Web 服务生成验证码，但对外观和感觉没有太多控制

有没有人用过其他的，他们会推荐？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2010-12-24T20:31:59.197

我是[SimpleCaptcha](http://simplecaptcha.sourceforge.net/)的作者。虽然我会推荐——为了人类的缘故——尽可能使用 ReCaptcha，但我提供了 SimpleCaptcha，因为一些组织有禁止像 ReCaptcha 这样的库的政策。SimpleCaptcha 是完全独立的，没有外部依赖项：只要您在 J2EE 容器中，就应该很好。

此外，SimpleCaptcha 现在可用于 Java 1.5 或 Java 6。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-05-01T07:22:08.507

[ReCaptcha](http://recaptcha.net/)是您应该使用的唯一验证码，因为它是唯一让世界变得更美好（将 OCR 结果改进为旧文本）的验证码，具有几乎无限的数据库。

所有其他验证码通常受到其数据库的限制，或者对这个世界没有任何好处。

**编辑 :: 我找到了如何使用 recaptcha 实现验证码的步骤。**

## [您可以在此处](http://technoscripts.com/creating-captcha-application-using-java/)使用 java 检查在线和离线验证码

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-08-03T09:54:54.133

当 ReCaptcha 关闭/不可用时会发生什么？您的服务会停止吗？您是否只是在它关闭时停止注册？即使 ReCaptcha 没有运行，您是否允许用户注册？如果是这样，这对安全有什么影响？特别是如果您将 CAPTCHA 用于注册以外的用途，例如重置密码表单、登录表单……如果没有 CAPTCHA 组件，您将无法接受这些操作。

验证码的 Java 世界处于可悲的状态，对于我们这些无法接受托管服务的人来说，SimpleCaptcha 似乎是最好的解决方案。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2010-02-02T06:30:53.763

在 recaptcha 变得像今天这样流行之前，我创建了[http://kaptcha.googlecode.com 。](http://kaptcha.googlecode.com)它还使您能够自己托管它，这在某些情况下可能是必要的。

Kaptcha 是 SimpleCaptcha 的一个经过大量修改和更新的版本，支持 JDK5/6。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-01-31T17:48:24.227

SimpleCaptcha 非常好用且易于使用。

这是一个如何在 JSF 2.0 中使用 SimpleCaptcha 的示例（主页有一个 JSP 示例）

请注意，我什至不费心将验证码值存储在 bean 中，我只是在验证它。

豆子：

```
// imports missing here

@ManagedBean
@SessionScoped
public class LoginBean implements Serializable
{
    public void validateCaptcha(FacesContext context,
                                UIComponent componentToValidate,
                                Object value)
            throws ValidatorException
    {
        HttpSession session = (HttpSession) context.getExternalContext().getSession(false);
        Captcha secretcaptcha = (Captcha) session.getAttribute(Captcha.NAME);
        if (secretcaptcha.isCorrect(value.toString()))
            return;

        // optional: clear field
        ((HtmlInputText) componentToValidate).setSubmittedValue("");

        throw new ValidatorException(new FacesMessage("Captcha does not match"));
    }
} 
```

facelet的相关部分：

```
<h:form id="CaptchaForm">
    Type this: <br/>
    <h:graphicImage id="CaptchaImgID" value="/simpleCaptcha.png"/> <br/>
    <h:inputText id="CaptchaID"
                 required="true"
                 requiredMessage="Captcha missing"
                 validator="#{loginBean.validateCaptcha}"
                 validatorMessage="Captcha does not match"
                 immediate="true">
    </h:inputText>
    <br/>
    <h:commandButton value="Check"/>

    <p/>
    <!-- message for the input field -->
    <h:message id="CaptchaMsgID" for="CaptchaID" style="color:red" />
</h:form> 
```

web.xml 的相关部分：

```
<servlet>
    <servlet-name>SimpleCaptcha</servlet-name>
    <servlet-class>nl.captcha.servlet.SimpleCaptchaServlet</servlet-class>
    <init-param>
        <param-name>captcha-width</param-name>
        <param-value>250</param-value>
    </init-param>
    <init-param>
        <param-name>captcha-height</param-name>
        <param-value>75</param-value>
    </init-param>
</servlet>
<servlet-mapping>
    <servlet-name>SimpleCaptcha</servlet-name>
    <url-pattern>/simpleCaptcha.png</url-pattern>
</servlet-mapping> 
```

享受 ：-）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-07-06T21:42:31.457

如果您希望托管自己的验证码服务而不是依赖第三方验证码服务（如 recaptcha），Kaptcha 是 Recaptcha 的一个很好的替代品。

# .net - 在进程关闭期间处理 ObjectDisposedException 和类似异常？

> ID：810495
> 
> 赞同：3
> 
> 时间：2009-05-01T07:20:48.790
> 
> 标签：.net, exception, events, objectdisposedexception

我的应用程序通常在 10-20 个线程上运行，这些线程几乎每秒都会向 GUI 发送事件以更新某些控件。

当用户关闭这些中间的应用程序时，与这些事件相关的所有更新都会导致几次随机崩溃。主要是`ObjectDisposedException`和`NullReferenceException`。

由于事件已经抛出但尚未由 .NET Framework 处理，因此它们不处于我可以取消它们的状态。

我不太确定处理这个问题的最佳方法。目前我只是吞下例外的例外。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T07:23:27.317

几个选项：

*   当应用程序开始关闭（`FormClosing`？）时，您可以开始干净地退出线程（通过某处的标志）
*   大概是为了与您的 UI 交谈，您正在引发由 UI 处理的事件（处理同步等） - 保留一个标志，并且（如果这样做是安全的）如果已设置标志（再次，因为你要退出）
*   退出时，让 UI 取消订阅事件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T08:18:49.070

除了[Marc Gravell 的建议](https://stackoverflow.com/questions/810495/handling-objectdisposedexception-and-similar-exceptions-during-the-process-shutdo/810503#810503)之外，还有一些其他内容：

*   从任何时候开始，您都可以`Environment.HasShutdownStarted`在执行任何可能导致`ObjectDisposed`异常的操作之前进行检查
*   如果您正在访问任何 Windows 窗体，您可以检查`.IsDisposed`（所有窗体和控件都有它）

# hibernate - 休眠结果排序

> ID：810497
> 
> 赞同：0
> 
> 时间：2009-05-01T07:21:51.487
> 
> 标签：hibernate

我如何对hibernate返回的结果（列表）进行动态排序。意味着我不想将order by子句放在hbm文件中。这是因为我想在不同的时间进行不同的排序。

我也想做嵌套排序。考虑以下。我有一个课程对象，其中包含一组应用程序应用程序具有时间和优先级等属性现在我想首先根据优先级对它们进行排序，并且在优先级内我想按时间对它们进行排序。

我正在将我的应用程序检索为 cousreobject.getApplicationSet() 。这给了我一组特定课程的 allpications ()。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T07:25:25.440

使用 java.util.Comparator 对查询返回的结果列表进行排序？这可以是你喜欢的复杂，包括嵌套。

# web-services - 强制 asmx Web 服务一次处理一个请求

> ID：810505
> 
> 赞同：2
> 
> 时间：2009-05-01T07:24:28.593
> 
> 标签：web-services, asmx, throttling

我正在调试一个接收“突发”请求的 ASMX Web 服务。即，Web 服务很可能会在大约 1 或 2 秒内收到 100 个异步请求。每个请求似乎需要大约一秒钟的时间来处理（这是意料之中的，我对这个性能很好）。然而重要的是，每个请求都是按顺序处理的，不会发生并行处理。由于 Web 服务调用的外部组件，我不希望任何并发请求处理。有什么办法可以强制 Web 服务只按顺序处理每个响应？

我在 machine.config 中看到了 maxconnection 属性，但这似乎只适用于出站连接，因为我希望限制传入连接。

请注意，此时重构为 WCF 不是一种选择。

我们在 Win2003 上使用 IIS6。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T13:09:14.703

我过去所做的只是简单地在对我正在使用的外部资源的任何访问周围放置一个锁定语句。在我的例子中，它是一段声称是线程安全的非托管代码，但实际上如果一次从多个线程访问，它会破坏 C 运行时库堆。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T07:29:59.360

也许您应该在内部将请求排队并一一处理？

它可能会导致客户端轮询结果（如果他们甚至需要它们），但你会得到你想要的顺序管道......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T07:36:55.083

在 IIS7 中，您可以设置允许到网站的连接限制。你能用IIS7吗？

# winapi - Win32 中的非客户区消息

> ID：810514
> 
> 赞同：2
> 
> 时间：2009-05-01T07:31:34.160
> 
> 标签：winapi

我希望我的窗口在鼠标悬停在非客户区的关闭按钮上时立即关闭。我试图捕获 wm_ncmousemove 但我找不到关闭按钮的命中测试。请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T07:43:25.023

使用处理 WM_NCHITTEST 后返回的 HTCLOSE

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T07:35:08.147

[WM_NCHITTEST](http://msdn.microsoft.com/en-us/library/ms645618(VS.85).aspx)

# java - java中的对象排序

> ID：810515
> 
> 赞同：2
> 
> 时间：2009-05-01T07:31:58.683
> 
> 标签：java

我想做嵌套排序。我有一个具有一组应用程序的课程对象。应用程序具有时间和优先级等属性。现在我想首先根据优先级对它们进行排序，并且在优先级内我想按时间对它们进行排序。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T08:12:37.387

例如，给定这个类（公共字段仅为简洁起见）：

```
public class Job {
    public int prio;
    public int timeElapsed;
} 
```

您可以使用 java.util.Collections 类中的静态 sort(List, Comparator) 方法实现按时间排序。在这里，创建了一个匿名内部类来实现“作业”的比较器。这有时被称为函数指针的替代方案（因为 Java 没有这些）。

```
public void sortByTime() {
    AbstractList<Job> list = new ArrayList<Job>();
    //add some items
    Collections.sort(list, new Comparator<Job>() {
        public int compare(Job j1, Job j2) {
            return j1.timeElapsed - j2.timeElapsed;
        }
    });
} 
```

注意 compare() 方法的合约模型：http: [//java.sun.com/javase/6/docs/api/java/util/Comparator.html#compare(T,%20T)](http://java.sun.com/javase/6/docs/api/java/util/Comparator.html#compare(T,%20T))

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T07:53:44.513

[查看http://google-collections.googlecode.com/svn/trunk/javadoc/index.html?com/google/common/collect/Ordering.html](http://google-collections.googlecode.com/svn/trunk/javadoc/index.html?com/google/common/collect/Ordering.html)上的 Google Collections Ordering 类。它应该拥有您需要的一切以及更多。特别是你应该看看复合方法来获得你的第二次订购。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T15:30:39.953

要对多个标准进行排序，使用 Comparable 接口的几个常见方法：

*   编写您的 compareTo() 方法，以便它比较一个字段，然后如果它不能返回基于第一个的排序，则继续比较另一个；
*   如果您再次小心，在您的 compareTo() 方法中，您可以将两个标准的组合转换为一个整数，然后您可以进行比较。

这些方法中的第一种通常更可取，并且更可能是正确的（即使代码最终看起来有点麻烦）。

请参阅我的网站上的[使 Java 对象可排序的示例，该示例显示了按花色](http://www.javamex.com/tutorials/collections/sorting_comparable_compareto.shtml)*和*花色中的数字对扑克牌进行排序的示例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-23T16:39:33.913

[像上面的例子](https://stackoverflow.com/questions/810515/sorting-objects-in-java/810609#810609)那样减去这两个数字并不总是一个好主意。

考虑一下如果将 -2,147,483,644 与 2,147,483,645 进行比较会发生什么。减去它们会导致整数[溢出](http://en.wikipedia.org/wiki/Integer_overflow)，从而导致正数。正数均值会使比较器声称 -2,147,483,644 大于 2,147,483,645。

```
-5 - 6 = -7
-2,147,483,644 - 2,147,483,645 = 1 
```

当您考虑比较 long 或 double 时，减去以找到比较值更加危险，因为必须将其转换回 int，从而为溢出提供另一个机会。例如，永远不要这样做：

```
class ZardozComparorator implements Comparator<Zardoz>{
    public int compare(Zardoz z1, Zardoz z2) {
        Long z1long = Long.getLong(z1.getName());
        Long z2long = Long.getLong(z2.getName());

        return (int)(z1long-z2long);
    }

} 
```

而是使用您正在比较的对象的比较方法。这样您可以避免溢出，如果需要，您可以覆盖比较方法。

```
class ZardozComparorator implements Comparator<Zardoz>{
    public int compare(Zardoz z1, Zardoz z2) {
        Long z1long = Long.getLong(z1.getName());
        Long z2long = Long.getLong(z2.getName());

        return z1long.compareTo(z2long);
    }

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T07:33:13.720

你已经在别处问过这个问题了。编写 java.util.Comparator 的实现。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-05-09T22:46:28.990

以下是我对这个 7 年前的问题的看法，但有时仍会被报道：

1.  在您的对象中创建一个静态方法，例如（仅当您使用其他库自动生成 getter 和 setter 时）：

> ```
> public static String getNameFrom(Order order){
>     return order.name;
> } 
> ```

然后尝试使用这样的东西：

> ```
> Collections.sort(orders, Comparator.comparing(Order::getNameFrom)); 
> ```

2.  对于更优雅的方法，我总是不喜欢更改实体，而是使用更高级的 Lambda 编码。例如：

> ```
> Collections.sort(orders, (order1, order2) ->
> order1.name.compareTo(order2.name); 
> ```

# shell - 如何在 IronPython/Mono 中运行 OS shell 命令？

> ID：810521
> 
> 赞同：5
> 
> 时间：2009-05-01T07:34:24.730
> 
> 标签：shell, mono, ironpython

我想试试 IronPython 和 Mono。专门做系统管理员任务。这通常意味着运行操作系统命令。在 CPython 中，我使用 subprocess 模块来完成此类任务。但是在 IronPython (v2.0.1, Mono 2.4, Linux) 中没有子进程模块。似乎甚至没有“操作系统”模块。所以我不能使用 os.system()。IronPython 在 CPython 中通常使用“subprocess”或“os.system()”来执行任务的方式是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-03T09:09:51.350

我找到了答案。感谢“IronPython Cookbook”。可以在此处找到有关此主题的更多信息： [http ://www.ironpython.info/index.php/Launching_Sub-Processes](http://www.ironpython.info/index.php/Launching_Sub-Processes)

```
>>> from System.Diagnostics import Process
>>> p = Process()
>>> p.StartInfo.UseShellExecute = False
>>> p.StartInfo.RedirectStandardOutput = True
>>> p.StartInfo.FileName = 'uname'
>>> p.StartInfo.Arguments = '-m -r'
>>> p.Start()
True
>>> p.WaitForExit()
>>> p.StandardOutput.ReadToEnd()
'9.6.0 i386\n'
>>> p.ExitCode
0
>>> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T08:37:55.313

您可以使用 ironpython 中的大多数标准操作系统模块。

```
import sys
sys.path.append path('...pathtocpythonlib......')
import os 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T13:10:16.190

也考虑一下这个[C# Interactive Shell](http://tirania.org/blog/archive/2008/Sep-08.html) ....不确定它是否在 shell 中支持 IronPhython，但 Mono 确实如您所知。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-15T03:01:49.847

这里有一个部分子流程模块实现：

[http://www.bitbucket.org/jdhardy/code/src/tip/subprocess.py](http://www.bitbucket.org/jdhardy/code/src/tip/subprocess.py)

该模块（此时，2010 年 6 月）仅支持重定向 STDIO 管道（例如，您不能提供自己的类似文件的对象来填充输出或流式输入），但基础知识已经足够了。

# mysql - 无需身份验证的 MySQL 性能

> ID：810523
> 
> 赞同：0
> 
> 时间：2009-05-01T07:34:53.077
> 
> 标签：mysql, authentication

有没有办法根据主机而不是用户名/密码向 MySQL 服务器授予权限。因此，列入白名单的主机无需使用用户名或密码即可连接到 MySQL 服务器。

这样做会提高性能吗？

（服务器位于根本没有连接到互联网的 LAN 上，此设置不关心安全性，只关心性能）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T09:41:17.780

是的 - 可以配置。查看该`GRANT`命令的文档。

我不确定你会从中获得任何显着的性能提升。我认为身份验证中最耗时的元素是 IP 地址的反向映射。

所有文档都在这里：[http ://dev.mysql.com/doc/refman/5.0/en/privilege-system.html](http://dev.mysql.com/doc/refman/5.0/en/privilege-system.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-14T12:05:09.863

它不会提高性能，但您可以尝试允许来自给定主机或 IP 范围的任何用户：

例如 mysql> GRANT SELECT ON test.* TO '%'@'some_host_or_ip' IDENTIFIED BY '';

# gnu-screen - 无法理解 .screenrc 中的两行

> ID：810528
> 
> 赞同：0
> 
> 时间：2009-05-01T07:37:40.637
> 
> 标签：gnu-screen

我不知道您如何在屏幕上看到[以下行的效果](http://www.softpanorama.org/Utilities/Screen/screenrc_examples.shtml)

```
bind ^g  screen -t 'Google' links www.google.com

bind G screen -t 'Google'    sudo -u insec links www.google.com 
```

我尝试在回滚模式下按 Ctrl-g 未成功。我还尝试在我的手册中搜索可点击的单词，但未成功

```
man man 
```

**你怎么能看到线条的效果？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T07:41:35.370

要尝试该`bind ^g`行，请按 Ctrl-A Ctrl-G。

要尝试这`bind G`条线，请按 Ctrl-A Shift-G。

`bind`如果行在`$HOME/.screenrc`并且您在保存后已启动屏幕，则所有这些键绑定都在屏幕内工作`$HOME/.screenrc`。要查看是否正在运行屏幕，请按 Ctrl-A V（不带 shift）。这将在窗口的最后一行显示（反色）屏幕的版本号。如果您没有获得此信息，则必须先启动屏幕，方法是键入`screen`并按 Enter。

有关在 GNU screen 中定义自定义键绑定的更多信息，请阅读[screen 手册页](http://www.manpagez.com/man/1/screen/)`bind`的*CUSTOMIZATION*部分中的条目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T07:43:22.590

你需要打`Ctrl-A`然后`Ctrl-G`。

它应该创建一个新窗口来执行`links`（当然你也必须安装它）程序以文本模式浏览谷歌。

`Ctrl-A`然后`G`应该以用户“insec”身份运行，然后再次运行链接。

# .net - 在 SubmitChanges 之前从 LINQ-to-SQL DataContext 检索对象

> ID：810529
> 
> 赞同：3
> 
> 时间：2009-05-01T07:38:26.360
> 
> 标签：.net, linq-to-sql

我在没有调用 SubmitChanges() 的情况下将一个新对象插入到 LINQ-to-SQL DataContext 中：

```
MyDataContext db = new MyDataContext();
MyObject newObject = new MyObject() 
{
   Id = 1,
   Name = "MyName"
};
db.MyObjects.InsertOnSubmit(newObject); 
```

现在在我的代码的另一个地方，我想检索这个新对象，即使它还没有在数据库中。所以我在那里传递了相同的 DataContext 实例，因为我相信新对象缓存在其中。现在我想找回它。但这不起作用：

```
MyObject newObject = db.MyObjects.Where(o => o.Id == 1).SingleOrDefault(); 
```

我怎样才能做我想做的事？那可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T07:47:27.460

尝试：

```
db.MyObjects.SingleOrDefault(o => o.Id == 1); 
```

您会认为这将是相同的，但请参阅以下两个连接问题：

*   [LINQ-to-SQL 不使用缓存进行查找](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=340036)
*   [LINQ-to-SQL 仍为 ID 查找往返 (3.5SP1)](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=362313)

如果这不起作用，我知道`.Single(o => o.Id == 1)`3.5 SP1 中的作品（我不知道我是否尝试过`.SingleOrDefault(pred)`）。显然`.Where(o => o.Id == 1).Single()`4.0 中已修复 - 再次，我没有尝试过`.Where(pred).SingleOrDefault()`.

# wpf - WPF 应用程序未正确关闭

> ID：810531
> 
> 赞同：7
> 
> 时间：2009-05-01T07:39:10.883
> 
> 标签：wpf, shutdown, application-shutdown

我`Application.Current.Shutdown()`从一个绑定到 xaml 窗口的类调用`ObjectDataProvider`，但应用程序没有关闭。谁能帮我理解为什么？关闭主窗口后，我的应用程序没有完全关闭，它不会从任务管理器的进程列表中消失。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-14T06:39:33.683

试试`Environment.Exit(0)`吧

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-01T08:15:22.887

您是否创建了任何线程来进行后台处理？如果有，请确保`.IsBackground`在它们上设置属性，否则它们可以保持应用程序运行

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-22T14:19:04.967

不要忘记添加这个：

```
private void Window_Closed(object sender, EventArgs e)
{
  Application.Current.Shutdown();
} 
```

希望这可以帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-01T08:47:02.173

我遇到了一个问题，即使主窗口关闭，应用程序也不会关闭。原来我在启动画面上做了 Hide() 而不是 Close() 所以它仍然潜伏在后台保持应用程序活着。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T09:16:57.823

如果您的应用程序中有多个窗口或对话框，您可能需要明确关闭每个窗口或对话框。

关闭对话框：

> _myDialog.Close();

关闭所有窗口：

```
foreach(var window in Application.Current.Windows.ToList())
{
    window.Close();
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-11-23T21:25:22.880

我遇到了同样的问题，尽管应用程序关闭，但应用程序进程并没有停止。

就我而言，我从 BackgroundWorker 打开了一个窗口（下面的代码）

```
BackgroundWorker BG = new BackgroundWorker();
BG.DoWork += new DoWorkEventHandler(BG_DoWork);
StockMinWindow MinWindow = new StockMinWindow(null); -------- this is the problem 
BG.RunWorkerAsync(); 
```

在运行 BackgroundWorker 之前实例化窗口似乎不是问题，而是通过擦除应用程序正确关闭的行

我从 BackgroundWorker 打开我的窗口，但使用主线程（下面的代码）

```
 View.Dispatcher.BeginInvoke(new Action(delegate()
 {
   StockMinWindow MinWindow = new StockMinWindow(StockMinList);
   MinWindow.Owner = View;
   MinWindow.ShowDialog();
 })); 
```

希望能帮助到你。

# encryption - 是否可以对 AES256 进行逆向工程？

> ID：810533
> 
> 赞同：13
> 
> 时间：2009-05-01T07:40:45.760
> 
> 标签：encryption, cryptography, aes, cryptanalysis

想象一下我有这个：

```
$cdata = AES_256($data, $pass); 
```

AES_256 实现了[AES 算法](http://en.wikipedia.org/wiki/Advanced_Encryption_Standard)。

如果我知道的内容`$cdata`和内容`$data`并且也有`AES_256()`代码，我可以逆向工程并找到`$pass`吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-01T08:11:02.380

简单的回答：不。

这已经过测试，并在 Wiki 链接中提到。

> 相关密钥攻击最多可以破坏 9 轮 256 位 AES。选择明文攻击可以破坏 8 轮 192 位和 256 位 AES 以及 7 轮 128 位 AES，尽管工作负载在 2 ^(128) - 2 ^(119)时是不切实际的。

或者换一种说法：你更有可能被闪电击中......在你赢得彩票的同一天，而不是打破它！

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-01T08:44:36.093

这称为[已知明文攻击](http://en.wikipedia.org/wiki/Known-plaintext_attack)。正如其他人解释的那样，像 AES 这样的好的密码应该不受它的影响。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-01T09:17:33.860

如果`$pass`实际上是密码而不是 256 位密钥，那么您可能很幸运。

虽然执行起来绝非易事，但对普通密码的暴力攻击比暴力破解 256 位密钥要快得多。

因此，修改许多密码暴力破解工具中的一种，您就会受到攻击（取决于密码的强度）可能需要数周到数年的时间 - 但与 3x10^51 年相比，这速度很快......

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-01T08:52:26.603

另一个引用，来自[维基百科](http://en.wikipedia.org/wiki/Brute_force_attack#Theoretical_limits)：

> AES 允许使用 256 位密钥。通过暴力破解对称的 256 位密钥需要比 128 位密钥多 2^128 倍的计算能力。每秒可以检查十亿 (10^18) 个 AES 密钥的设备需要大约 3 x 10^51 年才能耗尽 256 位密钥空间。

当您知道原始文本可能会更快时，暴力破解可能会更快，但 3 x 10^51 年仍然很长。另外还有可能没有可以检查十亿 (10^18) 键/秒的设备的问题。

**简而言之**：一切皆有可能，但这在我们现在生活的世界中是不可行的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-01T07:44:51.650

你可以暴力破解它，但这需要很长时间。几十年甚至更长的时间。这就是像 AES 这样的加密算法的意义所在。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-01T09:21:12.370

AES 与所有优秀的加密算法一样，不依赖于[默默无闻的安全性](http://en.wikipedia.org/wiki/Security_through_obscurity)。

换句话说，代码中没有“秘密”，因此您拥有该代码不会对您特别有帮助。

已知明文是一个单独的问题，我不太了解，所以我将把它留给其他回答者。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T07:47:43.780

当然不是——唯一的方法是蛮力。你真的认为 NIST 愚蠢到选择一个很容易破解的密码来制定新标准吗？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-06-20T03:21:18.307

2x2^256 种可能的组合对于蛮力来说是很多的。但是暴力破解是唯一的方法。这实际上需要大约 3 年的时间。AES 是目前我想说的最好的加密。但这只需要使用 CPU 的时间。由于 GPU（图形处理单元）严格基于数学，人们一直在制作仅使用 GPU 破解基于数学的算法的程序，其速度比 CPU 快得多。换句话说，AES 可能不会持续 3 年。如果只有永恒密码是可能的。看起来动态加密可能是人们在不久的将来真正隐藏他们的信息的唯一方法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-11-16T21:24:35.787

借助超级计算机的强大功能，AES 加密崩溃的时间将大大缩短……我听说……

# java - 是否值得切换到 IBM Jikes (java) 编译器

> ID：810535
> 
> 赞同：4
> 
> 时间：2009-05-01T07:41:25.340
> 
> 标签：java, compiler-construction

我刚刚在一些 Liferay 文档中读到，IBM 的 Jikes (java) 编译器速度更快，并且在编译时错误方面更具描述性。

我想知道社区是否同意，以及转换是否会显着提高您的工作效率。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T07:57:59.730

Jikes 在 JDK 1.3 时代非常引人注目，当时 javac 编译器的速度非常慢。相比之下，吉克斯的速度快得令人眼花缭乱。然而，速度的提高越来越不明显，以至于我个人不会再打扰了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T08:08:07.023

Jikes 不支持新的 Java 5 事物，因此对于使用这些工具的项目来说，它不是一个选项。

在我看来，目前最好的 javac 替代品是 Eclipse 编译器，它有独立版本。如今，速度（这是 jikes 的主要力量）不再是一个问题。

编辑：Jikes 支持“增量编译”，这在不能使用全尺寸 IDE 进行开发的环境中可能非常有趣。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T07:55:12.513

如果你`ant`作为构建系统使用，你可以在 Jikes 和 javac 之间轻松切换；然后我建议你试试 jikes - 速度真的很棒。

否则，您真的应该再次考虑，因为它并不总是与您的 JDK 版本兼容，并且可能会产生额外的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T08:01:29.550

值得注意的是，JDK7 编译器在错误描述性方面做了一些改进。

# php - 如何用树形结构突出显示访问过的链接？

> ID：810536
> 
> 赞同：-1
> 
> 时间：2009-05-01T07:41:32.203
> 
> 标签：php, css

我有树结构的列表。示例：continent1 名称 country1 名称 city1 名称

大陆 2 名称 国家 2 名称 城市 2 名称

当我访问第 1 大陆时，它必须突出显示，如果访问国家/地区，则必须以类似的方式突出显示城市

如果我再次访问大陆 2，这次必须突出显示大陆 2 而不是内容 1

我正在使用 php。希望得到答复。谢谢...............

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T08:18:28.433

您可以使用 CSS 来设置[a:visited](http://reference.sitepoint.com/css/pseudoclass-visited)伪类的样式。

# java - 在多显示环境中保存 JFrame 位置

> ID：810539
> 
> 赞同：1
> 
> 时间：2009-05-01T07:41:51.407
> 
> 标签：java, swing, jframe

我想在用户关闭 JFrame 时存储它的位置（边界、扩展状态）。但是，当用户将框架移动到第二个屏幕并将其最大化时，我该如何存储该信息？我的幼稚（和单一显示）实现是这样的：

```
 void saveFrame(JFrame frame) throws IOException {
    Properties props = new Properties();
    props.setProperty("State", String.valueOf(frame.getExtendedState()));
    props.setProperty("X", String.valueOf(frame.getX()));
    props.setProperty("Y", String.valueOf(frame.getY()));
    props.setProperty("W", String.valueOf(frame.getWidth()));
    props.setProperty("H", String.valueOf(frame.getHeight()));
    props.storeToXML(new FileOutputStream("config.xml"), null);
}
void loadFrame(JFrame frame) throws IOException {
    Properties props = new Properties();
    props.loadFromXML(new FileInputStream("config.xml"));
    int extendedState = Integer.parseInt(props.getProperty("State", String.valueOf(frame.getExtendedState())));
    if (extendedState != JFrame.MAXIMIZED_BOTH) {
        frame.setBounds(
            Integer.parseInt(props.getProperty("X", String.valueOf(frame.getX()))),
            Integer.parseInt(props.getProperty("Y", String.valueOf(frame.getY()))),
            Integer.parseInt(props.getProperty("W", String.valueOf(frame.getWidth()))),
            Integer.parseInt(props.getProperty("H", String.valueOf(frame.getHeight())))
        );
    } else {
        frame.setExtendedState(JFrame.MAXIMIZED_BOTH);
    }
} 
```

如何发现框架位于哪个屏幕上？如何将框架移动到第二个屏幕并在那里最大化？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T08:00:17.180

要查找使用的图形设备的 ID：

```
frame.getGraphicsConfiguration().getDevice().getIDString() 
```

反过来，您可以找到具有以下功能的图形设备：

```
 GraphicsEnvironment.getLocalGraphicsEnvironment().getDevices() 
```

然后，您可以在`JFrame`构造函数中使用设备中的配置。我不相信你可以在施工后设置它。

当然，您应该注意不要因为分辨率发生变化而在屏幕外打开框架。

# c# - 使用 RegularExpressionValidator 上传文件不适用于仅 Firefox IE

> ID：810541
> 
> 赞同：5
> 
> 时间：2009-05-01T07:42:12.047
> 
> 标签：c#, asp.net, vb.net, validation, file-upload

我有一个带有以下验证表达式的 RegularExpressionValidator 的 FileUpload：

```
^(([a-zA-Z]:)|(\\{2}\w+)\$?)(\\(\w[\w].*))+(.gif|.jpg|.JPG|.JPEG|.GIF|.jpeg|.png|.bmp|.3dm|.3dmf|.ai|.drw|.dxf|.esp|.mng|.png|.ps|.psp|.svg|.tiff)$ 
```

这样我可以确保用户只上传图片。但是由于某种原因，当我使用 Firefox 时它不起作用。为什么会这样，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-01T08:19:25.950

尝试这个：

```
(.*?)\.(jpg|jpeg|png|gif)$ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-24T12:46:16.697

对 DaDa 解决方案的增强，可满足区分大小写的需求：

```
^(.*?)\.(((j|J)(p|P)(e|E)?(g|G))|((p|P)(n|N)(g|G))|((g|G)(i|I)(f|F)))$ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T08:14:08.363

我找到了解决方案......

```
(.*\.([gG][iI][fF]|[jJ][pP][gG]|[jJ][pP][eE][gG]|[bB][mM][pP])$) 
```

[链接到答案](http://forums.asp.net/t/1342216.aspx)

享受！！！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-03T04:43:46.027

我有一个解决这个问题的方法：

```
var reg = /([^\s]+(?=.(jpg|gif|png|jpeg)).\2)/gm; 
if (reg.test(uploadcontrol) == false) { 
    alert("Please upload valid image formats(.jpg,.gif,.jpeg and .png)");
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2010-02-18T19:17:02.997

它不适用于 Firefox v3.x，因为它不允许 JavaScript 从文件输入字段中获取完整路径名，并且此特定正则表达式希望看到完整路径名。

# java - 仅显示选定的 Log4j 调试语句

> ID：810545
> 
> 赞同：8
> 
> 时间：2009-05-01T07:44:07.937
> 
> 标签：java, log4j

是否可以在控制台中仅显示具有某些单词的语句。

对于当量：

```
 logger.debug ( "java: hello " );
   logger.debug ( "groovy: hello " );
   logger.debug ( "ruby: hello " ); 
```

现在，通过进行一些配置或其他操作，所有以 groovy: 开头的语句都应该显示出来。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T08:06:02.910

您想使用 log4j [StringMatchFilter](http://logging.apache.org/log4j/companions/extras/apidocs/org/apache/log4j/filter/StringMatchFilter.html)，它是 apache 日志记录的“附加”包的一部分。

[这是一个在网上](http://www.webdeveloper.com/forum/showthread.php?t=91074)找到的简单示例：

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">
<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/">
  <appender name="CustomAppender" class="org.apache.log4j.RollingFileAppender">
    <param name="File" value="custom.log"/>
    <param name="Append" value="true"/>
    <param name="MaxFileSize" value="5000KB"/>
    <param name="maxBackupIndex" value="5"/> 
          <layout class="org.apache.log4j.PatternLayout">
                  <param name="ConversionPattern" value="%d{yyyy-MM-dd HH:mm:ss} [%t] %-5p - %m%n" />
          </layout>

          <filter class="org.apache.log4j.varia.StringMatchFilter">
                  <param name="StringToMatch" value="Here is DEBUG" />
                  <param name="AcceptOnMatch" value="true" />
          </filter>

          <filter class="org.apache.log4j.varia.DenyAllFilter"/>
  </appender>

  <root>
    <appender-ref ref="CustomAppender"/>
  </root>
</log4j:configuration> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T13:57:17.823

SLF4J 标记可能适合您的目的。所有打印方法（例如调试和信息）都`org.slf4j.Logger` [允许将标记作为第一个参数](http://www.slf4j.org/apidocs/org/slf4j/Logger.html#debug%28org.slf4j.Marker,%20java.lang.String%29)。此外，原生 SLF4J 实现 logback-classic 附带一个过滤器`MarkerFilter`，我认为它可以满足您的需求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T08:03:38.063

如何创建您的海关关卡

```
public class Groovy extends Level 
```

然后在日志属性文件中将这些级别设置为您的配置

希望这会有所帮助，大卫。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T08:03:58.903

可以使用不同的记录器（比如一个记录“java”消息的记录器和一个记录“groovy”消息的记录器）。Log4J 配置可以为每个记录器设置不同的级别。

[你可以在这里](http://logging.apache.org/log4j/1.2/manual.html)阅读更多

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T08:07:51.453

可以使用一种工具来过滤掉消息。对于 Windows，您可以使用[BareTail](http://www.baremetalsoft.com/baretailpro/index.php)执行此操作。只有专业（付费）版本才能过滤消息。也许还有其他工具可以完成同样的工作。

# mysql - MySQL 存储过程与 PHP 脚本

> ID：810548
> 
> 赞同：10
> 
> 时间：2009-05-01T07:45:10.493
> 
> 标签：mysql, stored-procedures

我正在为一家珠宝批发商运营一个网站。

他们所有产品的价格都是使用每晚更新的当前金条金属修复计算的。

目前，对于该网站，计算是通过 php 包含函数进行的，该函数在当前情况下运行良好。

大约有 10,000 种产品，但价格是实时计算的（即在请求网页时）。计算很简单，但有很多（大约 50+），我担心流量的增加可能会减慢当前脚本的速度。

我正在重新设计站点，想知道在 MySQL 中创建一个过程来进行计算是否有益。

这可能比当前的 php 脚本更快吗？有人知道有关使用程序的任何好的阅读参考吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-01T07:54:01.643

这是存储过程与 php 的基准测试。

[http://mtocker.livejournal.com/45222.html](http://mtocker.livejournal.com/45222.html)

存储过程慢了 10 倍。

您可能还想看看这个：

[http://www.tonymarston.net/php-mysql/stored-procedures-are-evil.html](http://www.tonymarston.net/php-mysql/stored-procedures-are-evil.html)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-01T07:53:52.780

如果您考虑这个的原因是由于性能和可扩展性，那么我建议您继续在 PHP 中进行计算。

这样做的原因是，无论您的 PHP 是否存在性能损失，当您扩展 Web 应用程序时，迁移到多个 Web 服务器通常比迁移到多个数据库服务器要容易得多。因此，最好在 PHP 中进行更多的计算，而在 MySQL 中进行更少的计算。

除了性能方面，我通常仍然更喜欢避免存储过程，而倾向于在应用程序中使用逻辑，因为

*   它可能不太便携。存储过程增加了部署应用程序新实例所需的工作量。
*   它们是用与 PHP 不同的语言编写的，因此 PHP 开发人员可能会觉得它们不容易理解。
*   将它们保存在源代码管理中可能很困难。

这些问题当然都可以解决，没有太大的难度，但这都增加了复杂性开销。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-01T07:55:34.447

如果绝对有必要在每个页面请求上更新价格，并且您担心网站会获得大量流量，我不推荐存储过程。

我建议将您使用的信息（并且很难在不知道您如何执行此操作的情况下进行详细说明）缓存在内存中（可能使用 memcached）并继续从 PHP 中读取它。

我承认我没有在存储过程与内存中 PHP 性能之间进行任何基准测试，但如果该过程不直接影响您的查询，我建议使用缓存。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-01T08:39:27.867

简而言之，将它们保存在 php.ini 中。更容易维护。

对于当前站点，不太可能遇到性能问题，即 php 中的 calc 速度与数据库中 calc 的速度之间的差异非常明显。如果您是，那么该站点的代码存在根本性错误。（如果完成，这包括实时货币转换）。

话虽如此，通常首选将 calc 保存在 PHP 中，因为它更易于控制和调试。它确实需要网络编码人员对数据库有所了解，但这通常不是问题。90% 的代码加速发生在 10% 的代码上，如果发生这种情况，dba 很容易识别导致 db load 的查询。

# windows - 将 GDI 转换为 XPS 时抑制 Microsoft XPS 文档编写器上的“另存为”对话框

> ID：810550
> 
> 赞同：2
> 
> 时间：2009-05-01T07:47:05.607
> 
> 标签：windows, printing, gdi, xps

在他的博客文章中[，无需用户交互即可将文档打印到 Microsoft XPS Document Writer](https://blogs.msdn.microsoft.com/fyuan/2007/02/24/printing-documents-to-microsoft-xps-document-writer-without-user-interaction/)冯远说

> 如果您从自己的应用程序打印，很容易将 MXDW 指定为打印机驱动程序，并为要保存到的 XPS 文档提供文件名

谁能解释如何做到这一点并提供代码示例？

我遇到的主要问题是抑制 Microsoft XPS 文档编写器弹出的另存为对话框。我讨厌像袁在他的帖子中那样诉诸 UI 黑客攻击。

目前，我的应用程序对用户想要使用的任何打印机的设备上下文进行 GDI 绘图调用。我可以在 XPS Document Writer 上进行这些调用，但是当需要完成打印时，XPS Writer 会弹出另存为对话框。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T05:27:39.333

实际上，同一作者提供了答案[Printing to Microsoft XPS Document Writer 而没有显示 File Save Dialog Box](http://blogs.msdn.com/fyuan/archive/2005/09/16/469076.aspx)。解决方案是使用 Microsoft XPS Document Writer 打印机打印到文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T08:35:51.543

如果您想避免 XPS 文档碰到文件系统，Shahed Kahn 在[Loading Xps From MemoryStream](http://msmvps.com/blogs/shahed/archive/2007/09/22/loading-xps-from-memorystream.aspx)中提供了示例代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-16T17:06:25.953

这对我有用：

```
 With Me.PrintDocument
     With .PrinterSettings
        .PrinterName = "Microsoft XPS Document Writer"
        .PrintToFile = True
        .PrintFileName = "c:\test.xps"
     End With
    .Print()
  End With 
```

据我所知，这是无证的。试一试，您将不会看到可怕的“另存为”对话框。相反，您会得到一个由 MXDW (c:\test.xps) 生成的干净 XPS 文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-25T10:17:56.587

只需删除并重新安装 Microsoft XPS Document Writer，在重新安装过程中按照以下步骤操作。

转到开始 - 控制面板 - 添加新打印机。然后选择本地打印机和创建新端口。在组合框中选择本地端口。将出现询问端口名称的对话框。为了让我们的 XPS 驱动程序在不询问用户位置的情况下打印到指定文件，请为此输出文件写入完整路径。该文件目前不需要存在（例如 c:\mydriveroutput.xps）。

有关详细信息，请参阅此链接：[https ://kibitzercz.blogspot.in/2012/01/building-and-using-xpsdrvsmpl-under.html](https://kibitzercz.blogspot.in/2012/01/building-and-using-xpsdrvsmpl-under.html)

# batch-file - 将数据附加到日志文件 .bat

> ID：810564
> 
> 赞同：2
> 
> 时间：2009-05-01T07:53:02.550
> 
> 标签：batch-file

此 .bat 文件用于网站复制，将文件从开发传输到生产，然后生成包含作业统计信息的日志文件。我想在日志文件中包含执行 .bat 的用户的名称。这可能吗。

到目前为止，我只能在日志文件的文件名 %USERNAME%.log 中包含用户名。

```
 @ECHO off
    IF "%1"=="" goto :Syntax
    for %%d in (%1) do call :sub0 %%d
    goto :END

    :sub0
    Echo Replicating Site %1
    rem subinacl /subdirectories D:\inetpub\%1\*.* /setowner=Administrators REM /grant=Administrators=f /grant=SYSTEM=f
    robocopy D:\inetpub\%1 \\111.111.11.11\D$\inetpub\%1 /MIR /ZB /NP /R:3 /W:3 /XD SiteReplication /XD SiteLogs /XD Administration /XD sitestatistics /XF calendar_secure.asp /XF navigation_editor.asp  /LOG:logs\test%USERNAME%.log
    robocopy D:\inetpub\%1 \\111.111.11.11\D$\inetpub\%1 /MIR /ZB /NP /R:3 /W:3 /XD SiteReplication /XD SiteLogs /XD Administration /XD sitestatistics /XF calendar_secure.asp /XF navigation_editor.asp  /LOG+:logs\test.log

    goto :EOF

    :Syntax
    ECHO Usage:  _REP_SITE WEB_Site
    ECHO.
    ECHO Where:  "WEB_Site"   is the name of the folder you want to replicate
    ECHO                      i.e. _REP_SITE www.test.com
    ECHO.
    goto :END

    :END
    exit 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T08:03:42.150

这应该有效：

```
 ECHO %USERNAME% >> LOG_FILE_NAME.LOG 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T08:05:34.173

```
setlocal
  set log=file.name
  echo. >> %log%
  date /t >> %log%
  time /t >> %log%
  echo user: %username% >> %log%
  ::...
endlocal 
```

当然，“file.name”可以包含变量值本身。

# safari - Facebook Connect 按钮未显示在 Safari/Chrome 中

> ID：810568
> 
> 赞同：9
> 
> 时间：2009-05-01T07:54:04.840
> 
> 标签：safari, google-chrome, webkit, fbconnect

我的 Facebook Connect 实现（只是一个简单的登录按钮，*fb:login-button*）在 Firefox 和 IE 上完美运行。

但是 Safari/Chrome (Webkit) 中没有显示相同的按钮。

这是具有讽刺意味的。在我的调试工作中，我将页面（包含*fb:login-button*）保存为静态页面，然后将其加载到 Safari 中。按钮出现，一切正常！

我的 PHP 呈现的完全相同的页面（具有完全相同的 HTML 源）无法调出按钮。

我在这里努力支持 Webkit，但我快要放弃了。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-10-07T06:01:31.703

我发现了另一种可能发生这种情况的方式（自责的愚蠢方式）；这可能并不常见，但如果可以省去其他人的麻烦，这里是：

此症状也可能是由各种安全工具阻止 facebook 资源引起的。

就我而言，我很久以前就在 Chrome 中安装了 Facebook Disconnect 作为插件，却忘记了它的安装过程。我还安装了第二个 Chrome，看起来完全一样（但没有 Facebook Disconnect）。第一个会正确加载 fb:login-button，而另一个不会；在我查看插件之前花了我很长时间，因为 Facebook Disconnect 没有图标，所以我很容易错过它的存在。

如果某种安全插件阻止了 Facebook 资源的加载，您将看到以下内容。只需查看使用开发人员工具在浏览器中呈现的 html。

在正常的 chrome 会话中，您最终会得到如下内容：

`<fb:login-button><a class="fb_button fb_button_medium"><span class="fb_button_text">Your text here</span></a></fb:login-button>`

但是在禁用 facebook 资源的版本中，您最终会得到以下结果：

`<fb:login-button>Your text here</fb:login-button>`

就像我说的，回想起来很明显。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-15T14:31:16.733

有同样的问题，但它与插件或格式错误的内容无关。似乎如果您在 Facebook 页面上启用国家/地区过滤，则“赞”按钮会出现问题，这应该是相当明显的。Facebook 从您的个人资料中获取您的位置，而不是您的 IP 地址。

如果您打算使用社交插件，请确保禁用国家/地区锁定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T01:05:51.180

我遇到了 Facebook 按钮根本没有显示的问题，我花了很长时间才弄清楚它是什么。幸运的是，经过几天的拉头发，我现在将与大家分享答案。在我的情况下，我根本没有启用 xfbml。在我的 FB.init 中，我将其设置为 false：

```
 FB.init({
        appId       : 'app_id', // App ID
        status      : true, // check login status
        cookie      : true, // enable cookies to allow the server to access the session
        xfbml       : false,  // parse XFBML
        oauth       : true // enable OAuth 2.0
    }); 
```

我将其更改为“ **true** ”（xfbml），登录按钮现在很好用！:P 祝你好运！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-01T22:36:33.837

这可能是由于安装了 ClickToFlash。要么禁用它，要么在 ClickToFlash 设置中选中“自动加载不可见的 Flash 视图”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-06-23T15:36:14.367

我们发现，如果您的页面带有 XHTML 响应标头 ( **application/xhtml+xml )，则 Safari（可能还有一些旧版本的 Chrome 或其他 WebKIT 浏览器）使用***innerHTML* JS 函数的 Facebook 代码存在问题。使用**text/html**解决了这个问题。

 ****对于我们使用的 JSF2，实现修复就像包装 FB 按钮一样简单，如下所示：

```
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:fb="http://www.facebook.com/2008/fbml"
    xmlns:f="http://java.sun.com/jsf/core">

...

    <f:view contentType="text/html">
        <fb:login-button>Login using Facebook</fb:login-button>
    </f:view> 
```

Facebook 错误报告在这里：
[http ://bugs.developers.facebook.net/show_bug.cgi?id=5545](http://bugs.developers.facebook.net/show_bug.cgi?id=5545)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-27T02:51:49.380

当我在 config/facebooker.yml 中的 callback_url 中有错误的域时，就会发生这种情况。显然它使用它来加载 js 文件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-12-05T06:15:49.007

我遇到了同样的问题，但我通过确保我的应用程序设置中的 URL 与我的网站的 URL 完全相同来解决它（即，当我在没有 www. 的情况下访问我的网站时它不起作用）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-07-16T09:45:46.340

我在这里尝试了所有建议的解决方案，但对我不起作用。但现在我终于找到了解决方案。

Facebook 现在需要 Canvas 的安全 (https)（安全画布 URL）。无担保的将很快被弃用。

这是主要区别，Chrome 不喜欢带有无效认证的 https 连接。在本地主机上，您很可能安装了 stunnel 以允许本地主机的 https 连接。Firefox 可以使用自行创建的 SSL 证书，并允许您在尝试访问该站点时添加例外。Chrome 不允许它开箱即用。

![在此处输入图像描述](https://i.stack.imgur.com/vqdfR.png)

当我在 Chrome 中加载我的应用程序时，页面是空白的，我没有看到任何登录按钮。

单击 F12 并单击 Chrome 中的 Netwrok 选项卡：

![在此处输入图像描述](https://i.stack.imgur.com/fgHyn.png)

您会看到对 localhost 的发布请求已被取消。双击它。

现在您会看到 chrome 因为证书而阻止了 localhost：

![在此处输入图像描述](https://i.stack.imgur.com/RY0GI.png)

无论如何点击继续。

现在回到您的其他选项卡并重新加载页面：

![在此处输入图像描述](https://i.stack.imgur.com/A96d4.png)

Chrome 现在像 Firefox 一样工作，并显示登录按钮。 ![在此处输入图像描述](https://i.stack.imgur.com/i0sxh.png)

# java - 什么数据结构将在 LIFO 中保存有界的项目堆栈？

> ID：810592
> 
> 赞同：1
> 
> 时间：2009-05-01T08:07:19.613
> 
> 标签：java, algorithm, data-structures, stack

我正在寻找一种基本上是有界堆栈的数据结构。

如果我声明堆栈最多可以容纳 3 个项目，并且我将另一个项目推入，则最旧的项目将被弹出。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T08:11:09.823

您将能够使用双端队列 ( [http://en.wikipedia.org/wiki/Deque](http://en.wikipedia.org/wiki/Deque) ) 或双端队列上的包装器来实现这一点。如果达到堆栈大小，请确保在 offerFirst 方法中调用 pollLast 方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T17:11:04.220

我会基于[环形缓冲区](http://en.wikipedia.org/wiki/Ring_buffer)编写自己的[Deque实现。](http://java.sun.com/javase/6/docs/api/java/util/Deque.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T08:08:43.167

你需要一个队列。记录第一项和最后一项的单链表。如果您想从 O(n) 更改为 O(1) 遍历以更新最后一项，则为双重链接。

您将对象推到队列的前面。如果长度大于 3，则弹回。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T08:16:14.663

那么 LIFO（后进先出）结构被称为堆栈，这是您满足主要要求的部分所需要的

FIFO（先进先出）结构被称为队列，这是您将最旧的项目从后面弹出的能力所需要的。

这些的组合称为双端队列。您必须能够从任一端推动或弹出。

我不确定 Java 是否有内置的 Deque 数据结构，但如果有（或者你可以在 google 上找到一个实现），你可以放一些包装逻辑来确保如果你推到前面，并且deque.Count > 3，然后也从后面弹出。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T08:17:23.537

这是在 C# 中，因为我害怕我不知道 Java，但这个想法应该翻译。

```
public class BoundedStack<T>
{
    private readonly int limit;
    private LinkedList<T> list;

    public BoundedStack(int limit)
    {
        this.limit = limit;
        list = new LinkedList<T>();
    }

    public void Push(T item)
    {
        if (list.Count == limit) list.RemoveFirst();
        list.AddLast(item);
    }

    public T Pop()
    {
        if (list.Count == 0) 
            throw new IndexOutOfRangeException("No items on the stack");

        var item = list.Last.Value;
        list.RemoveLast();

        return item;
    }

    public int Count()
    {
        return list.Count;
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T08:19:30.210

Apache commons 有一些接近你需要的东西，除了它是 Fifo: [CircularFifoBuffer](http://commons.apache.org/collections/api-release/index.html)。我认为您将被困在编写自定义包装器以制作类似 Lifo 的实现。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-02-25T09:28:43.533

这是我的 LIFO 实施，灵感来自 Garry Shutler 的回答

```
public class BoundedStack<T> {

    private int limit;
    private LinkedList<T> list;

    public BoundedStack(int limit) {
        this.limit = limit;
        list = new LinkedList<>();
    }

    public void push(T item) {
        if (list. size() == limit) {
            list.removeLast();
        }
        list.addFirst(item);
    }

    public int size() {
        return list.size();
    }

    public List<T> getAll() {
        return list;
    }

    public T peek() {
        return list.get(0);
    }
} 
```

# .net - DateTime 差异运算符考虑夏令时？

> ID：810600
> 
> 赞同：9
> 
> 时间：2009-05-01T08:09:58.373
> 
> 标签：.net, datetime, operator-overloading, dst

据我所知，该`DateTime`类型的差分运算符考虑闰年：所以

```
new DateTime(2008, 3, 1) - new DateTime(2008, 2, 1) // should return 29 days
new DateTime(2009, 3, 1) - new DateTime(2009, 2, 1) // should return 28 days 
```

但是夏令时呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-01-10T21:33:29.773

.NET 不能正确处理夏令时，即使它提供了您想要的答案。你*想要*不正确的答案。

**简洁版本：**

*   .NET 怎么知道由于能源危机，1977 年夏时制是全年有效的？

*   当以色列议会逐年决定规则时，.NET 怎么知道以色列的夏令时规则？

*   .NET 怎么知道美国在二战期间全年都使用 DST，并且从 1945 年到 1966 年，DST 规则因地区而异，而且规则仍然因地区而异。

.NET 尝试逃避，并使用当前的夏令时规则，即使它们没有或将要生效。结果是你得到的答案，虽然是你认为你想要的，但不正确。

来自**Raymond Chen**的博客文章，[为什么夏令时不直观](http://blogs.msdn.com/oldnewthing/archive/2003/10/24/55413.aspx)：

> 为什么（win32）时区转换函数不使用适合一年中时间的时区？
> 
> ...
> 
> Win32 不会尝试猜测在其他时间生效的时区规则。所以 Win32 说，“*星期四，2002 年 10 月 17 日，太平洋标准时间上午 8:45:38* ”。
> 
> **注：**太平洋**标准**时间。尽管 10 月 17 日是太平洋 **夏令**时间，但 Win32 仍将时间显示为标准时间，因为那是**现在**的时间。
> 
> .NET 说，“*好吧，如果现在生效的规则也在 2003 年 10 月 17 日生效，那么那将是夏令时*”，因此它显示“2003 年 10 月 17 日星期四，太平洋夏令时间上午 9:45” - 夏令时.

所以你得到的答案是错误的。但既然你期待错误的答案，那就是你得到的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T08:21:42.433

夏令时比一般的 12 个时区和使用它们的国家更具体。

不同的国家或国家组使用不同的日期来确定 DST 的发生时间。

它有点痛苦，更不用说不这样做的国家或国家的部分地区了。

例如昆士兰，非盟没有 DST，尽管该国其他地区有。

如果它不这样做，我不会感到惊讶，如果它这样做的话，至少没有文化信息 9 就无法做到）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T08:43:20.323

我不认为它会。[文档](http://msdn.microsoft.com/en-us/library/system.datetime(loband).aspx)只是说 DateTime 存储为自 0001 年 1 月 1 日午夜 12:00:00 以来的滴答数，但它没有说明午夜实际在哪个 TimeZone - 我不得不假设如果它是总是以UTC内部存储，他们会这么说。

不过，您可以轻松解决此问题：只需执行以下操作：

```
var difference = Dt1.ToUniversalTime() - Dt2\. ToUniversalTime() 
```

并且转换为 UTC 将考虑夏令时

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-04T21:56:18.963

**它不会，实际上不能**，因为它既不会强制您使用 UTC 来构造 DateTime ，也不会允许您在构造具有本地时间值的 DateTime 时指定 DST 是否有效. 此外，它允许“未指定”模式（LT 或 UTC），这只是 asinine。

通过允许从本地时间值构造 DateTime 值，可以构造一个不明确的 DateTime 值（指定为本地时间）（例如，美国 11 月 2 日凌晨 1 点到 2 点之间的任何时间，当本地时间重复时） ) 并且不能确定性地转换回 UTC，**除非构造函数提供了一个参数来指定 DST 在给定的本地时间是否有效**。

**由于它没有提供这样的参数，DateTime 类的设计是不完整和有缺陷的，未能考虑正确指定本地时间所需的所有参数。**

我认为这就是他们创建 DateTimeOffset 类的原因，它......如果你对为什么存在这样一个看似多余的类感到困惑......这就是原因。

因此，您不应该对任何未设置为 DateTimeMode.Utc 的 DateTime 实例进行任何类型的计算。仅使用 UTC。您实际上无法转换为 LT 或从 LT 转换，因为它被两个不同的错误破坏了，两种方式。1\. 从 LT 到 UTC 被破坏了，因为如前所述，它不允许您指定 DST 在 LT 的那个模棱两可的小时内是否有效。哦，它还允许您指定一个基本上不可能的本地时间，例如我们在时钟提前设置时跳过的时间。2\. 将过去的 UTC 值转换为本地时间时，Windows 会根据它是否现在生效，而不是给定的时间来抵消 DST，从而搞砸了这一点，这真是太愚蠢了。当然，当你写下一个修改时间，存储，你可能已经注意到了这个问题，或用于文件名，有一天会在 Windows 资源管理器中显示 HOUR OFF。不，你没疯，Windows 只是有一个严重的错误，他们从来没有时间在 DOS 和最新的 .NET 框架（大约 2 年）之间修复它！当然，该错误会影响 CVS 系统和任何跟踪修改时间的系统。FAT 文件系统将时间存储为本地时间，这意味着它完全被搞砸了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T08:19:38.243

测试一下看看！

编写测试就像为 DST 案例和闰年案例一样容易。

# c# - Directory.GetFiles 有效，Directory.GetDirectories 不在同一目录上

> ID：810602
> 
> 赞同：0
> 
> 时间：2009-05-01T08:10:55.953
> 
> 标签：c#, asp.net, directory, getfiles, getdirectories

我的 Web 应用程序上有一个简单的文件选择器，它使用 Directory.GetFiles 和 Directory.GetDirectories 来生成 UI。这在我的本地主机上完美运行，但是当我将它上传到我的 Windows Server 2003 主机时，我只能看到文件 - 在同一目录上，GetFiles 有效，但 GetDirectories 无效。

代码非常简单 - 字符串 dir 由 Server.MapPath 调用创建，然后：

```
List<string> dirs = Directory.GetDirectories(dir).ToList();
List<string> files = Directory.GetFiles(dir).ToList(); 
```

我已经尝试了所有我能想到的安全方面的事情；甚至可以让“每个人”完全访问 Web 根目录中的所有目录，即使这样也没什么区别。

因此，如果问题不在于安全性，我将非常感谢一些建议以尝试更多尝试！

**更新：**我很愚蠢 - 吐出 HTML 的代码包含一些非常古老的测试代码，这些代码对本地没有任何影响，因此没有被注意到和删除，但这导致服务器上的每个目录都被忽略！它以前如何？

```
if (!subDir.Contains(".")) { ... 
```

在服务器上，所有站点都位于由其域命名的文件夹中 - 在本地，它们不是。我==愚蠢。对不起大家！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T08:19:46.883

目录是否隐藏？

它们是实际目录，还是（因为这是一个网络服务器）虚拟文件夹？

顺便说一句-除非您特别想要某些`List<T>`功能，否则最好将它们保留在原始`string[]`数组中……实际上，在 3.5 中，LINQ 模糊了`List<T>`, since`Where(...)`等`First(...)`适用于数组的优点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T08:20:47.227

您是否检查过该目录是否在您认为的位置？IIS 通常可以将您放在一个临时目录中，因此它可能已将您的所有文件复制到此临时文件夹中，但没有任何子目录，因此根本没有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T08:24:29.713

如果您没有权限，您可以强制抛出异常：

```
new FileIOPermission(FileIOPermissionAccess.PathDiscovery | FileIOPermissionAccess.Read,dir).Demand(); 
```

# oop - DDD是浪费时间吗？

> ID：810606
> 
> 赞同：61
> 
> 时间：2009-05-01T08:11:42.363
> 
> 标签：oop, domain-driven-design

谷歌搜索“DDD 适合什么样的应用程序？” 给了我以下答案：

> 大约 95% 的软件应用程序属于“不太适合使用 DDD”类别。（见[文章](http://devlicio.us/blogs/casey/archive/2009/02/18/ddd-what-kind-of-applications-is-it-suited-to.aspx)）

那么大惊小怪的是什么？！？

我正在开发的应用程序*主要以*数据为中心，但仍包含一些要应用的业务逻辑和规则。开始应用 DDD 技术会浪费时间吗？我是否最好使用更传统的数据访问层、POCO 模型和业务逻辑层？或者换一种说法——什么是 DDD 的合理替代方案？

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2009-05-01T08:34:51.000

许多认为 DDD 对他们的项目有用的开发人员陷入了一个陷阱，他们认为他们的工作就是编写代码。事实并非如此。开发人员的工作是实现功能，以便可以通过软件解决问题。由此得出的结论是，编写代码不是开发人员正在做的事情的开始，而是结束：代码是实际编写代码之前整个过程的结果。

DDD 不是关于编写代码，它不是获得优秀软件的一揽子 10 步过程，它是关于编写代码之前的整个过程，它是关于深入了解问题的全部内容、参与的对象/参与者在哪些信息流中，这些元素是什么样的，它们如何相互关联等等。事实上，DDD 最重要的部分是*创建一种语言，使领域专家和开发人员之间的对话成为可能而不会产生误解*。这就是埃文斯所说的“无处不在的语言”。实际上，它使编写代码之前的整个过程成为一个几乎没有被猜测的过程，事情变得清晰而直接。（这就是目标）。

“DDD 在实践中是如何工作的”和“谁能给我一个如何用 DDD 编写代码的例子”的问题？诸如此类的问题确实来自这样一个事实，即提出此类问题的人专注于编写代码，但不知道为什么他们要编写该代码而不是其他代码。Iow：如果你意识到 DDD 是关于发现你必须写什么作为功能以及为什么写，那么事情就到位了。你如何编写代码，这取决于你。但正如所说：这不再是最大的问题，因为那时你已经知道你要写什么以及为什么要写。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-04-22T10:59:10.843

抱歉，如果 DDD 只是 Frans Bouma 所说的一种思维方式，那么它不会推荐诸如 Persistence Ignorance 之类的东西。这将其他人视为有些低级的开发人员。

DDD 至少有偏见的 PI 是一种架构选择。这不再是一种思维方式；它已经是为您服务的东西，大多数时候过于模糊的警告没有任何用处：“不适合一切”。

但是决定是否采用 PI 方式本身就是一个挑战，如果他对此感到不安，你就不能称呼某人（“编码员”）。

采用一个 ERP 软件包，整个地方都有一个类似于 MS Access 的界面：带有运行总计的网格、自动更新列和 100 000 条记录的无页滚动。显然，DDD 方法适合思考如何开发这个应用程序。但多年来，我从未见过任何人——无论是在书本上还是在网上，都通过证据支持的解释，更不用说现实生活中的代码示例，说明 PI 如何为任何想要提供**商业级应用程序和用户体验的人处理这种****无处不在**的情况。

 **不想在这件事上变得虔诚。DDD 和 DAL 的支持者往往过于虔诚，可能会赶走那些曾经被咬过但思想开放的人。许多人只想面对现实生活中的经历（即思考），而不是仅仅获得猫、汽车和基本的订单/订单项目（即糟糕的代码）来支持讲道。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-01T08:25:39.477

这是一个非常相似的问题：[您是否允许 Web 层直接访问 DAL？](https://stackoverflow.com/questions/796656/do-you-allow-the-web-tier-to-access-the-dal-directly/796961#796961)

我的所有项目都使用 DDD。在较小的应用程序中，一些概念不适用，但我发现许多方面适用于所有项目，无论大小。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-01T08:14:42.123

你知道，有时 5% 的人比其他 95% 的人赚的钱更多——这就是 DDD 存在的原因。

它适用于特定的复杂大型系统。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-01T08:33:36.227

DDD 是关于将被维护一段时间的软件。对我来说，这意味着它需要表达随领域而变化的想法。当然，一个简单的应用程序可能非常适合较短的交付时间和较短的实施时间。但是，如果您需要发展软件，那么 DDD 原则将大有帮助。DDD 一开始可能很难，但是一旦您了解了无处不在的语言和分离问题，那么事情就开始变得容易了。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-01T08:50:06.140

如果您再阅读这篇文章，您会看到：

> 对于 5% 适合 DDD 的应用程序，它非常适合。对于这些情况，DDD 将帮助您解决一个非常棘手的问题。在这里，DDD 可能是您的经理刚刚指向您办公桌的那个狼人的灵丹妙药。

这就是为什么大惊小怪。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-12-02T23:46:33.910

*   由于您的应用程序主要以数据为中心，因此您的架构可能主要是传统的。

*   对于你有更多逻辑和潜在领域或价值对象的方面，也许你可以利用一些 DDD 的想法来组织代码。

*   一般来说，“合理的选择”是让事情尽可能简单，在有用的地方使用 DDD 概念，不要让事情变得不必要地复杂化，正如文章所建议的那样。

我现在开始了一个类似的项目，它混合了数据操作和更多的逻辑/算法驱动领域。我同样希望采用 DDD 中有益于项目的部分，但不要试图在可能适得其反的领域强加它。

# internet-explorer - 浏览器的 JavaScript 开发插件

> ID：810619
> 
> 赞同：2
> 
> 时间：2009-05-01T08:16:23.680
> 
> 标签：internet-explorer, firefox, opera, devtools

是否有一个插件可以帮助除 Firefox 之外的浏览器中的 JavaScript（客户端）Web 开发，[Firebug](http://www.getfirebug.com)就足够了？

尤其是我目前遇到问题的 Internet Explorer（版本 7）和 Opera（版本 9）。

任何浏览器都欢迎有关 Firebug 等开发工具的信息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T08:24:03.067

[萤火虫精简版](http://getfirebug.com/lite.html)？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T08:25:03.987

如果您使用的是 IE8 - 按 F12，您将看到出色的开发人员工具窗口。

如果您使用的是早期版本的[IE Developer Toolbar](http://www.microsoft.com/downloads/details.aspx?familyid=e59c3964-672d-4511-bb3e-2d5e1db91038&displaylang=en)可能会很方便。

对于 Opera，您可以使用[DragonFly](http://dev.opera.com/articles/view/introduction-to-opera-dragonfly/#gettingdragonfly)或者[这](http://operawiki.info/WebDevToolbar)可能会有所帮助

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T09:11:24.360

[Safari 4（测试版）（适用于 Mac 和 PC](http://www.apple.com/safari/)）可能会对您有所帮助，但在您下载并安装后，您需要进入您的偏好设置并打开开发人员设置，然后重新启动 Safari。这将为您提供一个`Developer`文件菜单项，其中包含更改用户代理、JavaScript Profiler 和调试器的选项以及一个很棒的 Web Inspector 小窗口（停靠或浮动），可让您访问 (X)HTML、CSS、资源（资产和时间） )、JavaScript、JavaScript 分析和 HTML5 数据库。

此外，它还为您提供了一个 JavaScript 控制台，因此您可以调用当前呈现的页面以实时检查设置、变量、DOM 遍历和许多其他各种小东西。非常强大，非常好。

一旦你修改了你正在修改的内容，只需复制你的更改（或然后记下它们）对你的源进行更改。我才刚刚开始使用它的强大功能，我不得不说，到目前为止，使用它真的很有趣——令人惊讶的是。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T08:19:45.060

IE 刚拿到 IE8，内置的开发工具还不错。如果您需要测试 IE7 行为，请使用兼容模式。当然，您可能希望对 IE7 本身进行最终测试（并且您可以下载脚本调试器和开发工具以与 IE7 一起使用，但这并不那么灵活）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T08:21:13.217

[IE 开发者工具栏](http://www.microsoft.com/downloads/details.aspx?familyid=e59c3964-672d-4511-bb3e-2d5e1db91038&displaylang=en)

歌剧？永远没有选择！Webkit 可能更重要。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-01T08:22:24.507

我使用IE 的[开发者工具栏](http://www.microsoft.com/downloads/details.aspx?familyid=e59c3964-672d-4511-bb3e-2d5e1db91038&displaylang=en)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-01T08:28:25.443

Safari 4 的[Web Inspector](http://www.apple.com/safari/features.html#developer)很棒。

史蒂夫

# asp.net - asp.net登录控制

> ID：810630
> 
> 赞同：1
> 
> 时间：2009-05-01T08:19:32.907
> 
> 标签：asp.net, asp.net-ajax, login, modalpopupextender

好的，我有一个母版页，上面有一个链接按钮、popupcontrolextender、一个作为 popupcontrol 的面板和一个在面板内的登录控件。

当链接按钮被触发时，弹出面板会在内部显示登录控件，如果我尝试登录，则验证方法不会触发。

我已经尝试了许多不同的方法来让它工作，但页面似乎可以回发，但不会触发 onauthenticate 方法。

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server">
        <ContentTemplate>
         <asp:Panel ID="pnlLogin" runat="server">
        <asp:Login ID="Login1" OnAuthenticate="Login1_Authenticate" runat="server">
        </asp:Login>
        </asp:Panel>
        <asp:LinkButton ID="LinkButton1"  runat="server">LinkButton</asp:LinkButton>
        <cc1:PopupControlExtender ID="PopupControlExtender1" TargetControlID="LinkButton1" Position="Right" PopupControlID="pnlLogin" runat="server">
        </cc1:PopupControlExtender>

        </ContentTemplate>
        </asp:UpdatePanel> 
```

如果我从弹出面板中取出登录控件并将其放在页面上，猜猜看，onauthenticate 方法会触发！

任何想法的人？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T09:44:15.700

我想通了！

我在这里找到了一个有用的帖子

[http://www.brianrudloff.com/](http://www.brianrudloff.com/)

他们说

我最近遇到了一个问题，我试图动态创建一个带有按钮、标签等的面板，并使用 AJAX PopupControlExtender 弹出它。问题是，每当您单击按钮时，它都不会触发单击事件。事件在那里，它只是不会执行。无论如何，长话短说......我不得不将 Button 的 UseSubmitBehaviour 更改为 false 以使其正常工作。

即（Button1.UseSubmitBehavior = false）；

希望有人能找到这篇文章并节省一些时间。

因此，我将登录控件的按钮类型更改为链接，它起作用了！！！我认为这是popupextender的某种错误！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T08:34:22.090

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server" ChildrenAsTriggers="true" UpdateMode="Conditional">
        <ContentTemplate>
            <asp:Panel ID="pnlLogin" runat="server">

                <asp:Login ID="Login1" OnAuthenticate="Login1_Authenticate" runat="server">
                </asp:Login>
                    <asp:Button runat="server" Text="Button" ID="Unamed2" onclick="Unnamed2_Click" />

            </asp:Panel>
            <asp:LinkButton ID="LinkButton1" runat="server">LinkButton</asp:LinkButton>

            <cc1:ModalPopupExtender PopupControlID="pnlLogin" runat="server" ID="PopupControlExtender1"
                TargetControlID="LinkButton1">
            </cc1:ModalPopupExtender>
       </ContentTemplate>
        <Triggers>
            <asp:AsyncPostBackTrigger ControlID="Unamed2" />
            <asp:AsyncPostBackTrigger ControlID="Login1" />
        </Triggers>
    </asp:UpdatePanel> 
```

protected void Login1_Authenticate(object sender, AuthenticateEventArgs e) { this.PopupControlExtender1.Show(); }

现在工作正常......最终更新的代码......对不起......

# c++ - 帮助为 Netbeans 安装 C++

> ID：810651
> 
> 赞同：2
> 
> 时间：2009-05-01T08:27:52.623
> 
> 标签：c++, netbeans, cygwin, mingw

我正在尝试为 netbeans 安装 c++ .. 我尝试安装 cygwin 和 mingw 但我无法编译，因为 Mingw 附带的 make 文件不兼容..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T07:00:13.510

从 Netbeans 网站尝试[这些说明](http://www.netbeans.org/community/releases/60/cpp-setup-instructions.html)

# c# - 自动处理收到的电子邮件并发送响应

> ID：810655
> 
> 赞同：1
> 
> 时间：2009-05-01T08:30:41.837
> 
> 标签：c#, email, exchange-server

我正在从事的项目需要监控电子邮件帐户中的新消息。我可以自由决定这些消息的格式，以便更容易解析其中包含的信息。（如[请求代码：xxxxxxxxx]）

根据请求代码，我需要向原始发件人发送电子邮件回复。我以前没有做过类似的事情。请问您能建议任何方案/API/库/代码片段吗？

我在用：

*   Microsoft Exchange 服务器（将通过此服务器的电子邮件帐户接收电子邮件）
*   视觉工作室 2008 (C#)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T08:36:15.677

一个快速的谷歌搜索给出了这个：

*   [在 C# 中使用 SMTP/Exchange 发送邮件](http://www.dreamincode.net/code/snippet1870.htm)
*   [阅读 MS Exchange 电子邮件](http://www.devnewsgroups.net/group/microsoft.public.exchange.development/topic13020.aspx)
*   [C# Exchange 邮箱检查器](http://www.devnewsgroups.net/group/microsoft.public.exchange.development/topic33087.aspx)
*   [删除 Exchange 中的传入电子邮件](http://ezinearticles.com/?Removing-Incoming-Email-in-MS-Exchange,-C-Example&id=214)

如果您是电子邮件/帐户的总所有者，您还可以设置 POP3 网关并使用 POP3 收集电子邮件

编辑：如果安全不是问题，我也会远离任何附件，只需将您的信息放在正文中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T08:37:16.437

电子邮件 MimeTypes & Parsing 并不好玩，但如果你必须尝试：http: [//sourceforge.net/projects/hpop/](http://sourceforge.net/projects/hpop/)

MSMQ 可能是更好的选择。

# c++ - 在一组 27 个浮点值中选择中位数的最快代码 C/C++

> ID：810657
> 
> 赞同：39
> 
> 时间：2009-05-01T08:33:15.807
> 
> 标签：c++, c, algorithm, optimization

这是众所周知的选择算法。见[http://en.wikipedia.org/wiki/Selection_algorithm](http://en.wikipedia.org/wiki/Selection_algorithm)。

我需要它来找到一组 3x3x3 体素值的中值。由于体积由十亿体素组成，并且算法是递归的，所以最好快一点。一般来说，可以预期值相对接近。

迄今为止我尝试过的最快的已知算法使用快速排序分区函数。我想知道有没有更快的。

我已经“发明”了一个使用两个堆快 20% 的堆，但预计使用散列会更快。在实施此之前，我想知道是否已经存在闪电战快速解决方案。

我使用浮点数的事实并不重要，因为在反转符号位后它们可以被视为无符号整数。订单将被保留。

编辑：基准测试和源代码按照 Davy Landman 的建议移到了单独的答案中。请参阅下面的 chmike 的答案。

**编辑**：Boojum 在下面引用了迄今为止最有效的算法作为[快速中值和双边过滤](http://www.shellandslate.com/fastmedian.html)论文的链接，该论文现在是这个问题的答案。这种方法的第一个聪明的想法是使用基数排序，第二个是对共享大量像素的相邻像素进行中值搜索。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-01T10:23:13.623

选择算法是线性时间 (O(n))。在复杂性方面，你不能比线性时间做得更好，因为读取所有数据需要线性时间。所以你不可能做出更快的复杂性的东西。也许你有一些在某些输入上更快的常数因子？我怀疑这会产生很大的不同。

C++ 已经包含了线性时间选择算法。为什么不直接使用它？

```
std::vector<YourType>::iterator first = yourContainer.begin();
std::vector<YourType>::iterator last = yourContainer.end();
std::vector<YourType>::iterator middle = first + (last - first) / 2;
std::nth_element(first, middle, last); // can specify comparator as optional 4th arg
YourType median = *middle; 
```

编辑：从技术上讲，这只是奇数长度容器的中位数。对于偶数长度之一，它将获得“上”中位数。如果您想要偶数长度的中位数的传统定义，您可能需要运行两次，对于两个“中间值”中的每一个运行一次，`first + (last - first) / 2`然后`first + (last - first) / 2 - 1`对它们进行平均或其他操作。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-05-05T16:48:20.123

**编辑：我必须道歉。下面的代码是错误的。我有固定的代码，但需要找到一个*icc*编译器来重做测量。**

迄今为止考虑的算法的基准测试结果

有关算法的协议和简短描述，请参见下文。第一个值是超过 200 个不同序列的平均时间（秒），第二个值是 stdDev。

```
HeapSort     : 2.287 0.2097
QuickSort    : 2.297 0.2713
QuickMedian1 : 0.967 0.3487
HeapMedian1  : 0.858 0.0908
NthElement   : 0.616 0.1866
QuickMedian2 : 1.178 0.4067
HeapMedian2  : 0.597 0.1050
HeapMedian3  : 0.015 0.0049 <-- best 
```

协议：使用从 rand() 获得的随机位生成 27 个随机浮点数。连续应用每个算法 500 万次（包括先前的数组副本）并计算超过 200 个随机序列的平均值和 stdDev。使用 icc -S -O3 编译的 C++ 代码并在配备 8GB DDR3 的 Intel E8400 上运行。

算法：

HeapSort ：使用堆排序并选择中间值的完整排序。使用下标访问的幼稚实现。

QuickSort：使用快速排序和选择中间值的完整就地排序。使用下标访问的幼稚实现。

QuickMedian1：带交换的快速选择算法。使用下标访问的幼稚实现。

HeapMedian1：具有先前交换的就地平衡堆方法。使用下标访问的幼稚实现。

NthElement ：使用 nth_element STL 算法。使用 memcpy( vct.data(), rndVal, ... ); 将数据复制到向量中；

QuickMedian2：使用带有指针的快速选择算法并在两个缓冲区中复制以避免交换。基于 MSalters 的提议。

HeapMedian2 ：我发明的算法的变体，使用具有共享头的双堆。左堆具有最大值作为头部，右侧具有最小值作为头部。使用第一个值作为公共头和第一个中值猜测进行初始化。如果小于 head，则将后续值添加到左堆，否则添加到右堆，直到其中一个堆已满。当它包含 14 个值时，它是满的。然后只考虑整个堆。如果它是正确的堆，对于所有大于头部的值，弹出头部并插入值。忽略所有其他值。如果它是左堆，对于所有小于头部的值，弹出头部并将其插入堆中。忽略所有其他值。当所有值都进行了处理后，公共头是中值。它使用整数索引到数组中。使用指针（64 位）的版本似乎慢了近两倍（~1s）。

HeapMedian3 ：与 HeapMedian2 相同的算法，但经过优化。它使用无符号字符索引，避免值交换和其他各种小事情。平均值和标准差值是通过 1000 个随机序列计算得出的。对于 nth_element，我用相同的 1000 个随机序列测量了 0.508 秒和 0.159537 的 stdDev。因此，HeapMedian3 比 nth_element stl 函数快 33 倍。每个返回的中值都与 heapSort 返回的中值进行检查，它们都匹配。我怀疑使用哈希的方法可能会更快。

编辑 1：该算法可以进一步优化。根据比较结果在左堆或右堆中分派元素的第一阶段不需要堆。只需将元素附加到两个无序序列就足够了。一个序列一满，第一阶段就停止，这意味着它包含 14 个元素（包括中值）。第二阶段从堆满整个序列开始，然后按照 HeapMedian3 算法中的描述进行。我会尽快提供新的代码和基准。

编辑 2：我实现了优化算法并对其进行了基准测试。但与 heapMedian3 相比没有显着的性能差异。平均而言，它甚至会稍微慢一些。确认显示的结果。可能会有更大的集合。另请注意，我只是选择第一个值作为初始中值猜测。正如所建议的，人们可以从我们在“重叠”值集中搜索中值这一事实中受益。使用中位数算法的中位数将有助于选择更好的初始中值猜测。

* * *

**HeapMedian3的源代码**

```
// return the median value in a vector of 27 floats pointed to by a
float heapMedian3( float *a )
{
   float left[14], right[14], median, *p;
   unsigned char nLeft, nRight;

   // pick first value as median candidate
   p = a;
   median = *p++;
   nLeft = nRight = 1;

   for(;;)
   {
       // get next value
       float val = *p++;

       // if value is smaller than median, append to left heap
       if( val < median )
       {
           // move biggest value to the heap top
           unsigned char child = nLeft++, parent = (child - 1) / 2;
           while( parent && val > left[parent] )
           {
               left[child] = left[parent];
               child = parent;
               parent = (parent - 1) / 2;
           }
           left[child] = val;

           // if left heap is full
           if( nLeft == 14 )
           {
               // for each remaining value
               for( unsigned char nVal = 27 - (p - a); nVal; --nVal )
               {
                   // get next value
                   val = *p++;

                   // if value is to be inserted in the left heap
                   if( val < median )
                   {
                       child = left[2] > left[1] ? 2 : 1;
                       if( val >= left[child] )
                           median = val;
                       else
                       {
                           median = left[child];
                           parent = child;
                           child = parent*2 + 1;
                           while( child < 14 )
                           {
                               if( child < 13 && left[child+1] > left[child] )
                                   ++child;
                               if( val >= left[child] )
                                   break;
                               left[parent] = left[child];
                               parent = child;
                               child = parent*2 + 1;
                           }
                           left[parent] = val;
                       }
                   }
               }
               return median;
           }
       }

       // else append to right heap
       else
       {
           // move smallest value to the heap top
           unsigned char child = nRight++, parent = (child - 1) / 2;
           while( parent && val < right[parent] )
           {
               right[child] = right[parent];
               child = parent;
               parent = (parent - 1) / 2;
           }
           right[child] = val;

           // if right heap is full
           if( nRight == 14 )
           {
               // for each remaining value
               for( unsigned char nVal = 27 - (p - a); nVal; --nVal )
               {
                   // get next value
                   val = *p++;

                   // if value is to be inserted in the right heap
                   if( val > median )
                   {
                       child = right[2] < right[1] ? 2 : 1;
                       if( val <= right[child] )
                           median = val;
                       else
                       {
                           median = right[child];
                           parent = child;
                           child = parent*2 + 1;
                           while( child < 14 )
                           {
                               if( child < 13 && right[child+1] < right[child] )
                                   ++child;
                               if( val <= right[child] )
                                   break;
                               right[parent] = right[child];
                               parent = child;
                               child = parent*2 + 1;
                           }
                           right[parent] = val;
                       }
                   }
               }
               return median;
           }
       }
   }
} 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-09-11T20:17:29.540

由于听起来您正在对大量体积数据执行中值滤波，因此您可能需要查看 SIGGRAPH 2006 中的[Fast Median and Bilateral Filtering](http://www.shellandslate.com/fastmedian.html)论文。该论文涉及 2D 图像处理，但您可能会能够使算法适应 3D 体积。如果不出意外，它可能会给你一些关于如何退后一步并从稍微不同的角度看待问题的想法。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-05-01T10:36:55.527

这个问题不容易回答，原因很简单，一种算法相对于另一种算法的性能取决于编译器/处理器/数据结构组合以及算法本身，正如您肯定知道的那样

因此，您尝试其中几个的方法似乎已经足够好了。是的，快速排序应该很快。如果您还没有这样做，您可能想尝试插入排序，它通常在小型数据集上表现更好。这就是说，只需选择一个足够快的排序算法即可。仅仅选择“正确”的算法通常不会快 10 倍。

为了获得显着的加速，更好的方法是经常使用更多的结构。过去对我有用的一些想法解决了大规模问题：

*   您能否在创建体素并存储 28 个而不是 27 个浮点数时有效地进行预计算？

*   近似解是否足够好？如果是这样，只需查看 9 个值的中值，因为“通常可以预期值相对接近”。或者，只要值相对接近，您就可以将其替换为平均值。

*   你真的需要所有数十亿体素的中位数吗？也许你有一个简单的测试你是否需要中位数，然后只能计算相关的子集。

*   如果没有其他帮助：查看编译器生成的 asm 代码。您可能能够编写速度更快的 asm 代码（例如，通过使用寄存器进行所有计算）。

**编辑：**对于它的价值，我附上了下面评论中提到的（部分）插入排序代码（完全未经测试）。如果`numbers[]`是一个大小为 的数组`N`，并且您希望最小的`P`浮点数在数组的开头排序，请调用`partial_insertionsort<N, P, float>(numbers);`. 因此，如果您调用`partial_insertionsort<27, 13, float>(numbers);`,`numbers[13]`将包含中位数。为了获得额外的速度，您也必须展开 while 循环。如上所述，要获得真正的快速，您必须使用您对数据的了解（例如，数据是否已经部分排序？您知道数据分布的属性吗？我猜，您明白了）。

```
template <long i> class Tag{};

template<long i, long N, long P, typename T>
inline void partial_insertionsort_for(T a[], Tag<N>, Tag<i>)
{   long j = i <= P+1 ? i : P+1;  // partial sort
    T temp = a[i];
    a[i] = a[j];       // compiler should optimize this away where possible
    while(temp < a[j - 1] && j > 0)
    { a[j] = a[j - 1];
      j--;}
    a[j] = temp;
    partial_insertionsort_for<i+1,N,P,T>(a,Tag<N>(),Tag<i+1>());}

template<long i, long N, long P, typename T>
inline void partial_insertionsort_for(T a[], Tag<N>, Tag<N>){}

template <long N, long P, typename T>
inline void partial_insertionsort(T a[])
 {partial_insertionsort_for<0,N,P,T>(a, Tag<N>(), Tag<0>());} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-01T15:12:37.390

第一次尝试中最有可能使用的算法就是 nth_element；它几乎直接为您提供了您想要的东西。只需要求第 14 个元素。

第二次尝试时，目标是利用固定数据大小。由于您的算法，您根本不需要分配任何内存。因此，将您的体素值复制到一个预先分配的 27 个元素的数组中。选择一个枢轴，并将其复制到一个 53 元素数组的中间。将剩余的值复制到枢轴的任一侧。在这里你保留两个指针（`float* left = base+25, *right=base+27`）。现在有三种可能：左侧更大，右侧更大，或者两者都有 12 个元素。最后一种情况是微不足道的；你的支点是中位数。否则，在左侧或右侧调用 nth_element。Nth 的确切值取决于有多少值大于或小于基准值。例如，如果除法是 12/14，则需要大于枢轴的最小元素，因此 Nth=0，如果除法是 14/12，则需要小于枢轴的最大元素，因此 Nth=13。最坏的情况是 26/0 和 0/26，当你的支点处于极端时，但这些情况只发生在所有情况的 2/27 中。

第三个改进（或第一个，如果你必须使用 C 并且没有 nth_element）完全替换了 nth_element。您仍然拥有 53 个元素的数组，但这次您直接从体素值中填充它（将临时副本保存到 a 中`float[27]`）。第一次迭代中的枢轴只是体素[0][0][0]。对于后续迭代，您使用第二个预分配`float[53]`（如果两者大小相同，则更容易）并在两者之间复制浮点数。这里的基本迭代步骤仍然是：将枢轴复制到中间，将其余的排序到左侧和右侧。在每一步结束时，您将知道中位数是小于还是大于当前枢轴，因此您可以丢弃大于或小于该枢轴的浮点数。每次迭代，这会消除 1 到 12 个元素，平均减少 25% 的剩余元素。

如果您仍然需要更快的速度，最后的迭代是基于您的大多数体素显着重叠的观察结果。您预先计算每个 3x3x1 切片的中值。然后，当您需要 3x3x3 体素立方体的初始枢轴时，您可以取三者的中值。您先验地知道，有 9 个体素比中位数 (4+4+1) 小，9 个体素大。因此，在第一个旋转步骤之后，最坏的情况是 9/17 和 17/9 拆分。因此，您只需要在 float[17] 中找到第 4 个或第 13 个元素，而不是在 float[26] 中找到第 12 个或第 14 个元素。

* * *

背景：使用左右指针首先复制一个枢轴，然后将浮点 [N] 的其余部分复制到浮点 [2N-1] 的想法是，您在枢轴周围填充一个浮点 [N] 子数组，其中包含所有元素小于向左（较低索引）和向右较高（较高索引）的枢轴。现在，如果您想要第 M 个元素，您可能会发现自己很幸运，并且有 M-1 个元素小于枢轴，在这种情况下，枢轴就是您需要的元素。如果有超过 (M-1) 个元素小于枢轴，则第 M 个元素在其中，因此您可以丢弃枢轴和任何大于枢轴的元素，并在所有较低值中查找第 M 个元素。如果*少*比 (M-1) 个小于枢轴的元素，您正在寻找一个高于枢轴的值。因此，您将丢弃枢轴和任何比它小的东西。让*小于*枢轴的元素数，即枢轴左侧为 L。在下一次迭代中，您希望 (NL-1) 个浮点数中的第 (ML-1) 个元素大于枢轴。

这种 nth_element 算法相当有效，因为大部分工作都用于在两个小数组之间复制浮点数，这两个数组都将在缓存中，并且因为您的状态大部分时间由 3 个指针表示（源指针，左目标指针，右目标指针）。

显示基本代码：

```
float in[27], out[53];
float pivot = out[26] = in[0];     // pivot
float* left = out+25, right = out+27
for(int i = 1; i != 27; ++1)
if((in[i]<pivot)) *left-- = in[i] else *right++ = in[i];
// Post-condition: The range (left+1, right) is initialized.
// There are 25-(left-out) floats <pivot and (right-out)-27 floats >pivot 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-09-11T19:55:47.303

使用 Bose-Nelson 算法生成的排序网络将使用 173 次比较直接找到中值，无需循环/递归。如果您有能力并行执行比较，例如使用矢量算术指令，那么您可以将比较分组为少至 28 个并行操作。

如果您确定浮点数是标准化的，而不是 (qs)NaN，那么您可以使用整数运算来比较 IEEE-754 浮点数，它可以在某些 CPU 上执行得更好。

将此排序网络直接转换为 C（gcc 4.2）会在我的 Core i7 上产生 388 个时钟周期的最坏情况。

[排序网络](http://jgamble.ripco.net/cgi-bin/nw.cgi?inputs=27&algorithm=best&output=text)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-01T09:33:52.853

我想您最好的选择是采用现有的排序算法并尝试弄清楚您是否可以调整它，以便不需要对集合进行完全排序。为了确定中位数，您最多需要排序值的一半，下半部分或上半部分就足够了：

```
original:              | 5 | 1 | 9 | 3 | 3 |
sorted:                | 1 | 3 | 3 | 5 | 9 |
lower half sorted:     | 1 | 3 | 3 | 9 | 5 |
higher half sorted:    | 3 | 1 | 3 | 5 | 9 | 
```

另一半将是一桶未排序的值，它们仅共享更大/更小或等于最大/最小排序值的属性。

但是我没有现成的算法，这只是一个关于如何在排序中走捷径的想法。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-01T16:25:16.127

Alex Stepanov 的新书[Elements of Programming](https://rads.stackoverflow.com/amzn/click/com/032163537X "编程元素")详细讨论了使用最小平均比较次数来查找订单统计信息，同时最小化运行时开销。不幸的是，仅计算 5 个元素的中位数就需要大量代码，即使如此，他还是作为一个项目给出了一个替代解决方案，该解决方案平均使用较少比较的一小部分，所以我不会梦想扩展它框架来找到 27 个元素的中位数。而且这本书甚至要到 2009 年 6 月 15 日才可用。关键是因为这是一个固定大小的问题，所以有一种直接比较方法可以证明是最优的。

此外，该算法不是单独运行一次，而是多次运行，在大多数运行之间，27 个值中只有 9 个会改变。这意味着理论上一些工作已经完成。但是，我还没有听说过任何图像处理中利用这一事实的中值滤波算法。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-01T17:50:46.200

+1 对于提到 nth_element 的每个人，但这种代码是手写算法优于 STL 的地方，因为您希望为在具有特定数据集的一个 CPU 上运行的那个编译器生成最有效的代码。例如，对于某些 CPU/编译器组合 std::swap(int, int) 可能比使用 XOR 的手写交换要慢（在您回复之前，我知道这在 20 年前可能是真的，但现在不是了）。有时，性能是通过手动编写特定于您的 CPU 的汇编代码来获得的。如果您计划利用 GPU 的流处理器，您可能必须相应地设计您的算法。

您提到使用 2 个堆并在插入时跟踪中位数。这就是我前一段时间在一个项目中所做的。我就地更改了数组，只使用了一个堆。我想不出任何更快的算法，但我想提醒您注意内存使用情况，特别是 CPU 缓存内存。你要小心内存访问。CPU 缓存是按页换入和换出的，因此您希望您的算法接触靠得很近的内存，以最大程度地减少 CPU 缓存未命中。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-10-06T19:15:40.500

假设有一百万个不同的值需要从中位数。是否可以将您的中位数基于这百万的一个子集，比如说 10%。所以中位数接近第n个元素，它将值分成2个相等（或几乎相等）的子集？因此，为了找到中位数，您需要少于 O(n) 次（在这种情况下为 O(1/10n)，从而更接近 O(nlogn) 中的快速排序的最佳排序？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-01T08:51:57.633

如果您想查看算法，请查阅 Donald E. Knuth 的书籍。

PS。如果您认为自己发明了更好的东西，那么您应该能够证明其复杂性与已知算法的复杂性相似或更好。另一方面，基于桶和基数的变化是 O(n)，快速排序只有 O(n.log(n))。一个快 20% 的方法仍然是 O(n.log(n))，直到你可以展示算法:-)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-02T09:31:36.937

我打赌你可以以零成本计算它们 - 在从磁盘加载时（或者它们是生成的）在单独的线程中。

我真正要说的是，“速度”不会来自小玩意，因为 27 个值不足以让大 O 表示法成为一个真正的因素。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-03T07:01:10.893

您可能想看看 Knuth 的练习 5.3.3.13。它描述了 Floyd 的一种算法，该算法使用 (3/2)n+O(n^(2/3) log n) 比较找到 n 个元素的中位数，而隐藏在 O(·) 中的常数似乎不是在实践中太大了。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-05-01T09:24:00.257

如果有 3x3x3=27 个可能的值（如果有，为什么要浮动？），您能否创建一个包含 27 个元素的数组并在一次遍历数据中计算每种可能性？

* * *

## 回答 #15

> 赞同：-5
> 
> 时间：2014-04-12T06:05:13.303

我用于计算一维数据集中位数的超快速算法在三遍中完成了这项工作，并且不需要对数据集进行排序（！！！）。

一个非常笼统的描述如下：

*   Pass 1：扫描一维数据集，收集数据集的一些统计信息
*   Pass 2：使用数据集的统计信息并应用一些数据挖掘来创建中间（辅助）数组
*   Pass 3：扫描中间（助手）数组以找到中位数

该算法设计用于查找大于 8GE（千兆元素）的单精度浮点值（在具有 32GB 物理内存和 128GB 虚拟内存的桌面系统上）的极大一维数据集的中值，或用于查找中值硬实时环境中的小数据集。

算法是：

*   比基于堆或合并排序算法的经典算法更快，大约 60 - 75 倍
*   纯C语言实现
*   不使用任何英特尔内在函数
*   不使用任何内联汇编指令
*   在 C/C++ 编译器之间绝对可移植，例如 MS、Intel、MinGW、Borland、Turbo 和 Watcom
*   平台之间绝对可移植

最好的问候，谢尔盖·科斯特罗夫

# jasper-reports - 在 Jasper 报告中使用图表主题

> ID：810659
> 
> 赞同：4
> 
> 时间：2009-05-01T08:33:46.507
> 
> 标签：jasper-reports

我正在尝试为我的 Jasper 报告创建一个图表主题，以使所有图表都可以为公司打上烙印。

到目前为止，我已经设法发现默认图表主题似乎设置在

```
jasperreports.properties
```

使用以下属性：

```
net.sf.jasperreports.chart.theme=default.spring
```

我还在 jasper 报告下载中找到了示例图表主题应用程序，但是似乎没有与此相关的文档。

我还可以看到它需要使用

```
jasperreports_extension.properties
```

文件以指定以下属性：

```
net.sf.jasperreports.extension.registry.factory.chart.theme
```

但是，似乎没有关于实际使用此属性的文档或教程。

有没有人有使用图表主题的经验或知道我可以使用的任何文档、博客文章等？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-13T23:51:56.407

我今天也有完全相同的问题。

主题在 XML 中定义如下：

```
<timeSeriesChart>
    <chart hyperlinkType="None" theme="eye.candy.sixties">
    ....
</timeSeriesChart> 
```

要实际提供这个主题，类路径中包含的 .jar 需要提供一个[ChartThemeBundle](http://jasperreports.sourceforge.net/api/net/sf/jasperreports/charts/ChartThemeBundle.html)单例实例，该实例返回[ChartTheme](http://jasperreports.sourceforge.net/api/index.html)的子类。

然后`ChartTheme`子类必须实现一大堆方法。

可能最好的方法是下载 JasperReports 的源代码 ( [http://sourceforge.net/projects/jasperreports/files/](http://sourceforge.net/projects/jasperreports/files/) ) 并查看目录：

```
demo/samples/charts/src/net/sf/jasperreports/charts/themes/ 
```

然后，选择要扩展的主题，对其进行子类化并实现您关心的方法。

# map - 如何使用级联 UMN-mapserver 重新投影地图？

> ID：810667
> 
> 赞同：0
> 
> 时间：2009-05-01T08:38:15.063
> 
> 标签：map, mapserver, umn-mapserver, umn

我已将 UMN 配置为级联地图服务器。我希望它在通过 UMN 级联时重新投影地图。我怎样才能做到这一点？这有可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-13T20:58:14.703

我*认为*只要 MapServer 配置了 GDAL 支持，那么在图层上设置投影将自动调用使用此工具重新投影：

[http://www.gdal.org/gdalwarp.html](http://www.gdal.org/gdalwarp.html)

否则可能需要编写脚本。

您的图层定义应如下所示：

[http://mapserver.org/ogc/wms_client.html](http://mapserver.org/ogc/wms_client.html)

```
LAYER
  NAME "prov_bound"
  TYPE RASTER
  STATUS ON
  CONNECTION "http://www2.dmsolutions.ca/cgi-bin/mswms_gmap?"
  CONNECTIONTYPE WMS
  PROJECTION
   "init=epsg:42304"
  END
  METADATA
    "wms_srs"             "EPSG:42304"
    "wms_name"            "prov_bound"
    "wms_server_version"  "1.1.1"
    "wms_format"          "image/gif"
  END
END 
```

# smtp - 无法使用 PHPMailer 通过 Google SMTP 发送邮件

> ID：810669
> 
> 赞同：4
> 
> 时间：2009-05-01T08:39:29.583
> 
> 标签：smtp, phpmailer

我正在尝试使用 Google 的 SMTP 和 PHPMailer 一起发送邮件，但我无法让它工作。这是我的代码：

```
$mail->IsSMTP();
$mail->Host = "smtp.gmail.com";
$mail->SMTPAuth = true;
$mail->SMTPSecure = "ssl";
$mail->Username = "myemail@gmail.com";
$mail->Password = "**********";
$mail->Port = "465"; 
```

首先我不完全明白应该填写什么作为'SMTPSecure'，有人说' `ssl`'，其他人说' `tls`'。接下来对于“端口”，我可以输入“465”或“587”。但是这些组合都不起作用...请注意，我使用的是常规 Gmail 帐户，而不是 Google Apps。在我的 Gmail 帐户中，我启用了“POP 访问”。

我得到的错误是：“ `Must issue a STARTTLS command first`”。这意味着 SSL 失败，但不知道为什么......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T09:05:10.660

好的，问题出在 PHPMailer 的版本上。我更新到 PHPMailer 版本 5，一切都很好。我使用的是 phpMailer 1.02 版。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T08:52:42.813

通过 CodeIgniter 使用 GMail 时，我遇到了类似的问题

对我来说，更改主机选项有效：

```
$mail->Host = "ssl://smtp.googlemail.com"; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-03-24T03:57:56.910

设置 $mail->SMTPDebug = 1; 它将为您提供有关此错误的更多信息。您很可能会收到“无法找到套接字传输“ssl” - 您在配置 PHP 时是否忘记启用它”。要解决此问题，请删除“;” 来自 php.ini 中的 ;extension=php_openssl.dll 行。

PS我也喜欢XAMPP :)))

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-13T14:53:35.577

$host = "ssl://smtp.gmail.com"; $端口 = "465"

我从 SSL 更改为 ssl。有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-19T16:07:46.620

根据这里的这篇文章，谷歌可能不再提供这项服务：

[http://www.web-development-blog.com/archives/send-e-mail-messages-via-smtp-with-phpmailer-and-gmail/](http://www.web-development-blog.com/archives/send-e-mail-messages-via-smtp-with-phpmailer-and-gmail/)

# hibernate - 休眠排序

> ID：810671
> 
> 赞同：1
> 
> 时间：2009-05-01T08:40:28.690
> 
> 标签：hibernate, sorting

嘿，我想在休眠中进行嵌套排序。

我在对象中有一组`application`s 。有一个and属性。我想先排序，然后在特定类型的应用程序中排序。`course``application``time``type``type``time`

我可以按如下方式使用它吗？

```
order-by="type desc,time asc" 
```

请注意，类型应按降序排序（type 是 java 中的 int 数据类型）和 time 升序（时间是 java 中的 date 数据类型）

例如订购
类型时间
5 1
5 2
5 3
4 1
4 2

在此示例中，时间以整数形式给出

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T09:05:22.627

你可以按照你说的排序。您可能还想为您的对象添加类似的接口，以便您可以在您的服务中对它们进行排序。

以下休眠文件有一个使用 sql 位进行排序的示例

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
                                   "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
    <class name="au.gov.abs.maserati.domain.entity.CURF" 
        table="CURF" >
        <id name="ID" column="ID">
            <generator class="native" />
        </id>

        <property name="title" />
        <property name="description" />
        <property name="active"
            type="yes_no" 
            not-null="true" />

        <set name="specialConditions" cascade="none"
            order-by="sortOrder, Text1"
            where=" Discriminator in ( 'SPECIAL-CURF-AGREEMENT' ) and active = 'Y' ">
            <key column="parentID" not-null="false" />
            <one-to-many
                class="au.gov.abs.maserati.domain.entity.Condition" />
        </set>
    </class>
</hibernate-mapping> 
```

# asp.net - 使用进程外会话状态的 ASP.NET 应用程序中的 SQL Server 连接问题

> ID：810673
> 
> 赞同：31
> 
> 时间：2009-05-01T08:42:52.727
> 
> 标签：asp.net, sql-server, session

我在一个由 4 台 Windows 2003 机器组成的场中部署了几个 ASP.NET 应用程序。每个应用程序在 IIS 中使用单独的应用程序池和虚拟目录。它们严重依赖于单个 SQL Server 2000 ( )上[的进程外持久化会话。](http://idunno.org/articles/277.aspx)`<sessionstate mode="sqlserver" ... />`应用程序是针对 .NET 3.0 编译的，但 .NET 3.5 SP1 安装在服务器上。

每个 Web 服务器每秒接收大约 10 个请求。每隔一段时间，我就会在日志中遇到一些异常：

```
System.Data.SqlClient.SqlException: A transport-level error has occurred when receiving results from the server. (provider: TCP Provider, error: 0 - The semaphore timeout period has expired.)
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj)
   at System.Data.SqlClient.TdsParserStateObject.ReadSniError(TdsParserStateObject stateObj, UInt32 error)
   at System.Data.SqlClient.TdsParserStateObject.ReadSni(DbAsyncResult asyncResult, TdsParserStateObject stateObj)
   at System.Data.SqlClient.TdsParserStateObject.ReadNetworkPacket()
   at System.Data.SqlClient.TdsParserStateObject.ReadBuffer()
   at System.Data.SqlClient.TdsParserStateObject.ReadByte()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at System.Web.SessionState.SqlSessionStateStore.SetAndReleaseItemExclusive(HttpContext context, String id, SessionStateStoreData item, Object lockId, Boolean newItem) 
```

或其他：

```
System.Data.SqlClient.SqlException: A transport-level error has occurred when sending the request to the server. (provider: TCP Provider, error: 0 - An existing connection was forcibly closed by the remote host.)
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj)
   at System.Data.SqlClient.TdsParserStateObject.WriteSni()
   at System.Data.SqlClient.TdsParserStateObject.WritePacket(Byte flushMode)
   at System.Data.SqlClient.TdsParserStateObject.ExecuteFlush()
   at System.Data.SqlClient.TdsParser.TdsExecuteRPC(_SqlRPC[] rpcArray, Int32 timeout, Boolean inSchema, SqlNotificationRequest notificationRequest, TdsParserStateObject stateObj, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at System.Web.SessionState.SqlSessionStateStore.SetAndReleaseItemExclusive(HttpContext context, String id, SessionStateStoreData item, Object lockId, Boolean newItem) 
```

或者另一个：

```
System.Data.SqlClient.SqlException: Timeout expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj)
   at System.Data.SqlClient.TdsParserStateObject.ReadSniError(TdsParserStateObject stateObj, UInt32 error)
   at System.Data.SqlClient.TdsParserStateObject.ReadSni(DbAsyncResult asyncResult, TdsParserStateObject stateObj)
   at System.Data.SqlClient.TdsParserStateObject.ReadNetworkPacket()
   at System.Data.SqlClient.TdsParserStateObject.ReadBuffer()
   at System.Data.SqlClient.TdsParserStateObject.ReadByte()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlDataReader.ConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader()
   at System.Web.SessionState.SqlSessionStateStore.DoGet(HttpContext context, String id, Boolean getExclusive, Boolean& locked, TimeSpan& lockAge, Object& lockId, SessionStateActions& actionFlags) 
```

这些错误每天发生几次，持续约 1-2 分钟，然后消失。有没有人遇到过这样的问题？为了进一步追查问题，你能建议我做什么？对我来说，它看起来更像是网络问题而不是应用程序。可能是 SQL Server 上的某些设置无法处理这么多的并发连接吗？任何建议将不胜感激。

* * *

更新：

我通过对应用程序执行主要更新来解决这个问题，以减少会话中存储的对象的数量和大小。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-01T08:52:44.747

传输级别错误通常与连接到 sql server 的连接被破坏......通常是网络。

当 sql 查询运行时间过长时，通常会抛出 Timeout Expired。

因此，我将对指向您的 Sql Server 的链接进行故障排除，然后监视以查看哪些查询超时。

听起来像是 SQL 作业正在运行，备份？这可能是锁定表或重新启动服务。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-11-25T13:33:09.400

在我的情况下，问题与主机 TCP 配置（VMWare 中的虚拟机）有关。经过快速研究（在 Google 和[MSDN 博客中找到了](http://blogs.msdn.com/b/spike/archive/2009/04/16/a-transport-level-error-has-occurred-when-sending-the-request-to-the-server-provider-tcp-provider-error-0-an-existing-connection-was-forcibly-closed-by-the-remote-host.aspx)[一些文章](http://www.dedicatedsqlserver.com/HowTo/SynAttackProtect.aspx)），我在系统注册表中关闭了： (0) 和(0)。现在它工作得很好。当然，这只是测试机器（从 Internet 看不到公司网络），我不会在生产环境中这样做；-)`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\synattackprotect``HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\EnableTCPChimney`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-11-07T16:05:02.027

查询的长度可能会超过 65,536 * 网络数据包大小（默认 4KB）的限制。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-22T07:02:55.210

在连接字符串中设置 CommandTimeout = 120。

尝试在 web.config 中添加连接超时：

```
<add key="DBConnection" value="server=LocalHost;uid=sa;pwd=;database=DataBaseName;Connect Timeout=200; pooling='true'; Max Pool Size=200"/> 
```

如果这有效，请回复....

# c++ - 什么 utf 格式应该提升 wdirectory_iterator 返回？

> ID：810677
> 
> 赞同：0
> 
> 时间：2009-05-01T08:47:38.283
> 
> 标签：c++, unicode, boost, utf-8

如果文件包含 £（磅）符号，则 directory_iterator 正确返回 utf8 字符序列 \xC2\xA3

wdirectory_iterator 使用宽字符，但仍返回 utf8 序列。这是 wdirectory_iterator 的正确行为，还是我使用不正确？

```
AddFile(testpath, "pound£sign"); 
wdirectory_iterator iter(testpath);
TS_ASSERT_EQUALS(iter->leaf(),L"pound\xC2\xA3sign"); // Succeeds
TS_ASSERT_EQUALS(*iter, L"pound£sign"); // Fails 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T09:01:56.597

宽字符（`wchar_t`对象）的编码取决于实现。要使第二个语句（即 L"pound£sign"）起作用，您可能需要更改基础语言环境。默认值为“C”，它不知道井号字符。十六进制值成功，因为这不需要将字形映射到特定编码中的值。

注意：为简洁起见，我跳过了标准 wrt wchar_t、扩展字符集等的确切措辞。

# iphone - iPhone - 当视图映射正确时为什么会出现此错误？

> ID：810687
> 
> 赞同：0
> 
> 时间：2009-05-01T08:54:27.893
> 
> 标签：iphone

我的 iPhone 应用程序运行良好。我在我的 xib 文件中添加了一个组件（一个活动指示器）。我创建了自己的 init 方法，并在 init 方法中使用了 XIB 名称。现在当我执行 pushViewController 时出现此错误

```
Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: '-[UIViewController _loadViewFromNibNamed:bundle:] loaded the "ModelThumbnailView" nib but the view outlet was not set.' 
```

我知道这通常会在视图控制器未映射到 xib 中的视图时出现。但是所有映射都很好。我什至删除了类和 xib 并再次创建它们。init 方法也没有返回 nil。但是，当我使用此类的对象调用 pushViewController 时，我仍然会收到异常。

任何想法为什么？

**编辑**

只是在调用 pushViewController 之前在 viewcontroller 中调试并调用了一个方法。调试器显示 nib 名称设置正确，bundle 为 nil（因为这就是正在传递的内容）但视图也是 nil。不知道为什么！！！

**发布代码以防万一**

```
MyThumbnailViewController *modCont = [[[MyThumbnailViewController alloc] initWithNibName:@"MyThumbnailView" bundle:nil] autorelease];
[modCont setImgName:imgName count:numOfValues andIndex:0];

[[self navigationController] pushViewController:modCont animated:YES]; //This gives the exception 
```

这是 MyThumbnailViewController 类的 viewDidLoad。控制永远不会到达这里

```
- (void)viewDidLoad {
    self.navigationItem.title = imageName;
    self.navigationItem.hidesBackButton = NO;
    [[self navigationController] setNavigationBarHidden:NO];
} 
```

我删除了自定义 init 方法，但仍然遇到相同的错误。

***解决了***

刚刚再次创建了整个东西，现在它工作正常，虽然我没有看到这两种东西有任何区别！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T09:01:30.467

我确定您已经尝试过，但以防万一您在调用该方法以处理您的 pushView 之前在该位置设置了断点，并单步执行代码以查看引发异常的位置。这有时会有所帮助。我稍后会回来看看你发现了什么，看看我是否可以提供更多帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T10:08:15.983

听起来很奇怪，但为了安全起见，可能会再次检查以下内容：打开 IB 并选择文件的所有者。然后在 Identity Inspector 中确保 Class 设置为您的自定义 View Controller。打开 Connections Inspector 并确保视图 Outlet 已连接到 NIB 中的视图（这是异常所抱怨的）。

保存 XIB 文件并关闭 IB。然后在 XCode 中选择 Build->Clean All Targets 并尝试运行您的应用程序。

我不止一次看到 IB 和 XCode 分道扬镳，我急切地在 IB 中编辑我的应用程序永远不会加载的视图，因为我没有将它们添加到我的项目中。所以我能感觉到你的痛苦:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T16:01:52.290

我遇到了同样的错误 - 在四处寻找之后，我将 VIEW OUTLET（在文件所有者中）重新连接到 VIEW CONTROLLER 中的 VIEW（我刚刚连接到 VIEW 屏幕的主要部分 - 抱歉，我对这一切都很陌生，所以我确定我我没有用正确的名字来称呼这些东西）并且修复了它。它以前曾起作用，但我所做的某些事情一定破坏了该链接。

雾之城

# sharepoint - 更新 Sharepoint 文档库中的文件

> ID：810691
> 
> 赞同：0
> 
> 时间：2009-05-01T08:55:23.367
> 
> 标签：sharepoint, document-library, event-receiver

简单地说，我在文档库中有一个自定义的 editForm.aspx，它使用我自己的自定义 dll。当用户编辑记录时，我可以更新与文件关联的所有属性，但是，当您更新实际文档（即替换它）然后更新（）（或 SystemUpdate（））时，您会得到以下信息：

文件 BLAH.doc 已由 DOMAIN\ACCOUNT 于 2009 年 5 月 1 日 09:41:12 +0100 修改。

文件被替换了，但文件属性都没有更新，所以路径和文件名和旧版本一样！？

这个帖子： [http](http://hristopavlov.wordpress.com/2008/05/14/uploading-a-file-event-receivers-the-file-has-been-modified-by/) ://hristapavlov.wordpress.com/2008/05/14/uploading-a-file-event-receivers-the-file-has-been-modified-by/ 建议使用事件接收器，任何人都这样做使用 DisableEvents() 与工作流有类似的问题。这很棒，但我不知道如何更改我的编辑表单以与事件接收者一起使用。是否有关于更新文档库中的文件以及如何使用事件接收器来完成此操作的文档/教程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-06T03:33:07.703

事件接收器将与编辑表单完全分开 - 除了保存用户输入的任何内容之外，您不会在编辑表单中做任何特别的事情。当您的表单或标准表单之一修改项目时，将调用事件接收器。

# .net - .NET 3.5 与 .NET 3.0

> ID：810693
> 
> 赞同：3
> 
> 时间：2009-05-01T08:55:51.947
> 
> 标签：.net, .net-3.5, .net-3.0

我想在 WPF 中编写一个程序，但不确定我应该以 .net35 还是 .net30 为目标。.net35 的优势是显而易见的。但是，我仍然看到 .net30 的一个主要优势——它内置于 Vista 中，因此，使用 Windows Vista 的人不必下载和安装该框架。

您认为 .net35 的优势是否超过了下载约 200 兆和安装的麻烦？

附言

实际上，我不需要像 linq 等高级的东西。所以，我想 .net30 就足够了。还是我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T08:58:46.697

你是对的：不要求用户下载另一个框架绝对是一个优势。

一些提示：如果您打算以 FW3.0 为目标，您仍然可以使用 Studio 2008 而不是 Studio 2005 - 以及 C# 3.0 或 VB 9.0 编译器。只需在项目属性中将目标框架设置为 3.0。此外，您仍然可以通过 LINQBridge 使用 LINQ to Objects。

如果您正在访问数据库，您将错过 LINQ to SQL（或实体框架），我发现它确实简化了中间层的开发。对我来说，这将是支持 Framework 3.5 的一个理由。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T08:59:39.877

如果您使用 3.5 编译器，您可以使用许多 3.5 功能，例如扩展方法。但是如果 200mb 的下载量是一个严重的问题，那么以 3.0 为目标不会对你造成太大伤害

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T09:04:12.677

您需要的是 .NET Framework 3.5 SP1 [Client Profile](http://blogs.windowsclient.net/trickster92/archive/2008/05/21/introducing-the-net-framework-client-profile.aspx)，它为您提供 3.5 且安装大小最小，通常为 2x MB。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T08:58:59.427

我认为这是一个只有你能回答的问题。让用户下载/安装另外 200 兆字节的空间是您为未来做准备的方式吗？尽管您说您不需要高级的东西，但您永远不知道将来是否需要它。

显然，您总是可以从 3.0 开始，当您真正需要 3.5 时，将您的项目升级到较新的版本（到那时当然也可能是 4.0 版本）。

# sql-server - 设置对 MSSQLServer 分析多维数据集的只读访问权限的正确方法是什么

> ID：810704
> 
> 赞同：1
> 
> 时间：2009-05-01T08:59:35.400
> 
> 标签：sql-server, ssas, olap

人们似乎无法从多维数据集获取数据，除非我将服务器上的数据库权限设置为“完全控制”。在 Microsoft SQL Server Analysis Server 中授予对多维数据集（仅）读取访问权限的正确方法是什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T06:26:34.317

为了让某人访问多维数据集，您需要做的最低限度是设置一个角色，将相关帐户和组添加到该角色，然后进入多维数据集选项卡并将权限从“无”更改为“读取”对于您希望他们看到的立方体。

# flash - 在其他 Flash 电影上启用加载电影按钮事件

> ID：810706
> 
> 赞同：0
> 
> 时间：2009-05-01T08:59:42.857
> 
> 标签：flash, load, movie

在我的 Flash 电影中，我加载了另一个带有按钮的 Flash 电影。问题是当我触发按钮时，加载闪光灯上的事件不起作用。当我检查按钮时，它会通过父剪辑上的根函数触发事件。当我在我的 Flash 电影上加载它时，如何在加载电影上启用按钮事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-03T20:30:38.657

您使用的是哪个版本的 actionscript？

如果您使用的是 as2.0，请使用 MovieClipLoader 类来加载您的 swf 并尝试在[onLoadInit](http://livedocs.adobe.com/flash/8/main/wwhelp/wwhimpl/js/html/wwhelp.htm?href=Part4_ASLR2.html)事件处理程序中访问您的按钮。

如果您使用的是 as3.0，再次...尝试访问您在Loader 实例的[Event.INIT处理程序中的按钮。](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/events/Event.html#INIT)请记住，在 as3 中，您将侦听器广告为您的 Loader 的 contentLoaderInfo 属性，而不是直接侦听 Loader 实例。

一旦你的 swf 被加载**并且**里面的类/实例已经被初始化，init 事件就会被触发，所以你应该能够访问它们。

祝你好运！

# vim - UTF8 中的 Gvim 和俄语键盘布局

> ID：810707
> 
> 赞同：1
> 
> 时间：2009-05-01T08:59:56.057
> 
> 标签：vim, utf-8, internationalization, keyboard-layout

我是 vim 和 gvim 的忠实粉丝。但是每当我用 PHP 编写本地化代码并且必须翻译一些字符串（主要是俄语）时，我必须打开记事本来翻译所有条目。这有点糟糕，但到目前为止我还没有找到如何让 gvim 在 utf8 模式下工作。任何想法，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T09:08:13.837

把这些放到你的 .vimrc 中：

```
set encoding=utf-8
set fileencodings=ucs-bom,utf-8 
```

您现在应该可以使用 UTF8 文件了。

# sql - WHERE IS NULL、IS NOT NULL 或 NO WHERE 子句取决于 SQL Server 参数值

> ID：810714
> 
> 赞同：35
> 
> 时间：2009-05-01T09:02:09.653
> 
> 标签：sql, sql-server, sql-server-2000

我在 SQL Server 2000 中有一个基于参数值执行搜索的存储过程。对于传入的参数之一，我需要一个不同的`WHERE`子句，具体取决于它的值 - 问题是这 3 个值将在哪里`MyColumn`

1.  `IS NULL`
2.  `IS NOT NULL`
3.  `ANY VALUE (NULL AND NOT NULL)`（基本上没有`WHERE`条款）

我在想出正确的语法时遇到了一些心理障碍。这是否可以在一个选择语句中完成而不执行一些`IF @parameter BEGIN ... END`分支？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-05-01T09:07:22.653

以下是使用单个`WHERE`子句解决此问题的方法：

```
WHERE (@myParm = value1 AND MyColumn IS NULL)
OR  (@myParm = value2 AND MyColumn IS NOT NULL)
OR  (@myParm = value3) 
```

CASE 语句的天真用法**不起作用**，我的意思是：

```
SELECT Field1, Field2 FROM MyTable
WHERE CASE @myParam
    WHEN value1 THEN MyColumn IS NULL
    WHEN value2 THEN MyColumn IS NOT NULL
    WHEN value3 THEN TRUE
END 
```

可以使用 case 语句解决此问题，请参阅 onedaywhen 的[答案](https://stackoverflow.com/a/811579/61989)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-01T09:08:01.730

你可以这样做：

```
SELECT *
FROM foo
WHERE (@param = 0 AND MyColumn IS NULL)
OR (@param = 1 AND MyColumn IS NOT NULL)
OR (@param = 2) 
```

类似的东西。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-01T14:24:01.800

这是如何使用它来完成的`CASE`：

```
DECLARE @myParam INT;
SET @myParam = 1;

SELECT * 
  FROM MyTable
 WHERE 'T' = CASE @myParam
             WHEN 1 THEN 
                CASE WHEN MyColumn IS NULL THEN 'T' END
             WHEN 2 THEN
                CASE WHEN MyColumn IS NOT NULL THEN 'T' END
             WHEN 3 THEN 'T' END; 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-05-01T09:11:26.963

```
WHERE MyColumn = COALESCE(@value,MyColumn) 
```

*   如果`@value`是`NULL`，它将`MyColumn`与自己进行比较，忽略 `@value = no where`子句。

*   IF`@value`有一个值 ( `NOT NULL`)，它将`MyColumn`与 `@value`.

***参考：*** [COALESCE (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms190349.aspx)。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-07-18T10:18:20.660

CASE的另一种方式：

```
SELECT *  
FROM MyTable
WHERE 1 = CASE WHEN @myParm = value1 AND MyColumn IS NULL     THEN 1 
               WHEN @myParm = value2 AND MyColumn IS NOT NULL THEN 1 
               WHEN @myParm = value3                          THEN 1 
          END 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-08-17T12:56:54.063

我在这个解决方案上取得了成功。这几乎就像帕特里克的，有点扭曲。您可以单独或按顺序使用这些表达式。如果参数为空，它将被忽略并显示您搜索的列的所有值，包括 NULLS。

```
SELECT * FROM MyTable
WHERE 
    --check to see if @param1 exists, if @param1 is blank, return all
    --records excluding filters below
(Col1 LIKE '%' + @param1 + '%' OR @param1 = '')
AND
    --where you want to search multiple columns using the same parameter
    --enclose the first 'OR' expression in braces and enclose the entire 
    --expression 
((Col2 LIKE '%' + @searchString + '%' OR Col3 LIKE '%' + @searchString + '%') OR @searchString = '')
AND
    --if your search requires a date you could do the following
(Cast(DateCol AS DATE) BETWEEN CAST(@dateParam AS Date) AND CAST(GETDATE() AS DATE) OR @dateParam = '') 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-02T21:29:03.557

这种逻辑可以使用`EXISTS`：

```
CREATE TABLE tab(a INT, b VARCHAR(10));
INSERT INTO tab(a,b) VALUES(1,'a'),(1, NULL),(NULL, 'a'),(2,'b'); 
```

询问：

```
DECLARE @a INT;

--SET @a = 1;    -- specific NOT NULL value
--SET @a = NULL; -- NULL value
--SET @a = -1;   -- all values

SELECT *
FROM tab t
WHERE EXISTS(SELECT t.a INTERSECT SELECT @a UNION SELECT @a WHERE @a = '-1'); 
```

**[db<>小提琴演示](https://dbfiddle.uk/?rdbms=sqlserver_2019&fiddle=65e5ef147cd51627076bad76098f5b98)**

它可以扩展为包含多个参数：

```
SELECT *
FROM tab t
WHERE EXISTS(SELECT t.a INTERSECT SELECT @a UNION SELECT @a WHERE @a = '-1')
  AND EXISTS(SELECT t.b INTERSECT SELECT @b UNION SELECT @a WHERE @b = '-1'); 
```

# sql-server-2000 - SQL Profiler 2000 不会暂停或停止

> ID：810719
> 
> 赞同：2
> 
> 时间：2009-05-01T09:03:17.670
> 
> 标签：sql-server-2000, profiler

有没有人看到 SQL Profiler 2000 出现无法暂停或停止跟踪的问题？我可以阻止它的唯一方法是执行控制 - alt - 删除然后结束应用程序进程。这只是随机开始发生的。暂停和停止按钮也变灰。

非常感谢您对此问题的任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-05-12T05:26:12.793

刚刚在运行 SQL Server 2000 SP4 的 Windows 2003 Server 虚拟机上使用 Profiler 时遇到了这个问题。增加分配的内存没有任何区别。

验证您的服务器名称在 master 数据库的 sysservers 表中是否正确。更改 SQL Server 计算机名称时的一个常见错误是不更新 sysservers 表。

如果您输入“.”，Profiler 会从 sysservers 表中解析服务器名称。或“（本地）”在创建跟踪时连接到 SQL Server。您可以在连接后在跟踪属性的常规选项卡上或在跟踪本身的标题栏上检查跟踪 SQL Server 名称。

如果显示的名称不是实际的服务器名称，那么您可以预期 Profiler 的行为如上所述。

解决方法：如果您使用实际服务器名称或“127.0.0.1”而不是“.”进行连接 或“（本地）”，则 Trace SQL Server 名称应正确显示，并且 Profiler 应允许您停止/暂停/运行选定的跟踪。

解决方法：确保在更改 SQL Server 计算机名称后[已执行所有适用的步骤。](http://www.karaszi.com/SQLServer/info_change_server_name.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T21:44:42.803

是的，我一直都在发生这种情况——恢复它的最简单方法是终止连接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T09:19:47.630

我已经看到这种情况在某些（虚拟）机器上始终如一地发生 - 单击停止按钮会导致它变灰（但不能启用启动等），但似乎在“停止”状态下永远等待而没有实际停止。不幸的是，我没有解决办法。

但是，发生这种情况的系统都是资源相当低的 VPC。这总是发生在 VPC 上，但从来没有发生在我的桌面系统上，这让我怀疑这可能与低内存可用性有关，或者与 VPC 环境有关，但我从未确定过这一点。

当时，我通过远程连接，在我自己的机器上运行分析器来解决这个问题。如果这是一台低规格的机器/VPC，可能值得尝试一下，或者在使用分析器之前关闭机器上的所有应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T09:57:20.457

我认为我们需要更多信息来帮助您。

*   你是在虚拟机上运行吗？
*   你运行它多久？
*   请举例说明您使用 SQL Profiler 跟踪的内容。（SQL 代码、数据库表等？）
*   当它不会暂停或停止时，在查询分析器中运行**sp_who**以查看是否有任何内容被阻止
*   您在服务器上的硬件设置是什么？（内存/处理器等）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-03T13:08:46.990

如果您使用虚拟机 - 输入`SQL Server 127.0.0.1`而不是`"local"`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T09:16:08.183

你有多少耐心？这是几秒钟，几分钟，半小时？您在谈论多少数据以及通过什么样的连接。

在查看使用率非常高的数据库之前，我不得不等待分析器“赶上”。

如果我一直在通过较慢的 vpn 连接进行分析，我还必须等待它响应。

两者的结合可以让你等待一段时间。

# workflow-foundation - 向现有 Windows 工作流程添加新状态？

> ID：810723
> 
> 赞同：1
> 
> 时间：2009-05-01T09:05:00.270
> 
> 标签：workflow-foundation

如果我有一个长时间运行的工作流程（持续数月......）并且如果我需要例如添加新状态或更改它。（由于错误修复或新功能）。

现有工作流程会发生什么？他们会迷路吗？还是我需要一些版本控制？还是它会接受新的状态并继续下去？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-01-26T16:29:53.457

对工作流的更改不会影响已经执行的工作流。整个工作流以当前状态序列化到您的持久性存储中。

如果您想修改现有的工作流程，您实际上需要经历很多麻烦来实现这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T09:10:30.990

如果工作流程可以正确地补水，我认为它会选择新的程序集。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-12-13T14:53:40.650

假设配置了持久性，正在进行的工作流不会丢失 - 它们留在实例存储中等待恢复，但总的来说，我读过的大部分内容都是由声誉良好的人（Ron Jacobs/Maurice）和其他人说的对现有工作流程的几乎所有更改都能够中断正在进行的工作流程。我个人还没有做出没有破坏我的更改（但我无论如何都不是专家），因此确定您是否需要管理不同版本的工作流程流程是您需要尽早处理的事情可能在您的计划中。

您需要尽早确定在错误修复和/或新功能的情况下会发生什么，然后决定是否允许正在进行的工作流以当前定义完成，或者是否需要终止并重新- 使用新定义运行。

如果您必须终止并重新运行，那么您不一定需要处理工作流版本控制，但您需要处理正在进行的工作流的任何“工件”——删除它们？你自己对它们进行“更新”吗？

如果您可以让工作流程完成，并且只有新启动的流程使用更新的工作流程，您将需要处理工作流程的版本控制。这就是我目前面临的问题，虽然这些概念并不是特别困难（WCF 路由），但我发现实现细节令人生畏。

# .net - 为非常量类型的属性设置 DefaultValue？

> ID：810726
> 
> 赞同：3
> 
> 时间：2009-05-01T09:05:51.830
> 
> 标签：.net, properties, windows-forms-designer

我有一个 Windows.Forms 组件，它有一个返回 Size 结构的“mySize”属性。我的意图是让这个属性根据组件的大小自动计算返回的 mySize，除非 mySize 已明确设置，在这种情况下，返回 mySize 的设置值。不幸的是，现在我将组件嵌入到窗体中，Windows 窗体设计器决定开始显式生成并设置 mySize 属性的值，这让我很头疼。

所以我需要设置一个 DefaultValue，这样设计师就会走开，让我一个人呆着。

我已经阅读了处理 System.ComponentModel.DefaultValue 的答案，所以我知道我必须在构造函数中手动设置属性的值，但我发现的答案和文档只处理设置 False 的 DefaultValue，一个持续的。

Size 结构不是常量，因此 VB 编译器吓坏了，告诉我我不能将 Size 设置为 Size 类型的属性的 DefaultValue，因为 Sizes 不是常量。

这让我的大脑很受伤。

我可能可以通过使用 getMySize 和 setMySize 方法而不是使用属性来解决这个问题，但我想知道实际上是否有任何方法可以为 Size 设置默认属性。

注意：我没有将 mySize 用作覆盖 Size 属性的某种疯狂尝试（其 DefaultValue 为 150x150，因此 SOMETHING 似乎能够为 Sizes 设置 DefaultValues）；mySize 只是 Class 所需的一些 Size 值。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T09:11:40.863

不要应用 DefaultValue 属性，而是编写以下两个方法：

```
bool ShouldSerializemySize() { ... }
void ResetmySize() { ... } 
```

在 ShouldSerializemySize 中，如果值应序列化为代码，则返回 true。在 ResetmySize 中，将属性重置为其默认值。

组件设计者将通过反射自动选择这些方法。

更多信息在这里：http: [//msdn.microsoft.com/en-us/library/53b8022e (VS.71).aspx](http://msdn.microsoft.com/en-us/library/53b8022e(VS.71).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T09:26:50.593

我注意到，在[DefaultValue 的 MSDN 页面](http://msdn.microsoft.com/en-us/library/system.componentmodel.defaultvalueattribute.aspx "DefaultValue 的 MSDN 页面")的 Community Content 部分中，实际上给出了一个设置 Size 类型的 defaultValue 的具体示例，它建议使用[此页面](http://msdn.microsoft.com/en-us/library/tx59291k.aspx "DefaultValueAttribute 构造函数（类型，字符串）")上描述的 DefaultValue 构造函数。

不幸的是，虽然给出的示例是正确的，但它确实有效，但在我看来，MSDN 文档不会自然而然地引导任何人找到这个答案。

我将设置 albahari 的答案作为这个问题的答案（因为他的回答至少有某种意义），为了完整起见，把这个例子留在这里。

# windows - 为 microsoft windows 编写内核的基本要求是什么

> ID：810733
> 
> 赞同：-1
> 
> 时间：2009-05-01T09:08:24.693
> 
> 标签：windows, linux, kernel

作为程序员我应该学习什么来编写像微软windows这样的内核

我知道c和c++，但是我应该怎么写内核是有必要了解linux内核编程的基础知识吗？

如何成为 linux 和 windows 内核编程专家

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T10:00:18.593

如果你有钱，[OSR](http://www.osr.com/)的人会举办出色的研讨会。[否则，您可以从他们的网站http://www.osr.com/](http://www.osr.com/)学到很多东西。

更新：他们现在有一个专门用于自助的网站：[http](http://www.osronline.com/) ://www.osronline.com/ 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T09:46:05.350

以下网站可能对您有用

[http://www.osdev.org/](http://www.osdev.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T09:12:54.933

1.  给自己一个[DDK 或 WDK](http://www.microsoft.com/whdc/devtools/wdk/default.mspx)
2.  阅读大量文件或书籍。WDK 网站有很多资源。
3.  等等，你想成为 MSFT 的内核开发人员吗？那么你需要一个聪明的大脑。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T09:12:56.400

您可能应该从获得使用其他内核（如 Linux）的经验开始。

微软可能不会让你在没有经验的情况下接触他们的内核。

如果您指的是驱动程序开发，那么到处都有 DDK 和教程。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T09:15:06.923

了解内核。学习编写内核代码。编写设备驱动程序是一个开始。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T09:12:19.287

[学习 C](http://www.joelonsoftware.com/articles/CollegeAdvice.html)（和其他一些东西）。

# c# - 我的网络服务无法登录到本地数据库

> ID：810734
> 
> 赞同：2
> 
> 时间：2009-05-01T09:09:22.303
> 
> 标签：c#, asp.net, web-services

我做了一个 Web 服务，它有两个 Web 方法，一个方法使用 xml 文件来获取数据，另一个使用我机器上的数据库，第一种方法工作正常但是当我使用对象调用第二种方法时来自我的 aspx 页面的 web 服务，我得到了下面提到的异常，我是这方面的初学者，已经浪费了很多时间来解决问题，所以现在需要你的经验的帮助..

> System.Data.SqlClient.SqlException：用户“D-11083\ASPNET”登录失败。在 System.Data.SqlClient.SqlInternalConnection.OnError（SqlException 异常，布尔 breakConnection）
> 在 System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj) 在 System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior，SqlCommand cmdHandler，SqlDataReader dataStream，BulkCopySimpleResultSet bulkCopyHandler，TdsParserStateObject stateObj) 在 System.Data.SqlClient.SqlInternalConnectionTds.CompleteLogin (Boolean enlistOK) 在 System.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, Boolean ignoreSniOpenTimeout, Int64 timerExpire, SqlConnection owningObject) 在 System.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(String host, String newPassword, Boolean redirectedUserInstance, SqlConnection owningObject, SqlConnectionString connectionOptions, Int64 timerStart)
> 在 System.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(SqlConnection owningObject, SqlConnectionString connectionOptions, String newPassword, Boolean redirectedUserInstance) 在 System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, Object providerInfo, String newPassword, SqlConnection owningObject,在 System.Data.ProviderBase.DbConnectionFactory.CreateNonPooledConnection(DbConnection owningConnection, DbConnectionPoolGroup poolGroup) 在 System.Data.ProviderBase 的 System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions 选项，对象 poolGroupProviderInfo，DbConnectionPool 池，DbConnection owningConnection) 的 Boolean redirectedUserInstance)。数据库连接工厂。GetConnection(DbConnection owningConnection) at System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory) at System.Data.SqlClient.SqlConnection.Open() at BLL.BLLclass.get_zodiac_dll(DateTime yourdate) in c:\WebSite7\ App_Code\BLL.cs：第 58 行
> 在 BLL.BLLclass.get_zodiac_bll(DateTime yourdate) 在 c:\WebSite7\App_Code\BLL.cs:line 73
> 在 Service.get_zodiac(DateTime date) 在 c:\WebSite7\App_Code\Service.cs:line 29

注意：d-11083 是我的机器名称，并且提到错误的行，它们正在返回输出..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T09:11:11.160

在您的连接字符串中，您需要指定对数据库具有适当访问权限的用户的用户名和密码。对于测试，您可以临时启用 SA 帐户并使用 SQL Server 身份验证来简化此操作。现在，您正尝试使用可能没有（也不应该）访问您的数据库的 ASPNET 用户的上下文登录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T09:12:59.237

因此，Web 服务正在尝试使用默认 Web 服务器帐户的 Windows 身份验证登录数据库。

sql server 是否允许 windows 身份验证？该特定帐户是否已授权？

您可能不希望 ASPNET 用户像自己一样访问数据库，但是您可以通过在 web.config 中放置类似的内容来使其冒充另一个用户来访问数据库

```
<identity impersonate="true" userName="domain\username" password="passwordgoeshere"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T11:17:31.187

通过 Windows 身份验证，您的用户正在使用 Windows 身份验证对 Web 服务进行身份验证。这并不意味着 Web 服务可以使用用户的凭据向 SQL 服务器进行身份验证。您正在寻找的是模仿。

您的 SQL 服务器与 Web 服务在同一台计算机上吗？在这种情况下，您应该可以正常模拟。MSDN 有一篇关于 ASP.Net 中的模拟的好[文章。](http://msdn.microsoft.com/en-us/library/aa292118(VS.71).aspx)基本上你需要做的就是添加

```
<identity impersonate="true" /> 
```

到 Web 服务的 Web.config。这将以用户身份运行 Web 服务代码，因此允许 SQL 服务器使用用户的上下文进行身份验证。

但是，如果您的 SQL 服务器位于另一台计算机上，则需要在[委派级别](http://msdn.microsoft.com/en-us/library/aa291350(VS.71).aspx)上使用模拟。这就是说 ASP.Net 必须有足够的权限来允许在另一台计算机上模拟用户。可以通过启用 ASP.Net 用户/计算机进行委派并确保您尝试模拟的用户未标记为禁止委派的敏感用户，在 AD 中配置这些设置。

至少理论上是这样。我花了几天时间试图让委派在 WCF 中工作但没有成功。

启用模拟后，您可以使用 WindowsIdentity 查看正在使用的模拟级别。

```
System.Security.Principal.WindowsIdentity.GetCurrent().ImpersonationLevel 
```

如果这返回 Impersonation，您可以使用用户身份对本地计算机上的进程进行身份验证。如果这返回委派，则您可以使用用户身份在其他计算机上进行身份验证。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T09:11:57.167

ASPnet 进程正在尝试使用用户 ID 'D-11083\ASPNET' 登录该用户是否允许进入数据库？

# sql - SQL分页排序

> ID：810751
> 
> 赞同：2
> 
> 时间：2009-05-01T09:16:25.487
> 
> 标签：sql, sorting, paging

我需要在网页上显示一个网格。数据将通过存储过程来自 SQL Server 2008。由于存储过程返回了数千条记录，我决定选择一个工作正常的分页选项。在存储过程中，我执行以下操作：

```
declare @RowIdMin int=10  
declare @RowIdMax int=25  

select * 
from (select Col1, Col2, ROW_NUMBER() over (order by Col1 desc) as RowId  
      from MyTable ) dt  
where RowId BETWEEN @RowIdMin AND @RowIdMax 
```

只要用户乐于获得按 Col1 排序的数据，此方法就可以正常工作。如果我事先不知道记录集必须按哪一列排序，我该如何重写？这不起作用：

```
declare @RowIdMin int=10  
declare @RowIdMax int=25 
```

**声明@ColSort varchar(100)='MyColumn'**

```
select * 
from (select Col1, Col2, ROW_NUMBER() over (order by <b>@ColSort</b> desc) as RowId  
from MyTable) dt  
where RowId BETWEEN @RowIdMin AND @RowIdMax 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T09:21:12.417

当@ColSort = 'ABC' THEN ABC ....

更详尽的解释

[http://www.extremeexperts.com/sql/articles/CASEinORDER.aspx](http://www.extremeexperts.com/sql/articles/CASEinORDER.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T09:21:25.880

动态 SQL 可能是您最好的选择；换掉 row_number() 函数中的排序选项。您也可以参数化 executesql 中的选项，请参阅[msdn](http://msdn.microsoft.com/en-us/library/aa933299(SQL.80).aspx)

```
declare @SQLScript nVarchar(4000)

declare @RowIdMin int=10
declare @RowIdMax int=25
declare @ColSort varchar(100)='MyColumn'

Select @SQLScript = 'select * from (select Col1, Col2, ROW_NUMBER() over (order by ' + @ColSort + 'desc) as RowId from MyTable  dt where RowId BETWEEN ' + cast(@RowIdMin as nvarchar(100))+ ' AND ' + cast(@RowIdMax as nvarchar(100))

exec sp_executesql @SQLScript 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T09:23:43.860

我完全同意其他帖子，动态 SQL 或 CASE 语句 order by 是您所描述的执行此操作的选项。

然而，顺便说一句，看看你正在使用的框架的其余部分。如果它的 asp.net 3.5 那么它内置的网格和 linq 将为您完成所有这些工作，并且非常轻松。尝试查看[http://www.asp.net/learn](http://www.asp.net/learn)。

# wcf - 通过 WCF 实现 Linq-to-Sql 事务 - 第二部分

> ID：810752
> 
> 赞同：1
> 
> 时间：2009-05-01T09:16:54.157
> 
> 标签：wcf, web-services, linq-to-sql

我从这里开始：[通过 WCF 实现 LINQ-to-SQL 事务](https://stackoverflow.com/questions/753599/implementing-linq-to-sql-transactions-through-wcf)

从此我来到了下面。我将 basicHttpBinding 用于旧版，而我的 WCF 客户端是非托管 C++ (gSOAP)。所以我正在使用 ASP.NET 会话并在 WCF 上启用 aspNetCompatibilityMode。这行得通，所以现在我可以正确处理会话了。

现在我的想法是为每个会话分配单独的 LINQ-to-SQL DataContext，并以这种方式实现事务行为。我想做的是将 DataContext 实例存储在 Session 中，在不调用 SubmitChanges() 的情况下进行所有插入，然后只需调用一次 SubmitChanges() 即可提交事务。

不幸的是，LINQ-to-SQL 中存在一个错误，它会阻止您在调用 SubmitChanges() 之前从 DataContext 获取先前插入的数据（请参阅[此处](https://stackoverflow.com/questions/810529/retrieve-object-from-linq-to-sql-datacontext-before-submitchanges)）我需要这样做，因为在插入投标文件和标题之前，我需要检索标书本身。所以这行不通（至少没有完全重构代码并失去大部分 LINQ-to-SQL 的美感......）

所以现在的问题是：如何通过 WCF 正确实现 per-DataContext 事务？我无法从客户端传播 TransactionScope，因为客户端是非托管的。由于上述错误，我无法使用内部 LINQ-to-SQL 事务。我唯一拥有的是 ASP.NET 会话（有效）。也许我可以以某种方式将 TransactionScope 存储在 Session 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T21:26:43.813

一旦人们开始在同一个句子中提到“交易”和“会话”，我就会自动感到担心。根据我的观点和经验，考虑多个 WCF 调用单个事务性工作单元根本无法扩展：

*   这意味着您有阻塞依赖于外部客户端
*   很多潜在的无法解决的死锁 - 即只能超时，而不是可以检测到的以数据库为中心的死锁
*   您被迫使用粘性负载平衡

就个人而言，我会尝试在单个工作单元上工作。这可能意味着客户端打包一个*完整*的请求并将其作为原子操作提交，或者这可能意味着您通过会话单独执行此操作 - 即您通过多次调用缓冲“什么”，但只有在您开始做某事时拥有你需要的一切。

无论哪种方式，最终结果都是您的工作单元在单个实现上运行，这应该使 db-transactions 或环境 ( `TransactionScope`) 事务正常工作。环境事务（在您的场景中）的优点是它可以跨多个数据上下文工作，但我希望它应该可以修复`Single`调用（根据相关问题）而不会让人头疼。

或者等到 .NET 4.0，当我确信问题已经解决时。好的，最后可能在短期内没有用......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T12:58:34.650

在我看来，重要的是您重用相同的连接和事务。我将在 DataContext 上使用现有连接的构造函数。会话启动后，通过分配连接和事务开始事务。在会话中存储连接和事务。然后在每次调用时，使用相同的连接和事务重新创建 DataContext。完成后，调用提交事务的方法。在会话超时时，您需要确保回滚事务。

```
 public bool CreateTransaction()
 {
     var connection = new SqlConnection( connectionString );
     var transaction = connection.BeginTransaction();
     Session["DBConnection"] = connection;
     Session["DBTransaction"] = transaction;

     return true;
 }

 private DBDataContext CreateContextFromSession()
 {
      if (Session["DBConnection"] == null)
          throw new NullReferenceException( "No connection available for transaction." );
      if (Session["DBTransaction"] == null)
          throw new NullReferenceException( "No transaction available." );

      var context = new DBDataContext( (IDbConnection)Session["DBConnection"] );
      context.Transaction = (DbTransaction)Session["DBTransaction"];

      return context;
 }

 public Tender CreateTender( ... )
 {
     var context = CreateContextFromSession();

     var tender = new Tender { ... };
     context.Tenders.InsertOnSubmit( tender );
     context.SubmitChanges();

     return tender;
 }

 public void CommitTransaction()
 {
     var transaction = (DbTransaction)Session["DBTransaction"];
     transaction.Commit();
     Session.Remove( "DBTransaction" );

     var connection = (IDbConnection)Session["DBConnection"];
     connection.Close();
     Session.Remove( "DBConnection" );
 } 
```

# iphone - 从 iPhone 中的视频帧中获取图像

> ID：810764
> 
> 赞同：5
> 
> 时间：2009-05-01T09:21:38.717
> 
> 标签：iphone, objective-c, video, compression

是否可以使用 iPhone SDK 从 iPhone 中的视频中抓取一帧并将其保存或以任何方式在应用程序中使用？除了播放/停止或访问视频的二进制数据之外，SDK 是否对视频进行任何控制？

也可以知道用户停止观看视频的时间（我知道在 SDK 3.0 中可以从特定时间开始视频）。

谢谢

编辑：如果不是通过官方 API，是否有另一种方法可以以不会禁止 AppStore 中的应用程序的方式执行上述任何操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-02-10T13:46:24.630

这是一篇关于使用 ffmpeg 从电影中提取帧的博客文章：

[http://www.codza.com/extracting-frames-from-movies-on-iphone](http://www.codza.com/extracting-frames-from-movies-on-iphone)

github上对应的项目：[iFrameExtractor](http://github.com/lajos/iFrameExtractor)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-02T16:10:31.580

您可以使用 ffmpeg 使用的 lib 来提取像 libh264 这样的框架

[http://en.wikipedia.org/wiki/X264](http://en.wikipedia.org/wiki/X264)

iPhone 上的直播电视应用程序就是这样做的。

希望这可以帮助。

蒂埃里

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-27T00:03:28.537

请在此处查看我的问题的答案[iphone sdk > 3.0 。视频缩略图？](https://stackoverflow.com/questions/1259316/iphone-sdk-3-0-video-thumbnail/1301311#1301311)这回答了这个问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-23T09:54:56.910

查看此 URL 中的示例代码：[https](https://github.com/benlodotcom/MyAVControllerDemo) ://github.com/benlodotcom/MyAVControllerDemo以从视频中提取帧

# asp.net - 从客户端上传文件到服务器

> ID：810765
> 
> 赞同：0
> 
> 时间：2009-05-01T09:22:51.007
> 
> 标签：asp.net, asp.net-ajax, file-upload

我正在使用 PageMethods（Web 服务）与服务器交互的 ajax 页面。我想允许用户将给定文件上传到服务器（在服务器上的某个固定路径上）。

我知道 asp.net 中的 FileUpload 控件，但这在我的情况下不起作用。因为我不想使用 UpdatePanel 或专用服务器页面。

有没有办法使用客户端ajax来做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-20T22:35:30.743

我不知道 Ajax 方式，但您可以在页面中添加一个 iframe，并在其中加载一个专用的上传页面。

然后，您可以在上传页面上使用[FileUpload 控件](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.fileupload.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-20T22:46:36.740

你可以使用嵌入式闪存来做到这一点，谷歌在 Gmail 中使用它。这是一个[很好的](http://www.inaflashuploader.com/)，它是免费的，你也可以在 asp.net 上使用

# javascript - 请帮忙优化简单的JQuery函数

> ID：810766
> 
> 赞同：1
> 
> 时间：2009-05-01T09:22:57.280
> 
> 标签：javascript, jquery, optimization

**我有一个这样的jQuery函数：**

```
$("input").focus(function () {
    $(this).addClass('focus');
});
$("input").blur(function () {
    $(this).removeClass('focus');
});

$("select").focus(function () {
    $(this).addClass('focus');
});
$("select").blur(function () {
    $(this).removeClass('focus');
});

$("textarea").focus(function () {
    $(this).addClass('focus');
});
$("textarea").blur(function () {
    $(this).removeClass('focus');
}); 
```

**是否可以针对更少的代码进行优化？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-01T09:24:53.640

```
$("input,select,textarea").focus(function() {$(this).toggleClass('focus')})
                          .blur(function() {$(this).toggleClass('focus')}); 
```

或者

```
$("input,select,textarea").bind('focus blur',function() {$(this).toggleClass('focus')}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T09:25:58.007

这应该工作

```
$("input, textarea, select").focus(function () {
   $(this).addClass('focus');
}).blur(function(){
   $(this).removeClass('focus');
}); 
```

# c# - 在面板上显示屏幕外的 Google 地球？

> ID：810774
> 
> 赞同：0
> 
> 时间：2009-05-01T09:25:41.483
> 
> 标签：c#, .net, webbrowser-control, google-earth-plugin

是否可以从 .NET WebBrowser 控件捕获由 Google 地球浏览器插件创建的图形对象？

使用这个图形对象，我可以创建一个图像用作面板的背景图像，然后我可以在其上进行绘制。

您不能只在 Panel 控件下使用 WebBrowser 控件，因为 Google 地球插件不起作用。

获取浏览器图形对象只是返回空白。浏览器 DrawToBitmap 方法（无智能感知）返回网页，但没有 Google 地球图像。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T11:17:15.713

看看我的这个项目：[http](http://code.google.com/p/winforms-geplugin-control-library/) ://code.google.com/p/winforms-geplugin-control-library/它会有所帮助。这里的技巧是从插件中捕获当前图像作为位图，然后使用它（如双缓冲）。

特别是查看“GEToolStrip.cs”中的“ScreenGrabButton_Click”方法，了解如何捕获图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T12:13:26.060

如果我误解了这个问题，我深表歉意 - 您是否要在 Windows 窗体程序中显示 Google 地球？如果是这样，请查看 Google Earth COM API。

[谷歌地球 COM API](http://earth.google.com/comapi/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-01T07:59:51.353

经过一些更多的研究和反复试验，我被迫承认失败，当网络浏览器控件在屏幕外时，似乎不可能在面板上显示谷歌地球。

解决方案是要么忍受限制：

*   将要在背景上绘制的表格设置为透明
*   创建一个新表单作为绘图表单的父级
*   在新表单上显示谷歌地球
*   正确对齐表格并让孩子驾驶父母

或者切换到 Microsoft Live Earth，因为已经有适用于 WPF 和 winforms[的概念证明。](http://rob.runtothehills.org/archives/60)

# url - 小型企业网站的永久别名 url，无需更改 DNS

> ID：810779
> 
> 赞同：0
> 
> 时间：2009-05-01T09:26:47.427
> 
> 标签：url, web, alias

**问题**：是否有一种服务或系统方法允许某人设置一个永久的基本 URL，该 URL 可用作商业网站的引荐来源，无论该网站在任何给定时间托管在何处？

**示例**：假设您有两个具有相同内容的网站（它们只是镜像或同步副本），它们由两个独立的网络托管公司托管：

```
http://example1.org
http://example2.org 
```

您还有一个要在名片上使用的“永久网址”：

```
http://1q2w3e4r5t.org 
```

然后，您希望允许人们访问“永久 url”（或其下方的任何路径）并将用户重定向到您选择的任一镜像站点，而无需更改 DNS 条目。

```
http://1q2w3e4r5t.org/foobar/hello.php  --> redirect to example1.org/foobar/hello.php
http://1q2w3e4r5t.org/barfoo/bye.asp  --> example2.org/barfoo/bye.asp 
```

这不是负载平衡或故障转移架构，因为 example1 和 example2 托管在两个完全不同的商品低成本低可靠性网络托管公司上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T09:42:26.810

如果你真的想让两个域名都指向不同的服务器，但是将所有到达服务器 a 的用户重定向到服务器 b，你（在 apache 服务器上）可以在你的 .htaccess 文件中使用 mod_rewrite：

```
RewriteEngine On
RewriteRule ^(.*)$ http://www.example1.org/$1 [R=301] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T09:30:51.223

这基本上就是 DNS 可以做的 - CNAME 别名。

只需购买一个域，然后您就可以自己设置重定向。非常便宜。

# c++ - Broadcom ADSL 调制解调器的驱动程序

> ID：810782
> 
> 赞同：0
> 
> 时间：2009-05-01T09:29:03.600
> 
> 标签：c++, c, drivers

我有兴趣为我的 Broadcom NDIS ADSL 调制解调器编写驱动程序。

鉴于我有 C 和 C++ 知识，这项工作需要什么工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T09:34:03.320

我以前从未写过驱动程序，但我用谷歌搜索了“写驱动程序”并发现了这个......

[http://www.osronline.com/article.cfm?article=20](http://www.osronline.com/article.cfm?article=20)

...关于编写 Windows 驱动程序和这个...

[http://www.freesoftwaremagazine.com/articles/drivers_linux](http://www.freesoftwaremagazine.com/articles/drivers_linux)

...关于编写 Linux 驱动程序。

# iphone - 与 iPhone 上的内置 SMS 应用程序集成

> ID：810787
> 
> 赞同：1
> 
> 时间：2009-05-01T09:32:44.540
> 
> 标签：iphone, sms

我想在我的 iPhone 应用程序中使用短信。我意识到集成短信模块是不可能的，我们可以通过传递号码切换到iPhone的短信应用程序。

我尝试了以下方法，但仍然无法打开内置 SMS 应用程序。

```
NSString *no = @"9904143445";
NSString *sms = [NSString stringWithFormat:@"smsto:%@",no];
[[UIApplication sharedApplication]openURL:[NSURL URLWithString:sms]]; 
```

知道可能出了什么问题吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T10:26:55.020

您的 URL 协议错误：“smsto”应该只是“sms”

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T10:03:43.577

我们已经从我们的网络应用程序中使用了 sms:+1254545454 [专为 iPhone 构建]，它完全可以调用内置的 SMS 应用程序。

# python - python中的字符串编码

> ID：810794
> 
> 赞同：0
> 
> 时间：2009-05-01T09:36:24.220
> 
> 标签：python, unicode, codepages

在 python 中，字符串可以是 unicode（utf-16 和 utf-8）和具有不同编码（cp1251、cp1252 等）的单字节。是否可以检查编码字符串是什么？例如，

```
time.strftime( "%b" ) 
```

将返回一个带有一个月文本名称的字符串。在 MacOS 下返回的字符串将是 utf-16，在本地英语的 Windows 下，它将是使用 ascii 编码的单字节，在非英语语言环境的 Windows 下，它将通过语言环境的代码页进行编码，例如 cp1251。我该如何处理这样的字符串？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T10:19:15.273

字符串不存储任何编码信息，您只需在转换为/从 unicode 或打印到输出设备时指定一个：

```
import locale
lang, encoding = locale.getdefaultlocale()
mystring = u"blabla"
print mystring.encode(encoding) 
```

UTF-8*不是*unicode，它是将 unicode 编码为单字节字符串。

最佳实践是在 python 端的任何地方都使用 unicode，使用 UTF-8 等 unicode 可逆编码存储您的字符串，并转换为仅用于用户输出的精美语言环境。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T09:43:31.677

字符集编码检测非常复杂。

但是，您这样做的真正目的是什么？如果您只想重视使用 unicode，只需编写

```
unicode(time.strftime("%b")) 
```

它应该适用于您上面提到的所有情况：

*   mac os: unicode(unicode) -> unicode
*   win/eng: unicode(ascii) -> unicode
*   win/noneng: unicode(some_cp) -> 会被本地cp转换 -> unicode

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T15:26:23.193

如果您有一个相当长的未知编码字符串，您可以尝试猜测编码，例如使用[https://github.com/dcramer/chardet](https://github.com/dcramer/chardet)上的通用编码检测器- 当然不是万无一失，但有时它会猜对;-)。但这对非常短的字符串没有多大帮助。

# c# - 哪个更好，返回值或输出参数？

> ID：810797
> 
> 赞同：161
> 
> 时间：2009-05-01T09:37:26.277
> 
> 标签：c#, reference

如果我们想从方法中获取值，我们可以使用任一返回值，如下所示：

```
public int GetValue(); 
```

或者：

```
public void GetValue(out int x); 
```

我不太了解它们之间的区别，因此不知道哪个更好。你能给我解释一下吗？

谢谢你。

* * *

## 回答 #1

> 赞同：164
> 
> 时间：2009-05-01T09:42:14.503

当方法没有任何其他要返回时，返回值几乎*总是正确的选择。*（事实上​​，如果我可以选择的话，我想不出任何我想要*一个*带参数的 void 方法的`out`情况。C# 7 的`Deconstruct`语言支持的解构方法是这个规则的一个非常非常罕见的例外.)

除此之外，它使调用者不必单独声明变量：

```
int foo;
GetValue(out foo); 
```

对比

```
int foo = GetValue(); 
```

Out 值还可以防止这样的方法链接：

```
Console.WriteLine(GetValue().ToString("g")); 
```

（事实上​​，这也是属性设置器的问题之一，这也是构建器模式使用返回构建器的方法的原因，例如`myStringBuilder.Append(xxx).Append(yyy)`。）

此外，输出参数稍微难以与反射一起使用，并且通常也会使测试变得更加困难。（通常比输出参数更容易模拟返回值）。基本上没有什么我能想到的，它们使它们变得*更容易*......

返回值 FTW。

编辑：就正在发生的事情而言......

基本上，当您为“out”参数传入参数时，您*必须*传入一个变量。（数组元素也被归类为变量。）您调用的方法在其堆栈中没有用于参数的“新”变量 - 它使用您的变量进行存储。变量中的任何更改都立即可见。这是一个显示差异的示例：

```
using System;

class Test
{
    static int value;

    static void ShowValue(string description)
    {
        Console.WriteLine(description + value);
    }

    static void Main()
    {
        Console.WriteLine("Return value test...");
        value = 5;
        value = ReturnValue();
        ShowValue("Value after ReturnValue(): ");

        value = 5;
        Console.WriteLine("Out parameter test...");
        OutParameter(out value);
        ShowValue("Value after OutParameter(): ");
    }

    static int ReturnValue()
    {
        ShowValue("ReturnValue (pre): ");
        int tmp = 10;
        ShowValue("ReturnValue (post): ");
        return tmp;
    }

    static void OutParameter(out int tmp)
    {
        ShowValue("OutParameter (pre): ");
        tmp = 10;
        ShowValue("OutParameter (post): ");
    }
} 
```

结果：

```
Return value test...
ReturnValue (pre): 5
ReturnValue (post): 5
Value after ReturnValue(): 10
Out parameter test...
OutParameter (pre): 5
OutParameter (post): 10
Value after OutParameter(): 10 
```

不同之处在于“发布”步骤 - 即在局部变量或参数已更改之后。在 ReturnValue 测试中，这对静态`value`变量没有影响。在 OutParameter 测试中，`value`变量由行改变`tmp = 10;`

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-05-01T09:41:01.150

哪个更好，取决于您的具体情况。存在的原因之一**是**`out`便于从一个方法调用返回多个值：

```
public int ReturnMultiple(int input, out int output1, out int output2)
{
    output1 = input + 1;
    output2 = input + 2;

    return input;
} 
```

因此，根据定义，一个并不比另一个更好。但通常你会想要使用简单的 return，除非你有上述情况。

**编辑：** 这是一个示例，展示了关键字存在的原因之一。以上内容绝不是最佳做法。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-05-01T09:42:40.600

您通常应该更喜欢返回值而不是输出参数。如果您发现自己编写需要做两件事的代码，则输出参数是必要的邪恶。Try 模式（例如 Int32.TryParse）就是一个很好的例子。

让我们考虑一下您的两个方法的调用者必须做什么。对于第一个例子，我可以写这个......

```
int foo = GetValue(); 
```

请注意，我可以在一行中声明一个变量并通过您的方法分配它。对于第二个示例，它看起来像这样......

```
int foo;
GetValue(out foo); 
```

我现在被迫预先声明我的变量并将我的代码写成两行。

**更新**

问这些类型的问题时，一个很好的地方是 .NET Framework 设计指南。如果你有书本版本，那么你可以看到 Anders Hejlsberg 和其他人关于这个主题的注释（第 184-185 页），但在线版本在这里......

[http://msdn.microsoft.com/en-us/library/ms182131(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms182131(VS.80).aspx)

如果您发现自己需要从 API 返回两件事，那么将它们包装在结构/类中会比输出参数更好。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2014-02-17T15:56:16.410

`out`使用尚未提及的参数有一个原因：调用方法必须接收它。如果您的方法产生一个调用者不应丢弃的值，则使其成为`out`强制调用者专门接受它：

```
 Method1();  // Return values can be discard quite easily, even accidentally

 int  resultCode;
 Method2(out resultCode);  // Out params are a little harder to ignore 
```

当然，调用者仍然可以忽略参数中的*值*`out`，但是您已经引起了他们的注意。

这是一种罕见的需求；更常见的是，您应该对真正的问题使用异常或返回带有状态信息的对象作为“仅供参考”，但在某些情况下这很重要。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-05-01T09:39:48.113

主要是偏爱

我更喜欢退货，如果您有多个退货，您可以将它们包装在 Result DTO 中

```
public class Result{
  public Person Person {get;set;}
  public int Sum {get;set;}
} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-01T09:42:06.080

您几乎应该总是使用返回值。' `out`' 参数对许多 API、组合性等产生了一些摩擦。

想到的最值得注意的例外是当您想要返回多个值时（.Net Framework 直到 4.0 才具有元组），例如使用`TryParse`模式。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-05-01T09:50:21.847

您只能有一个返回值，而您可以有多个输出参数。

在这些情况下，您只需要考虑 out 参数。

但是，如果您需要从方法中返回多个参数，您可能需要查看从 OO 方法返回的内容，并考虑是否最好返回具有这些参数的对象或结构。因此，您又回到了返回值。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-01T11:01:44.030

我认为在使用非托管内存时它会很有用的少数场景之一，并且您希望清楚地表明应该手动处理“返回”值，而不是期望它自行处理.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-01T09:38:14.373

我更喜欢以下内容，而不是这个简单示例中的任何一个。

```
public int Value
{
    get;
    private set;
} 
```

但是，它们都非常相似。通常，只有在需要从方法中传回多个值时才会使用“out”。如果你想在方法中输入和输出一个值，可以选择'ref'。我的方法是最好的，如果你只返回一个值，但如果你想传递一个参数并返回一个值，那么你可能会选择你的第一选择。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-01T09:50:40.643

没有真正的区别。Out 参数在 C# 中允许方法返回一个以上的值，仅此而已。

但是有一些细微的差异，但它们都不是很重要：

使用 out 参数将强制您使用两行，例如：

```
int n;
GetValue(n); 
```

而使用返回值可以让你在一行中完成：

```
int n = GetValue(); 
```

另一个区别（仅适用于值类型并且仅当 C# 不内联函数时才正确）是使用返回值必然会在函数返回时复制该值，而使用 OUT 参数不一定会这样做。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-04-06T21:04:21.477

此外，返回值与异步设计范例兼容。

**如果函数使用 ref 或 out 参数，则不能指定函数“异步”。**

总之，**返回值**允许方法链接、更简洁的语法（通过消除调用者声明附加变量的必要性），并允许异步设计，而无需在未来进行大量修改。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-09-21T00:52:09.820

使用带有 bool 返回类型的 out 关键字有时可以减少代码膨胀并提高可读性。（主要是当 out 参数中的额外信息经常被忽略时。）例如：

```
var result = DoThing();
if (result.Success)
{
    result = DoOtherThing()
    if (result.Success)
    {
        result = DoFinalThing()
        if (result.Success)
        {
            success = true;
        }
    }
} 
```

与：

```
var result;
if (DoThing(out result))
{
    if (DoOtherThing(out result))
    {
        if (DoFinalThing(out result))
        {
            success = true;
        }
    }
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-01T09:49:53.127

它们都有不同的目的，并且编译器不会将它们视为相同的。如果你的方法需要返回一个值，那么你必须使用 return。Out 用于您的方法需要返回多个值的地方。

如果使用 return，则数据首先写入方法堆栈，然后写入调用方法。而在out的情况下，直接写入调用方法栈。不确定是否还有其他差异。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-01T09:59:53.493

正如其他人所说：返回值，而不是输出参数。

我可以向您推荐《框架设计指南》（第 2 版）这本书吗？第 184-185 页介绍了避免使用 out 参数的原因。整本书将引导您在各种 .NET 编码问题上朝着正确的方向前进。

与框架设计指南相结合的是静态分析工具 FxCop 的使用。您可以在 Microsoft 的网站上免费下载此内容。在你编译的代码上运行它，看看它说了什么。如果它抱怨成百上千的事情......不要惊慌！冷静而仔细地看它对每一个案例的描述。不要急于尽快解决问题。从它告诉你的内容中学习。你将走上精通之路。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-12-08T05:57:20.420

当您尝试返回您在方法中声明的对象时，out 更有用。

例子

```
public BookList Find(string key)
{
   BookList book; //BookList is a model class
   _books.TryGetValue(key, out book) //_books is a concurrent dictionary
                                     //TryGetValue gets an item with matching key and returns it into book.
   return book;
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-03-30T14:59:59.820

**返回值**是您的方法返回的正常值。

作为**out**参数，well out 和 ref 是 C# 的两个关键词，它们允许将变量作为**参考**传递。

**ref**和**out**之间的最大区别是，**ref**应该在之前初始化并且**out**不

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-08-03T01:45:03.030

**请避免使用 out 参数。**

虽然它们在某些情况下是有意义的（例如在实现[Try-Parse 模式](https://docs.microsoft.com/en-us/dotnet/standard/design-guidelines/exceptions-and-performance#try-parse-pattern)时），但它们很难掌握。

自己（除非您对该概念非常有经验）和其他开发人员（使用您的 API 或可能继承您的代码）引入错误或副作用的机会非常高。

根据微软的质量规则[CA1021](https://docs.microsoft.com/en-us/dotnet/fundamentals/code-analysis/quality-rules/ca1021)：

> 尽管返回值很常见并且被大量使用，但正确应用 out 和 ref 参数需要中等设计和编码技能。为普通读者设计的图书馆架构师不应该期望用户掌握使用 out 或 ref 参数的工作。

因此，如果没有很好的理由，请不要使用`out`or `ref`。

也可以看看：

*   [正在使用“out”的坏习惯](https://stackoverflow.com/questions/4255188/is-using-out-bad-practice)
*   [https://docs.microsoft.com/en-us/dotnet/fundamentals/code-analysis/quality-rules/ca1021](https://docs.microsoft.com/en-us/dotnet/fundamentals/code-analysis/quality-rules/ca1021)

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2018-11-28T16:52:44.403

我怀疑我不会去看看这个问题，但我是一个*非常*有经验的程序员，我希望一些更开明的读者会注意。

我相信它更适合面向对象的编程语言，因为它们的值返回过程 (VRP) 是确定性和纯粹的。

'VRP' 是作为表达式的一部分调用的函数的现代学术名称，并具有一个返回值，在计算表达式期间从概念上替换调用。例如，在诸如`x = 1 + f(y)`函数之类的声明中，该函数`f`用作 VRP。

“确定性”意味着函数的结果仅取决于其参数的值。如果你用相同的参数值再次调用它，你肯定会得到相同的结果。

“纯”意味着没有副作用：调用函数*除了*计算结果之外什么都不做。在实践中，这可以解释为没有*重要*的副作用，因此如果 VRP 每次调用它时都会输出调试消息，例如，这可能会被忽略。

因此，如果在 C# 中，你的函数不是确定性的和纯的，我说你应该把它变成一个`void`函数（换句话说，不是 VRP），并且它需要返回的任何值都应该在一个`out`或一个`ref`参数中返回。

例如，如果你有一个从数据库表中删除一些行的函数，并且你希望它返回它删除的行数，你应该像这样声明它：

`public void DeleteBasketItems(BasketItemCategory category, out int count);`

如果你有时想调用这个函数但没有得到`count`，你总是可以声明一个重载。

您可能想知道*为什么*这种风格更适合面向对象编程。从广义上讲，它适合一种可以（有点不准确地）称为“过程式编程”的编程风格，它是一种更适合面向对象编程的过程式编程风格。

为什么？对象的经典模型是它们具有属性（也称为属性），并且您（主要）通过读取和更新这些属性来询问和操作对象。过程式编程风格往往更容易做到这一点，因为您可以在获取和设置属性的操作之间执行任意代码。

过程式编程的缺点是，因为你可以在任何地方执行任意代码，你可以通过全局变量和副作用获得一些非常迟钝和容易出错的交互。

因此，很简单，向阅读您的代码的人*发出信号*是一种很好的做法，即函数可能会通过使其不返回值而产生副作用。

# jquery - 为什么 JQuery 自动完成没有执行？

> ID：810800
> 
> 赞同：0
> 
> 时间：2009-05-01T09:39:09.720
> 
> 标签：jquery, html, autocomplete

我有一个非常有趣的案例，其中 JQuery 自动完成字段在我第一次在 TextBox 中键入时没有响应，但是当我在 TextBox 之外进行 TAB 然后第二次将光标返回到 TextBox 时它开始响应并且结果在我开始输入时显示。

当我使用 firebug 时，我实际上可以看到我的应用程序中的 AJAX 函数被调用并且结果返回到 html 模板，但是没有显示结果，可能是什么导致了这种行为？

我的函数绑定代码：

```
 $(function()
  {
    $(document).ready(function(){
       $("#tags1").bind("keyup",autoFill)
      });
   }); 
```

我的自动完成功能

```
 function autoFill(){
           $("#tags1").autocomplete("/taglookup/", {
        width: 320,
        max: 4,
        highlight: false,
        multiple: true,
        multipleSeparator:",",
        scroll: true,
        scrollHeight: 300,
        delay: 10
         });
       } 
```

我的文本框字段：

```
 <input type="text" style="width: 400px" id="tags1" name="tags1" value=""> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T09:54:45.813

你为什么要在 keyup 上调用 autocomplete()？我认为这可能会导致您的问题。我会尝试直接从文档就绪事件中调用 autocomplete() 。

```
$(document).ready(function(){

        $("#tags1").autocomplete("/taglookup/", {
        width: 320,
        max: 4,
        highlight: false,
        multiple: true,
        multipleSeparator:",",
        scroll: true,
        scrollHeight: 300,
        delay: 10
         });

      }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T09:54:43.957

如果您使用的是我今天使用的相同自动完成功能（抱歉，在另一台计算机上 - 无法找出确切的版本） - 那么您不需要在 keyup 上绑定 - 只需在启动时绑定一次 -

```
<script>
    $('#tags1').autocomplete(....);
</script> 
```

自动完成功能处理所有按键/聚焦变化等。

# visual-studio - 如何与 Visual Studio 2005 交互 Visual Source Safe？

> ID：810811
> 
> 赞同：1
> 
> 时间：2009-05-01T09:43:23.253
> 
> 标签：visual-studio, version-control, visual-studio-2005, visual-sourcesafe

我使用 Visual Studio 2005，我想设置 Visual Source Safe 8.0。

我运行安装程序并且它工作正常我可以通过开始菜单访问 VSS 管理工具和可视源安全。

但是，我在 Visual Studio 2005 中看不到**File / Source Safe**菜单。

有谁知道我如何与我的视觉源安全和视觉工作室进行交互？

**解决了 ：**

我以这种方式解决了我的问题：

我在 Visual Studio 中打开工具/选项/源代码控制/插件选择

并在 Current Source Safe Plugin 列表中选择 Visual Source Safe。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T09:47:57.080

您可以通过以下方式找到 SourceSafe 相关项：

*   文件 -> 源代码管理
*   工具 -> 选项 -> 源代码管理

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T09:50:17.730

据我记得，您可能必须[像这样](http://www.howtogeek.com/howto/programming/configure-current-source-control-provider-in-visual-studio-2005/)设置提供程序。这样，它应该在一些地方显示为“源代码管理”。

附加：但是；这将是建议类似 SVN 的好时机；易于设置客户端和服务器...存在许多其他工具，无论预算如何。似乎都比 VSS 更可取。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T09:58:59.313

其他人已经回答了如何让 VSS 与 VS2005 一起工作，但是除非您要加入现有项目，否则请**认真考虑使用另一个源代码控制解决方案**。

你应该阅读一些关于它的文章。在我的书签顶部：

*   [编码恐怖：源代码控制：除 SourceSafe 之外的任何东西](http://www.codinghorror.com/blog/archives/000660.html)
*   [Visual SourceSafe：微软的源代码销毁系统](http://www.highprogrammer.com/alan/windev/sourcesafe.html)
*   [Visual SourceSafe 版本控制：任何速度都不安全？](http://www.developsense.com/testing/VSSDefects.html)

VSS~~让婴儿耶稣哭泣~~是邪恶的。如果您不想投入更多资金，只需使用 SVN 和像[AnkhSVN](http://www.developsense.com/testing/VSSDefects.html)这样的优秀 VS 插件。

# jquery - 关于jquery向后兼容性的问题

> ID：810815
> 
> 赞同：0
> 
> 时间：2009-05-01T09:44:41.143
> 
> 标签：jquery, backwards-compatibility

我知道 jquery 有向后兼容文件。

但是，如果您链​​接到此特定版本：[http](http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js) ://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js您不需要向后兼容文件。我想知道[http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js](http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js)是否也适用于较新的浏览器版本。然后我不需要将我的 jquery 升级到较新的版本，但有网站不再运行良好的风险。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T09:53:57.453

我敢肯定，较新的浏览器对较旧的 jquery 版本不会有问题。Jquery 本身是纯 javascript - 所以我想这应该不是问题。

在尝试实现可能需要新 jquery 插件的页面的新功能时，您可能会遇到麻烦......

# matrix - 如何在 Pascal 中实现矩阵运算？

> ID：810821
> 
> 赞同：1
> 
> 时间：2009-05-01T09:49:02.350
> 
> 标签：matrix, pascal

我需要用矩阵实现运算，矩阵的大小必须是可变的。我想出的唯一解决方案是使用链表：

```
[pointer to this row, pointer to another row] -> [element 1,1; link to another element] -> [element 1,2,  link to another element] -> .... -> [nil]
     |
     v
[pointer to this row, pointer to another row] ...
     ... 
```

但在我看来有点复杂。有没有更好（更简单）的解决方案？

谢谢你们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T09:58:50.547

任何现代帕斯卡变体（Delphi）都可以让您创建动态（运行时大小）数组。

如果该语言不支持多维动态数组，您可以自己处理寻址：

```
var
  rows, cols, total, i, j : integer;
  cell : datatype;
begin
  rows := ...;
  cols := ...;
  total := rows * cols;
  matrix := ...(total);

  cell := matrix[i * cols + j]; // matrix[row=i,col=j]

end; 
```

这种寻址方式会比跟随链表快很多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T10:08:41.163

一种方法是使用[GetMem](http://function.name/in/Pascal/GetMem)来分配足够的内存。GetMem 似乎得到了广泛的支持。

```
const
    MAXMATRIXDATA: Word = 10000;
type
    TMatrixDataType = Word;
    TMatrixData = array[0..MAXMATRIXDATA] of TMatrixDataType;
    PMatrixData = ^TMatrixData;
    TMatrix = record
        Rows, Cols: Word;
        MatrixData: PMatrixData;
        end;
    PMatrix = ^TMatrix;

function CreateMatrix(Rows, Cols: Word): PMatrix;
var
    Ret: PMatrix;
begin
    New(Ret);
    Ret^.Rows := Rows;
    Ret^.Cols := Cols;
    GetMem(Ret^.MatrixData,Rows*Cols*SizeOf(TMatrixDataType));
    CreateMatrix := Ret;
end;

function GetMatrixData(Matrix: PMatrix; Row, Col: Word): TMatrixDataType;
begin
    GetMatrixData := Matrix^.MatrixData^[(Row*Matrix^.Cols)+Col];
end;

procedure SetMatrixData(Matrix: PMatrix; Row, Col: Word; Val: TMatrixDataType);
begin
    Matrix^.MatrixData^[(Row*Matrix^.Cols)+Col] := Val;
end; 
```

# visual-studio-2008 - “LNK2022：元数据操作失败”让我发疯

> ID：810827
> 
> 赞同：28
> 
> 时间：2009-05-01T09:52:37.193
> 
> 标签：visual-studio-2008, linker, c++-cli, metadata, assemblyinfo

我有很多项目的大解决方案，使用 VS2008 SP1，并且每天至少遇到一次 LNK2022 错误。如果我完全重建解决方案，它构建得很好，但这并不有趣。

它发生在依赖 DLL 被“不显着”地改变（即没有改变任何方法或类），并且后来构建了引用项目时。合并元数据时失败 - 不管这意味着什么。

首先要注意的是，共享 DLL 是`#using`从多个 .CPP 文件中引用的。
第二件事是，如果我从共享 DLL 中删除 AssemblyInfo.cpp，那么问题就会消失（但我[不确定这是否是一个明智的修复？](https://stackoverflow.com/questions/807999/is-assemblyinfo-cpp-necessary)）。

我已尽可能将其缩小为包含 2 个 CLR 类库项目的以下[解决方案（](http://www.2shared.com/file/5575794/7f03c4c4/xxx.html) **xxx**项目依赖于**Shared**）：
[![替代文字](https://i.stack.imgur.com/wk8uC.png "解决方案")](https://i.stack.imgur.com/wk8uC.png "解决方案")

以下是每个文件的内容：

## 共享.cpp：

```
public ref class Shared
{
}; 
```

## 英寸：

```
#pragma once
#using "Shared.dll"
public ref class Common
{
private:
    Shared^ m_fred;
}; 
```

## xxx.cpp 和 xxx2.cpp：

```
#include "inc.h" 
```

要重现，首先重建解决方案。它会建立好的。
现在保存*Shared.cpp*并构建解决方案，它将构建良好并显示：

```
...
2>------ Build started: Project: xxx, Configuration: Debug Win32 ------
2>Inspecting 'd:\xxx\xxx\Debug\Shared.dll' changes ...
2>No significant changes found in 'd:\xxx\xxx\Debug\Shared.dll'.
2>xxx - 0 error(s), 0 warning(s)
========== Build: 2 succeeded, 0 failed, 0 up-to-date, 0 skipped ========== 
```

现在保存*xxx.cpp*并构建解决方案，它失败并显示以下消息：

```
1>------ Build started: Project: xxx, Configuration: Debug Win32 ------
1>Compiling...
1>xxx.cpp
1>Linking...
1>xxx2.obj : error LNK2022: metadata operation failed (80131188) : Inconsistent field declarations in duplicated types (types: Common; fields: m_fred): (0x04000001).
1>LINK : fatal error LNK1255: link failed because of metadata errors
1>xxx - 2 error(s), 0 warning(s)
========== Build: 0 succeeded, 1 failed, 1 up-to-date, 0 skipped ========== 
```

**编辑**：
xxx.obj 和 xxx2.obj 的 IL 之间的区别如下：

***(for xxx.obj)***
// AssemblyRef #2 (23000002)
// ---------------------------------- ---------------------
// 令牌：0x23000002
// 公钥或令牌：
// 名称：共享
// 版本：1.0.3412.16 **606**
// 主要版本: 0x00000001
// 次要版本： 0x00000000
// 内部版本号： 0x00000d54
// 修订号： **0x000040 de**
// 区域设置：
// HashValue Blob： **1c bb 8f 13 7e ba 0a c7 26 c6 fc cb f9 ed 71 bf 5d ab b0 c0**
//标志：[无]（00000000）

***(for xxx2.obj)***
// AssemblyRef #2 (23000002)
// ---------------------------------- ---------------------
// 令牌：0x23000002
// 公钥或令牌：
// 名称：共享
// 版本：1.0.3412.16 **585**
// 主要版本: 0x00000001
// 次要版本： 0x00000000
// 内部版本号： 0x00000d54
// 修订号： **0x000040 c9**
// 区域设置：
// HashValue Blob： **64 af d3 12 9d e3 f6 2b 59 ac ff e5 3b 38 f8 fc 6d f4 d8 b5**
//标志：[无]（00000000）

这对我来说意味着 xxx2.obj 仍在使用旧版本的 Shared.dll，这与使用更新的 Shared.dll 的 xxx.obj 冲突。那么我该如何解决呢？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-05T20:02:13.170

此问题是由 Visual Studio 2008 中的新托管增量构建功能引起的。正如您所发现的，元数据确实发生了变化，但并未以托管增量构建功能认为重要的方式发生变化。但是，如果您强制重新编译其中一个 cpp 文件，它会获取新的元数据，将其嵌入到 obj 中，然后链接器会发现冲突。

有两种方法可以解决此问题。[从下面的 democodemonkey 的回答来看](https://stackoverflow.com/questions/810827/lnk2022-metadata-operation-failed-driving-me-insane/1091175#1091175)，一种似乎可行的简单方法是在引用的程序集元数据中指定一个显式的版本号，以指示编译器所引用的程序集实际上是相同的版本：

> 代替
> 
> ```
> [assembly:AssemblyVersionAttribute("1.0.*")]; 
> ```
> 
> 和
> 
> ```
> [assembly:AssemblyVersionAttribute("1.0.0.1")]; 
> ```
> 
> `AssemblyInfo.cpp.`这将确保版本在增量构建之间不会发生变化。

避免此问题的另一种方法是禁用该功能。我们可能会不必要地重新编译一些 cpp 文件，但这总比链接器失败要好。

**在项目属性中，在 Configuration Properties > General 下，将“Enable Managed Incremental Build”设置为 No。**

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-07-07T09:07:29.470

Microsoft 回复了我的 Connect 帖子，提供了更好的解决方法：

> 看起来问题是由两个 .obj 之间的版本不匹配引起的。更好的解决方法是更换
> 
> [程序集：AssemblyVersionAttribute("1.0.*")];
> 
> 和
> 
> [程序集：AssemblyVersionAttribute("1.0.0.1")];
> 
> 在 AssemblyInfo.cpp 中。这将确保版本不会在增量构建之间发生变化。

这对我有用，显然这比禁用该功能更可取。
~~无论如何，已选择接受的答案，现在无法更改:(~~
*编辑：我设法不接受我的答案并将尼克的答案标记为接受的答案*:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T10:07:53.117

在 xxx.cpp 和 xxx2.cpp 中试试这个：

```
#ifndef _PROTECT_MY_HEADER
#define _PROTECT_MY_HEADER
#include  "inc.h"
#endif 
```

`#pragma once`在这种情况下不足以保护标题。

# sql-server - 获取插入行的 PK Guid 的最佳方法

> ID：810829
> 
> 赞同：11
> 
> 时间：2009-05-01T09:53:13.523
> 
> 标签：sql-server, sql-server-2005, insert, identity, uniqueidentifier

我读过[这个](https://stackoverflow.com/questions/42648/best-way-to-get-identity-of-inserted-row)关于获取插入行的身份的问题。我的问题有点相关。

有没有办法获取插入行的 guid？我正在使用的表有一个 guid 作为主键（默认为 newid），我想在插入行后检索该 guid。

有没有类似的东西`@@IDENTITY`，`IDENT_CURRENT`或者`SCOPE_IDENTITY`对于Guids？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-01T10:03:54.980

您可以使用 OUTPUT 功能将默认值返回到参数中。

```
CREATE TABLE MyTable
(
    MyPK UNIQUEIDENTIFIER DEFAULT NEWID(),
    MyColumn1 NVARCHAR(100),
    MyColumn2 NVARCHAR(100)
)

DECLARE @myNewPKTable TABLE (myNewPK UNIQUEIDENTIFIER)

INSERT INTO 
    MyTable
(
    MyColumn1,
    MyColumn2
)
OUTPUT INSERTED.MyPK INTO @myNewPKTable
VALUES
(
    'MyValue1',
    'MyValue2'
)

SELECT * FROM @myNewPKTable 
```

不过我不得不说，使用唯一标识符作为主键时要小心。对 GUID 进行索引的性能极差，因为任何新生成的 guid 都必须插入到索引的中间，并且很少只添加到最后。SQL2005 中有NewSequentialId() 的新功能。如果您的指南不需要晦涩难懂，那么它是一种可能的选择。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-11-10T13:58:47.680

另一种更清洁的方法，如果插入单行

```
CREATE TABLE MyTable
(
    MyPK UNIQUEIDENTIFIER DEFAULT NEWID(),
    MyColumn1 NVARCHAR(100),
    MyColumn2 NVARCHAR(100)
)

DECLARE @MyID UNIQUEIDENTIFIER;
SET @MyID = NEWID();

INSERT INTO 
    MyTable
(
    MyPK
    MyColumn1,
    MyColumn2
)
VALUES
(
    @MyID,
    'MyValue1',
    'MyValue2'
)

SELECT @MyID; 
```

# utilities - 您最喜欢帮助您编程的小型实用程序（工具）是什么？

> ID：810830
> 
> 赞同：6
> 
> 时间：2009-05-01T09:53:28.110
> 
> 标签：utilities

以及它们如何帮助您改进编程？它们可以集成到 IDE 中吗？如果可以，如何集成？

编辑：感谢[altCognito](https://stackoverflow.com/users/38971/altcognito)在命名之前几乎有重复的问题： [你的实用工具包中](https://stackoverflow.com/questions/173328/whats-in-your-utility-toolkit)有什么**。“几乎”，因为那里的列表没有提供每个工具的确切作用的简短解释编辑：如果这个问题仍然存在并且您想添加一个新工具，请根据工具的受欢迎程度

一个简单的工具列表

*   [grep](http://en.wikipedia.org/wiki/Grep)用于强大的文本搜索
*   [ArsClip](http://www.joejoesoft.com/cms/showpage.php?cid=97) - 它记住剪贴板中最后 n 个条目。快捷键组合 Ctrl + Shift + Z , 2 为您提供从 Windows 剪贴板中最后复制的第二个文本（或对象）。从来没有听说过它以某种方式在 VS 中使用，我也没有错过这样的集成......
*   [Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx) - 用于杀死不需要的进程（例如 VS Team Services 帮助）+ 大量掌握 Windows 上的整体系统信息
*   [Paint.NET](http://www.getpaint.net/download.html) - 经常使用它来编写或调整图形（Visual Studio 几乎没有提供像样的图形编辑方式）。Paint.NET 非常适合制作透明的 PNG 或 GIF - 单击“魔棒”工具以选择要使其透明的区域，然后点击删除

您可以在我的博客上找到更广泛的[列表...](http://ysgitdiary.blogspot.com/2009/05/cool-programs-for-windows-most-of-which_24.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T10:37:31.547

Expresso：用于正则表达式的优秀免费且稳定的工具

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T12:50:06.937

*   [debugview](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)：用于捕获调试消息。
*   [notepad2](http://www.flos-freeware.ch/notepad2.html)：优秀的记事本替代品。
*   [调节器](http://sourceforge.net/projects/regulator/)：正则表达式编辑器和测试器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T10:00:21.760

*   用于 Visual Studio 的 VisualSVN 插件 - VS.Net 中的 SVN 集成
*   myGeneration - 用于代码生成
*   CCTray - 用于获取 CruiseControl 构建的实时更新
*   SQL 2005 查询分析器，当然用于查询
*   用于 jquery 方法 intellisense 的 Visual Studio 的 jquery 插件
*   Resharper - 用于即时错误突出显示和其他几个功能
*   watIn 测试记录器 - 用于记录测试脚本
*   nUnit - 用于执行单元测试用例
*   内置代码片段
*   XML 到 Schema - 专门用于 VS 2008 中的 VB.net

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T10:14:54.470

Paint.NET 和记事本++。

Paint.NET - 经常使用它来编写或调整图形（Visual Studio 几乎没有提供像样的图形编辑方式）。Paint.NET 非常适合制作透明的 PNG 或 GIF - 单击“魔术棒”工具选择要使其透明的区域，然后点击删除。

NotePad++ 能够右键单击任何大小的任何文件并查看其原始内容 - 绕过文件的默认查看器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T10:25:44.960

[Transmit](http://www.panic.com/transmit/)让我在服务器上实时编辑的事实绝对是天赐之物。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-01T10:31:54.010

我最喜欢的一个是我编写的一个很小的 ​​perl 脚本，它从文本中删除格式，这样我就可以剪切（从电子邮件或 word doc）并粘贴纯文本而不用花哨。

就在这里；

```
# Ridiculously simple, but very useful.
use Win32::Clipboard;
my $text = Win32::Clipboard::GetText() or exit;
Win32::Clipboard($text) if $text; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-01T10:32:04.057

[印象笔记](http://www.evernote.com/)。主要是因为它的自动同步功能让我可以在办公室、家里或任何有网络连接的地方轻松查看和更改我的所有笔记。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-01T12:42:52.977

那些便签的 Windows 边栏。适合快速复制和粘贴代码。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-01T10:05:54.557

我正在[为 Eclipse 重构插件。](http://willcodejavaforfood.com/vu.html)希望它能让您轻松地将遭受过多方法/字段的大类分解为较小的类。理论上，使用相似领域的方法根据单一职责原则属于同一类。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-01T13:28:35.393

*   [Visual Assit X](http://www.wholetomato.com/) - 这有很多小东西可以更好地在 Visual Studio 中编辑源代码。安装将它与 IDE 无缝集成。
*   [IncrediBuild](http://xoreax.com/) - 这会将您的 C/C++ 编译拆分到多台机器和/或处理器上。这是利用那些旧机器和多个处理器的好方法。安装将它与 IDE 无缝集成。
*   [包含](http://www.codeguru.com/cpp/misc/samples/article.php/c1471/)- 显示给定文件包含的所有头文件。我通过将它添加到 IDE 中的外部工具列表来集成它。
*   [Unlocker](http://www.emptyloop.com/unlocker/) - 当您因为被锁定而无法删除或重命名文件或目录时，此程序会自动弹出一个窗口，显示哪些程序已锁定。我没有将它与 IDE 集成。
*   [Beyond Compare](http://www.scootersoftware.com/) - 比较文件或文件夹。我已经用 Beyond Compare 替换了 Visual Source Safe 的默认比较程序。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-01T13:35:03.913

Firebug 和 Web 开发工具栏（都适用于 Firefox）——任何 Web 开发人员都不应该没有它们。

Firebug 允许您检查文档的结构并动态编辑 HTML/CSS。它还可以让您查看所涉及的 JavaScript。

Web 开发工具栏允许您禁用 CSS 和缓存。它可以让您重置 cookie。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-01T13:43:33.237

[Ack](http://betterthangrep.com/)：顾名思义，Ack 优于 grep。比 grep 好得多。比 grep 好多了，这让原来的 grep 看起来脑残了。

没有阿克我活不下去。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-01T13:43:44.110

*   [Mylyn](http://www.eclipse.org/mylyn) ——Eclipse 的任务集中界面
*   [Foglyn——](http://www.foglyn.com/)用于从 Eclipse/Mylyn 访问 FogBugz 案例（无耻插件）
*   [Fiddler2](http://www.fiddler2.com) -- HTTP 调试器，必备工具
*   [CLCL——](http://www.nakka.com/soft/clcl/index_eng.html)剪贴板历史
*   [Faststone Screen Capture](http://www.faststone.org/FSCaptureDetail.htm) - 用于制作出色的屏幕截图
*   Paint.NET——用于编辑屏幕截图或图标

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-01T13:48:03.600

[BeyondCompare](http://www.scootersoftware.com/)第 2名。价格低廉、功能强大且可用于 Linux。

# asp.net-mvc - ASP.NET MVC - 级联下拉循环引用错误

> ID：810831
> 
> 赞同：1
> 
> 时间：2009-05-01T09:53:34.193
> 
> 标签：asp.net-mvc

我有三个类 MainMenu、SubMenu 和 Secondary SubMenu。我有一个级联下拉框，用于创建辅助子菜单。选择一个主菜单，然后显示一个带有子菜单的下拉菜单。当我在 MainMenu 下拉框中选择一个项目时，出现错误：

System.InvalidOperationException：在序列化“System.Reflection.Module”类型的对象时检测到循环引用。

SubMenu 引用 MainMenu，SecondaryMenu 引用 SubMenu。

我不确定从哪里开始寻找错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T09:56:40.957

那么，什么是`SubMenu`？

如果您有“父”关系，这通常发生在树序列化程序（例如`XmlSerializer`JSON 实现等）中。你的子菜单知道它的父级吗？也许你能把它变成一个内部属性吗？还是将其标记为忽略？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T10:03:05.437

如果一个对象 A 引用另一个对象 B 而另一个对象 B 又引用对象 A，那么 Json 方法使用反射/递归将任何对象结构转换为 Json，这样您就会陷入无限循环。**子菜单有**父子属性吗？如果是这样，在大多数情况下，您只需要 1。

# c++ - 从构造函数中抛出异常

> ID：810839
> 
> 赞同：321
> 
> 时间：2009-05-01T09:56:54.950
> 
> 标签：c++, exception, constructor, throw

我正在与一位同事就从构造函数中抛出异常进行辩论，并认为我想要一些反馈。

从设计的角度来看，可以从构造函数中抛出异常吗？

假设我在一个类中包装了一个 POSIX 互斥体，它看起来像这样：

```
class Mutex {
public:
  Mutex() {
    if (pthread_mutex_init(&mutex_, 0) != 0) {
      throw MutexInitException();
    }
  }

  ~Mutex() {
    pthread_mutex_destroy(&mutex_);
  }

  void lock() {
    if (pthread_mutex_lock(&mutex_) != 0) {
      throw MutexLockException();
    }
  }

  void unlock() {
    if (pthread_mutex_unlock(&mutex_) != 0) {
      throw MutexUnlockException();
    }
  }

private:
  pthread_mutex_t mutex_;
}; 
```

我的问题是，这是标准的做法吗？因为如果`pthread mutex_init`调用失败，互斥对象将不可用，因此抛出异常可确保不会创建互斥对象。

我是否应该为 Mutex 类创建一个成员函数 init 并`pthread mutex_init`在其中调用将基于`pthread mutex_init`的返回返回一个 bool ？这样我就不必为这样一个低级别的对象使用异常。

* * *

## 回答 #1

> 赞同：284
> 
> 时间：2009-05-01T10:02:09.900

是的，从失败的构造函数中抛出异常是执行此操作的标准方法。阅读有关[处理失败的构造函数的](https://isocpp.org/wiki/faq/exceptions#ctors-can-throw)常见问题解答以获取更多信息。有一个 init() 方法也可以，但是每个创建 mutex 对象的人都必须记住必须调用 init()。我觉得这违反了[RAII](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)原则。

* * *

## 回答 #2

> 赞同：116
> 
> 时间：2009-05-01T10:31:14.057

如果您确实从构造函数中抛出异常，请记住，如果您需要在构造函数初始化程序列表中捕获该异常，则需要使用函数 try/catch 语法。

例如

```
func::func() : foo()
{
    try {...}
    catch (...) // will NOT catch exceptions thrown from foo constructor
    { ... }
} 
```

对比

```
func::func()
    try : foo() {...}
    catch (...) // will catch exceptions thrown from foo constructor
    { ... } 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2009-05-01T10:12:52.527

抛出异常是处理构造函数失败的最好方法。您应该特别避免半构建对象，然后依靠您的类的用户通过测试某种标志变量来检测构造失败。

在相关的一点上，你有几种不同的异常类型来处理互斥错误，这让我有点担心。继承是一个很好的工具，但它可能被过度使用。在这种情况下，我可能更喜欢单个 MutexError 异常，可能包含信息性错误消息。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2016-06-29T15:01:37.007

```
#include <iostream>

class bar
{
public:
  bar()
  {
    std::cout << "bar() called" << std::endl;
  }

  ~bar()
  {
    std::cout << "~bar() called" << std::endl;

  }
};
class foo
{
public:
  foo()
    : b(new bar())
  {
    std::cout << "foo() called" << std::endl;
    throw "throw something";
  }

  ~foo()
  {
    delete b;
    std::cout << "~foo() called" << std::endl;
  }

private:
  bar *b;
};

int main(void)
{
  try {
    std::cout << "heap: new foo" << std::endl;
    foo *f = new foo();
  } catch (const char *e) {
    std::cout << "heap exception: " << e << std::endl;
  }

  try {
    std::cout << "stack: foo" << std::endl;
    foo f;
  } catch (const char *e) {
    std::cout << "stack exception: " << e << std::endl;
  }

  return 0;
} 
```

输出：

```
heap: new foo
bar() called
foo() called
heap exception: throw something
stack: foo
bar() called
foo() called
stack exception: throw something 
```

不调用析构函数，因此如果需要在构造函数中抛出异常，则需要做很多事情（例如清理？）。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-05-01T12:01:00.083

从构造函数中抛出是可以的，但是你应该确保你的对象是在*main*启动之后和完成之前构造的：

```
class A
{
public:
  A () {
    throw int ();
  }
};

A a;     // Implementation defined behaviour if exception is thrown (15.3/13)

int main ()
{
  try
  {
    // Exception for 'a' not caught here.
  }
  catch (int)
  {
  }
} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-01T15:16:14.293

唯一不会从构造函数中抛出异常的情况是，如果您的项目有禁止使用异常的规则（例如，[Google](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml)不喜欢异常）。在这种情况下，您不会比其他任何地方都更希望在构造函数中使用异常，而您必须使用某种 init 方法。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2018-04-10T14:54:08.343

在这里添加所有答案，我想提一下，一个非常具体的原因/场景，您可能希望从类的`Init`方法而不是从 Ctor 抛出异常（这当然是首选和更常见的方法）。

我将提前提到，这个示例（场景）假设您不`std::unique_ptr`为类的指针数据成员使用“智能指针”（即-）。

**所以重点是**：如果你希望你的类的 Dtor 在你调用它时“采取行动”（对于这种情况）你捕获你的`Init()`方法抛出的异常 - 你不能从 Ctor 抛出异常，导致不会在“半生不熟”的对象上调用对 Ctor 的 Dtor 调用。

请参阅下面的示例来证明我的观点：

```
#include <iostream>

using namespace std;

class A
{
    public:
    A(int a)
        : m_a(a)
    {
        cout << "A::A - setting m_a to:" << m_a << endl;
    }

    ~A()
    {
        cout << "A::~A" << endl;
    }

    int m_a;
};

class B
{
public:
    B(int b)
        : m_b(b)
    {
        cout << "B::B - setting m_b to:" << m_b << endl;
    }

    ~B()
    {
        cout << "B::~B" << endl;
    }

    int m_b;
};

class C
{
public:
    C(int a, int b, const string& str)
        : m_a(nullptr)
        , m_b(nullptr)
        , m_str(str)
    {
        m_a = new A(a);
        cout << "C::C - setting m_a to a newly A object created on the heap (address):" << m_a << endl;
        if (b == 0)
        {
            throw exception("sample exception to simulate situation where m_b was not fully initialized in class C ctor");
        }

        m_b = new B(b);
        cout << "C::C - setting m_b to a newly B object created on the heap (address):" << m_b << endl;
    }

    ~C()
    {
        delete m_a;
        delete m_b;
        cout << "C::~C" << endl;
    }

    A* m_a;
    B* m_b;
    string m_str;
};

class D
{
public:
    D()
        : m_a(nullptr)
        , m_b(nullptr)
    {
        cout << "D::D" << endl;
    }

    void InitD(int a, int b)
    {
        cout << "D::InitD" << endl;
        m_a = new A(a);
        throw exception("sample exception to simulate situation where m_b was not fully initialized in class D Init() method");
        m_b = new B(b);
    }

    ~D()
    {
        delete m_a;
        delete m_b;
        cout << "D::~D" << endl;
    }

    A* m_a;
    B* m_b;
};

void item10Usage()
{
    cout << "item10Usage - start" << endl;

    // 1) invoke a normal creation of a C object - on the stack
    // Due to the fact that C's ctor throws an exception - its dtor
    // won't be invoked when we leave this scope
    {
        try
        {
            C c(1, 0, "str1");
        }
        catch (const exception& e)
        {
            cout << "item10Usage - caught an exception when trying to create a C object on the stack:" << e.what() << endl;
        }
    }

    // 2) same as in 1) for a heap based C object - the explicit call to 
    //    C's dtor (delete pc) won't have any effect
    C* pc = 0;
    try
    {
        pc = new C(1, 0, "str2");
    }
    catch (const exception& e)
    {
        cout << "item10Usage - caught an exception while trying to create a new C object on the heap:" << e.what() << endl;
        delete pc; // 2a)
    }

    // 3) Here, on the other hand, the call to delete pd will indeed 
    //    invoke D's dtor
    D* pd = new D();
    try
    {
        pd->InitD(1,0);
    }
    catch (const exception& e)
    {
        cout << "item10Usage - caught an exception while trying to init a D object:" << e.what() << endl;
        delete pd; 
    }

    cout << "\n \n item10Usage - end" << endl;
}

int main(int argc, char** argv)
{
    cout << "main - start" << endl;
    item10Usage();
    cout << "\n \n main - end" << endl;
    return 0;
} 
```

我会再次提到，这不是推荐的方法，只是想分享一个额外的观点。

此外，正如您可能从代码中的一些打印内容中看到的那样 - 它基于 Scott Meyers（第 1 版）出色的“更有效的 C++”中的第 10 项。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-12-19T14:32:46.847

如果你的项目通常依赖异常来区分坏数据和好数据，那么从构造函数中抛出异常是比不抛出更好的解决方案。如果没有抛出异常，则将对象初始化为僵尸状态。这样的对象需要暴露一个标志，表明该对象是否正确。像这样的东西：

```
class Scaler
{
    public:
        Scaler(double factor)
        {
            if (factor == 0)
            {
                _state = 0;
            }
            else
            {
                _state = 1;
                _factor = factor;
            }
        }

        double ScaleMe(double value)
        {
            if (!_state)
                throw "Invalid object state.";
            return value / _factor;
        }

        int IsValid()
        {
            return _status;
        }

    private:
        double _factor;
        int _state;

} 
```

这种方法的问题在于调用方。该类的每个用户在实际使用该对象之前都必须执行一个 if。这是对错误的呼吁——没有什么比在继续之前忘记测试条件更简单的了。

如果构造函数抛出异常，构造对象的实体应该立即处理问题。下游的对象消费者可以自由地假设对象是 100% 可操作的，因为他们获得了它。

这种讨论可以在许多方向上继续进行。

例如，使用异常作为验证问题是一种不好的做法。一种方法是结合工厂类的 Try 模式。如果您已经在使用工厂，请编写两种方法：

```
class ScalerFactory
{
    public:
        Scaler CreateScaler(double factor) { ... }
        int TryCreateScaler(double factor, Scaler **scaler) { ... };
} 
```

使用此解决方案，您可以就地获取状态标志，作为工厂方法的返回值，而无需输入带有错误数据的构造函数。

第二件事是如果你用自动化测试覆盖代码。在这种情况下，每段使用不抛出异常的对象的代码都必须通过一个额外的测试来覆盖——当 IsValid() 方法返回 false 时它是否正确运行。这很好地解释了在僵尸状态下初始化对象是一个坏主意。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2015-12-26T23:04:15.033

除了**您不需要**在特定情况下从构造函数中抛出这一事实之外，因为[如果您的互斥体尚未初始化，则](http://linux.die.net/man/3/pthread_mutex_lock)[`pthread_mutex_lock`实际上返回一个**EINVAL**](http://linux.die.net/man/3/pthread_mutex_lock)并且您可以在调用`lock`as后抛出`std::mutex`：

```
void
lock()
{
  int __e = __gthread_mutex_lock(&_M_mutex);

  // EINVAL, EAGAIN, EBUSY, EINVAL, EDEADLK(may)
  if (__e)
__throw_system_error(__e);
} 
```

那么通常*从构造函数中抛出对于构造过程*中的**获取**错误是可以的，并且符合**RAII**（资源获取是初始化）编程范式。

[在 RAII 上](https://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)查看此示例

```
void write_to_file (const std::string & message) {
    // mutex to protect file access (shared across threads)
    static std::mutex mutex;

    // lock mutex before accessing file
    std::lock_guard<std::mutex> lock(mutex);

    // try to open file
    std::ofstream file("example.txt");
    if (!file.is_open())
        throw std::runtime_error("unable to open file");

    // write message to file
    file << message << std::endl;

    // file will be closed 1st when leaving scope (regardless of exception)
    // mutex will be unlocked 2nd (from lock destructor) when leaving
    // scope (regardless of exception)
} 
```

关注这些陈述：

1.  `static std::mutex mutex`
2.  `std::lock_guard<std::mutex> lock(mutex);`
3.  `std::ofstream file("example.txt");`

第一个语句是 RAII 和`noexcept`. 在 (2) 中，很明显 RAII 应用在`lock_guard`并且它实际上可以`throw`，而在 (3) 中`ofstream`似乎不是 RAII ，因为必须通过调用`is_open()`检查`failbit`标志来检查对象状态。

乍一看，它似乎还没有决定它是什么**标准方式**，并且在第一种情况下`std::mutex`不抛出初始化，*与 OP 实现相反*。在第二种情况下，它会抛出从 中抛出的任何东西`std::mutex::lock`，而在第三种情况下，根本就没有投掷。

注意差异：

(1) 可以声明为静态，实际会声明为成员变量 (2) 永远不会实际声明为成员变量 (3) 预期声明为成员变量，底层资源可能并不总是可用。

所有这些形式都是**RAII**；要解决这个问题，必须分析**RAII**。

*   资源：你的对象
*   获取（分配）：您正在创建的对象
*   初始化：您的对象处于其**不变状态**

这不需要您在构造时初始化和连接所有内容。例如，当您创建一个网络客户端对象时，您实际上不会在创建时将其连接到服务器，因为它是一个缓慢的操作，并且会失败。您将改为编写一个`connect`函数来做到这一点。另一方面，您可以创建缓冲区或仅设置其状态。

因此，您的问题归结为定义您的初始状态。如果在您的情况下，您的初始状态是**必须初始化互斥锁，**那么您应该从构造函数中抛出。相比之下，不初始化然后（如在 中所做的那样）并**在创建互斥锁**`std::mutex`时定义您的不变状态就可以了。无论如何，不​​变量不一定会受到其成员对象的状态的影响，因为对象在公共方法和之间或通过公共方法发生变异。**`mutex_``locked``unlocked``Mutex``Mutex::lock()``Mutex::unlock()`**

 **```
class Mutex {
private:
  int e;
  pthread_mutex_t mutex_;

public:
  Mutex(): e(0) {
  e = pthread_mutex_init(&mutex_);
  }

  void lock() {

    e = pthread_mutex_lock(&mutex_);
    if( e == EINVAL ) 
    { 
      throw MutexInitException();
    }
    else (e ) {
      throw MutexLockException();
    }
  }

  // ... the rest of your class
}; 
```

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-05-01T10:07:25.597

虽然我没有在专业水平上工作过 C++，但在我看来，从构造函数中抛出异常是可以的。我在.Net中这样做（如果需要）。看看[这个](http://www.codeproject.com/script/Forums/View.aspx?fid=1649&msg=2957496)和[这个](http://www.dev102.com/2008/12/03/throwing-exceptions-from-constructors/)链接。这可能是你的兴趣。

# javascript - Javascript / JQUery 动态变量访问

> ID：810840
> 
> 赞同：0
> 
> 时间：2009-05-01T09:57:00.677
> 
> 标签：javascript, jquery

我有一个引用复杂对象的 javascript 变量（它是幻灯片控件，但这并不重要）

```
e.g.
var slideshow = new SlideShow(); 
```

因为我在页面上有多个幻灯片，并且我想在不同的页面中访问某些操作通用/重用代码。

我希望能够在同一个 JAVASCRIPT 例程中访问包含不同幻灯片实例的不同变量。使用的变量不同，具体取决于当时控制的幻灯片。

所以而不是

```
slideshow.playSlides(); 
```

做类似的事情

```
[dynamically get reference to variable containing slideshow].playSlides(); 
```

我以前在 JavaScript 中研究过这个并没有找到解决方案，我想知道这是否可以在 JQUERY 中以某种方式完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T10:04:02.593

嗯...有些东西必须包含变量，所以这是您需要首先回答的问题。我的想法是将它存储在一个哈希中，一开始你可能看起来并没有太大的不同：

```
var slideshows = {};    
slideshows['someslideshowName'] = new SlideShow(); 
```

但是现在您可以毫无问题地按名称引用。

或者看起来像....

```
window.slideshows = {};
var slideShowName = 'someSlideShowName';
window.slideshows[slideShowName] = new SlideShow(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T10:10:02.253

如果我理解这个问题，为什么不创建一个幻灯片数组并枚举它们，这样你就有 0 到 N 个幻灯片，而无需重新编码。

```
var slideshows = [new SlideShow()];

function playSlides() {
   for(var i=0; i < slideshows.length; i++) {
       slideshows[i].playSlides();
   }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T11:36:42.513

我将添加一个完全不同的解决方案，我认为它更有意义：

正如我所说，*某些东西*必须包含变量

如果它是由浏览器呈现的控件。我会将实例挂在代表控件的元素上。理想情况下，您正在为元素分配某种类。所以，之后就很简单了。

```
$('.theslideshowclass').each(function() {
   this.slideshow = new SlideShow();
}); 
```

这是一个 jQuery 风格的解决方案。我很失望我第一次没有那样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T10:03:54.263

如果它是一个全局变量，您可以使用该`window`对象：

```
var name = 'slideshow';
window[name].playSlides(); 
```

通常这种事情是没有必要的——你可能应该传递你的`slideshow`变量。你想达到什么目的？

# html - 存储通过 Web 富文本编辑器输入的 HTML 标记？

> ID：810852
> 
> 赞同：2
> 
> 时间：2009-05-01T10:03:23.827
> 
> 标签：html, sql-server

我目前正在研究网站的管理部分。管理员可以使用 infragistics WebHtmlEditor 工具为页面创建标记，然后在加载时将其加载到页面中。

将此标记存储在数据库中的最佳方法是什么？我们是否应该将 WebHtmlEditor 生成的 HTML 保存到 varchar 字段中？这是否有任何问题，例如是否会丢失任何标记或导致数据库出现问题？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-02T07:31:57.443

SQL 不是问题，但如果允许管理员从 Word 粘贴，那么您需要在存储之前清理标记。我不知道[WebHtmlEditor](http://www.infragistics.com/dotnet/netadvantage/aspnet/webhtmleditor.aspx)，但您可以轻松测试：如果从 Word 粘贴会产生类似

```
style="mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: EN-US; 
  mso-fareast-language: EN-US; mso-bidi-language: AR-SA; 
  mso-bidi-font-family: 'Times New Roman'; mso-highlight: yellow" 
```

或者

```
<p class="MsoNormal"> .. </p><o.p></o.p> 
```

或许多附加标签`<span>`，`<div>`那么您需要在存储之前清理标记。也许您可以使用一些在线演示进行测试，然后单击编辑器中的一些查看 HTML 按钮，但您不知道编辑器是否会在保存后清理。

请注意，浏览器对 Word 粘贴的响应不同，因此如果您依赖 WebHtmlEditor 来清理内容，那么您可能需要使用一些不同的浏览器进行测试。

一些富文本编辑器提供了一个特殊的按钮“从 Word 粘贴”，但这可能会有效地充当“粘贴为纯文本”，之后您的管理员可能会停止使用它......（当然，您的管理员可能只是忘记使用它，因此即使存在这样的按钮也需要清理。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T07:10:47.680

只需将其直接保存到您的数据库中，并注意类型和长度。您可能会发现它应该是一个 nvarchar(max) 列。假设您没有在从控件收集值和传递到数据库之间进行任何转换，则不应丢失任何标记。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T10:07:27.983

我认为 HTML 和 SQL 没有任何问题。只需记住在选择后插入 / 之前转义和取消转义。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-02T08:11:20.423

这取决于您存储的 HTML 的大小和字符编码。

由于这篇文章被标记为 SQL Server，因此当前的 VARCHAR(MAX) 为 8000 个字符。

如果它不再是你可以使用 TEXT 类型。

存在带有 TEXT 字段的警告，因为它们限制了使用 LIKE 查询的能力，以及 UNION、复制等问题。

如果您需要高级字符集，您还可以考虑 unicode 类型 NVARCHAR 和 NTEXT，但它们占用的存储空间是 VARCHAR 和 TEXT 的两倍，因为它们每个字符使用 2 个字节而不是 1 个字节。

如果这些内容中的任何内容是由用户输入的，你应该非常小心 XSS 注入攻击，一旦你开始允许来自用户的 HTML，这种攻击几乎是不可能停止的。

VARCHAR： http: [//msdn.microsoft.com/en-us/library/aa258242](http://msdn.microsoft.com/en-us/library/aa258242(SQL.80).aspx) (SQL.80).aspx 文本： http://msdn.microsoft.com/en-us/library/aa260619( [SQL.80) .aspx](http://msdn.microsoft.com/en-us/library/aa260619(SQL.80).aspx)

XSS 攻击：[http ://en.wikipedia.org/wiki/Cross-site_scripting](http://en.wikipedia.org/wiki/Cross-site_scripting)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T10:29:39.803

数据库将存储它提供的原始数据。从那时起，无需对其进行任何操作，您只需将 HTML 和存储在该 varchar 字段中的所有内容输出到 HTML 页面上，它就可以正常工作。

记得调用 mysql_real_escape_string(); （或您的等效语言）在将 WebHtmlEditor 输出的 post 值放入数据库之前，以确保它不会在 SQL 查询中引发任何错误。

# java - Oracle SYS_CONNECT_BY_PATH 达到 4000 个字符的限制

> ID：810853
> 
> 赞同：2
> 
> 时间：2009-05-01T10:03:37.370
> 
> 标签：java, sql, oracle, analytics

我想对来自 Java 的 Oracle 9i 数据库运行如下查询（下面是示例表结构和示例数据）。

```
选择部门号
, SUBSTR(comma_list, 2) comma_list
从（选择部门号
        , SYS_CONNECT_BY_PATH(ename, ',') comma_list
        , 行号
        , 行数
        从（选择部门号
               , 姓名
               , ROW_NUMBER()OVER(PARTITION BY deptno
                                       ORDER BY empno) row_number
               , COUNT(*)OVER(PARTITION BY deptno) row_count
               来自 wd_emp)
        从 row_number = 1 开始
        通过 deptno 连接 = 先前的 deptno
        AND row_number = PRIOR row_number + 1)
WHERE row_number = row_count;

```

这工作正常。但是，如果构建 comma_list 的 sys_connect_by_path 达到 varchar2 4000 个字符的限制，那么我会收到**“ORA-01489：字符串连接的结果太长”**错误。

是否有人对如何克服此限制有任何建议，以便我的串联可以超过 4000 个字符？

表格和示例数据：

```
CREATE TABLE WD_DEPT(DEPTNO NUMBER(2) CONSTRAINT PK_DEPT PRIMARY KEY
                    ,DNAME VARCHAR2(14)
                    ,LOC VARCHAR2(13));

CREATE TABLE WD_EMP(EMPNO NUMBER(4) CONSTRAINT PK_EMP PRIMARY KEY
                   ,ENAME VARCHAR2(10)
                   ,JOB VARCHAR2(10)
                   ,经理编号(4)
                   ,雇用日期
                   ,SAL 编号(7,2)
                   ,DEPTNO NUMBER(2) 约束 FK_DEPTNO 参考 WD_DEPT);

INSERT INTO WD_DEPT VALUES(10,'TEAM GREGORY','TABLE 3');
插入 WD_DEPT 值（20，'TEAM HANLEY'，'表 2'）；
INSERT INTO WD_DEPT VALUES(30,'TEAM OFFIAH','TABLE 4');
INSERT INTO WD_DEPT VALUES(40,'TEAM BOTICA','TABLE 1');
INSERT INTO WD_DEPT VALUES(50,'TEAM SKERRETT','TABLE 4');
INSERT INTO WD_DEPT VALUES(60,'TEAM McGINTY','TABLE 1');
INSERT INTO WD_DEPT VALUES(70,'EMPTY TEAM','NO TABLE');

插入 WD_EMP 值（11，'GREGORY'，'TEAM LEAD'，28，to_date（'18-JAN-2000'，'DD-MON-RRRR'），800，10）；
插入 WD_EMP 值（12,'BELL', 'DEVELOPER', 11, to_date('17-JAN-2000', 'DD-MON-RRRR'), 600, 10);
插入 WD_EMP 值（13,'CLARKE', 'DEVELOPER', 11, to_date('16-JAN-2000', 'DD-MON-RRRR'), 600, 10);
插入 WD_EMP 值（14，'HANLEY'，'团队领导'，28，to_date（'15-JAN-2000'，'DD-MON-RRRR'），800，20）；
插入 WD_EMP 值（15,'BETTS', 'CONTRACTOR', 14, to_date('14-JAN-2000', 'DD-MON-RRRR'), 700, 20);
插入 WD_EMP 值（16,'MILES', 'CONTRACTOR', 14, to_date('13-JAN-2000', 'DD-MON-RRRR'), 700, 20);
插入 WD_EMP 值（17，'HAMPSON'，'DEVELOPER'，14，to_date（'12-JAN-2000'，'DD-MON-RRRR'），600，20）；
插入 WD_EMP 值（18,'PRESTON', 'DEVELOPER', 14, to_date('11-JAN-2000', 'DD-MON-RRRR'), 600, 20);
插入 WD_EMP 值（19，'OFFIAH'，'团队领导'，28，to_date（'10-JAN-2000'，'DD-MON-RRRR'），800，30）；
插入 WD_EMP 值（20,'PLATT', 'DEVELOPER', 19, to_date('09-JAN-2000', 'DD-MON-RRRR'), 600, 30);
插入 WD_EMP 值（21，'POTTER'，'DEVELOPER'，19，to_date（'08-JAN-2000'，'DD-MON-RRRR'），600，30）；
插入 WD_EMP 值（22,'CASE', 'DEVELOPER', 19, to_date('07-JAN-2000', 'DD-MON-RRRR'), 600, 30);
插入 WD_EMP 值（23，'BOTICA'，'团队领导'，28，to_date（'06-JAN-2000'，'DD-MON-RRRR'），800，40）；
插入 WD_EMP 值（24,'GILL', 'DEVELOPER', 23, to_date('05-JAN-2000', 'DD-MON-RRRR'), 600, 40);
插入 WD_EMP 值（25，'SKERRETT'，'团队领导'，28，to_date（'04-JAN-2000'，'DD-MON-RRRR'），800，50）；
插入 WD_EMP 值（26，'McGINTY'，'TEAM LEAD'，28，to_date（'03-JAN-2000'，'DD-MON-RRRR'），800，60）；
插入 WD_EMP 值（27，'LOWE'，'MANAGER'，28，to_date（'02-JAN-2000'，'DD-MON-RRRR'），900，NULL）；
插入 WD_EMP 值（28，'MONIE'，'MANAGER'，NULL，to_date（'01-JAN-2000'，'DD-MON-RRRR'），1000，NULL）；

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T10:18:14.353

是否有必要在 SQL 中构建逗号列表？

由于无论如何您都是从 Java 运行它，也许您可​​以查询具有“parent_id”、“child_id”、“tree_level”列的行并在应用程序代码中构建员工路径？我想您现在无论如何都要将它拆分为一个列表（4000 个字符的字符串不能用于直接显示目的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-05T16:35:56.337

两个想法：

*   不要连接实际的字符串，而是使用较短的占位符并使用一些替换方法（在 java 或其他方式中）插入真实姓名

*   您可以创建多个列： comma_list_ 其中每个包含第 n 组 400 名员工。最终值将通过在客户端中连接这些列而产生。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-13T19:26:21.680

我了解到 varchar2 的 4000 个字符限制仅适用于列——实际上允许 varchar2 的长度更大，例如在 PL/SQL 中。您确定您的查询没有错误地递归并生成一些大型笛卡尔积吗？

# sql - SQL Express 2005/2008 并发连接

> ID：810870
> 
> 赞同：7
> 
> 时间：2009-05-01T10:09:11.660
> 
> 标签：sql, sql-server, ado.net

Express 版本允许多少个并发连接？

我的前端使用标准的 ADO.Net 代码打开与服务器的连接，获取我的数据，然后关闭连接。我是否正确地说，一旦连接关闭，它就允许另一个用户打开这个连接？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-01T10:21:03.317

SQL Server 的 Express 版本不限制并发连接数 - 它们在其他方面施加限制 - 例如数据库的最大大小 (4GB)、CPU 套接字 (1) 和内存量 (1GB)。

更多信息[在这里](http://www.microsoft.com/sqlserver/2008/en/us/editions.aspx)。

您说得对，当连接关闭时，它的资源会立即释放。唯一需要注意的是 .NET 中的连接池。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T08:28:15.577

.net 为您处理所有这些。它为每个唯一的连接字符串创建一个连接池，您的数据库调用将共享该连接。当您调用 conn.Open() 时，.Net 并没有真正打开/关闭真正的连接，连接池会处理这个问题。

# c++ - 音频文件元数据的最佳库？

> ID：810872
> 
> 赞同：1
> 
> 时间：2009-05-01T10:10:22.720
> 
> 标签：c++, c, audio, mp3, ogg

我正在寻找一个库来从压缩和未压缩的音频文件（即 mp3、ogg 等）中读取元数据。过去我使用过 libvorbis 和 id3lib，但我想知道周围是否有更好的库？理想情况下，我想要一个库，它提供一个通用 API 来读取各种格式的元数据。我意识到更高级的库可能有 id3lib 和 libvorbis 作为依赖项，我不介意，我只是想避免编写自己的包装器。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T10:19:42.713

[TagLib](http://developer.kde.org/~wheeler/taglib.html)似乎是一个不错的候选者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T19:11:37.830

It's part of the symbian API, but it seems to do what you wanted, so check this out as well:

[http://wiki.forum.nokia.com/index.php/Audio_Metadata_Reader_API](http://wiki.forum.nokia.com/index.php/Audio_Metadata_Reader_API)

# c# - 将类重构为接口而不破坏 C# 中的序列化

> ID：810875
> 
> 赞同：2
> 
> 时间：2009-05-01T10:12:23.993
> 
> 标签：c#, .net, serialization, refactoring

我有一个已序列化到本地用户机器上的磁盘的类。我需要重构这个类，并将所有对象（除枚举、字符串、数字之外的任何对象）更改为接口。在它下面仍然是同一个具体的类。我担心的是破坏现有用户的持久性

从：

```
public class Foo
{
     public double Count;
     public State MyState;
} 
```

到

```
public class IFoo
{
     public double Count;
     public IState MyState;
} 
```

但现在我从序列化代码中收到错误，上面写着“无法序列化，因为它是一个接口”

错误状态：

**“反映类型 'Foo' 时出现错误。” “无法序列化 'IState' 类型的成员 'Foo.My'，有关更多详细信息，请参阅内部异常。”**

解决这个问题的最好方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T10:16:39.070

您不能序列化接口，因为可以实现接口的类型数量是无限的，并且序列化程序不知道它是什么具体类型。

```
class A : IFoo {}
class B : IFoo {}
class C : IFoo {}
//snip//

IFoo f = new A();
     f = new B();
     f = new C(); 
```

您必须指定是序列化 A、B 还是 C。

另一种思考方式是在反序列化为 IFoo 时，您如何知道要创建哪个... A、B 或 C .. 等？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T10:20:27.343

我认为您必须通过实现 ISerializable 来显式处理序列化。想一想反序列化如何确定用于 IState 的具体类。它不知道。这就是为什么您需要自己处理序列化的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T14:59:39.187

考虑让你的`IState`接口继承自`ISerializable`：

```
public interface IState : ISerializable 
```

先读一读`ISerializable`。它给这个问题增加了一些复杂性。

# regex - 在使用 $variable 和 ${variable} 之间在正则表达式中传递变量时，Perl 有什么区别

> ID：810876
> 
> 赞同：6
> 
> 时间：2009-05-01T10:12:25.180
> 
> 标签：regex, perl, syntax, triggers, clearcase

我正在审查一些用 Perl 编写的 ClearCase 触发器。我注意到在一些正则表达式中，变量要么直接传递，要么用大括号括起来。

例如，我在触发器中有以下代码行：

```
if ($baseline !~ /^${component}_(|.*_)$phase\.\d+(|[a-z]|-\d+|${automateddigit})$/ &&
        $baseline !~ /^${project_root}_$phase\.\d+(|[a-z]|-\d+|${automateddigit})$/) 
```

`$component`, `$phase`, `$automateddigit`,`$project_root`都是变量。

为什么在正则表达式中有一些传递为`$variable`而另一些传递为？`${variable}`

它来自它们的初始化方式吗？

这是初始化它们的代码行：

```
($project = $ENV{CLEARCASE_PROJECT}) =~ s/\@.*$//;
($component = $ENV{CLEARCASE_COMPONENT}) =~ s/\@.*$//;

($project_root, $phase) = ($project =~ /^(.*)_(R\d+.*)$/);

exit(0) if (! $phase);

$phase .= ".0" if ($phase =~ /^R\d+$/);

$automateddigit = '';

$istream = `cleartool desc -fmt "%[istream]p" project:$ENV{CLEARCASE_PROJECT}`;

$componentlist = `cleartool desc -fmt "%[components]Cp" stream:$ENV{CLEARCASE_STREAM}`;
$componentsnbr = split(',', $componentlist);

if ($componentsnbr > 1) {
    $automateddigit .= '\\.\\d+';
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T10:21:35.703

如果您将变量作为 ${name} 传递，这将明确界定变量名称的结尾在哪里，以及引用字符串的其余部分从哪里开始。例如，在您的代码中：

```
if ($baseline !~ /^${component}_(|.*_)$phase\.\d+(|[a-z]|-\d+|${automateddigit})$/ && 
```

没有`{}`分隔符：

```
if ($baseline !~ /^$component_(|.*_)$phase\.\d+(|[a-z]|-\d+|${automateddigit})$/ && 
```

请注意，由于正则表达式中的尾随下划线，变量 $component（您可以通过任何一种方式引用它）将被误解为 $component_。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T10:22:34.063

首先，这称为字符串插值。在这种情况下使用它的一个很好的理由是防止 $project_root 被解释为 $project_root_ （注意结尾的下划线）。它明确了变量名称，而不是将其留给更复杂的插值规则。

有关插值的更多信息，请参见 perldata，有关正则表达式运算符中插值的特性，请参见 perlre 和 perlop。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T01:26:32.220

如上所述，它用于分隔变量名称。太多的花括号会使已经很困难的正则表达式变得更加困难。花括号有自己的正则表达式用途（限制模式匹配的次数）。我建议使用正则表达式 /x 修饰符，并将您的正则表达式重写为：

```
if ($baseline !~ /^$component    # Start with $component
                   _             # then an underscore
                   (|.*_)        # Then nothing, or anything followed by an underscore
                   $phase        # ...
                   \.\d+         # ...
                   (|            # Then optionally:
                      [a-z]|       # lower alpha
                      -\d+|        # or ...
                      $automateddigit
                   )
                   $/x &&
    $baseline !~ /^$project_root
                   _
                   $phase
                   \.\d+
                   (|
                     [a-z]|
                     -\d+|
                     $automateddigit
                   )$/x) 
```

# jquery - 在 ASP.NET MVC 中处理 jquery 事件

> ID：810878
> 
> 赞同：1
> 
> 时间：2009-05-01T10:13:08.687
> 
> 标签：jquery, asp.net-mvc

我会尽量让这变得简单。

我刚开始使用 jquery，不知道做我想做的事情的最佳方法是什么，或者我是否完全错了。我正在尝试制作一个简单的“推荐”按钮来推荐文章，但我希望一旦用户推荐了一篇文章，他就不能再次推荐它。

到目前为止，我让按钮工作并使用函数 $.post 发布数据，然后，当用户投票时，我禁用按钮，因此他不能再次发布数据。问题是，如果他重新加载页面，按钮就会再次启用（我正在控制这个服务器端，但我也想禁用按钮客户端）。

如果用户在 .ready 函数中推荐了一篇文章以便不绑定按钮事件，那么从 jquery 检测的最佳方法是什么？

我可以想到两个可行的解决方案，但对我来说似乎没有一个足够干净，第一个是如果建议与模型一起加载，则为视图中的按钮提供不同的 ID，以便事件永远不会绑定。或者另一种解决方案是在 document.ready 中进行另一个 ajax 调用，以检查该文章是否已被推荐。

很多网站都有这种行为（例如 youtube），所以必须有更好的方法来做到这一点。

一些代码：

这是我在视图中的“按钮”：

```
<% // Display the button %>
<%= Html.Image("/ECA/Content/Images/notchecked.png", new { id = "recommend"  })%> 
```

我的 jquery 事件绑定：

```
 //Add click event to recommend the article
    $("img[id^='recommend']").click
    (
            function() {

                UpdateVote( 2);
            }
    ); 
```

我的回调函数：

```
var UpdateVoteCallBack=function(data) {
     $("#recommend")
    .attr('src','/ECA/Content/Images/checked.png');
     $("#recommend").unbind('click');

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T10:43:08.507

当你绘制原始服务器页面时，不要为已经推荐的文章绘制可点击按钮 - 相反，绘制一个标签，上面写着“你喜欢这个！” 或类似的东西。

让你的客户端 jQuery 在回调中用这个标签替换按钮，而不是仅仅删除点击处理程序——这会给你的用户一些反馈，表明他们的建议已被接受。

最后 - 确保对于没有 Javascript 的客户端，实际的按钮单击或表单提交是在服务器端处理的，他们的建议得到确认，并且当他们获得结果页面时，它会显示“我喜欢这个”而不是按钮。

请记住，您应该始终尝试使用 jQuery 等来增强您网站的基本行为；先让它在没有任何 AJAX 的情况下工作，然后再添加花里胡哨。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T10:36:59.770

我会检查服务器端以查看该文章是否已被推荐，并将适当的类/ID 发送到视图，并具有一个 jquery 功能来禁用任何具有已取消类/ID 的按钮。

# c# - linq 中的“选择新”是否会触发评估/加载？

> ID：810879
> 
> 赞同：1
> 
> 时间：2009-05-01T10:13:28.017
> 
> 标签：c#, linq, ienumerable, yield, fluent-interface

我目前正在尝试创建一个实现的类，`IEnumerable<T>`以便从通过 ParentId 属性相互引用的对象的平面列表构造层次结构。我想为此编写一个流畅的界面，这样我就可以做这样的事情

```
IEnumerable<Tab> tabs = GetTabs();

IEnumerable<TabNode> tabNodes = tabs.AsHierarchy().WithStartLevel(2).WithMaxDepth(5); 
```

所以，关于 yield 语句，我想知道我是否可以在课堂上做这样的事情`NodeHierarchy : IEnumerable<TabNode>`：

```
private IEnumerable<TabNode> _nodes;

public NodeHierarchy(IEnumerable<Tab> tabs)
{
    _nodes = CreateHierarchy(tabs);
}

public IEnumerable<TabNode> CreateHierarchy(IEnumerable<Tab> tabs)
{
    /* About this block: I'm trying to find the top level 
    nodes of the first tab collection, maybe this is done poorly? */
    var tabIds = tabs.Select(t => t.TabID);
    IEnumerable<TabNode> nodes = from tab in tabs
                             where !tabIds.Contains(tab.ParentId)
                                 select new TabNode {
                                            Tab = node,
                                            ChildNodes = CreateHierarchy(tabs, node.TabID, 1),
                                            Depth = 1 };
    return nodes;
} 
```

或者我是否必须做这样的事情：

```
private IEnumerable<TabNode> _nodes;

public NodeHierarchy(IEnumerable<Tab> tabs)
{
    _nodes = CreateHierarchy(tabs);
}

public IEnumerable<TabNode> CreateHierarchy(IEnumerable<Tab> tabs)
{
var tabIds = tabs.Select(t => t.TabID);
IEnumerable<Tab> startingNodes = from tab in tabs
                                 where !tabIds.Contains(tab.ParentId)
                                 select tab;

foreach(Tab node in startingNodes)
{
    yield return
    new TabNode()
        {
        Tab = node,
        ChildNodes = CreateHierarchy(tabs, node.TabID, 1),
        Depth = 1
    };
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T11:00:24.783

不，`select new`不会触发评估。这将映射到调用：

```
 .Select(tab => new TabNode {...}) 
```

请注意`Select`（至少对于 LINQ-to-Objects）本质上类似于：

```
public static IEnumerable<TDest> Select<TSource,TDest>(
    this IEnumerable<TSource> source,
    Func<TSource,TDest> selector)
{
    foreach(TSource item in source)
    {
        yield return selector(source);
    }
} 
```

这里的关键点是它评估惰性 - 不是一次全部。

两种方法都应该具有可比性——唯一的区别是，如果没有`yield return`，*一些*代码将立即运行——但只有构建`.Where(...).Select(...)`链的代码——它实际上不会处理行，直到你开始迭代结果。

此外，根据数据源的不同，这种方法实际上可能更有效——例如，使用 LINQ-to-SQL 后端，因为 TSQL 生成器可以跳过不必要的列。

# data-structures - 空二叉搜索树是否有效？

> ID：810881
> 
> 赞同：9
> 
> 时间：2009-05-01T10:14:25.283
> 
> 标签：data-structures, binary-tree

我有两个关于二叉搜索树的问题，都是关于空树的。

1.  空树（null）是否有效？
2.  没有子节点的根节点是否有效？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-01T10:18:01.140

是的，是的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T10:17:51.827

究竟什么是空树当然取决于您的实现，“有效”一词的含义也是如此，但总的来说，我会对这两个问题都说“是”。空树表示您感兴趣的实体集为空的情况，单个节点表示该集合包含一个实体的情况。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T10:20:16.737

没有子节点的单个节点当然是有效的，并且根据[二叉树结构](http://cnx.org/content/m17289/latest/)：

> （可变）二叉树 BiTree 可以处于空状态或非空状态：
> 
> *   当它为空时，它不包含任何数据。
> *   当它不为空时，它包含一个称为根元素的数据对象，以及称为左子树和右子树的 2 个不同的 BiTree 对象。

为了完整起见，此[Wikipedia 条目](http://en.wikipedia.org/wiki/Binary_tree)是对术语等的非常有用的总结。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T10:19:51.107

> 空树（null）是否有效？

如果它是空的，就没有树。因此，有效性问题不会出现。

> 没有子节点的根节点是否有效？

是的。那是一个只有一个元素的 T 恤。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T10:36:34.387

我认为您将苹果和橙子混合在一起：

1.  `null`在某些编程语言中是一个值，它与数据结构实现的具体表示有关
2.  “空”是我们称之为“二叉搜索树”的抽象数据结构的一个属性

现在，一棵树是一个有序集合：不多也不少。当然，集合可以是空的！这意味着，在您的**实现**中，类似于：

```
MyTree tree = null 
```

代表一棵空树？好吧，这取决于您的型号。例如，您可以认为空子树应该由一个没有值的节点表示，并且对叶子的引用无效：在该模型中，`null`从逻辑角度来看，指针是没有意义的。但这只是**一种**方法！基于哨兵的方法是一种编程的乐趣，但它的内存扩展：然后你可以用空节点建模空节点。在这种情况下，`null`指针可以是一棵空树。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-30T20:06:48.253

二叉树可以递归定义为：

```
A single node with either no children, or with two children - 
each of which is a binary tree. 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-02T12:30:46.160

是的，这两个条件都成立。对于二叉树，每个节点可以有零个、一个或两个子节点。如果一棵树只有一个根节点而没有其他节点，则称为 NULL 树。

# visual-studio - Visual Studio 2008 新网站总是创建一个解决方案文件夹

> ID：810884
> 
> 赞同：1
> 
> 时间：2009-05-01T10:15:42.287
> 
> 标签：visual-studio

每次我在 VS 中创建一个新的网站项目时，它都会为解决方案文件创建另一个文件夹。

\网站名称\ \网站名称（2）\

在我的 VS 解决方案资源管理器中，它只显示为一个网站项目，上面没有解决方案文件。当我想要一个网站时，有没有办法可以停止 VS 创建解决方案文件？还是 VS 需要的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T11:17:08.440

不创建解决方案文件夹的选项仅在使用新建项目时可用。新网站始终假定您需要一个解决方案文件夹并且设计正常工作。如果您不想要该文件夹，请使用新项目。

然而，Visual Studio 总是需要一个解决方案文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T10:43:50.267

是的，它总是需要一个 SLN 文件。即使不使用。如果您打开一个项目文件，它将创建一个空白/临时容器解决方案。

# c# - 确保用户上传的图片大小不超过 1MB 的最佳方法

> ID：810886
> 
> 赞同：3
> 
> 时间：2009-05-01T10:16:48.070
> 
> 标签：c#, asp.net, vb.net, image, file-upload

我将 ASP.net 与 VB.NET 一起使用。是否有一些我可以使用的验证器来检查上传图像的大小？否则我必须在代码中做什么以确保用户不上传超过 1MB 的图像？

ps C# 代码也可以，我可以使用转换器到 VB.NET

**编辑**

出于某种原因，当我将 maxRequestLength 更改为 1024（在我的 WEB.config 中）并上传大小为 1.25mb 的图像时，我得到 Microsoft 错误页面，显示“Internet Explorer 无法显示网页”。我的提交按钮内确实有一个 Try Catch 块。如果我从我的 Web.config 中删除 maxRequestLength ，那么它可以正常工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T10:22:32.253

这最终在 Web.config 中处理。查找 httpRuntime 部分：

```
<httpRuntime 
 executionTimeout="110" 
 maxRequestLength="4096" 
/> 
```

httpRuntime 中还有许多其他设置，但这些是相关的两个。在这里，maxRequestLength 设置为 4096，即 4KB（数字以字节为单位）。因此，请相应地设置此值。此外，您还需要相应地设置 executionTimeout，以便它提供合理的时间来上传您最大上传的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T10:22:07.073

您可以使用以下代码来确定上传文件的大小 [以 KB 为单位]，一旦知道大小，您就可以轻松决定是继续处理文件还是拒绝上传。

```
Request.Files(0).ContentLength / 1024 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T14:47:03.340

无法显示网页错误是因为 ASP.NET 中断了超大请求的连接，以减轻基于超大请求的 DOS 攻击。为了解决这个问题，您必须在 iframe 中进行上传，然后检测是否发生错误。您还可以使用安装在客户端上的 flash、silverlight、java 或 activex 上传器组件来验证客户端的文件大小，但这需要根据您的解决方案进行安装。

# sql-server-2000 - 在全文搜索中细化结果

> ID：810887
> 
> 赞同：0
> 
> 时间：2009-05-01T10:17:27.367
> 
> 标签：sql-server-2000

我在搜索中使用freetexttable，但我没有得到确切的结果我怎样才能得到确切的结果....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T10:34:22.787

你为什么选择 freetexttable 而不是 containstable ？Freetexttable 忽略 ands，这意味着您可以获得更多结果。

# c++ - 从 C++ 中的默认浏览器读取 cookie

> ID：810894
> 
> 赞同：1
> 
> 时间：2009-05-01T10:19:27.970
> 
> 标签：c++, browser

我想创建一个与网站一起工作的 c++ 应用程序。为了使应用程序与网站保持同步，我希望能够从用户的默认浏览器中读取一些 cookie。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T10:25:28.190

不是一般意义上的——cookie 存储没有真正定义的格式，所以每个浏览器都可以自由地将 cookie 数据库保存在它喜欢的任何地方，以任何风格。

您可以为主流浏览器（IE、Firefox）实现 cookie 读取功能，但这会遗漏一些人。它也将是不可靠的——当用户清除他们的 cookie 缓存或使用多个浏览器时会发生什么？

如果您想让您的应用程序与网站保持同步，我建议您使用应用程序用户配置的用户名/标识符直接调用该网站上的 Web 服务（RESTful 等）。这样，您就不会被束缚在任意的第三者身上，这充其量只是“也许”正确。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T13:46:42.590

是的，相当琐碎。定义一个网络服务[http://example.com/capturecookie](http://example.com/capturecookie)？*跟踪指南*。它返回上次为该 GUID 发送的 cookie。从您的应用程序中，选择一个随机向导。首先在默认浏览器中使用您的随机 GUID 调用该 Web 服务（请参阅其他 SO 主题），然后在应用程序内部使用相同的 GUID。第二次，你会从第一次取回饼干。

请注意，“网络浏览器的 cookie”的确切概念必然是不精确的。例如，我的默认网络浏览器 (Opera) 设置为在存在时删除所有 cookie，但来自白名单站点的 cookie 除外。所以 example.com 是否有 cookie 在很大程度上取决于 Opera 是否正在运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T10:23:52.173

Firefox 将其所有 cookie 存储在 cookies.txt 中： [http ://www.velocityreviews.com/forums/t10844-cookies-in-firefox.html](http://www.velocityreviews.com/forums/t10844-cookies-in-firefox.html)

对于“默认浏览器”，您将不得不为不同浏览器的数量编写自定义代码，但这肯定是不可能的。请参阅：[http](http://www.aboutcookies.org/Default.aspx?page=2#ie7) ://www.aboutcookies.org/Default.aspx?page= 2#ie7 开始，然后开始搜索！

# wpf - DataGrid中的WPF图像绑定

> ID：810906
> 
> 赞同：3
> 
> 时间：2009-05-01T10:23:40.330
> 
> 标签：wpf, image, datagrid, binding

如何在 DataGrid 中绑定图像？

```
 <my:DataGrid.Columns>
            <my:DataGridTemplateColumn Header="状況写真" Width="100">
                <my:DataGridTemplateColumn.CellTemplate>
                    <DataTemplate>
                        <Image >
                       ??????????????????
                        </Image>
                    </DataTemplate>
                </my:DataGridTemplateColumn.CellTemplate>
            </my:DataGridTemplateColumn>
   </my:DataGrid.Columns> 
```

谢谢，维杰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T12:42:17.830

Image 从 Source 属性中获取其值，因此您需要绑定它。这是 ItemsControl 的示例。

```
<ItemsControl Name="imageList">
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <StackPanel></StackPanel>
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <!-- The Image binding -->
            <Image Source="{Binding Path=Value}" />
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

我使用以下代码来初始化 imageList 的项目源。

```
List<KeyValuePair<string, string>> images =
    new List<KeyValuePair<string, string>>()
    {
        new KeyValuePair<string,string>("Image1", @"D:\Photos\tn-35.jpg"),
        new KeyValuePair<string,string>("Image2", @"D:\Photos\tn-36.jpg"),
        new KeyValuePair<string,string>("Image3", @"D:\Photos\tn-37.jpg")
    };

imageList.ItemsSource = images; 
```

# asp.net-mvc - 微软 MVC

> ID：810909
> 
> 赞同：1
> 
> 时间：2009-05-01T10:24:19.347
> 
> 标签：asp.net-mvc, entity-framework

我已经非常接近使用实体框架和标准 asp.net+ajax 的网站完成了，但现在我正在考虑重新开始并使用 microsoft mvc 来完成它是否会更聪明。MVC 会成为新事物吗，我应该尝试实现它吗？MVC 在高流量站点上的表现如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T11:24:03.463

不要重新设计您已经完成开发或准备推出新技术的东西。而是完成项目并在修订版或全新站点中使用新技术。唯一应该考虑这种类型的重构是当业务需求发生变化并且新需求需要新功能时。

Mvc 是一个非常强大和稳定的平台，但它是开发人员的选择。业务需求将定义要使用的解决方案的类型。这是正确工作的正确工具的案例。

实际示例，我最近不得不做出选择，但是由于项目完成后缺乏维护支持技能，并且为此目的创建了对单个资源的依赖，因此业务拒绝了使用 Mvc 的选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T10:27:42.303

如果你快完成了，我看不出重新实现的意义。为什么不为您的下一个网站存储它然后尝试呢？Stack Overflow 也是使用 ASP.Net MVC 实现的 - 性能令人难以置信，并且它们获得了大量流量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T12:54:39.830

评估一下你考虑重做所有辛勤工作的原因，你就会得到答案。

*   该网站是为您自己的学习目的而完成的项目吗？如果是这样，那么在 MVC 中重做站点是一种选择，只要您愿意放弃已经完成的大量工作。

*   网站的建设是否需要有人付出代价？如果是这样，您绝对不应该在此阶段重做 MVC 中的站点，因为您将不必要地重新设置项目。

请记住，当涉及财务时，回溯和重做已经完成的事情，只是为了让您有机会使用您更喜欢的技术，最好附上合理的商业案例。在大多数情况下，客户不会关心您使用什么技术，他们会关心完成它需要多长时间以及他们将不得不花费多少。因此，您的决定应该基于他们的需求，而不是您的需求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T10:30:04.717

就我个人而言，我建议使用 MVC，因为它更直观，并且与 Web 表单相比，您可以更好地控制页面。

如果您是 MVC 新手，我不建议您重新开始使用 MVC，因为学习曲线可能有点陡峭！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T10:40:39.683

如果您正在谈论的网站是您打算在世界上发布的公共网站，那么我建议您完成您正在做的事情，发布它，并在您决定将其丢弃之前在该网站上获得用户反馈，然后重新实现它。如果这只是一个爱好网站，那么扔掉它就可以了。

但是，毫无疑问，ASP.NET MVC 是更好的选择，您应该将其用作所有未来开发的默认选项。

正如其他回复中提到的，SO 正在使用 ASP.NET MVC。

我不认为 ASP.NET MVC 会妨碍您满足规模要求 - 在任何商业网站中，它通常是数据源（您的 SQL 数据库或您调用的网络服务），这将限制您处理的能力流量大。

我想这真的取决于你的使用模式，你要访问多少数据来构建页面，你的内容是否可以缓存，你是否有数百万用户只是在阅读页面，或者数百个用户正在更新数据等等将推动您的扩展能力，其中大多数与您用于呈现页面的框架正交。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T10:26:01.760

嗯，StackOverflow 使用 ASP.NET MVC，它是一个流量相当高的网站。我从来没有经历过 SO 的任何减速。因此，我认为 ASP.NET MVC 没有任何主要的固有性能限制。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T11:51:20.120

MVC 很不错，我们从第一个 CTP 开始就一直在使用它。但是如果你只是盲目地遵循 MVC 博客/教程，就会出现性能问题。

看看[这个](http://blog.whiletrue.com/2009/04/aspnet-mvc-performance/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-01T12:15:54.570

如果你已经完成了很多 UI 层，只要你有时间学习新技术，就坚持使用 Web 表单，MVC 不会让你失望

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-01T12:25:12.753

**正如大多数人所说，如果您几乎完成了当前站点，请继续原样。**

对于您的下一个项目，我强烈建议您坐下来学习 MVC。一旦你进行了切换，不同的层次将变得非常清晰、清晰，因此更加简洁（希望如此）。

因此，如果您需要返回并在以前的站点上工作，如果不太困难，您可能会决定在 MVC 中重新实现它们。您对代码中发生的事情的完全控制非常棒。如果您不喜欢使用 VB 或 C#，您甚至可以扩展并使用[IronRuby](http://www.ironruby.net/)和[IronPython](http://www.codeplex.com/IronPython)，并在此过程中学习一些新语言。更不用说 MVC 是完全可扩展的并且（现在）是开源的。如果您想了解利弊，请查看此[问题](https://stackoverflow.com/questions/30067/should-i-migrate-to-asp-net-mvc)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-01T12:46:23.063

另一种选择是在 WebForms 和 MVC 中创建站点的一部分。据我所知，没有什么可以阻止你这样做。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-01T22:31:18.990

我已经说过了，我会再说一遍。:) 我最近将一个几乎完成的项目重新创建为 mvc 而不是 asp.net。我花了一周的时间才准备好，但客户对结果非常满意！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-09-14T08:48:06.180

（[https://msdn.microsoft.com/en-us/library/dd381412(v=vs.98).aspx](https://msdn.microsoft.com/en-us/library/dd381412(v=vs.98).aspx)）

## **何时创建 MVC 应用程序**

您必须仔细考虑是否使用 ASP.NET MVC 框架或 ASP.NET Web 窗体模型来实现 Web 应用程序。MVC 框架不会取代 Web 窗体模型；您可以将任一框架用于 Web 应用程序。（如果您有现有的基于 Web 窗体的应用程序，这些应用程序将继续像往常一样工作。）在您决定为特定网站使用 MVC 框架或 Web 窗体模型之前，请权衡每种方法的优点。

**基于 MVC 的 Web 应用程序的优点**

ASP.NET MVC 框架具有以下优点：

*   通过将应用程序划分为模型、视图和控制器，可以更轻松地管理复杂性。
*   它不使用视图状态或基于服务器的表单。这使得 MVC 框架非常适合希望完全控制应用程序行为的开发人员。
*   它使用前端控制器模式，
    通过单个控制器处理 Web 应用程序请求。这使您能够设计一个
    支持丰富路由基础设施的应用程序。有关详细
    信息，请参阅前端控制器。
*   它为测试驱动开发（TDD）提供了更好的支持。
*   它适用于由大型开发团队支持的 Web 应用程序以及需要对应用程序行为进行高度控制的 Web 设计人员。

**基于 Web 表单的 Web 应用程序的优点**

基于 Web 表单的框架具有以下优点：

*   它支持通过 HTTP 保存状态的事件模型，这有利于业务线 Web 应用程序开发。基于 Web 窗体的应用程序提供了数百个服务器控件支持的数十个事件。
*   它使用页面控制器模式，将功能添加到各个页面。有关详细信息，请参阅页面控制器。
*   它在基于服务器的表单上使用视图状态，这样可以更轻松地管理状态信息。
*   它适用于希望利用大量可用组件进行快速应用程序开发的小型 Web 开发人员和设计人员团队。
*   一般来说，应用程序开发不太复杂，因为组件（页面类、控件等）是紧密集成的，并且通常比 MVC 模型需要更少的代码。

# oracle - if 语句中的标量子查询 PL/SQL 中的条件

> ID：810919
> 
> 赞同：3
> 
> 时间：2009-05-01T10:29:16.217
> 
> 标签：oracle, plsql, conditional, scalar-subquery

我有一个类似于下面的 If 语句块，它因错误而失败 - PLS-00103：在期望以下之一时遇到符号“SELECT”....

```
Begin
    If (select count(*) from Table1) > 0 then
        dbms_output.put_line('Test');
    end if;
end; 
```

我有类似的案例陈述，效果很好

```
select 
case 
    when (select count(*) from Table1) > 0
        then 2
    else
        1
end
from dual 
```

从我在 Oracle 文档中读到的 if 和 when 支持布尔表达式，如果条件中是否支持子查询的任何想法。

**注意：**语句已经被简化了，我不是真的要得到整个表的计数，所以请不要优化建议

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T11:54:55.353

不，您不能以您想要的方式使用 SELECT。

在您使用 CASE 的示例中，您没有使用 CASE “语句”——您使用的是 CASE**表达式**，它恰好嵌入在 SQL 语句中。在这种情况下，您可以使用子查询，因为它在 SQL 语句的上下文中，而不是在过程语句中。您将无法在过程 CASE 语句中使用这样的子查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T10:46:27.640

你有没有打电话给 DBMS_OUTPUT.ENABLE

快速示例

```
BEGIN
DBMS_OUTPUT.DISABLE;
DBMS_OUTPUT.PUT_LINE('Disabled');
DBMS_OUTPUT.ENABLE;
DBMS_OUTPUT.PUT_LINE('Enabled');
END; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T11:24:09.407

我不相信 IF 条件支持子查询... PL/SQL 期望 SELECT 给它一组记录，而不是在表达式/语句中使用的单个值。

# java - 柔性 ：： 在我的 flex 项目中不能正常工作？

> ID：810921
> 
> 赞同：0
> 
> 时间：2009-05-01T10:30:01.533
> 
> 标签：java, apache-flex, flash, actionscript-3, air

我用了：

```
 <mx:Transition fromState="*" toState="">
                                         //universal_title name for TitleWindow id another stage .loginform is panel id another winidow        
             <mx:Sequence targets="{[Universal_title,loginform]}">

            <mx:Sequence id="sequence1" filter="show" >
                <mx:WipeUp/>
                  <mx:Resize duration="500" easingFunction="Bounce.easeOut"/>
                <mx:SetPropertyAction name="visible" value="true"/>

            </mx:Sequence>

            <mx:Move filter="move"/>
            <mx:Sequence id="sequence2" filter="show" >
                <mx:SetPropertyAction name="visible" value="true"/>
                <mx:WipeUp/>
            </mx:Sequence>
        </mx:Sequence>
    </mx:Transition>
        </mx:transitions> 
```

但不显示动画。我在代码中做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T14:57:13.140

看起来有很多事情可能会出错。首先，你的 toState 绝对是一个空字符串，还是你的意思是 toState="*"？对于您的目标，我会确保 Universal_title 是正确的名称 - 您的 mx:Move 标记不会做任何事情，它需要某种 to / from 值（[http://livedocs.adobe.com/flex/ 2/langref/mx/effects/Move.html](http://livedocs.adobe.com/flex/2/langref/mx/effects/Move.html)）并且可能还有一些其他错误，但这只是快速浏览。

# java - Java 将走向何方？

> ID：810923
> 
> 赞同：5
> 
> 时间：2009-05-01T10:30:46.757
> 
> 标签：java, programming-languages

我是一位经验丰富的 Java 程序员，在过去的两年中，我一直在 C# 和 Javascript 中进行必要的编程。现在使用这两种语言，我使用了一些有趣的特性，比如闭包和匿名函数（实际上我已经使用了指针函数），并且我非常欣赏代码变得更清晰和我的风格更高效的方式。实际上，事件管理（事件委托模式）也比 Java 使用的更清晰......

现在，在我看来，Java 似乎不像过去那么具有创新性了……但为什么呢？

C# 正在发展（具有许多新功能），C++0x 正在发展（它将支持 lambda 表达式、闭包和许多新功能），我很沮丧在花了很多时间进行 Java 编程之后在没有任何好的解释的情况下衰减，JDK 7 在语言特性上没有任何创新（是的，它将优化 GC、编译器等），但语言本身几乎没有重要的进化变化。

那么，未来会如何呢？我们怎么还能相信 Java？高斯林，你在哪里？？？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-01T10:37:44.823

C 多年来没有太大变化，但它仍然是最流行的语言之一。我不相信 Java 必须添加语法糖来保持相关性。相信我，Java 已经存在很长时间了。对 Java 来说更好的是具体化的泛型。

您不必相信Java，如果您不喜欢它，请选择另一种语言，有很多。Java 的生存与否取决于商业利益，以及能否实现商业目标。不在于它是否酷。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-01T10:39:21.590

我认为您正在经历大多数 Java 程序员尝试 C# 体验的经典幻灭阶段。我重拾对 java 的信心，原因很简单，尽管语言没有太大变化，但*作为*一个生态系统，java 发生了很多变化。我很想*拥有*闭包和正确的方法类型，但最终我还是过得去。Java 的纯粹活力仍然胜过 C#，尽管在语言级别上并没有发生太多事情。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-01T10:51:32.370

如果您希望 Java*平台*的工具集不受 Java*语言*的限制，那么您绝对应该看看一些下一代 JVM 语言。Groovy、Scala 和 Clojure 在许多领域都获得了发展势头（例如，Twitter 是用 Scala 编写的）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-01T11:29:38.177

我可能不如一些发表评论的程序员的一半，但以我目前的智力水平，这就是我的想法 -

如果一种语言使编程更容易/富有表现力/更简洁，那不是一件好事吗？语言的进化不是好事吗？

如果 C、C++ 是优秀的语言，因为它们已经使用了几十年，那么为什么 Java 变得如此流行？我想那是因为 Java 帮助摆脱了一些恼人的问题并降低了维护成本。现在有多少大型应用程序是用 C++ 编写的，有多少是用 Java 编写的？

我怀疑不改变某事的论点是否比有充分理由改变某事更好。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-01T10:35:43.657

你可以看看这个：

[**Sun 会迈向“Java 3”吗？[关闭]**](https://stackoverflow.com/questions/683633/will-sun-ever-make-the-step-to-java-3-closed)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-01T10:41:21.850

我认为至少有一些创新来自同样运行在同一个 JVM 上的其他类似脚本的语言，然后你有 Java 作为主干，以及各种语言中的其他很酷的新特性来制作所有的花里胡哨。

此外，如果一种语言不断变化，它就无法真正做出标记——在 C 和 C++ 上进行了多少剧烈的变化以及多久进行一次？

成熟的语言也是稳定的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-01T10:53:33.317

查看[Java 7 提案](http://openjdk.java.net/projects/jdk7/features/)，特别是[Project coin](http://blogs.oracle.com/darcy/entry/project_coin_call_for_proposals)工作（语言更改）。后者包含了更好的集合初始化、泛型类型推断等。

当然，重要的是要考虑*平台*Java 以及语言 Java。Scala / Groovy / Clojure 等语言正在取得更多进展，（当然）这些可以利用可用的 Java 库。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-01T10:38:20.187

我听过 Gosling 关于这个问题的谈话，并且（我希望我不会过多地破坏他的信息）他说了一些类似的话......你可以并且应该在语言中投入多少，未来编程在于我们将使用的工具。

我倾向于同意他的观点，Java 所要求的许多特性都偏离了 OOP 的原则，但如果你发现它们对你有用，那么还有其他语言可以部署到 java 平台上，所以你的语言偏好应该能够与您对 Java 堆栈的知识共存。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-01T11:46:20.117

Java 似乎已经停滞了一段时间，但是在 JVM 上运行的其他语言中也有很多创新，例如 Scala 和 Clojure，我怀疑它们是未来所在。重要的不是 Java 语言，而是虚拟机……

话虽如此，对于一种不是移动目标的语言，还有很多话要说。尽管我很喜欢 C#，但似乎每年左右都会有一个新版本。尽管 Java 从 C# 中添加了一些特性（例如注释），但它没有与 C# 陷入语言“军备竞赛”，这很好。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-01T10:43:13.233

实际语言应该几乎被冻结，因为这也允许旧版本的 Java 也可以使用进度。我们有使用 Java 1.4（供应商支持）的客户。通过将进度和开发放入库中，它们也可用于这些场景。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-01T12:27:29.583

想想科博尔！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-01T12:01:14.700

Java 从来都不是“创新的”。它开始是一个残缺的、“对程序员友好”的 C++ 版本，然后开始慢慢地重新引入其他编程语言中已经存在很长时间的缺失特性。只是那些几十年前的“新奇事物”被破坏了，以使它们适应 JVM 的限制。

但也许我误解了你的“创新”概念。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-01T13:14:42.073

Java 目前仍然是排名第一的语言 :-)

[http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html](http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html)

# delphi - 可用于 Delphi 和 FreePascal 的单元测试/TDD 选项

> ID：810929
> 
> 赞同：2
> 
> 时间：2009-05-01T10:33:18.670
> 
> 标签：delphi, unit-testing, tdd, freepascal

我知道 Delphi win32 的 DUnit 的存在。

我所追求的是一个既适用于 Delphi 又适用于 FreePascal 的库。

如果这根本不可能，我真的很感激一个（Delphi）和另一个（FreePascal）的所有选项列表

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T11:45:04.863

FPCUnit是[freePascal](http://www.freepascal.org/docs-html/fpcunit.pdf)的 xUnit 实现，我不确定它是否与 DUnit 兼容，但我在 FPCfourms 阅读，他们正在改进以使其与 DUnit 兼容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T05:43:30.910

tigris.org 上的 utex。Delphi 单元测试专家是一个插件 Delphi 专家，用于为 Delphi 单元创建 ant 开发测试应用程序。（对不起，作为一个新用户，我不能直接放项目的链接）

# java - Hibernate @Version 字段错误

> ID：810935
> 
> 赞同：2
> 
> 时间：2009-05-01T10:35:36.760
> 
> 标签：java, hibernate

我正在为我的应用程序使用 hibernate、spring、struts 框架。

在我的应用程序中，每个表都有一个名为 Version 的字段，用于跟踪任何记录的更新。

每当我更新版本为 0 的 Country 表的现有记录时，它都可以正常工作并更新记录，将版本字段更新为 1。

但是，每当我尝试更新该版本 1 记录时，都会出现如下错误：

```
org.springframework.orm.hibernate3.HibernateOptimisticLockingFailureException: Object of class [com.sufalam.business.marketing.model.bean.Country] with identifier [3]: optimistic locking failed; nested exception is org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [com.company.business.marketing.model.bean.Country#3] 
```

有什么办法可以解决吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T15:57:33.650

Hibernate 的版本栏可以让你实现[乐观并发控制](http://en.wikipedia.org/wiki/Optimistic_concurrency_control)。

每次需要更新对象时，Hibernate 都会检查存储在数据库中的版本值是否与对象中的版本值相同。如果两者不同，则抛出 StaleObjectStateException，这意味着其他人在当前会话加载、编辑和存储它的同时更新了对象。

您必须确保对象中的版本值设置为正确的值。有时，如果您从会话中分离对象并重新附加它们（合并）值版本列设置不正确（例如，在从表单中检索值的 Web 应用程序中）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T12:58:39.490

“行已被另一个事务更新或删除”。上次我收到这个时，我正在做的事情分布在多个 org.hibernate.Session 对象上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T07:14:21.260

我不记得确切但你应该挂在你保存的实例上吗？至少在使用 JPA 时，merge 方法有一个返回值。

# excel - 向 Excel COM 插件添加功能区支持

> ID：810950
> 
> 赞同：0
> 
> 时间：2009-05-01T10:42:06.420
> 
> 标签：excel, com, ribbon, add-in

我有一个用 C# (Visual Studio 2005) 编写的 MS Office COM 插件并使用 COM Shim dll。该插件不使用 VSTO 技术并支持 Excel XP 及更高版本。该插件添加了一个新的工具栏和一个菜单。

该插件在 Excel 2007 中运行良好，但它与工具栏和菜单一起显示在名为“插件”的单独选项卡中。我想将此插件与 Excel 2007 功能区工具栏集成，并创建一个带有组和按钮的新选项卡。

我浏览了许多文章，发现 IRibbonExtensibility 是用于支持 Ribbon 的接口。此外，COM Shim Wizards 有一个支持功能区界面的新版本 2.3。

**我想知道它是否可以完成以及项目中需要进行的更改。**

1.  目前，项目中使用的是OfficeXP 的office.dll 文件（v 7.0）。但 IRibbonExtensibility 接口位于 Office 2007 的 dll (v12) 中。所以我认为我需要做的第一件事就是更改这个 dll 并更新代码中的所有引用。这个 dll 是否支持以前的版本（向后兼容）？我不想破坏现有的功能。
2.  COM Shim dll 会发生什么变化？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T08:15:07.080

我没有使用过 OfficeXP，但是针对 2000、2003 和 2007 构建了 COM 插件。

我最近使用 IRibbonExtensibility 接口为 Office 2007 构建了一个 COM 插件，并引用了 v12 PIA。

当我将它与 Office 2003 一起使用时，我发现它运行良好。但是，我的插件仅提供一些非常基本的功能，并没有对 Excel 对象进行多次调用。我调整了 OnConnection 方法以仅在 Applicaiton.Version 小于 12 时设置 CommandBars。

我记得没有任何代码更改需要从 2003 PIA 切换到 2007 PIA。过去发现您可以轻松地在不同版本的 PIA 之间切换。

詹姆士

# c++ - std::sort 和 std::stable_sort 在实践中的性能差距有多大？

> ID：810951
> 
> 赞同：26
> 
> 时间：2009-05-01T10:42:51.783
> 
> 标签：c++, sorting, stl

两者都应该在 O(n log n) 中运行，但通常排序比 stable_sort 快。实践中的性能差距有多大？你有这方面的经验吗？

我想对大量大小约为 20 字节的结构进行排序。在我的情况下，结果的稳定性会很好，但这不是必须的。目前底层容器是一个普通数组，也许稍后可以将其更改为 std::deque 。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2016-01-08T02:19:30.057

从理论上比较算法有很好的答案。出于好奇，我使用[google/benchmark](http://github.com/google/benchmark)`std::sort`进行了基准测试。`std::stable_sort`

提前指出是有用的；

*   基准机有`1 X 2500 MHz CPU`和`1 GB RAM`
*   基准操作系统`Arch Linux 2015.08 x86-64`
*   `g++ 5.3.0`使用and `clang++ 3.7.0`( `-std=c++11`, `-O3`and `-pthread`)编译的基准
*   `BM_Base*`benchmark 尝试测量填充时间`std::vector<>`。应该从排序结果中减去该时间以便更好地进行比较。

第一个基准按`std::vector<int>`大小`512k`排序。

```
[ g++ ]# benchmark_sorts --benchmark_repetitions=10
Run on (1 X 2500 MHz CPU )
2016-01-08 01:37:43
Benchmark                         Time(ns)    CPU(ns) Iterations
----------------------------------------------------------------
...
BM_BaseInt/512k_mean              24730499   24726189         28
BM_BaseInt/512k_stddev              293107     310668          0
...
BM_SortInt/512k_mean              70967679   70799990         10
BM_SortInt/512k_stddev             1300811    1301295          0
...
BM_StableSortInt/512k_mean        73487904   73481467          9
BM_StableSortInt/512k_stddev        979966     925172          0 
```

```
[ clang++ ]# benchmark_sorts --benchmark_repetitions=10
Run on (1 X 2500 MHz CPU )
2016-01-08 01:39:07
Benchmark                         Time(ns)    CPU(ns) Iterations
----------------------------------------------------------------
...
BM_BaseInt/512k_mean              26198558   26197526         27
BM_BaseInt/512k_stddev              320971     348314          0
...
BM_SortInt/512k_mean              70648019   70666660         10
BM_SortInt/512k_stddev             2030727    2033062          0
...
BM_StableSortInt/512k_mean        82004375   81999989          9
BM_StableSortInt/512k_stddev        197309     181453          0 
```

第二个基准按`std::vector<S>`大小`512k`( `sizeof(Struct S) = 20`) 排序。

```
[ g++ ]# benchmark_sorts --benchmark_repetitions=10
Run on (1 X 2500 MHz CPU )
2016-01-08 01:49:32
Benchmark                         Time(ns)    CPU(ns) Iterations
----------------------------------------------------------------
...
BM_BaseStruct/512k_mean           26485063   26410254         26
BM_BaseStruct/512k_stddev           270355     128200          0
...
BM_SortStruct/512k_mean           81844178   81833325          8
BM_SortStruct/512k_stddev           240868     204088          0
...
BM_StableSortStruct/512k_mean    106945879  106857114          7
BM_StableSortStruct/512k_stddev   10446119   10341548          0 
```

```
[ clang++ ]# benchmark_sorts --benchmark_repetitions=10
Run on (1 X 2500 MHz CPU )
2016-01-08 01:53:01
Benchmark                         Time(ns)    CPU(ns) Iterations
----------------------------------------------------------------
...
BM_BaseStruct/512k_mean           27327329   27280000         25
BM_BaseStruct/512k_stddev           488318     333059          0 
...
BM_SortStruct/512k_mean           78611207   78407400          9
BM_SortStruct/512k_stddev           690207     372230          0 
...
BM_StableSortStruct/512k_mean    109477231  109333325          8
BM_StableSortStruct/512k_stddev   11697084   11506626          0 
```

任何喜欢运行基准测试的人，这里是代码，

```
#include <vector>
#include <random>
#include <algorithm>

#include "benchmark/benchmark_api.h"

#define SIZE 1024 << 9

static void BM_BaseInt(benchmark::State &state) {
  std::random_device rd;
  std::mt19937 mt(rd());
  std::uniform_int_distribution<int> dist;

  while (state.KeepRunning()) {
    std::vector<int> v;
    v.reserve(state.range_x());
    for (int i = 0; i < state.range_x(); i++) {
      v.push_back(dist(mt));
    }
  }
}
BENCHMARK(BM_BaseInt)->Arg(SIZE);

static void BM_SortInt(benchmark::State &state) {
  std::random_device rd;
  std::mt19937 mt(rd());
  std::uniform_int_distribution<int> dist;

  while (state.KeepRunning()) {
    std::vector<int> v;
    v.reserve(state.range_x());
    for (int i = 0; i < state.range_x(); i++) {
      v.push_back(dist(mt));
    }

    std::sort(v.begin(), v.end());
  }
}
BENCHMARK(BM_SortInt)->Arg(SIZE);

static void BM_StableSortInt(benchmark::State &state) {
  std::random_device rd;
  std::mt19937 mt(rd());
  std::uniform_int_distribution<int> dist;

  while (state.KeepRunning()) {
    std::vector<int> v;
    v.reserve(state.range_x());
    for (int i = 0; i < state.range_x(); i++) {
      v.push_back(dist(mt));
    }

    std::stable_sort(v.begin(), v.end());
  }
}
BENCHMARK(BM_StableSortInt)->Arg(SIZE);

struct S {
  int key;
  int arr[4];
};

static void BM_BaseStruct(benchmark::State &state) {
  std::random_device rd;
  std::mt19937 mt(rd());
  std::uniform_int_distribution<int> dist;

  while (state.KeepRunning()) {
    std::vector<S> v;
    v.reserve(state.range_x());
    for (int i = 0; i < state.range_x(); i++) {
      v.push_back({dist(mt)});
    }
  }
}
BENCHMARK(BM_BaseStruct)->Arg(SIZE);

static void BM_SortStruct(benchmark::State &state) {
  std::random_device rd;
  std::mt19937 mt(rd());
  std::uniform_int_distribution<int> dist;

  while (state.KeepRunning()) {
    std::vector<S> v;
    v.reserve(state.range_x());
    for (int i = 0; i < state.range_x(); i++) {
      v.push_back({dist(mt)});
    }

    std::sort(v.begin(), v.end(),
              [](const S &a, const S &b) { return a.key < b.key; });
  }
}
BENCHMARK(BM_SortStruct)->Arg(SIZE);

static void BM_StableSortStruct(benchmark::State &state) {
  std::random_device rd;
  std::mt19937 mt(rd());
  std::uniform_int_distribution<int> dist;

  while (state.KeepRunning()) {
    std::vector<S> v;
    v.reserve(state.range_x());
    for (int i = 0; i < state.range_x(); i++) {
      v.push_back({dist(mt)});
    }

    std::stable_sort(v.begin(), v.end(),
                     [](const S &a, const S &b) { return a.key < b.key; });
  }
}
BENCHMARK(BM_StableSortStruct)->Arg(SIZE);

BENCHMARK_MAIN(); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-01T11:07:05.313

[`std::stable_sort`](http://en.cppreference.com/w/cpp/algorithm/stable_sort)当有足够的内存可用时执行 NlogN 比较。当可用内存不足时，它会降级为 N((logN)^2) 次比较。[`std::sort`](http://en.cppreference.com/w/cpp/algorithm/sort)因此，当内存可用时，它的效率与（在平均和最坏情况下执行 O(NlogN) 比较）大致相同。

对于那些感兴趣的人， sort() 使用一个[introsort](http://en.wikipedia.org/wiki/Introsort)（快速排序，当递归达到一定深度时切换到堆排序），而 stable_sort() 使用一个[合并排序](http://en.wikipedia.org/wiki/Merge_sort)。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-01T11:05:51.260

大到足以保证一个单独的函数可以进行稳定的排序并且没有`std::sort()`透明地进行排序。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-05-01T12:10:56.940

有时需要 std::stable_sort() ，因为它保持相等元素的顺序。

传统的建议是，如果维护顺序不重要，则应改为使用 std::sort() 。

但是，它取决于上下文。即使您不需要维护顺序，也有很多数据最好使用稳定排序进行排序：

如果数据的枢轴点一直很差，快速排序很快就会变成最差的性能。

[Burrows-Wheeler 变换](http://en.wikipedia.org/wiki/Burrows-Wheeler_transform)是一种用作数据压缩一部分的算法，例如[bzip2](http://en.wikipedia.org/wiki/Bzip2)。它需要对文本的所有旋转进行排序。对于大多数文本数据，归并排序（通常由 std::stable_sort() 使用）比快速排序（通常由 std::sort() 使用）快得多。

[bbb](http://cs.fit.edu/~mmahoney/compression/bbb.cpp)是一个 BWT 实现，它指出了 std::stable_sort() 相对于 sort() 的优势。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-01T11:36:03.933

> 实践中的性能差距有多大？你有这方面的经验吗？

是的，但它并没有像你期望的那样发展。

我采用了 Burrows-Wheeler 变换的 C 实现并对其进行了 C++ 化。结果比 C 代码慢很多（尽管代码更干净）。所以我把计时工具放在那里，看起来 qsort 的执行速度比 std::sort 快。这是在 VC6 中运行的。然后用 stable_sort 重新编译，测试运行速度比 C 版本快。其他优化设法使 C++ 版本比 C 版本快约 25%。我认为可以提高速度，但代码的清晰度正在消失。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-09-06T09:16:07.890

正在寻找类似的东西 - 但很惊讶没有人谈论辅助空间。

我相信 - stable_sort 和 sort 的实现应该保证所有（最佳、平均和最差）情况的 O(NlogN)。

但是，使用的辅助空间存在差异。stable_sort 需要 O(N) 的辅助空间。

可能是性能上的差异在于获得了那个空间。:)
否则，理论上 - 它们应该具有相同的性能。

除非您需要，否则 sort 应该做您需要的 -> stable_sort 保留具有等效值的元素的相对顺序。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-07-01T11:40:46.670

如果您对大量结构进行排序，则内存/磁盘的 IO 速度开始变得比渐近运行时间更重要。此外，还应考虑内存使用情况。

我在 2Gb 的数据（64B 结构）上尝试了 std::stable_sort，但不知道 std::stable_sort 创建了数据的内部副本。随后的交换垃圾几乎锁定了我的电脑。

使用不稳定的 std::sort 可以将内存使用量减少 2 倍，这在对大型数组进行排序时很有用。我终止了 std::stable_sort，所以我无法确定它慢了多少。但是，如果不需要稳定排序，那么我认为最好使用不稳定的std::sort。

# java - 不同语言的 Java 字母表

> ID：810954
> 
> 赞同：2
> 
> 时间：2009-05-01T10:43:23.077
> 
> 标签：java, string, localization

如何确定 String 是否仅包含字母并且我想要的只是 [a-zA-Z]+，那么有什么方法可以通过 Locale 确定字母吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T11:03:32.403

该类[`Character`](http://java.sun.com/javase/6/docs/api/java/lang/Character.html)具有诸如[`isLetter`](http://java.sun.com/javase/6/docs/api/java/lang/Character.html#isLetter(char))能够确定字符是否为该方法的 API 规范中定义的字母的方法。

还有另一种使用[`Character.UnicodeBlock`](http://java.sun.com/javase/6/docs/api/java/lang/Character.UnicodeBlock.html)类的方法，它能够返回字符是否在[Unicode](http://www.google.com/url?sa=t&source=web&ct=res&cd=3&url=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FUnicode&ei=btX6ScaQE9SSkAXds4nrBA&rct=j&q=unicode&usg=AFQjCNH4Pwv5L_jFFLS8yq6_BTq8cXTLKw)的特定字符块中。

例如，我必须确定一个字符是否是全角[片假名](http://en.wikipedia.org/wiki/Katakana)字符，为了能够做到这一点，我必须使用以下[`Character.UnicodeBlock.of`](http://java.sun.com/javase/6/docs/api/java/lang/Character.UnicodeBlock.html#of(char))方法：

```
boolean isKatakana = 
    Character.UnicodeBlock.of(c) == Character.UnicodeBlock.KATAKANA; 
```

`String`还要补充一点，使用该方法可以检索a的某个索引处的字符，该[`charAt(int)`](http://java.sun.com/javase/6/docs/api/java/lang/String.html#charAt(int))方法可以检索Unicode码位[`codePointAt(int)`](http://java.sun.com/javase/6/docs/api/java/lang/String.html#codePointAt(int))。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-21T16:56:50.730

另外看看 com.ibm.icu.text 包。例如，此代码段返回定义语言的所有字母：

```
ULocale ulocale = com.ibm.icu.util.ULocale
    .forLocale(Locale.forLanguageTag(language));
UnicodeSet set = LocaleData.getExemplarSet(ulocale, LocaleData.ES_STANDARD);
Iterator<String> iterator = set.iterator();
StringBuffer buf = new StringBuffer();
while (iterator.hasNext()) {
  buf.append(iterator.next());

}
return buf.toString(); 
```

此任务无法通过 java.* 包完成。

# web-services - Web 服务的文档标准/结构/样式

> ID：810956
> 
> 赞同：1
> 
> 时间：2009-05-01T10:43:59.567
> 
> 标签：web-services, documentation, standards

任何人都可以推荐 Web 服务的高级文档指南吗？

该文档应该允许不了解特定 Web 服务的人对其存在的原因、路线图和使用示例有基本的了解。

此类文档应适合 A4/Letter 纸的两个印刷面，阅读时间不超过 10 分钟。

请注意，这是对开发人员用来使用接口的低级 API 文档的补充。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T11:12:05.440

我不确定我是否有指导方针，但我可以向您展示一个我发现是 Web 服务 API 的一组很好的文档的示例。

[http://www.flickr.com/services/api/](http://www.flickr.com/services/api/)

Flickr API 页面以非常易读的形式列出。这个页面基本上有：

*   链接到概述页面
*   常见场景的写法（本例上传照片）
*   有关使用 API 的工具的信息
*   每个 API 方法的详细描述，按活动分组

特别是，描述常见访问模式（上传照片、替换照片）的页面对我来说至关重要。它们向 API 的使用者展示了如何做常见的事情，以及您希望人们如何使用您的 API。最后一点很重要——你想说“嘿，我们希望你这样打电话给我们，使用这些方法，并进行这种错误处理”。向您的用户展示一些有关 API 使用的最佳实践，您将节省大量的支持电话。

# sql - 在一个查询中从同一个表中返回两条不同记录的部分

> ID：810958
> 
> 赞同：1
> 
> 时间：2009-05-01T10:45:04.040
> 
> 标签：sql, ms-access

虽然实际的模式有点复杂，但以下内容对我来说应该更容易理解。

在一张表中，我有一份工作清单：

```
工作状态 开放日期 关闭日期
1 关闭 04/29/2009 04/30/2009
2 打开 04/30/2009  
3 打开 04/30/2009  

```

..在另一个我有一个与工作相关的笔记列表：

```
ID 作业类型 日期 文本
1 1 打开 04/29/2009 请修理我的打印机
2 1 关闭 04/30/2009 打印机已修复
3 2 打开 04/30/2009 请修理我的显示器
4 2 更新 04/30/2009 需要零件
5 3 打开 05/01/2009 请修复我的鼠标

```

每个作业都将有一个“打开”注释，可选的一个或多个“更新”注释，以及可选的“关闭”注释。Job 字段上显然存在一对多的关系。

我想要的是一个单一的查询，它返回一个工作列表、打开日期、打开说明，如果有的话，关闭说明，如下所示：

```
工作状态 打开日期 打开注释 关闭注释
1 已关闭 04/29/2009 请修复我的打印机 打印机已修复
2 打开 04/30/2009 请修理我的显示器
3 打开 04/30/2009 请修复我的鼠标

```

我这样做的尝试总是失败，因为我最终得到以下结果：

```
工作状态 打开日期 打开注释 关闭注释
1 关闭 04/29/2009 请修理我的打印机
1 关闭 04/29/2009 打印机已修复
2 打开 04/30/2009 请修理我的显示器
2 打开 04/30/2009   
3 打开 05/01/2009 请修复我的鼠标
3 打开 05/01/2009   

```

..或者：

```
工作状态 打开日期 打开注释 关闭注释
1 关闭 04/29/2009 请修理我的打印机
1 关闭 04/29/2009 打印机已修复
2 打开 04/30/2009 请修理我的显示器
3 打开 05/01/2009 请修复我的鼠标

```

我在 Access 2003 中使用 SQL，虽然最终的查询将来自 Excel 前端通过 ADO，但我现在只是试图在 Access 中让它工作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T11:04:15.787

1800 Information 所说的内容，但是如果没有谓词来分别将连接限制为打开和关闭的笔记，那将无法正常工作：

```
select a.job, a.status, a.opendate, 
       b.note as opennote, c.note as closenote 
from job a
     join note b on (a.job = b.job and b.type = 'Open')
     left outer join note c on (a.job = c.job and c.type = 'Closed'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T10:57:49.157

本质上，您需要使用 Job 表作为查询的驱动表，然后有两个连接到 Note 表。第一个连接是“打开”笔记的内部连接 ​​- 这是一个内部连接，因为总会有一个打开的笔记。第二个连接是“关闭”注释的外部连接，因为可能没有关闭注释。像这样的东西：

```
select job.job, status, opendate, opennote.note, closenote.note from
  job left inner join note opennote on opennote.job = job.job
      left outer join note closenote on closenote.job = job.job 
```

访问中的语法可能略有不同或有很大不同，但这是一般的想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T16:04:57.047

tpdi 建议的解决方案在我在 Access 中创建命令时有效，但是当我尝试编辑它或通过 Excel 中的 ADODB 运行查询时抛出“不支持连接表达式”摇摆器。

关闭 MDB 并重新打开就足以让我再次运行它，但是一旦我尝试在 SQL 或 QBE 视图中查看/编辑它，它就会开始抛出异常。最终，即使在“压缩和修复”之后，我也无法打开或编辑查询 - 大概是 Access 中的某种内部损坏。

奇怪的是，我能够通过引用查询 ( `SELECT * FROM noteReport;`) 来使其工作 - 很奇怪。看来我最初的成功是侥幸，因为我无法重新创建确切的查询并让它再次工作。

但是，我最终能够使用以下内容复制所需的报告：

```
SELECT a.callReference, b.callPriority, datevalue(INT(a.openedDT)),
  b.callerFirstName & ' ' & b.callerSurname AS Caller, c.noteText, d.noteText 
FROM ((tblMain AS a 
  INNER JOIN tblCalldetails AS b ON a.callreference=b.callReference) 
  LEFT JOIN tblNotes AS c ON a.callReference=c.callReference) 
  LEFT JOIN tblNotes AS d ON a. callReference =d.callReference
WHERE a.status = 'Closed' 
  AND c.noteType='Open' 
  AND d.noteType='Closing' 
  AND INT(a.closedDT) = #5/1/2009#; 
```

为了我的利益和其他任何可能通过 Google 找到它的人的利益，在此处发布此信息。

# sql - 插入后获取新 ID

> ID：810962
> 
> 赞同：43
> 
> 时间：2009-05-01T10:47:37.560
> 
> 标签：sql, sql-server, insert, identity

我将一堆新行插入到定义如下的表中：

```
CREATE TABLE [sometable](
    [id] [int] IDENTITY(1,1) NOT NULL,
    [someval] sometype NOT NULL
) 
```

使用以下插入：

```
insert into sometable select somefield as someval from othertable 
```

完成后，我想知道所有新插入的行的 ID。`SCOPE_IDENTITY()`只返回最后插入的 ID 行。

如何获得所有新 ID？

想到的一种方法是从 sometable 和后插入的 scope_identity() 中获取当前最大的标识，并使用这两个值从 sometable 中进行选择。例如：

```
declare @currentMaxId int;
select @currentMaxId=MAX(id) from sometable
insert into sometable select somefield as someval from othertable
select * from sometable where id>@currentMaxId and id<=SCOPE_IDENTITY() 
```

有更好的模式吗？

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2009-05-01T10:55:26.637

使用 OUTPUT 功能将所有 INSERTED Id 抓取回表中。

```
CREATE TABLE MyTable
(
    MyPK INT IDENTITY(1,1) NOT NULL,
    MyColumn NVARCHAR(1000)
)

DECLARE @myNewPKTable TABLE (myNewPK INT)

INSERT INTO 
    MyTable
(
    MyColumn
)
OUTPUT INSERTED.MyPK INTO @myNewPKTable
SELECT
    sysobjects.name
FROM
    sysobjects

SELECT * FROM @myNewPKTable 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-24T18:16:21.270

如果您想要 ADO.Net 中的“控制”并获取分配给孩子的 id 并取回 id 以便您可以更新您的模型： [http ://daniel.wertheim.se/2010/10/24/c-批量身份插入/](http://daniel.wertheim.se/2010/10/24/c-batch-identity-inserts/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T11:19:43.020

使用此存储的程序

这将是一个动态主键..

```
 SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO

CREATE PROCEDURE sp_BulkInsertCountry
(
@FilePath varchar(1000)
)
AS
BEGIN--PROCEDURE
--variable declaration
declare @SQL varchar(500)
declare @id int
declare @CountryName varchar(30)

--Create temporary table for Country
CREATE TABLE #tmpCountry
(
CountryName varchar(30),
)

---executing bulk insert on temporary table
SET @SQL='BULK INSERT #tmpCountry from ''' + @FilePath + ''' WITH (FIELDTERMINATOR ='','',ROWTERMINATOR=''\n'')'
EXEC(@sql)

DECLARE cursor_Country CURSOR READ_ONLY FOR
select [CountryName] from #tmpCountry

OPEN cursor_Country
FETCH NEXT FROM cursor_Country INTO @CountryName
WHILE @@FETCH_STATUS=0
BEGIN
SELECT @id=isnull(max(Countryid),0) from tblCountryMaster
SET @id=@id+1
INSERT INTO tblCountryMaster values(@Id,@CountryName) 
FETCH NEXT FROM cursor_Country INTO @CountryName
END
CLOSE cursor_Country
DEALLOCATE cursor_Country
END--PROCEDURE

GO
SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO 
```

有关更多详细信息，请访问以下链接 [http://jalpesh.blogspot.com/search?q=bulk+insert](http://jalpesh.blogspot.com/search?q=bulk+insert)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T17:03:11.480

创建一个表来设置所有新的 ID。然后为所有插入创建一个循环。在循环内使用 SCOPE_IDENTITY() 进行插入。插入后获取新 ID 并将其插入到您为其创建的新表中。最后从 [newTable] 中选择 *。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-05-13T17:16:22.220

`MERGE`扩展@Robin Day 的答案——您可以使用技巧将您的临时 ID 映射到新 ID 。

```
DECLARE @Keys TABLE (TempId INT, RealId INT)

MERGE MyTable
    USING @NewStuff t
    ON 1 = 0
    WHEN NOT MATCHED THEN
        INSERT (col1, col2, col3)
        VALUES (t.col1, t.col2, t.col3)
        OUTPUT t.TempId, Inserted.RealId INTO @Keys 
```

来自@Ivan Starostin 的巧妙回答： [SQL Server 中插入的 ID 列表](https://stackoverflow.com/questions/37612195/list-of-inserted-id-in-sql-server?rq=1)

# c# - 从 telnet 流读取到大字节数组是否要等到字节数组已满？

> ID：810963
> 
> 赞同：0
> 
> 时间：2009-05-01T10:48:35.933
> 
> 标签：c#, stream, bytearray, telnet

通过阅读这里的一些问题和答案，似乎 telnet 流从未真正关闭。使用 DataAvailable() 不会返回。

我继承了一些需要很长时间才能完成的代码，我们认为问题出在 telnet 服务器上。但是，有一个字节[32757]，代码试图在其中存储 telnet 服务器的响应。

类似于以下内容：

```
Byte byteArray[] = new Byte[32757];
TcpClient sock = new TcpClient();
sock.GetStream().read(byteArray, 0 byteArray.length); 
```

如果没有 32757 字节或更多字节，我假设此代码会等待，直到发送足够的空数据包来构成字节数组的大小。这个对吗？

有没有办法检查 telnet 服务器是否已完成发送它想要的所有内容？telnet 会话的每个“页面”中没有可见的终止字符或字符串。

我在想一种更正此代码的方法是一次读取几个字节，将其添加到字符串中，检查字符串中是否存在终止字符或字符集，如果找到则返回。否则，读取更多字节，将其添加到字符串中，然后再次检查。

建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T11:03:20.953

除了 Jon Skeets 的解释之外，还有一点提示：

由于 telnet 是基于文本（行）的协议，因此读取 byte[] 意味着您必须重新组合文本。使用 TextReader 会更好：

```
System.IO.TextReader reader = new System.IO.StreamReader(
           sock.GetStream(), Encoding.ASCII);
string line;
while ((line = reader.ReadLine()) != null)  ...; 
```

我在这里猜测 telnet 使用 ASCII。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T10:52:47.360

不，`Stream.Read`通常不会等到它读取所有内容，而且对于网络流来说更不可能。它会读取任何可用的数据，或者阻塞直到有*一些*数据可用，但仅此而已。

服务器“完成”发送将要发送的内容并没有真正的概念，除非：

*   a）它会提前告诉你它将发送多少
*   b）它指示何时完成某种终止数据
*   c) 它关闭连接

您可能希望使用某种计时器来实现“继续阅读，直到其中一个读取时间超过 5 秒”的效果。请注意，读取仍然会发生 - 您只需选择那个时间来更新 UI（或其他）。这是一个相当棘手的话题，你真的需要*非常*清楚自己（和文档！）你想要做什么，以及哪个线程将处理什么。

另一种方法是在 上设置读取超时`TcpClient`，但我没有这方面的经验。您可能只需要在阅读时使用[`TcpClient.ReceiveTimeout`](http://msdn.microsoft.com/en-us/library/system.net.sockets.tcpclient.receivetimeout.aspx)然后`IOException`适当地处理结果，但我对此没有任何建议。

# c# - ISerializable 接口的意义何在？

> ID：810974
> 
> 赞同：58
> 
> 时间：2009-05-01T10:56:29.393
> 
> 标签：c#, serializable, iserializable

似乎我可以序列化没有该接口的类，所以我不清楚它的目的。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-05-01T11:06:48.077

`ISerializable`用于提供自定义二进制序列化，通常用于`BinaryFormatter`（也可能用于远程处理）。没有它，它使用的字段可以是：

*   效率低下；如果存在仅在运行时用于提高效率的字段，但可以删除以进行序列化（例如，字典在序列化时可能看起来不同）
*   效率低下；即使对于需要的字段，它也需要包含许多额外的元数据
*   无效的; 如果有**不能**序列化的字段（比如事件委托，虽然可以标记`[NonSerialized]`）
*   脆; 您的序列化现在绑定到*字段*名称 - 但字段意味着实现细节；另请参阅[混淆、序列化和自动实现的属性](http://marcgravell.blogspot.com/2009/03/obfuscation-serialization-and.html)

通过实现`ISerializable`，您可以提供自己的二进制序列化机制。请注意，与 this 等效的 xml 是`IXmlSerializable`, 由`XmlSerializer`etc使用。

出于 DTO 目的，`BinaryFormatter`应避免使用 xml（通过`XmlSerializer`或`DataContractSerializer`）或 json 之类的东西，以及诸如协议缓冲区之类的跨平台格式。

为了完整起见，protobuf-net 确实包含了钩子`ISerializable`（允许您使用可移植的二进制格式而无需编写大量代码），但`BinaryFormatter`无论如何都不是您的首选。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-01T11:04:31.467

可以通过以下两种方式之一在 .NET 中对类进行序列化：

1.  使用属性标记`SerializableAttribute`并装饰您*不想*序列化的所有字段`NonSerialized`。（正如 Marc Gravell 指出的那样，`BinaryFormatter`通常用于格式化`ISerializable`对象的类会自动序列化所有字段，除非它们另有特别标记。）
2.  实现`ISerializable`完全自定义序列化的接口。

前者使用起来更简单，因为它只涉及用属性标记声明，但它的功能有限。后者允许更大的灵活性，但需要付出更多的努力来实施。您应该使用哪一个完全取决于上下文。

关于后者 ( `ISerializable`) 及其用法，我从[MSDN 页面](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.iserializable.aspx)中引用了该接口：

> 任何可能被序列化的类都必须用 SerializableAttribute 进行标记。如果一个类需要控制其序列化过程，可以实现ISerializable接口。Formatter 在序列化时调用 GetObjectData 并使用表示对象所需的所有数据填充提供的 SerializationInfo。Formatter 使用图中对象的类型创建一个 SerializationInfo。需要为自己发送代理的对象可以使用 SerializationInfo 上的 FullTypeName 和 AssemblyName 方法来更改传输的信息。
> 
> 在类继承的情况下，可以序列化从实现 ISerializable 的基类派生的类。在这种情况下，派生类应在其 GetObjectData 实现中调用 GetObjectData 的基类实现。否则，来自基类的数据将不会被序列化。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-01T11:02:22.830

使用`ISerializable`您可以在对象中编写自定义方法以在进行二进制序列化时接管序列化，以与 BinaryFormatter 使用的默认方法不同的方式序列化对象。

换句话说，如果默认方法以不同于您希望它序列化的方式序列化您的对象，您可以实现 ISerializable 以获得完全控制。请注意，与 ISerializable 一起，您还应该实现一个自定义构造函数。

XmlSerialization 当然只会使用属性，ISerializable 与 XML 序列化无关。

感谢 Marc 和 Pop 的评论，我的第一个答案有点仓促。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-01T11:04:55.537

为了使对象“可传输”，您必须对其进行序列化。例如，如果要使用 .NET Remoting 或 Web 服务传输对象数据，则必须提供序列化对象数据的方法，将对象实例减少为表示对象高保真表示的可传输格式。

然后，您还可以采用序列化表示，将其传输到另一个上下文，例如不同的机器，并重建您的原始对象。

实现`ISerializable`接口时，类必须提供接口中包含的 GetObjectData 方法，以及专用于接受两个参数的专用构造函数：SerializationInfo 实例和 StreamingContext 实例。

如果您的类不需要对其对象状态进行细粒度控制，那么您可以只使用`[Serializable]`属性。需要对序列化过程进行更多控制的类可以实现 ISerializable 接口。

# jquery - jQuery idTabs 插件悬停功能问题

> ID：810980
> 
> 赞同：0
> 
> 时间：2009-05-01T11:02:24.717
> 
> 标签：jquery, css, jquery-plugins

我正在使用 jQuery [idTabs](http://www.sunsean.com/idTabs/)插件。我想提供悬停功能并使用具有此功能的 div。默认设置适用于点击事件。如何更改此功能。

最好的祝福。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T12:30:45.347

```
<div id="adv1" class="usual"> 
    <span>
            <div><a href="#t1">Tab 1</a></div> 
            <div><a href="#t2">Tab 2</a></div> 
            <div><a href="#t3">Tab 3</a></div> 
    </span>

    <div id="t1">This is tab 1.</div> 
        <div id="t2">More content in tab 2.</div> 
        <div id="t3">Tab 3 is always last!</div> 
</div> 

<script type="text/javascript"> 
      $("#adv1 span").idTabs({ start:1, change:false },true);
</script> 
```

非常垃圾的脚本，为什么不考虑真正的标签[http://docs.jquery.com/UI/Tabs](http://docs.jquery.com/UI/Tabs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T19:07:36.233

我不确定您想如何具体使用 div，但要实现您所说的“悬停”效果，请使用以下代码：

```
$("...").idTabs("!mouseover"); 
```

# isapi - ISAPI 重写语法帮助？

> ID：810982
> 
> 赞同：0
> 
> 时间：2009-05-01T11:03:14.090
> 
> 标签：isapi

我正在努力让一些代码为我管理的旧 ASP 商店网站工作 - 我添加了以下内容，效果很好

```
RewriteBase /
RewriteRule ^cat/[^?/]*_(\d+)\.htm /store/prodList.asp?idcategory=$1 [QSA] 
```

问题是类别页面是否有多个页面！因为它像这样向查询字符串添加了另外几个参数

```
/store/prodList.asp?idcategory=102&curPage=2&sortField=sortorder 
```

我正在寻找一个获取三个查询字符串参数并将其附加到重写的 URL 的示例......有人可以帮忙吗？

因此，例如，当前以下 URL 可以正常工作

```
cat/productname_5.htm ... equates to ... /store/prodList.asp?idcategory=5 
```

当我有多个页面时，我需要执行以下操作吗？但不知道 ISAPI 语法？

```
cat/productname_5_2_sortorder.htm ... would equate to ... /store/prodList.asp?idcategory=5&curPage=2&sortField=sortorder 
```

我希望这更有意义？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T11:08:46.183

我认为这就是您要问的，设置 [L] 参数以使其在第一次匹配时停止匹配。?

但是 [L] 要求您首先按最严格的顺序排列它们，4 个 args，然后是 3、2 等...

```
 ReWriteRule ^/store/([0-9]+)/([0-9]+)/{0,1}$ /store/prodList.asp\?idcategory=$1&curPage=$2 [L]

  ReWriteRule ^/store/([0-9]+)/([0-9]+)/([A-Za-z]+)/{0,1}$ /store/prodList.asp\?idcategory=$1&curPage=$2&sortField=$3 [L] 
```

# asp.net-mvc - ASP.NET MVC - 点网核弹

> ID：810985
> 
> 赞同：0
> 
> 时间：2009-05-01T11:03:41.593
> 
> 标签：asp.net-mvc

我们如何在 MVC 的帮助下创建像 dotnetnuke 这样的应用程序。我们可以直接添加模块和其他东西，而不需要修改代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T11:44:28.017

这种类型的问题说明了很多。虽然通过尝试这样的项目你肯定会学到很多东西，但你提出这个问题的事实表明你的知识有很多很多的差距，其中最重要的是你不会得到有用的答案之所以提出这样的问题，是因为这样的事业是一项由许多子组件组成并跨越多个学科的大型工作。您不能指望任何人在此处所需的空间内给您所需的答案。

我的建议是退后一步，启动 Visual Studio，首先使用 MVC 创建一个简单的网站；也许具有一些功能，例如会员资格、论坛、可编辑页面和页面评论。

一旦您对 MVC 感到满意并且可以轻松地找到解决其架构的方法，您就可以开始考虑解决更复杂问题的方法，例如构建像 DotNetNuke 这样的 CMS。

我也鼓励你不要仅仅因为它是你习惯的而构建一个新版本的 DotNetNuke，而是看看那个系统并决定这是否真的是最好的做事方式，看看有没有你可以的方法改进（或彻底检查）该类型的 CMS 实施。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-06-28T16:58:31.163

开始关注[Kooboo](http://www.kooboo.com/)

从网站：

> **基于 ASP 的企业 CMS。网络MVC**
> 
> Kooboo CMS 可让您高效地创建专业网站，而不会失去产品质量。
> 
> **开发人员**
> 这个企业 CMS 系统可以节省时间，让您可以自由地开发具有个人风格的高质量网站。我们简化了 Web 开发流程。Kooboo CMS 基于 ASP.NET MVC。我们易于使用的教​​程和快速响应论坛提供明确的指导和支持，让您有信心释放您的创造潜力。
> 
> **设计师**
> 我们为您提供您在 HTML/CSS 编码中应得的控制权。Kooboo CMS 不会生成任何外部 HTML 代码。此外，我们还提供有关 HTML 编码的支持和建议。
> 
> **个人**
> 轻松创建您自己的个人网站！访问 kooboostore.com 下载站点包和模块，一键开始设置您的网站！在商店中查看来自社区用户或 Kooboo 团队的每周站点包更新。
> 
> Kooboo CMS 提供快速、企业级的 Web 开发，非常用户友好。我们构建这个系统是因为没有在任何其他开发包中找到我们正在寻找的东西。让我们向您展示简单的 Web 开发是多么有益和有利可图！

许可是带有支持选项的 GPL v3。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T11:18:28.110

据我所知，没有任何基于 MVC 框架构建的 CMS 提供与 DotNetNuke 相同的灵活性和功能。这可能是因为 MVC 的 v. 1.0 仅在 4-6 周前发布。

# windows - 使用 Windows Media Encoder 录制屏幕

> ID：810994
> 
> 赞同：1
> 
> 时间：2009-05-01T11:07:00.430
> 
> 标签：windows, screen, media, capture, encoder

编写一些 .Net 代码来记录屏幕和音频（来自计算机麦克风），然后输出到 wmv 文件是否容易。有参考代码吗？

顺便说一句：我从 WME SDK 中搜索了所有代码，没有这样的示例代码。

谢谢！乔治

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T11:17:34.040

微软和内容 mafi^H^H^H^Hindustry 正在尽最大努力使这成为不可能。搜索“开源屏幕音频捕获”比浏览任何官方提供的文档/示例代码要好得多 - 如果 Microsoft 提供任何相关内容，我会感到非常惊讶。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T11:26:31.193

查看[可用于 Techsmith Camtasia 的 SDK](http://www.techsmith.com/company/press/archive/pr010424.asp)：

Camtasia 是一个全屏桌面录制应用程序，支持各种视频和音频源、编解码器等，他们的 SDK 将其公开为 ActiveX 控件（您可以非常愉快地从 .NET 调用它）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T11:32:56.577

有用于屏幕捕获的 DirectShow 兼容过滤器。这将允许您使用任何录制程序来捕获屏幕内容或自己在 .NET 中编写应用程序（但这并不容易）。

我使用的是： [http ://www.hmelyoff.com/index.php?section=9](http://www.hmelyoff.com/index.php?section=9)

**编辑：**我没有 WME SDK 的示例或经验。但我建议采用 DirectShow 路线，以避免在主机系统上需要 WME、缺乏对它的支持，以及了解 DirectShow（或自己做）而不是一些随机的 API 很好。

要使用 Hmelyoff 过滤器，它就像一个网络摄像头一样工作。它只是可供任何需要视频输入的应用程序使用的另一个视频捕获源。它的工作原理是将视频缓冲区的一部分复制到每帧上的输出引脚（使用像 BitBlt 这样的 API 函数）。

一些示例代码在[这里](http://www.codeguru.com/csharp/csharp/cs_graphics/screencaptures/article.php/c6139)。

或者，如果您只想与 DirectShow 交互，最简单的方法是使用库为您进行 COM 交互。[http://directshownet.sourceforge.net/](http://directshownet.sourceforge.net/)是一个不错的选择。

**再次编辑：**捕获为视频与捕获帧相同。它每秒只捕获 30 次帧。占用CPU？是的，不要期望获得完整的帧速率。

如果您要问的是如何将帧保存为视频，那么您将需要将数据传递给视频编码器。您将需要与 DirectShow 交互来执行此操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-24T22:03:29.300

您最好的选择是将 windows 媒体编码器库作为 .net 应用程序中的 com 接口导入并在您的应用程序中使用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-03T15:11:25.410

是的，这完全可以使用 WME： [http ://www.c-sharpcorner.com/UploadFile/armoghanasif/CaptureDesktopActivities11122005013755AM/CaptureDesktopActivities.aspx](http://www.c-sharpcorner.com/UploadFile/armoghanasif/CaptureDesktopActivities11122005013755AM/CaptureDesktopActivities.aspx)

我过去做过，一旦你开始调整编码设置，你就可以获得质量非常好的视频。特别是如果 WMV 对您来说是一个可行的选择。如果不是，您必须使用另一个应用程序重新编码为另一种格式。

我发现调整的最简单方法是使用 WME 桌面应用程序以不同的设置进行测试和记录，然后保存这些配置文件，这些文件我后来以编程方式从我的应用程序中加载。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-11-15T11:14:54.760

您可以使用 Microsoft Expression Encoder 4 来录制视频和音频。它只适用于 C#。下面的代码应该很熟悉。

```
void Encode(string jobPath)
    {
        using (Job j = new Job())
        {

            MediaItem mediaItem = new MediaItem(jobPath);
            var size = mediaItem.OriginalVideoSize;
            WindowsMediaOutputFormat WMV_Format = new WindowsMediaOutputFormat();
            WMV_Format.VideoProfile = new Microsoft.Expression.Encoder.Profiles.AdvancedVC1VideoProfile();
            WMV_Format.AudioProfile = new Microsoft.Expression.Encoder.Profiles.WmaAudioProfile();
            WMV_Format.VideoProfile.AspectRatio = new System.Windows.Size(16, 9);
            WMV_Format.VideoProfile.AutoFit = true;

            if (size.Width >= 1920 && size.Height >= 1080)
            {
                WMV_Format.VideoProfile.Size = new System.Drawing.Size(1920, 1080);
                WMV_Format.VideoProfile.Bitrate = new Microsoft.Expression.Encoder.Profiles.VariableUnconstrainedBitrate(6000);
            }
            else if (size.Width >= 1280 && size.Height >= 720)
            {
                WMV_Format.VideoProfile.Size = new System.Drawing.Size(1280, 720);
                WMV_Format.VideoProfile.Bitrate = new Microsoft.Expression.Encoder.Profiles.VariableUnconstrainedBitrate(4000);
            }
            else
            {
                WMV_Format.VideoProfile.Size = new System.Drawing.Size(size.Width, size.Height);
                WMV_Format.VideoProfile.Bitrate = new Microsoft.Expression.Encoder.Profiles.VariableUnconstrainedBitrate(2000);
            }
            mediaItem.VideoResizeMode = VideoResizeMode.Letterbox;
            mediaItem.OutputFormat = WMV_Format;
            j.MediaItems.Add(mediaItem);
            j.CreateSubfolder = false;
            j.OutputDirectory = @"D:\output";
            j.EncodeProgress += new EventHandler<EncodeProgressEventArgs>(j_EncodeProgress);
            j.Encode();
        }
    } 
```

# class - 带有子报表和对象类的 rdlc

> ID：810996
> 
> 赞同：0
> 
> 时间：2009-05-01T11:08:20.177
> 
> 标签：class, object, report, rdlc

我正在使用 Microsoft Reports (rdlc)，我需要使用子报表创建报表。作为数据源，我创建了两个对象类，PositionObject 和 PositionSubElementObject。PositionObject 是主报表的数据源，PositionSubElementObject 是子报表的数据源。当我分别运行这两个报告时，一切正常，但是当我使用子报告创建报告时，我在子报告中出现错误。

两个对象类具有相同的字段 IDPosition，该字段是我从主报表传递给子报表的参数。

我希望有人知道我错在哪里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T12:09:44.280

确保在事件 ReportViewer.LocalReport.SubreportProcessing 中设置子报表的数据源。*****************`*********