# StackOverflow 问答 11299000-11299999

# android - android 2D位图绘制

> ID：11299001
> 
> 赞同：1
> 
> 时间：2012-07-02T18:17:04.173
> 
> 标签：android, animation, bitmap, drawing

any1 可以告诉我为什么我不能像这样在我的 surfaceView 上添加位图：

```
 steering = new Steering(BitmapFactory.decodeResource(getResources(), R.drawable.ic_launcher), getWidth()-50,getHeight()-50); 
```

如果我使用整数而不是“getHeight()”方法，则添加位图就可以了。但由于我希望这款游戏可以在超过 1 部手机上运行而不会看起来很奇怪，我想使用这 2 种方法添加它。

任何人都可以帮忙吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T18:28:49.237

你到底在哪里添加那条线？如果它在你`onCreate`身上，那么它不会从该方法向你显示图像，`getWidth()`并且`getHeight()`会返回 0。所以要绘制它，你必须等到系统实际创建视图。要测试您是否确实收到了一个值，请尝试更改您实际拥有的代码，如下所示：

```
final int width = getWidth();
final int height = getHeight();
final Bitmap bitmap = BitmapFactory.decodeResource(getResources(), R.drawable.ic_launcher);
steering = new Steering(bitmap, width-50,height-50); 
```

并向转向线添加断点并对其进行调试。如果宽度和高度为 0，则必须等待视图绘制。

***编辑：*** 在你的`Activity`/`Fragment`你可以像这样添加一个树观察者：

```
 myView.getViewTreeObserver().addOnGlobalLayoutListener( new ViewTreeObserver.OnGlobalLayoutListener() {
                @Override
                public void onGlobalLayout() {
                    //Do something here since now you have the width and height of your view
                }
            }); 
```

这是一个关于如何在课堂上做到这一点的小例子：

***我的指导班：***

```
public class Steering {

    private Bitmap mBitmap;
    private int mWidth;
    private int mHeight;

    public Steering(Bitmap bitmap, int width, int height) {
        this.mBitmap = bitmap;
        this.mWidth = width;
        this.mHeight = height;
    }

    public Bitmap getBitmap() {
        //reescaling from anddev.org/resize_and_rotate_image_-_example-t621
        final int imageWidth = mBitmap.getWidth();
        final int imageHeight = mBitmap.getHeight();
        // calculate the scale -
        float scaleWidth = ((float) mWidth) / imageWidth;
        float scaleHeight = ((float) mHeight) / imageHeight;
        // createa matrix for the manipulation
        Matrix matrix = new Matrix();
        // resize the bit map
        matrix.postScale(scaleWidth, scaleHeight);

        Bitmap resizedBitmap = Bitmap.createBitmap(mBitmap, 0, 0, imageWidth, imageHeight, matrix, true);
        return resizedBitmap;
    }

} 
```

***我的活动***

```
public class MainActivity extends Activity {

    MyView mView;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        mView = (MyView) findViewById(R.id.viewid);
        OnGlobalLayoutListener listener = new OnGlobalLayoutListener() {

            @Override
            public void onGlobalLayout() {
                final int width = mView.getWidth();
                final int height = mView.getHeight();
                final Bitmap bitmap = BitmapFactory.decodeResource(getResources(), R.drawable.android);
                //image from anddev
                final Steering steering = new Steering(bitmap, width-50,height-50);
                mView.setObject(steering);
            }
        };
        mView.getViewTreeObserver().addOnGlobalLayoutListener(listener);
    }

} 
```

**和我的视图类**

```
public class MyView extends View{

    Steering steering = null;

    public MyView(Context context) {
        super(context);
    }

    public MyView(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public void setObject(Steering steering){
        this.steering = steering;
    }

    final Paint paint = new Paint();

    @Override
    protected void onDraw(Canvas canvas) {
        canvas.save();
        if(steering!=null){
            canvas.drawBitmap(steering.getBitmap(), 0, 0, paint);
        }
        canvas.restore();
    }

} 
```

您可以将其用于普通视图或表面视图，无论哪种方式都有效。对不起，如果答案有点太长：P

# php - 在 CodeIgniter 中访问 GET 变量的问题

> ID：11299003
> 
> 赞同：0
> 
> 时间：2012-07-02T18:17:10.893
> 
> 标签：php, html, codeigniter

有没有办法像您通常使用`$_GET`但在 CodeIgniter 中一样检索 HTML 页面内 URL 中的参数？

例如，如果您在视图中并且有 URL：[http ://www.mysite.com/controller/function/var1/var2](http://www.mysite.com/controller/function/var1/var2)

那么你将如何访问什么`var1`和`var2`曾经是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T18:20:39.443

像这样：

```
$var1 = $this->uri->segment(3);
$var2 = $this->uri->segment(4); 
```

[在这里](http://codeigniter.com/user_guide/libraries/uri.html)阅读更多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T18:37:16.903

您也可以像访问它一样访问它。

例如：

```
public function somePage($var, $var2) {
    //get var
    echo "you can access ".$var." like this<br />";
    echo "or like this, ".$var2;
} 
```

例如，如果您访问 somesite.com/mypage/access/1/3

你会得到以下信息：

```
you can access 1 like this
or like this, 3 
```

Yan 写的也是正确的，尽管知道您也可以这样做以节省打字时间。

# perl - 如何将下一行附加到当前行

> ID：11299004
> 
> 赞同：0
> 
> 时间：2012-07-02T18:17:11.343
> 
> 标签：perl

如果时间戳匹配，我正在努力寻找一种将下一行附加到当前行的方法。到目前为止，这是我的代码：

```
open(FH, "error_log:);
@data = <FH>
foreach $line (@data) {
        if ( ($line =~ /notice/)) {  
                $line =~ s/ /,/g;    
                my @L1 = split(/|notice|\[|\]|,mpmstats:,|\t|rdy,|bsy,
+|rd,|wr,|ka,|log,|dns,|cls,|bsy:,|in,|/, $line);
                $line =~ s/|notice|\[|\]|,mpmstats:,|\t|rdy,|bsy,|rd,|
+wr,|ka,|log,|dns,|cls,|bsy:,|in,//g;                    
                print $line; 
```

请注意，我打印只是为了查看输出。输出如下：

```
Wed,Jun,13,10:40:35,2012,758,42,0,29,11,0,0,2
Wed,Jun,13,10:40:35,2012,29,mod_was_ap22_http.c
Wed,Jun,13,10:41:35,2012,761,39,0,34,5,0,0,0
Wed,Jun,13,10:41:35,2012,34,mod_was_ap22_http.c
Wed,Jun,13,10:42:35,2012,769,31,0,22,6,0,0,3
Wed,Jun,13,10:42:35,2012,22,mod_was_ap22_http.c
Wed,Jun,13,10:43:35,2012,754,46,0,29,17,0,0,0 
```

我希望将数字（第 2 行的 29）以 csv 形式放置在与时间戳对应的第一行的其他数字之后。可以删除该行的其余部分。如果该行下面没有任何内容（例如最后一行），我想附加一个零。感谢您的帮助。

这是所要求的输入数据的一部分：

```
[Wed Jun 13 01:41:24 2012    [error  [client 10.119.84.9     File does not exist: /ebiz/b2b/IHS70prd/htdocs/offline.b2bonline.html
[Wed Jun 13 01:41:25 2012    [error  [client 10.119.84.9     File does not exist: /ebiz/b2b/IHS70prd/htdocs/offline.b2bonline.html
[Wed Jun 13 01:41:25 2012    [error  [client 10.119.84.8     File does not exist: /ebiz/b2b/IHS70prd/htdocs/offline.b2bonline.html
[Wed Jun 13 01:41:28 2012    [error  [client 10.119.116.8    File does not exist: /ebiz/b2b/IHS70prd/htdocs/offline.b2bonline.html
[Wed Jun 13 01:41:28 2012    [error  [client 10.119.84.8     File does not exist: /ebiz/b2b/IHS70prd/htdocs/offline.b2bonline.html
[Wed Jun 13 01:41:34 2012    [notice     mpmstats: rdy 786 bsy 14 rd 0 wr 11 ka 3 log 0 dns 0 cls 0 
[Wed Jun 13 01:41:34 2012    [notice     mpmstats: bsy: 11 in mod_was_ap22_http.c   
[Wed Jun 13 01:41:34 2012    [error  [client 10.119.84.9     File does not exist: /ebiz/b2b/IHS70prd/htdocs/offline.b2bonline.html
[Wed Jun 13 01:41:35 2012    [error  [client 10.119.84.9     File does not exist: /ebiz/b2b/IHS70prd/htdocs/offline.b2bonline.html 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:02:42.497

你的输入很奇怪。通常，我会看到匹配的方括号。

除此之外，你想要的是这样的：

```
# This assumes you have Perl 5.10 or autodie installed: failures in open, readline, 
# or close will die automatically
use autodie;

# chunks of your input to ignore, see below...
my %ignorables = map { $_ => 1 } qw(
    [notice mpmstats: rdy bsy rd wr ka log dns cls bsy: in
);

# 3-arg open is safer than 2, lexical my $fh better than a global FH glob
open my $error_fh, '<', 'error_log'; 

# Iterates over the lines in the file, putting each into $_
while (<$error_fh>) {

    # Only worry about the lines containing [notice
    if (/\[notice/) {

        # Split the line into fields, separated by spaces, skip the %ignorables
        my @line = grep { not defined $ignorables{$_} } split /\s+/;

        # More cleanup
        s/^\[//g for @line; # remove [ from [foo

        # Output the line
        print join(",", @line);

        # Assuming the second line always has "in" in it, 
        # but this could be whatever condition that fits your data...
        if (/\bin\b/) {  # \b matches word edges, e.g., avoids matching "glint"
            print "\n";
        }
        else {
            print ",";
        }
    }
}

close $error_fh; 
```

我没有编译这个，所以我不能保证我没有在某个地方打错字。

这里的关键是你第一个`print`没有换行符，但以逗号结尾。然后，当您检测到这是第二行时添加换行符。

您可以改为`@line`在循环外部声明并使用它来累积字段，直到您需要在末尾使用换行符输出它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:03:49.453

一种使用方式`perl`。它省略了不包含**[notice** . 对于匹配的每一行，它会增加一个变量并将不同的字段保存在数组中，具体取决于它是奇数还是偶数（**[notice**的第一次出现或第二次出现）。

```
perl -ane '
    next unless $F[5] eq q|[notice|;
    ++$notice;
    if ( $notice % 2 != 0 ) {
        push @data, @F[0..4, 8, 10, 12, 14, 16, 18, 20, 22];
        next unless eof;
    }

    push @data, (eof) ? 0 : $F[8];
    $data[0] =~ s/\A\[//;
    printf qq|%s\n|, join q|,|, @data;
    @data = ();
' infile 
```

假设`infile`您的问题有内容，输出将是：

```
Wed,Jun,13,01:41:34,2012,786,14,0,11,3,0,0,0,11 
```

# html - 在不移动背景的情况下偏移文本

> ID：11299005
> 
> 赞同：0
> 
> 时间：2012-07-02T18:17:12.107
> 
> 标签：html, css

是否可以在不添加额外的包装元素的情况下偏移 HTML 元素中文本的位置*而不*导致背景也移动？

动机：

我有现有的 HTML 标记 (phpBB)，并且我将一些链接设置为看起来像按钮，以便它们在`:active`（鼠标按钮按下）时被明显按下。我通过背景更改完成了其中的一半工作，但我还想将文本向下和向右偏移 1 个像素。

现有 HTML 标记（无法更改）：

```
<a href="…"><span></span>Hello World</a> 
```

小提琴显示效果和现有 CSS（可以更改）：http: [//jsfiddle.net/szxPz/1/](http://jsfiddle.net/szxPz/1/)

***编辑**：我可以让文本向右移动`text-indent:1px; margin-right:-1px`，但这仍然需要向下移动文本。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:30:14.320

您应该能够通过增加`padding-top`和减少`height`1 来实现这一点。

# php - 标头位置延迟

> ID：11299006
> 
> 赞同：10
> 
> 时间：2012-07-02T18:17:13.233
> 
> 标签：php

我有以下 php 代码，我也想添加延迟：

```
<?php
    echo "Message has been sent.";
    header("Location: page2.php", true, 303);
    exit;
?> 
```

上面的代码发生得太快了，所以我看不到消息：

我试过了：

```
<?php
    sleep(5);
    echo "Message has been sent.";
    header("Location: page2.php", true, 303);
    exit;
?> 
```

这也不会显示消息，但它会休眠 5 秒，这只是浪费时间。

如何让它在重定向之前显示一条消息 5 秒？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-07-02T18:20:02.770

您不能使用 HTTP 位置重定向来执行此操作，因为此重定向将在浏览器获取标头后立即发生。相反，在标头中使用刷新重定向：

```
header( "Refresh:5; url=http://www.example.com/page2.php", true, 303); 
```

这*应该*适用于现代浏览器，但是它不是标准化的，因此要获得等效的功能将使用元刷新重定向（这意味着您也必须输出完整的 HTML）：

```
<meta http-equiv="refresh" content="5;url=http://www.example.com/page2.php"> 
```

从[维基百科页面](http://en.wikipedia.org/wiki/HTTP_refresh)：

> 用于重定向或创建新资源时。此刷新在 X 秒后重定向。这是由 Netscape 引入并得到大多数 Web 浏览器支持的专有、非标准标头扩展。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-02T18:21:09.510

使用客户端脚本进行重定向：

```
<script>
window.setTimeout(function() {
    window.location = 'page2.php';
  }, 5000);
</script>
<p>Message has been sent.</p> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-10-30T23:07:16.393

您必须像这样修改您的代码：

```
<?php

    echo "Message has been sent.";
    sleep(5);
    header("Location: page2.php", true, 303);
    exit;
?> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-02T18:19:50.820

如果您使用标头（位置）重定向，您将无法看到该消息。事实上，该重定向根本不应该工作，因为输出在发送标头之前开始。相反，您应该延迟回显元标记刷新，例如 `echo '<meta http-equiv="refresh" content="5;URL=\'http://example.com/\'">';`

延迟 5 秒。或者，（更准确地说）您可以输出 JS 重定向，因为元刷新标签已被弃用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-12T00:43:35.117

我不知道它是否有帮助，但是当我在提交消息后需要清理的表单中处理相同的问题时，我发现这个答案解释了您可以将值输入更改为空。

这就是答案： [当页面重新加载时，如何重置文本输入的值？](https://stackoverflow.com/questions/5502305/how-do-i-reset-the-value-of-a-text-input-when-the-page-reloads)

这就是我使用我的类 .form-control 解决问题的方法

```
$(document).ready(function() {
   $(".form-control").val('');
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-02T07:05:02.527

```
header( "Refresh:time; url='filelocation'"); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-03-14T01:36:28.230

这对我有用...我在 WAMPP for Windows 上使用最新的 PHP 版本 7.3.3...

```
<?php

$name = $_POST['name'] ?? null; 

if(empty(trim($name))){
    header("location: http://localhost/testsite/index.php");
}

echo 'Greetings '. $_POST['name'].', how can I help you?';

echo '<meta http-equiv="refresh" content="5;URL=\'http://localhost/testsite/index.php\'">'; 
```

我希望这有帮助。

# css - 链接到根级别，然后是图像文件夹

> ID：11299007
> 
> 赞同：0
> 
> 时间：2012-07-02T18:17:15.060
> 
> 标签：css, html

我有一个看起来像这样的文件结构：

[我的网站结构 http://retailsitecommon.afstores.com/Develop/FreshMarket/Screen%20Shot%202012-07-02%20at%2012.12.00%20PM.png](http://retailsitecommon.afstores.com/Develop/FreshMarket/Screen%20Shot%202012-07-02%20at%2012.12.00%20PM.png)

我正在尝试为我的图像使用根级链接，因为我有一个页脚，需要在其中包含图像的子文件夹的子文件夹中使用。例如，在我的 styles.css 文件中，我正在尝试背景：url('/images/logo.png') no-repeat;，但图像没有显示。如果我做背景： url('../images/logo.png') no-repeat;，图像就会出现。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:30:16.463

我认为这需要在服务器上才能像您希望的那样工作。尝试在 PC 上设置 Lamp 或在 Mac 上设置 Mamp。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T18:33:22.137

从文件调用的文件的父文件夹是文件`.css`所在的`.css`文件夹。当您使用（反）斜杠开始文件位置时，您将此文件重定向到您的文件根目录。

它的意思是：

```
/folder-in-root/
./folder-visible-from-stylesheet-file-location/ 
```

# c# - 如何在保持动态的同时指定接口返回类型？

> ID：11299008
> 
> 赞同：1
> 
> 时间：2012-07-02T18:17:18.537
> 
> 标签：c#, .net, interface

我要在这里颠倒过来

我正在尝试做的是创建一个处理不同类型票证的工厂。所以我创建了一个 ITicket 接口，它有几个签名，比如

```
GetOpen(); 
GetById(int id); 
```

现在，这些方法需要返回一个实例或相同票证类型的实例列表，所以我想我应该让界面看起来像这样

```
List<ITicket> GetOpen();
ITicket GetById(int id); 
```

所以在实践中，我希望创建这样的工厂方法：

```
public static List<ITicket> GetOpen(ITicket ticket)
{
   return ticket.GetOpen();
} 
```

好的，现在例如，我回到我的类 MocRequest 并实现 List GetOpen() 方法，如下所示：

```
public List<MocRequest> GetOpen()
{
   //implementation grabs a bunch of MocTickets out of the database 
   and converts them into instances of the MocTicketClass and returns them
} 
```

我收到一条错误消息，说这不是一个有效的实现，因为返回类型是 MocRequest 而不是 ITicket。我认为 MocRequest 在这个阶段是 ITicket，事后看来，我想它有点循环，所以它不起作用。返回类型需要是 MocRequest 以便它仍然可以使用。

我已经尝试将界面制作成更像的东西，`ITicket<T>`但是我仍然必须在工厂中指定票证类类型，这会违背目的。

所以这里的目标是在工厂中创建一个可以处理这些东西的静态方法。我这样做对吗？我该如何进行这项工作？还是我仍然坚持使用多种方法来处理它们？TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:27:05.740

`MocRequest`可能是 a `ITicket`，但这不会成为`List<MocRequest>`a `List<ITicket>`。

如果您在预期a 的`List<MocRequest>`地方返回 a，您的 API 用户可能会使用结果列表并添加一个不是 a 的。在这种情况下会怎么做？会坏的，对吧？`List<ITicket>``ITicket``MocRequest``List<MocRequest>`

因此，编译器坚持让你返回一个`List<ITicket>`.

一般来说，不建议返回`List<T>`，因为不清楚您是返回内部内容的副本还是对实际内部列表的引用。最好将返回类型声明为`IEnumerable<ITicket>`，这基本上意味着您只返回票证，而不是可写的列表对象。（您的 API 用户可以自由地将这些票证插入到他/她自己的列表中。）

*有关如何返回枚举的更多信息，我们需要获取有关从数据库获取票证后的外观的更多信息。它们在列表中还是您构建了该列表等？*

# android - 对话框在 ICS 设备上的显示与旧版本不同

> ID：11299010
> 
> 赞同：3
> 
> 时间：2012-07-02T18:17:19.227
> 
> 标签：android, android-dialog

当我在我的 ICS 设备上以横向模式显示一个对话框时，该对话框的显示宽度与它在纵向模式下的宽度相同。

![在此处输入图像描述](../Images/d83becf370b17bc5ff1bb95bbf51dfe1.png)

但是在运行姜饼的设备上，当对话框处于横向模式时，它会显示整个屏幕的宽度，而不是所有内容都紧凑

![在此处输入图像描述](../Images/6bd3fab5464c0cda6cbebfd87db1eaf2.png)

他们是否改变了 ICS 中对话框的显示方式，它不会像第二张图片那样在屏幕上显示？我怎样才能让它像第二张图片一样显示出来，所以它看起来不像第一张那样紧凑？

此应用程序的目标 api 也是 2.2，所以我不能使用任何 ICS api 或任何东西

**编辑**

这就是我调用对话框的方式

```
incDialog = new MessageDialog(this, R.style.FullHeightDialog);
incDialog.PopUpMessage(this, oMessage); 
```

对话框位于扩展对话框的单独类中

这是`PopUpMessage`实际显示对话的方法

```
 public void PopUpMessage(final Context context, clsMessageRecord oMessage) {
    MainActivity.lastMessageClicked = oMessage;
    moCallingContext = context;
    moMessage = oMessage;
    MainActivity.miShownDialogType = DialogID;
    MainActivity.setShownMessage(moMessage);
    MainActivity.mbIntentWasShown = true;
    Log.i(className + "::PopUpMessage", "New Message Dialog Show....");

    if (oMessage != null) {

        if (oMessage.getIsStation() == true) {
            // Incident Message Dialog
            this.setContentView(R.layout.message_st);
            clsStatusRecord oStation = ControlService.DB.StatusList.GetMessageByECM2ID(oMessage.ECM2ID);

            if (oStation != null) {
                if (oStation.AllowMapping()) {
                    ImageButton cmdMapping = (ImageButton) this.findViewById(R.id.cmdMapping);
                    cmdMapping.setVisibility(ImageButton.VISIBLE);
                    cmdMapping.setOnClickListener(new View.OnClickListener() {
                        public void onClick(View view) {
                            MainActivity.loaded = false;
                            HandleMapping();
                        }
                    });
                } else {
                    ImageButton cmdMapping = (ImageButton) this.findViewById(R.id.cmdMapping);
                    cmdMapping.setVisibility(ImageButton.GONE);
                }

                if (oStation.IsChief()) {
                    ImageButton cmdChief = (ImageButton) this.findViewById(R.id.cmdChiefList);
                    cmdChief.setVisibility(ImageButton.VISIBLE);
                    cmdChief.setOnClickListener(new View.OnClickListener() {
                        public void onClick(View view) {
                            MainActivity.loaded = false;
                            handleResponders();
                        }
                    });
                } else {
                    ImageButton cmdChief = (ImageButton) this.findViewById(R.id.cmdChiefList);
                    cmdChief.setVisibility(ImageButton.GONE);
                }
            }

            mStationID = moMessage.ECM2ID;
            mMessageID = moMessage.MessageID;

            TextView txtHeader = (TextView) this.findViewById(R.id.txtDialogHeader);
            TextView txtTOC = (TextView) this.findViewById(R.id.txtDialogTOC);
            TextView txtMessage = (TextView) this.findViewById(R.id.lblMessage);

            txtHeader.setText(oMessage.ECM2Name);
            txtTOC.setText(oMessage.TOC);
            txtMessage.setText(oMessage.MessageText);

            if(oMessage.MessageText.toUpperCase().startsWith("UPDATE")) {

                ImageButton cmdResp = (ImageButton) this.findViewById(R.id.cmdResponding);
                cmdResp.setEnabled(false);
                cmdResp.setImageResource(R.drawable.responding_disabled);

                ImageButton cmdDecl = (ImageButton) this.findViewById(R.id.cmdDeclining);
                cmdDecl.setEnabled(false);
                cmdDecl.setImageResource(R.drawable.declining_disabled);

                ImageButton cmdChief = (ImageButton) this.findViewById(R.id.cmdChiefList);
                cmdChief.setEnabled(false);
                cmdChief.setImageResource(R.drawable.chief_disabled);
            }

            ImageView imgIcon = (ImageView) this.findViewById(R.id.imgIcon);

            switch (oMessage.State) {
            case etMSNewMessage:
                imgIcon.setBackgroundDrawable(context.getResources().getDrawable(imgSTNew));
                break;

            case etMSResponded:
                imgIcon.setBackgroundDrawable(context.getResources().getDrawable(imgSTResponded));
                break;

            case etMSDeclined:
                imgIcon.setBackgroundDrawable(context.getResources().getDrawable(imgSTUnavailable));
                break;
            }

            Button cmdExit = (Button) this.findViewById(R.id.cmdExit);
            cmdExit.setOnClickListener(new View.OnClickListener() {
                public void onClick(View v) {
                    MainActivity.messageShown=false;
                    ClosePopup();
                }
            });

            ImageButton cmdDeclining = (ImageButton) this.findViewById(R.id.cmdDeclining);
            cmdDeclining.setOnClickListener(new View.OnClickListener() {
                public void onClick(View v) {
                    HandleDeclining(context);
                }
            });

            ImageButton cmdResponding = (ImageButton) this.findViewById(R.id.cmdResponding);
            cmdResponding.setOnClickListener(new View.OnClickListener() {
                public void onClick(View v) {
                    HandleResponding(context);
                }
            });

            Log.e(className + "::PopUpMessage", "Message View Shown (Incident)");
            this.show();
        } else {

            // Distribution List Dialog
            this.setContentView(R.layout.message_dl);

            Log.e(className + "::PopUpMessage", "Message Content Filling (Dist)");
            TextView txtHeader = (TextView) this.findViewById(R.id.txtDialogHeader);
            TextView txtTOC = (TextView) this.findViewById(R.id.txtDialogTOC);
            TextView txtMessage = (TextView) this.findViewById(R.id.lblMessage);

            txtHeader.setText(oMessage.ECM2Name);
            txtTOC.setText(oMessage.TOC);
            txtMessage.setText(oMessage.MessageText);

            ImageView imgIcon = (ImageView) this.findViewById(R.id.imgIcon);
            imgIcon.setBackgroundDrawable(context.getResources().getDrawable(imgDLRead));

            Button cmdExit = (Button) this.findViewById(R.id.cmdExit);
            cmdExit.setOnClickListener(new View.OnClickListener() {
                public void onClick(View v) {
                    MainActivity.messageShown=false;
                    MainActivity.disMessageShown=false;
                    HandleCancel();
                    messageType = false;
                }
            });

            ImageButton cmdReplyToSender = (ImageButton) this.findViewById(R.id.cmdReplyToSender);
            cmdReplyToSender.setOnClickListener(new View.OnClickListener() {
                public void onClick(View v) {
                    HandleReplyToSender();
                }
            });

            clsStatusRecord oRec = oMessage.GetStatusRecord();

            if (oRec != null) {
                ImageButton cmdReplyToDL = (ImageButton) this.findViewById(R.id.cmdReplyToDL);
                if (oRec.AllowWrite()) {
//                      ImageButton cmdReplyToDL = (ImageButton) this.findViewById(R.id.cmdReplyToDL);
                    cmdReplyToDL.setOnClickListener(new View.OnClickListener() {
                        public void onClick(View v) {
                            HandleReplyToDL();
                        }
                    });
                }else{
                    cmdReplyToDL.setEnabled(false);
                    cmdReplyToDL.setImageResource(R.drawable.replytodistlist_up_disabled);
                }
            }
            Log.e(className + "::PopUpMessage", "Message View Shown (Dist)");
            messageType = true;
            this.show();
        }
    } else {
    }
} 
```

这是xml布局

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/layout_root"              
android:orientation="vertical"
android:layout_height="match_parent"
android:padding="2dip" android:paddingTop="2dip" android:layout_width="fill_parent">

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_height="match_parent"
    android:padding="0dip" android:layout_width="fill_parent">

    <RelativeLayout
        android:id="@+id/contentLayout2" 
        android:orientation="vertical" 
        android:padding="0dip" 
        android:layout_height="wrap_content"
        android:layout_gravity="top|left"
        android:background="#000000"
        android:layout_weight="0" android:layout_width="fill_parent">   

        <ImageView 
            android:id="@+id/imgIcon" 
            android:layout_height="wrap_content" 
            android:layout_width="wrap_content"
            android:layout_gravity="top|left" android:contentDescription="@string/desc">
        </ImageView>

        <TextView 
            android:layout_height="wrap_content" 
            android:text="" 
            android:id="@+id/txtDialogHeader" 
            android:layout_width="match_parent" 
            android:textStyle="bold" 
            android:layout_toRightOf="@id/imgIcon"
            android:paddingLeft="5dip" android:textColor="#ff2525" android:textSize="18dip">
        </TextView>

        <TextView 
            android:layout_height="wrap_content" 
            android:text="" 
            android:id="@+id/txtDialogTOC" 
            android:layout_width="match_parent" 
            android:layout_toRightOf="@id/imgIcon"
            android:layout_below="@id/txtDialogHeader"
            android:paddingLeft="5dip" android:textSize="19dip" android:textStyle="bold">
        </TextView>

    </RelativeLayout>

    <ScrollView    
        android:id="@+id/scrollMessageFrame"  
        android:layout_height="match_parent" 
        android:padding="0dip"
        android:background="#AA0000"
        android:layout_weight="1" android:layout_width="fill_parent">

        <TextView 
            android:layout_height="wrap_content" 
            android:layout_width="match_parent" 
            android:text="" 
            android:id="@+id/lblMessage"  
            android:padding="5dip"
            android:background="#000000"
            android:minHeight="140dip" android:textColor="#f2f2f2" android:textSize="20dip">
        </TextView>

    </ScrollView> 

    <RelativeLayout
        android:id="@+id/contentLayout3" 
        android:orientation="vertical" 
        android:background="#000000" 
        android:layout_height="wrap_content"
        android:layout_gravity="bottom|center_horizontal" android:gravity="center_horizontal" android:layout_width="match_parent">

        <ImageButton
            android:id="@+id/cmdResponding"
            android:layout_width="62dip"
            android:layout_height="62dip"
            android:layout_marginRight="10dip"
            android:contentDescription="@string/desc"
            android:src="@drawable/responding_ref" android:background="@drawable/responding_up" android:layout_marginTop="5dip" android:layout_marginLeft="5dip">
</ImageButton>
        <ImageButton android:id="@+id/cmdDeclining" android:src="@drawable/declining_ref" android:background="@drawable/declining_up" android:layout_alignTop="@+id/cmdResponding" android:layout_alignBottom="@+id/cmdResponding" android:layout_height="62dip" android:layout_width="62dip" android:layout_marginLeft="3dip" android:layout_toRightOf="@+id/cmdResponding" android:layout_marginRight="10dip" android:contentDescription="@string/desc"></ImageButton>

        <ImageButton
            android:id="@+id/cmdChiefList"
            android:layout_width="62dip"
            android:layout_height="62dip"
            android:layout_toRightOf="@+id/cmdDeclining" android:background="@drawable/chief_up" android:layout_marginRight="10dip" android:src="@drawable/chief_ref" android:contentDescription="@string/desc" android:layout_marginTop="5dip" android:layout_marginLeft="6dip"/>

        <ImageButton android:id="@+id/cmdMapping" android:background="@drawable/globe_up" android:src="@drawable/mapping_ref" android:layout_height="60dip" android:layout_width="60dip" android:layout_marginLeft="2dip" android:layout_toRightOf="@+id/cmdChiefList" android:layout_marginTop="5dip" android:contentDescription="@string/desc"></ImageButton>

    </RelativeLayout>

</LinearLayout>

<Button 
    android:text="" 
    android:textSize="16dip"
    android:layout_height="40dip" 
    android:layout_width="40dip" 
    android:id="@+id/cmdExit" 
    android:background="@drawable/closepopup"
    android:layout_gravity="top|right" android:contentDescription="@string/desc">
</Button>

</FrameLayout> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-10T07:29:57.350

是的，API 11 面向平板电脑和大屏幕，AlertDialog 旨在不覆盖 Holo 主题中的整个屏幕。它的默认大小取决于屏幕大小（表示为屏幕宽度的百分比宽度）。

目前尚不清楚 MessageDialog 的基类是什么。假设它继承了 AlertDialog，那么主题会设置对话框的大小。

假设清单中有 android:targetSdkVersion>=11，应用程序使用 Theme.Holo.Dialog.Alert 对话框主题，设置 android:windowMinWidthMajor 和 android:windowMinWidthMinor 来指定对话框的宽度。

您可以通过设置 android:targetSdkVersion=10 来解决此问题，或者通过为父主题为 Theme.Holo.Dialog.Alert 的对话框制作和使用自己的主题来解决此问题，并且您将覆盖提到的宽度项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T17:33:53.743

如果您要使用自定义对话框，最好将它们放在 XML 文件中。

在我的自定义对话框中，我使用的是带有 android:layout_width="wrap_content" 的 RelativeLayout，它们可以正确地适应屏幕方向及其内容。

dialog_layout.xml 应如下所示：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android" 
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:background="@drawable/dialog_background"
    android:padding="@dimen/dialog_padding" >

    <TextView
    android:id="@+id/text_view"
    style="@style/WhiteTextLabel"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" 
    android:layout_alignParentTop="true"
    android:text="@string/dialog_text" />

    <LinearLayout
        android:id="@+id/buttons"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/text_view"
        android:orientation="horizontal" >

        <Button
            android:id="@+id/button_cancel" 
            style="@style/RedCancelButton"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="@string/button_cancel" />

        <Button
            android:id="@+id/button_done"
            style="@style/GreenDoneButton"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="@string/button_done" />
    </LinearLayout>
</RelativeLayout> 
```

从 Java 代码膨胀它：

```
final Dialog aDialog = new Dialog(this);
aDialog.requestWindowFeature(Window.FEATURE_LEFT_ICON);
aDialog.setTitle(getString(R.string.dialog_title));
aDialog.setContentView(R.layout.dialog_layout);
aDialog.setFeatureDrawableResource(Window.FEATURE_LEFT_ICON, R.drawable.ic_dialog_icon);
aDialog.setCancelable(true);

final Button buttonDone = (Button) aDialog.findViewById(R.id.button_done);
final Button buttonCancel = (Button) aDialog.findViewById(R.id.button_cancel);

    buttonDone.setOnClickListener(new OnClickListener() {
    public void onClick(View v) {
        // TODO Do something...
        aDialog.cancel();
    }
    });             
    buttonCancel.setOnClickListener(new OnClickListener() {                 
    public void onClick(View v) {
        // Do nothing
        aDialog.cancel();
    }
    });         
aDialog.show(); 
```

我的 minSdkVersion 是 8，targetSdkVersion 是 15。我没有对对话框应用任何主题，但我正在自定义背景（可绘制的形状）、按钮（带有样式）等。对话框的外观和行为在 Froyo 的设备中相同到任何方向的 ICS。

我的 /layout/ 文件夹中只有 1 个 xml...但是您可能希望根据 /layout-land/ 文件夹中的方向进行一些调整，创建另一个同名的 xml。

新的 API 有对话框片段，尽管请参阅[使用对话框片段](http://android-developers.blogspot.com/2012/05/using-dialogfragments.html)，您可能也想看看它们。

我希望这有帮助。祝你好运！

# entity-framework-4.1 - EF：如果断开连接重新连接到数据库

> ID：11299015
> 
> 赞同：0
> 
> 时间：2012-07-02T18:17:37.543
> 
> 标签：entity-framework-4.1

如果连接断开，EF 4.1 中是否有允许重新连接到数据库的内容。如果是这样，EF 是否可以记住尚未提交的内容，然后在重新连接后提交？

如果没有，有没有办法可以针对这种情况进行编程，以免丢失数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T20:12:10.610

在保存更改期间连接断开时，您只会得到异常。整个保存在由于异常而未提交的事务中完成，并且 EF 不会将其当前更改集标记为已完成。您可以简单地尝试再次保存更改 - EF 将尝试打开新连接并执行相同的事务。

# c# - FileIOException，file.length 抛出异常

> ID：11299016
> 
> 赞同：-3
> 
> 时间：2012-07-02T18:17:58.727
> 
> 标签：c#, file-io

我正在使用 C# 创建一个临时文件。

```
public partial class frmResults : Form
{
    public static string caseFile = "";

    private void frmResults_Load(object sender, EventArgs e)
    {
        caseFile = CreateTempFiles();
        FileInfo file = new FileInfo(caseFile + ".rpt");

        if (file.Exists)
        {
            try
            {   
                if (fil.Length < 64000000)
                {
                    richTabular.LoadFile(caseFile + ".rpt", RichTextBoxStreamType.PlainText);
                } 
            }
            catch (IOException io)
            {
                MessageBox.Show(io.GetType().Name);
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public static string CreateTempFiles()
        {
            string sPath;
            caseFile = Path.GetTempFileName();

            sPath = Path.GetTempPath();
            string workDir = sPath + "\\work\\";
            // create work directory
            if (!Directory.Exists(workDir))
            {
                Directory.CreateDirectory(workDir);
            }
            // create temp file name
            int i = 0;
            string tmpfileprefix = workDir + "Rdp";
            string tmpfilename = "";
            do
            {
                i++;
                tmpfilename = tmpfileprefix + i.ToString("D6");
            } while (File.Exists(tmpfilename + ".rpt"));

            caseFile = tmpfilename;
            return caseFile;
        }
    }
} 
```

> `Error:fil.Length = 'fil.Length'``'System.IO.FileNotFoundException'` 引发了类型为无法找到文件的异常 `'C:\Users\sc\AppData\Local\Temp\\work\Rdp000001.rpt'`。

此外，`if (fil.Exists)`返回 false。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T18:20:45.650

错误信息再清楚不过了：

> 错误：fil.Length = 'fil.Length' 引发类型为“System.IO.FileNotFoundException”的异常找不到文件“C:\Users\sc\AppData\Local\Temp\work\Rdp000001.rpt”。

所以......它不是一个有效的 File 对象，但是你调用了一个方法（Length），它需要它，所以抛出了一个异常。您的文件不存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T18:34:17.690

您的`CreateTempFiles`方法仅将文件名返回到尚未创建的临时文件。它在该方法中的任何位置都没有创建文件。此外，在该方法中没有任何地方获取现有文件的名称，因此它始终是一个新文件。但是，如果您真的想要安全，您可以`if(File.Exists(caseFile + ".rpt"))`在检查其长度的位置添加一个检查。

# python - 使用python从redis获取哈希中的最后一项

> ID：11299023
> 
> 赞同：0
> 
> 时间：2012-07-02T18:18:15.403
> 
> 标签：python, redis

使用 redis `hgetall`，将所有项目作为 dict 获取。

我如何获得哈希中的最后五个项目？如果可能的话，不想处理整个字典。

```
dt = cxn.hgetall(k)

lt =[[key, dt[key]]for key in sorted(dt.iterkeys()) ] 
```

以上没有给我一个干净的解决方案，必须`lt` 再次处理。使用 python 2.7

编辑：`hgetall(k) return {'21': 'fooo', '2': 'bar' },`注意键是字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T18:19:30.457

```
>>> dic={'1':100,'2':200,'3':300,'4':400,'5':500,'6':600,'7':700}

>>> print [[str(key), dic[str(key)]]for key in sorted(map(int,dic.iterkeys()))[-5:] ]
[['3', 300], ['4', 400], ['5', 500], ['6', 600], ['7', 700]] 
```

# c# - Console.WriteLine 是 Windows 应用程序的瓶颈吗？

> ID：11299024
> 
> 赞同：8
> 
> 时间：2012-07-02T18:18:16.557
> 
> 标签：c#, wpf, console.writeline

如果我有 WPF 应用程序并且出于调试目的，控制台上会显示一些消息。当应用程序配置为 Windows 应用程序并且没有显示控制台时，这会影响应用程序的性能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-02T19:00:04.337

Console.WriteLine() 的真正瓶颈在于实际写入控制台。这*真的很*昂贵，特别是当控制台需要滚动时。在没有控制台时捕获输出并将其显示在“输出”窗口中的 Visual Studio 托管过程也存在相当大的开销。

部署应用程序后，这两者都不起作用。但是，是的，所有的方法调用都在进行并且字符串正在格式化，它只会在 Windows api 函数发现没有控制台的最后一刻才落入位桶中。

如果您的应用程序现在具有可接受的性能，在调试版本中运行时，请不要担心。如果您在没有调试器的情况下在 Release 版本中看到的性能不佳，并且您认为这可能是由 Console.WriteLine() 引起的，那么请不要犹豫，将其搜索 + 替换为 Debug.Print()。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T18:24:16.590

瓶颈意味着它是代码中最慢的点。除非我们知道您在做什么，否则我们无法知道这一点。

是否有任何性能影响，是的，可能。它不是什么都不做，它在*做某事*。是否足以成为您程序的瓶颈，我非常怀疑。是否足以产生明显的影响？有可能，但不太可能。这一切都取决于您的程序正在做什么，以及您向控制台写入了多少（您需要花很多时间才能开始注意到它所花费的时间。）

正如评论中提到的，您可以使用`Debug.WriteLine`而不是`Console.WriteLine`这样您可以在调试时看到输出，但是当您编译 Release 构建时，它不会打印这些语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T18:28:17.583

做某事总是比什么都不做要花更长的时间。

将文本写入空控制台的行为不应该对性能造成重大影响，但您作为参数传入的内容以及数量可能是什么。

在使用和不使用控制台输出的情况下测量实际性能，以亲自查看您的使用模式是否在可接受的容差范围内。

根据您的要求，Debug.WriteLine() 可能是一个更好的选择，因为当您为 Release 构建时，这些将被自动排除。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T20:00:35.400

尝试构建和优化自己的日志框架很少是最好的方法。

你看过像log4net这样的东西吗？您可以配置各种附加程序，包括登录到控制台。您还可以构建异步附加程序以真正减少日志记录开销。

埃里克

# javascript - 多个鼠标悬停事件

> ID：11299029
> 
> 赞同：0
> 
> 时间：2012-07-02T18:18:28.130
> 
> 标签：javascript, html, css

我有一堆翻转，当你翻转它们时，它们会在子弹上方显示数字。我希望数字在 onmouseout 上消失，但在下一次 onmousedown 之前一直保持在 onmousedown 上。有没有比给每个号码自己的 id 并打开和关闭它更简单的方法？我希望这是有道理的？！？12

谢谢！

CSS

```
#numbers1, #numbers2, #numbers3, #numbers4 {
font-family: Arial, Helvetica, sans-serif;
font-size: 9px;
color: #6e6965;
margin: -10px 0 0 2px;
position: absolute;
display:none;
} 
```

HTML

```
<span onmouseover="document.rollimg.src=image1.src; document.getElementById('numbers1').style.display = 'inline';">
<a class="bullet"><div id="numbers1">1</div></a></span>

<span onmouseover="document.rollimg.src=image2.src; document.getElementById('numbers2').style.display = 'inline';" 
<a class="bullet"><div id="numbers2">2</div></a></span>

<span onmouseover="document.rollimg.src=image3.src; document.getElementById('numbers3').style.display = 'inline';" 
<a class="bullet"><div id="numbers3">3</div></a></span>

<span onmouseover="document.rollimg.src=image4.src; document.getElementById('numbers4').style.display = 'inline';" 
<a class="bullet"><div id="numbers4">4</div></a></span> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T22:25:46.127

您可以使用 CSS 来做到这一点，`:hover`而且`:focus`- 不需要 JavaScript。

```
a div {
    display:none;
}

a:hover div, a:focus div {
    display: block;
}

a:focus {
    outline: none;
} 
```

为了使`:focus`选择器正常工作，您还需要`tabindex`在每个`a`元素上添加一个；我建议`tabindex="-1"`（这是一个 HTML 属性）。当然，您还需要将其限制为特定`a`元素，而不是页面上的所有链接。

jsFiddle：http: [//jsfiddle.net/c4yq5/](http://jsfiddle.net/c4yq5/)

jsFiddle 基于来自问题的代码：http: [//jsfiddle.net/FpSgW/1/](http://jsfiddle.net/FpSgW/1/)

# c++ - RAII 类的通用命名约定是什么？

> ID：11299031
> 
> 赞同：7
> 
> 时间：2012-07-02T18:18:36.260
> 
> 标签：c++, naming-conventions, raii

在 C++ 中，当使用资源获取即初始化 (RAII) 模式时，是否有任何通用的类命名约定？

就我而言，我的类可以执行以下类型的操作，并且我想要在第一次阅读堆栈时看到其中一个时可能会调用有用含义的名称：

*   抑制日志记录的类（可以嵌套）。
*   一个放置观察者的类。
*   记录当前线程正在处理的当前对象的类。
*   除了基类行为（在前一行）之外，一个派生类来处理对象。

作为第一次剪辑，我使用了这样的名称（按照上面的相应顺序），但希望改进它们：

*   类 SuppressLogger
*   ScopedObserver 类
*   类 WithCurrentObject
*   类 WithObjectProcessed : 公共 WithCurrentObject

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-02T18:27:10.797

整个语言都应使用 RAII。由于它应该是默认值，因此没有要遵循的命名约定。

# php - 在主机服务器上加载并重新启动服务器

> ID：11299034
> 
> 赞同：2
> 
> 时间：2012-07-02T18:18:43.530
> 
> 标签：php, mysql, sql

我的网络托管服务与我网站的 SQL 查询有问题。显然 SQL 查询导致服务器重新启动。一段时间后，它会自动重新启动服务器，我可以看到我的网站。

我的 SQL 查询的负载会影响服务器吗？

如果您查看我的网站[www.websofindia.com](http://www.websofindia.com)，它非常好，而且速度如此之快。那么问题出在哪里？

谷歌分析显示我的用户每天有 600 到 700 多个。我的 PHP 版本是 5.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:20:29.183

向您的主机询问崩溃时来自服务器的 mysql 慢查询日志或错误日志 (hostname.err) 的副本。

如果他们不知道这些是什么，或者不能生产它们，您可能应该寻找另一个主机。

# vb.net - 将数据库中的数据加载到 Web 表单中

> ID：11299036
> 
> 赞同：1
> 
> 时间：2012-07-02T18:18:54.093
> 
> 标签：vb.net, webforms, postback, vb.net-2010

我正在创建一个两步 Web 表单。第一步是初始创建应用程序（例如申请某物，而不是程序），第二步是允许用户修改/重新提交此应用程序。

来自原始应用程序提交的数据正在被传送到数据库，并且正在按预期工作。当用户去更新他们的应用程序时，数据库中的数据应该被加载到允许编辑/审查的在线表单中。目前，我知道数据被带入应用程序变量，但表单没有显示正在加载的数据。

该表单包括文本框以及复选框列表。

我对回发一无所知，我只创建了可以创建对象（例如对象）的本地网络表单`user`，但由于预编译错误，这是不可能的。

我使用的语言是 VB.NET

任何援助将不胜感激。

编辑：代码

什么开始连接：

```
Protected Sub btnLoad_Click(sender As Object, e As System.EventArgs) Handles btnLoad.Click

    business_name = txtName.Text

    dbConnect()
    dbGet()
    dbDisconnect()
End Sub 
```

数据库连接字符串：

```
Public Sub dbConnect()
    connection = New SqlConnection("Server=localhost;Database=greenapplication;Trusted_Connection=True")
    connection.Open()
End Sub

Public Sub dbGet()
    general_read = New SqlCommand("SELECT * FROM general WHERE Business_Name = '" & business_name & "';", connection)
    energy_read = New SqlCommand("SELECT * FROM energy WHERE ApplicationID = '" & AppID & "';", connection)
    purchasing_read = New SqlCommand("SELECT * FROM purchasing WHERE ApplicationID = '" & AppID & "';", connection)
    recycling_read = New SqlCommand("SELECT * FROM recycling WHERE ApplicationID = '" & AppID & "';", connection)
    transportation_read = New SqlCommand("SELECT * FROM transportation WHERE ApplicationID = '" & AppID & "';", connection)
    social_read = New SqlCommand("SELECT * FROM social WHERE ApplicationID = '" & AppID & "';", connection)
    waste_read = New SqlCommand("SELECT * FROM waste WHERE ApplicationID = '" & AppID & "';", connection)
    water_read = New SqlCommand("SELECT * FROM water WHERE ApplicationID = '" & AppID & "';", connection)

    PostBackTrigger()
    form_load()

End Sub

Public Sub dbDisconnect()
    connection.Close()
End Sub 
```

回发触发器：

```
Private Sub PostBackTrigger()
    'Throw New NotImplementedException
    generalReader = general_read.ExecuteReader
    While generalReader.Read
        AppID = generalReader.GetValue(generalReader.GetOrdinal("ApplicationID"))
        business_name = generalReader.GetValue(generalReader.GetOrdinal("Business_Name"))
        website = generalReader.GetValue(generalReader.GetOrdinal("Website"))
        description = generalReader.GetValue(generalReader.GetOrdinal("Description"))
        contact = generalReader.GetValue(generalReader.GetOrdinal("Contact"))
        enter_title = generalReader.GetValue(generalReader.GetOrdinal("Title"))
        phone = generalReader.GetValue(generalReader.GetOrdinal("Phone"))
        e_mail = generalReader.GetValue(generalReader.GetOrdinal("E_Mail"))
        street = generalReader.GetValue(generalReader.GetOrdinal("Street"))
        num_employees = generalReader.GetValue(generalReader.GetOrdinal("Num_Employees"))
        own_lease = generalReader.GetValue(generalReader.GetOrdinal("Own_Lease"))
        certs = generalReader.GetValue(generalReader.GetOrdinal("Certifications"))
        category = generalReader.GetValue(generalReader.GetOrdinal("Business_Category"))
    End While
    generalReader.Close()

    energyReader = energy_read.ExecuteReader
    While energyReader.Read
        track_usage = energyReader.GetValue(energyReader.GetOrdinal("usage"))
        develop_strategy = energyReader.GetValue(energyReader.GetOrdinal("policy"))
        perform_audit = energyReader.GetValue(energyReader.GetOrdinal("audit"))
        replace_bulbs = energyReader.GetValue(energyReader.GetOrdinal("lighting"))
        reduce_lighting = energyReader.GetValue(energyReader.GetOrdinal("over_lighting"))
        lighting_controls = energyReader.GetValue(energyReader.GetOrdinal("controls"))
        not_in_use_policy = energyReader.GetValue(energyReader.GetOrdinal("turn_off"))
        energy_star = energyReader.GetValue(energyReader.GetOrdinal("energy_star"))
        weatherize = energyReader.GetValue(energyReader.GetOrdinal("weatherize"))
        program_thermo = energyReader.GetValue(energyReader.GetOrdinal("thermostat"))
        natural_light = energyReader.GetValue(energyReader.GetOrdinal("natural_light"))
        air_quality = energyReader.GetValue(energyReader.GetOrdinal("air"))
        site_assessment = energyReader.GetValue(energyReader.GetOrdinal("renewable_assessment"))
        renewable_power = energyReader.GetValue(energyReader.GetOrdinal("on_site_renewable"))
        HVAC = energyReader.GetValue(energyReader.GetOrdinal("HVAC"))
        renewable_energy = energyReader.GetValue(energyReader.GetOrdinal("renewable_power"))
        energy_programs = energyReader.GetValue(energyReader.GetOrdinal("efficient_enroll"))
        energy_certification = energyReader.GetValue(energyReader.GetOrdinal("efficient_attain"))
        energy_other = energyReader.GetValue(energyReader.GetOrdinal("other"))
    End While
    energyReader.Close()

    purchasingReader = purchasing_read.ExecuteReader
    While purchasingReader.Read
        sustainable_policy = purchasingReader.GetValue(purchasingReader.GetOrdinal("policy"))
        office_paper = purchasingReader.GetValue(purchasingReader.GetOrdinal("paper"))
        maintenance = purchasingReader.GetValue(purchasingReader.GetOrdinal("maintenance"))
        ink_toner_purchase = purchasingReader.GetValue(purchasingReader.GetOrdinal("ink_toner"))
        food_container = purchasingReader.GetValue(purchasingReader.GetOrdinal("food"))
        office_stuff = purchasingReader.GetValue(purchasingReader.GetOrdinal("used_stuffs"))
        unwanted_stuff = purchasingReader.GetValue(purchasingReader.GetOrdinal("unwanted_stuffs"))
        green_vendors = purchasingReader.GetValue(purchasingReader.GetOrdinal("venders"))
        green_businesses = purchasingReader.GetValue(purchasingReader.GetOrdinal("purchase_venders"))
        purchasing_other = purchasingReader.GetValue(purchasingReader.GetOrdinal("other"))
    End While
    purchasingReader.Close()

    recyclingReader = recycling_read.ExecuteReader
    While recyclingReader.Read
        recycle_stuff = recyclingReader.GetValue(recyclingReader.GetOrdinal("law"))
        recycle_batteries = recyclingReader.GetValue(recyclingReader.GetOrdinal("batteries"))
        clean_sweep = recyclingReader.GetValue(recyclingReader.GetOrdinal("sweep"))
        recycle_banned = recyclingReader.GetValue(recyclingReader.GetOrdinal("non_landfill"))
        recycle_pharma = recyclingReader.GetValue(recyclingReader.GetOrdinal("pharma"))
        recycle_electronics = recyclingReader.GetValue(recyclingReader.GetOrdinal("e_waste"))
        recycle_package = recyclingReader.GetValue(recyclingReader.GetOrdinal("packaging"))
        ink_toner_recycle = recyclingReader.GetValue(recyclingReader.GetOrdinal("toner_ink"))
        compost = recyclingReader.GetValue(recyclingReader.GetOrdinal("compost"))
        recycling_other = recyclingReader.GetValue(recyclingReader.GetOrdinal("other"))
    End While
    recyclingReader.Close()

    transportationReader = transportation_read.ExecuteReader
    While transportationReader.Read
        teleconference = transportationReader.GetValue(transportationReader.GetOrdinal("teleconference"))
        non_idling = transportationReader.GetValue(transportationReader.GetOrdinal("non_idling"))
        flexible_schedule = transportationReader.GetValue(transportationReader.GetOrdinal("flex"))
        bike_shower = transportationReader.GetValue(transportationReader.GetOrdinal("bike_shower"))
        space_buy_out = transportationReader.GetValue(transportationReader.GetOrdinal("public_trans"))
        preferred_parking = transportationReader.GetValue(transportationReader.GetOrdinal("carpool_hybrid"))
        regular_tune_up = transportationReader.GetValue(transportationReader.GetOrdinal("tune_ups"))
        hybrid_alternative = transportationReader.GetValue(transportationReader.GetOrdinal("hybrid_alt"))
        bus_bike_route = transportationReader.GetValue(transportationReader.GetOrdinal("bus_bike"))
        fuel_efficiencies = transportationReader.GetValue(transportationReader.GetOrdinal("fuel_efficient"))
        grease_oil = transportationReader.GetValue(transportationReader.GetOrdinal("grease"))
        transportation_other = transportationReader.GetValue(transportationReader.GetOrdinal("other"))
    End While
    transportationReader.Close()

    socialReader = social_read.ExecuteReader
    While socialReader.Read
        healthy_environment = socialReader.GetValue(socialReader.GetOrdinal("health"))
        prevention_programs = socialReader.GetValue(socialReader.GetOrdinal("prevention"))
        volunteer = socialReader.GetValue(socialReader.GetOrdinal("volunteer"))
        carbon_footprint = socialReader.GetValue(socialReader.GetOrdinal("carbon"))
        charitable_organizations = socialReader.GetValue(socialReader.GetOrdinal("charity"))
        social_other = socialReader.GetValue(socialReader.GetOrdinal("other"))
    End While
    socialReader.Close()

    wasteReader = waste_read.ExecuteReader
    While wasteReader.Read
        printing = wasteReader.GetValue(wasteReader.GetOrdinal("paper"))
        bulk_duplicate_mailing = wasteReader.GetValue(wasteReader.GetOrdinal("mail"))
        printed_comms = wasteReader.GetValue(wasteReader.GetOrdinal("marketing"))
        packaging = wasteReader.GetValue(wasteReader.GetOrdinal("operations"))
        bags_containers = wasteReader.GetValue(wasteReader.GetOrdinal("containers"))
        track_waste = wasteReader.GetValue(wasteReader.GetOrdinal("reduction"))
        resuable_products = wasteReader.GetValue(wasteReader.GetOrdinal("products"))
        waste_other = wasteReader.GetValue(wasteReader.GetOrdinal("other"))
    End While
    wasteReader.Close()

    waterReader = water_read.ExecuteReader
    While waterReader.Read
        aerators_shut_off = waterReader.GetValue(waterReader.GetOrdinal("aerators"))
        low_flow = waterReader.GetValue(waterReader.GetOrdinal("devices"))
        pre_rinse = waterReader.GetValue(waterReader.GetOrdinal("pre_rinse"))
        leaks = waterReader.GetValue(waterReader.GetOrdinal("leaks"))
        landscaping = waterReader.GetValue(waterReader.GetOrdinal("vegitation"))
        broom = waterReader.GetValue(waterReader.GetOrdinal("broom"))
        sink_water = waterReader.GetValue(waterReader.GetOrdinal("sink_water"))
        storm_water = waterReader.GetValue(waterReader.GetOrdinal("storm_water"))
        water_assessment = waterReader.GetValue(waterReader.GetOrdinal("water_assessment"))
        irrigation = waterReader.GetValue(waterReader.GetOrdinal("irrigation"))
        fertilize = waterReader.GetValue(waterReader.GetOrdinal("fertilize"))
        ice_melt = waterReader.GetValue(waterReader.GetOrdinal("ice_melt"))
        water_other = waterReader.GetValue(waterReader.GetOrdinal("other"))
    End While
    waterReader.Close()
End Sub 
```

我试过使用一个`Business`对象，但这给了我一个关于预编译的浏览器错误，我也尝试了上面看到的，我能描述的最好的是回发，但我觉得我错过了一些东西。

编辑：添加了 formLoad() 子

```
Public Sub form_load()
    txtName.Text = business_name
    txtWebsite.Text = website
    txtDescription.Text = description
    txtContact.Text = contact
    txtTitle.Text = enter_title
    txtPhone.Text = phone
    txtEmail.Text = e_mail
    txtMailing.Text = street
    txtEmployees.Text = num_employees
    ddlOwnRent.SelectedValue = own_lease
    txtCerts.Text = certs

    Select Case category
        Case "Amusement & Entertainment"
            rblCategory.SelectedValue = "Amusement & Entertainment"
        Case "Apartments"
            rblCategory.SelectedValue = "Apartments"
        Case "Automotive"
            rblCategory.SelectedValue = "Automotive"
        Case "Computer, Internet, Telecom"
            rblCategory.SelectedValue = "Computer, Internet, Telecom"
        Case "Construction"
            rblCategory.SelectedValue = "Construction"
        Case "Diversified"
            rblCategory.SelectedValue = "Diversified"
        Case "Financial: banks & credit unions"
            rblCategory.SelectedValue = "Financial: banks & credit unions"
        Case "Health Care"
            rblCategory.SelectedValue = "Health Care"
        Case "Hotel / Motel"
            rblCategory.SelectedValue = "Hotel / Motel"
        Case "Insurance"
            rblCategory.SelectedValue = "Insurance"
        Case "Manufacturing"
            rblCategory.SelectedValue = "Manufacturing"
        Case "Professional"
            rblCategory.SelectedValue = "Professional"
        Case "Public Utilites"
            rblCategory.SelectedValue = "Public Utilites"
        Case "Publishers / Printers"
            rblCategory.SelectedValue = "Publishers / Printers"
        Case "Radio / Television"
            rblCategory.SelectedValue = "Radio / Television"
        Case "Real Estate"
            rblCategory.SelectedValue = "Real Estate"
        Case "Retail"
            rblCategory.SelectedValue = "Retail"
        Case "Services"
            rblCategory.SelectedValue = "Services"
        Case "Transportation"
            rblCategory.SelectedValue = "Transportation"
        Case "Wholesale / Distribution"
            rblCategory.SelectedValue = "Wholesale / Distribution"
        Case Else
            rblCategory.SelectedValue = "Other"
            txtOther.Visible = True
            txtOther.Text = category
    End Select

    cblEnergy.Items.FindByValue(1).Selected = track_usage
    cblEnergy.Items.FindByValue(2).Selected = develop_strategy
    cblEnergy.Items.FindByValue(3).Selected = perform_audit
    cblEnergy.Items.FindByValue(4).Selected = replace_bulbs
    cblEnergy.Items.FindByValue(5).Selected = reduce_lighting
    cblEnergy.Items.FindByValue(6).Selected = lighting_controls
    cblEnergy.Items.FindByValue(7).Selected = not_in_use_policy
    cblEnergy.Items.FindByValue(8).Selected = energy_star
    cblEnergy.Items.FindByValue(9).Selected = weatherize
    cblEnergy.Items.FindByValue(10).Selected = program_thermo
    cblEnergy.Items.FindByValue(11).Selected = natural_light
    cblEnergy.Items.FindByValue(12).Selected = air_quality
    cblEnergy.Items.FindByValue(13).Selected = site_assessment
    cblEnergy.Items.FindByValue(14).Selected = renewable_power
    cblEnergy.Items.FindByValue(15).Selected = HVAC
    cblEnergy.Items.FindByValue(16).Selected = renewable_energy
    cblEnergy.Items.FindByValue(17).Selected = energy_programs
    cblEnergy.Items.FindByValue(18).Selected = energy_certification
    cblEnergy.Items.FindByValue(19).Selected = energy_other

    cblPurchasing.Items.FindByValue(1).Selected = sustainable_policy
    cblPurchasing.Items.FindByValue(2).Selected = office_paper
    cblPurchasing.Items.FindByValue(3).Selected = maintenance
    cblPurchasing.Items.FindByValue(4).Selected = ink_toner_purchase
    cblPurchasing.Items.FindByValue(5).Selected = food_container
    cblPurchasing.Items.FindByValue(6).Selected = office_stuff
    cblPurchasing.Items.FindByValue(7).Selected = unwanted_stuff
    cblPurchasing.Items.FindByValue(8).Selected = green_vendors
    cblPurchasing.Items.FindByValue(9).Selected = green_businesses
    cblPurchasing.Items.FindByValue(10).Selected = purchasing_other

    cblRecycling.Items.FindByValue(1).Selected = recycle_stuff
    cblRecycling.Items.FindByValue(2).Selected = recycle_batteries
    cblRecycling.Items.FindByValue(3).Selected = clean_sweep
    cblRecycling.Items.FindByValue(4).Selected = recycle_banned
    cblRecycling.Items.FindByValue(5).Selected = recycle_pharma
    cblRecycling.Items.FindByValue(6).Selected = recycle_electronics
    cblRecycling.Items.FindByValue(7).Selected = recycle_package
    cblRecycling.Items.FindByValue(8).Selected = ink_toner_recycle
    cblRecycling.Items.FindByValue(9).Selected = compost
    cblRecycling.Items.FindByValue(10).Selected = recycling_other

    cblTransportation.Items.FindByValue(1).Selected = teleconference
    cblTransportation.Items.FindByValue(2).Selected = non_idling
    cblTransportation.Items.FindByValue(3).Selected = flexible_schedule
    cblTransportation.Items.FindByValue(4).Selected = bike_shower
    cblTransportation.Items.FindByValue(5).Selected = space_buy_out
    cblTransportation.Items.FindByValue(6).Selected = preferred_parking
    cblTransportation.Items.FindByValue(7).Selected = regular_tune_up
    cblTransportation.Items.FindByValue(8).Selected = hybrid_alternative
    cblTransportation.Items.FindByValue(9).Selected = bus_bike_route
    cblTransportation.Items.FindByValue(10).Selected = fuel_efficiencies
    cblTransportation.Items.FindByValue(11).Selected = grease_oil
    cblTransportation.Items.FindByValue(12).Selected = transportation_other

    cblSocial.Items.FindByValue(1).Selected = healthy_environment
    cblSocial.Items.FindByValue(2).Selected = prevention_programs
    cblSocial.Items.FindByValue(3).Selected = volunteer
    cblSocial.Items.FindByValue(4).Selected = carbon_footprint
    cblSocial.Items.FindByValue(5).Selected = charitable_organizations
    cblSocial.Items.FindByValue(6).Selected = social_other

    cblWaste.Items.FindByValue(1).Selected = printing
    cblWaste.Items.FindByValue(2).Selected = bulk_duplicate_mailing
    cblWaste.Items.FindByValue(3).Selected = printed_comms
    cblWaste.Items.FindByValue(4).Selected = packaging
    cblWaste.Items.FindByValue(5).Selected = bags_containers
    cblWaste.Items.FindByValue(6).Selected = track_waste
    cblWaste.Items.FindByValue(7).Selected = resuable_products
    cblWaste.Items.FindByValue(8).Selected = waste_other

    cblWater.Items.FindByValue(1).Selected = aerators_shut_off
    cblWater.Items.FindByValue(2).Selected = low_flow
    cblWater.Items.FindByValue(3).Selected = pre_rinse
    cblWater.Items.FindByValue(4).Selected = leaks
    cblWater.Items.FindByValue(5).Selected = landscaping
    cblWater.Items.FindByValue(6).Selected = broom
    cblWater.Items.FindByValue(7).Selected = sink_water
    cblWater.Items.FindByValue(8).Selected = storm_water
    cblWater.Items.FindByValue(9).Selected = water_assessment
    cblWater.Items.FindByValue(10).Selected = irrigation
    cblWater.Items.FindByValue(11).Selected = fertilize
    cblWater.Items.FindByValue(12).Selected = ice_melt
    cblWater.Items.FindByValue(13).Selected = water_other
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-25T23:21:31.040

在您调用 PostBackTrigger() 之前不会填充 AppID

```
Public Sub dbGet()
    general_read = New SqlCommand("SELECT * FROM general WHERE Business_Name = '" & business_name & "';", connection)

    GetGeneralData()

    energy_read = New SqlCommand("SELECT * FROM energy WHERE ApplicationID = '" & AppID & "';", connection)
    purchasing_read = New SqlCommand("SELECT * FROM purchasing WHERE ApplicationID = '" & AppID & "';", connection)
    recycling_read = New SqlCommand("SELECT * FROM recycling WHERE ApplicationID = '" & AppID & "';", connection)
    transportation_read = New SqlCommand("SELECT * FROM transportation WHERE ApplicationID = '" & AppID & "';", connection)
    social_read = New SqlCommand("SELECT * FROM social WHERE ApplicationID = '" & AppID & "';", connection)
    waste_read = New SqlCommand("SELECT * FROM waste WHERE ApplicationID = '" & AppID & "';", connection)
    water_read = New SqlCommand("SELECT * FROM water WHERE ApplicationID = '" & AppID & "';", connection)

    PostBackTrigger()
    form_load()

End Sub 
```

首先获取一般数据的新功能

```
Private Sub GetGeneralData()
    generalReader = general_read.ExecuteReader
    While generalReader.Read
        AppID = generalReader.GetValue(generalReader.GetOrdinal("ApplicationID"))
        business_name = generalReader.GetValue(generalReader.GetOrdinal("Business_Name"))
        website = generalReader.GetValue(generalReader.GetOrdinal("Website"))
        description = generalReader.GetValue(generalReader.GetOrdinal("Description"))
        contact = generalReader.GetValue(generalReader.GetOrdinal("Contact"))
        enter_title = generalReader.GetValue(generalReader.GetOrdinal("Title"))
        phone = generalReader.GetValue(generalReader.GetOrdinal("Phone"))
        e_mail = generalReader.GetValue(generalReader.GetOrdinal("E_Mail"))
        street = generalReader.GetValue(generalReader.GetOrdinal("Street"))
        num_employees = generalReader.GetValue(generalReader.GetOrdinal("Num_Employees"))
        own_lease = generalReader.GetValue(generalReader.GetOrdinal("Own_Lease"))
        certs = generalReader.GetValue(generalReader.GetOrdinal("Certifications"))
        category = generalReader.GetValue(generalReader.GetOrdinal("Business_Category"))
    End While
    generalReader.Close()

End Sub 
```

使用这么多变量，此应用程序将非常占用内存。你真的应该在阅读的同时设置你的字段。

```
Private Sub GetGeneralData()
    generalReader = general_read.ExecuteReader
    While generalReader.Read
        AppID = generalReader.GetValue(generalReader.GetOrdinal("ApplicationID"))
        txtName.Text = generalReader.GetValue(generalReader.GetOrdinal("Business_Name"))
        txtWebsite.Text = generalReader.GetValue(generalReader.GetOrdinal("Website"))
        txtDescription.Text = generalReader.GetValue(generalReader.GetOrdinal("Description"))
        txtContact.Text = generalReader.GetValue(generalReader.GetOrdinal("Contact"))
        txtTitle.Text = generalReader.GetValue(generalReader.GetOrdinal("Title"))
        txtPhone.Text = generalReader.GetValue(generalReader.GetOrdinal("Phone"))
        txtEmail.Text = generalReader.GetValue(generalReader.GetOrdinal("E_Mail"))
        txtMailing.Text = generalReader.GetValue(generalReader.GetOrdinal("Street"))
        txtEmployees.Text = generalReader.GetValue(generalReader.GetOrdinal("Num_Employees"))
        ddlOwnRent.SelectedValue = generalReader.GetValue(generalReader.GetOrdinal("Own_Lease"))
        txtCerts.Text = generalReader.GetValue(generalReader.GetOrdinal("Certifications"))
        category = generalReader.GetValue(generalReader.GetOrdinal("Business_Category"))
    End While
    generalReader.Close()

End Sub 
```

# sql - PostgreSQL IF 语句

> ID：11299037
> 
> 赞同：94
> 
> 时间：2012-07-02T18:19:01.767
> 
> 标签：sql, postgresql, if-statement, plpgsql

如何在 Postgres 中进行此类查询？

```
IF (select count(*) from orders) > 0
THEN
  DELETE from orders
ELSE 
  INSERT INTO orders values (1,2,3); 
```

* * *

## 回答 #1

> 赞同：172
> 
> 时间：2012-07-02T19:28:42.140

```
DO
$do$
BEGIN
   IF EXISTS (SELECT FROM orders) THEN
      DELETE FROM orders;
   ELSE
      INSERT INTO orders VALUES (1,2,3);
   END IF;
END
$do$ 
```

标准 SQL 中没有过程元素。该[`IF`语句](https://www.postgresql.org/docs/current/plpgsql-control-structures.html#PLPGSQL-CONDITIONALS)是默认过程语言 PL/pgSQL 的一部分。您需要使用命令创建函数或执行临时语句[`DO`](https://www.postgresql.org/docs/current/sql-do.html)。

您需要`;`在 plpgsql 中每条语句的末尾使用分号 ( )（[最后的除外`END`](https://www.postgresql.org/docs/current/plpgsql-structure.html)）。

您需要`END IF;`在`IF`语句的末尾。

子选择必须用括号括起来：

```
 IF (SELECT count(*) FROM orders) > 0 ... 
```

或者：

```
 IF (SELECT count(*) > 0 FROM orders) ... 
```

不过，这是等效的，而且速度要快得多：

```
 IF EXISTS (SELECT FROM orders) ... 
```

### 选择

`SELECT`不需要额外的。这同样，更快：

```
DO
$do$
BEGIN
   DELETE FROM orders;
   IF NOT FOUND THEN
      INSERT INTO orders VALUES (1,2,3);
   END IF;
END
$do$ 
```

尽管不太可能，写入同一个表的并发事务可能会干扰。绝对可以肯定的是，在按照演示继续之前，将表[写锁定在同一个事务中。](https://www.postgresql.org/docs/current/sql-lock.html)

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2016-05-27T07:01:46.277

如果有人像我一样偶然发现这个问题，只是为了帮助，如果你想在 PostgreSQL 中使用 if，你使用“CASE”

```
select 
    case
        when stage = 1 then 'running'
        when stage = 2 then 'done'
        when stage = 3 then 'stopped'
    else 
        'not running'
    end as run_status from processes 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-11-28T21:28:28.900

[您还可以使用带有匿名代码块](http://www.postgresql.org/docs/current/static/sql-do.html)过程块的 PL/pgSQL CASE 的基本结构：

```
DO $$ BEGIN
    CASE
        WHEN boolean-expression THEN
          statements;
        WHEN boolean-expression THEN
          statements;
        ...
        ELSE
          statements;
    END CASE;
END $$; 
```

参考：

1.  [http://www.postgresql.org/docs/current/static/sql-do.html](http://www.postgresql.org/docs/current/static/sql-do.html)
2.  [https://www.postgresql.org/docs/current/static/plpgsql-control-structures.html](https://www.postgresql.org/docs/current/static/plpgsql-control-structures.html)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-07-02T18:23:09.223

从[文档](http://www.postgresql.org/docs/9.2/static/plpgsql-control-structures.html)

```
IF boolean-expression THEN
    statements
ELSE
    statements
END IF; 
```

因此，在您上面的示例中，代码应如下所示：

```
IF select count(*) from orders > 0
THEN
  DELETE from orders
ELSE 
  INSERT INTO orders values (1,2,3);
END IF; 
```

你错过了：**END IF;**

# php - 如何在 PHP 中将多维数组更改为嵌套数组？

> ID：11299039
> 
> 赞同：2
> 
> 时间：2012-07-02T18:19:11.643
> 
> 标签：php, arrays, multidimensional-array

如何转换以下数组：（假设我不知道数组和键名的深度）

```
$array = array(     
'ycol'=>array('1'=>array( 'name1'=>array('data1',array('a','1'),'data3')),  
'2'=>array('name2'=>array('data1',array('b','2'),'data3')),           
'3'=>array('name3'=>array('data1',array('c','3'),'data3')),           
'4'=>array('name4'=>array('data1',array('d','4'),'data3')),           
'5'=>array('name5'=>array('data1',array('e','5'),'data3'))
); 
```

转换成以下格式：（请告诉我如何使用递归）

```
$array = array(
array('head'=>'name1','head1'=>'data1','o1'=>'a','o2'=>'1','head2'=>'data3'),
array('head'=>'name2','head1'=>'data1','o1'=>'b','o2'=>'2','head2'=>'data3'),
array('head'=>'name3','head1'=>'data1','o1'=>'c','o2'=>'3','head2'=>'data3'),
array('head'=>'name4','head1'=>'data1','o1'=>'d','o2'=>'4','head2'=>'data3'),
array('head'=>'name5','head1'=>'data1','o1'=>'e','o2'=>'5','head2'=>'data3')
); 
```

我是 PHP 新手，需要帮助！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:38:03.043

假设您的语法和深度始终相同，则上述内容可以如下进行混乱。

有更简洁的方法可以做到这一点，但你没有提供任何你试图处理递归的东西。

```
$output = array();
foreach($array['ycol'] as $iteration){
    $head = array_keys($iteration);
    $sub = $head[0];
    $output[] = array(
        'head' => $sub, 
        'head1' => $iteration[$sub][0], 
        'o1' => $iteration[$sub][1][0],
        'o2' => $iteration[$sub][1][1], 
        'head2' => $iteration[$sub][2]
    );
}

$array = $output;

print_r($output); 
```

# python - Google Cloud Sql 的 DB-API Type_Codes：与 MySQLdb 不同？

> ID：11299044
> 
> 赞同：1
> 
> 时间：2012-07-02T18:19:26.640
> 
> 标签：python, google-app-engine, python-2.7, mysql-python, google-cloud-sql

我发现来自 DB-API 的 cursor.description 返回的 type_codes 对于 Google Cloud SQL 与标准 MySQLdb 实现不同。例如：在[MySQLdb (mysqldb-python)](http://mysql-python.sourceforge.net/MySQLdb-1.2.2/public/MySQLdb.constants.FIELD_TYPE-module.html)中，VAR_STRING 为 253，NEWDECIMAL 为 246。但是，当我尝试从 Google Cloud SQL（来自 Google App Engine，使用 Python“rdbms”包）获取这些值时，我得到不同的值：VAR_STRING = 12 和 NEWDECIMAL 是 3。

1) 有谁知道我在哪里可以找到适用于 Google Cloud SQL 的正确 type_code 映射？

2) 更好的是，标准 MySQLdb (mysqldb-python) 实现具有我可以直接在我的 python 代码中使用的[常量。](http://mysql-python.sourceforge.net/MySQLdb-1.2.2/public/MySQLdb.constants.FIELD_TYPE-module.html)这些是否可用于 Google Cloud SQL 的 python 库（即“rdbms”）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-08T00:44:42.167

您现在可以将 MySQLdb 与 Google Cloud SQL 一起使用，因此不再需要使用 rdbms API。

请参阅[https://developers.google.com/appengine/docs/python/cloud-sql/#Python_complete_python_example](https://developers.google.com/appengine/docs/python/cloud-sql/#Python_complete_python_example)

希望这可以帮助，

抢

# c - 在两个不同的进程之间共享 OpenSSL BIO

> ID：11299051
> 
> 赞同：2
> 
> 时间：2012-07-02T18:19:51.627
> 
> 标签：c, sockets, openssl

我目前正在做一些 OpenSSL 编程，我需要创建一个 OpenSSL BIO 并基本上启动与远程服务器的 SSL 连接，然后将该连接传递给另一个进程。我目前计划这样做的方式是将 BIO “打包”到内存缓冲区中并通过套接字发送，因为我需要取消引用 BIO 结构中包含的许多指针，因此不能只是“转换” BIO 到 char * 并发送过去。有谁知道是否有更简单的方法可以做到这一点？我看到有内存 BIO，但在做了一些研究之后，我仍然不清楚它们是否是我需要的......

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:02:39.937

重新设计您的解决方案要容易得多，这样您就不必将新创建的 SSL 套接字传递给另一个工作进程，而是为该进程打开一个常规套接字对。然后，您的 SSL 进程充当代理，在套接字到工作人员和 SSL 套接字之间传递数据。为了获得一些并行性，您可以在 SSL 进程中使用多个线程。

如果您真的想走将 SSL 套接字转移到另一个进程的路径，则需要转移整个 SSL 状态，以便在工作进程中正确初始化加密和解密状态。这意味着您需要了解需要传输 SSL 上下文的哪些部分，以及传输 SSL_SESSION。

# java - Java EE Web 应用防火墙

> ID：11299056
> 
> 赞同：4
> 
> 时间：2012-07-02T18:20:18.337
> 
> 标签：java, security, web-applications, firewall, owasp

我正在寻找一个可以与我的 Java EE Web 应用程序 (WAR) 一起使用的基于规则的 Web 应用程序防火墙 (WAF)。到目前为止，我已经从 OWASP 和 ModSec（用于 Java）中发现了 Stinger。Stinger 较新，但不被认为是成熟的 WAF，我只是对 ModSecurity 持怀疑态度，因为它看起来很旧并且可能已经过时/停产（手册受版权保护 2001 - 2004）。

任何人都可以为 Java EE Web 应用程序推荐一个好的、免费的、开源的 WAF 吗？至少，我需要保护/过滤我的 HTTP/S 标头。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T19:01:12.340

您可以尝试 WebCastellum：

> 基于 Java 的开源 WAF（Web 应用程序防火墙）包含在 Web 应用程序中，以保护其免受 SQL 注入、跨站点脚本 (XSS)、跨站点请求伪造 (CSRF)、参数操作等攻击.

*   网站：[http ://www.webcastellum.org/](http://www.webcastellum.org/)
*   Sourceforge：http: [//sourceforge.net/projects/webcastellum/](http://sourceforge.net/projects/webcastellum/)

# iphone - 更改在 UITableview 中按下的特定按钮的图像

> ID：11299057
> 
> 赞同：2
> 
> 时间：2012-07-02T18:20:19.893
> 
> 标签：iphone, cocoa-touch, uitableview, uibutton, didselectrowatindexpath

我有一个动态表格视图，它有一个带有按钮的原型单元格，按下时会播放一首歌曲。

我希望按钮上的背景图像在用户按下按钮播放歌曲时更改为“停止”图标，并在用户再次按下按钮停止时更改为“播放”图标这首歌。

为此，我一直在尝试使用： `[self.beatPlayButton setBackgroundImage:[UIImageimageNamed:@"play.png"]forState:UIControlStateNormal];`

我的问题是我还没有弄清楚如何只更改正在按下的行中的按钮，因为我正在使用原型单元格。我一直希望找到一种方法，`didSelectObjectAtRow:atIndexPath:`因为`didSelectRowAtIndexPath:`当按下该行时会触发，但不是它上面的按钮（除非我弄错了）。也许我应该使用标签？我不知道。任何指针将不胜感激。

编辑：我的代码在`didSelectRowAtIndexPath`.

这是示例代码 -

```
- (IBAction)playStopBeat:(UIButton*)sender event:(id)event {
    NSSet *touches = [event allTouches];
    UITouch *touch = [touches anyObject];
    CGPoint currentTouchPosition = [touch locationInView:self.tableView];
    NSIndexPath *indexPath = [self.tableView indexPathForRowAtPoint: currentTouchPosition];
    if([self.audioPlayer isPlaying])
    {
        [self.beatPlayButton setBackgroundImage:[UIImage imageNamed:@"play.png"]forState:UIControlStateNormal];
        [self.audioPlayer stop];
        self.isPlaying = NO;
        self.audioPlayer = nil;
    }
    else {

        if (indexPath.row == 0) {
            [self.beatPlayButton setImage:[UIImage imageNamed:@"stop.png"] forState: UIControlStateNormal];
        }
        else if (indexPath.row == 1){
            [self.beatPlayButton setBackgroundImage:[UIImage imageNamed:@"stop.png"]forState:UIControlStateNormal];
        }
        else if (indexPath.row == 2){
...
//code to play song 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T00:02:36.283

使用标签，就像你建议的那样。在您的`cellForRowAtIndexPath`方法中，给每个单元格一个标签：

```
cell.tag = indexPath.row; 
```

还在单元格上设置每个目标：

```
[cell.playButton addTarget:self action:@selector(play:)forControlEvents:UIControlEventTouchUpInside]; 
```

然后在您的播放方法中，将您的标签用于您的数组或 w/e：

```
- (IBAction)play:sender
{
     UITableViewCell *cell = (UITableViewCell *)sender;
     NSLog(@"tag = %d", cell.tag);

     if(tag == 0)
     {
          //you could also use a switch statement 
     } else if(tag == 1) {

     }
} 
```

::编辑:: (回复评论)

要禁用其他按钮，请在您的播放方法中：

```
- (IBAction)play:sender
{
     .........
     ....other code....

     UITableViewCell *cell = (UITableViewCell *)sender;

     for(int i = 0; i < [dataArray count]; i++)
     {
        UITableViewCell *tempCell = [tableView cellForRowAtIndexPath:[NSIndexPath indexPathForRow:i inSection:0]];

        if(tempCell.tag != cell.tag)
        {

            [cell.playButton setEnabled:NO];
        }
     }
} 
```

尽管如此，在歌曲播放完毕后，您必须将它们全部重新设置为启用。这将在 MediaPlayers 委托方法中完成：didFinishPlaying。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-03T00:14:12.190

由于您使用的是目标/操作，因此 sender 参数将包含被点击的按钮。而不是将按钮称为self.beatPlayButton，只需使用sender，所以`[sender setBackgroundImage:[UIImage imageNamed:@"play.png"] forState:UIControlStateNormal];`

# ruby-on-rails - 当我在 SQL 调用的结果中已经拥有了我需要的所有内容时，如何避免再次调用数据库

> ID：11299059
> 
> 赞同：0
> 
> 时间：2012-07-02T18:20:30.207
> 
> 标签：ruby-on-rails, performance, caching, coding-style

在我的应用程序中，我有一个复杂的数据库结构。为了生成调用的 JSON 响应，我需要从许多连接表中获取数据。

我创建了一个 SQL 查询来获取我需要的所有数据（使用 rails' `includes`）。但是，既然我的视图中有结果，我不知道实际渲染它的正确方法是什么。

***一个简化的示例，而不是我的实际代码：***假设我有一个包含包含**任务的****子项目的****项目**，并且查询返回它们所有的一些嵌套结构，根据一些逻辑进行过滤。

 ****```
class Project < ActiveRecord::Base
  ...
  def with_sub_projects_visible_by(user)
    includes(...complex join with sub projects and tasks...)
    .where(...complex condition...)
  end
end 
```

在控制器中，我有这样的东西：

```
 def show
    @project_with_full_details = Project.find(params[:id]).with_sub_projects_visible_by(current_user)
  end 
```

有没有办法编写简单的视图代码来呈现包含所有数据的页面`@project_with_full_details`而无需再次调用数据库？根据我`@project_with_full_details.sub_projects`的尝试，简单地调用并不能解决问题。它调用数据库并获取相关 sub_projects 的完整列表，而不是应该包含在查询结果中的过滤后的列表。

（我使用 RABL 作为我的视图，因为我正在渲染 JSON，但它不太重要，ERB 示例将完全没问题）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:42:18.293

ActiveRecord 为关联提供了一个预加载器，这使得 Rails 只从数据库中加载对象一次（它也发生在加载页面之前）。

对于您的示例，它可能看起来像这样：

```
@project = Project.find(params[:id])
ActiveRecord::Associations::Preloader.new(
  @project, [ :subprojects, subprojects: :tasks]
) 
```

这至少会给您只运行一次 SQL 的预期效果。

如果您的模型看起来像这样：

```
class Project
  has_many :users
  has_many :sub_projects
  has_many :tasks, through: :sub_projects
  ...
end 
```

那么也许你可以定义一个像`subprojects_for(user)`. 然后你应该能够按照以下方式做一些事情：

```
# controller
@project = Project.find(params[:id])
@subprojects = @project.subprojects_for(current_user)

# haml
.project
  = @project.title
  - @project.subprojects_for(current_user).each do |subproject|
    = Something for subprojects...
    - subproject.tasks.each do |task|
      = You get the idea 
```

不过，真正的魔法应该发生在预加载器中。我假设您已经查看了服务器日志以查看 SQL 正在多次运行？****

# php - Netcat - PHP - 获取

> ID：11299064
> 
> 赞同：1
> 
> 时间：2012-07-02T18:20:50.190
> 
> 标签：php, get, netcat

我的 GPS 将我发送到 8081 端口，此日志：

```
$$B130,354660046834688,AAA,35,4.649100,-74.108860,120306065413 
```

我需要用 netcat 收听并将其发送到 PHP

例子：

```
file.php?log=$$B130,354660046834688,AAA,35,4.649100,-74.108860,120306065413 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:29:56.930

您可以通过[`urlencode()`](http://php.net/manual/en/function.urlencode.php)/传递值[`urldecode()`](http://php.net/manual/en/function.urldecode.php)。这将处理发送和接收请求中的任何转码问题。

您是否在问，如何使用 NetCat 收听并发送请求？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T20:29:48.900

我找到了解决方案....不使用 NetCat（显然不可能），答案是：xinetd 和 Php

我解决[了这个教程](http://web.ontuts.com/tutoriales/creando-servicios-de-red-tcp-con-php-y-xinetd/)10分钟就解决了

# iphone - 如何在社交网站上分享我的文字，如表情符号？

> ID：11299067
> 
> 赞同：2
> 
> 时间：2012-07-02T18:21:01.807
> 
> 标签：iphone, social-networking, share

我不会在 tumbler/twitter/Facebook/其他社交网站上分享我的文本（字符串）。

我不知道如何分享。任何人都可以有想法或示例代码吗？

请帮我。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-01T07:32:41.273

如果您想分享表情符号键盘，请在此处查看 [http://www.easyapns.com/blog](http://www.easyapns.com/blog)以及用于分享的社交框架。

```
-(void)openFBController
{

SLComposeViewController *fbController=[SLComposeViewController composeViewControllerForServiceType:SLServiceTypeFacebook];

if ([SLComposeViewController isAvailableForServiceType:SLServiceTypeFacebook] == NO) {
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:nil message:@"This device is not able to Share Facebook or Facebook account is not configured." delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
    [alert show];

}

if([SLComposeViewController isAvailableForServiceType:SLServiceTypeFacebook])
{
    SLComposeViewControllerCompletionHandler __block completionHandler=^(SLComposeViewControllerResult result){

        [fbController dismissViewControllerAnimated:YES completion:nil];

        switch(result){
            case SLComposeViewControllerResultCancelled:
            default:
            {
                NSLog(@"Cancelled.....");

            }
                break;
            case SLComposeViewControllerResultDone:
            {
                NSLog(@"Posted....");

                UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"PeekAboo!" message:@"Post Successfully." delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil, nil];
                [alert show];
            }
                break;
        }};

    [fbController addImage:[UIImage imageNamed:@"@"give ur imagename""]];
    [fbController setInitialText:@"give ur text"];

    [fbController addURL:[NSURL URLWithString:@"give ur url"]];
    [fbController setCompletionHandler:completionHandler];
    [self presentViewController:fbController animated:YES completion:nil];
}

//Note:It doesn't show the old albums list to select in fbController in my account,
//I don't know if thats the case with other people as well.
//After I created and transfered the data from FB to device FB.
//All the albums created afterwards were shown in the list.

}

- (void)canTweetStatus {

SLComposeViewController *TweetStatusController=[SLComposeViewController composeViewControllerForServiceType:SLServiceTypeTwitter];

if ([SLComposeViewController isAvailableForServiceType:SLServiceTypeTwitter] == NO) {
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:nil message:@"This device is not able to Share Twitter or Twitter account is not configured." delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
    [alert show];

}

if([SLComposeViewController isAvailableForServiceType:SLServiceTypeTwitter])
{
    SLComposeViewControllerCompletionHandler __block completionHandler=^(SLComposeViewControllerResult result){

        [TweetStatusController dismissViewControllerAnimated:YES completion:nil];

        switch(result){
            case SLComposeViewControllerResultCancelled:
            default:
            {
                NSLog(@"Cancelled.....");

            }
                break;
            case SLComposeViewControllerResultDone:
            {
                NSLog(@"Posted....");
                UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"PeekAboo!" message:@"Post Successfully." delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil, nil];
                [alert show];
            }
                break;
        }};

    [TweetStatusController addImage:[UIImage imageNamed:@"icon.png"]];
    [TweetStatusController setInitialText:@"give ur text"];
    [TweetStatusController addURL:@"give ur url"]];
    [TweetStatusController setCompletionHandler:completionHandler];
    [self presentViewController:TweetStatusController animated:YES completion:nil];
}

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T18:31:48.113

Facebook 有一个 API，而 Twitter 有一个引擎。查看[https://github.com/mattgemmell/MGTwitterEngine](https://github.com/mattgemmell/MGTwitterEngine)以获取 Twitter。和[https://github.com/facebook/facebook-ios-sdk](https://github.com/facebook/facebook-ios-sdk)用于 facebook。

Stackoverflow 上也有很多关于这个的问题。我建议你在问之前先看看周围。

# c - 在 char *p = 0 之后，指针 p 指向地址 0x0 还是什么都不指向？

> ID：11299071
> 
> 赞同：3
> 
> 时间：2012-07-02T18:21:15.263
> 
> 标签：c

> **可能的重复：**
> [C 中的 NULL 总是为零吗？](https://stackoverflow.com/questions/9894013/is-null-always-zero-in-c)

以下代码：

```
char *p1 = 0;
char *p2 = NULL;
char *p3 = (char *)0;

if (NULL == 0)
    printf("the NULL is same as 0\n");

printf("0 : %s\n", 0);
printf("p1 : %s\n", p1);
printf("p1 : %x\n", p1);
printf("&p1 : %x\n", &p1);

printf("NULL : %s\n", NULL);
printf("p2 : %s\n", p2);
printf("p2 : %x\n", p2);
printf("&p2 : %x\n", &p2);
printf("*p2 : %s\n", *p2); 
```

输出：

```
the NULL is same as 0
0 : (null)
p1 : (null)
p1 : 0
&p1 : bf9a0204
NULL : (null)
p2 : (null)
p2 : 0
&p2 : bf9a0208
Segmentation fault (core dumped) 
```

我想知道：

(null) 代表什么？

指针 p1 或 p2 是否指向地址 0x0？

语句是否 printf("p1 : %x\n", p1); 输出 p1 : 0 表示 p1 指向地址 0x0？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-02T18:25:19.090

所有这些初始化

```
char *p1 = 0;
char *p2 = NULL;
char *p3 = (char *)0; 
```

是等价的。它们都使用类型为 的*空指针值*初始化这些指针`char *`。该空指针值的物理表示取决于平台。不保证用物理`0x0`地址表示。没有办法说他们通常会“指向”什么物理地址。

`0x0`根据输出判断，在您的平台上，空指针值恰好由物理地址表示。但是，打印指针值的正确方法`printf`是使用`%p`格式说明符，或者将指针值转换为合适的整数类型。使用`%x`打印指针会导致未定义的行为。

您看到的`(null)`输出是`printf`对您尝试使用`%s`带有空指针的说明符的反应。这会导致未定义的行为，但您对标准库的实现显然决定让您免于更糟糕的命运并`(null)`改为打印。

事实上，`printf`您的代码示例中的每一条语句的组成都不正确，每条语句都会导致未定义的行为。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-02T18:25:16.850

> (null) 代表什么？

当传递一个空指针值时，它显然是如何`printf()`处理打印字符串的请求的。指针值的标准格式说明符是`%p`

> 指针 p1 或 p2 是否指向地址 0x0？

不必要。它们指向平台上空指针指向的任何位置。

> 语句是否 printf("p1 : %x\n", p1); 输出 p1 : 0 表示 p1 指向地址 0x0？

不，它仅表明空指针值在~~转换为`unsigned int`~~作为指针传递给 printf() 时，但被重新解释为`unsigned int`（这是 %x 所期望的），导致值为零。同样，指针的正确格式说明符是`%p`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T18:46:12.177

NULL**通常**定义为数值 0，通常转换为指针类型（主要是`void *`）。但是，C 标准不保证 NULL 指针为零；有些平台（尤其是奇怪的旧硬件，一些嵌入式系统等）是另一个非法内存地址。

但是，您可以使用空指针进行操作，就好像它始终为零一样。写作`if (pointer)`转换为`if (pointer != NULL)`; 此外，当遇到分配或与指针比较的零值时，大多数编译器将其视为其中包含 NULL 的操作，即使它在技术上非零。

# c# - 在不使用 Round 或 Truncate 的情况下舍入 Double

> ID：11299075
> 
> 赞同：5
> 
> 时间：2012-07-02T18:21:19.020
> 
> 标签：c#, rounding

我被问到以下问题，我不知道如何回答。我想知道是否有人可以提供帮助：

使用 C#，而不使用任何数学函数（不允许使用 Round() 和 Truncate()）取以下双精度 3.009784654 并将其四舍五入到小数点后 4 位。

这是为了面试，不是为了课堂项目或家庭作业。面试官似乎是想让我用mod，但我还是想不出怎么做。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-02T18:24:12.950

截断（因为未指定舍入规则）：乘以 1e4，强制转换为 int，除以 1e4。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T19:25:59.060

这是一个糟糕的面试问题，因为给定预期的工具，该任务通常是不可能的，因为大多数正确的结果都无法表示。也就是说，普通的浮点类型不能准确地表示正确的数学结果 3.0098。所以不可能计算并返回正确的答案。您将不得不使用一些替代机制，例如以不同类型返回值（缩放为整数、字符串、十进制浮点格式等）。

我怀疑面试官可能期待的答案是评估 (int)(x*10000+.5)*.0001。这会缩放该值，以便所需的结果是整数（舍入量 .0001，缩放为 1），添加 0.5，截断为整数，并反转缩放。添加 0.5 和截断的组合几乎等同于舍入，除了它要求 x 为正数、从零开始舍入关系以及存在范围/域问题。可以根据情况和所需的行为对这些进行调整。而且，当然，由于无法表示准确的结果，答案通常略有不正确。

一个更有趣的答案是评估 (x*10000+0x1p52-0x1p52)*.0001。这会缩放值，使用当前浮点舍入模式将其舍入为整数，然后撤消缩放。进行舍入是因为常见的 double 类型在其有效数中有 53 位，因此，当高位的值为 0x1p52 (2 ^(52) ) 时，低位的值为 0x1p0 (2 ⁰，也称为 1)。为了产生加 0x1p52 的结果，必须对有效位进行四舍五入，这是在浮点硬件中自动完成的。然后减去 0x1p52 删除添加的数字，留下四舍五入的值。和以前一样，范围/域有一些警告，并确保编译器执行双精度算术而不是更多，并且可以进行调整。但是，在某些硬件上它比转换为整数并返回要快。

使用 fmod 或字符串转换的性能更差，因为它们需要除法，这在大多数常见处理器上很慢。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-02T18:24:50.143

乘以 10^numberOfDigitsAfterComma，转换为 int，然后返回浮点数并除以 10^...

```
double x = 3.009784654;
x =  ((double)((int)(x * 10000))) / 10000; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-02T18:30:00.190

如果你真的需要mod，你可以这样做：

```
double number = 3.009784654;
double truncatedNumber = number - number % 0.0001; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-02T18:32:49.347

使用 mod 的答案：

```
double d = 1.23456789;
int digitsToKeep = 2;
double divisor = Math.Pow(10, digitsToKeep * -1);
double rounded = d - (d % divisor); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-02T18:48:25.153

如果需要，这也会将数字向上取整。

```
public static double Round(double number, int digits)
{
    for (int i = 0; i < digits; i++)
        number *= 10;

    int whole = (int)number;
    double fraction = number - whole;

    if (fraction >= 0.5)
        whole++;

    number = whole;

    for (int i = 0; i < digits; i++)
        number /= 10.0;

    return number;
} 
```

# jquery - 一个脚本，一旦我在任何东西上点击它，它就会告诉一些东西消失

> ID：11299078
> 
> 赞同：0
> 
> 时间：2012-07-02T18:21:22.970
> 
> 标签：jquery, ajax, show-hide

好的，我在我的网站上有一个表单搜索，单击该搜索结果会将搜索结果加载到显示的隐藏 iframe 中。这是 iframe：

```
<iframe class="slidingDiv" id="frame-content-left2" name="search-box" 
        src="content.html"></iframe> 
```

这是切换显示状态开/关的按钮：

```
<input type="submit" value="Search" class="send-button" /> 
```

现在，当上面的 iframe 显示带有网站导航链接加载到的页面内容的 div 时，它就会消失。这是div：

```
<div id="myDiv">some content here</div> 
```

现在我有一点问题，因为当我单击左侧的导航时，您看不到它加载到的 div，因为它是隐藏的。我想要的是以某种方式告诉带有搜索结果的 iframe，一旦我在链接或空白区域之类的东西上单击它之外就会消失，从而制作这个 div：

```
<div id="myDiv">some content here</div> 
```

再现。

这是我正在使用的代码：

```
<script type="text/javascript">
$(document).ready(function() {

    $('.send-button').click(function() {
        if ($('#frame-content-left2').is(':visible')) {
            $('#frame-content-left2').hide(2000);
            $('#myDiv').show(2000);
        }
        else {
            $('#frame-content-left2').show(2000);
            $('#myDiv').hide(2000);
        }

    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T18:32:00.873

将单击侦听器附加到文档并查看事件的目标。如果目标是应该让 div 出现的东西，让它出现。

```
$(document).click(function(e){
    if(e.target.id !== 'myDiv'){
        $('#myDiv').show();
    }
}); 
```

某种程度的东西将执行您正在寻找的操作。

# coldfusion - 如何在内置网络服务器中设置到远程服务器上资源的虚拟映射？

> ID：11299080
> 
> 赞同：0
> 
> 时间：2012-07-02T18:21:33.123
> 
> 标签：coldfusion, coldfusion-9, jrun

我们的实时设置使用 IIS 和虚拟目录来访问存储在另一台服务器上的图像或 pdf 等内容。我们正在尝试使用内置的网络服务器和 CF9 的开发版来设置类似的东西。

到目前为止，我可以成功地使用 cfdirectory 转储远程源上的文件，我必须像我一样让 CF9 应用服务器登录。

我可以将文件夹从远程服务器复制到我的本地 PC 并将虚拟映射条目添加到 jrun-web.xml 并且工作正常，尽管这对于我们的目的并不理想。

```
<virtual-mapping>
  <resource-path>/login/images/directory/*</resource-path>
  <system-path>C:/Users/[MyUserName]/Desktop/directory</system-path> 
</virtual-mapping> 
```

但是我无法直接映射到该远程服务器。我试过了

```
<virtual-mapping>
  <resource-path>/login/images/directory/*</resource-path>
  <system-path>\\[remoteServer]\images\directory</system-path> 
</virtual-mapping> 
```

和

```
<virtual-mapping>
  <resource-path>/login/images/directory/*</resource-path>
  <system-path>//[remoteServer]/images/directory</system-path> 
</virtual-mapping> 
```

我尝试映射网络驱动器

```
<virtual-mapping>
  <resource-path>/login/images/directory/*</resource-path>
  <system-path>Z:/images/directory</system-path> 
</virtual-mapping> 
```

所有这些都会导致 /login/images/directory/ 内的任何内容出现 404

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T21:23:31.633

在我看来，开发应该反映生产。它避免了出现背书问题。我强烈建议您在 db 中使用 IIS，就像您在现场一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T21:31:50.693

Remember that your Apache server will need to have permissions to this directory. ON a windows box you would run apache as a service with a logon account granted "act as a service" permission. The logon account would need to have access to the unc path in question (\servername\blah\blah).

I also think you should be using the alias syntax as in

Alias /images //servername/project

you might need to use front slashes or escaped back slashes as well (I can't find my example) like either //server/blah or \\server\blah.

Hope this helps.

# r - R的安装目录及.libPath()的使用

> ID：11299083
> 
> 赞同：11
> 
> 时间：2012-07-02T18:21:53.827
> 
> 标签：r

如果我想知道 R 安装了哪个目录，哪个 R 命令能够做到这一点？该`.libPath()`函数获取/设置包所在的位置。这与 R 的安装目录有何不同？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-02T18:25:13.793

你正在寻找`R.home()`. 参见`?R.home`其他用途，例如`R.home("bin")`。

# jquery - jQuery图像交换动画Firefox闪烁

> ID：11299084
> 
> 赞同：0
> 
> 时间：2012-07-02T18:21:58.193
> 
> 标签：jquery, firefox, animation, drag

所以我制作了一个对鼠标拖动做出反应的图像翻书动画。它在 Safari 和 IE 中运行良好，但在 Firefox 中运行良好。当我拖动鼠标时，交换的图像会闪烁。恐怕以某种方式选择`img`or`div`会导致闪烁，所以我关闭了任何可选属性。我什至关闭了拖动，只使用了 x 鼠标位置。它仍然在闪烁。渲染或我的代码是内存问题吗？这些是相当大的图像，例如 800 像素 x 500 像素。

```
(function($){
  $.fn.setframe = function(frame){

  return this.each(function(){
        var $image = $(this);
        function imageName(frame){
            return 'images/inx'+frame+'.png';
        }

       $image.attr('src', imageName(frame));

    });
};
})(jQuery);

$(document).ready(function(){
   var dragDistance = 15;
   var originalX = null;
   var frame = 1;

   $('.cot').mousedown(function(e) {
         e.preventDefault();
         originalX = e.pageX - frame * dragDistance;

         $(document).mousemove(function(e) {
               e.preventDefault();
               frame = Math.floor( ((e.pageX - originalX) / dragDistance) % 35);
               if(frame > 0) {
                     $('img.inx').setframe(frame);
               } else {
                     $('img.inx').setframe(Math.abs(frame+ 35));
               }

         });

   });

   $(this).mouseup(function() {
         $(document).unbind('mousemove');
   });

 }

$('img').live('selectstart dragstart', function(evt){ evt.preventDefault(); return false; });
$('.cot').live('selectstart dragstart', function(evt){ evt.preventDefault(); return false; });
$('img').disableSelection();
$('.cot').disableSelection();

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T18:38:09.660

我重做了动画的方式。不要将图像交换用于大图像，否则您会在某些浏览器上看到图像闪烁。相反，我`hide()`和`show()`层到`animate`.

# applescript - 使用 Applescript 响应咆哮通知

> ID：11299085
> 
> 赞同：1
> 
> 时间：2012-07-02T18:22:00.267
> 
> 标签：applescript, growl, growlnotify

我有一个脚本可以更新我的 SVN 的工作副本并发出咆哮通知。我想做的是，如果我单击通知，则必须在新的查找器窗口中打开特定的查找器位置。仅使用Apple Script就可以实现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T12:42:27.540

看起来并非如此。这将需要 Growl 在特定情况下运行任意 Applescript，并且[他们的文档](http://growl.info/documentation/applescript-support.php)没有显示这种能力。在我看来，唯一合理的选择是在您的初始脚本中添加打开文件夹的能力。

# mysql - MySQL查询超时

> ID：11299087
> 
> 赞同：2
> 
> 时间：2012-07-02T18:22:05.953
> 
> 标签：mysql, timeout

我在使用下面的 SQL 查询时遇到问题……它与我的服务器上的 CPU 挂钩，最终超时而不返回结果。查询的格式看起来没问题吗？

BD

```
SELECT dfa_data_dump.date,
       campaignname,
       placementgroup,
       placementstartdate,
       placementenddate,
       placementgrouptotalbookedunits,
       placementgroupid,
       sitename,
       dfa_data_dump.placementid,
       placement,
       dfa_data_dump.placementrate,
       placement_rates.ratetype,
       placementtotalbookedunits,
       placementsize,
       time_dimension.month,
       Sum(impressionsdelivered),
       Sum(clicksrecorded),
       Sum(totalactivities),
       Sum(totalcost)
FROM   dfa_data_dump
       INNER JOIN time_dimension
               ON time_dimension.date = dfa_data_dump.date
       INNER JOIN placement_rates
               ON placement_rates.placementid = dfa_data_dump.placementid
GROUP  BY dfa_data_dump.date,
          campaignname,
          placementgroup,
          placementgrouptotalbookedunits,
          placementgroupid,
          sitename,
          placementid,
          placement,
          placementrate,
          placementtotalbookedunits,
          placementsize,
          time_dimension.month 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T21:41:42.230

我猜您的查询源自 CGI，然后超时然后终止 mysql 查询。来自 CGI 的直接数据库意味着您的查询必须快速，否则您会遇到这个麻烦。

因此，您要么需要加快速度，要么将提取放入对时间要求不高的后端脚本中。

您可能可以使用索引显着提高性能 - 索引您要加入的列作为开始。这可能足以解决它，下一个是查看您的 GROUP BY 列 - 其中有很多，这可能会伤害您。这在一定程度上取决于您将其分组的数据量，以及那里出现了多少不同的值。

# android - 项目中的 Android 单元测试

> ID：11299088
> 
> 赞同：4
> 
> 时间：2012-07-02T18:22:16.917
> 
> 标签：android, android-build, android-testing

我正在尝试从我的主项目中创建一个 Android 测试项目。完全类似于这个问题[Android: How to use test project within main project](https://stackoverflow.com/questions/6390732/android-how-to-use-test-project-within-main-project)（我试图恢复这个问题，因为这个问题已经过时了，我仍然无法找到答案）。

基本上我想重现 Android 测试的方式。它们实际上只是主项目中的 /tests/ 目录“请参阅链接以了解确切的布局。”

我们想要这样做的主要原因是能够减少项目的数量，因此我们不需要每个项目都有 2 个根文件夹。（又名测试项目和真实项目）。

从那以后，我可以自由地使用任何构建，但我假设 nant 是自动运行测试的方法。

任何帮助都会很棒，谢谢。

编辑：请注意 Eclipse 的问题是不容易提供此选项（至少我还没有找到它）。你可以导航到你想要的目录并创建一个 /tests/ 但它也会带来另一个附加的项目，我在这样做时遇到了一些链接问题。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T13:37:35.453

无法在 Eclipse 中找到此选项。但是，您可以使用命令行工具在您想要的位置构建测试项目。

```
~/android-main-project$ android create test-project -n tests -p ./tests -m ../ 
```

# css - Twitter BootStrap - 将内容向下推的边框

> ID：11299089
> 
> 赞同：5
> 
> 时间：2012-07-02T18:22:28.380
> 
> 标签：css, twitter, twitter-bootstrap

我正在使用页眉、文章和页脚设计一个 HTML 5 站点。我有一篇文章在左右两边都有边框`1px solid black`。这足以导致 12 列换行，迫使我将应用程序的大小缩小到最大 11 列。这会在我想填充的右侧留下一个空白......有没有一种简单的方法可以让 twitter bootstrap 来解释这个额外的 2px？

谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-02T19:25:57.450

这已经回答了（虽然找不到问题）

您必须为内部元素设置边框，而不是跨度本身，因为它们的宽度太窄。

另一种解决方案是`box-sizing`将`border-box`. 但这是 css v3。

## 更新

这里有几个例子，我最好的猜测是第 3 或第 2 解决方案。

*   [演示（jsfiddle）](http://jsfiddle.net/Sherbrow/57d8E/3/)

*   [全屏演示（jsfiddle）](http://jsfiddle.net/Sherbrow/57d8E/3/embedded/result/)

*   [演示响应（jsfiddle）](http://jsfiddle.net/Sherbrow/57d8E/2/)

### 解决方案1：内部

因此，不会很好地响应响应式（需要`@media`根据堆叠设置边框的规则）

```
<div class="row">
    <div class="span3">
        <div class="inner"></div>
    </div>
    <div class="span6">
        <div class="inner"></div>
    </div>
    <div class="span3">
        <div class="inner"></div>
    </div>
</div> 
```

```
.row > [class*="span"]:first-child > .inner {
    border-left: 5px solid red;
}
.row > [class*="span"]:last-child > .inner {
    border-right: 5px solid red;
} 
```

### 解决方案2：流体

因此，将很好地响应响应

```
<div class="row-fluid">
    <div class="inner-fluid clearfix">
        <div class="span3"></div>
        <div class="span6"></div>
        <div class="span3"></div>
    </div>
</div> 
```

```
.row-fluid > .inner-fluid {
    border: 5px none green;
    border-left-style: solid;
    border-right-style: solid;
} 
```

### 解决方案 3：`box-sizing`

因此，不会很好地响应响应式（需要`@media`根据堆叠设置边框的规则）

```
<div class="row foo">
        <div class="span3"></div>
        <div class="span6"></div>
        <div class="span3"></div>
</div> 
```

```
.foo [class*="span"] {
  -webkit-box-sizing: border-box;
     -moz-box-sizing: border-box;
      -ms-box-sizing: border-box;
          box-sizing: border-box;
}

.foo.row > [class*="span"]:first-child {
    border-left: 5px solid orange;
}
.foo.row > [class*="span"]:last-child {
    border-right: 5px solid orange;
} 
```

我希望你能找到你的尺码。

# java - 具有快速搜索和慢速插入/删除的内存有效整数列表

> ID：11299092
> 
> 赞同：1
> 
> 时间：2012-07-02T18:22:38.983
> 
> 标签：java, algorithm, design-patterns, data-structures

我正在尝试为正整数（数百万个元素）的排序列表找到最佳[数据结构](http://en.wikipedia.org/wiki/List_of_data_structures)。要求是（按重要性排序）：

1.  内存占用小

2.  快速`O(log n)`搜索

3.  插入/删除速度比`memcpy()`

我正在考虑保留两个数组：一个用于搜索，一个用于插入。每隔几个操作，我都会重新组织主要的操作并清理第二个操作。有什么想法吗？我在正确的轨道上吗？

附言。没有重复项。它不需要是线程安全的。读取会经常发生，而写入很少发生。整数在结构中的分布不均匀，这意味着一些结构将只包含几个元素，而其他结构可能有数百万个元素，位置从零到`0xFFFFFFFF`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T18:27:39.750

我想你想用[Van Emde Boas Tree](http://en.wikipedia.org/wiki/Van_Emde_Boas_tree)

它具有以下特点：

```
Space   O(M)
Search  O(log log M)
Insert  O(log log M)
Delete  O(log log M) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T18:33:51.890

你能用`char[65536][]`吗？其中顶部或底部 16 位是其他 16 位数组的索引。这可以使用少于 4 * X 每个条目。

抬头

```
 private final char[][] bitsArray = new char[65536][];

 public int countFor(int num) {
     int topBits = num >>> 16;
     int lowerBits = num & 0xFFFF;
     char[] lowerBitsArray = bitsArray[topBits];
     int count = 0;
     for(char l : lowerBitsArray)
        if(l == lowerBits)
           count++;
     return count;
 } 
```

如果计数永远不会超过 1，那么 BitSet 可能是更好的选择。（可能是一组 BitSet，具体取决于数据模式）例如，如果您要记录看到的 IP 地址，您可能不需要担心 0\. *、 10.*、 127.* 或 224-255.*

* * *

an `int[]`or`char[]`访问速度是否更快，包括转换为 int。

```
public static void main(String... args) {
    char[] chars = new char[1000000];
    for (int i = 0; i < 5; i++)
        timeSum(chars);
    int[] ints = new int[1000000];
    for (int i = 0; i < 5; i++)
        timeSum(ints);
}

private static int timeSum(char[] chars) {
    long start = System.nanoTime();
    int sum = 0;
    for (char ch : chars) {
        sum += ch;
    }
    long time = System.nanoTime() - start;
    System.out.printf("Took %,d us to sum %,d chars%n", time / 1000, chars.length);
    return sum;
}

private static int timeSum(int[] ints) {
    long start = System.nanoTime();
    int sum = 0;
    for (int i : ints) {
        sum += i;
    }
    long time = System.nanoTime() - start;
    System.out.printf("Took %,d us to sum %,d ints%n", time / 1000, ints.length);
    return sum;
} 
```

印刷

```
Took 5,378 us to sum 1,000,000 chars
Took 11,551 us to sum 1,000,000 chars
Took 437 us to sum 1,000,000 chars
Took 407 us to sum 1,000,000 chars
Took 407 us to sum 1,000,000 chars
Took 5,539 us to sum 1,000,000 ints
Took 532 us to sum 1,000,000 ints
Took 530 us to sum 1,000,000 ints
Took 511 us to sum 1,000,000 ints
Took 507 us to sum 1,000,000 ints 
```

我的结论是缓存效率比转换成本更重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-02T18:36:04.813

这实际上是一个有趣且不平凡的问题。最佳答案将取决于您的具体要求以及您执行的操作的精确组合。

如果**数据密集且不允许重复**，则大位图可能是最佳选择。只需设置一点以显示每个可能的整数值的存在/不存在。这种方法对于读取和写入都将非常快并且 O(1)，但内存使用量显然取决于您拥有的范围有多大/数据的稀疏程度。

如果**数据密集并且允许/常见重复**，那么存储每个可能值的出现次数的数组可能会很好地工作。在性能上与位图方法相似，但是假设出现次数为整数，您可能需要 32 倍的内存。

如果您**阅读量大且数据稀疏**，那么基于排序数组的方法（使用二进制搜索进行查找）可能是最好的。如果您了解值的粗略分布，那么您可以通过使用启发式算法来猜测目标值在数组中的可能位置（例如，如果您利用这些知识，您可以显着击败 log2(N)分布大致均匀）

如果您有**大量写入并且数据稀疏**，那么您可能需要一个基于树的结构，该结构基于整数中位的子集进行拆分（例如，在每个节点的下一个最重要的 5 位上进行 32 路 trie 拆分） . Clojure 的持久数据结构使用这种技术效果很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-02T18:50:37.403

我认为@Peter Lawrey 有一个好的开始：细分。部分不同的是，我将细分为 256 个事物，每个事物跟踪 2^23 个事物。根据整数的分布，使用顶部或底部 8 位进行细分。

至于子事物，当整数稀疏时，从 Set （或类似的）开始。但是，一旦 Set 达到一定大小，（它开始变得密集）切换到 BitSet。我不知道您是否需要支持删除值，在这种情况下，您需要从 BitSet 切换回 Set。

ps如果一切都失败了，**所有**正整数的一个简单的BitSet“只有”268MB（如果我的计算是正确的......）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-02T18:30:42.090

那么链表呢？记忆约束将是整数的大小+前一个和下一个指针的一点开销。至于插入和删除，时间要求只是在列表中向下查找，直到找到比您要插入的那个更小的一个并将其放在该记录之前。删除只需要更改previous和next的指针，搜索就像插入一样容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-04T11:27:55.970

您可以查看一些[现代尝试](http://bhavin.directi.com/to-trie-or-not-to-trie-a-comparison-of-efficient-data-structures/)（该链接未提及[融合树](http://en.wikipedia.org/wiki/Fusion_tree)）。但是，我认为它们的实现都非常复杂。如果你很幸运，你可能会发现一些大胆的人已经编写并开源了一个你可以使用的实现。

另一件事是经典的[B-tree](http://en.wikipedia.org/wiki/B-tree)。

如果您的数据集大小相对一致，您甚至可以编写一个单级 B 树（因此具有单个根节点和多个子节点），这大大简化了实现（因为您可以只存储一个`int[][]`，并用窥视叶子替换内部键，如果这有任何意义的话）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-02T18:49:22.453

如果您不太担心速度，并且对内存使用感到害怕，您可以加载一个整数数组，创建另一个数组，对数组进行排序，直到您有一个数字 X（1K 左右以防止内存过载）然后将数组的该部分保存为文本文件（objectOutputStream 将整数保存为整数），清除数组，然后对数组中的下一个 X 个整数执行相同操作。只需确保将输出流标记为附加文件（true）与覆盖，这是默认值。

# .net - 使用 System.Linq.Expressions API 在 LINQ 中选择列

> ID：11299095
> 
> 赞同：3
> 
> 时间：2012-07-02T18:22:54.823
> 
> 标签：.net, linq, linq-expressions

我正在尝试使用 LINQ 表达式从一个`IEnumerable`可以绑定到我的 UI 的结果集中动态选择列。在这一点上，我很难掌握 LINQ 表达式中投影的基础知识。

假设我有一个这样的字符串列表：

```
Dim myStrings = {"one", "two", "three"}.ToList() 
```

使用 lambda 表达式，我可以通过执行以下操作轻松选择字符串长度的集合：

```
Dim myStringLengths = myStrings.Select(Function(x) x.Length) 
```

该语句的结果将给我留下一个名为的集合，该集合`myStringLengths`具有元素`3, 3, 5`。

我似乎无法弄清楚如何使用 LINQ 表达式产生等效结果。

**编辑：**当我说 LINQ 表达式时，我说的是在`System.Linq.Expressions`命名空间中使用 API，而不是 LINQ 语句或 lambda 表达式的标准形式。正如您在上面清楚地看到的那样，我已经熟悉如何以这种方式生成投影。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T19:05:51.143

```
 var item = Expression.Parameter(typeof(string), "x");
 var length = Expression.PropertyOrField(item, "Length");

 new string[] {"one", "two", "three"}
      .AsQueryable()
      .Select(Expression.Lambda<Func<string, int>>(length, item)); 
```

您需要一个 IQueryable 才能使用表达式（您可以使用 ToList 或类似方法将其带回 IEnumerable）。然后将 Lambda 生成为表达式树（长度示例在上面完成）。抱歉，它在 C# 中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T18:31:59.880

在 C# 中它看起来像这样

```
var myStringLengths = myStrings
                        .Select((s) => s.Length); 
```

# ajaxcontroltoolkit - 动态添加 HtmlEditorExtender 到更新面板

> ID：11299099
> 
> 赞同：0
> 
> 时间：2012-07-02T18:23:06.437
> 
> 标签：ajaxcontroltoolkit

Ajax 工具包控件在动态添加到更新面板时出现问题。我有测试用户控件（UC_Test.ascx），里面有一个带有 HtmlEditorExtender 的文本框：

```
 <%@ Control Language="C#" AutoEventWireup="true" CodeFile="UC_Test.ascx.cs" Inherits="UC_Test" %>
<asp:TextBox runat="server"  ID="textbox1" CssClass="textbox" Height="40px"/>
<asp:HtmlEditorExtender runat="server" TargetControlID="textbox1"></asp:HtmlEditorExtender> 
```

在另一个控件上有更新面板，其中包含两个元素（按钮和 PlaceHolder）

```
<asp:UpdatePanel runat="server">
    <ContentTemplate>
        <asp:Button Text="Add" runat="server" OnClick="button_click" />
      <asp:PlaceHolder ID="PlaceHolder1" runat="server"></asp:PlaceHolder>
    </ContentTemplate>
</asp:UpdatePanel> 
```

按钮点击事件背后的代码是：

```
protected void button_click(object sender, EventArgs e)
    {

            PlaceHolder1.Controls.Clear();
            PlaceHolder1.Controls.Add(LoadControl("~/UC_Test.ascx"));

    } 
```

现在，当单击按钮时，控件（UC_Test）将成功添加到 ajax 模式下的占位符，但 HtmlEditorExtender（css 文件和图像）的资源没有加载。我从添加的控件制作快照：

![AjaxToolKit HtmlEditorExtender 问题，当它动态添加到更新面板时](../Images/51c61eccd432097f2be666e2fd8cb307.png)

如您所见，htmlEditorExtender 的图标（例如复制，粘贴，...）没有被加载。！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-12T17:44:41.647

这个问题有一个解决方法。在您的脚本管理器和第一个更新面板之间的母版页上放置一个不可见的面板，并在其中放置一个虚拟文本字段和 HtmlEditorExtender。这将使动态加载的控件的 HtmlEditorExtenders 正确呈现。

显然扩展器需要在第一次加载时加载某些资源。母版页上的虚拟对象将使这些资源可用于之后创建的扩展程序。

[t010t](http://www.codeplex.com/site/users/view/t010t)在[ajaxcontroltoolkit.codeplex](http://ajaxcontroltoolkit.codeplex.com/workitem/27181)上发布的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-17T14:09:24.770

我知道这是一岁了，但是我遇到了同样的问题。就我而言，有一个 CSS 类全局应用于所有按钮。

如下。

```
background: #666666; 
```

Firefox firebug 插件显示这具有将 css 呈现为的结果。

```
background: none repeat scroll 0 0 #e6e6e6; 
```

当我禁用这行 css 时，按钮会出现。为了解决这个问题，我不得不改变。

```
background: #666666; 
```

至

```
background-color: #666666; 
```

在此之后，按钮正确呈现。这可能无法解决每个人的问题。但在某些情况下可能会。

# php - 即使将 html 和 php 转换为 UTF-8 后仍会出现在电子邮件中

> ID：11299105
> 
> 赞同：2
> 
> 时间：2012-07-02T18:23:37.490
> 
> 标签：php, html, utf-8

我已将 php 和 html 设置为 UTF-8，在我的电子邮件中仍然出现 A£，我不知道我做错了什么。请询问任何代码，而不是用无意义的代码覆盖您的屏幕，我认为最好询问您需要什么代码

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T18:52:26.220

您需要向邮件阅读器发送一个标头，指示您正在使用什么字符集。其标头与 HTTP 中的相同：

```
Content-Type: text/html; charset=utf-8 
```

如果您使用的是普通[邮件](http://php.net/mail)功能，请将其与第四个参数 ( `$additional_headers`) 放在一起：

```
$headers = 'Content-Type: text/html; charset=utf-8';
mail($to, $subject, $message, $headers); 
```

# c# - 光标应该在“try”之前还是之后改变，为什么？

> ID：11299107
> 
> 赞同：2
> 
> 时间：2012-07-02T18:24:00.877
> 
> 标签：c#, winforms

像这样：

```
Cursor.Current = Cursors.WaitCursor;
try {
  . . .
} finally {
    Cursor.Current = Cursors.Default;
} 
```

或这个：

```
try {
  Cursor.Current = Cursors.WaitCursor;
  . . .
} finally {
    Cursor.Current = Cursors.Default;
} 
```

?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T18:25:55.977

这两种方法之间没有区别，因为分配预定义的游标`Cursor.Current`不会引发异常。如果您从资源文件加载游标，则该行为实际上可能会引发异常（例如，如果未找到指定的资源）。

重要的是在块中将光标设置为所需的状态`finally`，这在两个示例中都是如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T18:25:55.650

问问自己，那行的结果会抛出异常吗？在这种简单的情况下，只要当且仅当抛出任何异常时，您才可以在 finally 子句中返回正常状态。就个人而言，我不会抛出该行`Cursor.Current = Cursors.WaitCursor`，因为它不会抛出异常（您只是在进行分配）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-02T18:26:57.537

把它放在里面没关系，*除非它会抛出 Exception*。

如果它确实引发了异常，那么您应该只处理它在`catch`块中引发的特定类型的异常，或者在程序使用该`finally`块退出之前处理最终安排并释放资源。

这里有一些很好的信息供您阅读：http: [//msdn.microsoft.com/en-us/library/ms173160.aspx](http://msdn.microsoft.com/en-us/library/ms173160.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-02T18:35:47.147

将第一个游标赋值放在 try 块中并没有什么坏处。正如其他人所指出的，如果您确定分配永远不会引发异常，那么它并不一定需要在 try 块内。如果不确定，最好将其放在 try 块中。

作为一般的编码模式，如果您不确定语句是否会引发异常，请将其放在 try 块中。最好将它放在 try 块中而不需要它，而不是假设/猜测错误并将它放在 try 块之外，而当你确实需要它时。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-03T07:16:59.140

我会在尝试之前放置游标设置器。原因是您的 try/finally 方法是确保 try 块中的代码在抛出异常时不会影响 Cursor。但是，您并没有试图防止来自 Cursor 属性本身的错误。如果那里有错误，那么您将需要单独处理它，或者让它导致未处理的异常，从而导致应用程序崩溃。你想要的最后一件事是将 Cursor 设置为抛出异常，只是在尝试在 finally 块中再次设置它时得到另一个异常：你只会在崩溃报告中看到第二个异常，它可能会让你出错当你去调试它的路径时，会浪费你很多时间。

# ruby-on-rails - Rails 3 升级 link_to :remote :with options

> ID：11299113
> 
> 赞同：0
> 
> 时间：2012-07-02T18:24:22.297
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在升级到 Rails 3，并将我的所有 link_to_remote 调用替换为 link_to(..., :remote => true)。但是，我试图弄清楚如何在 Rails 3 中实现 :with 选项。 :with 选项是一种使用 javascript 变量提供动态查询参数的方法。

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T18:30:03.453

我认为它已从 Rails 3 中删除，因为它违反了非侵入式 javascript 的原则。

所以，你应该尝试找到另一种方法来实现你想要的任何东西......

看看这里：[http ://railscasts.com/episodes/205-unobtrusive-javascript?view=asciicast](http://railscasts.com/episodes/205-unobtrusive-javascript?view=asciicast)

# c++ - C++ 中指向 this 的指针

> ID：11299114
> 
> 赞同：3
> 
> 时间：2012-07-02T18:24:23.973
> 
> 标签：c++, pointers, this

`this`由于数组（`std::vector<foo**>`） ，我想编写一行代码返回指向 的指针。我想过使用引用（`&this`），但它没有用。

如果需要任何澄清，请告诉我。

编辑：为了澄清我在做什么，我试图直接使用数组访问对象。像这样：`(*ARRAY.at(i))->foo("bar");`。有人说做指针是不可能的。如果是这样，我将如何使用数组直接访问对象？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-02T18:29:04.590

您不能有指向 的指针`this`，因为它不是变量，它是一个保留关键字，可转换为指向当前对象的指针。

在编译器实现中，可能有一个支持`this`指针的函数的局部变量，但它是一个实现细节，程序员无法访问其地址。

你试图做的是*非常*邪恶的，但如果你真的想这样做，你将不得不自己创建变量：

```
foo** evil_ptr_to_ptr = new foo*(this);
ARRAY.push_back(evil_ptr_to_ptr); 
```

并且在将来的某个时候，您将不得不将其删除：

```
// assuming you got all the elements in the array in the same way:
for(int i = 0; i < ARRAY.size(); ++i) {
  delete ARRAY[i];
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-02T18:33:09.627

在 C++`this`中不是左值。因此，无法创建指向`this`. 出于同样的原因，也不可能将引用直接绑定到`this`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-02T18:40:39.593

> this 指针作为隐藏参数传递给所有非静态成员函数调用，并可作为所有非静态函数体内的局部变量使用。

因此，获取 this 指针的地址实际上是没有意义的。

考虑这个非静态成员函数：

```
void my_struct::my_func(int a); 
```

当您在 my_struct 上调用它时，编译器会在后台执行此操作：

```
void my_struct__my_func(my_struct* this, int a); 
```

鉴于 this 指针是按值传递的，获取它的地址将为您提供函数返回后将不再存在的地址。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T18:39:14.650

正如其他回复/评论指出的那样，`this`它本身就是一个指针。

即使您可以使用指向`this`:的指针，`this`它也是一个局部变量，是您正在运行的方法的局部变量，并且它是指向您正在使用的对象的指针。

返回指向的指针`this`与返回指向任何其他局部变量的指针具有相同的效果：它将返回垃圾，因为您刚刚离开了`this`定义的范围。

> 编辑：为了澄清我在做什么，我试图直接使用数组访问对象。像这样：(*ARRAY.at(i))->foo("bar");。有人说做指针是不可能的。如果是这样，我将如何使用数组直接访问对象？

Return `this`，将其存储在您的数组中，然后像这样访问： myArray[idx]->foo("bar")

同样，`this`是**指向**您的对象的指针。

编辑：我的立场得到纠正。`this`是作为隐藏方法参数实现的右值表达式 - 它具有局部变量的生命周期。:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-02T18:46:11.880

你现在有很多正确的答案，但试着换个角度想一想：

`foo`假设您在内存中的某个地址分配了您的类的对象。此地址`this`在您的班级范围内有效地表示为。现在，你说你需要另一个地址来保存原始对象的地址。这个变量必须被声明并且拥有你的对象的生命周期；显然，默认情况下不存在这样的变量，因为创建一个变量没有太大意义。如果要保留`foo**`在容器中，则很可能必须保留另一个容器`foo*`，因此前者可以指向后者。好吧，再一次，这样做很可能没有意义，我想你应该以不同的方式解决你的问题？（您可能想在 SO 上提出问题并获得一些帮助。）

# php - PHP按钮需要调用一个函数

> ID：11299119
> 
> 赞同：1
> 
> 时间：2012-07-02T18:25:07.380
> 
> 标签：php, button

如何将下面的代码变成我页面上的按钮？它按其编写的方式工作，但我不喜欢它是一个超链接。我希望它是一个按钮。

```
echo " <form>
<a href='test.php?id=$key&do=unfollow'>unfollow</a>
</form>"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:28:00.687

尝试：

```
echo " <form action='test.php' method='GET'>
<input type='hidden' name='id' value='$key'/>
<input type='submit' name='do' value='unfollow'/>
</form>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T18:28:05.670

首先：您的链接不必在`FORM`. 这是因为您没有用户输入，并且因为您使用的是`GET`.

第二：用于`CSS`设置超链接的样式并使其看起来像`button`.

# javascript - 无论元素是否已使用 jQuery 添加到 DOM 都应用样式

> ID：11299120
> 
> 赞同：0
> 
> 时间：2012-07-02T18:25:13.660
> 
> 标签：javascript, jquery, css, dom

**问题：**将`$(".price").hide();`作品应用于已经渲染的元素，但是，当我通过 javascript 加载新模板时，价格类将可见。

**问题：**有没有办法在插入 DOM 时将样式应用于类的所有未来实例。

例子：

```
$(".price").hide();
$('body').append('<div class="price">19.00</div>'); // this should be hidden. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T18:27:16.573

您应该可以使用[livequery](http://docs.jquery.com/Plugins/livequery)做到这一点。

```
$('.price').livequery(function() {
    $(this).hide();
}); 
```

优点是这将涵盖现有的以及您添加到 DOM 的任何新元素。

**编辑**：正如其他人指出的那样，livequery 是为 jQuery 1.3-1.4 编写的。所以我不确定它对你的情况有多适用。~~让我看看 1.7.2 是否有任何等价物。~~查看[此答案](https://stackoverflow.com/questions/10770359/jquery-livequery-plug-equivalent-in-jquery-1-7)以获取有关在 jQuery 1.7+ 中模仿 livequery 功能的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T18:27:09.237

我认为最好的解决方案是使用辅助类：

CSS

```
.helper{
    display: none;
} 
```

jQuery

```
$(".price").addClass('helper'); //for dyanmic addition to certain classes
$('body').append('<div class="price helper">19.00</div>');  //for adding afterward 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-02T19:15:07.983

不要这样做，而是让您的切换开关修改*容器*元素以添加或删除类。

然后，有一个如下所示的 CSS 规则：

```
.hidePrice .price{
    display:none;
}​ 
```

切换按钮时，只需切换容器元素上的 hidePrice 类。

见：http: [//jsfiddle.net/bXChZ/](http://jsfiddle.net/bXChZ/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T19:03:45.827

这对我有用：

**使用 jQuery：**

```
$('<style id="priceVisibility">div.results .price {display: none; }</style>').appendTo('head'); 
```

**没有 jQuery：**

```
// Appending style element to the head with a overriding style.
var style = document.createElement('style');
style.type = 'text/css';
style.id = 'priceVisibility';
style.innerHTML = 'div.results .price {display: none; }';
document.getElementsByTagName('head')[0].appendChild(style); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-02T19:15:47.373

您可以在 <body> 标记中添加一个类，然后使用 CSS 隐藏 .price 元素。例如

jQuery：

```
$('body').addClass('hide-price'); 
```

CSS：

```
.price {display: block}
.hide-price .price {display: none} 
```

# c++ - 用于插入大部分排序数据的数据结构，该数据将保持排序顺序

> ID：11299134
> 
> 赞同：3
> 
> 时间：2012-07-02T18:26:00.750
> 
> 标签：c++, algorithm, optimization

这个名字说明了一切，但为了详细说明，我有一个带有时间戳的向量列表。它们大多是排序的，但会有一些乱序值。我想以有序的方式输出它们，但是向量将以流的形式出现，我不想扩大缓冲区，因为我想及时输出我的结果。

所以我想保留一个包含 N 个向量的“前瞻”列表。当我读入新向量时，我想将其插入列表中，然后从列表顶部弹出最旧的向量以输出，以便列表保持恒定的 N 个向量长。

当我插入列表时，我希望对向量进行排序并添加到列表中的正确位置，因为我认为这是最有效的方法。

我需要良好的效率，但不想浪费太长时间的实施和测试。因此，我对简单的解决方案（例如重用现有的 C++ 结构，如果它们存在）以及如果它们可以显着提高速度，则更难实现的解决方案感兴趣。我宁愿坚持使用标准 C++，但如果有一个 boost 或类似的库可以完全满足我的需要，我很想听听它以防万一。

谢谢你。

编辑：我感谢所有建议。但是，我忽略了时间戳不是唯一的。时间戳只有第二个精度，所以实际上很可能我得到了多个具有相同时间戳的向量。在这种情况下，我宁愿保留他们的订单，尽管这不是必需的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T18:34:09.030

看看[`std::multiset`](http://msdn.microsoft.com/en-us/library/w5txk7zc)课堂。

您应该检查其[插入](http://msdn.microsoft.com/en-us/library/4zye7bek%28v=vs.100%29.aspx)方法：

```
#include <set>
#include <functional>

const size_t max_item_number = 100;

struct your_type
{
  std::string str;
  time_t datetime;
};

class your_less : std::binary_function<your_type,your_type,bool>
{
public:
  bool operator()( const your_type &left, const your_type &right ) const
  {
    return ( left.datetime < right.datetime );
  }
};

std::multiset<your_type,your_less> store;
std::multiset<your_type,your_less>::iterator helper = store.begin();

helper = store.insert( helper, new_value );
helper = store.insert( helper, new_value );

// fixed size: remove the oldest value
// you could use it e.g. in loop
if ( store.size() == max_item_number )
{
  store.erase( store.begin() );
  helper = store.begin();
} 
```

这样，如果流是有序的，则插入时间可以是恒定的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T19:26:40.293

简单的选项：priority_queue O(lg n) 插入和提取 min 并且比 set/multiset 快很多（对于整数来说大约是 3 倍）并且内存占用更小

如果输入几乎已排序，则可以使用插入排序的一些变体。你只需保持排序的双端队列并在后面的某个地方插入东西并从前面弹出分钟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T18:28:32.497

看看`std::set`课堂。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T21:09:36.850

如果你要在一个大缓冲区和一个大排序中完成它，那么 Timsort 会很棒。它能够利用部分排序。但你说你不需要那个。

如果您需要在没有循环内排序的情况下保持可管理性，那么最好使用诸如treap 或红黑树之类的东西。

Treaps 平均速度很快（我最近在 Python 中对许多不同条件下的树数据结构进行了性能比较，发现平均而言，traps 总是最快或第二快 - 根据工作负载，另外两个有时比 treaps 快一点，但并非始终如此）

据报道，红黑树的操作时间标准差较低（与平均而言，它们与trap相比有点慢，但如果这是一个实时或交互式应用程序，红黑树可能更好，因为它的操作时间可变性低）。

# android - 安装Android-SDK包

> ID：11299145
> 
> 赞同：0
> 
> 时间：2012-07-02T18:27:11.950
> 
> 标签：android, sdk, installation, android-sdk-2.3

我已经安装了 Android-SDK，但我无法安装一些数据包。例如，我需要安装`Android API 4 SDK`，但经理写入日志：

> 获取 [https://dl-ssl.google.com/android/repository/addons_list-2.xml](https://dl-ssl.google.com/android/repository/addons_list-2.xml) 准备安装档案 下载 SDK Platform Android 1.6, API 4, revision 3 null 完成。什么都没有安装。

但其他数据包（例如`Android API 16 SDK`）已成功安装。

我尝试以`Manager.exe`管理员身份运行 SDK，但结果相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T09:58:30.517

可能只是你的网络慢速连接，我继续通过离线安装 API 解决了这个问题：http: [//qdevarena.blogspot.com/2010/05/download-android-sdk-standalone-for.html#idc-cover](http://qdevarena.blogspot.com/2010/05/download-android-sdk-standalone-for.html#idc-cover)

尽管您需要获取存储库的最新 url 链接，否则您将获得过时的版本。

# ruby-on-rails - 每条记录多张图像。如何在索引部分上只显示一个？

> ID：11299148
> 
> 赞同：0
> 
> 时间：2012-07-02T18:27:18.393
> 
> 标签：ruby-on-rails, image, model-view-controller, paperclip, partial

我有一个显示杯子（用于饮用）的应用程序，每个杯子可以有很多照片。

杯子在索引页面上显示为部分，当点击时，用户会被带到杯子展示页面，他们可以看到所有添加的照片。

如何使用其中一张照片显示在杯子部分上？我正在考虑第一次上传或选择要在部分上使用的上传照片的方式。

**马克杯 show.html.erb**

```
<% if @mug.mugphotos.count.zero? %>
  <div class="no_photos">
    None added yet.
  </div>
<% else %>  
  <% for mugphoto in @mug.mugphotos %>
    <%= link_to image_tag(mugphoto.mugphoto.url(:thumb), :class => "mug_photo"), mugphoto.mugphoto.url(:large) %>
  <% end %>  
<% end %> 
```

**杯子部分**

```
<%= link_to mug do %>
  <div class="mug_partial">

    <div class="mug_partial_photo">
    </div>

    <span class="mug_partial_name"><%= mug.name %></span>
  </div>
<% end %> 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T11:34:56.673

在为“杯子列表”和“杯子细节”视图提供服务的控制器操作中执行此“杯子照片选择”工作怎么样？

在您的控制器操作“show_mug_list”中，保留您拥有的代码，并在控制器操作“show_mug_detail”中，将您选择的单张照片传递给视图，例如在@mug_photo 变量中。

# iphone - Xcode 在 iPhone 上运行 Redpark

> ID：11299150
> 
> 赞同：0
> 
> 时间：2012-07-02T18:27:20.267
> 
> 标签：iphone, xcode, arduino

好吧，所以我束手无策。

我有一个使用推送和弹出视图控制器的应用程序。我的一个视图控制器具有从 Arduino Uno 读取输入的基本设置（使用 Redpark 电缆）。

当我从应用程序中弹出该视图控制器时，它会死掉，我不知道是什么原因造成的。我知道这与 Redpark 编码有关，因为没有它，应用程序可以正常工作。

当我将 Redpark 编码插入其他 viewController 时，应用程序不会死，但我必须阅读序列码的文本会消失。

那么是什么导致它崩溃呢？或者不显示数据。

我认为这与 [rscMgr open] 命令有关。任何输入都会很有用。

* * *

编辑：让我也问一下。有没有办法在我的应用程序后台运行这个读取串行数据的过程？那可能会解决问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:19:25.150

所以我相信我解决了这个问题，或者只是在上面贴上创可贴。

在 Alasdair Allen 的“iOS Sensor Apps with Arduino”一书中，所有示例都是在主视图控制器中创建的。

我正在玩这些示例以及额外的视图控制器。我意识到主视图控制器总是在运行。

我为解决这个问题所做的是创建一个保存输入的全局变量，然后将其打印到推送的 viewController。

我还使用了一个计时器来更新推送的 viewController 中的值。

所以...

1.  创建一个将保存输入的变量。我在 AppDelegate 类中执行此操作（我倾向于将所有全局变量放在 AppDelegate 中）。

    ```
    @synthesize rxBuffed = _rxBuffed; 
    ```

2.  使用变量在主 viewController 上运行 Redpark Serial 输入`rxBuffed`（可以任意命名）。

    ```
    for (int i = 0; i < numBytes; i++) {
    delegate.rxBuffed = [NSString stringWithFormat:@"%@%c", delegate.rxBuffed, ((char *)rxBuffer)[i]];
    } 
    ```

3.  在您想要 RX 数据的 viewController 中创建您的计时器。我每 1/10 秒更新一次。

    ```
    myTimer =[NSTimer scheduledTimerWithTimeInterval:.1
    target:self selector:@selector(updateValues)
    userInfo:nil repeats:YES]; 
    ```

4.  在 updateValues 中导入该变量。

    ```
    -(void)updateValues{
    AppDelegate *delegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
    yourVariable = delegate.rxBuffed;
    } 
    ```

# python - 比较字符串和列表索引错误

> ID：11299154
> 
> 赞同：0
> 
> 时间：2012-07-02T18:27:37.230
> 
> 标签：python, string, list

我试图在 python 中运行这个程序，但它一直给我一个错误，即列表索引超出 if 语句行的范围。但它确实会在必须打印的地方打印出“找到的匹配项”。

```
import csv
with open('/Users/jadhav/Documents/Hubble files/m4_hubble_1.csv') as f:
    bl = [[],[],[],[],[]]
    reader = csv.reader(f)
    for r in reader:
        for c in range(5):
            bl[c].append(r[c])

print "The files have now been sorted into lists"
for c in range(0,999):
    if bl[4][c] == "HST_10775_64_ACS_WFC_F814W":
        print "match found"
    else:
        del bl[0][c] 
        del bl[1][c] 
        del bl[2][c] 
        del bl[3][c]
        del bl[4][c] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:32:31.767

看起来文件少于 999 行，所以`bl`增长不够。添加异常处理，预先计算最大索引或以不同方式迭代元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:47:30.013

您不应该从您正在迭代的列表中删除项目。

首先你检查`bl[0][0]`，然后删除`bl[0][0]`，导致后面的被向下移动。现在列表中有 999 个项目。

然后你正在检查`bl[0][1]`，这是以前`bl[0][2]`的（原来 `bl[0][1]`是 now `bl[0][0]`）。

等等。

最终，当`c`是 500 时，列表中只有 500 项。`IndexError`！

# mono - msbuild nantcontrib 任务可以与 mono 的 xbuild 一起使用吗？

> ID：11299159
> 
> 赞同：2
> 
> 时间：2012-07-02T18:27:52.917
> 
> 标签：mono, continuous-integration, nant, nantcontrib, xbuild

我很好奇是否可以将 nantcontrib 任务与 Mono 的 xbuild.exe 结合使用，而不是预期的 msbuild.exe。

我最初的实验看起来不太有希望。该任务查找 msbuild.exe，因此我将 xbuild.exe 符号链接到 msbuild.exe，但任务失败并显示

```
External Program Failed: /usr/lib/mono/2.0/msbuild.exe (return code was 1): 
```

是否可以使用 xbuild 作为 msbuild 的直接替代品？如果没有，任何有关获取 NAnt 任务以在单声道下构建 Visual Studio 解决方案 (.sln) 的输入将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T19:56:32.480

看看[这个类似的问题](https://stackoverflow.com/questions/3401257/monodevelop-command-line-compile-a-solution)。此外，考虑使用 NAnt 的简单`<exec>`元素而不是 NAntContrib 的`<msbuild>`包装器。

# mysql - 在 MySQL 中运行多个存储过程

> ID：11299173
> 
> 赞同：0
> 
> 时间：2012-07-02T18:28:49.267
> 
> 标签：mysql

我正在 MySQL 中创建一个 SQL 脚本文件。该脚本只是创建一个表和一些存储过程。我有两个问题。

1.  我需要检查表是否存在，跳过创建表语句。但如果存在程序，请将其删除，然后创建一个新程序。这是我正在尝试的代码 -

    ```
    CREATE TABLE IF NOT EXISTS Student (   
        Id INT PRIMARY KEY,   Name
        VARCHAR(100) NOT NULL 
    );

    DROP PROCEDURE IF EXISTS usp_StudentInsert;

    DELIMITER $$
    CREATE PROCEDURE usp_StudentInsert(
        id INT, 
        name VARCHAR(100)) 
    BEGIN    
        INSERT INTO Student(Id, Name) VALUES(id, name); 
    END$$

    DROP PROCEDURE IF EXISTS usp_StudentRetrieve;

    DELIMITER $$ 
    CREATE PROCEDURE usp_StudentRetrieve(studentId INT)
    BEGIN
        SELECT * FROM Student WHERE Id = studentId;
    END$$ 
    ```

    出现错误“DROP PROCEDURE IF EXISTS usp_StudentRetrieve 附近的 SQL 语法错误”；

2.  使用 PHP 代码执行脚本文件的最佳方法是什么？

提前谢谢你。

里特什

PS - 如果有帮助，我将 MySQL Workbench V5.2 与 MySQL 5.1 一起使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T18:39:19.657

我在分隔符后添加了一个空格，它对我有用：

从`delimiter$$`到`delimiter $$`

```
mysql> CREATE PROCEDURE usp_StudentInsert(id INT,name VARCHAR(100)) 
    -> BEGIN
    ->  INSERT INTO Student(Id, Name) VALUES(id, name); 
    -> END
    -> $$
Query OK, 0 rows affected (0.00 sec)

mysql> delimiter ;
mysql> drop procedure usp_studentinsert;
Query OK, 0 rows affected (0.00 sec) 
```

编辑：

```
mysql> DROP PROCEDURE IF EXISTS usp_StudentInsert;
Query OK, 0 rows affected (0.00 sec) 
```

# .net - 哪些 .NET 兼容的图形数据库解决方案具有良好的业绩记录？

> ID：11299179
> 
> 赞同：31
> 
> 时间：2012-07-02T18:29:24.203
> 
> 标签：.net, nosql, graph-databases

## 我正在寻找一个通用的图形数据库解决方案，它具有现有的 .NET 兼容基础架构和经过验证的跟踪记录。

我在 Google 和 SO 上找到了几个选项的链接，但没有很多关于现实世界应用程序中现有实现和使用的信息。

我还考虑过在文档数据库（如[RavenDB](http://ravendb.net/)或[MongoDB](http://www.MongoDB.org/display/DOCS/CSharp+Language+Center)）和专用三重存储或 RDBMS（如 SQL）之间使用混合，并扩充数据存储以支持我想要的功能。然而，这可能是相当多的工作，我希望其他人已经完成了。

## 我看过的：

*   [Trinity](http://research.microsoft.com/en-us/projects/trinity/default.aspx) - 这是由 Microsoft 制作的，文献表明它听起来很棒，但我找不到下载链接，并且发布页面显示“Trinity 软件包目前仅用于 Intranet 访问。”。

*   [db4o](http://www.db4o.com/about/productinformation/db4o/) - 这是一个面向对象的数据库，原生支持 .NET 和 Java。它似乎作为图形数据库销售，但我不确定“图形”结构/操作是隐式还是显式（或者它是否提供比任何其他文档数据库更多的功能）。

*   [TinkerPop](http://www.tinkerpop.com/) - 这个项目看起来正是我正在寻找的，但 github 源代码似乎只在 Java 中。这张[来自 graph-database.org 的幻灯片](http://www.slideshare.net/ahzf/fosdem-2011-a-common-graph-database-access-layer-for-net-and-mono)讨论了 .NET 版本，但我找不到它们。

*   [CloudGraph](http://www.cloudgraph.com/index.html) - 这听起来不错，但似乎不存在。

*   [GiraffeDB](https://launchpad.net/giraffedb) - “GiraffeDB 是 .NET 框架 4.0 的强大图形数据库系统，能够以高效且可访问的方式表示复杂的语义”正在“正在规划中”。

*   [AllegroGraph 4.7](http://www.franz.com/agraph/allegrograph/) - 这似乎相当成熟（支持 SPARQL 和 Prolog 以及许多客户端接口），但是是封闭源代码。我显然会对一个我没有听说过的闭源项目持怀疑态度。

还有一些看起来很有前途的 Java 项目（[HyperGraphDB](http://www.hypergraphdb.org/index)和[Neo4j](http://neo4j.org/)，但我还没有看到任何现有的 .NET 集成。我并不完全反对使用 Java 解决方案并自己做那些跑腿的工作，但又一次，我更喜欢一个经过验证的解决方案，它可以为我节省最多的时间。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-07T00:09:33.680

尝试在 Mongo 中实现图形数据库是一个之前尝试过的兔子洞。

请参阅来自 TinkerPop 用户组的此消息：

*   [https://groups.google.com/d/msg/gremlin-users/_zweYGxR8wM/0AUu-UoqTRIJ](https://groups.google.com/d/msg/gremlin-users/_zweYGxR8wM/0AUu-UoqTRIJ)

Microsoft 的 Trinity graph 是一个内部项目，无法下载：

*   [http://research.microsoft.com/en-us/projects/trinity/](http://research.microsoft.com/en-us/projects/trinity/)

Neo4j 服务器 ( [http://neo4j.org](http://neo4j.org) ) 与 Romiko 和 Tatham 的 .NET 客户端 ( [http://hg.readify.net/neo4jclient/wiki/Home](http://hg.readify.net/neo4jclient/wiki/Home) ) 是一种流行的组合。

Neo4j 扩展到超过 320 亿个节点 ( [http://blog.neo4j.org/2011/03/neo4j-13-abisko-lampa-m04-size-really.html](http://blog.neo4j.org/2011/03/neo4j-13-abisko-lampa-m04-size-really.html) )，它有一个活跃的用户组 ( [https: //groups.google.com/forum/?fromgroups#!forum/neo4j](https://groups.google.com/forum/?fromgroups#!forum/neo4j)）。

而且 Neo4j Server 与 TinkerPop 的 Rexster 非常相似。

事实上，Peter Neubauer 是 Neo4j 和 TinkerPop 的联合创始人之一，两个项目都有非常相似的 API。因此，如果 TinkerPop 正是您想要的，Java 除外，那么请使用 Neo4j Server 及其 .NET 客户端之一：

*   [http://docs.neo4j.org/chunked/snapshot/tutorials-rest.html](http://docs.neo4j.org/chunked/snapshot/tutorials-rest.html)

您甚至可以通过其内置的 Gremlin 插件在 Neo4j 服务器上运行 TinkerPop 的 Gremlin：

*   [http://docs.neo4j.org/chunked/stable/gremlin-plugin.html](http://docs.neo4j.org/chunked/stable/gremlin-plugin.html)

更新：还有 Blueprints.NET - [https://github.com/Vanaheimr/Blueprints.NET](https://github.com/Vanaheimr/Blueprints.NET)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-08-20T17:36:31.890

新的/最近的/未提及的发现： [VelocityDB](http://velocitydb.com) ，它是一个原生的 .net 实现！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-03T16:42:51.590

www.neo4j.org 有几个功能强大的 .NET 客户端库，请参阅[http://docs.neo4j.org/chunked/snapshot/tutorials-rest.html](http://docs.neo4j.org/chunked/snapshot/tutorials-rest.html)，让您可以从 .NET 内部访问它。您可能想在 groups.google.com/group/neo4j/ 上提出更多问题

/彼得

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-05-18T19:30:20.157

Trinity 现已向公众开放 - [http://www.graphengine.io/](http://www.graphengine.io/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-06-15T15:25:18.217

2017 年更新：[Cosmos DB](https://docs.microsoft.com/en-us/azure/cosmos-db/graph-introduction)现在在 Azure 中提供了一个很好的混合图形数据库解决方案。Cosmos DB 在 2017 年 4 月的 Build 大会之前被称为 Document DB，当时微软宣布了图形和其他功能。因此，您可以将其用作经典文档数据库，您现在可以将数据存储为图形并使用 TinkerPop/Gremlin 进行查询。在 .NET 中，您可以使用[Microsoft.Azure.Graphs](https://msdn.microsoft.com/library/azure/dn948556.aspx) API 对其进行查询。

如果您需要在 Azure 之外运行，则需要查看其他选项，例如 Neo4j。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-07T08:39:13.353

另一种选择是 Sparsity Technologies 的 DEX，它提供了原生 .NET API：

[http://www.sparsity-technologies.com/dex](http://www.sparsity-technologies.com/dex)

您可以从以下位置下载：

[http://www.sparsity-technologies.com/dex_downloads](http://www.sparsity-technologies.com/dex_downloads)

# python - 如何在 Pyramid Web 应用程序中管理用户特定的数据库连接？

> ID：11299182
> 
> 赞同：0
> 
> 时间：2012-07-02T18:29:42.543
> 
> 标签：python, sqlalchemy, pyramid

我们正在使用 Python Pyramid 与 SQLAlchemy 和 MySQL 来构建 Web 应用程序。我们希望拥有特定于用户的数据库连接，因此每个 Web 应用程序用户都有自己的数据库凭据。这主要是出于安全原因，因此每个用户只有自己的数据库内容的权限。我们还想保持连接池的性能优势。有没有办法我们可以在登录时根据用户凭据设置一个新引擎，并将该引擎重用于同一用户发出的请求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:50:47.187

我知道的最好的方法是使用具有多个模式的同一个数据库。不幸的是，我认为这不适用于 MySQL。这个想法是您将池引擎连接到同一数据库，然后当您知道与请求关联的用户时，您可以切换该连接的模式。

# sql - 索引选择中的列排序

> ID：11299183
> 
> 赞同：1
> 
> 时间：2012-07-02T18:29:52.293
> 
> 标签：sql, sql-server-2008, indexing, clustered-index

在[SQLServerpedia上的](http://sqlserverpedia.com/wiki/Choosing_Index_Keys)**选择索引键**一文中，我发现了以下几行：

**由于表中的数据是根据聚集索引的结构排序的，因此基于 last_name、first_name 的索引的行为方式与基于 first_name、last_name 的索引的行为方式不同。应首先指定最具选择性的列。**

为什么？为什么 a,b 上的索引与 b,a 上的索引不同？无论哪种方式，组合的唯一性都保持不变，那么为什么要指定第一个出现较少的那个呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T18:44:10.617

唯一性是相同的，但文章提到了行为。想想电话簿。如果您正在寻找 John Smith，首先找到姓氏 = Smith 会更容易，然后缩小到名字 = John。试着用另一种方式来做......找到所有的约翰，然后找出哪些是史密斯？

因此，如果您通常按姓氏搜索人，则按姓氏然后名字对索引进行排序是有意义的。这样，所有相同的姓氏都将位于同一组索引页上。

这显然适用于唯一索引和非唯一索引。无论顺序如何，都会强制索引键列的唯一性。另请记住，您并不总是需要所有列都成为键的一部分 - 有时将它们作为包含列是有益的。

我也不认为您的索引在这种特定情况下应该是唯一的，因为您不太可能有能力阻止两个约翰史密斯注册您的时事通讯，或在您的公司工作，或加入您的战斗club - last/first 不是一个好键。

# centos - 在 CentOS 上安装 QtCreator 时遇到问题

> ID：11299192
> 
> 赞同：1
> 
> 时间：2012-07-02T18:30:17.440
> 
> 标签：centos, qt-creator, glibc, installation

我从这里下载了 linux 64 位 .run，我正在运行 64 位 CentOS：http: [//qt.nokia.com/downloads](http://qt.nokia.com/downloads)

我按照指示`chmod u+x [filename.run]`

我跑了`./QtSdk....`

我收到了这些错误（如下）。我尝试找到这些库并使用“yum”安装它们。Yum 告诉我，我了解所有这些包裹的最新情况。我究竟做错了什么？

```
./QtSdk-offline-linux-x86_64-v1.2.1.run
./QtSdk-offline-linux-x86_64-v1.2.1.run: /usr/lib64/libstdc++.so.6: version `GLIBCXX_3.4.9' not found (required by ./QtSdk-offline-linux-x86_64-v1.2.1.run)
./QtSdk-offline-linux-x86_64-v1.2.1.run: /usr/lib64/libstdc++.so.6: version `GLIBCXX_3.4.11' not found (required by ./QtSdk-offline-linux-x86_64-v1.2.1.run)
./QtSdk-offline-linux-x86_64-v1.2.1.run: /lib64/libc.so.6: version `GLIBC_2.9' not found (required by ./QtSdk-offline-linux-x86_64-v1.2.1.run)
./QtSdk-offline-linux-x86_64-v1.2.1.run: /lib64/libc.so.6: version `GLIBC_2.10' not found (required by ./QtSdk-offline-linux-x86_64-v1.2.1.run)
./QtSdk-offline-linux-x86_64-v1.2.1.run: /lib64/libc.so.6: version `GLIBC_2.11' not found (required by ./QtSdk-offline-linux-x86_64-v1.2.1.run)
./QtSdk-offline-linux-x86_64-v1.2.1.run: /lib64/libc.so.6: version `GLIBC_2.7' not found (required by ./QtSdk-offline-linux-x86_64-v1.2.1.run) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T07:59:25.310

你应该得到 qt 源码包并在 CentOs 上自己构建它。

或者你可以将 glibc 升级到 2.12（不推荐，因为它需要你升级很多依赖库。）

# android - 无法为振铃器设置 StreamVolume 索引

> ID：11299194
> 
> 赞同：0
> 
> 时间：2012-07-02T18:30:21.440
> 
> 标签：android

我正在使用以下代码-

***mAAudioManager.setStreamVolume(2,50, 1);***

将铃声音量设置为 50。该值保持不变。

# jquery - 选项卡内的全日历渲染（不是 ui 选项卡）

> ID：11299195
> 
> 赞同：0
> 
> 时间：2012-07-02T18:30:25.027
> 
> 标签：jquery, fullcalendar

我已将 fullcalendar 放置在基于[jqwidgets](http://www.jqwidgets.com/jquery-widgets-demo/#demos/jqxtabs/defaultfunctionality.htm)的选项卡内。

当我单击所选选项卡时，会显示第一行按钮，但不会显示日历本身。一旦您单击顶行按钮之一，日历就会显示。

我已经阅读了这里有关如何使用标准 ui.tabs 组件执行此操作的其他帖子，并尝试了它，但它不起作用。这是我所拥有的：

```
<script type="text/javascript">
    jQuery(document).ready(function () {
        var theme = '';
        // Create jqxTabs.
        jQuery('#classInfo').jqxTabs({ 
            width: "100%", 
            height: "1000px", 
            autoHeight: false, 
            position: 'top', 
            theme: theme, 
            show: function(event, ui) {
                jQuery('#classcalendar').fullCalendar('render');
                }
        });
        jQuery('#settings div').css('margin-top', '10px');
    });
</script> 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T04:33:29.663

默认情况下，FullCalendar 不会在隐藏元素中呈现。并且显示事件绑定**器**不适用于 jqxTabs。它仅适用于 jQuery UI 选项卡。

请尝试使用选定的事件绑定器：

```
$('#classInfo').bind('selected', function (event) { 
  if(event.args.item=="3") {
    jQuery('#classcalendar').fullCalendar('render');
  }
}); 
```

这`3`是包含日历的选项卡的索引。您可以在此处输入适用于您的案例的任何条件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-27T04:52:59.320

尝试在隐藏选项卡中放置一个容器：

```
<div id='calendar-container'></div> 
```

然后将日历初始化 HTML 放置在选项卡外侧可见的地方。

```
<div id='calendar'></div> 
```

日历将使用标准的 fullCalendar() JS 在选项卡之外呈现。

```
$("#calendar").fullCalendar(); 
```

下一步是使用 jQuery .appendTo() 函数将日历移动到容器中的隐藏选项卡。这是所有的JS。希望有帮助。

```
$("#calendar").fullCalendar().appendTo("#calendar-container"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-22T19:59:12.757

试试这个：

```
$('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
    $('#calendar').fullCalendar('render');
}) 
```

# python - 在 python 文件的特定部分写入

> ID：11299196
> 
> 赞同：0
> 
> 时间：2012-07-02T18:30:36.443
> 
> 标签：python, parsing

我正在编写一个带有 .ldif 和两个字符串的 python 命令行脚本。这些字符串对应于我需要在 .ldif 文件中每条记录的末尾插入的键和值。但是，我在弄清楚如何解析 .ldif 文件时遇到问题，以便我知道我在记录的末尾。当我到达记录的末尾时，我需要将两个字符串（键：值）写入文件，它们之间有一个冒号。

所以基本上我需要：

1.  从命令行解析参数（.ldif、string1、string2）
2.  创建我要附加到 .ldif 的字符串
3.  打开 .ldif 并查找到每条记录的末尾。到达记录末尾时，我需要编写从 string1 和 string2 创建的字符串。
4.  当我看到 .ldif 的 EOF 时，我需要返回带有更新记录的 .ldif 文件。

前：

```
    # 例子.ldif
    域名：Aamir_005_000
    cn: 阿米尔_25
    姓名：阿米尔

    dn: Saul_024
    cn: 扫罗石
    姓名：扫罗

```

后：`python myscript.py ./example.ldif sillyname syllabear`

```
    # 例子.ldif
    域名：Aamir_005_000
    cn: 阿米尔_25
    姓名：阿米尔
    愚蠢的名字： syllabear

    dn: Saul_024
    cn: 扫罗石
    姓名：扫罗
    愚蠢的名字： syllabear

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T18:54:16.807

### python-ldap 及其 ldif 模块

[Python 通过python-ldap 项目](http://www.python-ldap.org/)及其[ldif](http://www.python-ldap.org/doc/html/ldif.html)模块支持 LDAP 记录。

就像任何结构化文件格式一样，您希望使用强大的解析器和生成器来读取记录、操作它们并将它们写回。

您不想尝试使用正则表达式之类的技巧自己解析文件，只是在下周文件中的某些内容发生更改时让您的代码中断，然后是在那之后的一周，然后是几天之后。

您也不会尝试将 XML 节注入 XML 文件，您将使用 XML 解析器，注入您需要的内容并将其写回。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-07-02T18:33:32.493

```
import sys
with open(sys.argv[1],'r+') as f1:
    lines=[x.strip() for x in f1]
    f1.truncate(0)
    f1.seek(0)
    for x in lines:
       if x:
         f1.write(x+'\n')
       else:
         f1.write("{0}:{1}\n\n".format(sys.argv[2],sys.argv[3]))
    f1.write("{0}:{1}\n\n".format(sys.argv[2],sys.argv[3])) 
```

# php - 检索 WordPress 自定义字段值

> ID：11299206
> 
> 赞同：0
> 
> 时间：2012-07-02T18:30:54.023
> 
> 标签：php, wordpress, custom-fields

我的帖子中有 2 个自定义字段，名为 Status 和 Version。我想检索要在帖子中显示的字段状态的值。根据文档，以下内容应检索该值。

```
<?php get_post_meta($post->ID, 'Status', true); ?> 
```

然而什么都没有返回。

执行以下操作

```
<?php the_meta(); ?> 
```

返回所有自定义字段的名称和值，因此它们似乎已正确添加并正常工作。我做错了什么，或者有人有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T19:33:21.663

当你说“什么都不返回”时，你在期待什么

```
<?php get_post_meta($post->ID, 'Status', true); ?> 
```

去做？`get_post_meta`只是返回值，它不会回显它，并且您不会将其存储在变量中。是否添加`echo`，如下所示：

```
<?php echo get_post_meta($post->ID, 'Status', true); ?> 
```

做你想做的事？

# android - 如何将 Android 数据库与在线 SQL Server 同步？

> ID：11299208
> 
> 赞同：56
> 
> 时间：2012-07-02T18:31:05.557
> 
> 标签：android, sql, sqlite, synchronization

我正在开发一个 Android 应用程序，它在 Android 平台提供的内置 SQLite 中存储不同类型的数据。

在应用程序中，我放置了一个“同步”按钮，该按钮用于在本地 SQLite 数据库与我的服务器上的在线 SQL Server 数据库之间同步数据。

解决此问题的解决方法是什么？此功能可以在 Google 日历中找到，您可以在手机上查看日历的活动，当您添加新活动并同步数据时，您也可以通过访问您的在线帐户查看更新的数据。

注意：我不想在线集中我的数据库，因为我还想让移动用户能够在没有互联网连接的情况下使用该应用程序。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-07-02T19:02:38.080

您应该查看 Android SDK 演示中的 SampleSyncAdapter 项目（[使用同步适配器传输数据](http://developer.android.com/training/sync-adapters/index.html)）。它向您展示了如何进行同步“Android 风格”，无需用户交互，只需手动点击同步按钮即可。

最重要的是，您需要编写能够为您的 SyncAdapter 提供自上次提交以来所有更改的“增量”的服务器软件。最基本的方法是在您的应用程序中保留“上次同步”时间戳，该时间戳必须来自服务器，否则您可能会因为客户端和服务器之间的时间差异而遇到麻烦。将所有时间戳标准化为 GMT 或您选择的任何时区，但请坚持该决定。如果您的应用程序需要在本地时间显示时间戳，那么您需要使用 Java Calendar 和 TimeZone 类将规范化的时间戳转换为本地时间。

您的应用程序还需要将更改的本地记录标记为“脏”，以便您的 SyncAdapter 知道它需要将这些更改或新记录上传到服务器。

您的服务器软件需要以下最低功能：

*   更新现有记录功能
*   添加新记录功能
*   获取自上次同步以来的更新记录（应用程序提供时间戳）
*   获取自上次同步以来的新记录（应用程序提供时间戳）

您可能还想通读一些 Google API（如 Google Calendar）以了解所有这些工作原理以及如何设计用于通信的服务器 API 接口。

# c# - 如何将3组数据放入asp.net

> ID：11299210
> 
> 赞同：2
> 
> 时间：2012-07-02T18:31:10.043
> 
> 标签：c#, sql, asp.net, adaptor

我在尝试为我正在从事的这个项目输入数据时遇到了麻烦。我有三个`GridViews`我想用查询中的三组数据填充。下面的代码只生成了三个网格；他们都在复制第三组。

我正在尝试做的是获取第一组并将其放入第一个网格，获取第二组并将其放入第二个网格，并将第三组放入第三个网格。

我不知道为什么它只检索最后一组。我认为这与适配器方法有关？

```
public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        DataTable dt = new DataTable();
        DataTable dt2 = new DataTable();
        DataTable dt3 = new DataTable();
        SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["ISALog1ConnectionString"].ToString());
        SqlCommand cmd = new SqlCommand("exec ProxyReport", conn);
        cmd.CommandTimeout = 200;
        SqlDataAdapter ad = new SqlDataAdapter(cmd);
        ad.Fill(dt);
        ad.Fill(dt2);
        ad.Fill(dt3);

        GridView1.DataSource = dt;
        GridView1.DataBind();
        GridView2.DataSource = dt2;
        GridView2.DataBind();
        GridView3.DataSource = dt3;
        GridView3.DataBind();
    }
} 
```

这就是它所得到的，它在底部获取最后一组并将其复制 3 次。我理解代码做同样的事情，这就是它重复的原因，但为什么第三组而不是第一组或中间组？我如何让第一个网格拥有第一组，而第二个网格拥有第二组？

![在此处输入图像描述](../Images/45a5d7460b47ee1900cd3f880337c58c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:25:57.040

尝试使用数据集，并从数据集中获取数据表。

```
DataSet dataSet = new DataSet();
SqlDataAdapter ad = new SqlDataAdapter(cmd);
        ad.Fill(dataSet);

        GridView1.DataSource = dataset.Tables[0];
        GridView1.DataBind();
        GridView2.DataSource = dataset.Tables[1];
        GridView2.DataBind();
        GridView3.DataSource = dataset.Tables[2];
        GridView3.DataBind(); 
```

# python - 在 numpy recarray 中访问/分割列

> ID：11299212
> 
> 赞同：1
> 
> 时间：2012-07-02T18:31:24.193
> 
> 标签：python, csv, numpy, matplotlib

Python初学者在这里。我尴尬地花了过去两个小时试图弄清楚这一点。

我有一个`CSV`文件，其中包含第 14 行到第 86 行和第 86 列`A`的数据`X`。我把它带入了`NumPy` `recarray`using `csv2rec`。数据导入很好，但对于我来说，我无法弄清楚如何从不同的列行创建单独的数组。就此而言，我无法弄清楚如何引用`recarray`.

要引用该行，我可以只调用`array_name[0]`第一行或`array_name[1]`第二行（`array_name`作为数组的名称）。

我已经尝试对我在暂定`NumPy` [教程](http://www.scipy.org/Tentative_NumPy_Tutorial#head-4c1d53fe504adc97baf27b65513b4b97586a4fc5)中看到的内容进行解释：

```
array_name[0:5, 1] 
```

我这样做是为了在第 1-4 行抓取第二列（即使我真正想要的是整列），但即使这样也行不通。

最终我试图从数据中绘制`3d`线条，但我需要通过这第一步。`CSV``Matplotlib`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:23:23.063

原来我的 csv 列的标题就是我所需要的。

例如，如果我的列的标题行是“data1”，那么代码将是 array_name['data1'] 来拉整列

# mysql - 每个派生表都必须有自己的别名 mysql 和临时表

> ID：11299216
> 
> 赞同：1
> 
> 时间：2012-07-02T18:31:41.137
> 
> 标签：mysql, select, derived-table

任何人都可以提供帮助，因为我看不到此错误消息的来源：

> 每个派生表都必须有自己的别名

在我看来，我已经为所有表添加了别名？

```
SELECT ccdnormal.*
FROM card_call_detail AS ccdnormal
JOIN (

    SELECT ccd1.DB_CALL_ID
    FROM card_call_detail_tmp1 AS ccd1
    JOIN card_call_detail_tmp2 AS ccd2 ON ccd1.card_number = ccd2.card_number
    WHERE ccd1.start_time <> ccd2.start_time
      AND ccd1.end_time > ccd2.start_time
      AND ccd1.DB_CALL_ID <> ccd2.DB_CALL_ID
      AND ccd2.start_time BETWEEN ccd1.start_time AND ccd1.end_time

    UNION ALL

    SELECT ccd4.DB_CALL_ID
    FROM card_call_detail_tmp3 AS ccd3
    JOIN card_call_detail_tmp4 AS ccd4 ON ccd3.card_number = ccd4.card_number
    WHERE ccd3.start_time <> ccd4.start_time
      AND ccd3.end_time > ccd4.start_time
      AND ccd3.DB_CALL_ID <> ccd4.DB_CALL_ID
      AND ccd4.start_time BETWEEN ccd3.start_time AND ccd3.end_time )

) AS CCDOUTPUT ON CCDOUTPUT.DB_CALL_ID = ccdnormal.DB_CALL_ID 
```

# sql - 如何优化此 SQL 查询（使用索引）？

> ID：11299217
> 
> 赞同：1
> 
> 时间：2012-07-02T18:31:41.593
> 
> 标签：sql, indexing

有一个查询运行得比我想要的慢，但我无法分享详细信息。该查询已经返回了正确的结果，并且我已经对其进行了重构，但我无法让它足够快地运行。谓词在可能的情况下已经是[Sarg-able](https://stackoverflow.com/questions/799584/what-makes-a-sql-statement-sargable)的。它已经正确地使用了连接，不请求额外的表，并且不会不必要地复制行或使用嵌套子查询来减慢它的速度。

我不是 DBA，我还不知道如何选择一个好的索引来使我的查询更快。我可以改变表结构；没有负责数据库的 DBA，我在数据库服务器上拥有这样做的权限。

我应该采取哪些步骤来优化我的 SQL 查询？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-02T18:31:43.200

**简介：**这里有很多要讨论的内容，而且由于 SQL 的复杂性，任何人都无法完全帮助您完成查询——重要的是您的查询是什么、表有多大以及数据库是什么正在使用的系统是。如果您不知道什么是索引或如何使用它们，请参阅此处：[数据库索引如何工作？](https://stackoverflow.com/questions/1108/how-does-database-indexing-work).

**注意事项：**同样，如果您的系统有 DBA，请在索引任何内容之前与他们核实，尤其是在实时系统上。如果你对他们好，他们甚至可以提供帮助。如果系统被许多其他人使用，在更改索引等任何内容之前要小心。如果数据被用于多种查询类型，请确保您没有在它们上创建大量冲突或重叠的索引。

**句法。**标准 (SQL92) 使用：`CREATE INDEX [index name] ON [table name] ( [column name] )`. 这种语法几乎适用于任何系统。如果表上只需要一个索引，并且还没有聚集索引，则可以使用：`CREATE [Unique] Clustered INDEX [index name] ON [table name] ( [column name] )`- 如果不能有多个具有相同值的项，则它应该是唯一的。如果您不能让它工作，请参阅这篇文章了解更多详细信息：[如何索引数据库列](https://stackoverflow.com/questions/1156/how-do-i-index-a-database-column)。

**哪些表应该被索引？**任何用于查询的表，尤其是当数据是静态的或只获取新值时，都是很好的候选者。如果该表在您的查询中，并且有一个连接语句，您可能希望在被连接的列上有一个索引。

**应该索引哪些列？**有关于选择最佳索引以及如何正确索引数据库的完整书籍。如果您不想深入研究问题，索引的基本经验法则是：按以下顺序索引：

1.  连接谓词 ( `on Table1.columnA=Table2.ColumnA and Table1.columnB=Table2.ColumnQ`)
2.  过滤列 ( `where Table1.columnN=’Bob’ and Table1.columnS<20`)
3.  排序方式/分组方式/等（如果可能，任何用于排序/分组的列都应该在索引中。）

还：

*   使用有意义的数据类型 - 如果它是整数或日期，则不将任何内容存储为 varchar。（列宽很重要。尽可能使用最小的数据类型。）
*   确保您的联接是相同的数据类型 - int 到 int，varchar 到 varchar，等等。
*   如果可能，请在每个表中的每个连接谓词上使用唯一的非空索引。
*   确保任何可能的列都是非空的。（如果它们不能包含空值，您可以使用以下语法。

    ```
     Alter table Table1 
        alter column columnN int not null 
    ```

做这一切，你就会一路走好。**但是，如果您经常需要这些东西，请学习它！**买一本书，在线阅读，查找信息。那里有很多信息，而且这是一个很深的话题，但是如果您知道自己在做什么，就可以更好地进行查询。

# regex - 使用 cgi 验证 URL

> ID：11299220
> 
> 赞同：-1
> 
> 时间：2012-07-02T18:31:46.947
> 
> 标签：regex

我需要一个可以让我验证 Url 的正则表达式。我找到了这个：

```
"^(http(?:s)?\:\/\/[a-zA-Z0-9\-]+(?:\.[a-zA-Z0-9\-]+)*\.[a-zA-Z]{2,6}(?:\/?|(?:\/[\w\-]+)*)(?:\/?|\/\w+\.[a-zA-Z]{2,4}(?:\?[\w]+\=[\w\-]+)?)?(?:\&[\w]+\=[\w\-]+)*)$" 
```

但我的问题是，除了常规 url，我还需要允许 .cgi 路径，没有“http(s)”，如下所示：

123.45.678.543:30/cgi-bin/blah/blah.cgi

您能帮我弄清楚如何将其添加到上面的表达式中吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T18:48:05.467

在我看来，您发布的 RegExp 似乎不足以验证任何类型的 URL。看看[检查字符串是否为有效 URL 的最佳正则表达式是什么？](https://stackoverflow.com/questions/161738/what-is-the-best-regular-expression-to-check-if-a-string-is-a-valid-url)（尤其是@eyelidlessness 的回答）也许可以找到更详细的答案。

您的 URL 的问题不在于它指向某个 cgi 文件。问题是它应该——至少（在你可能（？）谈论的情况下）——是

```
http://123.45.678.543:30/cgi-bin/blah/blah.cgi 
```

此外，IP 地址中的数字最多可以是 255。即使进行了这些更正，它仍然不符合应用您发布的 RegExp 的条件，但这只是对您的 RegExp 错误的又一提示。

# javascript - 在 jQuery 中重新排序表单数组的聪明、有效的方法？

> ID：11299223
> 
> 赞同：1
> 
> 时间：2012-07-02T18:31:51.657
> 
> 标签：javascript, jquery

我的网页上有一个项目列表，用户可以从中动态添加和删除。每个项目都类似于：

```
<tr id="LELOC_0">
    <td>
        <label title="" for="LE">
            Legal Entity:</label>
        <input type="text" value="0" name="CAS.LERoles[0].LE" id="CAS_LERoles_0__LE" data-val-required="The Legal Entity field is required."
            data-val-number="The field Legal Entity must be a number." data-val="true" class="tinyText">
        <br>
        <label title="" for="LOC">
            Location:</label>
        <input type="text" value="0" name="CAS.LERoles[0].LOC" id="CAS_LERoles_0__LOC" data-val-required="The Location field is required."
            data-val-number="The field Location must be a number." data-val="true" class="tinyText">
    </td>
    <td>
        <label title="" for="APMasterRole">
            AP Master Role:</label>
        <select name="CAS.LERoles[0].APMasterRole" id="CAS_LERoles_0__APMasterRole">
            <option value="0" title="">None</option>
            <option value="1" title="">LBK</option>
            <option value="2" title="">General Manager</option>
            <option value="3" title="">Publisher</option>
            <option value="4" title="">RAM</option>
            <option value="5" title="">District Manager</option>
            <option value="6" title="">Corp0</option>
            <option value="7" title="">Corp1</option>
            <option value="8" title="">Corp2</option>
        </select>
        <br>
        <label title="" for="WebPortalRole">
            Web Portal Role:</label>
        <select name="CAS.LERoles[0].WebPortalRole" id="CAS_LERoles_0__WebPortalRole">
            <option value="0" title="">None</option>
            <option value="1" title="">Admin</option>
            <option value="2" title="">LBK</option>
            <option value="3" title="">PUB</option>
            <option value="4" title="">Security</option>
            <option value="5" title="">RAM</option>
            <option value="6" title="">CAS</option>
            <option value="7" title="">Site Data Entry</option>
        </select>
        <br>
        <label title="" for="AnyViewIDSRole">
            AnyView IDS Role:</label>
        <select name="CAS.LERoles[0].AnyViewIDSRole" id="CAS_LERoles_0__AnyViewIDSRole">
            <option value="0" title="">None</option>
            <option value="1" title="">Administrators</option>
            <option value="2" title="">All Access</option>
            <option value="3" title="">CORP</option>
            <option value="4" title="">GL</option>
            <option value="5" title="">LBK</option>
            <option value="6" title="">Other</option>
            <option value="7" title="">PUB</option>
            <option value="8" title="">RBK</option>
            <option value="9" title="">RM</option>
        </select>
    </td>
    <td>
        <label title="" for="APMasterPurchaseApprover">
            AP Master Approver:</label>
        <input type="text" value="" name="CAS.LERoles[0].APMasterPurchaseApprover" id="CAS_LERoles_0__APMasterPurchaseApprover"
            data-val-requiredif-operator="EqualTo" data-val-requiredif-dependentvalue="LBK"
            data-val-requiredif-dependentproperty="APMasterRole" data-val-requiredif="If the user is in the AP Master LBK role, the AP Master Purchase Approver must be provided."
            data-val="true" class="smallText">
        <br>
        <label title="" for="WebPortalPurchaseApprover">
            Web Portal Approver:</label>
        <input type="text" value="" name="CAS.LERoles[0].WebPortalPurchaseApprover" id="CAS_LERoles_0__WebPortalPurchaseApprover"
            data-val-requiredif-operator="EqualTo" data-val-requiredif-dependentvalue="LBK"
            data-val-requiredif-dependentproperty="WebPortalRole" data-val-requiredif="If the user is in the Web Portal LBK role, the Web Portal Purchase Approver must be provided."
            data-val="true" class="smallText">
    </td>
    <td>
        <button class="deleteButton" id="btnDelete_0" type="button">
            Delete</button>
        <button class="addButton" id="btnAdd_0" type="button">
            Add</button>
    </td>
</tr> 
```

诀窍是，如果用户删除该项目，我想重新排序列表，以便在回发到服务器时，序列号没有间隙。我对此的第一个想法是遍历所有`<tr>`元素和正则表达式匹配/替换序列号，但这看起来真的很乱。所以我想知道，有没有一种漂亮的 javascript/jQuery 方法可以让这个简单？否则我可能会说“搞砸”并检查服务器端是否缺少序列。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T18:39:27.253

在表单发布之前，您可以轻松地遍历所有 TR 元素并更新 id 属性。

```
var newValue = "LELOC_";
$("tr").each(function(i, row) {
   $(row).attr("id", newValue + i);
}); 
```

在表单提交之前执行此操作，它会将它们全部更改为按顺序排列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T18:46:30.280

序列号在可编辑的同时是否与页面相关？如果没有，只需省略它们并仅在保存时生成它们。

```
function generateItemsToSave() {
    var itemsToSave = [];
    jQuery('tr').each(function(pos, el) {
        var locData = {
          id: 'LELOC_' + itemsToSave.length,
          //Build rest of locData from el
        };
        itemsToSave.push(locData);
    });
    return itemsToSave;
}
saveItems(generateItemsToSave()); 
```

# java - 如何解析 XML 字符串并检索元素的字符索引？

> ID：11299229
> 
> 赞同：4
> 
> 时间：2012-07-02T18:32:33.400
> 
> 标签：java, xml, string, parsing, indexing

如标题所示，我目前正在处理解析 XML 格式字符串的需求，同时能够存储有关原始字符串中元素标记开头和元素标记结尾的字符索引的信息。我查看了 SAX 和 DOM，但似乎找不到任何可以为我提供这些数据的东西。有什么建议么？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T18:46:28.960

不确定是否有帮助，但鉴于 SAX 是连续的，你不能保留一个字符计数器吗？唯一的问题是一些空格可能会被忽略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T20:13:20.470

您可能想查看`Locator`和。作为给出行号和列号的示例：`DefaultHandler``SAXParser`

```
public static void main(String[] args) throws SAXException, IOException, ParserConfigurationException {
    String xml = 
            "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
            "<project \n"+ 
            ">\n"+
            "    <description>A description</description>\n"+
            "</project>\n";
    SAXParserFactory spf = SAXParserFactory.newInstance();
    SAXParser sp = spf.newSAXParser();
    InputSource inps = new InputSource(new StringReader(xml));
    DefaultHandler df = new XDefaultHandler();
    sp.parse(inps, df);
}

static class XDefaultHandler extends DefaultHandler {
    Locator l = null;

    @Override
    public void setDocumentLocator(Locator locator) {
        l = locator;
    }

    @Override
    public void startElement(String uri, String localName, String qName,
            Attributes attributes) throws SAXException {
        System.out.println("element: " + qName);
        System.out.println("locator: " + l.getLineNumber() + "/" + l.getColumnNumber());
    }
} 
```

输出是：

```
element: project
locator: 3/2
element: description
locator: 4/18 
```

覆盖 XDefaultHandler 中的其他方法以接收对元素结束等的调用。

编辑：（太早按下按钮）

从以下文档`Locator.getLineNumber()`：

> 返回当前文档事件结束的行号。行由 XML 规范中定义的行尾分隔。
> 
> 警告：该方法的返回值仅用作诊断的近似值；它不是为了提供足够的信息来编辑原始 XML 文档的字符内容。在某些情况下，这些“行”号与将显示为列的内容相匹配，而在其他情况下，由于内部实体扩展，它们可能与源文本不匹配。
> 
> 返回值是触发事件的标记出现的文档实体或外部解析实体中行号的近似值。

# objective-c - 使用 ARC 发布

> ID：11299230
> 
> 赞同：1
> 
> 时间：2012-07-02T18:32:44.270
> 
> 标签：objective-c, ios, automatic-ref-counting

这里的基本问题。我开始使用 ARC，但不确定是否应该在另一个对象获得所有权的情况下释放对象。

例如`[self.view addSubview:someViewController.view];`

是否应该发布此视图，或者我可以保持原样吗？

数组也是如此，当将对象添加到数组时，我应该在之后释放它们，因为数组具有对象所有权还是我可以离开它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T18:35:32.137

对于这种情况`[self.view addSubview:someViewController.view];`，如果 someViewController 是一个强属性，那么在使用它之后，你应该调用`self.someViewController = nil`

对于一个数组，你不会在对象上调用 release，但如果数组是一个强属性，那么当你完成它时，你需要将它设置为 nil

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T18:41:56.400

使用 ARC，您*可能不会*发布任何内容。编译器将确定何时何地释放给定对象——你不能自己做。

如果您*不*使用 ARC，那么答案将是：*如果*您已保留（或复制、分配或使用 new 创建）对象，则释放该对象，*并且*您已完成引用。因此，如果您使用 创建一个对象`alloc`，将其添加到数组中，随后不再需要自己跟踪该对象，那么是的，您应该释放它。数组和其他集合将保留它们包含的对象。但同样，这只是在您*不*使用 ARC 的情况下；如果您*正在*使用它，那么您无需担心释放任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T18:34:17.957

在 ARC 中不再释放和保留，保持原样。

# html - 谷歌地图信息窗口高度不起作用

> ID：11299235
> 
> 赞同：1
> 
> 时间：2012-07-02T18:33:06.320
> 
> 标签：html, css, google-maps

我正在使用 google maps javascript API，我想创建一个高度为 50px 的小型 InfoWindow，我使用 infowindow.SetOptions({height:50}) 但它什么也没做！如何设置我的身高？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T20:47:27.160

为您的 infoWindow 元素提供一个 ID/类，您可以通过将 infoWindow 的内容变量放在`div`如下所示中来做到这一点：

```
var contentString = "<div id='content'>Your content goes here</div>"; 
```

然后使用 CSS 调整高度：

```
#content{
    height: 50px;
} 
```

# python - 获取列表的所有组合（笛卡尔积）的最佳方法是什么？

> ID：11299236
> 
> 赞同：3
> 
> 时间：2012-07-02T18:33:09.330
> 
> 标签：python, multidimensional-array

假设我有以下内容。

```
a = [[1,2,3],[4,5,6],[7,8,9]]
b = [['a','b'],['c','d'],['e','f']] 
```

如何获得以下内容？

```
[1,2,3,'a','b']
[1,2,3,'c','d']
[1,2,3,'e','f']
[4,5,6,'a','b']
[4,5,6,'c','d']
[4,5,6,'e','f']
[7,8,9,'a','b']
[7,8,9,'c','d']
[7,8,9,'e','f'] 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-02T18:34:25.213

```
from itertools import product
a = [[1,2,3],[4,5,6],[7,8,9]]
b = [['a','b'],['c','d'],['e','f']]

print [x+y for (x,y) in product(a,b)] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-02T18:37:00.080

```
In [1]: from itertools import product

In [2]: a = [[1,2,3],[4,5,6],[7,8,9]]

In [3]: b = [['a','b'],['c','d'],['e','f']]

In [4]: map(lambda x: x[0]+x[1], product(a, b))
Out[4]: 
[[1, 2, 3, 'a', 'b'],
 [1, 2, 3, 'c', 'd'],
 [1, 2, 3, 'e', 'f'],
 [4, 5, 6, 'a', 'b'],
 [4, 5, 6, 'c', 'd'],
 [4, 5, 6, 'e', 'f'],
 [7, 8, 9, 'a', 'b'],
 [7, 8, 9, 'c', 'd'],
 [7, 8, 9, 'e', 'f']] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-02T18:36:48.420

```
>>> a = [[1,2,3],[4,5,6],[7,8,9]]
>>> b = [['a','b'],['c','d'],['e','f']]
>>> [x+y for x in a for y in b]
[[1, 2, 3, 'a', 'b'], [1, 2, 3, 'c', 'd'], [1, 2, 3, 'e', 'f'], [4, 5, 6, 'a', 'b'], [4, 5, 6, 'c', 'd'], [4, 5, 6, 'e', 'f'], [7, 8, 9, 'a', 'b'], [7, 8, 9, 'c', 'd'], [7, 8, 9, 'e', 'f']] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-02T18:36:52.980

```
a = [[1,2,3],[4,5,6],[7,8,9]]
b = [['a','b'],['c','d'],['e','f']]
c = []
for x in a:
    for y in b:
        print x + y
        c.append(x + y) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-02T18:47:46.613

只是为了好玩，因为玛丽亚的回答要好得多：

```
from itertools import product
a = [[1,2,3],[4,5,6],[7,8,9]]
b = [['a','b'],['c','d'],['e','f']]
print [sum(x, []) for x in product(a, b)] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-02T18:47:56.170

只是为了看看你是否可以浓缩`product`表达，我想出了这个：

```
>>> from itertools import product
>>> map(lambda x: sum(x, []), product(a, b))
[[1, 2, 3, 'a', 'b'], [1, 2, 3, 'c', 'd'], [1, 2, 3, 'e', 'f'], [4, 5, 6, 'a', 'b'], [4, 5, 6, 'c', 'd'], [4, 5, 6, 'e', 'f'], [7, 8, 9, 'a', 'b'], [7, 8, 9, 'c', 'd'], [7, 8, 9, 'e', 'f']] 
```

# javascript - OOP JavaScript - 创建自定义 Div 对象

> ID：11299238
> 
> 赞同：3
> 
> 时间：2012-07-02T18:33:12.623
> 
> 标签：javascript, jquery, oop, custom-component

我刚刚开始使用 JavaScript 中的 OOP。我想创建一个自定义“面板”。这是我到目前为止所拥有的：

```
function ShinyPanel(css, attributes)
{
    this.container = $(document.createElement("div")).addClass("shinyPanel");

    this.titleBar = $(document.createElement("div")).addClass("shinyPanelTitleBar").appendTo(this.container);
    this.topShine = $(document.createElement("div")).addClass("shinyPanelTopShine").appendTo(this.container);
    this.leftShine = $(document.createElement("div")).addClass("shinyPanelLeftShine").appendTo(this.container);
    this.content = $(document.createElement("div")).addClass("shinyPanelContent").appendTo(this.container);

    if (!css) css = {};
    if (!attributes) attributes = {};

    this.css = css;
    $(this.container).css(this.css);

    this.title = attributes["title"];
    $(this.titleBar).html(this.title);
} 
```

现在我可以实例化这个对象并通过这样的方式将它附加到正文中：

```
var panel = new ShinyPanel({position:"absolute", top:"25%", width:"300px", height:"200px"}, {title:"Test"});
$("body").append(panel.container); 
```

我的问题是，有没有办法让对象本身成为一个 div，从而消除对“容器”div 的需要？然后我就可以打电话了`$("body").append(panel);`。

将容器 div 放在那里对我来说并不是那么麻烦，它更适合我......想要学习正确的做事方式。

我试过`this = document.createElement("div");`了，但我得到了一个错误：`invalid assignment left-hand side`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T20:32:01.343

您所描述的基本上是 UI 框架能够完成的工作。

查看小部件工厂文档以开始使用：

[http://wiki.jqueryui.com/w/page/12138135/Widget%20factory](http://wiki.jqueryui.com/w/page/12138135/Widget%20factory)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T18:37:31.653

我建议有一种`ShinyPanel`方法来处理这个问题。告诉，不要问。

```
function ShinyPanel(css, attributes) {
...
   this.appendTo = function (to) {
      $(to).append(this.container);
   } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T18:37:39.777

您可以`this.container`直接从您的构造函数返回，假设您不打算使用您添加到其中的任何其他属性。

为此，我*认为*您必须将其更改为工厂方法，而不是构造函数（即不再使用`new`- 尽管它还有更多功能）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T18:42:36.443

当您想要做的只是将它附加到正文时，而不是返回一个对象，您可以只用面板返回一个字符串。

像这样的东西：

```
function shinyPanel(css, attributes) {
    ... all the stuff you did before
    return this.container
} 
```

此外，如果您想在您的该`shinyPanel`功能中实现一些速度，您可以尝试添加标记字符串，然后只使用`append`一次。

还可以查看使用数组作为返回字符串的持有者，然后`.join('')`在返回时使用。

更多信息： http: [//www.learningjquery.com/2009/03/43439-reasons-to-use-append-correctly](http://www.learningjquery.com/2009/03/43439-reasons-to-use-append-correctly)

# json - 更改密码后更新部分视图

> ID：11299243
> 
> 赞同：1
> 
> 时间：2012-07-02T18:33:42.337
> 
> 标签：json, asp.net-mvc-3

在部分视图中更改密码后，我不知道如何留在同一页面。当我单击“提交”按钮时，它会将我带到另一个页面，我想留在同一页面，只显示一条消息，如“密码更改成功”我知道密钥在

```
if (changePasswordSucceeded)
            {
                return RedirectToAction("ChangePasswordSuccess");

            } 
```

我试过了

```
return Json(true) 
```

但我不知道如何处理仅更新页面的结果。

谢谢

更新：主视图

```
@model Points2Pay.Models.Usuario
@using Points2Pay.Extensions;

@{
    ViewBag.Title = @Resources.Points2pay.Usuario_Tools2;
    ViewBag.Head = @Resources.Points2pay.Usuario_Tools2;
}

<h2>@Resources.Points2pay.Usuario_Head4</h2>

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

@using (Html.BeginForm())
{
    @Html.ValidationSummary(true)
    <fieldset>
        <legend>@Resources.Points2pay.Account_Text5</legend>

        @Html.HiddenFor(model => model.UsuarioId)
        @Html.HiddenFor(model => model.EmailAlterno)

        <div class="editor-label">
            @Html.LabelFor(model => model.Nombre) @Html.RequiredFieldFor(model => model.Nombre)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Nombre)
            @Html.ValidationMessageFor(model => model.Nombre)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Apellidos) @Html.RequiredFieldFor(model => model.Apellidos)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Apellidos)
            @Html.ValidationMessageFor(model => model.Apellidos)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Direccion) @Html.RequiredFieldFor(model => model.Direccion)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Direccion)
            @Html.ValidationMessageFor(model => model.Direccion)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Pais) @Html.RequiredFieldFor(model => model.Pais)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Pais)
            @Html.ValidationMessageFor(model => model.Pais)
        </div>

        @*<div class="editor-label">
            @Html.LabelFor(model => model.EmailAlterno)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.EmailAlterno)
            @Html.ValidationMessageFor(model => model.EmailAlterno)
        </div>*@

        <div class="editor-label">
            @Html.LabelFor(model => model.Telefono) @Html.RequiredFieldFor(model => model.Telefono)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Telefono)
            @Html.ValidationMessageFor(model => model.Telefono)
        </div>

@*        <div class="editor-label">
            @Html.LabelFor(model => model.FechaAlta)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.FechaAlta)
            @Html.ValidationMessageFor(model => model.FechaAlta)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Estatus)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Estatus)
            @Html.ValidationMessageFor(model => model.Estatus)
        </div>*@

@*        <div class="editor-label">
            @Html.LabelFor(model => model.Saldopublic)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Saldopublic)
            @Html.ValidationMessageFor(model => model.Saldopublic)
        </div>*@

@*        <br />
           @Html.ActionLink(@Resources.Points2pay.ChangePassword, "ChangePassword", "Account", new { id = Model.UsuarioId }, null)
           <br />*@
        <p>
            <input type="submit" value="@Resources.Points2pay.btn_Guardar" />
        </p>
    </fieldset> @Resources.Points2pay.CamposObligatorios <br />
}

<input type="submit" class="flip" value="@Resources.Points2pay.ChangePassword" />
<div class="panel">
@Html.Action("ChangePasswordPartial","Account")
</div>

<script type="text/javascript">
    $(document).ready(function () {
        $(".panel").hide();
        $(".flip").click(function () {
            $(".panel").slideToggle("slow");
        });
    });
</script> 
```

局部视图

```
@model Points2Pay.Models.ChangePasswordModel

@{
    ViewBag.Title = Resources.Points2pay.ChangePassword;
    ViewBag.Head = Resources.Points2pay.ChangePassword;
}

<h2>@Resources.Points2pay.Account_Head1</h2>
<p>
    @Resources.Points2pay.Account_Text1 
</p>
<p>
    @Resources.Points2pay.Account_Text2 @Membership.MinRequiredPasswordLength @Resources.Points2pay.Account_Text3
</p>

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

@using (Html.BeginForm()) {
    @Html.ValidationSummary(true, @Resources.Points2pay.Account_Text4)
    <div>
        <fieldset>
            <legend>@Resources.Points2pay.Account_Text5</legend>

            <div class="editor-label">
                @Html.LabelFor(m => m.OldPassword)
            </div>
            <div class="editor-field">
                @Html.PasswordFor(m => m.OldPassword)
                @Html.ValidationMessageFor(m => m.OldPassword)
            </div>

            <div class="editor-label">
                @Html.LabelFor(m => m.NewPassword)
            </div>
            <div class="editor-field">
                @Html.PasswordFor(m => m.NewPassword)
                @Html.ValidationMessageFor(m => m.NewPassword)
            </div>

            <div class="editor-label">
                @Html.LabelFor(m => m.ConfirmPassword)
            </div>
            <div class="editor-field">
                @Html.PasswordFor(m => m.ConfirmPassword)
                @Html.ValidationMessageFor(m => m.ConfirmPassword)
            </div>

            <p>
                <input type="submit" value="@Resources.Points2pay.ChangePassword_Boton1" />
            </p>
        </fieldset>
    </div>
}
<script>
    $(document).ready(function () {
        $('form').submit(function (e) {
            $.ajax({
                url: $(this).action,
                type: 'POST', //I'm assuming this could be type GET.
                data: $(this).serialize,
                dataType: 'json',
                success: function (data) {
                    alert('ajax successfully');
                }
            });
            e.preventDefault();
        });
    });
</script> 
```

控制器

```
[Authorize]
        [HttpPost]
        public ActionResult ChangePassword(ChangePasswordModel model)
        {
            if (ModelState.IsValid)
            {

                // ChangePassword will throw an exception rather
                // than return false in certain failure scenarios.
                bool changePasswordSucceeded;
                try
                {
                    MembershipUser currentUser = Membership.GetUser(User.Identity.Name, true /* userIsOnline */);
                    changePasswordSucceeded = currentUser.ChangePassword(model.OldPassword, model.NewPassword);
                }
                catch (Exception)
                {
                    changePasswordSucceeded = false;
                }

                if (changePasswordSucceeded)
                {
                    //return RedirectToAction("ChangePasswordSuccess");
                    return Json(true);

                }
                else
                {
                    ModelState.AddModelError("", Resources.Points2pay.Account_Error22);
                    //
                    //English
                    //ModelState.AddModelError("", "The current password is incorrect or the new password is invalid.");
                }
            }

            // If we got this far, something failed, redisplay form
            return View(model);
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:57:29.633

如果您使用按钮提交类型，您需要避免浏览器的默认行为，换句话说，防止回发。为此，您需要使用 ajax 从客户端调用您的操作，捕获按钮的事件提交并发送数据。假设您正在使用类似这样的 jquery

```
<script type="text/javascript">
    $(document).ready(function(){
        $('.panel form').submit(function(e){
            $.ajax({
               url: $(this).action,
               type: 'POST' //I'm assuming this could be type GET.
               data: $(this).serialize,
               dataType: 'json',
               success: function(data){
                   alert('ajax successfully');
               }
            });
            e.preventDefault();
        });
    });
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T16:06:00.687

```
<div id="ShowResultHere"></div>

@using (Html.BeginForm("Update", "Test", FormMethod.Post, new { id="frmUpdate"}))
{
   //form fields
   <button type="submit" class="sprt bg_red bt_red h27">Update</button>
}

[HttpPost]
public ActionResult Update(TestModel model)
{
   return Json(new { s = "Success" });
}

$(function() {
    $('#frmUpdate').submit(function() {
        $.ajax({
            url: this.action,
            type: this.method,
            data: $(this).serialize(),
            success: function(result) {
               // The AJAX call succeeded and the server returned a JSON 
               // with a property "s" => we can use this property
               // and set the html of the target div
               $('#ShowResultHere').html(result.s);
            }
        });
        // it is important to return false in order to 
        // cancel the default submission of the form
        // and perform the AJAX call
        return false;
    });
}); 
```

# objective-c - ARC中的“一劳永逸”课程

> ID：11299247
> 
> 赞同：5
> 
> 时间：2012-07-02T18:34:00.497
> 
> 标签：objective-c, ios, automatic-ref-counting

我需要`UIAlertView`为我的应用程序进行自定义，我看到[了这篇](http://mobile.tutsplus.com/tutorials/iphone/ios-sdk-uialertview-custom-graphics/)描述如何做的文章。从那以后，我对其进行了一些更改，但更重要的事实仍然是这个类不能起到“一发不可收拾”警报的`UIAlertView`作用，因为 ARC 不允许调用`retain`.

所以基本上，我希望能够以与普通警报视图相同的方式使用我的自定义警报视图，因此我可以像这样创建和显示一个：

```
CustomAlertView *alert = [[CustomAlertView alloc] init];//Init presumably does the view setup
[alert show]; 
```

所以我的问题是，在 ARC 项目中工作时，如何让该对象不在超出范围时立即释放，而不`strong`在调用类中创建对它的引用？

**编辑**

我想值得一提的是，为了获得我想要的完全自由的视图可定制性，我必须将它设为一个新的 ViewController 类，它**不是**`UIAlertView`

**编辑 2**

对不起，我没有仔细看我的链接，我最初链接了错误的教程。 [这](http://iphonedevelopment.blogspot.com/2010/05/custom-alert-views.html)是我基于我的观点的正确教程

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:58:42.590

如果你想模仿工作方式`UIAlertView`，你需要创建一个新`UIWindow`对象，正确初始化它并使用`[window makeKeyAndVisible]`. 请注意，这将呈现，但*不会*保留窗口。如果窗口的引用计数降至零，则该窗口将从屏幕上移除。

您想故意创建一个保留周期，一旦您的警报视图被解除，您就会中断该保留周期。

即您的 customalertview 类创建并保留 a `UIWindow`，并`UIWindow`保留其子视图：您的 customalertview 类。然后，通过释放`UIWindow`，窗口将释放您的 customalertview。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T18:44:37.487

您必须在需要时对您的子类实例进行强引用。例如，您可以通过在视图控制器中显示您的对象（因为视图控制器层次结构得到强烈维护）或通过对您的类的所有仍需要的实例进行类级引用来做到这一点。

# javascript - 使用 css3 比例模糊 Metro 应用程序中的视图

> ID：11299251
> 
> 赞同：0
> 
> 时间：2012-07-02T18:34:11.027
> 
> 标签：javascript, jquery, css, scale

我正在尝试将 DIV 缩放到 0.8 倍，这导致 DIV 变得模糊。它似乎在 Chrome 和 Safari 中运行良好，但在 Metro 应用程序中变得模糊。

我尝试使用一些 Jquery transform2d 插件，认为可能是 CSS 渲染速度较慢，但​​模糊效果也在那里。

有人可以建议解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T18:36:31.313

您可以尝试将原始 div 缩小，然后将其放大到实际大小，从而使其看起来放大！

# regex - 递归排序的正则表达式

> ID：11299254
> 
> 赞同：0
> 
> 时间：2012-07-02T18:34:15.993
> 
> 标签：regex, regular-language

我正在尝试构建一个正则表达式，我被要求过滤字符串，例如：

`country:India provinces:Uttranchal city:Dehradun zip_code:12345`

从这样的字符串：

`keyword: one two three country:India provinces:Uttranchal city:Dehradun zip_code:12345 filter: myparameter`

现在我准备了一个基本的正则表达式，例如：

```
country:\w+|provinces:\w+|city:\w+|zip_code:\w+ 
```

`country`如果, `provinces`,`city`是单个词，哪种对我有用

但如果他们不是例子

`keyword: one two three country:United-States provinces:Manhattan city:New-York zip_code:12345 filter: myparameter`

由于非单词字符的限制，上述 reqex 不起作用`-`

您可以假设国家，省或城市，并有许多加入的词`-`

像

`country:United-States-of-America provinces:Washington-Dc city:New-York-West`

**等等等等……**

`-\w+`一种递归模式 `country`也是如此`provinces``city`

现在我也尝试为类似这样的东西构建一个正则表达式

`(country:\w+(-\w+)*)|(province:\w+(-\w+)*)|(city:\w+(-\w+)*)|(zip_code:\w+(-\w+)*)`

这虽然匹配，但正如您在 rubular [screenshot](http://i49.tinypic.com/2qjxhcj.png) attach 中看到的那样，它也呈现了不可接受的输出和 nil

我想要的只是避免在从给定的输入字符串中分离所需的字符串时导致匹配结果出现问题的`non-accepted`and输出，或者有人可以建议我比这更好的正则表达式。`nil`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:29:26.013

是`(...)`捕获组。Ruby（如果你正在使用的话）也支持 non-capture groups `(?:...)`，所以我认为你想要：

```
(country:\w+(?:-\w+)*)|(province:\w+(?:-\w+)*)|(city:\w+(?:-\w+)*)|(zip_code:\w+(?:-\w+)*) 
```

甚至：

```
(country:\w+(?:-\w+)*|province:\w+(?:-\w+)*|city:\w+(?:-\w+)*|zip_code:\w+(?:-\w+)*) 
```

如果您希望它们都在捕获组 1 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:38:04.917

如果你想匹配一组一个或多个字母和破折号，你可以用括号来表示一个[字符集](http://www.regular-expressions.info/charclass.html)：`[\w\-]+`

```
country:[\w\-]+|provinces:[\w\-]+|city:[\w\-]+|zip_code:[\w\-]+ 
```

Python中的两行示例：

```
>>> s = "keyword: one two three country:United-States provinces:Manhattan city:New-York zip_code:12345 filter: myparameter"
>>> print re.findall("country:[\w\-]+|provinces:[\w\-]+|city:[\w\-]+|zip_code:[\w\-]+", s)
['country:United-States', 'provinces:Manhattan', 'city:New-York', 'zip_code:12345'] 
```

# c++ - 模板虚函数

> ID：11299261
> 
> 赞同：1
> 
> 时间：2012-07-02T18:35:02.310
> 
> 标签：c++, templates, virtual

这是一些代码：

```
class IWorker {
public:
    virtual void Do(int x) const = 0;
};

class TSomeWorker : public IWorker {
    void Do(int x) const {
        // ...
    }
}; 
```

现在，假设我们需要重构它，使得函数 Do 应该成为模板（int 更改为某个 T）。我知道 C++ 不允许创建模板虚函数。有没有其他选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T18:38:09.420

这取决于您的具体需求。但是根据您发布的内容，我建议：

```
template<typename T>
class IWorker {
public:
    virtual void Do(T x) const = 0;
};

template<typename T>
class TSomeWorker : public IWorker<T> {
    void Do(T x) const {
        // ...
    }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T18:56:13.867

因此，您想混合使用静态多态性（模板）和运行时多态性（虚拟函数），但它们是正交的。在这种情况下，您需要强制转换：

```
class IWorker {
public:
    virtual void Do(void* x) const = 0;
};

template< typename T >
class TSomeWorker : public IWorker {
    void Do(void* x) const {
        T* realX = reinterpret_cast< T* >( x );
        // ...
    }
}; 
```

# c# - 文件访问重试超时 (ASP.NET WebPages/Razor/C#)

> ID：11299263
> 
> 赞同：0
> 
> 时间：2012-07-02T18:35:25.083
> 
> 标签：c#, asp.net, .net, sql-server, entity

查看访问我的数据库的页面时，我不断收到不支持的关键字：“文件访问重试超时”错误。

所以我假设它无法访问数据库。就在几分钟前，当我查看我的主页时，我遇到了同样的问题。我改变了（在我的 _AppStart.cshtml 文件中）这个：

```
WebSecurity.InitializeDatabaseConnection("MYDB", etc, etc, etc, etc); 
```

到：

```
WebSecurity.InitializeDatabaseConnection("Data Source=|DataDirectory|\\MYDB.sdf", "System.Data.SqlServerCe.4.0", etc, etc, etc, etc); 
```

它奏效了！

*但是*，当我转到另一个页面时（它试图从 C# 类访问数据库，（.cs 文件）我得到了同样的错误！

但是，在我的 C# 文件 (.cs) 中 - 我无法更改：

```
var database = Database.Open("MYDB"); 
```

到：

```
var database = Database.Open("Data Source=|DataDirectory|\\MYDB.sdf", "System.Data.SqlServerCe.4.0", etc, etc, etc, etc); 
```

...因为它说：

方法 'Open' 没有重载需要 2 个参数（显然）。

错误（在 .cs 文件中进行上述更改之前：

> ## “/”应用程序中的服务器错误。
> 
> 不支持关键字：“文件访问重试超时”。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.ArgumentException：不支持关键字：“文件访问重试超时”。
> 
> 源错误：

```
> 
> Line 161:     foreach(string item in items) Line 162:     { Line 163:         var
> row = database.QuerySingle("select Suburb, State from
> SuburbsPostCodesAndStates where Suburb = @0", item); Line
> 164:          if(row != null) Line 165:           {
> 
```

> 源文件：c:\HostingSpaces\jpezzime\mysite.com\wwwroot\App_Code\JTSi.cs 行：163
> 
> 堆栈跟踪：
> 
> [ArgumentException：不支持关键字：'文件访问重试超时'。]
> System.Data.SqlServerCe.SqlCeConnectionStringBuilder.GetIndex（字符串关键字）+198
> System.Data.SqlServerCe.SqlCeConnectionStringBuilder.set_Item（字符串关键字，对象值）+31
> 系统。 Data.Common.DbConnectionStringBuilder.set_ConnectionString（字符串值）+185
> System.Data.SqlServerCe.SqlCeConnectionStringBuilder..ctor（字符串 connectionString） +181
> System.Data.SqlServerCe.SqlCeConnection.set_ConnectionString（字符串值）+241
> WebMatrix.Data.DbProviderFactoryWrapper。 CreateConnection(String connectionString) +96
> WebMatrix.Data.<> *c_DisplayClass15.b*_14() +16 WebMatrix.Data.Database.get_Connection() +19 WebMatrix.Data.Database.EnsureConnectionOpen() +13
> WebMatrix.Data.d__0.MoveNext() +72
> System.Linq.Enumerable.FirstOrDefault(IEnumerable 1 项)在 c:\HostingSpaces\jpezzime\mysite.com\wwwroot\App_Code\JTSi.cs:163 ASP._Page_Shared_Pages_Search_cshtml.Execute() 在 c:\HostingSpaces\jpezzime\mysite.com\wwwroot\Shared\Pages\Search.cshtml 中： 17 System.Web.WebPages.WebPageBase.ExecutePageHierarchy() +208 System.Web.WebPages.WebPage.ExecutePageHierarchy(IEnumerable`1 执行器) +68 System.Web.WebPages.WebPage.ExecutePageHierarchy() +123 System.Web.WebPages。 StartPage.RunPage() +19 System.Web.WebPages.StartPage.ExecutePageHierarchy() +67 System.Web.WebPages.StartPage.RunPage() +19`1 source) +4232212
> WebMatrix.Data.Database.QuerySingle(String commandText, Object[] args) +98 JTSi.FindSetAndRemoveLocation(List`
> 
> System.Web.WebPages.StartPage.ExecutePageHierarchy() +67
> System.Web.WebPages.WebPageBase.ExecutePageHierarchy(WebPageContext pageContext, TextWriter writer, WebPageRenderingBase startPage) +78
> System.Web.WebPages.WebPageHttpHandler.ProcessRequestInternal(HttpContextBase httpContext) +121
> 
> -------------------------------------------------- ------------------ 版本信息：Microsoft .NET Framework 版本：4.0.30319；ASP.NET 版本：4.0.30319.272

有人可以帮忙解释一下吗？我完全不知道一个网站是如何在几分钟内从非常棒到完全搞砸的——当时我什至没有做任何改变！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:40:41.710

解决方案：

代替：

```
var database = Database.Open("MYDB"); 
```

和：

```
var database = Database.OpenConnectionString("Data Source=|DataDirectory|\\MYDB.sdf", "System.Data.SqlServerCe.4.0"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T18:40:59.683

# excel - 在不使用排名函数的情况下对 Excel 中的数字列进行排名

> ID：11299265
> 
> 赞同：-1
> 
> 时间：2012-07-02T18:35:35.380
> 
> 标签：excel, if-statement, ranking

我想看看是否有任何创造性和有效的方法可以根据列的值对列进行排名，而不使用 excel 中的 rank 函数。除了 =Rank(B4,B2:B6,1) 你还能做什么？并且没有宏。哈哈

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T18:59:36.023

假设您想要排名为 1 的最低值（正如您建议的公式所做的那样），那么您可以在复制的第 2 行中使用 COUNTIF

`=COUNTIF(B$2:B$6,"<"&B2)+1`

将 < 反转为 RANK 最大值为 1

# zend-framework - 在 Zend 框架中加入 zend_db_table_abstract 类

> ID：11299268
> 
> 赞同：0
> 
> 时间：2012-07-02T18:35:50.143
> 
> 标签：zend-framework, zend-db-table

我有一个带有两个扩展 Zend_Db_Table_Abstract 模型的模块：

```
class Departments_Model_Subpages extends Zend_Db_Table_Abstract
{
    protected $_name = 'bktg_departments_subpages';
    protected $_primary = 'id';
}

class Departments_Model_Departments extends Zend_Db_Table_Abstract
{
    protected $_name = 'bktg_departments';
    protected $_primary = 'id';
} 
```

通读文档，我想做的是这样的（显然，错误）：

```
$depTable = new Departments_Model_Departments();
$subTable = new Departments_Model_Subpages();

$depQuery = $depTable->select()->setIntegrityCheck(false)
->from($depTable, array('id', 'title'))
->join($subTable, array('COUNT(id) as `count`'))
->where('bktg_departments.id = bktg_departments_subpages.parent_id'); 
```

我错过了什么？我只是无法理解 Zend 连接，我想我最终会直接写 sql。

谢谢你看。

编辑

这是我现在正在使用的内容：

```
$depQuery = $depTable->select()->setIntegrityCheck(false)
->from($depTable, array('id', 'title'))
->joinLeft($subTable, 'bktg_departments.id = bktg_departments_subpages.parent_id',       array('COUNT(id) as count'))
->order('id DESC')
->group('id'); 
```

对我有用的sql：

```
SELECT bktg_departments.id, bktg_departments.title, count(bktg_departments_subpages.id) FROM bktg_departments left join bktg_departments_subpages on bktg_departments.id = bktg_departments_subpages.parent_id group by bktg_departments.id 
```

我在 Zend 中复制它时遇到了问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:15:54.893

您的 join() 似乎有问题。第二个参数应该是连接的 ON 子句，您将不再需要 where() ：

```
$depQuery = $depTable->select()->setIntegrityCheck(false)
->from($depTable, array('id', 'title'))
->join($subTable, 'bktg_departments.id = bktg_departments_subpages.parent_id', array('COUNT(id) as `count`')); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T13:57:24.623

据我所知，将对象传递给 table 参数不会给您预期的结果，并且总是会产生错误。甚至像 $table->getName() 这样的方法也会产生错误，所以我不得不手动输入名称。我不知道我是否期望 select 对象有更多的能力，或者这是 1.11 中的错误。无论哪种方式，我希望这可以帮助某人解决他们的挫败感。

以下代码有效：

```
$depQuery = $depTable->select()->setIntegrityCheck(false)
->from($depTable, array('id', 'title'))
->joinLeft('bktg_departments_subpages', 'bktg_departments.id = bktg_departments_subpages.parent_id', array('count' => 'COUNT(bktg_departments_subpages.id)'))
->group('bktg_departments.id')
->order('bktg_departments.id DESC'); 
```

# php - 动态构建菜单 - 两个数组

> ID：11299270
> 
> 赞同：-1
> 
> 时间：2012-07-02T18:36:01.510
> 
> 标签：php

我有两个数组...

```
$Name = array(a, b, c, d);
$Value = array(1, 2, 3, 4); 
```

我想动态构建一个菜单，我将按顺序将名称分配为等于值？示例：结果将是`a=1,b=2,c=3`等，

菜单的最终结果...

```
<select name="Menu">
   <option value="1">a</option>
   <option value="2">b</option>
   <option value="3">c</option>
   <option value="4">d</option>
</select> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:41:38.177

```
<?php
$Name = array(a, b, c, d);
$Value = array(1, 2, 3, 4);
$c = array_combine($Name, $Value);
echo "<select name=\"Menu\">\n";
foreach($c as $k=>$v){
    echo "<option value=\"$k\">$v</option>\n";
}
echo "<select>\n";
?> 
```

**[键盘示例](http://codepad.org/ZLyJdgvQ)**

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-02T18:42:13.607

如果您确定两个数组的长度相同，那么您可以这样做

```
echo '<select name="Menu">';

foreach($name as $key=>$val){
 echo '<option value="'.$Value['key'].'">'.$val.'</option>'
}

echo '</select>'; 
```

如果它是以下形式的关联数组会更好：`array('name1'=>'value1','name2'=>'value2','name3'=>'value3')`

# .net - 与 ASP.net WEB API 的交易

> ID：11299273
> 
> 赞同：6
> 
> 时间：2012-07-02T18:36:27.240
> 
> 标签：.net, transactions, asp.net-web-api

我了解 ASP.NET WEB API 旨在帮助实现基于 REST 的轻量级应用程序。但是，我需要我的 REST 服务是事务性的/成为事务的一部分。我试着环顾四周，但似乎没有办法将 WEB API 作为客户端发起的事务的一部分。有没有办法做到这一点？

问候贾加迪什

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-06T17:39:50.177

如果你控制了电线的两端，就有可能达到你想要的。

[TransactionInterop](http://msdn.microsoft.com/en-us/library/system.transactions.transactioninterop%28v=vs.100%29.aspx)类的存在是为了支持使用 MS DTC 在进程边界之间处理事务。

它包含两种对您的场景感兴趣的方法：

*   [`GetTransmitterPropagationToken`](http://msdn.microsoft.com/en-us/library/system.transactions.transactioninterop.gettransmitterpropagationtoken(v=vs.100).aspx)- 这将获得一个令牌，可用于在当前进程之外传播事务。

*   [`GetTransactionFromTransmitterPropagationToken`](http://msdn.microsoft.com/en-us/library/system.transactions.transactioninterop.gettransactionfromtransmitterpropagationtoken(v=vs.100).aspx)- 这需要一个传播令牌并使用它在本地服务中构建事务。

您可以在客户端中使用第一种方法来生成交易。您可以将其设置为自定义标头值或 cookie 以将其传递给您的服务。一旦在服务上，您可以使用第二种方法在本地创建事务。

对此的主要警告是，需要在客户端和服务器上启用和配置 MS DTC。只有在 Windows Active Directory 域中调用您的服务时，才能真正实现这一点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-02T18:43:10.773

在事务中登记服务调用通常被认为是 SOAP 行为而不是 REST 行为。至少有一种标准化的方式来处理 SOAP，称为 WS-AtomicTransaction。

由于面向 SOAP，ASP.Net Web API 没有明确支持，但 WCF 支持

[http://msdn.microsoft.com/en-us/library/ms730266](http://msdn.microsoft.com/en-us/library/ms730266)

在 REST 中自己实现类似的类似行为是可能的，但可靠地执行相对复杂。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-02T18:43:29.890

我相信您指的是可以跨服务边界传播的分布式事务（通过 MSDTC）。

但是，不可能通过 WCF RESTful 服务进行分布式事务，因为根本无法通过普通 HTTP 请求传播和管理事务状态。

您可能想通过 HTTP (wsHttpBinding) 或 TCP/IP (net.tcp) 查看普通的 WCF 服务，或者甚至查看[WCF 数据服务](http://msdn.microsoft.com/en-us/library/cc668792.aspx)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-09-19T09:01:45.353

**使用 WEB API 的分布式事务（跨应用程序域）**

为了让我的 ASP.NET WEB API 跨国或事务的一部分（通过 MSDTC 在服务边界上传播），我实现了一个 Web API 的操作过滤器，它检索**客户端请求发送的事务令牌**并使用它来**注册服务事务在同一个客户范围的事务**中。

此过滤器可以简单地应用于 Web API 操作，如下所示：

```
[HttpPost] 
[EnlistToDistributedTransactionActionFilter] 
public HttpResponseMessage Post(string id) 
{
   ...
} 
```

客户端应用程序只需要打开事务并在请求中传递它：

```
using (var scope = new TransactionScope()) 
{
    using (var client = new HttpClient()) 
    { 
        using (var request = new HttpRequestMessage(HttpMethod.Post, "https://acme.com/api/order", id))) 
        { 
            // extension method that forward transaction token to Web API
            request.AddTransactionPropagationToken(); 
            var response = client.SendAsync(request).Result; 
            response.EnsureSuccessStatusCode(); 
        } 
    }
} 
```

模式详情、示例和源代码可在此处找到： [https ://www.c-sharpcorner.com/article/distributed-transactions-with-webapi-across-application-domains/](https://www.c-sharpcorner.com/article/distributed-transactions-with-webapi-across-application-domains/)

# list - 在相同int的Haskell中定义无限列表，哪种方式？

> ID：11299275
> 
> 赞同：4
> 
> 时间：2012-07-02T18:36:44.037
> 
> 标签：list, haskell

在 Haskell 中定义无限列表：

```
[1,1..] => [1,1,1,..] 
```

或者，循环方式：

```
lst=1:lst 
```

第一个定义与第二个相同吗？如果不是，哪一种是首选方式？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-02T18:42:50.647

您可能想要[`repeat`](http://www.haskell.org/hoogle/?hoogle=repeat)定义与您的第二个实现等效的位置。

第`[1,1..]`一个示例中的符号是`enumFrom*`前奏函数的语法糖。使用任何你喜欢的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-02T19:06:15.230

`repeat`/`1:lst`更好，它们不需要任何额外的计算，但`[1,1..]`可以：

```
[1,1..] = enumFromThen 1 1 = en 1
            where en n = n : en (n + nΔ)
                  nΔ = 1-1 = 0 
```

所以它总是需要执行额外的`1+0`。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-02T19:59:15.767

如果你不走运，你的第一个无限列表将使用无限量的内存。因此，请使用您的第二个无限列表（或者，如果您更喜欢匿名无限列表，请使用[`repeat`](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v%3arepeat)Prelude）。

* * *

一个示范。执行此操作时，可能会`watch free -m`在另一个窗口中运行。

```
$ cat so.hs
import Control.Exception (evaluate)
import System.IO (hFlush, stdout)

with :: String -> [Int] -> IO ()
with s xs
   = do putStrLn $ "Summing part of a " ++ s
        theSum <- evaluate $ sum (take 100000000 xs)
        firstElem <- evaluate $ head xs
        putStrLn $ "sum $ take 100000000 [" ++ show firstElem ++ "...] is " ++ show theSum

main :: IO ()
main
   = do with "call to repeat" (repeat 1)
        putStr "Press return to continue..."
        hFlush stdout
        getLine
        with "list comprehension" [1,1..]

$ ghc -O --make so.hs 
[1 of 1] Compiling Main             ( so.hs, so.o )
Linking so ...
$ ./so
Summing part of a call to repeat
sum $ take 100000000 [1...] is 100000000
Press return to continue...
Summing part of a list comprehension
^C 
```

第一个求和在恒定空间中运行。第二个总结会占用内存，所以我在它导致我的笔记本电脑交换之前中断了它。

`firstElem`在这个简单的例子中，我们可以通过在计算之前计算来避免空间泄漏`theSum`，但在现实世界的应用程序中，这可能是不可能的，或者至少难以追踪。最好通过使用来避免它`repeat`。

（关于优化的说明：如果我们不将`-O`标志传递给`ghc`then[*`sum`*](http://www.haskell.org/ghc/docs/latest/html/libraries/base/src/Data-List.html#sum)将在两个求和过程中发生空间泄漏。重写它并不难，`sum = foldl' (+) 0`因此即使没有 . 也不会发生空间泄漏`-O`。我不知道是什么考虑导致当前而是实施。）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-02T19:07:48.717

要回答您的问题，两者都是展开，但`let`和`repeat`变体更好，因为`enumFrom`变体经过实际枚举，因此涉及无用的算术。

# php - MySQL 最接近匹配使用 ABS 混淆

> ID：11299280
> 
> 赞同：1
> 
> 时间：2012-07-02T18:37:24.493
> 
> 标签：php, mysql, tabs, sql-order-by, match

非常简单的一个，只是被语法难住了，在任何地方都找不到一个好的例子。

我想在数据库中搜索最接近的匹配。在页面的前面，我定义了 $rating，这就是我想要匹配的值。Uploadrating 是我想在表中匹配的值。

我正在使用以下内容：

```
$SQL = "SELECT TOP(1) id
FROM table
WHERE uploader != '$username'
ORDER BY ABS(uploaderrating - $rating)";

$result = mysql_query($query);
$row1= mysql_fetch_array($result);
$id1 = $row1[id]; 
```

我没有得到我想要的行 ID，而是得到以下内容：

mysql_fetch_array()：提供的参数不是 mysite 中行号的有效 MySQL 结果资源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:44:16.067

TOP 功能是否存在于您安装我的 MySQL 中？

试试这个语法：

```
SELECT id
FROM test
WHERE uploader != '$username'
ORDER BY ABS(uploaderrating - $rating)
LIMIT 0,1 
```

演示可以在[这里](http://sqlfiddle.com/#!2/b42f0/5)找到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T18:44:52.457

如果您使用的是 mysql，则必须使用

```
SELECT id
...
limit 1 
```

# javascript - Javascript 深拷贝对象

> ID：11299284
> 
> 赞同：39
> 
> 时间：2012-07-02T18:37:52.823
> 
> 标签：javascript, object

> **可能重复：**
> [克隆 JavaScript 对象的最有效方法是什么？](https://stackoverflow.com/questions/122102/what-is-the-most-efficient-way-to-clone-a-javascript-object)

我有一个这样的对象：

```
User = {    
  name: "user",
  settings: {
    first: "1",
    second: "2"    
  }    
} 
```

第二个：

```
user1 = {
  name: "user1",
  settings: {
    second: "3"
  }
} 
```

现在我想将 user1 的自定义值复制到用户中，使用：

```
 for(var key in user1){
        User[key] = user1[key];
    } 
```

结果用户将是：

```
User = {
  name: "user1",
  settings: {
    second: "3"
  }
} 
```

User.settings 已被完全替换，而我只想替换 settings.second。

如何在不知道主对象有多少子对象的情况下实现这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-03T12:45:15.883

我发现最好的方法是：

[http://andrewdupont.net/2009/08/28/deep-extending-objects-in-javascript/](http://andrewdupont.net/2009/08/28/deep-extending-objects-in-javascript/)

```
Object.deepExtend = function(destination, source) {
  for (var property in source) {
    if (typeof source[property] === "object" &&
     source[property] !== null ) {
      destination[property] = destination[property] || {};
      arguments.callee(destination[property], source[property]);
    } else {
      destination[property] = source[property];
    }
  }
  return destination;
};

Object.extend(destination, source); 
```

那这个呢？

```
 function clone(destination, source) {
        for (var property in source) {
            if (typeof source[property] === "object" && source[property] !== null && destination[property]) { 
                clone(destination[property], source[property]);
            } else {
                destination[property] = source[property];
            }
        }
    }; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-03T00:41:13.533

获取 jQuery 的扩展方法，并使其与库无关。

要点：[jQuery 扩展的库不可知版本](https://gist.github.com/jonjaques/3036701)

它包含在一个 Extender 构造函数中，因此您不必在每次调用 extend 方法时都实例化它的所有内部方法。

免责声明：我没有对此进行广泛的测试。它基本上是 jQuery 的 extend() 的 1:1 克隆，但是您的里程可能会有所不同。

像这样使用它。

```
var user1 = {
  name: "user1",
  settings: {
    first: "1",
      second: {bar: 'foo'}
  }
};
var user2 = {
  name: "user2",
  settings: {
    second: {foo:'bar'}
  }
};

/* merge user1 into User */
__extend(true, user1, user2);

// Modifies the User object
user1.settings.second.foo == 'bar'; // true

// note, you can do assignment too.
var newUser = __extend(true, user1, user2); 
```

[有关更多文档，请参见此处](http://api.jquery.com/jQuery.extend/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-02T19:20:00.147

这真的很hacky，但这应该可行。我建议按照其他用户在评论中的建议进行操作；找到一个预先存在的库来为你做这件事。

```
for(var key in user1){  
   var temp = User[key]
   User[key] = user1[key];   
   for(var key1 in temp){
      if(User[key][key1] == null){
         User[key][key1] = temp[key1];
      }
   }
} 
```

# jquery - Backbone.js 无限分页显示问题

> ID：11299285
> 
> 赞同：0
> 
> 时间：2012-07-02T18:37:55.163
> 
> 标签：jquery, html, backbone.js, twitter-bootstrap, backbone.js-collections

我正在使用主干[无限分页](https://github.com/addyosmani/backbone.paginator)。看看这张图片。在我点击“更多”之前，一切正常。一旦我点击“更多”，新结果就会被很好地添加，但“更多按钮”不会被按下。

![在此处输入图像描述](../Images/e7deb0e3dcb7585d961680e4b72b62c7.png)

这是我的模板（我使用 twitter 引导程序），尽管我也尝试将“更多”按钮直接放在“用户列表”div 之后，但这也不起作用。

```
<div class="row"> 
    <div class="span2">
        <div id="users-list" style="height:50px"></div>        
    </div>
</div>

<div class="row">  
    <div class="span2">
        <ul class="pager">  
          <li>
            <a href="#" id="more">More</a>
          </li>
        </ul>
</div>
</div> 
```

以下是我在视图代码中添加新结果的方法：

```
 //in initialize()
    this.list = $("#users-list", this.el)

    ...

    //in render()
    _.each(this.model.models, function (user) {            
        this.list.append(new User({model:user}).render().el);
    }, this); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:41:22.430

看起来问题是因为您为用户列表设置了 50px 的高度。我不确定你为什么首先拥有它，这可能是有原因的，但是当你动态添加更多项目时，高度要么需要动态增长，要么你可以简单地删除它。

```
 <div id="users-list" style="height:50px"></div> 
```

# c# - 在 C# 中迭代 大型集合：花费很长时间

> ID：11299292
> 
> 赞同：5
> 
> 时间：2012-07-02T18:38:19.983
> 
> 标签：c#, wpf, collections, iteration

我最近启动了一个 WPF 应用程序。我将它连接到 BaseX（基于 XML）数据库并从中检索到大约一百万个条目。我想遍历条目，为每个条目计算一些东西，然后将其写回数据库：

```
IEnumerable<Result> resultSet = baseXClient.Query("...", "database");
foreach (Result result in resultSet) 
{
    ...
} 
```

问题：永远无法到达 foreach 的内部。Query() 方法返回的速度非常快，但是当达到 foreach 时，C# 似乎对集合做了一些事情，代码不会持续很长时间（至少 10 分钟，永远不要让它再运行）。这里发生了什么？我试图限制检索到的项目数量。当检索 100.000 个结果时，会发生同样的事情，但代码会在大约 10-20 秒后继续。当检索完整的一百万个结果时，C# 似乎永远卡住了......

有任何想法吗？问候

**编辑：为什么会发生这种情况** 正如你们中的一些人指出的那样，这种行为的原因似乎是查询实际上只在`MoveNext()`调用 Enumerable 内的 Enumerator 时才被评估。我的数据库似乎无法一次返回一个值，而是一次返回整个一百万个数据集。我将尝试切换到另一个数据库（Apache Lucene，如果可能的话，因为它有很好的全文搜索支持）并编辑这篇文章，让你知道它是否改变了任何东西。
PS：是的，我知道一百万个结果很多。这并不意味着实时使用，它只是准备数据的一个步骤。虽然我没想到代码会在几秒钟内运行，但看到数据库中的性能如此糟糕，我仍然感到惊讶。

**编辑：解决方案**所以我将 XML 数据库迁移到 Apache Lucine。奇迹般有效！当然，Lucine 是一个基于文本的数据库，它并不适合所有用例，但对我来说它创造了奇迹。可以在几秒钟内迭代超过一百万个条目，每个循环获取一个条目 - 效果非常好！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T18:50:22.250

让我问一下 - 创建 rsultSet 时您不会加载数据，而是在首次访问它时（延迟执行），并加载一百万个条目时，您只需花费大量时间将它们反序列化到内存中。

欢迎来到 XML 数据库的低效率。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-02T19:00:33.917

一百万的任何东西都很多......所以任何获得这么多项目的操作都需要花费大量时间。看起来您使用的库不会推迟检索项目，直到绝对必要 - 所以您会看到将所有项目隐藏在“foreach”语句后面的影响。

发生什么了：

“foreach”不是单个操作，而是对 IEnumerable 和 IEnumerator 的多次调用：IEnumerable.GetEnumerator，重复调用 IEnumerator.MoveNext。

第一次调用`GetEnumerator`可以通过延迟执行（编写 LINQ 查询的最常见方式）或立即执行（您的集合似乎就是这种情况）来实现。

对 MoveNext 的调用也可以触发整个查询的立即执行，即使您只要求单个项目，或者每个调用都只能获得单个项目。即，大多数 LINQ 查询只从迭代器中获取下一项。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-02T19:21:02.103

这里的答案都指向您感知到的 foreach 问题（延迟执行）的原因，而不是可能的解决方案。我不确定这个数据库是否支持它，但一种解决方案可能是尝试以较小的批次对结果进行分页，而不是一次获取整个数据块。

另一种方法是编写一个执行必要计算的数据库查询，这样您的数据库就不需要在任何地方发送 100 万条记录。（同样，不确定这个数据库是否支持）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T18:51:06.323

要强制在 foreach 之前评估查询，请在结果集上调用 ToList 函数。（如果问题是数据库永远占用，则不会解决您的问题）

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-02T18:49:47.983

您是否尝试过更传统的 for 循环来查看是否可行？

```
IEnumerable<Result> resultSet = baseXClient.Query("...", "database");
for (int x =0; x < resultSet.Count; x++)
{
    Result result = resultSet[x];
    ...
} 
```

# jquery - 中断的高亮动画

> ID：11299299
> 
> 赞同：1
> 
> 时间：2012-07-02T18:38:59.970
> 
> 标签：jquery, forms, jquery-ui

我正在尝试一种动态形式的排序，其中单击添加按钮会在字段表中添加一行，而删除按钮会删除一行。到目前为止，我已经完成了这项工作，并且我正在使用 jQuery UI 中的 Highlight 动画来吸引人们对新插入的行的注意。问题是，如果我添加行太快，新行的突出显示动画可能会冻结/挂起。这是一个屏幕截图：http: [//i.imgur.com/KH08I.png](http://i.imgur.com/KH08I.png)

这是我的代码的 jsbin：http: [//jsbin.com/ogaziv/3/edit](http://jsbin.com/ogaziv/3/edit)

如果您取消注释我在 js 中注释掉的内容，这可以解决问题，但是我有什么理由会遇到这个故障吗？一般来说，我对 JavaScript 和 jQuery 比较陌生，但这似乎很简单。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T18:48:17.453

您正在选择`$('.dyn_combo_qty tr:last td')`哪个选择最后一个`tr`元素，通过添加一个新`tr`的最后一个`tr`现在是 1 到最后一个，这会停止它的动画。

[http://jsbin.com/ogaziv/7/edit](http://jsbin.com/ogaziv/7/edit)

# android - 在不锁定“主”线程的情况下显示图像

> ID：11299300
> 
> 赞同：0
> 
> 时间：2012-07-02T18:39:07.687
> 
> 标签：android, imageview, android-4.0-ice-cream-sandwich, android-imageview

我的应用程序遇到了问题。我正在将一系列内部 iPad 应用程序从 iOS 移植到 android，并且图像序列是其设计不可或缺的一部分。它们需要标准的全屏停止、启动、暂停功能，所有这些功能都可以在 ImageView 的子类中正常工作。但在锁定进程对话框不断出现之前，它目前只显示它通过的 300 张图像中的 2 张。

那么有没有一种“好”的方法来设置图像/背景而不锁定主线程？

仅供参考，AnimateDrawable 并不适合我需要的东西，因为它不提供暂停/恢复功能，而且我拥有的序列数量很容易达到数百个，平均只有几百帧长。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T11:25:33.097

**[您可以使用AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)**异步加载图像

只需将与图像加载相关的代码放在**doInBackground**方法中，并尝试设置进度条或进度对话框之类的指示器，以便在加载开始时开始显示对话框或进度条，完成后使用**onPostExecute**方法中的处理程序关闭对话框

示例代码：

```
 class SomeClass extends Activity {
protected ProgressDialog pd ;
protected Handler handler = new Handler(){
@Override 
public void handleMessage(int what){
   if(pd.isShowing())
      pd.dismiss();
}
     .....

     class LoadImageTask extends AsyncTask<URL, Integer, Long> {
          protected void onPreExecute(Long result) {
            pd = ProgressDialog.show(getContext(),"Title","Message");
         }

         protected Long doInBackground(URL... urls) {

          //Load IMAGEs code
             return totalSize;
         }

         protected void onPostExecute(Long result) {
             //finish loadiing images
              handler .sendEmptyMessage(0);
         }
     }
    } 
```

我希望这会对你有所帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T18:05:12.877

Muhannad 的回答有几点要补充：

*   你不一定非要在 AsyncTask 中做，一个线程就可以了；
*   您可能希望将图像渲染为专用位图，然后使用[Canvas.drawBitmap()](http://developer.android.com/reference/android/graphics/Canvas.html#drawBitmap%28android.graphics.Bitmap,%20android.graphics.Rect,%20android.graphics.Rect,%20android.graphics.Paint%29)在[onDraw()](http://developer.android.com/reference/android/view/View.html#onDraw%28android.graphics.Canvas%29)上进行渲染，以节省在 UI 线程中渲染所花费的时间。

# php - 如何在一行文本中选择多个以@作为文本首字母的文本？

> ID：11299301
> 
> 赞同：1
> 
> 时间：2012-07-02T18:39:11.947
> 
> 标签：php, explode

好的，标题问题可能听起来令人困惑，是的，我也很困惑。无论如何，我想要的是：假设我有这行文字，

```
The quick brown @fox jumps @over the @lazy dog. 
```

这行文本是从数据库中动态获取的“单行”，而不是文本数组。假设第一个字母为'@'的文本是指向页面或其他内容的链接，我希望我可以指定放置锚标记的位置，在我的情况下，我想在每个以'开头的文本上放置锚标记@'。

我试过爆炸，但似乎爆炸不是这个问题的答案。有人可以帮我吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T18:45:13.463

您不想使用[`explode`](http://php.net/explode)它，而是使用正则表达式。匹配多次出现，[`preg_match_all`](http://php.net/preg_match_all)是交易。

```
preg_match_all('/@\w+/', $input, $matches);

        #        @   is the literal "@" character
        #    and \w+ matches consecutive letters 
```

您肯定可能想用[`preg_replace`](http://php.net/preg_replace)它们将它们转换为链接。或者最好[`preg_replace_callback`](http://php.net/preg_replace_callback)将一些逻辑移动到处理函数中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:06:44.227

您可以使用explode 来处理之前有@ 的单词......这真的取决于你想要做什么：

```
//Store the string in a variable
$textVar = "The quick brown @fox jumps @over the @lazy dog.";

//Use explode to separate words
$words = explode(" ", $textVar);

//Check all the variables in the array, if the first character is a @
//keep it, else, unset it
foreach($words as $key=>$val) {
    if(substr($val, 0, 1) != "@") {
        unset($words[$key]);
    } else {
        $words[$key] = "<a href='#'>".$words[$key]."</a>";
    }
}

//You can now printout the array and you will get only the words that start with @
foreach($words as $word) {
    echo $word."<br>";
} 
```

您还可以保留没有 @ 的字符串并使用内爆将所有内容放在一起：

```
//Store the string in a variable
$textVar = "The quick brown @fox jumps @over the @lazy dog.";

//Use explode to separate words
$words = explode(" ", $textVar);

//Check all the variables in the array, if the first character is a @
//keep it, else, unset it
foreach($words as $key=>$val) {
    if(substr($val, 0, 1) != "@") {
        //Do nothing
    } else {
        $words[$key] = "<a href='#'>".$words[$key]."</a>";
    }
}

//You can now printout the string
$words = implode($words, " ");
echo $words; 
```

# android - Android：线程不运行：/

> ID：11299302
> 
> 赞同：0
> 
> 时间：2012-07-02T18:39:14.003
> 
> 标签：android, nullpointerexception, surfaceview, runnable, resume

我一直在关注 youtube 上的 Surfaceview 教程，其中包含一个线程。

我已经完全复制了教程中代码显示的内容，但是当我运行它时它会在它应该工作时崩溃。这是我代码中的表面类：

它在 resume() 处显示空指针期望；

```
public class dfgfActivity extends Activity implements OnTouchListener 
{
    OurView v;
    protected void OnCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    v = new OurView(this);
    v.setOnTouchListener(this);
    setContentView(v);

}

@Override
protected void onPause() {
    // TODO Auto-generated method stub
    super.onPause();
    v.pause();
}

@Override
protected void onResume() {
    // TODO Auto-generated method stub
    super.onResume();
    v.resume();
}

public class OurView extends SurfaceView implements Runnable
{
    Thread t=null;
    SurfaceHolder holder;
    boolean isItOK=false;

    public OurView(Context context) {
        super(context);
        // TODO Auto-generated constructor stub
        holder = getHolder();
    }

    public void run() {
        // TODO Auto-generated method stub
        while (isItOK) {
            if (!holder.getSurface().isValid()) {
                continue;
            }

            Canvas c = holder.lockCanvas();
            c.drawARGB(255, 255, 10, 200);
            holder.unlockCanvasAndPost(c);
        }

    }

    public void pause() {
        isItOK = false;
        while (true) {
            try {
                t.join();
            }
            catch (InterruptedException e) {
                e.printStackTrace();    
            }
            break;
        }
        t = null;
    }

    public void resume() {
        isItOK = true;
        t = new Thread(this);
        t.start();

    }

}

public boolean onTouch(View v, MotionEvent event) {
    // TODO Auto-generated method stub
    return false;
}

} 
```

* * *

```
07-02 18:55:48.585: D/AndroidRuntime(684): Shutting down VM
07-02 18:55:48.595: W/dalvikvm(684): threadid=3: thread exiting with uncaught exception (group=0x4001b188)
07-02 18:55:48.595: E/AndroidRuntime(684): Uncaught handler: thread main exiting due to uncaught exception
07-02 18:55:48.665: E/AndroidRuntime(684): java.lang.RuntimeException: Unable to resume activity {fdgfd.dfgfdg/fdgfd.dfgfdg.dfgfActivity}: java.lang.NullPointerException
07-02 18:55:48.665: E/AndroidRuntime(684):  at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2950)
07-02 18:55:48.665: E/AndroidRuntime(684):  at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2965)
07-02 18:55:48.665: E/AndroidRuntime(684):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2516)
07-02 18:55:48.665: E/AndroidRuntime(684):  at android.app.ActivityThread.access$2200(ActivityThread.java:119)
07-02 18:55:48.665: E/AndroidRuntime(684):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1863)
07-02 18:55:48.665: E/AndroidRuntime(684):  at android.os.Handler.dispatchMessage(Handler.java:99)
07-02 18:55:48.665: E/AndroidRuntime(684):  at android.os.Looper.loop(Looper.java:123)
07-02 18:55:48.665: E/AndroidRuntime(684):  at android.app.ActivityThread.main(ActivityThread.java:4363)
07-02 18:55:48.665: E/AndroidRuntime(684):  at java.lang.reflect.Method.invokeNative(Native Method)
07-02 18:55:48.665: E/AndroidRuntime(684):  at java.lang.reflect.Method.invoke(Method.java:521)
07-02 18:55:48.665: E/AndroidRuntime(684):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
07-02 18:55:48.665: E/AndroidRuntime(684):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
07-02 18:55:48.665: E/AndroidRuntime(684):  at dalvik.system.NativeStart.main(Native Method)
07-02 18:55:48.665: E/AndroidRuntime(684): Caused by: java.lang.NullPointerException
07-02 18:55:48.665: E/AndroidRuntime(684):  at fdgfd.dfgfdg.dfgfActivity.onResume(dfgfActivity.java:42)
07-02 18:55:48.665: E/AndroidRuntime(684):  at android.app.Instrumentation.callActivityOnResume(Instrumentation.java:1149)
07-02 18:55:48.665: E/AndroidRuntime(684):  at android.app.Activity.performResume(Activity.java:3763)
07-02 18:55:48.665: E/AndroidRuntime(684):  at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2937)
07-02 18:55:48.665: E/AndroidRuntime(684):  ... 12 more
07-02 18:55:48.716: I/dalvikvm(684): threadid=7: reacting to signal 3
07-02 18:55:48.716: E/dalvikvm(684): Unable to open stack trace file '/data/anr/traces.txt': Permission denied 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:19:53.820

在您的方法`onCreate()`中，该方法使用大写：`OnCreate()`. 尝试将其更改为小案例。

# mysql - 连接到 mysql .. 主机更改错误？

> ID：11299310
> 
> 赞同：0
> 
> 时间：2012-07-02T18:39:48.093
> 
> 标签：mysql, mysqli, mysql-connect

正在连接一个 IP，但一个完全奇怪的主机/IP 发生错误？？

```
new mysqli('88.198.55.xxx', 'root', 'pass', 'db'); 
```

这返回

```
Warning: mysqli::mysqli(): (28000/1045): Access denied for user 'root'@'static.226.106.46.78.clients.your-server.de' (using password: YES) 
```

我真的不明白？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:48:42.697

您看到的消息是由 MySQL 服务器生成的，并报告连接尝试`'root'@'static.226.106.46.78.clients.your-server.de'`被拒绝。该消息中给出的主机将是连接客户端的主机名（即运行 PHP 的服务器）。

拒绝访问的原因可能是因为`'root'`不允许用户从该主机连接（使用密码验证），或者密码不正确。

# java - 将 JTextPane 添加到 BorderLayout.SOUTH 会导致 JScrollPane 滚动

> ID：11299311
> 
> 赞同：0
> 
> 时间：2012-07-02T18:39:56.530
> 
> 标签：java, swing, jscrollpane, jtextpane, caret

我有一个包含在 JScrollPane 中的 JPanel。JPanel 的 NORTH、CENTER、WEST 和 SOUTH 区域 (BorderLayout) 添加了组件。

当我将 JTextPane 添加到 SOUTH 位置时，滚动窗格会滚动以显示文本。我不希望滚动窗格从其最高位置移动。我怎样才能防止这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T19:12:31.997

如果没有更多详细信息，您可以尝试将默认插入符号设置为[`NEVER_UPDATE`](http://docs.oracle.com/javase/7/docs/api/javax/swing/text/DefaultCaret.html#NEVER_UPDATE)，从 Java 5 开始可用。

```
JTextPane jtp = new JTextPane();
DefaultCaret caret = (DefaultCaret) jtp.getCaret();
caret.setUpdatePolicy(DefaultCaret.NEVER_UPDATE); 
```

# android - Google Cloud Messaging 中的 IntentReceiver 泄露

> ID：11299312
> 
> 赞同：4
> 
> 时间：2012-07-02T18:39:57.783
> 
> 标签：android, android-c2dm, google-cloud-messaging

我已经在我的应用程序中实现了 GCM，并且按照[此处](http://pages.citebite.com/e2n7j5s5mxct)的建议使用[GSMRegistrar](http://developer.android.com/guide/google/gcm/client-javadoc/index.html)。不，我在 logcat 中遇到错误

```
7-02 23:35:15.830: E/ActivityThread(10442): Activity com.abc.xyz.mnp has leaked IntentReceiver com.google.android.gcm.GCMBroadcastReceiver@44f8fb68 that was originally registered here. Are you missing a call to unregisterReceiver()? 
```

我可以从中理解并查看代码`GSMRegistrar`是我需要打电话`GSMRegistrar.onDestroy(this)`但我不明白我应该在哪里打电话？调用`onDestroy()`活动`mnp`会导致它停止重试`GSM Registartion`

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-13T15:08:36.737

您可以使用应用程序上下文，而不是活动上下文。这样退避机制就不受活动生命周期的限制。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-02T20:46:41.077

它应该在您开始 GCM 注册的活动的 onDestory() 方法中调用。

请记住，一个活动可能不会被销毁，即使在它之上启动了另一个活动。所以您的注册仍然可以在后台重试。如果注册活动被破坏，那么您的 GCMBroadcastReceiver 类将无法处理响应。

更新：更仔细地查看 GCM 库源代码后，这是我观察到的：

1.  GCM 库使用活动上下文来注册接收者，目的是在注册失败时重试注册，它会使用退避机制进行重试。
2.  您应该在 Activity 的 onDestroy() 方法上调用 GCMRegistrar.onDestroy()，在销毁 Activity 之前取消注册接收器是一个很好的 Android 做法。
3.  由于#2，这意味着如果调用 GCMRegistrar.register 的活动被销毁，您的应用将不会尝试重新注册。用户必须返回此活动才能重新开始注册过程。
4.  如果您不希望行为 #3，您可能必须实现自己的 GCM 注册和重试机制。例如，如果重试机制是在单独的后台线程中完成的，那么只要应用程序正在运行，即使活动被破坏，它也可以继续尝试。

我认为#3 是可以接受的，因为 GCM 服务器很少会拒绝注册并出现“SERVICE_NOT_AVAILABLE”错误。只要您的用户运行您的应用几次，他们的设备迟早会成功注册。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-03T10:06:35.053

**您必须在 activty 类的 onDestroy 方法中销毁 GCMRegistrar**

```
 unregisterReceiver(receiver);
        GCMRegistrar.onDestroy(this); 
```

# android - 创建移动 Web 服务 API 的最佳方法是什么？

> ID：11299313
> 
> 赞同：0
> 
> 时间：2012-07-02T18:40:02.980
> 
> 标签：android

我是 android 编程新手，我想创建一个带有登录系统和一整套不同 API 调用的 api。为移动应用程序执行此操作的最常见约定是什么？再次感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T18:42:24.270

您可以使用任何您喜欢的服务器端语言来提供服务，我个人会使用 Ruby 或 php，但您可以使用 Java、python 或任何其他您喜欢的语言

# c# - 在 ASP.NET 中将 Post 变量分配给 Session 变量

> ID：11299315
> 
> 赞同：0
> 
> 时间：2012-07-02T18:40:18.403
> 
> 标签：c#, asp.net, forms, session, post

我正在编写一个代码来处理一个表单，该表单由从用户那里收集信息的多页组成。它位于带有 C# 的 ASP.NET 中。所以我想不是使用 Post 在页面之间传递，而是使用 Session 来存储它们。

我的流程是每个页面都从其前一页面获取 Post 值，并立即将它们分配到相同标识符下的相应 Session 变量中。有没有一种简单的方法来处理它而不是手动分配每个变量？

一些代码将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T18:47:34.973

您可以创建一个（POCO）类，在该类上设置您的值，然后将该类置于会话中。然后在下一页从会话中获取该类并根据需要进行修改......并对所有页面执行此操作。

（编辑）简单示例：

```
// store this class in a file in your app_code folder called something like MyClass.cs
public class MyClass
{
   public string SomeStringValue;
   public int SomeIntValue;
   public List<SomeOtherClass> MyClassCollection = new List<SomeOtherClass>();
}

public class SomeOtherClass
{
    public string OtherStringValue;
}

// At the beginning of your form, on your first page, instance this class
MyClass oMyClass = new MyClass();

// Then, when you collect the data on the page, set the values in the class
oMyClass.SomeStringValue = "derp";

// Then, store it on session in that page
Session["oMyClass"] = oMyClass;

// Then, on the next page, get the object from session
MyClass oMyClass = (MyClass)Session["oMyclass"];

// Then, set the next value in your object
oMyClass.SomeIntValue = -1;

// Then, place it back in session on that page, and then keep chuggin through your workflow.

// Now, I didn't show you how to use MyClassCollection that is in the MyClass object, but it would be simple for you to store a class from each page in that collection like so
SomeOtherClass oSomeOtherClass = new SomeOtherClass();
oSomeOtherClass.OtherStringValue = "herp";
oMyclass.MyClassCollection.Add(oSomeOtherClass);

// Then you can place that collection in session 
```

# php - 如何在不阻塞线程的情况下调用 PHP？

> ID：11299316
> 
> 赞同：4
> 
> 时间：2012-07-02T18:40:19.807
> 
> 标签：php

我有 2 个 PHP 文件。一个文件是 caller.php，另一个是 worker.php

caller.php 将在（linux）系统上启动 worker.php，并且 caller.php 应该立即结束（而 worker.php 仍在服务器上工作）

worker.php 花费了很多时间，它将状态写入数据库或文件。

我希望能够在启动 'php worker.php' 的浏览器中打开 caller.php，关闭浏览器，5 分钟后返回并检查状态..（或脚本将在完成后发送邮件） - 任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T21:08:15.747

您可以结束客户端连接并继续处理，全部完成。如果处理时间超过 php/httpd 全局配置允许的时间，您可能还需要增加 php 超时。见[`set_time_limit();`](http://php.net/function.set-time-limit)。

这不完全是您所问的，但我认为这可能是 X/Y 问题，所以在这里我们使用可用于：

*   向用户显示*处理开始*页面。
*   关闭用户连接。
*   开始更长的处理。

所以基本上这回答了您所描述的需求，而不是“如何做 X？”。

### 呼叫者

```
// Ignore user abort and set Connection close header
ignore_user_abort(true);
header("Connection: close");

// Start controlled buffering
ob_start();
echo "<h1>Processing started, come back tomorrow to see results</h1>";

// Get buffer length and manually add it to headers.
$size = ob_get_length();
header("Content-Length: $size");

// Flush buffers, user sees "Processing started" message.
ob_end_flush();
flush();

// At this point connection to client should be closed already.
// Here we start our worker, there is no need to do fork() or 
// anything like that. Client browser is not listening anymore.
// All we need to do is simply start working and start writing
// status logs to somewhere so that client can retrieve status
// with another request, let's say from checkworkerstatus.php
include "worker.php";
$worker = new worker();
$worker->start_long_processing(); 
```

### 不分叉或杀戮`caller`以`worker`独自奔跑？

没错，那是因为没有必要。

是的，您要求*“caller.php 将在（linux）系统上启动 worker.php 并且 caller.php 应立即结束（而 worker.php 仍在服务器上工作）”的行为*。但是，如果您不想[使用 php 执行 multithreading-singleuser 应用程序，](https://stackoverflow.com/a/12148496/1338846)则无需这样做。让用户*1.*开始一些事情，*2.*让它继续运行，*3.*断开用户连接，*4* .回到开始用户可以开始更多事情的地方，或者如果已经足够无聊就退出。

当然你可以用任何东西替换之后`flush();`的所有东西，不同的是客户端不再监听，所以所有输出都会进入名为 /dev/null 的黑洞。例如用这样的东西测试它：

```
...end_flush();
flush();

// At this point connection to client should be closed already.
echo "Nobody sees this message";
while(rand(0,10) != 1) {
    echo "Nobody sees this message";
    error_log(date("mdyHis")." Still running...");
    sleep(10);
}
... 
```

有关详细信息，请参阅[http://php.net/features.connection-handling](http://php.net/features.connection-handling)。如果刷新缓冲区和关闭用户连接似乎有任何问题，
也请阅读[http://php.net/function.flush 。](http://php.net/function.flush)
还有另一个问题（有答案）关于[为什么 PHP 不支持多线程？](https://stackoverflow.com/questions/12148193/why-does-php-not-support-multithreading)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T18:47:18.690

1.  调用者运行工作者
2.  Worker 在 /tmp/ 中创建 FIFO 文件并将进度写入其中（您也可以使用套接字）
3.  调用者读取此文件并显示用户实际进度

如果您将 Apache/nginx 配置好，它将允许同时执行两个 PHP 文件（就像我的一样）。

您应该阅读有关 posix_mkfifo 的信息：http: [//php.net/manual/en/function.posix-mkfifo.php](http://php.net/manual/en/function.posix-mkfifo.php)（也有使用示例）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-02T19:01:39.360

这可能有点强，但是最快和直接的方法：

*   调用者使用 <IFRAME> 创建一个 html
*   IFRAME 的 SRC 是工作人员（这里调用者将参数作为 GET 参数传递给工作人员）
*   工人的第一行在下面的代码中

代码：

```
ignore_user_abort(true);
set_time_limit(0); 
```

当您关闭浏览器工作程序时（应该）继续工作！

见[http://www.php.net/manual/en/function.ignore-user-abort.php](http://www.php.net/manual/en/function.ignore-user-abort.php)

# java - 解析带负后缀的数字

> ID：11299319
> 
> 赞同：6
> 
> 时间：2012-07-02T18:40:23.753
> 
> 标签：java, number-formatting, decimalformat

有人可以向我解释为什么下面的代码会给出这个输出吗？

```
1.2
null 
```

运行以下代码：

```
String positive = "1.2+";
String negative = "1.2-";
DecimalFormat format = new DecimalFormat("0.0");
format.setPositiveSuffix("+");
format.setNegativeSuffix("-");  
format.setDecimalFormatSymbols(DecimalFormatSymbols.getInstance(Locale.US));
System.out.println(format.parse(positive, new ParsePosition(0)));
System.out.println(format.parse(negative, new ParsePosition(0))); 
```

这虽然有效，但我不喜欢模式的重复：

```
String positive = "1.2+";
String negative = "1.2-";
DecimalFormat format = new DecimalFormat("0.0+;0.0-");  
format.setDecimalFormatSymbols(DecimalFormatSymbols.getInstance(Locale.US));
System.out.println(format.parse(positive, new ParsePosition(0)));
System.out.println(format.parse(negative, new ParsePosition(0))); 
```

后缀不打算用于解析吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T06:53:52.313

如 javadoc 中所述：

> 否定子模式是可选的；如果不存在，则以本地化减号为前缀的正子模式（在大多数语言环境中为“-”）

在您的示例中，解析器正在等待“-1.2-”，因此您必须添加以下行：

```
format.setNegativePrefix(""); 
```

祝你今天过得愉快 ！

# c# - 可以被跨平台客户端使用的 WCF

> ID：11299323
> 
> 赞同：0
> 
> 时间：2012-07-02T18:40:44.930
> 
> 标签：c#, wcf, web-services, azure, servicebus

我有需要在 Azure 服务总线上托管 Web 服务 (WCF) 并将其公开以供跨平台客户端（.NET 或 java 或任何其他）使用的场景。有哪些不同的协议可以满足这种情况？我正在考虑使用预定义的 xsd 或 REST 或 SOAP 甚至 JSON 数据包的纯 XML 格式。我正在考虑使用 basicHttpRelayBinding 来公开合同。请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:44:36.067

公开 SOAP 服务应该适用于绝大多数平台和语言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T18:49:26.447

由于您希望该服务被许多不同的客户端使用，我会避免使用基于 SOAP 的绑定，例如 basicHttpRelayBinding，而是使用 webHttpRelayBinding

[http://msdn.microsoft.com/en-us/library/microsoft.servicebus.webhttprelaybinding.aspx](http://msdn.microsoft.com/en-us/library/microsoft.servicebus.webhttprelaybinding.aspx)

这将使 PHP、浏览器或移动设备等框架更容易使用您的服务。

此外，如果您的目标是移动客户端，请务必考虑使用 JSON 而不是 XML。它可以显着减少您的消息有效负载大小 - 对于人们可能采用按字节付费数据计划的移动客户端来说非常重要。

JSON 显然也更适合 javascript（浏览器）客户端使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T18:46:39.320

REST 为您提供了终极的可移植性，因为 URL 调试起来非常直观，并且很容易在任何平台上创建这样的接口。JSON 基本上是这个路由的可选扩展，以统一的方式处理更复杂的类型；当然，当接口设计得尽可能简单时，REST 客户端工作得最好，不管有没有 JSON。

假设您使用 HTTP 绑定而不是 TCP 绑定，那么 SOAP 是与 Java 接口的一种优雅的可能性。但是，您可能会遇到 SOAP 工具包不可用或不可靠的平台，并且 SOAP 的所有优点都会开始对您不利。

# javascript - 脚本预处理基础

> ID：11299324
> 
> 赞同：1
> 
> 时间：2012-07-02T18:40:47.660
> 
> 标签：javascript, preprocessor

我有这个代码：

```
<script id="toModify" >
Invalid javascript that will cause errors
</script>

<script>
var s=document.getElementById("toModify");
s.innerHTML="alert('Hi')";
</script> 
```

它不起作用。

我知道我至少需要做两件事才能使它起作用：

*   防止第一个脚本第一次运行。
*   修改后，重新运行第一个脚本。

我该怎么做这些事情？还有什么我需要做的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:47:49.320

*   使用`type`属性使浏览器不执行脚本：

    ```
    <script id="toModify" type="text/x-custom-whatever">...</script> 
    ```

*   只是`eval()`执行它的代码。

当然，动态生成代码是充满危险的；要非常小心，不要引入安全漏洞。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T18:51:09.130

~~为脚本设置与不支持的“text/javascript”不同~~的类型将使脚本无法得到处理。

所以`<script id="toModify" type="text/unprocessed">...</script>`

然后您可以创建一个类型为 script 的新元素，设置其 innerHTML 并将其附加到文档中。

就像是

```
var s = document.getElementById("toModify");
var processed = document.createElement('script'); // create a new script element

processed.innerHTML = "alert('Hi')"; // or do something with the s.innerHTML
document.body.insertBefore(processed, document.body.firstChild); // add the new element to the body, it gets executed immediately.. 
```

演示在[http://jsfiddle.net/GG7cT/](http://jsfiddle.net/GG7cT/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-02T18:49:22.377

你不能。第一个脚本将始终首先运行。即使它具有`defer`属性，我也不确定您是否能够更改其内容。

另请参阅[此答案](https://stackoverflow.com/a/10805666/1048572)。

# c++ - 将字符指针传递给函数并动态分配内存

> ID：11299325
> 
> 赞同：3
> 
> 时间：2012-07-02T18:40:47.627
> 
> 标签：c++, class, pointers, dynamic-allocation

学生.h

```
class Student
{
 private:
      char m_sHouse[64];
 public:
 Student(void);
 ~Student(void);
 void getHouse(char *hName);
 void setHouse(char *hName);
} 
```

学生.cpp

```
 void Student::setHouse(char *hName)
 {
    strcpy(m_sHouse, hName);
 }

 void Student::getHouse(char *hName)
 {
     if (m_sHouse != NULL)
     {
        hName = new char[strlen(m_sHouse)+1];
        strcpy(hName, m_sHouse);
     }
 } 
```

主要：

```
 student.getHouse(house);
 if (strcmp(house, "house") == 0)
     cout <<"\tCorrectly returned the student house: " << house<< endl; 
```

`setHouse(char *hName)`设置`student->m_sHouse`等于“房子”。

我的问题：

当在里面时`getHouse(char *hName)`，它会正常运行，设置`hName`为“house”。但是当控制权从函数中传递出去时，我的动态分配的内存被释放了，所以当我在 main 中使用 strcmp 时，我的程序崩溃了（我最终比较了一个 NULL 指针）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T19:23:26.573

尼克，正确的解决方案是您知道`hName`该类的用户（Coleman 博士）已经分配了它。你只需要`strcpy`进入字符数组。

简单的说：

```
void Student::getHouse(char *hName)
{
  strcpy(hName, m_sHouse);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-02T18:43:46.070

您正在分配新内存并将其分配给局部变量。将您的功能更改为

```
 void Student::getHouse(char **hName)
 {
     if (m_sHouse != NULL)
     {
        *hName = new char[strlen(m_sHouse)+1];
        strcpy(*hName, m_sHouse);
     }
 } 
```

这将更改传入函数的参数指向的地址，而不是它的副本

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-02T18:45:47.230

指针`hname`是（您传递给的指针）**的副本**。但是，在您更改的该功能内部，您并**没有**更改原始功能！为此，您应该返回分配的内存：`house``getHouse``hname`**`house`**

 **```
char *Student::getHouse()
{
    char *hame = NULL;
    if (m_sHouse != NULL)
    {
        hName = new char[strlen(m_sHouse)+1];
        strcpy(hName, m_sHouse);
    }
    return hname;
} 
```

接着

```
house = student.getHouse(); 
```

或者给这个变量一个指针，这样就可以改变它：

```
void Student::getHouse(char **hName)
{
    if (m_sHouse != NULL && hname != NULL)
    {
        *hName = new char[strlen(m_sHouse)+1];
        strcpy(*hName, m_sHouse);
    }
} 
```

接着

```
student.getHouse(&house); 
```

同样，您可以引用 house 变量：

```
void Student::getHouse(char *&hName)
{
    if (m_sHouse != NULL)
    {
        hName = new char[strlen(m_sHouse)+1];
        strcpy(hName, m_sHouse);
    }
} 
```

接着

```
student.getHouse(house); 
```

然而，更好的解决方案是使用`std::string`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-02T18:43:55.693

```
void Student::getHouse(char *hName)
{
     if (m_sHouse != NULL)
     {
        hName = new char[strlen(m_sHouse)+1];
        strcpy(hName, m_sHouse);
     }
 } 
```

这只会修改指针的副本，`hName`不会修改原始指针。要修改它，您需要将指针传递给您的指针：

```
void Student::getHouse(char **hName)
{
     if (m_sHouse != NULL)
     {
        *hName = new char[strlen(m_sHouse)+1];
        strcpy(*hName, m_sHouse);
     }
 } 
```

并像这样调用你的函数：

```
student.getHouse(&house); 
```**

# javascript - javascript/jquery 全局变量未分配

> ID：11299330
> 
> 赞同：1
> 
> 时间：2012-07-02T18:41:09.193
> 
> 标签：javascript, jquery

我试图能够动态地重新加载我将用于自动完成字段的变量，但是我在加载初始调用时遇到了问题。目前，我的 javascript 由以下组成：

```
<script type="text/javascript">
  var myList;

  function setTextSuggest() {
    $("#loginInput").autocomplete({
      source: myList,
      appendTo: "#loginDiv"
    });
  };

  $(document).ready(function() {
    $.getJSON('StarWars.php', function(data) {
      myList = JSON.parse(data);
      //alert(myList); //DOES NOTHING WHEN UNCOMMENTED!!!!
      setTextSuggest();
    });
  });
</script> 
```

当我用 'data["info"]' 替换警报中的 myList 时，它会吐出我期望的 JSON 信息。但是，如果我取消注释警报并在 myList 上运行它，则根本不会打印任何内容。myList 应该在这里具有全局范围，但我无法弄清楚为什么它没有在我准备好的函数中分配。

有人对如何解决此问题有任何建议吗？

编辑：

以下是从 StarWars.php 返回的对象（通过 json_encode 创建）：

```
{"UserList":["Han Solo","Leia Organa","Luke Skywalker","Darth Vader","Emperor Palpatine","Chewbacca","R2-D2","C-3PO","Lando Calrissian","Lobot","Yoda","Obi-Wan Kenobi","Uncle Owen","Aunt Beru","Wedge Antilles","Boba Fett"]} 
```

如果我将 getJSON 请求设置为：

```
$.getJSON('StarWars.php', function(data) {
    myList = data.UserList;
    alert(myList);
    setTextSuggest();
}); 
```

然后它向我显示了名称列表，但我的自动完成中仍然没有设置任何内容。

编辑2：

我已经接受了杰克对这个问题的回答。虽然我的代码仍然存在问题（尚未附加自动完成功能），但 Jack 的解决方案已将其移出关于全局变量和 JSON 数据检索问题的领域，并转移到有关正确使用 jQuery 1.8 自动完成功能的问题中。我觉得这是一个不同的问题，所以我将此问题标记为已完成。-DG

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T18:53:29.287

从你的问题来看，`data`已经是一个合适的数组/对象（不是文本），所以你根本不需要`JSON.parse()`。

应该这样做：

```
myList = data; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T18:53:36.023

全局或局部范围的问题不是这里的问题。您的警报仍应触发并显示`[object Object]`，因为您没有引用使用声明的对象的任何属性`data`。

我创建了以下 jsFiddle 作为参考：http: [//jsfiddle.net/u8rVj/](http://jsfiddle.net/u8rVj/)。您将看到上述观察结果确实发生了。

JSON 输出是什么？

# jquery - 数组里面的数组敲除怎么办？

> ID：11299334
> 
> 赞同：0
> 
> 时间：2012-07-02T18:41:28.460
> 
> 标签：jquery, knockout.js, knockout-2.0

我有一个数组。

我有一张桌子：

这是我的模板：

我想要做的是每个 VegType 有 1 个用于胡萝卜的复选框，1 个用于土豆，1 个用于 ETC。

所以将显示的是：

等等……

但我希望 VegID 和 VegiType 显示在每个复选框旁边。

希望有人对此有所帮助。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:51:59.930

在我看来，您只希望在生成复选框时需要另一个 foreach：

```
<tbody data-bind="foreach: VegType" >
    <label data-bind="text: Vegitype"></label>
    <input type="checkbox" data-bind="attr:{id: VegID}"/> 
```

更新：

好的，所以看起来您想要执行以下操作：

```
<script type="text/html" id="a-template">
<tr>
    <td>
    <span data-bind="text: INFOTEXTAREA"></span>
    <textarea></textarea>
    <span data-bind="text: ID"></span>
    <ul data-bind="foreach: VegType">
    <li>
        <label data-bind="text: Vegitype"></label>
        <input type="checkbox" data-bind="attr:{id: VegID}" />
    </li>
    </ul>

</tr>
</script> 
```

# java - Google Maps API 是否允许交互式链接/路径？

> ID：11299340
> 
> 赞同：1
> 
> 时间：2012-07-02T18:42:07.013
> 
> 标签：java, google-maps, path, google-maps-markers

我有一个基于 Java 的应用程序，目前正在使用 JXMapViewer 显示 OpenStreet 地图作为一堆交互式顶点（具有纬度/经度属性）和边（顶点和边通过 Piccolo 绘制/交互的背景，一个开放-source 可缩放库）。单击顶点或边时，会在弹出窗口中显示一些静态数据。我想看看是否可以将整个kid-n-kaboodle 移至Google 地图。但我找不到 Google 的 API 是否支持上述交互式顶点*和*边的要求。

我相信顶点可以简单地是谷歌标记 - 我相信这些可以在点击时显示自定义文本。但是边缘呢？我在静态地图 API 中看到了一些绘制“路径”的能力，但没有提到交互性。

有人可以启发我吗？如果可以执行上述操作，有人可以指点我执行此操作的代码示例和/或演示吗？

# java - OpenCV 输出错误中的距离变换

> ID：11299347
> 
> 赞同：0
> 
> 时间：2012-07-02T18:42:42.810
> 
> 标签：java, android, image-processing, opencv, computer-vision

我正在使用 Android 二进制文件，这是我第一次在 OpenCV 中执行距离变换。[OpenCV 规范](http://opencv.itseez.com/modules/imgproc/doc/miscellaneous_transformations.html#distancetransform)说 distanceTransform的输出图像是 32 位浮点单通道图像。我将它放入垫子（mDist）中，但是在从垫子中创建位图时会引发 IllegalStateException。这是由于输出和 mat 对象不兼容吗？我是否必须为垫子或其他任何东西指定颜色通道详细信息？以下是我的代码部分。

![在此处输入图像描述](../Images/040e6d0f9f0e6a469796d76076625caf.png)

```
 Mat mImg = new Mat();
        Mat mThresh = new Mat();
        Mat mDist = new Mat();

        ImageView imgView = (ImageView) findViewById(R.id.imageView);
        Bitmap bmpIn = BitmapFactory.decodeResource(getResources(),
                R.drawable.w1);    
        Utils.bitmapToMat(bmpIn, mImg); //Load image to mat

        Imgproc.cvtColor(mImg, mImg, Imgproc.COLOR_BGR2GRAY);    
        Imgproc.threshold(mImg, mThresh, 0, 255, Imgproc.THRESH_BINARY
                | Imgproc.THRESH_OTSU); //Grayscale and thresholding        

        Imgproc.distanceTransform(mThresh, mDist, Imgproc.CV_DIST_L2, Imgproc.CV_DIST_MASK_PRECISE);

        Bitmap bmpOut = Bitmap.createBitmap(mDist.cols(), mDist.rows(),
                Bitmap.Config.ARGB_8888);   

        Utils.matToBitmap(mDist, bmpOut); //Error in creating bitmap
        imgView.setImageBitmap(bmpOut); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T12:24:29.763

错误出现在以下代码行中；

```
Bitmap bmpOut = Bitmap.createBitmap(mDist.cols(), mDist.rows(),
                Bitmap.Config.ARGB_8888); 
```

应该应用的 Bitmap.Config 不是 ARGB_8888。该函数创建一个 8 位单通道垫。

# php - php 网络爬虫中断，超时？

> ID：11299349
> 
> 赞同：0
> 
> 时间：2012-07-02T18:42:46.280
> 
> 标签：php, facebook, apache, web-crawler

我正在编写一个 PHP Web 应用程序来对多个（实际上是一长串）Facebook 页面进行统计。我将爬虫设置为每天从 Facebook 获取所有页面的数据，因此数据始终在本地数据库中更新。

问题是，有时爬虫会意外中断。我猜测的原因是：1）用完服务器的时间限制2）等待太长时间没有任何响应的数据并被杀死

您对解决这个问题有什么建议吗？非常感谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:48:55.690

您应该从增加 php.ini 中的 max_execution_time 变量开始。看看能不能解决你的问题。如果问题出在 Facebook 或您无法控制的任何其他网络服务器上，那么您无能为力。

*免责声明：这一切都假设您的代码是有效的，并且有时不会发现自己处于无限循环中......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:02:58.250

尝试添加

```
set_time_limit (0); 
```

在脚本的开头。

# oracle - Oracle 引用游标只能与过程和函数一起使用吗？

> ID：11299351
> 
> 赞同：0
> 
> 时间：2012-07-02T18:42:47.910
> 
> 标签：oracle, plsql, odp.net

Oracle Ref Cursors 是否只能与过程和函数一起使用，或者它们也可以与通过 ODP.NET OracleCommand 对象（作为字符串包含在 CommandText 属性中）发出的 PL/SQL 一起使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:55:38.773

这取决于您要完成的工作。

您当然可以从 .Net 或内部使用`REF CURSOR`. 但是，由于匿名 PL/SQL 块不接受或返回参数，因此您不能将`REF CURSOR`在匿名 PL/SQL 块中打开的 a 返回给调用应用程序。

从应用程序体系结构的角度来看，我强烈主张，如果您需要进行需要 PL/SQL 的处理，则该处理应该合并到包中并存储的命名 PL/SQL 块（过程或函数）中在数据库中。在 PL/SQL 中实现存储在数据库外部的逻辑通常是一个坏主意。

# android - 如何通过点击phonegap android状态栏LocalNotification插件的通知来启动活动？

> ID：11299353
> 
> 赞同：1
> 
> 时间：2012-07-02T18:42:51.747
> 
> 标签：android, plugins, cordova, localnotification

我正在开发一个带有 phoneGap 和 LocalNotification 插件的 android 应用程序。

至于通知部分，它已经在那里工作没有问题。

我只想在点击通知时打开应用程序。

作为 Gmail 应用程序，当电子邮件到达状态栏时，我们可以点击它并打开应用程序/活动。

本地通知插件网址：[https ://github.com/phonegap/phonegap-plugins/tree/master/Android/LocalNotification](https://github.com/phonegap/phonegap-plugins/tree/master/Android/LocalNotification)

让我知道，如果你不明白我想要什么。

提前致谢。

# json - RESTful GET 响应是否应该返回资源的 ID？

> ID：11299354
> 
> 赞同：27
> 
> 时间：2012-07-02T18:42:58.113
> 
> 标签：json, api, rest, restful-architecture, data-consistency

这里的一些开发人员正在就来自**RESTful API的****GET 请求**是否应该*返回所请求资源的 ID 进行*友好的（有些人会说宗教性的）讨论。让我们假设以下 GET 请求：

 ***[http://my.api.com/rest/users/23](http://my.api.com/rest/users/23)

这当前返回：

```
{"name": "Jim", "age": 40, "favoriteColor": "blue"} 
```

请注意，结果集中缺少“id”。

基本上有 4 个阵营在与这个问题作斗争。

**CAMP #1：**当调用者发出 GET 请求时，他们已经知道 ID。因此，结果集不应**包含**ID。如果调用者需要此数据来启用 UI 编辑，则调用者需要通过 ID 23，也许手动将成员 {"id": 23} 添加到 JSON。
Camp #1 中的人们还争辩说，结果集中存在 ID 表明该值可以修改，当然不能。

**CAMP #2：**如果没有 ID，JSON 结果集就不能原生地用于 UI 表单中的编辑/更新操作。相反，AJAX 回调机制需要负责传递 ID 字段并将这些字段手动添加到结果集中。这似乎很笨拙且容易出错。UI 人员正在争论结果集“感觉”就像它缺少应该存在的数据，即 ID。

**CAMP #3：**这些人关心的是一致性。如果我们曾经有一个 API 返回的用户对象集合，这些对象必须包含 ID。因此，为了保持一致性，GET 的单例版本也应该包含 ID。

**CAMP #4：**这些人建议用户的 GET 请求可以返回包含 ID 的 HyperMedia 或 SelfLinks 形式的元数据。

这不是一个深奥的“谁是对的？” 论据，要么。我们采用的方法将决定我们 API 的形状，并影响几个开发人员在新几周内的工作量。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-02T21:00:54.533

这是一个见仁见智的问题，这不是 Stackoverflow 喜欢看到的那种问题。无论如何，我会提供我的。

您正在返回对象或资源状态的表示。ID 是该表示的一部分，因此应该包含在 JSON 数据包中。它是资源的属性。呼叫者是否知道 ID 与讨论的关系并不特别密切。CAMP #1 处于摇摇欲坠的状态。

你提出的关于收藏的观点非常相关。对retrieve-1 操作使用一种表示，对retrieve-N 操作使用另一种表示是否有意义？我想不是。

**但是，**您面临的问题更为普遍——*传输给客户的表示中应包含哪些数据，以及在什么情况下？* 在某些情况下，调用者根本不关心属性的重要子集。尤其是在检索到大量对象的情况下——与基本通信成本相比，传输数据的成本更大——您希望优化返回的内容。

所有足够成熟的 REST 协议都有能力塑造返回的数据。

例如，请参阅

*   Facebook 图形 API，[http://developers.facebook.com/docs/reference/api/](http://developers.facebook.com/docs/reference/api/)
*   StackExchange API v2.0 - 您可以传递一个“过滤器”对象来精确地塑造返回的内容。
*   CouchDb API -*每个*视图都有一个 map 函数，它决定返回什么数据。它还有一个总括查询参数 ，`include_docs`它指示服务器包含完整对象或仅包含元数据。（在某些情况下，您可能只需要数据计数，而不需要实际数据。）

* * *

Facebook 允许您明确指定所需的字段。

![在此处输入图像描述](../Images/48b64a0792692ea38c59a72ad2d3a94c.png)

stackexchange API 很有趣。他们定义了一种全新类型的对象来支持整形。您可以使用 API 定义“过滤器”并将其保存在服务器端。然后在您的查询中传递一个带有过滤器 ID 的过滤器参数，返回的对象表示包括过滤器中指定的所有属性。如果没有过滤器，您将获得“默认”字段子集。要获得“所有字段”，您需要定义一个包罗万象的过滤器。

[您可以在https://api.stackexchange.com/docs/answers](https://api.stackexchange.com/docs/answers)看到这一点

...并具体查看过滤器规范对话框。

![在此处输入图像描述](../Images/ee58ba77c26af3f2b0beb7dccd47af85.png)

* * *

做事没有单一的正确方法。您需要平衡您支持的“塑造”功能的复杂性与开发成本以及将使用 API 的应用程序的需求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-07T03:10:04.630

老问题，但是自从我来这里寻找东西以来，这里又提出了另一种意见：

首先，我认为网址应该是：

[http://my.api.com/rest/Users/23](http://my.api.com/rest/Users/23)

不是

[http://my.api.com/rest/getUsers/23](http://my.api.com/rest/getUsers/23)

“GET”依赖于 HTTP 方法，而不是 URL。这只是命名，但有助于使事情更清楚，恕我直言。

如果您考虑这一点，则需要在具有 PUT 的同一 URL 中进行资源修改

[把](http://my.api.com/rest/Users/23)http://my.api.com/rest/Users/23

在这种情况下，客户端需要跟踪 URL，而不是 ID。资源是否返回 ID 字段并不重要。由客户保留一张地图，说明它是从哪里获得的。

如果您尝试将资源放入不同的 URL，例如“ [http://my.api.com/rest/Users/24](http://my.api.com/rest/Users/24) ”，则会出现以下几种情况：

1) [http://my.api.com/rest/Users/24](http://my.api.com/rest/Users/24)已经存在于服务器上并且服务器接受资源作为更新

2) [http://my.api.com/rest/Users/24](http://my.api.com/rest/Users/24)在服务器上不存在并且：

a) 服务器接受用户正在向不存在的资源提供 ID (24)（不推荐） b) 服务器接受 PUT 作为 POST

在 a + b 中，服务器将创建一个新资源。

所以：

1）根据您对客户端的信任程度，您可能应该在服务器上创建一个“签入/签出”控件以避免用另一个资源覆盖一个资源（这是 RESTful 吗？）

2）您不应该接受创建 ID 的客户（可以发布[http://my.api.com/rest/Users/](http://my.api.com/rest/Users/)，而不是[http://my.api.com/rest/Users/24](http://my.api.com/rest/Users/24)）并且您不应该接受PUT 到不存在的资源。

**编辑**：

所以我相信资源是由它的 URL 来标识的，而不是由 ID 来标识的。或者，换句话说，资源 ID 是[http://my.api.com/rest/Users/23](http://my.api.com/rest/Users/23)，而不是 23。

说得通？***

# ruby - 瘦身运行的Redmine不断崩溃

> ID：11299356
> 
> 赞同：2
> 
> 时间：2012-07-02T18:43:05.487
> 
> 标签：ruby, redmine, thin

我的 redmine 安装在运行了一段时间（以小时计）后会一直“崩溃”（停止响应 Web 请求）。

它安装在 Windows 2003 R2 x64 上，并通过带有反向代理的 Apache 进行代理。

DB 是本地 MySQL 5.5。

CMD 输出如下：

```
D:\Applications\redmine>thin -p 4000 -e production -D start
>> Using rack adapter
>> Thin web server (v1.3.1 codename Triple Espresso)
>> Debugging ON
>> Maximum connections set to 1024
>> Listening on 0.0.0.0:4000, CTRL+C to stop
D:/Applications/ruby/lib/ruby/gems/1.8/gems/coderay-1.0.6/lib/coderay/helpers/fi
le_type.rb:19: warning: already initialized constant UnknownFileType
D:/Applications/ruby/lib/ruby/gems/1.8/gems/coderay-1.0.6/lib/coderay/helpers/fi
le_type.rb:126: warning: already initialized constant TypeFromExt
D:/Applications/ruby/lib/ruby/gems/1.8/gems/coderay-1.0.6/lib/coderay/helpers/fi
le_type.rb:132: warning: already initialized constant TypeFromShebang
D:/Applications/ruby/lib/ruby/gems/1.8/gems/coderay-1.0.6/lib/coderay/helpers/fi
le_type.rb:138: warning: already initialized constant TypeFromName 
```

红宝石-v：

```
ruby 1.8.7 (2012-02-08 patchlevel 358) [i386-mingw32] 
```

宝石问：

```
*** LOCAL GEMS ***

actionmailer (3.2.3, 2.3.9, 2.3.5)
actionpack (3.2.3, 2.3.9, 2.3.5)
activemodel (3.2.3)
activerecord (3.2.3, 2.3.9, 2.3.5)
activeresource (3.2.3, 2.3.9, 2.3.5)
activesupport (3.2.3, 2.3.9)
arel (3.0.2)
builder (3.0.0)
bundler (1.1.3)
cgi_multipart_eof_fix (2.5.0)
coderay (1.0.6)
daemon_controller (1.0.0)
daemons (1.1.8)
erubis (2.7.0)
eventmachine (0.12.10)
fastercsv (1.5.5)
fastthread (1.0.7)
gem_plugin (0.2.3)
hike (1.2.1)
i18n (0.6.0, 0.4.2)
journey (1.0.3)
json (1.7.3)
mail (2.4.4)
mime-types (1.18)
multi_json (1.3.5)
mysql (2.8.1 x86-mingw32)
net-ldap (0.3.1)
passenger (3.0.12)
polyglot (0.3.3)
prototype-rails (3.2.1)
puma (1.3.1)
rack (1.4.1, 1.3.3)
rack-cache (1.2)
rack-openid (1.3.1)
rack-ssl (1.3.2)
rack-test (0.6.1)
rails (3.2.3, 2.3.9, 2.3.5)
railties (3.2.3)
rake (0.9.2.2)
rdoc (3.12)
ruby-openid (2.1.8)
rubygems-update (1.7.0)
sprockets (2.4.3, 2.1.3)
thin (1.3.1)
thor (0.15.2, 0.14.6)
tilt (1.3.3)
treetop (1.4.10)
tzinfo (0.3.33)
win32-api (1.4.8 x86-mingw32)
win32-service (0.7.2 x86-mingw32)
windows-api (0.4.1)
windows-pr (1.2.1) 
```

我已经提供了我认为对这个问题感兴趣的内容。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-18T16:48:15.497

似乎崩溃已经消失了。我想我改变了关于线程的东西，但我不确定。

/ 混沌

# javascript - 仅对路径/形状进行动画处理，在 raphael.js 集中没有文本

> ID：11299359
> 
> 赞同：0
> 
> 时间：2012-07-02T18:43:09.113
> 
> 标签：javascript, jquery, raphael, shapes

我在 raphael 中为形状设置动画时遇到了很大的问题。第一种方法是分别保留形状和文本，但是我遇到了十个问题，然后我悬停文本，形状没有动画（应该），然后，我创建了包含形状和文本的集合。不是我可以从对象访问路径，但我不能为它设置动画（我只想为形状设置动画，排除文本，但然后我将文本悬停，形状应该是动画）。我该如何解决这个问题？谢谢！

```
 this[0].animate is not a function 
```

[打破这个错误]

this[0].animate({ fill: attributes.fill }, 300);

```
 var st = r.set();
        st.push(obj);
        st.push(text);
        console.log(st);
        st.hover(function () {
            console.log(this.id);
            this[0].animate({ fill: '#204250' }, 300);
            this[0].g = this.glow({ color: "#0e2e3b", width: 12 });
        }, function () {
            this[0].animate({ fill: attributes.fill }, 300);
            this[0].g.remove();
        }).click(function (e) { 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T02:15:26.307

当您`this[0]`在 raphael 集中使用时，它实际上会引用 DOM 元素，该元素没有 animate 方法，因为它不是 raphael 对象。

我认为这是一种解决方法，因为应用于`.hover`Raphael 集它实际上会遍历集合的元素并将相同的事件应用于集合中的所有元素。

有几种方法可以解决这个问题，如果您的代码像您发布的那样简单，这可能就足够了：

```
var st = r.set();
        st.push(obj);
        st.push(text);
        console.log(st);
        st.hover(function () {
            var element = (this.type === "text") ? this.prev : this
            element.animate({ fill: '#204250' }, 300);
            element.g = element.glow({ color: "#0e2e3b", width: 12 });
        }, function () {
            var element = (this.type === "text") ? this.prev : this
            element.animate({ fill: attributes.fill }, 300);
            element.g.remove();
        });​ 
```

# entity-framework - EF 4.3.1 不在基表和子类表之间添加级联删除 DDL

> ID：11299361
> 
> 赞同：1
> 
> 时间：2012-07-02T18:43:12.587
> 
> 标签：entity-framework, entity-framework-4

我有一个基类 A 和一个派生类 B。使用 TPT，ON CASCADE DELETE 不会设置 B.id 和 A.id 之间的关系，所以如果不先删除 B，我就无法删除 A。

问题是，A 与位于图根的另一个实体存在多对一关系，我们称它为 R。

R 设置为对其所有 A 子级级联删除。这一半有效；删除 R 会导致 A 上的删除，但因为 EF 没有将级联设置到表 B，所以它会倒下。

这是一个功能吗？

# jquery - 使用 jQuery 的文本字段自定义验证

> ID：11299362
> 
> 赞同：0
> 
> 时间：2012-07-02T18:43:29.277
> 
> 标签：jquery, events

嗨，我是 jQuery 的新手。

我想要一个像这样工作的验证：

如果文本字段具有特定值，例如“Robi”，则在提交点击事件时，文本字段将变为空，但“Robi”以外的任何值都将成功提交数据。

请给一些建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:44:50.013

```
$("form").on("submit", function() {
    return $.trim($("#myInputField").val(function(i, val) {
        return val == "Robi" ? "" : val;
    }).val()) != "";
});​ 
```

**演示：http:** [//jsfiddle.net/2mR8b/](http://jsfiddle.net/2mR8b/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T18:52:43.873

HTML：

```
<form id="myform">
<input type="text" id="txtfield" value="" />
</form> 
```

JS：

```
$(document).ready(function() {

   $('#myform').submit(function() {
      if ($('#txtfield').val() == "Robi") { $('txtfield').val(''); return false; }
   });

}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-02T18:51:20.020

HTML：

```
<form>
  <input type='text' id='name' />
</form> 
```

脚本：

```
 $("form").on("submit", function() {
       var name = $("#name").val();
       if(name == "Robi"){
           $("#name").val("");
           return false;
        }
       else{
            // continue to submit
        }
    }); 
```

# html - CSS位置相对或绝对可变高度

> ID：11299377
> 
> 赞同：0
> 
> 时间：2012-07-02T18:44:34.797
> 
> 标签：html, css, html-table

我一直在尝试对齐我在图像上显示的“低”文本和箭头。基本上想要我是在蓝色图表下方对齐文本和箭头（低）一些像素。即图表3。

我正在从我的数据库中生成那些蓝条并创建一个表。这是代码：

```
.lower { 
    display: block; 
    font-size:7pt; 
    color:#666666; 
    position:relative; 
    bottom: 5px; 
    left:-25px;
}

<td valign="bottom" style="width:8px;height:20px;"
    <div style="padding: 0px;width:8px;height:" . round($var/2.5) . "px;background-position:bottom;background-repeat:no-repeat; display: block;">
        <div class="lower" >Low <img src="icon-sort-up.png" />
        </div>
    </div>
</td> 
```

`$var/2.5`一个人计算我的高以对齐我的“高”文本和箭头但不知何故影响我的低文本的 round( )。

[一只忙碌的猫 http://sandbox.visistat.com/partner-reports/live3/pulse.png](http://sandbox.visistat.com/partner-reports/live3/pulse.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:25:02.257

您将“较低”的 div 嵌套到“高”的 div 中，这就是为什么 round($var/2.5) 也会影响您的“较低”的 div。由于 round($var/2.5) 是内联而不是在单独的 CSS 文件中编写的，因此它将忽略 css 文件中的任何内容并采用内联样式。

为了防止这种情况，您可以将“较低”的 div 放在第一个 div 的下方，而不是嵌套在其中。

此外，您没有在代码示例中关闭开始的 td 标记，尽管这可能是一个错字。

# mysql - MySQL 订单不使用 join

> ID：11299381
> 
> 赞同：2
> 
> 时间：2012-07-02T18:44:42.347
> 
> 标签：mysql, join

我正在尝试创建一个 mysql 查询，根据他们的分数对 MMA 战士进行排名，以及他们是否专业，以及他们的体重等级，共同创建一个战士部门。我有一张包含所有拳手的表格，其中包含他们的体重、状态（专业或业余）和一堆其他列。我还有一个表格，其中包含从他们所有的战斗中计算出来的分数。记录需要按部门和分数排序，但我只能让我的查询按部门排序：

```
INSERT INTO fa_rankings (fighter_id, rank, division)
SELECT 
    fa_scores.fighter_id,
    @r := CASE WHEN @div <> f_division THEN 1 ELSE @r+1 END as f_rank,
    @div := f_division
FROM
    (SELECT @div := NULL) d,
    (SELECT @r := 0) r,
    fa_scores
JOIN (SELECT fa_fighters.fighter_id,
        CONCAT(
            IF(status = 'professional', 'a', 'b'),
            CASE
                WHEN weight < 126 THEN 0
                WHEN weight BETWEEN 126 AND 135 THEN 1
                WHEN weight BETWEEN 136 AND 145 THEN 2
                WHEN weight BETWEEN 146 AND 155 THEN 3
                WHEN weight BETWEEN 156 AND 170 THEN 4
                WHEN weight BETWEEN 171 AND 185 THEN 5
                WHEN weight BETWEEN 186 AND 205 THEN 6
                WHEN weight BETWEEN 206 AND 265 THEN 7
                ELSE 8 END) as f_division
    FROM fa_fighters
    ORDER BY f_division ASC) as fighters using (fighter_id)
ORDER BY score DESC 
```

我猜这与最后一个 order by 语句的位置有关，但我不知道该放在哪里，因为它在连接查询中不起作用。现在，此查询生成以下内容：

```
Rankings Table                   Compared with Scores
+------------+------+----------+ +-------+
| fighter_id | rank | division | | score |
+------------+------+----------+ +-------+
| 131        | 1    | a1       | | 0     |
| 23         | 2    | a1       | | 34    |
| 332        | 3    | a1       | | 4     |
| 1233       | 1    | a2       | | 0     |
| 643        | 2    | a2       | | 44    |
+------------+------+----------+ +-------+ 
```

编辑：我之前的查询没有使用联接，但仅按战斗机是否专业进行分组，并且该查询确实正确应用了排名，所以我怀疑它与联接有关。

编辑：这是我选择的输出

```
SELECT * ,
(SELECT CONCAT_WS(  ' ', f_name, l_name ) FROM fa_fighters WHERE fa_fighters.fighter_id = fa_rankings.fighter_id)
AS name,
(SELECT score FROM fa_scores WHERE fa_scores.fighter_id = fa_rankings.fighter_id) 
AS score
FROM  `fa_rankings` 
WHERE 1 
ORDER BY division, rank ASC 
LIMIT 0 , 30 
```

![选择结果](../Images/34508ac17216201f18f79d644307745b.png)

编辑：它是按分数排序记录，但在错误的位置；它在确定排名后按分数对它们进行排序，因此原始表按分数排序，但战士没有与它们相关联的正确排名。我需要查询在运行排名计数器并确定每个战士排名之前按分数对记录进行排序。这是在执行查询时应用 ORDER BY 的问题，我只是不知道该放在哪里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T20:28:53.297

我发现将“ORDER BY score DESC”移动到连接的子查询中会产生正确的结果：

```
INSERT INTO fa_rankings (fighter_id, rank, division)
SELECT 
    fa_scores.fighter_id,
    @r := CASE WHEN @div <> f_division THEN 1 ELSE @r+1 END as f_rank,
    @div := f_division
FROM
    (SELECT @div := NULL) d,
    (SELECT @r := 0) r,
    fa_scores
JOIN (SELECT fa_fighters.fighter_id,
        CONCAT(
            IF(status = 'professional', 'a', 'b'),
            CASE
                WHEN weight < 126 THEN 0
                WHEN weight BETWEEN 126 AND 135 THEN '1'
                WHEN weight BETWEEN 136 AND 145 THEN '2'
                WHEN weight BETWEEN 146 AND 155 THEN '3'
                WHEN weight BETWEEN 156 AND 170 THEN '4'
                WHEN weight BETWEEN 171 AND 185 THEN '5'
                WHEN weight BETWEEN 186 AND 205 THEN '6'
                WHEN weight BETWEEN 206 AND 265 THEN '7'
                ELSE '8' END) as f_division
    FROM fa_fighters
    ORDER BY 
        f_division ASC,
        #the score column in the form of a subquery
        (select score from fa_scores where fa_scores.fighter_id = fa_fighters.fighter_id) DESC) 
    as fighters using (fighter_id) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T18:59:52.917

看起来你的表 TABLE 有一个关于除法的索引，这就是输出看起来像这样的原因。

如果您在进行查询时没有指定`order by`，则该表将根本没有任何顺序，即使使用索引您也会有某种顺序，但在大型表中不是 100% 准确。

恢复，在您的查询中，您有一个带有顺序和连接的 INSERT，但这并不意味着当您创建时`select.....`，输出将与输入的顺序相同。我的建议是始终指定`ORDER BY`并具有唯一或主键（至少其中一个）。

# null - Selenium RC 的 session null 错误

> ID：11299384
> 
> 赞同：0
> 
> 时间：2012-07-02T18:45:10.570
> 
> 标签：null, selenium-rc

```
Firefox version - 12.0

Eclipse Java EE IDE for Web Developers.

Version: Indigo Service Release 1
Build id: 20110916-0149

selenium-remote-control-1.0.3 
```

我已经对服务器进行了分层

当我从 Eclipse 运行以下代码时，我无法打开 firefox

```
Selenium selenium = new DefaultSelenium("localhost",4444,"*firefox","http://bing.com");
        selenium.setSpeed("5000");
        selenium.start();
        selenium.windowMaximize();
        selenium.windowFocus();
        selenium.open("/"); 
```

我收到以下错误，说会话为空

我想知道如何解决这个问题。这是浏览器兼容性问题吗？

```
00:03:35.989 INFO - Java: Sun Microsystems Inc. 20.2-b06
00:03:35.989 INFO - OS: Windows 7 6.1 amd64
00:03:35.989 INFO - v0.9.2 [2006], with Core v0.8.3 [1879]
00:03:36.052 INFO - Version Jetty/5.1.x
00:03:36.052 INFO - Started HttpContext[/selenium-server/driver,/selenium-server/driver]
00:03:36.052 INFO - Started HttpContext[/selenium-server,/selenium-server]
00:03:36.052 INFO - Started HttpContext[/,/]
00:03:36.083 INFO - Started SocketListener on 0.0.0.0:4444
00:03:36.083 INFO - Started org.mortbay.jetty.Server@72e3b895
00:04:10.692 INFO - Checking Resource aliases
00:04:10.692 INFO - Command request: setSpeed[2000, ] on session null
00:04:10.692 INFO - Got result: OK on session null
00:04:10.708 INFO - Command request: getNewBrowserSession[*firefox, http://gmail.com, ] on session null
00:04:10.786 INFO - Launching session 50708
00:04:10.895 INFO - Preparing Firefox profile...
00:08:40.713 INFO - Command request: setSpeed[5000, ] on session null
00:08:40.713 INFO - Got result: OK on session null
00:08:40.728 INFO - Command request: getNewBrowserSession[*firefox, http://bing.com, ] on session null
00:08:40.728 INFO - Launching session 320728
00:08:40.837 INFO - Preparing Firefox profile... 
```

# algorithm - 需要找到我的算法的时间和空间复杂度

> ID：11299386
> 
> 赞同：1
> 
> 时间：2012-07-02T18:45:14.023
> 
> 标签：algorithm, binary-tree, time-complexity, tree-traversal

不知何故，我设法编写了一个算法，用于从它的中序和前序遍历数据构造二叉树。

我不确定**如何计算**该算法的时间和空间复杂度。

我的猜测是

```
first pass  --> n(findInNode) + n/2 (constructTree) + n/2 (constructTree)
second pass --> n/2(findInNode) + n/4 (constructTree) + n/4 (constructTree)
etc.. 
```

所以它应该是**大约（3logn）**

如果我错了，请纠正我。

```
public class ConstructTree {
    public static void main(String[] args) {
        int[] preOrder = new int[] { 1, 2, 3, 4, 5 };
        int[] inOrder = new int[] { 2, 1, 4, 3, 5 };

        int start = 0;
        int end = inOrder.length -1;
        Node root =constructTree(preOrder, inOrder, start, end);

        System.out.println("In order Tree"); root.inOrder(root);
        System.out.println("");
        System.out.println("Pre order Tree"); root.preOrder(root);
        System.out.println("");

    }

    public static int preInd = 0;
    public static Node constructTree(int[] pre, int[] in, int start, int end) {
        if (start > end) {
            return null;
        }

        int nodeVal = pre[preInd++];
        Node node = new Node(nodeVal);
        if (start != end) {
            int ind = findInNode(nodeVal, in, start, end);
            node.left = constructTree(pre, in, start, ind-1);
            node.right = constructTree(pre, in, ind+1, end);
        }
        return node;
    }

    public static int findInNode(int nodeVal, int[] in, int start, int end) {
        int i = 0;
        for (i = start; i <= end; i++) {
            if(in[i] == nodeVal)
            {
                return i;
            }
        }
        return -1;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T20:54:02.280

为了估计运行时复杂度，让我们从简单的开始`findInNode`：

> *T* [findInNode] = Ο( *n* )

因为我们有递归调用，所以估计`constructTree`有点困难。但是我们可以使用这种模式将 ... 拆分为本地成本和递归成本：

每次调用`constructTree`我们都有*T* [findInNode] = Ο( *n*`constructTree` ) 的本地成本和两个使用*n* -1 而不是*n*的递归调用。所以

> *T‍* <sub>constructTree( [n] ) *=* TfindInNode *(* n *)* +2· *TconstructTree* [(] *n* -1))

 ***由于`constructTree`每次调用 的递归调用次数都会翻倍`constructTree`，因此递归调用树会随着每个递归步骤的增长而增长，如下所示：

```
 n                    | 2^0·n = 1·n
         _________|_________           |
        |                   |          |
       n-1                 n-1         | 2^1·n = 2·n
    ____|____           ____|____      |
   |         |         |         |     |
  n-2       n-2       n-2       n-2    | 2^2·n = 4·n
  / \       / \       / \       / \    |
n-3 n-3   n-3 n-3   n-3 n-3   n-3 n-3  | 2^3·n = 8·n 
```

所以第`constructTree`一次调用后的总调用次数`constructTree`为*n*，递归调用第一步后为*n* +2· *n*次调用，第二步后为*n* +2· *n* +4· *n*，以此类推. 由于此递归调用树的总深度为*n*（每次递归*n*减 1），总调用次数`constructTree`为：

> 2 ⁰ + 2 ¹ + 2 ² + … + 2 ^(*n*) = 2 ^(n+1) -1

因此：

> *T‍* <sub>constructTree( *n* ) = (2 ^(n+1) -1)· *n* ∈ Ο(2 ^(*n*) )。

所以你的算法具有指数时间复杂度。

空间复杂度也是 Ο(2 ^(*n*) )，因为每次递归调用的局部空间成本为 1 `constructTree`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T18:58:28.617

时间复杂度 = O(n^2)。2 次递归调用需要 O(n) 来构造二叉树，每个节点构造需要 O(n) 进行顺序搜索，即 O(n^2)。

空间复杂度 = 常数，忽略 2 个输入数组和作为输出的构建二叉树***

# sql - Hive SQL - 优化 JOIN 查询以忽略 Null 值

> ID：11299389
> 
> 赞同：2
> 
> 时间：2012-07-02T18:45:23.253
> 
> 标签：sql, join, hive

我对 SQL 有点陌生，所以请耐心等待。

我有两个表，每个表都有一个 ID 列。表 A 有一列标题为角色，表 B 有一列标题为结果。我想查询这些表以查找基于 ID 的哪些行具有角色 = 'PS' 和结果 = 'DE'。这是我的代码：

```
SELECT count(*)
FROM A JOIN B
ON (A.id = B.id
AND A.role = 'PS'
AND B.outcome = 'DE') 
```

我一直在互联网上寻找一种方法来执行此操作，以便它不包含 A.role 或 B.outcome 具有空值的行。

上面的代码可以说是 40,100，即使 B 中 B.outcome = 'DE' 的条目总数仅为 40,000。所以它显然包括不符合我条件的条目。有没有办法更好地优化我的查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:33:00.910

您的查询已经排除了具有`null`in 值的行`A.role`。毕竟，`null = 'PS'`这不是真的，而且您使用的是内部联接。

有一个简单的解释说明如何从连接中检索比 B 中更多的行。假设您有这些行用于 A：

```
 A.id   A.role
 1      'A'
 1      'A' 
```

B的这些行：

```
 B.id   B.outcome
 1      'A'
 1      'A' 
```

然后这个查询：

```
select  *
from    A
join    B
on      A.id = B.id and A.role = 'A' and B.role = 'A' 
```

将返回 4 行。这比表 A 或 B 中的要多！

所以我会调查是否`id`是独一无二的：

```
select count(*) from A group by id having count(*) > 1
select count(*) from B group by id having count(*) > 1 
```

如果这些查询返回的计数大于零，`id`则不是唯一的。由于连接会为每个匹配项重复行，这可以解释返回记录量的大幅增加。

# grails - 在 Grails 中完成验证后有没有办法操作域对象

> ID：11299403
> 
> 赞同：1
> 
> 时间：2012-07-02T18:46:34.297
> 
> 标签：grails, grails-orm

在 Grails 中完成验证后，有没有办法操作 Domain 对象？

我必须在插入数据库之前对密码进行编码，但我只想在验证完成后才这样做。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T19:04:51.167

您可以使用事件：

```
beforeInsert - Executed before an object is initially persisted to the database
beforeUpdate - Executed before an object is updated 
```

[http://grails.org/doc/latest/guide/GORM.html](http://grails.org/doc/latest/guide/GORM.html)

您可以查看 spring security 插件生成的用户类以查看示例。也许该插件符合您的要求，因此您不必重新实现此功能？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T22:54:18.500

对我来说，您在 gorm 对象中验证的内容应该是您保存的内容。如果您想验证未编码的密码，那么我建议您创建一个对密码具有适当约束的[命令对象](http://grails.org/doc/latest/guide/theWebLayer.html#commandObjects)并对其进行验证。如果命令对象通过验证，则对密码进行编码并将其添加到要插入/更新的 gorm 对象中。

这样，gorm 对象只会看到编码的密码，在这里你应该验证它不是空的（或者看起来像一个十六进制编码的密码）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T11:00:32.680

从事这项工作：

```
class User {

  transient saltSource
  transient springSecurityService
  String password

  static constraints = {
    password blank: false
  }
  static mapping = {
    password column: '`password`'
  }
  def beforeInsert() {
    encodePassword()
  }
  def beforeUpdate() {
    if (isDirty('password')) {
        encodePassword()
    }
  }
  protected void encodePassword() {
    if (springSecurityService)
        password = springSecurityService.encodePassword(password,saltSource.systemWideSalt)
  }

} 
```

要考虑的事情是您如何验证密码复杂性，它应该发生在控制器和域类之间的服务中，还是应该是自定义密码字段验证器。

# c# - AuthorizationFilterAttribute 的正确使用

> ID：11299404
> 
> 赞同：2
> 
> 时间：2012-07-02T18:46:38.710
> 
> 标签：c#, asp.net-web-api

假设我有一个类似以下的 xml，它被发布到 api 控制器：

```
<request>
<header><api_key>Somekey</api_key></header>
</request> 
```

如果我想在自定义 AuthorizationFilterAttribute 中验证 api 键，如下所示：

```
public override void OnAuthorization(HttpActionContext actionContext)
{
    // Deserialize the posted message and validate the api key.
} 
```

我怎样才能做到这一点而不必手动反序列化它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T10:16:48.917

你是什​​么意思你不想“手动反序列化它”？您是指控制器支持的自动模型绑定吗？如果是这样，您将无法在管道中利用这些优势。

为了回应 peco 的评论，您不应该将 api 密钥放在正文中，而应将其放在标题或查询字符串中。

# javascript - 使用 onclick-Javascript 通过数组递增

> ID：11299407
> 
> 赞同：-1
> 
> 时间：2012-07-02T18:46:43.820
> 
> 标签：javascript

我有一个标题和图像的轮播。单击图像时，问题/标题会发生变化。我在编写允许我通过 questionList 数组 onclick 递增的函数/代码时遇到问题。

```
var mycarousel_questionList= [
{qID: 1, title: "Question 1"},
{qID: 2, title: "Question 2"},
{qID: 3, title: "Question 3"},
]; 
```

^^这是我的数组

```
function mycarousel_questionListInc(){
   pages=mycarousel_questionList.length;
   var pageNo=0;
   document.onclick=pageNo++;
   mycarousel_questionList[pageNo].title;
} 
```

^^这是我到目前为止所拥有的。先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T18:52:00.113

您需要将已有的函数设置为[事件侦听](http://www.quirksmode.org/js/introevents.html)器：

```
var pageNo=0;
function mycarousel_questionListInc(){
    pages=mycarousel_questionList.length;
    pageNo++;
    mycarousel_questionList[pageNo].title;
}
document.onclick = mycarousel_questionListInc; 
```

# xslt - SharePoint 2010 将分页添加到自定义 DataViewWebPart

> ID：11299411
> 
> 赞同：0
> 
> 时间：2012-07-02T18:46:50.340
> 
> 标签：xslt, sharepoint-2010, sharepoint-designer, dataviewwebpart

我有一个要添加分页的自定义 DataViewWebPart。我已经包含了我正在使用的 XSLT 的内容，以形成下面我的 Web 部件的详细信息范围。关于如何在这个项目上实现分页的任何建议（因为我正在使用密钥，所以我不太清楚）。

```
<xsl:key name="casebystate" match="Row" use="@StoreState"/>

   <xsl:template match="/">
      <xsl:variable name="cbs_Rows" select="/dsQueryResponse/Rows/Row/@StoreState"/>
      <table border="0" width="100%" cellpadding="2" cellspacing="0">
         <tr valign="top">
            <th class="ms-vh" nowrap="nowrap">State</th>
            <th class="ms-vh" nowrap="nowrap">Totals</th>
         </tr>
         <xsl:for-each select="//Row[generate-id() = generate-id(key('casebystate', @StoreState)[1])]">
            <xsl:sort select="@StoreState"/>
            <xsl:for-each select="key('casebystate', @StoreState)">
                <xsl:call-template name="CaseByState.rowview" />
            </xsl:for-each>
         </xsl:for-each>
      </table>         
   </xsl:template>

   <xsl:template name="CaseByState.rowview">
      <xsl:variable name="cbs_NewSortValue" select="ddwrt:NameChanged(string(@StoreState), 0)"/>
      <xsl:if test="string-length($cbs_NewSortValue) &gt; 0">
         <tr id="group0{generate-id()}">
            <td class="abh-chrtStatTitle">
               <xsl:value-of select="@StoreState"/>
            </td>
            <td class="abh-chrtStatValue">
                <xsl:value-of select="count(key('casebystate', @StoreState))"></xsl:value-of>
            </td>
         </tr>
      </xsl:if>
   </xsl:template> 
```

我在这里先向您的帮助表示感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T16:43:03.147

如果您使用的是 Sharepoint Designer 2010，您是否可以在设计器中选择您的 dvwp，转到数据视图工具部分并从功能区的选项选项卡中单击分页？这应该允许您为您的 webpart 指定分页。

# android - AVD 中的日文数字键盘

> ID：11299412
> 
> 赞同：0
> 
> 时间：2012-07-02T18:46:52.230
> 
> 标签：android, eclipse, avd

我在 Windows 7 机器上运行 Eclipse。自从上次将 Android 相关文件（Android SDK 和 AVD）更新到 4.1 版以来，我的键盘看起来很奇怪：

![在此处输入图像描述](../Images/2041c3ae85a1feb815f4e3b917a6bd67.png)

*（这是 Android 开发者网站上教程的第一部分......）*

我以前有一个真正的 qwerty 键盘，但现在它不仅（部分）是日语，而且我似乎找不到如何将其更改为 qwerty 键盘。

我尝试检查更新，重新启动程序和整个 PC，更改 AVD 键盘设置和具有不同 Android 版本的不同虚拟设备（图片显示 2.3.3）。

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T14:46:48.237

如果您在输入文本框中单击并按住（您的鼠标按钮），则会出现一个菜单，`Input Method` 单击该菜单并`Select input method`应出现一个菜单。选择`Android keyboard`，您将回到标准的 qwerty 键盘。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T18:52:52.810

尝试删除 AVD 实例并创建一个新实例。它看起来确实很奇怪，但创建一个新的虚拟设备并启动它不会花很长时间......肯定比拔头发更有建设性

# python - Django模板加载器行为？（得到 Django TemplateDoesNotExist 异常）

> ID：11299415
> 
> 赞同：2
> 
> 时间：2012-07-02T18:47:21.503
> 
> 标签：python, django, django-templates

**文件夹结构**

我目前正在从 Django 书中学习 Django。我有以下目录结构：

```
.
└── mysite
    ├── books
    │   ├── __init__.py
    │   ├── models.py
    │   ├── templates
    │   │   ├── search_form.html
    │   │   └── search_results.html
    │   ├── tests.py
    │   └── views.py
    ├── contact
    │   ├── forms.py
    │   ├── __init__.py
    │   ├── templates
    │   │   └── contact_form.html
    │   └── views.py
    ├── manage.py
    └── mysite
        ├── __init__.py
        ├── settings.py
        ├── templates
        │   ├── base.html
        │   ├── current_datetime.html
        │   └── hours_ahead.html
        ├── urls.py
        ├── views.py
        └── wsgi.py 
```

book、contact 和 mysite 是文件夹。我还有一个单独的模板子文件夹，用于每个文件夹来存储模板。

**故事**

现在，在*/mysite/settings.py*里面，我有以下几行：

```
TEMPLATE_DIRS = (
    os.path.join(os.path.dirname(__file__), 'templates').replace('\\', '/'),
) 
```

在*/contact/views.py*中，我有以下行（注意这里的渲染来自 django.shortcuts）：

```
return render(request, 'contact_form.html', {'form': form}) 
```

但是，上面的行给了我一个 TemplateDoesNotExist 异常。*这是因为模板加载器在/mysite/templates/*下查找文件 contact_form.html而不是*/contact/templates/*。

很公平，尽管我不明白为什么会这样。但是，我还有另一种情况，它的行为不同。

回想一下上面的文件结构，我也有`books/views.py`. 在其中，我有以下几行（在不同的逻辑块中）：

```
return render(request, 'search_results.html',
                {'books': books, 'query': q}) 
```

和

```
return render(request, 'search_form.html', {'errors': errors}) 
```

如果您回头看，search_results.html 和 search_form.html 位于*/books/templates/*文件夹下，而不是*/mysite/templates/*文件夹下，但模板加载器设法找到了这些文件。请注意，即使我将 search_results.html 和 search_form.html 移动到*/mysite/templates/*中，它仍然有效。

所以我的问题是，为什么加载器在哪里寻找模板会有所不同？

**文件**

无论如何，这就是我的*/contact/views.py*的样子：

```
from django.shortcuts import render
from django.http import HttpResponseRedirect
from django.core.mail import send_mail
from forms import ContactForm
import os

def contact(request):
    if request.method == 'POST':
        form = ContactForm(request.POST)
        if form.is_valid():
            cd = form.cleaned_data
            send_mail(
                    cd['subject'],
                    cd['message'],
                    cd.get('email', 'noreply@example.com'),
                    ['siteowner@example.com'],
            )
            return HttpResponseRedirect('/contact/thanks/')
    else:
        form = ContactForm()
    print os.path.join(os.path.dirname(__file__), 'templates')
    return render(request, 'contact_form.html', {'form': form}) 
```

这是我的*/books/views.py*：

```
from django.shortcuts import render
from django.http import HttpResponse
from books.models import Book

def search(request):
    errors = []
    if 'q' in request.GET:
        q = request.GET['q']
        if not q:
            errors.append('Enter a search term.')
        elif len(q) > 20:
            errors.append('Please enter at most 20 characters.')
        else:
            books = Book.objects.filter(title__icontains=q)
            return render(request, 'search_results.html',
                {'books': books, 'query': q})
    return render(request, 'search_form.html', {'errors': errors}) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-02T18:50:55.887

由于您显然确实安装了应用程序目录模板加载器，并且由于它适用于您的`books`应用程序，因此我只能得出结论您没有`contact`在 `settings.INSTALLED_APPS`.

# sql - 加入多对多关系，执行时间

> ID：11299416
> 
> 赞同：3
> 
> 时间：2012-07-02T18:47:23.143
> 
> 标签：sql, postgresql

我有更多关于[加入多对多关系的](https://stackoverflow.com/questions/10485414/joining-many-to-many-relationships)问题，但我认为最好提出一个新问题。

完整查询：

```
SELECT p.id
     ,(100 * sum((a.price > 0)::int)) / cc.ct AS commercial
     ,(100 * sum((a.price = 0)::int)) / cf.ct AS free
FROM  (SELECT count(*)::float AS ct FROM applications WHERE price > 0) AS cc
     ,(SELECT count(*)::float AS ct FROM applications WHERE price = 0) AS cf
     ,permissions p
LEFT   JOIN applications_permissions ap ON ap.permission_id = p.id
LEFT   JOIN applications a ON a.id = ap.application_id
GROUP  BY 1, cc.ct, cf.ct
ORDER  BY 2 DESC, 3 DESC, 1; 
```

关于执行时间：

```
SELECT p.id 
```

-> 总运行时间：2,467.801 毫秒

```
SELECT (SELECT regex FROM permissions WHERE id = p.id) AS regex 
```

-> 总运行时间：28,882.293 毫秒

这里发生了什么？这样做的正确方法是什么？

选择 p.id

```
QUERY PLAN
Sort  (cost=123257.63..123258.07 rows=178 width=24)
  Sort Key: (((sum(((a.price > 0::double precision))::integer))::double precision / ((count(*))::double precision))), (((sum(((a.price = 0::double precision))::integer))::double precision / ((count(*))::double precision))), p.id
  ->  HashAggregate  (cost=123244.74..123250.97 rows=178 width=24)
        ->  Hash Left Join  (cost=53709.64..115103.31 rows=651315 width=24)
              Hash Cond: (ap.application_id = a.id)
              ->  Hash Left Join  (cost=42222.11..82232.48 rows=651315 width=24)
                    Hash Cond: (p.id = ap.permission_id)
                    ->  Nested Loop  (cost=18283.65..18305.06 rows=178 width=20)
                          ->  Index Scan using permissions_pkey on permissions p  (cost=0.00..17.85 rows=178 width=4)
                                Filter: (regex IS NOT NULL)
                          ->  Materialize  (cost=18283.65..18283.66 rows=1 width=16)
                                ->  Nested Loop  (cost=18283.60..18283.65 rows=1 width=16)
                                      ->  Aggregate  (cost=9016.51..9016.52 rows=1 width=0)
                                            ->  Seq Scan on applications  (cost=0.00..8915.85 rows=40262 width=0)
                                                  Filter: (price > 0::double precision)
                                      ->  Aggregate  (cost=9267.09..9267.10 rows=1 width=0)
                                            ->  Seq Scan on applications  (cost=0.00..8915.85 rows=140494 width=0)
                                                  Filter: (price = 0::double precision)
                    ->  Hash  (cost=11271.65..11271.65 rows=772065 width=8)
                          ->  Seq Scan on applications_permissions ap  (cost=0.00..11271.65 rows=772065 width=8)
              ->  Hash  (cost=8453.68..8453.68 rows=184868 width=8)
                    ->  Seq Scan on applications a  (cost=0.00..8453.68 rows=184868 width=8)
22 row(s)
Total runtime: 4.524 ms 
```

选择（选择...）

```
QUERY PLAN
Sort  (cost=3796049.42..3796049.86 rows=178 width=24)
  Sort Key: (((sum(((a.price > 0::double precision))::integer))::double precision / ((count(*))::double precision))), (((sum(((a.price = 0::double precision))::integer))::double precision / ((count(*))::double precision))), ((SubPlan 1))
  ->  HashAggregate  (cost=3795033.06..3796042.76 rows=178 width=24)
        ->  Hash Left Join  (cost=53709.64..3786891.62 rows=651315 width=24)
              Hash Cond: (ap.application_id = a.id)
              ->  Hash Left Join  (cost=42222.11..82232.48 rows=651315 width=24)
                    Hash Cond: (p.id = ap.permission_id)
                    ->  Nested Loop  (cost=18283.65..18305.06 rows=178 width=20)
                          ->  Index Scan using permissions_pkey on permissions p  (cost=0.00..17.85 rows=178 width=4)
                                Filter: (regex IS NOT NULL)
                          ->  Materialize  (cost=18283.65..18283.66 rows=1 width=16)
                                ->  Nested Loop  (cost=18283.60..18283.65 rows=1 width=16)
                                      ->  Aggregate  (cost=9016.51..9016.52 rows=1 width=0)
                                            ->  Seq Scan on applications  (cost=0.00..8915.85 rows=40262 width=0)
                                                  Filter: (price > 0::double precision)
                                      ->  Aggregate  (cost=9267.09..9267.10 rows=1 width=0)
                                            ->  Seq Scan on applications  (cost=0.00..8915.85 rows=140494 width=0)
                                                  Filter: (price = 0::double precision)
                    ->  Hash  (cost=11271.65..11271.65 rows=772065 width=8)
                          ->  Seq Scan on applications_permissions ap  (cost=0.00..11271.65 rows=772065 width=8)
              ->  Hash  (cost=8453.68..8453.68 rows=184868 width=8)
                    ->  Seq Scan on applications a  (cost=0.00..8453.68 rows=184868 width=8)
              SubPlan 1
                ->  Seq Scan on permissions  (cost=0.00..5.64 rows=1 width=26)
                      Filter: (id = $0)
25 row(s)
Total runtime: 6.566 ms 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:09:26.423

看起来您正在尝试将相关子查询添加到`SELECT`列表中，而您可以只选择该列：

```
SELECT p.id, p.regex
     ,(100 * sum((a.price > 0)::int)) / cc.ct AS commercial
     ,(100 * sum((a.price = 0)::int)) / cf.ct AS free
FROM  (SELECT count(*)::float AS ct FROM applications WHERE price > 0) AS cc
     ,(SELECT count(*)::float AS ct FROM applications WHERE price = 0) AS cf
     ,permissions p
LEFT   JOIN applications_permissions ap ON ap.permission_id = p.id
LEFT   JOIN applications a ON a.id = ap.application_id
GROUP  BY p.id, p.regex, cc.ct, cf.ct
ORDER  BY commercial DESC, free DESC, p.id; 
```

如果是主键，它会覆盖整个表，从 Postgres 9.1 开始`p.id`就不需要添加`p.regex`了。`GROUP BY`

# google-apps-script - Google Docs 脚本触发器的超时长度

> ID：11299418
> 
> 赞同：4
> 
> 时间：2012-07-02T18:47:42.510
> 
> 标签：google-apps-script

Google 文档中脚本触发器的超时长度是多少？

例如，我在输出到电子表格的脚本中每分钟查询一个 RESTful API。它通常每天失败几次，错误类型为“超时”和“地址不可用”。

该服务指出，有时在负载下 API 需要超过 30 秒才能响应，但应在 60 秒内完成所有查询。

如果我担心用户未打开电子表格时的超时存在差异。

或者，有没有办法可以更改脚本触发器的超时？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-18T13:26:40.387

超时的不是脚本，而是 UrlFetchApp 请求。如果服务器在 60 秒内没有响应，那么您将收到“超时”错误。

# ios - 使用中文手机时，带有 OCMaps 的 iOS 应用程序崩溃

> ID：11299422
> 
> 赞同：0
> 
> 时间：2012-07-02T18:47:49.700
> 
> 标签：ios, objective-c, iphone, google-maps

我的任务是对使用 OCMapView 的 iOS 应用程序进行维护。

我刚刚意识到，当使用中文应用程序时，当在 OCMapView 实例上调用选择器 doClustering 时，它会爆炸。

这对我来说是一个非常令人费解的行为，因为我认为无论环境语言如何，OCMapView 类都应该始终具有相同的方法。我错了吗？

您对如何找到解决此问题的方法有任何建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:12:26.383

这是一个非常愚蠢的问题：翻译后的 xib 文件被配置为实例化 MKMapView 而不是 OCMapView。

# ios - UITableView 滚动

> ID：11299428
> 
> 赞同：0
> 
> 时间：2012-07-02T18:48:09.773
> 
> 标签：ios, uitableview

我用 10 行填充表格视图。当我向上滚动表格时，前 2 或 3 行会冻结一段时间。我只看到最后一行 2 或 3 秒。我意识到滚动表格会调用 cellForRowAtIndexPath 和 willDisplayCell 函数。我使用这些功能。似乎对这些功能的调用减少了响应时间。滚动表格时如何禁用调用这些函数？请注意，我不想禁用滚动。

```
static NSString *CellIdentifier = @"Cell"; 

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
}

cell.textLabel.text = [[self.items objectAtIndex:indexPath.row] valueForKey:@"name"]; 

if ([indexPath row] % 2) 
    cell.backgroundColor = [UIColor whiteColor];
else 
    cell.backgroundColor = [UIColor colorWithRed:0/255.0 green:46/255.0 blue:59/255.0 alpha:0.1];

return cell; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:53:01.690

你不能停止调用这些方法。如果您为它们发布代码，我们可以帮助您优化它们。

UITableViews 速度慢的第一个原因是没有重用你的单元格。你在重复使用你的细胞吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T18:51:26.977

您不能这样做，这是 tableview 的正常行为，但是您应该提高这些功能的性能，例如，如果您确实从远程源加载图像，请考虑使用延迟加载技术

# jquery - jQuery - 如何消除跨域限制

> ID：11299438
> 
> 赞同：12
> 
> 时间：2012-07-02T18:48:55.060
> 
> 标签：jquery, json, cross-domain

我正在开发一个移动网络应用程序，jsonp 对于跨域请求非常酷，但是服务器的 API 不支持回调参数。所以我只能使用 json 从远程服务器获取数据。

我在 jQuery 中尝试了 json，似乎它不支持跨域请求。我在 safari 上尝试了 raw ajax 请求功能，它在跨域上运行良好，那么我可以消除 jQuery 中对 json 请求的跨域限制吗？（不是jsonp，只有json），怎么做？

或者是否有任何替代的简单 ajax 库（跨网络浏览器）并且可以对跨域请求执行 json。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-07-02T19:00:49.547

**同源政策**

您正试图规避[Same Origin Policy](http://en.wikipedia.org/wiki/Same_origin_policy)。它内置于每个浏览器中，通常不是您可以或不应该想要禁用/解决方法/等的东西。它是您的站点、用户和用户浏览器之间非常重要的安全契约。

**CORS（可能）**

[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)允许您的 Web 服务器告诉浏览器/客户端访问另一个域是允许的。这是通过您的 Web 服务器输出以下 HTTP 标头来完成的

```
 Access-Control-Allow-Origin: http://www.example.com 
```

如果你不能控制你的 HTTP 标头，那么你就不能使用 CORS。实现这一点是特定于语言/框架的。

请注意，您应该检查以确保[浏览器兼容性](http://caniuse.com/cors)，因为 IE8/9 支持有限。另请注意，这是一个潜在的攻击媒介。如果您不负责任地使用响应数据，它允许来自 3rd 方站点的响应执行 XSS 攻击。

**JSONP（可能）**

[JSONP](http://en.wikipedia.org/wiki/JSONP#How_it_works)是一种在服务器之间传递和获取数据的巧妙方法，它通过动态添加一个属性等于您的页面的`script`标签 。这是在没有 Web 代理（见下文）或小程序（Flash/Java）的情况下完成这一壮举的唯一合法方式。但是，如果您不是请求两端的提供者，它确实有其自身的安全风险。请记住，JSONP 允许远程服务器在您的上下文中执行代码，您应该[非常小心将这种权力授予谁](http://en.wikipedia.org/wiki/JSON#Security_issues)。`src``"yoururl.com?<your parameter data>"`

**“香草”AJAX（不可能）**

如果您没有使用 JSONP 来获取数据，那么您很可能会尝试使用 AJAX 请求来获取数据。AJAX 请求也受同源策略的约束。JavaScript 库（例如 jQuery、Prototype、Dojo 等）无法绕过此策略作为 Ajax 请求的基本行为。但是，它们可以支持 JSONP（现在记住，它不是 AJAX）。

**带 Web 代理的 AJAX（可能）**

如果您确实想从另一台服务器请求数据，您可以转发您的请求。您的主站点的服务器将充当代理。您需要向您自己的服务器发出 AJAX 请求，然后该服务器端代码将向另一个域发出请求，然后通过 AJAX 调用响应将响应发送到您的脚本。

这是一种常见的模式，在这里详细描述为[Web 代理模式](http://ajaxpatterns.org/archive/Cross-Domain_Proxy.php)和对界面友好的 Yahoo模式[（但请记住，它是 Yahoo 特定的，只接受一般概念）](http://developer.yahoo.com/javascript/howto-proxy.html)。但是，它取决于服务器端语言。整体实现将是相同的，但是执行此操作的代码将根据您选择的服务器端语言（PHP、Ruby、Python、C 等）而有所不同。一些语言已经有库/模块/等来支持这种模式。

**Flash（可能，非默认）**

默认状态下的 Flash 不支持跨域请求。它可以在 Flash7+ 中使用[跨域策略文件](http://kb2.adobe.com/cps/142/tn_14213.html#main_main_policy)打开，但强烈建议不要。您的脚本必须与 Flash API 交互，以便发出请求并将数据返回到您的 JavaScript。

**Java Applet（可能，非默认）**

Java 也受制于同源策略，但与 Flash 有类似的工作[，如其发布中所述](http://www.oracle.com/technetwork/java/javase/plugin2-142482.html#CROSSDOMAINXML)。

**其他各种“黑客”**

那里还有其他黑客，但它们通常要求您控制两端或有一个商定的通信标准。例如'window.name' hack。我不建议大多数这些方法。

**其他解决方案**

另一个类似的问题被问到了。它概述了我没有介绍的其他一些方法：[绕过同源策略的方法](https://stackoverflow.com/questions/3076414/ways-to-circumvent-the-same-origin-policy)

**最佳解决方案**

1.  CORS - 如果您信任第 3 方
2.  网络代理——如果你不这样做

您自己域上的网络代理可以让您清理正在检索的数据，它为您的用户提供最大的保护。但是，如果您进行零卫生，它并不比此处概述的任何方法更安全。如果您确实实施了某种网络代理，请确保其请求仅限于您希望的站点。否则，您实际上将创建一个[开放代理](http://en.wikipedia.org/wiki/Open_proxy)，如果发现它可能会被用户滥用并使您陷入法律麻烦。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-23T02:17:24.100

我遇到过同样的问题。试图从服务器获取 json 到我无法访问的地方（=> 没有 JSONP）。

我找到[http://benalman.com/projects/php-simple-proxy/](http://benalman.com/projects/php-simple-proxy/)将 php 代理添加到您的服务器并对这个文件进行 ajax 调用。“任何要传递到远程 URL 资源的 GET 参数都必须在此参数中进行 urlencoded。”

```
$.ajax({
   type: 'GET',
   url:'proxy.php?url=http://anyDomain.com?someid=thispage',
   dataType: "json",
   success: function(data){
      // success_fn(data);
   },
   error: function(jqXHR, textStatus, errorThrown) {
      // error_fn(jqXHR, textStatus, errorThrown);
   }
}); 
```

proxy.php（来自 Ben Alman 的文件）托管在您的域中

* * *

替代方案（我发现这是第二好的）：http: [//james.padolsey.com/javascript/cross-domain-requests-with-jquery/](http://james.padolsey.com/javascript/cross-domain-requests-with-jquery/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-02T19:05:53.087

一种相当俗气的做法是我在下面所做的，以在个人项目上启用跨站点执行

请注意，这将在接收服务器而不是发送服务器上完成

```
 if ((isset($_SERVER['HTTP_X_REQUESTED_WITH']) && strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) == 'xmlhttprequest') === FALSE)
        die('You shouldn\'t be here');

    header('Access-Control-Allow-Origin: ' . $_SERVER['HTTP_ORIGIN']);
    header('Access-Control-Allow-Methods: POST, GET, OPTIONS');
    header('Access-Control-Max-Age: 1000');
    header('Access-Control-Allow-Headers: Content-Type'); 
```

如果你想让它更安全一点，你可以这样做

```
 if ((isset($_SERVER['HTTP_X_REQUESTED_WITH']) && strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) == 'xmlhttprequest') === FALSE)
        die('You shouldn\'t be here');

switch($_SERVER['HTTP_ORIGIN']){
case 'domain.com':
case 'whatever.com':
        header('Access-Control-Allow-Origin: ' . $_SERVER['HTTP_ORIGIN']);
        header('Access-Control-Allow-Methods: POST, GET, OPTIONS');
        header('Access-Control-Max-Age: 1000');
        header('Access-Control-Allow-Headers: Content-Type');
} 
```

希望这会有所帮助，我花了很长时间才弄清楚哈哈。

# android - onBackPressed 杀死活动中的处理程序 - Android

> ID：11299440
> 
> 赞同：15
> 
> 时间：2012-07-02T18:48:59.483
> 
> 标签：android, handler, android-activity

如您所见，我有这个 PlayLesson_01 活动，它同时显示图像和音频。此活动有两个处理程序，一个用于控制图像和音频，而另一个将完成课程并返回上一个活动（课程菜单）。

**目标**：单击硬后退按钮返回上一个活动并停止播放图像和音频。

**问题**：当我单击硬“返回”时，我能够返回到上一个活动，但音频仍在播放。我无法**停止**或**终止**在活动中启动的处理程序。

**问题**：我怎样才能完全杀死或停止这些处理程序？

```
import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.media.MediaPlayer;
import android.media.MediaPlayer.OnCompletionListener;
import android.os.Bundle;
import android.os.Handler;
import android.os.Looper;
import android.view.View;
import android.view.ViewGroup;
import android.view.Window;
import android.view.animation.AnimationUtils;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemSelectedListener;
import android.widget.BaseAdapter;
import android.widget.Gallery;
import android.widget.ImageSwitcher;
import android.widget.ImageView;
import android.widget.RelativeLayout.LayoutParams;
import android.widget.ViewSwitcher.ViewFactory;

public class PlayLesson_01 extends Activity implements OnItemSelectedListener,
    ViewFactory, Runnable {

// Setting up images
// Keeping all Images in array references to our images
public Integer[] mThumbIds = { R.drawable.nouraniyah,
        R.drawable.back_angle, R.drawable.back_fox, R.drawable.back_apple,
        R.drawable.back_twitter, R.drawable.back_thunderbird };
// setting up music
int[] myMusic = { R.raw.button_3, R.raw.button_3, R.raw.button_3,
        R.raw.button_3, R.raw.button_3, R.raw.button_3 };
int mNext;
private ImageSwitcher mSwitcher;
MediaPlayer mp;
Handler mHandlerWholeLesson = new Handler();
Runnable mRunnableWholelesson = new Runnable() {

    @Override
    public void run() {
        // TODO Auto-generated method stub
        startActivity(new Intent("com.example.AmazingGame.LESSONONE"));
    }
};

Handler mHandlerNextfile = new Handler();
Runnable mRunnableNextFile = new Runnable() {

    @Override
    public void run() {
        // TODO Auto-generated method stub
        mp.setOnCompletionListener(mListener);
        mp.start();
    }

};

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    setContentView(R.layout.image_switcher); // it could be lesson one
                                                // layout.

    mSwitcher = (ImageSwitcher) findViewById(R.id.imgswitcher);
    mSwitcher.setFactory(this);
    mSwitcher.setInAnimation(AnimationUtils.loadAnimation(this,
            android.R.anim.fade_in));
    mSwitcher.setOutAnimation(AnimationUtils.loadAnimation(this,
            android.R.anim.fade_out));

    Gallery g = (Gallery) findViewById(R.id.gallery);
    g.setAdapter(new ImageAdapter(this));
    g.setOnItemSelectedListener(this);
    // usual onCreate stuff here, then...
    // either here or whenever you want to start the sequence
    mNext = 0;
    startNextFile();

    // Is this good !! Yes it is. count the time for all audio.
    mHandlerWholeLesson.postDelayed(mRunnableWholelesson, 25000);

}

@Override
public void onBackPressed() {
    super.onBackPressed();
    startActivity(new Intent("com.example.AmazingGame.LESSONONE"));
    System.exit(0);
    mHandlerNextfile
            .removeCallbacks(mRunnableNextFile, PlayLesson_01.class);
    mHandlerWholeLesson.removeCallbacks(mRunnableWholelesson,
            PlayLesson_01.class);

    PlayLesson_01.this.finish();
}

@Override
protected void onDestroy() {
    // TODO Auto-generated method stub
    super.onDestroy();
    // mHandlerNextFile.removeCallbacksAndMesssages(PlayLesson_01.class);
}

public void onItemSelected(AdapterView<?> parent, View v,
        final int position, long id) {

}

@Override
public void onNothingSelected(AdapterView<?> arg0) {
    // TODO Auto-generated method stub

}

@Override
public View makeView() {
    ImageView i = new ImageView(this);
    i.setBackgroundColor(0xFF000000);
    i.setScaleType(ImageView.ScaleType.FIT_CENTER);
    i.setLayoutParams(new ImageSwitcher.LayoutParams(
            LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT));
    return i;
}

public class ImageAdapter extends BaseAdapter {
    public ImageAdapter(Context c) {
        mContext = c;
    }

    public int getCount() {
        return mThumbIds.length;
    }

    public Object getItem(int position) {
        return position;
    }

    public long getItemId(int position) {
        return position;
    }

    public View getView(int position, View convertView, ViewGroup parent) {
        ImageView i = new ImageView(mContext);

        i.setImageResource(mThumbIds[position]);
        i.setAdjustViewBounds(true);
        i.setLayoutParams(new Gallery.LayoutParams(
                LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
        i.setBackgroundResource(R.drawable.picture_frame);
        return i;
    }

    private Context mContext;

}

OnCompletionListener mListener = new OnCompletionListener() {

    @Override
    public void onCompletion(MediaPlayer mp) {
        mp.release();
        startNextFile();
    }
};

@Override
protected void onPause() {
    // TODO Auto-generated method stub
    super.onPause();
    this.finish();

}

public void startNextFile() {

    if (mNext < myMusic.length) {

        mp = MediaPlayer.create(this, myMusic[mNext]);
        mSwitcher.setImageResource(mThumbIds[mNext++]);
        mHandlerNextfile.postDelayed(mRunnableNextFile, 3000);
    }

}

@Override
public void run() {
    // TODO Auto-generated method stub

} 
```

}

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-07-02T19:09:10.213

现在您的代码中有几个错误的地方：

1.  如果你想回到你以前的活动，你不要重新启动它，`startActivity`因为 android 的默认行为是它维护一堆以前的活动。默认情况下，按下`back`它会返回到上一个活动（除非您使用某些标志启动了子活动。）

2.  你为什么用`System.exit(0);`背压机？您只需调用`finish()`即可完成当前活动。

3.  从处理程序中删除回调的最佳方法是使用 a`null`作为参数。您可以尝试以下代码：

    ```
    mHandlerNextfile.removeCallbacksAndMessages(null);
    mHandlerWholeLesson.removeCallbacksAndMessages(null); 
    ```

    因为这将删除所有回调。检查此链接以了解更多信息：http: [//developer.android.com/reference/android/os/Handler.html#removeCallbacksAndMessages(java.lang.Object)](http://developer.android.com/reference/android/os/Handler.html#removeCallbacksAndMessages(java.lang.Object))

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:13:33.157

您的处理程序没有“运行”，您的媒体播放器是。打个电话就行`mp.stop()`了`onBackPressed()`。

此外，阿伦乔治所说的。

# c# - 如何在 UML 类图中最好地表示 c# .net 事件构造？

> ID：11299442
> 
> 赞同：4
> 
> 时间：2012-07-02T18:49:08.040
> 
> 标签：c#, events, delegates, uml

我正在设计一个实体/组件系统，其中通过事件消息系统解决实体内通信的问题。组件分为两部分，一个在实体中，一个在子系统中的“实体代理”，通过观察者类型系统保持同步。我正在尝试使用事件和委托来实现。

我正在尝试对我的应用程序事件/消息传递系统的结构进行建模，但我遇到了代表问题。现在的方式是一个图表（附加），显示了系统中的委托、eventArgs 和实体，但是它们的关系的性质仅表示为通用关联。我还有第二张图显示了系统的接口。我需要展示这些对象中引发的事件，因为这是系统中最复杂的地方。

我知道我也需要动态协作和时序图，但我正试图弄清楚我需要什么样的事件支持类和多少个不同的事件支持类，以及继承结构会是什么样子。我想给自己一个我知道可以协同工作的消息类型的选择。我想我可以从这些预定义类型中选择一个 EventArgs 派生和一个委托类型，以便在动态图表和组件构建时重用。

我无法弄清楚的主要事情是将事件建模为属性还是操作。我一直在尝试为委托使用关联类，并使用带有事件构造型的 OnSomeEvent() 类型操作。我不喜欢这样，因为事件不是操作。我已经在代码中使用此 On****() 命名约定保护了方法。这种方法并没有真正捕获委托签名、多播行为和观察者模式。

其他人使用什么方法来表达这些复杂且紧密耦合的类？对我来说，图表的重点是记录和更全面地理解系统中的接口。在我的流程的这个阶段，我希望冻结接口并继续实现组件本身。 ![在此处输入图像描述](../Images/8e5a8dd56156113f4b272ceb678d84d2.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T19:05:07.673

我不会在静态类图中包含信令字符，因为信令（这是事件的用途）是一种动态行为。我会照原样接受事件代表（即带有他们的签名），并将它们作为类的普通操作包含在内。我认为这符合对象能够非常恰当地发送事件的想法，并且它指定了事件的种类。

哪些信号在哪里，谁订阅了谁，应该在动态图中建模。

**编辑：**

您是否考虑过添加诸如**<< event >>**或**<< signal >>**之类的刻板印象来对类的属性进行分类？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T19:20:34.750

从静态角度查看模型时，事件和委托被认为是简单的方法。一些工具通过提供构造型或标记来扩展规范，以将您的方法显示为事件/委托并将它们与普通方法区分开来。

另一方面，您的事件和委托参数应建模为类。将时间因素添加到模型中时，事件才有意义，在这种情况下，您可以使用 UML[事件和触发器](http://www.uml-diagrams.org/common-behaviors.html#event)元素（支持[同步和异步](http://pic.dhe.ibm.com/infocenter/rsarthlp/v8/index.jsp?topic=/com.ibm.xtools.sequence.doc/topics/cmsg_v.html)消息传递）。

附带说明一下，UML 是一种半正式语言，它使得诸如两个不相关状态机之间的事件排序之类的事情无法保证，尽管这可以通过使用诸如[MARTE](http://www.omgmarte.org/)之类的 UML 配置文件来定义（我已经很久没有看看它，所以事情可能已经改变了）

# security - OAuth 1.0a，2 条腿：如何安全地存储客户端的凭据（密钥/秘密）？

> ID：11299444
> 
> 赞同：5
> 
> 时间：2012-07-02T18:49:08.337
> 
> 标签：security, api, authentication, oauth, 2-legged

我是否更正了 OAuth 1.0a 凭据需要以明文形式（或以可以作为明文形式检索的方式）存储在服务器上，至少在进行 2 腿身份验证时？假设您使用的是 HTTPS 或其他 TLS，这难道不比使用用户名和加盐+散列密码安全得多吗？有没有办法以一种安全漏洞不需要撤销每一个凭据的方式存储这些凭据？

* * *

更详细地说：我正在实现一个 API，并希望使用 OAuth 1.0a 来保护它。未来可能会有很多不同的 API 客户端，但目前唯一一个不需要敏感的用户数据，所以我计划使用“2-legged” OAuth。

据我了解，这意味着我为每个 API 客户端生成一个使用者密钥和一个共享密钥。在每个 API 请求中，客户端都提供消费者密钥和使用共享密钥生成的签名。秘密本身不是通过网络发送的，我完全理解为什么这比直接发送用户名和密码更好。

但是，据我了解，消费者和提供者都必须明确存储消费者密钥和共享密钥（如果我错了，请纠正我），这似乎是一个重大的安全风险。如果攻击者破坏了包含消费者密钥和共享机密的提供商的数据存储，那么每个 API 客户端都会受到威胁，重新保护系统安全的唯一方法是撤销*每个密钥*。这与密码形成对比，密码（理想情况下）从不以可逆方式存储在服务器上。如果您对密码进行加盐和散列处理，那么攻击者将无法通过破坏您的数据库来侵入任何帐户。

我所做的所有研究似乎只是通过说“像使用任何敏感数据一样保护凭据”来掩盖这个问题，但这似乎很荒谬。确实会发生违规行为，虽然它们可能会暴露敏感数据，但它们不应该让攻击者*冒充*用户，对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-13T08:33:43.240

你是对的。但是，oAuth 允许您代表用户登录，因此目标服务器（您从中访问数据的服务器）需要信任您提供的令牌。

当您是用户键入的密钥的接收者时，密码哈希是很好的（顺便说一句，当 oAuth 向用户显示登录/接受窗口以在之后生成令牌时，实际上会发生这种情况）。这是“明文”部分发生的地方（用户以明文形式输入他的密码）。

你需要有一个等效的机制，以便服务器识别你；oAuth 提供的是提供密码以外的其他内容的能力 - 一种有限的授权表格，用于代表他登录。如果泄漏，则需要使其无效。

您可以以或多或少复杂的方式存储这些秘密，最终您仍然需要向服务器提供“纯文本”版本（但是，该服务器可能会使用散列来存储它以进行检查，因为它只需要验证您以纯文本形式呈现的内容在散列后是否与它们存储的散列相对应）

# c - 这段代码有什么问题？？http://www.spoj.pl/problems/ARRAYSUB/

> ID：11299448
> 
> 赞同：-5
> 
> 时间：2012-07-02T18:49:22.377
> 
> 标签：c

```
#include<stdio.h>
#include<stdlib.h>
typedef struct node
{
    long int n;
    struct node *l,*r;
}node;
typedef node * tree;
tree maknod(long int d)
{
    tree t;
    t=(tree)malloc(sizeof(tree));
    t->n=d;
    t->l=t->r=NULL;
    return t;
}

tree ins(tree t,long int d)
{
    if(t==NULL)
    return maknod(d);
    else if(t->n > d)
    t->l=ins(t->l,d);
    else 
    t->r=ins(t->r,d);
    return t;
}
long int findmax(tree t)
{
    if(t->r==NULL)
    return (t->n);
    findmax(t->r);
}
tree del(tree t,long int d)
{
    if(t!=NULL)
    {
    if(t->n==d)
    {
        if(t->l==NULL && t->r==NULL)
        return NULL;
        if(t->l==NULL)
        return t->r;
        if(t->r==NULL)
        return t->l;
        t->n=findmax(t->l);
        t->l=del(t->l,t->n);
    }
    if(t->n>d)
    t->l=del(t->l,d);
    if(t->n<d)
    t->r=del(t->r,d);
}
return t;
}
long int print(tree t)
{
    if(t->r==NULL)
    return t->n;
    print(t->r);
}
int main()
{
long int num,k,i;
tree t=NULL;
scanf("%ld ",&num);
long int a[num];
for(i=0;i<num;i++)
scanf("%ld",&a[i]);
scanf("%ld",&k);
for(i=0;i<k;i++)
{
    t=ins(t,a[i]);
}
for(i=0;i<=num-k;i++)
{
if(i<num-k)
{
printf("%ld",print(t));
printf(" ");
}
else
printf("%ld",print(t));
t=del(t,a[i]);
ins(t,a[i+k]);
}
return 0;
} 
```

> > [http://ideone.com/ZA3Xb](http://ideone.com/ZA3Xb) 在 spoj 中运行五个测试用例，在第六个测试用例中作为分段错误运行.. 给定 num 不是数组中的元素，那么 a[] 包含 num 个元素.. k 是子数组.. 我们必须在 a[] 中的每个大小为 k 的子数组中打印最大元素。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T18:51:31.767

```
tree t = malloc( sizeof( tree )); 
```

是不正确的。这是混淆 typedef 是一个坏主意的原因之一。一个好的成语是：

```
node *t;
t = malloc( sizeof *t ) 
```

如果你想保留 typedef，你需要类似的东西

t = malloc（sizeof（节点））。

代码中可能还有其他问题...

# c# - 根据 Silverlight 中的对象属性突出显示（选择）DataGridRow

> ID：11299450
> 
> 赞同：1
> 
> 时间：2012-07-02T18:49:42.813
> 
> 标签：c#, silverlight, mvvm, datagrid, esri

对于上下文，我希望复制 ESRI 为地图可视化应用程序实现的 FeatureDataGrid。使用 MVVM，我将地图和数据绑定到一个可观察的数据点集合。每个 DataPoint 都有一个 IsSelected 属性，当您更改数据网格中的关联复选框或单击表示它的地图图形时，该属性会被切换。

我想从数据网格中删除 IsSelected CheckBoxColumn，而是通过简单地在数据网格中选择它来更改 DataPoint 的 IsSelected 属性。

在数据网格中选择某些内容会改变 IsSelected，这应该通过图形颜色/大小的变化自动反映在地图上。相反，在地图中选择对象应该使它们在数据网格中突出显示。

这可能吗？我应该从哪里开始？

以下是一些无效的尝试：

```
 <sdk:DataGrid x:Name="datagrid" HorizontalAlignment="Left" Width="400" ItemsSource="{Binding Path=Data, Mode=TwoWay}">
            <sdk:DataGrid.RowStyle>
                <Style TargetType="sdk:DataGridRow">
                    <Setter Property="IsSelected" Value="{Binding Path=IsSelected, Mode=TwoWay}" />
                </Style>
            </sdk:DataGrid.RowStyle>
        </sdk:DataGrid> 
```

和

```
 <sdk:DataGrid x:Name="datagrid" HorizontalAlignment="Left" Width="400" ItemsSource="{Binding Path=Data, Mode=TwoWay}" SelectedItem="{Binding IsSelected, Mode=TwoWay}"/> 
```

需要明确的是，地图绑定到集合，并不是这个问题的重要部分——**我只是在寻找一种方法将 DataPoint 的 IsSelected 属性绑定到 DataGridRow 的突出显示/选定状态。**

让我知道更多信息是否有用。

**编辑**

我找到了一个我认为违反 MVVM 并添加一些（希望）不必要的逻辑的解决方案。也许对 MVVM 更了解的人可以评论并说服我，或者确认我的倾向：

把它放在后面的代码中：

```
 public MainPage()
    {
        InitializeComponent();
        Messenger.Default.Register<DataPointSelectedMessage>(this, DataPointSelectedChange);
    }

    private void DataPointSelectedChange(DataPointSelectedMessage msg)
    {
        if (datagrid.SelectedItems.Contains(msg.Content))
        {
            datagrid.SelectedItems.Remove(msg.Content);
        }
        else
        {
            datagrid.SelectedItems.Add(msg.Content);
        }
    } 
```

**编辑 2**

我对 Silverlight 还是很陌生。原来 ListBox 默认情况下会执行我正在寻找的行为。以下是遇到此问题的任何人的相关代码：

```
 <ListBox ItemsSource="{Binding Path=Data, Mode=TwoWay}" SelectionMode="Multiple">
            <ListBox.ItemContainerStyle>
                <Style TargetType="ListBoxItem">
                    <Setter Property="IsSelected" Value="{Binding Mode=TwoWay, Path=IsSelected}"/>
                </Style>
            </ListBox.ItemContainerStyle>
        </ListBox> 
```

但是，我仍然有兴趣获得有关使用数据网格实现此功能的输入。我可能最终需要一些数据网格功能。

谢谢。

# c++ - 将 C++ 转换为 python - memcpy uchar 转换为 int64

> ID：11299455
> 
> 赞同：0
> 
> 时间：2012-07-02T18:49:56.617
> 
> 标签：c++, python, int64

好的，我正在复制一些需要在我的服务器（Python）上运行的代码（C++），直到下面的那一点，一切都很顺利。

简而言之，这是我在 C++ 程序中的内容：

```
 int main() {
 ...
 ...
 int64 value = 0;
 bool blah = function1(&value);
 ...
 }

 bool function1(int64* value)
 {
 ...
 uchar pb[8];
 pb = '\x00\x00\x00\x00*Q \x00'; 
 memcpy(value,pb,8);
 //now value has the value '0x7fff33516970'
 } 
```

所以是的，它创建了一些 char 数组，然后将值复制到 int64 中。

现在我的**问题**是：我如何在 Python 中做到这一点？我的意思是，我有相当于 pb 的字节串，但我不知道从那里去哪里（特别是因为所有这些零......）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T18:55:45.353

看一下`struct`模块，尤其是在`struct.unpack`. 你可以做：

`value, = unpack("q", string)`

“q”表示 64 位有符号整数，字符串只是数字的原始字节表示。请记住，注意字节顺序！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T18:59:58.050

Single quotes are used for characters, not strings in C++. Should be `"\x00\x00\x00\x00*Q \x00"`. Besides, the code makes little sense in that memory is allocated for `pb` and then it's overwritten with a constant string.

# c# - 将背景颜色应用于 GridView 中的所有标签

> ID：11299457
> 
> 赞同：3
> 
> 时间：2012-07-02T18:50:23.063
> 
> 标签：c#, asp.net

我有一些代码可以更改 a 中特定标签的背景颜色`GridView`，并且效果很好。

```
protected void HighLight_Hours(Label Quarter)
{
    Int32 Hours;
    Int32.TryParse(Quarter.Text, out Hours);
    switch (Hours)
    {
        case 0:
            Quarter.BackColor = Color.Red;
            break;
        case 1:
            Quarter.BackColor = Color.Yellow;
            break;
        case 2:
            Quarter.BackColor = Color.LightGreen;
            break;
    }
} 
```

但是，不是为我的 Grid 中的每个标签调用我的函数（有很多，一天每 15 分钟一个），有没有办法循环遍历所有内容`GridView`并相应地设置颜色？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T19:10:11.157

尝试这样的事情：

```
protected void gv_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        // read in all controls of a row
        foreach (var control in e.Row.Controls)
        {
            // check if the control is a label
            if (control is Label)
            {
                // call your function and cast the control to a Label
                HighLight_Hours((Label) control);
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T20:04:12.970

这应该这样做：

```
 protected void gv_OnRowDataBound(object sender, GridViewRowEventArgs e)
    {
        if (e.Row.RowType == DataControlRowType.DataRow)
        {

            foreach (DataControlFieldCell dcfc in e.Row.Controls)
            {
                DataControlFieldCell dataControlFieldCell = dcfc;

                foreach(var control in dataControlFieldCell.Controls)
                    if (control is Label)
                        HighLight_Hours((Label) control);

            }
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T19:07:15.223

干得好...

```
foreach (DataGridItem CurrentItem in SomeKindOfDataGrid.Items)
     CurrentItem.BackColor = Color.Red; 
```

安德鲁

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T19:08:55.743

只需遍历以下事件并获得控制权，如下所示：

```
protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
        { 
             foreach (GridViewRow gvr in GridView1.Rows)
                {
                       foreach (Control ctrl in gvr.Controls)   
                     {

                          Label lbl = (Label )e.Row.FindControl("yourlabel");
                          lbl.ForeColor =system.drawing.color.red;

                        }
               }
        } 
```

# android - 在真机上测试

> ID：11299460
> 
> 赞同：-1
> 
> 时间：2012-07-02T18:50:36.040
> 
> 标签：android

如果我使用工作区中项目的 bin 目录中的 .apk 文件，而不是通过导出项目来生成 .apk ，这有什么不同吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:53:04.553

您可以在调试时使用 bin 文件夹中的 apk，但在发布应用程序时，您必须导出已签名的 apk，或者手动从 bin 文件夹中签名。

但是，更简单的方法是直接从 eclipse 中调试硬件设备，因为这使您可以访问各种工具，如 adb 和 LogCat，有关详细信息，请参阅[此](http://developer.android.com/tools/device.html)链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T18:59:20.203

bin 中的 apk 文件是使用调试密钥签名的，这样就失去了为您的 App 签名的好处。您的应用程序应使用您自己的密钥（在您导出项目时指定）进行签名，该密钥唯一地标识您的应用程序并保护（或试图保护）您的应用程序免于有人更改您的应用程序并重新发布它。此外，当您为您的 App 上传更新时，必须使用与原始 App 相同的密钥对其进行签名，因此请务必妥善保管此密钥。

# ruby - 从命令行运行 ruby gem sprockets

> ID：11299465
> 
> 赞同：3
> 
> 时间：2012-07-02T18:51:07.837
> 
> 标签：ruby, command-line, sprockets

我发现很少有关于从命令行运行 sprockets 的文档。

有谁知道如何设置 .sprocketsrc 文件？

示例会很棒，尤其是关于如何配置缩小的示例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T15:35:37.073

如果您直接阅读源代码，您可以在[https://github.com/sstephenson/sprockets/blob/master/bin/sprockets#L8](https://github.com/sstephenson/sprockets/blob/master/bin/sprockets#L8)看到它使用标准 ruby​​ 库附带的名为 Shellwords 的东西：[http:// www.ruby-doc.org/stdlib-1.9.3/libdoc/shellwords/rdoc/Shellwords.html](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/shellwords/rdoc/Shellwords.html)和[http://www.ruby-doc.org/stdlib-1.9.3/libdoc/shellwords/rdoc/Shellwords。 html#method-c-shellsplit](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/shellwords/rdoc/Shellwords.html#method-c-shellsplit)

所以我们可以猜测：

```
 unless ARGV.delete("--noenv")
    if File.exist?(path = "./.sprocketsrc")
      rcflags = Shellwords.split(File.read(path))
      ARGV.unshift(*rcflags)
    end
  end 
```

它基本上会将在 sprocketsrc 中找到的任何内容添加到命令行参数中。

[https://github.com/sstephenson/sprockets/blob/master/bin/sprockets#L22](https://github.com/sstephenson/sprockets/blob/master/bin/sprockets#L22)为我们提供了选项列表，这意味着如果你想配置缩小，你可以创建一个 .sprocketsrc

有类似的东西

```
--include=assets/javascripts --output build/assets/javascripts 
```

可悲的是，命令行看起来没有任何选项来配置缩小选项。

# php - github api v3 - 消息：未在 PHP 中使用 curl

> ID：11299468
> 
> 赞同：1
> 
> 时间：2012-07-02T18:51:20.520
> 
> 标签：php, curl, github, github-api

我正在尝试使用 php 的 curl 访问 github api v3，但是每当我尝试访问用户信息时，我都会收到“消息：未找到”。当我传统上使用 curl 时，它可以正常工作。

我使用的代码：

```
$curl = curl_init();

    curl_setopt($curl, CURLOPT_URL, "https://api.github.com/user?access_token=ACCESSTOKEN");
    curl_setopt($curl, CURLOPT_POSTFIELDS, "");
    curl_setopt($curl, CURLOPT_HEADER, 0);
    curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);  
    curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, 0);

$cont = curl_exec($curl);

    curl_close($curl); 
```

[编辑]：“传统上”是指控制台中的“curl [https://api.github.com/user?access_token=ACCESSTOKEN](https://api.github.com/user?access_token=ACCESSTOKEN) ”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T08:43:08.117

好的，愚蠢的错误，只需要删除带有帖子字段的行。:)

# android - ListView高度android

> ID：11299469
> 
> 赞同：0
> 
> 时间：2012-07-02T18:51:23.740
> 
> 标签：android, listview

我在 FrameLayout 中有一个 FrameLayout 和一个 Listview。我用另一个布局填充 Listview。问题是，如果我将 layout_height 设置为 wrap_content，我的 getview 将被多次调用以获取单个记录，如果我将 layout_height 设置为 fill_parent 或 wrap_content，我的 getview 将被调用 3 次以获取单个记录。如果我将 layout_height 设置为某个 dp 值，它工作正常。我的意思是我的性能没有任何问题，我的 getview 只被调用一次以记录。所以我以编程方式使用

```
Display display = ((WindowManager)getSystemService(Context.WINDOW_SERVICE)).getDefaultDisplay();
int width = display.getWidth(); 
int height = display.getHeight(); 
```

但是，如果我将 Listview 的宽度和高度设置为使用上述代码测量的值，则我的 Listview 的最后一条记录部分不可见。我猜这应该是因为获取到的屏幕高度包括标题栏高度、状态栏高度和通知栏高度。

那么，如果这是问题，有人可以帮我计算可用的屏幕高度吗？那就是屏幕高度-标题栏高度-状态栏高度-通知栏高度？还有什么问题？为什么我的 ListView 中的最后一条记录不完全可见？

XML 文件

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/listview"
android:background="#ffffff"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
>
<ListView android:id="@+id/android:list"
android:background="#ffffff"    
android:layout_weight="1"
android:layout_width="fill_parent"
android:layout_height="300dp"
android:clickable="true"
android:fastScrollEnabled="true"   
android:smoothScrollbar="true"    
/>
</FrameLayout> 
```

然后我在我的 java 代码中将列表视图的 layout_height 和 layout_width 设置为

```
Display display = ((WindowManager)getSystemService(Context.WINDOW_SERVICE)).getDefaultDisplay();
int width = display.getWidth(); 
int height = display.getHeight();
FrameLayout.LayoutParams parameters = new FrameLayout.LayoutParams((int)(width),(int)(height));
ListView listview=(ListView) getListView();
listview.setLayoutParams(parameters ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T06:09:19.087

大家好，感谢您的帮助我更改了我的代码如下，现在它的工作:)

```
Display display = ((WindowManager) getSystemService(Context.WINDOW_SERVICE)).getDefaultDisplay();
DisplayMetrics metrics = new DisplayMetrics();
getWindowManager().getDefaultDisplay().getMetrics(metrics);
int height=0;
int width = display.getWidth(); 
switch (metrics.densityDpi) 
{ 
case DisplayMetrics.DENSITY_HIGH:
height = display.getHeight() - (48*2);
break;
case DisplayMetrics.DENSITY_MEDIUM:
height = display.getHeight() - (32*2);                              
break;
case DisplayMetrics.DENSITY_LOW:
height = display.getHeight() - (24*2);
break;
default:
height = display.getHeight() - (48*2);
}
FrameLayout.LayoutParams parameters = new FrameLayout.LayoutParams((int)(width),(int)(height));
ListView listview=(ListView) getListView();
listview.setLayoutParams(parameters ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-16T15:26:45.783

在java中：

```
DisplayMetrics metrics = new DisplayMetrics();
getWindowManager().getDefaultDisplay().getMetrics(metrics);
int s_width,s_height;
s_width = metrics.widthPixels;
s_height = metrics.heightPixels/3;
TableRow.LayoutParams parameters = new TableRow.LayoutParams(s_width,s_height);
LinearLayout b_list_table=(LinearLayout) findViewById(R.id.b_list_table);
b_list_table.setLayoutParams(parameters); 
```

在 xml 中：

```
<?xml version="1.0" encoding="utf-8"?>
   <RelativeLayout
   xmlns:android="http://schemas.android.com/apk/res/android"
   android:layout_width="fill_parent"
   android:layout_height="fill_parent"
   >

   <LinearLayout
       android:orientation="vertical"
       android:layout_width="fill_parent"
       android:layout_height="wrap_content"
       android:layout_alignParentBottom="false"
       >

       <TableRow
           android:layout_width="match_parent"
           android:layout_height="180dip"
           android:id="@+id/b_list_table"
           >
           <ListView android:id="@+id/list"
               android:layout_width="match_parent"
               android:layout_height="wrap_content"
               android:layout_weight="1"
               android:drawSelectorOnTop="false"/>
       </TableRow>

       <TableRow
           android:layout_width="fill_parent"
           android:layout_height="wrap_content"
           >
           <ListView android:id="@+id/listf"
               android:layout_width="match_parent"
               android:layout_height="wrap_content"

               android:layout_weight="1"
               android:drawSelectorOnTop="false"/>
       </TableRow>

   </LinearLayout> 
```

# wpf - 在堆栈面板中使 TextBlock FIT 以便我可以省略

> ID：11299475
> 
> 赞同：0
> 
> 时间：2012-07-02T18:51:37.937
> 
> 标签：wpf, xaml

如何`TextBlock`调整大小以仅容纳可用空间`StackPanel`？ `StackPanel`限于我的`Grid`布局。我只是说明了问题，但在我的实际项目中它有点复杂，所以理想的解决方案应该很简单:)

```
<Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="200" />
        </Grid.ColumnDefinitions>

        <StackPanel Grid.Column="1" Grid.Row="1" 
            Orientation="Horizontal">
            <Button Content="Test" />
            <TextBlock Text="Test test" />
            <Button Content="Test 2" />
            <TextBlock Width="Auto">
                Some text that I want to trim with ellipse
            </TextBlock>
        </StackPanel>
    </Grid> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T23:24:05.173

你最好做`StackPanel`另一个`Grid`：

```
<Grid> 
    <Grid.RowDefinitions> 
        <RowDefinition Height="1*" />
        <RowDefinition Height="Auto" /> 
    </Grid.RowDefinitions> 
    <Grid.ColumnDefinitions> 
        <ColumnDefinition Width="1*" />
        <ColumnDefinition Width="200" />
    </Grid.ColumnDefinitions> 

    <Grid Grid.Column="1" Grid.Row="1">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="1*"/>
        </Grid.ColumnDefinitions>
        <Button    Grid.Column="0" Content="Test" /> 
        <TextBlock Grid.Column="1" Text="Test test" /> 
        <Button    Grid.Column="2" Content="Test 2" /> 
        <TextBlock Grid.Column="3" Text="Some text that I want to trim with ellipse"/>
    </Grid>
</Grid> 
```

我更改了您的“主”网格，因为它看起来很奇怪，只有一行和一列（从 index=0 开始）并将`StackPanel`to`Grid.Row="1"`和`Grid.Column="1"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T00:39:35.330

正确的答案是使用`DockPanel`而不是`StackPanel`. DockPanel 中的最后一项将调整大小以适应剩余空间，这正是我所需要的。

# javascript - 值限制输入的智能白名单

> ID：11299485
> 
> 赞同：0
> 
> 时间：2012-07-02T18:52:18.963
> 
> 标签：javascript, regex, validation, whitelist

我需要限制输入，以便用户只能输入美元金额。这意味着他们可以输入一串数字，可选地后跟一个小数和 0-2 个数字。没有逗号，没有美元符号。

我发现我认为这是一个很好的模式，但我也希望允许用户使用退格、回车、制表符等。我希望有一种更好的方法来做到这一点，而不是在我的白名单上明确列出每个有效的键码。我希望这`/\W/`能解决问题，但可惜，它匹配了太多的按键。

这是我目前拥有的。

```
 $input.keypress(function(evt) {
    var ch = String.fromCharCode(evt.which);
    var val = evt.target.value + ch;
    var pattern = /^\d+(\.?(\d{1,2})?)$/;
    if (!pattern.test(val)) {
      evt.preventDefault();
    }
  }); 
```

如果有一种智能且简洁的方式允许用户进行更正并使用键盘导航表单，我会很高兴听到它。

如果您有改进上述正则表达式的建议，请随时将其包含在您的答案中（或者如果您没有答案，请将其留在评论中）。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:57:56.973

当我在我的代码中执行此操作时，我不会在按键本身上运行正则表达式，而是在他们正在输入的字段的内容上运行。这样您就不必担心非打印字符。您将需要担心它们会剪切并粘贴到不会触发该按键事件的字段中。

# netty - 服务器无法在第一时间收到所有消息

> ID：11299490
> 
> 赞同：-1
> 
> 时间：2012-07-02T18:52:31.703
> 
> 标签：netty

我开发了一个程序，它有两个部分：一个是客户端：只是发送消息服务器另一部分是服务器：只是接收消息，并将消息保存到地图中。（键是频道ID，值是列表，所有消息发送频道将保存在列表中）我使用这样的代码： `for (int i = 0; i < 20; i++) { client.sendMessage(new Message(i)); }` 如果我第一次运行客户端，服务器的地图中只有 2 条消息，丢失了 18 条消息。如果我再次运行客户端，地图中的所有消息都不会丢失。如果我发送这样的消息： `for (int i = 0; i < 20; i++) { Thread.sleep(50); client.sendMessage(new Message(i)); }` 没有消息丢失。有人打电话告诉我有什么问题吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:23:05.163

在 netty 中写入消息是异步的，因此您的循环可能会在消息实际发送到远程对等体之前完成。确保通过调用例如 Channel.write(..).await..(); 等待所有写入完成；

# php - 通过其 ID 获取帖子 (WordPress)

> ID：11299494
> 
> 赞同：0
> 
> 时间：2012-07-02T18:52:45.927
> 
> 标签：php, wordpress

如何在 wordpress 中通过其 ID 获取自定义帖子并显示其缩略图、标题和内容？这是我正在使用的，但内容没有搞砸。

```
<div class="left-cont1">
        <div class="left-cont1-text">       
            <?php
            query_posts('post_id=790&post_type=homepage');
            while (have_posts()): the_post();
            ?>
            <h1><?php the_title(); ?></h1>
          <div class="cont1-border"></div>
          <p><?php echo(types_render_field("homepage-content", array("raw"=>"true"))); ?></p>
          <h2><a href="<?php the_permalink();?>/more/"><?php echo(types_render_field("homepage-urltitle", array("raw"=>"true"))); ?></a></h2>           
        </div>
        <div class="left-cont1-image1"><?php echo get_the_post_thumbnail($page->ID, 'home-circle'); ?></div>
        <?php endwhile;?>
      </div> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:31:04.750

You should be able to take your current code, change `get_the_post_thumbnail($page->ID, 'home-circle')` to `get_the_post_thumbnail(get_the_id(), 'home-circle')`, and replicate your code for each post you want to pull in, modifying the `post_id=xxx` to match the ID of the post you want to pull in.

This is not the most attractive solution, but from the information you gave, it should at least work. Just so you know, there is an entire StackExchange site devoted to Wordpress: [https://wordpress.stackexchange.com/](https://wordpress.stackexchange.com/) where you should be able to get more Wordpress-specific answers. If your question is about PHP, please feel free to ask here, but if it is Wordpress-specific, your better bet would be the dedicated Wordpress site.

Since you're new to PHP, I would recommend getting an introductory book or two and try to get some of the basic concepts down pat before working with WordPress. While there will be a larger up-front investment of time, it will pay off in the long run. Good luck!

# java - SWT Java：如何将透明度应用于 GUI 组件/控件（例如按钮、sashForm、表格等）

> ID：11299495
> 
> 赞同：1
> 
> 时间：2012-07-02T18:52:46.203
> 
> 标签：java, user-interface, controls, swt, alpha-transparency

我想应用与 shell.setAlpha(240) 相同的效果，但是浏览了几个小时的互联网，仍然没有找到解决方案。

原因：我决定改进应用程序的视觉外观。我将抽象图像应用于外壳背景，它仅在控件周围可见，这在视觉上并不完美。

因此，我想将光透明度应用于某些控件，例如表格，这样会变得更好。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T05:41:21.990

您无需设置透明度即可从 Composite 继承背景。用于`Composite.setBackgroundMode()`设置`SWT.INHERIT_FORCE`。这是一个可以提供帮助的[片段](http://git.eclipse.org/c/platform/eclipse.platform.swt.git/tree/examples/org.eclipse.swt.snippets/src/org/eclipse/swt/snippets/Snippet237.java)

# excel - 用于 2 个不同列的 Excel 过滤器 VB 宏

> ID：11299500
> 
> 赞同：0
> 
> 时间：2012-07-02T18:52:59.697
> 
> 标签：excel, vba, filter

我有 2 列要么为空白，要么显示用户有权访问的数据库。列不相同，因此宏中需要 OR 逻辑，但我无法正确使用语法。这就是我所拥有的 - 切换效果很好，只是无法获得 OR。我真的更愿意让这种方法工作，而不是“高级过滤器”方法。

```
With ActiveSheet
    If .AutoFilterMode = True And .FilterMode = True Then
        .AutoFilterMode = False And .FilterMode = False
    Else
        .AutoFilterMode = True And .FilterMode = True
        ActiveSheet.Range("$E$7:$P$1765").AutoFilter Field:=1, Criteria1:="=DatabaseA", _
        Operator:=xlOr, Field:=7, Criteria2:="=DatabaseA"
    End If
End With 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T02:35:43.727

运行你的代码我明白了

![在此处输入图像描述](../Images/df2a66677275bdc521733dec1294cc16.png)

因此，它似乎按预期创建了一个 OR。我会检查您对 DatabaseA 的定义是否按预期设置。如果您打算将字符串“DatabaseA”作为过滤条件，您可能会删除前面的等号，或者 DatabaseA 是一个变量吗？从您的示例中不清楚是哪种情况

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T14:14:26.323

决定最好的解决方案是将 2 列输出到第 3 列：

```
=IF(K8="DatabaseA","DatabaseA",IF(Q8="DatabaseA","DatabaseA","--")) 
```

并且新列输入到宏中。效果很好。

# raphael - person.translate(x, y) not mapping correctly in Raphael.js

> ID：11299501
> 
> 赞同：0
> 
> 时间：2012-07-02T18:53:00.657
> 
> 标签：raphael

I have a nodejs app which takes the user's ip address and trasposes it onto a raphael map based on the user's lat/lon position.

you can see it here [http://zmgc.net/;maps](http://zmgc.net/;maps) if you open a new tab and access the [http://zmgc.net](http://zmgc.net) home page in the ;maps page you should get a red person svg which is centered.

the weird thing is that the City and 'Users title' are correctly displayed, but the person renders in the middle of the map!

here is the code that draws the person marker:

```
 this.drawMarker = function (message) {
    var latitude = message.latitude,
        longitude = message.longitude,
        text = message.title, //Fixme, this is the user's name
        city = message.city,
        x, y;

    var mapCoords = this.geoCoordsToMapCoords(latitude, longitude);
    x = mapCoords.x;
    y = mapCoords.y;

    var person = self.map.path(personPath);
    person.scale(0.06, 0.06);
    person.translate(-255, -255); // Reset location to 0,0
    person.translate(x, y);
    console.log(x, y);
    person.attr({
      fill: 'red',
      stroke: 'transparent'
    });

    var title = self.map.text(x, y + 11, text);
    title.attr({
      fill: 'red',
      "font-size": 12,
      "font-family": "'Helvetica Neue', 'Helvetica', sans-serif",
      'font-weight': 'bold'
    });
    var subtitle = self.map.text(x, y + 21, city);
    subtitle.attr({
      fill: '#999',
      "font-size": 7,
      "font-family": "'Helvetica Neue', 'Helvetica', sans-serif"
    }); 
```

the full code is [https://github.com/nkhine/phoenix/blob/master/ui/core/js/node/public/client.js](https://github.com/nkhine/phoenix/blob/master/ui/core/js/node/public/client.js)

any advice much appreciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T08:11:00.317

first translate that then scale, because scale() will affect following translates()

so in the code would be:

```
var person = self.map.path(personPath);
person.translate(-255, -255); // Reset location to 0,0
person.translate(x, y);
console.log(x, y);
person.scale(0.06, 0.06);
person.attr({
  fill: 'red',
  stroke: 'transparent'
}); 
```

but the correct correct sollution should be moving the path itself, not transforming its coordinate system. This is explained with an example here: [http://cancerbero.vacau.com/raphaeltut/#sec-types-path-moving](http://cancerbero.vacau.com/raphaeltut/#sec-types-path-moving)

# python - jinja2 或 html textarea 的简单标记

> ID：11299507
> 
> 赞同：1
> 
> 时间：2012-07-02T18:53:28.590
> 
> 标签：python, html, google-app-engine, markup, jinja2

我正在使用 python 和 jinja2 编写一个谷歌应用引擎网络应用程序。是否有一个简单的轻量级文本区域标记，我可以将其用于 jinja2 或通常用于 HTML 文本区域。我只想遇到换行符，斜体和粗体，也许还有一两件事，但我不只是想标记是安全的（而不是自动转义其余部分）。

我很惊讶没有人问过类似的问题，他们可能也问过，所以也许我只是使用了错误的关键字。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:07:29.560

您可以使用[TinyMCE](http://www.tinymce.com/)将标记功能添加到文本区域。您网站的访问者（或管理员，如果您碰巧使用它的话）然后可以以用户友好的方式添加 HTML 标记。

或者，您可以添加允许用户使用基本符号添加标记的[Markdown 解析器（或类似语言）。](http://daringfireball.net/projects/markdown/)您的网站会在显示内容之前对其进行解析和处理。

# c# - 将查询从 SQL 转换为 LINQ

> ID：11299510
> 
> 赞同：0
> 
> 时间：2012-07-02T18:53:39.453
> 
> 标签：c#, sql, linq

我需要将此 SQL 查询转换为 LINQ：

```
SELECT COUNT(result1.Id) AS total, 
    result1.OccurrenceDate, 
    result1.Path, 
    result1.Message, 
    result1.StackTrace 
FROM (SELECT * FROM tbllog ORDER BY OccurrenceDate DESC) AS result1
GROUP BY result1.Path, result1.Message ORDER BY total DESC 
```

但我没有成功。我尝试了很多方法，没有任何效果。一些帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:15:20.560

从以下内容创建一个 linq 查询：

```
SELECT * FROM tbllog ORDER BY OccurrenceDate DESC AS result1
GROUP BY result1.Path, result1.Message ORDER BY total DESC 
```

完成后，编写一些 linq 以获取计数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:24:16.970

```
var results = _dbContext.tbllog
    .GroupBy( t => new { t.Path, t.Message })
    .Select( g => new 
        {
            Total = g.Count(),
            Path = g.Key.Path,
            Message = g.Key.Message
        }).OrderBy(p => p.Total); 
```

值得一提的是，您的 sql 查询是无效的，因为属性`OccurrenceDate`和`StackTrace`不在`GROUP BY`子句中，也不在聚合函数中，因此它是无效查询。与 LINQ 查询相同。您应该确定要对它们做什么。要么将它们包含在 group by 中，要么使用聚合函数为每个组选择适当的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T19:57:07.773

我不知道您的问题的上下文是什么，但是如果您不需要修改查询以便使用其他参数执行，我强烈建议将查询作为 SQL 执行。我知道的所有 ORM（实体框架、NHiberate、LINQ to SQL 等）都支持这一点。

埃里克

# java - 当 firePropertyChange 触发 null 时，Beans 数据绑定不会更新

> ID：11299519
> 
> 赞同：2
> 
> 时间：2012-07-02T18:54:18.690
> 
> 标签：java, swing, data-binding, javabeans

我正在使用 Java Beans

```
 firePropertyChange(String propertyName, Object oldValue,
        Object newValue) 
```

将数据更新传播到我的 Swing GUI。

它适用于所有其他值，但当 newValue 为 null 时，不会发送任何事件。有任何解决这个问题的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T19:44:09.017

实际上，如果以下谓词成立，则*不会触发属性更改：*

```
oldValue != null && newValue != null && oldValue.equals(newValue) 
```

所以你的结果并不意外。从概念上讲，尽量减少虚假更新是有意义的，但也可以区分从未设置的属性和`null`可能无意中设置的属性。如果没有更多上下文，很难提出替代方案，但您可以使用[哨兵值](http://en.wikipedia.org/wiki/Sentinel_value)来表示`null`有意成为的值。

# c# - StreamReader Read 方法不读取指定的字符数

> ID：11299522
> 
> 赞同：3
> 
> 时间：2012-07-02T18:54:25.017
> 
> 标签：c#, streamreader

我必须解析一个大文件，而不是这样做：

```
 string unparsedFile = myStreamReader.ReadToEnd(); // takes 4 seconds
 parse(unparsedFile); // takes another 4 seconds 
```

我想利用前 4 秒，并尝试通过执行以下操作同时做这两件事：

```
 while (true)
        {
            char[] buffer = new char[1024];

            var charsRead = sr.Read(buffer, 0, buffer.Length);

            if (charsRead < 1)
                break;

            if (charsRead != 1024)
            {
                Console.Write("Here");  // debuger stops here several times why?
            }

            addChunkToQueue(buffer); 
        } 
```

这是调试器的图像：（我添加`int counter`以显示我们读取的小于 1024 字节的迭代）

![在此处输入图像描述](../Images/697774f691056e5f041f5f782933e286.png)

请注意，那里读取了 643 个字符而不是 1024。在下一次迭代中，我得到：

![在此处输入图像描述](../Images/b8f13a1af34afa5d4562196f502ef5b3.png)

我认为我应该一直读取 1024 字节，直到我到达最后一次迭代，其中剩余字节小于 1024。

**所以我的问题是** 为什么我会在迭代抛出while循环时读取“随机”数量的字符？

* * *

## 编辑

我不知道我正在处理什么样的流。我执行如下过程：

```
 ProcessStartInfo psi = new ProcessStartInfo("someExe.exe")
        {
            RedirectStandardError = true,
            RedirectStandardOutput = true,
            UseShellExecute = false,
            CreateNoWindow = true,
        };

        // execute command and return ouput of command
        using (var proc = new Process())
        {
            proc.StartInfo = psi;
            proc.Start();                               

            var output = proc.StandardOutput;  //  <------------- this is where I get the strem

            //if (string.IsNullOrEmpty(output))
            //output = proc.StandardError.ReadToEnd();

            return output;
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T18:58:05.700

一方面，您正在阅读*characters*，而不是*bytes*。有很大的不同。

至于为什么它不一定一次读取所有内容：也许没有那么多数据可用，并且`StreamReader`决定给你它所得到的而不是阻塞一段不确定的时间来填充你的缓冲区。它完全有权这样做。

这是来自本地文件还是来自网络？通常本地文件操作比网络下载更有可能填充缓冲区，但无论哪种方式，您都不应该依赖被填充的缓冲区。如果它是一个“文件”（即使用 读取`FileStream`）但它恰好位于网络共享上......好吧，在我的知识中这是一个灰色区域：）它是一个流 - 以这种方式对待它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-02T18:58:41.983

这取决于您正在阅读的实际流。如果这是文件流，我想它不太可能获得“部分”数据。但是，如果您从网络流中读取数据，则必须期望数据以不同长度的块形式出现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-02T18:59:21.173

来自文档：http: [//msdn.microsoft.com/en-us/library/9kstw824](http://msdn.microsoft.com/en-us/library/9kstw824)

> **使用 Read 方法时，使用与流的内部缓冲区大小相同的缓冲区更有效，其中内部缓冲区设置为所需的块大小，并且始终读取小于块大小**。如果在构造流时未指定内部缓冲区的大小，则其默认大小为**4 KB（4096 字节）**。如果在将数据读入缓冲区后操作底层流的位置，则底层流的位置可能与内部缓冲区的位置不匹配。要重置内部缓冲区，请调用 DiscardBufferedData 方法；但是，此方法会降低性能，并且仅在绝对必要时才应调用。

所以对于返回值，文档说：

> 已读取的字符数，如果在 **> 流的末尾并且没有读取数据，则为 0。该数字将小于或等于 count 参数，具体取决于数据在流中是否可用。**

或者，总而言之 - 您的缓冲区和底层缓冲区的大小不同，因此您的缓冲区会被部分填充，因为底层缓冲区尚未被填满。

# bash - 使用期望从 bash 脚本登录 VPN

> ID：11299523
> 
> 赞同：1
> 
> 时间：2012-07-02T18:54:31.313
> 
> 标签：bash, login, expect, openvpn

我使用以下方式从控制台连接到 VPN：

```
sudo openvpn my.conf
[sudo] password for user:
Enter Auth Username:my_user
Enter Auth Password: 
```

我不关心手动输入管理员密码，但我想自动化 vpn 身份验证，我认为期望是我需要做的，但我不知道如何使用它，而且我从未编写过 bash 脚本。

**有人可以向我展示一个使用 expect 的简单 bash 脚本，以便我可以使用它吗？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T19:16:47.917

类似的东西（未经测试）

```
#!/bin/usr/expect -f
spawn sudo openvpn my.conf
expect -r "\[sudo\] .*\: " {
    send "my_ownpassword\n"
}
expect "Enter Auth Username:" {
    send "my_user\n"
}
expect "Enter Auth Password:" {
    send "my_vpnpassword\n"
}
interact 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:32:02.030

或者可能是这样的：

```
#!/usr/bin/expect -f  

# Constants  
set user "my_user"  
set pass "blablabla"  
set sudo_pass "blablabla"  
set timeout -1  

# Options  
match_max 100000  
log_user 0  

# Access to device  
spawn sudo openvpn my.conf
expect "[sudo]*"  
send -- "$sudo_pass\r"  

expect "*?sername:*"  
send -- "$user\r"

expect "*?assword:*"  
send -- "$pass\r"

interact
close 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T23:55:26.940

# !/usr/bin/expect -f

# 信誉度

设置用户“用户名”
设置密码“密码”

生成 openvpn 文件.ovpn

期望 " *?sername:* "
发送 -- "$user\r"

期望 " *?assword:* "
发送 -- "$pass\r"

亲密互动

# twitter - 将 Twitter API 结果限制为发送给所有用户的推文（没有@replies）？

> ID：11299524
> 
> 赞同：0
> 
> 时间：2012-07-02T18:54:32.363
> 
> 标签：twitter

我正在尝试找到一种方法来向所有用户发送推文。JSON 代码将这些指示为“to_user”空值。例如下面的推文 edent 向所有人发送推文，因此 to_user=null。
我尝试了一些替代方案但没有成功：

```
http://search.twitter.com/search.json?q=to:null%20from:edent&result_type=mixed
http://search.twitter.com/search.json?q=to:0%20from:edent&result_type=mixed
http://search.twitter.com/search.json?q=to:%20from:edent&result_type=mixed

{
        "created_at": "Thu, 28 Jun 2012 06:55:58 +0000",
        "from_user": "edent",
        "from_user_id": 14054507,
        "from_user_id_str": "14054507",
        "from_user_name": "Terence Eden",
        "geo": null,
        "id": 218236278402068480,
        "id_str": "218236278402068480",
        "iso_language_code": "en",
        "metadata": {
            "result_type": "recent"
        },
        "profile_image_url": "http://a0.twimg.com/profile_images/2318692719/7182974111_ec8e1fb46f_s_normal.jpg",
        "profile_image_url_https": "https://si0.twimg.com/profile_images/2318692719/7182974111_ec8e1fb46f_s_normal.jpg",
        "source": "&lt;a href=&quot;http://twitter.com/&quot;&gt;web&lt;/a&gt;",
        "text": "RT @straczynski: @edent Clearly the man was ahead of his time.",
        "to_user": null,
        "to_user_id": 0,
        "to_user_id_str": "0",
        "to_user_name": null,
        "in_reply_to_status_id": 218075066452287500,
        "in_reply_to_status_id_str": "218075066452287488"
    }, 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T22:19:47.490

如果您只是想从特定用户那里获取不属于任何人的推文，请使用[/get/statuses/user_timeline](https://dev.twitter.com/docs/api/1/get/statuses/user_timeline) REST API 端点而不是搜索 API。/get/statuses/user_timeline 有一个 exclude_replies 参数，应该可以满足您的需求。

搜索 API 无法排除回复。您唯一的选择是获取与您传递的任何其他参数匹配的推文，并在您的最后处理它们以删除任何文本以“@”开头的任何内容。

# c++ - 为什么 Visual Studio 2010 给我这段代码的语法错误？

> ID：11299527
> 
> 赞同：0
> 
> 时间：2012-07-02T18:54:49.517
> 
> 标签：c++, visual-studio-2010, visual-c++

```
template<typename T>
class nodAB : public arbBinar<T> 
{
private:
    T info;
    nodAB<T> *tata;
    nodAB<T> *st;
    nodAB<T> *dr;

public:
    nodAB(const T& x):info(x),tata(0),st(0),dr(0){};
    nodAB(const T& x, nodAB<T> *t):info(x),tata(t),st(0),dr(0){};

    virtual nodAB<T>* copiaza();
    virtual nodAB<T>*insereaza (T& item);
    virtual void parcurge_invers();
    void setInfo(T& x) {info =x;}
    void setTata(nodAB<T> *t) {tata=t;}
    void setStang(nodAB<T> *stang) {st=stang;}
    void setDrept(nodAB<T> *drept) {dr=drept;}

    T getInfo() const {return info;}
    nodAB<T> *getStang() const {return st;}
    nodAB<T> *getDrept() const {return dr;}
    nodAB<T> *getTata() const {return tata;}

    bool esteRadacina()const
    {
        return tata==NULL;
    }
    bool esteFrunza()const
    {
        return (st==NULL &&  dr==NULL);
    }
    bool esteFiuStang()const
    {
        return tata!=NULL  && tata->getStang()==this;
    }
    bool esteFiuDrept()const
    {
        return tata!=NULL && tata->getDrept()==this;
    }
    ~nodAB();
}; 
```

我的问题是为什么`class nodAB: public arbBinar<T> {`Visual Studio 会给我一个语法错误？

```
template<typename T>
class arbBinar{
protected:
    nodAB<T> *radacina;

public:
    arbBinar():radacina(0){}
    arbBinar(nodAB<T> *rad) {radacina=rad;}
    nodAB<T> *getRadacina(){return radacina;}
    ~arbBinar();
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T19:02:10.647

我看到你们的课程以循环方式相互引用。这表明至少需要一个模板类的前向声明。更准确地说，在`nodAB<T>`模板定义之前需要模板的前向声明`arbBinar`。

```
template<typename T> class nodAB; 
```

你做了那个前瞻声明吗？

此外，如果这些类在不同的头文件中声明，您可能会遇到循环头包含的问题。向我们展示这些声明是如何跨文件分布的，以及如何将这些文件相互包含。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:01:00.170

确保`arbBinar`在之前声明`nodAB`。

# java - 使用 ANTLR 正确检测空格

> ID：11299528
> 
> 赞同：0
> 
> 时间：2012-07-02T18:55:03.420
> 
> 标签：java, parsing, antlr, whitespace, grammar

我正在使用 ANTLR3，通过 Maven repo1 提供的运行时。

这是我的语法：

```
grammar MiniJavax;

goal    :   mainClass EOF;

mainClass 
    :    'class' IDENTIFIER '{' methodDeclarations 'public' 'static' 'void' 'main' '(' ')'
    '{' varDeclarations statements '}' '}';

varDeclarations
    :   varDeclaration varDeclarations | ;

varDeclaration
    :   type IDENTIFIER ';' ;

methodDeclarations
    :   methodDeclaration methodDeclarations | ;

methodDeclaration
    :   'public' 'static' type IDENTIFIER '(' parameters ')' '{' varDeclarations statements
        'return' genExpression ';' '}'
    ;

parameters
    :   type IDENTIFIER parameter | ;

parameter 
    :   ',' type IDENTIFIER parameter | ;

type    :   'int' | 'boolean';

statements
    :   statement statements | ;

statement
    :   '{' statements '}'
    |   'if' '(' genExpression ')' statement 'else' statement
    |   'while' '(' genExpression ')' statement
    |   'System' '.' 'out' '.' 'println' '(' genExpression ')' ';'
    |   IDENTIFIER '=' genExpression ';';

genExpression
    :   expression genExpressionRest;

genExpressionRest
    :   relExpression | ;

expression
    :   term expressionRest;

expressionRest
    :   '+' term expressionRest | '-' term expressionRest | ;

term
    :   factor termRest;

termRest 
    :   '*' factor termRest | ;

factor
    :   '(' expression ')'
    |   IDENTIFIER
    |   IDENTIFIER '(' arguments ')'
    |   'true'
    |   'false'
    |   INTEGER;

relExpression
    :   '==' expression relExpressionRest | '<' expression relExpressionRest;

relExpressionRest
    :   '&&' relTerm relExpressionRest |;

relTerm
    :   '==' expression
    |   '<' expression;

arguments
    :   genExpression argument | ;

argument
    :   ',' genExpression argument | ;

IDENTIFIER  :   ('a'..'z'|'A'..'Z'|'_') ('a'..'z'|'A'..'Z'|'0'..'9'|'_')*
    ;

INTEGER :   '0'..'9'+
    ;

WHITESPACE : ( '\t' | ' ' | '\r' | '\n'| '\u000C' )+    { $channel = HIDDEN; } ; 
```

如您所见，我为词法分析器指定了空白字符，并通过 HIDDEN 通道将其隐藏到解析器中。

但是，当我尝试解析这个时：

```
class PrintNumbers {
    public static void main() {
        int number;
        number = 1;
        while (number < 11) {
            System.out.println(number);
            number = number + 1;
        }
    }
} 
```

我得到：

```
line 1:5 extraneous input ' ' expecting IDENTIFIER 
```

我在这里做错了什么？这不应该能够解决我的问题吗？

顺便说一句，如果有任何改变，我将使用 ANTLRWorks 生成代码。

**更新**：为了避免混淆，我已经包含了我的整个语法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T05:57:13.767

碰巧我使用的是 a`BufferedTokenStream`而不是通常的`CommonTokenStream`. 这就是为什么 channel 指令在这里被忽略的原因。

# c++ - C ++中的互联网套接字

> ID：11299530
> 
> 赞同：1
> 
> 时间：2012-07-02T18:55:14.600
> 
> 标签：c++, sockets, client-server, data-transfer

我想了解更多关于通过互联网发送数据的信息。我一直在到处搜索，但没有任何帮助...我正在使用 MinGw，请不要说我必须更改我的开发人员程序。到目前为止，我根据我的发现做了这个：它工作得很好，但只适用于我的本地网络。谁能告诉我如何只能通过互联网做同样的事情？

```
using namespace std;
#pragma once
#include <iostream>
#include "WinSock2.h"
const int STRLEN = 256;

class Socket
{
    protected:
        WSADATA wsaData;
        SOCKET mySocket;
        SOCKET myBackup;
        SOCKET acceptSocket;
        sockaddr_in myAddress;
    public:
        Socket();
        ~Socket();
        bool SendData( char* );
        bool RecvData( char*, int );
        void CloseConnection();
        void GetAndSendMessage();
};

class ServerSocket : public Socket
{
    public:
        void Listen();
        void Bind( int port );
        void StartHosting( int port );
};

class ClientSocket : public Socket
{
    public:
        void ConnectToServer( const char *ipAddress, int port );
};

Socket::Socket()
{
    if( WSAStartup( MAKEWORD(2, 2), &wsaData ) != NO_ERROR )
    {
        cerr<<"Socket Initialization: Error with WSAStartup\n";
        system("pause");
        WSACleanup();
        exit(10);
    }

    //Create a socket
    mySocket = socket( AF_INET, SOCK_STREAM, IPPROTO_TCP );

    if ( mySocket == INVALID_SOCKET )
    {
        cerr<<"Socket Initialization: Error creating socket"<<endl;
        system("pause");
        WSACleanup();
        exit(11);
    }

    myBackup = mySocket;
}

Socket::~Socket()
{
    WSACleanup();
}

bool Socket::SendData( char *buffer )
{
    send( mySocket, buffer, strlen( buffer ), 0 );
    return true;
}

bool Socket::RecvData( char *buffer, int size )
{
    int i = recv( mySocket, buffer, size, 0 );
    buffer[i] = '\0';
    return true;
}

void Socket::CloseConnection()
{
    //cout<<"CLOSE CONNECTION"<<endl;
    closesocket( mySocket );
    mySocket = myBackup;
}

void Socket::GetAndSendMessage()
{
    char message[STRLEN];
    cin.ignore();//without this, it gets the return char from the last cin and ignores the following one!
    cout<<"Send > ";
    cin.get( message, STRLEN );
    SendData( message );
}

void ServerSocket::StartHosting( int port )
{
     Bind( port );
     Listen();
}

void ServerSocket::Listen()
{
    //cout<<"LISTEN FOR CLIENT..."<<endl;

    if ( listen ( mySocket, 1 ) == SOCKET_ERROR )
    {
        cerr<<"ServerSocket: Error listening on socket\n";
        system("pause");
        WSACleanup();
        exit(15);
    }

    //cout<<"ACCEPT CONNECTION..."<<endl;

    acceptSocket = accept( myBackup, NULL, NULL );
    while ( acceptSocket == SOCKET_ERROR )
    {
        acceptSocket = accept( myBackup, NULL, NULL );
    }
    mySocket = acceptSocket;
}

void ServerSocket::Bind( int port )
{
    myAddress.sin_family = AF_INET;
    myAddress.sin_addr.s_addr = inet_addr( "0.0.0.0" );
    myAddress.sin_port = htons( port );

    //cout<<"BIND TO PORT "<<port<<endl;

    if ( bind ( mySocket, (SOCKADDR*) &myAddress, sizeof( myAddress) ) == SOCKET_ERROR )
    {
        cerr<<"ServerSocket: Failed to connect\n";
        system("pause");
        WSACleanup();
        exit(14);
    }
}

void ClientSocket::ConnectToServer( const char *ipAddress, int port )
{
    myAddress.sin_family = AF_INET;
    myAddress.sin_addr.s_addr = inet_addr( ipAddress );
    myAddress.sin_port = htons( port );

    //cout<<"CONNECTED"<<endl;

    if ( connect( mySocket, (SOCKADDR*) &myAddress, sizeof( myAddress ) ) == SOCKET_ERROR )
    {
        cerr<<"ClientSocket: Failed to connect\n";
        system("pause");
        WSACleanup();
        exit(13);
    } 
}

int main()
{
    int choice;
    int port = 666;
    //char *ipAddress = "127.0.0.1";
    string ipAddress;
    bool done = false;
    char recMessage[STRLEN];
    char sendMessage[STRLEN];
    cout<<"1) Host server"<<endl;
    cout<<"2) Join server"<<endl;
    cout<<"3) Quit"<<endl;
    cin>>choice;
    if ( choice == 3 )
        exit(0);
    else if ( choice == 2 )
    {
        //Client
        cout<<"Enter an IP address, 127.0.0.1 is the loopback address"<<endl;
        cin>>ipAddress;
        ClientSocket sockClient;
        cout<<"ATTEMPTING TO CONNECT..."<<endl;
        sockClient.ConnectToServer( ipAddress.c_str(), port );
        //Connected
        while ( !done )
        {     
            sockClient.GetAndSendMessage();
            cout<<"\t--WAIT--"<<endl;
            sockClient.RecvData( recMessage, STRLEN );
            cout<<"Recv > "<<recMessage<<endl;
            if ( strcmp( recMessage, "end" ) == 0 ||
                        strcmp( sendMessage, "end" ) == 0 )
            {
                done = true;
            }
        }
        sockClient.CloseConnection();
    }
    else if ( choice == 1 )
    {
        //SERVER
        ServerSocket sockServer;
        cout<<"HOSTING..."<<endl;
        sockServer.StartHosting( port );
        //sockServer.StartHosting( port );
        //Connected
        while ( !done )
        {
            cout<<"\t--WAIT--"<<endl;
            sockServer.RecvData( recMessage, STRLEN );
            cout<<"Recv > "<<recMessage<<endl;
            sockServer.GetAndSendMessage();
            if ( strcmp( recMessage, "end" ) == 0 || strcmp( sendMessage, "end" ) == 0 )
            {
                done = true;
            }
        }
    }
} 
```

感谢所有回复的人，但是当我问应该更改代码的哪一部分以便我可以使用互联网时，您给了我很多阅读。显然我无法理解那里写的一半。仍然没有任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T19:10:36.380

如果您想在 Internet 上使用套接字，并且您希望您的应用程序可以在包括 NAT 在内的每个网络设置上使用，您将不得不使用称为技术的 TCP Holepunch（或者 UDP 打孔也可能适用）。我认为您的方法不起作用，因为您的端点之间存在一些 NAT，因此套接字连接失败。

我建议对 NAT 进行调查。[跨网络地址转换器的对等通信](http://usenix.org/publications/library/proceedings/usenix05/tech/general/full_papers/ford/ford.pdf)

[这个讨论在](https://stackoverflow.com/questions/2443471/c-sharp-tcp-hole-punch-nat-traversal-library-or-something)这里

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:11:26.733

托管从 Internet 可见的服务的能力在很大程度上取决于您拥有的 Internet 连接的类型。如果您在 NAT 后面，则需要设置 NAT 端口转发。如果您的 IP 地址是动态的，您需要知道您的公开 IP 地址（尝试[http://www.whatismyip.com/](http://www.whatismyip.com/)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T19:03:18.207

你有什么不明白的？我看到了代码，它绑定到本地套接字，然后你用客户端连接到它。您也可以通过 Internet 执行此操作，但是您不了解该过程的哪些内容？恐怕在尝试编写套接字代码之前，您可能需要开始学习 TCP/IP 的基础知识。这就像试图通过建造航天飞机开始学习工程学。

# tsql - T-SQL查询，一个字段中有多个值

> ID：11299535
> 
> 赞同：1
> 
> 时间：2012-07-02T18:55:42.160
> 
> 标签：tsql

我在数据库中有两个表。第一个表`tblTracker`包含许多列，但调用了特别感兴趣的列，并且该列中的`siteAdmin`每一行可以包含多个 5 位的 loginID`21457, 21456`或仅一个 like `21444`。下一个表`users`包含`LoginID`、`fname`和等列`lname`。

我希望能够做的是获取包含在用户中的登录 ID 并从用户那里`tblTracker.siteAdmin`返回。当一行`fname + lname`中只有一个时，我可以成功地做到这一点，但是当有多个 like 时，我无法弄清楚如何做到这一点。`loginID``21444``21457, 21456`

这是我在该列中有一个 loginID 时使用的 SQL 语句

```
SELECT b.FName + '' '' + b.LName AS siteAdminName,
FROM tblTracker a
LEFT OUTER JOIN users b ON a.siteAdmin= b.Login_Id 
```

`siteAdmin`但是，当它尝试加入一个以上的 a 时，`LoginID`这不起作用

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T11:50:04.130

[我更喜欢数字表方法来拆分 TSQL 中的字符串](http://www.sommarskog.se/arrays-in-sql-2005.html#tblnum)

要使此方法起作用，您需要执行此一个时间表设置：

```
SELECT TOP 10000 IDENTITY(int,1,1) AS Number
    INTO Numbers
    FROM sys.objects s1
    CROSS JOIN sys.objects s2
ALTER TABLE Numbers ADD CONSTRAINT PK_Numbers PRIMARY KEY CLUSTERED (Number) 
```

设置 Numbers 表后，创建此拆分函数：

```
CREATE FUNCTION [dbo].[FN_ListToTable]
(
     @SplitOn  char(1)      --REQUIRED, the character to split the @List string on
    ,@List     varchar(8000)--REQUIRED, the list to split apart
)
RETURNS TABLE
AS
RETURN 
(

    ----------------
    --SINGLE QUERY-- --this will not return empty rows
    ----------------
    SELECT
        ListValue
        FROM (SELECT
                  LTRIM(RTRIM(SUBSTRING(List2, number+1, CHARINDEX(@SplitOn, List2, number+1)-number - 1))) AS ListValue
                  FROM (
                           SELECT @SplitOn + @List + @SplitOn AS List2
                       ) AS dt
                      INNER JOIN Numbers n ON n.Number < LEN(dt.List2)
                  WHERE SUBSTRING(List2, number, 1) = @SplitOn
             ) dt2
        WHERE ListValue IS NOT NULL AND ListValue!=''

);
GO 
```

您现在可以轻松地将 CSV 字符串拆分为表格并加入表格：

```
select * from dbo.FN_ListToTable(',','1,2,3,,,4,5,6777,,,') 
```

输出：

```
ListValue
-----------------------
1
2
3
4
5
6777

(6 row(s) affected) 
```

您现在可以使用 CROSS APPLY 来拆分表中的每一行，例如：

```
DECLARE @users table (LoginID int, fname varchar(5), lname varchar(5))
INSERT INTO @users VALUES (1, 'Sam', 'Jones')
INSERT INTO @users VALUES (2, 'Don', 'Smith')
INSERT INTO @users VALUES (3, 'Joe', 'Doe')
INSERT INTO @users VALUES (4, 'Tim', 'White')
INSERT INTO @users VALUES (5, 'Matt', 'Davis')
INSERT INTO @users VALUES (15,'Sue', 'Me')

DECLARE @tblTracker  table (RowID int, siteAdmin varchar(50))
INSERT INTO @tblTracker VALUES (1,'1,2,3')
INSERT INTO @tblTracker VALUES (2,'2,3,4')
INSERT INTO @tblTracker VALUES (3,'1,5')
INSERT INTO @tblTracker VALUES (4,'1')
INSERT INTO @tblTracker VALUES (5,'5')
INSERT INTO @tblTracker VALUES (6,'')
INSERT INTO @tblTracker VALUES (7,'8,9,10')
INSERT INTO @tblTracker VALUES (8,'1,15,3,4,5')

SELECT
    t.RowID, u.LoginID, u.fname+' '+u.lname AS YourAdmin
    FROM @tblTracker                                     t
        CROSS APPLY dbo.FN_ListToTable(',',t.siteAdmin)  st
        LEFT OUTER JOIN @users                           u ON st.ListValue=u.LoginID --to get all rows even if missing siteAdmin
        --INNER JOIN @users                                u ON st.ListValue=u.LoginID  --to remove rows without any siteAdmin
    ORDER BY t.RowID,u.fname,u.lname 
```

输出：

```
RowID       LoginID     YourAdmin
----------- ----------- -----------
1           2           Don Smith
1           3           Joe Doe
1           1           Sam Jones
2           2           Don Smith
2           3           Joe Doe
2           4           Tim White
3           5           Matt Davis
3           1           Sam Jones
4           1           Sam Jones
5           5           Matt Davis
7           NULL        NULL
7           NULL        NULL
7           NULL        NULL
8           3           Joe Doe
8           5           Matt Davis
8           1           Sam Jones
8           15          Sue Me
8           4           Tim White

(18 row(s) affected) 
```

# html - 通过 Objective-C 将数据插入 HTML

> ID：11299539
> 
> 赞同：0
> 
> 时间：2012-07-02T18:55:47.443
> 
> 标签：html, objective-c, email, hyperlink

我想在objective-c中添加一个热门的html链接到一封电子邮件。我知道，如果我有一个特定的 url，它通常的工作方式将类似于：

```
[composer setMessageBody:[NSString stringWithFormat:@"Example text, 
<a href=\"google.com\">Link Name</a> More example text"]; 
```

但我希望有一个带有自定义生成 url 的热链接作为链接的标题和链接的网站，所以更像是：

```
[composer setMessageBody:[NSString stringWithFormat:@"Example text, 
<a href=%@>%@</a>", self.link, self.link]; 
```

但这让我很崩溃。想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:57:39.453

您没有关闭此语句：

```
[composer setMessageBody:[NSString stringWithFormat:@"Example text, 
<a href=%@>%@</a>", self.link, self.link]; 
```

最后需要另一个右方括号。

另外，您应该将 href 值用引号括起来，当然要转义。

```
\" value \" 
```

# actionscript-3 - 在纯 as3 中模拟 MovieClip

> ID：11299540
> 
> 赞同：1
> 
> 时间：2012-07-02T18:55:49.130
> 
> 标签：actionscript-3, flash, movieclip, prezi

我正在寻找一种制作 Flash 影片剪辑（动画，如使用 Flash Pro CS 创建的动画）的方法，但纯粹是在 as3 中 - 所以我可以将它们导入 Prezi。

我在 Flash Builder 中使用 Flex 项目完成了很多 as3 编程，但我对 MovieClips 的工作原理一无所知。

我已经尝试过扩展一个 MovieClip 类并尝试将动画基于 Timers，但失败了，所以我尝试了 ENTER_FRAME 事件（因为 Flash 动画基于帧 - 所以我想......）。但是这一切都失败了，只显示在构造函数中绘制的图形——没有动画发生。（正如我在第一段中写的那样，我正在测试将 swf 导入 Prezi，在浏览器中打开它可以按预期工作）

有什么办法吗？喜欢听特定的事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T07:09:51.300

试试精灵表。它是 AS3 中动画的最佳解决方案，实现起来也非常简单。对于更改绘图，有 Timer 和 ENTER_FRAME 事件来执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T08:21:27.650

有趣的事情发生了。我想向您展示我正在尝试的示例代码（我已经尝试过使用 ENTER_FRAME 的 Sprite），但它不起作用。偶然我找到了解决办法。看起来您需要在第一帧中绘制一些东西，否则其他帧将不起作用（至少在 Prezi 中）。

所以这里是工作代码：

```
 public class PreziTest extends Sprite{
        private var radius:uint = 10;

        public function PreziTest(){
            addEventListener(Event.ENTER_FRAME, onEnterFrame);

            onEnterFrame(null); // WITHOUT THIS IT WON'T WORK - YOU NEED TO DRAW SOMTHING IN THE FIRST FRAME
        }

        private function onEnterFrame(event:Event):void{
            radius += 10;

            if(radius > 200)
                radius = 10;

            graphics.clear();
            graphics.beginFill(0xff0000);
            graphics.drawCircle(radius, radius, radius);
        }
    } 
```

感谢你的帮助！

# sql - 按名称跨列的 SQL 求和

> ID：11299543
> 
> 赞同：0
> 
> 时间：2012-07-02T18:56:01.870
> 
> 标签：sql, sql-server, sql-server-2008

我有一个包含很多列的表，其中一些列的名称以“EQ”开头。对于单个行，我想对以“EQ”开头的列中的所有值求和，而不是其他值。我知道我可以这样做：

```
select EQ_DOMESTIC + EQ_INTL + EQ_OTHER from myTable where id=1 
```

但是，我有很多列，我想知道是否可以系统地进行操作，而无需输入每列的名称。我是否必须在另一个查询中从系统表中获取列名？

**后续问题：**一些值是空值，这使得总和为空。有什么方法可以避免为总和写出 ISNULL(column,0) 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T19:02:08.127

您可以使用动态 SQL 轻松完成此操作：

```
DECLARE @sql NVARCHAR(MAX) = N'';

SELECT @sql += N'
   + COALESCE(' + QUOTENAME(name) + ', 0)'
FROM sys.columns
  WHERE [object_id] = OBJECT_ID('dbo.MyTable')
  AND name LIKE 'EQ[_]%';

SELECT @sql += N',' + QUOTENAME(name)
  FROM sys.columns
  WHERE [object_id] = OBJECT_ID('dbo.MyTable')
  AND name NOT LIKE 'EQ[_]%';

SELECT @sql = 'SELECT [EQ_SUM] = 0' + @sql
  + ' FROM dbo.MyTable WHERE id = 1;';

PRINT @sql;
-- EXEC sp_executesql @sql; 
```

# php - 在 Nginx 后面的子目录中托管 Wordpress

> ID：11299545
> 
> 赞同：2
> 
> 时间：2012-07-02T18:56:15.257
> 
> 标签：php, wordpress, nginx

我正在尝试在[http://mydomain.com/blogtest](http://mydomain.com/blogtest)上托管 wordpress 安装，并按照[http://wiki.nginx.org/WordPress](http://wiki.nginx.org/WordPress)上的指南进行操作，但是我仍然收到“未指定输入文件”。对于任何请求。

将 Nginx 1.2.1 和 PHP 5.3.6 与 php-fpm 一起使用

这是 Nginx 配置文件：

```
upstream wptest {
  server 127.0.0.1:9000;
}

server {
  listen 80;
  server_name mydomain.com;

  access_log logs/access.log;
  error_log logs/error.log;

  location /blogtest {
    access_log logs/blogtest.access.log;
    error_log logs/blogtest.error.log;

    root /opt/myblogwp;

    index index.php;
    try_files $uri $uri/ /blogtest/index.php;

  }

  location ~ \.php$ {
    include /usr/local/nginx/conf/fastcgi_params;
    fastcgi_split_path_info ^(/blogtest)(/.*)$;
    fastcgi_intercept_errors on;
    fastcgi_pass wptest;
  }
} 
```

这是我的 fastcgi_params 文件：

```
fastcgi_param  QUERY_STRING       $query_string;
fastcgi_param  REQUEST_METHOD     $request_method;
fastcgi_param  CONTENT_TYPE       $content_type;
fastcgi_param  CONTENT_LENGTH     $content_length;

fastcgi_param  SCRIPT_NAME        $fastcgi_script_name;

# Next line added by AdamJT for php-fpm
fastcgi_param  SCRIPT_FILENAME    $document_root$fastcgi_script_name;

#Concrete5 fix by AdamJT
#fastcgi_param  PATH_INFO          $fastcgi_script_name;

fastcgi_param  REQUEST_URI        $request_uri;
fastcgi_param  DOCUMENT_URI       $document_uri;
fastcgi_param  DOCUMENT_ROOT      $document_root;
fastcgi_param  SERVER_PROTOCOL    $server_protocol;

fastcgi_param  GATEWAY_INTERFACE  CGI/1.1;
fastcgi_param  SERVER_SOFTWARE    nginx/$nginx_version;

fastcgi_param  REMOTE_ADDR        $remote_addr;
fastcgi_param  REMOTE_PORT        $remote_port;
fastcgi_param  SERVER_ADDR        $server_addr;
fastcgi_param  SERVER_PORT        $server_port;
fastcgi_param  SERVER_NAME        $server_name;

# PHP only, required if PHP was built with --enable-force-cgi-redirect
fastcgi_param  REDIRECT_STATUS    200; 
```

我还编辑了 /usr/local/php/lib/php.ini 以设置 cgi.fix_pathinfo = 0;

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T19:18:29.160

请记住，这`location /blogtest {}`意味着您的文件将在

```
/opt/myblogwp/blogtest 
```

这是您的 wp 网站的根目录吗？您可能需要使用`alias`而不是`location`. Alias 允许将虚拟目录 /somedir/ 设置为将根目录设置为 /opt/someotherdir/。另外，我不太熟悉`fastcgi_split_path_info`，但似乎那里缺少一些东西。看例子：

```
Here's an example. The script show.php receives as argument the string article/0001\. The following configuration will handle path splitting properly:

location ~ ^.+\.php {
  (...)
  fastcgi_split_path_info ^((?U).+\.php)(/?.+)$;
  fastcgi_param SCRIPT_FILENAME /path/to/php$fastcgi_script_name;
  fastcgi_param PATH_INFO $fastcgi_path_info;
  fastcgi_param PATH_TRANSLATED $document_root$fastcgi_path_info;
  (...)
}
Requesting /show.php/article/0001 sets SCRIPT_FILENAME to /path/to/php/show.php and PATH_INFO to /article/0001. 
```

对于您的示例-我看不到您如何设置真正的 PATH_INFO 和 SCRIPT_FILENAME-您使用的是默认值...我想您必须稍微调整一下这些参数。你得到的错误是`No input file specified`. 这意味着没有 script_filename 被传递给 PHP。因此，您应该跟踪并修复 PATH_INFO 和 SCRIPT_FILENAME，以便最后您应该得到如下内容：

```
/path/to/wpresssite/index.php$fastcgi_script_name 
```

# css - JQuery UI自动完成：自动高度不尊重maxHeight

> ID：11299548
> 
> 赞同：2
> 
> 时间：2012-07-02T18:56:35.997
> 
> 标签：css, jquery-ui

我希望我的 jQuery UI AutoComplete 具有包含可用选项的动态窗口大小，但也具有最大高度，以便当返回大量选项时它不会占用整个页面。

当我有以下内容时，高度是动态的，但 maxHeight 被忽略：

```
 .ui-autocomplete {
    height: auto;
    max-height: 250px;
    overflow-y: auto;
    width:auto;
} 
```

当我有以下内容时，高度不是动态的，但 maxHeight 有效：

```
 .ui-autocomplete {
    height: 250px;
    max-height: 250px;
    overflow-y: auto;
    width:auto;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-25T14:24:20.860

我的代码使用了 TJ 的绝佳示例 ( [http://jsfiddle.net/s6XTu/12/](http://jsfiddle.net/s6XTu/12/.) )。但是，如果您在页面上使用多个自动完成功能，则必须更改脚本中的某些行。您必须使用“自动完成（“小部件”）”作为参考。

```
 $('.ui-autocomplete').css('height', 'auto');
var $input = $(event.target),
    inputTop = $input.offset().top,
    inputHeight = $input.height(),
    autocompleteHeight = $input.autocomplete("widget").height(), // changed
    windowHeight = $(window).height();
if((inputHeight + autocompleteHeight) > (windowHeight - inputTop - inputHeight)) {
    $('.ui-autocomplete').css('height', (windowHeight - inputHeight - inputTop - 20) + 'px');
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-03T00:51:15.963

这里的基本思想是仅在自动完成小部件`height`的`max-height`内容溢出`window`. 您可以使用以下方法检测到这一点：

```
//Reset the height so the true height can be calculated.
$('.ui-autocomplete').css('height', 'auto');

//Get some values needed to determine whether the widget is on
//the screen
var $input = $('#the-id-of-the-input-node'),
    inputTop = $input.offset().top,
    inputHeight = $input.height(),
    autocompleteHeight = $('.ui-autocomplete').height(),
    windowHeight = $(window).height();

//The widget has left the screen if the input's height plus it's offset from the top of
//the screen, plus the height of the autocomplete are greater than the height of the
//window.   
if ((inputHeight + inputTop + autocompleteHeight) > windowHeight) {

    //Set the new height of the autocomplete to the height of the window, minus the
    //height of the input and the offset of the input from the top of the screen.  The
    //20 is simply there to give some spacing between the bottom of the screen and the
    //bottom of the autocomplete widget.
    $('.ui-autocomplete')
        .css('height', (windowHeight - inputHeight - inputTop - 20) + 'px');
} 
```

在 CSS 中，您还需要设置 ，以便在其内容不适合其容器`overflow`时出现滚动条。`ui-autocomplete`

```
.ui-autocomplete { overflow: auto; } 
```

我有一个活生生的例子在这里展示 - [http://jsfiddle.net/s6XTu/12/](http://jsfiddle.net/s6XTu/12/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-13T06:48:59.530

不要放 hiegh 只放 max-height ，它会起作用

```
.ui-autocomplete {
position: absolute;
top: 0;
left: 0;
cursor: default;
max-height: 145px;
overflow-y: auto; 
overflow-x: hidden; 
```

}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-11T10:35:38.813

这个解决方案对我有用。

```
.ui-autocomplete {
        overflow: auto;
        max-height: 150px !important;
    } 
```

检查此图像。 [![在此处输入图像描述](../Images/273350f6946c3fc9a681f783dd125dee.png)](https://i.stack.imgur.com/yEIdC.png) [![在此处输入图像描述](../Images/29254d0a20fdeb5c8c9632b624e8a9be.png)](https://i.stack.imgur.com/Ar6MS.png)

# c++ - 如何在 C++ 中连接到 Oracle？

> ID：11299549
> 
> 赞同：0
> 
> 时间：2012-07-02T18:56:38.553
> 
> 标签：c++, oracle

我尝试使用 C++ 连接到 Oracle，但它给了我一个错误，指出`DBManger.h`未找到。我也尝试过使用`occi.h`，但遇到了相同的错误，即未找到或没有此类目录。

我已经安装了 Oracle 11g，它还包含 OCI 库。

我还找到了 OCI 库所在的特定文件夹。在我的系统中，它们位于 location `E:\app\user\product\11.1.0\db_1\OCI\lib\MSVC\vc8`。

我还设置了从 Oracle home 开始的路径。但是，我的程序仍然无法找到头文件。

任何帮助将不胜感激？我用谷歌搜索了很多，但找到了相同的解决方案，指出找到 OCI 库可用的文件夹。我在下面发布了我用 Visual Studio 2008 编写的代码：

我写了一个非常小的脚本，只包含了头文件。甚至没有完成连接：

```
#include <occi.h> 
#include <iostream>
using namespace oracle::occi;
using namespace std; 

class DataBaseConnectionTest
{
public:
void test()
{
    cout<<"Hello from test"<<'\n';
}
};
void main()
{
DataBaseConnectionTest *dbc=new DataBaseConnectionTest();
dbc->test();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T19:00:41.797

修改您的项目属性，将 E:\app...vc8 目录名称添加到 Addition include 目录中。它在 C++/General 下。无需将其中的每个 \ 加倍。

无论如何，您可能需要对 OCI 库文件进行类似的处理。包含文件只是难题的一半，另一半是 LIB。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T19:34:07.110

您可以将[OTL](http://otl.sourceforge.net/)视为 OCI 的替代方案。然后你的代码可能更便携。多年前我使用它，连接 SqlServer，并且对简洁的设计和原始速度感到惊讶（比 MFC+ODBC... 快得多）。另外，我遇​​到了问题，谢尔盖立即给予了我帮助。

# wpf - 在 WPF 按钮中显示点-点-点进度

> ID：11299550
> 
> 赞同：8
> 
> 时间：2012-07-02T18:56:50.003
> 
> 标签：wpf, button, progress, ellipsis

但是，我发现了很多显示进度条和轮子的示例；我只能找到一个 javascript 示例来显示省略号（点-点-点）来表示进度，因此我想问这个问题。我的应用程序不是很复杂——它只有几个复选框和一个按钮。最近我的团队要求进行增强，并希望保持简单。

用户在配置所需设置后单击一个名为“GO”的按钮。它背后的代码也非常简单——它在点击事件后禁用按钮并调用一个独立的 exe，使用`ProcessStartInfo`它执行三个操作“reconcle”、“post”和“publish”。我使用该`WaitForExist()`方法重新启用按钮。

我的团队要求我在按钮上显示“当前进程”。他们只是希望按钮文本显示 Reconciling。Reconciling.. Reconciling...（定期说，1 秒），然后以类似的方式发布和发布。

很高兴知道实现这一目标的最合适的方法。提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-02T23:15:19.430

最简单的方法是使用`ObjectAnimationUsingKeyFrames`. 在 Content 上设置 TargetProperty 并将`Value`每个设置`DiscreteObjectKeyFrame`为`Reconciling. Reconciling.. Reconciling...`。

`ControlTemplate`带有`ContentPresenter`命名的示例`PART_Content`：

```
<ControlTemplate.Triggers>
    <Trigger Property="IsEnabled" Value="False">
        <Trigger.EnterActions>
            <BeginStoryboard>
                <Storyboard>
                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Content" Storyboard.TargetProperty="Content" Duration="00:00:00.8" RepeatBehavior="Forever">
                        <DiscreteObjectKeyFrame KeyTime="00:00:00.0" Value="Loading"/>
                        <DiscreteObjectKeyFrame KeyTime="00:00:00.2" Value="Loading."/>
                        <DiscreteObjectKeyFrame KeyTime="00:00:00.4" Value="Loading.."/>
                        <DiscreteObjectKeyFrame KeyTime="00:00:00.6" Value="Loading..."/>
                    </ObjectAnimationUsingKeyFrames>
                </Storyboard>
            </BeginStoryboard>
        </Trigger.EnterActions>
    </Trigger>
</ControlTemplate.Triggers> 
```

# html - 需要帮助让 div 填充整个文本和屏幕区域

> ID：11299551
> 
> 赞同：1
> 
> 时间：2012-07-02T18:56:59.720
> 
> 标签：html, screen, transparent, fill

所以，我正在编写我的第一个网站。在谷歌上搜索了几个小时，然后放下代码，但我正在努力完成它，并享受它。但是，我有一个我无法解决的问题。

我试图获得一个默认填充整个页面的 div，但是当文本超过“100%”高度时，它也会扩展。我已经尝试使用两个单独的 div 来完成它，并且它有效。但是，我正在尝试使用半透明的 div，这意味着我不能将两个堆叠在一起，否则它的一部分（“高度：100%”）会变成实心的，而另一部分（div扩展以适应文本）仍然是半透明的。有没有办法让一个 div 从它开始的地方填充页面的其余部分？这样它就可以从 100% 高度的底部填充到文本适合的其余部分？我会使用 margin-top 特性来隔开它，但页面需要有弹性并且能够随着内容增长。对不起，如果这没有意义..它' 我很难在没有例子和能够指出的情况下解释它。哈哈。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:09:22.413

我相信你想在这个例子中使用的 CSS 属性是 min-height。如果你给一个元素一个最小高度，即使内容小于最小高度，它也会以那个值呈现。如果内容大于最小高度，那么它将扩展以适应内容的大小。

# javascript - Fancybox 图片图库

> ID：11299553
> 
> 赞同：1
> 
> 时间：2012-07-02T18:57:08.163
> 
> 标签：javascript, jquery, fancybox, gallery, imagemap

我想要的是一张图片，点击后会打开一个画廊。我正在使用 FancyBox，我想要 Thumbnail Helper（带图像映射）

就像这样： http: [//jsfiddle.net/ffZ7B/343/](http://jsfiddle.net/ffZ7B/343/) 当你点击左边的轮子时，它会打开画廊，但它不会显示缩略图。

我试过这个：http: [//jsfiddle.net/ffZ7B/344/](http://jsfiddle.net/ffZ7B/344/)

有谁知道该怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:37:24.297

这`Thumbnail Helper`是fancybox v2.x 的全新功能，在以前的版本中不存在。您在 jsfiddle 中使用了 fancybox v1.3.4。

如果你想使用`Thumbnail Helper`，你必须升级到[Fancybox v2.x](http://fancyapps.com/fancybox/)，然后使用这个代码：

HTML：

```
<img src="images/imageMap.jpg" usemap="#map" />

<map name="map" id="map">
 <area class="fancybox" href="images/01.jpg" data-fancybox-group="gallery" shape="rect" coords="46,38,201,154" title="01"  />
 <area class="fancybox" href="images/02.jpg" data-fancybox-group="gallery" shape="rect" coords="295,35,388,83" title="02"  />
 <area class="fancybox" href="images/03.jpg" data-fancybox-group="gallery" shape="rect" coords="27,166,134,293" title="03" />
</map> 
```

JS：

```
$(document).ready(function() {
 $("area.fancybox").fancybox({
  helpers: {
   thumbs   : {
    width   : 50,
    height  : 50
   }
  }
 }); // fancybox
}); // ready 
```

**请注意**，我们使用该`data-fancybox-group="gallery"`属性来设置画廊元素（`rel`不能与`area`标签一起使用，因为它曾经与 v1.3.4 一起使用。）您可能需要设置 HTML5`DOCTYPE`以进行验证。

**更新**：[在此处查看工作演示](http://www.picssel.com/playground/jquery/galleryFromImageMap_02jul12.html)-**注意**（2013 年 1 月 15 日）此演示将失败，因为使用的是 jQuery v1.9.0。检查**[此](https://stackoverflow.com/q/14344289/1055987)**以供进一步参考。不过，您可以使用 jQuery v1.8.3 重现工作演示。

# iphone - iPhone滑块音量控制器到另一个控制器

> ID：11299556
> 
> 赞同：0
> 
> 时间：2012-07-02T18:57:15.043
> 
> 标签：iphone, sdk, slider

我是objective-c的新手，我创建了一个`firstcontroller`播放歌曲： `[mysong play]`还创建了一个音量滑块控件： `mysong.volume=slider.value`

它工作正常，我创建了另一个`remoteController`带有播放按钮和滑块的视图控制器来控制`firstcontroller`播放歌曲，我可以播放歌曲但是我如何通过滑块值来控制音量，谢谢有人能启发我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:08:36.367

这个问题没有很清楚地解释，但我想说你可以在你的`FirstController`类中添加一个属性来公开音量值。像这样的东西：

```
@interface FirstController : ...
{
    float _level;
}

@property (nonatomic, assign) float volumeLevel;
@end

@implementation FirstController
@synthesize volumeLevel = _level;

- (id)init {
    ...
    _level = -1;
    ...
}

- (void)setVolumeLevel:(float)level {
    _level = level;
    <# update slider volume here #>
}

- (float)volumeLevel {
    if (_level < 0) {
       /* first access */
        _level = <# read the volume from the slider #>
    } 
    return _level;
}
@end 
```

如果您向我们展示一些实际代码，我们可以根据您的需求定制答案。

# html - html表单中的必填字段适用于chrome但不适用于移动设备或ie（在wordpress中完成）

> ID：11299562
> 
> 赞同：0
> 
> 时间：2012-07-02T18:58:10.687
> 
> 标签：html, forms, wordpress, field, required

我正在 wordpress 中使用 html 构建表单。需要在 chrome 中使用的字段（当按下提交按钮时，请在字段中没有信息的情况下填写此字段）但是它不适用于 IE 或移动设备，它只允许提交表单。这是一个字段的示例

姓： *

```
input type="text" name="lastname" value="" maxlength="50" required="required" 
```

我不知道这里发生了什么，而且我很新，所以任何帮助将不胜感激

（编辑答案）这就是我最终做的事情，现在可以工作了，感谢您的回复

```
<html>
<head>
<script type="text/javascript">
function validateForm()
{
var x=document.forms["myForm"]["firstname"].value;
if (x==null || x=="")
  {
  alert("First name must be filled out");
  return false;
  }
}
</script>
</head>
<body>
<form name="myForm" form action="dlcplateFormTest.php"  onsubmit="return validateForm()"                   method="POST">
<tr>
<td>Last name: *</td>
<td><input type="text" name="lastname" value="" maxlength="50" required="required"  />            </td>
</tr>
<tr>
<input type="submit" value="Submit" /><input type="reset" value="Reset" />
</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:05:27.897

您需要编写一个javascript函数来检查字段是否为“”如果它们是“”然后取消请求

# mysql - 使用自定义映射类型的 Doctrine2/Symfony2 字段值转换

> ID：11299564
> 
> 赞同：1
> 
> 时间：2012-07-02T18:58:15.093
> 
> 标签：mysql, symfony, doctrine-orm, point

我正在尝试使用 Doctrine2 为 Symfony2 定义自定义数据类型。我在 Doctrine 文档中找到了这个解决方案：

[http://docs.doctrine-project.org/en/latest/cookbook/advanced-field-value-conversion-using-custom-mapping-types.html](http://docs.doctrine-project.org/en/latest/cookbook/advanced-field-value-conversion-using-custom-mapping-types.html)

但它不起作用，因为**它一直发送整个 Point 对象作为查询的参数，而不是 PointType 应该返回的字符串**。我知道还有另一种使用 pack PHP 函数的解决方案，它工作正常（我从这里拿了它：[https](https://github.com/jhartikainen/doctrine2-spatial/blob/master/Wantlet/ORM/PointType.php) ://github.com/jhartikainen/doctrine2-spatial/blob/master/Wantlet/ORM/PointType.php ）但我很好奇学说文档解决方案的这个错误。以前有人见过这个问题吗？

非常感谢！

# ruby-on-rails - 用于检查网站是否有站点地图的 Ruby 代码

> ID：11299567
> 
> 赞同：1
> 
> 时间：2012-07-02T18:58:30.283
> 
> 标签：ruby-on-rails, ruby, sitemap, typhoeus

我正在 Rails 中开发一个应用程序，它需要检查输入网站 URL 的站点地图是否存在？例如，如果用户输入[http://google.com](http://google.com)，那么它应该返回“Sitemap present”。我已经看到通常网站在其 URL 末尾有 /sitemap.xml 或 /sitemap 的解决方案。所以我试着把使用 typhoeus gem 对此进行检查，检查 URL（如 www.google.com/sitemap.xml 或 www.apple.com/sitemap）的 response.code，如果它返回 200 或 301，则站点地图存在，否则不是。但我发现有些网站即使没有站点地图也会返回 301，它们会将其重定向到他们的主页（例如[http://yournextleap.com/sitemap.xml](http://yournextleap.com/sitemap.xml)），因此我没有得到确凿的结果。任何帮助都会非常棒。这是我使用 typhoeus 检查站点地图的示例代码：

```
# the request object
request = Typhoeus::Request.new("http://apple.com/sitemap")

# Run the request via Hydra.
hydra = Typhoeus::Hydra.new

request.on_complete do |response|
  if response.code == 301
   p "success 301" # hell yeah
   elsif response.code == 200
    p  "Success 200"
   elsif response.code == 404
.   puts "Could not get a sitemap, something's wrong."  
    else
    p "check your input!!!!"
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:55:48.553

> HTTP 响应状态码 301 Moved Permanently 用于永久重定向。此状态代码应与位置标头一起使用。RFC 2616 指出：
> 
> ```
> If a client has link-editing capabilities, it should update all references to the Request URI.
> The response is cachable.
> Unless the request method was HEAD, the entity should contain a small hypertext note with a hyperlink to the new URI(s).
> If the 301 status code is received in response to a request of any type other than GET or HEAD, the client must ask the user before redirecting. 
> ```

我认为您认为 301 响应表明曾经存在站点地图是不公平的。如果您正在检查是否存在 sitemap.xml 或站点地图目录，则预期的正确响应是 2XX。

如果您坚持假设 3XX 请求指示重定向到站点地图，请按照重定向并添加逻辑来检查页面的 url（如果是主页）或页面的内容以查看它是否具有 XML结构体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T20:04:54.123

站点地图也可能被压缩到`sitemap.xml.gz`——所以你可能也需要检查那个文件名。此外，它可能具有指向许多其他子站点地图的索引文件，这些子站点地图的名称也可能不同。

对于我的项目中的示例，我有：

```
sitemap_index.xml.gz 
  -> sitemap_en1.xml.gz (english version of links)
  -> sitemap_pl1.xml.gz (polish version of links)
  -> images_sitemap1.xml.gz (only images sitemap) 
```

网站使用这些文件名 ping 搜索引擎，但有时它们也可能将它们包含在`/robots.txt`文件中，因此您可以尝试在那里寻找它们。例如[http://google.com](http://google.com)在他们的文件末尾有这个：

（看看站点地图的名称有多奇怪！）

```
Sitemap: http://www.gstatic.com/s2/sitemaps/profiles-sitemap.xml
Sitemap: http://www.google.com/hostednews/sitemap_index.xml
Sitemap: http://www.google.com/ventures/sitemap_ventures.xml
Sitemap: http://www.google.com/sitemaps_webmasters.xml
Sitemap: http://www.gstatic.com/trends/websites/sitemaps/sitemapindex.xml
Sitemap: http://www.gstatic.com/dictionary/static/sitemaps/sitemap_index.xml 
```

关于 301：您可以尝试伪装成 Google Bot 或其他爬虫。也许他们会重定向除机器人之外的所有人。但是，如果他们重定向每个人，那么您将无能为力。

# javascript - 谷歌地图 JavaScript API v3

> ID：11299573
> 
> 赞同：5
> 
> 时间：2012-07-02T18:58:52.653
> 
> 标签：javascript, api, maps

请有人指出我正确的方向。

我花了几天时间看视频和阅读谷歌地图，现在比开始时更困惑。

我运行一个 worpress 网站，并想添加一个谷歌地图来显示场地。我通过从我创建的以前的谷歌地图复制 html 来做到这一点。我决定重新开始，尝试将地图样式设置为看起来更有吸引力，并查看是否可以创建一个包含我可以更新的站点位置的数据库。

在此过程中，我遇到了一个要求我提供 API 密钥的插件。我努力寻找我的 API 密钥，然后开始阅读谷歌地图已经取消了以前的版本，现在正在使用一种叫做谷歌地图 JavaScript API v3 的东西。

请有人指导我如何使用它以及它的全部内容。我已经阅读了[Google Maps JavaScript API v3](https://developers.google.com/maps/documentation/javascript/tutorial#Audience)，但仍然感到困惑。?

如果有人有一些有用的视频，比如白痴入门指南....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-19T07:07:47.900

看看这个：[http](http://webdesign.tutsplus.com/tutorials/htmlcss-tutorials/getting-creative-with-the-google-maps-api/) ://webdesign.tutsplus.com/tutorials/htmlcss-tutorials/getting-creative-with-the-google-maps-api/ 。有点像初学者指南...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T12:26:11.963

如果您使用的是 Wordpress，为什么不直接尝试插件呢？它可能会处理所有细节，让您只需处理管理网站。这个收视率相当不错：

[http://wordpress.org/extend/plugins/mappress-google-maps-for-wordpress/](http://wordpress.org/extend/plugins/mappress-google-maps-for-wordpress/)

关于您的 API 密钥，它是 Google 在您注册网站以使用地图时提供给您的。尝试重新注册。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T20:07:23.243

基本文档可以在[google 的开发者网站上](https://developers.google.com/maps/documentation/javascript/reference)找到。如果您正在为基本的地图功能和蒙皮而苦苦挣扎，您可能会发现使用简化很多流程的包装器很有帮助，例如[github 上的这个 gmaps 项目](http://hpneo.github.com/gmaps/)。

如果您有更具体的问题，也许您可​​以编辑您的帖子并准确列出您面临的障碍。

# android - Android简单查询喜欢和不喜欢

> ID：11299575
> 
> 赞同：1
> 
> 时间：2012-07-02T18:58:54.667
> 
> 标签：android, cursor, media-player

我正在尝试使用带有托管查询的游标来过滤设备上的媒体内容

```
String[] dirs = new String[] {"%"+ dir + "%"};

String[] musicdata = { BaseColumns._ID,
        MediaColumns.DATA,
        MediaColumns.DISPLAY_NAME,
        MediaColumns.SIZE };

musiccursor = getActivity().getContentResolver().query(
        MediaStore.Audio.Media.EXTERNAL_CONTENT_URI, 
        musicdata, 
        MediaColumns.DATA + " like ? ", 
        dirs, 
        MediaColumns.DATA + " asc"); 
```

查询的 where 子句使用传递给它的目录，以便过滤该文件夹和子文件夹中的音乐。

我想做的是在同一个查询中包含一个“不喜欢”。

这样做的原因是用户能够从列表视图中排除文件夹，并将其存储在数组中并写入文件以保留选择。我希望光标查询将这些排除项考虑在内，同时仍链接到它们传递给它的文件夹。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T20:21:36.913

在回答我自己的查询时，代码如下：

```
 //Build the where clause
         StringBuilder where = new StringBuilder();

         //first add in all values from the exclusion array
         for (int i = 0; i < excludedFolders.size(); i++) {
         where.append(MediaColumns.DATA + " not like ? ");
         where.append(" AND ");
         }
         //then add in the final like clause, e.g. the folder the user selected
         where.append(MediaColumns.DATA + " like ? ");

         //convert it to a string
         String selection = where.toString();

         System.out.println(selection);
         ////////////////////////////////////////////////////////////////////////////////////////////

         //Build the arguments.  the array is set to the size of the exlcusion list, plus 1 for the fodler selected
         String[] dirs = new String[excludedFolders.size()+1]; 
         System.out.println(excludedFolders.size()+1);
         //first add in a value for each excluded folder
         for (int i = 0; i < excludedFolders.size(); i++) {
                dirs[i] = "%" + excludedFolders.get(i) + "%";
                System.out.println(i + " " + dirs[i]);
            }
         //add the argument value for the like element of the query 
         dirs[excludedFolders.size()]="%"+ dir + "%";
         System.out.println("excludedFolders.size() " + dirs[excludedFolders.size()]);  
         //start building the cursor
         String[] musicdata = { BaseColumns._ID,
                MediaColumns.DATA,
                MediaColumns.DISPLAY_NAME,
                MediaColumns.SIZE };
         //run the query             
         musiccursor = getActivity().getContentResolver().query(
                    MediaStore.Audio.Media.EXTERNAL_CONTENT_URI, 
                    musicdata, 
                    selection,
                    dirs, 
                    MediaColumns.DATA+ " asc");
         //done 
```

# php - 从上传中创建最大的 x x y 图像，保持比例和居中

> ID：11299576
> 
> 赞同：2
> 
> 时间：2012-07-02T18:58:59.987
> 
> 标签：php, image, file-upload, gd

我正在尝试使用 GD 库创建一个脚本，该脚本将获取任何大小的上传图像并创建最大的 x x y 拇指，保持它的比例，如果图像太小，它会得到最大的 x/y它的比例并放大它，使其保持居中。

我不关心像素化图像。

举以下例子

![在此处输入图像描述](../Images/b613eb753be725a0a99871f154364a89.png)

我知道这是可行的，但我一直在计算 x/y 坐标

这就是我目前所处的位置。我正在尝试创建 3 个具有定义大小的拇指

```
<?php

    $sizes = array(
        array(
            'width' => 640,
            'height' => 360
        ),
        array(
            'width' => 222,
            'height' => 166
        ),
        array(
            'width' => 140,
            'height' => 105
        )
    );

    if (isset($_FILES['image'])) {

        $file = $_FILES['image'];

        foreach($sizes as $size) {

            if (strpos($file['type'], 'jpeg') !== false || strpos($file['type'], 'jpg') !== false) {

                $resource = imagecreatefromjpeg($file['tmp_name']);
            }
            else if (strpos($file['type'], 'png') !== false) {

                $resource = imagecreatefrompng($file['tmp_name']);
            }
            else if (strpos($file['type'], 'gif') !== false) {

                $resource = imagecreatefromgif($file['tmp_name']);
            }
            else {

                echo "bad file type " . $file['type'];
                exit;
            }

            list($width, $height) = getimagesize($file['tmp_name']);

            $tmpImage = imagecreatetruecolor($size['width'], $size['height']);

            /*

            need to do some calculations here

            */

            imagecopyresampled($tmpImage, $resource, 0, 0, 0, 0, $width, $height, $size['width'], $size['height']);

            ob_start();
            imagepng($tmpImage);
            $image = ob_get_clean();

            echo '<img src="data:image/png;base64,' . base64_encode($image) . '" />';

            imagedestroy($tmpImage);
        }

        var_dump($file, $width, $height);
    }

    exit;

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T21:58:38.463

供您考虑：

```
<?php

$sizes = array(
    array(
        'width' => 640,
        'height' => 360
    ),
    array(
        'width' => 222, 
        'height' => 166
    ),
    array(
        'width' => 140,
        'height' => 105
    )
);

if (isset($_FILES['image'])) {

    $file = $_FILES['image'];

    foreach($sizes as $size) {

        if (strpos($file['type'], 'jpeg') !== false || strpos($file['type'], 'jpg') !== false) {

            $original_image = imagecreatefromjpeg($file['tmp_name']);
        }
        else if (strpos($file['type'], 'png') !== false) {

            $original_image = imagecreatefrompng($file['tmp_name']);
        }
        else if (strpos($file['type'], 'gif') !== false) {

            $original_image = imagecreatefromgif($file['tmp_name']);
        }
        else {

            echo "bad file type " . $file['type'];
            exit;
        }

        $thumbnail_image = imagecreatetruecolor($size['width'], $size['height']);

        $original_size = getimagesize($file['tmp_name']);
        $original_width = $original_size[0];
        $original_height = $original_size[1];
        $adjusted_original_width = $original_size[0];
        $adjusted_original_height = $original_size[1];

        $fitting = false;
        $original_aspect_ratio = $original_width/$original_height; // larger is wider
        $ideal_thumbnail_aspect_ratio = $size['width']/$size['height']; // larger is wider
        if($original_aspect_ratio > $ideal_thumbnail_aspect_ratio) $fitting = 'wide'; // the original is wider than the ideal
        else if($original_aspect_ratio < $ideal_thumbnail_aspect_ratio) $fitting = 'tall'; // the original is taller than the ideal

        $src_x = 0;
        $src_y = 0;

        if($fitting=='wide') {
            $adjusted_original_width = $original_height * $size['width']/$size['height'];
            $src_x = ($original_width-$adjusted_original_width)/2;
        }
        else {
            $adjusted_original_height = $original_width * $size['height']/$size['width'];
            $src_y = ($original_height-$adjusted_original_height)/2;
        }

        $thumbnail_image = imagecreatetruecolor($size['width'], $size['height']);

        imagecopyresampled($thumbnail_image, $original_image, 0, 0, $src_x, $src_y, $size['width'], $size['height'], $adjusted_original_width, $adjusted_original_height);

        ob_start();
        imagepng($thumbnail_image);
        $image = ob_get_clean();

        echo '<img src="data:image/png;base64,' . base64_encode($image) . '" />';

        imagedestroy($thumbnail_image);
    }

    var_dump($file, $original_width, $original_height);
}

exit; 
```

# https - flowplayer mp4 无法在 https 上运行

> ID：11299577
> 
> 赞同：4
> 
> 时间：2012-07-02T18:59:10.470
> 
> 标签：https, mp4, flowplayer

我已经设置了 flowplayer 并使用 h264 对 mp4 进行了编码。当我在本地（http）运行时，视频播放效果很好。当我在我们的开发服务器（https）上运行时，flowplayer 显示黑屏并播放音频，但从不显示视频。FLV 文件在 https 上工作正常。我怎样才能让 mp4 工作？

更新：我刚刚在 safari 中尝试过，它通过 https 播放 mp4 很好。它在 https 上的 Firefox 中不起作用。

# c# - 使用 iOS 5 如何使用 Json 将对象发布到 WCF 服务

> ID：11299578
> 
> 赞同：0
> 
> 时间：2012-07-02T18:59:12.670
> 
> 标签：c#, wcf, ios5

您是否需要在 iOS 中创建与 WCF 服务上的 POST 方法相同的对象？

WCF 服务中的 POST 调用示例

```
[OperationContract]
    [WebInvoke(Method = "POST",
       ResponseFormat = WebMessageFormat.Json,
       RequestFormat = WebMessageFormat.Json,
       BodyStyle = WebMessageBodyStyle.Wrapped,
       UriTemplate = "")]
       //method
       Employee PostEmp(Employee emp);
[DataContract]
public class Employee
{
    [DataMember]
    public string firstname { get; set; }
    [DataMember]
    public string idkey { get; set; }
    [DataMember]
    public string lastname { get; set; }
    [DataMember]
    public string salary { get; set; }

    public Employee(string first, string id, string sal, string last)
    {
        firstname = first;
        idkey = id;
        salary = sal;
        lastname = last;

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:08:59.707

不，您不会在 iOS 上创建那些 POCO 类。iOS 只会从 WCF 服务读取 Json 字符串响应。iOS 设备也会将 Json 发布到服务 url。

wcf 服务将为您完成所有序列化/反序列化。

# c# - C# 默认值

> ID：11299584
> 
> 赞同：0
> 
> 时间：2012-07-02T18:59:22.220
> 
> 标签：c#, class, default

```
private static void print(StreamWriter sw, string mlog, bool screen)
    {
        DateTime ts = DateTime.Now;
        sw.WriteLine(ts + " " + mlog);
        if (screen == true)
        {
            Console.WriteLine(mlog);
        }
    } 
```

我会`print (sw,"write here", false)`打电话的。90% 的机会我会使用 false。如何使它默认为假，这样我在打电话时就不必做额外的类型？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-02T19:00:32.827

如果您使用的是 C# 4，则可以创建`screen`一个[*可选参数*](http://msdn.microsoft.com/en-us/library/dd264739.aspx)：

```
// Note: changed method and parameter names to be nicer
private static void Print(StreamWriter writer, string log, bool screen = false)
{
    // Note: logs should almost always use UTC rather than the system local
    // time zone
    DateTime now = DateTime.UtcNow;

    // TODO: Determine what format you want to write your timestamps in.
    sw.WriteLine(CultureInfo.InvariantCulture,
                 "{0:yyyy-MM-dd'T'HH:mm:ss.fff}: {1}", now, log);
    if (screen)
    {
        Console.WriteLine(mlog);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T19:00:30.720

只需使用`= false`：

```
private static void print(StreamWriter sw, string mlog, bool screen = false) 
```

[这是有关C# 中的命名和可选参数的](http://msdn.microsoft.com/en-us/library/dd264739.aspx)更多信息。

请注意，这是 C# 4.0 中的新功能。对于旧版本，按照其他人的建议使用方法重载。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-02T19:01:43.853

```
private static void print(StreamWriter sw, string mlog)
{
    print(sw, mlog, false);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-02T19:02:32.823

对于旧版本，您可以简单地提供 2 个覆盖：

```
private static void print(StreamWriter sw, string mlog)
{ 
 print(sw,mlog, false);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-02T19:03:03.493

如果您不使用 C# 4，请创建函数重载：

```
private static void Print(StreamWriter writer, string log) 
{ 
    Print(writer, log, false);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-02T19:04:46.537

涉及可选参数的答案将起作用，但某些语言不支持可选参数，因此它们无法从面向公众的 API 调用此方法。

我会使用方法重载..

```
private static void print(StreamWriter sw, string mlog) {
    print(sw, mlog, false);
} 
```

`private static void print(StreamWriter sw, string mlog, bool screen) { ... }`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-02T20:07:25.757

```
private static void print(StreamWriter sw, string mlog = "Write here", bool screen = false)
    {
        DateTime ts = DateTime.Now;
        sw.WriteLine(ts + " " + mlog);
        if (screen == true)
        {
            Console.WriteLine(mlog);
        }
    } 
```

# android - ProgressDialog 没有出现在 AsyncTask 中

> ID：11299592
> 
> 赞同：1
> 
> 时间：2012-07-02T18:59:59.627
> 
> 标签：android, android-asynctask, progressdialog

我在`AsyncTask`从 Web 服务检索数据时使用过。我想在`ProgressDialog`从 Web 服务器获取数据时出现。以下是代码片段。

我初始化进度对话框并在 onCreate 中调用异步任务对象并调用 asynctask：

```
public class MyDashboardActivity extends Activity {
     ProgressDialog mProgressDialog;
     static final int LOADING_DIALOG = 0;

private FetchDashboardEntriesProcess mTask;
private boolean mShownDialog;
    private MyDashboardActivity act = null;

@Override
public void onCreate(Bundle savedInstanceState) {
  super.onCreate(savedInstanceState);
  setContentView(R.layout.mydashboard);
mTask = new FetchDashboardEntriesProcess(MyDashboardActivity.this);
     mTask.execute(null,null,null);  
}

private class FetchDashboardEntriesProcess extends AsyncTask<Object, Void, Void> {

private MyDashboardActivity activity;
private boolean completed;

private ArrayList<DashboardEntry> returnVal = new ArrayList<DashboardEntry>();

private FetchDashboardEntriesProcess(MyDashboardActivity activity) {
    this.activity = activity;
}

public ArrayList<DashboardEntry> getAllDashboardEntry() {
    return returnVal;
}

@Override
protected void onPreExecute() {
    if (!completed) {

        activity.showDialog(LOADING_DIALOG);

    }
}

@Override
protected Void doInBackground(Object... params) {
    try {
        ServiceCall call = new ServiceCall();
        DashboardEntryCriteria bean = new DashboardEntryCriteria();
        StringBuilder dateStr = new StringBuilder();

        bean.setLoginId("300");
        returnVal = call.getDashboardEntries(bean);

    } catch (Exception e) {
        Log.d(TAG, "Exception" + e.toString());
        e.printStackTrace();
    }
    return null;

}

@Override
protected void onPostExecute(Void unused) {
    completed = true;

    notifyActivityTaskCompleted();

}

private void setActivity(MyDashboardActivity activity) {
    this.activity = activity;
    if (completed) {
        notifyActivityTaskCompleted();
    }
}
private void notifyActivityTaskCompleted() {
    if (null != activity) {
        activity.onTaskCompleted();

    }
}
}
private void onTaskCompleted() {
    Log.e(TAG, "Activity " + this
            + " has been notified the task is complete.");
    dashboardEntries = mTask.getAllDashboardEntry();
    fillDashboardEntries(dashboardEntries);

    if (mShownDialog) {
        dismissDialog(LOADING_DIALOG);

    }
}

@Override
protected void onPrepareDialog(int id, Dialog dialog) {
    super.onPrepareDialog(id, dialog);
    if (id == LOADING_DIALOG) {
        mShownDialog = true;
    }
}

@Override
protected Dialog onCreateDialog(int id) {
    // TODO Auto-generated method stub
    if (id == LOADING_DIALOG) {
        mProgressDialog = Functions.getProgressDialog(act,
                getString(R.string.all_retriving_data));
        return mProgressDialog;
    }
    return super.onCreateDialog(id);
}
} 
```

根据日志程序`onPreExecute`在该行被中断，`activity.showDialog(LOADING_DIALOG);`所以我猜测错误是由于我创建对话框的方式出现问题而产生的。我该如何度过这个难关？

谢谢你。

**编辑：原木猫**

```
07-02 19:41:53.433: D/dalvikvm(335): GC_EXTERNAL_ALLOC freed 61K, 52% free 2600K/5379K,   external 1625K/2137K, paused 79ms

 07-02 19:41:58.214: I/myproject(335): Activity com.myproject.activities.LoginActivity@405293b0 has been notified the task is complete.
 07-02 19:41:58.745: D/dalvikvm(335): GC_EXTERNAL_ALLOC freed 271K, 52% free 2721K/5639K, external 3579K/3826K, paused 152ms

 07-02 19:41:59.644: E/RESULT:(335): GetDashboardEntriesResponse{GetDashboardEntriesResult=anyType{}; }

 07-02 19:41:59.654: E/Some Exception(335): Some Exception
 07-02 19:41:59.664: W/System.err(335): java.lang.NullPointerException
 07-02 19:41:59.664: W/System.err(335):     at android.app.Dialog.<init> (Dialog.java:141)
07-02 19:41:59.664: W/System.err(335):  at android.app.AlertDialog.<init>(AlertDialog.java:63)
07-02 19:41:59.674: W/System.err(335):  at android.app.ProgressDialog.<init>(ProgressDialog.java:80)
07-02 19:41:59.674: W/System.err(335):  at android.app.ProgressDialog.<init>(ProgressDialog.java:76)
07-02 19:41:59.674: W/System.err(335):  at com.myproject.utils.Functions.getProgressDialog(Functions.java:54)
07-02 19:41:59.674: W/System.err(335):  at com.myproject.activities.MyDashboardActivity.onCreateDialog(MyDashboardActivity.java:178)
07-02 19:41:59.674: W/System.err(335):  at android.app.Activity.onCreateDialog(Activity.java:2482)
07-02 19:41:59.674: W/System.err(335):  at android.app.Activity.createDialog(Activity.java:882)
07-02 19:41:59.674: W/System.err(335):  at android.app.Activity.showDialog(Activity.java:2557)
07-02 19:41:59.674: W/System.err(335):  at android.app.Activity.showDialog(Activity.java:2524)
07-02 19:41:59.674: W/System.err(335):  at com.myproject.activities.MyDashboardActivity$FetchDashboardEntriesProcess.onPreExecute(MyDashboardActivity.java:211)
07-02 19:41:59.674: W/System.err(335):  at android.os.AsyncTask.execute(AsyncTask.java:391)
07-02 19:41:59.674: W/System.err(335):  at com.myproject.activities.MyDashboardActivity.onCreate(MyDashboardActivity.java:159)
07-02 19:41:59.674: W/System.err(335):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
07-02 19:41:59.684: W/System.err(335):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
07-02 19:41:59.684: W/System.err(335):  at android.app.ActivityThread.startActivityNow(ActivityThread.java:1487)
07-02 19:41:59.684: W/System.err(335):  at android.app.LocalActivityManager.moveToState(LocalActivityManager.java:127)
07-02 19:41:59.684: W/System.err(335):  at android.app.LocalActivityManager.startActivity(LocalActivityManager.java:339)
07-02 19:41:59.684: W/System.err(335):  at android.widget.TabHost$IntentContentStrategy.getContentView(TabHost.java:654)
07-02 19:41:59.684: W/System.err(335):  at android.widget.TabHost.setCurrentTab(TabHost.java:326)
07-02 19:41:59.684: W/System.err(335):  at android.widget.TabHost.addTab(TabHost.java:216)
07-02 19:41:59.684: W/System.err(335):  at com.myproject.activities.IncludeTabActivity.onCreate(IncludeTabActivity.java:52)
07-02 19:41:59.684: W/System.err(335):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
07-02 19:41:59.684: W/System.err(335):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
07-02 19:41:59.684: W/System.err(335):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
07-02 19:41:59.694: W/System.err(335):  at  android.app.ActivityThread.access$1500(ActivityThread.java:117)
07-02 19:41:59.694: W/System.err(335):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
07-02 19:41:59.694: W/System.err(335):  at android.os.Handler.dispatchMessage(Handler.java:99)
07-02 19:41:59.694: W/System.err(335):  at android.os.Looper.loop(Looper.java:123)
07-02 19:41:59.694: W/System.err(335):  at android.app.ActivityThread.main(ActivityThread.java:3683)
07-02 19:41:59.694: W/System.err(335):  at  java.lang.reflect.Method.invokeNative(Native Method)
07-02 19:41:59.704: W/System.err(335):  at java.lang.reflect.Method.invoke(Method.java:507)
07-02 19:41:59.704: W/System.err(335):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
07-02 19:41:59.704: W/System.err(335):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
07-02 19:41:59.704: W/System.err(335):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:10:01.540

与其将`Activity`in 传递给`AsyncTask`，只需在被调用的 Activity 中创建一个方法`showDialog()`，然后从`onPreExecute()`and调用 this `onPostExecute()`。在那里创建并展示你`ProgressDialog`的。因为您将 . 创建`AsyncTask`为内部类，所以应该可以`Activity`毫无问题地调用 . 中的方法，然后您不必担心传入`Context`.

类似于`AsyncTask`开发者页面示例：http: [//developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T19:06:40.737

在 onPreExecute 中，尝试[ProgressDialog.show](http://developer.android.com/reference/android/app/ProgressDialog.html#show%28android.content.Context,%20java.lang.CharSequence,%20java.lang.CharSequence%29)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T20:13:16.780

对我来说，变量看起来`act`总是`null`。

评估活动`act`或尝试以下操作：

```
mProgressDialog = Functions.getProgressDialog(MyDashboardActivity.this,
                getString(R.string.all_retriving_data)); 
```

# objective-c - NSCaseInsentiveCompare 不按预期工作？

> ID：11299594
> 
> 赞同：0
> 
> 时间：2012-07-02T19:00:04.460
> 
> 标签：objective-c, string, compare

我试图让这段代码工作，想法是比较两个字符串数组，第一个是名称，第二个是单词，所以我尝试从第一个数组中找到单词，然后将它与第二个数组中的所有单词进行比较，如果我得到了肯定的结果，我把这个词打印出来。但它没有按预期工作，它只是打印所有名称数组。这段代码有什么问题？也许有更有效的方法来做到这一点？

```
for (NSString *n in names) {

        for (NSString *m in words) {
            if ([n caseInsensitiveCompare:m] == NSOrderedSame) {
                NSLog(@"%@", n);
            }

        }          
    } 
```

我尝试了另一种方法，它只是一个接一个地打印名字。尝试将单词换成名称以获得相同的结果。相互比较是有问题的。

```
 for (NSString *n in names) {
            NSString *newN = [n lowercaseString]; 

            for (NSString *m in words) {
                NSString *newM = [m lowercaseString];

                if ([newN isEqualToString: newM]) {
                    NSLog(@"%@ is equal to %@", newN, newM );
                }

            }          
        } 
```

这件事提供了相同的结果！呃。

```
NSArray *names = [nameString componentsSeparatedByString:@"\n"];
NSArray *words = [itemsString componentsSeparatedByString:@"\n"];

int i = 0;
int j = 0;
while (i != [names count] ) {

    while (j != [words count]) {
        if ([[names objectAtIndex:i] caseInsensitiveCompare:[words objectAtIndex:j]] == NSOrderedSame)
        {
            NSLog(@"Voila! Name is : %@", [names objectAtIndex:i]);
        }
        j++;
    }
    j = 0;
    i++; 
```

怎么了？我想不通，我试过了。如果您从任一数组中逐个选择单词，您将获得正确的名称和单词。Words 数组中没有大多数名称作为我得到的输出。我只是按顺序得到名称，Aaron、Aasomething 等，它们不在单词数组中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:45:10.807

其实我已经找到答案了。words 文件包含 names 文件中的所有名称。所以你只要得到所有的名字。所有三个代码变体都按预期工作。

好吧，至少我今天学到了一些新东西。

# c++ - 并行化造成的性能损失

> ID：11299597
> 
> 赞同：0
> 
> 时间：2012-07-02T19:00:18.113
> 
> 标签：c++, openmp

为了教育目的，我修改了我不久前编写的光线跟踪器，以利用 OpenMP 的多处理。但是，我没有看到并行化有任何好处。

我尝试了 3 种不同的方法：任务池环境（`draw_pooled()`函数）、`for`具有图像行级并行性的标准 OMP 并行嵌套循环（`draw_parallel_for()`），以及另一个`for`具有像素级并行性的 OMP（`draw_parallel_for2()`）。原始的连续绘图例程也包括在内以供参考（`draw_serial()`）。

我在 Intel Core 2 Duo E6750（2 个内核 @ 2,67GHz，每个带超线程）和 Linux 下的 4GB RAM 上运行 2560x1920 渲染，由 gcc 和 libgomp 编译的二进制文件。场景取平均值：

*   连续渲染 120 秒，
*   但是无论我选择上述三种特定方法中的哪一种，都需要 196 秒（**原文如此！**）在 2 个线程中并行执行（默认值 - CPU 内核数），
*   如果我用 4 覆盖 OMP 的默认线程数以考虑 HT，则并行渲染时间下降到 177 秒。

为什么会这样？我在并行代码中看不到任何明显的瓶颈。

**编辑：**只是为了澄清-任务池**只是实现之一**，请阅读问题-向下滚动以查看并行`for`。问题是，它们和任务池一样慢！

```
void draw_parallel_for(int w, int h, const char *fname) {
    unsigned char *buf;

    buf = new unsigned char[w * h * 3];

    Scene::GetInstance().PrepareRender(w, h);

    for (int y = 0; y < h; ++y) {
        #pragma omp parallel for num_threads(4)
        for (int x = 0; x < w; ++x)
            Scene::GetInstance().RenderPixel(x, y, buf + (y * w + x) * 3);
    }

    write_png(buf, w, h, fname);

    delete [] buf;
}

void draw_parallel_for2(int w, int h, const char *fname) {
    unsigned char *buf;

    buf = new unsigned char[w * h * 3];

    Scene::GetInstance().PrepareRender(w, h);

    int x, y;
    #pragma omp parallel for private(x, y) num_threads(4)
    for (int xy = 0; xy < w * h; ++xy) {
        x = xy % w;
        y = xy / w;
        Scene::GetInstance().RenderPixel(x, y, buf + (y * w + x) * 3);
    }

    write_png(buf, w, h, fname);

    delete [] buf;
}

void draw_parallel_for3(int w, int h, const char *fname) {
    unsigned char *buf;

    buf = new unsigned char[w * h * 3];

    Scene::GetInstance().PrepareRender(w, h);

    #pragma omp parallel for num_threads(4)
    for (int y = 0; y < h; ++y) {
        for (int x = 0; x < w; ++x)
            Scene::GetInstance().RenderPixel(x, y, buf + (y * w + x) * 3);
    }

    write_png(buf, w, h, fname);

    delete [] buf;
}

void draw_serial(int w, int h, const char *fname) {
    unsigned char *buf;

    buf = new unsigned char[w * h * 3];

    Scene::GetInstance().PrepareRender(w, h);

    for (int y = 0; y < h; ++y) {
        for (int x = 0; x < w; ++x)
            Scene::GetInstance().RenderPixel(x, y, buf + (y * w + x) * 3);
    }

    write_png(buf, w, h, fname);

    delete [] buf;
}

std::queue< std::pair<int, int> * > task_queue;

void draw_pooled(int w, int h, const char *fname) {
    unsigned char *buf;

    buf = new unsigned char[w * h * 3];

    Scene::GetInstance().PrepareRender(w, h);

    bool tasks_issued = false;
    #pragma omp parallel shared(buf, tasks_issued, w, h) num_threads(4)
    {
        #pragma omp master
        {
            for (int y = 0; y < h; ++y) {
                for (int x = 0; x < w; ++x)
                    task_queue.push(new std::pair<int, int>(x, y));
            }
            tasks_issued = true;
        }

        while (true) {
            std::pair<int, int> *coords;
            #pragma omp critical(task_fetch)
            {
                if (task_queue.size() > 0) {
                    coords = task_queue.front();
                    task_queue.pop();
                } else
                    coords = NULL;
            }

            if (coords != NULL) {
                Scene::GetInstance().RenderPixel(coords->first, coords->second,
                    buf + (coords->second * w + coords->first) * 3);
                delete coords;
            } else {
                #pragma omp flush(tasks_issued)
                if (tasks_issued)
                    break;
            }
        }
    }

    write_png(buf, w, h, fname);

    delete [] buf;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T19:10:22.880

您在最里面的循环中有一个关键部分。换句话说，您正在达到*每个像素*的同步原语。这会扼杀性能。

最好将场景拆分为图块，并在每个线程上处理一个。这样，您在同步之间有更长的时间（整个瓦片的处理价值）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:45:25.580

如果像素是独立的，您实际上不需要任何锁定。您可以将图像分成行或列，让线程自行工作。例如，您可以让每个线程在每个第 n 行上运行（伪代码）：

```
for(int y = TREAD_NUM; y < h; y += THREAD_COUNT)
    for(int x = 0; x < w; ++x)
        render_pixel(x,y); 
```

其中 THREAD_NUM 是每个线程的唯一编号，因此`0 <= THREAD_NUM < THREAD_COUNT`. 然后*在*你加入你的线程池之后，执行 png 转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T20:16:25.410

创建线程时总是存在性能开销。for 循环内的 OMP Parallel 显然会产生大量开销。例如，在您的代码中

```
void draw_parallel_for(int w, int h, const char *fname) {

    for (int y = 0; y < h; ++y) {

    // Here There is a lot of overhead
         #pragma omp parallel for num_threads(4)
         for (int x = 0; x < w; ++x)
              Scene::GetInstance().RenderPixel(x, y, buf + (y * w + x) * 3);
    }
 } 
```

可以重写为

```
void draw_parallel_for(int w, int h, const char *fname) {

    #pragma omp parallel for num_threads(4)
    for (int y = 0; y < h; ++y) {
           for (int x = 0; x < w; ++x)
              Scene::GetInstance().RenderPixel(x, y, buf + (y * w + x) * 3);
    }
 } 
```

或者

```
void draw_parallel_for(int w, int h, const char *fname) {

    #pragma omp parallel num_threads(4)
    for (int y = 0; y < h; ++y) {
           #pragma omp for
           for (int x = 0; x < w; ++x)
              Scene::GetInstance().RenderPixel(x, y, buf + (y * w + x) * 3);
    }
 } 
```

通过这种方式，您将消除开销

# regex - 美国电话号码的 Devex TextEdit 输入掩码正则表达式

> ID：11299603
> 
> 赞同：0
> 
> 时间：2012-07-02T19:00:33.907
> 
> 标签：regex, devexpress, phone-number, maskedtextbox

我在 WInForms 应用程序中使用 Devex TextEdit 控件。我想在控件上使用正则表达式掩码来格式化美国电话号码。我目前正在使用这个：

((\d{3}))-(\d{3})-(\d{4}) x(\d*)

(888) 555-1212 x235

我想让扩展成为可选的。如果没有扩展名（ (888) 555-1212 x ），上述正则表达式总是将 x 放在末尾。

我有基本的正则表达式知识，但我不知道如何在掩码中使用它。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:20:31.713

找到了：

((\d{3}))-(\d{3})-(\d{4}) (x(\d*))？

# html - 如何防止 div 重叠

> ID：11299606
> 
> 赞同：-1
> 
> 时间：2012-07-02T19:00:45.023
> 
> 标签：html, css

我试图制作一个使用整个屏幕的布局，所以我没有在布局上设置固定宽度。我正在使用百分比。

我正在处理这个[http://www.abdhulzaman.co.uk/work/rima](http://www.abdhulzaman.co.uk/work/rima)

正如您在顶部看到的那样，我在标题的左上角有一个徽标和一个标题，还有一个绝对位置在右侧的导航。现在当我最小化屏幕时..导航和徽标标题会重叠，这真的很烦人。

与绝对/相对位置有什么关系？这可能看起来很简单.. 将不胜感激然后帮助！谢谢 :)

它类似于[http://jsfiddle.net/YFCWm/](http://jsfiddle.net/YFCWm/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:03:43.353

您的导航大小是动态的吗？如果没有，您可以`min-width`为您的设置一个`header`（尽管最好将它设置在包装整个站点的容器中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:17:29.480

快速解决您的问题的方法是在左侧为导航元素留出边距

```
margin: 0 0 0 230px; 
```

这将防止导航从标题元素的左边缘向左“移动”超过 230 像素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T19:06:33.637

如果您刚开始使用 css 和布局，那么使用基于网格的框架（如 twitter bootstrap 或 blueprint css）可能是一个好主意。

[http://twitter.github.com/bootstrap/](http://twitter.github.com/bootstrap/)

[http://blueprintcss.org/](http://blueprintcss.org/)

使用其中之一将使您的布局问题变得微不足道。

# c# - 文本文件未保存但没有错误（C#）

> ID：11299613
> 
> 赞同：2
> 
> 时间：2012-07-02T19:01:00.843
> 
> 标签：c#, io, save, writealltext

我现在一直在许多网站上寻找答案，但所有有效的答案只适用于richTextbox，而且我使用的是普通文本框。我正在尝试将文本框的内容保存到选择的文件中，但由于某种原因该文件没有保存，我不知道问题出在哪里。这是“保存”菜单项的代码：

```
private void saveToolStripMenuItem_Click(object sender, EventArgs e)
    {

        SaveFileDialog ofd = new SaveFileDialog();
        ofd.Title = "Save";
        ofd.Filter = "Txt Documents (.txt)|*.txt|All files (*.*)|*.*";
        if (ofd.ShowDialog() == DialogResult.OK)
        {
            try
            {
                //I don't know what to make of this, because clearly this doesn't work
                File.WriteAllText(@"./TestFile.txt", MainTextbox.Text);
            }
            catch (Exception ex)
            {
                MainTextbox.Text += ex;
            }
        }
    } 
```

没有错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T19:15:10.653

您应该保存到您在 中选择的文件`SaveFileDialog`，由`OpenFile()`. 这个例子对我有用：

```
SaveFileDialog ofd = new SaveFileDialog();
ofd.Title = "Save";
ofd.Filter = "Txt Documents (.txt)|*.txt|All files (*.*)|*.*";
if (ofd.ShowDialog() == DialogResult.OK)
{
    using (var fileStream = ofd.OpenFile())
    using (var sw = new StreamWriter(fileStream))
        sw.WriteLine("Some text");
} 
```

在您的代码中，您让用户选择要保存到的文件，然后忽略该文件并将其写入硬编码位置。您的应用可能没有执行此操作的权限，但它应该有权写入用户选择的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:05:35.980

使用`try { } catch (Exception ex) { }`块 [如何：使用 Try/Catch 块捕获异常](http://msdn.microsoft.com/en-us/library/xtd0s8kd.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T19:10:15.490

我认为它的访问被拒绝问题..尝试使用“D”驱动器...

这是工作示例... `WriteAllText`当文件已经存在并且如果文件已经存在则使用`AppendAllText`

```
using System;
using System.IO;
using System.Text;

class Test
{
    public static void Main()
    {
        string path = @"c:\temp\MyTest.txt";

        // This text is added only once to the file.
        if (!File.Exists(path))
        {
            // Create a file to write to.
            string createText = "Hello and Welcome" + Environment.NewLine;
            File.WriteAllText(path, createText);
        }

        // This text is always added, making the file longer over time
        // if it is not deleted.
        string appendText = "This is extra text" + Environment.NewLine;
        File.AppendAllText(path, appendText);

        // Open the file to read from.
        string readText = File.ReadAllText(path);
        Console.WriteLine(readText);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T19:11:25.303

首先，保存文件与文本的来源、富文本框或普通文本框无关。

正如 Brian S. 在评论中所说，很可能存在例外，因为您正在写入 C 驱动器。您应该使用相对路径：`"./MyTest.txt"`

# javascript - 隐藏元素上的 mootools Fx.Slide 切换不起作用

> ID：11299617
> 
> 赞同：0
> 
> 时间：2012-07-02T19:01:09.860
> 
> 标签：javascript, mootools, mootools-more

我正在加载一些带有请求的 html，并将其用作所有其他项目的模板。

我的代码是：

```
itemDummy.destroy()

this.content.each(function(task) {
    //
    //more code
    //
    item = itemDummy.clone();

    detailBox = item.getElement('.descriptionBox');

    detailBox.id = "description" + task.id;
    //detailBox.toggle ()
    //open it on click
    item.addEvent("click", function() {
        new Fx.Slide("description" + task.id).toggle();
    });

    //
    //more code
    //
    detailBox.inject(itemWrapper);
    item.inject(wrapper);
}); 
```

如果该行`detailBox.toggle ()`被激活，我的框不会显示，但 Fx 动画不起作用（框永远不可见）。但是当我设置 s 这一行注释时，会显示 detailBox 并且切换动画正在工作，但我想要一个隐藏的框在开头。

但是当我将此行设置为注释时，会显示 detailBox 并且切换动画正在工作，但我希望 Box invisible 以

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T20:52:17.380

在 Johan 评论之后，它在注入后起作用：

```
detailBoxIds.each(function (id) {
    new Fx.Slide(id).hide();

    //instead of $$(id).hide () or $$(id).toggle () 
    //a direct toogle/hide hides the element, but the Fx.Slide can't open it again
})

$$('.taksItemWraper').addEvent ("click", function () {
    var id = this.getElement('.descriptionBox').id;

    new Fx.Slide(id, { 
        duration:300
    }).toggle();
}) 
```

# jquery-plugins - Jquery 重塑 div 或图像

> ID：11299619
> 
> 赞同：0
> 
> 时间：2012-07-02T19:01:13.457
> 
> 标签：jquery-plugins

是否可以使 div 中的图像采用形状或另一个图像内的形式？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-30T08:59:29.683

我能想到的唯一解决方案是获取图像的宽度和高度，然后将这些值分配给你想要调整大小的 div：

```
var imgWidth = $('#imageid').width();
var imgHeight = $('#imageid').height();
$('#divId').css("height", imgHeight ); 
$('#divId').css("width", imgWidth); 
```

# excel - 错误检查和跟踪空单元格

> ID：11299620
> 
> 赞同：4
> 
> 时间：2012-07-02T19:01:17.707
> 
> 标签：excel, vba

在 Excel 中，可以找到引用空单元格的公式。

例如

A1 = 1

B1 = 空

C1 = .5

D1 = A1 + B1 + C1

D1 将正确计算出值为 1.5 但是，错误检查将确定公式 D1 中存在错误，并且可以向该单元格绘制箭头。

如果他们有对空单元格的引用，我需要提醒用户。

当我尝试使用该功能录制自己时，我得到了这个

```
With Application.ErrorCheckingOptions
    .EvaluateToError = False
    .TextDate = False
    .NumberAsText = False
    .InconsistentFormula = False
    .OmittedCells = False
    .UnlockedFormulaCells = False
    .ListDataValidation = False
    .InconsistentTableFormula = False
End With

ActiveSheet.ClearArrows 
```

仅检查空单元格的选项设置正确，但“跟踪”功能的实际执行被完全忽略。有没有办法让这种情况自动发生，然后检查测试结果？

功能是“公式选项卡”“错误检查”“公式引用空单元格”“跟踪空单元格”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:54:22.113

这是检查引用空单元格的公式的 VBA 方法。这不仅会告诉您它是哪个公式，还会告诉您哪个单元格是空的。

为了测试这一点，在 Sheet1 中，单元格 A1 输入了这个公式

```
=F1+G1+H1 
```

保持 H1 为空并填充 F1 和 G1

在单元格 A5 中，输入此公式

```
=A1*D5 
```

保持单元格 D5 为空。

现在将此代码粘贴到模块中。

```
Option Explicit

Sub Sample()
    Dim ws As Worksheet
    Dim RngFormulas As Range, fCell As Range, _
    DPrcd As Range, aCell As Range

    Set ws = Sheets("Sheet1")

    With ws
        On Error Resume Next
        Set RngFormulas = .Cells.SpecialCells(xlCellTypeFormulas)
        On Error GoTo 0

        If Not RngFormulas Is Nothing Then
            For Each fCell In RngFormulas
                On Error Resume Next
                Set DPrcd = fCell.DirectPrecedents
                On Error GoTo 0
                If Not DPrcd Is Nothing Then
                    For Each aCell In DPrcd
                        If IsEmpty(aCell.Value) Then
                            Debug.Print aCell.Address & " in " & _
                            fCell.Formula & " is empty"
                        End If
                    Next
                End If
            Next
        End If
    End With
End Sub 
```

运行宏时，您将在即时窗口中看到输出。

**快照**

![在此处输入图像描述](../Images/928ad907b96b1a3d45b83bb047e6d822.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:54:43.770

尝试 =IF(COUNTA(A1:A3),"ok","error") 在数组中查找空白，如果通过，那么您可以做任何其他需要做的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-18T07:03:45.673

我想在我的大型电子表格的每一页上运行公式 > 错误检查，但我也找不到任何 VBA 代码来执行它。

我想出的最好方法是使用 Goto > Special 选择错误，这需要错误处理以忽略未发现错误时发生的错误（并且它不适用于 #N/A 常量）。

```
Dim r As Range

On Error Resume Next
Set r = ActiveCell.SpecialCells(xlCellTypeFormulas, xlErrors)
If Err.Number <> 0 And Err.Number <> 1004 Then Stop
On Error GoTo 0
If Not r Is Nothing Then
    If r.Count > 0 Then
        r.Select
    End If
End If 
```

如果出现 1004“未找到单元格”以外的错误。发生，我并没有比打破宏更能满足它。

# jquery - 引导弹出窗口不适用于heroku

> ID：11299626
> 
> 赞同：0
> 
> 时间：2012-07-02T19:01:43.113
> 
> 标签：jquery, ruby-on-rails, heroku, twitter-bootstrap, precompile

Bootstrap 的弹出框在我的本地机器上运行良好，但似乎不适用于 heroku。我不知道为什么。这是我能想到的相关文件/代码：

```
Bundler.require(*Rails.groups(:assets => %w(development test))) 
```

我也尝试过没有运气的懒惰编译（`Bundler.require(:default, :assets, Rails.env)`）

和弹出视图代码：

```
%img.pop{:alt => "", :src => "#{photo.photo.url(:thumb)}", :rel => 'popover', :'data-placement' => 'bottom', :'data-content' => image_tag(photo.photo.url(:small))} 
```

我的 assets/javascripts 文件夹中有 bootstrap-popover.js。这是我的 application.js 文件：

```
//= require jquery
//= require jquery_ujs
//= require_tree .
//= require bootstrap-popover
//= require bootstrap-alert
//= require bootstrap-dropdown

$(document).ready(function()
{
  $('.pop').popover();
  $('#hp_email_field').focus();

}); 
```

老实说，我什至不确定现在是否打开了预编译。我认为它基于我在这里发布的第一行代码。任何帮助表示赞赏。在本地一切正常

编辑：仅供参考 - 打开惰性编译是让 activeadmin 工作的唯一方法......不知道为什么......所以我重新打开惰性编译

EDIT2：另外，当我查看控制台并尝试 $('.pop').popover(); 它说没有办法……显然它没有正确加载。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:16:21.407

我有一个类似的问题。预编译资产，然后将它们签入 git 并部署到 heroku 为我解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-27T18:54:39.960

还可以尝试启用 Heroku 的 user-env-compile 实验室功能：[https ://devcenter.heroku.com/articles/labs-user-env-compile](https://devcenter.heroku.com/articles/labs-user-env-compile)

# html - 下载部分 HTML 代码

> ID：11299632
> 
> 赞同：1
> 
> 时间：2012-07-02T19:02:10.543
> 
> 标签：html, objective-c, xcode

我正在尝试发布有关 Internet 页面更新的推送通知，但是每分钟再次下载整页（700k）对于用户来说是相当麻烦的。有没有办法只下载页面的特定部分？

据我所知，没有任何方法可以获取有关页面的增量信息。有没有允许这样做的方法？我一天都没有找到（如果有的话，我怎样才能找到我的信息放在首位的某个字节？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:05:11.887

您要做的是学习一些 AJAX 调用的基础知识。

您设置一个自动计时器以重新加载需要更新的 div 内容。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-02T19:13:56.783

您可以像这样使用 Range 标头：

```
Range: bytes=0-1000 
```

这显然会为您提供前 1000 个字节。

# ide - 如何在 Pycharm 中打开语法高亮/着色

> ID：11299635
> 
> 赞同：10
> 
> 时间：2012-07-02T19:02:21.990
> 
> 标签：ide, settings, pycharm

基本上，无论出于何种原因，pycharm 的语法高亮/着色都不起作用；所有文本都显示为纯黑色。尽管根据我的编辑器设置，在 IDE Settings -> Editor -> Colors & Fonts -> General 下，突出显示/着色似乎已打开并正确定义。谁能告诉我如何正确打开它？谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-07-03T18:17:53.997

结帐设置 | 文件类型。可能需要突出显示的文件扩展名注册为文本文件。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-01-31T03:03:40.977

此外，高级语法突出显示/代码检查似乎已损坏，但您必须关闭省电功能才能恢复它们：)

文件>省电模式

# android - Openg GL 2.0 Android 错误 0x501 (GL_INVALID_VALUE)

> ID：11299643
> 
> 赞同：7
> 
> 时间：2012-07-02T19:02:47.290
> 
> 标签：android, opengl-es

我正在尝试在 android 上构建一个小的 Open GL2.0 演示应用程序，但出现以下错误

在日志猫

```
07-02 20:50:40.110: E/libEGL(1252): call to OpenGL ES API with no current context     (logged once per thread)
07-02 20:50:40.110: E/libEGL(1252): call to OpenGL ES API with no current context         (logged once per thread)
07-02 20:50:40.110: E/libEGL(1252): call to OpenGL ES API with no current context     (logged once per thread)
07-02 20:50:40.110: E/libEGL(1252): call to OpenGL ES API with no current context (logged once per thread)
07-02 20:50:40.110: E/libEGL(1252): call to OpenGL ES API with no current context (logged once per thread)
07-02 20:50:40.110: E/libEGL(1252): call to OpenGL ES API with no current context (logged once per thread)
07-02 20:50:40.110: E/libEGL(1252): call to OpenGL ES API with no current context (logged once per thread)
07-02 20:50:40.110: E/libEGL(1252): call to OpenGL ES API with no current context (logged once per thread)
07-02 20:50:40.110: E/libEGL(1252): call to OpenGL ES API with no current context (logged once per thread)
07-02 20:50:40.110: E/libEGL(1252): call to OpenGL ES API with no current context (logged once per thread) 
```

在控制台中

```
[2012-07-02 20:50:44 - Emulator]     development/tools/emulator/opengl/host/libs/Translator/GLES_V2/GLESv2Imp.cpp:glGetAttribLoc    ation:826 error 0x501
[2012-07-02 20:50:44 - Emulator]     development/tools/emulator/opengl/host/libs/Translator/GLES_V2/GLESv2Imp.cpp:glGetUniformLocation:1383 error 0x501 
```

我的代码

看法

```
package limitliss.graphics.play;

import java.nio.ByteBuffer;
import java.nio.ByteOrder;
import java.nio.FloatBuffer;

import javax.microedition.khronos.egl.EGLConfig;
import javax.microedition.khronos.opengles.GL10;

import android.content.Context;
import android.opengl.GLES20;
import android.opengl.GLSurfaceView;
import android.opengl.GLSurfaceView.Renderer;
import android.opengl.GLU;

public class OGLView extends GLSurfaceView implements Renderer {

private int mColorType = 0;

private float rotx = 0.0f;
private float roty = 0.0f;    
Triangle tri = new Triangle();

public OGLView(Context context) {
    super(context);
    setEGLContextClientVersion(2);

    this.setRenderer(this); 
    setRenderMode(GLSurfaceView.RENDERMODE_WHEN_DIRTY);
    // TODO Auto-generated constructor stub
}

public static int loadShader(int type, String shaderCode){

    // create a vertex shader type (GLES20.GL_VERTEX_SHADER)
    // or a fragment shader type (GLES20.GL_FRAGMENT_SHADER)
    int shader = GLES20.glCreateShader(type);

    // add the source code to the shader and compile it
    GLES20.glShaderSource(shader, shaderCode);
    GLES20.glCompileShader(shader);

    return shader;
}

public void onSurfaceCreated(GL10 unused, EGLConfig config) {
    // Set the background frame color
    GLES20.glClearColor(0.5f, 0.5f, 0.5f, 1.0f);
    tri.draw();
}

public void onDrawFrame(GL10 unused) {
    // Redraw background color
    GLES20.glClear(GLES20.GL_COLOR_BUFFER_BIT);
    tri.draw();
}

public void onSurfaceChanged(GL10 unused, int width, int height) {
    GLES20.glViewport(0, 0, width, height);
}
}

Triangle

package limitliss.graphics.play;

import java.nio.ByteBuffer;
import java.nio.ByteOrder;
import java.nio.FloatBuffer;

import javax.microedition.khronos.opengles.GL10;

import android.opengl.GLES20;

public class Triangle {

float color[] = { 0.63671875f, 0.76953125f, 0.22265625f, 1.0f };

private FloatBuffer vertexBuffer;
int mProgram;
int mPositionHandle;
private final String vertexShaderCode =
        "attribute vec4 vPosition;" +
        "void main() {" +
        "  gl_Position = vPosition;" +
        "}";

    private final String fragmentShaderCode =
        "precision mediump float;" +
        "uniform vec4 vColor;" +
        "void main() {" +
        "  gl_FragColor = vColor;" +
        "}";
// number of coordinates per vertex in this array
static final int COORDS_PER_VERTEX = 3;
static float triangleCoords[] = { // in counterclockwise order:
     0.0f,  0.622008459f, 0.0f,   // top
    -0.5f, -0.311004243f, 0.0f,   // bottom left
     0.5f, -0.311004243f, 0.0f};   // bottom right

public Triangle() {
    // initialize vertex byte buffer for shape coordinates
    ByteBuffer bb = ByteBuffer.allocateDirect(
            // (number of coordinate values * 4 bytes per float)
            triangleCoords.length * 4);
    // use the device hardware's native byte order
    bb.order(ByteOrder.nativeOrder());

    // create a floating point buffer from the ByteBuffer
    vertexBuffer = bb.asFloatBuffer();
    // add the coordinates to the FloatBuffer
    vertexBuffer.put(triangleCoords);
    // set the buffer to read the first coordinate
    vertexBuffer.position(0);

    int vertexShader =  OGLView.loadShader(GLES20.GL_VERTEX_SHADER, vertexShaderCode);
    int fragmentShader =  OGLView.loadShader(GLES20.GL_FRAGMENT_SHADER, fragmentShaderCode);

    mProgram = GLES20.glCreateProgram();             // create empty OpenGL ES Program
    GLES20.glAttachShader(mProgram, vertexShader);   // add the vertex shader to program
    GLES20.glAttachShader(mProgram, fragmentShader); // add the fragment shader to program
    GLES20.glLinkProgram(mProgram);    
}

public void draw() {

    // Add program to OpenGL ES environment
    GLES20.glUseProgram(mProgram);

    // get handle to vertex shader's vPosition member
    mPositionHandle = GLES20.glGetAttribLocation(mProgram, "vPosition");

    // Enable a handle to the triangle vertices
    GLES20.glEnableVertexAttribArray(mPositionHandle);

    // Prepare the triangle coordinate data
    GLES20.glVertexAttribPointer(mPositionHandle, COORDS_PER_VERTEX,
                                 GLES20.GL_FLOAT, false,
                                 COORDS_PER_VERTEX, vertexBuffer);

    // get handle to fragment shader's vColor member
    int mColorHandle = GLES20.glGetUniformLocation(mProgram, "vColor");

    // Set color for drawing the triangle
    GLES20.glUniform4fv(mColorHandle, 1, color, 0);

    // Draw the triangle
    GLES20.glDrawArrays(GLES20.GL_TRIANGLES, 0, 3);

    // Disable vertex array
    GLES20.glDisableVertexAttribArray(mPositionHandle);
}

public void render(GL10 gl){

    gl.glPushMatrix();
    gl.glColor4f(this.color[0],this.color[1],this.color[2],this.color[3]); 
    gl.glVertexPointer(3, GL10.GL_FLOAT, 0, vertexBuffer);
    gl.glEnableClientState(GL10.GL_VERTEX_ARRAY);
    gl.glDrawArrays(GL10.GL_TRIANGLE_FAN, 0, 3);
    gl.glDisableClientState(GL10.GL_VERTEX_ARRAY);
    gl.glPopMatrix();
}
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-02T19:17:23.240

您会遇到`call to OpenGL ES API with no current context`错误，因为您是 `Triangle tri = new Triangle();`在 OpenGL 线程之外创建三角形（并且三角形构造函数正在进行 opengl 调用）。只有 OpenGL 回调中的代码（onSurfaceCreated、onDrawFrame 等）在 opengl 线程上执行。

放在`tri = new Triangle()`里面，`onSurfaceCreated`这些错误应该消失。

# asp.net-mvc - 您是否在您的 asp.net mvc 应用程序的控制器或业务服务中捕获了预期的异常

> ID：11299644
> 
> 赞同：2
> 
> 时间：2012-07-02T19:02:49.147
> 
> 标签：asp.net-mvc, exception-handling

我正在开发一个 asp.net mvc 应用程序，其中 user1 可以删除 user2 之前刚刚加载的数据记录。User2 要么更改此不存在的数据记录（更新），要么正在将此数据插入另一个违反外键约束的表中。

你在哪里捕捉到这样的预期异常？

在您的 asp.net mvc 应用程序的控制器中还是在业务服务中？

*只是一个旁注：我只在此处捕获 SqlException，如果它是 ForeignKey 约束异常，以告诉用户另一个用户已删除某个父记录，因此他无法创建测试计划。但是这段代码还没有完全实现！*

**控制器**：

```
public JsonResult CreateTestplan(Testplan testplan)
  {
   bool success = false;
   string error = string.Empty;

   try
  {
   success = testplanService.CreateTestplan(testplan);
   }
  catch (SqlException ex)
   {
   error = ex.Message;
   }
   return Json(new { success = success, error = error }, JsonRequestBehavior.AllowGet);
  } 
```

**或者**

**商业服务：**

```
public Result CreateTestplan(Testplan testplan)
        {
            Result result = new Result();
            try
            {
                using (var con = new SqlConnection(_connectionString))
                using (var trans = new TransactionScope())
                {
                    con.Open();

                    _testplanDataProvider.AddTestplan(testplan);
                    _testplanDataProvider.CreateTeststepsForTestplan(testplan.Id, testplan.TemplateId);
                    trans.Complete();
                    result.Success = true;
                }
            }
            catch (SqlException e)
            {
                result.Error = e.Message;
            }
            return result;
        } 
```

**然后在控制器中：**

```
public JsonResult CreateTestplan(Testplan testplan)
      {
       Result result = testplanService.CreateTestplan(testplan);      
       return Json(new { success = result.success, error = result.error }, JsonRequestBehavior.AllowGet);
      } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T20:14:12.663

应检查并正确显示外键约束违规。您可以轻松检查相关表中的行是否存在并显示正确的消息。行更新也可以这样做。服务器返回受影响的行数，因此您知道会发生什么。

即使您不进行这些检查，您也应该捕获 SQL 异常。对于普通应用程序用户来说，关于违反约束的消息毫无意义。此消息适用于开发人员，您应该使用 ELMAH 或 Log4Net 库记录它。用户应该会看到类似“我们很抱歉。此行可能已被其他用户修改，您的操作无效”的消息。如果他向开发人员询问此事，开发人员应检查日志并查看原因。

**编辑**

我相信你应该检查服务中的错误。控制器不应该知道数据访问层。对于控制器，将数据存储在 SQL 数据库还是文件中都没有关系。文件可以抛出文件访问异常，SQL 有其他的。控制器不应该担心它。您可以在服务中捕获数据访问层异常，并使用服务层专用类型抛出异常。控制器可以捕获它并显示正确的消息。所以答案是：

```
public class BusinessService 
{
    public Result CreateTestplan(Testplan testplan)
    {
        Result result = new Result();
        try
        {
            using (var con = new SqlConnection(_connectionString))
            using (var trans = new TransactionScope())
            {
                con.Open();

                _testplanDataProvider.AddTestplan(testplan);
                _testplanDataProvider.CreateTeststepsForTestplan(testplan.Id, testplan.TemplateId);
                trans.Complete();
                result.Success = true;
            }
        }
        catch (SqlException e)
        {
            ....log in ELMAH or Log4Net using other logging framework...
            throw new ServiceException("We are sorry. Your operation conflicted with another operation in database. It has been cancelled.");
        }
        return result;
    }
} 
```

# c++ - 管理多个并发线程

> ID：11299646
> 
> 赞同：1
> 
> 时间：2012-07-02T19:02:54.243
> 
> 标签：c++, multithreading, c++11, atomic

我正在使用 C++11 线程库在 C++ 中编写一个多线程程序。

我有以下要求：

1.  主线程监听某种类型的事件，并为每个新事件触发一个新线程
2.  当请求程序终止时，新线程的创建被阻塞，我们等待旧线程完成

我可以选择将线程存储在某个容器中，例如列表。在退出之前，容器中的所有线程都被`join()`-ed。但是，由于 STL 容器不是线程安全的，因此在添加新线程和从容器中删除完成的线程时需要额外的同步。在这种情况下，主线程和子线程之间的交互变得有点复杂。子线程是否应该将自己从容器中移除？如果不是，它如何让主线程知道何时删除？等等

我看到的另一种方法是拥有一个原子 int，它在创建子线程时由主线程递增，并在子线程终止之前由子线程递减（线程将`detach()`在创建后 -ed，所以我不必管理任何 std::thread 对象）。在退出之前，我们只需在一个简单的循环中等待原子整数变为 0。这个解决方案对我来说看起来更好，因为移动部件更少并且没有锁定（至少只要目标平台具有无锁实现`std::atomic<int>`）。

所以，我的问题是，您更喜欢上述哪种方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:37:33.553

使用线程计数器将是我的选择，并结合条件等待。退出的最后一个线程应该向条件变量发出信号以唤醒服务员。

```
// the waiter
{
    std::lock_guard<std::mutex> g(threads_lock);
    while (threads > 0) {
        threads_cond.wait(threads_lock);
    }
}
//...

// the threads that are exiting
if (--threads == 0) {
    std::lock_guard<std::mutex> g(threads_lock);
    threads_cond.notify_one();
} 
```

当然，这是假设`threads`是`std::atomic`。

# android - 如何使用 cwac 的 ColorMixer 中的 getColor 方法？

> ID：11299655
> 
> 赞同：0
> 
> 时间：2012-07-02T19:03:34.717
> 
> 标签：android, commonsware-cwac

我正在尝试为 cwac 混色器（[https://github.com/commonsguy/cwac-colormixer](https://github.com/commonsguy/cwac-colormixer)）实现获取颜色方法，但是每次运行此代码时，我都会得到`NullPointerException`：

```
int color = 1;

public void openColor(){
ColorMixer mixer = (ColorMixer)findViewById(R.id.mixer);
  if (color!=1){
    mixer.setColor(color);
  }
  color = mixer.getColor();
} 
```

`color = mixer.getColor();` 是崩溃的线。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:33:24.570

我以前从未使用过这个 Commonsware 组件，但从查看[源代码](https://github.com/commonsguy/cwac-colormixer/blob/master/src/com/commonsware/cwac/colormixer/ColorMixer.java)看来，您需要做的就是设置一个侦听器/回调。此机制将允许您收到有关颜色选择的任何更改的通知。

首先，让您的类实现以下侦听器接口：

```
public interface OnColorChangedListener {
    public void onColorChange(int argb);
} 
```

然后使用以下方法在 ColorMixer 上设置侦听器：

```
public void setOnColorChangedListener(OnColorChangedListener listener) {
    this.listener=listener;
} 
```

如果你全部内联，它看起来有点像这样：

```
mixer.setOnColorChangeListener(new ColorMixer.OnColorChangeListener() {
    @Override public void onColorChange(int argb) {
        //... get the color here; e.g.
        color = argb;
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T17:09:40.477

谢谢 luksprog - 结果它崩溃了，因为我试图在弹出窗口中运行 openColor 方法，而我需要做的不是使用单独的方法，而是输入我的弹出窗口的名称（参见[Android ：弹出和关闭按钮不起作用](https://stackoverflow.com/questions/8595427)）

# facebook - Facebook C# SDK - 服务器流身份验证

> ID：11299657
> 
> 赞同：6
> 
> 时间：2012-07-02T19:03:45.507
> 
> 标签：facebook, facebook-c#-sdk, facebook-login

我正在使用使用 NuGet 安装的 Facebook C# SDK，以允许用户使用 Facebook 登录我的网站。在我找到的所有 C# SDK 文档中，访问令牌都是使用 JavaScript SDK 获得的。我想在不使用 JavaScript SDK 的情况下完成整个身份验证流程服务器端。

1.  对于使用 Facebook C# SDK 完成服务器端身份验证所需遵循的步骤，我在哪里可以找到好的文档或示例代码？

2.  结合 C# SDK 和 JavaScript SDK 有什么好处，还是只坚持服务器端流程？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-08T20:51:46.757

服务器端身份验证与客户端相同，您使用*RedirectUri*和您*AppId*等参数将用户重定向到 OAuth 对话框。然后使用参数*代码将用户重定向到**RedirectUri* ，现在您发出服务器端请求以将代码转换为访问令牌，仅此而已。

 *[阅读http://developers.facebook.com/docs/authentication/server-side/](http://developers.facebook.com/docs/authentication/server-side/)上的服务器端身份验证文档

**如何使用 Facebook C# SDK交换*用户访问令牌的**代码？***

 *```
var fb = new FacebookClient();
dynamic response = fb.Get("oauth/access_token", 
        new
        { 
            client_id = APP_ID,
            redirect_uri = "http://www.example.com/",
            client_secret = SECRET_ID,
            code = CODE
        })
//response.access_token
//response.expires 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T09:41:12.990

var fb = 新的 FacebookClient(); 动态signedRequest = fb.ParseSignedRequest("app_secret", Request.Params["signed_request"]);**

# ruby - AES-256-CBC 从 Ruby 到 NodeJS 的摘要

> ID：11299659
> 
> 赞同：3
> 
> 时间：2012-07-02T19:03:47.283
> 
> 标签：ruby, node.js

我希望有人能对过去几个小时一直困扰我的问题有所了解。

我正在尝试解码已在 Ruby 中编码的字符串，因此：

```
#!/usr/bin/env ruby

require 'base64'
require 'openssl'
require 'openssl/cipher'
require 'openssl/digest'

aes = OpenSSL::Cipher::Cipher.new('aes-256-cbc')
aes.encrypt
aes.key = Digest::SHA256.digest('IHazSekretKey') 

p Base64.encode64( aes.update('text to be encrypted') << aes.final ) 
```

执行上面的吐出：“3P86KyOrN2QJ/HFxxo3b7kAsxTgpDMMjROUPclsuXj0=\n”

我现在尝试在 NodeJS 0.6.17 中解密这个字符串

```
#!/usr/bin/env node

var crypto = require('crypto'); 

function decrypto(toDecryptStr) {
  var result,
    encoded   = new Buffer(toDecryptStr, 'base64'),
    decodeKey = crypto.createHash('sha256').update('IHazSekretKey', 'ascii').digest(),
    decipher  = crypto.createDecipher('aes-256-cbc', decodeKey);

  result = decipher.update(encoded);
  result += decipher.final();

  return result;
};

console.log(decrypto('3P86KyOrN2QJ/HFxxo3b7kAsxTgpDMMjROUPclsuXj0='));
console.log(decrypto('3P86KyOrN2QJ/HFxxo3b7kAsxTgpDMMjROUPclsuXj0=\n') 
```

第二个脚本产生：

```
nazar@xfce:~/tmp/tst$ ./js_decrypt 
Å'{ H£V)ÜB
Å'{ H£V)ÜB 
```

任何帮助都将不胜感激，因为我现在唯一剩下的选择就是把自己淹死在一桶 [Jamerson || 麒麟一番]（我只是在开玩笑）

[PS这里](https://stackoverflow.com/questions/7192401/encrypting-data-with-ruby-decrypting-with-node)有一个关于 SO 的类似问题，遗憾的是，这对我的案例没有任何启发。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-03T11:37:27.687

关键的缺失部分是 IV，当要跨语言边界进行加密/解密时需要它，因为显然加密器将生成一个随机 IV（或类似的东西 - 仍然不明白 Ruby 如何在没有 IV 的情况下解密字符串....但是我知道什么....），如果没有提供。

以下片段显示了如何在 Ruby 中加密字符串并在 NodeJS 中解密。

```
#!/usr/bin/env ruby

require 'openssl'
require 'base64'
require 'openssl/cipher'
require 'openssl/digest'

aes = OpenSSL::Cipher::Cipher.new('aes-256-cbc')
aes.encrypt
aes.key = Digest::SHA256.digest('IHazSekretKey') 
aes.iv  = '1234567890123456'

p Base64.encode64( aes.update('text to be encrypted') << aes.final ) 
```

以上打印：“eiLbdhFSFrDqvUJmjbUgwD8REjBRoRWWwHHImmMLNZA=\n”

```
#!/usr/bin/env node

var crypto = require('crypto'); 

function decrypto(toDecryptStr) {
  var result,
    encoded   = new Buffer(toDecryptStr, 'base64'),
    decodeKey = crypto.createHash('sha256').update('IHazSekretKey', 'ascii').digest(),
    decipher  = crypto.createDecipheriv('aes-256-cbc', decodeKey, '1234567890123456');

  result = decipher.update(encoded);
  result += decipher.final();

  return result;
}

console.log(decrypto('eiLbdhFSFrDqvUJmjbUgwD8REjBRoRWWwHHImmMLNZA=\n')) 
```

JS 脚本现在可以正确解密字符串。

一个不幸的副作用是现有的加密数据将需要解密，然后使用 IV 重新加密，然后在解密实现中使用该 IV。

一个 PITA，但仍然是一个有效的解决方案。

# django - Aptana 更新中断了 Django 调试

> ID：11299661
> 
> 赞同：2
> 
> 时间：2012-07-02T19:03:56.770
> 
> 标签：django, aptana, aptana3

[我根据说明](http://pydev.org/manual_adv_remote_debugger.html)设置了我的 Aptana Studio 3 / PyDev 调试器，甚至达到了一切正常的地步，包括断点和自动重新加载。爱它。现在，截至上周六的更新，调试器不再工作。我注意到

```
Aptana Studio 3/plugins/org.python.pydev.debug_x.x/pysrc 
```

文件夹不见了。我找到了另一个`pysrc`文件夹

```
Aptana Studio 3/plugins/org.python.pydev_x.x 
```

它似乎包含所需的`pydevd`模块，以及`patch_django_autoreload()`功能和所有内容。但是如果我把它放在 Python 路径上，我只会得到一个丑陋的堆栈跟踪，以

```
OSError: [Errno 2] No such file or directory 
```

任何想法这里出了什么问题？在 OS X 10.7.4 上使用 Aptana Studio 3.2.0.201206251729、Django 1.3.1、Python 2.7.1。

**编辑**完整的追溯：

```
Executing process on new console: /usr/bin/python /Users/timo/Documents/aptana-studio-3-workspace/ssm/ssd/manage.py runserver 0.0.0.0:8000
Warning: to actually kill the created console, the parent process (in Eclipse console) must be killed first.
Traceback (most recent call last):
  File "/Users/timo/Documents/aptana-studio-3-workspace/ssm/ssd/manage.py", line 22, in <module>
    execute_manager(settings)
  File "/Library/Python/2.7/site-packages/django/core/management/__init__.py", line 438, in execute_manager
    utility.execute()
  File "/Library/Python/2.7/site-packages/django/core/management/__init__.py", line 379, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/Library/Python/2.7/site-packages/django/core/management/base.py", line 191, in run_from_argv
    self.execute(*args, **options.__dict__)
  File "/Library/Python/2.7/site-packages/django/core/management/base.py", line 220, in execute
    output = self.handle(*args, **options)
  File "/Library/Python/2.7/site-packages/django/core/management/commands/runserver.py", line 67, in handle
    self.run(*args, **options)
  File "/Library/Python/2.7/site-packages/django/core/management/commands/runserver.py", line 76, in run
    autoreload.main(self.inner_run, args, options)
  File "/Applications/Aptana Studio 3/plugins/org.python.pydev_2.6.0.2012062121/pysrc/pydevd.py", line 1175, in main
    return original_main(main_func, args, kwargs)
  File "/Library/Python/2.7/site-packages/django/utils/autoreload.py", line 138, in main
    reloader(main_func, args, kwargs)
  File "/Library/Python/2.7/site-packages/django/utils/autoreload.py", line 116, in python_reloader
    sys.exit(restart_with_reloader())
  File "/Applications/Aptana Studio 3/plugins/org.python.pydev_2.6.0.2012062121/pysrc/pydevd.py", line 1212, in restart_with_reloader
    popen = subprocess.Popen(args, env=new_environ)
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/subprocess.py", line 672, in __init__
    errread, errwrite)
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/subprocess.py", line 1202, in _execute_child
    raise child_exception
OSError: [Errno 2] No such file or directory 
```

**编辑 2**一些更多的调试信息，根据要求：

```
args: ['xterm', '-e', '/usr/bin/python', '/Users/timo/Documents/aptana-studio-3-workspace/ssm/ssd/manage.py', 'runserver', '0.0.0.0:8000']

new_environ: {'PYTHONIOENCODING': 'UTF-8', 'RUN_MAIN': 'true', 'VERSIONER_PYTHON_PREFER_32_BIT': 'no', 'LOGNAME': 'timo', 'USER': 'timo', 'PATH': '/usr/bin:/bin:/usr/sbin:/sbin', 'HOME': '/Users/timo', 'DISPLAY': '/tmp/launch-Hsa1eC/org.x:0', 'SHELL': '/bin/bash', 'TZ': 'Europe/Vienna', 'VERSIONER_PYTHON_VERSION': '2.7', 'SECURITYSESSIONID': '186a5', 'GL_ENABLE_DEBUG_ATTACH': 'YES', 'PYDEV_CONSOLE_ENCODING': 'UTF-8', 'com.apple.java.jvmTask': 'JNI', 'PYTHONPATH': '/Applications/Aptana Studio 3/plugins/org.python.pydev_2.6.0.2012062121/pysrc/pydev_sitecustomize:/Users/timo/Documents/aptana-studio-3-workspace/ssm/ssd:/Applications/Aptana Studio 3/plugins/org.python.pydev_2.6.0.2012062121/pysrc:/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python27.zip:/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7:/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-darwin:/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac:/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac/lib-scriptpackages:/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python:/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-tk:/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-old:/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-dynload:/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python/PyObjC:/Library/Python/2.7/site-packages:/Applications/Aptana Studio 3/plugins/org.python.pydev.debug_2.4.0.2012020116/pysrc', 'SSH_AUTH_SOCK': '/tmp/launch-ILkkCc/Listeners', 'CELERY_LOADER': 'djcelery.loaders.DjangoLoader', 'Apple_PubSub_Socket_Render': '/tmp/launch-GuOmAI/Render', 'TMPDIR': '/var/folders/yw/7q8d2tzj70q1yqwwqhgkqsw00000gn/T/', 'APP_ICON_844': '../Resources/aptana.icns', 'PYDEV_COMPLETER_PYTHONPATH': '/Applications/Aptana Studio 3/plugins/org.python.pydev_2.6.0.2012062121/pysrc', '__CF_USER_TEXT_ENCODING': '0x1F5:0:0', 'Apple_Ubiquity_Message': '/tmp/launch-lxY2Pu/Apple_Ubiquity_Message', 'DJANGO_SETTINGS_MODULE': 'ssd.settings', 'COMMAND_MODE': 'unix2003'} 
```

这里有两点需要注意。1）我试图检查 PYTHONPATH 上的所有内容是否确实存在。大部分情况都是这样，除了`/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python27.zip`and `/Applications/Aptana Studio 3/plugins/org.python.pydev.debug_2.4.0.2012020116/pysrc`，这让我想知道我是否只需要让 Aptana 重新扫描 Python 目录。2) Aptana 应用程序路径包含空格（默认情况下）。我见过一些罕见的情况，任何类型的图书馆仍然对此感到窒息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T11:55:40.660

org.python.pydev.debug/pysrc 真的被删除了（正确的是你发现的 org.python.pydev/pysrc）......将更新主页以反映这一点:)

所以，有了这个它应该可以工作......现在，至于你的错误，请发布完整的错误日志（只有那部分，很难知道可能发生了什么 - 用那个路径在这里测试它并且它确实有效适当地）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-30T08:30:20.567

我也遇到了这个问题，刚刚升级到 PyDev 3.4.1，它为我解决了问题。如果您仍然遇到问题，请通读[http://pydev.org/manual_adv_debug_console.html 。](http://pydev.org/manual_adv_debug_console.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T15:10:04.570

不确定是否相关，但我使用 pydev 将 eclipse 从 3.6 升级到 4.2，将 Aptana 从 2 升级到 3 现在我的调试器无法正常工作。[升级 eclipse、aptana、pydev、Debugger 后不工作](https://stackoverflow.com/questions/11388503)

# php - PHPExcel 和文本换行

> ID：11299663
> 
> 赞同：60
> 
> 时间：2012-07-02T19:04:11.183
> 
> 标签：php, mysql, database, phpexcel

我知道这行代码将使单元格文本换行：

```
$objPHPExcel->getActiveSheet()->getStyle('D1')->getAlignment()->setWrapText(true); 
```

'D1' 是选定的单元格。

有没有办法让整个 Excel 工作表自动包装所有内容，而不是对我需要包装的每个单元格使用此代码？

或者是否有更好的实践技术可用于指定列？

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2012-07-02T20:06:56.280

应用于一个范围：

```
$objPHPExcel->getActiveSheet()->getStyle('D1:E999')
    ->getAlignment()->setWrapText(true); 
```

应用于列

```
$objPHPExcel->getActiveSheet()->getStyle('D1:D'.$objPHPExcel->getActiveSheet()->getHighestRow())
    ->getAlignment()->setWrapText(true); 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2015-11-12T06:23:03.217

```
$objPHPExcel->getDefaultStyle()->getAlignment()->setWrapText(true); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-10T07:36:09.817

应用于列

```
$highestRow = $$objPHPExcel->getActiveSheet()->getHighestRow();
for ($row = 1; $row <= $highestRow; $row++){
    $sheet->getStyle("D$row")->getAlignment()->setWrapText(true);
} 
```

# c# - 无状态 WCF 服务和数据库连接池

> ID：11299666
> 
> 赞同：2
> 
> 时间：2012-07-02T19:04:39.427
> 
> 标签：c#, wcf

之前在 StackOverflow 中已经提出过这个问题，但根据我的经验，答案实际上是错误的。至少对于 .NET Framework 4.0 和 SQL Server 2005，它们是错误的。

我需要帮助才能一劳永逸地解决这个问题。

问题是 - 无状态 WCF 服务可以以某种方式使用数据库连接池吗？

请参阅[无状态 WCF 服务是否可以...](https://stackoverflow.com/questions/2746128/can-a-stateless-wcf-service-benefit-from-built-in-database-connection-pooling)

较早的答案基本上表明与任何其他 ADO.NET 方案没有问题并且没有区别。但是，我一直无法获得无状态 WCF 服务来使用连接池，而我可以看到它总是在 WCF 服务之外工作。无论我尝试使用什么连接字符串或参数，它都不会这样做。

数据库连接池是默认启用的，所以一个简单的连接字符串应该可以让我到达那里，例如在 SQL Server Express 上：

```
SqlConnection sqlCn = new SqlConnection("Data Source=SERVER\SQLEXPRESS; Initial Catalog = xDB; Integrated Security = SSPI;") 
```

使用此连接，在 Windows 窗体应用程序中，如果我连续执行 3 轮`sqlCn.Open()`-- 查询数据库 -- `sqlCn.Close()`，我会在第一轮得到很长的延迟（例如 2 秒）`sqlCn.Open()`，并且在查询和打开时完全没有延迟/ 之后关闭。正是我对数据库连接池的期望。

但是，如果我对包含相同代码的 WCF 服务进行 3 次调用`sqlCn.Open()`——查询数据库——`sqlCn.Close()`代码，那么每次调用都会出现 2 秒的初始缓慢启动。

我的猜测是连接池完全由我的代码创建的 ADO.NET 对象控制，并且由于我正在实例化我`SqlConnection`在 WCF 服务中使用的任何 ADO.NET 类（例如等），因此它们在我的服务调用时被破坏结束了，连接池也随之而来。

这可能不是真的，但如果不是，我所做的有什么问题吗？

有人有这方面的经验吗？

（请在发布前测试任何假设或理论）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T16:06:27.160

我设法自己解决了。

我必须在我的连接字符串中明确声明“Pooling = true”（并添加一个非零的“Min Pool Size”）。然后它一直在工作。如果没有设置，它有时实际上会按预期工作，但大多数情况下不会。

我还使用不同的用户帐户对其进行了测试（使用用户名/密码的 SQL Server 身份验证与“集成安全性 = SSPI”）。只要您设置“Pooling = true”，这两种方法都适用于 WCF 服务。

如果这只是我的安装/SQL Server 版本/ADO.NET 版本的问题，则没有数据，但确实需要很长时间才能解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:13:17.217

1）这是文档：

> [http://msdn.microsoft.com/en-us/library/8xx3tyca.aspx](http://msdn.microsoft.com/en-us/library/8xx3tyca.aspx)
> 
> 首次打开连接时，会根据精确匹配算法创建连接池，该算法将池与连接中的连接字符串相关联。每个连接池都与一个不同的连接字符串相关联。打开新连接时，如果连接字符串与现有池不完全匹配，则会创建一个新池。每个进程、每个应用程序域、每个连接字符串以及在使用集成安全性时，每个 Windows 身份都将连接池化。连接字符串也必须完全匹配；以不同顺序为同一连接提供的关键字将分别汇集。

2) 对于同一个链接，“默认情况下，ADO.NET 中启用了连接池。”

3) 这与所讨论的 WCF 调用是否是无状态的完全无关。

4）最后：

> 我们强烈建议您在使用完连接后始终关闭连接，以便将连接返回到池中。您可以使用 Connection 对象的 Close 或 Dispose 方法，或者通过在 C# 中的 using 语句或 Visual Basic 中的 Using 语句中打开所有连接来执行此操作。未明确关闭的连接可能不会添加或返回到池中。

# opengl - 什么是加载 OBJ 文件以与 openGL 一起使用的好算法？

> ID：11299670
> 
> 赞同：1
> 
> 时间：2012-07-02T19:04:57.283
> 
> 标签：opengl

对于一个小游戏，我正在尝试编写一个 OBJ 文件加载器来加载用于 openGL 的模型。

OBJ 文件格式的一个很好的特点是它可以通过在定义面时通过索引引用它们来重用相同的顶点。OpenGL 又具有以类似方式组织的顶点缓冲区对象（VBO）；有一个几何数据缓冲区和一个索引缓冲区。

VBO 没有无限的空间，所以它们只能被填满，直到`GL_MAX_ELEMENTS_VERTICES`，据我了解，你最终会受到严重的性能损失。

我一直在寻找一种算法，它可以填充这些 VBO 缓冲区，同时尽可能多地保持来自 OBJ 的重用几何数据，同时尊重 `GL_MAX_ELEMENTS_VERTICES / GL_MAX_ELEMENTS_INDICES`.

有没有什么好的方法或算法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-08T11:46:31.223

您可以保留来自`.obj`顶点共享的数据。这是从顶点缓冲区加载数据`.obj`并为顶点缓冲区生成顶点/面的代码：

```
int FaceIndex = 0;
int VertexIndex = 1;
int TextureVertexIndex = 1;

char Prefix[3];

float X, Y, Z;
int A1, A2, A3, B1, B2, B3, C1, C2, C3, D1, D2;

while ( !IStream->Eof() )
{
    std::string Line = IStream->ReadLine();

    int NumRead = sscanf( Line.c_str(), "%2s %f %f %f", Prefix, &X, &Y, &Z );

    if ( NumRead < 1 ) continue;

    switch ( Prefix[0] )
    {
    case '#':
        continue; 
```

生成单个顶点。这些可以在多个面之间共享：

```
 case 'v':
        {
            switch ( Prefix[1] )
            {
            case 0:
                if ( NumRead != 4 ) continue;
                EmitVertex( VertexIndex++, vec3( X, Y, Z ), -1, -1 );
                break;
            case 't':
                if ( NumRead != 3 ) continue;
                EmitTextureVertex( TextureVertexIndex++, vec3( X, 1.0f-Y, 0.0f ) );
                break;
            case 'n':
                if ( NumRead != 4 ) continue;
                EmitNormal( VertexIndex, vec3( X, Y, Z ) );
                break;
            }
        }
        break; 
```

使用索引生成具有纹理坐标的面：

```
 case 'f':
        {
            if ( sscanf( Line.c_str(), "%2s %d/%d %d/%d %d/%d %d/%d", Prefix, &A1, &A2, &B1, &B2, &C1, &C2, &D1, &D2 ) == 9 )
            {
                A3 = B3 = C3 = 0;
                EmitTextureFace( FaceIndex, A2, B2, D2 );
                EmitFace( FaceIndex++, A1, B1, D1, -1, -1 );
                EmitTextureFace( FaceIndex, B2, C2, D2 );
                EmitFace( FaceIndex++, B1, C1, D1, -1, -1 );
            }
            else if ( sscanf( Line.c_str(), "%2s %d/%d/%d %d/%d/%d %d/%d/%d", Prefix, &A1, &A2, &A3, &B1, &B2, &B3, &C1, &C2, &C3 ) == 10 )
            {
                EmitTextureFace( FaceIndex, A2, B2, C2 );
                EmitFace( FaceIndex++, A1, B1, C1, -1, -1 );
            }
            else if ( sscanf( Line.c_str(), "%2s %d//%d %d//%d %d//%d", Prefix, &A1, &A3, &B1, &B3, &C1, &C3 ) == 7 )
            {
                A2 = B2 = C2 = 0;
                EmitFace( FaceIndex++, A1, B1, C1, -1, -1 );
            }
            else if ( sscanf( Line.c_str(), "%2s %d/%d %d/%d %d/%d", Prefix, &A1, &A2, &B1, &B2, &C1, &C2 ) == 7 )
            {
                A3 = B3 = C3 = 0;
                EmitTextureFace( FaceIndex, A2, B2, C2 );
                EmitFace( FaceIndex++, A1, B1, C1, -1, -1 );
            }

        }
        break;
    }
} 
```

# python - 将 SIGINT/^C 传递给池中的孩子？

> ID：11299672
> 
> 赞同：2
> 
> 时间：2012-07-02T19:05:07.237
> 
> 标签：python, process, multiprocessing, pool, python-2.x

我有以下代码（只是测试有关 Pool 类的一些假设）：

```
#!/usr/bin/env python
from time import sleep
from multiprocessing import Pool

def run_process(args):
    print "Sleeping %d seconds" % (args * 2)
    sleep(args * 2)
    print "Slept %d seconds" % (args * 2)

def main():
    test = [1,2,3,1,2,3,1,2,3]
    pool = Pool()
    pool.map_async(run_process, test).get()

if __name__ == '__main__':
    main() 
```

最终`test`将成为要传递给每个调用的参数列表，`run_process`以便它产生一个命令（即一个单独的进程）。

现在，当我按下`Ctrl`+`C`时，不幸的是它甚至没有拆除直接的子进程（从文档中听起来像是`Pool`创建了简单的子进程）。终端上发生的事情（Ubuntu 10.04，Python 2.6.5，如果这很重要）是`^C`每当我按下它时我都会看到回声，但是当所有孩子都应该退出“工作”时，父母也不会及时死亡（即睡眠）我也无法在不杀死父进程的情况下回收终端。

我如何调整我的脚本，以便它会拆除直接的孩子（以及后来产生的命令）？我想我正在尝试使用`multiprocessing.Pool.close()`和`multiprocessing.Pool.terminate()`来自信号处理程序？！

注意：我故意在这里使用进程而不是线程，所以如果解决方案考虑到这一点，我将不胜感激。

* * *

[这是我在阅读完这个问题](https://stackoverflow.com/questions/1408356)的答案后尝试过的一件事，但它遇到了同样的问题：

```
#!/usr/bin/env python
from signal import signal
from time import sleep
from multiprocessing import Pool

def init_worker():
    import signal
    signal(signal.SIGINT, signal.SIG_IGN)

def run_process(args):
    print "Sleeping %d seconds" % (args * 2)
    sleep(args * 2)
    print "Slept %d seconds" % (args * 2)

def main():
    test = [1,2,3,1,2,3,1,2,3]
    try:
        pool = Pool()
        pool.map_async(run_process, test).get()
    except KeyboardInterrupt:
        pool.terminate()
        pool.wait()

if __name__ == '__main__':
    main() 
```

* * *

添加一个非常大的超时（作业可以运行数周，因此超时必须足够大以覆盖它）`Pool.get()`似乎允许我使用`Ctrl`+ `C`，尽管输出有些令人困惑：

```
Traceback (most recent call last):
  File "./test.py", line 26, in <module>
    main()
  File "./test.py", line 23, in main
    pool.wait()
AttributeError: 'Pool' object has no attribute 'wait' 
```

摆脱`try`/后`except`，回溯看起来“更自然”。因此，诀窍是将原始脚本的行更改为`pool.map_async(run_process, test).get()`类似于`pool.map_async(run_process, test).get(999999)`where `999999`is a timeout 大到足以满足您的目的。

# sql - 如何将 H2 主键 ID 设置为 auto_increment？

> ID：11299675
> 
> 赞同：9
> 
> 时间：2012-07-02T19:05:15.010
> 
> 标签：sql, jpa-2.0, playframework-2.0, auto-increment

我正在使用 sql，H2，并且我正在尝试使 Usertable 的 ID 为 auto_incremented。我在 H2 sql 界面中尝试了所有 sql 命令，但没有成功。

```
alter table user alter column int not null auto_increment; 
```

这个常见的甚至不起作用。是否有任何 JPA 的 auto_incement 注释可能是？

多谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-02T21:18:09.083

您应该使用 JPA 注释`@Id`和`@GeneratedValue`您的 ID。

您的 SQL 看起来有效。您可以发布错误消息吗？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-07-11T12:50:17.430

我有同样的问题。我不确定根本原因是否相同。但后来出现了一个完全合乎逻辑的解释。所以这就是我发现的。

首先，至少有两种不同的方法来创建自动递增的键。

## **第一种方式：（xml）**

如果您使用包含类信息的基于 xml 的配置。然后您可以在您的 classname.hbm.xml 文件中添加如下内容。

```
<id name="id">
    <generator class="sequence"><param name="sequence">my_id_seq</param</generator>
</id> 
```

要导入此文件，您的 hibernate.cfg.xml 文件中将包含以下内容：（或可能带有资源属性）

```
<!--  Mapping files  -->
<mapping file="classname.hbm.xml"/> 
```

但这里重要的是，现在实际上是 JAVA 将增加键。如果您检查了用于生成表的 sql，您会注意到它没有为 id 列保存自动递增的字段定义。

## **第二种方式：（注释）**

一种完全不同的做事方式是将所有内容都放在注释中，就像您在问题中显示的那样。

```
@GeneratedValue(strategy=GenerationType.IDENTITY) 
```

在您的 hibernate.cfg.xml 文件中，您将拥有如下内容：

```
<!--  Mapping files  -->
<mapping class="package.subpackage.MyClassName"/> 
```

GenerationType.IDENTITY 确实是默认值，因此您不必提供它本身。但无论如何，这次表格的生成方式会有所不同。即如下：

```
CREATE CACHED TABLE PUBLIC.MYTABLENAME(
    ID INTEGER DEFAULT 
    (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_9DE2A0D5_28F5_488F_9E4C_2878B3CDA72F) 
    NOT NULL NULL_TO_DEFAULT SEQUENCE
    PUBLIC.SYSTEM_SEQUENCE_9DE2A0D5_28F5_488F_9E4C_2878B3CDA72F, 
...
) 
```

啊哈！那很有意思。这次序列生成将不会由 JAVA 执行，而是由数据库本身执行。

## **什么地方出了错：**

当然，我们都在尝试和尝试。如果您首先决定使用 xml 文件，然后您最终决定使用注释。那么当然这意味着你也必须重新生成你的表。如果你忘记这样做，那么你会得到像 doniyor 那样的错误。

## **如何修复它：**

只需将以下行添加到您的 hibernate.cfg.xml 并重新启动您的应用程序。

```
<!-- Drop and re-create the database schema on startup -->
<property name="hibernate.hbm2ddl.auto">create</property> 
```

该表已被销毁并重新生成。

# qml - ListView 突出显示项目未显示

> ID：11299677
> 
> 赞同：5
> 
> 时间：2012-07-02T19:05:31.107
> 
> 标签：qml, model-view

我试图在 ListView 中突出显示当前选定的项目。下面是我正在使用的代码；出于某种原因，虽然类似的代码在此应用程序的另一个 ListView 中完美运行，但此处的 SelectedRectangle 项从未显示，尽管所选项目应更改时。

```
Rectangle {
    id: deviceTree
    width: (window.width * 2) / 3
    height: 400

    border {
        width: 2
        color: "black"
    }

    ListView {
        id: deviceTreeView

        model: deviceTreeModel
        delegate: deviceTreeDelegate
        highlight: SelectionRectangle {}

        anchors.fill: parent
        anchors.margins: 6
    }

    Component {
        id: deviceTreeDelegate

        Rectangle {
            border.color: "#CCCCCC"
            width: deviceTree.width
            height: 30

            smooth: true
            radius: 2

            MouseArea {
                anchors.fill: parent
                onClicked: { deviceTreeView.currentIndex = index; window.selectedDeviceChanged(deviceName) }
            }
        }
    }
} 
```

选定矩形.qml

```
Rectangle
{
    id: selectionRectangle

    color: "lightsteelblue"
    smooth: true
    radius: 5
} 
```

解决方案： deviceTreeDelegate 中的矩形默认为白色，并与选择矩形重叠。使用该属性将其设置为透明，以便可以看到选择。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-04T10:34:47.330

这是因为默认的 Rectangle 颜色为白色，并且高光堆叠在委托下方。将 Rectangle 颜色设置为“透明”将允许突出显示通过代理可见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T22:05:33.157

Your code gets two mistakes :

1.  The component for the highlight property. The name of the type of the component is the same than the name of the QML file where it is defined. You defined it in a file named SelectedRectangle.qml so you have to write `highlight: SelectionRectangle {}` in your main QML file
2.  The type of the highlight member is Component. So the component that you use for this member should have got a type which inherits Component. Or you use a QML component that inherits Rectangle and Rectangle does not inherit Component. You should enclose your SelectedRectangle in a Component object, just like you did for the delegate.

Finally, you should write something like this for your highlight component :

```
highlight: Component {
    SelectedRectangle {}
} 
```

# asp.net-mvc-4 - 任何收集都会导致 Asp.Net MVC 4 RC Web API 中出现 500 状态代码的静默失败

> ID：11299678
> 
> 赞同：1
> 
> 时间：2012-07-02T19:05:34.880
> 
> 标签：asp.net-mvc-4, asp.net-web-api

我完全不知道可能导致这种情况的原因。

我有一个 ASP.Net MVC 4 RC 应用程序和一组 Web API 控制器。我正在尝试返回一个包含 IList 中的一组子对象的对象。每当我请求该对象时，我都会在浏览器上返回 500 错误，而调试器中没有抛出明显的异常。我尝试在 global.asax 中放置一个 Application_Error 处理程序，也没有发现任何错误。

无论 List 是实际的数据库关系还是只是硬编码的字符串列表都没有关系，无论哪种情况，请求都会失败。如果我将列表设置为空，则请求成功。

如果我删除列表，则请求成功，并且我得到对象的 XML（或 JSON）表示。

我也试过这条线 -

```
GlobalConfiguration.Configuration.IncludeErrorDetailPolicy = IncludeErrorDetailPolicy.Always; 
```

捕获实际的异常并且仍然​​没有得到任何回报。

这是当前对象

```
public class Authority : IEntity
{
    public virtual int Id { get; set; }
    public virtual string Name { get; set; }
    public virtual string Address1 { get; set; }
    public virtual string Address2 { get; set; }
    public virtual string City { get; set; }
    public virtual string County { get; set; }
    public virtual string State { get; set; }
    public virtual string ContactPostalCode { get; set; }

    //public virtual IList<PostalCode> PostalCodes { get; set; }
    public virtual IList<string> RandomTrash { get; set; }

    public VPA()
    {
        //PostalCodes = new List<PostalCode>();
        RandomTrash = new List<string> {"foo"};
    }
} 
```

注意注释掉的 PostalCodes 集合——这是一个真正的多对多数据库关系。我将其注释掉并用虚拟的“RandomTrash”集合替换它，失败似乎是一样的。

我觉得这是一个序列化失败，但我不知道如何避免它。如果有帮助，我将使用 NHibernate 作为 ORM。

有人见过这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T00:47:31.463

回答我自己的问题，以防有人再次遇到这个问题。

它最终在循环中跟随网格进行序列化。为了解决这个问题，我在其中一个模型中的每个循环引用中添加了 2 个属性。

[IgnoreDataMember] 用于 XML 序列化器 [JsonIgnore] 用于 JSON.Net 的序列化器。

我在 IList 属性上添加了 PostalCode 类。

可能有更好的解决方案。这个的缺点是它使我的 API 偏向一边。我可以请求一个授权并获取它的所有邮政编码，但我不能请求一个邮政编码并获取它的所有授权。

# symfony1 - Symfony 在链接提交中将表单数据放入 sfRequest

> ID：11299680
> 
> 赞同：0
> 
> 时间：2012-07-02T19:05:42.267
> 
> 标签：symfony1, symfony-1.4, symfony-forms

使用 Symfony，我在后端创建了一个表单。我有一个提交按钮，用于保存表单。我需要向应该发送表单数据（如提交按钮）的表单添加另一个链接（除了提交按钮）。通过此链接，我将通过控制器中的另一种方法处理提交的数据。

我试过`link_to('Link', '/backend_dev.php/question/edit?id='.$question->getId(), array('post' => true))`and `link_to('Link', '/backend_dev.php/question/edit?id='.$question->getId(), array('method' => 'post'))`，但是这些函数不发送表单数据。

**控制器**

```
public function executeSave(sfWebRequest $request)
{
    $this->form = new SomeForm(SomePeer::retrieveByPk($request->getParameter('id')));
    if($request->isMethod('post'))
    {
        $this->form->bind($request->getParameter('some'), $request->getFiles('some'));
        if ($this->form->isValid())
        {
            $some = $this->form->save();
            $this->redirect('some/edit?id='.$some->getId());
        }
    }
}

public function executeLink(sfWebRequest $request)
{
    // Like executeSave I need form data here
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-03T07:05:34.837

在链接上使用带有 onClick 事件的 jQuery，这将更改`action`表单的属性并提交它。假设链接有一个 id`myLink`和形式一个 id `myForm`：

```
$('#myLink').click(function(e){
    $('#myForm').attr('action','<?php echo '/backend_dev.php/question/edit?id='.$question->getId()?>';
    $('#myForm').submit();
    e.preventDefault();
}); 
```

# c# - 对视频蒙太奇应用程序的建议（从播放列表中提取和播放随机短片）？

> ID：11299681
> 
> 赞同：0
> 
> 时间：2012-07-02T19:05:44.850
> 
> 标签：c#, .net, video, directx, vlc

我是一名电子工程师，习惯于在嵌入式 C 和汇编中进行编码，但我决定开始学习 C#、.NET 等更高级的东西，这样我就可以开始制作软件作为一种爱好。我对我的第一个项目有一个好主意，但是在连续几天搜索了几个论坛之后，我真的不知道什么是最简单的前进道路。

我希望创建的功能与照片幻灯片的想法非常相似，但适用于视频。该程序将打开一个播放列表或一个充满视频的文件夹，然后以随机顺序播放视频，从随机起始位置开始，并具有固定的持续时间（例如 10 秒）。您最终将能够观看一种“视频蒙太奇”，其中包含来自播放列表中视频随机部分的小剪辑，以随机顺序显示，直到程序关闭。

有很多方法可以解决这个问题：

*   开发具有显示“视频幻灯片”的固定功能的独立视频播放器。DirectX 具有 Microsoft.DirectX.AudioVideoPlayback API，这可能是一个很好的起点。我在这里找到了一个例子：[http ://www.dreamincode.net/forums/topic/111181-adding-video-to-an-application/](http://www.dreamincode.net/forums/topic/111181-adding-video-to-an-application/)
*   修改开源项目以添加所需的功能。我看过一些很酷的项目可以让我开始，比如这个简单的 C# 电影播放器​​：http: [//www.codeproject.com/Articles/18552/C-Movie-Player](http://www.codeproject.com/Articles/18552/C-Movie-Player)
*   使用脚本接口在现有媒体播放器（如 VLC 或 Winamp）上实现此功能。你也可以通过 C# 控制 VLC，就像这里的例子：[Controlling VLC via c#](https://stackoverflow.com/questions/10043922/controlling-vlc-via-c-sharp)

我意识到，对于大多数人来说，显而易见的答案是“使用你最喜欢的任何东西”，但由于我是一个纯粹的初学者，我对特定的语言或开发环境并没有任何忠诚。所以，我只是好奇是否有人知道对于初学者来说什么是最不痛苦的选择。

我也很抱歉，这不是一个非常具体的编程问题。我只是在试水以站稳脚跟。希望一旦我开始这个项目，我将能够回来并发布更多智能和相关的问题！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:14:19.883

虽然您的背景会帮助您学习 C#，但我建议您研究类似[的](http://www.codeproject.com/Articles/20478/A-simple-WPF-media-player-with-media-item-list)内容并将 WPF 用于媒体播放器。然后，您可以使用后台工作程序控制媒体播放器，以停止视频或将下一个视频排队。其他一些对您有用的 .NET 概念是 FileInfo 和 DirectoryInfo 对象，为您提供有关文件的必要信息。我不确定您是否有使用 .NET 中的通用数据结构的经验，但`System.Collections.Generic`命名空间将是一个开始了解您想要保留播放列表的数据结构的好地方。WPF 也将能够帮助您在视频剪辑之间进行转换。

诚然，通过了解 MVVM 或 MVC 设计模式，WPF 会更容易，但我认为您将能够使某些东西正常工作，而无需提前深入研究。

# iphone - 以编程方式截取结合 OpenGL 和 UIKit 元素的屏幕截图

> ID：11299682
> 
> 赞同：5
> 
> 时间：2012-07-02T19:05:45.787
> 
> 标签：iphone, objective-c, ios5, screenshot

我想知道是否有人可以提供一个示例，说明如何截取混合 OpenGL 和 UIKit 元素的屏幕截图。自从 Apple 将`UIGetScreenImage()`其私有化以来，这已成为一项相当困难的任务，因为 Apple 用来替换它的两种常用方法仅捕获 UIKit 或仅捕获 OpenGL。

[这个](https://stackoverflow.com/questions/6197137/take-screen-programmatically-of-uiviewglview)类似的问题引用了[Apple 的 Technical Q&A QA1714](http://developer.apple.com/library/ios/#qa/qa1714/_index.html)，但 QA 仅描述了如何处理来自相机和 UIKit 的元素。您如何将 UIKit 视图层次结构渲染到图像上下文中，然后在其上绘制 OpenGL ES 视图的图像，就像类似问题的答案所暗示的那样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T19:43:52.243

这应该可以解决问题。基本上将所有内容渲染到 CG 并创建一个你可以做任何事情的图像。

```
// In Your UI View Controller

- (UIImage *)createSavableImage:(UIImage *)plainGLImage
{    
    UIImageView *glImage = [[UIImageView alloc] initWithImage:[myGlView drawGlToImage]];
    glImage.transform = CGAffineTransformMakeScale(1, -1);

    UIGraphicsBeginImageContext(self.view.bounds.size);

    //order of getting the context depends on what should be rendered first.
    // this draws the UIKit on top of the gl image
    [glImage.layer renderInContext:UIGraphicsGetCurrentContext()];
    [someUIView.layer renderInContext:UIGraphicsGetCurrentContext()];

    UIImage *finalImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    // Do something with resulting image 
    return finalImage;
}

// In Your GL View

- (UIImage *)drawGlToImage
{
    // Draw OpenGL data to an image context 

    UIGraphicsBeginImageContext(self.frame.size);

    unsigned char buffer[320 * 480 * 4];

    CGContextRef aContext = UIGraphicsGetCurrentContext();

    glReadPixels(0, 0, 320, 480, GL_RGBA, GL_UNSIGNED_BYTE, &buffer);

    CGDataProviderRef ref = CGDataProviderCreateWithData(NULL, &buffer, 320 * 480 * 4, NULL);

    CGImageRef iref = CGImageCreate(320,480,8,32,320*4, CGColorSpaceCreateDeviceRGB(), kCGImageAlphaLast, ref, NULL, true, kCGRenderingIntentDefault);

    CGContextScaleCTM(aContext, 1.0, -1.0);
    CGContextTranslateCTM(aContext, 0, -self.frame.size.height);

    UIImage *im = [[UIImage alloc] initWithCGImage:iref];

    UIGraphicsEndImageContext();

    return im;
} 
```

然后，创建一个屏幕截图

```
UIImage *glImage = [self drawGlToImage];
UIImage *screenshot = [self createSavableImage:glImage]; 
```

# c++ - C++ 循环遍历目录中的文件并写入不同的目录

> ID：11299687
> 
> 赞同：4
> 
> 时间：2012-07-02T19:05:56.713
> 
> 标签：c++, io

我正在尝试修改一些现有的 C++ 代码以满足我的需要，但是以前从未使用过 C++，我遇到了一些困难。

我的目标是：

```
--> time and memory-intensive processes for preparation

for each file in directory:
    open file;
    generate a tagged representation; //the current code just does this
    write file; //different directory but same filename 
```

我不想只为每个文件（例如，使用 shell 脚本）调用 C++ 程序的原因是，在运行以下代码之前，会执行时间和内存密集型的预处理步骤。（这些大约需要 45-60 秒。而代码只需要大约 2-5 秒。运行。）

我已经粘贴了下面的代码部分。我想从命令行读取参数。

```
int main(int argc, char** argv) {
  /*
  pre-processing stuff
  */

  /* for each file */
  HANDLE hFind = INVALID_HANDLE_VALUE;
  string path = argv[1];
  string outpath = argv[2];
  WIN32_FIND_DATA ffd;

  //EDIT 2:
  cout << "Path: " << path << '\n'; 
  cout << "Outpath: " << outpath << '\n';

  hFind = FindFirstFile(path.c_str(), &ffd);
  if (hFind == INVALID_HANDLE_VALUE) {
    cout << "error searching directory\n";
    return false;
  }

  do {
    //istream *is(&std::cin);
    string filePath = path + ffd.cFileName;
    ifstream in( filePath.c_str() );
    if (in) {
      /* for each line */
      string line;
      int n = 1;
      string str;
      string fullOutpath = outpath + ffd.cFileName;
      ofstream File;
      File.open(fullOutpath);
      while (getline(in, line)) {
        if (line.size() > 1024) {
          cerr << "warning: the sentence seems to be too long at line " << n;
          cerr << " (please note that the input should be one-sentence-per-line)." << endl;
        }

        string postagged = bidir_postag(line, vme, vme_chunking, dont_tokenize);

        /* output to file */
        File << postagged << endl;
        //cout << postagged << endl;

        /* increment counter */
        n++;
      }
      File.close();
    } else {
      cout << "Problem opening file " << ffd.cFileName << "\n";
    }
  } while (FindNextFile(hFind, &ffd) != 0);

  if (GetLastError() != ERROR_NO_MORE_FILES) {
    cout << "Something went wrong during searching\n"; 
  }
  return true;
} 
```

目前，我收到编译器错误：**编辑**：编译器错误已修复，感谢 Blood！，但见下文......

```
error: no matching function for call to 'std::basic_ofstream<char>::open<std::string&> 
```

有什么想法吗？如果您需要更多代码/信息，请告诉我。另外，我应该补充一点，我正在使用命令提示符在 Windows XP 上运行这些。

谢谢。

**编辑：**

它现在可以编译（感谢 Blood），尽管它在运行时只是尝试打开目录，而不是目录中的文件。

```
Problem opening file directory_name. 
```

ifstream 应该打开目录中的文件，而不是目录本身。

**编辑2：**

我正在使用以下提示从命令行运行可执行文件：

```
.\tag.exe C:\indir C:\outdir 
```

我也试过：

```
.\tag.exe C:\indir\* C:\outdir\ 
```

这枚举了所有文件，但我怎样才能捕获它们？另外，有没有更简单的方法来修改我的代码/输入？

我也试过：

```
.\tag.exe C:\indir\ C:\outdir\ 
```

这给出：错误搜索目录。

**编辑 3：**

使用：

```
.\tag.exe "C:\indir\*" C:\outdir\ 
```

我得到输出：

```
Problem opening file .

Problem opening file ..

Problem opening file 2967

Problem opening file 2966

Problem opening file 4707

etc. (100s) 
```

**解决方案：**

以下是代码的主要更改（感谢 Nate Kohl！）：

```
string path = argv[1];
path += "\\*";

hFind = FindFirstFile(path.c_str(),&ffd);

    // in the 'do-while' loop
    string filePath = argv[1];
    filePath += "\\";
    filePath += ffd.cFileName;

    ifstream in(filePath.c_str());

    //regarding the outpath
    fullOutpath = outpath + "\\";
    fullOutpath += ffd.cFileName;
    File.open(fullOutpath.c_str()); 
```

并从命令行：

```
.\tag.exe C:\indir C:\outdir 
```

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T20:10:03.457

确保您将正确的`path`格式传递给`FindFirstFile`.

从[文档中](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364418%28v=vs.85%29.aspx)：

> 要检查不是根目录的目录，请使用该目录的路径，后面不带反斜杠。例如，“C:\Windows”的参数返回关于目录“C:\Windows”的信息，而不是关于“C:\Windows”中的目录或文件的信息。**要检查“C:\Windows”中的文件和目录，请使用“C:\Windows\*** ”的 lpFileName。

* * *

**编辑：**

我现在不在 Windows 框附近（所以这可能无法编译！）但我想“循环遍历目录中的每个文件”看起来像这样：

```
// argv[1] is the input path with no trailing characters, e.g. "c:\indir"

// add a wildcard because FindFirstFile expects e.g. "c:\indir\*"
TCHAR wildcard_path[MAX_PATH];
PathCombine(wildcard_path, argv[1], "*"); 

// iterate over each file
WIN32_FIND_DATA ffd;
HANDLE hFind = FindFirstFile(wildcard_path, &ffd);
if (hFind == INVALID_HANDLE_VALUE) { } // error

do {
   // ignore directories
   if (!(ffd.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY)) {

      // create a full path for each file we find, e.g. "c:\indir\foo.txt"
      TCHAR file_path[MAX_PATH];
      PathCombine(file_path, argv[1], ffd.cFileName);

      // ...and do something with file_path.
   }
} while (FindNextFile(hFind, &ffd) != 0);

FindClose(hFind); 
```

# python - 在 Python 中加密一个字符串。将使用的字符限制为仅字母数字

> ID：11299688
> 
> 赞同：3
> 
> 时间：2012-07-02T19:05:59.107
> 
> 标签：python, encryption, hash, pycrypto

我想将 10 个字符（仅限字母数字）字符串加密为 16 或 32 个字符的字母数字字符串。

我正在加密的字符串是一个资产标签。所以它本身不携带任何信息，但我想将所有有效的可能字符串隐藏在更大的可能字符串组中。我希望加密字符串是一个很好的方法。

是否可以使用 Python PyCrypto 库来做到这一点？

[这是](http://www.codekoala.com/blog/2009/aes-encryption-python-using-pycrypto)我发现的有关使用 PyCrypto 的示例。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T19:47:51.350

你最好使用简单的散列（这就像一种方式加密）。为此，只需使用 md5 函数制作摘要，然后对其进行 base64 或 base16 编码。请注意，base64 字符串可以包括 +、= 或 /。

```
import md5
import base64

def obfuscate(s):
    return base64.b64encode( md5.new(s).digest())

def obfuscate2(s):
    return base64.b16encode( md5.new(s).digest())

# returns alphanumeric string but strings can also include slash, plus or equal i.e. /+=
print obfuscate('Tag 1')
print obfuscate('Tag 2')
print obfuscate('Tag 3')

# return hex string
print obfuscate2('Tag 1') 
```

正如所评论的那样，md5 正在迅速失去其安全性，因此如果您希望将来拥有更可靠的东西，请使用下面的 SHA-2 示例。

```
import hashlib

def obfuscate(s):
    m = hashlib.sha256()
    m.update(s)
    return m.hexdigest()

print obfuscate('Tag 1')
print obfuscate('Tag 2')
print obfuscate('Tag 3') 
```

还有一个功能 - 这次使用 SHA-2 生成大约 96 位 * 的摘要并截断输出，以便我们可以将其限制为 16 个字母字符。这稍微增加了碰撞的机会，但对于大多数实际目的来说应该足够好。

```
import hashlib
import base64

def obfuscate(s):
    m = hashlib.sha256()
    m.update(s)
    hash = base64.b64encode(m.digest(), altchars="ZZ")  # make one way base64 encode, to fit characters into alphanum space only
    return hash[:16]    # cut of hash at 16 chars - gives about 96 bits which should 
    # 96 bits means 1 in billion chance of collision if you have 1 billion tags (or much lower chance with fewer tags)
    # http://en.wikipedia.org/wiki/Birthday_attack

print obfuscate('Tag 1')
print obfuscate('Tag 2')
print obfuscate('Tag 3') 
```

*实际摘要只有 95.2 位，因为我们使用 62 个字符的字母表进行编码。

```
>>> math.log(62**16,2)
95.26714096618998 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-02T20:55:10.820

要使字符串更长，您可以尝试以下操作；

*   先用bzip2压缩
*   然后使用 base64 编码使其再次可读

像这样：

```
import bz2
import base64
base64.b64encode(bz2.compress('012345')) 
```

这将产生：

```
'QlpoOTFBWSZTWeEMDLgAAAAIAH4AIAAhgAwDJy7i7kinChIcIYGXAA==' 
```

由于 bzip2 标头，前 13 个字符将始终相同，因此您应该丢弃它们；

```
base64.b64encode(bz2.compress('012345'))[14:] 
```

这给出了：

```
 'EMDLgAAAAIAH4AIAAhgAwDJy7i7kinChIcIYGXAA==' 
```

请注意，这**不是**加密安全的；如果您知道使用的配方，那么反转是微不足道的：

```
foo = base64.b64encode(bz2.compress('012345'))
bz2.decompress(base64.b64decode(foo)) 
```

给出：

```
'012345' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-02-05T11:15:34.347

我认为shake256符合您的需求：

您需要安装 pycryptodome。

[https://pycryptodome.readthedocs.io/en/latest/src/hash/shake256.html](https://pycryptodome.readthedocs.io/en/latest/src/hash/shake256.html)

```
#!/usr/bin/env python
from Crypto.Hash import SHAKE256
from binascii import hexlify

def encrypt_shake256(s, hash_size):
    shake = SHAKE256.new()
    shake.update(s.encode())
    return hexlify(shake.read(hash_size//2))

def main():
    hash = encrypt_shake256("holahola", 16)
    print(hash)
    print(len(hash))

if __name__ == '__main__':
    main() 
```

输出：

```
b'c126f8fb14fb21d8'
16 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-09-03T00:15:09.980

是的，您也可以使用 PyCrypto ：

```
from Crypto.Hash import SHA256

aHash = SHA256.new("somethingToHash")
print(aHash.hexdigest()) #will print out the hashed password 
```

Crypto.Hash 模块来自于安装 pycrypto 模块 ( `sudo pip install pycrypto`)。

这与 hashlib 基本相同，但是 PyCrypto 库带有加密模块。

# jquery - 检查字符串并仅包装尚未包装的单词？

> ID：11299689
> 
> 赞同：1
> 
> 时间：2012-07-02T19:06:09.547
> 
> 标签：jquery

我有以下 HTML 字符串：

`<span class="class1">Hello</span> my <span class="class1">name</span> is Mads.`

是否可以检测到单词“my”、“is”和“Mads”并将这些单词包装在一个尚未成为 span 标签一部分的字符串中？

所以它变成

`<span class="class1">Hello</span> <span class="class1">my</span> <span class="class1">name</span> <span class="class1">is</span> <span class="class1">Mads.</span>`

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T19:08:36.580

尝试以下操作：

HTML：

```
<div id="parent">
    <span class="class1">Hello</span> my <span class="class1">name</span> is Mads.
</div> 
```

jQuery：

```
$(document).ready(function(){
    $('#parent').contents().filter(function() {
        return this.nodeName == '#text';
    }).replaceWith(function(){
        return this.nodeValue.replace(/([a-zA-Z0-9_-]+)/g, '<span class="class1">$1</span>');
    });
}); 
```

演示：http: [//jsfiddle.net/CDe5j/](http://jsfiddle.net/CDe5j/)

上面的代码获取`#parent`对象，然后用于[`contents()`](http://api.jquery.com/contents/)获取其中的孩子。然后它应用该[`filter()`](http://api.jquery.com/filter/)方法，该方法针对每个元素测试提供的选择器，并且将选择与选择器匹配的所有元素。一旦只选择了非跨度的文本元素，则使用[replaceWith()](http://api.jquery.com/replaceWith/)方法通过所有字母数字字符、下划线和连字符的正则表达式来确保将每个单独的单词包装为跨度元素。[您可以在此处](http://www.javascriptkit.com/javatutors/redev2.shtml)查看有关正则表达式的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T21:35:09.753

首先，通过将 HTML 字符串放入 DIV 元素中，将其解析为 DOM，如下所示：

```
<div id="wrap">
   <span class="class1">Hello</span> my <span class="class1">name</span> is Mads.
</div> 
```

现在，执行这段代码：

```
var $wrap = $( '#wrap' );

$wrap.contents().filter(function () {
    return this.nodeType === 3 && $.trim( this.data );
}).replaceWith(function () {
    return this.data.replace( /(\w+)/g, '<span class="class1">$1</span>' );
}); 
```

上面的代码运行后，您可以像这样检索结果字符串：

```
var result = $wrap.html(); 
```

**现场演示：http:** [//jsfiddle.net/Rhpaa/1/](http://jsfiddle.net/Rhpaa/1/)

我`/(\w+)/`用来匹配一个单词。我不确定它有多可靠。如果它不能可靠地工作，请尝试在 SO 上找到更可靠的单词匹配正则表达式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-02T19:13:51.740

如果你得到了父元素，你可以使用 jQuery 对象的 text() 函数来获取文本。您可以使用 split(" ") 创建一个数组并对其进行迭代以将每个标记包装在一个标签中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-03T08:49:59.237

正确的，

我已经破解了它——尽管它可能不是你们见过的最漂亮的代码。

html 跨度在 -blur 事件上更新（当您在 div 可编辑字段之外单击时）。

[jsfiddle 示例的链接](http://jsfiddle.net/fzMZs/)！

# actionscript-3 - OSMF，视频上的频闪媒体播放按钮

> ID：11299693
> 
> 赞同：0
> 
> 时间：2012-07-02T19:06:31.797
> 
> 标签：actionscript-3, video-streaming, osmf

我想使用频闪媒体播放来显示视频，我想在视频的某些部分创建一些按钮和文本。类似于 YouTube 上的广告。

谁能帮我这个？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-27T08:00:56.673

您应该首先阅读 OSMF 开发人员指南：[http ://help.adobe.com/en_US/OSMF/1.0/Dev/osmf_dev_guide.pdf](http://help.adobe.com/en_US/OSMF/1.0/Dev/osmf_dev_guide.pdf)

不久前， Strobe 团队做了一个[广告演示](http://matbury.com/strobe/advertisement-demo.html?src=http://zeridemo-f.akamaihd.net/content/robinhood/robin_hood_25fps_3000-2.f4m&width=640&height=462&enableStageVideo=true&controlBarAutoHide=false&playButtonOverlay=true&showVideoInfoOverlayOnStartUp=true&plugin_ads=AdvertisementPlugin.swf&id=strobeMediaPlaybackId&ads_preroll=http://gcdn.2mdn.net/MotifFiles/html/1379578/PID_938961_1237818260000_women.flv&ads_postroll=http://gcdn.2mdn.net/MotifFiles/html/1379578/PID_938961_1237818260000_women.flv&ads_midroll=http://gcdn.2mdn.net/MotifFiles/html/1379578/PID_938961_1237818260000_women.flv&ads_midrollTime=20&ads_overlay=http://gcdn.2mdn.net/MotifFiles/html/1379578/PID_938961_1237818260000_women.flv&ads_overlayTime=25&autoPlay=true)，他们展示了预卷、后卷和覆盖的使用。

关于演示的进一步解释可以在[这里](http://blogs.adobe.com/osmf/2011/03/stage-video-and-ad-insertion-plug-in-for-osmf.html)找到。

# objective-c - URL 响应中的错误指针

> ID：11299694
> 
> 赞同：1
> 
> 时间：2012-07-02T19:06:32.370
> 
> 标签：objective-c, xcode, facebook, httpresponse

我正在尝试从我的应用程序将照片上传到 Facebook，当我上传并等待它完成时一切顺利，但是当我按下上传然后返回上一个`view`时，上传完成时出现错误

```
Thread 1:EXC_BAD_ACCESS(code=2, address=0x9) 
```

在代码中：

```
- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response {
_responseText = [[NSMutableData alloc] init];

NSHTTPURLResponse* httpResponse = (NSHTTPURLResponse*)response;
if ([_delegate respondsToSelector:
     @selector(request:didReceiveResponse:)]) {
    [_delegate request:self didReceiveResponse:httpResponse];
}
} 
```

它在`if`. 我不确定我将如何解决这个问题。

谢谢

编辑：在我回到上一个视图之前调用它：

```
-(IBAction)shareToFacefook{
        [[self appDelegate] facebooking]; // checke that the user is loged in
        NSMutableDictionary *params = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                                   labeledImage, @"source",
                                   [[MyStrings myLocalStrings] getBackLocalstring:FB_IMG_POST_TITLE],@"message",
                                   nil];

    [[[self appDelegate] getFacebookVar] requestWithGraphPath:[NSString stringWithFormat: @"/me/photos?access_token=%@", self.appDelegate.getFacebookVar.accessToken] andParams:params andHttpMethod:@"POST" andDelegate:self];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T20:22:51.990

似乎是内存管理问题。 `EXC_BAD_ACCESS`通常意味着正在访问的内存地址不再有效。

您是否使用在收到它时`retain`增加参考计数？`_delegate`如果不是，那么它可能已被垃圾收集。当您收到委托时，您应该使用`retain`或制作委托。`copy`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T02:12:05.980

你可以试试这个： 1.检查 Facebook.m 2.找到“dealloc” 3.你会看到以下代码：

```
for (FBRequest* _request in _requests) {
        [_request removeObserver:self forKeyPath:requestFinishedKeyPath];
    } 
```

将其替换为

```
for (FBRequest* _request in _requests) {
        _request.delegate = nil;
        [_request removeObserver:self forKeyPath:requestFinishedKeyPath];
    } 
```

# java - javafx焦点窗口

> ID：11299700
> 
> 赞同：0
> 
> 时间：2012-07-02T19:06:49.170
> 
> 标签：java, user-interface, focus, javafx, javafx-2

当我在 NetBeans 中启动我的 JavaFX 游戏并显示游戏窗口后，我在此窗口外单击了一些，之后我无法聚焦此游戏窗口。只有在显示游戏窗口后立即单击游戏窗口时才能聚焦游戏窗口。我如何设置可聚焦的，我可以随时聚焦游戏窗口？谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-03-30T17:27:05.843

这是通过[`Stage.requestFocus()`](http://docs.oracle.com/javafx/2/api/javafx/stage/Window.html#requestFocus%28%29).

# linux - 如何在sed中匹配后替换一块文本

> ID：11299701
> 
> 赞同：2
> 
> 时间：2012-07-02T19:06:55.680
> 
> 标签：linux, sed

中`sed`，我想在匹配后替换多行文本块，例如匹配“foo”后，假设它的行号为0。我想将文本块从第-3行替换到第+5行，即匹配行之后的第三行和匹配行之后的第五行之间的文本块，由另一个文本块`bar1\nbar2`。我希望能够在两种情况下做到这一点：

1) 保留被替换块后的匹配行；2) 将匹配行连同那些行-3 和+5 一起删除。

请帮我。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T19:17:23.380

多次使用 N 来读取八行，然后您可以将它们匹配起来，就好像它们是串联的一样 - sed 将在模式中识别 \n，因此很容易处理单个部分（行）。

例子：

```
$ echo '1
2 oooh
3
4
match
5
6
7
8
9 oooh
10 ' | sed ': label; N; s/[^\n]*\n[^\n]*\n[^\n]*\nmatch\n[^\n]*\n[^\n]*\n[^\n]*\n[^\n]*\n[^\n]*\n/bar1\nbar2/; T label' 
```

它会继续读取，直到它进行替换 (T)。由于您可能要捕获多个块，请将 更改`T`为`b`，因此它将始终分支。如果它还没有自动发生。

根据要求提供更短的表格：

```
echo '1
2 oooh
3
4
match
5
6
7
8
9 oooh
10 ' | sed ': label; N; s/\([^\n]*\n\)\{3\}match\n\([^\n]*\n\)\{5\}/bar1\nbar2/; T label' 
```

首先，我们定义一个名为“label”的自记录 sed 标签。它使我们能够跳转到其他代码——将其视为“goto”语句。由于是在开始，跳到那里会重复所有的 sed 命令。我们确实有一个目的 - `N`，它读取下一行并将其附加到模式空间。这会一遍又一遍地重复，因此我们可以获得您想要检查（和删除）的那些上下文行并在它们上运行单个正则表达式。这是以下`s`语句的工作，它首先查找`\{3\}`前一个模式组 ( ) 的3 个重复 ( `\([^\n]*\n\)`)，这是任何类型的行。然后它会检查下一行是否有您要查找的标记字符串 (`match`在这个例子中）和另外 5 行。如果此多行模式匹配，则进行替换并且工作几乎完成。我们需要使用循环，否则整个表达式将单独为每一行运行，一直提前读取而不是做我们想要的 - 批量读取这些行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-03T16:05:48.760

这可能有效（GNU sed）：

```
seq 31|sed 's/5/& match/' >/tmp/file
sed ':a;$q;N;s/\n/&/3;Ta;/match/!{P;D};:b;$bc;N;s/\n/&/8;Tb;:c;s/.*/bar1\nbar2/' /tmp/file
1
bar1
bar2
11
bar1
bar2
21
bar1
bar2
31
sed ':a;$q;N;s/\n/&/3;Ta;/match/!{P;D};h;s/\([^\n]*\n\)*\([^\n]*match[^\n]*\).*/\2/;x;:b;$bc;N;s/\n/&/8;Tb;:c;s/.*/bar1\nbar2/;G' /tmp/file
1
bar1
bar2
5 match
11
bar1
bar2
15 match
21
bar1
bar2
25 match
31 
```

解释：

命令分为两部分：

1.  上半场保持3行的移动窗口。
2.  在`match`后面附加了 5 行。

详细情况如下：

*   `:a`是循环占位符
*   `$q`在文件末尾打印模式空间 (PS) 内的所有行。
*   `N`将下一行附加到 PS
*   `s/\n/&/3`自行替换第三个换行符。这是一个计数设备，用于检查 PS 中是否有 3 行。
*   `Ta`如果之前的替换失败循环到循环占位符`a`
*   `/match/!{P;D}`看看`match`，如果它失败打印到第一个换行符，然后删除该行，它是换行符（这会调用一个新循环）。
*   `:b`是循环占位符 注意此时已找到匹配项。
*   `$bc`如果文件结尾分支向前到占位符`c`
*   `N`将下一行附加到 PS
*   `s/\n/&/8`自行替换第 8 个（后 5 个前 3 个）换行符。这是一个计数设备，用于检查 5 行是否附加到 PS
*   `Tb`如果之前的替换失败循环到循环占位符`b`
*   `:c`是循环占位符
*   `s/.*/bar1\nbar2/`将 PS 替换为所需的字符串。

第二个衬线复制该`match`行并将其附加到替换的字符串中。

替代解决方案：

```
sed -r ':a;$!N;s/[^\n]*/&/9;$!Ta;/^([^\n]*\n){3}([^\n]*match[^\n]*)\n.*/!{P;D};c\bar1\nbar2' file

sed -r ':a;$!N;s/[^\n]+/&/9;$!Ta;/^([^\n]*\n){3}([^\n]*match[^\n]*)\n.*/!{P;D};s//\bar1\nbar2\n\2/' file 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-03T13:50:23.987

一种`GNU sed`用于第二种情况的方法，虽然它看起来有点复杂（它已被充分评论）：

假设`infile`有以下内容：

```
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20 
```

和内容`script.sed`：

```
## From first line until a line that matches the pattern (number ten in 
## this example), save lines in buffer and print each one when there are
## more than three lines between one of them and the line with the pattern
## to search.
0,/10/ {

        ## Mark 'a'
        :a

        ## If line matches the pattern break this loop.
        /10/ {
                bb
        }

        ## Until the pattern matches, if more than three lines (checking '\n') are
        ## saved, print the oldest one and delete it, because I only want to save last
        ## three.
        /\(\n[^\n]*\)\{3\}/ {
                P
                D
        }

        ## Append next line to pattern space and goto mark 'a' in a loop.
        N
        ba
}

## It should never match (I think), but it's a sanity check to avoid the
## following mark 'b'.
bc

## Here we are when found the line with the pattern, so read next five six
## lines and delete all of them but the sixth. If end of file found in this
## process none of them will be printed, so it seems ok.
:b
N;N;N;N;N
N
s/^.*\n//

## Here we are after deleting both '-3' and '+5' lines from the pattern matched,
## so only is left to print the remainder of the file in a loop.
:c
p
N
s/^.*\n//
bc 
```

像这样运行它，`10`同时考虑到第五行和第十一行代码中的模式。根据您的需要更改它。在我的示例中，它应该删除行`7,8,9,10,11,12,13,14,15`：

```
sed -nf script.sed infile 
```

具有以下输出：

```
1
2
3
4
5
6
16
17
18
19
20 
```

# r - scale_gradient2 中的非对称颜色分布？

> ID：11299705
> 
> 赞同：20
> 
> 时间：2012-07-02T19:07:13.257
> 
> 标签：r, colors, ggplot2, scale

更改上限`scale_fill_gradient2`也会影响值 < 0 的颜色缩放，因为 0 附近的颜色分布似乎总是对称的，有没有办法获得颜色值的不对称分布？

这是一个使用 的情节的最小示例`geom_tile()`：

```
data <- read.csv("http://protzkeule.de/data.csv")
p <- ggplot(data = data, aes(x = variable, y = meas)) + geom_tile(aes(fill = value)) 
```

具有对称限制的绘图：

```
p + scale_fill_gradient2(low = "blue", mid = "white", high = "red", guide = "colorbar",
                         limits = c(-0.1, 0.1)) 
```

但是当改变上限时，下限颜色映射也会改变（注意颜色条）：

```
p + scale_fill_gradient2(low = "blue", mid = "white", high = "red", guide = "colorbar",
                         limits = c(-0.1, 0.3)) 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-07-02T21:25:05.383

你想要的是`scale_fill_gradientn`. 论点不是很清楚（我花了一个小时左右才最终弄清楚其中的一部分），但是：

```
library("scales")
p + scale_fill_gradientn(colours = c("blue","white","red"), 
                         values = rescale(c(-.1,0,.3)),
                         guide = "colorbar", limits=c(-.1,.3)) 
```

这使：

![在此处输入图像描述](../Images/58ef0d82f8620f8742e161cb582a949d.png)

# c++ - Ngram 实现

> ID：11299711
> 
> 赞同：-4
> 
> 时间：2012-07-02T19:07:36.783
> 
> 标签：c++, n-gram

如何在 C++ 中实现 ngram？

例如;

文本

二元组：*T、TE、EX、XT、T* 三元组：*TE、TEX、EXT、XT*、T__

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:21:58.710

这个[库](http://code.google.com/p/ngrams/)可能有用：

> ngram
> 
> 用于字符或单词 ngram 分析的 C++ 包。它使用三元搜索树而不是散列表来更快地计算 ngram 频率。单词被转换为唯一的 ID 并编码为更紧凑的 256 基整数。它是 Vlado Keselj 博士的 Text-Ngrams 1.6 的部分实现，它是 perl 中非常灵活的 Ngram 包。

例子：

```
$猫测试
测试

$ ./ngrams --type=character --n=3 --in=tst
ngrams已经生成，开始输出。
开始输出
12 个 ngram 中共有 11 个唯一的 ngram。
12 个 ngram 中共有 11 个唯一的 ngram。
1-GRAMS（5 克中共有 4 个独特的 ngram）
1-GRAMS（5 克中共有 4 个独特的 ngram）
----------------------
2
1
S 1
_ 1

2-GRAMS（4 克中共有 4 个独特的 ngram）
2-GRAMS（4 克中共有 4 个独特的 ngram）
----------------------
ES 1
ST 1
TE 1
T_ 1

3-GRAMS（3 克中共有 3 个独特的 ngram）
3-GRAMS（3 克中共有 3 个独特的 ngram）
----------------------
美国东部标准时间 1
ST_1
测试 1

小计：0 秒用于生成 ngram。
小计：0 秒用于输出 ngram。
总共 0 秒。

```

# python - 在传递不同的输入参数时创建默认的类对象

> ID：11299715
> 
> 赞同：1
> 
> 时间：2012-07-02T19:07:53.537
> 
> 标签：python, oop, class, constructor

我有两个班级`Pair`和`Sequence`. 一个`Pair`对象有两个属性，位置和值。`Sequence`对象是对象的序列`Pair`。

```
class Pair():
    def __init__(self, position, value):
        self.position = position
        self.value = value
        self.pair = (position, value)

    def __repr__(self):
        return "< Position: {0}, Value: {1} >".format(self.position, self.value)

class Sequence(Pair):
    def __init__(self, pairs):
        self.pairs = pairs
        self.cseg = [pair.value for pair in pairs]
        self.positions = [pair.position for pair in pairs]

    def __repr__(self):
        return "< Seq. {0} >".format(" ".join([str(x) for x in self.cseg])) 
```

我可以`Sequence`用这个创建一个对象：

```
>>> Sequence([Pair(0, 2), Pair(2, 8), Pair(3, 1))
< Seq. 2 8 1 >
>>> Sequence.pairs
[< Position: 0, Value: 2 >,
 < Position: 2, Value: 8 >,
 < Position: 3, Value: 1 >] 
```

如何创建一个只给出值列表的`Sequence`对象，如下面的代码？`Pair`在这种情况下，`Pair`位置必须是从 0 到 n - 1 的序列，其中 n 是 的长度`Sequence`。

```
>>> Sequence([2, 8, 1])
< Seq. 2 8 1 >
>>> Sequence.pairs
[< Position: 0, Value: 2 >,
 < Position: 1, Value: 8 >,
 < Position: 2, Value: 1 >] 
```

我尝试使用此版本的`Sequence`，但没有用。我收到了这个错误：

```
AttributeError: 'int' object has no attribute 'value'

class Sequence(Pair):
    def __init__(self, pairs):

        if not isinstance(pairs[0], Pair):
            self = Sequence([Pair(pos, val) for pos, val in enumerate(pairs)])

        self.pairs = pairs
        self.cseg = [pair.value for pair in pairs]
        self.positions = [pair.position for pair in pairs]

    def __repr__(self):
        return "< Seq. {0} >".format(" ".join([str(x) for x in self.cseg])) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T19:12:21.023

`Pair`当您传入包含非对象的列表时，以下将创建一个对象列表`Pair`，否则它将简单地将给定的`Pair`对象列表分配给`self.pairs`：

```
class Sequence(Pair):
    def __init__(self, pairs):
        if not isinstance(pairs[0], Pair):
            self.pairs = [Pair(pos, val) for pos, val in enumerate(pairs)]
        else:
            self.pairs = pairs
        self.cseg = [pair.value for pair in self.pairs]
        self.positions = [pair.position for pair in self.pairs] 
```

您收到错误的原因是，尽管您检查了 的内容，但`pairs`您仍将其分配给`self.pairs`：

```
class Sequence(Pair):
    def __init__(self, pairs):
        # the following code will run when you're passing a list of integers
        if not isinstance(pairs[0], Pair):
            self = Sequence([Pair(pos, val) for pos, val in enumerate(pairs)])
        # but the next line will also run
        # which means self.pairs` is now a list of integers
        self.pairs = pairs
        # and that means pair in the following line is an int, not a Pair:
        self.cseg = [pair.value for pair in pairs]
        self.positions = [pair.position for pair in pairs] 
```

最后，您不应该在构造函数中执行以下操作（分配给`self`）：

```
self = Sequence([Pair(pos, val) for pos, val in enumerate(pairs)]) 
```

您正在尝试“覆盖”或“替换”该对象`self`，但这意味着您正在. 在这种情况下这是不必要的，因为您可以在同一个构造函数中处理这两种情况。反过来，这会导致代码更简洁。`Sequence``Sequence`

# google-apps-script - 谷歌文档访问新图表服务

> ID：11299718
> 
> 赞同：0
> 
> 时间：2012-07-02T19:07:59.700
> 
> 标签：google-apps-script, google-visualization

我正在使用从 [http://script.google.com](http://script.google.com)访问的 Google Apps 脚本编辑器创建一个脚本。我想使用[https://developers.google.com/chart/interactive/docs/quick_start](https://developers.google.com/chart/interactive/docs/quick_start)中记录的较新的图表服务。那里的示例包括以下几行：

[html> [head> [!--加载AJAX API--]

[脚本类型="text/javascript" src="https://www.google.com/jsapi"][/script]

[脚本类型=“文本/javascript”]

// 加载可视化 API 和饼图包。google.load('可视化', '1.0', {'packages':['corechart']});

（我用 [ 和 ] 代替了 < 和 > 以保持可见性。）

现在，由于我在脚本编辑器中编写脚本，所以我没有以括号中的“html”开头。如果我输入该行：

google.load('可视化', '1.0', {'packages':['corechart']});

进入我的脚本然后尝试运行脚本，我收到消息：

ReferenceError：未定义“google”。

如何从 google Apps 脚本编辑器访问 Visualization API？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T15:12:51.277

使用 HtmlService 创建的 Web 应用程序目前不支持 Google Charts API。这是团队正在努力在未来几个月内实现的目标。

# php - 在 TinyMCE 发布 INSERT 后 MySQL DB 列未更新

> ID：11299722
> 
> 赞同：1
> 
> 时间：2012-07-02T19:08:16.843
> 
> 标签：php, mysql, tinymce

我设法在我的网站上实现了一个简单的 TinyMCE 编辑器，并使用 mySQL 数据库调用它。我现在遇到的问题是让数据库用正在发布的内容覆盖已经存储在里面的内容？

我只是想用插入的内容覆盖表内容（列内）。

```
 Here is my code:

<!--- CONNECT TO THE DATABASE------>
 <?php
 $con = mysql_connect("localhost","root","jdkldk8%by");
 if (!$con)
  {
   die('Could not connect: ' . mysql_error());
   }

 mysql_select_db("cms", $con);

 $sql="INSERT INTO tinymce (contents, contact, slider, resources)
 VALUES
 ('$_POST[contents]','$_POST[contact]','$_POST[slider]','$_POST[resources]')";

 if (!mysql_query($sql,$con))
 {
 die('Error: ' . mysql_error());
   }
 echo "1 record added";
 mysql_close($con);
 ?>

 <!--- END DATABASE SETTINGS -----> 
```

[在此处查看您的更改]

///////////////////////////////////////// ////////////////////////////////

嗯......我又试了一次，但它仍然没有将所有字段都发布到数据库！只更新1。

```
 <!--- CONNECT TO THE DATABASE------>
  <?php
    require_once('db.php');

   $contents=$_POST['contents']; 
   $contact=$_POST['contact']; 
   $slider=$_POST['slider']; 
   $resources=$_POST['resources'];
   $id='1'; 

   $sql="UPDATE tinymce SET `contents`='$contents', `contact`='$contact', `slider`='$slider', `resources`='$resources' WHERE id='$id'";

   if (!mysql_query($sql,$con))
    {
   die('Error: ' . mysql_error());
     }
   echo "Saved!";
   mysql_close($con);
    ?>

  <!--- END DATABASE SETTINGS -----> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T01:38:07.670

您想使用 UPDATE 而不是 INSERT 来更新以前创建的 MySQL 列。

尝试使用 phpmyadmin 编辑列并从他们的 MySQL 代码查看器中复制生成的代码。

# c - 将结构中的指针分配给变量

> ID：11299723
> 
> 赞同：1
> 
> 时间：2012-07-02T19:08:22.430
> 
> 标签：c, pointers, vector, struct, pointer-address

该程序应该创建一个动态内存向量。我很确定我正确使用了 malloc。我真正的问题是一些带有指针的语法，特别是结构内的指针。

我正在尝试访问结构内的 int 指针的地址，以便可以将其分配给另一个指针

我给定的结构是：

```
typedef struct{
int *items;
int capacity;
int size;
}VectorT; 
```

我试图开始工作的功能是：

```
int getVector(VectorT *v, int index){
    int *p;
    p = v->items;//(2)
    p -= v->size;
    p += index;
    return *p;
} 
```

这应该是项目指针的地址减去列表中的项目数，并将所需项目的索引添加到 p 的地址。然后我返回 p 的地址。

我有一种强烈的感觉，第 (2) 行不是我需要的语法。

根据我到目前为止所尝试的内容，我的程序要么在调用 getVector 时崩溃，要么输出（我的最佳猜测）一些内存位置。

这是添加向量的代码：

```
void addVector(VectorT *v, int i){
        if(v->size >= v->capacity){
            //allocate twice as much as old vector and set old pointer to new address
            v = (VectorT *) malloc(2 * v->capacity * sizeof(VectorT));
            if(v == NULL){
                fprintf(stderr, "Memory allocation failed!\n");//error catch
            }
            else{
                v->capacity *= 2;//double the reported capacity variable
                v->size++;//add one to the reported size variable
                v->items =(int *) i;//add the item to the vector (A)<-----
            }   
        }
        else{
            v->size++;//add one to the reported size variable
            v->items =(int *) i;//add the item to the vector (B)<-----
        }
} 
```

我不觉得我的问题在这里，但如果是的话，我对 A 线和 B 线有些怀疑......

任何见解将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T19:19:41.607

至少在这些地方，您对指针的处理是错误的：

*   带有注释“将项目添加到向量”的代码非常错误：它没有添加项目，而是使用任意`int`.

`v->items =(int *) i;`

应该

```
*(v->items) = i; 
```

*   您的指针算法不正确：减去大小并添加索引将使您在分配区域开始之前获得一个指针，这是不正确的。

*   您正在将结果分配给“指向向量的指针”类型`malloc`的局部变量。`v`这个赋值对调用者没有影响，因为指针是按值传递的。如果您想重新评估 中的向量`addVector`，您应该将`VectorT **pv`其作为第一个参数。此代码片段看起来根本不对：看来您应该分配`v->items=malloc(2 * v->capacity * sizeof(int))`而不是`v=malloc(...)`

*   执行 a 时不会释放旧向量`malloc`，从而导致内存泄漏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T19:12:49.190

您想要 i 的地址，因此：

```
v->items =&i;//add the item to the vector (A)<----- 
```

此外，在计算您想要的尺寸时：

```
p -= (v->size*sizeof(int)); 
```

更新：

您还可以将指向 i 的指针传递给 getVector 并将其保存在`v->items`

```
 int getVector(VectorT *v, int *index)
 //...
 v->items = i; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-02T19:38:42.717

当您应该为 VectorT.items 分配内存时，我看到您正在为 VectorT 分配内存

```
void addVector(VectorT *v, int i){
        if(v->size >= v->capacity){
            //allocate twice as much as old vector and set old pointer to new address
            v->items
            int* tmp = malloc(2 * v->capacity * sizeof(int));
            if(tmp == NULL){
                fprintf(stderr, "Memory allocation failed!\n");//error catch
            }
            else{
                int j;
                for (j = 0; j < v->size; j++){
                    tmp[j] = v->items[j];
                }
                free(v->items);
                v->items = tmp;
                v->capacity *= 2;//double the reported capacity variable
                v->items[v->size] = i;//add the item to the vector (A)<-----
                v->size++;//add one to the reported size variable
            }   
        }
        else{
            v->items[v->size] = i;//add the item to the vector (B)<-----
            v->size++;//add one to the reported size variable
        }
}

int getVector(VectorT *v, int index){
    return v->items[index]
} 
```

# c++ - 编程作业的链接错误 2019

> ID：11299730
> 
> 赞同：1
> 
> 时间：2012-07-02T19:08:50.340
> 
> 标签：c++, linker-errors, lnk2019

```
1>Main.obj : error LNK2019: unresolved external symbol "void __cdecl createVideoList(class                          std::basic_ifstream<char,struct std::char_traits<char> > &,class Video &)" (?createVideoList@@YAXAAV?$basic_ifstream@DU?$char_traits@D@std@@@std@@AAVVideo@@@Z) referenced in function _main
1>c:\users\******\documents\visual studio 2010\Projects\Programming Assignment 4\Debug\Programming Assignment 4.exe : fatal error LNK1120: 1 unresolved externals 
```

我正在处理编程作业，并且在尝试编译时收到此链接错误 2019。它引用了 createVideoList，这些是与此相关的代码行：

```
#include <iostream>
#include <fstream>
#include <string>
#include "Video.h"
using namespace std;

void createVideoList(ifstream& infile, Video videoArray);

int main()
{
...
createVideoList(inputfile, videoArray[50]);
}

void createVideoList(ifstream& ifile, Video videoArray[50])
{
string title;
string star1;
string star2;
string producer;
string director;
string productionCo;
int inStock;
int count = 0;
Video newVideo;
getline(ifile, title);
while (ifile)
{
    getline(ifile, star1);
    getline(ifile, star2);
    getline(ifile, producer);
    getline(ifile, director);
    getline(ifile, productionCo);
    ifile >> inStock;
    newVideo.setVideoInfo(title, star1, star2, producer,
        director, productionCo, inStock);
    videoArray[count] = newVideo;
    getline(ifile, title);
}
} 
```

不确定我需要在这里发布什么代码来帮助你们，因为我什至不确定错误在说什么。提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T19:11:28.137

```
void createVideoList(ifstream& infile, Video& videoArray); 
```

它应该是

```
void createVideoList(ifstream& infile, Video* videoArray); 
```

这两个是不同的声明。在第一个中，第二个参数是对 Video 变量的引用，第二个是指针，它可能是一个数组，在你的情况下是什么。

此外，如果您想将数组作为参数传递给函数，您应该这样调用它：

```
createVideoList(inputfile, videoArray[]); 
```

或者

```
createVideoList(inputfile, videoArray); 
```

因为当你这样做时：

```
createVideoList(inputfile, videoArray[50]); 
```

你只是传递数组的第 50 个元素。

# c - 在数组中存储临时值与多个变量

> ID：11299734
> 
> 赞同：1
> 
> 时间：2012-07-02T19:09:04.693
> 
> 标签：c, coding-style

假设我有一段这样的代码：

```
int foo(int a, int b, int c)
{
    int tmp1, tmp2, tmp3;
    ...
    some_calculation0(&tmp1, a, b); // stores the result in tmp1
    some_calculation1(&tmp2, b, c);
    some_calculation2(&tmp3, tmp1, tmp2);

    return tmp3;
} 
```

最近我会这样写：

```
int foo(int a, int b, int c)
{
    int tmp[3];
    ...
    some_calculation0(&tmp[0], a, b); // stores the result in tmp[0]
    some_calculation1(&tmp[1], b, c);
    some_calculation2(&tmp[2], tmp[0], tmp[1]);

    return tmp[2];
} 
```

有什么理由不做这样的事情吗？有人会认为这是不好的做法吗？

在这种情况下，这些`tmp`值实际上是计算字符串中的中间值，因为所有函数都在通过引用传递的输入变量之一中返回它们的结果。对我来说，将它们组合在一起是有意义的，但鉴于迄今为止的反应一直反对它，我不反对使用单独的变量。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T19:12:25.937

这会干扰代码的可读性。变量名应该提供一些关于它们使用的信息。

虽然`tmp`用作变量名有时有用且合理，但以这种方式使用 tmp 数组并不能说明变量的使用方式：您将计算的细节隐藏在不透明的名称/结构后面。此外，我需要跟踪索引以弄清楚代码中发生了什么，这很令人困惑，并且容易出现程序员错误。

选择特定的变量名称不需要更多的努力，如果变量确实没有比 更好的名称，那么更喜欢常见的约定，`tmpX`例如，`x`作为迭代器，或用于索引等。`y``z``index``idx`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:15:13.410

这是非常主观的，但我肯定会反对第二个片段中的风格。我认为除非您需要数组的特性（即连续存储+数组指针衰减），否则您应该将所有变量设为标量并合理命名，所以它不是`tmp1`,`tmp2`和`tmp3`. 我发现您的第二个片段既难以输入，也更难阅读（并且有更多错误的可能性）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T20:34:15.810

还有另一种变体：将返回值用于它的用途：

```
int foo(int a, int b, int c)
{
    int part_a, part_b, result;
    ...
    part_a = some_calculation0( a, b);
    part_b = some_calculation1( b, c);
    result = some_calculation2( part_a, part_b);

    return result;
} 
```

还有另一个可能的相当神秘的版本（这相信 some_calculation[01] 是*纯*函数；没有副作用）：

```
int foo(int a, int b, int c)
{
    int result;
    ...

    result = some_calculation2( some_calculation0( a, b)
                              , some_calculation1( b, c));

    return result;
} 
```

甚至：

```
int foo(int a, int b, int c)
{
    ...
    return some_calculation2( some_calculation0( a, b)
                            , some_calculation1( b, c));
} 
```

使用返回值有一个合乎逻辑的“性能”原因：在被调用函数的末尾，就在返回之前，编译器将在寄存器的某个地方准备好结果。在大多数情况下，调用函数期望子函数使用*所有*通用寄存器（及其内容被破坏）。但不是返回值，在大多数架构上，作为惯例，在寄存器中返回返回值（AX，或 x86 上的 DX+AX）对于调用者和被调用者来说，这是一个不错的廉价集合点......

# c# - 从视图返回的空 ViewModel

> ID：11299745
> 
> 赞同：0
> 
> 时间：2012-07-02T19:10:32.810
> 
> 标签：c#, asp.net, asp.net-mvc, viewmodel

我正在将 ASP.NET MVC 4 用于网站，我正在做的一件事是 CSV 导入。我想将 CSV 列映射到 ORM 的属性上。文件上传后，我想显示列号，第一行（包含csv文件中的标题）和第二行（数据预览）。

```
/// <summary>
/// The mapping view model.
/// </summary>
public class MappingViewModel
{
    #region Public Properties

    /// <summary>
    /// Gets or sets the mappings.
    /// </summary>
    public IList<Mapping> Mappings { get; set; }

    public MappingViewModel()
    {
        //this.Mappings = new List<Mapping>();
    }

    public string FileName { get; set; }

    #endregion
}

/// <summary>
/// The mapping.
/// </summary>
public class Mapping
{
    #region Public Properties

    public int ColumnIndex { get; set; }

    public string ColumnHeader { get; set; }

    public string DataPreview { get; set; }

    public string PropertyIdentifier { get; set; }

    #endregion
} 
```

我创建了一个强类型的 Razor 视图，在该视图中循环模型内的列表，如下所示：

```
@model MappingViewModel

@using (Html.BeginForm("ApplyMapping", "Person"))
{
    @Html.EditorFor(t=>t.FileName)
    <table class="i-table fullwidth">
        <thead>
...table header
        </thead>
        @foreach (var mapping in Model.Mappings)
        {
            <tr>
                <td>@Html.EditorFor(x=>mapping.ColumnIndex)</td>
                <td>@Html.EditorFor(x => mapping.ColumnHeader)</td>
                <td>@Html.EditorFor(x => mapping.DataPreview)</td>
                <td>@Html.DropDownListFor(x=>mapping.PropertyIdentifier,(SelectList)ViewBag.PropertyList)</td>
            </tr>
        }
    </table>
    <input type="submit" value="@Resources.Default.ButtonSaveText" class="icon16-button forms-16" />
} 
```

这对我不起作用。显示数据，但接收控制器操作得到一个空模型 - 文件名除外。

我究竟做错了什么？

PS动作如下：

```
 [HttpPost]
        public ActionResult UploadAdvanced(FormCollection collection)
        {
 // csv stuff + get property list

            var viewModel = new MappingViewModel();
            viewModel.Mappings = new List<Mapping>();
            for (int i = 0; i < headers.Count(); i++)
            {
                viewModel.Mappings.Add(new Mapping() { ColumnIndex = i, DataPreview = firsLine[i], ColumnHeader = headers[i],PropertyIdentifier = string.Empty });
            }
            viewModel.FileName = file.FileName;
            var propertyList = new SelectList(propList);
            this.ViewBag.PropertyList = propertyList;
            return this.View("Mapping", viewModel);
        }

        [HttpPost]
        public ActionResult ApplyMapping(MappingViewModel model)
        {
            System.Diagnostics.Debug.WriteLine(model.ToString());

            return this.View("Index");
        } 
```

我正在从 ApplyMapping actionResult 中的断点读取视图模型道具。当断点命中 - 文件名设置正确时，列表为 NULL

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T19:27:03.673

它是空的，可能是因为所有属性都使用 a`DisplayFor`而不是`EditorFor`second 它们需要在 BeginForm 内，如果你能告诉我们动作吗？

**更新**

将数据类型从 IList 更改为 IEnumerable，然后在构造函数中初始化属性。

```
/// <summary>
/// The mapping view model.
/// </summary>
public class MappingViewModel
{
    #region Public Properties

    /// <summary>
    /// Gets or sets the mappings.
    /// </summary>
    public IEnumerable<Mapping> Mappings { get; set; }

    public MappingViewModel()
    {
        //this.Mappings = new List<Mapping>();
        IEnumerable<Mapping> test = new HashSet<Mapping>();
    }

    public string FileName { get; set; }

    #endregion
} 
```

**更新 2**

在此路径 (/Views/Shared/EditorTemplates/) 中为您的类创建了一个 EditorTemplate 使用您需要的格式进行映射，例如

```
@model SomePath.Models.Mapping 

<tr> 
    <td>@Html.EditorFor(model => model.ColumnIndex)</td>
    <td>@Html.EditorFor(model => model.ColumnHeader)</td>
</tr> 
```

然后删除视图中的 for 属性 Mapping 并`EditorFor`像这样使用 Helper

```
@Html.EditorFor(x=>x.Mappings) 
```

那应该是序列化属性的问题

# ios - 小数点前或小数点后没有零

> ID：11299748
> 
> 赞同：1
> 
> 时间：2012-07-02T19:10:49.747
> 
> 标签：ios, xcode, zero, decimal-point

我的应用程序中有简单的计算

```
-(IBAction)calculate {
    NSNumberFormatter *nf = [[NSNumberFormatter alloc] init];
    [nf setRoundingMode: NSNumberFormatterRoundHalfUp];
    [nf setMaximumFractionDigits: 2];

    float value1 = [[nf numberFromString: textField1.text] floatValue];
    float value2 = [[nf numberFromString: textField2.text] floatValue];

    float x = value1 * value2 / 100;
    label2.text = [nf stringFromNumber: [NSNumber numberWithFloat: x]];

    [nf release];
} 
```

现在，当我计算结果看起来像这样：`,75`或`64,5`

我需要我的结果如下所示：`0,75`或`64,50`

**我的问题是小数点前或小数点后没有零**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T19:15:15.927

在 UILabel 中设置文本的地方，使用

```
label2.text = [NSString stringWithFormat:@"%.2f",x]; 
```

这将确保您获得 2 个小数位。您甚至不需要数字格式化程序。

# python - 在python中生成多项式

> ID：11299750
> 
> 赞同：-3
> 
> 时间：2012-07-02T19:11:06.897
> 
> 标签：python

我正在尝试制作一个可以打印 x,y 的 n 阶多项式的函数

即`poly(x,y,1)`会输出`c[0] + c[1]*x + c[2]*y`

即`poly(x,y,2)`会输出`c[0] + c[1]*x + c[2]*y + c[3]*x**2 + c[4]*y**2 + c[5]*x*y`

你能给我一些想法吗？也许是迭代工具？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T19:24:14.013

你可以尝试从类似的东西开始

```
def poly(x,y,n):
    counter = 0
    for nc in range(n+1):
        for i in range(nc+1):
            print "c[", counter, "]",
            print " * ", x, "**", i,
            print " * ", y, "**", nc-i,
            print " + ",
            counter += 1 
```

例如

```
poly("x", "y", 2) 
```

会产生

```
c[ 0 ]  *  x ** 0  *  y ** 0  +  c[ 1 ]  *  x ** 0  *  y ** 1  +  c[ 2 ]  *  x ** 1  *  y ** 0  +  c[ 3 ]  *  x ** 0  *  y ** 2  +  c[ 4 ]  *  x ** 1  *  y ** 1  +  c[ 5 ]  *  x ** 2  *  y ** 0  + 
```

内置`if`s，如果你想抑制不需要的输出。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T23:58:12.690

既然您想要一个带有 itertools 的功能性解决方案，这里有一个单行：

```
import itertools as itt
from collections import Counter
n = 3
xy = ("x", "y") # list of variables may be extended indefinitely
poly = '+'.join(itt.starmap(lambda u, t: u+"*"+t if t else u, zip(map(lambda v: "C["+str(v)+"]", itt.count()),map(lambda z: "*".join(z), map(lambda x: tuple(map(lambda y: "**".join(map(str, filter(lambda w: w!=1, y))), x)), map(dict.items, (map(Counter, itt.chain.from_iterable(itt.combinations_with_replacement(xy, i) for i in range(n+1)))))))))) 
```

那会给你

```
C[0]+C[1]*x+C[2]*y+C[3]*x**2+C[4]*y*x+C[5]*y**2+C[6]*x**3+C[7]*y*x**2+C[8]*y**2*x+C[9]*y**3 
```

请注意，系数的顺序略有不同。这不仅适用于任何 n，而且适用于任意数量的变量（x、y、z 等......）

只为一笑

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-02T23:59:19.077

稍微笼统一点：

```
from itertools import product

def make_clause(c, vars, pows):
    c = ['c[{}]'.format(c)]
    vp = (['', '{}', '({}**{})'][min(p,2)].format(v,p) for v,p in zip(vars,pows))
    return '*'.join(c + [s for s in vp if s])

def poly(vars, max_power):
    res = (make_clause(c, vars, pows) for c,pows in enumerate(product(*(range(max_power+1) for v in vars))))
    return ' + '.join(res) 
```

然后`poly(['x', 'y'], 2)`返回

```
"c[0] + c[1]*y + c[2]*(y**2) + c[3]*x + c[4]*x*y + c[5]*x*(y**2) + c[6]*(x**2) + c[7]*(x**2)*y + c[8]*(x**2)*(y**2)" 
```

# c# - flowlayoutpanel 和水平滚动条问题

> ID：11299754
> 
> 赞同：6
> 
> 时间：2012-07-02T19:11:44.707
> 
> 标签：c#, winforms, flowlayoutpanel

我正在使用一个 flowlayoutpanel，每个逻辑都有很多按钮。我在调整窗口大小时遇到​​问题，当窗口变小时，我无法看到所有水平排列的按钮。相反，随着窗口变小，按钮会下降到下一行。谁能帮我解决这个问题？我只希望按钮水平排列，当窗口变小时，有一个水平滚动条。下面是我所拥有的。

```
fLayoutPnl.Controls.Add(btn1);
// snipped adding buttons from 2 to 15
fLayoutPnl.Controls.Add(btn16);
fLayoutPnl.Dock = System.Windows.Forms.DockStyle.Top;
fLayoutPnl.Location = new System.Drawing.Point(0, 10);
fLayoutPnl.Name = "fLayoutPnl";
fLayoutPnl.Size = new System.Drawing.Size(1245, 30); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-02T19:37:13.103

如果将 flowlayoutpanel 停靠在顶部，它会占用父控件的大小。所以如果你想要水平滚动，你需要设置表单（或用户控件）的AutoScrollMinSize。

否则，您可以这样做：

```
this.AutoScroll = true;    
this.fLayoutPnl.Dock = System.Windows.Forms.DockStyle.None;
this.fLayoutPnl.AutoSize = true;
this.fLayoutPnl.AutoSizeMode = System.Windows.Forms.AutoSizeMode.GrowAndShrink;
this.fLayoutPnl.Location = new System.Drawing.Point(0, 10);
this.fLayoutPnl.Name = "fLayoutPnl";
this.fLayoutPnl.Size = new System.Drawing.Size(1245, 30); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-01-20T04:05:48.817

```
fLayoutPnl.WrapContents = false; 
```

这将解决问题。如果需要滚动条，设置`MinimumSize`面板的属性，之后应该出现滚动条

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-01-08T03:29:50.733

要通过垂直滚动查看流布局面板的所有内容，请将 AutoScroll 属性设置为 True，并且不要忘记将 WrapContents 属性设置为 True。如果要通过水平滚动查看内容，请将 AutoScroll 属性设置为 True，并且不要忘记将 WrapContents 属性设置为 False。

# c# - C# 中的多查询格式（不使用 C# SDK）

> ID：11299755
> 
> 赞同：0
> 
> 时间：2012-07-02T19:11:57.513
> 
> 标签：c#, facebook, facebook-fql

我试图弄清楚如何在 C# 中格式化多查询查询字符串，但我不能使用 C# SDK。到目前为止，这是我尝试过的。

```
string url = "https://graph.facebook.com/method/fql?q={'q1':'SELECT uid, page_id FROM page_fan WHERE uid IN (SELECT uid2 FROM friend WHERE uid1 = me()) AND page_id IN (SELECT page_id FROM page WHERE 'MyPage' in name)','q2':'select page_id, name, page_url, pic_small, pic_big from page where page_id in (SELECT page_id FROM #q1)','q3':'SELECT uid, name, pic_small FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1 = me() AND (uid2 IN (SELECT uid FROM #q1)))'}&access_token=myaccesstoken&format=json" 
```

和

```
string url = "https://graph.facebook.com/method/fql.multiquery?queries={'q1':'SELECT uid, page_id FROM page_fan WHERE uid IN (SELECT uid2 FROM friend WHERE uid1 = me()) AND page_id IN (SELECT page_id FROM page WHERE 'MyPage' in name)','q2':'select page_id, name, page_url, pic_small, pic_big from page where page_id in (SELECT page_id FROM #q1)','q3':'SELECT uid, name, pic_small FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1 = me() AND (uid2 IN (SELECT uid FROM #q1)))'}&access_token=myaccesstoken&format=json" 
```

他们都没有工作。有人可以帮忙吗？

```
WebClient clientUser = new WebClient();
string JsonResult = clientUser.DownloadString(url);
JObject jsonUserInfo = null;
if (!String.IsNullOrEmpty(JsonResult)) jsonUserInfo = JObject.Parse(JsonResult); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:21:54.130

您需要转义单引号，例如包装 MyPage 字符串文字。

# ruby-on-rails - ROR...从数据库中检索数据

> ID：11299766
> 
> 赞同：0
> 
> 时间：2012-07-02T19:12:47.000
> 
> 标签：ruby-on-rails, ruby

对于每个`original_url`（由用户输入），我生成一个`short_url`，并且在将它们保存到数据库后，显示`short_url`. `original_url`我能够做到这一点。

现在我想看看如果一个URL已经被缩短了，那么它可以直接从数据库中检索而不用再次缩短。

我这样做的想法是将`original_url`用户输入的内容与 db 中的内容进行比较，如果找到`short_url`直接检索，则缩短`original_url`.

但我无法做到这一点......请帮助我。如果还有其他更好的想法，请告诉我。提前致谢。

```
 def show
    @url = Url.find(params[:id])
    if Url.find_by_original_url(@url.original_url)
      @url.short_url
    else
      @short_url
    end 
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T19:18:42.690

如果您要填写 short_url 列，那么为什么不检查一下里面是否有东西呢？

```
def show
   @url = Url.find(params[:id])
   unless @url.short_url
      # shorten the URL
   end
end 
```

或者

```
def show
   @url = Url.find(params[:id])
   if @url.short_url
   else
      # shorten the URL
   end
end 
```

# android - findViewById(android.R.id.progress) 返回 null

> ID：11299773
> 
> 赞同：6
> 
> 时间：2012-07-02T19:13:24.800
> 
> 标签：android, android-resources, android-progressbar, android-titlebar

Android 开发者参考列出了可用的内置 View 资源中的[R.id.progress 。](http://developer.android.com/reference/android/R.id.html#progress)

然而，当我（在我的活动课上）发出声明时：

```
View pv = getWindow().findViewById(android.R.id.progress); 
```

它返回空值。

即使我将它与`ProgressBar`类结合使用，它也会返回 null：

```
ProgressBar pv = (ProgressBar) getWindow().findViewById(android.R.id.progress); 
```

即使[没有 getWindow()](http://foo.jasonhudgins.com/2010/03/simple-progressbar-tutorial.html)它也会返回 null ：

```
ProgressBar pv = (ProgressBar) findViewById(android.R.id.progress); 
```

知道为什么吗？

为了确保我没有产生幻觉，我按照@Geobits 的建议从头开始创建了一个新项目，其中包含下面@ArunGeorge 推荐[的博客文章](http://foo.jasonhudgins.com/2010/03/simple-progressbar-tutorial.html)中列出的**确切代码：**

```
package com.droidworks;

import android.app.Activity;
import android.os.Bundle;
import android.os.Handler;
import android.widget.ProgressBar;

public class ProgressBarExampleActivity extends Activity {
  private ProgressBar mProgress;
  private MyThread mBgThread;
  private final Handler mHandler = new Handler();

  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    mProgress = (ProgressBar) findViewById(android.R.id.progress);

    mBgThread = (MyThread) getLastNonConfigurationInstance();

    if (mBgThread == null) {
      mBgThread = new MyThread();
      mBgThread.start();
    }

    mHandler.post(mThreadWatcher);
  }

  @Override
  public Object onRetainNonConfigurationInstance() {
    return mBgThread;
  }

  @Override
  protected void onPause() {
    mHandler.removeCallbacks(mThreadWatcher);
    super.onPause();
  }

  private Runnable mThreadWatcher = new Runnable() {
      public void run() {
        int progress = mBgThread.getProgress();
        mProgress.setProgress(progress);

        if (progress != 100)
          mHandler.postDelayed(this, 50);
      }
    };

  static class MyThread extends Thread {

    private int _progress = 0;

    public void run() {
      for (; _progress < 100; _progress++) {
        try {
          Thread.sleep(100);
        }
        catch (InterruptedException ignored) {
        }
      }
    }

    private int getProgress() {
      return _progress;
    }
  }

} 
```

果然，这段代码抛出了一个`NullPointerException`：

```
at com.droidworks.ProgressBarExampleActivity$1.run(ProgressBarExampleActivity.java:44)
at android.os.Handler.handleCallback(Handler.java:587)
at android.os.Handler.dispatchMessage(Handler.java:92)
at android.os.Looper.loop(Looper.java:123)
at android.app.ActivityThread.main(ActivityThread.java:4627)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:521)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:19:24.410

`R.id.progress`内置标签是为该类设计的`ProgressBar`。如果您的 XML 中没有`ProgressBar`对象或 a `ProgressBar`，那么它将返回 null。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T20:22:47.263

**已编辑**

对不起，我一定是数错了。这就是我不粘贴的结果。无论哪种方式，您是否有理由不只使用其中一个`ProgressBar`构造[函数](http://developer.android.com/reference/android/widget/ProgressBar.html#ProgressBar%28android.content.Context,%20android.util.AttributeSet,%20int%29)？这是我在其中使用 bar 的最新项目中的一行：

```
mProgress = new ProgressBar(this, null, android.R.attr.progressBarStyleHorizontal); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-02T19:20:02.970

`android.R.id.progress`与 .一起使用`ProgressBar`。

检查此链接： http: [//foo.jasonhudgins.com/2010/03/simple-progressbar-tutorial.html](http://foo.jasonhudgins.com/2010/03/simple-progressbar-tutorial.html)

因此，您的用法是错误的。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-03T09:02:26.793

在 Eclipse 中，通过单击“项目”>“清理...”来执行项目清理，单击项目旁边的复选框，然后单击“确定”。并尝试再次构建您的项目。

# iphone - NSMutableArray 中的选择器错误没有已知的实例方法

> ID：11299774
> 
> 赞同：0
> 
> 时间：2012-07-02T19:13:32.377
> 
> 标签：iphone, objective-c, xcode, nsmutablearray

我在访问数组中的对象时遇到问题。我将“放置”对象存储在我的 NSMutableArray 中。我想为我的 TableView 访问这个数组。我在第一行收到“没有已知的选择器实例方法”错误。请参阅下面的行。

```
cell.imageView = [[self.currentPlaces objectAtIndex:indexPath.row]picture];
cell.subtitleLB.text = [[self.currentPlaces objectAtIndex:indexPath.row]description];
cell.objectNameLB.text = [[self.currentPlaces objectAtIndex:indexPath.row]name]; 
```

这是我的地方对象：

```
@interface Place : NSObject{

CLLocation *objectLocation;
UIImageView *picture;
NSString *name;
NSString *description;
} 
```

属性“描述”和“名称”的访问没有问题。我只是不知道为什么会发生这个错误。

谢谢。多米尼克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T19:28:49.810

我有同样的问题; 对我有用的是传递 UIImage 而不是 UIImageView。所以你的代码应该是这样的：

```
@interface Place : NSObject{

CLLocation *objectLocation;
UIImage *picture;
NSString *name;
NSString *description;
} 
```

和这个

```
cell.imageView.image = [[self.currentPlaces objectAtIndex:indexPath.row]picture];
cell.subtitleLB.text = [[self.currentPlaces objectAtIndex:indexPath.row]description];
cell.objectNameLB.text = [[self.currentPlaces objectAtIndex:indexPath.row]name]; 
```

如果这不起作用，我会发布更多代码供您查看。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T19:38:37.223

您实际上还没有声明任何方法。您声明的是实例变量。您可能应该使用`@property`s 代替。

```
@interface Place : NSObject
@property (nonatomic, retain) CLLocation *objectLocation;
@property (nonatomic, retain) UIImageView *picture;
@property (nonatomic, copy) NSString *name;
@property (nonatomic, copy, getter=objectDescription) NSString *description;
@end 
```

这实际上将创建您想要的方法。请注意，我将`description`属性的方法更改为 read `-objectDescription`。这是因为`NSObject`已经声明了该`-description`方法，并且您不应该用不相关的属性覆盖它。

如果您使用最近的 Clang，那么这就是您所需要的，并且实例变量将自动合成（使用下划线前缀，例如`_picture`）。如果您使用的是旧版本（例如，如果这会导致错误），则需要添加`@synthesize`行，如

```
@implementation Place
@synthesize objectLocation=_objectLocation;
@synthesize picture=_picture;
@synthesize name=_name;
@synthesize description=_description;
@end 
```

# php - PHP foreach 循环中的数组范围

> ID：11299777
> 
> 赞同：3
> 
> 时间：2012-07-02T19:13:38.673
> 
> 标签：php, variables, scope, textarea

我正在学习 PHP，并且一直在为如何正确编写代码而苦恼。我有一个文本区域，它接受用户输入，它是由空格分隔的几行坐标（PT# Northing Easting）。

我让表单将 textarea 输入传递给 php 脚本来处理它。

我可以得到一个 foreach 循环来做我想要的，但只在 foreach 循环本地，变量不会传递到循环外部。

我知道这是一个全局变量范围问题，对于我来说，我无法解决这个问题......

下面是我的 PHP 代码，我遗漏了 HTML 表单，我对它没有任何问题，并且知道 textarea 正在正确传递。

```
**Sample data that I am inputing:
1 728258.24000 774337.29700
2 728232.15735 774277.54650
3 728326.39614 774216.82428**

<?php

$i = 0;
$j = 0;

//The code below explodes my textarea into a string array
//of separated lines.
$textArea = explode("\r", $_POST['textArea']);
$textNum = array();

//The code below works internally, but the values remain here
//I wanted to get them to the variables below so I can do work
//to them.
foreach ($textArea as $textRows) {

    //The code below explode the lines into elements separated by a space
    $textRow = explode(" ", $textRows);
    foreach ($textRow as $textItem) {
    $textNum[i][j] = $textItem;

    //The code below works within a local context
    echo "(" . $i . " " . $j . ")" . $textNum[i][j] . "</br>";
    $j++;
    }
    $i++;
    $j = 0;
}

//The code below is not receiving values from the foreach loop
//I know this has something to do with the variable scope
//I must be way off in my approach any help would be appreciated!
echo "</br>";
echo "</br> 0 0 " . $textNum[0][0];
echo "</br> 0 1 " . $textNum[0][1];
echo "</br> 0 2 " . $textNum[0][2];
echo "</br> 1 0 " . $textNum[1][0];
echo "</br> 1 1 " . $textNum[1][1];
echo "</br> 1 2 " . $textNum[1][2];
echo "</br> 2 0 " . $textNum[2][0];
echo "</br> 2 1 " . $textNum[2][1];
echo "</br> 2 2 " . $textNum[2][2];
echo "</br> 3 0 " . $textNum[3][0];
echo "</br> 3 1 " . $textNum[3][1];
echo "</br> 3 2 " . $textNum[3][2];
?> 
```

我希望我已经解释得足够好，并感谢我能得到的任何帮助！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T19:20:19.930

您的第二个循环中有一个错误：

```
$textNum[i][j] = $textItem; 
```

不得不：

```
$textNum[$i][$j] = $textItem; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:18:32.627

您需要`$`在变量之前添加，即，`$textNum[$i][$j]`而不是`$textNum[i][j]`，另外，最好在循环之前初始化`$i`并将`$j`它们设置为。`0``foreach`

# c# - 如何将图片框“居中”背景图像绘制到面板？

> ID：11299781
> 
> 赞同：0
> 
> 时间：2012-07-02T19:13:52.147
> 
> 标签：c#, winforms, picturebox

我很好地从 Alex M 那里获得了一个代码，用于将背景图像绘制到面板上，但我意识到如果 a`PictureBox`设置`BackgroundImage`了其 Center 图像属性，则绘制的图像会被拉伸但不会居中。我到目前为止有这个代码：

```
private void panel1_Paint(object sender, PaintEventArgs e)
{
    e.Graphics.DrawImage(pictureBox1.BackgroundImage, 
        new Rectangle(pictureBox1.Location, pictureBox1.Size));
} 
```

这会将背景图像绘制到面板，但如果`pictureBox1`的背景图像属性设置为 CENTER，它不会在矩形的中心绘制图像，而是拉伸图像以适合矩形。

我找到的唯一可能的解决方案是[here，](http://www.java2s.com/Code/CSharp/2D-Graphics/CenteranImageVerticalResolutionHorizontalResolution.htm)但我无法理解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:51:25.860

图像被拉伸的原因是因为 DrawImage 的第二个参数指定了绘制图像的位置和大小，并且指定了图片框的整个区域，而不是图像本身的区域。

如果要居中，请尝试以下操作：

```
private void panel1_Paint(object sender, PaintEventArgs e)
{
    var hPadding = (pictureBox1.Width - pictureBox1.BackgroundImage.Width) / 2;
    var vPadding = (pictureBox1.Height - pictureBox1.BackgroundImage.Height) / 2;
    var imgRect = new Rectangle(pictureBox1.Left + hPadding, pictureBox1.Top + vPadding, pictureBox1.BackgroundImage.Width, pictureBox1.BackgroundImage.Height);
    e.Graphics.DrawImage(pictureBox1.BackgroundImage, imgRect);
} 
```

# php - Mysql regexp 防止字符为数字

> ID：11299782
> 
> 赞同：1
> 
> 时间：2012-07-02T19:13:53.177
> 
> 标签：php, mysql

有人可以帮我解决这个错误。如果之后有另一个数字，我需要以下代码不匹配

```
$query = "SELECT * FROM mytable WHERE server_name REGEXP '(server ?" . $server_id . ")' "; 
```

例如，如果 $server_id 为 50，它当前匹配服务器 500、501 等，我也不想要它，但应该允许它匹配 'server50' 'server50 100mbit' 'server50,100mbit' 等。之后的字符需要可以是其他数字以外的任何东西，甚至可以什么都不是。

斯图

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:19:17.453

`[^0-9]`在正则表达式中匹配非数字。

```
$query = "SELECT * FROM mytable 
    WHERE server_name REGEXP 'server ?" . $server_id . "([^0-9]|\$)' "; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T19:24:11.913

你会想要对一个数字做一个正则表达式。/^0-9/ 然后你需要做的是如果返回一个匹配，你需要说“嘿，那是一个数字，错了！” 而如果它返回一个空集，那将是一个匹配项。

您还可以针对它不是数字执行正则表达式，将 NOT 字符放在 ^ 和 [ 之间。

我现在忘记了 NOT syntaqx，但用普通的术语来说，它看起来像 /^![0-9]/

斜线通常是正则表达式的符号。

使用您的东西，您需要执行类似 /^serverid[0-9][0-9]/ 的操作，它将正则表达式与 SERVERID[][] 进行比较，因此它只会读取前 2 个字符。如果有更多字符，您可以将其启动，或类似的事情

# cuda - GPU从CPU读取或CPU写入GPU？

> ID：11299784
> 
> 赞同：7
> 
> 时间：2012-07-02T19:14:01.117
> 
> 标签：cuda, opencl, gpu

我是并行编程的初学者。我有一个可能看起来很愚蠢的查询，但是当我用谷歌搜索它时，我没有得到明确的答案。

在 GPU 计算中，有一个设备即 GPU 和主机即 CPU。我写了一个简单的 hello world 程序，它将在 gpu 上分配一些内存，将两个参数（比如 src[] 和 dest[]）传递给内核，复制 src 字符串，即 Hello world 到 dest 字符串并从 gpu 获取 dest 字符串到主人。

字符串“src”是由 GPU 读取还是 CPU 写入 GPU？此外，当我们从 GPU 取回字符串时，是 GPU 写入 CPU 还是 CPU 从 GPU 读取？

在来回传输数据时，可能有四种可能性 1\. CPU 到 GPU - CPU 写入 GPU - GPU 从 CPU 读取 2\. GPU 到 CPU - GPU 写入 CPU - CPU 从 GPU 读取

有人可以解释一下哪些是可能的，哪些是不可能的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-02T20:06:11.350

在早期版本的 CUDA 和相应的硬件模型中，GPU 更严格地是 CPU 拥有的协处理器；CPU 将信息写入 GPU，并在 GPU 准备就绪时将信息读回。在较低级别，这意味着实际上所有四件事都在发生：CPU 将数据写入 PCIe，GPU 从 PCIe 读取数据，GPU 然后将数据写入 PCIe，然后 CPU 读回结果。但是事务是由 CPU 发起的。

最近（CUDA 3？4？甚至可能从 2 开始？），其中一些细节从应用程序级别隐藏，因此，GPU 代码可以有效地导致传输以与 CPU 相同的方式启动。考虑统一虚拟寻址，程序员可以访问统一的虚拟地址空间用于 CPU 和 GPU 内存。当 GPU 请求 CPU 空间中的内存时，这必须从 CPU 发起传输，本质上是从 CPU 读取。也保留了从 CPU 端将数据放到 GPU 上的能力。基本上，现在所有方式都是可能的，在顶层（在低层，它与往常一样基本上是同一类型的协议：读取和写入 PCIe 总线，但现在，GPU 也可以启动事务）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T22:30:16.827

其实这些都没有。您的 CPU 代码会*启动*数据的复制，但是当内存控制器通过您系统上的任何总线将**数据传输到 GPU 的内存时。**同时，CPU 可以处理其他数据。同样，当 GPU 运行完你启动的内核时，你的 CPU 代码会启动数据的复制，但同时 GPU 和 CPU 都可以处理其他数据或运行其他代码。

这些副本称为异步或非阻塞。您可以选择执行阻塞复制，其中 CPU 等待复制完成。

在启动异步任务时，您通常会注册一个“事件”，这是您可以稍后检查的某种标志，以查看任务是否完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-03T21:25:30.200

在 OpenCL 中，主机 (CPU) 专门控制 GPU 和 GPU 之间的所有数据传输。主机使用缓冲区将数据传输到 GPU。主机使用缓冲区从 GPU 传回（读取）。对于某些系统和设备，传输不是物理复制字节，因为主机和 GPU 使用相同的物理内存。这称为零拷贝。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-06T18:14:56.840

我刚刚在这个论坛[http://devgurus.amd.com/thread/129897](http://devgurus.amd.com/thread/129897) 发现使用 CL_MEM_ALLOC_HOST_PTR | clCreateBuffer 中的 CL_MEM_COPY_HOST_PTR 在主机上分配内存，并且不会在设备上复制。

性能可能存在问题，但这是我正在寻找的。请你的意见..

# iis - Xdebug 不作为 zend 扩展 IIS7

> ID：11299787
> 
> 赞同：6
> 
> 时间：2012-07-02T19:14:15.537
> 
> 标签：iis, xdebug, php-ini

我无法作为扩展名`xdebug`加载，因为它会自动输入错误的术语。`Zend``php.ini`

中的消息`phpinfo()`是

> XDEBUG 未作为 ZEND 扩展加载

我在 Windows Server 2008 R2 Enterprise PHP 5.3.8 Zend Engine v2.3.0 上使用 IIS 7.5

我的部分`php.ini`：

```
[xdebug]
zend_extension=php_xdebug-2.2.0-5.3-vc9-nts.dll
xdebug.remote_enable=1
xdebug.remote_host="localhost"
xdebug.remote_port=9000
xdebug.remote_handler="dbgp" 
```

没有记录错误。

我需要激活 IIS 设置中的每个扩展。当我然后重新启动 IIS 时，`php.ini`更新为该行

```
[PHP_XDEBUG-2.2.0-5.3-VC9-NTS]
extension=php_xdebug-2.2.0-5.3-vc9-nts.dll 
```

为什么这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-29T12:27:55.923

（由 OP 解决并在问题编辑中回答。转换为社区 wiki 答案。请参阅[没有答案的问题，但问题在评论中解决（或在聊天中扩展）](https://meta.stackoverflow.com/questions/251597/question-with-no-answers-but-issue-solved-in-the-comments)）

OP写道：

> 它现在可以在将扩展路径更改为绝对路径后工作。无论如何添加了 2 行，但`phpinfo()`现在显示了完整的 xdebug 配置。

工作部分`php.ini`：

```
[PHP_XDEBUG-2.2.0-5.3-VC9-NTS]
zend_extension="C:\Program Files (x86)\php\ext\php_xdebug-2.2.0-5.3-vc9-nts.dll"
xdebug.remote_enable=1
xdebug.remote_host="localhost"
xdebug.remote_port=9000
xdebug.remote_handler="dbgp"
[PHP_XDEBUG-2.2.0-5.3-VC9-NTS]
extension=php_xdebug-2.2.0-5.3-vc9-nts.dll 
```

# c - 新手：编译时出现C语法错误

> ID：11299789
> 
> 赞同：1
> 
> 时间：2012-07-02T19:14:22.277
> 
> 标签：c, for-loop, comma-operator

```
 for(int a = 0, b = 1; b < n; a++; b++)
    {
        if (compare(values[a], values[b]))
            counter++;
        else
            {
            int x = values[a];
            values[a] = values[b];
            values[b] = x;
            }
    } 
```

当我尝试编译时，第一行 [ for(int... ] 出现此错误：

```
helpers.c:68:41: error: expected ')' before ';' token 
```

为什么我需要添加另一个')'？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-02T19:15:09.357

```
for(int a = 0, b = 1; b < n; a++; b++)
                                ^
                                |
                              problem 
```

您需要在-loop的末尾使用逗号 ( `,`) 而不是分号 ( ) 来增加和：`;``for``a``b`

```
for(int a = 0, b = 1; b < n; a++, b++)
                                ^ 
```

这是[逗号运算符](http://www.eskimo.com/~scs/cclass/int/sx4db.html)。

这两个 SO 问题也可能会有所帮助：[如何在 C++ 'for' 循环中放置两个增量语句？](https://stackoverflow.com/questions/1232176/how-to-put-2-increment-statements-in-c-for-loop) C中[完整的“for”循环语法是什么（以及其他兼容的情况下）是什么？](https://stackoverflow.com/questions/276512/what-is-the-full-for-loop-syntax-in-c-and-others-in-case-they-are-compatible)

# algorithm - 修改具有边权重和距离的欧几里德图的星形路由

> ID：11299790
> 
> 赞同：3
> 
> 时间：2012-07-02T19:14:38.450
> 
> 标签：algorithm, optimization, routing, graph-theory, openstreetmap

我正在编写一个应用程序来建议[OpenStreetMap](http://www.openstreetmap.org/)数据上的圆形路线，但要受到一些约束（定向问题）。在我正在试验的算法的最内层循环中，需要找到两个给定点之间的最低成本路径。给定图的布局（基本上是[欧几里得](http://en.wikipedia.org/wiki/Geometric_graph_theory)），[A 星](http://en.wikipedia.org/wiki/A%2a_search_algorithm)算法似乎有可能在给定图的最快时间内产生结果。然而，除了边缘的距离（代表地图上的实际距离）外，我还有一系列权重（目前从 0.0 缩放，最不理想到 1.0，最理想），表明特定边缘（道路/路径/等）的理想程度) 是根据我为我的应用程序设计的一些指标计算的。

我想根据这些权重修改我的距离。我知道标准的 A 星启发式方法依赖于路径的真实成本至少与估计值一样大（基于点之间的欧几里德距离）。所以我的第一个想法是提出一个方案，其中最小边缘距离是实际距离（对于权重 1.0），并且随着权重的减小，距离会增加（例如，对于权重 0.0，距离增加四倍）。这似乎是一种明智的方法，还是在这种情况下有更好的标准快速路由技术？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T20:07:38.210

我相信你的方法是最理智的。显然我正在研究一个类似的问题，我决定使用完全相同的策略。

A* 算法不一定依赖于“真实距离”。它甚至与距离无关，您实际上可以最小化其他物理量 - 启发式函数应该具有相同的物理单位。

例如，我的问题是最小化路径**时间**，而任何给定点的速度取决于位置、时间和选择的方向。我的启发式函数是粗略距离（我的问题是在地球表面，计算大圆距离有点贵）除以最大允许速度。也就是说，它有时间单位，它被解释为从给定位置到达终点的最乐观时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T22:38:16.360

相关问题是：“您实际上想要最小化什么？”。您需要以单个“修改距离”结束，以便您的寻路算法可以选择最小的距离。

[A* 算法](http://en.wikipedia.org/wiki/A%2a_search_algorithm)的持续有用性取决于您如何将“合意性”整合到您的路由距离中。A* 需要一个乐观的“[可接受的启发式](http://en.wikipedia.org/wiki/Admissible_heuristic)”：“修改后的距离”的启发式估计不得超过实际的“修改后的距离”（否则，它找到的路径实际上可能不是最优的......）。确保这一点的一种方法是确保修改后的距离始终大于任何给定步骤的原始欧几里得距离；那么，任何可以使欧几里得距离最小化的 A* 启发式算法也可以用于最小化修改后的距离。

例如，如果您计算`modified_distance = euclidean_distance / desirability_rating`(for `0<desirability_rating<=1`)，您`modified_distance`将永远不会小于`euclidean_distance`: 无论您用于未加权路径的 A* 启发式仍然是乐观的，因此它可用于 A*。（虽然，在每条路径都不受欢迎的区域，高度过度乐观的 A* 启发式可能不会像您希望的那样提高性能......）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T21:24:12.933

Fast(er) 路由可以用 A* 来完成。在我自己的项目中，我看到了大约的提升。[比](https://github.com/karussell/GraphHopper/wiki/Performance)dijkstra快 4 倍- 所以，甚至比[双向 dijkstra](http://en.wikipedia.org/wiki/Bidirectional_search)还要快。

但是还有很多技术可以提高查询速度——例如引入快捷方式并在该图上运行 A*。[这](https://gis.stackexchange.com/a/29963/9006)是一个更详细的答案。

# php - 为什么我不能在这个 PHP 代码中设置字符串值？

> ID：11299793
> 
> 赞同：1
> 
> 时间：2012-07-02T19:15:01.857
> 
> 标签：php

我参观：

[http://www.mydomain.com/test.php?loc=1](http://www.mydomain.com/test.php?loc=1)

这应该将 $location 设置为 'VC' 并将其打印到屏幕上。

但是当我这样做时，我得到一个零'0'。

我在做什么错，为什么我不能设置一个字符串？

```
<?php
    $loc = $_REQUEST['loc'] ;
if($loc == 1){
$location = 'VC';
echo 'yes';
}
else {
echo "ERROR - Wrong Location code presented";
}   
    echo 'Location: ' + $location;

?> 
```

我开始：

```
<?php
    $loc = $_REQUEST['loc'] ;
    echo 'Location: ' + $loc;
?> 
```

我要去的地方：

[http://www.mydomain.com/test.php?loc=VC](http://www.mydomain.com/test.php?loc=VC)

它会做我想做的事，但这没有用。

我一定遗漏了一些明显的东西，但我看不到什么。帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T19:18:53.453

你必须改变它：

```
<?php
    $loc = $_REQUEST['loc'] ;
    echo 'Location: ' + $loc;
?> 
```

对此：

```
<?php
    $loc = $_REQUEST['loc'] ;
    echo 'Location: ' . $loc;
?> 
```

PHP 的字符串连接运算符是`.`点而不是`+`JavaScript 等中使用的 a。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T19:19:21.247

如 Mattedgod 所述，使用`$_GET['loc']`代替`$_REQUEST['loc']`并与 a`.`而不是 a连接。`+`

Why `$_GET` instead of `$_REQUEST`?? See: [Among $_REQUEST, $_GET and $_POST which one is the fastest?](https://stackoverflow.com/questions/1924939/php-request-vs-get-and-post)

# wordpress - .htaccess 和 Wordpress - 子目录不重写

> ID：11299802
> 
> 赞同：0
> 
> 时间：2012-07-02T19:15:24.630
> 
> 标签：wordpress, .htaccess, rewrite

我在一个托管帐户上托管多个域。其中一个域使用 Wordpress 并位于子目录 (/foo) 中，而另一个域位于主目录中。我已成功更改根 .htaccess 文件以将 Wordpress 站点的主页重写为正确的域，但 Wordpress 站点的后续页面未重写。

```
Example: foo.com (Wordpress site) 
         bar.com (other site in root) 
```

bar.com/foo 正确显示为 foo.com....但是 bar.com/foo/page1 没有重写并且按原样显示（而不是 foo.com/page1）。我正在寻找重写而不是重定向。我在根文件夹中使用的 .htaccess 代码如下。我没有更改由 Wordpress 在 bar.com/foo 中创建的默认 .htaccess 文件。我错过了什么吗？任何帮助深表感谢。

```
RewriteEngine On 
RewriteBase / 
RewriteCond %{REQUEST_URI} !^/foo/ 
RewriteCond %{HTTP_HOST} ^(www\.)?foo\. 
RewriteRule ^(.*)$ foo/$1 [L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T14:44:41.480

> 我将如何重写这些页面？

如果您希望请求`bar.com/foo/page1`显示`foo.com/page1`在地址栏中，则需要重定向（而不是像上面那样的内部重写。它看起来像这样：

```
RewriteCond %{HTTP_HOST} bar\.com$ [NC]
RewriteRule ^foo/(.*)$ http://foo.com/$1 [R=301,L] 
```

# iphone - 更改 UIView 的背景颜色

> ID：11299803
> 
> 赞同：1
> 
> 时间：2012-07-02T19:15:25.330
> 
> 标签：iphone, objective-c, uiview, background, rgb

我正在与委托进行一些练习，但现在我遇到了 UIView 的问题。这是我的故事板![在此处输入图像描述](../Images/7d89bdd4f41bb660d68d9ac3decbbdcc.png)

我想用 3 个 UISlider 改变 UIView 的颜色。UISliders 的范围是从 0 到 255。这是我的代码：

ColorField 是 UIView 自定义类

**颜色字段.h**

```
#import <UIKit/UIKit.h>

@protocol ColorFieldDelegate <NSObject>

-(NSArray *)giveMeColors;

@end

@interface ColorField : UIView

@property (nonatomic , weak) IBOutlet id<ColorFieldDelegate> delegate;

@end 
```

**颜色域.m**

```
#import "ColorField.h"

@implementation ColorField
@synthesize delegate = _delegate;

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
    }
    return self;
}

// Only override drawRect: if you perform custom drawing.
// An empty implementation adversely affects performance during animation.
- (void)drawRect:(CGRect)rect
{
    // Drawing code
    NSArray *arrayOfColors = [self.delegate giveMeColors];
    int red = [[arrayOfColors objectAtIndex:0] intValue];
    int green = [[arrayOfColors objectAtIndex:1] intValue];
    int blue = [[arrayOfColors objectAtIndex:2] intValue];

    NSLog(@"Red --> %d" ,red);
    NSLog(@"Green --> %d" ,green);
    NSLog(@"Blue --> %d \n\n" ,blue);

    self.backgroundColor = [UIColor colorWithRed:red green:green blue:blue alpha:1.0];

}

@end 
```

**颜色视图控制器.h**

```
#import <UIKit/UIKit.h>
#import "ColorField.h"

@interface ColorViewController : UIViewController <ColorFieldDelegate> 

@property (nonatomic) IBOutlet ColorField *colorField;

@property (weak, nonatomic) IBOutlet UISlider *redSlider;

@property (weak, nonatomic) IBOutlet UISlider *greenSlider;

@property (weak, nonatomic) IBOutlet UISlider *blueSlider;

@end 
```

**颜色视图控制器.m**

```
#import "ColorViewController.h"

@interface ColorViewController ()

@property (nonatomic) double redQuantity;
@property (nonatomic) double greenQuantity;
@property (nonatomic) double blueQuantity;

@end

@implementation ColorViewController

@synthesize colorField = _colorField;
@synthesize redSlider;
@synthesize greenSlider;
@synthesize blueSlider;

@synthesize redQuantity;
@synthesize blueQuantity;
@synthesize greenQuantity;

- (void)viewDidLoad
{
    [super viewDidLoad];
    [self.colorField setDelegate:self];
    [self.colorField setNeedsDisplay];

    self.redQuantity = 125.0;
    self.blueQuantity = 125.0;
    self.greenQuantity = 125.0;

    [self.colorField setNeedsDisplay];
    // Do any additional setup after loading the view, typically from a nib.
}

-(ColorField *)colorField
{
    if (_colorField == nil) {
        _colorField = [[ColorField alloc] init];
    }
    return _colorField;
}

- (void)viewDidUnload
{
    [self setColorField:nil];
    [self setRedSlider:nil];
    [self setGreenSlider:nil];
    [self setBlueSlider:nil];

    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

-(IBAction)changeRedQuantity:(UISlider *)sender
{
    //methods of UISliders
    self.redQuantity = [sender value];
    [self.colorField setNeedsDisplay];
}

-(IBAction)changeBlueQuantity:(UISlider *)sender
{
    self.blueQuantity = [sender value];
    [self.colorField setNeedsDisplay];
}

-(IBAction)changeGreenQuantity:(UISlider *)sender
{
    self.greenQuantity = [sender value];
    [self.colorField setNeedsDisplay];
}

-(NSArray *)giveMeColors
{
    NSNumber *redNumber = [NSNumber numberWithDouble:self.redQuantity];
    NSNumber *greenNumber = [NSNumber numberWithDouble:self.greenQuantity];
    NSNumber *blueNumber = [NSNumber numberWithDouble:self.blueQuantity];

    NSArray *array = [[NSArray alloc] initWithObjects:redNumber, greenNumber,blueNumber, nil];

    return array;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

@end 
```

但是...这是结果：它只显示没有渐变的红色、绿色和蓝色，例如：RGB (255,0,75) is THIS

![在此处输入图像描述](../Images/391ac9d7d7eb20407700aabb59f1754b.png)

而不是这个：

![在此处输入图像描述](../Images/94921f904222c7ae1fafc9681af526c1.png)

我不知道它不能向我显示渐变...

谢谢！！

马可·曼佐尼

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-02T19:20:26.563

您必须将滑块值除以 255.0。

`[UIColor colorWithRed:red/255.0 green:green/255.0 blue:blue/255.0 alpha:1.0];`

```
colorWithRed only accepts values 0.0-1.0 
```

# objective-c - 如何判断用户何时点击 UITableViewCell？

> ID：11299807
> 
> 赞同：0
> 
> 时间：2012-07-02T19:15:43.673
> 
> 标签：objective-c, ios, xcode, uitableview

我正在开发一个 iOS 应用程序，其中我在 UITableViewCells 中有 UIWebviews。UIWebViews 占据了大约 50% 的单元格，其余的单元格是空白的。当用户点击我的一个单元格时，我需要能够做出响应。我已经尝试实现该`- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath`方法，但这仅在用户点击我的单元格中不包含 uiwebview 的部分时才会响应。无论用户在我的单元格中的哪个位置录制，有什么方法可以响应点击？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:19:41.400

您可以将`userInteractionEnabled`您的属性设置`UIWebView`为`NO`，但在这种情况下您将无法滚动它..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T19:20:10.367

您的设计肯定很糟糕：Apple 在 UIWebView 类参考中明确表示，您**不应该将 UIWebViews 添加到表格单元格中**。此外，由于 web 视图在内部管理一个 UIScrollView，它捕获所有的触摸。所以做你想做的唯一方法是继承 UIWebView 并覆盖触摸管理方法。这也是不可取的，因为**UIWebView 是少数几个不根据 Apple 进行子类化的类之一。**

您必须认真重新考虑您的设计模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T19:20:04.100

首先，对您的 webview执行[此操作。](http://mithin.in/2009/08/26/detecting-taps-and-events-on-uiwebview-the-right-way)`didSelectRowAtIndexPath`然后，在注册点击时调用 tableView 的方法。有点痛苦，但我能想到的唯一方法。这将允许用户以完全正常的方式与 webview 交互，但发送让表格知道正在与哪个单元格交互。如果这不是您想要的，其他答案应该有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T19:20:06.123

尝试将 a 连接`UITapGestureRecognizer`到您的单元格。

# ruby-on-rails - Ruby on Rails Route 简化视图文件夹

> ID：11299810
> 
> 赞同：0
> 
> 时间：2012-07-02T19:15:55.567
> 
> 标签：ruby-on-rails, model-view-controller, routes

我很难理解 Rails 中的路线。我有一个包含一堆投资组合页面的文件夹。每一个都是 .html.erb 格式，我为每一个都做了一条获取路线。

我怎样才能简化这个？

```
Location: app>views

portfolio/uniquename1.html.erb
portfolio/rexpage.html.erb
portfolio/armstrong.html.erb
portfolio/occupy.html.erb
portfolio/fancythat.html.erb 
```

ETC...

路线如下所示：

```
NewPortfolio::Application.routes.draw do

get "portfolio/uniquename1"
get "portfolio/rexpage"
get "portfolio/armstrong" 
get "portfolio/occupy" 
get "portfolio/fancythat" 

etc... 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:17:37.887

```
resources :portfolio do
  collection do
    get 'occupy'
    get 'armstrong'
    ...
  end
end 
```

静态页面在 Rails 中有点尴尬。你应该尽量减少它们。这是一个处理几种不同解决方案[的 RailsCast 。](http://railscasts.com/episodes/117-semi-static-pages/)

# wpf - WPF 和 Silverlight 中的单选按钮

> ID：11299811
> 
> 赞同：1
> 
> 时间：2012-07-02T19:15:57.923
> 
> 标签：wpf, silverlight

可以将单选按钮设置为在单击时在选中和未选中之间切换吗？我是否需要为每个按钮编写一个特殊的事件来实现它，或者只是设置一些简单的属性？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T19:28:05.883

单选按钮将根据它们的分组处理自己的检查和取消检查。单选按钮按父控件和[GroupName](http://msdn.microsoft.com/en-us/library/system.windows.controls.radiobutton.groupname.aspx)属性分组。

例如，以下代表两组不同的单选选项。

```
<StackPanel>
    <RadioButton Content="Radio 1" />
    <RadioButton Content="Radio 2" />
    <RadioButton Content="Radio 3" />
    <RadioButton Content="Radio 4" />
</StackPanel>
<StackPanel>
    <RadioButton Content="Radio 5" />
    <RadioButton Content="Radio 6" />
    <RadioButton Content="Radio 7" />
    <RadioButton Content="Radio 8" />
</StackPanel> 
```

但是使用该`GroupName`属性，例如，我们可以有三个组：

```
<StackPanel>
    <RadioButton GroupName="Group1" Content="Radio 1" />
    <RadioButton GroupName="Group2" Content="Radio 2" />
    <RadioButton GroupName="Group1" Content="Radio 3" />
    <RadioButton GroupName="Group2" Content="Radio 4" />
</StackPanel>
<StackPanel>
    <RadioButton Content="Radio 5" />
    <RadioButton Content="Radio 6" />
    <RadioButton Content="Radio 7" />
    <RadioButton Content="Radio 8" />
</StackPanel> 
```

在上面的代码中，第 1 和第 3 无线电独立于第 2 和第 4 无线电进行分组。

# asp.net-mvc - 任何简单的内置方法来保护asp.net mvc中的xss？

> ID：11299813
> 
> 赞同：0
> 
> 时间：2012-07-02T19:16:20.467
> 
> 标签：asp.net-mvc, security, xss

我有一个新闻提要样式字段，管理员可以对其进行编辑，该字段将显示在用户的页面上。所有用户和所有管理员都已获得批准，因此这是一个相当低安全性的事情。

是否有一种简单的内置方法来验证他们的恶意脚本注入输入？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T19:22:47.383

Microsoft Web 保护库：[http ://wpl.codeplex.com/](http://wpl.codeplex.com/)

它不是内置的，但它受到高度重视并为 ASP.NET 构建

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T21:07:43.107

不幸的是，我认为目前还没有任何东西既简单又成熟。您可以尝试[OWASP Enterprise Security API](https://www.owasp.org/index.php/ESAPI)，但您可能不会比使用[WPL](http://wpl.codeplex.com/)更快乐。

我建议您遵守[OWASP XSS](https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet)指南，但我怀疑您已经很熟悉了。

# jquery - 有没有办法更改 jquery datepicker 的键盘快捷键？

> ID：11299816
> 
> 赞同：0
> 
> 时间：2012-07-02T19:16:25.470
> 
> 标签：jquery, datepicker, shortcuts, hotkeys

我想更改默认`ctrl`+`home`以将日期选择器重新打开到 enter 键。我将日期选择器绑定到输入，并且在选择日期后它当前不会更改焦点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T20:25:32.757

您可以单独绑定键事件，而不是尝试更改快捷键。

```
$("#datepicker").keydown(function(e){ 
    if(e.which == 13 && !$(this).datepicker("widget").is(":visible")) {
        $(this).datepicker("show");
    }
}); 
```

# iphone - iOS 设备中的图标 100x100 命名约定

> ID：11299817
> 
> 赞同：0
> 
> 时间：2012-07-02T19:16:45.073
> 
> 标签：iphone, objective-c, ios, ipad, xcode4.3

在[iOS 人机界面指南](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/mobilehig/IconsImages/IconsImages.html)中，明确指出建议使用聚光灯搜索图标。特别是对于与聚光灯一起使用的 iPad 视网膜 100x100 尺寸，必须为图标指定哪个名称？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T19:24:38.620

从这篇[文章](http://developer.apple.com/library/ios/#qa/qa1686/_index.html)：

> **iPhone 应用程序**
> 
> **文件大小** | **文件名**| **用于**| **所需状态**
> 
> 29x29 | 图标-小.png | 聚光灯和设置 | 可选但推荐
> 
> 50x50 | 图标-Small-50.png | 聚焦 iPad 兼容性 | 如果您有设置捆绑包，则建议使用，否则为可选但建议使用
> 
> 58x58 | 图标-小@2x.png | iPhone 4 高分辨率的 Spotlight 和设置 如果您有设置捆绑包，则推荐，否则可选但推荐
> 
> **iPad 应用程序**
> 
> **文件大小** | **文件名**| **用于**| **所需状态**
> 
> 50x50 | 图标-Small-50.png | 聚焦 iPad | 可选但推荐
> 
> 29x29 | 图标-小.png | iPad 上的设置 | 如果您有设置捆绑包，则建议使用，否则为可选但建议使用

我没有看到 100 x 100 的文件...

无论如何，希望这会有所帮助！

**- -更新 - -**

刚从[这里](http://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/App-RelatedResources/App-RelatedResources.html#//apple_ref/doc/uid/TP40007072-CH6-SW1)找到它，上面写着：

> 图标的@2x 变体仅适用于配备 Retina 显示屏的设备。
> 
> 聚光灯 | **图标-Small-50@2x.png** | 100×100

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T19:27:01.930

**聚焦：Icon-Small-50@2x.png - 100 x 100**

如此处所示：[新 iPad 的高分辨率/视网膜显示应用程序图标文件名](https://stackoverflow.com/questions/9780134/high-resolution-retina-display-app-icon-file-names-for-the-new-ipad)

> 对于在配备 Retina 显示屏的设备上运行的应用程序，应提供每个图标的两个版本，第二个是原始图标的高分辨率版本。除了在高分辨率图像的文件名中包含字符串@2x 之外，两个图标的名称应该相同。

# oracle - 在现有表中禁用读取和写入

> ID：11299819
> 
> 赞同：1
> 
> 时间：2012-07-02T19:16:55.873
> 
> 标签：oracle, oracle11g

我们在 oracle 11g 数据库中已经存在一个表，它允许读取和写入操作。我想阻止对表的读取和写入操作。你能帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T19:24:10.177

使用[REVOKE 命令](http://docs.oracle.com/cd/E14072_01/server.112/e10592/statements_9020.htm)取消其他用户的权限。但是，您不能撤销表所有者的权限。

您也可以导出表，然后将其删除。那时没有人可以阅读它:-)

# php - mysql 查询因不明原因而失败（对我而言）

> ID：11299821
> 
> 赞同：1
> 
> 时间：2012-07-02T19:17:07.803
> 
> 标签：php, mysql

该错误仅显示部分查询，有人可以看到我犯的错误吗？

我想要的是基于标签获取条目，有 3 个表，nv_entries、nv_tags 和 nv_images。如果标签在 nv_tags 表中，那么它应该使用该表中的 entrie_id 从 nv_entries 和 nv_images 中获取内容。

表格如下所示：

```
nv_entries:
id - title - year - etc..

nv_tags:
id - entrieid - tag

nv_images:
id - entrieid - source 
```

查询失败：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“GROUP BY nv_entries JOIN ON nv_entries.id = nv_tags.entrie_id AND nv_tags.tag IN”附近使用正确的语法

在下面的脚本中生成的查询如下所示：

`GROUP BY nv_entries JOIN ON nv_entries.id = nv_tags.entrie_id AND nv_tags.tag IN ('tree','green') HAVING COUNT(DISTINCT nv_tags.tag) = 2`

这是脚本（部分）：

```
for ($i = 0; $i < count($tags); $i++) {
    $tags[$i] = trim($tags[$i]);
}

$query = "GROUP BY nv_entries JOIN ON nv_entries.id = nv_tags.entrie_id AND nv_tags.tag IN (";
// add with following comma
for ($i = 0; $i < count($tags)-1; $i++) {
    $query .= "'".$tags[$i]."',";
}
// add last without a comma
$query .= "'".$tags[count($tags)-1]."'";

$query .= ") HAVING COUNT(DISTINCT nv_tags.tag) = ".count($tags);

echo $query;

$entries = execSelect($query);

echo "<pre>";
print_r($entries);
echo "</pre>"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T19:29:35.790

Your query is malformed!

A draft cold be the following:

```
$sql ="
select e.*
from nv_entries e
JOIN nv_tags t on t.entrie_id = e.id
where t.tag in ( $tag_list )
group  by e.id
having count(t.id) = $num_tags "; 
```

ADD join with images

This query will return 1 line per image, using **LEFT** avoid missing line if missing image.

```
$sql ="
select e.*, i.*, group_concat( t.tag separator ',') as tag_list
from nv_entries e
JOIN nv_tags t on t.entrie_id = e.id
LEFT JOIN nv_images i on i.entrie_id = e.id

where t.tag in ( $tag_list )
group  by e.id
having count(t.id) = $num_tags "; 
```

# java - 获取系统语言并与 ResourceBundle 一起使用

> ID：11299823
> 
> 赞同：1
> 
> 时间：2012-07-02T19:17:11.980
> 
> 标签：java, localization, locale, resourcebundle

我如何获得系统的当前语言并将其用于 ResourceBundle？

假设客户端的机器以日语运行，那么我希望我的应用程序切换到日语，如果该语言文件不可用，它应该有一个后备解决方案。

我知道我可以使用 ResourceBundle，但我将如何完成上述设置？

```
ResourceBundle bundle = ResourceBundle.getBundle("lang", new Locale("jp", "JP")); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:31:04.823

The resource bundle automatically tries the system's current language, and then falls back to the default if that doesn't exist (`ResourceBundle.getBundle("lang")` will search in the following order, presuming that the system language is `jp_JP`: `lang_jp_JP.properties` -> `land_jp.properties` -> `lang.properties` ). You can look at the process ResourceBundle uses to resolve names [here](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/ResourceBundle.html#getBundle%28java.lang.String,%20java.util.Locale,%20java.lang.ClassLoader%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:30:42.060

From [http://java.sun.com/developer/technicalArticles/Intl/ResourceBundles/](http://java.sun.com/developer/technicalArticles/Intl/ResourceBundles/)

> For each language translation of your product, you create a new version of your initial resource bundle. For example, if you create MyResource to store all English text, you will create a similarly named file to store the French text. Resource bundles use a naming convention that distinguishes the potentially numerous versions of essentially the same bundle. Each bundle name consists of a base name and an optional locale identifier. Together, these two pieces uniquely identify a bundle in a package.
> 
> Using the above example, the French version of the resources should be named MyResource_fr_FR. The Canadian French version should be MyResource_fr_CA.
> 
> Appending the locale name to the base name of the bundle effectively links the bundle's usage to a specific locale. **When you ask for the bundle using ResourceBundle.getBundle("MyResource"), the getBundle method appends the default locale identifier to the base name and loads the appropriate bundle.** If the locale is fr_CA, then a call to ResourceBundle.getBundle("MyResource") will load the MyResource_fr_CA bundle.

# java - 在主要活动显示主要内容视图之前添加片段

> ID：11299831
> 
> 赞同：2
> 
> 时间：2012-07-02T19:17:58.630
> 
> 标签：java, android, user-interface, android-fragments, android-activity

### 溅

我的主要活动 UI 启动操作需要 5-10 秒（需要在主 UI 线程上处理） - 所以我想使用启动屏幕而不是默认的黑色或无响应的主 UI。

下面提供了一个很好的闪屏解决方案

*   这是首先设置`setContentView(R.layout.splash)`，
*   然后进行必要的主 UI 处理（在 UI 线程上，但主视图不可见）
*   什么时候准备好`setContentView(R.layout.main)`

[黑屏前的Android启动画面](https://stackoverflow.com/questions/10967532/android-splash-screen-before-black-screen)

* * *

### 碎片飞溅

我也在使用片段，通常需要`setContentView(R.layout.main)`在片段实例化之前调用片段 - 以便片段管理器可以找到视图存根`R.layout.main`以将片段膨胀到（*严格来说，视图存根是另一回事*）。

*   但我不能`setContentView(R.layout.main)`在创建片段之前调用，因为它会用（尚未准备好的）主屏幕替换初始屏幕。
*   我的恐惧是我想做的事做不到？
*   不幸的是，没有像`fragmentTransaction.add(viewNotViewId, fragment);`

* * *

### 几乎答案

除了关键之外，这是`setContentView`在片段事务之前调用的所有内容： [How do I add a Fragment to an Activity with a programmatically created content view](https://stackoverflow.com/questions/5159982/how-do-i-add-a-fragment-to-an-activity-with-a-programmatically-created-content-v)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T20:16:19.783

您可以尝试在 FragmentActivity 中替换您的片段，这是部分编码的想法：假设您有这样的片段布局（main.xml）：

```
<LinearLayout android:layout_width="match_parent" android:layout_height="match_parent" android:orientation="horizontal">

    <LinearLayout android:id="@+id/waiting" ...>
    </LinearLayout>

    <!-- hidden layout -->
    <LinearLayout>
        <LinearLayout android:id="@+id/layout_list_items" ...>
        </LinearLayout>
        <LinearLayout android:id="@+id/layout_detail" ...>
        </LinearLayout>
    </LinearLayout>

</LinearLayout> 
```

你的 FragmentActivity 是这样的：

```
public class FragmentsActivity extends FragmentActivity {

    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        this.setContentView(R.layout.main);

        Fragment fragA = new WaitingTransaction();

        FragmentTransaction fragTrans = this.getSupportFragmentManager().beginTransaction();
        fragTrans.add(R.main.waiting, fragA);
        fragTrans.commit();
    }

    private void afterProcessing(){

                //show hidden layout and make the waiting hidden through visibility, then add the fragment bellow...
        FragmentTransaction fragTrans = this.getSupportFragmentManager().beginTransaction();
        fragTrans.add(R.main.layout_list_items,
                          new FragmentList());
        fragTrans.replace(R.main.layout_detail,
                          new FragmentB());
        fragTrans.commit();
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T20:12:10.513

在不调用任何代码的情况下尝试此代码`setContentView`

```
fragmentTransaction.add(android.R.id.content, Fragment.instantiate(MainActivity.this, SplashFragment.class.getName())); 
```

这里的主要方法是在视图中放置带有 id 的片段，该 id`android.R.id.content`在任何布局通过膨胀之前始终存在`setContentView`

# javascript - document.activeElement 在 onblur 处理程序中返回正文

> ID：11299832
> 
> 赞同：25
> 
> 时间：2012-07-02T19:18:09.273
> 
> 标签：javascript, html, tabindex

这是我的 HTML 和 JS：

```
function invokeFunc() {
  // ajax request 
  alert(document.activeElement);
  // this returns body element in firefox, safari and chrome.
}
```

```
<input id="text1" tabindex="1" onblur="invokeFunc()" />
<input id="text2" tabindex="2" onblur="invokeFunc()" />
```

我正在尝试将焦点设置在具有适当 tabindex 设置的文本框上。

当我调用 JavaScript 函数 onblur 并尝试获取`document.activeElement`它时，它总是返回主体元素而不是焦点所在的活动元素。

如何返回活动元素而不是正文？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-02T19:20:53.547

在离开旧元素和进入新元素之间，活动元素确实是文档/正文本身。

演示：http: [//jsfiddle.net/u3uNP/](http://jsfiddle.net/u3uNP/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2021-05-06T11:46:36.257

@ThiefMaster 解释了原因，我想添加一个解决方案来获取新关注的元素：

使用`focusout`代替`onblur`，然后利用`relatedTarget`属性：

```
const inputs = document.getElementsByTagName('input');
for (var i = 0; i < inputs.length; ++i) {
  inputs[i].addEventListener('focusout', (event) => {  
    console.log('newly focused element:', event.relatedTarget); 
  });
}
```

```
<input id="text1" tabindex="1" />
<input id="text2" tabindex="2" />
```

# facebook - 如何授权应用发布到 URL 的对象页面新闻源？

> ID：11299834
> 
> 赞同：2
> 
> 时间：2012-07-02T19:18:22.150
> 
> 标签：facebook, facebook-graph-api, object, authorization, publish

我正在尝试为品牌页面提供一种向特定粉丝（而不是所有粉丝）发送消息的方式，方法是允许人们喜欢 URL 以显示他们的亲和力，然后发布到 URL 的提要，以便将消息发送给粉丝。

想象一个品牌“Foo”的产品 A、B 和 C。在 Facebook 上告诉人们喜欢 Foo 可能是有益的，但那些想要产品 B 或 C 的信息的人可能会觉得他们被产品 A 的信息淹没了. 同时，所有的粉丝可能都想了解品牌的一般信息。同时，品牌可能不希望管理多个 Facebook 时间线的开销（请参阅耐克为每个可能的产品/运动收集的页面）。壳牌目前正在使用他们的[On The Road](http://www.facebook.com/Shell?v=app_369684813048582)页面来执行此操作。

为了做到这一点，我首先创建了一个应用程序来发布并检索一个应用程序访问令牌。

```
https://graph.facebook.com/oauth/access_token?client_id=APP_ID_HERE&client_secret=APP_SECRET_HERE&grant_type=client_credentials 
```

接下来，我创建了一个页面，其中包含表示亲和力所需的 Open Graph 元数据：

```
<html lang="en">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
  <meta property="fb:app_id"      content="APP ID GOES HERE" /> 
  <meta property="og:type"        content="product" /> 
  <meta property="og:site_name"    content="FB Test!" />
  <meta property="og:url"         content="http:///url.to/object.html" /> 
  <meta property="og:title"       content="Publishing Test Source" /> 
  <meta property="og:description" content="Get more info by liking this page!" /> 
  <meta property="og:image"       content="http://url.to/image.jpg" /> 
</head>
<body>
<p>Please wait... - Meta Refresh or Javascript redirect here.</p>
</body>
</html> 
```

在页面上为此 URL 放置一个喜欢按钮，然后喜欢它，让我通过图形搜索查找信息来检索信息：

```
https://graph.facebook.com/?http://url.to/object.html 
```

...或 FQL（似乎更可靠地工作）：

```
https://graph.facebook.com/fql?q=SELECT%20id%20from%20object_url%20where%20url%20in%20('http://url.to/object.html') 
```

要么会给我一个对象的 ID，例如：

```
{
   "http://url.to/object.html": {
      "id": "BIG_OBJECT_ID"
   }
} 
```

据我所知，我应该能够像这样发布到该对象的新闻提要：

```
curl -F 'access_token=ACCESSTOKEN|LONGSTRING' -F 'message=Hello World.' https://graph.facebook.com/BIG_OBJECT_ID/feed 
```

...但我得到的只是授权错误。我错过了中间的一些步骤。我假设通过将对象绑定到 app_ID，一个将被允许发布到另一个。我认为我缺少的是我授权应用程序管理页面的过程？我需要一个 admin_ID 来充当中介吗？

# silverlight - 在后台播放音频 - windows mango

> ID：11299835
> 
> 赞同：0
> 
> 时间：2012-07-02T19:18:28.463
> 
> 标签：silverlight, windows-phone-7, windows-phone-7.1, background-audio

我正在开发 wandows 芒果应用程序，我有两个 XAML 页面（比如 page1 和 page2）。在 page1 我有一个播放列表，在 page2 我有一个媒体元素播放在 page1 上选择的歌曲，现在我想要的是当用户在页面之间切换时保持歌曲在后台播放。我有一些链接可以在应用程序进入后台时继续播放歌曲，但在页面关闭时（通过单击后退按钮）不会。

我该如何实现这一点，欢迎所有建议，指点。

谢谢，Ravi Gupta - :( windows phone 的新手

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T05:41:58.220

您也可以使用 XNA 的`MediaPlayer()`查看：[https ://stackoverflow.com/a/11385865/1510036](https://stackoverflow.com/a/11385865/1510036)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:40:39.340

您需要为此使用 BackgroundAudioPlayer。MSDN 有一个在后台播放音频的[完整示例](http://msdn.microsoft.com/en-us/library/hh202978%28v=vs.92%29.aspx)。[你可以从这里](http://go.microsoft.com/fwlink/?LinkId=219073)下载他们的样本。您可以将一个项目添加到您的应用程序以处理处理背景音频（如果您需要在应用程序关闭后播放音频），或者您可以在订阅[PlayStateChanged](http://msdn.microsoft.com/en-us/library/microsoft.phone.backgroundaudio.backgroundaudioplayer.playstatechanged%28v=vs.92%29.aspx)事件的应用程序本身内处理它。从事件中，您可以设置下一首曲目。

# asp.net-mvc-3 - 如何设置自定义 ImageResizer url？

> ID：11299837
> 
> 赞同：1
> 
> 时间：2012-07-02T19:18:32.160
> 
> 标签：asp.net-mvc-3, imageresizer

我刚刚开始使用 ImageResizer，我被困在看似完全基本的问题上：

1.  我有一个上传器，用于将图像放入无法通过 HTTP 直接访问的目录中。（如果我只是将图像放在`/images/myimage.jpg`，那么任何人都可以通过请求来访问它，而我想通过缩略图、水印等来限制访问）。所以我想把它放在`/offlimits/myimage.jpg`，但能够提供它`/public/images/myimage.jpg`。
2.  我真的不想将所有图像转储到同一个`offlimits`文件夹中，因为将大量文件放在一个文件夹中会使 Windows 不开心。但是我也不想暴露那个子目录结构的细节，那么我应该把面向公众的 url 和实际图像位置之间的映射放在哪里呢？
3.  大多数情况下，我根本不需要图像扩展名，所以我想说`/public/image_id?width=100...`并将这张地图映射到`/offlimits/sub1/sub2/sub3/image_id.jpg`.

谁能建议如何设置它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T19:43:34.097

SO这里通常不赞成三个部分的问题，但无论如何我都会咬一口:)

1.  如果您允许基于身份验证访问图像，那么您需要使用 ASP.NET 的 URL 授权功能。ImageResizer 支持 URL 授权规则。如果您只是不希望源文件可用，并且想要强制它们调整大小或加水印，[请阅读有关如何实现此类任意规则的文档](http://imageresizing.net/docs/howto/watermark-by-folder-or-size)。
2.  您可以使用 将图像路径重写为您的心脏内容`Config.Current.Rewrite`，这就像[前面提到](http://imageresizing.net/docs/howto/watermark-by-folder-or-size)的 PostRewrite 事件一样。请记住，您以后必须将其全部记在脑海中。
3.  图片扩展是个好东西。不要和他们打架。他们让服务器找出正确的 mime 类型来发送并帮助错误的浏览器从相关错误中恢复。它们可以防止多个平台上的问题并使“另存为”对话框正常工作。它们也显着提高了服务器效率，因为处理逻辑不需要等待很长时间。由于 IIS/ASP.NET 模块系统的设计，这一点尤为重要。

# php - jQuery 可排序 - PHP

> ID：11299839
> 
> 赞同：0
> 
> 时间：2012-07-02T19:18:35.027
> 
> 标签：php, jquery, jquery-ui

我正在使用 jQuery sortable() 对数据库中的图像进行排序。HTML如下。

```
<h2>Revision 1</h2>

<ul class='sortable'>
<li class='sortPhotos' id='item_249745' >
     <img src="../data/gallery/13387/images/album/1650519801.jpg"/>
     <p>1650519801.jpg</p>
</li>
<li class='sortPhotos' id='item_249744' >
     <img src="../data/gallery/13387/images/album/704633205.jpg"/>
     <p>704633205.jpg</p>
</li>
</ul>

<h3>Revision 2</h3>

<ul class='sortable'>
<li class='sortPhotos' id='item_518811' >
     <img src="../data/gallery/13387/images/album/001.jpg"/>
     <p>001.jpg</p>
</li>
<li class='sortPhotos' id='item_518812' >
     <img src="../data/gallery/13387/images/album/003.jpg"/>
     <p>003.jpg</p>
</li
</ul> 
```

**JS**

```
<script>

    $(".sortable").sortable({stop:function(i) {
            $.ajax({
                type: "GET",
                url: "../albumUploader/queries/sort.php",
                data: $(".sortable").sortable("serialize")
            });
        },
        opacity:1.0
    });    
</script> 
```

**最后是 SQL**

```
foreach($_GET['item'] as $key=>$value) {

    mysql_query("   UPDATE galleryimage
                    SET sort = '{$key}'
                    WHERE id = '{$value}'  
                   ");
} 
```

上述示例的问题——第一个修订版是唯一在数据库中实际排序的修订版。其他修订版不是。从 Chrome Web 开发人员扩展程序中监控网络来看，这两个列表都发送到数据库，但第二个列表没有写入。关于这个有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T20:33:21.887

每个可排序的对象都需要有自己的唯一 ID。我解决了它：

```
ul id='sortable_" . $count ."'
$count++;

$(".revisionNum").each(
        function(e) {
        num = e + 1;
        $("#sortable_" + num).sortable(
            {stop:function(i) {
                serial = $("#sortable_"  + num).sortable("serialize");
                $.ajax({
                    type: "GET",
                    url: "../albumUploader/queries/sort.php",
                    data: serial
                });
            },
            opacity:1.0
        });    
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T20:34:32.877

一种解决方案是一次只向服务器发送一个列表。这可以通过从而`$(this)`不是从发送数据来完成`$(".sortable")`：

```
$(".sortable").sortable({stop:function(i) {
        $.ajax({
            type: "GET",
            url: "../albumUploader/queries/sort.php",
            data: $(this).sortable("serialize")
        });
    },
    opacity:1.0
}); 
```

# javascript - 设置变量 if...then javascript

> ID：11299842
> 
> 赞同：0
> 
> 时间：2012-07-02T19:18:44.567
> 
> 标签：javascript, html, function, variables, toggle

我正在尝试设置一个变量并将其上传到我的数据库，具体取决于页面上显示的文本。我在 javascript 中使用了一个简单的 if...then，它表示该变量未定义。还有另一种设置变量的方法吗？

```
<script type="text/javascript">
oldTextAry = new Array();
function changeText (fieldObj, newTexStr) {
    if (newTexStr == fieldObj.innerHTML) {
        fieldObj.innerHTML = oldTextAry[fieldObj.id];
        var waswere = 1;
    } else {
        oldTextAry[fieldObj.id] = fieldObj.innerHTML;
        fieldObj.innerHTML = newTexStr;
        var waswere = 2;
    }
}
function displayWasWere () {
        document.write(waswere);
}
</script> 
```

和 HTML：

```
<HTML>
    <a href="#" onclick="changeText(this,'were');" id="text1link">was</a><br/>
    <a href="#" onClick="displayWasWere();" id="waswere" name="waswere">show variable</a>
</HTML> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T19:20:06.100

制作`waswere`为全局变量：

```
var waswere;
oldTextAry = new Array();
function changeText (fieldObj, newTexStr) {
    if (newTexStr == fieldObj.innerHTML) {
        fieldObj.innerHTML = oldTextAry[fieldObj.id];
        waswere = 1;
    } else {
        oldTextAry[fieldObj.id] = fieldObj.innerHTML;
        fieldObj.innerHTML = newTexStr;
        waswere = 2;
    }
}
function displayWasWere () {
    document.write(waswere);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T19:20:23.003

您的变量是在第一个函数的范围内定义的。使变量成为全局变量，您应该准备好滚动了。

# java - 在 Java 中检查嵌套方法调用

> ID：11299844
> 
> 赞同：2
> 
> 时间：2012-07-02T19:19:02.930
> 
> 标签：java, syntax, error-handling, null

我需要像这样对嵌套方法调用进行空检查：

```
if (getShopModel() != null && getShopModel().getType() != null) 
```

我认为这不是最好的方法，因为我两次调用 getShopModel 可能会非常昂贵。

有没有更好的方法来检查 getShopModel().getType() ，我只需要调用一次 getShopModel() ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T19:21:02.503

使用变量...

```
Model model = getShopModel();
if (model != null && model.getType() != null) 
```

如果您对“getShopModel”返回的值感兴趣，这不会花费您任何费用，节省了额外的调用，甚至可能使调试变得更容易。

# c# - Windows Phone C# - 按钮数组的按钮颜色

> ID：11299846
> 
> 赞同：1
> 
> 时间：2012-07-02T19:19:11.010
> 
> 标签：c#, windows-phone-7

我首先在我的程序上创建了大量按钮，从 1 到 96。计划是当一个按钮被按下时，它会变成红色，这会随机地抓住附近的其他按钮。

我遇到的问题是按钮不希望变成红色。下面，我将展示我尝试这样做的代码：

```
public MainPage()
        {

            InitializeComponent();
            numbers = new[] {
            button1, button2, button3, button4, button5, button6, button7, button8, button9, button10,
            button11, button12, button13, button14, button15, button16, button17, button18, button19,
            button20, button21, button22, button23, button24, button25, button26, button27, button28,
            button29, button30, button31, button32, button33, button34, button35, button36, button37,
            button38, button39, button40, button41, button42, button43, button44, button45, button46,
            button47, button48, button49, button50, button51, button52, button53, button54, button55,
            button56, button57, button58, button59, button60, button61, button62, button63, button64,
            button65, button66, button67, button68, button69, button70, button71, button72, button73,
            button74, button75, button76, button77, button78, button79, button80, button81, button82,
            button83, button84, button85, button86, button87, button88, button89, button90, button91,
            button92, button93, button94, button95, button96
            };

        }

        private void ButtonSequence(int bRef)
        {
            Random random = new Random();
            int activeCell = bRef;
            int randomNumber = random.Next(0, 10);
            int steps = 0;
            int randomMaxRange = 2;

            SolidColorBrush red = new SolidColorBrush(Colors.Red);

            numbers[activeCell].Background = red;

                if (activeCell == 0)
                {
                    randomNumber = random.Next(0, 10);
                    if (randomNumber < randomMaxRange)
                    {
                        steps++;
                        ButtonSequence(1);
                    } 
```

此函数继续，并由以下方式调用：

```
private void button1_Click(object sender, RoutedEventArgs e)
{
    ButtonSequence(0);
} 
```

和别的。

有没有人解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:34:03.043

如果您需要在应用程序中手动创建 96 个按钮，则说明您处理数据模型的方式有问题。此外，在您的代码中，您实际上从未将按钮添加到页面可视树中。您的页面某处是否有数据容器？

您似乎也没有将事件处理程序绑定到 UI 控件。

# php - Netsuite PHP ItemSearch基本问题

> ID：11299850
> 
> 赞同：0
> 
> 时间：2012-07-02T19:19:26.163
> 
> 标签：php, mysql, erp, netsuite

我正在尝试从 Netsuite 的某个仓库退回所有库存。我遇到了一些问题，想知道是否有人能指出我正确的方向。我要查询的仓库的 internalId 是 16。当我进行搜索时，它返回 0 个项目 - 但不会失败。

这是我正在使用的 PHP 代码。

```
<?php
require_once 'PHPtoolkit.php';
require_once 'login_info.php';
global $myNSclient;

$internalID = '16'; //Internal ID of the warehouse I want to query to see what inventory it has

$inventorySearch = new nsComplexObject("ItemSearchBasic");

$searchValue = new nsRecordRef(array('type' => 'location', 'internalId' => $internalID ));

$multiSelect = new nsComplexObject('SearchMultiSelectField');
$multiSelect->setFields(array('operator'=>'anyOf','searchValue'=>$searchValue,"operatorSpecified" => true));

$inventorySearch->setFields(array('location'=>$multiSelect));

try
{
    $searchResponse = $myNSclient->search($inventorySearch);
    $totalRecords = $searchResponse->totalRecords;
    if ($totalRecords > 0)
    {
        echo "records found";
        foreach ($searchResponse->recordList as $record)
        {
            echo "<pre>";
            print_r($record);
            echo "</pre>";
        }
    }
    else
    {
        echo "No result found.";
    }

}
catch (Exception $e)
{
    echo $e;
    echo "Item is not found. Please try again.";
    exit();
} 
```

这是 SOAP 请求

```
 <?xml version="1.0" encoding="UTF-8" ?> 
- <Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="urn:core_2011_2.platform.webservices.netsuite.com" xmlns:ns2="urn:common_2011_2.platform.webservices.netsuite.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ns3="urn:messages_2011_2.platform.webservices.netsuite.com">
- <Header>
- <passport actor="http://schemas.xmlsoap.org/soap/actor/next">
  <email>xxxxx</email> 
  <password>[Content Removed for Security Reasons]</password> 
  <account>xxxxxx</account> 
  <role internalId="3" xsi:type="RecordRef" /> 
  </passport>
  </Header>
- <Bod
y>
- <search>
- <searchRecord xsi:type="ItemSearchBasic">
- <location operator="anyOf">
  <searchValue internalId="16" type="location" /> 
  </location>
  </searchRecord>
  </search>
  </Body>
  </Envelope> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-03T05:35:19.633

```
$inventorySearch = new nsComplexObject("ItemSearchBasic"); 
$inventorySearch->setFields(array(
    "location" => array(
        "operator" => "anyOf",
        "searchValue" => array(
            "type" => "location",
            "internalId" => $internalId
        )
     )
)); 
```

然后，做你的尝试/捕捉。

但是当我看到这个时，你想要获得项目可用性。这是一个完全不同的电话。

```
$filter = new nsComplexObject ( 'ItemAvailabilityFilter' );
$filter->setFields ( array (
    "location" => array (
        "operator" => "anyOf",
        "searchValue" => new nsRecordRef ( array (
            "type" => "location",
            "internalId" => $internalId 
        ) ) 
    ) 
) ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-20T20:14:47.197

我花费了大量时间使用 PHPToolKit v2011.2 端点构建自己的自定义搜索，并在拔掉头发后让它们工作，因为没有那么多示例。随着 v2012_2 端点的引入，事情发生了变化，我必须重新学习我之前解决的问题。我“强烈”建议您使用 SAVED SEARCH，而不是尝试发明在 PHP 中进行所有搜索的方法。在 Netsuite 中创建一个已保存的搜索，并使用您创建的搜索的 internalId 从您的 PHP 调用 SAVED SEARCH。

# c# - 使用 Silverlight 连接到两个不同的数据库实例

> ID：11299856
> 
> 赞同：0
> 
> 时间：2012-07-02T19:19:48.577
> 
> 标签：c#, sql-server, database, silverlight

我有一个带有自己的数据库 SQL-Server 2008 的 Silverlight (4.0) 应用程序 (C#)。

我需要连接到不同服务器上的另一个数据库实例。我只需要在该服务器上执行一个 SELECT 查询来获取一些数据到我的应用程序，清理它并将其放入我的数据库中。

我有该数据库的连接字符串，我打算将它保存在应用程序的 web.Config 文件中。

是否可以连接到该服务器并同时保持与我的数据库实例的连接打开？

这甚至可能吗？当我这样做时我应该注意什么？我应该如何在不丢失数据的情况下管理 2 个连接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:41:25.650

使用 ADO.NET 时，默认情况下您的连接将关闭。使用新连接从第二台服务器获取数据并将其存储在数据集或数据表中。然后，遍历数据集/数据表并使用您的其他连接将该数据放入您的数据库中。只要确保关闭您的连接，您应该一切顺利。对于这个非常简单的模型，唯一需要注意的是，如果您的数据表或数据集非常大，它将消耗一些内存。

# jsf-2 - 如何在同一个 xhtml 页面上的两个表单之间共享一个变量？

> ID：11299860
> 
> 赞同：0
> 
> 时间：2012-07-02T19:20:02.643
> 
> 标签：jsf-2, primefaces

我有两个 primefaces (p:layoutUnit) 小部件：页面左侧 layoutUnit 中的树和页面中心 layoutUnit 中的 dataArea（待定）。我让树形菜单工作，以便在选择节点时调用适当的 DAO 方法并返回对象。我的麻烦是，该对象返回到页面左侧的树形式。

我的问题是：如何让返回的对象填充在我的页面中心？是否有 JSF 机制来执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T19:43:58.497

您可以利用`<p:tree>`组件的 select 事件发出 ajax 调用，该调用将根据所选节点更新页面的 dataArea：

例如：

```
<p:tree value="#{treeBean.model}" dynamic="true">
   <p:ajax event="select" listener="#{treeBean.onNodeSelect}" update="form2:dataArea"/>
   ...
</p:tree> 
```

在 onNodeSelect 中，您将使用要在 dataArea 中显示的值填充控制器上的实例变量。将更新属性设置为“form2:dataArea”将导致页面将 dataArea 更新为最新状态（并获取您放置在实例变量中的数据）。请注意，“form2:dataArea”只是对您的第二个表单 id 和 dataArea 的 id 标记为的猜测。

# ruby-on-rails-3 - 在 Rails 中动态创建子域

> ID：11299868
> 
> 赞同：2
> 
> 时间：2012-07-02T19:20:23.500
> 
> 标签：ruby-on-rails-3, subdomain

我现在可以看到很多托管的 SAAS 应用程序为他们的用户提供子域，比如如果一个应用程序（比如项目管理工具）是[http://myapp.com](http://myapp.com)，如果客户可以拥有像这样的子域

[http://customer1.myapp.com](http://customer1.myapp.com)、[http://customer2.myapp.com](http://customer2.myapp.com)和这些 url 可以在用户注册应用程序时保留。

我有一个转销商托管计划，我想要同样的事情，我的托管计划设置了通配符子域，从技术上讲，我可以在我的主域下创建任何子域。但我的问题是

带红宝石/导轨

*   如何让客户在注册时选择他们的子域

*   像这样的要求的标准方法是什么

我打算使用 rails 3.xx

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-11T17:56:49.390

我最近做了类似的事情，我所做的是我将服务器配置为接受任何子域，然后重定向到资源 url。在您的情况下，您可能只是将该子域请求路由到 rails 服务器。如果你使用的是 nginx，你会得到类似的东西：

```
server {
    listen       80;
    server_name  dev.yoursite.com *.dev.yoursite.com;
    root /path_to_your_site/public;   # <--- be sure to point to 'public'!
    passenger_enabled on;
    rails_env development;
} 
```

然后，在您的应用程序中，您可以创建具有子域约束的​​路由，类似于`get '/' => 'users', :constraints => { :subdomain => /.+/ }`，并在控制器操作中处理该子域，`request.subdomain`以查找匹配的用户。

请记住，在您的本地环境中，要么列出所有子域进行测试，要么`lvh.me`在服务器配置中使用。如果您将使用自己的域而不是 lvh.me，请不要忘记在您的 hosts 文件中添加该域和子域。此外，对于 prod，不要忘记在 DNS 中添加通配符子域记录。

# javascript - 通过从下拉列表中选择来更新 GoogleMaps InfoWindow

> ID：11299877
> 
> 赞同：1
> 
> 时间：2012-07-02T19:20:56.657
> 
> 标签：javascript, google-maps, kml, infowindow

我有一张地图，其中 infoWindow 包含日期的下拉列表。当用户从此列表中选择日期时，我需要更新 InfoWindow 的内容。我的积分是通过 KML 文件加载的。 [http://nctcog.org/trans/data/trafficcounts/index2.asp](http://nctcog.org/trans/data/trafficcounts/index2.asp)

我目前正在尝试使用下拉列表的 onChange 事件来调用生成 KML 的页面以重新加载它，但这不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:48:49.697

[这](http://www.geocodezip.com/v3_FusionTables_GViz_infowindows3.html)是一个示例，它可以完成我认为您正在尝试做的事情。它使用 FusionTables 而不是 kml 作为数据源，但应该应用信息窗口中的下拉处理。

# c# - 为什么 WPF DataGrid 的垂直滚动过大？

> ID：11299881
> 
> 赞同：2
> 
> 时间：2012-07-02T19:21:09.220
> 
> 标签：c#, .net, wpf, datagrid

我有一个带有滚动和虚拟化的数据网格。其他一切都很好，除了有可能额外的 1-23 像素滚动到底部：

![在此处输入图像描述](../Images/fe15a1eb9da5b60467d24156d8d9abe2.png)

我有一个数据网格，右侧有一个自定义样式的滚动条，然后我在底部有一个拆分器，问题是拆分器和网格之间有空白空间，这本身很好（因为您可以调整拆分器的大小并拥有更多的空白空间），但滚动条现在比它需要的大，这会导致其他地方出现问题。如何确保滚动条完全“与内容一样高”。

我不希望它滚动到空的地方，因为我在其他地方有代码读取滚动位置并乘以行高以确定我们所处的位置，并且一旦超出可滚动区域它就会出错。

数据网格如下所示：

```
<DataGrid CanUserSortColumns="False"
          CanUserAddRows="False"
          CanUserDeleteRows="False"
          CanUserResizeColumns="True"
          CanUserReorderColumns="True"
          SelectionUnit="FullRow"
          ScrollViewer.CanContentScroll="True"
          SelectionMode="Single"
          HeadersVisibility="Column"
          VirtualizingPanel.IsVirtualizing="True"
          VirtualizingPanel.VirtualizationMode="Recycling"
          AutoGenerateColumns="False" /> 
```

**更新：**我想我知道原因。因为我使用虚拟化，它滚动一行（而不是像素），因此它不允许我滚动以使行部分可见。它总是滚动一行的高度（在我的例子中是 24 个单位）。现在，如果我移动网格拆分器并使最后一行仅部分可见，它会正确显示滚动条，但问题是它将滚动 24 个单位，因此在底部显示空白区域。

意识到这一点，我不太确定这个问题是否可以解决。我只需要在别处编辑代码以确定是否存在过度滚动，如果是，我将“裁剪并忽略”最后 1-23 个滚动单位。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:27:29.177

请在 DataGrid 上使用属性 ScrollViewer.VerticalScrollBarVisibility="Auto"

有关此属性的更多信息，请访问[http://msdn.microsoft.com/en-us/library/system.windows.controls.scrollviewer.verticalscrollbarvisibility.aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.scrollviewer.verticalscrollbarvisibility.aspx)

# login - Azure 云中的 WebBrowser 多实例

> ID：11299882
> 
> 赞同：0
> 
> 时间：2012-07-02T19:21:18.103
> 
> 标签：login, azure, browser, multiple-instances, scrape

我们需要多个 WebBrowser 组件实例，同时在 Windows Azure 辅助角色实例中运行。

实现这一点的最佳方法是什么？到目前为止，我们的发现使我们相信每个新的 WebBrowser 实例都会杀死前一个实例，然后自己卡住。

您能否推荐在网页上登录的最佳方式，但不使用“HttpWebRequets”、“WebRequest”或“WebClient”？我们相信“WebBrowser”是我们的魔术，但它似乎不是那么方便，尤其是在 Azure 云上。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:46:26.033

除非我弄错了，否则 WebBrowser 控件是一个 Windows 窗体控件。您的应用程序是否基于 Windows 窗体？如果是这样，这不是公开 UI 的好选择，因为您的 Web 访问者无法查看用户界面。

至于在 Windows Azure 辅助角色中运行和不运行的内容：辅助角色本质上是 Windows 2008 Server R2 或 SP2，因此除了共享桌面 UI 之外，无论您在本地运行什么，都*应该在 Windows Azure 中运行。*在 Windows Azure 中运行多个 WebBrowser 控件的结果应该与在本地服务器上运行没有任何不同。

# ruby-on-rails - 在 Rails 中提交多个表单

> ID：11299884
> 
> 赞同：2
> 
> 时间：2012-07-02T19:21:20.660
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我必须提交多个表单，我遵循了这篇文章的建议：[如何从 Rails 的同一页面提交多个重复的表单 - 最好使用一个按钮](https://stackoverflow.com/questions/9395970/how-to-submit-multiple-duplicate-forms-from-same-page-in-rails-preferably-wit)

注意我对 Rails/编程还是很陌生，我的一些做事方式可能并不理想。

这是我的看法：

```
 = form_tag ([@event, @registration]) do
    - x.times do
      = render 'multi_form'
    = submit_tag "Submit registrations" 
```

表格（注意有更多字段）：

```
- hidden_field_tag :event_id, :value => @event.id

.control-group
  = label_tag :title
  .controls
    = select("registrations[][title]", :registration, Registration::TITLE)

.control-group
  = label_tag :first_name
  .controls
    = text_field_tag "registrations[][first_name]"

.control-group
  = label_tag :last_name
  .controls
    = text_field_tag "registrations[][last_name]"

.control-group
  = label_tag :email
  .controls
    = text_field_tag "registrations[][email]" 
```

控制器：

```
 def create
    array_number = 0
    x.times do
      @registration = Registration.new(params[:registrations][array_number])
      @registration.save
      UserMailer.registration_user_notify(@event, @registration).deliver
      array_number = array_number + 1
    end
    respond_to do |format|
      format.html {redirect_to thank_you_event_registrations_path(@event)}
    end
  end 
```

提交时，在某种程度上，它似乎在做正确的事情，因为它会向 x 个唯一的电子邮件地址发送一封电子邮件，这让我认为 @registration 在每个循环中都包含正确的详细信息 - 它没有保存到数据库中然而。我可以看到所有参数都在日志文件中，除了 :title 似乎做错了什么（见下文：但我稍后会重点关注），我现在想要它做的主要事情是运行每个数组并将其保存为新条目。

日志：

```
Parameters: {"utf8"=>"â", "authenticity_token"=>"BQXm5fngW27z/3Wxy9qEzu6D8/g9YQIfBL+mFKVplgE=", "event_id"=>"7", "registrations"=>[{"title"=>{"registration"=>"Mrs"}, "first_name"=>"Person", "last_name"=>"One", "email"=>"charl@privatelabel.co.za"... 
```

我希望我提供的信息足够，任何建议将不胜感激。

谢谢！

**编辑：**

@iblue

它成功了！这是一个验证错误，它将所有内容保存到不同的行中。非常感谢你！

如果可以的话，还有一件事，知道应该如何格式化 :title 表单部分以返回参数：

```
"title"=>"Mrs", 
```

相对于：

```
"registrations"=>[{"title"=>{"registration"=>"Mrs"}, 
```

再次感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:38:45.397

您没有检查是否`@registration.save`实际保存了记录。它可以返回`true`或`false`。我想它只是默默地失败了。

如果你使用`@registration.save!`，它会在出现任何问题时引发异常。我想那里存在某种验证错误。

# php - sql获取多个自定义帖子元值

> ID：11299886
> 
> 赞同：2
> 
> 时间：2012-07-02T19:21:26.777
> 
> 标签：php, mysql, wordpress

[![](../Images/8c14adca9a5a22e5d7a0fa8c8d1871e0.png)](https://i.stack.imgur.com/jqnwZ.jpg)

我需要的是一个 SQL 查询来遍历所有`meta_values`并在我的情况下查找特定的自定义元标记`<date1>`，`<date2>`并`<date3>`查看它们在标记中是否有任何值并检索`post_id`并创建一个数组，然后创建指向这些页面的链接（参见上图）。

因此，假设代码通过 SQL DB，并且像下面的图像一样，日期标签之间没有值，它将忽略它，只检索`post_id`710 并创建一个 ID 数组，然后创建链接。

[![](../Images/5fed845576e11d48bb26598cddf7754d.png)](https://i.stack.imgur.com/rmFH8.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T20:34:57.257

```
SELECT post_id FROM `database_table` WHERE `meta_value` REGEXP '<date[1|2|3]>[0-9]+<\/date[1|2|3]>' 
```

我认为这会成功=）祝你好运！

# mercurial - hg pull over ssh 突然开始没有从远程 hg 给出合适的响应

> ID：11299887
> 
> 赞同：2
> 
> 时间：2012-07-02T19:21:37.260
> 
> 标签：mercurial, ssh

我的团队使用 mercurial 已经有一段时间了。我们使用 ssh 连接到中央远程存储库。将 ssh 推送或拉到远程仓库没有任何问题......直到今天！

其他人都在局域网上，我远程工作并使用 vpn (cisco) 连接到局域网。现在没有其他人有问题，但是突然间，无论我尝试什么，我都得到“远程 hg 没有合适的响应！”

我能够访问 LAN 上的所有其他内容，甚至可以通过 ssh（在终端中）进入保存远程存储库的远程服务器。

这是使用调试命令的输出

```
sending hello command
sending between command
no suitable response from remote hg 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T09:16:57.213

所以，原来我的 rsa 密钥神秘地从 PageAnt 的列表中消失了，一旦我重新添加它，一切正常。奇怪，但已解决

# javascript - Jasvascript ：不活动后的警报通知并在 5 分钟后注销

> ID：11299891
> 
> 赞同：0
> 
> 时间：2012-07-02T19:22:03.377
> 
> 标签：javascript, html

我对关闭浏览器窗口有一点问题，

基本上，我有一个页面，我想在 15 分钟不活动后关闭它。我已经设法制作了一个计时器，它会在不活动 10 分钟后提醒窗口。

我需要的是，在计时器完成时，会出现一个带有可见倒计时的弹出/警报，用户可以从这里继续他的会话或结束它。如果用户在 5 分钟内未单击继续或忽略弹出窗口，则弹出窗口和父窗口都将关闭。否则，如果用户按下继续，弹出窗口将关闭并刷新主页（从而再次启动计时器）有什么建议吗？这是我的代码：

```
 var idleTime = 0;
    var activeTime = 0;
    var warningFlag = 0;
    var loginTime = new Date();
    var logoutTime = loginTime;
    setInterval(function checkIdle() {
        idleTime += 1;
        activeTime += 1;
          if(idleTime > 10) {
            alert("You've been inactive for 10 \n minutes, are you still there ?\nYou logged in at " + loginTime);
            warningFlag=1;
        }
        if((idleTime > 15) && (warningFlag==1)) {
            alert("You've been logged out due to inactivity for 15 \n minutes? \nYou logged out at " + logoutTime);
            window.close();
        }
        window.onload = resetTimer;
        document.onmousemove = resetTimer;
        document.onkeypress = resetTimer;
    },1000);

    function resetTimer() {
         idleTime = 0;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T19:49:23.690

而不是警报窗口使用 div 来切换隐藏/可见的可见性。该 div 应该包含另一个容器，div 或 span，用于显示倒计时时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:58:50.633

您可以使用模态窗口，它们通过显示 div 并将页面的其余部分涂黑来表现得像警报一样。

你可以在这里看到一些很好的例子：

[http://www.scriptiny.com/2011/03/javascript-modal-windows/](http://www.scriptiny.com/2011/03/javascript-modal-windows/)

希望这可以帮助。

# ruby-on-rails - 为什么 Rails 动作邮件程序不能正常工作？该页面未呈现任何错误

> ID：11299892
> 
> 赞同：0
> 
> 时间：2012-07-02T19:22:07.493
> 
> 标签：ruby-on-rails, actionmailer

我正在尝试使用操作邮件程序在用户注册时向他们发送一封简单的电子邮件，但操作邮件程序似乎根本没有发送任何电子邮件。有趣的是重定向代码有效并且页面在本地主机上正确呈现，但在heroku上它说“抱歉出了点问题”。

这是我在用户控制器中所做的事情：

```
if @user.save    
     UserMailer.welcome_email(@user).deliver
     flash[:success] = "Congratulations, you've created your band app account!"
     redirect_to root_path
else
  render 'new'
end 
```

控制器中引用的welcome_email方法：

```
class UserMailer < ActionMailer::Base
  default from: "admin@something.com"

  def welcome_email(user)
    @user = user
    @url = signin_path
    mail(to: user.email, subject: "Your band app account has been created" )
  end
end 
```

最后是电子邮件视图的代码（app/views/user_mailer 中的welcome_email.html.erb：

```
<!DOCTYPE html>
<html>
  <body>
    <h1>Welcome to the band app, <%= @user.name %></h1>
    <p>
      Your band app account has been created.<br/>
    </p>
    <p>
      To login to the site, just follow this link: <%= @url %>.
    </p>
    <p>Thanks for joining and have a great day!</p>
  </body>
</html> 
```

预先感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T19:40:07.110

你设置好你的`environment`文件了吗？

正如这里所说的[http://guides.rubyonrails.org/action_mailer_basics.html#action-mailer-configuration-for-gmail](http://guides.rubyonrails.org/action_mailer_basics.html#action-mailer-configuration-for-gmail)，您应该`development.rb`使用以下设置设置您的或与您正在使用的 ENV 相关的文件：

```
config.action_mailer.delivery_method = :smtp
config.action_mailer.smtp_settings = {
  :address              => "smtp.gmail.com",
  :port                 => 587,
  :domain               => 'baci.lindsaar.net',
  :user_name            => '<username>',
  :password             => '<password>',
  :authentication       => 'plain',
  :enable_starttls_auto => true  } 
```

我知道该链接说它是 Gmail 的示例，但是您必须在 ENV 文件上设置这些配置，例如您使用的电子邮件（`:user_name`）、密码等。

# regex - Powershell正则表达式检查括号之间的字符串

> ID：11299893
> 
> 赞同：3
> 
> 时间：2012-07-02T19:22:09.833
> 
> 标签：regex, powershell

我正在尝试将文本文件中的值读取到哈希表中，我希望能够知道何时遇到格式为“['somestring']”的值......所以当我遇到一个值时有括号的我想将字符串存储到一个特定的变量中并使用该字符串运行一个函数。

我在想正则表达式是解决这个问题的方法，但我不确定可能的正则表达式值会是什么样子。任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-02T19:28:13.023

```
$r = [regex] "\[([^\[]*)\]"
$match = $r.match("[somestring]")
$text = $match.groups[1].value 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-02T20:33:14.773

```
if("['somestring']" -match "\['([^\]]+)'\]")
{
    $matches[1]
} 
```

# java - 解析 SimpleDateFormat 中的异常

> ID：11299894
> 
> 赞同：1
> 
> 时间：2012-07-02T19:22:19.407
> 
> 标签：java, date-format, simpledateformat

我正在使用***[SimpleDateFormat](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/SimpleDateFormat.html)***，我得到`ParseException`如下所示。

```
java.text.ParseException: Unparseable date: "Mon Jul 02 21:56:10 AST 2012" 
```

我拥有的代码是

```
 String dateStr = "Mon Jul 02 21:56:10 AST 2012";
    DateFormat readFormat = new SimpleDateFormat("EEE MMM dd HH:mm:ss Z yyyy ");

    DateFormat writeFormat = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
    Date date = null;
    try {
        date = readFormat.parse(dateStr);
    } catch (ParseException e) {
        System.out.println("Error in parsing date ********");
    }

    String formattedDate = "";
    if (date != null) {
        formattedDate = writeFormat.format(date);
    }
    System.out.println("Formatted date is " + formattedDate); 
```

知道我哪里出错了吗？

## 更新 1

我也试过

```
DateFormat readFormat = new SimpleDateFormat("EEE MMM dd HH:mm:ss z yyyy ");
                                                                  ^ 
```

但仍然是同样的例外。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T19:34:12.510

只要我指定日期格式应使用英语语言环境的符号，您的代码就可以工作（使用`z`，而不是）：`Z`

```
SimpleDateFormat readFormat = new SimpleDateFormat("EEE MMM dd HH:mm:ss z yyyy");
readFormat.setDateFormatSymbols(DateFormatSymbols.getInstance(Locale.ENGLISH)); 
```

根据 eran，在 yyyy: 之后还有额外的空间`yyyy ")`。删除多余的空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:25:00.487

[根据SimpleDateFormat](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/SimpleDateFormat.html)中的描述，格式代码`Z`用于时区偏移量，例如`-0800`，而格式代码`z`用于书面格式，例如`PST`or 。仔细检查您的解析模式是否具有预期的大小写。`CST`

# android - 无法创建 Android 项目。少了什么东西？

> ID：11299895
> 
> 赞同：0
> 
> 时间：2012-07-02T19:22:23.423
> 
> 标签：android, osx-snow-leopard, myeclipse

我在 Mac OSX 10.6.8 上使用 MyEclipse 10。我安装了 Android SDK 和 Android ADT 插件。我还确保安装最新版本的平台 SDK 工具，并将工具目录的路径添加到我的 $PATH。当我尝试在 Eclipse 中创建新的 Android 项目时，我收到以下消息：“您的工具安装似乎已过期（或尚未安装）。此向导取决于随 Android SDK 工具分发的模板。”。我会错过什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T15:01:08.553

这是缺少的：我没有在 Eclipse 中配置 ADT 插件：http: [//developer.android.com/sdk/installing/installing-adt.html#Configure](http://developer.android.com/sdk/installing/installing-adt.html#Configure)

# jquery - Rails 3 js.erb jQuery不更新页面上的元素

> ID：11299897
> 
> 赞同：0
> 
> 时间：2012-07-02T19:22:29.833
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3, erb

尝试使用 js.erb 文件捕获控制器方法的成功/错误。资产已创建，我从 jQuery 收到警报，但我希望来自 ERB（第一个代码片段）的消息没有出现。我做错了什么？

**create_asset.js.erb**

```
<% if @asset.errors.any? %>
    var errors = $('<ul />');
    errors.append('<li><%= escape_javascript( error ) %></li>');
    jQuery('#create_asset_message').html(errors);
<% else %>
    jQuery("form#create_asset_form").before('<div id="flash_notice"><%= escape_javascript(flash.delete(:notice)) %></div>');
    jQuery('form#create_asset_form')[0].reset();
<% end %> 
```

**create_asset 控制器方法**

```
 def create_asset
    @asset = Asset.new(:name                  => params[:name],
                       :description           => params[:description],
                       :serial_number         => params[:serial_number],
                       :asset_manufacturer_id => params[:asset_manufacturer_id],
                       :asset_model_id        => params[:asset_model_id],
                       :image_filename        => params[:image_filename])

    respond_to do |format|
      format.js
    end
  end 
```

**查看[部分]：**

```
<%= form_tag create_asset_assets_path, :method => :get, :id => "create_asset_form", :remote => true do %>
    <div class="row-fluid">
        <h3>Choose your template: </h3>
        <%= collection_select(:asset, :id, @asset_templates,:id,:name, {:prompt => "Select your template..."}, {:class=>'chzn-select', :onchange => "update_asset_form_div(this.value)"}) %>
    </div>
    <br/>
    <%= render :partial => "create_asset_form", :object => @asset_template, :manufacturers => @manufacturers %>

    <%= submit_tag "Create Asset", :disable_with => "Please wait..." %>

    <div id="create_asset_message"></div>
<% end %> 
```

**jQuery的阿贾克斯**

```
jQuery('form#create_asset_form').submit( function () {
    alert("You got here")
    jQuery.ajax({
        url: "/assets/create_asset.js",
        type: "GET",
        data: {"name"          : jQuery('#name').val(),
            "description"   : jQuery('#description').val(),
            "serial_number" : jQuery('#serial_number').val(),
            "asset_manufacturer_id" : jQuery('#manufacturer_select').val(),
            "asset_model_id"        : jQuery('#models_select').val(),
            "image_name"    : jQuery('#image_name').val()},
        dataType: "html"
    });
    return false;
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T20:41:41.857

将数据类型设置为脚本确实很有帮助...

我的 ajax 查询应该是这样的（使用`datatype: "script"`而不是`"html"`）：

```
jQuery('form#create_asset_form').submit( function () {
    alert("You got here")
    jQuery.ajax({
        url: "/assets/create_asset.js",
        type: "GET",
        data: {"name"          : jQuery('#name').val(),
            "description"   : jQuery('#description').val(),
            "serial_number" : jQuery('#serial_number').val(),
            "asset_manufacturer_id" : jQuery('#manufacturer_select').val(),
            "asset_model_id"        : jQuery('#models_select').val(),
            "image_name"    : jQuery('#image_name').val()},
        dataType: "script"
    });
    return false;
}); 
```

# sublimetext2 - 如何更改 Sublime Text 2 中的默认突出显示颜色？

> ID：11299900
> 
> 赞同：14
> 
> 时间：2012-07-02T19:22:42.540
> 
> 标签：sublimetext2

我找到了每个主题的文件，但我不知道要编辑哪一行。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-02T19:27:25.407

Ctrl+F -`<key>lineHighlight</key>`紧随其后的下一个。如果您的意思是选择颜色 - `<key>selection</key>`，或者如果您的意思是搜索文本突出显示 -`<key>findHighlight</key>`

**另请注意下面Himanshu P**的评论。

# c# - 设置 TabItem IsSelected 背景

> ID：11299904
> 
> 赞同：0
> 
> 时间：2012-07-02T19:22:59.250
> 
> 标签：c#, wpf, styling, tabitem

我似乎无法控制所选选项卡的背景颜色。但是，我可以使用 IsSelected 触发器来控制未选择选项卡的值。

这段代码：

```
<Style TargetType="{x:Type TabItem}">
    <Setter Property="Background" Value="Black" />
    <Setter Property="Foreground" Value="#EE444444" />
    <Style.Triggers>
        <Trigger Property="IsSelected" Value="false">
             <Setter Property="Background" Value="Pink"/>
        </Trigger>
    </Style.Triggers>
</Style> 
```

作品，将未选择的标签背景设置为粉红色。但是，选定的选项卡遵循一些我无法摆脱的浅灰色。

我也试过这个：

```
<Style TargetType="{x:Type TabItem}">
    <Setter Property="Background" Value="Black" />
    <Setter Property="Foreground" Value="#EE444444" />
    <Style.Triggers>
        <Trigger Property="IsSelected" Value="false">
            <Setter Property="Background" Value="Pink"/>
        </Trigger>
        <Trigger Property="IsSelected" Value="true">
            <Setter Property="Background" Value="Red"/>
        </Trigger>
    </Style.Triggers>
</Style> 
```

但这些都对选定的选项卡没有任何影响。我唯一能想到的是某些引用的程序集具有通用选项卡样式？

此样式与选项卡控件位于同一文件中，在该`Grid.Resources`部分中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T20:40:06.427

TabItem 选择行为在模板级别定义。如果要更改颜色，请定义一个全新的 DataTemplate，并在该模板中定义触发器以更改颜色。然后将该模板定义为 TabControl 的 ItemTemplate。

# objective-c - 为什么这段代码会泄漏内存？

> ID：11299908
> 
> 赞同：0
> 
> 时间：2012-07-02T19:23:17.953
> 
> 标签：objective-c, multithreading, macos, cocoa, for-loop

我有一些循环。在这个周期中，我提出了一些请求并获得了响应文本。在循环结束时，我出于某种原因让线程休眠了几秒钟并继续迭代。[Vk Friends] 中有大约 500 个对象，因此重复大约 500 次，但是当我的程序完成时，它使用的内存比启动时多得多。我使用 ARC，但我不明白为什么循环中分配的内存不会每次迭代都释放？这是正常的，还是我错了？

```
for (Friend *friend in [Vk friends]) {
    [[NSNotificationCenter defaultCenter] postNotificationName:@"log" object:[NSString stringWithFormat:@"Visit %i/%i friend (earn %i coins)", ++count, [Vk friends].count, [UserState coins] - coinsBefore]];
    if (friend.helpPoints <= 0) continue;
    strData = [NSString stringWithFormat:@"someparams=somevalues&param1=%@", [Vk authKey]];
    data = [strData dataUsingEncoding:NSUTF8StringEncoding];
    request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:[NSString stringWithFormat:@"http://someaddress/somepath?somegetparams=%@", [Vk userId]]]];
    request.HTTPMethod = @"POST";
    [request setValue:[NSString stringWithFormat:@"%i", [data length]] forHTTPHeaderField:@"Content-Length"];
    [request setValue:@"User-Agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.43 Safari/536.11" forHTTPHeaderField:@"User-Agent"];
    [request setValue:@"http://blahblah.com" forHTTPHeaderField:@"Origin"];
    [request setValue:@"http://blahblah.com" forHTTPHeaderField:@"Referer"];
    [request setValue:@"ru-RU,ru;q=0.8,en-US;q=0.6,en;q=0.4" forHTTPHeaderField:@"Accept-Language"];
    [request setValue:@"windows-1251,utf-8;q=0.7,*;q=0.3" forHTTPHeaderField:@"Accept-Charset"];
    [request setHTTPBody:data];
    data = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:nil];
    doc = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
    [NSThread sleepForTimeInterval:(helpTimeout + randDouble(min, max)) * 5.0];
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T19:35:58.273

完全正常。如果您觉得自己积累了太多内存，请将 for 循环的内部包裹在 @autoreleasepool 中，以便在每次循环迭代结束时回收内存。

# jquery - 显示粘性导航时防止窗口移动

> ID：11299910
> 
> 赞同：0
> 
> 时间：2012-07-02T19:23:23.903
> 
> 标签：jquery, mobile, navigation

所以我在我正在处理的网站上有一个带有手机下拉菜单的粘性标题。

您可以看到这里发生了什么，同时缩小窗口以显示切换按钮：[http ://www.revival.tv/turningpoint/](http://www.revival.tv/turningpoint/)

我的问题是我希望在切换菜单时将菜单保留在那里，而不是让它滚动回顶部。这可能吗？

这是我处理切换的 js：

```
$("#social-wrap li:nth-child(4)").click(function(){
   $("#phone-nav").slideToggle("slow");
});

$("#phone-nav a").click(function(){
   $("#phone-nav").slideUp("fast");
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:51:43.407

我认为发生这种情况的原因是锚标签href设置为“#”，默认为页面顶部

```
<a href="#">m</a> 
```

将其更改为

```
<a href="javascript:void(0)">m</a> 
```

# javascript - 如何在全局范围内为javascript的数字显示添加格式

> ID：11299921
> 
> 赞同：1
> 
> 时间：2012-07-02T19:24:48.040
> 
> 标签：javascript

在 Javascript 中，我有一个数字，当它显示为字符串时，我想给它添加逗号。

我可以像这样在数字中添加逗号：

```
函数 numberWithCommas(值) {
  返回值.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
}

```

但我不想对我们必须得到的每个号码都调用一个方法。我想做类似的事情：

```
Number.prototype.toString = 函数（基数）{
  返回 numberWithCommas(this);
}

```

因此，当我执行以下操作时，将显示正确的值：

```
变量数 = 100000;
警报（编号）；// 100,000

```

无法使上述工作。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:36:53.710

创建一个新的数字函数怎么样？

```
Number.prototype.withCommas = function(){
    return this.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
}

var n = 1234567;
alert( n.withCommas() ); 
```

[http://jsfiddle.net/kyX8x/1/](http://jsfiddle.net/kyX8x/1/)

# objective-c - Objective-C UITableView 索引

> ID：11299924
> 
> 赞同：0
> 
> 时间：2012-07-02T19:25:02.290
> 
> 标签：objective-c, uitableview

如何始终阅读 UITableView 中最上面的一行（cell.textLabel.text）？

我有两种略有不同的方法；

1：

```
UITableViewCell *cell2 = [tableView cellForRowAtIndexPath:indexPath];
NSString *cellText2 = cell2.textLabel.text;
NSLog (@" cellText2 = %@", cellText2); 
```

2：

```
NSMutableString *newidea = [self.array objectAtIndex:indexPath.row];

NSLog (@"newidea = %@", newidea); 
```

两个代码都在方法内`- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath`

self.array 是填充 tableView 的相同数组。

前一种方法总是显示来自第六个单元格的文本。后一种方法总是显示来自第五个单元格的文本。在我的表格视图中，一次有四个单元格。@

我想要得到的是来自最上面的单元格的文本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T20:03:41.697

我认为你有错误的方法。您不会从单元格中读取值，而是让单元格从数据数组中读取值。一个单元格总是可以有一个任意值，因为它们被重用了。即使您的表格视图中有 30 个“单元格”，也可能只有 5 个现有的实际单元格。当滚动时单元格超出表格视图时，它会移动到底部并作为下一个单元格重复使用。这就是为什么您总是必须为索引路径上的每个单元格设置值的原因。

相反，如果你有一个，你应该从你的数据数组中获取第一个单元格中的值。当表格视图询问单元格 att`indexPath.row == 0`应该具有什么标题时，您将其赋予 in `cellForRowAtIndexPath`，例如从一个名为“_cellTitles”的数组中给它，其中包含 30 个不同单元格的 30 个字符串。

如果你想从“最上面”的可见单元格中获取文本，那么你可以调用`indexPathsForVisibleRows`表格视图。返回数组中的第一个对象是最上方可见单元格的索引路径。您可以在索引 indexPath.row 处检查数组中的字符串。

例子：

```
NSArray *visibleRows = [self.tableView indexPathsForVisibleRows];
NSIndexPath *firstVisibleCell = [visibleRows objectAtIndex:0];
NSString *firstVisibleCellTitle = [_myDataArray objectAtIndex:indexPath.row]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:40:05.447

如果你总是想从第一行读取，而不是 indexPath 只是说 1 那里。这样，它将始终从第一行读取。

# android - GCM（Google Cloud Messaging）在卸载应用程序时未发送错误

> ID：11299926
> 
> 赞同：7
> 
> 时间：2012-07-02T19:25:07.243
> 
> 标签：android, android-c2dm, google-cloud-messaging

我正在尝试从 C2DM 迁移到 GCM，它大多工作得很好。C2DM 过去通过在用户卸载应用程序时发送 NotRegistered 错误来很好地处理应用程序的卸载。GCM 也应该这样做（尽管不能保证）。但是，它似乎不起作用。在向已卸载该应用程序的手机发送多个 GCM 通知后，它仍会继续以正常的“id=...”响应进行响应。

有没有其他人遇到过这个问题？如果是这样，您是如何解决的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T20:14:39.457

我们真的无能为力。只有 Google 知道应用程序何时被卸载并相应地更新其设备注册数据库。NotRegistered 响应可能需要几个小时才能回来？如果一天之后，您仍然没有收到，请向他们提交错误报告：[http ://code.google.com/p/android/issues/list](http://code.google.com/p/android/issues/list)

我无法想象谷歌会让这个错误停留太久，因为他们可能正在考虑向数千或数十万台设备发送幻像通知。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T02:00:01.353

我一直在从 C2DM 迁移到 GCM，我***认为***我也遇到了这个问题。长话短说，尝试从您的手机/模拟器中卸载该应用程序，然后*不要在该手机/模拟器上重新安装它并让手机/模拟器运行几个小时*，然后如果您尝试推送到该设备，您应该会收到 NotRegistered 错误注册编号。

如果我没记错的话，即使您在卸载后在 C2DM 中重新安装了该应用程序，您也会收到第一个注册 ID 的 NotRegistered 错误，这不是 GCM 的情况（通常如果不是总是两个注册 ID 相同），我花了一周的时间认为 GCM 有一些错误，它没有发送那个错误......

# ios - IOS 跨设备的唯一用户标识符

> ID：11299927
> 
> 赞同：6
> 
> 时间：2012-07-02T19:25:07.650
> 
> 标签：ios, unique, appcelerator, uuid, identifier

感谢您花时间和兴趣阅读本文并希望能帮助我。

我需要一个唯一的 IOS 用户标识符，我所说的唯一用户标识符是 Apple 提供的唯一字符串，它对用户而非设备是唯一的，这意味着它将在不同设备之间保持相同。我考虑过 Apple ID 或类似的东西，但这是不可能的，因为 Apple 不提供它（至少我不知道），但我想要类似的东西。

它不能是 UDID，因为（除了被弃用）它不是跨设备持久的。我希望这样做是为了验证用户身份，而无需用户登录或注册。可以这样做，因为某些应用程序会这样做。我没有登录或使用其他设备进行任何操作，但它对我进行了身份验证。我原以为是 Apple ID，但这是不可能的。

我检查了这个答案：[iOS unique user identifier](https://stackoverflow.com/questions/7273014/ios-unique-user-identifier/8677177#8677177)。似乎它可能是解决方案，但我不太明白，因为我看不出它对每个新用户来说都是独一无二的（能够区分多个用户和同一个用户，但是不同的设备）。

我非常感谢阅读本文并试图提供帮助的人们。谢谢

PD：我使用 Titanium 的 Appcelerator，而不是 Apple 的 IOS SDK 或类似的东西。但这并不重要，我只想让流程能够使用 Titanium 的 Appcelerator 来完成

PS：注意：

谢谢你的回答，这么快！我已经读了很多遍了，我就是不明白。你们能帮我更好地理解它吗？

我理解的方式是这样的。

1.-使用默认服务创建一个 UUID（每次安装都会更改） 2.-将其存储到钥匙串（据我所知，钥匙串上保存的值是设备本地的）（我想我会把它放在应用程序的 id-com.bla.bla-)，也是一个默认帐户，我认为我会将其保留为“用户”。

这都是本地的，所以每次安装都会这样做，每次安装都有不同的 UUID（不是每个用户都必须） 3.-将 UUID 保存到 NSUserDefaults。4.-将 UUID 保存到云端的公共数据存储中。（云端数据存储中的 UUID、Keychain 和 NSUserDefaults 应该相同）

因此，如果运行 5 次安装，云的公共数据存储应该是这样的

```
An Array of 5 values:
[
XXXX-EEEEE-FFFFF,
SFSDFFWE-WERW-SDFS,
XXXX-XXXXX-XXXXX,
ZZZZZ-ZZZZ-ZZZZX,
XZXZZX-ZXZXZXS-ADADS
] 
```

5.-每次运行应用程序时都会执行所有这些，首先检查公共云存储中是否存储了值。这是我感到困惑的地方，不同的设备如何知道您的 UUID？我的意思是，有 5 种不同的 UUID 可供选择。也许它不应该保存在公共数据存储中，而是保存在私有数据存储中，但为此您还需要识别每个用户。这是我很困惑的地方。

如果没有设置 UUID，则执行最后 4 步。

所以，我在第五步感到困惑，大多数人都理解那个解决方案，没有更多的解释，所以我一定是对某些东西的工作方式一无所知，也许是云服务？我认为问题在于我可能不了解 iCloud 是如何工作的，以及它是如何存储它的值的​​。我只是不明白运行应用程序的 X 的第 5 个（随机数，它可能是第 2 个或第 2000 个）设备如何知道 UUID XXX... 是用户 X 的 UUID，而不是用户的 UUID Z。

再次感谢您这么快的回答，我想也许我得等几天，而不是几分钟。原谅我的无知，我在这件事上有点菜鸟，但我想学习。被这个问题困扰了好几天

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T19:28:46.580

您提到的答案是识别用户的正确方法。解决方案是保存称为 UUID（唯一用户 ID）的标识的值，而不是 UDID（唯一设备 ID）。

当然，对于开发人员来说，唯一的缺点是用户可以删除并再次安装应用程序并拥有不同的 ID。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T19:35:18.087

正如丹尼尔所说，UUID 是识别用户的正确方法。我只想补充一点；你之前这么说

> 我看不出它对每个新用户来说都是独一无二的

好吧，根据这篇维基百科文章：

> 随机生成的 UUID 有 122 个随机位……仅在接下来的 100 年每秒生成 10 亿个 UUID 之后，仅创建一个副本的概率约为 50%。如果地球上每个人都拥有 6 亿个 UUID，那么出现重复的概率约为 50%。

因此，您可以非常确定 UUID 对于每个用户都是唯一的。

此外，MAC 地址基于以太网卡的 MAC 地址、时间戳和其他一些杂项信息。[根据 Superuser 上的这个](https://superuser.com/questions/268006/are-mac-addresses-unique-when-coming-out-of-the-factory)问题，这增加了 UUID 的唯一性：

> [MAC 地址] 相当独特。
> 
> *   前 3 个八位字节定义制造商。
> *   最后 3 个八位字节通常在 PROM 刻录时生成。这取决于制造商如何做到这一点。
> 
> 这显然为每个制造商提供了 16,777,215 个可能的唯一 MAC 地址。这是相当多的，所以制造商不应该重复使用一个。

所以基本上，UUID 为 MAC 地址增加了额外的唯一性。

总之，出于您的意图和目的，UUID 将是完美的。

希望这可以帮助！

# joomla - joomla 2.5 'JInstaller: :Install: 找不到 XML 安装文件'

> ID：11299928
> 
> 赞同：1
> 
> 时间：2012-07-02T19:25:12.450
> 
> 标签：joomla, joomla2.5

我已经在我的系统（window 7 64bit）中安装了 joomla 2.5.4，但是当我尝试上传包时它显示错误：

> 1.'JInstaller: :Install: 找不到 XML 安装文件'。
> 
> 2.'严格的标准：只有变量应该在 E:\xampp\htdocs\joomla2.5.4\plugins\system\rokextender\rokextender.php 的第 32 行通过引用分配'
> 
> 3.严格的标准：只有变量应该在 E:\xampp\htdocs\joomla2.5.4\plugins\system\rokextender\rokextender.php 的第 32 行引用分配
> 
> 4.严格的标准：只有变量应该在 E:\xampp\htdocs\joomla2.5.4\plugins\system\rokextender\rokextender.php 的第 32 行通过引用分配

有人可以帮我解决这个错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T20:48:44.947

您几乎可以肯定有权限问题（请参阅[这个相关的 SO 答案](https://stackoverflow.com/questions/1248952/php-5-disable-strict-standards-error)），并且它特定于 RocketTheme Extender，他们与 Gantry 一起用于他们的一些 RT*魔法*。我会检查 Joomla 中的所有权限以确保它们符合最低要求，然后查看 RocketTheme[产品论坛](http://www.rockettheme.com/forum/index.php?f=197&rb_v=viewforum)以获取特定于该插件的任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-05T14:39:44.120

满足最低龙门要求：

*   PHP 5.3 或更高版本
*   在您的文件夹上写入权限。

将文件夹权限设置为 755。备注：您也可以将其设置为 777，但您的提供商可能会保护您的站点不被公众访问。这可能会产生与 Joomla 问题无关的奇怪错误。

# ruby-on-rails - Rails Dev Server localhost 超级慢

> ID：11299929
> 
> 赞同：0
> 
> 时间：2012-07-02T19:25:16.097
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, web-applications

我正在开发一个 Rails 应用程序，但我遇到了一个非常烦人的性能问题。当我在我的电脑（Ubuntu 11.10 - 瘦服务器）上运行服务器时，它非常慢，每个新请求可能需要 3-4 分钟。这不会发生在生产服务器上，在生产中一切运行顺利。

我怀疑它可能是狮身人面像，它没有正确配置为在我的本地主机上工作，你怎么看？您需要更多信息吗？宝石文件？

让我知道！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T20:03:57.473

我认为你的机器很慢。您可以查看 actioncontroller::base 并查看它包含的所有内容，以了解每个请求在做什么。如果您想加快您的请求，请尝试查看 actioncontroller::metal。它是 actioncontroller::base 的精简版，看起来很像 rack。这意味着它不通过模板引擎，或者有布局和助手，以及一大堆其他东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T21:22:33.467

3/4 分钟的请求真的太多了......无论如何，我能够使用 dev-tweaks 加速我的开发设置，这是一个有助于更快地服务资产的宝石：它不会受到伤害！

[https://github.com/wavii/rails-dev-tweaks](https://github.com/wavii/rails-dev-tweaks)

# java - EL 表达式解析整数 as long

> ID：11299930
> 
> 赞同：2
> 
> 时间：2012-07-02T19:25:20.480
> 
> 标签：java, jsf-2, jboss, el

我在 JBoss 7 上使用带有 primefaces 的 JSF 2.0。在代码的某些部分，我有以下内容：

```
public void setItemValue(int value) {
    this.value = value;
} 
```

在 xhtml 中：

```
<p:commandButton ajax="true" value="Button" update="@form" 
action="#{bean.setItemValue(1)}"/> 
```

问题是，当我单击按钮时，我得到一个`javax.el.MethodNotFoundException`，说不`setItemValue(java.lang.Long)`存在。当然不是，它应该是一个 int 或 Integer 值！有人见过这个问题吗？除了改变我的接收方法之外还有其他选择吗？谢谢！

**编辑**：刚刚下载了 JBoss 7.2 的 SNAPSHOT，它运行良好。看起来它是 JBoss 7.1.1 的错误 :(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-16T08:37:44.947

看起来有点奇怪，但是你可以在 EL 2.2 内部的 Long 对象 self 上调用方法 intValue

```
<p:commandButton ... action="#{bean.setItemValue((1).intValue())}"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T00:31:56.003

动作的方法表达式类型是

字符串动作（）

所以使用

```
 public String setItemValue(Integer value) {
    this.value = value;
    return null;
} 
```

也可以看看：

*   [将参数传递给 JSF 动作](https://stackoverflow.com/questions/7401771/passing-parameter-to-jsf-action)

**更新** 您需要将 Servlet 版本声明为 3.0 以充分利用 EL 2.2，例如传递参数。为此，将 web.xml 中的 web-app 元素更改为：

```
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"       
 xmlns="http://java.sun.com/xml/ns/javaee" 
 xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" 
 xsi:schemaLocation="http://java.sun.com/xml/ns/javaee    
 http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" id="WebApp_ID"  
 version="3.0"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-03T05:22:51.193

不要在任何 bean 方法中使用`get`或`set`添加前缀（这是一个非常糟糕的做法），`action`属性需要一个方法名称而不是一些 getter 或 setter

`get`并且`set`仅用于 bean 变量的 getter 和 setter

最好用类似的`setItemValue`东西替换你的`assignItemValue`

像这样：

```
<p:commandButton ajax="true" value="Button" update="@form" 
    action="#{bean.assignItemValue(1)}"/> 
```

在哪里

```
public void assignItemValue(Long value) { //you could also try with int value...
   //set the value to whenever you want too...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-04T13:29:32.363

Apologies for resurrecting this ancient thread. If you are still using Jboss 7.11 or hit similar issues and don't want to go the EL (1).intValue() route, you can also jippo your way around it in your managed bean as follows :-

```
public String setItemValue(Long longVal) {
    return setItemValue(longVal.intValue());
} 
```

# seo - 规范问题？

> ID：11299936
> 
> 赞同：0
> 
> 时间：2012-07-02T19:26:14.747
> 
> 标签：seo, canonical-link

我有一个视频托管网站，所有视频都显示为带有分页的文字新闻帖子，并且有一些类别称为好莱坞，宝莱坞等，还有视频流派，最终所有视频都显示在主页上，分页，在这种情况下，我应该在哪里以及我应该如何使用 rel = canonical 标签

# 网址结构：

> 例子.com
> 
> > 所有视频都意味着好莱坞、宝莱坞、爱情……所有类型……等等
> 
> example.com/hollywood/
> 
> > 只有好莱坞影片
> 
> example.com/hollywood/genres/love
> 
> > 只有情歌视频

谢谢你 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T12:25:38.637

为此，您不需要规范的 URL。这不是重复的内容。仅当两个不同的 URL 提取完全相同的内容时，重复的内容才是一个问题（有时会有一些细微的变化，例如列表的顺序不同）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-14T07:26:00.097

问：首先你明白“它是什么”了吗？

答：当 301 重定向未正确到位时，会出现规范问题。这意味着搜索引擎可以从多个不同的 URL 访问您的网站。这意味着搜索引擎可能会在不同的 URL 下为您的网站编制索引，这意味着它看起来像是一个内容重复的网站。

Q：大哥你明白我们为什么要使用第二个吗？

答：很简单，我们只是想向 google 展示 url 应该在 SERP 上抓取。

问：如何使用它？

A : 在 header < link rel="canonical" href="http://example.com/" /> 中使用

# java - 类调用其他类

> ID：11299938
> 
> 赞同：0
> 
> 时间：2012-07-02T19:26:27.940
> 
> 标签：java, class, instantiation, composition

我有一些课。

在外观中，我有一个启动类，它被实例化并从那里调用所有方法。

然后我有汽车类，车主类，车库类和停车位类

所以... Starter 有一个 Car 属性。
汽车具有所有者属性。
汽车也有车库属性。
Garage 有一个 ParkingSpace 属性

Stater 类有一个`getOwner()`方法调用`getOwner()`Car 类中的方法

```
private Car car;
public Starter (String name){
    car = new Car(new Owner(name);
} 
```

上面的第三行实例化了 Car 和 Owner 对象。现在，这允许我从各种类中调用各种方法。

我现在`addParking()`在 Starter Class 中有一个方法。Starter 类中的 addParking() 调用 Car 类中的 addParking()，然后又调用 GarageClass 中的 addParking()，然后将停车位添加到存储在 Garage 类中的集合中。

我不明白的是......**我现在如何实例化 Garage 对象以及我要实例化它的内容？**我的 addParking() 方法适用于 Car，因为我在获得 Owner 时已经实例化了它。所以我现在不能去...

```
Car car = new Car(new Grarage(new ParkingSpace(int x, int y, int z))); 
```

或者我可以吗？这不会创建一个全新的 Car 对象吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T19:38:18.250

> 我现在如何实例化 Garage 对象以及如何实例化它？

通常，当我遇到这样的问题时，我会回到自然和我的领域模型。该类`Garage`应仅与一个停车位相结合，因为`Garage`必须有一个停车位，但它可能没有 a`Car`或 an （还）。

```
public class Garage{
  public Garage(ParkingSpace parkingSpace){
     //...
  }
} 
```

现在，您可以将 a 停`Car`在其中，因此拥有一个方法`Garage`是有意义的：`Garage`

```
public void park(Car car){
} 
```

现在可以通过以下方式链接这些代码位：

```
Car car = new Car(owner);
Garage garage = new Garage(new ParkingSpace(...));
garage.park(car); 
```

> 这不会创建一个全新的 Car 对象吗？

是的，`Car car = new Car(new Grarage(new ParkingSpace(int x, int y, int z)));`将创建一个新`Car`的`Garage``ParkingSpace`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:45:12.193

如果您确定调用构造函数，您将创建一个新的车库实例。我认为您最好保留默认构造函数，并为 Garage 提供 getter 和 setter 或 adder 方法（您的汽车是否存储在集合中？）以创建您的对象之间的关系：稍后您可以考虑哪些关系不能被破坏，擦除setter并通过构造函数创建关系。

```
 class Garage { 

    public Garage(){}

    private ParkingSpace ps;

    public void setParkingSpace(ParkingSpace ps){
      this.ps = ps;
    }

    public ParkingSpace getParkingSpace(){
      return ps;
    }
    public void addCar(Car car){
     // add  to some collection...
     }
    public void removeCar(Car car){
      // and remove...
     }
    } 
```

您的对象的生命周期似乎非常不同。我会将 ParkingSpace 和 Park 与 Car 分开，并仅在需要时才与 setter 建立关系。你需要考虑两件事：1）我需要什么来创建一个对象？它还依赖于哪些其他对象？2）你的关系是只读的还是读写的？似乎您不需要公园来证明汽车。如果不是这种情况，请在拥有汽车之前创建公园，这是唯一的另一种方式。

```
 class ParkingSpace{
        private int x;
        private int y;
        private int z;

      public ParkingSpace(int x, int y,int z){
        this.x = x;
        this.y = y;
        this.z = z;
     }

     //... other methods
    }

    class  Park {

       private final List<ParkingSpace> parkingSpaces = new ArrayList<ParkingSpace>();

       public void addParkSpace(ParkingSpace ps){
         parkingSpaces.add(ps);
       }
       // other methods...

    }
     }

    class Car {

       private final Owner owner;
       private Park park;
       public Car(Owner o){
           this.owner = o;
       }

       public Owner getOwner(){
           return owner;
       }

       public Park getPark(){ return park}
       public void setPark(Park p){park = p} 
```

在代码中您将拥有：

```
Owner o = new Owner("John Doe");
Car c = new Car(o);
Park p = new Park();
ParkingSpace ps = new ParkingSpace(1,2,3);
p.addParkSpace(ps);
car.setPark(p); 
```

# javascript - 如何编码基于数组名称的输入以通过 AJAX 传递？

> ID：11299939
> 
> 赞同：1
> 
> 时间：2012-07-02T19:26:30.480
> 
> 标签：javascript, ajax, forms, encode

我需要通过 AJAX 数据发送，如下所示：

```
<tr>
<td><input type="textbox" value="12" name="delay[256]"></td>
<td><input type="checkbox" value="256" name="attach_to[]"></td>
</tr>                       
<tr>
<td><input type="textbox" value="7" name="delay[653]"></td>
<td><input type="checkbox" value="653" name="attach_to[]"></td>
</tr> 
```

对这两种类型的输入进行编码的最佳方式是什么？

```
$.post(
window.location.href,
{
    data_ajax: 1,
    attach_to : attach_to, // how encode?
    delay: delay // how encode?

},
function(array) {
},
'json'
); 
```

OBS：我只想发送这些数据而不是整个表单。所以`.serialize()`似乎还不够。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T20:24:57.637

请参阅此答案以了解如何将数据编码为 JSON：[Encoding Javascript Object to Json string](https://stackoverflow.com/questions/6810084/encoding-javascript-object-to-json-string)

然后使用 PHP 将发布的 JSON 变量读回数组：http: [//php.net/manual/en/function.json-decode.php](http://php.net/manual/en/function.json-decode.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T13:25:48.717

我的解决方案：

Node.js 代码：`serialize()`适用于整个表单或给定元素。

```
var attach_to = $("input[name='attach_to[]']").serialize();
var delay = $("input[name^='delay[']").serialize();
$.post(
    window.location.href,
    {
        attach_to : attach_to,
        delay: delay
    },
    function(array) {
        // ...
    },
    'json'
    ); 
```

php 代码：`parse_str`是轻松解码传入变量的关键。

```
parse_str($_REQUEST['delay'], $params);
$delay = $params['delay'];
parse_str($_REQUEST['attach_to'], $params);
$attach_to = $params['attach_to']; 
```

# c# - Ngit rebase 创建新的提交

> ID：11299943
> 
> 赞同：2
> 
> 时间：2012-07-02T19:27:03.263
> 
> 标签：c#, git

我有一些在 git 中工作的功能，我正在尝试移植到 Ngit。我的 git 脚本如下所示：

```
git add . 
git commit -a -m "Auto Commit"
git fetch
git rebase
git push 
```

（我省略了冲突处理细节，它们在这里不相关。）

将此移植到 Ngit，我最终得到以下结果：

```
// Open a connection to the repository
Git _git = Git.Open(MyRepoPath);

// Add all new files to the commit.
_git.Add().AddFilepattern(".").Call();

// execute the commit, but don't push yet.
_git.Commit().SetMessage(CommitMsg).SetAll(true).Call();

// fetch all remote files
_git.Fetch().Call();

// rebase 
_git.Rebase().SetUpstream("FETCH_HEAD").Call();

// push all changes
_git.Push().Call(); 
```

看起来几乎一样......我看到的唯一区别是，在我的 git 服务器上，每次 Ngit 程序运行时，都会有一个新的提交被推送到存储库。当我只是在同一台机器上通过 msysgit 运行脚本时，情况似乎并非如此。（即，如果没有文件被更改，则服务器上不会生成任何内容。）

我在这里做错了吗？任何关于只有在 rebase 后本地到远程有任何不同时如何推送的聪明想法？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T12:42:52.903

回答我自己的问题......希望这可以帮助某人。我实现了一个“isDirty”函数（因为 NGit 似乎没有从 JGit 库中实现 IsClean），如下所示：

```
private bool IsDirty(Status status)
{
    return status.GetAdded().Count + status.GetChanged().Count + status.GetConflicting().Count +
           status.GetMissing().Count + status.GetModified().Count + status.GetRemoved().Count +
           status.GetUntracked().Count > 0;
} 
```

然后我在添加/提交之前检查这个：

```
 // Check if anything needs a'doin'
 if(IsDirty(_git.Status().Call()))
 {
    // Add all new files to the commit.
     _git.Add().AddFilepattern(".").Call();

     // execute the commit, but don't push yet.
     _git.Commit().SetMessage(CommitMsg).SetAll(true).Call();
  } 
```

现在它的工作方式与上面的脚本相同。凉爽的！

# jquery - 如何使用 jQuery 和 HTML5 画布画一条线

> ID：11299944
> 
> 赞同：2
> 
> 时间：2012-07-02T19:27:03.520
> 
> 标签：jquery, html, html5-canvas

我觉得应该是一个简单的问题。我一直在尝试搜索它，但我发现的一切都比我需要的更复杂。所以这是我的问题。如何使用 jQuery 在 HTML 画布上绘制简单的线条？

```
<canvas id="canvas">
<!-- I want jQuery to draw a line here -->
</canvas>

$(document).ready(function() {
   //I would like the line to draw when the document loads.
}); 
```

注意..我不是在寻找它来绘制或显示绘图动作或类似的东西。基本上我只想能够加载页面并出现一行。我的最终目标是最终绘制 3d 对象。但在我能做到这一点之前，我首先需要知道如何做基础知识......（IE）画一条线。

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T19:29:49.447

以下是[如何在 Javascript 中执行此操作](http://www.w3schools.com/tags/tryit.asp?filename=tryhtml5_canvas_line)（您可以简单地将其插入到您的函数中，但脚本将在`script`没有 JQuery 的标记中正常工作，这可能是最好的）。例子：

```
var c=document.getElementById("canvas");
var ctx=c.getContext("2d");
ctx.moveTo(0,0);
ctx.lineTo(150,40);
ctx.stroke(); 
```

[如果你想变得更重，那么 Javascript 库Raphaël](http://raphaeljs.com/)和[D3](http://d3js.org/)很难更好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-02T19:32:02.420

您实际上并不需要 jQuery... jQuery 不提供画布功能。

```
var canvas = $('#canvas_id')[0];
if (canvas.getContext){
  var ctx = canvas.getContext('2d'); 
  ctx.lineWidth = 1;
  ctx.beginPath();
  ctx.moveTo(0,0);
  ctx.lineTo(5,140);
  ctx.stroke();
} 
```

# jquery - 在 Jquery 中延迟 Ajax

> ID：11299946
> 
> 赞同：1
> 
> 时间：2012-07-02T19:27:12.593
> 
> 标签：jquery, ajax, delay, wait, fadeout

我有一个简单的页面，通过单击按钮，新数据通过 ajax 函数加载到 DIV。当用户单击另一个按钮时，该 DIV 淡出，加载数据并且 DIV 再次淡入。问题是当用户单击按钮 DIV 淡出但已加载新数据时。

我尝试在 FadeOut 函数中使用回调来防止在淡出之前加载新数据，但这没有帮助。我的代码如下：

*回调淡出效果：*

```
$("#core").fadeOut(500, processingPages.loadPage(clickedButton)); 
```

加载页面函数：

```
loadPage: function(bottomMenu) { 
            $("#indicator").show();
            $.ajax({url: bottomMenu.attr('href'),
            dataType: 'html',
            timeout: 5000, // 5 seconds
            success: function(html) {
            $("#indicator").hide();
            $("#core").html(html).fadeIn(500);
                        }
                    } 
```

我究竟做错了什么？为什么淡出不等待 500 毫秒而不是运行 loadpage 函数。为什么Ajax函数会直接触发？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:28:36.560

尝试：

```
$("#core").fadeOut(500, function(){
   processingPages.loadPage(clickedButton);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T19:28:36.600

```
$("#core").fadeOut(500, function() {
    processingPages.loadPage(clickedButton));
}); 
```

这是一个常见的错误。您的意思是传递一个函数，但实际上传递的是函数的返回值，因为您是立即执行而不是请求它稍后执行。

在我的情况下，我传递了一个匿名函数（不是函数的返回值），它在执行时（即淡出后）执行您的代码。

这是函数引用和函数调用之间的区别。

```
alert //reference to alert function
alert('hello'); //invocation of alert function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T19:55:28.950

使用承诺。让事情变得非常简单。

```
var fadingOut = $("#core").fadeOut(500).promise()

fadingOut.done(function() {
    processingPages.loadPage(clickedButton)
}); 
```

虽然这是一个简单的例子，但养成这个习惯，一切都会变得容易得多。

你甚至可以在 ajax 中使用 Promise，jquery ajax 调用默认返回 Promise。您的 loadPage 函数可能如下所示：

```
loadPage: function(bottomMenu) { 
    $("#indicator").show();
    var gettingData = $.ajax({url: bottomMenu.attr('href'),
      dataType: 'html',
      timeout: 5000
    });

    gettingData.done(function(html) {
      $("#indicator").hide();
      $("#core").html(html).fadeIn(500);
    });

    gettingData.fail(function() {alert("There was a problem loading your data";});
} 
```

# java - GWT Java 混淆

> ID：11299947
> 
> 赞同：1
> 
> 时间：2012-07-02T19:27:14.543
> 
> 标签：java, gwt

我正在开发 GWT API。我试图找到一种混淆我的java代码（API）的方法。但是，GWT 仅适用于源代码。但我不希望我的算法不理解使用我的 GWT API 的开发人员。有什么方法可以混淆我的 java 代码。另一个问题是许可。有什么办法可以为 GWT 开发客户端许可证。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-02T21:17:41.307

GWT 编译器仅适用于源代码，因为与类文件相比，我们需要 java 文件中的额外信息。

因此，如果您想为 GWT 开发 API，您只能通过向您的客户提供开放代码来实现。

# javascript - 如何确定是否已调用函数而不设置全局变量

> ID：11299952
> 
> 赞同：25
> 
> 时间：2012-07-02T19:27:34.153
> 
> 标签：javascript, jquery

我正在寻找一种很好的技术来摆脱我想做的事情：设置一个全局变量。

第一次有人通过单击按钮运行一个函数时，它会触发一个初始函数，将一些东西变成可拖动的。稍后，如果他们第二次单击该按钮，我想确定该`init`函数是否已初始化，如果是，则不再调用它。我可以通过从函数中设置一个全局变量`init`然后从 click 函数中检查该变量来轻松地做到这一点，但我想知道如何在不设置全局变量的情况下做到这一点。我真的很想要一个这样做的例子。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-07-02T19:29:59.363

您可以向函数添加一个属性：

```
function init() {
    init.called = true;
}

init();

if(init.called) {
    //stuff
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-07-02T19:37:27.503

虽然@Levi 的回答应该可以正常工作，但我想提出另一种选择。一旦调用它，您将重写 init 函数以不执行任何操作。

```
var init = function () {
   // do the initializing

    init = function() {
        return false;
    }
}; 
```

第一次调用该函数时将执行初始化。然后它将立即覆盖自身以在下次调用时返回 false。第二次调用函数时，函数体将只包含return false。

更多阅读：[http ://www.ericfeminella.com/blog/2011/11/19/function-overwriting-in-javascript/](http://www.ericfeminella.com/blog/2011/11/19/function-overwriting-in-javascript/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-02T19:31:08.640

你为什么不检查一下你的可拖动对象是否有一个类`draggable`？

```
if ($('.mydiv').is('.draggable')) {
     //do something
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-04-04T02:19:46.437

```
Function.prototype.fired = false;

function myfunc() { 
    myfunc.fired = true; 
    // your stuff
};

console.log(myfunc.fired) // false

myfunc();

console.log(myfunc.fired) // true 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-02T19:55:49.183

你可以做的是从原型中解开 init 函数。

```
​var Obj = function () {
    this.init = function () {
        document.write("init called<br/>");
        this.init = null;
    }
}
var o = new Obj();
if (o.init) document.write("exists!<br/>");
o.init();
if (o.init) document.write("exists!<br/>");
o.init(); 
```

​ 第一个`if`将是 true 并打印`exists!`，但由于函数会自行删除，第二个`if`将失败。在我的示例中，我无条件地调用第二个 init 只是为了表明什么都不会发生，但当然你可以只在它存在时调用它：

```
if (o.init) o.init(); 
```

[http://jsfiddle.net/coreyog/Wd3Q2/](http://jsfiddle.net/coreyog/Wd3Q2/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-06-10T05:32:28.623

正确的方法是使用 Javascript[代理](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy)API 来捕获使用`apply`处理程序的函数调用。

```
const initFun = (args) => {
  console.log('args', args);
}
const init = new Proxy(initFun, {
  apply(target, thisArg, args){
    target.calls = target.calls ? target.calls + 1 : 1;
    return target.apply(thisArg, args);
  }
});

init('hi');
console.log(init.calls); // 1
init('hello');
console.log(init.calls); // 2
```

# tomcat - mvn tomcat的默认服务器：部署？

> ID：11299954
> 
> 赞同：0
> 
> 时间：2012-07-02T19:27:46.733
> 
> 标签：tomcat, maven, maven-tomcat-plugin

我正在尝试与之展开一场战争 `mvn tomcat:deploy`，但我得到了

无法在项目 navigator-native 上执行目标 org.codehaus.mojo:tomcat-maven-plugin:1.1:deploy (default-cli)：无法调用 Tomcat 管理器：服务器返回 HTTP 响应代码：401 for URL：...//本地主机：8080/经理/部署？...

我已经将角色添加到 tomcat-users.xml ：

```
<role rolename="manager"/>
<role rolename="admin"/>
<user username="admin" password="password" roles="admin,manager"/> 
```

但是不想修改项目的POM.xml，那么插件使用的默认服务器是什么？我试过添加

```
<server>
    <id>localhost</id>
    <username>admin</username>
    <password>password</password>
</server> 
```

但它不起作用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T07:45:27.327

您所指的 id 是插件配置中的一个，而不是实际的服务器，如果您不想修改 pom 的项目，请在 settings.xml 文件中创建配置文件或在命令行中传递配置：

`mvn tomcat:deploy -Dmaven.tomcat.url=http://localhost/manager`，还要确保你设置 -`Dmaven.tomcat.update=true`如果你重新部署

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T16:02:19.833

默认 url 是`http://localhost:8080/manager`每个[Tomcat 6 maven 插件文档](http://tomcat.apache.org/maven-plugin-2.0-SNAPSHOT/tomcat6-maven-plugin/deploy-only-mojo.html)。不确定tomcat 7是否相同。

对于经理凭据，您将服务器块添加到`${user.home}/.m2/settings.xml`文件中。然后，您需要通过`<server>`在 Tomcat 插件配置中或在命令行中指定元素来定义服务器 ID：

`mvn tomcat:deploy -Dmaven.tomcat.server=localhost <otherPropertiesHere>`

以上假设服务器 ID 为“localhost”，如原始问题所示。

# ios - 是否有一个私有 API 能够检测 iOS 上当前的前台应用程序是什么？

> ID：11299957
> 
> 赞同：6
> 
> 时间：2012-07-02T19:27:55.557
> 
> 标签：ios, iphone-privateapi

我不打算将此应用程序发送到 AppStore。这只是一个实验性应用程序。所以，我不担心 AppStore 的批准/拒绝。

我正在寻找一种方法，我如何确定

a) 当前前台应用程序是什么（我的应用程序此时将在后台。我可能会为此使用音频播放器或 voip）

b) 检测新应用何时成为前台应用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T21:31:51.707

看起来这个问题对我的问题有这个答案。 [如何通过应用程序 id 在 iOS 上确定哪些应用程序是后台应用程序以及哪些应用程序是前台程序](https://stackoverflow.com/questions/8252396/how-to-determine-which-apps-are-background-and-which-app-is-foreground-on-ios-by)

它归结为 SBFrontmostApplicationDisplayIdentifier 私有 API

# macos - 如何运行“gmake install”？

> ID：11299958
> 
> 赞同：3
> 
> 时间：2012-07-02T19:27:58.100
> 
> 标签：macos, matlab, gnu-make

我现在正在我的 Mac 上安装代码。

代码来自[这里](http://www.eecs.berkeley.edu/Research/Projects/CS/vision/grouping/segbench/)。在此页面中查找“基准和边界检测代码”。

在自述文件中，它说：

> (1) 要使 Dataset 目录中的图像和分割读取例程正常工作，请确保编辑 Dataset/bsdsRoot.m 以指向 BSDS 数据集的本地副本。
> 
> (2) 从此目录运行“gmake install”以构建所有内容。然后，您可能应该将 lib/matlab 目录放在您的 MATLAB 路径中。
> 
> (3) 阅读 Benchmark/README 文件。

第一步，我按照建议做了。对于第二步，我很困惑。我在 MATLAB 中运行命令`gmake install`，但是，我得到了：

```
gmake

Undefined function or variable 'gmake'. 
```

实际上，在运行 MATLAB 之前，我通过 macports 安装了 gmake port。

我只是在终端中完成了它，但是，这就是我得到的......

```
hou229:segbench yaozhongsong$ cd /Users/yaozhongsong/Documents/MATLAB/segbench
hou229:segbench yaozhongsong$ sudo gmake install
gmake[1]: execvp: ../Util/gethosttype: Permission denied
gmake[1]: Entering directory `/Users/yaozhongsong/Documents/MATLAB/segbench/Util'
GNUmakefile-library:26: *** mexSuffix not defined.  Stop.
gmake[1]: Leaving directory `/Users/yaozhongsong/Documents/MATLAB/segbench/Util'
hou229:segbench yaozhongsong$ 
```

在 MATLAB 中，我也这样做了：

```
!gmake install
/bin/bash: gmake: command not found 
```

如何在自述文件中执行第二步？

提前致谢！

@Amro

```
hou229:segbench yaozhongsong$ cd /Users/yaozhongsong/Documents/MATLAB/segbench
hou229:segbench yaozhongsong$ sudo gmake install
Password:
gmake[1]: execvp: ../Util/gethosttype: Permission denied
gmake[1]: Entering directory `/Users/yaozhongsong/Documents/MATLAB/segbench/Util'
mkdir -p ../lib/matlab
g++ -g -Wall -fPIC -I../include -O3 -DNOBLAS -c Exception.cc -o build//Exception.o
g++ -g -Wall -fPIC -I../include -O3 -DNOBLAS -c String.cc -o build//String.o
g++ -g -Wall -fPIC -I../include -O3 -DNOBLAS -c Random.cc -o build//Random.o
g++ -g -Wall -fPIC -I../include -O3 -DNOBLAS -c Timer.cc -o build//Timer.o
g++ -g -Wall -fPIC -I../include -O3 -DNOBLAS -c Matrix.cc -o build//Matrix.o
Matrix.cc:13:21: error: ieee754.h: No such file or directory
Matrix.cc: In function ‘double nextpow2(double)’:
Matrix.cc:86: error: ‘ieee754_double’ was not declared in this scope
Matrix.cc:86: error: expected `;' before ‘val’
Matrix.cc:87: error: ‘val’ was not declared in this scope
Matrix.cc:88: error: ‘IEEE754_DOUBLE_BIAS’ was not declared in this scope
Matrix.cc: At global scope:
Matrix.cc:48: warning: ‘snan’ defined but not used
Matrix.cc:49: warning: ‘inf’ defined but not used
gmake[1]: *** [build//Matrix.o] Error 1
gmake[1]: Leaving directory `/Users/yaozhongsong/Documents/MATLAB/segbench/Util' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T19:50:42.940

对于“mexSuffix not defined”错误，首先`mexext`在 MATLAB 中运行，获取该输出（我怀疑它是`mexmaci64`），编辑文件`Util/GNUmakefile-library`并在第 24 行添加以下内容：

```
mexSuffix := mexmaci64 
```

将值替换为您从中获得的值`mexext`

注意：我没有测试过这些，我在 Windows 机器上..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:38:21.187

您需要从终端（命令行）而不是在 MATLAB 中运行 gmake。

# php - 在 MySQL 服务器之间移动数据时避免自动递增 ID 冲突

> ID：11299967
> 
> 赞同：0
> 
> 时间：2012-07-02T19:28:41.827
> 
> 标签：php, mysql

所以情况是我将有两个或更多“插入”机器，我的 Web 应用程序只插入我们想要登录到机器的数据（它们都在负载均衡器后面）。每隔几个小时，机器就会与负载均衡器断开连接，并将它们的信息上传到“主”数据库中，机器应该具有我们正在收集的所有数据的相对最新版本。

本来我打算用mysqldump的，但是发现不能指定命令不抓取我有的auto_increment id列（这会导致主键冲突）。我看到另一个帖子建议使用临时表将数据放入然后删除列，但是“插入”机器的规格非常低，数据量可能非常大，大约 50,000 行。除了以编程方式一次只取 x 行并将它们插入远程“主”数据库之外，还有更简单的方法吗？目前我在“插入”机器上安装了 php。

谢谢您的意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T19:59:58.400

您不希望主数据库记录与从数据库的每条记录具有相同的主键吗？如果不是，这可能会导致查询将根据它所在的机器产生不同结果的问题。

如果您想要一个可以避免冲突的任意主键，请考虑删除自动增量 ID 并构造一个保证每个服务器上的每条记录都是唯一的 ID。例如，您可以将 unix 时间（以微秒计）与每个服务器不同的标识符连接起来。一个稍微懒一点的解决方案是连接时间 + 一个随机的 10 位数字或其他东西。PHP 的 uniqid() 函数会自动执行类似的操作。

如果您不打算使用该 ID，则只需将其从您的表中删除。没有规定说每个表都必须有一个主键。如果您不使用它，但您想对有关何时插入每条记录的信息进行编码，请添加一个时间戳列（并且不要将其设为键）。

# hadoop - How does Pig store results to multiple locations with a single map-only job?

> ID：11299981
> 
> 赞同：1
> 
> 时间：2012-07-02T19:29:40.720
> 
> 标签：hadoop, apache-pig

I'm a beginner with pig and hadoop. I'm trying to understand what's going on behind the scenes in this simple pig script. I'm reading in some data, splitting it into three new relations, and storing each in a different directory. The script runs on my psuedo distributed hadoop installation as one map-only job.

I have been trying figure out how I could implement this in plain Java Map/Reduce in a single map-only job. It would be trivial to achieve the filtering/splitting, but I don't know how I'd get a map only job to send different key/value pairs to different outputs. Come to think of it, I don't know how I'd even be able to send output to multiple places in one full Map/Reduce job.

```
rawTweets = LOAD 'geotaggedTweets' USING PigStorage(',') AS (...);

SPLIT rawTweets INTO usTweets IF country == 'US', gbTweets IF country == 'GB', idTweets IF country == 'ID';

STORE usTweets INTO 'testUSTweets' USING PigStorage(',');
STORE gbTweets INTO 'testGBTweets' USING PigStorage(',');
STORE idTweets INTO 'testIDTweets' USING PigStorage(','); 
```

Edit: Ugghh... I've done it again. I seem to not be able to come up with the answers to my questions until I've gone through the whole process of writing and submitting a SO question. The hadoop class I'm looking for is [MultipleOutputs](http://hadoop.apache.org/mapreduce/docs/r0.21.0/api/org/apache/hadoop/mapreduce/lib/output/MultipleOutputs.html)

# ruby-on-rails - 我可以使用acts_as_list 在一列中创建多个列表吗？

> ID：11299983
> 
> 赞同：1
> 
> 时间：2012-07-02T19:29:58.730
> 
> 标签：ruby-on-rails, acts-as-list

我正在尝试添加`acts_as_list`到我的数据库中的现有`playlists`表中，该表存储我的用户可能创建的所有播放列表。目标是允许用户对自己的播放列表进行排序。

此迁移将为表中的播放列表设置默认位置，但该位置将在全局上下文中设置（例如，`position`对于其中包含 500 个播放列表的表，该列将按 1-500 排序）：

```
class AddPositionToPlaylistsTable < ActiveRecord::Migration
  def self.up
    add_column  :playlists, :position, :integer
    Playlist.reset_column_information
    playlist = Playlist.find(:all, :order => "created_at ASC")

    playlist.each_with_index do |p, i|
      p.position = i+1
      p.save
    end

  end

  def self.down
    remove_column :playlists, :position
  end
end 
```

这个顺序会有问题，因为将项目的位置从 500 移动到 499 不一定反映从用户的角度来看的任何变化（因为他们可能有具有 50、70、100`position`和 500 的播放列表）。

相反，我想在每个用户上下文中为表中的每个播放列表设置一个位置（例如，假设每个用户有 5 个播放列表，该`position`列将有多个播放列表实例，每个用户按 1-5 排序）。

这是否可能，如果可以，我将如何修改我的迁移来实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T22:18:16.817

更新播放列表位置时，您只考虑用户的播放列表。所以你应该从一开始就这样做。在您的迁移`up`- 方法中，您可以获取每个用户的所有播放列表，然后像您一样增加索引：

```
#....
User.all.each do |user|
  user_playlists = user.playlists(:order => "created_at ASC")

  user_playlists.each_with_index do |p, i|
    p.position = i+1
    p.save
  end
end 
```

# bash - VAR_NAME=${VAR_NAME:-"/some/path/file"} 是什么意思

> ID：11299985
> 
> 赞同：1
> 
> 时间：2012-07-02T19:30:15.150
> 
> 标签：bash, init.d

VAR_NAME=${VAR_NAME:-"/some/path/file"} 在 shell 脚本中是什么意思？

这是一个初始化脚本，我正在编写一个自定义脚本，以将我们的一些启动操作放入初始化脚本中，以便我们可以在启动时自动启动它们，但我对 shell 脚本没有太多经验，所以我正在使用我们过去定制的不相关软件的启动脚本。

指向的路径指向一个文件，该文件包含覆盖脚本中设置的默认值的配置值。

我无法弄清楚该构造的真正含义（特别是 :- 部分）。

我正在处理的脚本似乎也将此操作链接在一起以解决要使用的值，例如：

LOG_FILE=${LOG_FILE:-${LOGFILE:-$DEFAULT_LOG_FILE}}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T19:32:35.897

```
 ${parameter:-word}
        Use Default Values. If parameter is unset or null, the expansion
        of word shall be substituted; otherwise, the value of parameter shall be
        substituted. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T19:34:12.027

如果 VAR_NAME 存在，则将其设置为等于 VAR_NAME，如果不存在，则将其设置为 /some/path/file。

只有当变量名在链中不同时，链接它才有意义。

# sql-server - 光标未正确循环

> ID：11299988
> 
> 赞同：0
> 
> 时间：2012-07-02T19:30:34.133
> 
> 标签：sql-server, cursor

我有一个游标，我想遍历一个临时表，并将每条记录合并到另一个表中。

我不能让这个游标只是循环遍历记录并返回一个计数。

```
DECLARE @curCatalogID int
DECLARE @curNomenclature varchar(200)
DECLARE @curMainCategory varchar(200)
DECLARE @curSubCategory varchar(200)
DECLARE @curManufacturer varchar(200)
DECLARE @curModelNo varchar(200)
DECLARE @curPrice varchar(200)
DECLARE @curProductDesc varchar(2000)
DECLARE @curImage varchar(200)
DECLARE @curPDFName varchar(200)
DECLARE @curInventory varchar(200)
DECLARE @curBatchID int
DECLARE @curAuditID int

DECLARE @nCnt int
SET @nCnt = 0

DECLARE import_loop CURSOR FOR
SELECT * FROM tblCatalogStaging

OPEN import_loop
FETCH NEXT FROM import_loop 
INTO    @curCatalogID,
        @curNomenclature,
        @curMainCategory,
        @curSubCategory,
        @curManufacturer,
        @curModelNo,
        @curPrice,
        @curProductDesc,
        @curImage,
        @curPDFName,
        @curInventory,
        @curBatchID,
        @curAuditID

WHILE @@FETCH_STATUS = 0
BEGIN

SET @nCnt = @@ROWCOUNT;

        FETCH NEXT FROM import_loop 
        INTO    @curCatalogID,
        @curNomenclature,
        @curMainCategory,
        @curSubCategory,
        @curManufacturer,
        @curModelNo,
        @curPrice,
        @curProductDesc,
        @curImage,
        @curPDFName,
        @curInventory,
        @curBatchID,
        @curAuditID

END
CLOSE import_loop
DEALLOCATE import_loop

SELECT @nCnt 
```

它应该只返回 2036 的 1 个值（临时表中的行数），但我会返回 2036 行受影响，4072 行受影响等

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T19:54:35.563

我不太确定@@ROWCOUNT 是否打算在 CURSOR 中使用。

你可能有更好的运气：

```
DECLARE @nCnt INT
SET @nCnt = 0
...
SET @nCnt = @nCnt + 1; 
```

注意：TRIGGER 可能是对行插入/更新进行此验证的正确位置。除非你真的只希望验证有时发生。（此外，您将提出 SQL 错误，而不是异常）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:34:45.507

我不确定它是否像这样简单，但你只是想要：

```
select count (*) FROM tblCatalogStaging 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T20:09:56.537

[@@Rowcount](http://technet.microsoft.com/en-us/library/ms187316.aspx) provides the number of rows that were affected by the last statemenet to be executed. I do not think this is what you want, and I would agree with ebyrob about just using a counter variable.

But that is if you really need to do this in a cursor. AS marc_s suggest, you may want to rework your actual procedure so that it is using sets. If that is not possible and you need to, as you said in your response, deal with exceptions in your loop, you may want to look at Phil Factors recent article on that [topic](http://simple-talk.com/content/article.aspx?article=1515).

# c++ - 除以零预防

> ID：11299992
> 
> 赞同：11
> 
> 时间：2012-07-02T19:30:50.127
> 
> 标签：c++

什么是`1.#INF`以及为什么要强制转换为 a `float`或`double`防止除以 0 的崩溃？
另外，关于如何防止被0除的任何好主意？（像任何宏或模板一样）？

```
int nQuota = 0;

int nZero = 3 / nQuota; //crash
cout << nZero << endl;

float fZero = 2 / nQuota; //crash
cout << fZero << endl; 
```

如果我改用：

```
int nZero = 3 / (float)nQuota;
cout << nZero << endl;
//Output = -2147483648

float fZero = 2 / (float)nQuota;
cout << fZero << endl;
//Output = 1.#INF 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-02T19:34:44.977

`1.#INF`是正无穷大。当您将正浮点数除以零时，您将得到它（如果您将浮点数零本身除以零，那么结果将是“不是数字”）。

另一方面，如果你将一个整数除以零，程序就会崩溃。

`float fZero = 2 / nQuota;`崩溃的原因是因为运算符的两个操作数`/`都是整数，所以除法是对整数进行的。然后将结果存储在浮点数中并不重要；C++ 没有目标类型的概念。

为什么将正无穷大转换为整数是最小的整数，我不知道。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-02T20:28:39.257

> 为什么使用 (float) 或 (double) 可以防止除以 0 崩溃？

不一定。当涉及到浮点时，该标准是惊人的备用。现在大多数系统都使用 IEEE 浮点标准，这表示除以零的默认操作是返回 ±infinity 而不是崩溃。您可以通过启用适当的浮点异常使其崩溃。

请注意：浮点异常模型和 C++ 异常模型的唯一共同点是“异常”一词。在我工作的每台机器上，浮点异常都不会引发 C++ 异常。

> 另外，关于如何防止被0除的任何好主意？

1.  简单的回答：不要这样做。
    这是其中之一“医生，医生，我这样做会很痛！” 种情况。所以不要这样做！

2.  确保除数不为零。
    对作为用户输入的除数进行完整性检查。始终过滤您的用户输入以保持理智。当数字应该是数百万时，用户输入的值为零将导致除了溢出之外的各种破坏。对中间值进行完整性检查。

3.  启用浮点异常。
    让默认行为允许错误（这些几乎总是错误）未经检查是恕我直言，标准委员会的一个大错误。使用默认值，那些无穷大和非数字最终会将所有内容变成 Inf 或 NaN。
    默认应该是停止其轨道中的浮点错误，并允许发生 1.0/0.0 和 0.0/0.0 之类的事情。情况并非如此，因此您必须启用这些陷阱。这样做，您通常可以在短时间内找到问题的原因。

4.  编写自定义除法、自定义乘法、自定义平方根、自定义正弦等函数。
    不幸的是，这是许多安全关键软件系统必须采取的途径。这是一种皇家的痛苦。选项 #1 已退出，因为它只是一厢情愿。选项#3 不可用，因为不允许系统崩溃。选项 #2 仍然是一个好主意，但它并不总是有效，因为坏数据总是有办法潜入。这是墨菲定律。

顺便说一句，这个问题比仅仅除以零更糟糕。10 ^(200) /10 ^(-200)也会溢出。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-02T19:39:22.350

您通常会检查以确保您没有被零除。除非 nQuota 具有合法值，否则下面的代码并不是特别有用，但它确实可以防止崩溃

```
int nQuota = 0;
int nZero = 0;
float fZero = 0;
if (nQuota)
    nZero = 3 / nQuota;
cout << nZero << endl;

if (nQuota)
    fZero = 2 / nQuota;
cout << fZero << endl; 
```

# linux - Checking balanced characters doesn't work

> ID：11299996
> 
> 赞同：1
> 
> 时间：2012-07-02T19:30:57.463
> 
> 标签：linux, perl, text

I want to write a perl script for checking if some characters are balanced in a string or not. if they are not balance, it would remove them. for example if a string only contains open parenthesis, this characters have to be removed. I used the following code, but it doesn't work...

```
sub checkBalance{
    my $text= $_[0];
    ### Check Balanced Quates
    my $count = ($text =~ tr/"//);
    if ( $count%2 !=0)
    {
      $text=~ s/"//g;
    }
    ### Check Balanced «»
    if (((($text =~ m#(.*».*)#) && !($text =~ m#(.*«.*)#)) || !(($text =~ m#(.*».*)#) && ($text =~ m#(.*«.*)#))) || (index($text, "«")>index($text, "»")))
    {
      $text=~ s/»//g;
      $text=~ s/«//g;
    }
    return $text;
} 
```

Why it doesn't work?

The pl file is UTF8\. Sample input is:

```
 می گوید: «یکی از اصول 
```

and expected output is:

```
 می گوید: یکی از اصول 
```

I used this code on an English string, it seems that it works for English strings, but not other languages such as Arabic and Persian.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T20:42:30.327

添加缺失的位：

```
use utf8;                               # Tell Perl script is encoded using UTF-8.
use strict;
use warnings;
use open ':std', ':encoding(UTF-8)';    # Tell Perl terminal expects UTF-8.
use feature qw( say );

sub checkBalance{
   ...
}

my $in = " می گوید: «یکی از اصول";
my $expect = " می گوید: یکی از اصول";
my $got = checkBalance($in);

say $in;
say $expect;
say $got;
say $got eq $expect ? "Got expected output" : "Didn't get expected output."; 
```

我得到正确的输出：

```
$ perl x.pl
 می گوید: «یکی از اصول
 می گوید: یکی از اصول
 می گوید: یکی از اصول
Got expected output 
```

我怀疑你没有告诉 Perl 你的源文件是使用 UTF-8 编码的。添加`use utf8;`.

将来，请提供问题的演示。简单地发布您的功能并不能说明问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T20:50:19.547

如果您不想自己滚动，可以使用[Text::Balanced](https://metacpan.org/module/Text%3a%3aBalanced)来处理在文本中查找平衡分隔符的问题。