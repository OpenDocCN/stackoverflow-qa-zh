# StackOverflow 问答 000798000-000798999

# c++ - 填充提升向量或矩阵

> ID：798002
> 
> 赞同：7
> 
> 时间：2009-04-28T13:42:56.913
> 
> 标签：c++, boost, expression, ublas

是否有一种单一表达式的方式来为提升矩阵或向量的所有元素分配一个标量？我试图找到一种更紧凑的表示方式：

```
boost::numeric::ublas::c_vector<float, N> v;
for (size_t i=0; i<N; i++) {
    v[i] = myScalar;
 } 
```

以下不起作用：

```
boost::numeric::ublas::c_vector<float, N> 
   v(myScalar, myScalar, ...and so on..., myScalar);

boost::numeric::ublas::c_vector<float, N> v;
v = myScalar; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-28T15:51:12.893

因为向量模型是一个标准的随机访问容器，所以您应该能够使用标准的 STL 算法。就像是：

```
c_vector<float,N> vec;
std::fill_n(vec.begin(),N,0.0f); 
```

或者

```
std::fill(vec.begin(),vec.end(),0.0f); 
```

它可能也与 Boost.Assign 兼容，但您必须检查一下。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-29T02:15:47.200

我已经开始使用[`boost::assign`](http://www.boost.org/doc/libs/1_38_0/libs/assign/doc/index.html)我想静态分配特定值的情况（从上面的链接中提取的示例）。

```
#include <boost/assign/std/vector.hpp>
using namespace boost::assign; // bring 'operator+()' into scope

{
  vector<int> values;
  values += 1,2,3,4,5,6,7,8,9;
} 
```

您也可以`boost::assign`用于地图。

```
#include <boost/assign/list_inserter.hpp>
#include <string>
using boost::assign;

std::map<std::string, int> months;
insert( months )
        ( "january",   31 )( "february", 28 )
        ( "march",     31 )( "april",    30 )
        ( "may",       31 )( "june",     30 )
        ( "july",      31 )( "august",   31 )
        ( "september", 30 )( "october",  31 )
        ( "november",  30 )( "december", 31 ); 
```

`list_of()`您可以允许使用and进行直接分配`map_list_of()`

```
#include <boost/assign/list_of.hpp> // for 'list_of()'
#include <list>
#include <stack>
#include <string>
#include <map>
using namespace std;
using namespace boost::assign; // bring 'list_of()' into scope

{
    const list<int> primes = list_of(2)(3)(5)(7)(11);
    const stack<string> names = list_of( "Mr. Foo" )( "Mr. Bar")
                                       ( "Mrs. FooBar" ).to_adapter();

    map<int,int> next = map_list_of(1,2)(2,3)(3,4)(4,5)(5,6);

    // or we can use 'list_of()' by specifying what type
    // the list consists of
    next = list_of< pair<int,int> >(6,7)(7,8)(8,9);

} 
```

还有用于`repeat()`、`repeat_fun()`和的函数，`range()`可让您添加重复值或值范围。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-07-06T13:36:06.160

推荐的方式如下所示：

```
boost::numeric::ublas::c_vector<float, N> v;
v = boost::numeric::ublas::zero_vector<float>(N);
v = boost::numeric::ublas::scalar_vector<float>(N, value); 
```

矩阵类型也是如此：

```
boost::numeric::ublas::matrix<float> m(4,4);
m = boost::numeric::ublas::identity_matrix<float>(4,4);
m = boost::numeric::ublas::scalar_matrix<float>(4,4);
m = boost::numeric::ublas::zero_matrix<float>(4,4); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-16T10:07:00.070

你试过这个吗？

ublas::c_vector v = ublas::scalar_vector(N, myScalar);

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T13:47:29.650

自从我使用 C++ 以来已经有一段时间了。下面的工作吗？

```
for (size_t i = 0; i < N; v[i++] = myScalar) ; 
```

# c++ - C ++中字符串分配的分段错误

> ID：798013
> 
> 赞同：1
> 
> 时间：2009-04-28T13:45:00.560
> 
> 标签：c++, segmentation-fault

看一下这个示例函数：

```
RuntimeConfiguration* conf_rt_conf() {

    RuntimeConfiguration *conf;
    conf = new RuntimeConfiguration();
    conf->arch_path="./archive";
    conf->err_log="./err_log";
    conf->fail_log="./fail_log";
    conf->msg_log="./msg_log";
    conf->save="html, htm, php";
    conf->ignore="jpg, gif";
    conf->cookies="";

    return conf;
} 
```

这里的一切都很好，但是当我运行这样的东西时：

```
DatabaseInput** conf_db_input() {

    DatabaseInput **db_input;
    db_input=(DatabaseInput **)malloc(NUMB_SITES*sizeof(DatabaseInput *));
    for (int i=0;i<NUMB_SITES;i++) db_input[0]= new DatabaseInput();

    db_input[0]->full_name="ABCNews";
    db_input[0]->alias="abcn";
    db_input[0]->prefix="/eng";

    db_input[1]->full_name="Rzeczpospolita";
    db_input[1]->alias="rp";
    db_input[1]->prefix="/pol";

    return db_input;
} 
```

我在第一次分配时遇到分段错误。它可能与为此结构分配的固定内存块有关。如何让它正常工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-28T13:48:32.300

我会改变

```
for (int i=0;i<NUMB_SITES;i++) db_input[0]= new DatabaseInput(); 
```

首先：

```
for (int i=0;i<NUMB_SITES;i++) db_input[i]= new DatabaseInput(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T13:48:51.940

您的代码提示了几个问题：

*   RuntimeConfiguration 的声明是什么？
*   你为什么混合使用malloc和new？
*   你不使用像 std::vector 这样的 C++ 容器吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-28T13:47:52.020

首先...您从未听说过（默认）构造函数吗？这读起来就像使用“new”的 C 代码，总是有点吓人。

其次，您所有新分配的结构都存储在`db_input[0]`，这似乎是错误的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-28T13:49:09.817

乍一看

> db_input[0]=新数据库输入（）；

我认为应该是

```
db_input[i]= new DatabaseInput(); 
```

也建议检查一下malloc操作的结果

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-28T13:47:52.020

你的'for'循环不需要引用`db_input[i]`吗？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-28T13:58:14.647

也许是这样：

```
DatabaseInput *db_input[];
db_input = new DatabaseInput*[NUMB_SITES]; // Creates an array of pointers
for (int i=0; i<NUMB_SITES; i++) db_input[i]= new DatabaseInput(); 
```

可以工作吗？（我没有测试过）

请注意，要释放使用的内存，您应该执行以下操作：

```
for (int i=0; i<NUMB_SITES; i++) delete db_input[i];
delete[] db_input; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-28T13:47:21.553

也许，你应该使用 db_input[i]

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-28T13:51:45.270

如果没有更多详细信息，我们无法确定错误。但有几点说明：

*   把new和malloc混在一起，特别是在同一个函数里，真是自找麻烦。除非您有充分的理由这样做，否则不要这样做，因为您很可能在新分配的缓冲区或 delete 和 malloc 分配的缓冲区上使用 free。
*   当您分配单个 DatabaseInput 时，您很可能会遇到错误，因为索引永远不会改变

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-28T15:09:47.847

```
db_input[0]= new DatabaseInput(); 
```

它实际上有 i 而不是 0，我只是尝试了几件事，在复制源代码时错过了那个零，所以这不是答案。

===编辑===

```
db_input = new DatabaseInput*[NUMB_SITES]; 
```

那行得通，谢谢加斯顿:)

# outlook - vCalendar - 显示为（空闲/忙碌/暂定/不在办公室）

> ID：798016
> 
> 赞同：8
> 
> 时间：2009-04-28T13:45:15.880
> 
> 标签：outlook, calendar, vcalendar

我向 Outlook 发送了一条 vCalendar 消息，这会在 Outlook 日历中产生一个新事件。如何设置“显示为”字段？（空闲/忙碌/暂定/不在办公室）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-02-23T15:00:28.447

I saw this line in the .ics file created by Outlook 2010

```
X-MICROSOFT-CDO-BUSYSTATUS:FREE 
```

so it looks like Microsoft has "extended" the vcal spec to suit their purposes. I can confirm that adding that line does work when a feed is viewed in Outlook and seems to cause no harm when consumed by the iPhone's calendar app.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-11-09T23:12:30.780

事实证明，在标准中有一个地方，肖恩错过了：

> 4.2.9 忙/闲时间类型
> 
> 参数名称：FBTYPE
> 
> 目的：指定空闲或忙碌时间类型。
> 
> 格式定义：属性参数由以下符号定义：
> 
> ```
>  fbtypeparam        = "FBTYPE" "=" ("FREE" / "BUSY"
>                     / "BUSY-UNAVAILABLE" / "BUSY-TENTATIVE"
>                     / x-name
>     ; Some experimental iCalendar data type.
>                     / iana-token)
> 
>     ; Some other IANA registered iCalendar data type. 
> ```
> 
> 说明：该参数指定空闲或忙碌时间类型。FREE值表示该时间间隔可用于调度。值 BUSY 表示时间间隔很忙，因为已为该间隔安排了一个或多个事件。BUSY-UNAVAILABLE值
> 表示时间间隔很忙，无法安排时间间隔。BUSY-TENTATIVE 值表示时间间隔很忙，因为已经
> 为该间隔暂时安排了一个或多个事件。如果未在
> 允许此参数的属性上指定，则默认值为 BUSY。
> 
> 示例：以下是该参数在 FREEBUSY 属性上的示例。
> 
> ```
>  FREEBUSY;FBTYPE=BUSY:19980415T133000Z/19980415T170000Z 
> ```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-05-26T13:57:24.853

X-MICROSOFT-CDO-BUSYSTATUS:OOF

标记 Outlook 的“不在办公室”日历

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-28T23:50:19.747

您指的是哪个状态字段？您的意思是在回复会议请求或发送有关会议的信息时？

无论哪种方式，答案都在 vCalendar 标准文档中。我认为您的意思是 STATUS 字段。维基百科有一个这个领域的例子：

```
BEGIN:VCALENDAR
VERSION:1.0
BEGIN:VEVENT
CATEGORIES:MEETING
STATUS:TENTATIVE
DTSTART:19960401T033000Z
DTEND:19960401T043000Z
SUMMARY:Your Proposal Review
DESCRIPTION:Steve and John to review newest proposal material
CLASS:PRIVATE
END:VEVENT
END:VCALENDAR 
```

[http://en.wikipedia.org/wiki/VCalendar#vCalendar_1.0](http://en.wikipedia.org/wiki/VCalendar#vCalendar_1.0)

格式的标准文档是：[http ://www.ietf.org/rfc/rfc2445.txt](http://www.ietf.org/rfc/rfc2445.txt)

您也可以尝试在 Outlook 中创建事件，将其保存为 vCard，然后在记事本中打开 vCard。这将向您展示 Outlook 如何保存信息。

该文档使我相信您只能设置忙碌或暂定状态：

> 4.8.1.11 状态
> 
> 属性名称：状态
> 
> 用途：此属性定义
> 日历组件的整体状态或确认。
> 
> 值类型：文本
> 
> 属性参数：可以在此属性上指定非标准属性参数。
> 
> 一致性：可以在“VEVENT”、“VTODO”或
> “VJOURNAL”日历组件中指定此属性。
> 
> 描述：在组计划日历组件中，“组织者”使用该属性
> 向
> “与会者”提供事件确认。例如，在“VEVENT”日历组件中，“组织者”可以指示会议是暂定的、确认的或取消的。在“VTODO”日历组件中，“组织者”可以指示操作项需要操作、已完成、正在进行或正在处理或已被取消。在“VJOURNAL”日历组件中，“组织者”可以指示日记条目是草稿的、最终的或已被取消或删除的。
> 
> 格式定义：该属性由以下符号定义：
> 
> ```
>  status     = "STATUS" statparam] ":" statvalue CRLF
> 
>  statparam  = *(";" xparam)
> 
>  statvalue  = "TENTATIVE"           ;Indicates event is
>                                     ;tentative.
>             / "CONFIRMED"           ;Indicates event is
>                                     ;definite.
>             / "CANCELLED"           ;Indicates event was
>                                     ;cancelled.
>     ;Status values for a "VEVENT" 
> ```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-21T12:48:16.200

我用python导入win32，因为这是一个叫BUSYSTATUS的属性，该值可以定义显示FREE=0,1=TENTIVE,2=BUSY的状态

```
import win32com.client as win32

outlook = win32.Dispatch('outlook.application')
myItem = outlook.CreateItem(1)
myItem.MeetingStatus =(1) ## this means it is an appointment
myItem.BUSYSTATUS=0 ## SHOW AS 0=FREE,1=TENTIVE,2=BUSY 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-04-10T19:14:35.260

不确定这些年来情况是否发生了变化，但我能够使用它自动将事物设置为暂定：

```
X-MICROSOFT-CDO-BUSYSTATUS:TENTATIVE 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-05T01:48:50.343

由于 RFC 2445 和 5545 都不支持 OOO 和 Tentative 状态，您可以使用属性 X-MICROSOFT-CDO-INTENDEDSTATUS：[https://msdn.microsoft.com/en-us/library/ee203636(v=exchg. 80).aspx](https://msdn.microsoft.com/en-us/library/ee203636(v=exchg.80).aspx)

# multithreading - 线程模型

> ID：798023
> 
> 赞同：1
> 
> 时间：2009-04-28T13:47:23.987
> 
> 标签：multithreading

是否有一个线程模型，其工作方式如下：

```
while thread = nextAvailableThread():
  thread.doWork(data) 
```

这样，当一个线程完成时，它会触发 nextAvailableThread() 返回刚刚完成的线程。该模型将使在线程之间分布不均匀的数据块变得更加容易，因为您可以将下一个数据块传递给下一个可用线程并产生接近最佳的数据分布。

我对在 C++ 中使用它特别感兴趣，但我很乐意看到任何语言中存在这样的东西？

编辑：线程池看起来就像我的想法。那么，对 C++ 实现有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T13:51:31.467

听起来您正在寻找一个线程池。[这](http://en.wikipedia.org/wiki/Thread_pool)是一篇文章，其中包含不同语言的特定实现的链接（在底部的外部链接中）。

编辑：[这](http://www.codeproject.com/KB/threads/thread_pooling.aspx)是一个 C++ 示例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T13:55:38.087

您可以使用阻塞工作队列和一组工作线程。Java 有[`ThreadPoolExecutor`](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ThreadPoolExecutor.html)，我确信 .NET 有一个类似的库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T14:33:12.677

试试这个： [线程池](http://threadpool.sourceforge.net/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T15:33:26.337

如果您使用的是 .Net，您可以查看[任务并行库。](http://blogs.msdn.com/pfxteam/)

该库非常易于使用，但内部也具有许多强大的功能。以最简单的形式，您可以像这样使用它：

```
Parallel.For(0, 100, delegate(int i) { 
   a[i] = a[i]*a[i]; 
}); 
```

美妙之处在于，只要内核准备好执行，它就会执行每个任务。在*n*核机器上，它在任何给定时刻都只有*n 个活动线程。*

如果您有时间，可以观看Daniel Moth 的[本次会议](http://channel9.msdn.com/pdc2008/TL26/)。即使您不使用 .Net，看到一些有关如何解决这些问题的示例也很有趣。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T15:18:06.077

生产者/消费者模式可能是您正在寻找的。

在最基本的配置中，您需要 2 个并发组件：thradsafe 队列和工作线程池。你可以在网上找到这些很好的例子。

# java - gwt 套接字连接

> ID：798024
> 
> 赞同：2
> 
> 时间：2009-04-28T13:47:27.513
> 
> 标签：java, sockets, gwt

我正在尝试编写一个使用 java.net.Socket 的应用程序。我还使用 GWT 用 Ja​​va 编写了一个应用程序来显示 ArrayList 中的内容。

但是，我现在需要通过套接字连接填充该 ArrayList。显然 Google Web Toolkit 不支持套接字连接。谁能给我一个解决方法？任何示例或示例链接将不胜感激。

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T13:55:12.580

你基本上有两个选择：

*   从您的客户端代码（GWT RPC、其他一些框架或手动处理）中使用 HTTP 连接。然后你可以从服务器建立你的 Socket 连接
*   在客户端上放置一个 Java 小程序（或者可能是一个 Flash 客户端）来执行此操作，然后编写自己的 GWT 组件来与小程序通信

浏览器不支持来自 Javascript 的直接套接字连接，因此无法在 GWT 客户端代码中直接支持 java.net.socket。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T21:48:52.333

GWT 旨在连接到后端服务器，您可以在此处进行所需的任何套接字连接。GWT 是前端技术，因为它是编译成 javascript 的，所以不能做诸如建立套接字连接之类的事情。您可以在后端使用任何您想要的技术，并将其连接到您的 java：- Java 后端（通过 RPC 调用与其对话）- Ruby/PHP 后端（通过 JSON 或 XML 与其对话）- 等等

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-10T22:00:20.127

gwt 有一个称为“FlashSockets”的实现。它将请求转发到可以连接的 Flash 电影（我对此了解不多，我只是在寻找相同的信息时遇到它）。

就个人而言，这似乎是一个不确定的解决方案，但如果您必须从客户端连接它可能会很有用。

# windows-vista - 在不关闭 UAC 的情况下在 Vista 上运行安装程序

> ID：798027
> 
> 赞同：3
> 
> 时间：2009-04-28T13:47:47.590
> 
> 标签：windows-vista, installation, windows-installer, uac

如果不关闭 UAC，我的 msi 安装程序无法安装在 Vista 机器上。由于我的应用程序将分发给我的客户，大约 20 台机器，并且他们不想关闭 UAC，有没有一种方法可以设置一些属性，让我的安装程序在 UAC 时无需任何用户交互即可静默运行，启用，弹出窗口

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-28T23:29:26.070

我发现了解 UAC 的最佳资源是[Robert Flamings 博客](http://blogs.msdn.com/rflaming/archive/tags/UAC+in+MSI/default.aspx)，他有一系列大约 25 篇文章，解释了 Vista、UAC 和 MSI 如何相互作用。

如果您正在执行每台计算机安装 (ALLUSERS=1)，Vista 将始终在到达 InstallExecuteSequence 时提示，*但是*如果您的安装程序需要在此序列*之外*进行提升，那么最好的解决方案是使用引导程序带有清单的 EXE，表明运行 EXE 时需要提升。

我们使用来自 Indigo Rose 的商业引导程序（它是一个独立的应用程序，但仅作为[MSI Factory的一部分出售），但您可以使用](http://www.indigorose.com/products/msi-factory/)[NSIS](http://nsis.sf.net/)获得创意，使用[Visual Studio并且在](http://code.msdn.microsoft.com/bmg)[Windows Installer SDK](http://www.microsoft.com/downloads/details.aspx?familyid=6a35ac14-2626-4846-bb51-ddce49d6ffb6&displaylang=en)中还有一个示例

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T13:58:23.117

弹出 UAC 是因为您正在安装到用户无权访问的文件夹，例如 Program Files，也许尝试安装到用户主驱动器之外的目录？Vista 中的主驱动程序是 c:\Users\Username，那里有一个用于本地应用程序的目录，C:\Users\Username\AppData\Local\Apps。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T20:20:52.070

您可以将安装通告给您的 20 个客户端。当他们触发广告钩子（开始菜单快捷方式、COM 接口、文件关联等）时，程序将以管理员权限安装。

以下是管理员如何宣传软件包的示例：

msiexec.exe -jm c:\\mypackage.msi

MSDN 文章： http: [//msdn.microsoft.com/en-us/library/aa367548 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa367548(VS.85).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T14:11:15.787

Vista/UAC 应该会提示您确认继续安装，而不是完全阻止它。你的微星叫什么名字？就像，如果您将其重命名为**setup.msi** ，它会神奇地工作吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T13:57:58.220

[这](http://huddledmasses.org/vista-setuid-how-to-elevate-without-prompting/)应该可以帮助你。

编辑：响应您的澄清请求。您可以使用任务计划来计划运行不会提示的安装，然后您可以让用户/系统管理员从脚本安装该计划程序（例如，您可以计划它在用户下次登录时运行） .

这是在 Vista 中避免确认对话框的唯一方法（没有禁用 UAC，您不想这样做）。

我希望这能让事情变得清楚。

# iphone - Objective-c Iphone如何设置属性的默认值

> ID：798030
> 
> 赞同：14
> 
> 时间：2009-04-28T13:47:54.687
> 
> 标签：iphone, objective-c, properties, constructor

嗨，我在 ViewController.h 中有以下代码：

```
#import <UIKit/UIKit.h>

@interface CalcViewController : UIViewController {
    NSNumber* result;
    NSString* input;
    //NSString* input = @"";

    IBOutlet UITextField* display;
}

@property (retain) NSNumber* result;
@property (retain) NSString* input;
@property (nonatomic, retain) UITextField* display;

@end 
```

问题是我想在输入中附加一个字符串，但是当它仍然为空时这是不可能的。这就是为什么我想将输入的默认值设置为@""。但是我把这段代码放在哪里。

我知道一种可能的解决方案，您可以将它放在默认构造函数中。但我不知道该放在哪个文件中。我应该从哪里调用它。

不幸的是，我对 C 的了解有限，并意识到 .h 文件可能不是正确的位置。

如果您需要，项目类型是基于视图的应用程序。

希望你能帮忙。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-28T14:17:04.913

您可能会发现阅读有关 Objective-C 或 Cocoa 的一些文档很有用。如果您在 StackOverflow 或 Google 上进行搜索，您可能会找到一些关于阅读材料的好建议。

要回答您的问题，您应该有一个 CalcViewController 的 @implementation。人们通常会将此@implementation 放在 *.m 文件中。如果您的 *.h 文件被命名为“ViewController.h”，那么实现将进入“ViewController.m”。

然后，您将创建 UIViewController 初始化函数的副本并将其放置在那里（我不知道默认的 init 函数是什么）。

例如：

```
@implementation CalcViewController

@synthesize result;
@synthesize input;

- (id)initWithNibName:(NSString*)aNibName bundle:(NSBundle*)aBundle
{
    self = [super initWithNibName:aNibName bundle:aBundle]; // The UIViewController's version of init
    if (self) {
        input = [[NSString alloc] initWithString:@""]; // You should create a new string as you'll want to release this in your dealloc
    }
    return self;
}

- (void)dealloc
{
    [input release];
    [super dealloc];
}
@end // end of the @implementation of CalcViewController 
```

笔记：

*   您可能希望将文件重命名为 CalcViewController。我相信 Xcode 的重构引擎更容易处理。
*   当您将其与 Interface Builder 连接时，您无需为显示实例变量声明 @property。除非您希望 CalcViewController 的客户端经常更改它

**编辑：** 2009 年 4 月 28 日：美国东部时间上午 10:20：我建议实际分配一个 NSString，因为从技术上讲，您应该在 dealloc 中释放它。

**编辑：** 2009 年 4 月 28 日：美国东部标准时间上午 11:11：我更新了 @implementation 以使用 UIViewController 的 init 版本。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-03-21T00:08:45.890

非常好的问题。简短的回答是在 init 函数中初始化值。您需要覆盖默认的 init 函数，以便在可以使用对象之前准备好默认值。我想建议人们停止建议其他人阅读文档；如果可以，请直接回答问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-28T14:45:42.147

另一种选择是为输入属性编写自己的 getter，如果实例变量为 nil，则返回 @""。即使您不小心或故意将 nil 分配给输入，这也会起作用，而使用 init 设置默认值会中断。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T09:57:10.890

最明显的实现方式如下：

1.  在您的 viewcontroller.m 文件中，覆盖默认的 init 方法。每次初始化视图控制器时都会调用此方法。因此，这是初始化变量的最佳方式。

    ```
    - (id)initWithNibName:(NSString*)aNibName bundle:(NSBundle*)aBundle {
        self = [super initWithNibName:aNibName bundle:aBundle]; // The UIViewController's     version of init
        if (self) {
            varName = [[NSString alloc] initWithString:@""];
        }
        return self;
    } 
    ```

2.  现在，无论您想在代码中的哪个位置将字符串附加到原始字符串，只需使用：`varName = [NSString stringwithformat:@"%@%@", varName, newString];`

# .net - 是否有从字符串中获取 CLR 版本类的“标准”方法？

> ID：798033
> 
> 赞同：0
> 
> 时间：2009-04-28T13:48:16.810
> 
> 标签：.net

我最近意识到我们的代码有几个版本解析器的实现（即从版本字符串创建版本对象的代码）。认为这是人们懒得阅读文档的时候之一，我想我会跳入 MSDN，找到执行此操作的“标准”方法并将各种方法替换为对该方法的调用。令我惊讶的是，Version 类没有 Parse 方法，在 Convert 或我搜索的其他任何地方也没有。

我只是错过了它，还是 .Net API 中没有用于将版本字符串转换为版本对象的方法。请注意我有代码可以做到这一点。事实上，我有两种不同的方法，它们被用于几种不同的方法中。我正在寻找的是标准库中的一个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T13:56:17.337

[接受字符串](http://msdn.microsoft.com/en-us/library/y0hf9t2e.aspx)的构造函数呢？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T13:51:17.097

你能为 a 写一个扩展方法`Version.Parse`吗？这样它就会在一个地方。

在 C#...

```
Version Parse(this Version ver, string Value) {
    // your conversion here.
} 
```

在 VB...

```
Imports System.Runtime.CompilerServices

Module VersionExtensions

    <Extension()> _
    Public Function Parse(ByVal aVersion As Version, ByVal aValue As String) As Version
        ' Conversion Here
    End Function

End Module 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T13:57:53.993

我猜您正在寻找的“标准方法”是带有单个字符串参数的[Version 构造函数？](http://msdn.microsoft.com/en-us/library/system.version.version.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T15:49:35.113

这个问题是我们从硬件获得的版本字符串不是“标准”版本字符串。它的形式是major.minor.patch（构建），而不是major.minor.build.patch。

# c# - 如何在 C# 静态和非静态方法之间做出决定？

> ID：798036
> 
> 赞同：14
> 
> 时间：2009-04-28T13:48:58.820
> 
> 标签：c#, oop, class-design

[编辑]

我最初的问题是“为什么要在静态和非静态之间做出决定？两者都做同样的......”

不幸的是，它被编辑为一个我真正想避免的 C# 特定问题。

所以，让我做一些补充：

当我说接口时，我指的不是 C#-keyword-interface，而是我理解的类似于 C++-interface 的东西：一组定义明确的函数来操作我的对象。当说弱化我的界面时，我的意思是我有不同的功能（静态/非静态）来做同样的事情。当有不同的功能来做同样的事情时，我的界面不再定义良好。

因此，正如管理员 Bob 所发布的，我可以实现一个 Validate() 函数

```
Document.Validate(myDocumentObject); 
```

但是也

```
myConcreteDocumentObject.Validate(); 
```

回到我的 Copy() 示例，可以像这样实现 Copy()

```
myConcreteDocument.Copy(toPath); 
```

但是也

```
Document.Copy(myConcreteDocumentObject, toPath) 
```

或者

```
Document.Copy(fromPath, toPath) 
```

当我想到一个包含属于我的文档的所有文件的文件夹时（在这种情况下，我不依赖于具体实例 - 但我依赖于其他事物:)）。

一般来说，我说的是静态方法而不是静态类（对不起，如果我忘了提及）。

但正如 Anton Gogolev 所说，我认为我的 Document 类不是一个很好的例子，也没有很好的设计，所以我想我必须看看 Single Responsibility Principle。

我还可以实现某种与我的 DocumentClass 一起运行的 ManagerClass：

例如：

```
myDocumentManagerObject.Copy(myConcreteDocumentObject, toPath); 
```

或者

```
myDocumentManagerObject.Copy(myConcreteDocumentObject, toPath); 
```

但如果我参考方法 1) 我倾向于创建自己执行任务的对象，而不是创建对*我*的 DocumentObject 执行某些操作的其他对象 (DocumentManager) 。

（我希望这不会指向关于 OOP 的宗教讨论；）。）

[/编辑]

* * *

## 旧版：

起初，这似乎是一个非常基本的问题，例如“何时使用静态方法，何时不使用”，但这是我不时遇到的问题（我很难描述真正的问题是什么；也许只是为了了解为什么（不）使用 1）或为什么（不）使用 2））。

（虽然我使用的是 C#-Syntax，但这不是 C# 限制的问题）

在 OOP 中，有两种处理对象的方法（其中包括）：

1）如果我想让我的对象做某事，我只是告诉他这样做：

```
myConcreteObject.DoSomething(); 
```

这就像和一个对象说话一样。

2) 或者，如果您喜欢静态方法：

```
ObjectClass.JustDoIt(); 
```

在某种程度上，我认为静态函数只是“感觉”更好。所以我倾向于经常使用静态方法（独立于具体实例——独立总是好事）。

因此，在设计课程时，我经常需要决定是采用方法 1) 还是方法 2)：

想象一下，您有一个“文档”类，它应该代表应该保存到数据库中的文档：

一份文件

*   由文件系统中的一个或多个图像文件组成（这些成为单个文档页面）
*   有类似书目的东西 - 用户可以添加有关文档信息的字段 - 保存到额外的文件中
*   并且应该有一些操作，如 Copy()、AddPage()、RemovePage() 等。

现在我遇到了几种创建此类的方法：

```
//----- 1) non static approach/talking to objects -----
Document newDocument = new Document();

// Copy document to x (another database, for example)
newDocument.Copy(toPath); 
```

我喜欢这样：我告诉文档将自己复制到数据库 x 并且对象自己这样做。好的。

```
//----- 2) static approach ----------------------------
Document.Copy(myDocumentObject, toPath); 
```

为什么不？也不错，手感很好。。。

那么，实施哪一个呢？两个都？或者将静态方法放在一种帮助类中？还是选择方法 1) 并坚持不削弱我的 Document-class 的接口？

在考虑这两种方法时，我得出的结论是（理论上）可以将任何函数实现为静态函数：

```
Class.Function(aConcreteClassObject, parameters); 
```

但也是非静态的：

```
aConcreteObject.DoSomething(parameters); 
```

举一个真实的例子：

[编辑（从路径添加参数“对不起，我忘记了”）]

```
//----- 2) static approach ----------------------------
File.Copy(fromPath, toPath);    // .Net-Framework-like 
```

[/编辑]

但是也：

```
//----- 1) non static approach ------------------------
ExampeFileClass fileObject = new ExampleFileClass();
fileObject.Copy(toPath); 
```

甚至（有点像 OOP-Overkill）：

```
//----- 1) non static approach, too -------------------
fileObject.ToPath = @"C:\Test\file.txt";     // property of fileObject
fileObject.Copy();                           // copy to toPath 
```

那么，为什么（不）使用 1）或为什么（不）使用 2）？

（我不会过多地关注 Document 类示例，因为它更像是一个关于良好类设计的一般问题。）

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-28T13:58:01.077

开始了。

首先：

> 所以我倾向于经常使用静态方法（独立于具体实例——独立总是好事）。

恰恰相反：使用静态方法时，您非常依赖具体实例。

就你`Document`而言，我不会去。您已经列出了`Document`类的所有职责，包括数据聚合、将自身保存到数据库以及页面操作和复制。

这是太多了。根据[SRP](http://en.wikipedia.org/wiki/Single_responsibility_principle)，每个“模块”（这里的“模块”用作一个包罗万象的术语）应该只有一个改变的理由。你`Document`有很多责任，因此它有很多改变的理由。这不好。

考虑到这一点，我会将所有逻辑移至具有严格定义职责的其他类。我相信 Herb Sutter 或 Andrei Alexandrescu 引入了一个或多或少公认的移动标准，如下：可以通过其公共合同对对象执行的所有操作（思考方法）都应该移到外部有问题的对象。

* * *

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-28T14:02:10.817

不能使用静态方法来实现接口，也不能覆盖静态方法。所以使用静态方法意味着你根本不做 OOP。

想想您将如何仅使用静态方法来实现以下功能？

```
interface IDocument 
{
   void Print(IDevice targetDevice);
}

IDocument instance;

instance = new PdfDocument();
instance.Print(printer);

instance = new WordDocument();
instance.Print(printer); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-28T13:52:27.313

吻。如果您不必调用构造函数，那就更好了。

此外，静态方法应该告诉您一些关于函数如何操作的信息：

*   它不对传递给它的变量之外的变量进行操作。
*   除了调用方法时，它不需要任何内存（不计算从函数返回的内容）

还有一些其他重要的事情需要注意：

*   某些实例（Java）中的静态方法无法被覆盖/子类化，因此它们更适合***不需要更改实现***的情况。
*   有些人会争辩说，静态方法[本质上是难以测试](http://googletesting.blogspot.com/2008/12/static-methods-are-death-to-testability.html)的。

我也会参考这个[线程](https://stackoverflow.com/questions/475097/is-there-a-rule-of-thumb-for-when-to-code-a-static-method-vs-an-instance-method)，以及一个[简单的谷歌搜索](http://www.google.com/search?q=why+use+static+methods&sourceid=navclient-ff&ie=UTF-8&rlz=1B3GGGL_enUS309US309)，坦率地说，它提供了大量关于这个主题的讨论。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-28T13:54:10.053

我的“规则”是：

*   如果我不需要使用类中的属性，请将其设为静态。（换句话说，如果方法没有真正附加到类，只是为了逻辑关联，使用 static ）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-28T13:54:42.177

一般来说，如果你有这样的方法：

```
Document.Copy(myDocumentObject, toPath); 
```

我认为最好使用非静态方法，因为第一个参数是 Document 表明它实际上是对文档的操作。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-13T19:42:50.933

通常，在使用 OO 思维方式进行编程时，您将希望避免使用静态方法。在 OOP 中，想法是将一切都表示为对象，并赋予每个对象一组清晰的能力，以表示其核心抽象。静态方法“打破”了这种抽象。

您谈论具有复制方法的 Document 类的示例就是一个很好的示例。我认为**正确的 OO 实现是第一种方式**。也就是说，将复制作为这样的实例方法：

```
document1.copy(toPath) 
```

复制自身的能力是 Documents 核心抽象的一部分，这是有道理的。这样，发送复制消息的客户端代码只需要指定复制*到*哪里，因为可以理解 Document 会跟踪它在内部的位置。无需在其他任何地方复制该信息，这是您提供的第三个选项的一个主要问题，如下所示：

```
Document.copy(fromPath, toPath) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-28T14:08:39.333

如果你不得不问，不要使用静态。

实际的经验法则（有很多真正的技术原因，但我发现这有助于解释这些概念）：

*   如果有问题的类可以存在多次，则它不是静态的。

*   如果所讨论的方法对实例信息起作用，则它不是静态的。

*   如果方法或类是关于元信息的，它是静态的。

有了这些指导方针，文件和文档很明显是多份的，复制是对实例的一种行为。该方法不应该是静态的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-28T15:23:31.150

静态方法可能非常有用，我喜欢扩展方法，但它们会强制耦合，如果使用不当会使测试成为一场噩梦！

何时使用静态的一个很好的例子是当你想要这样做的时候

```
public static errors Validate(Document myDoc)
{
..some validation code
} 
```

这是非常可测试的，并且将方法与对象紧密耦合并不重要。使用静态方法的一个不好的地方是当它使用其他东西然后只返回一些东西时，一个例子是在验证对象的 Biz 层中，如果它通过验证，它将数据保存到数据库

```
public static errors ValidateAndSave(Document myDoc)
{
    errors docErrors = Validate(myDoc);
    if(docErrors.count==0)
    {
         docErrors = SaveToDB(myDoc);
    }

   return docErrors; 
} 
```

这是一个真正的测试痛苦，因为每次你运行它，并且它通过验证你的数据库，你的 Biz 逻辑可能不会产生错误，但你的 DAL 层可能，所以不是只测试 Biz 层的功能您还必须测试 DAL 层，并且将对象、Biz 层和 Dal 紧密耦合在一起，这使得测试和维护非常困难。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-28T13:54:54.560

一般来说，我会说“复制”自己，就对象而言，通常意味着将自己的数据克隆到新对象中。此处描述的“复制”是文件系统代表您执行的操作，而不是对象。因此，我将其设为静态方法，而不是 Document 实例上的方法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-28T13:56:46.053

与 altCongnito 相同，我将添加每个人都会使用的 fileObject.Copy，而不是对象 fileObject。静态用于与类有理想关系而不是函数依赖的函数。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-29T13:13:37.257

如果您使用任何其他对象，那么您将默认使用实例级别的方法，以便您可以使用依赖注入配置这些依赖项。

例如，如果其中一个图像是 SVG 图像，那么您可能依赖于 XML 解析器，该解析器（至少在 Java 中）有许多实现，同样对于我想象的 SVG 渲染器和许多其他组成图像类型可能需要类似的安排随着对象状态的演变或必须在不同的使用场景中更改（例如测试、生产、不同项目重用您的代码）而演变。

闪烁的琥珀色警告灯表示您可能正在使用不属于框架默认库的类，因此您选择了第三方组件，如果使用静态，您不适合修改该决定。

一个有用的“红线”是，如果您触及另一个进程（数据库服务器、Web 服务等），那么我会在 100% 的情况下认为静态方法很糟糕，因为这会使单元测试更加困难。

# visual-studio - 在解决方案资源管理器中折叠项目

> ID：798039
> 
> 赞同：37
> 
> 时间：2009-04-28T13:49:53.920
> 
> 标签：visual-studio

如何使用键盘折叠/展开解决方案探索中的所有项目？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2014-02-26T01:41:28.223

在**Visual Studio 2013**中，它最终只是解决方案资源管理器的一部分……带有“全部折叠”图标。 ![在此处输入图像描述](https://i.stack.imgur.com/aDJwS.png)

较早版本的电动工具可用的右键单击选项不存在，但无论如何单击图标更容易。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2011-03-03T22:47:47.290

`*`数字键盘控件上的`+`和`-`执行此操作：

*   打开解决方案资源管理器，选择要展开的文件夹并按`*`。

*   要折叠，请按`-`。

*   然后，如果您折叠了一些子文件夹，请按`+`返回到部分折叠的版本。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-28T13:55:35.247

Power Commands for VS2008 有一个命令可以做到这一点，还有许多其他简洁的工具

[http://code.msdn.microsoft.com/PowerCommands](http://code.msdn.microsoft.com/PowerCommands)

您也可以编写一个宏来执行此操作，并将其分配给一个组合键

[http://weblogs.asp.net/israelio/archive/2007/09/06/visual-studio-collapse-selected-node.aspx](http://weblogs.asp.net/israelio/archive/2007/09/06/visual-studio-collapse-selected-node.aspx)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-29T01:34:59.793

按 CTRL+ALT+L 以专注于解决方案资源管理器。如果它不在屏幕上，或者它已经折叠，这将集中在它上面。

然后尽可能多地按左箭头键以获得解决方案，再按一次左箭头键，它将折叠整个树。

我只是测试了VS2008，你也可以按HOME，到树的顶部。

如果您想要的是解决方案打开，并且所有项目文件都关闭，那么....

在树视图中回到家后，为每个打开的项目和|或打开的解决方案文件夹（如果有的话）按下、向左。

@Jason 提到的电动工具可能有不同的解决方案，但这是您无需任何插件即可导航解决方案树的方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-01T13:54:06.800

试试这个：http: [//visualstudiogallery.msdn.microsoft.com/cb0ec47d-05a4-40a7-ba39-9a2da6492f1c/](http://visualstudiogallery.msdn.microsoft.com/cb0ec47d-05a4-40a7-ba39-9a2da6492f1c/)

# powershell - 如何在目录结构中找到 10 个最大的文件

> ID：798040
> 
> 赞同：38
> 
> 时间：2009-04-28T13:50:07.490
> 
> 标签：powershell

如何在目录结构中找到 10 个最大的文件？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-04-28T13:55:11.317

试试这个脚本

```
Get-ChildItem -re -in * |
  ?{ -not $_.PSIsContainer } |
  sort Length -descending |
  select -first 10 
```

分解：

过滤块“ `?{ -not $_.PSIsContainer }`”用于过滤目录。sort 命令将按大小按降序对所有剩余条目进行排序。select 子句只允许前 10 个通过，因此它将是最大的 10 个。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-05-01T18:25:24.667

这可以稍微简化一下，因为目录没有长度：

```
gci . -r | sort Length -desc | select fullname -f 10 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-04-24T23:41:09.423

我在[博客上写过一个类似的问题](http://blog.danskingdom.com/find-largest-or-smallest-files-in-a-directory-or-drive-with-powershell/)，我想在一个目录和所有子目录（例如整个 C: 驱动器）中找到最大的文件，并以易于理解的格式（GB、MB、和 KB）。这是我使用的 PowerShell 函数，它在一个漂亮的 Out-GridView 中列出了按大小排序的所有文件：

```
Get-ChildItem -Path 'C:\somefolder' -Recurse -Force -File |
    Select-Object -Property FullName `
        ,@{Name='SizeGB';Expression={$_.Length / 1GB}} `
        ,@{Name='SizeMB';Expression={$_.Length / 1MB}} `
        ,@{Name='SizeKB';Expression={$_.Length / 1KB}} |
    Sort-Object { $_.SizeKB } -Descending |
    Out-GridView 
```

输出到 PowerShell GridView 非常好，因为它允许您轻松过滤结果并滚动浏览它们。这是较快的 PowerShell v3 版本，但博文还显示了较慢的 PowerShell v2 兼容版本。

当然，如果您只想要前 10 个最大的文件，您可以`-First 10`在 Select-Object 调用中添加一个参数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-14T12:46:54.553

如果您关心结果集的一些格式设置，这里有两个输出更好看的函数：

```
#Function to get the largest N files on a specific computer's drive
Function Get-LargestFilesOnDrive
{
Param([String]$ComputerName = $env:COMPUTERNAME,[Char]$Drive = 'C', [Int]$Top = 10)
Get-ChildItem -Path \\$ComputerName\$Drive$ -Recurse | Select-Object Name, @{Label='SizeMB'; Expression={"{0:N0}" -f ($_.Length/1MB)}} , DirectoryName,  Length | Sort-Object Length -Descending  | Select-Object Name, DirectoryName, SizeMB -First $Top | Format-Table -AutoSize -Wrap    
}

#Function to get the largest N files on a specific UNC path and its sub-paths
Function Get-LargestFilesOnPath
{
    Param([String]$Path = '.\', [Int]$Top = 10)
    Get-ChildItem -Path $Path -Recurse | Select-Object Name, @{Label='SizeMB'; Expression={"{0:N0}" -f ($_.Length/1MB)}} , DirectoryName,  Length | Sort-Object Length -Descending  | Select-Object Name, DirectoryName, SizeMB -First $Top | Format-Table -AutoSize -Wrap
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-17T11:35:22.887

这是我知道的最快完成此操作的方法：

```
$folder  = "$env:windir" # forder to be scanned
$minSize = 1MB

$stopwatch =  [diagnostics.stopwatch]::StartNew()

$ErrorActionPreference = "silentlyContinue"
$list = New-Object 'Collections.ArrayList'
$files = &robocopy /l "$folder" /s \\localhost\C$\nul /bytes /njh /njs /np /nc /fp /ndl /min:$minSize
foreach($file in $files) {
    $data = $file.split("`t")
    $null = $list.add([tuple]::create([uint64]$data[3], $data[4]))
}

$list.sort() # sort by size ascending
$result = $list.GetRange($list.count-10,10) 
$result | select item2, item1 | sort item1 -Descending

$stopwatch.Stop()
$t = $stopwatch.Elapsed.TotalSeconds
"done in $t sec." 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2016-06-07T18:31:42.513

将前 10 个最大文件放入本地目录的基本方法是使用 h 表示人类可读，S 按大小对文件进行排序：

```
ls -Sh -l |head -n 10 
```

或者你可以使用

```
du -ha /home/directory |sort -n -r |head -n 10 
```

# .net - 我需要多少个 .snk 文件？

> ID：798041
> 
> 赞同：1
> 
> 时间：2009-04-28T13:50:15.510
> 
> 标签：.net, strongname

假设我有几个 .NET 程序集，并且想用一个强名称对它们中的每一个进行签名。一个密钥对（一个 .snk 文件）是否足够，还是我需要为每个程序集生成一对？我必须发布（每个）密钥对的公钥吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-28T13:53:07.797

您只需要一个 .snk 文件。

您不需要发布公钥。任何人都可以使用带有 -p 开关的 sn.exe 获得公钥。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T14:04:47.050

一个密钥文件足以签署多个相关程序集。看看你的 GAC。来自同一产品或平台的程序集通常都具有相同的密钥。例如，许多 Microsoft 的 .NET 框架程序集共享相同的密钥。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-28T18:46:54.603

我们有 (3) 个 .snk 文件。

一个用于签署我们的程序集，一个用于现场代码生成（我们不再需要这样做），mono.snk 用于签署 Mono.Cecil 和 Mono.Security（这些是为与 Microsoft 的 .NET 一起使用）。

# c++ - C ++中小数点的数字限制

> ID：798046
> 
> 赞同：23
> 
> 时间：2009-04-28T13:51:12.277
> 
> 标签：c++

我是 C++ 新手。我有一个双变量`double a=0.1239857`，我想将变量`a`从小数点限制为两位数。`a`也会如此`0.12`。我知道 C++ 具有返回大于或小于`a`ceil 或 floor 的最大或最小整数的函数。

有没有实现浮点变量位数限制的函数？或者如何更改`a`变量的精度？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-28T13:55:05.700

您实际上是在尝试对数字进行四舍五入，还是只是更改其显示的精度？

对于前者（截断多余的数字）：

```
double scale = 0.01;  // i.e. round to nearest one-hundreth
value = (int)(value / scale) * scale; 
```

或（根据 jheriko 的回答酌情向上/向下舍入）

```
double scale = 0.01;  // i.e. round to nearest one-hundreth
value = floor(value / scale + 0.5) * scale; 
```

对于后者：

```
cout << setprecision(2) << value; 
```

其中参数 to`setprecision()`是小数点后显示的最大位数。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-28T13:54:53.440

这将导致小数点后两位数。

```
a = floor(a * 100.0) / 100.0; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-28T13:55:44.823

如果您只想输出值，可以执行类似的操作

```
printf("%.3f", a); // Output value with 3 digits after comma 
```

如果要转换值本身，可以执行以下操作：

```
a = (int)(a * 1000) / 1000.0f; 
```

请注意，两者都没有舍入，它们只是截断值。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-28T13:54:18.993

你想限制变量是什么意思？值或其格式。对于值，您可以使用地板 + 除法。就像是：

```
double a = 0.12123
double b;

b = floor(a * 100) / 100 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-28T13:55:58.850

使用 a[`ios_base::precision`](http://www.cplusplus.com/reference/iostream/ios_base/precision/)来格式化 i/o。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-28T13:58:04.383

您可以在流上设置精度，例如

```
double d = 3.14579;
cout.precision(2);
cout << d << endl;

// Or use a manipulator

#include <iomanip>
cout << setprecision(2) << d << endl; 
```

请注意，当您将 double 或 float 发送到这样的流时，它会自动为您舍入（如果您不知道这一点，有时可能会绊倒您）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-28T15:02:10.000

实际的舍入解决方案是`x = floor(100*x + 0.5) / 100;`假设要舍入的值在变量“x”中。

这里`x = floor(100*x) / 100;`其他人推荐的实际上会将数字截断为 2dp 。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-07-08T17:42:36.197

你也可以这样做：

```
//This code will ask the user for an input, set the decimal precision to the hundredths place,  and add 4.63 to the inputted variable

int banana;
cin >> banana;
cout << setprecision(2) << fixed << banana + 4.63; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-04-23T07:32:31.280

您可以编写自己的函数，如下所示，它也可以处理小数的舍入错误。

```
double RoundForGivenPrecision(const double dNumber, int iDecimalPlaces)
{
long long multiplier = (long long)pow(10, iDecimalPlaces);
long double value = dNumber < 0 ? (long long)((nextafter(dNumber, -DBL_MAX)*multiplier)-0.5) : (long long)((nextafter(dNumber,DBL_MAX)*multiplier)+0.5);
return value / multiplier;
} 
```

# iphone - iPhone SDK - navController pushViewController - 没有响应

> ID：798049
> 
> 赞同：0
> 
> 时间：2009-04-28T13:51:22.853
> 
> 标签：iphone, cocoa-touch, uiviewcontroller, uinavigationcontroller

我有一个带有两个按钮的navigationController 视图，START（本质上是一个登录按钮）和SETTINGS。当我单击设置时，设置视图出现并按计划关闭。我可以单击设置，然后多次单击返回而不会崩溃。好的。

现在，当用户单击 START 时，我调用 SHOWLOGOFFBUTTONS 方法来更改出现在视图顶部的 navController 中的按钮。导航栏现在应该（并且确实）只有一个注销按钮。单击该按钮时，我调用 SHOWLOGINBUTTONS 以便用户拥有与以前相同的登录按钮，因此他们可以再次访问 SETTINGS 和 START（登录）。

问题是，一旦我将“按钮切换”从登录按钮切换到注销按钮再回到登录按钮，设置按钮就会停止工作。SHOWSETTINGS 方法触发并运行 - 没有发生错误 - 但视图没有出现。

任何帮助将不胜感激！！

```
-(void)showLoginButtons{
    self.navigationItem.rightBarButtonItem=[[UIBarButtonItem alloc] initWithTitle:@"Settings" style:UIBarButtonItemStylePlain target:self action:@selector(showSettings)];
    self.navigationItem.leftBarButtonItem=[[UIBarButtonItem alloc] initWithTitle:@"Start" style:UIBarButtonItemStylePlain target:self action:@selector(tryConnection)];
}

-(void)showLogoffButtons{
    self.navigationItem.rightBarButtonItem=nil;
    self.navigationItem.leftBarButtonItem=[[UIBarButtonItem alloc] initWithTitle:@"Logoff" style:UIBarButtonItemStylePlain target:self action:@selector(resetConnectionAndScreen)];
}

-(void)showSettings{
    SettingsViewController *mySettingsViewController= [[SettingsViewController alloc] initWithNibName:@"SettingsViewController" bundle:nil];
    iPhone_PNPAppDelegate *mainDelegate = (iPhone_PNPAppDelegate *)[[UIApplication sharedApplication] delegate];
    mySettingsViewController.settings=mainDelegate.settings;
    [[self navigationController] pushViewController:mySettingsViewController animated:YES];
    [mySettingsViewController release];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T14:24:59.263

您需要释放按钮，因为您正在分配它们。为此，我通常使用自动释放 - 尝试：

```
 -(void)showLoginButtons{
    self.navigationItem.rightBarButtonItem=[[[UIBarButtonItem alloc] initWithTitle:@"Settings" style:UIBarButtonItemStylePlain target:self action:@selector(showSettings)] autorelease];
    self.navigationItem.leftBarButtonItem=[[[UIBarButtonItem alloc] initWithTitle:@"Start" style:UIBarButtonItemStylePlain target:self action:@selector(tryConnection)] autorelease];
} 
```

在你的 showLogoffButtons 方法中也做同样的事情。

# jms - SUN IMQ 主题消息预览

> ID：798050
> 
> 赞同：2
> 
> 时间：2009-04-28T13:51:24.070
> 
> 标签：jms, sun

有没有办法查看驻留在 JMS 主题目标中的消息？

我遇到了消息没有从主题目的地发布的问题。该主题有 1 个生产者和 7 个消费者，并且没有一个是持久的。

在此先感谢您的任何建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T08:26:57.417

经过一番挖掘终于找到了答案。

我需要使用以下命令：

```
imqcmd list msg -t t -n my_topic -nocheck 
```

其中 my_topic 是我的主题目的地的名称。收到如下回复后：

```
Listing messages for the destination
------------------------------------
Destination Name    Destination Type
------------------------------------
my_queue            Topic

On the broker specified by:

-------------------------
Host         Primary Port
-------------------------
localhost    7676

--------------------------------------------------------------------------------------------------
Message #   Message IDs                                                     Priority   Body Type
--------------------------------------------------------------------------------------------------
0           ID:9-AAA.BBB.CCC.DDD(e9:3b:c8:51:8b:75)-58798-1217457169630     4          TextMessage
1           ID:10-AAA.BBB.CCC.DDD(e9:3b:c8:51:8b:75)-58798-1217457169709    4          TextMessage
2           ID:11-AAA.BBB.CCC.DDD(e9:3b:c8:51:8b:75)-58798-1217457169717    4          TextMessage
3           ID:12-AAA.BBB.CCC.DDD(e9:3b:c8:51:8b:75)-58798-1217457169720    4          TextMessage
4           ID:13-AAA.BBB.CCC.DDD(e9:3b:c8:51:8b:75)-58798-1217457169723    4          TextMessage
5           ID:14-AAA.BBB.CCC.DDD(e9:3b:c8:51:8b:75)-58798-1217457169727    4          TextMessage 
```

我可以使用以下命令查看消息详细信息：

```
imqcmd query msg -t t -n my_topic -msgID "ID:9-AAA.BBB.CCC.DDD(e9:3b:c8:51:8b:75)-58798-1217457169630" -nocheck 
```

这将打印如下内容：

```
Querying message:
------------------------------------------------------------
Message ID
------------------------------------------------------------
ID:9-AAA.BBB.CCC.DDD(e9:3b:c8:51:8b:75)-58798-1217457169630

In the destination
------------------------------------
Destination Name    Destination Type
------------------------------------
my_topic            Topic

On the broker specified by:

-------------------------
Host         Primary Port
-------------------------
localhost    7676

--------------------------
Message Header Information
--------------------------
Message ID                  ID:9-AAA.BBB.CCC.DDD(e9:3b:c8:51:8b:75)-58798-1217457169630
Correlation ID              TestCorrID
Destination Name            my_topic
Destination Type            Topic
Delivery Mode               PERSISTENT (2)
Priority                    4
Redelivered                 false
Timestamp                   7/30/08 3:32:49 PM
Type                        
Expiration                  12/31/69 4:00:00 PM
ReplyTo Destination Name    temporary_destination://topic/AAA.BBB.CCC.DDD/58798/1
ReplyTo Destination Type    

------------------------------
Message Properties Information
------------------------------
LongProp      6534
IntProp       3
StringProp    TestStringValue
DoubleProp    7.4687643E7

------------------------
Message Body Information
------------------------
Body Type    TextMessage (1) 
```

之后可以使用以下命令删除消息：

```
imqcmd destroy msg -t t -n my_topic-msgID "ID:9-AAA.BBB.CCC.DDD(e9:3b:c8:51:8b:75)-58798-1217457169630" -nocheck 
```

希望这对某人有所帮助，有一天......

# asp.net - 如何从 XML 文件加载哈希表？

> ID：798051
> 
> 赞同：1
> 
> 时间：2009-04-28T13:51:29.967
> 
> 标签：asp.net, xml

我想将所有名称/值对从 C# 中的 XML 文件加载到哈希表中。

请注意，“值”部分可能包含 HTML 标记，因此它必须以某种方式从中逃脱。这会在代码中完成还是我应该使用`CDATA`？

### 示例 XML：

```
<root><node name="node1">value</node><node name="node1">value2</node><root> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T14:06:55.280

是的，我会将任何 HTML 包装在 CDATA 中，然后将它们选择到`Dictionary<string,string>`.

```
 string xml = "<?xml version= '1.0'?><root><node name=\"node1\">value</node><node name=\"node2\">value2</node></root>";
    var doc = XDocument.Parse( xml );
    var dict = doc.Element("root")
                  .Elements( "node" )
                  .Select( e => new
                   {
                       Key = e.Attribute( "name" ).Value,
                       Value = e.Value
                   } )
                  .ToDictionary( k => k.Key, v => v.Value ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T14:01:53.563

您可以使用 CDATA 和/或转义 HTML 实体，即 < 变为 < 等。

请参阅卓越的专家网站[http://escapehtmlforxml.com/](http://escapehtmlforxml.com/) (!)

# apache - 阿帕奇响应时间

> ID：798065
> 
> 赞同：1
> 
> 时间：2009-04-28T13:54:22.270
> 
> 标签：apache

我一直在本地局域网上使用 Apache。问题是我最近安装了 APC（连同 PHP5-dev 和 apache2-dev）。现在 Apache 的响应时间减少了。加载一个 php 页面大约需要 2 秒，而之前大约需要 500 毫秒。尽管在萤火虫中显示了旧的响应时间。

为什么会这样？我应该如何解决？

非常感谢你。

**更新**如果我重新安装它，我应该安装哪个服务器？我想从我的服务器上获得超快的 LAN 响应时间。我正在计划 ubuntu 桌面 9.04。还是我应该使用 ubuntu 8.04 服务器？还是 ubuntu 9.04 服务器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T13:58:38.017

你知道这是服务器问题吗？我会尝试全新安装操作系统或至少是浏览器，如果您使用 Firefox，您可能会有一个插件与您的网站交互不良。在假设它是 Apache 之前先检查客户端。第二个 APC 可能是问题所在。由于该站点在您的局域网上，因此可能流量较低。APC 可能会花时间兑现代码，但每次加载 PHP 页面时都必须重新兑现代码，因为流量如此之少。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T14:01:15.997

这听起来像是每次 PHP 启动时的一些非常高的内存使用量。`top`在打开页面时签入 bash 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-08-12T11:07:05.387

如果您真的想要/需要极快的响应时间，您应该开始阅读书籍或联系专业的性能调整专家，因为您似乎根本没有任何测量概念。

我的意思是统计数据的存在：LINUX stats、APC stats、apache stats、（php stats ？）、LAN/WLAN stats 等等。

衡量和分析您的环境，而不是猜测。当 Waage 建议使用 top 命令时，我的心都碎了......难怪在你的 > top 显示 1.0 并且 apache 显示 1.0 之后他从未回答过......

在您的情况下，您需要清楚地了解 end-2-end 响应时间。（你应该早就设置了程序。不，你有麻烦，你甚至没有准备好灭火）

到目前为止我所有写作的原因是我完整的 apache/php/MySQL 实时监视器的存在。支持 LINUX 和 WINDOWS。看图……（放几张图，但我不能贴图。我的天啊。）

如果您仍然对解决方案感兴趣（您的博客条目很旧），请给我发送电子邮件。然后我将发送一些文件。

还尝试改进您的 apache-log-file 信息。检查以下网址。第一步真的很好，因为从现在开始您将获得真正的 apache 响应时间：

[http://www.ducea.com/2008/02/06/apache-logs-how-long-does-it-take-to-serve-a-request/](http://www.ducea.com/2008/02/06/apache-logs-how-long-does-it-take-to-serve-a-request/)

最好的问候， linuxaomi

# cvs - Ubuntu 上的 CVS 服务器出错

> ID：798074
> 
> 赞同：0
> 
> 时间：2009-04-28T13:55:13.920
> 
> 标签：cvs

我有一个专用的 Ubuntu 8.04 服务器，我想在它上面设置一个 CVS 存储库。我已按照各种指南尝试进行设置，但总是卡在同一点上。

```
$ cvs -d :pserver:pcm@localhost:/cvsrepo checkout .
cvs [checkout aborted]: could not get working directory: Function not implemented 
```

我有两种不同的方式设置服务器，一种使用 cvs 和 xinetd 来运行服务器，目前我正在尝试 cvs/cvsd 方法。这两种方式我都可以启动服务器并使用本地帐户或 cvs 创建的帐户登录服务器。一旦我尝试签出或导入任何内容，我就会收到错误消息。

在我目前的尝试中，我没有使用本地帐户，而是使用 cvsd 生成的用户名/密码。

我在 CVS 版本 1.12.13 上。

这是跟踪：

```
$ cvs -t -d :pserver:pcm@localhost:/cvsrepo checkout .
-> main: Session ID is cZozIZVrlXzLEMLt
-> main loop with CVSROOT=/cvsrepo
-> safe_location( where=(null) )
-> open_connection_to_server (:pserver:pcm@localhost:/cvsrepo)
-> Connecting to localhost(127.0.0.1):2401.
cvs checkout: warning: unrecognized response `S -> serve_directory (.)' 
from cvs server
cvs checkout: warning: unrecognized response `S -> dirswitch (., /cvsrepo/)' 
from cvs server cvs checkout: warning: unrecognized response `S -> my_module (.,    
Updating, NULL, NULL)' from cvs server cvs checkout: warning: unrecognized response  
`S -> serve_directory (.)' 
from cvs server
cvs checkout: warning: unrecognized response `S -> dirswitch (., /cvsrepo/)' from cvs     
server cvs checkout: warning: unrecognized response `S -> do_cvs_command (checkout)'     from cvs server cvs checkout: warning: unrecognized response `S ->     server_notify()' from cvs server cvs [checkout aborted]: could not get working directory: Function not implemented S -> safe_location( where=(null) ) S -> Lock_Cleanup() S -> Simple_Lock_Cleanup() S -> server_cleanup()
-> close_connection_to_server () 
```

让我知道还需要什么其他信息。我觉得这只是一些被遗漏的小许可问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-30T16:43:02.643

cvs -t -d :pserver:pcm@localhost:/cvsrepo checkout 。代替 。签出模块名称尝试 CVSROOT

```
cvs -t -d :pserver:pcm@localhost:/cvsrepo checkout CVSROOT 
```

应该去你的本地目录

# java - 外键也是主键的一部分

> ID：798095
> 
> 赞同：1
> 
> 时间：2009-04-28T13:58:52.057
> 
> 标签：java, database, jpa

在普通 JPA 或 JPA+Hibernate 扩展中是否可以使用也是复合主键一部分的外键？

```
@TableGenerator(name = "trial", table = "third",
        pkColumnName = "a" , valueColumnName = "b", pkColumnValue = "first")    
@Entity    
public class First{    
@Id
@GeneratedValue(strategy = GenerationType.TABLE, generator = "trial")
protected int a;

@OneToMany(mappedBy ="first", cascade = CascadeType.PERSIST)
@JoinColumn(name = "a")
protected List<Second> seconds;
}

class IDC implements Serializable{
 //@Column(name = "a", insertable = false, updatable = false)
    protected int a;
protected int b;
}

@Entity    
@IdClass(IDC.class)
public class Second{    
    @Id
  //@Column(name = "a", insertable = false, updatable = false)
protected int a;
@Id
protected int b;

    @ManyToOne
@JoinColumn(name = "a"/*, insertable = false, updatable = false*/)
First first;
} 
```

主要的：

```
public class Persister {
public static void main(String[] args) {

First aFirst = new First();

Second aSecond = new Second();
aSecond.b = 300;    
List<Second> scnds = new ArrayList<Second>();
scnds.add(aSecond);

aFirst.seconds = scnds;
aSecond.first = aFirst;

aEntityManager.getTransaction().begin();
aEntityManager.persist(aFirst);
aEntityManager.getTransaction().commit();
}} 
```

问题在“第二”类：

如果我在字段“a”中设置“insertable = false, updatable = false”，则会引发异常：

“参数索引超出范围。4 不在有效值 1 和 3 之间”

如果我在@manyToOne 的关系中设置“insertable = false, updatable = false”，它会运行但在“Second”表的“a”中设置为 0

目标：在Second.a中设置First.a的生成值。

/////////////////////////

创建数据库的sql：

首先创建表（一个int，主键（a））；

创建第二个表（a int，b int，主键（a，b））；

第三个创建表（a varchar（20），b int）；

请帮忙

提前感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T16:35:20.930

首先，你确定你需要吗？...

反正。我可能会在这里显示我的无知，但我认为您可能非常接近，但事情的顺序不是。

读取生成的密钥可以这样完成：

```
...
First first = new First();
entityManager.save(first);  //<- the id is updated

Second second = new Second();
second.setB(300);     
second.setA(first.getA()); 

first.setSeconds( new ArrayList());
first.getSeconds().add(second);
entityManager.save(second);

entityManager.getTransaction().commit(); 
```

你读过这个吗？

[Java 持久性：使用附加列映射连接表](http://en.wikibooks.org/wiki/Java_Persistence/ManyToMany#Mapping_a_Join_Table_with_Additional_Columns)

它不是 JPA，但如果你幸运的话，hibernate 可能支持在同一字段中同时设置 @Id 和 @ManyToOne 标记。你试过吗？那会很好，不是吗:-) ...

```
 @Id  // may not work
 @ManyToOne // may not work
 @JoinColumn(name = "a")
 First a; 
```

哦，那个“a”前缀是什么意思？争论？模糊的 ？矛盾的？企业的东西？

# asp.net - 为什么我不能浏览我的 ASP.NET 网站？

> ID：798096
> 
> 赞同：1
> 
> 时间：2009-04-28T13:58:58.110
> 
> 标签：asp.net

我正在尝试查看我的 ASP.NET 网页，但只有在我未连接到 Internet 时才会显示。没有代理服务器。

我正在使用的地址：

> [http://localhost:50266/IWS/MyWorld.aspx](http://localhost:50266/IWS/MyWorld.aspx)

我收到的消息：

> Internet Explorer 无法显示网页 最可能的原因：您没有连接到 Internet。网站遇到问题。地址可能有输入错误。您可以尝试什么：诊断连接问题
> 
> 更多信息
> 
> 此问题可能由多种问题引起，包括：
> 
> Internet 连接已丢失。该网站暂时不可用。无法访问域名服务器 (DNS)。域名服务器 (DNS) 没有网站域的列表。如果这是 HTTPS（安全）地址，请单击工具，单击 Internet 选项，单击高级，然后检查以确保在安全部分下启用了 SSL 和 TLS 协议。
> 
> 对于离线用户
> 
> 您仍然可以查看订阅的订阅源和一些最近查看的网页。查看订阅的订阅源
> 
> 单击收藏夹中心按钮 ，单击摘要，然后单击要查看的摘要。
> 
> 查看最近访问的网页（可能不适用于所有页面）
> 
> 单击工具，然后单击脱机工作。单击收藏夹中心按钮 ，单击历史记录，然后单击要查看的页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T14:17:42.573

如果您使用的是 IE，请执行以下操作：

工具菜单 -> 选项 -> 高级选项卡 -> “浏览”类别 -> 关闭“显示友好的 HTTP 错误消息”。

关闭浏览器并再次导航到您的页面。可能会有一个 ASP.NET 错误页面等着您（假设您已经`customErrors`关闭）。;-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T14:39:24.207

你有卡西尼号吗？（只是检查）

[http://img149.imageshack.us/img149/2027/casini.jpg http://img149.imageshack.us/img149/2027/casini.jpg](http://img149.imageshack.us/img149/2027/casini.jpg)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T14:01:44.997

在文件菜单上（如果使用 IE 7 或 8，请按 alt 显示菜单）取消选中脱机工作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T14:26:26.233

您可能需要检查您的主机文件和 TCP/IP 设置，以确保您没有一些愚蠢的东西。

主机文件（用记事本打开）：C:\WINDOWS\system32\drivers\etc\hosts

您应该在文件中的某处有此行，并且 localhost 不应与任何其他 IP 地址相关联：

```
127.0.0.1      localhost 
```

它也可能是由于安装了防病毒或 Internet 安全软件而发生的。

另一个建议：使用 Firefox，如果你走这条路，下载并使用 firebug 扩展。

抱歉，我现在想不出更多了，但这些只是我的想法，你描述的问题很令人困惑......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T14:29:07.570

就像其他人说的那样，尝试 127.0.0.1 而不是 localhost。我经常在最近的机器上遇到“localhost”的问题，因为它被解析为 IPv6 地址，客户端可能很高兴，但服务器没有说话。

您可以在 hosts 文件中删除 localhost 的 IPv6 映射。（见红胡子的回复）

# c# - 设计具有可以使用附加属性扩展的实体的应用程序的最佳方法是什么？

> ID：798098
> 
> 赞同：2
> 
> 时间：2009-04-28T13:59:05.190
> 
> 标签：c#, .net, design-patterns, architecture

寻找有关设计应用程序的最佳方式的建议、链接、设计模式等，其中实体和相关屏幕可以通过元数据/无需重新编译，通过其他属性/相关查找进行扩展，最好由最终用户进行。我正在考虑与 Dynamics CRM 4.0 如何与扩展表/动态属性一起使用非常相似的东西。此应用程序将使用 C# .NET 3.5 构建

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T15:05:25.640

您可以通过编写自己的`PropertyDescriptor`实现来做这种事情，或者实现`ICustomTypeDescriptor`（将属性添加到*实例*），或者使用 a `TypeDescriptionProvider`（可以将属性添加到整个*类型*）。

这是实现可扩展/动态属性包实现的常用方法，并且是`DataTable`在幕后使用来公开虚拟属性（on`DataRowView`等）的东西。

然而; 这是很多工作。我已经做了几次，它并不好玩。我想知道您是否应该只使用罐装解决方案？虽然我通常会避免`DataTable`，但这可能是它真正有用的场合之一......只需添加列，然后完成工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T03:22:18.693

我参与过两个项目，一个是电信内容管理系统门户，另一个是身份管理系统。

两者都是产品的定制，并且都支持您所描述的实体扩展。并且都将数据存储为.. XML 字符串！（其中一个在数据库中，另一个在 SVN 中）。

对于搜索，其中一个使用 Lucene，另一个具有用于搜索的名称/值对表，并针对用户定义的一些更常用的“字段”进行了优化，以便与 XML 字符串存储在同一行中。

实体模式都由 XML 配置文件驱动。

作为一个产品，我几乎认为它们是个好主意，允许定制实体以适应不同的场景。但是当我定制它们时，这很简单……很烦人。

我认为最好从最终用户客户的角度来处理这个问题。

1.  鉴于能够随心所欲地扩展实体，谁将是扩展它们的人？程序员？商业用户？
2.  鉴于您已将其范围缩小到谁将进行“定制”，您如何使其成为更愉快的体验？从使用中推动设计。

另外，考虑一下：你真的需要一个 RDBMS，还是像 CouchDB 这样的面向文档的存储？IMO 面向文档的存储似乎是可扩展实体的理想选择。但我没有与他们合作，也没有必要的数据来说明它们是否有用。

只值我的 2 美分。希望能帮助到你。

# c# - 清除透明面板C#的图形

> ID：798105
> 
> 赞同：0
> 
> 时间：2009-04-28T14:00:17.310
> 
> 标签：c#, graphics, panel, transparent

我有一个 WebBrowser 控件，顶部有一个透明面板，我想做的是在透明面板上围绕鼠标悬停的页面中的元素绘制一个矩形。

到目前为止，除了在绘制下一个矩形之前没有清除面板之外，我已经完成了所有工作，所以我最终到处都是矩形。

这是我使用的代码。

```
paneGraphics = drawingPane.CreateGraphics();

Rectangle inspectorRectangle;

inspectorRectangle = controller.inspectElement();

paneGraphics.DrawRectangle(new Pen(Color.Blue, 1), inspectorRectangle);     

drawingPane.Invalidate(); 
```

我试过使用 drawingPane.clear() 但这只会把屏幕变白。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-05-21T17:41:36.933

看看 OpenPandora 项目的[代码](http://www.koders.com/csharp/fid2C72798090DDA250F93CFE98AF1DB6BA6DEB5402.aspx?s=httpwebrequest)

```
public class TransparentPanel : Panel
{
    Timer Wriggler = new Timer();

    public TransparentPanel()
    {
        Wriggler.Tick += new EventHandler(TickHandler);
        this.Wriggler.Interval = 500;
        this.Wriggler.Enabled = true;
    }

    protected void TickHandler(object sender, EventArgs e)
    {
        this.InvalidateEx();
    }

    protected override CreateParams CreateParams
    {
        get
        {
            CreateParams cp = base.CreateParams;

            cp.ExStyle |= 0x00000020; //WS_EX_TRANSPARENT 

            return cp;
        }
    }

    protected void InvalidateEx()
    {
        if (Parent == null)
        {
            return;
        }

        Rectangle rc = new Rectangle(this.Location, this.Size);

        Parent.Invalidate(rc, true);
    }

    protected override void OnPaintBackground(PaintEventArgs pevent)
    {
        // Do not allow the background to be painted  
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T17:39:22.620

你试过了吗：

```
graphics.Clear(Color.Transparent); 
```

# django - 如何 JSON 序列化 Python 字典？

> ID：798111
> 
> 赞同：47
> 
> 时间：2009-04-28T14:01:13.750
> 
> 标签：django, json, serialization

我正在尝试为 JSON 序列化某些内容并将其返回到一个`HttpResponse`对象中创建一个 Django 函数。

```
def json_response(something):
    data = serializers.serialize("json", something)
    return HttpResponse(data) 
```

我这样使用它：

```
return json_response({ howdy : True }) 
```

但我得到这个错误：

```
"bool" object has no attribute "_meta" 
```

有任何想法吗？

编辑：这是回溯：

[http://dpaste.com/38786/](http://dpaste.com/38786/)

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-04-28T14:18:46.330

更新：Python 现在有自己的 json 处理程序，只需使用`import json`而不是使用`simplejson`.

* * *

Django 序列化程序模块旨在序列化 Django ORM 对象。如果你想编码一个普通的 Python 字典，你应该使用 simplejson，它是 Django 附带的，以防你还没有安装它。

```
import json

def json_response(something):
    return HttpResponse(json.dumps(something)) 
```

我建议将它与 application/javascript Content-Type 标头一起发送回来（您也可以使用 application/json 但这会阻止您在浏览器中进行调试）：

```
import json

def json_response(something):
    return HttpResponse(
        json.dumps(something),
        content_type = 'application/javascript; charset=utf8'
    ) 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-04-29T11:54:23.813

扩展**HttpResponse的****JsonResponse** *类*怎么样：

 **```
from django.http import HttpResponse
from django.utils import simplejson

class JsonResponse(HttpResponse):
    def __init__(self, data):
        content = simplejson.dumps(data,
                                   indent=2,
                                   ensure_ascii=False)
        super(JsonResponse, self).__init__(content=content,
                                           mimetype='application/json; charset=utf8') 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2017-01-04T15:05:21.170

使用较新版本的 Django，您可以只使用 django.http 提供的 JsonResponse：

```
from django.http import JsonResponse

def my_view(request):
    json_object = {'howdy': True}
    return JsonResponse(json_object) 
```

[您可以在官方文档](https://docs.djangoproject.com/en/1.10/ref/request-response/#jsonresponse-objects)中找到更多详细信息。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-02-06T10:43:21.157

在 python 2.6 及更高版本中，有一个不错的[JSON 库](http://docs.python.org/2/library/json.html)，它有许多函数，其中[json.dumps()](http://docs.python.org/2/library/json.html#json.dumps)将对象序列化为字符串。

所以你可以做这样的事情：

```
import json
print json.dumps({'howdy' : True }) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-04-04T08:42:41.570

```
import json

my_list = range(1,10) # a list from 1 to 10

with open('theJsonFile.json', 'w') as file_descriptor:

         json.dump(my_list, file_descriptor) #dump not dumps, dumps = dump-string 
```

# c# - 比较 2 个自定义对象 - C#

> ID：798117
> 
> 赞同：6
> 
> 时间：2009-04-28T14:02:44.027
> 
> 标签：c#, .net

我需要在基类中编写一个通用方法，该方法将接受 2 个对象作为参数并比较它们是否相等。

前任：

```
public abstract class BaseData
{

  public bool AreEqual(object O1, object O2)
  {
    //Need to implement this
  }
}

public class DataTypeOne : BaseData
{
  public string Name;
  public string Address;
}

public class DataTypeTwo : BaseData
{
  public int CustId;
  public string CustName;
} 
```

该`AreEqual()`方法将接受 2 个实例`DataTypeOne`或 2 个`DataTypeTwo`.

我的猜测是我需要使用反射？如果 LINQ 更易读/更简洁，我可以使用它。

**编辑：我想在基类中实现这个方法的原因是项目限制。有大量开发人员致力于派生类。通过在基类中实现这一点，我试图让他们担心的事情少了 1 件。**

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-28T14:06:07.997

（假设您想要比较两个对象的所有字段是否相等。）

通常，您不会为此烦恼使用反射，您只需自己比较每个字段。该`IEquatable<T>`接口是为此目的而存在的，您可能还希望覆盖`Object.Equals()`相关类型。例如：

```
public class DataTypeTwo : BaseData, IEquatable<DataTypeTwo>
{
    public int CustId;
    public string CustName;

    public override int GetHashCode()
    {
        return CustId ^ CustName.GetHashCode(); // or whatever
    }

    public override bool Equals(object other)
    {
        return this.Equals(other as DataTypeTwo);
    }

    public bool Equals(DataTypeTwo other)
    {
        return (other != null &&
                other.CustId == this.CustId &&
                other.CustName == this.CustName);
    }
} 
```

另外，请考虑您的类型是否有意义`struct`。值类型通过逐字段比较来自动比较相等性。

请注意，通过覆盖`Equals`，您基本上实现了（在我看来）您试图通过“主等于方法”方案实现的目标。也就是说，使用的人`DataTypeTwo`将能够自然地测试相等性，而无需了解有关您的 API 的任何特殊信息——他们将`Equals`像对待其他事物一样使用它们。

编辑：感谢 Jared 提醒我关于`GetHashCode`. 您还需要通过确保任何两个“相等”的对象也返回相同的哈希码来覆盖它以保持哈希表中的正常行为。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-28T14:51:48.123

这是我想出的使用反射的方法。希望能帮助到你。

```
public bool AreEqual(object obj)
    {
        bool returnVal = true;

        if (this.GetType() == obj.GetType())
        {
            FieldInfo[] fields = this.GetType().GetFields(BindingFlags.Instance | BindingFlags.NonPublic | BindingFlags.Public);

            foreach (FieldInfo field in fields)
            {
                if(field.GetValue(this) != field.GetValue(obj))
                {
                    returnVal = false;
                    break;
                }
            }
        }
        else
            returnVal = false;

        return returnVal;
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-28T15:01:14.620

不要这样做。继承是要走的路，每个类都应该在需要的地方覆盖 Equal 和 GetHashCode。

**也许您现在可以从这些开发人员那里完成一些工作，但是当将来需要维护产品**时，我会回来咬您的屁股。

说真的，只是尝试找到另一种帮助方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T14:14:04.860

我可能会做这样的事情：

```
public abstract class BaseData : IEquatable<BaseData>
{
    public abstract bool Equals(BaseData other);
}

public class DataTypeOne : BaseData
{
    public string Name;
    public string Address;

    public override bool Equals(BaseData other)
    {
        var o = other as DataTypeOne;
        if(o == null)
            return false;
        return Name.Equals(o.Name) && Address.Equals(o.Address);
    }
}

public class DataTypeTwo : BaseData
{
    public int CustId;
    public string CustName;

    public override bool Equals(BaseData other)
    {
        var o = other as DataTypeTwo;
        if (o == null)
            return false;
        return CustId == o.CustId && CustName.Equals(o.CustName);
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T14:06:18.730

是的，您将不得不使用反射，因为基类对派生类一无所知。但是为什么要在基类中实现那个功能呢？为什么不在派生类中？

此外，还有一种标准方法可以通过覆盖 Object.GetHashCode() 和 Object.Equals() 来做到这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-12T12:53:20.973

```
public void CompareTwoObjects()
{
    try {   
        byte[] btArray = ObjectToByteArray(object1);   //object1 is you custom object1
        byte[] btArray2 = ObjectToByteArray(object2); //object2 is you custom object2
        bool result = ByteArrayCompare(btArray, btArray2);
    } catch (Exception ex) {
        throw ex;
    }
}

public byte[] ObjectToByteArray(object _Object)
{
    try {
        // create new memory stream
        System.IO.MemoryStream _MemoryStream = new System.IO.MemoryStream();

        // create new BinaryFormatter
        System.Runtime.Serialization.Formatters.Binary.BinaryFormatter _BinaryFormatter
            = new System.Runtime.Serialization.Formatters.Binary.BinaryFormatter();

        // Serializes an object, or graph of connected objects, to the given stream.
        _BinaryFormatter.Serialize(_MemoryStream, _Object);

        // convert stream to byte array and return
        return _MemoryStream.ToArray();
    } catch (Exception _Exception) {
        // Error
        Console.WriteLine("Exception caught in process: {0}", _Exception.ToString());
    }

    // Error occured, return null
    return null;
}

public bool ByteArrayCompare(byte[] a1, byte[] a2)
{
    if (a1.Length != a2.Length)
        return false;

    for (int i = 0; i < a1.Length; i++)
        if (a1[i] != a2[i])
            return false;

    return true;
} 
```

# java - 如何从 displaytag 中的 struts2 复选框获取复选框值到操作类

> ID：798118
> 
> 赞同：1
> 
> 时间：2009-04-28T14:03:01.407
> 
> 标签：java, struts2, displaytag

我正在研究**struts2**应用程序，其中我使用**displaytag**来支持分页。

现在我想要表中每一行的复选框，因为我正在这样做。

```
<display:table name="countryList" export="true" class="table" id="countryList" pagesize="${selectedPageSize}" decorator="org.displaytag.decorator.TotalTableDecorator" >        
    <display:column property="id"  title="ID" paramId="id" />
    <display:column property="name" title="Name"  sortable="true"/>
    <display:column title="Delete All">
        <s:checkbox  id="check" name="check" fieldValue="%{#attr.countryList.id}" theme="simple"/>
    </display:column>
</display:table>  

<s:submit action="deleteall"  value="DeleteSelected" /> 
```

直到这里它的工作正常。现在我想删除通过复选框选中的所有国家。

为此，我想要检查的国家/地区的 ID。为此，我必须获取数组中的值。

问题是我如何从 jsp 发送值，然后在动作类中获取它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T14:44:29.310

如果您将 String[] 添加到与您的复选框名称相同的操作中并通过访问器（getter/setter）公开它，struts 2 应该自动填充它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T14:42:17.863

我就是这样做的。

1.  代替所有 id 列的“id”，附加一个序列号，以便每个 id 具有唯一的名称，例如“id1”、“id2”等

2.  创建一个拦截器，收集以“id”为前缀的参数值

3.  配置您的操作以使用拦截器

不过，我的支柱 fu 生锈了。可能有更好的方法。

# asp.net - 显示图片的列表视图

> ID：798119
> 
> 赞同：0
> 
> 时间：2009-04-28T14:04:22.060
> 
> 标签：asp.net, vb.net, listview

我正在使用 ListView 控件来显示图片以及描述和标题。我曾经将图像的完整路径保存在 url 字段中，因此当我在 ListView 中显示它们时，我不需要编辑任何内容。现在我正在使用类似的东西：

```
HttpContext.Current.Server.MapPath("~/photos/") + savedURL 
```

如何编辑我的 ListView 以使其显示图像？

在 GridViews RowDataBound 事件中，我曾经对 GridView 做同样的事情，我操作如下内容：

```
Dim photo As New Image
        photo.ImageUrl = "~/photos/" + e.Row.Cells(TheCellNumber).Text
        e.Row.Cells(0).Controls.Clear()
        e.Row.Cells(0).Controls.Add(photo) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T15:37:18.230

为什么不直接在 ItemTemplate 中使用 Image 控件：

```
<asp:ListView ID="ListView1" runat="server" DataKeyNames="pictureId">
    <ItemTemplate>
        <asp:Image
        id="pictureControlID" runat="server" AlternateText='<% #Eval("pictureName") %>'
        ImageUrl='<%# "~/photos/" + Eval("picturePath") %>' />
    </ItemTemplate>
</asp:ListView> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T14:09:34.697

你有没有尝试过

```
ResolveUrl("~/photos/") + savedURL; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T15:32:45.607

您是否考虑过使用中继器并将中继器的模板设置为完全按照您的需要显示？您是否有任何特定原因想要在中继器上使用 ListView？

# c# - 日期与日期时间

> ID：798121
> 
> 赞同：126
> 
> 时间：2009-04-28T14:05:03.930
> 
> 标签：c#, .net, asp.net

我正在开发一个需要返回事件日期的程序。

我正在寻找一个`Date`，而不是一个`DateTime`。

是否有只返回日期的数据类型？

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2009-04-28T14:07:33.393

不，没有。`DateTime`表示由日期和时间组成的某个时间点。但是，您可以通过属性检索日期部分[`Date`](http://msdn.microsoft.com/en-us/library/system.datetime.date.aspx)（这是另一个`DateTime`时间设置为`00:00:00`）。

[`Day`](http://msdn.microsoft.com/en-us/library/system.datetime.day.aspx)您可以通过、[`Month`](http://msdn.microsoft.com/en-us/library/system.datetime.month.aspx)和检索单个日期属性[`Year`](http://msdn.microsoft.com/en-us/library/system.datetime.year.aspx)。

**更新**：在 .NET 6[中引入](https://devblogs.microsoft.com/dotnet/date-time-and-time-zone-enhancements-in-net-6/#introducing-the-dateonly-and-timeonly-types)`DateOnly`的类型和仅表示日期或时间。`TimeOnly`

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-09-23T15:43:55.560

当您需要一个简单的日期而不用担心时间部分、时区、本地与 UTC 等时，我创建了一个简单的[Date 结构。](https://github.com/claycephus/csharp-date)

```
Date today = Date.Today;
Date yesterday = Date.Today.AddDays(-1);
Date independenceDay = Date.Parse("2013-07-04");

independenceDay.ToLongString();    // "Thursday, July 4, 2013"
independenceDay.ToShortString();   // "7/4/2013"
independenceDay.ToString();        // "7/4/2013"
independenceDay.ToString("s");     // "2013-07-04"
int july = independenceDay.Month;  // 7 
```

[https://github.com/claycephus/csharp-date](https://github.com/claycephus/csharp-date)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-04-28T14:06:47.233

不幸的是，不在 .Net BCL 中。日期通常表示为时间设置为午夜的 DateTime 对象。

正如您可以猜到的，这意味着您有所有随之而来的时区问题，即使对于 Date 对象，您绝对不需要时区处理。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-04-28T15:10:20.760

创建一个包装类。像这样的东西：

```
public class Date:IEquatable<Date>,IEquatable<DateTime>
    {
        public Date(DateTime date)
        {
            value = date.Date;
        }

        public bool Equals(Date other)
        {
            return other != null && value.Equals(other.value);
        }

        public bool Equals(DateTime other)
        {
            return value.Equals(other);
        }

        public override string ToString()
        {
            return value.ToString();
        }
        public static implicit operator DateTime(Date date)
        {
            return date.value;
        }
        public static explicit operator Date(DateTime dateTime)
        {
            return new Date(dateTime);
        }

        private DateTime value;
    } 
```

并暴露`value`你想要的任何东西。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-28T14:08:32.220

Date 类型只是 VB.NET 使用的 DateTime 类型的别名（就像 int 变成 Integer）。这两种类型都有一个 Date 属性，该属性返回时间部分设置为 00:00:00 的对象。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-28T14:09:24.730

DateTime 有一个[Date](http://msdn.microsoft.com/en-us/library/system.datetime.date.aspx)属性，您可以使用它来隔离日期部分。[ToString](http://msdn.microsoft.com/en-us/library/system.datetime.tostring.aspx)方法还可以很好地仅在时间部分为空时显示日期部分。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-28T14:15:15.060

DateTime 对象有一个属性，它只返回值的日期部分。

```
 public static void Main()
{
    System.DateTime _Now = DateAndTime.Now;
    Console.WriteLine("The Date and Time is " + _Now);
    //will return the date and time
    Console.WriteLine("The Date Only is " + _Now.Date);
    //will return only the date
    Console.Write("Press any key to continue . . . ");
    Console.ReadKey(true);
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-05-02T12:18:51.400

没有数据`Date`类型。

但是，您可以使用`DateTime.Date`仅获取日期。

**例如**

```
DateTime date = DateTime.Now.Date; 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-28T14:06:41.727

您可以返回时间部分为 00:00:00 的 DateTime 并忽略它。日期作为时间戳整数处理，因此将日期与时间结合起来是有意义的，因为它无论如何都存在于整数中。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-28T14:09:50.063

为此，您需要使用日期，但忽略时间值。

通常，日期将是 DateTime，时间为`00:00:00`

该`DateTime`类型有一个`.Date`属性，该属性返回`DateTime`具有如上设置的时间值的 。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-08-05T09:57:06.987

.NET 6 似乎终于引入了仅日期类型。它将被调用`DateOnly`，并且还将有一个`TimeOnly`类型添加到`System`命名空间中的 BCL。

它已在预览版 4 中可用。阅读[此博客文章](https://devblogs.microsoft.com/dotnet/date-time-and-time-zone-enhancements-in-net-6/)了解更多详细信息。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-28T14:08:19.130

您可以尝试以下方法之一：

```
DateTime.Now.ToLongDateString();
DateTime.Now.ToShortDateString(); 
```

但是 BCL 中没有“日期”类型。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-12-16T18:53:44.013

```
public class AsOfdates
{
    public string DisplayDate { get; set; }
    private DateTime TheDate;
    public DateTime DateValue 
    {
        get 
        { 
            return TheDate.Date; 
        } 

        set 
        { 
            TheDate = value; 
        } 
    }    
} 
```

# vb.net - 如何在 VB.NET 中删除两个数字之间的冒号？

> ID：798122
> 
> 赞同：2
> 
> 时间：2009-04-28T14:05:33.757
> 
> 标签：vb.net

我有这样格式的文本：

> 术语：156:59 数据输入

我想删除数字之间的“：”，然后用其他东西替换它，这样文本就可以变成：

> 术语：156-59 数据输入

如何在 VB.NET 中做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-28T14:22:36.680

在 VB.NET（信用 Jonathan）中：

```
 Dim text As String = "term: 156:59 datainput"
    Dim fixedText As String = Regex.Replace(text, "(\d+):(\d+)", "$1-$2") 
```

注意：按照建议删除了最后两行。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-28T14:14:20.303

是的，我知道这有点笨拙，但它应该可以工作（假设您的数据完全符合您指定的格式）：

```
input[input.IndexOf(":", input.IndexOf(":")+1)] = "#" 
```

当然，如果您想要更一般的情况来查找 NUMBER:NUMBER 并将其替换为 NUMBER#NUMBER，我建议使用正则表达式，如下所示：

```
var re = new Regex(@"(\d+):(\d+)");
re.Replace(input, "$1#$2"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T14:13:36.560

假设您已将数据读入字符串，请查看 string.replace 函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T00:33:11.863

您也可以使用字符串替换来做到这一点

Dim data As String = "term: 156:59 datainput"

data = data.Replace(":", "-").Replace("term-", "term:")

# asp.net-mvc - 自定义 IModelBinder 和数据库访问

> ID：798124
> 
> 赞同：1
> 
> 时间：2009-04-28T14:05:55.300
> 
> 标签：asp.net-mvc, model-binding, imodelbinder

对于我的 asp.net mvc 项目中的用户对象，我编写了一个自定义模型绑定器来检查密码是否有效以及是否输入了两个匹配的密码等。

登录名需要是唯一的，我想知道我是否可以在模型绑定器中检查它，或者这被认为是不好的做法？

问题是在你到达控制器之前就调用了绑定器，所以我会有两个我的 dataContext 实例浮动，因此有多个到数据库的连接，我想我可以为此建立一个工厂。

这是我现在在控制器中所做的代码片段：

```
// POST: /Users/Create
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Create(Users user)
{            
    myDataContext db = new myDataContext();

    if (!ViewData.ModelState.IsValid)
    {                
        return View(user);
    }            

    Users testUser = db.Users.SingleOrDefault(p => p.LoginNaam == user.LoginNaam);
    if (testUser != null) { //Error stuff here }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T14:29:31.780

我不会检查模型活页夹中的用户名可用性。我认为`CreateUser`在这种情况下，方法的工作就是这样做。

所以动作会是这样的：

```
// POST: /Users/Create
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Create(Users user)
{            
    myDataContext db = new myDataContext();

    if (!ViewData.ModelState.IsValid)
    {                
        return View(user);
    }

    try {
        db.CreateUser(User);
    }
    catch (ArgumentException e) {
        ModelState.AddModelError(e.ParamName, e.Message);
        return View(user);
    }
    return View("UserCreated", user)
} 
```

# c# - 更复杂的（现实生活）模型绑定？

> ID：798127
> 
> 赞同：3
> 
> 时间：2009-04-28T14:06:16.033
> 
> 标签：c#, .net, asp.net-mvc, model-binding

和我一起滚动并想象以下示例：

```
Public ViewResult GiveMeFruit(int personId, string personName, int personAge, int fruitId){
    Person person = PersonService.GetPerson(personId);
    person.Name = personName;
    person.Age = age;
    person.Fruits.Add(FruitService.GetFruit(fruitId));
    ViewData.Person = person;
    View(ViewData);
} 
```

这应该像这样做得更好

```
Public ViewResult GiveMeFruit(Person person, IFruit fruit){
    person.Fruits.Add(fruit);
    ViewData.Person = person;
    View(ViewData);
} 
```

我之前尝试过正确的模型绑定，但我无法让它正常工作。所有示例都向您展示了它如何与一种极其简单的类型一起工作，而不是多种复杂类型。modelbinder 如何知道什么字段对应什么类型？如果有一个fruit1和一个fruit2怎么办？活页夹如何知道我的 IFruit 界面使用什么具体类型？此外，我想知道如果我想给我的 Person 一个 IEnumerable 水果，它会如何工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T14:17:48.687

我相信它应该是这样的：

```
<input type="text" name="person.Name" value="" />
<input type="text" name="person.Age" value="" />
<input type="text" name="fruit.Property1" value="" />
<input type="text" name="fruit.Property2" value="" /> 
```

对于收藏：

```
<input type="text" name="fruit[0].Property1" value="" />
<input type="text" name="fruit[0].Property2" value="" />
<input type="text" name="fruit[1].Property1" value="" />
<input type="text" name="fruit[1].Property2" value="" /> 
```

就像在[这个问题](https://stackoverflow.com/questions/711184/asp-net-mvc-example-of-editing-multiple-child-records/712817#712817)中一样。

# c# - 在没有活动窗体实例的情况下调用 Windows 窗体的方法

> ID：798140
> 
> 赞同：0
> 
> 时间：2009-04-28T14:08:12.767
> 
> 标签：c#, winforms, optimization

我正在使用 VS2005 在 C# 中开发一个 Windows 应用程序。考虑我需要从另一个类（Class2）调用一个类（Class1）中的非静态方法（Method1）。为了调用该方法，我需要为该类创建对象。

但我的班级“Class1”有超过 1000 个变量。所以每次我为“Class1”创建对象时，所有变量都会被实例化，但我的方法“Method1”使用的变量很少。所以不必要地所有其他变量都被实例化了。

我如何优化此代码，因为它在实例化必须调用的特定方法不需要的变量时开销很大。？

还是有任何其他编码标准可以用来克服这个问题。？提前致谢。

这是我的变量列表。编辑：

```
 private string m_sPath = String.Empty;
        private string m_sModule = String.Empty;
        private string m_sType = String.Empty;

        public static string strFileSave;
        private string fileName = "", strFactoryXML = "", strPriorityXml = "", strTempXml = "";
        private string selMethod = "";
        private string selClass = "";
        private string selMethodName = "";
        private string str, str1, str2;
        public static string strFolder;
        public static string strFilePath = "";
        public static string sel1, sel2;
        private string strSetPrFileName = "";
        private string results;
        private string strClassCompare, strMethodCompare, strTestResultCompare;
        public static string CurrWorkingDirectory = Environment.CurrentDirectory;
        private System.Threading.ThreadStart m_CummulativeTimeThreadStart = null;
        private System.Threading.Thread m_CummulativeTimeThread;
        private string[] OuterDelim = null;
        private string[] InnerDelim = null;
        public static ArrayList alObjectsNotDefined;
        public static ArrayList alSystemObjUnDefined = null;
        public static string objFileName = "";
        public static string XmlFileName = "";
        //Integers
        private int nMethodCount, index = 0;
        private static int nClearFlag, nExp = 0, cell;
        public static int flag;
        private static int nMemberCount, nPrevMemberCount;
        private static int classIndex, methodIndex;
        private static int[,] arrIndex = new int[100, 100];
        private int indexThread;
        private int bFlag = 0;
        //private int nIndexClass=0,nIndexMethod=0;
        frmCreateProject cp = new frmCreateProject();

        //Boolean
        private bool crFlag = false, tvAfter = true;
        private bool bSetPriority = false;
        private bool bFilter = false;

        private bool bCr = false;
        private bool snapShotFlag = false, factoryFlag = false, tvSel = false;
        private bool bResultsFlag = false, bSummaryFlag = false;
        public static bool bClick = true, rightMouse = false;
        private bool dataError = false;
        private bool bClassFilter = false, bMethodFilter = false;//,bTestResultFilter=false;
        private bool tvFact = false;
        //private bool bAssignFactory=false;
        //private bool factoryChanges=false;
        private bool bEntered = false;
        public static bool bAssign = false;
        private bool bChangeMethFactory = false;
        private bool bExecution = false;

                public bool bModule = false;
        public bool bClass = false;
        public bool bMethod = false;

        public bool bAssemLoaded = false;         public bool bLoadClicked = false;         public static bool bAssignCustom = false;
        public static string strPath;
        //  public static  int intRowCount;
        public bool bTestGen = false;
        //Others
        private Module[] mdls = null;
        private Assembly oAssembly;
        private DataTable dtSnapshot;
        private DataTable dtFactory;
        private DataTable dtFactoryGV        private DataTable dtExceptions = new DataTable();
        private DataTable dtResults = new DataTable();
        private DataTable dtSummary = new DataTable();
        private DataRow dr;
        private DataRow drGV;
        private DataColumn dc, dc1;
        private DataColumn dcGV;
        private Type m_Type;
        private Type[] types = new Type[100];
        private XmlDocument doc = new XmlDocument();
        //private XmlDocument docTemp=new XmlDocument();
        private DataGridTextBoxColumn TextCol;
        private DataGridTextBoxColumn TextColGV;
        private object[] arguments = new object[20];
        public static bool bSupport = false;
        DataGridTableStyle ts1 = null;
        DataGridTableStyle ts2 = null        DateTime gridMouseDownTime;
        XmlElement gridElement = null;
        XmlNodeList gridList = null, gridCustom = null;

        public string testAssem;

        public string strXmlTestCase;
        public string Gen_dll_path;
        public static string curClass = "";

        public static string curMethod = "";
        public static string curTestResult = "";

        public static bool comdll = false;

        public static bool bIncludeNullValue;
        public static string strMainExcep;

        public static string cmbFactoryClassSel = "";
        public static string cmbFactoryMethodSel = "";
        public static string dataGridParameter = "";
        private static string strReferredTable = "";

        public static string strExePath = ""; 
        public static string strProjPath = "";
        public static string strFactoryType = "";
        public static string strParameterName = "", strParameterType = "";
        public static string checkFactoryClass = "";
        public static string strFileXml = "";
        public static bool bEdit = false;
        public static bool bNumArr = false;
        public string checkType = "";
        public static bool bThread = true;
        public static bool bObjectsDefined = false;
        public static bool bSystemObjDefined = false;
        public static string cmbFactoryNewMethodSel = "";

        public static bool editAuto = false;
        private System.Windows.Forms.MainMenu mainMenu1;
        private System.Windows.Forms.MenuItem mnuFile;
        public System.Windows.Forms.MenuItem mnuTest;        private System.Windows.Forms.MenuItem mnuExit;
        private System.Windows.Forms.MenuItem mnuHelp;
        private System.Windows.Forms.MenuItem mnuAbout;
        public System.Windows.Forms.ToolBar toolBar1;        private System.Windows.Forms.TabControl tcResults;
        private System.Windows.Forms.TabPage tpSummary;
        private System.Windows.Forms.TabPage tpExceptions;
        private System.Windows.Forms.DataGrid dataGridSummary;
        private System.Windows.Forms.RichTextBox rtbOutput;
        private System.Windows.Forms.DataGrid dataGridExceptions;
        private System.Windows.Forms.Splitter splitterDown;
        private System.Windows.Forms.Splitter splitterTV;
        private System.Windows.Forms.OpenFileDialog openFileDialog1;
        private System.Windows.Forms.ImageList imageList1;
        private System.Windows.Forms.ToolBarButton toolBarOpen;
        private System.Windows.Forms.ToolBarButton toolBarTest;
        private System.Windows.Forms.Panel panelResults;
        private System.Windows.Forms.TabPage tpProblems;
        private System.Windows.Forms.RichTextBox rtbProblems;
        private System.Windows.Forms.MenuItem mnuCreateProject;
        private System.Windows.Forms.MenuItem mnuOpenProject;
        private System.Windows.Forms.ToolBarButton toolBarNew;
        private System.Windows.Forms.PictureBox pictureBox1;
        protected System.Windows.Forms.ContextMenu contextMenuTest;
        private System.Windows.Forms.ToolTip toolTip1;
        private System.Windows.Forms.MenuItem mnuAssignFactory;
        private System.Windows.Forms.ContextMenu contextMenuFactory;
        private System.Windows.Forms.MenuItem mnuViewAutoFactory;
        private System.Windows.Forms.ContextMenu contextMenu1;
        private System.Windows.Forms.MenuItem mnuEditCustomFactory;
        private System.Windows.Forms.MenuItem mnuDeleteCustomFactory;
        private System.Windows.Forms.ToolBarButton toolBarPriority;
        private System.Windows.Forms.MenuItem mnuSetPriority;
        private System.Windows.Forms.ContextMenu contextMenuResults;
        private System.Windows.Forms.MenuItem mnuPerformance;
        private System.ComponentModel.IContainer components;

        public static System.Windows.Forms.TreeView tempTV        public static string classNameGV;
        public string strAppPath = "";
        public string strTempPath = "";
        public bool bDllExists;
        public string smTemp1 = "";
        public string strTestFolder = "";
        public static bool bReloadNewDll = false;
        private string dllUnderTest = "";
        private System.Threading.ThreadStart m_UpdateDBTimeThreadStart = null;
        private System.Threading.Thread m_UpdateDBTimeThread;
        private TabPage tabPage2;
        private TreeView tvTestAssemb;
        private TabPage tabPage1;
        private TreeView tv;
        private TabControl tabControl1;
        public static string Output;
        private MenuItem menuItem3;
        private MenuItem menuItem4;
        private MenuItem menuItem5;
        private MenuItem menuItem1;
        private MenuItem menuItem2;
        private TabPage tpTestGen;
        public StatusBar statusBar1;
        private TextBox txtTestGen;
        private TabPage tpTestCaseTable;
        private DataGrid dataGrid2;
        private Panel panel1;
        private Button btnGenerate;
        private Button btnSave;
        private Button btnTestCase;
        private Label label5;
        private ComboBox cmbTestCase;
        private DataGrid dataGrid1;
        private TabPage tpGlobalVariable;
        public DataGrid dataGridFactoryGV;
        private Panel panelGlobalVariable;
        private ComboBox cmbMethodNameGV;
        private Label label2;
        private Label label1;
        private ComboBox cmbClassNameGV;
        private TabPage tpFactorySettings;
        private Panel panelFactory;
        public DataGrid dataGridFactory;
        private Panel panelClassDetails;
        private Label lblClassName;
        private ComboBox cmbClassName;
        private Label lblMethodName;
        private ComboBox cmbMethodName;
        private TabPage tpSnapshot;
        private Panel panelUpdateMsg;
        private PictureBox pictureBox2;
        private Label label4;
        private DataGrid datagridSnapshot;
        public TabControl tcSnapshot;
        public StatusBar statBar;

        public ArrayList alMultiLevelTableName = new ArrayList();

        public ArrayList alExpRes;        
public ArrayList alParVal; 
        public ArrayList alTestCaseID        
public ArrayList alClassName;
        private MenuItem menuItem6        
public ArrayList alMethSig;
        public ArrayList alComments; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-28T14:12:46.500

很难说可以做些什么来解决这个特殊问题。*但是，可以*说，拥有如此庞大的课程绝对是一种代码[味道](http://en.wikipedia.org/wiki/Code_smell)。尝试重构您的类，以便操作方法所需的类`Class2`具有更“合理”的大小。

**编辑**圣牛！您显然是在尝试在 -`Form`派生类上调用方法。将所需的逻辑移至第三类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T14:16:20.313

一个设计良好的类需要 1000 多个变量是非常罕见的。所以听起来好像是的设计有问题`Class1`。如果您需要调用该非静态方法，则需要实例化该类，并且无法绕过性能损失。所以，如果可以的话，你需要重构。

你可以：

*   分成`Class1`更小的班级，这些班级更专注于一项工作。
*   您可以重构您需要调用的方法，因此它不需要类的实例化（可能因为它对类数据的使用不多）。

祝你好运。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T14:13:58.790

听起来您需要重新考虑一下您的实现。如果您有一个包含 1000 个变量的类，其中任何给定的实例只使用这些变量的一小部分，那么使用某种属性包会更好。

```
public class C1 {
  private Dictionary<string,object> m_bag = new Dictionary<string,object>();
  public string Name {
    get { return (string)m_bag["Name"]; }
    set { m_bag["Name"] = value; }
  }
  ...
} 
```

否则，您必须为每个变量声明一个字段。如果您只为每个对象使用其中的几个字段，那么您的程序中将会产生大量的浪费。这个示例很浪费，因为它使用了后备存储，但几乎可以肯定，它比使用 1000 个字段类中的少量字段更不浪费。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T14:20:40.130

当他们说单个类中的 1000 个变量是一种代码味道并暗示要拆分类时，每个人都非常好。老实说，它远比这更糟糕。

一个类中有 1000 个变量是站不住脚的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-28T15:10:56.050

让我们先假设您的对象类设计得很好，而且必须很大，并且可以解决手头的问题。如果您正在创建 Class1 的实例来调用一种方法且仅调用一种方法，那么逻辑可能属于其他地方。

该方法是否完全改变了 Class1 的成员？您是否正在阅读 Class1 的属性以获取输出？一旦你得到输出，Class1 的实例就完成了吗？

如果这些问题的答案是肯定的，那么这个方法可能根本不属于 Class1。尝试重新设计该方法，以便在逻辑中仅使用传递的参数，并且返回值是唯一的输出。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-28T14:12:55.860

我不知道“Class1”的具体用途，但如果某个类有超过 1000 个变量，它就不会“闻起来”好。看来，有一些设计问题。

但是，您可以查看“单例”和“IOC 容器”设计模式，可能会有所帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-28T14:13:01.303

我建议将您的班级分开，单个班级中> 1000个变量可能是该班级做得太多的代码味道？

如果您将 Method1 所需的变量拆分为一个单独的类，这可能会使生活变得更简单。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-28T14:13:05.110

Class1有1000多个变量？仅此一项就暗示您在课程中存在一些设计问题。此外，如果您经常需要一个只使用类的一部分的类的实例，那么您当然应该能够将类分解成更小的部分。

Class1背后的想法是什么？它试图达到什么目的？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-28T14:15:35.103

我建议阅读更多关于[单一职责原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)(SRP) 的信息。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-28T14:37:14.617

我的整个 IronScheme 系统有 452 个静态只读字段。然后是另外 2000 个其他静态字段（用于盒装符号和全局引用）。

仍然只需要 100 毫秒即可加载。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-28T14:56:12.823

开始拆分此类的一种方法是查看在哪些方法中使用了哪些字段。

如上所述，您会很快看到并非所有方法都使用类中的所有字段。这表明你的班级缺乏内部凝聚力。您要做的是将此类重构为几个内部更具凝聚力的类。

因此，寻找在相同字段上运行的函数集群。这些集群是想要摆脱您在这里拥有的超级类的较小类。当您将这些方法集群和它们使用的字段移动到各自的类中时，会为集群所代表的概念寻找富有表现力的名称。

许多生成的类本身就很有用（并且可以自己测试）。剩余的原始类最终可能会使用许多这些新创建的类来执行它提供的功能。

请注意，这不是一个完全机械的过程，而是一种启发式方法，可以为您清理这些烂摊子提供一个良好的开端。

# c# - 收到有关 IIS 重置的通知？

> ID：798159
> 
> 赞同：2
> 
> 时间：2009-04-28T14:11:24.757
> 
> 标签：c#, iis, windows-services

我们有一个带有 Web 应用程序和一堆 Windows 服务的系统，这些服务在做一些后台工作。

每当我们需要对系统进行更实质性的更改时，我们最终不得不发出 IIS 重置，然后手动重新启动所有相关的 Windows 服务。

有没有办法在 C# 代码中通知此类 IISReset 事件，以便我们的 Windows 服务可以在检测到正在执行的此类 IISReset 命令时自行重启？

谢谢！马克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T14:14:48.430

难道你不能只写一个批处理文件来调用 IIS 重置然后重新启动 Windows 服务吗？

我认为启动 Windows 服务的方法是：

```
NET START "SERVICE NAME" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T14:19:38.730

同意 Nebakanezer，但您可能需要先停止服务。

*   选项1

```
NET STOP“服务名称”
网络启动“服务名称”

```

*   选项 2

将虚拟 asp.net 应用程序部署到 IIS 服务器怎么样，然后您可以检测到应用程序启动，这应该只发生在 IISReset 上并触发服务的停止和重新启动？我不确定 IIS 是否有一个更严格的安全模型，可以让你做停止服务或触发批处理文件做同样的事情，但值得一试。

*   选项 3

如果出于某种原因这不是一个选项，您可以将监视 IIS 日志的东西放在一起，我相信它们会记录 IIS 重置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T14:29:41.310

您还可以使用自己的自定义 Windows 查询语言表达式插入 Windows Instrumentation。我从来没有直接将它用于 IIS，但我希望会有一些对象可以让你收听，这让你知道这些变化。您可以查看：[http](http://www.csharphelp.com/archives2/archive334.html) ://www.csharphelp.com/archives2/archive334.html 作为研究的起点。

# javascript - 将 HTML 文本框值设置为 null 应该做什么？

> ID：798161
> 
> 赞同：4
> 
> 时间：2009-04-28T14:11:59.513
> 
> 标签：javascript, html, forms

我们有一个 JSON 响应，它可以包含空值（例如 { myValue: null }） - 我们将此值分配给表单上的文本框：（实际上，我们使用 JQuery，但这是等价的

```
var nullString = null;
document.getElementById('myInput').value = nullString; 
```

如果我们将此值分配给 HTML 文本框值，则行为似乎取决于浏览器：

*   Firefox 和 Chrome 都显示一个空文本框，当你读回“值”时，你会得到空值。

*   IE将字符串'null'放入文本框中，当你读回'value'时，你得到字符串'null'（即设置'value'并读回它已经修改了数据）

（在这里：http: [//jsbin.com/uleno/edit](http://jsbin.com/uleno/edit)如果有人想尝试的话）

哪个浏览器在这里做正确的事情，或者这是未定义的行为？还有比做很多 (myValue == null ? '' : myValue) 更聪明更优雅的解决方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T02:21:57.840

实际上，最简单的做法是：

```
document.getElementById('myInput').value = nullString || ''; 
```

您知道 value 必须得到一个分配的字符串，因此如果它有任何其他 'falsy'* 值，则返回空字符串。

* 空，未定义，0，假，''

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T06:16:15.467

实际发生的是 null 对象被字符串化，例如 null.toString()。在 alert() 消息框中，浏览器通常会解释对象而不是简单地将其字符串化，因此结果会有所不同。当然，浏览器（尤其是 IE）的解释和字符串化方式也不同。

对于它的价值，当需要一个字符串时，有一个返回 null 的逻辑。无论返回此值，都可能是为了提供一个假值以方便条件测试，同时仍指示结果为空而不是，例如未定义。返回集合对象的 DOM 方法也是如此。此外，虽然空字符串文字 ('') 是假值，但空字符串对象 (new String('')) 不是；后者可以通过进一步处理从前者意外创建。因此，防止消费代码意外丢弃有效字符串的“安全”方法是在一种情况下返回字符串文字或 String 对象，在另一种情况下返回 null。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T14:38:46.423

我不确定我的解决方案是否适合您，但这是解决问题的一个方法，我必须承认这对我来说是新的。它的主要优点是它不会使代码混乱，并且您将拥有一个处理此逻辑的地方。据我所知，这是特定于 IE 的。

```
var input = document.getElementById('myInput');

if (input.attachEvent) {
    input.attachEvent("onpropertychange", function() {
        var event = window.event;

        if (event.propertyName === "value" && event.srcElement.value === "null") {
            event.srcElement.value = "";
        }
    });
}

input.value = null;

alert(input.value); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T14:14:26.200

为什么不使用空字符串？首先，修剪价值。然后检查空字符串。

```
String.prototype.trim = function() {
    return this.replace(/^\s+|\s+$/g,"");
}
String.prototype.ltrim = function() {
    return this.replace(/^\s+/,"");
}
String.prototype.rtrim = function() {
    return this.replace(/\s+$/,"");
} 
```

# networking - 传输协议中未使用的字段值

> ID：798168
> 
> 赞同：0
> 
> 时间：2009-04-28T14:12:50.213
> 
> 标签：networking, communication, protocols

我正在为 GSM 网络内部使用的一个小协议编写技术文档。该协议在连续的字节流中使用模式 [id1] + [byte[] data1]、[id2] + [byte[] data2] 等。

关键是由于各种原因（未来的可扩展性和向后兼容性），某些字段未使用。该字段的值是选择谁实现协议（目前默认值来自用于实现协议的语言/框架，即字节数组元素的默认值）。

现在的问题。以某种方式为未使用的字段施加默认值是否有用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T14:16:05.760

如果有的话，优势将在于使用这些字段的协议的未来版本。默认的“坏”值将使接收方确定正在使用旧版本的协议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T14:19:25.657

一般来说，我会说*“是”*。指定默认值和填充值后，您可以在未来基于现有填充值对协议进行更改。如果您现在不能依赖在线上的字节，那么将来就没有好的方法来对这些字节强制执行结构。更不用说，允许“实现依赖值”泄漏到二进制规范中通常是一个坏主意。这就是我最终在“在线”结构中使用 8 字节填充和 Intel 排序的 IP 地址的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T16:46:51.217

指定未使用字段的值通常是一个好主意，如下所示： - 发送者必须将该字段设置为零 - 接收者必须忽略该字段

这样，在将来的某个时间点，您可以选择将该字段用于某些新功能。当您这样做时，为了向后兼容，您所要做的就是将字段的值 0 定义为“在引入新功能之前的旧行为。

（实际上，引入某种形式的能力声明也是一个好主意，它允许一方发现另一方是否支持该功能，换句话说，另一方是否能够理解非零值场。）

# python - 巧妙缩进 SQL 语句的算法（Python 实现会很好）

> ID：798180
> 
> 赞同：22
> 
> 时间：2009-04-28T14:14:24.937
> 
> 标签：python, sql, coding-style, indentation, pretty-print

我想将一些带有换行符的单个字符串的 SQL 语句重新格式化为更易于阅读的内容。

我个人不知道缩进 SQL 的良好编码风格 - 嵌套查询 / where 子句 / 左连接 / 等应该如何表示以最大限度地提高可读性？

有没有人见过一个漂亮的打印算法已经这样做了？在 Python 中会更好。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-28T14:59:12.973

你可以试试[sqlparse](http://python-sqlparse.googlecode.com)。它是一个提供简单 SQL 格式的 Python 模块。[此处](http://sqlformat.appspot.com)提供在线演示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T14:25:56.157

我个人使用[SQL Inform](http://www.sqlinform.com/)进行快速 SQL 格式化，它是用 Java 编写的，不幸的是不是开源的，因此无法访问底层算法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-28T14:35:22.110

寻找工具的部分困难可能在于有太多不同的“标准”SQL 格式化约定。以下是描述人们偏好的两个 SO 问题：

*   [SQL 格式化标准](https://stackoverflow.com/questions/519876/sql-formatting-standards)
*   [您遵循什么 SQL 编码标准？](https://stackoverflow.com/questions/522356/what-sql-coding-standard-do-you-follow)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-05-15T14:20:42.450

我以前使用 Devart 的 SQL Complete 来格式化 SQL，但现在有一个免费的由 SQL Complete 提供支持的在线 SQL 美化器 - [SQL Formatter](http://www.sql-format.com/)，它的功能非常丰富，即使对于初学者来说也很容易使用。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-04-28T14:49:05.680

不知道它是否回答了你的问题，但我通常使用这种策略

```
SELECT what1, what2, etc,
FROM table
WHERE condition
  AND condition
  AND condition
ORDER BY whatever 
```

但这只是我。我认为不存在适当的自动工具。

# java - Java：重置程序中的所有值

> ID：798184
> 
> 赞同：1
> 
> 时间：2009-04-28T14:14:54.980
> 
> 标签：java

我正在开发这个程序，在游戏结束时我会询问用户是否想再玩一次。如果他们说是，我需要开始一个新游戏。我做了一个 restart() 方法：

```
public void restart(){
    Game g = new Game();
    g.playGame();
} 
```

然而，当我调用这个方法时，我的程序中的一些值会保持在前一个游戏中的状态。

是否有游戏可以清除所有内容并使用所有默认值创建游戏的新实例？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-28T14:19:21.727

如果没有更多信息，我猜您的问题很可能是您使用了静态变量，其值将在给定类的所有实例中持续存在。如果将它们全部放入成员变量并在构造函数中初始化它们，它应该可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T14:21:12.550

验证那些未重置的值是否在 Game 构造函数中重置。他们可能不是。

这些值也是静态的吗？构造函数不会重置静态值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T14:23:07.147

你有*静态*变量吗？如果是，则很可能是问题所在。为类的新实例维护静态变量的值。您可以尝试删除静态修饰符并确保初始化类构造函数中的所有变量。

# ruby - 有没有办法告诉黄瓜在测试失败时不要跳过其他测试？

> ID：798188
> 
> 赞同：0
> 
> 时间：2009-04-28T14:15:39.737
> 
> 标签：ruby, cucumber

有没有办法告诉黄瓜在测试失败时不要跳过其他测试？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T19:25:57.713

如果场景的某个部分搞砸了，那么继续下去通常是没有意义的。

如果您希望它们继续运行，或者它们在逻辑上有意义（不与其他操​​作相结合），它们可能不属于同一场景

```
Scenario: making a sandwich:
Get bread... Success
Get peanut butter... Success
Get knife... Fail (no knives)
Use knife on peanut butter... errr... what knife? 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T19:22:01.500

根据我的经验，继续测试没有任何意义。

你能发布一个你的场景的例子吗？

# sql-server - 在 SQL Server 中强制查询超时

> ID：798192
> 
> 赞同：82
> 
> 时间：2009-04-28T14:16:13.217
> 
> 标签：sql-server, testing, timeout, locking

我们遇到了一个代码块的问题，该代码块在面对慢速数据库时响应很差（它在查询超时时把床弄得一团糟）。我们已经创建了一个补丁，并且正在通过回归运行它。

我们不能超时。我已经从 SQL Mgmt Studio 打开了一个事务并更新了每一行以锁定它们，但这不会导致 INSERT 超时（这是我需要的）。

我可以通过 T-SQL 轻松获得表级锁吗？还是我必须在主人那里摆弄？或者我可以轻松地强制超时而不锁定？任何输入表示赞赏。

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2009-04-28T14:23:55.380

运行它，然后尝试插入...

```
select * from yourTable with (holdlock,tablockx) 
```

在这里，您可以将其锁定 5 分钟：

```
BEGIN TRANSACTION

SELECT * FROM yourTable WITH (TABLOCKX, HOLDLOCK)

WHERE 0 = 1

WAITFOR DELAY '00:05'

ROLLBACK TRANSACTION 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-04-28T14:28:15.463

您可以告诉您的 sql 代码在返回之前等待一分钟：

```
WaitFor Delay '00:01:00' 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-06T16:04:40.343

另一方面：如果连接是可配置的，则将连接字符串超时减少到 1 秒 - 这将使其更容易。用大量数据填充表，并让其他 3 个进程在循环中旋转，并使用循环周围的事务更新该表的块。不要更改应用程序调用的实际过程（注入 waitfor）。这会使集成测试无效。

但实际上，这是一个支持单元测试和依赖注入的案例研究。有些东西很难集成测试。单元测试+[依赖注入](http://martinfowler.com/articles/injection.html)。

*   真实：废话代码 -> 数据库超时（难以重现）。
*   重构：废话代码->存储库（仅进行数据访问）->数据库
*   单元测试：掷骰子的代码>要抛出的[模拟存储库](http://en.wikipedia.org/wiki/Mock_object)-> null
*   现在你有一个失败的代码测试，可以修复它。

这是“依赖”注入。开发人员可以将依赖项注入数据库，替换一些模拟依赖项行为的东西。对所有数据库测试都很好。无论如何，有了单元测试，您就知道修复程序做了它应该做的事情，但您仍然需要集成测试。在这种情况下，它可能更好地专注于回归——这意味着测试它没有破坏其他任何东西，并且该功能仍然有效。

您已经创建了补丁，所以我想我的回答为时已晚。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-28T14:35:03.640

看看这篇博文。基本上 SQL Server 没有查询超时。客户端可能会强制执行 SQL 超时，但引擎本身不会。

[http://blogs.msdn.com/khen1234/archive/2005/10/20/483015.aspx](http://blogs.msdn.com/khen1234/archive/2005/10/20/483015.aspx)

# user-interface - WiX 3.0：可用 UI 对话框列表

> ID：798194
> 
> 赞同：7
> 
> 时间：2009-04-28T14:16:23.043
> 
> 标签：user-interface, wix, dialog

我正在为 WiX 安装程序创建一个 UI，并且我已经包含了 WixUI `_`Common。我四处搜索，但似乎找不到 WiX 提供的对话框的完整列表。

请列出您知道的所有对话框以及这些对话框的作用。

更新：感谢 CheGueVerra 的回答，我能够在 WiX 源代码的 src\ext\UIExtension\wixlib 目录中找到定义所有 UI 对话框的 wxs 文件。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T23:40:02.663

我们最近增强了 WiX 3.0 文档以包含有关 WixUI 的更多详细信息。Rob 链接到上面的页面几周前还不存在，所以这可能就是你错过它的原因。昨晚我还在[http://wix.sourceforge.net/manual-wix3/WixUI_customizations.htm](http://wix.sourceforge.net/manual-wix3/WixUI_customizations.htm)上增强了该主题，该信息也可能对您有所帮助。

谢谢！

编辑：sourceforge 链接已失效，但内容可在以下位置获得：

*   [https://web.archive.org/web/20090523152544/http://wix.sourceforge.net/manual-wix3/WixUI_customizations.htm](https://web.archive.org/web/20090523152544/http://wix.sourceforge.net/manual-wix3/WixUI_customizations.htm)
*   [https://wixtoolset.org/documentation/manual/v3/wixui/wixui_customizations.html](https://wixtoolset.org/documentation/manual/v3/wixui/wixui_customizations.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T16:23:04.563

如果您下载 WIX 的最新源代码，您将在 Common.wxs 文件中找到 WixUI_Common 的声明：

```
<UI Id="WixUI_Common">
    <!-- ui text -->
    <UIText Id="AbsentPath" />
    <UIText Id="bytes">!(loc.UITextbytes)</UIText>
    <UIText Id="GB">!(loc.UITextGB)</UIText>
    <UIText Id="KB">!(loc.UITextKB)</UIText>
    <UIText Id="MB">!(loc.UITextMB)</UIText>
    <UIText Id="MenuAbsent">!(loc.UITextMenuAbsent)</UIText>
    <UIText Id="MenuAdvertise">!(loc.UITextMenuAdvertise)</UIText>
    <UIText Id="MenuAllCD">!(loc.UITextMenuAllCD)</UIText>
    <UIText Id="MenuAllLocal">!(loc.UITextMenuAllLocal)</UIText>
    <UIText Id="MenuAllNetwork">!(loc.UITextMenuAllNetwork)</UIText>
    <UIText Id="MenuCD">!(loc.UITextMenuCD)</UIText>
    <UIText Id="MenuLocal">!(loc.UITextMenuLocal)</UIText>
    <UIText Id="MenuNetwork">!(loc.UITextMenuNetwork)</UIText>
    <UIText Id="NewFolder">!(loc.UITextNewFolder)</UIText>
    <UIText Id="ScriptInProgress">!(loc.UITextScriptInProgress)</UIText>
    <UIText Id="SelAbsentAbsent">!(loc.UITextSelAbsentAbsent)</UIText>
    <UIText Id="SelAbsentAdvertise">!(loc.UITextSelAbsentAdvertise)</UIText>
    <UIText Id="SelAbsentCD">!(loc.UITextSelAbsentCD)</UIText>
    <UIText Id="SelAbsentLocal">!(loc.UITextSelAbsentLocal)</UIText>
    <UIText Id="SelAbsentNetwork">!(loc.UITextSelAbsentNetwork)</UIText>
    <UIText Id="SelAdvertiseAbsent">!(loc.UITextSelAdvertiseAbsent)</UIText>
    <UIText Id="SelAdvertiseAdvertise">!(loc.UITextSelAdvertiseAdvertise)</UIText>
    <UIText Id="SelAdvertiseCD">!(loc.UITextSelAdvertiseCD)</UIText>
    <UIText Id="SelAdvertiseLocal">!(loc.UITextSelAdvertiseLocal)</UIText>
    <UIText Id="SelAdvertiseNetwork">!(loc.UITextSelAdvertiseNetwork)</UIText>
    <UIText Id="SelCDAbsent">!(loc.UITextSelCDAbsent)</UIText>
    <UIText Id="SelCDAdvertise">!(loc.UITextSelCDAdvertise)</UIText>
    <UIText Id="SelCDCD">!(loc.UITextSelCDCD)</UIText>
    <UIText Id="SelCDLocal">!(loc.UITextSelCDLocal)</UIText>
    <UIText Id="SelChildCostNeg">!(loc.UITextSelChildCostNeg)</UIText>
    <UIText Id="SelChildCostPos">!(loc.UITextSelChildCostPos)</UIText>
    <UIText Id="SelCostPending">!(loc.UITextSelCostPending)</UIText>
    <UIText Id="SelLocalAbsent">!(loc.UITextSelLocalAbsent)</UIText>
    <UIText Id="SelLocalAdvertise">!(loc.UITextSelLocalAdvertise)</UIText>
    <UIText Id="SelLocalCD">!(loc.UITextSelLocalCD)</UIText>
    <UIText Id="SelLocalLocal">!(loc.UITextSelLocalLocal)</UIText>
    <UIText Id="SelLocalNetwork">!(loc.UITextSelLocalNetwork)</UIText>
    <UIText Id="SelNetworkAbsent">!(loc.UITextSelNetworkAbsent)</UIText>
    <UIText Id="SelNetworkAdvertise">!(loc.UITextSelNetworkAdvertise)</UIText>
    <UIText Id="SelNetworkLocal">!(loc.UITextSelNetworkLocal)</UIText>
    <UIText Id="SelNetworkNetwork">!(loc.UITextSelNetworkNetwork)</UIText>
    <UIText Id="SelParentCostNegNeg">!(loc.UITextSelParentCostNegNeg)</UIText>
    <UIText Id="SelParentCostNegPos">!(loc.UITextSelParentCostNegPos)</UIText>
    <UIText Id="SelParentCostPosNeg">!(loc.UITextSelParentCostPosNeg)</UIText>
    <UIText Id="SelParentCostPosPos">!(loc.UITextSelParentCostPosPos)</UIText>
    <UIText Id="TimeRemaining">!(loc.UITextTimeRemaining)</UIText>
    <UIText Id="VolumeCostAvailable">!(loc.UITextVolumeCostAvailable)</UIText>
    <UIText Id="VolumeCostDifference">!(loc.UITextVolumeCostDifference)</UIText>
    <UIText Id="VolumeCostRequired">!(loc.UITextVolumeCostRequired)</UIText>
    <UIText Id="VolumeCostSize">!(loc.UITextVolumeCostSize)</UIText>
    <UIText Id="VolumeCostVolume">!(loc.UITextVolumeCostVolume)</UIText>
</UI> 
```

这来自 3.0.5217.0 源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T15:43:58.293

你看过很棒的 WiX 教程吗，[这里有一个 UI 页面](http://www.tramontana.co.hu/wix/lesson2.php)（[存档](https://web.archive.org/web/20071005042401/http://www.tramontana.co.hu/wix/lesson2.php)）？

据我记得，您可以从那里下载的 UI 示例中有一堆 UI 对话框。不确定它是否是“完整”和最终的列表——但如果我没记错的话，肯定是一个相当不错的列表。

编辑：真的很难找到这些对话框的完整列表！嘿 Rob - 如果你读到了这篇文章 - 这将是你的 WiX 帮助文件和 wix.sourceforge.net 上的常见问题解答的一个很好的补充！

我什至在源代码中都找不到任何东西......

但是挖掘我的一些代码，有一段时间，我一定找到了一个“WiXUI......wxi”片段文件，因为我调整了对话框列表以删除“许可协议”对话框。除此之外，我认为我的清单应该是完整的：

```
<!--
First-time install dialog sequence:      Maintenance dialog sequence:
 - WixUI_WelcomeDlg                     - WixUI_MaintenanceWelcomeDlg
 - WixUI_LicenseAgreementDlg            - WixUI_MaintenanceTypeDlg
 - WixUI_CustomizeDlg                     - WixUI_CustomizeDlg
   - WixUI_VerifyReadyDlg                 - WixUI_VerifyReadyDlg
   - WixUI_DiskCostDlg
-->

<Wix xmlns="http://schemas.microsoft.com/wix/2003/01/wi">
    <Fragment>
       <UI Id="WixUI_NoLicenseAgreement">
        <Property Id="DefaultUIFont" Value="WixUI_Font_Normal" />
        <Property Id="WixUI_Mode" Value="FeatureTree" />

        <DialogRef Id="BrowseDlg" />
        <DialogRef Id="CustomizeDlg" />
        <DialogRef Id="DiskCostDlg" />
        <DialogRef Id="ErrorDlg" />
        <DialogRef Id="ExitDialog" />
        <DialogRef Id="FatalError" />
        <DialogRef Id="FilesInUse" />
        <DialogRef Id="MaintenanceTypeDlg" />
        <DialogRef Id="MaintenanceWelcomeDlg" />
        <DialogRef Id="MsiRMFilesInUse" />
        <DialogRef Id="PrepareDlg" />
        <DialogRef Id="ProgressDlg" />
        <DialogRef Id="ResumeDlg" />
        <DialogRef Id="UserExit" />
        <DialogRef Id="VerifyReadyDlg" />
        <DialogRef Id="WelcomeDlg" /> 
```

当然，这些对话框出现的顺序是由安装中的“UI 序列”控制的。

马克

# java - 在java中通过UDP传输文件

> ID：798195
> 
> 赞同：1
> 
> 时间：2009-04-28T14:17:00.187
> 
> 标签：java, sockets, udp, tcp

我在使用 TCP/IP 的 Java 中实现了以下算法：

```
-Client request a file
-Server checks if the file exists
  - if do: send contents of the file to the client
  - if not: send "file not found" msg to the client 
```

现在我在使用 UDP 数据包实现它时遇到了麻烦。这是我的代码：

* * *

### 客户：

```
package br.com.redes.client;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.PrintWriter;
import java.net.Socket;
import java.net.UnknownHostException;

import br.com.redes.configuration.CommonKeys;

public class TCPClient {
    public static void exibirCabecalho(){
        System.out.println("-------------------------");
        System.out.println("TCP CLIENT");
        System.out.println("-------------------------");
    }

    public static void main(String[] args) throws IOException {

        TCPClient.exibirCabecalho();

        Socket echoSocket = null;
        PrintWriter out = null;
        BufferedReader in = null;

        if (args.length != 1){
            System.out.println("O Programa deve ser chamado pelo nome + nome do servidor");
            System.out.println("Ex: java TCPClient localhost");
            System.exit(1);
        }

        System.out.println("Conectando ao servidor...");
        try {
            echoSocket = new Socket( args[0] , CommonKeys.PORTA_SERVIDOR);
            out = new PrintWriter(echoSocket.getOutputStream(), true);
            in = new BufferedReader(new InputStreamReader(echoSocket
                    .getInputStream()));
        } catch (UnknownHostException e) {
            System.err.println("Host não encontrado (" + args[0] + ")");
            System.exit(1);
        } catch (IOException e) {
            System.err.println("Erro ao inicializar I/O para conexao");
            System.exit(1);
        }

        System.out.println("Conectado, digite 'sair' sem as aspas para finalizar");

        BufferedReader stdIn = new BufferedReader(new InputStreamReader(System.in));
        String userInput;

        while ((userInput = stdIn.readLine()) != null) {
            out.println(userInput);
            String inputLine = in.readLine(); 

            if (inputLine == null){
                System.out.println("Servidor terminou a conexão.");
                System.out.println("Saindo...");
                break;
            }

            System.out.println("Servidor: " + inputLine.replace("\\n", "\n"));
        }

        out.close();
        in.close();
        stdIn.close();
        echoSocket.close();
    }

} 
```

* * *

### 服务器：

```
package br.com.redes.server;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.PrintWriter;
import java.net.ServerSocket;
import java.net.Socket;

import br.com.redes.configuration.CommonKeys;

public class TCPServer {
    public static void exibirCabecalho(){
        System.out.println("-------------------------");
        System.out.println("TCP SERVER");
        System.out.println("-------------------------");
    }

    public static void main(String[] args) throws IOException {

        TCPServer.exibirCabecalho();
        ServerSocket serverSocket = null;
        try {
            serverSocket = new ServerSocket( CommonKeys.PORTA_SERVIDOR );
        } catch (IOException e) {
            System.err.println("Erro ao iniciar servidor na porta: " + CommonKeys.PORTA_SERVIDOR );
            System.exit(1);
        }

        System.out.println("Iniciando servidor na porta: " + CommonKeys.PORTA_SERVIDOR);
        System.out.println("Aguardando cliente...");
        Socket clientSocket = null;
        try {
            clientSocket = serverSocket.accept();
        } catch (IOException e) {
            System.err.println("Erro ao receber conexoes.");
            System.exit(1);
        }

        PrintWriter out = new PrintWriter(clientSocket.getOutputStream(), true);
        BufferedReader in = new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));

        String inputLine, outputLine;

        System.out.println("Cliente conectado, aguardando caminhos pra leitura...");
        while ((inputLine = in.readLine()) != null) {

            if (inputLine.equalsIgnoreCase("sair")) {
                System.out.println("Sair detectado, fechando servidor...");
                break;
            }

            outputLine = processar(inputLine);
             out.println(outputLine);
        }
        out.close();
        in.close();
        clientSocket.close();
        serverSocket.close();
    }

    private static String processar(String inputLine) {
        final String ARQUIVO_NAO_ENCONTRADO = "arquivo não encontrado.";
        final String ARQUIVO_IO = "erro ao ler arquivo.";

        System.out.println("Procurando arquivo: " + inputLine);
        File f = new File(inputLine);
        try {
            BufferedReader input =  new BufferedReader(new FileReader(f));
            String linha = null;
            StringBuffer retorno = new StringBuffer();

            retorno.append("\\n");
            retorno.append("Arquivo encontrado, lendo conteudo: " + inputLine + "\\n");
            while (( linha = input.readLine()) != null){
                  retorno.append(linha  + "\\n");
            }
            retorno.append("fim da leitura do arquivo\\n");
            return retorno.toString();
        } catch (FileNotFoundException e) {
            return ARQUIVO_NAO_ENCONTRADO;
        } catch (IOException e) {
            return ARQUIVO_IO;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T14:53:57.133

这当然可以使用 UDP 数据报来完成。但是，由于 UDP 本身不提供可靠性或有序的数据包传递，这将变得更加困难。您的应用程序需要这些功能才能将文件传递给客户端。如果您选择使用 UDP，您将需要编写额外的代码来完成此操作。你确定你真的想使用 UDP 吗？

如果您像上面的示例一样选择 TCP，则无需担心字节以正确的顺序到达那里。

我将从查看[Sun Datagram Tutorial中的一些示例开始](http://java.sun.com/docs/books/tutorial/networking/datagrams/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T14:31:06.643

我建议查看 UDP 协议（[​​RFC 768](http://www.faqs.org/rfcs/rfc768.html)），然后使用一些基本示例。有很多关于 UDP 和 Java 的例子（例如[Java Tutorials -> Networking](http://java.sun.com/docs/books/tutorial/networking/datagrams/clientServer.html)）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T14:34:14.437

我同意 Daniel H 的观点。您还应该专门查看[java.net.DatagramSocket](http://java.sun.com/javase/6/docs/api/java/net/DatagramSocket.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T14:45:43.597

我想知道您是否对 TCP 和 UDP 感到困惑？您的代码在其类名中引用 TCP 等，但您在谈论 UDP 吗？这些是使用 IP 的不同协议，但具有不同的特性。可靠性/碎片化/重复等。

请参阅[此处](http://www.skullbox.net/tcpudp.php)了解差异。

# silverlight - 深变焦旋转

> ID：798203
> 
> 赞同：1
> 
> 时间：2009-04-28T14:18:32.697
> 
> 标签：silverlight, deepzoom

是否可以在 Silverlight Deep Zoom 中进行旋转？我希望动画尽可能快且无缝。

换句话说，我可以在保持 Deep Zoom 效果的同时旋转 Deep Zoom 区域吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T18:56:37.240

是的，您可以 - 只需将 RotationTransform 应用于 MultiScaleImage 或其父项之一。一个警告是，如果您使用鼠标平移导航，您将需要调整代码以考虑转换。

# sql-server - SQL Server“EXECUTE AS”错误

> ID：798206
> 
> 赞同：9
> 
> 时间：2009-04-28T14:18:50.603
> 
> 标签：sql-server, impersonation

我有以下设置：

有一个 SQL Server 数据库，其中包含几个表，这些表上设置了触发器（收集历史数据）。这些触发器是 CLR 存储过程，带有`EXECUTE AS 'HistoryUser'`. `HistoryUser`用户是数据库中的简单用户，无需登录。它有足够的权限从所有表中读取并写入历史表。

当我备份数据库然后将其还原到另一台机器（在这种情况下为虚拟机，但没关系）时，触发器不再起作用。事实上，不再模拟用户。即使是这样的简单陈述

```
exec ('select 3') as user='HistoryUser' 
```

产生错误：

> 无法作为数据库主体执行，因为主体“HistoryUser”不存在，无法模拟此类主体，或者您没有权限。

我[在 MSDN](http://support.microsoft.com/kb/913423)中读到，如果数据库所有者是域用户，则可能会发生这种情况，但事实并非如此。即使我将其更改为其他任何内容（他们推荐的解决方案），这个问题仍然存在。

如果我创建另一个没有登录的用户，我可以用它来模拟就好了。也就是说，这很好用：

```
create user TestUser without login
go
exec ('select 3') as user='TestUser' 
```

我不想重新创建所有这些触发器，那么有什么办法可以使现有的`HistoryUser`工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-28T14:44:48.733

触发器作为什么用户帐户执行。

您需要为用户帐户 HistoryUser 授予该用户 IMPERSONATE 特权。

```
 GRANT IMPERSONATE ON USER:: YourUser TO HistoryUser 
```

更多细节在这里

[http://msdn.microsoft.com/en-us/library/ms181362.aspx](http://msdn.microsoft.com/en-us/library/ms181362.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-04-01T10:55:06.543

检测孤立用户，然后通过链接到登录来解决。

**检测：**

使用<数据库名称>；
去;
sp_change_users_login @Action='报告';
去;

**RESOLVE：**
以下命令将 <login_name> 指定的服务器登录帐户与 <database_user> 指定的数据库用户重新链接：

USE <database_name>;
去
sp_change_users_login @Action='update_one',
@UserNamePattern='<database_user>',
@LoginName='<login_name>';
去

[https://msdn.microsoft.com/en-us/library/ms175475.aspx](https://msdn.microsoft.com/en-us/library/ms175475.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-28T22:24:08.253

将数据库从一台机器移动到另一台机器后出现的此类问题通常涉及不匹配的 SID，尽管我不确定它是否或如何适用于您的情况。尝试删除并重新创建数据库用户，确保恢复其对这些表的权限。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-31T17:09:22.880

它是一个“孤立用户”。它不会工作。文档清楚地说明了这一点。:-( 修复“孤立用户”状态，它将再次工作

# c# - 在解决方案资源管理器中显示为类的表单

> ID：798208
> 
> 赞同：2
> 
> 时间：2009-04-28T14:19:17.500
> 
> 标签：c#, .net, winforms

我的项目中有一个表单，它在解决方案资源管理器中显示为一个类。这导致了一个问题，因为我无法联系到设计师。有想法该怎么解决这个吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-28T15:40:48.067

您可以通过编辑您的 csproj 文件手动修复该问题。

在记事本中打开它并搜索类的文件名。你应该看到这样的东西......

```
<Compile Include="frmTest.cs" /> 
```

像这样添加一个名为“表单”的子类型......

```
<Compile Include="frmTest.cs">
    <SubType>Form</SubType>
</Compile> 
```

重新加载项目。Visual Studio 现在应该正确识别文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T14:33:26.357

尝试使用“显示所有文件”按钮查看是否有任何隐藏文件。听起来您的项目文件可能没有添加所有文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T15:36:32.803

过去对我有用的一件事是在项目中添加另一个空白表单，这似乎使另一个表单显示为表单。然后，您可以删除空白表格。

我不知道它是否对您有用，但只需几分钟即可尝试。

克里斯

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-07-25T13:29:40.823

删除表单相关dll的引用并再次添加和构建项目

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T14:21:10.160

在代码编辑器中按 F7 进入设计器。并且重新启动 Visual Studio 通常会有所帮助。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-09-10T05:52:03.870

只需选择表单并按 Shift+F7。你会找到你的表格。

# sql-server - 有什么方法可以取消删除 SQL Server 数据库和存储过程？

> ID：798209
> 
> 赞同：4
> 
> 时间：2009-04-28T14:19:19.683
> 
> 标签：sql-server, database, recovery

有什么方法可以取消删除 SQL Server 数据库和存储过程？

### 编辑：

不，我没有备份。这就是我需要帮助的原因

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-28T14:20:19.803

从备份中恢复。

你有备份，对吧？

编辑：我假设您可能从 SQL Management Studio 中右键单击“删除”？如果是这样，那实际上会“删除”数据库，这实际上会从硬盘驱动器中删除文件。如果是这种情况，您必须从最新的备份中恢复（如果有的话）。

如果您只是“分离”，则 MDF 和 LDF 文件仍在硬盘驱动器上，您可以简单地附加它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-28T14:24:19.187

你到底是怎么删的。

如果从那时起您没有对磁盘文件系统进行任何更改（并且没有进行碎片整理），那么文件可能仍然位于磁盘上，因为 Windows 不会完全删除文件，只是文件句柄。

看看这样的东西，您也许可以从您的 HD 中恢复 .mdf/.ldf 文件。

[http://www.undelete.com/file-recovery.aspx](http://www.undelete.com/file-recovery.aspx)

如果没有，您将不得不从最后一次恢复。

如果你没有备份……你就完蛋了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-12-18T08:09:03.780

如果您在 SQL Server Management Studio 中通过右键单击并匆忙点击删除意外删除了数据库并且您没有备份，那么可能仍有机会取回数据库：

1.  不要在存储数据库文件的磁盘上进行任何保存/删除文件操作，浏览应该是可以的。

2.  找到 .mdf 文件曾经所在的位置。就我而言，它是“c:\Program Files\Microsoft SQL Server\MSSQL11.SQLEXPRESS2012\MSSQL\DATA”。如果您有多个数据库，您可以右键单击现有数据库，选择属性和文件。在路径下的列表框中找到位置条目（选择并 ctrl+c 复制它）

3.  **将便携式**取消删除程序（例如[Recuva](http://www.piriform.com/recuva/builds) ）下载到 USB 驱动器/记忆棒（解压缩）并从 USB 驱动器/记忆棒运行它。

4.  在您的取消删除程序（ctrl+v）中将复制的路径设置为“搜索位置”，将“YOURDATABASE.mdf”和“YOURDATABASE_log.ldf”恢复到 USB 驱动器。

5.  将文件从 USB 驱动器/记忆棒复制到原始位置。

6.  在 SQL Server Management Studio 中，右键单击“数据库”选择“附加..”单击添加，选择“YOURDATABASE.mdf”。

7.  喝杯咖啡，想想备份:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T14:26:38.417

你删除了数据库还是分离了它？如果您已将其分离，则只需从 mdf 和 ldf 文件重新附加它。

# iphone - iPhone上是否有首选的数据库管理/对象持久性方法？

> ID：798218
> 
> 赞同：2
> 
> 时间：2009-04-28T14:20:42.487
> 
> 标签：iphone, cocoa-touch, core-data, object-persistence

我见过几种方法，每种方法似乎都有显着的优点和缺点。我正在学习 iPhone 开发，我正在构建一个相对简单的应用程序，它的核心实际上只不过是对 3 或 4 个相关实体的 CRUD 操作。

我习惯了 ActiveRecord 类型的对象持久性。我在网上读到的 Cocoa Touch 的实现通常被称为非常慢。

我在网上看到的大多数示例（特别是 Pragmatic Programmers 截屏视频）都将 SQL 硬编码到控制器类中，这对我来说似乎不合适。似乎很老派（但在这种情况下，老派可能是最好的）。

我知道我们不能在这里讨论 SDK 3.0，但众所周知，CoreData 即将用于 iPhone，这当然会限制我的听众（我不确定我是否真的这么关心。它将是一个应用程序出售，但我不打算用它取代我的职业）

我还没有尝试过 Gus Mueller 的 FMDB，但我读过好东西。

你的一些经验是什么，什么有效，什么无效。你会推荐一个（仍然是新手）iPhone 程序员在哪里投入时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T17:06:48.780

现在有很多在应用程序中编码的半原始 SQL，因为没有用于更高级别工作的内置系统。FMDB 是一种很好的方法，但它只是将 SQLite 调用包装成更类似于 Objective-C 的东西。这对某些情况很好，但显然不是所有情况。

如果您熟悉 ActiveRecord，那么[SQLite Persistent Objects](http://code.google.com/p/sqlitepersistentobjects/)可能对您有用，因为它旨在类似于 ActiveRecord。我也没有使用过，所以我无法告诉你它实际上有多相似。如果由于某种原因这看起来不正确，那么此时最好以 3.0 为目标并利用 Core Data。

# .net - 从 ASP.net Web 服务捕获 SoapExceptions

> ID：798219
> 
> 赞同：1
> 
> 时间：2009-04-28T14:20:53.080
> 
> 标签：.net, web-services, exception, soap, exception-handling

我有一个使用 ASP.net Web 服务的 Windows 窗体客户端。

据我了解，当 Web 服务引发异常时，它将在 .net 客户端软件中转换为 SoapException。

好吧，我正在捕获 SoapException，但是当我在消息框中显示客户端上的消息时，它显示的信息比我真正想要显示的要多。

这是网络服务代码：

```
throw new ApplicationException("Invalid username or password."); 
```

甚至：

```
throw new SoapException("Invalid username or password.", SoapException.ServerFaultCode); 
```

但是在客户端，SoapException 的 Message 属性是这样的：

```
System.Web.Services.Protocols.SoapException：用户名或密码无效。在 C:\Documents and Settings\rdoverby\My Documents\Visual Studio 2008\WebSites\www.gtcc.edu\App_Code\webservices\Transportation.cs:line 中的 Transportation.InsertSignUps(String username, String password, SignUp[] signUps) 50
```

然而，我真正想展示的是：

```
用户名或密码无效。
```

如何从 SoapException 中仅提取原始异常的消息。我在 VS 调试器中查看了 SoapException 对象，但找不到我要找的东西。

谢谢。

## 编辑

当然，我不想解析那个长字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-05-14T16:35:56.853

如果异常是soapException（se），那么您可以使用se.Detail.FirstChild.OuterXml之类的东西来获取最重要的位，这是通常放置异常的地方，或者如果您想要很多，那么se.Detail.OuterXml

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T14:25:37.373

试过了`Exception.InnerException.Message`吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T15:29:16.677

从 SoapException 派生一个新的异常类并直接设置 message 属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T02:34:43.987

您需要抛出自己的异常、自定义或其他异常，然后当客户端抛出soap 异常时，Detail 属性应该具有您要查找的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T14:09:56.170

算了。我刚刚从服务中返回了一个包含任何错误消息的字符串。如果字符串为空，则服务完成了它的工作。

沉默是金。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-12T21:02:46.910

不要太失望:)

我在这篇文章的帮助下做了同样的事情：http: [//www.developer.com/net/csharp/article.php/3088231](http://www.developer.com/net/csharp/article.php/3088231)。

我为我的异常创建了一个自定义类，它甚至将真正的异常作为 InnerException 封装在其中。（我为我的自定义异常的每种已知类型添加了一个独立于语言的 ID，以使其对我的客户更有用。）

在客户端，我只是得到了 InnerException，而 InnerException.Message 是原始文本，没有任何垃圾。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-12T21:14:06.020

对不起，我以前没有看到这个。

我相信真正的答案是`<customErrors/>`在服务器上配置。我忘记了您想要哪种模式，但是这三种模式中的一种会限制客户端收到的异常中的详细信息量。这不是你所期望的，我自己也不相信。有人在另一个论坛上发布了这个答案，当我尝试时，它奏效了。我没有尝试过摆脱细节。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-11-04T16:47:04.717

SoapException 的 detail 属性包含 SerializedExeption 节点下的原始序列化异常。

您可以尝试使用 System.Runtime.Serialization.Formatters.Soap.SoapFormatter 使用类似于此处描述的方法反序列化异常：http: [//blog.irm.se/blogs/eric/archive/2005/03/06/ An-ExceptionHandler-that-extract-the-detail-information-from-the-SoapException.aspx](http://blog.irm.se/blogs/eric/archive/2005/03/06/An-ExceptionHandler-that-extract-the-detail-information-from-the-SoapException.aspx)

但是，我无法使其工作，因为我最终从 Soap Formatter 收到“没有与 Xml 密钥关联的程序集”错误。

您可以手动向下钻取 SerializedException 节点，因为它本质上包含一个 base-64 编码的 SOAP 信封：

```
 string serializedException = exception.Detail.SelectSingleNode("SerializedException").InnerText;
        XmlDocument xmlDocument = new XmlDocument();
        xmlDocument.LoadXml(Encoding.UTF8.GetString(Convert.FromBase64String(serializedException))); 
```

生成的 XmlDocument 将包含一些有趣的信息，包括看似 xml 序列化的异常。

# c - 用于创建字符串的 C 宏

> ID：798221
> 
> 赞同：33
> 
> 时间：2009-04-28T14:21:01.177
> 
> 标签：c, macros, c-preprocessor, stringification

> **替代标题（帮助搜索）**
> 
> *   将预处理器标记转换为字符串
> *   如何从**C**宏的值生成 char 字符串？

# 原始问题

我想在编译时使用**C来构建文字字符串。** `#define`

该字符串是为调试、发布等而更改的域。

我想要一些这样的东西：

```
#ifdef __TESTING
    #define IV_DOMAIN domain.org            //in house testing
#elif __LIVE_TESTING
    #define IV_DOMAIN test.domain.com       //live testing servers
#else
    #define IV_DOMAIN domain.com            //production
#endif

// Sub-Domain
#define IV_SECURE "secure.IV_DOMAIN"             //secure.domain.org etc
#define IV_MOBILE "m.IV_DOMAIN" 
```

但是预处理器不会评估“”中的任何内容

1.  有没有解决的办法？
2.  这甚至是个好主意吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-28T14:30:22.230

在 C 中，字符串文字是自动连接的。例如，

```
const char * s1 = "foo" "bar";
const char * s2 = "foobar"; 
```

`s1`并且`s2`是相同的字符串。

因此，对于您的问题，答案（不粘贴令牌）是

```
#ifdef __TESTING
    #define IV_DOMAIN "domain.org"
#elif __LIVE_TESTING
    #define IV_DOMAIN "test.domain.com"
#else
    #define IV_DOMAIN "domain.com"
#endif

#define IV_SECURE "secure." IV_DOMAIN
#define IV_MOBILE "m." IV_DOMAIN 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-04-28T14:38:27.453

有几种方法可以做到这一点：

1.  如果您只处理字符串文字，您可以简单地使用简单的使用字符串 - 一个接一个地放置一个字符串文字会导致编译器连接它们。

2.  如果可能涉及字符串文字以外的其他内容（即，您正在从宏创建新标识符），请使用 ' `##`" 预处理器标记粘贴运算符。您可能还需要使用 ' `#`' 'stringizing 运算符来制作宏成文字字符串。

#1 的示例：

```
#ifdef __TESTING
    #define IV_DOMAIN "domain.org"                        //in house testing
#elif __LIVE_TESTING
    #define IV_DOMAIN "test.domain.com"           //live testing servers
#else
    #define IV_DOMAIN "domain.com"                        //production
#endif

// Sub-Domain
#define IV_SECURE "secure." IV_DOMAIN          //secure.domain.org etc
#define IV_MOBILE "m." IV_DOMAIN 
```

就令牌粘贴运算符而言，我认为建议使用令牌粘贴预处理器运算符的大多数答案实际上都没有尝试过 - 使用起来可能很棘手。

当您尝试使用`IV_SECURE`宏时，使用通常建议的答案会导致编译器错误，因为：

```
#define IV_SECURE "secure."##IV_DOMAIN 
```

扩展为：

```
"secure"domain.org 
```

您可能想尝试使用`'`#`' 'stringizing' 运算符：

```
#define IV_SECURE "secure." #IV_DOMAIN 
```

但这不起作用，因为它只适用于宏参数 - 而不仅仅是任何旧的宏。

使用标记粘贴 ('##') 或字符串化 ('#') 预处理运算符时要注意的一件事是，您必须使用额外的间接级别才能使它们在所有情况下都能正常工作。

如果您不这样做并且传递给令牌粘贴运算符的项目本身就是宏，您将获得可能不是您想要的结果：

```
#include <stdio.h>

#define STRINGIFY2( x) #x
#define STRINGIFY(x) STRINGIFY2(x)
#define PASTE2( a, b) a##b
#define PASTE( a, b) PASTE2( a, b)

#define BAD_PASTE(x,y) x##y
#define BAD_STRINGIFY(x) #x

#define SOME_MACRO function_name

int main() 
{
    printf( "buggy results:\n");
    printf( "%s\n", STRINGIFY( BAD_PASTE( SOME_MACRO, __LINE__)));
    printf( "%s\n", BAD_STRINGIFY( BAD_PASTE( SOME_MACRO, __LINE__)));
    printf( "%s\n", BAD_STRINGIFY( PASTE( SOME_MACRO, __LINE__)));

    printf( "\n" "desired result:\n");
    printf( "%s\n", STRINGIFY( PASTE( SOME_MACRO, __LINE__)));
} 
```

输出：

```
buggy results:
SOME_MACRO__LINE__
BAD_PASTE( SOME_MACRO, __LINE__)
PASTE( SOME_MACRO, __LINE__)

desired result:
function_name21 
```

因此，使用您的原始`IV_DOMAIN`定义和上面的实用宏，您可以这样做以获得您想要的：

```
// Sub-Domain
#define IV_SECURE "secure." STRINGIFY( IV_DOMAIN)   //secure.domain.org etc
#define IV_MOBILE "m." STRINGIFY( IV_DOMAIN) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-28T14:25:41.367

接下来的字符串由 C 编译器组合在一起。

```
#define DOMAIN "example.com"
#define SUBDOMAIN "test." DOMAIN
const char *asCString = SUBDOMAIN;
NSString *asNSString = @SUBDOMAIN; 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-28T14:40:04.033

我看到你的第一个问题有很多好的和正确的答案，但你的第二个问题没有，所以这里是：我认为这是一个糟糕的主意。为什么你必须重建你的软件（特别是发布版本）只是为了改变服务器名称？此外，您如何知道哪个版本的软件指向哪个服务器？您必须建立一种机制来在运行时进行检查。如果它在您的平台上完全可行，我建议您从配置文件中加载域/URL。为此目的，只有最小的嵌入式平台可能不“实用”:)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-28T14:23:26.803

尝试使用 ## 运算符

```
#define IV_SECURE secure.##IV_DOMAIN 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-28T14:29:36.630

您需要的是 # 和 ## 运算符以及自动字符串连接。

# 预处理运算符将宏参数转换为字符串。## 运算符将两个标记（例如宏参数）粘贴在一起。

我想到的可能性是

```
#define IV_DOMAIN domain.org
#define IV_SECURE(DOMAIN) "secure." #DOMAIN 
```

这应该将 IV_SECURE 更改为

```
#define IV_SECURE "secure." "domain.org" 
```

它将自动连接到“secure.domain.org”（假设翻译阶段在 C 中与 C++ 相同）。

另一个编辑：请阅读评论，这些评论显示了我是如何感到困惑的。请记住，我在 C 语言方面经验丰富，尽管可能有点生疏。我会删除这个答案，但我想我会把它作为一个例子来说明 C 预处理器是多么容易混淆。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-28T14:30:26.007

正如其他人所指出的，使用令牌粘贴。您还应该知道宏名称如

```
__TESTING 
```

在 C 中保留（不了解 Objective C）用于实现 - 您不得在自己的代码中使用它们。保留名称是包含双下划线以及以下划线和大写字母开头的任何名称。

# asp.net - 在 Firefox 中渲染 asp .net mvc 部分视图

> ID：798227
> 
> 赞同：0
> 
> 时间：2009-04-28T14:22:15.730
> 
> 标签：asp.net, asp.net-mvc

我使用 ASP.NET MVC 编写了一个应用程序，在这个应用程序中我有一个索引视图，它呈现多个部分视图。该应用程序在 IE 和 Google chrome 中运行良好，但在 Firefox 中似乎无法运行。Firefox 在渲染部分视图时是否有任何问题，或者我需要在代码中添加一些额外的东西吗？这是我的代码：

```
<div id="tabs">
    <ul class = "ui-tabs-nav">
        <li><a href="#tabs-1">Some stuff 1</a></li>
        <li><a href="#tabs-2">Some stuff 2</a></li>
        <li><a href="#tabs-3">Some stuff 3</a></li>
    </ul>

    <div id="tabs-1">
      <% Html.RenderPartial("PartialView1"); %>
  </div>

  <div id="tabs-2">
    <% Html.RenderPartial("PartialView2"); %>  
  </div>

  <div id="tabs-3">
    <% Html.RenderPartial("PartialView3"); %>         
  </div>

</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T14:24:40.730

浏览器根本不会“渲染”局部视图。在生成页面时，它会在正确的位置填充到*服务器的输出流中。*

很可能您有一些格式不正确的 HTML（元素交叉或未关闭），因此您在不同的浏览器上看到不同的东西。

更新：一目了然，我看不出您刚刚添加的那个示例有什么问题，但是您需要查看整个页面的源代码（在浏览器中），而不仅仅是一个片段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T14:33:01.803

检查你的 HTML 可能是你写了这样的脚本标签

```
<script type="text/javascript" /> 
```

它应该总是这样写：

```
<script type="text/javascript"></script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T14:28:45.090

jQuery-ui css 文件或 javascript 文件没有被正确引用可能是一些问题。也许您也可以发布该代码？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-29T06:43:12.610

哈，我终于解决了！愚蠢的我将脚本类型设置为 jscript 而不是 javascript：

```
<script type ="text/jscript"> 
```

代替

```
<script type ="text/javascript"> 
```

# php - PHP DOMDocument：loadHTMLFile 被一个神秘的字符窒息：RS

> ID：798232
> 
> 赞同：0
> 
> 时间：2009-04-28T14:23:29.860
> 
> 标签：php, special-characters, domdocument

使用 php 的 DOMDocument->LoadHTMLFile('test.html'); 继续向我返回错误，在第 36 行报告内容中的错误。删除一个又一个字符，结果发现这是一个明显的空白空间，这是罪魁祸首。在另一个编辑器（Editra）中复制/粘贴该句子，显示出一个奇怪的 RS 字符。

它是什么，更重要的是，我怎样才能避免它再次发生？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-28T14:25:46.890

这是一个[记录分隔符](http://en.wikipedia.org/wiki/Record_separator)

> 可用作分隔符来标记数据结构的字段。如果用于分层级别，US 是最低级别（划分纯文本数据项），而 RS、GS 和 FS 是递增级别，以划分由其下一级项组成的组。
> 
> SEQ：`^^`- 十二月：30 - 十六进制：1E - 首字母缩略词：RS

你可以做的是[`strtr()`](http://is.php.net/manual/en/function.strtr.php)用来去除不可见的字符。[Joel Degan 在 PHP.net 上的一个示例](http://is.php.net/manual/en/function.strtr.php#64108)应该可以帮助您上路。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T14:38:15.177

我记得，在这种情况下，PHP 抛出了一个非致命错误。它会抱怨很多事情，如果文件不是由您创建的，您将无能为力。您可以做的是使用不良的编程实践并通过在命令前加上 @ 来抑制错误。

```
@DOMDocument->LoadHTMLFile('test.html'); 
```

它仍应加载文件，但您将“忽略”错误。无知是福？

# asp.net - ASP.NET AJAX 进度条：从后面的代码更新？

> ID：798235
> 
> 赞同：5
> 
> 时间：2009-04-28T14:23:59.250
> 
> 标签：asp.net, .net, asp.net-ajax, progress-bar

我在应用程序中有一个 Excel 电子表格的导入功能。它现在使用 FileUpload 控件。我上传文件，然后对该文件运行操作。我想通知用户正在完成的操作以及完成的百分比。我认为我可以获取从 Excel 电子表格中提取的总行数，并在我将每条记录插入数据库并更新进度条时不断划分。

问题是我似乎找不到任何可以从 Code Behind 更新进度条的解决方案。我尝试使用[Matt Berseth 的解决方案](http://mattberseth.com/blog/2008/06/aspnet_ajax_progressbar_contro.html)。

看起来非常好，但我看不到它可以从代码背后工作。从理论上讲，我认为将值放入页面上的文本框中，并将 onchange 设置为 JavaScript 函数以设置百分比可以作为测试，但即使这样也没有给我想要的结果。

关于如何做到这一点的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-19T12:47:43.240

您应该知道的是，您无法使用标准 FileUpload 控件检查文件上传的状态。您可以做的是将文件上传到服务器上，然后使用 ODBC 连接到它，并开始异步读取和插入数据库中的行（通过向页面发出 ajax 请求或使用脚本服务）。

就进度条而言，您应该简单地使用 CSS 进度条（您可以在以下位置找到一个简单的示例：[http](http://css-tricks.com/examples/ProgressBars/) ://css-tricks.com/examples/ProgressBars/ ）。

然后，您应该使用可以从服务器返回进度状态的方法构建脚本服务（使用 Web 服务）：

您的 *.asmx 文件应包含以下内容：

```
[WebMethod]
public int GetStatus()
    {
        int progress = 0; // in percents
        // your server-side code here
        return progress;
    } 
```

您的 aspx 页面应包含以下内容：

```
<asp:ScriptManager runat="server" ID="ScriptManager">
 <Services>
    <asp:ServiceReference Path="~/services/import.asmx" InlineScript="false" />
 </Services>
</asp:ScriptManager> 
```

然后，您应该能够定期从 JavaScript 调用该方法（例如，每秒使用 setTimeout）并使用简单的 JavaScript 或 jQuery 更新进度条宽度：

```
var tout, service;

function UpdateStatus() {
    if (tout != null)
         clearTimeout(tout);

    if (service == null)
         service = new namespace.here.serice_class_here();

    service.GetStatus(onSuccess, onFailure);    
}

function onSuccess(result) {
    // update the width of the progress with result (the integer value of the progress)
    progress_bar.style.width = percent + "%";        

    // call the method again
    tout = setTimeout("UpdateStatus()", 1000);
}

function onFailure(error) {
    alert(error.get_message());
} 
```

您可以扩展您的 onSuccess JavaScript 函数，当进度完成时（返回值为 100%），您可以根据需要将用户重定向到另一个页面或显示信息或按钮。

我希望这有帮助！

# c# - 当程序崩溃而不显示错误时如何识别问题？

> ID：798239
> 
> 赞同：10
> 
> 时间：2009-04-28T14:24:28.187
> 
> 标签：c#, debugging, crash-dumps

请让我知道当我的应用程序崩溃并关闭显示包含“不发送”和“发送错误报告”按钮的对话框时我需要执行哪些步骤。

除了查看事件查看器来解决这个问题，我还能做什么？

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-28T14:48:33.200

1.  您可以在入口方法的主体周围添加一个`try/catch/finally`构造。`Main()`

2.  对于 WinForms，您可以`ThreadException`在 Application.Run() 之前添加一个处理程序，以捕获在 WinForms UI 事件处理程序中引发的异常：

    ```
    Application.ThreadException +=
       new ThreadExceptionEventHandler(Application_ThreadException); 
    ```

3.  可以使用以下方法捕获所有其他未处理的异常：

    ```
    AppDomain.CurrentDomain.UnhandledException +=
       new UnhandledExceptionEventHandler(CurrentDomain_UnhandledException); 
    ```

    但值得一提的是，这只允许您记录/报告异常 - 一旦退出此最终处理程序，您无法阻止应用程序关闭。

4.  Visual Studio 也可以配置为[在第一次机会异常时中断](https://stackoverflow.com/q/8218249/69809)，外部调试器（如带有托管 SoS 扩展的 WinDbg）也可以捕获第一次机会异常（[http://www.codeproject.com/KB/debug/windbg_part1.aspx](http://www.codeproject.com/KB/debug/windbg_part1.aspx)） .

此外，使用 log4net 之类的日志框架向您的应用程序添加有用的日志记录，并在应用程序关闭之前转储异常信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T14:35:02.500

询问您的用户是否可以重现错误以及如何重现。如果可以重现错误，请在 Visual Studio 中调试运行并按照导致崩溃的步骤操作。Visual Studio 将进入调试模式，在该模式下捕获错误。在那里，您将能够跟踪堆栈跟踪并查看导致错误的代码。Visual Studio 在大多数情况下使调试变得非常容易。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-28T14:39:40.197

理想情况下，您应该使用诸如[nLog](http://www.nlog-project.org/)或[log4net](http://logging.apache.org/log4net/index.html)之类的日志库来记录任何未处理的异常以及一般的异常，方法是在它们发生时将它们记录在您的代码中。

它还可以帮助在您的应用程序中设置不同级别的日志记录，以帮助您在开发机器上未运行时跟踪问题。使用 nLog，您可以将日志记录保留在生产代码中，并通过使用日志记录配置文件启用/禁用日志输出。

我没有使用过 log4net，所以我不知道它是否有类似的功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T14:46:08.650

当您在后台线程中有未处理的异常时，往往会发生“发送/不发送”错误（主线程将显示带有堆栈跟踪的继续/退出 .NET 对话框）。

将异常处理程序添加到线程的函数并从那里记录：

```
void RunMyThread()
{
    try
    {
        // background thread code
    }
    catch (Exception ex)
    {
        // Log the exception
    }
} 
```

这是高度简化的，可能不是您想要处理异常的方式。但希望这会让你朝着正确的方向前进。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T14:46:46.760

使用 WinDBG 调试问题。当抛出异常时，您可以使其中断（如在断点处停止），然后检查堆栈跟踪...范围内的对象等...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-28T15:11:07.560

如果它发生在客户站点，并且在开发人员调试器中不容易重现，您可以进行一些事后调试。我喜欢使用[Userdump](http://support.microsoft.com/kb/241215)来收集内存转储文件 (.DMP)。然后我使用windbg进行分析。

# language-agnostic - 衡量成功重构的指标

> ID：798243
> 
> 赞同：10
> 
> 时间：2009-04-28T14:25:28.653
> 
> 标签：language-agnostic, refactoring, agile, code-metrics

是否有衡量代码重构的客观指标？

在重构之前和之后运行 findbugs、CRAP 或 checkstyle 是否是检查代码是否真正得到改进而不是仅仅改变的有用方法？

我正在寻找可以确定和测试的指标，以帮助改进代码审查过程。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-28T14:27:18.633

失败的单元测试数必须小于或等于零:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-28T14:31:46.860

根据您的具体目标，[圈复杂度](http://en.wikipedia.org/wiki/Cyclomatic_complexity)等指标可以提供成功的指标。最后，每个指标都可能被颠覆，因为它们无法捕捉情报和/或常识。

不过，一个健康的代码审查过程可能会产生奇迹。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-28T14:50:36.317

> 在重构之前和之后运行 findbugs、CRAP 或 checkstyle 是否是检查代码是否真正得到改进而不是仅仅改变的有用方法？

实际上，正如我在[“代码度量的魅力是什么？”这个问题中所详述的那样。](https://stackoverflow.com/questions/195887/what-is-the-fascination-with-code-metrics/195932#195932)，任何指标（findbugs、CRAP 等）的**趋势**都是指标的真正附加值。
它（指标的演变）允许您**优先考虑**您真正需要对代码执行的主要修复操作（而不是盲目地尝试尊重那里的每个指标）

像[**Sonar**](http://sonar.codehaus.org/)这样的工具可以在这个领域（监控指标）非常有用。

* * *

萨尔在评论中补充道：

> 真正的问题是检查哪些代码更改会增加价值，而不仅仅是添加更改

为此，测试覆盖率非常重要，因为只有测试（单元测试，还有更大的“功能测试”）会给你一个有效的答案。
但是无论如何，重构都不应该在没有明确目标的情况下进行。仅仅因为它“更优雅”甚至“更易于维护”而这样做可能本身并*不足以*成为更改代码的充分理由。
应该有其他措施，例如将在此过程中修复的一些错误，或者由于“重构”代码而可以更快实现的一些新功能。
简而言之，重构的附加价值不仅仅用指标来衡量，还应该根据目标和/或里程碑进行评估。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-28T14:43:50.763

代码大小。在不破坏功能的情况下减少它的任何东西都是我书中的改进（当然，删除评论和缩短标识符不算数）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-28T14:45:58.213

不管你做什么，只要确保这个指标不用于​​评估程序员的表现、决定晋升或类似的事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-28T14:52:30.243

我会远离衡量重构成功的指标（除了#unit test failures == 0）。相反，我会选择代码审查。

找到明显的重构目标并不需要太多工作：“我以前没有见过完全相同的代码吗？” 对于其余部分，您应该针对不该做的事情制定一定的指导方针，并确保您的开发人员了解它们。然后他们将能够找到其他开发人员没有遵循标准的地方。

对于更高级别的重构，更高级的开发人员和架构师将需要根据他们看到代码库移动的位置来查看代码。例如，今天的代码具有静态结构可能是完全合理的；但是如果他们知道或怀疑需要更动态的结构，他们可能会建议使用工厂方法而不是使用*new*，或者从类中提取接口，因为他们知道下一个版本中会有另一个实现。

这些东西都不会从指标中受益。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-03-20T00:16:09.227

是的，代码质量的几个衡量标准可以告诉您重构是否提高了代码的质量。

*   **复制。**一般来说，重复越少越好。但是，我使用的重复查找器有时会识别出重复块，这些重复块只是在结构上相似，但在语义上彼此无关，因此不应进行重复数据删除。准备好压制或忽略那些误报。

*   **代码覆盖率。**这是迄今为止我最喜欢的指标，但它只是与重构间接相关。您可以并且应该通过编写更多测试来提高低覆盖率，但这不是重构。但是，您应该在重构时监视代码覆盖率（与对代码的任何其他更改一样）以确保它不会下降。重构可以通过删除重复代码的未经测试的副本来提高代码覆盖率。

*   **大小指标**，例如代码行数、总数和每个类、方法、函数等[。Jeff Atwood 的帖子](http://blog.codinghorror.com/a-visit-from-the-metrics-maid/)列出了更多。如果重构在保持清晰度的同时减少了代码行数，那么质量就会提高。异常长的类、方法等很可能是重构的好目标。准备好使用判断来确定类、方法等何时确实需要比平时更长的时间才能完成其工作。

*   **复杂度度量**，例如圈复杂度。重构应该尽量降低复杂性，而不是在没有经过深思熟虑的理由的情况下增加复杂性。具有高复杂性的方法/函数是很好的重构目标。

*   Robert C. Martin 的**[包装设计](/questions/tagged/package-design "显示标记为“包装设计”的问题")指标**：抽象性、不稳定性和与抽象性-不稳定性主序列的距离。他在[关于 C++ 报告中的稳定性的文章](https://drive.google.com/file/d/0BwhCYaYDn8EgZjI3OTU4ZTAtYmM4Mi00MWMyLTgxN2YtMzk5YTY1NTViNTBh/view)和他的书[敏捷软件开发、原则、模式和实践](https://rads.stackoverflow.com/amzn/click/com/0135974445)中描述了它们。[JDepend](https://github.com/clarkware/jdepend)是一种衡量它们的工具。改进包设计的重构应该最小化 D.

我已经使用并继续使用所有这些来监控我的软件项目的质量。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-02T00:26:31.630

您希望重构有两个结果。您希望团队保持可持续的步伐，并且希望生产中的缺陷为零。

在测试驱动开发 (TDD) 期间对代码和单元测试构建进行重构。重构可以很小，并且可以在完成故事卡所需的一段代码上完成。或者，重构可能很大，需要一张技术故事卡来解决技术债务。故事卡可以放在产品待办列表中，并与业务合作伙伴一起确定优先级。

此外，当您像编写 TDD 一样编写单元测试时，随着代码的开发，您将继续重构测试。

请记住，在敏捷中，SCRUM 中定义的管理实践将为您提供协作，并确保您了解业务合作伙伴的需求，并且您开发的代码满足业务需求。但是，如果没有适当的工程实践（如极限编程所定义），您的项目将失去可持续的步伐。许多没有采用工程实践的敏捷项目需要救援。另一方面，一个纪律严明并采用管理和工程敏捷实践的团队能够无限期地维持交付。

因此，如果您的代码发布时存在许多缺陷，或者您的团队失去了速度、重构和其他工程实践（TDD、配对、自动化测试、简单的进化设计等），则没有得到正确使用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-03-20T20:30:51.280

我从气味的角度来看问题。气味可以被视为质量问题的指标，因此，识别出的气味实例的数量可以揭示软件代码的质量。

气味可以根据其粒度和潜在影响进行分类。例如，可能有实现气味、设计气味和架构气味。您需要在之前和之后识别所有粒度级别的气味，以显示重构练习的收益。事实上，重构可以通过已识别的气味来指导。

**例子：**

*   **实现异味：**长方法、复杂条件、缺少默认情况、复杂方法、长语句和幻数。
*   **设计异味：**多方面抽象、缺少抽象、封装不足、未开发封装、类集线器模块化、循环依赖模块化、宽层次和破碎层次。更多关于设计气味的信息可以在[本书](http://bit.ly/DesignSmells)中找到。
*   **架构异味：**缺少层、包中的循环依赖、违反层、不明确的接口和分散的寄生功能。[在此处](http://softarch.usc.edu/~josh/pubs/qosa_2009.pdf)查找有关架构气味的更多信息。

# asp.net - 在 Application_Start 期间读取应用程序配置

> ID：798244
> 
> 赞同：3
> 
> 时间：2009-04-28T14:25:28.780
> 
> 标签：asp.net, optimization, global-asax

考虑一个动态调整大型 tiff 文件大小的 Web 应用程序。当用户调用操作时，每个大的 tiff 文件都会被调整为 jpg 缩略图和更大的 jpg。这些转换后的文件的尺寸始终相同。

在昨天的代码审查中，其他一位开发人员问我为什么要在 global.asax 中设置这些维度，如下所示：

```
 Application["resizedImageWidth"] = int.Parse(ConfigurationManager.AppSettings["ResizedImageWidth"]); 
```

，而不仅仅是在实际方法调用期间通过配置文件查找值。如果最终用户在测试应用程序后想要更改尺寸，我将宽度存储在配置文件中，这样我就不必更改内联代码。

我给出的理由是防止每次生成图像时从配置文件中读取，但无法回答在查找应用程序级别变量期间是否存在类似的开销。这种优化可能不会大规模影响性能，但我想知道社区认为更有效的解决方案是什么，即在应用程序启动期间设置它们，或者在方法调用期间动态读取它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T14:31:33.757

通常，您应该根据需要即时读取配置。该框架将缓存配置文件，因此它的性能相当不错。而且我相信（不要引用我的话）ASP.Net 可以监视并将更改引入配置文件，而无需重新启动应用程序。

我通常喜欢创建一个配置类，它将隐藏值存储位置的详细信息：

```
public static class Config
{

   public static int GetXDimension()
   {
      ...
   }

} 
```

这使您的调用代码与配置代码保持干净，如果您发现我错了，您不必到处更改代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-06T20:15:55.853

将此值存储在 Application 对象中是正确的。*事实上，这就是提供Application*背后的明确目的：保存在应用程序的所有页面和用户中都可用的值。

由于应用程序设置保存在内存中，它确实会更高效。很明显，从内存读取比从配置文件读取要快得多（更不用说通过 ConfigurationManager.AppSettings 类方法和整数解析进行查找）。

*对 web.config 文件的任何*更改都会导致应用程序重新启动。事实上，这就是我在测试期间重新启动应用程序（在需要时）的方式。如果您需要“即时”更改此值，您甚至可能希望将此值存储在数据库的“配置”表中，而不是将其保存在 Web.config 文件中，以便更改它不会重新启动应用程序。

我使用的一个技巧类似于 Josh 的 Config 类：我有一个“BusinessLogic”类，我在该类的静态变量中放置了少量设置，以便我可以以类型安全的方式访问它们。这并不难，而且在可读性方面的回报非常明显。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-06T20:21:25.263

我建议扩展 Josh 的答案并按需调用它，然后将其缓存到私有变量中：

```
public static class Config
{
   private static int? xDimension;
   public static int GetXDimension()
   {
      if(xDimension == null)
          xDimension = int.Parse(ConfigurationManager.AppSettings["ResizedImageWidth"]);
      return xDimension.Value;
   }
} 
```

或进入应用程序：

```
public static class Config
{
   public static int GetXDimension()
   {
      if(Application["xDimension"] == null)
          Application["xDimension"] = int.Parse(ConfigurationManager.AppSettings["ResizedImageWidth"]);
      return (int)Application["xDimension"];
   }
} 
```

# javascript - 按范围划分的 jQuery 验证字段

> ID：798250
> 
> 赞同：4
> 
> 时间：2009-04-28T14:25:51.163
> 
> 标签：javascript, jquery

如何按范围验证字段？

我使用附加方法，但我不知道如何通过 HTML 为我的验证方法提供参数范围。

有点像
`<input type="text" class="rangeField" rel="[10, 20]" />`

很好，如果我可以在验证中区分整数和小数。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-28T14:34:35.217

你在使用[验证](http://docs.jquery.com/Plugins/Validation/Methods/range#range)插件吗？这个插件使得验证一个范围变得很简单。

```
$("#myform").validate({
  rules: {
    field: {
      required: true,
      range: [13, 23]
    }
  }
});

<input type="text" id="myrange" name="myrange" class="field" /> 
```

# php - 到底是什么导致了这个 PHP 错误？PHP中的错误？

> ID：798256
> 
> 赞同：0
> 
> 时间：2009-04-28T14:26:46.153
> 
> 标签：php, debugging

我收到以下错误：

```
[27-Apr-2009 10:26:06] PHP Fatal error:  Cannot redeclare alphanumeric() (previously declared in /home/iddoc/public_html/lib/common.php:6) in /home/iddoc/public_html/lib/common.php on line 8 
```

请注意：

```
/home/iddoc/public_html/lib/common.php:6) in 
/home/iddoc/public_html/lib/common.php on line 8 
```

以下是违规行：

```
function alphanumeric($str) {
    return strtolower(preg_replace("/[^A-Za-z0-9]/",'',$str));
} 
```

在这些行之前只有注释。该文件或任何其他文件中的其他任何地方都没有该函数的其他声明。

奇怪，不是吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-28T14:29:34.557

您是否使用 require_once() 在任何地方包含 common.php？如果您只使用 require 或 include，则会导致此问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-28T14:30:36.987

您是否使用`require`/`include`来引用文件？这是包含两次文件时的常见错误。如果 PHP 看到两个声明，即使它们来自同一个文件，它也不知道该怎么做。

尝试使用这个：

```
include_once('lib/common.php'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-28T14:33:10.540

看起来您可能不止一次包含了 common.php 文件。第二次加载会导致类似的错误，因为该函数已经加载。

这是一个奇怪的错误，但一旦发现问题，它可能看起来合乎逻辑。我建议查看您的包含，或将它们切换到 include_once。也许在该函数加载之前查看 debug_print_backtrace() 输出。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T14:32:52.100

听起来您不止一次包含了 common.php 文件。您是否使用 include()、require() 或 require_once() 进行包含？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-28T14:45:38.950

这个 common.php 是否包含在前面？这可能会导致此错误。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-28T15:07:17.227

在 PHP 中包含代码文件时，应始终使用 include_once 或 require_once。此规则有例外，但如果您不确定，请使用 _once 版本。唯一可以使用 include 或 require 的情况是，当您知道文件永远不会再次包含在同一个程序中，或者被包含的文件没有声明函数（没有用 if (function_exists()) 保护它们时} 堵塞）。

例如，模板系统是您可能不想要 _once 版本的极少数用途之一。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-28T14:31:11.807

检查递归包含并确保您的块没有多次执行。

# powershell - 哪些对象适合添加成员？

> ID：798258
> 
> 赞同：6
> 
> 时间：2009-04-28T14:27:00.710
> 
> 标签：powershell, powershell-2.0

文档指出：

> 将用户定义的自定义成员添加到 Windows PowerShell 对象的实例。

“Windows PowerShell 对象”代表什么？

这工作正常：

```
$obj = new-object system.object
$obj | add-member -membertype noteproperty -name Name -value "OK"
$obj.name 
```

但这不会：

```
$obj = @{} 
```

实际上，我正在尝试将属性添加到 $error[0]。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-29T03:48:21.633

PowerShell 有所谓的 PSObject，它是任何 .NET 对象的包装器（或者它可以是完全自定义的对象），当您调用 Add-Member 时，PowerShell 会用 PSObject 隐式包装真实的 .NET 对象。

Add-Member 的工作方式取决于您是否从 PSObject 开始。如果您没有从 PSObject 开始，则 Add-Member 会将输入包装在 PSObject 中，您需要重新分配变量才能看到适应的对象。

例如：

```
$x = [Environment]::OSVersion
$x | Add-Member NoteProperty IsVista $true
$x | Format-List   # does not show the new property 
```

这是因为未包装的 OSVersion 是一个 PSObject。Add-Member 确实包装了它，但是该包装器丢失了，因为您没有将 $x 重新分配给包装的对象。与此行为对比：

```
$x = New-Object OperatingSystem ('Win32NT', '6.0')
$x | Add-Member NoteProperty IsVista $true
$x | Format-List   # DOES show the new property 
```

这是因为 New-Object 隐式地​​将新实例包装在 PSObject 中。因此，您的 Add-Member 调用正在将成员添加到现有包装器中。

回到第一个示例，您可以通过将其更改为：

```
$x = [Environment]::OSVersion
$x = $x | Add-Member NoteProperty IsVista $true -PassThru
$x | Format-List   # DOES show the new property 
```

现在毕竟，Hashtable 不能按您期望的方式工作的原因是因为 Hashtables 被 PowerShell 特殊对待，基本上 Hashtables 的适配器使用键作为属性（有点）并且 Add-Member 不会按预期工作用这种物体。

# c# - 使用 SSL 在 C# 中调用 Web 服务 - '(401) Unauthorized'

> ID：798266
> 
> 赞同：2
> 
> 时间：2009-04-28T14:29:16.303
> 
> 标签：c#, web-services, ssl, http-status-code-401, unauthorized

我正在使用以下代码从代理服务器后面调用 Web 服务上的方法：

```
myWebService.TestWebService webservice = new myWebService.TestWebService();
webservice.Url = "http://test.com/webservice?wsdl";

WebProxy proxy = new WebProxy("1.2.3.4", 8080);
proxy.Credentials = new NetworkCredential("username", "password");
webservice.Proxy = proxy;

string response = webservice.TestWebMethod(); 
```

这在使用 HTTP 时效果很好，我在“响应”字符串中得到了我期望的响应。但是 - 如果我将 URL 更改为**HTTPS** ，那么我会收到*(401) Unauthorized*响应。

**如果我将 URL 放入我的浏览器，它可以使用 HTTP 或 HTTPS 正常工作**。

我添加了代码来通过创建一个`System.Net.ServicePointManager.ServerCertificateValidationCallback`委托来处理 SSL 证书验证，但代码从来没有走到这一步。该请求在验证证书之前被拒绝，或者看起来如此。

任何帮助都非常感谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T14:52:57.463

您是否需要凭据才能导航到 SSL 网址？
*如果是这样，您需要设置 Web 服务凭据。*

您是否尝试过使用 SSL url 在 Visual Studio 中添加 Web 引用？
*如果您无法通过 Visual Studio 添加 Web 引用，那么代码也无法正常工作。*

您能否确保您设置的最后一件事是代理（例如，在设置代理之前更改 url）？
*代理丢失的可能性很小，这应该是最后尝试的事情*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T15:24:03.973

这是一个使用客户端证书的示例（我确定您不需要），但可能会提供一些见解并使用 Web 服务的凭据。

```
WebService.ManageOutboundDelivery oWS = new WebService.ManageOutboundDelivery();

if (My.Settings.HasClientCert == true) {
    X509Certificate2 signedCert = new X509Certificate2(HttpContext.Current.Server.MapPath(My.Settings.ClientCertName), My.Settings.ClientCertPW);
    oWS.ClientCertificates.Add(signedCert);
}

System.Net.CredentialCache oCred = new System.Net.CredentialCache();
Net.NetworkCredential netCred = new Net.NetworkCredential(My.Settings.WebServiceUID, My.Settings.WebServicePW);

oCred.Add(new Uri(oWS.Url), "Basic", netCred);
oWS.Credentials = oCred; 
```

您是否还检查过 SSL 证书是否有效 - 我猜您在通过浏览器点击它时会看到这一点，但它可能会导致尝试以编程方式点击它时出现问题。

# sharepoint - 共享点工作流

> ID：798267
> 
> 赞同：0
> 
> 时间：2009-04-28T14:29:24.900
> 
> 标签：sharepoint

我是这个共享点开发的新手，我手头有以下任务。1.当一个新的文档添加到库中时，系统会从数据库表中提示审批者和受众。这将被存储以供将来对文档进行修订。2\. 分配审批人成功完成后，观众系统将启动工作流程以完成审批流程。

如果有人可以指出执行以下操作的方向，那就太好了： 1.是否可以从文档库插入/更新事件中调用 aspx 页面/表单？2.如何以编程方式将审批者分配给工作流？

提前致谢！亚历克斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T20:59:06.757

1.  我不确定是否可以显式调用另一个页面，但您可以使用“Source”url 参数来指定他们在按下 OK 后被定向到的页面。显然，您必须将“www.google.com”更改为您的新 URL。

    /Lists/Announcements/NewForm.aspx?Source=www.google.com

2.  您可能可以使用自定义工作流程来完成所有这些工作。使用自定义工作流，您有两个选择：在 Visual Studio 中创建整个工作流或创建自定义工作流操作以及使用 SharePoint Designer 构建工作流。

[构建自定义工作流操作。](http://www.johnholliday.net/post/2007/03/27/Add-Your-Own-Custom-Workflow-Activities-to-SharePoint-Designer-2007.aspx)

# xslt - XSLT 连接字符串，删除最后一个逗号

> ID：798269
> 
> 赞同：29
> 
> 时间：2009-04-28T14:29:27.647
> 
> 标签：xslt, concatenation

我需要使用 XSLT 构建一个字符串，并用逗号分隔每个字符串，但在最后一个字符串之后不包含逗号。在下面的示例中，如果我有 Distribution 节点而不是 Note 节点，我将有一个尾随逗号。无论如何，我不知道将字符串构建为变量，然后截断 XSLT 中的最后一个字符。这也是使用 Microsoft XSLT 引擎。

我的字符串 =

```
<xsl:if test="Locality != ''">
  <xsl:value-of select="Locality"/>,
</xsl:if>
<xsl:if test="CollectorAndNumber != ''">
  <xsl:value-of select="CollectorAndNumber"/>,
</xsl:if>
<xsl:if test="Institution != ''">
  <xsl:value-of select="Institution"/>,
</xsl:if>
<xsl:if test="Distribution != ''">
  <xsl:value-of select="Distribution"/>,
</xsl:if>
<xsl:if test="Note != ''">
  <xsl:value-of select="Note"/>
</xsl:if> 
```

[伙计，必须有更好的方法进入这个问题文本框:( ]

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-04-28T16:22:54.440

**使用 XSLT 很容易做到这一点**（*无需在变量中捕获结果，或使用特殊的命名模板*）：

**一、XSLT 1.0**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

    <xsl:template match="/*/*">
      <xsl:for-each select=
      "Locality/text() | CollectorAndNumber/text()
     | Institution/text() | Distribution/text()
     | Note/text()
      "
      >
        <xsl:value-of select="."/>
        <xsl:if test="not(position() = last())">,</xsl:if>
      </xsl:for-each>
    </xsl:template>
</xsl:stylesheet> 
```

当此转换应用于以下 XML 文档时：

```
<root>
    <record>
        <Locality>Locality</Locality>
        <CollectorAndNumber>CollectorAndNumber</CollectorAndNumber>
        <Institution>Institution</Institution>
        <Distribution>Distribution</Distribution>
        <Note></Note>
        <OtherStuff>Unimportant</OtherStuff>
    </record>
</root> 
```

**产生了想要的结果**：

```
Locality,CollectorAndNumber,Institution,Distribution 
```

**如果想要的元素不应该按文档顺序生成**（问题中不需要，但由 Tomalak 提出），**那么实现这一点仍然非常容易和优雅：**

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="text"/>

    <xsl:param name="porderedNames"
     select="' CollectorAndNumber Locality Distribution Institution Note '"/>

    <xsl:template match="/*/*">
        <xsl:for-each select=
         "*[contains($porderedNames, concat(' ',name(), ' '))]">

         <xsl:sort data-type="number"
          select="string-length(
                     substring-before($porderedNames,
                                      concat(' ',name(), ' ')
                                      )
                                )"/>

            <xsl:value-of select="."/>
            <xsl:if test="not(position() = last())">,</xsl:if>
        </xsl:for-each>
    </xsl:template>
</xsl:stylesheet> 
```

*此处，所需元素的名称及其所需顺序在字符串参数中提供`$porderedNames`，其中包含所有所需名称的空格分隔列表*。

**当上述转换应用于同一个 XML 文档时，会产生想要的结果**：

```
CollectorAndNumber,Locality,Distribution,Institution 
```

* * *

**二、XSLT 2.0**：

在 XSLT 中，这个任务更加简单（*同样，不需要特殊函数*）：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

    <xsl:template match="/*/*">
    <xsl:value-of separator="," select=
    "(Locality, CollectorAndNumber,
     Institution, Distribution,
     Note)[text()]" />
    </xsl:template>
</xsl:stylesheet> 
```

**当将此转换应用于同一个 XML 文档时，会产生相同的正确结果**：

```
Locality,CollectorAndNumber,Institution,Distribution 
```

**请注意**，所需的元素将以任何所需的顺序生成，因为我们使用的是 XPath 2.0 序列类型（与 XSLT 1.0 解决方案中的并集相比），根据定义，它包含任何所需（指定）顺序的项目。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-28T15:34:24.493

我更喜欢一个简短的调用模板来将节点值连接在一起。如果您的串联列表中间的一个节点（例如`Institution`）丢失，这也有效：

```
<xsl:template name="join">
    <xsl:param name="list" />
    <xsl:param name="separator"/>

    <xsl:for-each select="$list">
        <xsl:value-of select="." />
        <xsl:if test="position() != last()">
            <xsl:value-of select="$separator" />
        </xsl:if>
    </xsl:for-each>
</xsl:template> 
```

这是一个如何使用它的简短示例：

### 示例输入文档：

```
<?xml version="1.0" encoding="utf-8"?>
<items>
  <item>
    <Locality>locality1</Locality>
    <CollectorAndNumber>collectorAndNumber1</CollectorAndNumber>
    <Distribution>distribution1</Distribution>
    <Note>note1</Note>
  </item>
  <item>
    <Locality>locality2</Locality>
    <CollectorAndNumber>collectorAndNumber2</CollectorAndNumber>
    <Institution>institution2</Institution>
    <Distribution>distribution2</Distribution>
    <Note>note2</Note>
  </item>
  <item>
    <Locality>locality3</Locality>
    <CollectorAndNumber>collectorAndNumber3</CollectorAndNumber>
    <Institution>institution3</Institution>
    <Distribution>distribution3</Distribution>
  </item>
</items> 
```

### XSL 转换：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes"/>

  <xsl:template match="/">
    <summary>
      <xsl:apply-templates />
    </summary>
  </xsl:template>

  <xsl:template match="item">
    <item>
      <xsl:call-template name="join">
        <xsl:with-param name="list" select="Locality | CollectorAndNumber | Institution | Distribution | Note" />
        <xsl:with-param name="separator" select="','" />
      </xsl:call-template>
    </item>
  </xsl:template>

  <xsl:template name="join">
    <xsl:param name="list" />
    <xsl:param name="separator"/>

    <xsl:for-each select="$list">
      <xsl:value-of select="." />
      <xsl:if test="position() != last()">
        <xsl:value-of select="$separator" />
      </xsl:if>
    </xsl:for-each>
  </xsl:template>
</xsl:stylesheet> 
```

### 生成的输出文件：

```
<?xml version="1.0" encoding="utf-8"?>
<summary>
  <item>locality1,collectorAndNumber1,distribution1,note1</item>
  <item>locality2,collectorAndNumber2,institution2,distribution2,note2</item>
  <item>locality3,collectorAndNumber3,institution3,distribution3</item>
</summary> 
```

注意：如果您使用的是 XSLT/XPath 2.0，那么会有[fn:string-join](http://www.w3.org/TR/2002/WD-xquery-operators-20021115/#func-string-join)

```
fn:string-join**($operand1 as string*, $operand2 as string*) as string 
```

可以按如下方式使用：

```
fn:string-join({Locality, CollectorAndNumber, Distribution, Note}, ",") 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-28T15:18:11.023

假设您有类似以下输入 XML 的内容：

```
<root>
  <record>
    <Locality>Locality</Locality>
    <CollectorAndNumber>CollectorAndNumber</CollectorAndNumber>
    <Institution>Institution</Institution>
    <Distribution>Distribution</Distribution>
    <Note>Note</Note>
    <OtherStuff>Unimportant</OtherStuff>
  </record>
</root> 
```

然后这个模板会这样做：

```
<xsl:stylesheet
    version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
>

  <xsl:output method="text" />

  <xsl:template match="record">
    <xsl:variable name="values">
      <xsl:apply-templates mode="concat" select="Locality" />
      <xsl:apply-templates mode="concat" select="CollectorAndNumber" />
      <xsl:apply-templates mode="concat" select="Institution" />
      <xsl:apply-templates mode="concat" select="Distribution" />
      <xsl:apply-templates mode="concat" select="Note" />
    </xsl:variable>

    <xsl:value-of select="substring($values, 1, string-length($values) - 1)" />
    <xsl:value-of select="'&#10;'" /><!-- LF -->
  </xsl:template>

  <xsl:template match="Locality | CollectorAndNumber | Institution | Distribution | Note" mode="concat">
    <xsl:value-of select="." />
    <xsl:text>,</xsl:text>
  </xsl:template>

</xsl:stylesheet> 
```

我的系统上的输出：

```
Locality,CollectorAndNumber,Institution,Distribution,Note 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-02-28T14:49:50.393

我认为可能有用的是，当我使用过滤某些节点的复杂选择时， position() 无法正常工作，在这种情况下，我想出了这个技巧：

您可以定义一个保存节点值的字符串变量，由特定字符分隔，然后使用 str:tokenize() 您可以创建一个完整的节点列表，该列表的位置可以正常工作。

像这样的东西：

```
<!-- Since position() doesn't work as expected(returning node position of current 
node list), I got round it by a string variable and tokenizing it in which 
absolute position is equal to relative(context) position. -->
<xsl:variable name="measObjLdns" >
    <xsl:for-each select="h:measValue[@measObjLdn=$currentMeasObjLdn]/h:measResults" >
        <xsl:value-of select="concat(.,'---')"/> <!-- is an optional separator. -->
    </xsl:for-each>
</xsl:variable>

<xsl:for-each select="str:tokenize($measObjLdns,'---')" ><!-- Since position() doesn't 

work as expected(returning node position of current node list), 
I got round it by a string variable and tokenizing it in which
absolute position is equal to relative(context) position. -->

    <xsl:value-of select="."></xsl:value-of>
    <xsl:if test="position() != last()">
        <xsl:text>,</xsl:text>
    </xsl:if>
</xsl:for-each>
<xsl:if test="position() != last()">
    <xsl:text>,</xsl:text>
</xsl:if> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-28T14:41:11.207

你没有永远存在的价值吗？如果你这样做了，那么你可以把它转过来，把逗号放在除第一个项目之外的所有东西的前面（这将是你一直存在的价值）。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2009-04-28T15:06:18.523

这会有点混乱，但如果你的示例中只有几个元素，则可能会奏效：

```
<xsl:if test="Locality != ''">
    <xsl:value-of select="Locality"/>
    <xsl:if test="CollectorAndNumber != '' or Institution != '' or Distribution != '' or Note != ''">
        <xsl:value-of select="','"/>
    </xsl:if>
</xsl:if>
<xsl:if test="CollectorAndNumber != ''">
    <xsl:value-of select="CollectorAndNumber"/>
    <xsl:if test="Institution != '' or Distribution != '' or Note != ''">
        <xsl:value-of select="','"/>
    </xsl:if>
</xsl:if>
<xsl:if test="Institution != ''">
    <xsl:value-of select="Institution"/>
    <xsl:if test="Distribution != '' or Note != ''">
        <xsl:value-of select="','"/>
    </xsl:if>
</xsl:if>
<xsl:if test="Distribution != ''">
    <xsl:value-of select="Distribution"/>
    <xsl:if test="Note != ''">
        <xsl:value-of select="','"/>
    </xsl:if>
</xsl:if>
<xsl:if test="Note != ''">
    <xsl:value-of select="Note"/>
</xsl:if> 
```

# asp.net-mvc - 为什么 MVC 为完整视图和部分视图寻找 .aspx 和 .ascx？

> ID：798278
> 
> 赞同：4
> 
> 时间：2009-04-28T14:30:42.073
> 
> 标签：asp.net-mvc, asp.net-mvc-partialview

我刚刚被一个问题所困扰，我有一个视图 (FindUser.aspx) 试图呈现部分视图 (FindUser.ascx)。视图的默认搜索路径会在各种文件夹中查找以视图命名的文件。相当令人惊讶的是，对于视图，它会查找扩展名为 .aspx 或 .ascx 的文件。部分视图使用相同的列表。

因为我得到了两个同名文件，所以视图分辨率反复先找到页面，陷入死循环。

我知道我可以通过调用视图和局部视图的不同名称来解决此问题，或者将我的搜索位置更改为仅用于视图的 .aspx 和仅用于局部视图的 .ascx。

我的问题是为什么 MVC 默认同时查看这两个扩展？视图 == 页面 == .aspx 和部分视图 == 控件 == .ascx 似乎更有意义。那为什么要把水搅浑呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T14:36:39.017

因为偏或不偏，一个视图仍然是一个视图。拥有 FindUser.aspx 和 FindUser.ascx 与拥有两个同名的常规视图相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T15:53:54.730

我认为避免您遇到的问题的方法是使用不同的视图名称。您可能不应该有两个文件名仅在扩展名上不同的视图。但是，如果您真的想要一个严格的 Page = View, Control = Partial 映射，只需通过从 WebFormViewEngine 继承来创建自己的 ViewEngine 并更改视图位置格式：

```
public class MyWebFormViewEngine : WebFormViewEngine {
    public MyWebFormViewEngine() {
        base.ViewLocationFormats 
          = new string[] {"~/Views/{1}/{0}.aspx", "~/Views/Shared/{0}.aspx" };
        base.PartialViewLocationFormats 
          = new string[] { "~/Views/{1}/{0}.ascx", "~/Views/Shared/{0}.ascx" };
    }
} 
```

然后在 Application_Start() 中将其配置为您的视图引擎：

```
// Call this method during Application_Start to setup your view engine
internal static void SetupViewEngines() {
    ViewEngines.Engines.Clear();
    ViewEngines.Engines.Add(new MyWebFormViewEngine());
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T15:53:46.443

您可以在渲染视图时为 MVC 提供直接路径。假设我的`Foo.aspx`文件`Home`夹中有一个，`Foo.ascx`而`Shared`. 在您的操作方法中，您可以执行以下任一操作：

```
return View("~/Views/Shared/Foo.ascx"); // or
return View("~/Views/Home/Foo.aspx"); 
```

它会得到你正在寻找的合适的人。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T14:38:43.770

值得我将“Control”附加到我所有的 .ascx ViewUserControls 的名称中。所以我会有`FindUser.aspx`和`FindUserControl.ascx`。不能解决问题，但可以通过避免命名冲突来帮助您避免它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-14T15:18:17.100

如果您使用的是区域，则必须在构造函数中添加额外的 LocationFormats：

```
public class ExtensionBasedWebFormViewEngine : WebFormViewEngine
{
  public ExtensionBasedWebFormViewEngine()
  {
     ViewLocationFormats = new[] {"~/Views/{1}/{0}.aspx", "~/Views/Shared/{0}.aspx"};
     AreaViewLocationFormats = new[] {"~/Areas/{2}/Views/{1}/{0}.aspx", "~/Areas/{2}/Views/Shared/{0}.aspx"};

     PartialViewLocationFormats = new[] {"~/Views/{1}/{0}.ascx", "~/Views/Shared/{0}.ascx"};
     AreaPartialViewLocationFormats = new[] { "~/Areas/{2}/Views/{1}/{0}.ascx", "~/Areas/{2}/Views/Shared/{0}.ascx" };
  }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-29T08:20:35.543

**原因**
视图 == ASP.NET MVC 中的 UserControl。

**修复**
使用不同的名称。

**提示**
使用下划线前缀命名用户控件的常见约定。

# c# - 从 winforms 捕获 ASP.NET 网页中的错误

> ID：798280
> 
> 赞同：2
> 
> 时间：2009-04-28T14:31:06.673
> 
> 标签：c#, asp.net, winforms

我正在编写一个 WinForms 应用程序，它将执行一些在 Web 测试框架中编写的 Web UI 测试。

有没有一种方法可以在不截屏页面的情况下获取正在测试的页面上的错误（我通过方法参数指定页面）？例如，如果它抛出：

从客户端检测到潜在危险的 Request.QueryString 值

我怎样才能检测到这个？

### 编辑：

一种方法是只刮掉标题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T14:37:18.080

我实际上建议您研究一下名为[ELMAH](http://www.google.com/url?sa=t&source=web&ct=res&cd=2&url=http%3A%2F%2Fwww.raboof.com%2Fprojects%2FElmah%2F&ei=RRT3ScDLGN2rtgfXpfHsDw&usg=AFQjCNFyk56CNO6ygf7egvf8Qmv1DLrw4g)的东西。如果您将 ELMAH 放在您的 ASP.NET 网站上，它将自动记录并处理您的应用程序在测试时抛出的所有异常。您可以让它将所有内容存储为 XML 文件或数据库中。您也可以让它直接通过电子邮件向您发送一份黄屏死机（包括堆栈跟踪）。

这对您来说会容易得多，然后尝试将相同的功能编程到您的 winforms 应用程序中。只需使用您的应用程序来击败 ASP.NET 站点并让 ELMAH 处理错误日志记录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T14:39:11.960

在应用程序级别捕获错误（使用 .asax 中的全局处理程序）并将异常数据发送到数据库怎么样？然后您可以查询。
嗯，甚至是实现 WCF 双重绑定，当发生错误时，您调用客户端侦听。您的 Windows 窗体可以成为等待通知的代理。但也许，这可能不是一个好主意，因为您希望将您的测试与您的应用程序分开。使用 Enterprise library 之类的东西登录到 MSMQ，您可以通过 windows 窗体监听它呢？

编辑 - 上面的 ELMAH 建议看起来也不错

# .net - 使用 WIX 安装自我更新应用程序？

> ID：798286
> 
> 赞同：21
> 
> 时间：2009-04-28T14:32:02.990
> 
> 标签：.net, installation, wix, bootstrapping

我正在编写一个需要安装在大量桌面上并且还需要自行更新的应用程序。我们正在寻找用于创建安装的 WIX。我使用了 ClickOnce，它不是这个安装的好解决方案。WIX 似乎很合适，但我发现没有很好的自动更新过程。

我看过[ClickThrough](http://wix.sourceforge.net/ctvision.html)，但它似乎还没有准备好迎接黄金时段。有没有人有另一个很好的解决方案可以与 WIX（或者可能是另一个安装程序）一起使用来自动更新应用程序安装？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-07T04:59:10.500

是的，ClickThrough 确实是您在这里寻找的。里面有一些零碎的东西。您也许可以剖析代码并自己使用它，而无需所有额外的“UI + 构建集成”。大多数错误都在更高级别。在根目录下，RSS 更新和可执行引导程序工作正常。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-28T15:38:00.023

它必须如何“自动”更新？:-)

我们将 WiX (2.0) 用于需要反复安装的应用程序。只要您从一个版本到另一个版本进行“重大升级”，就可以正常工作-您可以卸载旧版本，然后重新安装新版本-这里没有大问题。

关键是要有一个永不改变的稳定“UpgradeCode”（WiX 中的 GUID）——它是你的应用程序的关键——并且每个版本都有一个新的 ProductCode。

然后，在您的 wxs 文件中，您需要两个位：

```
<Upgrade Id='--your-updatecode-GUID-here--'>
    <UpgradeVersion MigrateFeatures='yes' RemoveFeatures='ALL' />
</Upgrade>

<InstallExecuteSequence>
  <RemoveExistingProducts After='InstallInitialize' />
</InstallExecuteSequence> 
```

应该这样做！

除此之外 - 没什么好说的 - 它只是有效:-)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-28T23:36:54.677

Windows Installer 并不是真正为“自我更新”软件而设计的。如果您不需要 MSI，或者真的需要应用程序“拉”它自己的更新，那么使用[NSIS](http://nsis.sf.net/)或其他工具并编写您自己的更新例程/服务。

但是，如果它安装在单个组织内的大量桌面上，那么更好的解决方案是通过 Active Directory 部署 MSI。然后，您可以使用组策略“推出”更新。这将比任何自我更新的应用程序更强大。

# php - MySQL/PHP 连接错误，可能是用户捏造的

> ID：798288
> 
> 赞同：3
> 
> 时间：2009-04-28T14:32:10.963
> 
> 标签：php, mysql

我负责维护一个学习管理系统，这是我在过去几个月里断断续续地处理的一个问题。

一名学生（数千名）声称他提交的论文被网站“吃掉”了。提交表格后，他说他的文章已被以下文本取代：

> 警告：mysql_connect() [function.mysql-connect]：在“读取初始通信数据包”时丢失与 MySQL 服务器的连接，系统错误：第 84 行 /home/web/solomon_1.3/classes/db.class.php 中的 111
> 
> 致命错误：连接到数据库服务器时出错：在第 85 行的 /home/web/solomon_1.3/classes/db.class.php 中

前面的警告和致命错误作为他的提交存储在数据库中。但这怎么可能，因为错误清楚地表明无法建立连接？论文提交页面几乎是最基本的：建立单个数据库连接，表单数据保存到数据库，用户被重定向回提交页面。

db.class.php 的第 84-86 行是：

```
if (!($sql_id=mysql_connect($server, $user, $pwd,$new))){
    trigger_error("[Error connecting to database server]: {$sql_id}", E_USER_ERROR);
} 
```

请注意学生报告的错误如何在致命错误描述字符串周围缺少方括号，如 PHP 源文件中所示。这些方括号是在学生第一次错误报告后近两个月前添加的，怀疑他只是将错误字符串粘贴到提交框中以逃避工作。我猜这是 21 世纪版本的“狗吃了我的作业”。

就在一周前，学生仍然报告了**没有括号**的原始错误。服务器范围的 grep 验证学生不断“获取”的错误是基于根本不存在的字符串。

现在，最**合理**的解释是学生在和我们开玩笑。该数据库连接错误在过去发生过，但至少在过去三个月内没有发生。

学生有可能因此被开除，所以我想绝对确保我的证据是可靠的。你能想到任何可能的替代理论吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-28T14:36:16.257

当发生这样的错误时，您不记录吗？
不过看起来他是在编造……

正如 Jeff 在[异常驱动开发中所说](https://blog.codinghorror.com/exception-driven-development/)

> 如果您在等待**用户告诉您有关您的网站或应用程序**的问题，那么您只会看到实际发生的所有问题的一小部分。众所周知的冰山一角。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-28T14:40:34.110

学生可能有一个设置，其中括号因某种原因被剥离，或者他们可能只是在看到新错误时发送前一个错误的 c+p。或者他们可能正在打字。永远不要相信用户报告的错误消息 8)。

我想我要说的第一件事是您不应该向用户发送错误消息。他们应该被记录下来。关闭`display_errors`，`php.ini`然后打开`log_errors`。这既是一个安全问题（我现在知道您的服务器的文件结构，并且您正在运行 MySQL），并且允许您在发生错误时进行跟踪。

您还应该有 Web 服务器访问日志，是吗？如果您知道学生来自的 IP，那应该让您知道访问时间和查找错误的时间。

此外，您可能会考虑让您的应用程序进行日志记录，尤其是与登录的用户相关的情况。如果在您`trigger_error`将当前用户和环境附加到文件之前，您将立即知道该用户是否确实看到了这些问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-28T14:38:42.990

[在 dubio pro reo](http://en.wikipedia.org/wiki/In_dubio_pro_reo)中。如果学生能按时提供他或她的材料（不使用网站），我会避免到处指责。

当然，从 Web 服务器获得一个良好的日志，其中包含帖子参数的大小、SQL 参数的大小以及发布时学生屏幕截图等内容，这可能会改变一些事情。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-28T15:04:06.033

> 与代码中的信息不同……这是非常有力的证据。

不必要。如果我第一次看到这个错误，给教授发了电子邮件，然后第二次收到了一个非常相似的错误，我可能只是复制了最初的电子邮件，并附上了最初的错误。

我这样做是因为它比在浏览器中选择和复制要容易一些，*而且作为一个无辜的人，我不会试图证明自己是无辜的。*

如果他的输入中有什么东西会导致 MySQL 阻塞，我不会感到惊讶。在我自己的工作中，我发现了某些可能使 MySQL 服务器崩溃的查询（并且 MySQL 发行说明中充满了它们）。给定正确的 MySQl 配置，您可以轻松地得到服务器崩溃的情况，然后（非常快速地）恢复/故障转移，这可能是错误消息存储在服务器上的原因。

与其指责那个人，不如让他通过电子邮件发送他的任务。这将向教授保证作业已在到期时上交，*并*允许教授通过在线学习系统测试提交作业。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-28T15:30:57.780

你有没有考虑让他在你面前做一个提交？提交的论文不一定是真正的论文（尽管这样更好），但也许他正在做一些你的剧本没有预料到的事情。当“代码中不可能有错误”时，用户总是能够找到错误。

编辑：您是否考虑过给他一张 CD-R/RW 并让他将他的文件刻录到磁盘上，然后您将其提交给他？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-28T16:29:23.350

正如[tpdi](https://stackoverflow.com/questions/798288/mysql-php-connection-error-possible-user-fabrication/798439#798439)正确指出的那样：*一个无辜的人不会试图证明自己是无辜的。*

是的，您应该将错误记录到文件中，甚至可以通过电子邮件向系统管理员发送严重错误的副本。但现在所有这些都对你没有帮助。

**第一个想法：**
虽然没有直接证据表明学生正在编造一只数字狗来吃他的作业，但我从未见过在任何表格中插入错误消息而不是预期的内容。

如果脚本中的真正错误导致错误消息出现在新记录中，那么屏幕上的错误很可能会完全不同。所以如果学生的母亲声称看到了这个错误，我觉得更难相信。

**错误消息中缺少尖括号：**
我见过许多意外的崩溃，即使是在“不可能是错误的”（tm）代码中也是如此。正如其他人指出的那样，缺少括号的事实本身并没有证据。
该错误可以从旧电子邮件中复制和粘贴，甚至可以通过自定义错误处理程序进行更改（您似乎没有，但只是为了指出可能性）。

但是，如果脚本中的真正错误导致错误消息出现在新插入的数据库记录中，则此错误消息是脚本生成的。然而，缺少的尖括号强烈表明错误消息来自脚本之外。

**然后脚本行自己：**

```
84: if (!($sql_id=mysql_connect($server, $user, $pwd,$new))){
85:     trigger_error("[Error connecting to database server]: {$sql_id}", E_USER_ERROR);
86: } 
```

据我所见，如果脚本未能建立有效连接（第 84 行），则会在第 85 行触发用户错误。
相反，如果触发了用户错误（第 85 行），则脚本无法获取有效的 MySQL 链接标识符。

据我所知，没有有效的 MySQL 链接标识符，PHP 脚本无法影响服务器上的任何数据。

除了缺少的 MySQL 链接标识符之外，上面的行中没有任何代码触及数据。因此，即使存在有效连接，这些行也不会触发新记录的插入。

我发现在打开与数据库服务器的连接过程中的错误极不可能导致插入记录，更不用说包含完全可读的 PHP 样式错误消息的记录了。

**我的结论*基于您发布的信息：***
学生有一个错误消息的副本，该消息在过去某处发生真正错误后显示在浏览器中。他现在将错误消息的副本发布到脚本。该脚本将发布的信息存储在数据库中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-28T15:12:10.540

在我看来，它大多是合法的。

学生还能怎么办：

1.  知道显然是内部 .php 文件的名称（这看起来像一个库，而不是直接提供 HTTP 服务的文件）
2.  知道 mysql_connect 处理代码的行号

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-29T16:02:22.563

如果您要在该 PHP 文件的顶部添加几行注释，以使所谓的错误的行号发生变化，那么学生会收到相同的错误消息还是带有新行号的新错误消息？

如果是前者，我会说他可能正试图拉一个快速的。如果是后者，这听起来像是你那边出了点问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-29T16:23:14.853

那个时候会维护吗？也许他在早上晚些时候提交报告，而其他人都在睡觉。

# c# - 如何在 C# 中使用 GetNextWindow()？

> ID：798295
> 
> 赞同：7
> 
> 时间：2009-04-28T14:33:38.027
> 
> 标签：c#, windows, winapi

Microsoft WinAPI 文档似乎暗示 user32.dll 包含一个调用的函数[`GetNextWindow()`](http://msdn.microsoft.com/en-us/library/ms633509(VS.85).aspx)，据称该函数允许人们通过重复调用此函数来枚举其 Z 顺序中打开的窗口。

[Pinvoke](http://www.pinvoke.net/)通常会给我必要的`DllImport`语句来使用 C# 中的 WinAPI 函数。但是，因为`GetNextWindow()`它没有条目。所以我尝试构建自己的：

```
[DllImport("user32.dll")]
static extern IntPtr GetNextWindow(IntPtr hWnd, uint wCmd); 
```

不幸的是，当我试图调用它时，我得到一个`EntryPointNotFoundException`说法：

```
Unable to find an entry point named 'GetNextWindow' in DLL 'user32.dll'. 
```

这似乎只适用于`GetNextWindow()`; Pinvoke 上列出的其他功能都很好。我可以调用`GetTopWindow()`并且`GetWindowText()`不会抛出异常。

当然，如果您可以提出一种完全不同的方法来以当前 Z 顺序枚举窗口，我也很高兴听到。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-28T14:36:22.137

**GetNextWindow()**实际上是**GetWindow()**的宏，而不是实际的 API 方法。这是为了向后兼容 Win16 API。

```
[DllImport("user32.dll", SetLastError = true)]
static extern IntPtr GetWindow(IntPtr hWnd, uint uCmd);

enum GetWindow_Cmd : uint {
    GW_HWNDFIRST = 0,
    GW_HWNDLAST = 1,
    GW_HWNDNEXT = 2,
    GW_HWNDPREV = 3,
    GW_OWNER = 4,
    GW_CHILD = 5,
    GW_ENABLEDPOPUP = 6
} 
```

（来自[Pinvoke.net](http://www.pinvoke.net/default.aspx/user32/GetWindow.html)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T14:36:48.050

GetNextWindow 是一个调用 GetWindow 的 c++ 宏，因此您不能从 .NET 调用它。改为调用 GetWindow。

来自[MSDN](http://msdn.microsoft.com/en-us/library/ms633509%28VS.85%29.aspx)：

> 使用此函数与调用设置了 GW_HWNDNEXT 或 GW_HWNDPREV 标志的 GetWindow 函数相同

# visual-studio - 基于实现目录重建所有接口

> ID：798316
> 
> 赞同：0
> 
> 时间：2009-04-28T14:39:22.660
> 
> 标签：visual-studio, resharper

我喜欢使用 Resharper。它们具有从实现中提取接口的功能。我的解决方案布局是这样的，我有一个实现目录和一个接口目录。我想做的是指向我的实现目录，然后指向我的接口目录并让它重建所有接口。你知道有什么工具或 T4 模板可以做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T14:41:38.473

ReSharper 没有内置这样的功能，我什至不明白如何使用 T4，它是用于此任务的*模板引擎。*ReSharper 非常可扩展，因此您可以编写自定义插件来做到这一点。

# xaml - 通过 XAML 加载的自定义类型图的自定义标记扩展如何获取对根对象的引用

> ID：798330
> 
> 赞同：0
> 
> 时间：2009-04-28T14:41:34.870
> 
> 标签：xaml

我正在尝试编写一个`MarkupExtension`来支持通过 XAML 实例化自定义类型的过程。我的自定义类型是 POCO，而不是`DependencyObject`. 似乎没有直接的 XAML 机制`MarkupExtensions`来获取对正在加载的图中的对象的引用。我注意到 WPF 机制提供了其中一些功能，但相关属性都是`internal`.

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-21T23:49:37.263

我编写了一个用于绑定到 ViewModel 命令的类，它包含一些用于检索 XAML 根的代码。它对私有 WPF 成员使用反射，所以它并不完全干净，但它可以工作......你可以在这里找到它

[http://www.thomaslevesque.com/2009/03/17/wpf-using-inputbindings-with-the-mvvm-pattern/](http://www.thomaslevesque.com/2009/03/17/wpf-using-inputbindings-with-the-mvvm-pattern/)

顺便说一句，它不适用于 WPF 4，因为私有实现已更改...如果您有兴趣，我可以发布一个更新版本，将这些更改考虑在内

# java - 使用 XPathFactory 的类路径问题

> ID：798333
> 
> 赞同：7
> 
> 时间：2009-04-28T14:42:02.840
> 
> 标签：java, classpath

我在我们的一台实时服务器上不断收到以下异常（运行相同代码的其他服务器似乎没问题）：

```
java.lang.RuntimeException: XPathFactory#newInstance() failed to create an XPathFactory for the default object model: http://java.sun.com/jaxp/xpath/domwith the XPathFactoryConfigurationException: javax.xml.xpath.XPathFactoryConfigurationException: No XPathFctory implementation found for the object model: http://java.sun.com/jaxp/xpath/dom
 at javax.xml.xpath.XPathFactory.newInstance(XPathFactory.java:67) 
```

我很确定类路径中有 Xalan 和 Saxon jar（使用 IBM Java 1.5）。

你有什么想法还有什么可能是错的吗？

**编辑：**

那是导致问题的代码：

```
 XPathFactory factory = XPathFactory.newInstance(); 
```

它运行在一个大致基于 catalina 引擎的自定义 Web 服务器上。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-06-15T08:08:30.437

您需要在类路径中添加适当的 .jar。就我而言，我使用了 Saxon-HE 库。

[Saxon9 中存在一个错误，您可能会像我一样遇到。](https://saxonica.plan.io/issues/1944)

该错误已在版本 9.5.1.5 中得到纠正。因此，您可以下载[最新的 Saxon 9 HE](http://saxon.sourceforge.net/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T18:06:53.550

自己找到了答案：问题是使用 Java 5 和有一个选项的组合

```
-Djava.endorsed.dirs 
```

设置为包含 xalan.jar 的目录。

一旦删除，一切都会再次运行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-28T17:30:37.367

确保您的类路径中有您正在使用的 xalan 版本的适当 xml-apis.jar 和 xerces jar（查看发行说明以了解您需要的确切内容）。还要确保您没有倍数，因为 xercesImpl.jar、xml-apis.jar 和 xalan.jar 需要同步。

# .net - Graphics.MeasureString 允许过多的空白

> ID：798336
> 
> 赞同：2
> 
> 时间：2009-04-28T14:43:27.627
> 
> 标签：.net, gdi

我正在使用一个函数来调用要在一个区域内呈现的一段文本。该功能的基本工作是：

```
Dim measureSize as Size
Do
    myFont = new Font(myFont.Name, myFont.Size - 1, FontStyle.Regular, GraphicsUnit.Document)
    'Initial font size is set insanely high for the moment, during testing.
    'Low initial font size is not the problem.
    measureSize = g.MeasureString(myString, myFont)
Loop until (measuredSize.width < desiredSize.width AND measuredSize.height < desiredSize.height) 
```

这样做的问题是 MeasureString 在它正在绘制的字符串周围添加了很多空白，并且最终的字体被渲染得太小了。

我确定我记得一些参数可以用来从 MeasureString 方法中删除所有填充，但是我的搜索目前没有出现任何结果。

有谁知道如何使用 MeasureString 来测量字符串的精确大小而没有任何边界？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-10-16T16:48:47.647

传给. `StringFormat.GenericTypographic`_ `MeasureString`我建议不要使用 TextRenderer，因为它在渲染到内存位图时会出现 clear-type 问题。

使用 TextRenderer 进行测量，使用 DrawString 进行绘图，无疑迟早会让你陷入不一致的境地。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T14:53:21.083

您应该尝试使用`TextRenderer.MeasureText`，因为它返回文本的大小，而不是抗锯齿的文本大小。

[MSDN 文章](http://msdn.microsoft.com/msdnmag/issues/06/03/TextRendering/default.aspx)

# javascript - 测试 value 是否是一个函数

> ID：798340
> 
> 赞同：97
> 
> 时间：2009-04-28T14:44:38.310
> 
> 标签：javascript, typeof, onsubmit

我需要测试一个表单的值是否`onsubmit`是一个函数。格式通常为`onsubmit="return valid();"`. 有没有办法判断这是否是一个函数，以及它是否可调用？使用 typeof 只是返回它是一个字符串，这对我没有多大帮助。

**编辑**：当然，我理解“返回有效（）；” 是一个字符串。我把`replace`它归结为“valid();”，甚至是“valid()”。我想知道其中任何一个是否是函数。

**编辑**：这是一些代码，可能有助于解释我的问题：

```
$("a.button").parents("form").submit(function() {
    var submit_function = $("a.button").parents("form").attr("onsubmit");
    if ( submit_function && typeof( submit_function.replace(/return /,"") ) == 'function' ) {
        return eval(submit_function.replace(/return /,""));
    } else {
        alert("onSubmit is not a function.\n\nIs the script included?"); return false;
    }
} ); 
```

**编辑 2**：这是新代码。看来我仍然必须使用 eval，因为调用 form.submit() 不会触发现有的 onsubmits。

```
var formObj = $("a.button").parents("form");
formObj.submit(function() {
    if ( formObj[0].onsubmit && typeof( formObj.onsubmit ) == 'function' ) {
        return eval(formObj.attr("onsubmit").replace(/return /,""));
    } else {
        alert("onSubmit is not a function.\n\nIs the script included?");
        return false;
    }
} ); 
```

关于如何更好地做到这一点的建议？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2009-04-28T18:48:20.037

> 我正在用锚链接替换提交按钮。由于调用 form.submit() 不会激活 onsubmit 的，我正在找到它，并自己评估它。但我想在 eval() 之前检查函数是否存在。– gms8994

```
<script type="text/javascript">
function onsubmitHandler() {
    alert('running onsubmit handler');
    return true;
}
function testOnsubmitAndSubmit(f) {
    if (typeof f.onsubmit === 'function') {
        // onsubmit is executable, test the return value
        if (f.onsubmit()) {
            // onsubmit returns true, submit the form
            f.submit();
        }
    }
}
</script>

<form name="theForm" onsubmit="return onsubmitHandler();">
<a href="#" onclick="
    testOnsubmitAndSubmit(document.forms['theForm']);
    return false;
"></a>
</form> 
```

编辑：函数 testOnsubmitAndSubmit 中缺少参数 f

无论您是分配`onsubmit`HTML 属性还是在 JavaScript 中分配它，上述内容都应该有效：

```
document.forms['theForm'].onsubmit = onsubmitHandler; 
```

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2009-04-28T14:50:05.210

尝试

```
if (this.onsubmit instanceof Function) {
    // do stuff;
} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-04-28T15:17:00.603

您可以简单地将`typeof`运算符与三元运算符一起使用：

```
onsubmit="return typeof valid =='function' ? valid() : true;" 
```

如果它是一个函数，我们调用它并返回它的返回值，否则就返回`true`

**编辑：**

我不太确定你真正想要做什么，但我会尝试解释可能发生的事情。

当您`onsubmit`在 html 中声明代码时，它会变成一个函数，因此可以从 JavaScript“世界”调用。这意味着这两种方法是等价的：

```
HTML: <form onsubmit="return valid();" />
JavaScript: myForm.onsubmit = function() { return valid(); }; 
```

这两个都是函数，并且都是可调用的。您可以使用`typeof`应该产生相同结果的运算符来测试任何一个：`"function"`.

现在，如果您通过 JavaScript 将字符串分配给“onsubmit”属性，它将保持为字符串，因此不可调用。请注意，如果您`typeof`对它应用运算符，您将得到`"string"`而不是`"function"`.

我希望这可以澄清一些事情。再说一次，如果你想知道这样的属性（或任何标识符）是否是一个函数并且是可调用的，那么`typeof`操作员应该可以做到这一点。虽然我不确定它是否可以在多个帧上正常工作。

干杯

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-28T14:49:00.483

你使用的是什么浏览器？

```
alert(typeof document.getElementById('myform').onsubmit); 
```

这给了我`function`在 IE7 和 FireFox 中的“”。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-04-26T22:24:55.277

使用基于字符串的变量作为示例并使用 `instanceof Function` 您注册函数..分配变量...检查变量是函数的名称...进行预处理...将函数分配给新变量...然后调用函数。

```
function callMe(){
   alert('You rang?');
}

var value = 'callMe';

if (window[value] instanceof Function) { 
    // do pre-process stuff
    // FYI the function has not actually been called yet
    console.log('callable function');
    //now call function
   var fn = window[value];
   fn();
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-28T14:48:51.483

确保您在实际函数上调用 typeof，而不是字符串文字：

```
function x() { 
    console.log("hi"); 
}

typeof "x"; // returns "string"

typeof x; // returns "function" 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-28T14:49:48.517

您可以尝试修改[此技术](http://forums.asp.net/p/1109407/1707209.aspx)以满足您的需求：

```
 function isFunction() {
   var functionName = window.prompt('Function name: ');
   var isDefined = eval('(typeof ' + functionName + '==\'function\');');
   if (isDefined)
     eval(functionName + '();');
   else
     alert('Function ' + functionName + ' does not exist');
 }
 function anotherFunction() {
   alert('message from another function.');
 } 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-28T14:52:45.937

如果它是一个字符串，你可以假设/希望它总是形式

```
return SomeFunction(arguments); 
```

解析函数名称，然后查看该函数是否使用

```
if (window[functionName]) { 
    // do stuff
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-28T17:32:20.170

form.onsubmit 在定义为 HTML 表单元素的属性时将始终是一个函数。它是附加到 HTML 元素的某种匿名函数，它的*this*指针绑定到该 FORM 元素，并且还有一个名为的参数，该参数`event`将包含有关提交事件的数据。

在这些情况下，我不明白您是如何通过 typeof 操作获得字符串的。你应该提供更多细节，更好的一些代码。

**编辑**（作为对您的第二次编辑的回应）：

我相信无论上面的代码如何，附加到 HTML 属性的处理程序都会执行。此外，您可以尝试以某种方式停止它，但是，FF 3、IE 8、Chrome 2 和 Opera 9 似乎首先执行 HTML 属性处理程序，然后执行附加的处理程序（我没有使用 jQuery 进行测试虽然，但使用 addEventListener 和 attachEvent）。那么......你到底想完成什么？

顺便说一句，您的代码不起作用，因为您的正则表达式将提取字符串“valid();”，这绝对不是一个函数。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2020-09-12T21:51:47.533

不是`typeof xxx === 'function'`最好的和最快的吗？

与 instanceof 和 _underscore 相比，我做了一个长凳，您可以尝试一下

1.  它似乎比 instanceof 更快（使用 chrome）
2.  如果未定义变量，它不会引发错误

这里有一张长凳：[https ://jsbench.me/qnkf076cqb/1](https://jsbench.me/qnkf076cqb/1)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-28T14:50:22.213

嗯，`"return valid();"` *是*一个字符串，所以这是正确的。

如果你想检查它是否附加了一个函数，你可以试试这个：

```
formId.onsubmit = function (){ /* */ }

if(typeof formId.onsubmit == "function"){
  alert("it's a function!");
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-28T14:53:16.887

```
 if ( window.onsubmit ) {
     //
  } else {
     alert("Function does not exist.");
  } 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-04-28T18:46:21.617

**我认为混淆的根源是节点的属性**和相应的**属性**之间的区别。

您正在使用：

```
$("a.button").parents("form").attr("onsubmit") 
```

您正在直接读取`onsubmit` **属性**的值（**必须**是字符串）。相反，您应该访问节点的`onsubmit` **属性**：

```
$("a.button").parents("form").prop("onsubmit") 
```

这是一个快速测试：

```
<form id="form1" action="foo1.htm" onsubmit="return valid()"></form>
<script>
window.onload = function () {
    var form1 = document.getElementById("form1");

    function log(s) {
        document.write("<div>" + s + "</div>");
    }

    function info(v) {
        return "(" + typeof v + ") " + v;
    }

    log("form1 onsubmit property: " + info(form1.onsubmit));
    log("form1 onsubmit attribute: " + info(form1.getAttribute("onsubmit")));
};
</script> 
```

这产生：

```
form1 onsubmit 属性：(function) function onsubmit(event) { return valid(); }
form1 onsubmit 属性：（字符串）返回有效（）

```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-07-03T17:42:28.147

您始终可以在 JavaScript 博客（例如[Chris West 的](http://gotochriswest.com/blog/2012/07/03/javascript-better-typeof-function/). 对函数使用如下定义`typeOf()`会起作用：

```
function typeOf(o){return {}.toString.call(o).slice(8,-1)} 
```

这个函数（在全局命名空间中声明，可以这样使用：

```
alert("onsubmit is a " + typeOf(elem.onsubmit)); 
```

如果是函数，则返回“Function”。如果是字符串，则返回“String”。[此处](http://gotochriswest.com/blog/2012/07/03/javascript-better-typeof-function/)显示了其他可能的值。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-08-31T08:28:34.427

```
// This should be a function, because in certain JavaScript engines (V8, for
// example, try block kills many optimizations).
function isFunction(func) {
    // For some reason, function constructor doesn't accept anonymous functions.
    // Also, this check finds callable objects that aren't function (such as,
    // regular expressions in old WebKit versions), as according to EcmaScript
    // specification, any callable object should have typeof set to function.
    if (typeof func === 'function')
        return true

    // If the function isn't a string, it's probably good idea to return false,
    // as eval cannot process values that aren't strings.
    if (typeof func !== 'string')
        return false

    // So, the value is a string. Try creating a function, in order to detect
    // syntax error.
    try {
        // Create a function with string func, in order to detect whatever it's
        // an actual function. Unlike examples with eval, it should be actually
        // safe to use with any string (provided you don't call returned value).
        Function(func)
        return true
    }
    catch (e) {
        // While usually only SyntaxError could be thrown (unless somebody
        // modified definition of something used in this function, like
        // SyntaxError or Function, it's better to prepare for unexpected.
        if (!(e instanceof SyntaxError)) {
            throw e
        }

        return false
    }
} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-07-23T15:14:07.633

注意 es6 类也是一个函数但不可调用

```
class C {}

typeof C === "function"  // true
C instanceof Function    // true

C()       // error
C.call()  // error
new C()   // okay
new C     // okay 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2021-10-04T10:40:33.983

检查`call`值的方法似乎是一个足够好的测试。例如，`val.call && val()`

```
> a = () => {}
[Function: a]
> function b() {}
undefined
> c = function(){}
  [Function: c]
> d = 2
2
> e = []
  []
> f = {}
{}
> a.call
  [Function: call]
> b.call
  [Function: call]
> c.call
  [Function: call]
> d.call
undefined
> e.call
undefined
> f.call
undefined 
```

注意：除非是上课。

* * *

## 回答 #18

> 赞同：-3
> 
> 时间：2009-04-28T14:47:16.823

像这样的简单检查会让您知道它是否存在/已定义：

```
if (this.onsubmit)
{
  // do stuff;
} 
```

# apache-flex - Can you use a SWF as a dependency for a Flex Mojos Maven build

> ID：798349
> 
> 赞同：1
> 
> 时间：2009-04-28T14:46:33.377
> 
> 标签：apache-flex, maven-2, flash, flex-mojos

I have a maven project with flex-mojos 3.1.0\. Can I have a module with swf packaging and configure a dependency on it in another module? When I do, I get a compilation error.

```
project    
| - module1:swf  
| - module2:swf 
```

module2/pom.xml:

```
<parent>
    <groupId>com.mygroup</groupId>
    <artifactId>project</artifactId>
    <version>1.0-SNAPSHOT</version>
</parent>

<dependencies>
    <dependency>
        <groupId>com.mygroup</groupId>
        <artifactId>module1</artifactId>
        <version>1.0-SNAPSHOT</version>
        <type>swf</type>
    </dependency>
</dependencies> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T02:25:05.423

Seems to be impossible

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-16T07:32:03.910

If you need module-to-module dependency to ensure correct build order for your modules then you can simply create a parent pom for both modules and arange build order in it.

# memory - 运行 32 位应用程序实例的 64 位 Citrix 服务器使用 WoW64 处理内存

> ID：798359
> 
> 赞同：1
> 
> 时间：2009-04-28T14:48:39.377
> 
> 标签：memory, 64-bit, 32-bit, citrix

通过 WoW64 运行 32 位应用程序的 64 位 Citrix 服务器能否处理与等效的 32 位 Citrix 服务器一样多的实例/用户？

如果是这样，如果我增加 64 位服务器中的内存，实例/用户的数量也会增加吗？

或者运行 32 位应用程序的 64 位服务器是否存在一些奇怪的内存考虑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-10T22:07:11.303

32 位 Citrix（或终端）服务器的约束通常在内核资源中：分页池、非分页池、会话视图空间和系统页表。在 64 位操作系统上，这不再是限制，所以是的，您可以运行更多实例/用户。在某些时候，其他资源（如 cpu 和磁盘 i/o）当然会成为瓶颈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-02T14:15:42.623

举个例子——我们目前正在试验在 64 位上运行 32 位应用程序。

将服务器上的内存增加到大约 12G（从 4 个），使我们能够舒适地运行大约 130 个应用程序实例。在 32 位上，它更像是 40 个实例。

当然，您的里程可能会有所不同。

不过，您可能还会关心其他问题，尤其是打印机驱动程序，具体取决于您在那里使用的解决方案。

# iphone - Mac 上的 Unix 错误

> ID：798361
> 
> 赞同：1
> 
> 时间：2009-04-28T14:48:57.100
> 
> 标签：iphone, macos

我一直在尝试将我的应用程序上传到 Iphone，但出现错误：

“在抛出 'Security::UnixError' what() 的实例后调用终止：UNIX 错误异常命令 usr/bin/codesign 失败，退出代码为 6”

知道世界上有什么......？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T15:00:34.780

这意味着你没有在 Xcode 中正确设置你的开发者证书。请参阅 iPhone 开发者中心的说明。

# cvs - CVS：用它的祖先更新一个文件，但没有他们的兄弟

> ID：798365
> 
> 赞同：2
> 
> 时间：2009-04-28T14:49:22.340
> 
> 标签：cvs

我在 CVS 中有一个文件`x/y/f.txt`。在我的本地副本中，我有`x/`，但没有`x/y/`，我想`f.txt`从 repo 中获取。是否有任何 CVS 命令行开关的组合可以使其仅`x/y/f.txt`使用其所有祖先（在本例中`x/y/`）但没有任何附属文件（例如`x/y/g.txt`或`x/z`）？

* * *

到目前为止我发现的唯一方法是：

```
cvs up -d -l x/y
# ... but be careful not to pass -P (``prune'') implicitly via your ~/.cvsrc
# ``-l'' means act locally, i.e. no recursion
# Do the above for every missing ancestor directory, in left-to-right order
# And ultimately:
cvs up x/y/f.txt 
```

但是，shell 脚本拆分路径并遍历祖先是相当不雅的，所以我仍在寻找一个好的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T07:16:55.197

您是否已经签出了工作副本，或者这是为了重新签出？

如果你已经有一个工作副本`cvs up -d x/y/f.txt`应该做这项工作。

`-d`仅当和`x`文件`y`夹不存在时才需要。如果它们确实存在，您也可以直接`cd`进入`x/y`文件夹并执行`cvs up f.txt`.

如果这应该是新的结帐，那么`cvs co -N x/y/f.txt`可能就是您需要的。

# wpf - 如何在 WPF 中实现 Image.Clone()？

> ID：798369
> 
> 赞同：3
> 
> 时间：2009-04-28T14:50:01.560
> 
> 标签：wpf, image-processing

我从 db 中获取一个字节数组 (byte[]) 并使用以下方法渲染到图像控件中：

```
 public Image BinaryImageFromByteConverter(byte[] valueImage)
    {
        Image img = new Image();
        byte[] bytes = valueImage as byte[];
        MemoryStream stream = new MemoryStream(bytes);
        BitmapImage image = new BitmapImage();
        image.BeginInit();
        image.StreamSource = stream;
        image.EndInit();
        img.Source = image;
        img.Height = 240;
        img.Width = 240;
        return img;
    } 
```

所以现在渲染了，我想将 Image.Source 从 Image (Control) “复制”到另一个元素，例如：Paragraph..

```
paragraph1.Inlines.Add(new InlineUIContainer(ImageOne)); 
```

但什么都没有出现，我尝试使用 ImageOne.Source 创建一个新图像，但我刚刚找到了这个带有 Uri(@"path") 的示例，我无法应用此方法，因为我的 BitmapImage 来自 byte[] 类型

```
Image img = new Image();
img.Source = new BitmapImage(new Uri(@"c:\icons\A.png")); 
```

请帮忙解决这个问题，谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-30T21:47:49.463

只需创建一个新的 Image 元素并将其源设置为相同的 BitmapImage：

```
byte[] imageInfo = File.ReadAllBytes("IMG_0726.JPG");

BitmapImage image;

using (MemoryStream imageStream = new MemoryStream(imageInfo))
{
    image = new BitmapImage();
    image.BeginInit();
    image.CacheOption = BitmapCacheOption.OnLoad;
    image.StreamSource = imageStream;
    image.EndInit();
}

this.mainImage.Source = image;
this.secondaryImage.Source = image; 
```

如果您只是将一个源复制到另一个源，它也可以工作：

```
this.mainImage.Source = image;
this.secondaryImage.Source = this.mainImage.Source; 
```

# sql-server-2005 - STANDBY 服务器上的新 Sql 登录

> ID：798373
> 
> 赞同：1
> 
> 时间：2009-04-28T14:50:54.177
> 
> 标签：sql-server-2005

我们在 2 台 Sql Server 2005 机器上设置了一个日志传送场景。辅助数据库处于 STANDBY 模式。我们希望将此辅助服务器用于报告目的，因为报告查看者将根据其给定的执行权限查询此 STANDBY 数据库。所以我们需要在这个辅助服务器上有多个用户，在 STANDBY 数据库上有不同的执行权限。

问题是，在设置日志传送后，我们无法授予备用数据库必要的权限，因为它是只读的。

你有什么建议吗 ？

谢谢，乌姆特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T19:26:50.900

出于某种原因，在我们设置更好的报告系统之前，我们需要使用备用服务器进行报告。并且有一种方法可以在备用服务器上创建新用户并为该用户提供必要的 sp 执行权限。简单的解决方案是，在主服务器上创建一个登录并从主表中选择其 SID。然后使用“sp_addlogin”在备用数据库上创建具有相同 SID 的相同登录。然后，在主服务器上为数据库上的用户提供所需的权限。使用恢复的事务日志，执行权限将传送到备用服务器。两台服务器上的密码不需要相同，因此备用报表查看器用户无法使用相同的凭据访问主服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T15:07:11.517

可悲的是，您需要查看日志传送以外的其他内容。

日志传送的工作原理是在辅助服务器上保持最新的日志副本处于“持续”恢复/恢复状态。因此，那里的数据库实际上从来没有“活动”或活动 - 因为它总是只是应用越来越多的日志并等待使其变为活动的命令。

换句话说，日志传送仅用于高可用性 - 它不支持以 USABLE 形式复制您的数据。

要了解有关日志服务用途的更多信息，请观看此视频： [http ://www.sqlservervideos.com/video/logging-essentials/](http://www.sqlservervideos.com/video/logging-essentials/)

如果你真的需要一个辅助服务器来进行报告，那么我建议使用事务复制之类的东西。（它不适合高可用性解决方案，因为您必须进行一些架构更改和限制......但它确实可以很好地作为一种将数据库的多个副本“发布”到不同服务器/位置的方式报告目的。）

# java - 在 Spring Webflow 单元测试中，如何断言视图状态具有给定名称的视图？

> ID：798375
> 
> 赞同：2
> 
> 时间：2009-04-28T14:51:22.820
> 
> 标签：java, spring, unit-testing, spring-mvc, spring-webflow

我正在开发一个 Spring webflow，尝试使用 TDD，所以我扩展了 AbstractXmlFlowExecutionTests。我看不到一种明显的方法来断言我认为是一件简单的事情：视图状态具有给定名称的关联视图。例如，给定这个流程（摘录）：

```
<?xml version="1.0" encoding="UTF-8"?>
<flow ...>
    ...
    <view-state id="foo" view="barView">
    </view-state>
</flow> 
```

和单元测试

```
public void testAssertFooStateHasBarView() {
    ...
    assertCurrentStateEquals("foo");
    assertTrue( getFlowDefinition().getState("confirmation").isViewState());
    // Surely there's an easier way...?
    ViewState viewState = (ViewState)getFlowDefinition().getState("foo");
    View view = viewState.getViewFactory().getView(new MockRequestContext());
    // yuck!
    assertTrue(view.toString().contains("barView"));
} 
```

有没有更简单的方法来断言 state`foo`有 view `barView`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-22T20:06:42.527

你可以使用这个：

```
assertResponseWrittenEquals("barView", context); 
```

你`context`的`MockExternalContext`.

这就是我总是测试这个的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-23T17:30:49.137

如果您实际上是在发送事件信号，则可以通过以下方法获取 ViewSelection 并检查名称：

```
assertViewNameEquals("Your View Name", applicationView(viewSelection)); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-28T15:10:09.280

我无法与您的其余测试或如何使用 Webflow 交谈，但是您为什么要使用它`contains()`来测试相等性？我确定您不希望“barViewBlah”的视图与您的测试相匹配，是吗？

```
assertEquals("barView", view.toString()); 
```

# unix - 在 Unix 中仅删除我的文件

> ID：798379
> 
> 赞同：13
> 
> 时间：2009-04-28T14:52:26.687
> 
> 标签：unix

我需要从仅属于我的 id 的 unix 目录中 rm 文件。我尝试构建此命令，但无济于事：

```
ls -la | grep 'myid' | awk ' { print $9 } ' | rm 
```

我的结果： 用法：rm [-firRe] [--] 文件...

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-28T15:53:15.807

你真的很亲近。尝试：

```
rm `ls -la | grep 'myid' | awk ' { print $9 } '` 
```

请注意，这些是反引号，而不是原始管道中前三个段周围的单引号。对我来说，文件名列也是 8 美元，但如果 9 美元是适合您的列，那么应该这样做。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-28T14:55:17.270

```
find . -user myuser -print0 |xargs -0 rm 
```

为“myuser”输入您自己的用户 ID（或用户编号）。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-04-28T14:57:15.490

`rm`不从标准输入读取。

```
find -user $(whoami) -delete 
```

请始终在不先删除的情况下进行测试。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-28T14:56:48.547

尝试在`find`哪里可以搜索属于用户的文件，然后删除它们：

```
find . -user *username* -delete 
```

更多信息：`man find`

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-28T14:57:11.980

rm 不接受要在标准输入上删除的文件列表（这是您通过管道传递它所做的事情。

试试这个

```
find . -type f -user username -exec rm -f {} \; 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-12-17T09:26:31.283

`user_name`从文件夹中删除文件`/tmp`（您可以将其替换为您的文件夹）超过 60 天 - 您可以在此处使用任何日期，但请确保将证据保存`deleted.txt`在`user_name`主文件夹中的文件中：

```
find /tmp -user user_name -mtime +60 -exec rm -rfv {} \; >> /home/user_name/deleted.txt 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-28T15:01:04.230

您可以使用查找：

```
find . -maxdepth 1 -type f -user myid -print0 | xargs -0 rm -f 
```

如果您希望它也处理子目录，请删除 -maxdepth 1。

# delphi - Delphi：带有消息“属性持久性不存在”的 EReadError

> ID：798382
> 
> 赞同：3
> 
> 时间：2009-04-28T14:52:54.563
> 
> 标签：delphi, exception

我用 Delphi 7 编写的程序编译正常，但是当我运行它时，它给了我错误消息：

> Project1.Exe 引发异常类 EReadError，并带有消息“属性持久性不存在”。进程停止。

这只是在我安装了用于该项目的 TMS 组件包之后才开始的。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-28T15:56:29.823

1.  在 Delphi IDE 中打开表单
2.  使用 Alt + F12 编辑 .DFM 源
3.  搜索“持久性”属性
4.  删除具有“持久性”属性的行

DFM 示例：

```
SomeComponent1 = TSomeComponent
  OtherProperty = OtherValue
  Persistence = True
  AnotherProperty = AnotherValue
end 
```

您还可以使用 Andreas Hausladen 的出色 DFMCheck 1.4 工具。要检查任何其他这样的缺失属性：

[http://andy.jgknet.de/blog/?page_id=177](http://andy.jgknet.de/blog/?page_id=177)

这很可能是由于编译和安装的包与实际的 .pas 文件不同步造成的。如果您有源代码，那么重建软件包可能会修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-11T08:38:40.393

当我升级到新版本时，我遇到了与 TMS 类似的问题：

如果您认为某些特定组件导致问题，请将其删除，在没有它的情况下编译项目，再次将其放置在表单/框架上。

如果这对您不起作用：

为了解决问题，您需要做一些事情，这样您就可以使用 Designer 和新属性，因为那是您真正想要的，不是吗？:-) :

*   卸载 TMS 组件包（或任何你正在使用的）
*   重新安装 TMS 组件包
*   构建和安装包
*   将适当的 TMS .lib 文件添加到**您的应用程序项目** （我正在使用 C++ Builder）
*   将适当的 TMS .pas 文件添加到**您的应用程序项目** 中。例如，我在使用 TAdvSmoothCalendar 组件时遇到了问题，因此我将 AdvSmoothCalender.pas 添加到了我的项目中。

干杯! 我希望它适用于所有有类似问题的人:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T20:53:41.240

如果您使用文本 DFM（右键单击表单，选中“文本 DFM”，保存），您可以使用搜索|在文件中查找来查找 DFM 文件中的所有持久性实例。只需将搜索字符串设置为“Persistence”（我通常会告诉它忽略大小写），将文件掩码设置为“*.dfm”，然后选中“项目中的所有文件”复选框。

如果您还没有使用文本 DFM 并且不想手动打开所有表单并选中该框然后重新保存它们，您可以使用 CONVERT.EXE（在 ($DELPHI)\Bin 文件夹中）将它们转换为 en-群众。从任何命令提示符运行不带参数的 CONVERT 以查看选项。默认情况下，CONVERT 会将 .DFM 保存为 .txt，但您可以使用 -i 开关让它就地工作（将二进制 .DFM 重写为文本 .DFM）。（我一般是先把.DFMs备份到不同的文件夹，然后再进行转换。如果没有报错，我可以稍后删除备份的.DFMs。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T14:57:49.573

设置断点（F5）并单步执行程序（F7/F8）。到达您获得该异常的位置，然后向我们提供有关它的更多信息（显示一些代码）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T14:58:28.153

此错误意味着它正在尝试从 DFM 资源加载某些内容（通常是表单），并且它为它创建的组件所没有的属性提供了一个值。

如果仅在您开始使用 TMS 组件时发生，解决方案很简单：不要使用它们。尽可能多地向作者发送有关错误和导致错误的项目的信息，看看他们是否能找到修复它的方法。在那之前，使用别的东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-28T19:50:11.147

我在使用 nuiGui Delphi 框架时遇到了类似的问题，为了解决这个问题，创建一个包含一些属性的包含文件并在你的类中使用它。

```
/// include class 'Basic.inc'
private
   function GetWidth: Integer;

published
   property ClientHeight : Integer Read FHeight Write FHeight;
 //property ClientWidth  : Integer Read FWidth Write FWidth;
 //property OldCreateOrder : Boolean Read FOldCreateOrder Write FOldCreateOrder;
 end;
...

/// main class like this
TuMemoFrame = class(TUniFrame)
  UniMemo1: TUniMemo;
  UniMemo2: TUniMemo;
  UniButton1: TUniButton;
  procedure UniButton1Click(Sender: TObject);
private
public

{$Include Basic.inc } // <---
end; 
```

# python - 为类的方法构建依赖关系图的 Python 工具

> ID：798389
> 
> 赞同：19
> 
> 时间：2009-04-28T14:54:26.743
> 
> 标签：python, refactoring

我正在研究一个巨大的遗留 Python 类，它有很多方法。我最终将复杂的分解成更小的部分，因此方法的数量增加得更多。我想知道是否有一种工具可以扫描 Python 代码并为其方法构建某种依赖关系图。

我将方法定义`x()`为方法的依赖项，`y()`如果`x()`在`y()`.

我可以使用这样的工具来隔离（如果可能的话）没有外部依赖项的类方法的子集（它们的所有依赖项都是来自同一子集的方法）。

我计划将一些功能转移到其他类中，我认为这种方法将帮助我决定从最初的巨大类中提取哪些部分。

编辑：我真的很想要一个命令行工具。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-28T22:24:17.863

你看过[Snakefood](http://furius.ca/snakefood/)吗？看起来这正是您要寻找的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T16:26:31.577

你试过[pydev](http://pydev.sourceforge.net/)吗？它是 Eclipse 的 python 扩展。我相信它允许您使用 Eclipse 的“调用层次结构”功能来查看给定方法的调用图。这不是您想要的，但也许已经足够开始了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-30T17:30:15.240

[Pycallgraph](http://pycallgraph.slowchop.com/)应该做你正在寻找的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-10-11T23:13:59.770

刚开始使用[pydeps](https://github.com/thebjorn/pydeps)，到目前为止效果很好。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2010-03-08T02:20:36.447

我也对这个问题感到困惑，我找到了一个搜索助手帮助我以另一种方式找到调用层次结构。不是很好，但总比没有好。对不起我的英语。

ps.IDE eclipse+pydev

# .net - .NET 应用程序在调用 Web 服务时收到 503 Service Unavailable 错误

> ID：798407
> 
> 赞同：0
> 
> 时间：2009-04-28T14:57:29.653
> 
> 标签：.net, vb.net, web-services

这是我遇到的一个不寻常的问题，但最近生产应用程序的一位用户开始报告系统中的错误。在调用应用程序使用的 Web 服务时，这些问题可追溯到 503 Service Unavailable 错误。

现在这是奇怪的部分，只有一个用户受到此问题的影响。该应用程序的其他用户没有报告任何错误。当用户登录到为另一个用户工作的另一台机器时，他们仍然收到错误。

有什么想法可能会在这里发生吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T15:05:32.193

我不知道发生了什么 - 但也许你的服务器知道。问它，很好。

查看事件日志，实际上是 IIS 日志。503 错误可能比您想象的要多，并且可能来自未报告它们的用户。尝试将事件日志条目与 IIS 条目相关联。

您还可以考虑运行 PerfMon 日志来收集服务器的性能计数器。从小处着手 - 选择几个性能指标。如果问题发生并且性能计数器中没有任何有趣的东西，那么添加更多。

最后，考虑一下服务器可能会告诉你真相的可能性。也许有一段时间没有可用的连接或线程。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2021-01-28T15:15:53.033

您是否为 ServiceStack 端口添加了 urlacl？就我而言，删除 urlacl 解决了 Microsoft Server 2019 的问题。

# iphone - iPhone/iPod 使用 CocoaAsyncSocket 从 C# tcpip 服务器接收消息

> ID：798408
> 
> 赞同：2
> 
> 时间：2009-04-28T14:57:30.213
> 
> 标签：iphone, tcp, ipod, asyncsocket

我正在尝试通过 wifi 从 C# tcpip 服务器向 iphone/ipodtouch 应用程序发送/接收数据。为此，我使用了谷歌项目中的 cocoaAsyncSocket。如果我按下一个按钮并从 ipod 向服务器发送请求，它会返回请求的数据（例如歌曲标题）..我想知道每秒播放的是什么歌曲...所以从 C# 服务器我以 1 的间隔发送第二条消息到我的应用程序。在我的应用程序中，在间隔为 1 秒的计时器中，我调用了 asyncSocket 读取 readDataWithTimeout 方法。我的问题是 8-9 秒后不再调用该方法。与服务器的连接仍处于活动状态，C# 服务器仍在发送数据..

我想做的是以下事情：-> winamp 播放歌曲-> C# 服务器询问 winamp 他正在播放什么歌曲并将歌曲标题发送到我的应用程序。-> iphone 应用程序接收数据并显示它

我不知道为什么在短时间内不再调用 readDataWithTimeout 方法。也许是因为 C# 服务器发送的消息之间的时间很短？

谢谢你，索林

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T01:59:40.887

这里有几件事。首先，为什么每秒钟都这样做，而不仅仅是歌曲变化？以这种方式不断颤动的 iPhone 电池将非常昂贵。即使在桌面上也没有理由这样做。

因此，如果我理解正确，iPhone 会连接到 .NET 并请求歌曲。.NET 返回歌曲并保持套接字打开。每一秒，.NET 都会写入它的套接字，而 iPhone 每隔一秒就会从它的套接字读取。

我怀疑正在发生的是，在某些时候，`readDataWithTimeout:tag:`在下一个 NSTimer 触发之前超时不会过期（对于它何时触发都没有任何真正的保证）。然后，您可能会同时运行两个`readDataWithTimeout:tag:`调用，这可能会使套接字委托感到困惑。

更好的解决方案是“长期投票”。在 iPhone 端，调用`readDataWithTimeout:tag:`一个相当长的超时时间（比如 30-60 秒）。每次它返回时，只需循环回到它：

```
while (self.isRunning) {
    [socket readDataWithTimeout:60 tag:0];
} 
```

然后在`-onSocketDidDisconnect:`and中`-onSocket:willDisconnectWithError:`，确保设置`self.isRunning`为`NO`。完全摆脱 NSTimer。

不过，在 Winamp 真正改变歌曲之前，我仍然不会从 .NET 方面发布任何内容。一遍又一遍地发送相同的数据没有任何好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T05:24:35.423

我让它工作了......经过更多阅读......所以当它以未知的时间间隔通过 AsyncSocket 到达时读取数据我使用了休闲代码（我不知道是否是最好的解决方案，但它适用于我想要的） ：

```
- (void) readDataFromSocket
{
        [socket readDataWithTimeout:-1 tag:0];
}

- (void)onSocket:(AsyncSocket *)sock didReadData:(NSData *)data withTag:(long)tag
{
    NSData *strData = [data subdataWithRange:NSMakeRange(0, [data length])];
    NSString *msg = [[[NSString alloc] initWithData:strData encoding:NSUTF8StringEncoding] autorelease];
    if(msg)
    {
        if([msg isEqualToString:@"something"])
        {
            Do stuff
        }
        else
        {
            Do something else
            }
        }
    }
    else
    {
        NSLog(@"Error converting received data into UTF-8 String");
    }
    [socket readDataWithTimeout:-1 tag:0];
} 
```

我在我的应用程序中调用了一次 readDataFromSocket 方法，该方法调用了套接字 [socket readDataWithTimeout:-1 tag:0] 方法。它应该只在应用程序中调用一次，因为在最后一行的方法 - (void)onSocket:(AsyncSocket *)sock didReadData:(NSData *)data withTag:(long)tag 方法中我再次调用 [socket readDataWithTimeout: -1 标记：0]；它告诉套接字监听套接字。当数据到达时，套接字将读取它。

希望它可以帮助某人..

# c++ - 多线程策略？（通过编辑器在多线程引擎中修改场景）

> ID：798410
> 
> 赞同：0
> 
> 时间：2009-04-28T14:58:00.777
> 
> 标签：c++

我正在尝试编写一个超越多线程游戏引擎的编辑器。理论上，通过编辑器可以完全改变场景的内容，但我一直没能想出一个好的方法让引擎来应对这些变化。（即在渲染器绘制实体时删除它）。此外，在我使用可能被删除的实体或资源的每个实例中，我都不愿意编写代码来管理锁。我想必须有一个相对更优雅的解决方案。

有没有人有我可以开始研究的想法或策略？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T15:01:28.427

如果内存不是问题，您可以有一个两阶段的过程，其中更改在一个模型中完成，然后为渲染器拍摄快照，这样渲染器将始终看到模型的一致视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T15:09:32.697

除了@lassevk 建议的两阶段过程之外，您还可以使用[管道结构](http://www.stackframe.net/en/content/06-2008/data-types-pipe)将命令“推送”到渲染器，以便这些更改以渲染引擎的另一个工作项的形式出现。

例如，假设您的引擎遵循如下工作流程：

1.  计算职位
2.  过程物理
3.  过程灯 过程相机
4.  渲染场景

您可以在位置 0 的工作流中添加一个新项目，称为 Process Changes，它从管道中提取信息并将其合并到场景中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T15:45:23.343

在不知道您的确切需求的情况下，我很难对细节发表评论，但我认为如果结合使用写时复制和无锁数据结构可能会有所帮助。

渲染时，您需要只读访问权限，因此没有问题。当您进行编辑时，例如从一组对象中删除一个对象，您使用原子操作将当前对象标记为“已删除”，并且您的渲染器可以在下一个渲染循环之前跳过或删除该对象。当一个对象被更改时，您制作一个副本并更改副本并使用无锁技术“提交”更改。

# python - 如何从 Python 调用 Perl 脚本，通过管道输入？

> ID：798413
> 
> 赞同：6
> 
> 时间：2009-04-28T14:58:34.270
> 
> 标签：python, perl, domainkeys, dkim

我正在将一些对 DomainKeys 和 DKIM 的支持加入到一个开源电子邮件营销程序中，该程序使用 python 脚本通过 SMTP 发送实际电子邮件。我决定走一条快速而肮脏的路线，只写一个 perl 脚本，它接受来自 STDIN 的电子邮件，对其进行签名，然后将其返回签名。

我想做的是从 python 脚本，将字符串中的电子邮件文本通过管道传输到 perl 脚本，并将结果存储在另一个变量中，这样我就可以发送签名的电子邮件。但是，我并不完全是 python 大师，而且我似乎找不到一个好方法来做到这一点。我很确定我可以`os.system`为此使用类似的东西，但是将变量传递给 perl 脚本似乎让我难以理解。

简而言之：如何将变量从 python 脚本传输到 perl 脚本，并将结果存储在 Python 中？

编辑：我忘了包括我正在使用的系统只有 python v2.3

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-28T15:25:57.557

使用[子进程](http://docs.python.org/library/subprocess.html)。这是 Python 脚本：

```
#!/usr/bin/python

import subprocess

var = "world"

pipe = subprocess.Popen(["./x.pl", var], stdout=subprocess.PIPE)

result = pipe.stdout.read()

print result 
```

这是 Perl 脚本：

```
#!/usr/bin/perl

use strict;
use warnings;

my $name = shift;

print "Hello $name!\n"; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-28T15:00:49.707

[os.popen()](http://docs.python.org/library/os.html#os.popen)将返回一个带有子进程的标准输入和标准输出的元组。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-28T15:12:26.043

```
from subprocess import Popen, PIPE
p = Popen(['./foo.pl'], stdin=PIPE, stdout=PIPE)
p.stdin.write(the_input)
p.stdin.close()
the_output = p.stdout.read() 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-28T15:01:48.160

“我很确定我可以为此使用 os.system 之类的东西，但是将变量传递给 perl 脚本似乎让我难以理解。”

正确的。subprocess模块类似于[os.system](http://docs.python.org/library/subprocess.html)，但提供了您正在寻找的管道功能。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-28T15:18:12.303

我敢肯定你选择的路线是有原因的，但为什么不直接用 Python 进行签名呢？

你怎么签的？也许我们可以在编写 python 实现方面提供一些帮助？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-05T09:34:12.780

我也尝试这样做，只配置如何使其工作

```
pipe = subprocess.Popen(
            ['someperlfile.perl', 'param(s)'],
            stdin=subprocess.PIPE
        )
response = pipe.communicate()[0] 
```

我希望这将帮助你使它工作。

# ruby-on-rails - has_many 关系上的 TypeError 转换

> ID：798415
> 
> 赞同：1
> 
> 时间：2009-04-28T14:58:55.390
> 
> 标签：ruby-on-rails, activerecord

我在 Rails 应用程序中有几个对象（“Ticket”和“Comment”）

```
class Ticket < ActiveRecord::Base
  has_many    :attributes
  has_many    :comments
end

class Comment < ActiveRecord::Base
  belongs_to :ticket
  belongs_to :user
end 
```

具有以下架构：

```
create_table "comments", :force => true do |t|
  t.integer  "ticket_id"
  t.integer  "user_id"
  t.text     "content"
  t.datetime "created_at"
  t.datetime "updated_at"
end

create_table "tickets", :force => true do |t|
  t.integer  "site_id"  
  t.integer  "status"
  t.integer  "user_id"
  t.datetime "created_at"
  t.datetime "updated_at"
end 
```

但是，出于某种原因-每当我执行@lead.comments 时，我都会崩溃：

*`can't convert String into Integer`*

有任何想法吗？这让我发疯！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-09-06T13:39:32.280

我认为导致您出现问题的行是：

```
has_many :attributes 
```

“属性”是 Active Record 中的一个特殊词。它指的是数据库中列的值。

如果您尝试用关联覆盖它，那么您将遇到问题。我的建议是，您不应该有一个称为“属性”的模型 - 将其称为其他名称，例如“属性”，问题就会消失。

# firefox - 如何使用 chrome:// URL 访问 .xul 文件？

> ID：798418
> 
> 赞同：1
> 
> 时间：2009-04-28T14:59:26.590
> 
> 标签：firefox, xul

我正在学习如何制作 Firefox 扩展。

我创建了一个名为 findfile 的目录，在该目录下有目录 content/ skin/ 和 locale/ 。在 content/ 目录中有一个 findfile.xul 文件。另外两个是空的

我在 /home/akshay/.mozilla/firefox/xxxx.dev/chrome/ 下放置了一个 findfile.manifest 文件

findfile.manifest 的内容是：

```
content findfile file:///home/akshay/programs/firefox/findfile/content/
skin findfile classic/1.0 file:///home/akshay/programs/firefox/findfile/skin/
locale findfile en-US file:///home/akshay/programs/firefox/findfile/locale/ 
```

当我使用 file:// URL 访问 findfile.xul 时，它工作正常。但是当我尝试使用 chrome://findfile/content/findfile.xul 访问它时，它不会显示窗口。（我重新启动了浏览器）

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T09:02:11.957

也许将 findfile.manifest 重命名为 chrome.manifest ？

给出绝对路径也不是一个好主意。请改用相对路径。

# c - 替代 Kconfig（内核配置语言）来配置/描述大型 C 软件

> ID：798419
> 
> 赞同：3
> 
> 时间：2009-04-28T14:59:34.813
> 
> 标签：c, configuration, build, kbuild

我对大型 C 系统的配置/构建感兴趣...

Linux 内核使用[Kconfig](http://www.kernel.org/doc/Documentation/kbuild/kconfig-language.txt)语言来描述各种配置选项（宏定义为 CONFIG_X）及其依赖关系......基本上，在每个目录中，都有一个 Kconfig 文件，其中包含在该子系统中定义的配置选项......

是否有任何替代方法来描述大型 C 系统（如 Apache 或 *-BSD）中的配置选项？人们一般使用什么？最佳做法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T15:08:45.010

通常，autotools（[参见 autotools book](http://sources.redhat.com/autobook/ "自动簿")），即 GNU autoconf、automake、libtool 是很常见的。它们非常灵活，但启动和运行可能非常少。有了这些，您通常会得到一个“配置”脚本，最终用户可以使用它来指定如何构建软件（例如。./configure --with-foo --disable-bar）。

[CMake](http://cmake.org/ "制作")越来越流行，最引人注目的是 KDE 使用。

当然还有无数其他的。

# filesystems - 如何以编程方式真正清理删除文件？

> ID：798429
> 
> 赞同：8
> 
> 时间：2009-04-28T15:01:21.970
> 
> 标签：filesystems, hard-drive, systems-programming

所以你即将把你的工作电脑交给你的一些同事。你如何确保你真的删除了你所有的个人数据？

重新格式化，重新安装操作系统并不能真正解决问题。

我四处搜索，[发现](http://www.killdisk.com/wiping.htm) [一些](http://www.guidancesoftware.com/products/ef_index.asp) [程序](http://hddguru.com/content/en/software/2006.04.13-HDD-Wipe-Tool/)确实“擦除”磁盘。

这让我想到这些程序是如何工作的？我的意思是，他们使用什么算法以及这些实现有多低级？

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-28T15:08:01.500

大多数这些程序通过用随机噪声覆盖文件位来执行“安全删除”。

最大的问题更多地与硬盘驱动器和文件系统的实际实现有关。碎片化，缓存，数据实际上*是*你试图覆盖的地方：这是大问题。这是一个非常底层的问题——驱动程序级别，真的。你将无法使用 Python、C# 或 Java 来实现。

一旦解决了这个问题，就有了物理媒体。由于磁性介质的性质，经常可以读取曾经在硬盘驱动器上的先前位 - 即使您用不同的位覆盖了它们。“安全删除”程序通过多次覆盖来解决这个问题——最好是随机但适当的多次。

延伸阅读：

*   [数据擦除](http://en.wikipedia.org/wiki/Data_erasure)
*   [数据剩余](http://en.wikipedia.org/wiki/Data_remanence)
*   [伟大的零挑战](http://16systems.com/zero.php)（由[@Stefano Borini](https://stackoverflow.com/questions/798429/how-to-programmatically-really-clean-delete-files/798495#798495)提供——投票给他！）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-28T15:15:09.237

安全删除程序用随机的数据模式多次覆盖文件，因此即使剩磁也无法被拾取并丢失在噪音中。然而，假设[伟大的零挑战](http://16systems.com/zero.php)有一些道理，我认为你可以用零填充文件/磁盘并称自己为快乐，因为即使使用专业设置，这种剩余磁化实际上也无法选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T15:06:34.373

据我所知，大多数工具都使用 X 写入和删除来执行此操作，其中 X 是一个相当大的数字。做到这一点的最佳方法可能是在某种程度上与硬件接口，尽管一种廉价且简单的方法是创建文件直到磁盘已满，写入随机数据，删除它们，创建新文件并重复。

反正都是偏执狂。仅仅删除一个文件通常就足够了......

# css - ASP.NET MVC Html.ActionLink CSS Background Image

> ID：798431
> 
> 赞同：2
> 
> 时间：2009-04-28T15:01:39.660
> 
> 标签：css, asp.net-mvc, image

I have been trying to set an image on an HTML.ActionLink by adding a CSS class for a link (a) and using the background-image to display the link as an image. This works great in all browsers but IE 6 and IE7\. I need to get it working in these browsers, but can not figure it out. Any ideas???

```
a.edit 
{
    background-image: url("../Images/Buttons/edit.png");
    background-position: top left;
    background-repeat: no-repeat;
    width:49px;
    height:22px;
    display: inline-table;
    text-decoration:none;
    clear:none;
}

a:hover.edit 
{
    background-image: url("../Images/Buttons/editOn.png");
    background-position: top left;
    background-repeat: no-repeat;
} 
```

And the link with the edit CSS class

```
<%= Ajax.ActionLink(" ", "EditClaim", "Driver", new { claimId = item.Id }, new AjaxOptions { HttpMethod = "GET", UpdateTargetId = "claim", OnSuccess="showAddClaim", OnComplete = "updateClaim"}, new { @class = "edit" })%> 
```

I would be very grateful, If anyone could help me solve this. I have spent ages trying to solve this one!

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T15:22:10.967

it's a.edit:hover, not a:hover.edit

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T15:17:11.120

couple thoughts...

is the class name acctually changing? check this by adding a border to the new class or another style to see it working. adding the border may in fact make it work, so then maybe you can make this border the same color as the background (preferably do this in a conditional stylesheet)

then im wondering about the display:inline-table ... why this, have you tried display:block;

finally, its probbaly some kind of hasLayout issue, try reading this article

[http://www.satzansatz.de/cssd/onhavinglayout.html](http://www.satzansatz.de/cssd/onhavinglayout.html)

# c# - 你能声明一个可变长度的泛型类型声明吗？

> ID：798434
> 
> 赞同：1
> 
> 时间：2009-04-28T15:02:19.813
> 
> 标签：c#, .net, generics, overloading

我有一个`CheckDuration`使用以下函数签名调用的重载实用程序方法。

```
 private static Action<int> CheckDuration(Action action)
    private static Action<int> CheckDuration<T>(Action<T> action, T arg) 
```

基本上`CheckDuration`在控制台上打印运行一个方法需要多长时间。

现在，我想检查一个采用 2 个参数的方法的持续时间。
所以我必须`CheckDuration`用下面的方法签名创建另一个重载。

```
 private static Action<int> CheckDuration<T, U>(
        Action<T, U> action, T arg1, U arg2) 
```

**有没有办法更优雅地处理这个问题？**
我在想类似的东西

```
 private static Action<int> CheckDuration<params T>(
      Action<params T> action, params T arg) 
```

，这显然行不通。

**[更新]**我现在将这个问题保持开放，看看是否有人想出了解决这种问题的方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-28T15:03:25.910

不幸的是，你已经拥有的东西和它所得到的一样干净。C# 不支持使用`params`泛型类型参数，支持类似的东西会非常困难。您的原始解决方案很好，并且本着 BCL 中类似委托的精神，例如`Action`具有重载定义以采用不同数量的参数的委托。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-28T15:25:22.800

你不能完全按照你的意愿去做，但你可以实现相同的目标：

```
public static class MethodTimer
{
    public static long Run(Action action)
    {
        var sw = System.Diagnostics.Stopwatch.StartNew();
        action();
        sw.Stop();
        return sw.ElapsedMilliseconds;
    }
}
class Program
{
    static void Main(string[] args)
    {
        long time = MethodTimer.Run(() => File.Open(@"c:\test.txt", 
            FileMode.CreateNew));
        Console.WriteLine(time);
        Console.ReadLine();
    }
} 
```

您甚至可以将其定义为扩展方法，因此您的代码可能是：

```
 Action act = () => File.Open(@"c:\test.txt", FileMode.CreateNew);
        time=act.Time(); 
```

该方法将被定义为：

```
public static class MethodTimer
    {
        public static long Time(this Action action)
        {
            var sw = System.Diagnostics.Stopwatch.StartNew();
            action();
            sw.Stop();
            return sw.ElapsedMilliseconds;
        }
    } 
```

**编辑**

您不需要定义任何新方法，这种方法在您想要计时的方法周围使用闭包。所以：

```
MethodTimer.Time(()=> File.Open("",FileMode.Open);
MethodTimer.Time(()=> myObject.TestMethod(123,1231,"another param")); 
```

等等等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T15:05:41.177

不，没有办法。但是，我认为要让这个“CheckDuration”工作，两者都`T`应该`U`实现一些定义良好的接口或从一个基类继承（否则你会做很多反射，这有点违背了使用泛型的目的） . 因此，考虑：

```
Action<int> CheckDuration<T>(Action<T> action, params T[] args)
    where T : ISupportCheckDuration 
```

而且您将能够在其中填充任何`ISupportCheckDuration`兼容的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T15:24:13.113

看看 PostSharp：

[http://www.postsharp.org/](http://www.postsharp.org/)

我想它可以帮助你。查看跟踪示例。我认为你可以调整它来执行你的时间安排。然后，您可以将一个属性添加到您需要计时的任何方法，而不管它需要多少参数。

克里斯

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T15:27:45.227

使用泛型是不可能的，但是使用 C++/CLI 的可变参数模板（当它获得对它们的支持时），您可以做到。

# asp.net - 将枚举暴露给 WebService 的客户端 JavaScript 而不在 WebMethod 中使用它？

> ID：798435
> 
> 赞同：1
> 
> 时间：2009-04-28T15:02:27.583
> 
> 标签：asp.net, javascript, web-services, asp.net-ajax, asp.net-3.5

我正在构建一个 ASP.NET 3.5 应用程序，并且想公开我在 WebService 类中拥有的枚举，而不将它用作我的 WebMethods 中的一个参数。

我有一个非常简单的例子来说明我想要什么......假设我有以下 WebService（我称之为 Agent.asmx）：

```
<System.Web.Script.Services.ScriptService()> _
<System.Web.Services.WebService(Namespace:="http://tempuri.org/")> _
<System.Web.Services.WebServiceBinding(ConformsTo:=WsiProfiles.BasicProfile1_1)> _
<ToolboxItem(False)> _
Public Class Agent
    Inherits System.Web.Services.WebService

<WebMethod(EnableSession:=True)> _
Public Function DoSomething(ByVal doWhat As WhatEnum) As Boolean
    Return ...
End Function

End Class

Public Enum WhatEnum
    AskStackOverflowQuestion
    PhoneAFriend
    FiftyFifty
End Enum 
```

[因为我在其中一个 WebMethods 中使用了 Enum，所以当在我的 .aspx 页面（来自http://localhost/Agent.asmx/js](http://localhost/Agent.asmx/js)）中引用 WebService 时，它​​将在为代理生成的 JavaScript 中输出以下内容：

```
if (typeof(SomeNamespace.WhatEnum) === 'undefined') {
    SomeNamespace.WhatEnum = function() { throw Error.invalidOperation(); }
    SomeNamespace.WhatEnum.prototype = { AskStackOverflowQuestion: 0,PhoneAFriend: 1,FiftyFifty: 2}
    SomeNamespace.WhatEnum.registerEnum('SomeNamespace.WhatEnum', true);
} 
```

现在我可以在客户端的任何地方使用这些枚举。现在，这一切都很好而且很花哨，但是我的代理中有另一个枚举，我实际上并没有在任何 WebMethods 中使用它，我也希望在代理的 JavaScript 中自动公开它。有没有办法，也许是一个属性或我可以使用的东西，让它被包含在内？

如果没有，我的后备解决方案是创建一个以我的 Enum 作为参数的虚拟方法，以便它可用，并且永远不要从 JS 调用它，尽管我不想乱扔代码。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T15:11:02.803

显然，最简单的解决方案是创建虚拟方法。我想我想知道如果您从未将该枚举传递给服务或以任何方式从服务接收它，为什么您需要从您的 Web 服务中获得一个枚举才能在您的 JavaScript 中使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T15:10:21.790

您至少在服务中使用枚举吗？否则，它不属于那里。

我相信您应该查看 [XmlInclude] 属性。

# c# - 控制 PCMCIA 插槽/卡的电源

> ID：798438
> 
> 赞同：1
> 
> 时间：2009-04-28T15:03:49.420
> 
> 标签：c#, .net, wmi, device

我目前正在开展一个项目，该项目利用专有的 PCMCIA 无线电卡与一些无线设备进行通信。我目前有一个后台进程，可以处理从卡读取数据并将其存储以进行处理，但是我希望能够在我的应用程序未运行时关闭卡的电源。我进行了一些调查，虽然 WMI 显然`CIM_PCMCIAController`在其`WIN32_PCMCIAController`实现中支持配置文件，但并没有实现`SetPowerState()`and`Reset()`功能。有谁知道控制插槽电源状态的方法（有或没有 WMI）？我需要能够以编程方式关闭和打开插槽或卡的电源。

**编辑**

与我交谈过的几个人建议在卡片上添加一个功能来促进这一点。不幸的是，修改卡以提供这种功能现在真的不是一个选择。

**编辑 2**

我已经确认该设备确实显示在“多功能适配器”类别下的设备管理器中，尽管从这里禁用设备和 PCMCIA 控制器本身都不会对卡的电源产生任何影响。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T19:42:17.103

我很好奇，但是使用“安全删除硬件...”按钮是否会关闭设备的电源，足以满足您的要求？

如果可行，您可以通过 Microsoft 的 API 以编程方式注册和注销设备。这是一个页面，显示了可能对这种情况有帮助的几个函数：http: [//msdn.microsoft.com/en-us/library/aa363234 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa363234(VS.85).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T19:51:23.947

据推测，该设备有自己的某种驱动程序并显示在设备管理器中。

在这种情况下，您可以通过在程序内部调用[devcon](http://support.microsoft.com/kb/311272)（设备管理器的命令行等效项）来禁用设备。这将使 Windows 处理关闭设备。

[开发者禁用](http://msdn.microsoft.com/en-us/library/ms792832.aspx#d1b89154-ddd9-4c08-99e6-6a12e1ff9d9b)。有关如何通过特定设备 ID 关闭设备的示例，请参见示例 #31。

我是在正确的路线上，还是我误解了你的问题？

# winforms - 我在哪里可以在 CRUD n-Tiered WinForm App 中实例化我的对象？

> ID：798440
> 
> 赞同：1
> 
> 时间：2009-04-28T15:04:06.237
> 
> 标签：winforms, oop, crud

假设我有一个 WinForm CRUD(like) 应用程序。我想遵循这方面的最佳实践，因此我尝试使其遵循 OOP 和 n 分层设计。

不幸的是，我熟悉这些词，但不熟悉它们的实践。所以让我们来看下面的例子：我的 CaseNote 程序。我有一个选项卡式应用程序，您可以在其中转到搜索选项卡以查找成员，然后其中一个选项是转到 CaseNote 选项卡以创建新的案例笔记，查看现有的案例笔记，或为家长创建后续案例笔记笔记。所有这些都适用于您从搜索选项卡中选择的成员。

因此，如果我正在创建对象并将它们传递给不同的形式使用，我应该在哪里实例化它们？我原以为我会有 3 层；UI、对象、DAL。我失败的地方就是我实例化对象的地方。我不能在对象层中实例化它们，可以吗？另外，如果我在表单上实例化它们，我如何在一个相当大的应用程序中将它们从一个表单传递到另一个表单？

案例笔记屏幕截图

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T16:47:33.367

如果你想看更多关于这个问题的词，你想看看 MVP 和 MVC。（这些代表模型视图控制器和模型视图演示器）。有些人会因为我这样说而击落我，但他们在概念上非常相似。

MVP 和 MVC 的目的是允许您设计应用程序逻辑，而无需考虑应用程序的外观。它还允许您在不实现实际 GUI 的情况下定义用户交互。从本质上讲，您的模型是您的应用程序逻辑、您的数据、您的类，它们实际上执行诸如与您的数据库对话之类的事情。您的演示者或控制器是与您的模型交互的东西，是控制您的用户界面并对界面上的用户操作做出反应的东西。最后，您的视图是您的 winforms 设计或您的网页。

我相信您将能够在网络上找到大量有关此问题的材料，但为您提供有关此问题的一些具体帮助应该有助于告知和说明您的阅读。

您需要做的第一件事是开始创建代表数据的对象。因此，您将拥有一个包含案例笔记数据的 CaseNote 对象。您将拥有某种案例记录数据容器，例如案例记录数据库。您可以定义它们的逻辑操作和属性，就好像它们在真实项目中一样。

然后您将继续定义您的演示者或控制器，它将定义您希望从 GUI 支持的操作。同时，您应该定义一个接口，该接口将为演示者/控制器定义可以在 GUI 上执行的操作。因此，例如，您的演示者可能会公开一个名为 SearchForCaseNote 的方法，该方法采用字符串参数。您的视图接口将公开一个名为 DisplayCaseNote 的方法。当用户单击搜索按钮时，视图将通过命令传递给演示者，然后演示者将调用模型来获取数据。演示者此时可以对数据进行格式化，即将DateTime对象转换为字符串，然后通过名为DisplayCaseNote的接口define方法将数据传回视图。

您不必使用 View 接口，您可以直接调用视图，但是拥有该接口意味着您可以拥有许多不同的视图实现。

我需要提到的最后一件事是您在哪里创建应用程序的这些不同部分。我的观点是所有东西都应该从演示者/控制器中掉出来。因此，当您的应用程序启动时，它会创建演示者/控制器对象，然后创建并显示您的视图，并将其作为变量传递给视图。然后，演示者/控制器可以通过从磁盘加载它们来创建初始模型，或者通过像 unity 这样的依赖注入容器理想地发现它们。事实上，使用统一来发现视图实现可能又是一个更好的主意，因为它可以让您真正分离视图和演示者/控制器。当您移动到另一个视图（即打开另一个窗口）时，您的演示者/控制器应该公开一个方法，例如 DisplayDetailPage，当单击按钮时视图调用该方法。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2011-02-08T05:31:48.833

我认为你应该使用 R [ocketFramework](http://rocketframework.codeplex.com/)

# python - 对 Python 集类进行子类化、添加新实例变量的正确（或最佳）方法是什么？

> ID：798442
> 
> 赞同：18
> 
> 时间：2009-04-28T15:05:21.443
> 
> 标签：python, subclass, set, instance-variables

我正在实现一个几乎与集合相同的对象，但需要一个额外的实例变量，因此我将内置集合对象子类化。确保在复制我的一个对象时复制此变量的值的最佳方法是什么？

使用旧的 sets 模块，以下代码完美运行：

```
import sets
class Fooset(sets.Set):
    def __init__(self, s = []):
        sets.Set.__init__(self, s)
        if isinstance(s, Fooset):
            self.foo = s.foo
        else:
            self.foo = 'default'
f = Fooset([1,2,4])
f.foo = 'bar'
assert( (f | f).foo == 'bar') 
```

但这不适用于内置的 set 模块。

我能看到的唯一解决方案是覆盖每个返回复制的集合对象的单个方法......在这种情况下，我可能不会打扰对集合对象进行子类化。当然有一个标准的方法来做到这一点？

（为了澄清，以下代码不起作用*（*断言失败）：

```
class Fooset(set):
    def __init__(self, s = []):
        set.__init__(self, s)
        if isinstance(s, Fooset):
            self.foo = s.foo
        else:
            self.foo = 'default'

f = Fooset([1,2,4])
f.foo = 'bar'
assert( (f | f).foo == 'bar') 
```

)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-30T01:01:00.863

我最喜欢的包装内置集合方法的方法：

```
class Fooset(set):
    def __init__(self, s=(), foo=None):
        super(Fooset,self).__init__(s)
        if foo is None and hasattr(s, 'foo'):
            foo = s.foo
        self.foo = foo

    @classmethod
    def _wrap_methods(cls, names):
        def wrap_method_closure(name):
            def inner(self, *args):
                result = getattr(super(cls, self), name)(*args)
                if isinstance(result, set) and not hasattr(result, 'foo'):
                    result = cls(result, foo=self.foo)
                return result
            inner.fn_name = name
            setattr(cls, name, inner)
        for name in names:
            wrap_method_closure(name)

Fooset._wrap_methods(['__ror__', 'difference_update', '__isub__', 
    'symmetric_difference', '__rsub__', '__and__', '__rand__', 'intersection',
    'difference', '__iand__', 'union', '__ixor__', 
    'symmetric_difference_update', '__or__', 'copy', '__rxor__',
    'intersection_update', '__xor__', '__ior__', '__sub__',
]) 
```

本质上与您在自己的答案中所做的相同，但 loc 更少。如果您也想对列表和字典做同样的事情，那么放入元类也很容易。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-07-14T19:15:53.363

我认为这样做的推荐方法不是直接从 built-in 子类化`set`，而是利用[collections.abc](https://docs.python.org/3/library/collections.abc.html)中可用的[Abstract Base Class`Set`](https://docs.python.org/3/library/collections.abc.html#collections.abc.Set)。

使用 ABC Set 为您提供了一些免费的混合方法，因此您可以通过仅定义 和 来拥有一个最小的`__contains__()`Set`__len__()`类`__iter__()`。如果您想要一些更好的 set 方法，例如`intersection()`and `difference()`，您可能必须将它们包装起来。

这是我的尝试（这恰好是一个frozenset-like，但你可以继承`MutableSet`来获得一个可变版本）：

```
from collections.abc import Set, Hashable

class CustomSet(Set, Hashable):
    """An example of a custom frozenset-like object using
    Abstract Base Classes.
    """
    __hash__ = Set._hash

    wrapped_methods = ('difference',
                       'intersection',
                       'symetric_difference',
                       'union',
                       'copy')

    def __repr__(self):
        return "CustomSet({0})".format(list(self._set))

    def __new__(cls, iterable=None):
        selfobj = super(CustomSet, cls).__new__(CustomSet)
        selfobj._set = frozenset() if iterable is None else frozenset(iterable)
        for method_name in cls.wrapped_methods:
            setattr(selfobj, method_name, cls._wrap_method(method_name, selfobj))
        return selfobj

    @classmethod
    def _wrap_method(cls, method_name, obj):
        def method(*args, **kwargs):
            result = getattr(obj._set, method_name)(*args, **kwargs)
            return CustomSet(result)
        return method

    def __getattr__(self, attr):
        """Make sure that we get things like issuperset() that aren't provided
        by the mix-in, but don't need to return a new set."""
        return getattr(self._set, attr)

    def __contains__(self, item):
        return item in self._set

    def __len__(self):
        return len(self._set)

    def __iter__(self):
        return iter(self._set) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-07T13:53:11.933

可悲的是， set 不遵循规则并且`__new__`不会被调用来创建新`set`对象，即使它们保留了类型。这显然是 Python 中的一个错误（问题[#1721812](https://bugs.python.org/issue1721812)，不会在 2.x 序列中修复）。`type`如果不调用创建 X 对象的对象，您将永远无法获得 X 类型的对象！如果`set.__or__`不打算调用`__new__`它，则正式有义务返回`set`对象而不是子类对象。

但实际上，注意到上面*nosklo*的帖子，你原来的行为没有任何意义。操作员不应该重用任何一个源对象来构造它的`Set.__or__`结果，它应该掀起一个新的，在这种情况下它`foo`应该是`"default"`！

因此，实际上，任何这样做的人都**应该**重载这些运算符，以便他们知道`foo`使用了哪个副本。如果它不依赖于被组合的Foosets，您可以将其设为类默认值，在这种情况下它将得到尊重，因为新对象认为它是子类类型。

我的意思是，如果你这样做，你的例子会起作用：

```
class Fooset(set):
  foo = 'default'
  def __init__(self, s = []):
    if isinstance(s, Fooset):
      self.foo = s.foo

f = Fooset([1,2,5])
assert (f|f).foo == 'default' 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-28T15:29:24.273

`set1 | set2`是一个不会修改任何现有的操作`set`，而是返回一个新的`set`。新`set`的被创建并返回。没有办法让它自动将任意属性从一个或两个`set`s 复制到新创建的`set`，除非通过[定义](http://docs.python.org/reference/datamodel.html#object.__or__) [方法](http://docs.python.org/reference/datamodel.html#object.__or__)`|`自己自定义运算符。[`__or__`](http://docs.python.org/reference/datamodel.html#object.__or__)

```
class MySet(set):
    def __init__(self, *args, **kwds):
        super(MySet, self).__init__(*args, **kwds)
        self.foo = 'nothing'
    def __or__(self, other):
        result = super(MySet, self).__or__(other)
        result.foo = self.foo + "|" + other.foo
        return result

r = MySet('abc')
r.foo = 'bar'
s = MySet('cde')
s.foo = 'baz'

t = r | s

print r, s, t
print r.foo, s.foo, t.foo 
```

印刷：

```
MySet(['a', 'c', 'b']) MySet(['c', 'e', 'd']) MySet(['a', 'c', 'b', 'e', 'd'])
bar baz bar|baz 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-28T15:59:59.097

它看起来像`__init__`在[c 代码](http://svn.python.org/view/python/trunk/Objects/setobject.c?view=markup)中设置绕过。但是，您将结束 的实例`Fooset`，它只是没有机会复制该字段。

除了覆盖返回新集合的方法之外，我不确定在这种情况下你能做太多事情。Set 显然是为一定的速度而构建的，所以在 c 中做了很多工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-01-27T15:25:08.800

我试图回答阅读它的问题：“我怎样才能使“集合”的运算符的返回值成为我的集合子类的类型。忽略给定类的详细信息以及示例是否一开始就坏了。如果我的阅读正确，我是从我自己的问题来到这里的，这将是重复的。

此答案与其他一些答案不同，如下所示：

*   给定的类（子类）只能通过添加装饰器来改变
*   因此足够笼统，不关心给定类的细节（hasattr（s，'foo'））
*   额外的费用是每班支付一次（当它被装饰时），而不是每次都支付。
*   给定示例的唯一问题是特定于“集合”的方法列表，可以轻松定义。
*   假设基类不是抽象的，可以自己复制构造（否则需要实现 __init__ 方法，从基类的实例复制）

库代码，可以放在项目或模块中的任何位置：

```
class Wrapfuncs:
  def __init__(self, *funcs):
    self._funcs = funcs

  def __call__(self, cls):
    def _wrap_method(method_name):
      def method(*args, **kwargs):
          result = getattr(cls.__base__, method_name)(*args, **kwargs)
          return cls(result)
      return method

    for func in self._funcs:
      setattr(cls, func, _wrap_method(func))
    return cls 
```

要将它与集合一起使用，我们需要返回一个*新*实例的方法列表：

```
returning_ops_funcs = ['difference', 'symmetric_difference', '__rsub__', '__or__', '__ior__', '__rxor__', '__iand__', '__ror__', '__xor__', '__sub__', 'intersection', 'union', '__ixor__', '__and__', '__isub__', 'copy'] 
```

*我们可以在我们的*类中使用它：

```
@Wrapfuncs(*returning_ops_funcs)
class MySet(set):
  pass 
```

我不详细说明这门课可能有什么特别之处。

我用以下几行测试了代码：

```
s1 = MySet([1, 2, 3])
s2 = MySet([2, 3, 4])
s3 = MySet([3, 4, 5])

print(s1&s2)
print(s1.intersection(s2))
print(s1 and s2)
print(s1|s2)
print(s1.union(s2))
print(s1|s2|s3)
print(s1.union(s2, s3))
print(s1 or s2)
print(s1-s2)
print(s1.difference(s2))
print(s1^s2)
print(s1.symmetric_difference(s2))

print(s1 & set(s2))
print(set(s1) & s2)

print(s1.copy()) 
```

哪个打印：

```
MySet({2, 3})
MySet({2, 3})
MySet({2, 3, 4})
MySet({1, 2, 3, 4})
MySet({1, 2, 3, 4})
MySet({1, 2, 3, 4, 5})
MySet({1, 2, 3, 4, 5})
MySet({1, 2, 3})
MySet({1})
MySet({1})
MySet({1, 4})
MySet({1, 4})
MySet({2, 3})
{2, 3}
MySet({1, 2, 3}) 
```

有一种情况，结果不是最优的。也就是说，运算符与类的实例一起用作右手操作数，内置“set”的实例作为第一个操作数。我不喜欢这样，但我相信这个问题对于我见过的所有提议的解决方案都很常见。

我还想过提供一个示例，其中使用了 collections.abc.Set。虽然可以这样做：

```
from collections.abc import Set, Hashable
@Wrapfuncs(*returning_ops_funcs)
class MySet(set, Set):
  pass 
```

我不确定它是否带来了@bjmc 想到的好处，或者“一些方法”是什么，它“免费”为您提供。该解决方案旨在使用基类来完成工作并返回子类的实例。一个使用成员对象来完成工作的解决方案可能会以类似的方式生成。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-28T16:31:30.177

假设其他答案是正确的，并且覆盖所有方法是做到这一点的唯一方法，这是我尝试一种适度优雅的方法。如果添加更多实例变量，则只需更改一段代码。不幸的是，如果将新的二元运算符添加到 set 对象中，此代码将中断，但我认为没有办法避免这种情况。欢迎评论！

```
def foocopy(f):
    def cf(self, new):
        r = f(self, new)
        r.foo = self.foo
        return r
    return cf

class Fooset(set):
    def __init__(self, s = []):
        set.__init__(self, s)
        if isinstance(s, Fooset):
            self.foo = s.foo
        else:
            self.foo = 'default'

    def copy(self):
        x = set.copy(self)
        x.foo = self.foo
        return x

    @foocopy
    def __and__(self, x):
        return set.__and__(self, x)

    @foocopy
    def __or__(self, x):
        return set.__or__(self, x)

    @foocopy
    def __rand__(self, x):
        return set.__rand__(self, x)

    @foocopy
    def __ror__(self, x):
        return set.__ror__(self, x)

    @foocopy
    def __rsub__(self, x):
        return set.__rsub__(self, x)

    @foocopy
    def __rxor__(self, x):
        return set.__rxor__(self, x)

    @foocopy
    def __sub__(self, x):
        return set.__sub__(self, x)

    @foocopy
    def __xor__(self, x):
        return set.__xor__(self, x)

    @foocopy
    def difference(self, x):
        return set.difference(self, x)

    @foocopy
    def intersection(self, x):
        return set.intersection(self, x)

    @foocopy
    def symmetric_difference(self, x):
        return set.symmetric_difference(self, x)

    @foocopy
    def union(self, x):
        return set.union(self, x)

f = Fooset([1,2,4])
f.foo = 'bar'
assert( (f | f).foo == 'bar') 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-04-28T15:39:34.263

对我来说，这在 Win32 上使用 Python 2.5.2 非常有效。使用您的类定义和以下测试：

```
f = Fooset([1,2,4])
s = sets.Set((5,6,7))
print f, f.foo
f.foo = 'bar'
print f, f.foo
g = f | s
print g, g.foo
assert( (f | f).foo == 'bar') 
```

我得到了这个输出，这是我所期望的：

```
Fooset([1, 2, 4]) default
Fooset([1, 2, 4]) bar
Fooset([1, 2, 4, 5, 6, 7]) bar 
```

# sql-server - SQL Server Analysis Services 和 OLAP 开发人员指南

> ID：798445
> 
> 赞同：2
> 
> 时间：2009-04-28T15:05:36.780
> 
> 标签：sql-server, resources, ssas, olap

[SqlBatman 的这篇文章](http://sqlbatman.com/2009/04/when-do-you-need-a-cube/)描述了与我目前的客户类似的情况，实际上，这表明许多公司依赖大量报告，由于它们对性能的影响，这些报告已被转移到通宵处理。

我如何开始使用分析服务，特别是 OLAP 多维数据集来帮助我的客户？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-28T15:15:17.067

我真的很喜欢[Analysis Services Step by Step](http://tinyurl.com/d9fdsd)来了解 SSAS 可以做的所有事情。

简而言之，SSAS 让您可以快速访问预先聚合的数据。不过，OLAP 的真正威力并不在于能够快速生成报告。它能够与数据交互。切片、切块、向下、向上和穿透。这是数据爱好者的梦想。

话虽这么说，如果您只是想从中获得静态报告，或者您想构建多维数据集，那么您真的，真的，真的需要加快数据仓库的速度。为此，请获取一份[The Data Warehouse Lifecycle Toolkit](http://tinyurl.com/dfkoul)的副本。Kimball 是这方面的权威，尤其是如果您想在其之上使用 SSAS。

仓库是蛋糕，立方体是糖衣。首先烤蛋糕，然后把立方体放在上面，让它变得更好。

干杯，
埃里克

# iphone - 如何在 Cocoa/Objective-C 中编写一个简单的 Ping 方法

> ID：798454
> 
> 赞同：20
> 
> 时间：2009-04-28T15:07:32.953
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch, networking

我需要`ping`在 Cocoa/Objective-C 中编写一个简单的方法。它还需要在 iPhone 上运行。

我找到了一个使用的示例，`icmp`这可以在 iPhone 上使用吗？

我倾向于使用解决方案`NSNetServices`，这是个好主意吗？

该方法只需要`ping`几次并返回平均值，如果主机已关闭或无法访问，则返回 -1。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-07-05T23:37:19.953

**注意-我会推荐下面克里斯的解决方案，它实际上直接回答了所提出的问题。这篇 12 年前的帖子是为了回应原作者赞成的答案，对此我有更好的解决方案。由于作者赞成上面使用可达性的答案，我认为他实际上对可达性比实际上对发送 ping 更感兴趣，因此我的回答。请在否决这个答案之前考虑这一点。**

StreamSCNetworkCheckReachabilityByName 已弃用且不适用于 iPhone。 *注意： SystemConfiguration.framework 是必需的*

```
bool success = false;
const char *host_name = [@"stackoverflow.com" 
                         cStringUsingEncoding:NSASCIIStringEncoding];

SCNetworkReachabilityRef reachability = SCNetworkReachabilityCreateWithName(NULL,
                                                                        host_name);
SCNetworkReachabilityFlags flags;
success = SCNetworkReachabilityGetFlags(reachability, &flags);

//prevents memory leak per Carlos Guzman's comment
CFRelease(reachability);

bool isAvailable = success && (flags & kSCNetworkFlagsReachable) && 
                             !(flags & kSCNetworkFlagsConnectionRequired);
if (isAvailable) {
    NSLog(@"Host is reachable: %d", flags);
}else{
    NSLog(@"Host is unreachable");
} 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-01-27T05:44:55.997

我遇到了同样的问题，最后围绕 SimplePing 编写了一个简单的包装器来实现这一点，写了一篇关于它的博客，并且在 github 上有一些代码，希望对这里的人有所帮助：

[http://splinter.com.au/how-to-ping-a-server-in-objective-c-iphone](http://splinter.com.au/how-to-ping-a-server-in-objective-c-iphone)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-11-08T22:16:09.883

你没有遗漏任何东西——“可达性”实际上并没有测试目标域实际上是否可达，它只评估是否存在机器外的路径，通过该路径可以访问目标域。只要您有一些出站连接（例如，活动的无线或有线连接），以及通向目标的路由配置，那么就 SCNetworkReachability 而言，该站点是“可访问的”。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-04-26T19:56:28.837

由于您没有 root 访问权限，因此在 iPhone 上 Ping 的工作方式与在其他平台上略有不同。请参阅 Apple 的此[示例代码](http://developer.apple.com/mac/library/samplecode/SimplePing/Introduction/Intro.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-13T12:48:15.357

Gene Myers 使用“SCNetworkReachabilityCreateWithName”为我发布的答案 - 但仅在模拟器中。在我的设备（带 OS 2.2.1 的 iPod）上，即使对于像“zzz”这样的无意义地址，它也总是返回“主机可达”。

我是不是误会了什么？谢谢。

这是我的代码以防万一：

来自[How to write a simple Ping method in Cocoa/Objective-C](https://stackoverflow.com/questions/798454/how-to-write-a-simple-ping-method-in-cocoa-objective-c)

```
 - (IBAction) TestReachability:(id)sender
{
    bool success = false;
    const char *host_name = [ipAddressText.textcStringUsingEncoding:NSASCIIStringEncoding];
    NSString *imageConnectionSuccess = @"Connected.png";
    NSString *imageConnectionFailed = @"NotConnected.png";

    SCNetworkReachabilityRef reachability = SCNetworkReachabilityCreateWithName(NULL,
                                                                                host_name);
    SCNetworkReachabilityFlags flags;
    success = SCNetworkReachabilityGetFlags(reachability, &flags);
    bool isAvailable = success && (flags & kSCNetworkFlagsReachable) && 
        !(flags & kSCNetworkFlagsConnectionRequired);
    if (isAvailable)
    {
        NSLog([NSString stringWithFormat: @"'%s' is reachable, flags: %x", host_name, flags]);
        [imageView setImage: [UIImage imageNamed:imageConnectionSuccess]]; 
    }
    else
    {
        NSLog([NSString stringWithFormat: @"'%s' is not reachable", host_name]);
        [imageView setImage: [UIImage imageNamed:imageConnectionFailed]]; 
    }
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-10-19T14:25:48.980

请注意，模拟器和实际 iPhone 之间存在差异。该模拟器不是真正的模拟器，如 Android 提供的模拟器，它使用 Mac OSX 类来完成大部分功能。

如果 Mac OSX 和 iPhonew 之间存在差异（例如钥匙串），这尤其糟糕。

* * *

## 回答 #7

> 赞同：-8
> 
> 时间：2009-06-16T23:07:56.317

下面的代码似乎是同步工作的：

```
const char *hostName = [@"stackoverflow.com"
                        cStringUsingEncoding:NSASCIIStringEncoding];
SCNetworkConnectionFlags flags = 0;
if (SCNetworkCheckReachabilityByName(hostName, &flags) && flags > 0) {
  NSLog(@"Host is reachable: %d", flags);
}
else {
  NSLog(@"Host is unreachable");
} 
```

*注：`SystemConfiguration.framework`必填项*

# telerik - Telerik RadGrid - 如何禁用列的排序？

> ID：798458
> 
> 赞同：2
> 
> 时间：2009-04-28T15:08:28.097
> 
> 标签：telerik, radgrid

Telerik在[他们的文档](http://www.telerik.com/help/aspnet/grid/grdusingcolumns.html) 中说，有一种方法可以通过使用 AllowSorting 属性来禁用特定列的排序。我正在查看[Telerik.Web.UI.GridColumn 成员](http://www.telerik.com/help/aspnet-ajax/telerik.web.ui-telerik.web.ui.gridcolumn_members.html)并且没有 AllowSorting 属性。有一个 Sortable 属性，但它受保护并且必须被覆盖。那么我用什么来关闭特定列的排序呢？

GridBoundColumn 上有一个 AllowSorting 属性，但在这种情况下，我使用的是 GridTemplateColumn。有没有办法关闭 GridTemplateColumn 上的排序？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-28T15:18:18.527

AllowSorting 属性可从 Visual Studio 的源/标记视图中获得。例如（简化）：

```
 <tr:RadGrid>
    <MasterTableView>
        <Columns>
            <tr:GridBoundColumn DataField="field" HeaderText="Description" 
                 AllowSorting="false" />
        </Columns>
    </MasterTableView>
    </tr:RadGrid> 
```

不知道这对你有用吗？我还没有从代码隐藏文件中实例化我的网格，所以如果这就是你正在做的事情，我不能轻易地帮助你。但以上对我有用。

* * *

**编辑：**

啊，从最初的问题中不清楚，您使用的是 GridTemplate 列。由于您现在使用的是 SortExpression-property，在标记中使用相同的属性对您有用吗？所以：

```
 <tr:RadGrid>
    <MasterTableView>
        <Columns>
            <tr:GridTemplateColumn HeaderText="Description" DataField="field" 
                SortExpression="">
                <!-- template here etc. -->
            </tr:GridTemplateColumn>
        </Columns>
    </MasterTableView>
    </tr:RadGrid> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-28T15:31:43.113

好的，我得到了想要的效果，我通过将 GridTemplateColumn 的 SortingExpression 属性设置为空白来关闭排序。

```
Grid.Columns.FindByUniqueName("Type").SortExpression = string.Empty; 
```

这看起来像一个黑客。为什么没有明确的属性来关闭排序？那好吧。这行得通。

如果你知道更好的方法，请告诉我。

谢谢。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-03-08T11:01:23.797

Telerik 现在有一个名为 HeaderButtonType 的新属性（也存在于模板列上！），可以将其设置为“无”以呈现标签而不是列标题文本的链接按钮。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T15:17:33.473

这是一个示例，显示如何禁用特定列的排序。

请注意 Grid 级别的 AllowSorting 属性（适用于所有列）。

然后，在 Columns 集合中，注意它是如何针对该特定列关闭的。

```
<telerik:RadGrid ID="RadGrid1" runat="server" AllowSorting="True">
    <HeaderContextMenu>
        <CollapseAnimation Duration="200" Type="OutQuint" />
    </HeaderContextMenu>
    <MasterTableView>
        <RowIndicatorColumn>
            <HeaderStyle Width="20px" />
        </RowIndicatorColumn>
        <ExpandCollapseColumn>
            <HeaderStyle Width="20px" />
        </ExpandCollapseColumn>
        <Columns>
            <telerik:GridBoundColumn AllowSorting="False" UniqueName="column">
            </telerik:GridBoundColumn>
        </Columns>
    </MasterTableView>
    <FilterMenu>
        <CollapseAnimation Duration="200" Type="OutQuint" />
    </FilterMenu>
</telerik:RadGrid> 
```

对于 TemplateColumns，我会尝试在网格级别关闭排序并简单地在所需的列上启用它。这样，您就不必为 TemplateColumn 做任何事情，因为它会默认被禁用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-26T20:45:01.450

如果您使用的是 GridTemplateColumn，您始终可以提供您自己的带有标签的标题模板而不是链接按钮作为标题。我们做了一些额外的工作，但这很好用。如果您要禁用所有 GridTemplateColumns 的排序，那么您的“hack”将是最好的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-23T12:30:24.367

如[Telerik Docs](http://docs.telerik.com/devtools/wpf/controls/radgridview/sorting/basics.html)所述：

如果您只想禁用特定列的排序，可以将列的 IsSortable 属性配置为 False：

```
<telerik:GridViewColumn IsSortable="False" /> 
```

# nhibernate - NHibernate Validator 中的业务规则验证

> ID：798460
> 
> 赞同：2
> 
> 时间：2009-04-28T15:09:12.137
> 
> 标签：nhibernate, validation, business-logic

是否可以定义 NHibernate.Validator 将使用的验证方法（用于业务规则验证）？我的意思是EntLib中存在的东西：

```
[HasSelfValidation()]
public class SomeClass
{
    //...

    [SelfValidation()]
    public virtual void DoValidate(ValidationResults results)
    {
        //...
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T17:43:37.460

是的，这是可以做到的——但是您将错过一种在验证错误的情况下传达有关违反哪些规则的更多信息的方法。

据我所知，NHibernate Validator 仅提供指定文本消息、类名称以及 - 在属性级别验证属性的情况下 - 被侵犯属性的名称的能力。

如果您的属性`HasSelfValidationAttribute`实现`IRuleArgs`指向一个`IValidator`(or `IInitializableValidator`)，那么除了简单的类名和类名之外，它没有其他方法可以传达任何`string Message`信息，如果您的需求是验证“真正的业务规则”，这可能是太少的信息。

NHibernate Validator 非常适合针对类属性的简单验证，但是当您需要进行更复杂的验证时，它就显得很短了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-09-08T22:26:23.713

看看[规则引擎项目](http://rulesengine.codeplex.com)。您的业​​务对象不必用任何属性装饰或必须实现任何接口......

# c# - 在 Windows XP 机器上使用 c# .NET 3.0，从多个网络摄像头录制的最有效方法是什么？

> ID：798463
> 
> 赞同：3
> 
> 时间：2009-04-28T15:09:16.550
> 
> 标签：c#, c#-3.0, windows-xp, directshow, webcam

我正在尝试找出用于连接和记录网络摄像头的 API。在我的所有研究中，谷歌，我发现了许多讨论 Directshow 和 COM 的旧文章。我不想编写使用过时 API 的代码。

非常感谢任何方向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T17:57:42.213

DiectShow 仍然是连接网络摄像头（或其他来源）的最佳方式。
您可以使用[DirectShow.NET](http://directshownet.sourceforge.net/)，它是 DirectShow 的一个瘦变形器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T19:13:02.593

如果您使用的是 Vista，则可以使用新的[Media Foundation API](http://msdn.microsoft.com/en-us/library/dd317912(VS.85).aspx)。但是，它们在 XP 上不可用，所以 DirectShow 是要走的路。Shay 指出的 DirectShow.NET 包装器与 C# 配合得很好。一定要下载[Samples](http://sourceforge.net/project/showfiles.php?group_id=136334&package_id=188409&release_id=529095)，有几个像 PlayCap 和 CapWMV 这样的捕获样本值得一试。

UberDemo 在这篇文章中写了一篇关于使用带有 WPF 的 Windows Media Encoder SDK 进行捕获的另一种方法的[文章。](http://blogs.msdn.com/uberdemo/archive/2008/03/27/capturing-a-webcam-stream-to-a-wmv-file-from-within-a-wpf-application.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T02:18:03.260

avicap32.dll 我想是最安全的选择，因为它很容易获得...... [http://channel9.msdn.com/forums/TechOff/93476-Programatically-Using-A-Webcam-In-C](http://channel9.msdn.com/forums/TechOff/93476-Programatically-Using-A-Webcam-In-C)有你会的 PInvoke 代码需要。

[http://codeplex.com/touchless](http://codeplex.com/touchless)是一个有趣的相关项目！

# c# - 如何用动作调用？

> ID：798464
> 
> 赞同：0
> 
> 时间：2009-04-28T15:09:29.717
> 
> 标签：c#, winforms, invoke

我总是将表单上的修饰符设置为**私有**，我不喜欢内部也不公开。

直到现在我曾经这样调用：

```
public string Addtext
{
    if(InvokeRequired)
    {
         Invoke((MethodInvoker)delegate
         {
             textbox.text = value;
         });
    }
    else
        textbox.text = value;
} 
```

但是为我的表单上的每个成员添加这样的属性根本不是面向对象的。

我想创建一个调用参数（动作）的函数。我尽力了，但我失败了——它要求表单成员是**公共**的或**内部**的:(

```
 public void PerformActionOnForm(Action<FormMain> action)
    {
        var form = Form.ActiveForm as FormMain;
        object s = action.Clone();
        if (form != null)
        {
            form.PerformAction(action);
        }
    }

    public void PerformAction(Action<FormMain> action)
    {
        if (InvokeRequired)
            Invoke(action, this);
        else
            action(this);
    } 
```

我的代码中有两个问题：

它要求我要更改的属性为 != private :(

如果表格不在焦点上，则不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T15:14:47.723

以什么方式为需要访问或设置在“根本不是面向对象”的形式范围之外的数据添加属性？这真的是你唯一的选择。匿名委托（或任何委托，就此而言）中的代码在声明它的上下文中执行。解决可见性问题的唯一方法是反射，那就是**大臭代码气味**。创建您的属性并酌情使用它们。

至于您的第二个选项，我假设您想在“主表单”上执行此操作。您在这里有两个选择：假设只有一个实例并将其作为类的静态属性保存，在实例构造函数中分配它。

```
public partial class MainForm : Form
{
    private static MainForm singletonInstance;

    public static MainForm SingletonInstance
    {
        get { return singletonInstance; }
    }

    public MainForm() : base()
    {
        InitializeComponent();

        singletonInstance = this;
    }
}

public void PerformActionOnForm(Action<FormMain> action)
{
    var form = MainForm.SingletonInstance;
    // object s = action.Clone(); What was this for?
    if (form != null)
    {
        form.PerformAction(action);
    }
} 
```

另一个仅在您的所有表单都正确“拥有”并且唯一没有所有者的表单是您的主表单时才有效。在那种情况下，您可以这样做：

```
public void PerformActionOnForm(Action<FormMain> action)
{
    var form = Form.ActiveForm.TopLevelControl as FormMain;
    // object s = action.Clone(); What was this for?
    if (form != null)
    {
        form.PerformAction(action);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T16:49:55.810

## 从非 UI 线程调用 UI 组件

假设您只有一个消息循环（99% 是这种情况），那么：

```
public static class SynchronizedInvoker
{
    public static void Invoke(Action action)
    {
        Form form = Application.OpenForms.Cast<Form>().FirstOrDefault();
        if (form != null && form.InvokeRequired)
            form.Invoke(action);
        else
            action();
    }
} 
```

调用代码：

```
SynchronizedInvoker.Invoke(() => myForm.Text = myText); 
```

## 访问私有 UI 组件

访问私有 UI 成员与访问 .NET 对象的其他私有成员没有什么不同。它具有私有成员的性质，不能从其他对象访问。如果您仍想访问，则必须将 UI 组件的引用传递给调用者或使用反射来解析私有对象的路径。

将 UI 组件的引用传递给调用者的示例：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        ThreadPool.QueueUserWorkItem(delegate { MyWorker.Run(button1); }); 
    }
}

class MyWorker
{
    public static void Run(Button button)
    {
        SynchronizedInvoker.Invoke(() => button.Text = "running");
        Thread.Sleep(5000); // do some important work here
        SynchronizedInvoker.Invoke(() => button.Text = "finished");
    }
} 
```

使用反射在技术上是可行的，但并不理想。您需要知道私有成员的路径，这需要有关对象内部的信息。然后，您应该问自己为什么首先将其设为私有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T15:48:42.527

为什么你的表单有这么多可能的入口点，可以从其他线程调用？将线程编组降低（您的表单的控制器可能会有所帮助），您不必担心像这样的样板代码。

# html - 列表中的 IE z-index 相对/绝对错误

> ID：798482
> 
> 赞同：13
> 
> 时间：2009-04-28T15:11:44.517
> 
> 标签：html, css, internet-explorer

我有以下导航，其中 .topNav 具有位置：相对而 subnav 具有位置：绝对。由于 z-index 问题，我无法让子列表出现在主列表上。这似乎是一个已知问题。

```
<ul>
<li class="topNav">About Us
<ul class="subNav"><li> Subsection A</li><li>Subsection B</li></ul>
</li>
</ul> 
```

有谁知道解决方法？

* * *

更新[http://brh.numbera.com/experiments/ie7_tests/zindex.html](http://brh.numbera.com/experiments/ie7_tests/zindex.html)准确地显示了我遇到的问题。我最初的帖子是在列表的上下文中，但我已经将问题减少到这样一个事实，即 z-index 在具有 position:absolute 的元素在具有 position:relative 的父元素内时似乎不起作用

* * *

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-28T17:22:50.380

这是一篇非常好的文章，解释了 machineghost 提到的堆叠问题。

[http://css-discuss.incutio.com/wiki/Overlapping_And_ZIndex](http://css-discuss.incutio.com/wiki/Overlapping_And_ZIndex)

您可能要考虑的（取决于您为什么要在多个元素上定位）是向 .base 添加一个悬停选择器（对于 IE6 使用 JavaScript），它添加了类以赋予它相对性。

```
.base:hover{position:relative;} 
```

这意味着第二个 .base 没有位置：相对。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T15:58:49.490

好的，我认为您的问题可能源于对 z-index 的工作原理缺乏了解。z-index 属性仅与**DOM 层次结构中同一级别的**元素相关。换句话说，如果您有：

```
<ul id="a">
  <li id="b">b</li>
  <li id="c">c</li>
</ul>
<div id="d"></div> 
```

并且 "b" 和 "c" 的样式是重叠的，z-index 将确定哪一个在顶部。但是，如果 "c" 和 "d" 重叠，则 "d" 将始终位于顶部，无论 c 的 z-index 是多少，因为更靠近根 DOM 节点的元素将始终出现在嵌套更深的元素之上.

因此，只要“subnNav”是“topNav”的子级，我认为没有任何方法可以让它覆盖它的父级内容。换句话说，据我所知，这个问题没有解决方法，除了让“subNav”不是“topNav”的孩子。

（注意：话虽如此，CSS并不简单，所以可能仍然有一些方法可以得到我不知道的你想要的效果。我只能说，基于我对z-index的理解和我很好的一般 CSS 知识，我没有办法知道。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-05T11:44:43.107

添加

```
background: url(blank.gif); 
```

对于绝对定位的元素为我解决了这个问题。Mybe 它可以帮助你 2 :)

问候

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-25T23:37:14.780

我遇到了同样的问题，并且能够在 IE6 和 7 中修复它。将[http://code.google.com/p/ie7-js/](http://code.google.com/p/ie7-js/)与以下 CSS 结合使用，问题就消失了。对于我的问题，我的列表中的一些项目向左浮动，并且每当用户将鼠标悬停在 li 上时都会弹出一个工具提示。为了解决这个问题，我添加了这个：

`.ul li:hover {position:relative;z-index:4;} .ul li:hover + li {position:relative;z-index:3;}`

它的工作方式是每当用户将鼠标悬停在第一个 LI 上时，它会将浮动在它旁边的第二个 LI 设置为较低的 z-index 值。您当然可以更改 z-index 值以满足您自己的需要。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-02-21T10:18:02.390

这对我有用。;)

[http://ltslashgt.com/2007/05/16/relative-zindex-and-ie/](http://ltslashgt.com/2007/05/16/relative-zindex-and-ie/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-28T18:05:44.803

CSSplay 的 Stu Nicholls 有一个[基于 CSS 的导航 w/ 6 级下拉菜单](http://www.cssplay.co.uk/menus/simple_vertical.html)（如果需要，可以扩展到更多）。这适用于 Internet Explorer IE5.5、IE6、IE7、Firefox、Opera 以及现在的 Safari、Netscape 8 和 Mozilla。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-04-30T19:28:48.907

解决方案：按降序分配z-index

```
<div class="base" style="z-index:2">
<div class="inside">
    This has some more text in it. This also has a background. This should obscure the second block of text since it has a higher z-index.
</div>
This has some text in it. This has some text in it. This has some text in it. This has some text in it. This has some text in it.
</div>

<div class="base" style="z-index:1">
This is the second div. You should not be seeing this in front of the grey box. This has some text in it. This has some text in it. This has some text in it. This has some text in it. This has some text in it. This second box should be obscured by the grey box.
</div> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-05-11T20:26:44.833

与@Orhaan 的回答类似，将背景属性设置为绝对元素是唯一对我有用的解决方案......

```
background-color: rgba(0,0,0,0); 
```

[谢谢亚历克斯·莱昂纳德](http://alex.leonard.ie/2013/01/27/ie-bug-text-ignores-z-index-of-higher-elements/)

# c# - C# datagrid vs DevExpress XtraGrid，速度方面

> ID：798486
> 
> 赞同：3
> 
> 时间：2009-04-28T15:12:52.753
> 
> 标签：c#, datagrid

我有一个程序将 10,000 行加载到数据网格中，数据网格的渲染/绘制速度可能很慢，有时不显示，你可以告诉它已经加载了数据，但网格变为空白。我正在考虑用 DevExpress XtraGrid 替换数据网格，有没有人用过这个，我可以期待它更快地渲染/绘画吗？

谢谢

PS这是一个win form应用程序，实际上可能不到10,000行，但可以肯定地说很多。我怀疑我们可能需要使用分页？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T15:19:33.093

首先，确保您使用的是虚拟[模式](http://msdn.microsoft.com/en-us/library/ms171622.aspx)`GridView`

从[GridView 控件中的数据显示模式](http://msdn.microsoft.com/en-us/library/cd28yf6d.aspx)：

> 虚拟模式的主要用途......是在与大量数据交互时优化性能。

MSDN 有[一个教程可以帮助您入门](http://msdn.microsoft.com/en-us/library/2b177d6d.aspx)...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T15:24:11.197

我们使用标准的DataGridView，几十万行几十列，瞬间性能，完全没有问题。在虚拟模式下。使用虚拟模式。

[http://msdn.microsoft.com/en-us/library/2b177d6d.aspx](http://msdn.microsoft.com/en-us/library/2b177d6d.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-22T00:12:27.493

任何正在寻找标准数据网格的好替代品的人都应该尝试一下 SourceGrid，它是免费的，而且做得很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T15:19:38.413

我的第一个自发想法是，哪个网格更快并不重要，因为用户界面中的网格中有 10000 行本身就感觉像是一个错误。但话又说回来，我不知道应用程序做了什么，所以它在使用它的上下文中可能是有意义的......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T15:19:20.177

我相当确定您不会注意到切换后的显着改进。我认为问题在于您将大量数据推送到网格中（因此向下推送到浏览器）。

您可以对这些数据进行分页，还是所有 10000 行都必须在一个页面上？如果是后者，我会考虑使用中继器控件。如果分页是一种选择，我建议将分页推回数据源。

两者都应该为您带来不错的改进。

3rd 方网格可以使 ajax 更新和 db 端分页更容易，但是每个都有很大的学习曲线，如果你想在普通的旧 .net 中进行正确的查询，那么制定正确的查询并不难。

# reportviewer - Asp.net 报告查看器 SRS 设置

> ID：798487
> 
> 赞同：0
> 
> 时间：2009-04-28T15:12:58.773
> 
> 标签：reportviewer, report

我目前有一个 srs 报告，其 url 看起来像 [http://localhost/Report_SqlExpress/Pages/Report.aspx?ItemPath=/personnel_report](http://localhost/Report_SqlExpress/Pages/Report.aspx?ItemPath=/personnel_report) 我尝试使用报告查看器控件通过执行以下操作来显示此报告

```
<rsweb:ReportViewer ID="ReportViewer1" runat="server" ProcessingMode="Remote" 
                                Font-Names="Verdana" Font-Size="8pt" Height="400px" Width="400px"  >
                                <ServerReport 
                                ReportServerUrl="http://localhost/Report_SqlExpress" ReportPath="personnel_report" />

                             </rsweb:ReportViewer> 
```

但我不断收到错误

```
The attempt to connect to the report server failed. Check your connection information and that the report server is a compatible version. 
```

请求失败，HTTP 状态为 404：未找到。

有谁知道我该如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T17:22:39.757

问题是我的报告路径之前需要一个斜杠。傻我。

# coldfusion - 升级 ColdFusion 使用的 JRE

> ID：798491
> 
> 赞同：4
> 
> 时间：2009-04-28T15:14:20.533
> 
> 标签：coldfusion, java

我有一个 ColdFusion 8.1 应用程序。它被大量使用，我看到 jrun.exe 在任务管理器中的内存使用率很高。这是一个 32 位的 windows 2003 服务器。当 Jrun 解决内存使用问题时，ColdFusion 将在某个时候停止响应。日志有点模糊，但我开始在 ColdFusion 日志中看到垃圾收集和堆错误。我假设 JRE 内存不足。

我将最大 JVM 堆设置为 1.2gig。经过一些试验，这似乎是我可以分配的最大数量，并且 ColdFusion 仍然可以正常启动。我意识到转向 64 位可能会解决问题，但目前这不是一个选择。

我正在考虑升级 JRE（它是 2008 年之前的 v6.x，虽然我不知道确切的版本。我正在使用 ColdFusion 8.1 附带的 JRE。有人经历过这个吗？我认为这只是一个安装新 JRE 并将 ColdFusion 指向 ColdFusion 服务器设置中的新 JRE 目录的问题。

蒂亚唐

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-28T16:44:31.923

这**非常**容易做到。

1) 下载[Java SE Development Kit](https://cds.sun.com/is-bin/INTERSHOP.enfinity/WFS/CDS-CDS_Developer-Site/en_US/-/USD/ViewProductDetail-Start?ProductRef=jdk-6u13-oth-JPR@CDS-CDS_Developer)并像往常一样安装它。

2) 在文本编辑器中打开 cf 的**jmv.config**，位于**c:\coldfusion8\runtime\bin**

3) 通过在行的开头放置一个**“#”**来注释现有的**java.home行，在它下面添加一个新的****java.home**行，指向您的 jvm 安装。

 ****例如，我的 java.home 和 jvm.config 如下所示： **java.home=C:/Program Files/Java/jdk1.6.0_11/jre**

4）重启CF服务。

作为奖励，您可以运行[JavaRa](http://www.softpedia.com/progDownload/JavaRa-Download-97297.html)并通过删除所有旧版本的 JRE 来释放一些空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T15:31:38.433

Adobe 有一个涵盖此类问题的知识库。查看[http://www.adobe.com/go/2d547983](http://www.adobe.com/go/2d547983)以获取说明。

Sean Corfield 有一篇文章在这里提供了一些关于使用 Java 6 和 ColdFusion 8 的信息：http: [//corfield.org/blog/index.cfm/do/blog.entry/entry/Java_6_and_ColdFusion_8](http://corfield.org/blog/index.cfm/do/blog.entry/entry/Java_6_and_ColdFusion_8)

只要安装 1.6.0_10 或更高版本，应该没问题。您可以不时查看 ColdFusionBloggers.org，以防将来出现其他 JVM 问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T14:36:34.697

您没有指定是使用独立服务器实例还是多服务器配置。如果您的流量很大，并且有一台具有大量物理内存的双核机器，我会考虑研究 CF8 的多服务器设置并将一个具有负载平衡功能的集群组合在一起。这将有助于在多个 CF8 实例之间分配您的流量，并且假设您有一个强大的服务器，更好地利用您可用的物理资源。

-瑞克

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-22T18:59:08.077

考虑移动 Java 7。Java 7 有 G1 垃圾收集器，它在内存释放方面做得更好。
如果您遇到内存不足的问题，可能是因为

*   函数没有使用`var`或`local`作用域*   `<cfdump>`用于生产系统*   会话太大或未设置为在合理的时间内过期*   查询太大会`SELECT *`导致这种情况。*   查询次数过多。*   该站点正在连接到慢速数据库。资源一直保留到数据库返回数据*   DSN 将数据缓冲区设置为超过 64k

# c# - 如何从 .net 3.5 SP1 中可用的 wpf WebBrowser 进行打印？

> ID：798494
> 
> 赞同：2
> 
> 时间：2009-04-28T15:14:48.597
> 
> 标签：c#, html, wpf, browser, printing

我们目前正在我们的应用程序中的 WindowsFormsHost 中使用 winforms WebBrowser 控件并通过调用“WebBrowser.ShowPrintDialog()”进行打印我们有一个问题，因为对话框似乎不是模态的，并且父窗口可以被关闭导致问题如果稍后尝试打印。

我正在查看新的 wpf webbrowser 控件，希望他们自己做类似的事情时能解决这个问题，但找不到从它打印的方法。

我发现有人在网上谈论这样做：

```
 PrintDialog printDialog = new PrintDialog();
        printDialog.PrintDocument(((IDocumentPaginatorSource)webBrowser.Document).DocumentPaginator, "My App"); 
```

但这会引发异常，因为 WebBrowser.Document 不支持 IDocumentPaginatorSource 接口。

有什么方法可以从 wpf Web 浏览器控件进行打印？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T11:19:33.663

我正在使用它，它可以工作：

```
 mshtml.IHTMLDocument2 doc = webBrowser.Document as mshtml.IHTMLDocument2;
    doc.execCommand("Print", true, null); 
```

# c++ - 构建 PHP 扩展时如何检查未损坏的 C++ 符号？

> ID：798497
> 
> 赞同：3
> 
> 时间：2009-04-28T15:15:40.577
> 
> 标签：c++, automake, php-extension, name-mangling

我有一个用 C++ 编写的 PHP 模块，它依赖于安装的 C++ 库（Boost Date_Time）。

目前，在我的 config.m4 文件中，我正在检查库，如下所示：

```
 LIBNAME=boost_date_time
  LIBSYMBOL=_ZN5boost9gregorian9bad_monthD0Ev

  PHP_CHECK_LIBRARY($LIBNAME,$LIBSYMBOL,,
  [
    AC_MSG_ERROR([lib $LIBNAME not found.  Try: sudo apt-get install libboost-dev])
  ],[
    -lstdc++ -ldl
  ]) 
```

现在，这适用于我当前的环境，但我痛苦地意识到这可能会在不同版本的库或编译器上中断。

如何让 automake 理解未损坏的 C++ 符号？

编辑：

我意识到检查损坏的名称是可怕的，但是没有某种方法可以检查“nm -C”返回的符号名称（例如 boost::gregorian::bad_month 等）。

我发现了一些对 automake 命令 AC_LANG_CPLUSPLUS() 的参考，但我不确定如何使用它以及它是否适用于这里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T20:49:15.583

您可以检查`AC_TRY_COMPILE`类似的东西：

```
LIBNAME=boost_date_time
AC_MSG_CHECKING([for BOOST])
AC_TRY_COMPILE(
[
#include "boost/date_time/gregorian/greg_month.hpp"
],
[
boost::gregorian::bad_month* bm = new boost::gregorian::bad_month;
],
[
AC_MSG_RESULT(yes)
],
[
AC_MSG_ERROR([lib $LIBNAME not found.  Try: sudo apt-get install libboost-dev])
]) 
```

这避免了使用未损坏的符号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T15:23:10.090

在特定 C++ 编译器的环境之外，没有“未损坏的 C++ 符号” - 损坏的目的是为外部工具（例如链接器和库管理器）提供唯一的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T15:28:38.690

您需要为您希望调用的 Boost api 函数提供一组 C++ 包装器。这些包装器需要用 声明`extern "C"`，如：

```
extern "C" 
void foo(int bar) 
{
...
} 
```

您的 PHP 代码应该使用这些包装器，而不是尝试直接调用 C++ 方法。

**编辑**：由于您假设 的可用性`automake`，您可能计划编译 Boost 库作为安装的一部分。这使您可以选择探测名称修改的结果。尝试按照这些思路创建一个测试 C++ 程序。**请注意，这只需要编译**；它不需要产生有效的结果。

```
#include "boost/date_time/gregorian/greg_month.hpp"
int main( int argc, const char* argv[] )
{
   boost::gregorian::bad_month* xxxjunk = new boost::gregorian::bad_month;
   return 0;
} 
```

在您的自动制作中，您需要编译它，然后通过运行输出

```
nm -C | grep "boost::gregorian::bad_month" 
```

根据您的需要和挑剔，您可能希望进一步细化`grep`命令以查找字符串“ `typeinfo for boost::gregorian::bad_month`”（请注意，这会进一步增加您对特定编译器实现的依赖。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T15:29:21.590

这是一个糟糕的主意——公开损坏的符号。你为什么首先需要这个？

看到您的更新后，我不得不问，为什么不使用自定义规则来调用`nm`和获取此信息并使此规则作为要求传递？`autoconf`如果要提供直接命令来检查目标文件中的符号，我会感到非常惊讶。

# visual-studio-2008 - Visual Studio 2008 创建无用的空输出文件夹

> ID：798498
> 
> 赞同：2
> 
> 时间：2009-04-28T15:16:17.033
> 
> 标签：visual-studio-2008, ide

这种行为让我非常恼火。我指定 '....\bin\Debug\' 作为所有项目的输出文件夹。

打开解决方案时，VS 在项目文件中指定的实际 bin 文件夹的父目录甚至父目录的父目录中创建一个空的 bin/debug（或在发布模式下为 /release）文件夹。删除这些无用的文件夹后，即使在完全重建时也不会重新创建它们。

我不确定为什么 VS 会这样。这是一个错误还是我的配置有错误？如果您需要更多信息，我很乐意补充。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T15:22:09.313

此其他帖子可能与您的相关：[错误创建的输出文件夹-with-visual-studio-2008](https://stackoverflow.com/questions/290537/wrongly-created-output-folders-with-visual-studio-2008)

# c# - 获取访问您网站的每个用户的 ipaddress 和位置

> ID：798499
> 
> 赞同：8
> 
> 时间：2009-04-28T15:16:46.270
> 
> 标签：c#, asp.net, javascript

您如何通过 Asp.Net 获取您网站的每个网站访问者的 ipaddress 和位置？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-28T15:21:41.077

要获取用户的 IP，请使用：

```
Request.UserHostAddress 
```

您可以使用此网络服务来获取他们的地理位置。 [http://iplocationtools.com/ip_location_api.php](http://iplocationtools.com/ip_location_api.php)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T15:20:37.727

```
 string VisitorIPAddress = Request.UserHostAddress.ToString(); 
```

并根据 ipaddress 您可以缩小位置：[查找主机的地理位置](http://www.private.org.il/IP2geo.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-17T18:57:42.223

如果您在代理后面，Request.UserHostAddress 将不起作用。使用此代码：

```
public static String GetIPAddress()
{
    String ip = HttpContext.Current.Request.ServerVariables["HTTP_X_FORWARDED_FOR"];
    if (string.IsNullOrEmpty(ip))
        ip = HttpContext.Current.Request.ServerVariables["REMOTE_ADDR"];
    else
        ip = ip.Split(',')[0];

    return ip;
} 
```

请注意，应该使用 HTTP_X_FORWARDED_FOR 但因为它可以返回多个 IP 地址，以逗号分隔，您需要使用 Split 函数。有关更多信息，请参阅[此页面](http://weblogs.asp.net/james_crowley/archive/2007/06/19/gotcha-http-x-forwarded-for-returns-multiple-ip-addresses.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-19T23:37:25.497

它与服务器技术无关，但我建议搭载 Google 的 AJAX 加载器：[http ://code.google.com/apis/ajax/documentation/#ClientLocation](http://code.google.com/apis/ajax/documentation/#ClientLocation)

它使用 Javascript 编写，甚至会为您提供该人的城市/州/国家/地区（嗯，它需要根据 IP 地址进行猜测）。将其发布回服务器，您可以在 ASP.NET 或其他任何方式中使用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T15:22:45.833

那么以下属性应该为您提供客户端（或客户端代理服务器）的 IP 地址

```
Request.UserHostAddress 
```

至于位置，您需要使用一些 GeoIP/GeoLocation 插件（如 MaxMind）来解决这个问题。

[http://www.maxmind.com/](http://www.maxmind.com/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-28T15:23:34.100

要获得 IP，请执行以下操作：

```
Request.UserHostAddress 
```

您可以使用 Web 服务（较慢）或数据库（较快）将 IP 映射到位置，如下所示：http: [//ip-to-country.webhosting.info/node/view/5](http://ip-to-country.webhosting.info/node/view/5)

# java - 如何创建一个休眠集合，每次我请求它时都会重新读取它？

> ID：798502
> 
> 赞同：2
> 
> 时间：2009-04-28T15:17:09.670
> 
> 标签：java, hibernate, configuration, caching

我有一个实体，它有一个与之关联的状态表。状态表由另一个进程管理，并包含我的业务逻辑必须处理的对象列表。每次重新加载实体时，我都想获得状态表的新快照。如何确保 Hibernate 或其支持库的任何部分*都不会*缓存此表的任何值？*基本上，每次*调用 getMyStateValues() 时，我都想获得一个新的集合视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T15:28:35.350

Hibernate 的大部分目的是防止这种情况发生，并在给定事务的范围内返回实体状态的一致视图。因此，要么每次在不同的事务中重新加载整个实体。或者，如果您需要在业务事务期间重新加载状态表，则在单独的 Hibernate 会话中仅按父实体的 id 加载状态表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T16:14:35.973

您可以在实体中创建一个查询数据库并返回集合的方法。获取XYXReload()。这不是一个很好的设计决定，想。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T18:42:24.807

您可以使用 Hibernate 的[CacheMode](http://www.hibernate.org/hib_docs/v3/api/org/hibernate/class-use/CacheMode.html)。它允许您指示休眠会话如何与缓存交互。您可以通过以下方式访问基础会话：

```
@PersistenceContext EntityManager manager;
...
org.hibernate.Session session = (Session)manager.getDelegate(); 
```

不幸的是，这种技术适用于整个会话，而不是专门适用于实体。

# perl - 为什么 Perl 的 tr/// 不做我想要的？

> ID：798517
> 
> 赞同：2
> 
> 时间：2009-04-28T15:21:08.037
> 
> 标签：perl, syntax, perl4

我正在将 Perl 用于将输入作为两个短 DNA 字符串的脚本。作为输出，我连接两个字符串字符串，然后在连接字符串的末尾打印第二个字符串在其副本上排成一行。例如：如果输入字符串是 AAAA 和 TTTTT，则打印：

```
AAAAATTTTT
     TTTTT 
```

我知道还有其他方法可以做到这一点，但我很想知道为什么我对 tr/// 的使用不起作用。

该程序的代码是：

```
use strict;
use warnings;
print "enter a DNA sequence \n";
$DNA1=<>; #<> shorthand for STDIN
$DNA1=~ s/\r?\n?$//;
print $DNA1 "\n\n";
print "enter second DNA sequence \n";
$DNA2=<>;
$DNA2=~ s/\r?\n?$//;
print $DNA2 "\n\n";
$DNA= join("",($DNA1,$DNA2));
print "Both DNA sequences are \"$DNA\" \n\n";
$DNA3=$DNA1;
$DNA3=~ tr/ATCGatcg//;
print $DNA3 "\n\n";
$DNA4= join("",($DNA3,$DNA2));
print $DNA4 "\n\n";
exit; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T15:27:46.977

`tr`您需要在命令的后半部分放置一个空格。

或者，您似乎要做的是创建一个包含与第一个字符串中的字符一样多的空格的变量：

```
my $spaces = ' ' x length($DNA1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T15:27:59.487

您的 tr 更改任何 ACTGatcg 并删除它们。我想你想要

```
$DNA3 =~ tr/atcgATCG/ /; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T15:29:52.993

这可能只是一个简单的语法错误。尝试：

```
$DNA3 =~ tr/ATCGatcg/ /; 
```

其中第二个斜杠将您的两个翻译实体分开，并且您在第二个和第三个斜杠之间有一个空格字符。

祝你好运！

编辑：我的错误 - 误解了你想要做什么。答案相应调整:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T15:00:26.113

这是你想要的程序吗？

```
#!perl

我的 $s1 = 'AAAAAAAAA';
我的 $s2 = 'TCGAGCTA';

打印
    $s1, $s2, "\n",
    ' ' x 长度( $s1 ), $s2, "\n";

```

# sql - 生成火灾登记报告

> ID：798522
> 
> 赞同：0
> 
> 时间：2009-04-28T15:23:03.960
> 
> 标签：sql, database, ms-access

我一直在为休闲找出一个有效的 SQL 查询：
我需要基于一个记录登录/注销事件以及一些元数据的 Access 数据库生成一个火灾登记报告（建筑物内仍有多少人）。Access 数据库如下所示：

```
+----+---------+---------+---------+-- ----+
| 编号 | 日期 | 行动 | 成功| 用户 |
+----+---------+---------+---------+-- ----+
| 1 | 2009-04-28 02:00:00 | 登录 | 1 | 尼克 |
| 2 | 2009-04-28 03:00:00 | 登出 | 1 | 尼克 |
| 3 | 2009-04-28 04:00:00 | 登录 | 1 | 尼克 |
| 4 | 2009-04-28 04:00:00 | 登出 | 1 | 尼克 |
| 5 | 2009-04-28 04:00:00 | 登录 | 1 | 尼克 |
| 6 | 2009-04-28 07:00:00 | 登录 | 1 | 约翰 |
| 7 | 2009-04-28 07:30:00 | 登录 | 1 | 苏 |
| 8 | 2009-04-28 08:00:00 | 登出 | 1 | 约翰 |
+----+---------+---------+---------+-- ----+

```

白天可以有多个登录/注销操作。当管理员运行报告时，它仅限于当天，并且需要列出该用户的最后一次已知操作所在的所有用户，`login`并且成功=1，这意味着该人当前在建筑物中。

在上面的数据中，必须指出**尼克**和**苏仍然在建筑物内。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T15:41:42.853

解决问题的另一种方法：

```
SELECT
     T1.user
FROM
     Some_Table T1
LEFT OUTER JOIN Some_Table T2 ON
     T2.user = T1.user AND
     T2.success = 1 AND
     T2.date > T1.date
WHERE
     T1.success = 1 AND
     T1.action = 'login' AND
     T2.id IS NULL 
```

这假设您只关心成功的操作。此外，如果用户在相同的确切日期和时间有两个操作，那么它可能不会按预期运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T15:28:15.303

**抱歉原文有错别字

```
SELECT     f.[User], la.MostRecent, f.[action]
FROM         
(
   SELECT 
       MAX(ID) AS MaXID, 
       MAX(Date) MostRecent, 
       success, 
       [USER] 
   FROM          
       Fire
   WHERE
       Success = 1
   GROUP BY 
       success, [USER] 
) AS la
JOIN Fire f
  ON la.MaxID = f.ID
WHERE     ([action] = 'login') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T15:28:23.807

这可以在 SQL 中使用，但您必须使用 Access 进行尝试。

```
select *
from events e1
where action = login
      and success = 1
      and date = (select max(date) from events e2 where e1.user = e2.user) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T19:29:22.823

这假设 ID 总是以正数递增并且是唯一的。

```
SELECT LogTable.* 
FROM LogTable 
INNER JOIN (Select User, Max(ID) AS LastID 
                    FROM LogTable 
                   GROUP BY LogTable.User
                  ) as LastLog
ON LogTable.User = LastLog.User 
           AND LogTable.ID = LastLog.LastID 
WHERE LogTable.success = 1 AND LogTable.action = 'login'; 
```

基于假设，您不必担心日期时间不是唯一的。

希望大家不要养成为不登录的人开门的习惯。

# javascript - 从 Javascript 更改媒体特定的 CSS 属性

> ID：798535
> 
> 赞同：9
> 
> 时间：2009-04-28T15:27:00.737
> 
> 标签：javascript, css, media

我有一个 CSS 属性（字体），我需要能够从 Javascript（下拉）中进行更改。但是，这种字体只能在打印时使用（@media print）。

因此，javascript 不能只更改字体的值，因为这也会影响屏幕视图。有没有办法只更改字体属性的打印版本？

或者，有没有办法让 CSS 属性成为对另一个属性的引用？

这样，在打印 CSS 中，我可以说字体：printfont，而在屏幕 CSS 中，我可以说字体：12。然后改变printfont的值，打印时只会改变字体。

谢谢。

编辑：关键是我需要能够从下拉菜单中更改文档打印的字体大小，但我不想更改文档显示的字体大小。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-28T15:40:52.450

这是你在那里遇到的一个有趣的困境。在我的脑海中，我唯一能想到的就是在标题中添加一个新标签，在该标题中你的字体大小用 !important 声明。例如，在您的头部标签中：

```
<style type="text/css" media="print">

.printfont {
    font-size: 16px !important;
}

</style> 
```

这将确保新的字体大小优先。

以下是一个非常简单的示例，说明如何使用 javascript 完成此操作

```
<script type="text/javascript">

    var inlineMediaStyle = null;

    function changeMediaStyle ()
    {
        var head = document.getElementsByTagName('head')[0];
        var newStyle = document.createElement('style');
        newStyle.setAttribute('type', 'text/css');
        newStyle.setAttribute('media', 'print');
        newStyle.appendChild(document.createTextNode('.printFont { font-size: 16px !important;}'));

        if (inlineMediaStyle != null)
        {
            head.replaceChild(newStyle, inlineMediaStyle)
        }
        else
        {
            head.appendChild(newStyle);
        }
        inlineMediaStyle = newStyle;
    }

</script> 
```

只需确保您将 onchange="changeMediaStyle()" 作为下拉列表中的属性。此外，作为我的示例中的免责声明，我没有考虑内存泄漏等问题，因此您必须自己解决这些问题。

至于您的替代问题，据我所知，没有任何方法可以声明/使用本质上是 CSS 变量的内容。但是，目前有一个建议：[http ://disruptive-innovations.com/zoo/cssvariables/](http://disruptive-innovations.com/zoo/cssvariables/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T15:38:23.673

似乎您想要做的是 myabe 只需使用 JS 更改或添加一个类到项目

```
<p class="inrto comicSans">this is the text to change</p>

@screen p.intro {font-family:verdana;}

@print p.comicSans {font-family:comic-sans;} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T15:41:47.580

你可以只使用 JavaScript 来切换类，并拥有

```
@print {
  .myPrintClass { font-family: serif; }
}
@screen {
  .defaultClass { font-family: sans-serif; }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T15:46:17.790

虽然基于类的解决方案完全可以工作，但您也可以使用 Javascript 向页面动态添加新`<link>`标签。例如，如果您有：

样式表1.css：

```
@print * {font-family:verdana;} 
```

样式表2.css：

```
@print * {font-family:comicSans;} 
```

然后，您可以使用 jQuery 执行以下操作：

```
$(document.body).append("<link href='stylesheet2.css'/>"); 
```

（你也可以不用 jQuery，但我忘记了那个语法，懒得去查了 ;-)）。

但是，如果您只更改少量，则单个样式表 + 不同的类可能是更好的选择；`<link>`仅当您发生大量不同的样式更改时，新的标签解决方案才值得。

# vb.net - 将 ReportViewer 导出到 Excel - 线宽变化

> ID：798544
> 
> 赞同：0
> 
> 时间：2009-04-28T15:28:45.803
> 
> 标签：vb.net, winforms, formatting, reportviewer

我正在使用 Microsoft ReportViewer 控件创建报告。将报告导出到 Excel 时遇到一些格式问题。

问题是我在 ReportViewer 中指定了 1pt 的线宽，这是可能的最小线（或者是吗？）。导出完成后，Excel中的线宽都是粗边框。

我试图弄清楚如何让线宽成为 Excel 中的标准线。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T15:46:07.430

看起来我在正确的轨道上。事实上，最小的线可能是 0.0882mm，而不是 1pt。

将线设置为0.0882mm后，Excel中线宽正常。

# java - 什么是 Java ?: 运算符，它的作用是什么？

> ID：798545
> 
> 赞同：180
> 
> 时间：2009-04-28T15:28:50.420
> 
> 标签：java, syntax, ternary-operator, conditional-operator

我已经使用 Java 几年了，但直到最近我还没有遇到过这个结构：

```
int count = isHere ? getHereCount(index) : getAwayCount(index); 
```

这可能是一个非常简单的问题，但是有人可以解释一下吗？我该如何阅读？我很确定我知道它是如何工作的。

*   如果`isHere`为真，`getHereCount()`则调用，
*   if `isHere`is false`getAwayCount()`被调用。

正确的？这个结构叫什么？

* * *

## 回答 #1

> 赞同：208
> 
> 时间：2009-04-28T15:30:36.970

是的，它是一种简写形式

```
int count;
if (isHere)
    count = getHereCount(index);
else
    count = getAwayCount(index); 
```

它被称为**条件运算符**。许多人（错误地）称它为*三元运算符*，因为它是 Java、C、C++ 和可能许多其他语言中唯一的三元（三参数）运算符。但理论上*可以*有另一个三元运算符，而只能有一个*条件运算符*。

[Java 语言规范](http://docs.oracle.com/javase/specs/jls/se8/html/jls-15.html#jls-15.25)中给出了正式名称：

> ### §15.25 条件运算符？：
> 
> 条件运算符`? :`使用一个表达式的布尔值来决定应该计算其他两个表达式中的哪一个。

请注意，两个分支都必须指向具有返回值的方法：

> **第二个或第三个操作数表达式调用 void 方法是编译时错误。**
> 
> ^(*事实上，根据表达式语句的语法（[第 14.8 节](http://docs.oracle.com/javase/specs/jls/se8/html/jls-14.html#jls-14.8)），条件表达式不允许出现在可能出现 void 方法调用的任何上下文中。*)

因此，如果`doSomething()`和`doSomethingElse()`是 void 方法，则不能压缩：

```
if (someBool)
    doSomething();
else
    doSomethingElse(); 
```

进入这个：

```
someBool ? doSomething() : doSomethingElse(); 
```

简单的话：

```
booleanCondition ? executeThisPartIfBooleanConditionIsTrue : executeThisPartIfBooleanConditionIsFalse 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-04-28T15:36:40.260

其他人已经在合理程度上回答了这个问题，但通常使用“三元运算符”的名称。

作为学究，我想明确一点，运算符的名称是条件运算符或“条件运算符？：”。它是*一个*三元运算符（因为它有三个操作数），它恰好是目前 Java 中唯一的三元运算符。

但是，[规范非常清楚](http://docs.oracle.com/javase/specs/jls/se8/html/jls-15.html#jls-15.25)，它的名称是条件运算符或“条件运算符？：”，这是绝对明确的。我认为用这个名字来称呼它更清楚，因为它在某种程度上表明了运算符的行为（评估条件），而不仅仅是它有多少个操作数。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-04-28T15:35:13.667

根据[Sun Java Specification](http://java.sun.com/docs/books/jls/third_edition/html/expressions.html#5228)，它被称为条件运算符。请参见第 15.25 节。你对它的作用是正确的。

条件运算符 ? : 使用一个表达式的布尔值来决定应该评估其他两个表达式中的哪一个。

条件运算符在语法上是右关联的（它从右到左分组），因此 a?b:c?d:e?f:g 与 a?b:(c?d:(e?f ：G））。

```
ConditionalExpression:
        ConditionalOrExpression
        ConditionalOrExpression ? Expression : ConditionalExpression 
```

条件运算符具有三个操作数表达式；? 出现在第一个和第二个表达式之间，并且 : 出现在第二个和第三个表达式之间。

第一个表达式必须是 boolean 或 Boolean 类型，否则会发生编译时错误。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-28T15:34:42.607

```
condition ? truth : false; 
```

如果条件是`true`然后评估第一个表达式。如果条件为`false`，则计算第二个表达式。

它被称为[条件运算符](http://en.wikipedia.org/wiki/Conditional_operator)，它是一种[三元运算](http://en.wikipedia.org/wiki/Ternary_operation)。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-28T15:30:38.763

```
int count = isHere ? getHereCount(index) : getAwayCount(index); 
```

方法 ：

```
if (isHere) {
    count = getHereCount(index);
} else {
    count = getAwayCount(index);
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-28T16:03:26.687

不完全正确，准确地说：

1.  如果 isHere 为真，则**返回**getHereCount()的**结果**
***   **否则返回**getAwayCount()的**结果****

 ****那个“回归”很重要。这意味着方法**必须**返回一个值，并且该值**必须**分配到某个地方。

此外，它在语法上**并不完全**等同于 if-else 版本。例如：

```
String str1,str2,str3,str4;
boolean check;
//...
return str1 + (check ? str2 : str3) + str4; 
```

如果用 if-else 编码总是会产生更多的字节码。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-28T16:34:45.287

三元，有条件的；番茄，番茄。它真正有价值的是变量初始化。如果（像我一样）您喜欢在定义变量的地方初始化变量，那么条件三元运算符（因为两者都是）允许您在其值存在条件的情况下这样做。在 final 领域尤其显着，但在其他领域也很有用。

例如：

```
public class Foo {
    final double    value;

    public Foo(boolean positive, double value) {
        this.value = positive ? value : -value;
    }
} 
```

*如果没有该运算符 - 无论名称如何 - 您都必须使该字段成为非最终字段或编写一个函数来初始化它。*实际上，这是不对的——它仍然可以使用 if/else 来初始化，至少在 Java 中是这样。但我发现这个更清洁。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-28T17:10:35.200

您可能对一些类似于条件运算符的新运算符的[提议感兴趣。](http://mail.openjdk.java.net/pipermail/coin-dev/2009-March/000047.html)空安全运算符将启用如下代码：

```
String s = mayBeNull?.toString() ?: "null"; 
```

在进行自动拆箱时会特别方便。

```
Integer ival = ...;  // may be null
int i = ival ?: -1;  // no NPE from unboxing 
```

它已在 JDK 7 的“Project Coin”中被[选中以供进一步考虑。](http://blogs.oracle.com/darcy/entry/project_coin_for_further_consideration)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-09-13T13:41:28.720

这种结构在计算机科学和编程技术中称为**三元运算符。**[维基百科](https://en.wikipedia.org/wiki/Ternary_operation)建议以下解释
：

> 在计算机科学中，三元运算符（有时被错误地称为三元运算符）是一个接受三个参数的运算符。参数和结果可以是不同的类型。许多使用类 C 语法的编程语言都有一个三元运算符 ?: ，它定义了一个条件表达式。

不仅在 Java 中，这种语法在 PHP、Objective-C 中也可用。

在下面的[链接](http://www.webopedia.com/TERM/T/ternary_operator.html)中，它给出了以下解释，这很好理解：

> 三元运算符是在 3 个输入上进行的某种运算。它是 if-else 语句的快捷方式，也称为条件运算符。
> 
> **在 Perl/PHP 中，它的工作方式如下：**
> `boolean_condition ? true_value : false_value`
> 
> **在 C/C++ 中，它的工作方式如下：**
> `logical expression ? action for true : action for false`

这对于一些不太复杂的逻辑条件可能是可读的，否则最好将**If-Else 块**与条件逻辑的预期组合一起使用。

我们可以为一个代码语句行使用此三元运算符简化**If-Else 块。**
**例如：**

```
if ( car.isStarted() ) {
     car.goForward();
} else {
     car.startTheEngine();
} 
```

可能等于以下内容：

```
( car.isStarted() ) ? car.goForward() : car.startTheEngine(); 
```

因此，如果我们参考您的陈述：

```
int count = isHere ? getHereCount(index) : getAwayCount(index); 
```

它实际上是以下**If-Else 块**的 100% 等效项：

```
int count;
if (isHere) {
    count = getHereCount(index);
} else {
    count = getAwayCount(index);
} 
```

就是这样！
希望这对某人有帮助！
干杯!

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-28T15:30:31.087

正确的。它被**称为**[三元运算符](http://www.devdaily.com/java/edu/pj/pj010018/)。也有人称其为[条件运算符](http://www.janeg.ca/scjp/oper/ternary.html)。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-04-25T12:48:52.823

它的三元运算符(?:)

```
The ternary operator is an operator that takes three arguments. The first 
argument is a comparison argument, the second is the result upon a true 
comparison, and the third is the result upon a false comparison. 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-09-02T21:30:35.580

实际上它可能需要 3 个以上的参数。例如，如果我们想检查一个数字是正数、负数还是零，我们可以这样做：

```
String m= num > 0 ? "is a POSITIVE NUMBER.": num < 0 ?"is a NEGATIVE NUMBER." :"IT's ZERO."; 
```

这比使用 if、else if、else 更好。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-28T15:33:33.607

是的，你是对的。?: 通常称为“三元条件运算符”，通常简称为“三元运算符”。它是标准 if/else 条件的简写版本。

[三元条件运算符](http://en.wikipedia.org/wiki/Conditional_operator)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-28T15:35:25.677

它是条件运算符，它不仅仅是一种编写 if 语句的简洁方式。

由于它是一个返回值的表达式，因此它可以用作其他表达式的一部分。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-04-28T16:16:12.460

我碰巧很喜欢这个运算符，但应该考虑到读者。

你总是必须在代码紧凑性和阅读时间之间取得平衡，因为它有一些非常严重的缺陷。

首先是原始提问者的案例。他只花了一个小时发布关于它并阅读回复。作者要花多长时间来写每一个？：作为一个如果/那么在他的整个生命过程中。肯定不是一个小时。

其次，在类 C 语言中，您习惯于简单地知道条件是行中的第一件事。我在使用 Ruby 时注意到了这一点，并遇到了以下问题：

```
callMethodWhatever(Long + Expression + with + syntax) if conditional 
```

如果我是一个长期使用 Ruby 的用户，我可能不会对这一行有任何问题，但是来自 C 语言，当您看到“callMethodWhatever”作为该行中的第一件事时，您希望它会被执行。?: 不那么神秘，但仍然很不寻常，足以让读者望而却步。

然而，当您可以在其中 1 行的空间中编写 3 行 if 语句时，优势是在您的肚子里有一种非常酷的感觉。不能否认 :) 但老实说，仅仅因为它的稀有性，90% 的人不一定更容易阅读。

当它确实是基于布尔值和值的分配时，我没有问题，但它很容易被滥用。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-06-24T23:16:07.000

条件表达式的风格完全不同，语句中没有明确的 if。

语法是：布尔表达式？表达式1：表达式2；

这个条件表达式的结果是

如果布尔表达式为真，则表达式 1；

否则结果为表达式 2。

假设您要将较大数量的变量 num1 和 num2 分配给 max。您可以使用条件表达式简单地编写一个语句： max = (num1 > num2) ? 数字1：数字2；

注意：符号 ? 和 : 一起出现在条件表达式中。它们构成条件运算符，也称为三元运算符，因为它使用三个操作数。它是Java中唯一的三元运算符。

引自：Y. Daniel Liang 第 10 版 Java 编程简介，第 126 - 127 页

# .net - 用户定义的 linq 过滤器

> ID：798553
> 
> 赞同：2
> 
> 时间：2009-04-28T15:30:20.137
> 
> 标签：.net, linq, filter

我有带有用户定义过滤器的表单（带有列名的组合框、带有过滤器类型的组合框和带有值的文本框）。

如何将用户定义的过滤器动态添加到 LINQ 查询中？

典型的查询如下所示：

```
var qProducts = from p in db.Products
    where p.IsArchived == false
    order by p.ProductName select p; 
```

我正在使用 LINQ (IQerable Toolkit) 访问 SQL CE 数据库中的数据。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-28T15:49:24.520

您可能想查看[VS2008 Samples](http://code.msdn.microsoft.com/csharpsamples)中的[Dynamic LINQ](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)。然后你可以做类似的事情：

```
var qProducts = db.Products
                  .Where( "IsArchived = {0}", archiveFilterValue )
                  .OrderBy( sortColumn + " " + sortDirection ); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-28T15:53:51.560

如果需要，您可以动态添加每个过滤器，例如：

```
if (txtFilter1.Text!="") qProducts=qProducts.Where(s=>s.Name==txtFilter1.Text);
if (txtFilter2.Text!="") qProducts=qProducts.Where(s=>s.Field==txtFilter2.Text);
if (cboCombo1.SelectedValue!=0) qProducts=qProducts.Where(s=>s.price... 
```

等等

# .net - .NET 线程模型和 Application.DoEvents 与 Thread.Sleep

> ID：798562
> 
> 赞同：6
> 
> 时间：2009-04-28T15:32:04.280
> 
> 标签：.net, multithreading

我们有一个桌面应用程序，它在后台线程中执行一组非常严格的计算。此计算的一部分在我们通过互操作访问的非托管库中执行。我们发现，当我们开始计算时，UI 线程在计算期间变得无响应。我们的印象是框架会处理线程切换以允许 UI 继续响应，但事实并非如此。我们发现我们可以插入一个 Thread.Sleep(0) 或 Application.DoEvents() 来允许 UI 响应。这具有减慢计算速度的副作用。此外，由非托管代码执行的部分计算最多可能需要 30 秒才能完成，在此期间应用程序始终无响应。

这导致以下问题：

*   关于 UI 和互操作的 .NET 框架线程模型是什么？
*   我们假设框架应该处理后台和 UI 线程之间的线程切换是不正确的吗？
*   在这种情况下使用 Thread.Sleep 和 Application.DoEvents 有什么区别，其中一种优于另一种？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T15:43:05.347

您可以降低后台线程的优先级，因此操作系统会更多地抢占它。如果您有一些领域知识导致您想要控制它何时被抢占，您可以使用 Thread.Sleep(0) 如果有另一个线程在等待，它会放弃您的时间片。

Application.DoEvents 泵送 Windows 消息队列。这将导致您的应用程序响应击键或窗口大小调整等事件。Thread.Sleep 将导致您的线程被抢占（或者在 Thread.Sleep(0) 的情况下可能不会）。

另请阅读[C# 中的线程](http://www.google.com/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fwww.albahari.com%2Fthreading%2F&ei=rSP3Sea3PJzItgeN1eW7Dw&usg=AFQjCNEw0WwTr5gGrB3P4-rO0cjjTbtGQw)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T19:39:55.717

您最好的选择是创建自己的`Thread`. `DoEvents`并`Thread.Sleep(0)`阻止计算，减慢它的速度。您可以将 DLL 调用包装在`ThreadStart`委托或`ParameterizedThreadStart`委托中，并在实例化`Thread`. 从那里，您所要做的就是调用`Thread`的 Start 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-15T18:05:42.053

不过，正确的方法是使用回调。请参阅使用异步方法的 Silverlight 模型（例如，用于检索 Web 服务数据）。我知道这个问题已“回答”，但恕我直言，答案并不理想。

# c# - 属性名称和需要它的值

> ID：798567
> 
> 赞同：1
> 
> 时间：2009-04-28T15:33:18.460
> 
> 标签：c#, properties

我有一个属性的名称，需要在一个类中找到它的值，获得这个值的最快方法是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-28T15:37:06.173

我假设您在运行时拥有该属性的名称；不是在编码时...

假设您的类名为 TheClass，并且它有一个名为 TheProperty 的属性：

```
object GetThePropertyValue(object instance)
{
    Type type = instance.GetType();
    PropertyInfo propertyInfo = type.GetProperty("TheProperty");
    return propertyInfo.GetValue(instance, null);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T15:40:45.477

我假设您的意思是您将属性名称作为字符串。在这种情况下，您需要使用一些反射来获取属性值。在下面的示例中，包含该属性的对象称为`obj`。

```
var prop = obj.GetType().GetProperty("PropertyName");
var propValue = prop.GetValue(obj, null); 
```

希望有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T16:41:20.637

如果您对**运行时**的速度而不是开发感兴趣，请查看 Jon Skeet 的[使反射飞起来并探索代表](http://msmvps.com/blogs/jon_skeet/archive/2008/08/09/making-reflection-fly-and-exploring-delegates.aspx)的博客文章。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T15:34:49.330

只需使用属性的名称。如果它是可为空的属性（例如 int ? property），请使用 property.Value。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T15:39:39.270

在运行时，您可以使用反射来获取属性的值。

两个警告：

*   混淆：混淆器可能会更改属性的名称，这将破坏此功能。

*   重构：以这种方式使用反射会使代码更难重构。如果您更改了属性的名称，您可能必须搜索使用反射来根据名称获取属性值的实例。

# vb.net - 在 VB.Net 中使用 moq 的经验

> ID：798570
> 
> 赞同：9
> 
> 时间：2009-04-28T15:33:38.630
> 
> 标签：vb.net, unit-testing, mocking, moq

我真的很喜欢 moq 模拟框架。我已经在几个项目中使用过它。不幸的是，我的一位客户要求我们使用 VB.Net。不是我的偏好，但是嘿，.Net 是 .Net，对吗？

我听说起订量与 VB 有一些问题。这是真的？是这样，什么样的麻烦？鉴于 .Net 与语言无关的性质，我希望它能够正常工作。

我应该考虑使用其他一些与 VB 一起使用的模拟框架吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-28T15:57:43.377

VB.net 关于模拟框架的主要问题是，与 C# 不同，VB 没有匿名方法，只有 Lambda 表达式（无法声明匿名 Action 委托）。

这严重限制了可能性。带有参数的属性也存在一个已知问题。

此外，lambdas 语言的语法不会像 C# 那样干净、可读性好（请不要发火，我是 VB 用户，我每天都想念一些 C# 功能），这部分是 Moq 的吸引力.

我所知道的唯一与 VB 相关的测试框架是[TypeMock](http://www.typemock.com/vbpage.php)。他们试图设计一些与 VB 语法相融合的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T11:57:35.160

AFAIK Typemock Isolator 是唯一可以完全模拟 VB.NET 的工具。他们专门为此制作了一个 API。

# vcalendar - Response.ContentType = "文本/x-vcalendar"

> ID：798577
> 
> 赞同：0
> 
> 时间：2009-04-28T15:35:15.147
> 
> 标签：vcalendar

我正在尝试生成一个 vCalendar，但我收到一个错误“在这种情况下没有响应”

在 Response.ContentType = "text/x-vcalendar" 上。

我正在使用 vb.net 1.1 框架。

有任何想法吗？

-米希尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T21:38:24.010

如果您的代码包含在一个类中，您可能无法访问响应。您可以尝试使用 HttpContext.Current.Response.ContentType。

# .net - WPF Listbox 突出显示 ListBoxItem 元素的一部分

> ID：798579
> 
> 赞同：3
> 
> 时间：2009-04-28T15:35:34.413
> 
> 标签：.net, wpf, xaml, listbox, highlighting

我有一个文本框和列表框。用户可以从 TextBox 中搜索 ListBox 元素。

ListBox 绑定到 CollectionViewSource。

CollectionViewSource 具有 Filter 事件处理程序，它根据用户输入到 TextBox 的文本过滤元素。

我的要求是在 ListBoxItem 元素的 TextBlock 中突出显示用户输入的文本。

我正在考虑将 TextBlock 分解为几个 Runs 对象并修改需要突出显示的 Run 对象的 Background 属性。

我认为不可能使用 DataTemplates。

有没有简单的方法可以做到这一点？

谢谢你！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-28T16:52:29.643

**更新：我在[这篇博文](http://kentb.blogspot.com/2009/06/search-and-highlight-text-in-arbitrary.html)中详细阐述了这个主题。**

我认为没有任何简单的方法可以做到这一点，但这是我解决这个问题的方法：

1.  为列表中的项目定义视图模型。它应该包括用于显示文本并定义应该突出显示文本的哪一部分的属性（基本上是开始和结束索引）。
2.  当用户在搜索框中输入文本时，查看视图模型并检查文本中的匹配项。如果找到匹配项，请适当设置索引。如果未找到匹配项，请将索引设置回 -1 或任何表示不匹配的值。
3.  在您看来，将s`Background`的`TextBlock`s 设置为索引。使用转换器将索引转换为`GradientBrush`两个索引之间的亮黄色（或其他）。

以下是*我认为*您可以找出突出显示部分的尺寸的方法`TextBlock`：

1.  `TextPointer`通过`TextBlock.ContentStart`属性获取。
2.  `TextPointer.GetPositionAtOffset(indexOfStart)`调用using移动到选择的开头`LogicalDirection.Forwards`。
3.  `TextPointer.GetPositionAtOffset(indexOfStart)`调用using移动到选择的末尾`LogicalDirection.Backwards`。
4.  调用`TextPointer.GetCharacterRect`以获取突出显示内容的边界`Rectangle`。

老实说，我不确定最后一点是否有效。我必须自己尝试一下，我可能会为博客文章这样做。

**编辑**：刚刚有时间自己尝试一下。它确实有效，尽管我上面的逻辑略有改变。下面是演示的代码。这是一个屏幕截图：

[截图 http://img219.imageshack.us/img219/2969/searchx.png](http://img219.imageshack.us/img219/2969/searchx.png)

*Window1.xaml*：

```
<Window x:Class="TextSearch.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1">
    <StackPanel>
        <TextBox x:Name="_searchTextBox"/>
        <Grid>
            <Path Fill="Yellow" Stroke="Black" StrokeThickness="0">
                <Path.Data>
                    <RectangleGeometry x:Name="_rectangleGeometry"/>
                </Path.Data>
            </Path>
            <TextBlock x:Name="_textBlock">Some sample text that you can search through by typing in the above TextBox.</TextBlock>
        </Grid>
    </StackPanel>
</Window> 
```

*Window1.xaml.cs*：

```
using System.Windows;
using System.Windows.Controls;
using System.Windows.Documents;

namespace TextSearch
{
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();
            _searchTextBox.TextChanged += _searchTextBox_TextChanged;
        }

        void _searchTextBox_TextChanged(object sender, TextChangedEventArgs e)
        {
            var searchText = _searchTextBox.Text;
            var index = _textBlock.Text.IndexOf(searchText);

            if (index == -1)
            {
                _rectangleGeometry.Rect = Rect.Empty;
            }
            else
            {
                var textPointer = _textBlock.ContentStart;
                textPointer = textPointer.GetPositionAtOffset(index + 1, LogicalDirection.Forward);
                var leftRectangle = textPointer.GetCharacterRect(LogicalDirection.Forward);
                textPointer = textPointer.GetPositionAtOffset(searchText.Length, LogicalDirection.Backward);
                var rightRectangle = textPointer.GetCharacterRect(LogicalDirection.Forward);
                _rectangleGeometry.Rect = new Rect(leftRectangle.TopLeft, rightRectangle.BottomRight);
            }
        }
    }
} 
```

我认为代码是不言自明的。显然，您需要将该概念扩展到您的特定场景。您可能更喜欢利用组合的`Background`属性`TextBlock`a `DrawingBrush`or`GradientBrush`而不是单独的`Path`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T13:59:07.847

在 WPF 列表框中过滤。以下示例代码对我来说很好。

```
<Window x:Class="Window1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="Window1" Height="300" Width="300">
<Grid>
    <TextBox Name="txtSearch" Height="21" Margin="63,12,12,0" VerticalAlignment="Top"></TextBox>
    <ListBox Name="listItems" ItemsSource="{Binding}" Margin="22,0,0,44" Height="179" VerticalAlignment="Bottom" />
</Grid> 
```

VB.net代码

> 将数据表绑定到您的列表框

```
Dim _dtable As New DataTable("tblItems") _dtable.Columns.Add("Id", GetType(Integer))
    _dtable.Columns.Add("Name", GetType(String))
    _dtable.Columns.Add("Price", GetType(Double))
    ' Add any initialization after the InitializeComponent() call.
    For i = 100 To 110
        _dtable.Rows.Add(i, "Item " & i, 15.0)
    Next

  Private Sub Window1_Loaded(ByVal sender As Object, ByVal e As System.Windows.RoutedEventArgs) Handles Me.Loaded
    listItems.DataContext = _dtable.DefaultView
End Sub
Private Sub txtSearch_TextChanged(ByVal sender As System.Object, ByVal e As System.Windows.Controls.TextChangedEventArgs) Handles txtSearch.TextChanged 
```

**_dtable.DefaultView.RowFilter = "名称如 '" & txtSearch.Text & "%'"**

```
End Sub 
```

> 以上示例代码适用于我

# asp.net-mvc - asp.net mvc多参数请求动态图片？

> ID：798581
> 
> 赞同：3
> 
> 时间：2009-04-28T15:36:23.460
> 
> 标签：asp.net-mvc, image, dynamic, query-string, routes

在 webforms 中，我们会做这样的事情来设置一个处理程序来生成一个动态图像：

```
<img src="/barchart.aspx?width=1024&height=768&chartId=50" > 
```

然后当然我们会在 .aspx 页面上编写代码来使用参数呈现图像并将其写回响应中。

老实说，我不确定如何使用 MVC 设置/处理这样的请求，以及我们如何从视图中激活它（一般而言）。

非常欢迎提前提供任何指示或帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-28T15:39:24.280

如果我正确理解情况：

```
public class ImageGeneratorController : Controller {
    public ActionResult BarChart(int width, int height, int chartId) {
        // ASP.NET MVC will map the request parameters to method arguments
    }
} 
```

要创建链接：

```
Url.Action("BarChart", "ImageGenerator", new {
    width = 1024,
    height = 768,
    chartId = 50
}); 
```

将输出：

```
/ImageGenerator/BarChart?width=1024&height=768&chartId=50 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T15:45:25.293

你不需要一个视图来实现这一点。您可以有一个返回 a`FileResult`并将图像写入响应的操作，如下所示：

```
public FileResult BarChart(int width, int height, int chartID) {
    //create the chart
    return new FileContentResult(byte[] fileContents, string contentType);
}
```

和 html ：

```
<img src="/yourController/BarChart/1024/768/50"> 
```

# vb.net - 通用集合

> ID：798588
> 
> 赞同：0
> 
> 时间：2009-04-28T15:37:56.000
> 
> 标签：vb.net

在 VB6 中，曾经有一个 Collection 数据类型，它允许通过键或序号检索集合中的项目。但是，它不是强类型的。

现在，使用 VB.Net，我正在寻找一个合适的替代品，它是强类型并且可以与泛型集合一起使用。

这是我想做的一个简单的例子。唯一的问题是底层集合类 BindingList 不支持通过 alpha 键有效检索项目，因此我必须遍历元素以获取我要查找的项目。对于大型集合，这不是有效的。

我查看了各种 Collection 类型的类，但没有找到合适的替代品。

这就是我想要做的，除了使用 Item 属性完成的循环。

不要只是说“使用哈希表”或类似的话，如果可以的话，请包括我在下面的简短示例中所做的详细说明。

```
Public Class Car

    Public Sub New(ByVal keyName As String, ByVal property1 As String)
        _KeyName = keyName
        _Property1 = property1
    End Sub

    Dim _KeyName As String

    Public Property KeyName() As String
        Get
            Return _KeyName
        End Get
        Set(ByVal value As String)
            _KeyName = value
        End Set
    End Property

    Public _Property1 As String

    Public Property Property1() As String
        Get
            Return _Property1
        End Get
        Set(ByVal value As String)
            _Property1 = value
        End Set
    End Property

End Class

Public Class Cars

    Inherits System.ComponentModel.BindingList(Of Car)

    Public Overloads ReadOnly Property Item(ByVal key As String) As Car
        Get
            For Each CurrentCar As Car In Me.Items
                If CurrentCar.KeyName = key Then
                    Return CurrentCar
                End If
            Next
            Return Nothing
        End Get
    End Property

End Class 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-28T15:39:58.037

我相信你正在寻找[`Dictionary<TKey, TValue>`](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx). 事实上，如果您确实想要自己的强类型集合类并且（本身）不是通用的，如果您将父类更改为`Dictionary<string, Car>`，那么您应该一切就绪。当然，这一切都假设您使用显式字符串键将汽车添加到集合中。如果您希望查找基于集合中属性的值，则最好使用或继承`List<Car>`并使用 LINQ 来查询列表。那么你可以...

```
Public Overloads ReadOnly Property Item(ByVal key As String) As Car
    Get
        Return (from c in Me where c.KeyName = key select c).SingleOrDefault()
    End Get
End Property 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T15:48:49.560

你真的需要通过键和索引访问吗？

如果没有，则使用 Dictionary(Of String, Car)，并使用 -`MyCol.Items("XXX")`按键检索项目（或简写 MyCol("XXX")） -`MyCol.ContainsKey("XXX")`测试集合中是否存在键 -`For Each Entry as KeyValuePair(Of String, Car)`在 MyCol 中如果您想枚举所有对象及其键 - 如果您想在不考虑键的情况下枚举条目，则在 MyCol.Values 中将每个条目作为 Car

如果您需要通过索引和键进行访问，恐怕您最好的选择是将 List(of Car) 和 Dictionary(of Car) 滚动到一个自定义集合类中，因为我相信它们已经远离了那种集合对于大多数问题来说并不是那么有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T15:54:38.800

这是我认为是我最好的解决方案。我欢迎评论以获得更好的方法！

```
Imports Microsoft.VisualBasic

Public Class Car

    Implements Xs(Of Car).IKeyName

    Private _KeyName As String

    Public Sub New(ByVal keyName As String, ByVal property1 As String)
        _KeyName = keyName
        _Property1 = property1
    End Sub

    Public Property KeyName() As String Implements Xs(Of Car).IKeyName.KeyName
        Get
            Return _KeyName
        End Get
        Set(ByVal value As String)
            _KeyName = value
        End Set
    End Property

    Public _Property1 As String

    Public Property Property1() As String
        Get
            Return _Property1
        End Get
        Set(ByVal value As String)
            _Property1 = value
        End Set
    End Property

End Class

Public Class Cars

    Inherits System.ComponentModel.BindingList(Of Car)

    Public Overloads ReadOnly Property Item(ByVal key As String) As Car
        Get
            For Each CurrentCar As Car In Me.Items
                If CurrentCar.KeyName = key Then
                    Return CurrentCar
                End If
            Next
            Return Nothing
        End Get
    End Property

End Class

Public Class X

    Private _KeyName As String

    Public Property KeyName() As String
        Get
            Return _Keyname
        End Get
        Set(ByVal value As String)
            _Keyname = value
        End Set
    End Property
End Class

Public Class Xs(Of X)

    Inherits Hashtable

    Interface IKeyName
        Property KeyName() As String
    End Interface

    Public Shadows Sub Add(ByVal item As IKeyName)
        MyBase.Add(item.KeyName, item)
    End Sub

    Public Shadows ReadOnly Property Item(ByVal key As String) As x

        Get
            If Me.ContainsKey(key) Then
                Return MyBase.Item(key)
            Else
                'If I mispell a key, I don't want to end up creating a new mispelled version, I want an error
                Throw New Exception("Element with key " & key & " is not found")
            End If
        End Get
    End Property

End Class

Public Class Cars2

    Inherits Xs(Of Car)

End Class

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

        Dim MyCar As New Car("key1", "prop1")

        'First approach
        Dim MyCars As New Cars

        MyCars.Add(MyCar)

        Dim RetrievedCar As Car = MyCars.Item("key1") 'Inefficient retrieval by key (uses looping)

        'Second approach
        Dim Cars2 As New Cars2

        Cars2.Add(MyCar)

        Dim RetrievedCar2 As Car = Cars2.Item("key1") 'Can now efficiently retreive an item by its key

End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T02:36:54.603

System.Collections.Specialized 命名空间中的[OrderedDictionary](http://msdn.microsoft.com/en-us/library/system.collections.specialized.ordereddictionary(VS.80).aspx)可以通过索引和键访问，如果您需要的话。但是看看你的解决方案，它看起来像一个标准的字典，但效率较低，因为它强制为键使用字符串类型。

有什么理由你不能使用 Dictionary .NET 为你提供的，或者其他已经存在于 .NET 中的集合类型，比如 OrderedDictionary？

# iphone - 如果您丢失了私钥，删除旧的分发证书会有什么后果？(iPhone SDK)

> ID：798592
> 
> 赞同：6
> 
> 时间：2009-04-28T15:38:23.737
> 
> 标签：iphone, xcode, code-signing, provisioning

如果我丢失/无法访问与分发证书关联的私钥：

1.  我可以创建一个新的吗？

2.  如果我这样做，在提交过程中会不会产生任何问题？

3.  使用旧证书签名的应用程序会停止工作吗？

4.  我能否更新使用旧证书签名的应用程序？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-28T15:56:36.047

您可以在 iPhone Developer Program Portal 上申请新的分发证书，然后为 App Store 分发创建一个新的 Provisioning Profile。

这不会对分发过程造成任何问题。

使用旧证书上传的应用程序将继续运行，您将能够发布现有应用程序的更新。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-27T02:35:03.910

请参阅 Apple 的这篇文章，其中明确提到

> 重要提示：标准 iOS 开发者计划的成员可以放心，更换您的开发者证书或分发证书不会影响您在 iOS App Store 中发布的任何现有应用程序，也不会影响您更新这些应用程序的能力。

[https://developer.apple.com/legacy/library/technotes/tn2250/_index.html](https://developer.apple.com/legacy/library/technotes/tn2250/_index.html)

# django - 将用户发送到基于他们在 Django 中的 POST 请求创建的页面

> ID：798604
> 
> 赞同：3
> 
> 时间：2009-04-28T15:41:33.120
> 
> 标签：django, web-applications, redirect

我有一个表单，用户可以在其中选择一些项目以显示在“下一页”上。此选择始终是唯一的，我们将存储使用模型进行的每组选择，由`id`与 Django 模型相同的索引。当用户选择她的选择并`POST`使用提交按钮时，我希望我们的应用程序将她的选择存储在模型中，然后使用模型的 id 渲染一个页面，以便用户可以返回到她创建的页面在任何时候只要一个简单的`GET`请求。

例如，用户转到`/coolapp/selectprefs/`，进行一些选择，然后单击提交。然后，用户应该被`/coolapp/selections/42`认为当用户提交并创建记录时，记录被赋予`id`了`42`。

我不明白的是如何在用户`/coolapp/selections/42`单击提交按钮后将用户发送到“下一页”作为响应（例如，在上面的示例中）。根据用户输入的内容将用户带到具有唯一 ID 的页面似乎是一项常见任务（例如，当我单击按钮在 SO 上提交此问题时会发生），但我不知道该怎么做它，并会感谢你的建议。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-28T15:53:51.560

从处理 POST 的视图中返回一个[HttpResponseRedirect](http://docs.djangoproject.com/en/dev/ref/request-response/#django.http.HttpResponseRedirect)。

# c++ - 在 C（或 C++）中取消引用指针的语法

> ID：798612
> 
> 赞同：11
> 
> 时间：2009-04-28T15:45:12.940
> 
> 标签：c++, c, syntax, pointers

我让一位同事在 C 中检查了这样的代码（语法 #1）：

```
(*(*(*p_member).p_member).p_member).member 
```

当我问他为什么不使用 -> （语法 #2）时：

```
p_member->p_member->p_member->member 
```

他非常自卫地说语法＃2比＃1更复杂......我最终改变了他的代码，因为我不得不修改它并且无法阅读它，然后他生气我真的触摸了它......

SO 社区更喜欢哪种语法？两者都是有效的，但我发现语法 #2 更具可读性。

由于问题是主观的，我将其设置为社区 wiki。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-28T15:50:02.820

语法＃1 的技术术语是“坚果”。

也就是说，我有点担心必须间接执行 3 次的代码。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-28T16:01:30.467

我认为你的同事要么是缺乏经验，要么是某种新恐惧症，要么就是一无所知。你会发现一致的选择是使用 -> 语法。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-28T15:49:03.727

在 C++ 中我肯定会使用 ->，因为 -> 可以被重载。

在 CI 中也会使用 -> ，因为它更易于阅读、输入更快且不易出错（希望您的同事不会迷失在括号中！）。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-28T18:17:45.820

我在这里打字，但我记得 C 中运算符存在的逻辑在`->`K&R 的第 1 版中被解释为（释义）：因为否则你必须输入`(*p).a`由于必要的`*`和运算符的优先级`.`。

不用`->`于其预期目的是坚果。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-28T15:47:41.157

我会选择 2 号门，蒙蒂！当然它更难键入，但它比找出哪些运算符取消引用哪个指针更清楚。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-28T16:01:07.957

您可能还希望在您的团队中讨论“代码所有权”的概念。你的同事不“拥有”代码，公司拥有。因此，公司雇用的任何人都可以有充分的理由对其进行编辑。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-28T15:49:13.570

主观的吧？

我也会拿#2！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-28T15:50:11.790

第二种变体显然看起来更清晰。喜欢 #1 的唯一原因是当 #1 的效果与 #2 完全不同时，一些奇怪的 operator * 和 operator -> 重载。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-29T09:03:03.570

坏同事。换同事。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-07-21T02:24:09.130

I've had experiences where "->" wasn't properly implemented in a couple of compilers... so the normal (*p).a was more likely to work when you have multiple levels of nesting.

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-04-28T15:56:04.350

没有 2。

话虽如此，不要通过更改代码来冒犯人们，尤其是在风格问题上。这不值得。

# security - 检测防病毒状态

> ID：798615
> 
> 赞同：1
> 
> 时间：2009-04-28T15:46:00.067
> 
> 标签：security, winapi, antivirus

根据[http://support.microsoft.com/kb/883792，MS](http://support.microsoft.com/kb/883792)可以使用 WMI 或涉及 MS 知道的注册表项的手动方法检测已安装的 AV。是否有 API 可以访问此功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T21:34:59.340

[这个谷歌搜索](http://www.google.com/search?q=win32+security+center+api)产生[了这个 MSDN 文档](http://msdn.microsoft.com/en-us/library/bb963845(VS.85).aspx)，它似乎是你正在寻找的，Windows 安全中心 API。文档只说 Vista，但我相信这个 API 也可以通过[Windows XP SP2 SDK](http://msdn.microsoft.com/en-us/security/aa570371.aspx)获得。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T16:04:22.083

如果您找不到它的文档并且想要进行一些手动挖掘，您可以尝试从 SysInternals 执行[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)，然后启动安全中心。它将向您显示读取了哪些密钥以及访问了哪些文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T16:00:14.790

如果您知道密钥，则可以使用 Win32 注册表访问 API。

# .net - 我需要从 .snk 文件中发布公钥吗？

> ID：798621
> 
> 赞同：5
> 
> 时间：2009-04-28T15:47:27.927
> 
> 标签：.net, assemblies, strongname

从 sn.exe 实用程序的描述和[这个问题](https://stackoverflow.com/questions/131181/what-is-a-snk-for)中，我看到公钥的副本被添加到使用强名称签名的每个程序集中。这足以验证程序集二进制文件没有被更改。

但是如何验证给定的程序集确实是用给定的密钥对签名并由给定的公司编译的呢？任何人都可以生成自己的密钥对，生成一些程序集并用他的密钥对进行签名。我是否需要发布公钥，以便那些想要验证程序集来源的人可以比较公钥？如果是这样，最好的方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-29T11:57:37.067

不，您不需要在程序集之外发布您的公钥，因为它被散列并作为令牌存储在客户端应用程序内的引用旁边：

```
AssemblyName, Version=1.0.0.0, Culture=neutral, PublicKeyToken=bcd6707151635d07" 
```

这提供了一种方法来确保程序集的所有未来版本都针对相同的密钥对进行编译，因此来自相同的发布者。

有关*如何*获取此信息阻止其他来源假装您的更多详细信息，请参阅我的其他答案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-28T17:19:57.860

我一直理解签署程序集的目的是作为运行时检查，以确保对代码的升级来自受信任的来源。实际上，他们正试图避免这种情况：

我从 A 公司购买了一个加密库，不久之后，B 公司获得了我的电子邮件详细信息，并向我发送了一个免费升级到该程序集，假装是 A 公司的一个重大安全错误修复程序，当它真正向我的代码中注入了一个隐藏的方法时将我试图加密的所有数据发送到 B 公司的服务器。假设我是个白痴，并且盲目地将这个新的 dll 添加到我的应用程序的 bin 目录中，那么它没有使用与旧版本相同的私钥签名的事实将在运行时被拾取，从而导致异常并保护我的数据。

因此，我认为您没有理由在程序集之外发布公钥，因为它不应该保证原始文件来自特定供应商，只是所有后续版本都来自与第一个版本相同的位置。

[维基百科](http://en.wikipedia.org/wiki/.NET_Framework#Assemblies)说了很多同样的话（只是用更少的词）。

* * *

编辑以添加更多信息，以使这一点更清晰......

我认为首先需要澄清的是公钥和私钥对是唯一的。这意味着知道公钥不足以重建程序集以使其通过相同的哈希检查。

因此，用户 Z 正在使用公司 A 的加密库，该加密库位于他的应用程序 bin 文件夹中。为此，他按如下方式引用 DLL：

```
Encryption, Version=1.0.0.0, Culture=neutral, PublicKeyToken=bcd6707151635d07" 
```

公钥的目的是为我们提供[三个好处](http://msdn.microsoft.com/en-us/library/wd40t7ad.aspx)，我将一次处理一个。

首先，它为程序集提供了一个唯一的名称——这没有给我们额外的安全性，但确实阻止了 C 风格的 dll 地狱，两家不同的公司可以发布两个不同的库，称为 Encyption 版本 1.0.0.0，而你将无法将它们存储在相同的目录，因为没有办法区分它们。

其次，它阻止了我在原始帖子中概述的场景。B 公司不可能创建另一个版本的加密库，它也是 1.0.0.0 版本并且具有相同的公钥（这样整个名称就会匹配，并且您会调用他们的代码而不是 A 公司的代码）。他们不能这样做，因为如果他们的公钥匹配，那么私钥也必须匹配（因为每一*对* 都是唯一的）。他们可以让私钥匹配的唯一方法是破坏 A 公司的安全性。

最后，它确保文件的完整性（通过损坏或恶意代码注入进行更改）。dll 在运行时（当它是私有的并且在应用程序的 bin 文件夹中时）或安装时（当您将其放入 GAC 时）使用公钥进行哈希处理，并将该哈希值与私有加密的哈希值进行比较密钥并存储在程序集中。[这个页面](http://www.ondotnet.com/pub/a/dotnet/2003/04/28/strongnaming.html)有一些图表和更多细节。再次伪造这个散列的唯一方法是知道私钥。

因此，为了涵盖我上面描述的特定场景，假设我是 B 公司，试图向用户 Z 提供加密 dll 的恶意版本。我的第一次尝试是简单地使用名称加密和版本 1.0.0.0 制作我自己的 dll，并使用我自己的密钥对对其进行签名。不幸的是，我无法更改用户 Z 应用程序中的参考代码，因此它无法通过全名检查并且不会被加载。“好吧，”我一边捻着小胡子一边说，“我将简单地更改我的程序集的公钥以匹配 A 公司的公钥。” 完成此操作后，名称检查通过，但哈希检查将失败，因为用户 Z 的应用程序将无法使用公钥（公司A's) 已提供。因此，B 公司创建伪装成 A 公司的库的唯一方法是知道 A 公司的私钥。这些安全检查都不依赖于 A 公司在其他任何地方发布公钥，但在程序集的原始版本中。

另请注意，所有这些功能都不能确保（也不声称确保）原始程序集来自 A 公司，由[Verisign](http://www.verisign.co.uk/)或 Microsoft 的[Authenticode](http://technet.microsoft.com/en-us/library/cc750035.aspx)服务等其他系统处理，它们仅确保一旦您拥有引用了该程序集，只有 A 公司可以更改该代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-28T17:27:33.303

1.  您可以去一些 3d 方证书提供商（例如 VeriSign）并从他们那里购买证书（[在 Verisign 进行代码签名](http://www.verisign.com/code-signing/index.html?sl-hppd)）。
2.  您使用带有您的公司名称、URL 等的给定证书来签署您的代码。
3.  我下载了你的应用程序，然后查看你的应用程序所使用的证书列表。
4.  我使用您的证书，返回 VeriSign 并验证该证书确实已颁发给 MyCompany, LLC。
5.  我查看了已用于颁发您的证书的证书，并验证 VeriSign 是其中之一（Windows 附带安装了一些受信任的证书）。

**摘要：**
您不仅验证了代码没有被修改过，而且还使用您信任的一方颁发的证书进行了签名。

# sorting - 在 lucene.net 中排序

> ID：798622
> 
> 赞同：8
> 
> 时间：2009-04-28T15:47:32.043
> 
> 标签：sorting, lucene

我得到了我的 lucene 索引，其中包含一个需要排序的字段。我有我的查询，我可以创建我的 Sort 对象。如果我从 javadoc 中理解正确，我应该能够执行 query.SetSort()。但是好像没有这样的方法...

当然我错过了一些重要的东西。有什么建议么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-28T18:36:26.443

其实有两点很重要。首先，该字段必须被索引。其次，将`Sort`对象传递给重载的[`search`](http://incubator.apache.org/lucene.net/docs/1.4.3/api/Lucene.Net.Search.Searcher.Search_overload_5.html)方法。

上次我查看时，文档并没有很好地指出索引部分，当然也没有解释为什么会这样。花了一些时间来找出原因。

当字段可排序时，搜索器会为索引中的每个文档创建一个包含一个元素的数组。它使用术语索引中的信息来填充这个数组，以便它可以非常快速地执行排序。如果你有很多文档，它会占用很多内存，所以除非有需要，否则不要让字段可排序。

还有一点需要注意：可排序字段的每个字段中存储的值不得超过一个。如果有多个值，Lucene 不知道将哪个用作排序键。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T16:01:23.930

看起来您想要的实际方法是例如[Searcher.search(Query query, Filter filter, int n, Sort sort)](http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/Searcher.html#search(org.apache.lucene.search.Query,%20org.apache.lucene.search.Filter,%20int,%20org.apache.lucene.search.Sort))。setSort 是[Sort](http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/Sort.html)的一种方法。

# windows - 重定向到自定义 URL 协议时出错

> ID：798629
> 
> 赞同：2
> 
> 时间：2009-04-28T15:48:55.583
> 
> 标签：windows, internet-explorer

在我的帖子中，我提到了在电子邮件中发送自定义 URL 协议链接的问题[。](https://stackoverflow.com/questions/795463/custom-url-protocol-in-windows-emailing-links)我通过发送指向网页的链接解决了这个问题，然后重定向到自定义 URL 协议（可能发送直接链接的问题是 Gmail（可能还有其他提供商）将我的协议视为“不安全”因此将其从电子邮件中删除）。

这很好，很漂亮，*除了*在 IE8 中（我不确定 IE7）。如果我在 FF3 和 Chrome 中访问该页面，它会按我的预期打开我的程序。在 IE8 中，我只是得到一个通用的“Internet Explorer 无法显示网页”错误。有谁知道为什么 IE8 不会提示我运行程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T06:42:01.770

在现代网络世界中，自定义 URL 通常被认为是危险或不安全的内容。您使用 gmail 的经验就是一个例子。许多浏览器的设计会限制或阻止它们无法识别的 URL 方案。错误页面可能是 IE8 的默认行为。我在研究我的 IE8 特定问题时运气不佳，因此可能需要其他人来填补空白。（维基标志打开）。

# jasper-reports - 带有动态内容的文本字段的僵局

> ID：798640
> 
> 赞同：1
> 
> 时间：2009-04-28T15:51:05.763
> 
> 标签：jasper-reports

我真的希望有人对这个布局问题有所了解，因为我已经没有想法了。

虽然我认为我的问题与设计有关，即 Jasper 处理它们的方式（布局），但这里有一些关于应用程序的一般信息。

基本上我们有一个 JAVA 客户端-服务器应用程序，我们使用 Jasper 生成一堆报告。Jasper 设计由服务器端的 servlet 处理，并作为 jrprint 文件发送到客户端，并在客户端呈现给用户。我们还有一个 scriptlet 可以做一些事情——连接数据等。

我遇到问题的报告具有以下结构，如代码片段 #1 所示

它的数据来自一个完美运行的 SQL 查询，所以只有布局困扰着我。

在细节上，我有一堆文本字段可以可视化一些层次结构和另一个可以包含相对大量文本的文本字段。我把它们都装在一个框架中，它们都建立了另一个框架。

在它们下面我有另一个框架，可以包含 0,1 或 2 个图像（理想情况下）。我最终得到一份报告，其中包含附件 1 中的页面。

我的目标是在上面的框架和图像框架之间没有空间的报告页面 - 就像附件 2 中的那样，当然还有上框架内的文本。目前，这只有在我摆脱冗长的文本时才有可能。

在我看来，问题在于冗长文本的字段定义。由于我不知道字符串有多长，我将其定义为高度 13（代码片段 #2），即只有一行。由于字段的拉伸特性，它相应地适应，但这样做会将图像向下推可变行数。那么，有什么办法可以避免破坏设计的“推动”。

* * *

### 代码：

```
<band height="245" isSplitAllowed="false"><!-- 245 -->
  <frame>
    <reportElement isRemoveLineWhenBlank="true"
      positionType="Float" width="545" y="0" x="0" height="75"
      stretchType="RelativeToBandHeight">
    </reportElement>

    <box>
      <pen lineColor="black" lineStyle="Solid"
        lineWidth="1" />
    </box>

    <frame>
      <reportElement isRemoveLineWhenBlank="true"
        positionType="FixRelativeToTop" width="200" y="0" x="55"
        height="75" stretchType="RelativeToTallestObject"/>

      <box>
        <pen lineColor="green" lineStyle="Solid"
          lineWidth="3" />
      </box>

      <textField isStretchWithOverflow="true" pattern=""
        isBlankWhenNull="true" evaluationGroup="Ebene2">
        <reportElement x="0" y="0" width="200"
          height="13" positionType="Float" isRemoveLineWhenBlank="true"
          isPrintInFirstWholeBand="true">
          <printWhenExpression><![CDATA[new Boolean(  ($F{AnlagenEbeneOfSchaden}).intValue()==1 )]]></printWhenExpression>
        </reportElement>

        <textElement>
          <font fontName="Arial" size="10"
            isBold="true" isItalic="false" isUnderline="false"
            isStrikeThrough="false" pdfFontName="Helvetica-Bold"
            pdfEncoding="CP1252" isPdfEmbedded="false" />
        </textElement>
        <textFieldExpression class="java.lang.String"><![CDATA[((alwin2Scriptlet)$P{REPORT_SCRIPTLET}).getStrukturBezMitStandOrtEbeneDB($F{Strukturcode1}, 1)]]></textFieldExpression>
      </textField>

      <textField isStretchWithOverflow="true" pattern=""
        isBlankWhenNull="true" evaluationGroup="Ebene2">
        <reportElement x="15" y="0" width="185"
          height="13" mode="Opaque" positionType="Float"
          isRemoveLineWhenBlank="true" isPrintInFirstWholeBand="true" />
        <textElement>
          <font fontName="Arial" size="10"
            isBold="true" isItalic="false" isUnderline="false"
            isStrikeThrough="false" pdfFontName="Helvetica-Bold"
            pdfEncoding="CP1252" isPdfEmbedded="false" />
        </textElement>
        <textFieldExpression class="java.lang.String"><![CDATA[((alwin2Scriptlet)$P{REPORT_SCRIPTLET}).getStrukturBezMitStandOrtEbeneDB($F{Strukturcode1}, 2)]]></textFieldExpression>
      </textField>
      <textField isStretchWithOverflow="true" pattern=""
        isBlankWhenNull="true" evaluationGroup="Ebene3">
        <reportElement mode="Opaque" x="30" y="15"
          width="170" height="13" positionType="Float"
          isRemoveLineWhenBlank="true" />
        <textElement>
          <font fontName="Arial" size="10"
            isBold="false" isItalic="false" isUnderline="false"
            isStrikeThrough="false" pdfFontName="Helvetica"
            pdfEncoding="CP1252" isPdfEmbedded="false" />
        </textElement>
        <textFieldExpression class="java.lang.String"><![CDATA[((alwin2Scriptlet)$P{REPORT_SCRIPTLET}).getStrukturBezMitStandOrtEbeneDB($F{Strukturcode1}, 3)]]></textFieldExpression>
      </textField>

      <textField isStretchWithOverflow="true" pattern=""
        isBlankWhenNull="true">
        <reportElement mode="Opaque" x="45" y="30"
          width="155" height="13" positionType="Float"
          isRemoveLineWhenBlank="true" />
        <textElement>
          <font fontName="Arial" size="10"
            isBold="false" isItalic="false" isUnderline="false"
            isStrikeThrough="false" pdfFontName="Helvetica"
            pdfEncoding="CP1252" isPdfEmbedded="false" />
        </textElement>
        <textFieldExpression class="java.lang.String"><![CDATA[((alwin2Scriptlet)$P{REPORT_SCRIPTLET}).getStrukturBezMitStandOrtEbeneDB($F{Strukturcode1}, 4)]]></textFieldExpression>
      </textField>
      <textField isStretchWithOverflow="true" pattern=""
        isBlankWhenNull="true">
        <reportElement mode="Opaque" x="60" y="45"
          width="140" height="13" positionType="Float"
          isRemoveLineWhenBlank="true" />
        <textElement>
          <font fontName="Arial" size="10"
            isBold="false" isItalic="false" isUnderline="false"
            isStrikeThrough="false" pdfFontName="Helvetica"
            pdfEncoding="CP1252" isPdfEmbedded="false" />
        </textElement>
        <textFieldExpression class="java.lang.String"><![CDATA[((alwin2Scriptlet)$P{REPORT_SCRIPTLET}).getStrukturBezMitStandOrtEbeneDB($F{Strukturcode1}, 5)]]></textFieldExpression>
      </textField>
      <textField isStretchWithOverflow="true" pattern=""
        isBlankWhenNull="true">
        <reportElement mode="Opaque" x="75" y="60"
          width="125" height="13" positionType="Float"
          isRemoveLineWhenBlank="true" />
        <textElement>
          <font fontName="Arial" size="10"
            isBold="false" isItalic="false" isUnderline="false"
            isStrikeThrough="false" pdfFontName="Helvetica"
            pdfEncoding="CP1252" isPdfEmbedded="false" />
        </textElement>
        <textFieldExpression class="java.lang.String"><![CDATA[((alwin2Scriptlet)$P{REPORT_SCRIPTLET}).getStrukturBezMitStandOrtEbeneDB($F{Strukturcode1}, 6)]]></textFieldExpression>
      </textField>
    </frame>

    <textField isStretchWithOverflow="true" pattern=""
      isBlankWhenNull="true">
      <reportElement mode="Opaque" x="30" y="1" width="20"
        height="13" isRemoveLineWhenBlank="true" />
      <textElement>
        <font fontName="Arial" size="10" isBold="true"
          isItalic="false" isUnderline="false" isStrikeThrough="false"
          pdfFontName="Helvetica" pdfEncoding="CP1252"
          isPdfEmbedded="false" />
      </textElement>
      <textFieldExpression class="java.lang.Integer"><![CDATA[$V{REPORT_COUNT}]]></textFieldExpression>
    </textField>
    <textField isStretchWithOverflow="true" pattern=""
      isBlankWhenNull="true">
      <reportElement mode="Opaque" x="515" y="1"
        width="20" height="13" isRemoveLineWhenBlank="true" />
      <textElement textAlignment="Right">
        <font fontName="Arial" size="11" isBold="true"
          isItalic="false" isUnderline="false" isStrikeThrough="false"
          pdfFontName="Helvetica-Bold" pdfEncoding="CP1252"
          isPdfEmbedded="false" />
      </textElement>
      <textFieldExpression class="java.lang.String"><![CDATA[$F{Bewertung}]]></textFieldExpression>
    </textField>
    <frame>
      <reportElement isRemoveLineWhenBlank="true"
        positionType="FixRelativeToTop" width="240" y="0" x="255"
        height="15" stretchType="RelativeToTallestObject" />

      <box>
        <pen lineColor="red" lineStyle="Solid"
          lineWidth="3" />
      </box>

      <textField isStretchWithOverflow="true"
        isBlankWhenNull="true">
        <reportElement mode="Opaque" x="0" y="1"
          width="240" height="13" isRemoveLineWhenBlank="true"
          isPrintWhenDetailOverflows="true"  />
        <textElement verticalAlignment="Top">
          <font fontName="Arial" size="10"
            isBold="false" isItalic="false" isUnderline="false"
            isStrikeThrough="false" pdfFontName="Helvetica"
            pdfEncoding="CP1252" isPdfEmbedded="false" />
        </textElement>
        <textFieldExpression class="java.lang.String"><![CDATA[$F{SCHADENGRUPPE} + ($F{SCHADENBESCHREIBUNG}!=null?$F{SCHADENBESCHREIBUNG}:"")+" ["+$F{SCHADENNR}+"]"]]></textFieldExpression>
      </textField>
    </frame>
  </frame>
  <frame>
    <reportElement isRemoveLineWhenBlank="true"
      positionType="Float" width="545" y="76" x="0" height="155">
      <printWhenExpression><![CDATA[new Boolean( (!($F{BILD1_FILE} == null) ) || (!($F{BILD2_FILE} == null)) )]]></printWhenExpression>
    </reportElement>
    <!--        <box padding="5">
      <pen lineColor="black" lineStyle="Solid"
      lineWidth="3" />
      </box>
    -->
    <image vAlign="Top" hAlign="Center">
      <reportElement positionType="Float" x="303" y="0"
        width="212" height="145" isPrintWhenDetailOverflows="true"
        isRemoveLineWhenBlank="true">
        <printWhenExpression><![CDATA[new Boolean( (!($F{BILD1_FILE} == null) ) && ($F{BILD2_FILE} == null) )]]></printWhenExpression>
      </reportElement>
      <graphicElement />
      <imageExpression class="java.awt.Image"><![CDATA[$F{BILD1_FILE}]]></imageExpression>
    </image>
    <image vAlign="Top" hAlign="Center">
      <reportElement positionType="Float" x="303" y="0"
        width="212" height="145" isPrintWhenDetailOverflows="true"
        isRemoveLineWhenBlank="true">
        <printWhenExpression><![CDATA[new Boolean( (!($F{BILD2_FILE} == null)) && ($F{BILD1_FILE} == null) )]]></printWhenExpression>
      </reportElement>
      <graphicElement />
      <imageExpression class="java.awt.Image"><![CDATA[$F{BILD2_FILE}]]></imageExpression>
    </image>
    <image vAlign="Top" hAlign="Center">
      <reportElement positionType="Float" x="70" y="0"
        width="212" height="145" isPrintWhenDetailOverflows="true"
        isRemoveLineWhenBlank="true">
        <printWhenExpression><![CDATA[new Boolean( (!($F{BILD1_FILE} == null) ) && (!($F{BILD2_FILE} == null)) )]]></printWhenExpression>
      </reportElement>
      <graphicElement />
      <imageExpression class="java.awt.Image"><![CDATA[$F{BILD1_FILE}]]></imageExpression>
    </image>
    <image vAlign="Top" hAlign="Center">
      <reportElement positionType="Float" x="303" y="0"
        width="212" height="145" isPrintWhenDetailOverflows="true"
        isRemoveLineWhenBlank="true">
        <printWhenExpression><![CDATA[new Boolean( (!($F{BILD2_FILE} == null)) && (!($F{BILD1_FILE} == null)) )]]></printWhenExpression>
      </reportElement>
      <graphicElement />
      <imageExpression class="java.awt.Image"><![CDATA[$F{BILD2_FILE}]]></imageExpression>
    </image>
  </frame>

  <line>
    <reportElement positionType="Float" mode="Opaque" x="0"
      y="240" width="525" height="1" />
    <graphicElement pen="Thin" />
  </line>

  <!--
    <frame>
    <reportElement isRemoveLineWhenBlank="true"
    positionType="Float" width="545" y="86" x="0" height="170">
    <printWhenExpression><![CDATA[new Boolean( (!($F{BILD1_FILE} == null) ) || (!($F{BILD2_FILE} == null)) )]]></printWhenExpression>
    </reportElement>
    <box>
    <pen lineColor="black" lineStyle="Solid"
    lineWidth="1" />
    </box>
    </frame>
  -->
</band> 
```

### 代码：

```
<textField isStretchWithOverflow="true"
  isBlankWhenNull="true">
  <reportElement mode="Opaque" x="0" y="1"
    width="240" height="13" isRemoveLineWhenBlank="true"
    isPrintWhenDetailOverflows="true"  />
  <textElement verticalAlignment="Top">
    <font fontName="Arial" size="10"
      isBold="false" isItalic="false" isUnderline="false"
      isStrikeThrough="false" pdfFontName="Helvetica"
      pdfEncoding="CP1252" isPdfEmbedded="false" />
  </textElement>
  <textFieldExpression class="java.lang.String"><![CDATA[$F{SCHADENGRUPPE} + ($F{SCHADENBESCHREIBUNG}!=null?$F{SCHADENBESCHREIBUNG}:"")+" ["+$F{SCHADENNR}+"]"]]></textFieldExpression>
</textField> 
```

* * *

### 截图：

[截图 1](http://www.imagechicken.com/uploads/1240937692037795400.jpg)

[截图 2](http://www.imagechicken.com/uploads/1240937425007514300.jpg)

# actionscript-3 - 在 Actionscript 3 中预加载 FLV？

> ID：798650
> 
> 赞同：1
> 
> 时间：2009-04-28T15:54:28.783
> 
> 标签：actionscript-3, video, flv, preloader

我正在开发一个具有大量基于视频的部分到部分转换的 Flash 站点。过渡视频本身只有几秒钟长，但相当重（~700kb），因为它们的分辨率非常高；考虑到部分的数量和部分到部分的转换组合（以及视频），在初始站点加载时预加载所有转换是不可行的。

我想做的是根据需要快速加载每个过渡视频；例如，如果您在区域 A 并单击区域 B 的导航，则会加载 A->B 视频（大多数用户只需等待几秒钟）然后播放。但是，我还想要一个快速加载器图形显示为过渡加载，在它被播放之前（像加载条这样简单的东西，但不仅仅是一个微调器或类似的东西，因为确定进度的感觉很重要）。

在 Actionscript 3 中执行此操作的最佳方法是什么？它在 AS2 中相对简单（[http://livedocs.adobe.com/flash/9.0/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00001036.html](http://livedocs.adobe.com/flash/9.0/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00001036.html)）但我还没有看到AS3 的简单解决方案。我在 AS3（NetConnection、NetStream、视频对象）中使用基于标准代码的 FLV 播放技术——没有 FLVPlaybackComponents 或类似技术。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T18:29:31.577

在 AS3 中并没有太大的不同。只需使用计时器而不是间隔。您在将该代码转换为 AS3 时遇到问题吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T18:52:11.507

Adobe 网站上的示例仍然有效，只需添加：

```
import flash.utils.setInterval; 
```

# php - 如何存储 php 应用程序的配置——xml 或 ini 或 db

> ID：798654
> 
> 赞同：11
> 
> 时间：2009-04-28T15:55:34.257
> 
> 标签：php, configuration

我有一个用 PHP 编写的应用程序，并且有许多可配置的变量。我们正在实施一项功能，用户可以创建配置集并在它们之间轻松切换。我应该如何存储我的配置？作为 XML？在 .ini 文件中？在多个 .ini 文件中？在数据库中？

如果我们在路上添加字段，什么会提供最大的灵活性？编码方便吗？

如果我使用数据库，我将不得不使用与应用程序的主数据库分开的数据库，原因不值得一提，这让我回避了这一点。（此外，我们正在为我们的数据库使用 .mdb 文件。）

我一直在走 xml 路线，但在使用 SimpleXML 添加和编辑配置时遇到问题。此外，该应用程序必须与 php 5.1.6 兼容，我对某些功能有些紧张。

从来没有真正处理过创建自定义 ini 文件....

一个小的澄清：用户不会接触文件——他们不是技术人员。所以设置初始文件将由我们完成，但随后我们正在编写一个工具，将它们的配置写入我们选择的任何格式。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-28T16:07:24.087

我会将配置项存储在 PHP 文件中。*这是我*用过的最灵活的方法。

```
$config['website_url'] = 'google.com'; 
```

然后我有以下文件结构

```
- config/development
- config/production 
```

我在软件早期定义了一个名为**IN_PRODUCTION**的常量，当它为**TRUE**时，它会加载生产配置项，反之亦然。

这是简单且易于维护的。

-马修

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-28T16:37:37.197

将一个数据库的设置存储在不同的数据库中没有多大意义，IMO。

[我会选择jmucchiello](https://stackoverflow.com/questions/798654/how-to-store-configurations-for-php-app-xml-or-ini-or-db/798708#798708)建议的 ini 文件、xml 文件或 php 文件。每个选项都有其优点和缺点。至于 xml 与 ini，xml 提供了更大的灵活性，但更难以维护（可读性较差）。如果 ini 满足您的需求，请坚持使用更简单的解决方案。仅当您需要超出 ini 文件所能提供的范围时才使用 xml。

至于 php 解决方案，我认为可读性介于 ini 和 xml 之间，但保存当前设置会更加困难。因此，尽管我喜欢这种方法，但对于您当前的场景，我不会推荐它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-28T16:05:41.673

实际上，我更喜欢可运行的 PHP 文件进行配置。您可以在一个可运行的文件中做很多使用其他解决方案无法轻松完成的事情。可运行文件的唯一大缺点是管理员必须精通 PHP 才能安全地编辑文件。PHP 还可以在您的配置中描述复杂的数据类型，因为它是代码。

数据库是个问题，因为您仍然需要一个外部配置文件来查找并连接到数据库。

XML 对于配置来说太过分了。

INI 文件可以工作，您可以使用 PHP ini 库来读取它们。请参见 parse_ini_file()。ini 文件虽然不能很好地处理复杂的数据类型。

编辑回答 Itay Moav （评论不会正确格式化）：

```
<?php /* my config file */

$_CFG = Array(); /* problem solved */
$_CFG['key1'] = 'value1';
?> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-12-12T14:25:19.597

刚才我看了一篇有同样问题的帖子，这是一个很好的解决方案。收集有用的代码是一种很好的做法。我想。:)

点击[iniHandler类](http://www.phplogs.com/perfect-php-class-read-write-configuration-values-ini-files/ "完美的 php 类，用于读取和写入 INI 文件的配置值")获取INI处理类！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-28T16:01:16.787

我认为这里的答案将取决于您的个人情况。在某些情况下，这些都是更好的选择。对于您的特定情况，xml 可能是最好的。但是，如果您有多个相关选项，那么 xml 真正在 ini 文件上大放异彩的地方。例如，如果您需要保留数据库的连接信息，该数据库具有用于该特定连接的节点下方连接的不同部分的节点，则该特定连接的节点可能更易于阅读和维护。这真的取决于数据。

我还要说，如果您只是要提取单个值而不是在应用程序开始时将整个文件加载到内存中，那么使用 xml 文件会更容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-28T16:12:11.517

我会选择 ini 文件，它们是人类可读的，它们的解析速度非常快（如果你缓存......）。
当然不是 XML。人类可读性较差，解析速度不快。
由于速度，我不会做DB。
我不会使用 PHP vars，因为它会让你使用 GLOBAL 范围......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-28T16:41:54.893

编写您自己的加载配置文件的配置类。一个很好的例子是 CodeIgniter 处理配置的方式。

[http://codeigniter.com/user_guide/libraries/config.html](http://codeigniter.com/user_guide/libraries/config.html)

它默认加载一些配置文件，或者您可以使用 Config 类加载特定的配置文件。

您可以下载源代码并看看他们是如何为教育目的而做的。

另一种选择是从数据库生成一个带有配置数组的 php 文件。因此，您可以管理所有选项并在保存时生成文件。

# c# - 在 C# 程序中嵌入外部可执行文件

> ID：798655
> 
> 赞同：39
> 
> 时间：2009-04-28T15:55:55.533
> 
> 标签：c#, windows, embed, executable

如何在我的 C# Windows 窗体应用程序中嵌入外部可执行文件？

编辑：我需要嵌入它，因为它是一个外部免费控制台应用程序（用 C++ 制作），我从中读取输出值以在我的程序中使用。嵌入它会更好，更专业。

第二个原因是需要在 .NET 应用程序中嵌入 Flash 投影仪文件。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-03-15T12:02:37.430

最简单的方法，从[威尔所说](https://stackoverflow.com/questions/798655/embedding-an-external-executable-inside-a-c-sharp-program/9719279#comment3659796_799015)的开始：

1.  使用 Resources.resx 添加 .exe
2.  代码如下：

    ```
    string path = Path.Combine(Path.GetTempPath(), "tempfile.exe");  
    File.WriteAllBytes(path, MyNamespace.Properties.Resources.MyExecutable);
    Process.Start(path); 
    ```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-04-28T17:23:42.063

这是一些可以大致完成此任务的示例代码，减去任何类型的错误检查。另外，请确保要嵌入的程序的许可证允许这种使用。

```
// extracts [resource] into the the file specified by [path]
void ExtractResource( string resource, string path )
{
    Stream stream = GetType().Assembly.GetManifestResourceStream( resource );
    byte[] bytes = new byte[(int)stream.Length];
    stream.Read( bytes, 0, bytes.Length );
    File.WriteAllBytes( path, bytes );
}

string exePath = "c:\temp\embedded.exe";
ExtractResource( "myProj.embedded.exe", exePath );
// run the exe...
File.Delete( exePath ); 
```

唯一棘手的部分是为 的第一个参数获取正确的值`ExtractResource`。它应该具有“namespace.name”的形式，其中命名空间是您项目的默认命名空间（在项目 | 属性 | 应用程序 | 默认命名空间下找到它）。第二部分是文件的名称，您需要将其包含在项目中（确保将构建选项设置为“嵌入式资源”）。如果您将文件放在一个目录下，例如 Resources，那么该名称将成为资源名称的一部分（例如“myProj.Resources.Embedded.exe”）。如果您遇到问题，请尝试在 Reflector 中打开已编译的二进制文件并查看 Resources 文件夹。此处列出的名称是您将传递给的名称`GetManifestResourceStream`。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-04-28T16:01:22.573

只需将其添加到您的项目并将构建选项设置为“嵌入式资源”

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-03-04T14:32:17.247

这可能是最简单的：

```
byte[] exeBytes = Properties.Resources.myApp;
string exeToRun = Path.Combine(Path.GetTempPath(), "myApp.exe");

using (FileStream exeFile = new FileStream(exeToRun, FileMode.CreateNew))
    exeFile.Write(exeBytes, 0, exeBytes.Length);

Process.Start(exeToRun); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-28T15:57:35.360

可执行文件是托管程序集吗？如果是这样，您可以使用[ILMerge](http://research.microsoft.com/en-us/people/mbarnett/ilmerge.aspx)将该程序集与您的程序集合并。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-08-25T22:45:33.980

这是我的版本：将文件作为现有项目添加到项目中，将文件上的属性更改为“嵌入式资源”

将文件动态提取到给定位置：（此示例不测试位置的写入权限等）

```
 /// <summary>
    /// Extract Embedded resource files to a given path
    /// </summary>
    /// <param name="embeddedFileName">Name of the embedded resource file</param>
    /// <param name="destinationPath">Path and file to export resource to</param>
    public static void extractResource(String embeddedFileName, String destinationPath)
    {
        Assembly currentAssembly = Assembly.GetExecutingAssembly();
        string[] arrResources = currentAssembly.GetManifestResourceNames();
        foreach (string resourceName in arrResources)
            if (resourceName.ToUpper().EndsWith(embeddedFileName.ToUpper()))
            {
                Stream resourceToSave = currentAssembly.GetManifestResourceStream(resourceName);
                var output = File.OpenWrite(destinationPath);
                resourceToSave.CopyTo(output);
                resourceToSave.Close();
            }
    } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-02-23T13:08:58.023

1.  将文件添加到 VS 项目
2.  标记为“嵌入式资源”-> 文件属性
3.  使用名称解析：[Assembly Name].[Name of embedded resource] like "MyFunkyNTServcice.SelfDelete.bat"

您的代码有资源错误（文件句柄未释放！），请更正：

```
public static void extractResource(String embeddedFileName, String destinationPath)
    {
        var currentAssembly = Assembly.GetExecutingAssembly();
        var arrResources = currentAssembly.GetManifestResourceNames();
        foreach (var resourceName in arrResources)
        {
            if (resourceName.ToUpper().EndsWith(embeddedFileName.ToUpper()))
            {
                using (var resourceToSave = currentAssembly.GetManifestResourceStream(resourceName))
                {
                    using (var output = File.OpenWrite(destinationPath))
                        resourceToSave.CopyTo(output);
                    resourceToSave.Close();
                }
            }
        }
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-02-23T19:40:44.817

如果需要，将某些内容提取为字符串：

```
public static string ExtractResourceAsString(String embeddedFileName)
    {
        var currentAssembly = Assembly.GetExecutingAssembly();
        var arrResources = currentAssembly.GetManifestResourceNames();
        foreach (var resourceName in arrResources)
        {
            if (resourceName.ToUpper().EndsWith(embeddedFileName.ToUpper()))
            {
                using (var resourceToSave = currentAssembly.GetManifestResourceStream(resourceName))
                {
                    using (var output = new MemoryStream())
                    {
                        resourceToSave.CopyTo(output);
                        return Encoding.ASCII.GetString(output.ToArray());
                    }
                }
            }
        }

        return string.Empty;
    } 
```

# javascript - 如何使用依赖于变量的模式执行 Javascript 匹配？

> ID：798662
> 
> 赞同：3
> 
> 时间：2009-04-28T15:56:42.677
> 
> 标签：javascript, regex, autocomplete, match

[Remy Sharp 的 jQuery 标签建议插件](http://remysharp.com/2007/12/28/jquery-tag-suggestion/)的当前实现只检查标签开头的匹配项。例如，键入“Photoshop”将不会返回名为“Adobe Photoshop”的标签。

默认情况下，搜索区分大小写。我稍微修改了它以修剪多余的空格并忽略大小写：

```
for (i = 0; i < tagsToSearch.length; i++) {
    if (tagsToSearch[i].toLowerCase().indexOf(jQuery.trim(currentTag.tag.toLowerCase())) === 0) {
        matches.push(tagsToSearch[i]);
    }
} 
```

我试图做的是再次修改它，以便在用户输入“Photoshop”时能够返回“Adobe Photoshop”。我试过使用`match`，但当模式中存在变量时，我似乎无法让它工作：

```
for (i = 0; i < tagsToSearch.length; i++) {
    var ctag = jQuery.trim(currentTag.tag);
    if (tagsToSearch[i].match("/" + ctag + "/i")) { // this never matches, presumably because of the variable 'ctag'
        matches.push(tagsToSearch[i]);
    }
} 
```

以这种方式执行正则表达式搜索的正确语法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-28T16:00:11.983

如果你想在 JavaScript 中动态地做正则表达式，你必须使用[RegExp 对象](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/RegExp)。我相信您的代码看起来像这样（尚未测试，不确定，但总体思路正确）：

```
for (i = 0; i < tagsToSearch.length; i++) {
    var ctag = jQuery.trim(currentTag.tag);
    var regex = new RegExp(ctag, "i")
    if (tagsToSearch[i].match(regex)) {
        matches.push(tagsToSearch[i]);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T16:03:29.213

代替

```
"/" + ctag + "/i" 
```

采用

```
new RegExp(ctag, "i") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T16:15:00.777

您也可以继续使用 indexOf，只需将您的 === 0 更改为 >= 0：

```
for (i = 0; i < tagsToSearch.length; i++) {
    if (tagsToSearch[i].toLowerCase().indexOf(jQuery.trim(currentTag.tag.toLowerCase())) >= 0) {
        matches.push(tagsToSearch[i]);
    }
} 
```

但话又说回来，我可能错了。

# javascript - 使用javascript对数组元素进行排序

> ID：798664
> 
> 赞同：1
> 
> 时间：2009-04-28T15:57:08.370
> 
> 标签：javascript, arrays, sorting

我需要您通过键盘或文件输入单词然后使用javascript按长度排序的程序

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-28T15:59:46.430

你应该看看[数组排序方法](http://www.w3schools.com/jsref/jsref_sort.asp)。您可以使用它并传入一个函数，该函数根据您喜欢的任何标准执行排序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-28T16:06:44.480

[sort 方法](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Array/sort)接受一个函数作为参数：

```
var a = ["one", "two", "three", "four", "five"];

a.sort(function(a,b){
  return a.length - b.length
});
// returns ["one", "two", "four", "five", "three"] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-28T16:01:18.050

这是一个关于如何在 Javascript 中[对数组进行排序的示例](http://www.w3schools.com/jsref/jsref_sort.asp)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-15T12:01:12.603

用这个 ：

```
array.sort(function(el1,el2){
  return el1.length - el2.length
}); 
```

# javascript - 拖放背后的逻辑

> ID：798666
> 
> 赞同：4
> 
> 时间：2009-04-28T15:57:30.977
> 
> 标签：javascript, jquery, drag-and-drop, client-side

我想知道基本拖放功能的“它是如何工作的”和“它应该如何设计和实现”方面。

我还没有实现过这样的功能。我计划为我的一个项目这样做，并且我对如何实施它有一些想法。我想确保我走在正确的道路上，并且你们很可能对此事也有话要说……

假设我有 5 个元素列出如下并从数据库中获取；

```
<div id="1">this is content for 1</div>
<div id="2">this is content for 2</div>
<div id="3">this is content for 3</div>
<div id="4">this is content for 4</div>
<div id="5">this is content for 5</div> 
```

由于这是从数据库中提取的，我们知道它有一个名为“sequence”或“order”的字段来区分我们要输出的顺序。我们还假设当前“序列”列的值与 div 的 ID 相同。所以：`1`, `2`, `3`,`4`和`5`分别。

我的问题和想法；

如果我将 div`4`拖放到`1`and之间`2`；从那里开始的步骤是什么？例如：

1.  确定被拖动的 div 的 id（我们称之为`div-a`）

2.  `div-a`在这种情况下，确定在之后（或之前）插入的 div 的 id， 因此在 div 之后`id` `1`（我们称之为`div-b`）

3.  更新`div-a`数据库中的序列并将其设置为当前的序列`div-b`

在这一步之后，我很困惑......我是否计算所有 div 并根据 div 的任何顺序，我是否相应地更新数据库？还是我完全错了，还有其他方法吗？

* * *

感谢您的回答，但我知道有插件和其他东西可以完成这项工作，但我只对它的逻辑部分感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T16:02:08.373

我相信 jquery 为您提供了一种基于 id 获取订单的方法？

我一直这样做的方式是每次发生动作时，获取当前订单，通过 ajax 将其发送回我的应用程序。然后我的应用程序只是从给出的内容中解析出 id 并更新每个项目的订单值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T12:50:50.137

[http://jqueryui.com/demos/sortable/](http://jqueryui.com/demos/sortable/)

```
 $("#col1").sortable({
        placeholder: "top",
        forcePlaceholderSize: true,
        revert: true, 
        update: function() { 
                $.ajax({
                     type: "GET",
                     url: "/request.php",
                     data: "data="+$(this).sortable("toArray")+"",
                     success: function(msg){ }
                        });         
             }
    }); 
```

toArray 是您的 div id 的序列

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T12:42:10.657

除非您这样做是为了自己的教育，否则我建议您使用 jQueryUI。

它具有拖放功能，除其他外，这可能会帮助您了解 DaD 的本质，让您实现特定于您的问题的部分。

# c# - ASP.Net 中的日期差异

> ID：798674
> 
> 赞同：3
> 
> 时间：2009-04-28T15:58:50.053
> 
> 标签：c#, .net

我如何获得`date`差异`ASP.NET C#`？

**例如：**

```
d1= 28/04/2009 09:26:14
d2= 28/04/2009 09:28:14

DateDiff = d2 - d1 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-28T16:01:33.540

我认为你可以通过以下方式做到这一点：

```
DateTime d1 = DateTime.Now;
DateTime d2 = DateTime.Now.AddDays(-1);

TimeSpan t = d1 - d2; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-28T16:04:20.193

```
const string DateFormat = "dd/MM/yyyy hh:mm:ss";

DateTime d1 = DateTime.ParseExact("28/04/2009 09:26:14", DateFormat, null);
DateTime d2 = DateTime.ParseExact("28/04/2009 09:28:14", DateFormat, null);

TimeSpan dateDiff = d2 - d1;

string duration = string.Format("The time difference is: {0}", dateDiff); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-28T16:04:32.427

类上有一个实例方法`Subtract`，`DateTime`它返回一个`TimeSpan`. [见文章](http://msdn.microsoft.com/en-us/library/system.timespan.aspx "时间跨度")

```
DateTime now = DateTime.Parse("2009-04-28");  
DateTime newyear = DateTime.Parse("2009-01-01");  
TimeSpan difference = now.Subtract(newyear); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T16:02:17.203

查看时间[跨度](http://msdn.microsoft.com/en-us/library/system.timespan.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-05-11T13:17:33.233

```
 Dim d1, d2 As Date
            Dim intElapsedDays As Integer
            Dim tspDif As TimeSpan
            tspDif = d2 - d1
            intElapsedDays = tspDif.Days 
```

'应该为 d1 和 d2 赋值

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-26T12:24:43.027

这取决于输入格式时间戳。例如，如果是 unix 时间戳，则下面的代码将枚举周期信息：

```
 int TimestampFrom = 1546336800; //2019.1.1 10:00
        int TimestampTo = 1547555400;   //2019.1.15 12:30
        DateTime unixStart = new DateTime(1970, 1, 1, 0, 0, 0, 0, System.DateTimeKind.Utc);
        long dateFromunixTimeStampInTicks = (long)(TimestampFrom * TimeSpan.TicksPerSecond);
        DateTime dateFrom = new DateTime(unixStart.Ticks + dateFromunixTimeStampInTicks, System.DateTimeKind.Utc);
        long dateTounixTimeStampInTicks = (long)(TimestampTo * TimeSpan.TicksPerSecond);
        DateTime dateTo = new DateTime(unixStart.Ticks + dateTounixTimeStampInTicks, System.DateTimeKind.Utc);
        TimeSpan Period = dateTo - dateFrom;
        int days = Convert.ToInt32(Period.TotalDays);       //>14
        int hours = Convert.ToInt32(Period.TotalHours);     //>338
        int seconds = Convert.ToInt32(Period.TotalSeconds); //>1218600 
```

如果源日期格式是正常的 DateTime，那么足够简单的日期减法将返回包含所有期间信息的 TimeSpan 结构。

回答：“如何获得两个日期时间（时间戳）之间的间隔[重复]”这不是重复的。

# gwt - 如何在 Google Web Toolkit 中使用代理

> ID：798683
> 
> 赞同：2
> 
> 时间：2009-04-28T16:00:38.427
> 
> 标签：gwt, proxy

我正在 Windows 上使用 GWT 编写一个需要进行一些网络调用的应用程序。

我知道如果这些不是我正在开发的同一台机器，我需要设置一个代理，对吗？

我只是想知道是否有人可以帮助我的 GWT 代码看起来像什么？

我应该在 Windows 上使用什么代理？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T03:17:19.687

如果您只是从不同域的 RESTful 服务*请求数据，则可以使用 JSONP (* [http://code.google.com/webtoolkit/tutorials/1.6/Xsite.html](http://code.google.com/webtoolkit/tutorials/1.6/Xsite.html) )。

如果您尝试发布数据，则必须在服务器端执行网络调用。（有一些骇人听闻的方法可以尝试通过隐藏的 iframe 提交，但它们是非标准的）。这意味着您只需在服务器上调用一个执行网络调用的方法（请参阅[http://code.google.com/webtoolkit/tutorials/1.6/RPC.html](http://code.google.com/webtoolkit/tutorials/1.6/RPC.html)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-25T16:16:53.313

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T16:03:38.777

如果您指的是 Google Web Toolkit，并且您正试图规避跨域脚本限制，请查看 Yahoo 的[操作指南](http://developer.yahoo.com/javascript/howto-proxy.html)。甚至还有 PHP 示例代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T16:59:48.360

为什么不在服务器端执行网络调用？这样，您就不会受到跨域限制。

# c# - 以编程方式在 WCF EndpointAddress 上设置标识

> ID：798684
> 
> 赞同：1
> 
> 时间：2009-04-28T16:00:44.477
> 
> 标签：c#, .net, wcf, basichttpbinding

我`System.ServiceModel.EndpointAddress`在连接到 WCF 服务时使用以下函数创建一个：

```
private static EndpointAddress GetEndPointAddress(string url, EndpointIdentity identity)
{
    Uri baseAddress = new Uri(url);
    EndpointAddress endpointAddress = new EndpointAddress(
        baseAddress,
        identity,
        new AddressHeaderCollection());
    return endpointAddress;
} 
```

我需要传入一个`EndPointIdentity`与我的 web.config 中的以下摘录相关的内容：

```
<identity>
  <dns value="Some Value" />
</identity> 
```

我的 WCF 服务使用 X509 证书，因此我的身份似乎需要是`X509CertificateEndpointIdentity`. 为此的构造函数需要我传递一个证书……但我想传递一个 dns 值，如上所示。

谁能建议我的方法有什么问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-30T09:15:35.060

实际上我需要创建一个 DnsEndpointIdentity，如下：

```
DnsEndpointIdentity identity = new DnsEndpointIdentity("Some value"); 
```

# web-crawler - 网络爬虫 http 请求的正确礼仪

> ID：798695
> 
> 赞同：8
> 
> 时间：2009-04-28T16:02:52.243
> 
> 标签：web-crawler

我有一个简单的网络爬虫，可以从网站的站点地图中请求我需要缓存和索引的所有页面。在多次请求之后，该网站开始提供空白页面。

除了指向他们的站点地图的链接之外，他们什么都没有`robots.txt`，所以我认为我没有违反他们的“规则”。我有一个描述性标题，可以准确链接到我的意图，并且我抓取的唯一页面来自他们的站点地图。

http 状态码都还可以，所以我只能想象它们在短时间内阻止了大量的 http 请求。请求之间的合理延迟量是多少？

是否还有其他我忽略的可能导致此问题的注意事项？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-28T16:12:02.110

每个站点都有不同的爬虫和它寻找的滥用特征。

任何爬虫的关键是模仿人类活动，并遵守 robots.txt。

详尽的爬网会绊倒一些网站，无论你走多慢，它们都会让你关闭，而一些主机不介意爬虫快速拉动并一次性吸走所有内容。

*   通常，您不希望请求页面的速度超过每分钟 6 个（大约人类速度）。
*   按照网页上的可见性顺序，您会更安全地跟随链接。
*   尝试忽略网页上不可见的链接（很多人使用蜜罐）。

如果一切都失败了，请求的速度不要超过每分钟一页。如果网站以这种速度阻止您，请直接与他们联系 - 他们显然不希望您以这种方式使用他们的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T16:15:55.690

我猜维基百科对这个话题[有很好的参考。](http://en.wikipedia.org/wiki/Robots.txt)服从他们，为了礼貌，多一点。

例如，我可能会以每秒一击的速度最大化连接速度，否则我会冒着无意的 DoS 攻击的风险。

# list - 列表的 REST URL

> ID：798701
> 
> 赞同：0
> 
> 时间：2009-04-28T16:03:53.363
> 
> 标签：list, rest

假设我有一个返回客户列表的方法，并且输入有一个状态列表和大小列表，例如

返回客户所在州（纽约州、加利福尼亚州、德克萨斯州）和尺寸（小、中）的客户

我应该使用什么最好的 RESTFul URL？它是一个查询并且不指向特定的“资源”的问题。以下是我正在考虑的一些选项。

1.  somesite.com/customers?state=NY,CA,TX&size=small,medium（旧式）
2.  somesite.com/customers/state/NY,CA,TX/size/small,medium
3.  somesite.com/customers/state=NY,CA,TX/size=small,medium
4.  somesite.com/customers/state(NY,CA,TX)/size(small,medium)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-28T16:09:22.117

选项 1 - 查询参数正是为此而设计的。查询的参数。

您对客户列表感兴趣，因此最后一个“文件夹”应该是“/customers”。您想要其中的一个子集，并且该子集根据输入而变化，并且结合起来，您可以将查询参数用作过滤器。（如你所见，被迫提出这个问题，没有什么是有意义的）。

您真正的问题是默认情况下参数是包含还是排除（即 AND 或 OR）。这个问题已经在这里问过了，如果我能找到它......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T16:08:01.840

我认为#1 ( `somesite.com/customers?state=NY,CA,TX&size=small,medium`) 是最好的。客户是资源，查询字符串只是对所请求的资源施加限制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T16:12:11.860

就个人而言，我会使用第 4 种方法，但使用“+”号而不是括号：

```
somesite.com/customers/NY+CA+TX/small+medium 
```

RESTful 风格的*模型**不一定*是您应该提供的所有 RESTful*资源*......您可以添加任意数量的（人工）资源，只要您认为合适，即使是需要从您的模型中加入的资源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-20T22:28:02.240

就其价值而言，URI 命名约定与 REST 无关。事实上，如果您定义了一种在带外构建应用程序 URI 作为 API 的一部分的方法，那么您就违反了 REST 的约束。见：[http ://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven](http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven)

# mod-rewrite - Apache 虚拟主机和 mod_rewrite 冲突

> ID：798702
> 
> 赞同：2
> 
> 时间：2009-04-28T16:03:53.660
> 
> 标签：mod-rewrite, apache2, virtualhost

我一直在网上搜索，所以我无法解决或解决这个问题。

我们有一堆子域和一些专用服务器。一台服务器作为问题跟踪和登录页面执行双重三重职责。问题是通配符登录页面有时无法将您带到正确的虚拟主机页面。我一直在研究通配符，但它们似乎特别广泛。

我们的场景如下：

- **www.askia.com**是主要的登陆站点。一个不存在的（通配符）子域应该总是在这里登陆。
- **dev.askia.com**是技术支持和问题站点。它有一些适用于 https 的 mod_rewrites。我花了一段时间，但我让它工作，我宁愿不打破它。
- **www.askia.fr**是我们的法语网站。它不会将您带到**www.askia.com**，而是将您带到 dev.askia.com。
- **www.askia.co.uk**应该带你到**www.askia.com**但它转到**dev.askia.com**

我不完全确定我应该在哪里尝试修复解决方案。我应该在 CNAME 中做些什么吗？在 virtualhosts 配置文件或 mod_rewrite 文件中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T16:09:51.647

试试这些规则：

```
RewriteCond %{HTTP_HOST} ^dev\.
RewriteCond %{HTTP_HOST} !^dev\.askia\.com$
RewriteRule ^ http://dev.askia.com%{REQUEST_URI} [L,R=301]

RewriteCond %{HTTP_HOST} !^www\.askia\.com$
RewriteCond %{HTTP_HOST} !^dev\.askia\.com$
RewriteRule ^ http://www.askia.com%{REQUEST_URI} [L,R=301] 
```

第一条规则将每个请求重定向到以 开头`dev.`但不`dev.askia.com`以开头的主机`www.askia.com`。第二条规则将请求重定向到`www.askia.com`和以外`dev.askia.com`的主机`www.askia.com`。因此，每个请求都应该转到`dev.askia.com`或`www.askia.com`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T12:30:03.357

在 Apache 中使用虚拟主机时，列出的第一个主机将始终是不匹配的默认值。

```
#default vhost
# any non-matches will land here

<VirtualHost  _default_:80>
ServerName www.askia.com:80
DocumentRoot /path/to/site

ErrorLog /path/ti/sites/logs/error_log

</VirtualHost>

# vhost #2 

<VirtualHost  _dev_Site_:443>
ServerName dev.askia.com:443
DocumentRoot /path/to/dev/site

ErrorLog /path/to/dev/sites/logs/error_log

#ssl details
SSLEngine on
SSLCipherSuite HIGH:MEDIUM
SSLCertificateFile /location/securti.crt
SSLCertificateKeyFile /location/securti.key

#any rewrite rules to apply only to this (default) domain
# force SSL for instance..
RewriteRule .* - [F]
RewriteCond   %{SERVER_PORT}  !^443$
RewriteRule (.*) https://dev.askia.com/
</VirtualHost>

#etc, etc 
```

# database - 公开大型 Web 服务数据集以供 Access 或 Excel 使用

> ID：798709
> 
> 赞同：0
> 
> 时间：2009-04-28T16:05:48.630
> 
> 标签：database, web-services, excel, ms-access, odbc

我有一个大型数据集，比如 1,000,000,000 行，它位于服务器上。我需要一个用户能够在 Access 和/或 Excel 中通过 Web 无缝地使用（即“运行查询”）该数据。此外，我需要根据连接的用户过滤服务器端的数据。

我目前的方法是创建一个看起来像 ODBC 数据源的 Web 服务并从 Excel 连接到它。

问题：

1.  这是最好的方法吗？
2.  如果是这样，创建自定义 ODBC 数据源的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T16:21:11.463

1.  我真的认为这不是最好的方法。我不知道你的情况，但我真的更喜欢另一种方法。

2.  对此进行了讨论：[创建自定义 ODBC 驱动程序](https://stackoverflow.com/questions/335008/creating-a-custom-odbc-driver) 建议之一是使用 BI 方法。

# ruby - Ruby：如何将散列转换为 HTTP 参数？

> ID：798710
> 
> 赞同：220
> 
> 时间：2009-04-28T16:06:34.293
> 
> 标签：ruby, http, parameters, hashmap

这很容易用一个简单的哈希，比如

```
{:a => "a", :b => "b"} 
```

这将转化为

```
"a=a&b=b" 
```

但是你如何处理更复杂的事情，比如

```
{:a => "a", :b => ["c", "d", "e"]} 
```

这应该转化为

```
"a=a&b[0]=c&b[1]=d&b[2]=e" 
```

或者更糟糕的是，（做什么）类似于：

```
{:a => "a", :b => [{:c => "c", :d => "d"}, {:e => "e", :f => "f"}] 
```

感谢您对此提供的非常感谢的帮助！

* * *

## 回答 #1

> 赞同：294
> 
> 时间：2010-09-30T17:32:36.477

对于基本的非嵌套哈希，Rails/ActiveSupport 具有`Object#to_query`.

```
>> {:a => "a", :b => ["c", "d", "e"]}.to_query
=> "a=a&b%5B%5D=c&b%5B%5D=d&b%5B%5D=e"
>> CGI.unescape({:a => "a", :b => ["c", "d", "e"]}.to_query)
=> "a=a&b[]=c&b[]=d&b[]=e" 
```

[http://api.rubyonrails.org/classes/Object.html#method-i-to_query](http://api.rubyonrails.org/classes/Object.html#method-i-to_query)

* * *

## 回答 #2

> 赞同：168
> 
> 时间：2012-06-28T19:35:42.760

如果您使用的是 Ruby 1.9.2 或更高版本，则可以`URI.encode_www_form`在不需要数组的情况下使用。

例如（来自 1.9.3 中的 Ruby 文档）：

```
URI.encode_www_form([["q", "ruby"], ["lang", "en"]])
#=> "q=ruby&lang=en"
URI.encode_www_form("q" => "ruby", "lang" => "en")
#=> "q=ruby&lang=en"
URI.encode_www_form("q" => ["ruby", "perl"], "lang" => "en")
#=> "q=ruby&q=perl&lang=en"
URI.encode_www_form([["q", "ruby"], ["q", "perl"], ["lang", "en"]])
#=> "q=ruby&q=perl&lang=en" 
```

您会注意到数组值没有使用包含`[]`我们在查询字符串中已经习惯的键名来设置。使用的规范`encode_www_form`符合 HTML5`application/x-www-form-urlencoded`数据定义。

* * *

## 回答 #3

> 赞同：90
> 
> 时间：2009-04-29T16:00:12.833

**更新：**此功能已从 gem 中删除。

朱利安，你的自我回答很好，我无耻地借鉴了它，但它没有正确地转义保留字符，而且还有一些其他极端情况会崩溃。

```
require "addressable/uri"
uri = Addressable::URI.new
uri.query_values = {:a => "a", :b => ["c", "d", "e"]}
uri.query
# => "a=a&b[0]=c&b[1]=d&b[2]=e"
uri.query_values = {:a => "a", :b => [{:c => "c", :d => "d"}, {:e => "e", :f => "f"}]}
uri.query
# => "a=a&b[0][c]=c&b[0][d]=d&b[1][e]=e&b[1][f]=f"
uri.query_values = {:a => "a", :b => {:c => "c", :d => "d"}}
uri.query
# => "a=a&b[c]=c&b[d]=d"
uri.query_values = {:a => "a", :b => {:c => "c", :d => true}}
uri.query
# => "a=a&b[c]=c&b[d]"
uri.query_values = {:a => "a", :b => {:c => "c", :d => true}, :e => []}
uri.query
# => "a=a&b[c]=c&b[d]" 
```

宝石是“[可寻址](https://github.com/sporkmonger/addressable)的”

```
gem install addressable 
```

* * *

## 回答 #4

> 赞同：68
> 
> 时间：2013-01-08T19:24:25.190

无需加载臃肿的 ActiveSupport 或自行滚动，您可以使用`Rack::Utils.build_query`和`Rack::Utils.build_nested_query`. [这是一篇博客文章](http://www.johndesu.com/2012/05/13/build-query-strings-with-rackutils/)，它给出了一个很好的例子：

```
require 'rack'

Rack::Utils.build_query(
  authorization_token: "foo",
  access_level: "moderator",
  previous: "index"
)

# => "authorization_token=foo&access_level=moderator&previous=index" 
```

它甚至可以处理数组：

```
Rack::Utils.build_query( {:a => "a", :b => ["c", "d", "e"]} )
# => "a=a&b=c&b=d&b=e"
Rack::Utils.parse_query _
# => {"a"=>"a", "b"=>["c", "d", "e"]} 
```

或者更困难的嵌套内容：

```
Rack::Utils.build_nested_query( {:a => "a", :b => [{:c => "c", :d => "d"}, {:e => "e", :f => "f"}] } )
# => "a=a&b[][c]=c&b[][d]=d&b[][e]=e&b[][f]=f"
Rack::Utils.parse_nested_query _
# => {"a"=>"a", "b"=>[{"c"=>"c", "d"=>"d", "e"=>"e", "f"=>"f"}]} 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2013-06-05T13:54:24.660

如果您只需要支持简单的 ASCII 键/值查询字符串，这里有一个简短而甜蜜的语句：

```
hash = {"foo" => "bar", "fooz" => 123}
# => {"foo"=>"bar", "fooz"=>123}
query_string = hash.to_a.map { |x| "#{x[0]}=#{x[1]}" }.join("&")
# => "foo=bar&fooz=123" 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-04-28T16:24:04.187

从 Merb 窃取：

```
# File merb/core_ext/hash.rb, line 87
def to_params
  params = ''
  stack = []

  each do |k, v|
    if v.is_a?(Hash)
      stack << [k,v]
    else
      params << "#{k}=#{v}&"
    end
  end

  stack.each do |parent, hash|
    hash.each do |k, v|
      if v.is_a?(Hash)
        stack << ["#{parent}[#{k}]", v]
      else
        params << "#{parent}[#{k}]=#{v}&"
      end
    end
  end

  params.chop! # trailing &
  params
end 
```

见[http://noobkit.com/show/ruby/gems/development/merb/hash/to_params.html](http://noobkit.com/show/ruby/gems/development/merb/hash/to_params.html)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-04-28T17:06:17.770

```
class Hash
  def to_params
    params = ''
    stack = []

    each do |k, v|
      if v.is_a?(Hash)
        stack << [k,v]
      elsif v.is_a?(Array)
        stack << [k,Hash.from_array(v)]
      else
        params << "#{k}=#{v}&"
      end
    end

    stack.each do |parent, hash|
      hash.each do |k, v|
        if v.is_a?(Hash)
          stack << ["#{parent}[#{k}]", v]
        else
          params << "#{parent}[#{k}]=#{v}&"
        end
      end
    end

    params.chop! 
    params
  end

  def self.from_array(array = [])
    h = Hash.new
    array.size.times do |t|
      h[t] = array[t]
    end
    h
  end

end 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-09-01T17:12:16.050

```
{:a=>"a", :b=>"b", :c=>"c"}.map{ |x,v| "#{x}=#{v}" }.reduce{|x,v| "#{x}&#{v}" }

"a=a&b=b&c=c" 
```

这是另一种方式。对于简单的查询。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-10-29T19:06:14.570

我知道这是一个老问题，但我只是想发布这段代码，因为我找不到一个简单的 gem 来为我完成这项任务。

```
module QueryParams

  def self.encode(value, key = nil)
    case value
    when Hash  then value.map { |k,v| encode(v, append_key(key,k)) }.join('&')
    when Array then value.map { |v| encode(v, "#{key}[]") }.join('&')
    when nil   then ''
    else            
      "#{key}=#{CGI.escape(value.to_s)}" 
    end
  end

  private

  def self.append_key(root_key, key)
    root_key.nil? ? key : "#{root_key}[#{key.to_s}]"
  end
end 
```

在这里作为宝石卷起来：[https ://github.com/simen/queryparams](https://github.com/simen/queryparams)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-11-08T11:15:17.370

最好的方法是使用 Hash.to_params ，它可以很好地处理数组。

```
{a: 1, b: [1,2,3]}.to_param
"a=1&b[]=1&b[]=2&b[]=3" 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-08-30T21:27:05.203

```
require 'uri'

class Hash
  def to_query_hash(key)
    reduce({}) do |h, (k, v)|
      new_key = key.nil? ? k : "#{key}[#{k}]"
      v = Hash[v.each_with_index.to_a.map(&:reverse)] if v.is_a?(Array)
      if v.is_a?(Hash)
        h.merge!(v.to_query_hash(new_key))
      else
        h[new_key] = v
      end
      h
    end
  end

  def to_query(key = nil)
    URI.encode_www_form(to_query_hash(key))
  end
end

2.4.2 :019 > {:a => "a", :b => "b"}.to_query_hash(nil)
 => {:a=>"a", :b=>"b"}

2.4.2 :020 > {:a => "a", :b => "b"}.to_query
 => "a=a&b=b"

2.4.2 :021 > {:a => "a", :b => ["c", "d", "e"]}.to_query_hash(nil)
 => {:a=>"a", "b[0]"=>"c", "b[1]"=>"d", "b[2]"=>"e"}

2.4.2 :022 > {:a => "a", :b => ["c", "d", "e"]}.to_query
 => "a=a&b%5B0%5D=c&b%5B1%5D=d&b%5B2%5D=e" 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-01-07T08:46:23.617

如果您在 Faraday 请求的上下文中，您也可以将 params 哈希作为第二个参数传递，并且 faraday 会负责将正确的 param URL 作为其中的一部分：

```
faraday_instance.get(url, params_hsh) 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-04-03T23:13:38.110

我喜欢使用这个宝石：

[https://rubygems.org/gems/php_http_build_query](https://rubygems.org/gems/php_http_build_query)

示例用法：

```
puts PHP.http_build_query({"a"=>"b","c"=>"d","e"=>[{"hello"=>"world","bah"=>"black"},{"hello"=>"world","bah"=>"black"}]})

# a=b&c=d&e%5B0%5D%5Bbah%5D=black&e%5B0%5D%5Bhello%5D=world&e%5B1%5D%5Bbah%5D=black&e%5B1%5D%5Bhello%5D=world 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-10-01T15:45:11.690

```
2.6.3 :001 > hash = {:a => "a", :b => ["c", "d", "e"]}
=> {:a=>"a", :b=>["c", "d", "e"]}
2.6.3 :002 > hash.to_a.map { |x| "#{x[0]}=#{x[1].class == Array ? x[1].join(",") : x[1]}" 
}.join("&")
=> "a=a&b=c,d,e" 
```

# silverlight - 我可以在页面的不同区域重复使用 Silverlight 应用程序吗？

> ID：798714
> 
> 赞同：0
> 
> 时间：2009-04-28T16:07:36.770
> 
> 标签：silverlight, silverlight-2.0, reusability

我有一个想在网格中显示的 Silverlight 应用程序。Silverlight 应用程序显示其内容的方式取决于每个网格行中记录的唯一 ID。不幸的是，为网格中的每一行重新下载 XAP 文件。对于 700KB 的大小，这确实会影响性能。是否可以一次下载 XAP 文件，然后为网格中的每一行重新使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T03:56:10.300

下载 XAP 后，Silverlight 将在每个 Silverlight 控件实例本地缓存程序集等。如果您创建 Silverlight 控件的另一个实例，那么它又拥有自己的域，而它又会照看这些域。

我的建议是抽象出您需要的部分并将它们烘焙到单独的 xaml 中，然后将它们加载到您最需要它们的区域。如果您仍然需要一个中央 .xap 来处理编组/事件管理等，那么在 Silverlight 3 中，我们已经放置了一个本地连接 API，它允许其他 Silverlight 实例在本地的一个浏览器页面中相互通信（即 SilverlightA 可以在 index.html 中与 SilverlightB 交谈）

如果您愿意，这可以让您建立一种本地代理。

**Scott Barnes / Rich Platforms 产品经理 / Microsoft。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T17:08:57.777

我不确定你能不能。理论上它应该被缓存，但在这种情况下，理论似乎不值得蹲下。

这完全取决于 <object> 标签与它的各种参数的行为方式，这是（另一个）silverlight 的“稀疏”记录区域之一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T17:32:28.250

这是可能的，但不容易做到。您可以下载 xap 并将其保存到 IsolatedStorage 并在每次需要一个引用缓存的 xap 时创建一个 silverlight 主机，但您只有 1MB 可用空间，并且不能保证是否有来自同一域的其他 silverlight 应用程序。

鉴于你所描述的，我仍然认为做你想做的事没有任何价值。我认为你有它倒退。

# vb.net - 添加到自定义集合库时派生类成员不可用

> ID：798717
> 
> 赞同：0
> 
> 时间：2009-04-28T16:08:34.083
> 
> 标签：vb.net

我有一个基类，称为原始图形。从这个类派生出几种不同类型的图形、正方形、矩形、线条等。

我将这些图形存储在一个继承集合库的对象中。这会导致一个问题，因为当派生类中的任何成员添加到集合中时，我无法访问它们。这是我的原始集合类的默认属性

```
Public Class PrimitiveCollection
    Inherits CollectionBase
    ''' <summary> 
    ''' Get or set a primitive object by index 
    ''' </summary> 
    Default Public Property Item(ByVal index As Integer) As Primitive
        Get
            Return DirectCast(List(index), Primitive)
        End Get
        Set(ByVal value As Primitive)
            List(index) = value
        End Set
    End Property 
```

我当前的解决方法是将所有公共成员放在基类中，但是随着我添加更多需要仅对派生类可用的成员的派生类，这开始看起来很难看

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T16:11:06.793

您的问题是关于继承和接口。以下是我的看法

每个 Primitive 都应该实现一个接口 IPrimitive。Collection 中的每个 Primitive 都实现了 IPrimitive，而 IPrimitive 中唯一的东西是适用于所有类型的 IPrimitive 的东西。例如：绘制（）

因此，在使用您的集合时，您有一个可绘制对象的集合。如果您打算将集合用作仅包含 Rectangle 的集合，则应使用 List<Rectangle> 而不是 Primitives 的集合。

将更多属性放在基类（或 IPrimitive）上是一个坏主意，因为它们对所有对象都没有意义。宽度适用于矩形，但在使用梯形或三角形时会变得阴暗。相反，通用性应该尽可能少，以便将对象作为一个集合来处理。当您需要将对象作为其派生类使用时，您应该在不使用集合的情况下引用它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T16:12:58.863

如果您在单个集合中存储多种类型的对象，那么您需要在它们之间进行转换以访问特定于类型的成员，是的。

如果您实际上在集合中存储单个派生类型的多个对象，则应该考虑使用泛型，以便该集合保持强类型（即编译器知道该集合仅包含派生类型的实例）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T16:10:27.670

您需要将集合中的实例转换为派生类型才能访问它们的特定成员。

我将添加一个示例：

```
PrimitiveCollection primitives = GetPrimitives() ' this gets a mixture of types
If GetType(PrimitiveRectangle) = primitives[0].GetType() Then
    ' this is a PrimitiveRectangle object
    PrimitiveRectangle rect = CType(primitives[0], PrimitiveRectangle)
    ' now you can access specialized members through rect
End If 
```

几年来我没有使用 VB.NET，所以语法可能存在问题......

# c# - 微软 AJAX 更新面板的专业替代品？

> ID：798723
> 
> 赞同：5
> 
> 时间：2009-04-28T16:10:40.680
> 
> 标签：c#, asp.net, ajax

众所周知，更新面板向服务器发送与完整回帖相同的响应（或者我理解错误），确实比完整回帖要好得多。

那么有没有其他方法可以只发送响应数据？就像您有一个返回日期错误的方法一样，我认为这是唯一应该发送的东西，而不是要显示它的整个控制视图状态（也许我理解错了）。

我正在使用 Telerik AJAX 控件，它们是基于 Microsoft AJAX 构建的，因此那里没有太多改进。

我喜欢的一种方法是[http://www.coolite.com/](http://www.coolite.com/)他们有 AJAX 方法和事件，我认为这是我正在寻找的，但是该项目进展缓慢并且没有满足我的要求的灵活性。

所以任何输入都受到高度赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-28T16:31:19.880

如果您想要更多控制，一种技术是使用 JQuery 和 AJAX Client Library for ADO.NET Data Services 在客户端绑定 JSON 数据。

[在此处](http://www.hanselman.com/blog/jQuerytoshipwithASPNETMVCandVisualStudio.aspx)查看此示例。这是 JQuery 补充 ASP.Net AJAX 的一个很好的例子。

*首先，我从 SQL Server 检索数据，我需要 JSON 格式的数据。我正在使用 ADO.NET 数据服务的 AJAX 客户端库对后端进行 REST (GET) 查询。首先，我将获取数据...我将“datatable.js”作为客户端脚本包含在内，并使用 Sys.Data.DataService() 进行异步查询。在 JavaScript 中，如果它有“Sys”，则可以判断它是 Microsoft 类型。它的前面。ADO.NET 数据服务的所有客户端支持都在 datatable.js 中。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T16:16:46.453

这就是为什么我鼓励刚接触 AJAX 的程序员[在采用库之前学习基础知识](https://stackoverflow.com/questions/215589/should-i-avoid-using-a-javascript-library-while-learning-how-to-write-ajax-client)——当你了解实际发生的事情时，这种优化就变得很明显了。

> 那么有没有其他方法可以只发送响应数据？就像，你有一个只返回日期的方法？

是的。最基本的方法是将日期字符串写入响应流并在发送其他任何内容之前结束响应 - HTTP 处理程序 (ashx) 非常适合这一点。要获得对 ASP.NET AJAX 更友好的技术，请查看 Web Methods。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T16:22:20.090

与其研究控件，我建议您将 Ajax 作为一种技术进行研究，并了解它是如何工作的。完成此操作后，查看可用的实现，例如 UpdatePanels、JQuery 等

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T16:23:13.660

> 众所周知，更新面板将相同的响应作为完整的回帖发送到服务器（或者我理解错误）

AJAX 框架的主要思想是消除整页回发。只有页面的相关部分被更新，没有令人不安的刷新。在客户端机器和服务器之间传输的标记显着减少，从而显着提高了用户的性能。

但是如果您正在寻找页面回发的替代方法，那么我会推荐[jQuery](http://jquery.com/)，但从这个问题看来，您似乎是 AJAX 的新手，所以假设您了解 javascript，希望您首先了解 jQuery 的工作原理

# objective-c - 使用 Objective-C 编码时，您可以在运行时添加属性吗

> ID：798733
> 
> 赞同：4
> 
> 时间：2009-04-28T16:12:19.100
> 
> 标签：objective-c, core-animation

我想知道是否可以在运行时动态地将新属性添加到 Objective-C 对象实例？

我最初的想法只是覆盖 getValueForKey 以“伪造”属性，但似乎这不适用于 CoreAnimation。我想要实现的是能够为自定义属性设置动画。如果我创建一个 CALayer 的子类并将声明的属性添加到我的子类中，我就能够让它工作。如果我尝试使用 getValueForKey/setValueForKey 策略，CoreAnimation 似乎并不关心它，它正在明确寻找声明的属性。

我希望能够动态添加属性，因为在运行之前我可能不知道要为哪个属性设置动画。我当然可以创建一个 CALayer 子类，它具有我想要动画的所有属性......但只是想知道是否有更好的方法来做到这一点......

谢谢，

彼得

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T21:15:25.860

您是否尝试过覆盖 valueForUndefinedKey: ？（我在自定义 NSObject 子类上执行此操作，该子类可以具有从数据库中提取名称的各种属性。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T21:36:39.147

如果需要，您可以覆盖`-respondsToSelector:`并`-doesNotUnderstand:`动态处理传入的消息。

# php - RSS阅读问题

> ID：798734
> 
> 赞同：1
> 
> 时间：2009-04-28T16:12:33.420
> 
> 标签：php, serialization, rss

我在阅读我的网站中的 rss 提要时遇到问题。

当我将提要添加到我的站点时，我通过对其进行序列化将其缓存在数据库中，当我进行刷新时，如果它在特定时间限制内，我会再次从数据库中取消序列化它。否则我再次阅读远程站点的提要。

我认为问题与提要本身有关（来自我维护的不同站点）

它包含来自具有 latin 1 字符集的数据库的新闻项目。

因此，当我创建提要时，我会：

```
iconv("latin-1","UTF-8",$row["intro"]) 
```

但是，当我对我网站上的内容进行反序列化时，我会收到以下通知：

注意： unserialize() [function.unserialize]: 第 25 行 /home/site/www/plugins/widgets/rss_reader/lib_rssreader.php 中 2464 字节偏移 621 处出错

有任何想法吗？

- 新的消息 -

从提要中，欧元符号表示为欧元符号。提要的表格是 utf 8。我想过使用 iconv 将 iso-8859 转换为 utf-8，但我在 php 网站上读到这不适用于欧元符号。所以这不会带我去任何地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T17:13:49.753

是否可以一直使用 UTF-8？既然你控制了这两个网站，我认为它会。根据我的经验，始终坚持使用 UTF-8 是最好的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T10:26:01.387

你可以使用[utf8_encode](http://uk.php.net/manual/en/function.utf8-encode.php)代替 - 或者除了 iconv 吗？此函数专门用于将 ISO-8859-1 编码为 UTF-8。

# grails - GORM 中的复合外键列

> ID：798736
> 
> 赞同：11
> 
> 时间：2009-04-28T16:14:08.580
> 
> 标签：grails, mapping, foreign-keys, grails-orm, composite

我需要为 GORM 中的复合外键自定义列名，但我没有找到任何说明如何做到这一点的文档。我知道如何自定义 PK 列，以及如何自定义单列 FK，但不知道如何自定义多列 FK。有可能吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-23T07:06:38.760

具有复合 id 的域类必须实现该`Serializable`接口。

```
class Person implements Serializable {
...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T11:57:51.883

您需要在对象映射闭包中使用“id：composite”构造。

我要上班了，这里简单介绍一下：

```
class Person {
  String firstName
  String lastName

    static mapping = { 
        id composite:['firstName', 'lastName'] 
    } 
} 
```

[Grails：对象关系映射](http://www.grails.org/doc/1.0.x/guide/5.%20Object%20Relational%20Mapping%20(GORM).html)

# data-structures - 构建高性能和自动备份的队列

> ID：798748
> 
> 赞同：0
> 
> 时间：2009-04-28T16:19:07.180
> 
> 标签：data-structures, backup, queue, message-queue

请就我的问题给我一些提示。

我正在构建一个队列数据结构：

1.  在硬盘上实时备份
2.  并且可以恢复备份
3.  可以响应大量的入队/出队请求

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-28T16:21:07.830

这是你在做的练习吗？如果没有，您可能应该查看一些生产消息队列技术（例如 Windows 的 MSMQ），它支持将队列持久保存在磁盘上，而不仅仅是将它们存储在内存中。

根据您的要求

```
1\. has a backup on hard disk at realtime 
```

是的，MSMQ 可以做到这一点。

```
2\. and can restore the backup 
```

然后。

```
3\. Can respond to massive enqueue/dequeue request 
```

还有这个...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-28T16:28:29.933

如果可以避免，请不要自己动手。对于 Java，请尝试[ActiveMQ](http://activemq.apache.org/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T18:24:55.537

您可能正在寻找比简单库更复杂的东西。

由于这是一个练习（可能希望您考虑底层数据结构），您可以通过排队到 mySQL 数据库开始简单的方法。与专用排队软件相比，您的性能会很差，但您至少可以让其余的基础设施正常工作。

之后，您可能会看到某种形式的自定义文件格式和基于它的多线程服务器。您也许可以使用 BDB 或 SQLite 之类的东西来实现 I/O 层，从而省去编写实际磁盘例程的麻烦。

# subsonic - SubSonic：如果发生变化怎么办？

> ID：798752
> 
> 赞同：1
> 
> 时间：2009-04-28T16:20:07.270
> 
> 标签：subsonic

我正在使用 SS 2.1 并且刚刚开始使用它。我加载了所有内容，它适用于我一直在做的简单测试，但有一个普遍的问题：有没有办法更新我的构建而不必重建整个东西，一个例子是如果我们改变表格的布局. 假设我们有一个 id 和 name，然后添加 id、name 和 disabled。SS 是聪明的并且能够接受它还是需要一个新的构建？非常感谢您的宝贵时间。

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T17:14:28.950

我相信您使用命令行应用程序来生成映射文件，因此必须重新运行命令行应用程序才能发生这种情况。其次，映射代码必须在插入后即时编译......大多数.net应用程序不这样做。

但是您不希望动态生成映射的最大原因是：速度。这需要时间，至少几秒钟。那你会怎么计时呢？不是每个电话——那太疯狂了。一天一次？白天什么时候？

所以不，SubSonic 仅在您要求时生成映射文件。如果您更改数据库，则可能会破坏您的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T17:14:37.797

如果您在 ASP.NET 中使用构建提供程序，构建您的项目将使 SubSonic 捕获更改并更新生成的类。

否则，您将需要使用 SubCommander 再次生成类。

# .net - 从无限行的网格中“制表”的键盘快捷键？

> ID：798753
> 
> 赞同：1
> 
> 时间：2009-04-28T16:21:05.850
> 
> 标签：.net, user-interface, keyboard-shortcuts

我遇到了一个我确定其他人已经解决并解决的问题。在我的应用程序的几个地方，我有“网格”。更具体地说，Infragistic 的 UltraWinGrid 的 - 但其想法是，在网格内按下`Tab`会将您移动到网格中的下一个单元格。当您在一行的最后一个单元格中时，按下`Tab`会将您移动到下一行。如果您在最后一行的最后一个单元格中，按下`Tab`会将您移至新行。

问题是表单不仅包含一个网格。在某些时候 - 您想从该网格中“退出”并移动到下一个控件。

我认为使用键盘快捷键来提供这种替代行为是有意义的`Tab`......但似乎所有选项都已被采用。

`Shift`+ `Tab`= 向后制表符

`Ctrl`+ `Tab`= 应用程序中窗口之间的选项卡（我们有 MDI 子级和什么没有，所以我们不想更改它）

`Alt`+ `Tab`= 更改应用程序的 Windows 快捷方式

`Windows Key`+ `Tab`= 与上面相同，带有新的 GUI

在没有无限行数的网格中 - 我可以制作一个常规选项卡将它们移出网格。但在这种情况下，网格没有尽头。

有没有人对如何解决这个问题有任何建议/提示？我真的希望能够让我们的用户完全导航应用程序，而无需触摸鼠标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T16:25:37.757

您所说的“无限”行数是什么意思...当您走到最后时，是否在此网格中使用制表符，只需继续创建新的空行。

当他们按下时，您可以测试它们是否在最后一个新行的最后一个单元格中`Tab`，如果是，则 .Focus() 是 winForm 上的下一个控件。或者，您可以将`Tab`完全捕获为控件导航键，并让他们使用箭头键在网格内导航。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T01:55:18.793

您认为让用户知道此键盘快捷键的机会有多大？

也许`Alt`++ （它在我手中效果很好）`Shift`。`Tab`

但是，您不应该在没有与用户进行测试的情况下做出这种决定。这将为您提供两个输出 A）您可以查看这是否是您的用户实际会做的事情，以及 B）您可能能够教您的用户群。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T11:35:00.660

如果您在表单类型控件（例如，文本框、组合框）中设置了一个网格，则可以使用`Esc`从网格切换到其中一个表单控件，或者切换到第一个控件或切换到最后一个以获得焦点.

如果您有多个网格（或多个窗格），`Esc`可以将焦点放在当前网格/窗格上作为一个整体。`Tab`和`Shift`+`Tab`在网格/窗格之间移动焦点。其他键提供了操作窗格的快捷方式（例如，打开、关闭、调整大小、列选择）。在焦点位于整个窗格/网格上时按下`Esc`会将焦点放回网格/窗格。

在这两种情况下，我仍然会使用`Ctrl`+`Tab`和`Shift`+ `Ctrl`+`Tab`来移入和移出网格或网格之间，以及 MDI 中的窗口之间。本质上，将每个窗口中的网格（或窗格）视为“窗口中的窗口”。如果窗口的关联方式与窗口内的网格关联的方式相同（例如，所有显示的数据对象都相互关联），则这是最有意义的。如果用户在网格中，则`Ctrl`+`Tab`移出网格但仍保留在窗口中（或移动到该窗口中的下一个网格/窗格）。一旦用户在一个窗口内没有地方可以去，`Ctrl`+`Tab`移动到下一个窗口（或该窗口内的第一个窗格/网格）。

# asp.net - 在 .NET 中，当我在附加线程中运行表单时如何设置 STAThread？

> ID：798761
> 
> 赞同：0
> 
> 时间：2009-04-28T16:22:34.240
> 
> 标签：asp.net, multithreading, com

我在第二个线程中运行一个表单。如果我按 Ctrl-C 复制剪贴板上的文本，我会得到一个异常，“当前线程必须设置为单线程单元 (STA)，然后才能进行 OLE 调用。（使用剪贴板显然涉及 OLE）。

将 [STAThread] 与我的线程 proc 放在一起，这是我的第二个线程的入口点*不起作用*。什么会起作用？

```
[STAThread]
private void MyFormThreadproc(object o)
{
    form = new MyForm();
    Application.Run(form);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-28T16:24:17.930

创建线程时，请在[`SetApartmentState()`](http://msdn.microsoft.com/en-us/library/system.threading.thread.setapartmentstate.aspx)启动它之前调用该方法。您不能对线程池线程执行此操作。

例如：

```
Thread thread = new Thread(threadAction);
thread.SetApartmentState(ApartmentState.STA);
thread.Start(); 
```

# sql - 如何从表中创建以最大值开始的 Oracle 序列？

> ID：798766
> 
> 赞同：46
> 
> 时间：2009-04-28T16:23:23.050
> 
> 标签：sql, oracle, sequence

尝试在 Oracle 中创建以特定表中的最大值开头的序列。为什么这不起作用？

```
CREATE SEQUENCE transaction_sequence
  MINVALUE 0
  START WITH (SELECT MAX(trans_seq_no)
     FROM TRANSACTION_LOG) 
  INCREMENT BY 1
  CACHE 20; 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-28T16:38:51.530

如果您可以使用 PL/SQL，请尝试（编辑：合并 Neil 的 xlnt 建议以从下一个更高的值开始）：

```
SELECT 'CREATE SEQUENCE transaction_sequence MINVALUE 0 START WITH '||MAX(trans_seq_no)+1||' INCREMENT BY 1 CACHE 20'
  INTO v_sql
  FROM transaction_log;

EXECUTE IMMEDIATE v_sql; 
```

要考虑的另一点：通过将 CACHE 参数设置为 20，如果数据库出现故障，您可能会在序列中丢失多达 19 个值。缓存的值在数据库重新启动时丢失。除非你经常打这个序列，或者你不太在意间隔，我会把它设置为 1。

最后一点：您为 CACHE 和 INCREMENT BY 指定的值是默认值。您可以将它们关闭并获得相同的结果。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-05-29T09:30:21.130

这里我有我的例子，它工作得很好：

```
declare
 ex number;
begin
  select MAX(MAX_FK_ID)  + 1 into ex from TABLE;
  If ex > 0 then
    begin
            execute immediate 'DROP SEQUENCE SQ_NAME';
      exception when others then
        null;
    end;
    execute immediate 'CREATE SEQUENCE SQ_NAME INCREMENT BY 1 START WITH ' || ex || ' NOCYCLE CACHE 20 NOORDER';
  end if;
end; 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-04-28T17:04:00.490

你可能想从`max(trans_seq_no) + 1.`

手表：

```
SQL> create table my_numbers(my_number number not null primary key);

Table created.

SQL> insert into my_numbers(select rownum from user_objects);

260 rows created.

SQL> select max(my_number) from my_numbers;

MAX(MY_NUMBER)
--------------
           260

SQL> create sequence my_number_sn start with 260;

Sequence created.

SQL> insert into my_numbers(my_number) values (my_number_sn.NEXTVAL);
insert into my_numbers(my_number) values (my_number_sn.NEXTVAL)
*
ERROR at line 1:
ORA-00001: unique constraint (NEIL.SYS_C00102439) violated 
```

当您创建一个带有数字的序列时，您必须记住，当您第一次选择该序列时，Oracle 将返回您分配给它的初始值。

```
SQL> drop sequence my_number_sn;

Sequence dropped.

SQL> create sequence my_number_sn start with 261;

Sequence created.

SQL>  insert into my_numbers(my_number) values (my_number_sn.NEXTVAL);

1 row created. 
```

如果你想做“无缝”的事情，我强烈建议你

# 1 不这样做，#2 不使用序列。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-04-28T16:26:01.437

您不能在`CREATE SEQUENCE`语句中使用子选择。您必须事先选择该值。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-04-28T23:14:21.190

在中间承受，MAX 值将只是**承诺**值的最大值。它可能会返回 1234，您可能需要考虑有人已经插入了 1235 但尚未提交。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2017-07-13T19:20:37.430

基于 Ivan Laharnar，代码更少，更简单：

```
declare
    lastSeq number;
begin
    SELECT MAX(ID) + 1 INTO lastSeq FROM <TABLE_NAME>;
    if lastSeq IS NULL then lastSeq := 1; end if;
    execute immediate 'CREATE SEQUENCE <SEQUENCE_NAME> INCREMENT BY 1 START WITH ' || lastSeq || ' MAXVALUE 999999999 MINVALUE 1 NOCACHE';
end; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-11-17T07:38:52.923

```
DECLARE
    v_max NUMBER;
BEGIN
    SELECT (NVL (MAX (<COLUMN_NAME>), 0) + 1) INTO v_max FROM <TABLE_NAME>;
    EXECUTE IMMEDIATE 'CREATE SEQUENCE <SEQUENCE_NAME> INCREMENT BY 1 START WITH ' || v_max || ' NOCYCLE CACHE 20 NOORDER';
END; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-09-19T11:37:16.837

使用动态 sql

```
BEGIN
            DECLARE
            maxId NUMBER;
              BEGIN
              SELECT MAX(id)+1
              INTO maxId
              FROM table_name;          
              execute immediate('CREATE SEQUENCE sequane_name MINVALUE '||maxId||' START WITH '||maxId||' INCREMENT BY 1 NOCACHE NOCYCLE');
              END;
END; 
```

# c# - 提交表单后获取页面的url

> ID：798767
> 
> 赞同：1
> 
> 时间：2009-04-28T16:23:54.720
> 
> 标签：c#, asp.net, watin

我正在设计一个基于 winforms 的测试应用程序（基于 WatiN）。我指定要测试的页面和要插入到文本框中的值，然后单击相应的按钮。

是否可以在我发出的请求中添加查询字符串（单击按钮时），然后获取下一页的 URL？基于此，我需要对它进行筛选。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T08:19:51.737

不确定 Watin 语法，但在 Watir（Ruby 版本）中，您可以获取在浏览器中显示的页面的 URL

```
browser.url 
```

或者你需要在打开它之前获取下一页的 URL 吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T14:19:23.900

根据您对 Am​​itK 的评论，Željko 的回答是正确的。在 WatiN（和 C#）中，语法是：

```
Console.WriteLine("The current page is:" + ie.Url.ToString()); 
```

（以防万一：'ie' 是浏览器引用，使用您用来输入文本和单击按钮的任何对象）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T16:45:48.800

“下一页”到底是什么意思？提交时表单是否重定向到另一个页面？如果是这样，您将收到带有下一页 URL 的 HTTP 302/303 状态代码。

# outlook - Outlook 的保存文件对话框在哪里？

> ID：798771
> 
> 赞同：0
> 
> 时间：2009-04-28T16:25:10.207
> 
> 标签：outlook, office-2007, outlook-2007, outlook-addin

我正在开发一个 Outlook 加载项，该加载项需要 Office 特定的 FileDialog 才能与 Sharepoint 站点进行互操作；公用文件对话框不具备互操作性。我知道 Word 和 Excel 在 Globals.ThisAddIn.Application.Application 下都有一个 get_fileDialog 方法，但 Outlook 似乎没有。如何启动 Outlook FileDialog？甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-06-15T10:29:11.097

[微软通用对话框](http://msdn.microsoft.com/en-us/library/aa155724%28office.10%29.aspx)

如果您安装了 COMDLG32.OCX（“Common Dialog ActiveX Control”），那么您可以使用它——这里有一个示例。（向下滚动到标题为“图 2：不要尝试在 Word 中选择多个文件！”的屏幕截图）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-07T16:51:20.440

Outlook 的 Application 对象似乎不提供`FileDialog`. 但是，如果您愿意获得 Excel 参考，一个简单的解决方法是：

```
Dim fd As FileDialog
Set fd = Excel.Application.FileDialog(msoFileDialogFolderPicker)
Dim folder As Variant    
If fd.Show = -1 Then
    For Each folder In fd.SelectedItems
        Debug.Print "Folder:" & folder & "."
    Next
End If 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T16:38:47.070

```
'Add a "Module". Then add the declarations like this to it.

Option Explicit
Private Declare Function GetOpenFileName _
                Lib "comdlg32.dll" _
                Alias "GetOpenFileNameA" (pOpenfilename As OPENFILENAME) As Long
Private Type OPENFILENAME
    lStructSize As Long
    hwndOwner As Long
    hInstance As Long
    lpstrFilter As String
    lpstrCustomFilter As String
    nMaxCustFilter As Long
    nFilterIndex As Long
    lpstrFile As String
    nMaxFile As Long
    lpstrFileTitle As String
    nMaxFileTitle As Long
    lpstrInitialDir As String
    lpstrTitle As String
    flags As Long
    nFileOffset As Integer
    nFileExtension As Integer
    lpstrDefExt As String
    lCustData As Long
    lpfnHook As Long
    lpTemplateName As String
End Type

Public Function MyOpenFiledialog() As String
    Dim OFName As OPENFILENAME
    OFName.lStructSize = Len(OFName)
    'Set the parent window
    OFName.hwndOwner = Application.hWnd
    'Set the application's instance
    OFName.hInstance = Application.hInstance
    'Select a filter
    OFName.lpstrFilter = "Text Files (*.txt)" + Chr$(0) + "*.txt" + Chr$(0) + "All Files (*.*)" + Chr$(0) + "*.*" + Chr$(0)
    'create a buffer for the file
    OFName.lpstrFile = Space$(254)
    'set the maximum length of a returned file
    OFName.nMaxFile = 255
    'Create a buffer for the file title
    OFName.lpstrFileTitle = Space$(254)
    'Set the maximum length of a returned file title
    OFName.nMaxFileTitle = 255
    'Set the initial directory
    OFName.lpstrInitialDir = "C:\"
    'Set the title
    OFName.lpstrTitle = "Open File - VB Forums.com"
    'No flags
    OFName.flags = 0
    'Show the 'Open File'-dialog
    If GetOpenFileName(OFName) Then
        MsgBox "File to Open: " + Trim$(OFName.lpstrFile)
        MyOpenFiledialog = Trim$(OFName.lpstrFile)
    Else
        MsgBox "Cancel was pressed"
        MyOpenFiledialog = vbNullString
    End If
End Sub 'Usage:
Private Sub Command1_Click()
    Text1.Text = MyOpenFiledialog
End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-10T07:00:54.787

```
Public Sub TestFileDialog()
    Dim otherObject As Excel.Application
    Dim fdFolder As office.FileDialog

    Set otherObject = New Excel.Application
    otherObject.Visible = False
    Set fdFolder = otherObject.Application.FileDialog(msoFileDialogFolderPicker)
    fdFolder.Show
    Debug.Print fdFolder.SelectedItems(1)
    otherObject.Quit
    Set otherObject = Nothing
End Sub 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-10T22:19:17.337

```
Private Sub multiEML2MSG()

Const PR_ICON_INDEX = &H10800003

Dim objPost As Outlook.PostItem
Dim objSafePost As Redemption.SafePostItem
Dim objNS As Outlook.NameSpace
Dim objInbox As Outlook.MAPIFolder

Set objNS = Outlook.GetNamespace("MAPI")
Set objInbox = objNS.GetDefaultFolder(olFolderInbox)
Set objPost = objInbox.Items.Add(OlItemType.olPostItem)

Set objSafePost = New Redemption.SafePostItem

    Dim xlObj As Excel.Application
    Dim fd As Office.FileDialog

    Set xlObj = New Excel.Application

    Set fd = xlObj.Application.FileDialog(msoFileDialogFolderPicker)
    With fd
        .Title = "Select your PST File"
        .ButtonName = "Ok"
        .Show

        If fd.SelectedItems.Count <> 0 Then
            xDirect$ = fd.SelectedItems(1) & "\"
            xFname$ = Dir(xDirect$, 7)

            licznik = 1
            Do While xFname$ <> ""

            XPathEML = xDirect$ & xFname$
            XPathMSG = Replace(XPathEML, ".eml", ".msg", , , vbTextCompare)
            Debug.Print XPath, Replace(XPath, ".eml", ".msg", , , vbTextCompare)

            objPost.Save
            objSafePost.Item = objPost
            objSafePost.Import XPathEML, Redemption.RedemptionSaveAsType.olRFC822
            objSafePost.MessageClass = "IPM.Note"
            objSafePost.Fields(PR_ICON_INDEX) = none
            objSafePost.SaveAs XPathMSG, Outlook.OlSaveAsType.olMSG

            xFname$ = Dir
            licznik = licznik + 1
        Loop

        End If
    End With

    xlObj.Quit
    Set xlObj = Nothing
    Set objSafePost = Nothing
    Set objPost = Nothing
    Set objInbox = Nothing
    Set objNS = Nothing

End Sub 
```

# ruby-on-rails - TypeError (Can't convert nil into String) With Attachment_Fu

> ID：798775
> 
> 赞同：2
> 
> 时间：2009-04-28T16:26:26.680
> 
> 标签：ruby-on-rails, ruby, types, attachment-fu

我正在使用 Attachment_fu 在我的 Rails 应用程序中处理文件附件，它提供了`public_filename`一种检索文件 URL 的方法。我在一个名为 Cover 的模型上使用它，所以如果我想调用上传的封面图片的 URL，在视图中我会这样做：

```
<%= image_tag(@cover.public_filename) %> 
```

当用户有适当的附件时，这工作得很好，但在我的应用程序中，用户不需要上传附件。

因此，调用`@cover.public_filename`将抛出 TypeError: Can't convert nil into String ，原因很明显，文件为 nil。

但是，由于对象为零，我无法有效地为这个问题添加逻辑，并且我所有尝试做类似的事情`unless @cover.public_filename.nil?`或`if @cover.public_filename == nil`都没有结果并导致相同的类型错误。

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T20:01:25.773

我没有使用 attachment_fu，但正如我所见，public_filename 是一种方法，当您没有附加附件时，它依赖于一些为零的字段。[在这里](http://david-burger.blogspot.com/2008/05/attachmentfu-with-optional-attachment.html)我读到 attachment_fu 应该总是有附件 - 这可能是它对你不起作用的原因。作者还建议使用[回形针](http://www.thoughtbot.com/projects/paperclip)插件。看看吧！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T17:17:16.540

```
<%= image_tag(@cover.public_filename) unless @cover.nil? %> 
```

*抱歉，无法发表评论，所以这里有一个**更新**：*

`@cover.public_filename?`在这里不起作用，因为`@cover`它是一个`nil`对象，因此没有`public_filename?`方法。

```
nil.respond_to?('public_filename?') #=> false 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-25T12:17:17.983

这可能会有所帮助.. [http://david-burger.blogspot.com/2008/10/attachmentfu-with-optional.html](http://david-burger.blogspot.com/2008/10/attachmentfu-with-optional.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T17:17:57.850

## 更新：

做了：

`<%= image_tag(@cover.public_filename) if @cover && @cover.public_filename? %>`

# sql-server - MVC 中的分层数据库驱动菜单

> ID：798777
> 
> 赞同：1
> 
> 时间：2009-04-28T16:27:04.400
> 
> 标签：sql-server, asp.net-mvc, linq, subsonic

我将下面的代码用作 HTMLHelper，它从数据库中获取数据并循环显示菜单。正如您所看到的，这相当简单，但是，如果您有一个使用相邻层次结构模型的数据库表，例如/ID、ParentID、OrderID，该怎么办。很容易看到发生了什么，但需要递归才能正确获取这些数据。编写 C# 递归函数是否可以接受？如果是这样，有人可以帮我吗？预期的输出与此类似..

```
<ul>
  <li>Item1
    <ul>
      <li>SubItem1</li>
    </ul>
  </li>
</ul> 
```

SQL 2008 现在有一个 Hierarchy 数据类型，所以我不确定这是否会有所帮助？

我还希望通过某种方式使用户能够决定菜单中的内容，例如，可以进入菜单的项目列表，然后选择这些项目及其在层次结构中的位置。一旦按下保存的按钮，它将将此层次结构存储在数据库中。

我是不是问得太多了，我敢肯定这一定是很常见的情况？

如果有人想使用它，这是我的 HTMLHelper 代码...

```
 public static string Menu(this HtmlHelper helper, int MenuCat)
{

    string menuHTML = "<ul id=\"menu\">";

    var route = helper.ViewContext.RequestContext.RouteData;
    string currentPageName = route.GetRequiredString("id");

    DB db = DB.CreateDB();

    //var result = from p in db.WebPages where p.CategoryID == 9 select p;
    var result = from p in db.WebPages select p;

    foreach (var item in result)
    {
        if (item.Name == currentPageName)
        {

            menuHTML += "\n\t<li>" + helper.ActionLink(item.Name, "Details", "Dinner", new { id = item.ID }, new { @class = "selected" }) + "</li>";
        }
        else
        {
            menuHTML += "\n\t<li>" + helper.ActionLink(item.Name, "Details", "Dinner", new { id = item.ID }, null) + "</li>";
        }
    }

    menuHTML += "\n</ul>\n";

    return menuHTML;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T18:28:22.453

我会在这里做两件事：不要自己渲染这个：使用 jQuery。如果你用谷歌搜索“jquery menu”，你会发现数百个链接。

接下来，将排序逻辑放在您的应用程序中，您不需要数据库来执行此操作，因为它会吸收周期并且（根据我所读到的）效率不是很高。这是一个带有自引用连接的简单循环逻辑，Linq 非常适合。

把它交给 jQuery，你最好不用在代码中硬编码 HTML :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T18:48:55.150

如果您使用的是 Sql server 2005，请查看 Common Table Expression (CTE)（带有 CTE 分层数据的谷歌）。它允许您创建一个显示完整层次结构的视图。

但是，您在菜单中显示了多少深度级别？通常，您只需要显示直接子项并在用户单击链接时在层次结构中向下移动。（不需要递归）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-23T14:52:50.990

我总是使用递归表值函数来获取 SQL Server 中的分层数据。

在此处查看示例：blogs.conchango.com/christianwade/archive/2004/11/09/234.aspx

不幸的是，SQL Server 用户定义函数 (UDF) 和存储过程存在递归限制（最多 32 级）。

注意：如果您使用表值函数，只需将其放入您的 dbml 文件中，您就可以像访问任何其他表一样访问它。

另一种方法是使用 SQL Server 2005 中引入的新递归查询语法（以 WITH 子句和 Common Table Expressions-CTE 的形式）。

看看这里：www.eggheadcafe.com/articles/sql_server_recursion_with_clause.asp

这里介绍了一种将 CTE 与 Linq-To-SQL 混合的方法：stackoverflow.com/questions/584841/common-table-expression-cte-in-linq-to-sql

# java - 使用Java有效地从数据库中排序数据？

> ID：798779
> 
> 赞同：0
> 
> 时间：2009-04-28T16:27:57.877
> 
> 标签：java, database, sorting

### 我们有什么：

3 个 MySQL 数据库表：用户、文本、朋友

**用户**：用户名、密码、电子邮件等。

**text** : 用户名、文本、日期等。

**朋友**：用户名、朋友用户名等。

### 任务：

编写一个算法（用 Java 语言）来**显示来自您朋友的 10 条最新文本**。

*最终目标是在O(n log n)*内运行时间。

可以根据需要修改数据库表（添加新表）。

*数据量：* 200 000 个用户，每个用户约 50 个文本。

我将不胜感激任何想法、例子、观点等。谢谢！

*（不是功课。纯问题，求性能提升）*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T16:30:38.790

你确定这必须在Java中完成吗？这不是 SQL 查询吗？

```
SELECT text
  FROM TEXT
 WHERE username IN
         (
           SELECT friend_username FROM FRIEND WHERE username = 'YOUR_USERNAME'
         )
 ORDER BY date DESC
 LIMIT 10 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T16:33:41.730

你没有说什么数据库，所以我只是做一个假设（下面的 Postgres 语法）：

```
select t.* from text t
    inner join friend f ON f.friend_username = t.username
    where f.username = 'myusername'
    order by t.date desc
    LIMIT 10 
```

# xml - 使用正则表达式修复 xml 内容

> ID：798781
> 
> 赞同：0
> 
> 时间：2009-04-28T16:28:29.997
> 
> 标签：xml, regex

我正在尝试使用正则表达式修复一些双语 xml 文件，以匹配已知的错误内容模式并替换正确的值。xml 文件中的大多数问题都可以认为是拼写错误或冗余数据。

我确实有一个可以在没有任何正则表达式支持的软件中工作的文本处理工具，但是如果我可以使用 sed 或类似的东西来编写批处理作业并将其放置一夜之间，那么整个情况会容易得多。**应该**解决问题的示例 sed 脚本可能如下所示：

```
#!/bin/sed -f
s/<prop type="Att::Status">New/<prop type="Att::Status">Not Validated/g
s/<prop type="Att::Status">Approved/<prop type="Att::Status">Validated/g
.... 
```

我发现 sed 不太喜欢 UTF16 文件，而且由于我们正在处理 34 种不同语言组合的双语 xml，因此使用 iconv 之类的工具来包装 sed 脚本可能非常危险。大多数字符集转换工具都会导致某种形式的损坏，我宁愿不花一周的时间来决定脚本在哪些语言上正常工作。

还值得一提的是，xml 中充满了过去几年客户积累的翻译，因此其中会有大量格式错误的语法，可能会导致一些工具出错。

所以总而言之，sed + iconv 风险太大，我有一个基本的全局文本替换工具，我有 Notepad++，我什至有一个 sed 语法中用于替换的表达式列表。但是有没有更简单/更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T19:06:45.100

我不知道 XML Starlet 的复杂性是否比 XSLT 的复杂性低 - 大多数复杂性实际上是在 XPath 中，您将使用它来查找要更改的节点。

如果您要使用 XSLT，您只需创建一个身份转换，然后添加一个模板来更改您感兴趣的文本节点：

```
<xsl:template match="prop[@type='Att::Status']/text()">
   <xsl:choose>
      <xsl:when test=". = 'New'">Validated</xsl:when>
      <xsl:when test=". = 'Approved'">Not Validated</xsl:when>
      <xsl:otherwise>
         <xsl:copy/>
      </xsl:otherwise>
   </xsl:choose>
</xsl:template> 
```

或者您可以发疯并在外部 XML 文件中指定映射，例如：

```
<map>
   <text value="New">Validated</text>
   <text value="Approved">Not Validated</text>
</map> 
```

然后，在您的 XSLT 中：

```
<xsl:variable name="map" select="document('map.xml')/map/text"/>

<xsl:template match="prop[@type='Att::Status']/text()">
   <xsl:choose>
      <xsl:when test="$map[@value=current()]">
         <xsl:copy-of select="$map[@value=current()]/text()"/>
      </xsl:when>
      <xsl:otherwise>
         <xsl:copy/>
      </xsl:otherwise>
   </xsl:choose>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T17:19:41.247

请参阅[XMLStarlet](http://xmlstar.sourceforge.net)。它是一个用于读取/操作 XML 的命令行工具集。

特别是，[xml ed](http://xmlstar.sourceforge.net/doc/UG/ch04s03.html)命令可能是您想要的。您可以指定要更改的 XPath 以及如何更改它。它将尊重指定的 XML 字符编码等，而您的标准命令行工具则不会。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T16:35:23.613

我原以为[xslt](http://en.wikipedia.org/wiki/XSL_Transformations)是你做这类事情的最佳选择。

# asp.net - Asp.net 全文多搜索词方法

> ID：798782
> 
> 赞同：1
> 
> 时间：2009-04-28T16:28:33.147
> 
> 标签：asp.net, sql, full-text-search

我有一个搜索框，用户可以在其中输入术语。我有一个在字符串列上进行全文搜索的表设置。假设用户键入：“word、office、microsoft”并单击“搜索”。

这是处理多个搜索词的最佳方式吗？

```
(pseudocode)
foreach (string searchWord in searchTerms){    
    select col1 from myTable where contains(fts_column, ‘searchWord’)
} 
```

有没有办法在 sql 中包含搜索词而不是迭代？我正在尝试减少对 sql 服务器的调用量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T17:00:30.123

FREETEXT 可能对您有用。它将基于单词边界（断词）将字符串分成单独的单词。那么您将只有一个 SQL 调用。

[MSDN——自由文本](http://msdn.microsoft.com/en-us/library/ms176078.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T16:35:07.920

那么你可以动态地构建你的 SQL 查询......

```
string [] searchWords = searchTerm.Split(",");

string SQL = "SELECT col1 FROM myTable WHERE 1=2";

foreach (string word in searchWords)
{
    SQL = string.Format("{0} OR contains(fts_column, '{1}')", SQL, word);
}

//EXEC SQL... 
```

**显然，这带有关于 SQL 注入等的常见警告/免责声明……**但主要是您将动态构建所有子句并将它们应用到一个查询中。

根据您与数据库的交互方式，您可以将整个未拆分的搜索词传递到 SPROC 中，然后在存储过程中拆分和构建动态 SQL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T17:10:09.100

你可以像你在那里做的那样做：只需根据分隔符解析搜索词，然后对每个词进行调用，将结果连接在一起。或者，您可以执行多个 CONTAINS：

```
SELECT Name FROM Products WHERE CONTAINS(Name, @Param1) OR CONTAINS(Name, @Param2) etc. 
```

也许两者都试一下，看看哪个在您的环境中更快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-07-20T01:26:16.190

我使用这个类来[规范化 SQL Server 全文搜索条件](http://ewbi.blogs.com/develops/2007/05/normalizing_sql.html)

# php - 使用 PHP 脚本登录 Facebook，但让我在此脚本结束后登录浏览器

> ID：798785
> 
> 赞同：-3
> 
> 时间：2009-04-28T16:30:13.673
> 
> 标签：php, javascript, facebook, curl, twitter

拜托，我正在解决这个问题。我需要从我的服务器上运行的 PHP 脚本登录到 Facebook 或 Twitter 或任何其他网站。我通常用 CURL 来做这件事，将 cookie 保存到一些预定义的文件中。但是现在我需要一些新的东西。即使脚本结束了登录过程，我也需要使用浏览器保持登录状态。这是简单的事情，我看不到..还是我要进入复杂的领域？有些东西告诉我，我需要使用 javascript 来设置所有 cookie 并发送登录数据表单？

如果有人用 javascript 登录 Facebook 或 Twitter，你能和我分享一些技巧或完整的脚本吗？

感谢您提供任何提示并向我解释整体逻辑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T17:58:55.053

我会查看[Facebook Connect](http://developers.facebook.com/connect.php)，更多信息[在这里](http://wiki.developers.facebook.com/index.php/Trying_Out_Facebook_Connect)和[这里](http://onlinewebapplication.com/2011/08/login-facebook-twitter-php.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-17T04:03:30.200

为你的下一份工作:) 浏览了一下之后，我找到了你（有时是我）需要[的脚本。](http://geekalicio.us/2009/04/24/logging-into-facebook-with-php-and-curl/)

```
/*
* Login to facebook
* $login_email : Account to login with
* $login_pass : Account password
*
* Returns true if logged in successfully, false otherwise
* Echoes any login error code
*
* Matt Smith - geekalicio.us
* Apr 23, 2009
*/
function fb_login($login_email, $login_pass){

 $ch = curl_init();
 curl_setopt($ch, CURLOPT_URL, 'https://login.facebook.com/login.php?login_attempt=1');
 curl_setopt($ch, CURLOPT_POSTFIELDS,'charset_test=%E2%82%AC%2C%C2%B4%2C%E2%82%AC%2C%C2%B4%2C%E6%B0%B4%2C%D0%94%2C%D0%84&locale=en_US&email='.urlencode($login_email).'&pass='.urlencode($login_pass).'&pass_placeholder=&charset_test=%E2%82%AC%2C%C2%B4%2C%E2%82%AC%2C%C2%B4%2C%E6%B0%B4%2C%D0%94%2C%D0%84');
 curl_setopt($ch, CURLOPT_POST, 1);
 curl_setopt($ch, CURLOPT_HEADER, 0);
 curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
 curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
 curl_setopt($ch, CURLOPT_COOKIEJAR, str_replace('\\','/',dirname(__FILE__)).'/fb_cookies.txt');
 curl_setopt($ch, CURLOPT_COOKIEFILE, str_replace('\\','/',dirname(__FILE__)).'/fb_cookies.txt');
 curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
 curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.1.3) Gecko/20090824 Firefox/3.5.3 GTB5");
 curl_exec($ch);

 $err = 0;
 $err = curl_errno($ch);
 curl_close($ch);

 if ($err != 0){
 echo 'error='.$err."\n";
 return(false);
 } else {
 return(true);
 }

} 
```

然后你可以加载主页

```
if (fb_login($login_email,$login_pass)){
$ch = curl_init();
 curl_setopt($ch, CURLOPT_URL, 'https://login.facebook.com/login.php?login_attempt=1');
 curl_setopt($ch, CURLOPT_POSTFIELDS,'charset_test=%E2%82%AC%2C%C2%B4%2C%E2%82%AC%2C%C2%B4%2C%E6%B0%B4%2C%D0%94%2C%D0%84&locale=en_US&email='.urlencode($login_email).'&pass='.urlencode($login_pass).'&pass_placeholder=&charset_test=%E2%82%AC%2C%C2%B4%2C%E2%82%AC%2C%C2%B4%2C%E6%B0%B4%2C%D0%94%2C%D0%84');
 curl_setopt($ch, CURLOPT_POST, 1);
 curl_setopt($ch, CURLOPT_HEADER, 0);
 curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
 curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
 curl_setopt($ch, CURLOPT_COOKIEJAR, str_replace('\\','/',dirname(__FILE__)).'/fb_cookies.txt');
 curl_setopt($ch, CURLOPT_COOKIEFILE, str_replace('\\','/',dirname(__FILE__)).'/fb_cookies.txt');
 curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
 curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.1.3) Gecko/20090824 Firefox/3.5.3 GTB5");
$html = curl_exec($ch);

 curl_close($ch);

  echo $html;
} 
```

我使用的整个脚本位于[http://pastie.org/619912](http://pastie.org/619912)。
是的，用它做善事，而不是作恶:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T16:37:29.257

我不认为这应该是可能的。当您的 PHP 脚本登录时，它会获取 Facebook 的身份验证令牌/cookie。该 cookie 是私有的，不应该在任何其他机器上使用。有一些骇人听闻的方法可以做到这一点，但我不能推荐。

# c# - 绘制 ListViewItem 超出 VisibleClipBounds

> ID：798788
> 
> 赞同：0
> 
> 时间：2009-04-28T16:30:50.490
> 
> 标签：c#, winforms, listview, listviewitem

我正在尝试在自定义用户控件上手动绘制 ListViewItems。控件本身是 ListView 的包装器，该 ListView 存储为类的私有成员。

附加了一个 DrawListViewItemEventHandler 以允许手动绘制这些项目，并且在大多数情况下这似乎有效。我遇到的问题是 ListViewItem 的文本（在大图像模式下）很长。

我正在使用各种主题在 ListViewItem 周围绘制一个边界矩形，然后使用 Graphics.MeasureString() 测量文本的大小并手动绘制文本。但是我发现垂直绘图在 2.5 行文本处被裁剪，因为标题超出了我通过的图形上下文的 VisibleClipBounds 之外。

这似乎有点奇怪，但我不确定为什么会发生这样的事情，也无法弄清楚如何解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T10:14:49.957

您可以使用 Tile view 和 TileSize 给自己足够的空间来绘制文本。

ListView 不能保证绘制所有文本：文本可能很大。

# google-app-engine - 我应该如何在 Google App Engine 上提供托管服务

> ID：798795
> 
> 赞同：1
> 
> 时间：2009-04-28T16:31:43.217
> 
> 标签：google-app-engine, saas, hosted

如果我想在我的服务上租用空间，而我又在 Google App Service 上托管，我需要了解一些服务条款吗？

此外，如果我想提供应该为公司定制的服务，比如说一个 Wiki，该公司可以像他们自己一样定制皮肤甚至域。可以这样做吗？我是否必须提供要安装在客户的 Google App 帐户中的二进制文件？例如，我的 wiki 应用程序将在 wiki.company.com 上运行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T16:38:52.750

我不相信 TOS 中有任何内容阻止您在 GAE 上将您的软件作为服务出售。

然而，目前域问题有点棘手，因为用于将大量域名附加到单个应用程序实例的工具相对有限。您目前最好的选择可能是为每个客户购买 Google 的域帐户，并将它们托管在这些单独的帐户上。

（参见[第 113 期](http://code.google.com/p/googleappengine/issues/detail?id=113)）

# regex - 如何使用 UNIX find 来查找（file1 OR file2）？

> ID：798797
> 
> 赞同：0
> 
> 时间：2009-04-28T16:32:23.590
> 
> 标签：regex, unix, find

在`bash`命令行中，我想查找所有名为`foo`或的文件`bar`。我试过这个：

```
find . -name "foo\|bar" 
```

但这不起作用。什么是正确的语法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-28T16:35:35.847

你要：

```
find . \( -name "foo" -o -name "bar" \) 
```

查看[维基百科](http://en.wikipedia.org/wiki/Find)页面（所有地方）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T16:38:20.003

我很便宜，我会用这个：

```
find ./ | grep -E 'foo|bar' 
```

这只是我个人的偏好，我更喜欢 grep 而不是 find，因为语法更容易“获取”，一旦你掌握了它，它的用途就不仅仅是遍历文件树。

# c++ - ifstream::open 在 Visual Studio 调试模式下不起作用

> ID：798798
> 
> 赞同：7
> 
> 时间：2009-04-28T16:32:30.890
> 
> 标签：c++, visual-studio, ifstream

我一直在讨论关于 SO 的 ifstream 问题，但我仍然无法阅读一个简单的文本文件。我正在使用 Visual Studio 2008。

这是我的代码：

```
// CPPFileIO.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"
#include <fstream>
#include <conio.h>
#include <iostream>
#include <string>

using namespace std;

int _tmain(int argc, _TCHAR* argv[])
{

    ifstream infile;
    infile.open("input.txt", ifstream::in);

    if (infile.is_open())
    {
        while (infile.good())
            cout << (char) infile.get();
    }
    else
    {
        cout << "Unable to open file.";
    }
    infile.close();
    _getch();
    return 0;
} 
```

通过检查 .txt 的值，我确认*input.txt*文件位于正确的“工作目录”中`argv[0]`。Open 方法是行不通的。

我在调试时也遇到了麻烦-我应该无法设置手表吗`infile.good()`？`infile.is_open()`我不断得到

```
Error: member function not present. 
```

**编辑：**使用 .CPP 文件中的完整代码更新代码列表。

**更新：**该文件不在当前工作目录中。这是*项目文件*所在的目录。把它移到那里，它在 VS.NET 中调试时工作。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-28T16:39:16.350

在指定打开模式时尝试使用按位或运算符。

```
infile.open ("input.txt", ios::ate | ios::in); 
```

openmode参数是位掩码 [。](http://www.cplusplus.com/reference/iostream/ios_base/openmode/)`ios::ate`用于打开文件以进行追加，并`ios::in`用于打开文件以读取输入。

如果您只想读取文件，您可能只需使用：

```
infile.open ("input.txt", ios::in); 
```

* * *

ifstream 的默认打开模式是 ios::in，因此您现在可以完全摆脱它。以下代码使用 g++ 为我工作。

```
#include <iostream>
#include <fstream>
#include <cstdio>

using namespace std;

int main(int argc, char** argv) {
    ifstream infile;
    infile.open ("input.txt");

    if (infile)
    {
        while (infile.good())
            cout << (char) infile.get();
    }
    else
    {
        cout << "Unable to open file.";
    }
    infile.close();
    getchar();
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-04T12:21:07.300

有时 Visual Studio 会将您的 exe 文件远离源代码。默认情况下，VS 可能只查找从您的 exe 文件开始的文件。此过程是从与源代码相同的目录中获取输入 txt 文件的简单步骤。如果您不想修复 IDE 设置。

```
using namespace std;

ifstream infile;

string path = __FILE__; //gets source code path, include file name
path = path.substr(0,1+path.find_last_of('\\')); //removes file name
path+= "input.txt"; //adds input file to path

infile.open(path); 
```

希望这可以帮助其他人快速解决问题。我自己花了一段时间才找到这个设置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T16:45:40.080

我在您的代码中发现了两个问题：

a) "ios::ate || ios::in" => 中的语法错误应该是 "ios::ate | ios::in"

b) "ios::ate" 将光标设置到文件末尾——所以当你开始阅读时你什么也得不到

所以只需删除“ios::ate”就可以了：）

乔，克里斯

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T16:40:52.650

```
infile.open ("input.txt", ios::ate || ios::in); 
```

`||`是逻辑或运算符，而不是按位运算符（如 Bill The Lizzard 所说）。

所以我猜你正在做相当于：

```
infile.open ("input.txt", true); 
```

（假设 ios::ate 或 ios::in 都不是 0）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T16:41:06.690

尝试使用：

```
ifstream fStm("input.txt", ios::ate | ios::in); 
```

> 我也无法调试 - 我是否应该无法在“infile.good()”或“infile.is_open()”上设置监视？我不断收到“错误：成员函数不存在”。

正确的包括：

```
#include <fstream> 
```

等等

# download - 计算剩余下载时间的最佳方法是什么？

> ID：798800
> 
> 赞同：15
> 
> 时间：2009-04-28T16:33:14.167
> 
> 标签：download

假设您要计算剩余下载时间，并且您拥有所有需要的信息，即：文件大小、dl'ed 大小、剩余大小、已用时间、瞬时 dl 速度等。您将如何计算剩余的 dl 时间？

当然，直接的方法是：左尺寸/瞬时dl速度，或：（经过时间/dl'ed尺寸）*左尺寸。只是第一个会受到瞬时速度的偏差，而后者不能很好地适应变化的速度。

必须有一些更聪明的方法来做到这一点，对吧？查看您当前使用 uTorrent 下载的盗版软件和音乐。很容易注意到它比前面提到的简单计算做得更多。实际上，我注意到有时当 dl 速度下降时，剩余时间也会下降一段时间，直到它重新调整。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-28T16:36:40.977

好吧，正如您所说，使用绝对当前的下载速度并不是一个好方法，因为它往往会波动。然而，像整体平均值这样的东西也不是一个好主意，因为那里也可能存在很大的波动。

考虑一下我是否与其他 9 个人同时开始下载文件。我的速度只有正常速度的 10%，但文件进行到一半，其他 9 个完成。现在我的下载速度是开始时的 10 倍。我最初的 10% 速度不应该成为“还剩多少时间？”的一个因素。再计算。

就个人而言，我可能会在过去 30 秒左右取平均值，然后使用它。那应该根据最近的速度进行计算，而不会剧烈波动。30 秒可能不是正确的数量，需要一些实验才能确定一个合适的数量。

另一种选择是设置一种“波动阈值”，在速度变化超过该阈值之前，您不会进行任何重新计算。例如（同样，随机数需要试验），您可以将阈值设置为 10%。然后，如果您以 100kb/s 的速度下载，则无需重新计算剩余时间，直到下载速度变为低于 90kb/s 或 110kb/s。如果发生其中一项更改，则会重新计算时间并设置新阈值。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-28T17:37:01.033

您可以使用旧值线性衰减的平均算法。如果 S_n 是时间 n 的速度，A_{n-1} 是时间 n-1 的平均值，则按如下方式定义您的平均速度。

A_1 = S_1
A_2 = (S_1 + S_2)/2
A_n = S_n/(n-1) + A_{n-1}(1-1/(n-1))

在英语中，这意味着过去进行的测量时间越长，它的重要性就越低，因为它的重要性已经减弱。

将此与正常的平均算法进行比较：A_n = S_n/n + A_{n-1}(1-1/n)

你也可以让它几何衰减，这会非常重视最近的速度：A_n = S_n/2 + A_{n-1}/2

如果速度为 4,3,5,6，则 A_4 = 4.5（简单平均）
A_4 = 4.75（线性衰减）
A_4 = 5.125（几何衰减）

## PHP 中的示例

**请注意，`$n+1`(not `$n`) 是当前数据点的数量，因为 PHP 的数组是零索引的。为了匹配上面的示例集`n == $n+1`或`n-1 == $n`**

```
<?php

$s = [4,3,5,6];

// average
$a = [];
for ($n = 0; $n < count($s); ++$n)
{
    if ($n == 0)
        $a[$n] = $s[$n];
    else
    {
        // $n+1 = number of data points so far
        $weight = 1/($n+1);

        $a[$n] = $s[$n] * $weight + $a[$n-1] * (1 - $weight);
    }
}

var_dump($a);

// linear decay
$a = [];
for ($n = 0; $n < count($s); ++$n)
{
    if ($n == 0)
        $a[$n] = $s[$n];

    elseif ($n == 1)
        $a[$n] = ($s[$n] + $s[$n-1]) / 2;

    else
    {
        // $n = number of data points so far - 1
        $weight = 1/($n);

        $a[$n] = $s[$n] * $weight + $a[$n-1] * (1 - $weight);
    }
}

var_dump($a);

// geometric decay
$a = [];
for ($n = 0; $n < count($s); ++$n)
{
    if ($n == 0)
        $a[$n] = $s[$n];
    else
    {
        $weight = 1/2;

        $a[$n] = $s[$n] * $weight + $a[$n-1] * (1 - $weight);
    }
}

var_dump($a); 
```

输出

```
array (size=4)
  0 => int 4
  1 => float 3.5
  2 => float 4
  3 => float 4.5

array (size=4)
  0 => int 4
  1 => float 3.5
  2 => float 4.25
  3 => float 4.8333333333333

array (size=4)
  0 => int 4
  1 => float 3.5
  2 => float 4.25
  3 => float 5.125 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-28T16:37:00.333

显而易见的方法是介于两者之间，您需要下载速度的“移动平均值”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-28T16:36:28.247

我认为这只是一个平均算法。它在几秒钟内平均速率。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-28T16:35:29.263

您还可以做的是跟踪您的平均速度并显示计算结果。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-03-15T23:41:04.757

[对于任何感兴趣的人，我用 C# 编写了一个名为Progression](http://github.com/scottrippey/Progression)的开源库，它具有“移动平均”实现：[ETACalculator.cs](http://github.com/scottrippey/Progression/blob/master/Progression/Extras/ETACalculator.cs)。

[Progression](http://github.com/scottrippey/Progression)库定义了一个易于使用的结构，用于报告多种类型的进度。它还可以轻松处理嵌套进度，以实现非常流畅的进度报告。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-28T17:13:25.583

编辑：这是我最后的建议，我试过了，它提供了非常令人满意的结果：

对于 0 - 500 kB/s 之间的每个下载速度，我有一个零初始化数组（如果您期望这样的速度可能会更高），步长为 1 kB/s。我暂时对下载速度进行采样（每秒是一个很好的间隔），并将对应的数组项加一。现在我知道以每种速度下载文件花了多少秒。所有这些值的总和就是经过的时间（以秒为单位）。这些值的总和乘以相应的速度就是到目前为止下载的大小。如果我取数组中每个值与经过时间之间的比率，假设速度变化模式稳定，我可以形成一个公式来预测每个大小将花费的时间。在这种情况下，这个大小是剩余的大小。我就是做这个的：我将每个数组项值的总和乘以相应的速度（索引）并除以经过的时间。然后我将剩下的大小除以这个值，这就是剩下的时间。

需要几秒钟才能稳定下来，然后效果很好。

请注意，这是一个“复杂”的平均值，因此丢弃旧值（移动平均值）的方法可能会进一步改进它。

# iphone - 使用 Intel GMA 950 进行 iPhone 开发

> ID：798804
> 
> 赞同：0
> 
> 时间：2009-04-28T16:34:04.913
> 
> 标签：iphone

我正在考虑购买带有 Intel GMA 950 显卡的二手 MacBook，用于 iPhone 应用程序开发。

这张卡会不会有问题？

到目前为止，我只能找到这个线程： http: [//forum.unity3d.com/viewtopic.php?t=17454](http://forum.unity3d.com/viewtopic.php?t=17454)但我没有足够的经验来理解他们在说什么。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T16:44:03.047

从您发布的主题中。

> MacMini 将为您的 iPhone 开发提供很好的服务，唯一的例外是它无法***计算遮挡剔除信息***。AFAIK 这一事实在我们即将到来的任何更新/发布中都不会改变。

遮挡剔除是当一个对象位于其他不透明对象的后面时，它可能会被剔除。

来自维基百科：

> 这是一种非常流行的机制，可以加快具有中到高深度复杂度的大型场景的渲染速度

[更多关于遮挡剔除的细节。](http://www.cs.unc.edu/~zhangh/hom.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T16:51:43.763

您打算开发 3D iPhone 应用程序吗？如果没有，肯定没有问题。

如果是这样，我会把它留给有更多经验的人来回答。

# c# - 引用库中的 ASP.NET 相对路径

> ID：798814
> 
> 赞同：5
> 
> 时间：2009-04-28T16:36:10.913
> 
> 标签：c#, asp.net, path

我有一个 ASP.NET 网站，我在其中从 xml 文件加载一些验证规则。这个没有路径信息的 xml 文件名是硬编码在库中的。（我知道硬编码的名字不好，但我们就用它来做这个例子）。

当我运行网站时，ASP.NET 尝试在*源*路径中查找 xml 文件，其中名称是硬编码的 C# 文件。这对我来说完全令人难以置信，因为我无法理解如何在运行时甚至考虑将源路径作为解析不合格文件名的可能性。

```
// the config class, in C:\temp\Project.Core\Config.cs
public static string ValidationRulesFile {
   get { return m_validationRulesFile; }
} private static string m_validationRulesFile = "validation_rules.xml";

// using the file name
m_validationRules.LoadRulesFromXml( Config.ValidationRulesFile, "Call" ); 
```

这是显示我们正在查看的路径与 Config.cs 相同的异常：

```
 Exception Details: System.IO.FileNotFoundException: 
Could not find file 'C:\temp\Project.Core\validation_rules.xml'. 
```

谁能给我解释一下？我已经知道您应该如何处理 ASP.NET 中的一般路径，因此请不要回复解决方案。我真的很想明白这一点，因为它真的让我感到惊讶，而且它会一直困扰我。

## 更新

这是 LoadRulesFromXml 的相关代码

```
public void LoadRulesFromXml( string in_xmlFileName, string in_type ) 
{       
    XmlDocument xmlDoc = new XmlDocument();
    xmlDoc.Load( in_xmlFileName );
... 
```

## 更新2

看起来 Cassini 网络服务器获取了 VS 设置的当前目录，实际上它设置为我的库项目的路径。我不确定 VS 如何确定路径使用哪个项目，但这至少解释了正在发生的事情。谢谢乔。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-28T16:43:28.977

如果您不提供路径，则文件访问通常会使用当前工作目录作为默认目录。在 ASP.NET 中，这可能是您的 Web 应用程序目录。

依赖当前工作目录通常不是一个好主意，因此您可以使用 Path.Combine 指定不同的默认目录，例如相对于 AppDomain.CurrentDomain.BaseDirectory 的一个，它也是 ASP.NET 的 Web 应用程序目录应用程序。

您应该将路径显式添加到您正在打开的文件的名称中。您也可以尝试跟踪当前工作目录。

从 Visual Studio 运行 Cassini 时，当前目录继承自 Visual Studio 的工作目录：这似乎是您的情况。

IE：

```
public void LoadRulesFromXml( string in_xmlFileName, string in_type ) 
{   
    // To see what's going on
    Debug.WriteLine("Current directory is " +
              System.Environment.CurrentDirectory);    

    XmlDocument xmlDoc = new XmlDocument();    

    // Use an explicit path
    xmlDoc.Load( 
       System.IO.Path.Combine(AppDomain.CurrentDomain.BaseDirectory,
       in_xmlFileName) 
    );
... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T16:41:40.527

完全猜测，我会说该方法`LoadRulesFromXml()`正在查看托管站点的应用程序根 URL 的路径......这可能是 C:\temp\Project.Core\`Server.MapPath("~")`

您可以发布代码`LoadRulesFromXML`还是您有该代码？

# c# - C#：将全局字段的范围限制为方法/属性或在调用之间保留方法/属性的局部变量值

> ID：798827
> 
> 赞同：6
> 
> 时间：2009-04-28T16:40:06.990
> 
> 标签：c#, scope

我经常有定期调用的方法，并且在调用之间必须保留一些“状态”，例如：

```
float lastTime = 0.0f;
void Draw( float currentTime )
{
    if( currentTime - lastTime > 0.5f )
    {
        // not enough FPS
    }
    lastTime = currentTime;
} 
```

全局“状态”字段（此处为“lastTime”）在整个班级中都是可见的，而仅在这一种方法中才需要它，这让我发疯了。有没有办法将此全局字段的可见性范围限制为仅方法或使其成为本地，但在调用之间保持其值？同样的问题也适用于 Properties 使用的字段（它们有一些逻辑并且不能是自动的）。

提前感谢您的任何建议...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-28T16:43:04.110

使其仅在类的一部分中成为私有的唯一方法是使其成为管理此属性的单独对象，在类内部。

但是，我建议重新考虑一下。将其私有化以使成员对类本身保持私有的想法 - 如果您担心您的类看到自己的数据，那么是时候重构为更小的类了，每个类都有自己的功能。

这有一种类变得太大的“气味”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T16:42:19.247

在 C# 中，没有。这就是`static`VB.NET 中的变量（我相信 C，虽然我不是专家）。不过，我相当肯定，`static`VB.NET 中的变量只是编译为 IL，并使用自动生成的名称作为实例字段。

只需坚持适当命名的实例字段（例如`lastDrawTime`您的示例）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T16:42:18.247

不，谢谢。C# 不允许像 C 那样的函数级静态。我建议给它一个“恶心”的名字，比如 Draw_Data_lastTime 之类的。这至少传达了关于它应该在哪里使用的信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T16:42:55.797

不，最严格的范围是“私人”，它允许从相同类型的访问。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T16:47:52.197

恐怕你的要求是不可能的。

我认为您唯一的其他选择是将当前状态作为方法中的参数传递，但这意味着调用对象将负责管理状态。

我还认为你可以*重构*你的代码，因为如果你的班级的其他人不需要知道这个变量，那么这部分可能在其他地方。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-28T16:56:49.273

不，没有办法；但你的问题提出了一些有趣的问题。如果您担心用于跟踪的成员变量在整个类中都是可见的，这会引发标志，表明类的范围可能已经变得太大，并且需要将类重构为几个较小的类。

一般来说，如果您开始担心类中成员的隔离，您可能会遇到需要重构为更小的类的情况。再说一次，你可能不会（情况会有所不同），但至少，它可能值得考虑。

# rdlc - 网站数据源为空

> ID：798838
> 
> 赞同：1
> 
> 时间：2009-04-28T16:42:22.273
> 
> 标签：rdlc, dataset

这让我发疯。我正在尝试使用报告查看器显示基本报告，但无论我做什么，都无法让数据集显示在网站数据源窗口中。

我创建了一个数据集..选择了我想要的过程等，没有任何问题。我添加了我的 RDLC 并尝试添加一个可以将数据绑定到的表，但包含数据源的 Windows 是空的。

我正在使用 VS 2008。我做错了什么吗？我已经遵循了一些教程，但由于这个问题而无法进一步。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T21:52:39.677

好的..在浪费了 1 天后想通了。

正如我所说，我正在运行 VS 2008，我所做的是一一删除所有 DLL 引用，直到窗口填充一些数据源。我发现对实体空间的引用会导致问题。所以我创建了报告，当我失望时添加回参考。很痛苦，但现在可以了。

天哪。

# javascript - 我应该选择什么？jQuery、mootools、yui、scriptaculous 还是原型？

> ID：798840
> 
> 赞同：14
> 
> 时间：2009-04-28T16:42:25.690
> 
> 标签：javascript, jquery, ajax, frameworks

**重复：** [哪个 Javascript 框架（jQuery vs Dojo vs ...）？](https://stackoverflow.com/questions/394601/which-javascript-framework-jquery-vs-dojo-vs)

我对 JavaScript 完全陌生，但我想在我的网站中实现 Ajax 功能。我应该学习哪个JS框架？请推荐或您正在使用哪一个以及为什么使用它？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-28T16:43:38.727

jQuery 目前非常流行，因此与其他框架之一相反，您可能会最幸运地找到它最近的教程/插件/等。从新手的角度来看，这可能是一个相当不错的卖点。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-28T16:44:28.070

微软显然祝福了 jQuery，所以现在这是你最好的选择。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-28T17:29:04.593

我目前正在写一篇关于 JavaScript 框架的论文。在我到目前为止所做的所有研究之后，我可以告诉你......

说真的，没有人能告诉你哪个框架最适合你。只有一种方法可以找出答案：尝试使用您正在考虑的所有不同库。这是个人喜好的问题。

请参阅这个出色的[JavaScript 库概述](http://slideshare.net/jeresig/javascript-library-overview-presentation "幻灯片")，John Resig（他恰好是 jQuery 的首席开发人员）的演示文稿。它包含所有列出的框架的小代码示例。在查看了这些之后，您可能会知道选择哪个框架，具体取决于您喜欢哪种编码风格。

此外，[这个 SO 主题](https://stackoverflow.com/questions/176324/why-does-everyone-like-jquery-more-than-prototype-script-aclo-us-or-mootools-or-w)可能很有趣。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-28T16:46:31.903

Jquery 可能是最好的，它实际上可以让你“做更多，写更少”

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-28T16:49:48.510

另一个用于 Jquery ..真棒插件！

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-28T16:44:09.880

我现在使用 jQuery，因为它很简单并且有很多特性。在我使用原型和脚本之前。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-04-28T17:19:32.027

在 VS2008 中为 jQuery 内置智能感知（我认为是 sp1？）是我们的一个考虑因素，但基本上我们已经使用了 mootools、prototype、scriptaculous 和 jquery，并且发现 jquery 是我们所有人最容易理解/支持的。

我们这里有一个混合团队，甚至我们的业务逻辑人员也可以在 jquery 中获取逻辑/方法。

我们还使用 Telerik 控件，他们现在宣布对 jquery 提供更多支持 - 看来它的明星肯定在升华。

尝试所有这些，但如果您来自.net 背景，我认为这是目前合乎逻辑的选择。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-28T18:58:30.167

我自己和 jQuery 一起玩得很开心。那里有很多很好的文档和教程，如果您是 Javascript 新手，这非常好。

如果它只有 ajax 功能，我建议您查看[http://docs.jquery.com/Ajax](http://docs.jquery.com/Ajax)。Themeforest 的教程也非常棒。例如，绝对初学者[第 10 天](http://blog.themeforest.net/tutorials/jquery-for-absolute-beginners-day-10/)的 jquery 教程向您展示了 jQuery + Ajax 的基础知识。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-28T16:57:08.743

我注意到 Dojo 不在您的列表中。这是一个适用于重量级 AJAX 化页面的框架。

[http://dojotoolkit.org/](http://dojotoolkit.org/)

也就是说，JQuery 目前似乎势头最猛，其他框架（如 Dojo）正在努力将更多类似 JQuery 的功能添加到他们的产品中，所以我建议学习一下。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-03-18T09:50:27.087

要考虑的最好的事情是您想要框架的用途。jQuery 旨在使操作 DOM 更容易。因此，如果这是您想做的事情的主要焦点，那就太好了。这是一个超级 rad 框架，它真的非常自然且易于上手。

话虽如此，值得考虑其他人必须提供什么。原型和 mootools 等其他框架最感兴趣的是将 javascript 转变为更强大的编程语言，具有更丰富的面向对象编程能力以及数组、字符串和数字的功能。我不太了解能够比较/对比原型和 mootools，但也许其他人可以填补这一点。

这是一篇很棒的文章，解释了 mootools 和 jquery 之间的区别 - jqueryvsmootools.com/

好消息是你不一定要决定。尽管您可能偶尔会遇到错误，但您应该能够将 jQuery 与 mootools 或原型一起使用（参见[此处](http://docs.jquery.com/Using_jQuery_with_Other_Libraries)）。基本上只需调用 jQuery.noConflict(); 在您想要使用 jQuery 的任何脚本之前，一切都应该正常工作。这使您可以使用 jQuery 进行所有的 DOM 操作和 rad UI 库，同时还可以在您需要时访问更强大的框架。

如果我在这里遗漏了什么，请告诉我，我希望这会有所帮助。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-28T16:52:11.343

[叉阿贾克斯](http://forkjavascript.org/ajax/docs)。它很好地完成了这项工作，而且非常小（最小化 5KB）且简单。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-28T17:45:29.640

我将插入 Mootools。当然，任何人都喜欢其中任何一种的原因当然是“我首先开始使用 XYZ”。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-04-28T18:55:57.973

jQuery 是我首选的框架，但你真的必须看看每个框架的优势，看看它们如何与你的项目保持一致

重要的是，**使用一个框架**——实际上是任何框架。使用框架的好处，无论是哪一个，都是如此巨大的。最好的解决方案可以消除您一定会遇到的所有或大部分跨浏览器头痛。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-01-02T00:06:28.460

当我刚接触 JavaScript 时，一周后我发现有了框架，生活变得轻松多了。无论如何，我什至不知道它们到底是干什么用的；我有一些关于*$()的胶水，它是**window.getElementById()*的智能替代品，并且我认为还有一些其他舒适的方法用于其他目的，比如 AJAX 请求。

我不想花很多时间在学习一个框架上，所以我决定选择我**一见钟情**的。然后我花了大约一个月的时间在谷歌上搜索。我没有错过任何一个“大牌”，但我很快就放弃了它们。不满意的主要原因是他们的网站，文档：读了一整页的文字后，我还是和以前一样笨。它是干什么用的？他们做什么？什么是输入，什么是目标，什么是输出？

然后，我找到了[DOMAssistant](http://www.domassistant.com/)。它小巧、完美且有据可查。看开头页的第一段，对JS框架的定义非常清晰：

> 什么是 DOMAssistant？
> 
> DOMAssistant 的想法是提供一种更简单、更一致的方式来针对 Web 浏览器中的文档对象模型 (DOM) 编写脚本。这个想法是一切都从有问题的元素开始，通过 id 或 CSS 选择器选择，然后对其执行各种方法，例如添加或删除类、事件等。

所以，我说，如果你最终选择了另一个更时尚的框架，DOMAssistant 是必看的。如果您不需要动画飞窗，它也是一个不错的选择。

# http - 更好的文件上传方法：HTTP post multipart 还是 HTTP put？

> ID：798844
> 
> 赞同：2
> 
> 时间：2009-04-28T16:43:17.027
> 
> 标签：http

**用例**：上传一个简单的图像文件到服务器，客户端可以稍后检索

1.  为工作指定一个`FTP Server`。

2.  `HTTP Put`：它可以直接将文件上传到服务器，而不需要服务器端
    组件来处理字节流。

3.  `HTTP Post`：由服务器端组件处理字节流。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-02T22:04:20.990

由于潜在的安全问题，我认为在公共网站上安全地使用 PUT 比使用 POST 需要更多的努力（并且不太常见）。请参阅[http://bitworking.org/news/PUT_SaferOrDangerous](http://bitworking.org/news/PUT_SaferOrDangerous)。

OTOH，我认为有很多资源可以安全地使用 POST 上传文件并在服务器端脚本中检查它们，这是更常见的做法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T16:46:44.117

`PUT`仅当您知道要输入的 URL 时才适用。

你也可以这样做：

4)`POST`获取一个 URL，然后您`PUT`将文件指向该 URL。

**编辑**：您将如何让 HTTP 服务器决定是否可以接受特定的 PUT 请求？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T16:50:03.033

我通常（通过 PHP）做的是 HTTP POST。

并使用 PHP[`move_uploaded_file()`](http://is.php.net/manual/en/function.move-uploaded-file.php)将它带到我想要的任何目的地。

# python - 列表列表的所有组合

> ID：798854
> 
> 赞同：330
> 
> 时间：2009-04-28T16:44:47.697
> 
> 标签：python, combinations

我基本上是在寻找一个 python 版本的[组合`List<List<int>>`](https://stackoverflow.com/questions/545703/combination-of-listlistint)

给定一个列表列表，我需要一个新列表，它给出列表之间所有可能的项目组合。

```
[[1,2,3],[4,5,6],[7,8,9,10]] -> [[1,4,7],[1,4,8],...,[3,6,10]] 
```

列表的数量是未知的，所以我需要适用于所有情况的东西。优雅加分！

* * *

## 回答 #1

> 赞同：562
> 
> 时间：2009-04-28T16:54:56.923

你需要[`itertools.product`](https://docs.python.org/2/library/itertools.html#itertools.product)：

```
>>> import itertools
>>> a = [[1,2,3],[4,5,6],[7,8,9,10]]
>>> list(itertools.product(*a))
[(1, 4, 7), (1, 4, 8), (1, 4, 9), (1, 4, 10), (1, 5, 7), (1, 5, 8), (1, 5, 9), (1, 5, 10), (1, 6, 7), (1, 6, 8), (1, 6, 9), (1, 6, 10), (2, 4, 7), (2, 4, 8), (2, 4, 9), (2, 4, 10), (2, 5, 7), (2, 5, 8), (2, 5, 9), (2, 5, 10), (2, 6, 7), (2, 6, 8), (2, 6, 9), (2, 6, 10), (3, 4, 7), (3, 4, 8), (3, 4, 9), (3, 4, 10), (3, 5, 7), (3, 5, 8), (3, 5, 9), (3, 5, 10), (3, 6, 7), (3, 6, 8), (3, 6, 9), (3, 6, 10)] 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-04-28T16:55:04.690

最优雅的解决方案是在 python 2.6中使用[itertools.product 。](https://docs.python.org/2/library/itertools.html#itertools.product)

如果您不使用 Python 2.6，则文档`itertools.product`实际上显示了一个等效的功能来以“手动”方式完成产品：

```
def product(*args, **kwds):
    # product('ABCD', 'xy') --> Ax Ay Bx By Cx Cy Dx Dy
    # product(range(2), repeat=3) --> 000 001 010 011 100 101 110 111
    pools = map(tuple, args) * kwds.get('repeat', 1)
    result = [[]]
    for pool in pools:
        result = [x+[y] for x in result for y in pool]
    for prod in result:
        yield tuple(prod) 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-04-28T16:58:13.793

```
listOLists = [[1,2,3],[4,5,6],[7,8,9,10]]
for list in itertools.product(*listOLists):
  print list; 
```

我希望你发现它和我第一次遇到它时一样优雅。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2017-01-31T02:32:40.257

此任务的直接递归没有错，如果您需要一个可以处理字符串的版本，这可能符合您的需求：

```
combinations = []

def combine(terms, accum):
    last = (len(terms) == 1)
    n = len(terms[0])
    for i in range(n):
        item = accum + terms[0][i]
        if last:
            combinations.append(item)
        else:
            combine(terms[1:], item)

>>> a = [['ab','cd','ef'],['12','34','56']]
>>> combine(a, '')
>>> print(combinations)
['ab12', 'ab34', 'ab56', 'cd12', 'cd34', 'cd56', 'ef12', 'ef34', 'ef56'] 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-01-07T23:36:43.463

Numpy 可以做到：

```
 >>> import numpy
 >>> a = [[1,2,3],[4,5,6],[7,8,9,10]]
 >>> [list(x) for x in numpy.array(numpy.meshgrid(*a)).T.reshape(-1,len(a))]
[[ 1, 4, 7], [1, 5, 7], [1, 6, 7], ....] 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-01-11T16:19:48.040

为此，可以使用基础 python。该代码需要一个函数来展平列表列表：

```
def flatten(B):    # function needed for code below;
    A = []
    for i in B:
        if type(i) == list: A.extend(i)
        else: A.append(i)
    return A 
```

然后可以运行：

```
L = [[1,2,3],[4,5,6],[7,8,9,10]]

outlist =[]; templist =[[]]
for sublist in L:
    outlist = templist; templist = [[]]
    for sitem in sublist:
        for oitem in outlist:
            newitem = [oitem]
            if newitem == [[]]: newitem = [sitem]
            else: newitem = [newitem[0], sitem]
            templist.append(flatten(newitem))

outlist = list(filter(lambda x: len(x)==len(L), templist))  # remove some partial lists that also creep in;
print(outlist) 
```

输出：

```
[[1, 4, 7], [2, 4, 7], [3, 4, 7], 
[1, 5, 7], [2, 5, 7], [3, 5, 7], 
[1, 6, 7], [2, 6, 7], [3, 6, 7], 
[1, 4, 8], [2, 4, 8], [3, 4, 8], 
[1, 5, 8], [2, 5, 8], [3, 5, 8], 
[1, 6, 8], [2, 6, 8], [3, 6, 8], 
[1, 4, 9], [2, 4, 9], [3, 4, 9], 
[1, 5, 9], [2, 5, 9], [3, 5, 9], 
[1, 6, 9], [2, 6, 9], [3, 6, 9], 
[1, 4, 10], [2, 4, 10], [3, 4, 10], 
[1, 5, 10], [2, 5, 10], [3, 5, 10], 
[1, 6, 10], [2, 6, 10], [3, 6, 10]] 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-06-10T01:31:07.840

这主要模仿[Jarret Hardie](https://stackoverflow.com/a/798893/1357094)使用[itertools.product](https://docs.python.org/3/library/itertools.html#itertools.product)的 Answer 等解决方案，但有以下区别：

*   这将参数传递给`itertools.product`内联，而不是通过变量`a`- 所以`*args`内联参数不需要语法
*   如果你的[mypy type-linter](https://mypy.readthedocs.io/en/stable/introduction.html)像我的一样，并且你可以让你的代码以其他方式“使用”`*args`带有内联`product`参数的语法（比如`product(*[[1,2,3],[4,5,6],[7,8,9,10]])`），`mypy`可能仍然会失败（比如`error: No overload variant of "product" matches argument type "List[object]"`）
*   因此，解决方案`mypy`是不使用`*args`语法，如下所示：

```
 >>> import itertools
    >>> list(itertools.product([1,2,3],[4,5,6],[7,8,9,10]))
    [(1, 4, 7), (1, 4, 8), (1, 4, 9), (1, 4, 10), (1, 5, 7), (1, 5, 8), (1, 5, 9), (1, 5, 10), (1, 6, 7), (1, 6, 8), (1, 6, 9), (1, 6, 10), (2, 4, 7), (2, 4, 8), (2, 4, 9), (2, 4, 10), (2, 5, 7), (2, 5, 8), (2, 5, 9), (2, 5, 10), (2, 6, 7), (2, 6, 8), (2, 6, 9), (2, 6, 10), (3, 4, 7), (3, 4, 8), (3, 4, 9), (3, 4, 10), (3, 5, 7), (3, 5, 8), (3, 5, 9), (3, 5, 10), (3, 6, 7), (3, 6, 8), (3, 6, 9), (3, 6, 10)] 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-07-02T10:36:04.030

这个答案不像使用 itertools 那样干净，但这些想法可能很有用。

[从这里](https://docs.python.org/3/library/functions.html#zip)zip() 的构造中汲取灵感，我们可以做以下事情。

```
>>> a = iter([[1,2,3],[4,5,6],[7,8,9,10]])
>>> sentinel = object()
>>> result = [[]]
>>> while True:
>>>     l = next(a,sentinel)
>>>     if l == sentinel:
>>>         break
>>>     result = [ r + [digit] for r in result for digit in l]
>>> print(result)
[[1, 4, 7], [1, 4, 8], [1, 4, 9], [1, 4, 10], [1, 5, 7], [1, 5, 8], [1, 5, 9], [1, 5, 10], [1, 6, 7], [1, 6, 8], [1, 6, 9], [1, 6, 10], [2, 4, 7], [2, 4, 8], [2, 4, 9], [2, 4, 10], [2, 5, 7], [2, 5, 8], [2, 5, 9], [2, 5, 10], [2, 6, 7], [2, 6, 8], [2, 6, 9], [2, 6, 10], [3, 4, 7], [3, 4, 8], [3, 4, 9], [3, 4, 10], [3, 5, 7], [3, 5, 8], [3, 5, 9], [3, 5, 10], [3, 6, 7], [3, 6, 8], [3, 6, 9], [3, 6, 10]] 
```

我们将`a`其用作迭代器，以便连续获取它的下一项，而无需先验知道有多少。当我们用完 in 中的列表时，该`next`命令将输出`sentinel`（这是一个仅为进行比较而创建的对象，请参阅[此处](https://python-patterns.guide/python/sentinel-object/)`a`以获得一些解释） ，导致`if`语句触发，因此我们跳出循环。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-07-17T07:08:07.803

```
from itertools import product 
list_vals = [['Brand Acronym:CBIQ', 'Brand Acronym :KMEFIC'],['Brand Country:DXB','Brand Country:BH']]
list(product(*list_vals)) 
```

输出：

> [（'品牌缩写：CBIQ'，'品牌国家：DXB'），
> （'品牌缩写：CBIQ'，'品牌国家：BH'），
> （'品牌缩写：KMEFIC'，'品牌国家：DXB'），
> （ '品牌缩写：KMEFIC'，'品牌国家：BH')]

# variables - 表示变量所有可能值的术语

> ID：798858
> 
> 赞同：8
> 
> 时间：2009-04-28T16:45:37.117
> 
> 标签：variables, terminology

是否有一个术语来表示变量可以假设的所有可能值的集合？

**类比：**
在数学中，函数的域是定义函数的一组值（函数可以作为参数）。

**例子：**

*   UInt16 类型的变量可以保存 [0-65536) 范围内的值。
*   完成状态（由双精度值表示）可以保存 [0-100] 范围内的值。
*   性别（由枚举表示）可以包含 { Male, Female } 之一。

**问：**
描述变量可以（根据上下文）假设的所有可能值的术语是什么？

基本上需要一个简短版本的“变量值集”。我已经看到使用术语**类型**来描述这样的范围，但类型通常包含其他信息位（例如名称、操作、模块）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-28T16:48:12.367

*   值集
*   领域
*   取值范围

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-28T16:55:31.740

我也听说过“价值空间”这个术语。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-28T16:48:13.007

我将其称为“范围”或“值范围”。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-28T16:49:08.027

域将是数学术语。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-28T16:47:44.973

我不知道具有这种含义的特定于编程的术语，但“域”本身似乎是一个很好的术语......

[编辑] 阅读对此的评论，我实际上更喜欢“范围”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-28T16:48:17.093

我不知道这是否是确切的术语（如果它甚至有一个），但我一直将其称为**range**或在 enums **options**的情况下。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-28T16:50:32.173

范围是正确的术语，如“此方法将返回...范围内的值”；“此变量的预期范围是：...”等。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-28T16:53:12.947

对于原子类型，类型本身描述了范围（例如 int 的范围为 -2,147,483,648 到 2,147,483,647）。

任何自定义类型都可能有范围，也可能没有范围，因为自定义类型（例如结构、类、接口）是可以由原子或其他自定义类型组成的复合类型。

不同语言之间的类型定义也会有所不同。

总而言之，您通常只能将范围应用于基于特定语言的原子类型。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-28T16:54:17.907

这取决于类型系统。在某些编程语言中，“字符串”可以保存一系列字符，“无符号整数”只能保存正整数。在 Python 等其他语言中，变量可以保存任何内容，因为它没有特定类型。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-28T17:00:06.940

我们这里的量化人员说它被称为价值集。他们得到了很多钱来创造它们，所以我相信他们！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-28T17:01:10.900

您可能会认为变量包含一个元素，该元素是一组数字的成员。

因此，[域](http://en.wikipedia.org/wiki/Set_domain)是这个集合的可能值的一个很好的描述符。

[Range](http://en.wikipedia.org/wiki/Range_of_a_function)也经常用于类似的上下文中。在这里，我们讨论函数的范围，作为函数可以采用的值的集合。由于变量总是包含一些表达式或计算的结果，范围显然也是有意义的。

在适当的上下文中，两者都是合适的。

# java - 无法通过 JNI 加载 JVM 时如何收到错误消息？

> ID：798876
> 
> 赞同：3
> 
> 时间：2009-04-28T16:50:08.570
> 
> 标签：java, c++, jvm, java-native-interface, jvm-arguments

我想检索一条错误消息，解释为什么 jvm 无法加载。从此处提供的示例中：

[http://java.sun.com/docs/books/jni/html/invoke.html](http://java.sun.com/docs/books/jni/html/invoke.html)

我提取了这个例子：

```
 /* Create the Java VM */
 res = JNI_CreateJavaVM(&jvm, (void**)&env, &vm_args);

 if (res < 0) {
     // retrieve verbose error here?
     fprintf(stderr, "Can't create Java VM\n");
     exit(1);
 } 
```

在我的具体情况下，我在 vm_args 中提供了无效的参数，并希望看到我在命令行上得到什么：“无法识别的选项：-foo=bar”

在进一步测试中，jvm 似乎正在将我想要的消息放入 stdout 或 stderr。我相信我需要捕获 stdout 和 stderr 才能得到我正在寻找的错误（当然，除非有更简单的方法）。我正在用 C++ 编码，所以如果有人可以展示一种将错误捕获到字符串流中的方法，那将是理想的。

谢谢，兰迪

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T19:51:10.780

通过使用此处描述的“vfprintf”选项，我能够获得所需的内容：

[https://web.archive.org/web/20111229234347/http://java.sun.com/products/jdk/faq/jnifaq-old.html](https://web.archive.org/web/20111229234347/http://java.sun.com/products/jdk/faq/jnifaq-old.html)

虽然我使用了 jdk1.2 选项。此代码片段总结了我的解决方案：

```
static string jniErrors;

static jint JNICALL my_vfprintf(FILE *fp, const char *format, va_list args)
{
    char buf[1024];
    vsnprintf(buf, sizeof(buf), format, args);
    jniErrors += buf;
    return 0;
}

...

JavaVMOption options[1];
options[0].optionString = "vfprintf";
options[0].extraInfo = my_vfprintf;

JavaVMInitArgs vm_args;
memset(&vm_args, 0, sizeof(vm_args));
vm_args.nOptions = 1;
vm_args.options = options;
vm_args.version = JNI_VERSION_1_4;
vm_args.ignoreUnrecognized = JNI_FALSE;

JNIEnv env;
JavaVM jvm;

jint res = JNI_CreateJavaVM(&jvm, (void**)&env, &vm_args);

if (res != JNI_OK)
    setError(jniErrors);

jniErrors.clear(); 
```

同样有趣的是，我一生都无法使用任何 freopen 或 dup2 技巧正确捕获 stdout 或 stderr。我可以加载*自己的*dll 并正确重定向，但不能加载 jvm。无论如何，这种方式更好，因为我想要内存中的错误而不是文件中的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T23:41:13.920

当我编写这段代码时，我也会通过 stdout/stderr 得到错误。

在您的流程中重定向 stdout/stderr 的最佳方法是使用[freopen](http://www.opengroup.org/onlinepubs/000095399/functions/freopen.html)。这是一个专门针对该主题的[StackOverflow 问题。](https://stackoverflow.com/questions/584868/rerouting-stdin-and-stdout-from-c)

但是，一旦该调用通过，您将获得一个`JNIEnv`，并且所有进一步的错误检查都可以并且应该通过调用来完成`JNIEnv::ExceptionOccurred()`，这可能会返回一个`Throwable`对象，然后您可以使用您的 JNI 代码查询该对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T23:55:19.737

在掌握了无论如何都需要的 stdout 和 stderr 之后，将 -Xcheck:jni 添加到 jvm 命令行以从 jvm 获取额外的与 jni 相关的警告。

# visual-studio-2008 - 大括号突出显示 Visual Studio 2008

> ID：798878
> 
> 赞同：2
> 
> 时间：2009-04-28T16:50:36.277
> 
> 标签：visual-studio-2008

大括号突出显示与 VS 2008 中的默认配色方案一起使用。我下载了并且我目前正在使用 VibrantInk 主题并且大括号没有突出显示。我已经浏览了选项，甚至更改了那些说大括号突出显示的选项。关于发生了什么的任何想法？

此外，当我输入字符串并输入最后一个引号时，文本变为完全黑色（黑色背景），直到我空格或执行一些其他操作，然后它变为绿色。这有点烦人。关于这里发生了什么的任何线索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T17:06:01.903

我使用 Vibrant Ink 衍生物和大括号匹配为我工作。在字体和颜色选项中，我将“大括号匹配（矩形）：项目背景”设置为我想要突出显示大括号的颜色。

要解决第二个问题，请转到工具 | 选项 | 字体和颜色，然后点击保存。至少，这为我解决了问题。然而，不得不这样做非常烦人，而且这个错误似乎又随机出现了。（编辑：我刚刚意识到许多颜色都设置为“自动”。我现在已经明确地将它们设置为一种颜色，希望这能解决消失的文本问题。）

我遇到了一些问题，无论我设置了多少次，某些设置都没有保存（特别是在我打开的 HTML 属性中自动插入引号，但从不坚持）。这也发生在多台机器上。我认为 VS2008 只是存在一些用于保留某些设置的错误。不过，尚未对此进行检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T16:56:50.473

检查工具 | 选项 | 文本编辑器 | 一般 | 自动定界符突出显示设置以确保它处于打开状态。

# ruby-on-rails - Rails：如何测试 lib/ 目录中的代码？

> ID：798881
> 
> 赞同：52
> 
> 时间：2009-04-28T16:51:54.387
> 
> 标签：ruby-on-rails, unit-testing

我有一个从解析器对象获取数据的模型。我在想解析器类应该存在于 lib/ 目录中（尽管我可能会相信它应该存在于其他地方）。问题是：解析器类的单元测试应该在哪里？以及如何确保每次运行 rake 测试时都运行它们？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-29T01:00:45.553

在我正在处理的 Rails 应用程序中，我决定将测试放在`test\unit`目录中。我还将按模块/目录嵌套它们，例如：

```
lib/a.rb   => test/unit/a_test.rb
lib/b/c.rb => test/unit/b/c_test.rb 
```

对我来说，这是最后的阻力路径，因为这些测试无需进行任何其他更改即可运行。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-10-19T12:45:04.627

这是一种方法：

`lib/tasks/test_lib_dir.rake`使用以下内容创建

```
namespace :test do

  desc "Test lib source"
  Rake::TestTask.new(:lib) do |t|    
    t.libs << "test"
    t.pattern = 'test/lib/**/*_test.rb'
    t.verbose = true    
  end

end 
```

`lib`在dir 下模仿你的 dir 的结构`test`，用相应的测试替换 lib 代码。

运行`rake test:lib`以运行您的 lib 测试。

如果您希望在调用时运行所有测试`rake test`，可以将以下内容添加到新的 rake 文件中。

```
lib_task = Rake::Task["test:lib"]
test_task = Rake::Task[:test]
test_task.enhance { lib_task.invoke } 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-06-30T21:02:33.677

我希望做同样的事情，但使用 rspec 和 autospec 并且需要一点点挖掘才能弄清楚他们从哪里获取指示要运行哪些测试文件的目录/文件模式列表。最终我在 lib/tasks/rspec.rake:86 找到了这个

```
 [:models, :controllers, :views, :helpers, :lib, :integration].each do |sub|
    desc "Run the code examples in spec/#{sub}"
    Spec::Rake::SpecTask.new(sub => spec_prereq) do |t|
      t.spec_opts = ['--options', "\"#{RAILS_ROOT}/spec/spec.opts\""]
      t.spec_files = FileList["spec/#{sub}/**/*_spec.rb"]
    end
  end 
```

当 rpsec.rake 文件配置为在 spec/lib 中查找时，我已将测试放在新的 spec/libs 目录中。只需重命名 libs -> lib 就可以了！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-02-10T10:32:30.267

An easy and clean way is just to create a directory under test/unit/lib. Then create test as test/unit/lib/foo_test.rb corresponding to lib/foo.rb. No new rake tasks required, and you can nest more directories if needed to match the lib directory structure.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-12-20T18:20:51.110

As of [Rails 4.0](https://github.com/rails/rails/blob/4-0-stable/railties/lib/rails/test_unit/testing.rake#L73):

```
rake test:all         # Run all tests in any subdir of `test` without resetting the DB
rake test:all:db      # Same as above and resets the DB 
```

As of [Rails 4.1](https://github.com/rails/rails/blob/4-1-stable/railties/lib/rails/test_unit/testing.rake#L16), redefine `test:run` to include additional tasks when running `rake` or `rake test`:

```
# lib/tasks/test.rake

namespace :test do
  Rake::Task["run"].clear
  task run: ["test:units", "test:functionals", "test:generators", "test:integration", "test:tasks"]

  ["tasks"].each do |name|
    Rails::TestTask.new(name => "test:prepare") do |t|
      t.pattern = "test/#{name}/**/*_test.rb"
    end
  end
end 
```

This has the added bonus of defining `rake test:tasks` in the given example.

As of [Rails 4.2](https://github.com/rails/rails/blob/4-2-stable/railties/lib/rails/test_unit/testing.rake#L17), `test:run` includes all subdirs of `test` including them when running `rake test`, and thus `rake`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-30T19:16:47.177

To not define additional rake tasks to run tests from the custom defined folders you may also run them with the command `rake test:all`. Tests folders structure for the `lib` folder or any other custom folder is up to you. But I prefer to duplicate them in classes: `lib` is matched to `test/lib`, `app/form_objects` to `test/form_objects`.

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2014-10-03T13:59:42.657

Use:

```
[spring] rake test:all 
```

to run all tests, including the directories you created (like `[root]/test/lib/`).

Omit `[spring]` if tou aren't using it.

# c# - C# 创建多语言设置

> ID：798886
> 
> 赞同：7
> 
> 时间：2009-04-28T16:53:25.803
> 
> 标签：c#, installation, multilingual

我使用下面的短文添加了多语言。

例如，当您添加德语时，您将拥有以下文件： formMain.resx formMain.de-DE.resx formMain.Designer.cs formMain.cs

在第一个文件中，您将拥有中性语言的资源，如字符串、图像、..

因此，现在您还需要为代码中使用的字符串添加资源。添加一个新的资源文件并将其命名为 formMain.Strings.resx 然后我将为每个应该翻译的字符串输入名称、值对。当您添加资源文件时，它会自动输入，因为在每次关闭 resx 设计器时都会自动重新生成另一个名为 formMain.Strings.Designer.cs 的文件。

添加另一个名为 formMain.Strings.de-DE.resx 的资源。从以前的资源中添加相同的名称键，然后用对应的德语单词更改值。现在要从源访问创建的资源，它将是这样的。

MessageBox.Show(formMain_Strings.SameStringName);

但是，我已将我的语言更改为泰语。当我在 VS 中运行我的应用程序时，一切正常。

但是，一旦我添加了一个安装项目并安装在客户端机器上，它就不会将语言更改为泰语，而只会保留默认语言。

因此，我已将资源文件和 th-TH dll 添加到项目设置中。我仍然遇到同样的问题。

```
Packaging file 'Lang.Strings.resx'...
Packaging file 'MultiLanguage.resources.dll'...
Packaging file 'MultiLanguage.exe'...
Packaging file 'Lang.Strings.th-TH.resx'... 
```

因为在 Visual Studio 中运行时一切正常。安装后我需要做些什么才能让它运行。我拥有的每个文件的所有属性都保留默认值。

非常感谢，

=========

```
static void Main()
    {
        System.Threading.Thread.CurrentThread.CurrentUICulture = 
new System.Globalization.CultureInfo("th-TH");

        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new Form1());
    } 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-29T00:44:02.160

我找到了答案

单击解决方案资源管理器中的设置项目，然后单击添加\项目输出\。从对话框中选择要包含本地化（卫星）程序集的项目，然后选择本地化资源。

在我安装到的文件夹中安装后，我有包含卫星程序集的 th-TH 文件夹。

谢谢，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T16:59:22.747

尝试在应用程序启动时添加它（如果它不存在）：

```
Thread.CurrentThread.CurrentUICulture = CultureInfo.CurrentCulture; 
```

这是一篇[简短的文章](http://www.sisulizer.com/online-help/RuntimeLanguageChangeNet.htm)，讨论了如何使其工作的一些选项，以及在运行时选择语言环境的选项。

* * *

评论后编辑：

确保您的卫星组件位于适当的位置，并正确构建。从我引用的那篇文章中：

“当 .NET 运行时启动应用程序时，它会查找可能的附属程序集文件。附属程序集文件是仅具有 .resources.dll 扩展名而不是 .exe ir .dll 的资源程序集文件（如果主程序集是库） . 卫星程序集文件始终位于应用程序主目录的特定语言子目录中。如果应用程序文件是 Converter.exe，那么日语卫星程序集文件是 ja\Converter.resources.dll。"

您应该在这里检查几件事。检查程序集的名称。另外，请确保它位于正确的位置。在您的情况下，它应该位于可执行文件下具有适当名称的 th-TH 子目录中。如果它在那里，它应该被找到并正确使用。

这是有关此主题的[另一个很好的信息来源。](http://www.codeguru.com/csharp/.net/net_general/tipstricks/article.php/c11367/)

# c# - 存储过程结构

> ID：798887
> 
> 赞同：2
> 
> 时间：2009-04-28T16:53:27.033
> 
> 标签：c#, sql-server, sql-server-2008, tsql, stored-procedures

我继承了一个包含大量（160 多个）存储过程的遗留系统。我正在寻找一种创建图表的方法

*   显示哪些过程被其他过程调用
*   显示 C# 代码的哪一部分使用了哪些存储过程
*   按使用程序的系统部分对程序进行分组

有没有一个工具可以做到这一点？或者会帮助我执行任务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T16:58:15.073

Red Gate 的[SQL Dependency Tracker](http://www.red-gate.com/products/SQL_Dependency_Tracker/index.htm)可以处理您的第一个项目。

至于您的第二项，您唯一真正的选择是在文件中查找（默认为 control-shift-F）并在您的解决方案中搜索该存储过程名称。不过，您必须自己分析该字符串的实际使用位置。

第三，据我所知，没有任何工具可以产生如此广泛的概述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T16:58:08.303

DBScribe 和 DOxygen 可能会对您有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T17:07:09.327

我会在您的程序中添加一些基本的日志记录，并按业务流程创建程序使用日志。

因此，如果您的应用管理水果销售 POS。

购买和橙色。保存日志

买个苹果。保存日志。

ETC...

通过这种方式，您不仅可以了解使用了哪些内容，还可以了解何时使用什么。

# javascript - 为什么 Firebug 使网站变慢以及如何解决？

> ID：798888
> 
> 赞同：15
> 
> 时间：2009-04-28T16:53:33.370
> 
> 标签：javascript, firebug

我正在尝试调试我的网络应用程序，但我意识到萤火虫让它变得非常慢。这有什么原因吗？是否有任何原因，例如可能导致此问题的长 js 文件？

非常感谢你。

**更新**我正在开发一个主要由开发人员使用的网络应用程序。现在，如果我不知道究竟是什么让 firebug 使我的网站变慢，我将不得不显示那些丑陋的 Gmail 样式警告之一。:(

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-28T16:58:22.280

Firebug 在 ram 上非常激烈。某些应用程序（如 gmail）检测到 firebug 已打开，并警告用户他们的体验可能比平时慢。

不需要的时候关掉就行了。

> 更新我正在开发一个主要由开发人员使用的网络应用程序。

**编辑**：根据您编辑的内容，我记得那篇关于萤火虫的文章：http: [//blog.getfirebug.com/ ?p=124](http://blog.getfirebug.com/?p=124)

> 在新模型中，如果您能看到 Firebug，则说明它处于活动状态。如果你不能，那就不是。

我猜使用您网站的开发人员可以自己计算，如果他们打开了 firebug，它会减慢网站的速度，对吗？如果不是，我想您别无选择，只能检测 FB 是否打开并显示错误消息。

这段代码也可以提供帮助：

```
if (window.console && window.console.firebug) {
    /* firebug found! */
} 
```

还有一种方法可以禁用某些功能：

```
if (! ('console' in window) || !('firebug' in console)) {
    var names = ['log', 'debug', 'info', 'warn', 'error', 'assert', 'dir', 'dirxml', 'group', 'groupEnd', 'time', 'timeEnd', 'count', 'trace', 'profile', 'profileEnd'];
    window.console = {};
    for (var i = 0; i < names.length; ++i) window.console[names[i]] = function() {};
} 
```

我还没有测试过（在这里找到：http: [//davidwalsh.name/how-to-sniff-firebug-disable](http://davidwalsh.name/how-to-sniff-firebug-disable)）

希望有帮助

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-28T16:56:46.310

Firebug 是一个调试器。它必须以各种方式将自己注入到 Firefox 中，以便为您提供您通常无法获得的信息。用它来调试，不需要的时候关掉，不需要的功能（网络、脚本、控制台……）就关掉。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-28T16:57:37.120

Firebug 基本上是一个不错的 Javascript 调试器。它提供了传统的调试功能，比如断点和观察值的能力，但它也可以让你深入和探索 DOM 元素。

最终，如果您有一个非常大的站点（就客户端代码和复杂性而言），那么是的，Firebug 可能是一个负担。首先，禁用您不使用的任何 Firebug 功能（控制台、网络等）。）

解决这个问题的唯一真正方法是 - 尝试 - 看看您是否可以通过暂时删除一些其他代码来仅处理您需要的部分 Javascript。通常，这是不可行的，但您无能为力。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-11-04T07:53:54.987

每个选项卡可以隐藏或完全关闭 Firebug。

如果你按 F12，它只会被隐藏。切换到该选项卡有时会导致延迟，并且该选项卡中的事情也会感觉很慢。

按 Shift + F12 在该选项卡中将其完全关闭，该选项卡将再次变快。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-26T21:41:42.317

所有这些缓慢都始于 2.0.12 IIRC 版本，并且恢复到 2.0.11 更正了它而没有丢失功能。我怀疑这里不仅仅是内存密集型，Chrome 的调试器具有相同的功能，但也没有这个问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-20T15:09:23.833

我默认打开所有选项卡（脚本，网络......），没有关于速度的问题。
但有时 Firefox 似乎几乎停滞不前，相当突然，而且没有明显的原因，即在以前响应时间很好的页面上。F5 没有帮助，需要很长时间。虽然很少见，但这似乎最常发生在使用脚本选项卡的激烈会话之后。我怀疑内存泄漏。
我的解决方案是重新启动 Firefox，响应时间再次完美。

# asp.net-mvc - 从控制器的操作中，我如何获取当前的路由信息 ？

> ID：798889
> 
> 赞同：2
> 
> 时间：2009-04-28T16:53:38.080
> 
> 标签：asp.net-mvc, routing

从控制器的操作中，我如何获取当前的路由信息​​？

我怎样才能循环通过其他路线？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T17:02:27.327

`RouteData`是一个键/值集合：

```
this.RouteData.Values["controller"]; 
```

..将返回当前路由的控制器。

```
this.RouteData.Values["action"]; 
```

..将返回动作等..

# sql - 如何在 SQL Server 2005 中将其他 XML 附加/合并到现有 XML 字段中

> ID：798895
> 
> 赞同：5
> 
> 时间：2009-04-28T16:55:10.540
> 
> 标签：sql, xml, sql-server-2005, stored-procedures

我在 SQL Server 2005 中有一个列，它存储了一个简单的 XML 块。稍后执行处理，我需要将一些处理信息合并到 XML 中。

虽然我可以在中间点执行此操作，但我更愿意将此方法集中在负责更新其他字段后处理的存储过程中。

[这是我开始使用的 XML 示例](http://paste-it.net/public/d7d8ab3/)以及我想要实现的结果类型。谁能给我一些粗略的 SQL 来实现它？

**更新：**终于明白了！当我有机会时，我会发布完整的解决方案，这已经足够了，希望其他人会发现它有用

**全部完成！**最后，我有一些额外的要求需要我重新设计 Marc 建议的解决方案并完全放弃 .modify() 函数；然而，他的回答让我克服了最初的障碍，让我能够退后一步，发现更简单的方法。 [这是我的最终解决方案](http://www.paste-it.net/public/ue339b1/)！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-28T17:12:30.233

这个怎么样：

```
update yourTable
set (your XML column).modify('insert <processingData id="guid" someAttrib="x" /> as last into /someData[1]')
where ....... 
```

那应该这样做。

有关如何在 SQL Server 2005 及更高版本中处理 XML 的更多详细信息，我会[在 15 秒后继续查看这篇文章，该文章](http://www.15seconds.com/Issue/050803.htm)很好地展示了如何使用 XML DML 语句在 SQL 服务器字段中插入、修改和删除 XML 片段.

马克

# php - 在 Windows/IIS 7 与 Linux/Apache 下运行 PHP 的性能差异？

> ID：798896
> 
> 赞同：6
> 
> 时间：2009-04-28T16:55:15.470
> 
> 标签：php, performance, apache, iis

现在有一个 PHP 应用程序在运行在 Apache 和 MySQL 下的 Linux 机器上。由于我们是一家 Windows 商店，管理层希望摆脱 Linux 机器并将所有内容转移到 Windows 上。两个平台之间有性能差异吗？或者，在绩效或管理方面是否有任何显着差异？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-28T20:44:43.873

微软有一个团队帮助为 Windows 优化 PHP，该工作是 PHP 5.3 的一部分。我见过的一些数据在 unix 系统上的性能接近 PHP + Apache。在 5.3 之前（这意味着目前，因为 5.3 还没有推出），Windows 上的性能很差。我认为您可以使用一些补丁和技巧来改进它，但这会花费您一些性能。这可能是也可能不是问题；人们有高估绩效的倾向。

请注意，使用 unix 的原因不仅仅是性能。代码可能不可移植，即使核心 php 运行得相当好，您也可能会遇到 php-extensions 和第三方库的麻烦。不管怎么看，Windows 都是运行 php 的二流系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T18:24:49.750

如果您的应用程序不是很大或每秒被击中几千次，那么两者之间没有区别。php 小项目中的 LAMP == WAMP。如果您希望您的环境尽可能接近现有环境但在 Windows 中，只需安装[XAMPP](http://www.apachefriends.org/en/xampp-windows.html)之类的东西。

祝你的项目好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T18:33:50.240

您应该考虑 MS WebPI（在 www.microsoft.com/web 下载），它将安装整个堆栈，以便您在 IIS7 环境中运行 PHP。

大多数应用程序的性能相当。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-16T13:01:46.813

出于同样的原因，我刚刚这样做了。Mgt 想摆脱 Linux 机器。我能够完全移动我的 php 应用程序和 MySQL 数据库。我为 IIS 配置 PHP 所花费的时间比我移动现有内容所花费的时间要长。虽然我发现 IIS 服务器在加载页面和图像时要慢一些。在 Linux 中它看起来是瞬时的，而在 IIS 中，页面加载需要半秒，而图像需要另一秒。

# actionscript-3 - 从内部获取 mx:CheckBox 值 mx:Repeater

> ID：798900
> 
> 赞同：1
> 
> 时间：2009-04-28T16:56:48.913
> 
> 标签：actionscript-3, flex3, mxml

我有一个对象数组，用作中继器的数据源。

```
<mx:Repeater id="categoryRepeater" dataProvider="{this.allCategories}">
<mx:HBox>
<mx:Spacer width="20"/>
<mx:CheckBox id="categoryCheckBox" label="{categoryRepeater.currentItem.question}"/>
</mx:HBox>
</mx:Repeater> 
```

我希望能够知道列表中的哪些复选框已被选中，但我不知道该怎么做。我知道我可以在单击时添加一个函数，但我不知道如何判断哪个复选框调用了该函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T17:11:05.540

使用该[`currentIndex`](http://www.few.vu.nl/~eliens/design/assets/flex3/langref/mx/core/Repeater.html#currentIndex)物业。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-03T15:43:06.290

我意识到这是一个非常古老的帖子，但我遇到了同样的问题，currentIndex 对我来说不是一个足够的答案。我发现更好的方法是在点击时创建一个函数：

```
<mx:Repeater id="rp" dataProvider="{dp}">  
<s:CheckBox height="100%" width="100%" label="{String(rp.currentItem)}"  
click="showAlert(event);"/>
</mx:Repeater> 
```

showAlert 函数看起来像这样：

```
private function showAlert(evt:MouseEvent):void {
  var curBox:CheckBox = evt.currentTarget as CheckBox;
  var str:String = curBox.content.toString();
  if(curBox.selected)
    Alert.show(str + " clicked");
} 
```

这样，您可以在 ActionScript 代码中将事件作为 CheckBox 处理，并查找值，例如它是否已被选中等。

# asp.net - 当有多个重定向时，如何在 ASP.NET 中获取引荐来源网址？

> ID：798911
> 
> 赞同：0
> 
> 时间：2009-04-28T16:58:58.770
> 
> 标签：asp.net, forms-authentication, single-sign-on

我正在开发一个使用内部 SSO 服务器进行身份验证的 Web 应用程序。我的主页上有一个指向名为 Logout.aspx 的页面的链接。Logout.aspx 清除 Forms Authentication cookie、所有会话数据，然后执行重定向到 Forms 身份验证配置中指定的 LoginUrl，该配置当前设置为名为 Login.aspx 的页面。

但是，当 Login.aspx 加载时，会尝试使用先前发布的 SSO 身份验证票证对 SSO 服务器隐式重新验证用户。如果此工单仍然存在，则之前的用户将重新登录并返回主页。我想确定，当登录页面加载时，请求是否来自注销页面。请求的 UrlReferrer 属性仍然引用 Home.aspx，大概是因为这是客户端请求的最后一个 url。

目前我有一个解决方法，我将一个查询字符串变量附加到来自注销页面的请求，指示登录页面不要执行隐式登录，而是提示用户输入凭据。如何以编程方式确定请求是否来自注销页面的重定向？

**2009 年 4 月 29 日编辑：**

在与 jellomonkey 的对话之后，我应该指出 SSO 服务器与消费网站的本地表单身份验证之间的交互与手头的问题没有直接关系。简而言之，我的问题是：

1.  用户单击 Home.aspx 中的 HTML 超链接，这会将他们带到 Logout.aspx
2.  Logout.aspx 的 Page_Load 事件处理程序清除 Forms Authentication 票证和 Session 数据并将用户重定向到 Login.aspx
3.  Login.aspx 的 Page_Load 事件检查 Request 对象的 UrlReferrer 属性以确定请求是否来自 Logout 页面。但是，在通过从 Logout.aspx 重定向而来的请求中，Request 对象的 UrlReferrer 属性是 Home.aspx。

为什么是这样？为什么是 UrlReferrer Home.aspx 而不是 Logout.aspx？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T21:19:52.527

您所描述的场景应该可以正常工作，除非注销页面实际上没有删除表单身份验证 cookie。有几种方法可以结束表单身份验证会话：

```
//I have seen instances where this does not work.
FormsAuthentication.SignOut()  

//I have not seen this code fail before.
Dim cookie As HttpCookie = FormsAuthentication.GetAuthCookie( _
    HttpContext.Current.User.Identity.Name, False)
cookie.Expires = Date.Now.AddDays(-1)

Response.Clear()
Response.AppendCookie(cookie)
Response.Redirect(FormsAuthentication.LoginUrl) 
```

此外，如果您使用存储在 cookie 中的角色管理器，请记住调用 Roles.DeleteCookie()。

**编辑：**响应更新的问题。

Response.Redirect 方法不会返回带有新 URL 引荐来源网址的标头，因为规范说只有客户端发起的请求才应包含引荐来源网址标头。这是 Response.Redirect 代码，您可以看到它不会更改引荐来源网址：

```
Public Sub Redirect(ByVal url As String, ByVal endResponse As Boolean)
If (url Is Nothing) Then
    Throw New ArgumentNullException("url")
End If
If (url.IndexOf(ChrW(10)) >= 0) Then
    Throw New ArgumentException(SR.GetString("Cannot_redirect_to_newline"))
End If
If Me._headersWritten Then
    Throw New HttpException(SR.GetString("Cannot_redirect_after_headers_sent"))
End If
Dim handler As Page = TryCast(Me._context.Handler,Page)
If ((Not handler Is Nothing) AndAlso handler.IsCallback) Then
    Throw New ApplicationException(SR.GetString("Redirect_not_allowed_in_callback"))
End If
url = Me.ApplyRedirectQueryStringIfRequired(url)
url = Me.ApplyAppPathModifier(url)
url = Me.ConvertToFullyQualifiedRedirectUrlIfRequired(url)
url = Me.UrlEncodeRedirect(url)
Me.Clear
If (((Not handler Is Nothing) AndAlso handler.IsPostBack) AndAlso (handler.SmartNavigation AndAlso (Me.Request.Item("__smartNavPostBack") = "true"))) Then
    Me.Write("<BODY><ASP_SMARTNAV_RDIR url=""")
    Me.Write(HttpUtility.HtmlEncode(url))
    Me.Write("""></ASP_SMARTNAV_RDIR>")
    Me.Write("</BODY>")
Else
    Me.StatusCode = &H12E
    Me.RedirectLocation = url
    If ((url.StartsWith("http:", StringComparison.OrdinalIgnoreCase) OrElse url.StartsWith("https:", StringComparison.OrdinalIgnoreCase)) OrElse ((url.StartsWith("ftp:", StringComparison.OrdinalIgnoreCase) OrElse url.StartsWith("file:", StringComparison.OrdinalIgnoreCase)) OrElse url.StartsWith("news:", StringComparison.OrdinalIgnoreCase))) Then
        url = HttpUtility.HtmlAttributeEncode(url)
    Else
        url = HttpUtility.HtmlAttributeEncode(HttpUtility.UrlEncode(url))
    End If
    Me.Write("<html><head><title>Object moved</title></head><body>" & ChrW(13) & ChrW(10))
    Me.Write(("<h2>Object moved to <a href=""" & url & """>here</a>.</h2>" & ChrW(13) & ChrW(10)))
    Me.Write("</body></html>" & ChrW(13) & ChrW(10))
End If
Me._isRequestBeingRedirected = True
If endResponse Then
    Me.End
End If
End Sub 
```

您可以使用反射器来遵循其他方法，但我没有看到改变任何标题的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T18:20:46.337

Response.Redirect("login.aspx?from=logout")

*   史蒂夫·耶茨
*   它的公司
*   为什么泰山没有胡子？

~ Taglinator 的标语：www.srtware.com ~

# c# - 二维数组缩减

> ID：798913
> 
> 赞同：1
> 
> 时间：2009-04-28T16:59:37.770
> 
> 标签：c#, multidimensional-array

我有一个二维数组，我需要将第一个对角线数字转换为零。例如，我需要转换以下内容：

```
[ 1 2 3 ]
[ 5 9 5 ]
[ 3 2 1 ] 
```

对此，意味着对角线`1 9 1`现在是`0 0 0`：

```
[ 0 2 3 ]
[ 5 0 5 ]
[ 3 2 0 ] 
```

如何在 C# 中有效地做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T17:01:24.160

您所做的就是在 X 和 Y 相等时将网格中的点设置为零。(1,1)、(2,2) 等；

```
int x = 4, y = 5;
int[,] array = new int[x,y]; // assume we initialize this with some values
for (int i = 0; i < x && i < y; i++ ) {
    array[i,i] = 0;
} 
```

# multithreading - TThread 的后代，从主线程访问属性

> ID：798916
> 
> 赞同：3
> 
> 时间：2009-04-28T17:00:08.033
> 
> 标签：multithreading, delphi

我有一个类是 TThread 的后代。我有一些只读的公共属性。如果我的主线程在线程处于活动状态时读取这些值，我会遇到问题吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-28T17:23:11.550

如果通过“只读属性”您的意思是 TThread 后代本身也不会更改它们，并尽快初始化它们，那么不，一切都会好起来的（只要您确保线程处于活动状态并在您请求时启动属性值）。

如果通过“只读属性”您的意思是 TThread 后代将是唯一更改它们的，您将需要确保主线程在更改它们时不会读取它们（除非它们是原子值，如整数） .

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T17:26:01.170

基本类型，如`Integer`、`Boolean`、`Char`和`Pointer`，可随时安全阅读。引用类型（如`string`、接口和动态数组）只有在其他线程不可能同时分配新值的情况下才能安全读取。例如，使用临界区或`Synchronized`方法确保主线程正在读取该值时线程没有修改该值。

您还必须记住，您读取的任何值在您使用它时可能已经过时 - 线程可能在您读取它的时间和使用它的时间之间写入了一个新值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-28T18:25:17.627

这取决于属性类型，可能还取决于它们的访问器方法。

```
type
  TMyThread = class(TThread)
  private
    FIntfield: integer;
  public
    property IntField: integer read FIntField;
  end; 
```

访问这个属性不会有问题，因为访问 32 位值是一个原子操作。但是如果属性大于 32 位或者在主线程访问它时可能会更改的类引用，你就会遇到麻烦。

# ruby-on-rails - 如何为 Rails ActionMailer 配置主机名？

> ID：798917
> 
> 赞同：20
> 
> 时间：2009-04-28T17:00:22.447
> 
> 标签：ruby-on-rails, actionmailer, hostname, actioncontroller

我正在处理一个相当传统的忘记密码电子邮件 - 我想通过电子邮件向用户发送一个嵌入在链接中的密码更改令牌，他们可以单击该链接来更改密码。我通过传统的 ActionMailer 发送电子邮件。

如果我使用普通的 link_to 标签

```
<%= link_to "click here", :controller => foo, :action => 'bar', :token => token %> 
```

我从电子邮件中获得了一个相对链接 - 相当无用。

如果我添加

`:only_path => false`，然后它错误说我需要设置`default_url_options[:host]`. ActionController 文档暗示您可以通过覆盖控制器中的 #default_url_options 方法来做到这一点。当然有一个配置选项可以告诉 Rails 它的主机名是什么，而无需添加我自己的配置文件、解析它等？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-28T18:58:45.207

`default_url_options`可以从环境的配置文件中获得，`config.action_mailer`并且应该在您的环境的配置文件中进行设置。

例如，在`config/environments/production.rb`：

```
config.action_mailer.default_url_options = {
  :host => 'www.yourdomain.com'
} 
```

对于本地测试，修改`config/environments/development.rb`：

```
config.action_mailer.default_url_options = {
  :host => '127.0.0.1',
  :port => 3000
} 
```

然后，假设您有一个名为 的命名路由`forgot_password_login`，您可以使用以下内容在邮件程序中生成登录链接 URL：

```
forgot_password_login_url(:token => 'a7s8q15sk2...') 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2011-03-14T19:20:57.157

顺便说一句，您可能还想设置 :protocol => 'https' 。

```
config.action_mailer.default_url_options = { 
    :host => "portal.example.com", 
    :protocol => 'https' 
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-04-22T10:45:35.027

还有另一种选择，如[http://pivotallabs.com/how-i-leaned-to-stop-hating-and-love-action-mailer/中所述](http://pivotallabs.com/how-i-leaned-to-stop-hating-and-love-action-mailer/)

这个解决方案的优点是它不需要任何配置（所以麻烦少），只要您从控制器内发送电子邮件就可以正常工作。

但是，如果您计划在不通过控制器的情况下发送电子邮件（例如，从命令行或响应另一封电子邮件），则需要静态配置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T07:34:27.087

`default_url_options`在 Rails 3.1 中不推荐直接设置。请改用[url_for](http://apidock.com/rails/ActionController/Base/url_for)。

添加参数`:protocol`以覆盖默认值 (http) `:protocol => 'https://'`，. 这将创建以“https://...”开头的 url，而不是默认的“http://”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-26T15:28:28.680

有趣的是，我遇到了与您相同的问题，但在单元测试中（同时遵循 Michael Hartl 的 railstutorial）。我的 test.rb 文件中有这一行，但这没有帮助：

```
config.action_mailer.default_url_options = { host: 'example.com', protocol: 'http' } 
```

我还在 test.rb 中添加了另一行这样的行，令人惊讶的是这解决了这个问题

```
default_url_options = { host: 'example.com', protocol: 'http' } 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-01-19T17:36:22.767

在 Rails 3.1 中不推荐直接设置 default_url_options

使用 url_for 助手创建它：

```
<%= link_to "click here", url_for(:controller => foo, :action => 'bar', :token => token, :host => 'www.yourdomain.com') %> 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-04-28T18:00:07.653

你能做到吗

```
<%="click here", :controller => foo, :action => 'bar', :token => token, :host=>request.host -%> 
```

# language-agnostic - 编写简单条件检查的最易读的方法

> ID：798919
> 
> 赞同：6
> 
> 时间：2009-04-28T17:00:35.847
> 
> 标签：language-agnostic, coding-style, conditional-statements

编写如下所示的多条件检查最易读/最好的方法是什么？

我能想到的两种可能性（这是 Java，但语言在这里真的无关紧要）：

**选项1：**

```
 boolean c1 = passwordField.getPassword().length > 0;
   boolean c2 = !stationIDTextField.getText().trim().isEmpty();
   boolean c3 = !userNameTextField.getText().trim().isEmpty();

   if (c1 && c2 && c3) {
      okButton.setEnabled(true);
   } 
```

**选项 2：**

```
 if (passwordField.getPassword().length > 0 &&
         !stationIDTextField.getText().trim().isEmpty() &&
         !userNameTextField.getText().trim().isEmpty() {
      okButton.setEnabled(true);
   } 
```

我不喜欢选项 2 的地方是换行，然后缩进变得很痛苦。我不喜欢选项 1 的一点是，它什么都不创建变量，并且需要查看两个地方。

所以你怎么看？**还有其他**选择吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-28T17:05:15.760

```
if (HasPassword() && HasStation() && HasUserName())
  okButton.setEnabled(true);

bool HasPassword() {
 return passwordField.getPassword().length > 0;
} 
```

等等

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-28T17:09:12.050

请注意，选项 1 不允许短路行为。也就是说，您在评估第一个条件的结果之前计算所有条件的值。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-28T17:03:24.670

我会修改选项 1，以便您使用真正有意义的变量名。也就是说，将“c2”的名称更改为“stationIDIsEmpty”之类的名称（并将 NOT 移动到条件中）。这样，条件是可读的，而不必来回浏览每个变量。

所以我的代码可能看起来像：

```
boolean enteredPassword = passwordField.getPassword().length > 0;
boolean stationIDIsEmpty = stationIDTextField.getText().trim().isEmpty();
boolean userNameIsEmpty = userNameTextField.getText().trim().isEmpty();

if (enteredPassword && !stationIDIsEmpty && !userNameIsEmpty) {
   okButton.setEnabled(true);
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-28T17:09:43.360

我投票支持 Chris Brandsma 的回答。

但只想提一下我对选项 1 的主要问题是你正在失去 && 的好处。使用选项一，虽然我认为它更具可读性，但您正在处理可能不需要的比较。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-28T17:05:40.687

就个人而言，我喜欢第二种方式，因为我发现使用这种方式可以使条件句的谓词清晰。也就是说，通过正确执行该方法，您可以通过“验证”它来使条件易于理解（无论您是否真的说它是无关紧要的）。

也就是说，使用您的第二个选项，很明显您的条件大致翻译为：“如果密码长度大于零，并且 stationIDTextField（修剪）不为空，并且 usernameTextField（修剪）不为空，那么……”

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-28T17:06:49.373

我更喜欢以下内容：

```
if (passwordField.getPassword().length > 0
    && ! stationIDTextField.getText().trim().isEmpty()
    && ! userNameTextField.getText().trim().isEmpty())
{
    okButton.setEnabled(true);
} 
```

使用这种编码风格，我完成了两件事：

*   我可以很容易地看到 if 的每一行额外的行都是条件的一部分，因为 && （或 ||） 在开头。
*   由于下一行的 { ，我可以很容易地看到 if 语句在哪里结束。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-28T17:08:57.077

Option1 是应用重构“ [Replace temp with Query](http://www.refactoring.com/catalog/replaceTempWithQuery.html) ”的首选。原因是有人可以在变量初始化和检查和更改代码行为之间填充代码。或者检查可能使用过时的值。在初始化和检查之间对文本字段进行了更新。

所以我的尝试是

```
if (GetPasswordLength() > 0 
   && FieldHelper.IsNotEmpty(stationIDTextField) 
   && FieldHelper.IsNotEmpty(userNameTextField) 
{
   okButton.setEnabled(true);
} 
```

FieldHelper 是一个具有公共静态方法的类（在 C# 中也称为实用程序类/静态类）

# algorithm - 在集合中查找重复值的最佳方法

> ID：798924
> 
> 赞同：1
> 
> 时间：2009-04-28T17:01:29.853
> 
> 标签：algorithm, language-agnostic

在一组中找到最经常出现的值的最佳方法是什么？我想使用一次性算法，假设值来自 1,2,3,4,..,m 域？

如果我必须编写一个算法来做到这一点，我会怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T17:03:56.713

```
SELECT value, COUNT(*) frequency
FROM table
GROUP BY value
ORDER BY COUNT(*) DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T18:04:13.650

将它们存储在哈希表中，计算每个存储的次数（O(n)）。
然后循环遍历桶（O（n））。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T18:17:29.720

根据定义，集合仅包含唯一值。因此，答案应该是集合本身，它可以在恒定时间内“计算”出来。:-)

说真的，假设您实际上正在使用堆、列表、向量或其他一些允许重复的数据结构，解决问题的最快方法可能是 Mike Dunlavey 的答案，即使用哈希表。还有一些使用树的技术可以使用，这些技术可以使用连续更精细的估计。我认为这种方法是 O(n log n) （不如哈希表解决方案好），但如果您允许一些统计错误，它可能会低至 O(log n)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T17:02:49.663

```
SELECT  value
FROM    table
GROUP BY
        value
ORDER BY
        COUNT(*) desc
LIMIT 1 
```

# javascript - 连接 javascript 事件并传递参数

> ID：798925
> 
> 赞同：3
> 
> 时间：2009-04-28T17:01:32.117
> 
> 标签：javascript

**一点背景：** 我有一个带有表格和许多复选框的页面。该页面是在 asp.net 中生成的。每行都有一个复选框，标题中有一个复选框，在某些单元格中会有一组复选框（您会看到很多复选框）。

当前，这些复选框中的每一个都可以在其 onclick 事件中使用一点 javascript 魔术来正常工作。

所以你有类似的东西：

```
<td><input type="checkbox" id="sellRow1" onclick="javascript:highlightRow(this, 'AlternateRowStyle1');"/></td> 
```

那时也就不足为奇了。

**好的，这就是问题所在：** 所以这很好，但是我需要每个复选框来反映其他复选框的状态。例如：标题中的复选框更改行复选框的值，更改行复选框可以更改标题复选框等。

我知道您在想什么：只需调用该 Javascript 函数即可`highlightRow`。但是，如果我这样做了，我将如何获得参数（好吧，这`this`很容易，但是我到底在哪里可以得到`'AlternateRowStyle1'`呢？）

**所以我想问题是：**我应该把这些参数放在哪里，这样我就可以用 JS 以一种很好的跨浏览器方式获取它们。（`<PossibleRedHerring>`尝试在每个复选框上放置自定义属性，但不确定这是正确的方法`</PossibleRedHerring>`），如果这完全可以避免，我也不想继续回调服务器。

* * *

（顺便说一句，如果格式/写得有点糟糕，我很抱歉！）

* * *

**更新：** 好的，所以最后我设法避开了自定义属性，因为注意到复选框有层次结构。这意味着我能够触发子复选框的点击事件（这反过来会称之为孩子的点击事件等）幸运的是，在这种情况下，流程永远不会朝相反的方向前进，导致无限循环（有很多评论/ 文件指出这一点！）

唯一有趣的是 IE 和 firefox、chrome 和 safari 中的点击事件之间的区别。IE 允许任何点击，而其他点击则限制为按钮、复选框、单选、重置或提交类型的 INPUT 元素。我有点想使用事件冒泡将点击事件附加到包含一组复选框的元素上。

最后进行了一些破解：

```
// In IE every element supports Click wilst Firefox (also chrome and safari) only supports INPUT elements of type button, checkbox, radio, reset or submit
// https://developer.mozilla.org/en/DOM/element.click
// this function allows both browers to support click on all elements
function FireClickEvent(element)
{
    if (element.click)
    {
        element.click();
    }
    else
    {
        // We don't have a click on this element, so add our own.
        var evt = document.createEvent("MouseEvents");
        evt.initMouseEvent("click", true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);
        element.dispatchEvent(evt);
    }
} 
```

认为这可能会有所改善，但它现在可以做生意。

也应该承认这是我第一次尝试正确的 javascript。这是一种有点可怕的语言（尤其是在击中 dom 时！）虽然很有趣，但我期待着花点时间进一步研究。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T17:09:50.647

我认为自定义属性确实是您的解决方案，看不出有什么问题。尽管我会将诸如备用行样式之类的东西作为行的属性，而不是作为复选框的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T17:11:00.487

你可以通过使用 jquery 很容易地做到这一点。您可以根据复选框的位置在复选框上定义一些自定义属性，并在单击时获取属性值并操作行的 css，以您想要的方式复选框。

这就是您如何使用 jquery 为表格定义备用行颜色

```
$("table tr:nth-child(even)").addClass("striped");

<style>
.striped{
 background-color:#efefef;
}
</style> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T17:12:09.830

如果我理解正确；您希望能够单击标题并检查同一行中的所有复选框吗？

我会为“th”元素设置一个cssclass，并在每个“td”元素上使用相同的类。

我会将交替类放在每隔一个“tr”元素上。这样，无论它是否是交替项目，您都可以采用不同的样式。

我还会使用 jQuery 轻松创建 js 代码。

我不会添加自定义属性，因为......你不能只添加自己的想象属性，这就是我们有 html 标准的原因。

# objective-c - Clang 中的“返回对象泄漏”是什么意思？

> ID：798933
> 
> 赞同：2
> 
> 时间：2009-04-28T17:04:07.167
> 
> 标签：objective-c, memory-leaks, clang

除了[这个问题](https://stackoverflow.com/questions/784474/feedback-on-my-first-objective-c-code-a-quicklook-plugin)，我在[BEncoding.m](http://github.com/dbr/qltorrent/blob/00748acfcc8b3a999248d608e2d9fa3b64ba8a5a/BEncoding.m#L1)中修复了一堆内存泄漏（最初来自[这里](http://www.stupendous.net/projects/bencoding-obj-c-class/)）

我已经修复了所有明显的内存泄漏，但 Clang 发现了四个“返回对象泄漏”错误，我不确定如何排序：

完整的消息/适当的代码位是：

> ```
> NSMutableData *data = [[NSMutableData alloc] init]; 
> ```
> 
> [1] 方法返回一个具有 +1 保留计数的 Objective-C 对象（拥有引用）
> 
> ```
> [...]
> snprintf(buffer, 32, "%lu:", [object length]);
> [data appendBytes:buffer length:strlen(buffer)];
> [data appendData:object];
> return data; 
> ```
> 
> [3] 作为拥有引用返回给调用者的对象（单个保留计数转移给调用者）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-28T17:19:18.673

你要：

返回[数据自动释放]；

因为你把它交给来电者。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-24T04:24:25.123

好的，所以要扩展上面的答案（感谢您让我走上正确的轨道）...

```
return [data autorelease] 
```

您已经分配了一些对象“数据”，并且即将将该对象返回给调用者。这在 Obj-C 中的工作方式是在调用堆栈的某个级别上，有一个 NSAutoreleasePool。当您向数据发送“自动释放”消息时，它会将自身添加到该自动释放池中。这允许调用者短暂地使用“数据”对象（即，在本地堆栈帧的持续时间内）而无需显式调用“释放”，最终，当自动释放池“弹出”时，数据将被释放（除非有人称之为“保留”）。这是比较聪明的。

甜的。我想我刚刚获得了 Obj-C 内存管理的绿带。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T17:14:09.497

听起来对象在返回之前没有被正确地自动释放，这违反了[Objective-C 内存管理约定](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/MemoryMgmt/index.html)。

# proxy - 通过代理连接有什么区别？

> ID：798934
> 
> 赞同：1
> 
> 时间：2009-04-28T17:04:55.633
> 
> 标签：proxy

我知道什么是代理，以及它们如何工作的基础知识。

我想知道的是，通过代理的请求有什么不同？

我知道当我配置 Firefox 时，我只是在对话框中配置代理。当我在 python 中编程时，我可以使用环境变量。

如果我在尚不支持代理的环境中编程，如何通过代理进行连接？请求中是否添加了额外的标头？协议是否略有不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T17:15:13.940

协议略有不同。如果直接连接到`example.com`会说：

```
GET /index.html HTTP/1.1 
```

通过代理的连接会说：

```
GET http://example.com/index.html HTTP/1.1 
```

# .net - 将部署的 asp.net webservice 消耗到 IIS6 时出现问题

> ID：798935
> 
> 赞同：2
> 
> 时间：2009-04-28T17:05:13.123
> 
> 标签：.net, asp.net, web-services, iis, wsdl

尝试从 Windows 窗体应用程序更新对已部署的 asp.net Web 服务的 Web 引用时，出现错误。

```
无法从 下载以下文件。
https://webserver/webservices/myservice.asmx?wsdl
```

出于某种原因，它正在查看一个名为 webserver 的主机，但这并不是它需要查找 WSDL 的内容。它需要查看我为 Web 服务引用输入的域名。我想我在 IIS 中有问题。

我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T17:48:09.227

您可以尝试使用[wsdl.exe](http://msdn.microsoft.com/en-us/library/7h3ystb6(vs.71).aspx)为相同的 url 生成代理类吗？

```
wsdl /out:myProxyClass.cs https://<server>/webservices/myservice.asmx?wsdl 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T17:14:42.723

我真的怀疑 IIS 是否存在问题，我建议您从 Windows 应用程序中删除对 Web 服务的引用，并再次提供 Web 服务的正确 URL。

此外，通过 HTTPS 访问 Web 服务会带来自己的共享故障，因此我建议您先尝试不使用 HTTPS，使其正常工作，然后再使用 HTTPS。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T17:30:49.130

听起来您需要在 IIS 中为 https 配置服务器绑定，特别是主机头值。在 IIS 6 中，您无法通过 IIS 管理器 UI 执行此操作。您将需要运行 cscript adsutil.vbs。查看[为 SSL 主机头 (IIS 6.0) 配置服务器绑定](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/596b9108-b1a7-494d-885d-f8941b07554c.mspx?mfr=true)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T18:01:20.163

按照 Gulzar 的建议，我使用 wsdl.exe 生成类，然后进入类并将服务器的本地主机名更改为 Internet 可访问的主机名。

杰出的！

However, in the future I wont be able to just right click the web reference in my project and choose UPDATE SOLUTION. BUT WHO GIVES A CHEESE WHIZ?

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-19T22:45:03.573

We had a VS 2003 1.1 web service, and could not connect with the wsdl definition failing to load.

Turns out the problem was a relative addressed Uri. I took two days to figure this out.

BAD: [ WebService (Namespace = "[http://../MyWebService.com/](http://../MyWebService.com/)"]

GOOD: [ WebService (Namespace = "[http://tempuri.org/](http://tempuri.org/)"]

verify the default namespace is an absolute address.

For more info visit: [http://www.w3.org/TR/wsdl](http://www.w3.org/TR/wsdl)

Hope this helps

# apache-flex - 在效果标签内绑定效果属性不起作用？

> ID：798943
> 
> 赞同：0
> 
> 时间：2009-04-28T17:06:21.373
> 
> 标签：apache-flex, binding, mxml, effects

我们正在尝试这样做：

```
<rollOverEffect>
    <AnimateProperty property="scaleX" toValue="{originalWidth + scaleFactor}" />
</rollOverEffect> 
```

然而，似乎 toValue 的效果总是 NaN。如果我将值设置为常数，效果会起作用。难道不能使用数据绑定来实现这样的效果吗？

* * *

**附录：** originalWidth 和 scaleFactor 都是可绑定的。我设法通过将效果移出rollOverEffect-tag，给它和id，然后像这样绑定到它来实现这个工作：

```
<AnimateProperty id="scaleEffect" property="scaleX" toValue="{originalWidth + scaleFactor}" />
<MyComponent rollOverEffect="{scaleEffect}" /> 
```

知道为什么这有效而以前的代码无效吗？后一个片段创建了第二个不必要的绑定并且不那么可读，但至少它可以工作。

* * *

**附录：** 以下代码突出显示了该问题。无论滑块设置为什么，效果的 angleTo 属性的值将始终设置为滑块初始值设置的值。

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute">
<mx:VBox horizontalCenter="0" verticalCenter="0">
    <mx:Label text="Rotation (mouse over on canvas triggers effect):" />
    <mx:HSlider id="slider" width="200" minimum="0" maximum="360" value="90" />

    <mx:Spacer height="50" />

    <mx:Canvas borderStyle="solid" borderThickness="1" borderColor="#ff0000" backgroundColor="#0000ff" width="200" height="200">
        <mx:rollOverEffect>
            <mx:Rotate angleTo="{slider.value}" duration="500" />
        </mx:rollOverEffect>

        <mx:rollOutEffect>
            <mx:Rotate angleTo="{-slider.value}" duration="500" />
        </mx:rollOutEffect>
    </mx:Canvas>
</mx:VBox>
</mx:Application> 
```

与以下实际产生预期结果的代码进行比较：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute">
<mx:Rotate id="rollOver" angleTo="{slider.value}" duration="500" />
<mx:Rotate id="rollOut" angleTo="{-slider.value}" duration="500" />

<mx:VBox horizontalCenter="0" verticalCenter="0">
    <mx:Label text="Rotation (mouse over on canvas triggers effect):" />
    <mx:HSlider id="slider" width="200" minimum="0" maximum="360" value="90" />

    <mx:Spacer height="50" />

    <mx:Canvas rollOverEffect="{rollOver}" rollOutEffect="{rollOut}" borderStyle="solid" borderThickness="1" borderColor="#ff0000" backgroundColor="#0000ff" width="200" height="200" />
</mx:VBox>
</mx:Application> 
```

所以本质上问题是什么，为什么绑定在第一个示例中不起作用？没有错误或警告可以告诉您这一点，我也无法在文档中找到任何关于此的内容，这可能是一个错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T17:09:35.780

您需要向我们展示更多代码。你可以试一下下面的代码吗？这行得通吗？

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute">
    <!-- Simple exemplo to demonstrate the AnimateProperty effect. -->

    <mx:Sequence id="animateScaleXUpDown" >
        <mx:AnimateProperty property="scaleX" fromValue="{ns.value}" toValue="{ns.minimum}" duration="1000" />
        <mx:AnimateProperty property="scaleX" fromValue="1.5" toValue="1" duration="1000" />    
    </mx:Sequence>

    <mx:Panel title="AnimateProperty Effect Example" width="75%" height="75%" 
        paddingTop="10" paddingLeft="10" paddingRight="10" paddingBottom="10">

        <mx:Text width="100%" color="blue" 
            text="Click on the image to use the AnimateProperty effect with the scaleX property."/>

        <mx:Image id="flex" source="http://stackoverflow.com/content/img/stackoverflow-logo.png"
            mouseDownEffect="{animateScaleXUpDown}"/>
        <mx:NumericStepper id="ns" width="62" value=".5" minimum="1" maximum="3" stepSize="0.5" enabled="true"/>

    </mx:Panel>

</mx:Application> 
```

# scrollbar - 鞋子问题：剪贴板和滚动条

> ID：798947
> 
> 赞同：2
> 
> 时间：2009-04-28T17:07:18.267
> 
> 标签：scrollbar, clipboard, shoes

下面的代码（至少）有两个问题：`Copy`按钮不更新剪贴板，并且`edit_box`不应该显示垂直滚动条。

```
Shoes.app (:title => "Test", :width => 1000, :height => 600) do
  background "#DFA"
  stack :margin => 30 do
    flow do
      button "Paste" do
        @sql.text = clipboard
      end
      button "Copy", :margin_left => 15 do
        clipboard = @sql.text
        alert(@sql.text.length.to_s + " characters copied to clipboard.")
      end
    end
    stack :margin_top => 10, :width => "100%", :height => 500, :scroll => true do
      @sql = edit_box :width => "100%", :height => "100%"
    end
  end
end 
```

该`Paste`按钮将剪贴板内容正确粘贴到`edit_box`. 如果您进行更改，然后单击`Copy`，`alert`消息将显示正确的字符数。如果您随后`Paste`再次单击，则会粘贴原始剪贴板内容。该`Copy`按钮永远不会正确更新剪贴板。

此外，如果通过编辑或粘贴生成的行数超过了`edit_box`，则不会出现滚动条。

对于这两个问题的任何帮助将不胜感激。如果有帮助，我的环境是 Windows XP。

**更新答案：**感谢@Pesto 回答剪贴板问题。事实证明，在和按钮中`clipboard`使用其中一个`app.`或`self.`按预期工作。`Paste``Copy`

在深入研究滚动条问题后，我想我明白为什么`edit_box`不显示滚动条了。Shoes 中的滚动条仅适用于插槽（`stack`和`flow`），而不适用于单个元素，例如`edit_box`. `edit_box`高度以始终适合封闭的方式指定，`stack`因此`stack`永远不需要滚动条。这导致我找到了一个不理想的解决方法，但我的应用程序可以接受。只需将`edit_box`高度更改为大于必要的值，例如`"10000px"`滚动条就会出现。不幸的是，无论是否需要，它都在那里，但这总比没有滚动条好。我敢肯定，一些额外的修补可以动态改变`edit_box`高度以完全适合内容，以便滚动条仅在需要时出现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T19:00:33.220

首先，最简单的方法是：将 Copy 按钮中的行更改为`app.clipboard = @sql.text`。

其次，就滚动条而言，这是 Windows XP 上的一个[已知问题](http://thread.gmane.org/gmane.comp.lib.shoes/2304)。我没有在 github 上的错误报告中看到它，但最新版本（r1229）仍然没有滚动条。

# iphone - main.m 真的是每个事件创建主运行循环的自动释放池的地方吗？

> ID：798950
> 
> 赞同：2
> 
> 时间：2009-04-28T17:08:25.237
> 
> 标签：iphone, cocoa-touch, uikit, autorelease

```
#import <UIKit/UIKit.h>

int main(int argc, char *argv[]) {
    NSLog(@"new event...");
    NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];
    int retVal = UIApplicationMain(argc, argv, nil, nil);
    [pool release];
    return retVal;
} 
```

如果是这种情况，那么 main() 函数必须在每个事件上调用，对吗？但我试过了，“新事件......”日志消息只是在应用程序启动时出现。所以我猜主线程中肯定还有另一个自动释放池。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-28T17:31:40.953

不可以。所有 Cocoa 或 CocoaTouch 类都需要存在自动释放池才能不泄漏内存。因此，现有的自动释放池需要调用 UIApplicationMain() 以覆盖在 UIApplicationMain() 上下文中实例化的任何（可能）自动释放对象。如您所见，在 UIApplicationMain 返回后，就在应用程序退出之前，该外部自动释放池已耗尽。内部（请记住，自动释放池可以嵌套，并且自动释放的对象被添加到最新/最深的池中）自动释放池在应用程序运行循环的每次迭代开始时创建，并在迭代结束时释放。因此，运行循环的每次迭代都会获得“自己的”自动释放池。如果处理一个事件可能会产生大量自动释放的内存（在 iPhone 上是个坏主意，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T17:16:50.410

不，这是应用程序中最外层的函数，一个常规的 C 风格 main()。

iPhone 应用程序所做的一切都发生在 UIApplicationMain 中，包括所有事件处理。

# iphone - 布置 UIButtons - 简单的方法？

> ID：798955
> 
> 赞同：0
> 
> 时间：2009-04-28T17:09:19.023
> 
> 标签：iphone

我正在制作一个表格，其中有一行看起来像 Apple Mail 应用程序中的“收件人：”行。当您从通讯簿向“邮件”添加新人时，他们的姓名会显示在圆形按钮中。

我可以创建按钮并使用 sizeToFit 使其紧贴文本 - 没问题。

但是，一旦我这样做了，我就无法弄清楚按钮的宽度。有没有一种简单的方法可以将一堆按钮粘贴在一个单元格中并根据需要自动换行，还是我必须手动计算宽度，如果它超出屏幕的末端，移动到下一行？

另外，如何获得 sizeToFit'ted 按钮的宽度？button.frame 返回空值。最令人费解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T17:23:31.707

您可能想看看 Joe Hewitt 的[three20 项目](http://github.com/joehewitt/three20/tree/master)，这是用于 iPhone 的自定义 UI 元素的集合，用于 Facebook 应用程序的开发。

您会特别感兴趣的两个类是[TTMessageController](http://github.com/joehewitt/three20/tree/master)和[TTPickerTextField](http://github.com/joehewitt/three20/blob/master/src/Three20/TTPickerTextField.h)。

从项目现场：

> TTMessageController 模拟 Apple 邮件应用程序中的消息编辑器。您可以对其进行自定义以发送您想要的任何类型的消息。包括您自己的一组消息字段，或使用标准的“收件人：”和“主题：”。收件人姓名可以从您提供的数据源自动完成。
> 
> TTPickerTextField 是一个预先输入的 UITextField。当您键入时，它会搜索数据源，并在您选择预先输入选项时将气泡添加到文本流中。我在 TTMessageController 中使用它来选择消息收件人的姓名。

# .net - WPF MVVM 从 ViewModel 触发事件的正确方法

> ID：798964
> 
> 赞同：22
> 
> 时间：2009-04-28T17:10:36.760
> 
> 标签：.net, wpf, mvvm, binding, command

在我的 WPF 应用程序中，我有 2 个 Windows（两个 Windows 都有自己的 ViewModel）：

1.  应用程序的主窗口，显示带有一堆单词的列表（绑定到 MainViewModel）

2.  允许用户向列表中添加新项目的对话框窗口（绑定到 AddWordViewModel）

MainViewModel 具有 List 的 Articles 属性（此集合由服务类之一填充）绑定到主窗口的 ListBox

AddWordViewModel 有 SaveWordCommand 绑定到添加 Word 对话框的保存按钮。它的任务是获取用户输入的文本并将其传递给服务类。

用户点击保存按钮后，我需要通知 MainViewModel 从服务重新加载文章。

我的想法是在 MainViewModel 中公开公共命令并从 AddWordViewModel 执行它

实现它的正确方法是什么？

谢谢你！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-28T17:42:49.257

[事件聚合器](http://www.martinfowler.com/eaaDev/EventAggregator.html)是解决此类问题的好方法。基本上有一个集中的类（为了简单起见，假设它是一个单例并且面对可能的反单例家伙的愤怒）负责将事件从一个对象转移到另一个对象。使用您的类名，用法可能如下所示：

```
public class MainViewModel
{
    public MainViewModel()
    {
        WordAddedEvent event = EventAggregator.Instance.GetEvent<WordAddedEvent>();
        event.Subscribe(WordAdded);
    }

    protected virtual void WordAdded(object sender WordAddedEventArgs e)
    {
        // handle event
    }
}

public class AddWordViewModel
{    
    //From the command
    public void ExecuteAddWord(string word)
    {
        WordAddedEvent event = EventAggregator.Instance.GetEvent<WordAddedEvent>();
        event.Publish(this, new WordAddedEventArgs(word));
    }
} 
```

这种模式的优点是您可以非常轻松地扩展您的应用程序，使其具有多种创建单词的方式和多个对已添加的单词感兴趣的 ViewModel，并且两者之间没有耦合，因此您可以在添加和删除它们时添加和删除它们。需要。

* * *

如果您想避免单例（出于测试目的，我建议您这样做），那么可能值得研究依赖注入，尽管这确实是另一个问题。

* * *

好吧，最后的想法。我从重新阅读您的问题中看到，您已经拥有某种处理 Word 对象的检索和存储的 Word Service 类。没有理由在添加新单词时服务不能负责引发事件，因为两个 ViewModel 都已经耦合到它。虽然我仍然建议 EventAggregator 更灵活和更好的解决方案，但[YAGNI](http://en.wikipedia.org/wiki/You_Ain%27t_Gonna_Need_It)可能适用于这里

```
public class WordService
{
    public event EventHandler<WordAddedEventArgs> WordAdded;

    public List<string> GetAllWords()
    {
        //return words
    }

    public void SaveWord(string word)
    {
        //Save word
        if (WordAdded != null) WordAdded(this, new WordAddedEventArgs(word));
        //Note that this way you lose the reference to where the word really came from
        //probably doesn't matter, but might
    }
}

public class MainViewModel
{
    public MainViewModel()
    {
        //Add eventhandler to the services WordAdded event
    }
} 
```

您要避免做的是引入 ViewModel 之间的耦合，您将通过在一个 ViewModel 上与另一个 ViewModel 调用命令来创建该耦合，这将严重限制您扩展应用程序的选项（如果第二个 ViewModel 对新词感兴趣怎么办？ ，现在 AddWordViewModel 也有责任告诉那个人吗？）

# php - PHP simpleXML如何以格式化的方式保存文件？

> ID：798967
> 
> 赞同：91
> 
> 时间：2009-04-28T17:11:11.673
> 
> 标签：php, formatting, simplexml

我正在尝试使用 PHP 的 SimpleXML 将一些数据添加到现有的 XML 文件中。问题是它在一行中添加了所有数据：

```
<name>blah</name><class>blah</class><area>blah</area> ... 
```

等等。全部在一条线上。如何引入换行符？

我怎样才能做到这一点？

```
<name>blah</name>
<class>blah</class>
<area>blah</area> 
```

我正在使用`asXML()`功能。

谢谢。

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2009-04-28T17:16:27.870

您可以使用[DOMDocument 类](http://docs.php.net/manual/en/class.domdocument.php)重新格式化您的代码：

```
$dom = new DOMDocument('1.0');
$dom->preserveWhiteSpace = false;
$dom->formatOutput = true;
$dom->loadXML($simpleXml->asXML());
echo $dom->saveXML(); 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-11-24T22:01:18.260

Gumbo 的解决方案可以解决问题。您可以使用上面的 simpleXml 进行工作，然后将其添加到最后以回显和/或使用格式保存它。

下面的代码对其进行回显并将其保存到文件中（请参阅代码中的注释并删除您不想要的任何内容）：

```
//Format XML to save indented tree rather than one line
$dom = new DOMDocument('1.0');
$dom->preserveWhiteSpace = false;
$dom->formatOutput = true;
$dom->loadXML($simpleXml->asXML());
//Echo XML - remove this and following line if echo not desired
echo $dom->saveXML();
//Save XML to file - remove this and following line if save not desired
$dom->save('fileName.xml'); 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-04-28T20:56:29.087

用于[`dom_import_simplexml`](http://www.php.net/function.dom_import_simplexml)转换为 DomElement。然后使用它的容量来格式化输出。

```
$dom = dom_import_simplexml($simple_xml)->ownerDocument;
$dom->preserveWhiteSpace = false;
$dom->formatOutput = true;
echo $dom->saveXML(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-06-07T00:21:02.127

正如[秋葵](https://stackoverflow.com/users/53114/gumbo)和[威特曼](https://stackoverflow.com/users/218120/witman)回答的那样；[使用DOMDocument::load](http://www.php.net/manual/en/domdocument.load.php)和[DOMDocument::save](http://www.php.net/manual/en/domdocument.save.php)从现有文件（我们这里有很多新手）加载和保存 XML 文档。

```
<?php
$xmlFile = 'filename.xml';
if( !file_exists($xmlFile) ) die('Missing file: ' . $xmlFile);
else
{
  $dom = new DOMDocument('1.0');
  $dom->preserveWhiteSpace = false;
  $dom->formatOutput = true;
  $dl = @$dom->load($xmlFile); // remove error control operator (@) to print any error message generated while loading.
  if ( !$dl ) die('Error while parsing the document: ' . $xmlFile);
  echo $dom->save($xmlFile);
}
?> 
```

# .net - 如何识别 DLL 是 Debug 还是 Release 构建（在 .NET 中）

> ID：798971
> 
> 赞同：113
> 
> 时间：2009-04-28T17:13:12.620
> 
> 标签：.net, dll, build, debugging, release

> **可能重复：**
> [如何判断 .NET 应用程序是在 DEBUG 还是 RELEASE 模式下编译的？](https://stackoverflow.com/questions/194616/how-to-tell-if-a-net-application-was-compiled-in-debug-or-release-mode)

我确定以前有人问过这个问题，但是谷歌和 SO 搜索让我失败了。

如何识别 DLL 是发布版本还是调试版本？

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2011-03-15T18:55:54.403

恕我直言，上述应用程序确实具有误导性；它只查找完全独立于代码是否为优化和 JIT 优化而编译的 IsJITTrackingEnabled。

如果您在发布模式下编译并将 DebugOutput 选择为“none”以外的任何内容，则会出现 DebuggableAttribute。

您还需要*准确*定义“调试”与“发布”的含义......

你的意思是应用程序配置了代码优化？您的意思是您可以将 VS/JIT 调试器附加到它吗？你的意思是它会生成DebugOutput吗？你的意思是它定义了 DEBUG 常量吗？请记住，您可以使用 System.Diagnostics.Conditional() 属性有条件地编译方法。

恕我直言，当有人询问程序集是“调试”还是“发布”时，他们的真正意思是代码是否经过优化......

Sooo，您想手动还是以编程方式执行此操作？

**手动**：您需要查看程序集元数据的 DebuggableAttribute 位掩码的值。这是如何做到的：

1.  在 ILDASM 中打开程序集
2.  打开清单
3.  查看 DebuggableAttribute 位掩码。如果 DebuggableAttribute 不存在，它肯定是一个优化程序集。
4.  如果它存在，请查看第 4 个字节 - 如果它是“0”，则它是 JIT 优化的 - 其他任何东西，它都不是：

> // 元数据版本：v4.0.30319 .... // .custom 实例 void [mscorlib]System.Diagnostics.DebuggableAttribute::.ctor(valuetype [mscorlib]System.Diagnostics.DebuggableAttribute/DebuggingModes) = ( 01 00 02 **00** 00 00 00 00)

**以编程**方式：假设您想以编程方式了解代码是否经过 JIT 优化，这是正确的实现（在简单的控制台应用程序中）：

```
void Main()
{
    var HasDebuggableAttribute = false;
    var IsJITOptimized = false;
    var IsJITTrackingEnabled = false;
    var BuildType = "";
    var DebugOutput = "";

    var ReflectedAssembly = Assembly.LoadFile(@"path to the dll you are testing");
    object[] attribs = ReflectedAssembly.GetCustomAttributes(typeof(DebuggableAttribute), false);

    // If the 'DebuggableAttribute' is not found then it is definitely an OPTIMIZED build
    if (attribs.Length > 0)
    {
        // Just because the 'DebuggableAttribute' is found doesn't necessarily mean
        // it's a DEBUG build; we have to check the JIT Optimization flag
        // i.e. it could have the "generate PDB" checked but have JIT Optimization enabled
        DebuggableAttribute debuggableAttribute = attribs[0] as DebuggableAttribute;
        if (debuggableAttribute != null)
        {
            HasDebuggableAttribute = true;
            IsJITOptimized = !debuggableAttribute.IsJITOptimizerDisabled;

            // IsJITTrackingEnabled - Gets a value that indicates whether the runtime will track information during code generation for the debugger.
            IsJITTrackingEnabled = debuggableAttribute.IsJITTrackingEnabled;
            BuildType = debuggableAttribute.IsJITOptimizerDisabled ? "Debug" : "Release";

            // check for Debug Output "full" or "pdb-only"
            DebugOutput = (debuggableAttribute.DebuggingFlags &
                            DebuggableAttribute.DebuggingModes.Default) !=
                            DebuggableAttribute.DebuggingModes.None
                            ? "Full" : "pdb-only";
        }
    }
    else
    {
        IsJITOptimized = true;
        BuildType = "Release";
    }

    Console.WriteLine($"{nameof(HasDebuggableAttribute)}: {HasDebuggableAttribute}");
    Console.WriteLine($"{nameof(IsJITOptimized)}: {IsJITOptimized}");
    Console.WriteLine($"{nameof(IsJITTrackingEnabled)}: {IsJITTrackingEnabled}");
    Console.WriteLine($"{nameof(BuildType)}: {BuildType}");
    Console.WriteLine($"{nameof(DebugOutput)}: {DebugOutput}");
} 
```

我在我的博客上提供了这个实现：

**[如何判断程序集是调试还是发布](http://dave-black.blogspot.com/2011/12/how-to-tell-if-assembly-is-debug-or.html)**

* * *

## 回答 #2

> 赞同：95
> 
> 时间：2009-04-28T17:15:19.337

唯一最好的方法是检查编译的程序集本身。Rotem Bloom[在这里](https://github.com/jozefizso/AssemblyInformation)找到了一个非常有用的工具，称为“.NET 程序集信息” 。安装后，它会将自身与 .dll 文件关联以自行打开。安装后，您只需双击程序集即可打开，它将为您提供程序集详细信息，如下面的屏幕截图所示。在那里您可以确定它是否已调试编译。

希望这可以帮助..

# c# - 我应该将费用/折扣列表合并到订单类别中还是让它们成为项目行

> ID：798973
> 
> 赞同：7
> 
> 时间：2009-04-28T17:13:38.127
> 
> 标签：c#, oop

我没有其他开发人员可以寻求建议或“你怎么看 - 我在想*这个*”，所以如果你有时间，请阅读并让我知道你的想法。

展示比描述更容易，但该应用程序本质上类似于一个具有 3 个主要部分的销售点应用程序：项目、订单项和订单。

项目类是来自数据存储的数据。

```
public class Item 
    : IComparable<OrderItem>, IEquatable<OrderItem>
{
    public Int32 ID { get; set; }
    public String Description { get; set; }
    public decimal Cost { get; set; }

    public Item(Int32 id, String description, decimal cost) 
    { 
        ID = id; 
        Description = description; 
        Cost = cost;
    }
    // Extraneous Detail Omitted
} 
```

订单项目类是订单上的项目行。

```
public class OrderItem 
    : Item, IBillableItem, IComparable<OrderItem>, IEquatable<OrderItem>
{
    // IBillableItem members
    public Boolean IsTaxed { get; set; } 
    public decimal ExtendedCost { get { return Cost * Quantity; } } 

    public Int32 Quantity { get; set; }

    public OrderItem (Item i, Int32 quantity) 
        : base(i.ID, i.Description, i.Cost) 
    {
        Quantity = quantity;

        IsTaxed = false;
    }
    // Extraneous Detail Omitted
} 
```

目前，当您向订单添加费用或折扣时，它非常简单：

```
Order order = new Order();
// Fee
order.Add(new OrderItem(new Item("Admin Fee", 20), 1));

// Discount
order.Add(new OrderItem(new Item("Today's Special", -5), 1)); 
```

我喜欢它，这是有道理的，Order 继承的基类遍历列表中的项目，计算适当的税款，并允许其他 Order 类型的文档（其中有 2 个）从计算的基类继承所有这一切都没有重新实现任何东西。如果订单类型的文档没有折扣，那么只需不添加 -$ 值 OrderItem 即可。

我遇到的唯一问题是显示这些数据。进行此操作的表格有一个网格，其中应显示销售项目（即不是费用/折扣）。同样，某些费用和某些折扣也有文本框。我非常想将这些 ui 元素数据绑定到此类中的字段，以便用户（和我）更容易。

*我的想法*

有 2 个接口：IHasFees、IHasDiscounts 并让 Order 实现它们；两者都有一个 List 成员。这样，我只能访问销售项目、费用和折扣（如果需要，可以将它们绑定到控件）。

我不喜欢它的地方： - 现在我为该类提供了 3 种不同的添加/删除方法（AddItem/AddFee/AddDiscount/Remove...） - 我正在复制（三重复制？）所有这些功能只是相同类型项目的列表，只是每个列表具有不同的含义。

我在正确的道路上吗？我怀疑这对大多数人来说是一个已解决的问题（考虑到这种类型的软件很常见）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T17:29:41.190

我将向您指出 Rob Connery 在不久前收听的 ALT.net 播客上的一句话（我不是 ALT.net 的拥护者，但推理似乎很合理）：

什么对“商业用户”有意义（如果你身边有这样的人）。

作为一名程序员，你会想要考虑项目、费用、折扣等，因为它们具有相似的属性和行为。

但是，就模型而言，它们可能是两个完全不同的概念。稍后会有人来，说“但这没有意义，它们是不同的东西，我需要单独报告它们，在这种情况下我需要将这个特定规则应用于折扣”。

DRY 并不意味着限制您的模型，在通过继承或类似方式考虑行为时，您应该注意这一点。

在这种情况下使用的具体示例是购物车。程序员的自然想法是使用未提交状态的订单。这是有道理的，因为它们看起来完全一样。除了他们不是。这对客户来说毫无意义，因为它们是两个独立的概念，它只会让设计变得不那么清晰。

这是一个实践、品味和意见的问题，所以不要盲目地听从网站上发布的建议:)

对于您的具体问题，我使用的系统使用项目、费用、订单项折扣（项目的属性）和订单的全局折扣（虽然它不是订单，它是 POS 收据，但这并不重要在这种情况下）。

我想原因是，在这些概念背后，物品是库存件的具体实例，它们影响库存数量，它们是可枚举和可量化的。

费用不是。他们不共享大多数属性。

在您的情况下可能无关紧要，因为您的域似乎比这更有限，但您可能希望牢记这些问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T17:30:29.800

实际上，我会仔细查看您的设计并尝试找出**行为**所在；然后将这些行为中的任何共性提取到一个不同的界面中，并确保它适用于您的设计。

以机智; 费用可能具有与之关联的相关验证行为。假设您向任何包含 20 件或更多商品的订单添加费用（只是一个随机示例，请与我一起在这个上运行）。现在，当您添加第 20 项时，您可能希望将该费用添加到订单中，但是有一个问题；当您从订单中删除商品时，您是否希望每次都检查是否需要从订单中删除该费用？我对此表示怀疑; 这意味着存在与费用/折扣相关的行为，这基本上使它们成为完全不同的一类事物。

我会这样看；将费用和折扣分类为“特殊”事物，然后创建一个“ISpecial”接口，费用和折扣都从该接口继承。将任何常用功能提取到 ISpecial 接口（例如，“Validate”）。然后让您的 Order 实现 ISpecial（或其他）接口。

通过这种方式，您可以定义特定的 Fee.Validate() 行为和 Discount.Validate 行为，并借助多态的魔力（foreach of m_specialCollection .validate 这些）正确操作。通过这种方式，您也可以轻松地将 Special 接口扩展为任何其他可能需要的东西（例如，税收）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-28T19:01:01.237

我认为您在这里面临的问题的核心是您已经实现`OrderItem`为 的子类`Item`，现在您发现这并不总是合适的。

鉴于您的描述，这就是我尝试实现的方法：

创建一个`Order`类，为要公开给数据绑定的每个单值数据元素实现公共属性：订单号、日期、客户、总费用、总折扣等。听起来您可能需要显示*特定*费用/折扣为单一值；如果是这样，请为这些实现公共属性。

创建一个抽象`OrderItem`类，为要在网格中绑定的每个数据元素以及要对其进行排序的每个数据元素实现公共属性。（您也可以将其设为一个`IOrderItem`接口；这实际上取决于是否会有所有订单项共有的方法。）

为可以出现在订单上的特定类型的订单项 创建子类`OrderItem`（或实现的类）： 、、等。`IOrderItem``ProductOrderItem``FeeOrderItem``DiscountOrderItem`

在你的实现中`ProductItem`，实现一个类型的属性`Item`——它看起来像：

```
public class ProductItem : OrderItem
{
   public Item Item { get; set; }
   public string Description { get { return Item.Description; } }
   public int Quantity { get; set; }
   public decimal Amount { get { return Item.Price * Quantity; } }
} 
```

实现一个内部类型的属性`IEnumerable<OrderItem>`来`Order`存储所有的行项目。实现`AddItem`添加的方法`OrderItems`，例如：

```
public void AddItem(OrderItem item)
{
   _Items.Add(item); // note that backing field is a List<OrderItem>
} 
```

你可以很简单地调用它：

```
Order o = new Order();
o.AddItem(new ProductOrderItem { Item = GetItem(1), Quantity = 2 });
o.AddItem(new FeeItem { Description = "Special Fee", Amount = 100 });
o.AddItem(new DiscountItem { DiscountAmount = .05 }); 
```

编写需要从此列表中提取值的那些单值字段的实现，例如：

```
public decimal TotalFees
{
   get
   {
      return (from OrderItem item in Items
              where item is FeeItem
              select item.Amount).Sum();
   }
} 
```

您可以稍后再回来并在必要时优化这些属性（例如，一旦完成一次就保存计算）。

请注意，您也可以限制`AddItem`添加`ProductItem`s，并使用 中的其他方法`Order`添加其他类型的项目。例如，如果一个订单只能有一个折扣金额：

```
public void SetDiscountAmount(decimal discountAmount)
{
   DiscountOrderItem item = _Items
      .Where(x => x is DiscountOrderItem)
      .SingleOrDefault();
   if (item == null)
   {
       item = new DiscountOrderItem();
       _Items.Add(item);
   }
   item.DiscountAmount = discountAmount;
} 
```

You'd use this approach if you wanted to display the discount amount in the appropriate place in the grid of order items, but also wanted an order's discount amount to be a single value. (It's arguable that you might want to make `DiscountAmount` a property of the `Order`, create the `DiscountOrderItem` in its setter, and have `DiscountOrderItem` get its `Amount` from `Order.DiscountAmount`. I think both approaches have their pros and cons.)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T17:21:59.243

一种选择是将 ItemType 属性添加到 OrderItem

```
enum ItemType
{
   Item,
   Fee,
   Discount
} 
```

现在您可以在您的订单类中拥有：

```
public IList<OrderItem> Fees
{
   get
   {
      return _items.Find(i=>i.ItemType==ItemType.Fee);
   }
} 
```

现在您仍然可以保留您的单个列表并避免额外的接口。您甚至可以使用 IList GetItems(ItemType type) 之类的方法。

另一种想法是您当前的设计不允许 % 的折扣。今天你可以享受 10% 的折扣。这可能不是必需的，但避免应用程序必须计算这一点的一种选择是将项目与折扣分开。

如果我订购 10 件商品可享受 5% 的折扣，折扣甚至可能会成为更多规则。

# build - 处理黑莓开发中的依赖关系

> ID：798974
> 
> 赞同：3
> 
> 时间：2009-04-28T17:13:52.430
> 
> 标签：build, blackberry, java-me

如何处理`.jad`文件中的第 3 方依赖项？可以捆绑一个 `.jar`吗？你需要解压它并包含`.class`文件吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-08T07:38:24.737

请参阅使用[kXML2](http://kxml.sourceforge.net/)开源库的方法：

*   对于发布，您必须预先验证它并使用 ant 构建项目：
    [Ahmad Ferdous Bin Alam - 如何将 kxml jar 文件导入您的项目](http://ahmadferdous.blogspot.com/2009/03/how-to-import-kxml-jar-file-to-your.html)
    [Slashdev - 使用 Ant 和 Eclipse 进行 BlackBerry 开发](http://www.slashdev.ca/2007/05/30/blackberry-development-with-ant-eclipse/)
    **更新：**[教程：如何在应用程序中使用 3rd 方库](http://supportforums.blackberry.com/rim/board/message?board.id=java_dev&message.id=22441)
*   对于调试，您必须将[kXML 源](http://sourceforge.net/project/downloading.php?group%5Fid=9157&filename=kxml2-src-2.3.0.zip&a=104174)和[org.xmlpull.v1 源](http://www.xmlpull.org/v1/download/xmlpull%5F1%5F1%5F3%5F4c%5Fsrc.zip)添加到您的 BB 项目

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-30T15:35:58.890

JAR 文件不能与 COD 文件合并。您首先需要将这些 JAR 文件转换为 COD 文件（您也应该对它们进行签名）。如果应该将其他 JAR 文件用作库 COD 文件，则需要使用`-library`开关而不是`-midlet`rapc.exe 编译器。

获得 COD 文件后，您需要在 JAD 文件中引用所有 COD 文件，包括文件大小。COD 文件可能如下所示：

```
Manifest-Version: 1.0
MIDlet-Data-Size: 2048
MIDlet-Version: 1.4.1
MIDlet-Jar-Size: 136999
MIDlet-Icon: /icons/myprogram.png
MicroEdition-Configuration: CLDC-1.1
MIDlet-Jar-URL: myprogram.jar
MIDlet-Name: myprogram
MIDlet-1: myprogram,/icons/myprogram.png,com.stackoverflow.myprogram
MicroEdition-Profile: MIDP-2.0
MIDlet-Vendor: My Company
Ant-Version: Apache Ant 1.6.5
Skylab-Build-Number: 2968:2970
Created-By: 1.5.0_01-b08 (Sun Microsystems Inc.)
RIM-COD-Module-Dependencies: net_rim_cldc,lib_1,lib_2,lib_3,lib_4,net_rim_locationapi
RIM-COD-URL: myprogram.cod
RIM-COD-Size: 77576
RIM-COD-URL-1: myprogram-1.cod
RIM-COD-Size-1: 29960
RIM-COD-URL-2: lib_1.cod
RIM-COD-Size-2: 28668
RIM-COD-URL-3: lib_2.cod
RIM-COD-Size-3: 8712
RIM-COD-URL-4: lib_3.cod
RIM-COD-Size-4: 18232
RIM-COD-URL-5: lib_4.cod
RIM-COD-Size-5: 12752
RIM-MIDlet-Flags-1: 0
RIM-MIDlet-Position-1: 0
RIM-COD-Module-Name: myprogram
RIM-MIDlet-NameResourceId-1: 0
RIM-COD-Creation-Time: 1143020761
RIM-COD-SHA1: 0b 9f b1 da 47 bc 6f 97 62 eb 32 66 77 ca a9 6f 24 4d 10 8a 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T13:56:03.957

不能对 J2ME 说太多，但对于 BlackBerry，您可以将编译的 .jar 文件转换为 .cod 文件（BlackBerry 二进制文件格式 - 基本上是优化的 .jar），并将这些文件与您的应用程序 .cod 文件一起包含。您必须在 .jad 中列出其他 .cod 文件。

来自 BlackBerry 知识库的[此链接应该会有所帮助。](http://www.blackberry.com/knowledgecenterpublic/livelink.exe/fetch/2000/348583/800901/How_To_-_Compile_a_JAR_file_into_a_BlackBerry_Library.html?nodeid=801017&vernum=0)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-11T13:35:42.550

如果库不是 BlackBerry COD 文件而是普通的 MIDP 2.0 JAR 文件，那么将其与应用程序捆绑在一起所需要做的就是使用 Eclipse JDE 插件执行以下操作：

1.  右键单击您的项目文件并选择：“**构建路径**”>“**配置构建路径...** ”。这将打开带有“ **Java Build Path** ”选项的“属性”屏幕。
2.  单击“ **Libraries** ”选项卡并单击“ **Add JARs...** ”（或**“Add External JARs...** ”）并在下一个对话框中选择您想要的 JAR，然后单击“ **OK** ”。您应该会看到您在列表中选择的 JAR。
3.  现在，单击“**订购和导出**”选项卡并选中您添加的 JAR 旁边的复选框。这可确保构建步骤实际将此 JAR 文件合并到您的应用程序输出中，并创建一个包含两者的 COD 文件。

上述方法对我有用，但有两个问题：

1.  每次我更改与项目的“ **BlackBerry 项目属性**”相关的任何内容（例如更改应用程序的*标题*或*版本*）时，此设置都会恢复，因此我必须再次检查。这是一个主要的不便，但要遵循的步骤并不复杂。
2.  [您必须按照此答案](https://stackoverflow.com/questions/798974/handling-dependencies-in-blackberry-development/963802#963802)中给出的[kXML2 链接](http://ahmadferdous.blogspot.com/2009/03/how-to-import-kxml-jar-file-to-your.html)中的说明预先验证您包含的 JAR 文件。不这样做会导致随机验证错误（随机的意思是我不会一直得到它们）。

# .net - Smart Client 和 Web App 同时开发

> ID：798981
> 
> 赞同：1
> 
> 时间：2009-04-28T17:15:17.433
> 
> 标签：.net, web-applications, smartclient

如果正在开发的应用程序需要具有 Web 客户端和智能客户端，则要使用哪些策略和工具。智能客户端软件工厂或相关应用程序块是否简化了这样的开发路径？环境是.Net 3.5

请根据这些优先级提出方向

1.  代码重用
2.  开发或执行容易
3.  维护

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-15T14:46:27.787

你能用银光吗？如果是，您可以在 Web 和桌面上拥有相同的客户端（使用新的 Silverlight 3 浏览器体验）

如果没有，您可以重用服务器中的所有业务逻辑并通过 Web 服务公开功能。
这样您的系统是可测试的，您只需要重新编码不同的客户端 UI。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T17:30:10.630

Silverlight 和 WPF 非常相似，您应该能够在两者之间实现极高程度的代码重用。见这篇[文章](http://msdn.microsoft.com/en-us/magazine/cc895632.aspx)。

在下一个版本中它会变得更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T17:37:41.220

寻找模型视图演示者模式......如果正确完成，您只需要实现多个视图，其余的东西将被重用！

# ruby-on-rails - 将 Flex 和 Rails 结合起来有什么好的理由吗？

> ID：798983
> 
> 赞同：0
> 
> 时间：2009-04-28T17:15:22.503
> 
> 标签：ruby-on-rails, ruby, apache-flex

既然 Rails 已经是一个有效的富 Internet 应用程序框架，因为它使 Ajax 变得如此简单，那么将 Rails 与 Flex 结合并使用 Flex 作为前端而不是 HTML 的论据是什么？我的一位程序员朋友说他使用这种组合是因为 Flex 非常适合 RIA。我的论点是 Rails 在这方面已经很出色了——为什么还要增加额外的复杂性？这样做的另一个大缺点似乎是，您不能再在前端使用 HTML，因为 Flex 使这非常成问题。对于这种技术组合所提供的任何好处来说，这似乎是一个非常高的代价。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T17:24:41.280

我认为您想根据您的客户端应用程序需要做什么来考虑这一点。如果你可以在 Rails 中完成你需要的一切，那么就没有真正需要去 flex 了。如果您需要更多的客户端控制，那么您可以构建一个 flex 应用程序并使 rails 应用程序只是一个 Web 服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T17:19:03.853

我不知道人们这么多地使用 Flex 和 rails。但使用 Flash/Flex 确实为您提供了更多的处理和可视化能力。此外，您可以从 Flex 获得本机 AMF 支持，以实现高效的数据传输。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T17:23:48.100

这完全取决于您对 RIA（富 Internet 应用程序）的定义。对某些人来说，启用 AJAX 的 Web 应用程序可能符合要求。对于其他人来说，RIA 包括高度风格化的元素、高水平的交互性和大量的动画。

如果您是按照第一个要求进行思考的人之一，那就太好了。支持 AJAX 的 RoR 应用程序足以满足您的 RIA。对于属于第二组的人来说，RoR 是另一种为使用 Flex/Flash 进行演示的 RIA 提供数据后端的方式。

就个人而言，我相信 RoR 与 Flex 的结合将为您提供比标准的支持 AJAX 的 Web 应用程序更丰富、更动态和更有吸引力的 RIA。

# sql-server - 什么是 SQL Server 的良好 XDOC（或 C# 等效）程序/插件样式？

> ID：798987
> 
> 赞同：0
> 
> 时间：2009-04-28T17:16:29.100
> 
> 标签：sql-server, sql-server-2005, documentation, comments, xdoc

我正在寻找一种方法来正确注释我的存储过程代码，以便我可以将信息提取到有用的文档中，比如 XDOC（或 C# 等价物）。最好是轻量级的东西是理想的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T19:02:00.033

为什么不使用可以在简单 SQL 语句中查询的[扩展属性？](http://msdn.microsoft.com/en-us/library/ms190243(SQL.90).aspx)

```
SELECT * FROM sys.extended_properties 
```

不需要任何插件、附加组件或具有特定的存储过程布局......

这是我们用于数据库中每个对象的内容（我们也使用[Red Gate SQL Doc](http://www.red-gate.com/products/SQL_Doc/index.htm)来提供一些结构和一个漂亮的网站）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T17:27:06.610

如果您已经在使用 Sandcastle 根据 Visual Studio 生成的 XML 注释生成文档，您可能需要查看以下 CodeProject 项目：

[SQL XML 文档](http://www.codeproject.com/KB/database/SQL_XML_Documentation.aspx)

它向您展示了如何使用您已经在使用的工具为您的 SQL 对象生成文档，其样式与您已经为其余代码生成的文档的样式相同。

# c# - 防止CSS文件的重复？

> ID：798988
> 
> 赞同：2
> 
> 时间：2009-04-28T17:16:32.923
> 
> 标签：c#, asp.net, css

我有一个实现对 css 文件的引用的用户控件，现在我想在页面上多次使用此用户控件，这将导致 css 文件的重复包含。

对于 javascript 文件，使用`ScriptManager`.

那么您对解决方案或类似方法的建议是`ScriptManager`什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T17:27:05.207

这是我以前使用过的一种技术，尽管它可能不是最好的：

```
 Dim cssLink As String = String.Format("<link rel='stylesheet' type='text/css' href='{0}/css/cssLink.css' />", Request.ApplicationPath)
    If (From c As LiteralControl In Page.Header.Controls.OfType(Of LiteralControl)() Where c.Text = cssLink).Count = 0 Then
        Page.Header.Controls.Add(New LiteralControl(cssLink))
    End If 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T09:59:03.613

由于 q 被标记为 c#，我想我不妨从帮助类中粘贴 c# 版本：

```
 public static void AddStyleLink(string href)
 {
      Page page = (Page)HttpContext.Current.CurrentHandler;        

      var existing = 
          (from c 
          in page.Header.Controls.OfType<HtmlGenericControl>() 
          where c.Attributes["href"] == href
          select c).FirstOrDefault();

      if (existing == null)
      {
          HtmlGenericControl link = new HtmlGenericControl("link");
          link.Attributes.Add("rel", "stylesheet");
          link.Attributes.Add("href", href);
          page.Header.Controls.Add(link);
      }            
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T17:31:33.637

没有像 ClientScript 实用程序那样检查样式是否已注册到页面的简单方法。

如果您将样式注册为外部 css 文件到这样的页面：

```
HtmlLink link = new HtmlLink();
link.Href = relativePath;
link.Attributes["type"] = "text/css";
link.Attributes["rel"] = "stylesheet";
Page.Header.Controls.Add(link); 
```

然后，您可以通过循环页眉的 Controls 集合并查找 CSS 文件的路径来检查它是否存在。

# opengl - 如何使用 Matlab Psychtoolbox (OpenGL) 放大/拉伸纹理？

> ID：798992
> 
> 赞同：2
> 
> 时间：2009-04-28T17:16:55.950
> 
> 标签：opengl, matlab, psychtoolbox

更新：这似乎只是某些计算机的问题。正常、直观的代码在我的家用电脑上似乎可以正常工作，但工作中的电脑有问题。

家用电脑：（没问题）

*   Windows XP 专业版 SP3
*   AMD 速龙 64 X2 3800+ 双核 2.0 GHz
*   英伟达 GeForce 7800 GT
*   2 GB 内存

工作电脑：（这个问题适用于这台电脑）

*   Windows XP 专业版 SP3
*   Intel Pentium 4 2.8 Ghz（我认为是双核）
*   英特尔 82945G Express 芯片组系列
*   1 GB 内存

## 原帖：

我正在尝试使用 Matlab 中的 Psychtoolbox 将一个非常简单的纹理应用于屏幕的一部分，代码如下：

```
win = Screen('OpenWindow', 0, 127); % open window and obtain window pointer
tex = Screen('MakeTexture', win, [255 0;0 255]); % get texture pointer
% draw texture. Args: command, window pointer, texture pointer, source
% (i.e. the entire 2x2 matrix), destination (a 100x100 square), rotation
% (none) and filtering (nearest neighbour)
Screen('DrawTexture', win, tex, [0 0 2 2], [100 100 200 200], 0, 0);
Screen('Flip', win); % flip the buffer so the texture is drawn
KbWait; % wait for keystroke
Screen('Close', win); % close screen 
```

现在我希望看到这个（四个大小相同的正方形）：

[![预期结果](https://i.stack.imgur.com/prDb5.png)](https://i.stack.imgur.com/prDb5.png)

但相反，我得到了这个（右侧和底部被切断，左上角太大）：

[![实际结果](https://i.stack.imgur.com/ztuqH.png)](https://i.stack.imgur.com/ztuqH.png)

显然目标矩形比源矩形大很多，所以需要放大纹理。我希望这会像第一张图片一样对称地发生，这也是我需要的。为什么这没有发生，我能做些什么呢？

我也尝试使用 [128 0 1152 1024] 作为目标矩形（因为它是我屏幕中心的正方形）。在这种情况下，所有边都是 1024，这使得每个涉及的矩形都是 2 的幂。这没有帮助。增加棋盘的大小会导致类似的情况，即无法正确显示右侧和最底部。

就像我说的，我使用 Psychtoolbox，但我知道它在后台使用 OpenGL。我对 OpenGL 也不太了解，但也许有人可以在不了解 Matlab 的情况下提供帮助。我不知道。

谢谢你的时间！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T17:43:43.543

虽然我不太了解（阅读：任何）Matlab，但我知道纹理在 openGL 中非常挑剔。最后我检查了一下，openGL 要求纹理文件是正方形的并且是 2 的幂（即 128 x 128、256 x 256、512 x 512）。

如果不是，openGL 应该在需要满足此条件的地方使用适当的白色像素填充文件，尽管根据您在哪个系统上运行它可能是一个废话。

我建议确保您的棋盘格纹理符合这些要求。

另外，我不能从您发布的代码中完全确定，但是openGL希望您将纹理的角映射到您打算纹理化的对象的角。

另一个建议，也许尝试使用线性过滤器而不是最近邻。它的计算量更大，但会产生更好的图像。这可能最终不会有什么影响。

虽然这个帮助不是 Matlab 特定的，但希望它有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T17:57:45.350

在不了解 Psychtoolbox 的情况下，但在 MATLAB 中处理了很多图形和用户界面后，我会尝试的第一件事是摆弄**Screen**的第四个输入（“源”输入）。尝试将每个角移动半像素和全像素值。例如，我会尝试的第一件事是：

```
Screen('DrawTexture', win, tex, [0 0 2.5 2.5], [100 100 200 200], 0, 0); 
```

如果这似乎没有任何作用，我接下来会尝试：

```
Screen('DrawTexture', win, tex, [0 0 3 3], [100 100 200 200], 0, 0); 
```

我对这个建议的推理：我注意到有时我的图形中的图像或 GUI 控件似乎偏离了一个像素，我只能推测在缩放或定位它们时会出现某种舍入错误。

这是我能给的最好的建议。希望能帮助到你！

# jquery - IE6 CSS 的问题

> ID：798998
> 
> 赞同：0
> 
> 时间：2009-04-28T17:18:44.900
> 
> 标签：jquery, css, internet-explorer-6

我对 IE6 和 jquery 滑块有疑问。请点击以下链接，而不是点击右下角的“dodaj u košaricu”按钮。之后单击“košarica”选项卡并尝试上下移动滑块。一些元素保持固定的位置。

[链接文本](http://www.fckids.hr/kolekcija.php?action=no&type=single&nav=2&articleId=304)

在 IE6 中，除了表格和文本之外的所有元素都保持固定，在 IE7 中只有水平滑块，在 FF 中一切正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T08:41:35.470

虽然我通常反对“你不想这样做*，*你想这样做*”*的答案，但在这种情况下我必须破例。

界面元素（滚动条、按钮、滑块等）要么具有预期用途，要么具有约定俗成的用途。如果您遵守约定，您将使用户的事情变得更容易，而您自己的事情也会变得不那么复杂。

在这种情况下，您使用滑块来选择要购买的物品的数量。也就是说，您希望用户指定一个离散的整数值。

滑块非常适合（伪）模拟值，例如音量。在这种情况下，用户知道有一个下限（没有声音）和一个上限（很多声音），但通常无法在两者之间指定任何所需的级别。用户不会以 +1 或 -1 音量的概念来思考，而是会以“多一点”或“少一点”的方式思考。

对于离散值，滑块适用于从预定义的集合中选择一个值：

[![替代文字](https://upload.wikimedia.org/wikipedia/commons/e/ed/Slider_(computing)_example.PNG)](http://en.wikipedia.org/wiki/File:Slider_(computing)_example.PNG)

滑块不是选择无界整数值的最佳选择。当然，用户可以假设最左边的位置为零，但最右边的位置表示什么？滑块是否从*零*变为*全部*？什么是*全部*？

除了在滑块不清楚的情况下选择的值的选择之外，用户不会期望滑块用于此目的。

您应该真正简化界面以使用户和您自己受益。

一个标准的文本输入就足够了。人们知道这些做什么，会理解在标记为“数量”的字段中输入文本的目的（啊 - 我输入我想要的数字）并且不会混淆。

这将大大简化您自己的开发和维护过程。与滑块相比，实现文本输入需要多长时间？标准文本输入会出现什么问题？大概什么都没有。自定义滑块会出现什么问题？好吧，正如我们所看到的，根据浏览器的不同，各种事情可能会出错。

从“哇 - 它有效！” 透视滑块看起来很酷，但用户不会在意（他们是非常善变的生物）。用户不会认为“滑块 - 多么酷，我必须再次在这里购物”。用户会认为“这个网站甚至不让我选择数量 - 我根本不会在这里购物”。

保持简单。**********