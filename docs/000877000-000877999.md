# StackOverflow 问答 000877000-000877999

# integer - ML中数字的素数

> ID：877000
> 
> 赞同：-1
> 
> 时间：2009-05-18T10:04:06.110
> 
> 标签：integer, primes, sml, prime-factoring

在 ML 中，我想得到一个数字的主要除数。我该怎么做，我是初学者。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-26T21:15:09.113

使用简单的试除法，它以 开始`p=2`并重复除以`n`，并随着它的进行`p`递增`p`。

```
open LargeInt  (* if you want to work with huge numbers like 5000000000 *)
infix 7 quot rem
val prime_factors =
  let fun trial_division p n =
    if p > n then nil else
      if n rem p = 0
        then p :: trial_division  p      (n quot p)
        else      trial_division (p + 1)  n
  in trial_division 2 end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T10:18:50.030

有几种通用算法可以找到整数的主要除数：参见[wikipedia](http://en.wikipedia.org/wiki/Integer_factorization)。带有简单素性检验的[试除法是最容易理解的。](http://en.wikipedia.org/wiki/Trial_division)

在伪代码中查找或设计算法；只有这样才担心如何将其放入 ML 中。

# sql - 如何在 Subsonic 2.0 中构建复杂的 where 子句

> ID：877003
> 
> 赞同：1
> 
> 时间：2009-05-18T10:05:26.263
> 
> 标签：sql, subsonic

我正在尝试构建一个用于搜索引擎的查询，看起来像这样：

```
SELECT * FROM sometable
WHERE col1 = 1
AND   col2 = 2
AND   (col3a = 3 OR col3b = 3 OR col3c = 3) 
```

我虽然下面的代码可以工作：

```
SubSonic.Query query = new SubSonic.Query("sometable");
query = query.WHERE("col1", 1);
query = query.WHERE("col2", 2);
query = query.AND("col3a = " + 3).
  OR("col3b = " + 3).
  OR("col3c = " + 3); 
```

但它不会导致这样的结果：

```
SELECT * FROM sometable
WHERE col1 = 1
AND   col2 = 2
AND   col3a = 3
OR    col3b = 3
OR    col3c = 3 
```

如何构建我需要的查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T12:08:17.983

如果 2.0 支持 OpenExpression/CloseExpression，则以下内容应该与您想要的非常接近：

```
SubSonic.Query query = new SubSonic.Query("sometable");
  .WHERE("col1", 1);
  .AND("col2", 2);
  .AND("col3a = " + 3).
  .OpenExpression()
    .OR("col3b = " + 3).
    .OR("col3c = " + 3);
  .CloseExpression() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T10:41:38.250

I think you are meant to use WhereExpression/AndExpression/OrExpression to nest expressions reading the documentation but Ive never used it so cant say for sure. Try the below and see if it works

```
SubSonic.Query query = new SubSonic.Query("sometable");
query = query.WHEREEXPRESSION("col1", 1);
query = query.AND("col2 = " + 2);
query = query.ANDEXPRESSION("col3a = " + 3).
  OR("col3b = " + 3).
  OR("col3c = " + 3); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T10:20:25.330

您可以首先创建两个一个查询，其中包括从结果视图中的所有 OR's 之后..您可以过滤掉 AND 条件..我不想检查它..但希望它会工作......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T10:25:42.090

我不知道 SubSonic，但这行得通吗？

query = query.AND("col3a = " + 3 + " OR col3b = " + 3 + " OR col3c = " + 3);

您可以轻松地以编程方式构建该子字符串。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T13:08:24.397

我发现它不像我预期的那么简单，至少在我拥有的版本中没有，所以我决定手动循环遍历 DataSet 以过滤掉上次检查的记录。除非有更好的方法？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T09:37:14.103

我建议你升级到 SubSonic 2.2... 2.1 中添加的新查询功能更强大。

# delphi - Delphi2009 的 PC-SC Wrapper 或 Omnikey Sync API 示例

> ID：877017
> 
> 赞同：2
> 
> 时间：2009-05-18T10:08:19.270
> 
> 标签：delphi, api

[nobbi.com](http://nobbi.com/download.html)的PC-SC 组件似乎不兼容 Delphi 2009。我不得不将 PChars 转换为 PAnsiChars，但我仍然无法正确访问 ReaderList，我所能得到的只是一堆“|”。那么，是否有适用于 Delphi 2009 的 PC-SC 包装器，或适用于 Delphi 的 Omnikey Sync API 的示例应用程序？Sync API 的 C# 示例也很好，因为我可以在 Delphi 下将它们用作 DLL。

我将使用的设备是 Omnikey 5321，主要用于 MIFARE 目的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T15:45:37.130

这是我所知道的 Delphi 的唯一框架。自 2001 年以来，我一直在密切关注，并且没有看到任何更好的东西。

我为金融部门做了一些商业 SC 开发，最后为 Delphi 5/7 推出了我自己的框架。我需要监控卡片更改事件（插入/删除）并最终使用后台线程。该解决方案功能强大且运行良好。

移植到 D2009 应该没有那么困难，因为 API 相对较小。注意结构对齐，当然还有 Unicode。我记得结构对齐需要一些捏造才能正确（即需要填充字节）。

祝你好运！

大卫

# spring - 使用 @Transactional 和 Spring 模板有什么区别？

> ID：877018
> 
> 赞同：9
> 
> 时间：2009-05-18T10:08:55.960
> 
> 标签：spring, spring-mvc

如果我在我的 DAO 中使用 @Transactional，我的所有 EntityManager 查询都会被提交并关闭吗？还是我需要使用 Spring 模板（JPA 模板、Hibernate 模板）？使用 @Transactional 和 Spring 模板有什么区别？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T10:13:05.640

Spring 模板类只是为了提供更好的 API 来执行持久性操作——它们不处理事务。如果要进行事务性操作，要么需要使用@Transactional注解方式，要么使用TransactionTemplate。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T15:58:15.163

使用基于注解的事务划分 ( `@Transactional`) 和`TransactionTemplate`使用基于注释的事务划分 ( `TransactionTemplate`您可以将基于注释的事务划分与 Spring 事务支持或 Spring 容器外部的 AspectJ 事务一起使用。

另请参阅[Spring 中事务的在线文档](http://static.springframework.org/spring/docs/2.5.x/reference/transaction.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T15:51:56.563

当您在正确的 Spring 配置中使用 @transactional 时，Spring 将识别该方法需要一个事务并为您处理事务的创建、提交和关闭。

就像 skaffman 所说，@transactional 不直接与模板类相关联。它们可用于任何可能需要事务的类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T15:42:11.327

你的意思是使用@transactional 将使用提交、关闭或使用spring 事务模板（jpatemplate、hibernatetemplate）封装我的dao 方法吗？

# .net - 远程使用 net.pipe 绑定的 WCF 问题

> ID：877025
> 
> 赞同：3
> 
> 时间：2009-05-18T10:10:59.717
> 
> 标签：.net, wcf, wcf-binding

我编写的 WCF 应用程序有问题。

当客户端和服务器都在同一台机器上时，它运行良好，但是当我尝试在两台单独的机器上使用客户端和服务器运行它时（因为它应该运行），我得到以下异常：

> System.ServiceModel.EndpointNotFoundException：net.pipe://vm101.lab.foo.co.uk/VDNService 上没有可以接受消息的端点侦听。这通常是由不正确的地址或 SOAP 操作引起的。有关更多详细信息，请参阅 InnerException（如果存在）。
> System.IO.PipeException：在您的本地计算机上找不到管道端点“net.pipe://vm101.lab.foo.co.uk/VDNService”。

我不明白的是异常的第二行，它在我的本地机器上找不到终点。终点在另一台机器上，不是我的本地机器，不是吗？

我使用的是网络命名管道绑定 ( `NetNamedPipeBinding`) 而不是 HTTP。

而且 WCF 代码是手动编码的，而不是生成的（据我所知，这是常态，但直到我编写了应用程序之后才知道这一点）。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-18T10:15:09.507

“net.pipe”寻址本地传输。您需要使用不同的绑定来跨机器交谈。您可能想使用 netTcp。

[http://msdn.microsoft.com/en-us/library/ms730879.aspx](http://msdn.microsoft.com/en-us/library/ms730879.aspx)

# objective-c - 在objective-c中写0.1和0.1f有什么区别？

> ID：877029
> 
> 赞同：2
> 
> 时间：2009-05-18T10:12:53.380
> 
> 标签：objective-c

有时我会写一个像这样的浮点数：

0.1

有时我会添加一个 f，例如：

0.1f

似乎这两种方式都有效。我从一些示例代码中选择了 f 。但这实际上有什么好处？我确定它的意思是“浮动”，但我真的需要吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T10:15:49.737

我相信这表明该数字是一个`float`（即单精度浮点数）而不是一个`double`（双精度浮点数），这是默认值，即没有前缀。您可能可以互换使用，因为编译器可以进行隐式转换，但是通过附加后缀，您是显式的，并且很可能在避免转换方面也有一些性能优势。

我对 Obective-C 没有任何直接的了解，但其他几种 C 风格的语言（例如 C#、Java 和 C 本身）就是这种情况，我想这里也完全一样。

# python - 如何为我的 python 脚本创建本地网络服务器？

> ID：877033
> 
> 赞同：18
> 
> 时间：2009-05-18T10:13:26.483
> 
> 标签：python, webserver, simplehttpserver

我正在寻找使用本地网络服务器为用户运行一系列 python 脚本。由于各种不可避免的原因，python 脚本必须在本地运行，而不是在服务器上。因此，我将使用 HTML+浏览器作为前端的 UI，我对此很满意。

因此，我一直在寻找可以执行 python 脚本的轻量级 Web 服务器，它位于机器的后台，最好是作为 Windows 服务。安全性和可扩展性不是高优先级，因为它们都是在小型网络内部运行的。

我应该将本机 python 网络服务器作为 Windows 服务运行（在这种情况下，如何）？还是将 Apache 安装到用户的机器上并像 CGI 一样运行？由于这都是本地的，因此性能也不是问题。

还是我错过了一些明显的东西？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-18T10:19:46.500

不要浪费大量时间创建 Windows 服务。

不要在 Windows Apache 上浪费大量时间。

只需创建一个响应 HTTP 请求的 Python 服务。

查看[https://docs.python.org/2/library/basehttpserver.html](https://docs.python.org/2/library/basehttpserver.html)
[https://docs.python.org/3/library/http.server.html](https://docs.python.org/3/library/http.server.html)版本 3
Python 提供了一个可以扩展的 HTTP 服务器使用您的服务器端方法。

查看[http://docs.python.org/library/wsgiref.html](http://docs.python.org/library/wsgiref.html)
Python 提供了一个 WSGI 参考实现，使您的服务器变得简单且符合标准。

还有[http://fragments.turtlemeat.com/pythonwebserver.php](http://fragments.turtlemeat.com/pythonwebserver.php)

* * *

“我试图*避免*让用户从命令提示符运行 python 东西。”

我看不出单击网页与单击桌面图标有何不同。

一旦您拥有了 Web 服务器，就可以相对容易地启动基于 Python 的 Web 服务器。首先，构建服务器。稍后，您可以确保服务器启动。让我们看看一些方法。

1.  您的用户无法使用随机浏览器打开您的本地页面。他们需要一个书签来启动“localhost:8000/myspecialserverinsteadofthedestop/”该书签可以是一个 .BAT 文件，它 (1) 运行服务器，(2) 使用正确的初始 URL 运行 firefox。

2.  您可以将服务器放在用户的开始-此菜单中。

3.  您可以使您的 Python 程序成为 Windows“服务”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-10T20:09:19.250

最好的方法是使用命令提示符创建自己的本地服务器。

1.  新建一个文件夹说项目
2.  在项目中创建一个新文件夹并将其命名为“cgi-bin”（不带引号）
3.  将 .py 文件粘贴到 cgi-bin 文件夹中
4.  打开 cmd 并切换到要从中运行服务器的目录并键入“python -m CGIHTTPServer”（不带引号）
5.  最小化 cmd 窗口并打开浏览器并输入“localhost:8000/cgi-bin/yourpythonfilename.py”（不带引号）。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-18T10:20:45.017

将本机 python 网络服务器作为 Windows 服务运行应该是轻而易举的事。查看在 python 中编写 windows 服务（win32api、ActiveState python）的文档以及子类化 BaseHttpServer 和 SimpleHttpServer 的文档。

顺便说一句：我在 stackoverflow 上有一个类似的问题：[如何在 BaseHTTPRequestHandler 子类中停止 BaseHTTPServer.serve_forever()？](https://stackoverflow.com/questions/268629/how-to-stop-basehttpserver-serveforever-in-a-basehttprequesthandler-subclass)

基本上，您将 BaseHTTPServer 子类化（无论如何您都必须......）然后......但只需阅读接受的答案 - 它让我走上了正确的轨道！

# c# - Linq PredicateBuilder - 多个 OR

> ID：877034
> 
> 赞同：15
> 
> 时间：2009-05-18T10:13:27.620
> 
> 标签：c#, linq

我正在尝试使用 PredicateBuilder，如此处所述 - [http://www.albahari.com/nutshell/predicatebuilder.aspx](http://www.albahari.com/nutshell/predicatebuilder.aspx)

以下代码

```
var predicate = PredicateBuilder.False<StreetDTO>();

        predicate = predicate.Or(p => p.Locality.Contains(criteria.Locality));
        predicate = predicate.Or(p => p.Name.Contains(criteria.Name));
        predicate = predicate.Or(p => p.Town.Contains(criteria.Town));

        List<StreetDTO> streetData = StreetData.Instance();

        var streetList = from street in streetData.Where(predicate)
                         select street; 
```

据我所知，这*应该*可行，根据示例

```
var newKids  = Product.ContainsInDescription ("BlackBerry", "iPhone");

var classics = Product.ContainsInDescription ("Nokia", "Ericsson")
                      .And (Product.IsSelling());
var query =
  from p in Data.Products.Where (newKids.Or (classics))
  select p; 
```

但我得到的只是

> 错误 1 ​​无法从用法中推断方法“System.Linq.Enumerable.Where(System.Collections.Generic.IEnumerable, System.Func)”的类型参数。尝试明确指定类型参数。

我试图在 LINQ 'on-the-job' 中获得一些理解，如果这是一个简单的问题，我深表歉意。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-18T10:24:39.207

啊; 您的列表正在使用`IEnumerable<T>`扩展方法（而不是`IQueryable<T>`） - 尝试：

```
var streetList = from street in streetData.AsQueryable().Where(predicate)
                 select street; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-18T10:23:22.670

尝试编译您的谓词：

```
var streetList = from street in streetData.Where(predicate.Compile())
                 select street; 
```

# c# - 将强类型视图数据传递给asp.net-mvc中的查看页面

> ID：877049
> 
> 赞同：1
> 
> 时间：2009-05-18T10:18:19.203
> 
> 标签：c#, asp.net-mvc

我是否必须手动将我的强类型视图数据传递给调用 return View(); ?

IE。

```
MyViewData vd = new MyViewData();

vd.Blah = "asdf asdfsd";

return View(); 
```

看来如果我将它作为参数传递，我还必须重复视图名称？

```
return View("index", vd); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T10:35:11.727

您可以简单地将模型传递给 View 方法：

```
MyViewData vd = new MyViewData();

vd.Blah = "asdf asdfsd";

return View(vd); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T10:21:46.763

通常你不必手动传递它，但你的模型必须有一个没有参数的构造函数。否则框架将不知道您希望它传递什么值。

至于传递视图名称，只需检查所有方法重载即可。如果有一个只有模型作为参数，那么您可以省略视图名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T10:27:09.840

你可以这样做：

```
public ActionResult Action()
{
    var vd = new MyViewData();

    vd.Blah = "asdf asdfsd";

    ViewData.Model = vd;

    return View();
} 
```

# wpf - 使用列数据填充 GridView 标题中的 ComboBox

> ID：877052
> 
> 赞同：2
> 
> 时间：2009-05-18T10:19:31.087
> 
> 标签：wpf, gridview, combobox

我想在我的（当前在 a 内部）`ComboBox`的标题单元格中填充来自该列的数据。使用起来有点像 Excel 中的“自动筛选”功能。`GridView``ListView`

我遇到的问题是我无法从标题单元格内部获取列的数据。目前，我有这样的事情：

```
<Grid>
  <Grid.Resources>
    <DataTemplate x:Key="headerTemplate">
     <StackPanel>
        <ComboBox></ComboBox>
      <TextBlock FontSize="16" Text="{Binding}" Grid.Row="1" HorizontalAlignment="Center"/>
      </StackPanel>
    </DataTemplate>
  </Grid.Resources>
  <ListView Width="400" Height="200">
    <ListView.View>
      <GridView ColumnHeaderTemplate="{StaticResource headerTemplate}">
          <GridViewColumn Header="Name" DisplayMemberBinding="{Binding Name}"/>
          <GridViewColumn Header="Namespace" DisplayMemberBinding="{Binding Namespace}"/>
      </GridView>
    </ListView.View>
    <x:Type TypeName="Visual"/>
    <x:Type TypeName="UIElement"/>
    <x:Type TypeName="FrameworkElement"/>
  </ListView>
</Grid> 
```

但我不确定如何获取数据以填充标题中的组合框。这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T08:18:33.807

一种快速而肮脏的方式是这样的：

```
<Grid.Resources>
    <DataTemplate x:Key="headerTemplate">
        <StackPanel>
            <ComboBox ItemsSource="{Binding Path=Items, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ListView}}}" DisplayMemberPath="{Binding}"/>
            <TextBlock FontSize="16" Text="{Binding}" Grid.Row="1" HorizontalAlignment="Center"/>
        </StackPanel>
    </DataTemplate>
</Grid.Resources> 
```

如果你真的需要一个类似过滤器的列表，你必须弄清楚如何只获得不同的值。

# asp.net-mvc - 迁移到实现 IDataSource 的 asp.net mvc 控件

> ID：877054
> 
> 赞同：3
> 
> 时间：2009-05-18T10:19:55.597
> 
> 标签：asp.net-mvc

鉴于情况：

实现 IDataSource 的用户控件。它有一个或两个文本框和一个按钮。现在，当放在任何页面上并添加一个以 DataSource 为该控件的 GridView 时，您将拥有一个带有 filters 的网格。

我应该如何在 asp.net MVC 中实现这个场景？有什么建议么 ？

我应该提供更多细节吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T14:17:19.190

我认为您偶然发现了 ASP.NET MVC 和 WebForms 之间的定义差异之一。你不能用 MVC 做这种 RAD 拖放类型的东西（现在）。您基本上需要构建自己的 GridView 视图并坚持一些过滤操作（使用 jQuery 或用于客户端过滤的东西）。在这种情况下，用户控件可以变成“局部视图”。

但是，如果这是您经常使用的那种应用程序，我认为切换到 MVC 不会给您带来很多好处（鉴于您提供的上下文信息有限）。

你的问题是“如何”，但我认为更重要的问题是“为什么”。

# python - 求两个数组中相同位置的 1 的个数

> ID：877059
> 
> 赞同：7
> 
> 时间：2009-05-18T10:21:45.763
> 
> 标签：python, list

我有两个清单：

```
A = [0,0,0,1,0,1]
B = [0,0,1,1,1,1] 
```

我想在两个列表中的相同位置找到 1 的数量。

这些数组的答案是 2。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-18T10:29:26.840

更短一点，希望更pythonic的方式：

```
>>> A=[0,0,0,1,0,1]
>>> B=[0,0,1,1,1,1]

x = sum(1 for a,b in zip(A,B) if (a==b==1))
>>> x
2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T10:40:34.320

Motivated by brief need to be perverse, I offer the following solution:

```
A = [0,0,0,1,0,1]
B = [0,0,1,1,1,1]

print len(set(i for i, n in enumerate(A) if n == 1) &
          set(i for i, n in enumerate(B) if n == 1)) 
```

(Drakosha's suggestion is a far more reasonable way to solve this problem. This just demonstrates that one can often look at the same problem in different ways.)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T10:29:06.233

我不是 Python 专家，但是从第一个数组的开始到结束的简单循环有什么问题？

在 C# 中，我会执行以下操作：

```
int match=0;

for (int cnt=0; cnt< A.Count;cnt++)
{
    if ((A[cnt]==B[cnt]==1)) match++;
} 
```

用你的语言可以吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T14:05:20.757

```
[A[i]+B[i] for i in range(min([len(A), len(B)]))].count(2) 
```

基本上这只是创建一个新列表，其中将其他两个的所有元素加在一起。如果总和为 2，则您知道有两个 1（假设列表中只有 0 和 1）。因此只需对 2 执行计数操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T11:23:16.077

使用[SciPy](http://www.scipy.org)：

```
>>> from scipy import array
>>> A=array([0,0,0,1,0,1])
>>> B=array([0,0,1,1,1,1])

>>> A==B
array([ True,  True, False,  True, False,  True], dtype=bool)
>>> sum(A==B)
4

>>> A!=B
array([False, False,  True, False,  True, False], dtype=bool)
>>> sum(A!=B)
2 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T12:17:45.233

这是另一种方法，它利用了数组只包含零和一的事实。

两个向量 x 和 y 的标量积是 sum( x(i)*y(i) ) 产生非零结果的唯一情况是如果 x(i)==y(i)==1 因此使用 numpy

```
from numpy import *
x = array([0,0,0,1,0,1])
y = array([0,0,1,1,1,1])
print dot(x,y) 
```

简单而美好。此方法进行 n 次乘法并添加 n-1 次，但是对于点积（标量积），使用 SSE、GPGPU、矢量化（在此处添加您喜欢的词）有快速实现

我针对这种方法计时了 numpy 方法：

```
sum(1 for a,b in zip(x,y) if (a==b==1)) 
```

并发现对于 1000000 个循环，numpy 版本在 2121 毫秒内完成，而 zip 方法在 9502 毫秒内完成，因此 numpy 版本要快得多

我对效果进行了更好的分析，发现对于数组中的 n 个元素，zip 方法需要 t1 毫秒，点积需要 t2 毫秒进行一次迭代

```
元素拉链点
1 0.0030 0.0207
10 0.0063 0.0230
100 0.0393 0.0476
1000 0.3696 0.2932
10000 7.6144 2.7781
100000 115.8824 30.1305

```

从这些数据中，我们可以得出这样的结论：如果数组中的元素数量（平均而言）超过 350（或者说 1000），则应该考虑使用点积方法。

# java - 更改 cookie JSESSIONID 名称

> ID：877064
> 
> 赞同：58
> 
> 时间：2009-05-18T10:22:54.340
> 
> 标签：java, tomcat, jsessionid

我需要在单个物理框中运行多个 tomcat 服务器。从浏览器访问这些内容时，当用户在应用程序之间切换时，会导致用户注销之前访问的应用程序。这是因为 JSESSIONID cookie 冲突。

一种可能的解决方案是在不同的上下文中运行每个应用程序。不幸的是，我的应用程序无法在上下文路径设置中工作，因为没有任何资源可以通过前面附加的 request.getContextPath() 访问。

这让我更改 cookie JSESSIONID 的名称来解决冲突。有没有办法做到这一点？如果是，如何？

希望我能清楚地说明我的问题。

注意：我所有的应用程序都在同一台机器的不同端口上运行。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2014-06-06T12:18:03.943

Everything is much simpler with Servlet API 3.0.

Now you can configure it in your web.xml:

```
<session-config>
    <cookie-config>
        <name>MY_JSESSIONID_YAHOOOOOO</name>
    </cookie-config>
</session-config> 
```

That's it!

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-12-08T03:17:40.563

以下内容适用于我在 context.xml 文件中的 Tomcat7 上：

```
<Context path="/yourApp" sessionCookieName="custom_session_id"> 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2010-10-28T04:18:38.280

通过使用以下两个系统属性，这可以轻松实现。

*   org.apache.catalina.SESSION_COOKIE_NAME
*   org.apache.catalina.SESSION_PARAMETER_NAME

可以将任何值传递给上述属性以更改默认值。

在这里可以找到带有一些示例脚本的[完整详细信息。](http://www.digizol.com/2010/10/jsessionid-tomcat-cookie-change-default.html)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-05-25T13:16:35.810

Tomcat 7 将其从 org.apache.catalina.SESSION_COOKIE_NAME 移动到主 <Context> 配置上的属性。 [http://tomcat.apache.org/migration-7.html#Session_manager_configuration](http://tomcat.apache.org/migration-7.html#Session_manager_configuration)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-18T12:23:32.117

我认为目前不可能 - 请参阅[https://issues.apache.org/bugzilla/show_bug.cgi?id=42419](https://issues.apache.org/bugzilla/show_bug.cgi?id=42419)

最后一个条目指出“这已在 5.5.x 中修复，并将包含在 5.5.28 以后的版本中”——这是下一个版本——5.5.27 是当前版本。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-18T12:56:38.400

不是 100% 确定这是否可行，但您可以使用该`jvmRoute`属性，该属性通常用于负载平衡/集群环境中，以便负载平衡器能够区分节点。例子：

```
<Engine name="Catalina" defaultHost="localhost" jvmRoute="node1"> 
```

这将最终生成一个类似于“ABCDEF123456.node1”的 JSESSIONID 值。

[文档链接](http://tomcat.apache.org/tomcat-6.0-doc/config/engine.html)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-01-21T15:57:09.593

```
 final SessionCookieConfig sessionCookieConfig = servletContext.getSessionCookieConfig();
    sessionCookieConfig.setSecure(true);
    sessionCookieConfig.setHttpOnly(true);
    // Set __Host- prefix
    sessionCookieConfig.setName("__Host-JSESSIONID"); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-09-11T10:33:19.670

我在 /tomcat/conf/server.xml 的 Tomcat 中找到了它

服务器.xml

```
<Engine name="Catalina" defaultHost="localhost" jvmRoute="instanceName"> 
```

5D33F755D8D75EF7C8E840.instanceName

# php - 免费 RTE [富文本编辑器] 帮助需要集成它

> ID：877067
> 
> 赞同：2
> 
> 时间：2009-05-18T10:23:07.990
> 
> 标签：php, html, rte

在 PHP / html 内容管理系统上工作，发现 Free RTE online，它是一个免费的富文本编辑器。不知道如何将它集成到我自己的东西中。

alrite 有示例代码，但不是很清楚。

任何人以前使用过它或有任何集成它的知识？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T13:26:26.797

RTE 通常很容易嵌入。该过程是为您的 textarea 提供一个 ID，然后通过 Javascript 调用此 textarea 的 ID 来初始化您的 RTE。Javascript 将在页面加载时将此文本区域转换为功能齐全的 RTE。

通常在 RTE 的示例和操作方法中有很好的记录。你用的是哪一个？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T10:46:34.917

我没有，但我使用[http://www.ecardmax.com/index.php?step=Hoteditor](http://www.ecardmax.com/index.php?step=Hoteditor)在我看来它很好用且易于使用，如果它有帮助的话

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T13:05:27.447

你说的那个免费编辑器的 URL 是什么？您是否尝试过例如 FCKEditor？www.fckeditor.net

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T22:49:52.167

谢谢你们的帮助，

我最终选择了现在嵌入并运行的 FCKeditor。花了一段时间才弄清楚如何将它链接到我自己的东西中，但它附带的示例有所帮助。

原来你只是将编辑器目录树种植到你的主要工作文件夹[或任何地方]并编辑'include'函数[php]以将编辑器文件链接到你自己的项目文件。

呵呵，我偶然发现了这个网站，喜欢stackoverflow！

# python - 学习线程概念

> ID：877068
> 
> 赞同：4
> 
> 时间：2009-05-18T10:23:17.023
> 
> 标签：python, c, multithreading

我最近开始使用 C 和 Python 进行线程化，并且想知道任何可用的好的教程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T10:35:53.490

**C - 推荐书籍**

Unix：[Butenhof，David R. - 使用 POSIX(R) 线程编程（Addison-Wesley 专业计算系列）](https://rads.stackoverflow.com/amzn/click/com/0201633922)

Windows：[Hart, Johnson M. - Windows 系统编程（第 3 版）](https://rads.stackoverflow.com/amzn/click/com/0321256190)

**Python - 在线**

[使用 Python 进行线程编程的教程](http://heather.cs.ucdavis.edu/~matloff/Python/PyThreads.pdf)(PDF)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T10:47:48.580

You could write the threading yourself, it could be hard but doing that, you will learn more about threading.

Or you could use a preexisting threading library. It will let you implement threading faster in your application, but you may not learn as much as to what goes on "under the hood".

From your question, I cant see which path you want to take. For the latter, I suggest [boosts threading library](http://www.boost.org/doc/libs/1_39_0/doc/html/thread.html). The other answers hold great links if you prefer the former path.

Good luck. :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T16:47:18.030

我发现[Linux 中的进程间通信：角落和缝隙](https://rads.stackoverflow.com/amzn/click/com/0130460427)对于 C 中的 IPC（和线程）非常有用。

# python - CentOS 5.2 上的 Python 2.6 中缺少 HTTPSConnection 模块

> ID：877072
> 
> 赞同：8
> 
> 时间：2009-05-18T10:24:57.690
> 
> 标签：python, centos

我正在 CentOS 5.2 上玩 Python 应用程序。它使用 Boto 模块与 Amazon Web Services 进行通信，这需要通过 HTTPS 连接进行通信。

当我尝试运行我的应用程序时，我收到一个关于缺少 HTTPSConnection 的错误：“AttributeError: 'module' object has no attribute 'HTTPSConnection'”

谷歌并没有真正返回任何相关的东西，我已经尝试了大多数解决方案，但没有一个能解决问题。

有没有人遇到过类似的事情？

这是回溯：

```
Traceback (most recent call last):
File "./chatter.py", line 114, in <module>
    sys.exit(main())
File "./chatter.py", line 92, in main
    chatter.status( )
File "/mnt/application/chatter/__init__.py", line 161, in status
    cQueue.connect()
File "/mnt/application/chatter/tools.py", line 42, in connect
    self.connection = SQSConnection(cConfig.get("AWS", "KeyId"), cConfig.get("AWS", "AccessKey"));
File "/usr/local/lib/python2.6/site-packages/boto-1.7a-py2.6.egg/boto/sqs/connection.py", line 54, in __init__
    self.region.endpoint, debug, https_connection_factory)
File "/usr/local/lib/python2.6/site-packages/boto-1.7a-py2.6.egg/boto/connection.py", line 418, in __init__
    debug,  https_connection_factory)
File "/usr/local/lib/python2.6/site-packages/boto-1.7a-py2.6.egg/boto/connection.py", line 189, in __init__
    self.refresh_http_connection(self.server, self.is_secure)
File "/usr/local/lib/python2.6/site-packages/boto-1.7a-py2.6.egg/boto/connection.py", line 247, in refresh_http_connection
    connection = httplib.HTTPSConnection(host)
AttributeError: 'module' object has no attribute 'HTTPSConnection' 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-18T11:38:46.187

引用 python 文档（[http://docs.python.org/library/httplib.html](http://docs.python.org/library/httplib.html)）：

**注意**HTTPS 支持仅在套接字模块使用 SSL 支持编译时可用。

您应该了解您正在使用的 CentOS 上的 python 是如何构建的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-04-08T10:01:32.343

请在安装 python2.6 之前安装 openssl 和 openssl-devel。

您可以简单地使用 yum 安装这些软件包，然后重新安装 python2.6（无需删除已安装的 python2.6）

```
]# yum install openssl openssl-devel

Python-2.6.x]# ./configure
Python-2.6.x]# make && make altinstall 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T12:44:01.327

你怎么有python 2.6？在 CentOS 2.4 是标准的，这可能是您的问题的原因。可能值得再次安装 boto，因为库路径可能不正确

# jquery - 如何使用 J-query 从外部 .js 文件访问文本框等服务器控件？

> ID：877089
> 
> 赞同：0
> 
> 时间：2009-05-18T10:34:04.990
> 
> 标签：jquery, servercontrols

我需要使用 J-query 更改文本框的高度。我需要将此代码编写在外部 .js 文件中。如何在外部 .js 文件中访问 J-query 中的文本框高度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T10:41:37.173

You can access it the same way in the inline code:

```
$('#<%=mycontrol.ClientID%>') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T10:43:22.507

It doesn't matter that your js is in an external file, you'd write it the same way inline or external.

If the textbox has an ID you can use:

$("#Textbox1").height();

[http://docs.jquery.com/CSS/height](http://docs.jquery.com/CSS/height)

# java - DWR 2 到 DWR 3 彗星

> ID：877090
> 
> 赞同：0
> 
> 时间：2009-05-18T10:34:31.760
> 
> 标签：java, dwr

我目前使用 DWR 2 进行开发，但我现在想尝试 DWR 3。我不明白如何使用 DWR 3 制作彗星。我在 Google 上搜索了很多次，但我没有找到任何好的示例。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T11:38:04.173

您需要[配置 DWR](http://directwebremoting.org/dwr/reverse-ajax/getting-started)以启用反向 AJAX。要启动 Comet 循环，您需要在页面加载时请求 Reverse AJAX `dwr.engine.setActiveReverseAjax(true);`：. 要启用完整流式传输，请将`init-param`:设置`maxWaitAfterWrite`为`-1`。如果您不想要完整的流式传输，您可以将其设置为您想要的任何轮询速率（默认为 5 秒）。Comet 在服务器上可能很难，所以要小心。

# visual-studio-2008 - 如何更改 VS 服务器资源管理器的默认连接字符串设置

> ID：877095
> 
> 赞同：1
> 
> 时间：2009-05-18T10:36:48.527
> 
> 标签：visual-studio-2008, connection-string, server-explorer

我在 VS2008 的服务器资源管理器中使用 SQL Server 2005 express 和设计数据库。由于各种原因，我禁用了用户实例。现在每次我使用服务器资源管理器时，我都需要修改连接并关闭用户实例。

有没有办法将 VS 配置为始终连接用户实例 = false？

# java - 如何将参数传递给 Java 线程？

> ID：877096
> 
> 赞同：324
> 
> 时间：2009-05-18T10:37:01.817
> 
> 标签：java, multithreading

谁能建议我如何将参数传递给线程？

另外，匿名类是如何工作的？

* * *

## 回答 #1

> 赞同：405
> 
> 时间：2009-05-18T10:41:43.430

您需要将构造函数中的参数传递给 Runnable 对象：

```
public class MyRunnable implements Runnable {

   public MyRunnable(Object parameter) {
       // store parameter for later user
   }

   public void run() {
   }
} 
```

并因此调用它：

```
Runnable r = new MyRunnable(param_value);
new Thread(r).start(); 
```

* * *

## 回答 #2

> 赞同：122
> 
> 时间：2009-05-18T10:41:47.690

### 对于匿名类：

为了回答问题，这里的编辑是匿名类的工作方式

```
 final X parameter = ...; // the final is important
   Thread t = new Thread(new Runnable() {
       p = parameter;
       public void run() { 
         ...
       };
   t.start(); 
```

* * *

### 命名类：

您有一个扩展 Thread（或实现 Runnable）的类和一个带有您想要传递的参数的构造函数。然后，当您创建新线程时，您必须传入参数，然后启动线程，如下所示：

```
Thread t = new MyThread(args...);
t.start(); 
```

Runnable 是比 Thread BTW 更好的解决方案。所以我更喜欢：

```
 public class MyRunnable implements Runnable {
      private X parameter;
      public MyRunnable(X parameter) {
         this.parameter = parameter;
      }

      public void run() {
      }
   }
   Thread t = new Thread(new MyRunnable(parameter));
   t.start(); 
```

这个答案与这个类似的问题基本相同：[How to pass parameters to a Thread object](https://stackoverflow.com/questions/705037/how-to-pass-parameters-to-a-thread-object)

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2009-05-18T10:40:48.563

通过 Runnable 或 Thread 类的构造函数

```
class MyThread extends Thread {

    private String to;

    public MyThread(String to) {
        this.to = to;
    }

    @Override
    public void run() {
        System.out.println("hello " + to);
    }
}

public static void main(String[] args) {
    new MyThread("world!").start();
} 
```

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2016-08-29T20:40:29.377

这个答案来得很晚，但也许有人会发现它很有用。它是关于如何在`Runnable`不声明命名类的情况下将参数传递给 a（对于内联器很方便）：

```
 String someValue = "Just a demo, really...";

    new Thread(new Runnable() {
        private String myParam;

        public Runnable init(String myParam) {
            this.myParam = myParam;
            return this;
        }

        @Override
        public void run() {
            System.out.println("This is called from another thread.");
            System.out.println(this.myParam);
        }
    }.init(someValue)).start(); 
```

当然，您可以将执行推迟`start`到更方便或更合适的时刻。方法的签名是什么`init`（因此它可能需要更多和/或不同的参数），当然还有它的名称，这取决于你，但基本上你知道了。

事实上，还有另一种将参数传递给匿名类的方法，即使用初始化程序块。考虑一下：

```
 String someValue = "Another demo, no serious thing...";
    int anotherValue = 42;

    new Thread(new Runnable() {
        private String myParam;
        private int myOtherParam;
        // instance initializer
        {
            this.myParam = someValue;
            this.myOtherParam = anotherValue;
        }

        @Override
        public void run() {
            System.out.println("This comes from another thread.");
            System.out.println(this.myParam + ", " + this.myOtherParam);
        }
    }).start(); 
```

所以一切都发生在初始化程序块内。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2009-05-18T10:43:13.520

创建线程时，您需要一个`Runnable`. 传递参数的最简单方法是将其作为参数传递给构造函数：

```
public class MyRunnable implements Runnable {

    private volatile String myParam;

    public MyRunnable(String myParam){
        this.myParam = myParam;
        ...
    }

    public void run(){
        // do something with myParam here
        ...
    }

}

MyRunnable myRunnable = new myRunnable("Hello World");
new Thread(myRunnable).start(); 
```

如果您想在线程运行时更改参数，您可以简单地向您的可运行类添加一个 setter 方法：

```
public void setMyParam(String value){
    this.myParam = value;
} 
```

一旦你有了这个，你可以通过这样的调用来改变参数的值：

```
myRunnable.setMyParam("Goodbye World"); 
```

当然，如果你想在参数改变时触发一个动作，你将不得不使用锁，这使得事情变得相当复杂。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2019-01-17T17:12:45.160

我知道我晚了几年，但我遇到了这个问题并采取了非正统的方法。我想在不开设新课程的情况下做到这一点，所以这就是我想出的：

```
int x = 0;
new Thread((new Runnable() {
     int x;
     public void run() {
        // stuff with x and whatever else you want
     }
     public Runnable pass(int x) {
           this.x = x;
           return this;
     }
}).pass(x)).start(); 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-05-18T10:46:38.473

您可以根据需要扩展 the或 the并提供参数。[文档](http://java.sun.com/javase/6/docs/api/java/lang/Thread.html?is-external=true)中有简单的示例。我将它们移植到这里：[`Thread`](http://java.sun.com/javase/6/docs/api/java/lang/Thread.html?is-external=true) `class`[`Runnable`](http://java.sun.com/javase/6/docs/api/java/lang/Runnable.html) `class`

```
 class PrimeThread extends Thread {
     long minPrime;
     PrimeThread(long minPrime) {
         this.minPrime = minPrime;
     }

     public void run() {
         // compute primes larger than minPrime
          . . .
     }
 }

 PrimeThread p = new PrimeThread(143);
 p.start();

 class PrimeRun implements Runnable {
     long minPrime;
     PrimeRun(long minPrime) {
         this.minPrime = minPrime;
     }

     public void run() {
         // compute primes larger than minPrime
          . . .
     }
 }

 PrimeRun p = new PrimeRun(143);
 new Thread(p).start(); 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2009-05-18T10:42:00.653

要创建线程，您通常会创建自己的 Runnable 实现。在此类的构造函数中将参数传递给线程。

```
class MyThread implements Runnable{
   private int a;
   private String b;
   private double c;

   public MyThread(int a, String b, double c){
      this.a = a;
      this.b = b;
      this.c = c;
   }

   public void run(){
      doSomething(a, b, c);
   }
} 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-05-18T10:41:02.760

要么编写一个实现 Runnable 的类，然后在适当定义的构造函数中传递您需要的任何内容，或者编写一个使用适当定义的构造函数扩展 Thread 的类，该构造函数调用具有适当参数的 super()。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2017-12-29T09:53:51.053

在 Java 8 中，您可以将`lambda`表达式与[Concurrency API](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/package-summary.html)一起使用，`ExecutorService`作为直接使用线程的更高级别的替代品：

> `newCachedThreadPool()`创建一个线程池，根据需要创建新线程，但在可用时将重用以前构造的线程。这些池通常会提高执行许多短期异步任务的程序的性能。

```
 private static final ExecutorService executor = Executors.newCachedThreadPool();

    executor.submit(() -> {
        myFunction(myParam1, myParam2);
    }); 
```

另请参阅`executors` [javadocs](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executors.html)。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2017-03-10T22:49:33.333

从 Java 8 开始，您可以使用 lambda 来捕获实际上是[final](https://stackoverflow.com/a/20938132/960115)的参数。例如：

```
final String param1 = "First param";
final int param2 = 2;
new Thread(() -> {
    // Do whatever you want here: param1 and param2 are in-scope!
    System.out.println(param1);
    System.out.println(param2);
}).start(); 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2012-03-05T17:15:20.263

通过 start() 和 run() 方法传递参数：

```
// Tester
public static void main(String... args) throws Exception {
    ThreadType2 t = new ThreadType2(new RunnableType2(){
        public void run(Object object) {
            System.out.println("Parameter="+object);
        }});
    t.start("the parameter");
}

// New class 1 of 2
public class ThreadType2 {
    final private Thread thread;
    private Object objectIn = null;
    ThreadType2(final RunnableType2 runnableType2) {
        thread = new Thread(new Runnable() {
            public void run() {
                runnableType2.run(objectIn);
            }});
    }
    public void start(final Object object) {
        this.objectIn = object;
        thread.start();
    }
    // If you want to do things like setDaemon(true); 
    public Thread getThread() {
        return thread;
    }
}

// New class 2 of 2
public interface RunnableType2 {
    public void run(Object object);
} 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-05-18T10:41:41.933

您可以从 Runnable 派生一个类，并在构造期间（例如）传入参数。

然后使用 Thread.start(Runnable r); 启动它

如果您的意思*是*线程正在运行，那么只需在调用线程中保存对派生对象的引用，并调用适当的 setter 方法（在适当的情况下同步）

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-01-07T03:18:22.103

有一种将参数传递给可运行对象的简单方法。代码：

```
public void Function(final type variable) {
    Runnable runnable = new Runnable() {
        public void run() {
            //Code adding here...
        }
    };
    new Thread(runnable).start();
} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2016-07-13T11:36:44.923

不，您不能将参数传递给该`run()`方法。签名告诉你（它没有参数）。可能最简单的方法是使用一个专门构建的对象，该对象在构造函数中接受参数并将其存储在最终变量中：

```
public class WorkingTask implements Runnable
{
    private final Object toWorkWith;

    public WorkingTask(Object workOnMe)
    {
        toWorkWith = workOnMe;
    }

    public void run()
    {
        //do work
    }
}

//...
Thread t = new Thread(new WorkingTask(theData));
t.start(); 
```

一旦你这样做了 - 你必须小心你传递给'WorkingTask'的对象的数据完整性。数据现在将存在于两个不同的线程中，因此您必须确保它是线程安全的。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2014-12-22T22:19:56.133

另一种选择；这种方法让您可以像使用异步函数调用一样使用 Runnable 项。如果您的任务不需要返回结果，例如它只是执行一些操作，您无需担心如何传回“结果”。

此模式允许您重用需要某种内部状态的项目。当没有在构造函数中传递参数时，需要注意调解程序对参数的访问。如果您的用例涉及不同的调用者等，您可能需要更多检查。

```
public class MyRunnable implements Runnable 
{
  private final Boolean PARAMETER_LOCK  = false;
  private X parameter;

  public MyRunnable(X parameter) {
     this.parameter = parameter;
  }

  public void setParameter( final X newParameter ){

      boolean done = false;
      synchronize( PARAMETER_LOCK )
      {
          if( null == parameter )
          {
              parameter = newParameter;
              done = true;
          }
      }
      if( ! done )
      {
          throw new RuntimeException("MyRunnable - Parameter not cleared." );
      }
  }

  public void clearParameter(){

      synchronize( PARAMETER_LOCK )
      {
          parameter = null;
      }
  }

  public void run() {

      X localParameter;

      synchronize( PARAMETER_LOCK )
      {
          localParameter = parameter;
      }

      if( null != localParameter )
      {
         clearParameter();   //-- could clear now, or later, or not at all ...
         doSomeStuff( localParameter );
      }

  } 
```

}

线程 t = new Thread(new MyRunnable(parameter)); t.start();

如果需要处理结果，还需要在子任务完成时协调 MyRunnable 的完成。您可以回电或等待线程“t”等。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2015-09-08T11:33:39.733

## 安卓专用

出于回调目的，我通常`Runnable`使用输入参数实现我自己的泛型：

```
public interface Runnable<TResult> {
    void run(TResult result);
} 
```

用法很简单：

```
myManager.doCallbackOperation(new Runnable<MyResult>() {
    @Override
    public void run(MyResult result) {
        // do something with the result
    }
}); 
```

在经理：

```
public void doCallbackOperation(Runnable<MyResult> runnable) {
    new AsyncTask<Void, Void, MyResult>() {
        @Override
        protected MyResult doInBackground(Void... params) {
            // do background operation
            return new MyResult(); // return resulting object
        }

        @Override
        protected void onPostExecute(MyResult result) {
            // execute runnable passing the result when operation has finished
            runnable.run(result);
        }
    }.execute();
} 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2018-09-19T13:22:32.040

在你的类中创建一个局部变量，`extends Thread`或者`implements Runnable`.

```
public class Extractor extends Thread {
    public String webpage = "";
    public Extractor(String w){
        webpage = w;
    }
    public void setWebpage(String l){
        webpage = l;
    }

    @Override
    public void run() {// l is link
        System.out.println(webpage);
    }
    public String toString(){
        return "Page: "+webpage;
    }} 
```

这样，您可以在运行时传递一个变量。

```
Extractor e = new Extractor("www.google.com");
e.start(); 
```

输出：

```
"www.google.com" 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-03-15T14:30:56.713

首先，我想指出其他答案是正确的。但是，在构造函数中使用参数可能不是你们所有人的最佳主意。

在许多情况下，您将希望使用“匿名内部类”并覆盖该`run()`方法，因为为每次使用定义特定类是很痛苦的。( `new MyRunnable(){...}`)

并且在您创建 Runnable 时，您可能无法使用该参数在构造函数中传递它。例如，如果您将此对象传递给一个方法，该方法将在单独的线程中执行一些工作，然后调用您的可运行对象，并将该工作的结果应用于它。

在这种情况下，使用这样的方法： `public MyRunnable withParameter(Object parameter)`，可能会成为更有用的选择。

我并不声称这是解决问题的最佳方法，但它会完成工作。

# jquery - Swf 对象 flash 电影出现在我的厚盒中

> ID：877097
> 
> 赞同：0
> 
> 时间：2009-05-18T10:37:16.107
> 
> 标签：jquery, swfobject, thickbox

swf 电影位于所有内容之上，包括出现在thickbox 中的内容。我不知道为什么会这样。

这个问题只存在于 IE7 上（到目前为止），但可能至少存在于 IE6 中（我没有 IE6 可以测试）。下面是我用来嵌入我的 Flash 电影的代码：

```
<div id="flash">You need the Flash Player to view this video.
<script type="text/javascript"><!--
/*<! */
var so = new SWFObject("mixed.swf", "flash", 529, 323, "9");
so.write("flash");
/*-->*/
</script> 
```

我使用的是thickbox，因为我在网站上有其他的jQuery 位。该网站的网址是[http://clients.bionic-comms.co.uk/fox/foxintouch-wp/issue/13/brand-highlights/](http://clients.bionic-comms.co.uk/fox/foxintouch-wp/issue/13/brand-highlights/)

如果有人能给我答案，我将不胜感激。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T10:45:51.627

[看看这个解决方案。](http://thewichitacomputerguy.com/blog/z-index-flash-objects-thickbox-fix)看看它是否适合你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T05:31:30.867

你没有关闭你的 div ......你错过了 /div 标签。

```
<div id="flash">You need the Flash Player to view this video.**</div>**
<script type="text/javascript">
var so = new SWFObject("mixed.swf", "flash", 529, 323, "9");
so.write("flash");
</script> 
```

此外，SWFObject 代码不应放在目标 div 中；这给一些人带来了麻烦。

I see you're using SWFObject 1.5; I suggest upgrading to SWFObject 2.2, as it contains an important bugfix regarding memory leaks and Flash video. [http://code.google.com/p/swfobject/](http://code.google.com/p/swfobject/)

# c# - C# 中的独立函数

> ID：877098
> 
> 赞同：6
> 
> 时间：2009-05-18T10:37:37.947
> 
> 标签：c#

作为一名 C++ 程序员，每次我使用 C# 时，我都想知道为什么它缺乏对独立函数的支持；换句话说：不属于任何类的函数。我真的很想念这个特性，因为独立函数允许在不需要完全私有访问的情况下向类添加功能，避免了难以维护的单体类。此外，它允许扩展第三方库。我知道您可以使用静态类，但类名完全无关紧要，使客户端代码不必要地冗长。

例如。我想创建一个辅助函数来计算字符串中的单词。我怎样才能避免写“StringHelperClass.CountWords();” 在客户端代码中？StringHelperClass 充当命名空间，只有我不能写“使用 StringHelperClass；”。我不得不在每次使用时重复“StringHelperClass”，而很明显它是一个字符串辅助函数，因为它的唯一参数是一个字符串。

有没有办法扩展类的功能，同时保持客户端代码简洁？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-18T10:40:50.810

编辑：请注意，由于该[`using static ....`](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/using-static)指令是在 C# 6 中添加的，因此在很大程度上可以将其视为等效功能。只需使用常规的 .NET`static`方法，然后使用`using static`指令，您就可以立即使用这些方法。

* * *

更好的问题是：

“为什么要包括它？”

鉴于 C# 在没有独立函数的情况下很好地结合在一起，添加它们的要求是什么？特别是，静态实用程序类可以很好地托管此类（作为常规方法或扩展方法），并在发生冲突时允许简单的消歧。

它还（正如 OregonGhost 在评论中指出的那样）有助于模块化代码，防止 IntelliSense 等死机。

那么：为什么要添加它们？什么问题（在 C# 中）尚未解决？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T10:47:56.490

我同意这是我发现 C# 中缺少的一个功能。主要原因是使用函数的冗长。类名充当命名空间，但无法在代码文件的开头简单地“使用”该命名空间。因此，例如，如果您想用 C# 编写 OpenGL，则必须键入以下内容： OpenGL.glClearDepth(1.0f); OpenGL.glEnable(GL_DEPTH_TEST); 等等。我知道这可能与将所有东西都归类为基本概念有关，但我不太喜欢强迫你以某种方式做事的语言。当然，这可能是我不真正使用 C# 的原因，除非我别无选择（比如在工作中）。

# git - Git log without cloning the repository?

> ID：877103
> 
> 赞同：10
> 
> 时间：2009-05-18T10:40:37.177
> 
> 标签：git, version-control

git log give us a really good functionality to know about what happened in the project. When we are in our machine and we have the cloned project is just executing the command. But I've realized that sometimes I need to read the log from somewhere else that is not my machine, so it would be great to ask for a log without having the repository cloned.

I've been looking around through google an reading the git-log man page but I didn't found a way to do it.

Does anybody know if this way of log can be done?

Thanks in advance.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T10:48:42.323

I don't know if a built-in way for this exists, but you can always fall back to a remote command over ssh:

```
ssh some-host "cd my/repo && git log" 
```

This of course only works if you have shell access to the host.

# c++ - C++ error - "member initializer expression list treated as compound expression"

> ID：877107
> 
> 赞同：16
> 
> 时间：2009-05-18T10:41:09.873
> 
> 标签：c++

I'm getting a C++ compiler error which I'm not familiar with. Probably a really stupid mistake, but I can't quite put my finger on it.

Error:

```
test.cpp:27: error: member initializer expression list treated as compound expression
test.cpp:27: warning: left-hand operand of comma has no effect
test.cpp:27: error: invalid initialization of reference of type ‘const Bar&’ from expression of type ‘int’ 
```

Code:

```
 1 #include <iostream>
  2
  3 class Foo {
  4 public:
  5         Foo(float f) :
  6                 m_f(f)
  7         {}
  8
  9         float m_f;
 10 };
 11
 12 class Bar {
 13 public:
 14         Bar(const Foo& foo, int i) :
 15                 m_foo(foo),
 16                 m_i(i)
 17         {}
 18
 19         const Foo& m_foo;
 20         int m_i;
 21 };
 22
 23
 24 class Baz {
 25 public:
 26         Baz(const Foo& foo, int a) :
 27                 m_bar(foo, a)
 28         {}
 29
 30         const Bar& m_bar;
 31 };
 32
 33 int main(int argc, char *argv[]) {
 34         Foo a(3.14);
 35         Baz b(a, 5.0);
 36
 37         std::cout << b.m_bar.m_i << " " << b.m_bar.m_foo.m_f << std::endl;
 38
 39         return 0;
 40 } 
```

Note: It looks like the compiler is evaluating the commas in line 27 like here: [http://publib.boulder.ibm.com/infocenter/lnxpcomp/v8v101/index.jsp?topic=/com.ibm.xlcpp8l.doc/language/ref/co.htm](http://publib.boulder.ibm.com/infocenter/lnxpcomp/v8v101/index.jsp?topic=/com.ibm.xlcpp8l.doc/language/ref/co.htm)

**edit:** Okay, I understand the problem as Alan explained it. Now, for extra imaginary points, can someone explain how the compiler (g++) came up with the error message it gave?

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-18T10:56:56.147

m_bar is a reference, so you can't construct one.

As others have noted, you can initialise references with the object it refers to, but you can't construct one like you're trying to do.

Change line 30 to

```
const Bar m_bar 
```

and it'll compile / run properly.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-18T10:46:06.197

m_bar is declared as a "const reference" and therefore can't be instantiated with the constructor you've supplied.

Consider making m_bar a member, or passing a pre-constructed Bar object to the constructor.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T11:13:12.320

您可以在以下代码中更清楚地看到问题：

```
struct B {
    B( int a, int x  ) {}
};

int main() {
    const B & b( 1, 2);
} 
```

使用 g++ 会产生以下错误：

```
t.cpp: In function 'int main()':
t.cpp:6: error: initializer expression list treated as compound expression
t.cpp:6: error: invalid initialization of reference of type 'const B&' from expression of type int' 
```

VC++ 6.0 给出了更多的 gnomic 错误：

```
 error C2059: syntax error : 'constant' 
```

简而言之，您不能像那样初始化引用。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-02-21T07:14:02.033

（编辑：见评论）虽然这个问题很老，但对于未来的读者，我会指出标记为答案的项目不正确。确实可以构造一个引用。

在初始化程序行中，代码`m_bar(foo, a)`试图`(foo,a)`用作 m_bar 的构造函数。该错误告诉您`foo`将被忽略，并且您不能从 `int a`. 以下正确的语法将编译无错误：

```
m_bar (*new Bar(foo,a)) 
```

# c++ - 如何为 C 函数建模 OO 风格的接口？

> ID：877117
> 
> 赞同：2
> 
> 时间：2009-05-18T10:42:43.320
> 
> 标签：c++, oop

我有一个 C 模块，它是由 Real-time Workshop 基于 Simulink 模型创建的。该模块提供三个公共功能：

```
int init();
int calc(double *inputarray, double *outputarray);
int term(); 
```

根据 outputarray 的内容，我可以为一个名为 OutputThing 的类建模。

我想将这些函数集成到一个名为 WrapperModule 的包装器类中。现在我有一个看起来像这样的类：

```
class WrapperModule {
public:
    int initialize();
    OutputThing calc(...);
    int terminate();
}; 
```

我的问题是，如何正确设计 calc() 函数的包装方法。我想避免创建一个以数组/向量作为其单个参数的方法。但是从向量中识别正确的参数是很棘手的，我不喜欢有一个有 6 个或更多参数的方法的想法。

Bertrand Meyer 在他的 OOSC 书中建议使用 setter 方法。就像是：

```
class WrapperModule {
public:
    int initialize();
    void set_foo(double f);
    void set_bar(double b);
    OutputThing calc();
    int terminate();
}; 
```

有任何想法吗？我不确定哪种方法会更好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T10:51:01.663

如果您还能够抽象`inputarray`到一个`InputThing`类，我会建议以下内容。这也更好地封装了使用 C++ 构造/销毁的初始化/终止。

```
class WrapperModule {
public:
    // Calls init()
    WrapperModule();

    // Calls term()
    ~WrapperModule();

    // Calls calc()
    OutputThing calculate(const InputThing& inputThing);
}; 
```

如有必要，`InputThing`可以有访问器和修改器（get/set）函数来防止它需要一个构造函数来接受许多参数。

# iphone - 如何在我的应用程序设置包中显示应用程序版本修订？

> ID：877128
> 
> 赞同：93
> 
> 时间：2009-05-18T10:45:53.030
> 
> 标签：iphone, xcode, application-settings, settings-bundle

我想在我的应用程序的设置包中包含应用程序版本和内部修订，例如 1.0.1 (r1243)。

Root.plist 文件包含这样的片段...

```
 <dict>
        <key>Type</key>
        <string>PSTitleValueSpecifier</string>
        <key>Title</key>
        <string>Version</string>
        <key>Key</key>
        <string>version_preference</string>
        <key>DefaultValue</key>
        <string>VersionValue</string>
        <key>Values</key>
        <array>
            <string>VersionValue</string>
        </array>
        <key>Titles</key>
        <array>
            <string>VersionValue</string>
        </array>
    </dict> 
```

我想在构建时替换“VersionValue”字符串。

我有一个可以从我的存储库中提取版本号的脚本，我需要的是一种在构建时处理（预处理）Root.plist 文件的方法，并在不影响源文件的情况下替换修订号。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-06-30T05:22:16.593

还有另一种解决方案可能比之前的任何一个答案都简单得多。**Apple 在其大多数安装程序中捆绑了一个名为PlistBuddy**的命令行工具，并将其包含在 Leopard 的`/usr/libexec/PlistBuddy`.

由于您要替换`VersionValue`，假设您将版本值提取到`$newVersion`，您可以使用以下命令：

```
/usr/libexec/PlistBuddy -c "Set :VersionValue $newVersion" /path/to/Root.plist 
```

无需摆弄 sed 或正则表达式，这种方法非常简单。有关详细说明，请参见[手册页](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man8/PlistBuddy.8.html)。您可以使用 PlistBuddy 添加、删除或修改属性列表中的任何条目。例如，我的一个朋友写了一篇关于使用 PlistBuddy[在 Xcode 中增加内部版本号的博客。](http://davedelong.com/blog/2009/04/15/incrementing-build-numbers-xcode)

**注意：**如果您只提供 plist 的路径，PlistBuddy 会进入交互模式，因此您可以在决定保存更改之前发出多个命令。我绝对建议在将其放入构建脚本之前执行此操作。

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2009-07-17T17:46:40.370

我懒人的解决方案是从我的应用程序代码中更新版本号。您可以在 Root.plist 中有一个默认（或空白）值，然后在您的启动代码中的某个位置：

```
NSString *version = [[[NSBundle mainBundle] infoDictionary] objectForKey:@"CFBundleVersion"];
[[NSUserDefaults standardUserDefaults] setObject:version forKey:@"version_preference"]; 
```

唯一的问题是您的应用程序必须至少运行一次，更新版本才能出现在设置面板中。

您可以更进一步地更新这个想法，例如，更新您的应用程序已启动次数的计数器，或其他有趣的信息。

* * *

## 回答 #3

> 赞同：65
> 
> 时间：2012-10-11T14:55:59.413

根据@Quinn 的回答，这里是我用来执行此操作的完整过程和工作代码。

*   将设置包添加到您的应用程序。不要重命名它。
*   在文本编辑器中打开 Settings.bundle/Root.plist

将内容替换为：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN"     "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>PreferenceSpecifiers</key>
    <array>
        <dict>
            <key>Title</key>
            <string>About</string>
            <key>Type</key>
            <string>PSGroupSpecifier</string>
        </dict>
        <dict>
            <key>DefaultValue</key>
            <string>DummyVersion</string>
            <key>Key</key>
            <string>version_preference</string>
            <key>Title</key>
            <string>Version</string>
            <key>Type</key>
            <string>PSTitleValueSpecifier</string>
        </dict>
    </array>
    <key>StringsTable</key>
    <string>Root</string>
</dict>
</plist> 
```

*   创建一个*运行脚本*构建阶段，移到*复制捆绑资源*阶段之后。添加此代码：

    ```
    cd "${BUILT_PRODUCTS_DIR}"
    buildVersion=$(/usr/libexec/PlistBuddy -c "Print CFBundleVersion" "${INFOPLIST_PATH}" )
    /usr/libexec/PlistBuddy -c "Set PreferenceSpecifiers:1:DefaultValue $buildVersion" "${WRAPPER_NAME}/Settings.bundle/Root.plist" 
    ```

*   将 MyAppName 替换为您的实际应用名称，并将 PreferenceSpecifiers 后面的 1 替换为设置中您的版本条目的索引。上面的 Root.plist 示例在索引 1 处有它。

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2016-08-19T02:16:33.210

使用 Ben Clayton 的 plist [https://stackoverflow.com/a/12842530/338986](https://stackoverflow.com/a/12842530/338986)

在 . 之后添加`Run script`以下代码段`Copy Bundle Resources`。

```
version=$(/usr/libexec/PlistBuddy -c "Print CFBundleShortVersionString" "$PROJECT_DIR/$INFOPLIST_FILE")
build=$(/usr/libexec/PlistBuddy -c "Print CFBundleVersion" "$PROJECT_DIR/$INFOPLIST_FILE")
/usr/libexec/PlistBuddy -c "Set PreferenceSpecifiers:1:DefaultValue $version ($build)" "$CODESIGNING_FOLDER_PATH/Settings.bundle/Root.plist" 
```

除了. `CFBundleVersion`_ `CFBundleShortVersionString`它发出这样的版本：

![](https://i.stack.imgur.com/mfZLl.png)

通过写信 `$CODESIGNING_FOLDER_PATH/Settings.bundle/Root.plist` 而不是写信`$SRCROOT`有一些好处。

1.  它不会修改存储库工作副本中的文件。
2.  您不需要将路径输入到`Settings.bundle`in `$SRCROOT`。路径可能会有所不同。

在 Xcode 7.3.1 上测试

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2010-07-05T12:20:41.697

根据此处的示例[，](http://web.me.com/maczealot/rantings_of_an_iron_geek/automatic_build_number_in_x.html)这是我用来自动更新设置包版本号的脚本：

```
#! /usr/bin/env python
import os
from AppKit import NSMutableDictionary

settings_file_path = 'Settings.bundle/Root.plist' # the relative path from the project folder to your settings bundle
settings_key = 'version_preference' # the key of your settings version

# these are used for testing only
info_path = '/Users/mrwalker/developer/My_App/Info.plist'
settings_path = '/Users/mrwalker/developer/My_App/Settings.bundle/Root.plist'

# these environment variables are set in the XCode build phase
if 'PRODUCT_SETTINGS_PATH' in os.environ.keys():
    info_path = os.environ.get('PRODUCT_SETTINGS_PATH')

if 'PROJECT_DIR' in os.environ.keys():
    settings_path = os.path.join(os.environ.get('PROJECT_DIR'), settings_file_path)

# reading info.plist file
project_plist = NSMutableDictionary.dictionaryWithContentsOfFile_(info_path)
project_bundle_version = project_plist['CFBundleVersion']

# print 'project_bundle_version: '+project_bundle_version

# reading settings plist
settings_plist = NSMutableDictionary.dictionaryWithContentsOfFile_(settings_path)
  for dictionary in settings_plist['PreferenceSpecifiers']:
    if 'Key' in dictionary and dictionary['Key'] == settings_key:
        dictionary['DefaultValue'] = project_bundle_version

# print repr(settings_plist)
settings_plist.writeToFile_atomically_(settings_path, True) 
```

这是我在 Settings.bundle 中的 Root.plist：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>PreferenceSpecifiers</key>
    <array>
        <dict>
            <key>Title</key>
            <string>About</string>
            <key>Type</key>
            <string>PSGroupSpecifier</string>
        </dict>
        <dict>
            <key>DefaultValue</key>
            <string>1.0.0.0</string>
            <key>Key</key>
            <string>version_preference</string>
            <key>Title</key>
            <string>Version</string>
            <key>Type</key>
            <string>PSTitleValueSpecifier</string>
        </dict>
    </array>
    <key>StringsTable</key>
    <string>Root</string>
</dict>
</plist> 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2020-05-20T19:44:20.200

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2016-05-09T04:07:52.570

由于一个原因，其他答案无法正常工作：在打包设置捆绑包之后才执行运行脚本构建阶段。因此，如果您的 Info.plist 版本是 2.0.11，并且您将其更新为 2.0.12，然后构建/归档您的项目，设置包仍会显示 2.0.11。如果您打开 Settings bundle Root.plist，您可以看到版本号在构建过程结束之前不会更新。您可以再次构建项目以正确更新设置包，或者您可以将脚本添加到预构建阶段...

*   在 XCode 中，为您的项目目标编辑方案
*   单击 BUILD 方案上的披露箭头
*   然后，单击“预操作”项
*   单击加号并选择“新建运行脚本操作”
*   将 shell 值设置为 /bin/sh
*   将“提供构建设置来自”设置为您的项目目标
*   将您的脚本添加到文本区域。以下脚本对我有用。您可能需要修改路径以匹配您的项目设置：

    versionString=$(/usr/libexec/PlistBuddy -c "打印 CFBundleVersion" "${PROJECT_DIR}/${INFOPLIST_FILE}")

    /usr/libexec/PlistBuddy "$SRCROOT/Settings.bundle/Root.plist" -c "set PreferenceSpecifiers:0:DefaultValue $versionString"

这将在构建/归档过程中打包设置包之前正确运行脚本。如果您打开 Settings bundle Root.plist 并构建/归档您的项目，您现在将看到在构建过程开始时更新了版本号，并且您的 Settings bundle 将显示正确的版本。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-19T14:52:54.970

[我设法通过使用 pListcompiler ( http://sourceforge.net/projects/plistcompiler](http://sourceforge.net/projects/plistcompiler) ) 开源项目来做我想做的事。

1.  使用此编译器，您可以使用以下格式将属性文件写入 .plc 文件：

    ```
    plist {
        dictionary {
            key "StringsTable" value string "Root"
            key "PreferenceSpecifiers" value array [
                dictionary {
                    key "Type" value string "PSGroupSpecifier"
                    key "Title" value string "AboutSection"
                }
                dictionary {
                    key "Type" value string "PSTitleValueSpecifier"
                    key "Title" value string "Version"
                    key "Key" value string "version"
                    key "DefaultValue" value string "VersionValue"
                    key "Values" value array [
                        string "VersionValue"
                    ]
                    key "Titles" value array [
                        string "r" kRevisionNumber
                    ]
                }
            ]
        }
    } 
    ```

2.  我有一个自定义运行脚本构建阶段，将我的存储库修订提取到 .h 文件，如 brad-larson所述[。](https://stackoverflow.com/questions/877128/how-can-i-display-the-application-version-revision-in-my-applications-settings-b/877589#877589)

3.  plc 文件可以包含预处理器指令，如#define、#message、#if、#elif、#include、#warning、#ifdef、#else、#pragma、#error、#ifndef、#endif、xcode 环境变量。所以我可以通过添加以下指令来引用变量 kRevisionNumber

    ```
    #include "Revision.h" 
    ```

4.  我还在我的 xcode 目标中添加了一个自定义脚本构建阶段，以便在每次构建项目时运行 plcompiler

    ```
    /usr/local/plistcompiler0.6/plcompile -dest Settings.bundle -o Root.plist Settings.plc 
    ```

就是这样！

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2018-12-23T13:19:37.790

我的工作示例基于@Ben Clayton 的回答以及@Luis Ascorbe 和@Vahid Amiri 的评论：

> 注意：此方法修改存储库工作副本中的*Settings.bundle/Root.plist文件*

1.  将设置包添加到项目根目录。不要重命名

2.  打开 Settings.bundle/Root.plist 作为 SourceCode

    将内容替换为：

    ```
    <?xml version="1.0" encoding="UTF-8"?>
    <!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
    <plist version="1.0">
    <dict>
        <key>PreferenceSpecifiers</key>
        <array>
            <dict>
                <key>DefaultValue</key>
                <string></string>
                <key>Key</key>
                <string>version_preference</string>
                <key>Title</key>
                <string>Version</string>
                <key>Type</key>
                <string>PSTitleValueSpecifier</string>
            </dict>
        </array>
        <key>StringsTable</key>
        <string>Root</string>
    </dict>
    </plist> 
    ```

3.  将以下脚本添加到项目（目标）方案的 Build, Pre-actions 部分

    ```
    version=$(/usr/libexec/PlistBuddy -c "Print CFBundleShortVersionString" "$PROJECT_DIR/$INFOPLIST_FILE")
    build=$(/usr/libexec/PlistBuddy -c "Print CFBundleVersion" "$PROJECT_DIR/$INFOPLIST_FILE")

    /usr/libexec/PlistBuddy -c "Set PreferenceSpecifiers:0:DefaultValue $version ($build)" "${SRCROOT}/Settings.bundle/Root.plist" 
    ```

4.  构建并运行当前方案

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-08-28T12:49:41.017

以上答案对我不起作用，因此我创建了自定义脚本。

这会动态更新来自 Root.plist 的条目

使用下面的运行脚本。肯定会在 xcode 10.3 中验证。

“var buildVersion”是要在标题中显示的版本。

并且标识符名称是 settings.bundle Root.plist 中标题的下面的“var version”

```
cd "${BUILT_PRODUCTS_DIR}"

#set version name to your title identifier's string from settings.bundle
var version = "Version"

#this will be the text displayed in title
longVersion=$(/usr/libexec/PlistBuddy -c "Print CFBundleVersion" "${INFOPLIST_PATH}")
shortVersion=$(/usr/libexec/PlistBuddy -c "Print :CFBundleShortVersionString" ${TARGET_BUILD_DIR}/${INFOPLIST_PATH})
buildVersion="$shortVersion.$longVersion"

path="${WRAPPER_NAME}/Settings.bundle/Root.plist"

settingsCnt=`/usr/libexec/PlistBuddy -c "Print PreferenceSpecifiers:" ${path} | grep "Dict"|wc -l`

for (( idx=0; idx<$settingsCnt; idx++ ))
do
#echo "Welcome $idx times"
val=`/usr/libexec/PlistBuddy -c "Print PreferenceSpecifiers:${idx}:Key" ${path}`
#echo $val

#if ( "$val" == "Version" )
if [ $val == "Version" ]
then
#echo "the index of the entry whose 'Key' is 'version' is $idx."

# now set it
/usr/libexec/PlistBuddy -c "Set PreferenceSpecifiers:${idx}:DefaultValue $buildVersion" $path

# just to be sure that it worked
ver=`/usr/libexec/PlistBuddy -c "Print PreferenceSpecifiers:${idx}:DefaultValue" $path`
#echo 'PreferenceSpecifiers:$idx:DefaultValue set to: ' $ver

fi

done 
```

Root.plist 中的示例条目

```
 <dict>
        <key>Type</key>
        <string>PSTitleValueSpecifier</string>
        <key>Title</key>
        <string>Version</string>
        <key>DefaultValue</key>
        <string>We Rock</string>
        <key>Key</key>
        <string>Version</string>
    </dict> 
```

[![工作示例 Root.plist 条目](https://i.stack.imgur.com/fxiSx.png)](https://i.stack.imgur.com/fxiSx.png)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-18T12:54:23.677

我相信你可以使用类似于我在[这个答案](https://stackoverflow.com/questions/372218/insert-subversion-revision-number-in-xcode#414792)中描述的方式来做到这一点（基于[这篇文章](http://www.latenightcode.com/devblog/automated-build-numbering-in-xcode/)）。

首先，您可以通过将 VersionValue 重命名为 ${VERSIONVALUE} 来使 VersionValue 成为 Xcode 中的变量。创建一个名为 versionvalue.xcconfig 的文件并将其添加到您的项目中。转到您的应用程序目标并转到该目标的构建设置。我相信您需要将 VERSIONVALUE 添加为用户定义的构建设置。在该窗口的右下角，将“基于”值更改为“版本值”。

最后，转到您的目标并创建一个运行脚本构建阶段。检查运行脚本阶段并将脚本粘贴到脚本文本字段中。例如，我用当前 Subversion 构建标记我的 BUILD_NUMBER 设置的脚本如下：

```
REV=`/usr/bin/svnversion -nc ${PROJECT_DIR} | /usr/bin/sed -e 's/^[^:]*://;s/[A-Za-z]//'`
echo "BUILD_NUMBER = $REV" > ${PROJECT_DIR}/buildnumber.xcconfig 
```

当这些值在您的项目中发生变化时，这应该可以替换变量。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-11-19T17:21:16.047

这些是我在 Xcode 12.2 的 swift 项目中必须使用的变量

```
version=$(/usr/libexec/PlistBuddy -c "Print CFBundleShortVersionString" "$PROJECT_DIR/$INFOPLIST_FILE")
build="$CURRENT_PROJECT_VERSION"

/usr/libexec/PlistBuddy -c "Set PreferenceSpecifiers:0:FooterText Version $version" "$CODESIGNING_FOLDER_PATH/Settings.bundle/ServerURLSettings.plist"
/usr/libexec/PlistBuddy -c "Set PreferenceSpecifiers:0:FooterText Version $version($build)" "$CODESIGNING_FOLDER_PATH/Settings.bundle/DeveloperSettings.plist" 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-06-05T10:23:42.347

对我来说，这是最简单的解决方案：

在复制捆绑资源步骤之前添加新的脚本构建阶段

贝壳：`/usr/bin/env python`

内容：

```
#! /usr/bin/env python
import os
from AppKit import NSMutableDictionary

# Key to replace
settings_key = 'version_preference' # the key of your settings version

# File path
settings_path = os.environ.get('SRCROOT') + "/TheBeautifulNameOfYourOwnApp/Settings.bundle/Root.plist"

# Composing version string
version_string = os.environ.get('MARKETING_VERSION') + " (" + os.environ.get('CURRENT_PROJECT_VERSION') + ")"

# Reading settings plist
settings_plist = NSMutableDictionary.dictionaryWithContentsOfFile_(settings_path)
for dictionary in settings_plist['PreferenceSpecifiers']:
    if 'Key' in dictionary and dictionary['Key'] == settings_key:
        dictionary['DefaultValue'] = version_string

# Save new settings
settings_plist.writeToFile_atomically_(settings_path, True) 
```

# python - 文档脚本（Matlab 在 python 中的发布功能）

> ID：877145
> 
> 赞同：5
> 
> 时间：2009-05-18T10:51:44.283
> 
> 标签：python, matlab, reporting, report

Matlab 有一个很棒的工具，叫做[发布](http://www.mathworks.com/access/helpdesk/help/techdoc/index.html?/access/helpdesk/help/techdoc/ref/publish.html)。该工具将具有最少格式内容的常规 matlab 脚本转换为结构化、美观的报告（HTML、LateX、RTF）。它能够处理图形、数学公式等。

Python有类似的工具吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T11:43:07.597

有[pyreport](http://gael-varoquaux.info/computers/pyreport/)。它捕获“捕获其输出，将其编译为 pdf 或 html 文件中的漂亮报告”。有了这个，您可以编写打印出您的源代码的脚本，最终获得一份不错的报告。

# php - php form issues

> ID：877152
> 
> 赞同：0
> 
> 时间：2009-05-18T10:55:18.957
> 
> 标签：php, mysql, html, forms

I have a form with which I am trying to display a form with checkboxes, and then insert into a database whether or not those checkboxes are checked. Then, each time the page is called, check the value and append information to the html form to appropriate display the checkbox as checked or not.

I have modified the below code example to make it short, and I am aware that I am assigning the checked value to 'value', which won't do anything.

The approach of

```
<input type="checkbox" name="notice"  value="checked" checked/> 
```

to display a checkbox as checked, while not valid html, works in every browser, and is based on the example [here](http://www.echoecho.com/htmlforms09.htm). I would prefer to stick with this approach.

Now, I don't see what is wrong with my code.

The first steps should be to retrieve the values from the database, of which onyl one row will be retrieved, as article_no is a primary key. If nothing is retrieved, then the variables are simply assigned "", which results in the checkbox being unchecked.

As the value is checked, if it is selected, this should be inserted into the database, and will show as checked upon next viewing of the page.

Now, as it is, this code compeltely fails. firebug does not show anything being sent or received in the console, no erros are recorded either with php or mysql, nothing appears in the database despite the fields and such being correct, no mysql errors are reported...

What is the problem?

```
The code:

<?php

error_reporting(E_ALL);
if (isset($_GET["cmd"]))

  $cmd = $_GET["cmd"];

else
if (isset($_POST["cmd"]))

  $cmd = $_POST["cmd"];

  if (isset($_GET["pk"]))

  { $pk = $_GET["pk"];}
  if (isset($_POST["deleted"]))
  { $deleted = $_POST["deleted"];}
  if (isset($_POST["notice"]))
  { $notice = $_POST["notice"];}

$con = mysqli_connect("localhost","user","pass", "db");

if (!$con) {

   echo "Can't connect to MySQL Server. Errorcode: %s\n". mysqli_connect_error();

   exit;

}
$con->set_charset("utf8");
$getformdata = $con->query("select * from TEST where ARTICLE_NO = '$pk'");

$checkDeleted = "";
$checkNotice = "";

  while ($row = mysqli_fetch_assoc($getformdata))

  {

    $checkDeleted = $row['deleted'];

    $checkNotice = $row['notice'];

   } 
if($cmd=="submitinfo"){
$statusQuery = "INSERT INTO TEST VALUES (?, ?, ?)";

if ($statusInfo = $con->prepare($statusQuery)) {

    $statusInfo->bind_param("sss", $pk, $deleted, $notice);

   $statusInfo->execute();

   $statusInfo->close();
} else {

print_r($con->error);

}
}

echo "<form name=\"statusForm\" action=\"x.php\" method=\"post\" enctype=\"multipart/form-data\">

<h1>Editing information for auction: ".$pk."</h1>
Löschung Ebay:
<input type=\"checkbox\" name=\"deleted\" value=\"checked\" ".$checkDeleted." align=\"right\"/>
<br />
Abmahnung:
<input type=\"checkbox\" name=\"notice\"  value=\"checked\" ".$checkNotice."  align=\"left\"/>
<br />
<input type=\"hidden\" name=\"cmd\" value=\"submitinfo\" />
<input name=\"Submit\" type=\"submit\" value=\"submit\" />
</form>"; 
```

In the actual form/page, I have appropriate sanitization in place.

A big problem is that nothing is being inserted into the database and no errors are being returned at all!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T11:03:23.183

It's important to remember that unchecked checkbox does not contribute any values to a form when it is sent. When the deleted box is unchecked, there is no $_POST['deleted'] value set.

With that in mind, it looks like you don't actually set the value of $deleted if the checkbox is cleared. Use an idiom like this.

```
$deleted = isset($_POST["deleted"]) ? 1: 0; 
```

Substitute the 1 and 0 with whatever values you want in your database table for the checked and unchecked states (in your case, "checked" and "")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T11:42:57.817

与 Paul Dixon 的回答相同，我有时会这样做：

```
<input type="hidden" name="notice" value="not checked" />
<input type="checkbox" name="notice" value="checked" checked="checked" /> 
```

如果用户取消选中该复选框，则会发送隐藏输入的值。这样，`$_POST['notice']`总是发送到您的脚本。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-18T11:03:36.070

I thought checkboxes should be done this way:

```
<input type="checkbox" name="notice1"  value="value1" checked="checked"/>
<input type="checkbox" name="notice2"  value="value2" checked="checked"/> 
```

# subsonic - 亚音速有深负荷吗？

> ID：877154
> 
> 赞同：0
> 
> 时间：2009-05-18T10:56:21.920
> 
> 标签：subsonic, entity, data-access-layer

我是亚音速的新手，无法在一个查询中找到加载数据的方法，它是父母或孩子的数据。亚音速可以吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T11:59:39.903

基本上没有 SubSonic 2 不支持深度加载。但是，在 SubSonic 3 中使用 IQueryable 是可能的。有关更多信息，请参阅以下帖子：

[亚音速深度加载：是否支持？](https://stackoverflow.com/questions/770570/subsonic-deeploads-is-this-supported)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-20T11:53:32.187

你可以用 subsonic 2 来做。用相同的命名空间和类名创建一个部分类。

然后创建一个在调用时加载数据的属性。

# .net - 什么是对象图以及如何序列化一个对象图

> ID：877157
> 
> 赞同：40
> 
> 时间：2009-05-18T10:57:11.840
> 
> 标签：.net, serialization, xml-serialization

我最近一直在阅读有关序列化的内容。我读过，当我使用 XmlSerialization 时，我无法序列化对象图。什么是对象图，为什么我不能简单地序列化它？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-05-18T11:12:16.020

对象图不是单个对象，而是一组相关对象。举一个简单的例子，考虑：

```
public class Node {
    public string Name {...}
    public Node Parent {...}
    public List<Node> Children {...}
} 
```

每个孩子都知道父母（父母也知道孩子）。

问题是 xml 是一个基于对象属性的树......它只想遍历它们 - 即使用简单的父/子：

*   A（知道 B 是它的孩子）
    *   B（知道 A 是它的父节点）

这将序列化为：

```
<Node>
  <Name>A</Name>
  <!-- no Parent as A is the top node, so null -->
  <Children>
     <Node>
        <Name>B</Name>
        <Parent>
           <Node>
              <Name>A</Name>
              *** boom *** 
```

你可以看到我们回到了A，所以我们现在处于一个无限循环中。

`XmlSerializer`可以序列化数据*树*，但不能序列化完整图。您可以标记要忽略的属性，例如：

```
[XmlIgnore]
public Node Parent {...} 
```

现在它可以工作了，但我们必须在`Parent`之后修复它。

相比之下，其他一些序列化程序可以处理图形（`DataContractSerializer`可以按需）。它通过针对唯一键跟踪对象来做到这一点 - 但是输出不是您对常规 xml 的期望。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-18T11:12:50.263

对象图是一组相互引用的对象。

序列化对象图很棘手。序列化程序必须为每个对象分配一个唯一 ID，然后用唯一 ID 替换引用。

如果它以 XML 格式序列化并处理对象图，则必须为每个元素添加一个“OBJECT_ID”（或其他命名的）属性。这将很容易被打破：如果您将同名的属性添加到您正在序列化的类中会发生什么？

最简单的解决方案是不支持它。

.NET 提供二进制序列化来处理这个问题以及循环引用的问题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-18T11:13:24.943

一般的对象[图](http://en.wikipedia.org/wiki/Graph_(mathematics))由一组相互持有引用的对象组成。如果您有一个没有反向链接的对象树，则序列化和反序列化很简单。对于一般图，（反）序列化过程需要跟踪每个对象的身份，并使用某种形式的标记和清除算法来确保对象不会被（反）序列化两次。

# c# - 如何从两个点之间的文本框中获取文本

> ID：877158
> 
> 赞同：0
> 
> 时间：2009-05-18T10:57:33.493
> 
> 标签：c#, text-manipulation

我只想从例如两个点之间的文本框中获取文本。万维网。abc.org。H

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T11:01:40.190

在 C# 中

```
string url = "www.google.com";
string[] split_strings = url.Split('.');
Console.WriteLine(split_strings[1]); 
```

从文本框中获取字符串：

```
string url = textbox_url.Text;
string[] split_strings = url.Split('.');
Console.WriteLine(split_strings[1]); 
```

但是请使用 try and catch ;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T11:01:56.540

我认为你的问题需要更具体一点。现在，如果您只是想提取地址的中间部分，如下所示应该可以完成这项工作：

```
var parts = textbox.Text.Split(new char[] {'.'});
if (parts.Length < 3) throw new InvalidOperationException("Invalid address.");
var middlePart = parts[1]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T11:03:17.193

字符串干草堆=“www.google.com”；字符串针=“谷歌”；

```
 string myWord = GetWordFromString(haystack, needle);

        private string GetWordFromString(string haystack, string needle)
        {
           if (haystack.ToLower().Contains(needle))
           {
               return needle;
           }
        } 
```

我重新阅读了带有评论的帖子，我可以看到您可能不知道要提取什么单词...我认为第一个答案是您正在寻找的答案。

如果这是您的特定需要，还有用于从 url 中提取域名的正则表达式。像这样的东西：

```
 public static string ExtractDomainName(string Url)
    {
        return System.Text.RegularExpressions.Regex.Replace(
        Url,
        @"^([a-zA-Z]+:\/\/)?([^\/]+)\/.*?$",
        "$2"
        );
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T11:03:22.090

这和你的要求一样具体吗？

它只需要为 www.SOMESITE.com 工作吗

.net、.org、.co.uk、.ie 等其他 tld 扩展名呢？其他子域呢，例如 www2.、api.、新闻。等等......没有子域的域怎么样，google.com，theregister.co.uk，bit.ly

如果你的要求很简单，

然后

```
textBox.Text.Replace("www.", "").Replace(".com", ""); 
```

尽管我感觉您尚未考虑或完全解释您的要求。

如果是更复杂的场景，您可能需要查看正则表达式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T11:23:36.137

```
string text = "www. abc.org . h";
int left = Math.Max(text.IndexOf('.'), 0),
   right = Math.Min(text.LastIndexOf('.'), text.Length - 1);

string result = text.Substring(left+1, right - left-1).Trim(); 
```

# jquery - How to find ID of the closest upper element with specific class name?

> ID：877164
> 
> 赞同：1
> 
> 时间：2009-05-18T10:59:56.060
> 
> 标签：jquery, css-selectors

HTML Code:

```
<div id="1" class="master"></div>
<div id="2" class="slave"></div>
<div id="3" class="slave"></div>

<div id="4" class="master"></div>
<div id="5" class="slave"></div>
<div id="6" class="slave"></div> 
```

let's say, we use $('div').click() to make these DIV elements clickable:

```
$('div').click(function() {
    var el = $(this);
    var master_id = ???;
    alert(master_id);
}); 
```

Then, clicking on DIV elements with class "slave" we need to alert the ID of the closest upper DIV element with class "master", so, if we click on DIV#5 or DIV#6, alerts = "4" (DIV#4), if DIV#2 or DIV#3 - alerts = "1" (DIV#1). But how to do that? ;)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T11:09:32.827

**更新：**

```
$('div').click(function() {
    var el = $(this);
    var master_id = el.prevAll('.master').attr('id');
    alert(master_id);
}); 
```

**编辑：**
您还可以使用过滤器，这样当您单击带有 calss 'master' 的 div 时，它不会触发事件：

```
$('div').click(function(e) {
    var el =$(this);
    if (!el.is('.master')){
        var master_id = el.prevAll(".master").attr('id');
    alert(master_id);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T11:27:37.160

我最初认为[prev](http://docs.jquery.com/Traversing/prev#expr)会做，但经过一些测试后我注意到它不会在`slave`not 直接放在 another 之后工作`slave`。从[prevAll](http://docs.jquery.com/Traversing/prevAll#expr)中抓取第一场比赛效果很好。

演示：http: [//jsbin.com/ulipi](http://jsbin.com/ulipi)

```
$('.slave').click(function() {
    var el = $(this);
    var master_id = $(el.prevAll('.master').get(0)).attr('id');
    alert(master_id);
}); 
```

# .net - How to make a log file with a max size?

> ID：877168
> 
> 赞同：3
> 
> 时间：2009-05-18T11:01:25.950
> 
> 标签：.net

I'm logging to a file using FileStream.Write(). When the file reaches a maximum size, I want to delete a load of the logs from the start of the file. What's the best way of doing this?

The best idea I've got so far is to create a second file. Write everything I want to keep from the original file into it. Then delete the original file, and rename the second file with the original files name.

Is there a more simple and efficient way I can do this?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-18T11:09:33.843

使用[log4net](http://logging.apache.org/log4net/index.html)库 - 它允许以每个文件的最大大小和文件的最大数量滚动日志文件。

[http://logging.apache.org/log4net/index.html](http://logging.apache.org/log4net/index.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T11:16:59.037

是的，没有;-)

哪个对您来说重要：效率还是简单？

**更高效：**传统的滚动日志是固定大小的记录。您在读/写模式下使用随机访问文件，跟踪当前记录指针，当当前记录 == 最大记录时，将当前记录设置回零。显然，这限制了您可以记录的内容......数据库在“原始磁盘”上执行此操作以使它们能够随机访问可变记录大小。这还需要一个自定义日志阅读器应用程序。耶！

**更简单**（并且仍然比从文件复制数千行更有效）：编写许多但较小的日志文件。定期“滚动”日志文件，或者当它达到一定大小时...即开始一个新的日志文件，如果 numLogs == maxLogs 则删除最旧的日志文件。

干杯。基思。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T11:04:38.593

如果最大尺寸不太大，可以将整个文件加载到内存中，删除要删除的部分，然后直接覆盖旧文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T11:05:46.267

这听起来是一种公平的做法。由于在大多数文件系统上无法直接“截断”文件的开头，因此您将被迫以一种或另一种方式重写所有数据。您的两个选择基本上是：

1.  读取现有日志，将其存储到内存中，然后覆盖已删除初始部分的整个文件。如果在此过程中发生错误（或者如果操作系统/程序由于某种原因意外崩溃），这可能会丢失数据。

2.  您建议的创建新文件然后删除旧文件的方法。这有一个额外的好处，如果在创建新的时出现问题，你的旧的仍然存在并且完好无损。

看来您肯定想使用第二种方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T11:12:21.480

我认为您应该将日志文件视为[环形缓冲区](http://en.wikipedia.org/wiki/Circular_buffer)。当然，因为这些行可能有可变长度，所以有时你肯定会有半行——你可能会考虑把它们删掉。

我真的不会考虑每次换行时都重写整个文件——这太昂贵了。也许您甚至应该使用[log4net](http://logging.apache.org/log4net/index.html)或查看源代码以了解他们是如何做到的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T11:06:18.933

如果大小不必精确，也许更容易计算行数？当达到最大值时，回到开头并删除包括换行符在内的所有内容。然后回到最后。

当然，如果您在程序结束之前不执行任何文件写入操作会更容易，此时您写入所有缓存的行。虽然，如果您的程序运行很长时间并且您希望在运行期间使用 tail 或类似的东西查看日志，这可能不可行。

# c# - Is there a way to get a property value of an object using PropertyPath class?

> ID：877171
> 
> 赞同：7
> 
> 时间：2009-05-18T11:01:40.520
> 
> 标签：c#, .net, wpf

I want to get a value of a nested property of an object (something like Person.FullName.FirstName). I saw that in .Net there is a class named PropertyPath, which WPF uses for a similar purpose in Binding. Is there a way to reuse WPF's mechanism, or should I write one on my own.

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-18T12:56:29.383

重用 PropertyPath 很诱人，因为它支持在您指出和索引时遍历嵌套属性。你可以自己编写类似的功能，我以前也有过，但它涉及半复杂的文本解析和大量的反射工作。

正如 Andrew 指出的那样，您可以简单地重用 WPF 中的 PropertyPath。我假设您只想针对您拥有的对象评估该路径，在这种情况下，代码有点涉及。要评估 PropertyPath，必须在针对 DependencyObject 的绑定中使用它。为了证明这一点，我刚刚创建了一个名为 BindingEvaluator 的简单 DependencyObject，它有一个 DependencyProperty。真正的魔法然后通过调用 BindingOperations.SetBinding 发生，它应用绑定，以便我们可以读取评估值。

```
var path = new PropertyPath("FullName.FirstName");

var binding = new Binding();
binding.Source = new Person { FullName = new FullName { FirstName = "David"}}; // Just an example object similar to your question
binding.Path = path;
binding.Mode = BindingMode.TwoWay;

var evaluator = new BindingEvaluator();
BindingOperations.SetBinding(evaluator, BindingEvaluator.TargetProperty, binding);
var value = evaluator.Target;
// value will now be set to "David"

public class BindingEvaluator : DependencyObject
{
    public static readonly DependencyProperty TargetProperty =
        DependencyProperty.Register(
            "Target", 
            typeof (object), 
            typeof (BindingEvaluator));

    public object Target
    {
        get { return GetValue(TargetProperty); }
        set { SetValue(TargetProperty, value); }
    }
} 
```

如果您想扩展它，您可以连接 PropertyChanged 事件以支持读取更改的值。我希望这有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T11:14:49.760

我看不出你不能重用它的任何理由。

见[`PropertyPath`](http://msdn.microsoft.com/en-us/library/system.windows.propertypath.aspx)：

> 实现一种数据结构，用于将属性描述为另一个属性下方或拥有类型下方的路径。属性路径用于对象的数据绑定，以及动画的情节提要和时间线。

# oracle - Oracle - 外键中的NULLS？

> ID：877181
> 
> 赞同：1
> 
> 时间：2009-05-18T11:04:05.133
> 
> 标签：oracle, null, ansi

我正在尝试回答以下问题...

“解释当组成外键的列中存在 NULL 时出现的问题。讨论 ANSI 如何尝试通过使用串联外键时可以采用的三个‘匹配规则’来解决这个问题。”

谁能指出这些“匹配规则”是什么？我最初以为他们指的是 OUTER JOINS，但我不确定了。

任何意见，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T11:10:33.107

如果我没记错的话，这些规则是关于复合外键的。例如，考虑一个定义如下的地址表：

```
deliveryaddressid - order - orderline - street - ... 
```

其中 (order,orderline) 是 orderline 表的外键。当外键的一部分为 NULL 时，匹配规则决定连接的行为方式。例如，像这样的一行：

```
32 - null - 1123 - 'Main Street 1' - ... 
```

这是[一篇关于部分外键](http://www.toadworld.com/LinkClick.aspx?fileticket=hZvoqN6j0js=&tabid=321)的文章（PDF下载，6页）相关部分似乎是：

> ANSI SQL 92 允许，Oracle 等数据库支持复合外键的替代匹配规则，包括：
> 
> • **完全匹配**——不允许部分为空的外键。外键的所有组件必须为空，或者外键中包含的值的组合必须作为被引用表的单行的主键值或唯一键值出现。[默认]
> • **Match Partial** – 允许部分为空的复合外键。外键的所有组件必须为空，或者外键中包含的非空值的组合必须出现在被引用表中单行的主键或唯一键值的对应部分中。
> • **无匹配**– 允许部分为空的复合外键。如果复合外键的任何列为空，则该键的非空部分不必匹配父键的任何对应部分。

# oop - 深度与平面对象模型

> ID：877182
> 
> 赞同：4
> 
> 时间：2009-05-18T11:04:32.777
> 
> 标签：oop, object, model

您会推荐哪一个 - 深层对象层次结构（每个对象都包含对其子对象的引用）或平面对象（您提供检索子对象的服务）？

假设您正在创建一个数据库管理应用程序。您将拥有以下对象：

*   服务器
*   数据库
*   列
*   意见

您会推荐哪个选项：

1.  每个服务器对象都包含一个数据库对象列表。每个数据库对象都包含一个列列表和一个视图列表等。
2.  每个对象都是一个“哑”对象，只拥有自己的属性，并且您提供一组服务来检索层次结构，例如 GetServerDatabases(Server)、GetDatabaseColumns(Database)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T11:22:13.037

如果您要遵循 OO 设计原则，那么两者都是正确的。第二个选项称为协调对象，有助于防止 API/Core 的状态（您想要的任何名称）被篡改和破坏。

第一个选项是它在内部的保存方式，如果你想允许的话，你可以选择允许访问数据库的服务器属性。

我自己的偏好是限制 4 个对象上的任何设置器，并通过协调/外观对象（[外观模式](http://en.wikipedia.org/wiki/Facade_pattern)）强制执行此操作。让服务器将其数据库作为属性提供，依此类推。

正如所指出的那样 Server.Databases 属性可能很重。在这种情况下，可以通过协调对象（外观）来访问它。

所以：

```
GetServers()
GetDatabases(Server)
GetColumns(Database) 
```

等等

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T11:22:06.530

我相信第二种方法与 FlyWeight 模式相匹配：对象不直接聚合它们的子对象，它们只知道如何到达它们。使用数据库时，您*不需要*一直存在所有层次结构，因此在这种情况下，我更喜欢愚蠢的方法。

然而，FlyWeight 可以通过一些缓存来丰富，以避免多次检索相同的数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T11:23:03.067

如果您使用像 Hibernate 这样的 OR-Mapping，那么我肯定会使用深层对象层次结构。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-20T05:03:48.097

你也可以两者都做。用于命令的深度模型和用于查询的平面模型。这称为命令查询分离 (CQS)，在应用之前，我建议您了解更多有关它的知识。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T11:16:44.763

我更喜欢第一种方法。尽管有时您可能会过度设计并创建过于细化的类，但总的来说，我认为每个对象都具有智能的树状结构比具有一组辅助方法的“哑”对象集合要好得多且面向对象。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-19T16:05:16.720

您的数据库架构应该适合您的需求。如果您需要参照完整性，并且想要依赖一些数据库级联功能，并且没有大的性能瓶颈，那么您的架构应该反映这一点。使用 RDBMS 时，如果有充分的理由，您希望展平您的表，否则，您最终会得到大量重复或空字段，这会消耗资源并可能使您的查询复杂化，因为它们考虑了所有特殊情况——使用为 RDBMS 设计的基于集合的操作要容易得多。如果您遵循将表与域中的每个“实体”匹配的方法，您应该没问题。

对于更复杂的实体模型，CQS 上 +1。在这种情况下，您需要为您的命令维护一个深度模型，并为您的查询维护一个单独的扁平化版本。如果您不想遵循 CQS，您可以将您的深度模型展平为内存中的 DTO。否则，您可以在数据库中创建一组单独的表或视图以进行查询。第二个选项似乎更符合 CQS，您可能会更轻松地处理可能遇到的一些更复杂的查询。

# flash - 如何使用 Flash AS3 断开与相机的连接？

> ID：877184
> 
> 赞同：1
> 
> 时间：2009-05-18T11:04:55.630
> 
> 标签：flash, actionscript-3, camera

我有一个使用连接到用户网络摄像头的 Flash 应用程序

```
public static function getCamera(name:String = null):Camera 
```

当应用程序使用网络摄像头完成时，它需要断开连接，因为它不必要地使用资源。我该怎么做？

为成为“微效率”怪胎而道歉。我什至不确定它的效率有多低，但我不喜欢相机在不使用时只是连接的想法。

我检查了 API 并发现没有功能可以做到这一点。

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-18T11:13:54.583

打电话给你[NetStream](http://livedocs.adobe.com/flex/2/langref/flash/net/NetStream.html#attachCamera%28%29)：

```
attachCamera(null); 
```

# macos - 如何让 Mac OS X 的“快速查看”功能对程序员更友好？

> ID：877186
> 
> 赞同：2
> 
> 时间：2009-05-18T11:05:57.907
> 
> 标签：macos, performance

有许多文本文件总是包含在常见的下载中，例如 rails 插件：LICENSE、ChangeLog、Rakefile 等。

我*知道*这些文件是纯文本的，但 Mac OS X 拒绝自动承认这一点。如果我在 Finder 中按空格键来激活“快速查看”，图标会变大，但文件内容不会显示，可能是因为它们没有文件扩展名。

如何阻止这种疯狂，以便我只需按空格键就可以*快速查看自述文件？*

我已经在我的 mac 上安装了大量的文本编辑器：这个问题纯粹是关于效率和使简单文件尽可能快地访问。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T11:46:26.590

我想知道人们在不质疑提问者的优先级的情况下乐于回答 StackOverflow 问题之前需要多长时间。

感谢 Agos 提供指向语法着色插件的指针。经过多次冲浪后，我找到了我正在寻找的确切 QuickLook 增强功能：

[http://whomwah.github.com/qlstephen/](http://whomwah.github.com/qlstephen/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-07T17:41:29.450

Try this:

[http://code.google.com/p/qlcolorcode/](http://code.google.com/p/qlcolorcode/)

Does syntax highlighting for a lot of languages, and if it's a language it doesn't understand, it just displays. Seems to work for me.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T11:12:19.047

您必须安装（或可能从头开始开发）一个合适的快速查看插件。
您可以在以下网站上找到大量它们：

*   [www.quicklookplugins.com](http://www.quicklookplugins.com/)
*   [www.qlplugins.com](http://www.qlplugins.com/)

一个很好的起点是获得一个语法着色插件！

# intellij-idea - 不用鼠标打开文件，intellij idea 8.1

> ID：877188
> 
> 赞同：4
> 
> 时间：2009-05-18T11:06:43.520
> 
> 标签：intellij-idea

是否有一些简单的方法可以仅使用键盘打开文件（不在项目中）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-18T11:09:24.403

我在 6 而不是 8.1，但以下可能成立。

`Ctrl`++`Shift`适用`N`于项目中的文件。对于项目之外的文件，没有默认的 Keymap。你可以自己设置一个。

转到首选项-键盘映射-主菜单-文件-打开文件...并将其设置为您想要的任何击键。

我刚刚尝试了仅使用键盘打开对话框，这还不错，您只需要知道留在文件名框中即可。因此，如果您想要 /home/user 然后键入 /home/user 并按回车键，它会将您更改为该目录。不如 crtl-shift-N 中的漂亮完成，但也不是不可用。

# c++ - 将 Delphi 逐步移植到 C++

> ID：877193
> 
> 赞同：5
> 
> 时间：2009-05-18T11:09:02.190
> 
> 标签：c++, delphi, qt

我有一个用 Delphi 编写的大型应用程序。我想更新它，从用户界面开始。我考虑过使用新的Qt。在更新它的过程中，我想更改为 C++ 作为编程语言。有没有办法逐步重写应用程序（从 UI 开始）以更改为 C++？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-18T11:49:19.800

最佳行动方案高度依赖于 C++ 开发环境。

**如果是 C++ Builder，您有两种可能性：**

*   使用运行时包而不是普通的 DLL。当涉及到字符串编组和将类层次结构映射到平面 DLL 函数时，这将使您免去很多麻烦。

*   使用混合代码。您可以在同一个项目中混合使用 Delphi/Pascal 代码和 C++ 代码。（虽然单个模块/单元中只有一种语言）

**如果它是任何其他 C++ 编译器：**

*   按照您建议的方式使用 DLL。您必须创建某种层/外观来将类的功能映射到平面 DLL 函数。

*   如果您想使用普通的 DLL 方式，即使您使用的是 C++ Builder，您可以尝试使用共享内存管理器，如 ShareMem（Delphi 附带）或 FastMM（[SourceForge](http://sourceforge.net/projects/fastmm/)）来允许传递`string`s 而不是`PChar`s。

*   创建 .objs 而不是 .dcus，以便两个编译器使用相同的输出格式。然后将它们直接链接到您的 C++ 程序中。这与创建 DLL 基本相同，但它是静态的。您将在编译时而不是运行时发现某些类型的错误。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-18T11:17:14.247

换一种方式可能更容易——用 C++ 重写业务逻辑并通过 C 接口从 Delphi 调用它。尤其如此，因为 Delphi 的主要优势之一是使用 GUI。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T11:16:04.470

将您的 Delphi 应用程序转换为 dll-s。您应该找出一些合理的 API 并将其公开在 dll 中。然后使用 C++ 应用程序中的那个 dll-s。

也有可能创建 COM+ 对象，但它们是特定于 Windows 的技术（因为 QT，我想您打算创建多平台应用程序）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-18T14:12:04.333

一般来说，虽然有异种语言选项，但我总是发现冻结旧版本并用新语言重写下一个主要版本最终会更省时。

但我反其道而行之。（增加我最终向后移植到 Delphi 的 C++ 百分比）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-10T20:15:10.957

我也有同样的需求 - 将 9 年历史的项目从 D2010 迁移到 QT 4.6，大约 300K+ 行代码。我决定执行以下操作：

1.  使用 DISql3 将 ADO 依赖项移植到 Delphi 中的 SQLite 驱动程序。
2.  将我的 MS 数据库迁移到 SQLite
3.  通过将 db 控件放在包装数据访问类和其他 UI 相关控件（如表单中的 ImageLists）中来删除数据模块。
4.  清楚地分离模型（数据库访问）、视图（表单）和控制器。从这种方式开始，我可以开始移植模型和控制器并逐步执行单元测试
5.  最后将视图（表单）迁移到 QT 对话框。这是最难的部分，因为一个普通的应用程序至少依赖于 3-4 个第三方控件。例如，我在 VCL 中大量使用 DevExpress，并计划用 QTitan 替换它（http://www.devmachines.com/qtitan_grid_overview.php）

目前我处于第 2 阶段，但我非常有信心增量方法会奏效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-05T15:58:53.790

我理解你，因为我也是一名 delphi 开发人员，我也想将我的代码迁移到 QT 框架，即 c++ 中。我想达到跨平台的目标：所以我放弃了保留原始源代码的dll解决方案，因为它迫使我保持​​delphi IDE处于待机状态。我不想再回去编写/修复/改进delphi代码了..我想进化！我看到的唯一选择是用c ++重写delphi代码并用QT creator重新编译（详细地说，它将用QT creator调用的g ++ mingw编译器重新编译。）

重写你的代码将为你提供重构你的类以符合“QTed”的机会。gui 也将被完全重写，因为 VCL 是事件驱动的，而 QT 是信号驱动的，但我认为您已经知道这一点。

请记住：保持您的 delphi 代码完整并将其构建为 dll 库或将其编译为 objs，将迫使您保持对 delphi 源代码的维护。

# asp.net-mvc - 如何在 ASP.NET MVC 中模拟 IsStartupScriptRegistered

> ID：877194
> 
> 赞同：1
> 
> 时间：2009-05-18T11:09:08.007
> 
> 标签：asp.net-mvc

在 Web 窗体中，通过这种方法注册脚本很容易，并且为了避免重复脚本，您只需在 If 语句中使用 !IsStartupScriptRegistered()。

你怎么能在 MVC 中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T12:01:49.883

很简单，你可以完成一些自定义的 js 代码。它可能会在页面末尾呈现内容并维护一系列键值字段。因此，当您为 !IsStartupScriptRegistered() 进行 cjeck 时，请使用 Key 作为参数。很简单。所以我可以在这里提到这个东西的一些自定义实现，但我不会:) 尝试手动完成，我知道你会喜欢的！祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T11:13:28.453

我猜这个功能没有 1:1 的副本。

一些代码：

```
<%@ Control Language="C#" 
    Inherits="System.Web.Mvc.ViewUserControl<IList<Item>>" %>
<script src="../src/preciousJavascript.js" type="text/javascript"/>
<%foreach (var item in Model){%>
<% Html.RenderPartial("_Item",item); %>
<%}%>

<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<Item>" %>
<%=Item.Name %> 
```

也许这可以清除一些东西

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-04T16:03:26.307

这可能会有所帮助，尽管它更多地用于脚本引用而不是启动脚本（继续阅读资源跟踪部分）。[http://stephenwalther.com/blog/archive/2008/08/22/asp-net-mvc-tip-36-create-a-popup-calendar-helper.aspx](http://stephenwalther.com/blog/archive/2008/08/22/asp-net-mvc-tip-36-create-a-popup-calendar-helper.aspx)

# iphone - 有没有办法计算出动画期间视图当前旋转了多少度？

> ID：877198
> 
> 赞同：7
> 
> 时间：2009-05-18T11:09:38.677
> 
> 标签：iphone, core-animation

我正在使用此变换在动画块中应用旋转变换动画：

```
CATransform3D rotatedTransform = self.layer.transform;
rotatedTransform = CATransform3DRotate(rotatedTransform, 90 * M_PI / 180.0, 0.0f, 0.0f, 1.0f);
self.layer.transform = rotatedTransform; 
```

动画开始，用户启动另一个必须将旋转推向新目标的事件。要计算逼真的外观行为，我需要知道当前的旋转度数是多少，以便可以适当地累加下一个旋转度数。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-09-11T22:27:57.893

这是一个老问题，但我在尝试在关键帧动画期间找到当前旋转角度时遇到了这个答案：-

```
CALayer* layer = [self.layer presentationLayer];
float currentAngle = [[layer valueForKeyPath:@"transform.rotation.z"] floatValue]; 
```

似乎对我有用。此外，美观简洁。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T16:41:33.797

您可以通过抓取它的presentationLayer 来检索动画层的当前状态。假设您没有对图层应用任何其他变换，您可以使用如下代码提取旋转图层的当前角度：

```
CATransform3D rotationTransform = [(CALayer *)[self.layer presentationLayer] transform];
float angle;
if (rotationTransform.m11 < 0.0f)
    angle = 180.0f - (asin(rotationTransform.m12) * 180.0f / M_PI);
else
    angle = asin(rotationTransform.m12) * 180.0f / M_PI; 
```

在其他未修改的变换中，m11 和 m12 值是位于单位圆上的坐标，因此您可以使用三角函数来确定它们所描述的角度。

编辑（2009 年 5 月 18 日）：向 CALayer 添加了类型转换以克服编译器警告，并修复了三角运算中转换的命名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-04T10:12:50.933

尝试这个：

```
CGFloat setAngle = 75.0;
CATransform3D t = CATransform3DIdentity;
t.m34 = 0.004;
t = CATransform3DRotate(t, -M_PI/180*setAngle, 0, 1, 0);
self.testView.layer.transform = t;

CGFloat getAngle = 0;
if (t.m11 < 0.0f) {
    getAngle = 180.0f - (asin(t.m13) * 180.0f / M_PI);
} else {
    getAngle = asin(t.m13) * 180.0f / M_PI;
}
NSLog(@"setAngle=%@ getAngle=%@", @(setAngle), @(getAngle)); 
```

# perl - Perl：将输入文件名添加到输出文件名

> ID：877201
> 
> 赞同：0
> 
> 时间：2009-05-18T11:11:27.893
> 
> 标签：perl, file

我编写了一个脚本，它读取目录中的每个文件，执行某些操作并将每个输入文件的结果输出到两个不同的文件，例如“outfile1.txt”和“outfile2.txt”。我希望能够将生成的文件链接到原始文件，那么如何将输入文件名（infile.txt）添加到生成的文件名中，以获得如下内容：

infile1_outfile1.txt，infile1_outfile2.txt

infile2_outfile1.txt, infile2_outfile2.txt

infile3_outfile1.txt，infile3_outfile2.txt ...？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T11:21:51.070

使用替换从输入文件名中删除“.txt”。使用字符串连接来构建输出文件名：

```
my $infile = 'infile1.txt';

my $prefix = $infile;
$prefix =~ s/\.txt//;  # remove the '.txt', notice the '\' before the dot

# concatenate the prefix and the output filenames
my $outfile1 = $prefix."_outfile1.txt";
my $outfile2 = $prefix."_outfile2.txt"; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T11:24:41.660

```
use File::Basename;
$base = basename("infile.txt", ".txt");
print $base."_outfile1.txt"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T11:21:09.543

简单的字符串连接应该在这里工作，或者在 cpan 上寻找合适的模块

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T11:21:55.003

如果我理解正确，您是否正在寻找这样的东西？

```
use strict;
use warnings;

my $file_pattern = "whatever.you.look.for";
my $file_extension = "\.txt";

opendir( DIR, '/my/directory/' ) or die( "Couldn't open dir" );
while( my $name_in = readdir( DIR )) {
    next unless( $name_in =~ /$file_pattern/ );

    my ( $name_base ) = ( $name_in =~ /(^.*?)$file_pattern/ );
    my $name_out1 = $name_base . "outfile1.txt";
    my $name_out2 = $name_base . "outfile2.txt";
    open( IN,   "<", $name_in )   or die( "Couldn't open $name_in for reading" );
    open( OUT1, ">", $name_out1 ) or die( "Couldn't open $name_out1 for writing" );
    open( OUT2, ">", $name_out2 ) or die( "Couldn't open $name_out2 for writing" );

    while( <IN> ) {
        # do whatever needs to be done
    }

    close( IN );
    close( OUT2 );
    close( OUT1 );
}
closedir( DIR ); 
```

编辑：扩展剥离实施，输入文件句柄关闭，现在测试。

# vim - 通过omnicppcomplete选择func后如何获取func原型？

> ID：877206
> 
> 赞同：0
> 
> 时间：2009-05-18T11:13:01.870
> 
> 标签：vim, autocomplete, omnicomplete, omnicppcomplete

有没有办法让vim在通过omnifunc选择它之后粘贴函数的参数（或者至少在选择它之后显示它，**但不是在之前**）？就像是：

myObject.play( **int time, std::string foo** )

甚至可能允许您通过选项卡浏览那些片段插件允许您执行的参数。

有这样的插件或功能吗？我认为这非常有用。

顺便说一句，omnifunc 的预览选项很慢，选择功能后不会显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T16:54:07.393

尝试[code_complete](http://www.vim.org/scripts/script.php?script_id=1764)。

它使用 ctags 来完成函数签名，并允许您循环浏览参数列表。它也可以完成其他东西——标准头文件、`for()`/`switch()`块等。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-18T12:31:19.840

您可以从 vim 网站获取[snippetsEMU 插件](http://www.vim.org/scripts/script.php?script_id=1318)，然后为该功能设置一个自定义片段，如下所示：

```
:Snippet play myObject.play(int <{time}>, <{std::string}> <{foo}>)<{}>
```

这样，您所要做的就是键入 play 并按 Tab 键以使其展开，花括号将允许您通过 args 进行制表符。希望这就是你要找的...

# sql-server - 如何使用 COUNT 值在 SQL 中编写条件

> ID：877216
> 
> 赞同：0
> 
> 时间：2009-05-18T11:15:50.007
> 
> 标签：sql-server

嗨，我有两个表，我需要根据计数将值插入到临时表中

```
IF(@COUNT>1)
BEGIN
insert into #temp_cols  
SELECT M.ID_PK,  
substring(M.NAME,1,1)+'_'+ N.NAME 
FROM TEST_TABLE1 M WITH (NOLOCK) 
LEFT JOIN TEST_TABLE2 N  ON M.ID_PK=N.ID_FK  
END

ELSE
BEGIN
insert into #temp_cols  
SELECT M.ID_PK,  
N.NAME 
FROM TEST_TABLE1 M WITH (NOLOCK) 
LEFT JOIN TEST_TABLE2 N  ON M.ID_PK=N.ID_FK 
END 
```

其中@count 应该等于 select count(name) from test_table2 group by name 返回一组列，@count 应该一次取一个列值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T11:55:02.207

这是另一种方式。如果想法是根据 TestTable2 中是否有重复项来不同地显示名称，那么这将起作用：

```
DECLARE @Count int
SELECT @Count = COUNT(name) FROM test_table2 GROUP BY name HAVING COUNT(name) > 1

INSERT INTO #temp_cols  
SELECT 
   M.ID_PK,  
   CASE 
      WHEN @Count > 1 THEN SUBSTRING(M.NAME, 1, 1) + '_' + N.NAME
      ELSE N.Name
   END,    
FROM TEST_TABLE1 M WITH (NOLOCK) 
  LEFT JOIN TEST_TABLE2 N  ON M.ID_PK = N.ID_FK 
```

**编辑：**另一方面，如果目的是仅在 TestTable2 中有匹配的 ID 时更改名称的显示，这将起作用，而且非常简单：

```
INSERT INTO #temp_cols  
SELECT 
   M.ID_PK,  
   ISNULL(SUBSTRING(M.NAME, 1, 1) + '_' + N.NAME, M.Name) As Name   
FROM TEST_TABLE1 M WITH (NOLOCK) 
  LEFT JOIN TEST_TABLE2 N  ON M.ID_PK = N.ID_FK 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T12:00:51.447

我创建了一些这样的测试数据：

```
 id_pk | name | id_fk |  name  
-------+------+-------+--------
     1 | foo  |     1 | jingle
     1 | foo  |     1 | jangle
     2 | bar  |     2 | jangle
     3 | quux |       | 
```

并写了一个查询：

```
select m.id_pk, case when groupcount.name_count > 1 then substring(m.name, 1, 1) + '_' + n.name else m.name end
from test_table1 m
  left join test_table2 n on m.id_pk = n.id_fk
  left join (select name, count(name) as name_count from test_table2 group by name) groupcount on n.name = groupcount.name 
```

这产生了这个：

```
 id_pk |   name   
-------+----------
     1 | foo
     1 | f_jangle
     2 | b_jangle
     3 | quux 
```

我认为您可能在“其他”分支中指的是 m.name 而不是 n.name ？

我**猜测**（这就是示例输出有用的原因）从您的“@count 一次应采用一个列值”中，您需要从 test_table2 中每个名称的行数派生 @count。

我相信该查询的输出是您想要进入临时表的内容：在这种情况下，请在其前面加上“插入 #temp_cols”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T11:46:16.747

```
IF EXISTS (select count(name) from test_table2 group by name HAVING count(name) > 1)
BEGIN
  insert into #temp_cols  
  SELECT M.ID_PK,  
  substring(M.NAME,1,1)+'_'+ N.NAME 
  FROM TEST_TABLE1 M WITH (NOLOCK) 
  LEFT JOIN TEST_TABLE2 N  ON M.ID_PK=N.ID_FK  
END

ELSE
BEGIN
  insert into #temp_cols  
  SELECT M.ID_PK,  
  N.NAME 
  FROM TEST_TABLE1 M WITH (NOLOCK) 
  LEFT JOIN TEST_TABLE2 N  ON M.ID_PK=N.ID_FK 
END 
```

# .net - 关闭 Quartz .Net 中的调试日志记录

> ID：877217
> 
> 赞同：19
> 
> 时间：2009-05-18T11:15:58.570
> 
> 标签：.net, quartz.net

我正在使用 Quartz.NET 在我们的应用程序中安排一些自定义任务。一切正常，只是它在一秒钟内记录了大约 20 个调试条目。

我不知道如何关闭调试日志记录。任何帮助将不胜感激，因为我一直在尝试在网上查找但没有运气。

调试条目如下所示

```
DEBUG 2009-05-12 03:24:14,000 8612670ms StdRowLockSemaphore    ObtainLock         - Lock 'TRIGGER_ACCESS' is desired by: SchedulerFactory_QuartzSchedulerThread
DEBUG 2009-05-12 03:24:14,029 8612699ms StdRowLockSemaphore    ExecuteSQL         - Lock 'TRIGGER_ACCESS' is being obtained: SchedulerFactory_QuartzSchedulerThread
DEBUG 2009-05-12 03:24:14,029 8612699ms StdRowLockSemaphore    ObtainLock         - Lock 'TRIGGER_ACCESS' given to: SchedulerFactory_QuartzSchedulerThread
DEBUG 2009-05-12 03:24:14,034 8612704ms StdRowLockSemaphore    ReleaseLock        - Lock 'TRIGGER_ACCESS' returned by: SchedulerFactory_QuartzSchedulerThread
DEBUG 2009-05-12 03:24:14,035 8612705ms StdRowLockSemaphore    ObtainLock         - Lock 'TRIGGER_ACCESS' is desired by: SchedulerFactory_QuartzSchedulerThread
DEBUG 2009-05-12 03:24:14,035 8612705ms JobRunShell            Run                - Calling Execute on job DEFAULT.ProcessIncomingMTRJob 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2011-11-01T21:16:54.460

如果您想减少通过通用日志记录基础设施的所有日志记录，[Rytmis 的回答非常棒。](https://stackoverflow.com/questions/877217/turn-off-debug-logging-in-quartz-net/877269#877269)

但是，如果您通过 Common Logging 有更多的代码日志记录，并且您只想减少来自 Quartz（**而不是您的代码的其余部分**）的日志记录量，我建议这样做：

在 log4net config xml 中（`app.config`通常）你可能已经有这样的东西：

```
 <root>
        <level value="ALL" />
        <appender-ref ... />
        ...
    </root> 
```

保持原样。之后（或`<log4net>`配置部分内的任何地方）只需添加以下内容：

```
 <logger name="Quartz">
        <level value="ERROR" />
    </logger> 
```

本`<logger>`节将使用命名空间“Quartz”配置所有记录器。所以在这个例子中，Quartz 将使用 level 进行记录，`ERROR`而我的应用程序的其余部分将使用 level 进行记录`ALL`。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-10-22T12:30:28.240

如果有人需要在 NLog 中执行此操作，只需在 NLog.Config 中添加以下作为最顶层的规则

```
<!-- Disable Quartz info logging -->
<logger name="Quartz*" minlevel="Trace" maxlevel="Info" final="true" /> 
```

请注意，如果您不希望更改`maxlevel="Info"`为`maxlevel="Fatal"`

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-18T11:30:46.763

Quartz.net 使用 Common.Logging，所以在你的 App.config/Web.config 中是这样的：

```
<configSections>
    <sectionGroup name="common">
        <section name="logging" type="Common.Logging.ConfigurationSectionHandler, Common.Logging" />
    </sectionGroup>
</configSections>

<common>
    <logging>
        <factoryAdapter type="Common.Logging.Simple.**youradapterhere**, Common.Logging">
            <arg key="level" value="ERROR" />
        </factoryAdapter>
    </logging>
</common> 
```

请务必将*youradapterhere*更改为您正在使用的实际日志记录适配器，或者如果您想完全禁用日志记录，则为 NoOpLoggerFactoryAdapter。

* * *

** 编辑：** 基于 Ganesh 的评论：

```
<sectionGroup name="common"> 
    <section name="logging" type="Common.Logging.ConfigurationSectionHandler, Common.Logging"/> 
</sectionGroup> 
<common>  
    <logging>  
        <factoryAdapter type="Common.Logging.Log4Net.Log4NetLoggerFactoryAdapter, Common.Logging.Log4Net">  
            <arg key="configType" value="INLINE"/>  
            <arg key="configFile" value="filename"/>  
            <arg key="level" value="ERROR" /> <!-- add this line here -->
        </factoryAdapter>  
    </logging> 
</common> 
```

* * *

** 编辑 2：**

为了那些不想阅读评论的人的利益，日志级别实际上是在 log4net 根配置中设置的：

```
<log4net>
    <root>
        <level value="DEBUG" /> <!-- This is the value that needed changing -->
        <appender-ref ref="Console" />
        <appender-ref ref="RollingFile" />
    </root>
</log4net> 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2020-05-05T09:17:53.863

在我关闭 Quartz.net 日志记录的情况下，我只需在配置调度程序的 C# 代码中添加此属性。

`LogProvider.IsDisabled = true;`

总体来看：

```
public static async void Start()
    {

        LogProvider.IsDisabled = true;
        ISchedulerFactory schedulerFactory = new StdSchedulerFactory();
        IScheduler scheduler = await schedulerFactory.GetScheduler();
        await scheduler.Start();

        IJobDetail job = JobBuilder.Create<SendNotificationJob>().Build();

        ITrigger trigger = TriggerBuilder.Create()

            .WithDailyTimeIntervalSchedule
              (s =>
                 s.WithIntervalInSeconds(1)
                .OnEveryDay()
                .StartingDailyAt(TimeOfDay.HourAndMinuteOfDay(0, 0))
              )
            .Build();

        await scheduler.ScheduleJob(job, trigger);
    } 
```

并且不要忘记使用以下命令添加：

```
using Quartz.Logging; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-01-14T08:15:39.547

对于那些在使用 NLog (nlog.config) 时根本不想要 Quartz 日志记录的人（即在作业代码中自己的日志记录就足够了）：

```
<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      autoReload="true"
      internalLogLevel="info"
      internalLogFile="path_to_nlog_log_file">

  <!-- the targets to write to -->
  <targets async="true">
    <target name="database" type="Database">
      <commandText>
        <!-- insert into some table -->
      </commandText>
      <!-- parameters here -->
    </target>    

    <target xsi:type="Null" name="blackhole" />
  </targets>

  <!-- rules to map from logger name to target -->
  <rules>
    <!--Skip Microsoft/Quartz logs and so log only own logs-->
    <logger name="Microsoft.*" minlevel="Trace" writeTo="blackhole" final="true" />
    <logger name="Quartz*" minlevel="Trace" maxlevel="Info" writeTo="blackhole" final="true" />
    <logger name="*" minlevel="Debug" writeTo="database" />
  </rules>
</nlog> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-11-30T08:19:27.623

如果您只想删除丰富的信息和调试日志，我会添加

```
<logger name="Quartz.*" minlevel="Error" writeTo="default" final="true"/> 
```

基于[这个](https://stackoverflow.com/a/26507498/7032856)答案。这基本上保证了 Quartz 汇编错误和致命错误被写入，而其他日志则没有。

# jquery - html(val)、text(val)、append(content) 等

> ID：877220
> 
> 赞同：3
> 
> 时间：2009-05-18T11:16:25.717
> 
> 标签：jquery

这个问题听起来可能很主观，但我确实需要做出选择，为了让我这样做，我需要一些经验丰富的声音。

是否有资源、链接或意见描述何时以及考虑使用 jquery 的 html(val)、text(val) 和 append(content) 将内容注入元素的时间？

这些可以比较吗？还是它们都是为单独的任务而设计的？

问候，

凯姆

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-18T11:24:53.640

好吧，[html(val)](http://docs.jquery.com/Attributes/html#val)替换**html**内容，[text(val](http://docs.jquery.com/Manipulation/append#content) ) 总是插入文本（不是标签），而[append(val)](http://docs.jquery.com/Manipulation/append#content)将 html 内容附加到现有的 html 内容。它们是 html(val) 最强大的不同功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T13:26:12.490

**text(val)** == [innerTEXT](http://msdn.microsoft.com/en-us/library/ms533899(VS.85).aspx)（仅适用于 IE，因此 jQuery 使跨浏览器成为可能）

**html(val)** == [innerHTML](https://developer.mozilla.org/En/DOM/Element.innerHTML)（像这种 DOM 方法一样工作）

**append(val)** == [Node.appendChild](https://developer.mozilla.org/En/DOM/Element.appendChild)

> *这些可以比较吗？*
> 好吧，您可能会在某些情况下将 html(val) 与 text(val) 进行比较，
> 但在某些情况下 text() 不能替换 html()。

> *还是它们都是为单独的任务而设计的？*
> 是的，它们是为单独的任务而设计的，请参阅[visualjquery中的一些示例](http://www.visualjquery.com/)

# asp.net - asp.net：runat="server" 和服务器控件之间的区别

> ID：877227
> 
> 赞同：11
> 
> 时间：2009-05-18T11:19:21.560
> 
> 标签：asp.net, runatserver

功能上有什么区别

```
<asp:Button id="button1" Text="Click me" runat="server" OnClick="submitEvent" /> 
```

和

```
<input type="button" id="button1" runat="server" value="Click me" /> 
```

具有 runat="server" 属性的输入是否具有其他或有限的属性和方法？

谢谢！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-18T11:35:05.117

第一个创建一个`System.Web.UI.WebControls.Button`while 第二个创建一个`System.Web.UI.HtmlControls.HtmlInputButton`.

两者都是服务器控件，但`WebControls`命名空间中的控件通常比命名空间中的控件具有更多功能`HtmlControls`。通常他们会放入一些数据`ViewState`来跟踪他们的状态，并且他们有服务器端的回发事件。

命名空间中的每个控件都`HtmlControls`与一个 HTML 元素完全对应，而`WebControls`命名空间中的控件的呈现方式可能会有所不同，具体取决于请求页面的浏览器可以支持的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T11:50:13.353

表示的按钮`<asp:Button runat="server".../>`将被转换为具有丰富状态模型和不同属性和方法的 Web 服务器控件，在现实世界中具有更清晰的表示，例如 Button.Text = "Click Me"。

所代表的按钮`<input type="button" runat="server"..../>`将被转换为HtmlInputButton所代表的html服务器控件；with 具有有限的属性、方法和事件。大多数属性类似于 Button.Value="Click Me" 等 html 等效项。

请注意，标记页面中的元素在使用之前经过预处理/编译，并将转换为类表示，其中每个元素都由控件表示。您可以从后面的代码访问由 runat="server" 标记标识的服务器端控件，因为它们将具有正确匹配的服务器控件（web/html），其他静态内容包括没有`<input type="button.../>`runat="server" 的标记将表示为 LiteralControl。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T11:25:04.683

前一行是 ASP.NET，后一行是简单的 XHTML。

前者在服务器端进行解析和解释，然后生成 HTML 代码，这几乎对应于您的第二个示例。ASP.NET 按钮实际上只是对 HTML 输入按钮功能的轻量级包装器，应该在需要处理`Click`服务器端事件（或在一般情况下为任何事件）的任何地方使用，并且通常是去吧，因为您让 ASP.NET 为您抽象出页面上的按钮概念。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T12:55:17.997

这两个控件的功能相同，区别在于第一个是 .net 控件，第二个是 html 控件，可以通过使用

运行=“服务器”。

第一个有丰富的事件和方法然后第二个....

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-18T11:24:45.513

没有与此类控件关联的服务器事件，但您可以在代码隐藏中使用它来更改它的属性。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-05-18T11:23:07.683

您的第二个选项甚至可能都行不通。runat="server" 将直接呈现到 HTML 输出，它没有任何功能，只会破坏 HTML 验证。

input 是一个 HTML 元素，它只有 HTML 属性，绝对没有任何类型的方法。

# apache - 如何编写 .htaccess 重写规则将查询字符串转换为分段 URI？

> ID：877231
> 
> 赞同：0
> 
> 时间：2009-05-18T11:21:18.373
> 
> 标签：apache, .htaccess, url-rewriting, query-string

有没有办法在 htaccess 中放置一个重写规则，将查询字符串转换为分段的 URI？例如。

```
http://domain.com/controller/method/?a=1&b=2&c=3 
```

应该重写为

```
http://domain.com/controller/method/a/1/b/2/c/3 
```

所有要做的就是删除 ? 并用 / 替换 &s 和 =s，但我不太确定所有这些数字是如何进入 .htaccess ...

没关系，但我在 Apache 上使用 PHP 和 CodeIgniter。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T11:24:58.960

你为什么不把这个逻辑放在你的 CodeIgniter 控制器中，而不是放在 .htaccess 中呢？

查看[CodeIgniter 的用户指南](http://codeigniter.com/user_guide/general/urls.html)以处理查询字符串和 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T11:38:20.743

如果您想在 .htaccess 中执行此操作，您需要有 mod_rewrite。

规则并不太难。我给你一个最小的例子，你需要调整正则表达式来解决你的需要。

```
RewiteRule ^/([a-z]+)/([a-z]+)$ /method/?$1=$2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T11:45:06.080

这是你可以做的：

```
RewriteCond %{THE_REQUEST} ^GET\ /[^?]*\?
RewriteCond %{QUERY_STRING} ^([^&=]+)=?([^&]*)&([^&=]+)=?([^&]*)&?(.*)
RewriteRule ^ %{REQUEST_URI}/%1/%2/%3/%4?%5 [L]
RewriteCond %{THE_REQUEST} ^GET\ /[^?]*\?
RewriteCond %{QUERY_STRING} ^([^&=]+)=?([^&]*)&?(.*)
RewriteRule ^ %{REQUEST_URI}?/%1/%2?%3 [L] 
```

# batch-file - 批处理文件未能在条件语句中设置环境变量

> ID：877232
> 
> 赞同：14
> 
> 时间：2009-05-18T11:21:25.457
> 
> 标签：batch-file

为什么下面的 Windows Batch File 输出`Foo`后跟`Bar`，而不是`Baz`？

```
@echo off
setlocal

set _=Foo
echo %_%
set _=Bar
if 1==1 (
    set _=Baz
    echo %_%
) 
```

我的系统（Microsoft Windows XP [版本 5.1.2600]）上的输出是：

```
Foo
Bar 
```

如果我删除条件语句，则会观察到`Foo`and的预期输出。`Baz`

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-18T13:21:40.550

发生的事情是在读取一行时完成了变量替换。您没有考虑到以下事实：

```
if 1==1 (
    set _=Baz
    echo %_%
) 
```

是*一条*“线”，不管你怎么想。的扩展在语句*之前*`"%_%"`完成。*`set`*

 *您需要的是延迟扩展。几乎我的每一个命令脚本都`"setlocal enableextensions enabledelayedexpansion"`以`cmd.exe`.

所以我的脚本版本是：

```
@echo off
setlocal enableextensions enabledelayedexpansion

set _=Foo
echo !_!
set _=Bar
if 1==1 (
    set _=Baz
    echo !_!
)

endlocal 
```

这会生成正确的`"Foo", "Baz"`而不是`"Foo", "Bar"`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T11:42:33.790

此问题的答案与以下问题的答案相同：[Weird scope issue in batch file](https://stackoverflow.com/questions/305605/weird-scope-issue-in-bat-file)。有关详细信息，请参见那里。基本上变量扩展是在行读取时完成的，而不是在执行时。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T11:30:38.557

试试这个

```
@echo off
setlocal

set _=Foo
echo %_%
set _=Bar
if "1" NEQ "2" goto end
set _=Baz
echo %_%
:end 
```

# c - 怀疑“gdb”下的尾部优化代码

> ID：877241
> 
> 赞同：4
> 
> 时间：2009-05-18T11:23:03.737
> 
> 标签：c, gcc, gdb, tail-recursion

考虑 C 中的尾递归阶乘实现：

```
#include <stdio.h>

unsigned long long factorial(unsigned long long fact_so_far, unsigned long long count, unsigned long long max_count){

if (max_count==0 || max_count==1 || count >= max_count)
        return fact_so_far;
else
{
        printf("%llu  %p \n", count, &factorial);
        return factorial(fact_so_far * count, ++count, max_count);
}

}

int main(int argc, char **argv)
{
        unsigned long long n;
        scanf("%llu", &n);
        printf("\n Factorial %llu \n",factorial(1,0,n));
        return 0;

} 
```

我在“阶乘”中放置了一个断点，然后在“gdb”下运行上面的代码。断点永远不会被击中。

假设它的尾调用已优化（我已使用 gcc -O2 对其进行编译），它应该至少命中一次断点，IIRC。

编辑：我得到最终结果而没有遇到任何断点。例如，

```
(gdb) b factorial
Breakpoint 1 at 0x8048429: file factorial-tail.c, line 3.
(gdb) run
Starting program: /home/amit/quest/codes/factorial-tail 
5
0  0x8048420 
1  0x8048420 
2  0x8048420 
3  0x8048420 
4  0x8048420 

 Factorial 120 

Program exited normally.
(gdb) 
```

我哪里错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T11:29:23.583

对我来说很好。您是否在编译时使用 -g 标志添加调试信息？你还记得你必须输入一个数字来计算阶乘吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T02:10:03.307

可能是阶乘函数被内联到 main 中。如果发生这种情况，将会有第二个阶乘副本用于来自其他 .c 文件的调用；那就是您的断点所在的位置。尝试传递 -fno-inline。

# wpf - 我有 2 个带有图像的列表框。当我在第二个列表框中使用该图像时，我想隐藏第一个列表框的图像

> ID：877245
> 
> 赞同：0
> 
> 时间：2009-05-18T11:23:49.507
> 
> 标签：wpf, image, xaml, c#-3.0, listbox

我有 2 个带有图像的列表框。当我在第二个列表框中使用该图像时，我想隐藏第一个列表框的图像。而且我想知道我将图像添加到第二个列表框的时间。在第二个列表框中，图像应显示该图像的计数（在图像本身上）该图像添加的图像数量。有什么建议么..

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T13:04:02.207

您是否正在尝试创建选择列表？

# svn - 有没有办法知道SVN服务器的URL？

> ID：877246
> 
> 赞同：0
> 
> 时间：2009-05-18T11:24:06.747
> 
> 标签：svn, url, tortoisesvn, client-server, collabnet

现在，由于未知主机名错误，我们在允许客户端访问 SVN 服务器时遇到问题。是否有错误会告诉服务器计算机正确的 SVN 服务器 URL？

我在[Collabnet Subversion Server](http://en.wikipedia.org/wiki/CollabNet#CollabNet.27s_products)上，客户端使用 TortoiseSVN。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T11:34:23.573

“未知主机名错误”意味着由于某种原因您无法访问您在尝试与 Subversion 一起使用的 URL 中提到的主机。例如，如果您的 URL 是[http://myCollabnetSubversionServerName/svn/mySuperProject/trunk](http://myCollabnetSubversionServerName/svn/mySuperProject/trunk)，则意味着您无法访问 myCollabnetSubversionServerName。客户端计算机能否看到 myCollabnetSubversionServerName 服务器？

哦，对不起，还要回答这个问题本身：通常存储库的 URL 是 http:// 或 https://如果您在 LAN 中，后跟*服务器计算机的名称*，或者如果您的服务器在上，则为*域名*Internet，后面可能是您的 Web 服务器侦听的*端口*（如果是默认设置，则不必输入），然后是*svn*，然后是*存储库名称*。

例子：

*   [http://www.mycompany.com/svn/myrepositoryname/trunk](http://www.mycompany.com/svn/myrepositoryname/trunk)
*   [https://www.mycompany.com/svn/myrepositoryname/trunk](https://www.mycompany.com/svn/myrepositoryname/trunk)
*   [http://www.mycompany.com:81/svn/myrepositoryname/trunk](http://www.mycompany.com:81/svn/myrepositoryname/trunk)

或者

*   [http://myserver/svn/myrepositoryname/trunk](http://myserver/svn/myrepositoryname/trunk)
*   [https://myserver/svn/myrepositoryname/trunk](https://myserver/svn/myrepositoryname/trunk)
*   [http://myserver:81/svn/myrepositoryname/trunk](http://myserver:81/svn/myrepositoryname/trunk)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T11:27:14.383

那是颠覆错误吗？如果您的客户端无法解析您的 Subversion 服务器名称，这听起来更像是与 DNS/WINS 相关的错误。

如果 'ping hostname' 无法解析主机名，则不是 Subversion 错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T11:48:21.813

您可以使用例如 ping 访问服务器吗？

如果您使用服务器的 IP 地址而不是其主机名，也许会有所帮助。如果您想找出您的 IP 地址但不知道如何操作，您可以*从服务器访问*[http://www.whatismyip.com/](http://www.whatismyip.com/) 进行查找。这是假设您的服务器可以从互联网而不是本地网络访问。

 ** * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-20T04:42:23.910

如果有办法从服务器返回正确的服务器 URL，我真的很怀疑。未知主机名的解决方案是 - 在客户端系统上的 hosts 文件中创建一个条目，用于将 IP 地址映射到主机名 [SVN 服务器名称]

一般hosts文件位于-c:\Windows\System32\drivers\etc文件夹下，需要按照以下格式输入

192.168.0.1 SVN服务器名称

希望这可以帮助 ！

# jquery - 带有 jQ uery 的 ASP.NET - POST 与 GET

> ID：877254
> 
> 赞同：1
> 
> 时间：2009-05-18T11:25:54.107
> 
> 标签：jquery, post, asp.net-3.5, get

好的，我有一个非常愚蠢的问题要问（我必须承认，这让我很尴尬！）。我在 ASP.NET 3.5 WebForms 应用程序中使用 jQuery 的 nyroModal 插件。基本上，假设我有一个指向*[http://www.mysite.com/GetData.html?id=100的超链接](http://www.mysite.com/GetData.html?id=100)*

单击链接时，我希望*GetData.html*从数据库中提取数据并使用返回数据填充一些 innerHTML 元素。查询字符串值将使用 jQuery 的 jqURL 插件提取，我将使用 jQuery 的内置 Ajax 函数来调用将*id*作为参数传递的 web 服务。

**我的问题是**：根据我的理解，如果这不是 POST 方法而是 GET 方法，我该如何使用 jQuery.Ajax()？根据文档，为了 $.ajax() 工作，类型必须是“POST”。

有人可以为我解释一下吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T11:34:51.030

你有很多选择：

1-使用加载方法：

```
$('#container').load(("/page"); 
```

2-使用get命令：

```
$.get('/page') 
```

3-使用ajax命令：

```
$.ajax({
type:'GET',
url:'/page',
success:function() {
}
}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T11:32:05.623

```
$.ajax({
  type: "GET",
  url: "test.js",
  dataType: "script"
}); 
```

...来自 jQuery 文档中的[第一个示例](http://docs.jquery.com/Ajax/jQuery.ajax#examples)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T11:30:19.587

[jQuery.get()](http://docs.jquery.com/Ajax/jQuery.get#urldatacallbacktype)？

# iphone - 游戏减速问题

> ID：877256
> 
> 赞同：0
> 
> 时间：2009-05-18T11:26:52.543
> 
> 标签：iphone, objective-c, cocoa-touch

我正在开发一个游戏，我必须同时移动球和启动图像。为了移动开机图像视图，我创建了一个单独的线程并使用 [self performSelectorOnMainThread:..] 调用 power 的移动方法，这是在视图上显示更新位置所必需的。但是创建此线程后我的游戏速度变慢了。请指导我提高游戏性能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T11:41:33.433

您可能不想在这里创建自己的线程；除非您的计算非常复杂，否则这可能比在主线程上执行此工作要慢。

不要创建自己的线程，而是研究[CoreAnimation](http://developer.apple.com/iphone/library/documentation/Cocoa/Conceptual/CoreAnimation_guide/Introduction/Introduction.html)。它旨在平滑地处理移动事物，透明地管理自己的线程，并提供“即发即弃”的界面。对于大多数 2D 游戏，您应该遵循的第一种方法是使用 CoreAnimation 对移动的每个元素进行 CALayers。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T12:09:06.700

我们没有设计或编写你的游戏，所以我们怎么能知道如何神奇地为你修复它？自己做一些研究，使用 Apple 出色的“Instruments”和“Shark”工具来追踪问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T22:19:51.833

我强烈建议你看看[cocos2d](http://code.google.com/p/cocos2d-iphone/)而不是手动管理精灵和图形。Cocos2d 会从你那里抽象出所有这些东西。

# visual-studio - VS 2010 Beta 1 的任何 T4 编辑器？

> ID：877270
> 
> 赞同：1
> 
> 时间：2009-05-18T11:31:32.910
> 
> 标签：visual-studio, t4, visual-studio-2010

VS2010 Beta 1 今天发布了，我在实体框架和建模中看到了很多 T4 的使用。是否已经有可用的 T4 编辑器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T11:32:51.237

有形的 T4 编辑器可用于 VS2010 Beta 1 - 包括智能感知和突出显示。 [http://tangibleengineering.blogspot.com/2009/05/tangible-t4-editor-for-visual-studio.html](http://tangibleengineering.blogspot.com/2009/05/tangible-t4-editor-for-visual-studio.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-12T21:13:36.950

有形 T4 编辑器现在也可用于 VS 2010 RTM [http://t4-editor.tangible-engineering.com](http://t4-editor.tangible-engineering.com)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-24T13:27:51.110

[有形 T4 编辑器](http://t4-editor.tangible-engineering.com/T4-Editor-Visual-T4-Editing.html)非常受欢迎。[您可以在Visual Studio Gallery](http://visualstudiogallery.msdn.microsoft.com/en-us/60297607-5fd4-4da4-97e1-3715e90c1a23)中找到免费版

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-20T06:49:06.993

Visual Studio 2010 Beta1 加上有形的 T4 编辑器摇滚。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2010-03-18T09:42:17.117

有形的 T4 编辑器现在也可用于 VS2010 RC。 [http://tangibleengineering.blogspot.com/2009/05/tangible-t4-editor-for-visual-studio.html](http://tangibleengineering.blogspot.com/2009/05/tangible-t4-editor-for-visual-studio.html)

# c - 当我运行原始套接字程序时，它会生成无效参数错误

> ID：877272
> 
> 赞同：0
> 
> 时间：2009-05-18T11:32:28.663
> 
> 标签：c, linux, network-programming

请帮我。
在我发布了 2 天的长时间搜索后，我找不到它的答案。请帮助我，我对套接字编程非常陌生，我编写了一个小代码来转移 tcp 层的数据包，因为我使用了 ip_queue 和带有 NETLINK_FIREWALL 协议的网络链接。我所做的是

iptables -I OUTPUT -j QUEUE -p udp --destination-port 19989

我在命令提示符下运行。
我的代码是（仅接收数据包不多）
只是它避免了远程 icmp 错误并打印数据包信息而不传递到应用程序层。

* * *

```
1 #include<asm/types.h>  
2 #include<sys/socket.h>  
3 #include<linux/netlink.h>  
4 #include<linux/netfilter_ipv4/ip_queue.h>  
5 #include<stdio.h>  
6 #include<stdlib.h>  
7 #include<netinet/in.h>  
8 #include<arpa/inet.h>  
9 #include<netdb.h>    
10 #include<linux/ip.h>    
11 #include<linux/icmp.h>  
12 #include<string.h>  
13 #include<unistd.h>  
14   
15 int nl_sock_fd = 0;  
16 struct sockaddr_nl nl_addr;  
17 int seq = 0;  
18 struct ipq_mode_msg* modeMessage;  
19 struct ipq_verdict_msg *ver_data = NULL;  
20 struct nlmsghdr* netlinkHeader =NULL;  
21 struct ipq_packet_msg* packet = NULL;  
22 char buf1[128] ={0};  
23 char buf[4096] = {0};  
24 char buf2[8192] = {0};  
25   
26 int addrSize;  
27 int len,i;  
28   
29   
30 int main(int argc, char *argv[])  
31 {  
32 int iter= 0;  
33 
34 /******* create and set the values for netlink sockets*************/  
35 if((nl_sock_fd = socket( AF_NETLINK, SOCK_RAW, NETLINK_FIREWALL))<0)  
36 {  
37 printf("socket creation failed!\n");  
38 return ;  
39 }  
40 printf("socket fd =%d\n", nl_sock_fd);  
41   
42 // Set up the kernels address structure:  
43 memset(&nl_addr, 0, sizeof( struct sockaddr_nl ) );    
44 nl_addr.nl_family = AF_NETLINK;    
45 nl_addr.nl_pid = 0; // The with address 0 in netlink /getpid();    
46 nl_addr.nl_groups = 0; // we dont need any multicast groups  
47 nl_addr.nl_pad = 0;  
48 if(bind(nl_sock_fd, (struct sockaddr*)&nl_addr, sizeof(nl_addr))<0)  
49 {  
50 printf("bind failed");  
51 }  
52 /******************* set mode values ***************************/  
53 memset(buf1, 0, 128 );  
54 netlinkHeader = (struct nlmsghdr*)buf1;  
55 netlinkHeader->nlmsg_len = NLMSG_LENGTH(sizeof(struct ipq_mode_msg));  
56 //NLMSG_LENGTH size of the ancilliary data  
57 netlinkHeader->nlmsg_type = IPQM_MODE; //IPQM Packet  
58 netlinkHeader->nlmsg_flags = NLM_F_REQUEST; //request message   
59 netlinkHeader->nlmsg_seq = seq++; //to allow response correlation  
60 netlinkHeader->nlmsg_pid = getpid();  
61   
62 // modeMessage=(struct ipq_mode_msg*)NLMSG_DATA(netlinkHeader);  
63 modeMessage=NLMSG_DATA(netlinkHeader);  
64 //NLMSG_DATA returns a pointer to the ancilliary data which it contains  
65 modeMessage->value = IPQ_COPY_PACKET; //copy metadata and range 0 is entire packet  
66 modeMessage->range = 0; // copy the entire payload  
67   
68 if(sendto( nl_sock_fd, (void*)buf1, netlinkHeader->nlmsg_len, 0, (struct   sockaddr*)&nl_addr, s izeof(struct sockaddr_nl) ) < 0 )  
69 {  
70 printf("unable to set netlink mode ...\n");  
71 exit(0);  
72 }  
73 printf("portion of data sent to netlink\n");  
74 for(iter = 0; iter < 24; iter++ )  
75 {  
76 printf(" %x",(unsigned int)buf1[iter]);  
77 if(!(iter%10) && iter !=0)  
78 printf("\n");  
79 }   
80 printf("\n");  
81   
82 /*********** receiving msg ******************/  
83 printf("socket is up and waiting for messages....\n");  
84   
85 while(1)  
86 {  
87 //struct nlmsghdr* netlinkHeader = buf1;  
88   
89 //netlinkHeader = buf1;  
90 printf(" iam at recvfrom \n");  
91 len = recvfrom(nl_sock_fd, buf2, NLMSG_LENGTH(sizeof(struct ipq_packet_msg)), 0,   (struct soc kaddr*)&nl_addr, &addrSize );  
92 printf(" NLMSG_LENGTH = %d\n",NLMSG_LENGTH(sizeof(struct ipq_packet_msg)));  
93 if( len < 0 )  
94 {  
95 printf("unable to recive packet from the kernel\n");  
96 return 0;  
97 }  
98   
99 netlinkHeader = ( struct nlmsghdr* ) buf2;  
100   
101 printf("message received with pid=%d \n", nl_addr.nl_pid);  
102   
103 if( netlinkHeader->nlmsg_type == NLMSG_ERROR )  
104 {  
105 struct nlmsgerr* pError = (struct nlmsgerr*)NLMSG_DATA( netlinkHeader );  
106 if( pError->error != 0 ) // Error number 0 is an acknowledgement not an error.  
107 {  
108 printf("error occured while receiving the message from the kernel.\n");  
109 printf("error code %d \n ", pError->error);  
110 printf("\n****** %s ********\n",strerror( -1 * pError->error));       
111 printf("msg->nlmsg_len %d\n", pError->msg.nlmsg_len);  
112 printf("msg->nlmsg_type %x\n", pError->msg.nlmsg_type);  
113 printf("msg->nlmsg_flags %x\n",pError->msg.nlmsg_flags);  
114 printf("msg->nlmsg_seq: %d\n", pError->msg.nlmsg_seq);  
115 printf("msg->nlmsg_pid: %d\n", pError->msg.nlmsg_pid);  
116 return 0;  
117 }  
118 }  
119 else  
120 {  
121   
122 printf("Message from kernel:\n ");  
123 printf("Packet ID: %d\n",packet->packet_id);  
124 printf("Payload size:%d\n", packet->data_len);  
125 for(i = 0; i < packet->data_len; ++i )  
126 {  
127 printf("%c ", packet->payload[ i ]);  
128 }  
129 printf("\n");  
130   
131 }  
132 printf("\n dumping packets over \n");  
133 netlinkHeader=(struct nlmsghdr *)buf1;  
134 packet=NLMSG_DATA(netlinkHeader);  
135 /*for the example just forward all packets*/  
136 //netlinkHeader = (struct nlmsghdr*)buf2;  
137 netlinkHeader->nlmsg_type=IPQM_VERDICT;  
138 netlinkHeader->nlmsg_len=NLMSG_LENGTH(sizeof(struct ipq_verdict_msg));  
139 netlinkHeader->nlmsg_flags=(NLM_F_REQUEST);/*this is a request, don’t ask for an answer*/  
140 netlinkHeader->nlmsg_pid=getpid();  
141 netlinkHeader->nlmsg_seq=seq++;/*arbitrary unique value to allow response correlation*/  
142 ver_data=(struct ipq_verdict_msg *)NLMSG_DATA(netlinkHeader);  
143   
144 //ver_data->value=NF_ACCEPT;  
145 //ver_data->value=NF_QUEUE;  
146 ver_data->id=packet->packet_id;  
147 if(sendto(nl_sock_fd,(void *)netlinkHeader,netlinkHeader->nlmsg_len,0,
148 (struct sockaddr *)&nl_addr,sizeof(struct sockaddr_nl)) < 0)  
149 {  
150 perror("unable to send mode message");  
151 exit(0);  
152 }  
153   
154   
155 }  
156   
157 return 0;  
158 } 
```

输出就像

```
socket fd =3  
portion of data sent to netlink  
18 0 0 0 11 0 1 0 0 0 0  
0 38 30 0 0 2 0 0 0 0  
0 0 0  
socket is up and waiting for messages....  
iam at recvfrom   
NLMSG_LENGTH = 88  
message received with pid=0   
error occured while receiving the message from the kernel.  
error code -22  

****** Invalid argument ********  
msg->nlmsg_len 24  
msg->nlmsg_type 11  
msg->nlmsg_flags 1  
msg->nlmsg_seq: 0  
msg->nlmsg_pid: 12344 
```

请帮助我
并提供一些有助于学习原始套接字的最佳书籍

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T12:06:27.860

[这](http://linux.about.com/library/cmd/blcmdl2_recv.htm)和[这](http://linux.about.com/library/cmd/blcmdl7_netlink.htm)可能会帮助你一点。

要获取描述性错误代码，请键入 man recv，或查看 errno.h。如果您使用 perror() 函数，它将打印出一个包含错误描述的字符串。

# sql-server - 使用 Sql Server 2008 更改通知

> ID：877273
> 
> 赞同：35
> 
> 时间：2009-05-18T11:32:34.187
> 
> 标签：sql-server, sql-server-2008, notifications

我有一个由数据库和多个服务组成的应用程序。其中一项服务将信息添加到数据库（由用户触发）。

另一个服务定期查询数据库的更改并将新数据用作处理的输入。

到目前为止，我使用了一个可配置的计时器，它每 30 秒左右查询一次数据库。我阅读了有关 Sql 2005 的更改通知功能。但是，在 Sql 2008 中，此功能已被弃用。

直接在代码中获得数据库中发生更改的通知的最佳方法是什么？最佳实践是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-11-15T11:45:21.563

通知服务已被弃用，但无论如何您都不想使用它。

在某些情况下，您可能会考虑 Service Broker 消息；详细信息取决于您的应用程序。

在大多数情况下，您可能可以使用 SqlDependency 或 SqlCacheDependency。它们的工作方式是在发出查询时将 SqlDependency 对象包含在查询中。查询可以是单个 SELECT 或存储过程中的一组复杂命令。

稍后，如果另一个 Web 服务器或用户或网页对 DB 进行更改，可能导致先前查询的结果发生更改，则 SQL Server 将向所有已注册 SqlDependency 对象的服务器发送通知。您可以注册代码以在这些事件到达时运行，或者事件可以简单地清除缓存中的条目。

尽管您需要启用 Service Broker 才能使用 SqlDependency，但您不需要显式与其交互。但是，您也可以将其用作替代机制；将其更多地视为一个持久的消息传递系统，可保证消息顺序和一次性传递。

如何使用这些系统的细节对于论坛帖子来说有点长。您可以使用 Google 搜索它们，也可以在我的书中 ( [Ultra-Fast ASP.NET](https://rads.stackoverflow.com/amzn/click/com/1430223839) ) 中提供示例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T13:39:11.607

是的，[这篇博](http://blogs.technet.com/andrew/archive/2008/10/21/sql-server-2008-notification-services.aspx)文解释了通知服务现在已被弃用，以及未来的替代品或替代品是什么。

出于您的目的 - 获取数据酶中发生的更改的通知 - 听起来您需要[SQL Server 更改跟踪](http://msdn.microsoft.com/en-us/library/cc305322.aspx)。但是通知是一个拉模型 - 你的应用程序必须对更改表进行查询。

我无法弄清楚 SqlDependency 是否继续与已弃用的通知服务一起工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T14:32:25.130

有许多不同的方法可以跟踪数据库中的更改：要么通过维护时间结构的触发器，例如积压、跟踪日志（又名“审计表”），要么使用 SQL 2008 中的更改跟踪工具作为另一个答案中的参考。无论您使用何种机制，您都会遇到将更改通知您的本地服务的问题。为此，您可以使用 Service Broker 和基于事件的激活。根据您的描述，似乎让应用程序等待队列中的事件。 [http://msdn.microsoft.com/en-us/library/ms171581.aspx](http://msdn.microsoft.com/en-us/library/ms171581.aspx)

如果您不希望服务在队列中挂起并在队列中休眠，您可以通过使用服务代理中的外部激活机制来调查将服务“按需”激活。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-27T16:06:39.243

您可以使用 System.Data.SqlClient.SqlDependency（与 Service Broker 一起使用）订阅表中的更改。

# .net - 将 app.config 的一部分移动到单独的文件中

> ID：877288
> 
> 赞同：9
> 
> 时间：2009-05-18T11:35:24.397
> 
> 标签：.net, configuration, app-config

为了便于我的应用程序，我需要将 app.config 的“运行时”元素放在单独的文件中。

尝试过类似的东西

```
<runtime file="runtime.conf" /> 
```

并且

```
<runtime configFile="runtime.conf" /> 
```

在 runtime.conf 我有：

```
<runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">  
            .......
    </assemblyBinding>
</runtime> 
```

但它被忽略了......

有没有办法找出问题所在。

当然，当我将运行时部分直接复制到 app.config 中时，它可以工作。

我在某处发现使用 configFile="..." 包含的文件必须位于子目录中。试过了，但它也不起作用......

似乎包括不适用于运行时部分。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-11-29T00:47:52.627

您不能使用 configSource 外部化 <runtime> 配置。

<runtime> 是一种特殊情况，它不会读取 configSource 中指定的任何外部文件中的值。

指定“configSource”属性不会导致错误，根本不会读取源文件。

更多信息在这里：[http ://world.episerver.com/Blogs/Magnus-Rahl/Dates/2011/6/Todays-gotcha-configSource-on-the-runtime-section-element/](http://world.episerver.com/Blogs/Magnus-Rahl/Dates/2011/6/Todays-gotcha-configSource-on-the-runtime-section-element/)

*   包括推测这[与“IgnoreSection”](http://world.episerver.com/Blogs/Magnus-Rahl/Dates/2011/6/Todays-gotcha-configSource-on-the-runtime-section-element/#comment1613)类型信息有关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T11:51:37.190

嗨，您的 runtime.conf 位于应用程序的 bin 文件夹中

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T11:39:04.080

尝试这个：

```
<runtime configSource="runtime.conf"/> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-03-26T17:58:14.480

`linkedConfiguration`您可以使用元素[https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/linkedconfiguration-element](https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/linkedconfiguration-element)从外部文件加载绑定重定向配置

```
<configuration>
  <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
    <linkedConfiguration href="file://c:\Program Files\Contoso\sharedConfig.xml"/>
  </assemblyBinding>
</configuration> 
```

# unit-testing - 在 WebForms 应用程序中模拟 ASP.Net 用户

> ID：877289
> 
> 赞同：0
> 
> 时间：2009-05-18T11:38:00.603
> 
> 标签：unit-testing, mstest

我有一个遗留应用程序，我正在尝试在其中构建一些测试。

我有一些需要 HttpContext.Current.User 的测试

有没有办法模拟这个，或者只是即时登录用户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T12:01:07.590

我现在不知道您可以重构多少遗留应用程序。如果您有 .NET 3.5，则可以使用属于 System.Web.Abstraction 程序集的 HttpContextWrapper 类。

您可以阅读更多内容并查看如何[Stub/Mock HttpContext](http://vkreynin.wordpress.com/2009/03/23/stub-htttpcontext/)的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T11:43:57.143

`HttpContext.User`是类型`IPrincipal`。`IPrincipal`您可以通过为其分配任何对象（包括任何对象）来模拟它`CustomPrincipal`。

# python - python dict.add_by_value(dict_2)?

> ID：877295
> 
> 赞同：9
> 
> 时间：2009-05-18T11:40:11.127
> 
> 标签：python, code-golf, dictionary

问题：

```
>>> a = dict(a=1,b=2    )
>>> b = dict(    b=3,c=2)

>>> c = ???

c = {'a': 1, 'b': 5, 'c': 2} 
```

因此，这个想法是两个以最短形式通过 int/float 值添加到字典中。这是我设计的一种解决方案，但我不喜欢它，因为它很长：

```
c = dict([(i,a.get(i,0) + b.get(i,0)) for i in set(a.keys()+b.keys())]) 
```

我认为必须有一个更短/简洁的解决方案（可能与 reduce 和 operator 模块有关？itertools？）......有什么想法吗？

* * *

更新：我真的希望找到更优雅的东西，比如“reduce(operator.add, key = itemgetter(0), a+b)”。（显然这不是真正的代码，但你应该明白）。但这似乎是一场梦。

* * *

更新：仍在寻找更简洁的解决方案。也许 groupby 可以提供帮助？我提出的使用“reduce”/“groupby”的解决方案实际上并不简洁：

```
from itertools import groupby
from operator import itemgetter,add

c = dict( [(i,reduce(add,map(itemgetter(1), v))) \
              for i,v in groupby(sorted(a.items()+b.items()), itemgetter(0))] ) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-07T00:42:22.160

最容易使用[`Counter`](https://docs.python.org/3/library/collections.html#collections.Counter)

```
>>> from collections import Counter
>>> a = dict(a=1,b=2    )
>>> b = dict(    b=3,c=2)
>>> Counter(a)+Counter(b)
Counter({'b': 5, 'c': 2, 'a': 1})
>>> dict(Counter({'b': 5, 'c': 2, 'a': 1}))
{'a': 1, 'c': 2, 'b': 5} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-18T15:00:51.957

solving not in terms of "length" but performance, I'd do the following:

```
>>> from collections import defaultdict
>>> def d_sum(a, b):
        d = defaultdict(int, a)
        for k, v in b.items():
            d[k] += v
        return dict(d)
>>> a = {'a': 1, 'b': 2}
>>> b = {'c': 2, 'b': 3}
>>> d_sum(a, b)
{'a': 1, 'c': 2, 'b': 5} 
```

it's also py3k-compatible, unlike your original code.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-18T11:58:41.077

在我的第一印象中，我会写：

```
>>> c = a.copy()
>>> for k in b: c[k] = c.get(k, 0) + b[k] 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-18T12:05:28.720

如果你想要短代码，你就在那里。

如果您想要干净的代码，请继承 Ber's`defaultdict`和重载`__add__`：

```
from collections import defaultdict

class summable(defaultdict):
    def __add__(self, rhs):
        new = summable()
        for i in (self.keys() + rhs.keys()):
            new[i] = self.get(i, 0) + rhs.get(i, 0)
        return new

a = summable(int, a=1, b=2)
b = summable(int, b=3, c=4)
c = a + b
print c 
```

给出：

```
>>> 
defaultdict(None, {'a': 1, 'c': 4, 'b': 5})
>>> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-18T11:55:33.483

我认为一行代码已经很短了:)

[如果您使用defaultdict](http://docs.python.org/library/collections.html#collections.defaultdict)并删除一些不必要的列表并设置创建，我可能会变成“半行” ：

```
from collections import defaultdict

a = defaultdict(int, a=1, b=2)
b = defaultdict(int, b=3, c=4)

c = dict((k, a[k]+b[k]) for k in (a.keys() + b.keys()))
print c 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-17T20:44:17.127

我想到的第一件事是效率更高，（IMO）更优雅，但仍然打字太多。实际上，它大约相当于kcwu的。

```
c = reduce(lambda(d, k): [d.update({k: d.get(k, 0) + b[k]}), d][1], b, a.copy()) 
```

`dict.update`不回来真是可惜了`self`。我想这不是 Python 的方式。如果是这样，这个`[..., d][1]`把戏就没有必要了。

* * *

> Perl：“易事易，难事皆有可能”

```
%a = (a => 1, b => 2);
%b = (b => 3, c => 2);

%c = (%a, map {$_ => $a{$_} + $b{$_}} keys %b); 
```

> Haskell：~~“易事难，难事易”~~ “难事易事，不可能的事刚刚发生”

```
import qualified Data.Map as M

a = M.fromList [('a', 1), ('b', 2)]
b = M.fromList [('b', 3), ('c', 2)]

c = M.unionWith (+) a b 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-22T13:37:11.930

### 评论[@John Pirie 的回答](https://stackoverflow.com/questions/877295/python-dict-addbyvaluedict2/877395#877395)：

这是不使用的实现`(self.keys() + rhs.keys())`：

```
from collections import defaultdict

class sumdict(defaultdict):
    def __add__(self, rhs):
        d = self.copy() 
        d += rhs
        return d
    __radd__ = lambda self, lhs: self + lhs
    def __iadd__(self, rhs):
        for k, v in rhs.items():
            self[k] += v
        return self

a = sumdict(int, a=1, b=2)
b = dict(b=3, c=4)
c = b + a
a += b

assert a == c == {'a': 1, 'c': 4, 'b': 5} != b 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-18T17:05:09.803

```
def GenerateSum():
  for k in set(a).union(b):
    yield k, a.get(k, 0) + b.get(k, 0)

e = dict(GenerateSum())
print e 
```

或者，使用一个衬垫：

```
 print dict((k, a.get(k,0) + b.get(k,0)) for k in set(a).union(b)) 
```

# nhibernate - nhibernate 会用于像 facebook 这样的大型项目吗？（为了争论）

> ID：877300
> 
> 赞同：4
> 
> 时间：2009-05-18T11:42:06.913
> 
> 标签：nhibernate, facebook

对于那些了解 nhibernate 内部工作原理的人，你认为像 facebook/myspace 这样的大型 Web 应用程序会使用 nhibernate 吗？

或者 nhibernate 是否适合公司网站等流量较低的网站？即由于其健谈的性质而没有做好企业准备？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-18T12:05:20.890

NHibernate 一点也不健谈。关于可扩展性，NH's groups 上已经有一个[问题](http://groups.google.com.ar/group/nhusers/browse_thread/thread/1de495362e5b15ba/c43ccb138be737be)，它更多地是关于数据库的复杂性而不是流量，但可能对你来说仍然很有趣。

即使总是抱怨每个 ORM 上的不必要查询，由于 ORM 的通用性，这并不意味着它很健谈。另一方面，它优化了在手写 DAL 中过于复杂而无法优化的情况。例如。查询批处理或延迟加载。

与其他 ORM 相比，NHibernate 非常轻量级，并且与其强大的功能相比。

如果没有面向对象的业务模型，NHibernate（与任何其他 ORM 一样）可能被认为是矫枉过正，但您需要优化以获得最高性能。例如，我不认为 Google 可以将 NHibernate 用于其搜索引擎。

* * *

**编辑：**

NHibernate 的性能和功能并不是完全免费的。它要求开发人员至少了解关系数据库的基础知识。其他 ORM 试图隐藏整个关系问题，这会导致更多未优化的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T12:54:29.683

nHibernate 是一个专业的笑话。在我的公司，它的使用被禁止有几个原因。因为工具效率很低；您将花费无数小时试图找出或在稀缺的文档中寻找替代策略。

更好的是，使用您自己生成的 DAL 和 SP 来实现高性能。您将拥有一个缓存的执行计划，最终这才是真正重要的。

nHibernate 没有对 memcached 的高级支持，如果你想构建一个可扩展的 web 解决方案，比如 Facebook，你会特别使用它。

我在一家社交游戏公司工作，我们特别禁止使用nhibernate。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T19:58:56.340

NHibernate 支持查询缓存、基于主键的二级缓存，以及在同一会话中重复命中同一实体的会话缓存。

这都是一个很大的帮助，但是只要您访问一个负载很大的数据库，您就会遇到扩展问题。扩展数据库的最佳方法是最大限度地减少您实际必须使用它的时间。分布式缓存（例如 memcache）和缓存输出（数据处理后的视图或 html）是扩展应用程序的最佳方式。如果客户端经常访问数据库，那么你做错了，ORM 与否。在 .NET 应用程序中，与典型的 MVC 应用程序一样，具有能够使用可变输出缓存、甜甜圈和甜甜圈孔缓存以及用于与 NHibernate 和 ViewModels 一起使用的 memcache 的客户端的优点。

# wpf - 如何在 XAML 中定义变量？

> ID：877304
> 
> 赞同：67
> 
> 时间：2009-05-18T11:42:37.753
> 
> 标签：wpf, xaml, variables

我在 XAML 中有以下两个按钮：

```
<Button Content="Previous"
        Margin="10,0,0,10"/>
<Button Content="Next"
        Margin="0,0,10,10"/> 
```

如何将“10”定义为变量，以便可以在一个地方更改它，如下所示：

**伪代码：**

```
<variable x:key="theMargin"/>
<Button Content="Previous"
        Margin="{Variable theMargin},0,0,{Variable theMargin}"/>
<Button Content="Next"
        Margin="0,0,{Variable theMargin},{Variable theMargin}"/> 
```

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2009-05-18T11:50:06.850

试试这个：

添加到 xamlfile 的头部

```
xmlns:System="clr-namespace:System;assembly=mscorlib" 
```

然后将其添加到资源部分：

```
<System:Double x:Key="theMargin">2.35</System:Double> 
```

最后，在边距上使用厚度：

```
<Button Content="Next">
   <Button.Margin>
      <Thickness Top="{StaticResource theMargin}" Left="0" Right="0"
                  Bottom ="{StaticResource theMargin}" />
   </Button.Margin>
</Button> 
```

很多系统类型都可以这样定义：int、char、string、DateTime等

注意：你是对的......必须做一些更好的测试......更改为代码以便它应该工作

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-04-07T17:24:35.207

类似于 Sorskoot 的回答，您可以添加要使用的厚度资源，从而独立定义每个边距方向

```
<UserControl.Resources>
    <Thickness x:Key="myMargin" Top="5" Left="10" Right="10" Bottom ="5"></Thickness>
</UserControl.Resources> 
```

然后只需使用厚度作为边距：

```
<Button Content="Next" Margin="{StaticResource myMargin}"/> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T11:48:38.490

为什么不尝试将值添加为 a [`StaticResource`](http://msdn.microsoft.com/en-us/library/ms750950.aspx)？

```
Resources.Add("theMargin", 10); 
```

然后你可以像这样得到这个值：

```
<Button Content="Previous"
        Margin="{StaticResource theMargin},0,0,{StaticResource theMargin}"/>
<Button Content="Next"
        Margin="0,0,{StaticResource theMargin},{StaticResource theMargin}"/> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-16T18:25:57.960

您需要在 InitializeComponent 之前调用它或在此之后使用 INotifyPropertyChanged 接口

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-28T09:22:17.583

在 .NET Core 中，@Sorskoot 的回答有效，但产生了警告。所以我使用了这个命名空间声明：

```
xmlns:system="clr-namespace:System;assembly=System.Runtime" 
```

# java - Spring 对依赖注入的最小依赖是什么？

> ID：877312
> 
> 赞同：7
> 
> 时间：2009-05-18T11:43:42.963
> 
> 标签：java, spring, dependency-injection

仅使用 Spring 的依赖注入（仅核心框架）所需的最小依赖项是什么？我将 Spring 用于独立应用程序，我想尽量减少必须随应用程序提供的依赖项的数量。

我想我可以系统地删除一个 Jar 并查看应用程序是否中断，但如果有人有明确的答案会更好。

哦，我正在使用 Spring 2.5。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-18T11:58:52.090

查看`readme.txt`Spring 2.5 下载附带的内容。

假设您没有 AOP、JDBC、Transactions 或 ORM，那么您最好的选择可能是：

*   弹簧芯
*   春豆
*   弹簧上下文

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-21T06:41:14.407

如果您使用的是 maven，那么 pom.xml 中只需要 spring-context，它取决于 aop、bean、core、表达式和 asm

# java - 破解 N 位 RSA 模数

> ID：877317
> 
> 赞同：1
> 
> 时间：2009-05-18T11:45:46.640
> 
> 标签：java, security, encryption, cryptography, rsa

这与我[之前的帖子](https://stackoverflow.com/questions/858476/12-digit-number-java-encryption-question)有关，我唯一的选择是拥有一个似乎相对较弱的 RSA 算法。让我们假设我想用 36 位模数（在 34359738368 到 68719476735 之间）编码一个 35 位数字（从 0 到 34359738367）。

参考[http://en.wikipedia.org/wiki/RSA](http://en.wikipedia.org/wiki/RSA)我可以看到我的 n 介于 34359738368 到 68719476735 之间，是一个随机数（形式为 p-1 * q-1）。我选择一个随机的 d 和 e。我编码一个数字并在 UI 上显示。

为了论证的目的，我们假设用户最多可以看到 1,000 个这样的输出。他可以使用像 Polla's 或任何类似的算法来破解我的 d、e 或 n 从而开始预测新数字吗？如果是这样，会有多难？（只知道说 1000 组输入/输出）

作为示例（将 6 个输出视为输入/输出格式的样本），

1.  10001621865,31116156015
2.  10001621866,33031668326
3.  10001621867,37351399313
4.  10001621868,06071714212
5.  10001621869,01188523761
6.  10001621870,18341011998

谁能告诉我我的 n、d、e 是什么？（N 在 34359738368 到 68719476735 之间）

我只是想知道它的可破解性，所以如果你能给我任何关于多长时间、多快、必须看到多少输出、可以使用什么算法等的信息。那就太好了。

PS：用户看不到标准 RSA 算法中的“e”。他只能看到输入输出集。

***添加了详细信息*** 我正在尝试向用户显示从 db 中的顺序用户 ID。因为它是连续的，所以我不希望用户通过一些注册来猜测另一个用户的 id。为避免这种情况，我必须将其打乱为 <= 12 位数字。对此有很多限制，在[这个问题](https://stackoverflow.com/questions/858476/12-digit-number-java-encryption-question)中进行了解释。

用户也不知道 n,d 和 e 的值。用户最多可以看到几个输入输出样本（通过重复注册的方式）

接受 Accipitridae 发布的答案，因为“Jacobi”算法可用于在几秒钟内破解此问题。在不知道 n、e 或 p 的情况下。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T15:01:13.610

RSA 容易受到选择密文攻击。也就是说，假设我们要破解密文 y，我们可以使用密文-明文对之一来破解它。

如何打破它：

选择一个 x0 和 y0，其中 x0 和 y0 是已提供的明文-密文对。

y1 = y0*y mod n y1 是提供给用户的 1000 个满足此标准的密文中的另一个。x1 是对 y1 的解密，也给出了，这意味着：

x1 = y1^d mod n（这个已经给我们了，我们已经知道x1了）

x1 = (y0*y)^d mod n x1 = y0^d * y^d mod n Ξ x0*x

x1*x0^-1 = x

x 是对 y 的解密。

这当然取决于 y0*y mod n 是否产生另一个我们已经拥有的密文，并且由于我们只有 1000 个这样的对可以使用，因此破解它的可能性不大，但并非不可行。你只需要非常小心地选择你的配对。

我还想补充一点，您正在使用的 n 的大小允许分解启发式相当快地找到 n 的素数分解。此外，RSA 容易受到定时攻击，但这很容易被挫败。

**附加信息：在**不知道 n、d 或 e 的情况下，绝对没有提供任何信息，这意味着猜测 n、d 或 e 的组合与猜测明文本身一样好。要找到 n 和 e，至少要猜测 n 的 43,359,738,367 种组合以及 e 可能的所有组合。即使有 1000 对密文-明文对的人，要破解 n 和 e 也不容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T18:43:34.923

攻击者可以猜测 n 和 e mod (p-1) 的因子 p。可以通过获取消息 m 来检查每个猜测，计算 m^e mod p 然后与 c mod p 进行比较，其中 c 是相应的密文。由于 p 和 e mod (p-1) 可能各为 20 位，这意味着该方案的安全性不大于 40 位。

但是 40 位只是一个非常粗略的上限。攻击者可以做得更好。例如，他可以猜测一个因子 p。然后他计算消息和密文的雅可比符号。如果消息 m 是二次余数 mod p，则密文必须是二次余数 mod p，反之亦然。因此，如果消息/密文对不满足这种关系，他可以拒绝对 p 的猜测。或者攻击者可以计算消息和密文之间的离散对数。这为 e mod (p-1) 提供了一个更快的候选者。

这应该提供 20-30 位的安全级别，因此需要几秒钟才能破解。如果您将样本数量增加到 20 个，我可能会尝试一些基准测试。

**更新：**由于您没有给我 20 个样本来运行实验，因此我必须自己生成它们。使用以下示例

```
m = 10001621865  c = 31116156015
m = 10001621866  c = 33031668326
m = 10001621867  c = 37351399313
m = 10001621868  c = 6071714212
m = 10001621869  c = 1188523761
m = 10001621870  c = 18341011998
m = 10001621871  c = 7620400191
m = 10001621872  c = 36106912203
m = 10001621873  c = 37615263725
m = 10001621874  c = 7795237418
m = 10001621875  c = 34774459868
m = 10001621876  c = 4555747045
m = 10001621877  c = 33123599635
m = 10001621878  c = 34836418207
m = 10001621879  c = 33962453633
m = 10001621880  c = 6258371439
m = 10001621881  c = 7500991556
m = 10001621882  c = 5071836635
m = 10001621883  c = 911495880
m = 10001621884  c = 39558568485 
```

作为输入，上述算法在 20 毫秒内找到因子 201821 和 206153。如上所述，这不需要知道 e，尽管您选择的 e=65537 很容易猜到并且也可以被利用。

RSA 的优势在于它基于分解大整数的难度。在这里，您消除了这个困难，剩下的就是 RSA 的所有弱点（即数学关系）。构建基于 RSA 的分组密码是一个可怕的想法。我真的不明白为什么你不想使用我之前提出的 Luby-Rackoff 结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T10:47:21.997

这是一个可怕的想法，36 位 RSA？为什么不简单地使用块或流密码呢？这样您就可以以更安全的方式获得 1:1 映射。

我推荐的另一种解决方案是使用 SHA 哈希作为 UID，并将数据库中每个用户的序号存储为单独的列。

# .net - 是否可以使用 WsHttpBinding 通过基本身份验证代理？

> ID：877322
> 
> 赞同：0
> 
> 时间：2009-05-18T11:47:06.340
> 
> 标签：.net, web-services

我在通过使用带有 WSHttpBinding 的***基本***身份验证的身份验证代理时遇到问题。

BasicHttpBinding 的类似代码有效。我猜我的问题与我无法将 WSHttpBinding 的安全模式设置为***TransportCredentialOnly***的事实有关。

由于依赖于 MTOM，我无法使用 BasicHttpBinding。

```
 binding.ProxyAddress = new Uri("http://192.168.20.231:8080");
        binding.BypassProxyOnLocal = true;
        binding.UseDefaultWebProxy = false;

        WSHttpSecurity security = binding.Security;

        //security.Mode = SecurityMode.TransportCredentialOnly; //This option only exist for BasichHttpBinding
        security.Mode = SecurityMode.Transport; // Not sure what to set here

        //security.Mode = SecurityMode.TransportWithMessageCredential;
        security.Transport.ProxyCredentialType = HttpProxyCredentialType.Basic;
        security.Transport.ClientCredentialType = HttpClientCredentialType.Basic;

        var client = new SyncWcfMTOMServiceClient(binding, new EndpointAddress("http://server/service.svc"));

        client.ClientCredentials.UserName.UserName = "user";
        client.ClientCredentials.UserName.Password = "pass";
        bool running = client.IsServiceRunning(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T12:36:37.300

我想在这里指出的所有一件事中，Security.Mode =Transport 用于以防您的目标服务托管在 https (ssl) 上，而您指定的 URL 不是这种情况

```
security.Mode = SecurityMode.Transport; // Not sure what to set here 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T16:59:35.523

经过一番研究，我找到了答案。（我对这个解决方案并不完全满意，希望还有另一种方法可以解决这个问题）

*wsHttpBinding*不允许以明文形式发送用户名和密码，甚至不允许发送到本地身份验证代理！ *basicHttpBinding*没有这个问题

经过一些测试，我发现我可以通过在托管服务器上安装服务器证书来使其工作（不要与代理服务器混淆）。

通过在服务器上安装 SSL 证书，上面的代码无需修改即可工作。服务器上的 SSL 给我带来了许多问题。

有没有其他方法可以解决这个问题？

# jquery - jQuery 禁用基于 Radio selected 的 SELECT 选项（需要所有浏览器的支持）

> ID：877328
> 
> 赞同：35
> 
> 时间：2009-05-18T11:49:23.667
> 
> 标签：jquery

好的，这里有点麻烦，想在选择收音机时禁用一些选项。When ABC is selected disable the 1,2 & 3 options, etc...

```
$("input:radio[@name='abc123']").click(function() {
   if($(this).val() == 'abc') {

      // Disable 
      $("'theOptions' option[value='1']").attr("disabled","disabled");
      $("'theOptions' option[value='2']").attr("disabled","disabled");
      $("'theOptions' option[value='3']").attr("disabled","disabled");

   } else {
      // Disbale abc's
   }    
});

ABC: <input type="radio" name="abc123" id="abc"/>
123: <input type="radio" name="abc123" id="123"/>

<select id="theOptions">
  <option value="1">1</option>
  <option value="2">2</option>
  <option value="3">3</option>
  <option value="a">a</option>
  <option value="b">b</option>
  <option value="c">c</option>
</select> 
```

没有任何想法？

更新：

好的，我使启用/禁用工作正常，但出现了一个新问题。我的选择框的禁用选项仅适用于 FF 和 IE8。我已经测试过 IE6 并且禁用的不工作。我尝试使用 hide() 和 show() 也没有运气。基本上我需要隐藏/禁用/删除选项（适用于所有浏览器），并且如果选择了其他单选选项，则能够将它们添加回来，反之亦然。

结论：

感谢所有解决方案，其中大多数都回答了我最初的问题。给所有人很多道具:)

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-05-18T15:33:32.263

实现您想要的功能的正确方法就是删除选项。正如您发现的那样，在浏览器中禁用单个选项并不是特别好。我刚醒来，想编程一些东西，所以我做了一个小插件，可以根据收音机的选定 ID 属性轻松过滤选择。尽管其他解决方案可以完成工作，但如果您计划在整个应用程序中执行此操作，这应该会有所帮助。如果没有，那么我想这是因为其他人偶然发现了这一点。这是您可以隐藏在某处的插件代码：

```
jQuery.fn.filterOn = function(radio, values) {
    return this.each(function() {
        var select = this;
        var options = [];
        $(select).find('option').each(function() {
            options.push({value: $(this).val(), text: $(this).text()});
        });
        $(select).data('options', options);
        $(radio).click(function() {
            var options = $(select).empty().data('options');
            var haystack = values[$(this).attr('id')];
            $.each(options, function(i) {
                var option = options[i];
                if($.inArray(option.value, haystack) !== -1) {
                    $(select).append(
                    $('<option>').text(option.text).val(option.value)
                    );
                }
            });
        });            
    });
}; 
```

以下是如何使用它：

```
$(function() {
    $('#theOptions').filterOn('input:radio[name=abc123]', {
        'abc': ['a','b','c'],
        '123': ['1','2','3']        
    });
}); 
```

第一个参数是无线电组的选择器，第二个参数是字典，其中键是要匹配的无线电 ID，值是应保留的选择选项值的数组。有很多事情可以做进一步抽象，如果你有兴趣，请告诉我，我当然可以做到。

[这是它的实际演示](http://jsbin.com/anoci)。

**编辑**：另外，忘记添加，根据 jQuery[文档](http://docs.jquery.com/Selectors)：

> 在 jQuery 1.3 [@attr] 样式选择器被删除（它们以前在 jQuery 1.2 中被弃用）。只需从您的选择器中删除“@”符号，以使其再次工作。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-18T12:24:08.373

你想要这样的东西 -[示例代码在这里](http://jsbin.com/oqafe)

```
$(function() {

$("input:radio[@name='abc123']").click(function() {
   if($(this).attr('id') == 'abc') {

      // Disable 123 and Enable abc
      $("#theOptions option[value='1']").attr("disabled","disabled");
      $("#theOptions option[value='2']").attr("disabled","disabled");
      $("#theOptions option[value='3']").attr("disabled","disabled");
      $("#theOptions option[value='a']").attr("selected","selected");
      $("#theOptions option[value='a']").attr("disabled","");
      $("#theOptions option[value='b']").attr("disabled","");
      $("#theOptions option[value='c']").attr("disabled","");

   } else {
      // Disable abc's and Enable 123
      $("#theOptions option[value='a']").attr("disabled","disabled");
      $("#theOptions option[value='b']").attr("disabled","disabled");
      $("#theOptions option[value='c']").attr("disabled","disabled");
      $("#theOptions option[value='1']").attr("selected","selected");          
      $("#theOptions option[value='1']").attr("disabled","");   
      $("#theOptions option[value='2']").attr("disabled","");
      $("#theOptions option[value='3']").attr("disabled","");

   }    
});

}); 
```

**编辑：**

代码的改进版本，使用正则表达式根据选项值过滤选项。[这里的工作示例](http://jsbin.com/axavo)。`/edit`您可以通过添加到 URL来编辑示例

```
$(function() {

    $("input:radio[@name='abc123']").click(function() {

        // get the id of the selected radio
        var radio = $(this).attr('id'); 

        // set variables based on value of radio
        var regexDisabled = radio == 'abc' ?  /[1-3]/ : /[a-c]/;      
        var regexEnabled = radio == 'abc' ? /[a-c]/ : /[1-3]/;
        var selection = radio == 'abc' ? 'a' : 1;

        // select all option elements who are children of id #theOptions
        $("#theOptions option")
            // filter the option elements to only those we want to disable
            .filter( function() { return this.value.match(regexDisabled);})
            // disable them
            .attr("disabled","disabled")
            // return to the previous wrapped set i.e. all option elements
            .end()
            // and filter to those option elements we want to enable
            .filter( function() { return this.value.match(regexEnabled);})
            // enable them
            .attr("disabled","");
       // change the selected option element in the dropdown
       $("#theOptions option[value='" + selection + "']").attr("selected","selected");

    });

}); 
```

**编辑2：**

由于 disabled 属性似乎无法在浏览器中可靠地工作，我认为您唯一的选择是删除选择单选按钮时不需要的选项元素。[这里的工作示例](http://jsbin.com/etufu)

```
 $(function() {

        $("input:radio[@name='abc123']").click(function() {

            // store the option elements in an array
            var options = [];
            options[0] = '<option value="1">1</option>';
            options[1] = '<option value="2">2</option>';
            options[2] = '<option value="3">3</option>';
            options[3] = '<option value="a">a</option>';
            options[4] = '<option value="b">b</option>';
            options[5] = '<option value="c">c</option>';

            var radio = $(this).attr('id');   
            var regexEnabled = radio == 'abc' ? /[a-c]/ : /[1-3]/;

            // set the option elements in #theOptions to those that match the regular expression
            $("#theOptions").html(
            $(options.join(''))
                // filter the option elements to only those we want to include in the dropdown
                .filter( function() { return this.value.match(regexEnabled);})
            );

        });

    }); 
```

甚至

```
 $(function() {

        // get the child elements of the dropdown when the DOM has loaded
        var options = $("#theOptions").children('option');

        $("input:radio[@name='abc123']").click(function() {         

            var radio = $(this).attr('id');   
            var regexEnabled = radio == 'abc' ? /[a-c]/ : /[1-3]/;

            // set the option elements in #theOptions to those that match the regular expression
            $("#theOptions").html(
            $(options)
                // filter the option elements to only those we want to include in the dropdown
                .filter( function() { return this.value.match(regexEnabled);})
            );

        }); 
    }); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T12:02:38.307

第一个问题是

```
$(this).val() 
```

将其替换为

```
$(this).attr('id') == 'abc' 
```

那么这将不起作用

```
$("'theOptions'..") 
```

采用

```
$("#theOptions option[value='1']").attr('disabled','disabled') //to disable
$("#theOptions option[value='a']").attr('disabled','') //to ENABLE 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T11:56:32.373

您使用的是哪个浏览器？我以前从未使用过它，但在 IE8 之前的 IE 中似乎不支持它。有关更多信息，请参阅此链接：

[http://www.w3schools.com/TAGS/att_option_disabled.asp](http://www.w3schools.com/TAGS/att_option_disabled.asp)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T11:59:19.403

你的选择器是错误的。代替

```
$("'theOptions' option[value='1']") 
```

你应该使用

```
$("#theOptions > option[value='1']") 
```

另请参阅 jQuery[选择器文档](http://docs.jquery.com/Selectors)。看看 aman.tur 的[建议](https://stackoverflow.com/questions/877328/jquery-disable-select-options-based-on-radio-selected/877384#877384)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T12:03:00.910

如果您想禁用某些选项，那么下面的代码应该可以工作

```
$("input:radio[name='abc123']").click(function() {
   var value = $(this).val();

   $("option[value='1'], option[value='2'], option[value='3']", "#theOptions").each(function(){
      this.disabled = value == 'abc';
   });
   $("option[value='a'], option[value='b'], option[value='c']", "#theOptions").each(function(){
      this.disabled = value == '123';
   })
}); 
```

和单选按钮

```
ABC: <input type="radio" name="abc123" value="abc" id="abc"/>
123: <input type="radio" name="abc123" value="123" id="123"/> 
```

如果要从选择列表中删除选项，请使用此代码

```
$(function(){
   var options = null;
   $("input:radio[name='abc123']").click(function() {
      var value = $(this).val();
      if(options != null)options.appendTo('#theOptions');
      if(value == 'abc' )
         options = $("option[value='1'], option[value='2'], option[value='3']", "#theOptions").remove();
      else if(value == '123')
         options = $("option[value='a'], option[value='b'], option[value='c']", "#theOptions").remove();
   });
}); 
```

顺便提一句。我的代码使用 jQuery (1.3.2) 的当前稳定版本。如果您使用的是旧版本，则需要将属性选择器更改为旧语法。

选项[value='1'] 到选项[@value='1']

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-18T12:40:58.667

```
$(":radio[name=abc123]").click(function() {
   var $options = $("#theOptions")
   var toggle = ($(this).val() == 'abc') ? true : false;

   $("[value=1],[value=2],[value=3]", $options).attr("disabled", toggle);
   $("[value=a],[value=b],[value=c]", $options).attr("disabled", !toggle);
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-07-27T06:57:16.257

只需将选择器修复`$("'theOptions' option[value='1']")`为 `$("#theOptions option[value='1']")`，一切都会正常工作

# c# - 我的代码在哪里泄漏？

> ID：877338
> 
> 赞同：3
> 
> 时间：2009-05-18T11:52:41.960
> 
> 标签：c#, file, memory-leaks

这是我的代码，它打开一个 XML 文件（old.xml），过滤无效字符并写入另一个 XML 文件（abc.xml）。最后，我将再次加载 XML (abc.xml)。执行以下行时，出现异常说 xml 文件被另一个进程使用，

```
xDoc.Load("C:\\abc.xml"); 
```

有谁知道出了什么问题？我的代码中有任何泄漏以及为什么（我一直在使用“using”关键字，很困惑地看到泄漏......）？

这是我的全部代码，我在 Windows Vista x64 下使用 C# + VSTS 2008。

```
 // Create an instance of StreamReader to read from a file.
    // The using statement also closes the StreamReader.
    Encoding encoding = Encoding.GetEncoding("utf-8", new EncoderReplacementFallback(String.Empty), new DecoderReplacementFallback(String.Empty));
    using (TextWriter writer = new StreamWriter(new FileStream("C:\\abc.xml", FileMode.Create), Encoding.UTF8))
    {
        using (StreamReader sr = new StreamReader(
            "C:\\old.xml",
            encoding
            ))
        {
            int bufferSize = 10 * 1024 * 1024; //could be anything
            char[] buffer = new char[bufferSize];
            // Read from the file until the end of the file is reached.
            int actualsize = sr.Read(buffer, 0, bufferSize);
            writer.Write(buffer, 0, actualsize);
            while (actualsize > 0)
            {
                actualsize = sr.Read(buffer, 0, bufferSize);
                writer.Write(buffer, 0, actualsize);
            }
        }
    }

    try
    {
        XmlDocument xDoc = new XmlDocument();
        xDoc.Load("C:\\abc.xml");
    }
    catch (Exception ex)
    {
        Console.WriteLine(ex.Message);
    } 
```

EDIT1：我试图将缓冲区的大小从 10M 更改为 1M 并且它有效！我很困惑，有什么想法吗？

EDIT2：当输入的旧 XML 文件很大时，我发现这个问题很容易重现，比如 100M 之类的。我怀疑它是否是.Net 已知的错误？我将使用 ProcessExplorer/ProcessMonitor 之类的工具来查看哪个进程锁定了文件以防止 XmlDocument.Load 访问它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T11:57:57.147

这对我来说很好。纯属猜测，但也许病毒检查器正在扫描文件？要进行调查，请尝试禁用病毒检查器并查看它是否有效（然后重新启用病毒检查器）。

顺便说一句，有一种方法*可以*让文件保持打开状态：如果`StreamReader`构造函数抛出异常；`XmlDocument`但无论如何你都不会接触到这些东西......但考虑一下：

```
using (FileStream fs = new FileStream("C:\\abc.xml", FileMode.Create))
using (TextWriter writer = new StreamWriter(fs, Encoding.UTF8))
{
   ...
} 
```

现在被放置在抛出`fs`的边缘情况中。`new StreamWriter(...)`但是，我**不**认为这是这里的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T12:09:27.060

您可能在根目录上运行 FileSystemWatcher？

您还可以使用 ProcessMonitor 查看谁访问了该文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T12:09:34.923

问题是你`char[]`这似乎很大。如果它太大，它位于大对象堆上，而不是堆栈上。因此，只要软件正在运行，大对象堆就不会被压缩，曾经分配的空间可能不会再次使用 - 这看起来像内存泄漏。尝试将您的数组拆分为更小的块。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-18T13:12:06.373

我同意 Leppie 的建议，即使用 ProcessMonitor（或等效的）来确定谁在锁定文件。其他一切都只是猜测。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T12:33:19.803

它适用于某些人而不适用于其他人的事实使我认为该文件没有被关闭。在尝试加载文件之前关闭编写器。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-18T11:55:04.390

你的缓冲区没有被释放，是吗？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-18T11:55:58.960

代码工作正常。刚检查。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-18T11:59:33.490

使用将调用`Dispose`，但会`Dispose`在写入流上调用关闭？如果没有，系统可能仍然认为该文件是打开的以供写入。

我会尝试在它的块`writer`结束之前关闭它。`using`

**编辑：**我自己也尝试了代码。编译并运行没有您看到的问题。尝试像其他人提到的那样关闭病毒扫描程序，并确保您在某处没有打开文件的窗口。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-18T12:01:01.897

您是否检查过没有其他进程尝试访问该文件？

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-18T13:15:23.527

我敢打赌，您正在运行一些防病毒解决方案，它会在文件关闭后锁定文件。要验证，请尝试在加载文件之前添加延迟（例如 1 秒）。如果这有效，您可能找到了原因。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-18T17:30:54.867

运行[进程资源管理器](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)

确保它是您的程序首先锁定文件。

# asp.net - ASP.NET 在回发时添加控件

> ID：877339
> 
> 赞同：2
> 
> 时间：2009-05-18T11:52:53.833
> 
> 标签：asp.net, dynamic, user-controls, controls

我整理了一个简单的表格来突出动态表格的概念。我需要做的是在用户单击“添加”按钮时向页面添加一个控件。

我现在有一个简单的计数器来存储创建的控件的数量，当单击按钮时它会增加。

起初我认为它就像在事件处理程序上调用 RecreateChildControls（类继承自 CompositeControl）一样简单。这确实会根据增加的值创建新控件，但所有控件状态都会丢失。我假设这是因为在 Init & Load 阶段之后触发了该事件。

有没有其他方法可以做到这一点？我可以通过检查 Init 事件的回发值来使其工作，但这似乎有点 hacky。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T13:06:36.023

> 这确实会根据增加的值创建新控件，但所有控件状态都会丢失。

您在[页面生命周期](http://msdn.microsoft.com/en-us/library/ms178472.aspx)中调用该函数为时已晚。状态应用于“加载”阶段的控件，因此如果在该阶段*之前*未创建控件，则不会恢复状态，因为在尝试应用状态时控件不存在。

您需要在 Page 的 Init 事件中创建控件。

就个人而言，我不喜欢 ASP.Net 中的动态控件。它们有自己的位置，但更多时候我会选择合适的最大允许控件数量，最初将它们*全部*放在页面上，然后仅根据需要启用/禁用/隐藏/显示它们。

# php - 具有相同名称和 Smarty 的模板

> ID：877341
> 
> 赞同：2
> 
> 时间：2009-05-18T11:53:39.820
> 
> 标签：php, templates, smarty

我对 Smarty 有一个小问题......我在两个不同的目录中有两个不同的模板文件，它们恰好具有相同的名称。不幸的是，Smarty 让他们感到困惑。它使用最后一个要更新的文件在其 /templates_c 文件夹中创建编译文件，然后使用该文件显示页面。

这意味着这两个文件最终看起来像是最后一个要更新的文件，即使它们完全不同。

我可以通过重命名其中一个文件来解决这个问题，或者可能调用`clear_compiled_tpl`. 但是，我想知道是否有更好的方法。有没有办法配置 Smarty 在创建其编译文件时注意模板文件所在的文件夹？

编辑：我正在使用 Smarty v2.6.19

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T12:08:59.963

在输出模板之前试试这个，它实际上是对包含数千个模板文件的目录的优化，但可能会解决你的问题：

```
$smarty->use_sub_dirs = true; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-12-07T15:23:44.427

如果文件在同一个 template_dir 但不同的文件夹中，Smarty 应该制作不同的编译文件就可以了。如果您使用多个 template_dir 并且只使用一个 compile_dir，请确保为每个模板文件夹设置一个唯一的 $smarty->compile_id。

# dynamics-crm - Ms CRM 重命名帐户和联系人实体中的“更多地址”

> ID：877343
> 
> 赞同：1
> 
> 时间：2009-05-18T11:54:27.667
> 
> 标签：dynamics-crm, dynamics-crm-4

有人知道如何在帐户和联系人实体导航窗格中重命名“更多地址”吗？

通常的方法是更改​​地址/联系人或帐户关系中的显示选项，但在这种情况下这是只读的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-29T06:54:35.337

还有一种更简单的方法...转到设置->自定义转到帐户实体并从左侧菜单中选择“消息”。在那里你可以找到“更多地址”。打开此行并更改显示名称。保存+发布。完成:-) 希望这会有所帮助。

问候，克里斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T09:12:31.553

显然，这些标签是硬编码的。似乎唯一的解决方法是遵循在 OnLoad 方法中修改 HTML 的（不受支持的）路径。就像是

```
document.all.navAddresses.innerHTML = ... 
```

您必须深入研究 HTML 的细节才能达到预期的效果。

祝你好运！

# visual-studio - 在 Visual Studio 中更改“实现接口”模板

> ID：877345
> 
> 赞同：4
> 
> 时间：2009-05-18T11:54:58.493
> 
> 标签：visual-studio, visual-studio-templates

我经常在 Visual Studio 2008 中使用“实现接口”快捷方式。我的“问题”是我希望 Visual Studio在每个实例中都使用*字符串*别名而不是*字符串。*

由于我被迫使用字符串而不是字符串，这将为我节省大量时间。例如，我想要以下内容：

```
public Catalogue(String url) { } 
```

代替

```
public Catalogue(string url) { } 
```

这可能吗？我在哪里可以找到这些模板？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-18T21:55:40.950

您不能更改重构期间使用的模板。

您可以更改的模板在*%ProgramFiles%\Microsoft Visual Studio 9.0\Common7\IDE*中可用。具体来说，大多数用于空白文件等的 CSharp 位于*%ProgramFiles%\Microsoft Visual Studio 9.0\Common7\IDE\ItemTemplates\CSharp*

如果强迫您使用“字符串”的人意识到这浪费了多少时间，他们可能会改变他们的方式。这个我个人不太理解。。。

IDE 在所有生成的代码中都使用“字符串”，而不是“字符串”——因此，通过强制使用非标准的“标准”，您的团队会引起不一致。人们可以争论哪个更好，直到他们脸色发青-但正如您指出的那样，**使用“字符串”是一件很痛苦的**事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T21:47:55.473

只需替换`string`为`String`（整个单词，区分大小写）或不使用此分解模板。因为经过检查 %ProgramFiles%\Microsoft Visual Studio 9.0\Common7\IDE\ 它似乎是硬编码的

# jquery - jQuery Cycle插件z-index浮动问题

> ID：877349
> 
> 赞同：8
> 
> 时间：2009-05-18T11:55:34.530
> 
> 标签：jquery, html, css, cycle

当我尝试在我的 jQuery Cycle 元素上放置一个元素时，它不起作用。该元素始终位于 jQuery 循环元素之后。我使用浮动：对；定位元素，并将其 z-index 设置为 100000，但无济于事。

Firebug 将 Cycle 元素及其子元素视为具有低 z 索引，并显示浮动元素位于正确的位置。

该元素永远不会显示在 Cycling 图像上方。

```
<!-- the cycling set -->
<div id='headerimages'>
    <img src='images/header1.jpg' alt='' style='' />
    <img src='images/header2.jpg' alt='' style='' />
    <img src='images/header3.jpg' alt='' style='' />
</div>
<!-- the floating element -->
<img src='images/logotransparent.png' alt='' id='logo' /> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-18T13:10:58.293

浮动不会触发 z-index，只有
`Position: Relative`和`position: Absolute`

所以试试这些..你可能想尝试添加`position:relative`，
它大多数时候不会影响任何东西，但会让你访问**z-index**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-12-31T17:58:45.167

我知道这是一个旧线程......但想把它放在这里......我在我的网站中使用了演示周期并遇到了类似的问题，尝试了这里建议的解决方案......我改变了 Z-在我自己的css文件中的许多地方都有索引....但最后发现问题出在循环本身的css中......更改其中的z-index有助于解决我的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T03:27:24.470

我遇到了同样的问题，但对我来说最后的解决方法是将我想要漂浮在动画上方的东西的 z-index 设置为一个非常高的数字（在我的情况下为 100）。似乎 Cycle 分配了它自己的 z-indexes（它们是个位数，但仍然大于 1 或 2，这是我最初设置浮动对象的 z-indexes 的地方）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-20T09:35:09.080

只需将 z-index 样式添加到循环容器

```
.cycle-slideshow {
 z-index: 0; // or any smaller value to the covered div's
} 
```

详细信息请参阅[在 jQuery Cycle 幻灯片放映上方的 z-index 处显示 div](https://stackoverflow.com/questions/6736481/displaying-a-div-at-a-z-index-above-a-jquery-cycle-slide-show)

# jquery - 表格行上的单击事件 - 仅在没有“单击”其他内容时触发

> ID：877351
> 
> 赞同：12
> 
> 时间：2009-05-18T11:56:26.227
> 
> 标签：jquery, onclick

我在使用一些 jQuery 代码时遇到了一些问题，我希望并认为解决方案相对简单。

假设我有一张像这样的桌子：

```
<table>
   <tr>
     <td><input type="checkbox" name="hai" value="der" /></td>
     <td><a href="mypage.php">My link</a></td>
     <td>Some data</td>
     <td>Some more data</td>
   </tr>
   ...
</table> 
```

现在通过 JavaScript，我在 jQuery(document).ready(); 中执行以下操作

```
jQuery("table tr").click(function(){
   var row = jQuery(this);
   var hasClass = row.hasClass("highlight");
   jQuery("table tr").removeClass("highlight");
   if(!hasClass){
     row.addClass("highlight");
   }
}); 
```

所有这些都是非常简单的东西 - 我希望能够单击一行并突出显示它，一次只能突出显示一行（显然在我的实际代码中我做的不止这些） - 现在这是我的问题：

当用户单击锚标记或复选框时，这也会触发行单击事件，我无法弄清楚如何过滤掉它？我知道我需要在我的点击处理程序中包含该事件，但是如何以一种可以在尽可能多的浏览器中工作的方式来检查它呢？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-18T12:20:34.697

尝试将处理程序添加到响应单击事件并阻止事件冒泡的其他元素。这将是您已经拥有的东西的补充。

```
jQuery('table input, table a').click( function(e) {
    e.stopPropagation();
    return true;
}): 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T12:58:54.277

```
$("table tr").click(function(event){
   if (event.currentTarget.tagName != "TR") { return; }

   $(this).closest("table").find("tr.highlight").removeClass("highlight");
   $(this).addClass("highlight");
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T12:42:41.173

```
$("table tr").click(function(e){

if (e.target instanceof HTMLInputElement || e.target instanceof HTMLAnchorElement){
return;
}
var row=$(this);
$('table tr').removeClass('highlight');
row.addClass('highlight','normal');

}) 
```

# asp.net-mvc - 为操作创建带有 ID 的 url 链接

> ID：877353
> 
> 赞同：1
> 
> 时间：2009-05-18T11:56:33.577
> 
> 标签：asp.net-mvc, html-helper

在我的视图页面中，我想链接到操作“显示”并将操作期望的 ID 作为参数传递给它。

我使用哪个 html 助手？我不希望它创建字符串的 a href 页面，只是创建 url。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T12:00:31.367

`<%= Url.Action("Display", "controller", new {ID = someIdValue}); %>`

# asp.net - 使用 Sys WebForms PageRequestManager 的异步交互

> ID：877355
> 
> 赞同：0
> 
> 时间：2009-05-18T11:56:47.927
> 
> 标签：asp.net, javascript, asynchronous, webforms, pagerequestmanager

当进行异步调用时，我试图向用户显示一个面板，但前提是该调用发生在特定调用中。

使用我的普通“获取控制”脚本，例如：

```
function pageLoad() {

    try {
        var manager = Sys.WebForms.PageRequestManager.getInstance();
        manager.add_endRequest(OnEndRequest);
        manager.add_beginRequest(OnBeginRequest);
    }
    catch (err) { }
}

function OnBeginRequest(sender, args) {
    //alert('Start\n\n' + sender + '\n\n' + args);
    var p = document.getElementById('ajaxLoadingPanel');
    p.style.visibility = 'visible';
    p.style.display = 'inline';
}

function OnEndRequest(sender, args) {
    //alert('End\n\n' + sender + '\n\n' + args); 
    var p = document.getElementById('ajaxLoadingPanel');
    p.style.visibility = 'hidden';
    p.style.display = 'none';
} 
```

但我的问题是**我怎么知道 sender 和 args 的方法？**

我[浏览了MSDN](http://msdn.microsoft.com/en-us/library/bb383809.aspx)，他们没有谈论我们可以使用的方法，这部分在VS2008中没有智能......

有任何想法吗？我想获取我可以使用这个 javascript API 的 sender 和 args 的方法和属性列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-16T07:34:12.930

本文档很有帮助：http: [//msdn.microsoft.com/en-us/library/bb398976.aspx](http://msdn.microsoft.com/en-us/library/bb398976.aspx)

它有一个 PageRequestManager 上所有事件的表以及它们的事件参数是什么。然后事件 args 记录它们的属性等。发送者始终是 PageRequestManager。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T13:23:22.263

在 ScriptDebugger 中调试并找出 sender 和 args 的内容，您可以确定是哪个控件导致了回发

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-31T05:03:12.373

要知道哪个元素导致回发，您可以使用`args.get_postBackElement().id`.

# php - 将参数从 php 传递到 javascript 回 php

> ID：877356
> 
> 赞同：0
> 
> 时间：2009-05-18T11:57:07.520
> 
> 标签：php, javascript

我有一个 php 页面，它使用 javascript 创建一个包含另一个 php 页面的弹出窗口。弹出窗口中的 php 页面基本上是一个表单，并将使用该值插入数据库。使用以下函数在弹出窗口中加载 php 页面：

```
phppopup('edit_status.php?cmd=EditStatusData')

function phppopup(page){
child1 = window.open (page, "Ebay Auctions", "height=600,width=600,status=yes,toolbar=no,menubar=no,location=no");
child1.document.close(); 
} 
```

如何将调用页面中的值传递到弹出窗口中的页面？

我现在正在尝试：

```
echo "<p><a href=\"#\" onclick=\"updateByEdit('". $username ."', '". $subcat ."')\">Edit User Info</a>
<p><a href='#' onclick=\"makewindows2('edit_status.php?cmd=EditStatusData&pk=". $pk ."'); return false;\">Historie</a>; 
```

生成以下html：

```
<a href="#" onclick="updateByEdit('trendsandbrands', 'fakeapproved')">Edit User Info</a>
</strong></strong></strong></strong></p><p><strong><strong><strong><strong><a href="#" onclick="phppopup('edit_status.php?cmd=EditStatusData&amp;pk='); return false;">Historie</a> 
```

它适用于 updateByEdit，为什么不适用于 phpopup？

$pk 只是一个整数，它可以在调用窗口的页面中正常显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T14:22:25.357

我注意到生成的 HTML 包含一个查询字符串，其中包含 HTML 实体 ('&') 而不是它们的实际等价物。确保 updateByEdit(...) 没有返回实体，否则查询字符串将无法正确打印。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T12:01:39.040

好吧，您已经这样做了——edit_status.php 中的 GET 变量将有一个条目，其中 key='cmd' 和 value='EditStatusData'。只需传递所需数量的参数（同时注意此类数据将是公开可见的）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T12:12:35.227

只需将参数添加为获取请求的一部分：

```
phppopup("index.php?var1=value1&var2=value2"); // Get 
```

等等

或者，要在它已经打开时传递它的参数，请使用返回的句柄 (child1) 并通过 javascript 访问该窗口的 DOM。

```
child1.document.getElementById("myelement").innerHTML = "Hello World"; // Parent Child 
```

如果您对此有疑问，请在加载子文档时通过 window.opener 让子窗口在父窗口中触发回调，例如

```
window.opener.myCallback(requestedinfo); // Parent window callback function 
```

# sharepoint - SharePoint 将上传的文件保存在系统的什么位置？

> ID：877357
> 
> 赞同：0
> 
> 时间：2009-05-18T11:57:55.540
> 
> 标签：sharepoint

我在 SharePoint 网站上上传了一个 doc 文件。现在我想知道服务器（系统）上文件的路径。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T12:05:55.290

如果您将其上传到 SharePoint 文档库，则它不在文件系统上。它位于 SharePoint 内容数据库中。如果你能详细说明你想对文件做什么，那么推荐解决问题的方法和获取你需要的信息会更容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T12:04:52.530

它保存在内容数据库中。这就是为什么您在磁盘上找不到它的原因。

# javascript - 如何在 Selenium IDE 中运行嵌入页面中的脚本？

> ID：877361
> 
> 赞同：2
> 
> 时间：2009-05-18T11:58:28.547
> 
> 标签：javascript, testing, selenium, embedded-resource, execute

我正在使用[Selenium IDE](http://seleniumhq.org/projects/ide/)测试页面，并希望执行页面中已有的方法。我已经尝试过`getEval(window.name.space.function())`，但它只是返回`window.name`未定义。这可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T13:13:20.130

有一个 getCurrentWindow() 函数，由于深不可测的原因，它只允许您访问“安全”属性（这应该防止什么？人们恶意地对其他人的网站进行路过测试？）。较新的版本提供了解决这些问题的 getUserWindow() 函数。有关详细信息，请参阅[此博客条目](http://crschmidt.net/blog/348/selenium-ide-getcurrentwindow-problems/)和[此问题](http://jira.openqa.org/browse/SEL-558)。

# c# - 在 C#/.NET 中处理基督之前的日期的（最佳）方法是什么？

> ID：877366
> 
> 赞同：20
> 
> 时间：2009-05-18T11:59:09.327
> 
> 标签：c#, .net, datetime

是否有任何内置支持？如果没有，对于处理此类日期是否有任何共识？

* * *

非常欢迎链接到自己编码的解决方案或其片段。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-18T12:12:10.267

此范围内的日期没有内置支持，因此您必须自己编写代码。

这是一个示例[http://flipbit.co.uk/2009/03/representing-large-ad-and-bc-dates-in-c.html](http://flipbit.co.uk/2009/03/representing-large-ad-and-bc-dates-in-c.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T12:10:45.950

如果您指的是 DateTime 值 < DateTime.MinValue 的处理，那么我认为唯一的“共识”是不使用 System.DateTime 来尝试表示它们。

任何共识都可能只存在于使用此类日期的社区中。你工作的领域是什么？天文学？

* * *

无论感兴趣的领域是什么，都可能有其他人遇到过同样的问题。我会先做一些研究，特别是如果您的约会需要与同一感兴趣领域的其他软件进行互操作。即使您必须编写自己的代码，您至少可以意识到其他人在编写*自己*的代码时遇到的问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-01-12T19:00:51.107

我知道这个问题很老，但我在搜索中找到了它，并且可以为这个主题添加额外的见解。在上面的评论中，有人假设日期差异将大于 1 年。除非一个人计划回到确切日期可以有用地得出（数千年）之前的时间，否则情况并非如此。儒略日期和公历日期所需的差异只有少数天数，对于任何可以合理尝试从现存历史记录中得出的特定日期，肯定少于 3 周。有用于此目的的转换表。我相信更大的问题来自转换为公历。

不同的国家在不同的时间皈依，他们在皈依时损失的天数也不同，因为他们没有同时皈依。例如，转换是如何发生的，假设今天是 10 月 1 日，明天是 10 月 10 日。在这种情况下，转换将导致该特定国家/地区损失 9 天。另一个在一段时间后转换的国家可能已经损失了 11 天、12 天或 13 天等。另一个大问题是试图在特定日期推导出季节。由于不精确的日历，分点进动导致季节随着时间的推移在日历年中快速进展。今天，在 7 月份，我们在北半球迎来了夏天。3000年前，

同样重要的是要注意，古代世界使用了各种各样的古代历法系统。太阳和月亮的品种都存在，直到大约 2000 年前（当儒略历被发明时），才有真正有效的标准化尝试。人们经常试图将朱利安日期追溯到更远的历史，但这些努力是不合时宜的。由于记录不一致导致的不确定性，不可能确定与儒略历相关的特定日期发生的特定事件，除非以涉及相当大误差的迂回方式。对于公元前一千年之前发生的事件，误差幅度可能是 50 年或 100 年（在某些时期或更长）。我们根本不 没有记录来建立极其准确的时间表。来自与现存记录相关的年轮序列的碳年代有助于缩小各个地区和时期的误差范围，但它们并不构成一个完全连接的记录，我们将始终有一个误差范围需要处理。

# firefox - 在 Firefox 中设置 chrome 窗口的最小高度和宽度

> ID：877376
> 
> 赞同：1
> 
> 时间：2009-05-18T12:01:08.293
> 
> 标签：firefox, window, size, limit

我正在尝试限制 chrome (xul) 窗口的最小高度和宽度。窗口本身是使用***window.openDialog***方法打开的。我尝试使用***minwidth***和***minheight***窗口属性，但这似乎对窗口没有任何影响。我还尝试通过处理***onresize***事件来限制大小，如下所示：

```
onresize()
{
  return false;
} 
```

但这也不起作用。

有什么线索吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T19:36:20.310

好的，我想我找到了答案。

没有直接的解决方案。似乎对于通过*open*或*opendialog*方法打开的子窗口，使用标准属性限制最小大小是不可能的，但是通过使用***onresize***事件处理程序和***window.resizeTo()***方法的组合，我可以让窗口保持最小尺寸。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-27T23:15:12.160

`onresize`不是函数。为此，您需要将值设置为函数。只需执行以下操作：

```
onresize = (function() { return false; }); 
```

# c# - 最佳实践：事件的操作枚举使用

> ID：877378
> 
> 赞同：2
> 
> 时间：2009-05-18T12:01:26.203
> 
> 标签：c#, .net, events

我发现自己很难为事件设计动作枚举。

f.ex 制作计算处理器。

所以我应该有这样的枚举？：

```
public enum CalculatorCoreActions
{
    ProcessStarted,
    ProcessFinished,
    ProcessFailure,
    ProcessFailed,
    SubstractionStarded,
    SubstractionFinished,
    SubstractionFailure,
    SubstractionFailed,
    <etc.>...
} 
```

或者我应该做两个枚举？，f.ex：

```
public enum CalculatorAction
{
    Process,
    Substraction,
    Division
}

public enum CalculationActionResult
{
   Started,
   Finished,
   Failure,
   Failed
} 
```

甚至我应该创建一个新课程？：

```
public class CalculatorActionEventArgs : EventArgs {<...>}
public class CalculatorActionFailedEventArgs : EventArgs {<...>}
public class etc... : EventArgs {<...>} 
```

您认为哪种方法最好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T12:17:10.227

你想做什么？你打算用枚举做什么？您的第一个示例可能适用于很少的组合，而第二个示例会更复杂但更简洁且更易于扩展。

我的猜测是，您希望能够显示计算状态，并可能在错误处理中对状态采取行动。您可能会考虑使用[状态](http://cnx.org/content/m17257/latest/)或[状态机](http://dotnet.zcu.cz/NET_2006/Papers_2006/short/B31-full.pdf)模式而不是枚举，以避免枚举上出现巨大的 switch 语句。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T15:40:22.563

在您提出的枚举的两个选择中，我会选择第二组枚举。

为什么，当你用行动跨越（字面上乘以）状态时，你会想出一个大的增长模式。当您想在将来添加一个状态或功能时，您不再添加一个项目，而是添加 1xM 或 Nx1 个项目。有关此类问题的其他参考，请参阅**Martin Fowler 的**书**Refactoring** and object hierachy entanglement。

现在对于事件 args，使用通用 EventArgs 并在对象中为其提供操作和状态。不要创造比你必须做的更多的东西，它会最大限度地减少你创造的头痛的数量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T12:18:00.413

这取决于你如何设计你的结构......对我来说，事件应该是不同的，但一个应该尽量不要使用更多的 EventArgs 例如，就像你将一个用于失败的操作等......而不是尝试使用最低限度的数量事件参数作为它唯一的数据传递机制......

现在关于枚举部分，我无法完全理解您的情况....为什么您想要这么多不同的枚举？

如果您打算将其用作多个事件的替代品，那么...如果我是您，那么我将参加活动...但是如果您的结构需要大量活动，则说 10 或更多，而不是混合活动以枚举作为最小事件参数...例如在 10 个减少事件到 3 个的情况下，使用 4 个或 5 个枚举

# javascript - 在 javascript 中，我如何检测浏览器是否会显示或下载 pdf？

> ID：877379
> 
> 赞同：6
> 
> 时间：2009-05-18T12:01:38.853
> 
> 标签：javascript

说我有

*   带有 iframe 的网页：
*   指向 pdf 文档的 url：[http ://www.example.com](http://www.example.com)
*   一些会做 iframe.src=pdfurl 的 javascript
*   将触发此类 javascript 的按钮

    *   如果浏览器要显示 pdf 内联，按钮将显示“查看 pdf”，单击时将使 iframe 可见

    *   否则它会说“下载pdf”

我找到了一种检测 pdf 是否已加载到 iframe 中的方法：在 onload 触发后读取 iframe.contentDocument.contentType，但是

*   这不允许我显示正确的按钮
*   如果正在下载文件，onload 不会触发

谢谢 ：）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T12:19:18.913

要告诉客户端的浏览器将响应下载为文件，请在响应中将 Content-Disposition HTTP 标头设置为“附件”。这不能保证，但它是告诉浏览器如何处理内容的正确方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-11-17T16:58:39.327

在现代浏览器中，JavaScript 的全局 Navigator 对象有一个 plugins 属性，里面填充了一个 Plugins 数组，如果你能找到 Mimetype application/pdf 的 Plugin，你可以放心地假设浏览器会内联显示 pdf 文件，只要服务器当然，不会显式发送 content-disposition: 附件标头。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-18T12:04:30.610

您可以向该资源发送[HEAD 请求](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.4)`Content-Type`并检查发送回的内容和`Content-Disposition`值。根据这些信息，您可以确定浏览器是否会显示或下载该资源。

# unity3d - 如何在 Unity 的场景视图中查看我的相机？

> ID：877383
> 
> 赞同：30
> 
> 时间：2009-05-18T12:02:24.687
> 
> 标签：unity3d

无需进入游戏视图。这甚至可能吗？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-07-07T19:43:41.457

实际上，它是 GameObject Menu->Align View To Selected。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-05-30T22:01:13.937

我想我知道你的解决方案。. .

在统一中：

*   在场景视图中选择您想要查看的相机（游戏对象）。
*   然后转到“GameObject”菜单并选择“Align View to Selected”。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-01-12T03:27:41.970

为什么不将您的游戏视图拖到您的场景视图下方或上方。这样你就可以看到两个窗口。我总是这样工作；）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-02T11:08:32.850

从层次结构中单击您的相机对象，然后单击 GameObject->Align View to Selected。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-02-19T07:28:10.273

转到 Unity 编辑器中的层次结构栏

*   按 F 键
*   双击对象/主相机

要以不同的角度查看对象，您可以在 x、y、z 中的任何一个外部应用旋转、变换（移动），而对于更多细节或更少细节，您可以轻松点击鼠标进行放大。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-08-06T12:30:09.993

假设您有 Unity Pro（可以使用渲染纹理），构建一个快速编辑器脚本来处理这个问题应该不会太困难。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-02-15T15:58:01.817

我认为他所描述的是让“场景”窗口来自相机的能力，因此使用 alt 键改变视角可以自动调整键。那是对的吗？

换句话说，通过使用 alt 来驱动值更改，以将相机作为您的视图，从场景窗口为相机设置动画的能力。那会很有帮助。

Maya 和 Max 等 3D 程序允许您选择相机作为视图，并且通过选择相机并启用自动关键点，将根据您在视口中所做的更改调整关键点值。

但鲍迪奇的建议是次要的。将场景视图窗口更改为您想要的，然后选择相机对象并在 GameObject 下拉菜单中选择“与视图对齐”，相机将捕捉到该对象。然后在相机对象上设置一个键。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-06-17T18:15:35.950

您可以在层次结构中选择相机然后单击旋转按钮，然后您可以在 x,y,z 平面中更改相机方向并在场景视图中看到相机对齐在一个小方块中，因此无需游戏看法

希望有帮助

# c++ - 动态分配浮点数组并将其设置为零

> ID：877385
> 
> 赞同：19
> 
> 时间：2009-05-18T12:02:40.803
> 
> 标签：c++, arrays, floating-point, initializing

如何在分配期间自动将动态分配的浮点数组设置为零（0.0）

这个可以吗

```
float* delay_line = new float[filter_len];

//THIS
memset(delay_line, 0.0, filter_len); //can I do this for a float??

//OR THIS
for (int i = 0; i < filter_len; i++)
  delay_line[i] = 0.0; 
```

哪种方式最有效

谢谢

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-05-18T12:06:25.897

`sizeof(float) * filter_len`除非您在某些奇怪的实现中工作，否则请使用`sizeof(float) == sizeof(char)`.

```
memset(delay_line, 0, sizeof(float) * filter_len); 
```

编辑：正如[Stephan202](https://stackoverflow.com/users/74939/stephan202)在评论中指出的那样，0.0 是一个特别容易为 memset 编码的浮点值，因为 0.0 的 IEEE 标准表示都是零位。

memset 在内存领域运行，而不是在数字领域。第二个参数，声明为 int，被强制转换为 unsigned char。如果您的 C++ 实现每个浮点数使用四个字节，则以下关系成立：

*   如果您将浮点数设置为 0，则该值将为 0.0。
*   如果您将浮点数设置为 1，则该值将为 2.36943e-38。
*   如果您将浮点数设置为 42，则该值将为 1.51137e-13。
*   如果您将浮点数设置为 64，则该值将为 3.00392。

所以零是一个特例。

如果这看起来很奇怪，回想一下 memset 是在 <cstring> 或 <string.h> 中声明的，并且经常用于制作诸如“***************”或“-- ----"。它*也*可以用于零内存是一个很好的副作用。

正如 Milan Babuškov 在评论中指出的那样，有一个功能 bzero （非标准且已弃用），目前在 Mac 和 Linux 上可用，但在 Microsoft 上不可用，因为它专门用于将内存设置为零，所以可以安全地省略一些指令. 如果您使用它，并且编译器的清教徒未来版本省略了它，那么在本地兼容性补丁中自己实现 bzero 是微不足道的，除非未来版本已将*名称重新用于*其他目的。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-18T12:05:51.560

利用

```
#include <algorithm>
...
std::fill_n( delay_line, filer_len, 0 ) 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-18T22:37:36.603

动态分配数组的元素可以初始化为元素类型的默认值，方法是在数组大小后面加上一对空括号：

```
float* delay_line = new float[filter_len](); 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-05-18T12:08:53.503

改用**std::vector**：

```
std::vector<float> delay_line( filter_len ); 
```

向量将被初始化为零。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-18T22:57:13.320

另一种选择是使用 calloc 同时分配和归零：

```
float *delay_line = (float *)calloc(sizeof(float), filter_len); 
```

这里的优点是，根据您的 malloc 实现，如果已知数组是从已经清零的内存中分配的（因为通常是从操作系统分配的页面），则可以避免将数组清零

请记住，您必须在这样的数组上使用 free() 而不是 delete []。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-18T12:08:41.023

现在我们已经完成了：更好的是使用这个`vector`类。

```
std::vector< float > delay_line( filter_len, 0.0 ); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-18T12:15:24.193

> 哪种方式最有效

memset 可能快一点，但谁在乎！？！？微优化到这个级别完全是浪费时间，除非你正在编写一个计算器，甚至可能不会。

我认为 memset 的方式更清晰，但我认为你真的最好检查你的手册页中的 memset ...如果你的标准库版本有一个 memset 函数，它以**浮点数**作为第二个参数，我会感到惊讶。

PS：表示零的位模式对于整数和浮点数都是相同的......这是设计使然，不仅仅是祝你好运。

祝你好运 ;-）

干杯。基思。

# java - 一次性将多个 Java Web 应用程序部署到 Glassfish

> ID：877390
> 
> 赞同：1
> 
> 时间：2009-05-18T12:04:17.820
> 
> 标签：java, web-applications, glassfish

我有多个 (8) WAR 文件和 1 个 EAR 文件，我想将它们部署到 Glassfish，而无需通过管理控制台重新部署每个应用程序。

以前在 Tomcat 中，WAR 文件只能放到 webapps 目录中，Glassfish 有类似的东西吗？使用`asadmin`命令抓取一堆应用程序来部署？最好用于 WAR*和*EAR 文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T12:05:41.247

是的 - 看看 /domains/domain1/autodeply - 你可以把东西直接放在那里。

（如果您在自定义环境中工作，请用您的域替换 domain1）

（对不起，如果文件夹已关闭 - 此时它来自内存）

# c++ - symbian c++ 中的 RSA 算法

> ID：877392
> 
> 赞同：0
> 
> 时间：2009-05-18T12:04:32.157
> 
> 标签：c++, symbian

我已经使用类在 symbian 中实现了 RSA 算法

CSAPublicKey 和 CRSAPKCS1v15Encryptor

实施加密是否正确

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-27T18:48:24.453

有了加密，魔鬼就在细节中。

有很多很多方法可以使加密不正确。例如，使用 RSA，您需要使用填充，否则[许多简单的攻击](http://en.wikipedia.org/wiki/RSA#Padding_schemes)成为可能。即使你得到了正确的填充（如果你正确地使用了 CRSAPKCS1v15Encryptor，你可能是），你必须防御重放攻击，并找到一些方法来获得一个可信的密钥。或者你可能会[像任天堂那样](http://wiibrew.org/wiki/Signing_bug)在最后的比较中失败。

与其询问如何进行 RSA，不如考虑您正在尝试做的事情的整个背景。你使用 RSA 做什么，你是如何使用它的？

# asp.net-mvc - Asp.net MVC 中的 iText

> ID：877396
> 
> 赞同：1
> 
> 时间：2009-05-18T12:05:40.873
> 
> 标签：asp.net-mvc, pdf, itext

我想使用[iText](http://itextsharp.sourceforge.net/)将数据写入 pdf。

我添加的程序集是

1.  iTextdotNET.dll
2.  Gnu.Classpath.Core.dll

但我面临的问题是

*   错误 1 ​​类型“java.io.OutputStream”在未引用的程序集中定义。您必须添加对程序集 'vjslib, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a' 的引用。
*   错误 2 类型“java.io.Serializable”在未引用的程序集中定义。您必须添加对程序集 'vjslib, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a' 的引用。

我的理解是：它需要j#。

现在该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T12:42:04.670

iText 有（至少）两个 .NET 端口。看起来你有[iText.NET](http://www.ujihara.jp/iTextdotNET/en/)。获取最新版本的[iTextSharp](http://sourceforge.net/projects/itextsharp/)，您的依赖问题应该会结束。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T12:28:33.603

iText 的 .NET 版本的新版本只有一个名为 itextsharp.dll 的 DLL，不依赖于 J# 库或类似的东西。

顺便说一句，如果您正在做任何不平凡的事情，请查找邮件列表并立即订购这本书（这本书很深入，但仍然平易近人）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T12:45:41.840

我建议使用[iTextSharp](http://itextsharp.sourceforge.net/)而不是 iText.Net。iText.Net 已经有一段时间没有更新了，而 ITextSharp 是相对最新的，并且可以与较新版本的 .Net 框架无缝协作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T12:26:44.293

您的项目针对的是哪个版本的框架？看起来它正在尝试使用 .NET 1.1 版本的库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T13:45:05.540

gnu.classpath.core.dll 是 IKVM 的一部分，不是吗？除非您想使用 iText 的 Java 版本，否则您不需要它。（如果这样做，请安装 JRE 并正确设置路径）您正在尝试使用 .Net 版本，因此请删除该引用并查看它是否有效。

# php - 将 Img 源与 php 变量一起使用？

> ID：877406
> 
> 赞同：4
> 
> 时间：2009-05-18T12:07:21.883
> 
> 标签：php, variables, image, src

我的 detailansicht.php 中有以下代码：

```
<div class="file_description_box">
    <b>Beschreibung:</b><br /><br />
        <?php 
             if(!empty($beschreibung))
                 echo '<div align="center">';
                 echo '<img src="$coverlink" alt="Cover">';
                 echo '</div><br />';
                 echo format_content($beschreibung); 
             **else**
             echo '<i>Keine Beschreibung vorhanden</i>';
        ?>
</div> 
```

但我认为img标签一定有错误。每次我尝试打开页面时，他都会向我显示一个错误：“解析错误：语法错误，第 123 行 bla/bla/include/detailansicht.php 中的意外 T_ELSE”（第 123 行是 else 标记为粗体）。我尝试了几种方法，但我总是得到这个错误。如果有人可以帮助我，那就太好了。

-斯塔布兹

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-18T12:09:27.763

您缺少一些大括号，并且您的 PHP 变量不是嵌入式属性。您的代码应如下所示：

```
<div class="file_description_box">
    <b>Beschreibung:</b><br /><br />
        <?php 
             if(!empty($beschreibung)){
                 echo '<div align="center">';
                 echo '<img src="'.$coverlink.'" alt="Cover">';
                 echo '</div><br />';
                 echo format_content($beschreibung); 
             }else{
                 echo '<i>Keine Beschreibung vorhanden</i>';
                }
        ?>
</div> 
```

顺便说一句，您使用 PHP 的目的并不重要，如果图像标签有问题并且无法正确显示，那么假设您已正确输出它，通常是 HTML 问题。

在这种情况下，这是一个 PHP 问题，因为代码中有一些错误，它与图像标签没有任何关系。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T12:16:08.777

```
<?php 
     if(!empty($beschreibung)) {
         echo "<div align=\"center\">";
         echo "<img src=\"$coverlink\" alt=\"Cover\">";
         echo "</div><br />";
         echo format_content($beschreibung); 
      } else {
         echo "<i>Keine Beschreibung vorhanden</i>";
      }
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T12:57:37.367

感谢您的所有回答...我现在正在尝试 Kris 的方法...

还有带括号的东西...我不知道这是怎么发生的...我没有编写原始脚本（我只是添加了带封面的部分）而且我没有意识到缺少括号，因为 $beschreibung 永远不会为空，我认为如果括号 a 丢失，php 会忽略 if 和 else...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T12:10:31.287

您缺少花括号：

```
if () {
...
} else {
...
} 
```

所以你的 PHP 在语法上不正确，不会被 PHP 超文本预处理器解析。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T12:10:44.857

尝试使用花括号：

```
<?php 
     if(!empty($beschreibung)) {
         echo '<div align="center">';
         echo '<img src="$coverlink" alt="Cover">';
         echo '</div><br />';
         echo format_content($beschreibung); 
      } else {
         echo '<i>Keine Beschreibung vorhanden</i>';
      }
?> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-18T12:12:27.803

利用

```
echo '<img src="', $coverlink', " alt="Cover">'; 
```

单引号内的 PHP 变量不会被评估

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-18T12:12:38.287

是的，你错过了花括号。简单地用标签很好地格式化代码不会使它成为一个块。

您还错过了 img 标签 (/>) 的结尾，但这与您的问题无关。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-18T12:15:33.570

我会[选择另一种语法](http://nl.php.net/alternative_syntax)，我觉得与 html 混在一起的眼睛更容易：

```
<? if(!empty($beschreibung)) : ?>
    <div align="center">
        <img src="<?= $coverlink; ?>" alt="Cover">
    </div><br />
    <?= format_content($beschreibung); ?> 
<? else : ?>
    <i>Keine Beschreibung vorhanden</i>
<? endif ; ?> 
```

PS：我不主张将逻辑放入标记中，只是指出它可以做到。

**编辑**：修复语法错误（; 在 endif 而不是 :) 之后

# visual-studio - 在 VS2005 生成的 MSI 中包含 MS C++ 运行时

> ID：877418
> 
> 赞同：2
> 
> 时间：2009-05-18T12:09:45.467
> 
> 标签：visual-studio, deployment, windows-installer

我有一个项目依赖于特定版本的 MSVCR80.dll（MS Visual C 运行时），我遇到了一些问题，根据特定的系统配置，我的应用程序并不总是得到正确的版本那个文件。关于查找具有该名称的文件所需的路径有点废话，而且并不总是正确的......

在 VS2005 中创建部署项目时，有没有办法*确保*我的应用程序将*始终*使用我提供的运行时？当我将运行时文件添加到项目中时，它会询问是否创建合并模块......但不确定它是做什么的。不管创建一个，问题仍然存在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T12:28:36.553

Martin Richter 在 CodeProject 上写了一篇关于此的文章： [使用私有 MFC、ATL 和 CRT 程序集轻松创建项目](http://www.codeproject.com/KB/cpp/PrivateAssemblyProjects.aspx)

此解决方案不依赖于您的 MSI 包，而是依赖于使用 CRT 文件的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-30T06:25:47.543

我不确定是您的应用程序在安装后不起作用，还是您在安装过程中使用的 dll 不起作用？

长话短说：新版本的 C/C++ 运行时安装为**Win32 程序集**，或并行安装。这意味着这些文件将进入**C:\Windows\winsxs**下的文件夹- **GAC 的 Win32 等效项**，并且同一文件的多个版本可以在此处共存。

**使用Visual Studio 2005 / 2008**编译的应用程序会将**清单文件**放入二进制文件中，此清单指定**要绑定到的并行运行时版本**。将 MSVCR80.dll 放在 EXE 旁边或什至在 system32 中都没关系 - 嵌入在 EXE 中的清单将从**C:\Windows\winsxs**加载文件。

这都是“完整的循环”。在过去，运行时转到 System32。这导致**了原来的 dll-hell**：应用程序覆盖彼此的全局运行时文件。为了解决所有这些问题，我们的想法是对每个应用程序“隔离更改”。因此，新方法是在 EXE 旁边隔离运行时文件的本地副本。现在这引发了一个全新的问题：如何确保已部署隔离 dll 的安全更新？在大多数情况下，这从未发生过，并且您有很多使用本地不安全 dll 运行的应用程序。那么该怎么办？决定是引入 dll-hell 的第二次出现：并行汇编方法。在这种方法中，运行时不是本地的，而是全局的——关键的区别在于支持并行安装。这样，理论上，应用程序可以在不覆盖彼此的运行时 dll 的情况下运行。

**以上就是“如何使运行时部署变得复杂**”的快速总结。我不确定仍然可以这样做，但是*您是否检查过是否可以静态链接到运行时*？有时老派真的更容易......

# unit-testing - 使用注释时模拟 Spring MVC BindingResult

> ID：877423
> 
> 赞同：14
> 
> 时间：2009-05-18T12:11:12.580
> 
> 标签：unit-testing, spring-mvc, mocking

我正在迁移 Spring MVC 控制器以使用较新的样式注释，并希望对验证命令对象的控制器方法进行单元测试（请参见下面的简单示例）。

```
 @RequestMapping(method = RequestMethod.POST)
public String doThing(Command command, BindingResult result,
                    HttpServletRequest request, HttpServletResponse response,
                    Map<String, Object> model){ 
    ThingValidator validator = new ThingValidator();
    validator.validate(command, result);
... other logic here
    } 
```

我的问题是我必须在单元测试中调用控制器的方法，并提供模拟值以满足其签名以正确执行代码，并且我无法弄清楚如何模拟 BindingResult。

在旧样式的 Controller 中，签名只是简单地采用了 HttpServletRequest 和 HttpServletResponse，它们很容易被模拟，但是由于新注释样式的灵活性，人们必须通过签名传递更多内容。

如何模拟 Spring BindingResult 以在单元测试中使用？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2011-10-13T18:17:52.127

您还可以使用 Mockito 之类的东西[来](http://code.google.com/p/mockito/)创建 BindingResult 的模拟并将其传递给您的控制器方法，即

```
import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.when;
import static org.mockito.Mockito.verifyZeroInteractions;

@Test
public void createDoesNotCreateAnythingWhenTheBindingResultHasErrors() {
    // Given
    SomeDomainDTO dto = new SomeDomainDTO();
    ModelAndView mv = new ModelAndView();

    BindingResult result = mock(BindingResult.class);
    when(result.hasErrors()).thenReturn(true);

    // When
    controller.create(dto, result, mv);

    // Then
    verifyZeroInteractions(lockAccessor);
} 
```

这可以为您提供更大的灵活性并简化脚手架。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-18T12:40:25.437

BindingResult 是一个接口，所以你不能简单地传入该接口的 Springs 实现之一吗？

我不在我的 Spring MVC 代码中使用注释，但是当我想测试验证器的 validate 方法时，我只需传入一个 BindException 实例，然后使用它在 assertEquals 等中返回的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-10-02T05:32:07.653

如[本答案所述](https://stackoverflow.com/a/52018417/1195507)

> A`BindingResult`由 Spring MVC 为每个传入的 HTTP 请求创建。
> 
> 因此，您不想模拟`BindingResult`.

而不是直接调用这些方法，您应该对控制器进行真正的 http 调用，或者使用`MockMvc.perform`. [这是官方文档的教程](https://spring.io/guides/gs/testing-web/) ，展示了如何做到这一点。

# xml - 在 Blackberry 中创建 XML 的更好方法

> ID：877428
> 
> 赞同：2
> 
> 时间：2009-05-18T12:12:27.897
> 
> 标签：xml, blackberry, file-io, java-me

我已经创建了 XML 文件，但我无法查看/输出它。我知道没有办法输出创建的 XML 文件。

谁能建议创建 xml 文件的更好方法？1.使用DocumentBuilderFactory创建xml，然后解析或者2.手动创建硬编码的xml，保存到sd卡，然后访问解析。

我在 xml 文件中有不断变化的文本数据。哪种方法最适合我？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-20T08:01:53.123

我正在使用[kXML2](http://kxml.sourceforge.net/)创建/更改/保存/读取 xml。与 BlackBerry 一起使用请记住：
- 对于发布，您必须预先验证它并使用 ant
[Ahmad Ferdous Bin Alam 构建项目 - 如何将 kxml jar 文件导入您的项目](http://ahmadferdous.blogspot.com/2009/03/how-to-import-kxml-jar-file-to-your.html)
[Slashdev - 使用 Ant 和 Eclipse 进行 BlackBerry 开发](http://www.slashdev.ca/2007/05/30/blackberry-development-with-ant-eclipse/)
**更新：** [教程：如何使用第 3 方应用程序中的库](http://supportforums.blackberry.com/rim/board/message?board.id=java_dev&message.id=22441)
- 要进行调试，您必须将[kXML 源](http://sourceforge.net/project/downloading.php?group_id=9157&filename=kxml2-src-2.3.0.zip&a=104174)和[org.xmlpull.v1 源](http://www.xmlpull.org/v1/download/xmlpull_1_1_3_4c_src.zip)添加到 BB 项目中

## 创建 XML

```
 Document d = new Document();
    Element root = d.createElement("", "parent");       
    root.setName("catalog");
    Element book = d.createElement("", "child");            
    book.setName("book");       
    book.setAttribute(null, "id", "1");             
    Element author = d.createElement("", "child");              
    author.setName("author");               
    author.addChild(0, Node.TEXT, "Colin Wilson");      
    book.addChild(0, Node.ELEMENT, author);

    Element title = d.createElement("", "child");           
    title.setName("title");             
    title.addChild(0, Node.TEXT, "The Mind Parasites");     
    book.addChild(1, Node.ELEMENT, title);

    Element genre = d.createElement("", "child");           
    genre.setName("genre");
    genre.addChild(0, Node.TEXT, "Horror novel, Science fiction novel");    
    book.addChild(2, Node.ELEMENT, genre);

    Element publishDate = d.createElement("", "child");             
    publishDate.setName("publish-date");                
    publishDate.addChild(0, Node.TEXT, "1967"); 
    book.addChild(3, Node.ELEMENT, publishDate);

    root.addChild(0, Node.ELEMENT, book);
    d.addChild(root.ELEMENT, root); 
```

## 在 BlackBerry 文件系统上保存 XML

*   如果使用模拟器不要忘记模拟 SD 卡（工具->更改 SD 卡...）
*   确保您具有读/写操作的访问权限

    ```
    String fileName = "file:///SDCard/books.xml";
    DataOutputStream os = null;
    FileConnection fc = null;
    try {
        fc = (FileConnection) Connector.open(fileName, Connector.READ_WRITE);
        if (!fc.exists())
            fc.create();

        os = fconn.openDataOutputStream();
        KXmlSerializer serializer = new KXmlSerializer();
        serializer.setOutput(os, "UTF-8");
        d.write(serializer);

    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
    ```

    另请参阅：
    [RIM API - 接口 FileConnection](http://www.blackberry.com/developers/docs/4.7.0api/javax/microedition/io/file/FileConnection.html)
    [SUN 开发网络 - 开始使用 FileConnection API](http://developers.sun.com/mobility/apis/articles/fileconnection/index.html)
    [RIM - 如何 - 将纯文本或二进制文件添加到应用程序](http://www.blackberry.com/knowledgecenterpublic/livelink.exe/fetch/2000/348583/800332/800620/How_To_-_Add_plain_text_or_binary_files_to_an_application.html?nodeid=800687&vernum=0)
    [BB 支持论坛 - 关于 FileConnection/JSR 75 的一些问题](http://supportforums.blackberry.com/rim/board/message?board.id=java_dev&message.id=26417)
    [索尼爱立信论坛 - 创建 XML 文件](http://developer.sonyericsson.com/community/message/126441%3Bjsessionid=5E406A0EC79BB5AE926DBD85E3D65997)

## 读取 XML 文件

```
 Document d= new Document();
    FileConnection fc =  null;
    DataInputStream is = null;
    try {
        fc = (FileConnection) Connector.open(fileName, Connector.READ);
        is = fc.openDataInputStream();

        KXmlParser parser = new KXmlParser();
        parser.setInput(is, "UTF-8");
        d.parse(parser);
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (XmlPullParserException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

另请参阅： [RoseIndia.net - J2ME Kxml 示例](http://www.roseindia.net/j2me/kxml/j2me-xml-parser.shtml)

## 更改 XML 文档

您所要做的就是获取所需的元素并对其进行更改：

```
 Element catalog = d.getElement("", "catalog");

    Element book = catalog.getElement("", "book");

    Element title = book.getElement("", "title");
    title.removeChild(0);
    title.addChild(Element.TEXT, "Spider World: The Tower");

    Element publish = book.getElement("", "publish-date");
    publish.removeChild(0);
    publish.addChild(Element.TEXT, "1987"); 
```

## 将 XML 文档输出到 BlackBerry 屏幕（在 Screen 类中的某处）

只需将 xml doc 序列化为字符串并将其放入 RichTextField 中：

```
 deleteAll();
    ByteArrayOutputStream baos = new ByteArrayOutputStream();       
    KXmlSerializer serializer = new KXmlSerializer();
    try {
        serializer.setOutput(baos, "UTF-8");
        d.write(serializer);    
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }   
    add(new RichTextField(baos.toString())); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-10T22:18:38.220

使用[`DOMInternalRepresentation`](http://docs.blackberry.com/en/developers/deliverables/6022/net/rim/device/api/xml/jaxp/DOMInternalRepresentation.html)类呢？尽管有它的名字，它是公共 API 的一部分，并且自 JDE 4.0.0 以来就存在。使用 ，`DOMInternalReprestationClass`您可以将`Document`写入`XMLWriter`。

例如，要写入 a `ByteArrayOutputStream`（方便通过 a 发送`Connection`）：

```
ByteArrayOutputStream os = new ByteArrayOutputStream();
XMLWriter xw = new XMLWriter(os);
DOMInternalRepresentation.parse( myDocument, xw ); 
```

当然，您可以使用 a`FileOutputStream`将 XML 输出定向到磁盘上的文件而不是字节数组。

（如果由于某种原因您不能使用外部库，这似乎是一种非常可行的方法）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2011-03-23T16:03:46.253

您也可以使用 net.rim.device.api.xml.jaxp.XMLWriter 但它需要编写一整页代码来生成一个，除非我错过了什么？

# php - PostgreSQL：每年创建新表/重复现有表的最佳方式

> ID：877431
> 
> 赞同：2
> 
> 时间：2009-05-18T12:12:38.660
> 
> 标签：php, postgresql, database

参考[这个问题](https://stackoverflow.com/questions/863867/database-speed-optimization-few-tables-with-many-rows-or-many-tables-with-few-r)，我决定每年复制表格，用当年的数据创建表格，例如：

```
orders_2008
orders_2009
orders_2010
etc... 
```

好吧，我知道速度问题可能只需要为每个元素设置 2 个表就可以解决，比如 orders_history 和 order_actual，但我认为一旦编写了处理程序代码，就没有区别了......只是很多表。

这些表甚至会有一些带有外键的孩子；例如，orders_2008 将具有子 items_2008：

```
CREATE TABLE orders_2008 (
    id serial NOT NULL,
    code character(5),
    customer text
);

ALTER TABLE ONLY orders_2008
    ADD CONSTRAINT orders_2008_pkey PRIMARY KEY (id);

CREATE TABLE items_2008 (
    id serial NOT NULL,
    order_id integer,
    item_name text,
    price money
);

ALTER TABLE ONLY items_2008
    ADD CONSTRAINT items_2008_pkey PRIMARY KEY (id);

ALTER TABLE ONLY items_2008
    ADD CONSTRAINT "$1" FOREIGN KEY (order_id) REFERENCES orders_2008(id) ON DELETE CASCADE; 
```

所以，我的问题是：你认为每 1 月 1 日复制这些表的最佳方法是什么，当然，还要保持表依赖关系？

一个 PHP/Python 脚本，一个又一个查询，为新年重建结构（由 cron 作业调用）？PostgreSQL 的函数可以这样使用吗？如果是，如何（一个小例子会很好）

实际上，我要采用第一种方式（包含结构的 .sql 文件，以及由 cronjob 加载的重建结构的 php/python 脚本），但我想知道这是否是最好的方式。

**编辑：**我已经看到 pgsql 函数 CREATE TABLE LIKE，但是必须在第二次添加外键.. 否则它将保持新表引用到旧表。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T12:18:02.767

PostgreSQL 有一个特性，可以让您创建一个从另一个表继承字段的表。文档可以在[他们的手册](http://www.postgresql.org/docs/8.3/static/ddl-inherit.html)中找到。这可能会简化您的流程。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T14:24:24.650

您应该查看[Postgresql 中的分区](http://developer.postgresql.org/pgdocs/postgres/ddl-partitioning.html)。这是做你想做的事的标准方式。正如约翰唐尼建议的那样，它使用继承。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T16:07:19.903

非常糟糕的主意。

看看分区并**关注你的真正目标**：

*   您**不**希望每年都设置表格，因为这不是您的问题。没有它们，许多系统都可以正常工作:)
*   您**想解决**一些性能和/或存储空间**问题**。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T12:23:00.667

我推荐orders和order_history ...只是定期将旧订单滚动到历史记录中，现在这是一个只读数据集，所以你添加一个索引来满足你需要的每一个查询，它应该（如果你的数据结构是半体面的）保持性能。

如果您的历史表开始变得“​​太大”，那么可能是时候开始考虑数据仓库了……这确实很棒，但肯定不便宜。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T12:28:30.627

正如其他人在您之前的问题中提到的那样，这可能是一个坏主意。就是说，如果您下定决心这样做，为什么不预先创建所有表格（例如 2008-2050）？

# jquery - 使用 JQuery 保存在数据库中

> ID：877432
> 
> 赞同：-4
> 
> 时间：2009-05-18T12:13:04.167
> 
> 标签：jquery

如何在 JQuery 中单击 editInPlace 的保存按钮时插入数据库。我正在使用 CakePHP 和 MYSQL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T15:31:48.913

这篇[NETTUTS 文章](http://net.tutsplus.com/tutorials/php/asynchronous-comments-with-jquery-and-json/)可能会帮助您了解如何通过 jQuery 和 JSON 将数据发送回服务器，以便使用 PHP 将其保存到 MySQL 数据库中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-02T08:54:57.877

请通过下面给出的链接 [http://net.tutsplus.com/tutorials/php/asynchronous-comments-with-jquery-and-json/](http://net.tutsplus.com/tutorials/php/asynchronous-comments-with-jquery-and-json/)

# sql - 在 SQL Server 2005 中验证 DateTime 字符串

> ID：877434
> 
> 赞同：0
> 
> 时间：2009-05-18T12:13:11.140
> 
> 标签：sql, sql-server, sql-server-2005, validation, datetime

我需要一个 SQL 脚本来验证 SQL Server 2005 数据库中包含 DateTime 值、格式`DD/MM/YYYY`或`NULL`值的表中的 VARCHAR 字段。我想识别所有无效日期。任何人都可以提出一种方法吗？

**更新**

*   答案必须使用 T-SQL；出于性能原因，我不能使用 SQLCLR。

谢谢，魔术安迪

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-18T12:20:10.220

使用“ISDATE()”或“IS NULL”：但首先设置语言以识别日-月-年顺序

```
SET LANGUAGE british
SELECT ISDATE('12/31/2009'), ISDATE('31/12/2009')

SET LANGUAGE us_english
SELECT ISDATE('12/31/2009'), ISDATE('31/12/2009') 
```

编辑：正如@edosoft 所述，您也可以使用 SET DATEFORMAT 。SET LANGUAGE 隐式设置 DATEFORMAT，SET DATEFORMAT 覆​​盖 SET LANGUAGE

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-18T12:26:01.533

使用 ISDATE() 时应指定日期格式。来自在线书籍：

```
SET LANGUAGE us_english;
SET DATEFORMAT dmy;
SELECT ISDATE('15/04/2008'); --Returns 1. 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T12:17:59.680

您可以使用该`ISDATE()`功能

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-18T12:18:08.120

您可以使用内置的 T-SQL IsDate() 函数。并将列更改为 datetime 而不是 varchar。您不能对 varchar 列进行排序或进行任何日期计算。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T12:19:34.323

SQL 的日期处理不是很好，我们编写了一个 DotNet 函数来为困难的情况进行 DateTime 转换。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T14:24:46.117

我有一个解决方案，尽管它只适用于特定的情况。您的情况可能适合也可能不适合。

创建一个名为 ALMANAC 的表，其中每个有效日期都有一行。您可以用十年的有效日期填充它，只有 3,653 行，或多或少。即使你走了一百年，那仍然只有 36,525 行，以今天的标准来说不算太大。

如果有用，您可以将奇怪的公司特定属性添加到此表中。这些属性例如日期是否是公司特定的假期，以及日期所属的财政周、财政月、财政季度和财政年度。

您必须编写一个程序来填充此表，如果您选择额外的属性，该程序必须嵌入您公司的特定日历规则。

然后，您可以像使用任何代码验证表一样使用此表。您还可以使用它来使古怪的日历驱动的报告标准绝对易于实施。

如果您的日期仅限于有限的时间跨度，例如十年甚至一百年，这只是一个好主意。但有时，它真的可以节省时间！我有时使用这种技术使我的数据库独立于一个供应商的日历功能。

# testing - 来自巡航控制的电子邮件报告？

> ID：877436
> 
> 赞同：1
> 
> 时间：2009-05-18T12:13:30.703
> 
> 标签：testing, cruisecontrol

有没有办法让 Cruisecontrol 通过配置文件通过电子邮件发送测试结果？C:\Program Files\cruisecontrol\test-output\index.html

这是我当前在 config.xml 中的发布设置：

```
 <publishers>
        <currentbuildstatuspublisher file="${log.dir}/status.txt"/>
        <htmlemail
    buildresultsurl="http://${build.server}/buildresults/${project.name}"
            subjectprefix="[CruiseControl] " 
            xsldir="${cruise.install.dir}/webapps/cruisecontrol/xsl"
    css="${cruise.install.dir}/webapps/cruisecontrol/css/cruisecontrol.css"
            logdir="${log.dir}"
            mailhost="mailhost" defaultsuffix="@myemail.com" reportsuccess="always"
            returnaddress="${return.email}"
    >
    <always address="${team.email}"/>
    </htmlemail>
 </publishers> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T12:22:17.767

您应该能够使用[fileMerge](http://confluence.public.thoughtworks.org/display/CCNET/File+Merge+Task)任务将其包含在内，如下所示：

```
<publishers>
  <merge>
    <files>
      <file>C:\Project\test-output\emailable-report.html</file>
      <file><!-- path --></file>
    </files>
  </merge>
</publishers> 
```

编辑：假设文件是​​基于 XML...

# database-design - 是否有创建适当数据库索引的策略？

> ID：877439
> 
> 赞同：2
> 
> 时间：2009-05-18T12:14:36.427
> 
> 标签：database-design, indexing, schema

有人问这个问题：“ [Oracle、DB2、Derby 和 HSQLDB 中的 INT、BIGINT 还是 UUID/GUID？](https://stackoverflow.com/questions/857775/int-bigint-or-uuid-guid-in-oracle-db2-derby-and-hsqldb) ”我开始思考我设计的所有数据库模式和我读过的书，但没有一本参考书给出关于创建索引的任何*真正* *明确的建议。*

例如; 如果你有一个复合索引，比如

```
date() ++ foo() ++ bar() 
```

虽然此索引非常适合搜索和排序日期范围数据（读取；读取性能）……但写入却很糟糕。（插入总是发生在平衡树的右侧，强制重新平衡，这是一项昂贵的操作）

显然... a) 了解您的数据。b) 了解您的用例。c) 了解您的数据库引擎。

但是，为高性能数据库定义合理模式的常识性一般规则是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T13:10:30.447

好的，这里有一些关于索引生成的明确建议：这取决于。

这很清楚，但根本不具体。如果你想要更具体的东西，你必须了解它所依赖的东西。

这取决于您的 DBMS，甚至可能取决于您的 DBMS 的版本。这里有一些你应该了解的流行语，至少表面上是这样。“表面上”我的意思是了解它对你的作用，以及它如何伤害你，但不一定是它是如何工作的。如果可以获得，请使用特定于您的 DBMS 的文档。

避免全表扫描。

仅索引检索。

范围检索。（以及复合或复合索引）

合并加入（稍后讨论）。

哈希索引。

并发控制（稍后讨论）。

主键和索引（稍后讨论）。

索引更新的成本。

索引的延迟更新。

基于成本的优化。如果您的 DBMS 没有 CBO，则获取另一个 DBMS。

提示。（如何使用它们，以及如何在没有它们的情况下生活。）

数据库管理和 CBO。一些 DBMS 需要定期 DBA 操作来防止优化器使用过时的策略。

这取决于数量：对于非常小的表，索引设计相对简单。“相对微不足道”，我的意思是它相当容易，但它也相当不重要。犯错的成本很低。如果您正在构建查找表，您肯定会希望在代码列上有一个唯一索引。如果您将代码列声明为主键，您将获得这样的表（包含大多数 DBMS）。如果您不创建任何其他索引，则成本可能是在可以容忍一些延迟的异常情况下对小表进行表扫描。

任何模式中的大表往往是由常规事务处理添加的表。这增加了拥有一些索引的好处，无论是在速度方面还是在事务并发方面。它还增加了拥有索引的成本，因为事务必须更新索引。成本收益权衡对于事务表来说可能非常微妙且非常重要。

如果您的 DBMS 支持它，您可以使用延迟更新来对事务表上的某些索引产生良好的效果。

在任何模式中，至少尝试区分引用表和事务表。我知道，我知道，这有点主观。用你最好的判断。

这取决于流量：并非所有表都获得相同数量的流量。索引加速连接和查找。至少您应该了解您的 DBMS 是否有一个优化器，该优化器知道如何根据可用索引和表卷进行合并连接。如果您不知道什么是合并连接，请了解它是什么。但是不要浪费时间学习如何编写合并连接，除非那是你为生而做的事情。

这取决于紧迫性。在后台批处理期间每月执行一次的查询不如每天让用户等待 1000 次，而该用户盯着屏幕或上下文切换她的多任务处理的查询那么紧急。

当心产品营销会告诉您有关紧迫性的信息。他们往往会告诉您，在任何情况下都比竞争对手更快是最紧迫的，即使这意味着您要在晚上和周末工作而错过第一个孩子的出生。营销人员通常不在乎您是否感到筋疲力尽。他们就像一个骑师，不在乎这匹马是否会再次比赛。事实是，有些交易非常紧急，而另一些则相对不重要。

准备好灵活地设计索引，并考虑权衡取舍。

我希望我能给你指出一本关于这个主题的非常好的书。我希望其他人会这样做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T12:41:04.423

创建索引只有几个经验法则：

*   在外键上创建索引
*   在典型的搜索列上创建索引，例如用户的登录名和 pin、产品的产品 ID 等。
*   不要创建任何内容，因为您认为它*可以*提高性能。

应根据应用程序的性能问题添加额外的索引

*   观察您的应用程序并识别耗时的查询
*   当您确定关键查询时，分析执行计划并使用索引对其进行优化。

在最后一句话中，您说“定义一个合理的模式”。这比如何设计索引要通用得多。

# python - 尝试...除了...除了...：如何避免重复代码

> ID：877440
> 
> 赞同：4
> 
> 时间：2009-05-18T12:14:41.323
> 
> 标签：python, try-catch, dry

*   我想避免`errorCount += 1`在多个地方写作。
*   我正在寻找比

```
    成功 = 假
    尝试：
        ...
    别的：
        成功 = 真
    最后：
        如果成功：
            storage.store.commit()
        别的：
            storage.store.rollback()

```

*   我试图避免`store.rollback()`在每个 except 子句中。

关于如何做到这一点的任何想法？

```
count = 0
successCount = 0
errorCount = 0
for row in rows:
    success = False
    count += 1
    newOrder = storage.RepeatedOrder()
    storage.store.add(newOrder)
    try:
        try:
            newOrder.customer = customers[row.customer_id]
        except KeyError:
            raise CustomerNotFoundError, (row.customer_id,)
        newOrder.nextDate = dates[row.weekday]
        _fillOrder(newOrder, row.id)
    except CustomerNotFoundError as e:
        errorCount += 1
        print u"Error: Customer not found. order_id: {0}, customer_id: {1}".format(row.id, e.id)
    except ProductNotFoundError as e:
        errorCount += 1
        print u"Error: Product not found. order_id: {0}, product_id: {1}".format(row.id, e.id)
    else:
        success = True
        successCount += 1
    finally:
        if success:
            storage.store.commit()
        else:
            storage.store.rollback()
print u"{0} of {1} repeated orders imported. {2} error(s).".format(successCount, count, errorCount) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-18T12:25:52.220

这看起来像是 Python 新`with`语句的可能应用。无论代码块有什么结果，它都允许安全地展开操作并释放资源。

[在PEP 343](http://www.python.org/dev/peps/pep-0343/)中了解它

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T12:25:37.683

我的建议是编写一个`logError()`递增的方法`errorCount`（使其成为成员变量）并打印错误。由于您的异常代码相似，您还可以通过以下方式缩短代码：

```
try:
    # something
except (CustomerNotFoundError, ProductNotFoundError), e:
    logError(e) 
```

您可以根据需要打印任何内容`e`。

此外，您不需要跟踪成功：`successCount = len(rows) - errorCount`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T12:18:30.350

你可以简单地将你的异常实现包装在一个异常特定的容器类中，这样你也可以避免所有这些显式的打印调用（一旦你改变你的界面，这可能会派上用场，例如在支持 GUI 时），而不是你会有一个像error(msg)这样的方法，它反过来可以在内部相应地增加错误计数。换句话说，只需设置一个外部帮助类来管理您的异常处理内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T12:19:37.693

如果您喜欢累积错误，为什么不累积错误？如果您将错误消息放在列表中，则列表的大小会提供您需要的信息。您甚至可以对某些内容进行后处理。您可以轻松决定是否发生错误并且仅在一个地方调用 print

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T12:21:18.690

好吧，根据this page，第7.4部分：

[http://docs.python.org/reference/compound_stmts.html](http://docs.python.org/reference/compound_stmts.html)

这在 python 版本中是可能的。>= 2.6。我的意思是尝试..除了..最终构建。

# asp.net - 如何在asp.net中使用asp页面

> ID：877448
> 
> 赞同：1
> 
> 时间：2009-05-18T12:17:15.453
> 
> 标签：asp.net, asp-classic

我想在我的 asp.net 应用程序中使用 asp 页面，而无需对 asp 页面进行任何修改。

此外，我想在我的 .net 应用程序中添加母版页。所以我需要将更改也反映在 asp 页面中。

有没有可能......无论如何？或任何替代使用这个..？

请给我 ....thanx 提前...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T12:21:58.517

ASP 没有母版页，因此您不能使用它们。最明智的做法是在 ASP.NET 中重写 ASP 页面，而周围仍有人了解 ASP 页面的用途。否则会有一段时间没有人理解该页面。

我看到的最接近您正在寻找的内容是编写一个 ASP.NET 页面，该页面通过 IFRAME 引用 ASP 页面。ASP.NET 页面可以是内容页面，引用母版页，并且 ASP 页面可以保持不变。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T12:31:05.487

经典 ASP 文件在 ASP.NET 网站中运行没有任何问题。一旦你想在一个文件中混合经典的 ASP 和 ASP.NET 功能，你就会得到错误。无法将母版页应用于经典 ASP 文件。

**[编辑]**
另一种方法是将 ASP 页面的功能重写为 ASP.NET。这里有一个关于从 ASP 转换为 ASP.NET 的工具的[问题](https://stackoverflow.com/questions/821230/any-good-references-or-tools-available-for-converting-asp-to-asp-net)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T13:37:54.963

一种肮脏的方式：从 ASP.NET 代码向 .asp 页面发出 HTTP 请求，并将响应存储在 Web 控件中。它不漂亮，但它有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T10:18:15.493

当我学习我的方法是使用 jquery 将我的 asp 经典生成的 html 放入指定的 div 时，我一起使用了 asp 和 asp.net vb ...随着我的倾斜度增加，我需要越来越少地使用这种方法，这是一个好方法当你没有时间学习时，比如在工作中，从 VB 背景迁移到 asp.net C#。

# javascript - 如何修复 IFrame 中的闪烁问题？

> ID：877449
> 
> 赞同：-2
> 
> 时间：2009-05-18T12:17:35.513
> 
> 标签：javascript, html

我在 html 中使用 iframe。用于将多个 html 文件加载到单个 html 文件中。

问题是当我将一个页面导航到另一个页面时，我正在闪烁。

如何修复 iframe 中的闪烁。我也在其中使用 Dhtml 过滤器和转换。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T14:58:06.313

The web is, thankfully, not Powerpoint. You can [pretend that it is though](http://msdn.microsoft.com/en-us/library/ms532847(VS.85).aspx#Interpage_Transition), but, happily, only for Internet Explorer users.

As some time has passed since I initially wrote this answer, the more disturbed recessed of my brain suggest that you could create a duplicate iframe, position it below (in z-space) the first, and (when the onload event of the frame fires) [animate](http://developer.yahoo.com/yui/animation/) the opacity of the original iframe from 1 to 0 before removing the element entirely.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T20:59:24.567

$('#yourcontent').load(url, 'param=value' post || get {param: value}); jquery('#yourcontent').load(url, 'param=value' post || get {param: value});

使用这种方法，您不需要 iframe，尽管需要 javascript。我假设您已经不介意所需的 javascript。

# unix - 命令行获取进程使用的内存

> ID：877461
> 
> 赞同：5
> 
> 时间：2009-05-18T12:19:35.853
> 
> 标签：unix, command-line

我应该写什么命令行来显示进程使用的内存以及进程命令行及其 pid ？

就像是：

> ```
> pid mem cmdline
> --- --- -------
> 112 12M mysql -param1 5 -param2 12
> 115 15M apache -param1 44 -param2 8
> ... 
> ```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-18T12:26:07.480

尝试

```
ps -eo pid,rss,cmd 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T12:30:01.963

没有类似 /proc 目录的东西吗？/proc/[id]/mem 应该带你到那里。

# load - EC2 中的弹性负载平衡

> ID：877468
> 
> 赞同：23
> 
> 时间：2009-05-18T12:21:20.623
> 
> 标签：load, amazon-ec2, load-balancing, haproxy

它已经出现了一段时间，但现在亚马逊已经发布了[弹性负载平衡](http://aws.amazon.com/elasticloadbalancing/)(ELB)，您对为高流量 Web 应用程序部署此解决方案有何想法？

我们应该替换[HAProxy](http://en.wikipedia.org/wiki/HAProxy)还是将 ELB 作为 HAProxy 前面的免费服务？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-06-28T19:39:04.013

我已经在一个每天获得大约 100,000 次访问的网站上运行 ELB 而不是 HAProxy 大约一个月了，我对结果非常满意。

不过有个问题（更新，这个问题已经被[亚马逊 AWS](http://en.wikipedia.org/wiki/Amazon_Web_Services)修复了，见下面的评论）：

1.  您无法对域的根目录进行负载均衡，因为您必须为负载均衡器创建[CNAME](http://en.wikipedia.org/wiki/CNAME_record)别名。一旦解决方案是将所有流量从 重定向`http://mysite.com`到`http://www.mysite.com`。

除此之外，我对 AWS ELB 产品的评价还不够高。我也在使用 Cloudwatch 监控和自动缩放。哦，别忘了它比运行一个小型[EC2](http://en.wikipedia.org/wiki/Amazon_Elastic_Compute_Cloud)实例便宜（每小时 0.025 美元而不是 0.10 美元）。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-09-01T16:21:28.890

ELB 对 DNS CNAME 记录间接的依赖对于需要非常快的 Web 服务来说是相当严重的。在我们的例子中，我们需要有非常好的响应时间。在快速性能测试中，使用 ELB 将 HTTP 请求的平均延迟增加了近 2 倍。这主要是因为 CNAME 查找的 TTL 为零。因此，所有查找都涉及访问两个不同域的名称服务器，因此名称解析要慢得多。（我担心击败 DNS 中的缓存只是对系统的滥用。）在我们的案例中，ELB 的唯一希望是通过让 Amazon 支持弹性 IP 作为负载均衡器实例的地址来摆脱 CNAME 记录。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-11-12T18:53:13.077

另一个问题是获取客户端 IP 地址。对于常规 HTTP，这可以正常工作，因为 ELB 设置了 X-FORWARDED-FOR 标头。但是对于 HTTPS，这是不可能的，因为它是在 TCP 层转发的。希望有一天ELB会终止SSL。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-07-20T05:03:51.850

亚马逊论坛上有关于 ELB 可靠性的投诉。我建议你去那里搜索ELB，在这方面形成你自己的看法。

我们想使用 ELB 来负载平衡 Web 服务请求，但是我们有很多外部调用者，其中一些会发送 100-Continue HTTP 消息。不幸的是，ELB 不理解 HTTP 协议的那一部分，所以在解决这个问题之前，我们无法超越概念验证。

**2013 更新**

根据 AWS 论坛帖子，现在支持 HTTP 100-Continue。

[https://forums.aws.amazon.com/message.jspa?messageID=144022](https://forums.aws.amazon.com/message.jspa?messageID=144022)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-28T02:16:52.577

对于许多使用 ELB 的用户来说，一个主要问题是它不支持粘性，这是许多 Web 应用程序的杀手锏。

然而，根据[亚马逊 AWS](http://en.wikipedia.org/wiki/Amazon_Web_Services)开发人员的说法，它应该会出现在下一个版本中。

# c - 如何使用 Perl 从文件中删除多行 C 注释？

> ID：877470
> 
> 赞同：7
> 
> 时间：2009-05-18T12:22:00.763
> 
> 标签：c, perl, comments

任何人都可以让我使用正则表达式来去除文件中的多行注释和单行注释吗？

*例如：*

```
 " WHOLE "/*...*/" HAS TO BE STRIPED OFF....."

1\.   /* comment */
2\.   /* comment1 */  code   /* comment2 */ #both /*comment1*/ and /*comment2*/ 
                                             #has to striped off and rest should 
                                                 #remain.
3\.   /*.........
       .........
       .........
       ......... */ 
```

如果你有这个需要，我真的很感激你....在此先感谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-26T16:30:33.077

来自[perlfaq6](http://faq.perl.org/perlfaq6.html#How_do_I_use_a_regul) “如何使用正则表达式从文件中去除 C 风格的注释？”：

* * *

虽然这实际上是可以做到的，但它比你想象的要困难得多。例如，这个单线

```
perl -0777 -pe 's{/\*.*?\*/}{}gs' foo.c 
```

将适用于许多但不是所有情况。你看，对于某些类型的 C 程序来说，这太简单了，特别是那些在引用字符串中看起来像是注释的程序。为此，您需要这样的东西，由 Jeffrey Friedl 创建，后来由 Fred Curtis 修改。

```
$/ = undef;
$_ = <>;
s#/\*[^*]*\*+([^/*][^*]*\*+)*/|("(\\.|[^"\\])*"|'(\\.|[^'\\])*'|.[^/"'\\]*)#defined $2 ? $2 : ""#gse;
print; 
```

当然，这可以用 /x 修饰符写得更清晰，添加空格和注释。此处扩展，由 Fred Curtis 提供。

```
s{
   /\*         ##  Start of /* ... */ comment
   [^*]*\*+    ##  Non-* followed by 1-or-more *'s
   (
     [^/*][^*]*\*+
   )*          ##  0-or-more things which don't start with /
               ##    but do end with '*'
   /           ##  End of /* ... */ comment

 |         ##     OR  various things which aren't comments:

   (
     "           ##  Start of " ... " string
     (
       \\.           ##  Escaped char
     |               ##    OR
       [^"\\]        ##  Non "\
     )*
     "           ##  End of " ... " string

   |         ##     OR

     '           ##  Start of ' ... ' string
     (
       \\.           ##  Escaped char
     |               ##    OR
       [^'\\]        ##  Non '\
     )*
     '           ##  End of ' ... ' string

   |         ##     OR

     .           ##  Anything other char
     [^/"'\\]*   ##  Chars which doesn't start a comment, string or escape
   )
 }{defined $2 ? $2 : ""}gxse; 
```

稍作修改也删除了 C++ 注释，可能使用连续字符跨越多行：

```
 s#/\*[^*]*\*+([^/*][^*]*\*+)*/|//([^\\]|[^\n][\n]?)*?\n|("(\\.|[^"\\])*"|'(\\.|[^'\\])*'|.[^/"'\\]*)#defined $3 ? $3 : ""#gse; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-18T12:56:59.803

在 Perl 中，您可以使用 CPAN：[Regexp::Common::Comment](http://search.cpan.org/dist/Regexp-Common/lib/Regexp/Common/comment.pm)应该对您有所帮助。我发现使用您描述的注释的一种语言是 Nickle，但也许 PHP 注释可以（// 也可以开始单行注释）。

请注意，在任何情况下，使用正则表达式去除注释都是危险的，语言的完整解析器风险要小得多。例如，正则表达式解析器可能会被`print "/*";`.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-18T18:02:15.490

这是一个常见问题解答：

```
perldoc -q comment 
```

在[perlfaq6](https://metacpan.org/pod/perlfaq6#How-do-I-use-a-regular-expression-to-strip-C-style-comments-from-a-file)中找到：

> 如何使用正则表达式从文件中删除 C 样式的注释？
> 
> 虽然这实际上是可以做到的，但它比你想象的要困难得多。例如，这个单线...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-18T13:47:05.887

还有一个非 perl 的答案：使用程序[stripcmt](http://www.bdc.cx/software/stripcmt/)：

> StripCmt 是一个用 C 语言编写的简单实用程序，用于从 C、C++ 和 Java 源文件中删除注释。在 Unix 文本处理程序的伟大传统中，它既可以用作 FIFO（先进先出）过滤器，也可以在命令行上接受参数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T13:03:04.907

删除 /* */ 注释（包括多行）

```
s/\/\*.*?\*\///gs 
```

我发布这个是因为它很简单，但是我相信它会被嵌入的评论绊倒，比如

```
/* sdafsdfsdf /*sda asd*/ asdsdf */ 
```

但由于它们相当少见，我更喜欢简单的正则表达式。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-05-18T13:00:30.640

包括测试：

```
use strict;
use warnings;
use Test::More qw(no_plan);
sub strip_comments {
  my $string=shift;
  $string =~ s#/\*.*?\*/##sg; #strip multiline C comments
  return $string;
}
is(strip_comments('a/* comment1 */  code   /* comment2 */b'),'a  code   b');
is(strip_comments('a/* comment1 /* comment2 */b'),'ab');
is(strip_comments("a/* comment1\n\ncomment */ code /* comment2 */b"),'a code b'); 
```

# iphone - 如何在 iPhone OS 3.0 中隐藏状态栏？

> ID：877477
> 
> 赞同：0
> 
> 时间：2009-05-18T12:23:59.200
> 
> 标签：iphone, objective-c

我有一个 iPhone 应用程序，我在其中使用 image pickerview 从 iPhone 照片库中选择照片。在 Info.plist 文件中，我使用隐藏状态栏。在 iPhone OS 2.2.1 中不显示状态栏。但是当我在 iPhone OS 3.0 中调试这个应用程序时，会显示状态栏。但不是在我调用 imagepickerview 来选择照片时显示的开头。如何隐藏状态栏 iPhone OS 3.0？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T14:03:29.670

试试这个代码：

```
[[UIApplication sharedApplication] setStatusBarHidden: YES animated: NO]; 
```

# python - 在二维中扩展 numpy 数组的最简单方法是什么？

> ID：877479
> 
> 赞同：58
> 
> 时间：2009-05-18T12:24:11.600
> 
> 标签：python, arrays, math, numpy

我有一个看起来像这样的二维数组：

```
XX
xx 
```

添加额外行和列的最有效方法是什么：

```
xxy
xxy
yyy 
```

对于加分，我还希望能够剔除单行和单列，因此例如在下面的矩阵中，我希望能够剔除所有的 a，只留下 x - 特别是我试图同时删除第 n 行和第 n 列 - 我希望能够尽快做到这一点：

```
xxaxx
xxaxx
aaaaa
xxaxx
xxaxx 
```

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-05-18T12:47:07.700

我能想到的最短的代码行是第一个问题。

```
>>> import numpy as np
>>> p = np.array([[1,2],[3,4]])

>>> p = np.append(p, [[5,6]], 0)
>>> p = np.append(p, [[7],[8],[9]],1)

>>> p
array([[1, 2, 7],
   [3, 4, 8],
   [5, 6, 9]]) 
```

而对于第二个问题

```
 p = np.array(range(20))
>>> p.shape = (4,5)
>>> p
array([[ 0,  1,  2,  3,  4],
       [ 5,  6,  7,  8,  9],
       [10, 11, 12, 13, 14],
       [15, 16, 17, 18, 19]])
>>> n = 2
>>> p = np.append(p[:n],p[n+1:],0)
>>> p = np.append(p[...,:n],p[...,n+1:],1)
>>> p
array([[ 0,  1,  3,  4],
       [ 5,  6,  8,  9],
       [15, 16, 18, 19]]) 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2011-04-13T14:04:28.760

**第一个问题的有用替代答案，使用来自**tomeedee**答案的示例，将使用 numpy 的**vstack**和**column_stack**方法：**

给定一个矩阵 p，

```
>>> import numpy as np
>>> p = np.array([ [1,2] , [3,4] ]) 
```

可以通过以下方式生成增广矩阵：

```
>>> p = np.vstack( [ p , [5 , 6] ] )
>>> p = np.column_stack( [ p , [ 7 , 8 , 9 ] ] )
>>> p
array([[1, 2, 7],
       [3, 4, 8],
       [5, 6, 9]]) 
```

这些方法在实践中可能比 np.append() 方便，因为它们允许将一维数组附加到矩阵而无需任何修改，与以下情况相反：

```
>>> p = np.array([ [ 1 , 2 ] , [ 3 , 4 ] , [ 5 , 6 ] ] )
>>> p = np.append( p , [ 7 , 8 , 9 ] , 1 )
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.6/dist-packages/numpy/lib/function_base.py", line 3234, in append
    return concatenate((arr, values), axis=axis)
ValueError: arrays must have same number of dimensions 
```

**在回答第二个问题时，删除行和列的一个好方法是使用逻辑数组索引，如下所示：**

给定一个矩阵 p，

```
>>> p = np.arange( 20 ).reshape( ( 4 , 5 ) ) 
```

假设我们要删除第 1 行和第 2 列：

```
>>> r , c = 1 , 2
>>> p = p [ np.arange( p.shape[0] ) != r , : ] 
>>> p = p [ : , np.arange( p.shape[1] ) != c ]
>>> p
array([[ 0,  1,  3,  4],
       [10, 11, 13, 14],
       [15, 16, 18, 19]]) 
```

注意 - 对于改革后的 Matlab 用户 - 如果您想在单行中执行这些操作，您需要索引两次：

```
>>> p = np.arange( 20 ).reshape( ( 4 , 5 ) )    
>>> p = p [ np.arange( p.shape[0] ) != r , : ] [ : , np.arange( p.shape[1] ) != c ] 
```

这种技术也可以扩展到删除行和列的*集合*，所以如果我们想删除第 0 行和第 2 行以及第 1、2 和 3 列，我们可以使用 numpy 的**setdiff1d**函数来生成所需的逻辑索引：

```
>>> p = np.arange( 20 ).reshape( ( 4 , 5 ) )
>>> r = [ 0 , 2 ]
>>> c = [ 1 , 2 , 3 ]
>>> p = p [ np.setdiff1d( np.arange( p.shape[0] ), r ) , : ] 
>>> p = p [ : , np.setdiff1d( np.arange( p.shape[1] ) , c ) ]
>>> p
array([[ 5,  9],
       [15, 19]]) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-08-13T11:29:16.003

**第一个问题**的另一个优雅的解决方案可能是`insert`命令：

```
p = np.array([[1,2],[3,4]])
p = np.insert(p, 2, values=0, axis=1) # insert values before column 2 
```

导致：

```
array([[1, 2, 0],
       [3, 4, 0]]) 
```

`insert`可能比`append`但允许您轻松地用一个值填充整个行/列。

至于**第二个问题**，`delete`之前有人提出过：

```
p = np.delete(p, 2, axis=1) 
```

再次恢复原始数组：

```
array([[1, 2],
       [3, 4]]) 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-01-03T12:37:50.830

我发现通过分配更大的矩阵来“扩展”要容易得多。例如

```
import numpy as np
p = np.array([[1,2], [3,4]])
g = np.array(range(20))
g.shape = (4,5)
g[0:2, 0:2] = p 
```

以下是数组：

`p`

```
 array([[1, 2],
       [3, 4]]) 
```

`g`：

```
array([[ 0,  1,  2,  3,  4],
       [ 5,  6,  7,  8,  9],
       [10, 11, 12, 13, 14],
       [15, 16, 17, 18, 19]]) 
```

以及`g`分配后的结果：

```
 array([[ 1,  2,  2,  3,  4],
       [ 3,  4,  7,  8,  9],
       [10, 11, 12, 13, 14],
       [15, 16, 17, 18, 19]]) 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-09-13T05:08:32.663

您可以使用：

```
>>> np.concatenate([array1, array2, ...]) 
```

例如

```
>>> import numpy as np
>>> a = [[1, 2, 3],[10, 20, 30]]
>>> b = [[100,200,300]]
>>> a = np.array(a) # not necessary, but numpy objects prefered to built-in
>>> b = np.array(b) # "^
>>> a
array([[ 1,  2,  3],
       [10, 20, 30]])
>>> b
array([[100, 200, 300]])
>>> c = np.concatenate([a,b])
>>> c
array([[  1,   2,   3],
       [ 10,  20,  30],
       [100, 200, 300]])
>>> print c
[[  1   2   3]
 [ 10  20  30]
 [100 200 300]] 
```

~-+-~-+-~-+-~

有时，如果 numpy 数组对象的 shape 属性的值不完整，您会遇到麻烦。通过将元组分配给形状属性来解决此问题：（array_length，element_length）。

注意：这里，'array_length' 和 'element_length' 是整数参数，您可以在 for 中替换值。“元组”只是括号中的一对数字。

例如

```
>>> import numpy as np
>>> a = np.array([[1,2,3],[10,20,30]])
>>> b = np.array([100,200,300]) # initialize b with incorrect dimensions
>>> a.shape
(2, 3)
>>> b.shape
(3,)
>>> c = np.concatenate([a,b])

Traceback (most recent call last):
  File "<pyshell#191>", line 1, in <module>
    c = np.concatenate([a,b])
ValueError: all the input arrays must have same number of dimensions
>>> b.shape = (1,3)
>>> c = np.concatenate([a,b])
>>> c
array([[  1,   2,   3],
       [ 10,  20,  30],
       [100, 200, 300]]) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-08-17T16:41:26.957

回答第一个问题：

使用 numpy.append。

[http://docs.scipy.org/doc/numpy/reference/generated/numpy.append.html#numpy.append](http://docs.scipy.org/doc/numpy/reference/generated/numpy.append.html#numpy.append)

回答第二个问题：

使用 numpy.delete

[http://docs.scipy.org/doc/numpy/reference/generated/numpy.delete.html](http://docs.scipy.org/doc/numpy/reference/generated/numpy.delete.html)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-03-02T12:12:56.917

如果您想在新位置中使用恒定值，您可以使用`np.pad`.

[https://numpy.org/doc/stable/reference/generated/numpy.pad.html](https://numpy.org/doc/stable/reference/generated/numpy.pad.html)

```
>>> p = np.array([[1,2],[3,4]])
>>> np.pad(p, ((0,1),(0,1))) # Lengthen each dimension by 1.
array([[1, 2, 0],
       [3, 4, 0],
       [0, 0, 0]]) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-06-25T15:11:56.683

也许你需要这个。

```
>>> x = np.array([11,22])
>>> y = np.array([18,7,6])
>>> z = np.array([1,3,5])
>>> np.concatenate((x,y,z))
array([11, 22, 18,  7,  6,  1,  3,  5]) 
```

# c# - c#/winforms：两个控件如何动态共享可用空间？

> ID：877492
> 
> 赞同：7
> 
> 时间：2009-05-18T12:28:02.700
> 
> 标签：c#, winforms

我将如何为以下情况设置我的控件？：

我有一个父容器，例如一个`GroupBox`.

在这个父容器中，我有两个类似的控件，例如`ListBox`es，彼此相邻。它们都具有相同的大小，因此它们之间的边界正好在`GroupBox`.

现在，当调整 es 的`GroupBox`大小时，我希望`ListBox`es 也调整大小，但两者的大小应始终与另一个大小相同。所以他们两个之间的边界也停留在中间`GroupBox`。

那么，我将如何设置这三个控件的属性以实现我想要的行为？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-18T12:56:44.953

你需要另一个容器。TableLayoutPanel 是最好的解决方案。使用 1 行 2 列并将其停靠（停靠 = 填充）在组框中。两列的宽度应设置为 50%。接下来，您可以在各个单元格中添加控件并将它们停靠（停靠 = 填充）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T12:33:48.850

也许 a`SplitContainer`将两半均匀设置并`IsSplitterFixed`设置为`true`（以阻止用户移动它）：

```
[STAThread]
static void Main() {
    Application.EnableVisualStyles();
    Application.Run(new Form {
        Controls = { new SplitContainer {
            Width = 200,
            IsSplitterFixed = true,
            SplitterDistance = 100,
            SplitterWidth = 1,
            Dock = DockStyle.Fill,
            Panel1 = { Controls = {
                    new ListBox {
                        IntegralHeight = false,
                        Dock = DockStyle.Fill,
                        BackColor = Color.Blue,
                        Items = {"abc","def","ghi"}
                    }
                }
            }, Panel2 = { Controls = {
                    new ListBox {
                        Dock = DockStyle.Fill,
                        BackColor = Color.Red,
                        IntegralHeight = false,
                        Items = {"jkl","mno","pqr"}
                    }
                }
            }
        }}
    });        
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T12:38:27.657

没有拆分容器也是可能的。

在 groupbox 的 resize 事件中，将第一个控件的位置设置为 {0,0}，将第二个控件的位置设置为 {GroupBox.Width/2,0}，并将两者的大小设置为 {GroupBox.Width/2, GroupBox 。高度}

您还应该在控件周围留出空间，以免它们与 GroupBox 的边框重叠。

```
private void groupBox1_Resize(object sender, EventArgs e)
{
    groupBox1.SuspendLayout();

    listBox1.Location = new Point(7, 20);
    listBox2.Location = new Point(groupBox1.Width / 2, 20);

    listBox1.Size = new Size(groupBox1.Width / 2 - 6, groupBox1.Height - 27);
    listBox2.Size = new Size((groupBox1.Width + 1) / 2 - 6, groupBox1.Height - 27);

    groupBox1.ResumeLayout();
} 
```

# asp.net-mvc - 使用 ASP.NET MVC 在视图中的 VB.NET 扩展方法

> ID：877496
> 
> 赞同：5
> 
> 时间：2009-05-18T12:28:54.680
> 
> 标签：asp.net-mvc, vb.net, .net-3.5, extension-methods

周末我在 vb.net 中处理 asp.net mvc 项目时遇到了一个奇怪的问题。我创建了一个扩展方法来将整数转换为与之关联的相应月份。我在控制台应用程序中测试了扩展方法，所以我知道它正在工作。

在我的 asp.net mvc 项目中，我有一个视图并想调用扩展方法，但我收到一个错误，即扩展方法无法识别。我导入了它包含的名称空间，但仍然无法摆脱错误。知道发生了什么吗？我没有我的代码，但如果有帮助，我可以在今晚发布。谢谢！

扩展方法：

```
Imports System.Runtime.CompilerServices

Module SiteExtensions
    <Extension()> _
    Public Function ConvertToMonth(ByVal monthNumber As Integer) As String
        Dim month As String = String.Empty
        Select Case monthNumber
            Case 1
                month = "January"
            Case 2
                month = "February"
            Case 3
                month = "March"
            Case 4
                month = "April"
            Case 5
                month = "May"
            Case 6
                month = "June"
            Case 7
                month = "July"
            Case 8
                month = "August"
            Case 9
                month = "September"
            Case 10
                month = "October"
            Case 11
                month = "November"
            Case 12
                month = "December"
        End Select
        Return month
    End Function
End Module 
```

看法：

```
<%  For Each m As Integer In DirectCast(ViewData("Months"), IEnumerable)%>
<a href="#"><%=m.ConvertToMonth()%><br /></a>
<%Next%> 
```

错误是：“ConvertToMonth 不是 Integer 的成员”

乔恩

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-22T15:22:35.370

确保将模块声明为 Public。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-25T08:25:36.207

像这样更改代码：

```
Public Module SiteExtensions

End Module 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T12:40:45.000

该代码可能会有所帮助，但听起来您仍然无法正确导入扩展方法。您可能想尝试为其提供与您的应用程序相同的命名空间。或者将扩展的命名空间更改为`System.Web.Mvc`，因为我们知道命名空间有效，然后从那里退出。

# .net - MSbuild 使用批处理文件发布到特定目录

> ID：877500
> 
> 赞同：2
> 
> 时间：2009-05-18T12:30:49.060
> 
> 标签：.net, msbuild, cruisecontrol.net, batch-file

以下是发布到发布目录的批处理文件

```
@echo off
start
    /b
    C:\WINDOWS\Microsoft.NET\Framework\v3.5\MSBuild.exe
    /target:publish
    /p:SolutionDir="C:\cc\ttr\code\Com.IT.sln"
    /p:PublishDir="C:\cc\ttr\code\deploy\"
    /p:Configuration=Debug 
```

*（为便于阅读包装）*

它不是发布它。知道为什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T12:36:21.373

当`start`获取多个参数时，第一个参数是新窗口的标题。尝试

```
start /B "" start /b C:\WINDOWS\Microsoft.NET\Framework\v3.5\MSBuild.exe ^
/target:publish ^
/p:SolutionDir="C:\cc\ttr\code\Com.IT.sln" ^
/p:PublishDir="C:\cc\ttr\code\deploy\" ^
/p:Configuration=Debug 
```

（`^`为了可读性，应该在行尾使用，但如果不把它全部放在一行中）

# c# - 在编辑其值时访问 Datagridview 单元格值

> ID：877505
> 
> 赞同：3
> 
> 时间：2009-05-18T12:31:44.160
> 
> 标签：c#, datagridview, cell

我有一个带有datagridview的表单，当用户开始为第一行的第一个单元格输入值时，也可以按f2提交该值，但是除非用户点击选项卡并转到另一个单元格，否则我无法访问单元格值

以下是我在按下 f2 时访问单元格值的代码

```
 protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
    {
        var key = new KeyEventArgs(keyData);

        ShortcutKey(this, key);

        return base.ProcessCmdKey(ref msg, keyData);
    }

    protected virtual void ShortcutKey(object sender, KeyEventArgs key)
    {
        switch (key.KeyCode)
        {
            case Keys.F2:
                MessageBox.Show(dataGridView1.SelectedCells[0].Value.ToString());
                break;
        }
    } 
```

dataGridView1.SelectedCells[0].Value 返回 null

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T13:12:19.070

不如做这样的事情。挂钩 DataGridView 的“EditingControlShowing”事件并在那里捕获 F2。一些代码：

```
public partial class Form1 : Form
{
    private DataTable table;
    public Form1()
    {
        InitializeComponent();
        this.dataGridView1.EditingControlShowing += new DataGridViewEditingControlShowingEventHandler(HandleEditingControlShowing);
        this.table = new DataTable();
        table.Columns.Add("Column");
        table.Rows.Add("Row 1");
        this.dataGridView1.DataSource = table;
    }

    private void HandleEditingControlShowing(object sender, DataGridViewEditingControlShowingEventArgs e)
    {
        var ctl = e.Control as DataGridViewTextBoxEditingControl;
        if (ctl == null)
        {
            return;
        }

        ctl.KeyDown -= ctl_KeyDown;
        ctl.KeyDown += new KeyEventHandler(ctl_KeyDown);

    }

    private void ctl_KeyDown(object sender, KeyEventArgs e)
    {
        var box = sender as TextBox;
        if (box == null)
        {
            return;
        }

        if (e.KeyCode == Keys.F2)
        {
            this.dataGridView1.EndEdit();
            MessageBox.Show(box.Text);
        }
    } 
```

}

这个想法很简单，你挂钩到 EditingControlShowing 事件。每次单元格进入编辑模式时，都会触发。很酷的是，它公开了实际的底层控件，您可以将其转换为实际的 winforms 控件，并像往常一样挂钩它的所有事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T13:23:29.687

@BFree 谢谢你的代码启发了我；）为什么不直接调用 this.dataGridView1.EndEdit(); 在 MessageBox.Show(dataGridView1.SelectedCells[0].Value.ToString());

这段代码工作得很好：

```
protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
    {
        var key = new KeyEventArgs(keyData);

        ShortcutKey(this, key);

        return base.ProcessCmdKey(ref msg, keyData);
    }

    protected virtual void ShortcutKey(object sender, KeyEventArgs key)
    {
        switch (key.KeyCode)
        {
            case Keys.F2:
dataGridView1.EndEdit();
                MessageBox.Show(dataGridView1.SelectedCells[0].Value.ToString());
                break;
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-22T17:06:16.697

你可以试试这个

```
string str = dataGridView.CurrentCell.GetEditedFormattedValue
             (dataGridView.CurrentCell.RowIndex, DataGridViewDataErrorContexts.Display)
             .ToString(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T12:55:57.230

有一个`OnKeyDown`处理程序`DataGridViewCell`：

[http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcell.onkeydown.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcell.onkeydown.aspx)

但是唯一的问题是您将不得不创建自己的自定义单元格`DataGridViewTextBoxCell`以获得预期的功能。因为没有为此处理程序公开事件。

# linux - 需要适用于 Linux 的文本到语音和语音识别工具

> ID：877508
> 
> 赞同：11
> 
> 时间：2009-05-18T12:33:00.553
> 
> 标签：linux, speech-recognition, text-to-speech

我正计划为 Linux 编写一个使用文本到语音和语音识别的程序。什么是最好的工具/库？我应该改用 Windows 来使用更好的工具吗？这些工具需要能够从控制台或 C 程序中轻松调用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T13:53:57.503

对于语音识别，有各种[狮身人面像](http://cmusphinx.sourceforge.net/html/cmusphinx.php)。不同的变体有不同的优缺点，这里有一个比较[Sphinx版本](http://cmusphinx.sourceforge.net/html/compare.php)的比较。我相信，Sphinx 4 是 Java，但其他的是 C。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-18T14:01:00.190

这在很大程度上取决于您要识别的语音。

这是 2005 年的一篇文章，解释了创建听写程序的一些困难：[http](http://www.cs.cmu.edu/~archan/personal/whyNoOpenSourceDictationDraft4.html) ://www.cs.cmu.edu/~archan/personal/whyNoOpenSourceDictationDraft4.html 。如果您愿意，[Julius](http://julius.sourceforge.jp/en_index.php)语音识别引擎似乎很有前途，但您需要添加自己的声学和语言模型。您也许可以使用[voxforge](http://www.voxforge.org/)声学模型。

如果您不尝试编写听写程序，那么您的任务要容易得多。命令程序的词汇量有限，例如“如果您想继续使用英语，请说“英语””。

[我使用 pocketsphinx 和 gstreamer 制作了一个程序，可以自动编辑](http://bitbucket.org/dholth/twitterkiller/)[TWiT](http://twit.tv)播客中出现的大多数单词“ [twitter](http://twitter.com) ”，从而获得了不错的结果。直到我使用基于播客记录的我自己的语言模型，它才起作用。语音识别器的机器转录是无用/搞笑的，但它们在查找关键字方面做得很好。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-18T13:46:57.940

对于语音识别，Linux 几乎没有。我只知道一个明显不错的选择，IBM 几年前发布但后来不再可用（有人知道这个 ViaVoice SDK 是否仍然可以从任何地方获取？）。[在wikipedia](http://en.wikipedia.org/wiki/Speech_recognition_in_Linux)上有一些关于可能选项的更多信息。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-18T13:15:17.800

我在linux下使用过[Loquendo](http://www.loquendo.com/en/)和[Festival](http://www.cstr.ed.ac.uk/projects/festival/download.html)。我认为我使用的音乐节声音很差，合成非常机器人。另一方面，Loquendo 的声音非常出色——质量非常高。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-13T13:24:38.087

对于 Debian/Ubuntu 文本转语音，还有 SVOX Pico：

```
sudo apt-get install libttspico-utils 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-18T12:35:25.243

我知道[espeak](http://espeak.sourceforge.net/)是一个非常好的用于 linux 的文本到语音转换程序（它甚至可以做不同的口音！），但我不知道任何为 UNIX 设计的语音识别系统。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-08-26T14:55:38.823

at&t fsm 工具包也非常棒 - 虽然不允许商业用途，

[http://www.research.att.com/~fsmtools/fsm/](http://www.research.att.com/~fsmtools/fsm/)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2010-07-11T22:24:35.847

这有点老了，但我几天前在 Hackaday 上看到了一个相当全面的语音识别指南：http: [//hackaday.com/2010/07/09/get-started-with-speech-recognition/](http://hackaday.com/2010/07/09/get-started-with-speech-recognition/)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2011-01-04T13:34:11.527

[http://simon-listens.org/](http://simon-listens.org/) - simon 开源语音/语音识别程序

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2011-01-04T13:40:14.523

然后是用于文本到语音的 mbrola。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2014-03-31T12:22:03.063

您是否检查了基于 HMM 的语音合成以进行文本转语音。您可以在网站[http://hts.sp.nitech.ac.jp/](http://hts.sp.nitech.ac.jp/)上找到免费演示。安装会有点繁琐。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2011-03-24T00:30:59.800

我知道，最初的问题是关于寻找合适的库，但就使用足够好的语音识别进行真正的听写而言，Linux 似乎没有任何东西（尽管我确信它会及时改变，我怀疑它会花点时间，因为我不确定有多少人感兴趣）。

目前，我正在尝试将 Dragon NaturallySpeaking 推广为 CodeWeavers 支持的产品……因此，如果您作为用户感兴趣，如果您投票会有所帮助……

[http://www.codeweavers.com/compatibility/browse/name/?app_id=8427](http://www.codeweavers.com/compatibility/browse/name/?app_id=8427)

# c# - WCF 层

> ID：877511
> 
> 赞同：2
> 
> 时间：2009-05-18T12:34:44.653
> 
> 标签：c#, wcf, architecture

我最近开始使用 WCF（是的，我知道我落后了 :-)）。问题是我必须如何构建它。

我习惯了 DAL、BL 和表示层。我正在用实体框架替换我的 DAL。

所以到目前为止我有这个

DAL（实体框架）--> BL--> 合同（数据合同消息控制服务合同行为等）--> 服务实现--> 客户端。

问题是在 bl 和将 bl 转换（没有更好的词）到数据合同的合同之间有一层。

Ex DAL.Customer（实体框架）-> BL（规则）-> 转换器（仅转换）-> Contracts.Customer

或者

DAL.Customer（实体框架）--> BL（规则）--> 转换器（调用 BL 并转换。转换器实现服务合同）--> Contracts.Customer。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T12:39:46.717

应该有一个薄的“层”，仅仅是因为你并不真的需要 BL 层来理解你的合约，而且你也不想将你的 BL 对象作为合约暴露给世界其他地方。

当然，您*可以*这样做。您可以开发作为简单数据传输对象的数据合约。这些将仅包含数据而不包含任何行为，并且会暴露您希望世界看到的数据部分。您的 BL 可以将自身限制为该模型，也可以从它继承以添加特定于 BL 的功能。

或者，只需拥有一个 BL 版本的现实和一个“契约”版本的现实，然后在它们之间进行转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T21:45:07.867

很多时候，您会看到 BL 和合同类型之间的相似之处。您可以使用一些快捷方式来帮助您使用出色的[AutoMapper](http://www.codeplex.com/AutoMapper "自动映射器")在类型之间进行转换。这些工具可以帮助该层保持“薄”。

# embedded - 在嵌入式系统中允许安全软件升级的技术是什么

> ID：877513
> 
> 赞同：9
> 
> 时间：2009-05-18T12:35:38.847
> 
> 标签：embedded, reliability

为嵌入式设备升级软件通常有可能使设备“变砖”，例如，如果在将软件写入 FLASH 的过程中发生电源故障。两个问题：

1.  有哪些实施升级机制的最佳实践，以尽量减少设备“变砖”的可能性？
2.  有哪些最佳实践可以使升级过程安全可靠，以便在将软件安装到 FLASH 时发生电源故障等事件可以从中恢复？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-18T12:51:00.657

这完全取决于应用程序的重要性。两种基本方法（备份和引导加载程序）有时也会结合使用。

许多系统都有一个只读引导加载程序（如[redboot](http://sourceware.org/redboot/)），然后是两组闪存（通常在同一芯片上）。然后引导加载程序有一个标志来选择从哪个银行引导。然后标志将根据升级（失败或成功）等事件发生变化。

因此，在升级时，正在运行的版本会将新负载复制到备份库中，检查校验和，切换启动标志，然后重新启动设备。设备在新的银行上重新启动，并带有新的负载。重新启动后，新负载可以将自身复制到备份库中。

通常还有一个带有硬件复位的看门狗定时器。这样，如果固件变得异常，它无法启动看门狗，硬件重置将重新启动设备，引导加载程序将寻找正常的负载。

Open Mesh 项目就是这种方法的一个很好的例子。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T13:08:35.427

进一步来说...

将替换映像下载到内存区域，而不会覆盖任何当前程序空间。等到下载完成，然后计算和比较 CRC。

如果空间确实是个问题，您可以执行“默认备份”又名“恢复模式”之类的事情，但不破坏性地执行此操作要巧妙得多。

如果你真的很聪明……你可以对 FLASH 进行一次写入更新，以指导设备从新的代码位置启动。这将在两个完全独立的代码段之间进行 ping/pong。这是您可以执行此操作的最安全方法：

*   总是有一个不可更新的恢复引导加载程序（Nano-loader），如果一切都出错了，它可以被通知以某种方式加载新代码。
*   两个独立的程序空间
*   每个程序空间都有一个“CRC”字段、一个“烧录编号”（高于其他代码页的编号）和一个“无效”字（所有 F - 不需要擦除即可更新“无效”标记）
*   下载完成后，验证 CRC。如果好的话，在旧版本的程序空间上刻录“无效”标记。
*   Nano-loader 检查“无效”标记以了解引导到哪个。如果它们都有效，请进行 CRC 检查。如果它们仍然有效，则采用较高的烧伤编号条目

哦，当人们说校验和时......不要“检查总和”......做一个正确的CRC。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T12:38:07.797

**内部闪存上的校验和**，如果 CRC/校验和不起作用，则使用默认备份。这样，如果设备得到不正确的校验和，则它知道升级不完整，并且可以重置为存储在另一台设备上的默认/以前的固件。

这需要一些预引导（可能在引导加载程序中）来检查校验和。一段静态代码。

**编辑**：进一步评论其他地方。如果您想检查错误的固件，而不仅仅是损坏的固件，您的校验和/校验数据也可以封装版本信息（以及对该标头的检查）我认为 Linksys 路由器会这样做，这可能会使它们在使用自定义固件重新刷新时出现问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-18T12:43:14.543

校验和很好，但只能让您免于刷新损坏的数据。如果您在具有有效校验和但针对不同产品型号的图像文件中闪存怎么办。在紧急损坏的情况下可以访问的只读默认引导加载程序是我见过的最好的东西。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-18T13:10:31.400

1.  无论如何都要在内存中保留一个只读引导加载程序
2.  在引导加载程序中，允许从可用输入源（SD 卡、RS232 等）重新加载新程序存储器的故障保护方法（例如，在重启期间按住按钮 X）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-18T19:13:29.683

要回答这两个问题，并且无论任何特定的硬件资源如何：

*   确保在运行任何应用程序代码之前（在启动时或下载完成后），引导加载程序对应用程序进行 CRC 检查。如果它无效，则引导加载程序不会运行代码。

*   如果引导加载程序决定它不能运行应用程序代码，它必须能够向用户发出信号，并重新开始下载。

如果处理器没有足够的闪存来存储备份应用程序，或者在完成下载之前没有足够的 RAM 来存储新的应用程序，那么这些显然变得更加重要。

在这些情况下，下载的文件有一个小标题是有意义的，它允许引导加载程序确定文件是否适合系统。该标头也可以具有 CRC。如果标头对该系统有效，并且 CRC 正确，则引导加载程序可以擦除闪存（但不是自身！），并继续下载。如果不是，它会在不触及现有应用程序代码的情况下中止。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-20T20:08:51.220

根据我的经验，这取决于你的成本点，如果你能负担得起设备上两倍的代码/数据空间，并且可以重新启动，它很简单，将新版本存储在你所有额外的空间中，做正确的事对新图像进行校验和检查，我还建议对新固件映像进行更深入的检查，因为如果不这样做，它可能会被欺骗，例如某种加密密钥可以保证新图像的来源。您也可以使用外部存储器来执行此操作，例如在一个使用 PIC 的项目中，我有一个用于新固件映像的外部 EEPROM 和一个标志，如果在启动时设置该标志，它将从 EEPROM 加载一个新图像。

如果你不是那么幸运，即你买不起那个空间，那么生活会变得更加有趣，并且可能没有保证的方法可以完全避免更新期间失败的机会。在所有情况下，引导加载程序都应该在一个写保护的内存中，如果你能负担得起空间，应该有一些基本形式的外部连接，我已经完成了引导加载程序中带有非常简单的 USB 驱动程序的系统和带有非常简单的 UDP 的系统只有网络堆栈。如果更新期间出现故障，这两种方法都可以让您至少对设备有一个新的想象。在这些情况下，我强烈建议将引导加载程序放在只读内存区域中，您将失去更新它的能力，但乱线更新也不会让您拥有一个完全变砖的设备。

最后一种可能性是系统需要在运行时更新其代码的某些部分……这真的很棘手，通常需要对内存中函数的位置进行复杂的控制，并在内存布局中提前进行重大规划才能实现。它不是很有趣，但它是可行的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-12-01T05:43:38.737

我知道这个问题已经得到解答，但有些人需要更高的可靠性。如果你的项目真的是关键任务，你可以走这条路。

基本计划是始终有一个不会失败的备份计划。

1.  有 PIC 或其他可以对真实处理器的闪存进行编程的微控制器。你让它在一个数据块上使用校验和，并通过串口、usb甚至以太网接口（别笑这并不难）这个设备不能在现场重新编程（或者甚至永远）所以你总是有备用计划。PIC 可以通过 PPP/SLIP 或 ehternet 运行 Web 服务器，因此与它的接口并不一定很尴尬。谷歌 TCP 精益。尽量不要偷笑。（现场 适合工作）*。*将编程端口放在其他地方。不保证安全。

2.  该程序在主 CPU 上运行并运行它自己的引导加载程序。您拥有三个程序：引导加载程序、维护程序和真实程序。

这允许升级引导引导进程以及程序。您可以在一些额外的闪存中运行备份引导加载程序，使用看门狗重置您并在不引导时使用备份。

因此，您拥有可升级的嵌入式应用程序、可升级的引导加载程序和可升级的维护模式。以及不会失败的备份模式。

希望没有人需要发现这很有用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-18T14:57:24.570

在一些实验室（而不是消费类）设备上，我见过用编程器电路构建的电路板。在最坏的情况下，您可以打开机箱，插入编程器并重新加载默认软件——或将其发回让您执行相同操作。'当然，这需要真金白银。

我的一些项目中使用的一些定制板具有可替换的 ROM。这更便宜，但不太方便。

# c# - 在列表框中设置所选项目而不循环

> ID：877519
> 
> 赞同：8
> 
> 时间：2009-05-18T12:37:49.017
> 
> 标签：c#, listbox, asp.net-2.0

我有一个绑定到 DataTable 的多选列表框。DataTable 包含 2 列描述和值。

这是列表框填充代码：

```
DataTable copytable = null;
                copytable = GlobalTable.Copy(); // GlobalTable is a DataTable
                copytable.Rows[0][0] = "--ALL--";
                copytable.Rows[0][1] = "--ALL--";

                breakTypeList.DataSource = copytable;
                this.breakTypeList.DisplayMember = copytable.Columns[0].ColumnName; // description
                this.breakTypeList.ValueMember = copytable.Columns[1].ColumnName; // value
                this.breakTypeList.SelectedIndex = -1; 
```

我将 description 设置为 DisplayMember，将 value 设置为 ListBox 的 ValueMember。现在根据传递的值，我需要在 ListBox 中设置所选项目。

这是我的代码：

```
ListBox lb = c as ListBox;
lb.SelectedValue = valuePassedByUser; 
```

这是行不通的。因此，我不得不求助于下面的代码（我循环遍历列表框中的所有项目）

```
for (int i = 0; i < lb.Items.Count; i++)
            {
                DataRowView dr = lb.Items[i] as DataRowView;
                if (dr["value"].ToString() == valuePassedByUser)
                {
                    lb.SelectedIndices.Add(i);
                    break;
                }
            } 
```

我想知道我的代码中缺少什么/错误。为什么是 lb.SelectedValue = valuePassedByUser; 选择不正确的项目？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-07-14T04:14:44.383

好的......这是我昨天才意识到的难以理解的答案。虽然我没有在我的问题中提到一件重要的事情，但这是我的错误，因为我觉得它与手头的问题无关：

数据表中的数据未排序。因此，我**将列表框的 Sorted 属性设置为 true**。后来我意识到当列表框甚至组合框的排序属性设置为 true 时，值成员没有正确设置。所以如果我写：

```
lb.SelectedValue = valuePassedByUser;
```

它将其他一些项目设置为选中，而不是设置其值为 valuePassedByUser 的项目。简而言之，它与索引混淆。

例如，如果我的初始数据是：

```
Index   ValueMember DisplayMember
1          A            Apple
2          M            Mango
3          O            Orange
4          B            Banana 
```

我设置了 sorted = true。那么列表框项目是：

```
Index   ValueMember DisplayMember
1          A            Apple
2          B            Banana
3          M            Mango
4          O            Orange 
```

现在，如果我想将 Banana 设置为选中，我运行 stmt：

```
lb.SelectedValue = "B";
```

但是，它没有将 Banana 设置为选中，而是将 Orange 设置为选中。为什么？因为如果列表没有被排序，Banana 的索引会是 4。所以即使 Banana 的排序索引是 2 之后，它也会将索引 4 设置为选中，从而选择 Orange 而不是 Banana。

因此，对于排序的列表框，我使用以下代码来设置所选项目：

```
private void SetSelectedBreakType(ListBox lb, string value)
{
    for (int i = 0; i < lb.Items.Count; i++)
    {
        DataRowView dr = lb.Items[i] as DataRowView;
        if (dr["value"].ToString() == value)
        {
            lb.SelectedIndices.Add(i);
            break;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T13:42:46.683

我认为您能够选择多个项目的唯一方法是使用 foreach 循环。SelectedValue 属性似乎只返回 1 个项目。如果您想选择多于 1 项，则必须使用：

```
var tempListBox = c As ListBox;
if (tempListBox != null)
     (tempListBox.SelectedItems.Add(tempListBox.Items[tempListBox.FindStringExact(fieldValue)]); 
```

FindStringExact 也不搜索 Value 字段，它只查看显示的文本。此外，为了减少代码，可能需要将新变量转换为列表框，这样您就不会继续将 C 转换为列表框。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T13:12:44.140

试试这个：-

```
 var listBox = c as ListBox;
    var item = listBox.Items.FindByValue(fieldValue);
    if (item != null)
     listBox.SelectedValue = fieldValue; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-02T07:38:29.610

您可以像这样使用“FindByValue”：

```
ListBox.SelectedIndex = ListBox.Items.IndexOf(ListBox.Items.FindByValue(fieldValue)) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-23T06:22:17.567

```
this.Character.SetSelected(this.Character.Items.IndexOf(this.textBox1.Text),true); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-17T01:31:46.143

这是我使用winforms，DotNet 4.6解决它的方法

```
listBox1.SelectedIndex = listBox1.FindString(stringInList); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-08-17T07:10:28.193

如果您不想循环选择项目，则从`listBox_SelectedIndexChanged`事件中检索列表框的选定值并将该值添加到全局数组中。然后通过访问该数组，您将获得所需的选定项目值，`itemlist`而无需任何循环。

# c++ - 错误：在非类类型的“..”中请求成员“..”

> ID：877523
> 
> 赞同：512
> 
> 时间：2009-05-18T12:38:29.840
> 
> 标签：c++

我有一个有两个构造函数的类，一个不带参数，另一个带一个参数。

使用带有一个参数的构造函数创建对象按预期工作。但是，如果我使用不带参数的构造函数创建对象，则会出现错误。

例如，如果我编译这段代码（使用 g++ 4.0.1）......

```
class Foo
{
  public:
    Foo() {};
    Foo(int a) {};
    void bar() {};
};

int main()
{
  // this works...
  Foo foo1(1);
  foo1.bar();

  // this does not...
  Foo foo2();
  foo2.bar();

  return 0;
} 
```

...我收到以下错误：

```
nonclass.cpp: In function ‘int main(int, const char**)’:
nonclass.cpp:17: error: request for member ‘bar’ in ‘foo2’, which is of non-class type ‘Foo ()()’ 
```

为什么会这样，我该如何让它发挥作用？

* * *

## 回答 #1

> 赞同：765
> 
> 时间：2009-05-18T12:41:31.333

```
Foo foo2(); 
```

改成

```
Foo foo2; 
```

您收到错误是因为编译器认为

```
Foo foo2() 
```

从函数声明开始，名称为“foo2”，返回类型为“Foo”。

但在那种情况下，如果我们改成`Foo foo2`，编译器可能会显示错误 `" call of overloaded ‘Foo()’ is ambiguous"`。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2013-03-05T09:30:12.797

只是为了记录..

它实际上不是您的代码的解决方案，但是当我错误地访问指向的类实例的方法时，我收到了相同的错误消息`myPointerToClass`，例如

```
MyClass* myPointerToClass = new MyClass();
myPointerToClass.aMethodOfThatClass(); 
```

在哪里

```
myPointerToClass->aMethodOfThatClass(); 
```

显然是正确的。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2017-08-01T06:43:58.007

当您不打算使用参数化构造函数时，不需要括号来实例化类对象。

只需使用 **Foo foo2;**

它会起作用的。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-02-11T21:56:13.897

添加到知识库中，我得到了同样的错误

```
if(class_iter->num == *int_iter) 
```

即使 IDE 为我提供了 class_iter 的正确成员。显然，问题在于`"anything"::iterator`没有调用成员`num`，所以我需要取消引用它。这不是这样工作的：

```
if(*class_iter->num == *int_iter) 
```

...显然。我最终用这个解决了它：

```
if((*class_iter)->num == *int_iter) 
```

我希望这可以帮助像我一样遇到这个问题的人。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-03-09T16:18:53.243

我遇到了类似的错误，似乎编译器误解了对没有参数的构造函数的调用。我通过从变量声明中删除括号使其工作，在您的代码中是这样的：

```
class Foo
{
  public:
    Foo() {};
    Foo(int a) {};
    void bar() {};
};

int main()
{
  // this works...
  Foo foo1(1);
  foo1.bar();

  // this does not...
  Foo foo2; // Without "()" 
  foo2.bar();

  return 0;
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-09-07T11:01:36.370

我遇到了一个案例，我收到了该错误消息并且有

```
Foo foo(Bar()); 
```

并且基本上试图将临时 Bar 对象传递给 Foo 构造函数。原来编译器正在将其翻译为

```
Foo foo(Bar(*)()); 
```

也就是说，一个名为 foo 的函数声明，它返回一个 Foo ，它接受一个参数——一个函数指针，返回一个带 0 个参数的 Bar 。当像这样传入临时对象时，最好使用`Bar{}`而不是`Bar()`消除歧义。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-02-08T16:49:32.333

如果你想声明一个没有参数的新物质（知道对象有默认参数）不要写

```
 type substance1(); 
```

但

```
 type substance; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-08-11T21:58:40.417

这个错误当然是一个极端情况，但我在尝试重载 assignment 时收到了不同的情况`operator=`。IMO 有点神秘（来自 g++ 8.1.1）。

```
#include <cstdint>

enum DataType
{
  DT_INT32,
  DT_FLOAT
};

struct PrimitiveData
{
  union MyData
  {
    int32_t i;
    float f;
  } data;

  enum DataType dt;

  template<typename T>
  void operator=(T data)
  {
    switch(dt)
    {
      case DT_INT32:
      {
        data.i = data;
        break;
      }
      case DT_FLOAT:
      {
        data.f = data;
        break;
      }
      default:
      {
        break;
      }
    }
  }
};

int main()
{
  struct PrimitiveData pd;
  pd.dt = DT_FLOAT;
  pd = 3.4f;

  return 0;
} 
```

我收到 2 个“相同”错误

```
error: request for member ‘i’ [and 'f'] in ‘data’, which is of non-class type ‘float’ 
```

（等效的错误`clang`是 `error: member reference base type 'float' is not a structure or union`：）

为线`data.i = data;`和`data.f = data;`。原来编译器混淆了局部变量名 'data' 和我的成员变量`data`。当我将其更改为`void operator=(T newData)`and`data.i = newData;`时`data.f = newData;`，错误消失了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-05-05T18:05:50.220

@MykolaGolubyev 已经给出了精彩的解释。我一直在寻找一种解决方案来做这样的事情，`MyClass obj ( MyAnotherClass() )`但编译器将其解释为函数声明。

C++11 有[括号初始化列表](https://en.cppreference.com/w/cpp/language/list_initialization)。使用它我们可以做这样的事情

```
Temp t{String()}; 
```

然而，这：

```
Temp t(String()); 
```

抛出编译错误，因为它认为`t`是 type `Temp(String (*)())`。

```
#include <iostream>

class String {
public:
    String(const char* str): ptr(str)
    {
        std::cout << "Constructor: " << str << std::endl;
    }
    String(void): ptr(nullptr)
    {
        std::cout << "Constructor" << std::endl;
    }
    virtual ~String(void)
    {
        std::cout << "Destructor" << std::endl;
    }

private:
    const char *ptr;
};

class Temp {
public:
    Temp(String in): str(in)
    {
        std::cout << "Temp Constructor" << std::endl;
    }

    Temp(): str(String("hello"))
    {
        std::cout << "Temp Constructor: 2" << std::endl;
    }
    virtual ~Temp(void)
    {
        std::cout << "Temp Destructor" << std::endl;
    }

    virtual String get_str()
    {
        return str;
    }

private:
    String str;
};

int main(void)
{
    Temp t{String()}; // Compiles Success!
    // Temp t(String()); // Doesn't compile. Considers "t" as of type: Temp(String (*)())
    t.get_str(); // dummy statement just to check if we are able to access the member
    return 0;
} 
```

# algorithm - 计算给定方位和距离的坐标

> ID：877524
> 
> 赞同：6
> 
> 时间：2009-05-18T12:38:49.997
> 
> 标签：algorithm, gps, coordinates, bearing

我在实现[此处](http://williams.best.vwh.net/avform.htm#LL)描述的功能时遇到问题。

这是我的 Java 实现：

```
private static double[] pointRadialDistance(double lat1, double lon1, 
        double radianBearing, double radialDistance) {
     double lat = Math.asin(Math.sin(lat1)*Math.cos(radialDistance)+Math.cos(lat1)
             *Math.sin(radialDistance)*Math.cos(radianBearing));
     double lon;
     if(Math.cos(lat) == 0) {  // Endpoint a pole
        lon=lon1;      
     }
     else {
        lon = ((lon1-Math.asin(Math.sin(radianBearing)*Math.sin(radialDistance)/Math.cos(lat))
                +Math.PI) % (2*Math.PI)) - Math.PI;
     }
    return (new double[]{lat, lon});
} 
```

在调用函数之前，我将方位角转换为弧度并将距离（km）转换为弧度距离 - 所以这不是问题。

但是，当我输入坐标时，例如： lat = 49.25705; lon = -123.140259; 方位角225（西南），距离1公里

我得到这个返回：纬度：-1.0085434360125864 经度：-3.7595299668539504

它显然不正确，谁能看到我做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-18T20:06:43.353

似乎这些是您的代码中的问题：

1.  在调用函数之前，您需要将`lat1`和转换为弧度。`lon1`
2.  您可能缩放`radialDistance`不正确。
3.  测试浮点数是否相等是危险的。在精确算术之后相等的两个数字在浮点算术之后可能不完全相等。因此`abs(x-y) < threshold`比`x == y`测试两个浮点数`x`和`y`相等性更安全。
4.  我认为您想将弧度转换为度数`lat`。`lon`

这是我在 Python 中的代码实现：

```
#!/usr/bin/env python

from math import asin,cos,pi,sin

rEarth = 6371.01 # Earth's average radius in km
epsilon = 0.000001 # threshold for floating-point equality

def deg2rad(angle):
    return angle*pi/180

def rad2deg(angle):
    return angle*180/pi

def pointRadialDistance(lat1, lon1, bearing, distance):
    """
    Return final coordinates (lat2,lon2) [in degrees] given initial coordinates
    (lat1,lon1) [in degrees] and a bearing [in degrees] and distance [in km]
    """
    rlat1 = deg2rad(lat1)
    rlon1 = deg2rad(lon1)
    rbearing = deg2rad(bearing)
    rdistance = distance / rEarth # normalize linear distance to radian angle

    rlat = asin( sin(rlat1) * cos(rdistance) + cos(rlat1) * sin(rdistance) * cos(rbearing) )

    if cos(rlat) == 0 or abs(cos(rlat)) < epsilon: # Endpoint a pole
        rlon=rlon1
    else:
        rlon = ( (rlon1 - asin( sin(rbearing)* sin(rdistance) / cos(rlat) ) + pi ) % (2*pi) ) - pi

    lat = rad2deg(rlat)
    lon = rad2deg(rlon)
    return (lat, lon)

def main():
    print "lat1 \t lon1 \t\t bear \t dist \t\t lat2 \t\t lon2"
    testcases = []
    testcases.append((0,0,0,1))
    testcases.append((0,0,90,1))
    testcases.append((0,0,0,100))
    testcases.append((0,0,90,100))
    testcases.append((49.25705,-123.140259,225,1))
    testcases.append((49.25705,-123.140259,225,100))
    testcases.append((49.25705,-123.140259,225,1000))
    for lat1, lon1, bear, dist in testcases:
        (lat,lon) = pointRadialDistance(lat1,lon1,bear,dist)
        print "%6.2f \t %6.2f \t %4.1f \t %6.1f \t %6.2f \t %6.2f" % (lat1,lon1,bear,dist,lat,lon)

if __name__ == "__main__":
    main() 
```

这是输出：

```
lat1     lon1        bear    dist        lat2        lon2
  0.00     0.00       0.0       1.0        0.01        0.00
  0.00     0.00      90.0       1.0        0.00       -0.01
  0.00     0.00       0.0     100.0        0.90        0.00
  0.00     0.00      90.0     100.0        0.00       -0.90
 49.26   -123.14     225.0      1.0       49.25      -123.13
 49.26   -123.14     225.0    100.0       48.62      -122.18
 49.26   -123.14     225.0   1000.0       42.55      -114.51 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-10-18T16:58:23.620

我认为消息 5 中提供的算法存在问题。

它有效，但仅适用于纬度，对于经度，由于符号而存在问题。

数据不言自明：

> 49.26 -123.14 225.0 1.0 49.25 -123.13

如果你从**-123.14°**开始向西走，你应该在西边有一些东西。在这里，我们回到东部（-123.13）！

该公式应包括某处：

> degreeBearing = ((360-degreeBearing)%360)

弧度转换前。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T12:44:08.440

从根本上说，您的问题似乎是您将纬度、经度和方位作为度数而不是弧度传递。试着确保你总是将弧度传递给你的函数，看看你得到了什么。

PS：请参阅[此处](https://stackoverflow.com/questions/365826/calculate-distance-between-2-gps-coordinates)和[此处](https://stackoverflow.com/questions/695065/geoalgorithm-for-finding-coordinates-of-point-from-a-known-location-by-distance-a)讨论的类似问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-27T10:28:44.473

当我实现这个时，我得到的纬度是正确的，但经度是错误的。例如起点：36.9460678N 9.434807E，方位角 45.03334，距离 15.0083313km 结果是 37.0412865N 9.315302E 这比我的起点更西，而不是更东。事实上，就好像方位角是 315.03334 度。

更多网络搜索使我找到：[http](http://www.movable-type.co.uk/scripts/latlong.html) ://www.movable-type.co.uk/scripts/latlong.html 经度代码如下所示（在 C# 中，所有内容均以弧度表示）

```
 if ((Math.Cos(rLat2) == 0) || (Math.Abs(Math.Cos(rLat2)) < EPSILON))
        {
            rLon2 = rLon1;
        }
        else
        {
            rLon2 = rLon1 + Math.Atan2(Math.Sin(rBearing) * Math.Sin(rDistance) * Math.Cos(rLat1), Math.Cos(rDistance) - Math.Sin(rLat1) * Math.Sin(rLat2));
        } 
```

这对我来说似乎很好。希望它有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-01T07:40:27.247

感谢您的python代码我尝试在我的用例中设置它，我试图在距第一个点一定距离处找到其他两个点之间的纬度，因此它与您的代码非常相似，我的轴承是动态计算的

起点(lat1) lon1/lat1 = 55.625541,-21.142463

终点 (lat2) lon2/lat2 = 55.625792,-22.142248

我的结果应该是 lon3/lat3 这两者之间的一个点，不幸的是我得到 lon3/lat3 = 0.0267695450609,0.0223553243666

我认为这可能是 lat lon 的差异，但是当我添加或替换它时，它并不好

任何建议都会很棒谢谢

这是我的实现

距离 = 0.001 ε = 0.000001

### 动态计算轴承

```
y = math.sin(distance) * math.cos(lat2);
x = math.cos(lat1)*math.sin(lat2) - math.sin(lat1)*math.cos(lat2)*math.cos(distance);
bearing = math.atan2(y, x) 
```

### 动态计算 lat3 lon3

```
rlat1 = (lat1 * 180) / math.pi
rlon1 = (lon1 * 180) / math.pi
rbearing = (bearing * 180) / math.pi
rdistance = distance / R # normalize linear distance to radian angle

rlat = math.asin( math.sin(rlat1) * math.cos(rdistance) + math.cos(rlat1) * math.sin(rdistance) * math.cos(rbearing) )
if math.cos(rlat) == 0 or abs(math.cos(rlat)) < epsilon: # Endpoint a pole
      rlon=rlon1
else:
    rlon = ( (rlon1 + math.asin( math.sin(rbearing)* math.sin(rdistance) / math.cos(rlat) ) + math.pi ) % (2*math.pi) ) - math.pi

lat3 = (rlat * math.pi)/ 180
lon3 = (rlon * math.pi)/ 180 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-05-07T13:41:29.910

一切都按预期工作，但问题是你的数学假设地球是一个球体，而实际上它接近一个椭球体。

快速搜索一下您最喜欢的“Vincenty Formula”搜索引擎有望证明是有用的。

# silverlight - AWS 和 Silverlight 是否有任何来自该领域的注意事项

> ID：877526
> 
> 赞同：1
> 
> 时间：2009-05-18T12:39:18.730
> 
> 标签：silverlight, amazon-s3, amazon-web-services, amazon-simpledb

我有兴趣了解 AWS（亚马逊网络服务）及其作为 Siverlight 应用程序后端的可行性。最初我对使用 S3 和 SimpleDB 来存储和管理媒体库很感兴趣。

在我开始之前，我试图确定难度的峰值。是身份验证、rest vs soap、跨域策略，还是完全不同的东西。

与 AWS 合作时您的痛点是什么——尤其是但不仅来自 Silverlight2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T14:11:14.903

有必要代理您的 SimpleDB 调用，因为 AWS 出于安全原因拒绝在 sdb.amazonaws.com 上发布跨域策略。将您的 AWS 密钥公开加载到用户的浏览器中是不安全的。如果您将它托管在 EC2 上，那么您的实例代理 SimpleDB 调用应该不是问题。

使用 REST 或 SOAP，哪个更容易。你不会发现那里有任何痛苦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T12:58:50.313

我唯一真正的痛点是 Amazon EC2 服务器都在 NAT 之后。

就 Web 应用程序而言，使用 NAT 并不是真正的问题，事实上动态分配公共弹性 IP 的能力是一个好处。在我的情况下，我的应用程序是一个基于 SIP 的应用程序，需要将公共 IP 地址放在 SIP 标头中，而 NAT 处理起来很烦人。

我在 Amazon EC2 服务器上的 IIS 实例上托管了一个 silverlight 应用程序，它工作正常，没有问题。我确实使用了跨域策略文件和自定义身份验证机制，并且在这两种情况下它都与普通的 Windows 服务器相同。

我没有使用过 SimpleDB，因此无法对其发表评论，但如果您正在寻找托管媒体库，我怀疑 Elastic Block Service (EBS) 就是您所追求的。我有时在让我的 Windows 服务器识别 EBS 驱动器时遇到一些困难，并且不得不使用 Windows 磁盘管理器来识别驱动器，但一旦完成，它就可以完美运行，并且与任何普通 Windows 驱动器相同，只是你可以扩展它高达 tera 或 pera 字节。

# linux - ubuntu 服务器的正常磁盘读/写值

> ID：877527
> 
> 赞同：-1
> 
> 时间：2009-05-18T12:39:28.730
> 
> 标签：linux, hardware, production

您将如何确定一个最大值以对 ubuntu/linux 服务器的 I/O 活动设置警报，该服务器托管多达 4 个运行 apache、mysql 和多达 4 个 tomcats 的站点？或者一般来说（如果有的话）在具有 7.2K SATA HDD 的生产服务器中每秒 I/O 读/写的合适操作范围是多少？

我想了解的是如果每秒读/写达到峰值对磁盘的影响。我应该在磁盘/驱动器的规格中寻找什么来确定这一点？

如您所见，我“显然”感到困惑。任何帮助/方向将不胜感激......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T12:58:03.920

> 您将如何确定一个最大值以对 ubuntu/linux 服务器的 I/O 活动设置警报，该服务器托管多达 4 个运行 apache、mysql 和多达 4 个 tomcats 的站点？

您警告的预期问题的价值比您必须注意警报的代价更昂贵。

那是什么号码？这取决于很多事情，包括：

你想避免哪些问题？

你担心性能吗？如果是这样，您是否更担心延迟或吞吐量？交互式和批处理作业性能之间的权衡如何？

您是否担心磨损和媒体的使用寿命？您是否担心必须多久恢复一次备份？

你担心磁盘的价格吗？更好的磁盘将为您的运营带来多少价值？

可以推迟多少写入？通过缓存可以防止多少阅读？在独立性（ACID 中的 I）方面，你能有多松懈？

如果您*真的*想要适合您的情况的最佳磁盘，这些是您可能想问自己的一些问题。如果我处于你的情况，我可能会从低到中低价格范围内随机选择一个磁盘，然后看看它是如何工作的。然后，您将有经验可以学习，因此您知道下次该做些什么（如果有的话），而且不会花费太多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T09:45:50.503

当心 linux，您将在内存中缓存一些数据（这很酷，因为它速度很快，但这会破坏您的基准测试）。

恕我直言，您不应该测试硬盘吞吐量，就好像数据会在物理磁盘上紧密累积一样，您会有更多，数据碎片也会影响结果......使用其他一些指标。

在顶部，您有一个“0.0%wa”统计数据，它告诉您处理器在等待数据上花费了多少。如果这个值很高，你就有麻烦了（你可以做一个 RAID 阵列来增加吞吐量）。我不知道 top 是如何得到这个信息的，但我敢打赌你也能得到它。

# javascript - JavaScript 范围滑块/双滑块存在而不使用框架

> ID：877530
> 
> 赞同：8
> 
> 时间：2009-05-18T12:40:09.883
> 
> 标签：javascript, controls, dhtml, no-framework

我正在寻找一个 JavaScript 控件，它是一个 Range Slider（双旋钮），它：

*   不使用现有的 JS 框架（例如 dojo、jquery 等）——*除非您可以滚动/创建自己的子框架，在其中我可以只编译我需要的组件。*
*   适用于所有主要浏览器

下面是一个 Range Slider 示例，但当然这使用了 JQuery - 所以这不是一个选项，因为即使我构建的 JQuery 只包含我需要的组件（JQuery UI 核心 + Slider），它也是 140kb MINIFIED：

[http://jqueryui.com/demos/slider/#range](http://jqueryui.com/demos/slider/#range)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T12:43:06.227

jQuery UI 有一个不错的：

[http://jqueryui.com/demos/slider/](http://jqueryui.com/demos/slider/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T21:17:35.613

YUI 3（目前处于预览版）只引入了执行您所要求的绝对最少的代码量。他们的基本滑块示例（[http://yuilibrary.com/yui/docs/slider/slider-basic.html](http://yuilibrary.com/yui/docs/slider/slider-basic.html)）只引入了 24k 的 JavaScript 和不到 1k 的 CSS。它很光滑。

披露：我为雅虎工作！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T15:11:34.273

[使用来自http://www.walterzorn.com/dragdrop/dragdrop_e.htm#addons](http://www.walterzorn.com/dragdrop/dragdrop_e.htm#addons)的滑块代码。它是一个单一的句柄，但底层的 drag-drop.js 非常灵活。您只需要添加自己的第二个滑块，并根据另一个条的位置以编程方式锁定每个条的最小-最大范围。您正在查看 1 12kb (lgpl'ed) 脚本包括和大约 10-20 行代码来实现这一点。

# git - git：对 GNU/Linux 发行版进行版本控制

> ID：877542
> 
> 赞同：1
> 
> 时间：2009-05-18T12:42:14.920
> 
> 标签：git

我正在开发 GNU/Linux 实时发行版的自定义版本。我需要添加/删除包，编辑脚本...我在一个未压缩的文件系统（squashfs-root/）中工作，该文件系统用作 chroot 的根。我想知道哪种方式是管理我工作的最佳方式。我应该创建一个 git repo 并添加 squashfs-root/ 吗？我主要担心会弄乱 chroot env 并且无法回到工作版本。谢谢，哈门

**更新**：我会尝试 rdiff-backup。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T12:56:24.140

git（和其他源代码控制套件）的问题在于它不能很好地处理权限和特殊文件。

[etckeeper](http://kitenet.net/~joey/code/etckeeper/)是 git 之上的一组脚本来管理`/etc`。这已经可以为您提供很大的安全性。

最后，您说您正在从`chroot()`. 这将允许您从 chroot 外部轻松备份，例如使用[rdiff-backup](http://www.gnu.org/savannah-checkouts/non-gnu/rdiff-backup/)，它创建了很好的紧凑的磁盘表示，同时仍然允许您直接浏览最新版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T12:46:44.490

自动化您所做的一切，只需对用于创建发行版的脚本进行版本控制。这样你就可以随时重新创建你的发行版，以防你搞砸了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T12:54:53.350

git 可以解决这个问题，它作为 TimeMachine/System Restore 很有用。我将它用于我的 /etc 目录。如果它足够小，你可以将它推送到 github，并将其用作备份和分发机制。

# c# - 如何在 C# Designer.cs 代码中使用常量字符串？

> ID：877544
> 
> 赞同：2
> 
> 时间：2009-05-18T12:42:44.137
> 
> 标签：c#, constants, designer

如何在 .designer.cs 文件中引用常量字符串？

一个直接的答案是在我的 .cs 文件中创建一个私有字符串变量，然后编辑 Designer.cs 文件以使用此变量而不是硬编码字符串。但是设计者不喜欢这样抛出错误。我理解为什么这行不通，但我不确定最好的选择是什么。

如果我的每个 UI 控件都只有文本作为占位符，那么我只需要在运行时覆盖所有文本属性吗？这样我就失去了在设计器中看到一切的好处。

我只是想弄清楚当未来事情发生变化时如何将干扰降到最低。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T12:59:04.527

这些`*.designer.*`文件由 Visual Studio 生成。除非您真的必须这样做，否则您根本不想手动修改它们，因为 Visual Studio 有时可能会*重新*生成它们并删除您的更改。

您真正需要做的是将常量字符串视为您希望表单设计器可以使用的资源，以便在生成代码时使用该资源。

在 Visual Studio 中有几种方法可以完成此操作。最简单的可能是通过控件的数据绑定。为了演示，将标签控件放在窗体上并查看控件的属性。如果按名称对属性进行排序，则列表顶部将有两个属性用括号括起来： `ApplicationSettings`和`DataBindings`。如果你把它们拉下来，你会看到它们都有绑定到`Text`标签属性的选项。使用这些，您可以将“常量字符串”放在应用程序的设置文件中并通过`ApplicationSettings`属性绑定它或在任何数据源中并通过`DataBindings`属性绑定它。然后表单设计器将为您生成适当的代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T12:44:29.267

我并不完全清楚你想要实现什么，但通常如果你想避免字符串都被硬编码到设计器 .cs 文件中，你可以使用一个资源文件，在启动时会从该文件中加载字符串。

如果您将表单的“可本地化”属性设置为“真”，我相信一切都会自动出现在资源中。另一方面，我远非 Windows 窗体方面的专家，所以在你完成所有这些工作之前，请多加注意 :)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T12:46:39.857

你的第二种方法是最好的选择。因为你不能假设设计师总是会保留你的变化，而且很多时候它只会把它们吹走。您将希望在`Page_Init`事件方法中进行控制更改。这可能允许您的更改显示在设计器中。

[http://msdn.microsoft.com/en-us/library/system.web.ui.control.init.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.control.init.aspx)

这样，您可以在您控制的实际代码隐藏类中保持常量，并且控件将以您想要的方式启动，您可以控制您想要更改的内容。

**更新：**抱歉没有意识到这是 WinForms。在 WinForms 中实际上更容易，因为您只需在调用控件初始化后立即在构造函数中注册您的控件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T12:46:19.700

你想解决什么问题？如果您尝试实现本地化，请查看 .NET 和卫星程序集附带的本地化功能。

如果您尝试解决自定义问题，请使用设置编辑器查看 .NET 中可用的自定义选项。

为什么需要使用常量字符串？

# windows-vista - Vista中的主磁盘组在哪里

> ID：877553
> 
> 赞同：0
> 
> 时间：2009-05-18T12:44:36.163
> 
> 标签：windows-vista, storage, san

在 Vista（2003，XP）之前，Windows 在注册表中有一个键

```
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\dmio\Boot Info\Primary Disk Group 
```

这表明在此安装中导入/激活了哪个动态磁盘组。

自Vista以来，这个键就没有了。尽管如此，操作系统仍需要以某种方式存储该信息，因为相同的磁盘组在另一台机器上导入时不会再次自动导入（即，如果动态磁盘位于 SAN 上，则每次 Vista 启动时，其他 Vista 会看到磁盘为外部）。

简而言之，我的问题是 - 此信息（这台机器的主磁盘组）存储在 Vista 中的什么位置

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T15:05:58.640

原来dmio被volmgrx取代了。相同的信息位于：

```
\\Registry\\Machine\\SYSTEM\\CurrentControlSet\\Services\\volmgrx 
```

# drupal - 带有视图的 Drupal 头版

> ID：877555
> 
> 赞同：3
> 
> 时间：2009-05-18T12:45:28.627
> 
> 标签：drupal, views, panels

有没有一种方法可以在不使用 Drupal 6.x 中的面板模块的情况下制作包含 2 个视图的首页？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-18T13:28:32.487

如果您不想使用面板，您可以将 2 个视图创建为块（就像您可以用于侧栏等）。然后将 then 添加到中心内容并使其仅在首页上可见...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T13:08:12.463

为什么不使用面板？如果您坚持，只需在 page-front.tpl.php 中进行编码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-11T09:01:10.423

您可以使用[views_embed_view](http://drupalcontrib.org/api/function/views_embed_view/6)函数在模板中的任何位置嵌入视图。

在您的情况下，您可以在 page-front.tpl.php 中使用它来显示首页中的两个视图。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-03T08:28:43.357

为页面创建一个视图，并将该页面的路径设置为首页。

将您想要添加到首页的其他视图添加为块，并使其仅在首页路径上可见。

在面板足够稳定以使其可用之前，我在 Drupal 6 站点上使用了类似的解决方案。我还使用了[Views exclude previous](http://drupal.org/project/views_exclude_previous)模块，然后使我能够拥有相同内容的多个列表，而不会在所有列表中显示相同的内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-31T21:41:32.797

views_embed_view 是要走的路。您可以调用任何视图。如果您启用了 PHP 过滤器，您可以在 page-front.tpl.php 或 jsut 正文中执行此操作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-02-09T10:32:08.067

螺丝面板和多个块！漂亮的视图附件有什么问题？它是视图原生的（没有额外的模块！！）而且超级简单！

1.  创建一个新的显示：附件
2.  配置它：
    *   将其附加到[您的页面显示]
    *   在之前或之后附加它
3.  设置字段和过滤器等，就像您对任何类型的显示所做的那样，或者只是从您的默认值继承
4.  而已！附件在页面显示之前或之后自动加载，无需任何额外的块或模块或麻烦。

您可以像任何类型的显示一样为附件提供页眉和页脚文本等。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-16T01:55:53.003

这是我在 Drupal 7.x 上所做的。

The question was for Drupal 6.x, but I guess that most people who will stumble on this page would be using Drupal 7\. I am new to Drupal, so I have no idea if this could apply to Drupal 6.

As x3ja menitionned I also used blocks.

I already had my views created for pages. On each view I added a new display with "+ Add" button and selected the "Block" display. Select a name for your block "Some block". Don't forget to save your view ;)

转到 example.com/admin/structure/block 并搜索您刚刚创建的块。它应该在“已禁用”部分。在下拉区域菜单中选择“内容”。节省。然后搜索应该在“内容”部分中的块。点击操作栏中的“配置”。在“可见性设置 > 页面 > 在特定页面上显示块”中选中“仅列出的页面”并写入“”。

# java - 如何在运行时向 Java 安全策略添加新的 RuntimePermission？

> ID：877562
> 
> 赞同：0
> 
> 时间：2009-05-18T12:46:40.777
> 
> 标签：java, security, permissions

我想在运行时将一个新的 RuntimePermission 添加到一组已经存在的权限 ( **java.policy** ) 文件中。这是我的代码：

```
ProtectionDomain domain = MyClass.class.getProtectionDomain();
        final PermissionCollection domainPerms = domain.getPermissions();
        Enumeration<Permission> oldPerms = domainPerms.elements();
        PermissionCollection newPerms = new Permissions();

        //add the old permissions to
        while (oldPerms.hasMoreElements()) {
            newPerms.add(oldPerms.nextElement());
        }
        //add my new permission
        RuntimePermission rtPermission = new RuntimePermission("accessDeclaredMembers");
        newPerms.add(rtPermission); 
```

..

但是我该如何使用这个`newPerms`对象呢？

此外，我尝试将新权限添加到`oldPerms`但由于`oldPerms`是只读的，因此我得到了一个不错的 SecurityException。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T12:57:52.673

这些`Permissions`类型有一个非常奇怪的 API，尽管您不能修改已设置为只读的对象应该不足为奇。`ProtectionDomain`s 应该是不可变的。

但是，从大约 1.4ish 开始，您可以拥有遵循 current 的“动态`ProtectionDomain`” `Policy`。但是，我不建议即时更改权限，因为它没有多大意义。更好地使用功能方法创建 API - 这`SecurityManager`只是关于不良 API 裂缝的纸。

# java - Java：获取一个/所有可用显示器的分辨率（而不是整个桌面）？

> ID：877570
> 
> 赞同：18
> 
> 时间：2009-05-18T12:50:19.160
> 
> 标签：java, user-interface, swing, awt

我有两个不同尺寸的显示器，使用（我相信）TwinView 连接在一起。

我试过

```
System.out.println(Toolkit.getDefaultToolkit().getScreenSize()); 
```

并得到

```
java.awt.Dimension[width=2960,height=1050] 
```

如果将两台显示器**一起**计算，这是正确的。

而不是这个，我希望能够实现以下目标**之一**：

*   获取当前显示器的分辨率
*   获得主显示器的分辨率

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-18T12:58:47.350

你会想要使用[GraphicsEnvironment](http://docs.oracle.com/javase/8/docs/api/java/awt/GraphicsEnvironment.html)。

特别是，getScreenDevices() 返回一个[GraphicsDevice](http://docs.oracle.com/javase/8/docs/api/java/awt/GraphicsDevice.html)对象数组，您可以从中读取显示模式的宽度/高度。

例子：

```
GraphicsEnvironment g = GraphicsEnvironment.getLocalGraphicsEnvironment();
GraphicsDevice[] devices = g.getScreenDevices();

for (int i = 0; i < devices.length; i++) {
    System.out.println("Width:" + devices[i].getDisplayMode().getWidth());
    System.out.println("Height:" + devices[i].getDisplayMode().getHeight());
} 
```

# sql - 降序排序索引

> ID：877571
> 
> 赞同：7
> 
> 时间：2009-05-18T12:50:53.140
> 
> 标签：sql, sql-server, indexing, performance

数据库引擎优化顾问终于放弃了鬼魂，帮不了我了，所以我不得不多学一点索引（不应该是索引吗？）。

我想我或多或少在那里。我知道什么时候使用复合索引，我的索引中包含什么，聚集索引和非聚集索引之间的区别等等。

然而......有一件事仍然让我感到困惑。创建索引时，索引有一个排序顺序。我理解这意味着什么，但我很难想到逆序索引可能有用的场景。我最好的猜测是加快检索在前向排序索引末尾出现的行的查询，例如按时间顺序最近的行，但坦率地说，我或多或少一无所知。

任何人都可以启发我吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-18T12:58:06.103

索引的排序顺序仅对多列索引很重要。对于单个列，如果 Sql Sever 想要索引为 ASC 的 DESC，则可以仅以相反的顺序使用索引。

对于多列搜索，索引排序确实很重要。假设您有一个索引：

```
field1, field2 desc 
```

这对此查询很有用：

```
select field1, field2 from table order by field1, field2 desc 
```

对于这个查询，索引可以反向使用：

```
select field1, field2 from table order by field1 desc, field2 
```

但是对于这个查询，Sql Server 需要一个额外的内存排序：

```
select field1, field2 from table order by field1, field2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T13:05:43.593

当您在 select 语句中定义*order by*时，定义正确的排序顺序可以***潜在地***消除查询计划中对排序步骤的需要。

 *[文章](http://msdn.microsoft.com/en-us/library/ms181154(SQL.90).aspx "索引排序顺序")

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T15:00:48.150

这是索引排序顺序的 BOL：

[http://msdn.microsoft.com/en-us/library/ms181154.aspx](http://msdn.microsoft.com/en-us/library/ms181154.aspx)

应该可以帮助您更多地了解内部工作原理以及语法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T12:53:30.090

当您为将按降序排序的查询设计索引时，您对索引进行降序排序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T14:02:21.373

最新数据通常存在偏差，因此如果您按“日期降序”排序，则可以针对此用例进行优化。

我想这对于数字而不是字母的东西会更有意义。

# jquery - 如何在初始化后调整 Jquery 对话框的宽度

> ID：877573
> 
> 赞同：19
> 
> 时间：2009-05-18T12:51:11.063
> 
> 标签：jquery, jquery-ui

我试图在初始化后更改 JQuery 对话框的宽度。这是我的初始化：

```
$(function() {
$("#dialogContainer").dialog({
title: 'Some title',
resizable: false,
bgiframe: true,
overlay: { opacity: 0.3, background: "white" },
position: [200, 200],
autoOpen: false,
height: 150,
width: 'auto'
modal: true,
buttons: {
  'ok': function() {
    $(this).dialog('close');
  }
} 
```

});

});

这就是我在其他一些功能中更改它的宽度的方法：

```
$("#dialogBox").dialog('option','width',700); 
```

但这不起作用。对话框的宽度是第一次显示在其中的段落的宽度。我应该做其他事情吗？

这是对话框的html：

```
<div id = 'dialogContainer'>
  <p id = 'message'></p>
</div> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-18T12:56:42.253

确保您使用的是 ui.resizable.js 和 ui.resizable.css

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-07-16T15:21:32.867

**使用指定的宽度选项初始化对话框：对话框的** 宽度以像素为单位。

```
$( "#dialogBox" ).dialog({ width: 500 }); 
```

**初始化后获取或设置宽度选项：**

```
// getter
var width = $( "#dialogBox" ).dialog( "option", "width" );

// setter
$( "#dialogBox" ).dialog( "option", "width", 500 ); 
```

来源：[http ://api.jqueryui.com/dialog/](http://api.jqueryui.com/dialog/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-03-01T12:32:05.283

这是简短的解决方案，但请记住它仅适用于预定义的对话框。

```
$( "#dialog" ).dialog({minHeight: 300,minWidth:500}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-01T20:58:11.383

试试这个：

```
$("#dialogID").data("width.dialog", 160); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-11T18:32:57.950

```
$("#dialogID").css("width", 160); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-07-19T02:26:39.740

这对我有用。关键是打开**后调整大小：**

```
$('#dialogContainer').
    dialog('open').
    dialog('option', 'width',   'auto').
    dialog('option', 'height',  'auto'); 
```

就我而言，jQuery 版本是 1.11：

```
> Query.fn.jquery
> "1.11.1" 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-07-25T10:40:40.260

```
$("#dialogweb").dialog({width:'90%'}); 
```

# c++ - Boost 的作用域互斥锁和 WinAPi 的临界区有区别吗？

> ID：877577
> 
> 赞同：9
> 
> 时间：2009-05-18T12:52:20.313
> 
> 标签：c++, multithreading, boost, mutex, critical-section

在 Windows 环境中，Boost 的作用域互斥锁是使用 WinAPI 的关键部分还是其他什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-18T15:12:26.003

当前版本`boost::mutex`既不使用 Win32`CRITICAL_SECTION`也不使用 Win32 Mutex。相反，它使用原子操作和 Win32 事件来阻塞等待。

旧版本（boost 1.34.1 和更早版本）是`CRITICAL_SECTION`Windows 上的包装器。

顺便说一句，互斥锁本身没有作用域。`boost::mutex::scoped_lock`类型和，在最近的版本中，并`boost::lock_guard<boost::mutex>`提供`boost::unique_lock<boost::mutex>`RAII 包装器用于锁定互斥锁，以确保您不会忘记解锁它。

`boost::lock_guard<>`and模板适用于任何类型的`boost::unique_lock<>`with`lock()`和`unlock()`成员函数，因此如果需要，您可以将它们与进程间互斥体一起使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T13:02:36.687

Win32 的 CRITICAL_SECTION 只能在*单个进程*的线程之间使用。如果您需要在进程之间使用某些东西，则需要一个互斥锁。Boost 对关键部分只字未提，所以我认为它正在使用互斥锁。

“作用域”只是意味着它有一个包装器，它使用[RAII](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)在特定作用域的末尾自动解锁互斥锁。

# python - 将 Numpy 数组转换为稀疏字典的最快方法？

> ID：877578
> 
> 赞同：5
> 
> 时间：2009-05-18T12:52:21.980
> 
> 标签：python, performance, numpy

我有兴趣尽快将 numpy 数组转换为稀疏字典。让我详细说明：

给定数组：

```
numpy.array([12,0,0,0,3,0,0,1]) 
```

我希望制作字典：

```
{0:12, 4:3, 7:1} 
```

如您所见，我们只是将序列类型转换为从非零索引到其值的显式映射。

为了使这更有趣，我提供了以下测试工具来尝试替代方案：

```
from timeit import Timer

if __name__ == "__main__":
  s = "import numpy; from itertools import izip; from numpy import nonzero, flatnonzero; vector =         numpy.random.poisson(0.1, size=10000);"

  ms = [ "f = flatnonzero(vector); dict( zip( f, vector[f] ) )"
             , "f = flatnonzero(vector); dict( izip( f, vector[f] ) )"
             , "f = nonzero(vector); dict( izip( f[0], vector[f] ) )"
             , "n = vector > 0; i = numpy.arange(len(vector))[n]; v = vector[n]; dict(izip(i,v))"
             , "i = flatnonzero(vector); v = vector[vector > 0]; dict(izip(i,v))"
             , "dict( zip( flatnonzero(vector), vector[flatnonzero(vector)] ) )"
             , "dict( zip( flatnonzero(vector), vector[nonzero(vector)] ) )"
             , "dict( (i, x) for i,x in enumerate(vector) if x > 0);"
             ]
  for m in ms:
    print "  %.2fs" % Timer(m, s).timeit(1000), m 
```

我正在使用泊松分布来模拟我有兴趣转换的数组类型。

到目前为止，这是我的结果：

```
 0.78s f = flatnonzero(vector); dict( zip( f, vector[f] ) )
   0.73s f = flatnonzero(vector); dict( izip( f, vector[f] ) )
   0.71s f = nonzero(vector); dict( izip( f[0], vector[f] ) )
   0.67s n = vector > 0; i = numpy.arange(len(vector))[n]; v = vector[n]; dict(izip(i,v))
   0.81s i = flatnonzero(vector); v = vector[vector > 0]; dict(izip(i,v))
   1.01s dict( zip( flatnonzero(vector), vector[flatnonzero(vector)] ) )
   1.03s dict( zip( flatnonzero(vector), vector[nonzero(vector)] ) )
   4.90s dict( (i, x) for i,x in enumerate(vector) if x > 0); 
```

如您所见，我找到的最快的解决方案是

```
n = vector > 0;
i = numpy.arange(len(vector))[n]
v = vector[n]
dict(izip(i,v)) 
```

有更快的方法吗？

编辑：步骤

```
i = numpy.arange(len(vector))[n] 
```

似乎特别笨拙——在只选择一些元素之前生成整个数组，特别是当我们知道它可能只有大约 1/10 的元素被选中时。我认为这可能还有待改进。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-10-31T10:52:45.003

```
>>> a=np.array([12,0,0,0,3,0,0,1])
>>> {i:a[i] for i in np.nonzero(a)[0]}
{0: 12, 4: 3, 7: 1} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-01T09:24:59.757

使用 scipy 中的稀疏矩阵作为桥梁：

```
from scipy.sparse import *
import numpy
a=numpy.array([12,0,0,0,3,0,0,1])
m=csr_matrix(a)

d={}
for i in m.nonzero()[1]:
  d[i]=m[0,i]
print d 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-31T20:24:31.020

以下似乎是一个显着的改进：

```
i = np.flatnonzero(vector)
dict.fromkeys(i.tolist(), vector[i].tolist()) 
```

定时：

```
import numpy as np
from itertools import izip

vector = np.random.poisson(0.1, size=10000)

%timeit f = np.flatnonzero(vector); dict( izip( f, vector[f] ) )
# 1000 loops, best of 3: 951 µs per loop

%timeit f = np.flatnonzero(vector); dict.fromkeys(f.tolist(), vector[f].tolist())
# 1000 loops, best of 3: 419 µs per loop 
```

我也尝试过`scipy.sparse.dok_matrix`，`pandas.DataFrame.to_dict`但在我的测试中它们比原来的要慢。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-20T01:50:11.293

您可以[`np.unique`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.unique.html)使用`return_index=True`：

```
>>> import numpy as np

>>> arr = np.array([12,0,0,0,3,0,0,1])

>>> val, idx = np.unique(arr, return_index=True)
>>> mask = val != 0                                # exclude zero
>>> dict(zip(idx[mask], val[mask]))                # create the dictionary
{0: 12, 4: 3, 7: 1} 
```

迭代`list`s 通常比`numpy.array`s 更快，因此当您将它们转换为列表时可以更快`tolist`：

```
>>> dict(zip(idx[mask].tolist(), val[mask].tolist())) 
```

### 定时

对于短阵列，这种方法可能较慢，但根据我的时间安排，它比其他大阵列的方法更快：

```
import numpy as np
from scipy.sparse import csr_matrix

arr = np.random.randint(0, 10, size=10000)  # 10k items
arr[arr < 7] = 0                            # make it sparse

# ----------

%timeit {i:arr[i] for i in np.nonzero(arr)[0]}
# 3.7 ms ± 51 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)

# ----------

%%timeit

val, idx = np.unique(arr, return_index=True)
mask = val != 0
dict(zip(idx[mask].tolist(), val[mask].tolist()))

# 844 µs ± 42.7 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)

# ----------

%%timeit

m=csr_matrix(a)

d={}
for i in m.nonzero()[1]:
    d[i]=m[0,i]

# 1.52 s ± 57.4 ms per loop (mean ± std. dev. of 7 runs, 1 loop each) 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-26T10:15:58.173

试过这个？

从 numpy 导入到哪里

i = 其中（向量 > 0）[0]

# .net - 密码加密/数据库层 AES 或应用层 AES

> ID：877583
> 
> 赞同：0
> 
> 时间：2009-05-18T12:53:48.093
> 
> 标签：.net, security, sql-server-2008, clr, passwords

我需要加密/解密新应用程序的密码。规范要求我使用 AES；任何人都可以提出一个很好的理由

1.  使用 CLR 函数在数据库层进行所有加密，或者
2.  在 .Net 应用层做这件事？
3.  数据库和服务器的混合

我将成为验证密码；该应用程序使用 Telerik ORM 进行了 n 层分层。唯一真正的功能将是创建/更新密码并检查输入的值。

在我的直觉中，我认为

1.  数据库更适合根据现有记录验证用户输入的密码；和
2.  用于创建/更新密码的前端（因此永远不会传输纯文本密码）

我对其他想法和建议感兴趣，为什么我可以做一个替代方案。如果您建议我在前端执行此操作，您对加密密钥有何看法？XML 中的每个用户一个或配置文件中的每个应用一个？

感谢您的任何建议:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T13:01:16.847

**根本不要存储密码 - 只是它们的*盐渍*哈希。**

仅加密密码的问题非常明显——您必须将密钥存储在某处。如果你执行客户端加密，我将只使用 Reflector 在代码中查找密钥或附加调试器并等待客户端从服务器获取密钥。

如果您在服务器上执行加密，获取密钥将变得更加困难 - 但每个有权访问服务器的人都可以使用与前面提到的相同的技术，因为您仍然必须将密钥存储在某个地方。当然，您必须加密客户端和服务器之间的连接，否则攻击变得微不足道。

并且将加密移动到数据库服务器不会有太大变化，您将不得不加密客户端和服务器之间以及服务器和数据库服务器之间的两个连接。

我建议在服务器中执行加密，否则您必须信任客户端。这当然需要客户端和服务器之间的安全连接。服务器和数据库服务器之间的连接可能是未加密的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T12:59:10.143

我只需要验证密码，使用单向加密可能会更好。

这里有一些关于该主题的讨论： [Encrypting/Hashing plain text passwords in database](https://stackoverflow.com/questions/287517/encrypting-hashing-plain-text-passwords-in-database)

# audio - Symbian 设备上的音频编程

> ID：877584
> 
> 赞同：1
> 
> 时间：2009-05-18T12:53:48.950
> 
> 标签：audio, symbian

我是一名盲人程序员，想为基于 symbian 的手机开发完全基于音频的游戏。我需要能够执行以下操作。从手机操纵杆和常规按键获取输入，并播放具有不同音量和方向的音频，就像在 directX 中一样。我知道第一部分在任何语言中都不是问题，但不确定第二部分。我非常了解Java，在某种程度上了解Python，并且了解c++，但我很生疏。我想使用 Java 或 Python，但不确定它们是否提供音频功能。任何可以帮助我的库或示例代码的链接将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T11:22:26.470

您可以在 Symbian 手机上使用 JavaME。

您需要的相关规格是：

[http://www.jcp.org/en/jsr/detail?id=118](http://www.jcp.org/en/jsr/detail?id=118)

和

[http://www.jcp.org/en/jsr/detail?id=135](http://www.jcp.org/en/jsr/detail?id=135)

我建议制作一个显示 Canvas 的简单 MIDlet。

对于初学者，您可以通过播放不同的 MIDI 音调来对任何键事件做出反应。

您应该避免在 GUI 回调线程中播放音频。

JavaME SDK 将包含用于关键事件处理和音频播放的示例代码。

# language-agnostic - 我应该使用什么字符来替换 url slug 中的非法字符

> ID：877586
> 
> 赞同：0
> 
> 时间：2009-05-18T12:53:56.860
> 
> 标签：language-agnostic, seo, friendly-url

我注意到各种系统使用各种字符作为 url 中非法字符的替代品。

是否有理由使用其中一个或我应该选择最适合我的那个

到目前为止我看到的选项包括： - _ + 并简单地删除所有非法字符。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T12:58:42.920

只需使用 - 作为空间并摆脱非法字符（就像这个网站一样）。

而且都是小写的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T12:56:52.580

我个人会使用 _ 来替换非法字符和 - 用于空格。另一种选择是简单地删除非法字符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T13:10:41.820

我的偏好是“-”，我使用一个非常简单的 RegEx 来替换我不想要的所有内容。

```
[^a-zA-Z0-9\-]* 
```

这将用破折号替换任何非字母数字字符和破折号字符。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T14:05:08.527

# java - Java 接口：继承、覆盖和重载方法

> ID：877587
> 
> 赞同：9
> 
> 时间：2009-05-18T12:53:58.750
> 
> 标签：java, interface, overriding, overloading

在 Ken Arnold、James Gosling、David Holmes 撰写的“THE Java™ Programming Language, Fourth Edition”中，它提到：

**段落：（4.3.2）** *“同样，如果一个接口继承了多个具有相同签名的方法，或者如果一个类实现了包含具有相同签名的方法的不同接口，则只有一个这样的方法。该方法的实现最终由实现接口的类定义，没有歧义。如果方法具有相同的签名但返回类型不同，则返回类型必须是所有其他类型的子类型，否则编译时错误发生。实现必须定义一个返回该公共子类型的方法。*

**任何人都可以给我一些示例代码来证明上述段落的观点吗？**

我尝试编写代码并测试所提到的内容，但出现编译时错误，子接口隐藏了基本接口方法，因此只能实现子接口方法。

提前致谢。-阿伦

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-18T13:01:42.197

```
interface A {
    void method();
    Object returnMethod();
}
interface B {
    void method();
    B returnMethod();
}

class Impl implements A,B 
{
    void method() { }
    B returnMethod() { }
} 
```

如您所见，同时`Impl.method()`实现`A.method()`and `B.method()`，同时`Impl.returnMethod()`返回 a `B`，它是 的子级`Object`，因此也履行了`A.returnMethod()`'s 合同。后者是否需要一个不是返回类型的父级`B.returnMethod()`的返回类型，这将是一个comile错误，因为在`Impl`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T13:15:18.830

以下两个接口`methodA()`在参数（none）和返回类型（int）方面定义相同。底部的实现类定义了一个具有这个确切签名的方法。由于它同时符合这两个接口，因此您不会遇到任何问题 - 通过 InterfaceA 或 InterfaceB 类型的引用进行的任何调用都将被分派到此实现。

第二个被定义`methodB()`为返回. 定义为返回一个which 是 的子类型。实现类实际上实现了 with 的方法，因此符合and的约定。这里也没有问题。注释掉的被实施为返回 a然而的情况是行不通的：虽然它会满足 的合同，但它会与（要求 a ）冲突。`Number``Number``InterfaceA``InterfaceB``methodB()``Integer``Number``Integer``InterfaceA``InterfaceB``methodB()``Double``InterfaceA``InterfaceB``Integer`

如果`InterfaceA`并且还为（在示例中注释掉的`InterfaceB`）指定（不同的）合约，这将是矛盾的，并会产生编译器错误。`methodC()`Java 中不允许同时实现这两个签名（仅在返回类型上有所不同）。

如果要向方法添加任何参数，上述规则也适用。为简单起见，我将其排除在示例之外。

```
public interface InterfaceA {
    public int methodA();
    public Number methodB();
    // public int methodC(); // conflicting return type
}

public interface InterfaceB {
    public int methodA();
    public Integer methodB();
    // public String methodC(); // conflicting return type
}

public class ImplementationOfAandB implements InterfaceA, InterfaceB {
    public int methodA() {
        return 0;
    }
    public Integer methodB() {
        return null;
    }
    // This would NOT work:
    // public Double methodB() {
    //     return null;
    // }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T13:01:10.420

```
interface A
{
   void foo();
   //int bar(); <-- conflicts with B.bar() because of different return type
}

interface B
{
   void foo();
   //double bar(); <-- conflicts with A.bar() because of different return type
}

class C implements A, B
{
   void foo() // this implements A.foo() AND B.foo()
   {
      ...
   }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T13:08:06.380

你是这个意思吗？：

```
interface A {
    Object get();
}
interface B {
    Number get();
}

abstract class MyClass implements A, B {
    // Try to override A.get, but cause a compile error.
    public Object get() { return null; }
} 
```

MyClass 中的这种方法是由 javac 作为合成桥方法自动生成的。您必须实现一个返回与所有已实现/覆盖的方法兼容的类型的方法（在本例中为`Number`// `Integer`/ `Double`etc）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-09-07T11:48:02.183

```
/**
 * This is what you have
 */
interface IXR {
        //bla-bla-bla
}

class CXR implements IXR {
        //concrete implementation of bla-bla-bla
}

interface IX {
        public IXR f();
} 

interface IYR {
        //some other bla-bla-bla
}

class CYR implements IYR {
        //concrete implementation of the some other bla-bla-bla
} 

interface IY {
        public IYR f();
}

/**
 * This is what you need to add
 */ 
interface IZR extends IXR, IYR {
        //EMPTY INTERFACE
}

class CZXR extends CXR implements IZR {
        //EMPTY CLASS
} 

class CZYR extends CYR implements IZR {
        //EMPTY CLASS
}

class CZ implements IX, IY
{
        public static boolean someCondition = true;

        public IXR implementationOf_X_f()
        {
                System.out.println("CXR");
                return new CZXR();
        }

        public IYR implementationOf_Y_f()
        {
                System.out.println("CYR");
                return new CZYR();
        }

        public IZR f() {
                if (someCondition) {
                        return (IZR) implementationOf_X_f();
                } else {
                        return (IZR) implementationOf_Y_f();
                }
        }

}

/**
 * This is the usage of the required class
 */
class program 
{ 
        public static void main(String[] x) {
                CZ o = new CZ();
                IZR r = o.f();
                if (CZ.someCondition) {
                        CXR xr = (CXR) r;
                        //bla-bla-bla
                } else {
                        CYR yr = (CYR) r;
                        //bla-bla-bla
                }
        }
} /**
 * This is what you have
 */
interface IXR {
        //bla-bla-bla
}

class CXR implements IXR {
        //concrete implementation of bla-bla-bla
}

interface IX {
        public IXR f();
} 

interface IYR {
        //some other bla-bla-bla
}

class CYR implements IYR {
        //concrete implementation of the some other bla-bla-bla
} 

interface IY {
        public IYR f();
}

/**
 * This is what you need to add
 */ 
interface IZR extends IXR, IYR {
        //EMPTY INTERFACE
}

class CZXR extends CXR implements IZR {
        //EMPTY CLASS
} 

class CZYR extends CYR implements IZR {
        //EMPTY CLASS
}

class CZ implements IX, IY
{
        public static boolean someCondition = true;

        public IXR implementationOf_X_f()
        {
                System.out.println("CXR");
                return new CZXR();
        }

        public IYR implementationOf_Y_f()
        {
                System.out.println("CYR");
                return new CZYR();
        }

        public IZR f() {
                if (someCondition) {
                        return (IZR) implementationOf_X_f();
                } else {
                        return (IZR) implementationOf_Y_f();
                }
        }

}

/**
 * This is the usage of the required class
 */
class program 
{ 
        public static void main(String[] x) {
                CZ o = new CZ();
                IZR r = o.f();
                if (CZ.someCondition) {
                        CXR xr = (CXR) r;
                        //bla-bla-bla
                } else {
                        CYR yr = (CYR) r;
                        //bla-bla-bla
                }
        }
} 
```

# asp.net-mvc - Asp.net MVC 和实体框架，无法访问相关表

> ID：877588
> 
> 赞同：2
> 
> 时间：2009-05-18T12:54:15.613
> 
> 标签：asp.net-mvc, entity-framework

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/SiteControl.Master" Inherits="System.Web.Mvc.ViewPage<IEnumerable<Website.SimpleRepository.Page>>" %>

<asp:Content ID="Content2" ContentPlaceHolderID="content" runat="server">

<h2>Page List</h2>

  <p>
    <%= Html.ActionLink("Create New", "Create") %>
</p>

<table>
    <tr>
        <th></th>
        <th>
            Display As
        </th>
        <th>
            Layout
        </th>

    </tr>

<% foreach (var item in Model) { %>

    <tr>
        <td>
            <%= Html.Encode(item.DisplayAs) %>
        </td>
        <td>
            <%= Html.Encode(item.Types.Name) %>
        </td>
    </tr>

<% } %>

</table>
</asp:Content> 
```

我很难访问 item.Types.Name 它返回一个空异常。我在一个单独的类库中有我的实体数据模型。谁能解释为什么它返回一个空异常以及我能做些什么来解决这个问题？我见过其他引用相关表值的项目，但无法弄清楚为什么我的工作有所不同......

关于这个主题的任何信息都会很棒！谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T12:58:18.757

确保实体映射中的外键关系允许延迟加载或这些引用属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T13:13:19.800

你是如何查询数据的？

我发现当前的 EF 设置要求我使用魔术字符串比我想要的更明确：

```
public IEnumerable<Item> GetItems(){
  ObjectQuery<Item> items = ItemSet.Include("Types");

  return (from i in items
          where [...]
          select i);
} 
```

这当然不会让您在编译时检查外键，但它至少现在会返回它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T13:27:11.460

事实证明，正如我所料，我是一个完全的新手。我的问题的解决方案是我没有将关联的表传递给视图。感谢您的回答！

# fonts - 如何更改 LaTeX 中的文档字体？

> ID：877597
> 
> 赞同：339
> 
> 时间：2009-05-18T12:56:13.097
> 
> 标签：fonts, latex

您如何将整个文档的字体更改为无衬线字体（或其他字体）？

* * *

## 回答 #1

> 赞同：231
> 
> 时间：2009-05-18T13:10:55.627

感谢文森特答案中的链接，我找到了解决方案。

```
 \renewcommand{\familydefault}{\sfdefault} 
```

这会将默认字体系列更改为无衬线字体。

* * *

## 回答 #2

> 赞同：98
> 
> 时间：2009-12-03T15:25:43.687

对于不同的方法，我建议使用[XeTeX](http://xetex.sourceforge.net/)或[LuaTex](http://www.luatex.org/)系统。它们允许您访问系统字体（TrueType、OpenType 等）并设置字体功能。在典型的 LaTeX 文档中，您只需在标题中包含以下内容：

```
\usepackage{fontspec}
\defaultfontfeatures{Mapping=tex-text,Scale=MatchLowercase}
\setmainfont{Times}
\setmonofont{Lucida Sans Typewriter} 
```

它`fontspec`是允许`\setmainfont`和的包`\setmonofont`。选择多种字体功能的能力超出了我的专业知识，但我建议查找一些示例，看看这是否适合您的需求。

Just don't forget to replace your favorite latex compiler by the appropriate one (xelatex or lualatex).

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2009-05-19T03:09:43.653

正如第二个所说，为 TeX 文档所做的大多数“设计”决策都得到了经过充分研究的可用性研究的支持，因此应谨慎进行更改。然而，用 Times（也是衬线字体）代替 Computer Modern 是相对常见的。

试试`\usepackage{times}`。

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2009-05-18T13:02:27.967

本文可能对更改字体有所帮助[。](https://web.archive.org/web/20180721043841/https://www.cl.cam.ac.uk/~rf10/pstex/latexcommands.htm)

来自文章：

> 以下示例说明了更改字体属性的命令：

```
 \fontencoding{T1}
  \fontfamily{garamond}
  \fontseries{m}
  \fontshape{it}
  \fontsize{12}{15}
  \selectfont 
```

> 这一系列命令将当前字体设置为中等粗细斜体 garamond 12pt 类型，在 T1 编码方案中前导 15pt，\selectfont 命令使 LaTeX 在其映射方案中查找与这些属性对应的度量。

# html - 推特菜单栏

> ID：877598
> 
> 赞同：1
> 
> 时间：2009-05-18T12:56:22.783
> 
> 标签：html, css, twitter

你知道 Twitter 菜单栏是如何圆润的。我该怎么做（在 CSS 中？）。我还想确保它围绕我所有的菜单项。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T13:00:40.793

请注意，这在 IE 中不能作为纯 CSS 工作。但这里是你如何做到的：

[http://perishablepress.com/press/2008/11/24/perfect-rounded-corners-with-css/](http://perishablepress.com/press/2008/11/24/perfect-rounded-corners-with-css/)

```
/* 4 rounded corners */
.all-four-rounded-corners {
    -webkit-border-radius: 10px;
    -khtml-border-radius: 10px; 
    -moz-border-radius: 10px;
    border-radius: 10px;
} 
```

如文章所示，您也可以单独完成每个角落。但目前在 CSS 2 中，您无法在 IE 中执行此操作，因为它在 CSS 3 之前不是官方支持的 CSS 方法。这就是为什么 , `moz`,`webkit`和`khtml`附加在前面的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T13:07:59.110

获取一个名为 firebug 的 Firefox 插件。[https://addons.mozilla.org/en-US/firefox/addon/1843](https://addons.mozilla.org/en-US/firefox/addon/1843) 它允许您从浏览器内部快速检查页面上的元素。

安装后，转到 twitter.com 并点击浏览器右下角的小错误图标。然后点击检查，您可以将鼠标悬停在菜单项上以查看它们的标记。单击这些项目，您可以看到它们的 CSS。您甚至可以更改 css，它会在页面上实时更新。

这是我在 twitter.com 上得到的

**HTML**

```
<ul class="top-navigation round">
 <li>
  <a id="home_link" accesskey="h" href="http://twitter.com/home">Home</a>
 </li>
 <li>
 </li> 
```

**CSS**

```
.round {
    -moz-border-radius-bottomleft:5px;
    -moz-border-radius-bottomright:5px;
    -moz-border-radius-topleft:5px;
    -moz-border-radius-topright:5px;
    } 
```

似乎他们只是使用专有的浏览器技术来创建圆角。这在 IE 中不起作用。还有其他方法。只需检查其他站点，看看他们是如何做到的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T17:06:51.437

这是一个适用于所有浏览器的巧妙技巧，包括 IE。另请注意，不需要图像。

复制/粘贴以下 html 片段并保存为 html 文件并尝试一下：

```
<head>
<style type="text/css">
<!--
#container {background: #cccccc;}
.roundtop {background: #ffffff;}
.roundbottom {background: #ffffff;}
.r1{margin: 0 5px; height: 1px; overflow: hidden; background: #cccccc;}
.r2{margin: 0 3px; height: 1px; overflow: hidden; background: #cccccc;}
.r3{margin: 0 2px; height: 1px; overflow: hidden; background: #cccccc;}
.r4{margin: 0 1px; height: 2px; overflow: hidden; background: #cccccc;}
.content {padding: 10px;}
-->
</style>
</head>

<body>
<div id="container">
 <div class="roundtop">
   <div class="r1"></div>
   <div class="r2"></div>
   <div class="r3"></div>
   <div class="r4"></div>
 </div>
<div class="content">Your content goes here ..</div>
 <div class="roundbottom">
   <div class="r4"></div>
   <div class="r3"></div>
   <div class="r2"></div>
   <div class="r1"></div>
 </div>
</div>
</body> 
```

这是一个放大的屏幕截图，可以更好地了解正在发生的事情。上图显示了浏览器中的结果，下图显示了不同颜色的 div 的外观。

[带有圆角的 div 的放大屏幕截图](http://img152.imageshack.us/img152/5536/roundcorner3.gif)

祝你好运！//马格纳斯

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T13:01:42.260

您想要元素上的圆角吗？我的建议是使用 CSS 规则：

```
-moz-border-radius: 10px;
-webkit-border-radius: 10px; 
```

不利的一面是，它不会在 IE 中给你带来圆角，但从好的方面来说，它不会让你头疼。如果您想要跨平台，请查看[jQuery Corners](http://plugins.jquery.com/project/corners)或[Internet 上有关圆角的无数教程](http://www.google.com/search?q=rounded%20corners)。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-18T13:06:04.123

这并不容易。至少有这些技术：

*   使您的物品具有固定尺寸，并仅使用包含角落的背景图像

*   将您的物品包装在 3 x 3 的桌子上。中心单元格是您的内容，周围的单元格包含具有您想要的角的图像（直接或通过 CSS）。

*   如果您的项目高度一致但宽度不一致，则可以使用双 div 解决方案

**双格**

```
<style type=text/css>
.ItemOuter { background-image: url('left-side-top-and-bottom-rounded-corners.png'); }
.ItemInner { background-image: url('right-side-top-and-bottom-rounded-corners.png'); background-position: top right; margin-left: 10px; }
</style>
...

<div class="ItemOuter"><div class="ItemInner">content</div></div> 
```

# c# - 如何在 C# 的数据表中存储 N 维向量？

> ID：877621
> 
> 赞同：1
> 
> 时间：2009-05-18T12:59:43.417
> 
> 标签：c#, datatable

如何在 C# 的数据表中存储 N 维向量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T13:08:54.427

对于真正的 n 维的东西，你可能不得不放弃更简单的概念——也许是一个多维数组 ( `T[,...,]`)。

如果维数已知且恒定（但> 1），则诸如锯齿状数组（`T[]...[]`）或使用等的包装器是可行的。`List<T>`

`Array`使用未知维度的示例：

```
 int[] dimensions = { 3, 2, 5 }; // etc
    Array arr = Array.CreateInstance(
        typeof(int), dimensions);
    int[] index = {0,0,0}; // etc
    arr.SetValue(3, index); 
```

但显然，如果知道尺寸会更容易：

```
 int[, ,] arr = new int[3, 2, 5];
    arr[0, 0, 0] = 3; 
```

多维数组的问题在于，它们很快就会变得太大，以至于 CLR 无法触及......这就是锯齿状数组或其他包装器派上用场的地方（通过将其拆分为多个较小的对象） - 但使构造变得更加困难：

```
 int[][][] arr = new int[3][][];
    for(int i = 0 ; i < 3 ; i++) {
        arr[i] = new int[2][];
        for(int j = 0 ; j < 2 ; j++) {
            arr[i][j] = new int[5];
        }            
    }
    arr[0][0][0] = 3; 
```

其中任何一个通常都可以包装在一个类中，这可能是明智的做法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T13:12:51.143

如果预先知道维度的数量，您可以只为每个维度创建一个“列”。

# windows - 如何在 Windows 批处理编程中获取管道中命令的错误级别？

> ID：877639
> 
> 赞同：32
> 
> 时间：2009-05-18T13:03:48.977
> 
> 标签：windows, batch-file, batch-processing

批处理文件默认返回最后一条命令的错误码。

是否有可能返回前一个命令的错误代码。最值得注意的是，是否可以在管道中返回命令的错误代码？

例如，这个单行批处理脚本

```
foo.exe 
```

*返回foo*的错误代码。但是这个：

```
foo.exe | tee output.txt 
```

*总是返回tee*的退出代码，该代码为零。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-10-05T21:05:37.830

我遇到了类似的问题并选择了以下解决方案，因为我不需要检测确切的错误代码只是成功或失败。

```
echo > .failed.tmp    

( foo.exe && del .failed.tmp ) | tee foo.log

if exist .failed.tmp (
    del .failed.tmp
    exit /b 1
) else (
    exit /b 0
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-10-06T19:22:42.833

%ERRORLEVEL% 变量在管道命令运行之前不会更新；您必须按照其他答案中的建议使用包装器。

但是，您**可以**使用“IF ERRORLEVEL #”。例如：

```
(
type filename
@REM Use an existing (or not) filename to test each branch
IF ERRORLEVEL 1 (echo ERROR) ELSE (echo OKAY)
) > logfile.txt 
```

ECHO 只有在返回错误时才会运行；但是 %ERRORLEVEL% 似乎不一致。

**编辑：**将示例更改为可按原样运行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T13:38:28.613

一种解决方法是通过文件进行间接寻址。

像这样

```
foo.exe > tmp.txt
set FOOERR=%ERRORLEVEL%
cat tmp.txt
exit %FOOERR% 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-01-02T03:50:20.323

经过大约一天的挖掘，我找到了一种方法：

```
set error_=0
9>&1 1>&2 2>&9 (for /f "delims=" %%i in ('9^>^&1 1^>^&2 2^>^&9 ^(^(^(2^>^&1 call "%homeDir%%1"^) ^|^| ^(1^>^&2 2^>nul echo FAILED^)^) ^| 2^>nul "%homeDir%mtee" /T /+ "%homeDir%logs\%date_%_%1.log"^)') do (set error_=1))

exit /b %error_% 
```

在上面的示例中，“%homeDir%%1”正在执行，其输出通过管道传输到“%homeDir%mtee”。此行检测失败（我建议您绘制批处理上下文及其 stdin/stdout/stderr 分配的图表，以了解它的作用:-)）。我没有找到提取实际错误级别的好方法。我得到的最好的事情是用一些批处理脚本调用'call rc.bat'替换'echo'命令，它看起来像：

```
@echo %errorlevel% 
```

然后将 'set error_=1' 替换为 'set error_=%%i'。

但问题是这个调用也可能失败，而且不容易检测到。尽管如此，它总比没有好 - 我在互联网上没有找到任何解决方案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-12-28T14:18:28.863

要为入口 bat 文件调用 tee，而不是为单个命令调用，并自由使用 errorlevel，我使用这样的技巧：

```
if "%1" == "body" goto :body
call %0 body | tee log.txt
goto :eof
:body

set nls_lang=american_america
set HomePath=%~dp0

sqlplus "usr/pwd@tnsname" "@%HomePath%script.sql" 
if errorlevel 1 goto dberror

rem Here I can do something which is dependent on correct finish of script.sql    

:dberror

echo script.sqlerror failed 
```

它将使用 tee 与调用批处理中的任何命令分开。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-07-15T10:21:26.363

您可以通过在命令文件周围创建包装器来解决此问题：

```
rem wrapper for command file, wrapper.cmd

call foo.exe

echo %errorlevel%

if errorlevel 1 goto... 
```

然后将 tee 附加到包装器：

```
wrapper.cmd | tee result.log 
```

当然，这并不完全相同，例如，如果您想在打包文件中登录多个文件，这是不可能的，但在我的情况下它解决了问题。

# database - 将图像存储在数据库或文件系统中好吗？

> ID：877640
> 
> 赞同：0
> 
> 时间：2009-05-18T13:03:58.807
> 
> 标签：database, image

> **可能重复：**
> [在数据库中存储图像 - 是还是不是？](https://stackoverflow.com/questions/3748/storing-images-in-db-yea-or-nay)

您建议将图像存储在：-

*   文件系统 *或*
*   数据库

这是概念性问题，我想得出结论，在不同的项目中哪种方法更好。

*注意：请说明哪种方法更好。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T13:08:57.360

无需将图像存储在数据库中，因为您永远不会根据数据本身进行查找。相反，您应该将它们存储在文件系统中并将文件路径存储在数据库中。通过将数据放在硬盘驱动器上，您可以直接访问它们以进行各种其他程序，包括备份。较小的 SQL 更易于维护。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T13:10:05.970

哪个更好取决于您的情况（当然）。将它们保存在数据库中意味着系统几乎是完全可移植的。一切都紧密相连，一起“旅行”。

缺点是一切都紧密相连，您需要访问数据库来检索图像。这包括运行连接到数据库和处理图像信息所需的任何代码。这是很多开销。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T13:16:11.917

不，不再是，或者永远都不是。如果您需要从任何应用程序访问诸如用户图片之类的东西，它曾经是可以接受的，并且没有真正的方法可以将其存储在全局服务器上。但是现在有了像亚马逊的云 API 这样的替代品来存储图像，真的不需要再将它们存储在数据库中了，你可以使用亚马逊的云作为你的数据库。

# java - 用于解析简单的基于文本的数据文件的正则表达式

> ID：877643
> 
> 赞同：1
> 
> 时间：2009-05-18T13:04:43.190
> 
> 标签：java, regex, parsing, adventure

任何人都可以给我一点正则表达式的帮助吗？

我正在阅读一个简单文本冒险的“位置”列表（那些在当时很受欢迎）。但是，我不确定如何获取输入。

这些位置都遵循以下格式：

```
<location_name>, [<item>]
    [direction, location_name] 
```

如：

```
Albus Square, Flowers, Traffic Cone
    NORTH, Franklandclaw Lecture Theatre
    WEST, Library of Enchanted Books
    SOUTH, Furnesspuff College

Library of Enchanted Books
    EAST, Albus Square
    UP, Reading Room 
```

（后续位置用空行分隔。）

我将这些存储为具有以下结构的 Location 对象：

```
public class Location {

    private String name;

    private Map<Direction, Location> links;

    private List<Item> items;

} 
```

我使用一种方法从 URL 检索数据并从读取的文本创建 Location 对象，但我完全无法做到这一点。我认为正则表达式会有所帮助。任何人都可以借我一个急需的手吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T13:15:43.103

您不想为此使用纯文本格式：

*   当您拥有多个花卉时会发生什么？它们都一样吗？冒险者不能通过在多个地点采摘一朵花来收集花束吗？

*   可能会有几个同名的房间（“地窖”、“街角”），即填充房间，它们增加了气氛，但对游戏没有任何意义。不过，他们没有得到自己的描述。如何让他们分开？

*   如果名称包含逗号怎么办？

*   最终，您会希望将 Unicode 用于外来名称或格式说明。

由于这是可能包含许多奇怪情况的结构化数据，因此我建议为此使用 XML：

```
<locations>
    <location>
        <name>Albus Square</name>
        <summary>Short description for returning adventurer</summary>
        <description>Long text here ... with formatting, etc.</description>
        <items>
            <item>Flowers</item>
            <item>Traffic Cone</item>
        <items>
        <directions>
            <north>Franklandclaw Lecture Theatre</north>
            <west>Library of Enchanted Books</west>
            <south>Furnesspuff College</south>
        </directions>
    </location>
    <location>
        <name>Library of Enchanted Books</name>
        <directions>
            <east>Albus Square</east>
            <up>Reading Room</up>
        </directions>
    </location>
</locations> 
```

这提供了更大的灵活性，解决了许多问题，如格式化描述文本、Unicode 字符等。此外，您可以通过使用 ID（数字）而不是文本来使用多个具有相同名称的项目/位置。

使用[JDom](http://www.jdom.org/)或[DecentXML](http://code.google.com/p/decentxml/)解析游戏配置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T13:20:20.787

同意 w/willcodejavaforfood，可以使用正则表达式，但在这里不是很大的推动力。

听起来你只需要一点算法帮助（下面是草率的 p 代码）......

```
currloc = null
while( line from file )
    if line begins w/ whitespace
        (dir, loc) = split( line, ", " )
        add dir, loc to currloc
    else
        newlocdata = split( line, ", " )
        currloc = newlocdata[0]
        for i = 1 to size( newlocdata ) - 1
            item = newlocdata[i]
            add item to currloc 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T13:22:10.440

我现在无法进入 Java 模式，所以这里有一些应该这样做的伪代码：

```
Data = MyString.split('\n\n++\s*+');

for ( i=0 ; i<Data.length ; i++ )
{
    CurLocation = Data[i].split('\n\s*+');

    LocationInfo = CurLocation[0].split(',\s*+');

    LocationName = LocationInfo[0];

    for ( n=1 ; n<LocationInfo.length ; n++ )
    {
        Items[n-1] = LocationInfo[n];
    }

    for ( n=1 ; n<CurLocation.length ; n++ )
    {
        DirectionInfo = LocationInfo[n].split(',\s*+');

        DirectionName = DirectionInfo[0];

        for ( x=1 ; x<DirectionInfo.length ; x++ )
        {
            DirectionLocation[x-1] = DirectionInfo[x];
        }

    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T13:11:39.587

你能改变数据的格式吗？这种格式很笨拙。我怀疑您正忙于重新发明方轮……这对我来说是“只使用 XML”。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-18T13:42:35.390

我认为使用 XML 是矫枉过正（用大炮射击麻雀），而正则表达式是“矫枉过正”（使用太弱的工具，用牙刷擦地板）。

正确的平衡听起来像是“.ini 格式”或“带有部分的邮件标题”。[对于 python，在http://docs.python.org/library/configparser.html](http://docs.python.org/library/configparser.html)有库文档。

一个简单的例子：

```
[albus_square]
name: Albus Square
items: Flowers, Traffic Cone
north: lecture_theatre
west: library_enchanted_books
south: furnesspuff_college 
```

我假设这种格式有一个 Java 库。正如另一位海报所指出的，您可能会遇到名称冲突，所以我冒昧地添加了一个“名称：”字段。方括号中的名称将是唯一标识符。

# c++ - 将 streambuf 的内容复制到字符串

> ID：877652
> 
> 赞同：37
> 
> 时间：2009-05-18T13:07:12.090
> 
> 标签：c++, string, boost, boost-asio, streambuf

显然`boost::asio::async_read`不喜欢字符串，因为唯一的重载`boost::asio::buffer`允许我创建`const_buffer`s，所以我坚持将所有内容读入 streambuf。
现在我想将 streambuf 的内容复制到一个字符串中，但它显然只支持写入 char* ( `sgetn()`)，使用 streambuf 创建一个 istream 并使用`getline()`.

有没有其他方法可以在不过度复制的情况下创建带有 streambufs 内容的字符串？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-05-18T14:42:34.520

我不知道它是否算作“*过度复制*”，但您可以使用字符串流：

```
std::ostringstream ss;
ss << someStreamBuf;
std::string s = ss.str(); 
```

就像，要将 stdin 中的所有内容读入字符串，请执行

```
std::ostringstream ss;
ss << std::cin.rdbuf();
std::string s = ss.str(); 
```

或者，您也可以使用`istreambuf_iterator`. 您将不得不衡量这种方式或上述方式是否更快 - 我不知道。

```
std::string s((istreambuf_iterator<char>(someStreamBuf)), 
               istreambuf_iterator<char>()); 
```

请注意，`someStreamBuf`上面的意思是表示 a `streambuf*`，因此请酌情取其地址。还要注意最后一个示例中第一个参数周围的附加括号，以便它不会将其解释为返回字符串并采用迭代器和另一个函数指针的函数声明（“最令人烦恼的解析”）。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2012-12-08T19:44:08.923

它**真的**隐藏[在文档](http://www.boost.org/doc/libs/1_52_0/doc/html/boost_asio/overview/core/buffers.html)中......

给定`boost::asio::streambuf b`，与`size_t buf_size`...

```
boost::asio::streambuf::const_buffers_type bufs = b.data();
std::string str(boost::asio::buffers_begin(bufs),
                boost::asio::buffers_begin(bufs) + buf_size); 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-05-19T15:22:12.163

另一种可能性`boost::asio::streambuf`是`boost::asio::buffer_cast<const char*>()`与`boost::asio::streambuf::data()`和`boost::asio::streambuf::consume()`这样结合使用：

```
const char* header=boost::asio::buffer_cast<const char*>(readbuffer.data());
//Do stuff with header, maybe construct a std::string with std::string(header,header+length)
readbuffer.consume(length); 
```

这不适用于普通的流缓冲区，并且可能被认为是脏的，但它似乎是最快的方法。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2012-10-17T12:07:16.880

因为`boost::asio::streambuf`您可能会找到这样的解决方案：

```
 boost::asio::streambuf buf;
    /*put data into buf*/

    std::istream is(&buf);
    std::string line;
    std::getline(is, line); 
```

打印出字符串：

```
 std::cout << line << std::endl; 
```

您可以在这里找到：http: [//www.boost.org/doc/libs/1_49_0/doc/html/boost_asio/reference/async_read_until/overload3.html](http://www.boost.org/doc/libs/1_49_0/doc/html/boost_asio/reference/async_read_until/overload3.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-07-01T10:13:33.500

也可以通过以下方式获取`asio::streambuf`字符`std::basic_streambuf::sgetn`：

```
asio::streambuf in;
// ...
char cbuf[in.size()+1]; int rc = in.sgetn (cbuf, sizeof cbuf); cbuf[rc] = 0;
std::string str (cbuf, rc); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-12T07:23:55.737

您只能从 std::string 创建 const_buffer 的原因是 std::string 在其合同中明确不支持直接基于指针的写入。你可以做一些邪恶的事情，比如将你的字符串调整到一定的大小，然后 const_cast 来自 c_str() 的常量并将其视为原始 char* 缓冲区，但这很顽皮，总有一天会给你带来麻烦。

我将 std::vector 用于我的缓冲区，因为只要向量不调整大小（或者您小心处理调整大小），您就可以直接写入指针就可以了。如果我需要一些数据作为 std::string，我必须将其复制出来，但是我处理读取缓冲区的方式，任何需要持续超出读取回调的内容都需要复制出来。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-03-20T21:26:21.410

我没有看到将 n 字符准确读入 a 的现有答案`std::stringstream`，因此可以这样做：

```
std::stringstream ss;
boost::asio::streambuf sb;
const auto len = 10;

std::copy_n(boost::asio::buffers_begin(sb.data()), len,
            std::ostream_iterator<decltype(ss)::char_type>(ss)); 
```

[编译器资源管理器](https://godbolt.org/z/oYeKb3)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-11-11T08:13:20.410

一个更简单的答案是将其转换为`std::string`并对其进行一些类似这样的操作

```
 std::string buffer_to_string(const boost::asio::streambuf &buffer)
 {
  using boost::asio::buffers_begin;
  auto bufs = buffer.data();
  std::string result(buffers_begin(bufs), buffers_begin(bufs) + buffer.size());
 return result;
} 
```

为任务提供非常简洁的代码。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-05-27T06:53:33.243

我大多不喜欢说“你不想要 X，你想要 Y，这是如何做 Y”的答案，但在这种情况下，我很确定我知道 tstenner 想要什么。

在 Boost 1.66 中，添加了[动态字符串缓冲区](https://www.boost.org/doc/libs/1_66_0/doc/html/boost_asio/reference/dynamic_string_buffer.html)类型，因此`async_read`可以直接调整大小并写入字符串缓冲区。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2016-06-24T02:42:19.110

我测试了第一个答案，并在使用“g++ -std=c++11”进行编译时出现编译器错误对我有用的是：

```
 #include <string>
        #include <boost/asio.hpp>
        #include <sstream>           
        //other code ...
        boost::asio::streambuf response;
        //more code
        std::ostringstream sline;
        sline << &response; //need '&' or you a compiler error
        std::string line = sline.str(); 
```

这编译并运行。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2009-05-18T14:56:43.010

我觉得更像是：

```
 streambuf.commit( number_of_bytes_read );

istream istr( &streambuf );
string s;
istr >> s; 
```

我没有查看`basic_streambuf`代码，但我相信这应该只是字符串的一个副本。

# visual-studio-2008 - Visual Studio 2008 中缺少代码分析

> ID：877659
> 
> 赞同：8
> 
> 时间：2009-05-18T13:08:43.867
> 
> 标签：visual-studio-2008

我刚刚在 Virtual PC 上安装了 Visual Studio 2008 来评估它，我想尝试的功能之一是代码分析。

但是我似乎在任何地方都找不到它，在[MSDN](http://msdn.microsoft.com/en-us/library/e05a02t4.aspx)上它说您可以右键单击一个项目并选择属性，然后从那里简单地启用它。但是我在任何地方都看不到这个选项。

起初我认为这可能是因为我转换了一个针对 .NET 2.0 的 2005 ASP.NET 项目但是作为测试我创建了一个虚拟 3.5 项目但仍然没有运气

有没有其他人遇到过这个？

编辑：我目前正在使用 Visual Studio 2008 SP1 并从事 VB.NET/ASP.NET 项目

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-18T13:12:03.237

代码分析仅在 Visual Studio 的团队系统版本中。所有其他人都只附带单元测试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T13:10:14.050

代码分析仅在[某些版本](http://www.microsoft.com/visualstudio/en-us/products/teamsystem/default.mspx#compare_products)中。

旧版本的代码分析 FxCop 仍可[免费下载](http://www.microsoft.com/Downloads/details.aspx?FamilyID=3389f7e4-0e55-4a4d-bc74-4aeabb17997b&displaylang=en)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T13:11:48.527

您正在评估专业版还是更大的（即团队系统）版本？据我所知，专业版和更小的版本根本不包含代码分析。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-25T18:07:19.297

似乎只从这些 Visual Studio 版本的 GUI 中删除了代码分析。
使用 Visual Studio Express 2008 时，项目文件包含 代码分析将针对相应项目配置运行 的部分下
`<PropertyGroup Condition=" '$(Configuration)|$(Platform)' == ...` 的行 。在我的机器上，这意味着 C:\Program Files (x86)\Microsoft Visual Studio 9.0\Team Tools\Static Analysis Tools\FxCop\FxCopCmd.exe 中的文件正在使用大量参数执行，并且其输出会自动定向到警告窗格。 因此，也许**FxCop**必须单独安装，但除此之外，即使**VS Express**似乎也支持代码分析工具。
**`<RunCodeAnalysis>true</RunCodeAnalysis>`**

 ****# wcf - 绑定在“双重模式”下不起作用（webHttpBinding 和 basicHttpBinding）

> ID：877669
> 
> 赞同：6
> 
> 时间：2009-05-18T13:10:55.000
> 
> 标签：wcf

我有一个 WCF 服务：

```
<%@ ServiceHost Language="C#" Debug="true" Service="IWW.MIGTurbo2.WCF.Security.SecurityBroker" Factory="System.ServiceModel.Activation.WebScriptServiceHostFactory"   %> 
```

使用我的网络项目中的 webHttpBinding 可以正常工作。

我还希望 WinForms 客户端可以使用此服务，因此添加了一个 basicHttpBinding 绑定。

我的服务器配置文件当前是：

```
<system.serviceModel>
<serviceHostingEnvironment aspNetCompatibilityEnabled="true" />
<behaviors>
    <endpointBehaviors>
        <behavior name="webScriptEnablingBehavior">
            <enableWebScript />
        </behavior>
        <behavior name="webHttpEnablingBehaviour">
            <webHttp />
        </behavior>
    </endpointBehaviors>
    <serviceBehaviors>
        <behavior name="webHttpEnablingBehaviour">
            <serviceMetadata httpGetEnabled="true" />
        </behavior>
        <behavior name="webScriptEnablingBehavior">
            <serviceMetadata httpGetEnabled="true" />
            <serviceDebug includeExceptionDetailInFaults="true" />
        </behavior>
    </serviceBehaviors>
</behaviors>
<services>
    <service name="IWW.MIGTurbo2.WCF.Security.SecurityBroker" behaviorConfiguration="webHttpEnablingBehaviour">
        <endpoint contract="IMetadataExchange" binding="mexHttpBinding" address="mex" />
        <!-- This works for web-clients -->
                    <endpoint address="" 
            binding="webHttpBinding"
            bindingConfiguration="default"
            contract="IWW.MIGTurbo2.WCF.Security.ISecurityBroker"
                behaviorConfiguration="webHttpEnablingBehaviour">
        </endpoint>
        <!-- This is for WinForms clients, but isn't working -->
                <endpoint address=""
            binding="basicHttpBinding"
            bindingConfiguration="default"
            contract="IWW.MIGTurbo2.WCF.Security.ISecurityBroker"
                behaviorConfiguration="webHttpEnablingBehaviour">
        </endpoint>
    </service>
</services>
<client />
<bindings>
    <webHttpBinding>
        <binding name="default" ></binding>
    </webHttpBinding>
    <basicHttpBinding> 
        <binding name="default" allowCookies="true"></binding>
    </basicHttpBinding>
</bindings> 
```

标记为 WinForms 的部分似乎不起作用。我得到一个例外：

> “ [http://localhost:56125/MIGTurbo2_WEB/api/wcf/SecurityBroker.svc](http://localhost:56125/MIGTurbo2_WEB/api/wcf/SecurityBroker.svc) ” 的端点没有与 None MessageVersion 的绑定。'System.ServiceModel.Description.WebHttpBehavior' 仅适用于 WebHttpBinding 或类似的绑定。

当我尝试使用 IE 手动浏览到 .svc 文件时。显然，WinForms 客户端不想知道。

任何人都可以解释为什么它不起作用吗？看起来好像我不能拥有多个端点，或者第二个端点配置不正确？谷歌没有提供任何特别有用的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T13:17:18.827

就像例外所说的那样，您的第二个端点具有 (1) webHttpBehavior 和 (2) basicHttpBinding，它们是不兼容的。我认为您可能只想从第二个端点删除 webHttpBehavior。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-18T14:43:01.367

**答案：**

（布赖恩明白了，但这就是详细的原因）

Visual Studio 已在客户端为我创建了一个“customBinding”元素，这并没有什么帮助。所以为了让它工作，我将我的客户端 app.config 更改为：

```
 <system.serviceModel>
    <bindings>
        <basicHttpBinding>
            <binding name="WebHttpBinding_ISecurityBroker" allowCookies="true" />
        </basicHttpBinding>     
    </bindings>
    <client>         
        <endpoint binding="basicHttpBinding" bindingConfiguration="WebHttpBinding_ISecurityBroker"
            contract="Client.API.WCF.ISecurityBroker" name="WebHttpBinding_ISecurityBroker" />
    </client>
</system.serviceModel> 
```

我的服务器端 web.config 是：

```
<system.serviceModel>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" />
    <behaviors>
        <endpointBehaviors>

            <behavior name="webHttpEnablingBehaviour">

                <webHttp />
            </behavior>
        </endpointBehaviors>
        <serviceBehaviors>

            <behavior name="webHttpEnablingBehaviour">
                <serviceMetadata httpGetEnabled="true" />
            </behavior>

        </serviceBehaviors>
    </behaviors>
    <services>
        <service
          name="IWW.MIGTurbo2.WCF.Security.SecurityBroker" behaviorConfiguration="webHttpEnablingBehaviour">
            <endpoint contract="IMetadataExchange" binding="mexHttpBinding" address="mex" />

            <endpoint address="" 
                binding="webHttpBinding"
                bindingConfiguration="default"
                contract="IWW.MIGTurbo2.WCF.Security.ISecurityBroker"
                behaviorConfiguration="webHttpEnablingBehaviour">
            </endpoint>
            <endpoint address="other"
                binding="basicHttpBinding"
                bindingConfiguration="default"
                contract="IWW.MIGTurbo2.WCF.Security.ISecurityBroker">
            </endpoint>
        </service>

    </services>
    <client />
    <bindings>
        <webHttpBinding>
            <binding name="default" ></binding>
        </webHttpBinding>
        <basicHttpBinding> 
            <binding name="default" allowCookies="true"></binding>
        </basicHttpBinding>
    </bindings>
</system.serviceModel> 
```

我有以下代码可以在我的客户端应用程序（WinForms）中连接：

```
using (SecurityBrokerClient securityBrokerClient = new SecurityBrokerClient())
        {
            string securityBrokerUrl=url+"api/wcf/SecurityBroker.svc";
            securityBrokerUrl += "/other";
            securityBrokerClient.Endpoint.Address = new System.ServiceModel.EndpointAddress(securityBrokerUrl);
            securityBrokerClient.Open();
            securityBrokerClient.Login(username, password, "MIGTurbo2Admin");
        } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-30T10:26:19.187

我在您的配置文件中看到的第一个也是最重要的问题是端点配置。

```
<endpoint address="" binding="webHttpBinding"  bindingConfiguration="default"
          contract="IWW.MIGTurbo2.WCF.Security.ISecurityBroker"
          behaviorConfiguration="webHttpEnablingBehaviour">
 </endpoint>

            <!-- This is for WinForms clients, but isn't working -->

 <endpoint address="" binding="basicHttpBinding" bindingConfiguration="default"
            contract="IWW.MIGTurbo2.WCF.Security.ISecurityBroker"
             behaviorConfiguration="webHttpEnablingBehaviour">
 </endpoint> 
```

这里我们没有在标签中指定任何地址和listenuri。因此，我们将为这些设置默认值，对于 2 个端点，我们将拥有相同的地址和相同的 listenuri（即默认值）。

所以问题来了。1.我们不能有不同类型的绑定相同的listenuri和相同的地址。但是在您的情况下，当您为地址指定空值时，两个端点都将具有相同的值

解决方案： 1\. 为两个端点指定不同的地址，而不是将它们留空。

```
<endpoint address="Rest" binding="webHttpBinding"  bindingConfiguration="default"
          contract="IWW.MIGTurbo2.WCF.Security.ISecurityBroker"
          behaviorConfiguration="webHttpEnablingBehaviour">
 </endpoint>

            <!-- This is for WinForms clients, but isn't working -->

 <endpoint address="WebForm" binding="basicHttpBinding" bindingConfiguration="default"
            contract="IWW.MIGTurbo2.WCF.Security.ISecurityBroker"
             behaviorConfiguration="webHttpEnablingBehaviour">
 </endpoint> 
```

因此，即使我们使用不同的绑定和相同的listenuri（如果我们不指定listenuri，它将是默认值），因为地址（相对地址）值不同，它也会正常工作。

# mysql - MySQL：使用不存在数据的占位符初始化汇总表

> ID：877679
> 
> 赞同：0
> 
> 时间：2009-05-18T13:12:30.037
> 
> 标签：mysql, stored-procedures, triggers

我会尽量笼统地给出这个，以便它可以重复使用。

我正在运行一个具有相当大的 MySQL 数据库的站点，该数据库已经发展到需要初始化一些摘要/汇总表。为了这个例子，假设它是足球统计数据。由于我在同一个数据库中处理多个足球联赛，因此他们中的许多人会玩不同长度的比赛——例如，室内足球联赛会进行四节比赛，而大多数户外联赛会进行半场比赛。

我有三个对这个练习很重要的表。我已经编辑了所有我认为对我正在寻找的答案不重要的字段。

```
GAME
`game`.id
`game`.home_team_id
`game`.away_team_id
`game`.number_of_periods

GOAL 
// Records for each goal scored in the game   
`goal`.id
`goal`.game_id
`goal`.team_id
`goal`.period_number
`goal`.player_id
`goal`.assist_player_id

PERIOD_SUMMARY
`period`.id
`period`.game_id
`period`.team_id
`period`.number
`period`.goals_scored 
```

最终，无论是否进球，我都应该在时间段汇总表中记录每个时间段的记录。该表只需要初始化一次，因为通过游戏创建触发器添加适当的零填充记录并触发插入/更新请求以更新 period_summary 表是相当容易的。

对我来说，将所有目标分组并使用 SUM() 初始化期间汇总表也相当容易，但我在想出一种有效的方法来“填充”任何没有进球得分为 0。

我想弄清楚的是它是否更容易/更有效：

1.  编写触发器并用 0 填充值预填充整个 period_summary 表，然后运行我已经知道的查询以更新进球得分期间的相应记录。
2.  使用其他方法（可能是临时存储过程？），它只会在目标表中没有匹配项的地方填充 0 记录。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-14T19:18:43.557

您已经有一个占位符。*SQL 中的“未知*数据占位符”为空。

您不需要预先填充任何内容：或者您有一行包含未知值 (null) 的某些列，或者您根本没有行，因此执行外部连接将得到一个全为 null 的行。无论哪种方式，*属性数据*（本质上是非 id 字段）都将为空。

并且`sum()`聚合将忽略空值。

因此，假设您*确实*有一个游戏行（因为它是预先安排好的），但它的周期没有相应的行（因为它们还没有被玩过）。然后你做一个外连接形式的游戏来周期（外部，这样你就包括了*有*和*没有*的游戏，周期数据）：

```
select a.*, sum(b.goals_scored)
from game a left outer join period b on (b.game_id = a.id)
group by a.id; 
```

这会按比赛向您显示（两支球队的）总进球数；对于没有句点的游戏，您会返回 null（这意味着在 SQL 中，“我们（尚）不知道”）

此查询仅向您显示已完成游戏*和正在进行的游戏的总目标（至少玩过一个时段的游戏）*：

```
select a.*, sum(b.goals_scored)
from game a join period b on (b.game_id = a.id)
group by a.id; 
```

此视图过滤掉不完整的游戏（假设您总是在后期添加早期阶段）：

```
create view complete_games as
select a.* from games a
where exists (select * from period b 
where b.game_id = a.id and b.number = a.number_of_periods) 
```

使用该视图，我们可以只总结已完成的游戏：

```
select a.*, sum(b.goals_scored)
from complete_games a join period b on (b.game_id = a.id)
group by a.id; 
```

所以，不需要预填，不需要触发器，最重要的是，不需要添加虚假数据（实际上该时段还没有播放时声称零进球），不需要用正确的数据更新。只需插入有数据的时间段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-14T17:35:35.310

ISTM 认为选项 1 显然更容易：如果您可以相信计数器已经存在，您已经知道如何增加计数器。假设您将使用选项 2，不仅更难以填充缺少的零（我认为这应该在期末发生），您还必须找到一种方法以 1 开始计数器，如果没有以前的条目，第一个进球得分。

至于空间效率：最终，无论哪种方式，您都需要相同的磁盘空间。只在周期结束时填充零会稍微更有效，但无论如何，完成周期占用的空间肯定大于运行周期的空间。

至于插入/更新效率：无论哪种方式得分，您都需要执行查找，因为可能已经有一个非零计数器。因此，您需要创建一个索引，以允许按游戏、团队和时期进行高效查找。鉴于总是进行更新的查询更短，很有可能它也更有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-14T20:42:35.913

您知道可以设置列的默认值吗？使用默认关键字。

前任。：

CREATE TABLE Person ( age INT DEFAULT 0, name VARCHAR(35) DEFAULT 'Bob' )

The default value will be what you want (0 for instance) instead of null.

It doesn't solve everything but it will help.

# windows - 如何在不关闭 UAC 的情况下从资源管理器拖动到 Visual Studio？

> ID：877688
> 
> 赞同：3
> 
> 时间：2009-05-18T13:14:07.833
> 
> 标签：windows, uac

肯定有一个设置可以阻止愚蠢的 UAC 问题阻止我的拖放操作。Visual Studio 必须在管理模式下运行我所做的一半事情，而 Explorer 不应该仅仅为了解决这个问题而在一些花哨的管理模式下运行。

我只是想告诉 UAC 正常做它的事情，但在干扰我的拖放操作时就走开。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-08-15T13:37:18.160

禁用该选项：

控制面板 > 管理工具 > 本地安全策略 > 本地策略 > 安全选项 > 用户帐户控制：仅提升安装在安全位置的 UIaccess 应用程序

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T13:19:05.297

我认为这个问题源于VS以管理权限运行，并且您的拖放操作作为普通用户（您）运行。解决此问题的最简单方法可能是禁用 UAC，但也许有更优雅的解决方案......

# quickbooks - QuickBooks发票修改与创建地址行为不同，如何补偿？

> ID：877689
> 
> 赞同：2
> 
> 时间：2009-05-18T13:14:23.607
> 
> 标签：quickbooks, invoice, qbxml

我正在编写一个函数来以定义的格式获取发票文件并通过 qbXML 将其导入 QuickBooks。其中一项要求是可以重新导入相同的发票编号，而不是修改现有发票，而不是创建具有相同编号的新发票。

我遇到的问题是 QuickBooks 如何处理地址。我得到的地址可以是任何格式（在 6 种不同的内容中），但不保证遵守该语言环境的正确地址格式。

所以创建发票很简单，我在 xml 标签中指定帐单地址 addr1 到 addr5，QuickBooks 没有问题。**但是**，它不会将地址存储为原始文本，它会尝试解析出城市、州邮政编码和国家/地区。

发票修改，给定相同的地址信息，不会解析出城市州和邮政编码，而是保持地址行不变，城市国家和邮政编码保持不变，在发票上创建重复行，自由格式文本之一，城市、州和邮政编码的组合。解决方法是明确设置城市国家邮政编码国家并在发票修改时注意空白。然而，这并没有完全解决问题。

有时 QuickBooks 会正确解析地址并在下一行添加一个随机数（内部表示在注释选项卡上）。

有时 QuickBooks 会拒绝该地址，甚至认为它在创建时接受了它。我假设因为它试图解析一个 5 行地址并进行修改，因为城市状态和邮政编码无处可去，它没有地方存储它们。

现在我唯一的解决方案是简单地保持地址不变，并告诉用户由于 QuickBooks 的限制，无法在重新导入发票时修改地址，只能修改发票行。

以前有没有人遇到过这个问题，如果是这样，你有更好的解决方法吗？您是否知道地址解析器可以合理地近似快速手册的功能，以便我可以在创建时以一致的方式发送城市状态和邮政编码？

现在，在某种程度上（除了最后一个）QuickBooks 给了我一个回复，告诉我它在创建时解析了什么，所以我理论上可以存储它以知道我正在处理什么，但没有编写一些耗时的地址解析例程是否有任何解决方案可以让快速手册重新解析新地址。

这是请求和响应。请注意，发票创建是相同的，并且我删除了一些识别信息，但保持字段长度相同。

要求：

```
<?xml version="1.0" encoding="UTF-8"?>  <?qbxml version="7.0"?>
<QBXML>
<QBXMLMsgsRq newMessageSetID="243f42acf4011139b7a" onError="stopOnError">
    <InvoiceModRq>
        <InvoiceMod>
            <TxnID>4E64-1242411202</TxnID>
            <EditSequence>1242411202</EditSequence>
            <CustomerRef>
                <ListID>80000012-1242156814</ListID>
            </CustomerRef>
            <ARAccountRef>
                <FullName>Accounts Receivable</FullName>
            </ARAccountRef>
            <TxnDate>2009-04-01</TxnDate>
            <RefNumber>M-053491</RefNumber>
            <BillAddress>
                <Addr1>S &amp; S ACME CO., INC.</Addr1>
                <Addr2>MR. ABC ABCDEF</Addr2>
                <Addr3>981 ABCD 761 ST</Addr3>
                <Addr4>ABABC, AA 99999-3584</Addr4>
                <Addr5>USA</Addr5>
                <City/>
                <State/>
                <PostalCode/>
                <Country/>
                <Note/>
            </BillAddress>
            <TermsRef>
                <FullName>NET 30</FullName>
            </TermsRef>
            <DueDate>2009-05-01</DueDate>
            <InvoiceLineMod>
                <TxnLineID>-1</TxnLineID>
                <Desc/>
            </InvoiceLineMod>
            <InvoiceLineMod>
                <TxnLineID>-1</TxnLineID>
                <Desc>ABCDEFG ABC $3,000.00 *</Desc>
            </InvoiceLineMod>
            <InvoiceLineMod>
                <TxnLineID>-1</TxnLineID>
                <Desc/>
            </InvoiceLineMod>
            <InvoiceLineMod>
                <TxnLineID>-1</TxnLineID>
                <Desc>FOR:</Desc>
            </InvoiceLineMod>
            <InvoiceLineMod>
                <TxnLineID>-1</TxnLineID>
                <ItemRef>
                    <FullName>ANFEE</FullName>
                </ItemRef>
                <Desc>1 . #9999 S &amp; S ABCD CO., INC., ABCDE, AA *</Desc>
                <Amount>123456.72</Amount>
            </InvoiceLineMod>
            <InvoiceLineMod>
                <TxnLineID>-1</TxnLineID>
                <Desc/>
            </InvoiceLineMod>
            <InvoiceLineMod>
                <TxnLineID>-1</TxnLineID>
                <Desc>PLEASE NOTE: Blahh Someone sellificant repeats on July 31st, 2009.</Desc>
            </InvoiceLineMod>
            <InvoiceLineMod>
                <TxnLineID>-1</TxnLineID>
                <Desc>Sellifcan of your Someone Ssellificant to Jan. 31st, 2011 is contingent upon</Desc>
            </InvoiceLineMod>
            <InvoiceLineMod>
                <TxnLineID>-1</TxnLineID>
                <Desc>your satisfying all open invoices and all other/different issues.</Desc>
            </InvoiceLineMod>
            <InvoiceLineMod>
                <TxnLineID>-1</TxnLineID>
                <Desc/>
            </InvoiceLineMod>
            <InvoiceLineMod>
                <TxnLineID>-1</TxnLineID>
                <Desc/>
            </InvoiceLineMod>
            <InvoiceLineMod>
                <TxnLineID>-1</TxnLineID>
                <Desc>* PLUS expenses for some amount of service described here.</Desc>
            </InvoiceLineMod>
        </InvoiceMod>
    </InvoiceModRq>
</QBXMLMsgsRq>
</QBXML> 
```

回复：

```
 <?xml version="1.0" ?> <QBXML>
<QBXMLMsgsRs newMessageSetID="243f42acf4011139b7a">
<InvoiceModRs statusCode="3210" statusSeverity="Error"
              statusMessage="The &quot;address&quot; field has an invalid value &quot;&quot;.  QuickBooks error message: The parameter is incorrect. "/>
</QBXMLMsgsRs>
</QBXML> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-03T16:37:57.390

另一个潜在的解决方法是双重更新发票。先把地址填空。其次是发送五行，而无需提及城市状态 zip 等，就像在创建时所做的那样。

我没有测试这个（用户接受地址不会改变，所以我不打算尝试），但我把这个作为一个想法，所以如果有人有类似的问题，他们可以试试如果可行，也许在这里发表评论。

# opengl - 适合视口的 3d 模型

> ID：877690
> 
> 赞同：0
> 
> 时间：2009-05-18T13:14:49.860
> 
> 标签：opengl

3D 模型如何处理单元？
当我有一个随机模型要适合我的视口时，我不知道它是否太大，如果我需要将它翻译到中间......
我认为一个 3d 对象可能有它自己的起源。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T13:34:55.280

您需要为您的对象找到比对象本身更易于使用的包围体，即包围对象所有顶点的形状。球体通常用于此目的。艺术家可以将球体定义为模型信息的一部分，或者您可以在运行时对其进行处理。计算最佳球体非常困难，但您可以使用以下方法获得一个很好的近似值：

```
determine the min and max value of each point's x, y and z
  for each vertex
    min_x = min (min_x, vertex.x)
    max_x = max (max_x, vertex.x)
    min_y = min (min_y, vertex.y)
    max_y = max (max_y, vertex.y)
    min_z = min (min_z, vertex.z)
    max_z = max (max_z, vertex.z)

sphere centre = (max_x + min_x) / 2, (max_y + min_y) / 2, (max_z + min_z) / 2
sphere radius = distance from centre to (max_x, max_y, max_z) 
```

使用这个球体，确定一个可以完整查看球体的世界位置 - 简单的几何图形将确定这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T13:32:19.390

对不起，你的问题很不清楚。我想您想将 3D 模型居中到视口。您可以通过计算模型的边界框来实现这一点。为此，遍历所有多边形并获取最小/最大 X/Y/Z 坐标。`(min_x,min_y,min_z)`由点给出的边界框`(max_x,max_y,max_z)`将包含整个模型。现在您可以通过查看此框的中心来使模型居中。通过一些进一步的计算（取决于您的 FOV），您还可以获得视口内的左/右/上/下边界。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-18T16:15:44.897

“所以我试着缩小它”

在这种情况下最好的办法是根本不改变你的模型！就这样吧。你要改变的是你的相机。

首先在 3D 空间的某处计算模型的边界框。

接下来通过取最大值（aabb.max.x-aabb.min.x, aabb.max.y-aabb.min.y, aabb.max.z-aabb.min.z）来计算它的半径。它很粗糙，但它可以完成工作。

要在视口中居中对象，请将相机放置在对象位置。如果 Y 是您的前向轴，则从 Y 中减去半径。如果 Z 是前向轴，则从中减去半径。减去一个软糖因素，让你越过讨厌的近平面，这样你的模型就不会被剪掉。我在我的引擎中使用四元数和一个不错的lookat() 方法。所以调用lookat() 并传入边界框的中心。瞧！您的对象在视口中居中，无论它在世界的哪个位置。

这总是将相机轴对齐，因此您可能想要花哨并将相机转换为模型空间，减去半径，然后再次查看中心。然后你总是看着模型的背面。关键始终是lookat()。

这是我的引擎中的一些示例代码。它会检查我们是否正在尝试构建一大块静态地形，如果是的话，从高处、灯光或静态网格体向下看。视觉是在场景中绘制的任何东西，有几十种不同的类型。Visual::Instance 是视觉对象的副本，或者是在哪里绘制它。

```
void EnvironmentView::frameSelected(){
  if( m_tSelection.toInstance() ){
    Visual::Instance& I = m_tSelection.toInstance().cast();
    Visual* pVisual = I.toVisual();
    if( pVisual->isa( StaticTerrain::classid )){
      toEditorCamera().toL2W().setPosition( pt3( 0, 0, 50000 ));
      toEditorCamera().lookat( pt3( 0 ));
    }else if( I.toFlags()->bIsLight ){
      Visual::LightInstance& L = static_cast<Visual::LightInstance&>( I );
      qst3& L2W = L.toL2W();
      const sphere s( L2W.toPosition(), L2W.toScale() );
      const f32 y =-(s.toCenter()+s.toRadius()).y();
      const f32 z = (s.toCenter()+s.toRadius()).y();
      qst3& camL2W = toEditorCamera().toL2W();
      camL2W.setPosition(s.toCenter()+pt3( 0, y, z ));//45 deg above
      toEditorCamera().lookat( s.toCenter() );
    }else{
      Mesh::handle hMesh = pVisual->getMesh();
      if( hMesh ){
        qst3& L2W = m_tSelection.toInstance()->toL2W();
        vec4x4 M;
        L2W.getMatrix( M );
        aabb3 b0 = hMesh->toBounds();
        b0.min = M * b0.min;
        b0.max = M * b0.max;
        aabb3 b1;
        b1 += b0.min;
        b1 += b0.max;
        const sphere s( b1.toSphere() );
        const f32 y =-(s.toCenter()+s.toRadius()*2.5f).y();
        const f32 z = (s.toCenter()+s.toRadius()*2.5f).y();
        qst3& camL2W = toEditorCamera().toL2W();
        camL2W.setPosition( L2W.toPosition()+pt3( 0, y, z ));//45 deg above
        toEditorCamera().lookat( b1.toOrigin() );
      }
    }
  }
} 
```

# wpf - 自动更新 wpf 中的列表

> ID：877695
> 
> 赞同：0
> 
> 时间：2009-05-18T13:15:40.390
> 
> 标签：wpf, data-binding, listbox, inotifypropertychanged

我想显示一堆我在 ListBox 中创建的对象。我的对象实现了 INotifyPropertyChanged 接口。我尝试使用 ObservableCollection，我已将其绑定到列表框控件 (listbox1.DataContext = MyCollection) 但这并不完全是我想要做的，因为当我的一个对象的属性之一在MyCollection 更改。我发现了这篇博文：http: [//sweux.com/blogs/psampaio/index.php/2009/04/13/creating-a-custom-observable-collection-in-wpf](http://sweux.com/blogs/psampaio/index.php/2009/04/13/creating-a-custom-observable-collection-in-wpf)

这真的是跟踪多个对象的最简单/唯一的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T14:26:40.073

我不确定，但您是否尝试过为列表框项目使用数据模板？比如，一个将其文本显式设置为适当绑定的文本框。

# c++ - 向量中元素的默认构造

> ID：877699
> 
> 赞同：5
> 
> 时间：2009-05-18T13:16:27.300
> 
> 标签：c++, stl, default-constructor, built-in-types

在阅读这个[问题](https://stackoverflow.com/questions/877385/dynamically-allocating-and-setting-to-zero-an-array-of-floats)的答案时，我对向量中对象的默认构造产生了疑问。为了测试它，我编写了以下测试代码：

```
struct Test
{
    int m_n;

    Test(); 

    Test(const Test& t);

    Test& operator=(const Test& t);
};

Test::Test() : m_n(0)
{
}

Test::Test(const Test& t)
{
    m_n = t.m_n;
}

Test& Test::operator =(const Test& t)
{
    m_n = t.m_n;
    return *this;
}

int main(int argc,char *argv[])
{
    std::vector<Test> a(10);
    for(int i = 0; i < a.size(); ++i)
    {
        cout<<a[i].m_n<<"\n";
    }

    return 0;
} 
```

果然，在创建向量对象时调用了 Test structs 默认构造函数。但我无法理解的是 STL 如何初始化我创建基本数据类型向量的对象，例如整数向量，因为它有默认构造函数？即向量中的所有整数如何具有值0？不应该是垃圾吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-18T13:19:47.183

它使用等效于 int 的默认构造函数，即将它们初始化为零。你可以明确地做到这一点：

```
int n = int(); 
```

将 n 设置为零。

请注意，仅在给定向量初始大小时才使用和需要默认构造。如果你说：

```
vector <X> v; 
```

不要求 X 具有默认构造函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T13:27:16.387

```
std::vector<Type> a(10);        // T could be userdefined or basic data type 
```

Vector 基本上要求`default`它指向的类型： `Type()`

*   如果是基本数据类型，如 int, double 则 int(), double() { int() 将得到值 0}
*   如果用户定义的数据类型，则默认构造函数将被调用。

# c# - 在 C#.Net 中解析包含“&”字符的命令行参数时出现问题

> ID：877701
> 
> 赞同：1
> 
> 时间：2009-05-18T13:18:12.443
> 
> 标签：c#, command-line

我在 VisualStudio 2008 环境中工作并在 C#.Net 中开发命令行应用程序。应用程序期望从命令行参数传递路径。我通过在项目设置的调试选项中设置“命令行参数”将这些参数传递给我的应用程序。我提供的参数是 -> "D:\Test\C&ID\Test data\a.dbf"

```
class Program
{
    static int Main(string[] args)
    {
        Console.WriteLine(args[0]);
        return 0; 
    }
} 
```

如果我使用 F5 运行程序，它工作正常。问题是当我使用 ctrl+F5 时。`args[0]`包含_

`D:\Test\C^&ID\Test data\a.dbf`

代替

`D:\Test\C&ID\Test data\a.dbf`.

我无法理解为什么 '&' 前面有一个 '^' 符号。此外，我的路径验证因此失败。谁能给我解释一下。（请注意，提供的参数用双引号括起来，其中一部分包含“&”字符）我想我已经解释了我的问题:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T13:30:35.897

只是检查一下——你知道每个配置都有一组不同的命令行参数，对吧？

因此调试配置 (F5) 中的命令行参数可能与发布配置 (ctrl+F5) 中的参数不同。

# drupal - Drupal vote_up_down 模块报告不正确的点

> ID：877704
> 
> 赞同：2
> 
> 时间：2009-05-18T13:18:52.957
> 
> 标签：drupal, drupal-6

我正在使用 Drupal 6（目前为 6.11，尚未升级到 6.12）开发一个项目，部分核心功能是对节点进行投票的能力。我有一些相当奇怪的行为，这让我花了很长时间去追查，现在我有，我仍然无法解决它。

到目前为止，这是我设法弄清楚的：

*   模板文件`sites/default/modules/vote_up_down/theme/vote_up_down_points.tpl.php`自动`template_preprocess_vote_up_down_points()`从`vote_up_down.module`.
*   `vote_up_down.module`然后使用存储在`$variables`传递给它的数组中的值查询数据库
*   在典型节点（在本例中为论坛帖子）上调用的 3 次中只有*一次*`$variables`没有`$variables['cid']`.
*   那一次是当它读取分数以便将其显示在帖子本身下方时。而且，它不是定位当前帖子的分数，而是定位第*一个投票的*帖子的分数。（这是因为它不是返回一个帖子的分数，而是返回所有帖子的分数，然后使用列表中的第一个）。

我假设这`$variables`是一个系统范围的常量（查看它的内容`print_r`似乎可以证实这一点），所以这可能是一个核心错误，因为它应该总是相同的。我检查了`$variables`大约 50 个部分的内容，其中只有 4 个部分与不起作用的部分不同：cid - 空白，标签 - 空白（尽管这是由函数发现并正确替换为“投票”）， zebra - even & id - 2\. 我想最后 2 对此并不重要，所以关键必须是为什么`$variables['cid']`没有被通过。

所以，我的问题是：

*   以前有没有人遇到过这个问题，你是如何解决的？
*   如果没有，您对我如何弄清楚为什么它不能正常工作有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T01:58:29.117

我不能告诉你答案，但你可能会更幸运地将它发布到模块的问题队列中，因为那时维护者和其他使用它的人会看到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T13:14:06.190

我不敢相信我之前没有尝试过，但是我刚刚升级到 vote_up_down 的最新开发快照，问题就消失了。最终修复了 2 分钟，而试图解决问题则需要大约 6 小时。

学习到教训了！

# python - 我应该如何从 with 语句中返回有趣的值？

> ID：877709
> 
> 赞同：8
> 
> 时间：2009-05-18T13:20:15.077
> 
> 标签：python, with-statement, contextmanager

有没有比使用全局变量从上下文管理器获取有趣值更好的方法？

```
@contextmanager
def transaction():
    global successCount
    global errorCount
    try:
        yield
    except:
        storage.store.rollback()
        errorCount += 1
    else:
        storage.store.commit()
        successCount += 1 
```

其他可能性：

*   ### 单身人士

    某种全球性的...

*   ### 元组作为上下文管理器的参数

    使功能更具体地解决问题/减少可重用性

*   ### 将特定属性作为上下文管理器的参数保存的实例

    与元组相同的问题，但更易读

*   ### 在保存值的上下文管理器末尾引发异常。

    真是个坏主意

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-18T13:31:38.547

请参阅[http://docs.python.org/reference/datamodel.html#context-managers](http://docs.python.org/reference/datamodel.html#context-managers)

创建一个包含成功和错误计数并实现`__enter__`和`__exit__`方法的类。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-18T13:49:53.940

我仍然认为您应该创建一个类来保存错误/成功计数，正如我在[上一个问题](https://stackoverflow.com/questions/877440/try-except-except-how-to-avoid-repeating-code)中所说的那样。我猜你有自己的课程，所以只需添加这样的内容：

```
class transaction:
    def __init__(self):
        self.errorCount = 0
        self.successCount = 0  

    def __enter__(*args):
        pass  

    def __exit__(self, type, value, traceback):
        if type:
            storage.store.rollback()
            self.errorCount += 1
        else:
            storage.store.commit()
            self.successCount += 1 
```

（`type`如果在调用 时没有异常，则为 None `contextmanager`）

然后您可能已经在某处使用它，它将调用`contextmanager`并运行您的`__exit__()`代码。 **编辑：**正如 Eli 评论的那样，仅当您想要重置 coutners 时才创建一个新的事务实例。

```
t = transaction()
for q in queries:
    with t:
        t.execute(q) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T14:21:02.427

"元组作为上下文管理器的参数

使功能更具体地解决问题/减少可重用性”

错误的。

这使得上下文管理器保持状态。

如果你没有实现更多的东西，它将是可重用的。

但是，您实际上不能使用元组，因为它是不可变的。你需要一些可变的集合。我想到了字典和类定义。

因此，推荐的实现是

“将特定属性作为上下文管理器的参数保存的实例”

您只需要一个具有两个属性的简单类定义。但是，您的交易状态是有状态的，您需要在某处保留状态。

```
class Counters(dict):
    SUCCEED= 0
    FAIL= 1
    def __init__( self ):
        self[ self.SUCCEED ]= 0
        self[ self.FAIL ]= 0 
    def increment( self, status ):
        self[status] += 1

class Transaction(object):
    def __init__( self, worker, counters ):
        self.worker= worker
        self.counters= counters
    def __enter__( self ):
        self.counters.status= None
    def process( self, *args, **kw ):
        status= self.worker.execute( *args, **kw )
        self.counters.increment( status )
    def __exit__( self ):
        pass

counts= Counters()
for q in queryList:
    with Transaction(execQuery,counts) as t:
        t.process( q )
print counts 
```

# asp.net-mvc - ASP.NET MVC: HTTPContext and Dependency Injection

> ID：877712
> 
> 赞同：18
> 
> 时间：2009-05-18T13:20:24.810
> 
> 标签：asp.net-mvc, dependency-injection, structuremap, httpcontext

Currently I have an ActionFilter that gets the current users name from HttpContext and passes it into the action which uses it on a service method. eg:

```
Service.DoSomething(userName); 
```

I now have a reason to do this not at the action level but the controller constructor level. Currently I'm using structure map to create controllers and inject the service. I'm looking at something like:

```
public interface IUserProvider
{
    string UserName { get; }
}

public class HttpContextUserProvider : IUserProvider
{
    private HttpContext context;

    public HttpContextUserProvider(HttpContext context)
    {
        this.context = context;
    }

    public string UserName
    {
        get
        {
            return context.User.Identity.Name;
        }
    }
} 
```

That said, my IoC foo is really weak as this is the first project I've used it on.

So my question is... how can I tell structure map to pass in HttpContext in the constructor for HttpContextUserProvider? This just seems weird... I'm not sure how to think of HttpContext.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-08T14:10:23.300

It sounds like you should be using `HttpContextBase` instead of `HttpContextUserProvider`. This is a out-of-box abstraction of `HttpContext` and allows you to create a mock, write UnitTests and inject your dependencies.

```
public class SomethingWithDependenciesOnContext
{
    public SomethingWithDependenciesOnContext(HttpContextBase context) {
        ...
    }

    public string UserName
    {
        get {return context.User.Identity.Name;}
    }
}

ObjectFactory.Initialize(x => 
          x.For<HttpContextBase>()
          .HybridHttpOrThreadLocalScoped()
          .Use(() => new HttpContextWrapper(HttpContext.Current)); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-18T16:34:08.540

Have an interface abstract `HttpContext.Current`. Expose only the methods you need. `GetUserName()` would call `HttpContext.Current.User.Identity.Name` in the implementation, for example. Make that as thin as possible.

Take that abstraction and inject it into your other provider class. This will allow you to test the provider by mocking the http context abstraction. As a side benefit, you can do other nifty things with that `HttpContext` abstraction besides mock it. Reuse it, for one thing. Add generic type params to bags, etc.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-18T15:42:01.017

I'm not sure why you're bothering. It seems like just using HttpContext.Current directly in HttpContextUserProvider is the right thing to do. You're never going to be substituting in a different HttpContext...

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-18T14:44:04.017

# c# - Oracle 和外部应用程序之间的数据集成？

> ID：877716
> 
> 赞同：0
> 
> 时间：2009-05-18T13:21:06.167
> 
> 标签：c#, oracle, integration, oracle-fusion-middleware

*我们有一个应用程序需要某些 HR（人力资源）数据（例如员工表等）来启动它所使用的手动和自动化工作流程。*

*好吧，我正在研究与 Oracle 数据集成或同步的方法，假设我有一个新客户，他有一个叫做“Oracle HR”的东西，他们说我们会购买你的应用程序，但我们需要你将它与我们的 Oracle HR 系统集成.*

我们的应用程序使用 .NET C#。如何与 Oracle 集成？

**1\. oracle 中是否有任何 Web 服务可以公开我可以轮询和获取并放入我的应用程序数据库的数据？**

**1\. 还是我必须要求他们为我提供一个可以以视图形式访问数据的用户，以便我可以通过 ADO.NET 或任何其他适配器连接并获取数据？**

**2\. 用外行的开发人员术语来说，Oracle 融合中间件到底是什么？能用还是炒作？**

*任何在企业中两种或一种方式的数据集成领域有经验的人都可以解释一下吗？提前致谢。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T18:24:59.890

如果数据模型足够简单（应该是 HR 的东西），那么我会选择连接到 Oracle Schema 并使用数据。

# asp.net - Windows 身份验证仅适用于主机条目

> ID：877717
> 
> 赞同：1
> 
> 时间：2009-05-18T13:21:19.350
> 
> 标签：asp.net, iis

我正在建立一个（ASP.NET）网站，供我公司内部使用。在 IIS 中，我打开了集成 Windows 身份验证并关闭了匿名访问。完成此操作后，每当您访问该网站时，该网站都会弹出“输入您的用户名/密码”框，但即使用户名/密码正确，您也不会登录。即使您使用域帐户而不是本地帐户登录计算机，也会发生这种情况。

但是，如果我在我的 hosts 文件中输入该站点的 IP，则该站点可以完美运行（无需额外挑战即可登录用户）。

我想我有两个问题。

1）为什么hosts条目有这个影响？

2) 我怎样才能让网站成功而不 a) 强迫每个人编辑他们的主机文件或 b) 网站挑战他们并且未能登录？

**编辑：**我检查了，我们确实设置了 DNS 服务器，以将这些 URL 指向正确的服务器。这就是 ping URL 显示正确 IP 的原因。但是，似乎除了具有该 DNS 条目外，我们还必须具有主机文件条目才能使站点正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T17:40:57.843

您可能遇到了 Kerberos 身份验证问题。

由于您使用的是 Site.DomainName.com 的 url，我假设 DomainName.com 也是您的广告名称。

在运行 IIS 的服务器上，从资源工具包工具中复制 SetSPN.EXE 并运行以下命令：

```
setspn -A http/site.domainname.com IISServerName 
```

其中 SITE 是您的 URL，IISServerName 是服务器的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T13:45:34.090

这听起来确实像一个 dns 问题。dns 服务器是否知道您正在使用的主机名？听起来 dns 服务器不知道您尝试连接的主机的正向查找（主机名到 ip）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T14:05:02.193

我们最近在这里建立了一个带有 Windows 身份验证的 Intranet 站点。网络人员设置了组策略并推送更改为 IE 和 Firefox。

对于 IE，它将站点添加到“Intranet 站点”，对于 Firefox，它修改了配置文件，以便我们的 intranet..com 可以被信任。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T22:01:46.373

所以......我们让它工作。这就是发生的事情。

在查看 test.DOMAINNAME.com 上的 DNS 管理器时，我的同事注意到同一服务器上的不同站点设置为“主机 (A)”条目，而我们正在处理的站点设置为“别名（CNAME）”条目。那台计算机上的其他几个站点也被设置为别名条目，他提到具有 Host 条目的一个站点是“坚如磐石”的，并且他在至少一个设置为的其他站点上遇到了零星问题一个别名。

我们与 AD/DNS 管理员进行了交谈，作为测试，他将我们的条目从 Alias 切换到了 Host，一旦我们清除了本地 DNS 缓存，它就可以完美运行（不需要我们的 .hosts 文件中的条目）。

所以问题仍然存在。这是一个 Win2k3 机器，用作三个内部 DNS 服务器之一，并且进行此修改解决了我们的问题。如果有人可以添加任何其他信息，我们将非常感激，但与此同时，我们正在讨论返回并修复我们所有其他网站。

# django - Django 中的内联表单验证

> ID：877723
> 
> 赞同：57
> 
> 时间：2009-05-18T13:23:06.803
> 
> 标签：django, django-forms

我想在管理员更改表单中强制设置整个内联表单集。因此，在我当前的情况下，当我在发票表单（在管理员中）上点击保存时，内联订单表单是空白的。我想阻止人们创建没有关联订单的发票。

有谁知道一个简单的方法来做到这一点？

在这种情况下，模型字段上的( ) 之类的正常验证`required=True`似乎不起作用。

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-05-18T14:06:07.777

最好的方法是定义一个自定义表单集，使用一种干净的方法来验证至少存在一个发票订单。

```
class InvoiceOrderInlineFormset(forms.models.BaseInlineFormSet):
    def clean(self):
        # get forms that actually have valid data
        count = 0
        for form in self.forms:
            try:
                if form.cleaned_data:
                    count += 1
            except AttributeError:
                # annoyingly, if a subform is invalid Django explicity raises
                # an AttributeError for cleaned_data
                pass
        if count < 1:
            raise forms.ValidationError('You must have at least one order')

class InvoiceOrderInline(admin.StackedInline):
    formset = InvoiceOrderInlineFormset

class InvoiceAdmin(admin.ModelAdmin):
    inlines = [InvoiceOrderInline] 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-12-10T23:11:20.637

丹尼尔的回答非常好，它在一个项目上对我有用，但后来我意识到由于 Django 表单的工作方式，如果您使用 can_delete 并在保存时选中删除框，则可以验证没有任何订单（在此案子）。

我花了一段时间试图弄清楚如何防止这种情况发生。第一种情况很简单——不要将要删除的表单包括在计数中。第二种情况更棘手......如果*所有*删除框都被选中，那么`clean`就没有被调用。

不幸的是，代码并不完全简单。访问属性时调用的`clean`方法被调用。删除子表单时不会访问此属性，因此永远不会调用此属性。我不是 Django 专家，所以这可能是一种糟糕的方法，但它似乎有效。`full_clean``error``full_clean`

这是修改后的类：

```
class InvoiceOrderInlineFormset(forms.models.BaseInlineFormSet):
    def is_valid(self):
        return super(InvoiceOrderInlineFormset, self).is_valid() and \
                    not any([bool(e) for e in self.errors])

    def clean(self):
        # get forms that actually have valid data
        count = 0
        for form in self.forms:
            try:
                if form.cleaned_data and not form.cleaned_data.get('DELETE', False):
                    count += 1
            except AttributeError:
                # annoyingly, if a subform is invalid Django explicity raises
                # an AttributeError for cleaned_data
                pass
        if count < 1:
            raise forms.ValidationError('You must have at least one order') 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-06-03T15:21:44.103

```
class MandatoryInlineFormSet(BaseInlineFormSet):  

    def is_valid(self):
        return super(MandatoryInlineFormSet, self).is_valid() and \
                    not any([bool(e) for e in self.errors])  
    def clean(self):          
        # get forms that actually have valid data
        count = 0
        for form in self.forms:
            try:
                if form.cleaned_data and not form.cleaned_data.get('DELETE', False):
                    count += 1
            except AttributeError:
                # annoyingly, if a subform is invalid Django explicity raises
                # an AttributeError for cleaned_data
                pass
        if count < 1:
            raise forms.ValidationError('You must have at least one of these.')  

class MandatoryTabularInline(admin.TabularInline):  
    formset = MandatoryInlineFormSet

class MandatoryStackedInline(admin.StackedInline):  
    formset = MandatoryInlineFormSet

class CommentInlineFormSet( MandatoryInlineFormSet ):

    def clean_rating(self,form):
        """
        rating must be 0..5 by .5 increments
        """
        rating = float( form.cleaned_data['rating'] )
        if rating < 0 or rating > 5:
            raise ValidationError("rating must be between 0-5")

        if ( rating / 0.5 ) != int( rating / 0.5 ):
            raise ValidationError("rating must have .0 or .5 decimal")

    def clean( self ):

        super(CommentInlineFormSet, self).clean()

        for form in self.forms:
            self.clean_rating(form)

class CommentInline( MandatoryTabularInline ):  
    formset = CommentInlineFormSet  
    model = Comment  
    extra = 1 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-07-20T15:04:55.140

@Daniel Roseman 解决方案很好，但我用更少的代码做了一些修改来做同样的事情。

```
class RequiredFormSet(forms.models.BaseInlineFormSet):
      def __init__(self, *args, **kwargs):
          super(RequiredFormSet, self).__init__(*args, **kwargs)
          self.forms[0].empty_permitted = False

class InvoiceOrderInline(admin.StackedInline):
      model = InvoiceOrder
      formset = RequiredFormSet

class InvoiceAdmin(admin.ModelAdmin):
     inlines = [InvoiceOrderInline] 
```

试试这个它也有效:)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-04-06T07:32:30.133

The situation became a little bit better but still needs some work around. Django provides `validate_min` and `min_num` attributes nowadays, and if `min_num` is taken from `Inline` during formset instantiation, `validate_min` can be only passed as init formset argument. So my solution looks something like this:

```
class MinValidatedInlineMixIn:
    validate_min = True
    def get_formset(self, *args, **kwargs):
        return super().get_formset(validate_min=self.validate_min, *args, **kwargs)

class InvoiceOrderInline(MinValidatedInlineMixIn, admin.StackedInline):
    model = InvoiceOrder
    min_num = 1
    validate_min = True

class InvoiceAdmin(admin.ModelAdmin):
    inlines = [InvoiceOrderInline] 
```

# programming-languages - 探索声明式编程语言的技巧？

> ID：877726
> 
> 赞同：5
> 
> 时间：2009-05-18T13:24:06.533
> 
> 标签：programming-languages, declarative

**问题**

如前所述，你有什么技巧可以帮助你了解/理解/让你的头脑围绕声明性编程语言？

或者这仅仅是一个案例，你必须让自己沉浸在语言和它的语法中，直到它渗入，直到你得到你得到它的黄金**时刻**。这不是一个真正的选择，因为我再也不能连续几天把自己锁在一个房间里，研究超过六本关于该主题的不同书籍（责任就是它们的全部内容）

那么，当你处理声明性语言时，有什么提示或技巧对你有帮助，有什么见解可以传递吗？

PS我个人会赞成第一个回答“<em>闭嘴并投入工作”的答案。

**背景**

当我第一次开始编写代码时，我 13 岁（基本，在我的姐妹[Oric-1](http://www.48katmos.freeuk.com/oric1.htm)上）。

从那时起，我使用了许多新概念和许多不同的语言，从容不迫，我很快就占了上风。面向对象？不麻烦。事件驱动范式？给我吸一口腌鱼，我会回来吃早餐的。

Owl、Mfc、ActiveX、Vb3、4、5 和 6、VB.Net、Pascal、Delphi、C、C++ 和 C#。没有人挡住我的路，至少不会持续很长时间。

然而最近我的满分却受到了一些打击。

几周前，我全身心地投入到 Xaml 中，伙计们，我比游泳更容易下沉。

我认为我的主要问题是它是声明性的。我所有其他的编程技能都是程序性的。我以前用 MSBuild 遇到过这个问题，我可以复制一些例子来说明如何让 MSBuild 工作，但是从头开始把一些东西放在一起会丢失。

回到 Xaml，目前我正在疯狂地尝试将触发器连接到属性并获得我需要的效果。

我可能会尽快在此处发布我的特定 Xaml 问题。现在我在问这个一般的“声明式编程”问题。

PS不，我实际上并没有这么自大。是的，当我第一次接触 OO 和第一次编写事件驱动的 UI（Windows 3.11 上的 VB3）时，我跌跌撞撞。

**编辑**

它开始陷入困境，让我在这个领域走到这一步的坚韧正在得到回报，**只是需要这么多的水力压裂时间**！

*. . . 我觉得我对这些东西太老了。. . :)*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T16:28:32.810

在本世纪初，我不得不教很多 XSL（或 XSLT，如你所愿）:)，这是一个不同的世界，真的。然而，这是范式转换的基础：你必须意识到声明性语言确实是不同的。我最重要的建议是继续研究其他人的解决方案，投入工作，并真正**尝试停止在 FLOW 中思考**。最糟糕的是，在 XSL 中，有一个“if”和一个“else”，但通常还有另一种方式来做事。

与学习 OO 不同，在 XSL（或任何声明性语言，我想）中，除非您以声明方式进行，否则您将无法完成您想要做的事情。

因此，部分答案是按照您的建议“闭嘴做工作”，但更重要的一点是要意识到很多工作都在让您了解范式转变。所以真正的答案是，**“为范式转变保持警惕。”** 你必须停止顺流思考，开始思考可以以任何顺序触发的规则……如果它们做得正确，它们何时触发都没关系。当您最终考虑规则而不是事情发生时，您就开始了解这种转变。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T13:47:04.633

从真正了解该语言的人那里找到一些示例，并解释“为什么”。学习模式和习语会有所作为。

我怀疑您正在尝试在声明性领域中做必要的事情，这意味着您要根据步骤进行思考。根据所需输入+这些输入的无状态函数写下数据流，看看是否有帮助。

尝试使用函数式或函数式语言，例如 ML 或 Scheme。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T13:47:32.557

我不知道您在使用 Xaml 时遇到的具体问题是什么（我自己也没有使用过），但我发现在使用 XSLT 等基于 XML 的技术时，一点 LISP 或 Scheme 经验会大有帮助。[您可能想看看http://www.plt-scheme.org](http://www.plt-scheme.org)免费提供的优秀方案系统。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T14:04:14.193

考虑一下您最喜欢的[“程序员无知”的烦恼](https://stackoverflow.com/questions/423823/whats-your-favorite-programmer-ignorance-pet-peeve/424005#424005)。第一个代码片段显然是程序性的。在第二个片段中，您**做了一个声明性声明**，要使百分比有效，它必须在 0 到 100 之间。

所以我猜只要你足够努力地研究声明式编程语言，你就不会遇到麻烦......几何没有[王道](http://en.wikiquote.org/wiki/Euclid)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T14:13:29.790

我知道这可能会让你大吃一惊。您列出的所有这些语言确实非常相似（程序）。

一旦你明白了这一点，我**强烈**建议你也学习一[门函数式语言](http://en.wikipedia.org/wiki/Functional_programming)。你也可能会觉得很难，但学习它会极大地帮助你的一般编码技能。您将拥有一整套全新的技巧（即使是在程序语言中），并且您再也不会害怕递归了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-18T14:23:05.230

像 Binary Worrier 一样，我在 C、C++、MFC 等方面有很长的历史，并且一直在加快 XAML、WPF 和 C# 的速度。我通过 HTML、Javascript 和 XSLT 进行了一次次旅行，我认为这对我为 XAML 做好准备有很大帮助。

XAML 背后的基本思想相当简单 - 一切都是关于你*展示*什么，而不是你*做什么*。XAML 的难点在于，只有大量的实现细节需要学习，而你最终要同时学习它们，以便能够完成大部分工作。

如果问题更具体，我可能会更有帮助。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-10-03T04:55:28.227

> **“编程就是给计算机一系列指令。”**

大多数程序员对这种说法反应平静。几乎就像……“嗯？”

但是这种说法的信念是导致人们难以理解其他编程范式的原因。这***不是***真的，而且已经很久没有了。为了更好地理解编程，许多人可能会从思考为什么这个陈述是错误的中受益。

即使您使用纯汇编进行编程，现代处理器也会重新排列您的指令，执行分支预测，并尝试同时执行多个可能相互依赖的指令。通过这种方式，他们根据逻辑依赖而不是顺序来思考。序列隐喻是错误的概念，即指令在逻辑上依赖于它之前的所有内容。如果这是真的，推理程序的最佳方法是检查控制流。但事实并非如此。

不只是声明式编程不适合这个比喻，并行和异步编程也是如此。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-18T13:41:05.580

我发现“了解”一种语言的最简单方法就是开始专门将它用于所有编码。对于我来说，使用一种全新的语言，学习曲线大约是 2 周的编码，每天大约 4-5 小时。在那之后，它突然“点击”，您可以开始减少对手册和文档的依赖。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-18T13:56:14.817

我在大学上过一门课（编程语言）。感觉就像我反复用头撞一堵砖墙，但是在上课大约 3/4 的时候，我意识到墙已经不存在了。几个星期以来，我一直在不停地敲打我的头。这是一种非常超现实的感觉。

我认为任何其他方式都不会有同样的魅力。阅读哥德尔、埃舍尔、巴赫；听很多 Emerson、Lake、Palmer 和 Kaikhosru Sorabji；抽一些大麻，然后投入时间。

# javascript - 禁用跨站点访问时，是否有任何方法可以绕过 NS_ERROR_DOM_BAD_URI？

> ID：877727
> 
> 赞同：3
> 
> 时间：2009-05-18T13:24:22.230
> 
> 标签：javascript, ajax, xss, same-origin-policy

我正在为我的大学做 XSS 报告，我正在做一些使用 AJAX 调用外部网页的测试。

我用于此示例的代码非常简单，我的目标案例研究之一是能够通过禁用跨站点的 AJAX 调用外部网页。

### 笔记：

我只打算在 FireFox 上使用它，我并不关心 IE 的兼容性。

```
<script>
    var xmlhttp=new XMLHttpRequest();
    xmlhttp.onreadystatechange=function(){
        if(xmlhttp.readyState==4)
        {
            alert(xmlhttp.responseText);
        }
    }
    xmlhttp.open("GET","http://example.com",true);
    xmlhttp.send(null);
</script> 
```

现在这里的问题是***未捕获的异常：访问受限 URI 被拒绝 (NS_ERROR_DOM_BAD_URI)***被抛出。我一直在四处寻找，我发现绕过这个的最好的信息是使用带有 json 的 jquery，但这不适合我，另一个例子是[这个（法语）](http://khayyam.developpez.com/articles/web/ajax-cross-domain/)。

谁能解释我如何做到这一点？还是由于*相同的原产地政策*而无法解决？

**编辑**：

如果有人知道，谷歌如何通过谷歌分析发布这些值？或者这个问题只发生在get而不是post？一些帮助会很好。

# algorithm - 使用什么算法来确定使系统达到“零”状态所需的最小操作数？

> ID：877728
> 
> 赞同：48
> 
> 时间：2009-05-18T13:24:23.837
> 
> 标签：algorithm, language-agnostic, graph

这是一种更通用的问题，不是特定于语言的。更多关于想法和算法的使用。

系统如下：

它记录朋友群体之间的小额贷款。`Alice`并且`Bill`要去吃午饭，比尔的卡坏了，所以爱丽丝付了他的饭钱，10 美元。
第二天在火车站见面，Chales 没钱买票，所以`Bill`给他买了一张，5 美元。那天晚些时候，她向朋友借了 5美元和 1 美元，给她的朋友买了礼物。`Charles``Bill``Alice``Charles``Bill`

现在，假设他们都在系统中注册了该*交易*，它看起来像这样：

```
Alice -> Bill $10
Bill -> Alice $1
Bill -> Charles $5
Charles -> Alice $5 
```

所以，现在，唯一需要做的就是`Bill`给`Alice`她 4 美元（他给了她 1 美元，然后`Charlie` *把*他的 5美元转给了她`Alice`），他们处于初始状态。

如果我们将其扩展到许多不同的人，进行多笔交易，那么获得尽可能少的交易的最佳算法是什么？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-05-18T13:43:07.667

这实际上看起来像是复式会计概念可以帮助的工作。

您的交易可以构造为簿记条目，因此：

```
 Alice  Bill  Charles  Balance
Alice   -> Bill    $10      10    10-       0        0
Bill    -> Alice    $1       9     9-       0        0
Bill    -> Charles  $5       9     4-       5-       0
Charles -> Alice    $5       4     4-       0        0 
```

你有它。在每笔交易中，您贷记一个分类帐并借记另一个分类帐，以便余额始终为零。最后，您只需计算出应用于每个帐户的最少交易数量，即可将其归零。

对于这个简单的案例，这是从比尔到爱丽丝的简单 4 美元转账。您需要做的是将至少一个帐户（但最好是两个）减少到零，以添加每笔交易。假设你有更复杂的：

```
 Alice  Bill  Charles  Balance
Alice   -> Bill    $10      10    10-       0        0
Bill    -> Alice    $1       9     9-       0        0
Bill    -> Charles  $5       9     4-       5-       0
Charles -> Alice    $5       4     4-       0        0
Charles -> Bill     $1       4     5-       1        0 
```

那么所需的交易将是：

```
Bill     -> Alice   $4       0     1-       1        0
Bill     -> Charles $1       0     0        0        0 
```

* * *

不幸的是，在某些州，这种简单的贪婪策略并不能产生最佳解决方案（`j_random_hacker`感谢指出这一点）。一个例子是：

```
 Alan  Bill  Chas  Doug  Edie  Fred  Bal
Bill->Alan   $5    5-    5     0     0     0     0    0
Bill->Chas  $20    5-   25    20-    0     0     0    0
Doug->Edie   $2    5-   25    20-    2     2-    0    0
Doug->Fred   $1    5-   25    20-    3     2-    1-   0 
```

显然，这可以在四步中逆转（因为到达那里只需要四步）但是，如果您不明智地选择了第一步`(Edie->Bill $2)`，那么您将逃脱的最低限度是五步。

您可以使用以下规则解决此*特定问题：*

*   （1）如果你能消灭两个平衡，那就去做吧。
*   (2) 否则，如果您可以消灭一个平衡并设置自己在下一步消灭两个平衡，那就去做吧。
*   (3) 否则，抹去任何一笔余额。

这将导致以下序列：

*   (a) [1] 不适用，[2] 可以通过 实现`Alan->Bill $5`。
*   (b) [1] 可以用 来完成`Chas->Bill $20`。
*   (c) 和 (d)，与 Doug、Edie 和 Fred 的推理类似，总共四步。

然而，这仅仅是因为可能性很小。随着人数的增加和群体的相互关系变得更加复杂，您很可能需要进行详尽的搜索才能找到所需的最少移动次数（基本上是上面的规则 1、2 和 3，但经过扩展以处理更多深度） .

我认为这是在所有情况下为您提供最少数量的交易所需要的。*但是，最好*的答案可能并不需要（最好，在这种情况下，意味着最大的“每块钱”）。可能即使是基本的 1/2/3 规则集也会为您的目的提供足够好的答案。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-05-18T13:48:36.250

直观地说，这听起来像是一个 NP 完全问题（它简化为一个非常类似于装箱的问题），但是下面的算法（装箱的一种修改形式）应该是相当不错的（没有时间证明，抱歉）。

1.  清除每个人的头寸，即从您上面的示例中：

    爱丽丝 = $4 比尔 = $-4 查尔斯 = $0

2.  所有净债权人从高到低排序，所有债务人从低到高排序，然后通过遍历列表进行匹配。

3.  在某些时候，您可能需要拆分一个人的债务以将所有东西都净掉 - 在这里最好拆分成尽可能大的块（即首先放入剩余空间最多的垃圾箱）。

这将需要 O(n log n) 之类的东西（再次，需要适当的证明）。

有关更多信息，请参阅[分区问题](http://en.wikipedia.org/wiki/Partition_problem)和[装箱](http://en.wikipedia.org/wiki/Bin_packing_problem)问题（前者是一个非常相似的问题，如果您将自己限制为固定精度事务，那么它是等价的 - 当然需要证明）。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2011-05-03T09:05:53.670

我创建了一个 Android 应用程序来解决这个问题。您可以在旅途中输入费用，它甚至会建议您“谁应该支付下一个”。最后它计算“谁应该向谁发送多少”。我的算法计算所需的最小交易数量，您可以设置“交易容差”，这可以进一步减少交易（您不关心 1 美元的交易）试试看，它被称为 Settle Up：

[https://market.android.com/details?id=cz.destil.settleup](https://market.android.com/details?id=cz.destil.settleup)

**我的算法描述：**

我有解决 n-1 事务问题的基本算法，但它不是最优的。它的工作原理是这样的：从付款中，我计算每个成员的余额。余额是他支付的金额减去他应该支付的金额。我越来越根据平衡对成员进行排序。然后我总是选择最贫穷和最富有的，然后进行交易。其中至少有一个余额为零，并被排除在进一步的计算之外。有了这个，事务的数量不能比 n-1 差。它还最大限度地减少了交易中的金额。但这不是最优的，因为它没有检测到可以在内部建立的子组。

很难找到可以在内部安定下来的子群体。我通过生成所有成员组合并检查子组中的余额总和是否为零来解决它。我从 2 对开始，然后是 3 对 ... (n-1) 对。组合生成器的实现是可用的。当我找到一个子组时，我使用上述基本算法计算子组中的事务。对于每个找到的子组，都会保留一个事务。

解决方案是最优的，但复杂度增加到 O(n!)。这看起来很糟糕，但诀窍是实际上只有少数成员。我在 Nexus One（1 Ghz 处理器）上对其进行了测试，结果是：直到 10 个成员：<100 毫秒，15 个成员：1 秒，18 个成员：8 秒，20 个成员：55 秒。所以直到 18 个成员执行时间都很好。超过 15 个成员的解决方法可以是仅使用基本算法（它快速且正确，但不是最优的）。

**源代码：**

源代码可在一份关于用捷克语编写的算法的报告中找到。源代码在最后，它是英文的：

[http://www.settleup.info/files/master-thesis-david-vavra.pdf](http://www.settleup.info/files/master-thesis-david-vavra.pdf)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-11-23T23:24:52.490

我找到了一个在 Excel 中实现的实用解决方案：

*   找出谁欠的最多

*   让那个人把他欠的全部钱还给应该得到最多的人

*   这使得第一人称为零

*   考虑到 (n-1) 人之一的金额发生变化，重复此过程

它应该会导致最多 (n-1) 次转账，而好处是没有人做超过一笔付款。以 jrandomhacker 的（修改后的）示例为例：

a=-5 b=25 c=-20 d=3 e=-2 f=-1（总和应该为零！）

1.  c -> b 20\. 结果：a=-5 b=5 c=0 d=3 e=-2 f=-1

2.  a -> b 5 结果：a=0 b=0 c=0 d=3 e=-2 f=-1

3.  e -> d 2 结果 a=0 b=0 c=0 d=1 e=0 f=-1

4.  f -> d 1

现在，每个人都很满意，没有人会为两次或多次付款而烦恼。如您所见，一个人可能会收到不止一笔付款（在本例中为人 d）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-02-12T19:54:52.183

我设计了一个解决方案，使用与此处提到的方法有些不同的方法。它使用问题的线性规划公式，取自 Compressed Sensing 文献，尤其是[Donoho 和 Tanner (2005) 的这项工作](http://www.pnas.org/content/102/27/9446.short)。

[我写了一篇](https://miguelbiron.github.io/2018/02/09/simplifying-payments-with-linear-programming/)描述这种方法的博客文章，以及一个实现它的微型 R 包。我很想从这个社区得到一些反馈。

干杯。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-18T13:38:30.470

好吧，第一步是完全忽略交易。把它们加起来。你真正需要知道的是一个人欠/拥有的债务净额。

通过创建一个疯狂的流程图并找到最大流量，您可以很容易地找到交易。然后一刀切...

部分阐述：每个人都有一个源节点、一个汇节点和一个节点。除了源节点和汇节点之间没有边外，每对节点之间都会有一条边。人与人之间的边缘在两个方向上都有无限的容量。从源节点到人的边的容量等于该人的净债务（如果他们没有净债务，则为 0）。从人员节点到汇节点的边的容量等于该人员所欠的净金额（如果他们没有净欠款，则为 0）。

应用最大流量和/或最小切割将为您提供一组转移。实际流量将是多少资金将被转移。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-18T13:40:33.710

只有当某人欠了超过 2 个人，也欠同一个集合时，你才能从简单集合中减少交易数量。

也就是说，简单的设置只是找到每个余额并偿还它。不超过N！交易。

如果 A 欠 B 和 C，并且 BC 的某个子集相互欠，所以 B 欠 C，那么代替：A -> B，A -> C（3 笔交易）。您将使用：A -> B，B -> C（2 个事务）。

所以换句话说，您正在构建一个有向图，并且您想要修剪顶点以最大化路径长度并最小化总边。

抱歉，我没有适合你的算法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-18T13:37:42.310

您应该能够在 O(n) 中解决这个问题，首先确定每个人的欠款和欠款多少。将任何欠他欠债的人的债务转移给他的债务人（从而把那个人变成一个终点）。重复直到你不能再转移任何债务。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-06-14T00:17:03.773

这是我为解决 Java 中此类问题而编写的代码。我不是 100% 确定这是否提供了最少的交易数量。代码的清晰度和结构可以改进很多。

在这个例子中：

*   莎拉在汽车租赁上花了 400 美元。这辆车由莎拉、鲍勃、爱丽丝和约翰使用。
*   约翰在杂货上花了 100 美元。杂货被鲍勃和爱丽丝吃掉了。

    ```
    import java.util.*;
    public class MoneyMinTransactions {

        static class Expense{
            String spender;
            double amount;
            List<String> consumers;
            public Expense(String spender, double amount, String... consumers){
                this.spender = spender;
                this.amount = amount;
                this.consumers = Arrays.asList(consumers);
            }

        }

        static class Owed{
            String name;
            double amount;
            public Owed(String name, double amount){
                this.name = name;
                this.amount = amount;
            }
        }

        public static void main(String[] args){
            List<Expense> expenseList = new ArrayList<>();
            expenseList.add(new Expense("Sarah", 400, "Sarah", "John", "Bob", "Alice"));
            expenseList.add(new Expense("John", 100, "Bob", "Alice"));
            //make list of who owes how much.
            Map<String, Double> owes = new HashMap<>();
            for(Expense e:expenseList){
                double owedAmt = e.amount/e.consumers.size();
                for(String c : e.consumers){
                    if(!e.spender.equals(c)){
                        if(owes.containsKey(c)){
                            owes.put(c, owes.get(c) + owedAmt);
                        }else{
                            owes.put(c, owedAmt);
                        }
                        if(owes.containsKey(e.spender)){
                            owes.put(e.spender, owes.get(e.spender) + (-1 * owedAmt));
                        }else{
                            owes.put(e.spender, (-1 * owedAmt));
                        }
                    }
                }
            }
            //make transactions.
            // We need to settle all the negatives with positives. Make list of negatives. Order highest owed (i.e. the lowest negative) to least owed amount.
            List<Owed> owed = new ArrayList<>();
            for(String s : owes.keySet()){
                if(owes.get(s) < 0){
                    owed.add(new Owed(s, owes.get(s)));
                }
            }
            Collections.sort(owed, new Comparator<Owed>() {
                @Override
                public int compare(Owed o1, Owed o2) {
                    return Double.compare(o1.amount, o2.amount);
                }
            });
            //take the highest negative, settle it with the best positive match:
            // 1\. a positive that is equal to teh absolute negative amount is the best match.  
            // 2\. the greatest positive value is the next best match. 
            // todo not sure if this matching strategy gives the least number of transactions.
            for(Owed owedPerson: owed){
                while(owes.get(owedPerson.name) != 0){
                    double negAmt = owes.get(owedPerson.name);
                    //get the best person to settle with
                    String s = getBestMatch(negAmt, owes);
                    double posAmt = owes.get(s);
                    if(posAmt > Math.abs(negAmt)){
                        owes.put(owedPerson.name, 0.0);
                        owes.put(s, posAmt - Math.abs(negAmt));
                        System.out.println(String.format("%s paid %s to %s", s, Double.toString((posAmt - Math.abs(negAmt))), owedPerson.name));
                    }else{
                        owes.put(owedPerson.name, -1 * (Math.abs(negAmt) - posAmt));
                        owes.put(s, 0.0);
                        System.out.println(String.format("%s paid %s to %s", s, Double.toString(posAmt), owedPerson.name));
                    }
                }
            }

        }

        private static String getBestMatch(double negAmount, Map<String, Double> owes){
            String greatestS = null;
            double greatestAmt = -1;
            for(String s: owes.keySet()){
                double amt = owes.get(s);
                if(amt > 0){
                    if(amt == Math.abs(negAmount)){
                        return s;
                    }else if(greatestS == null || amt > greatestAmt){
                        greatestAmt = amt;
                        greatestS = s;
                    }
                }
            }
            return greatestS;
        }

    } 
    ```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-05-18T13:34:28.480

如果您将状态作为*图的节点，*那么您将能够使用最短路径算法来知道答案。

# apache - 301将index.html重定向到/或/index.php

> ID：877736
> 
> 赞同：6
> 
> 时间：2009-05-18T13:27:34.267
> 
> 标签：apache, mod-rewrite, http-status-code-301

问候，

我刚刚将一个网站从 IIS 移动到 Apache，并且在重定向索引文件而不导致无限循环时遇到了一些麻烦。

这两个单独会导致一个循环 -

重定向 301 /index.htm /index.php

重定向 301 /index.htm [http://www.foo.com/](http://www.foo.com/)

下面是我当前的 .htaccess 的副本。有人能帮我吗？我有一堆指向[http://www.foo.com/index.htm](http://www.foo.com/index.htm)的链接，我想 301 重定向到[http://www.foo.com/](http://www.foo.com/)

```
RewriteEngine On

########## Begin - Rewrite rules to block out some common exploits
## If you experience problems on your site block out the operations listed below
## This attempts to block the most common type of exploit `attempts` to Joomla!
#
# Block out any script trying to set a mosConfig value through the URL
RewriteCond %{QUERY_STRING} mosConfig_[a-zA-Z_]{1,21}(=|\%3D) [OR]
# Block out any script trying to base64_encode crap to send via URL
RewriteCond %{QUERY_STRING} base64_encode.*\(.*\) [OR]
# Block out any script that includes a <script> tag in URL
RewriteCond %{QUERY_STRING} (\<|%3C).*script.*(\>|%3E) [NC,OR]
# Block out any script trying to set a PHP GLOBALS variable via URL
RewriteCond %{QUERY_STRING} GLOBALS(=|\[|\%[0-9A-Z]{0,2}) [OR]
# Block out any script trying to modify a _REQUEST variable via URL
RewriteCond %{QUERY_STRING} _REQUEST(=|\[|\%[0-9A-Z]{0,2})
# Send all blocked request to homepage with 403 Forbidden error!
RewriteRule ^(.*)$ index.php [F,L]
#
########## End - Rewrite rules to block out some common exploits

#  Uncomment following line if your webserver's URL
#  is not directly related to physical file paths.
#  Update Your Joomla! Directory (just / for root)

# RewriteBase /

########## Begin - Joomla! core SEF Section
#
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !^/index.php
RewriteCond %{REQUEST_URI} (/|\.php|\.html|\.htm|\.feed|\.pdf|\.raw|\.cfm|/[^.]*)$  [NC]
RewriteRule (.*) index.php
RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization},L]
#
########## End - Joomla! core SEF Section

Redirect 301 /a /administrator 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T13:32:22.633

你为什么做这个？为什么不将 index.php 添加到您的 vhost/config 作为有效的索引扩展

```
DirectoryIndex index.html index.php 
```

然后删除HTML文件>

或者

```
DirectoryIndex index.php 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T13:31:52.137

我猜你的目录索引设置为 index.html，它发生在 index.php 之前。然后你的[http://www.foo.com/](http://www.foo.com/)被解释为[http://www.foo.com/index.html](http://www.foo.com/index.html)，它被重定向到[http://www.foo.com/](http://www.foo.com/) - 因此循环。

[在这里](http://www.webconfs.com/how-to-redirect-a-webpage.php)，您可以获得一些有关重定向不同方式的信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-17T21:06:34.107

您需要像这样检查 REQUEST_URI 的值：

```
RewriteCond %{REQUEST_URI} ^/index.htm$     # If REQUEST_URI == "/index.htm"
RewriteRule (.*) / [R=301,L]                # Then 301 redirect to "/" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T13:35:54.310

我同意 Kender 关于重定向循环的评论。可能的方式是有

DirectoryIndex notindex.html

连同您的重定向，然后将实际的首页放在 notindex.html 中。如果该页面确实存在，我不清楚使用 /index.html 的人有什么问题？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T10:43:15.277

我还不允许添加超链接，因为我是新用户，所以当我输入“foo”时，假设这是整个 URL...

要在没有循环的情况下将 foo/index.php 重定向到 foo/，请使用另一个重写规则：

```
RewriteRule index.php foo/ [R=301] 
```

您可能需要使用 /index.php，具体取决于您的 RewriteBase 设置为（以及您有多少个目录中有 index.php）。

# c# - Visual Studio / C# 中最常被滥用的功能是什么？

> ID：877737
> 
> 赞同：6
> 
> 时间：2009-05-18T13:27:41.880
> 
> 标签：c#, visual-studio

对我来说，No.1 必须是代码折叠。

```
#region xxx
#endregion 
```

突然之间，人们找到了拥有大类（文件）的借口，因为他们可以很好地“组织”它们。我曾经看过一个半页长的课，有 3000 行。我无言以对，他们就像“有什么问题”？

No.2 是部分类。这实际上是一个不错的功能，尤其是在您使用生成的代码时。但是，有些人使用它来将一个类“分解”为多个部分。为什么？因为那个类是如此庞大和流行，以至于它总是被锁定在源代码控制中。他们没有将类分解成不同的小类，而是创建了多个文件，如 my_Class1.cs、your_Class1.cs 等，以便人们可以同时处理 Class1。

我想包括“复制和粘贴”，但这不是 Visual Studio 的错......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T13:51:08.103

在块旁边，`#region`我会说强制（允许）您将数据访问代码直接写入您的 aspx 页面的 ASP.NET [IDataSource](http://msdn.microsoft.com/en-us/library/system.web.ui.idatasource.aspx)实现 ( [`SqlDataSource`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.sqldatasource.aspx), )。[`LinqDataSource`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linqdatasource.aspx)即使对于一个非常小的演示应用程序，我也不会使用它，但是在这些类的文档中没有提到对于一个设计良好的应用程序你不应该使用这些类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T13:58:15.017

不注意警告

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T14:00:02.750

WebForms 的图形编辑器。将这么多潜在的优秀开发人员宠坏为拖放猴子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T13:32:29.513

我认为最被滥用的功能是按原样使用默认模板。许多模板包括“部分”以及类内部代码不需要的区域和包含/使用语句。

在那之后，我必须同意#region 块；但是，如果处理得当，这些会很有用。通常，尽管它们被用作组织比它们可能应该更大的类的一种手段。

# vb.net - Linq - 从不同的列表类型中排除项目

> ID：877738
> 
> 赞同：4
> 
> 时间：2009-05-18T13:27:59.647
> 
> 标签：vb.net, linq

有没有办法选择列表中不包含在另一个列表中的项目？例如：

```
list1 = From t In list1 Where Not list2.Contains(t.column1) 
```

这给了我错误：

```
Value of type 'Integer' cannot be converted to '<anonymous type>' 
```

这是有道理的，因为 list2.Contains 期望与 list2 具有相同的类型。但是，列表类型不同。我只想根据列比较进行选择。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-18T13:31:05.523

看着那（这 。`Except()`扩展方法，结合投影：

```
list1 = list1.Except(list2.Select(Function(l) l.ID)) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-18T13:31:41.760

那么`list2`实际上包含什么？如果你能准确地表达你的查询，我们大概可以用 LINQ 表达它。不知道是什么`list1`，`list2`并且`column1`很难提供帮助。

我要说的是，对于您检查的每个项目，这将是 O(n) *。*`List<T>.Contains`如果`list2`可能不小，您可能想创建一个`HashSet<T>`- 然后每次`Contains`调用都会快很多。

但是话又说回来，当我们对这种情况有更多了解时，我们很可能会提出一个完全不同的解决方案。请让问题尽可能具体，以获得最佳答案。

编辑：如果 tvanfosson 的解决方案对您有用，*并且*如果您使用 LINQ to Objects，那么您就有一个潜在的性能坑。最好（IMO）做`list2` *一次*投影并建立一个集合：

```
Dim invalid = New HashSet(Of Integer)(list2.Select(Function(x) x.Id))
list1 = From t in list1 Where Not invalid.Contains(t.column1) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-18T14:17:34.197

你有没有尝试过这样的事情？

```
list1 = From t In list1 Where Not list2.Any(l => t.column1 = l.column1 AndAlso t.column2 = l.column2) 
```

我不确定它的效率如何，但我认为它应该对你有用。

# java - Java 邮政地址解析器

> ID：877742
> 
> 赞同：8
> 
> 时间：2009-05-18T13:30:13.793
> 
> 标签：java, parsing, street-address

[与这个问题](https://stackoverflow.com/questions/877689/quickbooks-invoice-modify-has-different-address-behavior-than-create-how-to-comp)有些相关，但是在没有任何关于 QuickBooks 的具体答案的情况下，有没有人知道 Java 的地址解析器？可以获取非结构化地址信息并解析地址行 1、2 和城市州邮政编码和国家/地区的东西？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-18T13:35:14.313

我知道谷歌地图网络服务在这方面做得**很好**。所以，如果你想使用它，你可以节省很多精力。

这里真正的问题是您需要一个全球城市/国家/省名称数据库来有效地解析非结构化地址。

以下是我在 C# 中构建供 Google Maps API 使用的 URL 的方法：

```
string url = "http://maps.google.com/maps/geo?key=" + HttpUtility.UrlEncode(this.apiKey) + "&sensor=false&output=xml&oe=utf8&q=" + HttpUtility.UrlEncode(location); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-09-17T16:46:13.453

SourceForge JGeocoder 有一个地址解析器，您可能会发现它很有用。请参阅[http://jgeocoder.sourceforge.net/parser.html](http://jgeocoder.sourceforge.net/parser.html)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-18T13:45:31.780

可能想阅读这个 Stack Overflow 问题：“ [Parse usable Street Address, City, State, Zip from a string](https://stackoverflow.com/questions/16413/parse-usable-street-address-city-state-zip-from-a-string) ”。没有实际的 Java 代码来完成这项工作（只是一些 VB），但是有一些关于这个问题的讨论以及关于 John Gietzen 提到的替代方案的更多信息，即使用 Web 服务为您解释它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-04-01T20:21:48.930

Mural 项目有一个地址解析器： [https](https://mural.dev.java.net/) ://mural.dev.java.net/ 。我还没有弄清楚如何从更大的壁画引擎中提取它，但它确实基于一些非常有限的测试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-07T19:47:18.827

请参阅[www.address-parser.com](http://www.address-parser.com)，他们提供用于解析国际地址的 Web 服务。

# security - Apache 忽略 SSLRequire 指令

> ID：877743
> 
> 赞同：1
> 
> 时间：2009-05-18T13:30:18.347
> 
> 标签：security, apache, ssl, apache2

我已经设置 Apache 来提供 Subversion 数据。配置看起来像这样，

```
<Location /svn>
 DAV svn
 SVNPath /path/to/svn
 AuthType Basic
 AuthName "My Project"
 AuthUserFile /etc/httpd/dav_svn.passwd
 Require valid-user
 SSLRequireSSL
 <LimitExcept GET PROPFIND OPTIONS REPORT>
   Require valid-user
 </LimitExcept>
</Location> 
```

这按预期工作。

但是，我想放宽 SSL 要求，以便来自 localhost 的连接不需要它。我用 SSLRequire 指令替换了 SSLRequireSSL 指令。

但是 Apache 似乎完全忽略了 SSLRequire 指令。

两个都，

```
SSLRequire true 
```

和

```
SSLRequire false 
```

导致相同的行为！它们都允许非 SSL 连接。

我错过了什么？

（Apache 版本：2.2.11）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T16:34:39.880

我认为你需要：`SSLOptions +StrictRequire`

# c++ - 在 C++ 中将缓冲区与 const char* 进行比较

> ID：877758
> 
> 赞同：4
> 
> 时间：2009-05-18T13:33:56.017
> 
> 标签：c++, string, comparison

将内存缓冲区与常量字符串进行比较的正确 C++ 方法是`strcmp(buf, "sometext")`什么？我想避免由于创建临时 std::string 对象而导致不必要的内存复制。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T13:37:45.197

如果您知道缓冲区的内容，则 strcmp 很好。[`std::strncmp`](http://en.cppreference.com/w/cpp/string/byte/strncmp)可能会给您更多的安全性来防止缓冲区溢出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T13:49:07.687

如果您只是检查是否相等，则可以使用[`std::equal`](http://en.cppreference.com/w/cpp/algorithm/equal)

```
#include <algorithms>

const char* text = "sometext";
const int len = 8; // length of text

if (std::equal(text, text+len, buf)) ... 
```

当然，如果您的缓冲区可以小于文本，这将需要额外的逻辑

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T13:35:46.900

`strcmp`工作正常，没有复制。或者，您也可以使用[`memcmp`](http://www.cplusplus.com/reference/clibrary/cstring/memcmp/). 但是，在 C++ 中，为什么不使用`std::string`s？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T13:37:18.210

我将使用 memcmp，并作为最后一个参数，使用 2 种数据大小中的最小值。

还要检查以确保这 2 个尺寸相同，否则您只是在比较最短的一个的前缀。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T13:37:35.523

你可以这样做，

```
const char* const CONST_STRING = "sometext";

strcmp(buf,CONST_STRING); 
```

# html - 做 导致换行？

> ID：877769
> 
> 赞同：10
> 
> 时间：2009-05-18T13:36:05.153
> 
> 标签：html, css

我有一个菜单栏，我想为每个菜单项创建一个 div，以便它们水平分开 5px。我怎么做？

似乎通过简单地将一个项目包装在一个 div 周围，它会自动使每个菜单项进入一个新行。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-18T13:39:34.273

默认情况下，div 是块元素。您可以在 CSS 中更改它

```
 display:inline 
```

但是你最好使用列表和 CSS 来实现你想要的。

```
<style>
   .mymenu{
      list-style:none; 
   }
   .mymenu li{
      display:inline;
      etc
   }
</style>
<ul class="mymenu">
    <li>Item</li>
    <li>Item</li>
</ul> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-18T13:38:09.750

默认情况下`<DIV>`会导致换行。

[您可能想要使用`<SPAN>`](http://www.learnwebdesignonline.com/htmlcourse/span-div.htm).

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T13:37:56.210

`<span>`是你要找的

特别是对于菜单，您可能会查看[吸盘鱼下拉菜单](http://www.alistapart.com/articles/dropdowns/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-18T13:39:56.423

您可以让它们浮动，但对于菜单项，[使用列表来创建这些](http://www.cssplay.co.uk/menus/centered2.html).

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T13:39:11.543

```
display: inline; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T13:45:13.717

<div> 是 display: block - 通常它在你的内容周围形成一个框区域，你会在它之后得到类似换行符的东西（虽然它不是换行符，确切地说，因为 'div' 和 'line' 不是概念一起）。<span> 是 display: inline，这意味着它的内容在一个段落中流动（即包裹），就像一个粗体或斜体突出显示。它甚至不总是呈盒子形状：想象一下

```
This is a paragraph and <span> this is a
highlighted section.</span> 
```

这需要两个框来描述跨越的内联元素（设置边框以查看它的外观）。

您可能希望对菜单使用块元素，因为框大小使菜单元素的高度（以及可选的宽度）更简单 - 内联元素可以为您提供可变的高度和宽度 - 大大简化了情况。

对于块元素，使用 float:left 使它们水平排列。

但是在这方面有很多复杂性和意见，你最好更彻底地研究这种情况 - 我推荐[http://www.alistapart.com/](http://www.alistapart.com/)初学者，其中有几个有效的菜单示例。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-18T13:54:46.847

如果您使用 span 您不能使用顶部和底部边距，并且您的菜单项将跨行拆分（如果它们也有边框，则非常难看）。我推荐浮动块 A 标签，它紧凑且与文本模式浏览器配合得很好。

```
<style>
#menu a {display: block; border: 1px solid blue; padding 5px; float: left; margin-right: 5px;}
</style>
<div id="menu">
  <a href="/1/">Item 1</a> <a href="/2/">Item 2</a>
  <div style="clear:left"></div>
</div> 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-05-18T13:38:57.113

是的，它通常会。试试 <span>

# javascript - 如何在客户端运行程序或批处理文件？

> ID：877774
> 
> 赞同：6
> 
> 时间：2009-05-18T13:36:54.340
> 
> 标签：javascript, batch-file, executable, client-side

如何在客户端运行批处理文件？一个exe文件？只是为了在客户端打开预装程序？

[编辑]

关于ActiveX，我试过了

```
 var activeXObj = new ActiveXObject("Shell.Application");
    activeXObj.ShellExecute("C:\\WINDOWS\\NOTEPAD.EXE", "", "", "open", "1"); 
```

但这不起作用。有什么建议么？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-18T13:42:08.590

来自 Javascript？你不能。这是一个安全风险。想一想 - 您是否希望每个网站都能够在您的 PC 上运行程序？

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-18T13:42:11.303

您的意思是使用 JavaScript 通过浏览器窗口启动外部程序？你不可能那样做！那是一个该死的安全黑洞！

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-05-03T14:15:07.343

```
<script language="javascript" type="text/javascript">

    function RunEXE(prog) {
        var oShell = new ActiveXObject("WScript.Shell");
        oShell.Run('"' + prog + '"', 1);
    }     
</script> 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-18T13:51:50.940

如果您真的可以控制客户端，那么您可能希望在客户端安装一些远程守护程序服务，例如 SSH。

PS。但是，通过您的“服务器代码”调用它。

更新：

不要气馁。你绝对可以以安全的方式做到这一点。

1.  首先，您需要客户端上的守护程序服务来处理调用应用程序的任务。就个人而言，我宁愿使用 C++ 或 Delphi 构建简单的 rpc-server 作为 windows-service；但许多其他类型的服务器也可以完成这项工作（SSH、Apache、Telnet）

2.  然后制作一个网页，允许用户通过适当的身份验证“注册”他们的服务以调用该服务（密码、安全密钥）

3.  当您想从已经注册的客户端上的网页调用您的应用程序时，请对您的服务器进行 ajax 调用 (xmlhttprequest)。

4.  服务器应使用注册信息验证请求的 IP 地址。

5.  然后使用注册信息对客户端进行远程命令调用。

在某些网络情况下，此方案可能不起作用。但是，如果您真的可以控制执行环境，那么总会有一些解决方法。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-18T13:42:58.867

将客户端重定向到[http://yourserver/batchfile.bat](http://yourserver/batchfile.bat)。在某些浏览器下，这会提示用户运行批处理文件。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-18T13:44:27.913

如果问题是批处理文件显示在您需要设置的浏览器`Content-Type`和`Content-Disposition`HTTP 标头中，以便提示用户保存（或运行）文件，而不是让浏览器显示它。

如果没有用户的 OK，您将无法运行该文件，但这应该不是问题。

[看看这个问题更详细一点。](https://stackoverflow.com/questions/186867/what-content-type-to-force-download-of-text-response)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-18T13:48:09.107

基本上，你不能。如果您需要在客户端启动某些东西，您将完全需要另一种机制，大概是一种内置了一些安全性的机制。之前的一张海报提到了 psexec（[http://technet.microsoft.com/en-us/sysinternals/bb897553 .aspx](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)），这显然只有在您对目标系统具有适当权限并且完全在浏览器之外时才有效。

基本上，如果您能够轻松地做到这一点，那么您所要求的就是一个大问题。

您可能会研究 ActiveX，但我不知道这些天对 ActiveX 对象有什么限制（我知道有限制，但也许您可以在其中工作）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-07-03T08:18:24.003

出于安全原因，不允许直接使用。除了所有其他答案之外，还有另一个想法。

您可以在预装程序中构建一个 localhost rest 服务，并使用 javascript 通过命令或数据调用它，假设您编写了预装程序并且该服务应该在您调用时运行。此解决方案适用于某些场景。

# javascript - 从弹出窗口激活父窗口

> ID：877788
> 
> 赞同：1
> 
> 时间：2009-05-18T13:39:08.440
> 
> 标签：javascript, popup

使用 JavaScript 打开弹出窗口，此时父窗口处于非活动状态，我想通过弹出窗口激活父窗口。（这是一个关于 Java 的网络项目）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T13:44:05.027

您通常可以在 JavaScript 中使用 window.opener 来获取在弹出窗口中打开的窗口。

# xslt - XSLT 模板覆盖

> ID：877799
> 
> 赞同：1
> 
> 时间：2009-05-18T13:42:21.990
> 
> 标签：xslt, templates, overriding

我有一个关于 XSLT 模板覆盖的小问题。对于我的 XML 的这一部分：

```
<record>
  <medication>
    <medicine>
      <name>penicillin G</name>
      <strength>500 mg</strength>
    </medicine>
  </medication>
</record> 
```

在我的 XSLT 工作表中，我有两个按以下顺序排列的模板：

```
 <xsl:template match="medication">
   <xsl:copy-of select="." />
   </xsl:template>
   <xsl:template match="medicine/name">
   <text>!unauthorized information!</text>
 </xsl:template> 
```

我想要做的是将药物元素下的所有内容复制到输出，而不是“名称”元素（或我明确定义的任何其他元素）。最终的 xml 将以 RAW XML 形式显示给用户。换句话说，我想要的结果是：

```
<record>
  <medication>
    <medicine>
      <text>! unauthorized information!</text>
      <strength>500 mg</strength>
    </medicine>
  </medication>
</record> 
```

而我得到与输入相同的 XML，即没有用文本替换元素。为什么第二个模板匹配没有覆盖第一个模板中的 name 元素的任何想法？提前致谢

——阿里

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T18:56:42.637

模板顺序无关紧要。唯一可能考虑的情况（这取决于处理器）是当您遇到无法解决的冲突时，即错误情况。在这种情况下，XSLT 处理器通过选择最后出现的错误从错误中恢复是合法的。但是，您永远不应该编写依赖于这种行为的代码。

在您的情况下，模板优先级甚至不是问题。您有两种不同的模板规则，一种是匹配`<medication>`元素，一种是匹配`<name>`元素。这些*永远不会*发生冲突，所以这不是模板优先级或覆盖的问题。问题是您的代码实际上从未将模板应用于`<name>`元素。当您说`<xsl:copy-of select="."/>`on 时`<medication>`，您是在说：“执行深拷贝`<medication>`”。为后代节点触发任何模板规则的唯一方法是显式应用模板（使用`<xsl:apply-templates/>`.

我为您提供的解决方案与 alamar 的解决方案基本相同，只是它使用单独的处理“模式”，它将规则与样式表中的所有其他规则隔离开来。通用`match="@* | node()"`模板导致模板规则递归地应用于子节点（和属性），这使您有机会覆盖某些节点的行为。

```
<xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <!-- ...placeholder for the rest of your code... -->
  <xsl:template match="/record">
    <record>
      <xsl:apply-templates/>
    </record>
  </xsl:template>
  <!-- end of placeholder -->

  <xsl:template match="medication">
    <!-- Instead of copy-of, whose behavior is to always perform
         a deep copy and cannot be customized, define your own
         processing mode. Rules with this mode name are isolated
         from the rest of your code. -->
    <xsl:apply-templates mode="copy-medication" select="."/>
  </xsl:template>

          <!-- By default, copy all nodes and their descendants -->
          <xsl:template mode="copy-medication" match="@* | node()">
            <xsl:copy>
              <xsl:apply-templates mode="copy-medication" select="@* | node()"/>
            </xsl:copy>
          </xsl:template>

          <!-- But replace <name> -->
          <xsl:template mode="copy-medication" match="medicine/name">
            <text>!unauthorized information!</text>
          </xsl:template>

</xsl:stylesheet> 
```

“ `medicine/name`”的规则覆盖了“ ”的规则`@* | node()`，因为模式的格式（包含“ `/`”）使其默认优先级（0.5）高于“ `node()`”的默认优先级（-1.0）。

关于模板优先级如何工作的完整而简明的描述可以在我的网站上的[“XSLT 工作原理”中找到。](http://lenzconsulting.com/how-xslt-works/)

最后，我注意到您提到要向用户显示“RAW XML”。这是否意味着您想在浏览器中显示，例如，带有所有开始和结束标记的 XML？在这种情况下，您需要转义所有标记（例如，“ `&lt;`”代表“ `<`”）。查看我网站上的[XML-to-string 实用程序。](http://lenzconsulting.com/xml-to-string/)如果您需要如何使用它的示例，请告诉我。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T13:51:17.540

添加

```
<xsl:template match="@*|node()">
  <xsl:copy>
    <xsl:apply-templates select="@*|node()"/>
  </xsl:copy>
</xsl:template> 
```

给你的`<xsl:template match="medicine/name">`

并完全删除`<xsl:template match="medication">`！

```
<?xml version="1.0" encoding="windows-1251"?>
<xsl:stylesheet
        xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
        version="1.0">

 <xsl:template match="medicine/name">
   <text>!unauthorized information!</text>
 </xsl:template>

<xsl:template match="@*|node()">
  <xsl:copy>
    <xsl:apply-templates select="@*|node()"/>
  </xsl:copy>
</xsl:template>

</xsl:stylesheet> 
```

# ruby-on-rails - Rails RR 框架：对 instance_of 的多次调用

> ID：877805
> 
> 赞同：0
> 
> 时间：2009-05-18T13:43:44.170
> 
> 标签：ruby-on-rails, rspec, bdd

我想使用 RR 为我的控制器编写 RSpec。

我写了以下代码：

```
require File.expand_path(File.dirname(__FILE__) + '/../spec_helper')

describe RegistrationController do

    it "should work" do 
        #deploy and approve are member functions
        stub.instance_of(Registration).approve { true }
        stub.instance_of(Registration).deploy { true }
        post :register
    end 
end 
```

然而，当仍然调用原始的**批准**方法时， RR 存根仅**部署**方法。

 **我应该使用什么语法来存根注册类的所有实例的两个方法调用？

**更新：** 我用 [Mocha] 达到了预期的结果

```
Registration.any_instance.stubs(:deploy).returns(true)
Registration.any_instance.stubs(:approve).returns(true) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-04-27T21:24:53.623

看来您描述的行为实际上是一个错误：

[http://github.com/btakita/rr/issues#issue/17](http://github.com/btakita/rr/issues#issue/17)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-30T19:03:30.660

据我所知，RSpec 模拟不允许你这样做。您确定需要存根所有实例吗？我通常遵循这种模式：

```
describe RegistrationController do
    before(:each) do
       @registration = mock_model(Registration, :approve => true, :deploy => true)
       Registration.stub!(:find => @registration)
       # now each call to Registration.find will return my mocked object
    end

    it "should work" do 
      post :register
      reponse.should be_success
    end

    it "should call approve" do
      @registration.should_receive(:approve).once.and_return(true)
      post :register
    end

    # etc 
end 
```

通过对您控制的 Registration 类的 find 方法进行存根，规范中将返回什么对象。

# actionscript-3 - AS3 URLLoader 抛出 URL 未找到，但连接成功

> ID：877810
> 
> 赞同：0
> 
> 时间：2009-05-18T13:44:48.270
> 
> 标签：actionscript-3

好吧，有点奇怪。我在 AS3 中有一个简单的 URLLoader，用于加载外部 XML 文档。它加载得很好，我在[Charles](http://www.charlesproxy.com/)中得到了正确的 302 Not Modified 响应，但是 flash 告诉我：

> “找不到网址”

以下是相关代码：

```
 //=============================================================================================
    public function openXML(name:String):void { //decides what XML data feed and opens it
    //=============================================================================================

                var xmlLoader:URLLoader = new URLLoader();
        var xmlData:XML = new XML();

        //add event listener to URLLoader to call closeXML upon completion
        xmlLoader.addEventListener(Event.COMPLETE, closeXML);

        xmlLoader.load(new URLRequest("http://www.gessnerengineering.com/projects"));

        //=========================================================
        function closeXML(e:Event):void {
        //=========================================================
            xmlData = new XML(xmlLoader.data);
            xmlLoader.removeEventListener(Event.COMPLETE, closeXML);

            drawPage(name, xmlData);
        }

    } 
```

根据调试器的问题行在：

```
 xmlLoader.load(new URLRequest("http://www.gessnerengineering.com/projects")); 
```

我已经验证我可以通过我的浏览器和 cURL 浏览到该 URL，Charles 说我的 SWF 可以并且也可以成功访问它。但是我仍然收到此 URL Not Found 错误。根据[Flash Actionscript 3 文档](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/net/URLLoader.html)，这是使用 URLLoader 加载包括 XML 在内的外部数据的绝对正确方法。

用馅饼更新了代码[。](http://pastie.org/481582)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T15:10:27.913

我发现你的代码结构有点奇怪 - 为什么你的函数内部有函数？

我像这样重写了你的代码，它工作得非常好（我只是在 Flash 的时间线上运行它，因为我懒得建立一个新项目）：

```
var xmlLoader:URLLoader = new URLLoader();
var xmlData:XML = new XML();
var request:URLRequest = new URLRequest("http://www.gessnerengineering.com/projects");
request.method = URLRequestMethod.GET;

//=============================================================================================
    function openXML(name:String):void { //decides what XML data feed and opens it
    //=============================================================================================

    //add event listener to URLLoader to call closeXML upon completion
    xmlLoader.addEventListener(Event.COMPLETE, closeXML);
    xmlLoader.addEventListener(IOErrorEvent.IO_ERROR, onIOError);
    xmlLoader.addEventListener(SecurityErrorEvent.SECURITY_ERROR, securityError);
    xmlLoader.load(new URLRequest("http://www.gessnerengineering.com/projects"));

}
function onIOError(e:IOErrorEvent):void {  
    trace("Error loading URL.");  
} 

function securityError(e:SecurityErrorEvent):void {
    trace("security error");
}

function closeXML(e:Event):void {
    trace('xmlLoader.data ' + xmlLoader.data);
    xmlData = new XML(xmlLoader.data);
    xmlLoader.removeEventListener(Event.COMPLETE, closeXML);
}

openXML('ljkl'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T14:13:45.827

在不了解所有细节的情况下，假设您正确实现了 RESTful 服务，您的 URLRequest 可能会使用错误的方法（POST，而不是 GET）调用服务。

查看有关从 Actionscript 3 调用 RESTful 服务的教程：

[在 ActionScript 3 中使用 REST Web 服务](http://blog.martinlegris.com/?p=87)

它有一些关于设置请求类型和处理可能弹出的其他一些问题的好信息（比如设置返回数据类型等）。

# c# - C# 字符串插入与可选参数混淆

> ID：877811
> 
> 赞同：0
> 
> 时间：2009-05-18T13:44:56.040
> 
> 标签：c#, string-formatting, multiple-constructors

我对 C# 相当陌生，并试图找出字符串插入（即`"some {0} string", toInsert`），并遇到了一个我没想到的问题......

如果您有两个构造函数：

```
public MyClass(String arg1) { ... }

public MyClass(String arg1, String arg2) { ... } 
```

我可以使用带有字符串插入的第一个构造函数吗？

```
...
toInsert = "def"
myClass = new MyClass("abc{0}ghi", toInsert)
... 
```

还是 C# 会将其解释为第二个构造函数并将文字`"abc{0}ghi"`作为第一个参数传递？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-18T13:46:51.183

是的，这将被解释为只是第二个参数。

您描述的行为称为字符串格式，并且接受这种样式的字符串的所有内容都在后台使用 string.Format() 。有关详细信息，请参阅该方法的文档。

要获得所需的行为，请使用以下代码：

```
myClass = new MyClass(string.Format("abc{0}ghi", toInsert)); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-18T13:47:12.213

做就是了：

```
public MyClass(string format, params object[] args)
{
  this.FormattedValue = string.Format(format, args);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T13:47:57.203

> 还是 C# 会将其解释为第二个构造函数并将文字“abc{0}ghi”作为第一个参数传递？

这是正确的答案。我认为如果您使用 String.Format("abc{0}ghi", toInsert) 那么它将采用第一个构造函数

# windows - 在模式窗口处于活动状态时与主窗口交互

> ID：877816
> 
> 赞同：0
> 
> 时间：2009-05-18T13:45:52.903
> 
> 标签：windows, modal-dialog

我希望能够在模态窗口处于活动状态时与 Firefox 或 Word 等应用程序的主窗口进行交互。

我所说的交互是指：

*   复制文本
*   移动窗口
*   关闭窗口（按 x 按钮）

这些在Windows环境下可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-05-11T06:34:07.207

If you want to do it programmatically, you can. SendMessage will invoke the target window's message handler when the target isn't expecting it, so you'd better be very careful what you do.

If you want to do it as a user, operating the mouse and keyboard, then your question belongs on a different web site even though Blindy answered that question for you.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T13:52:43.607

不，模态窗口隐藏了父级的消息循环，因此它们不会处理任何事件。

# unit-testing - 单元测试和验收测试是否足够？

> ID：877818
> 
> 赞同：9
> 
> 时间：2009-05-18T13:46:14.760
> 
> 标签：unit-testing, automated-tests, integration-testing, acceptance-testing

如果我对每个类和/或成员函数进行单元测试，并对每个用户故事进行验收测试，我是否有足够的测试来确保项目按预期运行？

例如，如果我对某个功能进行了单元测试和验收测试，我是否还需要集成测试，或者单元测试和验收测试是否应该涵盖相同的领域？测试类型之间是否存在重叠？

我在这里谈论自动化测试。我知道对于易用性等问题仍然需要手动测试。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-18T14:06:58.273

> 如果我对每个类和/或成员函数进行单元测试，并对每个用户故事进行验收测试，我是否有足够的测试来确保项目按预期运行？

不能。测试只能验证您的想法。不是你没有想到的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-18T13:54:46.973

多个测试周期的想法是在事情发生变化时尽早发现问题。

单元测试应该由开发人员完成，以确保单元*独立*工作。

验收测试应由客户进行，以确保系统满足要求。

但是，这两个点之间也发生了一些变化，也应该进行测试。这是在提供给客户之前将单元集成到产品中。

这是产品创建者首先应该测试的东西，而不是客户。当您与客户建立联系的那一刻，事情就会变慢，因此在他们得到他们肮脏的小手之前，您可以做的修复越多越好。

在一家大商店（比如我们的）中，在可交付产品发生变化的每个点都有单元测试、集成测试、全球化测试、主构建测试等等。只有在所有高严重性错误都得到修复（并且修复低优先级错误的计划到位）之后，我们才会将产品发布给我们的测试版客户。

我们不想*仅仅*因为在那个阶段修复一个错误比我们内部做的任何事情都要昂贵得多（尤其是在管理方面），就给他们一个不可靠的产品。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-18T15:35:44.397

我建议阅读[Code Complete 第 2 版](http://www.cc2e.com/)中的第 20-22 章。它很好地涵盖了软件质量。

以下是一些关键点的快速细分（所有功劳归于 McConnell，2004 年）

[第 20 章](http://www.cc2e.com/page.aspx?hid=156)- 软件质量景观：

*   没有一种单一的缺陷检测技术本身是完全有效的
*   越早发现缺陷，它与其他代码的交织就越少，造成的损害就越小

[第 21 章](http://www.cc2e.com/page.aspx?hid=157)- 协同建设：

*   协作开发实践往往比测试发现更高百分比的缺陷并更有效地发现它们
*   与测试相比，协作开发实践往往会发现不同类型的错误，这意味着您需要同时使用审查和测试来确保软件的质量
*   结对编程的成本通常与检查相同，并产生类似的质量代码

[第 22 章](http://www.cc2e.com/page.aspx?hid=158)- 开发人员测试：

*   自动化测试通常很有用，对于回归测试至关重要
*   改进你的测试过程的最好方法是让它有规律，测量它，并用你学到的东西来改进它
*   在代码之前编写测试用例与在代码之后编写测试用例所花费的时间和精力相同，但它缩短了缺陷检测-调试-纠正-周期（测试驱动开发）

至于如何制定单元测试，您应该考虑基础测试、数据流分析、边界分析等。所有这些都在本书中进行了详细解释（其中还包括许多其他参考资料供进一步阅读）。

也许这不是您要问的，但我会说自动化测试绝对不足以成为一种策略。您还应该考虑结对编程、正式审查（或非正式审查，取决于项目的规模）和测试支架以及自动化测试（单元测试、回归测试等）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-18T14:02:03.760

仅仅根据您是否对每个方法和功能都进行了测试，真的不可能知道您是否有足够的测试。通常我会将测试与覆盖分析结合起来，以确保我的所有代码路径都在我的单元测试中得到执行。即使这还不够，但它可以指导您在哪里引入了您的测试未执行的代码。这应该表明需要编写更多测试，或者，如果您正在执行 TDD，则需要放慢速度并更加自律。:-)

测试应该涵盖好的和坏的路径，尤其是在单元测试中。您的验收测试可能或多或少关注不良路径行为，但至少应该解决可能出现的常见错误。根据您的故事的完整程度，验收测试可能会或可能不会足够。验收测试和故事之间通常存在多对一的关系。如果您对每个故事只有一个自动验收测试，那么您可能没有足够的测试，除非您有不同的故事用于替代路径。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-18T14:10:08.547

多层测试可能非常有用。单元测试以确保各个部分的行为；集成表明协作单元集群按预期进行合作，“验收”测试表明程序按预期运行。每个都可以在开发过程中发现问题。重叠*本身*并不是一件坏事，尽管太多会变成浪费。

话虽如此，可悲的事实是，您永远无法确保产品“按预期”运行，因为预期是一个善变的、人性化的东西，在纸上的翻译效果很差。良好的测试覆盖率不会阻止客户说“这不是我的想法......”。频繁的反馈循环对此有所帮助。将频繁的演示视为添加到您的手动组合中的“健全性测试”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-11-30T20:06:22.627

可能不会，除非您的软件非常非常简单并且只有一个组件。

单元测试非常具体，你应该用它们彻底涵盖所有内容。在这里寻求高代码覆盖率。但是，它们一次只涵盖一项功能，而不是事物如何协同工作。验收测试应该只覆盖客户真正关心的高层次的东西，虽然它会捕捉到一些事情如何协同工作的错误，但它不会捕捉到所有的东西，因为编写此类测试的人不会深入了解系统。

最重要的是，这些测试可能不是由测试人员编写的。单元测试应该由开发人员编写并由开发人员（最好也由构建系统）频繁运行（最多每几分钟，取决于编码风格）。验收测试通常由客户或代表客户的人编写，考虑什么对客户来说很重要。但是，您还需要由测试人员编写的测试，像测试人员一样思考（而不是像开发人员或客户那样）。

您还应该考虑以下类型的测试，这些测试通常由测试人员编写：

*   功能测试，将涵盖部分功能。这可能包括 API 测试和组件级测试。您通常也需要良好的代码覆盖率。
*   集成测试，将两个或多个组件放在一起以确保它们一起工作。例如，当另一个组件期望对象的计数（“第 n 个对象”，即从 1 开始）时，您不希望一个组件在数组中输出对象所在的位置（从 0 开始）。这里，重点不是代码覆盖，而是组件之间接口（通用接口，不是代码接口）的覆盖。
*   系统级测试，您将所有内容放在一起并确保其端到端工作。
*   测试非功能性特性，如性能、可靠性、可扩展性、安全性和用户友好性（还有其他特性；并非所有特性都与每个项目相关）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-18T14:04:46.390

集成测试适用于当您的代码与其他系统（例如 3rd 方应用程序）或其他内部系统（例如环境、数据库等）集成时。使用集成测试来确保代码的行为仍然符合预期。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-18T14:26:19.390

**简而言之，没有。**

首先，你的故事卡应该有验收标准。也就是说，产品所有者指定的验收标准与分析师一起指定所需的行为，如果满足，故事卡将被接受。

验收标准应该驱动自动化单元测试（通过 TDD 完成）和自动化回归/功能测试，这些测试应该每天运行。请记住，我们希望将缺陷移到左侧，也就是说，我们越早找到它们，修复它们的成本就越低、速度越快。此外，持续测试使我们能够自信地进行重构。这是保持可持续发展步伐所必需的。

此外，您需要自动化的性能测试。每天或夜间运行分析器可以深入了解 CPU 和内存的消耗以及是否存在任何内存泄漏。此外，像 loadrunner 这样的工具将使您能够在系统上放置反映实际使用情况的负载。您将能够测量生产环境中的响应时间以及 CPU 和内存消耗，例如机器运行 loadrunner。

自动化性能测试应反映应用程序的实际使用情况。您测量业务事务的数量（即，如果 Web 应用程序单击页面以及对用户的响应或到服务器的往返行程）。并确定此类事务的组合以及它们每秒到达的速率。此类信息将使您能够正确设计性能测试应用程序所需的自动负载运行程序测试。通常情况下，一些性能问题将追溯到应用程序的实现，而另一些则由服务器环境的配置决定。

请记住，您的应用程序将进行性能测试。问题是，第一次性能测试会在您发布软件之前还是之后进行。相信我，出现性能问题的最糟糕的地方是在生产中。性能问题可能是最难修复的，并且可能导致部署到所有用户失败，从而取消项目。

最后，还有用户验收测试 (UAT)。这些是由生产所有者/业务合作伙伴设计的测试，用于在发布之前测试整个系统。通常，由于所有其他测试，应用程序在 UAT 期间返回零缺陷的情况并不少见。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-18T14:40:19.970

这取决于您的系统有多复杂。如果您的验收测试（满足客户要求）从前到后运行您的系统，那么您不会。

但是，如果您的产品依赖于其他层（如后端中间件/数据库），那么您确实需要一个测试来证明您的产品可以愉快地端到端连接。

正如其他人所评论的那样，测试不一定能证明项目按预期运行，只是您期望它如何工作。

对客户的频繁反馈循环和/或以客户理解的方式编写/可解析的测试（例如以[BDD 风格](http://dannorth.net/introducing-bdd "行为驱动开发")）确实有帮助。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-18T15:09:42.717

从技术上讲，一整套验收测试应该涵盖所有内容。话虽如此，对于大多数足够的定义来说，它们还不够“足够”。通过单元测试和集成测试，您可以更早地以更本地化的方式捕获错误/问题，从而更容易分析和修复它们。

考虑到一整套手动执行的测试，以及写在纸上的说明，就足以验证一切是否按预期工作。但是，如果您可以自动化测试，您会做得更好，因为它使测试变得更加容易。纸质版是“完整的”，但不是“足够的”。同理，每一层的测试都增加了“足够”的价值。

还值得注意的是，不同的测试集倾向于从不同的“观点”测试产品/代码。就像 QA 可能会发现开发人员从未想过要测试的错误一样，一组测试可能会发现另一组测试不会发现的东西。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-18T15:42:46.053

> 如果我对每个类和/或成员函数进行单元测试，并对每个用户故事进行验收测试，我是否有足够的测试来确保项目按预期运行？

这足以表明您的软件在**功能上是正确**的，至少在您的测试覆盖率足够的情况下。现在，根据您正在开发的内容，肯定有非功能性需求很重要，请考虑可靠性、性能和可扩展性。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-10-06T13:30:52.920

如果手头的系统很小，甚至可以由客户手动进行验收测试。

单元和小型集成测试（由类似单元的测试组成）可让您构建可持续的系统。

不要尝试为系统的每个部分编写测试。这是易碎的（容易折断）和压倒性的。

确定系统的关键部分，这些部分需要花费太多时间来手动测试并仅为该部分编写验收测试，以使每个人都能轻松完成。

# c++ - 编译 Symbian C++ 应用程序时找不到 CRSAPKCS1v15Encryptor 类

> ID：877820
> 
> 赞同：1
> 
> 时间：2009-05-18T13:46:48.143
> 
> 标签：c++, symbian

我用 symbian c++ 编写过代码，但我遇到了一个问题

> 没有为 aes 算法找到 CRSAPKCS1v15Encryptor 类

对于 symbian 中的 rsa 算法

> 未找到 cryptosymmetric.h cryptopadding.h 文件

是否需要任何插件以及相同功能的任何其他替代方案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T13:53:42.153

确保您安装了一些提供头文件和 CRSAPKCS1v15Encryptor 类的 SDK。也许您需要告诉编译器搜索这些文件的路径。另外看看[这里](http://wiki.forum.nokia.com/index.php/Asymmetric_crypto)的例子和评论可能会对你有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T16:39:57.653

有关 API 包的信息和直接链接，请访问：[http ://wiki.forum.nokia.com/index.php/AES_Encryption-Rijndael_Block_Cipher_to_Symbian_OS](http://wiki.forum.nokia.com/index.php/AES_Encryption-Rijndael_Block_Cipher_to_Symbian_OS)

您不知道所有 Symbian 编程问题在[http://www.forum.nokia.com](http://www.forum.nokia.com)上都有答案吗？

# javascript - 生成的 Javascript 不执行

> ID：877826
> 
> 赞同：0
> 
> 时间：2009-05-18T13:47:41.743
> 
> 标签：javascript, jquery, html, air

我正忙着编写一个简单的 Adob​​e Air 应用程序，它使用 HTML、jQuery 和一些 jQuery 插件来加载 RSS 提要。

我遇到的问题是我正在生成一段 HTML 组件（按钮），以便我可以在单击按钮时执行特定代码。但是当页面显示时，按钮永远不会执行；我尝试过使用内置的日志功能以及警报，但它们都没有执行。奇怪的是，当我将 HTML 组件复制到未生成的页面部分时，它执行得很好。

我使用 jQuery 将以下内容插入到 div 中，但它不执行。

```
'<input type="button" onclick="LoadPage()" value="Test" />' 
```

如果我只是将它插入到 HTML 中，它就可以正常工作。
我正在使用 jQuery 的 1.3.2 版本；我也在使用[这个插件](http://atalayasec.org/js/feedreader.js)将数据加载到一个 div 中，并且我已经修改了第 82 行以包含上面的 html 组件。

我应该注意，当我使用 AIR 的内省器检查页面时，HTML 是有效的。

可能出了什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T13:54:34.930

我没有看到问题。以下对我来说很好：

```
$(document).ready(function() {
  $('#mainDiv').html('<input type="button" onclick="LoadPage()" value="Test" />');
});

function LoadPage()
{
  alert("Hello");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T13:50:37.620

如果你想使用 jquery 来处理点击，你可以使用[live](http://docs.jquery.com/Events/live)事件。

我前段时间也遇到过这个问题，这解决了这个问题。

如果你给你的按钮一个 id 看起来像这样：

```
$("#YourButtonId").live("click", function (){.... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T13:52:16.853

'onClick' 而不是 'onclick' 有同样的问题吗？还要检查该函数是否被称为“Loadpage”而不是“LoadPage”。

我有时在 javascript 中遇到区分大小写的问题，不确定它是否是区分大小写的函数。

# iphone - UIScrollView 触摸与子视图触摸

> ID：877828
> 
> 赞同：7
> 
> 时间：2009-05-18T13:47:53.273
> 
> 标签：iphone, objective-c, cocoa-touch, uiscrollview

请问有人可以帮忙整理一个菜鸟吗？我已经在各种论坛上发布了这个问题并且没有收到任何答案，而许多其他答案的搜索都出现了 stackOverflow，所以我希望这是这个地方。

我有一个 BeachView.h（UIScrollView 的子类，沙滩的图片），上面覆盖着随机数的 Stone.h（UIImageView 的子类，石头的随机 PNG，userInteractionEnabled = YES 接受触摸）。

如果用户在海滩上触摸并移动，它应该滚动。如果用户点击石头，它应该调用方法“touchedStone”。如果用户点击没有石头的海滩，它应该调用方法“touchedBeach”。

现在，我意识到这听起来很简单。每个人都告诉我，如果 UIScrollView 上有什么东西可以接受触摸，它应该将控制权传递给它。所以当我触摸和拖动时，它应该滚动；但是如果我点击，并且它在石头上，它应该忽略海滩水龙头并接受石头水龙头，是吗？

但是，似乎两个视图都接受了点击并调用了touchedStone 和touchedBeach。此外，海滩水龙头首先发生，所以我什至不能输入“如果接触石头，那么不要运行接触海滩”类型的标志。

这是一些代码。在 BeachView.m 上

```
 - (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
     if (self.decelerating) { didScroll = YES; }
        else { didScroll = NO; }

     UITouch *touch = [[event allTouches] anyObject];
     CGPoint touchLocation = [touch locationInView:touch.view];
     NSLog(@"touched beach = %@", [touch view]);
     lastTouch = touchLocation;
     [super touchesBegan:touches withEvent:event];
}

-(void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
     didScroll = YES;
     [super touchesMoved:touches withEvent:event];
}

-(void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
     if (didScroll == NO && isPaused == NO) { 
          [self touchedBeach:YES location:lastTouch];
     }
     [super touchesEnded:touches withEvent:event];
} 
```

在石头.m

```
 -(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
     [parent stoneWasTouched]; // parent = ivar pointing from stone to beachview
}

-(void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
     UITouch *touch = [[event allTouches] anyObject];
     CGPoint touchLocation = [touch locationInView:touch.view];
     NSLog(@"touched stone = %@", [touch view]);
     [parent touchedStone:YES location:touchLocation];
} 
```

石敲之后，我的 NSLog 看起来像这样：

```
 Touched beach = <BeachView: 0x1276a0>
ran touchedBeach
Touched Stone = <Stone: 0x1480c0>
ran touchedStone 
```

所以实际上两者都在运行。更奇怪的是，如果我将 touchesBegan 和 touchesEnded 从 Stone.m 中取出，但保留 userInteractionEnabled = YES，则 beachView 会自行注册这两个触摸，但将 Stone 作为它触摸的视图返回（第二次）。

```
 Touched beach = <BeachView: 0x1276a0>
ran touchedBeach
Touched beach = <Stone: 0x1480c0>
ran touchedBeach 
```

所以拜托，我这几天一直在努力解决这个问题。我怎样才能使敲击的石头只调用touchedStone，而敲击的海滩只调用touchedBeach？我哪里错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-11-03T16:52:43.763

是的，iPhone SDK 3.0 及更高版本，不要再将触摸传递给`-touchesBegan:`和 - `touchesEnded:`** `UIScrollview`**子类方法。你可以使用不一样的`touchesShouldBegin`和`touchesShouldCancelInContentView`方法。

如果你真的想接触到这个，有一个允许这个的*黑客。*

在您的`UIScrollView`覆盖子类中，`hitTest`方法如下：

```
- (UIView *)hitTest:(CGPoint)point withEvent:(UIEvent *)event {

  UIView *result = nil;
  for (UIView *child in self.subviews)
    if ([child pointInside:point withEvent:event])
      if ((result = [child hitTest:point withEvent:event]) != nil)
        break;

  return result;
} 
```

这将传递给你这个触摸的子类，但是你不能取消对`UIScrollView`超类的触摸。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T14:23:20.177

在 iPhone OS 3.0 之前，UIScrollView 的 hitTest:withEvent: 方法总是返回 self 以便它直接接收 UIEvent，仅当它确定它与滚动或缩放无关时才将其转发到适当的子视图。

我无法真正评论 iPhone OS 3.0，因为它在 NDA 下，但请查看您的“iPhone SDK Release notes for iPhone OS 3.0 beta 5”:)

如果您需要针对 3.0 之前的版本，您可以在 BeachView 中覆盖 hitTest:withEvent: 并设置一个标志以在 CGPoint 实际上位于石头中时忽略下一次海滩触摸。

但是您是否尝试过简单地将调用 [super touches*:withEvent:] 从覆盖方法的末尾移到开头？这可能会导致先进行石敲击。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-19T05:52:40.503

我对 a 有类似的问题，`simpleView`它被添加到 a`scrollView`中，每当我触摸 时`simpleView`，`scrollView`用于获取触摸的不是 simpleView，而是`scrollView`移动的。为避免这种情况，我禁用了`scrollView`用户触摸时的 srcolling，`simpleView`否则启用滚动。

```
- (UIView *)hitTest:(CGPoint)point withEvent:(UIEvent *)event {

    UIView *result = [super hitTest:point withEvent:event] ;
    if (result == simpleView)
    {
        scrollView.scrollEnabled = NO ;
    }
    else
    {
        scrollView.scrollEnabled = YES ;
    }

    return result ;

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-26T21:11:49.580

这可能与 iOS7 中的错误有关，请查看我的问题（已提交错误报告）

[UIScrollView 子类在 iOS7 中改变了行为](https://stackoverflow.com/questions/20202905/uiscrollview-subclass-has-changed-behavior-in-ios7)

# svn - 重新集成到主干后使用颠覆功能分支是否安全？

> ID：877830
> 
> 赞同：22
> 
> 时间：2009-05-18T13:48:04.553
> 
> 标签：svn, tortoisesvn, merge, svn-reintegrate

合并（重新集成）回主干后必须删除功能分支吗？

我更喜欢不断地从我的功能分支来回合并更改 - 我相信这可以将冲突降至最低。但是我知道，一旦您使用 reintegrate 合并到主干，应该删除功能分支。

是这样吗？为什么？我能做些什么来规避这种情况？

**更新** 我问的是来自工具的技术问题，而不是“方法问题”。我打算在合并后继续在功能分支上工作。

**更新**最佳答案确实指定了一个相当复杂的过程（合并、删除和重新分支）。在 TortoiseSVN 中是否有一种简单的方法可以实现这一点？不应该吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-18T21:13:38.210

**编辑**：**这个问题似乎已在 SVN 1.8 中修复。**[SVN 1.8 书中关于基本合并](http://svnbook.red-bean.com/en/1.8/svn.branchmerge.basicmerging.html#idp11104528)的部分已更新为可以重用功能分支。下面的答案仅适用于较旧的 SVN 版本。

* * *

从svn book 中的[基本合并部分：](http://svnbook.red-bean.com/en/1.5/svn.branchmerge.basicmerging.html)

> 在 Subversion 1.5 中，一旦从分支到主干的 --reintegrate 合并完成，该分支就不再可用于进一步的工作。它无法正确吸收新的主干更改，也无法再次正确重新集成到主干。出于这个原因，如果您想继续处理您的功能分支，我们建议您销毁它，然后从主干重新创建它：

在 SVN 1.6 和 1.7 中仍然是这种情况。

这篇[关于反射合并的优秀文章](http://blogs.collab.net/subversion/2008/07/subversion-merg/)解释了*为什么*你不能或不应该回收特性分支。最重要的几点总结：

*   在与主干重新集成时，您可能会努力解决冲突
*   因此，主干中的重新集成提交包含来自功能分支的更改*和* 冲突解决工作
*   但是，颠覆不会帮助您将此冲突解决工作合并回功能分支。它只是查看 mergeinfo 并认为“这些更改最初来自功能分支，无需再次将它们合并到它们的原点”。

删除功能分支并重新分支很便宜，并且可以避免整个问题。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-18T22:04:09.340

我们经常这样做（SVN 1.5 及更高版本）。您只需要确保不要将这些更改重新合并到分支中。

为此，只需将一系列修订从主干合并到分支。在主干中指定您对分支进行重新集成的修订，并将其标记为从主干修订到分支的“仅记录合并”。

一旦你这样做了，你应该很高兴。

**编辑**
wcoenen 从有关冲突的文章中提出的观点是有效的。如果您在重新集成之前没有将主干更改同步到分支中，您将遇到冲突问题。我们使分支保持同步，并且在多次重新集成后继续重用分支没有问题。

**编辑 2**

**使重新集成的分支保持活动**状态 ( [http://svnbook.red-bean.com/en/1.7/svn.branchmerge.advanced.html](http://svnbook.red-bean.com/en/1.7/svn.branchmerge.advanced.html) )

在重新集成后，除了销毁和重新创建分支之外，还有另一种方法。要了解它为什么起作用，您需要了解为什么分支在重新集成后最初不适合进一步使用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-01-16T22:49:58.060

是的，您可以进行仅记录合并以使分支保持活动状态。

请参阅Subversion Book 中的[使重新集成的分支保持活动状态。](http://svnbook.red-bean.com/nightly/en/svn.branchmerge.advanced.html#svn.branchmerge.advanced.reintegratetwice)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-09-12T19:45:54.130

Subversion 1.8 允许您在两个分支之间反复来回合并，而 1.7 和更早版本则不允许。在此处阅读发行说明：http: [//subversion.apache.org/docs/release-notes/1.8.html#auto-reintegrate](http://subversion.apache.org/docs/release-notes/1.8.html#auto-reintegrate)。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-18T13:53:33.527

这一切都取决于您的个人意见，以及合并到主干的人数。

如果你有很多人合并，那么最好只在一个分支完成后合并它，然后删除它（你总是可以通过返回它存在的最后一个修订来访问它）。如果你试图在这种情况下不断合并，你只会让自己感到困惑。

但是，如果您没有很多子分支，并且您使用的是 subversion 1.5+，则可以避免这种情况，这有助于避免合并冲突。

当然，如果您的“主干”被用作 beta/候选发布/发布存储库，那么您不应该这样做。

# sharepoint - SharePoint 异常文档

> ID：877835
> 
> 赞同：1
> 
> 时间：2009-05-18T13:49:12.677
> 
> 标签：sharepoint, exception

我想知道在哪里可以找到有关 SharePoint 对象模型引发的异常的一些信息。不幸的是，MSDN 上的文档并不是很有用，因为许多方法的文档缺乏关于可能抛出哪些异常以及在何种情况下将抛出它们的信息。

那么，您从哪里获得有关异常的信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T20:43:07.367

不幸的是，最好的答案是视情况而定。很多时候，我会从谷歌搜索错误文本开始。

如果您正在寻找 SharePoint 抛出的可能异常的通用列表，您会非常失望。那里没有我所知道的。

随着时间的推移，你会认识到对你有帮助的模式。

例如，我见过的一个常见异常是“FileNotFound”。如果我要求 SharePoint 打开不存在的 SPWeb 或 SPList，通常会发生这种情况。

# asp.net - Set Path dynamically in Forms Authentication

> ID：877838
> 
> 赞同：1
> 
> 时间：2009-05-18T13:50:11.083
> 
> 标签：asp.net, cookies, web-config, session-state

Here's the problem we facing.

In a hosted environment setup, we're hosting the same project multiple times. We currently manually specify a Path in the forms config section of our web.config. However, to smooth out our deployment process, we'd like to set the Path depending on the Virtual Directory name.

Is there a way for us to dynamically set the Path in the web.config?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T19:29:13.567

There's an overload of `FormsAuthentication.SetAuthCookie` that takes the cookie path as a parameter, so if you're handling the login process yourself then you can just pass the path of your choice.

The problem is that the standard `System.Web.UI.WebControls.Login` will only use the default path value. You could, however, handle the `LoggedIn` event to fix the path...

```
void FixCookie( object sender, EventArgs args )
{
    Response.Cookies[FormsAuthentication.FormsCookieName].Path = "/my-custom-path";
} 
```

# .net - 阻止 .net 控制台应用程序关闭

> ID：877839
> 
> 赞同：8
> 
> 时间：2009-05-18T13:50:31.130
> 
> 标签：.net, console

有什么方法可以阻止 .NET 控制台应用程序关闭？我有一个遵循这种模式的应用程序：

```
while (true)
{
    string x = Console.ReadLine();
    StartLongRunningTaskOnSeparateThread(x);
} 
```

问题是可以关闭控制台窗口（因此切断长时间运行的任务）。控制台应用程序是否有等效的 Forms.OnClosing 事件？

编辑 - 我不是想创造一些不可能杀死的东西，只是可能会发出警告信息，例如“嘿，我还没完成。你确定要关闭我吗？”

EDIT2 - 防止通过“x”按钮过早退出比阻止 Ctrl-C（我使用过`Console.TreatControlCAsInput = true;`）更重要。为此目的，假设任何启动任务管理器的人都想杀死程序，以至于他们应该能够这样做。并且最终用户宁愿看到警告也不愿意外取消他们长时间运行的任务。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-18T15:34:02.513

这是我解决这个问题的尝试。任务管理器仍然可以关闭应用程序。但是，我的想法是尝试检测它何时关闭，然后重新启动它。但是，我没有实现那部分。

**以下程序将检测到 CTRL-C && CTRL-BREAK 并继续运行。**

**编辑：**删除了“X”按钮

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.ComponentModel;
using System.Runtime.InteropServices;
using System.Diagnostics;

namespace DoNotCloseMe
{
    class Program
    {

        const string _title = "DO NOT CLOSE - Important Program";

        static void Main(string[] args)
        {

            Console.Title = _title;

            IntPtr hMenu = Process.GetCurrentProcess().MainWindowHandle;
            IntPtr hSystemMenu = GetSystemMenu(hMenu, false);

            EnableMenuItem(hSystemMenu, SC_CLOSE, MF_GRAYED);
            RemoveMenu(hSystemMenu, SC_CLOSE, MF_BYCOMMAND);

            WriteConsoleHeader();

            //This function only seems to be called once.
            //After calling MainLoop() below, CTRL-C && CTRL-BREAK cause Console.ReadLine() to return NULL 
            Console.CancelKeyPress += (sender, e) =>
            {
                Console.WriteLine("Clean-up code invoked in CancelKeyPress handler.");
                Console.WriteLine("Key Pressed: {0}", e.SpecialKey.ToString());
                System.Threading.Thread.Sleep(1000);
                MainLoop();
                // The application terminates directly after executing this delegate.
            };

            MainLoop();

        }

        private static void MainLoop()
        {
            while (true)
            {
                WriteConsoleHeader();
                string x = Console.ReadLine();
                if (!String.IsNullOrEmpty(x))
                {
                    switch (x.ToUpperInvariant())
                    {
                        case "EXIT":
                        case "QUIT":
                            System.Environment.Exit(0);
                            break;
                        default:
                            StartLongRunningTaskOnSeparateThread(x);
                            break;
                    }

                }
            }
        }

        private static void StartLongRunningTaskOnSeparateThread(string command)
        {
            var bg = new System.ComponentModel.BackgroundWorker();
            bg.WorkerReportsProgress = false;
            bg.WorkerSupportsCancellation = false;

            bg.DoWork += (sender, args) =>
            {
                var sleepTime = (new Random()).Next(5000);
                System.Threading.Thread.Sleep(sleepTime);
            };

            bg.RunWorkerCompleted += (sender, args) =>
            {
                Console.WriteLine("Commmand Complete: {0}", command);
            };

            bg.RunWorkerAsync();

        }

        private static void WriteConsoleHeader()
        {
            Console.Clear();
            Console.WriteLine(new string('*', Console.WindowWidth - 1));
            Console.WriteLine(_title);
            Console.WriteLine(new string('*', Console.WindowWidth - 1));
            Console.WriteLine("Please do not close this program.");
            Console.WriteLine("It is maintaining the space/time continuum.");
            Console.WriteLine("If you close it, Q will not be happy and you will be assimilated.");
            Console.WriteLine(new string('*', Console.WindowWidth - 1));
            Console.WriteLine("Development Mode: Use \"EXIT\" or \"QUIT\" to exit application.");
            Console.WriteLine(new string('*', Console.WindowWidth - 1));
        }

        #region "Unmanaged"

        [DllImport("user32.dll")]
        static extern bool EnableMenuItem(IntPtr hMenu, uint uIDEnableItem, uint uEnable);

        [DllImport("user32.dll")]
        static extern IntPtr GetSystemMenu(IntPtr hWnd, bool bRevert);

        [DllImport("user32.dll")]
        static extern IntPtr RemoveMenu(IntPtr hMenu, uint nPosition, uint wFlags);

        internal const uint SC_CLOSE = 0xF060;
        internal const uint MF_GRAYED = 0x00000001;
        internal const uint MF_BYCOMMAND = 0x00000000;

        #endregion
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T14:01:03.433

这不是万无一失的，因为显然任务管理器或关闭就足以停止任务，但是，如果您将应用程序编写为服务，那么至少它不会坐在桌面上并带有诱人的“x”以供人们点击?

编辑：根据您的评论。需要用户输入但您无法重写的控制台应用程序始终可以使用“x”关闭。

重写即服务并不是一项艰巨的任务。服务实际上只不过是带有一些包装代码的可执行文件。

困难来自用户输入。但是，您可以将长时间运行的线程编写为服务，但有一个控制台应用程序来传递指令以运行线程。

或者，如果您只是想阻止人们意外按下“x”，为什么不在控制台应用程序的前 10 行填写“重要过程不要关闭！！”

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T14:48:32.417

你为什么不写一个小的 Winforms 前端？当用户关闭时提供视觉反馈更容易。您可以禁用去最小化/最大化/关闭按钮。

我的意思是，运行可以执行您的工作的超薄 winforms 应用程序不会受到任何惩罚。

我假设你在 Windows 上，但如果这是 Mono.NET，你可以使用 GTK 或类似的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T14:10:04.803

> 有什么方法可以阻止 .NET 控制台应用程序关闭？

不可以。您可以阻止 control-C（参见`Console.CancelKeyPress`事件），但不能阻止 control-break。

如果您需要一些难以停止的东西，您需要考虑创建一个 Windows 服务，并使用 ACL 来阻止它被停止（系统除外......因此系统可以关闭）。

补充：如果需要用户交互，则将应用程序分成两部分。一个持续运行的服务，暴露一个进程间入口点。以及提供交互性并使用进程间通信与服务进行通信的 UI。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T15:38:06.920

我不会阻止用户关闭应用程序。我要做的就是在你开始这个过程时给他们一个警告，说“这可能需要几分钟。请稍候......”

然后，如果他们决定杀死它，他们就会杀死它。

就我个人而言，我不喜欢一个过程夺走了我太多的控制权。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T13:54:08.940

对于控制台应用程序，我不知道 Forms.OnClosing 的任何等效功能。然而，即使 Forms.OnClosing 也不是防止应用程序关闭的万无一失的方法。我可以很容易地在任务管理器中找到该程序并将其杀死。这将完全绕过 Forms.OnClosing 技巧并粗暴地关闭您的应用程序。您无法采取任何措施来防止这种情况发生。

你能给我们更多关于你为什么要这样做的背景吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-09T12:38:01.147

```
 [DllImport("Kernel32")]
    public static extern bool SetConsoleCtrlHandler(HandlerRoutine Handler, bool Add);

    // An enumerated type for the control messages
    // sent to the handler routine.
    public enum CtrlTypes
    {
        CTRL_C_EVENT = 0,
        CTRL_BREAK_EVENT,
        CTRL_CLOSE_EVENT,
        CTRL_LOGOFF_EVENT = 5,
        CTRL_SHUTDOWN_EVENT
    }

    // A delegate type to be used as the handler routine 
    // for SetConsoleCtrlHandler.
    public delegate bool HandlerRoutine(CtrlTypes CtrlType);

    private static bool ConsoleCtrlCheck(CtrlTypes ctrlType)
    {
        Trace.WriteLine("** Received termination event : " + ctrlType.ToString());
        return true;
    }

    static void Main(string[] args)
    {

        SetConsoleCtrlHandler(new HandlerRoutine(ConsoleCtrlCheck), true);

    } 
```

# c# - 在 Winform 上托管 VisualStudio 并最小化启动它

> ID：877842
> 
> 赞同：0
> 
> 时间：2009-05-18T13:51:03.313
> 
> 标签：c#, .net, winforms

我正在尝试将 Visual Studio 作为用户控件嵌入（以使用户能够编辑生成的源文件）。基本上大部分细节都可以在一个很好的 CodeProject 条目中找到[Hosting EXE Applications in a WinForm project](http://www.codeproject.com/KB/miscctrl/AppControl.aspx)。

困扰我的是，在将 VS 作为一个新进程启动后，它需要一些时间才能在表单上稳定下来。在此期间，我希望将其隐藏，因此我尝试了：

```
process.StartInfo.WindowStyle = ProcessWindowStyle.Hidden 
```

还尝试打开 ProcessStrartInfo 的“CreateNoWindow”，但没有成功。（作为一个附带问题，我正在使用 process.WaitForInputIdle() 在捕获其窗口句柄之前等待 VS，但在某些机器上，调用只是立即返回）。

有什么线索吗？其他建议？提前谢谢。罗比

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T14:14:48.867

如果您只是希望您的用户能够在您的应用程序中编辑源文件，我建议您使用带有语法突出显示的文本编辑控件，而不是在您的项目中嵌入 Visual Studio。一种选择是**ICSharpCode.TextEditor**。

[您可以在此 CodeProject 文章](http://www.codeproject.com/KB/edit/TextEditorControl.aspx)中找到有关它的更多信息。

# sifr - sIFR 能否在蓝线上显示字体（如在笔记本纸上书写）？

> ID：877843
> 
> 赞同：0
> 
> 时间：2009-05-18T13:51:08.010
> 
> 标签：sifr

我遇到了一个用例，企业希望以手写字体显示问题的答案。所以，我最初的想法是使用 sIFR，但用例的另一部分是他们想要蓝线上的手写字体，类似于在纸质记事本或笔记本上书写。sIFR 可以做一个风格化的字体 + 笔记本线条，还是我需要使用另一种技术？先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T14:17:49.377

是的。您可以按照此处的教程来获得您的蓝线：[使用自定义类型和 sIFR](http://www.netmag.co.uk/zine/flash-1/use-custom-type-with-sifr)

但是，我会告诫不要在整个文本段落中使用 sIFR。Mike Davidson 在他的最佳实践中提到了这[一点](http://www.mikeindustries.com/blog/sifr/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T20:42:29.687

Raithlin，感谢您提供文章链接。我阅读了 Mike Davidson 的页面，我意识到替换过多文本的问题。这是我会警告商业用户的事情。

# flash - 多个 MC，单个听众，AsBroadcaster

> ID：877846
> 
> 赞同：1
> 
> 时间：2009-05-18T13:51:34.530
> 
> 标签：flash, actionscript-2

我目前正在尝试在一个容器 MC 中拥有多个 MC，当单击它们的迷你 MC 时，它们会广播一条消息，以便我可以对它们采取行动。这在 AS 3 中很简单，因为它是 mc.addEventListener(MouseEvent.CLICK, obj); 但是，这是 AS 2，所以我半被迫使用 broadcastMessage('myMessage'); 和 mc.addListener(obj); 事件处理程序。

主要问题是广播公司没有广播任何消息。

第二个问题是有 5 个 MC，当我单击其中一个时，我会收到 5 条有关单击的跟踪消息。我似乎无法保持 MC 点击的唯一性，即使它们在属性面板中都被赋予了单独的实例名称。

任何帮助，将不胜感激。

我的代码的链接在[这里（pastie.org #481511）](http://pastie.org/481511)。你能看出有什么不对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T18:33:25.770

弄清楚了。最终不得不使用 hitTest() 方法来查看点击是否在特定的影片剪辑中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T14:24:57.113

我已经回答了一半。在调用 broadcastMessage() 之前我错过了一个“this”，所以一旦我将它更改为 this.broadcastMessage('myMessage', this) 它就开始工作了。

一个影片剪辑的 5 个不同实例（即从库中拖放 5 次并将它们命名为不同的实例名称）仍然存在问题，它们都同时调用相同的广播消息。我得到以下输出：

```
对象：_level0.instance1.photo5
对象：_level0.instance1.photo4
对象：_level0.instance1.photo3
对象：_level0.instance1.photo2
对象：_level0.instance1.photo1
```

# ruby - Ruby：客户端还是服务器端？

> ID：877848
> 
> 赞同：8
> 
> 时间：2009-05-18T13:52:14.997
> 
> 标签：ruby, server-side, client-side

Ruby 是客户端语言还是服务器端语言？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-18T14:02:06.410

两个都？

毕竟，有一些 Ruby 程序不用作客户端-服务器架构的一部分。

如果您谈论的是 Ruby on Rails，那么它通常仅用于服务器端。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-20T12:56:51.840

Ruby 是一种通用的脚本/编程语言，可以在客户端和服务器环境中执行。

作为客户端，您可以使用它来创建一个 GUI 应用程序（或 CLI 应用程序）来与数据交互、与服务器通信、玩媒体/游戏等。此级别的一些框架示例是 Shoes、MacRuby 等。

作为服务器端，您可以使用它来存储和保存数据、验证和执行事务等。它是 Rails、Merb、Sinatra 等框架发生的地方，它——可以说——是最知名的操作模式。

正如之前的海报所说，在服务器/客户端 Web 应用程序架构的上下文中，Ruby 将在服务器端运行。如果我没记错的话，通过浏览器运行 Ruby 已经取得了一些进步（就像 JS 一样），但可能不是为了满足生产就绪需求而考虑的东西。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-18T16:50:39.333

Ruby（通常）不会在浏览器中执行，因此如果您在 Web 服务器/客户端浏览器的上下文中询问，那么 Ruby 是服务器端的。

当然，您也可以在任何带有 Ruby 解释器的机器上执行独立的 Ruby 代码。它不仅限于 Web 应用程序。

# vbscript - 捕获用于启动 vbscript 的键

> ID：877849
> 
> 赞同：0
> 
> 时间：2009-05-18T13:52:16.073
> 
> 标签：vbscript, keyboard, mapping

我有一个具有“宏”功能的应用程序。当我在键盘上映射一些键以执行“宏”时，我也可以让它启动 vbscript。

我想尝试做的是在我的 vbscript 中找出用于启动脚本的键。可以这样做吗？vbscript 中是否有一种方法可以找出键盘上最后一次触摸的键，然后我可以应用我的逻辑。

这样做的目的是将代码保存在单个 .vb 文件中，而不是几个单独的 .vb 脚本文件（每个键盘映射一个，可能 3-4 个）。显然，我们希望只维护 1 个文件而不是多个文件，每个文件中的代码基本相同。

我倾向于认为这是不可能的，但我认为这对于 StackOverflow 的大众来说是一个有价值的问题。感谢大家的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T15:17:02.157

你所要求的是不可能的。

您可以更改您的 VBScript 以接受参数，然后根据选择的热键使用不同的参数调用它吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T15:40:44.790

我同意 aphoria 的观点，使这种事情成为可能的唯一方法是，如果您的键盘映射软件允许您分配带有参数/参数的脚本/命令。例如，如果您使用

```
c:\Temp\something.vbs 
```

那么你可以把它改成

```
%WINDIR%\system32\wscript.exe c:\temp\something.vbs "Ctrl-Alt-R" 
```

然后在您的 vbscript 代码中，您可以使用 wscript.Arguments 对象集合收集参数，以根据传递的参数/参数执行操作。有关详细信息，请参阅以下两个链接：

[http://msdn.microsoft.com/en-us/library/z2b05k8s(VS.85).aspx](http://msdn.microsoft.com/en-us/library/z2b05k8s(VS.85).aspx) [http://www.microsoft.com/technet/scriptcenter/resources/qanda/sept04/hey0915.mspx](http://www.microsoft.com/technet/scriptcenter/resources/qanda/sept04/hey0915.mspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-05T08:44:17.880

您可以使用的一种可能的方法是安装键盘记录器并在您的 VBScript 中读取其日志。

例如在脚本的最开始保存脚本开始时间

```
StartTime = Timer() 
```

然后在此之前读取您的键盘记录器的一条日志记录。

# c# - 如何在 Vista 中读取注册表分支 HKEY_LOCAL_MACHINE？

> ID：877851
> 
> 赞同：6
> 
> 时间：2009-05-18T13:52:26.227
> 
> 标签：c#, windows-vista, registry

我将应用程序设置存储在 HKEY_LOCAL_MACHINE\SOFTWARE\MyCompany 分支下。不同用户的设置必须相同，这就是设置不在 HKEY_CURRENT_USER 下的原因。仅在使用应用程序期间**读取**注册表值。

现在，在 Windows Vista 中，由于 UAC，您不能再使用以下代码来读取注册表值：

```
RegistryKey myKey = Registry.LocalMachine.CreateSubKey
        ("SOFTWARE\\MyCompany\\MyAppName"); 
```

如何在我的代码 (C#) 中从 LocalMachine 分支读取值？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-18T13:55:52.447

问题是您正在尝试创建一个密钥而不是读取它。如果您使用适当的 API，您应该能够在 Vista 上从 HKLM 读取值。

```
RegistryKey myKey = Registry.LocalMachine.OpenSubKey(
  @"Software\MyCompany\MyAppName", 
  false); 
```

注意上面的 false 参数。这具有以只读模式打开密钥的效果。这是 OpenSubKey 的默认设置，但我更喜欢明确（主要是因为我不记得默认设置）。

# delphi - 填补 CodeGear 许可证空白

> ID：877855
> 
> 赞同：0
> 
> 时间：2009-05-18T13:53:12.420
> 
> 标签：delphi, licensing

我有一个关于 Codegear 许可的讨论点。

Delphi 2009 在两种不同类型的许可下出售（更正确：许可）：

1.  商业许可证
2.  学术许可证

商业许可证（完整和升级）比学术许可证贵得多！

商业许可证的缺点是价格较高，但它的优点是可以进行商业应用。

学术执照的优势在于价格低廉，但有一个问题：你必须证明你是学者、学生或教师！否则你将无法获得许可证！此许可证的非商业性质是非问题！

我想看第三个：

-- 非商业许可

该许可证的价格应尽可能低或稍高一些，并且该许可证不能用于商业用途。许可证应该与购买它的人相关联，就像已经存在的许可证类型一样。

此许可证是否有优势：

1.  爱好者可以使用 Delphi、C++ Builder 和其他 Codegear 软件。
2.  由于价格更实惠，非法使用可能会减少。
3.  它是使用最新 Delphi 创建和维护开源软件的理想许可证。

你怎么看这件事？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T14:03:39.513

Turbo Delphi 可免费使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T21:43:57.213

> 你怎么看这件事？

1) 开源**是**商业的。您可以销售开源软件。

2) 爱好者也可以销售软件……我不明白为什么爱好者愿意花很多钱买相机、吉他、自行车，不管你喜欢什么，但不能花 450 美元买一个 IDE——只是因为你不能复制相机或自行车？？

3) 大多数人都会购买“非商业”版本并开发商业软件——CodeGear 怎么跟踪它？跟踪需要花钱，并且可以抵消任何收入。

4) 非法使用不会减少，但 3) - 使用非法软件的人甚至不愿意支付 30 美元。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T00:37:58.623

以前有一个适合该领域的个人许可证。Turbo 和 Turbo Explorer 版本也适合该领域。问题是有4组：

1.  购买基于功能第一，价格第二（企业等）
2.  按价格购买而不是功能 - 需要便宜，最好是免费的（最喜欢的等）
3.  仅限免费，无需担心许可（盗版）。

第 3 组的特点是盗版 Architect 版本，他们只使用专业版（或免费版，如果存在）中的功能。他们永远不会转换为付费客户，但如果它具有他们想要的所有功能（尽管不太可能），他们可能会转换为免费版本。

试图最大化第二组（将他们全部变成客户）的问题是你不想让第一组的人离开。如果有人根据功能进行购买，而您以更低的价格提供功能较低的版本，他们可能会对该版本感到满意并直接购买。为什么不省钱？

正如其他人所指出的那样，非商业许可证过于模糊。如果您过多地削弱功能，那么提供报价是一种浪费，因为没有人会想要它并且对专业版本的反映很差。唯一可行的就是一个 nag-screen，但这也很烦人，而且用户的本性很容易被绕过。

所以底线是让公司维持生计的资金是最大化第一组。试图安抚第 2 组和第 3 组实际上会导致赔钱。虽然我同意，如果他们想针对更多的爱好，那么他们确实需要免费/低成本的产品（更新的 Turbo 和 Turbo Explorer）。

# linq-to-sql - GroupJoin vs. Where to filter out null 相关项

> ID：877856
> 
> 赞同：0
> 
> 时间：2009-05-18T13:53:22.763
> 
> 标签：linq-to-sql

使用其中任何一个从 TableA 中检索在 TableB 中没有相关元素的元素有什么优势吗？

```
TableA
   .GroupJoin(
      TableB,
      o => o.TableAID,
      i => i.TableAID,
      (o,i) => new {o, child = i.DefaultIfEmpty()})
   .Where(x => x.child.Where(c => c != null).Count() == 0)
   .Select(x => x.o); 
```

或者

```
TableA
   .Where(a => !TableB.Select(b => b.TableAID).Contains(a.TableAID)); 
```

我习惯于使用 SQL 中的左外连接来执行此操作，这是第一个示例类型使用的。第二个示例使用“NOT IN”类型的方法，这不是我以前使用过的方法。

两种方式都返回相同的数据。从简单的角度来看，第二个将是我的首选。第一个有什么优势吗？

你有另一种方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T14:07:26.307

SQL Server 的查询优化器将对 a 和 a 做同样的事情`LEFT JOIN WHERE b is NULL`...`WHERE IN`通过查看估计的执行计划来确认这一点。

# sql-server - 为报告备份 SQL 数据库

> ID：877857
> 
> 赞同：4
> 
> 时间：2009-05-18T13:53:26.443
> 
> 标签：sql-server, backup, replication, log-shipping, sql-server-administration

我正在寻找一些帮助/建议，将两个大型数据库备份到一台专用于报告的服务器。情况是；

我公司的内部网站有两个数据库。一个用于英国，一个用于欧洲。两者都为 DR 镜像。

我在欧洲有一台服务器，专门用于 Microsoft Reporting Services，我们根据这两个数据库中收集的数据运行报告。

出于性能/安全原因，我们不想将报告服务指向实时数据库，因此我们目前每天备份这两个数据库并将它们还原到我们的 Reporting Services 服务器。

然而，这意味着我们通过备份整个数据库给我们的网络带来了压力，而且数据仅在昨天午夜之前是最新的。

我们的目标是让数据至少更新 15 分钟，有人建议查看 Log Shipping，所以我想知道是否有人在设置这个方面有任何经验，优缺点是什么，是否有更好的选择？

任何帮助将不胜感激，谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T16:11:07.913

日志传送是一个很好的解决方案。我们在[SQLServerPedia 的 Log Shipping 部分](http://sqlserverpedia.com/wiki/Log_Shipping)有关于它的文章，我有一个视频教程，通过不同的选项与您交谈。关于日志传送要记住的一件事是，当恢复发生时，您的用户将被踢出报告数据库。

复制没有这个问题，但复制远不及“一劳永逸”——管理起来很费时间，而且不像你希望的那样可靠。此外，您可能必须进行架构修改才能使用复制。日志传送更加自动化和稳定，但代价是在恢复时将用户踢出。

您可以通过设置两个日志传送计划来最小化这种情况 - 一个用于工作时间的白天，一个用于其余时间。在工作时间内，您每小时（或更少）只恢复一次数据，其余时间每 15 分钟恢复一次。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T16:43:09.487

我们开发了一个类似的环境。我们使用镜像将数据传输到我们的报告服务器，并创建了一个自动化例程，每 15 分钟创建一次数据库快照。这些快照只需要 1 到 2 秒就可以在我们的环境中创建，并为我们提供数据库的只读副本。如果您希望我更详细地介绍，请告诉我。

**请注意**，我们在两台服务器上都运行 Enterprise。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T13:59:49.443

您应该将[复制](http://msdn.microsoft.com/en-us/library/ms151198.aspx)视为备份的替代方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T19:50:46.723

我建议您考虑使用事务复制。

听起来好像您正在寻求实现与我们目前正在实现的场景类似的场景。

我们使用事务复制（尽管是实时的，您很可能希望以较低频率同步您的环境）将我们的实时生产数据库的副本卸载到另一台服务器以用于报告目的。

卸载报告数据是一种常见的复制方案，并在 Microsoft 复制文档中进行了描述。

[http://msdn.microsoft.com/en-us/library/ms151784.aspx](http://msdn.microsoft.com/en-us/library/ms151784.aspx)

Brent 是正确的，因为复制确实需要配置元素，以及需要解决的安全问题，但是，在我看来，使用复制有许多关键优势，包括：

*   与日志传送相比，延迟减少。
*   仅发布报告所需的文章（表格）的能力。
*   减少存储需求。
*   更少的数据被发布意味着更少的网络流量。
*   随时访问您的报告数据/数据库。

例如，在我们的环境中，我们决定仅从生产数据库中复制我们实际需要用于报告的特定表（文章）。

我希望我所描述的内容清晰且有意义，但如果您有任何疑问，请随时与我联系。

# data-warehouse - 我在哪里可以在网上找到可以尝试使用数据仓库立方体的真实数据集？

> ID：877862
> 
> 赞同：1
> 
> 时间：2009-05-18T13:54:10.687
> 
> 标签：data-warehouse

我正在研究数据仓库，我必须为我的学习做一个最终项目。

我正在考虑为数据仓库做一个多维数据集。我在哪里可以在网上找到可以尝试做立方体的真实数据集？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T15:02:37.257

You can refer to this page to see how to convert a part of the Northwind database to a star schema for building cubes: [Northwind Star Schema](http://msdn.microsoft.com/en-us/library/aa140038(office.10).aspx#odc_da_whatrcubes_topic2).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-22T00:12:39.047

这是[Adventure Works 的一个示例](http://techpunch.wordpress.com/2008/09/08/sql-server-2008-how-to-build-and-deploy-adventureworks-olap-cubes/)- 当然，它是预构建的 SSAS，但我想您可以查看底层 AventureWorks DB 并自己进行维度建模。

我认为在现有的流行数据集（如 Northwind 或 AdventureWorks）上做 DW 可能不是一个好主意，因为很多人都做过。甚至 StackOverflow 也[完成了数据挖掘](http://www.brentozar.com/archive/2009/06/data-mining-the-stackoverflow-database/)，但也许它会是一个很好的候选者——我不确定 Brent 的工作实际上包括什么。

因此，如果您正在寻找一个原创项目，您可能需要放眼更远的地方，如果只是为了将您的工作与以前的工作区分开来。

# actionscript-3 - 可以将 AS2 swf 加载到 AS3 swf 中吗？如何将它添加到舞台并从 As3 swf 与其交互？

> ID：877871
> 
> 赞同：2
> 
> 时间：2009-05-18T13:56:28.933
> 
> 标签：actionscript-3, migration, actionscript-2, loader, addchild

我正在尝试将用 AS2 编写的 swf 加载到 AS3 swf - 使用 Loader 类并监听 Event.COMPLETE。在我的 onCompleteHandler 函数中，我想将它添加到舞台上，所以我尝试 -

```
addChild(evt.currentTarget.content) 
```

...但我收到以下错误消息：

```
Error #2180: It is illegal to move AVM1 content (AS1 or AS2) to a different part of the displayList when it has been loaded into AVM2 (AS3) content. 
```

AS2 swwf 有很多代码，如果可以避免的话，我真的不想迁移到 AS3。任何人都知道这是否可能或知道将加载的 swf 添加到舞台的不同方法。那么我该如何在加载的 swf 中调用函数呢？

这是一个代码片段 -

```
var loader:Loader = new Loader();
loader.contentLoaderInfo.addEventListener(Event.COMPLETE, onCompleteHandler);
var request:URLRequest = new URLRequest("testLoadSwf.swf");
loader.load(request);

function onCompleteHandler(evt:Event) {
   addChild(evt.currentTarget.content);
} 
```

谢谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T14:22:52.250

唯一真正有效的方法是使用 LocalConnection。AS2 和 AS3 之间无法进行太多通信。如果您仍然可以访问 AS2 文件的源代码，则可以使用 LocalConnection 公开一些函数。还有一个由 Grant Skinner 编写的名为 SWFBridge 的简洁助手类，它为此做了一些基础工作，可在此处获得：[http ://www.gskinner.com/blog/archives/2007/07/swfbridge_easie.html](http://www.gskinner.com/blog/archives/2007/07/swfbridge_easie.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-28T13:10:04.057

var loader:Loader = new Loader(); loader.contentLoaderInfo.addEventListener(Event.COMPLETE, onCompleteHandler); var request:URLRequest = new URLRequest("testLoadSwf.swf"); loader.load（请求）；

function onCompleteHandler(evt:Event) { //addChild(evt.currentTarget.content); } addChild(加载器)

# visual-studio-2010 - 在“Go to Definition”之后，有没有返回到你从哪里来的命令？

> ID：877873
> 
> 赞同：62
> 
> 时间：2009-05-18T13:56:46.250
> 
> 标签：visual-studio-2010, visual-studio, visual-studio-2008

如果是这样，它是一个堆栈吗？
也就是我能不能：
GoToDefinition
GoTODefinition
GoToDefinition

然后弹回调用堆栈？
没有一个 Edit.GoTo... 命令可以满足我的要求。
TIA。

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2009-05-18T13:58:23.097

`CTRL`您可以通过+转到您导航到的最后一个地方`-`

（这是控制键和“减号”或“破折号”键。）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-11-02T13:37:43.247

导航此堆栈的正确方法是使用**View.ForwardBrowseContext**和**View.PopBrowseContext**命令。在默认的 C# 架构中，它们分别绑定到`Ctrl`++和`Shift`++ 。`7``Ctrl``Shift``8`

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-18T14:09:02.980

Brian Sullivan (Ctrl+-) 的提示效果很好。

您还可以使用鼠标上的侧键（如果您的鼠标有侧键并且该按钮已编程为浏览器中的后退功能）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-18T18:47:40.627

如果您的 MS 鼠标安装了最新的 Intellipoint 驱动程序，则可以将特定于程序的命令与鼠标按钮相关联。找出你的程序的“返回”键盘命令是什么。对于 VS .NET 2003/2005/2008，它是绑定到 View.NavigateBackward 的 Ctrl+\（控制反斜杠）。然后进入鼠标的控制面板，单击“启用程序特定设置”复选框，然后单击“设置”。

单击“添加”并选择您最喜欢的 Visual Studio 并将 Ctrl-\ 映射到左侧按钮。

其他感兴趣的节目：

```
uVision3 IDE (the Keil compiler):    Alt-Left
Adobe Reader 9.0:                    Alt-Left
javaw (as in Eclipse):               Ctrl-F2
VB6:                                 Ctrl-Shift-F2 
```

实际上，Eclipse 不是 Ctrl-F2 而是无法映射的，所以我在 Eclipse 中添加了该映射，然后在鼠标驱动程序中添加了新映射。

希望有帮助！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-11-08T15:03:01.313

我注意到，在 Microsoft Dev Studio 中，它总是映射到`CTRL`+ `*`（`*`数字键盘上的 The），但在 C# Express 中却没有。如前所述，这里是`Ctrl`++ 。`Shift``8`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-02-20T10:12:53.300

`Navigate backward` and `Navigate forward` is the right choice. These can be found in toolbars.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-18T14:00:34.060

ReSharper 等第三方工具可为您提供所需的功能。

这是“大炸弹！”

解决方案资源管理器中的导航已成为过去。

善良，

担

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-11-02T13:40:59.937

我只是使用鼠标上的后退按钮。

默认情况下一直为我工作。

# ruby - 使用字符串作为函数名

> ID：877882
> 
> 赞同：1
> 
> 时间：2009-05-18T14:00:28.037
> 
> 标签：ruby, string

我必须制作一个通用函数，用于根据我获得的访问权限调用许多其他函数。例如：

```
def func1

   @access = ['public','private','protected']
   for acc in @access
       @temp = "get_"+acc[1]+"_data"
   end
end

def get_public_data
end

def get_private_data
end

def get_protected_data
end 
```

但是@temp 将其作为字符串并将其分配给它。请尽快提供帮助。

谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T14:10:45.160

在 Ruby 中，方法实际上是消息。因此，您可以使用以下`send`方法发送消息名称：

```
s = 'xyz'
i = s.send 'length'
# i = 3 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T15:01:44.717

```
@temp = send "get_#{acc[1]}_data" 
```

Use `#{acc[1]}` instead of "+"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T14:07:13.657

不知道您使用的是什么语言，但某些语言，即 Perl 有一个 [eval()](http://perldoc.perl.org/functions/eval.html)函数，可以执行您正在尝试的操作。

如果您使用 Perl 或 Python，您可能会尝试类似

> @temp = eval("get_"+acc [1](http://perldoc.perl.org/functions/eval.html) +"_data")

# firefox - 如何使用 Firefox FUEL 在 TabOpen 事件中获取选项卡？

> ID：877884
> 
> 赞同：2
> 
> 时间：2009-05-18T14:00:57.130
> 
> 标签：firefox, events, firefox-addon

我正在编写一个 firefox 扩展程序，并且确实需要监听 TabOpen 事件并获取有关已打开选项卡的一些详细信息。但是我不知道如何从`event`回调接收到的对象中获取实际的选项卡。它在某处`event.data`吗？有没有办法检查这个对象？

到目前为止我尝试过的一些代码但它不起作用：

```
Application.activeWindow.events.addListener("TabOpen",
    function(event) {
        Application.console.log("TabOpen");
        var tab = event.data.target;
        Application.console.log(tab.uri);
    }
); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T16:18:38.727

在您的代码中， event.data 将为您提供一个[BrowserTab 对象](https://developer.mozilla.org/en/FUEL/BrowserTab)。如果你想要选项卡的当前 URI，你想要`tab.uri.spec`字符串版本，或者只是`tab.uri`想要一个[nsIURI 对象](https://developer.mozilla.org/En/NsIURI)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T14:12:06.127

这是 MDC 的一个示例，但没有使用 FUEL：

```
// add event listener
var container = gBrowser.mPanelContainer;
container.addEventListener("DOMNodeInserted", exampleTabAdded, false);

function exampleTabAdded(event)
{ // listening for new tabs
  if (event.relatedNode != gBrowser.mPanelContainer)
    return; //Could be anywhere in the DOM (unless bubbling is caught at the interface?)

  var browser;
    browser = event.target.childNodes[1];
  // browser is the XUL element of the browser that's been added
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T14:33:11.950

我在 MDC 中添加了一些新内容，应该对此有所帮助；现在可以在此处的示例中获得有关如何将选项卡对象从 TabOpen 事件中拉出的信息：

[https://developer.mozilla.org/En/FUEL/Window](https://developer.mozilla.org/En/FUEL/Window)

我在做的时候还做了一些其他的清理工作。希望这会有所帮助（尤其是在搜索索引刷新后）。

# c# - 如何在 Visual Studio 2008 中创建用于 C# 应用程序的 .dll？

> ID：877888
> 
> 赞同：3
> 
> 时间：2009-05-18T14:01:18.580
> 
> 标签：c#, c++, visual-studio-2008, dll

我有一个想从 C# 应用程序访问的 C++ 类。我需要访问构造函数和单个成员函数。目前该应用程序接受 s 形式的数据，`stl::vector`但如果这不太可能工作，我可以进行一些转换？

我在网上找到了几篇描述如何调用 C++ DLL 的文章，还有一些描述了如何为其他目的制作 .dll 项目的文章。我正在努力寻找在 Visual Studio 2008 中创建它们以用于 C# 应用程序的指南（VS 6.0 似乎有一些，但它们指定的大多数选项似乎没有出现在 2008 版本中）。

如果有人有分步指南或相当基本的示例可供参考，我将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T15:12:43.057

在 C++ 和 C# 之间进行互操作的最简单方法是使用托管 C++，或称为 C++/CLI。在 VisualStudio 中，创建一个类型为“CLR 类库”的新 C++ 项目。对于您希望 C# 可用的部分，有一些新语法，但您可以像往常一样使用常规 C++。

在这个例子中，我`std::vector<int>`只是为了展示你可以使用标准类型——但是，在实际的应用程序中，我更喜欢尽可能使用 .NET 类型（在本例中为 a `System::Collections::Generic::List<int>`）。

```
#pragma unmanaged
#include <vector>
#pragma managed

public ref class CppClass
{
public:
   CppClass() : vectorOfInts_(new std::vector<int>)
   {}

   // This is a finalizer, run when GC collects the managed object
   !CppClass()
   { delete vectorOfInts_; }

   void Add(int n)
   { vectorOfInts_->push_back(n); }

private:
    std::vector<int>* vectorOfInts_;
}; 
```

**编辑：**更改类以通过指针而不是值来保存向量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T14:16:31.593

如果此类 DLL 是非托管的。您将不得不使用 P/invoke。p/invoke 函数定义如下所示：

```
[DllImport("Library_Name.dll", EntryPoint = "function")]
public static extern void function(); 
```

另一方面，如果是托管 (C++/CLI) DLL（或程序集）。您可以通过在 .NET 项目中添加对它的引用来访问它。

**编辑：** 我想我根本没有回答你的问题。但是要创建一个可从 .NET 访问的托管 C++ DLL，请创建一个新项目并选择：Visual C++/CLR/Class Library。然后，只需将其输出 DLL 添加到您的 C# 项目中。

这样就行了。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T14:07:24.310

你有一个现有的 C++ exe 想要重新构建为 dll 吗？还是你只有 C++ 类？
如果您只有 C++ 类，您可能会考虑构建一个 .Net dll。虽然您无法将 stl 类型从 C# 传递到 C++，但我很确定您可以传递托管的 .Net 类型。
如果您必须在类中使用 stl 类型，您可以转换 C++ 类或调用应用程序中的数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T15:08:38.633

我找到[了一个有效的教程](http://www.codeproject.com/KB/cs/usecdlllibincs.aspx)。不过，请注意，您必须小心地将 .dll 复制到与可执行文件相同的目录中。我试图告诉可执行文件DLL在哪里，但最终放弃了。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-18T14:15:59.863

在 C# 中使用非托管 C++ Dll 可能非常乏味。

“更简单”的方法是将它放在 COM 包装器中。

# c# - 该进程无法访问该文件，因为它正被另一个进程使用

> ID：877889
> 
> 赞同：24
> 
> 时间：2009-05-18T14:01:42.980
> 
> 标签：c#

我有一组夜间报告。

有时我会遇到异常：

> 该进程无法访问该文件，因为它正被另一个进程使用

我如何知道哪个进程正在保存文件？我认为这是迈克菲，但我需要证明这一点。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-10T17:12:07.633

问题是 .NET 中的 MailMessage 保留了文件附件。我必须对附件进行处理，然后它才起作用。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-18T14:05:31.897

使用[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)或[Process Monitor 之](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)类的工具。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-04-27T15:11:15.430

```
Attachment data = new Attachment(@"c:\filename");

'send email....

data.Dispose(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T14:05:07.887

这里有一些工具可以告诉和解锁锁定的文件： [http ://ccollomb.free.fr/unlocker/](http://ccollomb.free.fr/unlocker/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-13T19:25:23.650

确认的。我有一个类似的问题，并按照格雷格所说的做了。

在`finally`发送消息后的块中，我只是把它放在那里，它释放了文件句柄：

```
foreach(Attachment a in message.Attachments) a.Dispose(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T14:03:46.237

[Filemon](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx)可能是您正在寻找的工具。

（甚至显然已经取代了 FileMon 的[进程监视器。）](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-18T14:30:28.100

1.  [Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx) > Find > Find Handle > 输入您的文件名。
2.  [解锁器](http://www.emptyloop.com/unlocker/)。尝试打开它，如果它有锁，解锁器将打开并显示锁定它的程序。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-10-13T08:23:37.530

处置后的 GC.Collect() 应该修复它

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-06-19T13:04:50.090

我试图启动一个 Java 程序并得到消息。查看任务管理器，当我杀死该进程时，已经有一个 Java 任务正在运行（循环？），我的进程能够运行。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-09-29T05:46:33.783

我只是遇到了同样的问题，但在我的情况下，我试图在 Visul Studio 2012 中删除一个 .mdf 文件。关于帮助我解决这个问题的错误信息并不多，所以我来这里寻求帮助。然后我意识到，尽管它是一个类似的问题，但我必须处理一个完全不同的过程。

我所做的是尝试在 Windows 资源管理器中删除 .mdf 文件，然后我给了我一个错误，即使我删除了数据库，SQL Server 2008 R2 实际上仍在保留该文件。一旦我有了新的，我所要做的就是关闭 SQL Server 2008 R2 并尝试再次删除该文件并且它起作用了。

如果您需要有关如何打开和关闭 SQL Server 2008 R2 的说明，请参阅下面的链接。

[打开和关闭 SQL Server](http://technet.microsoft.com/en-us/library/ms175516%28v=sql.105%29.aspx)

# c++ - 在 Windows 下使用 C++ 计数处理器

> ID：877896
> 
> 赞同：7
> 
> 时间：2009-05-18T14:02:35.910
> 
> 标签：c++, processors

在 Windows 平台上使用非托管 C++，是否有一种简单的方法来检测我的主机拥有的处理器内核数量？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-18T14:05:45.077

您可以使用[GetLogicalProcessorInformation](http://msdn.microsoft.com/en-us/library/ms683194.aspx)来获取您需要的信息。

预计到达时间：

正如评论者链接到的问题中所述，另一种（更简单）的方法是通过GetSystemInfo：

```
SYSTEM_INFO sysinfo;
GetSystemInfo( &sysinfo );

numCPU = sysinfo.dwNumberOfProcessors; 
```

似乎 GetLogicalProcessorInformation 会给你更详细的信息，但如果你只需要处理器的数量，GetSystemInfo 可能就可以了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T14:20:32.943

我注意到`NUMBER_OF_PROCESSORS`XP 上有一个环境变量，但我在 Microsoft 的网站上找不到它。不过，我相信这将是最简单的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T14:08:06.413

查看 [GetLogicalProcessorInformation](http://msdn.microsoft.com/en-us/library/ms683194.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-07T10:16:01.887

```
size_t getProcessorCores()
{
    DWORD process, system;
    if(GetProcessAffinityMask(GetCurrentProcess(), &process, &system))
    {
        int count = 0;
        for(int i = 0; i < 32; i++)
            if(system & (1 << i))
                count++;
        return count;
    }
    // may be we hav't PROCESS_QUERY_INFORMATION access right
    SYSTEM_INFO sysinfo;
    GetSystemInfo( &sysinfo );
    return sysinfo.dwNumberOfProcessors;
}

size_t getAvailableProcessorCores()
{
    DWORD process, system;
    if(GetProcessAffinityMask(GetCurrentProcess(), &process, &system))
    {
        int count = 0;
        for(int i = 0; i < 32; i++)
            if(process & (1 << i))
                count++;
        return count;
    }
    // may be we hav't PROCESS_QUERY_INFORMATION access right
    SYSTEM_INFO sysinfo;
    GetSystemInfo( &sysinfo );
    return sysinfo.dwNumberOfProcessors;
} 
```

# java - Java 泛型和数字

> ID：877897
> 
> 赞同：18
> 
> 时间：2009-05-18T14:02:36.910
> 
> 标签：java, generics

为了看看我是否可以清理我的一些数学代码，主要是矩阵的东西，我正在尝试使用一些 Java 泛型。我有以下方法：

```
private <T> T[][] zeroMatrix(int row, int col) {
    T[][] retVal = (T[][])new Object[row][col];
    for(int i = row; i < row; i++) {
        for(int j = col; j < col; j++) {
            retVal[i][j] = 0;
        }
    }
    return retVal;
} 
```

retVal[i][j] = 0 这一行让我头疼。该行的目标是用 0 的 T 表示来初始化数组。我试图用它做各种各样的事情：（T 在类中定义为 T extends Number）

```
retVal[i][j] = (T)0;
retVal[i][j] = new T(0); 
```

唯一有效的是

```
retVal[i][j] = (T)new Object(0); 
```

这不是我想要的。

这可能吗？有没有更简单的方法来表示任何类型的数字（包括可能的 BigDecimal）的 NxM 矩阵，还是我被卡住了？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-18T14:37:05.513

```
<T extends Number> T[][] zeroMatrix(Class<? extends Number> of, int row, int col) {
    T[][] matrix = (T[][]) java.lang.reflect.Array.newInstance(of, row, col);
    T zero = (T) of.getConstructor(String.class).newInstance("0");
    // not handling exception      

    for (int i = 0; i < row; i++) {
        for (int j = 0; j < col; 
            matrix[i][j] = zero;
        }
    }

    return matrix;
} 
```

用法：

```
 BigInteger[][] bigIntegerMatrix = zeroMatrix(BigInteger.class, 3, 3);
    Integer[][] integerMatrix = zeroMatrix(Integer.class, 3, 3);
    Float[][] floatMatrix = zeroMatrix(Float.class, 3, 3);
    String[][] error = zeroMatrix(String.class, 3, 3); // <--- compile time error
    System.out.println(Arrays.deepToString(bigIntegerMatrix));
    System.out.println(Arrays.deepToString(integerMatrix));
    System.out.println(Arrays.deepToString(floatMatrix)); 
```

**编辑**

一个通用矩阵：

```
public static <T> T[][] fillMatrix(Object fill, int row, int col) {
    T[][] matrix = (T[][]) Array.newInstance(fill.getClass(), row, col);

    for (int i = 0; i < row; i++) {
        for (int j = 0; j < col; j++) {
            matrix[i][j] = (T) fill;
        }
    }

    return matrix;
}    

Integer[][] zeroMatrix = fillMatrix(0, 3, 3); // a zero-filled 3x3 matrix
String[][] stringMatrix = fillMatrix("B", 2, 2); // a B-filled 2x2 matrix 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-18T14:40:58.253

数组和泛型*不能*很好地配合使用：

“数组是协变的，这意味着超类型引用数组是子类型引用数组的超类型。也就是说，`Object[]` 它是的超类型，`String[]` 并且可以通过类型的引用变量访问字符串数组`Object[]`。”

请参阅[Java 泛型常见问题解答](http://www.angelikalanger.com/GenericsFAQ/JavaGenericsFAQ.html)：

*   [我可以创建一个组件类型为具体参数化类型的数组吗？](http://www.angelikalanger.com/GenericsFAQ/FAQSections/ParameterizedTypes.html#Can%20I%20create%20an%20array%20whose%20component%20type%20is%20a%20concrete%20instantiation%20of%20a%20parameterized%20type?)
*   [我如何一般地创建对象和数组？](http://www.angelikalanger.com/GenericsFAQ/FAQSections/ProgrammingIdioms.html#How%20do%20I%20generically%20create%20objects%20and%20arrays?)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T14:15:19.457

它应该是 null 而不是零。

如果您想实际将对象 T 的等效 0 放入其中，则需要提供 T 的工厂。像这样：

```
interface Factory<T> {
   T getZero();     
} 
```

你应该做这样的方法：

```
private <T> T[][] zeroMatrix(int row, int col, Factory<T> factory) {
    T[][] retVal = (T[][])new Object[row][col];
    for(int i = row; i < row; i++) {
        for(int j = col; j < col; j++) {
            retVal[i][j] = factory.getZero();
        }
    }

    return retVal;
} 
```

您还应该对工厂进行适当的实现：

```
 class IntegerFactory implements Factory<Integer> {
    Integer getZero() {
       return new Integer(0);
    }
} 
```

通常，您也会将其`getMatrix(int row, int column)`放入工厂实现中，以便实际返回正确的类型化数组。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-18T14:13:00.883

在 Java 中，类型在运行时被擦除，因此您需要传入另一个参数以在运行时获取类型。

这可以是初始化数组的值，也可以是要使用的类。

如果您选择传入类，则有一个类到值的 Map 以存储每种类型的零值。

然后，您可以使用`java.util.Arrays.fill`填充数组：

```
private static HashMap<Class<?>, Object> ZEROS = new HashMap<Class<?>,Object>();

static {
    ZEROS.put( Integer.class, Integer.valueOf(0) );
    ...
}

private static <T extends Number> T[][] zeroMatrix ( Class<T> type, int rows, int cols ) {
    @SuppressWarnings("unchecked")
    T[][]   matrix  = (T[][]) java.lang.reflect.Array.newInstance(type, rows, cols);
    Object  zero    = ZEROS.get(type);

    for ( T[] row : matrix ) 
        java.util.Arrays.fill(row,zero);

    return matrix;
}

Integer[][] matrix = zeroMatrix (Integer.class, 10, 10); 
```

但是，如果性能是一个远程问题，您不希望对数字代码使用装箱值。

您真的不想尝试将 null 用作零 - 它会使代码中所有其他路径的复杂性增加三倍。尽管您可能会使用一个数字支持类来提供各种盒装数字类型的加法和乘法，但与提供两个或三个原始矩阵和几个大数矩阵相比，您节省的复杂性将非常少，特别是如果您使用模板系统（例如 ant 的替换任务或 XSLT）来生成源代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T14:30:29.240

您需要考虑泛型仅在编译时用于类型安全检查。此信息在运行时丢失，因此您不能在 retVal[i][j] = 0; 上使用自动装箱；因为 Java 不能自动输入数字或对象。

如果您传入要设置的值，它将起作用。这是一个快速示例：

```
private <T> T[][] fillMatrix(int row, int col, T value) {
    T[][] retVal = (T[][])new Object[row][col];
    for(int i = 0; i < row; i++) {
       for(int j = 0; j < col; j++) {
          retVal[i][j] = value;
       }
    }
    return retVal;
} 
```

顺便说一句， for(int i = row; i < row; i++) 和 for(int j = col; j < col; j++) 永远不会循环，因此您的代码还有另一个问题。

编辑：您将无法将结果转换为 Object[][] 以外的内容，因为那是实际的数组类型。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-09-11T08:19:21.180

我提出了一个[相关问题，该问题还询问了](https://stackoverflow.com/questions/1409432/refactoring-java-arrays-and-primitives-double-to-collections-and-generics/1409505#1409505)引用您的问题的性能问题。共识很明显，重构到泛型对性能有相当大的影响，所以如果这很重要，你应该坚持使用原语（对我来说确实如此）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-18T14:11:01.387

Ye olde (reference) 数组不能很好地与泛型配合使用。在这种情况下，数组也可能效率低下。您正在创建一个数组数组，因此有不必要的间接和边界检查。最好做一个类`Matrix<T>`。您可能还希望添加对表示零`Matrix`的实例的引用。`T`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-18T14:12:27.607

泛型和数组不太匹配。不允许创建泛型数组，因为它不是类型安全的。源于如果 Sub 是 Super 的子类型，那么 Sub[] 是 Super[] 的子类型，这不是泛型类型的情况；对于任何两个不同的类型 Type1 和 Type2，List 既不是 List 的子类型也不是 List 的超类型。（Effective Java 在第 5 章第 25 项中对此进行了介绍）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-18T14:13:46.577

我认为你正在打一场失败的战斗。即使你解决了这个问题，你打算如何解决加法、减法等问题？number 类不是一个非常有用的超类，唯一有用的方法是 doubleValue()。

零可以定义为加法或乘法中的零，但如果没有加法或乘法的通用定义，零的通用定义是不可能的。

如果你想要这个，那么你可能会更好地坚持使用 BigDecimal 来处理所有事情，但这当然会带来相关的性能损失。

另一个明显的选择是将数组保留为 null 初始化，然后更改其他代码以将 null 视为零。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-18T14:43:22.427

如果你真的想使用泛型，你可以做这样的事情

```
private <T extends Number> T[][] zeroMatrix(int row, int col, Class<T> clazz) throws InstantiationException, IllegalAccessException,
        IllegalArgumentException, InvocationTargetException
{
    T[][] retVal = (T[][]) Array.newInstance(clazz, new int[] { row, col });
    for (int i = 0; i < row; i++)
    {
        for (int j = 0; j < col; j++)
        {
            Constructor<T> c = clazz.getDeclaredConstructors()[0];
            retVal[i][j] = c.newInstance("0");
        }
    }

    return retVal;
} 
```

例子：

```
zeroMatrix(12, 12, Integer.class); 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-05-18T14:12:35.360

Java 使用擦除来实现泛型意味着您将在新建泛型类型时遇到麻烦。

用null表示0怎么样

```
retVal[i][j] = null; 
```

然后，您可以稍后将您想要的任何类型分配给数组。

# .net - ISupportInitialize (BeginInit/EndInit) 和 SuspendLayout/ResumeLayout 的区别

> ID：877904
> 
> 赞同：11
> 
> 时间：2009-05-18T14:04:09.263
> 
> 标签：.net, winforms, system.componentmodel

有人可以解释一下使用 ISupportInitialize 接口方法（BeginInit/EndInit）和使用 SuspendLayout/ResumeLayout 之间的区别吗？

ISupportInitialize 是否仅在构造/“初始”初始化期间使用......或者当您想将新的子控件添加到现有父控件时可以使用它？

有什么特别的区别吗？

非常感谢您的帮助！

谢谢，

帕托

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T20:02:46.357

ISupportInitialize 接口位于 System.dll 中，只是组件领域中一个相当通用的概念。顺便说一句，System.Windows.Forms 的许多部分都是组件，而且 Windows.Forms 是 ComponentModel 东西的主要用户。

Suspend/ResumeLayout 是一个纯粹的 Windows.Forms 事物，并且真正告诉控件不要尝试在您添加子控件或更改属性时执行图形。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-11-13T23:51:46.753

为此更正 VB.Net 中使用的代码，大多数反编译器都会出错。

```
CType(Me.pictureBox1, System.ComponentModel.ISupportInitialize).BeginInit() 
```

# javascript - Javascript with() 性能

> ID：877907
> 
> 赞同：3
> 
> 时间：2009-05-18T14:04:25.360
> 
> 标签：javascript, performance

我记得很久以前读到过，`with()`由于它可能对范围堆栈进行非确定性的更改，它对 JavaScript 有一些严重的性能影响。我很难找到最近对此的任何讨论。这仍然是真的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T14:09:46.647

与其说它对性能有影响，不如说它是[不可取](https://stackoverflow.com/questions/61552/are-there-legitimate-uses-for-javascripts-with-statement/61676#61676)的。另请[参阅](http://yuiblog.com/blog/2006/04/11/with-statement-considered-harmful/)。

作为记录，从浏览器的角度来看，它是确定性的，但不是开发人员需要在变量的上下文中给予比平时更多的信任。

# c# - 映射 NHibernate 多对多

> ID：877908
> 
> 赞同：0
> 
> 时间：2009-05-18T14:04:37.140
> 
> 标签：c#, .net, nhibernate, nhibernate-mapping

我正在尝试在此处映射旧数据库，但遇到了问题。在我的模式中，我有一个模块的概念和一个变量的概念。每个模块由一个或多个变量组成，每个变量都具有特定于该模块的属性。变量位于关系上。

根据下面的类，映射 ModuleVariable 的最佳方法是什么，在我看来，它就像具有特殊属性的多对多关系？

以下是课程：

```
public class Relation
{
    public virtual string RelationId
    {
        get;
        set;
    }
}

public class Variable
{
    public virtual string VariableId
    {
        get;
        set;
    }

    public virtual Relation RelationId
    {
        get;
        set;
    }
} 

public class Module
{
    public virtual string ModuleId
    {
        get;
        set;
    }
}

public class ModuleVariable
{       
    public virtual Module ModuleId
    {
        get;
        set;
    }

    public virtual Variable VariableId
    {
        get;
        set;
    }

    public virtual Relation RelationId
    {
        get;
        set;
    }

    public virtual Variable DownloadID
    {
        get;
        set;
    }

    public virtual Variable UploadID
    {
        get;
        set;
    }

    public string Repeatable
    {
        get;
        set;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T14:19:12.010

要在这样的关系上建立具有额外属性的多对多关系，您必须创建一个域实体并将其与and`ModuleVariable`分开映射。`Module``Variable`

`Module`并且将有一个实体`Variable`的集合，并且对另外两个有一个多对一的引用。就像是：`ModuleVariable``ModuleVariable`

```
<!-- Module mapping -->
<bag name="ModuleVariables" inverse="true">
    <key column="Module_id" />
    <one-to-many class="ModuleVariable" />
</bag>

<!-- ModuleVariable mapping -->
<many-to-one name="Module" column="Module_id" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T18:24:11.157

多对多仅适用于没有额外属性的表。这是因为多对多表示其他实体内部的项目集合。

如果您的表 ModuleVariable 没有其他列，则可以这样使用：

```
<bag name="Modules" table="MODULE_VARIABLE" cascade="save-update" lazy="true" >
  <key>
    <column name="Variable_Id" not-null="true"/>
  </key>
  <many-to-many class="Module">
    <column name="Module_Id" not-null="true"/>
  </many-to-many>
</bag> 
```

在您的域类中：

```
public IList Modules { get; set; } 
```

为了使用，您应该添加模块：

```
variable.Modules.Add(module); 
```

希望有所帮助。

# javascript - 自签名证书——帮助用户知道他们需要将根 CA 添加到受信任的证书存储中

> ID：877916
> 
> 赞同：4
> 
> 时间：2009-05-18T14:05:21.240
> 
> 标签：javascript, browser, certificate, ssl-certificate, self-signed

我有一个使用嵌入式网络服务器的桌面产品，它将使用自签名证书。

我可以在网页中放入一些东西来检测他们没有将根 CA 添加到他们的受信任列表中，并显示链接或 DIV 或指导他们如何操作的东西吗？

我在想可能是一个包含安装 CA 的说明的 DIV，以及一个运行一些测试的 Javascript（尝试在没有内部警告的情况下访问某些东西？？），如果测试成功，则隐藏 DIV。或类似的东西...

来自辉煌的 SO 社区的任何想法？:)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-22T17:55:05.763

你为什么要这样做？训练用户不加选择地安装根 CA 证书只是因为网站告诉他们这样做是一个坏主意。你正在破坏整个信任链。有安全意识的用户会忽略您安装证书的建议，并且可能会得出结论，您没有认真对待安全性，因为您没有费心从现有 CA 获取证书。

你真的需要HTTPS吗？如果是这样，您可能应该硬着头皮与 CA 达成协议，以便为您的客户提供适当的 CA 签名服务器证书。如果 Web 服务器仅用于来自桌面应用程序的本地连接，您应该在安装过程中将自签名证书添加到受信任列表中，或者改用 HTTP。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T14:12:41.273

假设你知道 C# 并且你想安装一个 pfx 文件。创建一个将从 url 运行的 exe。[按照这个网址](http://blogs.microsoft.co.il/blogs/maxim/archive/2008/03/31/how-to-run-wpf-xbap-application-in-full-trust-mode-post-2-certificate-extraction.aspx)

*   [还有这个](http://blogs.microsoft.co.il/blogs/maxim/archive/2008/03/31/how-to-run-wpf-xbap-application-in-full-trust-mode-post-2-certificate-extraction.aspx#234066)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-20T05:45:39.360

我唯一的想法是使用框架和一些 javascript。

框架的第一个元素将充当看门狗，等待 x 时间（javascript setTimeout），然后向用户显示您的自定义 ssl 失败消息，其中包含超链接或下载自签名证书的说明。

第二个框架元素尝试 https 连接，如果成功则重置看门狗框架，使其永远不会触发。如果失败（假设 https 证书验证失败），则监视消息将触发并呈现给用户。

根据您的浏览器，您很可能仍会使用该方法看到一些安全警告，但您至少可以推送您自己的内容，而无需用户在没有适当信任链的情况下运行不受信任的代码（这会比安全性更糟糕） POV 而不是接受证书验证错误并建立不受信任的 ssl 会话）

使用其他测试方法（例如 XMLHttpRequest 等）可能会改进该概念。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-23T09:50:13.400

你不应该这样做。根证书不是您刚安装的东西，因为添加一个可能会损害 https 为您提供的任何安全性。

但是，如果您正在制作桌面应用程序，则只需收听 127.0.0.1。这样，流量永远不会离开用户的计算机，攻击者也无法监听。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T22:00:59.803

您可能会尝试在每个用户会话中添加一些（隐藏的）Flex 元素或 Java Applet。它只会下载您服务器的任何 https 页面，并将获取有关连接的所有信息：

```
com.sun.deploy.security.CertificateHostnameVerifier.verify()
or
javax.security.cert.X509Certificate.checkValidity() 
```

我想 Flex（这对用户来说更常见）应该有类似的方式来从用户的角度验证 https 证书。它还应该共享操作系统的受信任证书。存储，而 Java 可能有自己的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-24T13:23:39.653

由于服务器在客户端机器（桌面产品）上运行，它不能使用 winapi/os 功能检查支持的浏览器是否安装了证书？我知道 Firefox 在用户的配置文件目录中有一个证书数据库，而 IE 可能会将信息保存在注册表中。它对所有浏览器都不可靠，但如果服务器只是在“找到证书”和“请确保在继续之前安装了证书”之间进行选择，那么用户可以选择继续任何一种方式都不会造成任何伤害。

您还可以通过提供嵌入式浏览器（即 gecko）来简化问题，这样您只需使用 1 个浏览器即可处理很多事情（包括预安装根 CA）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-25T14:28:45.287

回顾一下：您正在桌面应用程序上设置网络服务器；每个桌面都有自己的网络服务器，但您想使用 SSL 来保护与该网络服务器的连接。

我猜这里的证书有几个问题，一个是用于访问桌面的主机名必须与证书匹配。在这种情况下，您别无选择，只能在客户端上生成证书。您需要允许用户以某种方式指定主机名，以防无法从主机本身检测到外人使用的名称。

对于那些不想依赖自签名证书的人，我还建议允许管理员安装受信任的证书。通过这种方式，您还可以将可信证书维护的成本转移给真正需要它的管理员。

最后，根据我的经验，浏览器要么允许要么拒绝自签名证书，服务器无法知道证书是被拒绝、暂时接受还是永久接受。我认为在某处必须有一种机制来处理 SSL 故障，但典型的 Web 编程不在该层运行。在任何情况下，如果 SSL 失败，Web 服务器唯一能做的就是回退到非 SSL，并且您在评论中指出您不能拥有任何非 SSL。我认为您应该尝试取消该限制；在这种情况下，非 SSL 起始页将非常有帮助：它可以测试（使用框架或图像或 JSON 或 AJAX）https 连接，它可以链接到有关如何设置证书的文档，或从何处下载证书的安装程序。

如果浏览器由于自签名证书而无法连接，并且您根本不允许使用纯 HTTP，您可以通过哪些其他方式与用户通信？没有其他渠道，您无法建立渠道，因为您没有任何沟通。

您在评论中提到编写用于安装证书的 win32 应用程序。您可以在安装应用程序本身时安装证书，但这对任何远程浏览器都没有帮助，并且本地浏览器不需要 SSL 来访问 localhost。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-07-22T15:48:30.710

我们一直在开发一个与此问题相关的名为 Forge 的开源 JavaScript 项目。您有用户可以访问的网站吗？如果是这样，那么您可以通过您的网站使用用于跨域的 Flash + 用于 TLS 的 JavaScript 的组合来提供与这些桌面应用程序的安全连接。它将要求您在您的网站上实现一些 Web 服务来处理桌面应用程序证书的签名证书（或让您的桌面应用程序上传自签名证书，以便可以通过 JavaScript 访问它们）。我们在这里描述它是如何工作的：

[http://blog.digitalbazaar.com/2010/07/20/javascript-tls-1/](http://blog.digitalbazaar.com/2010/07/20/javascript-tls-1/)

设置网站的另一种方法是直接在桌面应用服务器上托管 JavaScript+Flash，但由于它允许 MiTM 攻击而不太安全。您可以让您的用户通过常规 http 访问您的桌面应用程序以下载 JS+Flash+SSL 证书，然后通过 JS 开始使用 TLS。如果您在 localhost 连接上，MiTM 攻击可能不会那么令人担忧——也许足以让您考虑这个选项。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-03-16T11:54:08.963

ActiveX 控件可以解决问题。但我真的没有插手帮助解决方案，更多的是不同意你所做的是安全风险的立场。

需要明确的是，您需要一个安全的密码（希望是 AES 而不是 DES），并且已经在控制您的端点，只是无法完全排除可能捕获明文密码或其他敏感数据的混杂模式网络嗅探器.

SSL 是一个“安全套接字层”，根据定义，它不依赖于任何证书。

然而，所有有效的现代密码都要求它对隧道端点进行身份验证，这并不总是对每个应用程序都是必需的；在使用 Web 服务 API 管理节点的众多后端数据中心自动化例程中，我遇到了一个挫折，其中“用户”实际上是在 RESTful 命令协商之前需要加密密钥交换的进程。

就我而言，VLAN 是通过 ACL 保护的，所以我真的“可以”发送明文身份验证标头。但只是打字让我有点呕吐。

我敢肯定，我会因为打字而被激怒，但我已经身经百战，在我 IT 职业生涯的 10 到 15 年也会对你做出同样的评论。所以我很同情他们的担忧，如果他们对安全有足够的热情来激怒我，我会非常感激。他们最终会弄清楚的......

但我确实同意这样一个事实，即“培训”用户自行安装根 CA 是一个坏主意。另一方面，如果您使用自签名证书，则必须训练他们安装它。如果用户不知道如何确定 CA Cert 是否值得信赖，他们肯定无法从 CA Cert 确定自签名证书，因此任何一个过程都会产生相同的效果。

如果是我，我会自动化这个过程，而不是让它帮助最终用户，这样它就尽可能地对他们隐藏，就像一个适当的 PKI 对企业所做的那样。

说到这个，我只是想到了一个潜在的解决方案。使用 Microsoft PKI 模型。使用 Server 2012 R2，您可以通过“工作区”使用“设备控制”将受信任的密钥传递给甚至不是域成员的端点，并且客户端计算机可以订阅多个工作区，因此如果它们订阅，它们不会单独提交给您的。一旦他们这样做并进行了身份验证，AD 证书服务角色将推送所有必要的根 CA 证书，这些证书存在于活动目录或指定的 LDAP 服务器中。（如果您使用离线 CA 服务器）

另外，我意识到这个帖子已经有 7 年的历史了，但我确信它仍然被很多需要类似解决方案的人引用，并且觉得有义务分享不同的意见。（好吧，微软，我给你的插件的回扣在哪里？）

-收银员

# fluent-nhibernate - Fluent NHibernate - 绑定列表

> ID：877924
> 
> 赞同：3
> 
> 时间：2009-05-18T14:06:47.650
> 
> 标签：fluent-nhibernate

我有一个看起来像这样的类：

```
 public class User {
      public virtual int ID;
      public virtual string Name;
      public virtual IList<int> userRights;
 }

 I want to make a UserMap : ClassMap<User> 
```

映射名称没有问题，但我似乎无法弄清楚如何映射用户权限。

表看起来像

```
UserTable
User_id int
User_Name nvarchar
User_group int

UserRights
User_group int
RightID int 
```

你会如何映射这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T14:11:37.080

好吧，如果你想要一个列表，你需要一个索引。因此，我建议将其设置为 ICollection，除非排序很重要。

映射应类似于：

```
HasMany(x=> x.userRights).Element("RightID").AsBag(); 
```

但是，在查看您的表格时，我发现了一些奇怪的东西。您正在尝试在 User_Rights 表中没有主键的情况下使用一对多。如果您在 UserRights 中有 User_Id，则上述内容应该可以工作。

否则它看起来像有一个用户组，它应该由你的类建模。

# sql - 'SELECT *' 来自内部连接表

> ID：877928
> 
> 赞同：2
> 
> 时间：2009-05-18T14:07:23.997
> 
> 标签：sql, sql-server, inner-join

如何选择两个连接表的所有字段，而不会与公共字段发生冲突？

假设我有两张桌子，`Products`并且`Services`. 我想做这样的查询：

```
SELECT Products.*, Services.* 
FROM Products 
INNER JOIN Services ON Products.IdService = Services.IdService 
```

这个查询的问题是它`IdService`会出现两次并导致一堆问题。

到目前为止，我发现的另一种方法是区分每个字段，`Products`除了`IdService`一个。但是这样我每次添加新字段时都必须更新查询`Products`。

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-18T14:09:39.297

您不应该在生产代码中使用 SELECT * （嗯，几乎没有，但是可以很容易地计算出合理的时间）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-18T14:11:48.747

[最常见的 SQL 反模式有哪些？](https://stackoverflow.com/questions/346659/what-are-the-most-common-sql-anti-patterns/346679#346679)

您遇到了反模式 #1。

更好的方法是提供一个字段列表。获得快速字段列表的一种方法是

```
sp_help tablename 
```

如果您想从此查询创建视图 - 使用 select * 会给您带来更多麻烦。SQL Server 在创建视图时捕获列列表。如果您编辑基础表并且不重新创建视图-您正在注册麻烦（我遇到了这种性质的生产火灾-尽管视图针对的是不同数据库中的表）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T14:10:38.343

据我所知，你必须避免`SELECT *`，但这并不是一个真正的问题。

`SELECT *`通常被视为等待发生的问题，因为您引用的原因是优势！通常，当数据库被修改时，查询出现的额外结果列会导致问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T14:10:25.707

您的 SQL 方言是否支持 COMPOSE？COMPOSE 摆脱了在等值连接上使用的列的额外副本，就像您的示例中的那样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T14:14:04.063

正如其他人所说， Select * 是个坏消息，特别是如果将其他字段添加到您正在查询的表中。您应该从表中选择所需的确切字段，并且可以为具有相同名称的字段使用别名，或者只使用 table.columnName。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-18T14:22:17.713

不使用 *。使用这样的东西：

```
SELECT P.field1 AS 'Field from P'
     , P.field2
     , S.field1 AS 'Field from S'
     , S.field4 
  FROM Products P
       INNER JOIN 
       Services S
       ON P.IdService = S.IdService 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-18T14:18:35.257

这是正确的，列出您想要的字段（在 SQL Server 中，您可以将它们从对象浏览器中拖过来，因此您不必全部输入）。顺便说一句，如果您的特定查询不需要某些字段，请不要列出它们。这给服务器带来了额外的工作并消耗了额外的网络资源，并且当它在整个系统中完成并且这种浪费的查询每天运行数千次时，可能是导致性能不佳的原因之一。

至于它是一个维护问题，您只需要添加这些字段，如果使用您的查询的应用程序部分会受到它们的影响。如果您不知道新字段会产生什么影响或需要在何处添加它，则不应添加该字段。此外，通过使用 select * 意外添加新文件也会导致维护问题。创建性能问题以避免进行维护（您甚至可能永远不需要进行维护，因为列更改应该很少见（如果它们不是，您需要查看您的设计））是非常短视的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-18T14:18:53.803

最好的方法是从查询中指定您想要的确切字段。`*`无论如何你都不应该使用。

使用它来获取所有字段很方便`*`，但它不会产生健壮的代码。表中的任何更改都会更改从查询返回的结果，这并不总是可取的。

您应该只从查询中返回您真正想要的数据，并按照您想要的确切顺序指定。这样，即使您向表中添加字段或更改表中字段的顺序，结果看起来也完全相同。

指定确切的输出需要做更多的工作，但从长远来看，它通常会得到回报。当您进行更改时，只有您实际更改的内容会受到影响，您不会得到破坏您甚至不知道受到影响的代码的级联效果。

# performance - 跨防火墙的 HTTP 版本性能

> ID：877940
> 
> 赞同：0
> 
> 时间：2009-05-18T14:10:12.340
> 
> 标签：performance, http, firewall

我们有一个通过代理调用 Web 服务的系统。这是用 C# 编码的，使用 HttpWebRequest。很长一段时间以来，我们一直在处理这些呼叫的速度问题，我一直在努力追查。一次不相关的对话导致其中一位操作人员提到我们一直在使用的端口使用防火墙软件，该软件在移植 HTTP 1.1 调用方面具有不太理想的（阅读：错误）实现。果然，我放弃了使用 HTTP 1.0 而不是 1.1 的 Web 请求，速度瞬间翻了一番。我们已经禁用了keep-alive，因为它太不稳定了。

所以，问题：在短期内，除了 keep-alive 和 HTTP 版本之外，是否还有其他变量可以通过更改 HttpWebRequest 调用的各个方面来进一步提高速度？我想如果不知道防火墙软件的来龙去脉，就很难说清楚，我还不知道。

更重要的是，他们在不同的端口上有一个更新版本的软件，显然要好得多，并且完全支持 HTTP 1.1。我是否应该期望通过切换到 HTTP 1.1 和 keep-alives 来显着增加响应时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T14:45:56.417

所有与性能相关的问题都有一个答案：衡量。

在性能方面，猜测总是错误的（通常是因为*尽管*系统的设计性能很差，这意味着你*认为*它不应该很慢，但它确实*是*）。

# ruby-on-rails - 如何配置 Rails 应用程序（redmine）在 Windows 上作为服务运行？

> ID：877943
> 
> 赞同：16
> 
> 时间：2009-05-18T14:10:37.410
> 
> 标签：ruby-on-rails, windows, service, redmine

我使用 redmine 作为票务管理器，我想将其配置为在 windows 启动时自动运行。

如何将其配置为作为服务运行？

--

刚刚问了这个问题来记录它，我希望有人会发现它有用......

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-18T14:30:16.260

**1.使用webrick：**

参考：[http ://www.redmine.org/boards/1/topics/4123](http://www.redmine.org/boards/1/topics/4123)

*   [从http://www.microsoft.com/downloads/details.aspx?familyid=9d467a69-57ff-4ae7-96ee-b18c4790cffd&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=9d467a69-57ff-4ae7-96ee-b18c4790cffd&displaylang=en)下载并安装 Windows NT 资源工具包

*   通过运行以下命令创建服务：

    ```
    path\INSTSRV.EXE your_service_name path\SRVANY.EXE 
    ```

    在我的情况下`path`是：

    ```
    "C:\Program Files\Windows NT Resource Kit\INSTSRV.EXE" redmine_webrick "C:\Program Files\Windows NT Resource Kit\SRVANY.EXE" 
    ```

    也可以`C:\Program Files\Windows Resource Kits\Tools\`。

*   运行 regedit（开始 -> 运行 -> regedit）

    *   如果它不存在，请添加以下注册表项：

        HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\your_service_name

    *   右键单击此注册表项并选择新建 -> 项。命名它`Parameters`。

    *   向`Parameters`键添加两个值。右键单击参数键，新建 -> 字符串值。命名它`Application`。现在创建另一个名为`AppParameters`. 给他们以下值：

        *   应用：`PathToRuby.exe`例如。`C:\ruby\bin\Ruby.exe`
        *   AppParameters: `C:\RUBYAPP\script\server -e production`，其中`RUBYAPP`是redmine网站所在的目录。

        示例：`C:\redmine\script\server -p 2000 -e production`（-p 表示 webrick 将要监听的端口，-e 表示使用的环境）

现在您可以转到管理工具 -> 服务。在那里您可以启动您的服务（带有 name 的服务`your_service_name`）并测试它是否正常工作。应该注意的是，在 WEBrick 完成其启动过程之前，该服务将被标记为已启动。在尝试访问服务以验证它是否正常工作之前，您应该给它 1 分钟左右的时间。

**2.使用杂种：**

参考：[http://mongrel.rubyforge.org/wiki](http://mongrel.rubyforge.org/wiki) 参考：http: [//mongrel.rubyforge.org/wiki/Win32](http://mongrel.rubyforge.org/wiki/Win32)

首先安装 mongrel 和 mongrel_service gem

```
gem install mongrel

gem install mongrel_service 
```

然后创建服务

```
mongrel_rails service::install -N redmine_mongrel -c c:\redmine -p 3000 -e production 
```

**3.使用薄：**

参考：

*   [http://code.macournoyer.com/thin/](http://code.macournoyer.com/thin/)
*   [http://www.astarbe.com/es/trucos/windows/srvany_convierte_una_aplicacion_en_servicio](http://www.astarbe.com/es/trucos/windows/srvany_convierte_una_aplicacion_en_servicio)

指示：

1.  首先安装 Thin（如果尚未安装，则需要安装 rack gem）

    ```
    gem install rack     
    gem install thin 
    ```

2.  遵循为 webrick 指示的相同步骤，但添加另一个名为“AppDirectory”的值。这是为了避免使用 c:\ruby\bin\thin.bat 如果我只是指向 bat 文件，我无法停止服务。

    在`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\redmine_thin\Parameters`添加以下键：

    > 应用程序：c:\ruby\bin\ruby.exe
    > 
    > 应用程序目录：c:\redmine
    > 
    > 应用参数：c:\ruby\bin\thin start -p 4000 -e production

## -------------------------------------------------- --------------------------------------

您可以使用以下命令控制您的任何服务：

> 网络启动 redmine_xxx
> 
> 网停 redmine_xxx
> 
> sc config redmine_xxx 开始=自动
> 
> sc config redmine_xxx start=自动依赖= MySql
> 
> sc 删除 redmine_xxx

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-10-21T14:11:09.867

对于 Rails 3.0.x 应用程序（在 3.0.10 和 Windows 7 上测试）

demo_daemon_ctl.rb

```
############################################################################
# demo_daemon_ctl.rb
#
# This is a command line script for installing and/or running a small
# Ruby program as a service.  The service will simply write a small bit
# of text to a file every 20 seconds. It will also write some text to the
# file during the initialization (service_init) step.
#
# It should take about 10 seconds to start, which is intentional - it's a test
# of the service_init hook, so don't be surprised if you see "one moment,
# start pending" about 10 times on the command line.
#
# The file in question is C:\test.log.  Feel free to delete it when finished.
#
# To run the service, you must install it first.
#
# Usage: ruby demo_daemon_ctl.rb <option>
#
# Note that you *must* pass this program an option
#
# Options:
#    install    - Installs the service.  The service name is "DemoSvc"
#                 and the display name is "Demo".
#    start      - Starts the service.  Make sure you stop it at some point or
#                 you will eventually fill up your filesystem!.
#    stop       - Stops the service.
#    pause      - Pauses the service.
#    resume     - Resumes the service.
#    uninstall  - Uninstalls the service.
#    delete     - Same as uninstall.
#
# You can also used the Windows Services GUI to start and stop the service.
#
# To get to the Windows Services GUI just follow:
#    Start -> Control Panel -> Administrative Tools -> Services
############################################################################
require 'win32/service'
require 'rbconfig'
include Win32
include Config

# Make sure you're using the version you think you're using.
puts 'VERSION: ' + Service::VERSION

SERVICE_NAME = 'DemoSvc'
SERVICE_DISPLAYNAME = 'Demo'

# Quote the full path to deal with possible spaces in the path name.
ruby = File.join(CONFIG['bindir'], 'ruby').tr('/', '\\')
path = ' "' + File.dirname(File.expand_path($0)).tr('/', '\\')
path += '\demo_daemon.rb"'
cmd = ruby + path

# You must provide at least one argument.
raise ArgumentError, 'No argument provided' unless ARGV[0]

case ARGV[0].downcase
     when 'install'
            Service.new(
                 :service_name     => SERVICE_NAME,
                 :display_name     => SERVICE_DISPLAYNAME,
                 :description      => 'Sample Ruby service',
                 :binary_path_name => cmd
            )
            puts 'Service ' + SERVICE_NAME + ' installed'      
     when 'start' 
            if Service.status(SERVICE_NAME).current_state != 'running'
                 Service.start(SERVICE_NAME, nil, 'hello', 'world')
                 while Service.status(SERVICE_NAME).current_state != 'running'
                        puts 'One moment...' + Service.status(SERVICE_NAME).current_state
                        sleep 1
                 end
                 puts 'Service ' + SERVICE_NAME + ' started'
            else
                 puts 'Already running'
            end
     when 'stop'
            if Service.status(SERVICE_NAME).current_state != 'stopped'
                 Service.stop(SERVICE_NAME)
                 while Service.status(SERVICE_NAME).current_state != 'stopped'
                        puts 'One moment...' + Service.status(SERVICE_NAME).current_state
                        sleep 1
                 end
                 puts 'Service ' + SERVICE_NAME + ' stopped'
            else
                 puts 'Already stopped'
            end
     when 'uninstall', 'delete'
            if Service.status(SERVICE_NAME).current_state != 'stopped'
                 Service.stop(SERVICE_NAME)
            end
            while Service.status(SERVICE_NAME).current_state != 'stopped'
                 puts 'One moment...' + Service.status(SERVICE_NAME).current_state
                 sleep 1
            end
            Service.delete(SERVICE_NAME)
            puts 'Service ' + SERVICE_NAME + ' deleted'
     when 'pause'
            if Service.status(SERVICE_NAME).current_state != 'paused'
                 Service.pause(SERVICE_NAME)
                 while Service.status(SERVICE_NAME).current_state != 'paused'
                        puts 'One moment...' + Service.status(SERVICE_NAME).current_state
                        sleep 1
                 end
                 puts 'Service ' + SERVICE_NAME + ' paused'
            else
                 puts 'Already paused'
            end
     when 'resume'
            if Service.status(SERVICE_NAME).current_state != 'running'
                 Service.resume(SERVICE_NAME)
                 while Service.status(SERVICE_NAME).current_state != 'running'
                        puts 'One moment...' + Service.status(SERVICE_NAME).current_state
                        sleep 1
                 end
                 puts 'Service ' + SERVICE_NAME + ' resumed'
            else
                 puts 'Already running'
            end
     else
            raise ArgumentError, 'unknown option: ' + ARGV[0]
end 
```

demo_daemon.rb

```
APP_ROOT_CUSTOM = 'your app root dir'
LOG_FILE = APP_ROOT_CUSTOM + 'log/win32_daemon_test.log'
APP_PATH = File.expand_path( APP_ROOT_CUSTOM  + 'config/application', APP_ROOT_CUSTOM  + 'script/rails')

begin  
    require 'rubygems'
    require 'win32/daemon'
    include Win32
    require File.expand_path( APP_ROOT_CUSTOM  + 'config/boot', APP_ROOT_CUSTOM  + 'script/rails')
    require 'rails/commands/server'
    module ::Rails
        class Server
            def default_options
                super.merge({
                    :Port        => 3000,
                    :environment => (ENV['RAILS_ENV'] || "development").dup,
                    :daemonize   => false,
                    :debugger    => false,
                    :pid         => File.expand_path( APP_ROOT_CUSTOM + "tmp/pids/server.pid" ),
                    :config      => File.expand_path( APP_ROOT_CUSTOM + "config.ru" )
                })
            end
        end
    end

    class DemoDaemon < Daemon       
        # This method fires off before the +service_main+ mainloop is entered.
        # Any pre-setup code you need to run before your service's mainloop
        # starts should be put here. Otherwise the service might fail with a
        # timeout error when you try to start it.
        #
        def service_init
        end

        # This is the daemon's mainloop. In other words, whatever runs here
        # is the code that runs while your service is running. Note that the
        # loop is not implicit.
        #
        # You must setup a loop as I've done here with the 'while running?'
        # code, or setup your own loop. Otherwise your service will exit and
        # won't be especially useful.
        #
        # In this particular case, I've setup a loop to append a short message
        # and timestamp to a file on your C: drive every 20 seconds. Be sure
        # to stop the service when you're done!
        #
        def service_main(*args)

            Rails::Server.new.tap { |server|
                require APP_PATH
                Dir.chdir( APP_ROOT_CUSTOM )
                server.start
            }

            msg = 'application started at: ' + Time.now.to_s

            File.open(LOG_FILE, 'a'){ |f|
                f.puts msg
                f.puts "Args: " + args.join(',')
            }

            # While we're in here the daemon is running.
            while running?
                if state == RUNNING
                    sleep 20 
                    msg = 'Service is running as of: ' + Time.now.to_s
                    File.open(LOG_FILE, 'a'){ |f| f.puts msg }
                else # PAUSED or IDLE
                    sleep 0.5
                end
            end

            # We've left the loop, the daemon is about to exit.

            File.open(LOG_FILE, 'a'){ |f| f.puts "STATE: #{state}" }

            msg = 'service_main left at: ' + Time.now.to_s

            File.open(LOG_FILE, 'a'){ |f| f.puts msg }
        end

        # This event triggers when the service receives a signal to stop. I've
        # added an explicit "exit!" here to ensure that the Ruby interpreter exits
        # properly. I use 'exit!' instead of 'exit' because otherwise Ruby will
        # raise a SystemExitError, which I don't want.
        #
        def service_stop
            msg = 'Received stop signal at: ' + Time.now.to_s
            File.open(LOG_FILE, 'a'){ |f| f.puts msg }
            exit!
        end

        # This event triggers when the service receives a signal to pause. 
        #
        def service_pause
            msg = 'Received pause signal at: ' + Time.now.to_s
            File.open(LOG_FILE, 'a'){ |f| f.puts msg }
        end

        # This event triggers when the service receives a signal to resume
        # from a paused state.
        #
        def service_resume
            msg = 'Received resume signal at: ' + Time.now.to_s
            File.open(LOG_FILE, 'a'){ |f| f.puts msg }
        end
    end

    # Create an instance of the Daemon and put it into a loop. I borrowed the
    # method name 'mainloop' from Tk, btw.
    #
    DemoDaemon.mainloop
rescue Exception => err
    File.open(LOG_FILE, 'a'){ |fh| fh.puts 'Daemon failure: ' + err }
    raise
end 
```

将两个文件放在同一个目录中并运行

```
ruby demo_daemon_ctl.rb install 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T14:41:06.317

使用[http://www.firedaemon.com/](http://www.firedaemon.com/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-08-23T13:04:57.927

希望这对任何人都有帮助。我定义了使用瘦服务器启动 redmine 的 Windows 服务。

使用[http://nssm.cc/usage](http://nssm.cc/usage)创建 Windows 服务。设置 ruby​​.exe 的路径，你的 redmine 的工作目录并定义启动参数：

```
Path: C:\RailsInstaller\Ruby2.3.3\bin\ruby.exe
Startup directory: C:\Program Files\redmine-3.4.6
Arguments: C:\RailsInstaller\Ruby2.3.3\bin\thin start -e production -p 3000 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-26T21:20:02.657

前段时间，我也尝试在 Windows 上安装 Redmine。但我无法让它工作，可能是[因为缺乏 Rails 知识](https://stackoverflow.com/a/3254490/6884)。

然后我发现了[Bitnami Redmine Stack](http://bitnami.com/stack/redmine)。他们有一个 Windows 安装程序，它安装了 Redmine 以及所有需要的依赖项，**而且它可以正常工作**。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-05-06T16:31:57.733

对于 Bohdan 建议的 Rails 4.0.x 应用程序，我们必须替换

CONFIG['bindir'] 与 RbConfig::CONFIG['bindir']

记住：gem install win32-service

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-03-22T03:59:48.480

*   `gem install win32-service`
*   放在 service.rb 文件中的 Ruby 代码下方并更新 REDMINE_DIR 路径以适合您的 Redmine 安装
*   创建服务，例如`sc create redmine binPath= "C:\Ruby23-x64\bin\rubyw -C E:\www\redmine-3.3.2\ service.rb"`where`E:\www\redmine-3.3.2\`是 service.rb 文件所在目录的路径以及`C:\Ruby23-x64\bin\rubyw`您的 Ruby 安装路径

开始需要 'win32/daemon' 包括 Win32

```
 class RedmineService < Daemon

    def service_init
      File.open(LOG_FILE, 'a'){ |f| f.puts "Initializing service #{Time.now}" } 

      #@server_pid = Process.spawn 'ruby script/rails s -e production', :chdir => REDMINE_DIR, :err => [LOG_FILE, 'a']
      # use full path
      @server_pid = Process.spawn 'C:\Ruby23-x64\bin\ruby E:\www\redmine-3.3.2\bin\rails s -e production -p 3000', :chdir => REDMINE_DIR, :err => [LOG_FILE, 'a']
    end

    def service_main
      File.open(LOG_FILE, 'a'){ |f| f.puts "Service is running #{Time.now} with pid #{@server_pid}" }
      while running?
        sleep 10
      end
    end

    def service_stop
      File.open(LOG_FILE, 'a'){ |f| f.puts "Stopping server thread #{Time.now}" }
      system "taskkill /PID #{@server_pid} /T /F" 
      Process.waitall
      File.open(LOG_FILE, 'a'){ |f| f.puts "Service stopped #{Time.now}" }
      exit!
    end
  end

  RedmineService.mainloop

rescue Exception => e
  File.open(LOG_FILE,'a+'){ |f| f.puts " ***Daemon failure #{Time.now} exception=#{e.inspect}\n#{e.backtrace.join($/)}" }
  raise
end 
```

*   请注意，service.rb 中的 Process.spawn 使用完整路径。

# google-app-engine - Maven 谷歌应用引擎项目中数据核增强器的冲突版本

> ID：877949
> 
> 赞同：19
> 
> 时间：2009-05-18T14:11:15.143
> 
> 标签：google-app-engine, maven-2, datanucleus

我在设置 datanucleus 增强器以与谷歌应用程序引擎项目一起使用时遇到问题。如果我使用 datanucleus eclipse 插件一切顺利，但在我的 maven 项目中，我得到一个奇怪的冲突版本错误。

我的 POM 有这些数据核参考：

```
<dependency>
    <groupId>org.datanucleus</groupId>
    <artifactId>datanucleus-core</artifactId>
    <version>1.1.0</version>
</dependency>

...

<plugin>
    <groupId>org.datanucleus</groupId>
    <artifactId>maven-datanucleus-plugin</artifactId>
    <version>1.1.0</version>
    <configuration>
        <mappingIncludes>**/*.class</mappingIncludes>
        <verbose>true</verbose>
        <enhancerName>ASM</enhancerName>
        <api>JDO</api>
    </configuration>
    <executions>
        <execution>
        <phase>compile</phase>
        <goals>
            <goal>enhance</goal>
        </goals>
        </execution>
    </executions>
</plugin> 
```

当我尝试构建项目时，出现以下错误：

```
线程“main”插件（Bundle）“org.datanucleus”中的异常已注册。
确保类路径中没有同一个插件的多个 JAR 版本。URL“file:/Users/drome/.m2/repository/org/datanucleus/datanucleus-core/1.1.0/**datanucleus-core-1.1.0.jar**”已注册，您正在尝试在 URL“file:/Users/drome/.m2/repository/org/datanucleus/datanucleus-core/1.1.3/**datanucleus-core-1.1.3.jar**”注册一个相同的插件。
org.datanucleus.exceptions.NucleusException：插件（捆绑）“org.datanucleus”已注册。确保类路径中没有同一个插件的多个 JAR 版本。URL "file:/Users/drome/.m2/repository/org/datanucleus/datanucleus-core/1.1.0/datanucleus-core-1.1.0.jar" 已注册，您正在尝试注册相同的插件位于 URL “file:/Users/drome/.m2/repository/org/datanucleus/datanucleus-core/1.1.3/datanucleus-core-1.1.3.jar”。
在 org.datanucleus.plugin.NonManagedPluginRegistry.registerBundle(NonManagedPluginRegistry.java:437)
在 org.datanucleus.plugin.NonManagedPluginRegistry.registerBundle(NonManagedPluginRegistry.java:343)
在 org.datanucleus.plugin.NonManagedPluginRegistry.registerExtensions（NonManagedPluginRegistry.java:227
)
在 org.datanucleus.plugin.NonManagedPluginRegistry.registerExtensionPoints（NonManagedPluginRegistry.jav
答：159）
在 org.datanucleus.plugin.PluginManager.registerExtensionPoints(PluginManager.java:82)
在 org.datanucleus.OMFContext.(OMFContext.java:164)
在 org.datanucleus.enhancer.DataNucleusEnhancer.(DataNucleusEnhancer.java:171)
在 org.datanucleus.enhancer.DataNucleusEnhancer.(DataNucleusEnhancer.java:149)
在 org.datanucleus.enhancer.DataNucleusEnhancer.main（DataNucleusEnhancer.java:1157）

```

我不明白为什么 datanucleus 需要 maven 下载 datanucleus-core-1.1.3.jar，因为 pom.xml 中没有引用它

我也不明白为什么要注册 datanucleus-core-1.1.3.jar ......

有任何想法吗？提前致谢...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T15:39:25.013

DN M2 插件引入了它需要完成其工作的可用 DN jar 的最新版本（除了使用最新版本之外，没有其他明智的方法可以做到这一点）。您想将“核心”限制为不同的版本，或者通过指定核心的插件依赖项，或者通过在您的应用程序中指定

```
<dependency>
    <groupId>org.datanucleus</groupId>
    <artifactId>datanucleus-core</artifactId>
    <version>1.1.0</version>
    <scope>runtime</scope> 
</dependency> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-07T12:38:27.490

不幸的是，答案在评论中“隐藏”了：

```
<dependency>
    <groupId>org.datanucleus</groupId>
    <artifactId>datanucleus-core</artifactId>
    <version>1.1.0</version>
    <scope>runtime</scope>
</dependency> 
```

这对我有用！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-11-19T16:19:23.647

我在测试 maven gae 插件原型时遇到了同样的问题。

我通过在我的 gae 运行时传递依赖项中添加排除项来修复它

```
<!-- Google App Engine meta-package -->
        <dependency>
            <groupId>net.kindleit</groupId>
            <artifactId>gae-runtime</artifactId>
            <version>${gae.version}</version>
            <type>pom</type>
            <exclusions>
                <exclusion>
                    <groupId>com.google.appengine.orm</groupId>
                    <artifactId>datanucleus-core</artifactId>
                </exclusion>

            </exclusions>
        </dependency> 
```

然后将核心核心添加为运行时依赖项

```
<dependency>
            <groupId>org.datanucleus</groupId>
            <artifactId>datanucleus-core</artifactId>
            <version>${datanucleus-core.version}</version>
            <scope>runtime</scope>
            <exclusions>
                <exclusion>
                    <groupId>javax.transaction</groupId>
                    <artifactId>transaction-api</artifactId>
                </exclusion>
            </exclusions>
        </dependency> 
```

保持 gae 插件部分简单：

```
<plugin>
                <groupId>org.datanucleus</groupId>
                <artifactId>maven-datanucleus-plugin</artifactId>
                <version>${maven-datanucleus-plugin.version}</version>
                <configuration>
                    <!--
                        Make sure this path contains your persistent classes!
                    -->
                    <mappingIncludes>**/model/*.class</mappingIncludes>
                    <verbose>true</verbose>
                    <enhancerName>ASM</enhancerName>
                    <api>JDO</api>
                </configuration>
                <executions>
                    <execution>
                        <phase>compile</phase>
                        <goals>
                            <goal>enhance</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-28T12:19:54.900

在阅读了“[如何在 Maven 中覆盖插件的依赖](http://www.sonatype.com/people/2008/04/how-to-override-a-plugins-dependency-in-maven/)项”之后，我找到了另一种解决此问题的方法。这是我的POM：

```
<plugin>
  <groupId>org.datanucleus</groupId>
  <artifactId>maven-datanucleus-plugin</artifactId>
  <version>3.1.0-m3</version>
  <configuration>
    <verbose>true</verbose>
  </configuration>

  <executions>
    <execution>
      <phase>process-classes</phase>
      <goals>
        <goal>enhance</goal>
      </goals>
    </execution>
  </executions>

  <dependencies>
    <dependency>
      <groupId>org.datanucleus</groupId>
      <artifactId>datanucleus-core</artifactId>
      <version>3.0.4</version>
    </dependency>
  </dependencies>
</plugin> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-18T21:55:47.777

从本地 Maven 存储库中清除旧版本的 datanucleus 也可以解决问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-04T16:00:55.903

自 3.1.1 版以来，Maven-datanucleus-plugin 已停止引入可用 datanucleus-core 的最新版本。

检查 Maven-datanucleus-plugin 3.1.1 的 POM 文件之间的差异（[http://repo1.maven.org/maven2/org/datanucleus/maven-datanucleus-plugin/3.1.1/maven-datanucleus-plugin-3.1 .1.pom](http://repo1.maven.org/maven2/org/datanucleus/maven-datanucleus-plugin/3.1.1/maven-datanucleus-plugin-3.1.1.pom)）和 3.1.0-release（[http://mvnrepository.com/artifact/org.datanucleus/maven-datanucleus-plugin/3.1.0-release](http://mvnrepository.com/artifact/org.datanucleus/maven-datanucleus-plugin/3.1.0-release)）。

对于 maven-datanucleus-plugin 3.1.1，datanucleus-core 依赖的版本范围是 (3.0.99, 3.1.99)，对于 maven-datanucleus-plugin 3.1.0-release，它是 (3.0.99, )。难怪旧版本的 maven-datanucleus-plugin 会自动引入最新版本的 datanucleus-core。

# database - 使用针对不同数据库的测试运行 MSTest

> ID：877950
> 
> 赞同：0
> 
> 时间：2009-05-18T14:11:28.063
> 
> 标签：database, orm, tfs, mstest, tfsbuild

我想问一下执行如下设置的最佳方法是什么：我们有编译的测试套件，在 app.config 文件中我有 6-7 个不同的连接字符串到不同的数据库。我想针对每个连接运行测试套件，我希望以某种方式参数化这个过程——比如设置连接的名称并将其作为参数传递给 testrun。到目前为止，我发现我可以使用不同的 localconfigrun 文件，并且通过部署项我可以提供具有所需值的 xml/txt 文件，但是有更好更轻的解决方案吗？我只需要发送一个键/值对或简单的字符串来在测试套件中配置我的基类。

我正在使用 tfsbuild，但我也可以通过其他环境使用 mstest（纯 msbuild 等）

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T04:39:15.717

我有一个类似的问题。这就是我所做的：

我的 app.config 看起来像这样：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <appSettings>
    <add key="ConenctToInputDB" value="InputDev" />
    <add key="ConnectToOutputDB" value ="OutputDev"/>
    <add key="ClientSettingsProvider.ServiceUri" value="" />
  </appSettings>
  <connectionStrings>
    <add name="LocalConnection" connectionString="YOUR CONNECTION STRING HERE" />
    <add name="InputDev" connectionString="YOUR CONNECTION STRING HERE" />
    <add name="InputCert" connectionString="YOUR CONNECTION STRING HERE"/>
    <add name="OutputDev" connectionString="YOUR CONNECTION STRING HERE/>
    <add name="OutputCert" connectionString="YOUR CONNECTION STRING HERE" />
    <add name="InputProd" connectionString="YOUR CONNECTION STRING HERE/>
    <add name="OutputProd" connectionString="YOUR CONNECTION STRING HERE" />
  </connectionStrings> 
```

在这种情况下，我连接了 2 个数据库，每个数据库都有 3 个不同的连接字符串（开发、认证和生产）

将此添加到项目文件的底部（右键单击项目并卸载它）。`</project>`确保在标签之前添加它。（您需要安装 MSBuild 社区任务才能工作。它们可以从以下网址免费下载：http: [//msbuildtasks.tigris.org/](http://msbuildtasks.tigris.org/) （确保每晚构建））

```
 <PropertyGroup>
    <!--Import the MSBuild community tasks so we can update xml-->
    <MSBuildCommunityTasksPath>C:\PathToMSBuildCommunityTasks\MSBuildTasks</MSBuildCommunityTasksPath>
    <SubstitutionsFile Condition="'$(Configuration)' == 'Debug'">DevAppSettings.xml</SubstitutionsFile>
    <SubstitutionsFile Condition="'$(Configuration)' == 'Cert'">CertAppSettings.xml</SubstitutionsFile>
    <SubstitutionsFile Condition="'$(Configuration)' == 'Prod'">ProdAppSettings.xml</SubstitutionsFile>
  </PropertyGroup>
  <Import Project="C:\PathToMSBuildCommunityTasks\lib\MSBuildTasks\MSBuild.Community.Tasks.Targets" />
  <Target Name="AfterBuild">
    <!--Update the app config to have the correct environment paths-->
    <Message Text="Updating $(MSBuildProjectName) config to $(Configuration)" Importance="high"></Message>
    <XmlMassUpdate ContentFile="$(OutDir)\$(MSBuildProjectName).dll.config" SubstitutionsFile="..\..\$(SubstitutionsFile)" />
  </Target> 
```

这将`<appSettings>`根据当前配置替换 app.config 文件的部分。您将需要进行新的配置（我称它们为 Cert 和 Prod）。

最后一步是为每个配置创建一个文件（我称它们为 DevAppConfig.xml、CertAppConfig.xml、ProdAppConfig.xml）

在每个文件中应该如下所示（这个用于认证配置）：

```
<?xml version="1.0" encoding="utf-8"?>
<!--This file is used by the build files to merge in solution wide app settings
Some projects contain files that have an AppSetting section (usually in App.config).  Those projects have
and AfterBuild event in the project file that substitues this xml tree over the the normal xml tree.-->
<configuration xmlns:xmu="urn:msbuildcommunitytasks-xmlmassupdate">
  <appSettings>
    <add xmu:key="key" key="ConenctToInputDB" value="Cert"/>
    <add xmu:key="key" key="ConnectToOutputDB" value="ESPCert"/>
  </appSettings>
</configuration> 
```

所有这一切，一旦安装，将根据您正在编译的配置自动更改 app.config 输出的文件。此代码适用于在 IDE 和 Team Build 中进行编译。

# sql-server - SSRS：如何计算真实行数

> ID：877951
> 
> 赞同：6
> 
> 时间：2009-05-18T14:11:36.580
> 
> 标签：sql-server, vb.net, reporting-services

我有一个包含带有布尔值列的数据集的报告。在表格页脚中，我想显示`x / y`过去`x`有多少行`true`以及`y`总共有多少行。

目前我有这个：

```
=Count(Fields!Transfered.Value).ToString() + " / " + CountRows().ToString() 
```

但第一部分与最后一部分相同。然后我尝试了这个：

```
=Sum(Fields!Transfered.Value).ToString() + " / " + CountRows().ToString() 
```

但这会产生一个错误，我想我可以理解。我认为如果我将布尔值转换为 true 为 1 而 false 为 0 的数字，那么它可以很好地工作。但我该怎么做呢？或者这是一种更聪明的方式来完成这一切？

**更新：**现在也试过了

```
=Sum(CInt(Fields!Transfered.Value)).ToString() + " / " + CountRows().ToString() 
```

并得到了否定的结果... Oo

还找到了一种可行的方法，我将其发布为答案。但我不会接受它作为答案，因为有人有更好的方法来做到这一点=）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-18T14:39:43.917

我可以告诉你为什么会出错...

*   Count(Fields!Transfered.Value) 只是行数。又名 CountRows()
*   Sum(Fields!Transfered.Value) 正在尝试聚合“true”或“false”=错误
*   Sum(CInt(Fields!Transfered.Value)) 将求和 -1 和 0，因为 VB.NET true = -1
*   Sum(IIF(Fields!Transfered.Value, 1, 0)) 修复符号问题 = 您的解决方案

为避免额外的 IIF，您可以使用否定所有 -1 的总和

```
= -Sum(CInt(Fields!Transfered.Value)).ToString() + " / " + CountRows().ToString() 
```

最后，任何一种解决方案都可以，而且都同样笨拙

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T14:19:44.347

想出了一种方法来做到这一点，虽然可能有更好的更清晰和合乎逻辑的方法......

```
=Sum(IIF(Fields!Transfered.Value, 1, 0)).ToString() + " / " + CountRows().ToString() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-13T20:01:19.873

我今天遇到了这个问题，至少证实了我不是唯一一个从 SSRS 中得到负总和值的人。谢谢。

我的解决方案是使用 ABS 作为绝对值。我喜欢这样比仅仅否定表达式更好，因为如果您在阅读表达式时不小心，更容易从视觉上看到“-”可能被遗漏的位置。

但这本质上是一回事

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-20T18:24:43.687

这是您依靠分组值的一种方式

```
=CountDistinct(IIF(Fields!TrueOrFalseField.Value, 
                   Fields!GroupedField.Value,
                   "BadValueToBeRemovedFromCount"))
              -IIF(CountDistinct(Fields!TrueOrFalseField.Value)=1 
                                 and First(Fields!TrueOrFalseField.Value)
                    , 0, 1) 
```

第二部分

```
-IIF(CountDistinct(Fields!TrueOrFalseField.Value)=1 
                                     and First(Fields!TrueOrFalseField.Value)
                        , 0, 1) 
```

`True`如果计数具有和`False`值或只有一个不同的值，则从计数中删除 1 `false`。

# .net - ASP.NET 检查长时间运行线程上的线程状态？

> ID：877956
> 
> 赞同：0
> 
> 时间：2009-05-18T14:12:12.943
> 
> 标签：.net, asp.net, multithreading

我有一种情况，用户请求执行一个长时间运行的过程。我打算在代码隐藏中的另一个线程上启动它并将消息返回给用户“处理”。然后每隔几秒钟左右，我将轮询（通过异步调用）线程的状态。线程完成后，我想显示成功消息。

问题，一旦原始请求完成，我如何轮询线程？

据我了解， Page 对象将分拆一个单独的线程。当请求完成时，Page 对象不再存在……但是那个线程呢？如何获取我创建的那个线程的状态？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T14:16:29.800

那么，您将需要*某种*方式来识别请求。如果您希望能够将其扩展到多台机器，您应该考虑将请求 ID 和当前状态存储在数据库（或类似的可从任何地方访问的存储）中。

如果您不关心这种情况*并且*您不担心 AppDomain 回收，您可以只拥有一个从请求 ID 到状态的单例字典 - 但如果客户端只是离开并且不考虑在一段时间后使其自动刷新'不检查状态。

（当然它不一定是真正的单例——它可以是依赖注入提供的一些共享资源，但关键是它需要以*某种方式*共享，这样你就可以从新请求中获取它。）

您还可以潜在地使用会话支持的对象 - 再次注意有关多服务器网站和`AppDomain`回收的警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-18T18:13:55.677

我不同意乔恩的回答。您不需要一种识别请求的方法，您需要一种唯一识别您的请求创建的线程的方法。然后您轮询线程的ajax 请求可以检查线程是否已完成执行。我不明白为什么原始请求完全相关......

# .net - 使用 msbuild 发布网站

> ID：877962
> 
> 赞同：3
> 
> 时间：2009-05-18T14:12:54.563
> 
> 标签：.net, msbuild

我想使用 msbuild 发布一个网站。由于我有一个网站，而不是一个 Web 应用程序项目，我该如何解决这个问题，因为我没有 .csproj 文件并且 msbuild 需要一个项目文件作为输入，或者您可以在包含项目文件的文件夹中执行它。我的解决方案文件包含多个没有 .csproj 文件的网站？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T19:08:24.953

我会为每个网站创建 Web 部署项目，MSBuild 可以读取`.wdproj`文件（它实际上是一个 MSBuild 脚本）。

[VS2008 Web部署工程下载](http://www.microsoft.com/downloads/details.aspx?familyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&displaylang=en)

这是一个 Visual Studio 模板，可以完全满足您的需求。

此脚本在内部使用 ASP.NET 编译器任务，以及根据项目设置复制一些文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T14:15:54.043

使用 Aspnet 编译器任务。

[http://msdn.microsoft.com/en-us/library/ms164291.aspx](http://msdn.microsoft.com/en-us/library/ms164291.aspx)

它适用于 asp.net 网站。只需复制（或直接输出）到您需要部署的位置。

# java - 在 Swing 中使用大型自定义组件时如何有效地重绘？

> ID：877965
> 
> 赞同：5
> 
> 时间：2009-05-18T14:13:18.103
> 
> 标签：java, user-interface, swing, optimization, graphics

我制作了一个**自定义组件**（从 JComponent 派生），它代表一个可拖动的**Bezier-curve**。
*（看起来像一根悬挂的电缆，有人可能从 Bender 或 Cubase 知道它）*

我的问题是：曲线可能会变**得很长**，比如说从桌面的左上角到右下角。

这使得 Swing 的**重绘**功能**效率低下**：曲线的面积可能只有几百像素，但组件的面积（大部分是**“透明的”**）是几百万像素大。

我的主观印象是：曲线越长，拖动时
**越闪烁。**

我希望我清楚地说明了这个问题。

当我以某种方式可以自己选择 组件的**哪些区域****需要重新绘制时**，也许它会有所帮助。

**编辑：**
真是一团糟！我正在使用 Netbeans 分析应用程序，这有助于正常查找效率低下的代码，但是这个 Swing 框架正在进行数百次嵌套调用！我只是想不通，什么是慢的以及为什么。
顺便说一句，禁用`super.paint(...)`或`super.paintComponent(...)`没有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T14:29:56.853

查看Chet Haase 和 Romain Guy 的《[肮脏的富客户》。](http://filthyrichclients.org/)他们在生成响应式和图形令人印象深刻的 UI 的过程中解决了这些非常优化的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T08:42:45.247

尝试编写一个小型测试应用程序，它只包含重现此问题所需的内容。这将使分析更容易。然后在此处发布该应用程序，以便我们查看可能的解决方案。

我发现您的问题很有趣，所以我自己编写了一个测试应用程序。这将绘制一条贝塞尔曲线，该曲线在您拖动时不断调整大小。我创建了一个渐变背景，以确保它适用于讨厌的背景。尽管我使用一流的机器，但我获得了良好的性能和低闪烁。

阅读“肮脏的富客户端”以了解编写性能非常好的自定义 Swing 组件的所有技巧是值得的。

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.geom.CubicCurve2D;
import java.awt.geom.Point2D;

public class CustomComponent extends JComponent {

    private Point2D start = new Point2D.Double(0, 0);
    private Point2D end = new Point2D.Double(300, 200);

    private CustomComponent() {
        this.setOpaque(true);
        final MouseAdapter mouseAdapter = new MouseAdapter() {

            @Override
            public void mouseDragged(MouseEvent e) {
                    setEnd(e.getPoint());
            }

        };
        this.addMouseListener(mouseAdapter);
        this.addMouseMotionListener(mouseAdapter);
    }

    public void setStart(Point2D start) {
        this.start = start;
        repaint();
    }

    public void setEnd(Point2D end) {
        this.end = end;
        repaint();
    }

    @Override
    protected void paintComponent(Graphics g) {

        final Graphics2D g2 = (Graphics2D) g;
        g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);

        // draw gradient background
        final int width = getWidth();
        final int height = getHeight();
        g2.setPaint(new GradientPaint(0, 0, Color.WHITE, width, height, Color.YELLOW));
        g2.fillRect(0, 0, width, height);

        // draw Bezier curve
        final Shape shape = new CubicCurve2D.Double(start.getX(), start.getY(), start.getX(), end.getY(), end.getX(), start.getY(), end.getX(), end.getY());
        g2.setColor(Color.BLACK);
        g2.draw(shape);

        g2.drawString("Click and drag to test for flickering", 100, 20);
    }

    public static void main(String[] args) {
        final CustomComponent component = new CustomComponent();
        final Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();
        final Dimension size = new Dimension(screenSize.width - 20, screenSize.height - 100);
        component.setPreferredSize(size);

        final JFrame frame = new JFrame();
        frame.add(component);
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setVisible(true);
    }

} 
```

需要注意的一些事项：

*   只覆盖paintComponent(Graphics g)，而不是其他paintXXX()方法
*   如果可能，将自定义组件设置为不透明
*   仅使用 repaint() 请求重绘。永远不要直接在您的代码中直接订购重绘。这让 Swing 可以很好地处理它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T21:58:29.163

每次刷新组件时都在绘制线程上执行所有贝塞尔数学运算（正如您所收集的）是一个坏主意。你的曲线经常变化吗？如果不是，那么为什么不在它发生变化时将其绘制到 BufferedImage 上，并更改您的 paint() 代码以将缓冲图像简单地绘制到组件中。

```
class CurveComponent extends JComponent {
    private BufferedImage image;

    @Override
    public void paintComponent( Graphics g ) {
        if ( image == null ) {
            return;
        }
        g.drawImage( image, 0, 0, this );
    }

    private void updateCurve() {
        image = new BufferedImage( getWidth(), getHeight(), BufferedImage.ARGB );
        Graphics g = image.getGraphics();
        // draw the curve onto image using g.
        g.dispose();
    }
} 
```

仅在需要时才调用 updateCurve()，并且不会不必要地重复所有昂贵的数学运算。即使对于全屏窗口，绘画也应该非常敏感。drawImage() 将进行简单的内存复制，并且应该快如闪电。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-18T14:26:36.143

没有有效的方法可以为对角线结构创建大量小剪辑矩形，这使您有两种策略来避免闪烁：

*   双缓冲。这需要大量内存，但内存复制速度非常快（它通常发生在“电子束”从右下角回到左上角的时候......如果你的 LCD 中还有光束）。

*   不要调用 super.paint() （[绘制或“擦除”背景](http://java.sun.com/products/jfc/tsc/articles/painting/index.html#lw)）并使用背景颜色再次绘制曲线以擦除它。

有关详细信息，请参阅[此文档](http://java.sun.com/products/jfc/tsc/articles/painting/index.html)。

[编辑]如果fillRect()不是抽象的，你可以设置一个断点:)在paint()中设置一个断点，检查谁调用它以及当时背景是否被清除。应该是因为渲染是完全错误的。然后在调用链中进一步设置断点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T15:43:02.057

你用什么方法来画你的曲线？油漆或油漆组件？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-18T14:22:55.357

您可以使用重绘屏幕的一小部分`repaint(Rectangle r)`

[http://java.sun.com/j2se/1.4.2/docs/api/javax/swing/JComponent.html#repaint(java.awt.Rectangle)](http://java.sun.com/j2se/1.4.2/docs/api/javax/swing/JComponent.html#repaint(java.awt.Rectangle))

然后你提到闪烁。由于您使用的是swing，它使用双缓冲，所以您的闪烁必须来自其他东西。你在清屏`paintComponent(...)`吗？即打电话给`fillRect(...)`？不要那样做，不需要（IIRC）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-18T18:53:44.617

只需使用`getVisibleRect();`inside`paintComponent(Graphics g)`来获取您实际需要重绘的区域

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-29T21:27:24.263

我的解决方案是部分**重新设计**：

现在我不会用组件来表示每个“电缆”元素。
现在，电缆只是**虚拟**对象（不涉及 JComponent）。
重绘发生在“全局”，在**父 JFrame 的内容窗格上**。

现在它很有效，并且闪烁更少。

# c# - 在 C# 中创建 COM 代理服务器 (exe)

> ID：877975
> 
> 赞同：9
> 
> 时间：2009-05-18T14:15:32.063
> 
> 标签：c#, .net, com

我知道如何在 C# 中创建 COM DLL（类库）。是否可以使用 C# 创建 COM 代理 EXE？

这将是一个独立的服务器，能够启动和托管 COM 对象，然后 COM 客户端可以访问这些对象。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T16:59:01.140

COM 的默认代理进程 - 托管 COM DLL 的东西，也就是**COM 代理**- 是 dllhost.exe。可以在 C++ 中创建代理进程。 [这篇文章](http://msdn.microsoft.com/en-us/library/ms682432(VS.85).aspx)解释了如何。

但这些 API 并未作为 .NET Framework 中基类库的一部分在包装器中公开。如果你想写只写托管代码，你需要别的东西。

我看到了几个选项。

1.  [Visual Studio SDK](http://msdn.microsoft.com/en-us/library/bb286983.aspx)，免费下载，适用于想要扩展 Visual Studio 的开发人员。在该 SDK 中，有一个具有此类包装器的类库。特别是看一下[ISurrogate 类](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.ole.interop.isurrogate.aspx)。
    但是，VS SDK 许可证表明 SDK 可以*仅*用于扩展或增加 Visual Studio 价值的产品。我不是律师，但这是我对许可证的理解，很清楚。这些术语意味着 VS SDK 对一般的应用程序构建没有用处。
    剩下的一个问题是，**究竟如何使用 VS SDK 在技术上仅使用 C# 代码生成 COM 代理？** 再说一次，我不知道。我在文档中简要查看了有关使用 ISurrogate 包装器的指南，但没有找到。
2.  使用[本文](http://www.codeproject.com/KB/COM/BuildCOMServersInDotNet.aspx)中的代码。
    本文探讨了围绕 COM 和 .NET 互操作的一系列不同方面。在文章的最后，它提供了用于在 C# 中构建您自己的 COM 服务器的源代码，以及对 CoRegisterClassObject() 和朋友的所有 p/invoke 调用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-05-23T07:06:13.533

我想做同样的事情，并在 All-In-One Code Framework 上找到了优秀的项目示例[CSExeCOMServer 。](http://code.msdn.microsoft.com/CSExeCOMServer-3b1c1054)它实际上通过 .NET 和对 Windows API 的本机调用重构了正常的 COM 服务器逻辑。但它看起来仍然过于复杂。我想在进程外服务器中将 .NET 对象公开为 COM 没有简单快捷的方法，而且它不是首选的体系结构。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T15:33:06.960

如果您想要一个进程外 COM 组件，一种选择是通过[serviced components](http://msdn.microsoft.com/en-us/library/3x7357ez(VS.80).aspx)在 COM+ 中托管一个 dll 。虽然这仅支持 dll，但您可以编写一个简单地遵循 dll 的 shell exe（供独立使用）。

不像VB那么简单，但它可以工作。

我确实记得有人向我展示了一种更直接的方式（没有 COM+），但我终生无法记住它是什么......

# wpf - 在 WPF 应用程序中保存状态

> ID：877978
> 
> 赞同：2
> 
> 时间：2009-05-18T14:16:02.577
> 
> 标签：wpf, c#-3.0

我正在开发一个带有树视图的 WPF 应用程序。我有像窗户一样的树状视图。现在我想要的是如果选择我的treeviewitem，让我们说......

```
+桌面
|
+---我的电脑
    |
    +---C:\
        |
        +---一些文件夹。

```

我在 c 驱动器中选择了名为 Some Folder 的文件夹名称。之后我关闭应用程序。当我再次打开应用程序时，焦点应该再次位于 c 驱动器中的某个文件夹上。换句话说，我需要在重新打开应用程序后选择相同的路径。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T14:23:11.627

有点 OT - 小心这个。如果您在指向闪存驱动器或 CD 上的文件夹时退出，则在重新启动应用程序时该位置可能不存在。通过添加在旧位置重新启动的要求，您还可以添加正常失败的要求，如果旧位置没有成功，则添加到不同的位置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T14:19:40.387

您可以将值保存在 Application.config 中，然后在重新打开应用程序并重新选择分支时检查其中是否有值

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T14:26:57.610

将 TreeView " `SelectedValuePath`" 值保存在应用程序设置中，并在加载时重新分配其值。当然，您必须注意其有效性。加载时路径可能不存在。

# asp.net-mvc - 您的操作提供程序是否只有字符串参数类型？

> ID：877979
> 
> 赞同：2
> 
> 时间：2009-05-18T14:16:14.013
> 
> 标签：asp.net-mvc

在 asp.net mvc 中，我应该将我的参数放在我的操作方法字符串中还是可以将它们作为整数？

（比如页码）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T14:21:38.510

页码应该是整数，而不是字符串。ASP.NET MVC 将适当地转换它们（只要它们实际上是整数）。

正如我在对您的问题的评论中所说（并且MasterMind[也指出](https://stackoverflow.com/questions/877979/do-your-action-providers-have-only-string-parameter-types/878006#878006)），您可以将任何类型作为您的操作方法的参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T14:22:15.823

您可以拥有不同类型的它们，甚至是您自定义的类。

# asp.net-mvc - 在 MVC 中声明单个模型的 VB 语法（利用强类型视图）

> ID：877980
> 
> 赞同：1
> 
> 时间：2009-05-18T14:16:24.980
> 
> 标签：asp.net-mvc, vb.net, strongly-typed-view

我试图尽可能避免使用魔术字符串，但我找不到正确的 VB 语法来绑定单个模型，如此[c# 示例](https://stackoverflow.com/questions/750543/mvc-using-ajax-to-render-partial-view)中所示。

谁能指出我正确的方向？

（目前以下在模型文本下表示“预期的声明结束”）

```
<% Dim FormObject As Form = (Form)Model %> 
```

编辑：

需要一个简单的直接广播（对不起这个愚蠢的问题）

```
<%  Dim FormObject As Form = DirectCast(Model, Form)%> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T14:19:49.340

您要移植的是演员表操作员。试试下面的代码。

```
<% Dim FormObject As Form = DirectCast(Model, Form) %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T14:21:50.723

您必须使用 C# 或 VB.NET 使您的视图像这样强类型：

```
<%@ Page Language="C#" Inherits="System.Web.Mvc.ViewPage<FormObject>" %> 
```

这样当你想使用它时，你不需要投射它

```
<% Dim FormObject As Form = Model %> 
```

# javascript - 奇怪的 IE7 jquery height() 行为

> ID：877992
> 
> 赞同：3
> 
> 时间：2009-05-18T14:19:23.490
> 
> 标签：javascript, jquery

在 IE7 中，此代码无法正常工作：

```
 myJqObj.css("height", DEFAULT_HEIGHT); 
```

运行的时候好像把myJqObj的高度设置为0；但是，如果我在设置后立即查询高度，一切正常：

```
 myJqObj.css("height", DEFAULT_HEIGHT);  
        myJqObj.height(); 
```

这也有效：

```
 myJqObj.css("height", DEFAULT_HEIGHT);  
        myJqObj.width(); 
```

我敢肯定，如果您自己运行以前的代码，一切都会正常工作。这一切都发生在一些相当复杂的页面构建中。显然，我的 js 环境中存在导致错误的东西。以前有人见过这样的事情吗？任何想法从哪里开始寻找？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T14:25:50.233

我会检查特异性。您是否已验证您的“myJqObj”对象对于 IE7 是否足够具体？

当我设置接受 FireFox 而不是 IE7 的 CSS 时，通常是因为我已经为元素（例如`<div id="mydiv"><p>`元素）设置了 CSS，而我的`<div id="mydiv"><p class="myclass">`高度定义被第一个定义覆盖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-12-06T15:02:12.873

IE7中设置高度的同样问题

也可以通过设置后查询高度来解决它。

这是bug？？？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T16:55:45.530

你可能找错地方了。

您是否将 myJqObj 设置为在 CSS 中浮动？如果是这样，由于浮动元素折叠，高度实际上将为 0。*********