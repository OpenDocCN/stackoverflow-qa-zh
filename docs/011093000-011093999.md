# StackOverflow 问答 11093000-11093999

# java - JSF 2.0 和 Primefaces 的另一个“找不到组件”

> ID：11093001
> 
> 赞同：0
> 
> 时间：2012-06-19T00:46:33.150
> 
> 标签：java, jsf, primefaces

刚刚看到很多涉及“update”、“@all”、“@form”的问题，但没有人解决我的应用程序中的一个情况。

我有一个名为 threadList 的自定义 JSF 标签：

```
<h:form>
    <h:panelGroup>
        <p:commandButton action="#{Bean.action(catId, id)}" icon="ui-icon-weblibrary ui-icon-weblibrary-like" title="Start" update="@form" value="#{Bean.threadName}" />
    </h:panelGroup>
</h:form> 
```

此自定义标签由另一个自定义标签插入，如下所示：

```
<ui:repeat value="#{Bean.threadList}" var="thread">
   <ui:include src="threadList.xhtml">
      <ui:param name="catId" value="..." />
      <ui:param name="id" value="..." />
   </ui:include>
</ui:repeat> 
```

有时这可能是第二个 taglib 和通过 ajax 更新的结果。

事情是这样的……

*   当我在 p:commandButton 中设置 update="@form" 时，一切正常，但在我的日志中，我看到“无法找到标识符为 "j_idt70:0:j_idt82" 的组件。”；
*   当我设置 update=":@form" 或 update=":form" 时，“在视图中找不到标识符为“j_idt70:0:j_idt82”的组件。” 消失，但事件不会更新任何内容（即使操作成功运行）；
*   最后，当我给 form 和 panelGroup 一个 id 并尝试 update=":formId:panelId" 或 update=":@formId:panelId" 或 update=":formId" 消息“找不到具有标识符“j_idt70:0 的组件： j_idt82" 在视图中。" 出现并且没有任何更新。

奇怪的是浏览器的源代码中没有。所以，我不知道这个“幽灵”j_idt70 是否破坏了所有的 id 和更新命令。

我尝试了我在堆栈溢出的旧问题中学到的所有东西，然后再问你这个问题。

非常感谢阅读和关注。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T12:32:52.283

到目前为止给出的代码对我来说在 Mojarra 2.1.9 和 PrimeFaces 3.3 上工作得很好。

如果您也升级到最新版本，那么您的问题很可能会得到解决。

# javascript - 发生 onHover 事件时使 jQuery 可拖放滚动

> ID：11093006
> 
> 赞同：0
> 
> 时间：2012-06-19T00:47:07.360
> 
> 标签：javascript, jquery, jquery-ui, draggable, droppable

我有一个包含很多 div 的容器，但我不知道它会加载多少子元素。

这是一个可放置的区域，我想让它滚动以显示隐藏的子内容，只要用户将可拖动的内容悬停在容器的顶部/底部。

我正在使用 jquery ui draggables 和 droppables，并将感谢我能得到的所有帮助。

谢谢。

# java - JNA（Java）：如何将指针数组传递给结构？

> ID：11093009
> 
> 赞同：3
> 
> 时间：2012-06-19T00:47:42.553
> 
> 标签：java, c++, c, java-native-interface, jna

我正在使用 JNA 从 Java 调用 C 库。

在我的 C 代码中，我有：

```
 void printStructArray( SomeStruct **someStruct, int arraySize ); 
```

这需要一个指向结构的指针数组，即该方法执行以下操作：

```
void printStructArray( SomeStruct **someStruct, int arraySize ) {
   for( int i = 0; i < arraySize; i++ ) {
      cout << "someStruct: " << someStruct[i]->aLong << " " << someStruct[i]->aString << " " << someStruct[i]->aDouble << endl;
   }
} 
```

这只是一个玩具示例，但我有一个我想与之交谈的实际库，它需要相同类型的参数，但我认为在这里使用玩具示例更容易解释？

我已经尝试了各种各样的事情，但我不确定如何（i）在 JNA 中声明这个函数（ii）在 JNA 中调用这个函数。

我最近（失败）的尝试是：

```
SomeStruct.byReference[] structs = new SomeStruct.byReference[]{
        new SomeStruct.byReference(123,"hey!",1.23),
        new SomeStruct.byReference(456,"cool!",1.45),
        new SomeStruct.byReference(789,"world!",1.67) };
PointerByReference pointerByReference = new PointerByReference(structs[0].getPointer());
JniTest.instance.printStructArray(pointerByReference, 3); 
```

这会导致 SIGSEGV。

或者：

```
SomeStruct.byReference[] structs = (SomeStruct.byReference[]) new SomeStruct().toArray( new SomeStruct.byReference[]{
        new SomeStruct.byReference(123,"hey!",1.23),
        new SomeStruct.byReference(456,"cool!",1.45),
        new SomeStruct.byReference(789,"world!",1.67) } );
PointerByReference pointerByReference = new PointerByReference(structs[0].getPointer());
JniTest.instance.printStructArray(pointerByReference, 3); 
```

这会导致 ArrayStoreException

也试过这个：

```
SomeStruct.byReference[] structs = new SomeStruct.byReference[]{
    new SomeStruct.byReference(123,"hey!",1.23),
    new SomeStruct.byReference(456,"cool!",1.45),
    new SomeStruct.byReference(789,"world!",1.67) };    JniTest.instance.printStructArray(structs, 3); 
```

方法声明为：

```
void printStructArray(SomeStruct.byReference[] someStructarray, int num); 
```

这给出了“0”作为函数的输出，虽然好处是它不会崩溃，但它也没有给出正确的行为。

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T03:07:46.700

传递您的 Structure.ByReference 数组就足够了；数组的地址被传递给本机代码。JNA 自动为指针数组分配空间，该指针数组在函数调用后超出范围。

PointerByReference 旨在通过引用传递指针值（即被调用者可以更改值）。在这种情况下是*不合适的。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-19T03:21:03.730

我刚刚找到了一个效果很好的解决方案，即使用 BridJ 而不是 JNA。也许有一种方法可以让 JNA 工作，但这似乎并不明显。BridJ 非常易于使用：

宣言：

```
public static native void printStructArray(Pointer<Pointer<SomeStruct > > someStruct, int arraySize); 
```

用法：

```
Pointer<Pointer<SomeStruct>> pointers = Pointer.allocatePointers(SomeStruct.class, 3);
pointers.set(0, Pointer.pointerTo( new SomeStruct().aDouble(1.58).aLong(5432).aString(Pointer.pointerToCString("Wheee!")) ) );
pointers.set(1, Pointer.pointerTo( new SomeStruct().aDouble(1.58).aLong(5432).aString(Pointer.pointerToCString("Wheee!")) ) );
pointers.set(2, Pointer.pointerTo( new SomeStruct().aDouble(1.58).aLong(5432).aString(Pointer.pointerToCString("Wheee!")) ) );
JnitestLibrary.printStructArray(pointers, 3 ); 
```

似乎他们不支持按值结构，但我当前的界面中没有任何按值结构，所以这对我来说现在不是问题。显然性能还可以，但我没有亲自测试过性能。

请注意，我仍然对 JNA 解决方案持开放态度，并且会勾选任何可以为我提供有效 JNA 解决方案的人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T01:08:42.010

这是 C 还是 C++？

如果是 C，为什么不简单地使用 calloc/malloc 为结构分配双指针，如下所示？

```
somestruct = (SomeStruct **)calloc(arraySize, sizeof(SomeStruct *));

for (i = 0; i < arraySize; i++)

    somestruct[i] = (SomeStruct *)calloc(1, sizeof(SomeStruct)); 
```

现在，您可以根据需要填充结构。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T14:03:20.970

最后，我从来没有找到一个可行的解决方案。我所做的是通过在 C 中编写一个包装器接口来解决问题，它为 Java 提供了一个非常简单的接口，然后很容易使用 JNA 链接到它，而无需指针等。这工作得很好，而且比试图让 Pointer 工作更省力。

所以，我的界面看起来像：

```
int createHandle()
void doSomething( int handle )
void releaseHandle( int handle) 
```

就时间而言，似乎比尝试创建一些超级复杂的 jna 实现来直接连接到底层 c 接口所需的努力要少得多。

另一个优点是这意味着它很容易连接到 c++ 库，因为这样，c++ 接口由易于连接的 ac 接口包装。

# objective-c - 旋转 iPhone 时更改视图？

> ID：11093010
> 
> 赞同：1
> 
> 时间：2012-06-19T00:47:51.487
> 
> 标签：objective-c, ios, xcode

当 iPhone 处于标准的“纵向”方向时，我将如何查看一个视图，并在旋转到横向时切换到不同的视图（例如图形或其他东西），反之亦然？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T00:56:57.943

禁用该视图的方向（假设第一个视图是横向）

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation{

    return (interfaceOrientation == UIInterfaceOrientationLandscapeLeft)||(interfaceOrientation == UIInterfaceOrientationLandscapeRight); } 
```

然后将此添加到 viewDidAppear

```
[[UIDevice currentDevice] beginGeneratingDeviceOrientationNotifications];
[[NSNotificationCenter defaultCenter]
 addObserver:self selector:@selector(orientationChanged:)
 name:UIDeviceOrientationDidChangeNotification
 object:[UIDevice currentDevice]]; 
```

并在某处添加此方法

```
- (void) orientationChanged:(NSNotification *)note
{
    UIDevice * device = note.object;
    switch(device.orientation)
    {
        case UIDeviceOrientationPortrait:
            // Present View Controller here
            break;
        default:
            break;
    };
} 
```

在另一个视图上做同样的事情，但向后看，横向关闭而不是纵向。

不要忘记取消注册通知。

（或者使用带有两个控件但不带栏的导航视图，并根据使用的方向简单地显示您想要的那个）

```
- (void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation 
                                         duration:(NSTimeInterval)duration 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T00:52:58.157

首先阅读 UIViewControllers 的工作原理：http: [//developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html)

然后，在您的 UIViewController 子类中，利用`willRotateToInterfaceOrientation:duration:`更改您的视图。

例如

```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration 
{
    // if portrait
    [self.landscapeView removeFromSuperview];
    [self.view addSubview:self.portraitView];

    // if landscape
    [self.portraitView removeFromSuperview];
    [self.view addSubview:self.landscapeView];
} 
```

并添加适当的`if`语句或`switch`案例以确定要执行的操作。

# java - 等效于使用 mutators 而不是 construtor 的 NEW 运算符

> ID：11093011
> 
> 赞同：0
> 
> 时间：2012-06-19T00:47:53.297
> 
> 标签：java, jpa, jpql

JPQL 查询可以使用`NEW`运算符返回自定义结果对象：

```
 SELECT NEW myPackage.MyVO(e.fieldX, e.relationshipX.fieldY)
  FROM MyEntity AS e 
```

这对于喂养 VO 非常有用。问题是，您必须创建与查询投影的参数数量、顺序和类型完全匹配的构造函数。当您对同一个 VO 使用大量投影时，这开始变得混乱……您的 VO 中有一个大的构造函数并`NULL`在查询中使用大量文字，或者您的 VO 必须有很多不同的构造函数。

所以我的问题是：在 JPQL 中有没有办法通过 mutators 而不是构造函数来设置结果对象字段？

对于具有 .NET 背景的人，我正在寻找相当于[LINQ + object initializers](http://msdn.microsoft.com/en-us/library/ee473425.aspx)的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T00:58:55.377

简短回答**不**，您不能在 JPQL 中使用增变器。

虽然我不知道`LINQ`我不能看到这没有造成混乱。

现在我确定你知道类可以有多个构造函数。那么为什么不创建你不会有太多的构造函数`null`。

根据您的需要和您使用的 JPA 实现，大多数提供程序确实提供了非标准的方法来解决它。例如，Hibernate`@formula`在某些情况下使用它来代替使用构造函数。

如果您使用的是 JPA2，那么标准查询可能是更好的选择，并且可以处理这类事情。

在某些情况下，您可能更喜欢使用`@PostLoad`.

无论哪种方式，您都需要知道这种转换不会发生在 SQL 中，因此您并没有真正将任何工作卸载到 SQL 。我们通常更喜欢让 SQL 在单次点击中完成尽可能多的工作。

是的，这些是我的概括，具体的解决方案或要求可能不适合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T06:57:18.010

[DataNucleus JPA](http://www.datanucleus.org/products/accessplatform_3_1)当然支持两种*不使用非标准注释或调用*来实例化结果对象的方法，这主要是因为它还支持 JDO 并且对它有要求：-

1.  带参数构造函数的结果类型（如你所说）
2.  具有默认构造函数和设置器的结果类型

如

```
TypedQuery<MyResultType> q = em.createQuery("SELECT x AS field1, y AS field2 FROM ...", MyResultType.class); 
```

其中 MyResultType 具有设置器“setField1”、“setField2”。

# php - 扩展 Magento 购物车

> ID：11093017
> 
> 赞同：6
> 
> 时间：2012-06-19T00:49:11.813
> 
> 标签：php, magento, checkout, extend

我需要扩展 Magento 购物车以包含一个额外的商店定位器步骤。我知道我需要覆盖核心 OnePage控制器`Mage_Checkout_OnepageController`（`Mage_Checkout_Block_Onepage`

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-19T00:57:19.823

这里需要许多步骤来获得整个解决方案。

首先，创建一个新模块。如果您愿意，请使用[ModuleCreator 。](http://www.magentocommerce.com/extension/1108/modulecreator)

然后，在你的模块中编写一个[设置脚本](http://www.magentocommerce.com/knowledge-base/entry/magento-for-dev-part-6-magento-setup-resources)，将新字段添加到 Magento 的属性结构中，例如：

```
 $setup = new Mage_Sales_Model_Mysql4_Setup('core_setup');
 $setup->startSetup();

 $setup->addAttribute('quote', 'my_attribute', array('type' => 'varchar', 'visible' => false, 'required' => false));
 $setup->addAttribute('order', 'my_attribute', array('type' => 'varchar', 'visible' => false, 'required' => false));
 $setup->addAttribute('invoice', 'my_attribute', array('type' => 'varchar', 'visible' => false, 'required' => false));
$setup->addAttribute('creditmemo', 'my_attribute', array('type' => 'varchar', 'visible' => false, 'required' => false)); 
```

请注意使用`Mage_Sales_Model_Mysql4_Setup`将字段添加到相关表`sales_flat_quote`和`sales_flat_order`表中。

现在，在模块的 config.xml 文件中插入以下值：

```
<global>

    <fieldsets>
        <sales_convert_quote>
            <my_attribute>
                <to_order>*</to_order>
            </my_attribute>
        </sales_convert_quote>
        <sales_convert_order>
            <my_attribute>
                <to_cm>*</to_cm>
                <to_invoice>*</to_invoice>
            </my_attribute>
        </sales_convert_order>
    </fieldsets> 
```

这将指示 Magento 将自定义字段的值从报价单复制到订单到发票和 credit_memo 等。

然后在您的自定义块/控制器代码中，您将能够使用 Magento 的魔法 getter 和 setter 来持久化这些值。

```
$oQuote = Mage::getSingleton('checkout/session')->getQuote();
$oQuote->setMyAttribute('some_value');
$oQuote->save(); 
```

您应该会看到保存在 中的新列和值`sales_flat_quote`。然后，一旦客户完成结帐，相同的值应保存在`sales_flat_order`.

请注意，上面的代码可以通过更改为etc 来扩展`quote_item`，但是，如果您希望保存已在产品上设置的属性值，则需要进行一些额外的工作。`order_item``quote``quote_item`

将一个新的 XML 块插入到您的 config.xml 中（同样在全局节点内）：

```
 <sales>
        <quote>
            <item>
                <product_attributes>
                    <my_attribute />
                </product_attributes>
            </item>
        </quote>
    </sales> 
```

`my_attribute`产品型号上的属性代码在哪里。这将使 my_attribute 在链接产品上可用，因此您可以通过以下方式访问它

```
$oQuoteItem->getProduct()->getMyAttribute() 
```

无需执行完整的`Mage::getModel('catalog/product')->load($oQuoteItem->getProductId())`. 这效率更高。

然后，您将需要一个观察者将值从产品对象复制到 quote_item 对象。所以，在 config.xml 中声明你的观察者：

```
 <events>
        <sales_quote_item_set_product>
            <observers>
                <quoteitem_set_custom_data>
                    <type>singleton</type>
                    <class>mymodule/observer</class>
                    <method>setCustomDataOnQuoteItem</method>
                </quoteitem_set_custom_data>
            </observers>
        </sales_quote_item_set_product>
    <events> 
```

并在您的观察者类中编写代码，如下所示：

```
public function setCustomDataOnQuoteItem($oObserver){
    $oProduct = $oObserver->getProduct();
    $oQuoteItem = $oObserver->getQuoteItem();
    foreach(array('my_attribute') as $vAttributeCode){
        $oQuoteItem->setData($vAttributeCode,$oProduct->getData($vAttributeCode));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-03T12:38:20.490

这是一个完整的工作模块。它（几乎）与上面的 Johnatan 代码相同。你会在这里找到它： [https ://bitbucket.org/vovsky/adding-custom-product-attribute-to-quote-and-order-items-in/](https://bitbucket.org/vovsky/adding-custom-product-attribute-to-quote-and-order-items-in/)

并在此处完整解释每一步：http: [//www.atwix.com/magento/custom-product-attribute-quote-order-item/](http://www.atwix.com/magento/custom-product-attribute-quote-order-item/)

# javascript - 对象未在 Z 轴上正确相乘

> ID：11093019
> 
> 赞同：0
> 
> 时间：2012-06-19T00:49:36.513
> 
> 标签：javascript, vrml

我在 Z 轴上重新创建同一个对象时遇到了麻烦，它在它们之间提供了错误的空间，我没有看到问题出在哪里。
我希望对象之间没有空间。这是对象 Tabua.wrl 的代码

```
#VRML V2.0 utf8

Transform
{
    translation 0 0 0
    children
    [
        Shape
        {
            appearance Appearance
            {
                texture ImageTexture
                {
                    url "Imagens/madeira1.jpg"
                }
            }

            geometry Box
            {
                size 2 0.05 0.5
            }
        }
    ]
} 
```

这是创建对象重复的代码。
quant = 对象将重复多少次
compri = 空间跳跃

```
#VRML V2.0 utf8
Transform
{
    rotation 0 1 0 3.14
    translation 0 0 0
    children
    [
        DEF Ponte Group
        {

        }
    ]
}

DEF pont Script
{
    field SFNode pt USE Ponte
    field SFNode me USE pont

    field SFInt32 CTRL 0
    field SFInt32 quant 5

    field MFFloat compri 0.5

    field MFString wrlTab "Tabua.wrl"

    eventIn MFNode set_node

    field SFBool inic TRUE

    url "javascript:
    function initialize()
    {
        Browser.createVrmlFromURL(wrlTab, me, 'set_node');
    }

    function set_node (node, t)
    {
        node[0].translation[2]= -compri*CTRL;
        pt.addChildren = node;
        CTRL+=1;
        if(inic)
        {
            if(CTRL < quant)
            {
                Browser.createVrmlFromURL(wrlTab, me, 'set_node');
            }
            else
            {
                inic = false;
            }
        }
    }
    "
} 
```

以及正在做的事情的形象。
![在此处输入图像描述](../Images/40b27b6fdd3d6fa77aee9f619702ee1e.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T14:00:35.997

我建议使用 a`PROTO`而不是，`Browser.createVrmlFromURL`因为您要重新下载外部 .wrl 文件五次，而这只会下载一次。

* * *

Tabua.wrl：

```
#VRML V2.0 utf8

PROTO Tabua[
    exposedField    SFVec3f     translation     0 0 0
]{
    Transform {
        translation IS translation
        children Shape {
            appearance Appearance {
                texture ImageTexture{
                    url "Imagens/madeira1.jpg"
                }
            }
            geometry Box {
                size 2 0.05 0.5
            }
        }
    }
} 
```

* * *

主要场景：

```
#VRML V2.0 utf8

Viewpoint {
    position     1.888 1.912 4.417
    orientation  -0.652 0.735 0.185 0.679
    fieldOfView  0.716
}

DEF Ponte Group {}

Script {
    field       SFInt32     quant               5

    field       SFString    protoDefinition     "
        EXTERNPROTO Tabua [
            exposedField    SFVec3f     translation
        ] \"Tabua.wrl\"
    "

    field       SFNode      Ponte               USE Ponte

    directOutput TRUE
    url "javascript:

    function initialize(){
        var vrml = protoDefinition;
        for (var i = 0; i < quant; i++){
            var z = i * -0.5;
            vrml += 'Tabua{translation 0 0 ' + z + '}';
        }
        Ponte.addChildren = Browser.createVrmlFromString(vrml);
    }

    "
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T08:38:09.380

似乎它不是“读取”变量“compri”，所以我切换了这些值并完美地工作。

```
#VRML V2.0 utf8
Transform
{
    rotation 0 1 0 3.14
    translation 0 0 0
    children
    [
        DEF Ponte Group
        {

        }
    ]
}

DEF pont Script
{
    field SFNode pt USE Ponte
    field SFNode me USE pont

    field SFInt32 CTRL 0
    field SFInt32 quant 5

    #field MFFloat compri 0.7

    field MFString wrlTab "Tabua.wrl"

    eventIn MFNode set_node

    field SFBool inic TRUE

    url "javascript:
    function initialize()
    {
        Browser.createVrmlFromURL(wrlTab, me, 'set_node');
    }

    function set_node (node, t)
    {
        node[0].translation[2]= -0.5*CTRL;
        pt.addChildren = node;
        CTRL += 1;
        if(inic)
        {
            if(CTRL < quant)
            {
                Browser.createVrmlFromURL(wrlTab, me, 'set_node');
            }
            else
            {
                inic = false;
            }
        }
    }
    "
} 
```

我一开始想要的结果。 ![在此处输入图像描述](../Images/0c3364e2f8853cd8bb6b3bef1c929fa6.png)

# python - Python十进制到字符串

> ID：11093021
> 
> 赞同：48
> 
> 时间：2012-06-19T00:50:06.780
> 
> 标签：python, string, decimal

这里有很多主题解释了如何将字符串转换为小数，但是如何将小数转换回字符串？

就像我这样做：

```
import decimal
dec = decimal.Decimal('10.0') 
```

我将如何取出`dec`（`'10.0'`字符串）？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-06-19T00:51:32.700

使用[内置](http://docs.python.org/library/functions.html#str)[的`str()`](http://docs.python.org/library/functions.html#str)，它：

> 返回一个字符串，其中包含一个对象的可很好打印的表示形式。

例如：

```
>>> import decimal
>>> dec = decimal.Decimal('10.0')
>>> str(dec)
'10.0' 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2014-11-21T03:41:55.487

使用字符串格式化函数：

```
>>> from decimal import Decimal
>>> d = Decimal("0.0000000000000123123")
>>> s = '{0:f}'.format(d)
>>> print(s)
0.0000000000000123123 
```

如果您只是将数字转换为字符串，则它不适用于指数：

```
>>> str(d)
'1.23123E-14' 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-10-24T22:02:37.363

请注意，使用`%f`字符串格式似乎要么首先转换为浮点数（或仅输出有限的小数位数），因此会降低精度。您应该使用`%s`或`str()`显示存储在十进制中的完整值。

鉴于：

```
from decimal import Decimal
foo = Decimal("23380.06198573179271708683473")
print("{0:f}".format(foo))
print("%s" % foo)
print("%f" % foo) 
```

输出：

```
23380.06198573179271708683473
23380.06198573179271708683473
23380.061986 
```

（编辑：更新以反映@Mark 的评论。）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-19T00:51:45.860

```
import decimal
dec = decimal.Decimal('10.0')
string_dec = str(dec) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-06-19T01:44:48.583

正如您所期望的，几乎所有内置函数都适用于 Decimal 类：

```
>>> import decimal
>>> dec=decimal.Decimal('10.0') 
```

一个字符串：

```
>>> str(dec)
'10.0' 
```

一个浮子：

```
>>> float(dec)
10.0 
```

一个整数：

```
>>> int(dec)
10 
```

对象表示（就像在交互式解释器中一样）：

```
>>> repr(dec)
"Decimal('10.0')" 
```

有理数：

```
>>> import fractions
>>> fractions.Fraction(decimal.Decimal('0.50'))
Fraction(1, 2) 
```

# ruby-on-rails - 如何将数据从控制器发送到 Ruby on Rails 中的视图

> ID：11093022
> 
> 赞同：1
> 
> 时间：2012-06-19T00:50:13.390
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有一个简单的控制器，它是通过脚手架创建的，并具有“显示”功能。

在通过脚手架创建的视图中，我有一个仅在特定条件下出现的图像。

我想在控制器中设置或评估条件并将其发送到视图。我不确定如何做到这一点，或者这是否是正确的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T04:04:48.607

条件一般应在视图文件中使用 erb 或 haml 处理。如果您使用条件更新您的问题，那么我会看到更新我的答案以反映它。现在，我将使用一个常见的条件。

假设您只想在某个对象出现时显示图像。让我们想象一下，您的对象中有一个特色字段充当标志 (1,0)。

如果这个对象是一篇文章，我们可以检查视图文件中的条件。控制器将从模型中获取文章：

```
-# articles_controller show action 
@article = Article.find(params[:id]) 
```

..

```
-# views/articles/show.html.erb
<% if @article.featured? %>
  // show image here
<% end %> 
```

请记住，这是一个不一定正确的示例条件。这只是为了说明我最初的方法。

我不建议您根据这种情况使用 javascript 来隐藏/显示，因为您随后将逻辑放入 javascript 中，而它可以从您的视图文件中轻松管理。

如果条件很复杂，您可以将其移动到模型中，并执行以下操作：

```
if @article.some_complex_condition? 
```

..而不是在你的控制器文件中有那个复杂的条件。这允许您在远离特定控制器的情况下重用条件并使其更具可测试性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T01:02:56.310

If you just want to show and hide an image based on a certain condition, than you can do that with **JQuery**. You shouldn't put anything in the controller that is view-centric.

You can also get the id of whatever data element is in 'show' and pass it to the JavaScript.

JQuery has `show()` and `hide()` methods that would work for you. Here's the documentation on the hide method: [http://api.jquery.com/hide/](http://api.jquery.com/hide/)

Basically, if you had a certain id for your image, you'd do something like this:

```
$(document).ready(function() {
  $("#myImage").hide();

  if (some_condition === true) {
    $("#myImage").show();
  }
}); 
```

You can put that code in your `application.js` file.

I whipped up a simple JsFiddle demonstrating a way to show and hide with buttons: [http://jsfiddle.net/phillipkregg/92RDS/](http://jsfiddle.net/phillipkregg/92RDS/)

Of course, the code may be different depending on what you are trying to do.

If you need to get the 'id' of the object in the 'show' view, than you can put a script tag at the bottom of your show view like this:

```
<script type="text/javascript">
  var my_show_object = <%= @some_object.id %>  //this will be the specific id of whatever the object is that you passed from the controller
  alert(my_show_object);  //this helps with debugging to see if you have the right id
</script> 
```

If you need more than the id, and you want to get the entire Rails object and represent it as Javascript - just do this at the bottom of your rails 'show' view:

```
 <script type="text/javascript">               
    var my_object = <%= @your_rails_object.to_json %>;     
    console.log(my_object); //This code allows you to look in the console and see exactly what your object looks like.
 </script> 
```

Just like the last one, `@your_rails_object` is the variable that you have in your show view in the controller. This will return it as a json object so that you can get the id or whatever properties it has.

Also, if you are just learning Rails, I would recommend this online book: [http://ruby.railstutorial.org/ruby-on-rails-tutorial-book](http://ruby.railstutorial.org/ruby-on-rails-tutorial-book)

That's how I learned Rails - the book is **excellent** and **free**.

# ruby - 在 ruby 中读取文件时是否可以指定换行符类型

> ID：11093029
> 
> 赞同：2
> 
> 时间：2012-06-19T00:50:53.357
> 
> 标签：ruby, character-encoding

我经常处理在具有 \r\n 回车符的 Windows 上编码的 UTF-16LE 文件。使用以下方法将文件转换为 UTF-8 没有问题：

```
File.new(filepath, 'r:utf-16le:utf-8') 
```

但这当然不会摆脱 \r。我目前摆脱它们的方式是

```
str.gsub("\r", "") 
```

但是在读入文件时最好注意一下。 String#encode 有 :cr_newline、:crlf_newline 和 :universal_newline 选项，它们可以将所有换行符转换为所需的换行符。有没有办法在读取文件时应用这些或类似的选项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T05:49:06.537

方法 IO#gets 接受一个可选参数，允许您传递一个字符串来定义如何分隔行：

```
file = File.new(filepath, 'r:utf-16le:utf-8')
while (line = file.gets("\r\n"))
   ...
end 
```

# google-app-engine - AppEngine 和 JDO：获取无主关系中的对象

> ID：11093036
> 
> 赞同：0
> 
> 时间：2012-06-19T00:52:21.683
> 
> 标签：google-app-engine, jdo

使用 Sets 或 Lists of Keys 定义无主的一对多和多对多关系。假设我有一篇文章的对象，其中包含文章标签的一组键。那么我如何自己获取标签呢？与键匹配的对象？我如何迭代它们？当然，我可以遍历键并分别获取对象，但这是唯一的方法吗？我试图到处寻找答案，但没有成功。该文档详细描述了定义无主关系，但没有对它们进行查询......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T06:47:29.433

你的意思是你有谷歌最初所说的“无主关系”？（你有一个`Set<Key>`）。遗憾的是，恕我直言，这根本不是**关系**，因为不涉及相关对象。使用他们插件的 v2.x，您可以拥有一个[真正的无主关系](http://datanucleus.blogspot.co.uk/2011/11/gaej-and-datanucleus-v3-part-2.html)（示例中有 1-1，但您同样可以拥有`Set<B>`），一切看起来都应该如此。我强烈建议您使用它（密钥存储在父级中，因此只需调用一次即可获取相关对象的集合）。

# mysql - 根据用户ID拆分数据库

> ID：11093039
> 
> 赞同：1
> 
> 时间：2012-06-19T00:52:30.903
> 
> 标签：mysql, query-optimization

我有一个 500 万行的数据库，并且它不断增长，并且越来越难以使用它进行操作。

将表拆分为 10 个表（v0_table、v1_table...v9_table）是一个好主意，其中数字（v*）是用户 ID 的第一个数字？

在我的情况下，用户的 id 不是自动递增的，因此它会在这 10 个表中均匀地对数据进行排序。

问题是我从来没有做过类似的事情......

任何人都可以发现任何缺点吗？

编辑：

对于调整结构或查询的任何帮助，我将不胜感激。所以最慢的查询如下：

```
SELECT logos.user, 
       logos.date, 
       logos.level, 
       logos.title, 
       Count(guesses.id), 
       Sum(guesses.points) 
FROM   logos 
       LEFT JOIN guesses 
              ON guesses.user = '".$user['uid']."' 
                 AND guesses.done = '1' 
                 AND guesses.logo = logos.id 
WHERE  open = '1' 
GROUP  BY level 
```

哪里猜表：

```
+--------+------------+------+-----+-------------------+----------------+
| Field  | Type       | Null | Key | Default           | Extra          |
+--------+------------+------+-----+-------------------+----------------+
| id     | int(11)    | NO   | PRI | NULL              | auto_increment |
| logo   | int(11)    | NO   | MUL | NULL              |                |
| user   | int(11)    | NO   | MUL | NULL              |                |
| date   | timestamp  | NO   |     | CURRENT_TIMESTAMP |                |
| points | int(4)     | YES  | MUL | 100               |                |
| done   | tinyint(1) | NO   | MUL | 0                 |                |
+--------+------------+------+-----+-------------------+----------------+ 
```

LOGO表：

```
+-------+--------------+------+-----+-------------------+----------------+
| Field | Type         | Null | Key | Default           | Extra          |
+-------+--------------+------+-----+-------------------+----------------+
| id    | int(11)      | NO   | PRI | NULL              | auto_increment |
| name  | varchar(100) | NO   |     | NULL              |                |
| img   | varchar(222) | NO   | MUL | NULL              |                |
| level | int(3)       | NO   | MUL | NULL              |                |
| date  | timestamp    | NO   | MUL | CURRENT_TIMESTAMP |                |
| user  | int(11)      | NO   | MUL | NULL              |                |
| open  | tinyint(1)   | NO   | MUL | 0                 |                |
+-------+--------------+------+-----+-------------------+----------------+ 
```

解释：

```
+----+-------------+---------+------+----------------+------+---------+-------+------+----------------------------------------------+
| id | select_type | table   | type | possible_keys  | key  | key_len | ref   | rows | Extra                                        |
+----+-------------+---------+------+----------------+------+---------+-------+------+----------------------------------------------+
|  1 | SIMPLE      | logos   | ref  | open           | open | 1       | const |  521 | Using where; Using temporary; Using filesort |
|  1 | SIMPLE      | guesses | ref  | done,user,logo | user | 4       | const |   87 |                                              |
+----+-------------+---------+------+----------------+------+---------+-------+------+----------------------------------------------+ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T01:01:06.837

简短而甜蜜：不。这绝不是一个好主意。您的表是否正确索引？MySQL是否正确调整？您的查询效率高吗？您是否使用任何缓存？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T01:05:00.643

Instead of sharding your table, you may want to examine other tables in your database to see if they can be split off into other dbs. For example tables, that are never joined to are great candidates for this type of vertical partitioning.

This allows you to optimize hardware for smaller sets of data.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T11:19:10.847

Your problem isn't that you have too much data, it's that this data is not properly indexed. Try adding an index:

```
CREATE INDEX open_level ON logos(open, level) 
```

This should eliminate *Using temporary; Using filesort* on logos.

Basically, you need an index on this table for this query to cover two things: *open* - for `WHERE open = '1'` and *level* - for `GROUP BY level` in this order, as MySQL will first filter by *open*, then will group the results by *level* (implicitly sorting by it in process).

# pdf - 使用ghostscript处理（重新映射）PDF中丢失/有问题的（CID/CJK）字体？

> ID：11093051
> 
> 赞同：7
> 
> 时间：2012-06-19T00:55:14.500
> 
> 标签：pdf, fonts, ghostscript

简而言之，我正在处理一个有问题的 PDF，它：

*   `evince`由于缺少字体信息，无法在文档查看器中完全呈现；
*   但是 -`ghostscript`可以完全呈现​​相同的 PDF。

因此——不管用什么`ghostscript`来填补空白（*可能是备用字形，或访问字体的不同方法*）——我希望能够用来`ghostscript`生成（“蒸馏”）输出 PDF，其中几乎除了添加字体信息外，*什么*都不会改变，因此`evince`可以以相同的方式呈现相同的文档`ghostscript`。

因此，我的**问题**是——这有可能吗？如果是这样，命令行是什么来实现这样的目标？

非常感谢您的任何答案，
干杯！

* * *

## 细节：

我实际上使用的是较旧的 Ubuntu 10.04，我可能遇到了 - 不是错误 - 而是安装问题`evince`（缺少`poppler-data`软件包），如[错误 #386008 “由于“未知字体标签而无法显示某些字体”中所述。 ..”：错误：“poppler”包：Ubuntu](https://bugs.launchpad.net/ubuntu/+source/poppler/+bug/386008)。

但是，这正是我想要处理的，所以我将使用该`fontspec.pdf`帖子的附件（*“ [PDF 触发错误。](https://bugs.launchpad.net/ubuntu/+source/poppler/+bug/386008/+attachment/604541/+files/fontspec.pdf) ”，// v.*）来演示问题。

### `evince`

首先，我打开这个 pdf 的第 3 页`evince`；并`evince`抱怨：

```
$ evince --page-label=3 fontspec.pdf

Error: Missing language pack for 'Adobe-Japan1' mapping
Error: Unknown font tag 'F5.1'
Error (7597): No font in show
Error: Unknown font tag 'F5.1'
Error (7630): No font in show
Error: Unknown font tag 'F5.1'
Error (7660): No font in show
Error: Unknown font tag 'F5.1'
... 
```

渲染看起来像这样：

![evince-pdf-missfont-render.png](../Images/e92fb22d37244f1b032274ee579aa69c.png)

...很明显，缺少一些字体形状。

### 土坯`acroread`

只需说明 Adob​​e 的 Acrobat Reader for Linux 的行为方式；以下命令行：

```
$ ./Adobe/Reader9/bin/acroread /a "page=3" fontspec.pdf 
```

... 不会向终端生成任何输出（*有关`/a`开关的更多信息，请参阅[手册页 acroread](http://www.dsm.fordham.edu/cgi-bin/man-cgi.pl?topic=acroread&ampsect=1)*）——并且程序显示字体绝对没有问题。

[另外，虽然我想避免往返于 postscript - 但是，请注意它`acroread`本身可用于将 PDF 转换为 postscript：]

```
$ ./Adobe/Reader9/bin/acroread -v
9.5.1

$ ./Adobe/Reader9/bin/acroread -toPostScript \ 
-rotateAndCenter -choosePaperByPDFPageSize \
-start 3 -end 3 \
-level3 -transQuality 5 \
-optimizeForSpeed -saveVM \
fontspec.pdf ./ 
```

同样，上面的命令行不会向终端生成任何输出；`-optimizeForSpeed -saveVM`在那里，因为显然他们处理字体；最后一个参数`./`是输出目录（输出文件被自动调用`fontspec.ps`）。

现在，`evince` *可以*在输出中显示以前丢失的字体`fontspec.ps`- 但再次抱怨：

```
$ evince fontspec.ps 
GPL Ghostscript 9.02: Error: Font Renderer Plugin ( FreeType ) return code = -1
GPL Ghostscript 9.02: Error: Font Renderer Plugin ( FreeType ) return code = -1
... 
```

...此外，所有*文本*似乎都在后记中被展平为曲线 - 所以现在无法再选择 .ps 文件中的文本`evince`（请注意，.ps 文件无法在 中打开`acroread`）。但是，可以再次将此 .ps 转换回 .pdf：

```
$ pstopdf fontspec.ps   # note, `pstopdf` has no output filename option;
                        # it will automatically choose 'fontspec.pdf',
                        # and overwrite previous 'fontspec.pdf' in 
                        # the same directory 
```

...现在输出中的文本`pstopdf`可以在 中选择`evince`，所有字体都在那里，`evince`不再抱怨。但是，正如我所指出的，我想完全避免往返于 postscript 文件。

### `display`（来自`imagemagick`）

`imagemagick`我们还可以使用s观察同一文档中的页面`display`（*请注意，[使用 'display' 从命令行进行图像平移](http://studio.imagemagick.org/pipermail/magick-users/2007-October/020250.html)显然仍然不可用，因此我在`-crop`下面使用来调整视口*）：

```
$ display -density 150 -crop 740x450+280+200 fontspec.pdf[2]
   **** Warning: considering '0000000000 00000 n' as a free entry.
...
   **** This file had errors that were repaired or ignored.
   **** The file was produced by: 
   **** >>>> Mac OS X 10.5.4 Quartz PDFContext <<<<
   **** Please notify the author of the software that produced this
   **** file that it does not conform to Adobe's published PDF
   **** specification. 
```

...这会产生一些`ghostscrip`ish 错误 - 结果如下：

![imagemagick-显示-pdf.png](../Images/4c96ffba431e1cb14b121849bcc53bb3.png)

...很明显，`evince`无法渲​​染的缺失字体现在正确显示在此处，并带有`imagemagick`s `display`。

### `ghostscript`

最后，我们可以[使用 ghostscript 作为 x11 查看器](https://stackoverflow.com/a/11092409/277826)本身——观察相同的页面、相同的文档：

```
$ gs -sDevice=x11 -g740x450 -r150x150 -dFirstPage=3 \
-c '<</PageOffset [-120 520]>> setpagedevice' \
-f fontspec.pdf

GPL Ghostscript 9.02 (2011-03-30)
Copyright (C) 2010 Artifex Software, Inc.  All rights reserved.
This software comes with NO WARRANTY: see the file PUBLIC for details.
   **** Warning: considering '0000000000 00000 n' as a free entry.
   **** Warning: considering '0000000000 00000 n' as a free entry.
   **** Warning: considering '0000000000 00000 n' as a free entry.
   **** Warning: considering '0000000000 00000 n' as a free entry.
   **** Warning: considering '0000000000 00000 n' as a free entry.
   **** Warning: considering '0000000000 00000 n' as a free entry.
   **** Warning: considering '0000000000 00000 n' as a free entry.
Processing pages 3 through 74.
Page 3
>>showpage, press <return> to continue<<
^C 
```

...以及此输出的结果：

![ghostscript-pdf-view.png](../Images/180be56ebcf47da38045bef2bdd426c4.png)

总之：（`ghostscript`显然[*通过*]扩展，`imagemagick`）似乎可以找到丢失的字体（或至少对其进行一些替换），并使用该字体呈现页面 - 即使`evince`对于同一文档失败。

因此，我只想从 中导出 PDF 版本`ghostscript`，该版本仅嵌入缺少的字体，没有其他处理；所以我试试这个：

```
$ gs -dBATCH -dNOPAUSE -dSAFER  \
-dEmbedAllFonts -dSubsetFonts=true -dMaxSubsetPct=99 \
-dAutoFilterMonoImages=false \
-dAutoFilterGrayImages=false \
-dAutoFilterColorImages=false \
-dDownsampleColorImages=false \
-dDownsampleGrayImages=false \
-dDownsampleMonoImages=false \
-sDEVICE=pdfwrite \
-dFirstPage=3 -dLastPage=3 \
-sOutputFile=mypg3out.pdf -f fontspec.pdf

GPL Ghostscript 9.02 (2011-03-30)
Copyright (C) 2010 Artifex Software, Inc.  All rights reserved.
This software comes with NO WARRANTY: see the file PUBLIC for details.
   **** Warning: considering '0000000000 00000 n' as a free entry.
   **** Warning: considering '0000000000 00000 n' as a free entry.
   **** Warning: considering '0000000000 00000 n' as a free entry.
   **** Warning: considering '0000000000 00000 n' as a free entry.
   **** Warning: considering '0000000000 00000 n' as a free entry.
   **** Warning: considering '0000000000 00000 n' as a free entry.
   **** Warning: considering '0000000000 00000 n' as a free entry.
Processing pages 3 through 3.
Page 3

   **** This file had errors that were repaired or ignored.
   **** The file was produced by:
   **** >>>> Mac OS X 10.5.4 Quartz PDFContext <<<<
   **** Please notify the author of the software that produced this
   **** file that it does not conform to Adobe's published PDF
   **** specification. 
```

...但它不起作用 - 输出文件遇到与前面提到 `mypg3out.pdf`的完全相同的问题。`evince`

[*注意：虽然我想避免 postscript 往返，但`gs`这里有一个从 pdf 到 ps 的带有字体嵌入的命令行的好例子：[(#277826) pdf - 如何使 GhostScript PS2PDF 停止子集字体](https://stackoverflow.com/a/2982322/277826)；但是 .pdf 到 .pdf 的相同命令行切换似乎对上述问题没有任何影响。*]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T07:52:48.733

是的，我对此有更深入的了解（但不完全） - 所以我会在这里发布部分答案/评论。

本质上，这不是 PDF 中字体嵌入的问题——这是字体*映射*的问题。

为了证明这一点，让我们分析OP`mypg3out.pdf`中提取的`gs`（来自`fontspec.pdf`文档的第 3 页）：

```
$ pdffonts mypg3out.pdf 
name                                 type              emb sub uni object ID
------------------------------------ ----------------- --- --- --- ---------
Error: Missing language pack for 'Adobe-Japan1' mapping
CAAAAA+Osaka-Mono-Identity-H         CID TrueType      yes yes yes     19  0
GBWBYF+CMMI9                         Type 1C           yes yes yes     28  0
FDFZUN+Skia-Regular_wght13333_wdth11999 TrueType          yes yes yes     16  0
ZRLTKK+Optima-Regular                TrueType          yes yes yes     30  0
ZFQZLD+FPLNeu-Bold                   Type 1C           yes yes yes      8  0
DDRFOG+FPLNeu-Italic                 Type 1C           yes yes no      22  0
HMZJAO+FPLNeu-Regular                Type 1C           yes yes yes     10  0
RDNKXT+FPLNeu-Regular                Type 1C           yes yes yes     32  0
GBWBYF+Skia-Regular_wght13333_wdth11999 TrueType          yes yes no      26  0 
```

如输出所示 - 所有字体确实是*嵌入**的*；所以还有别的问题。（*要完整地观察这一点会更加困难`fontspec.pdf`，因为那里有大量的字体和大量的错误消息。*）

这里的关键点（我认为）是：

*   只有一个“ `Error: Missing language pack for 'Adobe-Japan1' mapping`”消息；和
*   只有一种`CID TrueType`字体，即`CAAAAA+Osaka-Mono-Identity-H`

`CID TrueType`和“Adobe-Japan1”映射错误之间似乎有明显的关系；我终于通过[CID 字体澄清了这一点 - 如何使用 Ghostscript](http://www.ghostscript.com/doc/9.02/Use.htm#CIDFonts)：

> CID 字体是包含大量字形的 PostScript 资源（例如，远东语言的字形、中文、日文和韩文）。有关详细信息，请参阅 PostScript 语言参考，第三版。
> 
> CID 字体资源是一种不同于字体的 PostScript 资源。特别是，它们不能用作常规字体。CID 字体资源必须先与定义字形的特定代码的 CMap 资源组合，然后才能用作字体。这允许重复使用具有不同编码的字形集合。

一切都好——除了这里我们处理的是 PDF 字体，而不是 PostScript 字体；让我们稍微演示一下。

例如，[5.3。Using Ghostscript To Preview Fonts - Making Fonts Available to Ghostscript - Font HowTo](http://linux.about.com/library/howto/font/blfont5.htm)描述了如何使用 Ghostscript 安装的脚本`prfont.ps`来渲染字体表。

但是，在这里只需[列出 Ghostscript 字体 [gs-devel]](http://ghostscript.com/pipermail/gs-devel/2002-June/005549.html)并使用[resourcestatus 运算符](http://ghostscript.com/pipermail/gs-bugs/2010-January/011332.html)查询特定字体会更容易——这不需要特殊的 .ps 脚本：

```
$ gs -o /dev/null -dNODISPLAY -f mypg3out.pdf \
-c 'currentpagedevice (*) {=} 100 string /Font resourceforall'
...
Processing pages 1 through 1.
Page 1
URWAntiquaT-RegularCondensed
Palatino-Italic
Hershey-Gothic-Italian
...

$ gs -o /dev/null -dNODISPLAY -f mypg3out.pdf \
-c '/TimesNewRoman findfont pop [/TimesNewRoman /Font resourcestatus]'
....
Processing pages 1 through 1.
Page 1
Can't find (or can't open) font file /usr/share/ghostscript/9.02/Resource/Font/TimesNewRomanPSMT.
Can't find (or can't open) font file TimesNewRomanPSMT.
Can't find (or can't open) font file /usr/share/ghostscript/9.02/Resource/Font/TimesNewRomanPSMT.
Can't find (or can't open) font file TimesNewRomanPSMT.
Querying operating system for font files...
Loading TimesNewRomanPSMT font from /usr/share/fonts/truetype/msttcorefonts/times.ttf... 2549340 1142090 3496416 1237949 1 done. 
```

我们得到了一个字体列表；但是，这些是可用的系统字体`ghostscript`-*不是*嵌入在 PDF 中的字体！

（[基本上，]

*   `gs -o /dev/null -dNODISPLAY -f mypg3out.pdf -c 'currentpagedevice (*) {=} 100 string /Font resourceforall' | grep -i osaka`不会返回任何内容，并且
*   `-c '/CAAAAA+Osaka-Mono-Identity-H findfont pop [/CAAAAA+Osaka-Mono-Identity-H /Font resourcestatus]'`将以“*在系统上未找到此字体！将字体 Courier 替换为 CAAAAA+Osaka-Mono-Identity-H。* ”结束。）

要列出 PDF 中的字体，可以使用Ghostscript 中的[pdf_info.ps 脚本文件](https://stackoverflow.com/a/3132653/277826)（*未安装，在源代码中）：*

```
$ wget "http://git.ghostscript.com/?p=ghostpdl.git;a=blob_plain;f=gs/toolbin/pdf_info.ps" -O pdf_info.ps

$ gs -dNODISPLAY -q -sFile=mypg3out.pdf -dDumpFontsNeeded pdf_info.ps
...
No system fonts are needed.

$ gs -dNODISPLAY -q -sFile=mypg3out.pdf -dDumpFontsUsed -dShowEmbeddedFonts pdf_info.ps
...
Font or CIDFont resources used:
CAAAAA+Osaka-Mono
DDRFOG+FPLNeu-Italic
FDFZUN+Skia-Regular_wght13333_wdth11999
GBWBYF+CMMI9
GBWBYF+Skia-Regular_wght13333_wdth11999
GTIIKZ+Osaka-Mono
HMZJAO+FPLNeu-Regular
RDNKXT+FPLNeu-Regular
ZFQZLD+FPLNeu-Bold
ZRLTKK+Optima-Regular 
```

所以最后我们可以`CAAAAA+Osaka-Mono`在 Ghostscript 中观察 - 虽然我不知道如何从内部查询有关它的更具体信息`ghostscript`。

最后，我想我的**问题**归结为：如何`ghostscript`使用，将字形从 CID 嵌入字体映射到具有不同“编码”（或“字符映射”？）的字体，这不需要额外的语言文件？

### 附录

[我也尝试过这些方法：]

*   `pdffonts`此处的输出不会列出大阪单声道，但仍会抱怨“错误：缺少'Adobe-Japan1'映射的语言包”：

    ```
    $ wget http://whalepdfviewer.googlecode.com/svn/trunk/cmaps/japanese/Adobe-Japan1-UCS2 
    $ gs -sDEVICE=pdfwrite -o mypg3o2.pdf -dBATCH -f mypg3out.pdf Adob​​e-Japan1-UCS2
    ```

*   与以前相同 - 这（*通过 Ghostscript 的“Use.htm”*）也使大阪单声道从`pdffonts`列表中消失：

    ```
    gs -sDEVICE=pdfwrite -o mypg3o2.pdf -dBATCH \
    -c '/CIDSystemInfo << /Registry (Adobe) /Ordering (Unicode) /Supplement 1 >>' \
    -f mypg3out.pdf
    ```

*   这崩溃了`Error: /undefinedresource in findresource`：

    ```
    gs -sDEVICE=pdfwrite -o mypg3o2.pdf -dBATCH \
    -c '/Osaka-Mono-Identity-H /H /CMap findresource [/Osaka-Mono-Identity /CIDFont findresource] == ' \
    -f mypg3out.pdf
    ```

最后请注意，某些 .ps 脚本`ghostscript`会安装，它可能会自动使用；例如，您可以找到`gs_ttf.ps`：

```
$ locate gs_ttf.ps
/usr/share/ghostscript/9.02/Resource/Init/gs_ttf.ps 
```

...然后使用，您可以在代码开头添加语句；然后每当调用上述命令之一时，打印输出将在标准输出中可见。`sudo nano `locate gs_ttf.ps```(Hello from gs_ttf.ps\n) print``gs`

### 参考

*   [添加您自己的字体 - Ghostscript 提供的字体和字体工具](http://www.ghostscript.com/doc/9.02/Fonts.htm#Add_fonts)
*   [关于 Ghostscript 的“CIDFnmap” - Ghostscript 中支持 CJK CID-keyed 的功能](http://pages.cs.wisc.edu/~ghost/doc/gnu/7.05/CJK.htm#About_CIDFnmap)
*   [错误 689538 – GhostScript 无法处理嵌入式 TrueType CID 字体](http://bugs.ghostscript.com/show_bug.cgi?id=689538)
*   [错误 692589 - 将合并文件转换为 PDF/A 时出现“错误 CIDSystemInfo 和 CMap dict 不兼容” - #1522](http://bugs.ghostscript.com/show_bug.cgi?id=692589)
*   [Adobe 论坛：CMap 资源与 PDF 映射资源](http://forums.adobe.com/thread/498388)：

    > 请记住，CMap 资源将字符代码单向映射到 CID。Acrobat 使用的其他资源最好称为 PDF 映射资源。其中，有一个特殊的类别叫做 ToUnicode 映射资源，将 CID 单向映射到 UTF-16BE 字符码

*   [CJK TrueType 字体中的 Adob​​e CID 和字形](http://pages.cs.wisc.edu/~ghost/doc/gnu/6.53/CJKTTCID.htm)
*   [Ghostscript 和日文 TrueType 字体](http://www.sat.t.u-tokyo.ac.jp/~hideyuki/Ghostscript/truetype.html)
*   [安装指南：GS 和 CID 字体](http://www.enel.ucalgary.ca/People/far/howto/gs-cid.html)
*   [Debian -- 软件包 poppler-data/sid/all 的文件列表](http://packages.debian.org/sid/all/poppler-data/filelist)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T08:08:10.170

确定点1；您*不能*使用 Ghostscript 和 pdfwrite 来创建 PDF 文件“无需任何额外处理”。

pdfwrite 和 Ghostscript 的工作方式是完全解释传入的数据（PostScript、PDF、XPS、PCL 等），创建一系列图形基元，然后将其传递给 pdfwrite 设备。pdfwrite 设备然后将这些重新组合成一个全新的 PDF 文件。

因此，不可能将 PDF 文件作为输入并对其进行操作，它总是会创建一个新文件。

现在，我建议您先将 9.02 Ghostscript 升级到 9.05。丢失的 CIDFonts 在 9.05 中得到了更好的处理（今年晚些时候将在 9.06 中进一步改进）。（您缺少的“Osaka Mono”字体实际上是 CIDFont，而不是常规字体）

使用当前最前沿的 Ghostscript 代码为我生成了一个 PDF 文件，其中嵌入了缺失的字体。我不知道这是否对您有用，因为我的 evince 副本可以完美地呈现原始文件。

稍后添加

检查原始 PDF 文件，我发现确实嵌入了字体（正如我所料，因为它们是子集）。所以实际上正如您在上面自己的答案中所说，问题不在于字体嵌入，而在于 CIDFonts 的使用。

我在这里的回答对你没有帮助，因为 pdfwrite 仍然会在输出中产生一个 CIDFont 。基本上，这是您的版本或 evince 安装中的缺陷。

“重新映射”字符的问题在于字体限制为 256 个字形，而 CIDFont 实际上没有限制。所以没有办法将 CIDFont 放入 Font 中。这样做的唯一方法是创建多个字体，每个字体都包含原始字体的一部分，然后根据需要在它们之间切换。缓慢而笨拙。

如果您使用 ps2write 设备转换为 PostScript，那么它将为您执行此操作，但您面临很大的风险，即在此过程中它将矢量字形数据转换为位图，这将无法很好地缩放。

从根本上说，您无法使用 Ghostscript 或实际上使用我知道的任何其他工具来真正实现您想要做的事情（将 1 CIDFont 转换为 N 个常规字体）。虽然它在技术上是可行的，但没有真正意义，因为所有 PDF 消费者都应该能够处理 CIDFonts。如果他们不能，那么它是 PDF 消费者中的一个错误。

# jquery - JQuery ColorBox 插件 - 调整显示的 iframe 窗口的大小

> ID：11093055
> 
> 赞同：2
> 
> 时间：2012-06-19T00:56:34.037
> 
> 标签：jquery, lightbox, colorbox

我正在尝试使用 colorbox 插件来显示另一个网站的灯箱窗口，并且当我实现它时，它在较大（清晰）灯箱区域窗口中具有固定（小）显示区域的宽度/高度。我对参数所做的任何事情都不会影响包含我的显示页面的窗口的显示大小。

该窗口很好地显示了网站，并且每次为灯箱保留的整个区域似乎都是正确的' 显示其下方的背景内容 100% 清晰）。

这是我的代码，希望有人能告诉我我缺少什么来完成这项工作。

```
 $(document).ready(function()
  {
    $('.colorbox').colorbox({iframe:true, width:"75%", height:"75%"});
  }); 
```

我在 chrome 中得到的错误是“ReferenceError：m_injectionNode 未定义”重复了 7 次，如果这完全有用的话。

# c# - 使用 Silverlight 应用程序映射？

> ID：11093056
> 
> 赞同：0
> 
> 时间：2012-06-19T00:56:38.293
> 
> 标签：c#, visual-studio-2010, linq, silverlight-4.0, mapping

我有 Silverlight 应用程序。开始使用 Linq 我发现我必须在整个解决方案中的一个新项目中进行映射。要使用新项目中生成的类，我使用“添加引用”。对于 Silverlight 应用程序，可以只添加对同一种项目的引用。

在这里我遇到了问题，因为在 Silverlight 应用程序中，无法右键单击项目 Add -> New Item -> LINQ to SQL Classes。

在这种情况下，使用来自不同项目的类的整个想法可能是愚蠢的......请帮助=）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T01:13:28.770

Silverlight 代码在客户端执行。LINQ to SQL 将在服务器端执行。您需要一种方法来让您的 LINQ to SQL 对象通过网络连接到您的 Silverlight 客户端。最简单的方法是使用 WCF RIA 服务[http://www.silverlight.net/learn/advanced-techniques/wcf-ria-services/using-wcf-ria-services](http://www.silverlight.net/learn/advanced-techniques/wcf-ria-services/using-wcf-ria-services)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T01:12:53.590

首先，您将无法在 silverlight 中使用 Linq-to-SQL，因为 silverlight 永远无法直接连接到 SQLServer。将 Linq-to-SQL 与 Silverlight 结合使用的唯一方法是在使用 L2S 的 Web 服务器（WCF 或其他）上创建一个服务。Silverlight 然后将与该服务通信，该服务又将与 SQLServer 通信。

在 Silverlight 和非 Silverlight 项目之间共享代码的一种简单方法是共享文件，而不是二进制引用（这是您想要做的）。从原始项目中选择 Project->Add Existing Files...。这样，原始项目将以它的格式编译，Silverlight 会将相同的代码编译成它的格式。

如果您想从 Silverlight 应用程序进行数据访问，您可能想查看 WCF RIA 服务，它大大简化了流程，并为您生成了我上面提到的服务。

# ruby-on-rails - 找不到没有 ID 的帖子

> ID：11093057
> 
> 赞同：0
> 
> 时间：2012-06-19T00:56:39.590
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, tags

我正在尝试将我的帖子标记为某个标签以进行渲染。我在视图中的代码是

视图/帖子/sports.html.erb

```
 <% my_posts = post.find_by_tag("sports") %>
 <%= my_posts.each do |post| %>
    <%= post.title %><br />
    <%= post.body %><br />
 <% end %> 
```

我的控制器看起来像

```
 def sports
     @posts = Post.paginate(:page => params[:page], :per_page => 10)
     @post = Post.find(params[:id])
     @title = "Newest"

     respond_to do |format|
       format.html
       format.json { render :json => @users }
     end
 end 
```

我知道我必须定义 @post 变量，但我不确定将其定义为什么。

更新

我遇到的问题是“找不到没有 ID 的帖子”错误

第二次更新

```
 def find_by_tag name 
     Tag.find_by_name(name).posts 
   end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T01:23:31.780

你不说出了什么问题，你只说你想做什么。

一些有助于调试你所看到的东西的东西：

```
<%= debug(params) if Rails.env.development? %> 
```

在您的主布局中，这将转储 params 哈希并可能提供线索。

还，

```
rake routes 
```

确保您正在寻找正确的参数键。

在您提供的代码段中，`my_posts.each ...`行前有一个等号，我不是 ERB 专家，但我认为您不希望这样，而是这样：

```
<% my_posts = post.find_by_tag("sports") %>
<% my_posts.each do |post| %>
  <%= post.title %><br />
  <%= post.body %><br />
<% end %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T01:58:04.660

根据此处显示的内容，部分问题是您在控制器中使用 Post 对象定义实例变量，然后没有将它们用于视图中的任何内容。要检索所有标记为“体育”的帖子的集合，您需要在控制器中执行以下操作：

```
@sports_posts = Post.find_by_tag("sports") 
```

在视图中：

```
<% @sports_posts.each do |post|
  etc... 
```

要添加分页，您可以将该方法链接到原始方法：

```
@sports_posts = Post.find_by_tag("sports").paginate(:page => params[:page],
                                                    :per_page => 10) 
```

这与您的代码段不同，您在代码段中定义了一个返回 10 个对象`@posts`的集合的变量，它只是根据提交表单参数传递的 id 找到一个 post 对象。我的猜测是，此控制器操作不是由表单提交创建的，因此没有传递任何参数，因此为 nil，因此您会看到错误消息。无论如何，除非您在视图中需要这些项目中的任何一个（并且这里没有任何内容表明它们被用于任何事情），否则没有理由创建它们。`Post``@post``params[:id]`

您需要的是一组标记为“运动”的帖子，这就是上面的调用所完成的。看起来您正在尝试`post.find_by_tag("sports")`在视图中执行此操作。问题是您正在调用*不存在*的`find_by_tag`方法 on 。存在 - 那是 Post 类，可能是你要调用的。只是更改为可能会让您到达您想要的位置，但是如果您在控制器中创建对象然后使用视图简单地呈现它们的属性数据（根据上面的示例），则内容检索和呈现会更好地分开。`post`*`Post``post``Post`*

# asp.net-mvc-3 - 关于 MVC ViewModel 和局部视图

> ID：11093059
> 
> 赞同：0
> 
> 时间：2012-06-19T00:57:18.233
> 
> 标签：asp.net-mvc-3, viewmodel, partial-views

> **可能重复：**
> [如何在单个 Razor 视图中编辑多个模型](https://stackoverflow.com/questions/10720756/how-to-edit-multiple-models-in-a-single-razor-view)

我正在使用 MVC3 来制作订单功能。我有 Order 和 OrderDetail 模型。Order 和 OrderDetail 是一对多的关系。这两个模型看起来像这样：

```
public class order
{
    public int OrderId{get;set;}
    public int OrderStatusID { get; set; } 

    public virtual OrderStatus OrderStatus { get; set; }
    public virtual ICollection<OrderDetail> OrderDetails { get; set; }

}

 public  class OrderDetail
 {
    public int OrderDetailID { get; set; }
    public int OrderID { get; set; }
    public int Quantity { get; set; }
    public string Description { get; set; } 
    public int CategoryID { get; set; }   
    public virtual Order Order { get; set; }
    public virtual Category Category { get; set; }

} 
```

我想在一个视图中同时使用它们，所以我在下面为它制作了 OrderViewModel，

```
public class OrderViewModel
{
    public virtual Order Order { get;set; }
    public virtual List<OrderDetail> OrderDetails { get;set; }
} 
```

我有两个问题：

1、如何使用OrderViewModel制作订单创建和编辑页面？我为 OrderDetail 制作了部分视图。在创建页面中，我做了类似以下的操作，但我认为它不正确。

```
@foreach (var detail in Model.OrderDetails)
{
    @Html.Partial("_OrderDetail", detail)  
} 
```

2、Order和OrderDetail是一对多的关系，在创建Order页面时，我希望用户能够添加多个OrderDetail。我使用 jQuery 制作了一个可以创建多个 OrderDetail 字段的按钮，但我不知道如何从每个 OrderDetail 中检索值。

这是怎么做到的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T01:07:43.940

用于`EditorFor`详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T04:45:25.497

请查看以下链接并查看**Darin Dimitrov的回答**

[如何在列表的强类型视图上使用 LabelFor](https://stackoverflow.com/questions/6703353/how-to-use-labelfor-on-a-strongly-typed-view-for-a-list/6703629#comment14358804_6703629)

[LabelFor 不能循环工作（for/foreach/template）](https://stackoverflow.com/questions/9359089/labelfor-not-working-in-loop-for-foreach-template/9360884#comment14358792_9360884)

如果您仍有任何疑问，请告诉我。

# ios - 在 iOS 中使用 glsl 将 yv12 转换为 rgb，附上结果图像

> ID：11093061
> 
> 赞同：2
> 
> 时间：2012-06-19T00:57:25.103
> 
> 标签：ios, glsl, shader, rgb, yuv

[提到这个问题](https://stackoverflow.com/questions/9075074/about-converting-yuvyv12-to-rgb-with-glsl-for-ios)

我使用 glsl 着色器将 yv12 帧数据转换为 rgb 数据，原始图像如下： ![在此处输入图像描述](../Images/f82b3a3e9319bc1e834ed27a227c7623.png)

但结果图像与前者不一样，附在下面： ![在此处输入图像描述](../Images/7565b0aec193e45af4b40a0bef42c35f.png)

以下是我将三个平面数据上传到纹理的代码：

```
- (GLuint) textureY: (Byte*)imageData        
      widthType: (int) width       
     heightType: (int) height       
{          
    GLuint texName;    
    glGenTextures( 1, &texName );     
    glBindTexture(GL_TEXTURE_2D, texName);

    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR );    
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR );    
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);    
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);    

    glTexImage2D( GL_TEXTURE_2D, 0, GL_LUMINANCE, width, height, 0, GL_LUMINANCE, GL_UNSIGNED_BYTE, imageData );  
    //free(imageData);

    return texName;    
}    

- (GLuint) textureU: (Byte*)imageData        
          widthType: (int) width       
         heightType: (int) height       
{          
    GLuint texName;    

    glGenTextures( 1, &texName );     
    glBindTexture(GL_TEXTURE_2D, texName);

    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR );    
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR );    
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);    
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);    

    glTexImage2D( GL_TEXTURE_2D, 0, GL_LUMINANCE, width, height, 0, GL_LUMINANCE, GL_UNSIGNED_BYTE, imageData );    

    //free(imageData);
    return texName;    
}    

- (GLuint) textureV: (Byte*)imageData        
          widthType: (int) width       
         heightType: (int) height       
{          
    GLuint texName;    
    glGenTextures( 1, &texName );     
    glBindTexture(GL_TEXTURE_2D, texName);

    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR );    
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR );    
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);    
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);    

    glTexImage2D( GL_TEXTURE_2D, 0, GL_LUMINANCE, width, height, 0, GL_LUMINANCE, GL_UNSIGNED_BYTE, imageData );    

    //free(imageData);
    return texName;    
}    

- (void) readYUVFile     
{    
    NSString *file = [[NSBundle mainBundle] pathForResource:@"video" ofType:@"yv12"];
    NSLog(@"%@",file);
    NSData* fileData = [NSData dataWithContentsOfFile:file]; 
    //NSLog(@"%@",[fileData description]);
    NSInteger width  = 352;    
    NSInteger height = 288;
    NSInteger uv_width  = width  / 2;    
    NSInteger uv_height = height / 2;
    NSInteger dataSize = [fileData length];
    NSLog(@"%i\n",dataSize);

    GLint nYsize  = width * height;     
    GLint nUVsize = uv_width * uv_height;      
    GLint nCbOffSet = nYsize;    
    GLint nCrOffSet = nCbOffSet + nUVsize;    

    Byte *spriteData = (Byte *)malloc(dataSize);
    [fileData getBytes:spriteData length:dataSize];

    Byte* uData = spriteData + nCbOffSet;
    //NSLog(@"%@\n",[[NSData dataWithBytes:uData length:nUVsize] description]);
    Byte* vData = spriteData + nCrOffSet;  
    //NSLog(@"%@\n",[[NSData dataWithBytes:vData length:nUVsize] description]);
    /**
    Byte *YPlanarData = (Byte *)malloc(nYsize);
    for (int i=0; i<nYsize; i++) {
        YPlanarData[i]= spriteData[i];
    }    

    Byte *UPlanarData = (Byte *)malloc(nYsize);
    for (int i=0; i<height; i++) {
        for (int j=0; j<width; j++) {
            int numInUVsize = (i/2)*uv_width+j/2;
            UPlanarData[i*width+j]=uData[numInUVsize];
        }
    }

    Byte *VPlanarData = (Byte *)malloc(nYsize);
    for (int i=0; i<height; i++) {
        for (int j=0; j<width; j++) {
            int numInUVsize = (i/2)*uv_width+j/2;
            VPlanarData[i*width+j]=vData[numInUVsize];
        }
    }
    **/

    _YPlanarTexture = [self textureY:spriteData widthType:width heightType:height];    
    _UPlanarTexture = [self textureU:uData widthType:uv_width  heightType:uv_height];    
    _VPlanarTexture = [self textureV:vData widthType:uv_width heightType:uv_height];       

    free(spriteData);

} 
```

和我的片段着色器代码：

```
 precision highp float;
uniform sampler2D SamplerY;
uniform sampler2D SamplerU;
uniform sampler2D SamplerV;

varying highp vec2 coordinate;

void main()
{
    highp vec3 yuv,yuv1;
    highp vec3 rgb;

    yuv.x = texture2D(SamplerY, coordinate).r;

    yuv.y = texture2D(SamplerU, coordinate).r-0.5;

    yuv.z = texture2D(SamplerV, coordinate).r-0.5 ;

   rgb = mat3(      1,       1,      1,
                     0, -.34414, 1.772,
               1.402, -.71414,      0) * yuv;

    gl_FragColor = vec4(rgb, 1);
} 
```

我的困惑是转换公式，而我使用这个公式直接将 yv12 数据转换为 rgb24，并用

```
CGImageCreate(iwidth, 
                                       iheight, 
                                       8, 
                                       24, 
                                       iwidth*3, 
                                       colorSpace, 
                                       bitmapInfo, 
                                       provider, 
                                       NULL, 
                                       NO, 
                                       kCGRenderingIntentDefault); 
```

结果图像是正确的。但是使用着色器（在iOS设备上运行的直接变换方法是转储）转向这个问题，我尝试了一些技巧（将UV刨床扩展到（2 * uv_width）* 2（uv_height）矩形，然后上传纹理)，但在同一张更红的图像中失败了。

如何解决这个问题？

附上我的整个 glView.m 代码：

```
#import "OpenGLView.h"

typedef struct {
    float Position[3];
    float TexCoord[2];
} Vertex;

const Vertex Vertices[] = {
    {{1, -1, 0},{1,1}},
    {{1, 1, 0},{1,0}},
    {{-1, 1, 0},{0,0}},
    {{-1, -1, 0},{0,1}}
};

const GLubyte Indices[] = {
    0, 1, 2,
    2, 3, 0
};

@interface OpenGLView ()
- (void)setupLayer;
- (void)setupContext;
- (void)setupRenderBuffer;
- (void)setupFrameBuffer;
- (void)render;

- (GLuint)compileShader:(NSString*)shaderName withType:(GLenum)shaderType;
- (void)setupVBOs;
- (void)compileShaders;

- (void) readYUVFile;
@end

@implementation OpenGLView

- (void)setupVBOs {

    GLuint vertexBuffer;
    glGenBuffers(1, &vertexBuffer);
    glBindBuffer(GL_ARRAY_BUFFER, vertexBuffer);
    glBufferData(GL_ARRAY_BUFFER, sizeof(Vertices), Vertices, GL_STATIC_DRAW);

    GLuint indexBuffer;
    glGenBuffers(1, &indexBuffer);
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, indexBuffer);
    glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(Indices), Indices, GL_STATIC_DRAW);

}

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code[]
        self.backgroundColor = [UIColor redColor];
        [self setupLayer];
        [self setupContext];
        [self setupRenderBuffer];
        [self setupFrameBuffer];

        [self setupVBOs];
        [self compileShaders];
        [self readYUVFile];

        [self render];

    }
    return self;
}

+ (Class)layerClass{
    return [CAEAGLLayer class];
}

-(void)setupLayer{
    _eaglLayer = (CAEAGLLayer *)self.layer;
    _eaglLayer.opaque = YES;
}

- (void)setupContext{
    EAGLRenderingAPI api = kEAGLRenderingAPIOpenGLES2;
    _context = [[[EAGLContext alloc] initWithAPI:api] autorelease];

    if (!_context) {
        NSLog(@"Failed to initialize OpenGLES 2.0 context");
        exit(1);
    }

    if (![EAGLContext setCurrentContext:_context]) {
        NSLog(@"Failed to set current OpenGL context");
        exit(1);
    }
}

- (void)setupRenderBuffer {
    glGenRenderbuffers(1, &_colorRenderBuffer);
    glBindRenderbuffer(GL_RENDERBUFFER, _colorRenderBuffer);        
    [_context renderbufferStorage:GL_RENDERBUFFER fromDrawable:_eaglLayer];    
}

- (void)setupFrameBuffer {    
    GLuint framebuffer;
    glGenFramebuffers(1, &framebuffer);
    glBindFramebuffer(GL_FRAMEBUFFER, framebuffer);
    glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, 
                              GL_RENDERBUFFER, _colorRenderBuffer);
}

- (GLuint) textureY: (Byte*)imageData        
          widthType: (int) width       
         heightType: (int) height       
{          
    GLuint texName;    
    glGenTextures( 1, &texName );     
    glBindTexture(GL_TEXTURE_2D, texName);

    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR );    
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR );    
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);    
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);    

    glTexImage2D( GL_TEXTURE_2D, 0, GL_LUMINANCE, width, height, 0, GL_LUMINANCE, GL_UNSIGNED_BYTE, imageData );  
    //free(imageData);

    return texName;    
}    

- (GLuint) textureU: (Byte*)imageData        
          widthType: (int) width       
         heightType: (int) height       
{          
    GLuint texName;    

    glGenTextures( 1, &texName );     
    glBindTexture(GL_TEXTURE_2D, texName);

    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR );    
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR );    
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);    
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);    

    glTexImage2D( GL_TEXTURE_2D, 0, GL_RED_EXT, width, height, 0, GL_RED_EXT, GL_UNSIGNED_BYTE, imageData );    

    //free(imageData);
    return texName;    
}    

- (GLuint) textureV: (Byte*)imageData        
          widthType: (int) width       
         heightType: (int) height       
{          
    GLuint texName;    
    glGenTextures( 1, &texName );     
    glBindTexture(GL_TEXTURE_2D, texName);

    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR );    
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR );    
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);    
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);    

    glTexImage2D( GL_TEXTURE_2D, 0, GL_RED_EXT, width, height, 0, GL_RED_EXT, GL_UNSIGNED_BYTE, imageData );    

    //free(imageData);
    return texName;    
}    

- (void) readYUVFile     
{    
    NSString *file = [[NSBundle mainBundle] pathForResource:@"video" ofType:@"yv12"];
    NSLog(@"%@",file);
    NSData* fileData = [NSData dataWithContentsOfFile:file]; 
    //NSLog(@"%@",[fileData description]);
    NSInteger width  = 352;    
    NSInteger height = 288;
    NSInteger uv_width  = width  / 2;    
    NSInteger uv_height = height / 2;
    NSInteger dataSize = [fileData length];
    NSLog(@"%i\n",dataSize);

    GLint nYsize  = width * height;     
    GLint nUVsize = uv_width * uv_height;      
    GLint nCbOffSet = nYsize;    
    GLint nCrOffSet = nCbOffSet + nUVsize;    

    Byte *spriteData = (Byte *)malloc(dataSize);
    [fileData getBytes:spriteData length:dataSize];

    Byte* uData = spriteData + nCbOffSet;
    //NSLog(@"%@\n",[[NSData dataWithBytes:uData length:nUVsize] description]);
    Byte* vData = spriteData + nCrOffSet;  
    //NSLog(@"%@\n",[[NSData dataWithBytes:vData length:nUVsize] description]);

    Byte *YPlanarData = (Byte *)malloc(nYsize);
    for (int i=0; i<nYsize; i++) {
        YPlanarData[i]= spriteData[i];
    }    

    Byte *UPlanarData = (Byte *)malloc(nYsize);
    for (int i=0; i<height; i++) {
        for (int j=0; j<width; j++) {
            int numInUVsize = (i/2)*uv_width+j/2;
            UPlanarData[i*width+j]=uData[numInUVsize];
        }
    }

    Byte *VPlanarData = (Byte *)malloc(nYsize);
    for (int i=0; i<height; i++) {
        for (int j=0; j<width; j++) {
            int numInUVsize = (i/2)*uv_width+j/2;
            VPlanarData[i*width+j]=vData[numInUVsize];
        }
    }

    _YPlanarTexture = [self textureY:YPlanarData widthType:width heightType:height];    
    _UPlanarTexture = [self textureU:UPlanarData widthType:width  heightType:height];    
    _VPlanarTexture = [self textureV:VPlanarData widthType:width heightType:height];       

    free(spriteData);

}

- (void)render {
    glClearColor(0,0,0 , 1.0);
    glClear(GL_COLOR_BUFFER_BIT);

    // 1
    glViewport(0, 200, self.frame.size.width, 558);

    // 2
    glVertexAttribPointer(_positionSlot, 3, GL_FLOAT, GL_FALSE, 
                          sizeof(Vertex), 0);

    glVertexAttribPointer(_texCoordSlot, 2, GL_FLOAT, GL_FALSE, 
                          sizeof(Vertex), (GLvoid*) (sizeof(float) *3));    

    glActiveTexture(GL_TEXTURE0); 
    glBindTexture(GL_TEXTURE_2D, _YPlanarTexture);
    glUniform1i(_textureUniformY, 0);

    glActiveTexture(GL_TEXTURE1); 
    glBindTexture(GL_TEXTURE_2D, _UPlanarTexture);
    glUniform1i(_textureUniformU, 1);

    glActiveTexture(GL_TEXTURE2); 
    glBindTexture(GL_TEXTURE_2D, _VPlanarTexture);
    glUniform1i(_textureUniformV, 2);

    // 3
    glDrawElements(GL_TRIANGLES, sizeof(Indices)/sizeof(Indices[0]), 
                   GL_UNSIGNED_BYTE, 0);

    [_context presentRenderbuffer:GL_RENDERBUFFER];
}

/*
// Only override drawRect: if you perform custom drawing.
// An empty implementation adversely affects performance during animation.
- (void)drawRect:(CGRect)rect
{
    // Drawing code
}
*/

- (GLuint)compileShader:(NSString*)shaderName withType:(GLenum)shaderType {

    // 1
    NSString* shaderPath = [[NSBundle mainBundle] pathForResource:shaderName 
                                                           ofType:@"glsl"];
    NSError* error;
    NSString* shaderString = [NSString stringWithContentsOfFile:shaderPath 
                                                       encoding:NSUTF8StringEncoding error:&error];
    if (!shaderString) {
        NSLog(@"Error loading shader: %@", error.localizedDescription);
        exit(1);
    }

    // 2
    GLuint shaderHandle = glCreateShader(shaderType);    

    // 3
    const char* shaderStringUTF8 = [shaderString UTF8String];    
    int shaderStringLength = [shaderString length];
    glShaderSource(shaderHandle, 1, &shaderStringUTF8, &shaderStringLength);

    // 4
    glCompileShader(shaderHandle);

    // 5
    GLint compileSuccess;
    glGetShaderiv(shaderHandle, GL_COMPILE_STATUS, &compileSuccess);
    if (compileSuccess == GL_FALSE) {
        GLchar messages[256];
        glGetShaderInfoLog(shaderHandle, sizeof(messages), 0, &messages[0]);
        NSString *messageString = [NSString stringWithUTF8String:messages];
        NSLog(@"%@", messageString);
        exit(1);
    }

    return shaderHandle;

}

- (void)compileShaders {

    // 1
    GLuint vertexShader = [self compileShader:@"SimpleVertex" 
                                     withType:GL_VERTEX_SHADER];
    GLuint fragmentShader = [self compileShader:@"SimpleFragment" 
                                       withType:GL_FRAGMENT_SHADER];

    // 2
    GLuint programHandle = glCreateProgram();
    glAttachShader(programHandle, vertexShader);
    glAttachShader(programHandle, fragmentShader);
    glLinkProgram(programHandle);

    // 3
    GLint linkSuccess;
    glGetProgramiv(programHandle, GL_LINK_STATUS, &linkSuccess);
    if (linkSuccess == GL_FALSE) {
        GLchar messages[256];
        glGetProgramInfoLog(programHandle, sizeof(messages), 0, &messages[0]);
        NSString *messageString = [NSString stringWithUTF8String:messages];
        NSLog(@"%@", messageString);
        exit(1);
    }

    // 4
    glUseProgram(programHandle);

    // 5
    _positionSlot = glGetAttribLocation(programHandle, "position");
    glEnableVertexAttribArray(_positionSlot);

    _texCoordSlot = glGetAttribLocation(programHandle, "textureCoordinate");
    glEnableVertexAttribArray(_texCoordSlot);

    _YPlanarTexture = glGetUniformLocation(programHandle, "SamplerY");
    _UPlanarTexture = glGetUniformLocation(programHandle, "SamplerU");
    _VPlanarTexture = glGetUniformLocation(programHandle, "SamplerV");

}

@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T01:26:21.820

我的愚蠢错误，三个上传纹理过程和片段着色器是正确的，但以下代码不兼容：

```
glActiveTexture(GL_TEXTURE0); 
glBindTexture(GL_TEXTURE_2D, _YPlanarTexture);
glUniform1i(_textureUniformY, 0);

glActiveTexture(GL_TEXTURE1); 
glBindTexture(GL_TEXTURE_2D, _UPlanarTexture);
glUniform1i(_textureUniformU, 1);

glActiveTexture(GL_TEXTURE2); 
glBindTexture(GL_TEXTURE_2D, _VPlanarTexture);
glUniform1i(_textureUniformV, 2); 
```

及以下：

```
_YPlanarTexture = glGetUniformLocation(programHandle, "SamplerY");
_UPlanarTexture = glGetUniformLocation(programHandle, "SamplerU");
_VPlanarTexture = glGetUniformLocation(programHandle, "SamplerV"); 
```

所以用这个替换：

```
_textureUniformY = glGetUniformLocation(programHandle, "SamplerY");
_textureUniformU = glGetUniformLocation(programHandle, "SamplerU");
_textureUniformV = glGetUniformLocation(programHandle, "SamplerV"); 
```

那么它会做正确的事情。

# c++ - 如何在opencv中将二维数组转换为灰度图像？

> ID：11093062
> 
> 赞同：1
> 
> 时间：2012-06-19T00:57:25.510
> 
> 标签：c++, opencv, type-2-dimension

我在我的 c++ 图像处理项目中使用 openCV。

我有这个二维数组 I[800][600] 填充了 0 到 255 之间的值，我想把这个数组放在灰度级“IplImage”中，这样​​我就可以查看它并使用 openCV 函数对其进行处理。

任何帮助将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T04:48:27.133

在 Opencv C++ 界面中很容易，你需要做的就是初始化一个矩阵，见下面的行

`cv::Mat img = cv::Mat(800, 600, CV_8UC1, I) // I[800][600]`

现在你可以为所欲为，Opencv 将 img 视为 8 位灰度图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T01:22:13.873

```
CvSize image_size;
image_size.height = 800;
image_size.width = 600;
int channels = 1;
IplImage *image = cvCreateImageHeader(image_size, IPL_DEPTH_8U, channels);
cvSetData(image, I, image->widthStep) 
```

这是未经测试的，但可能需要修复的最重要的事情是`cvSetData()`. 这需要是指向无符号字符数据的指针，如果您只是使用不属于 a 的二维数组`Mat`，那么您将不得不做一些不同的事情，（可能是一个循环？虽然您应该避免尽可能多地在 openCV 中循环）。

有关高度相关的问题，请参阅[此帖子](https://stackoverflow.com/questions/1594809/convert-float-array-image-to-a-format-usable-for-opencv)

# ruby - 为什么 Ruby 有预定义的常量 TRUE、FALSE 和 NIL？

> ID：11093064
> 
> 赞同：3
> 
> 时间：2012-06-19T00:57:46.453
> 
> 标签：ruby

Ruby 有预定义的常量`TRUE`, `FALSE`, 和`NIL`分别引用`true`, `false`, 和`nil`。为什么是这样？为什么人们不能只使用`true`,`false`和`nil`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T01:05:44.400

ruby 有这个预定义的常量，以避免用大写字母编写错误，有些人喜欢像这样的特殊常量大写，所以它只是小写的同义词，请参见[http://www.tutorialspoint.com/ruby/ruby_predefined_constants。 htm](http://www.tutorialspoint.com/ruby/ruby_predefined_constants.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T12:12:12.527

我猜这是一件方便的事情 - 它与说 c 中的人们倾向于在项目基础上做同样的事情相同：

```
#ifndef (TRUE)
#define TRUE (1)
#endif 
```

此外，我认为定义这些常量不会造成任何伤害。

# wordpress - 将 Metabox 数据打印到页脚？

> ID：11093073
> 
> 赞同：0
> 
> 时间：2012-06-19T00:59:08.247
> 
> 标签：wordpress, wordpress-theming

我按照这里的教程[http://wp.smashingmagazine.com/2011/10/04/create-custom-post-meta-boxes-wordpress/](http://wp.smashingmagazine.com/2011/10/04/create-custom-post-meta-boxes-wordpress/)

我让它按教程中的预期工作，但我不想添加类，我只想将内容添加到 footer.php 文件：

这是我在functions.php中的教程代码

```
/* Fire our meta box setup function on the post editor screen. */
add_action( 'load-post.php', 'smashing_post_meta_boxes_setup' );
add_action( 'load-post-new.php', 'smashing_post_meta_boxes_setup' );

/* Meta box setup function. */
function smashing_post_meta_boxes_setup() {

    /* Add meta boxes on the 'add_meta_boxes' hook. */
    add_action( 'add_meta_boxes', 'smashing_add_post_meta_boxes' );

    /* Save post meta on the 'save_post' hook. */
    add_action( 'save_post', 'smashing_save_post_class_meta', 10, 2 );
}

/* Create one or more meta boxes to be displayed on the post editor screen. */
function smashing_add_post_meta_boxes() {

    add_meta_box(
        'smashing-post-class',          // Unique ID
        esc_html__( 'Post Class', 'example' ),      // Title
        'smashing_post_class_meta_box',     // Callback function
        'post',                 // Admin page (or post type)
        'side',                 // Context
        'default'                   // Priority
    );
}

/* Display the post meta box. */
function smashing_post_class_meta_box( $object, $box ) { ?>

    <?php wp_nonce_field( basename( __FILE__ ), 'smashing_post_class_nonce' ); ?>

    <p>
        <label for="smashing-post-class"><?php _e( "Add a custom CSS class, which will be applied to WordPress' post class.", 'example' ); ?></label>
        <br />
        <input class="widefat" type="text" name="smashing-post-class" id="smashing-post-class" value="<?php echo esc_attr( get_post_meta( $object->ID, 'smashing_post_class', true ) ); ?>" size="30" />
    </p>
<?php }

/* Save the meta box's post metadata. */
function smashing_save_post_class_meta( $post_id, $post ) {

    /* Verify the nonce before proceeding. */
    if ( !isset( $_POST['smashing_post_class_nonce'] ) || !wp_verify_nonce( $_POST['smashing_post_class_nonce'], basename( __FILE__ ) ) )
        return $post_id;

    /* Get the post type object. */
    $post_type = get_post_type_object( $post->post_type );

    /* Check if the current user has permission to edit the post. */
    if ( !current_user_can( $post_type->cap->edit_post, $post_id ) )
        return $post_id;

    /* Get the posted data and sanitize it for use as an HTML class. */
    $new_meta_value = ( isset( $_POST['smashing-post-class'] ) ? sanitize_html_class( $_POST['smashing-post-class'] ) : '' );

    /* Get the meta key. */
    $meta_key = 'smashing_post_class';

    /* Get the meta value of the custom field key. */
    $meta_value = get_post_meta( $post_id, $meta_key, true );

    /* If a new meta value was added and there was no previous value, add it. */
    if ( $new_meta_value && '' == $meta_value )
        add_post_meta( $post_id, $meta_key, $new_meta_value, true );

    /* If the new meta value does not match the old value, update it. */
    elseif ( $new_meta_value && $new_meta_value != $meta_value )
        update_post_meta( $post_id, $meta_key, $new_meta_value );

    /* If there is no new meta value but an old value exists, delete it. */
    elseif ( '' == $new_meta_value && $meta_value )
        delete_post_meta( $post_id, $meta_key, $meta_value );
}

/* Filter the post class hook with our custom post class function. */
add_filter( 'post_class', 'smashing_post_class' );

function smashing_post_class( $classes ) {

    /* Get the current post ID. */
    $post_id = get_the_ID();

    /* If we have a post ID, proceed. */
    if ( !empty( $post_id ) ) {

        /* Get the custom post class. */
        $post_class = get_post_meta( $post_id, 'smashing_post_class', true );

        /* If a post class was input, sanitize it and add it to the post class array. */
        if ( !empty( $post_class ) )
            $classes[] = sanitize_html_class( $post_class );
    }

    return $classes;
} 
```

我如何将输入到字段中的数据回显到我的 footer.php 而不需要任何额外内容？

```
<?--php global $post; echo get_post_meta($post->ID,'smashing-post-class',true) ?>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T03:15:20.293

在您的 footer.php 中，您可以调用`global $post`以访问存储在那里的信息。例如：

`<?--php global $post; echo get_post_meta($post->ID,'smashing-post-class',true) ?>`

# ruby-on-rails - rails 不允许我从另一个方法内部调用方法 - rails 一直说该方法未定义

> ID：11093076
> 
> 赞同：1
> 
> 时间：2012-06-19T00:59:50.913
> 
> 标签：ruby-on-rails, methods, rails-models

在我的辅导课程模型中，我有在不同时间触发提醒文本的代码。一切正常，直到我尝试了一些重构，现在我遇到了问题。

```
def send_reminder_text(texts_batch)
    texts_batch.each do |text|
        page_number = Refugee.find(text.refugee_id)[:last_page]
        body_of_text = text[:begin_time].in_time_zone.strftime("Burma Reminder: upcoming session at %I:%M%p beginning on page #{page_number}. 
            Please email jek2141@columbia.edu to reschedule or cancel the session.") 
        text.begin_text(body_of_text)
    end
end

def self.deliver_pm_reminder_text
    texts_batch = TutoringSession.batch_for_pm_reminder_text
    send_reminder_text(texts_batch)
end

def self.deliver_just_before_reminder_text
    texts_batch = TutoringSession.batch_for_just_before_reminder_text
    send_reminder_text(texts_batch)
end 
```

当我调用该`deliver_just_before_reminder_text`函数时，我收到以下错误消息：

```
irb(main):006:0> TutoringSession.send_reminder_text
NoMethodError: undefined method `send_reminder_text' for #<Class:0x00000003cfe5d8>
    from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.1.1/lib/active_record   /base.rb:1088:in `method_missing'
from (irb):6
from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.1.1/lib/rails/commands/console.rb:45:in `start'
from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.1.1/lib/rails/commands/console.rb:8:in `start'
from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.1.1/lib/rails/commands.rb:40:in `<top (required)>'
from script/rails:6:in `require'
from script/rails:6:in `<main>' 
```

`send_reminder_text`尽管上面已经明确定义了这一事实。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T01:06:56.453

您的方法声明指定该方法在`TutoringSession`类的对象上：

```
def send_reminder_text(texts_batch) 
```

但是你试图调用它，就好像它是类本身的一个方法：

```
irb(main):006:0> TutoringSession.send_reminder_text 
```

尝试将您的定义更改为：

```
def self.send_reminder_text(texts_batch) 
```

# vba - 将单元格值从一个工作表复制到另一个工作表作为字符串

> ID：11093077
> 
> 赞同：1
> 
> 时间：2012-06-19T00:59:56.437
> 
> 标签：vba, excel

我正在尝试将单元格值从 Sheets("#sampleTracker") 复制到 Sheets("#MESSAGEBOARD")。

所以 datedatax、namedatax、numberdatax 都来自#sampleTracker 表，然后我们转到#MESSAGEBOARD 表并在列表底部输入数据。

我有 datedatax 工作，但 namedatax 和 numberdatax 没有出现。

有什么建议么？

```
datedatax = ActiveCell.Value
Dim namedatax As String
Dim numberdatax As String
numberdatax = Sheets("#SampleTracker").Cells(9, ActiveCell.Row).Value
namedatax = Sheets("#SampleTracker").Cells(10, ActiveCell.Row).Value
styledatax = numberdatax + "_" & namedatax

Sheets("#MESSAGEBOARD").Select
Range("C2").Select
Set EmptyCell = Cells(100, ActiveCell.Column) 'select last cell pt1
EmptyCell.End(xlUp).Select ' select last cell in column pt2
ActiveCell.Offset(1, 0).Select ' select last cell in column pt3
ActiveCell.Value = datedatax - Date 'advise how many days till due date
ActiveCell.Offset(0, 1).Select
ActiveCell = "sample " & styledatax

Sheets("#SampleTracker").Select 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T05:00:04.630

您在代码的第一部分中颠倒了行和列。

它`.Cells(row,column)`看起来像你有`.Cells(column,row)`

# sql - 跨多个服务器拉取数据

> ID：11093079
> 
> 赞同：0
> 
> 时间：2012-06-19T01:00:04.840
> 
> 标签：sql, sql-server

我工作的公司正在使用运行在 SQL 后端的报告服务器来实施 Share-point。我们需要的信息存在于两个不同的服务器上。第一台服务器是制造服务器，它从 PLC 收集数据并将该信息输入 SQL 数据库，另一台服务器是我们的 erp 服务器，它包含特定项目的工资单和工时数据。我要做的是在单独的数据库上创建一个视图，然后从那里我可以从两台服务器中提取信息。我在连接两台服务器以运行视图的语法上遇到了一点问题。我们正在运行 ms SQL。如果您需要更多信息或澄清，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T01:03:46.687

请阅读有关[链接服务器](https://stackoverflow.com/questions/125457/what-is-the-t-sql-syntax-to-connect-to-another-sql-server)的信息。

或者，您可以创建一个数据仓库 - 这将是一个报告数据库。您可以通过使用链接服务器制作 proc 或使用 SSIS 包（如果它们未链接）来提供此信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T05:23:18.807

这完全取决于项目的规模和复杂性，但在许多情况下，很难使用视图聚合来自多个来源的数据。原因是源数据结构是为源应用程序建模的，而不是针对报告进行优化的。

在这种情况下，我建议使用 ETL 流程，您将在其中创建一组提取、转换和加载作业，以将来自多个源（数据库）的数据获取到目标数据库，其中数据将以针对报告优化的格式存储.

Ralph Kimball 有很多关于这个主题的好书，例如：1) The Data Warehouse ETL Toolkit 2) The Data Warehouse Toolkit

如果您正在处理数据，它们确实值得一读

# git - 原点映射到什么，如何找出

> ID：11093080
> 
> 赞同：25
> 
> 时间：2012-06-19T01:00:06.577
> 
> 标签：git

说你

```
git remote add origin git@git.assembla.com:myRepo.git 
```

然后..你知道..你忘记了到底`origin`映射到什么:(

你怎么知道？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-06-19T01:01:45.157

```
git remote -v 
```

将列出它们。通过检查可以看到此信息的来源`.git/config`：

```
cat .git/config 
```

存储库基础目录中的`config`文件包含纯文本格式的所有配置。`.git`

你会看到这样的东西：

```
[remote "origin"]
        url = git@git.assembla.com:myRepo.git
        fetch = +refs/heads/*:refs/remotes/origin/* 
```

该`url`行（在 git config 用语中，的值`remote.origin.url`）包含远程 URL。

另一种查找方法是执行`git config remote.origin.url`：

```
$ git config remote.origin.url
git@git.assembla.com:myRepo.git
$ 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-19T01:02:40.057

```
git remote -v 
```

will give a list of all remote along with their corresponding URLs. You can find out even more information about the remote by doing

```
git remote show origin 
```

Read more in the [man page for `git-remote`](http://www.kernel.org/pub/software/scm/git/docs/git-remote.html).

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-19T01:02:27.863

You can run the following command:

```
git remote -v 
```

to get a list of all remotes with their URL.

From the man-page:

> OPTIONS
> -v, --verbose
> Be a little more verbose and show remote url after name. NOTE: This must be placed between remote and subcommand.
> 
> COMMANDS
> With no arguments, shows a list of existing remotes. Several subcommands are available to perform operations on the remotes.

# javascript - 用网格填充 three.js 场景

> ID：11093084
> 
> 赞同：11
> 
> 时间：2012-06-19T01:01:10.720
> 
> 标签：javascript, 3d, three.js

## 我在找什么

在填充整个场景的 three.js 场景中显示一个网格。在这种情况下，场景是整个窗口。

这个网格代表一个 3D 表面，可以使用鼠标四处移动。`THREE.TrackballControls`这个网格面向相机，所以最初它看起来像一个平面 (2D) 表面，直到用鼠标拉动轨迹球。

网格线的宽度应等于渲染器的宽度。

## 我做了什么

我已经为我到目前为止所做的工作设置了一个工作[jsFiddle 。](http://jsfiddle.net/cs_brandt/SeNDk/)

首先我找到了场景的边界（所有这些都在 jsFiddle 中），

```
App = function(sceneContainerName) {
   this.sceneContainerName = sceneContainerName;

   this.SCREEN_WIDTH = window.innerWidth;
   this.SCREEN_HEIGHT = window.innerHeight;

   this.MAX_X = this.SCREEN_WIDTH / 2;
   this.MIN_X = 0 - (this.SCREEN_WIDTH / 2);
   this.MAX_Y = this.SCREEN_HEIGHT / 2;
   this.MIN_Y = 0 - (this.SCREEN_HEIGHT / 2);

   this.NUM_HORIZONTAL_LINES = 50;

   this.init(); 
```

};

设置三个.js

```
init: function() {
   // init scene
   this.scene = new THREE.Scene();

   // init camera
   // View Angle, Aspect, Near, Far
   this.camera = new THREE.PerspectiveCamera(45, this.SCREEN_WIDTH / this.SCREEN_HEIGHT, 1, 10000);
   // set camera position
   this.camera.position.z = 1000;
   this.camera.position.y = 0;

   // add the camera to the scene
   this.scene.add(this.camera);

   this.projector = new THREE.Projector();

   // init renderer
   this.renderer = new THREE.CanvasRenderer();
   // start the renderer
   this.renderer.setSize(this.SCREEN_WIDTH, this.SCREEN_HEIGHT);

   this.drawGrid(this.NUM_HORIZONTAL_LINES);

   this.trackball = new THREE.TrackballControls(this.camera, this.renderer.domElement);
   this.trackball.staticMoving = true;

   var me = this;

   this.trackball.addEventListener('change', function() {
       me.render();
   });

   // attach the render-supplied DOM element
   var container = document.getElementById(this.sceneContainerName);
   container.appendChild(this.renderer.domElement);

   this.animate();
}, 
```

这些函数为每个屏幕角提供了一个向量，

```
getNWScreenVector: function() {
    return new THREE.Vector3(this.MIN_X, this.MAX_Y, 0);
},

getNEScreenVector: function() {
    return new THREE.Vector3(this.MAX_X, this.MAX_Y, 0);
},

getSWScreenVector: function() {
    return new THREE.Vector3(this.MIN_X, this.MIN_Y, 0);
},

getSEScreenVector: function() {
    return new THREE.Vector3(this.MAX_X, this.MIN_Y, 0);
}, 
```

我创建了一些几何图形来表示屏幕最顶部的一条线，并尝试从顶部开始绘制线条并向下到屏幕底部。

```
// drawGrid will determine blocksize based on the 
// amount of horizontal gridlines to draw
drawGrid: function(numHorizontalGridLines) {

    // Determine the size of a grid block (square)
    this.gridBlockSize = this.SCREEN_HEIGHT / numHorizontalGridLines;

    var geometry = new THREE.Geometry();
    geometry.vertices.push(this.getNWScreenVector());
    geometry.vertices.push(this.getNEScreenVector());

    var material = new THREE.LineBasicMaterial({
        color: 0x000000,
        opacity: 0.2
    });

    for (var c = 0; c <= numHorizontalGridLines; c++) {
        var line = new THREE.Line(geometry, material);
        line.position.y = this.MAX_Y - (c * this.gridBlockSize);
        this.scene.add(line);
    }
} 
```

## 问题

此方法不起作用，在 jsFiddle 中，第一行从屏幕开始，并且行的宽度不填充屏幕宽度。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2014-11-28T12:58:23.373

从 ThreeJS r57 开始，有一个名为 GridHelper 的助手，您可以使用它轻松绘制漂亮的网格，就像任何其他几何对象一样。

GridHelper 有 2 个参数。第一个是网格的大小，第二个是两行之间的步长

下面是在场景中绘制网格的代码，size = 100，step = 10

```
var grid = new THREE.GridHelper(100, 10);
scene.add(grid); 
```

在您的情况下，您可以避免使用名为 drawGrid 的方法并直接将其替换为上述两行代码，或者您可以在 drawgrid 方法中添加上述两行代码。

以下链接中提供了一个实时示例

[网格助手示例](https://stemkoski.github.io/Three.js/Helpers.html)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-11-23T06:14:19.147

你可以像这样画一个网格。

```
// each square
var planeW = 50; // pixels
var planeH = 50; // pixels 
var numW = 50; // how many wide (50*50 = 2500 pixels wide)
var numH = 50; // how many tall (50*50 = 2500 pixels tall)
var plane = new THREE.Mesh(
    new THREE.PlaneGeometry( planeW*numW, planeH*numH, planeW, planeH ),
    new THREE.MeshBasicMaterial( {
        color: 0x000000,
        wireframe: true
    } )
);

scene.add(plane); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-06-21T00:13:30.890

因此，您的代码中有两个错误。

首先，您从线开始`MAX_Y`，然后将每条线放在最后一条线下方的固定距离处。相对较小的错误是 in`getNWScreenVector`并且`getNEScreenVector`您将线的顶点放在高度为`MAX_Y`, 然后在

```
line.position.y = this.MAX_Y - (c * this.gridBlockSize); 
```

您正在向 的行添加翻译`MAX_Y - (c * this.gridBlockSize)`，这给出了 的最终 y 位置`MAX_Y + MAX_Y - (c * this.gridBlockSize)`，这是一个`MAX_Y`太多了。`getNWScreenVector`如果您的程序以从and开始的行开始有意义`getNEScreenVector`，那么您应该将该`line.position.y`行更改为 just

```
line.position.y = -c * this.gridBlockSize; 
```

您可以看到这些行现在以[jsFiddle](http://jsfiddle.net/4krtpbhf/)为中心，但它们的大小仍然不正确。这是因为您没有考虑到您的场景是透视的。您的线条都将其 z 坐标设置为 0，因此当您设置 时`this.camera.position.z = 1000`，它们距离相机 1000 个单位。没有理由假设宽度与画布像素宽度相同的东西在从 1000 个单位远的角度绘制时将具有相同的宽度。

相反，我们可以计算它们需要多大。我不会在这里详细解释透视图，但我们可以计算出线条需要覆盖多大的区域才能覆盖屏幕。您在相机构造函数中指定了 45 度的垂直 FOV，相机与线之间的距离为 1000。如果您深入了解它如何创建透视矩阵， Three.js 基本上会显示解决方案：[makePerspective](https://github.com/mrdoob/three.js/blob/7c1424c5819ab622a346dd630ee4e6431388021e/src/math/Matrix4.js#L785)

首先，我们需要屏幕上半部分的垂直距离，因为 0 位于屏幕的中心。`Math.tan(45 / 2 * (Math.PI / 180))`（半角的切线，转换为弧度）给出垂直距离除以距相机的距离，因此您可以计算高度

```
halfDisplayHeight = 1000 * Math.tan(45 / 2 * (Math.PI / 180)); 
```

或加倍到

```
this.DISPLAY_HEIGHT = 2 * 1000 * Math.tan(45 / 2 * (Math.PI / 180)); 
```

除非画布是正方形，否则水平FOV是*不*一样的，但是线条区域的宽高比会与屏幕的宽高比成正比。像 three.js 一样，你可以乘以你也提供给相机构造函数的纵横比来计算宽度：

```
this.DISPLAY_WIDTH = this.DISPLAY_HEIGHT * (this.SCREEN_WIDTH / this.SCREEN_HEIGHT); 
```

这些是您应该用于放置线条的值。全部一起：

```
this.DISPLAY_HEIGHT = 2 * 1000 * Math.tan(45 / 2 * (Math.PI / 180));
this.DISPLAY_WIDTH = this.DISPLAY_HEIGHT * (this.SCREEN_WIDTH / this.SCREEN_HEIGHT);
this.MAX_X = this.DISPLAY_WIDTH / 2;
this.MIN_X = 0 - (this.DISPLAY_WIDTH / 2);
this.MAX_Y = this.DISPLAY_HEIGHT / 2;
this.MIN_Y = 0 - (this.DISPLAY_HEIGHT / 2); 
```

最后，您需要将线条分布在整个区域，因此您应该设置

```
this.gridBlockSize = this.DISPLAY_HEIGHT / numHorizontalGridLines; 
```

你可以在这里看到工作：http: [//jsfiddle.net/pa46hxwo/](http://jsfiddle.net/pa46hxwo/)

但是，还有另一种方法可以做到这一点，即保持线条相同，但将相机移近线条，使线条的宽度恰好等于该距离处画布的像素宽度。该公式只是对上面的 的修改`DISPLAY_HEIGHT`，但我们不是求解高度，而是求解高度等于屏幕高度时的距离：

```
this.camera.position.z = this.SCREEN_HEIGHT / (2 * Math.tan(45 / 2 * (Math.PI / 180))); 
```

你可以在这里看到：http: [//jsfiddle.net/0jtykgrL/](http://jsfiddle.net/0jtykgrL/)

这是对您的代码的一个小得多的更改，但这意味着相机位置将根据画布的大小而改变，这可能会影响您需要精确放置的其他内容，因此您可以选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-13T20:04:19.100

该线程有助于对应用于 A-Frame 的技术进行变体，并稍作改动；根据场景子项的边界框动态创建和调整网格大小。

注意：必须调用以下方法来获取最初为空的边界框坐标，这与为您预先计算的边界球体不同：

' **boundingBox.geometry.computeBoundingBox();** '

可以在此处找到此“场景 ario”（双关语）的 Codepen：[https ://codepen.io/ubermario/pen/JvZMPg](https://codepen.io/ubermario/pen/JvZMPg)

```
 <!DOCTYPE html>
    <html lang="en" >

    <head>

      <meta charset="UTF-8">
      <link rel="shortcut icon" type="image/x-icon" href="https://static.codepen.io/assets/favicon/favicon-8ea04875e70c4b0bb41da869e81236e54394d63638a1ef12fa558a4a835f1164.ico" />
      <link rel="mask-icon" type="" href="https://static.codepen.io/assets/favicon/logo-pin-f2d2b6d2c61838f7e76325261b7195c27224080bc099486ddd6dccb469b8e8e6.svg" color="#111" />
      <title>CodePen -  A-Frame Dynamically Sized GridHelper</title>     
    </head>

    <body translate="no" >

      <script src="https://aframe.io/releases/0.8.0/aframe.min.js"></script>
      <a-scene>
        <a-entity>
          <a-sphere position="0 1.25 -5" radius="1.25" color="#EF2D5E"></a-sphere>
          <a-box position="-1 0.5 -3" rotation="0 45 0" width="1" height="1" depth="1" color="#4CC3D9"></a-box>
          <a-cylinder position="1 0.75 -3" radius="0.5" height="1.5" color="#FFC65D"></a-cylinder>
          <!-- replaced with gridhelper>
      <a-plane position="0 0 -4" rotation="-90 0 0" width="4" height="4" color="#7BC8A4"></a-plane> -->
          <!-- Remove sky; it distorts the dimensions of just the sphere, box, cylinder objects
          <a-sky color="#ECECEC"></a-sky>
          -->
          <a-entity>
      </a-scene>

        <script >
          AFRAME.registerComponent("cmpGridHelper", {
      schema: {
        size: { default: 5, type: "int" },
        divisions: { default: 10, type: "int" },
        colorCenterLine: { default: "red", type: "color" },
        colorGrid: { default: "black", type: "color" },
        x: { default: 0, type: "number" },
        y: { default: 0, type: "number" },
        z: { default: 0, type: "number" }
      },
      init: function() {
        var entity = this.el.object3D,
          schema = this.data,
          grid = new THREE.GridHelper(
            schema.size,
            schema.divisions,
            schema.colorCenterLine,
            schema.colorGrid
          );
        grid.name = "gridHelper";
        entity.add(grid);
      },
      update: function(oldData) {
        var entity = this.el.object3D,
          grid = entity.getObjectByName("gridHelper"),
          schema = this.data;
        grid.position.set(schema.x, schema.y, schema.z);
      },
      remove: function() {
        var entity = this.el.object3D;
        entity.remove(entity.getObjectByName("gridHelper"));
      }
    });

    var sceneObj3d = document.querySelector("a-scene");

    if (sceneObj3d.hasLoaded) {
      fnAddDyanmicGridHelper();
    } else {
      sceneObj3d.addEventListener("loaded", fnAddDyanmicGridHelper);
    }

function fnAddDyanmicGridHelper() {
  //var helper = new THREE.BoundingBoxHelper(sceneObj3d.querySelector('a-entity').object3D, 0xff0000);
  var childObjects = sceneObj3d.querySelector('a-entity').object3D;
  var boundingBox = new THREE.BoxHelper(childObjects, 0xff0000);
  //Uncomment the next line to display the bounding box
  //childObjects.add(boundingBox);
  //Need the following method call to get the geometry.boundingBox coordinates in addition to the sphere coordinates
  boundingBox.geometry.computeBoundingBox();                            

  var x = boundingBox.geometry.boundingSphere.center.x;
  var z = boundingBox.geometry.boundingSphere.center.z;
  var size = boundingBox.geometry.boundingSphere.radius * 2;
  sceneObj3d.setAttribute("cmpGridHelper", {
    x: x,
    z: z,
    y: boundingBox.geometry.boundingBox.min.y,
    size: size,
    divisions: size
  });
}
        </script>
    </body>

    </html> 
```

# django - 对象没有属性“存在”

> ID：11093087
> 
> 赞同：6
> 
> 时间：2012-06-19T01:01:32.503
> 
> 标签：django

我正在使用 Django 1.3 并尝试在模型条目上使用 .exists() 但得到下面列出的错误。Exists() 包含在 Django 1.2 中，所以我应该可以访问它。我使用 django.get_version 验证了我的版本，没关系。基于 pk 查询 MyModel 仅返回一个条目，但使用 .exists() 查询会引发错误。我需要进口一些东西吗？

```
>>> m = MyModel.objects.get(pk=1)
>>> m
<MyModel: Model field entry 1>
>>> m = MyModel.objects.get(pk=1).exists()
Traceback (most recent call last):
  File "<console>", line 1, in <module>
AttributeError: 'MyModel' object has no attribute 'exists' 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-19T01:09:03.473

`exists()` [是 a 的一种方法`QuerySet`](https://docs.djangoproject.com/en/dev/ref/models/querysets/#django.db.models.query.QuerySet.exists)。

`get()`返回单个模型实例，[如果该实例不存在](https://docs.djangoproject.com/en/dev/topics/db/queries/#retrieving-a-single-object-with-get)[将引发异常`Entry.DoesNotExist`](https://docs.djangoproject.com/en/dev/topics/db/queries/#retrieving-a-single-object-with-get)。`try/except`因此，如果您不确定是否存在具有该实例的实例，则需要将其包装在一个块中`id`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-28T07:11:31.903

我在我的项目中使用 Django 1.7，我的代码如下：

```
try:
    temp_query_set = YourModelName.functionName()
except ObjectDoesNotExists:
    <do something> 
```

`if query_set.exists()` 请注意，当没有返回查询集时，我的代码（起初）使用 它可以正常工作，但`object does not have attribute 'exists'`在返回某些内容时会引发错误。所以请尽量避免使用`if <something>.exists()` CMIIW

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-23T00:38:26.883

尝试使用 .filter() 而不是 .get()，如下所示：

```
m = MyModel.objects.filter(pk=1).exists()
y = MyModel.objects.filter(pk=2).exists()
print(m)
print(y) 
```

输出必须是布尔值，例如：

```
False
True 
```

假设 m 不存在而 y 存在

# visual-studio-2010 - 当用户识别 web.config 中配置的信息时，Visual Studio 2010 无法调试

> ID：11093091
> 
> 赞同：0
> 
> 时间：2012-06-19T01:01:47.617
> 
> 标签：visual-studio-2010

我正在使用 Visual Studio 2020 进行 Web 应用程序开发，并且我们的应用程序需要高身份验证，因此我们在 web.config 中添加用户识别信息，如下所示：

```
<identity userName="username" password="pass" impersonate="true"/> 
```

但是，添加这些话后，我发现我无法进入调试模型。

当我按下 F5 时，我会收到如下错误消息：

> 错误 7 无法加载文件或程序集 'Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a' 或其依赖项之一......。（来自 HRESULT 的异常：0x80070542）

如果我删除 web.config 中的行，我可以再次调试。

有什么事？

# java - 如何在不暴露密码的情况下连接到需要密码的数据库？

> ID：11093092
> 
> 赞同：16
> 
> 时间：2012-06-19T01:02:18.403
> 
> 标签：java, database, security, cryptography, password-protection

我正在创建一个应用程序，我需要连接到数据库。数据库需要登录名/密码，因此应用程序可以执行选择和插入等操作。

在应用程序中我需要使用登录名和密码连接到数据库，因此应用程序可以自由地对数据库执行一些任务。**我的问题是：如何在不暴露密码的情况下存储和使用密码来连接数据库？**

我不能简单地使用哈希或加密来存储密码，因为数据库必须识别密码（我认为大多数或所有数据库都必须以纯文本形式接收密码）。

.

.

注意：连接是由应用程序建立的。无需人工输入即可进行连接。

（编辑）有关应用程序的更多信息：它是一个使用 servlets/jsp 的 Web 应用程序。数据库位于应用程序的同一台服务器上。应用程序的用户是默认用户，没有完整的管理员权限，但它可以插入/删除行并执行大多数涉及查询和表中数据修改的事情。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-19T01:05:24.927

完成此操作的常用方法是将用户名/密码外部化为在运行时读取的[属性/配置文件](http://docs.oracle.com/javase/tutorial/essential/environment/properties.html)（无论您是否使用本机 JDBC/JNDI/CDI/J2EE 数据源/等）。

该文件由系统管理员通过 O/S 安全性保护。

操作系统比应用程序代码有更好的保护工具。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-19T01:17:23.353

您可以使用[jasypt](http://www.jasypt.org/)进行加密。并将用户名和密码存储到 datasource.properties 文件中。

```
public Connection getConnection() throws IOException{
    try{
        BasicTextEncryptor encryptor = new BasicTextEncryptor();
        encryptor.setPassword("jasypt");

        Properties props = new EncryptableProperties(encryptor);
        props.load( this.getClass().getResourceAsStream("datasource.properties") );

        String driver = props.getProperty("datasource.driver");
        String url = props.getProperty("datasource.url");        
        String userName = props.getProperty("datasource.userName");          
        String password = props.getProperty("datasource.password");

        Class.forName(driver);
        Connection conn = DriverManager.getConnection(url, userName, password);
        conn.setAutoCommit(false);

        return conn;
    } catch(ClassNotFoundException e) {
        e.printStackTrace();
        return null;

    } catch(SQLException e) {
        e.printStackTrace();
        return null;
    }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-06-19T02:13:45.373

您应该为此使用配置文件。将 spring 与 JDBC 结合使用，让您的生活更轻松！

[http://www.youtube.com/watch?v=f-k823MZ02Q](http://www.youtube.com/watch?v=f-k823MZ02Q)

查看上面关于 Spring 框架和使用 JDBC 的精彩教程。观看他所有的 JDBC 和 spring 教程。顺便说一句，他介绍了如何将密码存储在配置文件和线 bean 等中。希望这会有所帮助。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-06-19T01:04:27.480

如果它是 Web 应用程序，请将其部署在 Java EE 应用程序服务器上并使用 JNDI 资源进行连接。只有设置 JNDI 数据资源的管理员需要了解连接所需的凭据。用户和开发人员甚至不必认识他们；只是 JNDI 查找名称。

不可能完全消除除数据库所有者之外的其他人知道用户名和密码的需要，但可以将这些知识限制为应用服务器所有者。

还建议您仅为该应用程序创建单独的凭据，并为其授予完成其任务所需的最低访问权限和权限。不应该了解系统表或应用程序范围之外的任何其他资源。如果不需要删除权限，请不要授予它。如果访问权限只能是只读的，那么这就是您应该授予该凭据的权限。

# php - Caching website by Codeigniter or 3rd party caching web application?

> ID：11093100
> 
> 赞同：0
> 
> 时间：2012-06-19T01:03:07.693
> 
> 标签：php, apache, codeigniter, caching, webpage

I'm very new to the concept "caching", so excuse me if my question is too simple.
So,I'm using Codeigniter(PHP framework) and it supports page caching, simply by doing this `$this->output->cache(n)//n: number of minutes to remain cached`
(I think) Codeigniter's caching will store any requested page in a cache file, and get the page when needed immediately.
Also there's a 3rd part web application called [Vanish Cache](https://www.varnish-cache.org/about), it sits between Apache and the client, then it will cache requested pages and re-send them again when needed, isn't that the same thing Codeigniter does, or is it different from that?
Wouldn't it be a waste to cache each page twice, by Codeigniter and Vanish?

assuming they do the exact same thing(cache pages and re-send them to the user),which one is *more* efficient for dynamic(database driver) websites?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T01:12:20.300

从表面上看，它们做同样的事情，但是不同级别的缓存有适当的用途。

像 Varnish 这样位于 Web 服务器和应用程序之间的缓存提供了非常高的性能。您可以将它用于 CSS 等静态内容、静态页面和很少更改的动态内容。

应用程序缓存提供了一个性能较差但灵活得多的选项。通常您可以按时间缓存，也可以按“当前用户”等应用程序/请求变量进行缓存。这允许您提供具有更多精细控制的*状态相关缓存。*例如，您可以根据对象在数据库中的最后修改时间来缓存对象的详细信息页面。

# android - 在 onCreate 中立即返回——可以吗？

> ID：11093106
> 
> 赞同：0
> 
> 时间：2012-06-19T01:04:31.067
> 
> 标签：android

我有一个应该只创建一次的活动。也就是`onCreate`只能调用一次。如果再次调用它，我希望 Activity 什么也不做。

是否建议执行以下操作？

```
protected void onCreate(Bundle savedInstanceState) {
    this.setTheme(android.R.style.Theme_Translucent_NoTitleBar_Fullscreen);
    super.onCreate(savedInstanceState);

    if(onCreateWasCalledAlreadyBoolean) {
        setResult(RESULT_OK);
        finish();
        return;
    }

    //Do other stuff here
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T04:19:35.507

我假设您了解[活动生命周期的工作原理](http://developer.android.com/reference/android/app/Activity.html#ActivityLifecycle)。我的意思是，您并没有试图避免在这里不适用的东西（认为它`onCreate`可能会被多次调用，只要它只是`onRestart`s 等等）。

从技术上讲，它完全没问题。

但是，如果根本不应该创建活动，那么您应该更多地担心*为什么*需要再次调用活动（“ *A* ”），如果那是您的想法。

如果您发现自己正在检查您的活动*A*是否已被“调用”（？），这可能意味着前一个活动（“ *B* ”）在应用程序的逻辑流程中存在错误，而*B*应该检查是否它实际上必须启动该活动*A*。我的意思是，如果您需要决定是否必须调用活动，请在开始*之前进行*检查。

如果您要重新启动活动（例如：回家，然后返回），我认为这不适用，但是您应该再次从离开的地方重新启动它（我可以告诉*B ）。*您不会导航回*A*。而且你没有提供太多细节，所以我猜这是某种闪屏，就像 evilmage93 说的那样。

如果这确实是某种闪屏，我建议在用户一路返回以从任务堆栈中删除您的应用程序时显示它（与他的建议相反）。换句话说，每当用户从其“前门”重新启动应用程序时。

虽然这最终是一个设计决定，但我更喜欢在应用程序第一次在堆栈中加载（“进入”）时看到启动画面，如果您（显然）在调用*B之前完成**A*（启动画面应该在完成后自动出现，即使在第一次运行时也是如此）。这是一个一致性问题：只要用户执行相同的任务（从其“前门”启动应用程序），相同的应用程序应该以相同的方式运行。*`finish`*

 *不过，我回答了您的问题，涵盖了一些一般方面，因为您以这种方式提问。

// 编辑：

最后，通过查看，`onCreateWasCalledAlreadyBoolean`恐怕您可能正在尝试重新发明活动生命周期机制的一部分。在这种情况下，不要：继续您的常规活动逻辑，因为用户期望这种行为。*一般来说*，我不建议人们仅仅因为它被系统杀死并重新启动而中断活动的正常加载。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-19T01:17:43.673

我不明白为什么不。不重新启动活动不是更简单吗？

你担心什么不好？性能..未捕获的异常..代码清晰？*

# winforms - 用于 Windows 窗体的 Castle Windsor 中的自定义属性注入

> ID：11093109
> 
> 赞同：0
> 
> 时间：2012-06-19T01:04:56.653
> 
> 标签：winforms, castle-windsor

我有一个使用 MVP 模式的 Windows 窗体应用程序。每个视图都是一个 WinForms 用户控件，并由处理非 UI 问题的演示者支持。该应用程序使用 Castle Windsor，所有视图呈现器和许多其他组件都通过 Windsor Container 解决。

我想做的是为用户控件视图自定义属性注入。我的观点并没有大量使用属性注入，但它偶尔会非常有用并且效果很好。问题是，我的用户控件通常包含嵌套控件，而嵌套控件又可以包含其他嵌套控件，并且属性注入不适用于这些嵌套控件，因为它们不是通过容器直接解决的。

我想做的是为从 SWF`Control`类继承的组件配置属性注入。除了在组件上查找属性之外，我还想在嵌套控件（在`Controls`）集合中查找属性，并将其注入到这些嵌套属性中。

我知道 Castle Windsor 非常灵活且可配置，因此这可能是可能的。不过，我需要在正确的方向上稍微推动一下。这可能吗？有没有人试图做类似的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T13:30:05.427

如果我正确理解了您的问题，我认为实现您想要的唯一方法是通过某种穷人的依赖注入（是的，有争议的 - 请不要对我投反对票！）因为 winforms 设计器生成方法的方式构造您所说的各种子控件，这对 IoC 毫无帮助。

我不确定你是否能够进行属性注入，但你可以使用构造函数，这是我刚刚炮制的一个脑筋急转弯的方案......

首先，创建一些方法来访问您的 Windsor 容器——这样的事情可能会奏效：

```
public static class MyContainer
{
    private static readonly IWindsorContainer _container = Bootstrap();

    // I did it like this so that there is no explicit dependency
    // on Windsor - this would be the only place you need to change
    // if you want an alternate container (how much you care about
    // that is up to you)
    public static T Resolve<T>()
    {
        return _container.Resolve<T>();
    }

    private static IWindsorContainer Bootstrap()
    {
        var container = new WindsorContainer();
        container.Install(FromAssembly.This());

        // ... whatever else you need to do here

        return container;
    }
} 
```

其次，在内部控件中，您希望注入一些属性执行类似的操作（我选择了好的 ol' ILogger 作为您可能想要注入的示例）：

```
public partial class MyFancyControl : UserControl
{    
    // Constructor to keep the winforms designer happy
    public MyFancyControl() 
        : this (MyContainer.Resolve<ILogger>())
    {
        // Intentionally always blank as this 
        // is an un-unit-testable method
    }

    // Constructor that does the actual work
    public MyFancyControl(ILogger logger)
    {
        InitializeComponent();
        Logger = logger;
    }

    public ILogger Logger { get; private set; }
} 
```

*注意：使用记录器会引发一些明显的气味之一 - 有时您根本没有向容器注册这样的组件（通常您有一个空记录器），因此您可能需要连接某种机制那个，但如果你需要它，我把它留给你。*

# java - 由于在初始化时捕获异常，局部变量无法定义为最终变量

> ID：11093112
> 
> 赞同：2
> 
> 时间：2012-06-19T01:05:05.300
> 
> 标签：java, exception-handling, refactoring, final

我通常喜欢将我的局部变量声明为 final，但是当我必须在初始化期间处理异常时，我会看到重复的模式，我无法做到这一点。

例如，我有以下代码：

```
final Client myClient = library.getClient("service");
//do a bunch of steps with myClient 
```

但我最终经常像这样修改它：

```
Client myClient = null;
try {
    myClient = library.getClient("service");
} catch (someException ex) {
    // handle
    throw ex;
}
// do stuff with myClient 
```

我不想在我做完所有事情之后添加捕获，因为它在接近尾声时变得有点难以理解。那么有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T01:09:30.143

您可以将 try/catch 放在单独的方法中：

```
. . .
    final Client myClient = getClient();

private Client getClient() {
    try {
        return library.getClient("service");
    catch (someException ex) {
        // handle
        return null;
    }
} 
```

如果在调用 的方法中继续处理没有意义`getClient()`，那么另一个选择是声明它抛出异常并摆脱 try/catch 块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T01:41:34.103

对于这种特殊情况，您可以使用[空白 final](https://en.wikipedia.org/wiki/Final_%28Java%29#Blank_final)：

```
final Client myClient;  // Note the lack of initialization here!
try {
    myClient = library.getClient("service");
} catch (someException ex) {
    // handle
    throw ex;
}
// do stuff with myClient 
```

您不必在声明 final 变量时对其进行初始化，只要它在可能最终被使用的每个代码路径上仅初始化一次即可。

这仅在您的`catch`块终止方法（通过`return`或另一个`throw`）时才有效 - 您不能为 分配一些其他后备值`myClient`，因为它可能已经在`try`块中分配，违反了单一初始化规则。

Blank finals 对于根据条件以不同方式初始化某些东西也很有用：

```
final Client myClient;
if (someCondition) {
    myClient = foo();
}
else {
    myClient = bar();
}
// do stuff with myClient 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-19T01:11:52.957

将代码放入构造函数中：

```
final Client myClient;

public MyClass() throws SomeException {
    myClient = library.getClient("service");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-19T01:09:22.527

当然，至少有两个微不足道的选择：

*   您可以包装`RuntimeException`s 并决定何时/是否要处理它。
*   您可以适当地重构并将异常处理移出主线代码。

两者都有优点和缺点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-19T01:14:54.167

您可以将代码的不同部分拆分为方法并将 myClient 作为最终变量移交...您还可以将所有代码添加到一个 try 块中并抛出和处理不同的异常。这是可能的，如果您不需要异常部分中的 var ......全局变量也可能是一个解决方案，但不是一个好的解决方案......有一个地面角色。如果您看不懂代码，请将其拆分为方法和类

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-19T01:15:55.593

作为包装`getClient`代码的替代方法（在别处提到），您可以包装`doStuff`代码：

```
try {
    doStuff( library.getClient("service") );
} catch (someException ex) {
    // handle
    throw ex;
}

public void doStuff(final Client myClient) {
    // do stuff
} 
```

或者你可以结合这两种方法：

```
try {
    doStuff( getClient() );
} catch (someException ex) {
    // handle
    throw ex;
} 
```

# ruby-on-rails - 设计、Omniauth 和 Facebook 集成会话错误

> ID：11093120
> 
> 赞同：4
> 
> 时间：2012-06-19T01:06:46.480
> 
> 标签：ruby-on-rails, devise, omniauth

我是 Rails 新手，正在安装我的第一个集成 Facebook 登录/注册的应用程序。我关注了发布在这里的 Ryan Bates 的 RailsCast 视频：[https](https://stackoverflow.com/a/4954443/1302333) ://stackoverflow.com/a/4954443/1302333 。

我按照他的集成 Twitter 的教程进行操作，但我在使用 Facebook 时遇到了问题。当我访问时，`http://localhost:3000/auth/facebook`我收到此错误：

```
NoMethodError in AuthenticationsController#create
undefined method `serialize_into_session' for Symbol:Class 
```

这是完整的跟踪：

```
devise (2.1.0) lib/devise/rails/warden_compat.rb:19:in `serialize'
warden (1.1.1) lib/warden/session_serializer.rb:25:in `store'
warden (1.1.1) lib/warden/proxy.rb:161:in `set_user'
devise (2.1.0) lib/devise/controllers/helpers.rb:124:in `sign_in'
devise (2.1.0) lib/devise/controllers/helpers.rb:236:in `sign_in_and_redirect'
app/controllers/authentications_controller.rb:11:in `create'
actionpack (3.2.6) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
actionpack (3.2.6) lib/abstract_controller/base.rb:167:in `process_action'
actionpack (3.2.6) lib/action_controller/metal/rendering.rb:10:in `process_action'
actionpack (3.2.6) lib/abstract_controller/callbacks.rb:18:in `block in process_action'
activesupport (3.2.6) lib/active_support/callbacks.rb:414:in `_run__1508312784814672110__process_action__3616665370535505566__callbacks'
activesupport (3.2.6) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.6) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
activesupport (3.2.6) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.6) lib/abstract_controller/callbacks.rb:17:in `process_action'
actionpack (3.2.6) lib/action_controller/metal/rescue.rb:29:in `process_action'
actionpack (3.2.6) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
activesupport (3.2.6) lib/active_support/notifications.rb:123:in `block in instrument'
activesupport (3.2.6) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.6) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.6) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
actionpack (3.2.6) lib/action_controller/metal/params_wrapper.rb:206:in `process_action'
activerecord (3.2.6) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (3.2.6) lib/abstract_controller/base.rb:121:in `process'
actionpack (3.2.6) lib/abstract_controller/rendering.rb:45:in `process'
actionpack (3.2.6) lib/action_controller/metal.rb:203:in `dispatch'
actionpack (3.2.6) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
actionpack (3.2.6) lib/action_controller/metal.rb:246:in `block in action'
actionpack (3.2.6) lib/action_dispatch/routing/route_set.rb:73:in `call'
actionpack (3.2.6) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
actionpack (3.2.6) lib/action_dispatch/routing/route_set.rb:36:in `call'
journey (1.0.3) lib/journey/router.rb:68:in `block in call'
journey (1.0.3) lib/journey/router.rb:56:in `each'
journey (1.0.3) lib/journey/router.rb:56:in `call'
actionpack (3.2.6) lib/action_dispatch/routing/route_set.rb:600:in `call'
omniauth (1.1.0) lib/omniauth/strategy.rb:392:in `call_app!'
omniauth (1.1.0) lib/omniauth/strategy.rb:354:in `callback_phase'
omniauth-oauth2 (1.0.2) lib/omniauth/strategies/oauth2.rb:65:in `callback_phase'
omniauth (1.1.0) lib/omniauth/strategy.rb:219:in `callback_call'
omniauth (1.1.0) lib/omniauth/strategy.rb:175:in `call!'
omniauth (1.1.0) lib/omniauth/strategy.rb:157:in `call'
omniauth (1.1.0) lib/omniauth/strategy.rb:177:in `call!'
omniauth (1.1.0) lib/omniauth/strategy.rb:157:in `call'
omniauth (1.1.0) lib/omniauth/builder.rb:48:in `call'
warden (1.1.1) lib/warden/manager.rb:35:in `block in call'
warden (1.1.1) lib/warden/manager.rb:34:in `catch'
warden (1.1.1) lib/warden/manager.rb:34:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.4.1) lib/rack/etag.rb:23:in `call'
rack (1.4.1) lib/rack/conditionalget.rb:25:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/head.rb:14:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/flash.rb:242:in `call'
rack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'
rack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/cookies.rb:338:in `call'
activerecord (3.2.6) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.6) lib/active_record/connection_adapters/abstract/connection_pool.rb:473:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.6) lib/active_support/callbacks.rb:405:in `_run__2824763875952710462__call__1302249347533121180__callbacks'
activesupport (3.2.6) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.6) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.6) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.6) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.6) lib/rails/rack/logger.rb:26:in `call_app'
railties (3.2.6) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.1) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.6) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.1) lib/rack/lock.rb:15:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/static.rb:62:in `call'
railties (3.2.6) lib/rails/engine.rb:479:in `call'
railties (3.2.6) lib/rails/application.rb:220:in `call'
rack (1.4.1) lib/rack/content_length.rb:14:in `call'
railties (3.2.6) lib/rails/rack/log_tailer.rb:17:in `call'
rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'
/Users/felixthea/.rvm/rubies/ruby-1.9.2-p136/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'
/Users/felixthea/.rvm/rubies/ruby-1.9.2-p136/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'
/Users/felixthea/.rvm/rubies/ruby-1.9.2-p136/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread' 
```

和 authentications_controller.rb 文件：

```
class AuthenticationsController < ApplicationController
  def index
    @authentications = current_user.authentications if current_user
  end

  def create
    omniauth = request.env["omniauth.auth"]
    authentication = Authentication.find_by_provider_and_uid(omniauth['provider'], omniauth['uid'])
    if authentication
      flash[:notice] = "Signed in successfully."
      sign_in_and_redirect(:user, authentication.user)
    elsif current_user
      current_user.authentications.create!(:provider => omniauth['provider'], :uid => omniauth['uid'])
      flash[:notice] = "Authentication successful."
      redirect_to authentications_url
    else
      user = User.new
      user.apply_omniauth(omniauth)
      if user.save
        flash[:notice] = "Signed in successfully."
        sign_in_and_redirect(:user, user)
      else
        session[:omniauth] = omniauth.except('extra')
        redirect_to new_user_registration_url
      end
    end
  end

  def destroy
    @authentication = current_user.authentications.find(params[:id])
    @authentication.destroy
    redirect_to authentications_url, :notice => "Successfully destroyed authentication."
  end

protected

# This is necessary since Rails 3.0.4
# See https://github.com/intridea/omniauth/issues/185
# and http://www.arailsdemo.com/posts/44
def handle_unverified_request
 true
end

end 
```

任何帮助，将不胜感激！

谢谢菲利克斯

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-19T08:33:48.083

您正在使用旧的教程版本。

如果您使用的是 devise 2.0 或更高版本，则步骤如下：

**1º**在你的`config/initializers/devise.rb`

```
require "omniauth-facebook"
config.omniauth :facebook, "YOUR_APP_ID", "YOUR_APP_SECRET", :strategy_class => OmniAuth::Strategies::Facebook 
```

**2º**您必须安装此宝石：

```
gem 'omniauth'
gem 'omniauth-facebook'
gem 'oauth2' 
```

**3º**在您的`user.rb`模型中添加模块`:omniauthable`，例如：

```
class User
 # Include default devise modules. Others available are:
 # :token_authenticatable, :encryptable, :confirmable, :lockable, :timeoutable, :omniauthable and :invitable
  devise :database_authenticatable, :registerable, :confirmable,
         :recoverable, :rememberable, :trackable, :validatable, :omniauthable
end 
```

**4º**在你的`routes.rb`

```
devise_for :users,  :controllers => { :omniauth_callbacks => "users/omniauth_callbacks", :registrations => "registrations" } do 
```

**5º**在您的控制器文件夹中创建一个文件`users`夹，之后您必须在其中创建一个文件`app/controllers/users/omniauth_callbacks_controller.rb`

在这个`omniauth_callbacks_controller.rb`

```
class Users::OmniauthCallbacksController < Devise::OmniauthCallbacksController
  def facebook

     # with this code you can see the data sent by facebook
     omniauth = request.env["omniauth.auth"] 

    @user = User.find_for_facebook_oauth(request.env["omniauth.auth"], current_user)

    if @user.persisted?
      flash[:notice] = I18n.t "devise.omniauth_callbacks.success", :kind => "Facebook"
      sign_in_and_redirect @user, :event => :authentication
    else
      session["devise.facebook_data"] = request.env["omniauth.auth"]
      redirect_to new_user_registration_url
    end
   end
end 
```

**6º**在你的**user.rb**模型的末尾添加这两个方法：

```
def self.find_for_facebook_oauth(auth, signed_in_resource=nil)
  user = User.where(:provider => auth.provider, :uid => auth.uid).first
  unless user
    user = User.create(name:auth.extra.raw_info.name,
                         provider:auth.provider,
                         uid:auth.uid,
                         email:auth.info.email,
                         password:Devise.friendly_token[0,20]
                         )
  end
  user
end

def self.new_with_session(params, session)
    super.tap do |user|
      if data = session["devise.facebook_data"] && session["devise.facebook_data"]["extra"]["user_hash"]
        user.email = data["email"]
      end
    end
  end 
```

**7º**最后，您必须添加一个链接以连接 facebook：

在`devise/registrations/new.html.erb`你必须添加：

```
<%= link_to "Sign in with Facebook", user_omniauth_authorize_path(:facebook) %> 
```

就这样。我希望它会有所帮助！问候

# linux - 在 Linux 中运行 .pkg 文件

> ID：11093123
> 
> 赞同：14
> 
> 时间：2012-06-19T01:07:22.830
> 
> 标签：linux, ubuntu, fedora

`.pkg`是否可以在 Ubuntu 或 Fedora中运行文件。如果是这样，我该如何开始？

什么是[.pkg](https://en.wikipedia.org/wiki/.pkg)文件？它是 Mac 系统中使用的一种文件格式（Apple Inc.）

是否有任何替代方案可以`.pkg`在 Linux 发行版中运行文件？（特别是 Ubuntu 或 Fedora，我在两个发行版中都使用最新版本）。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-19T01:39:34.297

[`xar`您可以使用归档器](http://code.google.com/p/xar/)解压缩 Xar 格式；也许[`ark`](http://www.kde.org/)归档前端也可以处理 Xar 格式，因为它链接到`libarchive12`，它为 Xar 格式提供只读支持。

[OS X 使用 Mach-O 可执行格式](http://en.wikipedia.org/wiki/Mach-O)，而 Linux 使用[ELF](http://en.wikipedia.org/wiki/Executable_and_Linkable_Format)。（好吧，Linux 也可以读取一些过时的[a.out 格式的文件](http://en.wikipedia.org/wiki/A.out)，但是这种格式在现代 Linux 系统上实际上已经死了。）[有一个用于 Linux 的实验性 Mach-O 加载程序](http://shinh.skr.jp/slide/ldmac/001.html)，但在这一点上听起来确实像个*玩具*。（您还需要应用程序使用的*库*才能实际*运行程序*——这将是另一个复杂因素。）

所以：是的，你可以打开它们。不，您不能简单地在 Linux 上运行 OS X 应用程序。

# php - PHP编辑字符串中间不起作用？

> ID：11093125
> 
> 赞同：0
> 
> 时间：2012-06-19T01:08:14.080
> 
> 标签：php, string, parsing, scripting

好的，基本上我想做的是在不使用正则表达式的情况下创建一种 BB 代码系统。我在下面使用的代码似乎可以完美运行，尽管它不是。基本上，代码应该采用一个字符串并从所有 [code][/code] 块中删除所有中断标记，并将其替换回整个字符串。然后代码应该将 [code][/code] 标签转换为我正在使用的 SyntaxHighlighter 脚本的“pre”标签。

不幸的是，代码并不能完全 100% 工作。在某些情况下，它仍会将中断标记留在 [code][/code] 块内。我的代码是：

```
<?php
$string = "Hello\n[code]\nCode One\n[/code]\n[code]\nCode Two\n[/code]\n[code]\nCode    Three\n[/code]";
$string = nl2br($string);
$openArray = array();
$closeArray = array();
$original = "";
$newString = "";

$i = 0;
if(strpos($string, "[code]") === 0) {
    array_push($openArray, 0);
}
while($i = strpos($string, "[code]", $i + 1)) {
    array_push($openArray, $i);
}
while($i = strpos($string, "[/code]", $i + 1)) {
    array_push($closeArray, $i + 7);    
}
for($j = 0; $j < count($openArray); $j++) {
    $length = $closeArray[$j] - $openArray[$j];
    $original = substr($string, $openArray[$j], $length);
    $newString = strip_tags($original);
    $string = str_replace($original, $newString, $string);
}
$string = str_replace("[code]", '<pre class="brush: plain">', $string);
$string = str_replace("[/code]", '</pre>', $string);
echo $string;
?> 
```

非常感谢所有答案，因为我一直想知道这有什么问题已经有一段时间了，我尝试了许多不同的方法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T02:01:49.283

我在您的处理中看到的主要问题是您存储的打开和关闭标签非常独立。然后您稍后处理它们，就好像每个都属于彼此一样，但这不能保证，因为您不验证关闭代码是否遵循打开代码，如果不是两个打开或关闭代码，则应该给出解析错误。

你可以给自己写一个小辅助函数，像 strpos 一样，返回一个打开和关闭代码对的下一个位置：

```
function codepos($string, $code, $offset) {
    $offset = 0;
    if (FALSE === $start = strpos($string, "[$code]", $offset)) {
        return FALSE;
    }
    if (FALSE === $stop = strpos($string, "[/$code]", $start) {
        throw new Exception('Close code not found.');
    }
    if ($next = strpos($string, "[$code]", $start + 1) && $next < $stop) {
        throw new Exception('Double opening detected.');
    } 
    $pos = new stdClass;
    $pos->start = $start;
    $pos->stop = $stop;
    $pos->code = $code;
    return $pos;
} 
```

然后更容易处理此更改，因为您已经知道事情井井有条。您可以运行 FALSE 并以不同的方式发出通知，而不是抛出异常。并且此例程尚未在第一个起始代码之前检查结束代码。

```
$offset = 0;
while($pos = codepos($string, 'code', $offset))
{
    ... process each code-pair.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T02:14:39.807

仅用于学习或内网工具，甚至不考虑在 www 上：

您需要考虑：
行可能比字符串缓冲区长。除非您围绕它进行编码，否则您将拥有最大行大小。

打开标签之前可能的关闭标签的代码以及可能缺少的关闭/打开标签，除非您假设输入总是正确的。

能够处理以下情况：
State1 寻找一个或多个打开标签：
没有打开/关闭标签
仅打开标签
首先关闭标签 - 解析失败
一个或多个匹配的打开/关闭标签（按正确顺序）
一个或多个匹配的打开/以打开标签结尾的关闭标签（按正确顺序）
文档结束 - OK
State2 正在寻找关闭标签：
关闭标签后跟一个或多个匹配的打开/关闭标签（按正确顺序）
关闭标签后跟一个或多个匹配的打开/关闭标签（按正确顺序） 以打开标签结尾
没有关闭标签
文档结束 - 解析失败

# javascript - 在 Android 应用程序中抓取动态生成的 html

> ID：11093130
> 
> 赞同：4
> 
> 时间：2012-06-19T01:08:50.620
> 
> 标签：javascript, android, html, web-scraping

我目前正在编写一个 Android 应用程序，除其他外，它使用来自我不拥有的网站的文本信息。此外，有些页面需要认证。

对于某些页面，我已经能够使用 BasicNameValuePairs 和带有关联对象的 HTTPClient 登录并检索 html 代码。

不幸的是，这些方法在没有运行浏览器（甚至 Android Webview）通常会运行的任何 javascript 函数的情况下检索网页源。我需要其中一些脚本正在检索的文本。

我已经完成了我的研究，但我发现的一切都是猜测并且非常混乱。我可以暂时忽略需要登录的页面。此外，我愿意发布任何可能对构建解决方案有用的代码；这是一个独立的项目。

从javascript调用中抓取html结果的任何具体解决方案？一个例子绝对是一流的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-19T23:32:10.967

最终成功：

*   犀牛。使用[了这个 jar 文件](http://code.google.com/p/android-scripting/source/browse/rhino/rhino1_7R2.jar)。

我尝试过的其他事情：

*   Android提供的 [HttpClient](http://developer.android.com/reference/org/apache/http/client/HttpClient.html)
    *   无法运行 javascript
*   [html单元](http://htmlunit.sourceforge.net/)
    *   4小时，没有成功。也很大，在我的 apk 中增加了 12 mb。
*   [SL4A](https://code.google.com/p/android-scripting/source/browse/)
    *   终于编译好了。使用[本](http://jokar-johnk.blogspot.com/2011/02/how-to-make-android-app-with-sl4a.html?showComment=1340239031200#c5290878266488959337)指南进行设置。被遗弃为一个简单的犀牛罐子的过度杀伤力。

可能有用的东西：

*   硒

进一步的结果将被公布。如果发布其他结果将被添加。

注意：上面列出的许多选项相互引用。我认为 rhino 包含在 sl4a 和 htmlunit 中。另外，我认为 htmlunit 包含硒。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-26T01:32:00.437

上述解决方案非常慢，并且将您限制为 1 个 url（嗯，不是真的，但我敢当您的用户不耐烦地等待结果时，您可以使用 Rhino 抓取 10 个 url）。

另一种方法是使用云抓取解决方案。您不会在下载不会使用的内容时浪费手机带宽。

试试这个解决方案：[Bobik Java SDK](https://github.com/emirkin/bobik_java_sdk)

它使您能够在几秒钟内抓取多达数百个站点

# c++ - pthread 输入线程和工作线程同步

> ID：11093139
> 
> 赞同：0
> 
> 时间：2012-06-19T01:09:39.340
> 
> 标签：c++, multithreading, pthreads, pthread-join

我有两个 pthread，其中一个正在从 cin 读取并将其放入 QUEUE，另一个是工作线程，每 2 秒检查一次 QUEUE，如果其中有内容，则打印一些内容。

这是我的主要内容：

```
#include <string>
#include <queue>
#include <iostream>
#include <stdio.h>
#include "Thread.h"
#include "Mutex.h"

using namespace std;

queue<string> lineup;
Mutex lock;

class InputReader:public Thread{
    private:
        string buffer;
    protected:
        virtual void run(){
            while(true){
                cout << "Please Enter some Text:\n" ;
                getline(cin,buffer);
                lock.lock();
                lineup.push(buffer);
                lock.unlock();
            }
        }
    public:
        InputReader(){}
        ~InputReader(){}
};

class Request: public Thread{
    protected:
        virtual void run(){
            while(true){
                sleep(2);
                lock.lock();
                if ((int)(lineup.size())>0){
                    cout << "Sending Request: " << lineup.front() << endl;
                    lineup.pop();
                }
                else{
                    cout << "Nothing to send!" <<endl;
                }
                lock.unlock();

            }
        }
    public:
        Request(){}
        ~Request(){}
};

int main(){
    Request rq;InputReader iread; 
    iread.start();  rq.start();
    iread.join(); rq.join();

    return 0;
} 
```

其中 Thread.h 和 Thread.cpp 是：

```
#ifndef __THREAD_H__
#define __THREAD_H__
#include <pthread.h>

class Thread
{
    private:
        pthread_t thread;
        static void * dispatch(void *);
    protected:
        virtual void run() = 0;
    public:
        virtual ~Thread();
        void start();
        void join();
};

#endif

//  THREAD.CPP
#include "Thread.h"

Thread::~Thread(){}

void * Thread::dispatch(void * ptr)
{
    if (!ptr) return 0;
    static_cast<Thread *>(ptr)->run();
    pthread_exit(ptr);
    return 0;
}

void Thread::start(){
    pthread_create(&thread, 0, Thread::dispatch, this);
}

void Thread::join()
{
    pthread_join(thread, 0);
} 
```

Mutex.h 和 Mutex.cpp：

```
#ifndef __MUTEX_H__
#define __MUTEX_H__
#include <pthread.h>

class Mutex
{
private:
    pthread_mutex_t mutex;
public:
    Mutex();
    ~Mutex();
    void lock();
    void unlock();
    bool trylock();
};

#endif

// MUTEX.CPP -----------------------
#include "Mutex.h"
Mutex::Mutex(){
       pthread_mutex_init(&mutex, 0);
   }
   Mutex::~Mutex(){
      pthread_mutex_destroy(&mutex);
  }
  void Mutex::lock(){
      pthread_mutex_lock(&mutex);
  }
  void Mutex::unlock(){
      pthread_mutex_unlock(&mutex);
  }
  bool Mutex::trylock()  {
      return (pthread_mutex_trylock(&mutex) == 0);
  } 
```

问题是一旦它在无限循环中等待 iread 线程中的标准输入，rq 线程就永远不会启动。事实上，无论哪个 .start() 先出现，它都会被困在其中……有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T04:21:56.427

原来我需要使用**-lpthread**选项运行**g++ 。**有谁知道为什么默认情况下不启用？

# javascript - 如何创建自定义形状的图表？

> ID：11093141
> 
> 赞同：0
> 
> 时间：2012-06-19T01:09:49.883
> 
> 标签：javascript, css, graph, charts, raphael

我需要创建一个具有自定义形状的图形。例如：为了代表人口，我需要创建一个人形，在其中我将显示统计数据和数据。是否有任何 javascript 库可以帮助我做到这一点？D3 js会帮助我吗？

任何帮助表示赞赏。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-07-02T17:48:24.653

您甚至可以尝试使用这种使用两个图像并相互叠加的方法。

假设您想要一个人类字体图标作为图表，使用[http://fa2png.io/](http://fa2png.io/)将图标转换为 .png 图像，然后在下面的代码中使用它。

[http://codepen.io/FDfranklin/pen/yGbCK](http://codepen.io/FDfranklin/pen/yGbCK)

```
<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<div class="container">
    <div class="bw"></div>
    <div class="show"></div>
    <div id="bar" data-total="100">
        <div class="text">Currently at <br/><span>70</span><br><i>Click To Give</div>
    </div>
</div> 
```

@import url( [http://fonts.googleapis.com/css?family=Concert+One](http://fonts.googleapis.com/css?family=Concert+One) );

```
html, body {
  margin: 0 auto;
}

.container {
  width:450px;
  height:328px;
  position:relative;
  display:inline-block;
  vertical-align:top;
  background-clip:content-box;
}
.bw {
  width:100%;
  height:100%;
  position:absolute;
  bottom:0; background:url(http://fdfranklin.com/usf-bull-bw.png) fixed left top;
  background-clip:content-box;
}
.show {
  width:100%;
  height:0%;
  position:absolute;
  bottom:0; background:url(http://fdfranklin.com/usf-bull.png) fixed left top;
  background-clip:content-box;
}

#bar {
  width: 100%;
  height: 0%;
  position: absolute;
  bottom: 0;
  border-top: 1px dashed black;

  .load {
      opacity: 1;
    }

  div {
    position: absolute;
    line-height: 22px;
    width: 110px;
    top: -40px;
    right: -113px;
    font-family: arial, sans-serif;
    font-size: 16px;
    text-align: center;
    color: white;
    cursor: pointer;
    border: 1px solid #ccc;
    border-radius: 8px;
    background: #2f574b;
    transition: background 700ms ease-in-out;
    opacity: 0;
    -webkit-transition: opacity 3s ease-in, background 700ms ease-in-out;
    -moz-transition: opacity 3s ease-in, background 700ms ease-in-out;
    -o-transition: opacity 3s ease-in, background 700ms ease-in-out;
    -ms-transition: opacity 3s ease-in, background 700ms ease-in-out;
    transition: opacity 3s ease-in, background 700ms ease-in-out;

      &:hover {
      background: #B1A875;
    }

    span {
      font-family: 'Concert One', sans-serif;
      line-height: 30px;
      font-size: 34px;
      color: #white;;
    }
  }
} 
```

```
<script>
percent = $('#bar div span').html();
total = $('#bar').attr('data-total');
percentStart = 0;

setInterval(function() {
  $('.show').css('height',percentStart/total*100+'%');
  $('#bar').css('height',percentStart/total*100+'%');
  $('#bar div span').html('%'+percentStart);
  if(percentStart<percent) {percentStart=percentStart+1;}
},35);

$("#bar div").addClass("load");

</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T01:17:33.700

我不知道“人形”的东西，我认为没有任何工具可以做到这一点。

然而，我遇到的最好和最接近的资源是[Highcharts](http://www.highcharts.com/)它有各种各样的饼图、样条曲线、条形图等。您需要交互式地绘制数据。

我还建议您查看[Google Charts](https://developers.google.com/chart/)。Highcharts 不提供的一件事是基于地图的数据绘图。谷歌有一种称为[GeoMap](https://developers.google.com/chart/interactive/docs/gallery/geomap)的东西，用于绘制数据，其位置与全球某个小镇一样具体

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T17:55:04.043

或者，一种简单的方法是设置重复的背景图像并根据您的计数更改 DIV 宽度/高度。好处是在任何浏览器中几乎没有性能损失，因为 DIV 高度和重复图像背景都经过了相当优化。

![两个 div：不间断和部分](../Images/cac6436678b9acd59b3fd9cd931d3776.png)

想法是选择一个瓷砖尺寸（例如：25 x 11）并将其分成两个 DIV。在上图中，第一个 DIV 在视觉上负责两行，因为它们没有被分解（最大宽度）。第二个 DIV 显示最后一行，因为它的宽度表示部分数字。

```
function draw_guys( num, row_width ) {
    var whole = Math.floor( num / row_width ) * row_width;
    var rows = whole / row_width;
    var remainder = num - whole;

    // at this point, first div height should be 11 * rows,
    // and second div width should be remainder * 25
    // $("div1").css( ... etc.
} 
```

有关工作示例，请参阅此 Facebook IPO 计算器：[http ://www.voanews.com/content/how-long-would-it-take-you-to-earn-as-much-as-facebook-shareholders/667093 .html](http://www.voanews.com/content/how-long-would-it-take-you-to-earn-as-much-as-facebook-shareholders/667093.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-19T17:09:47.787

有许多 javascript 库可以用来编写这样的东西，但是如果您发现任何“人口图”的行为与您开箱即用的描述一样，我会感到惊讶。

我最近在 RaphaelJS 中做了很多工作，根据您的用例，您可以从头开始编写一个简单的图表，只需很少的工作。考虑一下：

```
var figurePath = "m67.55634,478.32968c-8.13657,-2.48874 -14.5806,-8.08679 -16.4212,-14.26556c-0.73347,-2.46204 -1.08294,-52.8298 -1.08687,-156.62885l-0.00574,-152.99986l-4.12245,0l-4.12245,0l0,57.75455c0,56.61781 -0.04195,57.82326 -2.13101,61.24794c-2.70588,4.43591 -5.74459,6.5144 -11.69161,7.99719c-8.79226,2.19217 -18.40762,-1.9938 -21.86059,-9.51678c-2.22165,-4.84039 -2.07695,-133.9393 0.15908,-141.94215c5.04025,-18.03902 21.36259,-32.81751 40.39913,-36.578c10.0279,-1.98091 102.7426,-2.00536 112.74093,-0.02971c10.18434,2.01237 18.93166,6.56422 26.67169,13.87918c7.96135,7.52412 11.67772,13.62765 14.44972,23.73145c1.93217,7.04254 2.03873,10.81412 2.03873,72.15891c0,56.07582 -0.21188,65.2007 -1.58522,68.26476c-2.13536,4.76425 -4.33276,6.9068 -9.23622,9.00589c-8.13713,3.48325 -18.47925,1.24234 -23.2908,-5.04663l-2.47462,-3.23438l-0.28067,-58.8461l-0.2807,-58.84612l-4.09941,0l-4.09944,0l0,153.75127c0,168.54004 0.40904,157.34918 -5.98071,163.62524c-5.04742,4.95758 -10.19456,6.83295 -18.75407,6.83295c-8.55949,0 -13.70664,-1.87537 -18.75407,-6.83295c-6.26537,-6.1539 -5.98071,-1.38409 -5.98071,-100.21561l0,-90.34155l-4.12245,0l-4.12248,0l0,90.34155c0,73.62247 -0.25719,90.91376 -1.38974,93.4332c-2.07629,4.61884 -6.59314,9.17279 -11.33463,11.42776c-4.56992,2.17331 -14.94501,3.1835 -19.23141,1.87241zm23.18207,-395.70253c-12.45886,-4.14828 -20.1591,-10.54255 -25.6095,-21.26616c-3.01675,-5.93541 -3.23429,-7.07562 -3.23429,-16.95192c0,-9.99342 0.18727,-10.94311 3.33264,-16.8991c15.71025,-29.74877 61.06589,-29.82171 76.74945,-0.12342c3.24734,6.14913 3.39783,6.92425 3.39783,17.50292c0,10.17379 -0.23299,11.51108 -2.88087,16.53765c-4.4481,8.44392 -11.01797,14.60091 -19.99178,18.73535c-6.96733,3.21001 -8.73656,3.60972 -17.18201,3.8817c-7.08677,0.2282 -10.69254,-0.12219 -14.58147,-1.41702z";

var figure = canvas.path( figurePath )
    .attr( { fill: 'red', stroke: 'black', 'stroke-width': 3, transform: 'S0.86,0.85 0,0 T0,0', 'fill-opacity': 0, 'stroke-opacity': .5 } )
    .animate( { 'fill-opacity': 0.5, 'stroke-opacity': 1.0, transform: 'S1,1 0,0' }, 1000, '>', function()
        {
            var text = canvas.text( 100, 150, "Population:\n10,250" )
                            .attr( { 'font-size': 16, fill: 'black', stroke: 'none', 'font-weight': 400, 'font-family': 'Arial,Helvetica,sans-serif', 'fill-opacity': 0 } )
                            .animate( { 'fill-opacity': 1.0 }, 1000 );
        } );

var figure2 = canvas.path( figurePath )
    .attr( { fill: 'blue', stroke: 'black', 'stroke-width': 3, transform: 'S0.43,0.43 0,0 T250,125', 'fill-opacity': 0, 'stroke-opacity': .5 } )
    .animate( { 'fill-opacity': 0.5, 'stroke-opacity': 1.0, transform: 'S0.6,0.6 0,0 T250,100' }, 1000, '>', function()
        {
            var text = canvas.text( 312, 190, "Population:\n6,632" )
                            .attr( { 'font-size': 12, fill: 'black', stroke: 'none', 'font-weight': 400, 'font-family': 'Arial,Helvetica,sans-serif', 'fill-opacity': 0 } )
                            .animate( { 'fill-opacity': 1.0 }, 1000 );
        } ); 
```

或者，查看小提琴：

```
- http://jsfiddle.net/kevindivdbyzero/McSzB/
- http://jsfiddle.net/kevindivdbyzero/mSX8e/2/ 
```

# ios - 试图在自定义 UIButton 中获取图像以显示全尺寸？

> ID：11093142
> 
> 赞同：0
> 
> 时间：2012-06-19T01:09:56.440
> 
> 标签：ios, xcode, interface-builder

我在 Interface Builder 中添加了一个自定义 UIButton 并在视图控制器中创建了插座。

在我看来DidLoad 我正在尝试...

```
[photoButton setImage:managedObject.relatedImage.image forState:UIControlStateNormal];  
[photoButton.imageView setContentMode:UIViewContentModeRight]; 
```

它完全忽略了我的 setContentMode 部分并始终将其左对齐并将高度调整为 UIButton 高度的大小......

我想要的是它显示全尺寸和 UIButton 框架之外的任何东西都被切断......有人知道我在这里缺少什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T18:35:55.923

根据该类的[Apple Official Documentation](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImageView_Class/Reference/Reference.html#//apple_ref/doc/c_ref/UIImageView)，它`photoButton.imageView`是一个`UIImageView`并且它没有方法。`setContentMode:`

我相信你没有一个已经为你需要的东西编码的按钮行为。我建议您将`UIButton`类（或 a `UIView`）子类化并创建自己的绘图功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T13:18:10.617

最终将 UIImageView 放在空白 UIButton 下方以使其正常工作...

然后使用：

```
[photoImageView setContentMode:UIViewContentModeScaleAspectFill];
[photoImageView setClipsToBounds:YES]; 
```

# jquery - jQuery tabs - linking directly to a tab

> ID：11093145
> 
> 赞同：1
> 
> 时间：2012-06-19T01:10:35.533
> 
> 标签：jquery, jquery-ui, jquery-tabs

I have some jQuery tabs on a website and I am trying to make the tabs so they can be linked to directly.

What I mean by this is that, when a user enters a URL that includes the anchors for the tab, then when the page is loaded is should display that tab first.

My original jQuery code was gotten from [http://jqueryfordesigners.com/jquery-tabs/](http://jqueryfordesigners.com/jquery-tabs/) and did not include this ability. Here is the original code:

```
$(function () {
    var tabContainers = $('div.tabs > div');

    $('div.tabs ul.tabNavigation a').click(function () {
        tabContainers.hide().filter(this.hash).show();

        $('div.tabs ul.tabNavigation a').removeClass('selected');
        $(this).addClass('selected');

        return false;
    }).filter(':first').click();
}); 
```

I have modified the code to this:

```
$(function () {
    var tabs = [];
    var tabContainers = $('div.tabs > div');
    $('div.tabs ul.tabNavigation a').each(function () {
        if (this.pathname == window.location.pathname) {
            tabs.push(this);
            tabContainers.push($(this.hash).get(0));
        }
    });

// sniff for hash in url, and create filter search 
var selected = window.location.hash ? '[hash=' + window.location.hash + ']' : ':first'; 

$(tabs).click(function () {
    // hide all tabs
    $(tabContainers).hide().filter(this.hash).show();        
    // set up the selected class
    $(tabs).removeClass('selected');
    $(this).addClass('selected');        
    return false;
}).filter(selected).click();

}); 
```

This kind of works - when you link to the page with the anchor included in the URL, it brings you to the relevant tab's content, however, and other tabs are visible also (its not hidden the others) and the tab has also not been selected.

You can view an example of this:

No link to second tab, first one shown by default: `http://74.54.17.66/~innovarc/improve/success-stories/financial-performance/`

Trying to link directly to the second tab: `http://74.54.17.66/~innovarc/improve/success-stories/financial-performance/#financial-performance`

I have tried to figure out what is wrong with the jQuery code but I cannot figure it out. I would appreciate help with a solution

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T02:12:00.413

我编辑了您的代码以在此处创建一个工作示例（带有哈希的 URL）：

[http://chrisvillanueva.com/stackoverflow/tabs.html#financial-performance](http://chrisvillanueva.com/stackoverflow/tabs.html#financial-performance)

这是我如何使它工作的：

1.) 删除与“div.tabs ul.tabNavigation a”单击事件处理程序链接的 .filter() 和 .click() 方法。这些方法总是导致第一个选项卡获得焦点。

2.）像这样创建一个选定的选项卡哈希：

```
var selectedTab = window.location.hash ? window.location.hash : '#cost-improvement'; 
```

“selectedTab”将包含我们用于选项卡#id 引用的值。

3.) 然后用这些行初始化请求的选项卡：

```
//initalizes tab in url
  $('div.tabs ul.tabNavigation li'+selectedTab+' a').addClass('selected');
  tabContainers.hide().filter($(''+selectedTab+'-tab')).show(); 
```

4.) 在选项卡标记中，使用以下语法定义每个列表项元素：

```
<li id="financial-performance"><a href="#financial-performance-tab">Second</a></li> 
```

其中 li 包含唯一 id 并且锚元素引用相关选项卡。

5.) 像这样设置标签面板标记：

```
<div id="financial-performance-tab">
       <h2>Second</h2>
        .... 
```

当然，如果您查看我链接的页面的来源，它会有所帮助。它会给你更好的背景。

快速说明：有效的 url 哈希值为：

*   # 成本改进

*   # 财务绩效

*   # 更换管理层

# php - ISSET 错误使用 AJAX 将 Javascript 数组发送到 PHP

> ID：11093147
> 
> 赞同：0
> 
> 时间：2012-06-19T01:10:55.553
> 
> 标签：php, javascript, arrays, jquery

我想使用 AJAX 向 PHP 发送一个 Javascript 数组。这似乎是非常简单的代码，但我收到“No isset”消息。

```
<?php 

if (isset($_REQUEST['activitiesArray'])) {
echo 'YES isset';   
}else{
echo 'No isset';
}
?>

<!DOCTYPE html>
<html>
<head>

<script  src="http://code.jquery.com/jquery-latest.min.js"></script>
<script type="text/javascript">

var activities = ["thing1", "thing2", "thing3"];

$.ajax({        
   type: "POST",
   url: "JavatoDBase.php",
   data: { activitiesArray : activities },
     success: function() {
     $("#lengthQuestion").fadeOut('slow');        
     }
 }); 
```

Safari 显示以下内容，这表明 POST 正在运行

![在此处输入图像描述](../Images/f743bd81083a4631055e8dc0dbc24c52.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T02:08:33.667

如果你发出一个 ajax 请求，你应该返回一些你可以在 js 中使用的东西来确定它是如何进行的。您也只想加载响应，而不是整个页面 html 和所有。

试试这个：

```
<?php 

if (isset($_REQUEST['activitiesArray'])) {
  echo json_encode(
    array('status' => true)
  );
  exit(0);
}else{
echo 'No isset';
}
?>

<!DOCTYPE html>
<html>
<head>

<script  src="http://code.jquery.com/jquery-latest.min.js"></script>
<script type="text/javascript">
  var activities = ["thing1", "thing2", "thing3"];

  $.ajax({        
    type: "POST",
    url: "test.php",
    data: { activitiesArray : activities },
    dataType: 'json',
    success: function(data) {
      if(data.status === true) {
        alert('rad');
      }
      else {
        alert('bad');
      }
    }
  });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T16:31:26.163

我找到了答案。上面所有的代码都是帮助是PHP文件（我从PHP开始，然后是HTML）。然后，我将 PHP 拆分为它自己的（PHP 后缀）文件，并将 HTML 拆分为它自己的（HTML 后缀）文件。它就像一个魅力。谢谢你的帮助。

# mysql - 如何从文件名表中选择所有不同的文件扩展名？

> ID：11093148
> 
> 赞同：5
> 
> 时间：2012-06-19T01:10:58.887
> 
> 标签：mysql

我有一个大约 20k 文件名的表。如何选择不同扩展名的列表？文件扩展名可以被认为是最后一个后不区分大小写的字符串`.`

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-19T01:19:42.810

您可以使用 substring_index：

```
SELECT DISTINCT substring_index(column_containing_file_names,'.',-1) FROM table 
```

-1 表示它将开始搜索“。” 从右侧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T01:21:11.237

MySQL 和其他数据库中有一个非常酷和强大的功能是在选择数据示例时能够合并正则表达式语法

SELECT something FROM table WHERE column REGEXP 'regexp'

看到这个[http://www.tech-recipes.com/rx/484/use-regular-expressions-in-mysql-select-statements/](http://www.tech-recipes.com/rx/484/use-regular-expressions-in-mysql-select-statements/)

所以你可以写模式来选择你想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-01T05:51:51.757

@bnvdarklord 给出的答案是正确的，但它会在结果集中包含没有扩展名的文件名，因此如果您只想要扩展名模式，请使用以下查询。

```
SELECT DISTINCT substring_index(column_containing_file_names,'.',-1) FROM table where column_containing_file_names like '%.%'; 
```

# regex - 除了特定情况外，如何替换matlab中逗号的所有实例

> ID：11093150
> 
> 赞同：0
> 
> 时间：2012-06-19T01:11:10.917
> 
> 标签：regex, matlab, replace, comma

好的，这可能很容易，但我不经常使用 matlab，也无法通过缝合来正确地完成此操作。

我想要做的就是在可能的文本行中替换所有出现的逗号。

IE：

```
"3","0.998652","10.1.3.2","10.1.2.3","TCP","[TCP Port numbers reused] 49153 > 10 [SYN] Seq=4294967295 Win=65535 Len=0"
"4","1.002860","10.1.2.3","10.1.3.2","TCP","10 > 49153 [SYN, ACK] Seq=0 Ack=0 Win=65535 Len=0" 
```

在上面的几行中，您可以看到几乎每次出现的逗号都被引号 (",") 包围。我想要做的就是把它们留在里面，但是使用Matlab用空格替换所有没有被引号包围的逗号。

这就是我想要的。IE：

```
"3","0.998652","10.1.3.2","10.1.2.3","TCP","[TCP Port numbers reused] 49153 > 10 [SYN] Seq=4294967295 Win=65535 Len=0"
"4","1.002860","10.1.2.3","10.1.3.2","TCP","10 > 49153 [SYN ACK] Seq=0 Ack=0 Win=65535 Len=0" 
```

请注意，唯一的区别是删除了 [SYN ACK] 部分中的逗号。

我已经尝试了很多东西，但到目前为止唯一有效的就是这样的东西。

```
a= '"4","1.002860","10.1.2.3","10.1.3.2","TCP","10 > 49153 [SYN, ACK] Seq=0 Ack=0 Win=65535 Len=0"'
str = regexprep(a,'","','1234567890')
str = regexprep(str,',','')
str = regexprep(str,'1234567890','","') 
```

不用说，这远非最佳，并且会欣赏任何想法。还有一点需要注意，我尝试过的一些功能无法识别引文（不记得是哪个手头的）

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T01:49:46.957

`regexprep`是要走的路，你只需要确保只替换逗号（通过使用`$1`匹配占位符放回匹配的侧翼部分。

```
a= '"4","1.002860","10.1.2.3","10.1.3.2","TCP","10 > 49153 [SYN, ACK] Seq=0 Ack=0 Win=65535 Len=0"'

%# replace commas that are neither preceded nor followed by commas
regexprep(a,'([^"]),([^"])','$1$2')

ans =

"4","1.002860","10.1.2.3","10.1.3.2","TCP","10 > 49153 [SYN ACK] Seq=0 Ack=0 Win=65535 Len=0" 
```

# java - 如何使用 Content-Encoding 读取压缩的 HTML 页面：gzip

> ID：11093153
> 
> 赞同：8
> 
> 时间：2012-06-19T01:11:32.043
> 
> 标签：java, gzipinputstream

**我请求一个发送Content-Encoding: gzip**标头的网页，但被卡住了如何阅读它..

我的代码：

```
 try {
        URLConnection connection = new URL("http://jquery.org").openConnection();                        
        String html = "";
        BufferedReader in = null;
        connection.setReadTimeout(10000);
    in = new BufferedReader(new InputStreamReader(connection.getInputStream()));            
    String inputLine;
    while ((inputLine = in.readLine()) != null){
    html+=inputLine+"\n";
        }
    in.close();
        System.out.println(html);
        System.exit(0);
    } catch (IOException ex) {
        Logger.getLogger(Crawler.class.getName()).log(Level.SEVERE, null, ex);
    } 
```

输出看起来很乱..（我无法在这里粘贴它，一种符号..）

我相信这是一个压缩的内容，如何解析它？

**注意：**
如果我将 jquery.org 更改为 jquery.com（不发送该标头，我的代码运行良好）

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-19T01:23:40.097

实际上，这是 pb2q 的答案，但我将完整代码发布给未来的读者

```
try {
    URLConnection connection = new URL("http://jquery.org").openConnection();                        
    String html = "";
    BufferedReader in = null;
    connection.setReadTimeout(10000);
    //The changed part
    if (connection.getHeaderField("Content-Encoding")!=null && connection.getHeaderField("Content-Encoding").equals("gzip")){
        in = new BufferedReader(new InputStreamReader(new GZIPInputStream(connection.getInputStream())));            
    } else {
        in = new BufferedReader(new InputStreamReader(connection.getInputStream()));            
    }     
    //End        
    String inputLine;
    while ((inputLine = in.readLine()) != null){
    html+=inputLine+"\n";
    }
in.close();
    System.out.println(html);
    System.exit(0);
} catch (IOException ex) {
    Logger.getLogger(Crawler.class.getName()).log(Level.SEVERE, null, ex);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-19T01:13:04.080

为此有一个类：[GZIPInputStream](http://docs.oracle.com/javase/6/docs/api/java/util/zip/GZIPInputStream.html)。它`InputStream`使用起来非常透明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-24T00:11:52.797

Content-Encoding:gzip 标头有两种情况

1.  如果数据已经压缩（通过应用程序），Content-Encoding:gizp 标头将导致数据再次压缩。所以它的双重压缩。这是因为[http 压缩](https://en.wikipedia.org/wiki/HTTP_compression)

2.  如果应用程序未压缩数据，Content-Encoding:gizp 将导致数据压缩（主要是 gzip），并且在到达客户端之前会自动解压缩（un-zip）。解压缩是大多数 Web 浏览器中的默认功能。如果浏览器在响应中找到 Content-Encoding:gizp 标头，它将解压缩。

# java - 在 Java 中播放声音效果

> ID：11093157
> 
> 赞同：0
> 
> 时间：2012-06-19T01:12:04.237
> 
> 标签：java, javasound, audio

我正在尝试执行与这行代码等效的操作，除了用一个小的 mp3 文件代替系统哔声：

```
Toolkit.getDefaultToolkit().beep(); 
```

我有一个 mp3 文件，它有一点我想要播放的音效。这是一件相对容易的事情吗？有人可以告诉我这样做的代码吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T02:12:40.830

您可以使用 MediaPlayer 播放声音。这是我通常用于所有音频的内容。

```
public class APP extends Activity {

//ADD THIS LINE AND IMPORT MediaPlayer
MediaPlayer btnClick;

@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.main);
//ADD THIS LINE TO YOUR onCreate METHOD AFTER YOU SET THE CONTENT VIEW
btnClick = MediaPlayer.create(this, R.raw.button_click);
    }
} 
```

这会设置您的音频以及它应该播放的内容。它会播放你的声音，直到完成。然后将此行添加到您希望播放声音的任何位置：

```
btnClick.start(); 
```

如果您希望它循环播放（配乐或歌曲），请添加：

```
btnClick.setLooping(true); 
```

完成循环播放的音轨或完成应用程序后，添加以下内容以停止音频：

```
btnClick.stop(); 
```

或者

```
btnClick.release(); 
```

所以从技术上讲，您将为 MediaPlayer 本身添加 2 行，1 行开始它，1 行结束它（可选，但最适合良好的编程习惯和实践）。

我希望这能彻底回答你的问题。干杯!

# ruby-on-rails - 如何设置这种复杂的活动记录关系？

> ID：11093158
> 
> 赞同：0
> 
> 时间：2012-06-19T01:12:05.303
> 
> 标签：ruby-on-rails, activerecord, has-many-through

我基本上想建立一个类似于 Netflix 的 DVD 租赁模式的关系。

有用户，每个用户都有一个队列，每个队列包含许多 DVD，DVD 可以有许多队列。一个队列属于一个用户。

我不太确定如何在活动记录中进行设置。我想也许一个队列和一个用户应该是一个 has_many :through 关系，但这没有多大意义。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T01:19:15.327

```
class User < ActiveRecord::Base
  has_many :queues
end

class Queue < ActiveRecord::Base
  belongs_to :user
  has_many :dvd_queues
  has_many :dvds, through: :dvd_queues
end

class Dvd < ActiveRecord::Base
  has_many :dvd_queues
  has_many :queues, through: :dvd_queues
end

class DvdQueue < ActiveRecord::Base
  belongs_to :dvd
  belongs_to :queue
end 
```

在&之间使用`has_many`而不是`has_and_belongs_to_many`关联的好处是，这允许您向.`Dvd``Queue``priority``DvdQueue`

> 如果我希望用户能够将 DVD 添加到他们的队列并查看他们的队列，哪些模型需要视图和控制器

通常，您会为 User、Queue 和 Dvd 提供相应的控制器，这些控制器提供映射到标准路由的 CRUD 操作，以及用于索引、新建和编辑操作的视图。

# eventbrite - eventbrite api中是否有可用的回调？

> ID：11093159
> 
> 赞同：3
> 
> 时间：2012-06-19T01:12:12.757
> 
> 标签：eventbrite

随着更多人回复会议，我想更新会议。目前，当与会者回复时，我看不到任何地方可以输入回调 URL。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T22:42:52.797

Great suggestion! Eventbrite does not currently allow a callback url or web hook to be configured, exposing this type of activity.

However, you might be able to build this kind of notification system by placing a tracking pixel (or some similar web asset) on the event's order confirmation page.

If you can detect the HTTP referrer information from the request, it could probably be used to detect the event_id and order_id (which are embedded in the order confirmation page's url path). Let me know if that works - @RyanJ

# c# - 如何取消订阅此 .NET 事件？

> ID：11093168
> 
> 赞同：8
> 
> 时间：2012-06-19T01:13:31.833
> 
> 标签：c#, asp.net, .net, events, event-handling

我希望以编程方式取消订阅已连接的事件。

**我想知道如何取消订阅该`EndRequest`活动。**

考虑到我正在使用内联代码，我不确定如何执行此操作。（这是正确的技术术语吗？）

我知道我可以使用`some.Event -= MethodName`取消订阅 .. 但我没有方法名称，在这里。

我使用内联代码的原因是因为我希望引用在事件之外定义的变量（我需要它......但感觉很臭......我觉得我需要传递它）。

有什么建议么？

代码时间..

```
public void Init(HttpApplication httpApplication)
{
    httpApplication.EndRequest += (sender, e) =>
    {
        if (some logic) 
            HandleCustomErrors(httpApplication, sender, e,
                              (HttpStatusCode)httpApplication.Response.StatusCode);
    };

    httpApplication.Error += (sender, e) => 
            HandleCustomErrors(httpApplication, sender, e);
}

private static void HandleCustomErrors(HttpApplication httpApplication, 
                                       object sender, EventArgs e, 
                                       HttpStatusCode httpStatusCode =
                                           HttpStatusCode.InternalServerError)
{ ... } 
```

这只是我拥有的一些示例代码，用于处理`ASP.NET`应用程序中的错误。

注意：请不要把它变成关于 ASP.NET 错误处理的讨论。我只是在玩一些事件并将这些事件用于一些示例研发/学习。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-19T01:18:57.277

无法取消订阅该匿名代表。您需要将其存储在变量中并稍后取消订阅：

```
EndRequestEventHandler handler = (sender, e) =>
{
    if (some logic) 
        HandleCustomErrors(httpApplication, sender, e,
                          (HttpStatusCode)httpApplication.Response.StatusCode);
};

httpApplication.EndRequest += handler;
// do stuff
httpApplication.EndRequest -= handler; 
```

# php - PHP MySQL SELECT Query 只返回资源

> ID：11093169
> 
> 赞同：1
> 
> 时间：2012-06-19T01:13:32.723
> 
> 标签：php, mysql, debugging

我目前正在构建一个下载平台，在该平台中，用户会收到一个随机代码并使用它来访问一个 mp3 以供下载最多三个下载。我使用 Python 生成了一个随机代码列表，并将它们导入到一个 SQL 表中，其中一个空列用于关联的电子邮件地址，默认值为 0 用于使用计数。我编写了以下 PHP 脚本，以便将电子邮件与特定代码相关联并添加到计数中，以便最多可以访问 3 次下载。

```
$email = $_POST["email"];
$email = stripslashes($email);
$uniqueCode = $_POST["uniqueCode"];
$uniqueCode = stripslashes($uniqueCode);

// check that all fields are filled
if($uniqueCode=="" || $email=="")
    apologize("Please fill out all fields.");

// check to make sure that the e-mail is valid
if (verifyEmail($email) == FALSE)
    apologize("Please enter a valid e-mail address.");

// check if uniqueCode input is alphanumeric 
if (verifyCode($uniqueCode) == FALSE)
    apologize("Download codes are alphanumeric.");

// check to see if unique code is correct 
$sql = mysql_query("SELECT * FROM wd009 where uniqueCode='$uniqueCode'");
$result = mysql_fetch_array($sql); 

if($sql==FALSE)
{
    apologize("Your download code is invalid. Please try again");
}
// only allow users with less than 3 downloads to proceed
else if ($result['count'] <= 3) {
        if ($result['email'] == ""){
            mysql_query("UPDATE wd009 SET email='$email', count=1 WHERE uniqueCode='$uniqueCode'");
            apologize("added email"); 
            }
        else if ($result['email'] != $email)
            apologize("different email from record!!"); 
        else if ($result['email'] == $email){
            mysql_query("UPDATE wd009 SET count=count+1 WHERE uniqueCode='$uniqueCode'");
            apologize("updated the count!"); 

}
else 
    apologize("Your download code is used up!"); 
```

显然，我在上面使用了一些代码中未包含的函数，但我已经检查了所有这些函数，它们都不应该干扰 MySQL 查询。可能需要注意的是，apologize() 在道歉后立即退出。当我在表单中输入正确的代码时，它可以正常工作并更新 SQL 数据库。但是，只要下载代码输入是字母数字，即使该字符串肯定与表中的任何字符串都不匹配，表单也会接受它。即，无论输入如何，mysql_query 都会返回一个资源。我检查了数据库连接，但由于下载代码正确时表已正确更新，这似乎不是问题。

我已经尝试过以我能想到的所有方式进行调试，并且真的很困惑。您能提供的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T01:19:28.227

正如您在手册中所见，[`mysql_query`](http://php.net/manual/en/function.mysql-query.php)始终为有效查询返回资源，因此您需要更改逻辑并计算它返回的行数，而不是`mysql_query`.

除此之外，`mysql_query`, 已被弃用，您应该使用 mysqli 或 PDO。

您可以使用 - 同样不推荐使用 -`mysql_num_rows`函数计算行数。在您的情况下，0 行将不是有效代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T03:16:32.097

问题可能是这一行：

```
if($sql==FALSE)
{
    apologize("Your download code is invalid. Please try again");
} 
```

由于 sql 是一个字符串，因此它接受的是 true 并将其传递为有效。为了避免 sql 注入，您可能还想做的一件事是使用参数而不是直接注入用户输入。

```
$sql = mysql_query("SELECT * FROM wd009 where uniqueCode='$uniqueCode'"); 
```

相反，请执行以下操作：

```
$stmt = $mysqli->prepare("SELECT * FROM wd009 where uniqueCode=?");
$stmt->bind_param($uniqueCode);
$stmt->execute();

while ($stmt->fetch()) {
   ..... 
```

您也希望以这种方式对更新语句执行此操作。

如果该表中有大量数据，您可能希望限制 SQL 语句中返回的列，以减轻数据库的负载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T01:20:54.643

这个

```
if($sql==FALSE) 
```

应该是这样的

```
if(mysql_num_rows($sql) == 0) 
```

编辑：我同意，现在首选 mysqli 或 PDO。

# android - Canvas.drawBitmap() 间歇性变慢，导致白闪

> ID：11093170
> 
> 赞同：12
> 
> 时间：2012-06-19T01:13:46.797
> 
> 标签：android, android-canvas

我正在制作带有滚动背景的动态壁纸。我有两个交替使用的位图对象，以便为下一帧保留先前绘制的像素。我在画布顶部画了一条新线，然后调用 drawBitmap 将其余像素复制到画布上。

我正在使用 Runnable 对象来完成繁重的工作。它完成所有需要的复制和计算，然后锁定画布，进入持有者上的同步块，并对 Canvas.drawBitmap(bitmap,rect,rect,paint) 进行一次调用。屏幕上偶尔会出现白色闪烁，这似乎与高 CPU 活动有关。在使用 traceview 时，我发现 drawBitmap 操作，特别是 Canvas.native_drawBitmap()，花费的时间比正常情况要长得多。通常它在 2-4 毫秒内完成，但是当我看到白色闪光时，它可能需要 10 到 100 毫秒。

```
private void draw() {
    SurfaceHolder holder = getSurfaceHolder();

    Canvas canvas = null;
    prepareFrame();
    try {
        canvas = holder.lockCanvas();
        synchronized (holder) {
            if (canvas != null) {
                drawFrame(canvas);
            }
        }
    } catch (Exception e) {
        e.printStackTrace();
    } finally {
        if (canvas != null)
            holder.unlockCanvasAndPost(canvas);
    }
    afterDrawFrame();
    handler.removeCallbacks(drawRunner);
    if (visible) {
        handler.post(drawRunner);
    }
} 
```

该`draw()`函数在`run()`Runnable 中调用。

```
private void prepareFrame() {
    num++;
    if (num%2 == 0) {
        mainBmp = mainBmp1;
        mainCan.setBitmap(mainBmp1);
        mainCan.drawBitmap(mainBmp2, source, destination, null);
    } else {
        mainBmp = mainBmp2;
        mainCan.setBitmap(mainBmp2);
        mainCan.drawBitmap(mainBmp1, source, destination, null);
    }
} 
```

该`prepareFrame()`函数是我如何保持以前绘制的像素的方式。名为 source 的 Rect 在底部比全屏尺寸少一排，而目标在顶部少一排。`drawBitmap()`呼入`prepareFrame()`永远不会超过 2-4 毫秒。

```
private void drawFrame(Canvas can) {
    can.drawBitmap(mainBmp, source, destination,null);
} 
```

这个单一的操作是在持有锁的同时在画布上完成的。

```
private void afterDrawFrame() {
    ca.calcNextRow();
    mainBmp.setPixels(ca.getRow(), 0, canWidth, 0, 0, canWidth, 1);
} 
```

然后下一行新的像素被绘制到内存中的一个位图上。

我尝试过使用 的各种签名，`drawBitmap()`但发现它们平均速度较慢，并且仍然导致异常的白色闪烁。

我的整体速度很棒。没有间歇性闪烁，它工作得非常好。有没有人有关于如何消除闪光的建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-25T09:18:17.823

很难确切地知道这里发生了什么，因为你没有包括一些中心变量的定义或使用，比如“mainCan”或“ca”。更完整的源参考会很棒。

但...

可能发生的情况是，由于 drawFrame(canvas) 在持有人上同步，但是

```
handler.post(drawRunner); 
```

不是，您会尝试将 mainBmp 绘制到系统画布上，同时在 prepareFrame() 中写入它。

这个问题的最佳解决方案可能是某种双缓冲，您可以在其中执行类似的操作

```
1) Write to a temporary bitmap
2) Change the ref of that bitmap to the double buffer i.e. mainBmp = tempBitmap; 
```

主要目标是永远不要对用于系统画布渲染的变量进行长时间写入，只需更改对象引用即可。

希望这可以帮助。

# jquery - Jquery Mobile 更改页面混乱

> ID：11093172
> 
> 赞同：0
> 
> 时间：2012-06-19T01:15:01.697
> 
> 标签：jquery, jquery-mobile

在下面的示例中，page1 在第一次加载时接收新的列表项。当您导航到 page2 并通过脚本触发 changepage 时，该页面不会收到新的列表元素。

示例代码：

```
$('#page2').live('pageinit', function(event) {
  $.mobile.changePage( "page1.html", {reloadPage: true});
}

$('#page1').live('pageinit', function(event) {
  // insert new list items here
  $('#mylist').listview('refresh');
} 
```

但是，如果你做同样的事情，但事先提醒一些事情，就像这样：

```
$('#page2').live('pageinit', function(event) {
  $.mobile.changePage( "page1.html", {reloadPage: true});
}

$('#page1').live('pageinit', function(event) {
  alert("testing...");
  // insert new list items here
  $('#mylist').listview('refresh');
} 
```

该页面确实收到了新的列表项。就像它在被 changepage 重新加载时以不同的顺序触发一样。它必须开得太快。我应该使用什么功能来等待？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T07:50:33.167

尝试`data-ajax="false"`指向下一页的链接...

例如，

```
<a href="page2.html" data-role="button" data-ajax="false"> Click</a> 
```

# c# - 没有找到从互操作接口覆盖的合适方法

> ID：11093179
> 
> 赞同：1
> 
> 时间：2012-06-19T01:16:34.110
> 
> 标签：c#, interop, com-interop, windows-update

我正在尝试实现[Windows 更新代理 API](http://msdn.microsoft.com/en-us/library/aa387099%28v=vs.85%29)异步下载/安装方法，但是，我无法实现回调类（`IInstallationProgressChangedCallback`等）

这是一个无法使用 System 的示例实现类；使用 WUApiLib；

```
namespace ConsoleApplication1
{
    class DownloadProgressCallback : IDownloadProgressChangedCallback
    {
        public override void Invoke(IDownloadJob downloadJob, IDownloadProgressChangedCallbackArgs callbackArgs)
        {
            Console.WriteLine("Do something");
        }
    }
} 
```

每当我尝试编译包含此类的项目时，我都会得到

```
ConsoleApplication1.DownloadProgressCallback.Invoke(WUApiLib.IDownloadJob, WUApiLib.IDownloadProgressChangedCallbackArgs)': no suitable method found to override 
```

作为参考，以下是接口的定义方式（元数据）：

```
#region Assembly Interop.WUApiLib.dll, v2.0.50727
// F:\src\ConsoleApplication1\ConsoleApplication1\obj\x86\Debug\Interop.WUApiLib.dll
#endregion

namespace WUApiLib
{
    [InterfaceType(1)]
    [Guid("8C3F1CDD-6173-4591-AEBD-A56A53CA77C1")]
    [TypeLibType(384)]
    public interface IDownloadProgressChangedCallback
    {
        void Invoke(IDownloadJob downloadJob, IDownloadProgressChangedCallbackArgs callbackArgs);
    }
} 
```

我对 COM/Interop 不是很熟悉，所以我不知道我在这里做错了什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T01:18:22.813

`override`实现接口时不需要使用。写吧：

```
 public void Invoke(IDownloadJob downloadJob, IDownloadProgressChangedCallbackArgs callbackArgs)
    {
       Console.WriteLine("Do something");
    } 
```

`override`从基类继承并“覆盖”基类继承的虚拟（或抽象）方法时使用关键字。有关详细信息，请参阅[覆盖](http://msdn.microsoft.com/en-us/library/ebca9ah3.aspx)。

有了接口，你只需要一个匹配的方法。您也可以显式实现接口：

```
void IDownloadProgressChangedCallback.Invoke(IDownloadJob downloadJob, IDownloadProgressChangedCallbackArgs args)
{ //... 
```

这允许您以不会“污染”类公共 API 的方式实现接口，或者为具有相同名称和类型的成员的两个接口提供不同的实现。

# web-config - 服务器加载 HttpModule 时出错

> ID：11093180
> 
> 赞同：1
> 
> 时间：2012-06-19T01:16:34.353
> 
> 标签：web-config, httpmodule, iis-express

我很困惑，需要一些建议来解决我在配置为使用我创建的 HttpModule 的应用程序中遇到的以下错误：

```
Server Error in '/' Application.
--------------------------------------------------------------------------------

Could not load type 'namespaceResponseModifier.ResponseModifer'. 

...

Exception Details: System.Web.HttpException: Could not load
type 'namespaceResponseModifier.ResponseModifer'.

...

Stack Trace: 

[HttpException (0x80004005): Could not load type 'namespaceResponseModifier.ResponseModifer'.]

...

[ConfigurationErrorsException: Could not load type 'namespaceResponseModifier.ResponseModifer'.]

...

--------------------------------------------------------------------------------
Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.272 
```

Web 服务器是 IIS Express 7.0。

在 web.config 文件中，该元素的代码是：

```
 <system.webServer>
       <modules>
           <add name="ResponseModifier"
                type="namespaceResponseModifier.ResponseModifer" />
       </modules>
   </system.webServer>

The assembly for the HttpModule resides in 
C:\...\HttpModulePreSendRequestContentCS\Bin\ResponseModifier.dll 
```

我还尝试将 HttpModule 的源代码放在 App_Code 目录中，但在加载 HttpModule 时仍然出现服务器错误。

在第二种情况下，我收到以下错误：

```
Server Error in '/' Application.
--------------------------------------------------------------------------------

Could not load type 'namespaceResponseModifier.ResponseModifer' from assembly 'App_Code'. 

...

Exception Details: System.TypeLoadException: Could not load
type 'namespaceResponseModifier.ResponseModifer' from assembly 'App_Code'.

...

Stack Trace: 

[TypeLoadException: Could not load type 'namespaceResponseModifier.ResponseModifer' from
assembly 'App_Code'.]

...

[ConfigurationErrorsException: Could not load type 'namespaceResponseModifier.ResponseModifer'
from assembly 'App_Code'.]

...

[HttpException (0x80004005): Could not load type 'namespaceResponseModifier.ResponseModifer'
from assembly 'App_Code'.]

...

--------------------------------------------------------------------------------
Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.272 
```

我也尝试过使用 Visual Studio Development Web Server 而不是 IIS Express Web Server。我在这两种情况下都尝试了这个服务器： - 在 bin 文件夹中使用程序集 - 在 App_Code 文件夹中使用源代码。

这些场景分别产生以下错误：

```
Server Error in '/HttpModulePreSendRequestContentCS' Application.
--------------------------------------------------------------------------------

Configuration Error 

...

Parser Error Message: Could not load type 'ResponseModifer'.
(C:\...\HttpModulePreSendRequestContentCS\web.config line 8)

...

Source File: C:\...\HttpModulePreSendRequestContentCS\web.config    Line: 8 

--------------------------------------------------------------------------------
Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.272

Server Error in '/HttpModulePreSendRequestContentCS' Application.
--------------------------------------------------------------------------------

Configuration Error 

...

Parser Error Message: Could not load type 'ResponseModifer' from assembly 'App_Code'.  
(C:\...\HttpModulePreSendRequestContentCS\web.config line 8)

...

Source File: C:\...\HttpModulePreSendRequestContentCS\web.config    Line: 8 

--------------------------------------------------------------------------------
Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.272 
```

任何关于我可以做些什么来解决问题的建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-03T13:53:20.840

老问题，但我相信您的模块添加不正确。

```
<add name="NameOfModule" type="Namespace.NameOfModule, AssemblyName" /> 
```

是我看到它的典型方式，所以不知道这个模块的命名空间，它看起来更接近：

```
<add name="ResponseModifier" type="ActualNameSpaceGoesHere.namespaceResponseModifier.ResponseModifer, ResponseModifier" /> 
```

# sql - 对于 SQL Server Compact Edition 3.5，级联删除是否太慢，或者我可以提高性能吗？

> ID：11093181
> 
> 赞同：2
> 
> 时间：2012-06-19T01:16:34.240
> 
> 标签：sql, performance, database-design, sql-server-ce

我为级联删除设置了外键，运行删除命令大约需要 30 分钟。这是我要删除的行数的简化视图：

```
DELETE from Directories WHERE Type = 1 
```

结构：

`Directory`表：（从`WHERE`子句返回 1.2K 行）

+---+`File`带有`DirectoryID`外键的表（50K 行）

+-------------+`Tag`带有`FileID`外键的表（28K 行）

这需要 28 分钟才能运行。

我应该避免使用多层级联删除，还是可以做一些简单的事情来提高性能？如果没有外键，我可以在不到一秒的时间内删除 50K+ 行。

我是 SQL 和 SQL Server Compact Edition 3.5 的新手。所有主键都被索引。我在没有帮助的外键上添加了索引。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T00:10:25.977

根据[这个讨论](http://social.msdn.microsoft.com/Forums/en-US/sqlce/thread/1f791b50-1f9d-442a-ba15-98658eb18587)，如果您的外键上有复合索引，您可能希望考虑使用仅包含外键字段的简单索引。

# android - 基于android上用户区域设置的日期格式

> ID：11093182
> 
> 赞同：68
> 
> 时间：2012-06-19T01:16:49.313
> 
> 标签：android, internationalization, date-format

我想根据用户语言环境显示出生日期。在我的申请中，我的字段之一是出生日期，目前格式为`dd/mm/yyyy`. 所以如果用户改变了他的语言环境，日期格式也应该相应地改变。任何指针或代码示例都会真正帮助我克服这个问题。

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2012-06-19T02:21:44.890

您可以使用根据用户区域设置格式化日期的[DateFormat类。](http://developer.android.com/reference/android/text/format/DateFormat.html)

例子：

```
String dateOfBirth = "26/02/1974";
SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");
Date date = null;
try {
    date = sdf.parse(dateOfBirth);
} catch (ParseException e) {
    // handle exception here !
}
java.text.DateFormat dateFormat = android.text.format.DateFormat.getDateFormat(context);
String s = dateFormat.format(date); 
```

您可以使用不同的方法`getLongDateFormat`，`getMediumDateFormat`具体取决于您想要的详细程度。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2019-06-19T13:27:17.837

虽然在提出问题时接受的答案是正确的，但后来它已经过时了。我正在贡献现代答案。

## java.time 和 ThreeTenABP

```
 DateTimeFormatter dateFormatter = DateTimeFormatter.ofLocalizedDate(FormatStyle.SHORT);

    LocalDate dateOfBirth = LocalDate.of(1991, Month.OCTOBER, 13);
    String formattedDob = dateOfBirth.format(dateFormatter);
    System.out.println("Born: " + formattedDob); 
```

它根据 JVM 的语言环境设置（通常取自设备）提供不同的输出。例如：

*   加拿大法语：`Born: 91-10-13`
*   中国人：`Born: 1991/10/13`
*   德语：`Born: 13.10.91`
*   意大利语：`Born: 13/10/91`

如果您想要更长的格式，您可以指定不同的格式样式。美国英语语言环境中的示例输出：

*   `FormatStyle.SHORT`：`Born: 10/13/91`
*   `FormatStyle.MEDIUM`：`Born: Oct 13, 1991`
*   `FormatStyle.LONG`：`Born: October 13, 1991`
*   `FormatStyle.FULL`：`Born: Thursday, October 13, 1991`

## 问题：我可以在 Android 上使用 java.time 吗？

> DateTimeFormatter.ofLocalizedDate 至少需要 Api O。

是的，java.time 在较旧和较新的 Android 设备上运行良好。不，它不需要 API 级别 26 或 Oreo，即使您的 Android Studio 中的消息可能让您这么认为。它只需要至少**Java 6**。

*   在 Java 8 及更高版本以及更新的 Android 设备（从 API 级别 26 开始）中，现代 API 是内置的。
*   在 Java 6 和 7 中获得 ThreeTen Backport，现代类的后向端口（ThreeTen 用于 JSR 310；请参阅底部的链接）。
*   在较旧的 Android 上，要么使用脱糖，要么使用 ThreeTen Backport 的 Android 版本。它被称为 ThreeTenABP。在后一种情况下，请确保您从`org.threeten.bp`子包中导入日期和时间类。

## 问题：我还可以接受用户本地格式的用户输入吗？

是的你可以。格式化程序还可用于将来自用户的字符串解析为`LocalDate`：

```
 LocalDate date = LocalDate.parse(userInputString, dateFormatter); 
```

我建议您首先格式化一个示例日期并将其显示给用户，以便他/她可以看到您的程序期望他/她的语言环境采用哪种格式。作为示例日期，日期的日期大于 12，年份大于 31，因此可以从示例中看到日、月和年的顺序（对于较长的格式，年份无关紧要，因为它将是四位数）。

`DateTimeParseException`如果用户输入的日期格式不正确或日期无效，解析将抛出 a 。抓住它并允许用户再试一次。

## 问题：我可以对一天中的某个时间做同样的事情吗？日期和时间？

是的。要根据用户的区域设置格式化一天中的时间，请从`DateTimeFormatter.ofLocalizedTime`. 对于日期和时间一起使用的重载版本之一`DateTimeFormatter.ofLocalizedDateTime`。

## 避免使用 DateFormat、SIMpleDateFormat 和 Date 类

我建议你不要使用`DateFormat`,`SimpleDateFormat`和`Date`. 这些类设计不佳且早已过时，前两个尤其是出了名的麻烦。而是使用`LocalDate`,`DateTimeFormatter`和 java.time 中的其他类，现代 Java 日期和时间 API。

## 链接

*   [Oracle 教程：日期时间](https://docs.oracle.com/javase/tutorial/datetime/)解释如何使用 java.time。
*   [Java 规范请求 (JSR) 310](https://jcp.org/en/jsr/detail?id=310)，`java.time`第一次描述的地方。
*   [ThreeTen Backport 项目](http://www.threeten.org/threetenbp/)，`java.time`Java 6 和 7 的反向移植（ThreeTen for JSR-310）。
*   [可通过脱糖获得 Java 8+ API](https://developer.android.com/studio/write/java8-support-table)
*   [ThreeTenABP](https://github.com/JakeWharton/ThreeTenABP) , ThreeTen Backport 的 Android 版
*   [问题：如何在Android项目中使用ThreeTenABP](https://stackoverflow.com/questions/38922754/how-to-use-threetenabp-in-android-project)，有非常详尽的解释。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2017-09-18T18:17:04.853

简单到

对于日期+时间：

```
DateFormat format = DateFormat.getDateTimeInstance(DateFormat.DEFAULT, DateFormat.SHORT, Locale.getDefault()); 
```

仅日期：

```
DateFormat format = DateFormat.getDateInstance(DateFormat.SHORT, Locale.getDefault()); 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2015-03-17T18:53:41.880

要根据语言环境更改日期格式，以下代码对我有用：

```
 String dateOfBirth = "26/02/1974";
    SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");
    Date date = null;
    try {
        date = sdf.parse(dateOfBirth);
    } catch (ParseException e) {
        // handle exception here !
    }

    String myString = DateFormat.getDateInstance(DateFormat.SHORT).format(date); 
```

然后，当您更改语言环境时，日期格式将根据它更改。有关日期模式的更多信息：http: [//docs.oracle.com/javase/tutorial/i18n/format/dateFormat.html](http://docs.oracle.com/javase/tutorial/i18n/format/dateFormat.html)

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2016-06-25T04:29:12.363

Android api 提供了简单的方法来显示本地化的日期格式。以下代码有效。

```
public class FileDateUtil {
    public static String getModifiedDate(long modified) {
        return getModifiedDate(Locale.getDefault(), modified);
    }

    public static String getModifiedDate(Locale locale, long modified) {
        SimpleDateFormat dateFormat = null;

        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN_MR2) {
            dateFormat = new SimpleDateFormat(getDateFormat(locale));
        } else {
            dateFormat = new SimpleDateFormat("MMM/dd/yyyy hh:mm:ss aa");
        }

        return dateFormat.format(new Date(modified));
    }

    @TargetApi(Build.VERSION_CODES.JELLY_BEAN_MR2)
    public static String getDateFormat(Locale locale) {
        return DateFormat.getBestDateTimePattern(locale, "MM/dd/yyyy hh:mm:ss aa");
    }
} 
```

您可以检查以下代码。

```
String koreaData = FileDateUtil.getModifiedDate(Locale.KOREA, System.currentTimeMillis());
String franceData = FileDateUtil.getModifiedDate(Locale.FRENCH, System.currentTimeMillis());
String defaultData = FileDateUtil.getModifiedDate(Locale.getDefault(), System.currentTimeMillis());

String result = "Korea : " + koreaData + System.getProperty("line.separator");
result += "France : " + franceData + System.getProperty("line.separator");
result += "Default : " + defaultData + System.getProperty("line.separator"); 
tv.setText(result); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-01-16T13:15:03.573

**简单的方法：**

```
String AR_Format = "dd-mm-yyyy";
String EN_Format = "mm-dd-yyyy";

String getFomattedDateByLocale(Date date, String locale) {
    return new SimpleDateFormat(strDateFormat, new Locale(locale)).format(date);
} 
```

然后这样称呼它：

```
txtArabicDate.setText(getFomattedDateByLocale(new Date(), AR_Format));
txtEnglishDate.setText(getFomattedDateByLocale(new Date(), EN_Format)); 
```

不要忘记`new Date()`用您自己的日期变量替换。

祝你好运。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-09-13T07:45:50.907

要获取日期格式模式，您可以执行以下操作：

```
Format dateFormat = android.text.format.DateFormat.getDateFormat(getApplicationContext());
String pattern = ((SimpleDateFormat) dateFormat).toLocalizedPattern(); 
```

之后，您可以根据模式格式化输入。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-01-29T11:38:00.950

我的方式，例如：UTC iso格式字符串到android用户。

```
 //string UTC instant to localDateTime
    String example = "2022-01-27T13:04:23.891374801Z"
    Instant instant = Instant.parse(example);
    TimeZone timeZone = TimeZone.getDefault();
    LocalDateTime localDateTime = LocalDateTime.ofInstant(instant, timeZone.toZoneId());

    //localDateTime to device culture string output
    DateTimeFormatter dateFormatter = DateTimeFormatter.ofLocalizedDate(FormatStyle.LONG);
    String strDate = localDateTime.toLocalDate().format(dateFormatter);
    DateTimeFormatter timeFormatter = DateTimeFormatter.ofLocalizedTime(FormatStyle.MEDIUM);
    String strTime = localDateTime.toLocalTime().format(timeFormatter);

    //strings to views
    txtDate.setText(strDate);
    txtTime.setText(strTime); 
```

# javascript - Javascript 显示当前区域的当前天气

> ID：11093183
> 
> 赞同：0
> 
> 时间：2012-06-19T01:16:53.847
> 
> 标签：javascript, weather

我需要 javascript 来获取当前区域的天气，然后显示它作为字母返回的内容，然后显示一个图标，因为它是符号字体。（[Climacons 字体](http://adamwhitcroft.com/climacons/font/)）我将使用[Google API](http://www.google.com/ig/api?hl=en&weather=glenmont)来获取数据。我需要使用 javascript 来获取 XML 行

```
<condition data="_____________"/> 
```

在 current_conditions 部分中，然后将其放入一个数组中，以便我可以使用它将该数据替换为要在屏幕上显示的字母。如果有人可以帮助我编写一个可以读取 XML 数据并将其放入数组的脚本，那将非常有帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T01:21:23.300

您可以调用天气 api ( [http://www.programmableweb.com/apitag/weather?format=JSON](http://www.programmableweb.com/apitag/weather?format=JSON) ) 并获取一些 json 数据。

然后将其操作到您的界面中。

# facebook-graph-api - FQL 限制子句显示的结果数量多于应有的数量？

> ID：11093184
> 
> 赞同：0
> 
> 时间：2012-06-19T01:17:16.843
> 
> 标签：facebook-graph-api, facebook-fql

我有一个简单的查询来显示给定的用户照片：

```
SELECT pid FROM photo_tag WHERE subject in "12345" LIMIT 400,500 
```

它返回 500 个结果......它不应该返回 100 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T01:47:09.927

否。您的查询要求从记录 401 开始的 500 条记录。

要返回记录 400-500，您的查询应为

```
SELECT pid FROM photo_tag WHERE subject in "12345" LIMIT 400, 100 
```

# compiler-errors - Lua 从 5.1 更新 - LUA_GLOBALSINDEX 问题

> ID：11093189
> 
> 赞同：3
> 
> 时间：2012-06-19T01:17:34.633
> 
> 标签：compiler-errors, lua, global-variables, upgrade

我最近将我的旧 Lua 5.1 项目更新为最新版本的库，但我遇到了问题`LUA_GLOBALSINDEX`- 它变得未定义。我只在`lua_getfield`函数中使用它，如下所示：

```
void luastartgame(void)
{
    if(startgamefunction.empty())return ;
    lua_getfield(globalL, LUA_GLOBALSINDEX, startgamefunction.c_str()); // go to function in Lua script
    int numArgs = 0;
    int res = lua_pcall(globalL,numArgs,0, 0);

    if(!luaresf(res)) // did the function call result in an error?
    {
        return;
    }
} 
```

我尝试用一​​些常量整数替换它 - 如果它不是 0，我的程序就会崩溃。如果为 0，则运行异常，抱怨“试图访问 nil 值”。

我的源代码[在这里](https://github.com/ThePiachu/Pickomino/blob/master/Pickomino/Scripting.h)可用。我应该如何处理`LUA_GLOBALSINDEX`？我应该把它改成什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T01:38:41.293

使用`lua_getglobal(globalL,startgamefunction.c_str())`，它适用于 5.1 和 5.2。

# apache-flex - adobe air 4.6 中的页面导航

> ID：11093191
> 
> 赞同：0
> 
> 时间：2012-06-19T01:18:04.480
> 
> 标签：apache-flex, air

如何通过动作脚本将一个 mxml 页面导航到另一个页面

用于网页的 navigatTourl() 方法，但是，如果要导航另一个 mxml 页面意味着如何显示

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T02:34:31.850

创建 Flex 应用程序时，页面类比效果不佳。在 HTML 站点中，每个页面都是一个自包含的实体，与任何其他页面没有真正的关系。但是，Flex 应用程序是一个独立的实体；并且该实体可以有很多屏幕或视图。

要在 Flex 应用程序中的视图之间导航，有很多方法。以下是三种方法：

1.  你可以使用[状态](http://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf69084-7fb4.html)
2.  您可以使用[Navigator 容器](http://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf69084-7fb9.html)，例如 ViewStack 或 TabNavigator。
3.  您可以切换 UI 组件的[可见](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/core/UIComponent.html#visible)属性。

通常，前两个选项将用于大规模更改。第三个选项将用于较小的更改。

# php - 停止执行包含的 php 文件...从类函数

> ID：11093194
> 
> 赞同：2
> 
> 时间：2012-06-19T01:18:43.767
> 
> 标签：php

我正在尝试为我正在开发的一个简单的网络应用程序设计一个插件系统。

每个插件都以函数调用 register_plugin 开头，其中包含插件信息，如名称、描述等。

我希望能够将模式设置为 1，然后能够包含插件文件，让它调用 register_plugin，然后仅退出包含的脚本。我知道我可以用一个简单的来停止执行`return;`，但是， register_plugin 函数位于不同的文件中，一个类，所以我不能简单地调用 return 因为这只会结束函数。

我怎样才能做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T01:38:56.433

正如您在问题中已经概述的那样，您需要更改代码和文件的结构才能使其正常工作。

没有一种魔法`return`不会离开函数，而是离开文件，或者离开函数，然后离开文件。

您需要重新安排您的代码，添加额外的检查，然后提供您正在寻找的功能。

# javascript - 如何使用 Jquery/Javascript/css 在每次点击时动态旋转圆圈？

> ID：11093195
> 
> 赞同：1
> 
> 时间：2012-06-19T01:18:55.470
> 
> 标签：javascript, jquery, html, css

我有一个形成一个圆圈的 CSS 类，我试图通过添加一个 css 属性从 Jquery 动态旋转它。当我第一次单击按钮时它工作正常，其余时间它处于空闲状态。我尝试使用“cssAmination”功能，但它没有用。我无法弄清楚我哪里出错了。请帮助我修复此代码。提前致谢。

```
/*Circle code*/
div.circle{   
width: 300px;   
height: 300px;    
-moz-border-radius:150px; 
-webkit-border-radius: 150px;  
background:#808080; 
border-radius: 150px;
bottom: -150px;
left: -150px;
position: absolute;
}

/*rotate class*/
div.rotateCircle
{   
/* Firefox: */
-moz-animation-duration: 2s;
-moz-animation-timing-function: ease-in-out;
-moz-animation-iteration-count: 1;
-moz-animation-play-state: running;
}

@-moz-keyframes moveCircle
{
from {-moz-transform:rotate(0deg);}
to {-moz-transform:rotate(90deg);}
}

//Jquery code:
<script type="text/javascript">
        $(document).ready(function(){
    $("a").click(function(){
        $('div#rotateCircle').css({'-moz-animation-name':'moveCircle'});
    });
}); </script>
<body>
    <h3>Labs Project</h3>
    <div>
        <div id=rotateCircle class="circle">
            &nbsp;
        </div>
        <div id=rotateCircle class="horizontalLine">
            &nbsp;
        </div>
        <div id=rotateCircle class="verticalLine">
            &nbsp;
        </div>
        <div class="divButton">
            <table>
                <tr>
                    <td><a class="btn" href="#">HOME</a></td>
                    <td><a class="btn" href="#">Class</a></td>
                    <td><a class="btn" href="#">CV</a></td>
                    <td><a class="btn" href="#">CM</a></td>
                </tr>
            </table>
        </div>      
    </div>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T17:46:38.200

您应该查看动画的 JavaScript 事件：[https ://developer.mozilla.org/en/CSS/CSS_animations#Using_animation_events](https://developer.mozilla.org/en/CSS/CSS_animations#Using_animation_events)

基本上，我为动画的名称添加了一个类

```
#rotateCircle.rotate {
    -webkit-animation-name: moveCircle;
       -moz-animation-name: moveCircle;
         -o-animation-name: moveCircle;
            animation-name: moveCircle;
} 
```

而不是在 jQuery 中添加 CSS，您只需添加类并在动画完成时将其删除，`animationend`事件：

```
$(function() {
    var $rotateCircle = $('div#rotateCircle');
    $("a").click(function(){
        $rotateCircle.addClass('rotate')
        .on('animationend', function() {
            $rotateCircle.removeClass('rotate');
        });
    });
}); 
```

（我也让它看起来更好一点）这是[新的工作小提琴](http://jsfiddle.net/kcZBK/11/)。

注意：该`animationend`事件在某些浏览器上具有前缀，这是[我](https://gist.github.com/2025652)为支持所有不同浏览器所做的要点（您需要[Modernizr](http://modernizr.com)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:34:43.783

有一个[css3 转换](http://www.w3schools.com/css3/css3_transitions.asp)属性可以让这个任务变得非常简单。我在帖子中使用了 webkit，相应地更改了属性。
CSS

```
#rotateCircle.rotate {
    -webkit-transform: rotate(0);
    -webkit-transition: -webkit-transform 2s; //+ optional path i.e. linear
} 
```

然后使用 js，您只需将 css 属性设置为启用转换，它会神奇地为这些设置设置动画，在本例中为转换。

```
$(function() {
    var angle = 0;
    $("a").click(function(){
        angle += 90;
        $("div#rotateCircle").css("-webkit-transform", "rotate("+angle+"deg)";
    });
}); 
```

这段代码我没有测试过，但是transition属性用起来很简单，而且自从学会了之后，我就很少再使用keyframes/css动画属性了。

# android - 如何处理我的 android 设备中的后退按钮

> ID：11093201
> 
> 赞同：0
> 
> 时间：2012-06-19T01:20:00.350
> 
> 标签：android

我的设备上的“返回”按钮有问题

在我的项目中有一些布局和类。我们称它们为 A、B、C、D。如果我运行项目从布局“A”开始，然后是“B”、“C”、“D”。在我的布局位置“D”上并按下设备上的后退按钮，我将返回布局“C”，如果再次按下将返回“B”并再次返回“A”。

我真正想要的是，如果我在我的设备上点击“返回”，如果我在布局“D”中，那么我将保持在“D”的布局上。如果我在布局“C”中，那么我将坚持布局“C”。我应该添加什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T01:30:38.330

在您的 Activity 中，您可以覆盖 onBackPressed 并在其中执行您想要执行的所有处理。文档可[在此处](http://developer.android.com/reference/android/app/Activity.html#onBackPressed%28%29)获得。

您需要保留状态变量以了解您所在的位置以及用户按下后需要显示的内容......

`super.onBackPressed()`当您也想使用默认行为时，您可以随时调用（完成当前活动）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T02:22:00.963

您可以将此代码放在每个活动中：

```
@Override
    public boolean onKeyDown(int keyCode, KeyEvent event) {
        if (keyCode == KeyEvent.KEYCODE_BACK) {                         
        }
        return true;
} 
```

# php - 可以从辅助提交按钮向 PHP 表单发送变量吗？

> ID：11093202
> 
> 赞同：0
> 
> 时间：2012-06-19T01:20:05.017
> 
> 标签：php, html, forms, variables, submit

这真是个泡菜……

我有一个常规的 HTML 表单，其中有几个选项选择，什么没有，最终有一个提交按钮，可以将变量发送到我的 PHP 文件（header.php）。我还有第二个提交按钮，可以很好地提交表单，但问题是我希望有一个文本字段，用户只能在使用第二个提交按钮时输入他们的电子邮件（这将发送电子邮件作为 header.php 的变量）。而且由于提交按钮在标签之外，我不能再将用户的电子邮件作为变量添加到同一个 header.php 中。

**是否可以将电子邮件字段内容作为变量从将 HTML 表单变量和提交按钮变量发送到 header.php 的辅助提交按钮添加到 HTML 表单？**

或者有没有更简单/另一种方法来做类似的事情？

非常感谢，任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T01:25:09.440

哎呀。听起来你会想要一个临时的表单处理页面。像这样：

**form-handle.php**

```
if (isset ($_POST['email_address']) && isset ($_POST['SecondSubmitButton'])) {
  include ('process-second-form.php');
}
if (isset ($_POST['FirstSubmitButton'])) {
  include ('header.php');
} 
```

然后在每个文件中按您的需要处理它们。这有帮助吗？希望我没有误解这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T01:26:29.817

您可以创建表单来执行此操作，第一个仅用于将变量发送到您的 php 文件，另一个仅用于发送电子邮件，我希望这会有所帮助，我没有误解

# python - 在 Django 的一个模板中显示格式化多个表单的问题

> ID：11093204
> 
> 赞同：0
> 
> 时间：2012-06-19T01:20:29.617
> 
> 标签：python, html, django, django-forms, django-templates

我试图在一个模板中显示三个表单。我显示了表格，但是表格一个接一个地列出来。我试图让它们显示在三个单独的列中。

这是我的模板的样子：

```
<html lang="en">
<head>
    <title>Title</title>
</head>
<body>
    <h1>Header</h1>
    <form action="." method="POST">
    {% csrf_token %}
        <table>
            <tr>
                <th>h1</th>
                <th>h2</th>
                <th>h3</th>
            </tr>
            <tr>
                <td>{{ form1.as_table }}</td>
                <td>{{ form2.as_table }}</td>
                <td>{{ form3.as_table }}</td>
            </tr>
        </table>
        <p><input type="submit" value="Submit"></p>
    </form>
</body>
</html> 
```

当它渲染时，它会显示如下：

```
h1     h2     h3
form1
form2
form3 
```

我想要这样的东西：

```
h1     h2     h3
form1  form2  form3 
```

我该怎么做？

页面来源：

![在此处输入图像描述](../Images/d239f9151d1a4df7ea047c1837563691.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T02:52:15.383

Figured it out, this is what I had to do:

```
 <table>
        <tr>
        <td>
        <table>
            <th>h1</th>
            <td>{{ form1.as_table }}</td>
        </table>
        </td>
        <td>
        <table>
            <th>h2</th>
            <td>{{ form2.as_table }}</td>
        </table>
        </td>
        <td>
        <table>
            <th>h3</th>
            <td>{{ form3.as_table }}</td>
        </table>
        </td>
        </tr>
    </table> 
```

# ruby-on-rails - activeadmin 0.4.4 在 heroku 上崩溃缺少帮助文件 helpers/layout_helper.rb

> ID：11093211
> 
> 赞同：1
> 
> 时间：2012-06-19T01:21:26.380
> 
> 标签：ruby-on-rails, heroku, ruby-on-rails-plugins

我正在尝试在 Heroku 上部署一个在我的 PC 上运行良好的应用程序。它在heroku上崩溃：

**/app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/namespace.rb:191:in `eval': 缺少帮助文件 helpers/layout_helper.rb (LoadError)**

PC 详细信息：
Windows 7 x64
ruby​​ 1.9.3p194 (2012-04-20) [i386-mingw32]
Rails 3.2.5

```
$ bundle show
Gems included by the bundle:
  * actionmailer (3.2.5)
  * actionpack (3.2.5)
  * activeadmin (0.4.4)
  * activemodel (3.2.5)
  * activerecord (3.2.5)
  * activeresource (3.2.5)
  * activesupport (3.2.5)
  * arel (3.0.2)
  * bcrypt-ruby (3.0.1)
  * bourbon (2.1.0)
  * builder (3.0.0)
  * bundler (1.1.4)
  * coffee-rails (3.2.2)
  * coffee-script (2.2.0)
  * coffee-script-source (1.3.3)
  * devise (2.1.0)
  * diff-lcs (1.1.3)
  * erubis (2.7.0)
  * execjs (1.4.0)
  * faraday (0.8.1)
  * fastercsv (1.5.5)
  * formtastic (2.1.1)
  * has_scope (0.5.1)
  * hashie (1.2.0)
  * hike (1.2.1)
  * httpauth (0.1)
  * i18n (0.6.0)
  * inherited_resources (1.3.1)
  * journey (1.0.3)
  * jquery-rails (2.0.2)
  * json (1.7.3)
  * kaminari (0.13.0)
  * mail (2.4.4)
  * meta_search (1.1.3)
  * mime-types (1.18)
  * multi_json (1.3.6)
  * multipart-post (1.1.5)
  * mysql2 (0.3.11)
  * nifty-generators (0.4.6)
  * oauth (0.4.6)
  * oauth2 (0.6.1)
  * omniauth (1.1.0)
  * omniauth-facebook (1.3.0)
  * omniauth-google-apps (0.0.2)
  * omniauth-oauth (1.0.1)
  * omniauth-oauth2 (1.0.2)
  * omniauth-openid (1.0.1)
  * omniauth-twitter (0.0.11)
  * orm_adapter (0.0.7)
  * polyamorous (0.5.0)
  * polyglot (0.3.3)
  * rack (1.4.1)
  * rack-cache (1.2)
  * rack-openid (1.3.1)
  * rack-ssl (1.3.2)
  * rack-test (0.6.1)
  * rails (3.2.5)
  * rails3_acts_as_paranoid (0.2.4)
  * railties (3.2.5)
  * rake (0.9.2.2)
  * rdoc (3.12)
  * responders (0.9.1)
  * rest-client (1.6.7)
  * rspec (2.10.0)
  * rspec-core (2.10.1)
  * rspec-expectations (2.10.0)
  * rspec-mocks (2.10.1)
  * rspec-rails (2.10.1)
  * ruby-openid (2.1.8)
  * ruby-openid-apps-discovery (1.2.0)
  * sass (3.1.19)
  * sass-rails (3.2.5)
  * spork (1.0.0rc3)
  * spork-rails (3.2.0)
  * sprockets (2.1.3)
  * sqlite3 (1.3.6)
  * stripe (1.7.0)
  * thor (0.15.2)
  * tilt (1.3.3)
  * treetop (1.4.10)
  * tzinfo (0.3.33)
  * uglifier (1.2.4)
  * warden (1.1.1) 
```

完整的 Heroku 错误：

```
←[32m2012-06-19T01:01:16+00:00 heroku[web.1]:←[0m State changed from created to starting
←[32m2012-06-19T01:01:18+00:00 heroku[web.1]:←[0m Starting process with command `bundle exec rails server -p 50085`
←[32m2012-06-19T01:01:39+00:00 app[web.1]:←[0m DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle
 them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2
-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
←[32m2012-06-19T01:01:39+00:00 app[web.1]:←[0m DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle
 them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2
-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m => Booting WEBrick
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m => Rails 3.2.5 application starting in production on http://0.0.0.0:50085
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m => Call with -d to detach
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m => Ctrl-C to shutdown server
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m Exiting
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/namespace.rb:191:in `eval': Missing helper file helpers/layout_helper.rb (LoadError
)
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:312:in `depend_on'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:225:in `require_dependency'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.5/lib/abstract_controller/helpers.rb:135:in `block in modules_for_helpers'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.5/lib/abstract_controller/helpers.rb:131:in `map!'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.5/lib/abstract_controller/helpers.rb:131:in `modules_for_helpers'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.5/lib/action_controller/metal/helpers.rb:92:in `modules_for_helpers'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.5/lib/abstract_controller/helpers.rb:95:in `helper'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.5/lib/action_controller/railties/paths.rb:18:in `block (2 levels) in with'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/app/controllers/application_controller.rb:1:in `<top (required)>'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:251:in `require'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:251:in `block in require'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:236:in `load_dependency'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:251:in `require'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:359:in `require_or_load'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:502:in `load_missing_constant'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:192:in `block in const_missing'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:190:in `each'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:190:in `const_missing'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/inherited_resources-1.3.1/app/controllers/inherited_resources/base.rb:11:in `<module:InheritedResources>'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/inherited_resources-1.3.1/app/controllers/inherited_resources/base.rb:1:in `<top (required)>'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:251:in `require'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:251:in `block in require'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:236:in `load_dependency'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:251:in `require'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:359:in `require_or_load'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:502:in `load_missing_constant'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:192:in `block in const_missing'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:190:in `each'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:190:in `const_missing'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/base_controller/menu.rb:2:in `<module:ActiveAdmin>'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/base_controller/menu.rb:1:in `<top (required)>'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:251:in `require'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:251:in `block in require'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:236:in `load_dependency'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:251:in `require'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/base_controller.rb:2:in `<top (required)>'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/resource_controller/actions.rb:2:in `<module:ActiveAdmin>'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/resource_controller/actions.rb:1:in `<top (required)>'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:251:in `require'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:251:in `block in require'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:236:in `load_dependency'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:251:in `require'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/resource_controller.rb:2:in `<top (required)>'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/dashboards/dashboard_controller.rb:3:in `<module:Dashboards>'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/dashboards/dashboard_controller.rb:2:in `<module:ActiveAdmin>'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/dashboards/dashboard_controller.rb:1:in `<top (required)>'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from (eval):1:in `generate_dashboard_controller'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/namespace.rb:191:in `eval'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/namespace.rb:191:in `generate_dashboard_controller'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/namespace.rb:43:in `initialize'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/application.rb:110:in `new'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/application.rb:110:in `find_or_create_namespace'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/application.rb:98:in `register'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin.rb:74:in `register'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/app/admin/trades.rb:1:in `<top (required)>'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:245:in `load'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:245:in `block in load'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:236:in `load_dependency'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:245:in `load'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/application.rb:161:in `block in load!'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/application.rb:161:in `each'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/application.rb:161:in `load!'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/application.rb:187:in `routes'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin.rb:78:in `routes'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/config/routes.rb:2:in `block in <top (required)>'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.5/lib/action_dispatch/routing/route_set.rb:282:in `instance_exec'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.5/lib/action_dispatch/routing/route_set.rb:282:in `eval_block'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.5/lib/action_dispatch/routing/route_set.rb:260:in `draw'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/config/routes.rb:1:in `<top (required)>'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:245:in `load'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:245:in `block in load'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:236:in `load_dependency'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:245:in `load'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.5/lib/rails/application/routes_reloader.rb:40:in `block in load_paths'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.5/lib/rails/application/routes_reloader.rb:40:in `each'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.5/lib/rails/application/routes_reloader.rb:40:in `load_paths'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.5/lib/rails/application/routes_reloader.rb:16:in `reload!'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.5/lib/rails/application.rb:108:in `reload_routes!'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/reloader.rb:34:in `reload!'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activeadmin-0.4.4/lib/active_admin/reloader.rb:61:in `block in attach!'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/callbacks.rb:429:in `_run__1844096441965798486__prepare__2735152408631258
258__callbacks'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/callbacks.rb:405:in `__run_callback'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/callbacks.rb:385:in `_run_prepare_callbacks'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/callbacks.rb:81:in `run_callbacks'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.5/lib/action_dispatch/middleware/reloader.rb:74:in `prepare!'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.5/lib/action_dispatch/middleware/reloader.rb:48:in `prepare!'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.5/lib/rails/application/finisher.rb:47:in `block in <module:Finisher>'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.5/lib/rails/initializable.rb:30:in `instance_exec'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.5/lib/rails/initializable.rb:30:in `run'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.5/lib/rails/initializable.rb:55:in `block in run_initializers'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.5/lib/rails/initializable.rb:54:in `each'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.5/lib/rails/initializable.rb:54:in `run_initializers'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.5/lib/rails/application.rb:136:in `initialize!'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.5/lib/rails/railtie/configurable.rb:30:in `method_missing'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/config/environment.rb:5:in `<top (required)>'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:251:in `require'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:251:in `block in require'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:236:in `load_dependency'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:251:in `require'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/config.ru:4:in `block in <main>'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/config.ru:1:in `new'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/config.ru:1:in `<main>'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `eval'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `parse_file'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:200:in `app'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.5/lib/rails/commands/server.rb:46:in `app'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:301:in `wrapped_app'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:252:in `start'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.5/lib/rails/commands/server.rb:70:in `start'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.5/lib/rails/commands.rb:55:in `block in <top (required)>'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.5/lib/rails/commands.rb:50:in `tap'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.5/lib/rails/commands.rb:50:in `<top (required)>'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from script/rails:6:in `require'
←[32m2012-06-19T01:01:44+00:00 app[web.1]:←[0m  from script/rails:6:in `<main>'
←[32m2012-06-19T01:01:46+00:00 heroku[web.1]:←[0m Process exited with status 1
←[32m2012-06-19T01:01:46+00:00 heroku[web.1]:←[0m State changed from starting to crashed 
```

已安装 Heroku gem

```
Installing rake (0.9.2.2)
Installing i18n (0.6.0)
Installing multi_json (1.3.6)
Installing activesupport (3.2.5)
Installing builder (3.0.0)
Installing activemodel (3.2.5)
Installing erubis (2.7.0)
Installing journey (1.0.4)
Installing rack (1.4.1)
Installing rack-cache (1.2)
Installing rack-test (0.6.1)
Installing hike (1.2.1)
Installing tilt (1.3.3)
Installing sprockets (2.1.3)
Installing actionpack (3.2.5)
Installing mime-types (1.18)
Installing polyglot (0.3.3)
Installing treetop (1.4.10)
Installing mail (2.4.4)
Installing actionmailer (3.2.5)
Installing sass (3.1.19)
Installing bourbon (2.1.0)
Installing bcrypt-ruby (3.0.1) with native extensions
Installing orm_adapter (0.1.0)
Installing rack-ssl (1.3.2)
Installing json (1.7.3) with native extensions
Installing rdoc (3.12)
Installing thor (0.15.3)
Installing railties (3.2.5)
Installing warden (1.2.1)
Installing devise (2.1.1)
Installing fastercsv (1.5.5)
Installing formtastic (2.1.1)
Installing has_scope (0.5.1)
Installing responders (0.9.1)
Installing inherited_resources (1.3.1)
Installing jquery-rails (2.0.2)
Installing kaminari (0.13.0)
Installing arel (3.0.2)
Installing tzinfo (0.3.33)
Installing activerecord (3.2.5)
Installing polyamorous (0.5.0)
Installing meta_search (1.1.3)
Installing activeresource (3.2.5)
Using bundler (1.2.0.pre)
Installing rails (3.2.5)
Installing activeadmin (0.4.4)
Installing coffee-script-source (1.3.3)
Installing execjs (1.4.0)
Installing coffee-script (2.2.0)
Installing coffee-rails (3.2.2)
Installing multipart-post (1.1.5)
Installing faraday (0.8.1)
Installing hashie (1.2.0)
Installing httpauth (0.1)
Installing mysql2 (0.3.11) with native extensions
Installing oauth (0.4.6)
Installing oauth2 (0.6.1)
Installing omniauth (1.1.0)
Installing omniauth-oauth2 (1.0.2)
Installing omniauth-facebook (1.3.0)
Installing ruby-openid (2.1.8)
Installing rack-openid (1.3.1)
Installing omniauth-openid (1.0.1)
Installing ruby-openid-apps-discovery (1.2.0)
Installing omniauth-google-apps (0.0.2)
Installing omniauth-oauth (1.0.1)
Installing omniauth-twitter (0.0.11)
Installing rails3_acts_as_paranoid (0.2.4)
Installing rest-client (1.6.7)
Installing sass-rails (3.2.5)
Installing stripe (1.7.0)
Installing uglifier (1.2.4) 
```

我在 Heroku 上运行**cedar 堆栈，****版本**命令报告**2.27.3**。

我的应用程序 Gemfile：

```
source 'http://rubygems.org'

gem 'rails', '3.2.5'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

#gem 'sqlite3'

gem 'activeadmin'
gem 'meta_search'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'

  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
  # gem 'therubyracer', :platforms => :ruby

  gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails'

gem 'mysql2'

gem 'omniauth-facebook'
gem 'omniauth-google-apps'
gem 'omniauth-openid'
gem 'omniauth-twitter'
gem 'ruby-openid'

gem 'devise'

gem 'formtastic'

gem 'inherited_resources'

gem 'rails3_acts_as_paranoid'

gem 'stripe'

# To use ActiveModel has_secure_password
# gem 'bcrypt-ruby', '~> 3.0.0'

# To use Jbuilder templates for JSON
# gem 'jbuilder'

# Use unicorn as the app server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano'

# To use debugger
# gem 'debugger'

group :development do
  gem 'sqlite3'
  gem 'spork-rails'
  gem 'rspec-rails'
  gem 'nifty-generators'
end 
```

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T21:38:12.987

```
$ git ls-files 
.gitignore 
.idea/.generators 
.idea/.name 
.idea/.rakeTasks 
.idea/dataSources.ids 
.idea/dataSources.xml 
.idea/dictionaries/Desktop.xml 
.idea/encodings.xml 
.idea/misc.xml 
.idea/modules.xml 
.idea/scopes/scope_settings.xml 
.idea/travelingnuker-com.iml 
.idea/vcs.xml 
.idea/workspace.xml 
.rspec 
Gemfile 
Gemfile.lock 
README.rdoc 
Rakefile 
app/admin/admin_users.rb 
app/admin/dashboards.rb 
app/admin/outages.rb 
app/admin/plants.rb 
app/admin/services.rb 
app/admin/states.rb 
app/admin/trades.rb 
app/admin/unemployment_infos.rb 
app/admin/unions.rb 
app/admin/unit_aliases.rb 
app/admin/units.rb 
app/admin/users.rb 
app/assets/images/Aol_32.png 
app/assets/images/Facebook_32.png 
app/assets/images/Google_32.png 
app/assets/images/Myspace_32.png 
app/assets/images/Openid_32.png 
app/assets/images/Traveling-Nuker-Logo-Small.png 
app/assets/images/Traveling-Nuker-Logo-Wide.png 
app/assets/images/Twitter_32.png 
app/assets/images/Yahoo_32.png 
app/assets/images/backstripes.gif 
app/assets/images/bg_header.jpg 
app/assets/images/bullet1.gif 
app/assets/images/bullet2.gif 
app/assets/images/cal-grey.gif 
app/assets/images/cal.gif 
app/assets/images/chris-baran.png 
app/assets/images/cvv.gif 
app/assets/images/favicon.ico 
app/assets/images/gradient-e5e5e5-ffffff.gif 
app/assets/images/help.jpg 
app/assets/images/rails.png 
app/assets/images/unionlogos/hfiaw.gif 
app/assets/images/unionlogos/ibb.jpg 
app/assets/images/unionlogos/ibew.jpg 
app/assets/images/unionlogos/ironworkers.jpg 
app/assets/images/unionlogos/iuoe.jpg 
app/assets/images/unionlogos/iupat.jpg 
app/assets/images/unionlogos/liuna.jpg 
app/assets/images/unionlogos/smwia.png 
app/assets/images/unionlogos/ua.png 
app/assets/images/unionlogos/ubc.png 
app/assets/javascripts/active_admin.js 
app/assets/javascripts/application.js 
app/assets/javascripts/authentications.js.coffee 
app/assets/javascripts/home.js.coffee 
app/assets/javascripts/outage_lists.js.coffee 
app/assets/javascripts/page.js.coffee 
app/assets/javascripts/registrations.js.coffee 
app/assets/javascripts/users.js.coffee 
app/assets/stylesheets/active_admin.css.scss 
app/assets/stylesheets/application.css.scss 
app/assets/stylesheets/authentications.css.scss 
app/assets/stylesheets/blueprint/blueprint.css.scss 
app/assets/stylesheets/blueprint/forms.css 
app/assets/stylesheets/blueprint/grid.css 
app/assets/stylesheets/blueprint/grid.png 
app/assets/stylesheets/blueprint/ie.css 
app/assets/stylesheets/blueprint/reset.css 
app/assets/stylesheets/blueprint/typography.css 
app/assets/stylesheets/custom.css.scss 
app/assets/stylesheets/home.css.scss 
app/assets/stylesheets/outage_lists.css.scss 
app/assets/stylesheets/page.css.scss 
app/assets/stylesheets/registrations.css.scss 
app/assets/stylesheets/users.css.scss 
app/controllers/application_controller.rb 
app/controllers/authentications_controller.rb 
app/controllers/outage_lists_controller.rb 
app/controllers/pages_controller.rb 
app/controllers/registrations_controller.rb 
app/controllers/users_controller.rb 
app/helpers/Layout_helper.rb 
app/helpers/application_helper.rb 
app/helpers/authentications_helper.rb 
app/helpers/home_helper.rb 
app/helpers/outage_lists_helper.rb 
app/helpers/pages_helper.rb 
app/helpers/registrations_helper.rb 
app/helpers/users_helper.rb 
app/mailers/.gitkeep 
app/models/.gitkeep 
app/models/admin_user.rb 
app/models/authentication.rb 
app/models/contractor.rb 
app/models/contractor_contract.rb 
app/models/difference.rb 
app/models/outage.rb 
app/models/plant.rb 
app/models/service.rb 
app/models/state.rb 
app/models/subscription.rb 
app/models/subscription_affiliate.rb 
app/models/subscription_discount.rb 
app/models/subscription_notifier.rb 
app/models/subscription_payment.rb 
app/models/subscription_plan.rb 
app/models/subscription_plan_feature.rb 
app/models/subscription_plan_feature_list.rb 
app/models/trade.rb 
app/models/unemployment_info.rb 
app/models/union.rb 
app/models/unit.rb 
app/models/unit_alias.rb 
app/models/unit_status.rb 
app/models/user.rb 
app/views/devise/confirmations/new.html.erb 
app/views/devise/mailer/confirmation_instructions.html.erb 
app/views/devise/mailer/reset_password_instructions.html.erb 
app/views/devise/mailer/unlock_instructions.html.erb 
app/views/devise/passwords/edit.html.erb 
app/views/devise/passwords/new.html.erb 
app/views/devise/registrations/edit.html.erb 
app/views/devise/registrations/new.html.erb 
app/views/devise/sessions/new.html.erb 
app/views/devise/shared/_links.erb 
app/views/devise/unlocks/new.html.erb 
app/views/layouts/_footer.html.erb 
app/views/layouts/_header.html.erb 
app/views/layouts/application.html.erb 
app/views/outage_lists/index.html.erb 
app/views/pages/about_us.html.erb 
app/views/pages/help.html.erb 
app/views/pages/index.html.erb 
app/views/pages/nukeworker_faq.html.erb 
app/views/pages/plans.html.erb 
app/views/pages/tos.html.erb 
app/views/registrations/edit.html.erb 
app/views/registrations/new.html.erb 
app/views/subscription_notifier/charge_failure.html.erb 
app/views/subscription_notifier/charge_receipt.html.erb 
app/views/subscription_notifier/misc_receipt.html.erb 
app/views/subscription_notifier/plan_changed.html.erb 
app/views/subscription_notifier/setup_receipt.html.erb 
app/views/subscription_notifier/trial_expiring.html.erb 
app/views/users/dashboard.html.erb 
app/views/users/delete_account.html.erb 
config.ru 
config/application.rb 
config/boot.rb 
config/database.yml 
config/environment.rb 
config/environments/development.rb 
config/environments/production.rb 
config/environments/test.rb 
config/initializers/actionmailer.rb 
config/initializers/active_admin.rb 
config/initializers/backtrace_silencers.rb 
config/initializers/devise.rb 
config/initializers/formtastic.rb 
config/initializers/inflections.rb 
config/initializers/mime_types.rb 
config/initializers/secret_token.rb 
config/initializers/session_store.rb 
config/initializers/stripe.rb 
config/initializers/wrap_parameters.rb 
config/locales/devise.en.yml 
config/locales/en.yml 
config/routes.rb 
db/data/Seed 6-14-12.sql 
db/data/normalize_data.rb 
db/migrate/20120603175306_devise_create_users.rb 
db/migrate/20120603182040_customize_users.rb 
db/migrate/20120611172251_create_admin_notes.rb 
db/migrate/20120611172252_move_admin_notes_to_comments.rb 
db/migrate/20120611212211_devise_create_admin_users.rb 
db/migrate/20120611221508_create_outages.rb 
db/migrate/20120613214419_create_units.rb 
db/migrate/20120614152419_create_plants.rb 
db/migrate/20120614153853_create_services.rb 
db/migrate/20120614154222_create_states.rb 
db/migrate/20120614161132_create_trades.rb 
db/migrate/20120614165118_create_unemployment_infos.rb 
db/migrate/20120614205708_create_unions.rb 
db/migrate/20120614210051_create_unit_aliases.rb 
db/migrate/20120614210402_create_unit_statuses.rb 
db/migrate/20120614211227_create_authentications.rb 
db/migrate/20120614213331_create_differences.rb 
db/migrate/20120615000650_create_contractors.rb 
db/migrate/20120615001258_create_contractor_contracts.rb 
db/migrate/20120619033658_create_subscriptions.rb 
db/migrate/20120619041017_create_subscription_plans.rb 
db/migrate/20120619043549_create_subscription_plan_feature_lists.rb 
db/migrate/20120619044617_create_subscription_plan_features.rb 
db/migrate/20120619051802_create_subscription_payments.rb 
db/migrate/20120619072027_create_subscription_affiliates.rb 
db/migrate/20120619083424_create_subscription_discounts.rb 
db/schema.rb 
db/seeds.rb 
doc/README_FOR_APP 
lib/assets/.gitkeep 
lib/tasks/.gitkeep 
lib/templates/erb/scaffold/_form.html.erb 
log/.gitkeep 
public/404.html 
public/422.html 
public/500.html 
public/assets/Aol_32-1a6c49c34132684c4c424e6014a1460b.png 
public/assets/Aol_32.png 
public/assets/Facebook_32-56cd78cb046f8c110edbea8580a52c39.png 
public/assets/Facebook_32.png 
public/assets/Google_32-31dd8ed4ed8218ffb86813de859f1825.png 
public/assets/Google_32.png 
public/assets/Myspace_32-04ef7a4ea01d3ac863adc6e7c27fc145.png 
public/assets/Myspace_32.png 
public/assets/Openid_32-0010c4d031958a273ed9339d4b6fe996.png 
public/assets/Openid_32.png 
public/assets/Traveling-Nuker-Logo-Small-6e97a922e907b1d29aa0252a39f0e9c4.png 
public/assets/Traveling-Nuker-Logo-Small.png 
public/assets/Traveling-Nuker-Logo-Wide-d36b29a77ba0e0afa34f7daa4c37ef83.png 
public/assets/Traveling-Nuker-Logo-Wide.png 
public/assets/Twitter_32-d5ad07c40b2b038c8c99917c720060ed.png 
public/assets/Twitter_32.png 
public/assets/Yahoo_32-6f27c922bb27c3558554bb263bed5040.png 
public/assets/Yahoo_32.png 
public/assets/active_admin-8106e85ad95955c15013ac8969ec2482.js 
public/assets/active_admin-8106e85ad95955c15013ac8969ec2482.js.gz 
public/assets/active_admin-f55a970cc8f92d42a0dc76037952528d.css 
public/assets/active_admin-f55a970cc8f92d42a0dc76037952528d.css.gz 
public/assets/active_admin.css 
public/assets/active_admin.css.gz 
public/assets/active_admin.js 
public/assets/active_admin.js.gz 
public/assets/active_admin/admin_notes_icon-04bd616ed9d1ff51d7a53422d4caf510.png 
public/assets/active_admin/admin_notes_icon.png 
public/assets/active_admin/application-07fb877e0a0431c839801f158020b702.js 
public/assets/active_admin/application-07fb877e0a0431c839801f158020b702.js.gz 
public/assets/active_admin/application.js 
public/assets/active_admin/application.js.gz 
public/assets/active_admin/datepicker/datepicker-header-bg-5f452fde9ca93c1fe7e9d47f0a3ece6a.png 
public/assets/active_admin/datepicker/datepicker-header-bg.png 
public/assets/active_admin/datepicker/datepicker-input-icon-876ae70b38bc880f91ce2315ed552260.png 
public/assets/active_admin/datepicker/datepicker-input-icon.png 
public/assets/active_admin/datepicker/datepicker-next-link-icon-23a49449514d929cfc8c5c9b7c510d3b.png 
public/assets/active_admin/datepicker/datepicker-next-link-icon.png 
public/assets/active_admin/datepicker/datepicker-nipple-e13362aa148d84973a266eeee0b89e9a.png 
public/assets/active_admin/datepicker/datepicker-nipple.png 
public/assets/active_admin/datepicker/datepicker-prev-link-icon-43d0f297400cd14812abc8f7c6705d17.png 
public/assets/active_admin/datepicker/datepicker-prev-link-icon.png 
public/assets/active_admin/loading-38b99f1fc3078c0d0403fdf80e22f896.gif 
public/assets/active_admin/loading.gif 
public/assets/active_admin/nested_menu_arrow-dcb32755d9740e23965a1e76bb945ce9.gif 
public/assets/active_admin/nested_menu_arrow.gif 
public/assets/active_admin/nested_menu_arrow_dark-f9fe6b6a563b7b15f3cd1be4e98d1ce0.gif 
public/assets/active_admin/nested_menu_arrow_dark.gif 
public/assets/active_admin/orderable-d9e1503253eff94adee978d6f43f2409.png 
public/assets/active_admin/orderable.png 
public/assets/application-0238dd46e6f519804b2702287114d150.js 
public/assets/application-0238dd46e6f519804b2702287114d150.js.gz 
public/assets/application-3ec33221355ebfa321663ecbe4ac767f.css 
public/assets/application-3ec33221355ebfa321663ecbe4ac767f.css.gz 
public/assets/application.css 
public/assets/application.css.gz 
public/assets/application.js 
public/assets/application.js.gz 
public/assets/backstripes-0fab8c43ff641c785ef54fdce999b42f.gif 
public/assets/backstripes.gif 
public/assets/bg_header-c6f8f39be5373f0f4ac16adbf535390f.jpg 
public/assets/bg_header.jpg 
public/assets/blueprint/grid-99a56fe9528f46c2bbb7084a7e34bb4f.png 
public/assets/blueprint/grid.png 
public/assets/bullet1-064f37cf76389c03e6bf30b9b4cbc9c1.gif 
public/assets/bullet1.gif 
public/assets/bullet2-515ae1d51ee13f93f1839d278b1253fb.gif 
public/assets/bullet2.gif 
public/assets/cal-ae0f4c6add16d31a81762a8a956810fc.gif 
public/assets/cal-grey-5f974f544088835b3e8066179d2156cb.gif 
public/assets/cal-grey.gif 
public/assets/cal.gif 
public/assets/chris-baran-adc4f56c4dfe73e5ef9b87dde6902c43.png 
public/assets/chris-baran.png 
public/assets/cvv-1e754aa113fa03851d88a2ba5c14f5a5.gif 
public/assets/cvv.gif 
public/assets/favicon-c6c841693b043edd73baffbd217cf86e.ico 
public/assets/favicon.ico 
public/assets/gradient-e5e5e5-ffffff-13165a4881bd9eeeb323550641b28347.gif 
public/assets/gradient-e5e5e5-ffffff.gif 
public/assets/help-96b5cb035a19b7ccf2ffd7f2f57f74c4.jpg 
public/assets/help.jpg 
public/assets/manifest.yml 
public/assets/rails-be8732dac73d845ac5b142c8fb5f9fb0.png 
public/assets/rails.png 
public/assets/unionlogos/hfiaw-ef9657096f75e427d994b86385fb4a53.gif 
public/assets/unionlogos/hfiaw.gif 
public/assets/unionlogos/ibb-2df808fa1ee6ec0fafe1bd9e88e04916.jpg 
public/assets/unionlogos/ibb.jpg 
public/assets/unionlogos/ibew-8d7c2d6d987dc77e978bf1105fb9dadd.jpg 
public/assets/unionlogos/ibew.jpg 
public/assets/unionlogos/ironworkers-1f1aeca4387f15a1630822ee7c7a553c.jpg 
public/assets/unionlogos/ironworkers.jpg 
public/assets/unionlogos/iuoe-d69f45647c3e15a89cb3c7fa2acbb892.jpg 
public/assets/unionlogos/iuoe.jpg 
public/assets/unionlogos/iupat-12eb9dc83b3b7d9c4de967202118d4e8.jpg 
public/assets/unionlogos/iupat.jpg 
public/assets/unionlogos/liuna-418a82dd5fcb244c1936d7cf4f39caa0.jpg 
public/assets/unionlogos/liuna.jpg 
public/assets/unionlogos/smwia-3531293f003837e5a7b5bd8c473ea3cb.png 
public/assets/unionlogos/smwia.png 
public/assets/unionlogos/ua-14c86465eca7a1ec0974cee962def380.png 
public/assets/unionlogos/ua.png 
public/assets/unionlogos/ubc-147f9f91c17ad3d5bbcf6d0fd4774696.png 
public/assets/unionlogos/ubc.png 
public/favicon.ico 
public/robots.txt 
script/rails 
spec/controllers/authentications_controller_spec.rb 
spec/controllers/home_controller_spec.rb 
spec/controllers/outage_lists_controller_spec.rb 
spec/controllers/pages_controller_spec.rb 
spec/controllers/registrations_controller_spec.rb 
spec/controllers/users_controller_spec.rb 
spec/helpers/authentications_helper_spec.rb 
spec/helpers/home_helper_spec.rb 
spec/helpers/outage_lists_helper_spec.rb 
spec/helpers/pages_helper_spec.rb 
spec/helpers/registrations_helper_spec.rb 
spec/helpers/users_helper_spec.rb 
spec/models/authentication_spec.rb 
spec/models/contractor_contract_spec.rb 
spec/models/contractor_spec.rb 
spec/models/difference_spec.rb 
spec/models/plant_spec.rb 
spec/models/service_spec.rb 
spec/models/state_spec.rb 
spec/models/subscription_affiliates_spec.rb 
spec/models/subscription_discount_spec.rb 
spec/models/subscription_payments_spec.rb 
spec/models/subscription_plan_feature_list_spec.rb 
spec/models/subscription_plan_feature_spec.rb 
spec/models/subscription_plan_features_spec.rb 
spec/models/subscription_plan_spec.rb 
spec/models/subscriptions_spec.rb 
spec/models/trade_spec.rb 
spec/models/unemployment_info_spec.rb 
spec/models/unions_spec.rb 
spec/models/unit_alias_spec.rb 
spec/models/unit_status_spec.rb 
spec/spec_helper.rb 
test/fixtures/.gitkeep 
test/fixtures/admin_users.yml 
test/fixtures/outages.yml 
test/fixtures/units.yml 
test/fixtures/users.yml 
test/functional/.gitkeep 
test/integration/.gitkeep 
test/performance/browsing_test.rb 
test/test_helper.rb 
test/unit/.gitkeep 
test/unit/admin_user_test.rb 
test/unit/outage_test.rb 
test/unit/unit_test.rb 
test/unit/user_test.rb 
```

这个问题是因为我的 Layout_helper.rb 文件的文件名中有一个大写的“L”。考虑到我在 Windows 上创建了这个项目，这很奇怪。它确实解释了为什么我可以在 Windows 上毫无问题地运行这个应用程序。我必须在 linux 系统上检查这一点，将文件名更改为小写“L”并将其提交回来。然后它很好，完美启动！

# php - 将 MySQL 日期时间转换为倒计时

> ID：11093215
> 
> 赞同：-1
> 
> 时间：2012-06-19T01:21:50.223
> 
> 标签：php, datetime

给定这样的日期时间字符串：

```
2012-06-19 03:44:39 
```

我想用它来提供倒计时（以分钟为单位），直到那个时间。

```
You can post again in <?php echo date('i', strtotime($expires) - strtotime(time())) ?> minutes. 
```

这就是我所拥有的，但它总是说 15 分钟。可能是因为`time()`不是正确使用的功能，但我不确定。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T01:23:34.480

[`time()`](http://php.net/manual/en/function.time.php)已经返回一个时间戳，所以你不必使用`strtotime`它：

```
<?php echo date('i', strtotime($expires) - time()) ?> 
```

# java - java中wordCount频率返回重复Set

> ID：11093217
> 
> 赞同：0
> 
> 时间：2012-06-19T01:22:07.557
> 
> 标签：java, frequency, word-count

我有一个将单个单词作为字符串返回的方法。我需要计算读取文本块的方法返回的所有单词。问题是我的计数正确但输出错误。它在重复。不太确定哪里出了问题？

```
private int totalWords    = 0;
private static Map<String, Integer> wordFrequency = new HashMap<String, Integer>();

public static void findResult(CharacterReader characterReader)
{
    boolean x = true;
    CharBuffer buffer = CharBuffer.allocate(100);
    String str = "";
    try
    {

        while(x)
        {
        char cha = characterReader.getNextChar();
        Set<Character> charSet = new HashSet<Character>();
            charSet.add(',');
            charSet.add('.');
            charSet.add(';');
            charSet.add(':');
            charSet.add('\'');
            charSet.add('~');
            charSet.add('?');
            charSet.add('!');
            charSet.add('%');

            while(cha != ' ' && !charSet.contains(cha))
            {
                buffer.put(cha);
                cha = characterReader.getNextChar();
            }
            buffer.flip();
            str = buffer.toString();
            buffer.clear();

            countWords(str);

            System.out.println(wordFrequency);

        }
    }catch(EOFException e)

    {
        x = false;
    }

private static void countWords(String word)
        {

                if (wordFrequency.containsKey(word))
                {
                    Integer count = wordFrequency.get(word);
                    count++;
                    wordFrequency.put(word, count);
                    } else {
                    wordFrequency.put(word, 1);
                }
        }

public static void main (String args[])
{
    CharacterReader cr = new SimpleCharacterReader();
    findResult(cr);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T01:43:12.823

移动

System.out.println(wordFrequency);

到 try 语句之外。您在每个单词之后打印整套。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T02:51:58.133

Try moving System.out.println(wordFrequency); out of the while loop braces...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T01:42:32.963

这一切都在您放置 System.out.println 的地方。你已经把它***放在***循环里面了！

```
 while(x) {
        // .....

        countWords(str);

        System.out.println(wordFrequency);
    } 
```

解决方案：在循环*之后执行。*

```
 while(x) {
        // .....

        countWords(str);

    }
    System.out.println(wordFrequency); 
```

# c - 用 C 解析 wtmp 日志

> ID：11093218
> 
> 赞同：1
> 
> 时间：2012-06-19T01:22:12.250
> 
> 标签：c, file-io, struct, fread

对于我们的任务，我们得到了一份`wtmp`日志副本，并期望对其进行解析，并以排序格式输出，类似于`last`.

现在，我知道该文件`wtmp`由`utmp`结构列表组成。提供的文件保证包含至少一个 utmp 结构，我应该假设二进制文件中的所有结构都正确构建。

我已经通读了`man utmp`，并且我已经成功编写了一个程序来从提供的二进制文件中读取结构。（我为冗长的打印方法道歉）

```
#include <stdio.h>
#include <string.h>
#include <utmp.h>
#include <stdlib.h>

void utmpprint(struct utmp *log);

int main() {

    int logsize = 10;
    FILE *file;
    struct utmp log[logsize];
    int i = 0;

    file = fopen("wtmp", "rb");

    if (file) {
            fread(&log, sizeof(struct utmp), logsize, file);
            for(i = 0; i < logsize; i++) {
                    utmpprint(&log[i]);
            }
    } else {
            return(0);
    }
    return(0);
}

void utmpprint(struct utmp *log) {
    printf("{ ut_type: %i, ut_pid: %i, ut_line: %s, ut_id: %s,
        ut_user: %s, ut_host:   %s, ut_exit: { e_termination: %i,
        e_exit: %i }, ut_session: %i, timeval: { tv_sec: %i, tv_usec: %i },
        ut_addr_v6: %i }\n\n", log->ut_type, log->ut_pid, log->ut_line,
        log->ut_id, log->ut_user, log->ut_host, log->ut_exit.e_termination,
        log->ut_exit.e_exit, log->ut_session, log->ut_tv.tv_sec,
        log->ut_tv.tv_usec, log->ut_addr_v6);
} 
```

现在，我遇到的问题是，当我运行它时，输出与`ut_id`我预期的不同。

从：`man utmp`

```
char ut_id[4];      /*Terminal name suffix, or inittab(5) ID */ 
```

我的输出：

```
... ut_line: pts/2, ut_id: ts/2jsmith, ut_user: jsmith, ... 
```

我不太确定这里发生了什么。我认为可能发生的是 ut_id 字段可能不存在于我正在阅读的结构中。我认为这可以解释为什么 ut_id 字段显示为它两侧的字段被挤压在一起。

我认为我可以使用 fprintf 格式来使字段正确显示，但似乎您只能将文本格式化到 char 数组的一侧或另一侧，而不是从字符串内部获取特定部分。

否则，我很迷茫。这只是我对结构理解的一个差距吗？

不是在寻找答案，更多的是在正确的方向上进行一些刺激。

另外，终端名称后缀到底是什么？那只是后面的数字`pts/`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T01:29:47.180

[man utmp](http://linux.die.net/man/5/utmp)说“如果字符串字段短于字段的大小，则字符串字段以空字节 ('\0') 终止。” 因此，特别是，如果它们与字段大小相同，则它们*不会*以空字节终止。格式良好的 C 字符串必须以空字节结尾。该字段看起来`ut_id`是 4 个字符长的“ts/2”这一事实表明它没有终止的空字节。

您正在使用 %s 格式参数打印 char 数组`printf`。这会一直打印，直到达到空字节。我建议您需要将 的每个字段复制`utmp`到一个临时 char 数组中，该数组*比*结构中的大小大一个`utmp`。确保该临时数组的最后一个字节是空字节，并且应该打印出 OK。

# web-services - 关于如何设计休息端点 url 以检索实体计数的建议

> ID：11093221
> 
> 赞同：0
> 
> 时间：2012-06-19T01:23:02.520
> 
> 标签：web-services, rest

> **可能重复：**
> [获取 RESTful 请求看到的返回计数](https://stackoverflow.com/questions/1610862/getting-a-count-of-returns-seen-by-a-restful-request)

我有一个休息网络服务，它以 json 格式检索实体列表，准备进行分页，如下所示：

```
http://localhost:9001/events?page=1&len=3&order=name%20desc&filter=quilmes
[
  {
    id: 222,
    field: "name",
    prev: "",
    operation: "insert",
    date: "2012-01-01T10:32:10Z",
  } [...]
] 
```

为了显示浏览页面，我需要返回实体总数

我正在考虑以下替代方案：

```
http://localhost:9001/events?filter=quilmes&op=count

http://localhost:9001/events/count?filter=quilmes 
```

我认为第二个选项更好，因为它表明我正在访问不同的资源

无论如何，我想知道是否有一些标准（我知道在 REST 世界中没有多少标准）、已建立的模式、推荐的做法，或者你可以针对这个特殊情况给我的任何建议......

# iphone - 使用 UIWebView 时如何显示百分比（%）

> ID：11093222
> 
> 赞同：0
> 
> 时间：2012-06-19T01:23:14.983
> 
> 标签：iphone, ios, uiwebview

使用 UIWebView 时，某些应用程序可以在加载网站时显示百分比。我找到了一些方法，但不能正常工作，例如：

1.使用 NSUrlConnection 获取 HTML ，然后使用 UIWebView 加载 HTML

```
- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
{
  theTotalLength = response.expectedContentSize;
} 
```

但是，有时没有“expectedContentSize”可以得到。

2.使用私有功能，但无法发布AppStore。此功能 [在此处输入链接说明](https://github.com/petr-inmite/imtwebview)

有人知道吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T02:34:13.403

您可以使用该`estimatedProgress`属性，详见[此处](http://winxblog.com/2009/02/iphone-uiwebview-estimated-progress/)。请注意，这是一项私有功能，但根据指南，App Store 中有一些应用程序确实使用了它。

# gradle - 如何在 gradle 中使用 exec() 输出

> ID：11093223
> 
> 赞同：55
> 
> 时间：2012-06-19T01:23:23.920
> 
> 标签：gradle

我正在尝试实现一个 gradle 任务，从一系列环境变量值和 shell 执行中动态创建一个 buildsignature.properties 文件。我大部分时间都在工作，但我似乎无法获得 shell 命令的输出。这是我的任务...

```
task generateBuildSignature << {
    ext.whoami = exec() {
        executable = "whoami"
    }
    ext.hostname = exec() {
         executable = "hostname"
    }
    ext.buildTag = System.env.BUILD_TAG ?: "dev"

    ant.propertyfile(
        file: "${buildDir}/buildsignature.properties",
        comment: "This file is automatically generated - DO NOT EDIT!" ) {
        entry( key: "version", value: "${project.version}" )
        entry( key: "buildTimestamp", value: "${new Date().format('yyyy-MM-dd HH:mm:ss z')}" )
        entry( key: "buildUser", value: "${ext.whoami}" )
        entry( key: "buildSystem", value: "${ext.hostname}" )
        entry( key: "buildTag", value: "$ext.buildTag" )
    }
} 
```

但是生成的属性字段没有得到 buildUser 和 buildSystem 的预期结果。

```
#This file is automatically generated - DO NOT EDIT!
#Mon, 18 Jun 2012 18:14:14 -0700
version=1.1.0
buildTimestamp=2012-06-18 18\:14\:14 PDT
buildUser=org.gradle.process.internal.DefaultExecHandle$ExecResultImpl@2e6a54f9
buildSystem=org.gradle.process.internal.DefaultExecHandle$ExecResultImpl@46f0bf3d
buildTag=dev 
```

如何让 buildUser 和 buildSystem 匹配相应 exec 的输出，而不是一些默认的 ExecResultImpl toString？这真的不会那么难，不是吗？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-12-01T16:42:03.477

这是我从 exec 获取标准输出的首选语法：

```
def stdout = new ByteArrayOutputStream()
exec{
    commandLine "whoami"
    standardOutput = stdout;
}
println "Output:\n$stdout"; 
```

在这里找到：http: [//gradle.1045684.n5.nabble.com/external-process-execution-td1431883.html](http://gradle.1045684.n5.nabble.com/external-process-execution-td1431883.html) （请注意，页面有一个错字，但提到了 ByteArrayInputStream 而不是 ByteArrayOutputStream）

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2012-06-19T02:53:42.557

这篇[文章](http://mrhaki.blogspot.com/2010/10/gradle-goodness-parse-output-from-exec.html)描述了如何解析`Exec`调用的输出。您将在下面找到两个运行您的命令的任务。

```
task setWhoamiProperty {
    doLast {
        new ByteArrayOutputStream().withStream { os ->
            def result = exec {
                executable = 'whoami'
                standardOutput = os
            }
            ext.whoami = os.toString()
        }
    }
}

task setHostnameProperty {
    doLast {
        new ByteArrayOutputStream().withStream { os ->
            def result = exec {
                executable = 'hostname'
                standardOutput = os
            }
            ext.hostname = os.toString()
        }
    }
}

task printBuildInfo {
    dependsOn setWhoamiProperty, setHostnameProperty
    doLast {
         println whoami
         println hostname
    }
} 
```

实际上有一种更简单的方法来获取这些信息，而无需调用 shell 命令。

当前登录用户：`System.getProperty('user.name')`

主机名：`InetAddress.getLocalHost().getHostName()`

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2018-09-17T13:04:02.470

使用[`kotlin-dsl`](https://github.com/gradle/kotlin-dsl/)：

```
import java.io.ByteArrayOutputStream

val outputText: String = ByteArrayOutputStream().use { outputStream ->
  project.exec {
    commandLine("whoami")
    standardOutput = outputStream
  }
  outputStream.toString()
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2020-09-26T19:49:09.603

在许多情况下，Groovy 允许更简单的实现。因此，如果您使用基于 Groovy 的构建脚本，您可以简单地执行以下操作：

```
def cmdOutput = "command line".execute().text 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-12-01T03:02:50.590

从[Exec 的 Gradle 文档中解释](https://docs.gradle.org/current/dsl/org.gradle.api.tasks.Exec.html)：

```
task execSomething {
  doFirst {
    exec {
      workingDir '/some/dir'
      commandLine '/some/command', 'arg'

      ...
      //store the output instead of printing to the console:
      standardOutput = new ByteArrayOutputStream()

      //extension method execSomething.output() can be used to obtain the output:
      ext.output = {
        return standardOutput.toString()
      }
    }
  }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-12-11T16:54:03.563

# kotlin-dsl 变体

## Groovy 风格

在[buildSrc](https://docs.gradle.org/current/userguide/organizing_gradle_projects.html#sec:build_sources)中：

```
import org.codehaus.groovy.runtime.ProcessGroovyMethods

fun String.execute(): Process = ProcessGroovyMethods.execute(this)
fun Process.text(): String = ProcessGroovyMethods.getText(this) 
```

build.gradle.kts：

```
"any command you want".execute().text().trim() 
```

* * *

## 执行风格

在[buildSrc](https://docs.gradle.org/current/userguide/organizing_gradle_projects.html#sec:build_sources)中：

```
import org.gradle.api.Project
import org.gradle.process.ExecSpec
import java.io.ByteArrayOutputStream

fun Project.execWithOutput(spec: ExecSpec.() -> Unit) = ByteArrayOutputStream().use { outputStream ->
    exec {
        this.spec()
        this.standardOutput = outputStream
    }
    outputStream.toString().trim()
} 
```

build.gradle.kts：

```
val outputText = project.execWithOutput {
    commandLine("whoami")
}

//variable project is actually optional

val outputText = execWithOutput {
    commandLine("whoami")
} 
```

# php - 使 MySQL 数据库关系化并更新现有 PHP 代码

> ID：11093230
> 
> 赞同：0
> 
> 时间：2012-06-19T01:24:32.167
> 
> 标签：php, mysql

我有一个名为 csftdb 的 MySQL 数据库，在该数据库中存在 1 个表：articles。

我还有一系列 PHP 表单，可以在数据库中的表中添加、编辑和删除条目。

但是，现在我尝试添加搜索功能，发现单表方法是不够的。

表格是这样布置的：

```
id - articletitle - articleorganization - articledate - articleurl - articletags 
```

PHP 表单之一是搜索表单，它可以在标签发挥作用时起作用，例如：

假设数据库中有 3 篇文章：

```
01 - My first article - Article Corp. - 05/28/2010 - www.articlecorp.com/article1 - php, html
02 - My second article - Article Corp. - 08/11/2012 - www.articlecorp.com/article2 - asp, html
03 - My third article - Article Corp. - 12/22/2011 - www.articlecorp.com/article3 - c++, html 
```

然后我有一个搜索表单，其中包含 Title、Organization、Date、URL 和 Tag(s) 字段。我可以在“标题”字段中搜索“我的第一篇文章”，并且只检索第一个条目，但我也可以在“标题”字段中搜索“文章”，它会检索所有 3 个条目。这是期望的行为。此外，我可以在“标题”字段和“Article Corp”中搜索“文章”。在“组织”字段中，它只会显示与该集合匹配的条目（因此，如果其他组织的文章标题中也有“文章”一词，则这些组织不会出现在结果中。）这也是需要的行为。

但是，如果我在标题字段中搜索“Article”，然后在 Tag(s) 字段中搜索“php, asp, c++”，我的搜索将不会返回任何结果。这不是期望的行为。在这种情况下，“标签”应该允许对搜索结果进行更精细的粒度级别。

所以我可以想象有一千篇文章，所有文章都具有完全相同的标题等信息，但标签组合不同，我可以搜索标签并检索所有仅应用了这些标签的文章。

为此，我在我的数据库中创建了 2 个新表并更改了原来的表，这样我的表现在是：

```
articles:
id | articletitle | articleorganization | articledate | articleurl

tags:
id | tags 
```

和

```
articles_tags:
article_id | tag_id 
```

我还有以下从原始表单修改的 PHP 表单：

```
 <?php
     function renderForm($articletitle, $articleorganization, $articledate, $articleurl, $articletags )
     {
     ?>
    . . .
      <div class="content">
            <div id="stylized" class="myform">
          <form id="form" name="form" action="" method="post">
            <h1>Create a new entry in the database</h1>
            <table width="100%" border="0" cellpadding="6">
              <tr>
                <td colspan="2"><legend>Article details</legend></td>
              </tr>
              <tr>
                <td width="20%" align="right"><span class="field">Article Title:</span></td>
                <td width="80%" align="left"><span class="field">
                  <input name="articles.articletitle" type="text" value="<?php echo $articletitle; ?>" size="50"/>
                </span></td>
              </tr>
              <tr>
                <td align="right"><span class="field">Article Author:</span></td>
                <td align="left"><span class="field">
                  <input name="articleorganization" type="text" value="<?php echo $articles.articleorganization; ?>" size="50"/>
                </span></td>
              </tr>
              <tr>
                <td align="right"><span class="field">Access Date:</span></td>
                <td align="left"><span class="field">
                  <input name="articles.articledate" type="text" value="MM/DD/YYYY" size="50"/>
                </span></td>
              </tr>
              <tr>
                <td align="right"><span class="field">Article URL:</span></td>
                <td align="left"><span class="field">
                <input name="articleurl" type="text" value="<?php echo $articles.articleurl; ?>" size="50"/>
                </span></td>
              </tr>
              <tr>
                <td align="right"><span class="field">Article Tags:</span></td>
                <td align="left"><span class="field">
                <input name="articletags" type="text" value="<?php echo $tags.articletags; ?>" size="50"/>
                </span></td>
              </tr>
            </table>
            <footer><input type="submit" name="submit" value="Add this Article"></footer>
            </form>
        </div>
        . . .
    </body>
    </html>
    <?php 
     }

     . . .
      if($_SERVER['REQUEST_METHOD'] == 'POST')
      { 
        // get form data, making sure it is valid
        $articletitle = mysql_real_escape_string(htmlspecialchars($_POST['articletitle']));
        $articleorganization = mysql_real_escape_string(htmlspecialchars($_POST['articleorganization']));
        $articledate = mysql_real_escape_string(htmlspecialchars($_POST['articledate']));
        $articleurl = mysql_real_escape_string(htmlspecialchars($_POST['articleurl']));

     . . .

     mysql_query("INSERT articles SET articletitle='$articletitle', articleorganization='$articleorganization', articledate='$articledate', articleurl='$articleurl', articletags='$tags.articletags' ")
     or die(mysql_error()); 

       header("Location:addsuccess.php"); 
      }
     }
     else

     {
      renderForm('','','','','');
     }
    ?> 
```

但是，我似乎无法将信息存储到我的第二张表中，因此，我无法让我的关系正常工作。

我整天都在看这个，无法弄清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T01:37:12.933

您需要添加更多的 INSERT 查询才能使其正常工作。

```
if (mysql_query ("INSERT INTO `articles` SET
  `articletitle` = '$articletitle',
  `articleorganization` = '$articleorganization',
  `articledate` = '$articledate',
  `articleurl` = '$articleurl'")) {

  $article_id = mysql_insert_id();
}

$tags = split (' ', $_POST['articletags']);
foreach ($tags as $tag) {
  // check if tag exists in tag table and get id, if not, insert it and get mysql_insert_id()
  // then insert article_id with tag_ids into your articles_tags table
} 
```

这很粗糙，但它的想法。另外，如果我没记错的话，“拆分”是贬值的，所以你会想找到另一个选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T01:31:27.080

对于每个提交的标签，您需要查看它是否存在，如果不存在，则需要添加它，然后存储所有关系。

如果一个或多个标签已被删除，您还应该与原始值进行比较，然后检查每个已删除的标签是否是该标签的唯一使用变体，以便您可以将其从标签和关系表中删除。

# linux - 后台接地和子处理期间的可变可访问性

> ID：11093231
> 
> 赞同：2
> 
> 时间：2012-06-19T01:24:34.130
> 
> 标签：linux, bash, shell

我有以下两个脚本：

“scr1.sh”

```
#!/bin/sh

func_in_scr1()
{

    echo func_in_scr1 var is $var

}

var=7645

func_in_scr1 &

( func_in_scr1 )

./scr2.sh 
```

“scr2.sh”

```
echo in scr2 var is $var 
```

这是输出：

*   func_in_scr1 var 是 7645
*   func_in_scr1 var 是 7645
*   在 scr2 var 是

问题：

1.  当 scr1.sh 中的函数在 bg 和 subshel​​l 中运行时，它能够访问 $var 的值。
2.  但是 scr2.sh 无法访问 $var 的值。

我的印象是子进程（子进程）只能访问导出的变量而不能访问未导出的变量，所以我对 #1 感到特别惊讶。

有人可以解释这个结果吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T07:15:28.530

In these two cases:

```
func_in_scr1 &
( func_in_scr1 ) 
```

you start subshells. That is right that they are separate processes also but they see all variables of the parent shell (but of course you cannot give changes in this variables back; they are simple copies created during fork() of parent).

In this case

```
./scr2.sh 
```

there is no subshell. You run a separate process. The parent shell knows nothing about it. Ant its has no other ability to give variables to him except exporting.

# jekyll - 在 Jekyll 中使用 pygments 时如何支持滚动

> ID：11093233
> 
> 赞同：18
> 
> 时间：2012-06-19T01:24:59.467
> 
> 标签：jekyll, pygments

在 Jekyll 中工作时，是否可以在使用 pygments 突出显示的代码部分中使用水平滚动而不是文本换行。

文件来源：

```
{% highlight bash %}

Full thread dump OpenJDK Client VM (19.0-b09 mixed mode, sharing):

"Attach Listener" daemon prio=10 tid=0x0a482400 nid=0x5105 waiting on condition [0x00000000]
java.lang.Thread.State: RUNNABLE
....
{% endhighlight %} 
```

生成的页面（注意十六进制地址被包装而不是滚动）： ![在此处输入图像描述](../Images/9dc1acee334af121b66883ccf97b37b6.png)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-21T12:57:13.857

在以下位置找到您的 highlight.css：/PROJECT_ROOT/assets/themes/THEME_NAME/css/highlight.css

并在最后添加这一行：

```
pre { white-space: pre; overflow: auto; } 
```

感谢@manatwork 的解决方案。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2014-04-30T16:57:13.637

这个答案专门处理在 github 页面上使用 pygments 和 jekyll

突出显示是这样生成的：

```
<div class="highlight">
  <pre>
    <code>
      ... pygments highlighting spans ...
    </code>
  </pre>
</div> 
```

将您带到您想要的地方的CSS是：

```
// -- selector prefixed to the wrapper div for collision prevention

.highlight pre code * {
  white-space: nowrap;    // this sets all children inside to nowrap
}

.highlight pre {
  overflow-x: auto;       // this sets the scrolling in x
}

.highlight pre code {
  white-space: pre;       // forces <code> to respect <pre> formatting
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-06-13T03:14:35.473

我正在使用 Jekyll 和 Twitter Bootstrap，以下是最终对我有用的方法：

```
.highlight pre {
    word-wrap: normal;
}

.highlight pre code {
    white-space: pre;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-08-29T20:54:01.677

至于我，使用最新和最伟大的 Jekyll 和荧光笔版本，这解决了这个问题：

```
/* Make code block overflow */
.highlight pre {
  display: inline-block;
} 
```

# python - 使用日志打印 pprint 的输出

> ID：11093236
> 
> 赞同：129
> 
> 时间：2012-06-19T01:25:13.127
> 
> 标签：python, logging, pprint

我想使用 pprint 的输出来显示复杂的数据结构，但我想使用 logging 模块而不是 stdout 来输出它。

```
ds = [{'hello': 'there'}]
logging.debug( pprint.pprint(ds) ) # outputs as STDOUT 
```

* * *

## 回答 #1

> 赞同：266
> 
> 时间：2012-06-19T01:27:03.697

用于[`pprint.pformat`](http://docs.python.org/library/pprint.html#pprint.pformat)获取字符串，然后将其发送到您的日志框架。

```
from pprint import pformat
ds = [{'hello': 'there'}]
logging.debug(pformat(ds)) 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2014-01-09T15:33:53.167

上面的解决方案并没有*完全*适合我，因为我还在使用格式化程序在记录时添加名称和级别名称。看起来有点乱：

```
__main__    : DEBUG   : ['aaaaaaaaaaaaaaaaaaaa',
'bbbbbbbbbbbbbbbbbbbb',
'cccccccccccccccccccc',
'dddddddddddddddddddd']
__main__    : DEBUG   : Some other logging text 
```

可能有一个更优雅的解决方案，但是：

```
for line in pprint.pformat(ds).split('\n'):
    logging.debug(line) 
```

产生更好的东西：

```
__main__    : DEBUG   : ['aaaaaaaaaaaaaaaaaaaa',
__main__    : DEBUG   :  'bbbbbbbbbbbbbbbbbbbb',
__main__    : DEBUG   :  'cccccccccccccccccccc',
__main__    : DEBUG   :  'dddddddddddddddddddd']
__main__    : DEBUG   : Some other logging text 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-12-28T20:31:43.203

另一种方法是`json.dumps`与`indent`arg 一起使用。在某些情况下（取决于日志记录格式、数据大小等），它可能会为您提供更好的输出。

```
logging.error('Malformed input data!')
logging.error(pformat(foo))

ERROR:root:Malformed input data!
ERROR:root:{'a': 1, 'b': 2, 'c': 'womp rat', 'd': 'turd sandwich'} 
```

对比

```
logging.error('Malformed input data!') 
logging.error(json.dumps(foo, indent=4))

ERROR:root:Malformed input data!
ERROR:root:{
    "a": 1,
    "b": 2,
    "c": "womp rat",
    "d": "turd sandwich"
} 
```

# hibernate - 使用 Spring MVC 提交数据时加载 Hibernate 实体的最佳实践

> ID：11093237
> 
> 赞同：0
> 
> 时间：2012-06-19T01:25:20.283
> 
> 标签：hibernate, spring-mvc

给出两个实体，电影和导演。

@实体

```
public class Movie extends BaseEntity {

  private static final long serialVersionUID = -1545404740388837658L;

  @Column(name="movieName", nullable=false, length=200)
  private String movieName;

  @Column(name="year", nullable=false)
  private Integer year; 

  @ManyToOne(fetch=FetchType.EAGER)
  @JoinColumn(name="director_id")
  private Director director;

  //setter, getter
}

@Entity
public class Director extends BaseEntity {

  @NotEmpty
  @Column(nullable = false, length=50)
  private String name;

  //setter, getter 
} 
```

JSP中有一个表格

```
<form:form action="saveMovie" commandName="movie" >
    <p><label>Movie Name</label><form:input path="movieName" /></p> 
    <p><label>Year</label><form:input path="year" /></p>
    <p><label>Director</label><form:input id="txtDirector" path="director.id" /></p> 

    <p>
      <input type="submit" name="Save" />
    </p>
  </form:form> 
```

这是没有 Director 处理的原始控制器

```
@RequestMapping(value="/saveMovie", method = RequestMethod.POST)
public String saveMovie(@ModelAttribute Movie movie, BindingResult result, SessionStatus status, ModelMap model) {

    getMovieModel().saveMovie(movie); //get a DAO to persist a Movie

    List<Movie> movies = getMovieModel().getAllMovies(); //reload all Movies
    model.put("allMovies", movies);
    return "test/allMovies";
  } 
```

提交电影时加载现有 Director 实体的最佳模式是什么？非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T15:39:11.800

我制定了一个解决方案，但不确定这是在 Spring MVC 模型中“将现有实体关联到将被持久化到数据库中的新实体”的最佳模式。

这是我的代码修订：

```
@RequestMapping(value="/saveMovie", method = RequestMethod.POST)
  public String saveMovie(@ModelAttribute("movie") Movie movie, @ModelAttribute("director") Director director, BindingResult result, SessionStatus status, ModelMap model) { 
    /*please note that parameter "director" is newly added */
    logger.trace(movie.getMovieName() + "," + movie.getYear());
    movie.setDirector(director); // <-- newly added
    getMovieModel().saveMovie(movie);

    List<Movie> movies = getMovieModel().getAllMovies();
    model.put("allMovies", movies);
    return "test/allMovies";
  }

  @ModelAttribute("director") 
  public Director loadDirector(@RequestParam(value="director.id", required=false) Long id) {

    Director director = null;
    if (id != null) 
      director = getDirectorModel().loadDirector(id);
    return director;
  } 
```

请看方法“loadDirector”被注解为@ModelAttribute，所以在每次调用控制器之前，首先调用loadDirector()。我可以检查请求参数“director.id”是否为空。如果 director id 不为 null，我可以从数据库中加载一个 Director，以便在调用 saveMovie() 时使用它。别忘了打电话

```
movie.setDirector(director); 
```

在 saveMovie() 方法中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T10:55:28.497

如果 Director 对 Movie 是必需的，那么最好使用 FetchType = EAGER 加载。此外，如果某些逻辑需要每个电影实体的 Director 对象，那么最好使用 EAGER。

如果你使用 FetchType = LAZY ，当你调用 movie.getDirector() 方法时，它将获取 Director 实体。

# java - 在 Android 中播放 Ogg Sound

> ID：11093238
> 
> 赞同：1
> 
> 时间：2012-06-19T01:25:46.210
> 
> 标签：java, android, media-player, playback, ogg

在我的应用程序中，我正在尝试播放 ogg 格式的声音文件，该文件存储在我的应用程序 res 目录中的 raw 文件夹中。当我按下调用以下函数的按钮时，它只是在按下按钮时冻结并且没有响应。最后，我必须从 Eclipse 中终止应用程序。与 Logcat 中的错误或异常无关。

在调试模式下，它进入创建函数并且永远不会回来。我究竟做错了什么？

```
 private void playbeep()
{
    mPlayer = MediaPlayer.create(this, R.raw.beep);
    mPlayer.start();
    mPlayer.release();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T03:10:27.097

您同时启动和释放 MediaPlayer。试着把它拿出来看看它是否有效。

```
mPlayer.release(); 
```

另外，请查看我的帖子[，](https://stackoverflow.com/questions/11093157/java-playing-a-sound-effect/11093521#11093521)以确保您正确设置了 MediaPlayer。如果一切都失败了，请尝试使用其他格式的音频文件。

# c# - 这种类型的数据具有内置行为，不能以这种方式添加到模型中：System.Int64

> ID：11093239
> 
> 赞同：3
> 
> 时间：2012-06-19T01:25:58.363
> 
> 标签：c#, serialization, protobuf-net

这个错误：

```
Data of this type has inbuilt behaviour, and cannot be added to a model in this way: System.Int64 
```

仅当以下行为 protobuf-net 在序列化具有 TimeStamp 类型的对象时使用的 long 代理类型时才会发生。

```
RuntimeTypeModel.Default.Add(typeof(TimeStamp),false).SetSurrogate(typeof(long)); 
```

TimeStamp 类定义了以下显式运算符：

```
public static explicit operator TimeStamp( long timeStamp)
{
    return new TimeStamp(timeStamp);
}

public static explicit operator long( TimeStamp TimeStamp)
{
    return TimeStamp.Internal;
} 
```

那么为什么它不接受 long 作为 TimeStamp 的代理类型呢？在开始尝试 protobuf-net 之前，手写序列化在序列化/反序列化时已经使用 long 作为 TimeStamp 的代理项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T06:34:05.960

目前，代理行为期望映射到“消息”类型（在 protobuf 术语中）。能够将其映射到诸如此类的原语`long`似乎是一种不寻常的情况。我最有可能调整代码以使其工作，但是：简单地说 - 这不是此功能的预期用例，因此它目前不支持（*消息*和原语在术语上有显着差异存储的内容）。

顺便说一句，取决于你有多少，你可以这样做：

```
public TimeStamp Foo {get;set;}

[ProtoMember(n)]
private long FooValue {
    get { return (long)Foo; }
    set { Foo = (TimeStamp)value; }
} 
```

# ruby-on-rails - Hartl Rails 教程第 8 章 - 无法注销 Sample_App。所有 rspec 测试均通过

> ID：11093240
> 
> 赞同：2
> 
> 时间：2012-06-19T01:26:06.373
> 
> 标签：ruby-on-rails

我将非常感谢任何帮助确定我无法退出示例应用程序的原因。* 我所有的 rspec 测试都通过了。* 当我在我的本地服务器上注销时单击注销，我没有注销，并且链接不会更改为登录（尽管对此进行了 rspec 测试）。

以下是 authentication_pages_spec.rb 中的相关测试

```
require 'spec_helper'

describe "AuthenticationPages" do

  subject { page }

  describe "signin page" do
    before { visit signin_path }

    it { should have_selector('h1',    text: 'Sign in') }
    it { should have_selector('title', text: 'Sign in') }
  end

  describe "signin" do
    before { visit signin_path }

    describe "with invalid information" do
      before { click_button "Sign in" }

      it { should have_selector('title', text: 'Sign in') }
      it { should have_selector('div.alert.alert-error', text: 'Invalid') }

      describe "after visiting another page" do
        before {click_link "Home" }
        it { should_not have_selector('div.alert-error') }
      end
    end

    describe "with valid information" do
      let(:user) { FactoryGirl.create(:user) }
      before do
        fill_in "Email", with: user.email
        fill_in "Password", with: user.password
        click_button "Sign in"
      end

      it { should have_selector('title',   text: user.name) }
      it { should have_link('Profile',     href: user_path(user)) }
      it { should have_link('Sign out',    href: signout_path) }
      it {should_not have_link('Sign in',  href: signin_path) }

      describe "followed by signout" do
        before { click_link "Sign out" }
        it { should have_link ('Sign in') }
      end
    end
  end
end 
```

这是 session_controller.rb

```
class SessionsController < ApplicationController

  def  new
  end

  def create
    user = User.find_by_email(params[:session][:email])
    if user && user.authenticate(params[:session][:password])
      sign_in user
      redirect_to user
    else
      flash.now[:error] = "Invalid email/password combination"
      render 'new'
    end
  end

  def destroy
    sign_out
    redirect_to root_path
  end
end 
```

这是 session_helper.rb

```
module SessionsHelper
  def sign_in(user)
    cookies.permanent[:remember_token] =  user.remember_token
    self.current_user = user
  end

  def signed_in?
    !self.current_user.nil?
  end

  def current_user=(user)
    @current_user = user
  end

  def current_user
    @current_user ||= User.find_by_remember_token(cookies[:remember_token])
  end   

  def sign_out
    self.current_user = nil
    cookies.delete(:remember_token)
  end
end 
```

这是_header.html.erb

```
<header class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <%= link_to "sample app", root_path, id: "logo" %>
            <nav>
                <ul class="nav pull-right">
                    <li><%= link_to "Home",    root_path %></li>
                    <li><%= link_to "Help",    help_path %></li>
                    <% if signed_in? %>
                        <li><%= link_to "Users", '#' %></li>
                        <li id="fat-menu" class="dropdown">
                            <a href='#' class="dropdown-toggle"  data-toggle="dropdown">
                                Account <b class="caret"></b>
                            </a>
                            <ul class="dropdown-menu">
                                <li><%= link_to "Profile", user_path(current_user) %></li>
                                <li><%= link_to "Settings", '#' %></li>
                                <li class="divider"></li>
                                <li>
                                    <%=  link_to "Sign out", signout_path, method: "delete" %>    
                                </li>
                            </ul>
                        </li>        
                    <% else %>
                        <li><%= link_to "Sign in", signin_path %></li>
                    <% end  %>
                </ul>
            </nav>
        </div>
    </div>
</header> 
```

最后，这是模型 user.rb

```
class User < ActiveRecord::Base
  attr_accessible :name, :email, :password, :password_confirmation 
  has_secure_password

  before_save { |user| user.email = user.email.downcase }
  before_save :create_remember_token 

  validates :name,  presence: true, length: { maximum: 50 }
  VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i
  validates :email, presence: true, format: { with: VALID_EMAIL_REGEX },
                      uniqueness: { case_sensitive: false }
  validates :password, presence: true, length: { minimum: 6 }
  validates :password_confirmation, presence: true

  private

    def create_remember_token
        self.remember_token = SecureRandom.urlsafe_base64
    end
end 
```

这是我的 WEBrick 服务器所说的：

```
Started DELETE "/signout" for 127.0.0.1 at 2012-06-19 10:58:53 -0400
Processing by SessionsController#destroy as HTML
  Parameters: {"authenticity_token"=>"qP1xAF4YXTaFmjeHxS5SgvUx+6+c6us5AL4jqgEBeqQ="}
Redirected to http://localhost:3000/
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)

Started GET "/" for 127.0.0.1 at 2012-06-19 10:58:53 -0400
Processing by StaticPagesController#home as HTML
  Rendered static_pages/home.html.erb within layouts/application (0.6ms)
  Rendered layouts/_shim.html.erb (0.1ms)
  User Load (0.3ms)  SELECT "users".* FROM "users" WHERE "users"."remember_token" IS NULL LIMIT 1
  Rendered layouts/_header.html.erb (3.1ms)
  Rendered layouts/_footer.html.erb (0.5ms)
Completed 200 OK in 22ms (Views: 21.2ms | ActiveRecord: 0.3ms)
[2012-06-19 10:58:53] WARN  Could not determine content-length of response body. Set content-length of the response or set Response#chunked = true

Started GET "/assets/application.css?body=1" for 127.0.0.1 at 2012-06-19 10:58:53 -0400
Served asset /application.css - 304 Not Modified (11ms)
[2012-06-19 10:58:53] WARN  Could not determine content-length of response body. Set content-length of the response or set Response#chunked = true 
```

如果 cookie 出现问题，这是我在浏览器中检查 cookie 时发生的情况：

检查 cookie： 1\. 我清除所有 cookie 2\. 转到 localhost:3000。我仍然以用户 2 的身份登录。我检查了 cookie，但我没有本地主机的 remember_token。我确实有一个名为“_sample_app_session”的 cookie 3\. 单击退出。没有任何反应，仍然登录。 4\. 输入 /signin。以用户 3 身份登录 5\. 我现在在 cookie 中有一个 remember_token。6\. 点击退出。仍然显示我已在顶部导航中签名。7\. 我单击配置文件以查看我以用户 2 身份登录（通过调试） 8\. 我检查 cookie 并记住令牌已消失，我仍然拥有 _sample_app_session

你有什么方法可以测试可能导致这种情况的原因吗？我真的很想解决这个问题，所以我可以继续学习本教程。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T05:01:24.027

哦，我也遇到了同样的问题。甚至我也在拉我的头发。然后我的一个朋友注意到了代码并帮助了我。问题是您刚刚错过了从 RAILS CONSOLE 添加记住令牌。只需检查黄瓜上方的部分，这是可选的。您会注意到从 rails 控制台添加令牌的部分。

导轨控制台

> > User.first.remember_token

=> 无

> > User.all.each { |用户| 用户保存（验证：假）}
> > 
> > User.first.remember_token

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-13T13:07:53.257

确保在推送到 heroku 后迁移数据库。我遇到了类似的问题，运行后它就消失了：

```
$ heroku run rake db:migrate 
```

# jekyll - Jekyll 使用 pygments 时如何支持行号

> ID：11093241
> 
> 赞同：23
> 
> 时间：2012-06-19T01:26:07.687
> 
> 标签：jekyll, pygments

如何对 Jekyll 中使用 pygments 突出显示的代码行进行编号？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-06-19T08:00:52.867

根据Jekyll 文档的[Liquid Extensions](https://github.com/mojombo/jekyll/wiki/Liquid-Extensions)`highlight` wiki 页面， Liquid 标签有一个可选的第二个参数，它可能具有`linenos`开启行号的值：

```
{% highlight language linenos %}
your code here
{% endhighlight %} 
```

谨慎使用。由于`linenos`行号实际上是插入到代码的文本中，因此没有它们就不可能复制代码块。（这可以通过让访问者`$('.lineno').toggle()`看到行号的可见性来解决。在 Firefox 中工作，不确定是否可移植。）

**更新**：更好地使用`linenos=table`：

```
{% highlight language linenos=table %}
your code here
{% endhighlight %} 
```

这将把代码放在一个`table`有两个单元格的地方：首先`td`是所有的行号，其次`td`是代码本身。这使得只选择代码而不选择行号成为可能。

# ruby-on-rails - Rails + Amazon S3 + Heroku：S3 上文件的 URL 是公开的 如何保护，管理员如何将文件添加到用户文件夹？

> ID：11093243
> 
> 赞同：0
> 
> 时间：2012-06-19T01:26:31.147
> 
> 标签：ruby-on-rails, file-upload, heroku, amazon-s3

我有一个 rails 应用程序，其中我有一个像功能集这样的下拉框。

每个用户都有一个登录密码 每个用户都可以上传和下载自己的文件。在他们的索引页面上，他们可以看到他们上传的所有文件。文件的 url 保存在 db 中：在 heroku 中

关于如何处理一些我想添加到应用程序中的功能，我有几个问题。

1) 作为管理员，我想将文件添加到用户文件夹，这些文件将在用户下次登录他们的应用程序时显示。目前，即使我将文件放在文件夹中，用户也看不到它，因为他们的 index.html 页面只提取那些将其 url 存储在数据库中的文件

2) 目前文件访问是通过 url 进行的，所以它是公开的。这是个大问题。我想设置应用程序，使 url 不公开。由于我使用 heroku，我无法将它们存储在 heroku 服务器上，我不想将它们流式传输到应用程序中，然后通过 Heroku 将它们提供给用户。那么直接从 S3 为它们提供服务但不显示 url 的最佳方式是什么。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T02:46:13.017

我认为 1) 的答案是创建一个允许管理员创建文件对象并将其与用户关联的操作。

至于 2)（顺便说一句，这应该有助于弄清楚 1），[Paperclip gem](https://github.com/thoughtbot/paperclip "回形针宝石")支持将文件附加到模型，并可以选择将文件存储在 S3 上（以及指定该文件的 URL 的能力）。

这是许多[相关教程](http://thewebfellas.com/blog/2009/8/29/protecting-your-paperclip-downloads "相关教程")之一，其中介绍了保护对这些文件的访问的一些注意事项。

# android - PhoneGap 1.8.1 - 启动画面不工作？

> ID：11093244
> 
> 赞同：2
> 
> 时间：2012-06-19T01:26:36.187
> 
> 标签：android, cordova, splash-screen

我正在尝试使用它来创建启动画面，但我只得到一个白色的加载屏幕：

```
 super.onCreate(savedInstanceState);
 super.setIntegerProperty("loadUrlTimeoutValue", 70000);
 super.setStringProperty("loadingDialog", "Loading...");
 super.setIntegerProperty("splashscreen", R.drawable.splash);
 super.loadUrl("file:///android_asset/www/index.html"); 
```

我已经放置`splash.png`在所有可绘制目录中，但我仍然一无所获。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T02:40:00.280

您需要在 loadUrl 行中指定超时，如下所示：

```
super.loadUrl("file:///android_asset/www/index.html", 100000); 
```

这将显示启动屏幕 10 秒。

# postgresql - 无法从提供的 .sql 文件重新创建 PostgreSQL 数据库

> ID：11093245
> 
> 赞同：3
> 
> 时间：2012-06-19T01:26:47.890
> 
> 标签：postgresql

我对 PostgreSQL 的世界完全陌生，请耐心等待。

我得到了一个 .sql 文件（这里的整个文件：[db-e4w.zip](http://hlou.ch/temp/db-e4w.zip)），它似乎是通过 Navicat 从 PGSQL 服务器导出的。文件的开头（以防万一有人尝试，可以在此处找到该文件）。

```
/*
Navicat PGSQL Data Transfer

Source Server         : pluto
Source Server Version : 80311
Source Host           : localhost:5432
Source Database       : kun3
Source Schema         : public

Target Server Type    : PGSQL
Target Server Version : 90100
File Encoding         : 65001

Date: 2012-06-07 11:24:41
*/ 
```

我的问题是我无法从提供的文件中包含的查询重新创建原始数据库。我已经尝试通过 pgAdmin III、Navicat PGSQL 和 phpPgAdmin 中的 SQL 命令都没有成功。我通常会犯数百个错误，其中一个是：

```
SQL error:
ERROR:  relation "core_log_log_id_log_seq" does not exist 
```

这是此查询的结果（第一个 sql 文件）

```
CREATE TABLE "core_log_log" (
"id_log" int4 DEFAULT nextval('core_log_log_id_log_seq'::regclass) NOT NULL,
"message_log" text,
"priority_log" int2,
"date_creation_log" timestamp(6) DEFAULT NULL::timestamp without time zone,
"server_log" char(255) DEFAULT NULL::bpchar,
"idusr_log" int4,
"exception_log" text,
"idvis_log" int4
)
WITH (OIDS=TRUE)

; 
```

任何帮助将不胜感激。**即使有人只是想出** *文件已损坏或不完整之类的东西，也要获得一个新的和正确的文件，* **或者** *您正在骑一匹完全错误的马-尝试以其他方式导入它* **会有所帮助。**

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T01:30:09.937

如果没有类似的东西：

```
CREATE SEQUENCE core_log_log_id_log_seq ... 
```

在它引用序列之前，我认为它是不完整的。

# r - 带有字符 xintercept 的 geom_vline

> ID：11093248
> 
> 赞同：7
> 
> 时间：2012-06-19T01:27:26.383
> 
> 标签：r, plot, ggplot2

我有一些在 0.8.9 中运行良好但在 0.9.1 中运行良好的 ggplot 代码。

我将在其中绘制数据，`theDF`并想在`xintercept="2010 Q1."` `theGrid`仅用于创建的位置绘制一条垂直线`theDF`。

```
theGrid <- expand.grid(2009:2011, 1:4)
theDF <- data.frame(YrQtr=sprintf("%s Q%s", theGrid$Var1, theGrid$Var2), 
                    Minutes=c(1000, 2200, 1450, 1825, 1970, 1770, 1640, 1920, 1790, 1800, 1750, 1600)) 
```

使用的代码是：

```
g <- ggplot(theDF, aes(x=YrQtr, y=Minutes)) + 
         geom_point() + 
         opts(axis.text.x=theme_text(angle=90))

g + geom_vline(data=data.frame(Vert="2010 Q2"), aes(xintercept=Vert)) 
```

同样，这在具有 ggplot2 0.8.9 的 R 2.13.2 中运行良好，但在具有 ggplot2 0.9.1 的 R 2.14+ 中却不行。

一种解决方法是：

```
g + geom_vline(data=data.frame(Vert=4), aes(xintercept=Vert)) 
```

但这不是解决我的问题的好方法。

也许乱来`scale_x_discrete`可能会有所帮助？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-19T13:23:32.990

你可以试试这个：

```
g + geom_vline(aes(xintercept = which(levels(YrQtr) %in% '2010 Q1'))) 
```

这避免了为所选因子水平创建虚拟数据框的需要。which() 命令返回要与 vlines 关联的因子 level[s] 的索引（如果 %in% 运算符的右侧是向量，则返回索引）。

对此的一个警告是，如果某些类别没有出现在您的数据中并且您`drop = TRUE`在比例中使用，那么这些线将不会显示在正确的位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-19T02:01:10.783

当您对绘图中的 x 轴使用字符向量或因子时，赋予每个唯一项目的默认值只是从 1 开始的整数。因此，如果您的级别是 c("A" "B" , "C") 那么 x 轴位置是 c(1,2,3)。没有字符位置之类的东西，只有字符标签。如果你想在 A 处有一条垂直线，那么把它放在 1 处。如果你想要它在 A 和 B 之间的中间，那么把它放在 1.5 处。同样，这些是默认值。如果某个特定的情节做了其他事情，您可以通过在几个位置放置线条并查看会发生什么来轻松解决这个问题。

# google-app-engine - 在 gae 中使用 download_data 命令时将文件下载到哪个目录

> ID：11093249
> 
> 赞同：0
> 
> 时间：2012-06-19T01:27:38.660
> 
> 标签：google-app-engine, google-cloud-datastore

我按照[https://developers.google.com/appengine/docs/python/tools/uploadingdata](https://developers.google.com/appengine/docs/python/tools/uploadingdata)上的说明从谷歌应用引擎下载数据。数据已成功下载（根据 python 输出），但我无法在文件系统上找到该文件。

例如，对于以下命令，我获得了成功，但在我的计算机中找不到 bulkloader.yaml。我试过微软（Win 7）内置搜索、谷歌桌面搜索，但我得到 0 个结果。C:\Program Files (x86)\Google\google_appengine>python appcfg.py create_bulkloader_config --filename=bulkloader.yaml --url=http://appname.appspot.com/remote_api

在这方面的任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T05:13:58.503

假设一切正常，该文件应该位于您启动命令 appcfg.py 的同一目录中。命令提示符窗口的默认目录类似于 C:\Documents and Settings\User。尝试在那里查看或从您选择的目录重新启动命令。

编辑：在您的情况下，该文件可能位于 C:\Program Files (x86)\Google\google_appengine

# android - 可以从eclipse中提取布局编辑器并单独运行吗？

> ID：11093250
> 
> 赞同：5
> 
> 时间：2012-06-19T01:27:54.437
> 
> 标签：android, android-layout

有什么方法可以将 android 布局编辑器用作独立工具来编辑 eclipse 之外的单个 xml 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-04T14:53:45.827

没有独立的方法可以在 IDE 之外创建用户界面。大多数在线程序都使用模型，它可以帮助您构建和设计用户界面。Balsamiq 特别允许您以 xml 格式导出模型。

然后，您可以将它们应用到 Eclipse 中的 xml 布局文件。

希望这可以帮助。

[链接到 Balsamiq](http://balsamiq.com/)

# git - SSH 密钥混淆，2 个快速问题

> ID：11093253
> 
> 赞同：1
> 
> 时间：2012-06-19T01:28:33.833
> 
> 标签：git, ssh

在计算机**A**上，我创建了 2 个 ssh 密钥，公共的和私有的。公钥已添加到[Assembla](https://www.assembla.com/)服务器 (git repo)上的 SSH 密钥中

在计算机 A 上，我可以推送、拉取、克隆等问题，但是在使用计算机**B**时，我得到了

```
git push origin dev:dev
Permission denied (publickey,keyboard-interactive).
fatal: The remote end hung up unexpectedly 
```

在我的`~/.ssh/`目录中，我有一个`id_rsa.pub -> /Users/my_uid/Dropbox/ssh/id_rsa.pub`，它与中的集合相匹配`Assembla`

这里可能有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T01:33:05.860

您必须将您的私钥放在要用于访问远程 git 存储库的任何计算机上的 .ssh 文件夹中。

# javascript - Javascript OOP 方法

> ID：11093254
> 
> 赞同：1
> 
> 时间：2012-06-19T01:28:38.450
> 
> 标签：javascript, oop

只是想知道，有以下简单的代码：

```
var object1 = {
    name: function (){
        return 'myName';
    },
    surname: function (){
        return 'mySurname';
    }
}; 
```

为什么 JS`function()`在这种情况下返回 object1.name ？

`myName`如果我调用 object1.name() ，为什么 JS 会返回预期结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T01:30:52.687

1.  *引用* `name`返回的是什么`name` *——*在这种情况下，是一个函数。
2.  *`name`通过附加*调用*`()`，即，`name()`返回一个值——字符串`"myName"`。*

 *[我](https://stackoverflow.com/questions/7969088/when-do-i-use-parenthesis-and-when-do-i-not/7969111#7969111)对[何时使用括号以及何时不使用括号的回答？](https://stackoverflow.com/questions/7969088/when-do-i-use-parenthesis-and-when-do-i-not)提供更多细节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T01:30:46.163

```
object1.name;//Returns the function declaration
object1.name();//Calls the function and returns its value 
```

它的工作方式类似于以下代码：

```
var myFn = function(){
    return "This is the return value of this function";
}
alert(myFn);//Alerts the myFn function's declaration
alert(myFn());//Alerts "This is the return value of this function" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-19T01:31:01.943

因为在`object1.name`你调用函数声明

在`object1.name()`你调用这个函数*

# ruby-on-rails - rspec - 自定义路线

> ID：11093255
> 
> 赞同：0
> 
> 时间：2012-06-19T01:28:39.663
> 
> 标签：ruby-on-rails, ruby, rspec

我已经简化了一个我必须解决的问题

我有一条看起来像这样的路线

```
namespace :client do
  resources :thing, :only => [:index]
end 
```

和简单的 rspec 测试

```
describe Client::ThingController do
  describe "GET 'index'" do
    it "returns http success" do
      get 'index'
      response.should be_success
    end
  end
end 
```

但是我想做的是改变我用来访问资源的 url

```
/client/thing.json 
```

至

```
/api/client/v1/thing.json 
```

1) 如何更新我的路线和 rspec？

如果我想参数化 uri 以便我可以提取 api_version

```
/api/client/[api_version]/thing.json 
```

2）这将如何影响我的路线和简单的 rspec 测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T22:20:41.893

我之前尝试过@Mori 在发布之前的建议，但没有建议的多条路线，我应该在原始帖子中提到这一点。

我最终得到的工作是：

1）在`routes.rb`我添加

```
match "api/client/:api_version/thing" => 'client/thing#index' 
```

*注意：缺少的前导 '/' 即`match "/api/...`=>`match "api/...`它似乎对`rspec`.*

2）在我的 rspec`thing_controller_spec.rb`我现在有这个

```
describe Client::ThingController do
  describe "GET 'index'" do
    it "returns http success" do
      get 'index', :api_version => 'v1'
      response.should be_success
    end
  end
end 
```

`routes.rb`我之前很接近，但即使我可以在浏览器中导航到 URL，但它是领先的 '/'让我感到震惊。

# java - key=value 的正则表达式是什么，用逗号分隔？

> ID：11093256
> 
> 赞同：1
> 
> 时间：2012-06-19T01:28:57.550
> 
> 标签：java, regex

捕获整个键值列表的 Java 正则表达式是什么（在下面的示例中以粗体显示）？

> 富吧**k0=v0, k1=v1, k2=v2**富吧

键和值不包含空格字符，`,`或`=`.

我试过：`(([^\s,=]+=[^\s,=]+),?)+`at [Regular Expression Test Page for Java](http://www.regexplanet.com/advanced/java/index.html)，但它给了我个人等式组（`k0=v0`等）而不是整个字符串。这是为什么？我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T01:34:28.683

您的正则表达式不允许空格。如果您希望它也包含空格，则无法摆脱`"foo bar"`它（它将假定它是键或值的一部分）。如果您只想在逗号后允许空格，请尝试以下操作：

```
(([^\s,=]+=[^\s,=]+)(?:,\s*)?)+ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T02:10:23.087

像下面这样的东西会起作用：

```
([^=|^,|^\W]+)=([^,|^\W]+) 
```

# filter - DirectShow 过滤器 - 如何使用和找到正确的过滤器

> ID：11093257
> 
> 赞同：1
> 
> 时间：2012-06-19T01:29:28.317
> 
> 标签：filter, directshow, video-capture

我有一个使用 capFilter-"Ds.Net Video Capture Device" 和 baseGrabFlt-"Ds.Net Grabber" 开发的程序。

我对 DirectShow 不是很熟悉，并且一直在试图确定为什么这个程序突然停止在两台运行良好的机器上运行。我使用了一个程序来查看已安装的过滤器，但没有看到任何名为“Ds.Net”的过滤器。

两个问题 - 我可以更改这些过滤器吗？或者我如何找到它们并在这些机器上重新安装它们以使应用程序再次运行。

# javascript - JQuery .hide()/.show() 与复选框的 .prop() 设置

> ID：11093270
> 
> 赞同：1
> 
> 时间：2012-06-19T01:31:12.533
> 
> 标签：javascript, jquery, html, show-hide

这是[JS 小提琴](http://fiddle.jshell.net/chrisfrisina/DgN5E/)。我希望内容有点互动，只需单击内容即可隐藏它。为了允许用户在他/她愿意的情况下将其带回，隐藏的部分出现在`<aside>`右侧的部分中。我有“标题”（业务方法）工作，因为它必须保留为父 DOM 元素。我一直在努力让孩子们工作。我目前对孩子们的尝试是/是这个（也张贴在小提琴上）：

```
 //individual BA elements Toggle Buttons
    //Currently on, turning Off
        $('.block > .businessapproaches > section > input').on('change', function () {
            if (this.checked) {
            } else {
                var index = $(this).prevAll('section').length;
                $('.block > .businessapproaches > section').eq(index).hide();
                $('fieldset.businessapproaches > label').eq(index+1).show();
                $('fieldset.businessapproaches > input').eq(index+1).prop('checked' , false);
                console.log("off")
                console.log("left index: " + index);
                console.log($('.block > .businessapproaches > section').eq(index));
                console.log($('fieldset.businessapproaches > label').eq(index+1));
            }
        });
    //Currently off, turning On
        $('fieldset.businessapproaches > input').on('change', function () {
            if (this.checked) {
            } else {
                var index = $(this).prevAll('section').length+1;
                $('.block > .businessapproaches > section').eq(index-1).show();
                $('.block > .businessapproaches > input').eq(index-1).prop('checked' , false);
                $('fieldset.businessapproaches > label').eq(index).hide();
                console.log("on")
                console.log("right index: " + index);
                console.log($('.block > .businessapproaches > section').eq(index-1));
                console.log($('fieldset.businessapproaches > label').eq(index));
            }
        }); 
```

很抱歉在同一个堆栈中发布 2 个问题，但它似乎相关，我正在努力快速达到 125 的代表，因此我可以发布多个问题而无需等待规定的时间）

奖励积分：可以告诉我为什么“标题”（业务方法）可以通过复选框或文本单击，而孩子不能？我的错误在哪里，因为我最终会用 CSS 隐藏“框”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T02:34:58.950

我试过小提琴[http://fiddle.jshell.net/guanxiaohua2k6/dpvAn/1/](http://fiddle.jshell.net/guanxiaohua2k6/dpvAn/1/)。我认为它如你所愿。

我将在下面显示修改位置。

```
@@ -10 +10 @@
-                    var index = $(this).prevAll('section').length;
+                    var index = $(this).closest('section').prevAll('section').length;
@@ -13 +13 @@
-                    $('fieldset.businessapproaches > input').eq(index+1).prop('checked' ,     false);
+                    $('fieldset.businessapproaches > input').eq(index+1).prop('checked' , true);
@@ -24 +24 @@
-                    var index = $(this).prevAll('section').length+1;
+                    var index = $(this).prevAll('input').length;
@@ -26 +26 @@
-                    $('.block > .businessapproaches > input').eq(index-1).prop('checked' , false);
+                    $('.block > .businessapproaches > section > input').eq(index-1).prop('checked' , true); 
```

至于为什么无法点击子项的“标题”，输入的 id 与 <aside> 中的 id 重复。

# android - 只在android中获取部分字符串？

> ID：11093274
> 
> 赞同：1
> 
> 时间：2012-06-19T01:31:29.947
> 
> 标签：android, string, url

好的，我不太确定如何表达这个问题，但基本上我想做的是，我从 android 中的 webView 获得了一个 url，我需要将该 url 的一部分放入一个字符串中，该 url 看起来有些东西像这样：`http://localhost/?code=4/3pakksajdfASDFwek.4nsKfAYN7XQVshQV0ieZDAp-PrgEcAI`我只想要代码=之后的部分，这可能吗？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T01:35:46.083

```
int start = my_string.indexOf("=");
String suffix = my_string.substring(start + 1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T01:40:30.597

如果其他参数可以在 URL 上，或者代码并不总是第一个参数：

```
String url = "http://localhost/?code=4/3pakksajdfASDFwek.4nsKfAYN7XQVshQV0ieZDAp-PrgEcAI";
String code = url.replaceAll(".*(?:[?]|[&])code=([^&]+)","\1"); 
```

在这里测试：http: [//fiddle.re/nxfv](http://fiddle.re/nxfv)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T01:41:23.360

如果您完全确定 URL 永远不会有其他形式，则可以使用`indexOf`and `substring`。

否则，最好使用[`URI`](http://docs.oracle.com/javase/6/docs/api/java/net/URI.html)class来提取URL的查询部分（[`getRawQuery`](http://docs.oracle.com/javase/6/docs/api/java/net/URI.html#getRawQuery%28%29)为了安全起见），然后用字符标记它`split`并`&`找到正确的键值对以获得正确的值。这种方法不像`indexOf`上面的方法那么脆弱。

# c++ - 如何使用代码初始化静态成员字符数组

> ID：11093283
> 
> 赞同：2
> 
> 时间：2012-06-19T01:33:52.293
> 
> 标签：c++

我希望根据其他静态 char 数组成员初始化一个静态 char 数组成员 - 但初始化是这样的，代码是必要的。这可能吗？

```
class fred {
    static char *a;
    static char *b;
    static char c[4];
} 
```

现在 a 和 b 将具有固定值，但我想根据它们构造 c 。例如：

```
fred::a = "1234"
fred::b = "ab"    
strcpy(c, b);
strncat(c, a, 1); 
```

但是我无论如何都看不到初始化c，除了为只是一个char [4]的目的创建一个类，其构造函数引用fred :: a和fred :: b，然后在fred中替换c使用该类的实例-在引用 c char 数组时很尴尬。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T01:43:13.947

**编辑：**最初，我`wilma`是 的朋友，并且有一个进行初始化`fred`的静态实例。`wilma`我已经将示例更改为在其中`dino`声明，`fred`因为 OP 说他认为这会更清洁。

您可以创建一个类的静态实例，该实例的`fred`工作是为您初始化`c`。

```
class fred {
    static char *a;
    static char *b;
    static char c[4];
    static struct dino { dino (); } dino_flintstone;
};

char *fred::a;
char *fred::b;
char fred::c[4];
fred::dino fred::dino_flintstone;

fred::dino::dino () {
    fred::a = "1234";
    fred::b = "ab";
    strcpy(fred::c, fred::b);
    strncat(fred::c, fred::a, 1);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T01:42:36.083

连续的字符串文字在编译时连接......

```
#define A "1234"
#define B "ab"
fred::a = A;
fred::b = B;    
fred::c = A B; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T01:42:47.260

你不能以一种干净的方式，但你可以使用一个技巧来模拟一个静态构造函数，如下[所示](https://stackoverflow.com/questions/1197106/static-constructors-in-c-need-to-initialize-private-static-objects)。

在该静态构造函数中，您可以初始化`c`. 这将是一个可能的实现：

```
class fred {
    static char *a = "1234";
    static char *b = "ab";
    static char c[4];
    public:
    fred(){
       strcpy(fred::c, fred::b);
       strncat(fred::c, fred::a, 1);
    }    
}

class Fred_staticInitializer{  
    static fred staticInitializer;  //This does the trick (launches constructor)
} 
```

希望能帮助到你。干杯

# asp.net-mvc - 属性注入在单元测试中不起作用

> ID：11093286
> 
> 赞同：3
> 
> 时间：2012-06-19T01:34:52.723
> 
> 标签：asp.net-mvc, unit-testing, autofac

在作为 Asp.Net Mvc 应用程序执行期间，autofac 的属性注入成功工作，如下所述：

[http://code.google.com/p/autofac/wiki/Mvc3Integration#Filter_Attribute_Property_Injection](http://code.google.com/p/autofac/wiki/Mvc3Integration#Filter_Attribute_Property_Injection)

如果我将相同的逻辑带到（nunit）单元测试中，则不会将属性注入到我的自定义属性中。mvc 扩展中是否有一些特定的东西会导致它在单元测试中不起作用？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T15:23:30.100

**过滤器属性属性注入作为 MVC/ASP.NET 管道的一部分工作**，而不是作为独立功能提供的东西。

您可能会注意到**MVC 控制器上的过滤器实际上也不会在单元测试期间执行**。例如，将 HandleErrorAttribute 放在控制器操作上，并在单元测试中从该操作引发异常。请注意 HandleErrorAttribute 没有被调用来尝试将您发送到错误视图？

这是因为**在单元测试场景中，您不在 MVC 管道中**- 您正在将控制器/操作作为 POCO（普通旧 CLR 对象）进行测试。您不会获得模型绑定、过滤器、HttpModules 或您通常视为真正集成/执行的一部分的任何其他内容。

**这不是错误，这是设计使然。**它类似于您可以对 WCF 服务实现进行单元测试的方式，如果您通过 web.config 将行为附加到它们，您将不会在单元测试中看到这些行为。您的单元测试未在管道中执行，它仅针对作为独立实体的一个类执行。

**如果您需要测试整个事情如何与过滤器和所有东西一起工作 -*集成测试***- 您需要考虑使用浏览器自动化或其他一些编程 Web 客户端机制从正在运行的 Web 应用程序版本中检索内容。要使管道到位，您必须实际运行在真实的完整运行时中，而不是在标准/独立单元测试环境中。

**至于是否可以在单元测试中使用 DI ......这更多是个人喜好。**我在一些测试中使用它，但是当我这样做时，我将模拟/存根作为依赖项连接起来，这样我就可以控制被测系统与其依赖项之间的交互。你不需要 DI 来做到这一点。您可以手动构建所有虚假依赖项，然后在没有任何 DI/IoC 容器的情况下将它们插入。也就是说，在单元测试环境中，您不应该连接 The Real Dependencies，因为那样您就不会将您的类作为一个单元进行测试——这是一个集成测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-19T03:00:52.000

您应该避免使用 DI 进行单元测试。单元测试就是测试特定代码段的功能，而不是其他代码。在您的情况下，如果您正在测试自定义属性，那么您应该直接设置依赖项，而不依赖任何 IoC 容器来执行此操作。

大多数情况下，依赖项将被模拟对象而不是真实对象替换。

# jquery - 单击另一个元素时从下拉框中选择选项

> ID：11093287
> 
> 赞同：0
> 
> 时间：2012-06-19T01:35:01.480
> 
> 标签：jquery, html

我正在尝试使用以下代码（[此处为 jsfiddle](http://jsfiddle.net/Rf9L3/)）根据下拉框中指定的颜色创建颜色选择器

HTML：

```
<select id="colour" name="colour"> 
      <option value="000000">Black</option>
      <option value="CCCCCC">Grey</option>
      <option value="EAEAEA">Light Grey</option>
</select> 
```

JS：

```
 $(function() {
        var $colourcontainer = '<div id="colour-palette"></div>';
        $( '#colour' ).after( $colourcontainer );

        $( '#colour option' ).each( function() {
            $val = $(this).val();
            if( $val ) {
                $( '#colour-palette' ).append( '<div class="colour" style="background-color:#'+$val+';"></div>' ).click( function() {
                    $('#colour:last').val($val);
                    alert($val);
                });
            }
        });
    }); 
```

我遇到的问题是让它为每个下拉选项循环一次，因为现在它循环多次并为每种颜色添加多个 onclicks。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T01:42:21.063

它添加了多次点击，因为您`#colour-palette`在每次迭代（这里是 3 次迭代）中将点击处理程序绑定到。

更好的方法是创建`.colour`元素，将颜色添加为数据属性，然后使用 on click 处理程序将元素的单击事件分配给`#colour-palette`Try `.color`this：

```
$(function() {
    var $colourcontainer = '<div id="colour-palette"></div>';
    $('#colour').after($colourcontainer);

    $('#colour option').each(function() {
        $val = $(this).val();
        if ($val) {
            var colorEl = $('<div class="colour" style="background-color:#' + $val + ';"></div>');
            colorEl.data("bgColor", $val)
            $('#colour-palette').append(colorEl);
        }
    });
    $('#colour-palette').on("click", ".colour", function() {
        $('#colour').val($(this).data("bgColor"));
    });
});​ 
```

**工作 JSFiddle：http:** [//jsfiddle.net/Rf9L3/1/](http://jsfiddle.net/Rf9L3/1/)

# plugins - 在 symfony 1.4 中扩展现有模块

> ID：11093289
> 
> 赞同：0
> 
> 时间：2012-06-19T01:35:16.340
> 
> 标签：plugins, symfony1, module, symfony-1.4, extend

我想知道扩展 symfony 1 模块的最佳解决方案/方法是什么。更确切地说，我想做的是：

1.  创建一个基本模块“音乐”
2.  创建一个新模块 AS A PLUGIN（我们将其命名为 ARTIST），它扩展了 MUSIC

对于创建的每个插件，如果需要，我想生成管理模块。

如果我不够清楚，请询问。

# java - 类未增强错误

> ID：11093295
> 
> 赞同：1
> 
> 时间：2012-06-19T01:36:35.910
> 
> 标签：java, google-app-engine, datanucleus

我一直在尝试修复此错误：

> {"exception":"Persistent class \"Class org.myapp.model.Account 似乎没有得到增强。您可能需要重新运行增强器并检查输出中的错误。\" 数据库中没有表，但操作需要它。请检查该类的元数据规范。"}

我试过清理项目

这是我要坚持的**实体：**

```
@SuppressWarnings("serial")
@PersistenceCapable(identityType = IdentityType.APPLICATION)
public class Account implements Serializable {
    @PrimaryKey
    @Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)
    private Long id;
    @Persistent
    private String username;
    @Persistent
    private String password;

    public Account() {

    }
    // Code omitted
} 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T04:57:11.137

检查两件事

eclipse appengine 插件的“要增强的类列表”中是否有实体。您的类路径中是否有多个 appengine sdk 库版本。

# wpf - 如何在 WPF 中为按钮中的图像设置动画以每 30 秒抖动一次？

> ID：11093302
> 
> 赞同：0
> 
> 时间：2012-06-19T01:37:34.233
> 
> 标签：wpf, c#-4.0, animation, attachedbehaviors

在处理任何与样式和动画有关的事情时，我并不擅长。

当按钮 Visibility 设置为 Visibility.Visible 时，我希望能够获得一些帮助，使图像是 Button 每 30 秒抖动一次的唯一内容。

这是为了引起用户的注意，鼓励他们点击按钮。

我更愿意将此作为 Image 上的附加行为，或者如果可能的话，甚至是 UIControl，以使其易于重用而不是弄乱样式，因为我已经在使用控件供应商提供的样式，并且我不想编辑它。

**这是我使用的来自标记答案的解决方案**

这是可以应用于任何[System.Windows.Controls.Image的](http://msdn.microsoft.com/en-us/library/system.windows.controls.image.aspx)[附加行为](http://msdn.microsoft.com/en-us/library/ff726531)。

```
using System;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Interactivity;
using System.Windows.Media;
using System.Windows.Media.Animation;

namespace SampleShakeBehavior
{
    public class ShakeBehavior : Behavior<Image>
    {
        private const double DefaultRepeatInterval = 10.0;
        private const double DefaultSpeedRatio = 1.0;

        private const string RepeatIntervalName = "RepeatInterval";
        private const string SpeedRatioName = "SpeedRatio";

        public static readonly DependencyProperty RepeatIntervalProperty =
            DependencyProperty.Register(RepeatIntervalName,
                                        typeof(double),
                                        typeof(ShakeBehavior),
                                        new PropertyMetadata(DefaultRepeatInterval));

        public static readonly DependencyProperty SpeedRatioProperty =
            DependencyProperty.Register(SpeedRatioName,
                                        typeof(double),
                                        typeof(ShakeBehavior),
                                        new PropertyMetadata(DefaultSpeedRatio));

        /// <summary>
        /// Gets or sets the time interval in in seconds between each shake.
        /// </summary>
        /// <value>
        /// The time interval in in seconds between each shake.
        /// </value>
        /// <remarks>
        /// If interval is less than total shake time, then it will shake
        /// constantly without pause. If this is your intention, simply set
        /// interval to 0.
        /// </remarks>
        public double RepeatInterval
        {
            get { return (double)GetValue(RepeatIntervalProperty); }
            set { SetValue(RepeatIntervalProperty, value); }
        }

        /// <summary>
        /// Gets or sets the ratio at which time progresses on the Shakes
        /// Timeline, relative to its parent. 
        /// </summary>
        /// <value> 
        /// The ratio at which time progresses on the Shakes Timeline, relative 
        /// to its parent.
        /// </value>
        /// <remarks> 
        /// If Acceleration or Deceleration are specified, this ratio is the
        /// average ratio over the natural length of the Shake's Timeline. This 
        /// property has a default value of 1.0\. If set to zero or less it
        /// will be reset back to th default value.
        /// </remarks>
        public double SpeedRatio
        {
            get { return (double)GetValue(SpeedRatioProperty); }
            set { SetValue(SpeedRatioProperty, value); }
        }

        private Style _orignalStyle;
        protected override void OnAttached()
        {
            _orignalStyle = AssociatedObject.Style;
            AssociatedObject.Style = CreateShakeStyle();
        }

        protected override void  OnDetaching()
        {
            AssociatedObject.Style = _orignalStyle;
        }

        private Style CreateShakeStyle()
        {
            Style newStyle = new Style(AssociatedObject.GetType(), AssociatedObject.Style);
            /**
             * The following will replace/override any existing RenderTransform
             * and RenderTransformOrigin properties on the FrameworkElement
             * once the the new Style is applied to it.
             */
            newStyle.Setters.Add(new Setter(UIElement.RenderTransformProperty, new RotateTransform(0)));
            newStyle.Setters.Add(new Setter(UIElement.RenderTransformOriginProperty, new Point(0.5, 0.5)));

            newStyle.Triggers.Add(CreateTrigger());

            return newStyle;
        }

        private DataTrigger CreateTrigger()
        {
            DataTrigger trigger = new DataTrigger
            {
                Binding = new Binding
                {
                    RelativeSource = new RelativeSource
                    {
                        Mode = RelativeSourceMode.FindAncestor,
                        AncestorType = typeof(UIElement)
                    },
                    Path = new PropertyPath(UIElement.IsVisibleProperty)
                },
                Value = true,
            };

            trigger.EnterActions.Add(new BeginStoryboard { Storyboard = CreateStoryboard() });

            return trigger;
        }

        private Storyboard CreateStoryboard()
        {
            double speedRatio = SpeedRatio;

            // Must be greater than zero
            if (speedRatio <= 0.0)
                SpeedRatio = DefaultSpeedRatio;

            Storyboard storyboard = new Storyboard 
            {
                RepeatBehavior = RepeatBehavior.Forever,
                SpeedRatio = speedRatio
            };

            storyboard.Children.Add(CreateAnimationTimeline());

            return storyboard;
        }

        private Timeline CreateAnimationTimeline()
        {
            DoubleAnimationUsingKeyFrames animation = new DoubleAnimationUsingKeyFrames();

            animation.SetValue(Storyboard.TargetPropertyProperty, new PropertyPath("(0).(1)", UIElement.RenderTransformProperty, RotateTransform.AngleProperty));

            int keyFrameCount = 8;
            double timeOffsetInSeconds = 0.25;
            double totalAnimationLength = keyFrameCount * timeOffsetInSeconds;
            double repeatInterval = RepeatInterval;

            // Can't be less than zero and pointless to be less than total length
            if (repeatInterval < totalAnimationLength)
                repeatInterval = totalAnimationLength;

            animation.Duration = new Duration(TimeSpan.FromSeconds(repeatInterval));

            int targetValue = 12;
            for (int i = 0; i < keyFrameCount; i++)
                animation.KeyFrames.Add(new LinearDoubleKeyFrame(i % 2 == 0 ? targetValue : -targetValue, KeyTime.FromTimeSpan(TimeSpan.FromSeconds(i * timeOffsetInSeconds))));

            animation.KeyFrames.Add(new LinearDoubleKeyFrame(0, KeyTime.FromTimeSpan(TimeSpan.FromSeconds(totalAnimationLength))));
            return animation;
        }
    }
} 
```

以下是如何在 Xaml 中使用它。

```
<Button>
    <Image Source="myImage.png">
        <i:Interaction.Behaviors>
            <local:ShakeBehavior RepeatInterval="30" SpeedRatio="3.0"/>
        </i:Interaction.Behaviors>
    </Image>
</Button> 
```

有关附加行为的明确定义，您可以查看[System.Windows.Interactivity.Behavior](http://msdn.microsoft.com/en-us/library/ff726531)类注释。行为可以选择具有附加属性，也可以使它们非常有用。

有关附加属性的明确定义，您可以阅读 MSDN 的[附加属性概述](http://msdn.microsoft.com/en-us/library/ms749011.aspx)。附加属性可以做任何事情，它们可以被认为是附加行为，因为它们可以触发一个动作发生，从而导致一个有效的行为，但是从技术上讲，它们仍然只是一个附加属性。

由于附加属性可以像行为一样，人们也开始将这些类型的附加属性称为附加行为，而实际上它并不是真正的附加行为，除非您从 Behavior 派生到附加属性[Interaction.Behaviors](http://msdn.microsoft.com/en-us/library/microsoft.internal.pivot.interactivity.interaction.behaviors.aspx)集合.

与 WPF/Silverlight 中的大多数内容一样，任何附加行为或附加属性都不需要混合。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T01:11:33.953

这是一个附加的行为。请小心，因为如果您的控件具有现有的渲染转换，它可能具有破坏性

```
public class Wibble
{
    public static bool GetWobble(DependencyObject obj)
    {
        return (bool)obj.GetValue(WobbleProperty);
    }

    public static void SetWobble(DependencyObject obj, bool value)
    {
        obj.SetValue(WobbleProperty, value);
    }

    public static readonly DependencyProperty WobbleProperty = DependencyProperty.RegisterAttached("Wobble", typeof(bool), typeof(Wibble), new UIPropertyMetadata(false, new PropertyChangedCallback(OnWobbleChanged)));

    private static void OnWobbleChanged(object sender, DependencyPropertyChangedEventArgs args)
    {
        var image = sender as Image;

        if (image == null)
            throw new InvalidOperationException("only images can wobble!");

        // don't really need this check (the find ancestor binding would still find the button), but the spec said the image should be the only child of the button
        var button = LogicalTreeHelper.GetParent(image) as Button;
        if (button == null)
            throw new InvalidOperationException("only images that are the only child of a button can wobble!");

        var previousStyle = image.Style;

        var newStyle = new Style(image.GetType(), previousStyle);

        // this will override any existing render transform + origin on the button, hope they didn't already have one (and I'm too lazy to check)
        newStyle.Setters.Add(new Setter(Image.RenderTransformProperty, new RotateTransform(0)));
        newStyle.Setters.Add(new Setter(Image.RenderTransformOriginProperty, new Point(0.5, 0.5)));

        var trigger = new DataTrigger();

        var binding = new Binding();

        var relativeSource = new RelativeSource();
        relativeSource.Mode = RelativeSourceMode.FindAncestor;
        relativeSource.AncestorType = typeof(Button);

        binding.RelativeSource = relativeSource;
        binding.Path = new PropertyPath(Button.VisibilityProperty);

        trigger.Binding = binding;
        trigger.Value = Visibility.Visible;

        var storyboard = new Storyboard();

        var animation = new DoubleAnimationUsingKeyFrames();
        animation.SetValue(Storyboard.TargetPropertyProperty, new PropertyPath("(0).(1)", Image.RenderTransformProperty, RotateTransform.AngleProperty));
        animation.Duration = new Duration(TimeSpan.FromSeconds(5)); // spec said 30, but i wanted to actually see it happen!
        animation.KeyFrames.Add(new LinearDoubleKeyFrame(-12, KeyTime.FromTimeSpan(TimeSpan.FromSeconds(0.2))));
        animation.KeyFrames.Add(new LinearDoubleKeyFrame(12, KeyTime.FromTimeSpan(TimeSpan.FromSeconds(0.4))));
        animation.KeyFrames.Add(new LinearDoubleKeyFrame(0, KeyTime.FromTimeSpan(TimeSpan.FromSeconds(0.5))));

        storyboard.Children.Add(animation);
        storyboard.RepeatBehavior = RepeatBehavior.Forever;

        var beginStoryboard = new BeginStoryboard();
        beginStoryboard.Storyboard = storyboard;
        beginStoryboard.Name = "its_wobble_time"; // it is

        trigger.EnterActions.Add(beginStoryboard);

        var removeStoryboard = new RemoveStoryboard();
        removeStoryboard.BeginStoryboardName = beginStoryboard.Name;

        trigger.ExitActions.Add(removeStoryboard);

        newStyle.Triggers.Add(trigger);

        image.Style = newStyle;
    }
} 
```

以下是它的使用方法：

```
<Button Width="100" Height="25" >
        <Image Source="Untitled.png" xmlns:local="clr-namespace:WpfApplication17" local:Wibble.Wobble="True" />
    </Button> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T04:16:19.367

通过在 VS 中添加新项目然后导航到 WPF 模板来创建 WPF 自定义控件。这将允许您选择“自定义控件 (WPF)”。将其命名为“ShakyImageControl”。这将创建一个 Themes 文件夹，其中包含一个 generic.xaml 和一个“ShakyImageControl.cs”类文件。在 generic.xaml 中，将现有样式替换为以下内容：

```
<Style TargetType="{x:Type local:ShakyImageControl}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type local:ShakyImageControl}">
                <Image x:Name="image" Source="{TemplateBinding ImageSource}" RenderTransformOrigin="0.5,0.5">
                    <Image.RenderTransform>
                        <TransformGroup>
                            <RotateTransform x:Name="Rotaty"/>
                        </TransformGroup>
                    </Image.RenderTransform>       
                </Image>
                <ControlTemplate.Triggers>
                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Button}, Path=Visibility}" Value="Visible">
                        <DataTrigger.EnterActions>
                            <BeginStoryboard Name="fred">
                                <Storyboard AutoReverse="False" RepeatBehavior="Forever" Duration="0:0:30" Storyboard.TargetName="Rotaty" Storyboard.TargetProperty="Angle">
                                    <DoubleAnimationUsingKeyFrames>
                                        <EasingDoubleKeyFrame KeyTime="0:0:0.2" Value="-12.0"/>
                                        <EasingDoubleKeyFrame KeyTime="0:0:0.4" Value="12.0"/>
                                        <EasingDoubleKeyFrame KeyTime="0:0:0.5" Value="0"/>
                                    </DoubleAnimationUsingKeyFrames>
                                </Storyboard>
                            </BeginStoryboard>
                        </DataTrigger.EnterActions>
                        <DataTrigger.ExitActions>
                            <StopStoryboard BeginStoryboardName="fred"/>
                        </DataTrigger.ExitActions>
                    </DataTrigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

在 ShakyImageControl 类中添加一个依赖属性，如下所示：

```
static ShakyImageControl()
    {
        DefaultStyleKeyProperty.OverrideMetadata(typeof(ShakyImageControl), new FrameworkPropertyMetadata(typeof(ShakyImageControl)));
    }

    public ImageSource ImageSource
    {
        get { return (ImageSource)GetValue(ImageSourceProperty); }
        set { SetValue(ImageSourceProperty, value); }
    }

    // Using a DependencyProperty as the backing store for ImageSource.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty ImageSourceProperty =
        DependencyProperty.Register("ImageSource", typeof(ImageSource), typeof(ShakyImageControl), new UIPropertyMetadata(null)); 
```

要在按钮中使用 shakyImage，只需执行以下操作：

```
<Button Height="50" Width="500" Name="showy" Visibility="Collapsed"> 
        <local:ShakyImageControl ImageSource="\Expand.png"/>
    </Button> 
```

local 是一个 xml 命名空间，例如 "xmlns:local="clr-namespace:WpfApplication6"

注意：如果您愿意，您的自定义控件可以在单独的程序集中

# iphone - 解析具有从 JSON 消息生成的单个值的 NSArray

> ID：11093304
> 
> 赞同：2
> 
> 时间：2012-06-19T01:37:57.137
> 
> 标签：iphone, ios, json, wcf

我在这里梳理了问题，希望能找到我所处的类似情况，但找不到。我的问题涉及 iOS 5 中的 NSJSONSerialization 类，以及如何处理解析从 JSONObjectWithData:options:error: 方法返回的单个值。返回的 JSON 数据是数组中的单个值，如下所示：

`[1]`

数据将是 1（如上所示）或 0，具体取决于我正在使用的 Web 服务中执行的逻辑。附带说明一下，Web 服务是 WCF REST 服务。在 XCode 中，将反序列化的 JSON 分配给临时 NSArray 对象后，调试器会显示以下内容：

`po parsedData`

`(NSArray *) $43 = 0x06e2ee70 <__NSCFArray 0x6e2ee70>( 1 )`

当我尝试使用 ObjectAtIndex: 从数组中获取值时，我得到了这个：

`po [parsedData objectAtIndex:0]`

`(id) $44 = 0x06b1dad0 1`

我的问题是：`0x06b1dad0`之前的十六进制值 ( ) 是`1`什么？也许是我没有访问的键或索引（我在想我只是没有深入到数组中以获得真正的价值）？它与 JSON 的格式化方式有关吗？正如我一直在考虑的那样，我有一种格式被关闭的感觉。

我遇到的问题是我无法获取存储在 JSON 消息中的实际值——当我访问数组中的元素`parsedData`并将其分配给变量时，它只返回十六进制值而不是`1`.

转换为 NSInteger 给出了这个：

`po (NSInteger)[parsedData objectAtIndex:0]`

`(NSInteger) $45 = 112319184 1`

对此的任何见解将不胜感激。如果论坛的其他地方已经解决了这个问题，我深表歉意。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T01:41:52.553

对象可能是 NSNumber 试试这个：

```
[[parsedData objectAtIndex:0] intValue]; 
```

# verilog - 使用 Altera DE2-115 进行项目，该项目涉及在屏幕上显示输出

> ID：11093311
> 
> 赞同：0
> 
> 时间：2012-06-19T01:38:58.547
> 
> 标签：verilog, vga, intel-fpga

使用altera DE2-115进行项目，该项目涉及在屏幕上显示输出，我很难将VGA与verilog一起使用，能否请您显示或链接到一个非常简单的工作示例，以便我理解这个概念并将其应用于我的项目

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T08:21:59.853

[FPGA4FUN](http://www.fpga4fun.com/)有一些[制作乒乓球游戏的VGA 示例](http://www.fpga4fun.com/PongGame.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-21T10:46:11.210

如果你有 de2-115 板的 system-cd。在其演示中有 vga 控制器，您可以通过演示了解如何使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-29T16:17:39.783

您是否尝试过 Terasic 随板提供的示例或“系统构建器”？ [http://www.terasic.com.tw/cgi-bin/page/archive.pl?Language=English&CategoryNo=139&No=502&PartNo=4](http://www.terasic.com.tw/cgi-bin/page/archive.pl?Language=English&CategoryNo=139&No=502&PartNo=4)

# rubygems - 当附件是 .html 文件时，Pony 无法正确发送电子邮件正文？

> ID：11093320
> 
> 赞同：3
> 
> 时间：2012-06-19T01:40:41.523
> 
> 标签：rubygems, pony

向 gmail 发送带有附件（html 文件）的电子邮件时，不会发送电子邮件正文。如果我注释掉下面的附件设置就可以了。如果碰巧电子邮件没有任何附件，那就没问题了。

我测试了只有当文件的扩展名为“html”时才会出现问题。其他文件，如 log、png 都可以。

*   ruby 1.8.7 (2010-08-16 补丁级别 302) [i386-mingw32]
*   哑剧类型 (1.18)
*   小马 (1.4)

**如何** `.html` ***在我的发送邮件功能中正确发送文件？***

**更新：**我从收到的电子邮件中添加了一个摘录，电子邮件正文作为中间 mimepart 出现。搜索`Content-ID: <4fdfd7725ba26_a0c1a825dc8363d@RATionalxp.mail>`

```
def email_it(body, subject, to, from, attachment_to_send)

  $smtp = 'mail.com.au'
  $smtp_port = 25

  body_with_footer = body +Email_footer

    Pony.mail(
        :to => to, 
        :from => from,
        :subject => subject, 
        :body => Nokogiri::HTML(body_with_footer).text, 
        :html_body =>  body_with_footer, 
        :attachments => attachment_to_send,
        :via => :smtp, 
        :via_options => {
                :address     => $smtp,
                :port     => $smtp_port,
                :enable_starttls_auto => false
        }
    )
end 
```

从收到的电子邮件中提取

```
Mime-Version: 1.0
Content-Type: multipart/alternative;
 boundary="--==_mimepart_4fdfd77251dac_a0c1a825dc83328";
 charset=UTF-8
Content-Transfer-Encoding: 7bit

----==_mimepart_4fdfd77251dac_a0c1a825dc83328
Date: Tue, 19 Jun 2012 11:35:46 +1000
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: base64
Content-ID: <4fdfd7725ba26_a0c1a825dc8358f@RATionalxp.mail>

QW50wqBydW7CoG5hbWXCoMKgOsKgRWR1bWF0ZV91cGdyYWRlX211bHRpwqAo
ZXhwcmVzcylPdmVyYWxswqByZXN1bHQ6wqBmYWlswqBBbnTCoHJ1bsKgdG9v
azrCoG5vYm9kecKga25vd3PCoDstKcKgUmVzdG9yaW5nwqBmcm9twqAvdmFy
L2xpYi9lZHVtYXRlL2JkcnMvbG9xdWF0L2RhdGFiYXNlcy93ZWVrbHkvTE9R
VUFULjAuZGIyaW5zdDEuTk9ERTAwMDAuQ0FUTjAwMDAuMjAxMjA2MTAwMjMw
MDYuMDAxVGltZXN0YW1wwqBvZsKgYmFja3VwwqBpbWFnZcKgaXM6wqAxMMKg
SnVuwqAyMDEywqAwMjozMERhdGFiYXNlwqBSQVRJT05BTMKgcmVzdG9yZWTC
oHN1Y2Nlc3NmdWxsecKgZnJvbcKgZGF0YWJhc2U6wqBMT1FVQVRyZXN0b3Jl
wqB0b29rOsKgMDowMDozOC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LURldGFpbHPCoGZvcsKgYWxswqBSYXRpb25hbMKgdGVzdMKgc3VpdHMtLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1FZHVtYXRlX3VwZ3JhZGU6wqBs
b2fCoGZpbGXCoG5vdMKgY3JlYXRlZC7CoEVycm9ywqBpbsKgcHJldmlvdXPC
oHRlc3TCoHN1aXTCoChzdG9wT25GYWlsdXJlPSd0cnVlJynCoG9ywqBpbsKg
YW50wqBydW7CoGl0c2VsZi5Qb3dlcmVkIGJ5IEVkdVRlc3RlciBodHRwOi8v
MTAuMC4wLjUw

----==_mimepart_4fdfd77251dac_a0c1a825dc83328
Date: Tue, 19 Jun 2012 11:35:46 +1000
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit
Content-ID: <4fdfd7725ba26_a0c1a825dc8363d@RATionalxp.mail>

Ant&nbsp;run&nbsp;name&nbsp;&nbsp;:&nbsp;Edumate_upgrade_multi&nbsp;(express)<BR>Overall&nbsp;result:&nbsp;fail<BR>&nbsp;<BR>Ant&nbsp;run&nbsp;took:&nbsp;nobody&nbsp;knows&nbsp;;-)<BR>&nbsp;<BR>Restoring&nbsp;from&nbsp;/var/lib/edumate/bdrs/loquat/databases/weekly/LOQUAT.0.db2inst1.NODE0000.CATN0000.20120610023006.001<BR>Timestamp&nbsp;of&nbsp;backup&nbsp;image&nbsp;is:&nbsp;10&nbsp;Jun&nbsp;2012&nbsp;02:30<BR>Database&nbsp;RATIONAL&nbsp;restored&nbsp;successfully&nbsp;from&nbsp;database:&nbsp;LOQUAT<BR>restore&nbsp;took:&nbsp;0:00:38<BR><BR><BR>------------------------------<BR>Details&nbsp;for&nbsp;all&nbsp;Rational&nbsp;test&nbsp;suits<BR>------------------------------<BR><BR>Edumate_upgrade:&nbsp;log&nbsp;file&nbsp;not&nbsp;created.&nbsp;Error&nbsp;in&nbsp;previous&nbsp;test&nbsp;suit&nbsp;(stopOnFailure='true')&nbsp;or&nbsp;in&nbsp;ant&nbsp;run&nbsp;itself.<BR><BR><HR><BR>Powered by EduTester http://10.0.0.50

----==_mimepart_4fdfd77251dac_a0c1a825dc83328
Date: Tue, 19 Jun 2012 11:35:46 +1000
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8;
 filename=rational_ft_logframe.html
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment;
 filename=rational_ft_logframe.html
Content-ID: <4fdfd77259308_a0c1a825dc834d0@RATionalxp.mail>

<HTML>
<HEAD>
<META HTTP-EQUIV="charset" CONTENT="utf-8"> 
```

# 更新2

来自小马谷歌组（不是我的话）

我有一个类似但更简单的例子。

```
Pony.mail to: 'me@test.com', 
   from: 'test@test.com',
   subject: 'test attachments',
   html_body: '<p>HTML</p>',
   body: 'Text',
   attachments: { File.basename(a_file_path) => File.read(a_file_path) } 
```

我认为内容类型和边界设置不正确。使用上面的代码，我只会看到附件，看不到 HTML 或文本正文，尽管它们被正确发送。如果我查看替代方案（OSX Mail 上的 Option-Command-]），我可以看到它们，并且它们显示正确。content-type 设置为 multipart/alternative，没有 Content-Disposition。我相信在这种情况下，我们发送 html、纯文本和附件作为替代品，而不是带有附件的 2 个替代品，我认为这是混合的，尽管设置内容类型 multipart/mixed 似乎不起作用两者之一：所有 3 个都彼此内联。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T22:21:46.430

我的解决方法是在附加之前将 .htm(l) 文件重命名为 .txt。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-21T08:40:35.783

对我来说，它通过添加

```
headers: { "Content-Type" => "multipart/mixed" } 
```

作为 Pony.mail 的参数。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-03-30T15:01:28.297

将此附件放在通过这样的选项下

```
Pony.mail to: 'me@test.com', 
   from: 'test@test.com',
   subject: 'test attachments',
   html_body: '<p>HTML</p>',
   body: 'Text',
   :via_options => { :port => '25',
                     :address => 'smtp.gmail.com',
                     :enable_starttls_auto => true, 
                     :attachments: { File.basename(a_file_path) => File.read(a_file_path)}
                    } 
```

# c# - 如何通过协议在 Google Doc 上创建文件类型条目？

> ID：11093321
> 
> 赞同：0
> 
> 时间：2012-06-19T01:40:43.713
> 
> 标签：c#, gdata, google-docs-api

此代码有效。它创建一个**文档类型**条目。我只将变量的内容：body(term='http://schemas.google.com/docs/2007#document' 更改为 term='http://schemas.google.com/docs/2007#file')。发送请求后，服务器返回响应<400 Bad Request>。这很奇怪。我跟踪了 Google Data API 的源代码，并找到了那种（http://schemas.google.com/docs/2007#file）。如何修改代码以创建文件类型条目。谢谢。

```
HttpWebRequest call = null;
HttpWebResponse echo = null;

StreamWriter send = null;
StreamReader read = null;

string data = string.Empty;
string body = string.Empty;

body = "<?xml version='1.0' encoding='UTF-8'?>
    <entry xmlns='http://www.w3.org/2005/Atom'
        xmlns:docs='http://schemas.google.com/docs/2007'>
        <category scheme='http://schemas.google.com/g/2005#kind'
            term='http://schemas.google.com/docs/2007#document'/>
        <title>test.txt</title>
    </entry>";

call = HttpWebRequest.Create("https://docs.google.com/feeds/default/private/full") as HttpWebRequest;

call.Method = "POST";
call.Headers.Add("GData-Version: 3.0");
call.Headers.Add("Authorization: Bearer " + Access_Token);
call.ContentType = "application/atom+xml";
call.ContentLength = Encoding.UTF8.GetBytes(body).Length;
call.Headers.Add("X-Upload-Content-Length: 0");

send = new StreamWriter(call.GetRequestStream());
send.Write(body);
send.Close();
send.Dispose();

echo = call.GetResponse() as HttpWebResponse;
if (echo.StatusCode == HttpStatusCode.Created)
{
    read = new StreamReader(echo.GetResponseStream());
    data = read.ReadToEnd();
    MessageBox.Show("entry.xml:" + Enviroment.NewLine + data);
    read.Close();
    read.Dispose();
}
else
{
    MessageBox.Show("entry not created. " + echo.StatusCode.ToString() + "(" + echo.StatusDescription + ")");
}
echo.Close(); 
```

然后，我想创建一个**文件类型**条目。我修改了代码。

```
body = "<?xml version='1.0' encoding='UTF-8'?>
    <entry xmlns='http://www.w3.org/2005/Atom'
        xmlns:docs='http://schemas.google.com/docs/2007'>
        <category scheme='http://schemas.google.com/g/2005#kind'
            term='http://schemas.google.com/docs/2007#file'/>
        <title>test.exe</title>
    </entry>";

call = HttpWebRequest.Create("https://docs.google.com/feeds/default/private/full?convert=false") as HttpWebRequest;

call.Method = "POST";
call.Headers.Add("GData-Version: 3.0");
call.Headers.Add("Authorization: Bearer " + Access_Token);
call.ContentType = "application/atom+xml";
call.ContentLength = Encoding.UTF8.GetBytes(body).Length;
call.Headers.Add("X-Upload-Content-Length: 0");

send = new StreamWriter(call.GetRequestStream());
send.Write(body);
send.Close();
send.Dispose();

echo = call.GetResponse() as HttpWebResponse; 
```

返回 400 错误请求

```
body = "<?xml version='1.0' encoding='UTF-8'?>
    <entry xmlns='http://www.w3.org/2005/Atom'
        xmlns:docs='http://schemas.google.com/docs/2007'>
        <category scheme='http://schemas.google.com/g/2005#kind'
            term='http://schemas.google.com/docs/2007#document'/>
        <title>test.exe</title>
    </entry>";

call = HttpWebRequest.Create("https://docs.google.com/feeds/default/private/full?convert=false") as HttpWebRequest;

call.Method = "POST";
call.Headers.Add("GData-Version: 3.0");
call.Headers.Add("Authorization: Bearer " + Access_Token);
call.ContentType = "application/atom+xml";
call.ContentLength = Encoding.UTF8.GetBytes(body).Length;
call.Headers.Add("X-Upload-Content-Length: 0");

send = new StreamWriter(call.GetRequestStream());
send.Write(body);
send.Close();
send.Dispose();

echo = call.GetResponse() as HttpWebResponse; 
```

返回 403 禁止

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T05:25:06.453

检查[https://developers.google.com/google-apps/documents-list/#creating_or_uploading_files](https://developers.google.com/google-apps/documents-list/#creating_or_uploading_files)上的文档，您需要做的是添加`?convert=false`到上传网址。

# java - 将 JTextField 输入限制为整数

> ID：11093326
> 
> 赞同：51
> 
> 时间：2012-06-19T01:41:44.220
> 
> 标签：java, swing, numbers, jtextfield

我知道这个问题一定被问过并回答了一百万次，但我就是找不到简单的解决方案。我有一个 JTextField，它只接受正整数作为输入。我需要一种方法来确保这里没有其他输入。

我已经有一个 keyListener 附加到这个控件。删除此侦听器要处理的其他代码，我有这个：

```
 txtAnswer.addKeyListener(new KeyAdapter() {
        @Override
        public void keyPressed(KeyEvent e) {

            int key = e.getKeyCode();

            /* Restrict input to only integers */
            if (key < 96 && key > 105) e.setKeyChar('');
        };
    }); 
```

如您所见，我正在尝试使用 KeyCode 来检查刚刚按下的键是否在整数范围内。这似乎有效。但我想做的是如果条目超出此范围，则简单地忽略它。该代码`e.setKeyChar('')`旨在处理此问题，但它不起作用。代码将编译，但没有可见的效果。

谁能告诉我我是否走在正确的轨道上？我可以用什么代替`e.setKeyChar('')`来完成这项工作？还是我完全走错了方向？

谢谢。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-06-19T01:47:03.943

不要为此使用 KeyListener，因为您会错过很多，包括粘贴文本。此外，KeyListener 是一个非常低级的构造，因此在 Swing 应用程序中应避免使用。

该解决方案已在 SO 上多次描述：使用[DocumentFilter](http://docs.oracle.com/javase/7/docs/api/javax/swing/text/DocumentFilter.html)。这个网站上有几个这样的例子，有些是我写的。

例如：[使用-documentfilter-filterbypass](https://stackoverflow.com/questions/9345750/using-documentfilter-filterbypass/9346426#9346426)

另外对于教程帮助，请查看：[实现 DocumentFilter](http://docs.oracle.com/javase/tutorial/uiswing/components/generaltext.html#filter)。

**编辑**

例如：

```
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JTextField;
import javax.swing.text.AttributeSet;
import javax.swing.text.BadLocationException;
import javax.swing.text.Document;
import javax.swing.text.DocumentFilter;
import javax.swing.text.PlainDocument;

public class DocFilter {
   public static void main(String[] args) {
      JTextField textField = new JTextField(10);

      JPanel panel = new JPanel();
      panel.add(textField);

      PlainDocument doc = (PlainDocument) textField.getDocument();
      doc.setDocumentFilter(new MyIntFilter());

      JOptionPane.showMessageDialog(null, panel);
   }
}

class MyIntFilter extends DocumentFilter {
   @Override
   public void insertString(FilterBypass fb, int offset, String string,
         AttributeSet attr) throws BadLocationException {

      Document doc = fb.getDocument();
      StringBuilder sb = new StringBuilder();
      sb.append(doc.getText(0, doc.getLength()));
      sb.insert(offset, string);

      if (test(sb.toString())) {
         super.insertString(fb, offset, string, attr);
      } else {
         // warn the user and don't allow the insert
      }
   }

   private boolean test(String text) {
      try {
         Integer.parseInt(text);
         return true;
      } catch (NumberFormatException e) {
         return false;
      }
   }

   @Override
   public void replace(FilterBypass fb, int offset, int length, String text,
         AttributeSet attrs) throws BadLocationException {

      Document doc = fb.getDocument();
      StringBuilder sb = new StringBuilder();
      sb.append(doc.getText(0, doc.getLength()));
      sb.replace(offset, offset + length, text);

      if (test(sb.toString())) {
         super.replace(fb, offset, length, text, attrs);
      } else {
         // warn the user and don't allow the insert
      }

   }

   @Override
   public void remove(FilterBypass fb, int offset, int length)
         throws BadLocationException {
      Document doc = fb.getDocument();
      StringBuilder sb = new StringBuilder();
      sb.append(doc.getText(0, doc.getLength()));
      sb.delete(offset, offset + length);

      if (test(sb.toString())) {
         super.remove(fb, offset, length);
      } else {
         // warn the user and don't allow the insert
      }

   }
} 
```

为什么这很重要？

*   如果用户使用复制和粘贴将数据插入到文本组件中怎么办？KeyListener 可以错过这个吗？
*   您似乎希望检查数据是否可以表示 int。如果他们输入不合适的数字数据怎么办？
*   如果您想允许用户稍后输入双重数据怎么办？用科学记数法？

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2013-04-26T04:19:15.640

您也可以使用`JFormattedTextField`，使用起来要简单得多。例子：

```
public static void main(String[] args) {
    NumberFormat format = NumberFormat.getInstance();
    NumberFormatter formatter = new NumberFormatter(format);
    formatter.setValueClass(Integer.class);
    formatter.setMinimum(0);
    formatter.setMaximum(Integer.MAX_VALUE);
    formatter.setAllowsInvalid(false);
    // If you want the value to be committed on each keystroke instead of focus lost
    formatter.setCommitsOnValidEdit(true);
    JFormattedTextField field = new JFormattedTextField(formatter);

    JOptionPane.showMessageDialog(null, field);

    // getValue() always returns something valid
    System.out.println(field.getValue());
} 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2013-06-18T06:24:28.283

我不敢相信我还没有在堆栈溢出的任何地方找到这个简单的解决方案，它是迄今为止最有用的。更改 Document 或 DocumentFilter 不适用于 JFormattedTextField。Peter Tseng 的回答非常接近。

```
NumberFormat longFormat = NumberFormat.getIntegerInstance();

NumberFormatter numberFormatter = new NumberFormatter(longFormat);
numberFormatter.setValueClass(Long.class); //optional, ensures you will always get a long value
numberFormatter.setAllowsInvalid(false); //this is the key!!
numberFormatter.setMinimum(0l); //Optional

JFormattedTextField field = new JFormattedTextField(numberFormatter); 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2012-06-19T01:49:19.443

这是使用 keylistener 的一种方法，但使用 keyChar（而不是 keyCode）：

[http://edenti.deis.unibo.it/utils/Java-tips/Validating%20numerical%20input%20in%20a%20JTextField.txt](http://edenti.deis.unibo.it/utils/Java-tips/Validating%20numerical%20input%20in%20a%20JTextField.txt)

```
 keyText.addKeyListener(new KeyAdapter() {
    public void keyTyped(KeyEvent e) {
      char c = e.getKeyChar();
      if (!((c >= '0') && (c <= '9') ||
         (c == KeyEvent.VK_BACK_SPACE) ||
         (c == KeyEvent.VK_DELETE))) {
        getToolkit().beep();
        e.consume();
      }
    }
  }); 
```

另一种方法（我个人发现它几乎与 Swing 的 JTree 模型一样过于复杂）是使用格式化文本字段：

[http://docs.oracle.com/javase/tutorial/uiswing/components/formattedtextfield.html](http://docs.oracle.com/javase/tutorial/uiswing/components/formattedtextfield.html)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-06-19T02:14:44.193

我曾经为此使用 Key Listener，但我用这种方法失败了很多。推荐的最佳方法是使用 DocumentFilter。下面是我创建的一种实用方法，用于构建仅输入数字的文本字段。请注意，它也需要单个“。” 字符也是如此，因为它可用于十进制输入。

```
public static void installNumberCharacters(AbstractDocument document) {
        document.setDocumentFilter(new DocumentFilter() {
            @Override
            public void insertString(FilterBypass fb, int offset,
                    String string, AttributeSet attr)
                    throws BadLocationException {
                try {
                    if (string.equals(".")
                            && !fb.getDocument()
                                    .getText(0, fb.getDocument().getLength())
                                    .contains(".")) {
                        super.insertString(fb, offset, string, attr);
                        return;
                    }
                    Double.parseDouble(string);
                    super.insertString(fb, offset, string, attr);
                } catch (Exception e) {
                    Toolkit.getDefaultToolkit().beep();
                }

            }

            @Override
            public void replace(FilterBypass fb, int offset, int length,
                    String text, AttributeSet attrs)
                    throws BadLocationException {
                try {
                    if (text.equals(".")
                            && !fb.getDocument()
                                    .getText(0, fb.getDocument().getLength())
                                    .contains(".")) {
                        super.insertString(fb, offset, text, attrs);
                        return;
                    }
                    Double.parseDouble(text);
                    super.replace(fb, offset, length, text, attrs);
                } catch (Exception e) {
                    Toolkit.getDefaultToolkit().beep();
                }
            }
        });
    } 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-05-05T14:28:43.743

当您在键释放后向 JtextField1 键入整数时，它将进入 try 内部，对于任何其他字符，它将抛出 NumberFormatException。如果您在 catch 内将空字符串设置为 jTextField1，则用户无法键入除正数以外的任何其他键，因为每次错误尝试都会清除 JTextField1。

```
 //Fields 
int x;
JTextField jTextField1;

 //Gui Code Here

private void jTextField1KeyReleased(java.awt.event.KeyEvent evt) {                                        
    try {
        x = Integer.parseInt(jTextField1.getText());
    } catch (NumberFormatException nfe) {
        jTextField1.setText("");
    }
} 
```

# android - 东芝 Excite 系统崩溃（以及如何处理）

> ID：11093327
> 
> 赞同：-1
> 
> 时间：2012-06-19T01:41:48.517
> 
> 标签：android

我们一直在测试长时间运行平板电脑（或任何东西）作为显示器的想法，一切都很好，但每隔几天，平板电脑似乎就会崩溃。没有电源问题，我假设没有内存问题。当我看它时，它显然是通电的，但屏幕是空白的，点击电源唤醒它什么也没做。必须长按电源按钮才能硬重启（无确认对话框）。

完全被正在发生的事情弄糊涂了。没有那么惊讶。如果这一切都没有问题，我实际上会有点惊讶。

但是，想知道我应该在哪里寻找信息。即使我们无法解决这个问题，我也想发送某种错误报告。我查看了 /data/dontpanic，但它是空的。系统崩溃日志还有其他地方吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T03:25:11.037

从来没有弄清楚根本原因。似乎是一个奇怪的硬件问题。有什么办法可以去掉问题吗？

# mysql - 如果您有一个整数主键数组，那么从 MySQL 获取一堆行的最佳方法是什么？

> ID：11093334
> 
> 赞同：1
> 
> 时间：2012-06-19T01:42:40.840
> 
> 标签：mysql, rows

我有一个带有自动递增整数主键的 MySQL 表。我想根据程序内存中的整数数组从表中获取一堆行。该数组的范围从少数到大约 1000 个项目。

获取行的最有效查询语法是什么？

我能想到几个：

1.  “SELECT * FROM thetable WHERE id IN (1, 2, 3, 4, 5)”（这就是我现在所做的）
2.  "SELECT * FROM thetable where id = 1 OR id = 2 OR id = 3"
3.  “SELECT * FROM thetable WHERE id = 1”形式的多个查询。可能对查询缓存最友好，但由于有大量查询解析而代价高昂。
4.  一个联合，比如 "SELECT * FROM thetable WHERE id = 1 UNION SELECT * FROM thetable WHERE id = 2 ..." 我不确定 MySQL 是否缓存每个查询的结果；它也是最冗长的格式。

我认为在 MySQL 5.6+ 中使用 NoSQL 接口将是最有效的方法，但我还没有达到 MySQL 5.6。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T01:43:37.067

No.1 是最快且最容易维护的。所以你已经到了你想去的地方。

# android - 通过 runtime.exec() 运行的 Shell 脚本的行为与通过终端运行时不同

> ID：11093335
> 
> 赞同：0
> 
> 时间：2012-06-19T01:42:44.870
> 
> 标签：android

我有这个 shell 脚本片段：

```
am start -n com.android.gallery3d/com.android.gallery3d.app.MovieActivity -d /sdcard/movie.mp4
sleep 5
input keyevent 4 
```

该脚本的基本内容如下： 1\. 打开图库应用程序以启动 movie.mp4 2\. 休眠 5 秒 3\. 按返回键

当我通过 adb shell 运行此脚本时，事情按预期进行，即视频仅播放前 5 秒，然后按下返回键，这基本上退出了图库应用程序。

但是，当我通过 runtime.exec() 运行它时，画廊确实启动了，但没有其他任何事情发生。当应用程序在后台时，系统似乎阻止我运行脚本。有人碰巧知道任何解决方法吗？或者有什么方法可以使用 INTENT 来达到相同的结果？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T01:53:24.990

应用程序运行的脚本以应用程序用户标识运行，它没有 adb shell（以 shell 甚至 root 运行）所具有的额外调试权限。

出于安全原因，应用程序不应该能够将虚假击键提供给其他应用程序，尤其是不能提供给系统本身。

也许你应该尝试用 Intent 开始其他事情，而不是退出画廊。

# php - 由于 include() 而发生的莫名其妙的异常

> ID：11093344
> 
> 赞同：0
> 
> 时间：2012-06-19T01:43:56.183
> 
> 标签：php, exception

我真的不知道我做了什么导致这个异常，但我推断这个问题的发生只是因为我包含了一个 PHP 脚本。这是它抛出的错误：

```
[Tue Jun 19 01:33:28 2012] [error] [client 127.0.0.1] PHP Fatal error:  Cannot redeclare sql_connect() (previously declared in core.php:6) in core.php on line 9 
```

这里是`sql_connect()`：

```
function sql_connect(){
    $a = mysql_connect("localhost", "user", "pass") or die(json_encode(array("failure"=>"SQL CON FAILURE: ".mysql_error()))); // Line 6
    mysql_select_db("whoSync", $a);
    return $a;
} //Line 9 
```

更多背景：`core.php`实际上并没有运行任何代码，它只是定义了函数。现在这就是为什么它很奇怪：当我包含`core.php`在`home.php`它上面时会抛出异常。包含`core.php`在任何其他文件中*不会*导致错误。

我非常擅长 PHP，但我不知道发生了什么。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T01:45:23.133

更改`include`为`include_once`或`require_once`。

问题是您多次调用/包含一个包含函数的文件。抛出致命错误以防止函数被定义两次。

**解释：**

通过使用 *_once，PHP 将在脚本执行期间只包含一次指定的文件。由于它的动态特性，PHP 不支持方法重载（在类范围之外）。像 Java 这样的语言支持方法的重载/覆盖。

假设您有一个名为 home.php、about.php 和 sidebar.php 的文件。所有三个文件都调用另一个文件 database.php，该文件有一个名为 dbhandler() 的函数。

dbhandler() 已被定义。如果 home.php 被调用，并且它引用了 sidebar.php，那么 database.php 将被调用两次。使用 include_once/require_once，只会包含尚未调用的 database.php。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T01:51:07.947

这意味着`core.php`已经加载，例如，其他一些文件包含它，并且`home.php`包含该文件会导致这种情况。为了防止这种情况，您可以使用`include_once`or`require_once`确保一个文件只包含一次。或者您可以确保只包含一次文件。

# c# - 使用 LINQ 获取下一个可用整数

> ID：11093350
> 
> 赞同：7
> 
> 时间：2012-06-19T01:44:51.250
> 
> 标签：c#, linq, linq-to-objects

假设我有一个整数列表：

```
List<int> myInts = new List<int>() {1,2,3,5,8,13,21}; 
```

我想获得下一个可用整数，按递增整数排序。不是最后一个或最高的一个，但在这种情况下是不在此列表中的下一个整数。在这种情况下，数字是 4。

是否有一个 LINQ 语句可以给我这个？如：

```
var nextAvailable = myInts.SomeCoolLinqMethod(); 
```

编辑：废话。我说答案应该是 2，但我的意思是 4。对此我深表歉意！

例如：假设您负责分发进程 ID。您想获取当前进程 ID 的列表，并发出下一个，但下一个不应只是最大值加一。相反，它应该是进程 ID 有序列表中的下一个可用的。你可以从最高的开始获得下一个可用的，这并不重要。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-06-19T03:13:37.967

I see a lot of answers that write a custom extension method, but it is possible to solve this problem with the standard linq extension methods and the static [Enumerable](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.aspx) class:

```
List<int> myInts = new List<int>() {1,2,3,5,8,13,21};

// This will set firstAvailable to 4.
int firstAvailable = Enumerable.Range(1, Int32.MaxValue).Except(myInts).First(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-19T02:36:41.537

The answer provided by @Kevin has a undesirable performance profile. The logic will access the source sequence numerous times: once for the `.Count` call, once for the `.FirstOrDefault` call, and once for each `.Contains` call. If the `IEnumerable<int>` instance is a deferred sequence, such as the result of a `.Select` call, this will cause at least 2 calculations of the sequence, along with once for each number. Even if you pass a list to the method, it will potentially go through the entire list for *each* checked number. Imagine running it on the sequence `{ 1, 1000000 }` and you can see how it would not perform well.

LINQ strives to iterate source sequences no more than once. This is possible in general and can have a big impact on the performance of your code. Below is an extension method which will iterate the sequence exactly once. It does so by looking for the difference between each successive pair, then adds 1 to the first lower number which is more than 1 away from the next number:

```
public static int? FirstMissing(this IEnumerable<int> numbers)
{
    int? priorNumber = null;

    foreach(var number in numbers.OrderBy(n => n))
    {
        var difference = number - priorNumber;

        if(difference != null && difference > 1)
        {
            return priorNumber + 1;
        }

        priorNumber = number;
    }

    return priorNumber == null ? (int?) null : priorNumber + 1;
} 
```

Since this extension method can be called on any arbitrary sequence of integers, we make sure to order them before we iterate. We then calculate the difference between the current number and the prior number. If this is the first number in the list, `priorNumber` will be null and thus `difference` will be null. If this is not the first number in the list, we check to see if the difference from the prior number is exactly 1\. If not, we know there is a gap and we can add 1 to the prior number.

You can adjust the return statement to handle sequences with 0 or 1 items as you see fit; I chose to return null for empty sequences and n + 1 for the sequence `{ n }`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T02:09:36.247

This will be fairly efficient:

```
static int Next(this IEnumerable<int> source)
{
    int? last = null;
    foreach (var next in source.OrderBy(_ => _))
    {
        if (last.HasValue && last.Value + 1 != next)
        {
            return last.Value + 1;
        }

        last = next;
    }

    return last.HasValue ? last.Value + 1 : Int32.MaxValue;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-19T01:58:24.490

```
public static class IntExtensions
{
    public static int? SomeCoolLinqMethod(this IEnumerable<int> ints)
    {
        int counter = ints.Count() > 0 ? ints.First() : -1;

        while (counter < int.MaxValue)
        {
            if (!ints.Contains(++counter)) return counter;
        }

        return null;
    }
} 
```

用法：

```
var nextAvailable = myInts.SomeCoolLinqMethod(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-19T02:01:09.923

Ok, here is the solution that I came up with that works for me.

```
var nextAvailableInteger = Enumerable.Range(myInts.Min(),myInts.Max()).FirstOrDefault( r=> !myInts.Contains(r)); 
```

If anyone has a more elegant solution I would be happy to accept that one. But for now, this is what I'm putting in my code and moving on.

Edit: this is what I implemented after Kevin's suggestion to add an extension method. And that was the real answer - that no single LINQ extension would do so it makes more sense to add my own. That is really what I was looking for.

```
public static int NextAvailableInteger(this IEnumerable<int> ints)
{
    return NextAvailableInteger(ints, 1); // by default we use one
}
public static int NextAvailableInteger(this IEnumerable<int> ints, int defaultValue)
{
    if (ints == null || ints.Count() == 0) return defaultValue;

    var ordered = ints.OrderBy(v => v);
    int counter = ints.Min();
    int max = ints.Max();

    while (counter < max)
    {
        if (!ordered.Contains(++counter)) return counter;
    }
    return (++counter);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-19T16:35:43.893

Not sure if this qualifies as a cool Linq method, but using the left outer join idea from [This SO Answer](https://stackoverflow.com/a/684158/2308533 "Find the smallest unused number in SQL Server")

```
var thelist = new List<int> {1,2,3,4,5,100,101};

var nextAvailable = (from curr in thelist
                    join next in thelist
                        on curr + 1 equals next into g
                    from newlist in g.DefaultIfEmpty()
                    where !g.Any ()
                    orderby curr
                    select curr + 1).First(); 
```

This puts the processing on the sql server side if you're using Linq to Sql, and allows you to not have to pull the ID lists from the server to memory.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-07-17T06:44:07.537

```
var nextAvailable = myInts.Prepend(0).TakeWhile((x,i) => x == i).Last() + 1; 
```

It is 7 years later, but there are better ways of doing this than the selected answer or the answer with the most votes.

The list is already in order, and based on the example 0 doesn't count. We can just prepend 0 and check if each item matches it's index. TakeWhile will stop evaluating once it hits a number that doesn't match, or at the end of the list.
The answer is the last item that matches, plus 1.
TakeWhile is more efficient than enumerating all the possible numbers then excluding the existing numbers using Except, because we TakeWhile will only go through the list until it finds the first available number, and the resulting Enumerable collection is at most n.
The answer using Except generates an entire enumerable of answers that are not needed just to grab the first one. Linq can do some optimization with First(), but it still much slower and more memory intensive than TakeWhile.

# ios - Xcode TableView - 无法识别的选择器发送到实例

> ID：11093352
> 
> 赞同：0
> 
> 时间：2012-06-19T01:45:13.567
> 
> 标签：ios, xcode, uitableview, storyboard

我正在尝试学习表格视图，但遇到了障碍。我在 Storyboard 中正确连接了视图委托和数据源，但是当我到达包含表格视图的应用程序部分时，出现以下运行时错误。

```
Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[UINavigationItem tableView:numberOfRowsInSection:]: unrecognized selector sent to instance 
```

这是我的实现文件中的块

```
@implementation CraftingViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return 5;
}

-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
{
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = (UITableViewCell *) [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier]; 
    }

    cell.textLabel.text = @"Detail";

    return cell;

}

-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T01:50:18.797

显示该错误消息是因为`tableView:numberOfRowsInSection:`正在发送到 type 的对象，`UINavigationItem`而您的类似乎`CraftingViewController`可能是 type `UITableViewController`。我会确保您已将您的代表连接到正确的类，因为它似乎`CraftingViewController`连接不正确。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-11-02T15:30:22.643

如果数据源是 nib 文件的控制器。

请检查此控制器的分配使用“CraftingViewController”而不是“UIViewController”

# android - 如何在标记-JSOUP 上找到元素

> ID：11093353
> 
> 赞同：0
> 
> 时间：2012-06-19T01:45:22.383
> 
> 标签：android, jsoup

我有一个网页，其中包含一个包含不同值的表，我想检索已定义的值。例子

```
<td align="center" valign="middle" style="font-size:12pt;width:17%;">10:00 PM </td>
<td class="paddingTop paddingBottom" align="center" style="width:20%;">
    <img id="MainContent_ChannelDisplay2_GrdChannelProgs_imgProgThumbnail_26" src="../ProgramsImages/Movies/Bad%20Boys%20II.jpg" align="middle" style="border-color:White;border-width:1px;border-style:solid;width:95px;" />
</td>
<td class="Vdotline paddingTop" style="width:2%;">&nbsp;</td>
<td class="BottomGreyBorder InTxt2 paddingTop" align="left" valign="top" style="width:64%;">
    <table width="100%">
        <tr>
            <td>
                <b><a id="MainContent_ChannelDisplay2_GrdChannelProgs_progLink_26" class="ShowingNowTitle" href="ProgramDetails.aspx?ProgramID=2320">Bad Boys II</a></b><br />
                    <div id="2320" class="statVal">
                        <span class="ui-rater">
                            <span class="ui-rater-starsOff" style="width: 90px;">
                                <span class="ui-rater-starsOn" style="width: 63px"></span>
                            </span>
                            <span class="ui-rater-rating">3.5</span>
                                &#160;(<span class="ui-rater-rateCount">2</span>) 
                        </span>
                    </div> 
```

我想检索 10:00 PM。所有其他都具有相同的结构，但具有不同的值，例如 8:00 PM、6:00PM ......请知道如何在 JSOUP 上制作它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T07:08:26.647

由于您想要的唯一唯一性`td`是您可以使用的第一个：

```
Elements tds = document.getElementsByTag("td"); //then access the one at 0 index 
```

或尝试

```
Elements tds = doc.select("td"); //then access the one at 0 index 
```

查看文档以获取更多选项...

[使用选择器语法查找元素](http://jsoup.org/cookbook/extracting-data/selector-syntax)

[使用 DOM 方法导航文档](http://jsoup.org/cookbook/extracting-data/dom-navigation)

**编辑**

如果你想找到`td`一些，`a`那么你可以做这样的事情：

```
Elements a= document.getElementsByTag("a"); 
```

然后遍历`a`并查看它的`child`( `td`) 一些其他方法，看这里[Element Object 子方法](http://jsoup.org/apidocs/org/jsoup/nodes/Element.html#child%28int%29)

或者如果我误会了你

```
Elements td= document.getElementsByTag("td"); 
```

然后遍历 the`td`并查看它的`child`( `a`)

# android - 如何从 JSON 解析中获取 return 语句的结果？

> ID：11093355
> 
> 赞同：0
> 
> 时间：2012-06-19T01:45:52.500
> 
> 标签：android, json, return

我已经按照从[此处](https://stackoverflow.com/a/2049156/1160352)使用 JSON 解析值的代码，但在我的 return 语句中遇到了问题。我想将解析结果放入我的 return 语句中。怎么做？

这是我的代码：

```
public String MASUK(String user, String password)
    {
        SoapObject request = new SoapObject(WSDL_TARGET_NAMESPACE,OPERATION_NAME);

        PropertyInfo pi = new PropertyInfo();
        pi.setName("ccduser");
        pi.setValue(user);
        pi.setType(String.class);
        request.addProperty(pi);

        PropertyInfo pi2 = new PropertyInfo();
        pi2.setName("password");
        pi2.setValue(password);
        pi2.setType(String.class);
        request.addProperty(pi2);

        SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
        envelope.dotNet = true;

        envelope.setOutputSoapObject(request);

        HttpTransportSE httpTransport = new HttpTransportSE(SOAP_ADDRESS);
        try
        {
            httpTransport.call(SOAP_ACTION, envelope);
            SoapObject resultSOAP = (SoapObject) envelope.bodyIn;

            /* gets our result in JSON String */
            String ResultObject = resultSOAP.getProperty(0).toString();

            resultSOAP = (SoapObject) envelope.bodyIn;
            ResultObject = resultSOAP.getProperty(0).toString();

            if (ResultObject.startsWith("{")) { // if JSON string is an object
                JSONObj = new JSONObject(ResultObject);
                Iterator<String> itr = JSONObj.keys();
                while (itr.hasNext()) {
                    String Key = (String) itr.next();
                    String Value = JSONObj.getString(Key);
                    BundleResult.putString(Key, Value);
                    // System.out.println(bundleResult.getString(Key));
                }
            } 

            else if (ResultObject.startsWith("[")) { // if JSON string is an array
                JSONArr = new JSONArray(ResultObject);
                System.out.println("length" + JSONArr.length());
                for (int i = 0; i < JSONArr.length(); i++) {
                    JSONObj = (JSONObject) JSONArr.get(i);
                    BundleResult.putString(String.valueOf(i), JSONObj.toString());
                    // System.out.println(bundleResult.getString(i));
                } 
            }
        }
        catch (Exception exception)
        {

        }

        return null;

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T02:06:02.560

如果您有 JSON 数组对象：

```
JSONObject jObject = new JSONObject(***JSON String you have ***);
JSONArray contestantObjects = jObject.getJSONArray("*** Array Name ***");
for(int i=0; i<contestantObjects.length(); i++) {
        mChannels.setId(contestantObjects.getJSONObject(i).getString("id").toString());
        mChannels.setName(contestantObjects.getJSONObject(i).getString("name").toString());
} 
```

如果您只有一项：

```
JSONObject jObject = new JSONObject(***JSON String you have ***);
mPreview.setBody(jObject.getString("*** Item Name ***").toString());
mPreview.setPublishedDate(jObject.getString("publishedDate").toString());
mPreview.setRefKey(jObject.getString("refKey").toString());
mPreview.setTitle(jObject.getString("title").toString()); 
```

[http://jsonviewer.stack.hu/](http://jsonviewer.stack.hu/)是解析 JSON 的在线工具。它很棒，你可以使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T03:04:32.540

参考您用于解析 JSON 字符串的链接，我建议您`bundleResult`从函数中返回对象。将您的方法的返回值更改为`public Bundle MASUK(String user, String password)`.

**编辑**

不要忘记初始化 Bundle 对象：

```
private Bundle bundleResult=new Bundle(); 
```

并注意不要更改正在使用的变量的大小写（大写/小写）。我可以在您的代码中看到，`BundleResult.putString(Key, Value);`并且参考链接使用`bundleResult.putString(Key, Value);`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T01:52:48.790

```
JSONObject prefsJson = new JSONObject(prefsJsonString);
String str = prefsJson.has("str") == true ? prefsJson.getString("str") : ""; 
```

那样行吗？

# git - 修复 git 分支：refs 现在显示 refs/remotes/branch 和 refs/remotes/origin/branch

> ID：11093356
> 
> 赞同：0
> 
> 时间：2012-06-19T01:46:10.037
> 
> 标签：git, git-branch, git-rebase, git-remote

我将计算机上的本地分支重新定位到其他分支，从而搞砸了它。我想变基，但我没有切换到我想变基的分支，结果我搞砸了`somebranch`。我不知道如何撤消我的 rebase 搞砸`somebranch`（如果有人知道将来知道这将是一件好事）所以我决定既然我`somebranch`在 github 上，我就在本地删除它，然后从 github 拉它。我不知道我做了什么，但我也搞砸了。最终，我找到了我认为正确的命令，可以通过从远程来源拉入来重新创建已删除的本地分支：

```
git fetch origin somebranch:refs/remotes/somebranch
git checkout -b somebranch --track origin/somebranch 
```

在 gitk 我可以看到现在有三件事：
*somebranch，remotes/somebranch，remotes/origin/somebranch*

但我所有的其他分支只显示一个本地和一个远程。示例：
*someotherbranch、remote/origin/someotherbranch*

我跑了`git for-each-ref`， ref/remotes/somebranch 和 ref/remotes/origin/somebranch 都指向同一个提交。

我的问题是两者之间有什么区别以及如何摆脱 ref/remotes/somebranch。我试过`git update-ref -d remotes/somebranch`了，但没有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T04:08:28.480

你几乎拥有它。只需添加“参考”：

```
git update-ref -d refs/remotes/somebranch 
```

您可以通过在存储库的顶层发出来确认它已经消失：

```
ls .git/refs/remotes 
```

# git - Git 和 SSH，使用哪个密钥？

> ID：11093358
> 
> 赞同：128
> 
> 时间：2012-06-19T01:46:45.977
> 
> 标签：git, ssh

假设您的`.ssh`目录包含 30 个密钥（15 个私有密钥和 15 个公共密钥）。

Git 在哪里可以检查哪一个用于连接到给定的远程存储库？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2012-06-19T02:20:42.950

文件中的以下条目`.ssh/config`解决了该问题

```
 host git.assembla.com
  user git
  identityfile ~/.ssh/whatever 
```

`~/.ssh/whatever`您的私钥的路径在哪里

此外，用户和主机可以从

```
git push git@git.assembla.com:repo_name.git
         ^__ ^_______________
         user host 
```

* * *

## 回答 #2

> 赞同：83
> 
> 时间：2014-05-19T05:59:15.543

在详细模式下执行 ssh，又名`ssh -v user@host`，将打印大量调试信息，其中还包含有关它正在尝试登录的密钥文件的详细信息。

```
debug1: Authentications that can continue: publickey
debug1: Next authentication method: publickey
debug1: Offering RSA public key: /home/user/.ssh/id_rsa
debug1: Server accepts key: pkalg ssh-rsa blen 332
debug1: read PEM private key done: type RSA
debug1: Authentication succeeded (publickey). 
```

现在如果你把它与 Git 自己的[SSH 帮助页面](https://help.github.com/articles/generating-ssh-keys#step-4-test-everything-out)中的第 4 步结合起来，`ssh -vT git@github.com`可以给你答案。

注意：您也可以`-i`在命令执行期间使用开关告诉 ssh，使用哪个密钥文件。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2019-09-08T08:20:59.100

我想说对我的口味最实用的是：

```
GIT_SSH_COMMAND='ssh -v' git … 
```

当然，根据具体情况，将其导出到当前 SHELL 的环境可能会有所帮助，这样您就不必每次都手动添加它。那么它会是这样的：

```
export GIT_SSH_COMMAND='ssh -v'
git … 
```

— 正如所`man git`暗示的，有一些环境变量会影响使用 SSH 的 Git 操作。根据`man ssh`您在部署选项时可以获得一些调试信息`-v`（不仅如此，如果您想了解更多信息，请查看手册）。

> 使用哪个键？

在输出中你会看到...</p>

```
debug1: Offering public key: … 
```

……这就是你问题的答案。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2012-06-19T02:00:46.713

除非在上面指定，`.ssh/config`否则它将使用默认的私钥文件。

默认文件是`~/.ssh/id_rsa`或`~/.ssh/id_dsa`取决于`~/.ssh/identity`协议版本。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2018-11-01T15:13:11.883

这可能是超级优势，但运行后`ssh -vT git@github.com`它显示它正在检查`/root/.ssh`密钥，我期待它检查我的主目录，然后我意识到我以 root 身份登录！

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-06-19T01:51:00.787

由于`git`仅用于`ssh`连接，因此它将`ssh`使用用于连接远程主机的任何密钥。详情见`~/.ssh/config`文件；该`host`块使用该`IdentityFile`指令来指定要使用的私钥。`ssh_config(5)`手册页包含完整的详细信息。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-19T16:13:47.417

在远程服务器上，编辑 sshd_config 文件并将 LogLevel 从 INFO 更改为 VERBOSE 并重新启动 ssh。

现在，您的日志文件将保存用于验证每个用户的密钥的指纹。

在 Ubuntu 上，这些文件是：

```
/etc/ssh/sshd_config
/var/log/auth.log 
```

但它们在另一个发行版上可能会有所不同。只需用谷歌搜索他们的位置（例如，有些人使用 /var/log/secure）。

# ios - 在 UITableViewCell 类中推送详细视图

> ID：11093359
> 
> 赞同：0
> 
> 时间：2012-06-19T01:47:03.863
> 
> 标签：ios, uiview

我的类继承自`UITableViewCell`，我进行了一些自定义转换以在选择图像时推送新的详细信息视图。

```
[UIView transitionWithView:self.masterView duration:0.5 options:UIViewAnimationOptionShowHideTransitionViews
                    animations:^ { 
                        [self.masterView addSubview:self.detailImage];
                    }
                    completion:nil]; 
```

我的代码工作正常，`detailImage`子视图显示有一个转换，但这个转换不是我想要的。我想要执行的是从下到上的简单过渡。该列表`UIViewAnimation`不包含此类动画。

有没有办法在不将我的类继承更改为的情况下使用该转换`UINavigationController`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T03:13:16.283

如果我理解正确，下面的代码可能就是您想要的。

```
CGRect detailImageFrameOri = self.detailImage.frame; 
CGRect detailImageFrame = detailImageFrameOri;
detailImageFrame.origin.y += self.detailImage.frame.size.height;
self.detailImage.frame = detailImageFrame;

[self.masterView addSubview:self.detailImage];

[UIView animateWithDuration:0.5 animations:^{
    self.detailImage.frame = detailImageFrameOri;
}]; 
```

希望这可以帮到你。

编辑：从上到下，

```
CGRect detailImageFrame = self.detailImage.frame;
detailImageFrame.origin.y += self.detailImage.frame.size.height;

[self.masterView addSubview:self.detailImage];

[UIView animateWithDuration:0.5 
                 animations:^{
                     self.detailImage.frame = detailImageFrame;
                 } 
                 completion:^(BOOL finished) {
                     [self.detailImage removeFromSuperview];      
                 }]; 
```

# android - 以编程方式切换标题栏的颜色？

> ID：11093362
> 
> 赞同：1
> 
> 时间：2012-06-19T01:47:18.130
> 
> 标签：android

我已经通过[这个](https://stackoverflow.com/a/2285722/599116)来改变我的标题栏的颜色。我试图弄清楚如何以编程方式切换它？假设如果用户单击一个按钮，我想切换到另一种预定义的颜色。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T02:23:47.000

您可以通过以编程方式将颜色应用于标题栏来轻松做到这一点。以编程方式更改布局颜色，

```
textView.setBackgroundColor(R.color.titletextcolor); 
```

在您的按钮单击事件中动态执行此操作，您将获得颜色变化。

# c - 如何将包含 0 或 1 的 char 数组转换为 C 中的小数？

> ID：11093363
> 
> 赞同：0
> 
> 时间：2012-06-19T01:47:19.360
> 
> 标签：c

我有一个字符串 x 需要转换为十六进制格式：

```
char x[5];
x[0]='0';
x[1]='1';
x[2]='0';
x[3]='1';  //x contains value of 0xA or decimal 10;
x[4]='\0'; 
```

现在如何将其转换并将其存储到无符号整数变量中，以便该变量的值为 0xA；

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T01:57:34.937

为什么x中的字符串顺序相反？

```
char x[5] = {'1', '0', '1', '0' };
unsigned int result = 0;
int i = 0;
while(x[i] != 0)
{
    result = result * 2 + x[i]-'0';
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-19T01:58:19.967

似乎数字是以相反的方向存储的，这对于人类来说是不自然的阅读方式，但是一种非常自然的方式来表示数字，因为索引是指应该应用的 2 的幂。

没有现有的库可以为您进行转换，您需要自己编写代码来解析它：

```
int i = 0;
unsigned int result = 0;

while (x[i]) {
    result |= (x[i] == '1') << i;
    i++;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-19T01:54:21.697

```
char *x = "0101"; 
```

不等于 0xA 或十进制 10。二进制 '1010' 会，也许这就是你的意思？

转换字符串表示的数字的简单方法是 strtol，以及 atoi 等许多其他函数。strtol 至少允许提供一个基数。

[http://www.cplusplus.com/reference/clibrary/cstdlib/strtol](http://www.cplusplus.com/reference/clibrary/cstdlib/strtol)

就像是：

```
unsigned long val = strtol(x, NULL, 2); 
```

# mysql - 如何从 mysql 备份中恢复从站？

> ID：11093367
> 
> 赞同：0
> 
> 时间：2012-06-19T01:48:17.993
> 
> 标签：mysql, backup, replication, mysqldump, database-replication

我正在运行 MySql 5.1。我在 2 台机器上有 Master 和 Slave，并设置了复制。

我在我的从属服务器上进行定期备份。我停止mysql，复制所有文件并重新启动mysql。

万一我失去了大师，我可以从上次备份中设置一个新的。

如果我失去了奴隶怎么办？我可以从上次备份重新启动从站吗？我是否应该在每次备份时跟踪复制的位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T03:05:35.477

我解决这个问题的方法是：
每月（或每周/每天）备份，重置 master 以便它重新启动日志文件。将备份通过管道传输到主服务器，以便一次将一个表重新填充数据库。重新启动从站。
我有更多的奴隶，桌子重新加载并没有花太长时间。如果您的备份时间过长，您可能需要以不同的方式执行此操作。
如果您丢失了一个从属服务器，您可以通过日志文件重新启动它，只要您通过重新加载表来启动它们。如果您从其中一个从属设备进行备份，那么首先确保它与主设备同步至关重要。

可能有其他方法可以做到这一点，但定期重新启动日志文件变得非常有用。
进入 cron 的主代码（这是从很久以前开始的，您应该验证它是否适合您）：

```
#!/usr/bin/ksh
date=`date +%y%m%d`
mysql -u root db_name -e "flush tables with read lock;"
mysqldump -u root -pYrPass --add-drop-table --add-locks natl_inv > /path/to/backup/db_name$date
mysql -u root -e "reset master;"
mysql -u root db_name -e "unlock tables;"
mysql -u root –pYrPass db_name < /path/to/backup/db_name$date
mysql -u root -e "flush logs;" 
```

在从站上：使用 show slave status 命令验证您与主站同步。如果要重新同步到主服务器，请运行：

```
slave stop;
reset slave;
slave start; 
```

您可能需要停止 mysql，删除从 bin 日志文件，然后重新启动并运行上述内容。

# c# - 实体框架关系 Foreach

> ID：11093370
> 
> 赞同：0
> 
> 时间：2012-06-19T01:48:29.033
> 
> 标签：c#, asp.net-mvc-3, linq, entity-framework-4.3

我有这些类，我正在使用存储库模式并试图让 IEnumerable 包含 WorkOrderDetail。我是 MVC 和实体框架的新手，我不知道如何包含 WorkOrderDetails。

```
public IEnumerable<Schedule> GetFuture()
        {
            string tZone = "Pacific Standard Time";

            DateTime today = Today(tZone);

            var schedule = context.Schedules
                .Where(s => s.Date >= today).ToList();            

            return schedule;
        }

public abstract class Entity
    {
        public int Id { get; set; }
    }

 public class Schedule : Entity
    {
        public DateTime Date { get; set; }

        public bool Free { get; set; }

        public int WorkOrderId { get; set; }
        public virtual WorkOrder WorkOrder { get; set; }          
    }

 public class WorkOrder : Entity
    {

        public string Name { get; set; }
        public string Type { get; set; }

        public virtual ICollection<WorkOrderDetail> WorkOrderDetails { get; set; }
     }
public class WorkOrderDetail : Entity
    {
       public string Job { get; set; }
       public bool Finished { get; set; }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T01:51:33.147

改变这个：

```
var schedule = context.Schedules.Where(s => s.Date >= today).ToList(); 
```

至：

```
var schedule = context.Schedules.Include("WorkOrder.WorkOrderDetail").Where(s => s.Date >= today).ToList(); 
```

# php - 获取查询结果，无论行是否包含 SELECT 字段

> ID：11093373
> 
> 赞同：1
> 
> 时间：2012-06-19T01:48:48.843
> 
> 标签：php, mysql

下面的查询返回表中同时具有`loginid`和`ip2`的行`bumps`。

表中的所有行`bumps`都有`ip2`，但只有一些行有`loginid`。

如何让下面的查询返回`ip2`所有行和`loginid`具有的行`loginid`？

```
$sqlStrend = "SELECT e.loginid, e.time, l.username, e.ip2
      FROM bumps e
      JOIN login l ON e.loginid = l.loginid
     WHERE e.submissionid = '$submissionid' 
  ORDER BY e.time DESC
  LIMIT $offset, $rowsperpage"; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T01:51:58.903

而不是`INNER JOIN`（由 暗示`JOIN`），您只需将其更改为 a `LEFT JOIN`，这将返回左侧表上的所有行以及`NULL`相关表中的行或相关表中不存在的行。

```
SELECT e.loginid, e.time, l.username, e.ip2
FROM bumps e
LEFT JOIN login l ON e.loginid = l.loginid
WHERE e.submissionid = '$submissionid' 
ORDER BY e.time DESC
LIMIT $offset, $rowsperpage 
```

查看[这篇出色的 Wikipedia 文章](http://en.wikipedia.org/wiki/Join_%28SQL%29)或[Jeff Atwood 的联接的视觉解释中](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)`JOIN`的不同类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T01:53:12.060

你实际上是大部分的方式。要从凹凸中获取所有行和存在的登录行，您需要[LEFT JOIN](http://www.w3schools.com/sql/sql_join_left.asp)：

```
$sqlStrend = "SELECT e.loginid, e.time, l.username, e.ip2
      FROM bumps e
      LEFT JOIN login l ON e.loginid = l.loginid
     WHERE e.submissionid = '$submissionid' 
  ORDER BY e.time DESC
  LIMIT $offset, $rowsperpage"; 
```

# ruby-on-rails - 大规模创造和关联 habtm

> ID：11093375
> 
> 赞同：1
> 
> 时间：2012-06-19T01:49:18.280
> 
> 标签：ruby-on-rails

我有 3 个模型（流派、情绪、节奏），每个模型都与另一个模型（轨道）有 has_and_belongs_to_many 关联。用户可以上传包含每个曲目信息的 Excel 文件，我希望能够在我的更新方法中创建相应的记录并一次添加所有关联。

我正在从电子表格中读取每一行，并创建包含与每首曲目关联的流派、情绪和节奏的数组，但我不确定如何正确创建关联。

就像是：

```
1.upto @worksheet.last_row_index do |index|
  row = @worksheet.row(index)
  genres = row[6].split(", ")
  genres.each do |g|
    Genre.find_or_create_by_name(g) // not sure what to do here exactly
  end
end 
```

Track ID 为 row[0]。

如果每个流派不存在，我需要创建它，并将该轨道与每个流派相关联。如果流派确实存在，那么我只需要创建关联。情绪和节奏也是如此。

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T03:21:51.230

这似乎做到了。

```
1.upto @worksheet.last_row_index do |index|
  row = @worksheet.row(index)
  track = Track.find(row[0])
  genres = row[6].split(", ")
  genres.each do |g|
    track.genres << Genre.find_or_create_by_name(g)
  end
end 
```

# android - 设置什么 CursorAdapter(Context context, Cursor c, int flags) 以使其与 CursorLoader 一起工作？

> ID：11093380
> 
> 赞同：13
> 
> 时间：2012-06-19T01:49:50.403
> 
> 标签：android, android-contentprovider, android-cursoradapter, android-loadermanager, android-cursorloader

谷歌文档指出不要使用第`CursorAdapters`一个构造函数，

```
CursorAdapter(Context context, Cursor c) 
```

只有另外两个选择，

```
CursorAdapter(Context context, Cursor c, boolean autoRequery) 
```

它说

> 允许控制自动重新查询的构造函数。建议您不要使用它，而是使用 CursorAdapter(Context, Cursor, int)。使用此构造函数时，将始终设置 FLAG_REGISTER_CONTENT_OBSERVER。`

和

```
CursorAdapter(Context context, Cursor c, int flags)` 
```

这表示它是推荐的构造函数。

问题是这里的最后一个构造函数只有两个标志可以使用，`FLAG_AUTO_REQUERY`(int 1) 和`FLAG_REGISTER_CONTENT_OBSERVER`(int 2)。使用`FLAG_AUTO_REQUERY`没有意义，因为我现在使用 CursorLoader 在后台管理它并更新它。使用`FLAG_REGISTER_CONTENT_OBSERVER`时，它表示不需要`CursorLoader`。

现在我问，我要传递什么整数`CursorAdapter(Context context, Cursor c, int flags)`才能使其正常工作`CursorAdapter`？让我担心的是如何正确管理旧光标。我不确定这样做的正确方法。

如果我使用`FLAG_REGISTER_CONTENT_OBSERVER`，那么我必须对 做一些事情`onContentChanged()`，但是`swapCursor()`在我的 中使用时`LoaderManager`，由于光标没有关闭，我只能做`adapter.swapCursor(cursor).close()`. 但这会与`onContentChanged()`in冲突`CursorAdapter`吗？目标是不引起任何内存泄漏并提高效率。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-19T03:16:31.253

几周前我在博客上写过这个话题……也许通读它会有所帮助。您还可以考虑通读开发人员网站上的[示例代码。](http://developer.android.com/resources/samples/ApiDemos/src/com/example/android/apis/app/LoaderCursor.html)

## [获得 LoaderManager 类的好处](http://www.androiddesignpatterns.com/2012/05/why-you-should-use-loadermanager.html)

* * *

> 我应该使用哪个构造函数？

使用`CursorAdapter(Context context, Cursor c, int flags)`（文档建议使用此构造函数而不是前者）。

> 我传递什么整数`CursorAdapter(Context context, Cursor c, int flags)`。

只需将整数传递给它`0`。您不想传递它`FLAG_REGISTER_CONTENT_OBSERVER`，因为您正在使用 a`CursorLoader`与您的`CursorAdapter`（因为`CursorLoader`寄存器`ContentObserver for you), and you definitely don't want to pass it`FLAG_AUTO_REQUERY`，因为该标志已被弃用。

> 让我担心的是如何正确管理旧光标。我不确定这样做的正确方法。

的全部意义`LoaderManager`在于它在幕后为您完成了所有烦人的光标管理工作。自动加载数据而无需担心管理查询游标的便利正是不推荐使用旧方法`startManagingCursor`和`stopManagingCursor`方法的原因。

> ...我可以做`adapter.swapCursor(cursor).close()`

不要那样做。将`LoaderManager`自行关闭光标。事实上，如果我没记错的话，如果你试图调用`close()`光标，你会得到一个错误。听起来你也不应该重写`onContentChanged()`。

# https - 如何使用 squid 阻止 https 网站

> ID：11093382
> 
> 赞同：3
> 
> 时间：2012-06-19T01:50:03.260
> 
> 标签：https, squid

我想知道是否有人知道如何使用 squid 阻止 https 网站。以下是我在 squid 配置中的截断配置：

```
external_acl_type my_client_bl ttl=5 negative_ttl=0 %DST %SRC /var/www/app/ACLBlacklist
acl badsites external my_client_bl
http_access deny badsites
http_access deny CONNECT badsites 
```

上述配置适用于 http，但使用 https 时出现问题。当我阻止[http://twitter.com](http://twitter.com)时，这个可以工作，但[https://twitter.com](https://twitter.com)不工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T04:00:24.150

我对此进行了仔细研究。我认为这里的问题是，当代理从 https 请求回复禁止的 403 响应时，某些浏览器将允许从代理呈现 html 错误页面，但不幸的是，某些浏览器不会解决某些安全问题（我不明白这一点）。

截至目前，经过测试的 OPERA 支持来自 https 请求的禁止 403 响应。Firefox、chrome、safari 和 IE 拒绝支持这一点。

# ruby-on-rails-3.1 - 从 sqlite3 切换到 mysql2 时 Rails rspec 测试失败

> ID：11093385
> 
> 赞同：2
> 
> 时间：2012-06-19T01:50:46.020
> 
> 标签：ruby-on-rails-3.1, rspec-rails

我有一个小的 Rails 应用程序，我最初使用的是 sqlite3，然后决定切换到 mysql。切换后，我的一个 rspec 测试失败了，但我不知道为什么（使用 sqlite3 时它工作正常，并且通过实际页面检查功能似乎工作正常）。

我的测试如下：

```
before(:each) do
    @a = FactoryGirl.create(:a)
    @b = FactoryGirl.create(:b)
    @relationship = @a.connector.build( :b_id => @b)
    @relationship.save
end 
```

测试1：

```
it "should have the right b" do
    @relationship.b.should == @b
end 
```

测试 2：

```
it "should have the right a" do
    @relationship.a.should == @a
end 
```

在我的测试中，测试 1 失败，而使用 mysql 时测试 2 成功通过（使用 sqlite3 时的两个路径）。据我所知，如果我只是切换数据库，我不应该要求对测试本身进行任何更改，那么任何人都可以判断我是否做错了什么？或者如果我需要添加一些东西来刷新数据库？

在相关说明中，在 rspec 测试本身中调试问题的推荐方法是什么，尤其是在实际开发工作但测试失败的情况下？（我使用的是 Rails 3.1 和 rspec-rails 2.10.1）。

提前感谢您的任何意见，

问候，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-25T06:07:53.080

我最近遇到了这个问题；问题是由我的模型中的错误缓存行为引起的。

在第一个规范中，我缓存了第一个对象，它是使用 ID 1 创建的。当为第二个规范重新创建时，该对象在 SQLite3 上以 ID 1 创建，在 MySQL 上以 ID 2 创建。

因此，缓存行为在 SQLite3 上测试时是幸运的，而在 MySQL 上一直失败。

# c++ - OSX Lion 上的 GDB 7.3.1

> ID：11093392
> 
> 赞同：4
> 
> 时间：2012-06-19T01:51:36.433
> 
> 标签：c++, macos, gdb, osx-lion

我正在尝试使用 macports 中的 GDB（v 7.3.1）来调试使用 g++ 4.7（也来自 macports）编译的可执行文件。但是，我启动调试器，得到以下输出：

> GNU gdb (GDB) 7.3.1 版权所有 (C) 2011 Free Software Foundation, Inc. 许可证 GPLv3+：GNU GPL 版本 3 或更高版本 [http://gnu.org/licenses/gpl.html](http://gnu.org/licenses/gpl.html)这是免费软件：您可以自由更改并重新分配它。在法律允许的范围内，不提供任何保证。键入“显示复制”和“显示保修”以了解详细信息。此 GDB 配置为“x86_64-apple-darwin11.2.0”。错误报告说明请参见： [http](http://www.gnu.org/software/gdb/bugs/) ://www.gnu.org/software/gdb/bugs/ ... BFD：无法读取未知加载命令 0x24 BFD：无法读取未知加载命令 0x26 BFD：无法读取未知加载命令 0x24 BFD：无法读取未知加载命令 0x26

然后，每当我尝试回溯时，调试器都无法提供有关堆栈的任何信息；我得到如下输出：

```
> #0  0x00000001085106d5 in ?? ()
> #1  0x000000010833d9b6 in ?? ()
> #2  0x0000000107e23000 in ?? ()
> #3  0x00007f828341f630 in ?? ()
> #4  0x00007f828341bc10 in ?? ()
> #5  0x00007f8283421950 in ?? ()
> #6  0x00007f8283427020 in ?? ()
> #7  0x00007f8283425510 in ?? ()
> #8  0x00007f82834195e0 in ?? ()
> #9  0x0000000100000001 in ?? ()
> #10 0x0000000100000000 in ?? () 
```

我已经使用调试符号构建了，并且能够在 linux 上很好地调试可执行文件。有谁知道这里发生了什么或我如何解决它。没有调试器真的很难解决某些问题！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T06:03:39.580

我对 OSX 或 gdb 的使用了解不多，但这似乎在 gdb 7.3.1 发布后不久就已修复，我似乎记得有关 OSX 的发布和 gdb 或 binutils 的发布大约在同一时间，开发人员无法提前访问 OS X。您可以尝试更新版本的 gdb。

我猜想在 7.3.1 修复后不久提交的以下补丁：

[http://permalink.gmane.org/gmane.comp.gnu.binutils/54607](http://permalink.gmane.org/gmane.comp.gnu.binutils/54607)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T21:13:13.297

GDB 7.4.1 已修复此问题，您可以获取并构建它。

[http://sourceware.org/gdb/wiki/BuildingOnDarwin](http://sourceware.org/gdb/wiki/BuildingOnDarwin)

# c# - C# 用户定义的对不同类中方法的回调

> ID：11093400
> 
> 赞同：1
> 
> 时间：2012-06-19T01:52:39.420
> 
> 标签：c#, callback

我一直在寻找几天来解决 C 或 C++ 中的一个琐碎问题，但在 C# 中似乎不可能。

另一个程序员创建了A类。A类中的一个事件处理程序方法需要调用我B类中的一个方法来处理事件。根据事件的类型，B 类中的方法需要回调 A 类中的方法，并且该方法具有任意名称，甚至可能不存在。

这在 C 中很简单；您只有一个指向回调函数的指针，如果它不为空，则间接调用它。我不知道如何在 C# 中进行间接方法调用。这是一些说明问题的代码示例。

```
public class A: ZZZ { // this class is NOT under my control
   private b = new B(this);

   public void myCallback(C x) {
      // do something
   }

   // Elsewhere in the application expects a protected
   // override method to exist in *this* class A to handle
   // an event. But we want a method in class B to handle
   // it and then call myCallback depending on the type of event

   protected override void handle_some_event(event e) {
      // doesn't work -- how do I pass a "pointer" to the callback??
      b.handle_event(e, myCallback);
   }
}

public class B {    // this class IS under my control
   private A base;

    public B(A a) {
       base = a; // allows for calling methods in class A from class B
    }

    public handle_event(event e, ??? callback pointer ??? cback) {
       // do stuff...
       // then do the callback
       // cback(); // this won't work
       base.myCallback(); // this WILL work but only if I hard-code "myCallback"
    }    
} 
```

问题是 B 类是我正在编写的，而 A 类是由将使用我的 B 类的其他人编写的。其他人可以选择根本不定义回调，或者创建一个任意的回调姓名。B 类需要以某种方式知道那是什么以及如何访问它。在 C 或 C++ 中，其他程序员可以简单地将指针传递给他的回调函数。这在 C# 中可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T01:57:41.957

您想将 an 传递`Action<T>`给`handle_some_event`您可以这样做：

```
public handle_some_event(event e, Action<C> cback) 
{
   // Do stuff
   if(cback != null)
       cback(myC);
} 
```

您`class B`实际上根本不需要了解任何关于 的信息`class A`，它只需要一个 Action 委托来执行，其余的无关紧要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T00:16:39.010

这是我最终得到的解决方案，基于我最初帖子中的代码

```
public class A: ZZZ { // this class is NOT under my control
   private b = new B(this);
   b.UserCallback = myCallback;

   static void myCallback(C x) {
      // do something
   }

   // Elsewhere in the application expects a protected
   // override method to exist in *this* class A to handle
   // an event. But we want a method in class B to handle
   // it and then call myCallback depending on the type of event

   protected override void handle_some_event(event e) {
      b.handle_event(e);
   }
}

public delegate void usercallback(Z z); // declare OUTSIDE both classes

public class B {    // this class IS under my control
   public usercallback UserCallback = defaultCallback;
   static void defaultCallback(Z z) { /* do nothing */ }

   public handle_event(event e) {
       // do stuff...
       // then do the callback
       UserCallback(z);
   }    
} 
```

让我停留了一段时间的原因是，我的脑袋被这样一个事实包围了：委托声明类似于 C 函数原型，并且委托可以用作类中的声明类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T01:55:02.317

您可以使用 Action 委托来引用回调。

检查此 URL 以获取更多信息：http: [//msdn.microsoft.com/en-us/library/018hxwa8.aspx](http://msdn.microsoft.com/en-us/library/018hxwa8.aspx)

将您的 B 类更改为： public class B { private A base;

```
 public B(A a) {
       base = a; // allows for calling methods in class A from class B
    }

   //#################### NOTE THE CHANGE HERE ##################//
    public handle_some_event(event e, Action<C> cback) {
       // do stuff...
       // then do the callback
       cback(x); // this will work assuming you have x defined somewhere in B
    }    
} 
```

# php - Codeigniter 动态表单下拉菜单，不是返回值而是返回 ID

> ID：11093402
> 
> 赞同：0
> 
> 时间：2012-06-19T01:53:01.460
> 
> 标签：php, javascript, jquery, codeigniter

我的下拉表单有这个代码，效果很好

```
<?php echo form_label('Model: ', 'model'); ?>
<?php echo form_dropdown('model', $model_dropdown, '', set_value('model', '', 'id="model"')); ?>

<?php echo form_label('Make: ', 'make'); ?>
<?php echo form_dropdown('make', $make_dropdown, '', set_value('make', '', 'id="make"')); ?> 
```

但是后来我想用一些jquery来增强它的动态下拉，所以我把它改成了这个

```
<label for="make">Make: </label>
<?php echo form_dropdown('id', $make_dropdown, '', 'id="make"'); ?><br /></td>

<?php $models['#'] = 'Please Select'; ?>
<label for="model">Model: </label>
<?php echo form_dropdown('model_id', $models, '', 'id="models"'); ?><br /></td> 
```

用这个为 js

```
 $(document).ready(function(){
    $('#make').change(function(){
        $("#models > option").remove();
        var id = $('#make').val();
        $.ajax({
            type: "POST",
            url: "site/get_models/"+id,
            datatype : "json",

            success: function(models)            {
                $.each(models,function(id,model)
                {
                    var opt = $('<option />');
                    opt.val(id);
                    opt.text(model);
                    $('#models').append(opt);
                });
            }

        });

    });
}); 
```

但是现在提交的不是值而是 ID，这在查看代码时是有意义的。需要更新什么来解决这个问题？

谢谢

编辑： Make and Model 下拉列表的 ID 是插入的内容，我想要的是这个值，比如在我添加 jquery 之前它是如何工作的。

例如，make 下拉菜单将包含 HP 或 Dell，模型将包含模型，提交时，这些值将被插入，但我只是获取 ID...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T03:01:43.040

尝试改变：

```
opt.val(id); 
```

至

```
opt.val(model); 
```

更新：好的，所以这适用于一种数据结构类型。我建议定义返回值类型，您可以在其中执行以下操作：

--> 来自 ajax 请求的“successData” = {"type":"model","id":"12345","model":"acool model"}

并且您的成功句柄可以执行以下操作：

```
 success: function(successData){

        if(successData.type === "model"){
          //do your loop to create the models markup
        else{
           //we have "make" data, handle that here..
        }
    } 
```

# android - 在填充库之前计算的android库？

> ID：11093404
> 
> 赞同：0
> 
> 时间：2012-06-19T01:53:02.410
> 
> 标签：android, ant, android-build

这是一个奇怪的。我有一个`-pre-compile`目标`custom_rules.xml`。在这里，一些 JAR 被复制到`libs`文件夹中。

如果我进行干净的构建，它会在运行时失败，因为这些库没有包含在 .apk 中。查看 的输出`ant -v ...`，Dx 没有处理这些库。因此，在针对这些库编译项目时，它们不包含在 Dx 阶段。

如果我随后做了一个 non-clean `ant debug`，一切都很好，因为复制的 JAR`-pre-compile`在构建开始时就已经存在了。

任何想法我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T15:50:58.023

`.../tools/ant/build.xml`我最终通过在 SDK 中煞费苦心地添加 echo 语句来解决这个问题。

包含`.../libs`Dx 中的库的路径在`-setup`任务中定义。这是在`-pre-compile`or之前的链中`-pre-build`，因此如果您`.../libs`在其中任何一个点将 JAR 复制到您的文件夹中，则为时已晚。

我最终覆盖了`-setup`任务，因此，

```
 <target name="-setup" depends="-prepare-libs, android_rules.-setup"/>

  <target name="-prepare-libs">
    ... build / copy libs in to .../libs here
  </target> 
```

注意调用被覆盖`-setup`任务的语法...在`project`标签中定义的项目名称附加任务名称，如`build.xml`从 SDK 导入的定义。

# c - memcpy Seg 故障看似无害

> ID：11093406
> 
> 赞同：0
> 
> 时间：2012-06-19T01:53:18.163
> 
> 标签：c, berkeley-db, memcpy

从我的 memcpy 得到一个 seg 错误，gdb 不能给我任何其他东西（至少除了我知道如何使用 gdb 的简单方式......）。这件事深深地嵌入了一些使用 Berkely DB 的代码中；我已经删除了唯一应该有用的行。

```
 void *databuf;
  int smallest;
  databuf=malloc(2*sizeof(int));
  memset(databuf,0,2*sizeof(int));

  /* This next line comes from the DB structures; key.data is a void*... */
  smallest=*(int *)key.data;

  memcpy(databuf,(void *)smallest,sizeof(int)); 
```

为了确认变量 minimum 是正确的，我可以运行 gdb 并得到

```
(gdb) print smallest
$1 = 120321 
```

我收到的错误（在 gdb 中）是无用的

```
Program received signal SIGSEGV, Segmentation fault.
0x08048efa in main (argc=4, argv=0xbffff344) at index_DB-1.1.c:128
128       memcpy(databuf,(void *)smallest,sizeof(int));
(gdb) backtrace
#0  0x08048efa in main (argc=4, argv=0xbffff344) at index_DB-1.1.c:128 
```

我这样做的原因主要是因为我将 Berkley DB 教程混为一谈，但后来我也想做

```
memcpy(databuf+len,(void *)largest,sizeof(int)); 
```

即有一个空指针databuf，第一个字节是最小整数，第二个字节是最大整数。我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T01:57:06.930

在此步骤中，您将 in 的值解释`smallest`为指针：

```
memcpy(databuf,(void *)smallest,sizeof(int)); 
```

由于该值几乎可以肯定*不是*有效指针，因此这会导致您的段错误。相反，您可能想要：

```
memcpy(databuf, &smallest, sizeof smallest); 
```

除非您`smallest`出于其他原因需要，否则您可以直接从`key.data`to 复制到`databuf`：

```
memcpy(databuf, key.data, sizeof(int)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-19T01:57:43.053

```
(void *)smallest 
```

它采用 minimum 的整数值并将其视为指针。你的意思是这样的：

```
(void *)&smallest 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T01:56:20.863

考虑到代码太糟糕了，很难说出你在做什么，但这看起来很可疑：

```
memcpy(databuf,(void *)smallest,sizeof(int)); 
```

我相信`smallest`包含正常的整数数据，而不是指向任何东西的指针。那你为什么要取消引用它？它没有指向任何东西。

你可能想要：

```
memcpy(databuf,(void *) &smallest,sizeof(int)); 
```

此外，这是可疑的：

```
smallest=*(int *)key.data; 
```

`smallest`保证整数对齐？

# css - CSS (?) - 动态调整大小以填充容器的图像行

> ID：11093414
> 
> 赞同：4
> 
> 时间：2012-06-19T01:54:31.253
> 
> 标签：css

我在玩我的网站时偶然发现了一个有趣的问题。

所以我有一个固定宽度的包含列。在这一行中，我有一排图像（现在是两个，不知道是否重要）。图像的大小和纵横比是不确定的，并且彼此不相等。现在，我希望调整它们的大小，使它们的高度相等，并且它们的组合宽度等于父容器的宽度，同时保持它们的纵横比。就此而言，还相应地调整容器高度。

希望我说清楚了。

我确信使用 JavaScript 或类似的东西是可能的，但我主要对是否有使用 CSS 的解决方案感兴趣。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T03:40:04.997

我认为这是不可能的，即使有可能，这也将是我见过的最黑暗的 css hack（除了这意味着使用不太兼容的 CSS）。使用 Javascript 更容易且值得推荐。（编辑：对于 jQuery 解决方案，请参见：http: [//jsfiddle.net/martinschaer/aJtdb/](http://jsfiddle.net/martinschaer/aJtdb/)）

但是，为了好玩，我这样做了：http: [//jsfiddle.net/martinschaer/cGZrF/](http://jsfiddle.net/martinschaer/cGZrF/)

这是最接近您可以使用 CSS3 来满足您的需要的。有一个小间隙填充了空白的垂直空间，但所有图像都使用 CSS 调整大小以适合容器。

```
.container{
    width: 600px;
    margin: 10px;
    background-color: #000;

    display: box;
    box-orient: horizontal;
    box-pack: center;
    box-align: center;
}

.imgwrapper {
    box-flex: 1;
}

img{
    max-width: 100%;
    height: auto;
    display:block;
} 
```

有关与 mozila 和 webkit 兼容的完整代码，请参阅 jsfiddle (http://jsfiddle.net/martinschaer/cGZrF/)。

编辑：对于 jQuery 解决方案，请参见：http: [//jsfiddle.net/martinschaer/aJtdb/](http://jsfiddle.net/martinschaer/aJtdb/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-01T09:40:19.117

我对 JavaScript 的经验还不是太丰富，但我有一个补充可以让后来者（比如我自己）...</p>

我注意到在[Martin's answer](http://stackoverflow.com/a/11094066/1715579)中对多行使用提供的 JSFiddle 会压缩图像，所以我想补充一点：

```
var rows = 0; // set row count for multiple 'imageWrapper' divs

$('.imageWrapper').each(function(){
    rows +=1;
}); 
```

然后`rows`像这样使用：

```
$('.imageWrapper img').each(function(){
    this.width = $(this).data('width') * (container_width / container_width_temp) * rows - 8;
}); 
```

这`- 8`是因为我发现该行中的最后一个图像往往会溢出容器并自行推入一行。

我自己仍在寻找这个问题的完美答案，但这让我更接近了一点。

# c++ - 在对象向量上使用 find_if

> ID：11093416
> 
> 赞同：0
> 
> 时间：2012-06-19T01:55:15.113
> 
> 标签：c++, stl

我没有使用 boost 库。我怎样才能使用 STL 做到这一点？

```
class Files
{

private:
   bool isSame(FileID f1, FileId f2)
   { 
      if(f1.getId()==f2.getId())
        return true;
      return false;
   }

public:
   vector<FileId> mod_files;

    void update()
    {
      FildId f = getFileId();
      vector<FildId>::const_iterator found = find_if(mod_files.begin(), mod_files.end(),          ???);
    }

}; 
```

我想将 isSame 作为第三个参数传递给 find_if 函数，并将“f”绑定到 isSame 的第二个参数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T02:05:36.223

在*C++11*中，这很简单：

```
std::bind(&Files::isSame, this, f); 
```

在良好的旧*C++03*中没有`mem_fun`需要 2 个参数，因此您必须自己进行绑定：

```
class is_same_pred
{
public:
    // unary function typedefs

    explicit is_same_pred(Files& files, FileId f1) : _files(files), _f1(f1) {}

    bool operator()(FileId f2) const { return _files.isSame(_f1, f2); }

private:
    Files& _files;
    FileId _f1;
}; 
```

在哪里`isSame`可以访问`is_same_pred`，然后像这样使用它：

```
is_same_pred(this, f); 
```

说了这么多，你最好定义`isSame`为*static*或*free-function*：

```
bool isSame(FileId f1, FileId f2){ ... }

std::bind1st(std::ptr_fun(&isSame), f); 
```

# java - 让用户通过应用程序连接数据库的正确方法

> ID：11093419
> 
> 赞同：0
> 
> 时间：2012-06-19T01:56:47.133
> 
> 标签：java, database, database-connection

我正在创建一个拥有许多用户的 Web 应用程序。每个用户都有自己的登录名和密码来访问应用程序。应用程序的数据将存储在数据库中。

由于应用程序将有很多用户，我想知道让用户通过我的应用程序连接到数据库的正确方法。

是创建多个数据库用户（帐户）还是简单地使用 master/root 从应用程序连接到数据库更好？

编辑/注意：应用程序用户将无法直接访问数据库。数据库与应用程序在同一台服务器上，不会对外开放。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T02:07:29.697

标准解决方案是您的应用程序有一个主登录名/密码来连接数据库。然后，您创建一个包含如下列的表：

*   用户身份
*   用户名
*   密码加密
*   电子邮件地址
*   权限

请注意，密码会带来安全问题，您应该使用包来处理授权，或者阅读*大量*有关该主题的内容。不要在没有强加密的情况下将用户密码存储在数据库中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T02:22:47.277

各有利弊。

使用共享服务帐户对数据库进行身份验证具有能够更有效地汇集到数据库的连接的优势。也就是说，可以在用户之间重复使用连接，从而最大限度地减少有时打开新连接的成本高昂的操作，如果每个用户单独进行身份验证，您将不得不这样做。一个明确的问题是，您必须格外小心地验证用户正在运行的任何 SQL，因为该帐户的权限必须能够执行系统中最强大的用户需要能够执行的操作。

为每个用户使用一个帐户可以让您更灵活地为各种用户分配权限，而无需在应用程序中实现您自己的自定义授权方案。此外，它使审核系统更容易一些，因为您在检查数据库连接时就知道谁连接了。最后，这种方法可以减少您对 SQL 注入的脆弱性，因为您可以锁定每个用户的帐户（最好在 DB 平台中使用基于角色的安全性），以便只能执行应允许用户执行的操作。

因此，例如，如果他们以某种方式注入了 DELETE FROM UsersTable，那么您将锁定它并且注入的命令将失败，即使它通过了您的验证逻辑。

如果您的用户知道如何使用数据库工具（尤其是 MS Access）并且可以直接访问数据库服务器，那么还有另一个考虑因素。如果您使用每用户授权模型，您可能会遇到精明的用户绕过您的应用程序并直接针对数据库工作的麻烦。如果您的用户是一群程序员，您可能希望使用共享帐户。

如果您的应用程序被大量执行小交易的**并发用户大量使用，请使用共享服务帐户进行数据库访问。**

当您有较少的用户同时连接到系统或者您想要更高的安全性和/或更好地控制对对象的授权时，请使用帐户/每个用户方案。

# php - PHP 的 foreach 错误，但 $.each 在 JS 中工作

> ID：11093420
> 
> 赞同：-1
> 
> 时间：2012-06-19T01:56:57.563
> 
> 标签：php, jquery, foreach

好的，我有一个小问题，我正在尝试将此 jQuery 转换为 PHP

我需要做的是把它放在一个 foreach 函数中，这是我首先要做的 jQuery 代码。

```
$.each(obj.products, function(i, obj) {

    if(obj.barcode == barcode)
    {
        $("#showmoreinfohere").show();
        $("#moremovietop").html(obj.name.toUpperCase());
        $("img#selectedproduct").attr('src', ''+obj.logoURL+'');
        $("span#perticket").html(obj.price);
        currentproduct["barcode"] = obj.barcode;
        currentproduct["priceperticket"] = obj.price;
        currentproduct["cashbackperticket"] = obj.discount;
        $("span#VIPCashBack").html(obj.discount);
        total = obj.price * $("#qtyselect").val();
        $("span#totalprice").html("$"+total);
    }
}); 
```

我的 PHP 代码

```
<?php
    $cartdata = $fetch->cartitems($_COOKIE["sessionkey"]);
    foreach ($cartdata as $cart)
    {
        $product_details = $fetch->getbarcode('$cart["barcode]"');
    ?>

    <tr>
        <?php 
        foreach ($product_details as $product)
        {
        ?>

        <td><?php $product['name']?></td>
        <td><?php $product['price']?></td>
        <td><?php $cart['qty']?></td>
        <td><?php $product['discount']?></td>
        <?
        }
        ?>

    <?php
    }

 ?> 
```

我得到的错误是

> 警告：在第 27 行的 /home/movies/public_html/tpl/cart.tpl 中为 foreach() 提供的参数无效

谷歌搜索的问题这是我发现的：

1.  你可以在 foreach 里面做一个 foreach
2.  product_details 的 JSON 返回以下内容

    ```
     {
       "_id": ObjectId("4f6ab67338fc5ded4f000000"),
       "company": "village",
       "logo": "http: \/\/...\/villagetop.png",
       "products": {
         "0": {
           "barcode": "236690091",
           "name": "Weekday",
           "logoURL": "http: \/\/...\/ticketpic1.png",
           "price": "12.50",
           "discount": "1.50" 
        },
        ...
      },
       "store_name": "movies" 
    } 
    ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T02:02:54.210

**编辑**

在尝试寻找答案之前，建议您在脚本顶部添加以下两行：

```
error_reporting(-1);
ini_set('display_errors', 'On'); 
```

**编辑 2**

从 JSON 转储中，您应该使用`$product_details->products`或`$product_details['products']`在`foreach`循环中使用，具体取决于您调用`json_decode()`.

* * *

以下代码：

```
$product_details = $fetch->getbarcode('$cart["barcode]"'); 
```

不太可能工作，它的正确代码：

```
$product_details = $fetch->getbarcode($cart['barcode']); 
```

* * *

在你的循环内：

```
<td><?php $product['name']?></td> 
```

这不会输出任何东西，你想要这样的东西：

```
<td><?php echo htmlspecialchars($product['name']); ?></td> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T02:23:59.993

由于产品详细信息没有以数组形式返回，因此您收到错误消息。可能可以像这样修复它：

```
<?php

$cartdata = $fetch->cartitems($_COOKIE["sessionkey"]);
foreach ($cartdata as $cart)
{
    /* This is returning null or invalid data so it is erroring on the loop below....  
       Maybe this function could return array() if empty so it passes the loop in the   
       block below. Otherwise a check is needed before entering the loop.
    */  

    $product_details = $fetch->getbarcode($cart['barcode']);
?>

    <tr>
        <?php             
        // Errors here due to null or invalid data
        foreach ($product_details as $product)
        {
        ?>
            <td><?php echo $product['name']?></td>
            <td><?php $product['price']?></td>
            <td><?php $cart['qty']?></td>
            <td><?php $product['discount']?></td>
      <? } 
}?> 
```

编辑：看到您发布了 json，但是当您运行它时会返回什么？

```
 $product_details = $fetch->getbarcode($cart['barcode']);
 var_dump( $product_details  ); 
```

# python - 在python中创建对象属性列表

> ID：11093421
> 
> 赞同：13
> 
> 时间：2012-06-19T01:57:05.063
> 
> 标签：python

我有一个对象列表：

```
[Object_1, Object_2, Object_3] 
```

每个对象都有一个属性：时间：

```
Object_1.time = 20
Object_2.time = 30
Object_3.time = 40 
```

我想创建一个时间属性列表：

```
[20, 30, 40] 
```

获得此输出的最有效方法是什么？不可能遍历对象列表，对吗？：

```
items = []
for item in objects:
    items.append(item.time) 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-06-19T01:59:14.637

列表理解是您所追求的：

```
list_of_objects = [Object_1, Object_2, Object_3]
[x.time for x in list_of_objects] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T02:06:59.083

```
from operator import attrgetter
items = map(attrgetter('time'), objects) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T05:51:05.573

最快（也是最容易理解）的是列表理解。

看时间：

```
import timeit
import random
c=10000

class SomeObj:
    def __init__(self, i):
        self.attr=i

def loopCR():
    l=[]
    for i in range(c):
        l.append(SomeObj(random.random()))

    return l 

def compCR():
    return [SomeObj(random.random()) for i in range(c)]   

def loopAc():
    lAttr=[]
    for e in l:
        lAttr.append(e.attr)

    return lAttr

def compAc():
    return [e.attr for e in l]             

t1=timeit.Timer(loopCR).timeit(10)
t2=timeit.Timer(compCR).timeit(10)
print "loop create:", t1,"secs"   
print "comprehension create:", t2,"secs"   
print 'Faster of those is', 100.0*abs(t1-t2) / max(t1,t2), '% faster'
print 

l=compCR()

t1=timeit.Timer(loopAc).timeit(10)
t2=timeit.Timer(compAc).timeit(10)
print "loop access:", t1,"secs"   
print "comprehension access:", t2,"secs"   
print 'Faster of those is', 100.0*abs(t1-t2) / max(t1,t2), '% faster' 
```

印刷：

```
loop create: 0.103852987289 secs
comprehension create: 0.0848100185394 secs
Faster of those is 18.3364670069 % faster

loop access: 0.0206878185272 secs
comprehension access: 0.00913000106812 secs
Faster of those is 55.8677438315 % faster 
```

所以列表推导式写起来更快，执行起来也更快。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-19T01:59:47.423

怎么样：

```
items=[item.time for item in objects] 
```

# objective-c - UIWebView 子类上的 tapAtPoint

> ID：11093431
> 
> 赞同：4
> 
> 时间：2012-06-19T01:58:11.767
> 
> 标签：objective-c, ios, uiwebview

我将 UIWebView 子类化了，这样我就可以获得触摸事件并实现了这个方便的方法。我很好奇，这是否适用于实际的 iOS 设备。我不在办公室，所以不知道有没有。它似乎在模拟器中工作。

```
- (void) tapAtPoint:(CGPoint)point
{
    id /*UIWebBrowserView*/ webBrowserView = nil;
    id webViewInternal = nil;
    object_getInstanceVariable(self, "_internal", (void **)&webViewInternal);
    object_getInstanceVariable(webViewInternal, "browserView", (void **)&webBrowserView);

    if (webBrowserView) {
        [webBrowserView tapInteractionWithLocation:point];
    }
} 
```

有没有人尝试过这样的事情？我肯定会在早上发现，大声笑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-21T09:57:24.117

简短回答：是的，我以同样的方式尝试了类似的方法，它也适用于真实设备（使用 iOS 6 测试）。

您的方法的 ARC 版本：

```
- (void) tapAtPoint:(CGPoint)point
{
    Ivar internalWebViewIvar = class_getInstanceVariable([self class], "_internal");
    id internalWebView = object_getIvar(self, internalWebViewIvar);

    Ivar browserViewIvar = class_getInstanceVariable(object_getClass(internalWebView), "browserView");
    id browserView = object_getIvar(internalWebView, browserViewIvar);

    if (browserView) {
        [browserView performSelector:@selector(tapInteractionWithLocation:) withObject:[NSValue valueWithCGPoint:point]];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-19T08:18:42.873

请尝试此代码，这里它工作正常。

```
/* TapDetectingWindow.m */

#import "TapDetectingWindow.h"
@implementation TapDetectingWindow
@synthesize viewToObserve;
@synthesize controllerThatObserves;
- (id)initWithViewToObserver:(UIView *)view andDelegate:(id)delegate {
    if(self == [super init]) {
        self.viewToObserve = view;
        self.controllerThatObserves = delegate;
    }
    return self;
}
- (void)dealloc {
    [viewToObserve release];
    [super dealloc];
}
- (void)forwardTap:(id)touch {
    [controllerThatObserves userDidTapWebView:touch];
}
- (void)sendEvent:(UIEvent *)event {
    [super sendEvent:event];
    if (viewToObserve == nil || controllerThatObserves == nil)
        return;
    NSSet *touches = [event allTouches];
    if (touches.count != 1)
        return;
    UITouch *touch = touches.anyObject;
    if (touch.phase != UITouchPhaseEnded)
        return;
    if ([touch.view isDescendantOfView:viewToObserve] == NO)
        return;
    CGPoint tapPoint = [touch locationInView:viewToObserve];
    NSLog(@"TapPoint = %f, %f", tapPoint.x, tapPoint.y);
    NSArray *pointArray = [NSArray arrayWithObjects:[NSString stringWithFormat:@"%f", tapPoint.x],
    [NSString stringWithFormat:@"%f", tapPoint.y], nil];
    if (touch.tapCount == 1) {
        [self performSelector:@selector(forwardTapwithObject:pointArray afterDelay:0.5];
    }
    else if (touch.tapCount > 1) {
        [NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(forwardTap ￼  object:pointArray];
    }
}
@end

/* WebViewController.h */

@interface WebViewController : UIViewController<TapDetectingWindowDelegate> {
    IBOutlet UIWebView *mHtmlViewer; 
    TapDetectingWindow *mWindow;
}

/* WebViewController.m */

- (void)viewDidLoad {
    [super viewDidLoad];
    mWindow = (TapDetectingWindow *)[[UIApplication sharedApplication].windows objectAtIndex:0];
    mWindow.viewToObserve = mHtmlViewer;
    mWindow.controllerThatObserves = self;
}

- (void)userDidTapWebView:(id)tapPoint
{
    NSLog(@"TapPoint = %f, %f", tapPoint.x, tapPoint.y);
} 
```

谢谢，如果您遇到任何问题，请告诉我。

# search - 如何在 Vim 中搜索包含正则表达式的字符串？

> ID：11093437
> 
> 赞同：2
> 
> 时间：2012-06-19T01:59:36.743
> 
> 标签：search, vim

是否可以在不转义所有花哨字符的情况下搜索作为正则表达式的字符串？

例如，我想在我的源文件中找到这个字符串：`^[\d\| *]$`，不转义`\`,`$`等。

我只想复制并粘贴正则表达式并获得结果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T04:27:30.793

您想要的是一个搜索匹配字符串的 grep，而不是尝试匹配正则表达式。使用 GNU grep，您可以使用 -F 或 --fixed-strings 标志调用该命令，或者仅将命令作为 fgrep 调用。以下都是等价的：

```
grep -F '^[\d\| *]$'
grep --fixed-strings '^[\d\| *]$'
fgrep '^[\d\| *]$' 
```

当您想要匹配表示正则表达式的代码，或者当您想要一个不需要正则表达式引擎的高级匹配功能的更快的 grep 时，您所需要的正是固定字符串搜索。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-19T11:14:59.807

有一种简单的方法可以避免对 Vim 正则表达式中的字符进行特殊处理。说明`\V` 符允许将模式其余部分的解释切换到“非常nomagic”模式，这意味着除了反斜杠之外的每个字符都是按字面意思理解的。

因此，可以相应地设置最后一个搜索寄存器：

```
:let @/ = '\V' . escape('^[\d\| *]$', '\') 
```

并立即使用`n`and`N`进行搜索。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T02:03:02.320

您可以使用命令行工具`fgrep`（“fast grep”），

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-19T11:04:51.223

假设您已将要搜索的正则表达式拉到默认寄存器 ( `@"`)，您可以这样做：

```
/\V<C-R><C-R>=escape(@", '/\')<CR><CR> 
```

开始一个“非常神奇”的搜索，其中只有以反斜杠开头的`\V`原子具有特殊的非字面意义。使`escape()`所有包含的反斜杠无效（并转义`/`，否则将结束搜索模式），因此这是纯粹的文字搜索。文本通过`Ctrl`+`R``=`插入到搜索命令行中。

# php - 如何从 javascript 向 php 发送变量并将结果返回给 JS

> ID：11093439
> 
> 赞同：-1
> 
> 时间：2012-06-19T01:59:58.770
> 
> 标签：php, javascript, jquery

我有这个代码。

```
var book = document.getElementById('txtBook').value;
switch(book.toUpperCase())
    {
        case "GEN": var bk = "101"; break;
        case "EXO": var bk = "101"; break;
        case "LEV": var bk = "101"; break;
        case "DEU": var bk = "102"; break;
        ... and so on...
    } 
```

我想`switch`用数据库查询替换我的。由于我从这里的搜索中了解到我不能直接从 JS 中进行操作，因此我需要将其传递给 php 变量。

我想知道如何将我传递`var book`给一个 php 页面，例如 getbook.php

然后，我将在 php 端进行查询。我希望将该结果返回给我的 JS 以进行进一步处理。

我更喜欢不需要页面刷新的方法。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T02:04:10.827

您需要使用[ajax](http://api.jquery.com/category/ajax/)。

```
$.get('getbook.php', {book: $('#txtBook').val()}, function(data) {
  // here you get your data and deal it 
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T02:08:45.570

最简单的方法是应用ajax。

服务脚本（getbook.php）：

```
$bookId = $_POST['book'];
//do some search stuff
$rows = getBookInfo($bookId);
$result = array('searchResult' => $rows);

header('Content-Type: application/json');
echo json_encode($result); 
```

客户端脚本（请记住为 jquery 包含 js）：

```
postData = {book: bookId};
$.ajax({
     type: 'POST',
     url: '/getbook.php',
     data: postData,
     dataType: 'JSON',
     success: function (jsonObj) {
        //use jsonObj.serachResult as array
     }
   }); 
```

# c++ - 编译将本地文件嵌入为字符串变量的程序？

> ID：11093444
> 
> 赞同：0
> 
> 时间：2012-06-19T02:01:02.143
> 
> 标签：c++, compiler-construction, include

问题应该说明一切。

假设有一个本地文件“mydefaultvalues.txt”，与主项目分开。在主项目中，我想要这样的东西：

```
 char * defaultvalues = " ... "; // here should be the contents of mydefaultvalues.txt 
```

并让编译器`" ... "`与`mydefaultvalues.txt`. 这可以做到吗？有没有编译器指令之类的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T02:04:34.537

不完全是，但你可以这样做：

默认值.h：

```
#define DEFAULT_VALUES "something something something" 
```

代码.c：

```
#include "defaults.h"

char *defaultvalues = DEFAULT_VALUES; 
```

可以在哪里生成 defaults.h，或者以其他方式创建，但是您打算这样做。预处理器只能做这么多。以它可以理解的形式制作文件将使事情变得容易得多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T02:15:27.397

我在 Linux 上所做的技巧是在 Makefile 中有这一行：

```
defaultvalues.h: defaultvalues.txt
    xxd -i defaultvalues.txt > defaultvalues.h 
```

然后你可以包括：

```
#include "defaultvalues.h" 
```

定义`unsigned char defaultvalues_txt[];`了文件的内容和文件`unsigned int defaultvalues_txt_len;`的大小。

请注意，`defaultvalues_txt`它不是以空值结尾的，因此不被视为 C 字符串。但既然你也有大小，这应该不是问题。

编辑：

一个小的变化可以让我有一个以空结尾的字符串：

```
echo "char defaultvalues[] = { " `xxd -i < defaultvalues.txt` ", 0x00 };" > defaultvalues.h 
```

如果文件中存在空字符，显然不会很好地工作`defaultvalues.txt`，但如果它是纯文本，则不会发生这种情况。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T02:15:57.867

实现这样的编译时技巧的一种方法是用一些解释性编程语言（例如 Python、Ruby 或 Perl 会很好）编写一个简单的脚本，该脚本执行简单的搜索和替换。然后在编译之前运行脚本。

定义您自己的#pramga XYZ 指令，脚本查找该指令并将其替换为用字符串中的文件内容声明变量的代码。

```
char * defaultvalues = ... 
```

其中 ... 包含从给定文本文件中读取的文本字符串。请务必补偿行长、换行符、字符串格式字符和其他特殊字符。

编辑：lvella 以非常出色的方法击败了我——拥抱你的环境为你提供的工具。在这种情况下，一个工具可以进行字符串搜索和替换并将文件提供给它。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-19T04:54:24.013

我知道迟到的答案，但我认为当前的任何答案都没有解决 OP 试图完成的任务，尽管 zxcdw 非常接近。

任何 7 岁的孩子所要做的就是将您的程序加载到十六进制编辑器中，然后按 CTRL-S。如果文本在您的可执行代码（或附近）或应用程序资源中，他们可以找到并编辑它。

如果您想防止*公众*更改资源或静态数据，只需对其进行加密，将其填充到资源中，然后在运行时对其进行解密。尝试 DES 做一些小事。

# google-chrome - 是否有通过 CTRL+TAB 将 MRU 选项卡选择添加到 Google Chrome 的真正可行的解决方案？

> ID：11093448
> 
> 赞同：38
> 
> 时间：2012-06-19T02:01:33.280
> 
> 标签：google-chrome

我在网上看到过一些黑客攻击，但没有一个能正常工作。

[https://www.google.com.au/url?sa=t&rct=j&q=&esrc=s&source=web&cd=4&sqi=2&ved=0CGoQFjAD&url=https%3A%2F%2Fgithub.com%2Facemtp%2Fchrome_mru&ei=N93fT62FG8q4iQfY5oyVCg&usg=AFQjCNF11T40hlJ5ID44TLuHuEQ](https://www.google.com.au/url?sa=t&rct=j&q=&esrc=s&source=web&cd=4&sqi=2&ved=0CGoQFjAD&url=https://github.com/acemtp/chrome_mru&ei=N93fT62FG8q4iQfY5oyVCg&usg=AFQjCNF11T4hlJ5ID44TLuHut0PN9TbuEQ)

可用的扩展也不提供这样的功能。
甚至有可能结合使用自动热键（或类似的）和扩展名吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2019-08-05T19:44:13.540

我昨天刚刚发现的另一个选项（直到现在它似乎工作得很好）是：AutoControl Shortcut Manager：[https](https://www.autocontrol.app/switch-to-last-used-tab-in-chrome#MRU-tabs) ://www.autocontrol.app/switch-to-last-used-tab-in-chrome#MRU-tabs 脚步：

*   安装 chrome 扩展：[AutoControl Shortcut Manager](https://chrome.google.com/webstore/detail/autocontrol-shortcut-mana/lkaihdpfpifdlgoapbfocpmekbokmcfd)
*   还要安装所需的exe文件：Native-Component.exe（*安装扩展后会提示下载。对我来说它不需要管理员权限。我希望它没问题...*）
*   根据官方网页上的教程（9 个步骤）配置扩展：[按 MRU 顺序循环浏览所有选项卡](https://www.autocontrol.app/switch-to-last-used-tab-in-chrome#MRU-tabs)
*   享受 ctrl+tab 行为:)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2019-04-21T01:10:15.657

是的，有一个完美的解决方案。
此扩展[**选项卡缩略图切换器**](https://chrome.google.com/webstore/detail/tab-thumbnails-switcher/jpaiaplhepeiilhiegfnknedhjepknng)可以重新定义`Ctrl`+`Tab`和`Ctrl`+ `Shift`+`Tab`以在 MRU 顺序中选择选项卡，就像在 Windows 中使用 Alt+Tab 在程序之间切换一样。

[![在此处输入图像描述](../Images/d061f91804744b23b04e355bcd29378d.png)](https://i.stack.imgur.com/Sh9Ox.gif)

最好的部分是选项卡选择框是本机实现的，因此不需要在每个选项卡上注入 javascript 即可工作。它可以在所有选项卡上可靠地工作。

这里还有一个演示视频：[https ://www.youtube.com/watch?v=2HC7_EI8db4](https://www.youtube.com/watch?v=2HC7_EI8db4)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-18T02:37:31.300

通过将 nHotKeyChar 变量从 0xde 更改为 0xc0（从波浪号 ~ 到勾号 `）并重新编译，我能够使[chrome_mru工具正常工作。](https://github.com/acemtp/chrome_mru)

然后我意识到这和[AutoHotkey](http://www.autohotkey.com/)使用[这个脚本](http://pastebin.com/hpdAMSdT)和[最近的标签](https://chrome.google.com/webstore/detail/recent-tabs/ocllfmhjhfmogablefmibmjcodggknml)Chrome 扩展做的事情是一样的。

AutoHotkey/Recent tabs 解决方案不是最理想的，是的，但我认为这是在 Chrome 实现此功能之前我们所能期望的最好的解决方案（如果有的话 /sigh）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-22T20:21:01.437

我现在为在 Windows 上工作的用户找到了实现这一目标的可能性，并编写了一个扩展程序： [https ://chrome.google.com/webstore/detail/ctrl%2Btab-mru/ialfjajikhdldpgcfglgndennidgkhik](https://chrome.google.com/webstore/detail/ctrl%2Btab-mru/ialfjajikhdldpgcfglgndennidgkhik)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-05-03T20:41:53.260

设置`Ctrl`+`Tab`以在 Windows 上使用 MRU 切换的完整解决方案：

首先下载 Chrome 的 MRU 扩展程序。在尝试了一些不同的此类扩展之后，我推荐[Ctrl+Tab MRU](https://chrome.google.com/webstore/detail/ctrl%2Btab-mru/ialfjajikhdldpgcfglgndennidgkhik)。它并不完美，但它是我能找到的最好的。

接下来，您需要将所选扩展程序的热键绑定到组合键。转到`chrome://extensions/`，向下滚动到页面底部，单击“键盘快捷键”，然后找到您选择的扩展程序的快捷键。不幸的是，Chrome 不允许您将`Ctrl`+绑定`Tab`为键盘快捷键，因此请选择 Chrome 允许您选择的组合*，*例如`Ctrl`+`Q`用于“切换到旧标签”和`Ctrl`+ `Shift`+`Q`用于“切换到新标签”。

现在我们需要进行设置，以便`Ctrl`+`Tab`触发您之前设置的组合键。为此，您需要[AutoHotkey](https://autohotkey.com/)。如果您还没有 AutoHotkey，请先[从其网站](https://autohotkey.com/)下载并安装它。然后，将以下文本放入启动文件夹中的 AutoHotkey 脚本中`%AppData%\Microsoft\Windows\Start Menu\Programs\Startup\tabswitch.ahk`（例如，在位于`C:\Users\yourusername\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`并命名为的新文本文件中`tabswitch.ahk`，没有`.txt`扩展名）：

```
; Fix for Chrome's lack of MRU tab switching.
; Use this with a decent MRU tab switching extension, like
; https://chrome.google.com/webstore/detail/ctrl%20tab-mru/ialfjajikhdldpgcfglgndennidgkhik
; Configure it to use Ctrl-Q, or change the key below.
#IfWinActive, ahk_exe chrome.exe ; If currently using Chrome
    ^Tab::^q
    ^+Tab::^+q
#IfWinActive 
```

当 Chrome 是当前选定的窗口时，这将分别重新映射+`Ctrl`和`Tab`++`Ctrl`到+`Shift`和++ 。这将允许您使用+在 Chrome 中使用 MRU 排序的选项卡之间切换。不要忘记双击脚本来运行它。当您重新启动计算机时，它应该会自动启动备份。`Tab``Ctrl``Q``Ctrl``Shift``Q``Ctrl``Tab`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-13T07:43:52.833

我使用选项卡堆栈作为解决方法，直到 Chrome 具有本机 MRU 支持（crossfingers）；）
选项卡堆栈（[https://chrome.google.com/webstore/detail/tab-stack/gfpdghcockbpiokcaaagmnneioeopnnb](https://chrome.google.com/webstore/detail/tab-stack/gfpdghcockbpiokcaaagmnneioeopnnb)）将当前选项卡移动到前面短暂的延迟。这是一个非常简单的解决方案，可为您提供一种 MRU。
上面的解决方案对我不起作用。也许是国际键盘布局的 b/c。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-11T11:23:22.027

我在 Chrome 上看到的所有 ctrl-tab MRU 选项都感觉像是 hacks/不能可靠地工作。

我建议切换到最新的[Opera](http://www.opera.com)。您基本上可以通过一些关键添加（MRU 选项卡，还有鼠标手势）获得 Chrome(ium)。

该设置位于opera://flags/#activation-order-tab-cycling（需要重新启动浏览器）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-05-11T18:08:08.200

最后有一个工作： [https ://chrome.google.com/webstore/detail/clut-cycle-last-used-tabs/cobieddmkhhnbeldhncnfcgcaccmehgn?hl=en](https://chrome.google.com/webstore/detail/clut-cycle-last-used-tabs/cobieddmkhhnbeldhncnfcgcaccmehgn?hl=en)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-04-12T21:50:01.737

这是一个[非常轻巧且直观的选项卡解决方案](https://chrome.google.com/webstore/detail/tab-slider/nobaaibkcalggmjnjhnlmmcldllpogjp)，用于按最近使用的顺序组织选项卡，所有主要浏览器（Chrome、Firefox、Opera、其他基于 Chrome 的浏览器）都支持该选项卡：[Tab Slider](https://github.com/ZitRos/tab-slider#tab-slider)。它的特点是：

*   与 Windows 上的 Alt+Tab 或 Mac 上的 Cmd+Tab 类似，但使用浏览器选项卡
*   直观地对选项卡进行排序，以便您始终按 MRU 顺序查看它们（Ctrl+Tab 切换到下一个 MRU 选项卡）
*   也适用于固定标签
*   是可定制的（但是，我建议坚持使用默认值）

试试看！希望你会喜欢它。

![图像](../Images/1c8de6cdf8a7ee09490cea49aa554467.png)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-05-30T02:15:26.113

Firefox 的`ctrl``tab`快捷方式启用了 Chrome 尚未提供的两个功能：

*   **切换到之前使用的选项卡**
    *   按下`ctrl``tab`然后松开两者
*   **使用键盘从菜单中选择打开的选项卡**
    *   按下`ctrl``tab`然后松开`tab`
    *   反复按下并松开`tab`以选择菜单中较旧的选项卡
    *   释放`ctrl`以切换到选定的选项卡

我所知道的唯一一个 Chrome 扩展程序提供了这样的传真——不需要在*你访问的网站上进行不必要的广泛读取和更改所有数据的*权限，并且可以与扩展程序无法注入代码的标签一起使用，例如 Chrome Webstore 页面——是[QuicKey](https://fwextensions.github.io/QuicKey/)（我写的）。

QuicKey 通过使用一个快捷方式打开弹出菜单（默认情况下，`alt``Q`在 Windows 上），然后侦听另一个按键（`W`，就在隔壁）来移动菜单中的选择，然后等待`alt` `keyup`事件切换到选定的选项卡。

它必须使用`W`而不是`Q`（这相当于`tab`在这个快捷方式中），因为按下它`alt`会关闭弹出窗口。（弹出页面根本看不到该键事件，因此无法阻止它。）但这确实意味着 QuicKey 可以使用快速双击`alt``Q`（或双击图标）作为切换到的快捷方式以前使用的选项卡。它通过计时弹出窗口打开的时间来做到这一点，如果时间小于 450 毫秒，则切换选项卡。

如果您想`ctrl``tab`用作在 QuicKey 中最近的标签之间切换的快捷方式，[有一种简单的跨平台方法](https://fwextensions.github.io/QuicKey/ctrl-tab/)可以通过 Chrome 开发工具来实现。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-02-15T11:49:23.497

对于 mac 用户，您可以使用此扩展程序： [chrome extension](https://chrome.google.com/webstore/detail/popup-tab-switcher/cehdjppppegalmaffcdffkkpmoflfhkc)

它有一个快捷键 opt+y 来循环浏览以前的选项卡。如果您想使用 ctrl+tab 作为快捷方式，您可以使用 karabiner 元素工具将 opt y 快捷方式映射到 ctrl tab。

我用于 karabiner 的映射是这样的：

```
 {
                            "from": {
                                "key_code": "tab",
                                "modifiers": {
                                    "mandatory": [
                                        "left_control"
                                    ]
                                }
                            },
                            "to": [
                                {
                                    "key_code": "y",
                                    "modifiers": [
                                        "left_option"
                                    ]
                                }
                            ],
                            "type": "basic"
                        } 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2012-12-27T06:01:57.163

是的，现在有一个可行的解决方案。我发现[最近的标签扩展](https://chrome.google.com/webstore/detail/recent-tabs/ocllfmhjhfmogablefmibmjcodggknml)非常适合 chrome 中的 MRU 标签解决方案。您可以使用`ctrl+Q`或`ctrl+~`分配您自己的。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2013-06-25T04:36:38.743

作为替代方案，我会提供使用 FF，在其中您必须将设置`browser.ctrlTab.previews`设置为`true`并且您具有 MRU 行为。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2015-02-13T16:42:42.867

最好按照 jason3w 的建议使用[http://bahoom.com/hyperswitch](http://bahoom.com/hyperswitch)

~~我的解决方案：~~

在 OSX 上，当我想在两个 chrome 选项卡和代码编辑器之间反复切换时，我通常希望切换 MRU。（例如，trello.com 和 localhost:3000）

在这种情况下，我启动了 chrome canary，它被 OSX 正确地视为一个单独的应用程序，并允许一个简单的 alt-tabbing（就像以前的窗口一样），SWEET！

[https://www.google.com/chrome/browser/canary.html](https://www.google.com/chrome/browser/canary.html)

~~试试看，偷看。我尝试了 Opera 解决方案，但如果没有 chrome 的其他一些功能，我就无法生存。我希望Opera继续发展。~~

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2012-07-03T16:27:30.930

~~刚刚发现这个[https://github.com/acemtp/chrome_mru](https://github.com/acemtp/chrome_mru)~~

 ~~> 它的目标是让您能够在 Google Chrome 中使用最近使用 (MRU) 选项卡行为（而不是默认的下一个/上一个选项卡）中的 CTRL+TAB。~~ 

~~到目前为止我还没有尝试过。希望能帮助到你~~

编辑原因：停止工作。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2017-11-22T13:57:49.170

在 Mac OS 上，Recent Tabs 扩展能够以某种方式重新分配 Ctrl+Tab 以在两个最近使用的开箱即用选项卡之间切换！

[https://chrome.google.com/webstore/detail/recent-tabs/ocllfmhjhfmogablefmibmjcodggknml](https://chrome.google.com/webstore/detail/recent-tabs/ocllfmhjhfmogablefmibmjcodggknml)

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2018-06-02T15:11:04.803

在 Windows 上实现这一点的棘手解决方案是结合[Quick Tabs](https://chrome.google.com/webstore/detail/quick-tabs/jnjfeinjfmenlddahdjdmgpbokiacbbb) chrome 扩展和[AutoHotkey](https://autohotkey.com/)脚本。我已经详细描述了[here](https://github.com/boika/chrome-ctrl-tab)，所以简而言之：

1) Quick Tabs 是一个[开源的](https://github.com/babyman/quick-tabs-chrome-extension)、可定制的扩展，它允许你重新定义一些 CSS 样式并允许设置热键来切换 MRU 选项卡。它还支持键盘导航（移动到下一个/上一个选项卡）。但是 chrome 不允许您将`Ctrl`+绑定`Tab`为键盘快捷键，因此您需要注册另一个（例如`Ctrl`+ `Shift`+ `S`），然后使用 AutoHotkey 脚本将`Ctrl`+ `Tab`for chrome “重新映射”为`Ctrl`+ `Shift`+ `S`。

2）我不会把AutoHotkey脚本放在这里，你可以在[这里](https://github.com/boika/chrome-ctrl-tab/blob/master/chrome-ctrl%2Btab.ahk)找到它。它涵盖`Ctrl`+`Tab`重新映射并处理所有键盘导航。

结果，当在活动 chrome 窗口中按`Ctrl`+时，您会看到类似的内容：`Tab`

[![](../Images/03e1c5cc997ccaed8f084c1dcb020f19.png)](https://i.stack.imgur.com/Bxfd6.jpg)

箭头导航，`Esc`+`Ctrl`和`Tab`++`Ctrl`都`Shift`按`Tab`您预期的方式工作。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2018-06-18T07:23:34.513

我在 mac/linux 上找到的最佳解决方法是安装一个按 MRU 顺序对选项卡进行排序的扩展*，以便 ctrl+tab 以您期望的方式工作：

[https://chrome.google.com/webstore/detail/tab-slider/nobaaibkcalggmjnjhnlmmcldllpogjp](https://chrome.google.com/webstore/detail/tab-slider/nobaaibkcalggmjnjhnlmmcldllpogjp)

**最后使用的选项卡一直移动到左侧*

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2015-11-07T16:18:49.527

> 是否有通过 CTRL+TAB 将 MRU 选项卡选择添加到 Google Chrome 的真正可行的解决方案？

是的。您需要修改您的首选项文件，如下所示：http: [//forum.ru-board.com/topic.cgi?forum=5 &topic=34987&start=4680#16](http://forum.ru-board.com/topic.cgi?forum=5&topic=34987&start=4680#16)

（将您的序列更改为 Ctrl+Tab 和 Shift+Ctrl+Tab）

Chrome 不会阻止它。由于钩子，您根本无法分配这种组合。但是如果您编辑首选项文件，它就可以工作。

它位于附近

> “C:\Users\%username%\AppData\Local\Google\Chrome\User Data\Default\Preferences”

# clojure - 判断 x 是否是 y 的倍数的函数

> ID：11093452
> 
> 赞同：3
> 
> 时间：2012-06-19T02:01:52.010
> 
> 标签：clojure

看看下面的函数。我想传递一个因子向量并测试向量中的任何元素是否是`x`. 我怎么做？

```
(defn multiple?
  "Takes a seq of factors, and returns true if x is multiple of any factor."
  ([x & factors] (for [e m] ))
  ([x factor] (= 0 (rem x factor)))) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T02:11:23.567

您可以尝试使用[`some`](http://clojuredocs.org/clojure_core/clojure.core/some)and [`map`](http://clojuredocs.org/clojure_core/clojure.core/map)：

```
(defn multiple? [x & factors]
  (some zero? (map #(rem x %) factors))) 
```

如果所有测试都失败，也会`some`返回`nil`，如果你需要它实际返回`false`，你可以放一个[`true?`](http://clojuredocs.org/clojure_core/clojure.core/true_q)：

```
(defn multiple? [x & factors]
  (true? (some zero? (map #(rem x %) factors)))) 
```

* * *

请注意，`some`短路并且`map`是惰性的，因此`multiple?`一旦找到匹配项就停止。例如，以下代码针对序列进行测试`1,2,3,4,...`。

```
=> (apply multiple? 10 (map inc (range)))
true 
```

`multiple?`显然，如果不对序列中的每个数字进行测试，这种计算只能终止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T02:34:32.810

您只能使用`some`.

```
=> (defn multiple? [x factors]
 (some #(zero? (rem x %)) factors))
#'user/multiple?
=> (= true (multiple? 10 [3 4]))
false
=> (= true (multiple? 10 [3 4 5 6]))
true 
```

`some`将停止在第一个因素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T02:14:47.017

试试这个，使用显式尾递归：

```
(defn multiple? [x factors]
  "if any of the elements in the vector is a factor of x"
  (loop [factors factors]
        (cond (empty? factors) false
              (zero?  (rem x (first factors))) true
              :else   (recur (rest factors))))) 
```

上述解决方案的优点包括：一旦发现向量中的任何元素是否是 的因子，它就会立即停止`x`，而无需遍历整个向量；由于使用尾递归，它高效且在恒定空间中运行；它直接返回一个布尔结果，不需要考虑返回的情况`nil`。像这样使用它：

```
(multiple? 10 [3 4])
=> false

(multiple? 10 [3 4 5 6])
=> true 
```

如果您想避免显式传递向量的需要（用于调用这样的过程：）`(multiple? 10 3 4 5 6)`）然后只需将 a 添加`&`到参数列表中，就像它在问题中一样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T00:35:01.320

一种更*符合 Clojurian*的方法是编写一个更通用的函数：它不会回答真/假问题，而是返回`x`. 而且因为序列是惰性的，如果你想知道它是否为空，它几乎同样有效。

```
(defn factors [x & fs]
  (for [f fs :when (zero? (rem x f))] f))

(factors 5 2 3 4)
=> ()

(factors 6 2 3 4) 
=> (2 3) 
```

那么你可以通过简单地使用来回答你原来的问题`empty?`：

```
(empty? (factors 5 2 3 4))
=> true

(empty? (factors 6 2 3 4))
=> false 
```

# ruby-on-rails - rails 3从关联表加载属性

> ID：11093453
> 
> 赞同：0
> 
> 时间：2012-06-19T02:02:06.823
> 
> 标签：ruby-on-rails

我有 3 个基本模型：用户、权限和一个名为 UserPermissions 的关联模型，因此用户`has_many :permissions, through :user_permissions`

我的用户权限表包含 user_id、permission_id 以及作为位掩码的权限属性。现在，当我向用户查询他的权限时，我会执行以下操作：

```
@permissions = user.permissions 
```

我得到了该给定用户的相关权限的一个很好的集合。我想做的是将特权字段添加到结果中，而不是这个结果

```
{
  "id": 1,
  "name": "User permissions",
  "short_name": "user_permissions"
} 
```

我需要这样的东西：

```
{
  "id": 1,
  "name": "User permissions",
  "short_name": "user_permissions",
  "privilege": "..whatever the bitmask converts to"
} 
```

我希望我说得通。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T08:38:09.757

您可以只向权限类添加一个方法来组成您的哈希。就像是

```
class Permission
    ....

    def attributes_with_privilege
        attributes.merge( 'privilege': user_permission.privilege )
    end

   ...
end 
```

# jqgrid - jqGrid多分组第2级不出现

> ID：11093456
> 
> 赞同：0
> 
> 时间：2012-06-19T02:02:48.407
> 
> 标签：jqgrid

我一直在尝试使 jqGrid 的多分组功能起作用，但我只得到第一级分组：

[![在此处输入图像描述](../Images/d16e1b49487907ebfcd1bba6687efbda.png)](https://i.stack.imgur.com/dxmtC.png)

应该还有另外一组。这是源代码：

```
$('#grdData').jqGrid({
    url: 'Default.aspx?method=GetGridData',
    datatype: 'json',
    colNames: ['Exchange', 'Market', 'Security Name', '', ''],
    colModel: [
        { name: 'exchange', index: 'exchange', width: 100, align: 'center' },
        { name: 'market', index: 'market', width: 100, align: 'center' },
        { name: 'secname', index: 'secname', width: 200 },
        { name: 'remino', index: 'remino' },
        { name: 'clino', index: 'clino' }
    ],
    rowNum: 5,
    pager: '#pgrGrid',
    sortname: 'exchange',
    viewrecords: true,
    sortorder: 'asc',
    grouping: true,
    groupingView: {
        groupField: ['remino', 'clino'],
        groupColumnShow: [false, false],
        groupText: ['<b>{0}</b>', '{0}'],
        groupCollapse: false,
        groupOrder: ['asc', 'asc'],
        groupDataSorted: true
    }
 }); 
```

clino组没有出现，我查看了响应json，觉得还可以。此外，当我将 groupColumnShow 设置为“true”、“true”时 - 两个分组列都显示在标题中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T09:59:58.017

您的数据应按“remino”和“clino”排序。然后它将起作用。

# jquery - jQuery表单提交错误

> ID：11093459
> 
> 赞同：0
> 
> 时间：2012-06-19T02:03:15.153
> 
> 标签：jquery

我有这样的表格：

```
<form method="post" action="user_submit.php" id="addUserForm">
        <p>
            <label for="username">Enter Username:*</label>
            <input type="text" name="username" id="username">
        </p>
         <p>
            <label for="firstname">Enter First Name*</label>
            <input type="text" name="firstname" id="firstname">
        </p> 
```

：

```
 <input type="hidden" name="addUser" value="1" />
        <p><input type="button" name="submit" value="submit" id="submit_AddUser" onClick="validate_addUser();" ></p> 
```

这是我使用的简单 js

```
function validate_addUser(){
    if (!$('#username').val())
        alert('Please enter Username');
    else if (!$('#firstname').val())
        alert("Please enter first name");
    else if (!$('#lastname').val())
        alert("Please enter last name");
    else if (!$('#email').val())
        alert("Please enter email address");
    else 
        $('#addUserForm').submit();

} 
```

当我提交表单时，这是我得到的错误

```
e[h] is not a function
[Break On This Error]   

...{href:function(a){return a.getAttribute("href") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T03:09:01.377

我将名称从 submit 更改为 go，它开始工作，dyaamn ！

```
<input type="button" name="go" value="go" id="gogogo" onClick="validate_addUser();" > 
```

# iphone - 如何从不同的视图切换到同一个控制器？

> ID：11093460
> 
> 赞同：0
> 
> 时间：2012-06-19T02:03:29.630
> 
> 标签：iphone, xcode, uinavigationcontroller, segue

我有一个带有几个选项卡的选项卡视图控制器。一个选项卡通过导航控制器通向“玩家”视图。第二个选项卡通向“设置”视图。设置视图有一个选择“默认”播放器的按钮，因此它尝试通过单独的导航控制器与播放器视图进行连接。

图表：

```
Players Tab -> Navigation Controller "A" -> Players View Controller
Settings Tab -> Navigation Controller "B" (w/named segue) -> Players View Controller 
```

Players 选项卡视图没有“命名”segue，因为它与选项卡控制器有关系。设置选项卡导航控制器有一个命名的 segue。

但是，现在当我选择“玩家”选项卡时，视图是空的！顶部的导航栏与选项卡一起存在，仅此而已。作为测试，我删除了从导航“B”到玩家视图的关系，现在“玩家”选项卡再次工作。

我在这里遗漏了一个基本问题，但我不知道是什么。

任何想法都值得赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T05:33:46.600

我发现了一个与我需要的答案类似的问题。

[如何在情节提要中创建 UIViewController 布局，然后在代码中使用它？](https://stackoverflow.com/questions/8111218/how-to-create-a-uiviewcontroller-layout-in-storyboard-and-then-use-it-in-code)

以下是相关代码：

```
UIViewController *viewController = [[UIStoryboard storyboardWithName:@"MainStoryboard" bundle:NULL] instantiateViewControllerWithIdentifier:@"ResultsController"];
[self presentModalViewController:viewController animated:NO]; 
```

我是故事板的新手，所以我不知道这种方法存在。这种方法解决了我上面描述的问题。我最初试图通过导航控制器转到已经建立了 segue 的视图。使用此处的解决方案，我可以使用标识符简单地实例化现有视图。

我仍然认为应该有一种方法可以尝试另一种 segue，以便可以使用“执行 segue”。然而，我又一次向前迈进了。

# django-forms - Django ModelForm：构造后如何填充初始值

> ID：11093461
> 
> 赞同：0
> 
> 时间：2012-06-19T02:03:34.377
> 
> 标签：django-forms

如何在 ModelForm 中提供初始值的问题得到了很好的回答： [Overriding initial value in ModelForm](https://stackoverflow.com/questions/2988548/overriding-initial-value-in-modelform)

但是在模型创建后我如何填充一个值呢？或者我将如何更正此代码？

```
class Entry_form(forms.ModelForm):
    class Meta:
        model = models.Entry
        exclude = ('') 
```

：

```
def entry_add(request, pk):
    form = Entry_form
    selected_text = request.GET.get('selected_text', '')
    form.fields['title'].initial = 'Test: ' + selected_text
    return render(request, 'entry_add,{'form': form}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T09:46:43.160

您的代码中有一些错误。

1.  删除行：

    `exclude = ('')`

    `('')`是一个空字符串，而不是一个空元组。

2.  `form = Entry_form`应该`form = Entry_form()`

3.  `return render(request, 'entry_add,{'form': form})`- 缺少结束语。

该行：

```
form.fields['title'].initial = 'Test: ' + selected_text 
```

是正确的，应该工作。

另一种方法是：

```
form.initial['title'] = 'Test: ' + selected_text 
```

# css - 为什么只有在我将属性 display 分配给 CSS 声明时才会出现精灵图像？

> ID：11093464
> 
> 赞同：0
> 
> 时间：2012-06-19T02:04:03.197
> 
> 标签：css, css-sprites

我有以下代码

```
a.rollover {
        background-image: url('sprite.jpg');
        display: block;
        width: 191px;
        height: 143px;
    } 
```

但是，仅当我包含该属性`display`并将其设置为`block`. 如果我删除它，它不会出现。这是为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T02:10:23.017

`<a>`默认情况`display:inline`下，宽度/高度不适用于内联元素。您可以使用`display:inline-block`允许调整大小并仍然保持内联。

# c# - 数据未出现在数据网格 Kinect c#

> ID：11093467
> 
> 赞同：0
> 
> 时间：2012-06-19T02:04:46.070
> 
> 标签：c#, kinect

我编写了以下代码来显示一些数据，但数据网格只是显示为空，这是我的代码：

```
 DataTable dt = new DataTable();
                    DataColumn col = new DataColumn("A", typeof(string));
                    col.MaxLength = 100;
                    dt.Columns.Add(col);
                    col = new DataColumn("B", typeof(string));
                    col.MaxLength = 100;
                    dt.Columns.Add(col);
                    DataRow row = dt.NewRow();
                    dt.Rows.Add(x,y);
                    dataGrid1.ItemsSource = dt.DefaultView; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T02:20:04.397

您`AutoGenerateColumns="True"` 的 DataGrid 声明中有吗？例如

```
<sdk:DataGrid x:Name="dataGrid1" 
    Height="140" Margin="0,5,0,10"
    AutoGenerateColumns="True" /> 
```

要更精确地控制列定义，请添加一个`DataGrid.Columns`元素：

```
<toolkit:DataGrid x:Name="TheDataGrid"  
                          AutoGenerateColumns="False"> 
    <toolkit:DataGrid.Columns>         
        <toolkit:DataGridTextColumn Header="Contact Name" Width="SizeToCells"   
                                       Binding="{Binding ContactName}"  
                                       IsReadOnly="False"/> 

        ... more columns
    </toolkit:DataGrid.Columns> 
</toolkit:DataGrid> 
```

# pde - NDSolve 没有更多内存

> ID：11093469
> 
> 赞同：1
> 
> 时间：2012-06-19T02:05:26.027
> 
> 标签：pde

我正在求解一个非线性偏微分方程，我必须应用非常小的步长，因为我正在处理一种物理现象。但是当我减小步长并且即使我使用 MaxSteps 时，我仍然会得到错误`no more memory for NDSolve`。

这是我的程序：

```
a = 0.05; b = 0.5; L = 20; T = 6 \[Pi]; h = 4;
NDSolve[{b*D[u[t, x], t, t] + a*D[u[t, x], t] == 
   D[u[t, x], x, x] - Sin[u[t, x]], u[0, x] == 0, 
  Derivative[1, 0][u][0, x] == 0, 
  Derivative[0, 1][u][t, 0] == h*Sin[t], 
  Derivative[0, 1][u][t, L] == 0}, u, {t, 0, T}, {x, 0, L}, 
 MaxStepSize -> 0.0001, MaxSteps -> 10^6] 
```

# javascript - 如何在加载 jQuery 之前将回调加入队列？

> ID：11093471
> 
> 赞同：0
> 
> 时间：2012-06-19T02:05:26.467
> 
> 标签：javascript, jquery

我切换到在应用程序中使用 Require.JS 并立即遇到了这个问题：

一旦加载了 DOM 的某些部分，我曾经使用内联 JS 来启动某些调用。现在显然 jQuery 仅在执行这些调用后才加载，从而导致错误，因为 jQuery ($) 未定义。

在加载之前为 jQuery 排队回调的最佳方法是什么？如果 jQuery 已经加载，我需要它们立即触发，或者一旦加载就立即触发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T04:00:08.653

这就是我所做的

```
var _DomReadyCallback = _DomReadyCallback || [];

_DomReadyCallback.push(function() {
    alert('Jquery Loaded');
}); 
```

加载 jQuery 后，循环遍历数组并调用所有回调

```
// This code should come after jQuery is loaded (add it on the jQuery onload callback or append it at the end of the jQuery file)
$(function(){
    for (var cb in _DomReadyCallback) {
        cb.call();
    }
}); 
```

或者

```
requirejs(['jquery'], function   ($) {
    for (var cb in _DomReadyCallback) {
        cb.call();
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T03:05:19.953

您选择了两种相互不兼容的脚本技术：

1.  延迟加载 jQuery
2.  加载 DOM 时对 jQuery 的内联调用

你根本不能同时做这两个。如果您确实需要以延迟方式加载 jQuery，那么您还必须延迟使用 jQuery，直到加载 jQuery。Requires.js 有一个可选的回调，可以让你知道 jQuery 何时加载。此时，您可以运行其他初始化 jQuery 代码。

如果你想尽可能多地保留这两个，你可以让每个内联 JS 将一个回调注册到一个回调数组中，然后创建一个函数，在加载 jQuery 时执行所有这些回调。如果您要完成的工作值得这么多麻烦，我会感到有些惊讶。

我建议，如果您希望内联 javascript 尽快执行，那么要么使其独立于 jQuery（因此它可以随时运行），要么停止延迟 jQuery 的加载，以便它可以用作您的 DOM 加载。

# c - mingw 的 C 分析器

> ID：11093474
> 
> 赞同：2
> 
> 时间：2012-06-19T02:05:39.140
> 
> 标签：c, windows-7, mingw, profiler

我正在寻找一个好的 c 分析器，它在 windows 7 下的 mingw 环境中支持多线程。我主要对 CPU 处理时间感兴趣。我使用的处理器是 AMD。

# ios - 在 iOS 上的 OpenGL ES 2.0 中从片段着色器访问多个纹理

> ID：11093486
> 
> 赞同：0
> 
> 时间：2012-06-19T02:07:51.350
> 
> 标签：ios, opengl-es

我的应用中有 N 个纹理，它们是来自 3D 体积数据的 2D 切片。在片段着色器中，我需要访问所有这些纹理。我的理解是我只能从着色器访问绑定纹理，这意味着我受到允许的多纹理单元数量的限制。

N 可以在 8 到 512 之间变化，具体取决于数据。有没有办法在没有多重纹理的情况下做到这一点？

采用这种方法的原因是 3D 纹理在 OpenGL ES 2.0 上不可用。我会很感激有关任何其他方式的建议。

我也考虑过纹理图集，但我认为最大单个纹理尺寸将是一个问题。

# regex - 将字符串中的第一个单词大写的最快方法（base）

> ID：11093488
> 
> 赞同：4
> 
> 时间：2012-06-19T02:08:09.737
> 
> 标签：regex, r

使用基本安装函数将文本字符串向量中的第一个字母大写的最快方法是什么？

我在下面提供了一个解决方案，但它似乎是一种非常低效的方法（使用子字符串并将它们全部粘贴在一起）。我猜有一个我没有想到的正则表达式解决方案。

一旦我有一些响应，我将对它们进行基准测试并使用微基准测试报告最快的解决方案。

预先感谢您的帮助。

```
x <- c("i like chicken.", "mmh so good", NA)
#desired output
[1] "I like chicken." "Mmh so good"     NA 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T02:22:14.333

我没有计时，但我敢打赌这很快

```
capitalize <- function(string) {
    #substring(string, 1, 1) <- toupper(substring(string, 1, 1))
    substr(string, 1, 1) <- toupper(substr(string, 1, 1))
    string
}
capitalize(x)
#[1] "I like chicken." "Mmh so good"     NA 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-19T02:34:35.153

我认为这将是最慢的，但让它与其他解决方案竞争：

```
capitalize<-function(string) {
   sub("^(.)","\\U\\1", string, perl=TRUE )
}  

x <- c("i like chicken.", "mmh so good", NA)
capitalize(x) 
```

编辑：实际上在[ideone](http://ideone.com/5hbtX)上它比子字符串快

编辑 2：匹配任何小写字母会稍微慢一些：

```
sub("^(\\p{Ll})","\\U\\1", string, perl=TRUE) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-19T03:05:48.867

该`Hmisc`包包含一个[`capitalize`](http://svitsrv25.epfl.ch/R-doc/library/Hmisc/html/capitalize.html)功能：

```
> require(Hmisc)
> capitalize(c("i like chicken.", "mmh so good", NA))
[1] "I like chicken." "Mmh so good"     NA 
```

（尽管这似乎比`substring`正则表达式版本慢。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-19T02:09:10.437

我使用子字符串的解决方案：

```
capitalize <- function(string) {
    cap <-  function(x) {
        if (is.na(x)) {
            NA
        }
        else {
            nc <- nchar(x)
            paste0(toupper(substr(x, 1, 1)), substr(x, 
              2, nc))
        }
    }
    sapply(string, cap, USE.NAMES = FALSE) 
}

x <- c("i like chicken.", "mmh so good", NA)
capitalize(x) 
```

# c# - 正则表达式需要太长时间才能失败，如果没有匹配

> ID：11093489
> 
> 赞同：0
> 
> 时间：2012-06-19T02:08:18.380
> 
> 标签：c#, regex, parsing

我有以下正则表达式字符串和下面的文本字符串。我有多个节点，我使用`streamstreader`. 之后，我尝试使用`regex.match()`匹配字符串进行匹配，当匹配时，即使有许多节点，它的运行速度也非常快。当没有匹配时，该`regex.match()`方法永远不会停止。

当字符串不匹配时，我的问题是，我只想捕获一个异常。例如，在下面的数据节点中，我们说某些字段完全丢失，在这种情况下我可以捕获异常，问题是如果节点格式不同，如何停止匹配例程？

```
string pat = @"TEST_REPLICATE\s*{\s*REPLICATE_ID\s*([^}]*?)\s+ASSAY_NUMBER\s*([^}]*?)\s+ASSAY_VERSION\s*([^}]*?)\s+DILUTION_ID\s*([^}]*?)\s+SAMPLE_ID\s*([^}]*?)\s+SAMPLE_TYPE\s*([^}]*?)\s+TEST_ORDER_DATE\s*([^}]*?)\s+TEST_ORDER_TIME\s*([^}]*?)\s+TEST_INITIATION_DATE\s*([^}]*?)\s+TEST_INITIATION_TIME\s*([^}]*?)\s+TEST_COMPLETION_DATE\s*([^}]*?)\s+TEST_COMPLETION_TIME\s*([^}]*?)\s+ASSAY_CALIBRATION_DATE\s*([^}]*?)\s+ASSAY_CALIBRATION_TIME\s*([^}]*?)\s+TRACK\s*([^}]*?)\s+PROCESSING_LANE\s*([^}]*?)\s+MODULE_SN\s*([^}]*?)\s+LOAD_LIST_NAME\s*([^}]*?)\s+OPERATOR_ID\s*([^}]*?)\s+DARK_SUBREADS\s*([^}]*?)\s+SIGNAL_SUBREADS\s*([^}]*?)\s+DARK_COUNT\s*([^}]*?)\s+SIGNAL_COUNT\s*([^}]*?)\s+CORRECTED_COUNT\s*([^}]*?)\s+STD_BAK\s*([^}]*?)\s+AVG_BAK\s*([^}]*?)\s+STD_FOR\s*([^}]*?)\s+AVG_FOR\s*([^}]*?)\s+SHAPE\s*([^}]*?)\s+EXCEPTION_STRING\s*([^}]*?)\s+RESULT\s*([^}]*?)\s+REPORTED_RESULT\s*([^}]*?)\s+REPORTED_RESULT_UNITS\s*([^}]*?)\s+REAGENT_MASTER_LOT\s*([^}]*?)\s+REAGENT_SERIAL_NUMBER\s*([^}]*?)\s+RESULT_FLAGS\s*([^}]*?)\s+RESULT_INTERPRETATION\s*([^}]*?)\s+DILUTION_PROTOCOL\s*([^}]*?)\s+RESULT_COMMENT\s*([^}]*?)\s+DATA_MANAGEMENT_FIELD_1\s*([^}]*?)\s+DATA_MANAGEMENT_FIELD_2\s*([^}]*?)\s+DATA_MANAGEMENT_FIELD_3\s*([^}]*?)\s+DATA_MANAGEMENT_FIELD_4\s*([^}]*?)\s*}";  

    TEST_REPLICATE
    {
        REPLICATE_ID            353
        ASSAY_NUMBER            34224
        ASSAY_VERSION           99
        ASSAY_STATUS            VALKID
        DILUTION_ID         1
        SAMPLE_ID           "NC_3e2e2"
        SAMPLE_TYPE         Specimen
        TEST_ORDER_DATE         05.21.2012
        TEST_ORDER_TIME         03:44:01
        TEST_INITIATION_DATE        05.21.2012
        TEST_INITIATION_TIME        04:03:36
        TEST_COMPLETION_DATE        05.21.2012
        TEST_COMPLETION_TIME        04:29:32
        ASSAY_CALIBRATION_DATE      NA
        ASSAY_CALIBRATION_TIME      NA
        TRACK           1
        PROCESSING_LANE     1
        MODULE_SN       "EP334545004"
        LOAD_LIST_NAME          C:\BSQ_SASDACC\ASDADAjson
        OPERATOR_ID         "Q_SI"
        DARK_SUBREADS           NA
        SIGNAL_SUBREADS         NA
        DARK_COUNT          NA
        SIGNAL_COUNT            NA
        CORRECTED_COUNT         NA
        STD_BAK             NA
        AVG_BAK             NA
        STD_FOR             NA
        AVG_FOR             NA
        SHAPE               NA
        EXCEPTION_STRING        Test execution was stopped.
        RESULT              NA
        REPORTED_RESULT         NA
        REPORTED_RESULT_UNITS       NA
        REAGENT_MASTER_LOT      ASDADA
        REAGENT_SERIAL_NUMBER       25022
        RESULT_FLAGS            NA
        RESULT_INTERPRETATION       NA
        DILUTION_PROTOCOL       ASDASD
        RESULT_COMMENT          ASDA ASDA1
        DATA_MANAGEMENT_FIELD_1     NA
        DATA_MANAGEMENT_FIELD_2     NA
        DATA_MANAGEMENT_FIELD_3     NA
        DATA_MANAGEMENT_FIELD_4     NA
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T06:47:59.710

三件事：

1.  如果您编写这样的正则表达式，请使用选项`RegexOptions.IgnorePatternWhitespace`，它允许您在正则表达式中使用空格以使其更具可读性。这个空格不匹配！如果要匹配空格，则必须对其进行转义`\`或使用`\s`（您已经在做的事情）。

2.  你不在`.`你的模式中使用 a ，所以不需要`RegexOptions.Singleline`. 此选项正在更改特殊字符的行为`.`，如果您不使用它，则不需要该选项。

3.  如果您的模式失败，因为缺少某些关键字，您的正则表达式有一些使用 匹配的可能性`[^}]*?`，我会缩小范围以使用`\S*`，`\S`匹配非空白字符（适用于您的示例，我看不到空格您要提取的数据），因此您的正则表达式应该会更快地失败。

    **更新：**我的错误，您的示例在某些时候有空格。然后我会`\S*`用`.*?`. 由于我没有使用 Singleline 选项，因此这也不会匹配换行符，并且因为我使它变得不贪心，所以它不会在行尾包含空格。

    如果您可以选择缩小模式，这会更好。例如，如果您知道一个值只能是数字，则仅匹配`\d+`.

试试这个模式：

```
Regex r = new Regex(@"TEST_REPLICATE\s*
                         {\s*
                         REPLICATE_ID\s*(\S*)\s+
                         ASSAY_NUMBER\s*(\S*)\s+
                         ASSAY_VERSION\s*(\S*)\s+
                         DILUTION_ID\s*(\S*)\s+
                         SAMPLE_ID\s*(\S*)\s+
                         SAMPLE_TYPE\s*(\S*)\s+
                         TEST_ORDER_DATE\s*(\S*)\s+
                         TEST_ORDER_TIME\s*(\S*)\s+
                         TEST_INITIATION_DATE\s*(\S*)\s+
                         TEST_INITIATION_TIME\s*(\S*)\s+
                         TEST_COMPLETION_DATE\s*(\S*)\s+
                         TEST_COMPLETION_TIME\s*(\S*)\s+
                         ASSAY_CALIBRATION_DATE\s*(\S*)\s+
                         ASSAY_CALIBRATION_TIME\s*(\S*)\s+
                         TRACK\s*(\S*)\s+
                         PROCESSING_LANE\s*(\S*)\s+
                         MODULE_SN\s*(\S*)\s+
                         LOAD_LIST_NAME\s*(\S*)\s+
                         OPERATOR_ID\s*(\S*)\s+
                         DARK_SUBREADS\s*(\S*)\s+
                         SIGNAL_SUBREADS\s*(\S*)\s+
                         DARK_COUNT\s*(\S*)\s+
                         SIGNAL_COUNT\s*(\S*)\s+
                         CORRECTED_COUNT\s*(\S*)\s+
                         STD_BAK\s*(\S*)\s+
                         AVG_BAK\s*(\S*)\s+
                         STD_FOR\s*(\S*)\s+
                         AVG_FOR\s*(\S*)\s+
                         SHAPE\s*(\S*)\s+
                         EXCEPTION_STRING\s*(\S*)\s+
                         RESULT\s*(\S*)\s+
                         REPORTED_RESULT\s*(\S*)\s+
                         REPORTED_RESULT_UNITS\s*(\S*)\s+
                         REAGENT_MASTER_LOT\s*(\S*)\s+
                         REAGENT_SERIAL_NUMBER\s*(\S*)\s+
                         RESULT_FLAGS\s*(\S*)\s+
                         RESULT_INTERPRETATION\s*(\S*)\s+
                         DILUTION_PROTOCOL\s*(\S*)\s+
                         RESULT_COMMENT\s*(\S*)\s+
                         DATA_MANAGEMENT_FIELD_1\s*(\S*)\s+
                         DATA_MANAGEMENT_FIELD_2\s*(\S*)\s+
                         DATA_MANAGEMENT_FIELD_3\s*(\S*)\s+
                         DATA_MANAGEMENT_FIELD_4\s*(\S*)\s*
                         }"
     , RegexOptions.IgnorePatternWhitespace | RegexOptions.IgnoreCase); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T02:27:45.610

> 您可以通过检查返回的 Match 对象的 Success 属性的值来确定是否在输入字符串中找到了正则表达式模式。如果匹配成功，则返回的 Match 对象的 Value 属性包含输入中与正则表达式模式匹配的子字符串。如果未找到匹配项，则其值为 String.Empty。

来自[http://msdn.microsoft.com/en-us/library/0z2heewz.aspx](http://msdn.microsoft.com/en-us/library/0z2heewz.aspx)

当我使用您提供的值测试以下内容时，成功返回 true。如果我将您的文本更改为不匹配的格式，它会按预期返回 false。

```
var found = Regex.Match(inputString, pat).Success 
```

# eclipse - 导入 com.google.ads.*；没有 AdManager

> ID：11093492
> 
> 赞同：1
> 
> 时间：2012-06-19T02:08:50.553
> 
> 标签：eclipse, cordova, admob, google-ad-manager

我真的被困在这里，试图在我的 android 应用程序中设置一个带有 ads-admob 的横幅。我已经完成了 main.xml 中的所有布局设置，还在清单文件中使用了权限，尝试了 XML 和 JAVA 方法来显示广告并试图使其工作，但我总是从“无法获取 currentAdManager” Eclipse 中的 logcat。该应用程序也在这里崩溃，但没有 admob 设置也能正常工作。我的 admob SDK 是 GoogleAdMobAdsSdk-6.0.1.jar，我正在使用 phonegap 进行开发。

我注意到命令“import com.google.ads.*;” 没有“AdManager”，因为当我单独插入“import com.google.ads.AdManager;”时，我收到错误消息“无法解析导入 com.google.ads.AdManager”。我的文件：

**我的爪哇：**

```
>     package what.car.notes;
>     
>     import android.os.Bundle;
>     import org.apache.cordova.*;
>     import com.google.ads.AdView;
>     import com.google.ads.AdManager; **- ERROR APEARS HERE**
>     import com.google.ads.*;
>     
>     public class Cargeous21forActivity extends DroidGap {
>         /** Called when the activity is first created. */
>         @Override
>         public void onCreate(Bundle savedInstanceState) {
>             super.onCreate(savedInstanceState);
>             super.loadUrl("file:///android_asset/www/index.html");
>             setContentView(R.layout.main);
>             
>             dView adView = (AdView)this.findViewById(R.id.AdView);
>       adView.loadAd(new AdRequest());
>         }
>     } 
```

**我的布局文件（main.xml）：**

```
>     <?xml version="1.0" encoding="utf-8"?>
>     
>     <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
>         xmlns:myapp="http://schemas.android.com/apk/res/what.car.notes"
>       android:layout_width="fill_parent"
>         android:layout_height="fill_parent"
>         android:orientation="vertical">
>         
>     <com.admob.android.ads.AdView
>     android:id="@+id/AdView"
>     android:layout_width="fill_parent"
>     android:layout_height="wrap_content"
>     myapp:backgroundColor="#000000"
>     myapp:primaryTextColor="#FFFFFF"
>     myapp:secondaryTextColor="#CCCCCC"
>     /> 
>     
>     </LinearLayout> 
```

**我的清单：**

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="what.car.notes"
android:versionCode="4"
android:versionName="1.3" >

<uses-sdk android:minSdkVersion="7" />
<uses-library
    android:name="com.google.ads.AdManager" />

<supports-screens 
android:largeScreens="true" 
android:normalScreens="true" 
android:smallScreens="true" 
android:resizeable="true" 
android:anyDensity="true" />
<uses-permission android:name="android.permission.CAMERA" />
<uses-permission android:name="android.permission.VIBRATE" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_LOCATION_EXTRA_COMMANDS" />
<uses-permission android:name="android.permission.READ_PHONE_STATE" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /> 
<uses-permission android:name="android.permission.BROADCAST_STICKY" />

<application
    android:icon="@drawable/icon"
    android:label="@string/app_name" >

        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>

<meta-data android:value="i've put my correct id here" android:name="ADMOB_PUBLISHER_ID" />

<activity android:name="com.admob.android.ads.AdMobActivity"
android:theme="@android:style/Theme.NoTitleBar.Fullscreen"
android:configChanges="orientation|keyboard|keyboardHidden"
                android:value="SQLite-NDK"  />
        <!-- Track Market installs -->
<receiver android:name="com.admob.android.ads.analytics.InstallReceiver"
android:exported="true">
<intent-filter>
<action android:name="com.android.vending.INSTALL_REFERRER" />
</intent-filter>
</receiver>
</application>
<uses-permission android:name="android.permission.INTERNET" />
</manifest> 
```

最后是 attrs.xml：

```
> <?xml version="1.0" encoding="utf-8"?> <resources> <declare-styleable
> name="com.admob.android.ads.AdView"> <attr name="backgroundColor"
> format="color" /> <attr name="primaryTextColor" format="color" />
> <attr name="secondaryTextColor" format="color" /> <attr
> name="keywords" format="string" /> <attr name="refreshInterval"
> format="integer" /> </declare-styleable> </resources> 
```

有没有人已经经历过这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T18:53:32.160

请阅读Android 上的 Google AdMob SDK[入门](https://developers.google.com/mobile-ads-sdk/docs/android/banner_xml)指南。您从中获取该代码的示例来自 Google AdMob 广告 SDK 重写之前的旧 Google 广告 SDK。

我在第一次通过时可以看到的问题：

1.  您是清单的活动定义不正确。有关正确的 AdActivity 活动定义，请参阅[此页面](https://developers.google.com/mobile-ads-sdk/docs/android/fundamentals#incorporating)。
2.  您不需要 attrs.xml。SDK 现在包含这些属性。
3.  我不认为发布者 ID 可以是元数据。您必须在 AdView XML 定义中指定发布商 ID。
4.  您的 AdView XML 定义需要有一个 adSize。
5.  新的 Google AdMob SDK 没有 com.google.ads.AdManager 类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T01:20:37.917

谢谢埃里克！您的回答帮助我找到了正确的代码。最终代码如下所示：

爪哇：

```
 import android.os.Bundle;
import org.apache.cordova.*;
import android.app.Activity;
import android.os.Handler;
import com.google.ads.*;
import android.widget.*;
import android.widget.LinearLayout; 

public class myactActivity extends DroidGap {

     private static final String MY_AD_UNIT_ID = "a14fd7e04e46295"; 
     private AdView adView; 
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        super.loadUrl("file:///android_asset/www/index.html");

        //
     // Create the adView 
        adView = new AdView(this, AdSize.BANNER, MY_AD_UNIT_ID); 
        LinearLayout layout = super.root; // this is the only change from the sample 
        // Add the adView to it 
        layout.addView(adView); 
        // Initiate a generic request to load it with an ad 
        adView.loadAd(new AdRequest()); 

    }    
    } 
```

我的布局：

```
 <?xml version="1.0" encoding="utf-8"?>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical">

        <TextView
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="@string/hello" />

<com.google.ads.GoogleAdView
    android:id="@+id/adView"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"  
    ads:adUnitId="xxxxxxxxxxxxxxxxxxxx" 
    ads:adSize="BANNER"
    ads:loadAdOnCreate="true"/> 

</LinearLayout> 
```

从那时起，一切都起作用了……但是！是的，有一个但是... 2 天后，由于令人难以置信的 0,00 美元和 150 个广告征集，admob/google 取消了我的帐户！我听说他们的方法很奇怪，并且无缘无故地删除了开发人员，并且以 0.00 美元和 150 次观看，他们将我从他们的程序中删除。好的部分：我发现其他一些广告服务比 admob 更好，但缺点是我必须重新找出代码......

无论如何，谢谢埃里克！

# xcode - 从 Cocoa 发送 HTTP GET 和 POST

> ID：11093496
> 
> 赞同：1
> 
> 时间：2012-06-19T02:09:10.923
> 
> 标签：xcode, cocoa, cocoahttpserver

我有一个事件示例：“http://localhost:8800/broker/event?topic=topic1&clientID=user&_method=POST¶m1=a¶m2=b”

我有一个按钮，它应该创建该 POST 请求，就像在浏览器上访问该 Web 链接一样。我尝试关注此链接[http://deusty.blogspot.ca/2006/11/sending-http-get-and-post-from-cocoa.html](http://deusty.blogspot.ca/2006/11/sending-http-get-and-post-from-cocoa.html)，但我做不到。我还想继续“倾听”并使用 GET 方法获取事件。

任何人都可以帮助我吗？

谢谢。

# ruby-on-rails - Restful Rails 使用嵌套路由创建动作渲染

> ID：11093501
> 
> 赞同：0
> 
> 时间：2012-06-19T02:09:27.870
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个网站，其中一张票有很多回复

该页面的 URL 是 /ticket/x/replies/new got to by

```
= link_to("Add a Reply", new_ticket_reply_url(@ticket)) 
```

这很好用。这当然会转到回复控制器。在控制器中，当@reply.save 出现错误时，我们有

```
format.html {render :action => "new" } 
```

这只是在回复控制器中调用 new ，而不考虑票证。任何人都可以解释（最佳实践）如何在使用嵌套路由时对错误进行正确渲染？

这是标准 rails 3.2 生成的代码，我正在尝试用我有限的知识来工作 谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T02:38:15.523

您将以相同的方式进行渲染，但您需要从参数中取出票证。

```
def new
  @ticket = Ticket.find(params[:ticket_id])
  @reply = Reply.new
end 
```

# php - 根据月份将内容加载到 div

> ID：11093503
> 
> 赞同：0
> 
> 时间：2012-06-19T02:09:38.770
> 
> 标签：php, javascript, jquery

我需要加载用户定义的特定月份的内容。如果用户选择 7 月份，则会显示 7 月份的事件列表（本例中的内容）。如果用户选择六月，则会显示所有六月事件。现在，我有一个脚本设置为用户单击“下一个”链接以切换月份。一次只显示月份。当用户单击“下一个”链接时，我希望加载下个月的所有内容。例如，如果用户在 6 月份并且他们点击下一个，则将显示 7 月份以及所有 7 月份的事件。要加载我正在使用的新事件：

```
window.location = "/<?php echo $site_slug; ?>/ministries/events/<?php echo $_GET['year']; ?>/<?php echo $_GET['month']; ?>; 
```

当用户单击“下一步”按钮时调用它。$_GET['year'] 和 $_GET['month'} 变量由 API 填充。当我点击下一个按钮时，我没有得到“年”和“月”的值，而只是一个标签。我的问题是，javascript 语法是否正确？

编辑：添加了更多代码：

查询：

```
 <script type="text/javascript">
        $('document').ready(function(){
            $(".event_months li:nth-child(3)").addClass("doShow");

            $("a.next").click(function() {
                $('.first').toggleClass("first");
                var $toHighlight = $('.doShow').next().length > 0 ? $('.doShow').next() : $('.event_months li').first();
                $('.doShow').removeClass('doShow');
                $toHighlight.addClass('doShow');
                window.location = "/<?php echo $site_slug; ?>/ministries/events/<?php echo $_GET['year']; ?>/<?php echo $_GET['month']; ?>;

            });

          });
     </script> 
```

不确定 API 调用是否会有所帮助，但它是：

```
<?php getContent(
    "event",
    "display:list", 
    "order:recent",
    "find_group:".$site_slug,
    "groupby:month",
    "year:".$_GET['year'], 
    "month:".$_GET['month'],
    "group_show:<li class='noShow'>__slug__</li>"
    ); 
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T13:34:07.013

我像你一样设置了你的代码（我不得不猜测“下一个”链接），但无法让它工作。据我所知，问题在于您正在使用`$_GET`从 URL 获取年份和月份变量。使用`$_REQUEST`, 代替：

```
<a class="next" href="/?year=2012&month=06" onclick="return false;">Next</a> 
```

如果您想使用 window.location 行，您还需要“return false”来阻止链接跟随。

不要忘记（就像你提到的那样）确保你的 window.location 有一个右括号。

# ios - 根据文本输入更改 UIKeyboardType

> ID：11093504
> 
> 赞同：8
> 
> 时间：2012-06-19T02:09:51.197
> 
> 标签：ios, apostrophe, uikeyboardtype

当用户键入空格时，我试图将 UIKeyboardType 更改为字母键盘，以反映键入撇号的效果。但是，我的代码不会改变键盘的外观，直到用户关闭键盘然后再将它带回来。

编辑：为了澄清，键盘类型以 UIKeyboardTypeNumbersAndPunctuation 开头，我想更改为 ASCIICapable，因为典型的用户输入是“#cups 面粉”的形式。我意识到 ASCIICapable 键盘内置了此功能，因此展示支持 ASCII 的键盘但首先显示数字/标点符号会起作用。

这是我的代码：

```
- (BOOL) textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{

    if ([string isEqualToString:@" "]) {
        textField.keyboardType = UIKeyboardTypeASCIICapable;
    }

return YES;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-19T02:26:14.000

关闭键盘，然后再次成为第一响应者。在我的代码中，我为文本字段 *tf 创建了一个 IBOutlet。有效。

```
- (BOOL) textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{

    if ([string isEqualToString:@" "]) {
        self.tf.keyboardType = UIKeyboardTypeNumberPad;
        [textField resignFirstResponder];
        [self.tf becomeFirstResponder];
    }

    return YES;
} 
```

# c# - mailitem 附件未显示在 mailitem 上

> ID：11093517
> 
> 赞同：0
> 
> 时间：2012-06-19T02:12:06.190
> 
> 标签：c#, outlook, mailitem

我在以编程方式创建带有附件的 Outlook 邮件项时遇到问题，如下代码

```
Outlook.MailItem mail =
                outlook.Application.CreateItem
                (Outlook.OlItemType.olMailItem)
                as Outlook.MailItem; 
 mail.AttachmentAdd.Add(GetTempDir() + "345325.html", Outlook.OlAttachmentType.olByValue,1, Type.Missing);
 mail.Display(true); 
```

但是当实际打开邮件时，没有显示附件，即使从邮件大小我们可以识别出附件已添加

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T02:48:51.567

好的，我想我得到了答案，我们必须确保 mailItem.body 不为 null 并且位置为 1。它有效

# php - 请调试 MySQL 语法中的错误

> ID：11093519
> 
> 赞同：0
> 
> 时间：2012-06-19T02:12:09.013
> 
> 标签：php, mysql, sql, syntax

任何想法我做错了什么？？？

```
INSERT INTO LondonFixes ('id', 'Metal', 'AmPm', 'GBP', 'USD', 'EUR', 'Updated')VALUES(NULL, 'Gold', 'AM', '1055.91', '1646.00', '1272.03', '2012-06-19') 
```

给出以下错误：

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''id', 'Metal', 'AmPm', 'GBP', 'USD', 'EUR', 'Updated')VALUES(NULL, 'Gold', 'AM',' at line 1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T02:13:17.670

```
 INSERT INTO LondonFixes (id, Meta, AmPm, GBP, USD, EUR, Updated)
 VALUES(NULL, 'Gold', 'AM', '1055.91', '1646.00', '1272.03', '2012-06-19') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T02:21:38.717

在 MySQL 中，如果要转义列名，请不要使用`single quote`，而是使用`backtick`.

```
INSERT INTO LondonFixes (`id`, `Metal`, `AmPm`, `GBP`, `USD`, `EUR`, `Updated`)
VALUES(NULL, 'Gold', 'AM', '1055.91', '1646.00', '1272.03', '2012-06-19') 
```

# c# - 使用没有引用的表单动态分配事件

> ID：11093520
> 
> 赞同：0
> 
> 时间：2012-06-19T02:12:35.233
> 
> 标签：c#, vb.net, winforms

我有一个类，我在其中传递了一个面板引用，然后在该面板中我需要绘制多个其他代表我的对象的面板。问题是，当我将动态单击事件绑定到这些面板时，我没有引用要在单击事件上弹出的表单。

这种结构的原因是我可以动态地重绘我的类并将某些事件重新附加到每个对象。

有没有办法在不将我的类逻辑移到程序集之外的情况下做到这一点，或者有没有办法将我的点击事件附加到一段代码逻辑到我的 WinForm 中的子程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T02:34:28.597

如果您引用了 a 上的任何控件，`Form`则可以递归地向上导航该`Parent`属性，直到您点击`Form`. 只需测试父属性的类型是否可以分配给 type 的变量`Form`。

# php - 为什么 jQuery POST 使用 UTF-16 格式？

> ID：11093523
> 
> 赞同：1
> 
> 时间：2012-06-19T02:12:53.367
> 
> 标签：php, jquery, ajax, utf-8

我的博客软件[LightBlog](http://code.google.com/p/lightblog)的博客文章创建页面使用 jQuery 通过 AJAX 发布内容。奇怪的是，当我通过 jQuery 提交中文字符（中文）时，它会以 UTF-16 格式将其发送到服务器。当我禁用 jQuery AJAX 并使用 Firefox 发布它时，它会以 UTF-8 发送它，就像它应该的那样。

检查 Firebug，jQuery 发送这个：`%u4E2D%u6587`，这显然是 URL 编码的 UTF-16。Firefox 发送这个：`%E4%B8%AD%E6%96%87`，这绝对是 URL 编码的 UTF-8。

jQuery 声称按照 W3 规范以 UTF-8 发布，那么为什么它以 UTF-16 发送？

有问题的jQuery代码：

```
$('#create').submit(function() {
    var inputs = [];
    $('.cf', this).each(function() {
        inputs.push(this.name + '=' + escape(this.value));
    })
    jQuery.ajax({
        data: inputs.join('&'),
        type: "POST",
        url: this.getAttribute('action'),
        contentType: "application/x-www-form-urlencoded;charset=UTF-8",
        timeout: 2000,
        success: function(json) {
            var r = jQuery.parseJSON(json);
            alert(r.result);
        }
    })
    return false;
}) 
```

相关的 PHP 代码（如果有人需要）`if`位于此文件的第一个条件中：[http ://code.google.com/p/lightblog/source/browse/trunk/Sources/ProcessAJAX.php?r=521](http://code.google.com/p/lightblog/source/browse/trunk/Sources/ProcessAJAX.php?r=521)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T07:35:59.200

UTF-16 是从 中返回的`escape(this.value)`，与 jQuery 无关。

尝试`escape("中文")`在控制台中运行。

您应该使用`encodeURIComponent()`似乎生成您期望的字符串（“%E4%B8%AD%E6%96%87”），

**或者**

让 jQuery 通过将数据作为散列而不是字符串传递来完成所有编码部分。

**... 或者**

不要手动创建数据，而是尝试使用`$(".cf").serialize()`或`$(".cf").serializeArray()`获取 POST 字符串/数据数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T02:20:51.023

尝试将内容类型设置为`UTF-8`.

```
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
```

# c - 竞争条件场景

> ID：11093524
> 
> 赞同：3
> 
> 时间：2012-06-19T02:13:16.513
> 
> 标签：c, concurrency, parallel-processing

我有一个关于比赛条件场景的问题。问题：

> 考虑以下两个线程，它们在共享内存中同时运行（所有变量在两个线程之间共享）。

```
Thread A 
for i = 1 to 5 do 
  x = x + 1;

Thread B 
for j = 1 to 5 do
  x = x + 1; 
```

> 假设一个单处理器系统，加载和存储是原子的，x 初始化为 0，x 必须在递增之前加载到寄存器中（然后存储回内存），x 的所有可能值是多少两个线程都完成后？

现在答案是2:10（含）。我理解 5:10 的结果，但 x 怎么可能是 2、3 或 4？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T02:23:21.950

得到 x = 2 的序列：

```
Thread 2 read // Reg_2 = 0
Thread 1 read/write 4 times // x = 4
Thread 2 write // * Reg_2 = 0 --> x = 1
Thread 1 read // Reg_1 = 1
Thread 2 read/write 4 times // x = 5
Thread 1 write // Reg_1 = 1 --> x = 2 
```

根据您在标有 * 的步骤抢占之前执行的写入线程 2 执行了多少次，您将获得 3 和 4 的结果。

# php - 是否可以使用 JText::_ 将变量名称更改为所有站点语言？

> ID：11093529
> 
> 赞同：0
> 
> 时间：2012-06-19T02:13:54.403
> 
> 标签：php, joomla, metadata

我正在构建一个 php 代码来填充一些从同一个站点 db 获取信息的元数据，这个站点是英语、法语和西班牙语的。现在我需要用每种语言创建 3 个句子，并且我从数据库中获取了一些需要翻译的字符串。有没有办法我可以使用 JText::_ 从语言文件中获取翻译并将其设置为每种语言的不同变量。?

我的意思是

```
$var_en = JText::_($cat_name) //store the category name in english
$var_fr = JText::_($cat_name) //store the category name in french 
```

如何在我的代码中指定 JText 我想使用什么语言？

我知道这可能很复杂，我将与您分享我的代码以便更好地理解

```
function createmetadatainfo(){
    global $mtconf;

//USE THIS IF SCRIPT EXECUTION TAKES TOO LONG
//set_time_limit(300);

//USE THE $app OBJECT TO CLOSE THE APPLICATION BEFORE JOOMLA RENDERS THE SITE
$app        = JFactory::getApplication('admin');
    //DATABASE
    global $database;   
    $database       =& JFactory::getDBO();

        //CREATE AND UPDATE METADESC FOR CATEGORIES.
            $query = 'SELECT 
                        `cat_id` , `cat_name` , `cat_links`
                      FROM 
                        `#__mt_cats`
                      ORDER BY 
                        `cat_id`';

            $database->setQuery($query);
            $metaCats = $database->loadAssocList();

            foreach ($metaCats as $value) {
                //building metadescription sentences in different languages. 
                $meta_en = $value['cat_links']." listings on ".$value['cat_name']." category"; 
                $meta_fr = $value['cat_links']." annonces sur ".$value['cat_name']." catégorie";
                $meta_es = $value['cat_links']." listados en la categoría ".$value['cat_name'];
                $cat_id = $value['cat_id'];
                $query_cat_metadesc = "UPDATE `#__mt_cats` SET `metadesc` = '$meta_en' ,
                                                            `metadesc_fr` = '$meta_fr' ,
                                                            `metadesc_es` = '$meta_es'
                                                             WHERE `cat_id` = '$cat_id'";
                $database->setQuery($query_cat_metadesc);
                $database->query();
            }

//CLOSE the $app
$app->close(); 
```

}

请注意在 foreach 语句中我需要在 $meta_en、$meta_fr 和 $meta_es 中存储不同语言的变量 $value['cat_name']

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T02:24:47.393

[`JText::_()`](http://api.joomla.org/Joomla-Platform/Language/JText.html#_)呼叫和使用不会为您提供任何更改语言的方法。它用于应用程序范围的翻译，因此使用每个请求绑定的应用程序语言。

相反，您可以考虑创建自己的[`JLanguage`](http://api.joomla.org/Joomla-Platform/Language/JLanguage.html)对象，这样您就可以更好地控制要使用的语言。

# html - 为什么列表不会浮动到 div 的开头？

> ID：11093530
> 
> 赞同：0
> 
> 时间：2012-06-19T02:14:00.307
> 
> 标签：html, css, position, css-float

我的大脑不工作了。请让你的工作为我工作 1 分钟。

代码非常简单。

```
<ul id="nav">
            <li><a href="">Plumbing</a></li>
            <li><a href="">Flooring</a></li>
            <li><a href="">Kitchen</a></li>
            <li><a href="">Bathroom</a></li>
            <li><a href="">Re-decoration</a></li>
            <li><a href="">Structural works</a></li>
            <li><a href="">Electrical</a></li>
            <li><a href="">Re-planning</a></li>
</ul> 
```

还有一些 CSS 样式：

```
#nav {margin:auto;width:960px;height:29px;background: url(../images/navbg_03.gif);box-shadow: 0px 10px  30px #cccccc;}
#nav li {position:relative;display:block;float:left;} 
```

如此简单，但令我难以置信的是，为什么当我浮动它时，它会在元素开始之前留下一个间隙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T02:22:05.003

`ul`s 通常在用户代理样式中有填充或边距，只需添加

```
#nav{
    padding:0;
    margin:0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-19T02:24:43.753

我一直依靠的拐杖是对所有事物都设限。这样做表明有一些填充物推过去：http: [//jsfiddle.net/gQMvT/5](http://jsfiddle.net/gQMvT/5)

```
* { border: 1px solid black; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T12:09:30.760

嘿边距应该设为 0px 以及 css 代码的填充应该看起来像这样

```
#nav {margin:0px;width:960px;height:29px;background: url(../images/navbg_03.gif);box-shadow: 0px 10px  30px #cccccc;}
#nav li {position:relative;display:block;float:left;} 
```

# asp.net - 如何在 Visual Studio 2010 中为服务引用终结点添加动态链接

> ID：11093531
> 
> 赞同：0
> 
> 时间：2012-06-19T02:14:09.090
> 
> 标签：asp.net, visual-studio-2010, web-services, service-reference

我正在尝试在我的 web.config 文件中定义一个服务端点，以便我可以将我们的暂存构建指向一个暂存 Web 服务和一个不同的生产端点。[这里](https://stackoverflow.com/questions/125399/how-can-i-dynamically-switch-web-service-addresses-in-net-without-a-recompile)有一个问题涉及 Visual Studio 2005/2008 中的*Web 引用*。我正在添加一个**服务引用**，但似乎在属性中找不到任何可以让我将 Url 行为定义为动态的东西。

我想在 appSettings 中定义 url。有谁知道这在 Visual Studio 2010 for Service References 中是如何工作的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T02:50:33.783

You can change the end point using what is known as a config transformation.

In short, a config transformation allows you to tweak various config settings depending on your deployment. This is a technique commonly used for changing connection strings as well.

Here's more reading: [How to: Transform Web.config When Deploying a Web Application Project](http://msdn.microsoft.com/en-us/library/dd465318.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T02:35:05.103

您可以在创建 Web 服务之后但在使用它之前在运行时设置 URL：

```
string localUrl = "localhost";
string stagingUrl = "http://staging.example.com"
string url = Request.IsLocal ? localUrl : stagingUrl;

var _webService = new YourWebService { Url = url }; 
```

# petapoco - 您如何使用 PetaPoco 处理与其他表的关系？

> ID：11093537
> 
> 赞同：1
> 
> 时间：2012-06-19T02:14:47.657
> 
> 标签：petapoco

例如，如果我有一个用于 Forum 的 POCO 和一个用于 ForumPost 的 POCO，我如何优雅地返回一个 ForumPosts 列表并在模型中指定此权限。我现在通过直接在 List 属性中添加我的 db.Query 调用来手动执行此操作，但有更好的方法吗？

```
[TableName("Forum")]
[PrimaryKey("ForumID")]
[ExplicitColumns]
public class Forum : BaseModel
{
    [Column]
    public int ForumID { get; set; }
    [Column]
    public string ForumName { get; set; }
    [Column]
    public string ForumDescription { get; set; }
    [ResultColumn]
     public List<ForumPost> {
        get 
```

{ // 返回 ForumPost 列表 - 有什么好的方法来处理这个？} } }

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T18:48:43.207

我为此编写了一个静态扩展，因此我可以像这样在我的属性中设置它（使用我的一些类）。此属性将在您的 POCO 模型中：

```
 private List<AssessmentAssignment> _AssessmentAssignments;
    [ResultColumn]
    public List<AssessmentAssignment> AssessmentAssignments
    {
        get
        {
            return ServiceExtensions<AssessmentAssignment>.GetRelatedList(this.GetType());
        }
        set
        {
            _AssessmentAssignments = value;
        }
    } 
```

这是我为此编写的 ServiveExtension，但不确定我是否喜欢这个。它有效，但是嗯。有人有更好的想法吗？

```
 public static class ServiceExtensions<T> where T : class, new()
{
    /// <summary>
    /// Experimental way to retrieve a foreign key related list with PetaPoco
    /// </summary>
    /// <param name="PrimaryTableType"></param>
    /// <returns></returns>
    public static List<T> GetRelatedList(Type PrimaryTableType)
    {
        var primaryTableData = PocoData.ForType(PrimaryTableType);
        var relationshipTableData = PocoData.ForType(typeof(T));

        using (PetaPoco.Database db = new PetaPoco.Database("ConnStringName"))
        {
            PetaPoco.Sql sql = new PetaPoco.Sql("SELECT A.* FROM " + relationshipTableData.TableInfo.TableName + " A")
            .Append("JOIN " + primaryTableData.TableInfo.TableName + " B ON A." + primaryTableData.TableInfo.PrimaryKey + " = B." + primaryTableData.TableInfo.PrimaryKey);

            return db.Fetch<T>(sql);
        }
    }
} 
```

# - GPU图像

> ID：11093540
> 
> 赞同：0
> 
> 时间：2012-06-19T02:15:32.807
> 
> 标签：

GPUImage 是一个开源的 iOS、macOS 和 Linux 框架，用于基于 GPU 的图像和视频处理。该框架的端口适用于 Android 和其他平台。

# mercurial - 我如何只提交子仓库的更改？

> ID：11093544
> 
> 赞同：9
> 
> 时间：2012-06-19T02:16:16.203
> 
> 标签：mercurial, subrepos

我有一个主仓库，其中有一些我不想提交的更改。

我有一个 subrepo，其中包含*已提交*的更改。

我想在我的主存储库中提交更改子存储库修订，而不提交对主存储库中文件的更改。

我似乎无法做到这一点。我无法提交`.hgsubstate`，并对要提交的文件进行微不足道的更改，但不会将子存储库更改提交到主存储库。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-19T13:29:38.527

将子存储库本身的名称传递给提交，Mercurial 将更新`.hgsubstate`并提交它。

```
ry4an@four:~$ hg init main
ry4an@four:~$ cd main
ry4an@four:~/main$ hg init sub
ry4an@four:~/main$ echo sub = sub > .hgsub
ry4an@four:~/main$ hg add .hgsub
ry4an@four:~/main$ hg commit
ry4an@four:~/main$ cd sub
ry4an@four:~/main/sub$ echo text > afile
ry4an@four:~/main/sub$ hg commit -Am first-in-sub
adding afile
ry4an@four:~/main/sub$ cd ..
ry4an@four:~/main$ hg status
ry4an@four:~/main$ echo text > dont-commit-me
ry4an@four:~/main$ hg add dont-commit-me
ry4an@four:~/main$ hg status
A dont-commit-me
ry4an@four:~/main$ cat .hgsubstate
0000000000000000000000000000000000000000 sub
ry4an@four:~/main$ hg commit -m 'subrepo only' sub
ry4an@four:~/main$ hg status
A dont-commit-me
ry4an@four:~/main$ cat .hgsubstate
dec5eaa9e22cd0a05cbba3ba02fdb0e1f243e07e sub 
```

请注意， main 中的文件`dont-commit-me`从未提交，但`.hgsubstate`已更新。

# javascript - 在 onclick 中使用 preventDefault 不起作用

> ID：11093549
> 
> 赞同：2
> 
> 时间：2012-06-19T02:16:56.150
> 
> 标签：javascript

谁能告诉我为什么下面的代码似乎不能阻止链接做它的事情？我知道我可以只使用`onclick="return false"`，但它应该与 preventDefault 一起使用，对吗？我试过了`onclick="function(e){this.preventDefault()}"`，`onclick="this.preventDefault()"`但没有爱。

```
<!doctype html>  
<html lang="en">  
    <head>  
        <meta charset="utf-8">  
        <title>Test</title>  
    </head>  
    <body> 
        <a href="http://www.google.com" onclick="function(e){e.preventDefault()}">Google Search</a>
    </body>  
</html> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-19T02:22:15.367

删除`function(e){`. 当你放在`function(e){}`那里时，这意味着创建一个函数但不运行它。

演示：http: [//jsfiddle.net/DerekL/RnngR/](http://jsfiddle.net/DerekL/RnngR/)

像这样做：

```
<a href="http://www.google.com" onclick="event.preventDefault();">Google Search</a> 
```

# ios - Wintermute iOS 应用程序获取“EXC_BAD_ACCESS”

> ID：11093553
> 
> 赞同：1
> 
> 时间：2012-06-19T02:18:31.273
> 
> 标签：ios, xcode, exc-bad-access, simulator

我目前正在尝试将我在 Wintermute Lite 引擎中开发的游戏移植到 iOS 平台。我的游戏可以在 XCode 中正常编译（尽管使用 armv6 架构），并且可以在 iOS 模拟器上完美运行；但是，当我尝试将它部署到 iPad 时，第一个线程将在 XCode 中停止，并出现错误“EXC_BAD_ACCESS (code=1, adress=0xfffffff6)”，指向非特定的汇编代码行。

首先，如果你们对可能导致这种情况的原因有任何想法，我将非常感谢一些帮助。问题是，我非常愿意自己调试它，但是作为一个完全使用 Objective-C 和 XCode 的菜鸟，我不确定如何将此特定错误追溯到导致它的代码行（如果这是一个非常基本的问题，我深表歉意，但我已经尝试找到一个命令来获取与错误相关的代码行，但没有成功）。

我意识到这在细节上很少，但正如我所说，我不确定如何使用 XCode 查明导致此错误的代码段，否则我只会自己调试。如果我可以提供任何额外的信息，请告诉我。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T21:21:43.173

我让它工作了。在玩了很多 XCode 之后，我意识到我错误地配置了 Wintermute 提供的项目文件。据我所知，这与该项目最初设置为为“iOS Universal”构建而我将其更改为“iPad 5.0”这一事实有关，这不知何故导致项目在部署时中断。

无论如何，我从一个新的 XCode 项目文件重新开始，并让它完美编译！抱歉打扰了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T02:25:42.413

问题是它不能在 iOS 上运行。它在模拟器上运行的原因是它是为英特尔芯片组构建的，而不是为 ARM 构建的。**即使**您将其设置为 armv6，但这并不意味着代码将在非英特尔设备上*运行。*

# bash - 意外的标记 '）'

> ID：11093558
> 
> 赞同：2
> 
> 时间：2012-06-19T02:19:51.127
> 
> 标签：bash

我正在尝试编写一个 bash 脚本。我想按系列表达式查找文件。我正在使用这条线：

`find /etc \( \( -perm +222 -not -user root \) -or \( \(-perm -022 -or -perm -002 -or -perm -020 /) -user root /) /) -ls`

我一直有一个错误，但问题是我找不到实际上是导致错误的原因。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T02:24:51.387

你`/)`的 s 应该是`\)`. `\`转义下一个字符。

# ravendb - 在 Raven DB 中生成测试数据

> ID：11093561
> 
> 赞同：4
> 
> 时间：2012-06-19T02:20:30.953
> 
> 标签：ravendb, seed, test-data

我正在寻找在 Raven DB 中生成测试数据的首选且可维护的方式。目前，我们的团队确实有办法通过 .NET 代码来实现。提供了示例。

但是，我正在寻找不同的选择。请分享。

```
public void Execute()
        {
            using (var documentStore = new DocumentStore { ConnectionStringName = "RavenDb" })
            {
                documentStore.Conventions.DefaultQueryingConsistency = ConsistencyOptions.QueryYourWrites;

                // Override the default key prefix generation strategy of Pascal case to lower case.
                documentStore.Conventions.FindTypeTagName = type => DocumentConvention.DefaultTypeTagName(type).ToLower();

                documentStore.Initialize();

                InitializeData(documentStore);
            }
        } 
```

**编辑：** [Raven-overflow](https://github.com/PureKrome/RavenOverflow)真的很有帮助。感谢您指出正确的地方。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-19T03:56:22.180

尝试检查[RavenOverflow](https://github.com/PureKrome/RavenOverflow)。在那里，我有一个包含假数据（硬编码和随机生成）的[FakeData项目。](https://github.com/PureKrome/RavenOverflow/tree/master/Code/RavenOverflow.FakeData)然后可以在我的[测试](https://github.com/PureKrome/RavenOverflow/tree/master/Code/RavenOverflow.Tests)项目或[主网站](https://github.com/PureKrome/RavenOverflow/tree/master/Code/RavenOverflow.Web)中使用它:)

这是一些示例代码...

```
if (isDataToBeSeeded)
{
    HelperUtilities.CreateSeedData(documentStore);
} 
```

……

```
public static void CreateSeedData(IDocumentStore documentStore)
{
    Condition.Requires(documentStore).IsNotNull();

    using (IDocumentSession documentSession = documentStore.OpenSession())
    {
        // First, check to make sure we don't have any data.
        var user = documentSession.Load<User>(1);
        if (user != null)
        {
            // ooOooo! we have a user, so it's assumed we actually have some seeded data.
            return;
        }

        // We have no users, so it's assumed we therefore have no data at all.
        // So lets fake some up :)

        // Users.
        ICollection<User> users = FakeUsers.CreateFakeUsers(50);
        StoreFakeEntities(users, documentSession);

        // Questions.
        ICollection<Question> questions = FakeQuestions.CreateFakeQuestions(users.Select(x => x.Id).ToList());
        StoreFakeEntities(questions, documentSession);

        documentSession.SaveChanges();

        // Make sure all our indexes are not stale.
        documentStore.WaitForStaleIndexesToComplete();
    }
} 
```

……

```
public static ICollection<Question> CreateFakeQuestions(IList<string> userIds, int numberOfFakeQuestions)
{
.... u get the idea .....
} 
```

希望这可以帮助。

# c - 反正有没有优化这种数据的排序？

> ID：11093564
> 
> 赞同：14
> 
> 时间：2012-06-19T02:20:56.907
> 
> 标签：c, algorithm, sorting

我正在对整数键数组进行排序。

### 有关数据的信息：

*   数组长 1176 个元素
*   密钥在 750 000 和 135 000 000 之间；0 也是可能的
*   有很多重复项，在每个数组中只有 48 到 100 个不同的键，但无法预测哪些值会超出整个范围
*   有很多长排序子序列，大多数数组由 33 到 80 个排序子序列组成
*   最小元素为0；0 的数量是可预测的并且在非常窄的范围内，每个数组大约 150 个

* * *

### 到目前为止我尝试了什么：

1.  **stdlib.h qsort** ;

    这很慢，现在我的函数在每次执行排序上花费 0.6 秒，而 stdlib.h qsort 是 1.0 秒；这与 std::sort 具有相同的性能

2.  **蒂姆排序**；

    我试过这个：[https](https://github.com/swenson/sort) ://github.com/swenson/sort和这个：[http](http://code.google.com/p/timsort/source/browse/trunk/timSort.c?spec=svn17&r=17) ://code.google.com/p/timsort/source/browse/trunk/timSort.c?spec=svn17&r=17 ；两者都比 stdlib qsort 慢得多

3.  **[http://www.ucw.cz/libucw/](http://www.ucw.cz/libucw/)**；

    他们的快速排序和插入排序组合是迄今为止我的数据最快的；我尝试了各种设置并将枢轴作为中间元素（不是 3 的中值）并从 28 个元素子数组（默认不是 8 个）开始插入排序可以提供最佳性能

4.  **壳排序**；

    与这篇文章的差距的简单实现：[http](http://en.wikipedia.org/wiki/Shellsort) ://en.wikipedia.org/wiki/Shellsort ；它很不错，虽然比 stdlib qsort 慢

* * *

我的想法是 qsort 做了很多交换和破坏（即反向）排序的子序列，所以应该有一些方法可以通过利用数据结构来改进它，不幸的是到目前为止我所有的尝试都失败了。
如果您好奇这是什么类型的数据，这些是在已经在前一个板上排序的各种板上评估的扑克手组（这是排序子序列的来源）。

该函数在 C 中。我使用 Visual Studio 2010。有什么想法吗？

示例数据： http: [//pastebin.com/kKUdnU3N](http://pastebin.com/kKUdnU3N)
示例完整执行（1176 种）：[https ://dl.dropbox.com/u/86311885/out.zip](https://dl.dropbox.com/u/86311885/out.zip)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-19T02:26:40.423

如果您首先通过数组对数字进行分组以消除重复项怎么办。每个数字都可以进入一个哈希表，其中数字是键，出现的次数是值。因此，如果数字 750 000 在数组中出现 57 次，则哈希表将保存 key=750000；值=57。然后，您可以按键对小得多的哈希表进行排序，其长度应少于 100 个元素。

有了这个，你只需要通过数组，另一个通过更小的哈希表键列表。这应该避免大多数交换和比较。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-19T02:32:08.123

你可以看看我从这篇[文章](https://stackoverflow.com/questions/220044/which-sort-algorithm-works-best-on-mostly-sorted-data)中看到的这个[动画](http://www.sorting-algorithms.com/few-unique-keys)

我认为您的问题属于“少数独特”类别，其中 3 路分区快速排序和[外壳排序](http://en.wikipedia.org/wiki/Shellsort)非常快。

**更新：**

我基于[sorting-algorithms.com](http://sorting-algorithms.com)上的伪代码实现了一些排序算法，并在OP给出的样本数据上运行它们。纯娱乐：

插入 0.154s

外壳 0.031s

快速排序 0.018s

基数 0.017s

3路快速分拣0.013s

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T02:50:29.220

Seems like a [Radix Sort](http://en.wikipedia.org/wiki/Radix_sort) or a [Bucket sort](http://en.wikipedia.org/wiki/Bucket_sort) would be the way to go since they can be efficient on integers.

Radix sort's efficiency is O(k·n) for n keys which have k or fewer digits. Sometimes k is presented as a constant, which would make radix sort better (for sufficiently large n) than the best comparison-based sorting algorithms, which are all O(n·log(n)). While bucket sort is O(N*k) for n keys and k buckets.

It may come down to the constant (K) factor for radix sort. From my [Java experimentation](http://code.google.com/p/java-algorithms-implementation/). Also, it's worth noting that radix doesn't fair so well with sorted elements.

100k integers:

```
Algorithm           Random  Sorted  Reverse Sorted
Merge sort          0.075   0.025   0.025
Quicksort           0.027   0.014   0.015
Heap sort           0.056   0.03    0.03
Counting sort       0.022   0.002   0.004
Radix sort          0.047   0.018   0.016 
```

500k integers:

```
Algorithm           Random  Sorted  Reverse Sorted
Merge sort          0.286   0.099   0.084
Quicksort           0.151   0.051   0.057
Heap sort           0.277   0.134   0.098
Counting sort       0.046   0.012   0.01
Radix sort          0.152   0.088   0.079 
```

1M integers:

```
Algorithm           Random  Sorted  Reverse Sorted
Merge sort          0.623   0.18    0.165
Quicksort           0.272   0.085   0.084
Heap sort           0.662   0.286   0.207
Counting sort       0.066   0.022   0.016
Radix sort          0.241   0.2     0.164 
```

10M integers:

```
Algorithm           Random  Sorted  Reverse Sorted
Merge sort          7.086   2.133   1.946
Quicksort           4.148   0.88    0.895
Heap sort           11.396  3.283   2.503
Counting sort       0.638   0.181   0.129
Radix sort          2.856   2.909   3.901 
```

It seems like 500k items is when the constant starts favoring radix sort over quicksort.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-19T04:59:16.693

有一种算法可以利用已排序的子序列。它是合并排序的一种变体，称为[自然合并排序](http://www.algorithmist.com/index.php/Merge_sort#Natural_mergesort)。我在 C 中找不到一个很好的实现示例，但从头开始实现看起来并不难。基本上它是这样的：

1.  您需要一个包含两个整数的结构，即子序列的索引和长度。创建这些结构的新数组（或者可能是链表）。
2.  遍历整个数组一次，每次一个值小于前一个值时，它就是一个新子序列的开始，因此创建一个新结构并分配子序列的位置，并分配前一个子序列的长度- 前一个结构的序列。
3.  遍历您的结构并对它们成对执行合并操作。
4.  重复步骤 3，直到全部合并。

[合并操作与Merge Sort](http://en.wikipedia.org/wiki/Merge_sort)中的合并操作相同。您有一个指向每个子序列开头的指针。哪个较小的应该在子序列的开头，所以如果它还没有，则将它移到那里，然后将指针移到您从中移动它的子序列上。继续合并两个子序列，直到它们完全排序。

您可以将其与 Oleski 的答案结合起来创建一种链表，其中每个节点都包含一个值以及一个值在子序列中连续出现的次数。然后，当您合并时，如果遇到等效值，您将它们的基数相加，以一次添加几个相同的值。您不需要为这种潜在的优化做一个散列。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-19T02:33:03.503

建立一个哈希表并分配一个数组。对于输入数组中的每个项目，检查该项目是否在哈希表中。如果是，则增加其值。如果没有，请将其插入值为 1 的哈希表中，并将其附加到您的数组中。

对数组进行排序。对于数组中的每个项目，将该项目写入输出的次数等于其在哈希表中的计数。鳍。

编辑：您可以为需要排序的每个数组清除并重新使用哈希表。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-19T02:31:34.000

我会尝试一个手动编码的 qsort，它具有在每个节点上存储数字的特殊技巧，以及它发生的次数。当您再次看到它时，您会增加计数。

始终从数组中间取枢轴，这样排序的子序列就不会给你一系列坏的枢轴。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-19T05:26:12.263

给定已排序的运行，一种合理的可能性是使用[就地合并](http://akira.ruc.dk/~keld/teaching/algoritmedesign_f04/Artikler/04/Huang88.pdf)将这些运行组合成大的已排序运行，直到您的整个数组被排序。请注意，如果函数只需要一个 C 接口（而不是必须用 C 本身编写），您可以使用C `std::inplace_merge`++ 标准库中的`extern "C"`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-01-12T02:08:27.123

坦率地说，GNU 的 qsort 非常好并且难以击败，但我最近将大部分 qsort 调用转换为 Christopher Swenson 对**tim_sort**的调用，可以在[https://github.com/swenson/sort/blob/master/找到sort.h](https://github.com/swenson/sort/blob/master/sort.h) - 它真的非常好。顺便说一句，它显式地利用了已经排序的段，比如你的数据中的段。

我正在做 C++，并且已经“模板化”了 Christopher 的（纯 C 宏）代码，但它可能不会改变这样一个事实，即它在您的数据上绝对是赢家。我相信以下在带有 -O3 的 GNU-64 中没有吸引力：

排序测试：

*   qsort: 00:00:25.4

*   时间排序：00:00:08.2

*   标准::排序：00:00:15.2

（每一种都运行一百万次）。

# iphone - h 或 m 文件中的 Uiimagepickercontroller？

> ID：11093568
> 
> 赞同：0
> 
> 时间：2012-06-19T02:21:31.343
> 
> 标签：iphone, objective-c, xcode, ios5, uiimagepickercontroller

我想知道它有什么不同吗？如果它在我们的 m 文件中声明，是否每次我们使用时都会再次分配它（从而消耗额外和冗余的内存），或者两种方式都意味着同样的事情，所以我声明的哪个文件没有任何不同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T06:22:25.200

如果您在***.h 中声明 UIImagePickerController.h，则每当您在其他类中导入 *** .h 时，UIImagePickerController.h 也会被不必要地导入那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T02:30:04.717

唯一的区别是变量的范围。头文件中声明的变量将可用于类中的所有方法。在方法中声明的变量只能在该方法中访问。

就内存而言，通常在头文件或 .m 文件中声明变量没有区别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T07:40:38.983

如果您使用 in .h 应该存在于每个人中，如果 in .m 应该存在于函数中，并且如果您在 .m 中使用 @interface() 声明它应该是私有的，则区别在于范围。

# c++ - 如何分配当前在分配期间引发 std::bad_alloc 错误的大型布尔数组？

> ID：11093571
> 
> 赞同：2
> 
> 时间：2012-06-19T02:21:39.230
> 
> 标签：c++, arrays, segmentation-fault

我已经看到了几个与此相关的问题，但我想验证我是否遇到了类似的问题。我的代码分配了一个包含大量元素的布尔数组。这是我的代码，在 x86_64 Linux 机器上编译：

```
#include <iostream>
#include <math.h>

using std::cout;
using std::endl;
using std::nothrow;

long problem3()
{
    long upper_bound = 600851475143;
    long max_prime_factor = 1;
    long max_possible_prime = (long) sqrt(upper_bound) + 1;
    bool * primes;
    primes = new (nothrow) bool[upper_bound];
    primes[0] = false; //segmentation fault occurs here
    primes[1] = false;
    for (long i = 2; i < upper_bound; i++)
       primes[i] = true;
    for (long number = 2; number < max_possible_prime; number++)
    {
        if (primes[number] == true)
        {
            if (upper_bound % number == 0)
            {
                max_prime_factor = number;
            }
            for (long j = number + number; j < upper_bound; j += number)
                primes[j] = false;
        }
        else { continue; }
    }
    return max_prime_factor;
}

int main ( int argc, char *argv[] )
{
    cout<<"Problem 3: "<<problem3()<<endl;
} 
```

构建此代码并按原样运行它会在此行产生分段错误：

```
primes[0] = false 
```

如果我删除`nothrow`更改此行的指令：

```
primes = new (nothrow) bool[upper_bound]; 
```

对此：

```
primes = new bool[upper_bound]; 
```

我收到一条错误消息，说明：

```
terminate called after throwing an instance of 'std::bad_alloc' 
```

我认为这意味着分配失败，大概是因为大小（基于[类似的问题](https://stackoverflow.com/questions/6640691/segmentation-fault-when-allocating-large-arrays-on-the-stack)和[其他引用的链接](http://bytes.com/topic/c/answers/131385-maximum-size-array)。

CodeBlocks 中的调试器显示即使在它应该被分配之后`primes`仍然设置为。`0x0`Valgrind 证实了这一点：

```
==15436== Command: ./main
==15436== 
==15436== Invalid write of size 1
==15436==    at 0x400A81: problem3() (main.cpp:54)
==15436==    by 0x400B59: main (main.cpp:77)
==15436==  Address 0x0 is not stack'd, malloc'd or (recently) free'd
==15436== 
==15436== 
==15436== Process terminating with default action of signal 11 (SIGSEGV)
==15436==  Access not within mapped region at address 0x0
==15436==    at 0x400A81: problem3() (main.cpp:54)
==15436==    by 0x400B59: main (main.cpp:77)
==15436==  If you believe this happened as a result of a stack
==15436==  overflow in your program's main thread (unlikely but
==15436==  possible), you can try to increase the size of the
==15436==  main thread stack using the --main-stacksize= flag.
==15436==  The main thread stack size used in this run was 8388608.
==15436== 
==15436== HEAP SUMMARY:
==15436==     in use at exit: 0 bytes in 0 blocks
==15436==   total heap usage: 1 allocs, 0 frees, 0 bytes allocated
==15436== 
==15436== All heap blocks were freed -- no leaks are possible
==15436== 
==15436== For counts of detected and suppressed errors, rerun with: -v
==15436== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 3 from 3)
Segmentation fault 
```

问题：我知道`std::vector`，所以我应该用它来分配这个数组吗？我也愿意尝试不同的算法，但我想知道我是否缺少 C++ 的细微差别，这将允许我分配这样的数组（即使它绝对庞大，我理解这一点）。我也尝试尽可能多地调试这个问题，但是如果我应该提供其他任何东西，请告诉我，以便我下次遇到麻烦时可以使用这些工具。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T03:01:42.307

Pollard 的 Rho 算法是一种非常简单的算法，可用于分解正在使用的（大）数。

为简洁起见，我将省略数学解释，但您可以在[Wikipedia](http://en.wikipedia.org/wiki/Pollard%27s_rho_algorithm)文章中找到详细信息。

```
unisgned long long GCD(unisgned long long x, unisgned long long y)
{
    while (y != 0)
    {
        unsigned long long t = b;
        b = a % b;
        a = t;
    }

    return a;
}

unsigned long long f(unsigned long long x, unsigned long long n)
{
    return (x * x + 1) % n;
}

unsigned long long PollardRho(unsigned long long n)
{
    unsigned long long x = 2, y = 2, d = 1;

    while (d == 1)
    {
        x = f(x);
        y = f(f(y));
        d = GCD(std::abs(x - y), n);
    }

    if (d == n)
        throw "Failure";
    return d;
}

unsigned long long MaxFactor(unsigned long long n)
{
    unsigned long long largest = 1;

    while (n != 1)
    {
        unsigned long long factor = PollardRho(n);
        largest = std::max(largest, factor);
        n /= factor;
    }

    return largest;
} 
```

注意：我实际上并没有测试 C++ 代码。我在 Mathematica 中对它进行了原型设计，它正确地返回了最大素数`6857`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T02:28:20.483

考虑到数据密度和快速操作，使用`std::vector<bool>`或`std::bitset`专门为此目的而设计。在一个常规的布尔数组中，每个元素至少分配一个字节，而不是一个位。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T02:54:03.850

Assuming that `600851475143` is a composite number, its largest prime factor is less than or equal to `sqrt(600851475143)` or about `775146`. Your sieve doesn't need to be any larger than that.

This problem (Project Euler #3) can also be solved with simple brute-forced factorization. That method only takes about .002 seconds on my desktop PC.

# opengl - 在现代 OpenGL 中“移动”的最佳方式

> ID：11093582
> 
> 赞同：1
> 
> 时间：2012-06-19T02:23:09.263
> 
> 标签：opengl

我正在使用现代 OpenGL（2.1+ 版）。它与经典版本有更多不同。一切都是缓冲区，顶点缓冲区，元素缓冲区，统一缓冲区，......并且不推荐使用经典的做事方式：-|...

**我的问题：**在现代opengl中“移动”（无论如何，一般的转换）的最佳方式是什么？

目前，我这样做：

```
void render()
{
    glUseProgram(hProg);

    ...
    modelMatrix = glm::mat4(1.0f); // like glLoadIdentity()
    glUniformMatrix4fv(uni_modelMatrix, 1, GL_FALSE, glm::value_ptr(modelMatrix));
    glBindBuffer(GL_ARRAY_BUFFER, vbo_object_1);
    glVertexArrayPointer(...);

    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, ibo_object_1);
    glDrawElements(...);

    modelMatrix = glm::translate(modelMatrix, glm::vec3(5.0f, 0.0f, 0.0f));
    glUniformMatrix4fv(uni_modelMatrix, 1, GL_FALSE, glm::value_ptr(modelMatrix));
    glBindBuffer(GL_ARRAY_BUFFER, vbo_object_2);
    glVertexArrayPointer(...);

    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, ibo_object_2);
    glDrawElements(...);
} 
```

# android - 在 GridView 上绘画

> ID：11093584
> 
> 赞同：1
> 
> 时间：2012-06-19T02:23:10.167
> 
> 标签：android, gridview, paint

我有一个显示日历的 GridView。我需要在多个“天”甚至多个周内绘制一些粗线（大约是网格单元高度的 1/4）。在任何给定的一周内，我可能需要做两到三个。

一周单元格中的每一行也需要包含一些文本。

由于线条需要穿过网格单元格，我也许可以为 GridView 获得一个 Canvas 并在其上绘画。但我找不到办法做到这一点。由于线条跨越多个网格单元格，因此在特定单元格中绘制线条并尝试将其与前一个单元格对齐似乎没有用。而且我必须动态地这样做，我不能在布局中设置它。

我愿意接受有关如何完成这项工作的想法。任何人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T02:40:37.317

如果您想在 GridView 内容之上进行任何其他绘图：

*   重写 dispatchDraw()，它会给你一个 Canvas 来绘制。
*   调用 super.dispatchDraw() 先绘制正常内容。
*   使用画布添加您认为需要的任何其他内容。

高温高压

# winforms - 有没有办法告诉 Wiinforms WebBrowser 控件使用当前浏览器打开超链接？

> ID：11093587
> 
> 赞同：0
> 
> 时间：2012-06-19T02:23:27.817
> 
> 标签：winforms, browser

我有一个带有 Web 浏览器控件的 winforms 应用程序。我想知道是否有办法告诉浏览器控件在当前活动的浏览器中打开一个 URL，无论它是否是默认浏览器。我的直觉是这根本不可行，因为此控件使用的是用户定义的操作系统的默认浏览器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T14:09:42.577

利用：

```
System.Diagnostics.Process.Start() 
```

或者试试这个：

```
Private Sub WebBrowser1_NewWindow(ByVal sender As Object, ByVal e As System.ComponentModel.CancelEventArgs) Handles WebBrowser1.NewWindow
    Dim myElement As HtmlElement = WebBrowser1.Document.ActiveElement
    Dim target As String = myElement.GetAttribute("href")
    Dim newInstance As New Form1
    newInstance.Show()
    newInstance.WebBrowser1.Navigate(target)
    e.Cancel = True
End Sub 
```

# mysql - 外键约束格式不正确

> ID：11093588
> 
> 赞同：1
> 
> 时间：2012-06-19T02:23:44.050
> 
> 标签：mysql

我已经解决了关于这个主题的其他几个问题，但我似乎无法弄清楚他们的解决方案如何应用于我的表格。查看[sqlfiddle](http://sqlfiddle.com/#!2/4fab1)。您可以看到它很好地构建了架构。

基本上，一个表是联系人/人员表。第二张表是国家表。我正在尝试在`contacts.country_id`和之间创建外键引用`countries.id`。

现在，将以下内容添加到左侧的面板中：

```
ALTER TABLE `ultra_contacts`
ADD INDEX `fk_test` (`country_id`),
ADD CONSTRAINT `fk_test` FOREIGN KEY (`country_id`) REFERENCES `ultra_countries` (`id`) ON UPDATE CASCADE ON DELETE CASCADE` 
```

更改表代码由于某种原因无法正常工作。任何帮助，将不胜感激。

错误是：`Schema Creation Failed: Can't create table 'db_e342e.#sql-7711_1a4d2' (errno: 150):`使用第 3 方程序（HeidiSQL），错误更详细一点：

`Foreign key constraint is incorrectly formed`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T04:42:53.967

您正在尝试在 MyISAM 表上使用外键，这是不允许的（它们仅适用于 InnoDB）。看看这里：[http](http://sqlfiddle.com/#!2/64951) ://sqlfiddle.com/#! 2/64951 我从你原来的地方改变的只是表类型（从 MyISAM 到 InnoDB），然后我添加了约束。工作得很好。

完全披露 - 我是 SQL Fiddle 的作者 :)

# jquery - 按钮不突出显示文本

> ID：11093592
> 
> 赞同：0
> 
> 时间：2012-06-19T02:24:04.027
> 
> 标签：jquery, html

我有这个 jQuery 片段，我已经存储了变量以突出显示它们。

```
 var words= ['Sample','count'];
    var keywords = ['import','public','class','static','void','for','if','else'];
    $(document).ready(function() {
    if (#showVariables).click(function(){
        var wordsHtml = $('#identifier').html();
        $.each(words, function(idx, word) {
        var reg = new RegExp(word, 'g');
        wordsHtml = wordsHtml.replace(reg, '<span class="highlight">' + word + '</span>');
        })
        $('#identifier').html(wordsHtml);
    });

}); 
```

这是可能有帮助的html，

```
<div id="menuDiv"><span id="showVariables" class="button">Variables</span><span id="showKeywords" class="button">Keywords</span></div>
<div id="codeDiv">
<br><span class="keyword">import</span> java.io.*;
<br>
<br><span class="keyword">public</span> <span class="keyword">class</span> <span class="identifier">Sample</span> {

<br>&nbsp;&nbsp;<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String args[]) {
<br>&nbsp;&nbsp;&nbsp;&nbsp;</span>int</span> <span class="identifier">count</span> = 0; 
```

我正在尝试突出显示关键字和标识符。我可能错在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T02:30:20.023

问题是没有“如果单击”并且选择器的语法也错误 - 缺少引号

“如果”，由于缺乏更好的术语，只有当用户点击时才会发生

改变：

```
if (#showVariables).click(function(){ 
```

至

```
$('#showVariables').click(function(){ 
```

编辑：重新编码以将各种数组传递给相同的高亮功能。演示同时使用数组“words”和“keywords”

演示： http: [//fiddle.jshell.net/dxPhK/](http://fiddle.jshell.net/dxPhK/)

将保留字“类”粘贴到正则表达式中仍然存在小问题

```
var words = ['Sample', 'count'];
var keywords = ['import', 'public', /*'class',*/ 'static', 'void', 'for', 'if', 'else'];
$(document).ready(function() {
    $('#showVariables').click(function() {
        $('.identifier').each(function(idx, el) {
            var $el=$(el)
            $el.html(hightLightHtml($el.html(), words, 'red'));
        })
    });
    $('#showKeywords').click(function() {
        $('.keyword').each(function(idx, el) {
           // console.log(idx)
            var $el=$(el)
            $el.html(hightLightHtml($el.html(), keywords, 'yellow'));
        })
    });

});

function hightLightHtml(wordsHtml, wordsArray, highlightClass) {
    $.each(wordsArray, function(idx, word) {
        var reg = new RegExp(word, 'g');
        wordsHtml = wordsHtml.replace(reg, '<span class="' + highlightClass + '" >' + word + '</span>');
    })
    return wordsHtml;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T02:35:57.273

**演示** [http://fiddle.jshell.net/rG6F9/13/](http://fiddle.jshell.net/rG6F9/13/)（单击`varaibles`文本，您将看到 HTML 警报前后。

突出显示在这里可以正常工作：http: [//fiddle.jshell.net/8axss/20/](http://fiddle.jshell.net/8axss/20/)（我已经清理了你的html以及脚本）

嗨，很多事情都不正确：

1)`$('#showVariables').click(function()`

2)`.identifier`是一个类，所以使用`.`.

3)`identifier`应该放置在最外面的跨度上，这在之前只有 Sample 的地方。

休息请看下面的 Jquery 和 html。

希望这可以帮助，

**代码**

```
var words = ['Sample', 'count'];
var keywords = ['import', 'public', 'class', 'static', 'void', 'for', 'if', 'else'];
$(document).ready(function() {
    $('#showVariables').click(function() {
        alert($('.identifier').html());
        var wordsHtml = $('.identifier').html();
        $.each(words, function(idx, word) {
            var reg = new RegExp(word, 'g');
            wordsHtml = wordsHtml.replace(reg, '<span class="highlight" style="backgroun-color:yellow;">' + word + '</span>');

        })
           alert(" AFter HTML highlight == " + wordsHtml);
        $('#identifier').html(wordsHtml);
    });

}); 
```

**HTML**

```
<div id="menuDiv"><span id="showVariables" class="button">Variables</span><span id="showKeywords" class="button">Keywords</span></div>
<div id="codeDiv">
<br><span class="keyword">import</span> java.io.*;
<br>
<br><span class="keyword">public</span> <span class="keyword">class</span> <span class="identifier">Sample {

<br>&nbsp;&nbsp;<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String args[]) {
<br>&nbsp;&nbsp;&nbsp;&nbsp;</span>int</span> <span class="identifier">count</span> = 0;
</span> 
```

# python - Python：pysqlite 库不支持 C 扩展加载

> ID：11093593
> 
> 赞同：5
> 
> 时间：2012-06-19T02:24:07.117
> 
> 标签：python, django, sqlite, postgis, spatialite

我正在尝试让 Spatialite 与我的 django 应用程序一起使用，但是，我遇到了以下问题：

```
 raise ImproperlyConfigured('The pysqlite library does not support C extension loading. '
django.core.exceptions.ImproperlyConfigured: The pysqlite library does not support C extension loading. Both SQLite and pysqlite must be configured to allow the loading of extensions to use SpatiaLite.
make: *** [syncdb] Error 1 
```

使用 ubuntu 12.04，我`pip`在同一个用户中使用 sudo 安装了 pysqlite。我也尝试过编译 pysqlite 并启用自己的扩展加载。

帮助？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T23:53:52.777

pysqlite 的默认设置是在没有扩展加载支持的情况下构建。因此，仅重建将无济于事。您需要更改设置（在 setup.cfg 中）。

所以我建议下载为 tarball，并查看 setup.cfg：

```
[build_ext]
#define=
#include_dirs=/usr/local/include
#library_dirs=/usr/local/lib
libraries=sqlite3
define=SQLITE_OMIT_LOAD_EXTENSION 
```

最后一行是问题所在。最简单的方法就是将其注释掉（在行首添加 # ），所以它看起来像：

```
[build_ext]
#define=
#include_dirs=/usr/local/include
#library_dirs=/usr/local/lib
libraries=sqlite3
# define=SQLITE_OMIT_LOAD_EXTENSION 
```

然后根据 tarball 中的说明进行重建（参见 doc/install-source.txt）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-03-02T01:30:32.817

这里提出的解决方案似乎适用于旧系统/Python2。对于较新版本的 Python（例如 3.8），sqlite 作为标准库的一部分提供，并且有必要使用适当配置的 sqlite 库构建 Python。

例如，在使用 homebrew 和 pyenv 的 MacOS 上（假设满足 Python 依赖项并且通过 homebrew 安装 sqlite 并启用扩展加载）：

```
PYTHON_CONFIGURE_OPTS="--enable-loadable-sqlite-extensions --enable-optimizations --with-openssl=\$(brew --prefix openssl)" \
LDFLAGS="-L/usr/local/opt/sqlite/lib" \
CPPFLAGS="-I/usr/local/opt/sqlite/include" \
pyenv install 3.8.2 
```

有关详细的解决方案，请查看[此处](https://stackoverflow.com/questions/59157479/django-core-exceptions-improperlyconfigured-spatialite-requires-sqlite-to-be-co/60481417#60481417)

# javascript - JavaScript：如何从非阻塞回调中获取数据

> ID：11093595
> 
> 赞同：1
> 
> 时间：2012-06-19T02:24:33.447
> 
> 标签：javascript, nonblocking

```
function getHtmlBodyFromFile( filename ){
    var outStr = '';
    $.get(filename, function(data, status) {
        outStr = $('body', $(data)).html();
    });
    return outStr;
}
$("div#detail").html( getHtmlBodyFromFile('OEBPS/text/section0002.xhtml') ); //blank 
```

return outStr 是空白的，因为函数在调用 $.get() 后立即返回，您能否建议我一种更好的方法来返回那些非阻塞样式的有效数据。太感谢了

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T02:27:42.820

与其期望从函数返回数据`getHtmlBodyFromFile`，不如传递一个回调函数，`getHtmlBodyFromFile`该回调函数应在 ajax 调用之后执行。

像这样的东西：

```
function getHtmlBodyFromFile( filename, callback ){
    var outStr = '';
    $.get(filename, function(data, status) {
        outStr = $('body', $(data)).html();
                callback(outStr)
    });
    //return outStr;
}
getHtmlBodyFromFile('OEBPS/text/section0002.xhtml', function(data) {
    $("div#detail").html(data);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T02:34:10.080

您可以使用[.load](http://api.jquery.com/load/)，这将非常简单，它允许您指定要插入的远程文档的一部分。

```
$("div#detail").load('OEBPS/text/section0002.xhtml body'); 
```

***PS：***如果你使用 id 选择器，你不需要`$('div#detail')`，只是`$('#detail')`会更好。通过 id 查询 dom 是快速的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T02:30:52.287

[http://api.jquery.com/jQuery.get/](http://api.jquery.com/jQuery.get/)

使用`success`时使用回调`$.get()`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-19T02:33:37.060

您也可以考虑使用[`.load()`](http://api.jquery.com/load/)：

```
$('div#detail').load('OEBPS/text/section0002.xhtml', function(response, status) {
    $(this).html($('body', $(response)));
}); 
```

或者，您可以通过`' body'`在 URL 后面添加来加载所需的片段，但使用回调您可以选择检查响应状态。

# linker - 在 unix 上创建库时，除了“ar rcs”之外还有什么必要的吗？

> ID：11093600
> 
> 赞同：4
> 
> 时间：2012-06-19T02:25:05.183
> 
> 标签：linker, unix-ar

我有许多源文件要合并到一个`.a`文件中。我用命令制作图书馆

```
ar rcs libcathat.a thing1.o thing2.o fish.o 
```

然后我尝试使用我用来制作`.o`文件的相同编译器（g++）链接到这个库：

```
 g++ -L/path/to/cathat -lcathat seuss.o -o seuss 
```

但是，当我尝试使用在 thing1.cpp 中定义的函数（理论上在 thing.o 中表示）时，这会产生错误：

```
/path/seuss.cpp:46: undefined reference to `redFishBlueFish(int, char**)' 
```

**我还需要对`.a`文件做些什么才能链接到它吗？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T02:32:40.073

尝试将链接器语句移到末尾：

```
g++ seuss.o -o seuss -L/path/to/cathat -lcathat 
```

如果这不起作用，请确保这些符号实际上在存档中：

```
nm libcathat.a 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T03:32:07.750

通常，您不需要在大多数现代版本的 Unix 上做任何其他事情。

在某些（主要是较旧的 Unix）版本上，有必要`ranlib`在库中使用来添加一个查找表，以允许链接器快速查找符号。几乎所有现代版本`ar`都会自动执行此操作。需要`ranlib`是从第 7 版 UNIX™ 的“糟糕的过去”中遗留下来的东西。

* * *

由于某些我现在找不到的原因，我也在 Mac OS X 10.7.4 上构建档案`ranlib`。我这样做肯定是有原因的，但这个原因现在似乎无关紧要了——存档库`ranlib`在没有 Mac OS X 10.7.4 的情况下似乎可以正常工作，至少对于单一架构来说是这样。我确实找到了我在 2004 年 7 月所做的更改，该更改`ranlib`重新放入了`make`程序中，但是签入说明没有说明我为什么要进行更改。我已经更新了规则定义文件，所以它不再使用`ranlib`.

# iphone - 通过 iPhone 支付项目的选项

> ID：11093602
> 
> 赞同：1
> 
> 时间：2012-06-19T02:25:27.923
> 
> 标签：iphone, paypal, payment-gateway

不确定这是否是正确的问题，但我正在研究用户可以通过 iPhone 支付实物商品的不同方式（类似于[What options are available to accept credit card payment through an iPhone?](https://stackoverflow.com/questions/805324/what-options-are-available-to-accept-credit-card-payments-through-an-iphone)但答案超过 3岁）。

例如，如果您想订购比萨饼并且只有一个 Web 界面。是否有可能只拥有用户登录凭据并通过像贝宝一样将其作为支付方式运行？这会违反 Apple 关于应用内购买的 TOS（我不这么认为）吗？有没有办法让它记入他们的手机帐户？NCF 并不是一个真正的选择，因为它必须有一些距离。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T02:32:30.230

如果您想为每笔交易支付这么多钱，您可以使用 PayPal 虚拟终端。真的，你可以在 safari 浏览器上使用任何支付处理器[Stripe](https://stripe.com)也很好。如果你需要一个简单的 API，我会推荐 Stripe。

# html - 如何将页面内容设置到屏幕中间？

> ID：11093603
> 
> 赞同：40
> 
> 时间：2012-06-19T02:25:38.300
> 
> 标签：html, css

> **可能重复：**
> [如何将 <div> 对齐到页面中间](https://stackoverflow.com/questions/953918/how-to-align-a-div-to-the-middle-of-the-page)

我需要的是在屏幕中间显示网页的内容，无论屏幕大小，大小，分辨率高或低，它总是自动调整到屏幕中间。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-06-19T02:41:59.803

我猜你想把盒子垂直和水平居中，不管浏览器窗口的大小。由于盒子的宽度和高度是固定的，因此应该可以：

**标记：**

```
<div></div> 
```

**CSS：**

```
div {
    height: 200px;
    width: 400px;
    background: black;

    position: fixed;
    top: 50%;
    left: 50%;
    margin-top: -100px;
    margin-left: -200px;
} 
```

即使您调整浏览器的大小，该 div 也应该保持在屏幕的中心。只需将 margin-top 和 margin-left 替换为表格高度和宽度的一半。

编辑：归功于[CSS-Tricks](http://css-tricks.com/quick-css-trick-how-to-center-an-object-exactly-in-the-center/)，我得到了最初的想法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-19T03:20:36.047

您发布的代码的解决方案：

```
.center{
    position:absolute;
    width:780px;
    height:650px;
    left:50%;
    top:50%;
    margin-left:-390px;
    margin-top:-325px;
}

<table class="center" width="780" border="0" align="center" cellspacing="2" bordercolor="#000000" bgcolor="#FFCC66">
      <tr>
        <td>
        <table width="100%" border="0">
      <tr>
        <td>
        <table width="100%" border="0">
        <tr>
            <td width="150"><img src="images/banners/BAX Company.jpg" width="149" height="130" /></td>
            <td width="150"><img src="images/banners/BAX Location.jpg" width="149" height="130" /></td>
            <td width="300"><img src="images/banners/Closet.jpg" width="300" height="130" /></td>
            <td width="150"><img src="images/banners/BAX Company.jpg" width="149" height="130" /></td>
            <td width="150"><img src="images/banners/BAX Location.jpg" width="149" height="130" /></td>        
        </tr>
        </table>
        </td>
      </tr>
      <tr>
        <td>
        <table width="100%" border="0">
        <tr>
            <td width="150"><img src="images/banners/BAX Company.jpg" width="149" height="130" /></td>
            <td width="150"><img src="images/banners/BAX Location.jpg" width="149" height="130" /></td>
            <td width="300"><img src="images/banners/Closet.jpg" width="300" height="130" /></td>
            <td width="150"><img src="images/banners/BAX Company.jpg" width="149" height="130" /></td>
            <td width="150"><img src="images/banners/BAX Location.jpg" width="149" height="130" /></td>        
        </tr>
        </table>
        </td>
      </tr>
</table> 
```

--

**这是如何工作的？**

示例：http: [//jsfiddle.net/953Yj/](http://jsfiddle.net/953Yj/)

```
<div class="center">
    Lorem ipsum
</div>

.center{
    position:absolute;
    height: X px;
    width: Y px;
    left:50%;
    top:50%;
    margin-top:- X/2 px;
    margin-left:- Y/2 px;
} 
```

*   **X**会是你的身高。
*   **Y**将是您的宽度。

要`div`垂直和水平定位，请将**X**和**Y**除以*2*。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-19T02:59:21.497

如果你想让内容水平和垂直居中，但事先不知道你的页面会有多高，你必须使用 JavaScript。

HTML：

```
<body>
    <div id="content">...</div>
</body> 
```

CSS：

```
#content {
    max-width: 1000px;
    margin: auto;
    left: 1%;
    right: 1%;
    position: absolute;
} 
```

JavaScript（使用 jQuery）：

```
$(function() {
    $(window).on('resize', function resize()  {
        $(window).off('resize', resize);
        setTimeout(function () {
            var content = $('#content');
            var top = (window.innerHeight - content.height()) / 2;
            content.css('top', Math.max(0, top) + 'px');
            $(window).on('resize', resize);
        }, 50);
    }).resize();
}); 
```

[![水平和垂直居中](../Images/732983675b29c3ea63bf6270c5f79189.png)](http://jsfiddle.net/nBzcb/)

演示：http: [//jsfiddle.net/nBzcb/](http://jsfiddle.net/nBzcb/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-19T06:58:06.470

**HTML**

```
<!DOCTYPE html>
<html>
    <head>
        <title>Center</title>        
    </head>
    <body>
        <div id="main_body">
          some text
        </div>
    </body>
</html> 
```

**CSS**

```
body
{
   width: 100%;
   Height: 100%;
}
#main_body
{
    background: #ff3333;
    width: 200px;
    position: absolute;
}​ 
```

**JS ( jQuery )**

```
$(function(){
    var windowHeight = $(window).height();
    var windowWidth = $(window).width();
    var main = $("#main_body");    
    $("#main_body").css({ top: ((windowHeight / 2) - (main.height() / 2)) + "px",
                          left:((windowWidth / 2) - (main.width() / 2)) + "px" });
}); 
```

[在此处](http://jsfiddle.net/darkking/z8pTa/)查看示例

# perl - 如何在perl中获取两个日期之间的年份差异

> ID：11093605
> 
> 赞同：-1
> 
> 时间：2012-06-19T02:25:52.650
> 
> 标签：perl

如何在perl中获取两个日期之间的年份差异，如下面的日期

```
my $date1 = '2012-08-29T00:00:00.0000Z'
my $date2 = '2010-08-29T00:00:00.0000Z' 
```

需要帮助和建议。谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-19T02:47:43.580

```
use DateTime::Format::RFC3339 qw( );
my $format = DateTime::Format::RFC3339->new();

my $dt1 = $format->parse_datetime('2010-08-29T00:00:00.0000Z');
my $dt2 = $format->parse_datetime('2012-08-29T00:00:00.0000Z');
my $dur = $dt2 - $dt1;

say sprintf "%d years", $dur->in_units('years'); 
```

参考：[DateTime](http://search.cpan.org/perldoc?DateTime) , [DateTime::Duration](http://search.cpan.org/perldoc?DateTime::Duration) , [DateTime::Format::RFC3339](http://search.cpan.org/perldoc?DateTime::Format::RFC3339)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T03:07:50.833

其他人将发布的正确解决方案的轻量级替代方案：

```
my $date1 = '2012-08-29T00:00:00.0000Z';
my $date2 = '2010-08-29T00:00:00.0000Z';
my $years_diff = do { no warnings "numeric"; $date1 - $date2 }; 
```

请注意，在这个看似微不足道的问题中，可能有几十种不同的方法可以指定如何对部分年份进行四舍五入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T06:48:32.150

如果您不关心小时或闰年，您可以截断时间并使用 Date::Simple。

```
my $days = Date::Simple->new(substr $date2, 0, 10) - Date::Simple->new(substr $date1, 0, 10);
my $years = int($days / 365); 
```

# python - Python：如何从具有混合内容的文本文件中提取浮点数？

> ID：11093606
> 
> 赞同：3
> 
> 时间：2012-06-19T02:26:02.287
> 
> 标签：python, floating-point, csv

我有一个制表符分隔的文本文件，其中包含以下数据：

```
 ahi1
    b/se
ahi 
test    -2.435953
        1.218364
    ahi2
    b/se
ahi 
test    -2.001858
        1.303935 
```

我想将两个浮点数提取到具有两列的单独 csv 文件中，即。

```
-2.435953 1.218264

-2.001858 1.303935 
```

目前我的黑客尝试是：

```
 import csv
 from itertools import islice
 results = csv.reader(open('test', 'r'), delimiter="\n")

 list(islice(results,3))
 print results.next()
 print results.next()
 list(islice(results,3))
 print results.next()
 print results.next() 
```

这并不理想。我是 Python 的菜鸟，所以我提前道歉并感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T02:44:29.933

这是完成这项工作的代码：

```
import re

# this is the same data just copy/pasted from your question
data = """    ahi1
    b/se
ahi 
test    -2.435953
        1.218364
    ahi2
    b/se
ahi 
test    -2.001858
        1.303935"""

# what we're gonna do, is search through it line-by-line
# and parse out the numbers, using regular expressions

# what this basically does is, look for any number of characters
# that aren't digits or '-' [^-\d]  ^ means NOT
# then look for 0 or 1 dashes ('-') followed by one or more decimals
# and a dot and decimals again: [\-]{0,1}\d+\.\d+
# and then the same as first..
pattern = re.compile(r"[^-\d]*([\-]{0,1}\d+\.\d+)[^-\d]*")

results = []
for line in data.split("\n"):
    match = pattern.match(line)
    if match:
        results.append(match.groups()[0])

pairs = []
i = 0
end = len(results)
while i < end - 1:
    pairs.append((results[i], results[i+1]))
    i += 2

for p in pairs:
    print "%s, %s" % (p[0], p[1]) 
```

输出：

```
>>>
-2.435953, 1.218364
-2.001858, 1.303935 
```

您可以将它们保存在一个列表中，然后将它们压缩在一起，而不是打印出来。我正在使用[python 正则表达式框架](http://docs.python.org/library/re.html)来解析文本。如果您还不知道，我只能建议您选择正则表达式。我发现解析文本和各种机器生成的输出文件非常有用。

编辑：

哦，顺便说一句，如果您担心性能，我在我的慢旧 2ghz IBM T60 笔记本电脑上进行了测试，我可以使用正则表达式在大约 200 毫秒内解析一兆字节。

更新：我感觉很好，所以我为你做了最后一步：P

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T02:36:42.700

也许这可以帮助

```
zip(*[results]*5) 
```

例如

```
import csv
from itertools import izip
results = csv.reader(open('test', 'r'), delimiter="\t")
for result1, result2 in (x[3:5] for x in izip(*[results]*5)):
    ... # do something with the result 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-16T10:19:21.967

足够棘手但更有说服力和顺序的解决方案：

```
$ grep -v "ahi" myFileName | grep -v se | tr -d "test\" " | awk 'NR%2{printf $0", ";next;}1'
-2.435953, 1.218364
-2.001858, 1.303935 
```

它是如何工作的：基本上删除特定的文本行，然后删除行中不需要的文本，然后每隔一行加入格式。我只是为了美化目的添加了逗号。如果您不需要逗号，请在 awks printf ", " 中留下逗号。

# ruby - 不懂复杂的 Ruby 代码

> ID：11093612
> 
> 赞同：0
> 
> 时间：2012-06-19T02:26:44.470
> 
> 标签：ruby, ruby-on-rails-3

我目前正在阅读 Rails 3 In Action。我想知道是否有人可以向我解释一些代码。我很难理解它：

```
 scope :readable_by, lambda { |user| joins(:permissions).where(permissions: { action: "view", user_id: user.id })} 
```

谢谢，迈克

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T02:30:57.497

它被称为[Rails 范围](http://guides.rubyonrails.org/active_record_querying.html#scopes)。它实质上创建了一个名为的类方法，该方法`.readable_by(user)`在权限表上执行 SQL 连接并返回`action`列值为“view”且`user_id`列值为 equals的记录`user.id`。

它可以像这样使用（假设它在`Comments`模型中定义）：

```
readable_comments = Comments.readable_by(current_user) 
```

一个什么都不做的简单作用域是这样的：

```
scope :my_scope_name, lambda {} 
```

接受参数的作用域是这样的：

```
scope :my_scope_name, lambda { |my_parameter| } 
```

然后上面的范围使用了一些[ActiveRecord finder 方法](http://guides.rubyonrails.org/active_record_querying.html#retrieving-objects-from-the-database)，特别是`joins`和`where`。

# clojure - 求解 Project Euler 1

> ID：11093617
> 
> 赞同：0
> 
> 时间：2012-06-19T02:27:31.413
> 
> 标签：clojure

我正在尝试使用递归解决 Clojure 中的 Project Euler 问题。以下是问题陈述：

> 如果我们列出所有小于 10 且是 3 或 5 的倍数的自然数，我们会得到 3、5、6 和 9。这些倍数之和是 23。
> 
> 求 1000 以下所有 3 或 5 的倍数之和。

但是，下面的代码似乎给出了错误的答案。我究竟做错了什么？

```
(defn m?
  [x]
  (or (= (rem x 3)) (= (rem x 5))))

(defn sum-m
  [limit sum]
  (if (= limit  0)
    sum
    (recur (dec limit)
           (if (m? limit) 
             (+ sum limit)
             sum))))

(sum-m (dec 1000) 0) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T02:44:47.463

你没有说它给出了什么错误的答案，但我相信问题出在 m? 上：

```
(or (= 0 (rem x 3)) (= 0 (rem x 5))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T08:53:19.933

米？改成

```
(defn m? [x]
  (or (zero? (rem x 3))(zero? (rem x 5)))) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T02:48:00.760

我认为您希望该函数`m?`检查一个数字是 3 还是 5 的倍数。但它并没有这样做。您应该检查 (rem x 3) 或 (rem x 5) 中的任何一个是否为零。

对于非常大的数字，这是一个有趣的练习。例如，找出所有小于 10 亿且是 3 或 5 倍数的自然数之和。您的解在时间上是线性的，但您可以尝试更快的解。这不是您原始问题的一部分；只是一个有趣的补充。

# tcl - grep 双引号内的单词

> ID：11093622
> 
> 赞同：0
> 
> 时间：2012-06-19T02:28:40.853
> 
> 标签：tcl

如何在文件内的双引号内提取单词？例如

```
variable "xxx" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T08:24:04.917

Reading a text file into Tcl is just this:

```
set fd [open $filename]
set data [read $fd]        ;# Now $data is the entire contents of the file
close $fd 
```

To get the *first* quoted string (under some assumptions, notably a lack backslashed double quote characters inside the double quotes), use this:

```
if {[regexp {"([^""]*)"} $data -> substring]} {
    # We found one, it's now in $substring
} 
```

(Doubling up the quote in the brackets is totally unnecessary — only one is needed — but it does mean that the highlighter does the right thing here.)

The simplest method of finding *all* the quoted strings is this:

```
foreach {- substring} [regexp -inline -all {"([^""]*)"} $data] {
    # One of the substrings is $substring at this point
} 
```

Notice that I'm using the same regular expression in each case. Indeed, it's actually good practice to factor such REs (especially if repeatedly used) into a variable of their own so that you can “name” them.

* * *

Combining all that stuff above:

```
set FindQuoted {"([^""]*)"}

set fd [open $filename]
foreach {- substring} [regexp -inline -all $FindQuoted [read $fd]] {
    puts "I have found $substring for you"
}
close $fd 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T04:40:59.717

### 内部匹配

如果您只是在寻找正则表达式，那么您可以使用 TCL 的捕获组。例如：

```
set string {variable "xxx"}
regexp {"(.*)"} $string match group1
puts $group1 
```

这将返回`xxx`，丢弃引号。

### 外部匹配

如果您想匹配文件中的数据而无需直接将文件读入 TCL，您也可以这样做。例如：

```
set match [exec sed {s/^variable "\(...\)"/\1/} /tmp/foo] 
```

这将调用 sed 来查找您想要的匹配部分，并将它们分配给 TCL 变量以进行进一步处理。在此示例中，*匹配*变量设置`xxx`为如上，但操作的是外部文件而不是存储的字符串。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-19T03:46:36.803

When you just want to find with `grep` all words in quotes in a file and do something with the words, you do something like this (in a shell):

```
grep -o '"[^"]*"' | while read word
do
   # do something with $word
   echo extracted: $word
done 
```

# iphone - 无法覆盖 UIScrollView 的“hitTest”方法

> ID：11093626
> 
> 赞同：0
> 
> 时间：2012-06-19T02:28:50.073
> 
> 标签：iphone, uiscrollview, hittest, custom-paging

我创建了一个滚动视图，宽度小于屏幕宽度并设置**clipsToBounds=YES**。由于 UIScrollView 不会从其框架范围之外的任何地方滚动，我将 UIScrollview 放在 UIView 内并尝试覆盖***“(UIView *)hitTest:WithEvent:”***方法。但它总是在***if ([self pointInside:point withEvent:event])*****行中显示警告pointInside 方法未找到**（或类似的东西）并且它不起作用。我做错什么了？提前致谢...

 ** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T02:31:36.087

您必须更改 ScrollView 的 contentSize 才能允许 ScrollView 滚动。它只会滚动 contentSize.x 大于 scrollview.size.x 和/或 contentSize.y 大于 scrollview.size.y。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-21T08:34:46.730

回答我自己的问题，问题是我没有创建 UIVIew 子类来覆盖**(UIView *)hitTest:WithEvent:**而 UIScrollView 在 self.view 的子视图中。因此，检查哪个视图继承了滚动视图并在父视图类中编写重写方法很重要。*

# javascript - jQuery Validate：验证后保留错误

> ID：11093629
> 
> 赞同：3
> 
> 时间：2012-06-19T02:29:46.570
> 
> 标签：javascript, jquery, forms, validation

我有一个简单的登录表单，并让 jQuery 验证在显示错误时替换字段标签。问题是，一旦错误被清除，标签就会消失。我想找到一种方法来恢复到以前标签的内容，或者在该字段有效时重建该标签......

这是我的代码：

```
$(document).ready(function(){
    $("#login").validate({
        errorPlacement: function(error, element) {
            element.prev().replaceWith(error);
        },
        rules: {
            "email": {
                required: true,
                email:true,
            },
            "password": {
                required: true,
                minlength: 6
            }
        },
        messages: {
            email: {
                required: "Please enter your email address.",
                email: "Please enter a <u>valid</u> email address"
            },
            password: {
                required: "Please enter your password.",
                minlength: "Please enter a password with 6 characters or more."
            }
        },
    });
}); 
```

和 HTML：

```
<form name="login" id="login" method="post" action="authenticate.php">
<p>
    <label for="email">Email Address:</label>
    <input type="text" name="email" id="email" class="required email" />
</p>
<p>
    <label for="password">Password:</label>
    <input type="password" name="password" id="password" class="required" />
</p>
<p>
    <input type="submit" value="Log In" id="submit" />
</p> 
```

本质上，当用户提交表单时，如果电子邮件字段中没有数据，那么电子邮件的标签就会被错误替换。但是一旦它有有效的输入，我想放回原来的标签。

在此先感谢您的任何建议，

Z

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T17:25:28.020

我实际上制定了一个折衷方案，而不是用错误标签替换以前的标签，而是使用 error.appendTo(element.prev()) 和 errorElement: "span" 将跨度附加到该标签中。这是新代码：

```
 $(document).ready(function(){
            $("#login").validate({
                errorElement: "span",
                errorPlacement: function(error, element) {
                    error.appendTo(element.prev());
                    //element.prev().replaceWith(error);
                },
                rules: {
                    "email": {
                        required: true,
                        email:true,
                    },
                    "password": {
                        required: true,
                        minlength: 6
                    }
                },
                messages: {
                    email: {
                        required: " is Required",
                        email: " is Improperly Formatted"
                    },
                    password: {
                        required: " is Required",
                        minlength: " is not Long Enough"
                    }
                },
            });
        }); 
```

它不太理想，但至少当跨度出现时，错误代码是我想要的，当它消失时，标签保持不变。我只是这样做了，所以标签和错误像句子一样相互补充......例如，“电子邮件地址”“是必需的。” 或“电子邮件地址”“格式不正确。”

感谢所有在这里做出贡献的人，

Z

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T02:45:04.627

你可以删除

```
errorPlacement: function(error, element) {
         element.prev().replaceWith(error);
     }, 
```

并且消息应该出现在文本框旁边。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T02:38:04.813

您可以尝试删除Child（标签），并在错误发生时附加一个新的。切换标签似乎有意义

# php - PHP检测子文件夹字符串并解析字符串

> ID：11093630
> 
> 赞同：0
> 
> 时间：2012-06-19T02:29:54.220
> 
> 标签：php, string

所以我有一个简单的变量来检测我网站中的 /en/ 或 /sp/ 子文件夹并将这些字母放入我的 html 类中 - 现在我只是说如果页面不是介绍而不是 echo 'en'，我该怎么做检测 $page 是否包含“en”或“sp” - 基本上在我想要的网站的英文部分`<html class="home en"`和西班牙文部分`<html class="home sp"`

```
$page = $_SERVER['REQUEST_URI']; 
$page = str_replace('/', '', $page); 
$page = str_replace('.php', '', $page); 
$page = str_replace('?s=', '', $page);
$page = str_replace('en', '', $page);
$page = str_replace('sp', '', $page);
$page = $page ? $page : 'intro';

<html class="<?php echo $page ; if($page !== 'intro')echo ' en'; ?>"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T02:34:04.937

您可以使用**strpos**或**stripos**功能检测到这一点。更多关于它的 PHP 手册：[http ://si.php.net/manual/en/function.strpos.php](http://si.php.net/manual/en/function.strpos.php)

```
$isSpanish = stripos ($page, "/sp/");

if ($isSpanish !== FALSE)
{
    // Logic here
} 
```

# ipad - 如何在同一个应用程序之间广播数据，但在一个公共 LAN 内的不同 ipad 上

> ID：11093631
> 
> 赞同：0
> 
> 时间：2012-06-19T02:30:04.673
> 
> 标签：ipad, p2p, lan

我希望能够在单个 LAN 上拥有多个 iPad，每个 iPad 都运行相同的应用程序，并且能够进行点对点广播。

这需要是点对点广播（无服务器），或者如果必须，我可以指定一个应用程序作为本地服务器来接收和重新发送事件。但是信息不应该离开局域网（所以没有云服务器）。

一个简单的示例是具有单个按钮的应用程序。此应用程序的每个实例都将配置一个唯一 ID（例如 1-10）。当任何用户在 LAN 上的任何位置触摸该按钮时，运行此应用程序的所有其他 iPad 将显示该按钮已被按下的 LAN 上其他位置的应用程序实例的编号。

这似乎应该是一项基本功能，但我很难找到它在 IOS 中是否可行。任何人都可以确认它是以及如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T02:34:08.723

您可以将其设置为在局域网的广播 ip 上广播。并像多播地址一样使用它。

前任。192.168.1.0/24 广播/收听 192.168.1.255

唯一的缺点是它将被发送到局域网上的每个设备。

[编辑] vv

或者，如果您指定一个服务器作为服务器，您可以将服务器 IP 地址作为广播进行宣传。

# php - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 2 行的 '''')' 附近使用正确的语法

> ID：11093634
> 
> 赞同：4
> 
> 时间：2012-06-19T02:30:22.330
> 
> 标签：php, mysql, insert

我在 MySQL 中遇到错误：

```
You have an error in your SQL syntax; check the manual that corresponds 
to your MySQL server version for the right syntax to use near '''')' at line 2'. 
```

HTML 代码：

```
<form action="read_message.php" method="post">
  <table class="form_table">
    <tr>
      <td style="font-weight:bold;">Subject:</td>
      <td><input style=" width:300px" name="form_subject"/></td>
      <td></td>
    </tr>
    <tr>
      <td style="font-weight:bold;">Message:</td>
      <td id="myWordCount">&nbsp;(300 words left)</td>
      <td></td>
    </tr>
    <tr>
      <td><input type="hidden" name="sender_id" value="<?php echo $sender_id?>"></td>
      <td><textarea cols="50" rows="4" name="form_message"></textarea></td>
      <td valign="bottom"><input type="submit" name="submit_message" value="send"></td>
    </tr>
  </table>
</form> 
```

插入mysql表的代码：

```
<?php
  include_once"connect_to_mysql.php";
  //submit new message
  if($_POST['submit_message']){

    if($_POST['form_subject']==""){
      $submit_subject="(no subject)";
    }else{
      $submit_subject=$_POST['form_subject'];   
    }
    $submit_message=$_POST['form_message'];
    $sender_id = $_POST['sender_id'];
    if($shortMessagesLeft<1){
      $form_error_message='You have left with '.$shortMessagesLeft.' Short Message. Please purchase it from the <a href="membership.php?id='.$id.'">shop</a>.';
    }
    else if($submit_message==""){
      $form_error_message = 'Please fill in the message before sending.';
    }
    else{
      $message_left = $shortMessagesLeft-1;
      $update_short_message = mysql_query("UPDATE message_count SET short_message = '$message_left' WHERE user_id = '$id'");
      $sql = mysql_query("INSERT INTO private_messages (to_id, from_id, time_sent, subject, message) 
        VALUES('$sender_id', '$id', now(),'$submit_subject','$submit_message')") or die (mysql_error());
    }
  }

?> 
```

错误是什么意思，我做错了什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-19T02:36:56.843

`$submitsubject`在or中有一个单引号`$submit_message`

为什么这是个问题？

单引号字符终止 MySQL 中的字符串以及所有被视为 sql 命令的内容。你**真的**不想那样写你的sql。充其量，您的应用程序会间歇性中断（正如您所观察到的），而在最坏的情况下，您刚刚引入了一个巨大的安全漏洞。

想象一下，如果有人`'); DROP TABLE private_messages;`在提交消息中提交。

您的 SQL 命令将是：

```
INSERT INTO private_messages (to_id, from_id, time_sent, subject, message) 
        VALUES('sender_id', 'id', now(),'subjet','');

DROP TABLE private_messages; 
```

相反，您需要正确清理您的价值观。

至少，您必须运行每个值，`mysql_real_escape_string()`但您确实应该使用准备好的语句。

如果您使用的是`mysql_real_escape_string()`您的代码，则如下所示：

```
if($_POST['submit_message']){

if($_POST['form_subject']==""){
    $submit_subject="(no subject)";
}else{
    $submit_subject=mysql_real_escape_string($_POST['form_subject']); 
}
$submit_message=mysql_real_escape_string($_POST['form_message']);
$sender_id = mysql_real_escape_string($_POST['sender_id']); 
```

这是[一篇](http://net.tutsplus.com/tutorials/php/why-you-should-be-using-phps-pdo-for-database-access/)关于准备好的陈述和 PDO 的精彩文章。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-19T02:37:54.243

这称为 SQL 注入。`'`尝试在 mysql 查询中打开/关闭字符串。您应该始终转义进入查询的任何字符串。

例如，

而不是这个：

```
"VALUES ('$sender_id') " 
```

做这个：

```
"VALUES ('". mysql_real_escape_string($sender_id)  ."') " 
```

（或等效的，当然）

但是，最好使用 PDO、命名参数、预准备语句或许多其他方式自动执行此操作。关于这个和 SQL 注入的研究（[这里](https://stackoverflow.com/questions/60174/best-way-to-prevent-sql-injection-in-php)你有一些技术）。

希望能帮助到你。干杯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-20T09:36:08.900

请确保您已完全下载 sqldump，当我们尝试导入一半/不完整下载的 sqldump 时，此问题很常见。请检查您的 sqldump 文件的大小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-17T21:30:30.937

当我使用此代码更新记录时，我遇到了同样的错误：

```
@mysqli_query($dbc,$query or die())) 
```

删除后`or die`，它开始正常工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-30T17:05:06.617

我之前遇到过这个问题，原因很简单：检查你的变量，如果有字符串，所以把它放在引号 '$your_string_variable_here' 中，如果是数字，不要加引号。例如，如果我有这些数据： $name（它将是字符串）$phone_number（它将是数字）所以，它将是这样的：

$query = "INSERT INTO `users`( `name`, `phone`) VALUES ('$name', $phone)"; 就这样，它会被修复的^_^

# javascript - 如何在notes客户端关闭xpages？我使用 CSJS window.close 但它不起作用

> ID：11093639
> 
> 赞同：2
> 
> 时间：2012-06-19T02:31:29.643
> 
> 标签：javascript, xpages, xpinc

我正在做一个 xpinc 应用程序。

我按照[此处](http://www-10.lotus.com/ldd/ddwiki.nsf/dx/Whats_New_in_852_for_XPages#window.close%28%29+support)的示例进行了修改。目前关闭按钮在我的主页上。

客户想要一个关闭按钮而不是正常的“X”来关闭。但是这个例子表明我应该创建 2 个 xpage。

在 page1 上，我应该创建一个按钮，`window.open(xpage2.xsp)`然后`window.close()`在 xpage2 中的一个按钮中才能工作。`window.close()`当我没有`window.open()`开始的时候我该怎么办？

我检查了 Demo Discussion xpage 和 OneUI 但没有类似的东西。我尝试放置`window.open(xpage1.xsp)`xpage1 onClientLoad 事件，但这也不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-08-31T18:26:06.003

我今天遇到了同样的问题，发现了 Fredrik Norling 的这篇非常有趣的文章，它有帮助： [http ://www.xpagedeveloper.com/2013/ibm-notes-domino-9-01-xpages-fixlist](http://www.xpagedeveloper.com/2013/ibm-notes-domino-9-01-xpages-fixlist)

有一个新的 notes.ini (client) 参数：

```
XPagesXulAllowScriptsToCloseWindows=1
```

连同 SSJS 代码

```
view.postScript("window.close()");
```

为我工作 - Notes 客户端中的选项卡/窗口可以从 XPage 关闭。

奇怪的是我们必须添加这个参数，也许它与安全有关......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-19T02:41:49.967

只有当页面由 window.open 打开时，window.close 才能正常工作。否则它不起作用。请看下面的问题，同样的问题已经出现在 stackoverflow 中。

[如何关闭xpages？](https://stackoverflow.com/questions/9682492/how-do-i-close-my-window-in-xpage)

对于我的项目，我将页面重定向到我的主页。

我也在寻找解决这个问题的好方法。

# cocoa - 覆盖活动 NSMenu 的 keydown 行为

> ID：11093640
> 
> 赞同：10
> 
> 时间：2012-06-19T02:31:31.017
> 
> 标签：cocoa, nsmenu

想知道是否有人可以帮助解决这个问题。

我在系统状态栏中有一个由 NSStatusItem 托管的 NSMenu。

由于各种原因，我想覆盖 NSMenu 的默认按键行为，称为“类型选择”。本质上，当菜单处于活动状态时，您按下一个键，菜单就会突出显示标题中具有匹配前导字符的项目。

我想禁用此行为并定义我自己的一些行为。

问题？NSMenuDelegate 中没有 keyDown 事件的挂钩。子类化 NSMenu 是不行的，因为它无论如何都不会从 NSResponder 继承。所以那里也没有。

查看 NSMenu、NSMenuDelegate、NSMenuItem，没有明确的证据证明 NSResponder 实际处理了驱动默认“类型选择”行为的 keyDown 事件。

任何见解将不胜感激。如果还没有意义，我很乐意澄清我的问题。

谢谢！

# r - 如何在 R 中制定一个 for in 循环，我可能想循环零次？

> ID：11093649
> 
> 赞同：6
> 
> 时间：2012-06-19T02:32:51.030
> 
> 标签：r, for-loop, idioms

我想循环从 开始的一系列数字`1:n`，什么时候`n`是 R 中向量的长度`v`。通常，我会使用`for (i in 1:length(v))`语法，但是当`n == 0`.

执行此循环的惯用方式是什么？目前我做了以下操作，但看起来有点难看：

```
# This is in my standard library
rng <- function(n)seq(from=1, to=n, length.out=n)

# Now when I come to the for loop:
for(i in rng(length(v))){
   print(paste("I ate", i, "kg of brocolli today"))
} 
```

是的，我知道矢量化更好，但是在某些情况下矢量化是不可能的，或者需要大量额外的工作，以至于阅读代码变得更加困难。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-19T02:40:01.640

最好使用`seq_along`：

```
> v <- letters[1:3]
> for (i in seq_along(v)) print(c(i, v[i]))
[1] "1" "a"
[1] "2" "b"
[1] "3" "c"
> 
> v <- numeric(0)
> for (i in seq_along(v)) print(c(i, v[i])) 
```

# php - 如何从 mysql 表中获取自动递增字段名称或主键字段名称？

> ID：11093650
> 
> 赞同：7
> 
> 时间：2012-06-19T02:32:57.323
> 
> 标签：php, mysql, primary-key, auto-increment

在 PHP 中，如何获取已设置为在添加新记录时自动递增的字段的字段名称？

在大多数情况下，它与表的 PRIMARY_KEY 相同，但不一定总是如此。

所以这个问题有两部分，第二部分分为第三部分。

1-如何获取自动递增字段名称的名称...

2-如何获取primary_key字段名称的名称...

2.1 表使用多个字段作为主键时如何获取primary_key(s)信息...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-19T02:48:34.907

如果要获取表的主键列，可以使用以下代码：

```
SELECT k.COLUMN_NAME
FROM information_schema.table_constraints t
LEFT JOIN information_schema.key_column_usage k
USING(constraint_name,table_schema,table_name)
WHERE t.constraint_type='PRIMARY KEY'
    AND t.table_schema=DATABASE() 
    AND t.table_name='tbName';    -- the name of your table 
```

要获取自动递增的字段，请尝试以下操作：

```
SELECT Auto_increment 
FROM information_schema.tables 
WHERE table_name   = 'tbName'  
  AND table_schema = DATABASE(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T02:54:53.237

You can get the table information using the `SHOW COLUMNS FROM table`. Something like this:

```
$res = $mysqli->query('SHOW COLUMNS FROM tablename');

while($row = $res->fetch_assoc()) {
  if ($row['Extra'] == 'auto_increment')
    echo 'Field with auto_increment = '.$row['Field'];
  if ($row['Key'] == 'PRI')
    echo 'Field with primary key = '.$row['Field'];
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T02:42:06.783

您可以使用`SHOW COLUMNS`命令获取这些信息。 [更多信息](http://dev.mysql.com/doc/refman/5.0/en/show-columns.html)

示例：假设您有一个名为 City 的表。查看表属性的查询将是：

```
mysql> SHOW COLUMNS FROM City;

...And the result:
+------------+----------+------+-----+---------+----------------+
| Field      | Type     | Null | Key | Default | Extra          |
+------------+----------+------+-----+---------+----------------+
| Id         | int(11)  | NO   | PRI | NULL    | auto_increment |
| Name       | char(35) | NO   |     |         |                |
| Country    | char(3)  | NO   | UNI |         |                |
| District   | char(20) | YES  | MUL |         |                |
| Population | int(11)  | NO   |     | 0       |                |
+------------+----------+------+-----+---------+----------------+ 
```

这是来自[http://dev.mysql.com/doc/refman/5.0/en/show-columns.html](http://dev.mysql.com/doc/refman/5.0/en/show-columns.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-19T02:46:32.817

可以查询`information_schema`数据库：

```
SELECT column_name, column_key, extra 
FROM information_schema.columns 
WHERE table_schema=DATABASE() AND table_name='tablename'; 
```

*   遗嘱由`column_key`密钥类型组成，即`PRI`,`MUL`等。
*   该`extra`列将包含`auto_increment`自动增量列。

请注意，`information_schema`数据库是“全局的”，因此您必须始终传递相应的数据库（专门或通过`DATABASE()`当前数据库）*和*表，否则您最终会得到一个 BIG 结果集。

# java - 如何使用javacv识别具有可变长度和宽度的正方形或矩形？

> ID：11093654
> 
> 赞同：9
> 
> 时间：2012-06-19T02:33:26.963
> 
> 标签：java, image-processing, opencv, javacv

我正在使用java开发项目来识别使用opencv包的组件，但我是javacv的新手，我只想知道如何识别特定源图像中的矩形请一些有经验的人提供一些基本指南来存档这个任务。我尝试在这里使用模板匹配，但它只能识别精确大小的矩形。但在我的情况下，我需要识别可变长度矩形？

```
import java.util.Arrays;
import static com.googlecode.javacv.cpp.opencv_core.*;
import static com.googlecode.javacv.cpp.opencv_imgproc.*;
import static com.googlecode.javacv.cpp.opencv_highgui.*;
public class TestingTemplate {
public static void main(String[] args) {
//Original Image
IplImage src = cvLoadImage("src\\lena.jpg",0);
//Template Image
IplImage tmp = cvLoadImage("src\\those_eyes.jpg",0);
//The Correlation Image Result
IplImage result = cvCreateImage(cvSize(src.width()-tmp.width()+1, src.height()-tmp.height()+1), IPL_DEPTH_32F, 1);
//Init our new Image
cvZero(result);
cvMatchTemplate(src, tmp, result, CV_TM_CCORR_NORMED);

double[] min_val = new double[2];
double[] max_val = new double[2];

//Where are located our max and min correlation points
CvPoint minLoc = new CvPoint();
CvPoint maxLoc = new CvPoint();
cvMinMaxLoc(result, min_val, max_val, minLoc, maxLoc, null); //the las null it's for
 optional mask mat()

System.out.println(Arrays.toString(min_val)); //Min Score
System.out.println(Arrays.toString(max_val)); //Max Score

CvPoint point = new CvPoint();
point.x(maxLoc.x()+tmp.width());
point.y(maxLoc.y()+tmp.height());
cvRectangle(src, maxLoc, point, CvScalar.WHITE, 2, 8, 0); //Draw the rectangule result in original img.
cvShowImage("Lena Image", src);
cvWaitKey(0);
//Release
cvReleaseImage(src);
cvReleaseImage(tmp);
cvReleaseImage(result);
}
} 
```

请有人帮助完成此任务

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-19T15:15:49.050

（所以它固定为正方形。）

对于正方形检测，OpenCV 提供了一些示例。代码采用 C++、C、Python。希望您可以将其移植到 JavaCV。

[C++ 代码](https://github.com/Itseez/opencv/blob/master/samples/cpp/squares.cpp)，[Python 代码](https://github.com/Itseez/opencv/blob/master/samples/python2/squares.py)。

我将仅说明它是如何工作的：

1 - 首先**将图像拆分**为 R、G、B 平面。

2 - 然后为每个平面执行**边缘检测**，除此之外，不同值的**阈**值，如 50、100、...等。

3 - 在所有这些二进制图像中，**找到轮廓**（记住它正在处理很多图像，所以可能有点慢，如果你不想要，你可以删除一些阈值）。

**4 - 找到轮廓后，通过根据区域过滤**去除一些不需要的小噪声。

5 - 然后，**近似轮廓**。（[更多关于轮廓近似](http://opencvpython.blogspot.in/2012/06/contours-2-brotherhood.html)）。

6 - 对于一个矩形，它会给你四个角。对于其他人，将给出相应的角。

因此，根据近似轮廓中的元素数量（应该是四个）过滤这些轮廓，这与角的数量相同。**矩形的第一个属性。**

7 - 接下来，可能有一些具有四个角但不是矩形的形状。所以我们取**矩形的第二个属性，即所有内角都是 90**。所以我们使用下面的关系找到所有角落的角度：

![在此处输入图像描述](../Images/7cb1015ae43d45ad8593fc79030f71b6.png)

如果 cos (theta) < 0.1，即 theta > 84 度，则为矩形。

8 - 那么广场呢？**使用它的属性，即所有边都相等。**

您可以通过如上所示的关系找到两点之间的距离。检查它们是否都相等，则该矩形是正方形。

这就是代码的工作方式。

下面是我在图像上应用上述代码的输出：

![在此处输入图像描述](../Images/6bfacb8eb1529c4ca75a92c109a3c032.png)

**编辑 ：**

有人询问如何删除在边界检测到的矩形。这是因为，opencv 在黑色背景中找到白色对象，边框也是如此。只需使用 cv2.bitwise_not() 函数反转图像即可解决问题。我们得到如下结果：

![在此处输入图像描述](../Images/16b51e06aa27e7b5d684c49e1478f2d2.png)

您可以在此处找到有关轮廓的更多信息：[轮廓 - 1：入门](http://opencvpython.blogspot.com/2012/06/hi-this-article-is-tutorial-which-try.html)

# iphone - 如何阻止我的 UITableView 上的 reloadData 清除删除确认按钮？

> ID：11093656
> 
> 赞同：0
> 
> 时间：2012-06-19T02:33:36.250
> 
> 标签：iphone, ios, uitableview

所以我有以下内容：

*   带有可删除单元格的 UITableView（滑动单元格然后单击删除按钮的那种）
*   UITableView 的属性（例如 UILabel）`reloadData`由 NSTimer 每秒自动更新（在 UITableView 上调用）（这是必需的）

问题是`reloadData`滑动后调用清除了删除按钮（当然在一秒钟内）。我怎样才能防止这种情况发生？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T04:43:18.227

你可以保留一个布尔标志变量，如果删除按钮可见，则为真，如果不可见，则为假，并且在你调用 reloadData 的地方你可以检查标志值并相应地起作用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T06:14:10.757

我需要做的就是从 NSTimers 调用方法调用中设置 UILabel 文本属性，它甚至不需要`reloadData`调用来更新 UILabel ...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-28T15:55:40.050

当用户滑动 a`UITableViewCell`时，`tableView`的`isEditing`属性将设置为`YES`。您应该在重新加载表之前检查此属性。

# iphone - 两个 UIScrollView 只有一个出现

> ID：11093659
> 
> 赞同：0
> 
> 时间：2012-06-19T02:33:57.623
> 
> 标签：iphone, ios, xcode

所以我`UIscrollview`在我看来是两个。我正在使用`Ray Wenderlich`'s `Custom Image Picker`。但是当我加载它时，只显示 1 个图像选择器。我希望能够加载两个图像选择器。我认为我做错了`initWithCoder`部分。似乎无法正确初始化它。是否有可能有两个 ivars `self`。抱歉，对 iphoneDev 有点陌生。谢谢你的帮助。

这是我的整个实现：

```
- (id) initWithCoder:(NSCoder *)aDecoder {
    if ((self = [super initWithCoder:aDecoder])) {
        _images =  [[NSMutableArray alloc] init];
        _thumbs =  [[NSMutableArray alloc] init];

        //THIS IS WHERE I THINK ITS WRONG but the upper part seems to be okay.
        _images2 =  [[NSMutableArray alloc] init];
        _thumbs2 =  [[NSMutableArray alloc] init];
    }
    return self;
}

- (void)addImage:(UIImage *)image {
    [_images addObject:image];
    [_thumbs addObject:[image imageByScalingAndCroppingForSize:CGSizeMake(60, 60)]];
}
- (void)addImage2:(UIImage *)image {
    [_images2 addObject:image];
    [_thumbs2 addObject:[image imageByScalingAndCroppingForSize:CGSizeMake(60, 60)]];
}

- (void) createScrollView {
    self.slotBg = [[UIView alloc] initWithFrame:CGRectMake(43, 370, 300, 143)];
    CAGradientLayer *gradient = [CAGradientLayer layer];
    gradient.frame = self.slotBg.bounds;
    gradient.colors = [NSArray arrayWithObjects:(id)[[UIColor grayColor] CGColor], (id)[[UIColor whiteColor] CGColor], nil];
    [self.slotBg.layer insertSublayer:gradient atIndex:0];
    [self.view addSubview:self.slotBg];
    UIScrollView *scrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0.0f,0.0f,300.0f,134.0f)];
    [slotBg addSubview:scrollView];

    int row = 0;
    int column = 0;
    for(int i = 0; i < _thumbs.count; ++i) {

        UIImage *thumb = [_thumbs objectAtIndex:i];
        UIButton * button = [UIButton buttonWithType:UIButtonTypeCustom];
        button.frame = CGRectMake(column*60+10, row*60+10, 60, 60);
        [button setImage:thumb forState:UIControlStateNormal];
        [button addTarget:self 
                   action:@selector(buttonClicked:) 
         forControlEvents:UIControlEventTouchUpInside];
        button.tag = i; 

        [scrollView addSubview:button];

        if (column == 4) {
            column = 0;
            row++;
        } else {
            column++;
        }

    }

    [scrollView setContentSize:CGSizeMake(330, (row+1) * 60 + 10)];
}

- (void) createScrollView2 {
    self.slotBg2 = [[UIView alloc] initWithFrame:CGRectMake(362, 370, 300, 143)];
    CAGradientLayer *gradient = [CAGradientLayer layer];
    gradient.frame = self.slotBg.bounds;
    gradient.colors = [NSArray arrayWithObjects:(id)[[UIColor grayColor] CGColor], (id)[[UIColor whiteColor] CGColor], nil];
    [self.slotBg.layer insertSublayer:gradient atIndex:0];
    [self.view addSubview:self.slotBg];

    UIScrollView *scrollView2 = [[UIScrollView alloc] initWithFrame:CGRectMake(0.0f,0.0f,300.0f,134.0f)];
    [slotBg addSubview:scrollView2];

    int row = 0;
    int column = 0;
    for(int i = 0; i < _thumbs2.count; ++i) {

        UIImage *thumb = [_thumbs2 objectAtIndex:i];
        UIButton * button = [UIButton buttonWithType:UIButtonTypeCustom];
        button.frame = CGRectMake(column*60+10, row*60+10, 60, 60);
        [button setImage:thumb forState:UIControlStateNormal];
        [button addTarget:self 
                   action:@selector(buttonClicked2:) 
         forControlEvents:UIControlEventTouchUpInside];
        button.tag = i; 

        [scrollView2 addSubview:button];

        if (column == 4) {
            column = 0;
            row++;
        } else {
            column++;
        }

    }

    [scrollView2 setContentSize:CGSizeMake(330, (row+1) * 60 + 10)];

}

- (IBAction)buttonClicked:(id)sender {
    NSUserDefaults *prefs = [NSUserDefaults standardUserDefaults];
    NSInteger slotBG = [prefs integerForKey:@"integerKey"];

    if(slotBG == 1){
    UIButton *button = (UIButton *)sender;
    [button removeFromSuperview];
    [_images objectAtIndex:button.tag];
    [_images removeObjectAtIndex:button.tag];

    NSFileManager *fileManager = [NSFileManager defaultManager];
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *fullPath = [documentsDirectory stringByAppendingPathComponent:[NSString stringWithFormat:@"oneSlotImages%lu.png", button.tag]];
    [fileManager removeItemAtPath: fullPath error:NULL];
    NSLog(@"image removed");
    } else if (slotBG == 2){
        UIButton *button = (UIButton *)sender;
        [button removeFromSuperview];
        [_images objectAtIndex:button.tag];
        [_images removeObjectAtIndex:button.tag];

        NSFileManager *fileManager = [NSFileManager defaultManager];
        NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
        NSString *documentsDirectory = [paths objectAtIndex:0];
        NSString *fullPath = [documentsDirectory stringByAppendingPathComponent:[NSString stringWithFormat:@"firstSlotImages%lu.png", button.tag]];
        [fileManager removeItemAtPath: fullPath error:NULL];
        NSLog(@"image removed");

    } else if (slotBG == 3){
        UIButton *button = (UIButton *)sender;
        [button removeFromSuperview];
        [_images objectAtIndex:button.tag];
        [_images removeObjectAtIndex:button.tag];

        NSFileManager *fileManager = [NSFileManager defaultManager];
        NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
        NSString *documentsDirectory = [paths objectAtIndex:0];
        NSString *fullPath = [documentsDirectory stringByAppendingPathComponent:[NSString stringWithFormat:@"oneSlotImages%lu.png", button.tag]];
        [fileManager removeItemAtPath: fullPath error:NULL];
        NSLog(@"image removed");
    }   
}

- (IBAction)buttonClicked2:(id)sender {
    UIButton *button2 = (UIButton *)sender;
    [button2 removeFromSuperview];
    [_images2 objectAtIndex:button2.tag];
    [_images2 removeObjectAtIndex:button2.tag];

    NSFileManager *fileManager = [NSFileManager defaultManager];
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *fullPath = [documentsDirectory stringByAppendingPathComponent:[NSString stringWithFormat:@"secondSlotImages%lu.png", button2.tag]];
    [fileManager removeItemAtPath: fullPath error:NULL];
    NSLog(@"image removed");
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    NSInteger slotBG = [prefs integerForKey:@"integerKey"];

    if(slotBG == 1){
        [mode1 setHighlighted:YES];

        for(int i = 0; i <= 100; i++) 
        { 
            NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
            NSString *documentsDir = [paths objectAtIndex:0];

            NSString *savedImagePath = [documentsDir stringByAppendingPathComponent:[NSString stringWithFormat:@"oneSlotImages%d.png", i]]; 
            NSLog(@"savedImagePath=%@",savedImagePath);
            if([[NSFileManager defaultManager] fileExistsAtPath:savedImagePath]){ 
                [self addImage:[UIImage imageWithContentsOfFile:savedImagePath]]; 

                NSLog(@"file exists");
            } 
        } 
            NSLog(@"Count : %d", [_images count]);
        [self createScrollView];

    } else if(slotBG == 2 ){
        [mode2 setHighlighted:YES];
        for(int i = 0; i <= 100; i++) 
        { 

            NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
            NSString *documentsDir = [paths objectAtIndex:0];

            NSString *savedImagePath = [documentsDir stringByAppendingPathComponent:[NSString stringWithFormat:@"firstSlotImages%d.png", i]]; 
            NSLog(@"savedImagePath=%@",savedImagePath);
            if([[NSFileManager defaultManager] fileExistsAtPath:savedImagePath]){ 
                [self addImage:[UIImage imageWithContentsOfFile:savedImagePath]]; 

                NSLog(@"file exists");
            } 
        }
            NSLog(@"Count : %d", [_images count]);  

            [self createScrollView];

        for(int i = 0; i <= 100; i++) 
        { 
                    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
            NSString *documentsDir = [paths objectAtIndex:0];

            NSString *savedImagePath = [documentsDir stringByAppendingPathComponent:[NSString stringWithFormat:@"secondSlotImages%d.png", i]]; 
            NSLog(@"savedImagePath=%@",savedImagePath);
            if([[NSFileManager defaultManager] fileExistsAtPath:savedImagePath]){ 
                [self addImage2:[UIImage imageWithContentsOfFile:savedImagePath]]; 
                 NSLog(@"file exists");
            } 
        }
        NSLog(@"Count : %d", [_images2 count]);  

        [self createScrollView2];

    }  else if( slotBG == 3){
        [mode3 setHighlighted:YES];

        for(int i = 0; i <= 100; i++) 
        { 
            NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
            NSString *documentsDir = [paths objectAtIndex:0];

            NSString *savedImagePath = [documentsDir stringByAppendingPathComponent:[NSString stringWithFormat:@"oneSlotImages%d.png", i]]; 
            NSLog(@"savedImagePath=%@",savedImagePath);
            if([[NSFileManager defaultManager] fileExistsAtPath:savedImagePath]){ 
                [self addImage:[UIImage imageWithContentsOfFile:savedImagePath]]; 

                NSLog(@"file exists");
            } 
        } 
        NSLog(@"Count : %d", [_images count]);
        [self createScrollView];

    }     

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T02:47:33.667

在您的`createScrollView2`方法中，您分配 self.slotBg2，但在添加到您的视图时仅引用 self.slotBg。然后你将你的 scrollview2 添加到原来的 slotBg 中。

# jvm - 关注 java GC 选项 Xminf

> ID：11093665
> 
> 赞同：0
> 
> 时间：2012-06-19T02:34:29.443
> 
> 标签：jvm, websphere

关于 java GC option **`-Xminf`**，它指定垃圾回收后应该空闲的堆的最小百分比。如果可用空间低于此数量，JVM 会尝试扩展堆。

但是，关于免费百分比，我在这里有一个问题。该值是如何计算的？是从**`100%*freeHeap/AllocatedHeap`**还是**`100%*freeHeap/MaximumHeap`**？因为它不同，你知道，请帮助我。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T21:04:38.923

Its rather freeHeap/AllocatedHeap. And it is not percentage but a decimal number between 0 and 1\. Default value is 0.3.

# hadoop - 运行 accumulo init 时出错

> ID：11093674
> 
> 赞同：1
> 
> 时间：2012-06-19T02:35:42.283
> 
> 标签：hadoop, apache-zookeeper, accumulo

我有 Hadoop 和 Zookeeper 运行 w/oa 问题但是当我去运行时`$ACCUMULO_HOME/bin/accumulo init`，会发生这种情况：

```
Exception in thread "main" java.lang.NoClassDefFoundError: org/apache/accumulo/start/Platform
Caused by: java.lang.ClassNotFoundException: org.apache.accumulo.start.Platform
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
Exception in thread "main" java.lang.NoClassDefFoundError: org/apache/accumulo/start/Main
Caused by: java.lang.ClassNotFoundException: org.apache.accumulo.start.Main
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247) 
```

我找不到任何有用的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T06:33:08.590

尝试从源代码运行而不使用 Maven 编译时会发生此错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-23T22:46:14.420

我想这可能现在已经解决了？

如果没有，看起来 Accumulo 没有正确编译。

如果您使用 Binary Dist，请运行以下命令进行编译。

> mvn 包 -P 组装

# iphone - self performSelector:@selector(loadData) withObject:nil - 不工作

> ID：11093679
> 
> 赞同：0
> 
> 时间：2012-06-19T02:36:06.850
> 
> 标签：iphone, self, performselector

我使用： self performSelector:@selector(loadData) withObject:nil ... 看起来只在“loadData”中使用某些命令，但其余的不是。

这是我的viewdidload：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    [mActivity startAnimating];
    [self performSelector:@selector(loadData) withObject:nil afterDelay:2];
    //[mActivity stopAnimating];
} 
```

这是加载数据：

```
 -(void)loadData
{
    [mActivity startAnimating];
    NSLog(@"Start LoadData");
    AppDelegate *delegate=(AppDelegate *)[[UIApplication sharedApplication] delegate];
    NSString *selectData=[NSString stringWithFormat:@"select * from k_proverb ORDER BY RANDOM()"];
    qlite3_stmt *statement;
    if(sqlite3_prepare_v2(delegate.db,[selectData UTF8String], -1,&statement,nil)==SQLITE_OK){
        NSMutableArray *Alldes_str = [[NSMutableArray alloc] init];
        NSMutableArray *Alldes_strAnswer = [[NSMutableArray alloc] init];
        while(sqlite3_step(statement)==SQLITE_ROW)
        {
            NSString *des_strChk= [NSString stringWithUTF8String:(char *)sqlite3_column_text(statement,3)];
            if ([des_strChk isEqualToString:@"1"]){ 
                NSString *des_str= [NSString stringWithUTF8String:(char *)sqlite3_column_text(statement,4)];
                [Alldes_str addObject:des_str];
            }
        }
        Alldes_array = Alldes_str;
        Alldes_arrayAnswer = Alldes_strAnswer;
    }else{
        NSLog(@"ERROR '%s'",sqlite3_errmsg(delegate.db));
    }
    listOfItems = [[NSMutableArray alloc] init];
    NSDictionary *desc = [NSDictionary dictionaryWithObject:
                          Alldes_array forKey:@"description"];
    [listOfItems addObject:desc];
    //[mActivity stopAnimating];
    NSLog(@"Finish loaData");} 
```

它只给我打印 2 行，但没有将我的数据加载到表中，但是如果我从“loadData”内部复制所有代码并过去在“viewDidLoad”中，它将数据加载到表中。

请提供任何建议或帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T03:19:19.210

一些事情：如果你看到任何 NSLog 输出，那么 performSelector 是成功的。您应该更改问题的标题。

如果您尝试将数据加载到表中，则该方法应以告诉 UITableView 重新加载数据（或使用开始/结束更新更精细的加载）结束。

如果 listOfItems 是支持该表的数据，请首先通过硬编码以下内容来使其正常工作：

```
 -(void)loadData {

    listOfItems = [NSArray arrayWithObjects:@"test1", @"test2", nil];
    [self.tableView reloadData];
    return;

    // keep all of the code you wrote here.  it won't run until you remove the return
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (!cell) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    NSString *string = [listOfItems objectAtIndex:indexPath.row];
    cell.textLabel.text = string;
    return cell;

    // keep all of the code you probably wrote for this method here.
    // as above, get this simple thing running first, then move forward
} 
```

祝你好运！

# facebook-graph-api - 脸书成就

> ID：11093680
> 
> 赞同：0
> 
> 时间：2012-06-19T02:36:17.950
> 
> 标签：facebook-graph-api, achievements

文档：[https ://developers.facebook.com/docs/achievements/](https://developers.facebook.com/docs/achievements/)

> 每个成就都必须拥有一个带有相应 Open Graph 协议`<meta>`标签的唯一 URL。我们将抓取成就的唯一 URL，并使用标签中提供的信息来生成 Ticker 故事。Ticker 故事将重定向到成就的唯一 URL。

**所以每个成就只需要一个 HTML 文件，里面只有元标记？** 这对我来说似乎很奇怪，所以我只想确认一下。由于您仍然必须通过 API 调用“创建”成就（不同于将其授予用户），我不明白为什么这还不够。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T07:04:55.270

你有什么问题？如果是“我肯定需要一个带有 Facebook 爬虫元标记的页面吗？” 答案是“是”

您可以通过 URL 参数以编程方式生成标签，如果您愿意，可以将访问这些 URL 的任何非 Facebook 爬虫用户重定向到其他地方

# django - 将 csv 导入 heroku postgres

> ID：11093687
> 
> 赞同：1
> 
> 时间：2012-06-19T02:37:30.307
> 
> 标签：django, postgresql, heroku

我成功部署了我的第一个 Django/Heroku 应用程序，现在我只需要传输我的数据库。它以前在 Win7 PC 上的 MySql 数据库上。我四处寻找将 csv 导入 Heroku 数据库的方法，但没有找到任何东西。他们建议使用 ruby​​ gem 来执行此操作，或者使用`taps`and this command: `heroku db:push mysql://root:mypass@localhost/mydb`。我的数据库很小，只有大约 1000 列和 2 个表，因此导入 CSV 文件非常简单，但我找不到如何去做。有谁知道？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T04:01:18.603

这里有一些想法可以让你快速上手：

首先，一种快速而肮脏的方法：

*   在本地机器上安装 Postgres。
*   将 CSV 导入本地 Postgres 数据库。
*   [将该数据库推送到 Heroku](https://devcenter.heroku.com/articles/taps#import_push_to_heroku)。

或者，一种稍微不那么快但仍然有点脏的方法：

*   使用[`CSV reader`](http://docs.python.org/library/csv.html#csv.reader)Python 模块。
*   在您的 Django 应用程序中创建一个加载 CSV 的任务，遍历每个 CSV 行，创建一个新的相应模型，如果模型有效，则将其保存在服务器的数据库中。
*   通过 heroku CLI 运行任务。
*   完成并验证服务器数据库后，您可以从存储库中删除任务和 CSV。

否则，[`taps`](https://devcenter.heroku.com/articles/taps)也可能适合你！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-19T04:39:03.437

根据[在此处输入链接描述](http://postgresguide.com/utilities/copy.html)，您可以使用复制命令将 CSV 从本地文件系统加载到 postgres 中。您应该能够将其与您的 Heroku DB 一起使用，类似于：

PGPASSWORD=密码这里 psql -h 主机名 -U 用户名 dbname -c "\copy ..."

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-08-13T07:12:33.553

您可以通过以下命令将本地 csv 文件作为表导入 heroku postgres

```
PGPASSWORD=<your password> psql -h <your heroku host> -U <heroku user> <heroku postgres database name> -c "\copy bank (ifsc, bank_id, branch, address, city, district, state, bank_name) FROM '<local file path location>' CSV HEADER DELIMITER E'\t';" 
```

请根据您的需要更改 DELIMITER 值。分隔符值前的'E'表示该命令包含转义字符，否则将；抛出异常

# algorithm - 寻找强连接组件？

> ID：11093690
> 
> 赞同：0
> 
> 时间：2012-06-19T02:37:56.193
> 
> 标签：algorithm, graph, computer-science

我的书定义了一种在线性时间内找到有向图的强连通分量的方法。此外，其他几种寻找强连通分量的算法（即 Tarjan 算法）也能够在线性时间内找到分量。

然而，所有这些算法都要求图的顶点以递减*的后*值排序（顶点离开的时间）。Mergesort 等常见的排序算法需要 O(n log n) 时间。

***因此，如果按post*值对顶点列表进行排序需要 O(n log n) 时间，这些算法如何在线性时间内完成对强连通分量的定位？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T03:28:09.060

由于“时间”（用于测量后置值的类型）作为时间（深度优先搜索程序执行的步数）的函数是单调非递减的，因此只需在遍历离开它。在遍历结束时，列表按排序顺序排列。

或者，由于后值是多项式以上的整数，因此在某些机器模型上，可以使用例如基数排序在线性时间对它们进行排序。

# javascript - 列表框选择计数不起作用 不起作用

> ID：11093694
> 
> 赞同：0
> 
> 时间：2012-06-19T02:38:16.117
> 
> 标签：javascript, html

我最近尝试制作一个带有多个选择框的表单。当有人选择选项时，所选选项的数量将显示在另一个文本上。我是 JavaScript 的初学者。

该函数被调用，但它不计算所选选项的数量。

```
<select name="element_17_1[ ]"
        size="7" multiple="multiple"
        class="element select medium"
        id="element_17_1[ ]"
        onfocus="selectCount(this.form);"
        onClick="selectCount(this.form);"
    >
    <option value="Opt1">Opt1</option>
    <option value="Opt2">Opt2</option>
    <option value="Opt3">Opt3</option>
    <option value="Opt4">Opt4</option>
    <option value="Opt5">Opt5</option>
    <option value="Opt6">Opt6</option>
    <option value="Opt7">Opt7</option>
</select> 
```

这是我在`<head>`

```
function selectCount(f) {
    var selObj = myForm.elements['element_17_1[]'];
    var totalChecked = 0;
    for (i = 0; i < selObj.options.length; i++) {
        if (selObj.options[i].selected) {
            totalChecked++;
        }
    }
    f.element_9.value = totalChecked;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T02:56:39.887

You're trying to get an element named `element_17_1[]`, but your select box is named `element_17_1[ ]`. JavaScript just sees the name as a bunch of characters, and that space makes a difference.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T03:11:15.583

更改您选择的名称`name="element_17_1"`和 ID `id="element_17_1"`，并且您的功能中也没有`myForm`，因此`var selObj = myForm.elements['element_17_1'];`应该如此`var selObj = f.elements['element_17_1'];`，您也只能在事件中使用，如下所示

```
onChange="selectCount(this.form);" 
```

代替

```
onfocus="selectCount(this.form);"
onClick="selectCount(this.form);" 
```

**功能齐全：**

```
function selectCount(f) {
    var selObj = f.elements['element_17_1'];
    var totalChecked = 0;
    for (i = 0; i < selObj.options.length; i++) {
        if (selObj.options[i].selected) {
            totalChecked++;
        }
    }
    f.element_9.value = totalChecked;
} 
```

**更新：**

对于您`php script`，您可以保留选择的名称`name="element_17_1[]"`，因此在函数中它应该是`var selObj = f.elements['element_17_1[]'];`但没有空格`[ ]`

[**演示。**](http://jsfiddle.net/heera/Y4ptn/6/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T03:11:47.083

在您的 HTML 中，您有：

```
> <select name="element_17_1[ ]"
>          size="7" multiple="multiple"
>          class="element select medium"
>          id="element_17_1[ ]"
>          onfocus="selectCount(this.form);"
>          onClick="selectCount(this.form);"
>      > 
```

请注意，在侦听器中，`this`引用元素本身，所以只需传递：

```
 onfocus="selectCount(this);"
           onClick="selectCount(this);" 
```

所以对元素的引用直接传递给函数，可以是：

```
function selectCount(selObj) {

    // The following line isn't needed now
    // var selObj = myForm.elements['element_17_1[]'];

    var totalChecked = 0;
    for (i = 0; i < selObj.options.length; i++) {
        totalChecked += selObj.options[i].selected? 1 : 0;
    }
    // The next line needs the form, so

    selObj.form.element_9.value = totalChecked;
} 
```

现在您不必关心 select 元素的名称。:-)

### 编辑

要单击`element_9`，您可以执行以下操作：

```
<input name="element_9" onclick="
 this.value = selectCount(this.form['element_17_1[ ]']);
"> 
```

然后函数修改为：

```
function selectCount(selObj) {
    var totalChecked = 0;
    for (i = 0; i < selObj.options.length; i++) {
        totalChecked += selObj.options[i].selected? 1 : 0;
    }
    return totalChecked;
} 
```

现在的功课已经够多了。;-)

# algorithm - 从 5 中选择 2 个数字的概率（来自 Programming Pearls，第 2 版）

> ID：11093695
> 
> 赞同：1
> 
> 时间：2012-06-19T02:38:27.163
> 
> 标签：algorithm, probability

在第 126 页，第 12.2 节：

该算法按顺序考虑整数 0、1、2、...、n-1，并通过适当的随机测试选择每个整数。通过按顺序访问整数，我们保证输出将被排序。

为了理解选择标准，让我们考虑 m=2 和 n=5 的示例。我们应该选择概率为 2/5 的第一个整数 0；一个程序通过类似的语句来实现它

```
if (bigrand() % 5) < 2 
```

我的问题是，为什么选择第一个整数的概率是 2/5，而不是 1/5？从5个数字中随机选择一个数字的概率不应该是1/5吗？

这里真是一头雾水。希望有人可以在这里提供一些澄清。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T04:32:46.033

> 从5个数字中随机选择一个数字的概率不应该是1/5吗？

这是设计采样算法的一种方法，但这种方法的工作方式不同。它依次考虑每个元素并决定该元素是否是样本的一部分。这是 m=2 和 n=4 的决策树（确定性决策被抑制）。

```
 take 0?
               _____yes_____       _____no_____
              /                                \
             /                                take 1?
          take 1?                         yes/       \no
        yes/   \no                          /         \
          /     \                        take 2?     {2,3}
       {0,1}   take 2?                 yes/   \no
             yes/   \no                  /     \
               /     \                {1,2}   {1,3}
            {0,2}   {0,3} 
```

在根上，3/6 的后代结果包括 0，并且以 2/4 = 1/2 的概率取 0。如果我们取 0，那么只有 1/3 的结果包含 1。如果我们不取 0，那么 2/3 的结果包含 1。在每一步，每个决策的概率与相应子树中结果的数量成正比，确保大小为 m 的统一随机子集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T04:37:00.087

假设您正在挑选一个有序对。那么第一个数字是该对中的第一个数字的概率为 1/5，同样，第一个数字是该对中的第二个数字的概率为 1/5。（它永远不会同时是这对中的第一个和第二个数字。）

因此，它有 5 次中有 2 次机会出现在有序对中的某个位置。

选择一个随机的无序对与选择一个有序对然后忘记顺序是一样的。因此，它也有 5 次中有 2 次机会成为无序对。

# javascript - 如何使用 zRSSFeed 显示图像

> ID：11093701
> 
> 赞同：0
> 
> 时间：2012-06-19T02:39:49.817
> 
> 标签：javascript, jquery, rss

我正在尝试使用 ZSSFeed 以非常基本的方式显示一些 RSS 提要。事实上，我想从他们的例子开始：

[http://www.zazar.net/developers/jquery/zrssfeed/example_images.html](http://www.zazar.net/developers/jquery/zrssfeed/example_images.html)

该示例的脚本代码是：

```
$(document).ready(function () {
    $('#ticker1').rssfeed('http://feeds.bbc.co.uk/iplayer/highlights/tv/list',{
        snippet: false
    }, function(e) {
        $(e).find('div.rssBody').vTicker({
            showItems: 1
        });
    });
}); 
```

但是，当我将完全相同的脚本（附带 div）放在我的页面上时，它会显示没有图像的提要。我可以看到图像链接在 content:encoded 中被传回，但无法弄清楚如何让 zRSSFeed 显示它们。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T22:09:03.473

解决了。出于某种原因，当我在项目中实现代码时，我正在设置：

```
snippet: false 
```

假设图像将以这种格式出现。他们没有，只有当片段：真。

感谢 lucuma 提供正确方向的提示。

# ruby - 根据值对哈希键进行排名

> ID：11093710
> 
> 赞同：1
> 
> 时间：2012-06-19T02:41:13.940
> 
> 标签：ruby

我正在尝试根据其值确定哈希中每个键相对于其他键的排名。该值为数字。排名可以重复（即 3 个键可以并列第一名）。这有效，但很难看。

```
standings.sort_by {|k, v| v}.reverse!
prev_k = nil
standings.each_with_index do |(k, v), i|
  if i == 0
    k.rank = 1
  elsif v == standings[prev_k]
    k.rank = prev_k.rank
  else
    k.rank = prev_k.rank + 1
  end
  prev_k = k
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T02:53:29.237

试试这个：

```
ranks = Hash[standings.values.sort.uniq.reverse.each_with_index.to_a]
standings.each { |k, v| k.rank = ranks[v] + 1 } 
```

我不确定它是否更漂亮，但它更紧​​凑，带有更少的循环变量，并且没有条件。

# xml - 从 XML 文档中获取数据到 DataListView

> ID：11093717
> 
> 赞同：0
> 
> 时间：2012-06-19T02:42:26.320
> 
> 标签：xml, vb.net, datalistitem

我有一个 XML 文档，我成功地从 vb.net 写入我的文件系统....现在我想要一个按钮来浏览然后打开并将数据从 XML 导入回 datalistview...

我有打开文件对话框工作，可以从文件中读取特定的“静态”数据，但动态数据量似乎有点麻烦。有人可以帮我吗？

到目前为止，这是我所拥有的：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!--Markbook data file.-->
<Root>
  <Metadata>
    <Author>first.last</Author>
    <WriteTime>19/06/2012 9:23:28 AM</WriteTime>
  </Metadata>
  <Data>
    <StudentRecord>
      <Student>student1</Student>
      <Mark>88</Mark>
      <Grade>Distinction</Grade>
    </StudentRecord>
    <StudentRecord>
      <Student>student2</Student>
      <Mark>12</Mark>
      <Grade>Participation</Grade>
    </StudentRecord>
  </Data>
</Root> 
```

我将如何将元素中的每个数据元素添加到多列数据列表视图中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T04:49:05.887

在 .net 框架中有许多方法/方式可以读取/解析`XML`文档，但我想建议`Linq-Xml`。

看看这个代码片段：

```
 Dim doc = XDocument.Load("x:\folder\file.xml")
 Dim result = From ele In doc.Root.Descendants("StudentRecord")
                Select New With
                     {
                      .Name = ele.Element("Student").Value,
                      .Mark = ele.Element("Mark").Value,
                      .Grade = ele.Element("Grade").Value
                     }
 'Bind the List to DataGridView or other bindable control
 DataGridView1.DataSource = result.ToList() 
```

# java - Drools 数字到字符串强制转换

> ID：11093718
> 
> 赞同：0
> 
> 时间：2012-06-19T02:42:32.510
> 
> 标签：java, drools

有什么方法可以让 Drools 处理字符串、整数比较而无需手动进行类型转换？

我在将字符串与规则中的整数进行比较时遇到问题。该规则可以简化为以下字段，其中字段只是一个`Map<String, String>`.

```
rule "Test Rule"
    when
        MapTest(fields["a"] != null, fields["a"] == 10)
    then
        System.out.println( "test succeeded" );
end 
```

问题是，给定这条规则，即使 a = "10"，结果也不会被触发。根据第 4.8.3.3.3 节“强制总是支持字段类型而不是值类型”的文档。所以这条规则似乎应该将 10 强制为“10”，然后这个比较应该返回 true，但事实并非如此。

如果将 10 更改为“10”，则规则成功。此外，如果我做 Integer.parseInt(fields["a"]) 规则成功。

更有趣的部分是，如果我将运算符更改为 > 或 < 并适当地更改 fields["a"] 的值，则规则仍然成功！这是因为 > 和 < 在技术上不是字符串上的有效运算符，因此两个操作数被转换为数值并进行比较？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T18:28:06.157

Drools 似乎在 5.3 和 5.4 版本之间处理类型强制的方式不同。Wolfgang 在[Drools 用户论坛](http://drools.46999.n3.nabble.com/Drools-Number-to-String-Coercion-Issue-td4018067.html#a4018075)上给出了一个很好的例子来说明差异。

对我来说，这似乎是 5.3 版中的一个错误，因为文档说应该尝试强制，但根据示例它不是（或者至少它没有正确完成）。最后，我仍然不知道 > 和 < 运算符是如何工作的，但至少我收集了足够的信息来知道在我的情况下我必须将字符串解析为数值。

# python - Python：更改双键字典中的值

> ID：11093721
> 
> 赞同：0
> 
> 时间：2012-06-19T02:42:53.353
> 
> 标签：python

所以我想做的是制作一个人和他们的信息的字典，但我想用他们的名字作为主键，并让他们信息的每个部分也有一个键。我一直无法弄清楚如何去改变他们个人信息的价值。我什至不确定我是否以正确的方式解决这个问题，这里是代码。

```
name = raw_input("name")
age = raw_input("age")
address = raw_input("address")
ramrod = {}

ramrod[name] =  {'age': age}, {'address' : address}

print ramrod

#prints out something like this: {'Todd': ({'age': '67'}, {'address': '55555 FooBar rd'})} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-19T02:48:27.623

您正在寻找的是一个简单的嵌套字典：

```
>>> data = {"Bob": {"Age": 20, "Hobby": "Surfing"}}
>>> data["Bob"]["Age"]
20 
```

字典不是一对 - 您可以在字典中存储多个项目。因此，您需要一个包含从名称到信息的映射的字典，其中信息是包含从您要存储的关于该人的信息的名称到该信息的映射的字典。

请注意，如果您有与数据相关的行为，或者您最终会得到很多大字典，那么类可能更合适：

```
class Person:
    def __init__(self, name, age, hobby):
        self.name = name
        self.age = age
        self.hobby = hobby

>>> data = {"Bob": Person("Bob", 20, "Surfing")}
>>> data["Bob"].age
20 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T02:45:38.270

你很亲近

```
ramrod[name] = {'age': age, 'address' : address} 
```

# google-chrome - 在 google chrome 扩展程序中显示加载页面

> ID：11093727
> 
> 赞同：0
> 
> 时间：2012-06-19T02:44:04.803
> 
> 标签：google-chrome, google-chrome-extension

我已经为此进行了高低搜索，但无论我做什么，这似乎都不起作用。我有一个 google chrome 扩展，它使用 background.js 文件发送 XHR 请求。现在我的要求是我需要在 xhr 请求进行时显示一个小的加载图标。是否有任何教程可以解释如何执行此操作。我尝试了一个 iframe，但是当它随着整个 popup.html 的扩展而扩展时看起来很丑。jquery 是我在这里唯一的选择吗，因为这意味着为我当前的项目添加很多大小只是为了一个简单的动画。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T03:06:47.397

您需要定义两个函数 showIcon 和 hideIcon。

```
 function showIcon() {
   document.getElementById('loading').style.display ='block';
 } 

 function hideIcon() {
   document.getElementById('loading').style.display ='none';
 } 
```

您在发出 xhr 请求时执行 showIcon，然后在 xhr 返回时调用 hideIcon。

//html

```
<div id="loading">Loading</div> 
```

//css

```
#loading{

text-indent:-9999px
background-image:url('loading.gif');
display:none;

} 
```

# java - Android 更改 CheckBox 选中颜色

> ID：11093728
> 
> 赞同：2
> 
> 时间：2012-06-19T02:44:06.373
> 
> 标签：java, android, checkbox

我正在编写一个处理 2 个不同的应用程序`CheckBoxes`。当一个`CheckBox`被点击时，刻度的颜色应该是蓝色（而不是绿色），而另一个的颜色`CheckBox`保持绿色。

这是我的代码...

```
CheckBox green = (CheckBox) findViewById(R.id.greenButton);
CheckBox blue = (CheckBox) findViewById(R.id.blueButton);

blue.setOnCheckedChangeListener(new OnCheckedChangeListener(){
    public void onCheckedChanged(CompoundButton arg0, boolean arg1) {
        if(arg1){
            blue.setHighlightColor(Color.BLUE);
            Toast.makeText(getBaseContext(), "Question Marked As Partial", 4000).show();
        }
    }
});

green.setOnCheckedChangeListener(new OnCheckedChangeListener(){
    public void onCheckedChanged(CompoundButton arg0, boolean arg1) {
        if(arg1){
            blue.setHighlightColor(Color.GREEN);
            Toast.makeText(getBaseContext(), "Question Marked As Fully Understood!", 4000).show();
        }
    }
}); 
```

但是，两种`CheckBoxes`刻度颜色都保持绿色，并且`Toast`消息没有显示，所以我猜测`OnCheckedChangeListener`永远不会被调用。

有人可以提供任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T03:03:20.987

如果`Toast`没有出现，则可能您的听众实际上并未设置在`CheckBoxes`. 换句话说，也许这整段代码甚至都没有被调用。

如果您的代码在方法中，请确保您正在调用该方法以在 上设置侦听`CheckBoxes`器，或确保此代码在您的主要方法之一中，例如`onCreate()`.

如果您还不知道，这将是学习如何调试代码的好时机 - 它可以非常快速和轻松地确定您的代码是否被调用。

# javascript - 让我的 html 输入数字字段在滚轮上更改，即使它们没有集中在 Chrome 中

> ID：11093729
> 
> 赞同：1
> 
> 时间：2012-06-19T02:44:15.700
> 
> 标签：javascript, jquery, html, google-chrome

采取这样的[输入字段](http://jsfiddle.net/Yeqmp/)：

```
​&lt;input type='number' step='1' />​​​​​​​​​​​​​​​​​ 
```

在 Chrome 中，您可以通过单击该字段然后向上或向下移动滚轮来更改该字段的值。但是，您不能简单地将鼠标悬停在该字段上并使用滚轮来更改它（就像在 Opera 中一样）。如何更改此行为，以便不必选择字段来使用滚轮更改它？我对使用 javascript/jQuery（但不是 jQuery UI）的解决方案持开放态度。如果这很重要，我正在使用适用于 Linux 的 Chrome 21。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T02:51:06.323

Using `hover()`

```
 $("#spinner").hover(
        function()
        {
            $(this).focus();
        },
        function(){
            $(this).blur();
        }
);​ 
```

[http://jsfiddle.net/Yeqmp/3/](http://jsfiddle.net/Yeqmp/3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T02:47:59.660

在以下情况下聚焦输入字段`mouseover`：

```
$("input[type='number']").mouseover(function(){
    this.focus();
});​ 
```

演示：http: [//jsfiddle.net/DerekL/Yeqmp/2/](http://jsfiddle.net/DerekL/Yeqmp/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-01T22:27:57.753

要使数字或时间输入可滚动，您只需将空的 onmousewheel 处理程序添加到页面上的至少一个控件：

```
<input type="time" value="12:00" onmousewheel="onWheel()"/>

<script>
  function onWheel() { }
</script> 
```

在 Chrome 上检查，它适用于页面上的所有控件。

# mysql - PHP循环遍历多个数据库表

> ID：11093734
> 
> 赞同：1
> 
> 时间：2012-06-19T02:44:48.703
> 
> 标签：mysql, loops, foreign-key-relationship

假设我有一个如下的数据库结构：

**学生**

```
+--------------+--------------------+-------------------+
| student_id   | student_firstname  | student_lastname  |
+--------------+--------------------+-------------------+
| 1            | John               | Doe               |
+--------------+--------------------+-------------------+
| 2            | Lisa               | Doe               |
+--------------+--------------------+-------------------+
| 3            | Derp               | Doe               |
+--------------+--------------------+-------------------+ 
```

**缺席**

```
+--------------+--------------------+-------------------+---------------+
| absence_id   | absence_student_id | absence_date      | absence_note  |
+--------------+--------------------+-------------------+---------------+
| 1            | 2                  | 2012-06-10        | A note...     |
+--------------+--------------------+-------------------+---------------+
| 2            | 3                  | 2012-06-30        | Another note. |  
+--------------+--------------------+-------------------+---------------+ 
```

`students.student_id`以及列和之间的关系`absence.absence_student_id`

在 PHP 中，我想遍历上面的表并获得行的完整输出，`students`如果有`absence`匹配该学生的记录，则对该行执行某些操作，然后继续循环。

我想要的 HTML 输出是这样的：

```
<table>
 <thead>
  <tr>
    <td>Name:</td>
    <td>Absence date:</td>
    <td>Absence note:</td>
  </tr>
 </thead>

 <tr>
    <td>John Doe</td>
    <td></td>
    <td></td>
 </tr>

 <tr>
    <td>Lisa Doe</td>
    <td>2012-06-10</td>
    <td>A note...</td>
 </tr>

 <tr>
    <td>Derp Doe</td>
    <td>2012-06-30</td>
    <td>Another note.</td>
 </tr>
</table> 
```

我用这样的循环：

```
<?php
  while ($row = mysql_fetch_array($students_sql_query)) {
   echo "<tr><td>".$row['student_firstname']."</td></tr>";
 }
?> 
```

是否可以为此添加某种`if`声明？我需要两个不同`MySQL`的查询和某种`foreach`循环吗？我对网络编程比较陌生...在此先感谢并抱歉发了很长的帖子。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T02:56:24.000

您需要在查询中加入表，然后从查询中获取结果。

```
SELECT Students.student_firstname
   , Students.student_lastname 
   , Absence.absence_date 
   , Absence.absence_note  
FROM Students
LEFT JOIN Absence ON Students.id = Absence.absence_student_id 
```

然后，您应该能够像这样循环遍历它：

```
<?php
    while ($row = mysql_fetch_array($students_sql_query)) 
    {
?>
        <tr>
            <td>$row['student_firstname']</td>
            <td>$row['student_lastname']</td>
            <td>$row['absence_date']</td>
            <td>$row['absence_note']</td>
        </tr> 
<?
    }
?> 
```

左连接将告诉数据库拉入所有学生，如果他们缺席，它也会填充这些学生。如果学生没有缺勤，那将从数据库中返回为 null。当它显示在循环中的表行中时，如果该学生的缺勤表中没有任何内容，它应该显示为空列。

唯一的缺点是如果学生有多次缺勤，它将在显示表中重复行。在这种情况下，您必须在代码或显示中进行一些预处理来处理这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T03:01:08.633

使用 pdo 如下：

```
 $sql = $dbh->prepare('
        SELECT student_firstname, student_lastname, absense_date, absense_note 
        FROM students s inner join absense a 
        ON s.student_id=a.absense_student_id
        ');
        $sql->execute();
        $result = $sql->fetchAll(); <----- fetch All the data
        return $result;

     foreach($result as $row)
            {
            echo '<tr>';
            echo '<td>'.$row['student_firstname'].' '.$row['student_lastname'].'</td>';
            echo '<td>'.$row['absense_date'].'</td>';
            echo '<td>'.$row['absense_note'].'</td>';
            echo '</tr>';
            } 
```

# python - 如何在 scipy-cluster 的每个集群中选择离中心最近的代表？

> ID：11093735
> 
> 赞同：2
> 
> 时间：2012-06-19T02:45:03.397
> 
> 标签：python, cluster-analysis, hierarchical-data, hierarchical-clustering

所以基本上，我使用 Python 模块[scipy-cluster](http://code.google.com/p/scipy-cluster/)来绘制大量数据点。如果给定阈值或我想要的代表数量，是否有方法/功能可以给出每个集群的代表？理想情况下，每个代表必须与它所属的集群中心的距离最近。

编辑：我正在寻找每个集群中最接近质心的数据点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T05:13:56.013

我真的不知道我在 scipy-cluster 周围的方式，但听起来它给了你质心坐标。鉴于该信息和集群中哪些点的知识，计算集群中每个点与质心的距离应该是微不足道的。只需确保您的计算基于用于聚类的相同距离度量（可能是欧几里德距离）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T18:29:00.757

Scipy-cluster 为每个质心提供坐标并识别每个集群中的点。一旦你有了它，我相信[`scipy.cluster.vq.py_vq`](http://docs.scipy.org/doc/scipy/reference/generated/scipy.cluster.vq.vq.html)会给你观察和质心之间的距离。

# sql - 并行插入单个表的最快方法

> ID：11093744
> 
> 赞同：18
> 
> 时间：2012-06-19T02:46:17.390
> 
> 标签：sql, sql-server, parallel-processing, blocking

我的公司被一种寄生的共生伙伴关系所诅咒。为了从寄生虫中获取我们的数据，我们必须使用极其缓慢的 odbc 连接。我最近确实注意到，我可以通过并行运行查询（即使在同一个表上）来获得更多的吞吐量。

有一个特别大的表，我想从中提取数据并将其移动到我们的本地表中。并行运行查询我可以更快地获取数据，但我也认为这可能会导致尝试将多个查询中的数据一次写入同一个表时出现问题。

关于如何最好地处理这种情况，您能给我什么建议，以便我可以利用并行使用查询的速度提高？

编辑：我在这里得到了一些很好的反馈，但我认为我并不完全清楚我通过链接服务器（使用 odbc 驱动程序）提取数据的事实。换句话说，这意味着我可以运行正常的 INSERT 语句，并且我相信这将提供比 SqlBulkCopy 或 BULK INSERT 更好的性能（实际上，我认为 BULK INSERT 甚至不是一个选项）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-19T06:01:51.857

您是否[在不到 1 小时内阅读了 Load 1TB](https://techcommunity.microsoft.com/t5/DataCAT/Load-1TB-in-less-than-1-hour/ba-p/304940)？

> 1.  运行与可用 CPU 一样多的加载进程。如果您有 32 个 CPU，请运行 32 个并行加载。如果您有 8 个 CPU，请运行 8 个并行加载。
> 2.  如果您可以控制输入文件的创建，请将它们的大小设置为可以被您要并行运行的加载线程数整除。如果要使用切换分区策略，还要确保所有记录都属于一个分区。
> 3.  如果您在 SQL Server 计算机上运行进程，请使用 BULK insert 而不是 BCP。
> 4.  使用表分区可以再增加 8-10%，但前提是您的输入文件必须保证与您的分区功能相匹配，这意味着一个文件中的所有记录必须位于同一个分区中。
> 5.  使用 TABLOCK 避免一次锁定行。
> 6.  如果要将多个流导入一个表，请使用 ROWS PER BATCH = 2500 或接近此值的值。

对于 SQL Server 2008，在某些情况下，您可以[对标准 INSERT SELECT 使用最少的日志记录](http://www.sqlmag.com/content1/topic/minimally-logged-inserts/catpath/tsql3)：

> SQL Server 2008 增强了它可以用最少的日志记录处理的方法。它支持最少记录的常规 INSERT SELECT 语句。此外，打开跟踪标志 610 可以让 SQL Server 2008 支持针对导致分配新页面的新键范围的非空 B 树的最小日志记录。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-21T08:30:13.917

如果您希望在代码（即 c#）中执行此操作，则可以选择使用`SqlBulkCopy`（在 System.Data.SqlClient 命名空间中），并且正如本文所建议的那样，它可以并行执行此操作。

[http://www.adathedev.co.uk/2011/01/sqlbulkcopy-to-sql-server-in-parallel.html](http://www.adathedev.co.uk/2011/01/sqlbulkcopy-to-sql-server-in-parallel.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-05T12:19:18.970

如果您已升级到 SQL 2014，则可以并行插入（兼容级别必须为 110）。看到这个：http: [//msdn.microsoft.com/en-us/library/bb510411%28v=sql.120%29.aspx](http://msdn.microsoft.com/en-us/library/bb510411%28v=sql.120%29.aspx)

# objective-c - 如何在不在应用程序委托中的视图控制器中创建选项卡栏控制器？IOS 4.1

> ID：11093745
> 
> 赞同：0
> 
> 时间：2012-06-19T02:46:25.313
> 
> 标签：objective-c, ios, uitabbarcontroller

我正在创建一个标签栏应用程序，但我想通过使用界面生成器创建不在 Main.xib 中的标签栏控制器。因为我的应用没有 Main.Xib。所以我要么应该在 ViewController.xib 中进行，要么在控制器/appdelegate 中以编程方式进行。我找不到任何好的教程或示例。

在我的应用程序中，我有

```
AppDelegate.h
AppDelegate.m
ViewController.h
ViewController.m
ViewController.xib 
```

我的应用程序从 ViewController.xib 的视图开始，我知道我想添加的不是标签栏，而是一个标签栏控制器，它将始终保持在视图的底部。我怎样才能做到这一点？

appdelagete.h

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

    self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];
    // Override point for customization after application launch.
    self.viewController = [[[ViewController alloc] initWithNibName:@"ViewController" bundle:nil] autorelease];
    self.window.rootViewController = self.viewController;
    [self.window makeKeyAndVisible];

    return YES;
} 
```

我试图通过查看[苹果开发人员文档](http://developer.apple.com/library/ios/#documentation/WindowsViews/Conceptual/ViewControllerCatalog/Chapters/CombiningViewControllers.html)以编程方式进行操作，但无法弄清楚。

提前感谢任何示例代码

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T23:06:49.977

我发现这很好用 appdelegate.h

```
@property (nonatomic, retain) UITabBarController *rootController 
```

appdelegate.m

```
UIViewController *viewController1 = [[[ViewController alloc] initWithNibName:@"ViewController" bundle:nil] autorelease];
self.rootController = [[[UITabBarController alloc] init] autorelease];
self.rootController.viewControllers = [NSArray arrayWithObjects:viewController1, nil];
self.window.rootViewController = self.rootController; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T02:58:30.850

This will create a tab bar with 3 views

```
self.tabBarController = [[UITabBarController alloc] init];
self.tabBarController.viewControllers = [NSArray arrayWithObjects:view1, view2, view2, nil];
self.window.rootViewController = self.tabBarController; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-04T06:40:43.177

///AppDelegate.m 文件：didFinishLaunchingWithOptions 方法

```
//initiate window
window = [[UIWindow alloc]initWithFrame:[[UIScreen mainScreen]bounds]];

//initiate viewcontrollers
FirstViewController *aFirstViewController = [FirstViewController new];

SecondViewController *aSecondViewController = [SecondViewController new];

 aFirstViewController.tabBarItem.title = @"First";
aFirstViewController.tabBarIte
 aSecondViewController.tabBarItem.title = @"Second";

gTabBarController = [[UITabBarController alloc]init];
gTabBarController.viewControllers = @[aFirstViewController ,aSecondViewController];

//show the main window and also make it key
[window makeKeyAndVisible];

window.rootViewController = gTabBarController; 
```

# eclipse - eclipse插件：在控制台运行命令，获取stdin

> ID：11093748
> 
> 赞同：2
> 
> 时间：2012-06-19T02:46:53.843
> 
> 标签：eclipse, eclipse-plugin, eclipse-pde

我正在制作一个 eclipse 插件，我想在其中运行系统命令，并将命令的输出转到 eclipse 控制台。我知道如何通过[http://wiki.eclipse.org/FAQ_How_do_I_write_to_the_console_from_a_plug-in%3F做到这一点](http://wiki.eclipse.org/FAQ_How_do_I_write_to_the_console_from_a_plug-in%3F)

我不知道如何解决的问题是允许从控制台对此命令进行交互式输入。

本质上，我想启动一个在控制台中运行的命令。用户可以与此命令交互（通过标准输入）。然后，我希望我的插件代码在命令完成时获得回调（或者用户在控制台中手动停止/终止了命令）。获取已完成程序的返回码也很好。

为简单起见，让我们使用 unix 'passwd' 命令作为示例（这是我能想到的第一个常见的 cmd，它既有输出又有输入提示）。但是，我不需要隐藏标准输入。

作为参考，我试图调用的命令是[CakePHP bake shell](http://book.cakephp.org/2.0/en/console-and-shells.html)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T04:47:52.687

我假设你有一个 MessageConsole，就像在 FAQ 中一样。然后应该可以`messageConsole.getInputStream().read()`在循环中使用来获取您的输入（但我尚未对此进行测试）。另请参阅[IOConsoleInputStream](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/ui/console/IOConsoleInputStream.html)的文档以获取更多选项。

另一方面，我不确定您为什么要创建自己的插件来做到这一点。Eclipse 中的标准控制台实现正是您想要的。您可以通过运行一个小型 Java 应用程序来看到这一点，您也可以在其中使用该控制台进行输入和输出。

# javascript - 使用 Javascript 和 Servlet 后端的网络摄像头

> ID：11093750
> 
> 赞同：1
> 
> 时间：2012-06-19T02:47:29.970
> 
> 标签：javascript, mysql, servlets

很高兴看到有人将 JpegCam（将网络摄像头集成到网页中的项目[http://code.google.com/p/jpegcam/）php](http://code.google.com/p/jpegcam/)代码转换为 java [http://ashwinrayaprolu.wordpress.com/2011/ 05/26/capture-picture-on-webpage-with-java-backend/](http://ashwinrayaprolu.wordpress.com/2011/05/26/capture-picture-on-webpage-with-java-backend/)。

我还在构建一个应用程序，在该应用程序中我必须在客户端使用网络摄像头并将图像存储在服务器端的数据库中。我的问题是我如何引用被点击的图像，因为我们在捕获图像后获得了 URL用于服务器端，我无法通过该 URL 访问服务器上的该图像。如何访问数据库入口页面中的图像？我知道将图像存储在数据库中不是一个好习惯，但我真的不知道如何避免它。

请帮忙..！

谢谢！

# ruby - 如何在 CoffeeScript 中执行注入操作？

> ID：11093754
> 
> 赞同：4
> 
> 时间：2012-06-19T02:47:44.043
> 
> 标签：ruby, coffeescript

我正在尝试这样做，但是使用 CoffeeScript：

```
# ruby:
items.map {|item| item.price * item.quantity }.reduce(:+) 
```

到目前为止我所拥有的：

```
# coffeescript:
item.price * item.quantity for item in items 
```

如何对数组中的所有项目求和？更一般地说，我怎样才能对数组中的所有项目执行任何操作（在 Ruby 中，这将是`inject`or `reduce`）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T02:51:25.290

没关系，我找到了。它完成了[`reduce`](http://coffeescriptcookbook.com/chapters/arrays/reducing-arrays)

```
(item.price * item.quantity for item in items).reduce (x, y) -> x + y 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-19T02:52:06.227

我不知道一般的[减少](http://coffeescriptcookbook.com/chapters/arrays/reducing-arrays)功能，但对于累加器，你可以做

```
sum = 0
sum += item.price * item.quantity for item in items 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-31T07:09:53.493

更通用的 reduce 函数可能如下所示：

```
total = ((agg = 0) ->
  agg + item.price * item.quantity
)(total, item) for item in items 
```

或者

```
result = ((aggregate = 'default value') ->
  // function body changing, then returning aggregate
  aggregate
)(result, i) for i in some_array 
```

# javascript - 为什么 Chrome unsafeWindow 技巧不支持 XMLHttpRequest 发送覆盖？

> ID：11093759
> 
> 赞同：2
> 
> 时间：2012-06-19T02:48:15.133
> 
> 标签：javascript, userscripts

我想覆盖`XMLHttpRequest`发送，以便让我的用户脚本知道何时通过此类请求在页面上更新数据。我的覆盖代码如下所示：

```
var oldSend = unsafeWindow.XMLHttpRequest.prototype.send;

unsafeWindow.XMLHttpRequest.prototype.send = function(){
    console.log("notified of XHR update");
    oldSend.apply(this, arguments);
} 
```

如果我将它注入页面（没有`unsafeWindow`引用）它工作正常，但我想从用户脚本范围内让它工作。 `unsafeWindow`适用于 Firefox，但不适用于 Chrome。所以我抓住了Brock Adams 的绝妙技巧，[在 Chrome](https://stackoverflow.com/a/10945153/348496)[中创建了一个工作`unsafeWindow`](https://stackoverflow.com/a/10945153/348496)：

```
var bGreasemonkeyServiceDefined     = false;

try {
    if (typeof Components.interfaces.gmIGreasemonkeyService === "object") {
        bGreasemonkeyServiceDefined = true;
    }
}
catch (err) {
    //Ignore.
}

if ( typeof unsafeWindow === "undefined"  ||  ! bGreasemonkeyServiceDefined) {
    unsafeWindow    = ( function () {
        var dummyElem   = document.createElement('p');
        dummyElem.setAttribute ('onclick', 'return window;');
        return dummyElem.onclick ();
    } ) ();
} 
```

但是，当我将两者结合起来时，什么也没有发生。这一切都粘贴到控制台中，但是从用户脚本运行时既没有错误也没有输出。我是不是做错了什么，或者这超出了这个技巧的能力范围？

嗯，只是尝试了一些更简单的东西，比如：`unsafeWindow.document.title = 'testing';`这也不起作用，所以它可能不是特定于`XMLHttpRequest`.

如果可能的话，我试图避免注入页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T04:20:07.020

这：

```
/*--- Create a proper unsafeWindow object on browsers where it doesn't exist
    (Chrome, mainly).
    Chrome now defines unsafeWindow, but does not give it the same access to
    a page's javascript that a properly unsafe, unsafeWindow has.
    This code remedies that.
*/
var bGreasemonkeyServiceDefined     = false;

try {
    if (typeof Components.interfaces.gmIGreasemonkeyService === "object") {
        bGreasemonkeyServiceDefined = true;
    }
}
catch (err) {
    //Ignore.
}

if ( typeof unsafeWindow === "undefined"  ||  ! bGreasemonkeyServiceDefined) {
    unsafeWindow    = ( function () {
        var dummyElem   = document.createElement('p');
        dummyElem.setAttribute ('onclick', 'return window;');
        return dummyElem.onclick ();
    } ) ();
} 
```

其次是：

```
unsafeWindow.document.title = 'testing'; 
```

从我的测试用户脚本中工作得很好。

这些也可以按照以下`unsafeWindow`技巧工作：

```
unsafeWindow.foo = function () {
    console.log ("In foo().");
};

unsafeWindow.alert = function (s) {
    console.log ("Alert: ", s);
}; 
```

（在脚本运行的页面上，`foo()`在控制台中输入会产生：“ *In foo().* ”。 `alert()`不会生成弹出窗口，但会打印到控制台。）

我不知道为什么（还）覆盖`XMLHttpRequest.prototype.send`不能像 Chrome 用户脚本那样工作，但**我不推荐这种`unsafeWindow`方法。**

*Inject* the override code. Use [postMessage()](https://developer.mozilla.org/en/DOM/window.postMessage#Example) (which works on Chrome as well) to communicate between the page scope and the script scope, if you don't (or can't) inject the whole script.

# wordpress - 让 jQuery 验证插件与 WordPress 表单一起使用

> ID：11093765
> 
> 赞同：2
> 
> 时间：2012-06-19T02:49:10.140
> 
> 标签：wordpress, jquery, jquery-validate

我在将前端用户注册表单作为自定义 WordPress 主题的一部分制作时遇到了问题，我需要能够在允许用户注册之前检查是否存在带有 ajax 请求的电子邮件。

这是 JS：我正在使用 jQuery Validate 插件，并且正在使用 addMethod 插入到 .validate 调用中。这是代码：

```
function chk_email(value){
  var response;
  $.ajax({
    async: false,
    url: ajaxurl,
    type: 'POST',
    data: {action: 'chk_email', email: value},
    dataType: "text",
    success: function(msg) {
      if (msg>0) {
        response = true;
      } else{
        response = false;
      }
    }
  })
  console.log(response);
  return response;
}

$.validator.addMethod('chk_email', chk_email, "This email address has already been registered");

$("#adduser").validate({
  // debug: true,
  rules: {
    user_login: {
      required: true,
      minlength: 3,
      nowhitespace: true,
      alphanumeric: true
    },
    first_name: {
      required: true,
    },
    last_name: {
      required: true,
    },
    user_email: {
      required: true,
      email: true,
      nowhitespace: true,
      // remote: { url: ajaxurl, type: 'post' }
      chk_email: true
    },
    tel: {
      required: true,
      phoneUS: true
    },
    street_address: {
      required: true
    },
    locality: {
      required: true
    },
    region: {
      required: true
    },
    postal_code: {
      required: true
    },
  },
  messages: {
    user_login: {
      required: "Required",
      user_login: "A username needs to be atleast 3 charachters long."
    },
    user_email: {
      required: "We need your email address to contact you",
      user_email: "Your email address must be in the format of name@domain.com",
      nowhitespace: "yeah"
    },
  },
  errorElement: 'span',
  errorClass: 'help-inline',
  errorPlacement: function(error, element) {
    error.insertAfter(element);
  },
  highlight: function(element) {
    var parent = $(element).parents('.control-group');
    $(element).addClass('error');
    $(parent).addClass('error');
  },
  unhighlight: function(element) {
    var parent = $(element).parents('.control-group');
    $(element).removeClass('error');
    $(parent).removeClass('error');
  }
  // debug: true
}); 
```

这是我在 functions.php 文件中使用的 PHP：

```
add_action('wp_ajax_nopriv_chk_email', 'chk_email');

function chk_email(){  
  if (email_exists($_POST['email']) ){
    // return TRUE;
    echo 'true';
  } else {
    // return FALSE;
    echo 'false';
  }
} 
```

我不太确定我在这里做错了什么。我会很感激任何想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T05:38:21.647

[http://docs.jquery.com/Plugins/Validation/Methods/remote](http://docs.jquery.com/Plugins/Validation/Methods/remote)

查看概述和示例。

因此`chk_email()`，您将添加到`remote`选项中，而不是 ：

```
remote: {
    url: ajaxurl,
    type: "post"
} 
```

# database - 如果所有字段在java中具有相同的数据类型，是否有可能将所有数据库字段值存储到一个数组变量中？

> ID：11093768
> 
> 赞同：-1
> 
> 时间：2012-06-19T02:49:58.247
> 
> 标签：database

> 在这个程序中，我为数据库中的每个字段使用了不同的数组变量。在数据库中，所有字段都具有相同的数据类型，现在我想将所有字段值存储到一个数组变量中。这可能吗？？？

```
import java.sql.*;
class ja1
{
    public static void main(String ar[])
    {
        try
        {
            int x,i,j,k,l;
            int a[]=new int[30];        
            int b[]=new int[30];        
            int c[]=new int[30];        
            int d[]=new int[30];        
            int count[]=new int[10];
            Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
            Connection c1=DriverManager.getConnection("Jdbc:Odbc:ds");
            Statement s=c1.createStatement();
            ResultSet r=s.executeQuery("select * from pro");
            i=0;
            j=0;
            k=0;
            l=0;
            x=0;
            while(r.next())
            {
                a[i]=r.getInt(2);
                i++;
                b[j]=r.getInt(3);
                j++;
                c[k]=r.getInt(4);
                k++;
                d[l]=r.getInt(5);               
                l++;
            }
            for(i=0;i<6;i++)
                System.out.println(""+a[i]);

            for(j=0;j<6;j++)
                System.out.println(""+b[j]);
            System.out.print("\n\n");
            for(k=0;k<6;k++)
                System.out.println(""+c[k]);
            System.out.print("\n\n");
            for(l=0;l<6;l++)
                System.out.println(""+d[l]);

        }
        catch(Exception e)
        {
            System.out.print(e);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T02:57:52.580

Yes, it is possible in several ways :

1) If you want to use only one array then please create an array with size of 120 (4X30) and use 4 counter to arrange your data in range. That means, your first variable would be from index 0 to 29, the 2nd would be from 30 to 69 and so on. This is not good if you don't know the exact size of your array as you are binding them with perfect size of 30.

2) You can create a `POJO` and have 4 arrays into it, you can use a `List` instead of array, but it depends on your implementation. So, create a class, put 4 arrays into it, give good variable names and access thru getter/setter methods. This will be a clear code

3) You can use a `Map<Integer,Integer[]>` or `Map<Integer,List<Integer>>` and have a single variable/reference which is holding your key value pair.

It all depends on you, if you dont know, why are you using arrays,then please move the `Collection`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T02:58:14.540

I would define a POJO for the record and then use a generic list to add and iterate the record/s

Try this:

```
class RecordData
{
    public int First; 
    public int Second; 
    public int Third; 
    public int Fourth; 
}

class ja1
{
    public static void main(String ar[])
    {
        try
        {
           List<RecordData> list = new ArrayList<RecordData>;

            Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
            Connection c1=DriverManager.getConnection("Jdbc:Odbc:ds");
            Statement s=c1.createStatement();
            ResultSet r=s.executeQuery("select * from pro");
            while(r.next())
            {
                            RecordData data = new RecordData();
                            data.First = r.getInt(2);
                            data.Second = r.getInt(3);
                            data.Third = r.getInt(4);
                            data.Fourth = r.getInt(5);
                            list.add(data);
            }
                        for(RecordData data : list) {
                                System.out.println(data.First);
                                System.out.println(data.Second);
                                System.out.println(data.Third);
                                System.out.println(data.Fourth);
                        }
        }
        catch(Exception e)
        {
            System.out.print(e);
        }
    }
} 
```

# actionscript-3 - 屏幕上不能同时出现多个子弹？

> ID：11093775
> 
> 赞同：1
> 
> 时间：2012-06-19T02:51:18.963
> 
> 标签：actionscript-3, actionscript

基本上发生的事情是当我发射子弹时，它会产生子弹。但是，如果我在项目符号仍在屏幕上时再次单击，它会删除项目符号并创建一个全新的项目符号。所以现在一次只能在屏幕上显示一颗子弹。我该如何解决？库中的项目符号的实例名称为“项目符号”

```
package
{

public class GameEnter extends MovieClip
{

    public function GameEnter()
    {
        addEventListener(MouseEvent.MOUSE_DOWN, shootBullet);
    }
    public var _bullet1:bullet = new bullet;
    public var angleRadian = Math.atan2(mouseY - 300,mouseX - 300);
    public var angleDegree = angleRadian * 180 / Math.PI;
    public var speed1:int = 10;

    public function shootBullet(evt:MouseEvent)
    {
        _bullet1.x = 300;
        _bullet1.y = 300;
        _bullet1.angleRadian = Math.atan2(mouseY - 300,mouseX -300);
        _bullet1.addEventListener(Event.ENTER_FRAME, bulletEnterFrame);
        addChild(_bullet1);
    }
    public function bulletEnterFrame(evt:Event) 
    {
        var _bullet1 = evt.currentTarget;
        _bullet1.x += Math.cos(_bullet1.angleRadian) * speed1;
        _bullet1.y += Math.sin(_bullet1.angleRadian) * speed1;
        _bullet1.rotation = _bullet1.angleRadian*180/Math.PI;
        if (_bullet1.x < 0 || _bullet1.x > 600 || _bullet1.y < 0 || _bullet1.y > 600) 
        {
            removeChild(_bullet1);
            _bullet1.removeEventListener(Event.ENTER_FRAME, bulletEnterFrame);
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T02:55:36.983

想想看，你将 _bullet1 变量存储在类中，这很好，但每次拍摄时都使用相同的变量，只是再次更改 x 和 y 位置。

更好的方法是在子弹类本身中处理子弹的动画。

射击时，您只需创建一个新子弹并将其添加到舞台上。

如果你仍然想使用这种方式，它应该更像这样：

```
public function shootBullet(evt:MouseEvent)
{
    var bullet:bullet = new bullet();
    bullet.x = 300;
    bullet.y = 300;
    bullet.angleRadian = Math.atan2(mouseY - 300,mouseX -300);
    bullet.addEventListener(Event.ENTER_FRAME, bulletEnterFrame);
    addChild(bullet);
}

public function bulletEnterFrame(evt:Event) 
{
    var tmpBullet:bullet = evt.currentTarget as bullet;
    tmpBullet.x += Math.cos(_bullet1.angleRadian) * speed1;
    tmpBullet.y += Math.sin(_bullet1.angleRadian) * speed1;
    tmpBullet.rotation = _bullet1.angleRadian*180/Math.PI;
    if (tmpBullet.x < 0 || tmpBullet.x > 600 || tmpBullet.y < 0 || tmpBullet.y > 600) 
    {
        removeChild(tmpBullet);
        tmpBullet.removeEventListener(Event.ENTER_FRAME, bulletEnterFrame);
    }
} 
```

但最好的方法是选择选项 1

# amazon-ec2 - AWS 自动缩放和服务器代码更新/编辑

> ID：11093777
> 
> 赞同：0
> 
> 时间：2012-06-19T02:51:30.633
> 
> 标签：amazon-ec2, amazon-web-services, amazon-ami

假设我在自动缩放组中的 ec2 实例上有一个 PHP 站点。该组有 10 个正在运行的实例。我想向该站点添加一些新的 php 代码。有没有一种健全的方法可以做到这一点并将其填充到自动缩放组中的所有其他实例中？

我能看到的唯一方法是手动捆绑实例中的图像，将其上传到 S3，使用 aws 注册捆绑包并将捆绑包附加到自动缩放组的启动配置。然后我必须终止我的所有实例并使用新图像启动新实例。

每次我想对代码库进行更改时，我都必须这样做。这肯定是疯了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T03:53:46.223

最好的方法是不要将您的页面捆绑到图像中。让 ami 在开始时从 s3 下载它们。这样你可以只上传到一个地方并调用下载脚本。

# entity-framework-4 - A SQL insert is generated as well as an update when updating

> ID：11093778
> 
> 赞同：0
> 
> 时间：2012-06-19T02:51:44.757
> 
> 标签：entity-framework-4, sql-server-ce, self-tracking-entities

I am using Entity Framework 4 self-tracking entities template (STE) and SQL Server CE. I am seeing some very odd behavior. Everything works great if I just insert or update, delete. However if I insert an object and then update it an `UPDATE` and an `INSERT` SQL statement will be generated for the object when I perform the update (See below).

I am using a repository pattern and I dispose of the repository and the `ObjectContext` it wraps for each of the calls so the update uses a new `ObjectContext`. Also note that if I restart the server the update of the object works fine so it is only the case where I have inserted an object.

The update does the "usual" `ApplyChanges` and `SaveChanges` since I am using STE.

The trace for the initial insert is:

```
Creating ComputerEntities
--=============== BEGIN COMMAND ===============

declare @0 UniqueIdentifier set @0 = '2975bbbb-36a1-4c0a-8075-be273a96cd42'
declare @1 Bit set @1 = 'True'
declare @2 UniqueIdentifier set @2 = '2913bff8-9f2b-4965-8e02-5cb2a98f4498'
declare @3 Int set @3 = '2'
declare @4 Int set @4 = '1'
declare @5 NVarChar set @5 = 'test'
declare @6 NVarChar set @6 = 'C:\ProgramData\Kailana\ReVersion\Repositories\Projects\2975bbbb-36a1-4c0a-8075-be273a96cd42\2975bbbb-36a1-4c0a-8075-be273a96cd42'

insert [Repository]([Id], [Enabled], [ComputerId], [SQLVersionId], [ReleaseId], [Name], [Description], [DataSource], [Password], [DbUser], [DbUserPassword])
values (@0, @1, @2, @3, @4, @5, null, @6, null, null, null)

go

--=============== END COMMAND =============== 
```

*   Disposing the repository
*   Disposing the repositories Context.

Next I do an update and this is the SQL that is generated:

```
Creating ComputerEntities
--=============== BEGIN COMMAND ===============

declare @0 Bit set @0 = 'True'
declare @1 UniqueIdentifier set @1 = '2913bff8-9f2b-4965-8e02-5cb2a98f4498'
declare @2 Int set @2 = '2'
declare @3 Int set @3 = '1'
declare @4 NVarChar set @4 = 'tested'
declare @5 NVarChar set @5 = 'C:\ProgramData\Kailana\ReVersion\Repositories\Projects\2975bbbb-36a1-4c0a-8075-be273a96cd42\2975bbbb-36a1-4c0a-8075-be273a96cd42'
declare @6 UniqueIdentifier set @6 = '2975bbbb-36a1-4c0a-8075-be273a96cd42'

update [Repository]
set [Enabled] = @0, [ComputerId] = @1, [SQLVersionId] = @2, [ReleaseId] = @3, [Name] = @4, [Description] = null, [DataSource] = @5, [Password] = null, [DbUser] = null, [DbUserPassword] = null
where ([Id] = @6)
go

-=============== END COMMAND ===============
--=============== BEGIN COMMAND ===============

declare @0 UniqueIdentifier set @0 = '2975bbbb-36a1-4c0a-8075-be273a96cd42'
declare @1 Bit set @1 = 'True'
declare @2 UniqueIdentifier set @2 = '2913bff8-9f2b-4965-8e02-5cb2a98f4498'
declare @3 Int set @3 = '2'
declare @4 Int set @4 = '1'
declare @5 NVarChar set @5 = 'test'
declare @6 NVarChar set @6 = 'C:\ProgramData\Kailana\ReVersion\Repositories\Projects\2975bbbb-36a1-4c0a-8075-be273a96cd42\2975bbbb-36a1-4c0a-8075-be273a96cd42'

insert [Repository]([Id], [Enabled], [ComputerId], [SQLVersionId], [ReleaseId], [Name], [Description], [DataSource], [Password], [DbUser], [DbUserPassword])
values (@0, @1, @2, @3, @4, @5, null, @6, null, null, null)
go

--=============== END COMMAND =============== 
```

I have exhausted every thought I have on what is causing this so any idea that you have that can get me to look in a new direction is appreciated.

Thanks, Rick

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T08:38:19.170

成功插入实体后，尝试在实体上调用`AcceptChanges`或。`MarkAsUnchanged`

# java - 一个 JasperViewer 中的多个 JasperPrints

> ID：11093784
> 
> 赞同：1
> 
> 时间：2012-06-19T02:52:24.150
> 
> 标签：java, jasper-reports

我有一个报告，它基本上是一个包含多个空字段和程序生成的序列号的表单。目前，用户只能按时间获得其中一个，所以我希望用户可以选择所需的份数，然后`JasperViewer`在一个窗口中显示所有副本，而不是多个窗口作为份数。提前致谢。

**为糟糕的英语道歉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T19:14:39.577

好吧，您可以拥有一个 JasperPrint 对象列表并使用导出器将它们导出到一个报告中。但是，我不确定您是否可以使用 JasperViewer 来查看它们。

不过，每个 JasperPrint 对象都有一个页面集合。因此，您可以使用 addPage() 方法获取第一个 JasperPrint 对象并附加来自其他报告的页面。

# iphone - 将 Unity3D 作为子项目的 Xcode 工作区？

> ID：11093792
> 
> 赞同：8
> 
> 时间：2012-06-19T02:54:08.700
> 
> 标签：iphone, objective-c, ios, xcode, unity3d

假设我们正在使用 Cocos2d-iPhone 和 UIKit 和 CoreAnimation 开发 2D 游戏。但我们也在考虑利用 Unity 3D 的 3D 功能。

是否可以将 Unity3D 生成的 Xcode 项目作为子项目添加到工作区中，并将 3D UI 元素公开为某种 UIView 子类，以便本机 UIKit 和 CoreAnimation 代码可以使用它们而无需搞砸他们底层的 Unity3D 实现？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-01T11:09:04.257

是的，这是可能的。

Blurst 的人[制作](http://technology.blurst.com/a-cocoa-based-frontend-for-unity-iphone-applications/)了一些游戏，使用 Cocoa 作为前端和 Unity 到 3D 的东西。看看下面的链接，关于它们的信息非常好：

*   [一个基于 Cocoa 的 Unity iPhone 应用程序前端](http://technology.blurst.com/a-cocoa-based-frontend-for-unity-iphone-applications/)
*   [构建 iOS Unity + UIView / UIViewController / Interface Builder App](http://alexanderwong.me/post/29949258838/building-a-ios-unity-uiview-uiviewcontroller)
*   [iPhone Native UI 和 Unity 3 Pro 的实验](http://clevermartian.com/blog/?p=59)
*   [Unity Iphone App 嵌入objectiveC 应用程序](http://forum.unity3d.com/threads/50953-Unity-Iphone-App-Embebed-in-objectiveC-app)

# python - pinax-admin：找不到命令

> ID：11093797
> 
> 赞同：0
> 
> 时间：2012-06-19T02:55:14.000
> 
> 标签：python, django, pinax

我正在尝试安装`pinax`在`django 1.4.0`. 我正在使用`git`安装pinax ...

```
-e git+git://github.com/pinax/pinax.git#egg=pinax 
```

现在..当我激活我的`virtualenv`.

```
/djangoproj$ virtualenv mysite-env

New python executable in mysite-env/bin/python
Installing setuptools............done.
Installing pip...............done.

/djangoproj$ source mysite-env/bin/activate
/djangoproj$ pinax-admin setup_project mysite
pinax-admin: command not found 
```

我得到了错误`pinax-admin: command not found`。

我正在关注此文档[http://pinax.readthedocs.org/en/latest/gettingstarted.html#prerequisites](http://pinax.readthedocs.org/en/latest/gettingstarted.html#prerequisites)

我哪里做错了？我确实安装`Pinax`了，`git`所以我不需要安装它，`pip`因为它已经安装了......

有谁知道我该如何处理我的案子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T06:49:23.330

我认为最好使用[pip 要求文件](http://www.pip-installer.org/en/latest/requirements.html)和`pinax`所有必需的模块来设置您的环境。这样您就可以轻松地在其他主机上测试您的应用程序。

对于初始开发环境：

*   创建一个`virtualenv`
*   安装所有你需要的`pip`
*   创建一个需求文件：（`pip freeze > requirements.txt`这应该在你的仓库中）
*   开发您的应用程序

对于新的开发环境：

*   创建一个`virtualenv`
*   使用您的应用和 requirements.txt 克隆您的存储库
*   `pip -r requirements.txt`
*   你完成了

# ef-code-first - EF Migrations: Move Table from 2 Column PK to Single Column causes ALTER before DROP and fails

> ID：11093803
> 
> 赞同：6
> 
> 时间：2012-06-19T02:56:30.493
> 
> 标签：ef-code-first, entity-framework-migrations

I'm using EF 4.3.1 Code First Migrations. I have a table like:

```
public class Product
{
    [Key]
    [Column(Order=0)]
    [MaxLength(100)]
    public string Store { get; set; }

    [Key]
    [Column(Order=1)]
    [MaxLength(100)]
    public string Sku { get; set; }
}​ 
```

I have an existing table created with the above code. I then moved it to a single-column Primary Key:

```
public class Product
{
    [MaxLength(100)]
    public string Store { get; set; }

    [Key]
    [MaxLength(100)]
    public string Sku { get; set; }
}​ 
```

This causes EF to fail in the next automatic migration, complaining:

> ALTER TABLE [Product] ALTER COLUMN [Store] nvarchar
> 
> The object 'PK_Product' is dependent on column 'Store'. ALTER TABLE ALTER COLUMN Store failed because one or more objects access this column.

Clearly the PK_Product needs to be dropped before attempting to fire this ALTER statement (why is it altering the column at all?), but instead the migration fails.

Am I doing something wrong or is this a bug? Workarounds?

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-19T19:58:12.123

您将无法通过自动迁移来执行此操作。您必须使用创建迁移`Add-Migration`，然后对其进行更改，使其仅修改 PK。

迁移可以很简单：

```
public partial class TheMigration : DbMigration
{
    public override void Up()
    {
        DropPrimaryKey("Products", new[] { "Store", "Sku" });
        AddPrimaryKey("Products", "Sku");
    }

    public override void Down()
    {
        DropPrimaryKey("Products", new[] { "Sku" });
        AddPrimaryKey("Products", new[] { "Store", "Sku" });
    }
} 
```

EF 正在更改该列，因为当它是 a 的一部分时`Key`，它是隐含的`NOT NULL`。您可以保持原样、添加属性或允许 EF 在删除 PK**后**`[Required]`更改列。

# jquery - How to include Jquery in the background script (not the content script) for my Firefox Jetpack Addon?

> ID：11093805
> 
> 赞同：3
> 
> 时间：2012-06-19T02:56:50.547
> 
> 标签：jquery, firefox-addon, firefox-addon-sdk

I'm working on porting a Chrome extension over to Firefox. In the Chrome extension, the background script includes JQuery, which is used for AJAX throughout the background scripts.

With the Firefox Jetpack SDK, it looks like i can do:

```
require("modulename") 
```

but this only works if modulename is a firefox extension module, including the code:

```
exports.someVar = someLocalVar 
```

in order to make the module functionality available elsewhere. Obviously JQuery isn't set up as a module like this, so there's no way to require it.

Is there some way to include JQuery in my lib/main.js file in the background of my Firefox addon, such that I get access to JQuery in my main() function?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T13:51:04.593

自从发布此消息以来，我已经认识到这是一项徒劳的努力。正如 Wladimir Palant 在评论中指出的那样，JQuery 旨在访问 DOM。由于 main.js 文件没有窗口或文档对象，因此此功能完全没用。

我本来打算将 JQuery 用于 AJAX，它在 Chrome 背景脚本中可以正常工作，但是 Firefox 插件没有 XMLHttpRequest 对象，所以 JQuery 在这里也没什么用。正确的解决方案是改用 firefox Request() API 重写我的代码。

如果您想在 CommonJS 应用程序中包含 JQuery，我发现了这个项目，它将 JQuery 放入一个模块中，假设您定义了窗口、文档和 XMLHttpRequest：[https ://github.com/jakobmattsson/commonjs-jquery](https://github.com/jakobmattsson/commonjs-jquery)

# html - z-index 未应用 - 即使所有项目都设置了位置

> ID：11093807
> 
> 赞同：0
> 
> 时间：2012-06-19T02:57:35.350
> 
> 标签：html, css, z-index

嗨，我有一些 css3 和 html5，它们在记事本上显示一些文本，后面的页面请参见[http://www.sich.co.uk/test/index.html](http://www.sich.co.uk/test/index.html)。

问题似乎出在 z-index 上，应该通过在文章标签中输入高 z-index no 来解决，但是如果我在测试页面上这样做，它会失败。所以在测试代码中我只要放一个 z-index: 2; 例如在文章中它失败了。把它拿出来，它工作得很好。

在文章标签中 z-index:2; 已经在简单地用 firebug 删除以查看它的外观。

我一直在用头撞这块砖墙。任何帮助，将不胜感激。我已经包含了源 html，然后是 CSS。

任何想法将不胜感激。

难倒

保罗

HTML

```
<!doctype html>
<html>
<head>
    <title>Journal</title>
    <link href='http://fonts.googleapis.com/css?family=Patrick+Hand' rel='stylesheet'>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<article>
    <h1>Journal Entry #2</h1>
    <p>
        Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
        tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
        quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
        consequat. Duis aute irure dolor in reprehenderit.
    </p>
    <p>
        Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
        tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
        quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
        consequat. Duis aute irure dolor in reprehenderit.
    </p>
</article>

<script src="http://localhost:35729/livereload.js"></script>

</html> 
```

CSS

```
body {
   width: 540px;
   margin: auto;
   font-family: 'Patrick Hand', sans-serif;
   background: #666;
   color: #666;
}

article {
   margin: 50px auto;
   padding: 20px 50px;
   position: relative;
   z-index: 2;               /****** REMOVE THIS z-index to see it working properly *****/ 

   -webkit-box-shadow: 0 0 10px rgba(0,0,0,.15);
   -moz-box-shadow: 0 0 10px rgba(0,0,0,.15);
   box-shadow: 0 0 10px rgba(0,0,0,.15);
   background: #fcf59b;

   background-image: -webkit-gradient(linear, left top, left bottom, from(#81cbbc), color-stop(2%, #fcf59b));
   background: -webkit-linear-gradient(top, #81cbbc, #fcf59b 2%);
   background: -moz-linear-gradient(top, #81cbbc, #fcf59b 2%);
   background: -o-linear-gradient(top, #81cbbc, #fcf59b 2%);
   background: -ms-linear-gradient(top, #81cbbc, #fcf59b 2%);
   background: linear-gradient(top, #81cbbc, #fcf59b 2%);

   -webkit-background-size: 100% 40px;
   -moz-background-size: 100% 40px;
   background-size: 100% 40px;
}

article,article:before,article:after {
   -webkit-border-bottom-left-radius: 20px 500px;
   -webkit-border-bottom-right-radius: 500px 30px;
   -webkit-border-top-right-radius: 5px 100px;

   -moz-border-radius-bottomleft: 20 500px;
   -moz-border-radius-bottomright: 500px 30px;
   -moz-border-radius-topright: 5px 100px;

   border-radius-bottomleft: 20 500px;
   border-radius-bottomright: 500px 30px;
   border-radius-topright: 5px 100px;
}

article:after,article:before {
   content: ' ';
   width: 100%;
   height: 100%;
   left: 0;
   top: 0;
   z-index: 1;
   position: absolute;
}

article:before {
   background: #fcf6a7;

   -webkit-transform: rotate(4deg);
   -moz-transform: rotate(4deg);
   -o-transform: rotate(4deg);
   -ms-transform: rotate(4deg);
   transform: rotate(4deg);
}

article:after {
   background: #fcf7b1;

   -webkit-transform: rotate(-4deg);
   -moz-transform: rotate(-4deg);
   -o-transform: rotate(-4deg);
   -ms-transform: rotate(-4deg);
   transform: rotate(-4deg);
}

p {
   line-height: 2.5em;
   margin-bottom: 40px;
}

h1 {
   padding-top: 8px;
   margin-bottom: -8px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T03:35:47.517

我不确定这是否是您要查找的内容，但是如果您`<div style="z-index: 2;">`立即将其添加为 的子项`<article contenteditable>`，则它可能就是您要查找的内容。`</div>`（并在之前添加关闭`</article>`。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T04:21:36.410

我们通过删除伪元素并使用以下代码解决了这个问题。

```
<div class="notepad-container">
     <div class="page1"></div>
     <div class="page2"></div>
     <div class="notepad"></div>
     <h2>Our clients will forget what we said, they will forget what we did, but they will always remember how good we made them feel.</h2>
</div> 
```

和下面的CSS

```
/***********************************************
* Create notepad style box for our text
************************************************/

.notepad-container {
   width: 550px;
   margin: auto;
   margin-bottom:30px;
   margin-top:15px;
   height: 200px;
   position:relative;
   z-index: 0;

}

.notepad, .page1, .page2 {
   width: 550px;
   height:200px;
   position: absolute;
   top:0;
   left:0;

   -webkit-border-bottom-left-radius: 20px 500px;
   -webkit-border-bottom-right-radius: 500px 30px;
   -webkit-border-top-right-radius: 5px 100px;

   -moz-border-radius-bottomleft: 20 500px;
   -moz-border-radius-bottomright: 500px 30px;
   -moz-border-radius-topright: 5px 100px;

   border-radius-bottomleft: 20 500px;
   border-radius-bottomright: 500px 30px;
   border-radius-topright: 5px 100px;

}
.notepad {
   background: #fcf59b;

   -webkit-box-shadow: 0 0 10px rgba(0,0,0,.15);
   -moz-box-shadow: 0 0 10px rgba(0,0,0,.15);
   box-shadow: 0 0 10px rgba(0,0,0,.15);

   background-image: -webkit-gradient(linear, left top, left bottom, from(#81cbbc), color-stop(2%, #fcf59b));
   background: -webkit-linear-gradient(top, #81cbbc, #fcf59b 2%);
   background: -moz-linear-gradient(top, #81cbbc, #fcf59b 2%);
   background: -o-linear-gradient(top, #81cbbc, #fcf59b 2%);
   background: -ms-linear-gradient(top, #81cbbc, #fcf59b 2%);
   background: linear-gradient(top, #81cbbc, #fcf59b 2%);

   -webkit-background-size: 100% 40px;
   -moz-background-size: 100% 40px;
   background-size: 100% 40px;
}

.page1 {
   background: #fcf6a7;
   left: 0;
   top: 0;

   -webkit-transform: rotate(4deg);
   -moz-transform: rotate(4deg);
   -o-transform: rotate(4deg);
   -ms-transform: rotate(4deg);
   transform: rotate(4deg);
   position: absolute;
   z-index: -1;
}

.page2 {
   background: #fcf7b1;

   left: 0;
   top: 0;
   -webkit-transform: rotate(-4deg);
   -moz-transform: rotate(-4deg);
   -o-transform: rotate(-4deg);
   -ms-transform: rotate(-4deg);
   transform: rotate(-4deg);
   position: absolute;
   z-index: -1;
}

.notepad-container h2 {
   font-family: 'bad script', sans-serif;
   line-height: 1.7em!important;
   margin-bottom: 40px;
   margin-top: 0px;
   font-style:italic;
   position: absolute;
   margin: 0px auto;
   padding: 10px 50px;

   z-index: 2;
   width: 450px;
   height: 250px;
   top:0;
   left:0;

} 
```

请参阅我的 WordPress[主页](http://www.sich.co.uk)以了解它的实际应用。

# android - 保存大量安卓设置

> ID：11093812
> 
> 赞同：0
> 
> 时间：2012-06-19T02:58:05.607
> 
> 标签：android, sqlite, preferences

我有一个包含大量设置的应用程序，其中包含**7 个字符串数组、3 个字符串和一个日期**。是否建议将其存储到***sqlite 数据库中，或者我可以使用首选项还是有其他选择***？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T04:18:55.040

android中设置和首选项的推荐存储是Preferences，您可以将StringArray保存到首选项中，首先将其转换为Set，然后存储到首选项中，方法是：

```
prefEditor.putStringSet("key", set); 
```

# php - php remove value from array

> ID：11093814
> 
> 赞同：-3
> 
> 时间：2012-06-19T02:58:17.660
> 
> 标签：php, arrays

Hi I need help in removing values from an array using a recursive function

```
$array = [0] => testing,testing1
[1] => testing,testing1,testing2
[2] => testing,testing1,testing2,testing3
[3] => testing,testing1,testing2,testing3,tesing4
[4] => testing,testing1,testing2,testing3,tesing4
[5] => testing,testing1,testing2,testing3,tesing4
[6] => testing,testing1,testing2,testing3,tesing4
[7] => testing,testing1,testing2,testing3,tesing4 
```

I need to check the array count, ie `if count(array[0]) == count(array[1]),then reutrn array else unset(array[value]);`

From the above array I have to remove `array[0],[1],[2]` and return rest of the array values.

I've tried the below code

```
$idx =10;
$separtor =',';
function array_delete($idx, $array,$separtor) {
  $finalvalue = array();
for ($i = 0; $i < $idx; $i++) {
   $values = explode($separtor, $array[$i]);
   $valuesnext = explode($separtor, $array[$i+1]);
       if(count($values) != count($valuesnext) )
       {
            unset($array[$i]);
           // reset($array);
           // array_delete($idx, $array,$separtor);
            if (is_array($array)) $array = array_delete($idx, $array,$separtor);
            $finalvalue =  $array;
       }else
       {

       }
    //echo $i;

}
return $finalvalue;
//(is_array($array)) ? array_values($array) : null;
//array_delete($idx, $array,$separtor);
} 
```

I'm getting `Notice: Undefined offset: 0 when trying calling recursive, going to infinite loop`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T03:35:30.207

如果我理解正确，您希望过滤数组，使最终数组中的任何值与源数组中的最后一个元素的长度相同。为了避免在迭代数组时对其进行变异，此技术会使用符合您的条件的元素构建一个新数组。

```
$matchLength = count($mainArray[count($mainArray) - 1]);
$resultArray = array();
for($i = 0; $i < count($mainArray); $i++) {
    if(count($mainArray[$i]) == $matchLength) {
        $resultArray[] = $mainArray[$i];
    }
} 
```

如果您碰巧使用的是 PHP 5.3 或更高版本，则可以使用闭包和 array_filter 更快地完成此操作：

```
$matchLength = count($mainArray[count($mainArray) - 1]);
$resultArray = array_filter($mainArray, function($element){return count($element) == $matchLength}); 
```

仔细检查代码，我最近没有写 PHP，所以这只是一个想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T19:19:56.140

根据您给出的描述，可以直接制作（检查当前和前一个的计数，如果它们不匹配，则删除前一个）。

示例/[演示](http://codepad.org/Pk5Yilwr)：

```
unset($prevKey);
$count = array();
foreach (array_keys($array) as $key) {
    $count[$key] = count($array[$key]);
    if (isset($prevKey) && $count[$prevKey] !== $count[$key]) {
        unset($array[$prevKey]);
    }
    $prevKey = $key;
} 
```

如果您需要重新迭代以考虑删除，那么一点 goto 可以完成工作[Demo](http://codepad.viper-7.com/AkBEob)：

```
start:
######
unset($prevKey);
$count = array();
foreach (array_keys($array) as $key) {
    $count[$key] = count($array[$key]);
    if (isset($prevKey) && $count[$prevKey] !== $count[$key]) {
        unset($array[$prevKey]);
        goto start;
        ###########
    }
    $prevKey = $key;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T09:51:11.647

你想保留拥有最多项目的子数组吗？你的描述似乎是这样说的。

如果是这样，类似以下内容就足够了。

```
// Get maximum number of items in the arrays
$max_count = max(array_map('count', $array));

// Keep only those arrays having $max_count items
$filtered  = array_filter($array, function ($a) use ($max_count) {
    return count($a) === $max_count;
}); 
```

^(另外：如果您需要过滤后的数组具有从零开始的键，请调用`array_values()`它。)

请参阅[在线运行的示例](http://codepad.viper-7.com/xOB7qY)。

# php - MongoDB Group by Key PHP

> ID：11093816
> 
> 赞同：0
> 
> 时间：2012-06-19T02:58:32.963
> 
> 标签：php, mongodb, mongodb-php

Ok, so I have a collection in my MongoDB

here is a sample my key here is

> company

```
{
   "_id": ObjectId("4fdfe7b536314b4147000000"),
   "company": "hoyts",
   "barcode": "236602253",
   "name": "Gold Class",
   "logoURL": "http: \/\/www.incard.com.au\/newsite\/template\/images\/movieticket\/4cinemas\/ticketpic1.png",
   "store_name": "movies" 
} 
```

Now the issue here is I have 4 rows/collects with hoyts, I need away to group them.

my current code

```
public function getstore($storename)
    {
        // select a collection (analogous to a relational database's table)
         $collection = $this->db->products;

        // find everything in the collection
        $cursor = $collection->find(array("store_name"=>$storename));

        $test = array();
            // iterate through the results
            while( $cursor->hasNext() ) {
                $test[] = ($cursor->getNext());
            }
        //Print Results 
        print json_encode($test);

    } 
```

I tried using

> group($key)->find

however that did not work.

Could someone give me a hand thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T03:40:08.130

看这个例子： http: [//php.net/manual/en/mongocollection.group.php](http://php.net/manual/en/mongocollection.group.php)

# c# - 在 tiff 查看器中压缩图像

> ID：11093817
> 
> 赞同：0
> 
> 时间：2012-06-19T02:58:39.923
> 
> 标签：c#, asp.net, image-processing, tiff

我为我的 Web 应用程序创建了 Tiff 文件查看器，它运行良好。但问题是我需要以原始尺寸显示一些大图像（4000 X 2000 - 5+ MB）。

是否可以压缩图像的大小，然后将流发送到 ashx 页面上的响应流？

请注意，我所有的图像都是扫描的黑白图像。但是为了预防起见，我想检查是否将特定于黑白图像的压缩算法应用于图像。

查看以下 TiffHelper 类的代码

```
using System;
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using System.Drawing.Drawing2D;

public class TiffHelper
{
    public static int GetPageCount(String filePath)
    {
        int pageCount = 0;
        try
        {
            using (Image img = Image.FromStream(
                                new FileStream(filePath,
                                 FileMode.Open,
                                 FileAccess.Read,
                                 FileShare.ReadWrite)
                           ))
            {
                pageCount = img.GetFrameCount(FrameDimension.Page);
            }
        }
        catch (Exception ex)
        {
            CException.SuppressException(ex);
            pageCount = -1;
        }

        return pageCount;
    }

    public static Image GetTiffImage(String sourceFile, int pageNumber, int thumbnailSize, int degree)
    {
        MemoryStream ms = null;
        Image sourceImage = null;
        Image returnImage = null;

        try
        {
            sourceImage = Image.FromStream(
                                new FileStream(sourceFile,
                                 FileMode.Open,
                                 FileAccess.Read,
                                 FileShare.ReadWrite)
                           );
            ms = new MemoryStream();
            FrameDimension FrDim = new FrameDimension(sourceImage.FrameDimensionsList[0]);
            sourceImage.SelectActiveFrame(FrDim, pageNumber - 1);

            sourceImage.Save(ms, ImageFormat.Tiff);

            /*
            EncoderParameter qualityParam = new EncoderParameter(Encoder.Quality, 90);
            ImageCodecInfo tiffCodec = GetEncoderInfo("image/tiff");
            EncoderParameters encoderParams = new EncoderParameters(1);
            encoderParams.Param[0] = qualityParam;

            sourceImage.Save(ms, tiffCodec, encoderParams); 
            */

            /*
            EncoderParameters iparams = new EncoderParameters(2);
            iparams.Param[0] = new EncoderParameter(System.Drawing.Imaging.Encoder.SaveFlag, (long)EncoderValue.MultiFrame);
            iparams.Param[1] = new EncoderParameter(System.Drawing.Imaging.Encoder.Compression, (long)EncoderValue.CompressionCCITT4);
             * 
            sourceImage.Save(ms, GetEncoderInfo("image/tiff"), iparams);
            */

            int height = sourceImage.Height;
            int width = sourceImage.Width;

            if (thumbnailSize > 0)
            {
                if (sourceImage.Width < sourceImage.Height)
                {
                    width = thumbnailSize;
                    height = sourceImage.Height * thumbnailSize / sourceImage.Width;
                }
                else
                {
                    width = sourceImage.Width * thumbnailSize / sourceImage.Height;
                    height = thumbnailSize;
                }
            }

            //returnImage = ResizeImage(Image.FromStream(ms), new Size(width, height));

            returnImage = Image.FromStream(ms).GetThumbnailImage(width, height, null, IntPtr.Zero);
            returnImage.RotateFlip(GetFlipType(degree));
        }
        catch (Exception ex)
        {
            CException.SuppressException(ex);
        }
        finally
        {
            ms.Dispose();
            sourceImage.Dispose();
        }

        return returnImage;
    }

    private static Image ResizeImage(Image imgToResize, Size size)
    {
        int sourceWidth = imgToResize.Width;
        int sourceHeight = imgToResize.Height;

        float nPercent = 0;
        float nPercentW = 0;
        float nPercentH = 0;

        nPercentW = ((float)size.Width / (float)sourceWidth);
        nPercentH = ((float)size.Height / (float)sourceHeight);

        if (nPercentH < nPercentW)
            nPercent = nPercentH;
        else
            nPercent = nPercentW;

        int destWidth = (int)(sourceWidth * nPercent);
        int destHeight = (int)(sourceHeight * nPercent);

        Bitmap b = new Bitmap(destWidth, destHeight);
        Graphics g = Graphics.FromImage((Image)b);

        g.InterpolationMode = InterpolationMode.HighQualityBicubic;
        g.SmoothingMode = SmoothingMode.HighSpeed;
        g.PixelOffsetMode = PixelOffsetMode.HighSpeed;
        g.CompositingQuality = CompositingQuality.HighQuality;

        g.DrawImage(imgToResize, 0, 0, destWidth, destHeight);
        g.Dispose();

        return (Image)b;
    }

    private static ImageCodecInfo GetEncoderInfo(string mimeType)
    {
        ImageCodecInfo[] codecs = ImageCodecInfo.GetImageEncoders();

        for (int i = 0; i < codecs.Length; i++)
        {
            if (codecs[i].MimeType == mimeType)
            {
                return codecs[i];
            }
        }

        return null;
    }

    private static RotateFlipType GetFlipType(int degree)
    {
        switch (degree)
        {
            case 90:
                return RotateFlipType.Rotate90FlipNone;
            case 180:
                return RotateFlipType.Rotate180FlipNone;
            case 270:
                return RotateFlipType.Rotate270FlipNone;
            case -90:
                return RotateFlipType.Rotate90FlipXY;
            case -180:
                return RotateFlipType.Rotate180FlipNone;
            case -270:
                return RotateFlipType.Rotate270FlipXY;
            default:
                return RotateFlipType.RotateNoneFlipNone;
        }
    }
} 
```

# java - 异常：“处理程序没有适配器。您的处理程序是否实现了受支持的接口，例如控制器？”

> ID：11093818
> 
> 赞同：6
> 
> 时间：2012-06-19T02:58:43.157
> 
> 标签：java, spring, hibernate, jsp, hibernate-validator

我正在尝试使用 Spring 和 Hibernate 使用[HibernateValidator](http://sourceforge.net/projects/hibernate/files/hibernate-validator/4.0.2.GA/hibernate-validator-4.0.2.GA-dist.zip/download?use_mirror=nchc)在 JSP 中验证一个简单的表单。JSP 页面 Temp.jsp 如下（web.xml 中的 url pttern 为`*.htm`）。

```
<%@page contentType="text/html" pageEncoding="UTF-8" %>
<%@taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@taglib uri="http://www.springframework.org/tags/form" prefix="form" %>

<form:form method="post" action="Temp.htm" commandName="validationForm">
     <!--validationForm is a model class-->
<table>
    <tr>
        <td>User Name:<font color="red"><form:errors path="userName" /></font></td>
    </tr>

    <tr>
        <td><form:input path="userName" /></td>
    </tr>

    <tr>
        <td>Age:<font color="red"><form:errors path="age" /></font></td>
    </tr>

    <tr>
        <td><form:input path="age" /></td>
    </tr>

    <tr>
        <td>Password:<font color="red"><form:errors path="password" /></font></td>
    </tr>

    <tr>

    <td><form:password path="password" /></td>

    </tr>

    <tr>
        <td><input type="submit" value="Submit" /></td>
    </tr>
    </table>

</form:form> 
```

课程`validationForm`如下。

```
package validators;

import javax.validation.constraints.Max;
import javax.validation.constraints.Min;
import javax.validation.constraints.NotNull;
import javax.validation.constraints.Size;
import org.hibernate.validator.constraints.NotEmpty;
import org.springframework.format.annotation.NumberFormat;
import org.springframework.format.annotation.NumberFormat.Style;

final public class ValidationForm
{
    @NotEmpty
    @Size(min = 1, max = 20)
    private String userName;
    @NotNull
    @NumberFormat(style = Style.NUMBER)
    @Min(1)
    @Max(110)
    private Integer age;
    @NotEmpty(message = "Password must not be blank.")
    @Size(min = 1, max = 10, message = "Password must between 1 to 10 Characters.")
    private String password;

    public void setUserName(String userName)
    {
            this.userName = userName;
    }

    public String getUserName()
    {
            return userName;
    }

    public void setAge(Integer age)
    {
            this.age = age;
    }

    public Integer getAge()
    {
            return age;
    }

    public void setPassword(String password)
    {
            this.password = password;
    }

    public String getPassword()
    {
            return password;
    }
} 
```

并且`Controller`应该处理验证的类如下（我正在使用`SimpleFormController`）。

```
package controller;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import org.springframework.validation.BindException;
import org.springframework.web.servlet.ModelAndView;
import org.springframework.web.servlet.mvc.SimpleFormController;
import usebeans.TempService;
import validators.ValidationForm;

@SuppressWarnings("deprecation")
final public class Temp extends SimpleFormController 
{
    private TempService tempService=null;
    public Temp()
    {
        //setCommandClass(Temp.class);
        //setSuccessView("Temp");
        //setFormView("Temp");

        setCommandClass(ValidationForm.class); //Still not working.
        setCommandName("validationForm");
    }   

    public void setTempService(TempService tempService)
    {
        this.tempService = tempService;
    }

    @Override
    protected ModelAndView onSubmit(HttpServletRequest request, HttpServletResponse response, Object command, BindException errors) throws Exception
    {
        ModelAndView mv=new ModelAndView();
        ValidationForm validationForm=(ValidationForm) command;
        tempService.add(validationForm);
        return mv;
    }

    @Override
    protected ModelAndView showForm(HttpServletRequest request, HttpServletResponse response, BindException errors) throws Exception
    {
        ModelAndView mv=new ModelAndView();
        return mv;
    }
} 
```

在`dispatcher-servlet`中，我添加了以下内容。

```
<bean id="tempService" class="usebeans.TempServiceImpl" />
<bean name="/Temp.htm" class="controller.Temp" p:tempService-ref="tempService" p:formView="Temp" p:successView="Temp" /> 
```

还尝试添加以下bean仍然没有运气。

```
<bean class="org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter"/> 
```

其中`TempService`界面如下。

```
package usebeans;

import validators.ValidationForm;

public interface  TempService
{
    public void add(ValidationForm validationForm);
} 
```

以下是`TempServiceImpl`课程。

```
package usebeans;

import validators.ValidationForm;

final public class TempServiceImpl implements TempService
{
    public void add(ValidationForm validationForm)
    {
        System.out.println("Message");
    }
} 
```

尽管该类`TempServiceImpl`实现了`TempService`接口，但我得到了以下异常。

```
javax.servlet.ServletException: No adapter for handler [usebeans.TempServiceImpl@ab3cba]: Does your handler implement a supported interface like Controller?
at org.springframework.web.servlet.DispatcherServlet.getHandlerAdapter(DispatcherServlet.java:982)
at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:770)
at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:716)
at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)
at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:549)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:617)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.netbeans.modules.web.monitor.server.MonitorFilter.doFilter(MonitorFilter.java:393)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)
at org.apache.coyote.http11.Http11AprProcessor.process(Http11AprProcessor.java:859)
at org.apache.coyote.http11.Http11AprProtocol$Http11ConnectionHandler.process(Http11AprProtocol.java:579)
at org.apache.tomcat.util.net.AprEndpoint$Worker.run(AprEndpoint.java:1555)
at java.lang.Thread.run(Thread.java:619) 
```

* * *

**编辑 ：**

尽管我遵循[此处](http://www.vaannila.com/spring/spring-simple-form-controller-1.html)解释的内容，但问题仍然存在，并且我遇到了与上述相同的异常。我在这里缺少什么配置设置。它可能在`dispatcher-servlet.xml`文件中。整个`dispatcher-servlet.xml`文件如下。

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xmlns:aop="http://www.springframework.org/schema/aop"

       xmlns:tx="http://www.springframework.org/schema/tx"
       xmlns:context="http://www.springframework.org/schema/context"

       xmlns:mvc="http://www.springframework.org/schema/mvc"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
       http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd">

        <bean class="org.springframework.web.servlet.mvc.support.ControllerClassNameHandlerMapping"/>    
        <bean class="org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter" />

        <bean id="tempService" class="usebeans.TempServiceImpl" />
        <bean name="/Temp.htm" class="controller.Temp" p:tempService-ref="tempService" p:formView="Temp" p:successView="Temp" />

        <bean id="urlMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
            <property name="mappings">
                <props>
                    <prop key="index.htm">indexController</prop>                
                    <prop key="Temp.htm">tempService</prop>                
                </props>
            </property>
        </bean>

        <bean id="viewResolver"
              class="org.springframework.web.servlet.view.InternalResourceViewResolver"
              p:prefix="/WEB-INF/jsp/"
              p:suffix=".jsp" />

        //The index controller.

        <bean name="indexController"
              class="org.springframework.web.servlet.mvc.ParameterizableViewController"
              p:viewName="index" />

</beans> 
```

我对抛出的异常没有任何确切的想法。你能弄清楚为什么会抛出这个异常吗？我在这里缺少什么配置设置或其他东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T04:32:41.353

我已经解决了这个问题，请找到新的 xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
    xmlns:aop="http://www.springframework.org/schema/aop" xmlns:tx="http://www.springframework.org/schema/tx"
    xmlns:context="http://www.springframework.org/schema/context"

    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
       http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd">

    <bean
        class="org.springframework.web.servlet.mvc.support.ControllerClassNameHandlerMapping" />
    <bean
        class="org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter" />

    <bean id="tempService" class="usebeans.TempServiceImpl" />
    <bean id="tempController" class="controller.Temp"/>

    <bean id="urlMapping"
        class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
        <property name="mappings">
            <props>
                <prop key="index.htm">indexController</prop>
                <prop key="Temp.htm">tempController</prop> <!-- You need to mapp the url to the controller bean-->
            </props>
        </property>
    </bean>

    <bean id="viewResolver"
        class="org.springframework.web.servlet.view.InternalResourceViewResolver"
        p:prefix="/WEB-INF/jsp/" p:suffix=".jsp" />

    <bean name="indexController"
        class="org.springframework.web.servlet.mvc.ParameterizableViewController"
        p:viewName="index" />

</beans> 
```

修复与`<prop key="Temp.htm">tempController</prop>`.

对于第二个错误，更改类`Temp`如下

```
package controller;

import java.util.HashMap;
import java.util.Map;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import org.springframework.validation.BindException;
import org.springframework.web.servlet.ModelAndView;
import org.springframework.web.servlet.mvc.SimpleFormController;
import usebeans.TempService;
import validators.ValidationForm;

@SuppressWarnings("deprecation")
final public class Temp extends SimpleFormController {
    private TempService tempService = null;

    public Temp() {
        // setCommandClass(Temp.class);
        // setSuccessView("Temp");
        // setFormView("Temp");

        setCommandClass(ValidationForm.class); // Still not working.
        setCommandName("validationForm");
    }

    public void setTempService(TempService tempService) {
        this.tempService = tempService;
    }

    @Override
    protected ModelAndView onSubmit(HttpServletRequest request,
            HttpServletResponse response, Object command, BindException errors)
            throws Exception {
        ModelAndView mv = new ModelAndView();
        ValidationForm validationForm = (ValidationForm) command;
        tempService.add(validationForm);
        return mv;
    }

    @Override
    protected ModelAndView showForm(HttpServletRequest request,
            HttpServletResponse response, BindException errors)
            throws Exception {
        Map<String, Object> model = new HashMap<String, Object>();
        model.put(getCommandName(), new ValidationForm());
        ModelAndView mv = new ModelAndView("Temp", model);
        return mv;
    }
} 
```

# c# - 使用 Windows 8 Metro 的 WebView 中的 JavaScript 错误

> ID：11093820
> 
> 赞同：17
> 
> 时间：2012-06-19T02:59:03.883
> 
> 标签：c#, exception-handling, webview, windows-runtime, winrt-xaml

我在我的应用程序的页面上有一个`<WebView>`控件。用户几乎可以输入他们喜欢的任何 URL 并将其显示在此 WebView 中。这是设计使然。

问题是，互联网上有些页面会抛出 JavaScript 错误，并且（出于某种原因）还会导致未处理的异常通过 .NET 应用程序冒泡。

我的问题是：使用 a 时在哪里捕获 JavaScript 异常/错误`<WebView>`？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-03T14:31:56.133

我有同样的问题。它在某种程度上与脚本的即时调试有关。尝试以下操作（来自 VS 2012）：取消选中脚本框 `Debug -> Options and Settings -> Debugging -> Just in time`

为我工作。

# scala - Scala 遍历 2 个集合并找到匹配项

> ID：11093823
> 
> 赞同：1
> 
> 时间：2012-06-19T02:59:35.973
> 
> 标签：scala

我有 2 个集合：`a`是一系列 Scala 对象`class C`。`b`是一个字符串序列。`C` 有一个字符串字段 ，`name`它可能匹配`b`. 我想要的是循环`a`并找到所有`c.name`与`b`. 我如何在 Scala 中做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T03:28:14.333

遍历 a 和 b 可能会变得昂贵，因为一个循环嵌套在另一个循环中会产生 O(n^2) 时间。如果 b 足够大，您可能希望首先将其变为 Set 以将其降低到 O(n)。

```
val bSet = b.toSet;
a.filter(c => b.contains(c.name)) 
```

我会将其读作“将以下过滤器应用于 a：对于 a 中的每个项目 c，当且仅当 c 的名称在 b 中时，将其包含在结果中。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T04:26:24.823

这是等效的 for 循环与 yield。

```
for(c <- a if b.contains(c.name)) yield c.name 
```

# memory-management - 在单个上下文中读取/写入多个 GPU 上的 OpenCL 内存缓冲区

> ID：11093826
> 
> 赞同：1
> 
> 时间：2012-06-19T03:00:15.513
> 
> 标签：memory-management, opencl, gpu

假设一个系统具有两个不同的 GPU，但来自同一供应商，因此可以从单个 OpenCL 平台访问它们。给定以下*简化*的OpenCL 代码：

```
float* someRawData;

cl_device_id gpu1 = clGetDeviceIDs(0,...);
cl_device_id gpu2 = clGetDeviceIDs(1,...);
cl_context ctx = clCreateContext(gpu1,gpu2,...);

cl_command_queue queue1 = clCreateCommandQueue(ctx,gpu1,...);
cl_command_queue queue2 = clCreateCommandQueue(ctx,gpu2,...);

cl_mem gpuMem = clCreateBuffer(ctx, CL_MEM_READ_WRITE, ...);
clEnqueueWriteBuffer(queue1,gpuMem,...,someRawData,...);
clFinish(queue1); 
```

在执行结束时，将`someRawData`在内存中的 GPU 上还是仅`gpu1`在内存中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T15:11:54.340

这取决于实现，数据将在调用后存储在哪里，`clFinish()`但很可能会在队列引用的 GPU 上。此外，这种抽象使得无需显式数据传输就可以`gpuMem`从启动的内核进行访问。`queue2`

# facebook - 如何自定义 Facebook 发送按钮？

> ID：11093828
> 
> 赞同：8
> 
> 时间：2012-06-19T03:00:35.943
> 
> 标签：facebook

我正在尝试自定义 facebook“发送”按钮的外观。

[我使用文档](https://developers.facebook.com/docs/reference/dialogs/send/)中提供的代码生成按钮，但是我不知道如何修改按钮的图像或文本？

谁能给我一个例子？我想javascript是我唯一的选择吗？

我的代码现在看起来像这样：

```
<fb:send href="http://www.mywebsite.com/something"></fb:send> 
```

这会生成一个如下所示的按钮：

![在此处输入图像描述](../Images/303596f49c6052933cc3846d6c4d9e88.png)

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-19T05:40:42.757

您不能自定义`<fb:send />`按钮。但是，您可以使用`FB.ui`( [http://developers.facebook.com/docs/reference/javascript/FB.ui/](http://developers.facebook.com/docs/reference/javascript/FB.ui/) ) 实现相同的功能。使用`send`方法，例如。

```
FB.ui({
    method: 'send',
    name: 'People Argue Just to Win',
    link: 'http://www.nytimes.com/2011/06/15/arts/people-argue-just-to-win-scholars-assert.html',
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-21T00:01:14.043

您始终可以根据需要创建自己的链接和样式，然后从[所有社交共享按钮链接列表的列表中](http://atlchris.com/1665/how-to-create-custom-share-buttons-for-all-the-popular-social-services/)添加链接- 这适用于共享到各种社交网站。

对于 Facebook 的分享链接，请在链接的 href 中使用以下代码替换`[URL]`并`[TITLE]`使用您的数据：`urlencode()`

```
http://www.facebook.com/share.php?u=[URL]&title=[TITLE] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T03:02:18.573

在自定义这些 Facebook 按钮方面，您几乎是 SOL。他们有意设计了他们的按钮，这样您就无法在 Facebook 提供的有限范围之外更改或自定义它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-07T06:00:25.847

Facebook 的发送按钮位于`iframe`. 如果您等待`iframe`加载，您可以使用 选择其内容`$('iframe').contents()`。所以替换文本看起来像

```
$(function(){
    $('.fb_iframe_widget iframe').on('load', function(){
        $(this).contents().find('.pluginButtonLabel').text('Custom Text');
    });
}); 
```

# android - 是否可以从 adobe air android 应用程序打印到无线打印机？

> ID：11093833
> 
> 赞同：1
> 
> 时间：2012-06-19T03:01:16.513
> 
> 标签：android, printing, air, adobe, wireless

嗨，我正在尝试使用 adobe air mobile 为 android 制作一个 POS 应用程序。我有一台连接到 Wifi 路由器的爱普生热敏打印机。我了解到 printjob 不适用于移动应用程序请给我一些解决方案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T05:48:57.097

我见过人们以三种不同的方式解决这个问题：

1.  使用打印机制造商的 API
2.  使用第 3 方打印应用程序
3.  编写自己的驱动程序

根据经验，#1 是迄今为止最好的选择。使用 API 会更好，因为它允许您对打印输出（字体、特殊设备命令等）进行完全自定义，并减少您花费在研究和编码上的时间。

3rd 方打印应用程序在定制方面受到限制。它们可能适用于全尺寸办公室或家庭打印机，但 POS 打印通常有更具体的要求，并且通常需要这些应用程序无法提供的定制级别。编写驱动程序很困难，因为您需要深入了解打印机的很多事情：如何建立通信、获取状态、格式化收据等等。这就像花费数月时间重新发明轮子，因为构建良好的 API 会为您处理所有这些。

我强烈建议您查看 Star 打印机。他们有一个很棒的 Android SDK 和一个打印 API，里面有很多示例并且有大量文档。[http://www.starmicronics.com/support/sdkdocumentation.aspx](http://www.starmicronics.com/support/sdkdocumentation.aspx)

# html - 用于两个不同任务的 html 单个提交按钮

> ID：11093840
> 
> 赞同：0
> 
> 时间：2012-06-19T03:02:28.053
> 
> 标签：html, jsp

我有一个 html 按钮，我想要在一次按下事件中执行两个不同的任务。首先，当我按下提交按钮时，它应该**将数据插入数据库**（我已经完成），另一个任务是**渲染到另一个页面**。我怎样才能让这个按钮同时执行这两个功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T02:33:54.847

那就“就”吧。

```
someDAO.save(someData);
response.sendRedirect(newURL); 
```

这基本上就是你需要在你的servlet（或者JSP，如果你仍然滥用它作为控制器）中执行的所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T13:55:09.760

`action`您可以通过指定元素的属性来做到这一点`form`：

```
<form method="post" action="page.jsp?action=save">
...
<input type="submit" value="Submit!" />
</form> 
```

单击`submit`按钮后，用户将被重定向到`page.jsp`（它可能是同一页面），并且在该文件中您可以获得`action`变量的值：如果是`save`则执行负责写入数据库的代码。在该代码之后放置页面呈现代码。

这是最简单的解决方案，但可能不是最优雅的。

# core-data - 当应用程序的后备存储既是文件数据库又是核心数据数据库时，UIDocument 或 UIManagedDocument

> ID：11093844
> 
> 赞同：0
> 
> 时间：2012-06-19T03:03:17.767
> 
> 标签：core-data, icloud, uidocument

我对应该从哪个类继承有点困惑。我的应用程序当前在“文档”文件夹中创建文件，并且还具有基于核心数据的数据模型。这些数据模型包含有关文件的更多信息。

现在我正在考虑将应用程序迁移到文档架构，从而一次与 iCloud 集成。

我已经开始考虑使用两者的方向，即使`UIDocument`用来管理文件和`UIManagedDocument`管理核心数据。

如果有人可以指导我，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T06:35:19.920

正如您所说，出于不同目的同时使用两者是完全可以接受的。

但是考虑一下，如果这些文件是真实的文档，而不仅仅是内部实现的一些数据文件，我个人不会将有关文档的任何关键数据与文档分开存储。由于从用户角度来看的文档是自我维持的——用户可以自由地创建、删除或移动它们，而不必担心与其他一些文档或对象有任何相互依赖关系。用户期望所有必要的元数据**随**文档一起移动。

再说一次，如果有一些“管理”元数据，您可以随时重新创建有关数据库中文档的信息，那很好。

# ios - 未调用 CLLocation Manager didStartMonitoringForRegion 委托方法

> ID：11093846
> 
> 赞同：3
> 
> 时间：2012-06-19T03:03:29.593
> 
> 标签：ios, geolocation

我正在尝试在我的应用程序中使用位置监控。我可以设置我的位置并反向地理编码我想要监控的位置。`didUpdateToLocation`委托方法工作正常，并且不断更新，但委托`didStartMonitoingForRegion`永远不会被调用，也`didExitRegion`不会`didEnterRegion`。

有什么建议么？

```
- (IBAction)setLocation:(UIButton *)sender {
    if(!self.locationManager) self.locationManager = [[CLLocationManager alloc] init];
    [self.locationManager setDelegate:self];
    [self.locationManager setDesiredAccuracy:kCLLocationAccuracyBest];
    [self.locationManager setDistanceFilter:10];  // Update again when a user moves     distance in meters

    [self.locationManager setPurpose:@"Set location based alerts if switch is on"];
    self.plugLocation=nil; //reset to nil so didUpdateToLocation will update it
    self.distanceLabel.text=[NSString stringWithFormat:@"%d",0];

    [self.locationManager startUpdatingLocation];

    if ( ![CLLocationManager regionMonitoringAvailable] || ![CLLocationManager regionMonitoringEnabled] ){
        NSLog(@"Location monitoring not  Unavailable");
    }else {

    }
}
-(void)setPlugLocation:(CLLocation *)plugLocation{
    //
    if (!_plugLocation) _plugLocation=[[CLLocation alloc]init];
        _plugLocation=plugLocation;
    if (_plugLocation) {
        [self setRegion:plugLocation radius:20 name:self.plugName];
        [self reverseGeocode:self.plugLocation];
         NSLog(@"setPlugLocation %@", [self.plugLocation description]);
            }
}

 -(void)setRegion:(CLLocation *)center radius:(double)meters name:(NSString*)name{
     CLLocationCoordinate2D plug2D;
     plug2D.latitude=center.coordinate.latitude;
     plug2D.longitude=center.coordinate.longitude;
     CLRegion *region = [[CLRegion alloc] initCircularRegionWithCenter:plug2D radius:meters identifier:name];
     [self.locationManager startMonitoringForRegion:region      desiredAccuracy:kCLLocationAccuracyBest]; 
 }

- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation{    
    self.latitudeLabel.text=[NSString stringWithFormat:@"%f",newLocation.coordinate.latitude];
    self.longitudeLabel.text=[NSString stringWithFormat:@"%f",newLocation.coordinate.longitude];

    if (self.plugLocation == nil)self.plugLocation = newLocation;
    if (self.plugLocation!=nil) {
    CLLocationDistance distanceBetween = [newLocation distanceFromLocation:self.plugLocation];
     NSLog(@"didUpdateToLocation Distance from plug=%f",distanceBetween);
    self.distanceLabel.text=[NSString stringWithFormat:@"%f",distanceBetween];
    }
}

 -(void)reverseGeocode:(CLLocation *)coordinates;{
     if (!self.plugGeo) self.plugGeo = [[CLGeocoder alloc] init];
[self.plugGeo reverseGeocodeLocation:coordinates completionHandler:^(NSArray *placemarks, NSError *error) {
    if (error==nil&&[placemarks count]>0) {
        CLPlacemark *placemark=[placemarks objectAtIndex:0];
        NSLog(@" setPlugLocation geocodeAddressString %@",placemark);
        //should also transfer back to plug detail and save
        self.locationLabel.text=[NSString stringWithFormat:@"%@ %@\n%@, %@", placemark.subThoroughfare,  placemark.thoroughfare, placemark.locality,placemark.postalCode];
        [self sendAlertMessage:[NSString stringWithFormat:@"%@ %@\n%@, %@", placemark.subThoroughfare,  placemark.thoroughfare, placemark.locality,placemark.postalCode] title:@"Success"];
    }else {
        NSLog(@" setPlugLocation couldn't geoCode address %@",error);
    }
}];  
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T17:22:31.363

您是否使用模拟器来测试您的应用程序？我发现模拟器对于区域退出/进入完全不可靠。尝试通过将项目插入并从 iPhone Simulator 更改为您的 iOS 设备来在您的设备上编译项目。然后，您可以拔下设备并从手机上运行您的应用程序来测试它。

为什么模拟器不适用于区域？区域主要由 Apple 的隐藏算法确定，该算法使用 Wi-Fi、手机信号塔和手机上请求位置的其他应用程序。将模拟器视为不使用 Wi-Fi 或手机信号塔……区域监控几乎是不可能的。

您的代码可能很好（我没有看到明显的错误），但是模拟器给您带来了不好的结果。在您的设备上试一试，如果它做同样的事情，请告诉我们。

# haskell - 具有多个类约束的 Haskell 类型签名

> ID：11093847
> 
> 赞同：30
> 
> 时间：2012-06-19T03:03:33.673
> 
> 标签：haskell, types, static-typing, type-signature

我怎么能有多个类约束，所以 if `A`is an `Eq`and `B`is a `Num`，我可以说要么

```
f :: Eq a => a -> b` 
```

或者

```
f :: Num b => a -> b 
```

那么，我怎样才能同时拥有`Eq a =>`和`Num b =>`呢？

*   `f :: Eq a => Num b => a -> b`,
*   `f :: Eq a -> Num b => a -> b`， 和
*   `f :: Eq a, Num b => a -> b`

没有做我想做的事。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-06-19T03:10:01.887

它们通常称为*类约束*，`Eq`也`Num`称为类型类。

这个怎么样？

```
f :: (Eq a, Num b) => a -> b 
```

括号很重要。

# ruby-on-rails - NilClass：Class的Rails未定义方法`model_name'

> ID：11093848
> 
> 赞同：7
> 
> 时间：2012-06-19T03:03:43.490
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有一个表单，我想出现在每个页面的顶部，所以我已经将它包含在 /app/views/layouts/application.html.erb 文件中，我`undefined method`在尝试时收到 NilClass:Class 的错误 model_name'加载页面。

这是 application.html.erb 中的表单片段

```
 <%= form_for @user do |f| %>
    <h3>Add new contact</h3>
    <%= f.text_field :first_name %><br />
    <%= f.text_field :last_name %>
    <%= f.text_field :email %>
    <hr />
    <%= f.submit "Add Contact" %>
<% end %> 
```

这是我的 /app/controllers/user_controller.rb

```
class UserController < ApplicationController

    def index

    end

    def new
        @user = User.new
    end

end 
```

我在想我遇到了这个错误，因为由于表单在 application.html.erb 文件中，我需要以某种方式指定路径，但是我对 Rails 还是很陌生。

让我知道您是否需要发布其他任何内容。

**编辑** 按照 Ola 的建议，在我的 app/views/layouts/application.html.erb 文件中，我有这样的内容：

```
<div>
<%= yield :add_user %>
</div> 
```

在我的 app/views/users/new.html.erb 文件中我有这个

```
<% content_for :add_user do %>
    <%= form_for @user do |f| %>
        <h3>Add new contact</h3>
        First Name<br />
        <%= f.text_field :first_name %><br />
        Last Name<br />
        <%= f.text_field :last_name %><br />
        Email<br />
        <%= f.text_field :email %>
        <hr />
        <%= f.submit "Add Contact" %>
    <% end %>
<% end %> 
```

表单未呈现，因为我的 url 是，因此它正在app/views/admin/index.html.erb 中`http://localhost:3000/admin/index`寻找content_for`add_user`

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-19T03:33:01.767

您是否先尝试调试？我问是因为你说你是 Rails 的新手。如果没有，这是我的方法。我想分享它，因为我很惊讶有多少人不（无论出于何种原因）仔细调试。

（我创建了一个测试应用程序，以便我可以解决您的问题。首先，我访问了`http://localhost:3000/users`。）

首先，查看堆栈跟踪。

> 用户中的 NoMethodError#index
> 
> 显示 /Users/david/dev/testapp/app/views/layouts/application.html.erb 其中第 11 行提出：
> 
> NilClass:Class 的未定义方法“model_name”提取的源代码（第 11 行附近）：

```
8: </head>
9: <body>
10: 
11: <%= form_for @user do |f| %>
12:     <h3>Add new contact</h3>
13:     <%= f.text_field :first_name %><br />
14:     <%= f.text_field :last_name %> 
```

这告诉您代码中的第 11 行是问题所在。想想 - 可能是什么问题？路由不太可能，因为您只是在呈现页面。不是语法错误，这会触发另一个错误。好的，请继续阅读：

> Rails.root：/Users/david/dev/testapp
> 
> 应用程序跟踪 | 框架跟踪 | 全跟踪

现在单击“框架跟踪”，您将看到：

> activemodel (3.2.6) lib/active_model/naming.rb:163:in `model_name_from_record_or_class' activemodel (3.2.6) lib/active_model/naming.rb:158:in`param_key' actionpack (3.2.6) lib/action_view/helpers/form_helper.rb:369:in `form_for'

你可能不明白这一切——很少有人明白——但是你会看到错误来自`model_name_from_record_or_class`哪个来自`param_key`哪个来自哪个`form_for`。这是一个很大的线索！

我推荐使用`open_gem`gem 来方便地挖掘源代码：

```
gem install open_gem 
```

现在，看一下 activemodel，因为它是堆栈跟踪中最顶层的 gem：

```
gem open activemodel 
```

现在，在启用正则表达式搜索的情况下进行搜索：

> def .*model_name_from_record_or_class

（为什么？你想找到类方法——例如以同样开头的定义`self`。）

这将带您到第 162 行`naming.rb`。

```
def self.model_name_from_record_or_class(record_or_class)
  (record_or_class.is_a?(Class) ? record_or_class : convert_to_model(record_or_class).class).model_name
end 
```

即使不了解所有这些，它也确实给出了一个很大的提示……该方法尝试从记录或类中返回模型名称。为什么不能呢？因为您传递的参数 ,`@user`尚未设置。未设置的实例变量的值为 nil，因此在您尝试使用它做某事之前它不会抱怨。

我希望这对这个问题和未来的问题有所帮助。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-19T03:07:57.117

如果表单包含在多个操作（页面）中，您需要设置`@user`为某些内容，否则该`form_for`指令将失败（它没有任何内容可以为 创建表单*）*。

一种更好的方法（也是 Rails 的默认设置）是为每个操作设置单独的视图，每个视图只包含该操作所需的元素，并`application.html.erb`使用`<%= yield %>`. 所以你会有一个`app/views/users/new.html.erb`包含表单的视图。你~~从来~~不需要在 Rails 中定义任何加载路径，它们都来自模型、控制器和动作名称——或者来自你的`routes.rb`. 这是在 Rails 中运行得如此之深的*[约定优于配置](http://en.wikipedia.org/wiki/Convention_over_configuration)*范式的核心部分。

**编辑：**如果您*确实*需要在每个页面上创建一个新对象的表单（例如，通常用于 UserSessions），您可以重写您的表单`form_for`，使其不依赖于存在的对象：

```
form_for(User.new) 
```

或者如果您需要强制它发布到`create`方法

```
form_for(User.new, :url => { :action => "create" }) 
```

`form_for`您可以在[Ruby On Rails API 文档](http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-form_for-label-Resource-oriented+style)中阅读有关资源驱动的更多信息。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-06-19T03:33:07.867

这个答案实际上只是 Someth 的答案更正，但解决方案是`@user`为每个控制器操作设置，而不仅仅是与特定控制器有关的操作。这可以通过`before_filter`在 ApplicationController 中使用 a 来完成，即

```
class ApplicationController < ActionController::Base
  before_filter :initialize_user

  def initialize_user
    @user = User.new
  end
end 
```

*或者*通过在 form_for 助手本身中创建一个新模型（注意：这在关注点分离方面很难看，但它有效......）

```
 <%= form_for User.new do |f| %>
   <h3>Add new contact</h3>
   <%= f.text_field :first_name %><br />
   <%= f.text_field :last_name %>
   <%= f.text_field :email %>
   <hr />
   <%= f.submit "Add Contact" %>
 <% end %> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-19T03:17:57.993

您的问题是您试图为页面上的每个操作添加表单，但没有在所有操作中初始化用户。尝试在所有操作中初始化用户：

```
class UserController < ApplicationController
    before_filter :initialize_user

    def index

    end

    def initialize_user
        @user = User.new
    end

end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-11T04:43:57.543

在用户控制器中：

```
def index
   @user = User.new
end 
```

# facebook - 错误：当 Heroku 开始使用 facebook 应用程序时

> ID：11093849
> 
> 赞同：0
> 
> 时间：2012-06-19T03:04:07.203
> 
> 标签：facebook, git, command-line, heroku

当我进入`$git remote`命令行响应：

> 致命：不是 git 存储库（或任何父目录）：.git

不知道该怎么做，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T03:25:49.420

看看 Heroku 的[Deploying with Git](https://devcenter.heroku.com/articles/git)。

1.  设置您的 Git 存储库。
2.  添加`heroku`遥控器。
3.  部署您的代码。

您需要初始化用于跟踪 Git 的任何代码项目目录。然后，您需要添加一个 Git 远程（通常称为`heroku`）以指向 Heroku Git 远程存储库。然后，您可以获取代码并将其推送到该存储库。然后 Heroku 使用该存储库将您的应用程序部署到您的服务器。

我认为 Heroku 文档对您的帮助最大！

[https://devcenter.heroku.com/articles/git](https://devcenter.heroku.com/articles/git)

# c# - 通过应用设计模式进行代码重构

> ID：11093850
> 
> 赞同：3
> 
> 时间：2012-06-19T03:04:10.353
> 
> 标签：c#, oop, design-patterns

我必须编写 3 个接受 BaseClass 类型参数的函数，然后返回 DerivedClasses 作为返回值。

```
Public DerivedClass1 SimpleTest1(BaseClass baseType)
{
DerivedClass1 derivedClass1 = new DerivedClass1();
derivedClass1.item = baseType.item;
derivedClass1.itemGroup = baseType.itemGroup;
return derivedClass1;
}

Public DerivedClass2 SimpleTest2(BaseClass baseType)
{
DerivedClass2 derivedClass2 = new DerivedClass2();
derivedClass2.item = baseType.item;
derivedClass2.itemGroup = baseType.itemGroup;
return derivedClass2;
}

Public DerivedClass3 SimpleTest3(BaseClass baseType)
{
DerivedClass3 derivedClass3 = new DerivedClass3();
derivedClass3.item = baseType.item;
derivedClass3.itemGroup = baseType.itemGroup;
return derivedClass3;
} 
```

3种方法写的代码都是一样的！有没有更好的方法来实现这一点，而无需重复代码？我可以在这里应用特定的设计模式吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T03:09:03.053

在此使用泛型，您可以很好地表达它：

```
public T SimpleTest<T>(BaseClass baseType) where T : BaseClass, new()
{
    T derived = new T();
    derived.item = baseType.item;
    derived.itemGroup = baseType.itemGroup;
    return derived;
} 
```

有一个警告，你*必须*有一个默认的构造函数，否则这将不起作用。如果您有一个带有一个或多个参数的构造函数（但每个参数的签名相同），您可以使用反射动态实例化该类，如 dbaseman 的回答。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-19T03:09:08.353

这似乎是[泛型函数](http://msdn.microsoft.com/en-us/library/twcad0zb%28v=vs.100%29.aspx)的一个很好的应用......

```
public T SimpleTest<T>(BaseClass baseType) where T : BaseClass
{
    T derivedClass = Activator.CreateInstance<T>();
    derivedClass.item = baseType.item;
    derivedClass.itemGroup = baseType.itemGroup;
    return derivedClass
} 
```

# jquery - 淡出除 (this) 之外的所有内容 - 同时尊重 click()

> ID：11093852
> 
> 赞同：0
> 
> 时间：2012-06-19T03:04:33.170
> 
> 标签：jquery, nav, fading

我正在尝试实现一个淡入淡出的导航系统，其中导航中的所有内容，但被悬停的元素都会淡出说，0.3 不透明度。

同时，我希望点击具有更大的“价值”，以免被点击的元素（或者在这种情况下，活动子页面）淡出。这对我来说也没有多大意义，我'我只是发布我的代码。

```
 <nav id="main">
        <ul>
            <li>
                <a>work</a>
            </li>
            <li>
                <a>about me</a>
            </li>
            <li>
                <a>contact</a>
            </li>           
        </ul>
    </nav> 
```

让它闪闪发光的脚本：

```
var nava = "nav#main ul li a";

$(nava).hover(function(){
    $(nava).not(this).removeClass().addClass("inactive");
    $(this).addClass("active");
});

$(nava).click(function(){
    $(this).removeClass().addClass("active");
});

}); 
```

和类/ css（少）：

.inactive{颜色：@color2; 边框底部：0 固体 #000;}

.active{颜色：@color1; 边框底部：1px 实心#000;}

nav#main ul li a{color:@color1;}

基本上，悬停状态优先于点击，这是我不希望发生的。

理想情况下，只要您将鼠标悬停在包含所有锚元素的无序列表中，我希望所有锚元素都恢复到其原始状态。如果有人对此有一些指示，将不胜感激。干杯!

**编辑**：回应 Christian Varga - 我明白你的意思，但我想做的是以下内容。

**默认状态**：不透明度 1

**悬停状态**：不透明度 0.3（在除悬停元素之外的所有内容上，悬停元素仍处于不透明度 1）

**Clicked(Active) State** : Opacity 1（其他链接不覆盖单击元素上的所述不透明度）。

**Mouseout(From Container)**：所有内容的不透明度为 1，除非已单击链接（处于活动状态）。

我希望这使它更清楚一点，对最初的解释表示歉意。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T03:13:46.933

为什么要用 jQuery 绑定悬停？这就是 CSS 的用途:)。尝试这样的事情：

js：

```
var nava = 'nav#main ul li a';

$(nava).click(function() {
    $(nava).removeClass('active')
    $(this).addClass('active');
}); 
```

CSS：

```
nav#main ul li a{color:#00ff00;}
nav#main ul li a:hover{color:#00ff00; border-bottom:1px solid #000;}
nav#main ul li a.active{color:#ff0000; border-bottom:0 solid #000;} 
```

jsFiddle：http: [//jsfiddle.net/Z2KMB/](http://jsfiddle.net/Z2KMB/)

还有一个带有不透明度变化的 jsFiddle：http: [//jsfiddle.net/Z2KMB/1/](http://jsfiddle.net/Z2KMB/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T03:15:18.613

使用 mouseout 和 mouseover 然后指定你想要在你的情况下发生什么设置你想要的项目的类。

例子：

```
$("div.class").mouseout(function(){
      $("#control_name").removeClass("class_name");
    }).mouseover(function(){
      $("#control_name").addClass("other_class_name");
    }); 
```

显然你知道如何根据 id 的类名和类型等来命名。上面只是一个例子。

# iphone - 在基于页面的应用程序 UIPageViewController 中更改动画

> ID：11093853
> 
> 赞同：0
> 
> 时间：2012-06-19T03:04:36.263
> 
> 标签：iphone, animation, view, navigation, uipageviewcontroller

如果您在 xcode 4.3.1 和 iOS5 中创建一个基于页面的应用程序（使用 UIPageViewController），那么默认情况下您会得到一个不错的翻页动画（就像在 iBooks 中一样）。我想用滑动动画替换这个动画，比如天气应用程序或股市应用程序。我怎样才能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T22:43:32.947

您正在寻找的是一个分页属性设置为 YES 的 UIScrollView。[你可以在这里](http://www.iosdevnotes.com/2011/03/uiscrollview-paging/)找到一个很好的例子。

# ios - 监控 ARC 中的引用计数

> ID：11093864
> 
> 赞同：1
> 
> 时间：2012-06-19T03:07:36.170
> 
> 标签：ios, automatic-ref-counting

我对在哪里使用强和在哪里使用弱有点困惑。是否有任何工具可以监控 ios 中的引用计数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T03:13:45.773

当您希望类保留对对象的所有权并因此防止对象被释放，直到类不再需要它时，使用强引用。它通常用于无法廉价复制的对象（例如从服务器下载的数据）或在类运行期间至关重要的东西。

当您需要对对象的引用时使用弱引用。如果对象被其所有者解除分配，则该对象将消失。这通常用于循环引用，而不用担心对象未释放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T03:12:15.093

通常，您不必使用弱，除非避免保留循环。也就是说，只要你没有两个相互强引用的对象，你就可以了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T06:50:25.793

只是添加到其他评论中，虽然*强引用循环*（以前称为*保留循环*）很重要，但它们相对不常见，除非您将指向父对象的指针传递给它们的子对象。如果你正在做这种事情，你应该确保你理解一些 Apple 文档中概述的强引用循环（又名保留循环）的讨论，特别是[Acquire Basic Programming Skills](http://developer.apple.com/library/ios/#referencelibrary/GettingStarted/RoadMapiOS/BasicTasks/AcquireBasicProgrammingSkills/AcquireBasicSkills/AcquireBasicSkills.html)、[Advance Memory Management](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmPractical.html)和[Transitioning to ARC](http://developer.apple.com/library/ios/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html)。实际上，保留循环的常见示例是将指向父控制器的指针传递给子控制器。在这些情况下，一般应该做出这些指针`weak`，否则`strong`通常是相当安全的。

弱引用的另一种常见情况是 IBOutlets 用于 NIB 或 Storyboard 中的控件，通常也应该是`weak`. （如果您通过控制将它们从 Interface Builder 拖动到头文件来制作插座，它会`weak`为您制作它们。）无论如何，我将引用[Resource Programming Guide](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/LoadingResources/CocoaNibs/CocoaNibs.html)中的内容，其中说：

> 出口通常应该是弱的，除了从文件所有者到 nib 文件中的顶级对象（或者，在 iOS 中，故事板场景）应该是强的。因此，您创建的 Outlets 通常默认情况下应该很弱，因为：
> 
> *   您为例如视图控制器的视图或窗口控制器的窗口的子视图创建的 Outlets 是对象之间的任意引用，并不暗示所有权。
>     
>     
> *   强插座经常由框架类指定（例如，UIViewController 的视图插座，或 NSWindowController 的窗口插座）。

# javascript - 防止鼠标与透明元素背景交互

> ID：11093868
> 
> 赞同：2
> 
> 时间：2012-06-19T03:07:55.070
> 
> 标签：javascript, jquery, html

我有一个基本的 html 元素，我有一个包含一些按钮的覆盖元素。

我希望鼠标能够与基本元素以及覆盖层中的按钮进行交互。

问题是覆盖捕获了基本元素的鼠标事件。

有没有一种方法可以禁用覆盖层透明背景的鼠标交互（就像 IE 似乎那样），同时保持覆盖层内按钮的鼠标交互？还是我需要更改代码的结构？

[小提琴](http://jsfiddle.net/XC95u/2/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T03:34:49.147

我修改了 html 结构并使用 z-index 来控制 div 的位置。

HTML：

```
<div class="main">
    <div class="base"></div>
    <div class="overlay">
    </div>
    <div class="button left"></div>
    <div class="button right"></div>
</div> 
```

CSS：</p>

```
.main {
    width: 350px;
    height: 150px;
    position: relative;
}
.base {
    background-color: #c0c0c0;
    width: 100%;
    height: 100%;
}
.overlay {
    position: absolute;
    top: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
}
.button {
    background-color: #707070;
    width: 30px;
    height: 30px;
    position: absolute;
    top: 60px;

    z-index: 99;
}
.right {
    right: 0;
}​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T03:22:38.223

这是一种方法。

带有覆盖元素：http: [//jsfiddle.net/XC95u/11/](http://jsfiddle.net/XC95u/11/)

没有覆盖元素：http: [//jsfiddle.net/XC95u/3/](http://jsfiddle.net/XC95u/3/)

# email - Elisp：以格式/回声获取引号

> ID：11093870
> 
> 赞同：1
> 
> 时间：2012-06-19T03:07:59.133
> 
> 标签：email, emacs, format, elisp, echo

在`.mailrc`中，我想获得第一行，但我获得了第二行

```
alias UIF "UIF Boxning <uifboxning@boxing.se>" # cool (written manually by me)
alias test_alias test_name <test_mail> # no quotation marks (written by below defun) 
```

我不确定问题是否出在`format`or`echo`上。看一看：

```
(defun save-mail-address (address name alias)
  "add an alias to the .mailrc file"
  (interactive "sMail address: \nsFull name: \nsAlias: ")
  (let ((compl-alias (format "alias %s \"%s \<%s\>\"" alias name address)))
    (shell-command (concat "echo " compl-alias " >> .mailrc")) ))
(defalias 'sma 'save-mail-address) 
```

**编辑：**

好的，目标是保持这样：

```
alias long      "Long Long <long@long.long>"                    # 123456
alias s         "S S <s@s.s>"                                   # 1 
```

另外，让我检查不包括重复项：

```
(defun append-blanks (str len)
  (concat str (make-string (- len (length str)) ? )) )

(defun save-mail-address (mail name alias phone)
"add an alias to the .mailrc file"
(interactive "sMail mail: \nsFull name: \nsAlias: \nnPhone: ")
  (let*(
    (alias-alias (format "alias %s" alias))
    (alias-alias-blanks (append-blanks alias-alias 16))
    (mail-str (append-blanks (format "\"%s \<%s\>\"" name mail) 48))
    (line (format "%s%s\# %d\n" alias-alias-blanks mail-str phone))
    (file "~/.mailrc") )
      (with-temp-buffer
        (insert-file file)
        (if
          (search-forward alias-alias (point-max) t) ; t = return nil on fail
            (message (format "Error: The alias %s is already in use." alias))
            (progn
              (insert line)
              (sort-columns nil (point-min) (point-max)) ; nil = not reversed
              (write-file file nil) ))))) ; nil = inhibit confirm 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T05:13:30.260

您需要确保传递给 shell 命令的变量参数总是被适当地转义。

```
(shell-command (concat "echo " (shell-quote-argument compl-alias))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T09:53:50.877

只需通过 Elisp 附加文本将如下所示：

```
(defun save-mail-address (address name alias)
  "add an alias to the .mailrc file"
  (interactive "sMail address: \nsFull name: \nsAlias: ")
  (let ((compl-alias (format "alias %s \"%s \<%s\>\"" alias name address)))
    (with-temp-buffer
      (insert compl-alias "\n")
      (write-region (point-min) (point-max) "~/.mailrc" t)))) 
```

# jquery - 使用 jquery 和文本字段的动态内容“模拟击键”

> ID：11093871
> 
> 赞同：0
> 
> 时间：2012-06-19T03:08:02.567
> 
> 标签：jquery, forms, textbox, keystroke

我有几个文本字段，这些文本字段根据用户从下拉列表中的选择动态填充。一切都很好，除了表单没有“看到”文本字段已输入内容。

文本字段将触发一些条件逻辑。当我手动输入“条件”时，表格可以正常工作。但是，当基于下拉列表填充文本字段时，表单不会看到内容已被输入或更改。

我如何告诉表单内容已输入以及是否更改？这是我用来获取/传递/过滤内容的代码——一切正常，当我提交表单时，输入的值是“看到的”，但在表单仍在处理时它们不是——我有几个有条件地依赖于传递的组值的字段。

我已经得到了一些很大的帮助来让它工作到这一点，只需要最后一点来让这个表单完美运行。

```
jQuery(document).ready(function(){

  jQuery('#input_4_40').bind('change', function()
    {

       //get selected value from drop down;
        var selectedValue = jQuery("#input_4_40").val();

        //populate a text field with the selected drop down value
        jQuery("#input_4_64").val(selectedValue);

   });
});

$(function(){
 var groupFromValue = {

227: {
    name: 'B-1300SS',
    group: '8'
},

228: {
    name: 'B-1500SS',
    group: '3'
},

235: {
        name: 'SG4600-72',
        group: '9'
}

}

$('select').change(function() {
var machineName = groupFromValue[$(this).val()].name;
var machineGroup = groupFromValue[$(this).val()].group;

//populate a text field with the selected drop down value
     jQuery("#input_4_63").val(machineName);

//populate a text field with the selected drop down value
    jQuery("#input_4_62").val(machineGroup);

 });
 }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T03:29:07.430

您可以在动态填充字段后手动触发更改事件，例如：

```
jQuery("#input_4_64").val(selectedValue).change(); 
```

# c# - ASP.NET MVC3 Web 应用程序在 IIS 上发布后表现不同

> ID：11093872
> 
> 赞同：1
> 
> 时间：2012-06-19T03:08:32.873
> 
> 标签：c#, asp.net-mvc-3, iis-7.5

我编写了一个 ASP.NET MVC3 Web 应用程序，它在 Visual Studio 开发 Web 服务器中完美运行，并在特定的 IIS Web 服务器上运行。

我已在另一个 IIS Web 服务器上成功发布了相同的 Web 应用程序。除了奇怪的行为外，它运行良好。

我的控制器操作毫无问题地返回内容，但未呈现布局页面。我最终只有控制器操作返回的内容。

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T05:59:11.653

I bet you have hardcoded the urls to scripts and CSS in your view instead of using Url helpers. You wrote:

```
<link href="/Content/Site.css")" rel="stylesheet" type="text/css" /> 
```

instead of the correct way:

```
<link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" type="text/css" /> 
```

or you wrote:

```
<script src="/Scripts/jquery-1.5.1.min.js"" type="text/javascript"></script> 
```

instead of the correct way:

```
<script src="@Url.Content("~/Scripts/jquery-1.5.1.min.js")" type="text/javascript"></script> 
```

Now go ahead and search for all places where you have hardcoded urls like this and replace them with urls generated by helpers.

The reason why your site doesn't work when deployed in IIS is because in IIS there's a probably a virtual directory that you have to take into account. So the correct address is `http://example.com/myappname/content/site.css` whereas when running locally there's no such directory `http://localhost:1234/content/site.css`.

# c# - 我得到 `System.Web.UI.WebControls.TextBox` 而不是 TextBox 值

> ID：11093880
> 
> 赞同：0
> 
> 时间：2012-06-19T03:09:53.473
> 
> 标签：c#, asp.net, visual-studio-2008

再见。你能帮我弄清楚为什么我得到这个：`System.Web.UI.WebControls.TextBox` 在Label1上：

```
DataListItem item = DataList1.Items[0];
TextBox nume = (TextBox)item.FindControl("numeTb");
Label1.Text = nume.ToString(); 
```

我指定 numeTb 元素像这样放在 ASPX 文件中：

```
<asp:TextBox ID="numeTb" runat="server" Width="400px" 
Text='<%# Eval("nume") %>' DataTextField="nume" DataValueField="nume"></asp:TextBox> 
```

我刚刚添加了 DataTextField 位，认为可能会有所帮助，但没有。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-19T03:11:48.353

您需要使用该`Text`属性

更改此行

```
 Label1.Text = nume.ToString(); 
```

至

```
 Label1.Text = nume.Text; 
```

# asp.net-mvc-3 - 如何使用 SelectList 显示多个项目（它是一个下拉列表），我正在使用 mvc3

> ID：11093884
> 
> 赞同：0
> 
> 时间：2012-06-19T03:11:11.823
> 
> 标签：asp.net-mvc-3, drop-down-menu, selectlist

这是我的代码：

```
ViewBag.idprofesor = new SelectList(db.Profesor, "IDProfesor", "nombre"); 
```

此代码生成一个下拉列表，仅显示数据库中教师（教授）的姓名（名词），id 像下拉列表一样显示教师的姓名和姓氏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T03:14:54.373

您可能必须手动创建一个 SelectListItems 列表，以手动指定所需的字段。像这样：

```
List<SelectListItem> professors = new List<SelectListItem>();
foreach(var professor in db.Professors) {
    professors.Add( new SelectListItem() { Text = professor.Fn + " " +  professor.Ln, Value = professor.Id } );
}
ViewVag.Professors = professors; 
```

那么在你看来：

```
Html.DropDownListFor( m => m.Professor, ViewBag.Professors ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T03:14:00.303

您只需将*SelectListItem*的 IEnumerable 传递给构造函数。使用 Linq 从*Professor*集合中进行选择：

```
@{
    var mySelectList =
        db.Professor.Select(prof => new SelectListItem(
            Text = prof.lastName + ", " + prof.nombre,
            Value = prof.IDProfessor
            )
        ).AsEnumerable();
} 
```

使用 Razor，您应该能够像这样创建下拉列表：

```
@Html.DropDownList("mydropdownlist", mySelectList) 
```

要将其绑定到模型中的属性，语法略有不同：

```
@Html.DropDownListFor(model => model.someproperty, mySelectList) 
```

# dns - 去掉 URL 中的斜线（例如 something.com/dogs）

> ID：11093893
> 
> 赞同：-5
> 
> 时间：2012-06-19T03:12:17.813
> 
> 标签：dns, slash

我最近购买了域名simply.do。我想将它用作 URL 缩短服务，但我不喜欢只做简单的.do/something。我可以删除斜线或用差异符号替换它吗？

如果这有帮助，我正在使用运行 Nginx 的服务器，我不会切换到 Apache。

谢谢！

对于域名的任何反馈，我也将不胜感激。我希望将simply.do/insurance、simply.do/religion 等出售给不同的公司。你认为我可以在拍卖网站上出售这些零件吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T11:10:49.750

当您访问`simply.do`时，指的是`simply.do/index.php`（如果您在后台使用php）。

因此，您可以将其用作查询，例如，simply.do?insurance 将导致一些长 url，例如`://a-long-domain-name/a-long-list-of-directories`.

使用服务器脚本获取`?`标记后的值，这样如果有人访问`simply.do?insurance`，它就会像`simply.do/index.php?insurance`。它适用于所有浏览器。

您可以从`$_SERVER['REQUEST_URI']`OR`$_GET[]`数组中获取值，检查查询字符串：'insurance' 是否在您的数据库中。如果是，则将用户重定向到所需的站点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T03:16:58.630

您需要知道 HTTP 协议在这里是如何工作的，以便更好地了解您在做什么。如果您想出售这些 URL，您需要一个用于 /insurance 或 /religion 的基本 URI 处理程序。您还可以通过 DNS 和默认的 VirtualHost 处理程序出售 insurance.simply.do，如果您愿意的话。

此答案与使用的服务器无关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T03:16:59.463

您不能删除/替换`/`右后，`simply.do`因为它在 URI 中分隔主机和路径。

# python - Django 开发服务器提供 css 但不提供 js

> ID：11093896
> 
> 赞同：2
> 
> 时间：2012-06-19T03:13:10.847
> 
> 标签：python, django

我正在我的本地机器上开发一个 django (1.4) 应用程序。我正在使用`python manage.py runserver`. 在 base.html 我有：

```
<link href="{{ STATIC_URL }}bootstrap.css" rel="stylesheet" type="text/css" />
<script src="{{ STATIC_URL }}boostrap-dropdown.js" type="text/javascript"></script> 
```

boostrap.css 在我加载页面时加载得很好，但是 bootstrap-dropdown.js 是 404 的。它们在我的静态目录中彼此相邻。settings.py 的相关部分：

```
STATIC_URL = '/static/'
STATICFILES_DIRS = (
'/home/username/projects/projectname/static',) 
```

调试设置为`True`。无论有没有这个`staticfiles_urlpatterns`技巧，我都试过了。

Django可以在目录中找到一个文件但不能找到另一个？我想我快疯了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-19T03:15:32.167

```
"{{ STATIC_URL }}boostrap-dropdown.js" 
```

`boostrap`可能不是你想要的。
`bootstrap`大概就是你的意思。

# internet-explorer - jQuery ajax 在 IE 中失败

> ID：11093904
> 
> 赞同：0
> 
> 时间：2012-06-19T03:14:36.190
> 
> 标签：internet-explorer, jquery

我有这个超级奇怪的错误，这个方法在 IE9 中失败。最奇怪的是，如果 IE [开发者工具] 是**打开**的，该方法**不会失败**。我不知道打开窗口如何改变脚本的执行。

当我在 IE [开发人员工具] 打开的情况下执行此脚本时，该函数按预期执行。当IE【开发者工具】关闭时，执行：

```
 alert("00000000000000000000000000000000000");
   alert("4444444444444444444"); 
```

就是这样，没有其他警报被触发。

我试过删除 `timeout: 20000`and `cache: false`，但没有帮助。

```
 function postAssets(datapm) {
        alert("00000000000000000000000000000000000");

        $.ajax({
            type: "POST",
            url: "Igud.aspx/PostD",
            cache: false,
            contentType: "application/json; charset=utf-8",
            data: '{"postedData":"' + datapm + '"}',
            dataType: "json",
            timeout: 20000,
            tryCount: 0,
            retryLimit: 10,
            success: function (msg) {
                alert("4444444444444444444");
                console.log('success postAssets ' + msg.d);
            },
            complete: function (jqXHR, status) {
                alert("44444444444aaaaaaaaaaaaaaaaaaaaaaaaaaaa44444444");
                if (status == 'success' || status == 'notmodified') {
                    alert("aaaaaa");
                    console.log('complete postAssets' + jqXHR.responseText);

                    var obj = jQuery.parseJSON(jqXHR.responseText);

                    alert("bbbb");
                    //  alert(parseInt(obj.d));
                    //   alert(parseInt(obj.d) == 1);
                    if (parseInt(obj.d) == 1) {
                        $("#thxbox").html("TEST");
                        alert("ccc");

                        if ($("#Q3_3").attr('checked') == 'checked') {
                            $("#thxboxMd").dialog("option", { height: 470 }); alert("dddd");
                            $("#thxboxReg").show(); alert("eeee");
                            $("#thxbox").effect("pulsate", { times: 3 }, 1200); alert("ffff");
                        }
                        else {
                            $("#thxboxReg").hide();
                            $("#thxboxMd").dialog("option", { height: 180 });
                        }

                        $("#thxboxMd").dialog("open");
                        $("body").off("click", "#sbbtn");

                        $('body').on('click', '#sbbtn', function () {
                            $("#thxbox").html("TEST");

                            if ($("#Q3_3").attr('checked') == 'checked') {
                                $("#thxboxMd").dialog("option", { height: 470 });
                                $("#thxboxReg").show();
                                $("#thxbox").effect("pulsate", { times: 3 }, 1200);
                            }
                            else {
                                $("#thxboxReg").hide();
                                $("#thxboxMd").dialog("option", { height: 180 });
                            }

                            $("#thxboxMd").dialog("open");
                        });

                    }
                    else {
                        $("#thxbox").html("TEST");
                        $("#thxboxMd").dialog("open");
                        $("#thxbox").effect("pulsate", { times: 3 }, 900);
                    }
                }
            },
            error: function (req, status, error) {
                alert("444444444444411111111111111111112222222222222222444444");
                this.tryCount++;
                if (this.tryCount <= this.retryLimit) {
                    var offSet = this.tryCount * 1000;
                    getAssetsRecovery = this;
                    var retry = function () { $.ajax(getAssetsRecovery); };
                    setTimeout(retry, offSet);
                    console.log(arguments);
                    console.log('error postAssets' + error);

                    $("#thxbox").html("TEST");
                    $("#thxboxMd").dialog("open");
                    $("#thxbox").effect("pulsate", { times: 3 }, 900);

                    return;
                }
                console.log('error postAssets');
            }
        }); 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T03:23:05.013

这回答了你的问题了吗？调试器未打开时，控制台对象似乎不可用。

[IE9是否支持console.log，它是一个真正的功能吗？](https://stackoverflow.com/questions/5472938/does-ie9-support-console-log-and-is-it-a-real-function)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T03:28:48.303

您的第一个警报是

```
alert("00000000000000000000000000000000000"); 
```

当功能成功时，它会发出警报 `alert("4444444444444444444");`

并且它不会输入错误并完成功能警报只会发生在那些相应的事件上（如果它的错误或其他东西..）

尝试将其更改`url: "Igud.aspx/PostD",`为其他内容..您将在错误部分收到警报'

# jqplot - 如何让一个 jqplot 不遮盖前一个

> ID：11093906
> 
> 赞同：1
> 
> 时间：2012-06-19T03:14:52.527
> 
> 标签：jqplot

我的需要是绘制几条线的基本 x 轴、y 轴图，随着用户输入数据，这些线会按顺序排列。jqPlot 似乎有能力（与 flot 不同，至少据我所知）添加到现有的情节中。到目前为止，我的实验是：

```
$.jqplot('dpCum',[ld.fCumPairFwd[0]],{axes:{xaxis:{min:0,max:2500},yaxis:{min:0,max:200000}}});
$.jqplot('dpCum',[ld.fCumPairAft[0]],{axes:{xaxis:{min:0,max:2500},yaxis:{min:0,max:200000}}}); 
```

它产生了我想要的两条线，除了第二条的背景遮住了第一条线。在实践中，直到用户对第一行做出响应时才会知道第二行的数据，然后他们会想同时查看两者。

我已经在 jqplot 文档中进行了几次传递（它的功能显然令人印象深刻），但是如何在添加新行时保持现有行可见让我无法理解。我在想可能存在某种 z 轴不透明度，但还无法理解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T10:15:29.707

我相信，您的问题的答案是使用该`replot()`方法并使用修改后的数据集绘制一个新图。

[以下示例中介绍了这种方法。](http://jsfiddle.net/Boro/Q8z5B/)请注意，我只制作了索引为 0 的系列以响应点击。单击该系列的数据点时，会绘制另一个数据点。

* * *

**编辑：**我去的原因`replot()`是我不知道如何只画一个系列。我[在这里尝试了@Mark 提出的方法，但](https://stackoverflow.com/a/10837537/613495)没有成功。不过他可能知道得更好。我对`jqPlot`自己比较新鲜。还考虑到当我们添加一个新系列时，一些点可能会超出当前比例，因此，由于[`redraw()`jqPlot 作者在此处提到的不会重新缩放](https://groups.google.com/forum/?fromgroups#!topic/jqplot-users/3tGWOwqBwM0)- 尽管在我的情况下它会工作，因为我们重新初始化了图形。因此，我认为如果您也无法应用单系列绘制，您可以尝试使用该`redraw()`方法，从文档中获取我认为调用的成本较低。

也许实际上在这种情况下您不会使用`replot()`or `redraw()`，就像在示例中我每次都制作一个新图一样。因此，在我看来，`destroy()`在绘制新图之前调用上一张图更合适。*这是当前代码示例中的内容。*

# javascript - 省略长文本截断

> ID：11093908
> 
> 赞同：4
> 
> 时间：2012-06-19T03:14:59.857
> 
> 标签：javascript, html, css

我正在使用省略号概念来截断 HTML 中的长文本。我已经成功地截断了句子，但“...”不会出现在我的 HTML 中。我将以下内容用于css

输出似乎很好..即，对于测试测试测试测试测试测试测试测试，当我真正想要它作为测试测试测试时，输出是测试测试测试......

```
<div style="text-align:left; line-height: 20px; white-space: nowrap;
            overflow: hidden; text-overflow: ellipsis; width: 99%;
            display : block;"> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-19T03:58:42.723

我不确定你在问什么，或者你看到了什么，但是如果容器中没有足够的空间，文本只会被截断。例如：

```
<style type="text/css">
div {
    white-space: nowrap; 
    overflow: hidden; 
    text-overflow: ellipsis; 
    width: 100px;
}
</style>
<div> 
    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
</div> 
```

[http://jsfiddle.net/jS7ea/](http://jsfiddle.net/jS7ea/)

在这里，我将 div 的宽度限制为 100px，它只显示以下内容：

```
Lorem ipsu... 
```

在您的示例中，您的宽度为 99%，因此只有小于实际内容宽度时才会看到截断（尝试调整浏览器窗口的大小以进行检查）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-06T10:35:57.410

# git - git log --pretty 带有文件列表？

> ID：11093911
> 
> 赞同：1
> 
> 时间：2012-06-19T03:15:12.997
> 
> 标签：git

我正在尝试使用 'git log --pretty=tformat' 创建 xml 文件日志。但是，我在获取每个提交的文件列表时遇到问题。

例如：我使用这个命令

```
$echo '<?xml version="1.0"?>' > out.xml
$echo '<git>' >> out.xml
$git log   --pretty=tformat:'    <commit>%n        <h1>%s</h1>%n    </commit>'  --name-only  >> out.xml
$echo '</git>'>> out.xml 
```

输出：

```
 <?xml version="1.0"?>
<git>
    <commit>
        <h1>Commit 1</h1>
    </commit>
    <commit>
        <h1>Commit 2</h1>
    </commit>
    <commit>
        <h1>Commit 3</h1>
    </commit>
</git> 
```

我想在带有文件列表的提交标签中添加标签，所以我的最终输出看起来像这样

```
 <?xml version="1.0"?>
    <git>
        <commit>
            <h1>Commit 1</h1>
            <list>file1</list>
        </commit>
        <commit>
            <h1>Commit 2</h1>
            <list>file2</list>
        </commit>
        <commit>
            <h1>Commit 3</h1>
            <list>file3</list>
        </commit>
    </git> 
```

我确实尝试过 --name-only 它会列出文件但无法格式化输出。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T03:57:42.037

这可能不是您想要的，但它很容易编写脚本。以下是一种实现，效率低下但功能强大。小心运行它：它将在您的整个历史记录上运行。更改第二行以`revlist=$(git rev-list -10 HEAD)`查看它仅适用于最后 10 次提交。根据上面的示例，它还假设您希望文件底部有较旧的提交。如果您希望按时间顺序添加一个`--reverse`标志：`git rev-list`

```
#!/bin/sh
revlist=$(git rev-list HEAD)
(
    echo '<?xml version="1.0"?>'
    echo '<git>'
    for rev in $revlist
    do
            files=$(git log -1 --pretty="format:" --name-only $rev)
            echo '    <commit>\n        <h1>\c'
            echo "$(git log -1 --pretty="%s" $rev)\c"
            echo '</h1>'
            for file in $files
            do
                    echo "        <list>$file</list>"
            done
            echo '    </commit>'
    done
    echo '</git>'
) > out.xml 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-26T09:17:20.537

我设法将所有文件信息作为单个文本字段获取，然后使用以下 powershell 脚本对文件进行一些小操作（将前两行移动到文件末尾）：（将 REPONAME 替换为存储库的名称，可以进一步自动化。）

```
git --git-dir <path to repository> log --name-only --pretty=format:"]]></files>%n</commit>%n<commit>%n<repo>REPONAME</repo>%n<hash>%H</hash>%n<author>%an</author>%n<dt>%ct</dt>%n<subject><![CDATA[%s]]></subject>%n<files><![CDATA[" | Out-File REPONAME.xml
$x = get-content REPONAME.xml
@("<gitrepo>") + $x[2..$x.count] + $x[0..1] + @("</gitrepo>") | set-content REPONAME.xml 
```

要拆分文件，我必须在数据库中进行一些进一步的处理（拆分换行符等），但这超出了此答案的范围。

这会输出一个文件，如下所示：

```
<gitrepo>
<commit>
<repo>REPONAME</repo>
<hash>388d77493cb2b4d3260cd12b1adcf23e947755f4</hash>
<author>Some Guy</author>
<dt>1401802177</dt>
<subject><![CDATA[Comments added to files]]></subject>
<files><![CDATA[
src/aben/blanksid.w
src/aben/c_typop.w
src/aben/freg.w
src/aben/freskid.w
src/aben/grit5.w
src/aben/grokli.w

]]></files>
</commit>
</gitrepo> 
```

# ios - 如何使用 ALAssetLibrary 获取相机胶卷中的本地照片

> ID：11093913
> 
> 赞同：2
> 
> 时间：2012-06-19T03:15:16.323
> 
> 标签：ios, camera, photo, grand-central-dispatch, alassetslibrary

```
ALAssetsLibrary* library = [[ALAssetsLibrary alloc] init];
    [library enumerateGroupsWithTypes:ALAssetsGroupSavedPhotos
                           usingBlock:libraryGroupsEnumeration 
                         failureBlock:failureblock];
ALAssetsGroupEnumerationResultsBlock groupEnumerAtion = ^(ALAsset *result, NSUInteger index, BOOL *stop){
        if (result!=NULL) {

            if ([[result valueForProperty:ALAssetPropertyType] isEqualToString:ALAssetTypePhoto]) {

                [self._dataArray addObject:result];
            }

        }
    };

ALAssetsLibraryGroupsEnumerationResultsBlock
    libraryGroupsEnumeration = ^(ALAssetsGroup* group, BOOL* stop){
        //within the group enumeration block.filter to enumerate just photos.
        [group setAssetsFilter:[ALAssetsFilter allPhotos]];
        if (group!=nil) {
            NSString *g=[NSString stringWithFormat:@"%@",group];
            NSLog(@"gg:%@",g);//gg:ALAssetsGroup - Name:Camera Roll, Type:Saved Photos, Assets count:71
            [group enumerateAssetsUsingBlock:groupEnumerAtion];
        }
        else {
            dispatch_async(dispatch_get_global_queue(0, 0), ^{
                [self saveToDB:self._dataArray];

            });
        }

    }; 
```

假设我的相机胶卷有 100 张照片，我想将前 30 张照片保存到我的数据库中。但是在上面的代码中，我必须等待 100 条结果钓鱼。30 条写入数据库后，继续获取另外 30 条直到结束。因为获取 100 甚至更多的照片会延迟我的 UI 刷新。看起来不舒服。非常感谢！

我应该写什么。？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T09:19:40.553

您应该尝试在后台线程上保存到数据库，并让 CoreData（假设您使用 CoreData）通过处理 NSManagedObjectContextDidSaveNotification 在主线程上更新 NSManagedObjectContext。

您仍然可以在 30 张照片后保存，这可能会减轻一些 I/O 压力，但您必须测试性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T01:59:01.947

试试这个

```
if (result!=NULL) {

    if ([[result valueForProperty:ALAssetPropertyType] isEqualToString:ALAssetTypePhoto])         {

          [self._dataArray addObject:result];

            if([self._dataArray count] == 30){

               dispatch_async(dispatch_get_global_queue(0, 0), ^{

                 NSArray *array = [[NSArray alloc] initWithArray:self._dataArray]; //please change the array declaration to top of this method. Because the Block will not allow to do it here.               
                 [self._dataArray removeAllObjects];
                 [self saveToDB:array];
                 //array release,if not using ARC

           });
       }
    }

} 
```

和

```
if (group!=nil) {

            [group enumerateAssetsUsingBlock:groupEnumerAtion];
        }
        else if([self._dataArray count] > 0) {

              dispatch_async(dispatch_get_global_queue(0, 0), ^{

                    [self saveToDB:self._dataArray];

            });
        } 
```

# html - Favicon.ico 不工作...我的代码有问题吗？

> ID：11093921
> 
> 赞同：2
> 
> 时间：2012-06-19T03:15:50.063
> 
> 标签：html, favicon

嘿，我有这行代码用于我的 favicon.ico 文件

```
<link rel="Shortcut Icon" href="http://www.myurl.com/wp-content/themes/twentyeleven/favicon.ico" /> 
```

该文件位于正确的位置，我清除了缓存并重新启动了浏览器，但它无法正常工作，它也位于我的标题标签中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-17T20:41:30.243

试试这个

```
<link rel="shortcut icon" type="image/x-icon" href="/yourAssetFilePath/favicon.ico" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T10:12:57.770

尝试以下操作：

```
<link rel="icon" href="icon.ico" type="image/x-icon" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T10:16:01.843

是的，我只有

```
<link rel="SHORTCUT ICON" href="/favicon.ico" /> 
```

对我有用，但它确实做了一些有趣的缓存事情，而且我认为在 IE 中您需要在页面出现之前为其添加书签？

# haskell - Haskell：使用 deepseq 进行更严格的折叠

> ID：11093922
> 
> 赞同：7
> 
> 时间：2012-06-19T03:15:52.863
> 
> 标签：haskell, lazy-evaluation, fold, seq

页面[Foldr Foldl Foldl'](http://www.haskell.org/haskellwiki/Foldr_Foldl_Foldl%27)讨论`foldl'`，并将其定义为：

```
foldl' f z []     = z
foldl' f z (x:xs) = let z' = z `f` x 
                    in seq z' $ foldl' f z' xs 
```

这样做是为了避免空间泄漏，即`fold'`产生恒定大小的结果仅使用恒定空间。

然而，这并不一定有效，正如这里所指出的：

> 所涉及的`seq`函数只评估最顶层的构造函数。如果累加器是一个更复杂的对象，那么`fold'`仍然会建立未评估的 thunk。

显而易见的解决方案是更改`seq`为[`deepseq`](http://hackage.haskell.org/packages/archive/deepseq/1.3.0.0/doc/html/Control-DeepSeq.html#v:deepseq)如图所示（假设您正在使用[`NFData`](http://hackage.haskell.org/packages/archive/deepseq/1.3.0.0/doc/html/Control-DeepSeq.html#t:NFData)）：

```
foldl_strict f z []     = z
foldl_strict f z (x:xs) = let z' = z `f` x 
                          in deepseq z' $ foldl_strict f z' xs 
```

`deepseq`但我有一种感觉，这可能非常低效，因为每次通过循环都需要遍历整个结构（除非编译器可以静态证明这不是必需的）。

然后我尝试了这个：

```
foldl_stricter  f z l      = deepseq z $ foldl_stricter' f z l
foldl_stricter' f z []     = z
foldl_stricter' f z (x:xs) = let z' = deepseq x $ z `f` x 
                             in seq z' $ foldl_stricter' f z' xs 
```

但是发现它有这个问题。当它应该返回 3 时，下面会失败。

```
foldl_stricter (\x y -> x + head y) 0 [[1..],[2..]] 
```

所以`fold_stricter`太严格了。该列表不必严格，防止空间泄漏的重要一点是累加器是严格的。`fold_stricter`走得太远并且也使列表变得严格，这导致上述失败。

这让我们回到`fold_strict`. `deepseq`在一个大小的数据结构上重复运行`n`需要`O(n)`时间，还是`O(n)`第一次和`O(1)`之后只需要时间？（正如[dbaupp](https://stackoverflow.com/users/1256624/dbaupp)在下面的[评论](https://stackoverflow.com/questions/11093922/haskell-a-stricter-fold-with-deepseq#comment14527591_11093922)中建议的那样）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T05:24:04.913

实际上，您的两个实现`foldl`有很大不同。无法保证`f z x`需要完全遍历`x`来计算其答案，因此`deepseq x (f z x)`可能会做不必要的工作；此外，即使`x`完全评估，也不能保证`f z x`没有嵌套的 thunk，因此`let z' = deepseq x (f z x) in seq z' (foo z')`可能做的工作不够。

您所说的问题的正确解决方案是使用`foldl'`和严格的数据类型作为累加器类型；这样，`seq`将只需要检查构造函数就知道整个结构被完全评估了，反之强制构造函数将强制整个结构被完全评估。

# javascript - javascript onclick在chrome中不起作用

> ID：11093928
> 
> 赞同：2
> 
> 时间：2012-06-19T03:16:44.270
> 
> 标签：javascript

我需要有人引导/指导我在哪里编码错误，因为我无法弄清楚我的代码哪里出错了。此代码在我的 IE 和 FF 中运行良好，但在 Chrome 或 Safari 中运行良好。右边，当我单击下拉列表选择时，它将显示所选位置的确切地图。但是在我的 Chrome 和 Safari 中，它只显示了初始地图，而不是显示从列表中选择的位置。

```
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Google Maps JavaScript API Example</title>

  <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyAn5fGcWgolNQy8U9PV2YsP1P3Knn23Jro&sensor=false"></script>
  <script type="text/javascript">
    // Variables Initialize
    var marker;
    var map;
    var image = "flag.png";
    function initialize(lat,lng) {
      var singapore = new google.maps.LatLng(lat,lng);
      var settings = {
        zoom: 11,
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        center: singapore,  
        mapTypeControl: true,
        mapTypeControlOptions: {
            style: google.maps.MapTypeControlStyle.HORIZONTAL_BAR,
            position: google.maps.ControlPosition.TOP_RIGHT},
        navigationControl: true,
        navigationControlOptions: {
            style: google.maps.NavigationControlStyle.SMALL},
        panControl: true,    
        panControlOptions: {
            position: google.maps.ControlPosition.RIGHT_TOP},
        zoomControl: true,
        zoomControlOptions: {
            style: google.maps.ZoomControlStyle.DEFAULT,
            position: google.maps.ControlPosition.LEFT_TOP},
        scaleControl: true,    
        scaleControlOptions: {
            position: google.maps.ControlPosition.BOTTOM_RIGHT}
      };
      map = new google.maps.Map(document.getElementById("map_canvas"), settings);
      marker = new google.maps.Marker({
          map: map,
          draggable:false,
          animation: google.maps.Animation.DROP,
          position: singapore,
          title:"Singapore",
          icon: image
      });
    }
  </script>
  </head>
  <body onload="initialize('1.28563','103.80918')" onunload="GUnload()">
    <select>
        <option onclick="initialize('1.28563','103.80918')">--Select Location--</option>
        <option onclick="initialize('1.28527','103.82682')">Blk 18A Jalan Membina</option>
        <option onclick="initialize('1.28277','103.82562')">Blk 26 Jalan Membina</option>        
        <option onclick="initialize('1.31546','103.766363')">Blk 321-326 Clementi Ave 5</option>
    </select>
    <div id="map_canvas" style="width: 500px; height: 300px"></div>
  </body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T03:26:17.477

添加`onclick`到 an`<option>`似乎不是一个好主意。我会改为使用`onchange`on`<select>`并使用`value`属性来存储 lat/lng：

```
<select onchange="movemap(this)">
    <option value="1.28563,103.80918">Blk 18a Jln Membina</option>
    ...

function movemap(sel)
{
    var opt = sel.options[sel.selectedIndex],
    vals = opt.value.split(',');

    initialize(vals[0], vals[1]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T03:26:07.900

`center: ramkySG`在你的代码中删除怎么样？

# ruby-on-rails - 开放层标记

> ID：11093929
> 
> 赞同：2
> 
> 时间：2012-06-19T03:16:53.027
> 
> 标签：ruby-on-rails, ruby-on-rails-3, openlayers

有没有办法单击 OpenLayers.Marker() 创建的标记，以便能够重定向到另一个链接。

我试过了

```
var marker = new OpenLayers.Marker(position, icon.clone());

marker.events.register("click", map, function(e) {
   location.href = "http:www.google.com"
}); 
```

通过这样做，当我点击标记并将我重定向到 www.google.com 时，我可以有一个点击事件。但我有兴趣知道的是，当我首先创建标记时，我能否将 url 直接设置为标记？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T03:44:11.127

您应该能够像这样将任何属性添加到您的标记中：

```
marker.URL = "http://www.google.com/"; 
```

然后您的事件处理程序可以像这样编写一次：

```
function linkHandler(e) {
    location.href = this.URL;
}

marker.events.register("click", marker, linkHandler); 
```

请注意，marker.events.register 调用中的“map”参数已更改为“marker”。

# ios - 对 iOS 块的困惑

> ID：11093933
> 
> 赞同：0
> 
> 时间：2012-06-19T03:17:21.107
> 
> 标签：ios, objective-c-blocks

我不确定如何处理块。例如，在我的 viewDidLoad 中，我调用了一个函数“useDocument”来设置 Core Data。我希望一旦 Core Data 准备好使用，就会调用另一个函数来处理一些查询。就像 [ASIHTTPRequest](http://allseeing-i.com/ASIHTTPRequest/)一样，当客户端收到响应时，会调用一个函数来处理响应。

我猜触发函数不是使用块的正确方法。但正确的方法是什么？

```
- (void)useDocument
{
    if (!self.database) {
        self.database = [DataModelDocument sharedDocument];
    }

    if (![[NSFileManager defaultManager] fileExistsAtPath:[self.database.fileURL path]]) {
        // does not exist on disk, so create it
        [self.database saveToURL:self.database.fileURL forSaveOperation:UIDocumentSaveForCreating completionHandler:^(BOOL success) {
                if (!success) {
                    NSLog(@"database doesn't exist on disk, we fail to create it");
                }
        }];
    } else if (self.database.documentState == UIDocumentStateClosed) {
        // exists on disk, but we need to open it
        [self.database openWithCompletionHandler:^(BOOL success) {
            if (!success) {
                NSLog(@"database exists on disk, but we fail to open it");
            }
        }];
    } else if (self.database.documentState == UIDocumentStateNormal) {
        // already open and ready to use
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T08:55:07.133

没有使用块的正确方法，因为没有使用函数的正确方法。

块是函数。不仅仅是一个功能，但没有太大的不同。所以让我们暂时忘记这些差异。职能。

使用一个函数，你会写出类似的东西

```
void callback (BOOL success) {
    if (success) {
        // do something useful
    }
}

[database openWithCallback: &callback]; 
```

这里有某种小字节序。是的。

块允许您在线编写回调。

```
[self.database openWithCompletionHandler: ^(BOOL success) {
    if (!success) {
        // oops, handle that
    }
}]; 
```

在那种特殊情况下，块不能解决任何功能无法解决的问题。它们的成本更高。

当你大量使用它们时，好处就会显现出来。如果您将操作编写为完全异步的，则可以以简化的方式编写代码。

伪代码：

```
dispatch block: ^(){
    some heavy computation here
    dispatch block: ^(){
        computation done, update the UI or something
    }
} 
```

非常简单的例子。当然，用函数编写它是完全可能的。但不那么可读。

现在假设您正在调度大量的块，您可以创建块组，然后在组完全执行时执行一个块。非常容易写，非常容易阅读。这开始成为处理无处不在的函数指针的噩梦。

现在，是什么让块不仅仅是一个函数？

块是一个函数。有上下文。块可以访问同一范围内的变量。在上面的简单示例中，工作块可以访问调用范围，而完成块可以访问调用范围和工作块范围。当然，这可以通过功能和结构来完成。有很多代码，更难阅读。块更优雅地解决了这个问题。

我建议您阅读有关 Grand Central Dispatch 的内容。这显然是块显示其真正潜力和表现力的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T03:41:25.220

您可以将块视为一种“有状态线程”。我强调“有点”。它是将代码和变量封装在一个漂亮整洁的小“代码块”中。

您可以使用 __block 将变量从块外部带入范围，并在周围代码的其余部分完成时运行该块。

在这种情况下，您使用的是完成块。如果您愿意，您可以在其中调用方法，只要调用它们的适当时间是在它周围的所有代码完成之后。

# android - 为什么布局的背景会影响布局内 EditText 的背景？

> ID：11093934
> 
> 赞同：0
> 
> 时间：2012-06-19T03:17:32.330
> 
> 标签：android, background, android-linearlayout

我将 EditText 添加到 Linearlayout 中，对于每个，我将图片设置为背景。但是Linearlayout的背景会影响EditText的背景，代码如下：

```
<LinearLayout 
    android:layout_width="wrap_content" 
    android:layout_height="wrap_content" 
    android:layout_alignParentLeft="true" 
    android:layout_centerVertical="true" 
    android:layout_marginLeft="10dp" 
    android:background="@drawable/layout_bg" 
    > 

    <EditText     
        android:layout_width="wrap_content" 
        android:layout_height="wrap_content" 
        android:background="@drawable/input" 
        android:inputType="text" 
        android:paddingLeft="4dp" 
        android:layout_margin="4dp" 
        /> 
    </LinearLayout> 
```

layout_bg 会影响输入，但是当我设置 LinearLayout #F9F9F9 的背景时，Linearlayout 的背景不会影响 EditText 的背景。为什么会这样？

我是新来的，现在不能上传图片。结果如上，外层背景颜色是蓝色，而EditText的背景颜色是白色，我想让内层背景有意义，应该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T16:38:26.883

问题解决了，我看不到内部背景，因为它是透明的！

# objective-c - 对受 OAuth 保护的 URL 进行 GET 调用，第 2 部分

> ID：11093936
> 
> 赞同：4
> 
> 时间：2012-06-19T03:17:57.453
> 
> 标签：objective-c, ios, oauth

我一直在尝试让基本的 OAuth 交互工作但没有成功。当然，在 SO 上已经提出了类似的问题，但大多数都没有答复。我在这里变得非常绝望，所以我将首先发布我的整个代码：

```
// OAuth parameters
NSString *oauthNonce = [self genRandStringLength:20];
NSString *oauthSignatureMethod = [NSString stringWithFormat:@"HMAC-SHA1"];
time_t oauthTimeStamp = (time_t) [[NSDate date] timeIntervalSince1970];

// generate OAuth signature
NSString *encodedUrlString = [self urlEncode:urlString];

NSString *oauthParameters = [NSString stringWithFormat:@"oauth_consumer_key=%@",oauthConsumerKey];
oauthParameters = [oauthParameters stringByAppendingFormat:@"&oauth_nonce=%@",oauthNonce];
oauthParameters = [oauthParameters stringByAppendingFormat:@"&oauth_signature_method=%@",oauthSignatureMethod];
oauthParameters = [oauthParameters stringByAppendingFormat:@"&oauth_timestamp=%d",oauthTimeStamp];
oauthParameters = [oauthParameters stringByAppendingFormat:@"&oauth_token=%@",oauthAccessToken];
oauthParameters = [oauthParameters stringByAppendingFormat:@"&oauth_version=1.0"];
NSString *oauthEncodedParameters = [self urlEncode:oauthParameters];

NSString *oauthBaseString = [NSString stringWithFormat:@"GET&%@&%@",encodedUrlString,oauthEncodedParameters];

NSString *oauthKey = [NSString stringWithFormat:@"%@&%@", oauthConsumerSecret, oauthAccessTokenSecret];
NSString *oauthEncodedKey = [self urlEncode:oauthKey];

OAHMAC_SHA1SignatureProvider *provider = [[OAHMAC_SHA1SignatureProvider alloc] init];
NSString *oauthSignature = [provider signClearText:oauthBaseString withSecret:oauthEncodedKey];
NSString *oauthEncodedSignature = [self urlEncode:oauthSignature];

// prepare request
NSString *oauthHeader = @"OAuth ";
oauthHeader = [oauthHeader stringByAppendingFormat:@"oauth_consumer_key=\"%@\"",oauthConsumerKey];
oauthHeader = [oauthHeader stringByAppendingFormat:@",oauth_token=\"%@\"",oauthAccessToken];
oauthHeader = [oauthHeader stringByAppendingFormat:@",oauth_signature_method=\"%@\"",oauthSignatureMethod];
oauthHeader = [oauthHeader stringByAppendingFormat:@",oauth_signature=\"%@\"",oauthEncodedSignature];
oauthHeader = [oauthHeader stringByAppendingFormat:@",oauth_timestamp=\"%d\"",oauthTimeStamp];
oauthHeader = [oauthHeader stringByAppendingFormat:@",oauth_nonce=\"%@\"",oauthNonce];
oauthHeader = [oauthHeader stringByAppendingFormat:@",oauth_version=\"1.0\""];

NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:urlString]];
[request setHTTPMethod:@"GET"];
[request setValue:oauthHeader forHTTPHeaderField:@"Authorization"];

NSHTTPURLResponse *response = nil;
NSError *error = nil;
NSData *responseData = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error]; 
```

当我查看 http 响应代码时，我得到了 500。我已就意外的 500 响应联系了服务提供商。

与此同时，在我可能做错的事情上，你有什么特别之处吗？

即使只是向我指出一些工作示例代码，也会受到高度赞赏。我已经阅读了很多东西，但我显然在 obj-c 中弄错了一些细微差别。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-23T23:21:45.020

如果我是你，我会在[github上查看](https://github.com/ShareKit/ShareKit)[ShareKit](http://getsharekit.com/)的源代码，它集成了许多 OAuth Web 服务。我相信它使用[OAuthConsumer](http://code.google.com/p/oauthconsumer/)可能对您特别有用。OAuthConsumer 有一些文档，您可能想尝试将其集成到您的应用程序中。

如果您查看[OAMutableURLRequest](https://github.com/jdg/oauthconsumer/blob/master/OAMutableURLRequest.m)，您可以看到 OAuthConsumer 如何创建请求。我看不出你的标题设置方式有什么大的不同，除了它们有一个`realm`标题。我的建议是尝试使用 OAuthConsumer 发出请求，看看它是否有效。如果它不适用于 OAuthConsumer，那么我会想象问题出在其他地方（可能在服务器上？）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-24T14:17:07.920

自从我玩过 OAuth 已经有一段时间了，但我已经为 PHP 和 Objective-C 做了一个小项目，它消除了我所有需要再次搞砸它的需要。

我的猜测是您的标题字段需要按字段名称排序，因此，顺序应该是这样的：

```
NSString *oauthHeader = @"OAuth ";
oauthHeader = [oauthHeader stringByAppendingFormat:@"oauth_consumer_key=\"%@\"",oauthConsumerKey];
oauthHeader = [oauthHeader stringByAppendingFormat:@",oauth_nonce=\"%@\"",oauthNonce];
oauthHeader = [oauthHeader stringByAppendingFormat:@",oauth_timestamp=\"%d\"",oauthTimeStamp];
oauthHeader = [oauthHeader stringByAppendingFormat:@",oauth_token=\"%@\"",oauthAccessToken];
oauthHeader = [oauthHeader stringByAppendingFormat:@",oauth_signature=\"%@\"",oauthEncodedSignature];
oauthHeader = [oauthHeader stringByAppendingFormat:@",oauth_signature_method=\"%@\"",oauthSignatureMethod];
oauthHeader = [oauthHeader stringByAppendingFormat:@",oauth_version=\"1.0\""]; 
```

请随时查看我在 Gitorious for Objective-C 中的[uOAuth (micro-OAuth) 项目](https://gitorious.org/uoauth/uoauth-objc)源代码（如果您也想查看的话，还有一个 PHP 版本）。

如果您需要更多说明，我很乐意编辑问题或回答您的评论。

赞！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T19:02:17.310

我遇到了一个包含标头字段的问题，所以我通过将所有参数包含为 url 编码来摆脱它们。我做了以下。

*   使用 OAuthConsumer-iphone 推特应用 [http://code.google.com/p/oauthconsumer-iphone/](http://code.google.com/p/oauthconsumer-iphone/)
*   转到 -(void)prepare 在 OADataFetcher.m 下，摆脱 oauthheader 并通过执行 [request setParameters:[(NSArray *)allParameters urlEncoded]] 将所有参数包含为 url 参数；
*   休息应该是直截了当的。
*   因此，总的来说，您将集中的所有文件是 oauthTwitterAppViewController、OAMutableURLRequest、OADataFetcher、AuthorizeWebViewController。

我花了将近一周的时间与服务提供商同步以使其正常工作。但是，如果您准备好所有资源，那么您可能需要 2 天的时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T04:32:36.333

我看到了你的代码，在这个网站上看了一些其他问题之后，我终于构建了一个运行代码。在我的例子中，我使用 AFHTTPClient 发起请求，我只使用 OAMutableURLRequest 创建 Authorization 标头，然后我使用 Authorization 标头附加到我发送到服务器的请求。

我在这里为需要它的人分享我的代码。

在您的情况下，我认为您应该检查发送到服务器的请求，并使用 Fiddler 编写测试请求来调试您的服务。

对不起我的英语不好：p。

```
NSDictionary * jsonDic;
__block NSString *responsebody = @"";
OAConsumer *consumer = [[OAConsumer alloc] initWithKey:@"123"
                                                secret:@"456"];
NSURL *url = [NSURL URLWithString:@"http://MyServiceURL/MyServiceFunction"];

OAMutableURLRequest *request = [[OAMutableURLRequest alloc] initWithURL:url
                                                               consumer:consumer
                                                                  token:nil
                                                                  realm:nil
                                                      signatureProvider:nil];
[request prepare];

NSString *oauthHeader = @"OAuth ";
oauthHeader = [oauthHeader stringByAppendingFormat:@"oauth_consumer_key=\"%@\"",@"123"];
oauthHeader = [oauthHeader stringByAppendingFormat:@",oauth_token=\"%@\"",@""];
oauthHeader = [oauthHeader stringByAppendingFormat:@",oauth_signature_method=\"%@\"",@"HMAC-SHA1"];
oauthHeader = [oauthHeader stringByAppendingFormat:@",oauth_signature=\"%@\"",encodeToPercentEscapeString(request.signature)];
oauthHeader = [oauthHeader stringByAppendingFormat:@",oauth_timestamp=\"%ld\"", (time_t) [[NSDate date] timeIntervalSince1970]];
oauthHeader = [oauthHeader stringByAppendingFormat:@",oauth_nonce=\"%@\"",request.nonce];
oauthHeader = [oauthHeader stringByAppendingFormat:@",oauth_version=\"1.0\""];
//NSLog(@"oauthHeader: %@", oauthHeader);

[AFNetworkActivityIndicatorManager sharedManager].enabled = YES;

NSURL *baseURL = [NSURL URLWithString:@"http://MyServiceURL"];
AFHTTPClient* client = [[AFHTTPClient alloc] initWithBaseURL:baseURL];
[client setParameterEncoding:AFJSONParameterEncoding];
[client setDefaultHeader:@"Accept" value:RKMIMETypeJSON];
[client setDefaultHeader:@"Content-Type" value:@"application/json"];
[client setDefaultHeader:@"Authorization" value:oauthHeader];

NSDictionary *finalDict = @{@"user":@{@"id":@"001"}};
// create a JSON string from your NSDictionary
NSError *error;
NSData *jsonData = [NSJSONSerialization dataWithJSONObject:finalDict options:NSJSONWritingPrettyPrinted error:&error];

[client postPath:@"/MyServiceFunction"
      parameters:finalDict
         success:^(AFHTTPRequestOperation  *operation, id JSON) {
             responsebody = operation.responseString;
             jsonDic = [NSJSONSerialization JSONObjectWithData:[responsebody dataUsingEncoding:NSUTF8StringEncoding] options:NSJSONReadingMutableLeaves error:nil];
         }
         failure:^(AFHTTPRequestOperation  *operation, NSError *error) {
             NSLog(@"Hit error: %@", error);
         }]; 
```

和

```
NSString* encodeToPercentEscapeString(NSString *string) {
return (NSString *)
CFBridgingRelease(CFURLCreateStringByAddingPercentEscapes(NULL,
                                        (CFStringRef) string,
                                        NULL,
                                        (CFStringRef) @"!*'();:@&=+$,/?%#[]",
                                        kCFStringEncodingUTF8));} 
```

# cfengine - 如何在 CFEngine 中获取“ReturnsNotZero”？

> ID：11093940
> 
> 赞同：1
> 
> 时间：2012-06-19T03:18:37.383
> 
> 标签：cfengine

里面有`ReturnsZero`函数，`CFEngine`但是没有`ReturnsNotZero`。

如果我确实需要根据命令的非零返回值定义一个类，我该怎么办？

中的示例`CFEngine2`是首选但`CFEngine3`很好:-)

* * *

**示例`CFEngine2`**

（我认为在任何官方文档中都找不到。我花了大约半个小时在`CFEngine2`的源代码中找到了这个技巧）

```
classes:
    has_python27 = ( ReturnsZero(/usr/bin/which python27) )
    no_python27 = ( !ReturnsZero(/usr/bin/which python27) ) 
```

希望这可以帮助有过时的人`CFEngine`

**示例`CFEngine3`**

请阅读下面 zzamboni 的回答:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T13:39:11.693

使用 CFEngine 3，您可以简单地使用`not`以下结果`returnszero()`：

```
classes:
    "someclass" not => returnszero("/some/command"); 
```

# c - 我们如何从 GLSL 中获取变量值？

> ID：11093941
> 
> 赞同：1
> 
> 时间：2012-06-19T03:18:39.710
> 
> 标签：c, glsl

我正在做一个需要大量计算的项目，我有一个想法是将工作交给 GPU，但我想知道我们是否可以从 GLSL 检索结果，如果可能的话，如何？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T03:28:58.537

除了放在帧缓冲区中的内容之外，GLSL 不提供输出。

要对 GPU 进行编程并更方便地获得结果，请使用[CUDA](http://www.nvidia.com/object/cuda_home_new.html)（仅限 NVidia）或[OpenCL](http://www.khronos.org/opencl/)（跨平台）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T03:47:43.047

In general, what you want to do is use OpenCL for general-purpose GPU tasks. However, if you are insistent about pretending that OpenGL is not a rendering API...

[Framebuffer Objects](http://www.opengl.org/wiki/Framebuffer_Object) make it relatively easy to render to multiple outputs. This of course means that you have to structure your processing such that what gets rendered matches what you want. You can render to 32-bit floating-point "images", so you have access to plenty of precision. The biggest difficulty is what I stated: figuring out how to structure your task to match rendering.

It's a bit easier when using transform feedback. This is the ability to write the output of the vertex (or geometry) shader processing to a [buffer object](http://www.opengl.org/wiki/Buffer_Object). This still requires structuring your tasks into something like rendering, but it's easier because vertex shaders have a strict one-vertex-to-one-vertex mapping. For every input vertex, there is exactly one output. And if you draw `GL_POINTS`, it's not too difficult to use attributes to pass the data that changes.

Both easier and harder is the use of shader_image_load_store. This is effectively the ability to read/write from/to arbitrary images "whenever you want". I put that last part in quotes because there are lots of esoteric rules about data race conditions: reading from a value written by another shader invocation and so forth. These are *not* trivial to deal with. You can try to structure your code to avoid them, by not writing to the same image location in the same shader. But in many cases, if you could do that, you could just render to the framebuffer.

Ultimately, it's pretty much impossible to answer this question in the general case, without knowing what *exactly* you're trying to actually do. How you approach GPGPU through a rendering API depends greatly on exactly what you're trying to compute.

# html - 是否可以在 CSS3 中使 div 50px 小于 100%？

> ID：11093943
> 
> 赞同：227
> 
> 时间：2012-06-19T03:18:52.410
> 
> 标签：html, css

是否可以在纯 CSS 中使`div`50px 小于 100%？我希望`<div>`50px 小于 100%。我不想要任何 JavaScript。

* * *

## 回答 #1

> 赞同：291
> 
> 时间：2012-06-19T03:18:53.173

是的你可以。在不使用 IE 的情况`expression()`下，您可以在 CSS3 中使用[`calc()`](http://www.w3.org/TR/css3-values/#calc).

```
div {
    width: 100%;
    width: -webkit-calc(100% - 50px);
    width: -moz-calc(100% - 50px);
    width: calc(100% - 50px);
} 
```

演示：http: [//jsfiddle.net/thirtydot/Nw3yd/66/](http://jsfiddle.net/thirtydot/Nw3yd/66/)

这将使您的生活变得更加轻松。目前支持 3 种主要浏览器：Firefox、Google Chrome (WebKit) 和 IE9：[http ://caniuse.com/calc](http://caniuse.com/calc)

MDN：[https ://developer.mozilla.org/en/CSS/-moz-calc](https://developer.mozilla.org/en/CSS/-moz-calc)

* * *

## 回答 #2

> 赞同：159
> 
> 时间：2012-06-19T04:37:27.853

**DIV**自动采用其父级的宽度。所以没有必要定义任何`width`. 通常会简单地这样写：

```
div{
    margin-right:50px;
} 
```

检查这个[小提琴](http://jsfiddle.net/Nw3yd/2/)

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2012-06-19T05:10:09.357

另一种选择是绝对定位。

```
div {
    position: absolute;
    left: 0;
    right: 50px;
} 
```

[小提琴](http://jsfiddle.net/Nw3yd/59/)

但是，Sandeep 的解决方案是您通常应该使用的解决方案。只是避免过度使用`float`. 这可以防止元素自然地填充它们的容器。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-06-19T14:37:50.707

我的解决方案有无`float: left`.

HTML：

```
<div></div> 
```

CSS：

```
div {
    height: 20px;
    background: black;
    float: left;
    width: 100%;
    padding-right: 50px;
    box-sizing: border-box;
    background-clip: content-box; 
}​ 
```

[演示](http://jsfiddle.net/GB2ut/1/)

兼容性：
Firefox 3.6、Safari 5、Chrome 6、Opera 10、IE 9

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-04-18T02:58:03.713

[jsFiddle](http://jsfiddle.net/Bushwazi/bFFuH/)

使用显示`block`和`margin`. `display:block`当不与定义的`height`/结合时，`width`将尝试填充它的父级。

```
header {
    width:100%;
    background:#d0d0d0;
    height:100%;
}
h1 {
    display:block;
    border:#000 solid 1px;
    margin:0 50px 0 0;
    height:100px;
}
<header>
    <h1></h1>
</header> 
```

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2012-06-19T09:15:00.423

是的，我们可以通过制作

```
#custom_div{
 width:100%;
 margin-right:50px;
 } 
```

谢谢

# android - 如何获得有关 CheckBoxPreference 状态更改的通知？

> ID：11093945
> 
> 赞同：3
> 
> 时间：2012-06-19T03:18:53.867
> 
> 标签：android, checkbox, sharedpreferences, preferenceactivity

我需要动态设置/取消设置侦听器以响应[Preference CheckBox](http://developer.android.com/reference/android/preference/CheckBoxPreference.html)用户设置更改。

我见过的一种方法是使用[onSharedPreferenceChanged()](https://stackoverflow.com/questions/9719541/preferenceactivity-using-onsharedpreferencechanged)并检查该复选框的键。

但不知何故，这在我看来效率低下。我更多地考虑在派生的类上设置某种侦听器的方向`PreferenceActivity`。也许[onContentChanged()](http://developer.android.com/reference/android/preference/PreferenceActivity.html#onContentChanged%28%29)？

您会推荐哪种方法，为什么？

你能指出一个示例工作代码吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T13:05:39.097

你应该实施[`OnSharedPreferenceChangeListener`](http://developer.android.com/reference/android/content/SharedPreferences.OnSharedPreferenceChangeListener.html). 然后设置一个监听器来捕捉关键变化：

```
getPreferenceScreen().getSharedPreferences().registerOnSharedPreferenceChangeListener(this); 
```

您应该能够检索检查的更改：

```
public void onSharedPreferenceChanged(SharedPreferences sharedPreferences,String key) 
{

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T03:22:45.227

这是[文档](http://developer.android.com/resources/tutorials/views/hello-formstuff.html)。使用 XML 文件，您可以设置单击小部件时要执行的方法。设置`android:onClick = foo`将在单击小部件时执行该方法`foo`，并将参数传递给它`View v`，`v`即被单击的视图。

# iphone - 表单模式视图动画

> ID：11093948
> 
> 赞同：4
> 
> 时间：2012-06-19T03:19:20.810
> 
> 标签：iphone, objective-c, ios, ipad

我`UIModalPresentationFormSheet`的应用中出现了视图。`Right`他们中的一些人从一些人中出现，`Bottom`而解雇似乎是随机的。有的消失，`Bottom`有的去，`Left`有的去`Up`。有没有办法设置他们出现和消失的方向？

我用来呈现的代码（同样的代码，只是呈现了不同的视图控制器，从同一个视图控制器调用，对于不同的模态视图有不同的动画）：

```
MyViewController *newModalView = [[MyViewController alloc] init];
newModalView.modalPresentationStyle = UIModalPresentationFormSheet;
[self presentModalViewController:newModalView animated:YES]; 
```

然后在模态视图中我称之为关闭它：

```
[self dismissModalViewControllerAnimated:YES]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-04T17:10:44.753

这是一个已知的错误，正在由苹果公司解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T04:55:58.653

尝试这样的事情：

```
newModalView.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-28T09:26:16.453

所有过渡样式：

```
newModalView.modalTransitionStyle = UIModalTransitionStyleCrossDissolve;
newModalView.modalTransitionStyle = UIModalTransitionStyleCoverVertical;
newModalView.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal; 
```

# objective-c - 放置处理 UI 转换和操作的代码的最佳位置在哪里？

> ID：11093950
> 
> 赞同：0
> 
> 时间：2012-06-19T03:19:52.417
> 
> 标签：objective-c, ios, model-view-controller, user-interface

我的 MainViewController 中有以下代码。那是最好的地方吗？我还有其他几种具有类似行为的方法。这种类型的代码是否属于一个单独的类，仅用于 UI 转换和操作？

```
-(void)slideView3P{
    [self.view bringSubviewToFront:_view3P];
    if (view3PIsMinimized){
        view3PIsMinimized = NO;
        [UIView beginAnimations:@"animationOff" context:NULL]; 
        [UIView setAnimationDuration:0.5f];
        [_view3P setFrame:CGRectMake(_view3P.frame.origin.x, 7, _view3P.frame.size.width, 446)];
        [UIView commitAnimations];    
    }
    else {
        view3PIsMinimized = YES;
        [UIView beginAnimations:@"animationOff" context:NULL]; 
        [UIView setAnimationDuration:0.5f];
        [_view3P setFrame:CGRectMake(_view3P.frame.origin.x, 57, _view3P.frame.size.width, 46)];
        [UIView commitAnimations];
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T03:59:54.190

对我来说，我将创建一个名为 Helper 的模型并为动画创建类方法，如下所示：

```
+ (void)slideHoriWithPixel:(CGFloat) _pixel ForView:(UIView *) _view;

+ (void)slideVertWithPixel:(CGFloat) _pixel ForView:(UIView *) _view;

+ (void)popOutAnimationForView:(UIView *) _view; 
```

会有一些简单和复杂的动画。

好处是：

*   你永远不知道什么时候会重用这些动画。
*   即使你做另一个项目，你也可以简单地将这个 Helper Model 导入到新项目中
*   在你完成了多个项目之后，这个模型最终可能会成为你自己的动画库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T03:30:10.267

在我的应用程序中，我通常将我的转换放在视图控制器中，就像你现在正在做的那样。但是，如果您想重用转换，您可以将它们放在一个单独的类中，并将其导入到您希望转换的各种视图控制器中。请注意：我不会使用`beginAnimations:context:`and `commitAnimations`，因为 Apple 不推荐它们。取自[UIView 类参考：](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIView_Class/UIView/UIView.html)

> **动画视图**
> 
> 在 iOS 4 及更高版本中不鼓励使用本节中的方法。请改用基于块的动画方法。
> 
> +开始动画：上下文：
> 
> +提交动画
> 
> +setAnimationStartDate:
> 
> +setAnimationsEnabled:
> 
> +setAnimationDelegate:
> 
> +setAnimationWillStartSelector:
> 
> +setAnimationDidStopSelector：
> 
> +setAnimationDuration:
> 
> +setAnimationDelay:
> 
> ETC...

希望这可以帮助！

# web - aptana studio 初学者的所见即所得编辑器

> ID：11093951
> 
> 赞同：2
> 
> 时间：2012-06-19T03:19:57.353
> 
> 标签：web, aptana, wysiwyg, notepad++

我是一个新的网页设计师。我学习了 HTML5 和 CSS3。但是，我发现如果没有所见即所得的编辑器，我很难向前发展。

我希望能够输入我学过或仔细收集的代码，但我也希望能够立即看到它工作，这样我就可以确信我在正确的轨道上。

**问题：**当我输入代码并构建新网站时，有没有办法将 Aptana Studio（或 Notepad++）与所见即所得视图结合起来？

请帮我。感谢您的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T04:09:26.507

目前，没有办法结合 Aptana Studio（或 Notepad++）获得所见即所得的编辑器。但是您可以尝试其他免费的所见即所得编辑器来满足您的愿望。以下软件可能对您非常有用。

*   [女巫](http://net2.com/nvu/screenshots.html)
*   [阿玛亚](http://www.w3.org/Amaya/)
*   [微风](http://www.pagebreeze.com/)
*   [蓝狮鹫](http://bluegriffon.org/ "蓝狮鹫")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-13T04:31:24.857

由于这是一个受欢迎的帖子：

截至 2016 年 12 月，最流行和最有用的解决方案似乎是[Adob​​e Brackets](http://brackets.io/)。

它具有实时预览功能，您可以在键入时立即在浏览器中看到更改。

# specs - 在 ruby motion 中创建规范助手

> ID：11093954
> 
> 赞同：6
> 
> 时间：2012-06-19T03:20:43.897
> 
> 标签：specs, rubymotion

我在几个不同的规范中使用了一些常用方法，我想将它们提取到某个地方，比如可以从所有规范访问的规范助手。有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T17:12:05.763

这是一个有点像 spec_helper 的东西。

```
# _spec_helper.rb

module SpecHelper
  ::App::Persistence = {}

  # global `before :each` ish
  def self.extended(base)
    base.before do
      ::App::Persistence.clear
    end
  end

  def foo_helper
  end
end 
```

然后使用它：

```
# my_view_spec.rb

describe "MyView" do
  extend SpecHelper

  before do
    foo_helper
  end
  ... 
```

要记住两件事：

1.  规范帮助文件的命名方式是它首先被加载（前导下划线）

2.  当运行单个规范（例如`files=my_view_spec.rb`）帮助文件时，必须进行 -`files=spec/my_view_spec.rb,spec/_spec_helper.rb`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-14T00:52:35.077

根据当前[http://www.rubymotion.com/developer-center/articles/testing/#_spec_helpers](http://www.rubymotion.com/developer-center/articles/testing/#_spec_helpers)

> 规范助手是在 RubyMotion 项目的 spec/helpers 目录下创建的。一个例子可以是 spec/helpers/extension.rb。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-05T08:34:12.283

我只是将我在规范中使用的常用方法（未封装在 a`Module`或任何东西中）放在**spec/support/utilities.rb**文件中，Rubymotion 似乎可以很好地选择它们，尽管我不知道这是否是“正确”的方法来做到这一点。

# modx - 如何为 MODx Revolution 中的 BreadCrumb 片段正确形成我的 tpl？

> ID：11093956
> 
> 赞同：0
> 
> 时间：2012-06-19T03:21:06.930
> 
> 标签：modx, modx-revolution

我正在从面包屑片段过渡到面包屑片段。

这是我的面包屑代码：

```
[[Breadcrumbs? &respectHidemenu=`0` &crumbSeparator=`` currentAsLink=`false` &showHomeCrumb=`0` &titleField=`bc-title`]] 
```

这是我的面包屑代码：

```
[[BreadCrumb? showHidden=`0` showBreadCrumbAtHome=`0`]] 
```

我试图在我的 BreadCrumbLinkCrumbTpl 和我的 BreadCrumbCurrentCrumbTpl 中模仿来自面包屑的 titleField 部分（所以如果 bc-title 为空，则回滚到 pagetitle）：

```
<li><a href="[[+link]]">[[*bc-title:empty=`[[+pagetitle]]`]]</a></li> 
```

它在 BreadCrumbCurrentCrumbTpl 上效果很好，但在 BreadCrumbLinkCrumbTpl 上它只显示 pagetitle，而不是 bc-title 首先。好像不能穿越？想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:27:59.917

据我所知，Breadbrumbs 没有任何包含模板变量的设置（这很糟糕）。您可以像这样做一个简单的解决方法：

```
<li><a href="[[+link]]">[[!parseNavTitle? &sid=`[[+id]]`]]</a></li> 
```

片段`parseNavTitle`：

```
$obj = $modx->getObject('modResource',$sid);
if ($obj->getTVValue('bc-title') == '')
    return $obj->get('pagetitle');
else
    return $obj->getTVValue('bc-title'); 
```

# wcf - 更新服务参考文件更改

> ID：11093959
> 
> 赞同：0
> 
> 时间：2012-06-19T03:22:20.550
> 
> 标签：wcf

我陷入了一个非常奇怪的问题。我正在使用 VS 在 asp.net 项目中使用 wcf 服务。之前一切都很好，但突然 wcf 服务更新开始表现得很奇怪。只要我通过右键单击服务并选择更新服务引用来更新服务引用，它就会删除所有文件并创建具有不同名称的新文件。我得到了具有不同文件（wsdl、xsd 等）名称的更新服务，因为这些我无法签入代码。即使删除和添加服务参考也给出了相同的结果。

每次我获取更新服务参考时，它都会用不同的名称更新 wsdl、xsd 文件，而不是在同一个文件中更新。

期待任何指导来解决这个问题。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T12:06:28.777

听起来好像服务端点在更新之间以某种方式发生了变化。如果服务端点更改，服务引用也会相应更改。这是正常的，也是意料之中的。

# git - 如何将一组修改后的提交（存储在 reflog 中）变成真正的提交

> ID：11093964
> 
> 赞同：5
> 
> 时间：2012-06-19T03:22:41.123
> 
> 标签：git, refactoring, commit, reflog

我正在进行重构，每次取得任何体面的进展时都会不断地进行修改。它进行得非常好，我意识到能够向人们展示我是如何处理如此巨大的重构（很多微小的步骤，只是轻推代码，每个点都有一个绿色测试套件）会很好。

提交都在我的[reflog](https://gist.github.com/2952094)中。有没有办法将每个修改后的提交变成自己的真实提交（对不起，不知道术语），以便用户可以看到每个步骤，而不仅仅是第 81 和 57 行的聚合步骤？我不需要提交或任何东西的唯一消息，只是它们被记录在历史记录中。

这仍然在我的本地仓库中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T05:47:08.407

重建 reflog 可能不像最初看起来那么困难。您可以将 reflog 的提交重新生成到不同的分支中，或者您可以使用它来生成包含 reflog 一部分的`git read-tree`单个。`newbranch`

**每个分支解决方案一次提交：**

假设您希望每次提交都有不同的分支。首先，复制您的存储库。您将在此过程中更改您的 reflog，因此您不妨使用一次性版本。其次，检查您的 reflog 并找到您想要开始的提交。它看起来像`HEAD@{n}`。假设它是`HEAD@{49}`。然后，试试这个脚本，用 替换`head -50`，`head -<n + 1>`不管你的情况是什么：

```
#!/bin/sh
reflog=$(git reflog | head -50 | awk '{ print $1 }')
i=0
for ref in $reflog; do
    git checkout -B "reflog_$i" $ref
    i=$(expr $i + 1)
done 
```

这是一次获取 reflog 的提交历史记录，然后对其进行迭代，`reflog_$i`沿途生成分支。您可以随心所欲地挑选、合并或操纵它们。如果这只是为了演示，您可以编写一个`git checkout`在分支上执行的简短脚本，运行测试套件，并在整个过程中显示绿色。记住，`reflog_1`代表最新的历史；`reflog_<n+1>`最老的。

```
#!/bin/sh
for i in $(seq 50 1); do
    git checkout "reflog_$i"
    ./test-suite.sh
done 
```

当你解释你的提交方法时，把它扔到投影仪上，这将是一个很好的背景。

如果你想组合所有的分支，你可以运行这个 ruby​​ 脚本来按顺序应用它们（或者用你喜欢的任何语言创建一个等效的）。让我重申，您应该备份您的目录，因为这是相当具有破坏性的。

```
#!/usr/bin/env ruby
n = 50

n.downto 0 do |i|
  system "
    git read-tree reflog_#{i}
    git commit -m 'Refactoring #{n - i}'
    git checkout -- .
    git br -D refog_#{i}
  "
end 
```

**使用将所有提交放在同一个分支上`git read-tree`**

首先，复制您的存储库。然后使用如下脚本。根据第一个解决方案中的讨论，将两者更改为`<n + 1>`您在 reflog 中想要的任何深度，再加上一个。注意额外的管道到`sed`. 您必须使用它或类似的东西，以免 reflog`newbranch`按时间倒序应用。肯定有一种方法可以在不同时使用`awk`and的情况下做到这一点`sed`，但这有效：

```
#!/bin/sh
reflog=$(git reflog | head -<n + 1> | awk '{ print $1 }' | sed -n '1!G;h;$p')
git checkout -B newbranch HEAD@{<n + 1>}
for ref in $reflog; do
    git read-tree "$ref"
    git commit --no-verify -m "Adding commit $ref"
    git checkout -- .
done 
```

最终结果将是`newbranch`，它应该包含 和 之间的所有提交`HEAD@{0}`，`HEAD@{n}`基于提交`HEAD@{n+1}`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T04:27:31.560

这是可能的，但可能很困难。

每次你做一个`--amend`，你基本上“扔掉”了以前的提交，并用新的修改提交替换它，其中包含以前的更改以及任何修改的内容。

所以：

```
A<--B (master) 
```

现在提交 --amend:

```
 ---B
 /
A<--C (master) 
```

现在再次提交 --amend ：

```
 --B
/
A<--D (master)
\
 --C 
```

提交 B 和 C 仍然存在。但是，它们没有被任何东西指向，最终将被垃圾收集。

所以要得到你想要的图表：

```
git checkout master
git reset --hard A
git cherry-pick B
git cherry-pick C
git cherry-pick D 
```

树叶：

```
A<--B'<--C'<--D' (master) 
```

（注意主要（撇号）符号 - 表示它们是具有新哈希的新提交）

现在，我不确定的一件事是你们是否会发生冲突。我相信你会的，因为以后的每个提交都包含一些与以前的提交相同的更改，因为它们已经过修改。如果是这样，您将不得不解决这些问题。

请记住，鉴于 git 的工作方式，如果您尝试这样做但它不起作用，那么回到您现在所在的位置很简单：

```
git reset --hard D 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T05:51:05.060

您可以从第一个 reflog 条目中创建一个新分支，然后对于每个 reflog 条目，将树 git checkout 到工作区，然后提交它。

这样您就不会遇到任何冲突，因为您实际上只是用更新的 reflog 树重写了工作区树。

# arrays - Perl：将字符串的内容加载到数组中

> ID：11093971
> 
> 赞同：1
> 
> 时间：2012-06-19T03:23:33.423
> 
> 标签：arrays, perl

我有一个简单的问题，希望你们能帮助阐明。我正在稳步学习 perl。

假设我有一个非常大的字符串，例如输出：

```
our $z = `du -B MB /home` 
```

这将产生如下字符串：

```
1MB     /home/debug/Music
1MB     /home/debug/Downloads
20MB    /home/debug
20MB    /home/ 
```

我想知道的是，如何将此字符串加载到具有两列和 n 行的数组中（其中 n 是 du 输出中的行数）？

我正在尝试类似以下内容：

```
my $z1 = `du -B MB /home | tail -4`;
my @c0 = split (/n/, $z1);
my $z2 = join (/\t/, @c0);
my @c2=split(/\t/, $z2);
print @c2; 
```

产生以下输出：

```
1MB/home/debug/Music1MB/home/debug/Downloads20MB/home/debug20MB/home 
```

我想我可以使用替换函数 s///g 将目录替换为空值，并将 SPACE 值设置为一个数组，并将空间值设置为空并将其设置为第二个数组，并且可以将 1 个数组设置为键给对方。

有没有人对解决这个问题的最佳方法有任何建议？

任何帮助表示赞赏。

谢谢，

迭戈

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T03:41:08.780

```
#!/usr/bin/perl;
my $z= `du -h -d 1 /home/*`;
my @array  = split("\n",$z);
foreach my $ar(@array) {
my @ar = split("\t",$ar);
$ar = \@ar;
}

foreach my $entry(@array) {
print $entry->[0];
print $entry->[1];

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T03:44:37.520

You can probably try and store them in a hash as follows:

```
#!/usr/bin/perl

use strict;
use warnings;

my $data = '1MB /home/work 4MB /user/bin';
my %values = split(' ', $data);
foreach my $k (keys %values) {
    print "$k: $values{$k}\n";
}
exit 0; 
```

Note that `' '` as the first argument of `split` will match any whitespace character (so we make the most of it). The output for the above should be something like:

```
1MB: /home/work
4MB: /user/bin 
```

You will have to work the original data into `$data` and check if a hash works for you.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T08:56:43.623

我相信你们 perl 的老手不会很喜欢这个解决方案，但我基本上解决了我的 nix 根源。我之前在 for 循环中遇到了这个问题，但我意识到我可以利用管道通过 shell 进行评估，只要答案存储在字符串中。

```
my $z1; my $z2;

$z1 = `du -B MB /home | cut -f1`
$z2 = `du -B MB /home | cut -f2`

my @a1; my @a2;

@a1 = split("\n", $z1);
@a2 = split("\n", $z2); 
```

数组@a1 保存第一个字符串的值，@a2 保存第二个字符串的值。

我对你们的问题是，是否有与 unix 'cut' 实用程序等效的 perl？即在哪里可以将字符串输出拆分到第一个制表符分隔的字段？这是我必须探索的问题。

迭戈

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-12T03:52:05.957

老实说，我不确定您要完成什么。如果你只是想拥有一个包含 n 个元素的数组，每个元素都是一个包含两列的字符串，你只需要看看

```
my @z1 = `du -B MB /home | tail -4`; 
```

例如，可以访问文件的第三行（记住 perl 数组是从 0 开始的）：

```
print $z1[2]; 
```

生产输出

```
20MB    /home/debug 
```

更有用的是在哈希中捕获每个目录的大小：

```
my %dir2size;
foreach (@z1) {
    my @line = split /\s+/;
    $dir2size{$line[1]} = $line[0];
}
foreach my $key (sort keys %dir2size) {
    print "$key: $dir2size{$key}\n";
} 
```

产生输出

```
/home/: 20MB
/home/debug: 20MB
/home/debug/Downloads: 1MB
/home/debug/Music: 1MB 
```

# c# - C#：如何使类变量持久化

> ID：11093972
> 
> 赞同：-4
> 
> 时间：2012-06-19T03:23:40.250
> 
> 标签：c#

在我的 C# 代码隐藏文件 (.cs) 中，我只有一个类，它派生自 System.Web.UI.Page。该类包含字典数组。在其中一次单击按钮时，即在按钮单击事件处理函数中，我创建了此类的对象并执行了一些操作。现在，在另一个按钮单击时，我需要执行其他操作，这些数据需要属于在上一次单击按钮时创建的类的对象或实例的数据。我怎样才能做到这一点？我需要所有数据，尤其是属于该对象/类实例的字典数组。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T03:31:10.427

**HTTP 是无状态的**。所以没有直接的方法可以做到这一点。

您可以做的是将其保存在某种存储机制中并稍后访问它。您可以考虑 DB`table`等`Session`...

这是一个存储在的示例`Session`

```
 YourClass object1=new YourClass();
 object1.SomeProperty="HTTP is stateless"; 
 Session["ThatObject"]=object1; 
```

您可以像这样在下一个按钮单击事件中访问它

```
 if(Session["ThatObject"]!=null)
 {
   YourClass object1=(YourClass) Session["ThatObject"];
   //now you can access object1 properties here.
 } 
```

**在会话中存储这么多**项目不是一个好主意，因为它会使您的服务器哭泣，因为会话存储在服务器中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T03:30:15.777

您可以使用*静态*声明，以便它在请求中保持不变。

```
static IDictionary<string,object> myPersistentDict; 
```

当然，您必须担心这种方法的线程安全性。如果您使用的是 .NET 4，则有一个内置的字典类可以为您处理这个问题，[ConcurrentDictionary](http://msdn.microsoft.com/en-us/library/dd287191.aspx)

```
static ConcurrentDictionary<string, object> myPersistentDict; 
```

# lex - Lex：所有方式在规则部分遇到错误

> ID：11093975
> 
> 赞同：0
> 
> 时间：2012-06-19T03:24:35.840
> 
> 标签：lex

我开始在作业中使用 Lex。在我的 Lex 文件中，当转到规则部分的第一行时，我总是遇到错误。我已经对书中的示例代码进行了测试。

这是 Flex 抛出的错误：

> 1 错误：在线解析错误
> 
> 2 描述：错误的宏定义。

这是我的代码。

```
int num_lines = 0, num_chars = 0;
%%
\n ++num_lines; ++num_chars;     // error here 
. ++num_chars;
%%
main()
{
yylex();
printf( "# of lines = %d, # of chars = %d\n",
num_lines, num_chars );
} 
```

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T03:29:33.307

尝试

```
%{
int num_lines = 0, num_chars = 0;
%}

%%
... 
```

# jquery - 使用 Jquery 处理页面 OnLoad？

> ID：11093984
> 
> 赞同：0
> 
> 时间：2012-06-19T03:26:46.280
> 
> 标签：jquery, jquery-ui

在下面的代码中，我可以通过单击标题获得相关内容。但问题是，在页面加载时，我看到所有标题和内容，只有在单击任何标题后，其他内容才会消失。情况不应该如此。

在页面加载时，我应该只看到标题...如何？

```
<span>Click a Header!</span>
<div><h2>Sub Header 1</h2></div><div>Content 1</div>
<div><h2>Sub Header 2</h2></div><div>Content 2</div>
<div><h2>Sub Header 3</h2></div><div>Content 3</div>

<script language="javascript">

      $("h2").click(function () 
      {
          $("h2").not(this).parent().next().hide();
          $(this).parent().next().show();
      }); 
</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T03:28:24.073

您编写的代码很可能会在 DOM 加载之前运行。典型的做法是将其包装在`$(document).ready()`事件`.ready`中，用于指定在 DOM 完全加载时执行的函数。

```
$(document).ready(function(){
     $("h2").click(function () 
      {
          $("h2").not(this).parent().next().hide();
          $(this).parent().next().show();
      }); 
} 
```

我建议查看 jQuery 的[优秀文档](http://api.jquery.com/ready/)以获得更深入的解释。

如果您看到希望在加载时隐藏的内容，则需要使用`display:none`

给你不想显示的 div 一个类（比如，`hideOnLoad`），然后在 CSS 中设置可见性属性或在加载时使用 jquery。

例如

```
$('.hideOnLoad').hide(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T03:33:35.947

如果我可以建议稍微不同的标记，事情会变得容易得多（你不再需要`.not(this).parent().next()`了）：

```
<span>Click a Header!</span>
<div><h2>Sub Header 1</h2><div class="content">Content 1</div></div>
<div><h2>Sub Header 2</h2><div class="content">Content 2</div></div>
<div><h2>Sub Header 3</h2><div class="content">Content 3</div></div> 
```

还有 javascript，它可能就在你拥有的标记下方，或者在 document.ready 上（推荐）：

```
$('.content').hide();
$('h2').click(function(){
   $('.content').hide(); 
   $(this).next('.content').show();
});​ 
```

[http://jsfiddle.net/k2g8g/](http://jsfiddle.net/k2g8g/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-19T03:51:42.540

您必须隐藏页面加载中的内容。请尝试以下操作。它可能对你有用

```
$(document).ready(function(){
 $("h2").parent().next().hide();  
});
$("h2").click(function (){
 $("h2").not(this).parent().next().hide();
 $(this).parent().next().show();
 }); 
```

# logging - 如何设置 log4j 以便jackrabbit 不会生成“jackrabbit.log_IS_UNDEFINED”文件

> ID：11093985
> 
> 赞同：0
> 
> 时间：2012-06-19T03:27:19.807
> 
> 标签：logging, log4j, jackrabbit, xml-configuration

预警：我是 log4j 日志记录和一般测井的新手，并为我的无知道歉。

当我从 .jar 运行程序时，我会在运行程序的目录中得到一个“jackrabbit.log_IS_UNDEFINED”文件。这个日志文件非常大（300MB+）并且填满了我的驱动器。我可以看到这个文件有来自我正在使用的几个不同库的调试级别日志。我希望摆脱这个“jackrabbit.log_IS_UNDEFINED”文件，只将错误级别或更高级别的日志记录到我自己在另一个驱动器上的文件中。例如。(/smb01/Aggregator.log)。任何帮助将不胜**感激**。

此外，当我从命令行运行 jar 时，我得到一个 Log4j 错误：

```
log4j:ERROR Root level cannot be inherited. Ignoring directive. 
```

我确实想要/必须指定我自己的配置文件，以便我们可以记录自己的错误。
我继承了这个配置文件。Log4j.xml 配置文件：

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">

<!-- Appender Types: 
    <ConsoleAppender> org.apache.log4j.ConsoleAppender</ConsoleAppender> 
    <FileAppender> org.apache.log4j.FileAppender</FileAppender>
    <JDBCAppender> org.apache.log4j.jdbc.JDBCAppender</JDBCAppender>
    <AsyncAppender> org.apache.log4j.AsyncAppender</AsyncAppender> 
    <JMSAppender> org.apache.log4j.net.JMSAppender</JMSAppender>
    <LF5Appender> org.apache.log4j.lf5.LF5Appender</LF5Appender>
    <NTEventLogAppender> org.apache.log4j.nt.NTEventLogAppender</NTEventLogAppender> 
    <NullAppender> org.apache.log4j.varia.NullAppender</NullAppender>
    <SMTPAppender> org.apache.log4j.net.SMTPAppender</SMTPAppender>
    <SocketAppender> org.apache.log4j.net.SocketAppender</SocketAppender> 
    <SocketHubAppender> org.apache.log4j.net.SocketHubAppender</SocketHubAppender> 
    <SyslogAppender> org.apache.log4j.net.SyslogAppender</SyslogAppender>
    <TelnetAppender> org.apache.log4j.net.TelnetAppender</TelnetAppender>
    <WriterAppender> org.apache.log4j.WriterAppender</WriterAppender> -->
<!-- (all|debug|info|warn|error|fatal|off|null) "null" -->

<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/"
    debug="false" threshold="fatal">

    <!-- Appenders -->
    <appender name="console" class="org.apache.log4j.ConsoleAppender">
        <param name="Target" value="System.out" />
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%-5p %c{1} - %m%n" />
        </layout>
    </appender>

    <appender name="FA" class="org.apache.log4j.FileAppender">
        <param name="File" value="sample.log" />
        <param name="Threshold" value="WARN" />
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%-4r [%t] %-5p %c %x - %m%n" />
        </layout>
    </appender>

    <appender name="ROLL" class="org.apache.log4j.RollingFileAppender">
        <param name="file" value="/smb01/Aggregator.log" /> <!-- The active file to log to -->
        <param name="encoding" value="UTF-8"/>
        <param name="append" value="true" />
        <param name="Threshold" value="WARN" />
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%d{ISO8601}|%5p|%t| %c{1} | %m%n"/>
        </layout>
    </appender>

    <appender name="CustomerReport" class="org.apache.log4j.FileAppender">
        <param name="file" value="CustomerReport.csv" />
        <param name="append" value="FALSE" />
        <param name="Threshold" value="INFO" />
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%m%n" />
        </layout>
    </appender>

    <appender name="rootAppender" class="org.apache.log4j.varia.NullAppender">
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="[%-5p] %c{1} - %m%n" />
        </layout>
    </appender>

    <!-- Loggers -->
    <!-- Standard Levels: DEBUG < INFO < WARN < ERROR < FATAL -->
    <logger name="com.group">
        <level value="info" />
        <appender-ref ref="console" />
        <appender-ref ref="ROLL" />
    </logger>

    <logger name="com.group.main">
        <level value="info" />
        <appender-ref ref="console" />
        <appender-ref ref="ROLL" />
    </logger>

    <logger name="com.group.customerLogger">
        <level value="info"/>
        <appender-ref ref="CustomerReport"/>
    </logger>

    <!-- Root Logger -->
    <root>
        <level value="FATAL"/>
        <appender-ref ref="rootAppender"/>
    </root>

</log4j:configuration> 
```

因为这是我的工作，所以我不能分享我的所有代码，但这里是关键位：

```
import org.apache.log4j.xml.DOMConfigurator;
import org.apache.log4j.*;
import org.apache.log4j.Logger;

public class Main {
  public static Logger logger = Logger.getLogger("com.group.main");

  public static void main(String[] args) {

    // setup the log4j system so we can log stuff.
    org.apache.log4j.extras.DOMConfigurator.configure(args[1]);
    .
    .
    logger.debug("debug message!");
    .
    .
    .
  } 
```

文件`Aggregator.log`并`CustomerReport.csv`显示在它们应该显示的位置，但没有记录/写入它们。我已经能够查看“jackrabbit.log_IS_UNDEFINED”文件，其中包含我所有的登录信息。

处理我正在使用的 log4j 的库（通过构建路径顺序列出）：

*   log4j-1.2.17.jar
*   apache-log4j-extras-1.1.jar
*   jackrabbit-standalone-2.2.10.jar

## 更多信息

我发现另一个 xml 文件似乎是我的罪魁祸首：logback.xml

```
<configuration>
    <appender name="jackrabbit" class="ch.qos.logback.core.FileAppender">
        <file>${jackrabbit.log}</file>
        <encoder>
            <pattern>
                %d{yyyy-MM-dd HH:mm:ss.SSS} %-5level %-40([%thread] %F:%L) %msg%n
            </pattern>
        </encoder>
    </appender>

    <appender name="jetty" class="ch.qos.logback.core.FileAppender">
        <file>${jetty.log}</file>
        <encoder>
            <pattern>
                %d{yyyy-MM-dd HH:mm:ss.SSS} %-5level %-40([%thread] %F:%L) %msg%n
            </pattern>
        </encoder>
    </appender>

    <logger name="org.mortbay.log" level="${log.level}" additivity="false">
        <appender-ref ref="jetty"/>
    </logger>

    <root level="${log.level}">
        <appender-ref ref="jackrabbit"/>
    </root>
</configuration> 
```

我可以（编辑/删除/解决方法）这个文件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T04:52:10.427

我最终没有使用 jackrabbit-standalone-2.2.10.jar 完全消除了错误。相反，我只从 CQ 5.4 中包含的各种其他库中导入了特定类。除了 jackrabbit-standalone-2.2.10.jar 之外，我仍然具有与上图相同的设置。@TedTrippin，感谢您的时间和考虑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T13:15:41.087

您的意思是要传入 log4j 配置文件吗？只要 log4j.xml 在类路径中，Log4j 就应该自己获取配置。确保它是并删除它：

```
org.apache.log4j.extras.DOMConfigurator.configure(args[1]); 
```

然后再试一次。

它看起来不像你的配置，你粘贴的那个，是罪魁祸首，因为那里没有提到jackrabbit。我想知道是否正在从其他地方获取另一个配置？

# asp.net-mvc-3 - MVC3 AJAX 级联下拉列表

> ID：11093986
> 
> 赞同：3
> 
> 时间：2012-06-19T03:27:20.557
> 
> 标签：asp.net-mvc-3, jquery

我很难弄清楚如何让级联下拉列表适用于我的 asp.net mvc3 应用程序。我有一个弹出框，我想显示 2 个下拉列表，第二个是根据第一个中选择的内容填充的。每次我运行应用程序时，控制器方法都会返回正确的值列表，但我没有点击 ajax 调用的成功部分，而是点击了错误部分。我做了很多研究并遵循了几个我发现的例子，但有些地方仍然不太正确，任何帮助将不胜感激。

编辑：使用 firebug 进一步检查显示错误 500 内部服务器错误，其中指出：异常详细信息：System.InvalidOperationException：在序列化“System.Data.Entity.DynamicProxies.GameEdition”类型的对象时检测到循环引用

我有以下 jQuery / AJAX：

```
<script type="text/javascript">
$(function () {
    $("#PlatformDropDownList").change(function () {
        var gameId = '@Model.GameID';
        var platformId = $(this).val();
        // and send it as AJAX request to the newly created action 
        $.ajax({
            url: '@Url.Action("Editions")',
            type: 'GET',
            data: { gameId: gameId, platformId: platformId },
            cache: 'false',
            success: function (result) {
                $('#EditionDropDownList').empty();
                // when the AJAX succeeds refresh the ddl container with 
                // the partial HTML returned by the PopulatePurchaseGameLists controller action 
                $.each(result, function (result) {
                    $('#EditionDropDownList').append(
                        $('<option/>')
                            .attr('value', this.EditionID)
                            .text(this.EditionName)
                    );

                });
            },
            error: function (result) {
                alert('An Error has occurred');
            }
        });
    });
}); 
```

这是我的控制器方法：

```
 public JsonResult Editions(Guid platformId, Guid gameId)
  {
     //IEnumerable<GameEdition> editions = GameQuery.GetGameEditionsByGameAndGamePlatform(gameId, platformId);
     var editions = ugdb.Games.Find(gameId).GameEditions.Where(e => e.PlatformID == platformId).ToArray<GameEdition>();

     return Json(editions, JsonRequestBehavior.AllowGet);
  } 
```

这是我的网络表单html：

```
<div id="PurchaseGame">
@using (Html.BeginForm())
{
    @Html.ValidationSummary(true, "Please correct the errors and try again.")
    <div>
        <fieldset>
            <legend></legend>
            <p>Select the platform you would like to purchase the game for and the version of the game you would like to purchase.</p>

            <div class="editor-label">
                @Html.LabelFor(model => model.PlatformID, "Game Platform")
            </div>
            <div class="editor-field">
                @Html.DropDownListFor(model => model.PlatformID, new SelectList(Model.Platforms, "GamePlatformID", "GamePlatformName"), new { id = "PlatformDropDownList", name="PlatformDropDownList" })
            </div>

            <div class="editor-label">
                @Html.LabelFor(model => model.EditionID, "Game Edition")
            </div>
            <div id="EditionDropDownListContainer">
                @Html.DropDownListFor(model => model.EditionID, new SelectList(Model.Editions, "EditionID", "EditionName"), new { id = "EditionDropDownList", name = "EditionDropDownList" })
            </div>

            @Html.HiddenFor(model => model.GameID)
            @Html.HiddenFor(model => model.Platforms)

            <p>
                <input type="submit" name="submitButton" value="Purchase Game" />
                <input type="submit" name="submitButton" value="Cancel" />
            </p>

        </fieldset>
    </div>
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T06:03:50.840

您不能使用 GET 动词发送 JSON 编码请求。所以替换`type: 'GET'`为`type: 'POST'`它会起作用。此外，由于您指定了 JSON 请求，您必须发送一个 JSON 请求，该请求通过以下`JSON.stringify`函数实现：`data: JSON.stringify({ gameId: gameId, platformId: platformId }),`. 但由于您只有 2 个值，我认为使用 GET 会更容易。所以我的建议是删除`contentType: 'application/json'`参数并让您的 AJAX 请求如下所示：

```
$.ajax({
    url: '@Url.Action("Editions")',
    type: 'GET',
    data: { gameId: gameId, platformId: platformId },
    cache: 'false',
    success: function (result) {
        $('#EditionDropDownList').empty();
        // when the AJAX succeeds refresh the ddl container with 
        // the partial HTML returned by the PopulatePurchaseGameLists controller action 
        if(result.length > 0)
        {
            $.each(result, function (result) {
                $('#EditionDropDownList').append(
                    $('<option/>')
                         .attr('value', this.EditionID)
                         .text(this.EditionName)
                );
            });
        }
        else
        {
            $('#EditionDropDownList').append(
                $('<option/>')
                    .attr('value', "")
                    .text("No edition found for this game")
            );
        }

    },
    error: function () {
        alert('An Error has occured');
    }
}); 
```

同样在`DropDownListFor`Razor 标记的助手中，我注意到以下内容：

```
onchange = "Model.PlatformID = this.value;" 
```

我只能说，这并没有像你想象的那样做。

* * *

更新：

您似乎收到了循环对象引用错误，因为您将`editions`域模型传递给 Json 方法。循环引用对象层次结构不能被 JSON 序列化。此外，您不需要通过将包含在此版本中的所有废话发送给客户端来浪费带宽。您的所有客户需要的是一组 id 和名称。所以只需使用视图模型：

```
public ActionResult Editions(Guid platformId, Guid gameId)
{
    var editions = ugdb
        .Games
        .Find(gameId)
        .GameEditions
        .Where(e => e.PlatformID == platformId)
        .ToArray<GameEdition>()
        .Select(x => new 
        {
            EditionID = x.EditionID,
            EditionName = x.EditionName
        })
        .ToArray();

    return Json(editions, JsonRequestBehavior.AllowGet);
} 
```

# xslt - 在 xsl:param xsl:if 测试条件中引用属性值

> ID：11093989
> 
> 赞同：2
> 
> 时间：2012-06-19T03:27:58.403
> 
> 标签：xslt, testing, if-statement, attributes, param

我正在尝试从 xsl:param 检索属性值并在 xsl:if 测试条件中使用它。所以给定以下xml

```
<product>
  <title>The Maze / Jane Evans</title> 
</product> 
```

和 xsl

```
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>
    <xsl:strip-space elements="*"/>

<xsl:param name="test" select="Jane"/>

 <xsl:template match="title[contains(., (REFERENCE THE SELECT ATTRIBUTE IN PARAM))]">
   <h2>
    <xsl:value-of select="substring-before(., '/')"/>
   </h2>
   <p>
    <xsl:value-of select="substring-after(., '/')"/>
   </p>
 </xsl:template>

 <xsl:template match="title">
   <h2><xsl:value-of select="."/></h2>
 </xsl:template>
</xsl:stylesheet> 
```

我想回来

```
The Maze

Jane Evans 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T04:05:25.813

**你在这一行有问题**：

```
<xsl:param name="test" select="Jane"/> 
```

这定义了一个`xsl:param`named `test`，其值是当前节点 ('/') 的子元素 named `Jane`。由于顶部元素 is`<product>`和 not `<Jane>`，`test`参数具有空节点集的值（和字符串值 - 空字符串）。

**你想要**（注意周围的撇号）：

```
<xsl:param name="test" select="'Jane'"/> 
```

**整个处理任务可以相当容易地实现**：

**这个 XSLT 1.0 转换**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:param name="pTest" select="'Jane'"/>

 <xsl:template match="title">
  <xsl:choose>
    <xsl:when test="contains(., $pTest)">
       <h2>
        <xsl:value-of select="substring-before(., '/')"/>
       </h2>
       <p>
        <xsl:value-of select="substring-after(., '/')"/>
       </p>
    </xsl:when>
    <xsl:otherwise>
      <h2><xsl:value-of select="."/></h2>
    </xsl:otherwise>
  </xsl:choose>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时**：

```
<product>
    <title>The Maze / Jane Evans</title>
</product> 
```

**产生想要的正确结果**：

```
<h2>The Maze </h2>
<p> Jane Evans</p> 
```

**说明**：

XSLT 1.0 语法禁止在匹配模式中引用变量/参数。这就是为什么我们有一个匹配任何模板的单一模板`title`，并且我们在模板中指定了以特定的、想要的方式进行处理的条件。

**XSLT 2.0 解决方案**：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:param name="pTest" select="'Jane'"/>

 <xsl:template match="title[contains(., $pTest)]">
   <h2>
     <xsl:value-of select="substring-before(., '/')"/>
   </h2>
   <p>
     <xsl:value-of select="substring-after(., '/')"/>
   </p>
 </xsl:template>

 <xsl:template match="title">
   <h2><xsl:value-of select="."/></h2>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档（上图）时，同样会产生相同的正确结果**：

```
<h2>The Maze </h2>
<p> Jane Evans</p> 
```

**说明**：

XSLT 2.0 没有 XSLT 1.0 的限制，并且*可以*在匹配模式中使用变量/参数引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T03:40:28.303

术语 $test 指的是测试参数的值。使用 $test

例如：

```
 <xsl:template match="title[contains(., $test)]">
   <h2>
    <xsl:value-of select="substring-before(., '/')"/>
   </h2>
   <p>
    <xsl:value-of select="substring-after(., '/')"/>
   </p>
 </xsl:template> 
```

# cocos2d-iphone - 请帮助触摸数组中的特定精灵，它们正在丢弃代码

> ID：11093991
> 
> 赞同：0
> 
> 时间：2012-06-19T03:28:02.593
> 
> 标签：cocos2d-iphone

我尝试检测具有位置的特定精灵，当我使用“if”语句时，构建失败。

这是我的代码

```
 -(void)ccTouchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{

UITouch* myTouch = [touches anyObject];
CGPoint location = [myTouch locationInView: [myTouch view]];
location = [[CCDirector sharedDirector]convertToGL:location];

int numGrades = [grades count]; 
for (int i = 0; i < numGrades; i++) 
{
    // Put each spider at its designated position outside the screen 
    CCSprite* grade = [grades objectAtIndex:i];

int numGrades = [grades count]; 
for (int i = 0; i < numGrades; i++) 
{
    CCSprite* grade = [grades objectAtIndex:i]; 
```

// if 语句似乎不起作用...我尝试做的是如果我触摸特定的精灵.. 它应该停止移动，但它没有。

```
 if ((grade.position.x==location.x) && (grade.position.y==location.y)) 
    {

        [grade stopAllAction];

    }
}
    }

 } 
```

请更正'if'语句...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T06:34:57.053

您似乎只是想检测精灵上的触摸。您当前的相交测试要求您的触摸坐标与精灵中心点的坐标完全匹配，这实际上是不可能的..

相反，您应该尝试针对精灵的边界框测试触摸坐标。

```
if (CGRectContainsPoint(grade.boundingBox, location))     
{
    [grade stopAllActions];     
} 
```

还要注意它是带有“s”的stopAllActions ..

希望这可以帮助。

# groovy - Sonar + JaCoco 不包括涵盖的 Groovy 代码

> ID：11093995
> 
> 赞同：4
> 
> 时间：2012-06-19T03:28:24.287
> 
> 标签：groovy, sonarqube, jacoco

我有一个带有单个静态方法的 Groovy 类：

```
class ResponseUtil {
    static String FormatBigDecimalForUI (BigDecimal value){
        (value == null || value <= 0) ? '' : roundHalfEven(value)
    }
} 
```

它有一个或几个测试用例：

```
@Test
void shouldFormatValidValue () {
    assert '1.8' == ResponseUtil.FormatBigDecimalForUI(new BigDecimal(1.7992311))
    assert '0.9' == ResponseUtil.FormatBigDecimalForUI(new BigDecimal(0.872342))
}

@Test
void shouldFormatMissingValue () {
    assert '' == ResponseUtil.FormatBigDecimalForUI(null)
}

@Test
void shouldFormatInvalidValue () {
    assert '' == ResponseUtil.FormatBigDecimalForUI(new BigDecimal(0))
    assert '' == ResponseUtil.FormatBigDecimalForUI(new BigDecimal(0.0))
    assert '' == ResponseUtil.FormatBigDecimalForUI(new BigDecimal(-1.0))
} 
```

这导致`6/12`根据 Sonar/JaCoCo 覆盖的分支：

![一半的代码覆盖率](../Images/e574b7a26dc1c05cc1b2cc3971a225a0.png)

因此，我将代码更改为更...详细。我不认为原始代码“太聪明”或类似的东西，但我让它更加明确和清晰。所以，这里是：

```
static String FormatBigDecimalForUI (BigDecimal value) {
    if (value == null) {
        ''
    } else if (value <= 0) {
        ''
    } else {
        roundHalfEven(value)
    }
} 
```

现在，在没有更改任何其他内容的情况下，Sonar/JaCoCo 报告它已被完全覆盖：

![JaCoCo 100% 覆盖率](../Images/d4d2c90a533dd5d3684913a95956ccd3.png)

为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T18:13:07.513

我不知道它是否适用于您的具体示例，但请记住，代码覆盖工具通常不适用于替代 JVM 语言，除非它们明确支持它们。这是因为几乎所有这些语言都会生成额外的字节码，这些字节码只能在某些情况下执行。例如，Groovy 可能会为慢速路径和快速路径生成字节码，并且可能会自动在它们之间做出决定，而用户没有发言权。

Groovy 3.0 可能会改善这种情况，它将围绕 Java 调用动态进行设计，这意味着必须生成更少的“神奇”字节码。同时，我听说 Clover 有明确的 Groovy 支持，虽然我不知道它是最新的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-11T04:16:15.323

因此，事实证明，Sonar 的 Jacoco 插件显式查找 Java 代码。我知道这一点，因为我通过它进行了调试。它解码 jacoco exec 文件并假定任何文件都是 JavaFile，它没有找到，然后说您没有覆盖信息。

因此，我获取了 Jacoco 插件的源代码（它从他们的 Subversion 存储库中消失了，并且从未出现在我能找到的 Github 上）并将其折叠成一个新的 Groovy 插件。我更新的一个使用 Codenarc 0.18.1（它将 Narc 从 32 增加到 305）并识别任何类型的 Jacoco 文件 - 现有插件中的代码是不必要的错误。

源代码在这里：[https](https://github.com/rvowles/sonar-groovy) ://github.com/rvowles/sonar-groovy - 只需构建它并将其放在您的扩展/插件目录中。

# interface - 我从哪里学习接口原型？

> ID：11093999
> 
> 赞同：0
> 
> 时间：2012-06-19T03:28:53.687
> 
> 标签：interface, prototype, arduino, interaction-design

我对使用 arduino 板和其他东西进行原型设计和开发小工具和设备感兴趣，但是我只获得有关 arduino 的教程，而不是接口原型设计。我找到了一本书，但它是用其他语言而不是英语的（链接是：http://prototypinginterfaces.com/）

我也不知道在谷歌中寻找教程的确切术语。这可能是我没有得到合适结果的原因。基本上我想学的和书上说的一样。

我不知道从哪里开始，首先要寻找什么。如果有人可以帮助我，请。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T15:01:52.410

从软件的角度来看，我建议进入 Processing。它是 Arduino 所衍生的编程语言，同时使用这两种语言，您可以编写和构建交互式原型。O'Reilly 有一些优秀的书籍和视频课程来解决这些问题：

*   [学习处理](http://www.learningprocessing.com/)（书籍和网站）
*   [处理入门](http://shop.oreilly.com/product/0636920000570.do)
*   [Arduino 和处理串联](http://search.oreilly.com/?q=tandem&x=0&y=0)，视频系列

通过这两个参考资料，您提供的链接中的大部分内容都已涵盖。

从硬件的角度来看，您可能还喜欢以下内容：

*   让事物动起来
*   做瘦说话
*   Arduino食谱

很抱歉极度关注一家编辑部，但是，他们摇滚！好运。