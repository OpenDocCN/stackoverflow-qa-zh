# StackOverflow 问答 11398000-11398999

# jquery - Jquery 延迟加载回调

> ID：11398005
> 
> 赞同：13
> 
> 时间：2012-07-09T15:16:09.603
> 
> 标签：jquery, jquery-plugins, callback, lazy-loading, jscrollpane

我目前正在使用[Jquery Lazy Load](http://www.appelsiini.net/projects/lazyload)，我想知道是否有办法在我的容器中的所有图像结束加载时进行回调（当延迟加载使他的所有魔法都发挥作用时）。

原因是我也在使用[jScrollPane 插件](http://jscrollpane.kelvinluck.com/)，我想调用 jScrollPane 重新初始化函数。

谢谢'

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-09T15:28:38.400

查看源代码，似乎延迟加载插件`settings.load`在加载图像后调用该函数，并传递加载的图像元素和几个参数：

```
if (settings.load) {
    var elements_left = elements.length;
    settings.load.call(self, elements_left, settings);
} 
```

因此，您可能只需要设置如下内容：

```
function yourhandler(element, el_left, settings) {
    //Whatever you want
    //This function will be called each time that an image (element in this case) is loaded
}
$("img.lazy").lazyload({ 
    load : yourhandler
}); 
```

如果要确保图像已加载，可以将侦听器附加到加载的图像：

```
function yourhandler(element, el_left, settings) {
    element.load(function() {  
        alert('Image Loaded');  
    });
} 
```

## 编辑

尝试代码后，最“干净”的方法是附加到`.load`图像的方法：

```
$('img.lazy').load(function() {
    console.log($(this).attr('src') + ' loaded');
});

$('img.lazy').lazyload({
    container:$('.p_content'),
});​ 
```

[http://jsfiddle.net/eRyww/72/](http://jsfiddle.net/eRyww/72/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T08:38:15.023

为了处理最后加载的图像并仅在完成时运行代码（所有图像已加载），您必须使用处理函数，正如 VAShhh 之前所说的，不像函数调用应该只发送 2 个参数，因此调用此函数带有javascript调用语句。

然后您将能够成功检索“ **elements_left** ”参数并将其与 0（零）进行比较：最后加载的图像左侧。像这样的东西：

```
function yourhandler(elements_left, settings) {
    var imageNode, container;
    if(elements_left === 0) {
       // All images were loaded.
       // Now do whatever you need with imageNode or its parents (container, etc) in order
       // to run any other Plugin
       imageNode = $(this);
       container = settings.container;
       alert('Ready to continue! Image node is $(this) and container settings.container');
    }
} 
```

请在以下位置查看此示例：[jsfiddle.net/eRyww/4](http://jsfiddle.net/eRyww/4)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T21:43:33.490

作为替代答案，我创建了一个“延迟加载”插件来做到这一点。它在所有元素加载后提供回调。它有点不同，不仅适用于图像，而且任何时候选定的元素都会出现在浏览器视图窗格中。

[https://github.com/shrimpwagon/jquery-lazyloadanything](https://github.com/shrimpwagon/jquery-lazyloadanything)

# .htaccess - 如何 301 重定向页面“向上”页面

> ID：11398016
> 
> 赞同：1
> 
> 时间：2012-07-09T15:16:52.653
> 
> 标签：.htaccess, redirect, http-status-code-301

我是新手，我正在尝试为以下页面找出正确的 301 重定向。我希望我在这里很清楚:) 在我的 .htaccess 文件中，我想将页面“向上”重定向一页，而不必单独处理每一页。

我的原始页面如下所示：

```
www.doctors.com/skin/california/best-skin-doctors-california/
www.doctors.com/skin/california/best-skin-doctors-california/?page=1
www.doctors.com/skin/california/best-skin-doctors-california/?page=2 
```

....ETC。....最多喜欢 /?page=33

以及更多类别和状态，例如：

```
 www.doctors.com/heart/new-york/best-heart-doctors-new-york/
 www.doctors.com/heart/new-york/best-heart-doctors-new-york/?page=1
 www.doctors.com/heart/new-york/best-heart-doctors-new-york/?page=2 
```

...ETC。.....再次喜欢 /?page=24

从那以后，我更改了页面结构以消除长 URL……像这样：

```
www.doctors.com/skin/california/
www.doctors.com/skin/california/?page=1
www.doctors.com/skin/california/?page=2 
```

等等……和类似的……

```
 www.doctors.com/heart/new-york/
 www.doctors.com/heart/new-york/?page=1
 www.doctors.com/heart/new-york/?page=2 
```

等等

如何将具有长 URL 的原始页面“批量”重定向到我的 .htaccess 文件中较新的缩短版本？非常感谢您的时间和考虑！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:26:58.120

使用 mod_alias，您可以简单地将其添加到文档根目录的 .htaccess 文件中：

```
RedirectMatch 301 ^/([a-z\-]+)/([a-z\-]+)/[a-z\-]+/$ /$1/$2/ 
```

但是，如果您需要对重定向的工作方式进行进一步限制，您可以使用[Apache 的 mod_rewrite](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)模块。查看`RewriteCond`指令，您可以对规则施加条件并将所有内容放在 .htaccess 中。主要规则看起来与 mod_alias' 非常相似`RedirectMatch`。例子：

```
RewriteRule ^([a-z\-]+)/([a-z\-]+)/[a-z\-]+/$ /$1/$2/ [R=301,L] 
```

在这两种情况下，查询字符串（page=3 部分）只是简单地附加到新目标。查看[您可以做的不同事情`RewriteCond`](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewritecond)`/images/`，比如当您请求类似or时，如果您想排除此规则`/themes/`：

```
RewriteCond %{REQUEST_URI} !^/images/
RewriteCond %{REQUEST_URI} !^/themes/
RewriteRule ^([a-z\-]+)/([a-z\-]+)/[a-z\-]+/$ /$1/$2/ [R=301,L] 
```

So, if the request doesn't start with `/images/` **and** the request doesn't start with `/themes/`, then apply the rule. This example would make it so a request for [http://host.com/themes/subSilver/magic-icons/](http://host.com/themes/subSilver/magic-icons/) don't get redirected to [http://host.com/themes/subSilver/](http://host.com/themes/subSilver/).

# jenkins - 你可以在 Jenkins 中为每个项目设置不同的 XCode Builder 设置吗？

> ID：11398018
> 
> 赞同：0
> 
> 时间：2012-07-09T15:16:54.317
> 
> 标签：jenkins

我是 Jenkins CI 的新手，但到目前为止我很喜欢。不过，我遇到了一个严重的问题。XCode Builder 设置是全局设置。我有不同的项目需要不同版本的 xcodebuild。有没有办法在每个项目的基础上定义这些？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T10:10:56.827

似乎有一种方法可以使用**xcrun**和**xcode-select**来做到这一点。

运行`man xcrun`并`man xcode-select`了解详细信息。

您可能需要安装*xcode 命令行包*才能查看这些命令。

# json - JSON返回格式cordys BOP

> ID：11398022
> 
> 赞同：0
> 
> 时间：2012-07-09T15:17:24.057
> 
> 标签：json, xml, web-services, cordys-opentext

我正在使用 Cordys BOP，并且我有一个返回 JSON 格式的 REST Web 服务。我有一个我使用的测试服务，它返回 XML 并且工作正常，所以我知道我的 HTTP 连接器工作正常。当我尝试使用测试 Web 服务操作 UI 测试我的 JSON 服务时，我收到一条错误消息`Invalid XML response`。

如何告诉 Cordys 期待 JSON 响应而不是 XML？

有没有办法通过 Cordys 以某种方式将 JSON 包装在 XML 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T15:20:32.083

您可能需要更改标题：

```
 Content-type: application/json 
```

# .net - 使用 Resharper 移动资源

> ID：11398025
> 
> 赞同：2
> 
> 时间：2012-07-09T15:17:37.127
> 
> 标签：.net, visual-studio-2010, visual-studio, resharper

我想使用 Resharper 的“移动资源”重构，但我不太明白。我打开一个 .resx 文件（f7 查看代码），打开文件结构窗口，选择一些资源，单击“移动资源”，然后指定一个已经存在的目标资源文件。它想了想，要求我删除原始的 resx 文件，但没有将它们移动到任何地方（它只是删除它们）。

我做错了吗？有没有人成功使用过这个工具？

# image - 如何在 html5 websql 数据库中保存和获取图像？

> ID：11398026
> 
> 赞同：0
> 
> 时间：2012-07-09T15:17:38.717
> 
> 标签：image, html

任何人都可以请帮助我如何在 html5 websql 数据库中保存和获取图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T15:33:02.847

创建一个[数据 URI](http://en.wikipedia.org/wiki/Data_URI_scheme)来存储和加载您的图像。

请参阅以下解释如何提取数据 URI的[Stack Overflow 问题。](https://stackoverflow.com/questions/934012/get-image-data-in-javascript)

# c# - Entity Framework 4.3 访问抽象类集合抛出 ArgumentNull 异常

> ID：11398027
> 
> 赞同：1
> 
> 时间：2012-07-09T15:17:42.637
> 
> 标签：c#, entity-framework

我首先使用实体​​框架 4.3 代码来持久化域模型。领域模型由抽象类和具体类组成。当实体框架返回的具体类首次尝试访问基类中的对象集合时，我看到抛出 ArgumentNullException。

例如，域模型由抽象类组成

```
public abstract class Foo
{
    public int Id { get; set; }
    public string Name { get; set; }
    public virtual ICollection<Attibute> attributes { get; set; }

    public string DoSomething()
    {
        return "I'm all fooey";
    }
}

public abstract class Attibute
{
    public int Id { get; set; }
    public string Name { get; set; }
    public virtual ICollection<Foo> Foos { get; set; }
} 
```

然后我有派生类

```
public class BadFoo : Foo
{
    public List<BadAttribute> BadAttribs()
    {
        return base.attributes.OfType<BadAttribute>().ToList<BadAttribute>();
    }

    public void BeBad()
    {
        foreach (var a in BadAttribs())
            Console.WriteLine(Name + ": Being bad => " + a.DoingBad());
    }
}

public class GoodFoo : Foo
{
    public List<GoodAttribute> GoodAttribs()
    {
        return base.attributes.OfType<GoodAttribute>().ToList<GoodAttribute>();
    }

    public void BeGood()
    {
       foreach (var a in GoodAttribs())
            Console.WriteLine(Name + ": Being good => " + a.DoingGood());
    }
}

public class BadAttribute : Attibute
{
    public string DoingBad()
    {
        return Name + " : Start being bad";
    }
}

public class GoodAttribute : Attibute
{
    public string DoingGood()
    {
        return Name + " : Start being Good";
    }
}

public class AppearenceAttribute : Attibute
{
    public string Doing()
    {
        return Name + " : defining ones appearance";
    }
} 
```

然后我设置我的数据库上下文如下：

```
public class EFDbContext : DbContext
{
    public DbSet<Foo> Foos { get; set; }
    public DbSet<Attibute> Attributes { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        base.OnModelCreating(modelBuilder);
    }
}

public class EFDbContextInitializer : DropCreateDatabaseAlways<EFDbContext> 
{
    protected override void Seed(EFDbContext context)
    {
        List<Attibute> attribs = new List<Attibute>
            {
                new BadAttribute { Name = "Gluttony" },
                new BadAttribute { Name = "Greed" },
                new GoodAttribute { Name = "Honesty" },
                new GoodAttribute { Name = "Humility" },
                new AppearenceAttribute { Name = "Colour" }
            };
        attribs.ForEach(a => context.Attributes.Add(a));
        context.SaveChanges();

        BadFoo badOne = new BadFoo { Name = "badOne", attributes = new List<Attibute>)};

        context.Attributes.OfType<BadAttribute>().ToList().ForEach(a => badOne.attributes.Add(a));
        context.Attributes.OfType<AppearenceAttribute>().ToList().ForEach(a => badOne.attributes.Add(a));

        context.Foos.Add(badOne);
        context.SaveChanges();

        GoodFoo goodOne = new GoodFoo { Name = "GoodOne", attributes = new List<Attibute>() };

        context.Attributes.OfType<GoodAttribute>().ToList().ForEach(a => goodOne.attributes.Add(a));
        context.Attributes.OfType<AppearenceAttribute>().ToList().ForEach(a => goodOne.attributes.Add(a));

        context.Foos.Add(goodOne);
        context.SaveChanges();

        base.Seed(context);
    }
} 
```

然后我使用我的模型如下：

```
 Database.SetInitializer<EFDbContext>(new EFDbContextInitializer());

        EFDbContext context = new EFDbContext();

        var foos = context.Foos.OfType<BadFoo>().ToList();
        foreach (var f in foos)
            f.BeBad();

        var foos2 = context.Foos.OfType<GoodFoo>().ToList();
        foreach (var f in foos2)
            f.BeGood();

        Console.ReadKey(); 
```

当派生自 Foo 的具体类首次尝试使用 Foo 基类中的集合时，将引发异常。在这种情况下，BadFoo 实例第一次调用 BeBad() 方法。

我不确定是否是因为 EF 延迟加载集合，C# 处理抽象/具体类的方式或域模型只是让任何人愿意解释/启发我解决问题？

作为旁注，如果我将派生属性类 BadFoo 和 GoodFoo 中访问基属性的方式替换为返回基类集合属性的类型过滤列表的属性，例如：

```
public class GoodFoo : Foo
{
    public List<GoodAttribute> GoodAttribs()
    {
        return base.attributes.OfType<GoodAttribute>().ToList<GoodAttribute>();
    }
} 
```

EF 在表中添加了一个 _Id 列，这是为什么呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-21T08:52:55.113

EF 代码首先根据配置和上下文定义构建 db 模型元数据。您已将 EF 设置为使用抽象 Foo 和 Attribute 类作为实体。所以它试图使用它。

```
public class EFDbContext : DbContext
{
    public DbSet<Foo> Foos { get; set; }
    public DbSet<Attibute> Attributes { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        base.OnModelCreating(modelBuilder);
    }
} 
```

它对您的后代类一无所知，也不知道如何映射它们。在我看来，您不能将抽象类用作实体，因为它没有任何意义。

在任何情况下，您的 Foo 和 Attibute 类本质上都不是抽象类。他们没有任何抽象方法。我建议您阅读更多关于 C# 中的抽象类或抽象关键字的信息。

# c++ - PPL - 许可证和链接信息

> ID：11398029
> 
> 赞同：1
> 
> 时间：2012-07-09T15:17:44.627
> 
> 标签：c++, multithreading, visual-studio-2010, parallel-processing, ppl

我想将 PPL 与编译器 VS2010 一起使用。PPL 的许可证状态是什么？可以在商业软件中自由使用吗，能否指点一下相关文档？它如何进行适当的编译或它是如何工作的？我是否必须下载单独的库，或勾选编译器选项...？

谢谢并恭祝安康

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:25:52.897

[PPL](http://msdn.microsoft.com/en-us/library/dd492418.aspx)内置于 Microsoft 库中，并包含在 VS 2010 的编译器和库堆栈中。您可以按照与编译器中包含的其他 MS 库相同的条款在商业软件中使用它（有关详细信息，请参阅 ..\Microsoft Visual Studio 10.0\ 文件夹中的 Redist.txt）。

> 它如何进行适当的编译或它是如何工作的？要了解它是如何工作的，请参阅[相关文档](http://msdn.microsoft.com/en-us/library/dd492418.aspx)。

# jsf-2 - 覆盖 JSF 的默认 I18N 处理

> ID：11398032
> 
> 赞同：0
> 
> 时间：2012-07-09T15:17:56.110
> 
> 标签：jsf-2, internationalization, resourcebundle

就像这里的提问者一样

[变量替换 JSF Resource Bundle 属性文件](https://stackoverflow.com/questions/8139250/variable-substitution-jsf-resource-bundle-property-file)

我对无法引用消息包中其他属性键的值感到有些震惊。

尽管我看到编写自己的垃圾处理程序 [0] 是多么容易，它可以在自定义组件中执行我想要的操作，但这会使调用消息包的模板中的表达式仍然使用默认的 JSF 实现。

是否可以覆盖消息包的默认 JSF 处理？

[0] 或者更好的是，使用上述问题的答案之一中引用的代码 [https://code.google.com/p/reflectiveresourcebundle/](https://code.google.com/p/reflectiveresourcebundle/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:21:32.150

您可以提供具体`ResourceBundle`实现的完全限定名称作为“基本名称”，而不是单独提供属性文件的路径和文件名。

例如

```
public class YourCustomResourceBundle extends ResourceBundle {
    // ...
} 
```

可以注册如下

```
<application>
    <resource-bundle>
        <base-name>com.example.YourCustomResourceBundle</base-name>
        <var>text</var>
    </resource-bundle>
</application> 
```

或按视图/模板声明如下

```
<f:loadBundle baseName="com.example.YourCustomResourceBundle" var="text" /> 
```

以下是几个相关的问题/答案，其中包含一些可以用作启动示例的具体代码：

*   [怎么去掉周围？？？当在捆绑包中找不到消息时](https://stackoverflow.com/questions/6451215/jsf-how-to-remove-the-surrounding-if-message-not-found-in-messagebundle)
*   [使用从数据库加载的 ResourceBundle 条目在 JSF 中进行国际化](https://stackoverflow.com/questions/4499732/design-question-regarding-java-ee-entity-with-multiple-language-support)
*   [JSF 2.0 应用程序中带有 UTF-8 编码的属性文件的 i18n](https://stackoverflow.com/questions/3645491/i18n-with-utf-8-encoded-properties-files-in-jsf-2-0-appliaction)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:02:17.640

对于那些尝试的人来说，一切皆有可能。问题不是它是否可能，而是你是否应该这样做。这个问题的答案是：可能不会。

在消息包中引用其他消息意味着您要构建复合消息。因此，您可以多次重复使用部分消息，以节省一小部分磁盘空间或一小部分开发时间。
如果是这样的话，我有一条消息给你。您计划执行的操作称为**串联**，它是第二常见的 I18n 缺陷。它的影响与硬编码字符串一样糟糕。

为什么？因为目标语言不遵循英语语法规则。首先，翻译时通常需要重新排序句子。这可能很容易通过使用（编号或命名）占位符来解决。但另一方面，翻译**可能会因**上下文而异。也就是说，它可能需要完全以其他方式翻译，或者只是词尾可能需要根据语法情况、情绪或性别而有所不同。

我的建议是，不要使用这样的快捷方式，它会产生比修复更多的问题。
现在你应该知道为什么“那些愚蠢的罗马人”没有这样实现它：它违反了 I18n 的最佳实践。

# c# - 如何在Windows窗体的负象限中绘制矩形c#

> ID：11398037
> 
> 赞同：-2
> 
> 时间：2012-07-09T15:18:13.570
> 
> 标签：c#, graphics, system.drawing

我想在负象限（原点的左侧和顶部）绘制矩形......请帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:22:22.803

只需对 X 和 Y 位置使用负数。

```
Graphics.DrawRectangle(Pens.Black, -100, -100, 100, 100); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T15:25:35.413

```
Rectangle original = new Rectangle(10,10,50,50);
Rectangle negative = new Rectangle(original.Location.X - (original.Width * 2), original.Location.Y - (original.Height * 2), original.Width, original.Height); 
```

# objective-c - 使用 iOS 打印到 Google 云打印

> ID：11398044
> 
> 赞同：2
> 
> 时间：2012-07-09T15:18:44.050
> 
> 标签：objective-c, ios, ipad, printing

我一直在尝试使用以下代码将 PDF 文件打印到 Google 云打印。它不是实际打印文档，而是仅打印一个显示文件位置和文件名的字符串。我想让它打印实际的文档。

我们可以假设传递给此方法的数据是有效的，因为它似乎从调用云打印/搜索中找到了正确的打印机

**更新：代码从其原始格式更新为包含一些多部分表单数据**

```
 NSString *currentPDFFileName = [[NSBundle mainBundle] pathForResource:@"TestPDF" ofType:@"pdf"];
    NSData *pdfData = [NSData dataWithContentsOfFile:currentPDFFileName];
    NSData *validPDF = [[NSString stringWithString:@"%PDF"] dataUsingEncoding: NSASCIIStringEncoding];
    if (!(pdfData && [[pdfData subdataWithRange:NSMakeRange(0, 4)] isEqualToData:validPDF])) 
    {
        NSLog (@"Not valid");
    }

    NSLog (@"%@", currentPDFFileName);
    NSLog (@"%@", [currentPDFFileName lastPathComponent]);

    //create the body
    NSMutableData *body = [NSMutableData data];

    //create the POST vars
    NSString *thePrinter = [NSString stringWithFormat:@"Content-Disposition: form-data; name=\"printerid\"\r\n\r\n%@", printerID];
    NSString *pdf = [NSString stringWithFormat:@"Content-Disposition: form-data; name=\"content\"; filename=\"%@\"\r\n", [currentPDFFileName lastPathComponent]];
    NSString *theContent = [NSString stringWithFormat:@"Content-Disposition: form-data; name=\"contentType\"\r\n\r\n%@", contentType];

    [body appendData:[[NSString stringWithFormat:@"--%@\r\n", @"----foo"] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[thePrinter dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n", @"----foo"] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[pdf dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n", @"----foo"] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[theContent dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n", @"----foo"] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[@"Content-Type: application/pdf\r\n\r\n" dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:pdfData];
    [body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n", @"----foo"] dataUsingEncoding:NSUTF8StringEncoding]];

    NSMutableURLRequest *pdfRequest = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:@"https://www.google.com/cloudprint/submit"]];
    [pdfRequest setValue:@"multipart/form-data; boundary=----foo" forHTTPHeaderField:@"Content-type"];
    [pdfRequest setHTTPMethod:@"POST"];
    [pdfRequest setHTTPBody:body];

    [self.authenticate authorizeRequest:pdfRequest completionHandler:^(NSError *error) {
        NSString *output = nil;
        if(error) {
            output = [error description];
        } else {
            NSURLResponse *response = nil;
            NSData *data = [NSURLConnection sendSynchronousRequest:pdfRequest
                                                 returningResponse:&response
                                                             error:&error];
            if(data) {
                output = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
            } else {
                output = [error description];
            }
        }

        NSLog(@"%@", output);
    }]; 
```

# c++ - filesystem::path 构造函数调用失败

> ID：11398045
> 
> 赞同：1
> 
> 时间：2012-07-09T15:18:44.100
> 
> 标签：c++, boost

此代码无法编译，使用 Boost 1.48 和 GCC：

```
// const char* left, const char* right

boost::filesystem::path p =  boost::filesystem::absolute( 
   boost::filesystem::path(right, boost::filesystem::native),     // line 314
   boost::filesystem::path(left, boost::filesystem::native) );    // line 315 
```

错误信息：

```
LoggerImplementation.cpp|314|error: invalid conversion from ‘bool (*)(const std::string&)’ to ‘void*’
LoggerImplementation.cpp|314|error:   initializing argument 2 of ‘boost::filesystem3::path::path(const Source&, typename boost::enable_if<boost::filesystem3::path_traits::is_pathable<typename boost::decay<Source>::type>, void>::type*) [with Source = const char*]’
LoggerImplementation.cpp|315|error: invalid conversion from ‘bool (*)(const std::string&)’ to ‘void*’
LoggerImplementation.cpp|315|error:   initializing argument 2 of ‘boost::filesystem3::path::path(const Source&, typename boost::enable_if<boost::filesystem3::path_traits::is_pathable<typename boost::decay<Source>::type>, void>::type*) [with Source = const char*]’ 
```

在 MSVC 下它编译。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:26:58.420

您的第二个论点 ( `boost::filesystem::native`) 是错误的。`boost::filesystem::path`根本[没有构造函数](http://www.boost.org/doc/libs/1_50_0/libs/filesystem/doc/reference.html#path-constructors)来接受这个参数——把它关掉，代码就可以编译了。

事实上，`boost::filesystem::native`是一个*函数*，以你尝试的方式使用它是没有意义的。此外，如果 MSVC 编译此代码，这是一个明确的错误（它使用从函数指针到 的隐式转换，`void*`根据标准不存在）。

# mysql - 带有可过滤标签的图像数据库

> ID：11398051
> 
> 赞同：1
> 
> 时间：2012-07-09T15:19:04.393
> 
> 标签：mysql, sql, image

我目前有超过 2000 张图像需要添加到数据库中，以及与每个图像关联的标签，然后能够根据从一系列下拉框中匹配的标签将图像拉到网页上

目前他们在一个 zenphoto 画廊，但我正在考虑从头开始做这件事，因为它不能做我需要的事情。

谁能帮助我应该从哪里开始？或者有一些类似的例子，我可以看看

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:52:02.353

一个相对简单的标记起始模式如下所示：

```
image
========
id  -- identity, autoincrement
location  -- varchar(250), or however long (url)
title  -- varchar(50)

tag
========
id  -- identity, autoincrement
name  -- varchar(50)
description  -- varchar(250)

image_tag
=========
imageId  -- fk to image.id
tagId  -- fk to tag.id 
```

元组 ( `imageId`, `tagId`) 应该是唯一的。

如果您想处理国际化标签，请改用下表：

```
language
==========
id  -- identity, autoincrement
ISO3  -- Standard ISO 3-character code 
language  -- Standard ISO name of the language (which may all be in english...)

tag
======
id  -- identity, autoincrement
name  -- varchar(50) - it's debatable whether tag names should be
                     - translated, or left in the originating language

internationalized_tag
=======================
tagId  -- fk reference to tag.id
languageId  -- fk reference to language.id
name  -- varchar(50) - see tag.name
description  -- varchar(250) - translated description text. 
```

显然你可以在这里做更多的事情，但这应该让你开始。

# google-chrome-extension - Chrome 外部扩展未显示在扩展列表中

> ID：11398055
> 
> 赞同：1
> 
> 时间：2012-07-09T15:19:10.700
> 
> 标签：google-chrome-extension, registry, setup-project

我正在尝试使用 Visual Studio 安装项目安装 Chrome 外部扩展，并按照[http://code.google.com/chrome/extensions/external_extensions.html#registry](http://code.google.com/chrome/extensions/external_extensions.html#registry)中列出的说明，我做了以下添加外部谷歌浏览器的扩展：

1.  打包扩展并将生成的 .crx 文件移动到文件夹 C:\Hafez\Grid_Bootstrapper
2.  我在以下路径下添加了一个名为 fnfnbeppfinmnjnjhedifcfllpcfgeea 的注册表子项： HKEY_LOCAL_MACHINE\SOFTWARE\Google\Chrome\Extensions\ 以及接下来的两个值：

    *   **1.**值为“C:\Hafez\Grid_Bootstrapper\fnfnbeppfinmnjnjhedifcfllpcfgeea.crx”的路径和
    *   **2.version**值为“1.0.0.1”

    顺便说一下，这是确切的值，但不幸的是，当我启动 Chrome 时，扩展名没有列出。

顺便说一句，我在安装程序自定义操作中执行此操作，它完全按照我想要的方式写入值。

我找不到问题所在，因为我执行了链接中列出的确切步骤。你能发现我做错了什么吗？

# javascript - 检查是否使用 jQuery/JavaScript 在 DOM 中加载了特定对象？

> ID：11398056
> 
> 赞同：1
> 
> 时间：2012-07-09T15:19:11.277
> 
> 标签：javascript, jquery, class, dom

我不想知道一个元素是否包含特定的类，而只是想知道它是否在*DOM*中加载：

```
$(myObject).attr("class").length; 
```

或者

```
if($t.classList.length) {
     var classSUP = $t.attr("class");
   } else {
     var classSUP = $t.attr("id");
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:27:15.883

或者只是怎么样

```
(myObject.className != '') 
```

或者，只是为了确定可能的额外空间

```
(myObject.className.replace(' ', '') != '') 
```

这不是框架的工作；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T15:21:10.513

最简单的检查方法是：

```
if($("element").attr("class")) {
   return true;
} 
```

此处显示的示例：http: [//jsfiddle.net/Skooljester/XpUJA/](http://jsfiddle.net/Skooljester/XpUJA/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T15:21:12.177

尝试这个：

```
var containsClass = $t.attr("class") !== "" && $t.attr("class") !== undefined; 
```

这是一个函数：

```
function containsClass($t)
{
     return $t.attr("class") !== "" && $t.attr("class") !== undefined;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-09T15:33:43.727

您不需要 jQuery 来执行此操作：

```
if (element.className) {
    // element has a class
} 
```

或者，如果你真的想使用 jQuery：

```
if ($('#elementID').attr('class')) {
    // element has a class
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-12T07:54:39.143

检测 DOM 中是否加载了特定对象的最简单方法是：

```
if ( $('.className').length ) {
     alert('.className is on DOM')
} 
```

# xml - 哪种技术：PhoneGap、xml 中的大数据和快速搜索？

> ID：11398057
> 
> 赞同：0
> 
> 时间：2012-07-09T15:19:12.350
> 
> 标签：xml, cordova

如果有人能给我建议我应该使用哪些技术，我会很高兴：

*   我想使用 PhoneGap 构建一个应用程序
*   我在深度结构化的 xml 中获得了大量数据（大约 100 MB）
*   我想对这些数据进行非常快速的搜索

到目前为止，我对解决方案的想法：

*   我可以通过 jQuery 进行搜索（但我认为这会很慢）
*   我可以将数据打包到 SQlite-DB 中（如何？？）
*   或者我可以通过 SQlite 建立一个索引并将数据集留在 xml 文件中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:34:10.730

我不知道您的数据是如何结构化的，但您可能最好将 XML 文档转换为多个数据库表并将其全部存储在可以与应用程序一起部署的预填充 SQLite DB 中。

我无法想象您的移动应用程序能够有效地解析 100 mb 的 XML 文档而不会出现内存不足错误。

# emacs - 是否可以根据上下文更改 emacs 语法表？

> ID：11398058
> 
> 赞同：3
> 
> 时间：2012-07-09T15:19:13.707
> 
> 标签：emacs, elisp, major-mode, font-lock-mode

我正在努力改进[UnrealScript](http://udn.epicgames.com/Three/UnrealScriptReference.html)的 emacs 主要模式。（许多）怪癖之一是它允许使用这样的语法在虚幻编辑器中指定工具提示：

```
var() int MyEditorVar <Foo=Bar|Tooltip=My tooltip text isn't quoted>; 
```

变量声明后的尖括号表示以管道分隔的 Key=Value 元数据对列表，元数据不加引号但可以包含引号——管道 ( `|`) 或右尖括号 ( `>`) 表示结束。

有没有办法让emacs语法表以一种有用的方式识别这种上下文相关的语法？我希望在这些变量元数据声明中以某种方式突出显示除了管道和直角括号之外的所有内容，但保留它们的正常突出显示。

现在，单引号字符被设置为引号分隔符（语法指示符`"`），因此 font-lock-mode 将这样的引号解释为开始一个带引号的字符串，它不在这个非常具体的实例中，所以它会错误地突出显示所有内容，直到它找到另一个据称匹配的单引号。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T19:56:10.610

您需要设置一个`syntax-propertize-function`允许您将不同的语法指示符应用于缓冲区中的不同字符，具体取决于它们的上下文。

Grep for`syntax-propertize-function`在 Emacs 的 lisp 目录中查看各种示例（从简单到非常复杂的示例）。

您可能希望将“Foo”和“Tooltip”之后的“=”字符标记为“通用字符串分隔符”，然后对相应的终止符“|”执行相同操作 和“>”。另一种方法是将“>”之前的字符标记为（关闭）通用字符串分隔符，这样您就可以将“<”和“>”标记为打开和关闭括号。

# java - 检测显示器是否旋转

> ID：11398059
> 
> 赞同：4
> 
> 时间：2012-07-09T15:19:18.593
> 
> 标签：java, swing, multiple-monitors

我在 JavaSE 中有一个应用程序，我希望我的应用程序始终从屏幕中心开始。如果插入了两台显示器，则应使用正确的一台。所以我写了这样的代码：

```
GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
if(ge.getScreenDevices().length == 2) {
    int w_1 = ge.getScreenDevices()[0].getDisplayMode().getWidth();
    int h_1 = ge.getScreenDevices()[0].getDisplayMode().getHeight();
    int w_2 = ge.getScreenDevices()[1].getDisplayMode().getWidth();
    int h_2 = ge.getScreenDevices()[1].getDisplayMode().getHeight();

    int x = w_1 + w_2  / 2 - getWidth() / 2;
    int y = h_2 / 2 - getHeight() / 2;

    setLocation(x, y);
} 
```

不幸的是，如果显示器旋转 90°，宽度和高度应该翻转。有没有办法检测这种旋转？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T22:02:31.850

您不需要知道第二台显示器是否处于纵向模式。只需在设备坐标中找到屏幕的边界并使用中心即可。（如果它处于纵向模式，则高度>宽度，但这不是重要的信息。）

您确定第二个设备中心点的公式是错误的。您假设第二个屏幕的坐标从 (w_1,0) 运行到 (w_1 + w_2, h_2)，但这不一定是正确的。您需要找到第二个屏幕的 GraphicsConfiguration 对象并在其上调用[GraphicsConfiguration.getBounds()](http://docs.oracle.com/javase/7/docs/api/java/awt/GraphicsConfiguration.html#getBounds%28%29)。然后，您可以计算该矩形的中心点。

如果您想知道哪个设备在左侧或右侧（或顶部或底部），您可以比较它们的边界矩形的 x（或 y）值。请注意，x 或 y 值可能为负数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T15:47:17.967

您应该考虑高度是否大于宽度（纵向）。不过，我还没有听说有人使用肖像监视器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-20T14:51:33.700

这是在大多数情况下都能正常工作的代码（来自 Enwired 的回答）。

```
GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
if(ge.getScreenDevices().length == 2) {
    int x = (int)ge.getScreenDevices()[1].getDefaultConfiguration().getBounds().getCenterX() - frame.getWidth() / 2;
    int y = (int)ge.getScreenDevices()[1].getDefaultConfiguration().getBounds().getCenterY() - frame.getHeight() / 2;
    setLocation(x, y);
} 
```

唯一的问题是设备索引并不总是 0 - 左，1 - 右。

# javascript - 三星 Bada IDE 中的小设备列表

> ID：11398060
> 
> 赞同：0
> 
> 时间：2012-07-09T15:19:20.837
> 
> 标签：javascript, bada, samsung-mobile

我正在尝试在三星 Bada 平台上编写应用程序。我想让这个应用程序在不同的屏幕尺寸上可用，这里有这个问题......

我必须让它在移动设备上运行，例如：Wave 3 GT-8600 (480x800)、Wave Y GT-S5380 (320x480) 和 Wave 578 GT-S5780 (240x400)。

据我了解，我们必须将我们需要的设备添加到“设备列表”到 bada IDE 中的小部件中。在该列表中，我们可以看到不同的手机型号......我正在寻找 Wave 型号（在底部），所以我会选择它，但我正在寻找不同的屏幕尺寸......我别无选择。也许我在 bad ide 中丢失了一些重要的东西？

比我访问[bada 开发者网站](http://developer.bada.com/support/faq)并看到 3 种类型的文件：HVGA、WQVGA、WVGA - 这些文件适用于各种屏幕尺寸，对吧？

我把它们放在“bada\2.0.5\Model”文件夹中，但这对我也没有帮助..在设备列表中仍然没有更多设备。

有人知道如何将更多设备添加到设备列表中，或者如何使能够在该列表中选择屏幕尺寸，或者..也许是另一种为不同屏幕尺寸创建一个小部件的方法？

哦，是的..我的问题是：不同屏幕尺寸上小部件的高度和宽度。我们可以在小部件根文件夹的 project.xml 文件中设置此属性。目前，我对所有屏幕尺寸（从 240x400 到 480x800）都有相同的小部件属性。我为小部件设置了 220width x 130height，在小屏幕 (240x400) 和中 (320x480) 屏幕上一切正常，但在大屏幕 (480x800) 中，如果您以正确的角度移动它，小部件可以脱离屏幕。此外，我们不能将 WIDGET 的大小设置为大于 SCREEN 大小，因为安装小部件后，当我只需要小部件时，它会自动成为应用程序（一些 bada 魔法）。

这就是为什么我正在寻找为不同屏幕尺寸设置不同“project.xml”文件的可能性。

![在此处输入图像描述](../Images/b67e8f6591627a6398e9dd317b2db2f2.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T19:07:18.257

如果你的目标是 bada 2.0，你可以做一个独立于分辨率的应用程序，系统会根据当前手机的规格自动提取正确的资源文件。您将获得一个始终为 480*逻辑*像素宽的抽象显示表面，缩放到物理像素是在内部完成的。

出于开发目的，目前只有三种 bada 设备类型 - WQVGA (240x320)、HVGA (320x480)、WVGA (480x800)。这些是分辨率，而不是屏幕尺寸。屏幕尺寸大致相同，大约 4 英寸。

# c# - 您可以缓存已编译的代码以针对不同的 Session/hostObject 执行吗？

> ID：11398063
> 
> 赞同：3
> 
> 时间：2012-07-09T15:19:37.167
> 
> 标签：c#, roslyn

我们目前使用 IronPython 作为脚本语言，以允许我们的业务用户配置大部分应用程序，并且我们正在评估在 Roslyn 发布后添加 C# 作为脚本语言的可能性。对于 IronPython，我们使用`Microsoft.Scripting.Hosting.CompiledCode`缓存编译的代码并针对不同的`ScriptScope`对象执行它。

环顾最新的 Rosyln CTP，我没有看到一种明显的方法来编译代码，然后针对不同的`Sessions`或`hostObjects`. 这个功能目前是否可用，如果没有，它会在发布时可用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T17:12:16.450

我们目前正在考虑使用 Roslyn 脚本 API 支持相同的场景，即编译代码，以便您可以针对不同的范围独立执行它。它可能会与 DLR 托管 API 有所不同，并且在我们发货时，计划可能会完全改变。我应该发布我更新的脚本规范。我还没有这样做，因为我们没有在 CTP2 的交互/脚本领域做太多工作，主要关注编译器 API。关于您的问题，我们已经勾勒出我们正在考虑的方向。我今天会尝试这样做，所以在 Roslyn 论坛上，查看论坛顶部的置顶帖子，我将通过更新规范的链接对其进行更新。

谢谢，比尔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T15:44:04.463

我对 Roslyn 了解不多，但看起来这会完成你所追求的。[加载由 Roslyn 编译器生成的程序集](https://stackoverflow.com/questions/10751079/loading-an-assembly-generated-by-the-roslyn-compiler)

# java - Q工作不成功mahout ssvd

> ID：11398067
> 
> 赞同：0
> 
> 时间：2012-07-09T15:19:46.363
> 
> 标签：java, mahout, decomposition, singular

我正在尝试在 mahout 中的一些 tfidf 向量上运行 ssvd。当我在 Java 代码中运行它时（使用 mahout 0.6 jars），它工作正常：

```
public static void main(String[] args){
    runSSVDOnSparseVectors(vectorOutputPath
     + "/tfidf-vectors/part-r-00000", ssvdOutputPath, 1, 0, 30000, 1);
}

private static void runSSVDOnSparseVectors(String inputPath, String outputPath, 
                    int rank, int oversampling, int blocks,
                    int reduceTasks) throws IOException {
    Configuration conf = new Configuration();
    // get number of reduce tasks from config?
    SSVDSolver solver = new SSVDSolver(conf, new Path[] { new Path(
            inputPath) }, new Path(outputPath), blocks, rank, oversampling,
            reduceTasks);
    solver.setcUHalfSigma(true);
    solver.setcVHalfSigma(true);
    solver.run();
} 
```

我决定将其转换为 bash 脚本并只使用 cli 命令，但是当我这样做时，我收到以下错误（在 0.5 和 0.7 版本上尝试过，但均无效。我可以尝试 0.6 但我没有不认为这是一个版本的东西）：

```
[username@hostname lsa]$  $MAHOUT/mahout ssvd -i $H/test_lsa/v_out/tfidf-vectors -o $H/test_lsa/svd_out -k 1 -p 0 -r 30000 -t 1
Running on hadoop, using /usr/bin/hadoop and HADOOP_CONF_DIR=
MAHOUT-JOB: /usr/lib/mahout-distribution-0.7/mahout-examples-0.7-job.jar
12/07/23 15:00:47 INFO common.AbstractJob: Command line arguments: {--abtBlockHeight=[200000], --blockHeight=[30000], --broadcast=[true], --computeU=[true], --computeV=[true], --endPhase=[2147483647], --input=[/path/to/folder/test_lsa/v_out/tfidf-vectors], --minSplitSize=[-1], --outerProdBlockHeight=[30000], --output=[/path/to/folder/test_lsa/svd_out], --oversampling=[0], --pca=[false], --powerIter=[0], --rank=[1], --reduceTasks=[100], --startPhase=[0], --tempDir=[temp], --uHalfSigma=[false], --vHalfSigma=[false]}
12/07/23 15:00:49 INFO input.FileInputFormat: Total input paths to process : 100
Exception in thread "main" java.io.IOException: Q job unsuccessful.
    at org.apache.mahout.math.hadoop.stochasticsvd.QJob.run(QJob.java:230)
    at org.apache.mahout.math.hadoop.stochasticsvd.SSVDSolver.run(SSVDSolver.java:377)
    at org.apache.mahout.math.hadoop.stochasticsvd.SSVDCli.run(SSVDCli.java:141)
    at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:65)
    at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:79)
    at org.apache.mahout.math.hadoop.stochasticsvd.SSVDCli.main(SSVDCli.java:171)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.hadoop.util.ProgramDriver$ProgramDescription.invoke(ProgramDriver.java:68)
    at org.apache.hadoop.util.ProgramDriver.driver(ProgramDriver.java:139)
    at org.apache.mahout.driver.MahoutDriver.main(MahoutDriver.java:195)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.hadoop.util.RunJar.main(RunJar.java:197) 
```

我在集群上以分布式模式运行它。我读过 Q 作业失败可能与块大小有关，但我的大于 p+k。我也意识到我正在使用一个非常小的输入（4 个向量），但就像我说的，它可以在 java 代码中使用。我很困惑为什么它可以在 java 中工作，但不能在 CLI 中工作。我很确定我已经为函数提供了所有相同的参数。我总是可以将 java 代码打包到一个 jar 中并将其放入 bash 脚本中，但这会很 hacky...

该工作的日志说：

```
2012-07-23 15:00:55,413 INFO org.apache.hadoop.util.ProcessTree: setsid exited with exit code 0
2012-07-23 15:00:55,417 INFO org.apache.hadoop.mapred.Task:  Using ResourceCalculatorPlugin : org.apache.hadoop.util.LinuxResourceCalculatorPlugin@6ce53220
2012-07-23 15:00:55,638 INFO org.apache.hadoop.io.compress.zlib.ZlibFactory: Successfully loaded & initialized native-zlib library
2012-07-23 15:00:55,697 ERROR org.apache.mahout.common.IOUtils: new m can't be less than n
java.lang.IllegalArgumentException: new m can't be less than n
    at     org.apache.mahout.math.hadoop.stochasticsvd.qr.GivensThinSolver.adjust(GivensThinSolver.java:109)
    at org.apache.mahout.math.hadoop.stochasticsvd.qr.QRFirstStep.cleanup(QRFirstStep.java:233)
    at org.apache.mahout.math.hadoop.stochasticsvd.qr.QRFirstStep.close(QRFirstStep.java:89)
    at org.apache.mahout.common.IOUtils.close(IOUtils.java:128)
    at org.apache.mahout.math.hadoop.stochasticsvd.QJob$QMapper.cleanup(QJob.java:158)
    at org.apache.hadoop.mapreduce.Mapper.run(Mapper.java:146)
    at org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:647)
    at org.apache.hadoop.mapred.MapTask.run(MapTask.java:323)
    at org.apache.hadoop.mapred.Child$4.run(Child.java:270)
    at java.security.AccessController.doPrivileged(Native Method)
    at javax.security.auth.Subject.doAs(Subject.java:396)
    at org.    apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1157)
    at org.apache.hadoop.mapred.Child.main(Child.java:264)
2012-07-23 15:00:55,731 INFO org.apache.hadoop.mapred.TaskLogsTruncater: Initializing logs' truncater with mapRetainSize=-1 and reduceRetainSize=-1
2012-07-23 15:00:55,733 WARN org.apache.hadoop.mapred.Child: Error running child
java.lang.IllegalArgumentException: new m can't be less than n
    at org.apache.mahout.math.hadoop.stochasticsvd.qr.GivensThinSolver.adjust(GivensThinSolver.java:109)
    at org.apache.mahout.math.hadoop.stochasticsvd.qr.QRFirstStep.cleanup(QRFirstStep.java:233)
    at org.apache.mahout.math.hadoop.stochasticsvd.qr.QRFirstStep.close(QRFirstStep.java:89)
    at org.apache.mahout.common.IOUtils.close(IOUtils.java:128)
    at org.apache.mahout.math.hadoop.stochasticsvd.QJob$QMapper.cleanup(QJob.java:158)
    at org.apache.hadoop.mapreduce.Mapper.run(Mapper.java:146)
    at org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:647)
    at org.apache.hadoop.mapred.MapTask.run(MapTask.java:323)
    at org.apache.hadoop.mapred.Child$4.run(Child.java:270)
    at java.security.AccessController.doPrivileged(Native Method)
    at javax.security.auth.Subject.doAs(Subject.java:396)
    at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1157)
    at org.apache.hadoop.mapred.Child.main(Child.java:264)
2012-07-23 15:00:55,736 INFO org.apache.hadoop.mapred.Task: Runnning cleanup for the task 
```

我在这里先向您的帮助表示感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T21:14:15.927

我实际上认为这是因为 tfidf-vectors 中有一些序列文件是空的，因为我使用了太多的 reducer。这对我来说似乎是一个错误。

# c# - 格式化字符串对象的最佳方式

> ID：11398069
> 
> 赞同：-1
> 
> 时间：2012-07-09T15:19:50.337
> 
> 标签：c#, string

我想创建一个这样的字符串对象

```
string data = "85-null-null-null-null-price-down-1-20";   // null if zero 
```

我有这样的方法。

```
 public static DataSet LoadProducts(int CategoryId, string Size, 
                                   string Colour, Decimal LowerPrice, 
                                   Decimal HigherPrice, string SortExpression, 
                                   int PageNumber, int PageSize, 
                                   Boolean OnlyClearance)
 {
      /// Code goes here 
      /// i am goona pass that string to one more method here

      var result = ProductDataSource.Load(stringtoPass) // which accepts only the above format

 } 
```

我知道我可以使用 a `StringBuilder`，但是使用它需要太多的代码行。我在这里寻找一个简约的解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-09T15:24:10.053

你可以这样做：

```
return string.Format("{0}-{1}-{2}-{3}-{4}-{5}-{6}-{7}-{8}",
                     CategoryId,
                     Size ?? "null", 
                     Colour ?? "null",
                     LowerPrice != 0 ? LowerPrice.ToString() : "null",
                     HigherPrice != 0 ? HigherPrice.ToString() : "null",
                     SortExpression ?? "null",
                     PageNumber != 0 ? PageNumber.ToString() : "null",
                     PageSize != 0 ? PageSize.ToString() : "null", 
                     OnlyClearance); 
```

为方便起见，您可以创建扩展方法：

```
public static string NullStringIfZero(this int value)
{
    return value != 0 ? value.ToString() : "null";
}

public static string NullStringIfZero(this decimal value)
{
    return value != 0 ? value.ToString() : "null";
} 
```

并按如下方式使用它们：

```
return string.Format("{0}-{1}-{2}-{3}-{4}-{5}-{6}-{7}-{8}",
                     CategoryId,
                     Size ?? "null", 
                     Colour ?? "null",
                     LowerPrice.NullStringIfZero(),
                     HigherPrice.NullStringIfZero(),
                     SortExpression ?? "null",
                     PageNumber.NullStringIfZero(),
                     PageSize.NullStringIfZero(),
                     OnlyClearance); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-09T15:23:22.867

```
string foo = String.Format("{0}-{1}-{2}-{3}-{4}-{5}-{6}-{7}-{8}",
                           CategoryId,
                           Size ?? "null" ... ); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-09T15:21:11.450

请使用您喜欢的格式覆盖对象的 ToString 方法并调用 Object.tostring() 方法

评论后请求示例：

```
public class Foo
{
  public string Field1 {get; private set;}
  public string Field2 {get; private set;}

   public override string ToString()
   {
      return string.Format("Field1 = {0} , Field2 = {1}", Field1, Field2);
   }
} 
```

现在这样做的好处是：

1.  在您的方法中，您只能使用 Foo 类型的 1 个参数
2.  当您在添加 foo 对象时调试并在断点处停止时，您将看到字符串表示
3.  如果你决定打印你所要做的就是 Console.WriteLine(foo)

# php - PHP中的多项选择

> ID：11398071
> 
> 赞同：0
> 
> 时间：2012-07-09T15:19:53.830
> 
> 标签：php

如何将所有输入（问题、选择、答案）保存在数据库中？我无法将正确答案保存在数据库中。如何获得通过单选按钮选择的所选值？或者还有别的吗？

```
<form action="test2.php" method="post">
<?php
if($numMC > 0)
    {

echo "<b>"."MULTIPLE CHOICE QUESTIONS: Enter them below followed by their correct answer."."</b>";
        echo "<br>"; 

        for ($j=1; $j<=$numMC; $j++)
            {?> 
<p><textarea name="question[<?php echo $j; ?>]" rows=3 cols=90>question[<?php echo $j; ?>]</textarea></p>
            <?php for($k=1;$k<=$numchoices;$k++)
                {
                echo $k; ?>
                <input type="radio" name="right[<?php echo $j; ?>]">
                <input type="text" name="choice[<?php echo $j; ?>][<?php echo $k; ?>]" value="choice[<?php echo $j; ?>][<?php echo $k; ?>]"><br />
<?php               }

                echo "<br>"."<br>";
            }

    } ?>

<input type="submit"> 
```

我将如何确定选择了哪个单选按钮以及如何获得所选单选按钮的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:22:30.417

您可以创建一个包含如下问题的表格：

```
----------------------------------------------------
| questionId | answer                    | correct |
----------------------------------------------------
| 1          | Possible answer 1a        | 0       |
----------------------------------------------------
| 1          | Possible answer 1b        | 1       |
----------------------------------------------------
| 2          | Possible answer 2a        | 1       |
----------------------------------------------------
| 2          | Possible answer 2b        | 0       |
---------------------------------------------------- 
```

您可以像这样构建页面：

```
$sql = mysql_query("SELECT * FROM questionsTable");
while($row = mysql_fetch_assoc($sql)){
echo '<input type="radio" value="'.$row['answer'].'" name="q'.$row['id'].'"/>
} 
```

您可以在提交表单后检查答案是否正确，如下所示：

```
$sql = mysql_query("SELECT * FROM questions");
while($row = mysql_fetch_assoc($sql)){
    $radioName = 'q'.$row['id'];
    if($row['correct'] == 1){
        //handle a correct answer here
    }
} 
```

# ajax - 使用 KendoUI 2012 和 VS 2012 定义 POST ajax 调用

> ID：11398079
> 
> 赞同：0
> 
> 时间：2012-07-09T15:20:22.510
> 
> 标签：ajax, asp.net-mvc-4, visual-studio-2012, kendo-ui

我是 Visual Studio 和 .net 的新手，如果我有一些基本错误，请原谅我。

这就是我想做的：使用 ajax 调用填充 kendoui 下拉列表的内容。现在我明白了最好使用 POST 操作，但我无法让它工作。

这是我在视图中的代码：

```
@(Html.Kendo().DropDownListFor(model => model.TypeId)
      .DataTextField("Shortname")
      .DataValueField("Id")
      .DataSource(source => source.Read(read => read.Action("GetObjectTypes", "ObjectType")))
) 
```

这是我的控制器代码：

```
[HttpPost] // use post to prevent 'leeching' 
public JsonResult GetObjectTypes()
{
    var objectTypes = _objecttypeRepository.All;
    return Json(objectTypes, JsonRequestBehavior.DenyGet);
} 
```

Ajax 调用根本不会到达 GetObjectTypes。如果我删除 [HttpPost] 和“JsonRequestBehavior.DenyGet”，那么这段代码可以正常工作。

提前谢谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T16:53:51.703

当 ComboBox/AutoComplete/Grid 等组件获取它们的数据时，它们总是使用 GET 并且没有选项可以更改它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T08:27:12.480

'GET' 实际上是检索资源（即您的下拉列表数据）的首选方法，请参阅[HTTP 协议请求方法](http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_methods)。'POST' 通常用于提交数据和创建新资源。

我自己没有做过，但如果你真的需要使用'POST'，你可以在数据源配置中指定它，见 kendo.data.DataSource's [transport.read.type](http://docs.kendoui.com/api/framework/datasource#transportreadtype-string)。

# asp-classic - 经典asp中的当前世界时间

> ID：11398084
> 
> 赞同：2
> 
> 时间：2012-07-09T15:20:35.890
> 
> 标签：asp-classic, utc

如何在经典 asp 中将当前时间作为通用时间。我知道如何进入 C# 并且我在 c# 中使用以下行 ((DateTime.Now).ToUniversalTime()).ToString("s") 获取通用时间，这段代码给了我这样的时间 2012-07-09T10 :29:49

但我想知道经典asp中的等价物。谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-11T20:39:37.457

正如[Ian 指出的，](https://stackoverflow.com/a/11398454/48082)您可以通过 Javascript 生成 UTC 时间。

您指定了“ASP Classic”，其中当然包含 Javascript 作为一种语言，因此您有一个答案： Call `(new Date()).toUTCString()`。

如果碰巧你喜欢用 VBScript 来编写你的页面，你可以混合一点 Javascript 来完成它。您无需`Server.Execute`借助 Sessions 即可实现这一目标。

这对我有用：

```
<%@ language="VBScript" %>
<script language='Javascript' runat='server'>
  function jsGetUTCTime() {
    var d = new Date();
    return d.toUTCString();
  }
</script>
<script language='VBScript' runat='server'>
Function getUTCTime()
    ' Use JScript to get the current GMT time stamp
    getUTCTime = jsGetUTCTime()
End Function
</script>
<!DOCTYPE html>
<html>
  <head>
    <title>Mix</title>
  </head>
  <body>
   <h2>The time is:</h2>
   <%= getUTCTime() %>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-09T15:39:32.100

根据[u229.no](http://www.u229.no/stuff/snippets/UTC.asp)，VBScript 中没有任何内置方法可以转换为 UTC。

看看作者在下面提供的使用 JScript 的代码，以及如何从 VBScript 调用它。

GetServerGMT 例程将返回如下内容：Wed, 01 Feb 2006 15:21:59 UTC。

```
Function GetServerGMT()

    // Use JScript to get the current GMT time stamp and store it in Session("ServerGMT")
    Server.Execute "GetServerGMT.asp"
    GetServerGMT = Session("ServerGMT")

End Function 
```

这就是带有 jscript 代码的 GetServerGMT.asp 文件的样子：

```
<%@language="jscript"%>
<%
    var od = new Date();
    var nd = od.toUTCString();
    Session("ServerGMT") = nd;
%> 
```

您还可以使用[其他 jscript 方法。](http://www.w3schools.com/jsref/jsref_obj_date.asp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-10-15T16:58:17.227

另一种方法是

```
%>
 <script runat="server" language="javascript">
     function getTimezoneOffset() {             
         return (new Date()).getTimezoneOffset()
     }
</script>
<%
Function nowUtc()
   nowUtc=DateAdd("n",getTimezoneOffset(),Now)
End Function 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-01T14:21:47.330

上述代码的变体

```
<%@ language="VBScript" %>
<!DOCTYPE html>
<html>
        <head>
        <script language='Javascript' runat='server'>

            // good for creating cookie timestamps that match RFC 1123
            function jsGetFutureTimeGMT(minutes) {
                var d = new Date();
                var future = new Date();
                future.setTime(d.getTime() + (minutes*60000));
                var utcString = future.toUTCString();
                var tz = utcString.indexOf("UTC");
                if (tz > 0) {
                    utcString = utcString.substring(0, tz) + "GMT";
                }
                return utcString;
            }
        </script>

        <title>ASP Classic RFC 1123 compliant GMT timestamp</title>
    </head>
    <body>
    <h2>ASP Classic RFC 1123 compliant GMT timestamp</h2>
    <pre>
     The VBS time right now is: <%= Now() %>
     The time in 10 minutes is: <%= jsGetFutureTimeGMT(10) %>
    </pre>
    </body>
</html> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-23T00:43:09.587

如果您的应用程序连接到数据库，您可能可以通过简单的快速查询从数据库中获取时间戳。例如，在 MySQL 中它是：`SELECT unix_timestamp()`.

这将为您提供一个 Unix 时间戳（自 Unix 纪元以来的秒数）。从那里转换成你喜欢的任何格式。

# sqlite - 如何创建 Context 对象，在调用 SQLiteOpenHelper 构造函数时需要

> ID：11398085
> 
> 赞同：0
> 
> 时间：2012-07-09T15:20:36.393
> 
> 标签：sqlite

我正在现有的 android 代码中创建一些 hack 类型的东西，以验证数据库的创建及其跨应用程序层的可访问性。

为此，我修改了 .java 文件的现有函数，但在调用 SQLiteOpenHelper 的构造函数时遇到了问题。

签名是`SQLiteOpenHelper(Context context, String name, SQLiteDatabase.CursorFactory factory, int version)`

而且我不知道如何创建这个 Context 实例。从谷歌搜索我看到它是某种活动类实例。

有什么方法可以创建这个 Context 实例？我们必须实现活动类吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:27:25.747

看看[这个问题](https://stackoverflow.com/questions/2002288/static-way-to-get-context-on-android)。它展示了如何静态获取对当前 Context 对象的引用。

它的要点是您必须存储对可以从其他代码部分静态访问的上下文的引用。

PS您不能真正“创建”上下文。这是 Android 平台为您提供的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T13:47:20.100

只需致电：

```
this.getApplicationContext() 
```

从您尝试创建`SQLiteOpenHelper`.

# jquery-mobile - jQuery Mobile text 和 notetext 按钮垂直对齐

> ID：11398086
> 
> 赞同：0
> 
> 时间：2012-07-09T15:20:39.653
> 
> 标签：jquery-mobile

当我将文本按钮放在标题中的 notext 按钮旁边时，notetext 按钮显示的位置略低于。我尝试为 ui-btn-icon-notext 设置 margin-top 和 padding-top，但这似乎没有效果。

![问题](../Images/b7a2a1b435fbda337f0b7b016df533b1.png)

```
<div data-role="header" class="ui-bar">
    ...  
   <div class="ui-btn-right">
     <a href="/" data-role="button" data-theme="e" data-mini="true">Sign In</a>
     <a href="/" data-icon="home-blue" data-theme="e" data-role="button" data-inline="true" data-iconpos="notext">Home</a>
     ...
   </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T19:30:55.583

不太确定为什么会这样，但快速（和肮脏）的修复可能是这样的：

```
a.custom-class-name-for-no-text-buttons {
    top: -2px !important;
} 
```

**JSFiddle**
[http://jsfiddle.net/GG3qE/](http://jsfiddle.net/GG3qE/)

# r - 将数据框一列中小于 X 的所有值更改为 0，将 X 和所有大于 X 的值更改为 1

> ID：11398098
> 
> 赞同：1
> 
> 时间：2012-07-09T15:21:16.250
> 
> 标签：r

我确信这很简单，但我的 R 不适合它：如何将数据帧的一列中低于 X 的所有值更改为 0，以及将 X 和所有大于 X 的值更改为 1？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T15:24:01.863

ifelse函数完全符合您的要求[。](http://www.math.montana.edu/Rweb/Rhelp/ifelse.html)如果您的数据框被调用`d`，并且列被调用`d$column`：

```
d$column = ifelse(d$column < X, 0, 1) 
```

# javascript - 如何将javascript代码附加到asp.net中的这个动态控件文本框

> ID：11398101
> 
> 赞同：1
> 
> 时间：2012-07-09T15:21:26.243
> 
> 标签：javascript, jquery, asp.net

我正在从后面的代码创建一个动态文本框控件......我的问题是。如何将 javascript 代码附加到动态创建的文本框？

这是创建动态文本框的代码。

```
TextBox t = new TextBox();
t.ID = "txtDynamic";
t.TextMode = TextBoxMode.MultiLine;
t.Rows = 7; 
```

下面是Javascript....想添加到上面创建的控件。

```
$('txtDynamic').limit('140','#charsLeft'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:24:12.690

在使用 ASP.NET WebForms 时，我总是尽量避免在我的 javascript 中引用 ID，因为呈现的 ID 可能并不总是与服务器端 ID 相同。

用于`CssClass`确保一致性，并在您的 jquery 选择器中使用`.`前缀而不是前缀。`#`

```
TextBox t = new TextBox();
t.ID = "txtDynamic";
t.TextMode = TextBoxMode.MultiLine;
t.Rows = 7;
t.CssClass = "limit140";

$('.limit140').limit('140','#charsLeft'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T15:26:27.937

服务器端代码会更改 ID，因此您需要使用客户端 ID。同样在您的示例中，您缺少`#`jQuery 选择器。

```
$('#<%=txtDynamic.ClientID%>').limit('140','#charsLeft'); 
```

这仅在代码是内联 JavaScript 时有效，在外部文件中无效。

如果不是，最好设置一个 CSSClass 并在选择器中引用它。

# android - 如何使用 addView 将视图添加到布局？

> ID：11398103
> 
> 赞同：22
> 
> 时间：2012-07-09T15:21:28.323
> 
> 标签：android, layout, view, viewgroup, adview

我可能已经阅读了所有帖子和文档，但我仍然无法解决这个问题。

我想使用`addView()`方法将视图添加到现有（运行）布局，但由于某种原因我不能。我知道这应该是简单和基本的，但我仍然做不到。所以，请帮助我。

这是一个代码：

```
LinearLayout layout = (LinearLayout)findViewById(R.id.mainLayout);
TextView text       = new TextView(this);
text.setText("test");
layout.addView(text); 
```

那是一段代码，结果是我只显示了在 XML 文件中定义的视图。我没有添加这个新视图。当我调试时，我看到这个添加的视图是我添加它的父视图的子视图，但它没有显示。

这是main.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
                android:id="@+id/mainLayout"
              android:layout_width="fill_parent" 
              android:layout_height="fill_parent"
              android:orientation="vertical"
              android:background="@drawable/main1" >
    <TextView android:id="@+id/app_title"
              android:layout_width="fill_parent"
              android:layout_height="wrap_content"
              android:textColor="#FFF"
              android:text="@string/app_title"
              android:textSize="25dp" 
              android:gravity="center_horizontal"/>
    <TextView android:layout_width="fill_parent" 
              android:layout_height="wrap_content"
              android:layout_marginTop="5dp"
              android:text="@string/main_screen_counter_title"
              android:textSize="15dp" 
              android:textColor="#FFF"
              android:gravity="center_horizontal"/>
   <TextView android:id="@+id/frontScreenCounter"
              android:layout_width="fill_parent" 
              android:layout_height="wrap_content"
              android:textColor="#FFF"
              android:text="@string/reading"
              android:textSize="33dp"
              android:gravity="center_horizontal" />   
    <GridView android:id="@+id/gridview"
    android:layout_width="fill_parent" 
    android:layout_height="fill_parent"
    android:columnWidth="90dp"
    android:numColumns="3"
    android:verticalSpacing="10dp"
    android:horizontalSpacing="10dp"
    android:stretchMode="columnWidth"
    android:gravity="center"
    android:textColor="#888"
/>
</LinearLayout> 
```

请帮忙。这会让我发疯！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-07-09T15:26:15.857

您忘记`LayoutParameters`为新添加的视图指定 。

```
LinearLayout layout = (LinearLayout)findViewById(R.id.mainLayout);
    TextView text=new TextView(this);
    text.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
    text.setText("test");
    layout.addView(text); 
```

**编辑**

`GridView`id 为的`@+id/gridview`定义布局高度为`fill_parent`，让您没有空间添加新视图。将其高度更改为`wrap_content`可能会解决您的问题。

将我的评论添加到这篇文章中，以帮助其他人轻松验证解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T15:24:21.463

我不记得了，但也许有任何“刷新”方法可以再次加载布局。

试试 layout.invalidate();

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-12T11:56:49.843

我有同样的问题，浪费了好几次寻找原因。

我的错是我添加了一个将 match_parent 设置为高度的 CustomView。

我希望为那些犯了这个愚蠢恼人的错误的人节省一些宝贵的时间:)

```
TextView tv = new TextView(this);
lytMarks.addView(tv);

CustomView cv = new CustomView(this, someObject);
lytMarks.addView(cv); // <-- This one had height = match_parent!!

EditText et = new EditText(this);
lytMarks.addView(et); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-12T12:28:51.643

您的 linearLayout 内容位于父视图之上。所以你需要使用ScrollView。像这样：

```
<?xml version="1.0" encoding="utf-8"?>

<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
android:layout_width="fill_parent"
android:layout_height="fill_parent">

<LinearLayout
    android:id="@+id/mainLayout"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="@drawable/main1"
    android:orientation="vertical">

    <TextView
        android:id="@+id/app_title"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:gravity="center_horizontal"
        android:text="@string/app_title"
        android:textColor="#FFF"
        android:textSize="25dp" />

    <TextView
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="5dp"
        android:gravity="center_horizontal"
        android:text="@string/main_screen_counter_title"
        android:textColor="#FFF"
        android:textSize="15dp" />

    <TextView
        android:id="@+id/frontScreenCounter"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:gravity="center_horizontal"
        android:text="@string/reading"
        android:textColor="#FFF"
        android:textSize="33dp" />

    <GridView
        android:id="@+id/gridview"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:columnWidth="90dp"
        android:gravity="center"
        android:horizontalSpacing="10dp"
        android:numColumns="3"
        android:stretchMode="columnWidth"
        android:textColor="#888"
        android:verticalSpacing="10dp" />
</LinearLayout>
</ScrollView> 
```

# java - JSch端口关闭

> ID：11398106
> 
> 赞同：1
> 
> 时间：2012-07-09T15:21:42.277
> 
> 标签：java, jsch

我正在尝试 porgram 一个 ssh 隧道程序，但似乎不再使用的端口仍然不可用。我的隧道结构示例：

第一条隧道：本地端口-> 22，本地IP：1.2.3.4，用户...，密码...，隧道端口-> 5000

下一条隧道：本地端口 -> 5000，本地 IP：localhost，用户...，pw..，隧道端口 -> 5001

下一条隧道：本地端口 -> 5001，本地 IP：localhost，用户...，pw..，隧道端口 -> 5002

到目前为止，一切都很好。现在这是我尝试关闭所有隧道的代码：

```
private void sortiiii(Map<Session, Integer> sessions) throws JSchException{
    Map<Session, Integer> map = sessions;
    ValueComparator bvc = new ValueComparator(map);
    TreeMap<Session, Integer> sorted_map = new TreeMap(bvc);

    sorted_map.putAll(map);
    for (Session key : sorted_map.keySet()) {
        System.out.println(sorted_map.get(key));
        String [] alle = key.getPortForwardingL();
        for (int i=0; i<alle.length; ++i){
            System.out.println(alle[i]);
        }

        key.delPortForwardingL(sorted_map.get(key));
        key.disconnect();
    }
} 
```

地图已排序，因为一条隧道需要之前的一条，依此类推......

谁能想象为什么在我清理连接后端口 5000、5001、5002... 不可用？

# javascript - 使用 jQuery 在悬停时将列表项向右移动

> ID：11398107
> 
> 赞同：2
> 
> 时间：2012-07-09T15:21:43.997
> 
> 标签：javascript, jquery, css

我试图通过将文本向右“碰撞”一点，然后在悬停时再次返回，来引起对悬停的列表项的更多关注。这就是我所拥有的：

```
$('.ipro_menu ul li a').hover(function(){
    $(this).animate({
        'padding-left':'20px'},100,function(){
            $(this).animate({
                'padding-left':'15px'});
    });
}); 
```

padding 最初是 15px，所以当你将鼠标悬停在列表中的链接上时，padding 会增加 5px，然后很快又回到 15px。问题是它一次移动多个元素。有时它不仅会移动自身，还会移动其上方或下方的项目。

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-09T15:35:37.533

我对我认为你想要做的事情做了一个快速的 jsfiddle。

[http://jsfiddle.net/tuXcA/](http://jsfiddle.net/tuXcA/)

代码基本上是：

```
$('ul').find('li').hover(function() {
    $(this).animate({
        'padding-left':'20px'
    },100);
}, function() {
    $(this).animate({
        'padding-left':'0px'
    },100);
}); 
```

悬停时向右滑动，未悬停时滑回正常位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:20:18.353

> padding 原本是 15px，所以当你将鼠标悬停在列表中的一个链接上时，padding 会增加 5px，然后**很快又回到**15px

所以基本上你想要一个反弹效果？如果是这样的话：

```
var cssOver = { 'padding-left': '25px' },
      cssOut = { 'padding-left': '15px' },
      overDuration = 100,
      outDuration = 100,
      selector = '.ipro_menu ul li';

  $(selector).mouseover(function(){
    var _this = $(this);
    _this
      .clearQueue()
      .animate(cssOver, overDuration, function(){
        _this.animate(cssOut, outDuration);
      });
  }); 
```

现场示例：[http ://bl.ocks.org/3077195](http://bl.ocks.org/3077195)

我个人建议使用这个插件：[http ://ricostacruz.com/jquery.transit/](http://ricostacruz.com/jquery.transit/)

# javascript - 推荐facebook好友下载手机应用

> ID：11398108
> 
> 赞同：1
> 
> 时间：2012-07-09T15:21:47.207
> 
> 标签：javascript, jquery, facebook

我已经使用 Phonegap 编写了一个移动应用程序，并且我使用过......

```
FB.init({ appId: appid, nativeInterface: CDV.FB, useCachedDialogs: false });
FB.login(function(response){FB.api('/me', function(response) {}); 
```

...登录并...

```
TDFriendSelector.init({debug: true});
  selector1 = TDFriendSelector.newInstance({
  callbackSubmit: function(selectedFriendIds) {});
selector1.showFriendSelector(); 
```

... 使用“tdFriendsSelector”选择要邀请的朋友列表。

但我希望能够向尚未在我的应用中注册的朋友发送消息。我有一个逗号分隔的 id 列表，但需要知道如何发送消息、发布或邀请他们下载应用程序。

任何代码提示、建议、想法都会很棒，一整天都在上面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T15:39:11.540

通常我建议使用[发送对话框](https://developers.facebook.com/docs/reference/dialogs/send/)，因为这正是你需要的，但是当你正在构建一个 PG 应用程序时，我怀疑你必须遍历用户 ID 的逗号列表，每次通过直接调用 Feed API FB.api [("/friend_id/feed")](https://developers.facebook.com/docs/reference/api/user/#feed)方法。请注意，您首先必须通过获得用户权限（publish_stream）。[FB 身份验证](https://developers.facebook.com/docs/authentication/)，以便将消息发布到他们的朋友源。不幸的是，我没有任何特定于 PG 的知识来帮助您解决这些问题。

祝你好运！

# php - 从文档根目录外获取文件。PHP

> ID：11398109
> 
> 赞同：0
> 
> 时间：2012-07-09T15:21:48.437
> 
> 标签：php, file, document-root

我目前将 docx 文件和 pdf 文件存储在 doc 根目录之外的用户上传文件夹中。我打算通过 db 链接将这些文件下载到严重打乱的文件名。

以前我只使用 PHP 从根以外的文件中获取数据 - 是否可以从该区域检索整个文件，如果可以，如何进行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:24:49.700

```
<?php

$file_id = $_GET['id'];

$local_path = get_real_filelocation_from_id($file_id);

readfile($local_path); 
```

的代码`get_real_filelocation_from_id()`留作 OP 的练习。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T22:46:18.317

```
<?php
$get_file=$_GET['file_name'];
$file = '/path/to/uploads/'.$get_file;

if (file_exists($file)) {
header('Content-Description: File Transfer');
header('Content-Type: application/octet-stream');
header('Content-Disposition: attachment; filename='.basename($file));
header('Content-Transfer-Encoding: binary');
header('Expires: 0');
header('Cache-Control: must-revalidate');
header('Pragma: public');
header('Content-Length: ' . filesize($file));
ob_clean();
flush();
readfile($file);
exit;
}
?> 
```

经过几个小时的搜索，我发现这似乎有效。不幸的是，虽然符号链接根似乎是一个很好的路径，但我不确定如何实际实现它 - 当我尝试最基本的脚本时，firebug 会进入怪癖模式。

# php - php。如何动态更改 HTML 选择操作上的页面内容？

> ID：11398113
> 
> 赞同：0
> 
> 时间：2012-07-09T15:21:58.370
> 
> 标签：php

我有这个代码：

**页面.php：**

```
<?php

include ('include.php');

echo = '
<li>
    <select name="selector" class="letter">
        <option value="a" selected="selected">$a</option>
        <option value="b">$b</option>
    </select>
</li>
';

echo = '
<li>
    <select name="a-numbers" class="number a-numbers">
        <option value="$a[1][1]">$a[1][2]</option>
        <option value="$a[2][1]">$a[2][2]</option>
    </select>
    <select name="b-numbers" class="number b-numbers">
        <option value="$b[1][1]">$b[1][2]</option>
        <option value="$b[2][1]">$b[2][2]</option>
    </select>
</li>
';

?> 
```

&

**包括.php：**

```
<?php

$array = array(
    "a" => array(
        "1" => array("aaa1-value","aaa1-text"),     
            "2" => array("aaa2-value","aaa2-text")      
        ),  
        "b" => array(
            "1" => array("bbb1-value","bbb1-text"),     
            "2" => array("bbb2-value","bbb2-text")      
        )   
    )
);

?> 
```

如果*`.letter>a`*选中，*`.a-numbers`*则应回显列表；如果*`.letter>b`*选中，*`.a-numbers`*则应删除列表并*`.b-numbers`*打印。

当然，我可以用 JS 和 CSS 创建这个场景`display:none`；但是，我不能`display:none`在这里使用。所以我必须从 DOM 中删除元素，但我不能。

感谢您的关注。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T15:28:42.573

PHP 不能自己动态地做任何事情。您将需要使用 AJAX，它实际上会将请求/响应发送回服务器以填充 div。

或者，您需要使用初始请求/响应加载所有可能的内容，并使用 javascript 动态显示/隐藏有问题的 div。

你在你的问题中提到你不能使用 display:none，所以你可能想研究一个异步回调网络服务器来填充元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T15:24:04.490

如果您只想从 DOM 中删除某些内容。jQuery 可以通过使用来做到这一点

```
 $.remove("[selector]") 
```

然后，如果您需要添加它们，您可以使用 jquery [prepend](http://api.jquery.com/prepend/)或[append](http://api.jquery.com/append)。如：

```
$("[selector]").append("<!--escaped HTML-->"); 
```

# android - 顶点着色器不在galaxy tab10（tegra 2）上运行

> ID：11398114
> 
> 赞同：2
> 
> 时间：2012-07-09T15:22:08.173
> 
> 标签：android, opengl-es-2.0, galaxy-tab, vertex-shader, tegra

我在 HTC Desire S 上创建了一个使用 GLES2.0 的应用程序。它适用于 HTC，但不适用于三星 Galaxy tab10.1。该程序无法链接（GLES20.glGetProgramiv(mProgram, GLES20.GL_LINK_STATUS, linOk,0) 给出-1）并且 glGetError() 给我一个错误 1282（无效操作）。

当我替换这条线（在着色器中）时：

```
graph_coord.z = (texture2D(mytexture, graph_coord.xy / 2.0 + 0.5).r); 
```

经过

```
graph_coord.z = 0.2; 
```

它也适用于银河选项卡。我的着色器看起来像这样：

```
 private final String vertexShaderCode =
"attribute vec2 coord2d;" +
"varying vec4 graph_coord;" +
"uniform mat4 texture_transform;" + 
"uniform mat4 vertex_transform;" +
"uniform sampler2D mytexture;" +
"void main(void) {" +
"  graph_coord = texture_transform * vec4(coord2d, 0, 1);" +
"  graph_coord.z = (texture2D(mytexture, graph_coord.xy / 2.0 + 0.5).r);" + 
"  gl_Position = vertex_transform * vec4(coord2d, graph_coord.z, 1);" + 
"}"; 
```

那是附加着色器的地方：

```
 mProgram = GLES20.glCreateProgram();             // create empty OpenGL Program
  GLES20.glAttachShader(mProgram, vertexShader);   // add the vertex shader to program
  GLES20.glAttachShader(mProgram, fragmentShader); // add the fragment shader to program
  GLES20.glLinkProgram(mProgram);                  // create OpenGL program executables
  int linOk[] = new int[1];
  GLES20.glGetProgramiv(mProgram, GLES20.GL_LINK_STATUS, linOk,0); 
```

纹理在这里加载：

```
 GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, texture_id[0]);
 GLES20.glTexImage2D(
        GLES20.GL_TEXTURE_2D,   // target
    0,                  // level, 0 = base, no minimap,
    GLES20.GL_LUMINANCE,       // internalformat
    size,                  // width
    size,                  // height
    0,                  // border, always 0 in OpenGL ES
    GLES20.GL_LUMINANCE,       // format
    GLES20.GL_UNSIGNED_BYTE,   // type
    values
 ); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T08:48:00.553

这似乎是 Nvidia Tegra GPU 的限制。我能够在 Tegra 3 GPU 上重现该错误。尽管顶点着色器中的纹理查找在理论上是 OpenGL ES 2.0 的一部分，但根据 Nvidia 的说法，Tegra 的顶点着色器纹理单元 ( `GL_MAX_VERTEX_TEXTURE_IMAGE_UNITS`) 的数量为 0 ( [PDF: OpenGL ES 2.0 Development for the Tegra Platform](http://developer.download.nvidia.com/assets/mobile/files/tegra_gles2_development.pdf) )。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-24T13:55:09.887

您必须使用`texture2DLod()`而不是`texture2D()`在顶点着色器中进行纹理查找。

GLSL 规范，第*8.7 节纹理查找函数*：[http ://www.khronos.org/files/opengles_shading_language.pdf](http://www.khronos.org/files/opengles_shading_language.pdf)

# python - 如何在 Komodo Edit IDE 中编写宏？

> ID：11398115
> 
> 赞同：2
> 
> 时间：2012-07-09T15:22:13.873
> 
> 标签：python, komodo

保存文件时需要运行宏。我有文件保存的代码，我只是不知道在保存时将其包裹起来以触发它的代码。

我认为 komodo 编辑是用 Python 编写的，因此假设如果有人知道 Python 中以下代码的代码，它将起作用：

```
onFileSave{

//do stuff

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:23:05.523

您可以查看[ActiveState 宏](http://docs.activestate.com/komodo/7.0/macros.html)页面或[宏 api](http://docs.activestate.com/komodo/7.0/macroapi.html)页面。

宏可以在 python 或 javascript 中完成。录制宏会创建一个 javascript 宏。您还可以通过右键单击工具箱（右）面板来创建宏。

**创建宏后，从“属性”菜单项访问“触发器”选项卡（右键单击宏）。**

SO 提供了不错的一站式购物服务，但我发现 ActiveState 开发人员在[ActiveState 支持论坛](http://support.activestate.com/forums/)上反应迅速且乐于助人。

# java - 内部类的目的是什么

> ID：11398122
> 
> 赞同：58
> 
> 时间：2012-07-09T15:22:32.290
> 
> 标签：java, oop, class, inner-classes

我正在回顾 Java 中内部类的概念。到目前为止，我所理解和应用的 java 内部类有一个链接或访问其外部/封闭类的方法和字段。

我的问题：

1.  什么时候应该创建或定义一个内部类？
2.  内部类是否被称为“帮助类”？
3.  您创建内部类的指标是什么，它们的其他目的是什么？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-07-09T15:29:10.523

内部类最适合对在一处使用的类进行逻辑分组。例如，如果您想创建仅由封闭类使用的类，那么为此创建单独的文件是没有意义的。相反，您可以将其添加为“内部类”

按照[java教程](http://docs.oracle.com/javase/tutorial/java/javaOO/nested.html)：

> 使用嵌套类的令人信服的原因包括：
> 
> *   这是一种对仅在一个地方使用的类进行逻辑分组的方法。
> *   它增加了封装。
> *   它可以导致更可读和可维护的代码。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-07-09T15:32:06.910

内部类的一个经典用途是在容器内实现迭代器（例如[ArrayList](http://www.opensourcejavaphp.net/java/openjdk/java/util/ArrayList.java.html) - 查找`class Itr`）。所有容器想要暴露给世界其他地方的是一个`Iterator`. 但是，它必须创建该迭代器的一些具体实现，可能熟悉容器的内部结构。使用内部类隐藏了实现，同时保持它靠近容器的实现。并且作为内部（即非静态），它绑定到该容器的特定实例，这允许它访问私有容器成员。

有[几种类型的内部类](http://en.wikipedia.org/wiki/Inner_class#Types_of_inner_classes)——非静态嵌套类、本地类和匿名类。每个都有不同的目的，所以当询问内部类时，你应该指定你在说什么类型。

假设您指的是非静态内部类，我会说使用它们的原因与使用常规类（即抽象并将代码划分为逻辑单元）相同，但是没有理由使这种对类的使用可见到世界其他地方。当然，您也可以将嵌套类公开，在这种情况下，您可以使它们嵌套而不是独立，以表达它们与外部类的紧密关系。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-09T15:35:48.687

1.  有关主要原因，请参阅[Java 教程。](http://docs.oracle.com/javase/tutorial/java/javaOO/nested.html)

2.  如果您所说的“帮助类”是指仅供内部使用的东西，那么不，不一定。你可能想做类似的事情

    ```
    class Outer {
        private static class Inner implements InterestingInterface {
            // whatever
        }
        public InterestingInterface make_something_interesting() {
            return new Inner();
        }
    } 
    ```

    在这里，`Inner`不是外部世界确实可以看到它的实例的“帮助类”，但它的实现是完全隐藏的——外部世界只知道它得到了一些实现的对象`InterestingInterface`。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-03-10T15:48:33.183

作为一般规则，**对象**应该*为*单一**职责**（高度内*聚*）而设计。换句话说，任何设计良好的对象，都应该执行一个**连贯的任务**。这将被认为是面向对象设计的最佳实践。

然而，有时，开发人员可能会设计一个需要**单独的** **专用**类才能工作的类。这个单独的*专业*类可以被认为是一个**助手类**。

如果*辅助*类**没有被任何其他类使用**，那么它将被视为内部类的主要**候选****者**

 **正如上面的**ncmathsadist**所引出的，内部类使用的一个**例子**是在**事件处理程序**的实现中。

例如，在设计图形用户界面 (GUI) 时，开发人员可能已经创建了一个**按钮**，*该*按钮在用户按下后*执行*特定**任务。**

 ***该按钮需要一个**事件处理程序**来*监听*该特定按钮何时被按下。

在这种情况下，将按钮的事件处理程序创建为**内部类**将是*最佳实践，因为除了***GUI 类中的特定按钮**之外，不会在其他任何地方使用 内部类。

 *** * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-07-09T15:36:55.350

内部类的目的之一是附加侦听器。例如，假设您有一个`JMenuItem`. 您可以让它退出您的应用程序，如以下代码所示：

```
JMenuItem quitItem = new JMenuItem("Quit");
quitItem.addActionListener(new ActionListener(){
    public void actionPerformed(ActionEvent e)
    {
        //cleanup code before exiting
        System.exit(0);
    }
}); 
```

您可能还希望一个类能够访问完全从属于该类的外部类状态变量。例如，考虑编写一个简单的颜色计算器。它可能有一个文本区域，您可以在其中键入十六进制代码。当您按下回车键时，您希望 JPanel 显示颜色。这是您可能会做什么的粗略大纲。

```
public class ColorCalc extends JPanel implements Runnable
{
    Color displayedColor;
    JTextArea colorEnterArea;
    public ColorCalc()
    {
        displayedColor = Color.white
        colorEnterArea = new JTextArea();
    }
    public void run()
    {
        //build GUI here
    }
    public static void main(String[] args)
    {
         ColorCalc cc = new ColorCalc();
         javax.swing.SwingUtilities.invokeLater(cc);
    }
    //subservient inner class with access to outer class state variable.
    class ColorPanel extends JPanel
    {
         public void paintComponent(Graphics g)
         {
             g.setColor(displayedColor);
             g.fillRect(0,0,getWidth(), getHeight());
         } 
    }

} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-07-09T15:41:20.683

这是一个风格问题。可以用内部类完成的任何事情也可以作为一系列外部类来完成。内部类对于轻量级或紧密绑定到封闭类的类特别有用。例如，比较器通常是这两种东西。它需要对类的实现有深入的了解，并且可能只有几行。它可能是作为内部类的理想人选。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-06-21T05:55:17.480

如果您发现有足够的代码可以由类更好地完成，因为类为我们提供了使用字段和方法指定统计信息和行为，并且您不希望此类需要在封闭类之外使用。你应该使用内部类。

在这里，内部阶级对外界是隐藏的。内部类可以访问为我们提供封装的封闭类的私有成员。

让我举个例子。假设您要将齿轮设置为循环，并且您有一个业务规则，例如最多只有 6 个齿轮。因此，您可以创建内部类循环，它具有设置齿轮的方法。该方法在设置齿轮之前进行了一些验证。就像循环正在运行...齿轮数小于 6...

最好的例子是事件处理代码使用内部类（有时是匿名内部类）来创建事件和侦听器，而无需为您的事件创建单独的事件对象和事件侦听器类。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-10-18T19:29:14.457

从我的个人笔记中添加，供未来的访问者使用：

[![在此处输入图像描述](../Images/a2d5f2fe68c572b7b23b78f20741c8bf.png)](https://i.stack.imgur.com/8eW3m.png) [![在此处输入图像描述](../Images/8b1f37c98ef32e3943b992719f2fcffe.png)](https://i.stack.imgur.com/gKZrI.png)

* * *

资料来源：https://docs.oracle.com/javase/tutorial/java/javaOO/whentouse.html

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-07-23T21:59:11.920

用于对类进行逻辑分组的内部类，例如，如果你有 B 类，而这个类只在 A 类中使用，那么最好将 B 类作为 A 类的内部类，因为这样可以提供可读性和可重用性你的代码。

快乐的代码:)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-04-23T08:08:31.707

从概念上讲，内部类可用于表示 Universe 中没有该父类型就不会存在的类型。换句话说，对于允许内部类的语言，类型都是“类型定义器”。然后可以将类型视为显式或隐式定义新类型的东西。

例如，假设我们有一个“食物”可以应用于任何事物的宇宙。甚至自己。食物是我们宇宙中的一个基本概念。我们引入了一个名为 Meat 的 Food 子类。没有这个概念，就没有“肉食者”这样的东西。所以我们可以（注意'can'）定义一个嵌套类型“Meat.Eater”（它可以实现一个IEater接口）并将动物定义为不同IEater列表的包含结构。

一旦我们将肉从宇宙中移除，肉食者就会消失。

同样的理念巧妙地适用于更抽象和技术上有用的安排，例如 Memento 设计模式中的 Mementos、定义为嵌套类的配置对象以及其他特定于类型的行为或结构。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-09-17T09:27:18.600

假设您在一个名为“com.custom.classes”的包中拥有一个类型和一个名为 OuterClass 的类。

**那么这里是你如何开始需要一个内部类或静态类：**

**情况1：**

1.  你需要打包一组类
2.  但也需要某些全局变量在该包级别暴露给所有这些类
3.  你明白你不能对包做这样的事情，但你意识到你可以通过继承来实现这一点，其中父类成员可以充当全局变量，对其所有子类实例都可用。
4.  但是您不喜欢需要继承父类并且需要实例化子类以访问全局变量的想法。这就像为了喝咖啡而要求买一家咖啡店。
5.  所以你意识到你可以用静态成员创建一个 OuterClass，并根据需要将这个 OuterClass 中的所有类作为内部类或静态类容纳，瞧！OuterClass 静态成员可用作这些嵌套类的全局变量，您甚至可以在不实例化它们的情况下访问它们。

这段代码应该解释得更好

```
public class InnerClassTester{
  public static void main(String []args){

    // without the need to instantiate any class
    // static class without instantiation
    System.out.println(OuterClass.NestedStaticClass1.incrGlobalNum()); // outputs 1

    // static class instantiated
    OuterClass.NestedStaticClass2 koolObj = new OuterClass.NestedStaticClass2();
    // works with instantiation as well
    System.out.println(koolObj.incrGlobalNum()); // outputs 2

    // inner classes always need to be instantiated
    // and they can only be instantiated from within an instance of outer class
    // think of them as instance member of outer class and this would make sense
    OuterClass.NestedInnerClass1 koolObj2 = new OuterClass().new NestedInnerClass1();
    // works with inner classes as well
    System.out.println(koolObj2.incrGlobalNum()); // outputs 3
 }
}

class OuterClass{
    // global variable thats only accessible for select classes (or nested classes)
    // we also learn a purpose for private static fields
    private static int privateGlobalValue = 0;

    // classes to be grouped
    // static class
    public static class NestedStaticClass1{
        // no need to instantiate this class to access/update the global value
        public static int incrGlobalNum(){
            return ++privateGlobalValue;
        }
    }

    public static class NestedStaticClass2{
        // instantiate and still manipulate the global value
        public int incrGlobalNum(){
            return ++privateGlobalValue;
        }
    }

    // inner class
    public class NestedInnerClass1{
        // instantiate and still manipulate the global value
        public int incrGlobalNum(){
            return ++privateGlobalValue;
        }
    }

} 
```

这是否让您想起 Javascript 中的闭包？:)

* * *

嵌套类的大多数应用程序都将其应用在设计决策的基础上。这意味着，嵌套类的每个案例都可以替换为其他设计。

但是话虽如此，我们也可以用组合模式代替继承模式（最近势头越来越大），尽管当类之间的依赖关系如此之多以至于完全组合依赖时，继承模式肯定更好会很丑。

**案例二：**

1.  您需要在 OuterClass 上实现 2 个接口，IShark 和 IMosquito，它们具有相同的签名，一个公共的咬合方法。
2.  但是您想显示 2 条不同的消息，因为鲨鱼的叮咬与蚊子的叮咬略有不同。
3.  但是您知道这是不可能的，因为只能实现一种咬合方法
4.  您知道您可以在同一个包中创建 2 个不同的类，它们实现任一接口并实现单独的咬合方法并将它们组合在 OuterClass 中。
5.  但是您想在 OuterClass 中完成它，因为**将咬合行为封装在其中是您的设计决定**，可能是因为对类中的私有变量存在依赖性。
6.  很快你就会意识到你可以通过私有静态内部类来实现这两个接口，并让它在外界看来就像它是组合的一样。

看看这段代码：

```
// no additional classes in the package

public class InterfaceTester{

     public static void main(String []args){

        // same class returns 2 instances - both compliant to 
        // either interfaces and yet different output

        IShark shark = OuterClass.getSharkInstance();
        System.out.println(shark.bite()); // outputs "Die fast bosedk!"

        IMosquito mosquito = OuterClass.getMosquitoInstance();
        System.out.println(mosquito.bite()); // outputs "Die slow bosedk!"
     }

}

interface IShark{
    public String bite();
}

interface IMosquito{
    public String bite();
}

class OuterClass implements IShark{

    // dependency of inner class on private variable
    private static String dieSlow = "Die slow bosedk!";
    private static String dieFast = "Die fast bosedk!";

    private static OuterClass outerInst;
    private static InnerClass innerInst;

    // private constructor to stop regular instantiation
    private OuterClass(){}

    // get a shark !
    public static IShark getSharkInstance(){
        return outerInst != null ? outerInst : new OuterClass();
    }

    // get a mosquito !
    public static IMosquito getMosquitoInstance(){
        return innerInst != null ? innerInst : new InnerClass();
    }
    // an implementation of bite
    public String bite(){
        return dieFast;
    }

    // inner class that implements the second interface
    private static class InnerClass implements IMosquito{
        // different implementation of bite
        public String bite(){
            return dieSlow;
        }
    }

} 
```

这类设计决策案例很多，上面的所有答案都列出了几个这样的案例。因此，认为这个特性是作为一种新模式而不是作为特性或功能引入的，这并没有错。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2015-08-27T08:41:07.747

我只是认为这只是语言的一个特征。如果我们采用OOD并遵守SOLID原则，我不建议使用它。*******

# yii - Yii : CJuidialog 和 iframe

> ID：11398124
> 
> 赞同：0
> 
> 时间：2012-07-09T15:22:43.213
> 
> 标签：yii

我正在使用 Yii 框架。我需要使用 iframe 创建对话框。如何在 iframe 中创建 CJuidialog？如果你有这方面的经验，请分享。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-03T19:33:00.727

> 我正在使用 CjuiDialog 在我的布局中创建播放列表（播放列表按钮）

```
`<a href="#" id="addavtoplaylist">Add To playList</a>` 
```

> 通过单击上面的按钮 id 参考以下代码

在查看页面

```
 $('#addavtoplaylist').live('click',function(){
            $('#cru-frame').attr('src','".Yii::app()->createAbsoluteUrl("playlist/add",array('id'=>$this->model->av_id))."'); 
            $('#cru-dialog').dialog('open');  
            return false;                        
        }); 
```

> 在同一页面中添加对话框代码

```
<?php
//--------------------- begin new code --------------------------
   // add the (closed) dialog for the iframe
    $this->beginWidget('zii.widgets.jui.CJuiDialog', array(
    'id'=>'cru-dialog',
    'options'=>array(
        'title'=>'Add To Play List',
        'autoOpen'=>false,
        'modal'=>true,
        'width'=>550,
        'height'=>300,
        'close'=>'js:function(){                             
        }',
    ),
    ));
?>
<iframe id="cru-frame" width="100%" height="100%"></iframe>
<?php

$this->endWidget();
//--------------------- end new code --------------------------
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-09T09:18:20.063

在您的视图文件中使用以下代码

```
$this->beginWidget('zii.widgets.jui.CJuiDialog',array(
'id'=>'mydialog',
// additional javascript options for the dialog plugin
'options'=>array(
    'title'=>'Dialog box 1',
    'autoOpen'=>false,
),
));
echo 'dialog content here';
$this->endWidget('zii.widgets.jui.CJuiDialog');
// the link that may open the dialog
echo CHtml::link('open dialog', '#', array(
'onclick'=>'$("#mydialog").dialog("open"); return false;',
)); 
```

# android - PhoneGap/Cordova：震动事件检测不流畅

> ID：11398125
> 
> 赞同：2
> 
> 时间：2012-07-09T15:22:44.320
> 
> 标签：android, ios, cordova, phonegap-plugins

我正在尝试使用 PhoneGap API 检测抖动事件，但我发现程序执行不顺畅。

当我们调用 watchAcceleration 函数时，我们设置了一个代表监视器频率的参数，如：options.frequency = 800;

这是我的问题：使用参数“options.frequency = 800”，设备只会每 0.8 秒监控一次加速度计，但用户可能会在 0.7 秒内完成他的摇动手势，所以我们无法检测到用户的摇动。

您可能会说只是将频率参数变小。但我担心会导致性能损失（需要有人确认）。

然后从一些[文章中](http://wiki.phonegap.com/w/page/16494783/Handling%20Shake%20Events)，我发现有一个参数“acc.is_updating”，我发现它总是“未定义”。

有人知道如何使摇晃的用户体验更流畅吗？或者有什么好的插件来检测摇晃手势？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T04:16:13.287

希望你找到了一些东西。为了将来参考，这里提到了一个[shake.js](https://stackoverflow.com/questions/13809974/how-to-detect-shake-event-with-cordova-android)**插件**，但我使用[它的这个分支](https://gist.github.com/ucavus/5418463)。

# sharepoint - 导入/导出 Nintex Workflow InfoPath 任务表单

> ID：11398129
> 
> 赞同：1
> 
> 时间：2012-07-09T15:22:49.510
> 
> 标签：sharepoint, sharepoint-2010, infopath, infopath2010, nintex-workflow

我在我的开发环境中创建了一个 nintex 工作流，该工作流有一个带有自定义 infopath 表单的 flexi 任务，但是当我将我的工作流导出/导入到暂存环境时，infopath 表单没有被导出。

无论如何，这样做不涉及在其他环境中再次创建表单？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-16T10:21:38.533

我们在 SP 2013 和 Nintex Workflow 2013 上遇到了同样的问题。

虽然有点笨拙，但这对我们有用：

1.  在 dev 中为工作流创建导出。
2.  转到 [exportsite]/NintexWorkflows/[workflowname] 并下载您修改的 Infopath-form
3.  在新环境中导入工作流
4.  转到 [importsite]/NintexWorkflows/[workflowname] 并删除那里可用的 Infopath-form。
5.  上传您在步骤 2 中导出的表单。

现在，当您使用 flexitask 时，应该会显示新表单。

PS：我还没有对此进行测试，但也可以导出整个 NintexWorkflows 库内容（或您的工作流程的一个子文件夹）。您可以使用 Powershell 快速完成此操作。

# php - 逻辑问题 - 一个大盒子中有多少/哪些小盒子 - PHP/MySQL

> ID：11398133
> 
> 赞同：6
> 
> 时间：2012-07-09T15:22:58.887
> 
> 标签：php, mysql, logic, knapsack-problem

我遇到了一个问题，我会尽量用最简单的术语来描述它。

使用 PHP 和 MySQL 的组合我需要完成以下逻辑问题，这是所需内容的简化版本，但简而言之，逻辑是相同的。

思考框。我有很多小盒子，一个大盒子。我需要能够使用许多小盒子来填充大盒子。

所以让我们分解一下。

我在 MySQL 中有一个表，其中包含以下行

```
Table: small_boxes
id | box_size
=============
1  | 100
2  | 150
3  | 200
4  | 1000
5  | 75
..etc 
```

这张桌子可以多达数百个，有些盒子的大小相同

我现在需要填充一个大小为 800 的大盒子，其中包含我在表中找到的所有 small_boxes 组合。大框可以是用户希望填充的任何大小。

这里的目标不是效率，例如，我并不真正关心稍微低于或略高于，只是在公差数字内显示可能适合的盒子的不同变化。

所以如果可能的话，我想了解如何在 PHP/MySQL 中解决这个问题。我在这两方面都很有能力，但问题在于我如何处理这个问题。

例子会很棒，但我很乐意接受一些信息来帮助我开始。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T15:30:12.977

您可能应该研究一下光荣的[背包问题](http://en.wikipedia.org/wiki/Knapsack_problem)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T15:42:27.523

[https://codegolf.stackexchange.com/questions/3731/solve-the-knapsack-problem](https://codegolf.stackexchange.com/questions/3731/solve-the-knapsack-problem)

阅读此内容。

希望你学过代数2..

以下是一些可能对您有所帮助的 PHP 代码：

[http://rosettacode.org/wiki/Knapsack_problem/0-1#PHP](http://rosettacode.org/wiki/Knapsack_problem/0-1#PHP)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-10T00:21:43.440

感谢 maxhd 和 Ugo Meda 为我指明了正确的方向！

结果，我得到了非常接近我需要的东西。我不确定这是否属于“背包问题”或其任何变体，但这是我提出的代码。随意向我提出任何建设性的批评！

为了尝试在背包内获得一些不同的盒子变体，我已经删除了每个主循环迭代中最大的项目，再次，如果有更好的方法，请告诉我:)

谢谢！

```
class knapsack {
    private $items;
    private $knapsack_size;
    private $tolerance = 15; //Todo : Need to make this better, perhaps a percentage of knapsack
    private $debug = 1;

    public function set_knapsack_size($size){
        $this->knapsack_size = $size;
    }

    public function set_items($items){
        if(!is_array($items)){
            return false;
        }

        //Array in the format of id=>size, ordered by largest first
        $this->items = $items;
    }

    public function set_tolerance($tolerance){
        $this->tolerance = $tolerance;
    }

    private function remove_large_items(){
        //Loop through each of the items making sure we can use this sized item in the knapsack
        foreach($this->items as $list_id=>$list){
            //Lets look ahead one, and make sure it isn't the last largest item, we will keep largest for oversize.
            if($list["size"] > $this->knapsack_size && (isset($this->items[$list_id+1]) && $this->items[$list_id+1]["size"] > $this->knapsack_size)){
                unset($this->items[$list_id]);
            }else{
                //If we ever get here, simply return true as we can start to move on
                return true;
            }
        }

        return true;
    }

    private function append_array($new_data,$array){
        if(isset($array[$new_data["id"]])){
            $array[$new_data["id"]]["qty"]++;
        }else{
            $array[$new_data["id"]]["qty"] = 1;
        }

        return $array;
    }

    private function process_items(&$selected_items,$knapsack_current_size){
        //Loop the list of items to see if we can fit it in the knapsack
        foreach($this->items as $list){
            //If we can fit the item into the knapsack, lets add it to our selected_items, and move onto the next item
            if($list["size"] <= $knapsack_current_size){

                $this->debug("Knapsack size is : ".$knapsack_current_size." - We will now take ".$list["size"]." from it");
                $selected_items = $this->append_array($list,$selected_items);
                $knapsack_current_size -= $list["size"];

                //Lets run this method again, start recursion
                $knapsack_current_size = $this->process_items($selected_items,$knapsack_current_size);
            }else{
                //Lets check if we can fit a slightly bigger item into the knapsack, so we can eliminate really small items, within tolerance
                if(($list["size"] <= $knapsack_current_size + $this->tolerance) && $knapsack_current_size > 0){
                    $this->debug("TOLERANCE HIT : Knapsack size is : ".$knapsack_current_size." - We will now take ".$list["size"]." from it");
                    $selected_items = $this->append_array($list,$selected_items);
                    $knapsack_current_size -= $list["size"];
                }
            }

            //Lets see if we have to stop the recursion
            if($knapsack_current_size < 0){
                return $knapsack_current_size;
            }
        }
    }

    private function debug($message=""){
        if(!$this->debug){
            return false;
        }

        echo $message."\n";
    }

    public function run(){
        //If any of the variables have not been set, return false
        if(!is_array($this->items) || !$this->knapsack_size){
            return false;
        }

        //Lets first remove any items that may be too big for the knapsack
        $this->remove_large_items();

        //Lets now check if we still have items in the array, just incase the knapsack is really small
        if(count($this->items) == 0){
            return false;
        }

        //Now that we have a good items list, and we have no items larger than the knapsack, lets move on.
        $variants = array();
        foreach($this->items as $list_id=>$list){
            $this->debug();
            $this->debug("Finding variants : ");

            $selected_items = array();
            $this->process_items($selected_items,$this->knapsack_size);
            $variants[] = $selected_items;

            //Remove the largest variant, so we get a new set of unique results
            unset($this->items[$list_id]);
        }

        return $variants;
    }
}

$products = array(
    array("id"=>1,"size"=>90),
    array("id"=>2,"size"=>80),
    array("id"=>3,"size"=>78),
    array("id"=>4,"size"=>66),
    array("id"=>5,"size"=>50),
    array("id"=>6,"size"=>42),
    array("id"=>7,"size"=>36),
    array("id"=>8,"size"=>21),
    array("id"=>9,"size"=>19),
    array("id"=>10,"size"=>13),
    array("id"=>11,"size"=>7),
    array("id"=>12,"size"=>2),
);

$knapsack = new knapsack();
$knapsack->set_items($products);
$knapsack->set_knapsack_size(62);
$result = $knapsack->run();

var_dump($result); 
```

# php - 将 NULL 变量插入数据库

> ID：11398135
> 
> 赞同：0
> 
> 时间：2012-07-09T15:23:02.957
> 
> 标签：php, mysql, null

我将变量设置为 NULL，我试图将其插入数据库，但由于某种原因，它们一直被提交为“0”。我肯定我试图插入的列允许 NULL，并且默认设置为 NULL。这是我的代码：

```
$insert = NULL;
$query = mysql_query("INSERT INTO `table1` (column1) VALUES ('$insert')") or die(mysql_error()); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T15:26:54.877

> ## 警告：
> 
> 请不要将`mysql_*`函数用于新代码。它们不再被维护并且社区已经开始了[弃用过程](http://goo.gl/KJveJ)。相反，您应该了解[准备好的语句](http://goo.gl/vn8zQ)并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli)。

**如果**您希望它在数据库中`NULL`（并且您**真的仍然*想***使用`mysqli_*`），您可以执行以下操作：

```
$insert = NULL;
$query = mysql_query("INSERT INTO `table1` (column1) VALUES ("
                         .(($insert===NULL)?
                                 "NULL":
                                 "'".mysql_real_escape_string($insert)."'").
                     ")") or die(mysql_error()); 
```

### 但这可能会导致恶意 SQL 注入，因此**不**推荐。

见[鲍比桌](http://bobby-tables.com/)

* * *

所以：总而言之，您**应该使用准备好的语句**。

你可以像这样使用[MySQLi](http://www.php.net/manual/en/mysqli.construct.php)：

```
 $dbHandle = new mysqli(...);
        $query = "INSERT INTO `table1` (column1) VALUES (?)";
        $statement = $dbHandle->prepare($query);
        if($statement){
            $statement->bind_param('s', $insert);
            if(!$statement->execute()){
                echo "Statement insert error: {$statement->error}";
            }
            $statement->close();
        }
        else {
            echo "Insert error: {$dbHandle->error}";
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T15:26:00.100

试试这个静态查询：

```
$query = mysql_query("INSERT INTO `table1` (column1) VALUES (NULL)")  or die(mysql_error()); 
```

使用变量：

```
$insert= NULL;
$insert = ($insert===NULL)? 'NULL' : "'$insert'";
mysql_query("INSERT INTO `table1` (column1) VALUES ($insert)") or die(mysql_error()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T15:24:33.737

尝试不带引号；

```
$query = mysql_query("INSERT INTO `table1` (`column1`) VALUES (".$insert.")") or die(mysql_error()); 
```

查询应该是；

插入`table1`（`column1`）值（NULL）；

# java - Jetty + jax-ws 影响 jsp 编译 - 它现在需要 ant 吗？

> ID：11398138
> 
> 赞同：0
> 
> 时间：2012-07-09T15:23:05.753
> 
> 标签：java, jsp, jax-ws, embedded-jetty

我们刚刚从 Metro 升级到最新的 jax-ws 代码，但由于某种原因，我们现在也不得不发布 ant。这似乎是 jsp 编译所需要的。

没有它，我们得到

```
java.lang.NoClassDefFoundError: org/apache/tools/ant/BuildListener
    at org.apache.jasper.compiler.Compiler.initJavaCompiler(Compiler.java:742)
    at org.apache.jasper.compiler.Compiler.<init>(Compiler.java:131)
    at org.apache.jasper.JspCompilationContext.createCompiler(JspCompilationContext.java:288)
    at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:605)
    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:360)
    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:486)
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:380)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:390)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:440)
    ...... 
```

有没有办法消除对蚂蚁的依赖？

jax-ws 如何影响未更改的 jsp 库？

谢谢尼尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:20:17.620

Jetty 声明“编译器 - 在运行时确定。对于 Jetty 来说，是 eclipse jdt 编译器。” 请参阅[http://docs.codehaus.org/display/JETTY/Jsp+Configuration](http://docs.codehaus.org/display/JETTY/Jsp+Configuration)。

在我们的构建过程中，core-3.1.1.jar 似乎没有被打包（这一定是由 jax-ws 更改引起的）。当这个缺失时，jetty 不会发出警告，而是 jasper 回退到尝试使用 ant（这会导致类未找到异常）。

当我手动将 core-3.1.1.jar 包含到安装中时，jsp 编译工作。

# php - 循环关联的 cookie 并将它们存储在 PHP 中的数组中

> ID：11398141
> 
> 赞同：-1
> 
> 时间：2012-07-09T15:23:08.373
> 
> 标签：php, arrays, cookies

我有一个设置多个 cookie 的小脚本，它们都有这种格式`item_1928` `item_3847` `item_5782`等。

我需要获取以 cookie 开头的所有值`item`并将它们存储在一个数组中。

这是我在 SO 上找到的一些代码，但我不确定它是否是我正在寻找的。它只存储键，但不存储值：

```
$matches = array();
foreach($_COOKIE as $key => $value) {
  if(substr($key, 0, 20) == 'wordpress_logged_in_') {
    $matches[] = $key;
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:28:22.907

你可以试试这个：

```
foreach($_COOKIE as $key => $value) {
  if(strstr($key ,"item_")) {
    $matches[$key] = $value;
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T15:25:50.137

您应该能够像这样修改该代码：

```
$matches = array();
$values = array();
foreach($_COOKIE as $key => $value) {
  if(substr($key, 0, 20) == 'wordpress_logged_in_') {
    $matches[] = $key;
    $values[] = $_COOKIE[$key];
  }
} 
```

然后你将拥有`$values`数组中的所有值（而不是键）。

# c#-4.0 - 将两个属性一对多映射到同一个集合

> ID：11398142
> 
> 赞同：3
> 
> 时间：2012-07-09T15:23:11.043
> 
> 标签：c#-4.0, ef-code-first, entity-framework-4.3

我首先使用 Entity Framework 4.3 代码。如何在 A 类中的两个属性和 B 类中的集合之间创建两个“一对多”关系？

我的模型：

```
public class Shaft
{
    public int Id { get; set; }

    public virtual Coupling FirstEnd { get; set; }
    public virtual Coupling SecondEnd { get; set; }
}

public class Coupling
{
    public int Id { get; set; }

    public virtual ICollection<Shaft> Shafts { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T21:01:52.423

好吧，一对多关系称为**一对多**，因为关系的第一端有**一个**元素，另一端有许多元素。您还可以具有**零或**一对多关系，这仅意味着非多端的元素可以是`null`（或`NULL`在数据库中）。

您要定义的是**一对多**（或者可能是**零或一对多或**一对多）的关系。这样的东西在关系数据库中不存在，在实体框架中也不存在。

当您定义与 EF 的关系时，您总是需要在源类和目标类中**成对**的两个导航属性。可以*省略**其中一个*导航属性，但这并不意味着您可以将此关系的末尾移动到已经属于另一个关系的另一个导航属性。

在您的特定情况下，您有两个关系，因为您的两个导航属性`FirstEnd`和`SecondEnd`in`Shaft`代表两个不同的外键。因此，您要么需要两个集合，`Coupling`要么可以将现有属性`Coupling.Shafts`与其中一个`FirstEnd`或`SecondEnd`不与两者关联。另一个参考将指`Coupling`. （这就是您自己的答案中的映射会发生的情况：EF 将采用覆盖第一个映射块的第二个映射块，在 and 之间创建一个关系`SecondEnd`，`Shafts`然后在`FirstEnd`和未公开的关系之间创建另一个关系`Coupling`，而*不是* `Shafts`再次。）

具有两个集合的解决方案 - 在我看来更有意义 - 看起来像这样：

```
public class Coupling
{
    public int Id { get; set; }

    public virtual ICollection<Shaft> ShaftsWithFirstEndHere { get; set; }
    public virtual ICollection<Shaft> ShaftsWithSecondEndHere { get; set; }
} 
```

而这个映射：

```
modelBuilder.Entity<Coupling>()
    .HasMany(x => x.ShaftsWithFirstEndHere)
    .WithOptional(x => x.FirstEnd);

modelBuilder.Entity<Coupling>()
    .HasMany(x => x.ShaftsWithSecondEndHere)
    .WithOptional(x => x.SecondEnd); 
```

您可以创建一个只读且未映射的辅助属性来将两个集合连接到一个集合，但是在两个导航集合已经加载后，这种连接将在内存中发生：

```
public class Coupling
{
    public int Id { get; set; }

    public virtual ICollection<Shaft> ShaftsWithFirstEndHere { get; set; }
    public virtual ICollection<Shaft> ShaftsWithSecondEndHere { get; set; }

    // not mapped to DB because it has only a getter = readonly
    public IEnumerable<Shaft> Shafts
    {
        get { return ShaftsWithFirstEndHere.Concat(ShaftsWithSecondEndHere); }
    }
} 
```

没有一种映射可以自动进行这种连接。请注意，一对多关系中的导航集合属性只是依赖表中的外键查询的结果（=`Shaft`在您的示例中）。用于填充集合的外键（`Include`例如通过使用或在触发延迟加载时）由关系映射很好地定义，它只是一个键 - 要么是键，`FirstEnd`要么是键，`SecondEnd`但不是两者。您想要实现的是两个不同外键的*两个查询的组合连接结果。*而这对于关系映射是不可能的。

# java - 不自动求和

> ID：11398143
> 
> 赞同：-1
> 
> 时间：2012-07-09T15:23:11.583
> 
> 标签：java

为什么我的 pk 不会在我的数据库中自动 ++？每次我向数据库插入新的详细信息时，我都想让我的 ok 自动 +1 ......

```
public void generatePK(){
        try{
            rsCombineItem = stmtSearch.executeQuery("SELECT * FROM CombineItem;");
            while(rsCombineItem.next()){
                this.pk = rsCombineItem.getInt(1);
            }
            this.pk+=1;
        }
        catch(Exception e){
            JOptionPane.showMessageDialog(null,e);
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:27:33.683

这是您需要在数据库端设置的东西，而不是在您的代码中。将数据库中的列设置为主键，并自动递增！请参阅[示例](http://i.stack.imgur.com/ZfqZB.png)以查看使用 SQL Server 的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T15:29:53.753

目前尚不清楚您要在这里做什么。您谈论插入但显示选择语句；您谈论在数据库中递增，但在代码中递增；你有一个`generatePK`返回的方法`void`；ETC...

简短的回答是**您应该让数据库来处理这个问题**。每个半体面的数据库都明确支持主键，您可以对其进行自动分配和自动递增。只需设置表为您执行此操作，并让数据库在需要时选择（毕竟是任意的）主键。

# javascript - 如何为sencha组件设置多个覆盖模式

> ID：11398146
> 
> 赞同：0
> 
> 时间：2012-07-09T15:23:20.757
> 
> 标签：javascript, extjs

单击时，我的应用程序中有一个按钮，出现一个面板并创建了覆盖窗口，在新创建的面板上，单击时我有另一个按钮打开另一个带有覆盖的窗口。

理想情况下，上面板应阻止对下面板的访问，但仍允许用户访问下面板。

面板 1

```
app.views.EventForm = new Ext.Panel({
    id: 'eventFormPanel',
    layout: 'hbox',
    floating: true,
    modal: true,
}) 
```

面板 2

```
app.views.RecurringOptions= new Ext.Panel({
    id: 'RecurringOptions',
    layout: 'hbox',
    floating: true,
    modal: true,
}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T10:56:20.587

将 hideOnMaskTap 属性设置为 true，这意味着当用户在第二个叠加层之外单击时，它会消失并显示第一个叠加层...

希望能帮助到你

# php - PHP pcntl_fork()：在浏览器中丢失代码

> ID：11398148
> 
> 赞同：0
> 
> 时间：2012-07-09T15:23:25.827
> 
> 标签：php, pcntl

我想使用 pcntl 在 PHP 中实现 bigpipe。但是，当我从浏览器访问网页时出现问题。

测试.php

```
<html>
    <head>
<script type="text/javascript">
    function fill(id,content){ document.getElementById(id).innerHTML=content; }
</script>
    </head>
    <body>
        <div id="1">loading...</div>
        <div id="2">loading...</div>    
<?php
    $pids = array();
    $pids[0] = pcntl_fork();
    if($pids[0]==-1){
        die("failed to fork\n");
    }else if($pids[0] == 0){//child
        sleep(1);
        echo "<script type=\"text/javascript\">fill(\"1\",\"im txx\");</script>\n";
        exit(0);
    }else if($pids[0] > 0){//father
        $pids[1] = pcntl_fork();
        if($pids[1]==-1){
            die("failed to fork\n");
        }else if($pids[1] == 0){//child
            echo "<script type=\"text/javascript\">fill(\"2\",\"im txx!\");</script>\n";
            exit(0);
        }else if($pids[1] >0){//father
            while(pcntl_wait($status)!=-1);
        }
    }
?>
    </body>
</html> 
```

当我在 shell 中键入命令“php test.php”时，输出是正确的：

```
<html>
        <head>
<script type="text/javascript">
        function fill(id,content){ document.getElementById(id).innerHTML=content; }
</script>
        </head>
        <body>
                <div id="1">loading...</div>
                <div id="2">loading...</div>
<script type="text/javascript">fill("2","im txx!");</script>
<script type="text/javascript">fill("1","im txx");</script>
        </body>
</html> 
```

但是当我通过浏览器访问它时，页面来源却出乎意料：

```
<html>
    <head>
<script type="text/javascript">
    function fill(id,content){ document.getElementById(id).innerHTML=content; }
</script>
    </head>
    <body>
        <div id="1">loading...</div>
        <div id="2">loading...</div>    
<script type="text/javascript">fill("2","im txx!");</script> 
```

为什么其余的代码消失了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T15:27:40.463

打印后退出：

```
exit(0); 
```

这将停止执行超出此点的任何代码

删除`exit()`命令

# ruby - Ruby：管理大型 3d 数组的最佳方式

> ID：11398149
> 
> 赞同：0
> 
> 时间：2012-07-09T15:23:35.573
> 
> 标签：ruby, large-data-volumes

我想知道管理大型 3d 数组的最佳方法是：

x = 1000 y = 1000 z = 100

=> 100000000 个对象

每个单元格都是一个包含一定数量数据的对象。

即使所有数据都折叠了，简单的方法也非常冗长（我首先尝试了一个对象数组数组）

```
class Test

    def initialize
        @name = "Test"
    end

end

qtt = 1000*1000*100
Array.new(qtt).each { |e| e = Test.new } 
```

我在某处读到数据库对于这种情况可能是一件好事。

你怎么看待这件事 ？

**我想做什么？**

这个“矩阵”代表一个世界。每个元素都是一个 1mx1mx2m 的块，可能是不同的类型（水、泥、石头……）有些块也可能是空的。

但是用户应该能够在任何地方移除块并改变周围的一切（如果他们后面有水，它会流过孔，例如。

事实上，我想做的不是 Minecraft 成为 DwarfFortress 的一个非常小的克隆（http://www.bay12games.com/dwarves/）

**其他有趣的事情**

在我的模型中，地面处于 10 级。这意味着在大多数情况下，[0,10] 是空旷的天空。在这些层上只能存在丘陵和部分山脉。

地下基本上是未知的，没有被挖掘。所以我们不必为未使用的块添加实例。

我们应该从一开始就添加到模型中：宝石、黄金、水，它们可以存储而无需存储相邻的石头/情绪/土块。

在游戏开始时，*80%*的立方体不需要加载到内存中。

每次我们挖掘我们都会创建新的块：我们挖的空块和周围的块。

我们唯一应该索引的是：

*   地下河
*   地下湖
*   熔岩河

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T19:51:12.547

在内存中保存这么多对象从来都不是一件好事。以平面文件或以数据库为中心的方法会更有效且更易于维护。

# 我会做什么——面向对象的方法

将块的参数存储为简单数据并动态构造对象。

创建一个`Block`类来表示游戏中的块，并为其提供变量以保存该特定块的参数：

```
class Block
  # location of the Block
  attr_accessor :x, :y, :z

  # an individual id for the Block
  attr_accessor :id

  # to define the block type (rock, water etc.)
  attr_accessor :block_type

  # and add any other attributes of a Block...
end 
```

然后，我将创建一些方法，使我能够将数据序列化/反序列化到文件或数据库。

正如您所说，它可以在板上工作，您还需要一个`Board`类来表示它，以保持游戏状态并对`Block`对象执行操作。使用`x, y, z`每个属性，`Block`您可以确定其在游戏中的位置。使用这些信息，您可以在`Block`类中编写一个方法来定位与当前块相邻的那些块。这将使您能够执行您所说的“级联”效果，其中一个块受另一个块的操作影响。

## 高效访问数据

这将完全取决于您选择如何序列化 Block 对象。我可能会选择二进制格式来减少不必要的数据读取并通过其`id`参数存储对象，然后使用[MMIO 之](http://en.wikipedia.org/wiki/Memory-mapped_file)类的东西以类似数组的方式快速对大型数据文件进行随机访问读/写。这将允许您快速有效地访问数据，而不会产生内存开销。您如何读取数据将与您上面的相邻块方法有关。

当然，您也可以选择 DB 存储路径，这将允许您隔离块并以更高级别的方式对特定块进行查找，但这可能会给您带来一些额外的开销。

这听起来像是一个有趣的项目，我希望这会有所帮助！:)

PS关于@Linuxious 上面关于选择不同语言的评论。是的，在某些情况下这可能是正确的，但熟练的程序员从不怪罪他的工具。程序的效率取决于程序员的效率……除非你是用 Java 编写的；）

# iphone - 在 UIScrollView 上滚动时调用重新加载数据

> ID：11398161
> 
> 赞同：2
> 
> 时间：2012-07-09T15:24:15.467
> 
> 标签：iphone, objective-c, ios, ipad

我正在实现一个 UIScrollView，它的行为主要类似于 UITableView，它更高级一些.. 但使用的大多数 API 都是相同的签名.. cellForRowAtIndexPath.. 等等。首先在人们开始讨论为什么不使用 UITableView 之前，让我只是说我不能。原因相当复杂，但这是一个决定。

现在的问题是我正在实现无限滚动，基本上当我向下滚动并且我处于完整 contentHeight 的 65% 时，我正在向后端发出异步请求以获取更多数据并将其添加到数据源，然后调用 reloadData。问题是，如果我在用户滚动时调用 reloadData，它不会提供非常流畅的滚动体验。那么解决这个问题的最佳方法是什么？我还注意到 reloadData 基本上刷新了整个表格视图（在本例中是我的滚动视图）。在我的表格视图单元格中，我正在为 UIImage 设置动画以淡入。因此，当调用 reloadData 时，已经呈现的图像再次淡入，这有点烦人。我该如何避免这样的事情？

有什么提示和技巧吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T15:15:38.913

如果您仍在处理此问题，请查看[PSTCollectionView](https://github.com/steipete/PSTCollectionView)。它的工作方式与 UICollection 视图完全相同，但支持 iOS 4.3 的向后版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:51:37.437

如果不知道为什么需要创建类似于 tableview 的自定义视图，很难回答。如果您有一个开发者帐户，您可能想要检查基于 tableview 的新 iOS 6 视图。不确定我是否可以更多地谈论它，因为它在 NDA 下。

对于 UIImage 淡入淡出，如何将每个 UIImage 标记为显示，然后在重新加载数据或调用淡入淡出语句时进行检查。只淡化未标记为已呈现的图像？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T17:59:22.153

在新的 iOS 6.0 中，有一个新的控制器叫做 UIContainer 视图，它类似于 UITableview 但我们也可以设置多于一列。

该控制器的委托方法与 UITableview 中的几乎相同。如果您有类似的要求，您可以使用该控制器。

# xcode - Cocoa - 存储一个 NSString 值

> ID：11398162
> 
> 赞同：4
> 
> 时间：2012-07-09T15:24:19.990
> 
> 标签：xcode, cocoa, save, storage

我想存储一个从 JSON 请求接收到的 NSString 变量，以备将来使用。因此，当用户再次加载应用程序时，它会加载我存储的那个值（一个 NSString）。

存储此类信息的最佳方式是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-09T15:26:11.380

[NSUserDefaults](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsuserdefaults_Class/Reference/Reference.html)是您正在寻找的。

保存字符串：

```
NSUserDefaults *prefs = [NSUserDefaults standardUserDefaults];
[prefs setObject:theStringToSave forKey:@"keyToLookupString"];
[prefs synchronize]; 
```

检索字符串：

```
NSUserDefaults *prefs = [NSUserDefaults standardUserDefaults];
NSString *theSavedString = [prefs stringForKey:@"keyToLookupString"]; 
```

# asp.net - 在 aspx 页面中打印函数返回值后面的代码

> ID：11398174
> 
> 赞同：1
> 
> 时间：2012-07-09T15:24:52.103
> 
> 标签：asp.net, function, inline, code-behind, css

我确信这是微不足道的，但为什么 Windows 身份验证用户不在我的 ASP.NET 页面内联打印？

函数背后的代码：

```
public string GetCurrentUserWindowsLogin()
{
    string windowsLogin = Page.User.Identity.Name;
    int hasDomain = windowsLogin.IndexOf(@"\");
    if (hasDomain > 0)
    {
        windowsLogin = windowsLogin.Remove(0, hasDomain + 1);
    }
    return windowsLogin;
} 
```

内联代码：

```
<div class="loginDisplay">[ <%#GetCurrentUserWindowsLogin() %> ]</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:27:19.207

`<%#... %>`用于[绑定表达式](http://msdn.microsoft.com/en-us/library/ms178366.aspx)，如`Eval`和`Bind`。

`Page.DataBind()`因此，如果您调用`page_load`它应该可以工作。

应该工作的另一种方法是使用运行正常代码的[代码渲染块：](http://msdn.microsoft.com/en-us/library/k6xeyd4z.aspx)

`<% GetCurrentUserWindowsLogin() %>`

或[`<%= %>`](http://msdn.microsoft.com/en-us/library/6dwsdcf5%28VS.71%29.aspx)用于小块信息的构造：

`<%= GetCurrentUserWindowsLogin() %>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-12T08:11:37.520

只是对上述答案的跟进，<%= 就像 response.write。

[http://msdn.microsoft.com/en-us/library/vstudio/6dwsdcf5(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/vstudio/6dwsdcf5(v=vs.100).aspx)

# c# - 在构造函数中手动添加应用程序启动事件处理程序

> ID：11398175
> 
> 赞同：5
> 
> 时间：2012-07-09T15:24:58.747
> 
> 标签：c#, asp.net, global-asax

在`Global`，作为应用程序的替代方案`AutoEventWireups`，似乎为大多数底层应用程序事件（`BeginRequest, AuthorizeRequest, Error`等）以及一组异步方法（等）公开了事件`AddOnBeginRequestAsync`。但是，我找不到等效的事件`ApplicationStart`！

所以我的问题是，是否有订阅该`AutoEventWireup`方法`Application_(On)Start`所挂钩的“相同”事件？

```
public class Global : HttpApplication
{
    public Global()
    {
        // I can do this ...
        base.BeginRequest += new EventHandler(Global_BeginRequest);
        // Or even AddOnBeginRequestAsync();

        // But how can I do this?
        base.ApplicationStart += new EventHandler(GlobalApplication_Start);
    }

    protected void Global_BeginRequest(object sender, EventArgs e)
    {
      // ...
    }

    protected void Global_ApplicationStart(object sender, EventArgs e)
    {
      // ...
    }
} 
```

（出于兴趣......有没有办法关闭`AutoEventWireups`Global.asax？。使用 AutoEventWireup = "false" 属性似乎只适用于 aspx 页面）

**编辑**- 似乎 ApplicationStart 和 ApplicationEnd “是不代表[HttpApplication 事件](https://stackoverflow.com/questions/720969/when-to-use-application-start-vs-init-in-global-asax?rq=1)的特殊方法”。所以我可能完全找错了树。

**编辑** Re: 为什么我需要这个？不幸的是，一个公司客户有一个框架，新应用程序需要继承他们的自定义`HttpApplication`类，而 FWR，他们`HttpApplication`已经实现了 autowireup `Application_(On)Start`，这意味着我需要找到另一种方法来覆盖框架连接，以便我可以引导我的IoC 容器和 Automapper 映射。根据 Lloyd 的回答，我也可以在 ctor 中进行引导`Init()`，尽管这并不[完全相同](https://stackoverflow.com/questions/720969/when-to-use-application-start-vs-init-in-global-asax?rq=1)。最终，我能够更改公司框架以允许多个订阅。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T16:46:28.727

您可以覆盖初始化：

```
public class MyApplication : HttpApplication
{

    public override void Init()
    {
        base.Init();
    }

} 
```

但是，您的构造函数也可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-13T09:28:14.710

使用 Init 方法要非常小心。

对希望在应用程序生命周期中执行一次的代码使用 Init 方法是一个不好的选择，因为对于 HttpApplication 的每个实例调用一次 Init 方法...

正如您所说，ApplicationStart 和 ApplicationEnd 是不代表 HttpApplication 事件的特殊方法，但是当 AutoEventWireups 设置为 true 时，它​​们的工作方式与 Page 事件类似。

跳转到 .NET 源代码后，我发现 HttpApplicationFactory 类在 Global.asax 文件中查找名为“Application_OnStart”或“Application_Start”的方法，然后使用反射 => ReflectOnMethodInfoIfItLooksLikeEventHandler() 调用它。

查看我关于类似主题的问题：[HttpApplication.Start 事件不存在](https://stackoverflow.com/questions/54650631/httpapplication-start-event-does-not-exist)

# jvm - 如何设置一个非常大的 JVM 堆大小？

> ID：11398179
> 
> 赞同：7
> 
> 时间：2012-07-09T15:25:20.743
> 
> 标签：jvm

根据 JVM 6 文档，服务器类机器默认接收初始堆大小为 1/4 RAM 或 1GB。考虑到我们的 Solaris 64Bit 服务器有 64 GB，初始堆大小将默认为 256MB。因此，我需要使用 XMX 参数手动设置堆大小为 4GB。但是，当我添加“-Xmx4096M”时，Tomcat 不会启动。这是错误消息：

```
Invalid maximum heap size: -Xmx4096M
The specified size exceeds the maximum representable size.
Could not create the Java virtual machine. 
```

我的命令行参数应该是什么才能让我的堆增长到 4GB？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-09T16:07:17.653

感谢您的所有输入，伙计们！虽然，我`java -version`提到的输出`mixed mode`意味着它是 64 位。真正的解决方案是添加`-d64`以强制它以 64 位运行，因此分配 4GB。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-09T15:35:23.070

我的解决方案基于对问题的评论：您使用的是 32 位 JVM，因此它不能处理超过 4GB（不包括在内）。尝试安装64位版本

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-09T15:39:00.073

根据 的输出`java -version`，安装了 32 位 JVM。如果它是 64 位的，你应该得到类似`Java HotSpot(TM) 64-Bit Server VM`.

尝试安装 64 位 JVM，它将解决您的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-22T10:20:12.057

使用 -Xmx1024M -XX:MaxPermSize=256M

# flash - 我可以在没有源 FLA 文件的情况下更改 SWF 中的 ActionScript 字符串文字吗？

> ID：11398180
> 
> 赞同：1
> 
> 时间：2012-07-09T15:25:25.737
> 
> 标签：flash, actionscript, swf-decompiler

一位客户要求我将他们的一个主要基于闪存的旧网站移至新服务器。

多年前该网站的原始开发者犯了一个错误，在一些 ActionScript 的一个重要链接中使用了“http://127.0.0.1/....”。原来的开发公司早已不复存在。

我能够使用[Sothink SWF Decompiler](http://www.sothink.com/product/flashdecompiler/)对 SWF 进行反编译，并找到并纠正有问题的 ActionScript。但是，我无法重新编译回完全正常工作的 SWF（出现许多其他错误，因为它是一个复杂的 Flash 项目）。我尝试了不同的 Flash 版本（回到 v.6），SWF 的第 4 个字节表明它最初是 v.7（MX2004），并且我尝试将重新编译的输出中的十六进制字节与原始字节匹配（考虑到用于标签压缩等）到目前为止，没有任何匹配项。

我需要很长时间才能修复重新编译的 Flash 中的所有其他错误，而我真正想做的只是更改原始 SWF 中的一个字符串文字，以便该站点完全按照最初的预期工作。如果有必要，我准备使我的新文字的字符串长度与旧的不正确的字符串长度完全匹配（通过在新服务器上添加一个目录/符号链接链接回正确的文件）。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-26T19:04:45.830

这是一个免费的应用程序，它可以满足您的需求，它也应该可以更好地工作。

[http://www.free-decompiler.com/flash/](http://www.free-decompiler.com/flash/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T09:32:59.407

[URL 动作编辑器](http://buraks.com/uae/)运行良好。在不破坏任何其他内容的情况下更改了字符串文字（与其他帖子中提到的其他工具/反编译器不同）。

# fitnesse - 从命令行运行 Fitnesse 测试

> ID：11398181
> 
> 赞同：4
> 
> 时间：2012-07-09T15:25:34.437
> 
> 标签：fitnesse

通过命令行运行 Fitnesse 测试时，出现 ClassNotFound 异常

由 Java.lang.ClassNotFoundException:fitnesse.runner.testRunner 引起

找不到主类：fitnesse.runner.TestRunner.Program 将退出

请帮助

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-20T04:17:57.217

不再支持 TestRunner。使用[http://fitnesse.org/FitNesse.UserGuide.CommandLineRestCommands](http://fitnesse.org/FitNesse.UserGuide.CommandLineRestCommands)

更新：链接已更改 - [http://www.fitnesse.org/FitNesse.UserGuide.ControllingFitNesseFromTheCommandLine](http://www.fitnesse.org/FitNesse.UserGuide.ControllingFitNesseFromTheCommandLine)

更新：链接再次更改 - [http://fitnesse.org/FitNesse.UserGuide.AdministeringFitNesse.ControllingFitNesseFromTheCommandLine](http://fitnesse.org/FitNesse.UserGuide.AdministeringFitNesse.ControllingFitNesseFromTheCommandLine)

摘自 Fitnesse 文档：

> 您可以使用 -c 命令行选项从命令行运行任何 REST 命令（请参阅 Restful Services），如下所示：
> 
> java -jar Fitnesse-standalone.jar -c
> 
> 这会启动 Fitnesse，运行命令，将输出发送到标准输出，然后退出。
> 
> 大多数情况下，您将使用它从命令行运行测试和/或套件，如下所示：
> 
> java -jar Fitnesse-standalone.jar -c "MyTestPage?test&format=text"

# apache - /index.php/foo 的奇怪行为

> ID：11398183
> 
> 赞同：0
> 
> 时间：2012-07-09T15:25:38.733
> 
> 标签：apache, mod-rewrite

[我在http://www.mywebsite.com/~me/](http://www.mywebsite.com/~me/)有一个网站，我想要这些行为：

1.  [http://www.mywebsite.com/~me/index.php](http://www.mywebsite.com/~me/index.php)应该重定向到[http://www.mywebsite.com/~me/](http://www.mywebsite.com/~me/)

2.  指向不存在的东西的 URL 应该重定向到[http://www.mywebsite.com/~me/404.php](http://www.mywebsite.com/~me/404.php)

在寻找解决方案时，我发现这些片段包含在我的 httpd.conf 文件中：

```
Options +FollowSymLinks
DirectoryIndex index.php

RewriteEngine On
RewriteBase /~me/
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /~me/index\.php\ HTTP/
RewriteRule ^index\.php$ http://www.mywebsite.com/~me/ [R=301,L] 
```

和

```
ErrorDocument 404 /~me/404.php 
```

这些片段可以很好地创建行为 1，并且在大多数情况下也可以创建行为 2。但是，不是[http://www.mywebsite.com/~me/index.php/foo](http://www.mywebsite.com/~me/index.php/foo)重定向到 404 页面，而是重定向到[http://www.mywebsite.com/~me/index.php](http://www.mywebsite.com/~me/index.php)。

我将如何更改这些片段以获得我想要的行为？

# actionscript-3 - 使用空气原生扩展来显示一个简单的原生按钮？

> ID：11398186
> 
> 赞同：0
> 
> 时间：2012-07-09T15:25:43.827
> 
> 标签：actionscript-3, button, air, air-native-extension

我主要是一名 AS3 编码员，我对 Java 的了解足以能够为 Vibration、Toast、对话框和那些简单的东西构建我自己的 ANE 文件......

使用空气原生扩展很酷，但我有点失望不能用它创建一个简单的按钮。

我知道创建一个简单的本机按钮是一件愚蠢的事情，因为直接在空中创建按钮非常容易，但我以它为例。

所以问题是是否可以创建 .ane 来在 android 中调用本机 Button？有吗？

似乎我无法创建任何 .ane 文件，而不是像推送通知这样的抽象工具或像进度条和对话框这样的窗口这样的弹出窗口。

说不能用 air 原生扩展创建一个简单的原生按钮是对的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T04:32:53.283

对于那些想知道为什么不能使用扩展调用简单按钮的人，请阅读[http://adobe.com/devnet/air/articles/extending-air.html](http://adobe.com/devnet/air/articles/extending-air.html)（向下滚动到限制），其中说：扩展不能直接集成交互式对象，如原生 UI 控件，带有显示列表。（其他项目，例如本机对话框，可能会起作用，具体取决于平台。）

# ruby-on-rails - 将设计 gem 身份验证与移动应用程序 (Titanium) 一起使用时出现问题

> ID：11398187
> 
> 赞同：0
> 
> 时间：2012-07-09T15:25:44.083
> 
> 标签：ruby-on-rails, titanium-mobile

我在我的 Rails 应用程序中使用 Devise gem 进行身份验证。我可以通过以 Json 请求格式传递数据来创建用户，以从 Titanium 移动应用程序设计 Rails 应用程序。但是当我尝试在移动应用程序中设置登录以使用设计时，它显示如下错误

```
{"error":"You need to sign in or sign up before continuing."} 
```

我的代码如下所示

```
var regDetails = '{"email": "'+userNmTxt.value+'", "password": "'+passwordTxt.value+'"}';
       var client = Titanium.Network.createHTTPClient({timeout: 5000});
       client.open("POST", "http://10.100.85.43:3000/session/create");
       client.setRequestHeader("Content-Type", "application/json");
       client.send(regDetails);        
       client.onload = function(e)
       {
               alert('Logged in successfully' + this.responseText);
       }
       client.onerror = function(e)
       {
               alert('On error' + this.responseText);
       } 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T09:22:10.267

我找到了解决方案，我在`routes.rb`文件中丢失了一些路由信息

```
devise_scope :user do
   match "/session/create" => "session#create" #, :via => [:get, :post]
   match "/session/destroy" => "session#destroy" #, :via => [:get, :post] 
   match "/registration/create" => "registration#create" #, :via => [:get, :post]
end 
```

希望这会对某人有所帮助:)

# firefox - 自定义后重新加载

> ID：11398190
> 
> 赞同：1
> 
> 时间：2012-07-09T15:25:51.747
> 
> 标签：firefox, firefox-addon, firefox-addon-sdk

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T23:24:02.267

验证为错误，请参阅：[bugzilla.mozilla.org/show_bug.cgi ?id=773297](http://bugzilla.mozilla.org/show_bug.cgi?id=773297)

# java - 有没有办法让 Eclipse 自动使我的所有变量成为最终变量？

> ID：11398194
> 
> 赞同：21
> 
> 时间：2012-07-09T15:26:05.007
> 
> 标签：java, eclipse, plugins

我尽量避免使用非最终变量，如果 Eclipse 会为我自动执行此操作，它会节省一些输入（所以我不会忘记这样做）。我想要它检测我何时添加新的变量赋值/声明语句，并在完成后立即插入`final`修饰符。

是否有可以实现此目的的配置选项或轻量级插件？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-07-09T15:32:22.137

您可以将其添加为“**保存操作**”，这样每当您保存文件时，Eclipse 都会将其添加`final`到您的变量中。这是如何：

*   转到**窗口 > 首选项 > Java > 编辑器 > 保存操作**
*   勾选**其他操作**并按**配置**
*   在**代码样式**选项卡中有一个关于**变量声明**的部分，您可以在可能的情况下勾选**使用修饰符“最终”**。您可以在私有字段、参数和局部变量之间进行选择。

**或者您可以通过清理**手动执行相同的操作（每隔一段时间或针对现有代码库）

 *** * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-09T15:28:43.037

您可以使用右键单击--> 源--> 清理。您应该首先在首选项的代码格式化程序部分中定义您真正想要清理的内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-09T15:33:30.190

`Checkstyle`插件可以为您做到这一点。您必须先设置您的 checkstyle 配置，然后在您的项目中启用 checkstyle，并让它在保存 java 文件时更改您的代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-09T15:31:25.400

这可能不是最强大的解决方案，但对于您经常使用的原语和/或类型，您可以定义宏

```
int --> final int
byte[] --> final byte[]
List --> final List 
```

我也很喜欢格式化程序的想法，但是您必须接受它具有的所有其他格式，这可能很麻烦。**

# html - 我正在尝试将未知变量从一个 HTML 页面传递到另一个 HTML 页面

> ID：11398197
> 
> 赞同：0
> 
> 时间：2012-07-09T15:26:08.477
> 
> 标签：html, coldfusion

这是我在第一页上的代码

```
<body onload=setTimeout("location.href='http://64.124.162.184/TrenaTest/testformtwo.htm'?UniqueNum=#form.UniqueNum#",3000) bgcolor="#FFFFFF"> 
```

然后当我转到下一页时，我有

```
<cfif isdefined("form.UniqueNum") and len(form.UniqueNum)> 
#form.UniqueNum# 
</cfif> 
```

它没有给我任何我刚刚得到的错误`NULL`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T15:36:12.757

请改用 url.uniqueNum。由于您在 url 参数中传递它，因此它不在表单范围内，而是在 url 范围内。

就像 Scott 所说，您需要将变量嵌套在 cfoutput 标记中以便它们显示。为了帮助您进行故障排除，您可以转储范围以查看它们是什么：

```
<cfdump var="#variables#">
<cfdump var="#form#">
<cfdump var="#url#">
<cfdump var="#session#">
<cfdump var="#application#">
<cfdump var="#server#"> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-10T13:21:10.267

你有一个 JS 语法错误，在错误的位置打了一个勾。

```
<body onload=setTimeout("location.href='http://64.124.162.184/TrenaTest/testformtwo.htm'?UniqueNum=#form.UniqueNum#",3000) bgcolor="#FFFFFF"> 
```

.htm 之后的那个单勾可能是你的罪魁祸首。将它移到最后 - 在 #form.uniqueNum# 之后，它看起来像这样：

`<body onload=setTimeout("location.href='http://64.124.162.184/TrenaTest/testformtwo.htm?UniqueNum=#form.UniqueNum#'",3000) bgcolor="#FFFFFF"`>

然后，正如蒂姆所说，您的变量将在*URL*范围内 - 而不是在*表单*范围内（这是 GET 而不是 POST）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-09T16:47:45.900

尝试将#form.uniqueNum# 包装在<cfoutput> 标记中，否则它只会发送字符串“#form.uniqueNum#”而不是form.uniqueNum 的值。

可能还想确保该值也事先存在，也许使用 <cfparam>。

另外，什么是“下一页”？我假设您的意思是“触发”超时时会发生什么。该页面具有 .htm 文件扩展名，因此 ColdFusion 不太可能对其进行处理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-10T13:54:05.210

嘿，为什么你的页面是“testformtwo.htm **”**。它应该是testformtwo。我想**cfm 。**除非您已将 htm 映射为服务器配置中的 cfm 进行处理。

# javascript - 试图进行 Ajax 调用的 JQuery 错误

> ID：11398202
> 
> 赞同：0
> 
> 时间：2012-07-09T15:26:15.833
> 
> 标签：javascript, jquery, ajax, sharepoint-2010

我正在处理一个 SharePoint 项目。我想使用 JQuery 从主页进行 ajax 调用。但是，当我拨打电话时，我收到**“Array.prototype.slice: 'this' is not a JavaScript object”错误。**

这是我正在使用的文件广告代码：homepage.js/

```
$(document).ready(function () {

   Ajax.GetWeather();
}); 
```

Ajax.js/

```
 ns.GetWeather = function () {
   alert("yep");
    $.ajax({
        data: $.extend({
            Function: "GetWeather"
        }),
        type: 'POST',
        success: function (json) {

            //$('#ContentMain').append(json.LoginMainHtml);
            //$('#ContentSide').append(json.LoginSideHtml);
            alert("hmmmm");
            ns.HideUpdateStatus();
        }
    });
}; 
```

14/模板/布局/GWR/Ajax.ashx/

```
 <%@ WebHandler Language="C#" Class="ajax" %>

     using System;
     using System.Reflection;
     using System.Web;

     /**
     * Ajax.ashx
     * 
     * Enables client callback resource to client javascript.
     * Functions are relayed to DataManager for processing.
     */
     public class ajax : IHttpHandler 
     {
      /// <summary>
      /// Processes the client request
      /// </summary>
      public void ProcessRequest (HttpContext context) 
      {
        // Set the content type so the client's browser will handle the response correctly
        context.Response.ContentType = "text/json";

        // Get the function name from the request GET/POST parameters
        string function = context.Request["Function"];
   context.Response.Write(function);
}
    } 
```

数据管理器.cs/

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Web.Script.Serialization;
using System.Web;

namespace GWR
{
  class DataManager: Util
  {

    #region Properties
    /// <summary>
    /// Accesses the Request object
    /// </summary>
    private static HttpRequest Context
    {
        get { return HttpContext.Current.Request; }
    }
    #endregion

    #region GetWeather
    public static string GetWeather()
    {
        return ToJson(new
        {
            //LoginSideHtml = RenderUserControl("LoginSide.ascx", null),
            //LoginMainHtml = RenderUserControl("LoginMain.ascx", null)
            AlertHTML = "<h1>Got Here Alert Weather</h1>",
            CurrentHTML = "<h2>Got here current weather",
            FiveDayHTML = "<h3>5 day forcast</h3>"

        });
    }

    #endregion

    #region ToJson
    /// <summary>
    /// Converts an object into JSON compatible form
    /// </summary>
    /// <param name="o"></param>
    /// <returns></returns>
    public static string ToJson(object o)
    {
        JavaScriptSerializer serializer = new JavaScriptSerializer();

        return serializer.Serialize(o);
    }
    #endregion
  } 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:31:41.520

这个：

```
data: $.extend({
        Function: "GetWeather"
    }) 
```

应该：

```
data: $.extend({},{
        "Function": "GetWeather"
     }) 
```

或者：

```
data: {"Function":"GetWeather"} 
```

或者：

```
data: "Function=GetWeather" 
```

# html - 多行Base64背景图像？

> ID：11398205
> 
> 赞同：8
> 
> 时间：2012-07-09T15:26:18.547
> 
> 标签：html, css

是否可以将**base64**背景图像放在多行而不是一长行中？如果是这样，怎么做？

我当前的正文 CSS 是：

```
body {
  background-color:  #FFFFFF;
  background-image:  url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAIAAABLbSncAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZSURBVBhXY/iABP4jAQYqSiCbi2wsA/UkAIeAuaFCb0TzAAAAAElFTkSuQmCC);
  background-repeat: repeat;
  height: 100%;
} 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-09T15:32:05.113

将您的代码放在引号之间并在换行之前放置一个反斜杠。

```
body {
    background-color:  #FFFFFF;
    background-image:  url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUg\
    AAAAgAAAAICAIAAABLbSncAAAAAXNSR0IArs4c6QAAAARnQ\
    U1BAACxjwv8YQUAAAAJcEhZcwAADs\
    MAAA7DAcdvqGQAAAAZSURBVBhXY/iABP4j\
    AQYqSiCbi2wsA/UkAIeAuaFCb0TzAAAAAElFTkSuQmCC');
    background-repeat: repeat;
    height: 100%;
} 
```

# wix - WIX MajorUpgrade 和返回码

> ID：11398206
> 
> 赞同：0
> 
> 时间：2012-07-09T15:26:22.137
> 
> 标签：wix, windows-installer

我正在编写一个安装程序，其中还包含使用 WIX 构建的 MSI 包。我在运行 msiexec 后检查返回代码并跳过一些错误代码。例如，当返回码为 1638（产品已安装）时，用户不应收到错误消息

但是当安装旧版本的产品时，返回码是 1603（未知错误）。我也想跳过这种情况（用户已经获得更新版本）

蜡码是

```
<Upgrade Id="<GUID>">
    <UpgradeVersion Minimum="$(var.product_version)" OnlyDetect="yes" Property="NEWERFOUND" />
    <UpgradeVersion Minimum="0.1.0" IncludeMinimum="yes" Maximum="$(var.product_version)" IncludeMaximum="no" Property="SELFFOUND" />
</Upgrade>

<MajorUpgrade DowngradeErrorMessage=You have installed newer version $(var.product_name)." /> 
```

问题是当 SELFFOUND 或 NEWERFOUND 属性被激活时，我如何才能返回另一个代码而不是 1603

更新：我不想影响返回码，我想得到适当的代码而不是一般的致命错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T18:48:35.727

您无法控制`msiexec.exe`. 它的返回代码[已记录在案](http://msdn.microsoft.com/en-us/library/windows/desktop/aa368542%28v=vs.85%29.aspx)，并且列表很全面。该服务根据安装状态确定退出代码。

**更新：**我唯一能建议的是直接使用数据库函数：

1.  [`MsiOpenPackage`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa370339(v=vs.85).aspx)， 和
2.  [`MsiDoAction("FindRelatedProducts")`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa370090(v=vs.85).aspx)运行将通过处理[升级表](http://msdn.microsoft.com/en-us/library/windows/desktop/aa372379(v=vs.85).aspx)[`FindRelatedProducts`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa368600(v=vs.85).aspx)来评估`SELFFOUND`和`NEWERFOUND`属性的操作。
3.  然后用 分析属性[`MsiGetProperty`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa370134(v=vs.85).aspx)。
4.  用 关闭包[`MsiCloseHandle`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa370067(v=vs.85).aspx)。

使用获得的 和 的值`SELFFOUND`，`NEWERFOUND`您可以决定是否需要安装产品。如果是，您可以运行`msiexec.exe`或使用[`MsiInstallProduct`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa370315(v=vs.85).aspx).

[Disclamer: I have never tried to do anything like this, and I am not sure it will work. It should, yet it does not look easy.]

# drag-and-drop - 拖放到其他应用程序和操作系统？

> ID：11398207
> 
> 赞同：4
> 
> 时间：2012-07-09T15:26:22.867
> 
> 标签：drag-and-drop, javafx-2

我在我的应用程序中使用 JavaFX 的[拖放系统](http://docs.oracle.com/javafx/2/drag_drop/jfxpub-drag_drop.htm)，到目前为止它运行良好。

现在我想支持拖放到外部应用程序，例如。将文件从我的应用程序拖到资源管理器中。我将如何实现这一目标？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T20:04:52.090

我已经通过使用实现了您所描述的：

```
Vector<File> files = new Vector<File>();
private ClipboardContent filesToCopyClipboard = new ClipboardContent();

...

final ObjectWithAReturnablePathField draggableObj = new ObjectWithAReturnablePathField();

...

draggableObj.setOnDragDetected(new EventHandler<MouseEvent>()
{

    @Override
    public void handle(MouseEvent me) 
    {
        Dragboard db = draggableObj.startDragAndDrop(TransferMode.ANY);
        try 
        {
           File f = new File(new URI(draggableObj.getFilePath()));
           files.add(f);
           filesToCopyClipboard.putFiles(files);
        } 
        catch (URISyntaxException e) 
        {
           e.printStackTrace();
        }
        db.setContent(filesToCopyClipboard);
        me.consume();
    }

 });
 draggableObj.setOnDragDone(new EventHandler<DragEvent>() 
 {
     @Override 
     public void handle(DragEvent me) 
     {

        me.consume();
      }
 }); 
```

意思是：

通过使用任何可返回文件路径的可拖动对象（任何节点）的 setOnDragDetected 方法上的 TransferMode.ANY 使用列表填充 ClipboardContent，可以实现 JavaFX 2 和本机应用程序之间的文件传输。在我的例子中，我创建了一个名为 Thumb 的类来扩展 ImageView，并且（除其他外）我创建了一个名为 getFilePath() 的方法，它从用于初始化 ImageView() 的 Image 返回路径。对于糟糕的例子和糟糕的英语，我很抱歉顺便说一句，但到目前为止，我已经没有时间给出更详细的答案了。我希望它有所帮助。干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-11T19:54:39.660

这是一个操作侦听器的示例源，用于将 ImageView 图像提取到操作系统的资源管理器（使用 jpg 图像的自定义过程来删除 alpha 通道以正确显示它）：

```
inputImageView.setOnDragDetected(new EventHandler <MouseEvent>() {
               @Override
               public void handle(MouseEvent event) {

                   // for paste as file, e.g. in Windows Explorer
                    try {

            Clipboard clipboard Clipboard.getSystemClipboard();     
                   Dragboard db = inputImageView.startDragAndDrop(TransferMode.ANY);

                   ClipboardContent content = new ClipboardContent();

                   Image sourceImage = inputImageView.getImage();

                   ImageInfo imageInfo = (ImageInfo) inputImageView.getUserData();

                   String name = FilenameUtils.getBaseName(imageInfo.getName());
                   String ext = FilenameUtils.getExtension(imageInfo.getName());

                   ///Avoid get "prefix lenght too short" error when file name lenght <= 3
                   if (name.length() < 4){
                       name = name+Long.toHexString(Double.doubleToLongBits(Math.random()));;
                       }

                   File temp = File.createTempFile(name, "."+ext);

                   if (ext.contentEquals("jpg")|| ext.contentEquals("jpeg")){
                       BufferedImage image = SwingFXUtils.fromFXImage(sourceImage, null); // Get buffered image.
                       BufferedImage imageRGB = new BufferedImage(image.getWidth(),image.getHeight(),
BufferedImage.OPAQUE);
                       Graphics2D graphics = imageRGB.createGraphics();
                       graphics.drawImage(image, 0, 0, null);
                       ImageIO.write(imageRGB, ext, temp);
                       graphics.dispose();

                       ImageIO.write(imageRGB,
                               ext, temp);  

                   }else{

                       ImageIO.write(SwingFXUtils.fromFXImage(sourceImage, null),
                               ext, temp);  
                   }

                   content.putFiles(java.util.Collections.singletonList(temp));
                   db.setContent(content);
                   clipboard.setContent(content);
                   event.consume();

                   temp.deleteOnExit();

                    } catch (IOException ex) {
                           System.out.println(ex.getMessage());
                     }

               }
           }); 
```

借助传递给 imageView 的 setUserData 方法的对象，它可以帮助我检索数据库 ID 和图片名称：

```
 public class ImageInfo {
    private String imageInfo;
    private int inputId;

    @Override
    public String toString() {
        return imageInfo;
    }

    public ImageInfo(String imageInfo, int inputId) {
        this.imageInfo = imageInfo;
        this.inputId = inputId;
    }

    public String getName() {
        return imageInfo;
    }

    public void setName(String imageInfo) {
        this.imageInfo = imageInfo;
    }

    public int getIndex() {
        return inputId;
    }

    public void setIndex(int areaindex) {
        this.inputId = inputId;
    }
} 
```

我希望它会在预期的时间帮助某人:-)

问候

# c# - 为什么 null 合并运算符会破坏我在 c# 中的字符串分配？

> ID：11398208
> 
> 赞同：5
> 
> 时间：2012-07-09T15:26:26.207
> 
> 标签：c#, asp.net

我正在 Web 表单中创建一个查询字符串，并且我正在处理来自可能为空的参数的值。有很多方法可以检查和修复这些问题，但我发现最优雅的方法如下：

```
string pass;
pass = "BillabilityDetail.aspx?_startDate=" + _startDate.Text + "&_endDate=" + _endDate.Text + 
       "&_isContractor=" + _isContractor.SelectedValue + "&_busUnit=" + _busUnit.Text 
       + "&_projectUnit=" + _projectUnit.SelectedValue + "&_leadCon=" + _leadCon.Value ?? -1
       + "&_acctExec=" + _acctExec.Value ?? -1 + "&_isBillable=" + _isBillable.SelectedValue + 
       "&_isActive=" + _isActive.SelectedValue + "&_include=" + _include.SelectedValue; 
```

唯一的问题是……它不起作用。当代码到达这部分时，

```
"&_leadCon=" + _leadCon.Value ?? -1 + "&_acctExec=" + _acctExec.Value ?? -1 
```

字符串停止赋值。所以字符串将以 &_leadCon= 结尾。我知道解决这个问题的方法，但我不知道为什么它首先停止工作。有小费吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-09T15:28:24.797

的`+`优先级高于`??`，因此您需要将空合并表达式括在括号中。

```
"&_leadCon=" + (_leadCon.Value ?? -1) + "&_acctExec=" + (_acctExec.Value ?? -1 ) 
```

[请参阅此处的优先级图表](http://msdn.microsoft.com/en-us/library/6a71f45d.aspx)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-07-09T15:28:14.013

尝试使用括号准确地告诉编译器您的意思。

例如：

```
"&_leadCon=" + (_leadCon.Value ?? -1) + "&_acctExec=" + (_acctExec.Value ?? -1) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-09T15:29:30.783

您需要添加大括号，即

```
"&_leadCon=" + (_leadCon.Value ?? -1) + "&_acctExec=" + (_acctExec.Value ?? -1) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-09T15:31:16.867

如果您查看[C# 中运算符的优先级](http://msdn.microsoft.com/en-us/library/aa691323%28v=vs.71%29.aspx)（[此处更新更多但实用性稍差的版本](http://msdn.microsoft.com/en-us/library/6a71f45d.aspx)），您会看到`+`上面的内容`??`。

这意味着您实际上是在要求将您的大部分陈述`??`视为一个块。

所以，

```
string test = "hello" + value ?? "this is" + " a test" 
```

实际上意味着：

添加`"hello"`，`"this is" + " a test"`如果`value`为空则添加，否则添加`value`自身。

因此，正如其他答案所说，您可能希望在其中使用括号。我只是想我会尝试再解释一下。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-07-09T15:31:36.420

问题比你想象的要多：

1.  正如你所说，它不起作用
2.  大约有 20 个字符串创建（srting 是不可变的，`string`+`string`创建一个新字符串并将字符串的内容复制到其中，因此复制*大量*内存）。然而，C# 编译器为你做了优化，所以这次你很幸运。
3.  勉强可读

考虑使用[`String.Format`](http://msdn.microsoft.com/en-en/library/system.string.format.aspx)方法。

```
string urlTemplate = 'BillabilityDetail.aspx?_startDate={0}&_endDate={1}';
pass = String.Format(urlTemplatel, _startDate.Text, _endDate.Text); 
```

此外，正如其他人指出的那样，存在运算符优先级错误（`+`优先级高于`??`），但这种方法没有它，因为那些合并运算符将驻留在参数构造中。

# android - 带有 SimpleCursorAdapter 的空 ListView

> ID：11398214
> 
> 赞同：0
> 
> 时间：2012-07-09T15:26:50.107
> 
> 标签：android, listview, simplecursoradapter

需要你的帮助。我有类 ExternalDbOpenHelper，我在其中连接到我的 SQLite 数据库。连接成功。在我的活动中，我想选择 4 列的数据并在 ListView 中键入它。我在 fillFields() 方法中使用 SimpleCursorAdapter。但我在我的设备上只看到空白字段。但是设备上的字段数等于数据库中的行数。请告诉我我的错误在哪里？ListView中是否需要使用ArrayList或其他容器来输入数据？

```
 public class IdevOwnSqliteDbActivity extends Activity {
      private static final String DB_NAME = "SergBase.db";
      final String LOG_TAG = "myLogs";
     private SQLiteDatabase database;
     private ListView listView;
     private ArrayList<String> fields;
      String sqlQuery = "select orders_products.products_id as   _id,orders_products.products_name as Name,orders_products.final_price as FinalPrice,    orders_status_history.date_added as Date"
        + " " +"from orders_products"
        + " "+"inner join orders_status_history"
        + " "+"where orders_products.orders_id=orders_status_history.orders_id";    
   public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    listView = (ListView)findViewById(R.id.list);
    ExternalDbOpenHelper dbOpenHelper = new ExternalDbOpenHelper(this, DB_NAME);
    database = dbOpenHelper.openDataBase();
    fillFields();
}
    private void fillFields() {

    //list = new ArrayList<DataContainer>();
    Cursor fieldsCursor = database.rawQuery(sqlQuery, null);
    Log.d(LOG_TAG, "Hello world!" );
    Log.d(LOG_TAG, fieldsCursor.getColumnName(3) );

    fieldsCursor.moveToFirst();
    if(!fieldsCursor.isAfterLast()) {
        do {
            String name = fieldsCursor.getString(1);
            fields.add(name);

        } while (fieldsCursor.moveToNext());

    }
    String[] columns= new String[] {fieldsCursor.getColumnName(0), fieldsCursor.getColumnName(1), fieldsCursor.getColumnName(2),fieldsCursor.getColumnName(3)};
    int[] to = new int[]{R.id.ProductID,R.id.ProductName,R.id.FinalPrice, R.id.Date};
    startManagingCursor(fieldsCursor);
     SimpleCursorAdapter adapter = new SimpleCursorAdapter(this,android.R.layout.simple_list_item_1, 
              fieldsCursor, 
              columns, 
              to);
    System.out.println(fieldsCursor.getColumnName(2));
    listView.setAdapter(adapter); 
```

}

# php - PHP 变量可以在本地环境中读取，但不能在实时环境中读取

> ID：11398229
> 
> 赞同：0
> 
> 时间：2012-07-09T15:27:54.107
> 
> 标签：php

我在我的笔记本电脑上运行了一个本地服务器，我在上面测试我的站点，当我将当前站点上传到实时服务器时，我注意到部分损坏了。我发现错误是由这样操作的函数引起的

```
$other=1;
function example(){
$variable =1+$other;
return $variable;
} 
```

但是，如果我将变量 $other 放入函数中，它就可以正常工作。显然，本地服务器上的设置与现场相比有不同的设置，但是是什么导致了这种情况发生呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:17:30.387

您需要在函数中注入参数：

```
function example($other){
    $variable = 1 + $other;

    return $variable;
}

$other = 1;
example($other); 
```

您可能想了解 PHP 中的作用域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T15:31:11.573

你应该定义像**function test()**而不是 function($) 这样的函数

# excel - 尝试插入日期时出现运行时错误“1004”

> ID：11398230
> 
> 赞同：1
> 
> 时间：2012-07-09T15:27:54.950
> 
> 标签：excel, vba

我有这个脚本，我一直收到一个错误：`Run-time error '1004': Method 'Range' of object _'Worksheet' failed`

这是脚本：

```
Option Explicit
    Sub ONJL()

    Dim lastrow As Long
    Dim wsRD As Worksheet 'Raw Data

    Set wsRD = Sheets("Raw Data")

        With wsRD
            Application.ScreenUpdating = False
            lastrow = wsRD.Range("J:J").End(xlUp).Offset(1, 0)
            wsRD.Range("J" & lastrow).Value = "=Today()"
        End With

    End Sub 
```

我认为这就是您要查找最后一行，然后将今天的日期粘贴到最后一个单元格的方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:37:20.153

有几个问题：

*   使用时`with`，需要使用`.`
*   的结果`Offset(x,y)`是一个范围，而不是一个数字 - 你对行感兴趣，所以你需要添加`.Row`
*   事情必须从`End(xlUp)`最后一行开始工作

这可能是你的意思：

```
Sub ONJL()

    Dim lastrow As Long
    Dim wsRD As Worksheet 'Raw Data

    Set wsRD = Sheets("Raw Data")

    With wsRD
        Application.ScreenUpdating = False
        lastrow = .Range("J" & .Rows.Count).End(xlUp).Row
        .Range("J" & lastrow + 1).Formula = "=Today()"
    End With

End Sub 
```

并且不要忘记在某处打开屏幕更新。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T16:01:09.713

`lastrow`被声明为 Long 变量，但`Offset`返回一个`Range`对象。属性为您提供行的`Row`数值。

```
Sub ONJL()

  Dim lastrow As Long
  Dim wsRD As Worksheet  'Raw Data

  Set wsRD = Sheets("Raw Data")

  With wsRD
    Application.ScreenUpdating = False
    lastrow = .Cells(Rows.Count, 10).End(xlUp).Offset(1, 0).Row
    .Range("J" & lastrow).Formula = "=Today()"
  End With

Application.ScreenUpdating = True

End Sub 
```

# c# - 将 RADGrid 上的 DataKeyNames 默认为第一列

> ID：11398235
> 
> 赞同：0
> 
> 时间：2012-07-09T15:28:20.113
> 
> 标签：c#, asp.net, vb.net, telerik-grid

我的页面上有一个 Telerik RadGrid，用于根据各种查询显示不同结果集的负载（一次一个）。

`DataKeyNames`无论返回什么数据集，我都需要将该属性默认为第一列。

我遇到的问题是第一列的名称从数据集更改为数据集。

有没有办法将属性默认为第一列？

谢谢

保罗。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T08:46:51.920

不要担心男孩和女孩。我自己整理的。基本上只是为每个单独的报告手动构建网格，很痛苦，但现在已经完成了。

# android - 以编程方式打开 pdf 文件

> ID：11398239
> 
> 赞同：4
> 
> 时间：2012-07-09T15:28:24.270
> 
> 标签：android

我正在处理pdf。我正在尝试使用下面的代码从我的应用程序中打开一个 pdf 文件。但是我没有打开。

```
private void openPdf() {

        File file = new File("mnt/sdcard.test.pdf");
        Uri path = Uri.fromFile(file);
        Intent intent = new Intent(Intent.ACTION_VIEW);
        intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        intent.setAction(Intent.ACTION_VIEW);
        intent.setData(path);
        intent.setType("application/pdf");
        try {
            startActivity(intent);
        } catch (ActivityNotFoundException e) {
            Toast.makeText(getActivity(), "No application found",
                    Toast.LENGTH_SHORT).show();
        }
    } 
```

当我在模拟器中尝试此代码时，它显示一个吐司说“未找到应用程序”（bcoz，通常模拟器中没有安装 pdf 查看应用程序）。当我在设备中测试相同的东西（特别是在 funbook 选项卡和索尼选项卡中）时，它既没有显示 Toast 消息，也没有打开 pdf 文件。任何人都可以指出我的代码中的错误。实际上，我是第一次使用 pdf。所以我的问题是，

1.  在设备中它没有显示 toast 消息，这意味着我的手机中安装了一个 pdf 查看应用程序？这样对吗？
2.  如果是这样，为什么不使用第三方应用程序打开 pdf。
3.  如果我想向用户列出我手机中安装的所有 pdf 查看应用程序，我应该在此代码中进行哪些更改？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-03-16T06:50:45.050

我得到了上述问题的解决方案，所以尝试一次；

脚步：-

1.  在您的应用名称下的 src 中创建 assets 文件夹。

2.  在此资产文件夹中保存您的 pdf 文件，例如 schedule1.pdf。

3.  现在来你的活动，即 MainActivity.java

4.  setListener 在任何你想要的 UI 组件上，即 ( `Button`, `ImageView`, `ImageButton`);

5.  在此侦听器中调用一个用户定义的方法，即`openPDFFiles()`

openPDFFiles() 方法有以下代码：

```
private void openPDFFiles() {
    AssetManager assetManager = getAssets();

    InputStream in = null;
    OutputStream out = null;
    File file = new File(getFilesDir(), “schedule1.pdf”);//here schedule1.pdf is the pdf file name which is keep in assets folder.
    try {
        in = assetManager.open(“schedule1.pdf”);
        out = openFileOutput(file.getName(), Context.MODE_WORLD_READABLE);

        copyFile(in, out);
        in.close();
        in = null;
        out.flush();
        out.close();
        out = null;
    } catch (Exception e) {
        Log.e(“tag”, e.getMessage());
    }

    Intent intent = new Intent(Intent.ACTION_VIEW);
    intent.setDataAndType(Uri.parse(“file://” + getFilesDir() + “/schedule1.pdf”), “application/pdf”);

    startActivity(intent);
}

private void copyFile(InputStream in, OutputStream out) throws IOException {
    byte[] buffer = new byte[1024];
    int read;
    while ((read = in.read(buffer)) != -1) {
        out.write(buffer, 0, read);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-06-23T07:42:07.087

因为`android 9 and 10`你应该使用这个代码

1-创建一个`class`

```
public class GenericFileProvider extends FileProvider {

} 
```

2-in`res`目录创建一个目录命名`xml` 并创建一个文件命名`provider_paths.xml`并添加此代码

```
<paths xmlns:android="http://schemas.android.com/apk/res/android">
    <external-path name="external_files" path="."/>
</paths> 
```

3- `manifests`in`application`添加此代码

```
 <provider
    android:name=".Model.Utilitys.GenericFileProvider"
    android:authorities="${applicationId}.provider"
    android:exported="false"
    android:grantUriPermissions="true">
      <meta-data
         android:name="android.support.FILE_PROVIDER_PATHS"
         android:resource="@xml/provider_paths"/>
  </provider> 
```

4-您应该获得许可`Manifest.permission.READ_EXTERNAL_STORAGE`

5-并添加此代码

```
String fileName="yourfile.pdf";

File file = new File(Environment.getExternalStorageDirectory()+"/Android/data/ir.tdaapp.paymanyar/files/File",fileName);

String extension = MimeTypeMap.getFileExtensionFromUrl(Uri.fromFile(file).toString());

String mimeType = MimeTypeMap.getSingleton().getMimeTypeFromExtension(extension);

Intent intent = new Intent(Intent.ACTION_VIEW);

intent.setFlags(FLAG_ACTIVITY_CLEAR_TOP | FLAG_ACTIVITY_NEW_TASK);

Uri uri = FileProvider.getUriForFile(getContext(), getActivity().getApplicationContext().getPackageName() + ".provider", file);

intent.setDataAndType(uri, mimeType);
intent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);

startActivity(Intent.createChooser(intent, "choseFile")); 
```

6-我建议您将此代码添加`application`到`manifests`

```
android:requestLegacyExternalStorage="true" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-09T15:44:00.417

试试 LuxuryMode 的方法：[https ://stackoverflow.com/a/8221594/1500067](https://stackoverflow.com/a/8221594/1500067)

我认为您只是缺少 adobe 包 intent.setPackage("com.adobe.reader");

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-09T20:08:46.257

尽管我没有在我的应用程序中打开 SD 卡中的文件，但我有几乎相同的代码可以正常工作。

```
Activity mActivity = /* your activity */...;
String mFileName = /* path of my PDF file */...;

Uri uri  = Uri.fromFile(mActivity.getFileStreamPath(mFileName));

try
{
    Intent intentUrl = new Intent(Intent.ACTION_VIEW);
    intentUrl.setDataAndType(uri, "application/pdf");
    intentUrl.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
    mActivity.startActivity(intentUrl);
}
catch (ActivityNotFoundException e)
{
    Toast.makeText(mActivity, "No PDF Viewer Installed", Toast.LENGTH_LONG).show();
} 
```

所以你的方法是正确的。确保您可以先打开文件...即使用 mActivity.openFileInput() 来确保您拥有可读的 PDF。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-08-17T10:30:49.007

您可以使用 3rd 方库集成来实现此目的。下面列出了工作库，带有 SDK

> [https://github.com/JoanZapata/android-pdfview](https://github.com/JoanZapata/android-pdfview)
> [https://github.com/jblough/Android-Pdf-Viewer-Library](https://github.com/jblough/Android-Pdf-Viewer-Library)

使用 NDK

> [https://code.google.com/p/mupdf/downloads/detail?name=mupdf-1.2-source.zip&can=2&q=](https://code.google.com/p/mupdf/downloads/detail?name=mupdf-1.2-source.zip&can=2&q=)

使用指南@

> [http://dixitpatel.com/integrating-pdf-in-android-application/](http://dixitpatel.com/integrating-pdf-in-android-application/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-02-17T06:27:36.897

在此处下载源代码（[在我的 android 应用程序中显示 PDF 文件](https://deepshikhapuri.wordpress.com/2017/02/15/display-pdf-file-inside-my-android-application/)）

在 Gradle 文件中添加此依赖项：

```
compile 'com.github.barteksc:android-pdf-viewer:2.0.3' 
```

**activity_main.xml**

```
<RelativeLayout android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="#ffffff"
    xmlns:android="http://schemas.android.com/apk/res/android" >

    <TextView
        android:layout_width="match_parent"
        android:layout_height="40dp"
        android:background="@color/colorPrimaryDark"
        android:text="View PDF"
        android:textColor="#ffffff"
        android:id="@+id/tv_header"
        android:textSize="18dp"
        android:gravity="center"></TextView>

    <com.github.barteksc.pdfviewer.PDFView
        android:id="@+id/pdfView"
        android:layout_below="@+id/tv_header"
        android:layout_width="match_parent"
        android:layout_height="match_parent"/>

    </RelativeLayout> 
```

**MainActivity.java**

```
import android.app.Activity;
import android.database.Cursor;
import android.net.Uri;
import android.provider.OpenableColumns;
import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.ImageView;
import android.widget.RelativeLayout;

import com.github.barteksc.pdfviewer.PDFView;
import com.github.barteksc.pdfviewer.listener.OnLoadCompleteListener;
import com.github.barteksc.pdfviewer.listener.OnPageChangeListener;
import com.github.barteksc.pdfviewer.scroll.DefaultScrollHandle;
import com.shockwave.pdfium.PdfDocument;

import java.util.List;

public class MainActivity extends Activity implements OnPageChangeListener,OnLoadCompleteListener{
    private static final String TAG = MainActivity.class.getSimpleName();
    public static final String SAMPLE_FILE = "android_tutorial.pdf";
    PDFView pdfView;
    Integer pageNumber = 0;
    String pdfFileName;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        pdfView= (PDFView)findViewById(R.id.pdfView);
        displayFromAsset(SAMPLE_FILE);
    }

    private void displayFromAsset(String assetFileName) {
        pdfFileName = assetFileName;

        pdfView.fromAsset(SAMPLE_FILE)
                .defaultPage(pageNumber)
                .enableSwipe(true)

                .swipeHorizontal(false)
                .onPageChange(this)
                .enableAnnotationRendering(true)
                .onLoad(this)
                .scrollHandle(new DefaultScrollHandle(this))
                .load();
    }

    @Override
    public void onPageChanged(int page, int pageCount) {
        pageNumber = page;
        setTitle(String.format("%s %s / %s", pdfFileName, page + 1, pageCount));
    }

    @Override
    public void loadComplete(int nbPages) {
        PdfDocument.Meta meta = pdfView.getDocumentMeta();
        printBookmarksTree(pdfView.getTableOfContents(), "-");

    }

    public void printBookmarksTree(List<PdfDocument.Bookmark> tree, String sep) {
        for (PdfDocument.Bookmark b : tree) {

            Log.e(TAG, String.format("%s %s, p %d", sep, b.getTitle(), b.getPageIdx()));

            if (b.hasChildren()) {
                printBookmarksTree(b.getChildren(), sep + "-");
            }
        }
    }

} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-01-03T18:01:16.213

我知道答案可能为时已晚，但是您的问题是由以下 2 行引起的： `intent.setData(path);` `intent.setType("application/pdf");`

当你 setData 之后你 setType，第二个命令将清除在 setData 中分配的路径。在这种情况下，您应该使用`setDataAndType(path,"application/pdf")`

> ```
> /**
>  * Set an explicit MIME data type.
>  *
>  * <p>This is used to create intents that only specify a type and not data,
>  * for example to indicate the type of data to return.
>  *
>  * <p>This method automatically clears any data that was
>  * previously set (for example by {@link #setData}).
>  *
>  * <p><em>Note: MIME type matching in the Android framework is
>  * case-sensitive, unlike formal RFC MIME types.  As a result,
>  * you should always write your MIME types with lower case letters,
>  * or use {@link #normalizeMimeType} or {@link #setTypeAndNormalize}
>  * to ensure that it is converted to lower case.</em>
>  *
>  * @param type The MIME type of the data being handled by this intent.
>  *
>  * @return Returns the same Intent object, for chaining multiple calls
>  * into a single statement.
>  *
>  * @see #getType
>  * @see #setTypeAndNormalize
>  * @see #setDataAndType
>  * @see #normalizeMimeType
>  */
> public Intent setType(String type) {
>     mData = null;
>     mType = type;
>     return this;
> } 
> ```

[Javadoc 意图类](https://android.googlesource.com/platform/frameworks/base/+/135936072b24b090fb63940aea41b408d855a4f3/core/java/android/content/Intent.java)

# objective-c - 多个相同的指针，不知道为什么

> ID：11398245
> 
> 赞同：1
> 
> 时间：2012-07-09T15:28:43.360
> 
> 标签：objective-c

我是Objective-C的新手，我觉得我可能只是犯了一个愚蠢的错误，但我尝试过谷歌搜索但没有运气（也许我只是没有搜索正确的东西）

本质上，我尝试编写自己的对象类，然后创建它的几个实例，但数据似乎锁定在一起；更改任何一个参考的数据会更改所有参考的数据。

这是我制作和使用对象的地方。

```
@implementation Drawing
//leaving many functions out as they are not part of the problem

Ball * balls[10];
int numPoints;

//this gets called first
- (id) initWithCoder: (NSCoder *)aDecoder
{
    //leaving out loading of images.....

    numPoints=10;
    for(int i=0; i<10; i++){
        balls[i]=[[Ball alloc] init];
        printf("bmem: %p\n",%balls[i]);
        float tpx=arc4random()%1024;
        float tpy=arc4random()%768;
        printf("randX: %f\n",tpx);
        printf("randY: %f\n",tpy);
        CGPoint tempPt = CGPointMake(tpx,tpy);
        printf("mem: %p\n",%tempPt);
        [balls[i] setLocation:tempPt];
    }
    //code to start a timer on the drawRect function....
}

//called regularly, every 30 seconds
- (void) drawRect:(CGRect)rect
{
    CGContextRef c=UIGraphicsGetCurrentContext();
    CGContextClearRect(c, rect);

    for(int i=0; i<numPoints; i++)
    {
        int ptX=[balls[i] getX];
        int ptY=[balls[i] getY];
        printf("index: %d\n",i);
        printf("x: %d\n",ptX);
        printf("y: %d\n",ptY);
        CGContextDrawImage(c, CGRectMake((int)ptX-WIDTH/2, (int)ptY-WIDTH/2, WIDTH, HEIGHT), image);
    }
} 
```

这个程序输出一系列我认为有用的数字。- “bmem”，或球所在的内存点，按预期的规律间隔递增。- “randX”和“randY”是完全随机的，因为它们应该是。- “mem”，或 CGPoint 在内存中的点，不会改变

这是球对象：

```
@implementation Ball
int x;
int y;

-(void)setLocation:(CGPoint)loc{
    x=loc.x;
    y=loc.y;
}

-(int)getX{
    return x;
}

-(int)getY{
    return y;
}

@end 
```

起初我只是在 Ball 类中有静态属性，但在谷歌搜索时我发现objective-c 没有静态属性。我盲目地尝试了十几种不同的方法，但都没有成功。我真的只需要这个工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:39:19.177

您正在使用全局变量：

```
Ball * balls[10];
int numPoints; 
```

当您可能需要实例变量时：

```
@interface Balls : NSObject
{
    Ball * balls[10];
    int numPoints;
}
...
@end 
```

# javascript - fetch 没有更新 collection.model.models

> ID：11398246
> 
> 赞同：0
> 
> 时间：2012-07-09T15:28:48.587
> 
> 标签：javascript, backbone.js

我有一个像这样初始化的骨干集合：

```
myCollection = new MyCollection([], {type: 'animals', params: {username: 'steve'}});

myCollection.fetch();

console.log(myCollection)  // prints out an object that includes 'models' and the newly fetched models

console.log(myCollection.models)  // prints out an empty list [] 
```

有谁知道为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T19:06:38.163

fetch 是一个异步操作，因此您在 fetch 之后立即执行的任何操作很可能在 fetch 完成之前执行，这会导致相当随机的结果。将控制台日志记录放在 fetch 的成功函数中，看看会发生什么

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T19:37:16.840

您的收藏模型必须具有服务器的 url 才能将其提取到收藏中，我认为您在“MyCollection”上有它，以防万一。然后您只需要添加一个成功回调来显示填充的集合，如下所示：

```
myCollection = new MyCollection([], {type: 'animals', params: {username: 'steve'}});

myCollection.fetch({
  success : function(returnedCollection, response){
       console.log(returnedCollection);  

        console.log(returnedCollection.models);
  }
}); 
```

# c++ - 如何在富编辑控件中实现对 URL 的鼠标单击

> ID：11398248
> 
> 赞同：4
> 
> 时间：2012-07-09T15:28:56.110
> 
> 标签：c++, c, winapi, richedit

我在对话框中添加了一个只读的 Rich Edit 2.0 控件（代码使用 C windows API，对话框是使用函数[DialogBox](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645452%28v=vs.85%29.aspx)创建的）

在对话框回调中，在 WM_INITDIALOG 中，我添加了以下代码以启用 url 检测并启用将事件 ENM_LINK 发送到父对话框而不是富编辑控件本身：

```
LRESULT mask = SendMessage(hWndText, EM_GETEVENTMASK, 0, 0); //hWndText is rich edit control
SendMessage(hWndText, EM_SETEVENTMASK, 0, mask | ENM_LINK);
::SendMessage(hWndText, EM_AUTOURLDETECT, TRUE, NULL); 
```

最初启动对话框时启用 url 检测有点麻烦（这似乎是一个已知问题或行为，因为富编辑控件只会启用修改文本的 url 检测）。但是，我通过在每个 WM_PAINT 事件上再次设置对话框文本来解决此问题。

该代码通常可以正常工作。当鼠标悬停在 URL 上时，我还实现了以下代码以在浏览器中启动 URL：

```
case WM_NOTIFY:
    plink = (ENLINK *) lParam;
    switch(LOWORD(wParam))
    {   
        case IDC_DISPLAY_TEXT_2: //this is ID for my rich edit control
            szURL =m_strDisplay.Mid(plink->chrg.cpMin, plink->chrg.cpMax - plink->chrg.cpMin);          
            LaunchURL(szURL); //function to launch the url with default browser
            break;
        default:
            break;
    } 
```

似乎每次将鼠标悬停在 url 上时，我都会收到 WM_NOTIFY 事件。但是，当我单击它时，我总是得到与鼠标悬停相同的事件。

基于[ENLINK](http://msdn.microsoft.com/en-us/library/windows/desktop/bb787897%28v=vs.85%29.aspx)的结构，我应该在 NMHDR 结构中获得更详细的 NM 事件，但是值 plink->nmhdr.code 始终是 1803，甚至不是 NM_HOVER （它的定义值是 (NM_FIRST-13) 而 NM_FIRST 是 ( 0U- 0U），所以我的 64 位机器上的 NM_HOVER 值为 4294967283）。我知道我在这里遗漏了一些东西。有人可以在这里点亮一些灯吗？如何获取富编辑控件的鼠标单击事件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-09T16:12:54.977

I think you should capture the [EN_LINK](http://msdn.microsoft.com/en-us/library/windows/desktop/bb787970%28v=vs.85%29.aspx) notification. I implemented the following code. It enables a url link in a richedit control placed into the parent window, not into a dialog. You could adapt it for your dialog, as well.

Consider beginning with the code:

```
case WM_NOTIFY: {
switch (((LPNMHDR)lParam)->code) { //NMHDR structure contains information about a notification message.
        case EN_LINK: {
            ENLINK *enLinkInfo = (ENLINK *)lParam; // pointer to a ENLINK structure 
```

then, if you choose to launch url on LBUTTONUP, you have to check the value contained in `enLinkInfo->msg` (remember to adapt it for your dialog, though)

```
 if (enLinkInfo->msg == WM_LBUTTONUP) {
// select all the text from enLinkInfo->chrg.cpMin to enLinkInfo->chrg.cpMax
// lauch the url

} 
```

Besides, you can intercept WM_MOUSEMOVE:

```
if(enLinkInfo->msg == WM_MOUSEMOVE) {
                ; // do nothing
} 
```

Hope it helps.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-01-16T08:37:17.373

正如@A_nto2 的回答所示，要拦截鼠标单击，请执行以下操作：

```
case WM_NOTIFY: {
    //NMHDR structure contains information about a notification message.
    switch (((LPNMHDR)lParam)->code) {
        case EN_LINK: {
            ENLINK *enLinkInfo = (ENLINK *)lParam; // pointer to a ENLINK structure
            if (enLinkInfo->msg == WM_LBUTTONUP) { 
```

但棘手的部分是获取被点击的链接。

`enLinkInfo->chrg`一个人得到一个在 type中被点击的“范围” `CHARRANGE`。

[在 RichEdit 中检测点击 URL](https://stackoverflow.com/q/2480173/850848#2481863)的答案建议`EM_EXSETSEL`使用`enLinkInfo->chrg`. 然后使用`EM_GETSELTEXT`检索文本。

这适用于自动检测到的纯文本 URL ( `EM_AUTOURLDETECT`)。

一个问题是友好名称超链接（即那些锚文本与 URL 本身不同的链接）：

```
{\rtf1{\field{\*\fldinst{ HYPERLINK "https://www.example.com"}}{\fldrslt{Example}}}} 
```

（请注意，这些仅在 Rich Edit 4.1 和更高版本中受支持）

对于这些，`CHARRANGE`指向`HYPERLINK "https://www.example.com"`零件的点是隐藏的，无法使用`EM_EXSETSEL`. 实际上在 Windows 10 上可以选择。但在 Windows 7、Vista 和 XP 上无法选择。将 发送`EM_EXSETSEL`到这些系统会导致在隐藏部分之后选择一个零长度块。

因此，要么您必须返回富编辑缓冲区并扫描链接；或使用其他方法来检索单击的文本。

就我而言，由于我只有富编辑中的小文本，所以我使用了`WM_GETTEXT`. 它返回富编辑文档的纯文本版本，但以这种形式保留了友好名称超链接：

```
HYPERLINK "https://www.example.com" Example 
```

指向 URL的`CHARRANGE`点，奇怪地包括前导引号：( `"https://www.example.com`)。

但索引对应于带有单字符 (LF) 行分隔符的文本。而`WM_GETTEXT`返回 CRLF 分隔符。因此，您必须先将文本转换为 LF，然后再使用`CHARRANGE`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-09T15:37:56.020

根据[EM_AUTOURLDETECT](http://msdn.microsoft.com/en-us/library/windows/desktop/bb787991%28v=vs.85%29.aspx)的文档，您应该收到一个[EN_LINK](http://msdn.microsoft.com/en-us/library/windows/desktop/bb787970%28v=vs.85%29.aspx)通知，该通知应该反映在`nmhdr.code`. 据谷歌称，

```
#define EN_LINK 0x70B 
```

即 7 * 256 + 11 = 1750 + 42 + 11 = 1803。

请注意，您的代码缺少对`nmhdr.code == EN_LINK`.

我不确定控件是否发送`NM_HOVER`消息。

# jquery - 更改 HTML onclick 事件操作（不同）

> ID：11398250
> 
> 赞同：0
> 
> 时间：2012-07-09T15:29:09.640
> 
> 标签：jquery, html, css

我对网络开发领域很陌生。我对我的 Web 开发有一些疑问。请任何人帮助我。

**设想**

我使用 div 标签制作了一个按钮，这是我制作的按钮的 CSS 代码：

```
#signupbutton
 {
    height: 29px;
    width: 120px;
    background-image: url(../images/onState1.png);
    background-repeat: no-repeat;
    margin-left: 265px;
    margin-top: 5px;
}
#signupbutton:hover {
    background-image: url(../images/onState0.png);
}
#signupbutton:active {
    background-image: url(../images/onState10.png);
} 
```

这是按钮的 HTML：

```
<div id="signupbutton" onclick="document.forms.signupform.submit()"></div> 
```

我需要使用 jQuery 更改此按钮的 onclick 操作`onclick="document.forms.signupform.submit()"`（需要更改此操作）。

谁能帮我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:32:14.830

HTML：

```
<div id="signupbutton"></div> 
```

Javascript：

```
$('#signupbutton').click(function() { 
alert('Button Clicked'); //or any action you want here
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T15:32:18.127

```
$('#signupbutton').removeAttr('onclick') // this removes the `onclick` attribute
$('#signupbutton').click(function(){
   $('#signupform').submit();
   // alert('clicked')
}) 
```

# asp.net-mvc - 关闭不显眼的验证运行时？

> ID：11398253
> 
> 赞同：4
> 
> 时间：2012-07-09T15:29:15.903
> 
> 标签：asp.net-mvc, asp.net-mvc-3, unobtrusive-javascript

我的 MVC 3 应用程序具有不显眼的验证。在一个视图`<form action=''>..</form>`中，我有两个按钮。第一个按钮在“action1”上提交表单，第二个按钮提交到“action2”。在第一种情况下，我必须验证表单，但在第二种情况下，我需要在没有验证的情况下发帖，这可能吗？目前模型在这两种情况下都可以验证。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T09:07:08.613

我找到了答案。要禁用对“action2”的验证，我必须在控制器中执行下一个方法：

```
ModelState.Clear(); 
```

并且在视野中

```
Html.EnableClientValidation(false); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T15:56:04.410

自从我完成 Asp.net MVC 以来已经有一段时间了，这就是你要找的吗？

```
@if(false) { // Replace false with your model property
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T16:45:00.943

你有几个选择：

1) 不要在 Controller 动作中使用 ModelState.IsValid。在 action1 上，运行验证表单的 javascript 方法。如果表格有效，则提交表格。在 action2 上，由于您没有使用 ModelState.IsValid，请提交表单，然后您的控制器操作将运行。

2) 在 Controller 动作中使用 ModelState.IsValid。将两个提交按钮命名为相同的名称（即“SubmitButton”）。分配“action1”和“action2”作为相应提交按钮的值。将 SubmitButton 作为字符串参数传递给 Controller 操作。如果 SubmitButton = 'action1' 查询 ModelState.IsValid。否则，不要查询 ModelState.IsValid。

选项 2 代码

控制器：

```
[HttpPost]
public ActionResult SomeAction(ModelObject theModel, string SubmitButton)
{
    if (SubmitButton== 'Action1')
    {
        if(ModelState.IsValid)
        {
            //do some work
        } 
        else
        {
            return(View(theModel));
        } 

    }
    else //action2 has ben used to submit, so don't vaildate
    {
       //do some work
    }
} 
```

看法：

```
<input type="submit" id="action1" name="SubmitButton" value="Action1"/> 
<input type="submit" id="action2" name="SubmitButton" value="Action2"/> 
```

# javascript - Highcharts 中的误差线（置信区间）

> ID：11398257
> 
> 赞同：2
> 
> 时间：2012-07-09T15:29:29.963
> 
> 标签：javascript, highcharts

Highcharts 目前不支持误差线（或置信区间），但有人编辑了现有模块作为解决方法。结果显示在这个 jsFiddle 中：

[http://jsfiddle.net/b74Tt/](http://jsfiddle.net/b74Tt/)

但是，如果我有多个系列需要有误差线怎么办？一个 ErrorBar 系列如何与特定的列系列相关联（因此准确地显示在它之上）？我的问题显示在另一个 jsFiddle 中：

[http://jsfiddle.net/FaYdK/1/](http://jsfiddle.net/FaYdK/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T17:23:59.083

我在第一列的基础上添加了一种新型图表。我得到的是充当误差线的细列。我还使用 events > legendItemClick 创建了一个小函数，当单击列时隐藏下一个系列（错误栏），以便其相应的错误栏也隐藏或显示。

请参见以下示例：

[http://jsfiddle.net/FaYdK/3/](http://jsfiddle.net/FaYdK/3/)

我对解决方案非常满意，唯一的事情是我希望以通常的形式（倒 H）而不是单行（细矩形）显示误差线。如果有人知道如何做到这一点，请发表评论！

# sql - Oracle ROUND 函数返回错误值

> ID：11398260
> 
> 赞同：2
> 
> 时间：2012-07-09T15:29:35.667
> 
> 标签：sql, oracle, oracle11g

我在 Oracle 11g 数据库上运行这个 sql 语句

```
select round(79/3 + 87/3 + 86/6 + 95/6) from dual 
```

它返回`85`

```
select round(79/3 + 87/3 + 86/6 + 95/6,1) from dual 
```

返回`85.5`

```
select round(85.5) from dual 
```

返回正确的值`86`

有谁知道为什么第一条 SQL 语句没有返回正确的值`86`，而是将其四舍五入`85`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-09T15:37:15.300

如果你这样做：

```
select 79/3 + 87/3 + 86/6 + 95/6 from dual; 
```

Oracle 将返回`85.49999999999999999999999999999999999999`，四舍五入到小数点后 0 位确实是 85。它是浮点运算的产物。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T22:43:20.933

79/3 + 87/3 + 86/6 + 95/6 将返回不具有 IEEE 754 舍入行为的浮点运算。请参阅[此处Number 和 Float 之间的区别](https://stackoverflow.com/questions/332492/oracle-floats-vs-number)

要获得正确的结果，您需要将语句运行为：

```
select round(to_number(79/3 + 87/3 + 86/6 + 95/6)) from dual; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-09T15:40:56.003

这看起来是一种奇怪的精度损失。

```
SELECT 79/3 + 87/3 + 86/6 + 95/6 FROM DUAL 
```

85.49999999999999999999999999999999999999

显然 85.4 会四舍五入到 85。至于为什么 Oracle 在这种情况下会失去精度，我不确定。

# php - 可以通过 PHP 从 Perl 执行 SQL 以提供全面的性能统计信息吗？

> ID：11398264
> 
> 赞同：1
> 
> 时间：2012-07-09T15:29:52.890
> 
> 标签：php, mysql, perl, dbi, newrelic

我有一个相当晦涩的问题，我可能会因为问这个问题而被击落，但是就这样吧。

我刚刚为我的网站实施了 New Relic Web 应用程序监控，该网站由大约 70% 的旧 Perl 代码和 30% 的新 PHP 代码组成。New Relic 为我希望能够分析的慢速 SQL 提供了一些非常好的信息。

问题是 New Relic 不提供 Perl 支持，所以我只能看到 30% 的应用程序查询统计信息。

作为一种解决方法，我有一个非常疯狂的想法，我可以像往常一样在 Perl 中准备我的 SQL，然后执行/shell 到一个 PHP 脚本，该脚本使用其内置接口执行 SQL，然后以某种方式将结果返回给 perl . （我不知道这是否可能）。这样，我就可以看到我目前看不到的其他 70% 的 SQL 统计信息。

我听说过[PECL Perl 扩展](http://pecl.php.net/package/perl)，但还没有详细研究它。有谁知道我是否/如何完成这样的事情？或者建议我可以与新遗物一起使用的任何替代 Perl/SQL 监控工具？

问候， **ns**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T10:06:10.603

感谢您的指点。

当我问这个问题时，我在想蓝天。从那以后，我意识到性能可能会受到很大影响，而且这是一个很难实施的解决方案。相反，我将尝试与新遗物一起使用替代工具。

干杯! ns

# java - 使用 Eclipse AST 进行参数使用

> ID：11398270
> 
> 赞同：0
> 
> 时间：2012-07-09T15:30:10.940
> 
> 标签：java, eclipse, abstract-syntax-tree, eclipse-jdt

我正在寻找一种方法来定位哪些 MethodInvocation 表达式利用调用者方法声明的参数。

例如：

```
 public void caller(int param1, int param2){
     m1(param1)
     m2(param2)
     m3(param1, m4(param2))

 } 
```

我希望能够确定 m1 方法调用使用了“param1”，m2 方法调用使用了“param2”，m3 使用了“param1”和“param2”。我可以用 ASTVisitor 做到这一点吗？我没有运气，因为 MethodDeclaration.parameters() 提供了 SingleVariableDeclaration 列表，而 MethodInvocation.arguments() 提供了 Expression 列表。我没有看到 SingleVariableDeclaration 和 Expression 之间的链接。我可以通过他们的名字来分析他们，但这太天真了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:45:42.943

绑定是识别变量、字段、方法、类等的权威方式。在这里，您需要比较参数声明和引用的 IVariableBinding。

# java - JAI.create() 可以在多个线程中使用吗？

> ID：11398271
> 
> 赞同：1
> 
> 时间：2012-07-09T15:30:11.247
> 
> 标签：java, multithreading, image-processing, jai

我正在构建一个基于开源软件 JPiv 的程序，用于进行数字图像相关和应变分析。不幸的是，JPiv 中的算法非常慢，所以我一直在尝试使用多线程来减少分析图像集所花费的时间。该算法使用 JAI 来做某事，不太确定是什么，因为我以前从未使用过它。当我运行它时，在第二次“通过”时，我在至少一个线程上得到了 OutOfMemory 异常，并且偶尔会出现其他错误，看似随机，但通常是 IllegalArgument 异常——有时来自 JAI，有时来自标准 Java 库。异常会在程序的不同点由不同的库引发，这使得调试变得困难——尤其是因为出于某种原因，它们并不总是在控制台中提供回溯消息。

我认为错误在于使用 JAI.create() 方法，以及不同线程访问 corr[c] 变量以使用上述方法的方式。是否可以按照我尝试的方式使用 JAI.create() ？

代码很长，所以我把它放在 Pastebin 上：http: [//pastebin.com/EX92YjXA](http://pastebin.com/EX92YjXA)

下面是一些伪代码，可以大致了解我正在尝试的内容。

```
public doPivEvaluation{
corr = new BufferedImage
start threads
send corr array to threads
loop until threads have finished
do stuff with corr}

public class threads{
on start{
    do the analysis using tmpCorr
    pb = new ParameterBlock()

    pb.removeSources();
    pb.removeParameters();
    pb.addSource(PivEvaluation.corr[c]);
    pb.addSource(tmpCorr);
    PivEvaluation.corr[c] = JAI.create("add",pb,null).getAsBufferedImage();

end threads} 
```

嗯，是的，所以也许不是有史以来最好的伪代码，但是是的。corr 中的位置，c，对于每个线程都是不同的（并且是指一组像素，因此可能高达 5000，具体取决于图像的大小，在不同线程之间拆分），并且 corr 已被声明为 volatile，因此理论上不应该覆盖数据。同样，理论上，如果 JAI.create() 只作用于那个位置，也应该没有问题。问题的出现是因为我不明白 .create() 实际是如何工作的……我知道整个事情在一个线程中工作，因为我没有改变任何实际算法，只是将它移动到多个线程中。

此外，对于代码中可能存在的任何不良编码实践，我深表歉意，我对 Java 还是比较陌生，所以我只是在糊里糊涂。如果我尝试某事并解决了问题，我可能会继续使用它，即使这意味着多个变量声明或我所做的任何其他低效率。这是我遇到的第一个问题，我无法通过猜测和谷歌来解决。

# c++-cli - C++/CLI 包装器不工作（LoaderLock 异常）

> ID：11398275
> 
> 赞同：4
> 
> 时间：2012-07-09T15:30:25.683
> 
> 标签：c++-cli, wrapper, unmanaged, managed

我为非托管 C++ 库（与 C# 一起使用）制作了非常简单的包装器。Wrapper 有一个非托管类和一个托管类。托管类具有非托管类的私有成员并像那样使用它。

我已经完成了非常简单的设置——我只为一个函数创建了包装器，以查看是否一切正常。但是，一旦我创建了一个包装器实例，我的应用程序就会出现异常“检测到 LoaderLock”，并显示以下消息：

> DLL 'c:\path\CPPWrapper.dll' 正在尝试在 OS Loader 锁内进行托管执行。不要尝试在 DllMain 或图像初始化函数中运行托管代码，因为这样做会导致应用程序挂起。

如果我为“LoaderLock”异常关闭中断，我会得到“FileLoadException was unhandled”：

```
Could not load file or assembly 'CPPWrapper.dll' or one of its dependencies. Exception from HRESULT: 0xE0434352 
```

知道我做错了什么，我该如何解决这个问题？

CPPWrapper.h

```
// CPPWrapper.h

#pragma once

#include "Native.h"

using namespace System;

namespace CPPWrapper {

    public ref class Class1
    {
        public:

        Class1() : mnt(new Native)
        {

        }

        ~Class1(void)
        {
            // call the finalize method
            this->!Class1();
        }

        // Finalize (for garbage collection)
        !Class1(void)
        {
            // Remove unmanaged class
            delete mnt;
            mnt = NULL;
        }

        void Napravi()
        {
            mnt->CreatePK();
        }

    private:
        Native *mnt;
    };

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T15:59:14.807

我发现解决此问题的正确方法是添加“LoaderLock”异常`#pragma unmanaged`时`dllmain.c` 不要关闭中断。

有关详细信息，请参阅[混合程序集的初始化](http://msdn.microsoft.com/en-us/library/ms173266.aspx)并向下滚动到 DllMain 部分。基本上正在发生的事情是该项目正在将 DllMain 函数编译为托管 (MSIL)，但它仅在非托管代码中运行。这`#pragma unmanaged`会强制将函数编译为非托管函数。

所以我`dllmain.c`现在是：

```
// dllmain.cpp : Defines the entry point for the DLL application.
#include "stdafx.h"

#pragma unmanaged
BOOL APIENTRY DllMain( HMODULE hModule,
                   DWORD  ul_reason_for_call,
                   LPVOID lpReserved
                 )
{
    switch (ul_reason_for_call)
    {
        case DLL_PROCESS_ATTACH:
        case DLL_THREAD_ATTACH:
        case DLL_THREAD_DETACH:
        case DLL_PROCESS_DETACH:
            break;
    }
    return TRUE;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-22T13:10:54.523

LoaderLock 的另一个潜在原因是全局静态对象的初始化。就我而言，我正在全局编译 boost::xpressive 正则表达式，当我的 C++/CLI 包装器初始化 DllMain 时，它不喜欢这样做。我不知道为什么，因为它不应该是托管代码，而是将它移动到一个函数静态对象修复它。

# r - 如何在 R 中绘制 CDF

> ID：11398276
> 
> 赞同：3
> 
> 时间：2012-07-09T15:30:28.780
> 
> 标签：r, distribution, probability, cdf

我正在尝试`ecdf()`使用以下代码使用函数绘制 CDF 图：

```
> x<-ecdf(data$V6)

> summary(x)
 Empirical CDF:   2402 unique values with summary
 Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
 3392     71870    120100    386100    219000 158600000 

plot(x, log='x')
    Error in plot.window(...) : Logarithmic axis must have positive limits 
```

我的数据集呈指数增长，所以我想在 x 轴上有对数刻度。当我不使用`log="x"`它时，它可以工作，但情节并不好。我需要 x 轴是对数的。有任何想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-09T16:58:36.417

这是一些重现您的问题的代码：

```
x <- seq(2e3, 1e9, length.out=2000)
ex <- ecdf(x)
plot(ex, log="x")
Error in plot.window(...) : Logarithmic axis must have positive limits 
```

现在，将绘图限制设置为`c(0, 1e9)`

```
plot(ex, xlim=c(0, 1e9), log="x")
Warning message:
In plot.window(...) : nonfinite axis limits [GScale(-inf,9,1, .); log=1]
Warning messages:
1: nonfinite axis limits [GScale(-inf,9,1, .); log=1] 
2: nonfinite axis limits [GScale(-inf,9,1, .); log=1] 
```

**解决方法：**将 xlim 设置为`c(1, 1e9)`，即将下限设置为正数：

```
plot(ex, xlim=c(1, 1e9), log="x") 
```

![在此处输入图像描述](../Images/d624a63c82a5eddcfb5b66791d172b2d.png)

# gwt - 初学者 GXT 问题

> ID：11398277
> 
> 赞同：0
> 
> 时间：2012-07-09T15:30:35.427
> 
> 标签：gwt, gxt

我们有一个可用的 Web 应用程序，它是用 ExtJS 开发的，用于客户端，用 Struts、Spring、Hibernate 开发用于服务器端。现在，我们正在考虑迁移到 GXT（或者可能是 GWT 本身）。问题是我对 GWT/GXT 很陌生。我们正在努力决定是否走这条路。

1) 到目前为止，我们的网络应用程序有 2 个域。一个是应用（Struts+...）已经部署到，另一个主要是一个无cookie的自定义CDN。客户端和服务器之间的传输主要是 XHR 请求，发送/接收 JSON 和/或 JSONP。但是随着我们面前的新方法，我开始明白我们应该只有一个域，用于整个 GXT 应用程序。这是正确的还是我忘了在这里考虑一些事情？

如果不是，是否有可能我们只将应用程序的一部分（即 com.ourcompany.webapp.gxt.server.*）部署到主服务器，而将 GWT 编译器编译生成的内容部署到其他服务器类似 CDN 的域？

2）我们面临的另一个大问题是当前的应用程序主要由 3 个巨大的模块组成。一个负责“登录”，一个负责“Webtop”，第三个负责“每个用户可以访问的模块”。后者是由于每个用户的“访问权限”而在服务器上生成的，并且显然可能因用户而异。

在这件事上我唯一能找到的可能与此相关的是[Code Splitting](https://developers.google.com/web-toolkit/doc/latest/DevGuideCodeSplitting)。虽然我'

我们希望应用程序在启动时检查用户是否已登录。如果不是，则加载 javascript 文件的 SignIn 集（即 webapp.signin.nocache.js），然后在用户输入正确的用户名/密码后，卸载此登录文件并加载 webtop.nocache.js 和 modules.nocache.js。

如果您能帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T09:08:22.990

1）如果您的 GWT 应用程序是从不同的域加载的，那么您必须面对相同的源策略。您不能对不同的域执行 xhr。您可以使用[ScriptTagProxy](http://dev.sencha.com/deploy/gxt-2.2.5/docs/api/com/extjs/gxt/ui/client/data/ScriptTagProxy.html)来解决这个问题。但是感觉不是很自然。

2) 您可以使用 CodeSplitting 来自动动态加载应用程序的特定部分。您所要做的就是将您的拆分点变形为异步调用。详细的[编译报告](https://developers.google.com/web-toolkit/doc/latest/DevGuideCompileReport)可以很好地概述代码拆分的工作情况。

但是 CodeSplitting 不会卸载已经加载的代码。如果它真的很重要，那么您必须将用户重定向到另一个 url 以加载适当的用户依赖模块。
一旦 Javascript 代码被加载并执行，就不可能从浏览器内存中删除代码。

问候，彼得

# c# - c# web服务消费报错

> ID：11398282
> 
> 赞同：1
> 
> 时间：2012-07-09T15:30:58.280
> 
> 标签：c#, web-services, wsdl, consumer

我正在尝试使用 .NET C# 项目中的以下 WSDL 来使用 Web 服务。

我添加了网络参考等并尝试调用该方法（getPatients），但它总是返回一个错误：

```
"MyService.PatientType[] PatientService.getPatients(MyService.getPatients getPatients1)"
"No overload for method 'getPatients' takes 0 arguments" 
```

我认为我的代码没问题（与我之前成功使用过的一样）但我一定做错了什么......

```
MyService.PatientService ws = new MyService.PatientService();
string message = ws.getPatients(); 
```

有没有人有任何想法？

谢谢

WSDL：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<wsdl:definitions name="patient"
xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" 
xmlns:tns="http://www.example.org/patientservice/" 
xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" 
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:p1="http://www.example.org/patientservice/patient_types/"
targetNamespace="http://www.example.org/patientservice/">
<wsdl:types>
<xsd:schema targetNamespace="http://www.example.org/patientservice/patient_types/" 
xmlns:tns="http://www.example.org/patientservice/patient_types/"    
xmlns:ns1="http://www.example.org/patient"
elementFormDefault="qualified">

<xsd:complexType name="patientType">
<xsd:sequence>
<xsd:element name="name" type="xsd:string"/>
<xsd:element name="age" type="xsd:int"/>
<xsd:element name="ssn" type="xsd:string"/>
<xsd:element name="pid" type="xsd:int"/>
</xsd:sequence>
</xsd:complexType>

<xsd:element name="getPatients">
<xsd:complexType/>
</xsd:element>

<xsd:element name="getPatientsResponse">
<xsd:complexType>
<xsd:sequence>
<xsd:element name="patient" type="tns:patientType" maxOccurs="unbounded" minOccurs="0"/>
</xsd:sequence>
</xsd:complexType>
</xsd:element>

<xsd:element name="getPatient">
<xsd:complexType>
<xsd:sequence>
<xsd:element name="ssn" type="xsd:string" />
</xsd:sequence>
</xsd:complexType>
</xsd:element>

<xsd:element name="getPatientResponse">
<xsd:complexType>
<xsd:sequence>
<xsd:element name="patient" type="tns:patientType"/>
</xsd:sequence>
</xsd:complexType>
</xsd:element>

</xsd:schema>
</wsdl:types>
<wsdl:message name="getPatientsRequest">
<wsdl:part element="p1:getPatients" name="in"/>
</wsdl:message>
<wsdl:message name="getPatientsResponse">
<wsdl:part element="p1:getPatientsResponse" name="out"/>
</wsdl:message>
<wsdl:message name="getPatientRequest">
<wsdl:part name="in" element="p1:getPatient"></wsdl:part>
</wsdl:message>
<wsdl:message name="getPatientResponse">
<wsdl:part name="out" element="p1:getPatientResponse"></wsdl:part>
</wsdl:message>
<wsdl:portType name="patient">
<wsdl:operation name="getPatients">
<wsdl:input message="tns:getPatientsRequest"/>
<wsdl:output message="tns:getPatientsResponse"/>
</wsdl:operation>
<wsdl:operation name="getPatient">
<wsdl:input message="tns:getPatientRequest"></wsdl:input>
<wsdl:output message="tns:getPatientResponse"></wsdl:output>
</wsdl:operation>
</wsdl:portType>
<wsdl:binding name="patientSOAP" type="tns:patient">
<soap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
<wsdl:operation name="getPatients">
<soap:operation  style="document" soapAction=""/>
<wsdl:input name="getPatientsRequest">
<soap:body use="literal"/>
</wsdl:input>
<wsdl:output name="getPatientsResponse">
<soap:body use="literal"/>
</wsdl:output>
</wsdl:operation>
<wsdl:operation name="getPatient">
<soap:operation  style="document" soapAction=""/>
<wsdl:input name="getPatientRequest">
<soap:body use="literal"/>
</wsdl:input>
<wsdl:output name="getPatientResponse">
<soap:body use="literal"/>
</wsdl:output>
</wsdl:operation>
</wsdl:binding>
<wsdl:service name="PatientService">
<wsdl:port binding="tns:patientSOAP" name="PatientSOAPPort">
<soap:address location="http://192.168.100.1:8080/patientservice"/>
</wsdl:port>
</wsdl:service>
</wsdl:definitions> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:44:08.460

我已经针对 wsdl 生成了一个代理，似乎 getPatients 方法需要一个参数。

试试这个：

```
PatientService ws = new PatientService();
getPatients getPatients1 = new getPatients();
patientType[] patients = ws.getPatients(getPatients1); 
```

# ios - SIGABRT 播放电影

> ID：11398289
> 
> 赞同：0
> 
> 时间：2012-07-09T15:31:27.543
> 
> 标签：ios, button, ibaction, sigabrt, invalidargumentexception

以下代码取自更大的代码，但我相信这是给我带来麻烦的部分。当我运行它时，我没有收到任何错误，但是在按下假设执行的“playMovie”中的硬编码按钮时，“退出电影”我收到消息：由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：'-[ViewController exitMovie :]: unrecognized selector sent to instance 0x7a4b350' 我已经对此进行了一些研究，并找到了它这样做的原因，但我似乎无法理解我的情况。然而，我是一个新手编码员，所以我可能只是错过了一些东西。希望这足以解决问题，如果没有，我可以发送更多代码。

```
-(IBAction)playMovie{

UIButton *buttonPress = [UIButton buttonWithType:UIButtonTypeCustom];
[buttonPress addTarget:self 
           action:@selector(exitMovie:)
 forControlEvents:UIControlEventTouchUpInside];
buttonPress.frame = CGRectMake(0.0, 0.0, 1000.0, 1000.0);
 buttonPress.backgroundColor = [UIColor clearColor];
[self.view addSubview:buttonPress];

NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle]pathForResource:@"We_Cant_Elope" ofType:@"mov"]];

MPMoviePlayerController *playerViewController = [[MPMoviePlayerController alloc] init];
playerViewController.contentURL = url;
playerViewController.view.frame = CGRectMake(120,300, 550, 400);

[self.view addSubview:playerViewController.view];
[playerViewController play];

self.playerViewController = playerViewController;

}

-(IBAction)exitMovie{

[self.playerViewController.view removeFromSuperview];
[self.playerViewController stop];

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T15:36:39.553

看起来您正在尝试执行错误的方法；`exitMovie:`（注意冒号）**与**. `exitMovie`也许该方法应该定义为：

```
- (IBAction)exitMove:(id)sender
{
    ...
} 
```

哪个匹配`exitMovie:`选择器。

# jquery - jquery选择具有相似名称的类

> ID：11398292
> 
> 赞同：2
> 
> 时间：2012-07-09T15:31:30.383
> 
> 标签：jquery, jquery-selectors

我正在`html`使用动态类名的循环中生成一些表。这些类看起来像：

```
<tr class="method_11">
<tr class="method_12">
<tr class="method_13"> 
```

有没有办法只使用它们的公共部分来选择所有上述类

`$('.method_options_1'+' ')`?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T15:34:19.643

```
$('tr[class^="method_"]') 
```

这将选择属性“class”***以***“method_”开头的元素，这符合您的条件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-09T15:34:42.883

从...开始：

```
$("tr[class^='method_']") 
```

[http://api.jquery.com/attribute-starts-with-selector/](http://api.jquery.com/attribute-starts-with-selector/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T15:33:34.390

你在寻找类似css通配符的东西吗？

我猜 jQuery 紧跟 CSS 选择器

[通配符 * 在 CSS 中用于类](https://stackoverflow.com/questions/5110249/wildcard-in-css)

# android - 带有API的移动信用卡刷卡系统

> ID：11398293
> 
> 赞同：2
> 
> 时间：2012-07-09T15:31:34.367
> 
> 标签：android, ios, api, credit-card

我正在寻找一个带有 API 的用于 ios/androids 的信用卡刷卡系统。PayPal Here 和 Square 是两家提供刷卡服务的知名公司，但它们还没有 API。

Payanywhere 是另一种具有 API 的服务，但不幸的是，它的 API 是有限的，没有我需要的东西。

还有其他类似的服务吗？

澄清一下，我正在编写一个使用刷卡系统的应用程序，我将分发给我的用户。因此，我不能让客户端决定支付多少，否则客户端可能会被黑客入侵，而客户端可以随意支付。

此外，我需要 payanywhere 服务器告诉我的服务器交易状态。同样的原因，否则客户端可以发送虚假状态并欺骗我的服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T18:21:05.637

由于这里是新用户的低代表，我还不能发表评论，所以把这个作为答案。

您是否希望有一个带有 api 的外围设备用于读卡，然后自己进行服务器/交易审批流程，而不是绑定到一个卡处理网关？

如果是这样，是的，有些硬件制造商不绑定到特定网关，每笔交易收取 x% 的费用。相反，他们提供了一个与外围设备/雪橇交互的 api（iOS 库）。然后由您的目标 C 代码来处理交易/卡信息并与您选择的任何网关进行交互。

我认为 magtek idynamo 就是其中之一。寻找硬件制造商，您会发现一些在他们的设备上提供 iOS 库的厂商。

# html - 将两个 DIV 放在另一个 DIV 旁边

> ID：11398297
> 
> 赞同：0
> 
> 时间：2012-07-09T15:31:47.110
> 
> 标签：html, css

如何将蓝色分区放在红色和绿色分区的右侧？

```
<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <style type="text/css">
            #red {width:100px; height:50px; background:red;}
            #green {width:100px; height:50px; background:green;}
            #blue {width:100px; height:100px; background:blue;}
        </style>
    </head>
    <body>
        <div id="red"></div>
        <div id="green"></div>
        <div id="blue"></div>
    </body>
</html> 
```

我知道如何通过将另一个 div 作为父级添加到第一和第二分区来做到这一点：

```
<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <style type="text/css">
            #parent {float:left;}
            #red {width:100px; height:50px; background:red;}
            #green {width:100px; height:50px; background:green;}
            #blue {width:100px; height:100px; background:blue; float:left;}
        </style>
    </head>
    <body>
        <div id="parent">
            <div id="red"></div>
            <div id="green"></div>
        </div>
        <div id="blue"></div>
    </body>
</html> 
```

但我想知道是否可以在不添加另一个 HTML 元素的情况下实现我的目标。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T15:34:59.437

您可以使用 float 属性使元素并排显示。

更新：您可以通过相对定位来实现此效果，请参阅下面的演示和代码。

**演示：http:** [//jsfiddle.net/SO_AMK/Frf6w/90/](http://jsfiddle.net/SO_AMK/Frf6w/90/)

**HTML：**

```
<div id="red"></div>
<div id="green"></div>
<div id="blue"></div>​ 
```

**CSS：**

```
#red {
    width: 100px;
    height: 50px;
    background: red;
}

#green {
    width: 100px;
    height: 50px;
    background: green;

    float: left;
    clear: both;
}

#blue {
    width: 100px;
    height: 100px;
    background: blue;

    top: -50px;
    float: left;
    position: relative;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T15:35:32.717

采用

```
style="float:left" 
```

这是做什么的，它是否使 div 在占用垂直空间之前水平占用尽可能多的空间

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T15:34:33.063

```
<!DOCTYPE html>
<html>
<head>
<title></title>
<style type="text/css">
#red {width:100px; height:50px; background:red;}
#parent {float: left; }
#green {width:100px; height:50px; background:green;}
#blue {width:100px; height:100px; background:blue; float: left;}
</style>
</head>
<body>
<div id="parent">
<div id="red"></div>
<div id="green"></div>
</div>
<div id="blue"></div>
</body>
</html> 
```

编辑：

对其进行了一些修改。问题是：如果您希望红色和绿色在彼此下方，则您必须将它们放入另一个分区并将另一个分区浮动在其旁边。你能解释一下为什么你会在没有父母的情况下想要它吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T15:34:33.700

添加`float:left;`到您的所有`div`s。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-09T15:37:25.207

```
<!DOCTYPE html>
<html>
<head>
<title></title>
<style type="text/css">
body
{
    max-width:200px;
    margin:auto;    
}
#red {width:100px; height:50px; background:red; **float:left;**}
#green {width:100px; height:50px; background:green;**float:left;**}
#blue {width:100px; height:100px; background:blue;**float:right;**}
</style>
</head>
<body>
    <div id="blue"></div>
    <div id="red"></div>
    <div id="green"></div>
</body>
</html> 
```

我已经更改了正文大小以包含我认为您所追求的安排中的 3 个 div。

有很多不同的方法，但这是我想要的一种。（虽然并不意味着它更好）

希望有帮助:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-09T15:48:23.490

在蓝色 div 上使用以下代码：

```
style="float:left" 
```

# apache - 请解释这个 htaccess 文件

> ID：11398298
> 
> 赞同：0
> 
> 时间：2012-07-09T15:31:47.280
> 
> 标签：apache

我在我工作的网站上找到了以下代码，这会做什么？

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^somedomain\.co.uk
RewriteRule ^(.*)$ http://www.somedomain.com/$1 [R=permanent,L]
RewriteCond %{HTTP_HOST} ^www.somedomain\.co.uk
RewriteRule ^(.*)$ http://www.somedomain.com/$1 [R=permanent,L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:34:04.693

如果我没记错的话，它只是将键入“somedomain.co.uk”的人重定向到“somedomain.com”。

# symfony - symfony2/sonata: 你请求了一个不存在的服务“”

> ID：11398303
> 
> 赞同：1
> 
> 时间：2012-07-09T15:31:57.127
> 
> 标签：symfony, symfony-sonata

当我尝试请求在奏鸣曲中列出对象时出现此错误：

> 您请求了一个不存在的服务“”。

这是我的 config.yml：

```
imports:
    - { resource: parameters.yml }
    - { resource: security.yml }
    - { resource: services.xml }

framework:
    #esi:             ~
    #translator:      { fallback: %locale% }
    translator:      ~
    secret:          %secret%
    router:
        resource: "%kernel.root_dir%/config/routing.yml"
        strict_parameters: %kernel.debug%
    form:            true
    csrf_protection: true
    validation:      { enable_annotations: true }
    templating:      { engines: ['twig'] } #assets_version: SomeVersionScheme
    default_locale:  %locale%
    trust_proxy_headers: false # Should Request object should trust proxy headers (X_FORWARDED_FOR/HTTP_CLIENT_IP)
    session:         ~

# Twig Configuration
twig:
    debug:            %kernel.debug%
    strict_variables: %kernel.debug%

# Assetic Configuration
assetic:
    debug:          %kernel.debug%
    use_controller: false
    bundles:        [ ]
    #java: /usr/bin/java
    filters:
        cssrewrite: ~
        #closure:
        #    jar: %kernel.root_dir%/Resources/java/compiler.jar
        #yui_css:
        #    jar: %kernel.root_dir%/Resources/java/yuicompressor-2.4.7.jar

# Doctrine Configuration
doctrine:
    dbal:
        driver:   %database_driver%
        host:     %database_host%
        port:     %database_port%
        dbname:   %database_name%
        user:     %database_user%
        password: %database_password%
        charset:  UTF8

    orm:
        auto_generate_proxy_classes: %kernel.debug%
        auto_mapping: true

# Swiftmailer Configuration
swiftmailer:
    transport: %mailer_transport%
    host:      %mailer_host%
    username:  %mailer_user%
    password:  %mailer_password%
    spool:     { type: memory }

fos_user:
    db_driver: orm # other valid values are 'mongodb', 'couchdb' and 'propel'
    firewall_name: main
    user_class: Sports\UserBundle\Entity\User
    registration:
        confirmation:
            enabled:    true
    from_email:
        address: tirengarfio@gmail.com
        sender_name: Javier Garcia

sonata_admin:
    title:      Sonata Project
    title_logo: /bundles/sonataadmin/logo_title.png 
```

这是我的 services.xml：

```
<container xmlns="http://symfony.com/schema/dic/services"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://symfony.com/schema/dic/services/services-1.0.xsd">
    <services>
       <service id="sonata.admin.tag_admin" class="Sonata\DefaultBundle\Admin\TagAdmin">
          <tag name="sonata.admin" manager_type="orm" group="Posts" label="Blog"/>
          <argument />
          <argument>Sonata\DefaultBundle\Admin\TagAdmin</argument>
          <argument>SonataAdminBundle:CRUD</argument>
          <call method="setTranslationDomain">
              <argument>fjaksa</argument>
          </call>
      </service>
   </services>
</container> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-10-24T11:15:32.337

此错误意味着您没有为当前控制器“”服务（控制器也是空的^_^）

在 stackoverflow 上搜索示例有十几个示例！

也许这项服务会起作用：

```
<container xmlns="http://symfony.com/schema/dic/services"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://symfony.com/schema/dic/services/services-1.0.xsd">
<services>
   <service id="sonata.admin.tag_admin" class="Sonata\DefaultBundle\Admin\TagAdmin">
      <tag name="sonata.admin" manager_type="orm" group="Posts" label="Blog"/>
      <argument />
      <argument>Sonata\DefaultBundle\Admin\TagAdmin</argument>
      <argument />
      <call method="setTranslationDomain">
          <argument>fjaksa</argument>
      </call>
  </service> 
```

# jquery - jQuery基于键值对对象查找和替换文本

> ID：11398306
> 
> 赞同：1
> 
> 时间：2012-07-09T15:32:08.017
> 
> 标签：jquery, arrays, search, object, replace

我四处翻找，发现了一些有用的帖子，用于使用键值对数组/对象在 jquery 中进行查找/搜索/替换，

但我无法让它工作，

这是该网站的测试网址：

[http://www.larryadowns.com.php5-1.dfw1-2.websitetestlink.com/](http://www.larryadowns.com.php5-1.dfw1-2.websitetestlink.com/)

如您所见，这是一个带有帖子信息的博客提要。我正在尝试以日期月份为目标，并为每个月份进行搜索和替换以放入西班牙月份。

这是 javascript，它都包含在一个 jQuery(document).ready()...

```
 var monthMap = {
        "January" : "Enero",
        "February" : "Febrero",
        "March" : "Marzo",
        "April" : "Abril",
        "May" : "Mayo",
        "June" : "Junio",
        "July" : "Julio",
        "August" : "Agosto",
        "September" : "Septiembre",
        "October" : "Octubre",
        "November" : "Noviembre",
        "December" : "Diciembre"
    };

    // sift thru the post-info, replacing only the month with the spanish one.
    $(".post-info .date").text(function(index, originalText) {

        var moddedText = '';

        for ( var month in monthMap ) {

            if (!monthMap.hasOwnProperty(month)) {
                continue;
            }

            moddedText = originalText.replace(month, monthMap[month]);

//            moddedText = originalText.replace( new RegExp(month, "g") , monthMap[month] );

            console.log("month : " + month);
            console.log("monthMap[month] : " + monthMap[month]);
        }

        console.log('-------------------');
        console.log('index : ' + index);
        console.log("monthMap : " + monthMap);
        console.log("originalText : " + originalText);

        console.log("moddedText : " + moddedText);

        return moddedText;
    }); 
```

但唉，.replace 或 .replace 与 RegEx 都没有真正取代任何东西。我哪里做错了？ty 再次堆叠。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:10:22.627

不太清楚为什么，但似乎你的代码在`moddedText`接下来的几个月中恢复到原来的状态。因此，它只是正确地替换了 12 月。

我使用了一种稍微不同的方法，但它应该会产生你正在寻找的东西。

```
$(".post-info .date").text(function(index, originalText) {

    for ( var month in monthMap )
    {
        if (originalText.indexOf(month) > -1)
        {
            return originalText.replace(month, monthMap[month]);
        }
    }

    return originalText;
}); 
```

检查这个[jsFiddle](http://jsfiddle.net/GoranMottram/FyWAp/1/)以获得完整的代码和演示。

# sql - 为什么这是一个循环外键约束？

> ID：11398313
> 
> 赞同：6
> 
> 时间：2012-07-09T15:32:20.607
> 
> 标签：sql, sql-server

我在我要更新的应用程序中发现了这段代码，标记为“错误”。在测试数据库上运行它会产生循环引用错误：

> 引用关系会导致不允许的循环引用（约束名=descriptions_fk_2）

我命名了约束以查看是哪一个导致了问题。

```
CREATE TABLE items (
id INT NOT NULL UNIQUE IDENTITY,
name NCHAR(100) NOT NULL UNIQUE,
PRIMARY KEY (id)
);

CREATE TABLE sources (
id INT NOT NULL UNIQUE IDENTITY,
item_id INT NOT NULL,
PRIMARY KEY (id),
FOREIGN KEY (item_id)
REFERENCES items(id) ON UPDATE NO ACTION ON DELETE CASCADE
);

CREATE TABLE descriptions (
id INT NOT NULL UNIQUE IDENTITY,
item_id INT NOT NULL, 
source_id INT NOT NULL,
PRIMARY KEY (id),
CONSTRAINT descriptions_fk_1 FOREIGN KEY (item_id)
REFERENCES items(id) ON UPDATE NO ACTION ON DELETE CASCADE,
CONSTRAINT descriptions_fk_2 FOREIGN KEY (source_id)
REFERENCES sources(id) ON UPDATE NO ACTION ON DELETE CASCADE
); 
```

为什么这是一个周期性参考？该`descriptions`表链接到两个单独的表，但没有一个链接回`descriptions`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-09T15:38:42.387

它不是严格周期性的——但有多个级联路径。因此，您可以通过两种方式级联删除项目中的一行：

1) 描述 -> 项目
2) 描述 -> 来源 -> 项目

并且，出于这个原因，它是不允许的。

我相信这是一个性能问题，因为 PostGres 将允许这样的循环并且会解决它，但在这种情况下删除可能会很慢。

有关为什么不允许它的进一步阅读，请参阅[此答案](https://stackoverflow.com/a/852047/261690)。

# deserialization - 将现有 xml 反序列化为自定义对象

> ID：11398315
> 
> 赞同：1
> 
> 时间：2012-07-09T15:32:28.400
> 
> 标签：deserialization, xmlserializer, xml-deserialization

我有以下xml：

```
<state>
<groups>
    <group id='1' name='Basic Search Options'>
        <control name='Building' label='In' display='true' configurable='false'/>
        <control name='SearchType' label='For' display='true' configurable='false'/>
        <control id='1' default='C' name='Search By' label='By'>
            <option searchtype='C' searchmode='Cnumber' value='CNumber' label='C Number' display='true'/>
            <option searchtype='C' searchmode='crossrefnumber' value='CNumber1' label='Cross Reference Number' display='true'/>
            <option searchtype='P' searchmode=''  value='CaseNumber' label='P Name' display='true'/>
            <option searchtype='P' searchmode='' value='CaseNumber' label='A Name' display='false'/>
        </control>
    </group>
    <group id='2' name='Advanced Search Options'>
        <control name='Ctatus' label='C Status' display='true'/>
        <control name='DateFiled' label='Date Filed' display='true'/>
    </group>
</groups> 
```

我如何将其反序列化为以下对象？我不希望我的 xml 有以下标签“ArrayofGroup”，而是 xml 应该有上面提到的自定义标签。

```
public class GroupOfControls
{
public int instanceId { get; set; }
public int GroupId { get; set; }
public string Name { get; set; }
public List<SearchControl> Group { get; set; }
}

public class SearchControl
{
public string Name { get; set; }
public string Label { get; set; }
public bool Display { get; set; }
public string Default { get; set; }
public List<SearchOption> SearchOptions { get; set; }
}

public class SearchOption
{
public string Value { get; set; }
public string Label { get; set; }
public bool Display { get; set; }
public string SearchMode { get; set; }
public string SearchType { get; set; }
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T15:52:18.380

如果您没有 XSD 文件，则需要从 XML 创建一个。您可以使用以下命令通过 Visual Studio 命令行执行此操作：

```
xsd myfilename.xml 
```

一旦你有一个 XSD 文件，这应该很容易。

我正在使用 Visual Studio 2010 (C#/.Net 4)，我会这样做：

首先，我将在 Visual Studio 中创建一个新的解决方案：

![新项目](../Images/53436c4406c2bc2469df1298cd3944b9.png)

`Add => Existing Item`然后，您需要通过右键单击您的解决方案并选择并浏览到 XSD来将 XSD 文件导入您的项目。

在项目中拥有 XSD 后，您需要启动 Visual Studio 命令提示符，使用`cd`导航到项目目录，然后键入以下命令：

```
xsd myFilename.xsd /classes 
```

这会生成您要将 XML 反序列化为的 C# 类。使用`Add Existing Item`对话框将这个新类导入您的解决方案。

接下来，您将`using System.Xml.Serialization;`and添加`using System.IO;`到您的 using 语句中。然后使用以下代码将您的 XML 反序列化为一个对象（假设 XML 针对您的 XSD 进行验证）。我可以归档的最新 XSD`ResponseData`如下所示：

![解决方案浏览器](../Images/815aa7065b9e59c1490c50c2b9d56f24.png)

考虑到这一点，我的 C# 代码如下：

```
using System;
using System.IO;
using System.Xml.Serialization;

namespace XML_Deserialization
{
    class Program
    {
        static void Main(string[] args)
        {
            ResponseData myResponseData = new ResponseData();

            XmlSerializer mySerializer = new XmlSerializer(typeof(ResponseData));
            StreamReader myStreamReader = new StreamReader(@"C:\Users\JMK\Documents\Visual Studio 2010\Projects\scratch\XML Deserialization\XML Deserialization\text.xml");
            myResponseData = (ResponseData)mySerializer.Deserialize(myStreamReader);

            Console.ReadLine();
        }
    }
} 
```

# r - 在 r 中的列表组件中应用 for 循环并在 r 中绑定列表组件

> ID：11398318
> 
> 赞同：1
> 
> 时间：2012-07-09T15:32:43.233
> 
> 标签：r, list, for-loop, bind

以下是我遇到问题的示例数据和部分功能。

```
# data
Gr1 <- data.frame (group = rep(1:2, each = 2001), 
position = round (c(0, cumsum (rnorm (2000, 0.05, 0.08)), 0, 
cumsum (rnorm (2000, 0.05, 0.08)))))

 Gr2 <- data.frame (group = rep(1:2, each = 2001), 
 position = round (c(0, cumsum (rnorm (2000, 0.05, 0.08)), 0, 
  cumsum (rnorm (2000, 0.04, 0.08)))))

 Gr3 <- data.frame (group = rep(1:2, each = 2001), 
position = round (c(0, cumsum (rnorm (2000, 0.05, 0.08)), 0, 
 cumsum (rnorm (2000, 0.05, 0.08)))))

 groupobs = list(Gr1, Gr2, Gr3)
 grnames = c("A", "B", "C")
 spacing = c(0, 0.1, 0.3)

    # for loop 

    for (i in 1:length(groupobs)){
     groupobs[i]$sgrp <- grnames[i]
     groupobs[i]$y <-  groupobs[i]$group + spacing[i]
    }

    # binding of list components
    mydf <- data.frame (rbind (groupobs) 
```

我怎样才能做到这一点？

**编辑：**通过上述循环，我想实现以下手动过程。我想自动化 n 个数据帧，这样我就不需要编写冗长的步骤：

请注意，这里的每个数据框都具有相同的变量名称。对于每个组件数据框，我要执行以下任务。如果我在不循环的情况下这样做：

```
# for first dataframe with in list 
Gr1$sgrp <- grnames[1]
Gr1$y <- Gr1$group + spacing[1]

# for second dataframe in the list
Gr2$sgrp <- grnames[2]
Gr2$y <- Gr1$group + spacing[2]

# for third dataframe in the list
Gr3$sgrp <- grnames[3]
Gr3$y <- Gr1$group + spacing[3]

mydf <- data.frame (rbind (Gr1, Gr2, Gr3)) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T16:19:51.430

我可能离这里很远，但是

```
mydf<-mapply(function(a,b,c){a$sgrp<-b;a$y<-c;a},groupobs,grnames,spacing,SIMPLIFY = F)
mydf<-do.call("rbind",mydf)
> str(mydf)
'data.frame':   12006 obs. of  4 variables:
 $ group   : int  1 1 1 1 1 1 1 1 1 1 ...
 $ position: num  0 0 0 0 0 0 0 0 0 1 ...
 $ sgrp    : chr  "A" "A" "A" "A" ...
 $ y       : num  0 0 0 0 0 0 0 0 0 0 ... 
```

可能是你所追求的......

编辑：更改为希望生成数据框

感谢@jon

# c# - 如何对列表进行分组 具有 List 属性的 通过那个嵌套列表？

> ID：11398320
> 
> 赞同：4
> 
> 时间：2012-07-09T15:32:45.677
> 
> 标签：c#, linq, group-by

我有一个自定义数据类型，其中包含`List<string>`.

我希望`List`按`CustomDataType`那个嵌套的`List<string>`.

我试过以下

```
 compoundSchedules.GroupBy(a => a.Timepoints); 
```

where`Timepoints`是表示为字符串的日期列表。如果任何`CustomDataType`s 具有相同的时间点，我希望将它们组合在一起。使用上面的代码，它不会对它们进行分组，而是将其时间点列表重复`List`为.`CustomDataType``IGrouping` `Key`

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:51:41.217

您应该创建一个`IEqualityComparer<List<string>>`检查列表是否具有相同的长度和内容，并使用以下重载[`Enumerable.GroupBy`](http://msdn.microsoft.com/en-us/library/bb534334.aspx)：

```
compoundSchedules.GroupBy(a => a.Timepoints, myComparer); 
```

要么，要么创建您自己的类作为时间点列表，并让它实现`GetHashCode`和`Equals`（和/或实现`IEquatable<T>`），[默认比较器](http://msdn.microsoft.com/en-us/library/ms224763.aspx)使用它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T15:37:32.690

我想到了两件事。首先是创建一个 Timepoints 类并实现 IComparable。然后你可以比较每个列表的每个元素，看看它们是否相等。或者，您可以在复合计划中创建一个新属性，其中包含列表的哈希码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T15:35:25.757

既然`Timepoints`是`List<string>`- 我将构建一个聚合字符串并按此分组。您可以使用 Aggregate 方法完成此操作

```
compoundSchedules.GroupBy(a => a.Timepoints.Aggregate( (x,y) => x + y)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T15:47:46.057

您可以按连接的字符串列表进行分组：

```
var grouped = compoundSchedules.GroupBy(cs => string.Join("", cs.Timepoints)); 
```

这也将处理相同的订单（如果需要）。

# php - Magento 以编程方式退款

> ID：11398323
> 
> 赞同：2
> 
> 时间：2012-07-09T15:32:49.407
> 
> 标签：php, magento

嗨，

我正在尝试以编程方式创建退款：

```
//get order magento

$orderMagento = Mage::getModel('sales/order')->loadByIncrementId($realOrderIncrementId );
if($orderMagento->getStatus() == Mage_Sales_Model_Order::STATE_CANCELED){
//création de l'avoir
$convertOrder = new Mage_Sales_Model_Convert_Order ();
$creditMemo = $convertOrder->toCreditmemo ( $orderMagento );

$items = $orderMagento->getAllItems ();
$totalQty = 0;

foreach ( $items as $item ) {
  $_eachCreditMemoItem = $convertOrder->itemToCreditmemoItem ( $item );
  $_eachCreditMemoItem->setQty ($item->getQtyInvoiced());
  $_eachCreditMemoItem->register ();
  $creditMemo->addItem ( $_eachCreditMemoItem );
  $totalQty += $item->getQtyInvoiced ();
} 

$creditMemo->refund();
$creditMemo->setTotalQty ( $totalQty );
$orderCreditMemoStatusCode = Mage_Sales_Model_Order::STATE_CLOSED;
$orderCreditMemoStatusComment = '[OK]Remboursement des article : ';
$saveTransaction = Mage::getModel('core/resource_transaction')->addObject ($creditMemo )->addObject ( $orderMagento )->save ();
$orderMagento->addStatusToHistory ( $orderCreditMemoStatusCode, $orderCreditMemoStatusComment, false );
$orderMagento->save ();
} 
```

此代码创建贷项通知单，但所有金额均为空（BaseGrandTotal = 0.00€，等等...）

那么问题出在哪里？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T13:07:09.563

首先谢谢你，我开始通过使用你的代码编程来实现 creditmemo，我遇到的问题是创建了 credit memom 但没有产品。我将分享我的代码，以便您使用它。

```
/*
I think your problem is with the content of the variable data, I'll give you an example:

array(6) {
  ["items"] => array(2) {
    [11] => array(1) {
      ["qty"] => string(6) "2"
    }
    [13] => array(1) {
      ["qty"] => string(1) "0"
    }
  }
  ["do_offline"] => string(1) "1"
  ["comment_text"] => string(0) ""
  ["shipping_amount"] => string(1) "0"
  ["adjustment_positive"] => string(1) "0"
  ["adjustment_negative"] => string(1) "0"
  ["qtys"] => array(2) {
    [11] => int(2)
    [13] => int(0)
  }
} 
```

*/

```
 /**
 *
 * @param array $dif array that contains my product information with qty and product_id and item_id
 * @param type $info array("order_increment_id" => $order->getIncrementId(), "invoice_id" => $invoiceId);
 * @return type 
 */
protected function creaDevolucio($dif, $info){
    $qtys = array();

    foreach ($dif as $item) {
        if (isset($item['qty'])) {
            $qtys[$item['order_item_id']] = array("qty"=> $item['qty']);
        }
        if (isset($item['back_to_stock'])) {
            $backToStock[$item['order_item_id']] = true;
        }
    }

    $data = array(
        "items" => $qtys,
        "do_offline" => "1",
        "comment_text" => "",
        "shipping_amount" => "0",
        "adjustment_positive" => "0",
        "adjustment_negative" => "0",
    );
    if (!empty($data['comment_text'])) {
        Mage::getSingleton('adminhtml/session')->setCommentText($data['comment_text']);
    }

    try {
        $creditmemo = $this->_initCreditmemo($data, $info);
        if ($creditmemo) {
            if (($creditmemo->getGrandTotal() <=0) && (!$creditmemo->getAllowZeroGrandTotal())) {
                Mage::throwException(
                    $this->__('Credit memo\'s total must be positive.')
                );
            }

            $comment = '';
            if (!empty($data['comment_text'])) {
                $creditmemo->addComment(
                    $data['comment_text'],
                    isset($data['comment_customer_notify']),
                    isset($data['is_visible_on_front'])
                );
                if (isset($data['comment_customer_notify'])) {
                    $comment = $data['comment_text'];
                }
            }

            if (isset($data['do_refund'])) {
                $creditmemo->setRefundRequested(true);
            }
            if (isset($data['do_offline'])) {
                $creditmemo->setOfflineRequested((bool)(int)$data['do_offline']);
            }

            $creditmemo->register();
            if (!empty($data['send_email'])) {
                $creditmemo->setEmailSent(true);
            }

            $creditmemo->getOrder()->setCustomerNoteNotify(!empty($data['send_email']));
            $this->_saveCreditmemo($creditmemo);
            $creditmemo->sendEmail(!empty($data['send_email']), $comment);
            echo '<br>The credit memo has been created.';
            Mage::getSingleton('adminhtml/session')->getCommentText(true);
            return;
        } else {
            //$this->_forward('noRoute');
            //return;
        }
    } catch (Mage_Core_Exception $e) {
        $this->_getSession()->addError($e->getMessage());
        Mage::getSingleton('adminhtml/session')->setFormData($data);
    } catch (Exception $e) {
        Mage::logException($e);
        $this->_getSession()->addError($this->__('Cannot save the credit memo.'));
    }
}

/**
 *
 * @param type $data contains products info to refund
 * @param type $info array("order_increment_id" => $order->getIncrementId(), "invoice_id" => $invoiceId);
 * @param type $update
 * @return boolean 
 */
protected function _initCreditmemo($data, $info, $update = false)
{
    $creditmemo = false;
    $invoice=false;
    $creditmemoId = null;//$this->getRequest()->getParam('creditmemo_id');
    $orderId = $info['order_increment_id'];//$this->getRequest()->getParam('order_id');
    $invoiceId = $data['invoice_id'];
    echo "<br>abans if. OrderId: ".$orderId;
    if ($creditmemoId) {
        $creditmemo = Mage::getModel('sales/order_creditmemo')->load($creditmemoId);
    } elseif ($orderId) {
        $order  = Mage::getModel('sales/order')->loadByIncrementId($orderId);
        if ($invoiceId) {
            $invoice = Mage::getModel('sales/order_invoice')
                ->load($invoiceId)
                ->setOrder($order);
            echo '<br>loaded_invoice_number: '.$invoice->getId();
        }

         if (!$order->canCreditmemo()) {
            echo '<br>cannot create credit memo'; 
            if(!$order->isPaymentReview())
            {
                echo '<br>cannot credit memo Payment is in review'; 
            }
            if(!$order->canUnhold())
            {
                echo '<br>cannot credit memo Order is on hold'; 
            }
            if(abs($order->getTotalPaid()-$order->getTotalRefunded())<.0001)
            {
                echo '<br>cannot credit memo Amount Paid is equal or less than amount refunded'; 
            }
            if($order->getActionFlag('edit') === false)
            {
                echo '<br>cannot credit memo Action Flag of Edit not set'; 
            }
            if ($order->hasForcedCanCreditmemo()) {
                echo '<br>cannot credit memo Can Credit Memo has been forced set'; 
            }
            return false;
        }

        $savedData = array();
        if (isset($data['items'])) {
            $savedData = $data['items'];
        } else {
            $savedData = array();
        }

        $qtys = array();
        $backToStock = array();
        foreach ($savedData as $orderItemId =>$itemData) {
            if (isset($itemData['qty'])) {
                $qtys[$orderItemId] = $itemData['qty'];
            }
            if (isset($itemData['back_to_stock'])) {
                $backToStock[$orderItemId] = true;
            }
        }
        $data['qtys'] = $qtys;

        $service = Mage::getModel('sales/service_order', $order);
        if ($invoice) {
            $creditmemo = $service->prepareInvoiceCreditmemo($invoice, $data);
        } else {
            $creditmemo = $service->prepareCreditmemo($data);
        }

        /**
         * Process back to stock flags
         */
        foreach ($creditmemo->getAllItems() as $creditmemoItem) {
            $orderItem = $creditmemoItem->getOrderItem();
            $parentId = $orderItem->getParentItemId();
            if (isset($backToStock[$orderItem->getId()])) {
                $creditmemoItem->setBackToStock(true);
            } elseif ($orderItem->getParentItem() && isset($backToStock[$parentId]) && $backToStock[$parentId]) {
                $creditmemoItem->setBackToStock(true);
            } elseif (empty($savedData)) {
                $creditmemoItem->setBackToStock(Mage::helper('cataloginventory')->isAutoReturnEnabled());
            } else {
                $creditmemoItem->setBackToStock(false);
            }
        }
    }

    return $creditmemo;
}

/**
 * Save creditmemo and related order, invoice in one transaction
 * @param Mage_Sales_Model_Order_Creditmemo $creditmemo
 */
protected function _saveCreditmemo($creditmemo)
{
    $transactionSave = Mage::getModel('core/resource_transaction')
        ->addObject($creditmemo)
        ->addObject($creditmemo->getOrder());
    if ($creditmemo->getInvoice()) {
        $transactionSave->addObject($creditmemo->getInvoice());
    }
    $transactionSave->save();

    return $this;
} 
```

# asp.net-mvc-3 - 发现空引用或无效值 [GDI+ 状态：无效参数]

> ID：11398325
> 
> 赞同：3
> 
> 时间：2012-07-09T15:33:03.680
> 
> 标签：asp.net-mvc-3, mono, gdi+

我在 Mono/linux 上运行 MVC3 应用程序，除了图像上传实用程序外，一切正常。每当尝试上传图像时，我都会从以下方法中收到 Invalid Parameter 错误：

```
 System.Drawing.GDIPlus.CheckStatus(status As Status) (unknown file): N 00339
    System.Drawing.Bitmap.SetResolution(xDpi As Single, yDpi As Single) 
```

我已经广泛地搜索了这个错误，并发现 Invalid parameter 错误通常会产生误导，并且如果上传本身有错误，或者图像未完全读取，则可能会触发。这在 IIS/Windows 上运行良好，但我无法让它在 Mono 中工作。

Apache2 单声道 2.10.8.1

我错过了一些简单的东西还是我需要找到一种不同的方法来处理单声道的图像处理？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T17:24:30.903

经过大量测试后，我能够确定错误的根源。我试图使用 Bitmap.Resolution 的**Image.Horizo** **​​ntalResolution**和**Image.VerticalResolution**属性。虽然这些属性是在初始上传时设置的（文件从 tmp 目录读入流中），但当我使用图像本身的 base64 编码字符串发回时，这些值似乎以某种方式丢失了。因此，SetResolution 方法失败。

 **无论出于何种原因，我在 IIS/Windows 上都没有这个问题，这些属性在两种情况下都存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-30T20:53:04.260

我遇到了类似的问题。从磁盘加载的位图，报告 bmp.Horizo​​ntalResolution==0 和 bmp.VerticalResolution==0 当它们都是==300 时。在 Windows 上不会发生此行为。

再深入一点，我发现以下测试失败：

```
 [Test]
    public void GDI_SetResoltion()
    {
        var b1 = new Bitmap (100, 100);
        Assert.That (b1.HorizontalResolution, Is.Not.EqualTo (0));
        Assert.That (b1.VerticalResolution, Is.Not.EqualTo (0));
    } 
```

我相信 Windows 将默认分辨率为 96 dpi。**

# java - 如何在 MimeUtility.decodeText() 之后获取简单的电子邮件地址？

> ID：11398329
> 
> 赞同：0
> 
> 时间：2012-07-09T15:33:07.413
> 
> 标签：java, email, jakarta-mail

从 javax.mail.internet 使用 MimeUtility.decodeText() 后，如何简单地获取电子邮件地址？

在该操作之后，我有以下字符串： `Foo Bar <foo.bar@abc.en>`

我可以通过 String 类的方法来做到这一点，但我对现有的预定义方法感兴趣？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:43:01.430

定义您的方法非常容易。要获取字符串，您只需要一行代码：

```
String email = stringToDecode.split("<")[1].substring(0, stringToDecode.split("<")[1].length() - 1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T05:09:19.323

只要打电话`new InternetAddress(addr).getAddress()`。事实上，你甚至不需要先打电话`MimeUtility.decodeText()`。

# java - 大型应用程序的 PHP-Dojo 与 Java

> ID：11398330
> 
> 赞同：0
> 
> 时间：2012-07-09T15:33:11.357
> 
> 标签：java, php, javascript, jquery, dojo

我的公司正处于寻找建立团队以开发新平台以取代我们现有系统的初期阶段。UI/UX 非常重要，因为有几千个用户。当前系统是用 PHP 和 Zend 构建的。

我一直在做很多研究，并考虑过用 DoJo 或类似的东西来考虑 Yii。如果我们决定走 Java 路线，我也看过 ZK 框架。无论我们选择什么，框架都必须能够与 linux 很好地通信，并且能够执行低级系统操作，例如创建/更新文件等。

归根结底，我对 Java 知之甚少，但越看越觉得所有干净的 Web 应用程序都在运行 Java。

我在这里遗漏了什么还是我在正确的轨道上思考：

PHP = 更容易培训和雇用人员。更难获得丰富的 UI

Java = 更难培训和寻找开发人员。干净的 UI 更容易获得。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T15:51:55.267

选择 Java 而不是 PHP 与干净的 UI 无关，更多的是关于在规模和复杂性上增长的能力。

不要误会我的意思，我知道有很多大型复杂系统可以使用 PHP 运行良好，只是我发现 Java 在平台中内置了更多支持以实现可扩展性。

您可以使用 PHP 和 Java 获得干净、丰富的 UI。

PHP - 更容易和更快地开始。即使有适当的知识，也更难解决性能和可伸缩性问题。

Java - 更难“做对”。如果一切都正确完成，您将比使用 PHP 更晚地遇到性能问题......但是有了适当的知识，找到解决方案会更容易。

但是，就用户体验而言，你应该选择你的开发人员最满意的东西。如果 UX 和后端逻辑是分离的，您可以将它们视为分离的问题。

# c# - 使用 MailMessage 发送邮件有注入的危险吗？如果是这样 - 我应该如何避免它？

> ID：11398332
> 
> 赞同：0
> 
> 时间：2012-07-09T15:33:12.613
> 
> 标签：c#, asp.net, email

这是我的代码：

```
MailMessage m = new MailMessage(from, to, subject, body);
SmtpClient s = new SmtpClient("...");
s.Send(m); 
```

只有`subject`和`body`是用户输入。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:40:20.730

代码很好，但这取决于“主题”和“正文”的来源。如果（如您所述）它们是用户提供的，则要确保对其进行编码（HttpServerUtility.HtmlEncode）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T15:38:37.437

然后您应该验证**主题**和**正文**。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T15:47:19.383

我正在尝试编写一个测试项目来快速调查这个问题，但是从我对 Reflector 的查看和对文档的阅读来看，主题和正文被严格视为 System.Strings - 这是欢迎你的地步如果需要，显式设置字符串的编码（MailMessage.BodyEncoding）。

除非这个类的组合方式存在重大错误，否则代码注入的可能性不应该比任何其他字符串更大；特别是如果您明确地将 BodyEncoding 设置为某种纯文本方式，例如 UTF-8。

编辑：或者，如果您真的想确保 HTML 不是正文的一部分，您可以使用正则表达式

```
@"<[^>]*>" 
```

用 Regex.Replace(regex, string.empty) 或 Regex.Match 天真地去除一堆尖括号内的任何内容，并抛出一个表示找到匹配项的返回值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T15:46:34.870

从@DavidHall 发布的链接[Is .NET MailMessage class injection-safe?](https://stackoverflow.com/questions/301339/is-net-mailmessage-class-injection-safe) , @Slaks 提到 to/from 已验证，但您的正文内容未验证。因此，您需要验证主题和正文。

确保在将主题和正文发送给用户之前对其进行编码；在大多数情况下，这应该足以应付。

# jquery - jQuery 脉动效果

> ID：11398333
> 
> 赞同：8
> 
> 时间：2012-07-09T15:33:12.960
> 
> 标签：jquery, highlight, pulse

希望有人能给我一些指点。单击按钮后，我正在尝试将“脉动”效果添加到 div 上。

我编写的以下脚本很好并且确实有效 - 但是我理想情况下希望它在背景颜色之间交替而不是完全淡出 div。

我使用了错误的效果吗？或者有没有一种结合脉冲和亮点的方法？

```
$(document).ready(function() {
    $("li#emailSellerLink a").click(function(){
        $("#contactColumn").effect( "pulsate", {times:3}, 5000 );
    });
}); 
```

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-09T16:28:31.340

您可以使用该`.animate()`功能 - [http://jsfiddle.net/Fe8Jy/](http://jsfiddle.net/Fe8Jy/)

```
$("a").click(function(e) {
    e.preventDefault();
    for (var i = 0; i < 3; i++ ) {
        $("#contactColumn")
            .animate( { backgroundColor: "#f00" }, 2000 )
            .animate( { backgroundColor: "transparent" }, 2000 );
    }
}); 
```

# javascript - 关闭弹出窗口后刷新父窗口

> ID：11398356
> 
> 赞同：10
> 
> 时间：2012-07-09T15:34:38.563
> 
> 标签：javascript, popup, window, parent

我正在创建一个转到 hello.html 的弹出窗口。当我关闭弹出窗口（hello.html）时，我希望我的原始（父页面）重新加载。我似乎无法让它工作，但我已经接近了。这是我到目前为止的主页和 hello.html 页面的代码......

```
<!DOCTYPE html>
<html>
<head>
<script type="text/javascript">
function open_win()
{
window.open("hello.html","_blank","toolbar=yes, location=yes, directories=no, status=no, menubar=yes, scrollbars=yes, resizable=no, copyhistory=yes, width=400, height=400");
}
</script>

<script language="JavaScript">

function refreshParent() {
  window.opener.location.href = window.opener.location.href;

  if (window.opener.hello.html)

 {
    window.opener.hello.html.close()
  }
  window.close();
}
</script>

</head>

<body>

<script type="text/javascript">

var d=new Date();
document.write(d);

</script>

<form>
<input type="button" value="Open Window" onclick="open_win()">
</form>
</body>
</html> 
```

这是hello.html...

```
<!DOCTYPE html>
<html>
<head>
<script type="text/javascript">
</script>
</head>
<body>

Hello

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-09T15:39:19.397

订阅子窗口中的[卸载事件](https://developer.mozilla.org/en/DOM/window.onunload)，并从子窗口调用父窗口通知它正在关闭！

**编辑**添加了代码示例...

```
function popupClosing() {
  alert('About to refresh');
  window.location.href = window.location.href;
}

var w = window.open("hello.html","_blank","toolbar=yes, location=yes, directories=no, status=no, menubar=yes, scrollbars=yes, resizable=no, copyhistory=yes, width=400, height=400");
w.onunload = function () {
  window.parent.popupClosing()
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-09T15:53:12.910

这样做，在创建弹出监视器后，它的“关闭”状态属性在一段时间内。但是这是在父文档中添加的：

```
var pop = window.open("page.html", "popup",
            "width=800,height=500,scrollbars=0,title='popup'");
    pop.focus();

    var monitor = setInterval(function() {

        if (pop.closed) {
            document.location.reaload()
        }

    }, 1000); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-04T06:52:13.877

尝试将此 javascript 代码放在您的弹出窗口中：

```
window.onunload = function(){
  window.opener.location.reload();
}; 
```

/ *onunload 事件将在您关闭弹出窗口时触发，window.opener.location.reload() 将重新加载源（父）窗口。*/

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-30T06:37:15.000

在弹出关闭功能的点击事件上尝试...

```
window.opener.location.reload(true); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-08T05:42:41.063

`window.open`如果使用该功能弹出一个新窗口，这段代码也可以工作。

```
setTimeout(function () { window.opener.location.reload(true); window.close();}, 3000); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-24T20:42:53.607

将此脚本放在弹出窗口的标题中：

```
<script type='text/javascript'>
window.onunload = function(){
window.opener.location.reload();}
</script> 
```

当您关闭弹出窗口时，这将重新加载父窗口。

# visual-studio-2010 - 将 VS2010 类图导出到 Visio

> ID：11398357
> 
> 赞同：14
> 
> 时间：2012-07-09T15:34:40.263
> 
> 标签：visual-studio-2010, visio

我正在使用 VS2010 创建类图。有什么方法可以导入 VS2010 生成的类图以导入到 MS Visio 中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-10T14:56:42.533

右键单击 Visual Studio 中的类图，然后选择“将图导出为图像...”

选择Visio 可识别的*增强型元文件格式 (*.emf) 。*

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2015-01-19T22:26:10.090

您可以从 Visual Studio 执行此操作 `File > Print`，然后将其发送到 OneNote 或选择 PDF。

# ruby-on-rails-3 - 不能用康康

> ID：11398360
> 
> 赞同：0
> 
> 时间：2012-07-09T15:34:49.727
> 
> 标签：ruby-on-rails-3, cancan, warden

我正在关注 cancan 的 rails casts 第 192 集 (http://railscasts.com/episodes/192-authorization-with-cancan?autoplay=true)。

我有 ruby​​ 1.9.3 和 rails 3.2.3

我的 gem 文件有这个内容

```
group :test, :development do
   gem 'rspec-rails', '~> 2.5'
end
group :test do 
   gem 'cucumber-rails', '1.0.6'# use this instead of the one in the book
   gem 'capybara'
   gem 'database_cleaner'
end

gem 'dynamic_form'
gem 'factory_girl'
gem 'devise', '~>1.4.3'
gem 'email_spec'
gem 'cancan' 
```

在 environment.rb 文件中我添加了

```
config.gem 'cancan' 
```

当我运行 bundle 命令时，我看到了这个......

```
Using warden (1.0.6) 
Using devise (1.4.9) 
Using dynamic_form (1.1.4) 
Using rspec-core (2.11.0) 
Using rspec-expectations (2.11.1) 
Using rspec-mocks (2.11.0) 
Using rspec (2.11.0) 
```

现在我的问题是：当我跑步时：

```
sudo rake gems:install 
```

那为什么我会看到这个：

```
Could not find warden-1.0.6 in any of the sources
Run `bundle install` to install missing gems. 
```

以及在我的 gem.lock 文件中为什么它显示...

```
devise (1.4.9)
  bcrypt-ruby (~> 3.0)
  orm_adapter (~> 0.0.3)
  warden (~> 1.0.3) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T17:15:15.050

该 railscast 是从 2009 年 12 月 14 日开始的，当时 Rails 2 是标准。

您应该阅读[https://github.com/ryanb/cancan](https://github.com/ryanb/cancan)上的说明，其中更多地关注 Rails 3 和 Bundler。

`bundle install`会将您的 Gemfile 内容安装到您当前的 RVM gemset 中，在这种情况下，可能是默认 gemset。不要使用 sudo 来安装 gems。要列出 gemset 中安装的 gem，只需运行`gem list`. 运行`bundle list`以显示当前应用程序包中的所有 gem。

# c# - 使用 LINQ to XML 进行条件查询

> ID：11398361
> 
> 赞同：1
> 
> 时间：2012-07-09T15:34:54.463
> 
> 标签：c#, linq-to-xml

我使用 LINQ to XML 删除标签并将其插入到 xml 文档中。我经常遇到的一种情况是，我对插入特定标签的位置有*偏好，但这种偏好并不总是能得到满足。*例如，在这里我更喜欢在具有相同 CalendarCode 的最后一个元素之后插入它：

```
elements = from e in calendarDocument.Descendants("ExceptionalSessions") where e.Element("CalendarCode") == calendarCode select e;

elements.Last().AddAfterSelf(sessionElement); 
```

但是，有时要插入的元素是该文档中具有该 CalendarCode 的第一个此类元素，因此额外条件：

```
where e.Element("CalendarCode") == calendarCode 
```

将创建一个空的结果集。在这种情况下，我想使用*没有*附加条件的查询。这是一次性的事情，在插入带有该日历代码的元素后，我希望在第一个元素之后插入具有相同 CalendarCode 的 NEXT 元素......在这种情况下，我想使用*该*查询附加条件。

我尝试了几种方法来解决这个问题，但它们看起来都非常粗糙并且可能效率低下，我不禁认为有更好的方法。

如果他们遇到过这种情况，谁能给我一个想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:53:32.977

一种选择是在添加条件之前评估条件并确定目标。为了清楚起见，使用单独的方法，可能是这样的（未经测试）：

```
private XElement GetCalendarTargetNode(XElement source, XElement calendarCode)
        {
            var exceptionalSessions = source.Descendants("ExceptionalSessions");
            return exceptionalSessions.LastOrDefault(e => e.Element("CalendarCode") == calendarCode) ?? exceptionalSessions.Last();
        } 
```

或者稍微不同的实现：

```
private XElement GetCalendarTargetNode(XElement source, XElement calendarCode)
        {
            var exceptionalSessions = source.Descendants("ExceptionalSessions");
            return exceptionalSessions.Where(e => e.Element("CalendarCode") == calendarCode).DefaultIfEmpty(exceptionalSessions.Last()).Last();
        } 
```

并使用它：

```
var target = GetCalendarTargetNode(calendarDocument, calendarCode);
target.AddAfterSelf(sessionElement); 
```

**编辑：** 或不使用额外方法的简化版本：

```
 var exceptionalSessions = calendarDocument.Descendants("ExceptionalSessions");
    var target = exceptionalSessions.Where(e => e.Element("CalendarCode") == calendarCode)
        .DefaultIfEmpty(exceptionalSessions.Last());
    target.Last().AddAfterSelf(sessionElement); 
```

# javascript - 优化字符串匹配算法

> ID：11398364
> 
> 赞同：2
> 
> 时间：2012-07-09T15:35:00.390
> 
> 标签：javascript, string, algorithm, optimization

```
function levenshtein(a, b) {
  var i,j,cost,d=[];

  if (a.length == 0) {return b.length;}
  if (b.length == 0) {return a.length;}

  for ( i = 0; i <= a.length; i++) {
    d[i] = new Array();
    d[ i ][0] = i;
  }

  for ( j = 0; j <= b.length; j++) {
    d[ 0 ][j] = j;
  }

  for ( i = 1; i <= a.length; i++) {
    for ( j = 1; j <= b.length; j++) {
      if (a.charAt(i - 1) == b.charAt(j - 1)) {
        cost = 0;
      } else {
        cost = 1;
      }

      d[ i ][j] = Math.min(d[ i - 1 ][j] + 1, d[ i ][j - 1] + 1, d[ i - 1 ][j - 1] + cost);

      if (i > 1 && j > 1 && a.charAt(i - 1) == b.charAt(j - 2) && a.charAt(i - 2) == b.charAt(j - 1)) {
        d[i][j] = Math.min(d[i][j], d[i - 2][j - 2] + cost)
      }
    }
  }

  return d[ a.length ][b.length];
}

function suggests(suggWord) {
  var sArray = [];
  for(var z = words.length;--z;) {
    if(levenshtein(words[z],suggWord) < 2) { 
      sArray.push(words[z]);
    }   
  }
} 
```

你好。

我正在使用 Damerau-Levenshtein 算法的上述实现。它在普通 PC 浏览器上足够快，但在平板电脑上需要约 2/3 秒。

基本上，我将发送到建议函数的单词与字典中的每个单词进行比较，如果距离小于 2，则将其添加到我的数组中。

dic 是一个大小约为 600,000 (699KB) 的单词数组，其目的是为我的 Javascript 拼写检查器提供建议单词功能。

关于如何加快速度的任何建议？或者另一种方式来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T15:44:09.537

如果您只寻找小于某个阈值的距离，您可以做的一件事是首先比较长度。例如，如果您只希望距离小于 2，那么两个字符串长度之差的绝对值也必须小于 2。这样做通常可以让您避免进行更昂贵的 Levenshtein 计算。

这背后的原因是，长度相差 2 的两个字符串将需要**至少**两次插入（因此产生的最小距离为 2）。

您可以按如下方式修改您的代码：

```
function suggests(suggWord) {
  var sArray = [];
  for(var z = words.length;--z;) {
    if(Math.abs(suggWord.length - words[z].length) < 2) {
      if (levenshtein(words[z],suggWord) < 2) { 
        sArray.push(words[z]);
      }
    }   
  }
} 
```

我不怎么做javascript，但我认为这就是你可以做到的。

部分问题是您有大量的字典单词，并且至少对这些单词中的每一个都进行了一些处理。一个想法是为每个不同的单词长度设置一个单独的数组，并将您的字典单词组织到其中而不是一个大数组中（或者，如果您必须有一个大数组，用于 alpha 查找或其他什么，那么使用索引数组进入那个大数组）。然后，如果您有一个 5 个字符长的 suggWord，您只需查看 4、5 和 6 个字母单词的数组。然后，您可以在我上面的代码中删除 Match.Abs​​(length-length) 测试，因为您知道您只查看长度可以匹配的单词。这使您不必对大量字典单词进行任何处理。

Levenshtein 相对昂贵，对于较长的单词更是如此。如果仅仅是 Levenshtein 太昂贵而无法多次执行的情况，尤其是对于较长的单词，您可以利用阈值的另一个副作用，即仅考虑完全匹配或距离为 1 的单词（一次插入、删除、替换或转座）。鉴于该要求，您可以通过检查它们的第一个字符匹配或最后一个字符匹配（除非任一单词的长度为 1 或 2，在这种情况下，Levenshtein 应该很便宜）来进一步过滤 Levenshtein 计算的候选者。事实上，您可以检查前 n 个字符或后 n 个字符的匹配，其中 n = (suggWord.length-1)/2。如果他们没有通过那个测试，你可以假设他们会' 通过 Levenshtein 匹配。为此，您需要按字母顺序排列的字典单词的主要数组，以及该数组的索引数组，但按字母顺序按字母顺序排列。然后你可以对这两个数组进行二进制搜索，并且只需要对它们的开始或结束的 n 个字符与 suggWord 开始或结束匹配的单词的小子集进行 Levenshtein 计算，并且长度不同最多一个字符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-09T15:41:31.907

我不得不优化相同的算法。对我来说最有效的是缓存 d 数组。你在 levenshtein 函数之外用大尺寸（你期望的字符串的最大长度）创建它，所以每次调用函数时都不必重新初始化它.

就我而言，在 Ruby 中，它在性能上产生了巨大的差异。但当然这取决于你的`words`数组的大小......

```
function levenshtein(a, b, d) {

var i,j,cost;

if (a.length == 0) {return b.length;}
if (b.length == 0) {return a.length;}

for ( i = 1; i <= a.length; i++) {

    for ( j = 1; j <= b.length; j++) {

        if (a.charAt(i - 1) == b.charAt(j - 1)) {

            cost = 0;

        } else {

            cost = 1;

        }

        d[ i ][j] = Math.min(d[ i - 1 ][j] + 1, d[ i ][j - 1] + 1, d[ i - 1 ][j - 1] + cost);

        if (i > 1 && j > 1 && a.charAt(i - 1) == b.charAt(j - 2) && a.charAt(i - 2) == b.charAt(j - 1)) {

            d[i][j] = Math.min(d[i][j], d[i - 2][j - 2] + cost)

        }

    }

}

return d[ a.length ][b.length];

}

function suggests(suggWord)
{
d = [];
for ( i = 0; i <= 999; i++) {

    d[i] = new Array();

    d[ i ][0] = i;

}
for ( j = 0; j <= 999; j++) {

    d[ 0 ][j] = j;

}

var sArray = [];
for(var z = words.length;--z;)
{
        if(levenshtein(words[z],suggWord, d) < 2)
        {sArray.push(words[z]);}    
}
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-09T16:39:30.180

您可以在代码中做一些简单的事情来从根本上提高执行速度。我完全重写了您的代码以提高性能、符合 JIT 解释的静态类型以及符合 JSLint：

```
var levenshtein = function (a, b) {
        "use strict";
        var i = 0,
            j = 0,
            cost = 1,
            d = [],
            x = a.length,
            y = b.length,
            ai = "",
            bj = "",
            xx = x + 1,
            yy = y + 1;
        if (x === 0) {
            return y;
        }
        if (y === 0) {
            return x;
        }
        for (i = 0; i < xx; i += 1) {
            d[i] = [];
            d[i][0] = i;
        }
        for (j = 0; j < yy; j += 1) {
            d[0][j] = j;
        }
        for (i = 1; i < xx; i += 1) {
            for (j = 1; j < yy; j += 1) {
                ai = a.charAt(i - 1);
                bj = b.charAt(j - 1);
                if (ai === bj) {
                    cost = 0;
                } else {
                    cost = 1;
                }
                d[i][j] = Math.min(d[i - 1][j] + 1, d[i][j - 1] + 1, d[i - 1][j - 1] + cost);
                if (i > 1 && j > 1 && ai === b.charAt(j - 2) && a.charAt(i - 2) === bj) {
                    d[i][j] = Math.min(d[i][j], d[i - 2][j - 2] + cost);
                }
            }
        }
        return d[x][y];
    }; 
```

在多维查找的每个间隔查找数组的长度是非常昂贵的。[我还使用http://prettydiff.com/](http://prettydiff.com/)美化了您的代码，这样我就可以在一半的时间内阅读它。我还删除了数组中的一些冗余查找。如果这对您来说执行得更快，请告诉我。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-09T15:47:38.140

您应该将所有单词存储在[trie](http://en.wikipedia.org/wiki/Trie)中。与存储单词的字典相比，这是节省空间的。匹配单词的算法是遍历 trie（标记单词的结尾）并找到单词。

编辑

就像我在评论中提到的那样。对于 0 或 1 的 Levenshtein 距离，您不需要遍历所有单词。如果两个词相等，则它们的 Levenshtein 距离为 0。现在问题归结为预测给定单词的 Levenshtein 距离为 1 的所有单词。举个例子：

*大批*

对于上述单词，如果您想找到 1 的 Levenshtein 距离，示例将是

*   parray, aprray, arpray, arrpay, arrayp (插入一个字符)

这里 p 可以用任何其他字母代替。

同样对于这些单词，Levenshtein 距离为 1

ray, aray, arry (删除一个字符)

最后是这些话：

pray、apray、arpay、arrpy 和 arrap （字符替换）

同样，p 可以替换为任何其他字母。

因此，如果您只查找这些特定组合而不是所有单词，您将得到您的解决方案。如果您知道 Levenshtein 算法的工作原理，我们已经对其进行了逆向工程。

最后一个例子是你的用例：

如果*pary是您**作为*输入获得的单词，则应将其更正以从字典中分离出来。因此，对于*pary*，您不需要查看以*ab*开头的单词，例如，因为对于任何以*ab*开头的单词，Levenshtein 距离将大于 1。

# android - ListView - SimpleCursorAdapter - @android:id/empty

> ID：11398365
> 
> 赞同：0
> 
> 时间：2012-07-09T15:35:02.917
> 
> 标签：android, listview, simplecursoradapter

我有一个 ListActivity。ListActivity 的布局是

```
<ListView android:id="@android:id/list"
           android:layout_width="match_parent"
           android:layout_height="match_parent"
           android:layout_weight="1"
           android:drawSelectorOnTop="false"
           />

<TextView android:id="@android:id/empty"
           android:layout_width="match_parent"
           android:layout_height="match_parent"
           android:text="No elements found"
           android:gravity="center"  
           /> 
```

ListActivity 与 CursorAdapter 相关。

当用户选择列表中的一个项目时，我会启动另一个活动来显示所选项目的详细信息：

```
Intent intent = new Intent(MyListActivity.this, DetailActivity.class);
startActivity(intent); 
```

一切正常，除非用户选择列表中的一个项目。在开始“详细活动”之前，显示带有“@android:id/empty”id 的文本视图的“未找到元素”消息。

发生这种情况是因为我在 onPause 方法中关闭了光标。但我认为我必须关闭它，因为我要离开当前的活动。

```
@Override
protected void onPause()
{
    super.onPause();            

    if (this.cursor != null)
        this.cursor.close();

    this.db.close();        
} 
```

如果我不想在离开当前活动时看到带有“@android:id/empty”的文本视图，我该怎么办？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:38:53.837

让系统为您管理。

```
getActivity().startManagingCursor(yourCursor); 
```

调用游标后立即调用该代码（其中包含正确的游标变量名称），系统将为您管理游标，并在认为不再需要时将其关闭。

您的另一个选择是将该代码移动到`onStop`当活动不再对用户可见时调用的方法。

# php - 如何从 CakePHP 组件中访问非 Cake 会话数据

> ID：11398367
> 
> 赞同：1
> 
> 时间：2012-07-09T15:35:10.323
> 
> 标签：php, session, cakephp, integration

我目前正在集成两个 php 应用程序：

1.  多年来构建的大型定制 PHP Web 应用程序，而不是用 CakePHP 编写的。
2.  一个小的 CakePHP 仪表板应用程序 (jSlate)。

蛋糕应用程序位于同一域中，并且位于主应用程序的子文件夹中。

在 CakePHP 应用程序中，我需要访问由主定制应用程序在 $_SESSION 中设置的数据，但它似乎无法访问。我假设 Cake 正在处理会话数据。是否将其存储在我可以访问的地方，如果可以，如何访问？

我已经尝试[过从 php 脚本访问 cakephp 会话变量的答案？](https://stackoverflow.com/q/6988156/641534)，即：

```
session_name('CAKEPHP'); 
session_start(); 
print_r($_SESSION); 
```

但它不包含我需要的会话变​​量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T15:35:11.340

主应用程序需要在设置其变量之前指定一个 session_name：

```
session_name('MAINAPP');
$_SESSION['foo'] = 'bar'; 
```

然后在 CakePHP 应用程序中，您可以通过以下方式访问它：

```
session_name('MAINAPP');
$foo = $_SESSION['foo'];
session_name('CAKEAPP'); 
```

最后一行很重要，因为它将会话名称重置为 Cake App 的名称，否则蛋糕会话变量将无法访问。

或者，您可以将主应用程序和蛋糕应用程序设置为使用相同的会话名称，但这会引入命名冲突的可能性。

# prolog - 在 Prolog 中重新定义 AND 运算符

> ID：11398369
> 
> 赞同：2
> 
> 时间：2012-07-09T15:35:14.177
> 
> 标签：prolog, operator-overloading, operators, operator-keyword

我想在 SWI-Prolog 中重新定义 AND 运算符。但我不知道该怎么做。我尝试了以下定义：

```
a & b = b & a 
```

但是，它被报告为递归并且不起作用。希望人们给我建议。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T06:39:21.520

您可以使用 定义 SWI-Prolog 中的运算符[`op/3`](http://www.swi-prolog.org/pldoc/man?predicate=op/3)，例如通过将以下内容添加到您的程序中：

`:- op(1000, xfy, user:(&)).`

请注意，优先级 ( `1000`) 和类型 ( `xfy`) 与已在 SWI-Prolog 中定义的合取运算符相同（即，请参阅[`','/2`](http://www.swi-prolog.org/pldoc/doc_for?object=section%282,%274.24%27,swi%28%27/doc/Manual/operators.html%27%29%29)）。

然后，一旦声明，您可以定义`&`如下语义：

`'&'(A,B) :- A, B.`

这两个定义一起将允许您在包含它们的程序中使用`&`in-line 来代替表示连接的意思。`,`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T16:40:48.190

您可以“定义”`and`如下：

```
and(t,X,X) :- bool(X).
and(f,X,f) :- bool(X).
bool(t).
bool(f). 
```

第三个参数是第一个和第二个参数合取的结果。

当然，这只是一个练习，但确实很难回答您的问题，因为您的问题的全部内容并不是很清楚。

# c# - 双击另一个表单上的文本框后如何传递datagridview值

> ID：11398372
> 
> 赞同：0
> 
> 时间：2012-07-09T15:35:24.177
> 
> 标签：c#, winforms, events, user-controls, datagridview

我正在开发一个复杂的功能区应用程序，到目前为止一切顺利，但现在我遇到了一个棘手的情况，我必须`TextBox`在`Form`双击`DataGridView`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T10:17:28.647

实际上，您有很多选择。这一切都取决于您的应用程序的代码/架构，但通常您正在寻找的是委托。这是代表的介绍性文章：[链接](http://msdn.microsoft.com/en-us/library/ms173171%28v=vs.110%29.aspx)。这里是一些基本示例的链接[，](http://blogs.msdn.com/b/brunoterkaly/archive/2012/03/02/c-delegates-actions-lambdas-keeping-it-super-simple.aspx)它将向您介绍 Actions 和 Lambdas。

或者，如果这两个表单可以互相看到（如果您在一个父表单中引用了两个表单），您可以在源表单上创建一个事件并在目标表单上订阅它，并以这种方式传递数据。

***来源表格：***

*• 定义委托*

```
public delegate void RibbonDataHandler(string); 
```

*• 定义事件*

```
public event RibbonDataHandler RibbonData; 
```

*• 定义执行事件的方法*

```
protected virtual void OnRibbonData( string value )
{
    if( RibbonData != null )
        RibbonData( value );
} 
```

*• 在DataGridView的**DoubleClick*事件处理程序上调用事件

 *```
string value = // Get Value from the gridView
OnRibbonData( value ); 
```

***目标表单：*** • 添加公共属性以设置*TextBox*值

```
public string TextBoxValue
{
    get { return txtValue.Text; }
    set { txtValue.Text = value; }
} 
```

***父表格：***

• 将这两个表单添加为字段

```
private Form _sourceForm;
private Form _destinationForm; 
```

• 初始化表格

```
// Well, initialize the forms in the way you need it, maybe on the Load event?
_sourceForm = new SourceForm();
_destinationForm = new DestinationForm();
_sourceForm.RibbonData += new SourceForm.RibbonDataHandler(OnRibbonData); 
```

• 定义 RibbonData 处理程序

```
private void OnRibbonData( string value )
{
    _destinationForm.TextBoxValue = value ?? String.Empty;
} 
```

***免责声明：*** 我把所有这些都写在我的脑海里，此时没有VS，如果您有更多问题或者如果某些东西不起作用，请发表评论。:)*

# jquery - 如何使用 jQuery 解析大 JSON？

> ID：11398375
> 
> 赞同：1
> 
> 时间：2012-07-09T15:35:26.970
> 
> 标签：jquery, json

我尝试开发一个小的网络日历。用户获得一周的概览，如果他按下“下周给我看”，接下来的 7 天应该使用 jQuery 异步加载。JSON 数据如下所示：

```
{
   "user":[
      {
         "id":"12345",
         "days":{
            "09-07-2012":{
               "10:00":{
                  "time":"10:00",
                  "length":"30",
                  "appointmentid":"159487"
               },
               "11:00":{
                  "time":"11:00",
                  "length":"30",
                  "appointmentid":"159487"
               },
               "12:00":{
                  "time":"12:00",
                  "length":"30",
                  "appointmentid":"159487"
               }
            },
            "10-07-2012":{
               "10:00":{
                  "time":"10:00",
                  "length":"30",
                  "appointmentid":"159487"
               },
               "11:00":{
                  "time":"11:00",
                  "length":"30",
                  "appointmentid":"159487"
               },
               "12:00":{
                  "time":"12:00",
                  "length":"30",
                  "appointmentid":"159487"
               }
            },
            "11-07-2012":{
               "10:00":{
                  "time":"10:00",
                  "length":"30",
                  "appointmentid":"159487"
               },
               "11:00":{
                  "time":"11:00",
                  "length":"30",
                  "appointmentid":"159487"
               },
               "12:00":{
                  "time":"12:00",
                  "length":"30",
                  "appointmentid":"159487"
               }
            }
         }
      }
   ]
} 
```

我如何处理这些数据并将其显示在 html 表中？使用 jQuery 函数，我只能步行抛出第二维......所以我只能得到 id 和 days ......

```
$.each(data.user, function(i,data){
...
} 
```

那么我怎样才能扔掉整个数组并用数据填充我的 ui 呢？我应该使用嵌套的每个函数吗？

问候托马斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:38:53.257

解析后，您可以简单地进入属性，因为您拥有的是一个 javascript 对象。

在这种特定情况下，您在地图中拥有地图。

要遍历此类对象的属性，请使用以下`for (var key in object)`构造：

您的用户 ID 是`data.user.id`

```
for (var date in data.user.days) {
   var day = data.user.days[date];
   for (var hour in day) {
      var appointement = day[hour];
      // use the hour and appointement objects and their properties. 
```

我不知道你有资格获得“大”的这个对象的大小，但是在迭代几 MB 的对象时没有问题（除了下载持续时间）。

# javascript - 将 div 从一个类包装到另一个类

> ID：11398377
> 
> 赞同：0
> 
> 时间：2012-07-09T15:35:36.357
> 
> 标签：javascript, jquery, html

我正在使用带有以下标记的日历：http: [//jsfiddle.net/PHznZ/](http://jsfiddle.net/PHznZ/)

使用 jQuery，我如何用一个名为的包含元素来包装每个星期（星期日`.start-week`到星期六） ？示例：http: [//jsfiddle.net/PHznZ/1/](http://jsfiddle.net/PHznZ/1/)`.end-week``.full-week`

这是目标 HTML 代码：

```
<div id="calendar">
    <article class="day start-week">
        <span class="dayname">Sunday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day">
        <span class="dayname">Monday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day">
        <span class="dayname">Tuesday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day">
        <span class="dayname">Wednesday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day">
        <span class="dayname">Thursday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day">
        <span class="dayname">Friday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day end-week">
        <span class="dayname">Saturday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day start-week">
        <span class="dayname">Sunday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day">
        <span class="dayname">Monday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day">
        <span class="dayname">Tuesday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day">
        <span class="dayname">Wednesday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day">
        <span class="dayname">Thursday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day">
        <span class="dayname">Friday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day end-week">
        <span class="dayname">Saturday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day start-week">
        <span class="dayname">Sunday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day">
        <span class="dayname">Monday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day">
        <span class="dayname">Tuesday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day">
        <span class="dayname">Wednesday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day">
        <span class="dayname">Thursday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day">
        <span class="dayname">Friday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day end-week">
        <span class="dayname">Saturday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day start-week">
        <span class="dayname">Sunday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day">
        <span class="dayname">Monday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day">
        <span class="dayname">Tuesday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day">
        <span class="dayname">Wednesday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day">
        <span class="dayname">Thursday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day">
        <span class="dayname">Friday</span>
        <p>Lorem ipsum...</p>
    </article>
    <article class="day end-week">
        <span class="dayname">Saturday</span>
        <p>Lorem ipsum...</p>
    </article>
</div> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-09T15:44:06.697

采用

```
​$(".start-week").each(function() {
    $(this).nextUntil('.end-week + *').andSelf().wrapAll('<div class="full-week">');
});​​​​​​​​​​​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-23T13:52:52.700

`[**fiddle Demo**](http://jsfiddle.net/cse_tushar/7mnAc/)`

```
$(".start-week").nextUntil('[class*="end-week"]').wrapAll('<div class="full-week">'); 
```

* * *

我很晚才回答:)

[罗马](https://stackoverflow.com/users/913761/roman)答案的更短和更快的版本。

# java - 气氛，JBoss AS 7.1.1，Chrome 问题

> ID：11398380
> 
> 赞同：1
> 
> 时间：2012-07-09T15:35:39.517
> 
> 标签：java, jboss, atmosphere

设置了 Atmosphere 1.0.0.beta1 并与 Jetty 一起运行。直截了当，简单有效。

但是在 JBoss AS 7.1.1 上运行时，它不喜欢 websocket 传输和降级。我在 Chrome 的控制台中看到以下日志（下）

当针对 Jetty 运行时，它与 Web 套接字传输连接，一切正常。由于某种原因，Chrome 无法降级。在 Firefox 和 IE9 中与 jetty 和 jboss 一起工作得很好。

那么如何让 websocket 传输与 JBoss 一起工作。是的，我用谷歌搜索并尝试了一个小时的各种事情，但无济于事。

谢谢。

```
Unexpected response code: 501 null:1
Websocket closed, reason: Connection was closed abnormally (that is, with no close frame being sent). jquery.atmosphere.js:1867
Websocket closed, wasClean: false jquery.atmosphere.js:1867
Websocket failed. Downgrading to Comet and resending jquery.atmosphere.js:1867
Websocket failed. Downgrading to Comet and resending jquery.atmosphere.js:1867
TransportFailure, fall back is sse ecm-websocket.js:34
Invoking executeSSE jquery.atmosphere.js:1867
Using URL: http://srdevecm1:8080/ecm/ecm-ws/main?X-Atmosphere-tracking-id=3b38258e-89a3-33cc-60d9-684956499835&X-Atmosphere-Framework=1.0&X-Atmosphere-Transport=sse&X-Cache-Date=0&Content-Type=application/json jquery.atmosphere.js:1867
Uncaught Error: SECURITY_ERR: DOM Exception 18 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:16:08.240

JBoss AS 7 目前没有 websockets 实现。有一个使用 JBossWeb 的[实现](https://github.com/mikebrock/jboss-websockets)，但尚未在上游提交。

# javascript - CouchDB - 地图函数中的变量

> ID：11398381
> 
> 赞同：3
> 
> 时间：2012-07-09T15:35:40.257
> 
> 标签：javascript, couchdb

我对 CouchDB 很陌生，并且有一个非常基本的问题：

是否有可能将变量从客户端传递到映射函数，例如：

```
function (doc, params) {
    if (doc.property > params.property) emit(doc, null);
} 
```

谢谢你的帮助，克里斯蒂安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:16:12.930

不，映射函数应该创建始终采用相同输入并产生相同输出的索引，以便它们可以保持增量。（而且很快）

如果您需要对视图的结果进行某种过滤，请考虑使用[`_list`](http://wiki.apache.org/couchdb/Formatting_with_Show_and_List/#Listing_Views_with_CouchDB_0.10_and_later)函数，因为它可以获取客户端提供的查询字符串变量并在其转换中使用它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T23:33:38.280

虽然 Dominic 的回答是正确的，但实际问题中的示例可能可以实现为具有适当键的 map 函数和包含`startkey`. 因此，如果您想要在示例中显示的功能，您应该将视图更改为：

```
function(doc) {
  if( doc.property )
    emit( doc.property, null);
} 
```

然后您的查询将变为：

```
/db_name/_design/view_doc/_view/view_name?startkey="property_param"&include_docs=true 
```

这会给你你的例子所暗示的你所追求的。

这是使用 CouchDB 的关键（双关语很有趣）：创建视图，允许您根据键选择视图的子集，使用或`key`和/或`keys`的某种组合`startkey``endkey`

# c# - 在 SQL 中检查重复的列值（不是键）

> ID：11398382
> 
> 赞同：1
> 
> 时间：2012-07-09T15:35:42.530
> 
> 标签：c#, sql, entity-framework

SQL 有没有办法强制执行唯一列值，而不是另一个表的主键？

例如，假设我有`TblDog`哪些字段：

1.  `DogId`-`Primary Key`
2.  `DogTag`-`Integer`
3.  `DogNumber`-`varchar`

`DogTag`和字段必须是唯一的`DogNumber`，但不链接到任何类型的表。

我能想到的唯一方法是在创建或编辑之前提取任何匹配的`DogTag`记录并提取任何匹配的记录`DogNumber`（不包括正在更新的当前记录。）这是在创建/编辑记录之前对数据库的两次调用。

**我的问题是**：有没有办法设置 SQL 来强制这些值是唯一的，而不将它们设置为键，或者`Entity Frameworks`（没有过多调用数据库）？

我知道我可以将两个调用组合为一个，但我需要能够准确地通知用户哪个字段已重复（或两者都重复）。

编辑：数据库是 SQL Server 2008 R2。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T15:39:31.997

正如 MilkywayJoe 建议的那样，在 SQL 数据库中使用唯一键约束。这些在插入 + 更新期间进行检查。

```
ALTER TABLE TblDog ADD CONSTRAINT U_DogTag UNIQUE(DogTag) 
```

和

```
ALTER TABLE TblDog ADD CONSTRAINT U_DogNumber UNIQUE(DogNumber) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-09T15:39:12.103

我建议设置[唯一约束](http://msdn.microsoft.com/en-us/library/ms191166%28v=sql.105%29.aspx)/[索引](http://msdn.microsoft.com/en-us/library/aa224827%28v=sql.80%29.aspx)以防止重复条目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T15:49:46.920

ALTER TABLE TblDog 添加约束 U_DogTag UNIQUE(DogTag)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T15:39:22.813

它看起来好像实体框架不支持它（还），[但*在*卡片上](http://blogs.msdn.com/b/efdesign/archive/2011/03/09/unique-constraints-in-the-entity-framework.aspx)。看起来您将需要使用[评论中提到的唯一约束](http://blog.sqlauthority.com/2007/02/05/sql-server-primary-key-constraints-and-unique-key-constraints/)直接在数据库中执行此操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-09T15:40:17.287

`CREATE UNIQUE INDEX idxUniqueDog ON TblDog (DogTag, DogNUmber)`

# vba - 代码卡在循环中，怎么了？

> ID：11398386
> 
> 赞同：0
> 
> 时间：2012-07-09T15:35:52.823
> 
> 标签：vba, ms-word

我有这段代码，它陷入了一个循环。我有类似的代码，它循环遍历文档，每个单词只更改一次。当我运行这个 sub 时，它会粘在第一个实例上并一遍又一遍地替换文本。

我希望它找到“因此”这个词，如果前面的“词”=; 跳过，否则更改为“因此（需要加入;）”。

我错过了什么/做错了什么？

提前致谢！

```
 Sub test()

 Dim wrd As Range
 For Each wrd In ActiveDocument.Words
    If InStr(1, wrd, "therefore") <> 0 Then
        If InStr(1, wrd.Previous(Unit:=wdWord, Count:=1).Text, ";") <> 0 Then
        Else
            wrd.Text = "therefore (needs joined with ;)"
        End If
    End If
Next
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:02:24.777

例如试试这个——因为我怀疑你是跳回到前一个单词并且你一遍又一遍地检查它，Word DOM 是一个很奇怪的......！

```
Sub test() 

 Dim wrd As Range 
 For Each wrd In ActiveDocument.Words 
    If InStr(1, wrd, "therefore") <> 0 Then 
        If InStr(1, wrd.Previous(Unit:=wdWord, Count:=1).Text, ";") = 0 Then 
            wrd.Text = "therefore (needs joined with ;)" 
        End If 

        wrd.Next Unit:=wdWord, Count:=1
    End If 
Next 
End Sub 
```

# opencv - 使用已知物体尺寸从图片中测量物体

> ID：11398387
> 
> 赞同：5
> 
> 时间：2012-07-09T15:35:53.040
> 
> 标签：opencv, computer-vision, photogrammetry

所以我需要做的是从普通用户拍摄的图像中测量脚长。该图像将包含一只穿着黑色袜子的脚、一枚硬币（或其他已知尺寸的物体）和一张白纸（例如 A4），其他两个物体将放在上面。我已经拥有了什么？-我已经使用过opencv，但只是简单的项目；- 我已经开始阅读一些关于相机校准的文章（[“Learn OpenCv”](http://www.amazon.co.uk/Learning-OpenCV-Computer-Vision-Library/dp/0596516134/ref=sr_1_1?ie=UTF8&qid=1341846705&sr=8-1)），但仍然不知道我是否必须走这么远。

我现在需要的是一些方向，因为我仍然不明白我是否按照正确的方法来解决这个问题。我有一些问题：我真的需要校准相机来测量脚的两个或三个测量值吗？我怎样才能找到兴趣点来测量线，每张图片都是不同的图片，或者有一些技巧可以遵循？

Ps：对不起我的英语，我真的必须提高它：-/

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T19:02:43.367

首先，一些图像采集的东西：

1.  你能指望黑色袜子和白色背景吗？颜色并不像袜子和背景之间的高对比度那么重要。
2.  你能标准化视角吗？直接向下看脚会减少透视失真。
3.  你能标准化场景的照明吗？这将简化下面讨论的许多处理。
4.  最后，如果您缩放（或将相机放置得更近）以使脚部填充更多图像帧，您将获得更好的估计。

分析。（请注意，此讨论将针对您识别脚轴的问题。识别和分析硬币将使用类似的过程，但会出现一些差异。）

1.  下一个任务是隔离感兴趣区域 (ROI)。如果您的相机向下看脚，则 ROI 可以限制在白色矩形内。我对这个 Stack Overflow 帖子的回答是正方形/矩形识别的良好开端：[检测图像中矩形的最简单的*正确*方法是什么？](https://stackoverflow.com/questions/8512013/what-is-the-simplest-correct-method-to-detect-rectangles-in-an-image)
2.  如果脚完全位于白色矩形中，您可以将图像剪辑到步骤 #1 中找到的矩形。这会将图像分析限制在白皮书内的区域。
3.  使用阈值函数“二值化”图像：http: [//opencv.willowgarage.com/documentation/cpp/miscellaneous_image_transformations.html#cv-threshold](http://opencv.willowgarage.com/documentation/cpp/miscellaneous_image_transformations.html#cv-threshold)。如果你选择好阈值参数，你应该能够将图像缩小为黑色区域（袜子像素）和白色区域（非袜子像素）。
4.  现在乐趣开始了：您可以尝试匹配轮廓，但如果这是我的问题，我会使用边界框来快速解决或使用更有趣（并且可能更强大）的解决方案。
5.  使用 cvFindContours 查找黑色（袜子）区域的轮廓：http: [//opencv.willowgarage.com/documentation/structural_analysis_and_shape_descriptors.html#findcontours](http://opencv.willowgarage.com/documentation/structural_analysis_and_shape_descriptors.html#findcontours)
6.  使用 cvApproxPoly 将轮廓转换为多边形 [http://opencv.willowgarage.com/documentation/structural_analysis_and_shape_descriptors.html#approxpoly](http://opencv.willowgarage.com/documentation/structural_analysis_and_shape_descriptors.html#approxpoly)
7.  对于简单的解决方案，使用 cvMinRect2 为袜子形状找到一个任意方向的边界框。盒子的短轴应该对应于 largura.jpg 中的行，盒子的长轴应该对应于 comprimento.jpg 中的行。 [http://opencv.willowgarage.com/documentation/structural_analysis_and_shape_descriptors.html#minarearect2](http://opencv.willowgarage.com/documentation/structural_analysis_and_shape_descriptors.html#minarearect2)
8.  如果您想要更多（可能的）准确性，您可以尝试使用 cvMoments 来计算形状的矩。[http://opencv.willowgarage.com/documentation/structural_analysis_and_shape_descriptors.html#moments](http://opencv.willowgarage.com/documentation/structural_analysis_and_shape_descriptors.html#moments)
9.  使用 cvGetSpatialMoment 确定脚的轴。有关空间时刻的更多信息，请参见：[http](http://en.wikipedia.org/wiki/Image_moments#Examples_2) ://en.wikipedia.org/wiki/Image_moments#Examples_2和此处[http://opencv.willowgarage.com/documentation/structural_analysis_and_shape_descriptors.html#getspatialmoment](http://opencv.willowgarage.com/documentation/structural_analysis_and_shape_descriptors.html#getspatialmoment)
10.  在已知轴的情况下，您可以旋转图像以使长轴与轴对齐（即垂直）。然后，您可以简单地水平和垂直计算像素以获得线条的长度。请注意，在这个面向矩的过程中有几个假设。这是一个有趣的解决方案，但它可能无法提供更高的准确性 - 特别是因为尺寸测量的准确性在很大程度上取决于上面讨论的相机定位问题。

最后，我提供了旧 C 接口的链接。您可能会看一下新的 C++ 接口（我只是还没来得及将我的代码迁移到 2.4）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-10T11:51:24.973

安东尼奥·克里米尼西（Antonio Criminisi）可能在几年前就这个主题写下了最后一句话。如果您有时间，请参阅他的[“Single View Metrology”](http://research.microsoft.com/apps/pubs/default.aspx?id=67278)论文和他的博士论文。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-03T20:49:42.917

我不确定您是否需要自己构建它，但如果您只需要这样做，而不是编写代码。您可以为此使用[KLONK 图像测量](http://www.imagemeasurement.com)。有免费和付费版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T16:05:09.603

如果图像中有已知大小的物体，则无需校准相机。好吧...至少如果您的相机不会扭曲太多并且您不期望高质量的测量结果。

一种简单的方法是检测一个白色（透视失真）矩形，将角映射到一个未失真的矩形（使用例如 cv::warpPerspective()）并使用该矩形的已知大小来确定其他对象的大小图片。但这仅适用于与纸张处于同一平面的物体，最好不要离它太远。

# wpf - 调整宽度与文本宽度成比例的 WPF 列表视图列的大小

> ID：11398389
> 
> 赞同：2
> 
> 时间：2012-07-09T15:36:00.560
> 
> 标签：wpf, listview, resize

我有一个 WPF ListView 表，默认将列标题调整为每个标题文本的宽度。这不会均匀地填满整个表格；我在左边有一堆挤压的柱子，在右边有一个空置的空间。

我希望能够将列的大小调整为与列文本、标题或行中最长项目成比例的宽度。我该怎么做？

我目前正在做的最初是使用以下代码（其中 SearchResultsTable 是 ListView）将标题调整为与标题文本成比例的宽度：

```
private void Resize()
{
    var width = SearchResultsTable.ActualWidth;
    var gridView = SearchResultsTable.View as GridView;
    var columns = new GridViewColumnCollection();
    if (gridView != null)
    {
        columns = gridView.Columns;
    }
    var initialColumnWidths = columns.Sum(column => column.ActualWidth);
    var scale = width / initialColumnWidths;
    foreach (var column in columns)
    {
        column.Width = column.ActualWidth * scale;
    }
} 
```

但是，这仅根据标题文本宽度调整大小；我不知道如何获得标题和行的最大宽度。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-12T15:09:28.650

这就是我正在做的事情。希望这可以帮助。您可以在 ListView 中获取或设置 GridView 列的宽度，我使用 ListView 控件本身的宽度来增加/减少每个 ListView 列的相对宽度以按比例填充空间 - 然后扩展最后一列。

您可以做的是修改我的代码，以在我刚刚添加的条件“if（total_width < e.NewSize.Width”）中按比例分配列的总宽度和 ListView 的宽度之间的差异与最后一列宽度的差异。

```
LV_FileList.SizeChanged += this.onLV_FileList_SizeChanged; 
```

...

```
 /// <summary>
    /// Proportionally resize listview columns when listview size changes
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    private void onLV_FileList_SizeChanged(object sender, SizeChangedEventArgs e)
    {
        if ((sender is ListView) && 
            (e.PreviousSize.Width > 0))
        {
            double total_width = 0;
            GridViewColumnCollection gvcc = ((GridView)(sender as ListView).View).Columns;
            foreach (GridViewColumn gvc in gvcc)
            {
                gvc.Width = (gvc.Width / e.PreviousSize.Width) * e.NewSize.Width;
                total_width += gvc.Width;
            }

            //Increase width of last column to fit width of listview if integer division made the total width to small
            if (total_width < e.NewSize.Width)
            {
                gvcc[gvcc.Count - 1].Width += (e.NewSize.Width - total_width);
            }

            //Render changes to ListView before checking for horizontal scrollbar
            this.AllowUIToUpdate();

            //Decrease width of last column to eliminate scrollbar if it is displayed now
            ScrollViewer svFileList = this.FindVisualChild<ScrollViewer>(LV_FileList);
            while ((svFileList.ComputedHorizontalScrollBarVisibility != Visibility.Collapsed) &&  (gvcc[gvcc.Count - 1].Width > 1))
            {
                gvcc[gvcc.Count - 1].Width--;
                this.AllowUIToUpdate();
            }
        }
    }

    /// <summary>
    /// Threaded invocation to handle updating UI in resize loop
    /// </summary>
    private void AllowUIToUpdate()
    {
        DispatcherFrame dFrame = new DispatcherFrame();

        Dispatcher.CurrentDispatcher.BeginInvoke(DispatcherPriority.Render, new DispatcherOperationCallback(delegate(object parameter)
        {
            dFrame.Continue = false;
            return null;

        }), null);

        Dispatcher.PushFrame(dFrame);
    } 
```

# perl - 行/字符串比较忽略 Perl 中具有特征开始和结束词的可变长度字符串的某些部分

> ID：11398392
> 
> 赞同：0
> 
> 时间：2012-07-09T15:36:10.933
> 
> 标签：perl, comparison, line

我想比较来自 2 个不同文件的两行。但我想忽略以“SubmissionTime:”开头并以“execEndTime:”结尾的任何部分。例如

如果

```
$line1="TestSubmissionTime123execEndTime"  
$line2="TestSubmissionTime1234567789012131231execEndtime" 
```

这两条线应该相等。因此在 submitTime 和 execEndTime 之间可能存在可变数据量。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:42:43.613

好吧，从技术上讲，您可以通过以下方式轻松地从字符串中删除不需要的数据：

```
sub compare_by_my_rules {
  my ($line1, $line2) = @_;
  $line1 =~ s/(?<=SubmissionTime).+?(?=execEndTime)//g;
  $line2 =~ s/(?<=SubmissionTime).+?(?=execEndTime)//g;
  return $line1 cmp $line2;
} 
```

换句话说，传递到此例程的字符串通过使用环视删除了它们的违规部分 -`lookbehind`对于“SubmissionTime”，`lookahead`对于“execEndTime” - 然后进行比较。但实际上你可以删除整个块：

```
 =~ s/SubmissionTime.*?execEndTime//g; 
```

...因为这些标记注定是相等的，根本不会影响比较。

`.*?`用于处理具有多个 SubmissionTime 部分的字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T15:45:17.203

尝试在 submitTime 和 execEndTime 之间替换任何内容，然后进行比较。例如：

```
my $line1 = "TestSubmissionTime123execEndTime";
my $line2 = "TestSubmissionTime1234567789012131231execEndTime";

$line1 =~ s/TestSubmissionTime.*execEndtime//;
$line2 =~ s/TestSubmissionTime.*execEndTime//;
if $line1 eq $line2 {...} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T15:59:26.090

听起来像一个子程序的好工作：

```
use strict;
use warnings;

my $line1="TestSubmissionTime123execEndTime"; 
my $line2="TestSubmissionTime1234567789012131231execEndtime" ;

print comp($line1, $line2) ? "Same" : "Not same";

sub comp {
    my ($str, $cmp) = @_;
    $str =~ s/SubmissionTime.*?execEndTime//ig;
    $cmp =~ s/SubmissionTime.*?execEndTime//ig;
    return ($str eq $cmp);
} 
```

我使用了`/i`(ignore case) 修饰符，因为您的示例字符串同时包含`Endtime`and `EndTime`，并且您说它们应该相等。如果这是一个错字，并且大小写很重要，请删除`/i`. 我使用 global`/g`修饰符来删除这些字符串的所有出现。

原始字符串不会被更改。

# ruby-on-rails - Gemfile 中的更改不会反映在 Gemfile.lock 中

> ID：11398396
> 
> 赞同：1
> 
> 时间：2012-07-09T15:36:19.497
> 
> 标签：ruby-on-rails, heroku, sqlite

在尝试部署一个简单的 Rails 应用程序时，我遇到了臭名昭著的 SQLite3 Vs Heroku 错误。

最初我的`Gemfile`样子

```
gem 'sqlite3'
... 
```

在谷歌上搜索该主题后，我将其更新为如下所示：

```
group :development, :test do
  gem 'sqlite3'
end
... 
```

然后做了一个捆绑安装，令人惊讶的是（至少对我来说），

```
$ git status --short 
M Gemfile 
```

没有`Gemfile.lock`改变！

现在 heroku 一次又一次地给出这个 SQLite 错误，因为`Gemfile.lock`它和以前一样，并且 bundle install 在他们的服务器上一直失败！

我哪里错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:01:51.643

该死！这是一个 git 问题。我在一个名为“deploy”的分支上工作，并试图推送“master”分支，因此每次捆绑安装都失败！

```
$git push heroku deploy:master 
```

这使它工作:)

# sql - Oracle - 如何使用合并来根据其他表和列中的值更新列

> ID：11398397
> 
> 赞同：4
> 
> 时间：2012-07-09T15:36:21.403
> 
> 标签：sql, oracle

我想根据其他列和其他表的值比较来更新 closed_date 列中的值。我使用了 Oracle 合并到语句。但它给了我一个错误：

错误：ORA-00969：缺少 ON 关键字

我不确定出了什么问题。我想念什么吗？下面是我的脚本：

```
MERGE INTO PR_DMN dmn
USING (select alg.PR_DMN_ID, alg.PR_ACTIVITY_ID, alg.ACTIVITY_TS from PR_ACTIVITY_LOG) alg
ON dmn.PR_DMN_ID = alg.PR_DMN_ID
-- update
WHEN MATCHED THEN
UPDATE SET dmn.CLOSED_DATE =
    (CASE 
        WHEN alg.PR_ACTIVITY_ID IN ('10009', '10010', '10011', '10013') THEN alg.ACTIVITY_TS
        WHEN alg.PR_ACTIVITY_ID = '10005' AND dmn.CONT_RESP_TS <= dmn.CONT_RESP_DUE_TS THEN dmn.CONT_RESP_TS 
        WHEN alg.PR_ACTIVITY_ID = '10008' AND dmn.CORR_RESP_TS <= dmn.CORR_RESP_DUE_TS THEN dmn.CORR_RESP_TS
        ELSE dmn.CLOSED_DATE 
    END) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-09T17:27:15.087

您有两个错误，您可以通过一个简单的示例看到。首先，该`on`子句需要用括号括起来。其次，您不能`using`在该子查询的子句中引用子选择的别名。

如果我使用您的表名设置一个简单的示例，如下所示：

```
create table pr_dmn as
 select level as a, sysdate as b
   from dual
connect by level <= 10;

Table created.

create table PR_ACTIVITY_LOG as
 select level as a, sysdate as b
   from dual
connect by level <= 20;

Table created. 
```

然后执行正确的查询，它应该可以工作：

```
merge into pr_dmn dmn
 using (select a, b from pr_activity_log) alg -- no alg. inside the sub-query
    on (dmn.a = alg.a) -- wrapped in parenthesis
  when matched then
update set dmn.b = alg.b
       ;

10 rows merged. 
```

[尽管文档](http://docs.oracle.com/cd/E11882_01/server.112/e26088/statements_9016.htm#SQLRF01606)中也有一些很好的示例，但我总是发现[PSOUG](http://psoug.org/reference/merge.html)是此类事情的一个很好的参考。

# android - 从地图上绘制的线获取所有坐标

> ID：11398398
> 
> 赞同：0
> 
> 时间：2012-07-09T15:36:29.140
> 
> 标签：android, google-maps, openstreetmap

在我的`MapView`我可以点击地图以创建任意数量的点，并且这些点通过一条线连接，但我不想像这样在地图上绘制任何可能与另一条线相交的线

![在此处输入图像描述](../Images/0869f60e26ae00eb251a2dfc3c517f05.png)

无论如何要获取线的坐标来检查新线是否会与其他线相交？

或者，如果其他人对如何检查这一点有任何建议，那也很棒

这是我绘制线条的绘制方法

```
@Override
    public void draw(final Canvas canvas, final MapView mapView, final boolean shadow){
        super.draw(canvas, mapView, shadow);

        try{
        Paint paint = new Paint();
        paint.setAntiAlias(true);
        paint.setDither(true);
        paint.setColor(Color.RED);
        paint.setStrokeWidth(3);
        paint.setAlpha(100);
        paint.setStyle(Style.STROKE);

        Path path = new Path();
        Point point1 = null;
        boolean runOnce = false;
        for(int i = 0;i<items.size();i++){
            Point point = new Point();
            mapView.getProjection().toPixels(items.get(i).mGeoPoint, point);

            if(!runOnce)
            {
                path.moveTo(point.x, point.y);
                point1 = new Point(point.x, point.y);
                runOnce = true;
            }
            else
            {
                path.lineTo(point.x, point.y);
            }
        }
        path.lineTo(point1.x, point1.y);
        canvas.drawPath(path, paint);

        path.lineTo(point1.x, point1.y);
        canvas.drawPath(path, paint);

        Paint paint2 = new Paint();
        paint2.setAntiAlias(true);
        paint2.setDither(true);
        paint2.setColor(Color.RED);
        paint2.setStrokeWidth(3);
        paint2.setAlpha(20);
        paint2.setStyle(Style.FILL);

        Path path2 = new Path();
        Point point2 = null;
        boolean runOnce2 = false;
        for(int i = 0; i < items.size(); i++)
        {
            Point point = new Point();
            mapView.getProjection().toPixels(items.get(i).mGeoPoint, point);

            if(!runOnce2)
            {
                path2.moveTo(point.x, point.y);
                point2 = new Point(point.x, point.y);
                runOnce2 = true;
            }
            else
            {
                path2.lineTo(point.x, point.y);
            }
        }

        path2.lineTo(point2.x, point2.y);
        canvas.drawPath(path2, paint2);
        }catch(Exception e){

        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T14:57:48.097

你去:-)

[paulbourke.net/geometry/lineline2d](http://paulbourke.net/geometry/lineline2d/)

告诉你如何用数学方法确定两条线段的交点。

如果您不希望您的端点算作交叉点，那么只需先检查您的端点是否重叠。这可以使用如下的 if 语句来解决：

```
if(Math.abs(x1 - x2) < EPSILON && Math.abs(y1 - y2) < EPSILON) 
```

其中 EPSILON 是您的容错值，例如 0.001。

# php - 一个类中的静态属性由另一个类设置

> ID：11398399
> 
> 赞同：0
> 
> 时间：2012-07-09T15:36:32.353
> 
> 标签：php, inheritance, static, prepared-statement

我一直在研究 PHP 5.3.x 中的一小部分遵循 Active Record 模式的类。但是，在使用静态属性时，我遇到了一个问题。这是我一直在测试的代码：

```
<?php

class dbPreparedObject {

    public static $insert = "";

    public function __construct() {
        static::$insert = "autoinsert_".get_called_class();
    }
}

class gtRecord extends dbPreparedObject {}
class nRecord extends dbPreparedObject {}

$a = new gtRecord();
$b = new nRecord();

var_dump(gtRecord::$insert);
var_dump(nRecord::$insert); 
```

输出：

```
string(18) "autoinsert_nRecord"
string(18) "autoinsert_nRecord" 
```

但是，我希望第一个字符串读取`autoinsert_gtRecord`.

似乎没有由子类实例化的静态属性是捆绑在一起的。有没有办法将它们分开而不`public static $insert = ""`在每个子类中声明？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:52:38.733

这是预期的行为。在 PHP 中，声明为静态的属性在创建的对象的所有实例之间共享。也就是说，在of或其继承的类`$insert`的所有实例中只有一个实例。`dbPreparedObject`

您看到`autoinsert_nRecord`这两个`var_dump`s 的原因是因为那是您创建的最后一个对象。

考虑这个微小的变化：

```
$a = new gtRecord();
var_dump(gtRecord::$insert); // autoinsert_gtRecord

$b = new nRecord();    
var_dump(nRecord::$insert);  // autoinsert_nRecord
var_dump(gtRecord::$insert); // autoinsert_nRecord (because it was the last one set) 
```

在第一个 var_dump 之后，值为`_gtRecord`，但是一旦`nRecord`创建了一个对象，静态属性（对于所有 dbPreparedObject 对象）就会更改为`nRecord`因为那是最后一个类。

因此，如果您计划拥有此类的多个实例，`$insert`则不能是静态的，因为它并不总是包含您在给定代码时期望的值，因为只有一个静态`$insert`属性的副本对于所有对象都是相同的。一旦你在一个对象中改变它，你就在所有对象中改变它。

所以我们需要问为什么`$insert`需要是静态的或者你有什么其他的选择，这样你就不会遇到这个问题。

# jquery - 即使相同的 URL 将返回内容，Jquery AJAX 也会返回错误。这是为什么？

> ID：11398401
> 
> 赞同：0
> 
> 时间：2012-07-09T15:36:50.457
> 
> 标签：jquery, asp.net, ajax, web-services

我有一个 jquery AJAX 请求调用一个 web 服务，结果字符串被返回 =“测试！”。当我通过 url 发出请求时，它返回： {"testResult":"Tested!"} 这对我来说很有意义。

我的错误是 jQuery AJAX 请求将命中 web 服务，命中断点并返回字符串，但仍然命中错误代码而不是成功。

错误代码如下：

```
 //function(xhr,status,message)
 xhr.statusText = success
 status = parseerror
 message: Error Jquery17204...   was not called. 
```

下面是我的 AJAX 请求。也许有一些我没有得到的错误，这导致返回的代码出错。

```
$.ajax({
            type: 'GET',
            url: WEBSERVICE_URL + '/test',
            dataType: 'jsonp',
            success: function (result, textStatus, jqXHR) {
                //success
                result = JSON.parse(result);
                var r = $(result.getWebFormDesignFieldContentsResult)[0];
                var div = $("<div class='modal'>").html(r.d);
                /*
                var d = document.createElement("div");
                d.className = "modal";
                d.appendChild(r[0]);
                */
                $("div.modal").replaceWith(div);
                $("div.modal #queryInput").val(opts);
                $("div.modal").css({
                    top: $(window).height() / 2 - $("div.modal").height() / 2,
                    left: $(window).width() / 2 - $("div.modal").width() / 2
                });
                $("div.modal").fadeIn();
            },
            error: function (xhr, status, message) {
                //error
                //alert("Error: "+result.statusText);
                alert("Error: " + status + " " + message);

                //$("div.modal").replaceWith($("<div class = 'modal'>").html(result.responseText));
                //$("div.modal").fadeIn();
                $("div.overlay").fadeOut();
            }
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T15:42:54.723

您正在进行 JSONP 调用，因此从服务器返回的结果必须如下所示：

```
Jquery17204({"testResult":"Tested!"}) 
```

服务器应获取查询字符串`callback`并用作函数名称。在这种情况下发送的 AJAX 请求`callback=Jquery17204`。

# ios - iOS - UITapGesture 开始和结束了吗？

> ID：11398403
> 
> 赞同：0
> 
> 时间：2012-07-09T15:37:08.253
> 
> 标签：ios, xcode, uibutton, uitapgesturerecognizer

# 问题：

我正在尝试使用`UITapGestureRecognizer`. 本质上，当用户点击时，我希望背景改变颜色，并且在释放或完成时，背景颜色回到零，或者没有背景颜色。

此操作类似于 default `UIButton`，但我需要将其放在视图上。

# 问题：

我尝试使用类似于以下的代码：

```
- (void)handleTapGesture:(UITapGestureRecognizer *)recognizer
{
        if(recognizer.state == UIGestureRecognizerStateBegan) {
            self.backgroundColor = [UIColor greenColor];
        }

        if(recognizer.state == UIGestureRecognizerStateEnded) {
            self.backgroundColor = nil;
        }
} 
```

没有任何成功。这是知道点击手势何时开始和结束的正确方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:05:50.237

使用这些方法可能会更容易，这些方法应该已经成为 UIViewController 中响应者链的一部分，除非它们已经在其他地方处理

```
- (void) touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {    
    //CGPoint touchPoint = [[touches anyObject] locationInView:self.view];
    NSLog(@"began");
}

- (void) touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
    //CGPoint touchPoint = [[touches anyObject] locationInView:self.view];
    NSLog(@"end");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:27:12.887

如果您正在使用情节提要或通过界面构建​​器以某种方式使用，则可以使用 UIButton，将其拖出一点以将其形成背景，然后您可以对其进行设置，以便在收到触摸事件时显示不同的自定义颜色背景图像被按住的持续时间。

希望有帮助！

# jquery-ui - 如何在函数中使用 jQuery UI 滑块并为选择器传递不同的参数？

> ID：11398404
> 
> 赞同：3
> 
> 时间：2012-07-09T15:37:10.387
> 
> 标签：jquery-ui, jquery-ui-slider

我是一个 jQuery 新手。我一直试图让 UI 滑块工作，但到目前为止还没有任何运气。我想要做的是能够将参数传递给函数，以便该参数可以用作滑块中的选择器。其中一个参数是滑块 div 的 id，另一个是伴随它的输入文本框的 id。哦，UI 滑块是一个基本的步进滑块，如演示中所示。

以下是与此相关的 HTML 和 JS 文件的一部分：

HTML 部分：

```
<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="content/jquery-ui/development-bundle/themes/smoothness/jquery.ui.all.css">
    <script type="text/javascript" src="content/jquery-ui/development-bundle/jquery-1.7.2.js"></script>
    <script type="text/javascript" src="content/jquery-ui/development-bundle/ui/jquery.ui.core.js"></script>
    <script type="text/javascript" src="content/jquery-ui/development-bundle/ui/jquery.ui.widget.js"></script>
    <script type="text/javascript" src="content/jquery-ui/development-bundle/ui/jquery.ui.mouse.js"></script>
    <script type="text/javascript" src="content/jquery-ui/development-bundle/ui/jquery.ui.slider.js"></script>
    <script type="text/javascript" src="journal.js"></script>
</head>
<body>
    <section id="journalEntry">
                <div id="base">
                    <label for="intensity">How intense was it?</label>  <input type="text" id="intensity" /><div id="intensityGuage"></div> 
                </div>
        </section>
</body>
</html> 
```

jQuery部分：

```
$(document).ready(function(){
        guageBar(intensityGuage,intensity);
});

function guageBar(guageId,inputId){
        $( "[id='"+guageId+"']" ).slider({
            value:1,
            min: 1,
            max: 10,
            step: 1,
            slide: function( event, ui ) {
                $( "id[='"+inputId+"']" ).val( ui.value );
            }
        });
        $( "id=['"+inputId+"']" ).val( $( "id=['"+guageId+"']" ).slider( "value" ) );
} 
```

在此先感谢您的帮助 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:38:26.200

试试这个：

```
$(document).ready(function() {
    guageBar('intensityGuage', 'intensity');
});
function guageBar(guageId, inputId) {
    $("#" + guageId).slider({
        value: 1,
        min: 1,
        max: 10,
        step: 1,
        slide: function(event, ui) {
            $("#" + inputId).val(ui.value);
        }
    });
    $("#" + inputId).val($("#" + guageId).slider("value"));
}​ 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/NrLnx/1/)**

您将变量而不是字符串传递给您的函数，并且您也没有正确引用 ID。

# c - Apple 开源开发者库

> ID：11398405
> 
> 赞同：1
> 
> 时间：2012-07-09T15:37:12.550
> 
> 标签：c, macos, cmake

最近在寻找特定头文件时遇到了问题。直到我在谷歌搜索中偶然发现它的来源时，我才在任何地方找到它，这导致我进入了这个网站：

[http://opensource.apple.com/release/mac-os-x-1068/](http://opensource.apple.com/release/mac-os-x-1068/)

我的问题：这些项目应该一次一个地单独下载，以便在 OSX 上使用，还是应该已经包含在 OSX 的某些开发人员包中？我是一个新的 OSX 用户，我目前所知道的是我在盒子上有 xcode，但似乎缺少我的代码（给我的）正在寻找的一些库。

这是我的 cmake 文件的样子：

```
project(myproject)
cmake_minimum_required(VERSION 2.8)
SET(CMAKE_BUILD_TYPE debug)
SET(CMAKE_C_FLAGS_DEBUG "-g -fPIC -O0 -pipe -std=c99")
SET(CMAKE_VERBOSE_MAKEFILE TRUE)
file(GLOB HEADER_LIST ./include/*.h)
include_directories(./include)
add_executable(${PROJECT_NAME} ${SRC_LIST} ${HEADER_LIST})
target_link_libraries(${PROJECT_NAME} -lpcap) 
```

我的源文件有

```
#include <net/bpf.h>
#include <pcap.h> 
```

但是，我在尝试使用应该在 pcap 中未定义的结构时遇到了一些错误。我应该将 pcap 与这个苹果开源库分开，还是作为更大包的一部分？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T15:47:43.510

编辑：您的问题是您依赖于私有的内部数据结构。`pcap-int.h`未提供，因为它不是公共 API 的一部分。

* * *

大多数库头文件（包括 pcap）在 中可用`/usr/include`，但通常您从开发人员 SDK 链接它们，以便您可以控制您正在构建的特定版本。要使用 cmake 包含和链接正确的头文件和库，通常使用该`CMAKE_OSX_SYSROOT`变量。您可以使用 控制部署目标`CMAKE_OSX_DEPLOYMENT_TARGET`。例如，这是我的一个旧的：

```
set(CMAKE_OSX_SYSROOT "/Developer/SDKs/MacOSX10.5.sdk")
set(CMAKE_OSX_DEPLOYMENT_TARGET 10.4) 
```

最新版本的 Xcode 不再存在`/Developer`，因此您需要指向`/Applications/Xcode.app`. 您可以使用以下方法获得正确的路径：

```
xcode-select -print-path 
```

并非 opensource.apple.com 上的所有内容都可以直接在 SDK 中使用。有些事情是私人的。您可以从 opensource.apple.com 安装它们，尽管我经常发现它们不会以这种方式正确构建（您经常不得不从 Apple 安装许多其他软件包，这会让人头疼）。如果您需要类似的东西，通常只需安装“普通”版本并将其静态链接到您的程序中会容易得多。

但是 pcap 应该可以正常工作。你真正看到了什么问题？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T15:42:46.247

它们不一定“在 OSX 上使用”，它们**是**MacOS X。MacOS X 的核心是 Darwin，Apple 通过[http://opensource.apple.com](http://opensource.apple.com)提供了 Darwin 的源代码。您可以查看这些项目以了解 Darwin 的工作原理。您可以修改它们并构建您自己的 Darwin 版本。如果您发现它适用，您可以在您自己的项目中使用该代码（根据您正在查看的任何组件所附的许可条款）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T15:55:59.873

OS X is released without the header files needed to build components. A vanilla 10.7 OS X does not even have a `/usr/include` directory. Downloading `Xcode` is the first step. Then you either need to install the `Command Line Tools` option (`Preferences` -> `Downloads` -> `Components`) within Xcode to install the headers or you need to ensure your project's build system uses the SDKs provided by Xcode. If you don't need the Xcode IDE, you can now also download the `Command Line Tools` component of Xcode 4.3 separately from the Apple Developer Connection web site.

# .net - Can C++/CLI .NET use resource .resx files for localization?

> ID：11398407
> 
> 赞同：3
> 
> 时间：2012-07-09T15:37:15.103
> 
> 标签：.net, localization, c++-cli

I am trying to localize a managed C++ .NET DLL for multiple languages. The forms are easy enough because they operate just like the other languages and create multiple .resx files.

I cannot find any examples of localizing embedded strings in managed C++, other than to use .RC string tables in the traditional C++ way. Is there any way to use .resx resource files to facilitate use with resource editors like [Zeta](http://zetaresourceeditor.codeplex.com/), etc?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-09T17:40:15.887

Create a separate resources file in managed C++ containing all the error messages of the application. To do that, right-click on your managed C++ project in the solution explorer and Add / New Item of type Assembly Resource File (.resx). Give it the name MyMessages.resx for example.

Add your strings there, for example a message with the name "Error".

In your code you can retrieve the string as follows, assuming that your root namespace name is "MyApp".

```
Resources::ResourceManager^ rm = gcnew Resources::ResourceManager(L"MyApp.MyMessages", this->GetType()->Assembly);

MessageBox::Show(rm->GetString(L"Error")); 
```

You can later localize your error messages in French for example, by creating another Assembly Resource File with the name MyMessages.fr.resx.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:54:38.020

You actually can use *.resx to localize your applications:

[.NET Localization, Part 1: Resource Managers](http://ondotnet.com/pub/a/dotnet/2002/09/30/manager.html ".NET Localization, Part 1: Resource Managers")

[.NET Localization, Part 2: Creating Satellite Assemblies](http://ondotnet.com/pub/a/dotnet/2002/10/14/local2.htm ".NET Localization, Part 2: Creating Satellite Assemblies")

# http - 在 express.js 中接受 POST 请求

> ID：11398410
> 
> 赞同：0
> 
> 时间：2012-07-09T15:37:19.553
> 
> 标签：http, node.js, express

我已经阅读了有关如何配置 express 以侦听 POST 请求的其他几个问题，但是当我尝试打印发送到服务器的简单 POST 查询时，我不断得到空 JSON 或未定义。

我有这个设置：

```
//routes
require('./routes/signup.js')(app);

// Configuration
app.configure(function(){
    app.use(connect.bodyParser());
    app.use(express.methodOverride());
    app.register(".html", hulk);
    app.set('views', __dirname + '/views');
    app.set('view options', {layout: false});
    app.set('view engine', 'hulk');
    app.use(express.static(__dirname + '/public'));
    app.use(app.router);
}); 
```

然后`routes/signup.js`看起来像这样：

```
var common_functions = require('../common_functions.js');
var views            = require('../views/view_functions.js');
var globals          = require('../globals.js');
var mongoose         = require('mongoose');

//declare classes
var User = mongoose.model('User');

module.exports = function(app){
    /**
     * SignUp GET
     */
    app.get('/signup', function(req, res){
        res.render('signup/signup.html');
    });

   /**
    * SignUp POST
    */
   app.post('/signup', function(req, res){
    console.log(JSON.stringify(req.body));
    console.log(req.body);
    res.send(JSON.stringify(req.body));
}); 
```

}

模板如下所示：

```
{{> header.html }}
{{> navigation.html }}
{{> body.html }}
<form action="/signup" method="post">
    <input name="email"/>
    <input type="submit"/>
</form>
{{> footer.html }} 
```

任何部分都没有什么特别感兴趣的。

两者`console.log`打印出 undefined 而`res.send()`只是返回与以前相同的 html。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:59:01.917

Express 会在第一次调用路由器的任何动词函数时自动安装路由器中间件（如果尚未安装）。因此，通过在配置块上方加载路由，路由器中间件是堆栈中的第一个中间件（在 bodyParser 上方）。将加载路由文件移动到配置块下方将解决此问题。

从 Express.js 文档的配置部分：

`Note the use of app.router, which can (optionally) be used to mount the application routes, otherwise the first call to app.get(), app.post(), etc will mount the routes.`

[http://expressjs.com/guide.html#configuration](http://expressjs.com/guide.html#configuration)

# git - git-svn 克隆意外失败

> ID：11398415
> 
> 赞同：7
> 
> 时间：2012-07-09T15:37:26.457
> 
> 标签：git, git-svn

我运行以下命令：

```
git svn clone --stdlayout --no-metadata -A users.txt -r 3760:4662 svn://kumquat.geoplan.ufl.edu/Projects/S4-Geocoding S4-Geocoding-SVN.git 
```

它开始运行并运行了一段时间，然后炸弹：

```
...
        M       S4.Geocoding.Client/App.xaml.cs
        M       S4.Geocoding.Client/MainPage.xaml.cs
        M       S4.Geocoding.Client/CodingPage.xaml
        M       S4.Geocoding.Client/CodingPage.xaml.cs
r4163 = 498dad8ce3730390393fc13b183fdbbff7108e6b (refs/remotes/trunk)
        M       S4.Geocoding.Client/CodingPage.xaml.cs
r4164 = 728b706b27d60d91659c144c3fac98cdbd1b09b2 (refs/remotes/trunk)
Found possible branch point: svn://kumquat.geoplan.ufl.edu/Projects/S4-Geocoding/trunk => svn://kumquat.geoplan.ufl.edu/Projects/S4-Geocoding/branches/auto-advance-crash-report-viewer, 4160
Use of uninitialized value $u in substitution (s///) at /usr/libexec/git-core/git-svn line 1728.
Use of uninitialized value $u in concatenation (.) or string at /usr/libexec/git-core/git-svn line 1728.
refs/remotes/trunk: 'svn://kumquat.geoplan.ufl.edu' not found in '' 
```

会发生什么？我不知道从哪里开始解决这个问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-10T20:46:31.483

正如 me_and 所暗示的，这可能是一个 Git 错误。在查看了源代码之后，问题似乎与元数据有关。`--no-metadata`我能够通过删除标志来解决它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-05-12T09:19:59.500

如[here](https://stackoverflow.com/a/37048201/6309)或[here](https://stackoverflow.com/a/3011403/6309)所示，传递一个坏的主干（由于非标准的svn结构）会导致这个错误。

Git 2.9 将不那么冗长（死得更快）。
请参阅[Christian Couder (](https://github.com/chriscool) [)的](https://github.com/chriscool)[提交 523a33c](https://github.com/git/git/commit/523a33ca17c76bee007d7394fb3930266c577c02)（2016 年 5 月 7 日） 。^(（由)^([Eric Wong 合并 --](https://github.com/ele828)) ^([--](https://github.com/ele828))^在^([commit 523a33c](https://github.com/git/git/commit/523a33ca17c76bee007d7394fb3930266c577c02))^(中，2016 年 5 月 8 日）)[`chriscool`](https://github.com/chriscool)
^([`ele828`](https://github.com/ele828))

> ## Git/SVN：没有提交元数据时死机
> 
> 当向 传递一个错误的`--trunk`选项时`git svn clone`，例如我们正在克隆的同一个 URL。
> 
> 当我们有一个未初始化的值时，让我们通过 die()ing 来解决这个问题，因为我们无法从 ref 获取提交元数据。

这样可以避免所有其他错误消息，例如：

```
Found possible branch point...
Use of uninitialized value $u in substitution (s///) at... 
```

# c++ - c ++：包含自身对象的类，初始化

> ID：11398417
> 
> 赞同：0
> 
> 时间：2012-07-09T15:37:33.163
> 
> 标签：c++

我尝试刷新我对 C++ 的（非常有限的）知识并尝试实现合并搜索方法：

```
class Sorter
{
protected:
    vector<int> v;
public:
    Sorter(){};
    Sorter(vector<int> input_vector);
    virtual void sort() = 0;
};    

Sorter::Sorter(vector<int> input_vector)
{
    v.assign(input_vector.begin(), input_vector.end());
}
class MergeSorter : public Sorter
{
public:
        MergeSorter():Sorter(){};
        MergeSorter(vector<int> input_vector):Sorter(input_vector){};
        vector<int> sorted_v;
        MergeSorter* left;
        MergeSorter* right;
        void merge();
        void sort();
};

void MergeSorter::sort()
{
    if(v.size() <= 1)
        return;
    int mid = int(v.size() / 2);
    left->v.assign(v.begin(), v.begin() + mid);
    right->v.assign(v.begin() + mid, v.end() + 1);
    left->sort();
    right->sort();
    left->v.assign(left->sorted_v.begin(), left->sorted_v.end());
    right->v.assign(right->sorted_v.begin(), right->sorted_v.end());
    merge();
    return;
}
... 
```

它确实可以编译，但是当我尝试将某些内容分配给`left->v`. 我觉得我需要首先实际创建一个对象`left`（和`right`），但不知道我在哪里做，因为它是同一类的对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T15:38:55.200

> 我觉得我需要先创建一个左（右）对象，但不知道我在哪里做，因为它是同一类的对象。

这是对的。在您创建这些之前，它们不能被“使用”，因为它们将未被初始化。您应该能够在构造函数中进行左右的构造和赋值，或者在构造函数中将它们初始化为 NULL 并在第一次使用之前设置它们（如果此时它们未设置）。

请注意，您需要注意不要以会导致无限循环的方式构造它们 - 在构造函数中创建一个新实例，这反过来又会创建一个新实例，这反过来又......

# javascript - 尝试将 DOMParser 与节点 js 一起使用

> ID：11398419
> 
> 赞同：103
> 
> 时间：2012-07-09T15:37:45.383
> 
> 标签：javascript, xml, node.js

尝试在我的 js 代码中使用 DOMParser 时遇到问题。在我的代码中，我通过 xmlhttp.responseText 肥皂响应检索一个 xml 文件。我希望能够以 JSON 格式访问其元素，因此我的代码如下所示：

```
var xml = new DOMParser();
xml = xml.parseFromString(xmlhttp.responseText, 'text/xml');
var result = xmlToJson(xml); 
```

我收到此错误消息：ReferenceError: DOMParser is not defined

编辑：这个链接对我不起作用，因为我的 javascript 不在 HTML 页面中，因为它是一个 node.js 文件。 [JavaScript DOMParser 访问 innerHTML 和其他属性](https://stackoverflow.com/questions/9250545/javascript-domparser-access-innerhtml-and-other-properties)

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2019-04-13T18:31:43.557

许多浏览器功能，例如 DOM 操作或 XHR，在 NodeJS 中是不可用的，因为这不是访问 DOM 的典型服务器任务——您必须使用外部库来执行此操作。

DOM 容量很大程度上取决于库，这里是您可以使用的主要工具的快速比较：

*   **[`jsdom`](https://www.npmjs.com/package/jsdom)**: 实现[了最新的 DOM 标准](https://en.wikipedia.org/wiki/Document_Object_Model#Standards)DOM level 4 ，所以你可以在现代浏览器上做的所有事情，你都可以在`jsdom`. 它是在 Node 上做浏览器工作的事实上的行业标准，被 Mocha、Vue Test Utils、Webpack Prerender SPA Plugin 和许多其他人使用：

    ```
    const jsdom = require("jsdom");
    const dom = new jsdom.JSDOM(`<!DOCTYPE html><p>Hello world</p>`);
    dom.window.document.querySelector("p").textContent; // 'Hello world' 
    ```

*   **[`deno_dom`](https://deno.land/x/deno_dom)**：如果使用 Deno 代替 Node 是一个选项，这个库提供了 DOM 解析能力：

    ```
    import { DOMParser } from "https://deno.land/x/deno_dom/deno-dom-wasm.ts";
    const parser = new DOMParser();
    const document = parser.parseFromString('<p>Hello world</p>', 'text/html');
    document.querySelector('p').textContent; // 'Hello world'; 
    ```

*   **[`htmlparser2`](https://www.npmjs.com/package/htmlparser2)**：与 jsdom 相同，但以更复杂的 API 为代价增强了性能和灵活性：

    ```
    const htmlparser = require("htmlparser2");
    const parser = new htmlparser.Parser({
      onopentag: (name, attrib) => {
        if (name=='p') console.log('a paragraph element is opening');
      }
    }, {decodeEntities: true});
    parser.write(`<!DOCTYPE html><p>Hello world</p>`);
    parser.end();
    // console output: 'a paragraph element is opening' 
    ```

*   **[`cheerio`](https://www.npmjs.com/package/cheerio)**: 基于 HTML DOM 解析的 jQuery 实现`htmlparser2`:

    ```
    const cheerio = require('cheerio');
    const $ = cheerio.load(`<!DOCTYPE html><p>Hello world</p>`);
    $('p').text('Bye moon');
    $.html(); // '<!DOCTYPE html><p>Bye moon</p>' 
    ```

*   **[`xmldom`](https://github.com/xmldom/xmldom)**：完全实现 DOM 级别 2 并部分实现 DOM 级别 3。适用于 HTML，也适用于 XML

*   **[`dom-parser`](https://www.npmjs.com/package/dom-parser)**：基于正则表达式的 DOM 解析器，它实现了一些 DOM 方法，例如`getElementById`. 由于使用正则表达式解析 HTML 是[一个非常糟糕的主意](https://blog.codinghorror.com/parsing-html-the-cthulhu-way/)，因此我不推荐将其用于生产。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-07-09T15:47:40.930

node.js中没有`DOMParser`，那是浏览器的事情。您可以尝试以下任何模块：

[https://github.com/joyent/node/wiki/modules#wiki-parsers-xml](https://github.com/joyent/node/wiki/modules#wiki-parsers-xml)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2015-12-27T08:42:17.070

您可以使用 DOMParser 的 Node 实现，例如[xmldom](https://www.npmjs.com/package/xmldom)。这将允许您在浏览器之外访问 DOMParser。例如：

```
var DOMParser = require('xmldom').DOMParser;
var parser = new DOMParser();
var document = parser.parseFromString('Your XML String', 'text/xml'); 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2019-01-08T16:48:38.487

我使用[jsdom](https://github.com/jsdom/jsdom)是因为它被大量使用并且是由一位著名的网络英雄编写的 - 没有保证它的行为与您的浏览器完全匹配（或者甚至每个浏览器的行为都是相同的），但它对我有用：

```
const jsdom = require("jsdom")
const { JSDOM } = jsdom
global.DOMParser = new JSDOM().window.DOMParser 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-02-14T17:25:40.987

我真的很喜欢[htmlparser2](https://github.com/fb55/htmlparser2)。这是一个很棒的、快速的、轻量级的库。我创建了一个关于如何在 RunKit 上使用它的小演示：[https ://runkit.com/jfahrenkrug/htmlparser2-demo/1.0.0](https://runkit.com/jfahrenkrug/htmlparser2-demo/1.0.0)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-07-07T12:02:26.730

```
var DOMParser = require('xmldom').DOMParser;
var doc = new DOMParser().parseFromString(
    '<xml xmlns="a" xmlns:c="./lite">\n'+
        '\t<child>test</child>\n'+
        '\t<child></child>\n'+
        '\t<child/>\n'+
    '</xml>'
    ,'text/xml'); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-04-27T23:26:17.597

我使用另一个 DOM 解析器从 html 字符串到 DOM 并返回 > [Himalaya](https://github.com/andrejewski/himalaya)，或者在[npmjs.com](https://www.npmjs.com/package/himalaya)：

```
import { parse, stringify } from 'himalaya';

const dom = parse(htmlString)

// Do something here

const htmlStringNext = stringify(dom) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-09-22T21:42:34.207

[RSS 解析器](https://www.npmjs.com/package/rss-parser)很容易解析 Atom 提要。例如，您正在使用 NextJs，您可以像这样简单地创建一个 API：

```
import Parser from 'rss-parser'

export default async function API(req, res) {
    let parser = new Parser();
    try {
        const feed = await parser.parseURL(`https://www.nasa.gov/rss/dyn/lg_image_of_the_day.rss`);
        if (feed) return res.json({ "message": `Here is your data feed title`, status: 200, data: feed.title })
    } catch (error) {
        return res.json({ "message": "You made an invalid request", status: 401 })
    }
} 
```

# php - PHP与Android？

> ID：11398421
> 
> 赞同：0
> 
> 时间：2012-07-09T15:37:55.350
> 
> 标签：php, android, http-post

我一直在研究使用 Android 编写应用程序，并开始使用 Java 进行开发。但是，我已经编写了一个应用程序，它使用 php 和 html 的组合成功运行（利用 http post 作为搜索实用程序），然后联系 API。

我已经读过 PHP 可以在 Android 上运行，但这是否只有在用户安装了一些特殊的东西的情况下？还是它现在成为 Android 手机的标准配置？

其次，如果不是，我听说过简单地创建一个 Web 应用程序。有没有办法可以在我的 Android 上使用我已经工作的 php 代码？还是我必须以某种方式对其进行自定义。

关于这个主题的任何光线都会很棒。我找不到一致的答案！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:42:26.190

我发现有几个选项：

1.  [http://phpforandroid.net/](http://phpforandroid.net/)
2.  [http://www.talkandroid.com/6211-php-for-android-install-it-and-start-testing/](http://www.talkandroid.com/6211-php-for-android-install-it-and-start-testing/)

请注意，我没有使用过这些框架，也不知道它们有多好。

另一种选择是在 java 中开发，并在需要时在某些情况下对 php 进行 HTTP 调用。

另一种选择是[phonegap](http://phonegap.com/)，它允许您使用 HTML、Javascript、CSS 开发 android 应用程序，但这需要对您现有的应用程序进行一些更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T15:40:55.937

如果你已经有一个工作的网络应用程序，你可以用你的安卓设备访问它。也许调整布局以适应较小的屏幕。

如果没有进一步的工作，您将无法在 Android 手机上运行 PHP，因为您需要一个解释器（通常是一个网络服务器）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-24T08:48:18.320

您可以使用在 PHP 上编写的现有函数，只需将值作为 JSON 数据传递。

然后在您的 Android 应用程序上，您需要做的就是根据您的需要解析可以通过 GET 或 POST 传递的 JSON 数据。

所以从技术上讲，您需要将 PHP 理解为服务器端脚本语言，将数据作为 JSON 传递，因为它是 JAVA 可以解析的最轻量级的数据交换格式，它是 android 应用程序的基础。

# iphone - 使用**自定义样式**谷歌地图的 iOS 原生应用

> ID：11398425
> 
> 赞同：1
> 
> 时间：2012-07-09T15:38:04.260
> 
> 标签：iphone, ios, google-maps-api-3, mapkit

是否可以创建使用**自定义样式**谷歌地图的原生 iOS 应用程序？ [https://developers.google.com/maps/documentation/javascript/styling](https://developers.google.com/maps/documentation/javascript/styling)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T23:35:07.273

是和不是。

iOS SDK 中的原生映射库 Mapview 不支持样式。

您可以通过 JS V3 API 在本机应用程序中使用样式。但是您必须在加载 JS Map 的本机应用程序中构建一个浏览器。

# mysql - CONCAT 和 SQL 查询

> ID：11398426
> 
> 赞同：-1
> 
> 时间：2012-07-09T15:38:08.093
> 
> 标签：mysql, sql

我有一个在数据库中搜索结果的表单。结果由两列组成。我正在尝试连接它们，以便让它在这两个列中搜索结果。一旦找到它，我希望它打印出该行。

我的错误是：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'WHERE CONCAT(Type,' ',Identifier) = Library 110' 附近使用正确的语法。

```
<?php 
$link = mysql_connect('localhost', 'root', 'root') or die (mysql_error());
$db_selected = mysql_select_db ('test',$link);

$term = $_POST['term'];
if ($sql = mysql_query ("SELECT CONCAT(Type,' ',Identifier) as srcqry WHERE CONCAT(Type,' ',Identifier) = $term "))
{   
while ($row = mysql_fetch_assoc($sql)){
    echo '<br/> Location: '.$row['Location'];
    echo '<br/> Section: '.$row['Section'];
    echo '<br/> Identifier: '.$row['Type']. ' ' .$row['Identifier'];
    echo '<br/><br/>';
    }
}
else 
{
echo die(mysql_error());
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:50:47.897

您的 SQL 需要一个 FROM 子句。尽管 mysql 支持“SELECT”，但它不支持 WHERE 子句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T15:47:09.560

尝试替换为：

```
SELECT CONCAT(Type,' ',Identifier) as srcqry FROM TableName WHERE CONCAT(Type,' ',Identifier) = '$term' 
```

IE。添加带有`FROM`子句和`'`周围的表名`$term`。

然而，正如[@Jack Maney](https://stackoverflow.com/questions/11398426/concat-and-sql-queries/11398593#comment15027842_11398426)所指出的，您的代码容易受到 SQL 注入的攻击。

# c++ - QxOrm 可以持久化指向抽象类的指针吗？

> ID：11398428
> 
> 赞同：0
> 
> 时间：2012-07-09T15:38:16.223
> 
> 标签：c++, persistence, qxorm

我试图弄清楚如何使用[QxOrm](http://qxorm.com/qxorm_en/home.html)来持久化一个大而复杂的类结构。我已经取得了一些进展，但我一直坚持如何处理指向抽象类的指针。

这是一个简单的例子，其中 Table（一个具体类）有一个指向某种 Shape（一个抽象类）的指针：

```
class Table {
    Shape* top;
};

class Shape {
public:
    virtual float getWidth() = 0;
};

class Square : public Shape {
    virtual float getWidth();
};

class Circle : public Shape {
    virtual float getWidth();
}; 
```

当我尝试这个时，我收到错误消息抱怨 Shape 是抽象的。

在我看来，这对于 QxOrm 来说是不可能的，我怀疑是因为它唯一的继承模型是 Concrete。

有谁知道这是否可能？我宁愿不放弃 QxOrm，因为它在很多方面看起来都不错（而且我已经投入了大量时间），但看起来我必须这样做。

**更新**1：我知道`QX_REGISTER_ABSTRACT_CLASS`。它对这个用例没有帮助。

**Update2**：我尝试`comment`将 qxBlog 示例中的类抽象化。我使它成为子类`qx::IxPersistable`并使用`QX_REGISTER_ABSTRACT_CLASS`宏。当我编译时，它会在宏的调用中死掉`QX_PERSISTABLE_CPP`，其中：

> ../../../QxOrm/include/QxDao/../../inl/QxDao/QxDao_Count.inl:36：错误：不能将变量“t”声明为抽象类型“注释”

其他地方也有类似的错误消息。

（顺便说一句，我本来打算先在 QxOrm 论坛上问，但当时不可用。）

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-15T18:32:50.837

这是使用*qx::IxPersistable*接口和 QxOrm 触发器的通用解决方案。这个想法是存储您的基类的 ID + 与您的 ID 关联的类型：这样，您将能够实例化所有派生类。

--- *MyBaseClass.h*文件：

```
class QX_DLL2_EXPORT MyBaseClass : public qx::IxPersistable
{

public:

   long id;

   MyBaseClass() : qx::IxPersistable(), id(0) { ; }
   virtual ~MyBaseClass() = 0;

};

QX_REGISTER_ABSTRACT_CLASS(MyBaseClass)
QX_REGISTER_HPP_QX_DLL2(MyBaseClass, qx::trait::no_base_class_defined, 0)

typedef boost::shared_ptr<MyBaseClass> MyBaseClass_ptr; 
```

--- *MyDerivedClass1.h*文件：

```
class QX_DLL2_EXPORT MyDerivedClass1 : public MyBaseClass
{

   QX_PERSISTABLE_HPP(MyDerivedClass1)

public:

   QString description;

   MyDerivedClass1() : MyBaseClass() { ; }
   virtual ~MyDerivedClass1() { ; }

};

QX_REGISTER_HPP_QX_DLL2(MyDerivedClass1, MyBaseClass, 0)

typedef boost::shared_ptr<MyDerivedClass1> MyDerivedClass1_ptr; 
```

--- *MyDerivedClass2.h*文件：

```
class QX_DLL2_EXPORT MyDerivedClass2 : public MyBaseClass
{

   QX_PERSISTABLE_HPP(MyDerivedClass2)

public:

   QString prop1;
   QString prop2;

   MyDerivedClass2() : MyBaseClass() { ; }
   virtual ~MyDerivedClass2() { ; }

};

QX_REGISTER_HPP_QX_DLL2(MyDerivedClass2, MyBaseClass, 0)

typedef boost::shared_ptr<MyDerivedClass2> MyDerivedClass2_ptr; 
```

--- *MyContainer.h*文件：

```
class QX_DLL2_EXPORT MyContainer
{

public:

   long id;

   long base_id;
   QString base_type;
   MyBaseClass_ptr base_ptr;

   MyContainer() : id(0), base_id(0) { ; }
   virtual ~MyContainer() { ; }

   void onBeforeInsert(qx::dao::detail::IxDao_Helper * dao);
   void onBeforeUpdate(qx::dao::detail::IxDao_Helper * dao);
   void onBeforeDelete(qx::dao::detail::IxDao_Helper * dao);
   void onBeforeFetch(qx::dao::detail::IxDao_Helper * dao);
   void onAfterInsert(qx::dao::detail::IxDao_Helper * dao);
   void onAfterUpdate(qx::dao::detail::IxDao_Helper * dao);
   void onAfterDelete(qx::dao::detail::IxDao_Helper * dao);
   void onAfterFetch(qx::dao::detail::IxDao_Helper * dao);

   void insertOrUpdateBasePtr(qx::dao::detail::IxDao_Helper * dao);

};

QX_REGISTER_HPP_QX_DLL2(MyContainer, qx::trait::no_base_class_defined, 0)

typedef boost::shared_ptr<MyContainer> MyContainer_ptr;

namespace qx {
namespace dao {
namespace detail {

template <>
struct QxDao_Trigger<MyContainer>
{

   static inline void onBeforeInsert(MyContainer * t, qx::dao::detail::IxDao_Helper * dao)   { if (t) { t->onBeforeInsert(dao); } }
   static inline void onBeforeUpdate(MyContainer * t, qx::dao::detail::IxDao_Helper * dao)   { if (t) { t->onBeforeUpdate(dao); } }
   static inline void onBeforeDelete(MyContainer * t, qx::dao::detail::IxDao_Helper * dao)   { if (t) { t->onBeforeDelete(dao); } }
   static inline void onBeforeFetch(MyContainer * t, qx::dao::detail::IxDao_Helper * dao)    { if (t) { t->onBeforeFetch(dao); } }
   static inline void onAfterInsert(MyContainer * t, qx::dao::detail::IxDao_Helper * dao)    { if (t) { t->onAfterInsert(dao); } }
   static inline void onAfterUpdate(MyContainer * t, qx::dao::detail::IxDao_Helper * dao)    { if (t) { t->onAfterUpdate(dao); } }
   static inline void onAfterDelete(MyContainer * t, qx::dao::detail::IxDao_Helper * dao)    { if (t) { t->onAfterDelete(dao); } }
   static inline void onAfterFetch(MyContainer * t, qx::dao::detail::IxDao_Helper * dao)     { if (t) { t->onAfterFetch(dao); } }

};

} // namespace detail
} // namespace dao
} // namespace qx 
```

--- *MyBaseClass.cpp*文件：

```
QX_REGISTER_CPP_QX_DLL2(MyBaseClass)

namespace qx {
template <> void register_class(QxClass<MyBaseClass> & t)
{
   t.id(& MyBaseClass::id, "id");
}}

MyBaseClass::~MyBaseClass() { ; } 
```

--- *MyDerivedClass1.cpp*文件：

```
QX_REGISTER_CPP_QX_DLL2(MyDerivedClass1)
QX_PERSISTABLE_CPP(MyDerivedClass1)

namespace qx {
template <> void register_class(QxClass<MyDerivedClass1> & t)
{
   t.data(& MyDerivedClass1::description, "description");
}} 
```

--- *MyDerivedClass2.cpp*文件：

```
QX_REGISTER_CPP_QX_DLL2(MyDerivedClass2)
QX_PERSISTABLE_CPP(MyDerivedClass2)

namespace qx {
template <> void register_class(QxClass<MyDerivedClass2> & t)
{
   t.data(& MyDerivedClass2::prop1, "prop1");
   t.data(& MyDerivedClass2::prop2, "prop2");
}} 
```

--- *MyContainer.cpp*文件：

```
QX_REGISTER_CPP_QX_DLL2(MyContainer)

namespace qx {
template <> void register_class(QxClass<MyContainer> & t)
{
   t.id(& MyContainer::id, "id");
   t.data(& MyContainer::base_id, "base_id");
   t.data(& MyContainer::base_type, "base_type");
}}

void MyContainer::onBeforeInsert(qx::dao::detail::IxDao_Helper * dao)
{
   if (! dao) { qAssert(false); return; }
   if (dao->error().isValid()) { return; }
   if (! base_ptr || ! base_ptr->qxClass()) { return; }

   base_id = base_ptr->id;
   base_type = base_ptr->qxClass()->getKey();
}

void MyContainer::onBeforeUpdate(qx::dao::detail::IxDao_Helper * dao)
{
   if (! dao) { qAssert(false); return; }
   if (dao->error().isValid()) { return; }
   if (! base_ptr || ! base_ptr->qxClass()) { return; }

   base_id = base_ptr->id;
   base_type = base_ptr->qxClass()->getKey();
}

void MyContainer::onBeforeDelete(qx::dao::detail::IxDao_Helper * dao)
{
   if (! dao) { qAssert(false); return; }
   if (dao->error().isValid()) { return; }
   // Nothing to do here !
}

void MyContainer::onBeforeFetch(qx::dao::detail::IxDao_Helper * dao)
{
   if (! dao) { qAssert(false); return; }
   if (dao->error().isValid()) { return; }
   // Nothing to do here !
}

void MyContainer::onAfterInsert(qx::dao::detail::IxDao_Helper * dao)
{
   if (! dao) { qAssert(false); return; }
   if (dao->error().isValid()) { return; }
   insertOrUpdateBasePtr(dao);
}

void MyContainer::onAfterUpdate(qx::dao::detail::IxDao_Helper * dao)
{
   if (! dao) { qAssert(false); return; }
   if (dao->error().isValid()) { return; }
   insertOrUpdateBasePtr(dao);
}

void MyContainer::onAfterDelete(qx::dao::detail::IxDao_Helper * dao)
{
   if (! dao) { qAssert(false); return; }
   if (dao->error().isValid()) { return; }

   if (base_ptr)
   {
      QVariant idEmpty;
      QSqlError daoError = base_ptr->qxDeleteById(idEmpty, (& dao->database()));
      dao->updateError(daoError);
   }
}

void MyContainer::onAfterFetch(qx::dao::detail::IxDao_Helper * dao)
{
   if (! dao) { qAssert(false); return; }
   if (dao->error().isValid()) { return; }

   if ((base_id > 0) && (! base_type.isEmpty()))
   {
      MyBaseClass * pBase = qx::create_nude_ptr<MyBaseClass>(base_type);
      if (! pBase) { qAssert(false); return; }
      base_ptr.reset(pBase);
      QVariant vId = base_id; QStringList lstEmpty;
      QSqlError daoError = base_ptr->qxFetchById(vId, lstEmpty, lstEmpty, (& dao->database()));
      dao->updateError(daoError);
   }
}

void MyContainer::insertOrUpdateBasePtr(qx::dao::detail::IxDao_Helper * dao)
{
   static bool bInEvent = false;
   if (! base_ptr || bInEvent) { return; }
   bInEvent = true;

   QStringList lstEmpty; QVariant idEmpty;
   QSqlError daoError; qx::QxSqlQuery queryEmpty;
   qx_bool bExist = base_ptr->qxExist(idEmpty, (& dao->database()));
   if (bExist)
   {
      daoError = base_ptr->qxUpdate(queryEmpty, lstEmpty, lstEmpty, (& dao->database()));
      dao->updateError(daoError);
   }
   else
   {
      daoError = base_ptr->qxInsert(lstEmpty, (& dao->database()));
      if (! daoError.isValid()) { daoError = qx::dao::update((* this), (& dao->database()), QStringList() << "base_id" << "base_type"); }
      dao->updateError(daoError);
   }

   bInEvent = false;
} 
```

--- *main.cpp*文件做一些测试：

```
 daoError = qx::dao::create_table<MyDerivedClass1>(); qAssert(! daoError.isValid());
   daoError = qx::dao::create_table<MyDerivedClass2>(); qAssert(! daoError.isValid());
   daoError = qx::dao::create_table<MyContainer>(); qAssert(! daoError.isValid());

   MyContainer b1;
   MyDerivedClass1_ptr pD1 = MyDerivedClass1_ptr(new MyDerivedClass1());
   pD1->description = "my desc";
   b1.base_ptr = pD1;
   daoError = qx::dao::insert(b1); qAssert(! daoError.isValid());

   MyContainer b2;
   MyDerivedClass2_ptr pD2 = MyDerivedClass2_ptr(new MyDerivedClass2());
   pD2->prop1 = "my prop1";
   pD2->prop2 = "my prop2";
   b2.base_ptr = pD2;
   daoError = qx::dao::insert(b2); qAssert(! daoError.isValid());

   MyContainer b3;
   b3.base_ptr = pD1;
   pD1->description = "my desc modified";
   daoError = qx::dao::insert(b3); qAssert(! daoError.isValid());

   QList<MyContainer_ptr> all;
   daoError = qx::dao::fetch_all(all);
   qx::dump(all); 
```

和所有输出痕迹：

> ```
> [QxOrm] sql query (0 ms) : CREATE TABLE MyDerivedClass1 (id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, description TEXT)
> [QxOrm] sql query (0 ms) : CREATE TABLE MyDerivedClass2 (id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, prop1 TEXT, prop2 TEXT)
> [QxOrm] sql query (16 ms) : CREATE TABLE MyContainer (id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, base_id INTEGER, base_type TEXT)
> [QxOrm] sql query (0 ms) : SELECT MyDerivedClass1.id AS MyDerivedClass1_id_0 FROM MyDerivedClass1 WHERE MyDerivedClass1.id = :id
> [QxOrm] sql query (0 ms) : INSERT INTO MyDerivedClass1 (description) VALUES (:description)
> [QxOrm] sql query (0 ms) : UPDATE MyContainer SET id = :id, base_id = :base_id, base_type = :base_type WHERE id = :id_bis
> [QxOrm] sql query (3245 ms) : INSERT INTO MyContainer (base_id, base_type) VALUES (:base_id, :base_type)
> [QxOrm] sql query (0 ms) : SELECT MyDerivedClass2.id AS MyDerivedClass2_id_0 FROM MyDerivedClass2 WHERE MyDerivedClass2.id = :id
> [QxOrm] sql query (0 ms) : INSERT INTO MyDerivedClass2 (prop1, prop2) VALUES (:prop1, :prop2)
> [QxOrm] sql query (0 ms) : UPDATE MyContainer SET id = :id, base_id = :base_id, base_type = :base_type WHERE id = :id_bis
> [QxOrm] sql query (0 ms) : INSERT INTO MyContainer (base_id, base_type) VALUES (:base_id, :base_type)
> [QxOrm] sql query (0 ms) : SELECT MyDerivedClass1.id AS MyDerivedClass1_id_0 FROM MyDerivedClass1 WHERE MyDerivedClass1.id = :id
> [QxOrm] sql query (0 ms) : UPDATE MyDerivedClass1 SET id = :id, description = :description WHERE id = :id_bis
> [QxOrm] sql query (15 ms) : INSERT INTO MyContainer (base_id, base_type) VALUES (:base_id, :base_type)
> [QxOrm] sql query (0 ms) : SELECT MyDerivedClass1.id AS MyDerivedClass1_id_0, MyDerivedClass1.description AS MyDerivedClass1_description_0 FROM MyDerivedClass1 WHERE MyDerivedClass1.id = :id
> [QxOrm] sql query (0 ms) : SELECT MyDerivedClass2.id AS MyDerivedClass2_id_0, MyDerivedClass2.prop1 AS MyDerivedClass2_prop1_0, MyDerivedClass2.prop2 AS MyDerivedClass2_prop2_0 FROM MyDerivedClass2 WHERE MyDerivedClass2.id = :id
> [QxOrm] sql query (0 ms) : SELECT MyDerivedClass1.id AS MyDerivedClass1_id_0, MyDerivedClass1.description AS MyDerivedClass1_description_0 FROM MyDerivedClass1 WHERE MyDerivedClass1.id = :id
> [QxOrm] sql query (0 ms) : SELECT MyContainer.id AS MyContainer_id_0, MyContainer.base_id AS MyContainer_base_id_0, MyContainer.base_type AS MyContainer_base_type_0 FROM MyContainer
> [QxOrm] start dump 'QList<boost::shared_ptr<MyContainer>>'
> <QList-boost.shared_ptr-MyContainer-- class_id="0" tracking_level="0" version="0">
>    <count>3</count>
>    <item class_id="1" tracking_level="0" version="1">
>       <px class_id="2" tracking_level="1" version="0" object_id="_0">
>          <id>1</id>
>          <base_id>1</base_id>
>          <base_type class_id="3" tracking_level="0" version="0">MyDerivedClass1</base_type>
>          <base_ptr class_id="4" tracking_level="0" version="1">
>             <px class_id="6" class_name="MyDerivedClass1" tracking_level="1" version="0" object_id="_1">
>                <MyBaseClass class_id="5" tracking_level="1" version="0" object_id="_2">
>                   <id>1</id>
>                </MyBaseClass>
>                <description>my desc modified</description>
>             </px>
>          </base_ptr>
>       </px>
>    </item>
>    <item>
>       <px class_id_reference="2" object_id="_3">
>          <id>2</id>
>          <base_id>1</base_id>
>          <base_type>MyDerivedClass2</base_type>
>          <base_ptr>
>             <px class_id="7" class_name="MyDerivedClass2" tracking_level="1" version="0" object_id="_4">
>                <MyBaseClass object_id="_5">
>                   <id>1</id>
>                </MyBaseClass>
>                <prop1>my prop1</prop1>
>                <prop2>my prop2</prop2>
>             </px>
>          </base_ptr>
>       </px>
>    </item>
>    <item>
>       <px class_id_reference="2" object_id="_6">
>          <id>3</id>
>          <base_id>1</base_id>
>          <base_type>MyDerivedClass1</base_type>
>          <base_ptr>
>             <px class_id_reference="6" object_id="_7">
>                <MyBaseClass object_id="_8">
>                   <id>1</id>
>                </MyBaseClass>
>                <description>my desc modified</description>
>             </px>
>          </base_ptr>
>       </px>
>    </item>
> </QList-boost.shared_ptr-MyContainer-->
> [QxOrm] end dump 'QList<boost::shared_ptr<MyContainer>>' 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T14:51:03.413

将抽象类注册到 QxOrm 上下文中：[http ://www.qxorm.com/qxorm_en/faq.html#faq_140](http://www.qxorm.com/qxorm_en/faq.html#faq_140)

并使用指向基类的指针，我认为*qx::IxPersistable*接口可以帮助你：[http ://www.qxorm.com/qxorm_en/faq.html#faq_260](http://www.qxorm.com/qxorm_en/faq.html#faq_260)

**注意：** QxOrm 论坛现已上线...

# sql - 这些 SQL 查询中哪个更好，为什么？

> ID：11398431
> 
> 赞同：3
> 
> 时间：2012-07-09T15:38:34.493
> 
> 标签：sql, optimization

我还在学习SQL。我以两种不同的方式完成了类似的查询，并且想知道哪个更好以及为什么。

```
UPDATE R
    SET R.something = 1
    FROM Table1 R
    JOIN Table2 U
    ON R.value1 = U.value2
    WHERE
        U.value3 BETWEEN 1 AND 5 
```

或者

```
UPDATE R
    SET R.something = 1
    WHERE R.value1 IN
    (SELECT U.value2
    FROM U
    WHERE
        U.value3 BETWEEN 1 AND 5
    ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:46:31.710

你的问题没有单一的答案。SQL 是一种描述性语言，而不是一种过程语言。这取决于效率更高的数据库引擎。此外，索引会对性能产生很大影响。

顺便说一句，您的两个查询并不等效。当“U”中有多个值时，第一个可以返回多行。带有“IN”的版本会隐含“DISTINCT”。要解决此问题，您需要添加特定的“DISTINCT”。

```
UPDATE R
    SET R.something = 1
    FROM Table1 R
         JOIN (select distinct value2
               from Table2 U
               WHERE U.value3 BETWEEN 1 AND 5 
              ) u
         ON R.value1 = U.value2 
```

此外，虽然我个人喜欢更新中的“FROM”语句，但并非所有数据库都支持它。带有“IN”的版本兼容更广泛的数据库引擎。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T15:57:51.240

第一个查询更好。

关系数据库，无论您使用的实际 DBMS 是什么，都是为了以这种方式连接数据并使用 where 子句对其进行过滤而构建的。这是他们的面包和黄油。在第二个查询中，您使用子查询来收集其他数据。这太酷了，关系数据库也能很好地解决这个问题。但是，对于子查询，在这种特定情况下，您最终会得到两个查询，一个是获取 U 数据，然后是外部查询，使用子查询中的数据来设置 R 数据。

这是棘手的一点。在您的查询中，您的子查询完全引用了一个单独的表。所以还是会很快。该子查询仅包含在 U 数据中。您将获得 2 个查询 - 获取 U 数据，然后使用 U 数据更新 R 数据。但是，如果您编写了一个类似的查询，其中子查询引用了 R 中的数据，那么您将不会得到两个单独的查询。您最终会对 R 中的所有数据进行全表扫描，这会相当慢。

为更完整而进行编辑：正如其他人所说，很大程度上取决于您使用的是什么 DBMS 以及它最擅长什么。当第一次学习 SQL（我绝不是专家）时，其中一个障碍是意识到有很多方法可以做同样的事情，得到同样的结果，然后往往最终会针对同样的事情进行优化. 因此，寻找“正确”的方式往往是徒劳的，因为没有明确的“正确”方式。我尝试编写不仅是为了正确性和速度，也是为了可维护性——我发现子查询对大脑来说可能比必要的更难。如果可以避免它们，我会尝试不使用它们（只要替代方案不是光标或其他东西:-D）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T15:46:40.987

这完全取决于您计划使用的数据库（Oracle、SQL Server 等）、它的版本，有时还取决于表中的数据量。但通常你应该更喜欢 JOIN，因为它们对大多数优化器来说更容易，并且带有空值的陷阱更少。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T15:47:35.197

这可能取决于您使用的引擎，但我相信 MS SQL Server 会针对相同的查询计划进行优化。

如果引擎没有，我会建议在这种情况下它是劣质的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-09T15:41:39.293

使用 JOIN 查询会更好，因为它比子选择更快。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-09T15:44:38.247

这取决于数据库和数据库版本搜索是否更好（更快）搜索 IN 或 JOIN 是否会返回不同的结果（IN 更快或 JOIN 更快）取决于数据库甚至 SQL 语句 - 它甚至可以根据数据库版本。使用多种数据大小和不同平台进行测试总是一个好主意！

（查询 #2 是最容易阅读的，但可能会也可能不会更慢）

# php - jQuery + php 如何在我的数据对象中返回多个值？

> ID：11398433
> 
> 赞同：0
> 
> 时间：2012-07-09T15:38:39.153
> 
> 标签：php, javascript, jquery, mysql, json

我有我的简单 jquery & php reg/login 脚本工作。基本上，如果用户的姓名和通行证在数据库中，则 php 会回显真实，并且在我的 javascript 中我有

我想将用户名传回我的 javascript 并将其保存在变量中，我该怎么做？

我想我可以在我的 php 中这样做：

```
json_encode(array("boolean" => "true", "username" => '$username')); 
```

但是如何在我的 jQuery 中处理它呢？

```
$('#login').click(function(e){
      $.get("login.php",{username: $("#username").val(), password: $("#password").val()},function(data){
         if(data == "true"){

            alert("Logged in");
            $('#logindiv').slideUp();
            $('#gamediv').show(); 
            $('#registerdiv').hide();
            $('#gameheader').html(userloggedin);
         }else{
            alert("Not Logged in");
         }
      });
}); 
```

**编辑：** login.php

```
if (isset($_GET['username'])&& isset($_GET['password'])) {
$username = $_GET['username'];
    $password = $_GET['password'];

$sql = mysql_query("SELECT * FROM members WHERE username='$username' AND password='$password'") or die(mysql_error()); 

       // Get member ID into a session variable
        $id = $row["id"];   
        session_register('id'); 
        $_SESSION['id'] = $id;
        // Get member username into a session variable
        $username = $row["username"];   
        session_register('username'); 
        $_SESSION['username'] = $username;
        $json = array("boolean" => "true", "username" => $username);

        echo(json_encode($json));
        //exit();

} else {
    echo "false";
} 
```

主.html ...

```
$('#login').click(function(e){
      $.getJSON("login.php",{username: $("#username").val(), password: $("#password").val()},function(data){
         if(data.username!==undefined){
            alert(data.username);
            $('#logindiv').slideUp();
            $('#gamediv').show(); 
            $('#registerdiv').hide();
            $('#gameheader').html(data['username']);
         }else{

         }
      });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:41:56.993

用户名将在 $.get 返回的数据对象中：

```
 $.get('login.php',params, function(data){
     if(data){
         alert(data.username); // that's the value from php
     }
 } 
```

您可以对值进行大量检查：

```
 ... 
    if(data.username) // username isn't empty string, null, undefined
    if(data.username!==undefined) // if you got it at all 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T15:42:25.987

使用 .getJSON()：[http ://api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)

然后只需使用

```
data.username 
```

# java - XYBarChart 和 ClusteredXYBarRenderer - 指定自定义缩放级别

> ID：11398434
> 
> 赞同：2
> 
> 时间：2012-07-09T15:38:40.613
> 
> 标签：java, jfreechart

我在创建 XYBarChart 时尝试使用 ClusteredXYBarRenderer。该图表本身添加了多个数据系列。我的要求是允许用户放大域轴，同时防止放大范围轴。我可以在我的代码中轻松实现这一点。

但是，我遇到的是以下要求：

*   仅缩放到域轴上**特定级别的能力。**即我不希望用户放大小数值。如果域包含值 {3, 4, 5....}，则用户可以最大程度放大以查看 {3, 4} 等，但不能放大 {3, 3.5, 3.75....}

*   在域数据点的开始/结束之间添加间距，例如：bar1, bar2, bar3 (x-value= 1) **[gap]** bar1, bar2, bar3 (x-value= 2), 这样会更容易让用户区分一组值的开始位置和结束位置。

这是一个 SSCCE 供您参考：

```
import javax.swing.JFrame;
import javax.swing.JScrollPane;

import org.jfree.chart.ChartPanel;
import org.jfree.chart.JFreeChart;
import org.jfree.chart.axis.NumberAxis;
import org.jfree.chart.axis.ValueAxis;
import org.jfree.chart.plot.PlotOrientation;
import org.jfree.chart.plot.XYPlot;
import org.jfree.chart.renderer.xy.ClusteredXYBarRenderer;
import org.jfree.chart.renderer.xy.XYBarRenderer;
import org.jfree.data.xy.IntervalXYDataset;
import org.jfree.data.xy.XYSeries;
import org.jfree.data.xy.XYSeriesCollection;

public class ClusteredBarChart {

    private JFreeChart createClusteredChart(String title, String categoryAxisLabel, String valueAxisLabel, IntervalXYDataset dataset) {

        NumberAxis domainAxis = new NumberAxis(categoryAxisLabel);
        domainAxis.setAutoRangeIncludesZero(false);
        domainAxis.setAutoRange(true);

        ValueAxis valueAxis = new NumberAxis(valueAxisLabel);

        XYBarRenderer renderer = new ClusteredXYBarRenderer();
        renderer.setShadowVisible(false);

        XYPlot plot = new XYPlot(dataset, domainAxis, valueAxis, renderer);
        plot.setOrientation(PlotOrientation.VERTICAL);
        plot.setNoDataMessage("=== No Datapoints Detected ====");

        JFreeChart chart = new JFreeChart(title, JFreeChart.DEFAULT_TITLE_FONT, plot, true);

        return chart;
    }   

    private void createDummyData(XYSeriesCollection intervalDataset){

        XYSeries series1 = new XYSeries("series1");
        XYSeries series2 = new XYSeries("series2");
        XYSeries series3 = new XYSeries("series3");
        XYSeries series4 = new XYSeries("series4");
        XYSeries series5 = new XYSeries("series5");

        series1.add(6, 10);
        series1.add(7, 11);
        series1.add(10, 11);
        series1.add(17, 17);
        series1.add(21, 15);

        series2.add(6, 18);
        series2.add(7, 10);
        series2.add(10, 14);
        series2.add(17, 12);
        series2.add(21, 6);

        series3.add(6, 12);
        series3.add(7, 13);
        series3.add(10, 14);
        series3.add(17, 16);
        series3.add(21, 9);

        series4.add(6, 8);
        series4.add(7, 22);
        series4.add(10, 21);
        series4.add(17, 26);
        series4.add(21, 24);

        series5.add(6, 14);
        series5.add(7, 11);
        series5.add(10, 31);
        series5.add(17, 12);
        series5.add(21, 11);    

        intervalDataset.addSeries(series1);
        intervalDataset.addSeries(series2);
        intervalDataset.addSeries(series3);
        intervalDataset.addSeries(series4);
        intervalDataset.addSeries(series5);
    }

    public  void doPlot(String plotTitle) {
        XYSeriesCollection intervalXYDataSet  = new XYSeriesCollection();

        createDummyData(intervalXYDataSet);

        JFreeChart chart = createClusteredChart(plotTitle, "Category", "Value", intervalXYDataSet);
        ChartPanel chartpanel = new ChartPanel(chart);
        chartpanel.setDomainZoomable(true);
        chartpanel.setRangeZoomable(false);

        JFrame frame = new JFrame();
        frame.setTitle(plotTitle);
        frame.add(new JScrollPane(chartpanel));
        frame.pack();
        frame.setVisible(true);

    }

    public static void main(String[] args) {
        new ClusteredBarChart().doPlot("Test Plot");
    }
} 
```

如果您运行该示例，您会看到值 #6 和 #7 的点看起来非常接近。我想在它们之间添加空间。另外，我想防止用户放大到 6.5 或 6.75 等……换句话说，最大可缩放范围应该是实际数据集中存在的值。

请注意，这个问题引用了[我之前提出的](https://stackoverflow.com/questions/11366717/jfreechart-xybarchart-show-separate-bars-for-each-series)这个问题。

任何帮助将非常感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T22:00:06.093

我可以看到两种方法：

*   使用合适的`zoom()`方法的方法。您需要遍历模型以在数据空间中找到所需的集群边界，并且可以使用of转换为 Java 2D 空间。您可以从以下位置获取绘图的数据区域：`ChartPanel``Rectangle2D``valueToJava2D()``NumberAxis``ChartPanel`

    ```
    Rectangle2D r = panel.getChartRenderingInfo().getPlotInfo().getDataArea(); 
    ```

*   向您添加控件`ChartPanel`以仅显示感兴趣的集群，不包括模型中的其他集群。这个通过多个盒须图页面的相关[示例](https://stackoverflow.com/a/6849654/230513)可能会有所帮助。

# php - 在 PHP 中为特定单词读取文件中的特定行

> ID：11398436
> 
> 赞同：0
> 
> 时间：2012-07-09T15:38:43.943
> 
> 标签：php

我是 php 新手，我需要阅读文本文件的第 5 行，看看它是否包含特定的字符串，最有效的方法是什么？我知道我可以使用这种方法准备好所有行，如果它是 5 我应该在这里放一个计数器并打破循环吗？还是有更好的方法..

```
 $file = fopen($fileName,'r');
    while(!feof($file)) 
    { 
        $name = fgets($file);            
    }

    fclose($file); 
```

编辑

我已将我的代码更新为此，但 strpos 总是找不到字符串，即使它存在。我已经验证第 5 行看起来像这样 PACKAGE_NAME: com.boom.appfree

```
//read entire file into an array 
$lines = file($target_path);

//check line 5 if it contains free
$pos = strpos($line[4], 'free');

if ($pos === false) 
{
  $subject = "Paid Log uploaded";
} else 
{
   $subject = "Log uploaded";
} 
```

任何建议请..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:40:50.330

`$lines =`[`file`](http://php.net/file)`("filename.txt");`

然后你可以得到第五行：`$lines[4]`并用它搜索你要找的词`strpos`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T15:45:58.567

如果文件的行大小相同，可以使用 fseek：[http](http://php.net/manual/en/function.fseek.php) ://php.net/manual/en/function.fseek.php跳转到第 5 行。

否则添加一个计数器并打破 while 循环就可以了。

# php - 动态表单 javascript, php, mysql

> ID：11398438
> 
> 赞同：0
> 
> 时间：2012-07-09T15:38:49.557
> 
> 标签：php

我已经有添加多个文本字段的javascript代码：我想知道添加了多少字段并将它们存储在mysql db中

EX：添加了 10 个字段 $_GET['1'], $_GET['2'] ...... $_GET['10'] 我怎么知道具体的字段数在php中提交到下一页？

```
<html>
<head>
<script type="text/javascript">
var intTextBox=0;

//FUNCTION TO ADD TEXT BOX ELEMENT
function addElement()
{
intTextBox = intTextBox + 1;
var contentID = document.getElementById('content');
var newTBDiv = document.createElement('div');
newTBDiv.setAttribute('id','strText'+intTextBox);
newTBDiv.innerHTML = "Text "+intTextBox+": <input type='text' id='" + intTextBox + "' name='" + intTextBox + "'/>";
contentID.appendChild(newTBDiv);
}

//FUNCTION TO REMOVE TEXT BOX ELEMENT
function removeElement()
{
if(intTextBox != 0)
{
var contentID = document.getElementById('content');
contentID.removeChild(document.getElementById('strText'+intTextBox));
intTextBox = intTextBox-1;
}
}
</script>
</head>
<body>
<form action="testjs.php">
<div id="content"></div>
<p><input type="button" onclick="addElement()" value="ADD" > <input type="button" onclick="removeElement()" value="REMOVE" ></p>
<input type="submit" value="SUBMIT">
</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:42:17.300

在 addElement() 函数中，您可以将隐藏字段增加 1，该字段将传递到您的操作页面。
当然，在您的 removeElemt() 中，该值必须减 1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T15:44:52.593

增加一个隐藏的表单域。或者，循环遍历 PHP 脚本中的 GET/POST 数据并计算出现次数。

# c - 我是否应该明确定义枚举常量的值

> ID：11398442
> 
> 赞同：5
> 
> 时间：2012-07-09T15:38:58.107
> 
> 标签：c, compiler-construction, enums, declaration, explicit

我之前听说过，如果我没有做一些聪明的事情，比如将值用作位掩码，我应该让编译器选择为枚举常量分配哪些值。如果我只是将枚举值用于更明确的代码文档，那么如果我没有明确定义所有值，是否会有任何陷阱？我相信值是按升序分配的。我应该定义第一个值以确保每次连续编译的值相同吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-09T15:45:16.977

从 C99，第 6.7.2.2p3 节：

> 枚举器列表中的标识符被声明为具有 int 类型的常量，并且可以出现在任何允许的地方。带有 = 的枚举器将其枚举常量定义为常量表达式的值。如果第一个枚举数没有=，则其枚举常数的值为0。后续每个没有=的枚举数将其枚举常数定义为前一个枚举常数的值加1得到的常数表达式的值。（使用带 = 的枚举数可能会产生枚举常量，其值与同一枚举中的其他值重复。）

唯一需要为第一个枚举器赋值的情况是，如果你希望它的值不同于`0`. 通常，您不会这样做，因为枚举数通常用于索引数组。

下面是一个“前一个值加 1”的简单示例。

```
enum {
  A,
  B,
  C = 0,
  D,
  E
};

int main ()
{
    printf("%d\n", A);
    printf("%d\n", B);
    printf("%d\n", C);
    printf("%d\n", D);
    printf("%d\n", E);
    return 0;
} 
```

上述程序的输出是：

```
0
1
0
1
2 
```

我能想到的唯一“陷阱”是，如果您希望多个`enum`名称表示相同的值，您应该记住将它们贴在您别名的项目旁边，或者放在`enum`列表的底部。我更喜欢后者，所以我可以计算`enum`行数来预测`enum`值是什么。

```
enum {
    A,
    B,
    E,

    /* aliases below */
    C = A,
    D = B
}; 
```

否则，枚举器就像`int`文字一样。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-09T16:02:05.797

我认为这将取决于您对类型的使用。

不提供`enum`初始化程序的优点：

*   在开发过程中更容易添加和删除值。
*   您不会意外定义具有相同值的两个标识符。

提供`enum`初始化程序的优点：

*   安全地序列化和反序列化数据。如果您需要将这些值放在文件、网络套接字等中，我会继续编写这些值。
*   更容易查找值以进行调试。

# ruby-on-rails - 用户通过分配具有许多角色

> ID：11398451
> 
> 赞同：1
> 
> 时间：2012-07-09T15:39:27.703
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我希望能够为每个用户分配多个角色并使用 User.first.roles 之类的东西将它们取回，但我迷路了，你将如何使用 rails 控制台来做到这一点？我在模型中做错了什么？

```
u = User.first

User Load (0.1ms)  SELECT "users".* FROM "users" LIMIT 1
 => #<User id: 18 [...]>

1.9.3-p194 :004 > u.roles
NameError: uninitialized constant User::Assignment
    from [path]/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/inheritance.rb:119:in `compute_type'
    from [path]/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/reflection.rb:172:in `klass'
    from [path]/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/reflection.rb:385:in `block in source_reflection'
    from [path]/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/reflection.rb:385:in `collect'
    from [path]/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/reflection.rb:385:in `source_reflection'
    from [path]/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/reflection.rb:508:in `check_validity!'
    from [path]/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/associations/association.rb:26:in `initialize'
    from [path]/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/associations/collection_association.rb:24:in `initialize'
    from [path]/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/associations/has_many_through_association.rb:10:in `initialize'
    from [path]/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/associations.rb:157:in `new'
    from [path]/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/associations.rb:157:in `association'
    from [path]/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/associations/builder/association.rb:44:in `block in define_readers'
    from (irb):4
    from [path]/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/commands/console.rb:47:in `start'
    from [path]/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/commands/console.rb:8:in `start'
    from [path]/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/commands.rb:41:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>' 
```

模型/用户.rb

```
class User < ActiveRecord::Base
 attr_accessible :name, :email, :password, :password_confirmation, :role_id
 has_many :assignments
 has_many :roles, through: :assignments
 #more code...
end 
```

模型/角色.rb

```
class Role < ActiveRecord::Base
 attr_accessible :name
 has_many :assignments
 has_many :users, through: :assignments
end 
```

模型/assignments.rb

```
class Assignments < ActiveRecord::Base
 attr_accessible :role_id, :user_id
 belongs_to :user
 belongs_to :role
end 
```

schema.rb：[http ://cl.ly/323n1t0Q1t390y1M2S0E](http://cl.ly/323n1t0Q1t390y1M2S0E)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T03:28:12.910

将模型文件的名称更改为`models/assignments.rb`，`models/assignment.rb`并将其类名从`class Assignments`更改为`class Assignment`。模型名称应该是单数，它是一个 Rails 约定。因此，当您运行`u.roles`它时，它正在寻找作业而不是作业。

# android - 如何在android中根据颜色获取复杂区域？

> ID：11398452
> 
> 赞同：2
> 
> 时间：2012-07-09T15:39:28.237
> 
> 标签：android, image-processing, graphics, bitmap

我目前正在开发一款游戏，如果敌人不在该黑色区域内，则该游戏涉及填充黑色区域。因为，它是一个游戏，所以它需要很快。目前我正在做以下事情：

> 1.  开始在黑色区域进行洪水填充
> 2.  在检查填充算法中的像素时，还要检查敌人
> 3.  如果没有找到敌人，则将此位图作为主画布的位图

![要检查的黑色区域](../Images/77641c721ee42cab869bdae36dc2872b.png)

到目前为止，这是我能找到的最好和最快的方法。但是，游戏仍然冻结了几分之一秒。但是，如果我使用[Regions](http://developer.android.com/reference/android/graphics/Region.html)和[Paths](http://developer.android.com/reference/android/graphics/Path.html)然后使用[canvas.drawPath](http://developer.android.com/reference/android/graphics/Canvas.html#drawPath%28android.graphics.Path,%20android.graphics.Paint%29)，我想它会快得多。也可以使用[region.contains(x,y)](http://developer.android.com/reference/android/graphics/Region.html#contains%28int,%20int%29)检查敌人。您能告诉我如何获得具有该特定颜色的区域/区域数组吗？

提前致谢。

PS：我不知道这是否有必要，但我使用[了 paint.setXfermode](http://developer.android.com/reference/android/graphics/Paint.html#setXfermode%28android.graphics.Xfermode%29) [(new AvoidXfermode(COLOR1, 0, Mode.TARGET));](http://developer.android.com/reference/android/graphics/AvoidXfermode.html) 并且用所需的颜色替换所有 COLOR1 非常快。这让我更加确信我的上述问题有一个解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:59:04.440

有多少敌人？它们是如何存储的？你为什么不解决相反的问题。拿一块黑色的画布，把敌人所在的区域涂成绿色？如果大部分画布最终变成黑色，速度会明显更快。

# javascript - Flot绘制图形弹出窗口

> ID：11398456
> 
> 赞同：0
> 
> 时间：2012-07-09T15:39:47.290
> 
> 标签：javascript, jquery, flot

我一生都无法弄清楚如何做到这一点。

我想要做的是有flot，在从Ajax 查询中获取数据后，将图形写入JavaScript 弹出窗口。

这可能吗？

//编辑，添加代码

```
function generatePieChart(graph_id, objData, hyperlinks, newwindow) {

    var data = objData;
    for (var i = 0; i < data.length; i++) {
        var num = parseInt(objData[i][1]);
        if(hyperlinks == true){
            data[i] = { label: "<a class='user_pie_link super_light_box' id='"+objData[i][0]+"'>"+objData[i][0]+" <span style='float: right;'>"+objData[i][1]+"</span></a>", data: num }
        }
        else{
            data[i] = { label: "<p id='"+objData[i][0]+"'>"+objData[i][0]+" <span style='float: right;'>"+objData[i][1]+"</span></p>", data: num }
        }

    }

    $.plot($(graph_id), data,
    {
        series: {
            pie: {
                show: true,
            },
            legend: {
                show: false
            }
        }
    });
} 
```

所以这就是我到目前为止所拥有的，我已经摆脱了我的混乱，我试图使用 window.open(...); 但这似乎不起作用，我需要的是在第一个实例上将图表写入标准 div，当 newwindow = true 时，它​​将创建一个新的浏览器窗口，然后将图表写入该窗口。

# .net - 使用 MEF 和第 3 方组件跟踪来自 Windows WCF 服务的泄漏内存

> ID：11398458
> 
> 赞同：0
> 
> 时间：2012-07-09T15:39:58.177
> 
> 标签：.net, wcf, c#-4.0, memory-leaks, mef

我有以下场景：

**WCF Windows 服务 1**

*   有工作要完成时调用 WCF 服务 2
*   使用结果更新数据库

**WCF Windows 服务 2**

*   使用托管可扩展性框架 (MEF) 在新的应用程序域中动态组合部件（插件）。

*   然后插件创建一个 Watin 实例（开源 .net 测试框架），该实例又创建一个新的 IE 进程，执行一些 WWW 导航，执行一些屏幕抓取，截取屏幕截图

*   一切都返回给调用者。

我在 WCF Windows 服务 2 中看到逐渐的内存泄漏，并且必须每隔几天重新启动一次。使用 perfmon 在我的开发环境中（孤立地）分析了服务后，我似乎看不到内存泄漏。我曾尝试使用.Net Memory Profiler，但似乎也没有得到任何结论。IDispose 已实现并被调用。

我开始认为是两个 WCF Windows 服务之间的交互可能会保留对象引用并阻止 IDispose 被调用。有没有其他人看到过这种行为？还是我在叫错树？

在任何人提到之前......我明白正在做的事情很疯狂......

# objective-c - 在 UITableViewCell 中自动调整 UIViews 的大小

> ID：11398461
> 
> 赞同：0
> 
> 时间：2012-07-09T15:40:12.903
> 
> 标签：objective-c, ios, xcode, cocoa

我已经对 UITableView 单元进行了子类化，并且我想以编程方式向它添加 UITextField。我已经弄清楚如何创建文本字段；但是，当设备旋转时，我很难调整它的大小。这是我的代码（请记住，这`self`是一个 UITableViewCell 子类）

```
self.myTextField = [[UITextField alloc] init];
self.myTextField.frame = CGRectMake(400, 6,TEXT_FIELD_WIDTH ,TEXT_FIELD_HEIGHT);
[self addSubview:self.myTextField];
self.myTextField.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleLeftMargin; 
```

我想要的是无论方向如何，文本字段在屏幕中心（点 400 附近）都有一个 x 原点，我希望它保持与屏幕右边缘的距离并扩大其宽度（灵活的左边距）。

如果我注释掉该`autoresizingMask`行并以纵向方式启动设备，这会很好。但是，每当我将`autoresizing`行添加回来时，它会将文本字段从点 400 移开，即使是纵向。

有什么建议么？我也尝试将文本字段添加到内容视图，但这似乎并没有改变任何东西。

编辑：我考虑过使用 layoutsubviews 方法，但这似乎有点粗糙，因为我必须在一大堆不同的坐标中进行硬编码。因此，如果有另一种方法可以做到这一点，那将是首选。

编辑：例如，为了让文本字段从中间开始，我必须给它一个大约 150 的帧 xOrigin。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:45:49.097

您设置错误的 autoresizingMask。您必须使用 C 位 OR 运算符指定结合[UIViewAutoresizing中描述的常量的值，例如：](http://developer.apple.com/library/ios/documentation/uikit/reference/uiview_class/uiview/uiview.html#//apple_ref/c/tdef/UIViewAutoresizing)

```
self.myTextField.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleLeftMargin; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T15:58:00.853

`400`如果你想把它放在中间，你不应该硬编码。只需使用`self.bounds.size.width * 0.5`.

现在不确定，但您的第二次编辑似乎表明该单元格被初始化为默认情况下适合 iPhone 纵向的框架（320 点），因此`400`将超出视图的初始范围。由于文本字段最初位于单元格边界之外，它会尝试使用灵活的左边距自动调整大小掩码保持这种状态。

# c# - 无法在我的动态编译的 C# 应用程序中包含清单

> ID：11398466
> 
> 赞同：2
> 
> 时间：2012-07-09T15:40:23.207
> 
> 标签：c#, dynamic, compiler-construction, compiler-errors, manifest

我只是负责升级内部企业 Web 应用程序。用户输入一些数据，然后网络应用程序编译一个自定义的 winforms EXE（应用程序的自解压器/安装程序类型），然后网站将其作为下载提供。

我们最近了解到这个自定义编译的安装程序在 Windows 7 中显示兼容性错误/警告。经过一些研究后，我了解到我需要提供一个应用程序清单来指定与 Windows 7 的兼容性：

相关链接：

*   [Stackoverflow 文章详细介绍了 Windows 7 兼容性错误](https://stackoverflow.com/questions/1069135/this-program-might-not-have-installed-correctly-message-in-windows-7-rc)
*   [MSDN 文章详细说明了应用程序清单中的要求](http://msdn.microsoft.com/en-us/library/dd371711%28VS.85%29.aspx)
*   [显示如何设置编译器选项的示例代码](http://www.shulerent.com/2012/01/24/how-to-embed-an-application-manifest-in-a-codedom-generated-assembly/)

这是我对自定义/动态编译代码和应用程​​序清单的第一次体验。

由于这个应用程序是动态编译的（从单个代码文件和一些嵌入式资源），我不能只向我的项目添加清单。所以我在编译时使用了编译器的“/win32manifest”编译器选项来引用manifest文件。

这是来自实际执行编译的自定义“存档编译器”类的一些代码：（我只添加了应用程序清单部分）

```
public void CompileArchive(string archiveFilename, bool run1stItem, string iconFilename)
{
    CodeDomProvider csc = new CSharpCodeProvider();
    CompilerParameters cp = new CompilerParameters();

    cp.GenerateExecutable = true;
    cp.OutputAssembly = archiveFilename;
    cp.CompilerOptions = "/target:winexe";

    // Custom option to run a file after extraction  
    if (run1stItem) {
        cp.CompilerOptions += " /define:RUN_1ST_ITEM";
    }
    if (!string.IsNullOrEmpty(iconFilename)) {
        cp.CompilerOptions += " /win32icon:" + iconFilename;
    }
    cp.ReferencedAssemblies.Add("System.dll");
    cp.ReferencedAssemblies.Add("System.Windows.Forms.dll");

    // Add application manifest to specify operating system compatibility (to fix compatibility warning in Windows 7)
    string AppManifestPath = Path.Combine( System.Web.HttpContext.Current.Server.MapPath( "~/Content/" ), "CustomInstaller.exe.manifest" );
    if ( File.Exists( AppManifestPath ) ) {
        cp.CompilerOptions += string.Format( " /win32manifest: \"{0}\"", AppManifestPath );
    }

    // Add compressed files as resource
    cp.EmbeddedResources.AddRange(filenames.ToArray()); 

    // Compile standalone executable with input files embedded as resource
    CompilerResults cr = csc.CompileAssemblyFromFile(cp, sourceCodeFilePath);

    // yell if compilation error
    if (cr.Errors.Count > 0) {
        string msg = "Errors building " + cr.PathToAssembly;
        foreach (CompilerError ce in cr.Errors) { msg += Environment.NewLine + ce.ToString(); }
        throw new ApplicationException(msg);
    }
} 
```

但是，当我编译时，我一直遇到这个错误：

> 错误构建 D:\Projects\MySolution\WebAppName\App_Data\MyUsername\CustomInstaller.exe 错误 CS2007: Unrecognized option: '/win32manifest:'

除了声明此参数存在且有效的文章之外，我无法找到有关此的信息。Web 应用程序位于 Visual Studio 2010 中，并在框架 2.0 上运行。动态编译的应用程序也引用了 .net 2.0（使用反编译器验证）。我不确定调用什么 EXE 来执行编译，或者我可以检查什么来解决这个问题。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-04T12:37:28.437

可能需要删除这一行之间的`/win32manifest:`空格`\"{0}\"``cp.CompilerOptions += string.Format( " /win32manifest: \"{0}\"", AppManifestPath );`

没有空间它可以正常工作，当我添加空间时，就像在你的代码中一样，我有错误：

```
Errors building C:\Projects\Services\Services.WebUI\Binaries\install\temp\codedom.exe
error CS2005: Missing file specification for '/win32manifest:' option
warning CS2008: No source files specified 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-07T07:22:32.703

/win32manifest 开关的 MSDN 文档页面最早存在于 Visual Studio 2008。所以也许它是在 .NET v3.5 中添加的。

您可以在 CSharpCodeProvider 构造函数中指定“CompilerVersion”。

我必须坚持使用 .NET 2.0，所以我将使用 mt.exe 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T16:41:15.603

经过更多研究，我了解了[mt.exe](https://stackoverflow.com/questions/1423492/how-do-i-add-a-manifest-to-an-executable-using-mt-exe)，这是一个用于添加应用程序清单的简单命令行实用程序。我将 exe 的副本放入我的 web 项目中，然后在应用程序编译后添加代码以调用此过程：

```
//Add an application manifest using mt.exe
System.Diagnostics.Process process = new System.Diagnostics.Process();
System.Diagnostics.ProcessStartInfo startInfo = new System.Diagnostics.ProcessStartInfo();
startInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden;
startInfo.FileName = Path.Combine( System.Web.HttpContext.Current.Server.MapPath( "~/Content/" ), "mt.exe" );
string AppManifestPath = Path.Combine( System.Web.HttpContext.Current.Server.MapPath( "~/Content/" ), "CustomInstaller.exe.manifest" );
startInfo.Arguments = string.Format( "-nologo -manifest \"{0}\" -outputresource:\"{1};#1\"", AppManifestPath, cp.OutputAssembly );
process.StartInfo = startInfo;
process.Start();
process.WaitForExit( 10000 ); //wait until finished (up to 10 sec) 
```

这成功地将我的清单快速轻松地添加到编译的 EXE 中。我还发现了这个[Manifest Viewer](http://weblogs.asp.net/kennykerr/archive/2007/07/10/manifest-view-1-0.aspx)，它可以很容易地验证我的清单内容。

# mysql - 将日期合并到此 GROUP BY 和 INNER JOIN 选择语句中

> ID：11398467
> 
> 赞同：0
> 
> 时间：2012-07-09T15:40:31.580
> 
> 标签：mysql

我正在尝试在我的奖励系统中列出前 20 名收入者的列表。

以下陈述完美地表明：

```
SELECT
    S.User_ID As UserID,
    CONCAT(S.User_Forename, " ", S.User_Surname) AS StudentName,
    T.TotalPoints
FROM
    student S
INNER JOIN 
    ( SELECT
        Datetime, Recipient_ID, SUM(Points) AS TotalPoints
      FROM
        transactions
      GROUP BY
        Recipient_ID ) T
ON
    S.User_ID = T.Recipient_ID
ORDER BY TotalPoints DESC
LIMIT 20 
```

然而，想想看，明年，我需要包括一个日期范围（即仅显示该学年的最高收入者）。

出于测试目的，我尝试修改以下包含`LESS THAN DATETIME`选择的语句：

```
SELECT
    S.User_ID As UserID,
    CONCAT(S.User_Forename, " ", S.User_Surname) AS StudentName,
    T.TotalPoints
FROM
    student S
INNER JOIN 
    ( SELECT
        Datetime, Recipient_ID, SUM(Points) AS TotalPoints
      FROM
        transactions
      GROUP BY
        Recipient_ID ) T
ON
    S.User_ID = T.Recipient_ID
WHERE t.Datetime < 2012-03-20
ORDER BY TotalPoints DESC
LIMIT 20 
```

我也试过这个：

```
SELECT
    S.User_ID As UserID,
    CONCAT(S.User_Forename, " ", S.User_Surname) AS StudentName,
    T.TotalPoints
FROM
    student S
INNER JOIN 
    ( SELECT
        Datetime, Recipient_ID, SUM(Points) AS TotalPoints
      FROM
        transactions
      WHERE Datetime < 2012-03-20
      GROUP BY
        Recipient_ID ) T
ON
    S.User_ID = T.Recipient_ID
ORDER BY TotalPoints DESC
LIMIT 20 
```

然而，这两个都显示一个空的结果集。

如果我做一个简单的`SELECT * FROM transactions WHERE Datetime < 2012-03-20`，将返回超过 25K 的结果。

我哪里错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:50:32.303

`'`您的日期值周围似乎缺少单引号：

```
WHERE t.Datetime < '2012-03-20' 
```

# android - Google 云消息传递 - GCM - SERVICE_NOT_AVAILABLE

> ID：11398470
> 
> 赞同：23
> 
> 时间：2012-07-09T15:40:35.660
> 
> 标签：android, google-cloud-messaging, service-not-available

我正在尝试实施新的 GCM，我正在关注谷歌： [http](http://developer.android.com/guide/google/gcm/gs.html) : *//developer.android.com/guide/google/gcm/gs.html*

我在获取我的设备注册 ID 时遇到了困难！

我的应用程序不断尝试与 Google 服务器连接，这里是我的错误日志：

```
onReceive: com.google.android.gcm.intent.RETRY
GCM IntentService class: com.dombox.app.GCMIntentService
Acquiring wakelock
[GCMIntentService] start
Registering app com.dombox.app of senders _my_sender_id_
Releasing wakelock
onReceive: com.google.android.c2dm.intent.REGISTRATION
GCM IntentService class: com.dombox.app.GCMIntentService
Acquiring wakelock
[GCMIntentService] start
handleRegistration: registrationId = null, error = SERVICE_NOT_AVAILABLE, unregistered = null
Registration error: SERVICE_NOT_AVAILABLE
Scheduling registration retry, backoff = 912617 (768000)
Releasing wakelock 
```

这是我的活动代码，要求提供 ID：

```
 try{
        Log.i(TAG, "[checkNotifRegistration] checkDevice");
        GCMRegistrar.checkDevice(this);
        Log.i(TAG, "[checkNotifRegistration] checkManifest");
        GCMRegistrar.checkManifest(this);
        if (GCMRegistrar.isRegistered(this)) {
            Log.i(TAG, "[checkNotifRegistration] reg id : "+GCMRegistrar.getRegistrationId(this));
        }
        final String regId = GCMRegistrar.getRegistrationId(this);
        if (regId.equals("")) {
            // SENDER_ID is my project id into google account url
            GCMRegistrar.register(this, SENDER_ID);
            Log.i(TAG, "[checkNotifRegistration] reg id : "+GCMRegistrar.getRegistrationId(this));
        } else {
            Log.i(TAG, "[checkNotifRegistration] already registered as : " + regId);
        }
    } catch(Exception e){
        Log.e(TAG, "[checkNotifRegistration] Exception : "+e.getMessage());
        e.printStackTrace();
    } 
```

这是我的服务代码

```
public class GCMIntentService extends GCMBaseIntentService {

private static final String TAG = "GCMIntentService";

public GCMIntentService() {
    super(SENDER_ID);
           // SENDER_ID is my project id into google account url
    // TODO Auto-generated constructor stub
    Log.d(TAG, "[GCMIntentService] start");
}

public GCMIntentService(String senderId) {
    super(senderId);
    // TODO Auto-generated constructor stub
    Log.d(TAG, "[GCMIntentService] start - sender Id : "+senderId);
}
} 
```

这是我的 Android 清单：

```
<permission android:name="com.dombox.app.permission.C2D_MESSAGE" android:protectionLevel="signature" />
<uses-permission android:name="com.dombox.app.permission.C2D_MESSAGE" />
<uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
<uses-permission android:name="android.permission.WAKE_LOCK" />
<uses-permission android:name="android.permission.WRITE_SETTINGS" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />

<application
    android:icon="@drawable/icon"
    android:label="@string/app_name" >

    <receiver
        android:name="com.google.android.gcm.GCMBroadcastReceiver"
        android:permission="com.google.android.c2dm.permission.SEND" >
        <intent-filter>
            <action android:name="com.google.android.c2dm.intent.RECEIVE" />
            <action android:name="com.google.android.c2dm.intent.REGISTRATION" />

            <category android:name="com.myapp.app" />
        </intent-filter>
    </receiver>

<service android:name=".GCMIntentService" android:enabled="true"/>

    <activity
        android:name=".activity.Myapp"
        android:label="@string/app_name" >

        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>

    </activity> 
```

我按照谷歌的指示，但我坚持这个 SERVICE_NOT_AVAILABLE 错误，

我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-07-11T08:43:00.943

问题与代码无关，而是指向测试电话的链接。 **测试手机没有 SIM 卡，也没有设置时钟**。所以谷歌不能在错误的时间重新注册它。

我设法使用Android虚拟设备，使用google api并通过**设置测试电话时钟**来获得注册ID 。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-09T16:33:32.073

```
android:enabled="true" 
```

删除这个 ^

如果您尚未将此添加到清单中

```
<uses-sdk
android:minSdkVersion="8"
android:targetSdkVersion="8" 
```

您不需要 GCMIntentService 中的第二个构造函数。只有这个

```
public GCMIntentService() {         
 super(SENDER_ID);  } 
```

确保您的 SENDER_ID 是您在浏览 google 代码网站和浏览 GCM 服务时从浏览器的 URL 中复制的号码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-05-30T14:03:38.953

请记住，如果您位于公司防火墙后面，则可能不允许 GCM 使用的某些端口通过本地无线进行通信。我在尝试让我的模拟器最初工作时遇到了这个问题。我必须获得一个允许下面列出的端口通过的特殊 IP。

* * *

> 注意：如果您的组织有防火墙限制进出 Internet 的流量，您需要将其配置为允许与 GCM 连接，以便您的 Android 设备接收消息。要打开的端口是：5228、5229 和 5230。GCM 通常只使用 5228，但有时会使用 5229 和 5230。GCM 不提供特定 IP，因此您应该允许防火墙接受到包含的所有 IP 地址的传出连接在 Google 的 ASN 15169 中列出的 IP 块中。

[http://developer.android.com/google/gcm/gcm.html](http://developer.android.com/google/gcm/gcm.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-05T03:53:15.423

我遇到了这个问题...我的解决方案是禁用互联网连接并使用电话服务。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-08-14T20:53:59.537

我遇到了这个问题，它是由WIFI连接引起的。我关闭了 WIFI 并再次进行了测试（在 3g 上）并且它成功了。然后我重新打开WIFI并再次出现错误。回到 3g，以确保，它再次工作。

因此，总而言之，问题是由连接引起的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-11-11T20:59:35.107

我在 genymotion 上运行我的应用程序时遇到了这个问题。[像这里](https://stackoverflow.com/questions/17831990/how-do-you-install-google-frameworks-play-accounts-etc-on-a-genymotion-virt?answertab=active#tab-top)所说的那样安装谷歌播放服务，一切正常。

# python - Python没有将完整的字符串写入文件

> ID：11398471
> 
> 赞同：6
> 
> 时间：2012-07-09T15:40:45.227
> 
> 标签：python, file-io, dictionary, sequence, truncation

我正在尝试将对齐的蛋白质序列输出到文件中，但是，每次尝试将字符串写入文件时，输出字符串都会被截断。我尝试写入的字符串长度为 4603 个字符，并以正确的字符数打印到控制台。我附加的第一段代码与输出变量本身有关。我将在此处包含完整的字符串，因为在写入文件时截断字符串的方式对我来说是可重现的。

```
out=open('out.7.9.12.txt','a+')

score_dict={}
Max='1ZER'
al1='XMXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXDLDVXXXVNMXFVXXXIXXXXAXXGXXXXXXXXXXXXXXXXXXXGTLAIXXXXXXXPILAFVXAXXXXXXXXXXXSXXXXXXXXFLLXXXXXWPSXXXXXXXXXXXXXXXXXXXXALXXIRIYXYWYXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXWRRTXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXLGMQVRYXXXXXXXXXXXXVHHXXEXDYQXFCYSXXXXXFRGXXRPXGXHXXKXXXPSILXXMLHXGXXXFSAHKDMWXXXXXXLSVXXXXXXXXXVXXKXFLPKNLXXXHLVCXXXXXXXXXXXXXXXXXXXXXXXVDXXXXXXXXXXXXXXXXXXXXXXMPXXGHXXXEXGTTRSXXXXXXXXXXSLXXXXDXXXXXXXXXXXXXXXXXXXXDLSIDGQXVKRIHQFXXXXXXXXXXXVXEXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXCXXLXKXLXNXXXXXXXXXXXXXXKXXXXXXXXXXXXXXXXXXXXXKXXXXXXXXXXXXXXXXXXXXXXXXPFXXXXXXXXXXXXXXXXXXXXXXHLVXXXGTSMGXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXGQXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXVXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXAXXGXXVYAAYYXXXXXXXXXXXXXXXXXXXXXXXPSDVSSLXXCLXVXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXCXXPXXXXXXXXXXXXXXXXXXAXXXXXGLXQXXXXYSXTDXXXNQFXXVXXXQRXXXXLXXXXXXXXXXXXXXXXXKXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXELQGXXXXXXXXXXXXXXXXXXXXSAXXXXXXXXXXXXXXXXXXXXXAXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXVXXEKIXXXXPXXXXLIPSTPEXXEMSXEMLXXXXQXXLCXXXSXYXVXXXXXRFXKVPXQXXXXXXXXQIXLQXGXLVDVXXRXXIXPXXXHNXNXXFYRKXLXXXFLXXXXXXXXEIXVXSEXXXXXXKXXSXXXXXRYSXLXXXHXQNMXXXDKIXXXXXXXXXXKVXPTQXXIXXIWXXXXGXXXKQDXXXQVLXXDVXXXXSGADMLXXAKXXXSIAXNCQVXXEXXLXLEXXNCGXHSVVMEXRPRXXXKXTAKLXXIIDFLASVHNTDNNKKLDXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX'

score_dict[Max]=al1

for name,sequence in score_dict.items():
            out.write('>')
            out.write(name)
            out.write('\n')
            for line in score_dict[name]:
                    out.write(line)
            out.write('\n') 
```

使用此代码片段，文件的输出应等于 al1。但是，文件的输出如下：

```
XMXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXDLDVXXXVNMXFVXXXIXXXXAXXGXXXXXXXXXXXXXXXXXXXGTLAIXXXXXXXPILAFVXAXXXXXXXXXXXSXXXXXXXXFLLXXXXXWPSXXXXXXXXXXXXXXXXXXXXALXXIRIYXYWYXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXWRRTXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXLGMQVRYXXXXXXXXXXXXVHHXXEXDYQXFCYSXXXXXFRGXXRPXGXHXXKXXXPSILXXMLHXGXXXFSAHKDMWXXXXXXLSVXXXXXXXXXVXXKXFLPKNLXXXHLVCXXXXXXXXXXXXXXXXXXXXXXXVDXXXXXXXXXXXXXXXXXXXXXXMPXXGHXXXEXGTTRSXXXXXXXXXXSLXXXXDXXXXXXXXXXXXXXXXXXXXDLSIDGQXVKRIHQFXXXXXXXXXXXVXEXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXCXXLXKXLXNXXXXXXXXXXXXXXKXXXXXXXXXXXXXXXXXXXXXKXXXXXXXXXXXXXXXXXXXXXXXXPFXXXXXXXXXXXXXXXXXXXXXXHLVXXXGTSMGXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXGQXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXVXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXAXXGXXVYAAYYXXXXXXXXXXXXXXXXXXXXXXXPSDVSSLXXCLXVXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXCXXPXXXXXXXXXXXXXXXXXXAXXXXXGLXQXXXXYSXTDXXXNQFXXVXXXQRXXXXLXXXXXXXXXXXXXXXXXKXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXELQGXXXXXXXXXXXXXXXXXXXXSAXXXXXXXXXXXXXXXXXXXXXAXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXVXXEKIXXXXPXXXXLIPSTPEXXEMSXEMLXXXXQXXLCXXXSXYXVXXXXXRFXKVPXQXXXXXXXXQIXLQXGXLVDVXXRXXIXPXXXHNXNXXFYRKXLXXXFLXXXXXXXXEIXVXSEXXXXXXKXXSXXXXXRYSXLXXXHXQNMXXXDKIXXXXXXXXXXKVXPTQXXIXXIWXXXXGXXXKQDXXXQVLXXDVXXXXSGADMLXXAKXXXSIAXNCQVXXEXXLXLEXXNCGXHSVVMEXRPRXXXKXTAKLXXIIDFLASVHNTDNNKKLDXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
```

将这两个序列粘贴到文字处理器中并计数字符将显示第一个有 4603 个字符，第二个有 4090 个字符。

我为这里的序列块道歉，但我不确定我还能如何准确地表示这个问题。

编辑：代码现在应该可以工作（我修复了缓冲区问题和报价问题）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-09T15:51:13.130

你[最后关闭](http://docs.python.org/library/stdtypes.html?highlight=flush#file.close)文件吗？可能是您的某些数据位于缓冲区中，因此最好在完成后[关闭（）](http://docs.python.org/library/stdtypes.html?highlight=flush#file.close)文件（或者如果您出于某种原因不想关闭它，则[刷新（）它）。](http://docs.python.org/library/stdtypes.html?highlight=flush#file.flush)

更好的是，使用`with`将在您完成或发生异常时为您关闭文件的构造：

```
with open('out.7.9.12.txt','a+') as out:
   # the rest of your code indented under here
   # ....
   score_dict={}
   Max=245 
```

来自[flush()](http://docs.python.org/library/stdtypes.html?highlight=flush#file.flush)文档的注意事项：

> **注意**flush() 不一定将文件的数据写入磁盘。使用 flush() 后跟[os.fsync()](http://docs.python.org/library/os.html#os.fsync)来确保这种行为

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-09T15:51:13.690

最后使用 out.flush() （或 close() ）清除缓冲区。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T15:56:00.040

试着把`out.close()`你的脚本放在最后。它将确保您的所有输出都刷新到文件中。

此外，'a+' 是多余的；'a' 是附加模式，它已经是可写的。

```
Max = '245'
al1 = 'XMXXXXXXXXXXXXXXXXXXX ...'
scores = {Max:[al1]}

with open('out.7.9.12.txt', 'a') as outf:
    for name,data in scores.iteritems():
        outf.write('>{}\n{}\n'.format(name, '\n'.join(data))) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-20T13:21:45.370

我遇到了这个确切的问题。我发现我忽略了调用 close 作为一种方法。我使用的是 foo.close 而不是 foo.close()。

这解决了它。

# node.js - Node.js、Epxress 和everyAuth - “无法读取 <...> 的属性”

> ID：11398473
> 
> 赞同：0
> 
> 时间：2012-07-09T15:40:51.500
> 
> 标签：node.js, express, everyauth

**我正在研究在node.js**、**express**和**everyauth** 上运行的 Web 身份验证系统。代码的每一部分都是从[这里复制粘贴的，尽管我在](https://github.com/bnoguchi/everyauth/blob/master/example/server.js)**密码**验证方面没有运气——我在尝试**POST**表单数据时遇到了异常。节点控制台中的例外是：

```
TypeError: Cannot read property 'login' of undefined
at Object.module.exports.everyModule.submodule.configurable.loginFormFieldName.passwordFormFieldName.loginHumanName.loginKey.get.step.accepts.promises.displayLogin.post.step.accepts.promises.step.accepts.promises.step.description.accepts.promises.step.description.accepts.promises.step.description.accepts.promises.step.description.accepts.promises.step.description.accepts.promises.extractLoginPassword.interpretUserOrErrors.getSession.addToSession.sess.auth.sess.auth [as _extractLoginPassword] (D:\xampp\htdocs\KO_\node_modules\everyauth\lib\modules\password.js:188:21)
at Object.Step.exec (D:\xampp\htdocs\KO_\node_modules\everyauth\lib\step.js:47:21)
at RouteTriggeredSequence.StepSequence.start (D:\xampp\htdocs\KO_\node_modules\everyauth\lib\stepSequence.js:46:39)
at RouteTriggeredSequence.routeHandler (D:\xampp\htdocs\KO_\node_modules\everyauth\lib\routeTriggeredSequence.js:13:13)
at nextMiddleware (D:\xampp\htdocs\KO_\node_modules\everyauth\node_modules\connect\lib\middleware\router.js:175:25)
at param (D:\xampp\htdocs\KO_\node_modules\everyauth\node_modules\connect\lib\middleware\router.js:183:17)
at pass (D:\xampp\htdocs\KO_\node_modules\everyauth\node_modules\connect\lib\middleware\router.js:191:11)
at Object.router (D:\xampp\htdocs\KO_\node_modules\everyauth\node_modules\connect\lib\middleware\router.js:197:7)
at next (D:\xampp\htdocs\KO_\node_modules\everyauth\node_modules\connect\lib\http.js:204:15)
at Object.fetchUserFromSession [as handle] (D:\xampp\htdocs\KO_\node_modules\everyauth\index.js:33:43) 
```

我的代码片段：

```
everyauth.password
.loginWith('login')
.getLoginPath('/login')
.postLoginPath('/login')
.loginView('loginForm.jade')
.authenticate( function (login, password) {
  console.log("login + password");
  var errors = [];
  if (!login) errors.push('Missing login');
  if (!password) errors.push('Missing password');
  if (errors.length) return errors;
  var user = usersByLogin[login];
  if (!user) return ['Login failed'];
  if (user.password !== password) return ['Login failed'];
  return user;
})

.getRegisterPath('/register')
.postRegisterPath('/register')
.registerView('register.jade')
.validateRegistration( function (newUserAttrs, errors) {
  var login = newUserAttrs.login;
  if (usersByLogin[login]) errors.push('Login already taken');
  return errors;
})
.registerUser( function (newUserAttrs) {
  var login = newUserAttrs[this.loginKey()];
  return usersByLogin[login] = addUser(newUserAttrs);
})

.loginSuccessRedirect('/')
.registerSuccessRedirect('/'); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T21:42:07.083

不是因为这条线：`var login = newUserAttrs.login;`？

# encryption - 加密的可启动 Windows PE

> ID：11398474
> 
> 赞同：0
> 
> 时间：2012-07-09T15:40:52.293
> 
> 标签：encryption, usb, winpe, bootable

简而言之，我需要什么：

1.  从 USB 驱动器启动 Windows PE
2.  加密包含密码的自定义脚本，该脚本位于 WIN PE ISO 中
3.  理想情况下，引导将受密码保护（不是必需的）
4.  USB 驱动器需要为便携式 Windows 程序提供可用存储空间
5.  整个引导过程需要简单明了，并且复制到多个驱动器需要简单
6.  该解决方案需要在标准（廉价）USB 驱动器上运行，无需硬件加密。

这样做的原因是，如果 USB 驱动器被盗，密码一定无法访问。

到目前为止我已经尝试过：

*   我可以使用 YUMI (http://www.pendrivelinux.com/yumi-multiboot-usb-creator/) 获得 1、4、5 和 6
*   我已经研究了 Truecrypt 的系统加密选项，但看不到使用 Windows PE 执行此操作的方法

YUMI 在 USB 驱动器上创建引导引导程序并引导 Windows PE ISO，我在想可能有某种方法可以加密整个 ISO，然后在 YUMI 引导它之前自动解密它。虽然这看起来太费劲了。我还在想，也许脚本可以在 ISO 中压缩（使用 7 zip），然后在 Windows PE 启动上运行一个脚本，该脚本将要求输入密码来提取它，以便它可以运行。

任何帮助/想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T23:14:21.807

我面临着类似的问题，虽然我不需要 YUMI 来解决它。是的，这可能来得有点晚，但我们开始吧（这是我到目前为止所得到的）：

1.  首先，您需要 USB 驱动器。
2.  使用 Windows 7（或 HP 格式化工具）将其格式化为 NTFS。
3.  使用 Linux Box（YUMI + Puppy Linux 即可）访问 NTFS USB，打开 GParted 并打开 USB NTFS 引导标志。
4.  现在 USB 可启动（但尚未启动）
5.  使用 pebuilder 创建一个 BartPe ( `http://www.nu2.nu/pebuilder/`) 文件夹（无 iso）。（您需要一张 Windows XP SP3 安装 CD/DVD）
6.  添加[WinXPE 插件](http://sourceforge.net/projects/winpe/files/Windows%20XPE/Windows%20XPE%20v1.0.7)。有一个小帮助文件，您需要删除一些其他默认插件才能正常工作（删除：A43 文件管理、启动组、Nu2Shell）您可以将 WinXPE 配置为具有密码保护
7.  添加 TrueCrypt 插件 ( `http://www.paraglidernc.com/plugins/plugins.htm`) 添加 TrueCrypt 文件 ( `http://www.truecrypt.org/downloads`)
8.  创建没有 iso 选项的 BartPe 编译文件夹，只有文件（需要几分钟）。
9.  下载[Microsoft Windows Server 2003 Service Pack 1（32 位）](http://www.microsoft.com/en-us/download/details.aspx?id=11435)
10.  解压 WindowsServer2003-KB889101-SP1-x86-ENU.exe（Winrar 可以）并解压两个文件`setupldr.bin and ramdisk.sy_`
11.  展开 ramdisk.sy_ ，并在 CMD 运行：

    `expand ramdisk.sy_ ramdisk.sys`

12.  转到您的 pebuilder 文件夹（通常`C:\pebuilder3110a`）并创建一个名为“srsp1”的子文件夹，不带引号。
13.  复制到`setupldr.bin`_`ramdisk.sys``C:\pebuilder3110a\srsp1`
14.  现在假设您的 USB 在 CMD 运行中得到了驱动器字母 H：

    `cd C:\pebuilder3110a`
    `pe2usb h:`

最后一步需要一分钟左右。此时，您在 Windows XP PE 中拥有一个可启动的 NTFS USB 驱动器，并带有密码保护。

启动后，启动 TrueCrypt 并创建一个加密卷驱动器，以使用 USB 驱动器上所有剩余的可用空间。您可以将有价值的数据放在这个 TrueCrypt 卷上。

但是，我希望在某个时候能够加密整个 USB 驱动器并使其可启动。目前，我无法使用 TrueCrypt 实现这一点，因为 BartPE 以只读媒体启动。

pe2usb ( `http://www.911cd.net/forums//index.php?showtopic=13784`) 的替代方法可以在没有 ISO 模式的情况下启动，但 TrueCrypt 无法加密 USB 驱动器，但它用 TrueCrypt 引导加载程序替换了 win 通用引导加载程序。

# javascript - 向 Uploadify 添加动态字段

> ID：11398478
> 
> 赞同：3
> 
> 时间：2012-07-09T15:40:59.450
> 
> 标签：javascript, jquery, uploadify

我只是想为标题添加一个简单的文本字段并将其发布到uploadify.php，但它不起作用。

Javascript：

```
$(function() {
    $("#file_upload").uploadify({
        'formData'      : {"title": $("#title").val()},
        'swf'           : '/uploadify/uploadify.swf',
        'uploader'      : '/uploadify/uploadify.php',
        'onUploadStart' : function(file) {
                $("#file_upload").uploadify("settings", "title");
        }
    });
}); 
```

HTML：

```
<input type="text" id="title" name="title" />
<input type="file" name="file_upload" id="file_upload" /> 
```

如果我用它替换`{"title": $("#title").val()}`它`{"title": "title"}`可以正常工作但它不是动态的，它只是设置为标题。我怎样才能让它传递实际的文本字段数据？我自己尝试了几件事，但 Uploadify 文档非常薄。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-09T16:21:01.413

[此处](http://www.uploadify.com/documentation/uploadify/formdata/ "这里")找到的 Uploadify 文档另有说明，但这似乎是通过 Uploadify 使用动态字段的正确方法。在任何情况下，它都有效。

```
$("#file_upload").uploadify({
        'swf'           : '/uploadify/uploadify.swf',
        'uploader'      : '/uploadify/uploadify.php',
        'onUploadStart' : function(file) {
                $("#file_upload").uploadify("settings", 'formData', {'title' : $("#title").val()});
        }
    });
}); 
```

编辑：不需要首先声明 formData，`$("#file_upload").uploadify()`所以我删除了它。如果您想使用它来设置默认值，也将其包含在其中。

# python - 芹菜或豆茎或两者兼而有之？

> ID：11398480
> 
> 赞同：6
> 
> 时间：2012-07-09T15:41:09.033
> 
> 标签：python, celery, task-queue, beanstalkd

我知道（但我不明白）Celery 可以使用 Beanstalk 作为传递机制。

来自[Beanstalkd 主页](http://kr.github.com/beanstalkd/)

“Beanstalk 是一个简单、快速的工作队列。”

来自[Celery 主页](http://celeryproject.org/)

“这是一个专注于实时处理的任务队列，同时也支持任务调度。”

这似乎和我很相似。那么，我为什么要选择芹菜而不是普通的豆茎呢？或者我为什么要选择豆茎而不是成熟的芹菜？

我想向我的 web 应用程序添加一个任务/工作队列，但我不确定该走哪条路。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T14:08:02.623

这是[Celery 邮件列表中的相关讨论](https://groups.google.com/d/topic/celery-users/CUkJkb34GUM/discussion)

# php - 格式化 HTML

> ID：11398482
> 
> 赞同：1
> 
> 时间：2012-07-09T15:41:18.750
> 
> 标签：php, wordpress, shortcode

我一直在尝试通过使用 PHP 中的标签短代码来让我的标签正常工作。

我的问题的第一部分是弄清楚如何在 PHP 文件中编写 PHP 代码和简码。[@jeremyharris](https://stackoverflow.com/users/724063/jeremyharris)在这里帮我解决了这个[问题](https://stackoverflow.com/questions/11397441/how-to-insert-php-between-shortcodes-for-tabs-tab)

```
ob_start();
get_template_part("includes/categories-panel");
$cats = ob_get_clean();
ob_start();
get_template_part('includes/home-map-panel');
$home = ob_get_clean();

echo do_shortcode('[tabs style="boxed"]
[tab title="First Tab"]' .$cats. '[/tab]
[tab title="Second Tab"]'. $home  .'[/tab]
[tab title="Third Tab"] Tab 3 Content here [/tab]
[tab title="Fourth Tab"] Tab 4 Content here [/tab]
[/tabs]'); 
```

第二个问题现在是如何让 HTML 在前端工作。这可能是某种 CSS 或 HTML 冲突，但选项卡不起作用。

插入第一个问题的代码后，我的 HTML 源代码如下所示[http://pastie.org/4226310](http://pastie.org/4226310)

我不确定为什么选项卡没有正确显示内容。相反，它们是垂直对齐的。我觉得它可能与第一个包含“类别面板”有关，因为当我删除它时效果更好......

我正在使用本地主机仅供参考。

谢谢你的帮助！

# iphone - 如何为精灵图像赋予波纹动作

> ID：11398483
> 
> 赞同：0
> 
> 时间：2012-07-09T15:41:19.837
> 
> 标签：iphone, ios, cocos2d-iphone

我正在使用这个 coe o 为我的图像显示波纹动作

```
 CCSprite * ghost = [CCSprite spriteWithFile:@"ghost.png"];
    [ghost setPosition:ccp(500,600)]; 

    CCRipple3D* ripple = [CCRipple3D actionWithPosition:ghost.position radius:ghost.contentSize.width  waves:4 amplitude:20 grid:ccg(40,40) duration:5.0];

    repeatt = [CCRepeatForever actionWithAction: ripple];
    [ghost runAction:repeatt ];

    [self addChild:ghost]; 
```

它为我的图像创建了涟漪动作，但我需要通过固定路径移动此图像..意味着，它需要通过 x 轴（0）移动到 x（500），然后在获得 x（500）后它需要开始从 x(0) repetdly.but 没有消除涟漪作用。

如何做到这一点提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:49:10.407

添加这两个方法，然后使用`[self runMyAction:sprite];`

```
- (void)moveActionComplete:(CCSprite*)sprite{
    sprite.position = ccp(0,600);
    [self runMyAction:sprite];
}

- (void)runMyAction:(CCSprite*)sprite{
    CCMoveTo *moveAction = [CCMoveTo actionWithDuration:30 position:ccp(500, 600)];
    CCCallFuncN *callbcak = [CCCallFuncN actionWithTarget:self selector:@selector(moveActionComplete:)];
    CCSequence *action = [CCSequence actions:moveAction, callbcak, nil];
    [sprite runAction:action];
} 
```

此外，您的涟漪持续时间非常慢，这就是为什么它似乎不起作用的原因。增加您的移动持续时间，然后您将看到它何时缓慢移动并且可以看到涟漪效果。
**玩时长**

# java - 如何序列化/反序列化 arrayList(Object)

> ID：11398485
> 
> 赞同：14
> 
> 时间：2012-07-09T15:41:21.183
> 
> 标签：java, android, serialization, deserialization

我有一个`ArrayList<ItemList>`

其中 ItemList 是：

```
public class ItemList {
    public ArrayList<Item> it = new ArrayList<Item>();
    public String name = "";

    public ItemList() {
    }
} 
```

和项目是：

```
public class Item {
    public String name = "";
    public int count = 0;

    public Item() {
    }
} 
```

我尝试序列化这个列表：

```
try {
            FileOutputStream fileOut = new FileOutputStream(sdDir + serFile);
            ObjectOutputStream out = new ObjectOutputStream(fileOut);
            out.writeObject(List_Of_Lists);
            out.close();
            fileOut.close();

        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } 
```

我认为这是有效的，因为我在文件夹中找到了这个文件。

但我不能从文件反序列化到`ArrayList<ItemList>`

代码：

```
 try {
            FileInputStream fileIn = new FileInputStream(sdDir + serFile);
            ObjectInputStream in = new ObjectInputStream(fileIn);
            List_Of_Lists = (ArrayList<ItemList>) in.readObject(); 
            Log.i("palval", "dir.exists()");
            in.close();
            fileIn.close();
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } 
```

我如何反序列化这个`ArrayList<ItemList>`？我总是抓住 IOException。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-09T15:53:09.963

你`Item`和`ItemList`班级需要`implements Serializable`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-20T21:11:10.410

如果您已创建子类，则将 serializabe 方法添加到父类它将消除错误。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-09T15:47:39.693

我假设您已经序列化了 ItemList 而不是 Item .....

```
ArrayList<ItemList> arr = (ArrayList<ItemList>) in.readObject();

for (ItemList a : arr) 
   {
        // In this loop by iterating arr, you will get the whole List of ItemList

   } 
```

# compiler-construction - 使用 sm_21 编译时出现 CUDA 4.2 nvcc (cicc) 错误

> ID：11398486
> 
> 赞同：0
> 
> 时间：2012-07-09T15:41:30.900
> 
> 标签：compiler-construction, cuda, nvcc

我有一个奇怪的问题！我有一张 GTX 560 Ti 卡（计算能力 2.1），用于开发我的 CUDA 应用程序。

现在经过几百次编译，我得到了一个错误。也就是说，编译阶段停止，而 cicc 进程并未终止。但是当我更改每个块号的线程数时，它有时可能会编译。（对于 64 个线程，它会在 1024 个线程中崩溃）。

有没有人有这么奇怪的错误。另一件事是，使用 sm_13 每次都会编译，但使用 -arch=sm_21 则不会。但正如我所说，它使用这个选项运行了数百次，但现在它不再工作了。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T17:24:08.993

哈哈！

这里又跑了！

注释所有内容（全局函数）-> 然后编译-> 再次取消注释-> 编译之前什么都没有发生！！！

如此奇怪的行为！也许一些实习生编译器标志被设置为假，或者其他什么。

# lotus-notes - Domino 设计器 - 错误 501

> ID：11398487
> 
> 赞同：0
> 
> 时间：2012-07-09T15:41:30.933
> 
> 标签：lotus-notes, lotus-domino

我在 Domino Designer 中运行 Domino 应用程序，当我尝试通过 url 登录时：

```
http://localhost/net/test118/test.nsf/loginform?openform 
```

并单击确定，URL 重定向到 [http://localhost/names.nsf?Login]，我收到 501 错误：

```
HTTP Web Server: Function Not Implemented Exception 
```

任何想法，我怎样才能成功登录？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T16:46:10.310

在 localhost 上预览时不能使用身份验证。

相反，如果不能在服务器上进行测试，您可以在 localhost 上设置 Domino 服务器。

# java - 带有进度条示例 PlayFramework 2 的长时间运行过程

> ID：11398495
> 
> 赞同：22
> 
> 时间：2012-07-09T15:42:04.890
> 
> 标签：java, playframework-2.0, akka

我正在尝试实现一个长时间运行的后台进程，该进程在用户访问页面时产生。我想显示任务的进度，就像在这个例子中一样：http: [//web.archive.org/web/20130122091205/http ://www.lunatech-research.com/archives/2011/10/31/进度条-jqueryui-websockets-playframework](http://web.archive.org/web/20130122091205/http://www.lunatech-research.com/archives/2011/10/31/progressbar-jqueryui-websockets-playframework)

有谁知道 PlayFramework 2.0 的教程（使用内置的 AKKA）？这个是1.2的

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-07-17T14:42:09.053

在阅读了 Java 的所有 Akka 文档[http://doc.akka.io/docs/akka/2.0.1/intro/getting-started-first-java.html](http://doc.akka.io/docs/akka/2.0.1/intro/getting-started-first-java.html)之后，我想出了这个似乎运作良好的方法。

系统首先创建一个唯一的 Actor 来处理“报告”（当加载生成页面时）。这个actor生成一个子actor，它会向父actor报告它的进度。然后通过 JavaScript 轮询父 Actor 以获取子线程的状态。

一旦孩子完成，它就会终止，一旦父母检测到孩子完成，它就会自行终止。

以下是所有代码，如果我以错误的方式进行此操作，请随时将我撕裂！（可以将状态存储在 Actors 中吗？！？）

控制器代码：

```
public class Application extends Controller {

public static Result generateReport()
{
    //create akka job

    //we should really create the actor with UUID name so that someone can't guess
    //and use the API to view the status of other peoples jobs, it be fairly easy
    //to guess as it goes $a,$b,$c etc...
   ActorRef myActor = Akka.system().actorOf(new Props(MyGeneratorMaster.class));

   System.out.println( myActor.path());
    myActor.tell(new ConfigMessage("blarg message"));

    return ok(generating.render("blarg","title",myActor.path().name()));
}

public static Result status(String uuid)
{
    uuid =  "akka://application/user/"+uuid;
    ActorRef myActor = Akka.system().actorFor(uuid);

    if(myActor.isTerminated())
    {
               return ok("Report Generated - All Actors Terminated") ;
    }
    else
    {

        return async(
                Akka.asPromise(ask(myActor,new StatusMessage(), 3000)).map(
                        new F.Function<Object,Result>() {
                            public Result apply(Object response) {

                                if(response instanceof ResultMessage)
                                {
                                    return ok(((ResultMessage) response).getResult());
                                }
                                return ok(response.toString());
                            }
                        }
                )
        );

    }
} 
```

主要演员：

```
public class MyGeneratorMaster extends UntypedActor {

    private int completed = 0;

    @Override
    public void postStop() {
        super.postStop();   
        System.out.println("Master Killed");
    }

    @Override
    public void onReceive(Object message) throws Exception {
        if (message instanceof actors.messages.ConfigMessage) {
            ConfigMessage config = (ConfigMessage) message;

            System.out.println("Received Config:" + config.getConfig());

            //Need to spawn child actor here..
            ActorRef child = this.getContext().actorOf(new Props(MyGeneratorChildWorker.class));

            //make the child thread do stuff
            child.tell(new ConfigMessage("doSomething!"));

            child.tell(akka.actor.PoisonPill.getInstance());//kill the child after the work is complete...

        } else if (message instanceof StatusUpdate) {
            System.out.println("Got Status Update");
            completed = ((StatusUpdate) message).getProgress();
        } else if (message instanceof StatusMessage) {
            System.out.println("Got Status Message");
            getSender().tell(new ResultMessage("Status: " + completed + "%"), getSelf());

            if(completed == 100)
            {
                //kill this actor, we're done!
                //could also call stop...
                this.getSelf().tell(akka.actor.PoisonPill.getInstance());
            }
        } else {
            System.out.println("unhandled message"+message.toString());
            unhandled(message);
        }

    }
} 
```

儿童演员：

```
public class MyGeneratorChildWorker extends UntypedActor {

    @Override
    public void postStop() {
        super.postStop();    
        System.out.println("Child Killed");
    }

    @Override
    public void onReceive(Object message) throws Exception {

        if (message instanceof ConfigMessage) {

            System.out.println("Created Child Worker");

            System.out.println("Doing Work:");
            try {

                for (int i = 0; i <= 100; i++) {

                    //update parent
                    this.context().parent().tell(new StatusUpdate(i));
                    long j = 1;
                     //waste loads of cpu cycles
                    while (j < 1E8) {
                        j = j + 1;
                    }
                }
            } catch (Exception ex) {

            }
            System.out.println("Done Work:");

        } else
            unhandled(message);
    }
} 
```

带有长轮询 JavaScript 的视图页面：

```
@(message: String)(title: String)(id: String)@main(title) {

<h2>@message</h2>

        <script type="text/javascript">

            function getPercentage()
            {

                $.ajax({
                    type: "GET",
                    url: "/status/@id",
                    dataType: "html",
                    success: function(html)
                        {
                        $('#status').html(html);

                        }
                });

            }

            $(document).ready(function() {

            setInterval("getPercentage()",100);
            });

        </script>

        <div id="status">

        </div>

} 
```

# iphone - 如何在 iOS 应用程序中使用特定的 Google Maps 地图？

> ID：11398496
> 
> 赞同：0
> 
> 时间：2012-07-09T15:42:07.937
> 
> 标签：iphone, ios, xcode, google-maps

我正在为 iOS 制作一个带有 MapView 的应用程序。我希望它在我的应用程序中添加[http://maps.fon.com/mapContent?lt=50.50388700000001&ln=4.469935999999928&zm=6的所有内容。](http://maps.fon.com/mapContent?lt=50.50388700000001&ln=4.469935999999928&zm=6)

这是我的 .h 文件的基础

```
@interface TDW_BFSecondViewController : UIViewController {

    MKMapView *mapview;

}

@property (nonatomic, retain) IBOutlet MKMapView *mapview; 
```

我不知道最好的方法是什么？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:23:41.060

You can find where you want in a my maps area of google maps and then specify that area through a UIWebview.

Hope that helps

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:44:11.753

如果您正在使用界面构建器或故事构建器，请将其拖到 Web 视图上，或者只需将其声明为您在地图视图中所拥有的。你也可以放：

```
[webview loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://maps.fon.com/mapContent?lt=50.50388700000001&ln=4.469935999999928&zm=6"]]]; 
```

该代码显示了带有您之前提到的 URL 的 Web 视图。

我希望这会有所帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T16:05:24.840

如果您需要此页面的精确副本，您可以显示此地图的 web 视图。

但是，如果您想使用 mapkit（谷歌地图原生 IOS），您应该为每个点手动添加一个自定义注释......

# facebook-like - 如何将 Like 按钮添加到在 DotNetNuke CMS 上运行的网站？

> ID：11398505
> 
> 赞同：0
> 
> 时间：2012-07-09T15:42:44.520
> 
> 标签：facebook-like, dotnetnuke

我们最近重新设计了我们的网站[http://www.lryc.ie](http://www.lryc.ie)，它现在运行在 DotNetNuke CMS 系统上。我想添加一个 Like 按钮，但我不能使用[http://developers.facebook.com/docs/reference/plugins/like/](http://developers.facebook.com/docs/reference/plugins/like/)上描述的方法，因为它不适用于 DotNetNuke。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T07:03:51.313

您可以将小部件用于类似按钮。我希望这个链接可以帮助你：[http ://dnnwidgets.com/Widgets/Facebook](http://dnnwidgets.com/Widgets/Facebook)

# c++ - const void * 比 void * 提供什么价值？

> ID：11398509
> 
> 赞同：7
> 
> 时间：2012-07-09T15:42:58.653
> 
> 标签：c++, constants, void-pointers, reinterpret-cast, const-cast

在 C++ 中，将 a`const void *`用于函数的参数类型是否有任何价值`void *`？由于 a`void *`是不透明的，除了用户这样做之外，是否存在任何修改风险`reinterpret_cast`，在这种情况下，他们也可以`const_cast`在 a 上做同样的事情`const void *`，因此人们真的会买任何东西吗？我问是因为我使用了一个用于共享指针的实用程序模板类，它提供了一个专门化`void`以避免`void &`问题，但没有提供专门化`const void`，因此我想知道这只是一个疏忽还是永远不需要它？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-09T15:46:24.293

它提供了与其他指针类型相同的好处：除非您明确放弃 -ness `const`，否则您无法修改指向的内容。`const`在接口中，`const void*`是客户端代码的标志，表明您传入的任何内容都可以读取但不能写入。例如，`std::memcpy`声明为

```
void *memcpy(void *dest, const void *src, std::size_t count); 
```

这表明它将读取`src`和写入`dest`. 当然，如果它真的是用 C++ 实现的（可能但不太可能），它必须将两个指针都转换为其他类型。

如果你觉得这个“没有给你买任何东西”，那么显然是`const`关键字*本身*没有任何价值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-09T15:47:06.767

`memcpy`接受两个指针参数，一个`void*`和另一个`const void*`。第二个参数可以从`const char*`（或其他指向常量对象类型的指针）参数隐式转换，而第一个参数不能。

没有隐式转换就是价值——它迫使用户在他们想要的（不太可能的）事件中故意丢弃 const，而不是意外丢弃它。

然后在 的实现`memcpy`或类似函数中，程序员必须在尝试修改其引用之前`const_cast`对参数进行或 C 风格的转换。`const void*`他们将能够对`static_cast`非常量参数并修改其引用。你需要写的那种演员*希望能*告诉你一些关于你正在做的事情是否明智的事情。

我认为，如果您的 shared_ptr 辅助函数需要`void`特别对待，那么他们将需要特别对待所有 cv 限定`void`。所以这是四种情况：`void`, `const void`, `volatile void`, `const volatile void`。但是，如果这些功能的用户过去曾在 a 上尝试过`shared_ptr<void>`，并抱怨它不起作用，但从未在 a 上尝试过`shared_ptr<const void>`，则可能没有出现问题。

也许`shared_ptr<void>`已经足够不寻常了，以至于它还没有出现。也许使用 a 的人`shared_ptr<void>`往往不介意抛弃 cv-qualifiers，因为每当有人最终恢复正确的类型时，他们也会恢复正确的限定符。

想一想 - 确实`shared_ptr<const void>`有效，或者`shared_ptr`调用删除器的代码是否需要从`T*`to隐式转换`void*`？我不记得我是否曾经使用过`shared_ptr<const T>`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-09T15:46:51.853

不要忘记`const`. 即使有人总是可以将它扔掉，但它的`const`作用是表明不应通过指针更改所指向的事物的原始意图。 `const_cast`（`reinterpret_cast`就此而言）应始终谨慎使用，并应在必要时让程序员暂停。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-09T15:48:19.267

嗯，是的，有（一些）相同的优点`const`总是有：它*记录*了内容不应该被改变的事实。

想象一下下面的代码：

```
int const object = some_value();
some_function(&object); 
```

此调用仅在函数参数声明为 时编译`void const*`，否则客户端将需要 a`const_cast`来抛弃 constness。当然，我们既不希望客户有这种不便，也不希望他们对他们的数据撒谎（通过抛弃 constness）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-09T15:48:38.383

“自我记录”代码仍然有好处。

```
store_pod(const void* data, std::size_t bytes); 
```

没有任何注释可以让您看到指向的数据不会被修改。

另外，请注意，要打破这个`const`承诺，函数需要同时执行 a`const_cast`和 a `reinterpret_cast`。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-09T15:51:07.807

与它的所有用途一样，`const`它有两个目的。在函数的实现上，它将帮助编译器检测误用，正如您所提到的，可以通过`const_cast`（或 C 风格的强制转换）强制和消除误用。

但是`const`还有第二个目的，它提供了对象不会被修改的承诺，并且这样做使用户能够将指针传递给 const 对象（假设您会遵守承诺），从而有效地更广泛地使用您的函数。通过这个简单的示例可以看出这一点：

```
void foo( const void* );
void bar( void* );
int main() {
    const int value = 10;
    foo( &value );          // correct, the function promises not to modify the value
    //bar( &value );        // error, this would break const correctness
} 
```

# eclipse - Eclipse，getRealPath() 的问题

> ID：11398513
> 
> 赞同：4
> 
> 时间：2012-07-09T15:43:28.163
> 
> 标签：eclipse, servlets, path, lucene, indexing

我正在使用 Lucene 索引 PDF 文档，我使用 Eclipse indigo 作为 IDE 和 tomcat7 作为 servlet 容器，问题是当我索引文档并希望保存原始文档以供以后下载时，但是 eclipse 将文档放在临时目录中而不是我选择的目录。
这就是我正在做的事情。

我的 web.xml 中有这个参数

```
 <context-param>
    <description>Location to store uploaded file also the location of files to be indexed</description>
    <param-name>file-upload</param-name>
    <param-value>
    folder\
 </param-value>
</context-param> 
```

然后像这样在 servlet init() 方法中调用它

```
filePath = getServletContext().getRealPath("") + File.separator + getServletContext().getInitParameter("file-upload"); 
```

简而言之，我试图将文档存储在名为“搜索”的项目中名为“文件夹”的目录中，但 Eclipse 会将其存储在临时位置，如下所示：

```
C:\Users\Solid\Dropbox\workspace\.metadata\.plugins\org.eclipse.wst.server.core\tmp0\wtpwebapps\Search\folder\ir_overview.pdf 
```

但实际路径是这样的：

```
C:\Users\Solid\Dropbox\workspace\Search\WebContent\folder 
```

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T15:52:38.767

Eclipse 将项目部署到项目工作区之外的工作目录。

默认情况下，Eclipse 使用`/workspace/.metadata\.plugins\org.eclipse.wst.server.core\tmp0\wtpwebapps` 路径来部署 Web 应用程序。

它必须将 Eclipse Workspace 期望的目录结构中的文件重新组织成 Web 应用程序期望的格式。

单击 > 服务器选项卡。右键单击 Servlet 容器（在您的情况下为 Tomcat 7）并打开（F3 是 eclipse 的快捷方式）。

您应该能够看到服务器路径选项，其中包含

> 指定服务器路径（即 catalina.base）和部署路径。

您可以在此处指定部署位置。

注意：必须在不存在任何模块的情况下发布服务器才能进行更改。

因此，取消部署您的 Web 应用程序并更改位置。

编辑：

与问题无关：您应该在 webContent / webapp 之外创建单独的目录来存储`Lucene`索引。当您将应用程序部署到 Tomcat 生产环境时，这种做法会很有用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-27T12:48:36.957

如果您在打开服务器配置页面时发现修改字段被禁用，只需关闭您的服务器并通过右键单击服务器 > 添加删除 > 删除所有应用程序删除所有应用程序，然后再次右键单击 > 然后清理。它将取消部署当前服务器上的所有应用程序，并允许您修改服务器设置。

# javascript - Javascript中的时间延迟

> ID：11398515
> 
> 赞同：0
> 
> 时间：2012-07-09T15:43:29.403
> 
> 标签：javascript

函数 PS.Tick() 每 100 毫秒调用一次，它的工作是调用 NPC 的 AI 函数，以便它们可以移动：

```
PS.Tick = function ()
{
"use strict";
for (NPCid = 0; NPCid < NPCnumber; NPCid++)
{
    NPCAI(NPCid);
};
}; 
```

但我希望 NPC 不会每 100 毫秒同时移动一次，而是以自己的频率移动，所以我尝试了以下代码：

```
PS.Tick = function ()
{
"use strict";
for (NPCid = 0; NPCid < NPCnumber; NPCid++)
{
    var timeout = 0;
    timeout = PS.Random (1000);
    setTimeout("NPCAI(NPCid)",timeout);
};
}; 
```

现在，他们根本不动。为什么？如何让它们以不同的时间间隔移动？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:46:40.523

做那个

```
for (NPCid = 0; NPCid < NPCnumber; NPCid++) {
    var timeout = 0;
    timeout = PS.Random (1000);
    (function (id) {
        setTimeout(function(){NPCAI(id)},timeout);
    })(NPCid); }; 
```

需要这个额外的函数来捕获闭包中的 ID。没有它，每个实例只会传递循环的最后一个 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T15:50:38.933

> 现在，他们根本不动。为什么？

几个可能的原因：

*   如果`NPCid`未在任何地方声明：您的代码正在抛出`ReferenceError`.

*   如果`NPCid`在某处声明但它不是全局的：当您将字符串传递给 时`setTimeout`，它不会在当前执行上下文中被评估并且无权访问`NPCid`. 一般来说，不要将字符串传递到`setTimeout`.

*   if`NPCid`是全局的：当延迟的代码被执行时，他们都会看到相同的值 for `NPCid`，这是它在循环**结束时的值。**

相反：如果您在 NodeJS 上执行此操作（我只是从您正在执行的操作中推断出这一点），您可以执行此操作）：

```
PS.Tick = function ()
{
    "use strict";

    // (I'm assuming NPCid is defined somewhere; if not, add `var NPCid;` here)

    for (NPCid = 0; NPCid < NPCnumber; NPCid++)
    {
        var timeout = 0;
        timeout = PS.Random (1000);
        setTimeout(NPCAI, timeout, NPCid); // NodeJS (and Firefox) ONLY!!
    }
}; 
```

之所以有效，是因为在 NodeJS（和 Firefox）上，`setTimeout`可以接受参数以传递给要调用的函数。

如果你没有使用 NodeJS 或 Firefox，但你确实可以访问 ES5 [`Function#bind`](http://ecma-international.org/ecma-262/5.1/#sec-15.3.4.5)，你可以这样做：

```
PS.Tick = function ()
{
    "use strict";

    // (I'm assuming NPCid is defined somewhere; if not, add `var NPCid;` here)

    for (NPCid = 0; NPCid < NPCnumber; NPCid++)
    {
        var timeout = 0;
        timeout = PS.Random (1000);
        setTimeout(NPCAI.bind(undefined, NPCid), timeout);
    }
}; 
```

`Function#bind`返回一个函数，该函数在调用时将调用具有特定`this`值和您给它的参数的原始函数。

如果没有，您可以编写自己的`bind`，或者这样做：

```
PS.Tick = function ()
{
    "use strict";

    // (I'm assuming NPCid is defined somewhere; if not, add `var NPCid;` here)

    for (NPCid = 0; NPCid < NPCnumber; NPCid++)
    {
        var timeout = 0;
        timeout = PS.Random (1000);
        setTimeout(makeHandler(NPCid), timeout);
    }

    function makeHandler(id) {
        return function() {
            NPCAI(id);
        };
    }
}; 
```

这通过创建一个函数来工作，该函数在被调用时会转过来并使用我们传递给它的值调用 NPCAI。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-09T15:48:49.387

您的 setTimeout 不调用任何函数，

试试这个：

```
setTimeout(function(){ NPCAI(NPCid); }, timeout); 
```

或者更好地为每个 NPC 单独使用设置间隔，但是使用大量超时和间隔非常低效，因此请注意并准备好延迟。

# ruby-on-rails-3 - 将额外数据添加到 simple_form 输入

> ID：11398516
> 
> 赞同：5
> 
> 时间：2012-07-09T15:43:42.493
> 
> 标签：ruby-on-rails-3, simple-form

我正在使用 simple_form gem。

我正在根据集合（我的所有列表`actiontypes`）呈现输入

```
<%= f.association :actiontype, collection: Actiontype.all, input_html: { data: {'impacts-pnl' => ??}} %> 
```

我希望能够向输入添加数据属性以存储额外数据。

在这种情况下，我想存储`impacts_pnl`我的`actiontype`. 唯一的问题是我不知道如何引用当前`actiontype`

`collection.impacts_pnl`不起作用（显然）

`actiontype.impacts_pnl`两者都不。

如何将这些额外的数据传递给我的输入？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-10T12:41:34.013

如果您想将这些属性添加到选择字段的选项元素中，您应该使用例如 .map() 函数来更改集合。另外，使用带有块的输入助手来执行此操作，否则它不起作用；

```
= f.input :actiontype do
    = f.select :actiontype, Actiontype.all.map{|a| [a.name, a.id, {"data-impacts-pnl" => p.impacts_pnl}]} 
```

有关此问题的更多信息，请参阅[https://github.com/plataformatec/simple_form/issues/188](https://github.com/plataformatec/simple_form/issues/188)

# signalr - SignalR 客户端未重新连接

> ID：11398517
> 
> 赞同：1
> 
> 时间：2012-07-09T15:43:43.047
> 
> 标签：signalr

SignalR 遇到问题/缺乏知识，我有一个集线器客户端/服务器和一个单独的 GUI 应用程序，它会间歇性地连接到集线器并发送消息。我要么需要保持连接，要么需要在发送消息后断开连接。

我遇到的问题是它总是会发送第一条消息，但随后会卡住发送第二条消息。我不确定这是为什么。

```
 public void SignalR_Connect(string message)
    {
        var connection = new HubConnection("http://site/signalr");
        IHubProxy myHub = connection.CreateProxy("chat");

        Console.WriteLine("Connection state is : " + connection.State.ToString());

            connection.Start().ContinueWith(task =>
            {
                Console.WriteLine("Attempting to Connect");
                if (task.IsFaulted)
                {
                    Console.WriteLine("There was an error opening the connection:{0}", task.Exception.GetBaseException());
                }
                else
                {

                    Console.WriteLine("Client Connected");
                }
            }).Wait();

           //Sending message
            myHub.Invoke("Send", message).ContinueWith(task =>
            {
                if (task.IsFaulted)
                {
                    Console.WriteLine("There was an error calling send: {0}", task.Exception.GetBaseException());
                    Console.WriteLine(task.Status.ToString());
                }
                else
                {
                    Console.WriteLine("Send Complete.");          
                }
            }).Wait();

        //Back round to get the next message.
        //Method grabs next message in the MSMQ and sends it to SignalR_Connect method.
        Read_Queue();
    } 
```

我已经尝试过 connection.stop() ，在集线器上实现一个 close 方法来通知服务器客户端离开并设置 GlobalHost.Configuration.ConnectionTimeout 但我仍然得到相同的行为。

# jquery - 来自同一页面的两个 JSESSIONID（Java、Servlet、Jersey、Ajax jQuery）

> ID：11398518
> 
> 赞同：0
> 
> 时间：2012-07-09T15:43:47.063
> 
> 标签：jquery, ajax, session, struts2, jersey

我正在开发一个三层应用程序，其中包含暴露底层业务方法的 Web 服务。Web 服务是用 Jersey 以 RESTful 风格实现的，并且该层由实现*com.sun.jersey.spi.container.ResourceFilterFactory*的过滤器保护：在这个过滤器中，我实现了我的自定义授权机制。所有这些都打包在一个我称之为*backend*的 Web 应用程序中。我知道你们中的很多人会批评这一点，因为 Web 服务本质上是无状态的，但我们说的是银行环境，一切都必须经过检查和授权。所以请原谅我:-P

然后我有另一个不同的应用程序（客户端）向后端发出异步请求，所有这些请求都必须由后端本身预先授权。

该客户端以两种方式发出请求：

*   第一个是通过 Struts 2 在一个动作中（登录）
*   第二种方式是通过 jQuery ajax（通用数据检索）

这种情况下的问题是，当通过 Struts2 进行第一次调用（登录）时，后端会打开一个会话，否则当所有 jQuery ajax 调用都进行时，后端会打开另一个会话。结果是所有 jQuery ajax 调用都未授权，因为身份验证是在两个不同的会话中进行的。考虑到呼叫来自同一个客户端，我想要实现的是对所有类型的呼叫使用相同的会话。

任何想法 ？

-

亚历克斯

# javascript - 使用循环创建一个 div

> ID：11398522
> 
> 赞同：4
> 
> 时间：2012-07-09T15:44:04.007
> 
> 标签：javascript, jquery

我像这样创建一个 div 和它的 css id。

```
<div id="r1" class="ansbox"></div>
<div id="r2" class="ansbox"></div>
<div id="r3" class="ansbox"></div>
<div id="r4" class="ansbox"></div>
<div id="r5" class="ansbox"></div>
<div id="r6" class="ansbox"></div>
<div id="r7" class="ansbox"></div>
<div id="r8" class="ansbox"></div>
<div id="r9" class="ansbox"></div>
<div id="r10" class="ansbox"></div> 
```

有没有办法使用循环语句创建这个 div。谁帮帮我。。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-09T15:50:22.870

我建议使用一些 javascript（不带 jquery）来提高性能：

```
var toAdd = document.createDocumentFragment();
for(var i=0; i < 11; i++){
   var newDiv = document.createElement('div');
   newDiv.id = 'r'+i;
   newDiv.className = 'ansbox';
   toAdd.appendChild(newDiv);
}

document.appendChild(toAdd); 
```

这样你只做一个`append()`，只有 1 个回流，你不需要 jQuery。

要将其附加到 jQuery 选择器：

```
$('sel').append(toAdd); 
```

或者一个dom元素：

```
document.getElementById('sel').appendChild(toAdd); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-09T15:45:24.257

假设您有以下`div`将插入新`div`s 的位置：

```
<div id="target">
   <!-- all divs will append here -->
</div> 
```

**jQuery：**

```
for(var i =1; i<= 10; i++){
  $('#target').append($('<div/>', { id: 'r' + i, 'class' : 'ansbox'}))
} 
```

或者

```
for(var i =1; i<= 10; i++){
  $('#target').append('<div id="r'+ i +'" class="ansbox"></div>')
} 
```

我将采用第一种方法。

**相关参考：**

*   [`.append()`](http://api.jquery.com/append)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-09T15:46:44.777

这是一个选项：

```
for(var i = 0; i <=10; i++) {
   $('<div id="r'+i+'" class="ansbox"></div>').appendTo("target");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-18T13:57:29.967

```
<div class="ibox-content" id="location-div">                        
    <div class="row">
        <div class="col-sm-12">
            <button id="addlocation" type="button" class="btn btn-w-m btn-primary pull-right">Add new location</button>
        </div>
    </div>
    <div class="row" style="margin-top:10px;">
        <div class="col-sm-2">
            <label class="form-label">Location <span ><input type="text" readonly id="locval" style="width:20px;border:0px;" value="1"></span></label>
        </div>
        <div class="col-sm-10">
            <input type="text" name="" class="form-control "> 
        </div>
    </div>

</div> 
```

在这里，我想通过向每个新条目添加 1 来添加动态行，这将解决您的问题

```
<script>
    $(document).ready(function(){
        var inno = document.getElementById("locval").value;
        for(var start = 1; inno >= start; start+=1)
        {
            start;
        }
    $("#addlocation").click(function(){
        $("#location-div").append('<div class="row" style="margin-top:10px;"><div class="col-sm-2"><label class="form-label">Location <span ><input type="text" readonly id="locval" style="width:20px;border:0px" value="'+start+++'"></span> </label></div><div class="col-sm-10"><input type="text" name="" class="form-control "></div></div>');
      });
    });
</script> 
```

# java - 不同实体管理器之间的 JPA 实体共享

> ID：11398527
> 
> 赞同：1
> 
> 时间：2012-07-09T15:44:14.583
> 
> 标签：java, jpa, eclipselink

*   根据 JPA 2.0 规范是否允许**在两个不同的实体管理器之间共享一个实体**，例如以下列方式：

    ```
    A entityA = em1.find(entityA.class,1L);
    B entityB = new entityB();
    b.setA(entityA); //entityB refers to entityA via @ManyToOne reference, cascade=CascadeType.PERSIST is enabled
    em2.persist(entityB);
    em2.flush(); 
    ```

*   `em1.detach(entityA);`如果在第一行和第二行之间插入行，答案会改变吗？（或者换句话说：是否允许在不同的实体管理器之间**共享分离的实体）**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:20:10.540

*   不，不允许单个实体*由*多个`EntityManager`s管理
*   是的，如果您有一个*分离*的实体，则可以让它由另一个*管理*`EntityManager`，例如，使用`merge()`

但是，在您的情况下`EntityManager`应该抛出异常，因为它不允许`persist()`（在您的情况下，通过级联）应用于分离的实体。您应该删除级联选项或使用`merge()`而不是`persist()`.

而且，如果您删除级联，我认为即使没有 . 也可以运行此代码`detach()`，因为在这种情况下`entityA`不会由`em2`.

# f# - 是否有任何工具可以帮助将 F# 移植到 OCaml？

> ID：11398528
> 
> 赞同：4
> 
> 时间：2012-07-09T15:44:18.063
> 
> 标签：f#, real-time, ocaml, llvm, porting

不幸的是，由于 .NET 缺乏增量 GC（在 MS 或 Mono 实现中），使用 F# 构建诸如游戏之类的软实时软件是有问题的。我用 F# 编写了一种语言，如果 -

a）面对分代 GC（交互式模拟期间的任意暂停），它没有充分发挥作用，并且 b）OCaml 获得了到 LLVM 后端的良好完整端口 -

我会将它从 F# 移植到 OCaml。我尽可能多地避免使用特定于 .NET 的库，并且由于 F# 的语法基于 OCaml，我假设应该有一些自动化工具来帮助转换代码。

任何人都知道这样的事情，已经完成或正在进行中？

深深感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-09T16:25:21.187

在答案中回答您的问题 - 据我所知，没有这样的工具，我认为不太可能有人会创建它们。

尽管 F# 受到 OCaml 的启发，但它已经发展了很多并且在很多方面都不同（参见[这个 SO 讨论](https://stackoverflow.com/questions/179492/f-changes-to-ocaml)），因此自动转换并非易事。即使有人这样做，它更像是编译到难以阅读的 OCaml，而不是转换为您以后可以继续工作的惯用代码。

添加一些一般性评论，当您谈到“实时”时，我想象在处理危险物品或飞机控制的工厂中控制一些机器人。在这些领域，对 GC 的担忧当然是有道理的。但是，我认为游戏不一定是“实时的”。您需要良好的性能，这是肯定的，但人们一直非常高兴地使用 .NET 和 F# 编写游戏。有关一些 F# 示例，请参阅：

*   ... 一个不错的[博客，包含几个游戏示例](http://sharp-gamedev.blogspot.co.uk/)（您实际上可以尝试和购买）
*   一款看起来也相当逼真的[3D 飞机射击游戏](http://fwaris.wordpress.com/2012/04/05/3d-xna-game-in-f/)
*   还有一[本用游戏解释F#的书](https://rads.stackoverflow.com/amzn/click/com/B005HHYIWC)

这些可能比您的目标更简单，但它可能足以表明使用 GC 编写游戏是可行的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-09T22:48:37.270

> 不幸的是，由于 .NET 缺乏增量 GC（在 MS 或 Mono 实现中），使用 F# 构建诸如游戏之类的软实时软件是有问题的。

这里有几点：

*   增量 GC 并不是获得低暂停时间的唯一方法。像 VCGC 这样的并发 GC 批量完成工作，但在运行 mutators 的同时进行，例​​如，我在[此处](http://fsharpnews.blogspot.co.uk/2012/02/very-concurrent-garbage-collector.html)的非免费文章中描述的 VCGC 实现以亚毫秒级的暂停时间运行。

*   增量 GC 并不一定意味着低暂停时间。例如，OCaml 的 GC 通常会产生 10ms 的暂停，并且在遇到深线程堆栈或堆中的长数组时会产生任意长的暂停。

我在 .NET 3 上用 OCaml 测量了 10 毫秒的典型暂停时间，用 F# 测量了 30 毫秒。通过一个简单的实现，我能够从头开始在 F# 中构建一个容错服务器，它可以处理 20k msgs/s 和 50% 的延迟时间低于 114us 和95% 低于 500us。

> 我用 F# 编写了一种语言，如果 -
> 
> a) 面对分代 GC（交互式模拟期间的任意停顿，以及

我不会放弃这个平台，因为你的第一个工作版本有不可接受的延迟。您可以做很多事情来降低最大延迟。

> b) OCaml 获得了到 LLVM 后端的良好完整端口 -

我严重怀疑 OCaml 是否会得到我认为的“到 LLVM 后端的良好完整端口”。他们只会使用当前的无类型 IR 重新定位 LLVM，并且它不会比当前的`ocamlopt`编译器做得更好，因为 LLVM 并非旨在优化这种工作负载。

> 我会将它从 F# 移植到 OCaml。我尽可能多地避免使用特定于 .NET 的库，并且由于 F# 的语法基于 OCaml，我假设应该有一些自动化工具来帮助转换代码。

没有自动化工具，但我现在在 OCaml 和 F# 之间移植了数十万行代码，这通常非常容易，因为大多数代码都是用两种语言的核心 ML 子集编写的。

# java - 带有外部 jar 的 Java 构建文件

> ID：11398530
> 
> 赞同：1
> 
> 时间：2012-07-09T15:44:21.370
> 
> 标签：java, windows, ant, command-line, jar

我已经尝试并再次尝试为我的项目大纲开发一个 Ant Buildfile：

[使用外部 jar 文件从 Windows 命令行运行 Java 时出现 NoClassDefFoundError](https://stackoverflow.com/questions/11397952/noclassdeffounderror-when-running-java-from-windows-command-line-with-external-j)

这是我尝试运行的构建文件：

 `````
<project>

    <target name="clean">
        <delete dir="build" />
    </target>

    <path id="jarpath">
        <fileset dir="C:\JAR">
            <include name="**" />
        </fileset>
    </path>

    <target name="compile">
        <mkdir dir="build/classes" />
        <javac srcdir="." destdir="build/classes" includeantruntime="false">
            <classpath id="jarpath" />
            <classpath>
                <pathelement path="jarpath" />
            </classpath>
        </javac>
    </target>

    <target name="jar">
        <mkdir dir="build/jar" />
        <jar destfile="build/jar/TestCase1.jar" basedir="build/classes">
            <manifest>
                <attribute name="Main-Class" value="NSSR.TestCase1" />
            </manifest>
        </jar>
        <jar destfile="build/jar/UniversalVariables.jar" basedir="build/classes">
            <manifest>
                <attribute name="Main-Class" value="NSSR.UniversalVariables" />
            </manifest>
        </jar>
    </target>

</project> 
````  `当我将“ant compile”放入 Windows 的命令行时，它给了我一个巨大的错误：

 `````
Buildfile: C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Case
s\src\build.xml

compile:
    [javac] Compiling 4 source files to C:\Documents and Settings\jradcliffe\wor
kspace\ITSM_Upgrade_Test_Cases\src\build\classes
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:3: package com.thoughtworks.selenium does not exist
    [javac] import com.thoughtworks.selenium.*;
    [javac] ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:4: package org.junit does not exist
    [javac] import org.junit.After;
    [javac]                 ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:5: package org.junit does not exist
    [javac] import org.junit.Before;
    [javac]                 ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:6: package org.junit does not exist
    [javac] import org.junit.Test;
    [javac]                 ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:10: cannot find symbol
    [javac] symbol: class SeleneseTestCase
    [javac] public class TestCase1 extends SeleneseTestCase {
    [javac]                                ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:3: package com.thoughtworks.selenium does not exist
    [javac] import com.thoughtworks.selenium.*;
    [javac] ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:4: package org.junit does not exist
    [javac] import org.junit.After;
    [javac]                 ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:5: package org.junit does not exist
    [javac] import org.junit.Before;
    [javac]                 ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:6: package org.junit does not exist
    [javac] import org.junit.Test;
    [javac]                 ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:10: cannot find symbol
    [javac] symbol: class SeleneseTestCase
    [javac] public class TestCase1 extends SeleneseTestCase {
    [javac]                                ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:23: cannot find symbol
    [javac] symbol  : class Before
    [javac] location: class NSSR.TestCase1
    [javac]     @Before
    [javac]      ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:30: cannot find symbol
    [javac] symbol  : class Test
    [javac] location: class NSSR.TestCase1
    [javac]     @Test
    [javac]      ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:65: cannot find symbol
    [javac] symbol  : class After
    [javac] location: class NSSR.TestCase1
    [javac]     @After
    [javac]      ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:23: cannot find symbol
    [javac] symbol  : class Before
    [javac] location: class TestCase1
    [javac]     @Before
    [javac]      ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:30: cannot find symbol
    [javac] symbol  : class Test
    [javac] location: class TestCase1
    [javac]     @Test
    [javac]      ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:65: cannot find symbol
    [javac] symbol  : class After
    [javac] location: class TestCase1
    [javac]     @After
    [javac]      ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:25: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium = new DefaultSelenium("localhost", 4444, "*fire
fox",
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:25: cannot find symbol
    [javac] symbol  : class DefaultSelenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium = new DefaultSelenium("localhost", 4444, "*fire
fox",
    [javac]                            ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:27: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium.start();
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:32: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium.open(UniversalVariables.loginPage);
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:33: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium.type("name=USERNAME", UniversalVariables.userna
me);
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:34: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium.type("name=PASSWORD", UniversalVariables.passwo
rd);
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:35: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium.click("link=Submit");
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:36: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium.waitForPageToLoad("60000");
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:37: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium.open("/itg/dashboard/app/portal/PageView.jsp?IS
_WINDOID=N");
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:38: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium.click("link=Create");
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:39: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium.click("link=Request");
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:40: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium.waitForPageToLoad("30000");
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:41: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium.select("name=REQUEST_TYPE_CREATE",
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:43: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium.click("css=span.secBtn > a");
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:44: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium.waitForPageToLoad("30000");
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:55: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium.type("id=REQ.DESCRIPTION", title);
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:56: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium.type("id=REQ.P.REQUESTORAC_TF", req);
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:57: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium.select("id=REQ.P.REQUESTOR_DEPT", dept);
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:58: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium.type("id=REQ.P.DETAIL_DESC", desc);
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:59: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium.type("REQ.P.REQ_COMPL_DATE", date);
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:60: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium.click("link=Submit");
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:61: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium.waitForPageToLoad("30000");
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:62: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium.refresh();
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\NSSR\TestCase1.java:67: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class NSSR.TestCase1
    [javac]             selenium.stop();
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:25: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium = new DefaultSelenium("localhost", 4444, "*fire
fox",
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:25: cannot find symbol
    [javac] symbol  : class DefaultSelenium
    [javac] location: class TestCase1
    [javac]             selenium = new DefaultSelenium("localhost", 4444, "*fire
fox",
    [javac]                            ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:27: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium.start();
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:32: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium.open(UniversalVariables.loginPage);
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:33: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium.type("name=USERNAME", UniversalVariables.userna
me);
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:34: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium.type("name=PASSWORD", UniversalVariables.passwo
rd);
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:35: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium.click("link=Submit");
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:36: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium.waitForPageToLoad("60000");
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:37: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium.open("/itg/dashboard/app/portal/PageView.jsp?IS
_WINDOID=N");
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:38: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium.click("link=Create");
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:39: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium.click("link=Request");
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:40: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium.waitForPageToLoad("30000");
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:41: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium.select("name=REQUEST_TYPE_CREATE",
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:43: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium.click("css=span.secBtn > a");
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:44: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium.waitForPageToLoad("30000");
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:55: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium.type("id=REQ.DESCRIPTION", title);
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:56: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium.type("id=REQ.P.REQUESTORAC_TF", req);
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:57: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium.select("id=REQ.P.REQUESTOR_DEPT", dept);
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:58: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium.type("id=REQ.P.DETAIL_DESC", desc);
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:59: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium.type("REQ.P.REQ_COMPL_DATE", date);
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:60: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium.click("link=Submit");
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:61: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium.waitForPageToLoad("30000");
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:62: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium.refresh();
    [javac]             ^
    [javac] C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cas
es\src\TestCase1.java:67: cannot find symbol
    [javac] symbol  : variable selenium
    [javac] location: class TestCase1
    [javac]             selenium.stop();
    [javac]             ^
    [javac] 64 errors

BUILD FAILED
C:\Documents and Settings\jradcliffe\workspace\ITSM_Upgrade_Test_Cases\src\build
.xml:15: Compile failed; see the compiler error output for details.

Total time: 1 second 
````  `基本上，它似乎无法识别我的 jar 文件中的任何内容，我认为这是有道理的，因为我没有在编译目标中引用它们。问题是我不知道*如何*引用它们（这是我除了 Hello World 之外的第一个 Buildfile）。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T21:09:48.853

您遇到的问题是设置和管理类路径。这是迄今为止 ANT 构建中最常见的问题......

当我查看您的代码时，您似乎应该运行 junit...

我整理了一个修改后的构建文件，演示了以下内容：

1.  使用[apache ivy](http://ant.apache.org/ivy/)管理所有 3rd 方 jar 依赖项
2.  使用 ant [junit 任务运行 junit 测试](http://ant.apache.org/manual/Tasks/junit.html)
3.  使用类路径打包一个完整的可执行 jar

希望能帮助到你。

# 例子

该项目是根据以下问题中提供的源代码构建的：

[使用外部 jar 文件从 Windows 命令行运行 Java 时出现 NoClassDefFoundError](https://stackoverflow.com/questions/11397952/noclassdeffounderror-when-running-java-from-windows-command-line-with-external-j)

```
|-- build.xml
`-- src
    `-- NSSR
        |-- TestCase1.java
        `-- UniversalVariables.java 
```

您需要运行以下目标一次才能安装[ivy 插件](http://ant.apache.org/ivy/)

```
ant bootstrap 
```

然后按如下方式运行构建

```
ant clean jar 
```

然后可以按如下方式执行生成的jar；

```
java -jar build/dist/demo.jar 
```

## 构建.xml

```
<project name="demo" default="jar" xmlns:ivy="antlib:org.apache.ivy.ant">

    <!--
    ==========
    Properties
    ==========
    -->
    <property name="src.dir"     location="src"/>
    <property name="build.dir"   location="build"/>
    <property name="classes.dir" location="${build.dir}/classes"/>
    <property name="dist.dir"    location="${build.dir}/dist"/>

    <property name="jar.file"       location="${dist.dir}/${ant.project.name}.jar"/>
    <property name="jar.main.class" value="NSSR.TestCase1"/>

    <property name="javac.deprecation" value="false"/>
    <property name="junit.haltonfailure" value="false"/>

    <!--
    =======
    Targets
    =======
    -->
    <target name="bootstrap" description="Install ivy">
        <mkdir dir="${user.home}/.ant/lib"/>
        <get src="https://repository.sonatype.org/service/local/artifact/maven/redirect?r=central-proxy&amp;g=org.apache.ivy&amp;a=ivy&amp;v=LATEST&amp;e=jar"
             dest="${user.home}/.ant/lib/ivy.jar"/>
    </target>

    <target name="init" description="Resolve dependencies and set classpaths">
        <ivy:cachepath pathid="build.path" conf="default">
            <dependency org="org.seleniumhq.selenium" name="selenium" rev="2.0rc2"/>
            <dependency org="junit" name="junit" rev="4.10"/>
        </ivy:cachepath>
    </target>

    <target name="compile" depends="init" description="Compile the code">
        <mkdir dir="${classes.dir}" />
        <javac srcdir="." destdir="${classes.dir}" includeantruntime="false" deprecation="${javac.deprecation}" classpathref="build.path"/>
    </target>

    <target name="test" depends="compile" description="Run unit tests">
        <mkdir dir="${build.dir}/tests"/>

        <junit printsummary="yes" haltonfailure="${junit.haltonfailure}">
            <classpath>
                <path refid="build.path"/>
                <pathelement path="${classes.dir}"/>
            </classpath>
            <formatter type="plain"/>
            <batchtest fork="yes" todir="${build.dir}/tests">
                <fileset dir="${src.dir}" includes="**/*Test*.java"/>
            </batchtest>
        </junit>
    </target>

    <target name="jar" depends="test" description="Build jar files">
        <ivy:retrieve pattern="${dist.dir}/lib/[artifact]-[revision](-[classifier]).[ext]"/>

        <manifestclasspath property="jar.classpath" jarfile="${jar.file}">
            <classpath>
                <fileset dir="${dist.dir}/lib" includes="*.jar"/>
            </classpath>
        </manifestclasspath>

        <jar destfile="${jar.file}" basedir="${classes.dir}">
            <manifest>
                <attribute name="Main-Class" value="${jar.main.class}" />
                <attribute name="Class-Path" value="${jar.classpath}" />
            </manifest>
        </jar>
    </target>

    <target name="clean" description="Remove build files">
        <delete dir="${build.dir}" />
    </target>

    <target name="clean-all" depends="clean" description="Additionally purge ivy cache">
        <ivy:cleancache/>
    </target>

</project> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:10:57.737

Try this:

```
 <classpath>
      <pathelement path="${classpath}"/>
      <fileset dir="lib">
        <include name="**/*.jar"/>
      </fileset>
      <pathelement location="classes"/>
      <dirset dir="${build.dir}">
        <include name="apps/**/classes"/>
        <exclude name="apps/**/*Test*"/>
      </dirset>
      <filelist refid="third-party_jars"/>
    </classpath> 
```

See [Writing a simple build file](http://ant.apache.org/manual/using.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T06:30:47.053

尝试更改您的`compile`目标，以便在`<javac>`使用`<classpath>`范围内`refid`而不是`id`如下所示：

```
<target name="compile">
    <mkdir dir="build/classes" />
    <javac srcdir="." destdir="build/classes" includeantruntime="false">
        <classpath refid="jarpath" />
    </javac>
</target> 
```````

# actionscript-3 - 查找要在 PopUpManager 中使用的 DisplayObject

> ID：11398531
> 
> 赞同：0
> 
> 时间：2012-07-09T15:44:25.707
> 
> 标签：actionscript-3, apache-flex, flex4.5

我正在为 Flex Web 客户端创建一个扩展。引入我的扩展的方式是通过 UI 中的菜单项。当用户从菜单中选择动作时，它将运行我特定的 ActionScript 方法。

我想让我的 ActionScript 方法使用 PopUpManager 创建一个弹出窗口。我遇到的问题是 PopUpManager.createPopUp 的第一个参数是 DisplayObject。因为我要直接进入 AS 方法，所以我不能使用继承的 DisplayObject（又名“this”）。

我正在寻找一种从 AS 方法中查找或访问对父/根 DisplayObject 的引用的方法。这可能吗？我对 Flex/ActionScript 还很陌生，所以我可能对这里发生的事情也有一个基本的误解。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-01T20:39:52.290

根据我之前的评论，为正在搜索该主题的其他人提供自我回答

```
import mx.core.FlexGlobals
var popup:IFlexDisplayObject = popUpManager.createPopUp(FlexGlobals.topLevelApplication as   DisplayObject, MyPopUp, false); PopUpManager.centerPopUp(popup); 
```

# python - python pickle 转储非 ascii

> ID：11398537
> 
> 赞同：2
> 
> 时间：2012-07-09T15:44:47.263
> 
> 标签：python

我想在 Linux 中使用 Python 将一些内容写入文件（从 GNUPG 获得的结果），以便稍后读取它并查看签名和数据是否仍然有效。

当我尝试以下列方式将结果写入文件时（我的代码中的第 16-18 行）：

```
with open(“result.txt”, “w”) as my_file:
    pickle.dump(signed_data, my_file)
my_file.close() 
```

我遇到以下问题：

```
python eg1.py 
    File "eg1.py", line 16
SyntaxError: Non-ASCII character '\xe2' in file eg1.py on line 16, but no encoding     declared; see http://www.python.org/peps/pep-0263.html for details 
```

尽管我可以将有问题的值更改为其他值并在稍后读回它们时将它们改回来，但我想知道是否可以按我的意图简单地保存文件而不更改它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T15:51:19.940

此错误消息与您要编写的二进制内容（signed_data）无关，但与 python 源文件有关。您没有说明第 16 行是什么，但“开放”行中的印刷撇号可能是原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T15:50:50.397

如果这是在 Windows 中，请查看与 Unicode 相关的解决方案，例如[链接到此处](http://mohsinpage.wordpress.com/2010/06/10/python-syntaxerror-non-ascii-character-xe2-in-file/)。

# java - 调用 addView() 时出现空指针异常：Android

> ID：11398539
> 
> 赞同：1
> 
> 时间：2012-07-09T15:44:50.183
> 
> 标签：java, android, user-interface

我正在尝试创建一个顶部有三个选项卡的记事本应用程序，每个选项卡都链接到不同的视图。

前两个选项卡将仅包含要填写的表格，而第三个选项卡将是实际编写完成的地方。问题是，每当我尝试扩充第三个视图时，我都会收到此行的空指针异常：

```
((LinearLayout) findViewById(R.id.drawRoot)).addView(v,0); 
```

这是我的代码：

```
public void onTabSelected(ActionBar.Tab tab, FragmentTransaction fragmentTransaction) {
    // When the given tab is selected, show the tab contents in the container
    Fragment fragment = new Section3Fragment();
    Bundle args = new Bundle();
    args.putInt(Section3Fragment.ARG_SECTION_NUMBER, tab.getPosition() + 1);
    fragment.setArguments(args);
    getSupportFragmentManager().beginTransaction()
            .replace(R.id.container3, fragment)
            .commit();
}

public void onTabReselected(ActionBar.Tab tab, FragmentTransaction fragmentTransaction) {
}

public  class Section3Fragment extends Fragment {
    public Section3Fragment() {
    }

    int section;
    public static final String ARG_SECTION_NUMBER = "section_number";

    @Override
    public  View  onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {

        Bundle args = getArguments();
       section = args.getInt(ARG_SECTION_NUMBER);
       View view;

       if (section == 1)
       {
            view = inflater.inflate(R.layout.section3_page1, container,false);

           return view;
       }
       if (section == 2){

        view = inflater.inflate(R.layout.section3_page2, container, false);
        return view;
       }
       else {

            if(v != null)
                Log.v("not null", "not null");

            view = inflater.inflate(R.layout.section3_page3, container, false);
            ((LinearLayout) findViewById(R.id.drawRoot)).addView(v,0); //null pointer exception here!!

           return view;

       }
    }
} 
```

对象 v 是我用来进行实际绘图的类的一个实例。

和 section3_page3 布局文件

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/drawRoot"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >
</LinearLayout> 
```

非常感谢您对此问题的任何见解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:47:34.623

快速浏览一下，您是否正在尝试执行以下操作：

```
 ((LinearLayout) view.findViewById(R.id.drawRoot)).addView(v,0); 
```

您正在寻找片段上的视图。不是您在 if 语句中夸大的观点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T15:47:37.147

您发布了 section3_page3.xml 但您打开了`inflater.inflate(R.layout.section3_page2, container, false)`. 这是一个错字还是问题的根本原因？

打开错误的 XML 文件会导致 findViewById() 在此处返回 null：

```
view = inflater.inflate(R.layout.section3_page2, container, false);
((LinearLayout) findViewById(R.id.drawRoot)).addView(v,0); 
```

因此出现 NullPointerException ......我猜你的意思是：

```
view = inflater.inflate(R.layout.section3_page3, container, false);
((LinearLayout) findViewById(R.id.drawRoot)).addView(v,0); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T15:57:31.597

由于您使用的是 ActionBar 和 Fragments，我建议更改此设置：

```
((LinearLayout) findViewById(R.id.drawRoot)).addView(v,0); 
```

进入这个：

```
((LinearLayout) getActivity().findViewById(R.id.drawRoot)).addView(v,0); 
```

# javascript - Backbone.js '#' 路由不起作用

> ID：11398542
> 
> 赞同：1
> 
> 时间：2012-07-09T15:44:54.793
> 
> 标签：javascript, backbone.js

在我的路由器中，我指定了路由器“#”来调用索引函数。这在应用程序加载时第一次起作用。但是在导航离开然后返回后，视图不再呈现。这是我的路由器：

```
CommunityApp.Routers.Main = Backbone.Router.extend({
    routes: {
        '': 'index',
        '#': 'index',
    },

    initialize: function () {
        this.communities = new CommunityApp.Collections.Communities();
        this.communities.fetch();
    },

    index: function() {
        console.log('index called');
        view = new CommunityApp.Views.CommunitiesIndex({collection: this.communities});
        $('#main').html(view.render().el);
    }
}); 
```

我看到该函数被调用，因为它记录了“索引调用”。但是，该视图仅在我第一次导航到 localhost:3000/# 时才呈现。如果我单击返回“#”的其他位置，该函数会被调用，但 CommunitiesIndex 视图永远不会插入到 DOM 中。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:49:39.603

我知道这是一个旧线程，但我会加上我的 2 美分。

对应的路线是`''`。

```
routes: { '' : 'index' } 
```

路线只是空白。第二部分可以是任何你想要的，即`'index'`, `'home'`, `'landing'`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:23:58.260

为什么要使用#来映射索引页，这不是一个好方法。我建议您使用其他字符来映射索引页面，例如“索引”。如果一定要用#，你的url应该是**http://xxx.com/##**，所以看起来很奇怪，远比**http://xxx.com/#index**索引清晰。

编辑：

```
 routes: {
        '': 'index'
    }, 
```

这样做，这意味着如果没有匹配映射，它会自动匹配[''：'index']。那你奇怪为什么只跳转到第一个索引？我想第一次没有匹配任何映射，所以符合['':'index']就自动跳转到索引页，以后总是有匹配映射，不符合['':'index']当然就不会跳转到索引页了.

# php - 页面之间的会话数据丢失

> ID：11398543
> 
> 赞同：-1
> 
> 时间：2012-07-09T15:44:56.533
> 
> 标签：php, mysql, session, login

我有一个问题是我在主页上并且我登录然后我转到另一个页面并且我不再看到存储的会话，但是当我点击登录时它说我已经登录了。但是如果我去另一个目录，例如 /admin/ 会话数据仍然存在。任何解决方案？

登录.php

```
<?php 
session_start(); 
require_once('connections/Main.php');

if($_SESSION['username']) {

    echo '<div class="error_message">Attention! '.$_SESSION['username'].'. You  are already logged in.</div>';
    echo "<br />";
    echo "Go <a target='top' href='index.php'>back</a> to the page you were viewing before this.</li>";

    exit();
}

// Has an error message been passed to login.php?
$error = $_GET['e'];

if($error == 1) {
    $error = '<div class="error_message">Attention! You must be logged in to view this page.</div>';
}

// Only process if the login form has been submitted.

if(isset($_POST['login'])) {

    $username = $_POST['username']; 
    $password = $_POST['password']; 

        if (empty($username) || empty($password)) { 
        $error = '<div class="error_message">Attention! Please enter your Username and Password.</div>';
    } else { 

     mysql_select_db($database_Main);
    // Add slashes to the username and md5() the password 
    $user = mysql_real_escape_string(addslashes($_POST['username'])); 
    $pass = mysql_real_escape_string(md5($_POST['password'])); 

    $sql = "SELECT * FROM  users WHERE username = '$user' AND password= '$pass' OR email = '$user' AND password= '$pass' "; 

    $result = mysql_query($sql);

    // Check that at least one row was returned 
    $rowCheck = mysql_num_rows($result); 

    if($rowCheck > 0) { 
    while($row = mysql_fetch_array($result)) { 

      // Start the session and register a variable 
      if(isset($_POST['remmemberme'])){
          setcookie(kitbusername, $user,  time()+(3600*24*30));
      }
      $_SESSION['username'] = $user;
      //session_register('username'); 

      echo '<script>parent.changeURL("index.php"); </script>';

      } 

      } else { 

      // If nothing is returned by the query, unsuccessful login code goes here... 

      $error = '<div class="error_message">Attention! Incorrect username or password.</div>'; 
      } 
    }
}
echo $error; ?> 
```

每个页面上的 header.php

```
<div id="loginoutbox">
<?php session_start(); 
  if($_SESSION["username"]) { ?>
<div>
  Hello <?php echo $_SESSION['username']; ?>! | </div>
<a id="register" href="http://www.kdogisthebest.webege.com/admin/" class="button">Dashboard</a> |
<a id="signin" href="#fallr-confirmlike" class="button">Logout</a>      
<?php }else{ ?>
<div style="display: inline-block; font-size: 14px; padding-left: 20px;">Hello Guest!</div>
<a id="register" href="#fallr-register" class="button">Register</a> |
<a id="signin" href="#fallr-signin" class="button">Login</a>
<?php } ?>
</div> 
```

演示 ---> [http://www.kdogisthebest.webege.com/index.php](http://www.kdogisthebest.webege.com/index.php)

用户名 = 演示用户

密码 = 演示用户

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:45:54.980

`<?php session_start();`需要*在*任何输出之前。将其放在页面顶部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:41:13.033

好的，在使用 var_dump 转储 $_SESSION 变量后，我看到更改页面后，变量显示为 NULL。我进行了研究并进行了研究，我认为最好得出结论，它是导致它以这种方式运行的 php 服务器配置。

# google-chrome - 如何检查css属性

> ID：11398544
> 
> 赞同：0
> 
> 时间：2012-07-09T15:44:58.403
> 
> 标签：google-chrome

可以使用 google chrome 检查 css 类的属性吗？

当我检查元素时，我可以查看 css 类名，但无法查看该类的属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:49:20.503

右键单击要检查的区域，然后单击“检查元素”。它将显示与其关联的 CSS 样式的所有定义。看这里![这里](../Images/88de4e1b6bcaf27c6953561590955b61.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T15:50:45.283

Chrome 开发者工具允许检查 CSS 属性。选择*View > Developer > Developer Tools*应该会在窗口底部打开一个面板，右侧将是所有 CSS 好东西。请参阅[@Chris 的](https://stackoverflow.com/a/11398645/1267663)图片。

# http - 更新符合某些要求的资源的最 REST 方式是什么？

> ID：11398545
> 
> 赞同：2
> 
> 时间：2012-07-09T15:44:58.693
> 
> 标签：http, rest

我想做更多`REST`这样的事情：

选择`field1`等于的资源`foo`，然后更新`field1`为`bar`

```
UPDATE XXX SET field1 = "bar" WHERE field1="foo" 
```

我可以看到两种解决方案：

1.  `GET`符合我要求的项目，然后`PUT`更新它们。也许有`Etag`或`If-Match`保证它是原子的。
2.  编写一个自定义的`PUT`方法处理程序，这样查询字符串代表SQL中的WHERE子句，`PUT`请求的内容代表`SET`SQL中的子句

我个人更喜欢后一种解决方案，但是在 中`REST`，该`PUT`方法应该*覆盖* *一个*资源，一次不是*很多*资源，也不是仅仅更新资源的某些字段。

我还检查了[HTTP`PATCH`](https://www.rfc-editor.org/rfc/rfc5789)方法提案。它使“更新资源的某些字段”成为可能，但它也不用于一次更新许多资源。

那么你的解决方案是什么？我想看看你的最佳做法:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:15:45.957

未经测试的随机想法：

```
 url: PUT /xxx/*/field1/foo
 body: "bar" 
```

或（如果您可以预测/绑定 XXX 的键范围）：

```
PUT /xxx/0,9999999/field1/foo
"bar" 
```

或者如果你对 2 个电话没问题，也许：

```
GET /xxx?field1="foo"
POST /xxx/id1,id2,...,idn/field1
"bar" 
```

# roku - 如何在 BrightScript 中执行“stripslashes”等效项

> ID：11398547
> 
> 赞同：1
> 
> 时间：2012-07-09T15:45:14.620
> 
> 标签：roku, brightscript

我是 Roku 的新手，发现我的 JSON 提要响应如下所示：

```
http:\/\/brightcove.vo.llnwd.net\/e1\/pd\/12345\/12345_1089831707001_test.mp4 
```

谁能帮我弄清楚如何修复 BrightScript 中的 JSON 响应？我现在正在浏览 BrightScript 参考文档，但只是想看看是否有人知道一种简单的方法来做到这一点，同时我继续将它拼凑在一起。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T18:29:37.817

好吧，经过更多研究，我找到了我需要的解决方案。万一这对其他人有帮助，这是我为修复字符串而编写的函数：

```
Function fixSlashes(item as string) As Object
r = "\\" 'backslash character

'case insensitive
 regexKeyFix = CreateObject( "roRegex", r, "i" )

    item = regexKeyFix.ReplaceAll( item, "" )
    Return item
End Function 
```

[这是我为此找到的文档](http://sdkdocs.roku.com/display/sdkdoc42/roRegex)的链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-21T22:03:12.597

您可以使用`Replace`一个*简单*的方法

> 替换（从作为字符串，到作为字符串）作为字符串
> 
> 返回字符串的副本，其中 fromStr 的所有实例都替换为 toStr。如果 fromStr 为空，则返回值与源字符串相同。

```
BrightScript Debugger> str = "http:\/\/brightcove.vo.llnwd.net\/e1\/pd\/12345\/12345_1089831707001_test.mp4"
BrightScript Debugger> ?item.Replace("\","")
http://brightcove.vo.llnwd.net/e1/pd/12345/12345_1089831707001_test.mp4 
```

# c++ - 想要创建许多不同的文件，但名称不同

> ID：11398548
> 
> 赞同：0
> 
> 时间：2012-07-09T15:45:16.260
> 
> 标签：c++, string, file, file-io, io

我需要创建一堆不同的文件，我想将它们命名为：

```
"signal1.dat", "signal2.dat", "signal3.dat", ... , "signal100.dat" 
```

这是我到目前为止所拥有的

```
std::stringstream ss;
std::string out = "signal";
std::string format = ".dat";
std::string finalName;
int TrkNxtSig = 1;

...
[code]  
... 

ss << out << TrkNxtSig << format;
finalName = ss.str();
ofstream output(finalName); 
TrkNxtSig++; 
```

我收到这个错误

```
 error: no matching function for call to ‘std::basic_ofstream<char, std::char_traits<char> >::basic_ofstream(std::string&)’
/usr/include/c++/4.4/fstream:623: note: candidates are: std::basic_ofstream<_CharT, _Traits>::basic_ofstream(const char*, std::_Ios_Openmode) [with _CharT = char, _Traits = std::char_traits<char>]
/usr/include/c++/4.4/fstream:608: note:                 std::basic_ofstream<_CharT, _Traits>::basic_ofstream() [with _CharT = char, _Traits = std::char_traits<char>]
/usr/include/c++/4.4/iosfwd:84: note:                 std::basic_ofstream<char, std::char_traits<char> >::basic_ofstream(const std::basic_ofstream<char, std::char_traits<char> >&) 
```

我不确定该错误消息告诉我什么。怎么了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:47:21.113

它告诉你没有构造函数`ofstream`接受`std::string`as 参数。

改为使用`ofstream output(finalName.c_str());`。

这已在 C++11 中修复。如果您使用 gcc，请尝试传递它`-std=c++0x`。

# php - php表单发布内容403错误

> ID：11398553
> 
> 赞同：1
> 
> 时间：2012-07-09T15:45:26.237
> 
> 标签：php, html, forms, http-status-code-403

最近，我网站上的一位用户提醒我，如果他们在我网站上的任何表单上提交了此内容，则会返回 403 错误。

```
make a <hr> add this css to it hr{border:none; border-top:1px solid #000; background:none; height:1px; width:yourwidth;} 
```

这是表单处理的背景（不是网站上使用的实际代码）。

```
<?php

if (isset($_POST['test'])) {

echo htmlspecialchars($_POST['content']);

}

?>

<form action = "" method = "post">

<textarea name = "content"></textarea>
<input type = "submit" name = "test"/>

</form> 
```

只要上面的文本没有提交到表单中，一切都可以正常工作。

我尝试将 htmlspecialchars 更改为 htmlentities，strip_tags 任何我能想到的东西，但它仍然返回 403 错误。如何防止此 403 错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T16:09:59.193

我试试你的代码。一切似乎都很好。您是否尝试删除 textarea 中的某些部分内容以查看哪个部分会导致此错误？请注意，403 是当用户请求服务器不允许他们访问的网页或媒体时，Web 服务器返回的 HTTP 状态代码。

您还可以询问您的托管服务提供商是否有拒绝输入的安全模块，因为它认为这是企图执行攻击。

另外：您是否尝试将文本区域的名称更改为“内容”以外的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-04T09:07:12.687

我知道这是一个老问题，但我发现有时使用 POST 方法的 html 表单会返回 403 错误，而如果我将方法更改为 GET，则相同的表单提交工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-03T07:06:27.720

如果您可以访问服务器，请使用不超过 $_SERVER['CONTENT_LENGTH'] 或增加 php.ini post_max_size 的帖子

# actionscript-3 - 如何使用 supplyFile() 阅读？

> ID：11398559
> 
> 赞同：0
> 
> 时间：2012-07-09T15:46:03.050
> 
> 标签：actionscript-3, flash, apache-flex, alchemy

**精简版：**

我看到有一个名为 supplyFile() 的炼金术方法，但第二个 arg 是一个 ByteArray ......这到底是为了什么？！？！

**更长的版本：**

我想做以下事情：

1.  打开一个文件并将其分配给炼金术 C 端的全局变量。

2.  在 C 端读入（并处理）一大块字节

3.  将它们发送到 Actionscript 进行显示

4.  转到第 2 步，直到 EOF 或来自 Actionscript 的通知

5.  关闭文件

我现在可以通过打开文件并将块读取到 Actionscript 端的 ByteArray 中然后将其传递给 C 进行处理并返回来执行此操作 - 但这需要执行 AS3_ByteArray_writeBytes()/AS3_ByteArray_readBytes 来调用一些不必要的开销() 在 C 端，以便操作 char * 中的数据。

**有什么方法可以在 C 端简单地 fopen() 一个文件并读取一些字节？**

假设我们正在讨论磁盘上的一个非常大的文件（> 4GB）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T15:09:28.797

从[文档](http://labs.adobe.com/wiki/index.php/Alchemy%3aDocumentation%3aDeveloping_with_Alchemy%3aAS3_API)：

> *supplyFile(path:String, data:ByteArray)：*此方法允许您为 C 代码提供位于指定路径的文件。如果您的 C 代码需要位于特定位置的配置文件，由于安全限制，运行时无法访问该配置文件，这将非常有用。

换句话说，`supplyFile`让您创建一个“虚拟文件”，可以从 C 中使用`fopen`.

您`supplyFile`使用表示虚拟文件路径的字符串（可以是您想要的任何内容）和作为该虚拟文件内容的 ByteArray 进行调用。然后，在C端你`fopen`用虚拟文件路径调用和使用`fread`和朋友一样，就像一个普通的文件。

# ms-access - 如何在 Access 2010 中创建字段为一年中的天数的表？

> ID：11398560
> 
> 赞同：1
> 
> 时间：2012-07-09T15:46:02.937
> 
> 标签：ms-access, ms-access-2010, datefield

所以问题几乎都在标题中。我只是想知道是否有一种简单的方法可以创建一个表格并在一年中的每一天都有一个字段，而无需执行 365 个条目。

我想要这样做的原因是为了更容易进行每周、每月和年初至今 (YTD) 的计算。理想情况下，我想要的是一组表来表示一年中的天数、月份，然后是年表。每个字段将在它们所代表的日期之后立即自动填写。

示例：在天数表中，我们看到相邻的字段 7/9/2012 和 7/10/2012。一旦内部时钟达到 2012 年 7 月 10 日，2012 年 7 月 9 日字段将填充从其他字段计算的数据。

几个月甚至几年都是如此。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T18:51:37.873

*我只是想知道是否有一种简单的方法可以创建一个表格并在一年中的每一天都有一个字段，而无需执行 365 个条目。*

尽管我不确定您的想法到底是什么，但我相当肯定正确的答案是“不，没有简单的方法”。:-)

创建一个包含 365 个字段的 Access 表（闰年呢？！）绝非易事。这是不可能的，因为 Access 表中的最大字段数是 255。

如果您愿意接受一年中符合该限制的部分时间，那么在我看来，每个日期都有一列的表格仍然是一个非常糟糕的主意。

OTOH，每个日期一行的日历表（“*列很昂贵；行很便宜*”）可能非常有用。我不明白你为什么显然拒绝了这种方法。

表的大小不应该是一个大问题：每年 <= 366 行，但那些可能是*窄*行。

如果问题是加载给定年份的所有日期的负担，那么这个负担可能非常微不足道。只需运行此`LoadCalendar`程序。`the_date`如果没有任何参数，它会将当前年份的日期加载到名为的表中的日期/时间字段中`tblCalendar`。您可以使用这些参数来替换不同的年份、表格或字段。

```
Public Sub LoadCalendar(Optional ByVal pYear As Integer, _
        Optional ByVal pTable As String = "tblCalendar", _
        Optional ByVal pField As String = "the_date")
    Dim db As DAO.Database
    Dim dte As Date
    Dim dteLast As Date
    Dim intYear As Integer
    Dim rs As DAO.Recordset
    Dim strMsg As String

On Error GoTo ErrorHandler

    intYear = IIf(pYear = 0, Year(Date), pYear)
    dte = DateSerial(intYear, 1, 1)
    dteLast = DateSerial(intYear, 12, 31)

    Set db = CurrentDb
    Set rs = db.OpenRecordset(pTable, dbOpenTable, dbAppendOnly)

    Do While dte <= dteLast
        rs.AddNew
        rs.Fields(pField).value = dte
        rs.Update
        dte = dte + 1
    Loop
    rs.Close

ExitHere:
    On Error GoTo 0
    Set rs = Nothing
    Set db = Nothing
    Exit Sub

ErrorHandler:
    strMsg = "Error " & Err.Number & " (" & Err.Description _
        & ") in procedure LoadCalendar"
    MsgBox strMsg
    GoTo ExitHere
End Sub 
```

如果您想一次加载多年，只需在“立即”窗口中执行以下操作：

```
for yr = 2000 to 2012 : LoadCalendar yr : next 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-12T16:22:01.600

您不能从 excel 开始，单击并拖动所需的日期范围和列，然后在 excel 和数据库之间导入/建立连接吗？快速，简单，无需编码。我相信您可以链接到 Excel 工作表并使用 Excel 工作表中的日期函数在连接刷新时自动进行此更新，尽管我没有尝试链接。

PS我绝不是专家，如果有更好的做法，请告诉我。

# c# - 在 C# 中打包泛型类型

> ID：11398562
> 
> 赞同：0
> 
> 时间：2012-07-09T15:46:06.923
> 
> 标签：c#, casting, binary

我正在尝试在 c# 中编写一个位打包程序，而不是为每个原始类型重载 pack 函数，而是尝试使用动态变量来处理更广泛的值。目前我只期望在 GetSizeOf 函数中找到的变量类型被传递，如果传递了其他任何东西，就会抛出异常。但是我在将价值转化为乌龙时遇到了麻烦。我已经用 int32、byte 和 int 试过了。此外，data 是一个字符串，在完成打包后应该包含打包数据的二进制序列，包括多余的 0。

如果有更好的方法来做到这一点，请告诉我。

```
 public static int GetSizeOf<V>(V v)
    {
        if (v is Byte) { return sizeof(Byte) * 8; };
        if (v is SByte) { return sizeof(SByte) * 8; };
        if (v is Int16) { return sizeof(Int16) * 8; };
        if (v is UInt16) { return sizeof(UInt16) * 8; };
        if (v is Int32) { return sizeof(Int32) * 8; };
        if (v is UInt32) { return sizeof(UInt32) * 8; };
        if (v is Int64) { return sizeof(Int64) * 8; };
        if (v is UInt64) { return sizeof(UInt64) * 8; };
        throw new Exception("Unable to determine size of " + typeof(V));
    }

    public void pack<T>(T value)
    {
        if (!(value as ulong?).HasValue)
            throw new Exception("Unable to cast " + typeof(T) + " as ulong");
        ulong num = (value as ulong?).Value;
        int size = GetSizeOf(value);
        for (int i = 0; i < size; i++)
        {
            data = (num & 1) + data;
            num >>= 1;
        }
    } 
```

# sencha-touch - 使用 ref getter 函数返回未定义

> ID：11398566
> 
> 赞同：4
> 
> 时间：2012-07-09T15:46:12.007
> 
> 标签：sencha-touch, sencha-touch-2

我仍在尝试完成[本教程](http://miamicoder.com/2012/how-to-create-a-sencha-touch-2-app-part-3/)，但取得了好坏参半。在我的控制器脚本中，我有以下内容：

```
config: {
        refs: {
            notesListContainer: 'noteslistcontainer',
            noteEditor: 'noteeditor'
        },
        control: {
            notesListContainer: {
                newNoteCommand: 'onNewNoteCommand',
                editNoteCommand: 'onEditNoteCommand'
            }
        }
},
onEditNoteCommand: function(list, record) {
    console.log('onEditNoteCommand');

    this.activateNoteEditor(record);
},
activateNoteEditor: function(record) {
        var noteEditor = this.getNoteEditor();
        noteEditor.setRecord(record);
        Ext.Viewport.animateActiveItem(noteEditor, this.slideLeftTransition);
}, 
```

当我在 Chromium 18.0.1025.168 中运行它时，我得到

```
Uncaught TypeError: Cannot call method 'setRecord' of undefined Notes.js:37`. 
`this.getNoteEditor()' 
```

不返回 noteEditor，但返回 undefined。

整个项目的源代码可[在此处](http://www.mediafire.com/?1ml1lumkafeh8zl)获得。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-09T16:58:30.820

重要的是使用 autoCreated 指定 ref`autoCreate : true`

```
config: {
    refs: {
        notesListContainer: 'noteslistcontainer',
        noteEditor: {
                 selector: 'noteeditor',
                 xtype: 'noteeditor',
                 autoCreate: true // missing
            }
        },
    },
...
} 
```

# java - 后退按钮上的浏览器注销

> ID：11398568
> 
> 赞同：3
> 
> 时间：2012-07-09T15:46:21.187
> 
> 标签：java, session, jsf

我目前正在研究解决我遇到的问题的最佳方法，并且想知道您是否可以提供帮助。

我的网站中有一个用户个人资料部分，我想让它更安全一些。

我有一个问题，当用户登录时，如果他们点击后退按钮，它会将他们带回登录页面但他们仍然登录。我怎样才能让它注销用户并将他们带到注销页面？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T18:09:23.753

我不确定您是否正在尝试做正确的事情。用户知道并使用后退按钮，如果该按钮将他们带回到他们之前所做的事情，这对他们很有帮助。让它自动注销用户会破坏一些关于 Web 应用程序如何工作的基本假设，我不建议您这样做。

而且，问题比你想象的还要严重。您提到了使用后退按钮的用户，但是使用右键单击打开新选项卡打开多个选项卡查看您的应用程序，然后在选项卡之间来回切换的用户呢？

话虽如此，这里有一种方法可以实现你想要的。您需要在服务器上的用户会话中跟踪最近查看的页面。每次收到新请求时，与会话中的缓存值进行比较，如果它不是可以在此处导航的页面，则清除会话并显示登录页面。实现相同目的的另一种方法是在显示每个页面时生成一个密钥（一个大的随机数会这样做），该密钥会在后续请求中传递，并且当请求任何页面并且它没有最新的密钥时清除会话并显示登录页面。

# java - JsonWriter IOException 不完整文档

> ID：11398569
> 
> 赞同：0
> 
> 时间：2012-07-09T15:46:23.287
> 
> 标签：java, json, ioexception

我正在使用带有 StringWriter 的 com.google.gson.stream.JsonWriter 来编写一个有点长的 JSON。

```
StringWriter stringWriter = new StringWriter();
JsonWriter jsonWriter = new JsonWriter(stringWriter); 
```

然后遍历一个集合并编写 JSON。

```
jsonWriter.name("Elements").beginArray();
Collection<Element> collection = someObject.getCollection();
    for(Element e : collection){
        jsonWriter.beginObject()
            .name("Id").value(e.getId())
        .endObject();
    }
jsonWriter.endArray(); 
```

我的问题是，当我尝试关闭编写器时，我得到一个**IOException: Incomplete Document。**似乎流无法刷新所有数据或其他内容，因为 JSON 在元素中间结束。

像这样：

```
{
    "Id": "1245 
```

Collection 实际上是一个**HashMap.values()**。我有一种预感，这是因为 HashMap 没有同步或类似的东西。

编辑：我正在关闭作者并以这种方式获取字符串：

```
jsonWriter.flush();
jsonWriter.close();
String json = stringWriter.toString(); 
```

# php - 如何从自定义模块获取 Magento 中的字段数据？

> ID：11398579
> 
> 赞同：0
> 
> 时间：2012-07-09T15:46:43.293
> 
> 标签：php, javascript, ajax, zend-framework, magento

我对 Magento 开发非常陌生（这是我的第一个模块）。该模块的目的是解决我们在原始模块中遇到的一些问题，同时不对模型/控制器进行任何更改。我正在修改这个现有的模板，但我似乎找不到检索字段的方法。该模板正在使用：

```
$this->getChildHtml('submit_button'); 
```

提交数据。这最终会调用一个 javascript/ajax 函数，这几乎让我陷入了死胡同。我只是想获得以下值，比如说：

```
<textarea name="thing[other]" .../> 
```

我将如何检索该值以便我的模型可以操纵它？覆盖控制器不是一种选择，此页面本质上是使用相同控制器的另一个页面的副本。该控制器的功能是该控制器所需的，而不是该控制器所需的。

或者

我的另一个选择是覆盖模板。我的问题是原始模块使用观察者来覆盖模板，我不知道如何覆盖它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T19:23:57.747

您需要创建一个控制器并将表单操作设置为发布到此控制器。然后，您可以通过调用访问帖子数据：

`$postData = $this->getRequest()->getPost();`

# eclipse - 在组织导入或自动完成期间如何避免名称冲突？

> ID：11398580
> 
> 赞同：3
> 
> 时间：2012-07-09T15:46:44.333
> 
> 标签：eclipse, autocomplete, import

当我使用 Eclipse`Ctrl-Shift-o`来组织导入、`Ctrl-1`快速修复或 alt-space 来完成引用时，我希望能够指定首选包（或者忽略包列表）以避免命名空间冲突。例如，我们总是想要 java.util.List，但最终过于频繁地看到以下对话框：

![烦人的组织导入对话框](../Images/62dafe552fc10d0cb913edcbafe37425.png)

有没有办法避免这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T15:49:15.923

Eclipse 支持负导入过滤器。例如，您可以过滤所有`java.awt.*`和`javax.swing.*`包，以便它们永远不会作为选项出现。这可以在`Java > Appearance > Type Filters`菜单下的首选项中完成。

顺便说一句，这很尴尬，这导致我提交了一个[增强请求](https://bugs.eclipse.org/bugs/show_bug.cgi?id=386125)，以便更简单地过滤未使用的类型。

# ms-access - 使用 Windows 资源管理器获取要存储在表中的文件的路径（字符串）

> ID：11398583
> 
> 赞同：1
> 
> 时间：2012-07-09T15:46:49.940
> 
> 标签：ms-access, vba, ms-access-2007

我目前设置了一个数据库来存储与我的数据相关联的图片路径，并使用 VBA 将它们显示在图像帧中。它工作得很好，但是添加图片的过程有点乏味，用户很难正确使用它（输入错误的路径，忘记包含扩展名等）。这会导致数据库中出现一堆垃圾条目。我想简化这个过程。理想情况下，当单击“添加图片”时，我希望它打开 Windows 资源管理器，让用户选择所需的图片，获取该图片的路径，然后将其插入表格中。同样，我没有使用 OLE，只是路径的文本字段。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T17:21:39.313

正如 Remou 所引用的，FileDialog 对象可用于完成此操作。对于许多人来说，可能需要添加对 MS Office 对象库的引用（Access 库是不够的）。我用来从资源管理器中选择的文件中收集路径名的代码如下：

```
 Public Sub ShowFileDialog()
 Dim dlgOpen As FileDialog
 Set dlgOpen = Application.FileDialog(msoFileDialogOpen)
 With dlgOpen
 .AllowMultiSelect = False
 .InitialFileName = "Z:\" 'Initial Path when explorer is opened
 .Show
     If .SelectedItems.Count = 0 Then
       MsgBox ("No file Selected") 'No file selected
     Else
        Me.txtPath = .SelectedItems(1) 'sets textbox on the form to the path selected
     End If
  End With

 End Sub 
```

# mysql - 以特定格式将 txt 文件导入我的数据库

> ID：11398585
> 
> 赞同：0
> 
> 时间：2012-07-09T15:46:54.470
> 
> 标签：mysql

我是 MySQL 新手，我搜索了互联网。在我使用 CSV 文件或 SQL 文件将数据导入数据库之前。但现在我有一个这种格式的文本文件：

```
number  
989399999999    
989388888888    
989384444444 
```

这持续了大约 300 条记录。如何将其导入我的数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:06:18.223

[`LOAD DATA INFILE`](http://dev.mysql.com/doc/refman/5.5/en/load-data.html)

> LOAD DATA INFILE 语句以非常高的速度将文本文件中的行读取到表中。文件名必须以文字字符串的形式给出。

`LOAD DATA LOCAL INFILE 'C:\\Users\\hi\\Desktop\\abc.txt' INTO TABLE customer LINES TERMINATED BY '\n' IGNORE 1 LINES`

查询是不言自明的，我希望:)

# android - 管理活动生命周期的持续时间

> ID：11398588
> 
> 赞同：0
> 
> 时间：2012-07-09T15:47:01.807
> 
> 标签：android, android-layout, android-intent

你能建议我如何让我的应用程序不会暂停吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:57:50.570

不幸的是，您基本上无法控制主要活动的状态。 `onPause()`只要您的应用程序失去前台，就会被调用。您可以查看[此处](http://developer.android.com/reference/android/app/Activity.html)以大致了解生命周期是如何工作的。即使您的应用程序在后台，您也可以使用[服务](http://developer.android.com/reference/android/app/Service.html)继续执行任务。随时`onPause()`调用保存状态也是一个好主意。这样用户可以顺利恢复您的应用程序，即使它最终被操作系统杀死。

# python - 从 Pyramid 中的 __init__.py 访问请求

> ID：11398590
> 
> 赞同：3
> 
> 时间：2012-07-09T15:47:04.147
> 
> 标签：python, logging, request, pyramid

在设置 Pyramid 应用程序并向配置器添加设置时，我在理解如何从请求中访问信息时遇到问题，例如 request.session 等。我对使用 Pyramid 完全陌生，我已经到处搜索了有关此信息的信息，但一无所获。

我想要做的是在生产中发送异常电子邮件时访问请求对象中的信息。我无法访问请求对象，因为`__init__.py`在创建应用程序时它在文件中不是全局的。这就是我现在得到的：

```
import logging
import logging.handlers
from logging import Formatter

config.include('pyramid_exclog')
logger = logging.getLogger()

gm = logging.handlers.SMTPHandler(('localhost', 25), 'email@email.com', ['email@email.com'], 'Error')
gm.setLevel(logging.ERROR)
logger.addHandler(gm) 
```

这工作正常，但我想在发送异常电子邮件时包含有关登录用户的信息，存储在会话中。我如何访问该信息`__init__.py`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T21:18:57.267

尝试将请求设置为全局变量，或者以某种方式全局存储指向“当前”请求的指针（如果这是您要尝试订阅`NewRequest`事件的方法）并不是一个非常好的主意 - Pyramid 应用程序可以有多个线程执行，因此多个请求可以同时在单个进程中处于活动状态。因此，当应用程序以单线程模式运行并且只有一个用户可以访问它时，这种方法在开发过程中可能看起来很有效，但在部署到生产服务器时会产生非常有趣的结果。

Pyramid 具有`pyramid.threadlocal.get_current_request()`返回线程本地请求变量的函数，但是，文档指出：

> 这个函数应该非常谨慎地使用，通常只在单元测试代码中使用。在测试上下文之外使用 get_current_request 几乎总是错误的，因为它的使用使得编写既不容易测试也不能编写脚本的代码成为可能。

这表明整个方法不是“金字塔”（与 pythonic 相同，但对于 Pyramid :)

其他可能的解决方案包括：

*   查看[exlog.extra_info](http://docs.pylonsproject.org/projects/pyramid_exclog/en/latest/#settings)参数，该参数应将请求的 environ 和 params 属性包含到日志消息中
*   注册异常视图将允许完全自定义处理异常
*   使用 WSGI 中间件，例如`WebError#error_catcher`或`Paste#error_catcher`发生异常时发送电子邮件
*   如果您不仅想记录异常，还想记录其他非致命信息，也许只需要编写一个包装函数就足够了：

    ```
    if int(request.POST['donation_amount']) >= 1000000:
       send_email("Wake up, we're rich!", authenticated_userid(request)) 
    ```

# c# - 将 [A][B] 解析为 A 和 B 的正则表达式

> ID：11398595
> 
> 赞同：1
> 
> 时间：2012-07-09T15:47:15.550
> 
> 标签：c#, regex

我正在尝试使用正则表达式将以下字符串分隔成单独的行

```
[property1=text1][property2=text2] 
```

并且期望的结果应该是

```
property1=text1
property2=text2 
```

这是我的代码

```
string[] attrs = Regex.Split(attr_str, @"\[(.+)\]"); 
```

结果不正确，我可能做错了什么

![在此处输入图像描述](../Images/20c389d39e2228ed743860464a559be8.png)

**更新：**应用建议的答案后。现在它显示空格和空字符串

![在此处输入图像描述](../Images/5945a126153d789f77addbd32828f993.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T15:49:53.267

`.+`是一个贪婪的匹配，所以它尽可能地抓住。

使用任一

```
\[([^]]+)\] 
```

或者

```
\[(.+?)\] 
```

在第一种情况下，`]`不允许匹配，因此“尽可能”变得更短。第二个使用非贪婪匹配。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-09T15:50:05.003

你的点也在抓住牙套。您需要排除大括号：

```
\[([^]]+)\] 
```

`[^]]`匹配除右括号之外的任何字符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-09T15:52:43.250

尝试：

```
var s = "[property1=text1][property2=text2]";
var matches = Regex.Matches(s, @"\[(.+?)\]")
    .Cast<Match>()
    .Select(m => m.Groups[1].Value); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-09T15:52:24.300

尝试添加“懒惰”说明符：

```
Regex.Split(attr_str, @"\[(.+?)\]"); 
```

# iphone - 有没有办法使用 iPhone 从非 Apple 蓝牙设备读取数据？

> ID：11398596
> 
> 赞同：0
> 
> 时间：2012-07-09T15:47:16.623
> 
> 标签：iphone, ios4, iphone-sdk-3.0, bluetooth, ios5

我真的在这个话题上搜索了一段时间。尤其是当 iOS 3 是 iPhone 上的最新软件版本时。

我想知道是否有可能使用 SDK 通过蓝牙将 iPhone 连接到外部设备并检索测量数据？

谢谢你的帮助！

问候！玛丽

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:03:11.867

由于您希望设备进行通信，因此您必须查看苹果的[MFi 程序。](https://developer.apple.com/programs/mfi/)它支持在 iPhone 上使用外部配件，但您必须注册/付费。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:03:53.377

如果蓝牙设备可以伪装成蓝牙键盘，那么它可以将数据发送到编码为按键的 iOS 设备。

如果蓝牙设备是或可以伪装成耳机，那么它可能能够发送由音频调制方案（如 FSK）编码的数据。需要在 iOS 应用程序中运行匹配的调制解调器/编解码器。

对于最新的 iOS 设备 (4S)，您可以使用新的蓝牙 LE 协议来发送数据（旧的蓝牙数据通信协议不适用于应用程序，除非您在 Apple 的 NDA MFi 计划中）。

# wcf - 创建无会话或会话通道

> ID：11398602
> 
> 赞同：2
> 
> 时间：2012-07-09T15:47:25.243
> 
> 标签：wcf

任何人都可以在 WCF 中告诉我如何在 SessionMode.Allowed 中创建会话或无会话通道。这意味着允许使用 WCF 服务进行两种类型的对话。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T03:29:21.523

`SessionMode`仅描述您的服务合同，但不实施所需的行为。`SessionMode.Allowed`告诉大家服务在会话和没有会话的情况下都可以正常工作。使用或不使用会话在绑定中定义。

不同类型的绑定提供不同的功能集。某些功能需要/包括会话支持。

您可以为同一个合约使用多个绑定，一个绑定将实现会话，而同时另一个绑定不会。

例如下面的代码创建会话通道，因为 WSHttpBinding 实现了消息安全。

```
EndpointAddress address = new EndpointAddress("http://localhost/servicemodelsamples/service.svc");
WSHttpBinding binding = new WSHttpBinding();
ChannelFactory<ICalculator> factory = new 
                    ChannelFactory<ICalculator>(binding, address);
ICalculator channel = factory.CreateChannel(); 
```

添加此行将使 Channel 无会话：

```
binding.Security.Mode = SecurityMode.None; 
```

绑定波纹管也是无会话的，因为默认情况下`BasicHttpBinding`实现`SecurityMode.None`。

```
BasicHttpBinding myBinding = new BasicHttpBinding();
EndpointAddress myEndpoint = new EndpointAddress("http://localhost/MathService/Ep1");
ChannelFactory<IMath> myChannelFactory = new ChannelFactory<IMath>(myBinding, myEndpoint); 
```

基于安全的会话不是 WCF 支持的唯一会话类型。WCF 支持 4 种不同类型的会话：

*   基于安全的会话，其中通信的两端已就特定的安全会话达成一致。
*   基于 TCP/IP 的会话，以确保所有消息都由套接字级别的连接关联。
*   System.ServiceModel.Channels.ReliableSessionBindingElement 元素实现了 WS-ReliableMessaging 规范，提供对可靠会话的支持
*   System.ServiceModel.NetMsmqBinding 绑定提供 MSMQ 数据报会话。

如果绑定实现了上述任何功能，您的服务将是全会话的。

有关详细信息，请参阅 MSDN - [http://msdn.microsoft.com/en-us/library/ms733040.aspx](http://msdn.microsoft.com/en-us/library/ms733040.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-09T22:25:30.753

我假设您的意思是[[ServiceContract]](http://msdn.microsoft.com/en-us/library/system.servicemodel.servicecontractattribute.aspx)属性上的[SessionMode](http://msdn.microsoft.com/en-us/library/system.servicemodel.servicecontractattribute.sessionmode.aspx)属性。如果是这种情况，我认为您对合同中会话的概念有误解。通道是否是会话的取决于用于创建通道的绑定。该属性用于在运行时验证该合约的端点正在使用适当的绑定。`SessionMode`

对于会话模式的三个值：

*   **必需**：这意味着在合约的端点中使用的绑定**必须**支持会话。如果一个绑定不支持会话，那么客户端第一次使用时会抛出，或者服务主机会在Open期间抛出
*   **NotAllowed**：相反：如果端点中使用的绑定确实支持会话，则运行时将抛出（在打开服务或客户端时）
*   **Allowed**：默认值，合约可用于所有绑定，无论它们是否支持会话。

[该属性的MSDN 页面](http://msdn.microsoft.com/en-us/library/system.servicemodel.servicecontractattribute.sessionmode.aspx)的备注部分包含有关此属性的更多信息。

# python - 从 python 调用 EMBOSS 程序时遇到问题

> ID：11398603
> 
> 赞同：2
> 
> 时间：2012-07-09T15:47:25.773
> 
> 标签：python, subprocess, biopython, emboss

我无法通过 Python 调用名为 Sixpack 的 EMBOSS 程序（通过命令行运行）。

我通过 Windows 7、Python 3.23 版、Biopython 1.59 版、EMBOSS 6.4.0.4 版运行 Python。Sixpack 用于翻译所有六个阅读框中的 DNA 序列，并创建两个文件作为输出；识别ORF的序列文件，以及包含蛋白质序列的文件。

我可以从命令行成功调用三个必需的参数：( `-sequence [input file]`, `-outseq [output sequence file]`, `-outfile [protein sequence file]`)。我一直在使用 subprocess 模块代替 os.system，因为我读到它更强大、更通用。

以下是我的 python 代码，它运行没有错误，但不会产生所需的输出文件。

```
from Bio import SeqIO
import re
import os
import subprocess

infile = input('Full path to EXISTING .fasta file would you like to open: ')
outdir = input('NEW Directory to write outfiles to: ')
os.mkdir(outdir)
for record in SeqIO.parse(infile, "fasta"):

    print("Translating (6-Frame): " + record.id)

    ident=re.sub("\|", "-", record.id)

    print (infile)
    print ("Old record ID: " + record.id)
    print ("New record ID: " + ident)

    subprocess.call (['C:\memboss\sixpack.exe', '-sequence ' + infile, '-outseq ' + outdir + ident + '.sixpack', '-outfile ' + outdir + ident + '.format'])

    print ("Translation of: " + infile + "\nWritten to: " + outdir + ident) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T18:59:19.750

找到了答案。我使用错误的语法来调用子进程。这是正确的语法：

```
subprocess.call (['C:\memboss\sixpack.exe', '-sequence', infile, '-outseq', outdir + ident + '.sixpack', '-outfile', outdir + ident + '.format']) 
```

# c++ - 耳朵识别和上身haarcascade

> ID：11398605
> 
> 赞同：0
> 
> 时间：2012-07-09T15:47:26.470
> 
> 标签：c++, opencv, computer-vision, face-recognition, haar-wavelet

我根据Opencv文档制作了人脸识别程序。我还想找出耳朵的位置，但是在使用为耳朵提供的 Haarcascade 时，编译器说流中有一个非法字符。Question1-如何去除这个非法字符？Question2-OpenCV为上半身提供的haarcascade如何使用？下面提供了文档的链接

[http://docs.opencv.org/doc/tutorials/objdetect/cascade_classifier/cascade_classifier.html#cascade-classifier](http://docs.opencv.org/doc/tutorials/objdetect/cascade_classifier/cascade_classifier.html#cascade-classifier)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T12:56:33.713

文件头的引用定义中有非法（非 utf8）字符。从“书名”行中删除这些字符。在下面的引用中，这些字符显示为“。”

```
@INPROCEEDINGS{Castrillon11-caepia,
  author =       "Castrill\'on Santana, M. and Lorenzo Navarro, J. and Hern\'andez Sosa, D. ",
  title =        "An Study on Ear Detection and its Applications to Face Detection",
  booktitle =    "Conferencia de la Asociaci.n Espa.ola para la Inteligencia Artificial (CAEPIA)",
  year =         "2011",
  month =        "November",
  address =      "La Laguna, Spain",
  file = F
} 
```

# delphi - 将 TMainMenu 转换为 TActionBars

> ID：11398606
> 
> 赞同：3
> 
> 时间：2012-07-09T15:47:27.583
> 
> 标签：delphi, components, delphi-xe, converter

我有一个旧项目，我的表单上有标准菜单。菜单项由`TActions`我使用`TActionManager`.

我正在更新这个旧项目，现在想将我的菜单的外观更改`XP Style`为由 设置的`TActionManager`，以便它可以匹配`TToolBars`我的表单上已更改为`dsGradient`.

有没有一种非懒惰的方式来进行这种转变？

否则，这意味着我必须手动浏览我的表单，删除`TMainMenus`，在表单上放置 a`TActionMainMenuBar`然后开始创建`TActionBars`以再次填充菜单，我现在对你说实话我不想花这么多时间这样做。

因此，如果有一种方法可以以某种我有兴趣知道的方式自动进行转换，那么我就不必花太多时间手动更改它们。

同样，如果可以在不手动进行更改的情况下完成上述操作，我很想看看是否可以反向转换，例如将 TActionBar 菜单转换为 TMainMenu？

如果我必须手动完成，那就这样吧，但如果有更快更好的选择，那么我真的很想知道。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-15T16:11:14.460

我强烈建议您研究[ChoosPill](http://www.choosepill.com/index.htm)提供的以下转换器实用程序：

1.  [TB2KImpTb97](http://www.choosepill.com/components/CPCTB2KImpTb97.zip)
2.  [TB2K进口](http://www.choosepill.com/components/CPCTB2KImport.zip)

它们以**源代码**分发，并支持将**所有**相关*项*和*属性*从库存 VCL 组件**TMainMenu、TPopupMenu、TMenuItem**和**TToolBar 导入**到[Jordan Russel](http://www.jrsoftware.org/)著名的**Toolbar97/Toolbar2000**组件。

您还可以考虑看一看**TBXLib**转换器[源代码](https://code.google.com/p/tbxlib/source/browse/#svn%2Ftrunk%2FTools%2FConverter)。

如果您是[DevExpress](http://www.devexpress.com/)注册用户，还可以考虑深入研究 TdxBarConverter 的源代码。

它们可以作为您的一个很好的起点。

# entity-framework - 实体框架中的导航属性是否违反了得墨忒耳定律？

> ID：11398620
> 
> 赞同：1
> 
> 时间：2012-07-09T15:47:53.507
> 
> 标签：entity-framework, oop, law-of-demeter

我相信这是我要问的一个明确的是/否的问题，无论实施如何，它要么违法，要么不违法。所以我的问题是，在实体框架模型中创建的导航属性是否违反了得墨忒耳定律？我认为他们这样做是因为一个实体可能拥有太多的知识和对其导航属性实例的访问权限，如下所示：

```
Orders.Products.Price 
```

在上面的代码`Orders`中，主实体中包含一个导航属性`Products`。通常，我们必须深入了解该导航属性以访问该相关对象的详细信息。我假设拥有实例属性通常也不会违反法律吗？

帮助解决这个问题会很有帮助，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T19:46:49.733

是的，他们这样做，但没关系。严格遵循得墨忒耳定律几乎是不可能的——你必须做出妥协以保持高设计质量、高代码质量、可维护性和可读性。EF 提出了附加要求，这些要求主要与 EF 如何在对象和数据库记录之间进行映射有关。某些类型的映射 (EDMX) 允许您更改实体属性的可见性，以便您可以在内部或受保护的属性之上构建自己的抽象层，但您可能会丢失一些 EF 功能。

如果您对得墨忒耳定律和 ORM 工具感兴趣，您还应该查看域驱动设计和聚合根。

# html - lwp-rget 自动将文件格式更改为 .bin？

> ID：11398622
> 
> 赞同：1
> 
> 时间：2012-07-09T15:47:59.003
> 
> 标签：html, perl, filesystems, format, perl-module

我正在尝试将网站递归下载到本地目录。[LWP](http://search.cpan.org/perldoc?LWP)允许我`lwp-rget`这样做，但我遇到了以下问题：它保存了所有带有扩展名`.bin`而不是`.rpm`, `.xml`,`.html`等的文件。

我一直在尝试使用`--keepext=application/xml`或任何类型，但它继续将文件保存为`.bin`. 有什么办法可以`lwp-rget`使用更好的文件扩展名？谢谢。

* * *

在 Daxim 的帮助下修复了它。我现在可以调用 lwp-rget --keepext=application/octet-stream --hier *URL*并递归地将网站中出现的所有文件以适当的层次结构下载到本地目录。希望这对遇到类似问题的人有所帮助。谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T20:05:04.007

要全局影响该[`--keepext`选项](http://search.cpan.org/perldoc?lwp-rget)，请指定一个[`.media.types`文件](http://search.cpan.org/perldoc?LWP%3A%3AMediaTypes)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T21:17:33.910

无论您是否使用`--keepext`，服务器返回的 MIME 类型将决定使用哪个扩展`lwp-rget`。所以我们应该做的第一件事来调试它是确定返回的 MIME 类型。这可以使用

```
lwp-request -ed http://... | grep -oP 'Content-Type: \K.*' 
```

如果要`lwp-rget`使用 URL 中的扩展名，则需要使用`--keepext`.

如果不这样做，`lwp-rget`将通过调用[LWP::MediaTypes](http://search.cpan.org/perldoc?LWP%3a%3aMediaTypes)来确定要使用的扩展名`media_suffix`。例如，

*   `.xml`将用于`application/xml`
*   `.html`将用于`text/html`
*   `.bin`将用于`application/octet-stream`

# ruby-on-rails - Ruby Gemfile 和数据库适配器

> ID：11398623
> 
> 赞同：1
> 
> 时间：2012-07-09T15:48:12.423
> 
> 标签：ruby-on-rails, ruby, bundler

我正在开发一个开源 rails 应用程序，作为 rails 3 项目，它包含一个 Gemfile。该应用程序还依赖于用于活动记录的数据库适配器。我可以在 Gemfile 中指定一个特定的适配器（如`gem 'sqlite3'`），但这不是我想要做的。我宣传该应用程序与所有与活动记录兼容的适配器兼容。有什么方法可以指定应用程序依赖于单个数据库适配器（不在选择范围内），但一个就足够了？就像是

```
any_of do
  gem 'sqlite'
  gem 'mysql'
  etc.
end 
```

感谢您提供任何帮助或建议如何以不同的方式解决问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:11:45.183

我最近刚安装了一些会产生错误的东西，直到我意识到他们是如何处理这个问题的。

```
group :postgresql do
  gem 'pg'
end

group :mysql do
  gem 'mysql2'
end 
```

然后当你运行捆绑器时：

```
bundle install --without postgresql 
```

# java - geotools SEVERE：以下储物柜仍然在文件上读取锁

> ID：11398627
> 
> 赞同：13
> 
> 时间：2012-07-09T15:48:24.010
> 
> 标签：java, geotools

我正在使用 geotools 从 shapefile 中提取数据并将它们存储到 mysql 中。我的应用程序一直在工作，但我经常得到这个锁，我不明白为什么，因为它仍然有效

```
[root@website-qc filespool]# /usr/bin/java -jar /opt/mcmap/library/Application/geotools/mcgeotools.jar -t publisher -i 1/194/Namibia_SCLB12.shp -rid 12 -s
app get cmd option cast to int: 12
app passing region id to runconvert: 12
runconvert rid passed: 12
Jul 9, 2012 4:23:48 PM org.geotools.data.db2.DB2DataStoreFactory isAvailable
INFO: DB2 driver found: true
Database connection acquired
Coordinates length: 5390
Coordinates length: 5358
Coordinates length: 9932
Jul 9, 2012 4:28:14 PM org.geotools.data.shapefile.ShpFiles logCurrentLockers
SEVERE: The following locker still has a lock� read on file:/opt/mcmap/public/filespool/1/194/Namibia_SCLB12.prj by org.geotools.data.shapefile.prj.PrjFileReader
 it was created with the following stack trace
org.geotools.data.shapefile.ShpFilesLocker$Trace: Locking file:/opt/mcmap/public/filespool/1/194/Namibia_SCLB12.prj for read by org.geotools.data.shapefile.prj.PrjFileReader in thread main
    at org.geotools.data.shapefile.ShpFilesLocker.setTraceException(ShpFilesLocker.java:72)
    at org.geotools.data.shapefile.ShpFilesLocker.<init>(ShpFilesLocker.java:36)
    at org.geotools.data.shapefile.ShpFiles.acquireRead(ShpFiles.java:365)
    at org.geotools.data.shapefile.ShpFiles.getReadChannel(ShpFiles.java:813)
    at org.geotools.data.shapefile.prj.PrjFileReader.<init>(PrjFileReader.java:66)
    at com.domain.mcgeotools.convert.Converter.getCoordinateSystem(Converter.java:521)
    at com.domain.mcgeotools.convert.Converter.runConvert(Converter.java:106)
    at com.domain.mcgeotools.App.main(App.java:158)
Coordinates length: 5741
Coordinates length: 5374
Coordinates length: 4193
Coordinates length: 14161
Coordinates length: 5375
Coordinates length: 4212 
```

下面是我的应用程序代码

```
package com.domain.mcgeotools.convert;
import com.vividsolutions.jts.geom.Coordinate;
import com.vividsolutions.jts.geom.Geometry;
import java.io.BufferedWriter;
import java.io.IOException;
import java.io.File;
import java.net.ConnectException;
import java.net.MalformedURLException;
import java.util.Properties;
import java.util.Collection;
import java.util.HashMap;
import java.util.Iterator;
import java.util.Map;
import java.util.logging.Level;
import java.util.logging.Logger;
import java.sql.*;
import org.geotools.data.DataStore;
import org.geotools.data.DataStoreFinder;
import org.geotools.data.FeatureSource;
import org.geotools.data.shapefile.*;
import org.geotools.data.shapefile.prj.PrjFileReader;
import org.geotools.feature.FeatureCollection;
import org.geotools.feature.FeatureIterator;
import org.geotools.feature.simple.SimpleFeatureImpl;
import org.opengis.feature.Property;
import org.opengis.referencing.crs.CoordinateReferenceSystem;

public class Converter {

    protected String filePath = null;
    private Properties configFile = null;
    private String[] acceptedCoordinateSytems = {
        "Lat Long for MAPINFO type 0 Datum",
        "GCS_WGS_1984"
    };
    private HashMap sqlStatements = new HashMap();
    private int sqlCounter = 0;

    public Converter() throws IOException {

        /**
        * We load the configuration details from the properties file and use the config.  The config property
        * item stores things such as database connection details etc.
        */
        this.configFile = new Properties();
        this.configFile.load(this.getClass().getClassLoader().getResourceAsStream("mcgeotools-config.properties"));
    }

    protected void setFilePath(String filePath) {
        this.filePath = filePath;
    }

    protected String getFilePath() {
        return this.filePath;
    }

    /**
    * Converts the passed shape files and place the data into the RDBMS
    *
    * @param filePath
    * @param verbose
    * @param shrink
    * @return
    * @throws Exception
    */
    public int runConvert(String filePath, int regionId, boolean verbose, boolean shrink, String type) throws Exception {
        System.out.println("runconvert rid passed: " + regionId);
        ShapeFile shapeFile = new ShapeFile();
        if (!shapeFile.isShapeFile(filePath)) {
            System.out.println(filePath);
            throw new Exception("Not a shape file");
        }
        //we get the coordinate type from the shape file
        String coordinateSystem = null;
        try {
            coordinateSystem = this.getCoordinateSystem(filePath);
            if (verbose) {
                //Print to console.
                System.out.println("Coordinate System: " + coordinateSystem + " for " + filePath);
            }

        } catch (Exception cse) {
            Logger.getLogger(Converter.class.getName()).log(Level.SEVERE, null, cse);
        }

        boolean acceptedSystem = false;

        for (int i = 0; i < this.acceptedCoordinateSytems.length; i++) {
            if (this.acceptedCoordinateSytems[i].equalsIgnoreCase(coordinateSystem)) {
                acceptedSystem = true;
            }
        }

        if (!acceptedSystem) {
            throw new Exception("Not an excepted Coordinate System.");
        }

        //we now load the shapefile into the application
        File file = new File(filePath);

        if (file == null) {
            throw new Exception("Failed to open " + filePath);
        }

        Map connect = new HashMap();
        connect.put("url", file.toURI().toURL());

        DataStore dataStore = DataStoreFinder.getDataStore(connect);
        String[] typeNames = dataStore.getTypeNames();
        String typeName = typeNames[0];

        FeatureSource featureSource = dataStore.getFeatureSource(typeName);
        FeatureCollection collection = featureSource.getFeatures();
        FeatureIterator iterator = collection.features();

        //database connection
        Connection dbConn = null;

        int surveyDbId = 0;

        String localhostname = java.net.InetAddress.getLocalHost().getHostName();

        try {

            String dbUser = "", dbPwd = "", dbUrl = "";

            dbUser = this.configFile.getProperty("DB_USER");
            dbPwd = this.configFile.getProperty("DB_PASSWORD");
            dbUrl = "jdbc:" + this.configFile.getProperty("DB_CONNSTR");
            dbUrl = "jdbc:mysql://"+ localhostname +"/mcdatabase";

            // If publishing overite connection strings
            if(type.equals("publish")){
                dbUser = this.configFile.getProperty("DB_PB_USER");
                dbPwd = this.configFile.getProperty("DB_PB_PASSWORD");
                dbUrl = "jdbc:" + this.configFile.getProperty("DB_PB_CONNSTR");
            }

            Class.forName("com.mysql.jdbc.Driver").newInstance();
            dbConn = DriverManager.getConnection(dbUrl, dbUser, dbPwd);

            System.out.println("Database connection acquired");

            //switch off auto commits so that we run this as one transaction.
            dbConn.setAutoCommit(false);

            this.sqlStatements.put(this.sqlCounter, "START TRANSACTION");
            this.sqlCounter++;

            PreparedStatement surveyStmt = null;
            ResultSet rs = null;

            if(type.equals("convert")){

                //insert data in to the survey table and get the last row ID.
                surveyStmt = dbConn.prepareStatement("INSERT INTO surveys (name, guid, date_added, region_id, shrink) VALUES( ?, md5(now()), now(), ?, ? )");
                surveyStmt.setString(1, typeName.replaceAll("%20", " "));
                surveyStmt.setInt(2, regionId);
                surveyStmt.setBoolean(3, shrink);
                surveyStmt.executeUpdate();
                rs = surveyStmt.getGeneratedKeys();
                rs.first();
                surveyDbId = rs.getInt(1);

                this.sqlStatements.put(this.sqlCounter, "INSERT INTO surveys (name, guid, date_added, region_id, shrink) VALUES( '"+ typeName.replaceAll("%20", " ") +"', md5(now()), now(), "+ regionId +", "+ shrink +")");

            }else if(type.equals("publish")){
                //insert data in to the survey table and get the last row ID.
                surveyStmt = dbConn.prepareStatement("INSERT INTO surveys (name, guid, published, date_added, region_id, shrink) VALUES( ?, md5(now()), 1, now(), ?, ? )");
                surveyStmt.setString(1, typeName.replaceAll("%20", " "));
                surveyStmt.setInt(2, regionId);
                surveyStmt.setBoolean(3, shrink);
                surveyStmt.executeUpdate();
                rs = surveyStmt.getGeneratedKeys();
                rs.first();
                surveyDbId = rs.getInt(1);

                this.sqlStatements.put(this.sqlCounter, "INSERT INTO surveys (name, guid, published, date_added, region_id, shrink) VALUES( '"+ typeName.replaceAll("%20", " ") +"', md5(now()), 1, now(), "+ regionId +", "+ shrink +")");

            }
            this.sqlCounter++;

            rs.close();
            surveyStmt.close();

            //Total lat/long values to work center point.
            double totalLat = 0.0;
            double totalLong = 0.0;
            int totalLongLats = 0;

            while (iterator.hasNext()) {

                SimpleFeatureImpl feature = (SimpleFeatureImpl) iterator.next();
                Geometry sourceGeometry = (Geometry) feature.getDefaultGeometry();

                //we now need to enter a link between the survey and the line data.
                PreparedStatement lineStmt = null;
                String lineStmtSQL = "INSERT INTO `lines` (guid, date_added, survey_id) VALUES (md5(now()), now(), ?)";
                lineStmt = dbConn.prepareCall(lineStmtSQL);
                lineStmt.setInt(1, surveyDbId);
                lineStmt.executeUpdate();
                ResultSet lineRS = lineStmt.getGeneratedKeys();
                lineRS.first();
                int lineDbId = lineRS.getInt(1);

                this.sqlStatements.put(this.sqlCounter, "INSERT INTO `lines` (guid, date_added, survey_id) VALUES (md5(now()), now(), " +
                surveyDbId +")");
                this.sqlCounter++;

                lineRS.close();
                lineStmt.close();

                //we now look for the properties of the line that we are about to process.
                Collection<Property> coll = feature.getProperties();
                Iterator colIterator = coll.iterator();

                //we now look at inserting the line properties into the database.
                PreparedStatement linePropStmt = null;
                String linePropSQL = "INSERT INTO line_properties(`key`, `value`, `line_id`) VALUES(?, ?, ?)";
                linePropStmt = dbConn.prepareStatement(linePropSQL);

                while (colIterator.hasNext()) {

                    Property geoProp = (Property) colIterator.next();
                    if (verbose) {
                        System.out.println("prop name: " + geoProp.getName() + " Value: " + geoProp.getValue());
                    }

                    if (geoProp.getValue() != null && !geoProp.getName().toString().equals("the_geom")) {
                        //we then prepare the statment and execute for each property.
                        linePropStmt.setString(1, geoProp.getName().toString());
                        linePropStmt.setString(2, geoProp.getValue().toString());
                        linePropStmt.setInt(3, lineDbId);

                        linePropStmt.executeUpdate();

                        //add to sql command hashmap
                        this.sqlStatements.put(this.sqlCounter, "INSERT INTO line_properties(`key`, `value`, `line_id`) VALUES('" +
                        geoProp.getName().toString()+"', '"+
                        geoProp.getValue().toString()+"', "+lineDbId+")");
                        this.sqlCounter++;
                    }

                }

                //close the prepared statement now that we've finished with it.
                linePropStmt.close();

                //finally we populate the line coordinates into the database.
                Coordinate[] coordinates = sourceGeometry.getCoordinates();
                String lineName = feature.getID();
                if (verbose) {
                    System.out.println(lineName);
                }

                PreparedStatement coordStmt = null;
                String coordSQL = "INSERT INTO coordinates(`x`, `y`, line_id, sequence) VALUES(?, ?, ?, ?)";
                coordStmt = dbConn.prepareStatement(coordSQL);

                PreparedStatement lineStringStmt = null;
                String longLatSQL = "UPDATE `lines` SET longlat_string = ? WHERE line_id = ?";
                lineStringStmt = dbConn.prepareStatement(longLatSQL);

                /**
                * Used to build a full long lat string for fast lookups
                * when being used in KML/Google Maps
                */
                String longLatString = "";
                boolean first = true;
                int shotCount = 0;

                System.out.println("Coordinates length: "+ coordinates.length);

                for (int i = 0; i < coordinates.length; i++) {

                    if (verbose) {
                        System.out.println("x: " + coordinates[i].x + " - Y: " + coordinates[i].y);
                    }

                    //add to the long lat counter to find center point
                    totalLat += coordinates[i].x;
                    totalLong += coordinates[i].y;
                    totalLongLats++;

                    coordStmt.setString(1, Double.toString(coordinates[i].x));
                    coordStmt.setString(2, Double.toString(coordinates[i].y));
                    coordStmt.setInt(3, lineDbId);
                    coordStmt.setInt(4, i);

                    coordStmt.executeUpdate();

                    this.sqlStatements.put(this.sqlCounter, "INSERT INTO coordinates(`x`, `y`, line_id, sequence) VALUES('"+
                    Double.toString(coordinates[i].x) +"', '"+
                    Double.toString(coordinates[i].y) +"', "+lineDbId+", "+i+")");
                    this.sqlCounter++;

                    //now we build/update a string for the full coordinates.
                    if (first) {

                        longLatString = Double.toString(coordinates[i].x) + "," + Double.toString(coordinates[i].y);

                        first = false;

                    } else {

                        // Not implemented function fully, to strip long lats to start and end points only
                        if(shrink){

                            if(i == (coordinates.length -1)){
                                longLatString += ",0 " + Double.toString(coordinates[i].x) + "," + Double.toString(coordinates[i].y);
                            }

                        }else{
                            /* // testing this if
                            if( coordinates.length < 10 && shotCount == 2 ){
                                longLatString += ",0 " + Double.toString(coordinates[i].x) + "," + Double.toString(coordinates[i].y);
                                shotCount = 0;

                            }else */
                                //if( coordinates.length >= 10 && coordinates.length < 30 && shotCount == 4 ){
                                if( coordinates.length < 30 && shotCount == 4 ){
                                    longLatString += ",0 " + Double.toString(coordinates[i].x) + "," + Double.toString(coordinates[i].y);
                                    shotCount = 0;

                                }else if( coordinates.length >= 30 && coordinates.length < 100 && shotCount == 9 ){
                                    longLatString += ",0 " + Double.toString(coordinates[i].x) + "," + Double.toString(coordinates[i].y);
                                    shotCount = 0;

                                }else if( coordinates.length >= 100 && coordinates.length < 1000 && shotCount == 49 ){
                                    longLatString += ",0 " + Double.toString(coordinates[i].x) + "," + Double.toString(coordinates[i].y);
                                    shotCount = 0;

                                }else if( coordinates.length >= 1000 && coordinates.length < 10000 && shotCount == 99 ){
                                    longLatString += ",0 " + Double.toString(coordinates[i].x) + "," + Double.toString(coordinates[i].y);
                                    shotCount = 0;

                                }else if( coordinates.length >= 10000 && shotCount == 199 ){
                                    longLatString += ",0 " + Double.toString(coordinates[i].x) + "," + Double.toString(coordinates[i].y);
                                    shotCount = 0;
                                }

                                // Make sure to get last co-ordinate of line
                                if( i == (coordinates.length-1) ){ // -1 since coutn starts from zero
                                longLatString += ",0 " + Double.toString(coordinates[i].x) + "," + Double.toString(coordinates[i].y);
                                System.out.println("Last coordinate stored: " + longLatString);
                                shotCount = 0;
                            }
                        }

                    }

                    shotCount ++;
                }

                /**
                * Update the line table to include the precreated line string.
                */
                lineStringStmt.setString(1, longLatString);
                lineStringStmt.setInt(2, lineDbId);
                lineStringStmt.executeUpdate();

                this.sqlStatements.put(this.sqlCounter, "UPDATE `lines` SET longlat_string = '"+longLatString+"' WHERE line_id = " + lineDbId);
                this.sqlCounter++;

                lineStringStmt.close();
                coordStmt.close();

            }

            //finally we update the center point
            PreparedStatement centerPointStmt = null;
            String centerPointSQL = "UPDATE `surveys` SET center_point = ? WHERE survey_id = ?";
            centerPointStmt = dbConn.prepareStatement(centerPointSQL);

            double centerLat = totalLat/totalLongLats;
            double centerLong = totalLong/totalLongLats;

            String centerPoint = Double.toString(centerLat) + ", " + Double.toString(centerLong);

            centerPointStmt.setString(1, centerPoint);
            centerPointStmt.setInt(2, surveyDbId);
            centerPointStmt.executeUpdate();
            centerPointStmt.close();

            this.sqlStatements.put(this.sqlCounter, "UPDATE `surveys` SET center_point = '"+centerPoint+"' WHERE survey_id = "+surveyDbId);
            this.sqlCounter++;

            //we now commit the transaction
            dbConn.commit();
            //now we can close the database connection.
            dbConn.close();

            this.sqlStatements.put(this.sqlCounter,"COMMIT");
            this.sqlCounter++;

            BufferedWriter out = new BufferedWriter(new java.io.FileWriter(this.configFile.getProperty("SQL_FILE").toString()));

            for(int i = 0; i < this.sqlStatements.size(); i++){

                out.write(this.sqlStatements.get(i) + ";" + "\n");

            }

            //close file connection
            out.close();
            System.out.println("End transaction");

        } catch (Exception ex) {
            System.out.println();
            System.out.println("Message:  "+ex.getMessage());
            if(ex.getMessage().trim().contains("Communications link failure")){
                System.out.println("Check there is a mysql connection and retry");
                System.out.println();
                System.exit(0);

            }else{

                Logger.getLogger(Converter.class.getName()).log(Level.SEVERE, null, ex);

                //we've errored so we need to toll back the connection.
                dbConn.rollback();

                //we now insert a message into the audit log.

                String auditSQL = "INSERT INTO auditlog (username, date_added, message, guid, type)" + "VALUES('mcgeotools', now(), ?, md5(now()), ?)";

                PreparedStatement auditStmt = dbConn.prepareStatement(auditSQL);

                //we want to know which survey failed to import and we need the stacktrace message.
                String auditMessage = "Error whilst populating Survey " + typeName + " with error message : " + ex.getMessage();

                auditStmt.setString(1, auditMessage);
                auditStmt.setString(2, "error"); //error

                auditStmt.execute();

                dbConn.commit();
            }

        } finally {

            //close the iterator
            iterator.close();

            //commit any transaction and close the connection to the database if it is open.
            if (dbConn != null && !dbConn.isClosed()) {
                try {
                    dbConn.commit();
                    dbConn.close();
                } catch (Exception dbex) {
                    System.out.println("Communications failure, check there is a connection to mysql");
                    Logger.getLogger(Converter.class.getName()).log(Level.SEVERE, null, dbex);
                }
            }

            //close file connection

        }

        return surveyDbId;
    }

    /**
    * Get the coordinate system that is used in the shape file
    *
    * @param String shpFilePath
    * @return String
    */
    private String getCoordinateSystem(String shpFilePath) throws MalformedURLException, IOException {
        String coordType = null;
        ShpFiles shapeFiles = new ShpFiles(shpFilePath);
        PrjFileReader fileReader = new PrjFileReader(shapeFiles);
        CoordinateReferenceSystem coordSystem = fileReader.getCoodinateSystem();
        coordType = coordSystem.getName().toString();
        return coordType;
    }
} 
```

@Andre 错误

```
Feb 22, 2013 12:03:54 PM org.geotools.data.shapefile.ng.files.ShpFiles logCurrentLockers
SEVERE: The following locker still has a lock: read on file:/tmp/24/FozDoAmazonasPhase2.shp by org.geotools.data.shapefile.ng.shp.ShapefileReader
Feb 22, 2013 12:03:54 PM org.geotools.data.shapefile.ng.files.ShpFiles logCurrentLockers
SEVERE: The following locker still has a lock: read on file:/tmp/24/FozDoAmazonasPhase2.shx by org.geotools.data.shapefile.ng.shp.IndexFile
Feb 22, 2013 12:03:54 PM org.geotools.data.shapefile.ng.files.ShpFiles logCurrentLockers
SEVERE: The following locker still has a lock: read on file:/tmp/24/FozDoAmazonasPhase2.dbf by org.geotools.data.shapefile.ng.dbf.DbaseFileReader
Feb 22, 2013 12:04:39 PM com.spectrumasa.mcgeotools.App main
SEVERE: null
java.lang.IllegalArgumentException: Expected requestor org.geotools.data.shapefile.ng.dbf.DbaseFileReader@1966c114 to have locked the url but it does not hold the lock for the URL
    at org.geotools.data.shapefile.ng.files.ShpFiles.unlockRead(ShpFiles.java:433)
    at org.geotools.data.shapefile.ng.files.FileChannelDecorator.implCloseChannel(FileChannelDecorator.java:149)
    at java.nio.channels.spi.AbstractInterruptibleChannel.close(AbstractInterruptibleChannel.java:114)
    at org.geotools.data.shapefile.ng.dbf.DbaseFileReader.close(DbaseFileReader.java:279)
    at org.geotools.data.shapefile.ng.ShapefileFeatureReader.close(ShapefileFeatureReader.java:248)
    at org.geotools.data.store.ContentFeatureCollection$WrappingFeatureIterator.close(ContentFeatureCollection.java:227)
    at com.spectrumasa.mcgeotools.convert.Converter.runConvert(Converter.java:487)
    at com.spectrumasa.mcgeotools.App.main(App.java:100) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T14:41:28.497

您需要在 getCoordinateSystem() 方法中关闭 PrjFileReader：

```
private String getCoordinateSystem(String shpFilePath) throws MalformedURLException, IOException {
    PrjFileReader fileReader = null
    try {
        ShpFiles shapeFiles = new ShpFiles(shpFilePath);
        fileReader = new PrjFileReader(shapeFiles);
        CoordinateReferenceSystem coordSystem = fileReader.getCoodinateSystem();
        String coordType = coordSystem.getName().toString();
        return coordType;
    } finally {
        if (fileReader != null) {
            fileReader.close();
        }
    }
} 
```

# c# - 如何使用 C# 控制台应用程序的配置替换

> ID：11398631
> 
> 赞同：0
> 
> 时间：2012-07-09T15:48:41.610
> 
> 标签：c#, visual-studio-2010, console-application, configurationmanager

有没有一种方法可以在 Visual Studio 2010 中为 C# 控制台应用程序进行配置替换，类似于通过 asp.net/web 应用程序项目的部署项目完成的配置？我有不同的连接字符串和邮件设置用于测试和生产环境，因此我需要一种在进行部署时切换设置的简单方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:00:33.737

是的你可以。您应该在项目中创建两个文件夹，例如“config1”和“config2”。放入适合您需要的设置的每个 app.config 文件。创建两个项目配置，如“Release1”和“Release2”。在编辑器中打开您的 csproj 文件并查找包含这两个文件的行。在每个 xml 节点中，您可以检查当前选择的配置是什么，并告诉 VS 是否编译每个文件。找不到示例，但尝试查找“多个 app.config”。

编辑：刚刚发现这个，看起来很棒。用于 VS 的插件，用于在 app.config 中使用转换，例如 web.config [http://www.hanselman.com/blog/SlowCheetahWebconfigTransformationSyntaxNowGeneralizedForAnyXMLConfigurationFile.aspx](http://www.hanselman.com/blog/SlowCheetahWebconfigTransformationSyntaxNowGeneralizedForAnyXMLConfigurationFile.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:11:46.023

您还可以使用#if DEBUG，如下所示：

```
using System;

namespace IfDebug
{
    class Program
    {
        static void Main(string[] args)
        {
            string connectionString;

#if DEBUG
            connectionString = "a";
#else
            connectionString = "b";
#endif
            Console.WriteLine(connectionString);

            Console.ReadLine();
        }
    }
} 
```

如果`Solution Configuration`对话框设置为`Debug`，则打印'a'，否则打印'b'。

[微软在这里](http://msdn.microsoft.com/en-us/library/4y6tbswk.aspx)解释得更好。

# php - 使用标头时无法在 PHP 中检索会话变量（“位置：

> ID：11398633
> 
> 赞同：-1
> 
> 时间：2012-07-09T15:48:45.463
> 
> 标签：php, header, session-variables

一旦用户在登录页面上提供用户名和密码，然后将其提交到另一个页面，该页面具有 -

```
session_start();
$_SESSION['username']=$_POST["username"]; 
```

基于一些验证，页面被重定向到基于以下代码的不同页面

```
session_write_close();
/* Redirect browser */
header("Location: ../menu.php"); 
```

然后，在 menu.php 上，我想做的就是 -

```
<?php 
session_start();
echo "User is ".$_SESSION['username']; 
?> 
```

但它不工作:(。虽然在同一页面上工作，但在重定向后不工作。尝试使用 setcookie 等但没有运气。感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T15:55:09.637

根据您的标题位置，我认为您正在重定向到父文件夹。如果您不定义 cookie 路径和域，这将搞砸您的会话。这可以通过以下函数来实现：[session_set_cookie_params](http://www.php.net/manual/en/function.session-set-cookie-params.php)

# ruby-on-rails - 无法安装 ffi gem

> ID：11398634
> 
> 赞同：1
> 
> 时间：2012-07-09T15:48:48.637
> 
> 标签：ruby-on-rails, capybara, ffi

我正在尝试在 Windows 7 x64 中进行捆绑安装，但在为 ffi gem 安装本机扩展时出错。我的 Gemfile 没有 ffi gem。唯一的依赖是在“水豚”中。

第二个奇怪的事情是水豚在我的 Gemfile 中仅用于“测试”环境，但是当我进行“捆绑安装”时，应该使用开发环境。为什么它解析“测试”部分？

```
source 'http://rubygems.org'
gem 'rake', '0.9.2.2'
gem 'rails', '3.2.1'

...

group :test do
  if RUBY_PLATFORM =~ /(win32|w32)/
    gem 'win32console'
  end
  ...
  gem 'capybara'
  ...
end 
```

我可以安装以前版本的 ffi，但水豚需要新版本。

错误文字：

```
Installing ffi (1.0.11) with native extensions
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

        C:/Ruby193/bin/ruby.exe extconf.rb
checking for ffi.h... no
checking for ffi.h in /usr/local/include... no
checking for rb_thread_blocking_region()... yes
checking for ruby_native_thread_p()... yes
checking for rb_thread_call_with_gvl()... yes
creating extconf.h
creating Makefile

make
generating ffi_c-i386-mingw32.def
Configuring libffi
make -C "/c/Ruby193/lib/ruby/gems/1.9.1/gems/ffi-1.0.11/ext/ffi_c/libffi"
make[1]: Entering directory `/c/Ruby193/lib/ruby/gems/1.9.1/gems/ffi-1.0.11/ext/ffi_c/libffi'
make "AR_FLAGS=" "CC_FOR_BUILD=" "CFLAGS=" "CXXFLAGS=" "CFLAGS_FOR_BUILD=" "CFLAGS_FOR_TARGET=" "INSTALL=/usr/bin/in
stall -c" "INSTALL_DATA=/usr/bin/install -c -m 644" "INSTALL_PROGRAM=/usr/bin/install -c" "INSTALL_SCRIPT=/usr/bin/i
nstall -c" "JC1FLAGS=" "LDFLAGS=" "LIBCFLAGS=" "LIBCFLAGS_FOR_TARGET=" "MAKE=make" "MAKEINFO=/bin/sh /c/Ruby193/lib/
ruby/gems/1.9.1/gems/ffi-1.0.11/ext/ffi_c/libffi/missing --run makeinfo " "PICFLAG=" "PICFLAG_FOR_TARGET=" "RUNTESTF
LAGS=" "SHELL=/bin/sh" "exec_prefix=/usr/local" "infodir=/usr/local/share/info" "libdir=/usr/local/lib" "prefix=/usr
/local" "AR=ar" "AS=as" "CC=gcc" "CXX=g++" "LD=c:/program files (x86)/mingw/mingw32/bin/ld.exe" "NM=/c/Program Files
 (x86)/MinGW/bin/nm" "RANLIB=ranlib" "DESTDIR=" all-recursive
make[2]: Entering directory `/c/Ruby193/lib/ruby/gems/1.9.1/gems/ffi-1.0.11/ext/ffi_c/libffi'
Making all in include
make[3]: Entering directory `/c/Ruby193/lib/ruby/gems/1.9.1/gems/ffi-1.0.11/ext/ffi_c/libffi/include'
make[3]: Nothing to be done for `all'.
make[3]: Leaving directory `/c/Ruby193/lib/ruby/gems/1.9.1/gems/ffi-1.0.11/ext/ffi_c/libffi/include'
Making all in testsuite
make[3]: Entering directory `/c/Ruby193/lib/ruby/gems/1.9.1/gems/ffi-1.0.11/ext/ffi_c/libffi/testsuite'
make[3]: Nothing to be done for `all'.
make[3]: Leaving directory `/c/Ruby193/lib/ruby/gems/1.9.1/gems/ffi-1.0.11/ext/ffi_c/libffi/testsuite'
Making all in man
make[3]: Entering directory `/c/Ruby193/lib/ruby/gems/1.9.1/gems/ffi-1.0.11/ext/ffi_c/libffi/man'
make[3]: Nothing to be done for `all'.
make[3]: Leaving directory `/c/Ruby193/lib/ruby/gems/1.9.1/gems/ffi-1.0.11/ext/ffi_c/libffi/man'
make[3]: Entering directory `/c/Ruby193/lib/ruby/gems/1.9.1/gems/ffi-1.0.11/ext/ffi_c/libffi'
/bin/sh ./libtool --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.  -I. -I./include -Iinclude -I./src  -Wall -g -fe
xceptions  -c -o src/debug.lo src/debug.c
libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I./include -Iinclude -I./src -Wall -g -fexceptions -c src/debug.c  -
DDLL_EXPORT -DPIC -o src/.libs/debug.o
/bin/sh ./libtool --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.  -I. -I./include -Iinclude -I./src  -Wall -g -fe
xceptions  -c -o src/prep_cif.lo src/prep_cif.c
libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I./include -Iinclude -I./src -Wall -g -fexceptions -c src/prep_cif.c
  -DDLL_EXPORT -DPIC -o src/.libs/prep_cif.o
/bin/sh ./libtool --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.  -I. -I./include -Iinclude -I./src  -Wall -g -fe
xceptions  -c -o src/types.lo src/types.c
libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I./include -Iinclude -I./src -Wall -g -fexceptions -c src/types.c  -
DDLL_EXPORT -DPIC -o src/.libs/types.o
/bin/sh ./libtool --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.  -I. -I./include -Iinclude -I./src  -Wall -g -fe
xceptions  -c -o src/raw_api.lo src/raw_api.c
libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I./include -Iinclude -I./src -Wall -g -fexceptions -c src/raw_api.c
 -DDLL_EXPORT -DPIC -o src/.libs/raw_api.o
/bin/sh ./libtool --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.  -I. -I./include -Iinclude -I./src  -Wall -g -fe
xceptions  -c -o src/java_raw_api.lo src/java_raw_api.c
libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I./include -Iinclude -I./src -Wall -g -fexceptions -c src/java_raw_a
pi.c  -DDLL_EXPORT -DPIC -o src/.libs/java_raw_api.o
/bin/sh ./libtool --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.  -I. -I./include -Iinclude -I./src  -Wall -g -fe
xceptions  -c -o src/closures.lo src/closures.c
libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I./include -Iinclude -I./src -Wall -g -fexceptions -c src/closures.c
  -DDLL_EXPORT -DPIC -o src/.libs/closures.o
/bin/sh ./libtool --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.  -I. -I./include -Iinclude -I./src  -Wall -g -fe
xceptions  -c -o src/x86/ffi.lo src/x86/ffi.c
libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I./include -Iinclude -I./src -Wall -g -fexceptions -c src/x86/ffi.c
 -DDLL_EXPORT -DPIC -o src/x86/.libs/ffi.o
/bin/sh ./libtool   --mode=compile gcc -DHAVE_CONFIG_H -I.  -I. -I./include -Iinclude -I./src  -I. -I./include -Iinc
lude -I./src  -c -o src/x86/win32.lo src/x86/win32.S
libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I./include -Iinclude -I./src -I. -I./include -Iinclude -I./src -c sr
c/x86/win32.S  -DDLL_EXPORT -DPIC -o src/x86/.libs/win32.o
/bin/sh ./libtool --tag=CC   --mode=link gcc -Wall -g -fexceptions  -version-info `grep -v '^#' ./libtool-version` -
no-undefined  -o libffi.la -rpath /usr/local/lib src/debug.lo src/prep_cif.lo src/types.lo src/raw_api.lo src/java_r
aw_api.lo src/closures.lo    src/x86/ffi.lo src/x86/win32.lo
libtool: link: gcc -o .libs/libffi.dll.a  src/.libs/debug.o src/.libs/prep_cif.o src/.libs/types.o src/.libs/raw_api
.o src/.libs/java_raw_api.o src/.libs/closures.o src/x86/.libs/ffi.o src/x86/.libs/win32.o     `echo "X" | /usr/bin/
sed -e 1s/^X// -e 's/ -lc$//'` -link -dll
c:/program files (x86)/mingw/bin/../lib/gcc/mingw32/4.5.2/../../../../mingw32/bin/ld.exe: cannot find -link
collect2: ld returned 1 exit status
make[3]: *** [libffi.la] Error 1
make[3]: Leaving directory `/c/Ruby193/lib/ruby/gems/1.9.1/gems/ffi-1.0.11/ext/ffi_c/libffi'
make[2]: *** [all-recursive] Error 1
make[2]: Leaving directory `/c/Ruby193/lib/ruby/gems/1.9.1/gems/ffi-1.0.11/ext/ffi_c/libffi'
make[1]: *** [all] Error 2
make[1]: Leaving directory `/c/Ruby193/lib/ruby/gems/1.9.1/gems/ffi-1.0.11/ext/ffi_c/libffi'
make: *** ["/c/Ruby193/lib/ruby/gems/1.9.1/gems/ffi-1.0.11/ext/ffi_c/libffi"/.libs/libffi_convenience.a] Error 2

Gem files will remain installed in C:/Ruby193/lib/ruby/gems/1.9.1/gems/ffi-1.0.11 for inspection.
Results logged to C:/Ruby193/lib/ruby/gems/1.9.1/gems/ffi-1.0.11/ext/ffi_c/gem_make.out
An error occured while installing ffi (1.0.11), and Bundler cannot continue.
Make sure that `gem install ffi -v '1.0.11'` succeeds before bundling. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T09:07:17.193

在 Rubyinstaller wiki 上查看此故障排除指南：[https](https://github.com/oneclick/rubyinstaller/wiki/Troubleshooting#wiki-gems_fails_comspec_autorun) ://github.com/oneclick/rubyinstaller/wiki/Troubleshooting#wiki-gems_fails_comspec_autorun 。可能有任何帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:40:44.907

FFI 1.3.1 版本解决了这个问题。仍然无法安装 Capybara。

# c# - .net 4.0 中的字符串操作

> ID：11398637
> 
> 赞同：1
> 
> 时间：2012-07-09T15:49:04.413
> 
> 标签：c#, string

我已经有一段时间没有接触编程了。我有一些要格式化的字符串。它们看起来像这样：

```
,SUM(CASE WHEN [Level] IN('4') AND Program = 1 THEN 1 ELSE 0 END) as CNT1
,SUM(CASE WHEN [Level] IN('3') AND Program = 1 THEN 1 ELSE 0 END) as CNT2
,SUM(CASE WHEN [Level] IN('2') AND Program = 1 THEN 1 ELSE 0 END) as CNT3
,SUM(CASE WHEN [Level] IN('1') AND Program = 1 THEN 1 ELSE 0 END) as CNT4
,SUM(CASE WHEN [Level] IN('0') AND Program = 1 THEN 1 ELSE 0 END) as CNT5 
```

我想把它改成

```
,CNT1 = SUM(CASE WHEN [Level] IN('4') AND Program = 1 THEN 1 ELSE 0 END) 
,CNT2 = SUM(CASE WHEN [Level] IN('3') AND Program = 1 THEN 1 ELSE 0 END) 
,CNT3 = SUM(CASE WHEN [Level] IN('2') AND Program = 1 THEN 1 ELSE 0 END) 
,CNT4 = SUM(CASE WHEN [Level] IN('1') AND Program = 1 THEN 1 ELSE 0 END) 
,CNT5 = SUM(CASE WHEN [Level] IN('0') AND Program = 1 THEN 1 ELSE 0 END) 
```

现在我有一个`multiline textbox`我粘贴字符串的地方。我想单击一个按钮并将其格式化为第二个文本框。

这是我到目前为止所尝试的。但我不确定使用什么字符串函数以我想要的方式格式化它。

```
 List<String> Items = new List<string>();
            string frTxt;
            foreach (string lne in txtM.Lines)
            {
                frTxt = "";
                frTxt = lne;

            } 
```

多行文本框在哪里`txtM`。如果我`Console.WriteLine(lne);`在循环中这样做，它会成功循环。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:06:09.627

假设格式总是

> ,<text_1> 作为 <text_2>

以下将其转换为：

> ,<文本_2> = <文本_1>

```
txtM.Lines = txtM.Lines.Select(l => Regex.Replace(l, ",(.+) as (.+?)$", ",$2 = $1")).ToArray(); 
```

正则表达式的解释：

*   "," 和 " as " 匹配那些确切的字符串
*   "(.+)" 贪婪匹配至少一个字符，并将其捕获为第一组
*   "(.+?)" 非贪婪匹配至少一个字符并将其捕获为第二组
*   "$" 匹配行尾

作为结合贪婪和非贪婪匹配的结果，我们强制“as ...”作为最后一次出现（所以如果字符串恰好在其中的某个地方包含“as”，那无关紧要）。通过添加“$”，我们确保第二次捕获将所有内容带到行尾（否则，由于它是非贪婪匹配，它只会匹配“ as”之后的第一个字符，这不是我们想要的）。

替换只是使用正则表达式捕获的两个组构造新字符串，添加“=”。我们还在开头手动添加了“，”，因为我们的正则表达式匹配它，因此它将被替换字符串替换。（这可以克服，但可能会使正则表达式更复杂）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T15:57:45.330

好吧，如果它只是那里的开始和结束，你可以做

```
myString.Replace(",", ",CNT1 = ").Replace(" as CNT1", ""); 
```

使用内置`string`方法有很多方法可以做到这一点

[查看字符串文档](http://msdn.microsoft.com/en-us/library/system.string.aspx)

这是一个功能齐全且经过测试的代码片段：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Text.RegularExpressions;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            string[] strArr = 
            {
            ",SUM(CASE WHEN [Level] IN('4') AND Program = 1 THEN 1 ELSE 0 END) as CNT1",
            ",SUM(CASE WHEN [Level] IN('3') AND Program = 1 THEN 1 ELSE 0 END) as CNT2",
            ",SUM(CASE WHEN [Level] IN('2') AND Program = 1 THEN 1 ELSE 0 END) as CNT3",
            ",SUM(CASE WHEN [Level] IN('1') AND Program = 1 THEN 1 ELSE 0 END) as CNT4",
            ",SUM(CASE WHEN [Level] IN('0') AND Program = 1 THEN 1 ELSE 0 END) as CNT5",
            };

            //intellisence didn't like assignment in the foreach loop
            for(int i=0; i<strArr.Length; i++)
            {
                string cnt = Regex.Match(strArr[i], @"CNT\d+$").Value;
                strArr[i] = strArr[i].Replace(",", String.Format(",{0} = ",cnt)).Replace(String.Format(" as {0}", cnt), "");
            }

            foreach(string str in strArr)
            {
                Console.WriteLine(str);
            }

        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T15:58:44.250

查看[Regex.Replace](http://msdn.microsoft.com/en-us/library/ht1sxswy.aspx)与正则表达式匹配和[Regex 语言](http://msdn.microsoft.com/en-us/library/az24scfc)。

您想使用分组构造`(...)`来捕获插入子字符串的位置，并使用第二个构造来捕获要插入的子字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T16:02:17.327

这是非常具体的。您的输入字符串是否总是具有这种格式？在这种情况下，您可以使用以下内容：

```
 string s = textBox1.Text;
        var result = s.Split(',').ToList();
        result.ForEach(x =>
        {
            int removeAfter = x.LastIndexOf(" as CNT");
            string cntNum = x.Substring(x.LastIndexOf("CNT"), x.Length - 1);
            x = string.Format(",{0} = {1}", cntNum, x.Substring(0, removeAfter));
        }); 
```

但我强烈建议研究使用正则表达式进行搜索和替换。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-09T16:08:04.313

我假设您正在使用带有 multines 的richTextbox，请参阅示例如何做到这一点

```
private void FormatLinesInTextBox()
{
    int cnt = 1;
    foreach (string line in richTextBox1.Lines)
    {
        string cntNumber = cntNumber = "CNT" + cnt;
        richTextBox1.Lines[cnt - 1] = "," + cntNumber + line.Replace(cntNumber, string.Empty);
        cnt++;
    }
} 
```

# microsoft-test-manager - 如何摆脱 MTM 中出现的旧版本的自定义诊断数据适配器

> ID：11398638
> 
> 赞同：0
> 
> 时间：2012-07-09T15:49:05.067
> 
> 标签：microsoft-test-manager

我正在使用 MTM 2010 运行自动化测试，并实现了一个自定义诊断数据适配器 (DDA)，用于收集在测试运行时创建的日志文件。

当我对 DDA 实现进行一些更改并增加其程序集版本并将新版本部署到 MTM 正在运行的机器上时，此 DDA 再次出现在 MTM 中的 DDA 列表中（同时我在列表中有三个）

**如何摆脱 MTM 中出现的旧版本 DDA？**

似乎每个程序集版本（GUID）都在 TFS 上存储了一些“工件”。

如果我尝试在 MTM 中设置较旧版本的 DDA，我会收到一条警告说编辑器无法启动，因此我只能编辑 DDA 设置的 XML 表示。

那是一种“验证”，旧版本真的不再安装了。看起来，如果某个特定版本的 DDA 第一次被 MTM 识别，那么有关它的信息将存储在 TFS 的某个地方......

***附加信息：***

如果我部署新版本的 DDA，属于旧版本的文件将被覆盖。我将新版本部署到：

*   一台机器 MTM 正在运行（为了能够设置这个 DDA）
*   运行我的测试的虚拟机（安装了测试代理）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T15:12:59.863

我终于找到了解决方案，请参阅以下博客： [Unregister a Data Collector from TFS](http://blogs.msdn.com/b/shivash/archive/2012/01/20/unregister-a-data-collector-from-tfs.aspx)

# eclipse - 告诉 Eclipse 仅自动完成方法名称？

> ID：11398640
> 
> 赞同：12
> 
> 时间：2012-07-09T15:49:06.937
> 
> 标签：eclipse, autocomplete, eclipse-jdt

假设我正在编辑一行...

```
obj.fooBar(x, y, z); 
```

我想将方法​​名称更改为`fooSomethingElse`，但保留大部分参数。如果我删除全部或部分名称，然后使用内容辅助，它会完成方法名称，但会启动一个新的 arg 列表......

```
obj.fooSomethingElse(arg1, arg2)(x, y, z)
                     ^---- this arg is highlighted for editing 
```

我经常不得不删除“（arg1，arg2）”。我可以在首选项中关闭“填充方法参数”，然后我只需要删除“（）”，但这仍然很烦人。是否有另一个命令仅完成方法名称。理想情况下，它只是通用内容辅助的单独命令和键组合，因此我可以根据需要调用其中任何一个。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-09T15:56:46.293

本质上，您正在寻找一种通过内容辅助在插入和替换之间切换的方法。默认行为是插入。您可以在内容辅助选择对话框中切换此行为，方法是在选择完成时按住 Ctrl 键。
更多信息 - [http://blog.deepakazad.com/2012/06/jdt-tip-toggle-between-inserting-and.html](http://blog.deepakazad.com/2012/06/jdt-tip-toggle-between-inserting-and.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T15:51:19.007

我认为您只需要按 Tab 而不是 Enter 即可自动完成它。然后它将保留您现有的参数。

# android - Android禁用特定字符串的自动完成

> ID：11398642
> 
> 赞同：1
> 
> 时间：2012-07-09T15:49:10.433
> 
> 标签：android, autocomplete, autocompletetextview

我现在设置了 AutoCompleteTextView，但我想阻止它自动完成某个字符串（用户必须手动输入才能获得结果）。现在它正在自动完成整个列表，但我想知道是否有任何方法可以使自动完成具有选择性。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:27:45.267

虽然我自己没有这样做，但我认为如果您在 Adapter 中提供自己的 getFilter 方法实现，您可以控制是否显示任何结果。所以基本上你会定义类

```
public class AutoCompleteAdapter extends ArrayAdapter<String> implements Filterable 
```

然后覆盖 getFilter 方法

```
@Override
public Filter getFilter() {
    Filter myFilter = new Filter() {
        @Override
        protected FilterResults performFiltering(CharSequence constraint) {
        ......
        }

        @Override
        protected void publishResults(CharSequence contraint, FilterResults results) {
        ....
        } 
```

# php - 连不上mysql，试了很多

> ID：11398643
> 
> 赞同：1
> 
> 时间：2012-07-09T15:49:12.683
> 
> 标签：php, mysql, database, phpmyadmin, mysqli

我已经阅读了大量的线程和解决方案，我并不是故意尝试再写*一篇*这些帖子。

现在那已经不碍事了

如果我在我的本地 osx 文件夹中运行它（打开网络共享），我会得到一个无法连接的错误：

```
<?php

$db = mysql_connect("localhost", "root", "password");

if (!$db) {
die('Could not connect' . mysql_error());
}
echo 'Connected successfully'; 
```

然而，当我去终端并运行以下它工作正常：

```
mysql -u root -h 'localhost' -p
password<enter>

Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 1030
Server version: 5.5.25a MySQL Community Server (GPL) 
```

`/tmp/mysql.sock`我也更新了 php.ini以指向

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:54:07.777

如果您刚刚开始使用 PHP5，则不应使用`mysql_connect`，而是使用 （*[不鼓励](http://us2.php.net/mysql_connect)**使用 mysql 扩展**）*。[`mysqli_connect`](http://us2.php.net/manual/en/mysqli.construct.php)

检查[`connect_error`](http://us2.php.net/manual/en/mysqli.connect-error.php)以获取有关连接失败原因的更多信息。

*（示例取自上述文档）*

```
<?php
$mysqli = @new mysqli('localhost', 'root', 'password', 'THE DB NAME');

// Works as of PHP 5.2.9 and 5.3.0.
if ($mysqli->connect_error) {
    die('Connect Error: ' . $mysqli->connect_error);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T15:56:36.813

尝试使用 显示您的 php 配置`phpinfo();`，您可能会从中学到很多东西。

另外，检查 MySQL 使用的端口号，我见过很多例子，它不是 OSX 安装的标准。

# javascript - KnockoutJS：如何从子数组中删除项目？

> ID：11398647
> 
> 赞同：0
> 
> 时间：2012-07-09T15:49:27.707
> 
> 标签：javascript, jquery, knockout.js

### 问题：

我还在学习knockoutJS，如果我的方法是错误的，请指导我。

这是我的小提琴：http: [//jsfiddle.net/amitava82/wMH8J/25/](http://jsfiddle.net/amitava82/wMH8J/25/)

在单击编辑时，我收到了视图中表示的 json 模型，我想从模型中删除某些项目（子数组）或动作（父数组）（为了简单起见，我删除了添加 UI 以从小提琴中添加更多动作) 然后最后将模型传回服务器。

现在，从根级别删除很容易。我坚持删除 **ActionItems**数组中的**ActionParamaters单个项目。**

 **### 问题：

如何从子数组中删除项目？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-09T19:45:49.377

您可以将单击的 actionItem 和包含的操作数组传递给 deleteActionItem 函数，如下所示：

```
<!-- /ko -->
<a href="javascript:void(0)" data-bind="click: $root.deleteActionItem.bind($data, $parent)">remove item</a> 
```

在您的模型中，您需要使用 ko.mapping 插件使每个 actionItem 数组可观察（请参阅编辑功能）

```
var viewModel = function() {
    var self = this;
    self.data = ko.observable();

    self.edit = function() {
       self.data ( ko.mapping.fromJS(editData) );
    }
    self.log = function() {
        console.log(self.data())
    }
    self.deleteAction = function(data) {
       //delete root node
       self.data().remove(data)
    }
    self.deleteActionItem = function(data,actionItem) {
        //delete items
        data.ActionItems.remove(actionItem);
    }
} 
```

然后您将能够在 deleteActionItem 函数中从数组中删除该项目，并且由于该数组现在是可观察的，因此结果将反映到绑定的 dom 元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T19:28:31.240

山姆，你的小提琴数据太复杂了。提问时，如果您提炼出相关的元素，您将提高获得帮助的机会。我已经制作了一个[简单的小提琴](http://jsfiddle.net/EenCp/1/)来说明嵌套数组和删除。

这是 HTML，请注意 remove 函数在数组的上下文中，因此它调用一个函数 on`$parent`而不是`$root`. 这让我们可以直接针对上面的上下文，而不是根。

```
<ul data-bind="foreach: editData">
    <li>
        <span data-bind="text: name"></span>
        <button data-bind="click: $parent.removeParent">Remove Parent</button>
        ...
            <!-- This line is on the child context -->
            <button data-bind="click: $parent.removeChild">Remove Child</button>

</ul>​ 
```

这是父模型。注意这里的移除功能是为了移除孩子。当`removeChild`函数被调用时，它来自子上下文请求`$parent`，它将调用此删除。

```
var Parent = function(name, children) {
    var self = this;
    self.name = ko.observable(name);
    self.children = ko.observableArray(children);
    self.removeChild = function(child) {
        self.children.remove(child);
    };
}; 
```

您的小提琴也没有使用模型，这是 MVVM 开发的一个重要方面。您应该考虑[阅读淘汰网站上的教程，](http://learn.knockoutjs.com/)以更好地了解如何构建淘汰应用程序。它将帮助您更轻松地处理此类问题。**

# sql-server-2008 - SQL Server 2008 - 如何实现“看门狗服务”，当表上的插入语句过多时会发出声音

> ID：11398648
> 
> 赞同：1
> 
> 时间：2012-07-09T15:49:31.613
> 
> 标签：sql-server-2008, insert

就像我的标题所描述的那样：我如何在 SQL Server 2008 中实现类似看门狗服务的功能，并执行以下任务：当在该表上提交太多插入时发出警报或执行操作。

例如：错误表在正常情况下在一秒钟内收到 10 条错误消息。如果在一秒钟内超过 100 条错误消息（100 条插入），则：ALERT！

如果您能帮助我，将不胜感激。

PS：不。SQL Jobs 不是一个选项，因为看门狗应该是实时的 :-) 集成服务？有没有更简单的方法来实现这样的服务？

亲切的问候，萨尼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T20:20:04.720

我不完全理解你的问题，所以我不完全确定我的答案是否真的解决了任何问题，或者只是让潜在的问题变得更糟。尤其是当您面临性能或并发问题时，这可能行不通。

如果您可以更新原始表，只需添加一个 datetime2 字段，如

```
InsertDate datetime2 NOT NULL DEFAULT GETDATE() 
```

最好在表上创建一个索引，然后以任何适合的间隔，通过查看有多少行具有 InsertDate > GetDate - X 来轮询表。

对于这种特殊情况，您可能会受益于将轮询过程读取为未提交（或使用`WITH NOLOCK`），尽管这样做时必须小心。

如果您无法修改表本身，并且您不能或不会让另一个流程或作业监控相关变量，我建议您执行以下操作：

1.  制作一个只有一个 Datetime2 列的“计数器”表。
2.  在原始表上，创建一个 AFTER INSERT 触发器：

    *   删除日期时间字段早于 X 秒的所有行。
    *   用当前时间插入一行。
    *   计数以查看计数器表中现在是否存在太多行。
    *   必要时采取行动 - 即。通过执行将向发件人发出信号/抛出异常/发送邮件/无论什么的过程。

如果您可以修改原始表，请将 datetime 列添加到该表中，并使触发器对所有尚未 X 秒旧的行进行计数，并在必要时采取行动。

我还会考虑让另一个进程（即 SQL 作业或自制服务或类似服务）来完成所有的内务管理，即。删除旧行，计算行数并对其进行操作。将其保留为触发器的工作不是一个好的设计，从长远来看可能会导致问题。

如果可能的话，您应该考虑让其他进程来进行内务处理。

更新：更好的解决方案可能是将触发器插入通知（即日期时间）到队列中 - 如果您随后有一些东西正在监听该队列，您可以编写逻辑来确定您的阈值是否已超过。但是，这将需要您将一些逻辑转移到另一个流程中，我最初认为这不是一种选择。

# oracle-adf - oracle-adf：插入输入框的值

> ID：11398650
> 
> 赞同：0
> 
> 时间：2012-07-09T15:49:36.007
> 
> 标签：oracle-adf

我正在使用 Oracle ADF，但我无法获得一个简单的功能，实际上，输入框的值（来自绑定）必须存储在数据库中的原始表以外的表中？如何使用 ADF？你有想法吗，例如？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:42:17.853

也许为另一个表创建一个单独的 EO/VO 并简单地将值从一个绑定字段复制到另一个？我假设您有一个按钮来提交更改。支持 bean 代码可以复制值，或者使用绑定到按钮的 setActionListener 来复制值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T12:44:28.577

它既可以通过编程方式完成，也可以使用 adf-bindings 完成。你想要哪一个？具体说明你的要求

# python - 缺少 pgnuplot

> ID：11398654
> 
> 赞同：1
> 
> 时间：2012-07-09T15:50:01.570
> 
> 标签：python, cygwin, gnuplot

我正在尝试通过 cygwin 使用 gnuplot.py，但看起来我需要安装 pgnuplot（我得到“/bin/sh: pgnuplot.exe: command not found”试图运行 demo.py 文件）。

自述文件提供了一个 ftp 链接，但要么它已过时，要么我认为我不明白如何使用它。有人可以提供一种轻松安装 pgnuplot.exe 的方法吗？我试过搜索这个，但无法破译我找到的任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T03:35:19.193

这不一定是一个明确的答案，更像是在黑暗中随机刺伤 - 但是，如果在 中`gp.py`，你注释掉这些行会发生什么：

```
elif sys.platform == 'cygwin':
    from gp_cygwin import GnuplotOpts, GnuplotProcess, test_persist 
```

（你需要再做`python setup.py install`一次）

现在您应该进入“unix”块。以我的经验，cygwin 与 unix 足够接近，可以做很多事情......

当然，我有我自己的 gnuplot-python 接口 (pyGnuplot)，如果你愿意，你也可以尝试，尽管它不像旧版本那样流行或有据可查。

# c# - 我应该打更频繁、更小的电话吗？还是不太频繁的大电话？

> ID：11398656
> 
> 赞同：8
> 
> 时间：2012-07-09T15:50:14.053
> 
> 标签：c#, .net, wcf, design-patterns

我想这个问题有点加载，但我想要一些反馈。目前我正在通过 dtos 从 Web 服务构建 poco 类对象。我预加载所有标量值，并延迟加载所有集合/数组，当然包括二进制文件。

显然，我这样做是为了缩短响应时间，因为这个库是 Web 应用程序的驱动力。但是，为了保持服务的可重用性，我将每个 GET 函数标准化为单个操作 (S)。因此，例如，从活动目录中获取用户信息是一个（例如 displayName 和部门等标量值），而获取此人的直接下属是一个单独的、延迟加载的操作。那么发生的情况是，当您构建一个对象时，会多次调用服务来构建这个对象。有些页面只需要基本信息，有些页面会调用更多的延迟加载方法甚至整个对象。我认为这没有问题，但我想知道（其他工作人员已经在批评）这是否会成为问题？

我的问题是，我做错了吗？不过，所有输入都值得赞赏。谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-09T15:54:26.143

您需要平衡的是进行 HTTP 调用的开销与传输大型请求或响应的开销。

没有银弹。例如，如果通过 LAN 从一台服务器向另一台服务器进行呼叫，那么更大的有效负载就不是什么大问题了。如果呼叫是通过移动设备进行的，那么修剪有效负载可能会带来很多好处。

开始时最好的平衡是将 Web 服务的方法视为工作流中的步骤。想想“如果我想实现X，我需要什么数据？”；尝试围绕这些想法确定您的请求响应范围，然后分析结果。这只是一个起点，但它比从“每个微小细节的一种方法”或“一种允许一切的方法”开始要好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-09T15:51:28.937

> 我认为这没有问题，但我想知道（其他工作人员已经在批评）这是否会成为问题？

问题是对服务的每次调用都会产生开销。您将通过更少、更大的调用获得更好的总吞吐量。

这里总是有一个权衡，并达到一个平衡。较大的调用可能会提取比所需更多的数据，这也浪费了资源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T16:05:03.530

我投票支持不太频繁的大电话。

由于您处于 Web 环境中，数据从数据存储区遍历到应用层，然后再到 Web 层是一项昂贵的操作，我相信网络遍历占用的资源最多。因此，不太频繁的调用（通过 Web 层中的缓存机制）可以更好地扩展，这来自个人经验。

此外，您定义为“大”的内容取决于您的应用程序使用情况。例如，如果您的大多数用户只看到他们的基本信息，而只有少数选择进一步进入直接下属，您可以使用 2 个单独的调用。否则，坚持一个。

希望这可以帮助。

# character-encoding - gnuplot中的星号

> ID：11398657
> 
> 赞同：3
> 
> 时间：2012-07-09T15:50:16.073
> 
> 标签：character-encoding, gnuplot, symbols, postscript, figure

我正在尝试在`gnuplot`使用中生成一个 .eps 数字

```
set terminal postscript eps enhanced color solid 
```

我想在我的图中包含一个包含一些星号的情节的标题，例如★☆</p>

我试过这个：

```
plot "./mydata" u 1:2 title "★ ☆" 
```

还有这个：

```
stars = sprintf("★ ☆")
plot "./mydata" u 1:2 title stars 
```

但它们都不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T16:47:59.257

```
set term postscript enh color eps
set output 'test.eps'
set title 'star1:{/ZapfDingbats \110} star2:{/ZapfDingbats \111}'
plot sin(x) 
```

看看`docs/psdoc/ps_guide.ps`gnuplot 发行版中包含哪些内容。这就是我在寻找特殊的后记字符时去的地方......

# eclipse - 配置 Eclipse / EGit 以跟踪上游存储库

> ID：11398658
> 
> 赞同：7
> 
> 时间：2012-07-09T15:50:16.973
> 
> 标签：eclipse, git, github, egit

我正在使用 EGit（在新的 Eclipse 4.2 Juno 版本中提供）。

我在 GitHub 上有一个存储库，它是从另一个上游存储库分叉的。

当我从 Github 上的存储库在 Eclipse 中创建一个项目时，它正确设置`origin`为指向 GitHub 存储库。但它对上游存储库（我想从中合并更改）一无所知。

我可以手动从上游存储库成功合并（使用“Team / Remote / Fetch From... / Custom URI”并提供上游存储库详细信息）但是每次这样做都有点乏味。

但是有没有办法告诉 Eclipse 自动从上游存储库合并？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-10T18:33:59.673

在 git 存储库视图中选择*Remotes节点，使用**create remote*，输入“upstream”作为名称，选择*configure fetch*。在以下对话框中，您可以像手动获取时一样指定 refspec。

之后，您在*Remote*下有 2 个条目，并且可以通过使用所需节点上的上下文菜单轻松地从一个中获取。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-09T17:18:11.137

我不认为 Egit 支持直接在 GUI 中输入远程仓库地址。

这意味着您最好的解决方法是手动添加远程（上游）repo 引用，并带有“ `git remote add upstream ....`”（如[本例所示](http://wiki.eclipse.org/EGit/Contributor_Guide#Adding_a_dedicated_remote)）

然后，您应该会在“Git 存储库视图”的“远程”节点中看到该远程引用：

![遥控器节点](../Images/8b3295baf6206b890437380829493869.png)

从那里，您应该能够选择正确的遥控器，并从所述远程仓库中拉取或推送到所述远程仓库。

# php - 发送前加密帖子数据

> ID：11398659
> 
> 赞同：3
> 
> 时间：2012-07-09T15:50:18.813
> 
> 标签：php, javascript, public-key-encryption, encryption

一段时间以来，我一直在寻找解决此问题的方法。我需要一种使用 JS 加密表单数据的方法。然后我需要能够使用 PHP 解密它。公钥/私钥系统似乎很完美，但是我找不到任何关于如何实现它的解决方案或文档。我真的希望自己能够实现这一点。我只需要一些资源就可以开始。

是的，我知道 SSL。请不要推荐它。除非网站成功，否则我不想投资这笔钱。

任何语言的公钥加密然后私钥解密的示例将非常有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:55:36.750

您可以尝试使用 RC4 进行对称加密：-

[https://gist.github.com/2185197](https://gist.github.com/2185197)

然而，如今 SSL 相对便宜，而且比自己动手解决方案更容易、更安全、更不容易出错，所以我真的不会因为你想省钱而把它注销，它会帮你省钱从长远来看。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T22:10:08.697

你可以这样做：

[http://www.frostjedi.com/terra/dev/rsa/index.php](http://www.frostjedi.com/terra/dev/rsa/index.php)

更多信息：

[http://area51.phpbb.com/phpBB/viewtopic.php?f=84&t=33024&start=0](http://area51.phpbb.com/phpBB/viewtopic.php?f=84&t=33024&start=0)

# c# - 在另一个解决方案中更新了 .cs 文件，并且无法弄清楚如何引用更新的版本

> ID：11398662
> 
> 赞同：0
> 
> 时间：2012-07-09T15:50:23.407
> 
> 标签：c#, visual-studio-2010, dll

我在一个解决方案中更新了一个 .cs 文件，该文件在 VS 2010 的第二个解决方案中被 .cs 文件使用。我在第二个解决方案中删除了对 .dll 文件的引用，然后重新引用它，但我m 仍然引用旧的 dll。为了获得正确的版本，我还需要做些什么吗？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:56:17.493

您必须构建包含修改后的 .cs 的解决方案。构建该解决方案后，您必须构建使用 dll 的解决方案。如果您仍然有问题，那么您的项目可能没有标记为编译。如果是这样，请右键单击项目本身（不是解决方案）并重新构建项目。

# java - 创建方法类似于 JQuery 的 .css() 函数

> ID：11398663
> 
> 赞同：0
> 
> 时间：2012-07-09T15:50:27.313
> 
> 标签：java, jquery, function, methods

是否可以创建与`.css()`jQuery 中的函数类似的方法？

jQuery 中的示例：

```
$("#elemid").css("position","absolute");
$("#elemid").css({position:"absolute",left:45}); 
```

我希望这在 JAVA 中看起来几乎一样

JAVA 中的示例

```
Rectangle rect=new Rectangle();
rect.style("position","absolute");
rect.style({position:"absolute",left:45}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:01:37.857

您可以自己做一些类似的事情来创建 DSL。DSL 库的一个例子是[JooQ](http://www.jooq.org/manual/DSL/)，这是一个用于 SQL 的 java DSL。

不过，这将需要一些工作：P

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:04:43.920

JQuery 函数的基本思想是它们返回一个新的（或相同的）对象，以便您可能调用另一个方法。它在 .NET Framework 的命名空间中实现了一种类似的方法`System.Linq`。尽管它使用了扩展方法，但这些只是为现有类定义附加方法的一种方式。一个例子：

```
foreach (var i in list.Skip(4).TakeWhile(x => x > 0).Select(x => x*x))
{
    Console.WriteLine(i);
} 
```

这会跳过列表的前四个元素，然后迭代剩余的元素，直到它到达列表的末尾或不大于零的元素。迭代的每个元素都被平方，然后由迭代器返回以写入控制台。

因此，如果您在 Java 中创建自己的类，只需让方法返回一个对象即可调用其他方法。`StringBuilder`/`StringBuffer`类已经用他们的`Append`方法通过简单地返回来做到这一点`this`。

# oracle - 我要执行一个触发器，它应该应用于除一个用户之外的所有用户

> ID：11398664
> 
> 赞同：1
> 
> 时间：2012-07-09T15:50:27.650
> 
> 标签：oracle, triggers, plsql

我想执行一个触发器，它应该应用于除一个用户之外的所有用户。

我怎么写这个？

请提供一个简单的代码示例？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T15:55:32.477

```
if user != 'BADGUY' then
--  run this code
end if; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T17:36:42.420

```
 CREATE OR REPLACE TRIGGER <trigger_name>
 :
 DECLARE

 BEGIN

   --replace scott with the user you want to restrict 
   IF sys_context( 'userenv', 'current_user' ) <> 'SCOTT' THEN  
     --do what you want to do 

   END IF;

 END <trigger_name>; 
```

# arduino - 硬盘 POV 时钟

> ID：11398665
> 
> 赞同：0
> 
> 时间：2012-07-09T15:50:30.940
> 
> 标签：arduino

我正在构建一个硬盘 POV 时钟。（谷歌它，它们很酷）我正在编写它的代码，现在我想做的就是掌握让它用 RGB LED 做简单图案的窍门。我想知道是否有人对如何做一些简单的事情有任何想法，比如让红线围绕盘子旋转。

现在我拥有的是一个触发功能的中断。

```
 int gLED = 8; // pins for RGB led strip
    int rLED = 9;
    int bLED = 10;

    attachInterrupt(0, ledPattern, FALLING);

    void ledPattern(){
        digitalWrite(gLED, HIGH);  // This will make a stable image of slice of the
        delayMicroseconds(500);    // platter, but it does not move.
        digitalWrite(gLED, LOW);
    } 
```

这是代码的主要部分（显然我删掉了一些 arduino 需要的东西）我想弄清楚的是如何使该切片围绕盘片旋转。最终我会通过添加其他颜色使图案更有趣。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T21:26:04.233

尝试`ledPattern`在打开 LED 之前添加延迟，并在每次调用中断时增加延迟。要以特定角度显示一条线，您需要测量后续中断之间的时间（LED 转一整圈所用的时间）并使`ledPattern`程序中的所有延迟与该时间成正比。

请注意，如果添加太多延迟，则在`ledPattern`调用下一个中断时例程不会返回；您可能需要缓解这种情况，或者至少弄清楚 arduino 环境在这种情况下正在做什么。

# netty - Netty 框架：channelOpen 什么时候调用？

> ID：11398673
> 
> 赞同：1
> 
> 时间：2012-07-09T15:50:57.810
> 
> 标签：netty

根据 Netty 指南：[http ://static.netty.io/3.5/guide/#start.12](http://static.netty.io/3.5/guide/#start.12)

> *要跟踪打开的套接字，您需要修改 TimeServerHandler 以将新的打开 Channel 添加到全局 ChannelGroup，TimeServer.allChannels：*

```
 @Override
  public void channelOpen(ChannelHandlerContext ctx, ChannelStateEvent e) {
        TimeServer.allChannels.add(e.getChannel());
  } 
```

我`channelOpen`在我的业务逻辑处理程序上实现。当新客户端建立连接时，我没有看到它被调用。有人能详细说一下什么时候`channelOpen`打电话吗？

另外，我可以编写一个上游处理程序以插入到并期望**在**适当的时间被调用，还是*必须*在业务逻辑处理程序上实现？`ExecutionHandler``channelOpen`*`channelOpen`*

 *如果可能的话，我希望能够`channelOpen`与业务逻辑处理程序分开实现。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T11:27:47.983

事件按以下顺序出现：

通道打开（..），通道绑定（..），通道连接（..）

...

cannelDisconnected(..)、channelUnbound(..)、channelClosed(..)

因此，当客户端连接时，应该首先调用 channelOpen(..)。*

# mysql - 同一字段上的多个排序顺序

> ID：11398677
> 
> 赞同：2
> 
> 时间：2012-07-09T15:51:08.507
> 
> 标签：mysql, sql

考虑以下示例：

```
+---------+------------+
| value   | name       |
+---------+------------+
|      42 | abresas    |
|       0 | dionyziz   |
|       6 | dionyziz2  |
|       0 | izual      |
|       8 | kokos      |
|      37 | kostis90gr |
|       0 | test       |
|      35 | usertest   |
+---------+------------+ 
```

我想按值的升序对其进行排序，但我希望所有值为 0 的名称都显示在底部。所以排序顺序应该是：6,8,35,37,42,0,0,0

知道这是否可以通过 sql 实现吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-09T15:53:40.247

当然。使用[IF 函数](http://dev.mysql.com/doc/refman/5.5/en/control-flow-functions.html#function_if)：

```
ORDER BY IF(value=0,1,0), value 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-09T15:54:33.557

是的，您只需要调整 order by 子句：

```
order by (case when value = 0 then 999999 else value end) 
```

是一种方法，假设有一个最大值。另一种更通用的方法是：

```
order by (case when value = 0 then 1 else 0 end), value 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-09T16:00:16.967

您可以使用 UNION 关键字来组合两个不同查询的结果，如下所示：

```
(select * from tableName where value>0 order by value) 
union 
(select * from tableName where value=0) 
```

# objective-c - 您如何确定具有很多属性的对象（自身）是否已更改？

> ID：11398684
> 
> 赞同：18
> 
> 时间：2012-07-09T15:51:28.527
> 
> 标签：objective-c, ios, observer-pattern

**问题的简短版本：**
我有一个带有大量声明属性的类，我想跟踪它是否有任何更改，以便当我调用它的`save`方法时，它不会写不需要的时候到数据库。如何在**不为所有声明的属性编写自定义设置器的情况下**`isDirty`更新属性？

 ****问题的较长版本：**
假设我有这样的课程：

```
@interface MyObject : NSObject
{
@property (nonatomic, retain) NSString *myString;
@property (nonatomic, assign) BOOL     myBool;
// ... LOTS more properties
@property (nonatomic, assign) BOOL     isDirty;
}

...

@implementation MyObject
{
@synthesize myString;
@synthesize myBool;
// ... LOTS more synthesizes :)
@synthesize isDirty;
} 
```

**尝试 1**
我的第一个想法是这样实现`setValue:forKey:`：

```
- (void)setValue:(id)value forKey:(NSString *)key {
    if (![key isEqualToString:@"isDirty"]) {
        if ([self valueForKey:key] != value) {
            if (![[self valueForKey:key] isEqual:value]) {
                self.isDirty = YES;
            }
        }
    }
    [super setValue:value forKey:key];
} 
```

这可以完美地工作，直到您直接使用设置器（即`myObject.myString = @"new string";`）设置值，在这种情况下`setValue:forKey:`不调用（我不知道为什么我认为它会是，哈哈）。

**尝试 2**
观察自我的所有属性。

```
- (id)init
{
    // Normal init stuff
    // Start observing all properties of self
}

- (void)dealloc
{
    // Stop observing all properties of self
}

- (void)observeValueForKeyPath:(NSString *)keyPath 
                      ofObject:(id)object 
                        change:(NSDictionary *)change 
                       context:(void *)context
{
    // set isDirty to true
} 
```

我很确定这会奏效，但我认为必须有更好的方法。:) 我也希望这是自动的，这样我就不必维护要查看的属性列表。我可以很容易地看到在维护它时忘记将属性添加到列表中，然后试图找出为什么我的对象*有时*没有被保存。

希望我忽略了一个更简单的方法来解决这个问题！

**最终解决方案**
请参阅下面的答案，了解我对此的最终解决方案。它基于 Josh Caswell 提供的答案，但它是一个工作示例。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-09T17:55:09.740

一点内省应该会有所帮助。[运行时函数](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html)可以为您提供所有对象属性的列表。然后，您可以使用这些来告诉 KVO`dirty`依赖[于](http://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/KeyValueObserving/Articles/KVODependentKeys.html#//apple_ref/doc/uid/20002179-SW3)该列表。这避免了必须手动更新属性列表的可维护性问题。需要注意的是，与任何其他涉及 KVO 的解决方案一样，如果直接更改 ivar，您将不会收到通知——所有访问都*必须*通过 setter 方法。

注册以观察`self`中的`dirty`关键路径`init`，并添加此方法，创建并返回`NSSet`带有所有类属性名称的 （`@"dirty"`当然，除了 ）。

```
#import <objc/runtime.h>

+ (NSSet *)keyPathsForValuesAffectingDirty 
{
    unsigned int num_props;
    objc_property_t * prop_list;
    prop_list = class_copyPropertyList(self, &num_props);

    NSMutableSet * propSet = [NSMutableSet set];
    for( unsigned int i = 0; i < num_props; i++ ){
        NSString * propName = [NSString stringWithFormat:@"%s", property_getName(prop_list[i])];
        if( [propName isEqualToString:@"dirty"] ){
            continue;
        }
        [propSet addObject:propName];
    }
    free(prop_list);

    return propSet;
} 
```

`dirty`现在，只要设置了此类的任何属性，就会触发的观察。（请注意，超类中定义的属性不包含在该列表中。）

您可以改为使用该列表单独注册为所有名称的观察者。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T16:17:08.517

根据您的需要，这可能有点矫枉过正，但 CoreData 提供了管理对象状态和更改所需的一切。如果您不想处理文件，可以使用基于内存的数据存储，但最强大的设置使用 SQLite。

因此，您的对象（基于 NSManagedObject）将继承一些有用的方法，例如`-changedValues`列出自上次提交以来更改的属性或`-committedValuesForKeys: nil`返回上次提交的属性。

可能会矫枉过正，但您不必重新发明轮子，您不需要使用第三方库，并且只需要几行代码即可使其正常工作。内存使用会受到相当大的影响，但如果您选择使用 SQLite 数据存储，则不一定是坏事。

除了 Core Data，使用 KVO 是实现自己的快照机制或变更管理器的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-31T19:08:35.710

我的最终解决方案（感谢 Josh Caswell 的示例！）：

```
- (id)init
{
    if (self = [super init])
    {
        [self addObserver:self forKeyPath:@"isDirty" options:0 context:NULL];
    }
    return self;
}

- (void)dealloc
{
    [self removeObserver:self forKeyPath:@"isDirty"];
}

- (BOOL)loadData
{
    // Load the data, then if successful:
    isDirty = NO;
    return YES;
}

- (BOOL)saveData
{
    if (!self.isDirty)
    {
        return YES;
    }

    // Save the data, then if successful:
    isDirty = NO;
    return YES;
}

// isDirty is dependant on ALL of our declared property.
+ (NSSet *)keyPathsForValuesAffectingIsDirty
{
    unsigned int    num_props;
    objc_property_t *prop_list = class_copyPropertyList(self, &num_props);

    NSMutableSet * propSet = [NSMutableSet set];
    for( unsigned int i = 0; i < num_props; i++ )
    {
        NSString * propName = [NSString stringWithFormat:@"%s", property_getName(prop_list[i])];
        if(![propName isEqualToString:@"isDirty"] )
        {
            [propSet addObject:propName];
        }
    }

    free(prop_list);

    return propSet;
}

// If any of our declared properties are changed, this will be called so set isDirty to true.
- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context
{
    if ([keyPath isEqualToString:@"isDirty"])
    {
        isDirty = YES;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T16:12:53.240

我不知道你所有的属性是什么，但你可以尝试“超类化”它们。创建一个对象`ObservedObject`，然后为作为该对象子类的所有对象创建自定义类。然后放置一个`isDirty`属性`ObservedObject`并查看它，或者在更改时向您的程序发送通知。如果您有许多不同类型的对象，这可能需要做很多工作，但如果您有很多相同的对象，那应该不会太糟糕。

我很想知道这是否是一个可行的解决方案，或者是否可以为此类问题找到一个好的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-09T18:02:44.490

一种选择是在您的保存方法中获取旧版本 myObject 并执行类似的操作

```
if (![myOldObject isEqual:myNewObject]) {

 //perform save

} 
```**

# css - HTML图中的额外填充

> ID：11398686
> 
> 赞同：2
> 
> 时间：2012-07-09T15:51:31.823
> 
> 标签：css, html

我正在尝试使用各种自定义复选框输入，但我不太确定所有这些填充来自哪里..

这个想法是显示一个图像来代替带有文本的复选框，当它被选中时，图像的不透明度会降低以在其下方显示一个符号，表明它已被选中。

我把它归结为这个小提琴：http: [//jsfiddle.net/tx76J/1/](http://jsfiddle.net/tx76J/1/)

```
<li>
    <input id="1" type="checkbox">
    <label for="1">
        <figure>
            <img src="http://www.moderndandies.com/files/images/Asus-smartphone-android.jpg">          
        </figure>
    </label>
</li>​ 
```

![在此处输入图像描述](../Images/8a1c6b70fdb5b5412ecc5e1dc682980d.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-09T15:56:16.283

*   添加`list-style: none;`到您的`li`. 问题是由列表标记引起的，如果您删除黑色背景颜色，您可以看到它（我确定它仅用于演示，但对于未来的访问者：`li`应该始终只存在于`ol`或中`ul`）。

    ![在此处输入图像描述](../Images/65296f3bcfc6dce6cc74ab79a04f51ec.png)

*   此外，设置`img`为`display: block`以删除底部的空间。出现这种情况是因为默认情况下图像被认为是内联的（也在这个问题中解释：[锚标记底部的空白^(SO)](https://stackoverflow.com/questions/3197601/white-space-at-bottom-of-anchor-tag)）。

[jsFiddle 演示，显示它工作](http://jsfiddle.net/tx76J/4/)

# python - 将 DataFrame 与 pandas 合并

> ID：11398688
> 
> 赞同：1
> 
> 时间：2012-07-09T15:51:48.870
> 
> 标签：python, pandas, io

我有多个包含日期和测量值的文件。它们的设置是相同的：

```
YYYY  MM  DD  val1
YYYY  MM  DD  val2
YYYY  MM  DD  val3 
```

我使用以下内容将这些文件中的每一个读入`DataFrame`

```
for cur_file in file_list:
    cur_df = pa.io.parsers.read_table(os.path.join(data_path, result)
                                                , header=None
                                                , sep='\s*'
                                                , parse_dates=[[0,1, 2]]
                                                , names=['day','month', 'hour', cur_file[:-4]]
                                                , index_col=[0]
                                                ) 
```

所有文件中的日期都不相同。有时会有一些重叠，但并非总是如此。

我可以通过单独绘制每个 cur_df

```
cur_df.plot() 
```

在循环。

`cur_df`将所有内容整合到一个“大”数据帧中似乎是个好主意。既用于绘图，也用于以后的统计。考虑到它们的日期不同，理想情况下如何做到这一点？有没有办法“合并”多个仅出现在一个基础 DataFrames 中的 DataFrames 日期？

我想我正在寻找一个看起来像这样的数据框：

```
YYYY MM DD  val1(from1)  NaN
YYYY MM DD  val2(from1)  val2(from2)
YYYY MM DD  NaN          val3(from2) 
```

它将从 val1 的日期开始在第一行中获取日期戳，在第二行中，val1 和 val2 的日期相同，并且它将根据 val2 获取第 3 行中的日期

我查看了 cur_df.add(cur_df2) 附加了两个数据帧。我不确定 cur_df.combine(cur_df2, ...) 会做什么，特别是因为我不确定应该将哪个函数用作第二个参数。

谢谢你的帮助，干杯，克劳斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T18:01:30.437

从您的代码片段看来，解析的日期值应该是索引，并且每个 DataFrame 将具有不同列名中的值，对吗？在这种情况下，我认为迭代调用`DataFrame.combine_first`应该可以解决问题。

另外，您是否也传递了“keep_date_col=True”？默认情况下，解析器在将多个日期组件解析为一个时应该丢弃组件日期列（如果不是，那么这是一个错误，所以请告诉我）。

最好的，

常

# lync - 显示应用程序端点的照片

> ID：11398689
> 
> 赞同：2
> 
> 时间：2012-07-09T15:51:49.543
> 
> 标签：lync, ucma

这是我的问题：我从 3 个月开始从事一个大型 UCMA 项目，现在我想添加一个小功能。

我有很多可以动态添加、修改或删除的 ApplicationEndpoint，我希望在每次创建 ApplicationEndpoint 时指定一张将在 Microsoft Lync 上显示的图片。

我已经有很多其他的功能，但我真的很想拥有这个。

我搜索了几天，但我没有找到任何东西，所以在告诉自己无法完成之前，我想问一下！

有谁知道这是否可能？在那种情况下，你能告诉我怎么做吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-11T08:02:18.077

迟到总比没有好，但这可能对某人有所帮助。

我不确定这是否适用于应用程序端点，但您可以肯定地发布用户端点的照片设置（我已经这样做了，它可以工作）。可以在 MSDN 上找到有关发布状态的一些基本信息：[Publishing Presence](http://msdn.microsoft.com/en-us/library/lync/dd253494%28v=office.13%29.aspx)。

发布状态信息（包括照片设置）在`LocalEndpoint.LocalOwnerPresence`. 两者`UserEndpoint`都`ApplicationEndpoint`来自`LocalEndpoint`，所以这应该是可行的。

实际的发布会稍微复杂一些，因为要发布的“级别”有很多不同的组合：

首先，`InstanceID`您需要了解一些值，请在此处阅读它们：[Presence data source and category instance ID](http://msdn.microsoft.com/en-us/library/lync/hh380066.aspx)

其次，这种存在适用于谁是有价值的，请参阅`Microsoft.Rtc.Collaboration.Presence.PresenceRelationshipLevel`。不要在 上发布`Unknown`，你会得到一个例外。

```
public enum PresenceRelationshipLevel  
{  
    Unknown = -1,  
    Everyone = 0,  
    External = 100,  
    Colleagues = 200,  
    Workgroup = 300,  
    Personal = 400,  
    Blocked = 32000,  
} 
```

您需要`PresenceCategoryWithMetaData`为用户照​​片属性发布一个，它是容器的一部分`0x5`，“Presentity information”。

```
var photoPresence = new PresenceCategoryWithMetaData(
    0x5, // The container id
    (int)PresenceRelationshipLevel.Everyone,
    new ContactCard(0x5) // Same container ID again
    {
        IsAllowedToShowPhoto = true,
        PhotoUri = "<uri to your photo here"
    }); 
```

你也可以在这个对象上设置一个`ExpiryPolicy`，真的应该是自我解释的。然后在您的端点上发布此存在对象：

```
Endpoint.LocalOwnerPresence.BeginPublishPresence(new[] { photoPresence  }, cb => { 
    Endpoint.LocalOwnerPresence.EndPublishPresence(cb);
}, null); 
```

真的应该这样做。我最终明确地发布到所有关系级别，因为它没有按逻辑预期级联数据。这变成了一个相当长的回复，也供我自己将来参考。请让我知道这是否也适用于应用程序端点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T11:20:12.590

很确定你不能这样做。因为它是一个应用程序端点，根据定义，它与任何一个特定用户都不相关。不过肯定会很好。:)

# bash - 在文件中查找字符串并在找到时写入文件

> ID：11398690
> 
> 赞同：2
> 
> 时间：2012-07-09T15:51:54.627
> 
> 标签：bash, shell, unix

只是想知道是否有人可以指出我正确的方向。我想在一个文件中搜索 2 个字符串，如果它们匹配，则在 csv 文件中添加 YES，如果不匹配，则添加 NO。现在很难，我想让它找到字符串并在屏幕上打印 SUCCESS，如果找到如下所示（我宁愿尝试自己完成对文件的写入，以便我学习）。

我确实需要两个字符串都匹配，否则结果应该是否。

到目前为止，我已经得到了这个：

```
#/usr/bin/bash
file=test.xml
string1=TEST1
string2=TEST2
if grep -e "$string1|$string2" "$file"
then
    echo IT WORKS!!!
else
    echo UH OH!!!
fi 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:18:37.830

使用`grep`您需要读取文件两次：

```
if grep "$string1" "$file" && grep "$string2" "$file" 
```

但是，使用 AWK，您可以设置标志，并且您只需要读取文件一次：

```
awk -v s1="$string1" -v s2="$string2" '$0 ~ s1 {f1 = 1} $0 ~ s2 {f2 = 1} END {if (f1 && f2) {print "Yes"} else {print "No"}}' "$file" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:07:59.200

假设任一字符串匹配就足够了，试试这个：

```
file=test.xml
string1="TEST1"
string2="TEST2"

if grep -q -F "$string1"$'\n'"$string2" "$file" ; then
    printf YES
else
    printf NO
fi 
```

重要的是，`-F`这意味着如果字符串恰好包含正则表达式特殊字符，它们将被逐字处理。为方便起见`-q`，将抑制输出，`grep`因此您只会返回 YES/NO。

编辑：

由于您需要两个字符串都匹配，请尝试以下操作：

```
if [ $(sed -n -e "/${string1}/p;/${string2}/p" "$file" | wc -l) -ge 2 ] ; then
    printf YES
else
    printf NO
fi 
```

这不像`grep`版本那样安全，因为字符串中的正则表达式字符没有按字面意思处理并且效率相当低，但它可以完成工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T16:02:20.230

您的代码朝着好的方向发展。您需要更改`-e`with`-E`以`grep`识别您正在使用的正则表达式 ( `$string1|$string2`)。您可能还希望避免看到实际匹配项（`-q`为此使用 quiet 标志）：

```
file=test.xml
string1="TEST1"
string2="TEST2"
if grep -E -q "$string1|$string2" "$file"
then
    echo IT WORKS!!!
else
    echo UH OH!!!
fi 
```

**编辑：**由于您需要匹配两个字符串，因此`grep`（AFAIK）除非您执行`grep`多次（如@chepner's answer），否则这是不可能的。

另一种解决方案是使用`awk`：

```
awk '/'$string1'/{s1=1}/'$string2'/{s2=1} END { \
    if (s1 && s2) print "IT WORKS!!!" ; else print "UH OH!!!" }' "$file" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T16:04:13.100

由于您希望两个字符串都匹配，因此一种低效的方法是`grep`为每个模式调用一次：

```
if grep -q "$string1" && grep -q "$string2"
then
echo IT WORKS
else
echo UH OH
fi 
```

我不知道在没有相当复杂的正则表达式的情况下使用单个 grep 调用来做到这一点的方法。就像是

```
grep -qE "$string1.*$string2|$string2.*$string1" 
```

可以工作，但我确信这将包括一些误报和/或误报，具体取决于 和 的`string1`值`string2`。

# django - 使用 json 使用 djangorestframework 将图像上传到 imagefield 并使用 CURL 进行测试

> ID：11398696
> 
> 赞同：8
> 
> 时间：2012-07-09T15:52:08.553
> 
> 标签：django, json, curl, imagefield, django-rest-framework

我在 djangorestframework 中制作了几个 api。这我可以使用 api 的 html 形式和命令行中的 curl 进行测试。

现在我有一个模型的 api，其中一个字段是 ImageField。

我不知道要使用哪个 curl 命令。使用我在以 json 格式发布操作之前使用的语法，它将是：

```
curl -X POST -S -H 'Content-Type: application/json' -u "username:password" --data-binary '{"otherfields":"something", "photo":"/home/michel/test.jpg"}' 127.0.0.1:8000/api/v1/ 
```

但在这种情况下，照片不会被保存并留空（照片是可选字段）

添加`-T /home/michel/test.jpg` 我收到一条错误消息，说 127.0.0.1:800/api/v1/test.jpg 不作为 url 存在。

在 djangorestframework 的测试 html 表单中，一切正常。

使用该`-F`选项，它说我一次只能执行 1 个请求...我还从 data-binary 中删除了数据类型

任何人都可以帮助我如何在 1 个命令中使用 json 中的图像和其他数据制作这个 curl 帖子。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-13T08:32:23.910

经过长时间的困惑，这似乎可以解决问题：

*   将所有 json 参数放在单独的`-F`参数中
*   只使用标题`Accept`（不是`Content-Type`）
*   并指定图像类型
*   用于`@`指示要上传的本地文件

    ```
    curl -X POST -S \
      -H 'Accept: application/json' \
      -u "username:password" \
      -F "otherfields=something" \
      -F "photo=@/home/michel/test.jpg;type=image/jpg" \
      http://127.0.0.1:8000/api/v1/ 
    ```

顺便说一句，我知道所有这些都在 curl 的文档站点上，但只是错过了所有这些东西的示例，因为有很多选项可以尝试。

# multithreading - QAbstractItemModel 延迟加载锁定应用程序

> ID：11398698
> 
> 赞同：0
> 
> 时间：2012-07-09T15:52:17.453
> 
> 标签：multithreading, qt, user-interface, qtreeview, qabstractitemmodel

我已经实现了 canFetchMore、hasChildren 和 fetchMore，以允许我的模型延迟加载。它非常简单并且基于 QT：[http ://doc.qt.io/archives/qt-4.7/itemviews-simpletreemodel.html](http://doc.qt.io/archives/qt-4.7/itemviews-simpletreemodel.html)

我的问题是，在我的应用程序中获取孩子不是一个非常快速的操作，它涉及服务器端的几秒钟延迟，同时它会计算出孩子实际上是谁。

我不确定如何处理。每次有人扩展节点时，我都无法让我的应用程序锁定几秒钟。我不知道如何在后台发生这种情况。如果我要创建一个子进程或线程来实际完成检索子进程和更新客户端数据结构的工作，我将如何告诉模型这已成功完成（以及节点最终扩展） .

另外，有没有办法显示节点当前正在后台加载数据？

抱歉，如果这些是愚蠢的问题，GUI 编程对我来说仍然有点神秘，而且我以前从未使用过 QT。

作为记录，我使用的是 Python，但如果用 C++ 给出答案，我可以理解它们。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T22:43:48.247

> 如果我要创建一个子进程或线程来实际完成检索子进程和更新客户端数据结构的工作，我将如何告诉模型这已成功完成（以及节点最终扩展） .

您可以使用信号和插槽。在您检索数据的线程中，您将发出一个自定义信号`someDataAvailable(YourdataType)`，然后在 gui 中，您将使用类似`handleDataReadySignal(YourdataType)`. 信号通过你在发射时给它的对象。显然您需要更新 gui 和`handleDataReadySignal`插槽中的列表。当然，您`connect`最好在附加列表的窗口/对话框的构造函数中插入信号槽

# split - 我的拆分视图控制器没有显示工具栏。如何从表格视图的背景中删除工具栏闪耀效果？

> ID：11398703
> 
> 赞同：0
> 
> 时间：2012-07-09T15:52:31.237
> 
> 标签：split, view, controller, master-detail

我正在开发一个基于 Xcode 4.3.3 中的 Master-Detail Application 模板的应用程序。我注意到纵向模式下的主表视图弹出窗口中有一个奇怪的工件。这是奇怪的屏幕截图。（我特别指的是可以选择包含工具栏的区域中的闪耀效果。）

[http://www.appsbyallen.com/images/stackoverflow/Menu.png](http://www.appsbyallen.com/images/stackoverflow/Menu.png)

以下是重现此问题的步骤。

1）基于主从应用创建一个新项目。

2) 打开 iPad 故事板并将 Table View 样式从 Plain 更改为 Grouped。

3) 在 MasterViewController 的 viewDidLoad 中，添加“self.tableView.backgroundView.alpha = 0.0”或“self.tableView.backgroundView = nil”。我都试过了。

4) 在 iPad 模拟器中以纵向模式运行 App。单击主按钮。观察奇点。

我的意图是允许细节视图控制器通过弹出框显示。

这是Apple代码中的错误吗？还是我在这里做错了什么？测试用例看似如此简单。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T16:00:49.690

我已经确定了解决此问题的方法。

在 MasterViewController 的 viewDidLoad 中，显示工具栏

*   self.navigationController.toolbarHidden = NO;

然后在 MasterViewController 的 viewWillAppear 中，用

*   self.navigationController.toolbarHidden = YES;

然后，在 MasterViewController 的 viewDidDisappear 中再次显示

*   self.navigationController.toolbarHidden = NO;

这三种情况都是必需的。似乎只有在不显示视图时工具栏被隐藏的情况下才会产生闪耀效果。

我希望这对其他人有帮助！

# php - 在 URL 中使用带有额外斜杠的 Mod_Rewrite

> ID：11398704
> 
> 赞同：1
> 
> 时间：2012-07-09T15:52:33.613
> 
> 标签：php, mod-rewrite, gd

在 /corner.php 我有一个脚本，可以为图像添加圆角。我正在使用 Mod_Rewrite 重写我的网站网址。

我希望能够访问[http://domain.com/corner/templates/Toys/images/no_image.gif](http://domain.com/corner/templates/Toys/images/no_image.gif)它实际上会将我发送到 /corner.php?source=templates/Toys/images/no_image.gif .

但是因为 url 中有多余的斜杠，所以它不起作用。有没有办法做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:07:29.737

我没有看到任何可以破坏模式重写的额外斜线。

这应该可以工作，也可以在同一个域中，您不必指定它

```
RewriteEngine on
RewriteRule ^corner\/(.*)$       /corner.php?source=$1 
```

# c# - 使用 json 数据 (c#) 在 Windows 8 Metro 风格应用程序中进行数据绑定

> ID：11398705
> 
> 赞同：0
> 
> 时间：2012-07-09T15:52:33.803
> 
> 标签：c#, json, data-binding, windows-8, deserialization

我正在尝试在 Visual Studio Express 2012 RC 中制作应用程序。我下载了一些 JSON 数据并将其反序列化。但是在将数据绑定到列表框后，它不是显示实际内容，而是显示`project-name.page-name+Datum`在文本块中。

**这是 XAML 代码的一部分：**

```
<ListBox x:Name="listbox1" HorizontalAlignment="Left" Height="687" Margin="10,71,0,0" VerticalAlignment="Top" Width="1346" ItemsSource="{Binding data}">
    <TextBlock x:Name="textblock1" TextWrapping="Wrap" Height="50" Width="443" Text="{Binding name}" />
</ListBox> 
```

**这是 xaml.cs 代码的一部分**

```
public class RootObject
{
    public List<Datum> data { get; set; }

}
public class Datum
{
    public string name { get; set; }
} 
```

**这是我用来反序列化 JSON 数据的代码**

```
stream loading = await load.GetStreamAsync(....);
DataContractJsonSerializer ser = new DataContractJsonSerializer(typeof(RootObject));
RootObject loaded = (RootObject) ser.ReadObject(loading);
listbox1.DataContext = loaded; 
```

谁能告诉我我的代码有什么问题？我在 Windows 手机应用程序中使用相同的东西，它工作正常，除了我在其中使用了 webclient。

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:27:22.817

您已将 UIElement 添加到 ListBox 的`Items`集合中。让项目显示您想要的内容的正确方法是应用 ItemTemplate。您可以内联或引用资源。

```
<ListBox ItemsSource="{Binding data}">
    <ListBox.ItemTemplate>
        <DataTemplate>
          <TextBlock Text="{Binding name}" />
        </DataTemplate>
    </ListBox.ItemTemplate
</ListBox> 
```

它应该适用于该设置，尽管我没有对其进行测试。如果这有效，请记住将其标记为答案，以便其他人可以从您的询问中学习。

*旁注*

我还建议您清除任何非必要属性的示例代码，以确保其价值。并避免硬编码的宽度/边距值——允许应用程序元素按比例调整自己的大小。

# three.js - 三.js局部和全局坐标

> ID：11398706
> 
> 赞同：2
> 
> 时间：2012-07-09T15:52:33.837
> 
> 标签：three.js

Three.js 中是否有将局部坐标转换为全局坐标的函数？我了解它背后的数学原理，但如果它可用，我宁愿使用 Three.js 中的函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:54:53.383

见[https://github.com/mrdoob/three.js/issues/1752](https://github.com/mrdoob/three.js/issues/1752)

并查看最新的开发版本 (v.50)。

# android - Android：我的按钮图像在应用程序中放大了吗？

> ID：11398713
> 
> 赞同：0
> 
> 时间：2012-07-09T15:52:57.717
> 
> 标签：android, image, button

我使用一个带有图像作为背景的按钮，该图像的大小为 30x29，但它已调整大小并放大 x2（我认为）。这是我的按钮的 XML 代码：

```
<Button
        android:id="@+id/buttonBack"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginLeft="12dp"
        android:layout_marginTop="10dp"
        android:background="@drawable/bouton_back"
        android:maxHeight="30dp"
        android:maxWidth="30dp" /> 
```

在 Java 中：

```
backButton = (Button) findViewById(R.id.buttonBack); 
```

那有什么问题？我对其他按钮也这样做，没有问题......谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:01:26.827

我认为这可能是文件夹问题。你把图像文件放在哪里了？（如果你有它可能不会有问题`drawable-hdpi`）

编辑

ps - 还有一个 dp 单位的东西，它与像素无关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:31:23.137

您正在使用*背景*属性，android 将根据 dpi 中的设备分辨率（**ldpi**、**mdpi**、**hdpi**和**xhdpi**屏幕）拉伸您的图像，如果您将图像放在 drawable-mdpi 文件夹中，您的图像将根据此系数进行拉伸

![在此处输入图像描述](../Images/9c02f0dd0dbb27c5b1d232273b2d9a4b.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T16:41:35.247

您是否`bouton_back`使用多种密度提供资源？使用`dp`单位来调整按钮的大小是不够的；您还必须[提供多种尺寸](http://developer.android.com/guide/practices/screens_support.html)的图像：

*   分辨率：120dpi
*   mdpi：160dpi
*   高清：240dpi
*   xhdpi: 320dpi

转换公式如下：

```
px = dp * (dpi / 160) 
```

其中`px`是最终图像大小（以像素为单位），`dp`是与密度无关的所需大小，`dpi`是目标密度。

简化此公式，使用`mdpi`图像的像素大小作为基线：

```
ldpi = mdpi * 0.75
hdpi = mdpi * 1.5
xhdpi = mdpi * 2.0 
```

回到您的示例代码，如果您想要一个 30dp x 30dp 的按钮，您应该为每个密度提供图像：

*   ldpi：23 像素 x 23 像素
*   mdpi：30 像素 x 30 像素
*   hdpi: 45 像素 x 45 像素
*   xhdpi: 60 像素 x 60 像素

# android - 如何以编程方式禁用 Google 的自动更新？（冰淇淋三明治）

> ID：11398719
> 
> 赞同：3
> 
> 时间：2012-07-09T15:53:27.123
> 
> 标签：android

我的公司制作了一款平板电脑 Android 应用程序来控制工业流程。我们一直在使用 Galaxy Tab 10.1，但由于它在美国不再可用，我们正在评估运行 4.03的 Galaxy Tab **2 10.1。**我们发货的平板电脑预装了我们的应用程序，并且该应用程序已使用平板电脑上运行的 Android 软件版本进行了仔细测试。

当我设置其中一个新平板电脑时，设置向导会显示一条消息，上面写着“*您同意您的平板电脑可以接收并安装来自 Google 的更新*”这不是在问我，而是在**告诉**我；没有地方说“不”或不同意。自动更新在设置中被禁用。

如何以编程方式防止强制更新平板电脑？我们的用户连接到局域网，因为平板电脑用于控制其他工业产品，但**从来没有**任何需要连接到工厂墙壁之外的网络，但我们无法对我们的客户强制执行。风险在于谷歌可能会强制对平板电脑进行更改，这可能会破坏我们的应用程序。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T17:06:15.160

> 如何以编程方式防止强制更新平板电脑？

构建您自己的固件并使用它而不是库存固件。

> 风险在于谷歌可能会强制对平板电脑进行更改，这可能会破坏我们的应用程序。

阻止固件更新的风险在于三星（不是谷歌）可能会向平板电脑提供更新，以修复您的客户会喜欢的固件中的缺陷（例如，更好的 WiFi 连接）。

请理解您使用的设备是*消费类*设备。此类设备并非旨在用于“控制工业过程”。期望是，如果您在此类设置中使用 Android，您将采购自己的设备并控制您的固件。唉，目前还没有很多支持，这[是我最近在博客上写](http://commonsware.com/blog/2012/07/05/who-will-become-androids-red-hat.html)的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T16:03:47.387

只要您以所需的 API 为目标，对系统的更新就不会破坏您应用程序的任何功能。要回答您的问题，您不能以编程方式禁用自动更新，这是一个用户功能。

还要检查此链接：以[编程方式启用/禁用市场自动更新](https://stackoverflow.com/questions/7355917/programatically-enable-disable-market-auto-update)

# php - 迭代解析的 json 数组数组

> ID：11398721
> 
> 赞同：0
> 
> 时间：2012-07-09T15:53:30.900
> 
> 标签：php, json, titanium, appcelerator

我正在从 php 检索 json 到手机，代码如下

```
$a = array('name'=>'pop', 'age'=>'32', 'kids'=>array('tim', 'john') );
echo json_encode($a); 
```

在移动设备中，我可以很好地接收数据，但是在解析 json 并尝试使用其键访问“孩子”元素时，它给了我一个错误。手机代码如下：

```
var json = this.responseText;  
var response = JSON.parse(json);
alert(response.kids[0]); 
```

错误 ：

![在此处输入图像描述](../Images/cf6dc471a1186ce8a070ca9cd298ef54.png)

尝试获取“kids.length”时也会发生这种情况..有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T16:01:59.883

您的 PHP 数组无效。

```
$a = array('name'='pop', 'age'=>'32', 'kids'=>array('tim', 'john') ); 
```

应该：

```
$a = array('name' => 'pop', 'age'=>'32', 'kids' => array('tim', 'john') ); 
```

# websphere - WebSphere 8：Axis2 WS 的 JAX-WS 客户端

> ID：11398724
> 
> 赞同：1
> 
> 时间：2012-07-09T15:53:58.683
> 
> 标签：websphere, jax-ws, axis2

我正在尝试为使用 Axis2、WebSphere8、Java 1.6 公开的服务编写 JAX WS 客户端。独立客户端（即在我的本地机器上运行的客户端）工作正常，但是当我将客户端部署到运行在同一 websphere 服务器中的应用程序中时，我就 `java.lang.ClassCastException: Cannot cast class org.apache.axis2.jaxws.spi.Provider to class javax.xml.ws.spi.Provider` 在线了 `OpenPortType service = OpenService .create(wsdlFile.toURL(), new QName( "http://www.test.com/schemas/public/open-api/Open/","OpenService")).getPort( OpenPortType.class);`

当我尝试用谷歌搜索时，我发现 weblogic 中存在类似的问题：[https](https://wso2.org/jira/browse/CARBON-4835) : //wso2.org/jira/browse/CARBON-4835 当我们看到axis2.jaxws.spi.Provider 类的源代码时，我们知道它是javax.xml.ws.spi.Provider ！！我想知道可能出了什么问题？任何想法 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T15:39:11.707

除非您直接调用 Axis2 功能，而不是简单地使用 JAX-WS API，否则您不希望将 Axis 打包到您的 EAR 中。WebSphere 确实提供了它自己的 JAX-WS 实现，我并不惊讶它与您在应用程序中部署的另一个 JAX-WS 实现冲突。（特别注意，WebSphere 自己的实现是基于 Axis2。）

如果您确实需要部署不同的实现，您可能至少必须将 WebSphere 类加载器策略调整为 parent_last。可能还有更多工作要做；自从我们自己做这件事以来已经有一段时间了。但是使用内置的 JAX-WS 实现更容易和更简洁，这意味着根本不需要部署任何这些 jar。

# asp.net-mvc-3 - MVC3：无法使用 Login PartialView 向 Index.cshtml 返回登录验证错误消息

> ID：11398725
> 
> 赞同：1
> 
> 时间：2012-07-09T15:54:02.197
> 
> 标签：asp.net-mvc-3, validation, authentication, login, asp.net-mvc-partialview

我是 MVC 的新手（在 WebForms 工作了 2 年）。我正在尝试在我的 Index.cshtml 中使用 PartialView 实现登录，如下所示：

```
@Html.Action("LogOnPartial") 
```

如果用户名或密码不正确，调用的方法将按预期到达此行：

```
ModelState.AddModelError("", "The user name or password provided is incorrect."); 
```

因为它是部分视图，所以我将模型传递回 Index.cshtml，如下所示，以显示“不正确”条目：

```
// If we got this far, something failed, redisplay form
return View("Index", model); 
```

然后 Index.cshtml 将调用 @Html.Action("LogOnPartial")，这反过来会触发这个：

```
[HttpPost]
public ActionResult LogOnPartial(LogOnModel model)
{
    return PartialView(model);
} 
```

渲染后，“不正确”的条目将按预期保留在文本框中，但上述错误消息“提供的用户名或密码不正确”。不显示。我猜错误消息没有在上述方法中传递。

从局部视图返回时如何显示错误消息？

谢谢。

* * *

谢谢 Marks，你的建议很有帮助。最初我已经在 LogOnPartial.cshtml 的末尾包含了@Html.ValidationSummary()，但不知何故错误消息没有出现在 Index.cshtml 中。现在我将 @Html.ValidationSummary() 移动到 Index.cshtml 如下：

```
@Html.Action("LogOnPartial")
@Html.ValidationSummary(true, "Login was unsuccessful. Please correct the errors and try again.") 
```

现在它工作正常，我可以看到登录错误消息。

但是，现在我遇到了另一个问题。我的 Index.cshtml 中有两个部分视图。一个用于 LogOnPartial.cshtml，另一个用于 SignUpPartial.cshtml（您可能想看看 www.iguardpayroll.com，它是用 WebForms 编写的，您会看到左栏中有两个框：一个用于登录，另一个用于注册）。

除了在@Html.Action("LogOnPartial") 正下方添加@Html.ValidationSummary() 之外，我还需要在@Html.Action("SignUpPartial") 下添加它以显示由注册过程（例如电子邮件已经存在！）。但是，如果我这样做，相同的 LogOn 错误消息将在 LogOn 部分和 SignUp 部分下出现两次。

```
 <div>
      @Html.Action("LogOnPartial")
      @Html.ValidationSummary(true, "Login was unsuccessful. Please correct the errors and try again.")
    </div>
    <div>
      @Html.Action("SignUpPartial")
      @Html.ValidationSummary(true, "Sign Up was unsuccessful. Please correct the errors and try again.")   
    </div> 
```

我怎么知道第一个 @Html.ValidationSummary() 只显示与 LogOnPartial 相关的错误消息，而第二个 @Html.ValidationSummary() 只显示注册错误消息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:28:10.170

您必须使用`@Html.ValidationSummary()`表单内部来显示模型验证错误。

前任。

```
@using(Html.BeginForm())
{
   @Html.ValidationSummary()
   .. fields
} 
```

# javascript - 使用 jQuery 删除多个文本框

> ID：11398729
> 
> 赞同：0
> 
> 时间：2012-07-09T15:54:13.850
> 
> 标签：javascript, jquery, textarea

我对 JavaScript 和 jQuery 还是很陌生。

我有用于添加动态`<textarea>`s 的 jQuery“添加框”功能，但删除部分不起作用。

**我的代码：**

```
$(function() {
    var i = $('textarea').size() + 1;
    $('#remove').click(function() {
        if (i > 1) {
            $('.this:last').remove();
            i--;
        }
    });

    $('.Add').live('click', function(e) {
        $('<div><textarea id="txt"></textarea> <textarea id="txt2"></textarea></div>').fadeIn('fast').appendTo('.Option');

        i++;
    });

}); 
```

**演示：http:** [//jsfiddle.net/dnwTV/](http://jsfiddle.net/dnwTV/)

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:58:16.917

### 笔记

您正在创建多个`textarea`相同`id`的 . 这个不允许。

您可以更改添加代码，如下所示：

```
 $('.Add').live('click', function(e) {
        $('<div><textarea id="txt'+ i +'"></textarea> <textarea id="txt'+ (i+1) +'"></textarea></div>').fadeIn('fast').appendTo('.Option');
        i++;
    }); 
```

### 还有一件事情

而不是`live`，使用`on()`. 由于您没有`.Add`动态添加，因此您不需要`live`为此委托。只需使用以下内容：

```
$('.Add').on('click', function(e) {
     $('<div><textarea id="txt"></textarea> <textarea id="txt2"></textarea></div>').fadeIn('fast').appendTo('.Option');    
     i++;
}); 
```

### 您的完整代码应如下所示：

```
$(function() {
    var i = $('textarea').size() + 1;
    $('#remove').click(function() {
        i = $('textarea').size() + 1;
        if (i > 1) {
            $('.Option > textarea:last').last().remove();
            i--;
        }
    });

    $('.Add').on('click', function(e) {
        $('<textarea id="txt' + i + '"></textarea> <textarea id="txt' + (i + 1) + '"></textarea>').fadeIn('fast').appendTo('.Option');
        i++;
    });
}); 
```

**[工作样本](http://jsfiddle.net/dnwTV/20/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T15:58:57.790

您正在选择`.this:last`，并且不存在带有 a`class`的元素`this`。`textarea:last`改为用作选择器。此外，您的标记不一致；原件应该有另一个`<div>`包裹这两个`<textarea>`s。[这是您的 jsFiddle 的更正版本。](http://jsfiddle.net/dnwTV/6/)

```
$(function() {
    var i = $('.Option > div').size() + 1;

    $('#remove').click(function(e) {
        if (i > 1) {
            $('.Option > :last').remove();
            i--;
        }

        e.preventDefault();
    });

    $('.Add').click(function(e) {
        $('<div><textarea id="txt"></textarea> <textarea id="txt2"></textarea></div>').fadeIn('fast').appendTo('.Option');

        i++;
    });
});​ 
```

**也就是说**，我不相信您当前的代码足够简洁或通用。[请参阅此 jsFiddle](http://jsfiddle.net/dnwTV/15/)以获取有关如何使其更清洁的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T15:59:20.800

这是一个更新的小提琴

[http://jsfiddle.net/dnwTV/5/](http://jsfiddle.net/dnwTV/5/)

**Javascript**：

```
$(function() {

    $('#remove').click(function() {
        $('.Option div:last').remove();                
    });

    $('.Add').live('click', function(e) {
        var i = $('textarea').length + 1;
        $('<div><textarea id="txt' + i + '"></textarea> <textarea id="txt' + (i+1) + '"></textarea></div>').fadeIn('fast').appendTo('.Option');
    });
});​ 
```

还修复了您正在重用 html 的事实，`id`这应该是每页唯一的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T16:00:05.267

我相信这是您想要达到的效果：

演示：http: [//jsfiddle.net/SO_AMK/dnwTV/4/](http://jsfiddle.net/SO_AMK/dnwTV/4/)

代码：

HTML：

```
<div class='Option'><textarea id="txt"></textarea> <textarea id="txt2"></textarea> </div>
<a href="#" id="remove">Remove</a>

<br/><br/>
<span class='Add'>Add Option</span> 
```

​jQuery：

```
$(function() {
    var i = $('textarea').size() + 1;
    $('#remove').click(function() {
        if (i > 1) {
            $('textarea:last').parent().remove();
            i--;
        }
    });

    $('.Add').click(function(){
        $('<div><textarea id="txt"></textarea> <textarea id="txt2"></textarea></div>').fadeIn('fast').appendTo('.Option');

        i++;
    });

});​ 
```

# ruby-on-rails - ruby on rails ssh 连接检查有效性

> ID：11398731
> 
> 赞同：0
> 
> 时间：2012-07-09T15:54:23.067
> 
> 标签：ruby-on-rails, ruby-on-rails-3, net-ssh

如果连接建立成功，我正在控制器中建立 ssh 连接并显示视图。如果未建立连接，我需要我的操作重定向到“denied_access”视图这是我的视图，其中用户输入了他的详细信息：

```
<%= form_for :check_validity, :method => "get", :url => {:action => "check_validity"} do |f| %>
//enters user name and password here and submits
<% end%> 
```

控制器中的检查有效性操作：

```
 def check_validity
     @USER = params[:check_validity][:username]
     @PASS = params[:check_validity][:password]
     @DOMAIN = params[:check_validity][:domain]
     @HOST = 'hostname'

     Net::SSH.start( @HOST, @USER, :password => @PASS ) do|ssh|

     @result = ssh.exec!("/lclapps/oppen/http/ldap-group-list-2.4.3.py #{@DOMAIN} #{@USER} #{@PASS}")
     end
        respond_to do |format|
         if(@result =~ /Informatica Developer/)
          format.html{redirect_to display_command_list_path({:username => @USER})}
         else
          format.html{redirect_to denied_access_path}
         end
         end
  end 
```

此处连接已建立，正在检查结果中的 Informatica Developer 字符串并重定向到`display_command_list_path`. 但是我想在检查这个字符串之前检查连接是否建立，如果连接没有建立，则重定向到 denied_access_path。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:25:56.037

如果凭据无效，则尝试与`Net::SSH.start`您连接时会出现异常。`Net::SSH::AuthenticationFailed`

```
begin
  Net::SSH.start( @HOST, @USER, :password => @PASS ) do |ssh|
    # ...
  end
rescue Net::SSH::AuthenticationFailed => e
  # redirect to denied_access_path
end

# your respond_to block ... 
```

我还应该提到，如果`@HOST`不好，它会引发`SocketError`. 为此，您可以在上面的代码中添加第二个救援。

# android - GPS状态发生变化时如何接收系统广播？

> ID：11398732
> 
> 赞同：2
> 
> 时间：2012-07-09T15:54:25.540
> 
> 标签：android, gps

我写了下面的代码，但它不起作用。有谁能够帮助我？我只想被动接收GPS状态变化，而不是主动查询。省电最重要。

没有消息输出。

```
package com.sharelbs.lbs.service;  
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.util.Log;

public class GPStStatusReceiver extends BroadcastReceiver {
  public static final String GPS_ENABLED_CHANGE_ACTION = "android.location.GPS_ENABLED_CHANGE";
  @Override
    public void onReceive(Context context, Intent intent) {
      Log.d("---------log--------","GPS Status onReceive");
      if(intent.getAction().equals(GPS_ENABLED_CHANGE_ACTION)){
        Log.d("---------log--------","GPS Status Changed");
        startMyProgram();
      }
    }
} 
```

这是我的 Manifest.xml：

```
<uses-permission android:name="android.permission.ACCESS_COARSE_UPDATES" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<receiver android:name=".service.GPStStatusReceiver"> 
  <intent-filter> 
    <action android:name="android.location.GPS_ENABLED_CHANGE" /> 
  </intent-filter> 
</receiver> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-09T16:04:54.810

我相信您只是指向清单中的错误位置，更改接收者的名称：

```
<receiver android:name=".GPStStatusReceiver"> 
```

这种类型的接收器非常适合在启用 GPS 时启动应用程序，但在应用程序运行时，即使刷新间隔设置为 10 天和 1000 英里，LocationListener 的 onProviderEnabled() 或 onProviderDisable() 也会捕获这些，或者更多的。因此，如果您将大量设置传递给 requestLocationUpdates() 方法，则不一定会浪费电池电量。

**从评论添加**

我只能猜测您没有收到，`GPS_ENABLED_CHANGE`因为您没有触发位置请求。简单地通过单击位置菜单中的复选框启用 GPS 功能不会广播此意图，某些应用程序必须请求当前位置。另外，我没有找到关于这个 Intent 的任何官方文档，这意味着[Android 可能随时更改或删除它](http://android-developers.blogspot.com/2010/05/be-careful-with-content-providers.html)。

也许您想要官方支持的[LocationManager.PROVIDERS_CHANGED_ACTION](http://developer.android.com/reference/android/location/LocationManager.html#PROVIDERS_CHANGED_ACTION)，这将在 GPS 提供者（和其他提供者）启用/禁用时广播一个 Intent。

```
<action android:name="android.location.PROVIDERS_CHANGED" /> 
```

# php - 如何在 PHP 中添加日期

> ID：11398744
> 
> 赞同：0
> 
> 时间：2012-07-09T15:55:12.363
> 
> 标签：php, date, strtotime

> **可能重复：**
> [将日期增加一个月](https://stackoverflow.com/questions/2870295/increment-date-by-one-month)

我有以下代码来总结日期：

```
$var1 = date("d/m/Y");
$dia = substr($var1,0,2);
$mes = substr($var1,3,2);
$a_o = substr($var1,6,4);
$date = $a_o."-".$mes."-".$dia;
$new_date = strtotime( "+3 month", strtotime($date));
$new_date = date('d/m/Y', $new_date);
echo $new_date; 
```

这是我在 php.net 上找到的正常方法，但是当我尝试更改`$var1`另一个日期时，例如，`'21/07/2020'`结果是`'31/01/1970'`，我不知道出了什么问题。我尝试了很多形式，但结果都是一样的。

我怎样才能解决这个问题？或者还有哪些其他形式可以将 X 个月添加到日期？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T15:58:23.253

查看为 5.3.0 添加的[date_add()](http://www.php.net/manual/en/datetime.add.php)函数。

> DateTime::add -- date_add — 向 DateTime 对象添加一定数量的天、月、年、小时、分钟和秒

```
<?php
$date = new DateTime('2000-01-01');
$date->add(new DateInterval('P10D'));
echo $date->format('Y-m-d') . "\n";
?> 
```

还有为 5.2.0 添加的[date_modify()](http://www.php.net/manual/en/datetime.modify.php)函数。

> DateTime::modify -- date_modify -- 更改时间戳

```
<?php
$date = new DateTime('2006-12-12');
$date->modify('+1 day');
echo $date->format('Y-m-d');
?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-09T15:59:07.123

你完全错了。`date()`给你一个格式很好的**STRING**。如果您想对日期进行数学运算，则需要使用原生 PHP 日期/时间值，它们是简单的整数 - unix 时间戳。

您正在获取该 unix 时间戳（中的默认值`date()`），将其转换为字符串，拆分该字符串，以不同的顺序重新组合字符串，然后将其转换回时间戳，然后将时间戳转换为不同格式的字符串. 这就像进行 500 英里的公路旅行，这样您就可以过马路。

任何你不能简单地做的理由：

```
$new_date = date('d/m/Y', strtotime('+3 month')); 
```

并消除代码片段中的所有其他内容？

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-07-09T15:59:54.893

在您的位置，我将转换时间戳中的日期，然后以秒为单位添加新日期（即 3 个月是 60 * 60 * 24 * 90 = 7 776 000 秒。）然后转换回日期：P

# grails - 如何根据内容类型请求标头将结果呈现为 JSON 或使用 gsp 视图？

> ID：11398745
> 
> 赞同：1
> 
> 时间：2012-07-09T15:55:14.347
> 
> 标签：grails

我想在控制器中为 html-view 和 RESTful API 重用相同的逻辑。在 Grails 中执行此操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T15:58:43.143

[我相信您正在`withFormat`](http://grails.org/doc/latest/ref/Controllers/withFormat.html)寻找[方法](http://grails.org/doc/latest/ref/Controllers/withFormat.html)：

（此处的代码取自该链接并添加了 JSON）

```
import grails.converters.XML
import grails.converters.JSON

class BookController {

    def list() {
        def books = Book.list()

        withFormat {
            html bookList:books
            js { render books as JSON }
            xml { render books as XML }
        }
    }
} 
```

# asp.net - 选择下拉菜单时，Modalpopup 不会关闭

> ID：11398746
> 
> 赞同：0
> 
> 时间：2012-07-09T15:55:19.557
> 
> 标签：asp.net, ajax, vb.net, modalviewcontroller

我一直对模态弹出窗口有这个奇怪的问题。出于某种原因，当我选择一个下拉项时，我的更新按钮不会触发点击事件。但随后我将下拉菜单保留为默认值，更新按钮工作得很好。

这是我的 aspx 页面代码

```
<asp:Button ID="Button1" CssClass="hide" runat="server" Text="Button" />

<ajaxToolkit:ModalPopupExtender runat="server" ID="cfPopUp" PopupControlID="Panel4"
    TargetControlID="Button1" OkControlID="cfUpdateBtn" CancelControlID="cfCancelBtn" />
<asp:Panel ID="Panel4" runat="server" CssClass="modalPopup">
    <asp:UpdatePanel ID="UpdatePanel2" runat="Server">
        <ContentTemplate>
            <asp:Panel ID="Panel13" CssClass="" runat="server">
                <asp:Panel ID="Panel14" CssClass="" runat="server">
                    <div style="padding: 10px; border: 3px solid black; background-color: White; color: Black;">
                        <asp:Label ID="Label25" Width="200px" runat="server" Text="Health and Safety Net" /><div
                            class="seperator">
                        </div>
                        <table class="style143">
                            <tr>
                                <td class="style185">
                                    <asp:Label ID="cfCategorylbl" runat="server" Text="Category:"></asp:Label>:
                                </td>
                                <td>
                                    <asp:DropDownList ID="cbFactors_Categories" runat="server" Width="350px" Font-Names="Tahoma"
                                        Font-Size="Small" ForeColor="DimGray" Height="24px" CssClass="style75">
                                    </asp:DropDownList>
                                    <ajaxToolkit:CascadingDropDown ID="CascadingDropDown3" runat="server" TargetControlID="cbFactors_Categories"
                                        Category="categories" ServiceMethod="getCategory" ServicePath="~/2012/IrSubmitWebService.asmx"
                                        PromptText="Select Category" />
                                </td>
                                <td align="center" rowspan="3" valign="top">
                                    <asp:Label ID="lblFactor_ID" runat="server" Font-Names="Tahoma" Font-Size="Small"
                                        ForeColor="DimGray" Style="font-style: italic" TabIndex="56"></asp:Label>
                                    <cc1:DynamicPopulateExtender ID="lblFactor_ID_DynamicPopulateExtender" runat="server"
                                        Enabled="True" TargetControlID="lblFactor_ID" BehaviorID="dp1" ServiceMethod="getFactorID"
                                        ServicePath="~/2012/IrSubmitWebService.asmx">
                                    </cc1:DynamicPopulateExtender>
                                    <hr class="style157" />
                                    <asp:Label ID="cfID" runat="server" Font-Names="Tahoma" Font-Size="Small" ForeColor="DimGray"
                                        Style="font-style: italic" Width="400px" TabIndex="57"></asp:Label>
                                </td>
                            </tr>
                            <tr>
                                <td class="style185">
                                    <asp:Label ID="cfTypeslbl" runat="server" Text="Type:"></asp:Label>
                                </td>
                                <td>
                                    <asp:DropDownList ID="cbFactors_Types" runat="server" ForeColor="DimGray" Height="24px"
                                        TabIndex="54" Width="350px" Font-Names="Tahoma" Font-Size="Small" CssClass="style75">
                                    </asp:DropDownList>
                                    <cc1:CascadingDropDown ID="cbFactors_Types_CascadingDropDown" runat="server"
                                        TargetControlID="cbFactors_Types" ParentControlID="cbFactors_Categories" Category="type"
                                        ServiceMethod="getTypeofAction" ServicePath="~/2012/IrSubmitWebService.asmx"
                                        PromptText="Select Type">
                                    </cc1:CascadingDropDown>
                                </td>
                            </tr>
                            <tr>
                                <td class="style185">
                                    <asp:Label ID="cfFactorslbl" runat="server" Text="Factor:"></asp:Label>
                                </td>
                                <td>
                                    <asp:DropDownList ID="cbFactors_Factors" runat="server" ForeColor="DimGray" Height="24px"
                                        TabIndex="55" Width="350px" Font-Names="tahoma" Font-Size="Small" CssClass="style75">
                                    </asp:DropDownList>
                                    <cc1:CascadingDropDown ID="cbFactors_Factors_CascadingDropDown" runat="server"
                                        TargetControlID="cbFactors_Factors" ParentControlID="cbFactors_Types" Category="category"
                                        ServiceMethod="getFactor" ServicePath="~/2012/IrSubmitWebService.asmx" PromptText="Select Factor">
                                    </cc1:CascadingDropDown>
                                </td>
                            </tr>
                            <tr>
                                <td class="style185">
                                    <asp:Label Text="Justification:" ID="cfJustificationlbl" runat="server"></asp:Label>
                                </td>
                                <td colspan="2">
                                    <asp:TextBox ID="txtJustification" runat="server" ForeColor="DimGray" Height="29px"
                                        Style="font-family: Tahoma; font-size: small" TabIndex="56" TextMode="MultiLine"
                                        ToolTip="Provide a justification for this factor." Width="775px" Font-Names="Tahoma"
                                        Font-Size="Small"></asp:TextBox>
                                   </td>
                            </tr>
                        </table>
                        <br />
                        <div style="text-align: center">
                            <asp:Button CausesValidation="false" ID="cfUpdateBtn" runat="server"
                                Text="Update" CssClass="button" /><span style="margin-left: 10px"><asp:Button CausesValidation="false"
                                    ID="cfCancelBtn" runat="server" Text="Cancel" CssClass="button" /></span></div>
                    </div>
                </asp:Panel>
            </asp:Panel>
        </ContentTemplate>
    </asp:UpdatePanel>
</asp:Panel> 
```

以及我的更新代码（它只是关闭了弹出窗口）

```
Protected Sub cfUpdateBtn_Click(sender As Object, e As EventArgs) Handles cfUpdateBtn.Click
    cfPopUp.Hide()
End Sub 
```

对于我的一生，我无法弄清楚为什么当下拉列表不是默认值时更新按钮不起作用。

谢谢你们的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T18:29:56.920

可能的原因可能是您将下拉列表与 Web 服务绑定。每当您单击下拉列表中的某个项目时，可能会调用 Web 服务。如果调用 web 服务，那么您的页面可能会再次加载吗？我不知道它不起作用的确切原因。您必须检查调用服务时发生的服务行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T17:42:36.693

我基本上像这样重建了我的模态弹出窗口和更新面板

```
<asp:Panel ID="pnlEditPopup" runat="server" CssClass="modalPopup">
    <asp:UpdatePanel ID="UpdatePanel2" runat="server">
    <ContentTemplate>

        <asp:Panel ID="pnlEditPopupContent" runat="server">
            <div style="padding: 10px; border: 3px solid black; background-color: White; color: Black;">
            <table cellpadding="0" cellspacing="4" border="0">
            <tr>
                <td class="name">Category:</td>
                <td class="value">
                    <asp:DropDownList id="ddCat" runat="server">
                        <asp:listitem value="">No Selection</asp:listitem>
                        <asp:listitem value="Action">Action</asp:listitem>
                        <asp:listitem value="Worksite">Worksite</asp:listitem>
                        <asp:listitem value="Human Factors">Human Factors</asp:listitem>
                        <asp:listitem value="System Factors">System Factors</asp:listitem>
                    </asp:DropDownList>
                </td>
            </tr>
            <tr>
                <td class="name">Type:</td>
                <td class="value">
                    <asp:DropDownList id="ddType" runat="server" />
                    <ajaxToolkit:CascadingDropDown ID="ccType" runat="server"
                        TargetControlID="ddType"
                        ParentControlID="ddCat"
                        PromptText="No Selection"
                        LoadingText="Please Wait..."
                        ServicePath="~/2012/IrSubmitWebService.asmx"
                        ServiceMethod="getTypeofAction"
                        Category="Other"
                    />
                </td>
            </tr>
             <tr>
                <td class="name">Factor:</td>
                <td class="value">
                    <asp:DropDownList id="ddfactor" runat="server" />
                    <ajaxToolkit:CascadingDropDown ID="ccFactor" runat="server"
                        TargetControlID="ddfactor"
                        ParentControlID="ddType"
                        PromptText="No Selection"
                        LoadingText="Please Wait..."
                        ServicePath="~/2012/IrSubmitWebService.asmx"
                        ServiceMethod="getFactor"
                        Category="Other"
                    />
                </td>
            </tr>
            <tr>
                <td>
                    Justification:
                    <asp:Label ID="factorID" runat="server" Visible="false"></asp:Label>
                </td>

                <td>
                    <asp:TextBox ID="txtJustification" runat="server" ForeColor="DimGray" Height="100px"
                    Style="font-family: Tahoma; font-size: small" TabIndex="56" TextMode="MultiLine"
                    ToolTip="Provide a justification for this factor." Width="300px" Font-Names="Tahoma"
                    Font-Size="Small"></asp:TextBox>
                </td>
            </tr>
             <tr>
                <td>
                    Factor ID<br />
                    and Description:             
                </td>
                <td>
                    <asp:Label ID="factor_id_Desc" runat="server" Width="300px" Font-Names="Tahoma" Font-Size="Small"
                        ForeColor="DimGray" TabIndex="56"></asp:Label>
                    <cc1:DynamicPopulateExtender ID="DynamicPopulateExtender1" runat="server"
                        Enabled="True" TargetControlID="factor_id_Desc" BehaviorID="dp1" ServiceMethod="getFactorID"
                        ServicePath="~/2012/IrSubmitWebService.asmx">
                    </cc1:DynamicPopulateExtender>
                </td>
            </tr>
            <tr>
                <td colspan="2" align="center">
                    <asp:Button ID="btnOkEditPopup" runat="server" Text="Ok" CssClass="button"/>
                    <span style="margin-left:10px"><asp:button id="btnCancelEditPopup" runat="server" text="Cancel" CssClass="button"/></span>
                </td>
            </tr>

            </table>
            </div>
        </asp:Panel>

    </ContentTemplate>
    </asp:UpdatePanel>
    </asp:Panel>

    <ajaxToolkit:ModalPopupExtender ID="mpeEdit" runat="server"
        TargetControlID="btnOpenEditPopup"
        PopupControlID="pnlEditPopup"
        /> 
```

修复了我的问题。当我问这个问题时，我仍然不知道为什么它不起作用，但我能够解决它。感谢所有为我调查的人。

# .net - 使用 Windows API 时出现致命的ExecutionEngineError

> ID：11398749
> 
> 赞同：1
> 
> 时间：2012-07-09T15:55:30.443
> 
> 标签：.net, winforms, netapi32

我正在尝试使用调用`netapi32.dll`来操作 DFS 共享的 Windows API .dll。我们在 Windows Server 2008 R2 上使用 DFS，而我使用的是 .NET 4.0。我以前从未在 .NET 中使用过这样的东西，但我无法理解失败的原因。

我正在使用`DllImport`调用[NetDfsGetInfo](http://msdn.microsoft.com/en-us/library/windows/desktop/bb524812%28v=vs.85%29.aspx)来测试获取有关 DFS 共享的信息。我必须为我想从函数接收的信息级别创建结构。

```
public struct DFS_INFO_3
{
    [MarshalAs(UnmanagedType.LPWStr)]
    public string EntryPath;
    [MarshalAs(UnmanagedType.LPWStr)]
    public string Comment;
    public UInt32 State;
    public UInt32 NumberOfStorages;
    public IntPtr Storage;
}

public struct DFS_STORAGE_INFO
{
    public ulong State;
    [MarshalAs(UnmanagedType.LPWStr)]
    public string ServerName;
    [MarshalAs(UnmanagedType.LPWStr)]
    public string ShareName;
} 
```

我使用以下代码获取并读取结果：

```
[DllImport("netapi32", CallingConvention = CallingConvention.Winapi)]
public static extern int NetDfsGetInfo(
                    [MarshalAs(UnmanagedType.LPWStr)] string DfsEntryPath,
                    [MarshalAs(UnmanagedType.LPWStr)]string ServerName, 
                    [MarshalAs(UnmanagedType.LPWStr)]string ShareName, 
                    int Level, 
                    out IntPtr Buffer);

public void GetInfo() {
    IntPtr buffer;
    string dfsPath = "\\\\server\\share";

    int result = NetDfsGetInfo(EntryPath, null, null, 3, out buffer);

    if (result == 0) { //0 is Success
        DFS_INFO_3 info = (DFS_INFO_3)Marshal.PtrToStructure(buffer, typeof(DFS_INFO_3));
        DFS_STORAGE_INFO storage = (DFS_STORAGE_INFO)Marshal.PtrToStructure(info.Storage, typeof(DFS_STORAGE_INFO)); //Error
        Console.WriteLine("{0}, {1}, {2} ", storage.ServerName, storage.ShareName, storage.State);
    }
} 
```

一切都很好，直到它去读这`storage`条线。

我**有时会**收到一条错误消息：

> 运行时遇到致命错误。错误地址位于线程 0x1d44 上的 0x626ac91c。错误代码为 0xc0000005。此错误可能是 CLR 中的错​​误或用户代码的不安全或不可验证部分中的错误。此错误的常见来源包括 COM 互操作或 PInvoke 的用户封送错误，这可能会损坏堆栈。

错误类型是[fatalExecutionEngineError](http://msdn.microsoft.com/en-us/library/ms228990.aspx)，它不是 .NET 异常，所以我无法捕捉到它。它不会每次都发生，但我会说大约 50% 的时间会出现此错误。查找[Windows 错误代码](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681382%28v=vs.85%29.aspx)，我看到 5 是“拒绝访问”。由于只精通介绍级 Comp Sci，我对指针（`IntPtr`对象是什么）有所了解，并且指针可能已经溢出到它不应该的结果中？我仍然不明白为什么这个错误只会在某些时候发生。

我如何理解/避免这个错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:07:22.297

你的定义`DFS_STORAGE_INFO`不正确。在 .NET 中 a`long/ulong`是 64 位，而在非托管 Win32 中它只有 32 位（与 int/uint 相同）

```
public struct DFS_STORAGE_INFO
{
    public UInt32 State;
    [MarshalAs(UnmanagedType.LPWStr)]
    public string ServerName;
    [MarshalAs(UnmanagedType.LPWStr)]
    public string ShareName;
} 
```

当您编组时，`DFS_STORAGE_INFO`您将读取结构末尾之后的 4 个字节 - 这可能会或可能不会工作，具体取决于结构之后的内容。

# linux - 恢复 Snow Leopard 上文档的符号链接

> ID：11398753
> 
> 赞同：0
> 
> 时间：2012-07-09T15:55:42.977
> 
> 标签：linux, macos, macros, terminal, osx-snow-leopard

问题：将别名恢复到其原始目标

在终端中，它看起来像这样：

```
Documents -> /Users/[Username]/Documents 
```

如何将其更改为原始版本？现在它只是一个别名。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:54:58.267

解决任务（来自问题下的讨论）：

```
The directory already exist (i.e., Documents) and is located
in /Users/[Username]/Documents. I just want to remove the link
and instead put the directory there 
```

您需要执行以下操作：

```
$ rm Documents
$ mv /Users/[Username]/Documents . 
```

但首先检查您是否真的删除了链接：

```
$ ls -ld Documents 
```

输出中字符串的第一个字母必须是`l`（对于符号链接）。

# sql - 如何过滤Sql类型的字符串

> ID：11398757
> 
> 赞同：0
> 
> 时间：2012-07-09T15:55:54.830
> 
> 标签：sql

我是 SQL 新手，我知道如何在十进制类型的 sql 中使用过滤器，但这次我使用的是字符串类型。

*   我需要过滤大于“3 小时”或“180 分钟”的任何内容
*   我能够让它过滤任何大于“3 hrs”的东西
*   但无法过滤超过 180 分钟的任何内容

这是此表的输出屏幕截图。

![在此处输入图像描述](../Images/10f72169539066c07a76f82d0488a5c1.png)

这是 SQL 选择语句，它正在工作

```
SELECT EVENTID,
       STARTDATETIME,
       F_NAME,
       DURATIONHM,
       NUM_PEOPLE

  FROM EVENT_FACT
  where DURATIONHM > '3 hrs' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:04:08.557

您无法按照您想要的方式编写查询。您需要将持续时间以分钟为单位存储为数字，然后使用：

```
where duration >= 3*60 
```

您可以通过大量努力创建一个解析字符串以获取分钟的视图。在某些数据库中，您还可以将这样的字符串转换为时间或间隔数据类型，这会让您走得更远。

但是，您发现将持续时间存储为字符串不符合您对该字段的查询要求。（如果您尝试按持续时间排序，您会发现同样的事情。）

# c++ - 从网络摄像头预览中捕获图像的最佳 DirectShow 方式？SampleGrabber 已弃用

> ID：11398758
> 
> 赞同：5
> 
> 时间：2012-07-09T15:55:55.763
> 
> 标签：c++, directshow

我开发了 DirectShow C++ 应用程序，它成功地将网络摄像头视图预览到提供的窗口中。现在我想从这个实时网络摄像头预览中捕获图像。为此，我使用了图形管理器、ICaptureGraphBuilder2、IMoniker 等。我搜索并找到了以下选项：WIA 和 Sample Grabber。许多人建议使用 SampleGrabber，但根据 MS 的 msdn 文档， [SampleGrabber](http://msdn.microsoft.com/en-us/library/windows/desktop/dd376984%28v=vs.85%29.aspx)已被弃用，不应使用。而且我不想使用 WIA API。

那么从实时网络摄像头预览中捕获图像的最佳 DirectShow 方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T18:20:03.947

这是[来自 DirectShow.NET 库的 DxSnap 示例](http://sourceforge.net/projects/directshownet/files/DirectShowSamples/2010-February/)的引用：

> 使用 DirectShow 从捕获设备的 Still 引脚拍摄快照。请注意，MS 鼓励您为此使用 WIA，但如果您想使用 DirectShow 和 C#，请参考以下方法。
> 
> 请注意，此示例仅适用于将未压缩视频输出为 RBG24 的设备。这将包括大多数网络摄像头，但可能是零电视调谐器。

这是 C# 代码，但你应该明白，因为接口都是一样的。还有其他关于如何`Sample Grabber Filter`在 C++ 中使用的示例。

Sample Grabber 已被弃用，标头已从几个最新的 SDK 中删除，但运行时组件都存在并且将存在很长时间，否则会破坏大量应用程序（例如托管浏览器中的视频聊天GMail 正在使用 Sample Grabber）。所以基本上 Sample Grabber 仍然是一种从网络摄像头捕获快照的简单方法，或者如果您更喜欢遵循最新的 MS API - 您可能想查看 Media Foundation（**2016 年 7 月 9 日更新**：新的 Windows Server 安装可能需要一个添加“Media Foundation”和/或“Desktop Experience”功能以使 Media Foundation API 与 DirectShow 和 DirectShow 编辑服务一起可用，Sample Grabber 是其中的一部分。默认安装不提供 qedit。

同样在 C++ 中，您当然不必使用 Sample Grabber Filter。您可以使用 DirectShow BaseClasses 开发自定义过滤器作为自定义转换过滤器或自定义渲染器，它们接受传入的视频源并从 DirectShow 管道导出帧。另一种选择是使用来自旧 SDK 的 Sample Grabber 示例源代码（这不是 OS Sample Grabber 的确切源代码，但它正在做同样的事情）。然而，Windows 附带的 Sample Grabber 仍然是一个不错的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-13T07:02:57.340

天啊...这么多虚假信息。如果您在 directshow 图表中进行预览，那么这取决于您要预览的内容。捕获过滤器有 1、2 或 3 个引脚。如果它有 1 个引脚，则很可能是“捕获”引脚（无预览引脚）。为此，如果您想同时捕捉和预览，您应该放入“Smart Tee”过滤器，并将 VMR 连接到预览引脚上，并将“抓帧的东西”从捕捉引脚上连接起来。因为您不想与 DirectShow 的糟糕引脚开始/停止东西混在一起（相反，只是简单地控制整个图形的开始/停止状态）。您不需要使用 SampleGrabber，它是一个非常简单的过滤器，您可以在几个小时内编写它（我应该知道，我是编写它的人）。它' s 只是一个 CTransInPlace 过滤器，您可以为其设置强制媒体类型以使其接受，并且您可以在其上设置回调接口以在收到样本时回调您。实际上，编写一个 NullRenderer 会更简单，它会在收到样本时回调您，您可以很容易地编写它。

如果捕获过滤器有 2 个引脚，它很可能是一个捕获引脚和一个静止引脚。在这种情况下，您仍然需要将 Smart Tee 连接到源的捕获引脚，并且需要从智能三通的预览引脚进行预览，并从智能三通的捕获引脚捕获样本。

（如果您不知道 SmartTee 是什么，它是一个过滤器，可以播放分配器技巧，并且仅在捕获引脚没有被超级阻塞时才将样本发送到预览引脚。它的工作是为 VMR 提供一条路径渲染不会破坏捕获过滤器和捕获过滤器下游过滤器之间的分配器）

如果捕获过滤器同时具有捕获和预览引脚，我想你可以弄清楚你需要做什么。

总之，总结：SampleGrabber 只是一个 CTransInPlaceFilter。您也可以将其编写为 Null Renderer，只需确保在 CheckInputType 中填写一些垃圾内容，并在 DoRenderSample 中回调您的回调。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T01:42:35.433

Microsoft 网站上列出了如何使用 IVMRWindowlessControl9::GetCurrentImage 捕获帧的示例......这是一种方法：

```
IBaseFilter*            vmr9ptr; // I'm assuming that you got this pointer already
IVMRWindowlessControl9* controlPtr = NULL;

vmr9ptr->QueryInterface(IID_IVMRWindowlessControl9, (void**)controlPtr);
assert ( controlPtr != NULL );

// Get the current frame
BYTE*   lpDib = NULL;
hr = controlPtr->GetCurrentImage(&lpDib);

// If everything is okay, we can create a BMP
if (SUCCEEDED(hr))
{
    BITMAPINFOHEADER*   pBMIH = (BITMAPINFOHEADER*) lpDib;
    DWORD               bufSize = pBMIH->biSizeImage;

    // Let's create a bmp
    BITMAPFILEHEADER    bmpHdr;
    BITMAPINFOHEADER    bmpInfo;
    size_t              hdrSize     = sizeof(bmpHdr);
    size_t              infSize     = sizeof(bmpInfo);

    memset(&bmpHdr, 0, hdrSize);
    bmpHdr.bfType                   = ('M' << 8) | 'B';
    bmpHdr.bfOffBits                = static_cast<DWORD>(hdrSize + infSize);
    bmpHdr.bfSize                   = bmpHdr.bfOffBits + bufSize;

    // Builder the bit map info.
    memset(&bmpInfo, 0, infSize);
    bmpInfo.biSize                  = static_cast<DWORD>(infSize);
    bmpInfo.biWidth                 = pBMIH->biWidth;
    bmpInfo.biHeight                = pBMIH->biHeight;
    bmpInfo.biPlanes                = pBMIH->biPlanes;
    bmpInfo.biBitCount              = pBMIH->biBitCount;

    // boost::shared_arrays are awesome!
    boost::shared_array<BYTE> buf(new BYTE[bmpHdr.bfSize]);//(lpDib);
    memcpy(buf.get(),                       &bmpHdr,    hdrSize); // copy the header
    memcpy(buf.get() + hdrSize,             &bmpInfo,   infSize); // now copy the info block
    memcpy(buf.get() + bmpHdr.bfOffBits,    lpDib,      bufSize);

    // Do something with your image data ... seriously...
    CoTaskMemFree(lpDib);

} // All done! 
```

# java - 自定义 HashMap 代码问题

> ID：11398762
> 
> 赞同：2
> 
> 时间：2012-07-09T15:56:04.487
> 
> 标签：java, hashmap, hashtable, key-value

我有以下代码，其中我使用 HashMap（使用两个并行数组）来存储键值对（键可以有多个值）。现在，我必须存储和加载它以供将来使用，这就是我使用文件通道存储和加载它的原因。这段代码的问题是：我可以在我的 8 GB 服务器中存储近 1.2 亿个键值对（实际上，我可以为我的 JVM 分配 8 GB 中的近 5 GB，而这两个并行数组占用将近 2.5 GB，其他内存用于我的代码的各种处理）。但是，我必须存储近 600/7 亿个键值对。任何人都可以帮助我如何修改此代码，因此我可以存储近 600/7 亿个键值对。或者对此的任何评论对我来说都会很好。还有一点，我必须在内存中加载和存储哈希图。使用文件通道需要一点时间。根据 Stack Overflow 的各种建议，我没有找到更快的建议。我也使用过 ObjectOutputStream，压缩输出流，但是比下面的代码慢。无论如何以这种方式存储这两个并行数组，因此加载时间会快得多。我在下面的代码中给出了一个测试用例。对此的任何评论也将对我有所帮助。

```
import java.io.*;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.Arrays;
import java.util.Random;
import java.nio.*;
import java.nio.channels.FileChannel;
import java.io.RandomAccessFile;

public class Test {

    public static void main(String args[]) {

        try {

            Random randomGenerator = new Random();

            LongIntParallelHashMultimap lph = new LongIntParallelHashMultimap(220000000, "xx.dat", "yy.dat");

            for (int i = 0; i < 110000000; i++) {
                lph.put(i, randomGenerator.nextInt(200000000));
            }

            lph.save();

            LongIntParallelHashMultimap lphN = new LongIntParallelHashMultimap(220000000, "xx.dat", "yy.dat");
            lphN.load();

            int tt[] = lphN.get(1);

            System.out.println(tt[0]);

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}

class LongIntParallelHashMultimap {

    private static final long NULL = -1L;
    private final long[] keys;
    private final int[] values;
    private int size;
    private int savenum = 0;
    private String str1 = "";
    private String str2 = "";

    public LongIntParallelHashMultimap(int capacity, String st1, String st2) {
        keys = new long[capacity];
        values = new int[capacity];
        Arrays.fill(keys, NULL);
        savenum = capacity;
        str1 = st1;
        str2 = st2;
    }

    public void put(long key, int value) {
        int index = indexFor(key);
        while (keys[index] != NULL) {
            index = successor(index);
        }
        keys[index] = key;
        values[index] = value;
        ++size;
    }

    public int[] get(long key) {
        int index = indexFor(key);
        int count = countHits(key, index);
        int[] hits = new int[count];
        int hitIndex = 0;

        while (keys[index] != NULL) {
            if (keys[index] == key) {
                hits[hitIndex] = values[index];
                ++hitIndex;
            }
            index = successor(index);
        }

        return hits;
    }

    private int countHits(long key, int index) {
        int numHits = 0;
        while (keys[index] != NULL) {
            if (keys[index] == key) {
                ++numHits;
            }
            index = successor(index);
        }
        return numHits;
    }

    private int indexFor(long key) {
        return Math.abs((int) ((key * 5700357409661598721L) % keys.length));
    }

    private int successor(int index) {
        return (index + 1) % keys.length;
    }

    public int size() {
        return size;
    }

    public void load() {
        try {
            FileChannel channel2 = new RandomAccessFile(str1, "r").getChannel();
            MappedByteBuffer mbb2 = channel2.map(FileChannel.MapMode.READ_ONLY, 0, channel2.size());
            mbb2.order(ByteOrder.nativeOrder());
            assert mbb2.remaining() == savenum * 8;
            for (int i = 0; i < savenum; i++) {
                long l = mbb2.getLong();
                keys[i] = l;
            }
            channel2.close();

            FileChannel channel3 = new RandomAccessFile(str2, "r").getChannel();
            MappedByteBuffer mbb3 = channel3.map(FileChannel.MapMode.READ_ONLY, 0, channel3.size());
            mbb3.order(ByteOrder.nativeOrder());
            assert mbb3.remaining() == savenum * 4;
            for (int i = 0; i < savenum; i++) {
                int l1 = mbb3.getInt();
                values[i] = l1;
            }
            channel3.close();
        } catch (Exception e) {
            System.out.println(e);
        }
    }

    public void save() {
        try {
            FileChannel channel = new RandomAccessFile(str1, "rw").getChannel();
            MappedByteBuffer mbb = channel.map(FileChannel.MapMode.READ_WRITE, 0, savenum * 8);
            mbb.order(ByteOrder.nativeOrder());

            for (int i = 0; i < savenum; i++) {
                mbb.putLong(keys[i]);
            }
            channel.close();

            FileChannel channel1 = new RandomAccessFile(str2, "rw").getChannel();
            MappedByteBuffer mbb1 = channel1.map(FileChannel.MapMode.READ_WRITE, 0, savenum * 4);
            mbb1.order(ByteOrder.nativeOrder());

            for (int i = 0; i < savenum; i++) {
                mbb1.putInt(values[i]);
            }
            channel1.close();
        } catch (Exception e) {
            System.out.println("IOException : " + e);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T21:30:30.410

鉴于您声明的数据类型，我怀疑这是可能的。只需乘以原始类型的大小。

每行需要 4 个字节来存储一个 int 和 8 个字节来存储一个 long。6 亿行 * 每行 12 字节 = 7200 MB = 7.03 GB。你说你可以分配 5 GB 给 JVM。所以即使全是堆，只存储这个自定义的HashMap，也放不下。考虑缩小所涉及的数据类型的大小或将其存储在 RAM 以外的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T14:59:04.963

将数据库放在磁盘上，而不是在内存中。重写您的操作，使它们不对数组进行操作，而是对缓冲区进行操作。然后您可以打开一个足够大的文件，并让操作使用映射缓冲区访问他们需要的部分。尝试当您实现少数最近映射的内存区域的缓存时，您的应用程序性能是否更好，这样您就不必过于频繁地映射和取消映射公共区域，而是可以将它们保留在映射中。

这应该为您提供两全其美的磁盘和内存：

*   随机访问数据结构的任何部分很容易实现
*   对表中常用部分的访问将被缓存
*   表中很少使用的部分不会占用任何内存

如您所见，这在很大程度上取决于局部性：如果某些键比其他键更常见，则性能会很好，而分布良好的键将导致每次访问都进行新的磁盘操作。因此，虽然大多数内存中的哈希映射都需要良好的分布，但将常用键映射到相似位置的其他结构在这里会表现得更好。但是，这些会干扰碰撞处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T07:09:28.493

最好使用像 sqlite 这样的内存数据库，这将产生良好的结果。

# php - 返回上一个会话 ID

> ID：11398772
> 
> 赞同：0
> 
> 时间：2012-07-09T15:57:03.897
> 
> 标签：php, zend-framework, session-cookies

我们有一个遗留（php）应用程序，接受文件上传，它们存储在取决于会话 ID 的路径中。现在我们必须为这个 webapp 提供一个非常简单的 API，通过 iOS api (iPad) 执行文件上传。我们返回一个 url，客户将在嵌入式 webkit 窗口中打开该 url。

由于上传和查看操作的会话不同，我们想获取会话参数并在文件上传的响应中返回它。然后客户端被重定向到该 url，我们将会话 id 设置为以前的 id 并继续到客户可以继续工作的页面。

显然，我尝试过的任何方法都不起作用。我们使用 Zend Framework 1，但这并不重要。我试过：

1.  设置 Set-Cookie 标头（这会导致 cookie 包含两个 PHPSESSID 值）
2.  使用 a`setcookie("PHPSESSID", $session, 3600)`设置 PHPSESSID
3.  使用 Zend http 响应`setHeader('Set-Cookie', 'PHPSESSID=....', true)`

最后两个选项什么都不做，就像我根本没有设置会话一样。我该如何解决这个问题？实际上，我们不能过多地触及遗留代码库来修改其工作方式并更改文件上传的路径解析方式。

因此，流程是：请求 api.myapp.tld -> 响应正文中的字符串 -> 使用此响应字符串作为位置打开 webkit 窗口 -> 执行请求 -> 带有重定向标头**和设置方法的响应cookie 到不同的东西**-> Webkit 执行重定向 -> 客户访问与第一个请求 api.myapp.tld 具有相同会话 ID 的页面。

如果有其他方法可以设置会话 ID，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T23:13:41.663

这不是简单的调试，但你有一些选择。我不熟悉 Zend Framework 1.x，所以这不是特定于框架的（框架有时会在顶部添加东西），而是特定于 PHP。

在 PHP 中，会话由两件事来标识：

1.  [名称](http://php.net/manual/en/function.session-name.php)（例如：常见的默认名称是`PHPSESSID`）
2.  [ID](http://php.net/manual/en/function.session-id.php)（即随机“数字”）

名称允许一次使用多个会话，而 ID 则具体标识会话。

听起来您需要并行使用两个会话 ID。我建议您使需要处理旧会话的脚本具有与当前脚本不同的会话名称。

然后，您可以使用其他会话名称传入旧版/旧会话 id，*而*当前会话可以保持原样。

我希望这些信息对你有用。如果您在实施时遇到问题，请询问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T20:48:13.447

我最终得到了一些更简单的东西。会话与这样的路径有关`/path/to/location/ . $sessionId`。当第二个会话开始时，我只是将目录从旧会话重命名为新会话。简单快速地完成这项工作。

# c# - 在 C# 中使用“new”分配/初始化/分配新变量。成功访问属性，但变量本身跟踪为空。怎么回事？

> ID：11398773
> 
> 赞同：1
> 
> 时间：2012-07-09T15:57:11.597
> 
> 标签：c#, null, monodevelop, unity3d

我遇到以下情况：

```
Foo myFoo = new Foo();   // Init a Foo, right?
myFoo.bar = 5;           // property assigned
Debug.Log(myFoo.bar);    // Properly traces the value 5 or whatever to the console
Debug.Log(myFoo);        // Traces "null" to the console..... WTF?!?!?!? 
```

这是在 MonoDevelop 中结合使用 C# 和 Unity 3.5 发生的。在这种情况下，Foo 是 Object 的子类，据我所知，它不是动态的。我在这里遗漏了 C# 的一些细微差别，因为这是非常奇怪的行为，而且我从未在 ActionScript 3 或 Objective-C 中看到它。对我来说很奇怪的是，运行时能够访问/分配同时跟踪“null”的变量的属性，甚至不会抛出 NullException 或某种错误。关于为什么会发生这种情况的任何想法都会有很大的帮助。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T19:04:44.607

您是继承 System.Object 还是 UnityEngine.Object？

UnityEngine.Object 是一个特殊类，用于表示由本机表示支持的 Unity 引擎对象。你不应该从中获得。

# java - 视频中的 Xuggler/Java 缩略图

> ID：11398776
> 
> 赞同：1
> 
> 时间：2012-07-09T15:57:26.050
> 
> 标签：java, grails, video, thumbnails, xuggler

我正在用 Grails 构建一个应用程序，但我也精通 Java。我需要显示视频文件的缩略图，然后当用户单击缩略图时，在播放器中打开该视频。（如 Youtube）。

我在想的是，当用户发布视频时，我将使用 xuggler 抓取缩略图，并将其与视频文件本身一起保存。

**问题1：**这是一个好的设计吗？

我不熟悉xuggler。

**问题 2：**有没有办法在用户上传时从输入流中获取缩略图？否则，我将编写文件，然后按照[此处](http://build.xuggle.com/view/Stable/job/xuggler_jdk5_stable/ws/workingcopy/src/com/xuggle/mediatool/demos/DecodeAndCaptureFrames.java)所述从中获取缩略图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:06:45.397

[Xuggler](http://blog.xuggle.com/)似乎是要走的路。

我现在正在做类似的事情。在尝试假设我收到了视频之前，我选择下载整个文件有效负载。

我用 PHP 构建了一个类似的系统，用户提交 Windows Movie Maker 项目文件是一个真正的问题。

`application/octet-stream`是来自不知道文件类型关联的机器的非常常见的内容类型

# iphone - 可以在两个 iOS 设备之间发送数据吗？

> ID：11398781
> 
> 赞同：3
> 
> 时间：2012-07-09T15:57:45.787
> 
> 标签：iphone, objective-c, icloud, nsnotificationcenter

我已经在网上阅读了大量关于此的问题，但似乎无法找到可靠的答案。如果我的 iPhone 在蜂窝数据上运行，而另一个 iOS 设备在 wifi 上运行（在两个不同的位置），它们是否可以直接相互发送数据而不先将其发送到 Web 服务器，然后再检索它？是从服务器/Apple 的 iCloud 发送和接收的唯一选项吗？如果我知道设备的 IP 地址怎么办？请注意，iPhone 已禁用 WiFi。

我不想把它放在应用商店里，它是供个人使用的。我知道`NSNotificationCenter`这不是一个选择。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-09T17:52:12.187

使用 gamekit 框架，您可以在两个 iOS 设备之间发送数据。它很容易实现。除此之外，我认为没有其他方式可以在两个 iOS 设备之间发送数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-10T13:35:22.693

实际上，这是可能的。您可能想在谷歌上搜索称为“UDP 打孔”或“TCP 打孔”的东西。

简而言之，主要方法是：假设您有类似中继服务器的东西，它是互联网中的某些服务器，可以从连接到 www 的每个私有 LAN 公开寻址。不，您的两个客户端 A 和 B 在（不同的）私有 LAN 中，并且正在进行一些网络地址转换 (NAT)，它们想要建立对等连接。

首先，两者都会告诉服务器他们的 IP 地址和他们在自己的 LAN 中的端口。在 UDP 或 TCP 数据包中，服务器会找到设备（或 NAT（路由器））的公共地址和端口。因此服务器知道私有和公共 IP 地址以及端口。

如果现在 A 想与 B 通信，它会向服务器寻求帮助。服务器将向 B 发送一条消息，表明 A 想与她通信，告诉她 A 的公共和私有 IP 和端口。A 取回 B 的公私信息和端口。

现在这里是魔法发生的地方。两个客户端现在都发送数据包以同时建立与另一方的私有和公共地址的连接，从而在他们的 NAT 中打入一个整体，这样传入的连接就不会被阻塞。即使一方的连接建立数据包会在整个创建之前到达，另一方的数据包也会通过，以便可以创建连接。

当心一些 NAT 扫描 IP 地址数据并转换它们，但如果您加密数据或更改地址的外观（补码，...），您会没事的。

现在的主要问题是，服务器如何在没有活动连接的情况下与其中一个客户端通信。那么在这种情况下，您可以使用“连接反转”和苹果的“推送通知”。使用“推送通知”(pn) 告诉 NAT 后面的客户端有一些有趣的事情正在发生，它应该联系服务器。一旦完成，连接就处于活动状态并且可以按照前面描述的方式使用。

我希望这可以帮助一些解决这个问题的人，尽管这篇文章已经很老了！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T21:19:06.383

如果 IP 地址是可通过 Internet 访问的可公开访问的 IP 地址，并且它们是静态的（足够），那么您只能使用直接 IP 地址通信，这样当设备被动态分配到地址时，它们不会定期更改。在许多（大多数）情况下，情况并非如此，因为您的设备将被动态分配其 IP 地址，而这些地址通常是不可公开寻址的自分配 IP 地址。

正如其他人所评论的那样，使用像 iCloud 这样的 Apple 提供的机制可能是最简单的选择。如果这不是您想要娱乐的东西，可能有一些方法可以利用动态 DNS 服务（如 DynDNS）来管理您设备的实际 IP 地址。有了类似的东西，您也许可以基于命名 DNS 查找在设备之间使用直接 IP 连接。不过，您可能必须跳过一些障碍才能做到这一点，但我不确定您是否想达到那个程度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T16:02:06.920

我认为 [蓝牙](http://developer.apple.com/library/ios/#documentation/CoreBluetooth/Reference/CoreBluetooth_Framework/_index.html)对你来说是个不错的选择

# php - 查找字符串中的确切单词位置

> ID：11398782
> 
> 赞同：-5
> 
> 时间：2012-07-09T15:57:46.183
> 
> 标签：php

假设我有一个字符串。

```
$string = red,green,blue,yellow,black; 
```

现在我有一个变量，它是我正在搜索的单词的位置。

```
$key = 2; 
```

我想得到位置为 2 的单词。在这种情况下，答案是`blue`。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-09T15:59:06.013

[http://codepad.org/LA35KzEZ](http://codepad.org/LA35KzEZ)

```
$a = explode( ',', $string );
echo $a[ $key ]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T15:59:46.187

解决此问题的更好方法是使用explode() 将字符串转换为数组。

```
$string = ...;
$string_arr = explode(",", $string);
//Then to find the string in 2nd position

echo $string_arr[1]; //This is given by n-1 when n is the position you want. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T16:04:11.350

```
<?php
$string = preg_split( '/[\s,]+/', $str );

echo $string[$key]; 
```

这是通过根据单词边界（空格、逗号、句点等）将句子拆分为单词来实现的。它比 更灵活`explode()`，除非您只使用逗号分隔的字符串。

例如，如果`str`= '你好，我的名字是狗。你好吗？'，并且`$key`= 5，你会得到'怎么样'。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T15:59:45.953

鉴于：

```
$string = 'red,green,blue,yellow,black';
$key = 2; 
```

然后（< PHP 5.4）：

```
$string_array = explode(',', $string);
$word = $string_array[$key]; 
```

然后（> = PHP 5.4）：

```
$word = explode(',', $string)[$key]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-09T16:01:55.797

如果您知道您的单词将用逗号分隔，您可以执行以下操作：

```
$key = 2;
$string = "red,green,blue,yellow,black";
$arr = explode(",",$string);
echo $arr[$key]; 
```

# sql-server - 为什么 SQL Server 中的长度列有些混乱？

> ID：11398783
> 
> 赞同：1
> 
> 时间：2012-07-09T15:57:46.607
> 
> 标签：sql-server

所以我发现长度列说“长度”是 4，精度是 10：

```
Col. name: SurveyNumber
type : int
computed: no
Length: 4
Precision: 10 
```

它里面有像19350这样的数字。为什么长度称为 4 并且它有 5 位数字：？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T16:00:37.463

4字节！

它不是4位数。

4 字节 = 4*8 = 32 位。

所以它可以容纳 2^32-1 个数值

（如果你有一个负数，那么它的半值 - 对称（-1）到零。 - 导致零也很重要。）

> 最小值 = -2,147,483,648 最大值 = 2,147,483,647

```
2^32 = 4294967296

divide by 2: = 2147483648

now step up 2^32-1 times

so you are here at : 2,147,483,647 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-09T16:01:40.473

int 的长度为 4，因为它需要 4 个字节（32 位）来存储一个值。

4 个字节可以存储从 -2,147,483,648 到 2,147,483,647 的数字，因此可以存储 10 位精度。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-09T16:03:04.423

所有信息都可以在 MSDN 上找到。

[精度、比例和长度 (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms190476.aspx)

> **精度**是数字中的位数。比例是数字中小数点右侧的位数。例如，数字 123.45 的精度为 5，小数位数为 2。
> 
> **数字数据类型的长度**是用于存储数字的字节数。字符串或 Unicode 数据类型的长度是字符数。binary、varbinary 和 image 数据类型的长度是字节数。例如，**一个 int 数据类型可以容纳 10 位，存储在 4 个字节中**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-09T16:01:56.387

检查MySQL文档，这里很清楚：[整数类型（精确值）](http://dev.mysql.com/doc/refman/5.5/en/integer-types.html)

一个 4 字节存储（长度 4）表示最多 2^32 个值。

# c# - Linq 用列表分组

> ID：11398784
> 
> 赞同：0
> 
> 时间：2012-07-09T15:57:46.580
> 
> 标签：c#, .net, linq, .net-4.0, grouping

我有这样的实体

```
Product                           Room
long productid                    long roomid
List<Room> rooms                  string roomname
String name 
```

现在我有一个产品实体列表，除了房间列表之外，它还有重复的日期。方程。

```
Product                                
Id 1                        Id2                    Id3
Rooms = 1,A                 Rooms = 1,B            Rooms =1,C
ABC                         ABC                    ABC 
```

在这种情况下，我将相同的属性重复了 3 次，因为它有 3 个房间。

我要做的是将所有房间添加到一个产品实体中，该实体将具有一个产品实体和房间列表（在这种情况下为 3 个列表）。我尝试过这样的事情，但它不起作用。

在这里，我正在传递属性 ID

```
var result = from t in Product
             where t.ProductId == propId
             group t by t.Rooms
             into g
             select g; 
```

请提供任何帮助或想法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T17:08:23.397

这个怎么样？

```
var product = Product.First(p => p.ProductId == propId);

product.Rooms = from p in Product
                from r in p.Rooms
                select r; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:16:35.277

如果您只需要获取与任何产品关联的房间列表，您可以尝试以下操作：

```
var query = from t in products
            select t;
var rooms = query.Aggregate(new List<Room> { }.AsEnumerable(), (i, p) => i.Union(p.rooms)); 
```

请注意，聚合不会作为 sql 查询执行（如果您从数据库中提取数据） - 而是在内存中执行。

我不确定这是否是您想要的结果，但它会为您提供所有产品组合的“房间”属性中的房间列表。例如，如果您有一个产品的房间“A”和“B”，而另一种产品的房间“C”，则结果房间列表将包含“A”、“B”和“C”。

# ruby-on-rails - 如何避免多次成为朋友

> ID：11398787
> 
> 赞同：0
> 
> 时间：2012-07-09T15:57:50.997
> 
> 标签：ruby-on-rails, conditional-statements, rails-activerecord

我坚持使用友谊模型。我可以和一个用户多次成为朋友。所以我需要一个条件来避免添加到朋友链接。我的 users_controller ：

```
class UsersController < ApplicationController
    before_filter :authenticate_user!

  def index
        @users = User.all
  end
  def show
    @user = User.find(params[:id])
    @topics = @user.topics.paginate(page: params[:page])
    @friendship = @user.friendships.build(:friend_id => params[:friend_id])
    @friendships = @user.friendships.all

  end 
```

我的 show.html.erb：

```
 <section>
            <h1><%= @user.username %></h1>     
       <%= link_to "Arkadaşlarıma Ekle", friendships_path(:friend_id => @user), :method => :post,class: "btn btn-large btn-primary" %>

            </section> 
```

我的friendships_controller：

```
class FriendshipsController < ApplicationController
    before_filter :authenticate_user!

    def create
        @friendship = current_user.friendships.build(:friend_id => params[:friend_id])
        if @friendship.save
            flash[:notice] = "Arkadaşlara eklendi."
            redirect_to root_url
        else
            flash[:error] = "Arkadaşlara Eklenemiyor."
            redirect_to root_url
        end
    end

    def destroy
        @friendship = current_user.friendships.find(params[:id])
        @friendship.destroy
        flash[:notice] = "Arkadaşlarımdan kaldırıldı."
        redirect_to current_user
    end
end 
```

所以我想，我尝试在 users_controller 中添加此方法，但仍然没有解决方案。你能帮我修一下吗？

```
def friend?(other_user)
   friendships.find_by_friend_id(other_user.id)
 end 
```

和在链接之前

```
<% unless friend?(@user) %>
%= link_to "Arkadaşlarıma Ekle", friendships_path(:friend_id => @user), :method => :post,class: "btn btn-large btn-primary" %>
<%end %> 
```

我的用户模型：

```
class User < ActiveRecord::Base
  # Include default devise modules. Others available are:
  # :token_authenticatable, :confirmable,
  # :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email, :password, :password_confirmation, :remember_me, :username
  # attr_accessible :title, :body
  has_many :topics
  has_many :posts
  has_many :friendships
    has_many :friends, :through => :friendships
    has_many :inverse_friendships, :class_name => "Friendship", :foreign_key => "friend_id"
    has_many :inverse_friends, :through => :inverse_friendships, :source => :user
end 
```

我的友谊模型：

```
 class Friendship < ActiveRecord::Base
      attr_accessible :friend_id, :user_id
      belongs_to :user
        belongs_to :friend, :class_name => "User"
    validates :friend, :presence => true, :unless => :friend_is_self

def friend_is_self
  user_id == friend_id ? false : true
end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:09:41.397

我认为最好在模型级别进行此类验证。在您的模型中使用[validate_uniqueness_of](http://api.rubyonrails.org/classes/ActiveRecord/Validations/ClassMethods.html#method-i-validates_uniqueness_of)并在您的控制器中测试有效性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:16:45.283

我想朋友？方法应该类似于：

```
def friend?(other_user)
   current_user.friendships.find_by_friend_id(other_user.id)
end 
```

因为我猜friendship应该是一个带有user_id和friend_id的表，所以我们要检查的是这个用户是否有other_user作为朋友。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T16:04:07.850

您的`friend?`方法正在返回`friendship`or `nil`，而不是`true`or `false`，正如您对方法所期望的那样`?`。

尝试

```
def friend?(other_user)
  # this assumes Friendship is a user, which probably isn't true
  # but I don't have your models but this should give you the right idea
  self.friendships.include other_user
end 
```

# python - 如何创建一个列表来选择索引？

> ID：11398796
> 
> 赞同：1
> 
> 时间：2012-07-09T15:58:44.767
> 
> 标签：python, list, indexing

我有这段代码来检查文件中的索引以查看它们是否匹配，但开始时我无法选择索引。为了能够这样做，我必须做什么，因为此时它没有将值显示为列表中。

```
def checkOS():
    fid = open("C:/Python/NSRLOS.txt", 'r')
    fhand = open("C:/Python/sha_sub_hashes.out", 'r')
    sLine = fhand.readline()
    line = fid.readline()
    outdata = []
    print line
checkOS() 
```

现在它打印：

```
"190","Windows 2000","2000","609" 
```

我只希望它打印：（所以`index[0]`）

```
190 
```

当我尝试时`index[0]`，我就得到了`' " '`。所以整个字符串中的第一个值，我想要一个能够选择索引的列表。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T16:04:12.873

尝试使用`line.split(",")`逗号分隔行，然后通过切片结果去掉引号。

例子：

```
>>> line = '"190","Windows 2000","2000","609"'
>>> sliced = line.split(',')
>>> print sliced
['"190"', '"Windows 2000"', '"2000"', '"609"']
>>> first_item = sliced[0][1:-1]
>>> print first_item
190 
```

...这是整个事情，抽象成一个函数：

```
def get_item(line, index):
    return line.split(',')[index][1:-1] 
```

（当然，这是假设该行中的所有项目都用逗号分隔，它们都用引号括起来，逗号后没有空格（尽管您可以通过`item.strip()`删除空格来解决这个问题). 如果引用的项目包含逗号，它也会失败，如评论中所述。)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:05:00.470

`[0]`应用于字符串仅返回第一个字符。

您需要逗号分隔列表的第一项。您可以编写自己的解析代码，也可以使用`csv`已经处理此问题的模块。

```
import csv

def get_first_row(fname):
    with open(fname, 'rb') as inf:
        incsv = csv.reader(inf)
        try:
            row = incsv.next()
        except StopIteration:
            row = [None]
        return row

def checkOS():
    fid = get_first_row("C:/Python/NSRLOS.txt")[0]
    fhand = get_first_row("C:/Python/sha_sub_hashes.out")[0]
    print fid 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T16:06:49.150

如果您尝试使用`split()`拆分每个逗号并返回第一个值？试试这个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-09T16:13:10.033

[`csv.reader`](http://docs.python.org/library/csv.html#csv.reader)将是一个好的开始。

```
import csv
from itertools import izip

with open('file1.csv') as fid, open('file2.csv') as fhand:
    fidcsv = csv.reader(fid)
    fhandcsv = csv.reder(fhand)
    for row1, row2 in izip(fidcsv, fhandcsv):
        print row1, row2, row[1] # etc... 
```

Using`csv.reader`将比纯 str 方法更好地处理 CSV 格式的文件。`izip`将从两个文件中读取第 1 行、第 2 行、第 3 行等。）。row1 和 row2 最终将成为列列表，然后只是索引`if row1[0] == row2[0]:`或您希望使用的任何逻辑。

# python - 如何跳过打印命令输出并仅从 os.system 命令获取返回值？

> ID：11398798
> 
> 赞同：2
> 
> 时间：2012-07-09T15:58:50.387
> 
> 标签：python, os.system

考虑以下示例 -

```
Python 2.4.3 (#1, Jan 14 2011, 00:20:04)
[GCC 4.1.2 20080704 (Red Hat 4.1.2-48)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import os
>>> os.system("grep -i beatles blur.txt")
Blur's debut album Leisure (1991) incorporated the sounds of Madchester and shoegazing. Following a stylistic change.influenced by English guitar pop groups such as The Kinks, The Beatles and XTC.
0
>>> os.system("grep -i metallica blur.txt")
256
>>> 
```

因此，在这种情况下，我不希望将搜索关键字的行打印在 Python shell 上，我只想要返回值，即如果关键字存在则返回 0，如果关键字不存在则返回非零。如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T16:06:58.090

您只需要使用`-q`以下密钥`grep`：

```
$ python
Python 2.7.3rc2 (default, Apr  5 2012, 18:58:12) 
[GCC 4.6.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import os
>>> os.system("grep -iq igor /etc/passwd")
0
>>> os.system("grep -iq oleg /etc/passwd")
256
>>> 
```

我必须注意，`-q`它不是可移植的密钥`grep`，它仅适用于 GNU grep（Linux 等）。

当你想让它在所有系统上工作时，你必须使用`popen`/`subprocess.Popen`和流的重定向。

```
>>> import subprocess
>>> null = open(os.devnull, "w")
>>> grep = subprocess.Popen(shlex.split("grep -i oleg /etc/passwd"), stderr = null, stdout = null)
>>> grep.communicate()
(None, None)
>>> print grep.returncode
1
>>> grep = subprocess.Popen(shlex.split("grep -i igor /etc/passwd"), stderr = null, stdout = null)
>>> grep.communicate()
(None, None)
>>> print grep.returncode
0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:14:57.467

Igor Chubin 的答案很好，但在您的情况下，最简单的答案可能只是通过 shell 重定向输出（因为 os.system 无论如何都会调用 shell，您不妨使用它。）

```
os.system("grep -i beatles blur.txt > /dev/null 2>&1") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T16:15:39.643

对于“如何防止`os.system()` 输出被打印”的一般问题，最好的方法是使用[subprocess](http://docs.python.org/library/subprocess.html)模块，这是运行外部程序的推荐方法，它提供了直接的输出重定向。

这是您的示例的外观：

```
import os
import subprocess

devnull = open(os.devnull, 'wb')
subprocess.call('grep -i beatles blur.txt', stdout=devnull, stderr=devnull, shell=True) 
```

该`shell=True`选项意味着程序将通过 shell 执行，这就是这样`os.system()`做的，但最好（更安全）删除`shell=True`并传递带有命令参数的列表。

```
subprocess.call(['grep', '-i', 'beatles', 'blur.txt'], stdout=devnull, stderr=devnull) 
```

# java - 自动更新 Action 的 isEnabled()

> ID：11398806
> 
> 赞同：6
> 
> 时间：2012-07-09T15:59:13.490
> 
> 标签：java, swing

我编写了一个 Swing GUI，其中包含与同一`Action`子类关联的多个控件。子类的实现`Action`遵循这个伪代码：

```
public class MyGUI 
{
  Gizmo gizmo_;  // Defined elsewhere

  public class Action_StartPlayback extends AbstractAction 
  {
    /* ctor */
    public Action_StartPlayback(String text, ImageIcon icon, String desc, Integer mnem)
    {
      super(text, icon);
      putValue(SHORT_DESCRIPTION, desc);
      putValue(MNEMONIC_KEY, mnem);
    }

    @Override public boolean isEnabled()
    {
      return gizmo_ == null;
    }
    @Override public void actionPerformed(ActionEvent e) 
    {
      gizmo_ = new Gizmo();
    }

  Action_StartPlayback act_;
}; 
```

该操作与按钮和菜单项相关联，其方式类似于以下伪代码：

```
act_ = new Action_StartPlayback(/*...*/);
// ...
JButton btn = new JButton(act_);
JMenu mnu = new JMenu(act_); 
```

当我单击按钮或菜单项时，动作`actionPerformed`被正确触发， `gizmo_`被初始化并且是非`null`并且一切都按预期工作 - 除了按钮和菜单项仍然启用。

我预计`isEnabled`会再次“自动”调用，但这显然不会发生。 `isEnabled()`再也不会被调用。

这引发了两个问题：

1.  像我在这里所做`@Override`的那样对我来说可以吗？`isEnabled()`
2.  假设 #1 的答案是肯定的，我如何触发 GUI 的刷新以便`isEnabled()`再次调用，从而导致按钮和菜单项被禁用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T16:18:19.653

在您的方法中初始化您的小工具之后，`setEnabled`您可以简单地调用，而不是覆盖：`setEnabled(false)``actionPerformed`

```
@Override public void actionPerformed(ActionEvent e) 
{
  gizmo_ = new Gizmo();
  setEnabled(false);
} 
```

这是`setEnabled`来自的实现`AbstractAction`：

```
public void setEnabled(boolean newValue) {
  boolean oldValue = this.enabled;
  if (oldValue != newValue) {
    this.enabled = newValue;
    firePropertyChange("enabled", 
            Boolean.valueOf(oldValue), Boolean.valueOf(newValue));
  }
} 
```

您正在寻找的*自动*`firePropertyChange`是对 的调用，它根据此操作通知组件状态已更改，因此组件可以相应地更新自己的状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T16:19:10.807

我不是这方面的专业人士，但我看不到这样做的自动方式，即通知听众启用状态已更改。当然，您可以`setEnabled(false)`在 actionPerformed 开始时调用，然后对 Gizmo（或 Gizmo 上的包装器）进行编码以支持属性更改，然后将 PropertyChangeListener 添加到 Gizmo，并在该侦听器中，当状态更改为 DONE 时，调用`setEnabled(true)`. 有点笨拙，但它会起作用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-09T16:28:43.980

这并不严格限于 Swing，而是更一般的 Java 原则。JDK（和其他库）中的许多类都有一个属性的 getter 和一个 setter。这些方法并不意味着被覆盖以返回动态值，因为大多数时候超类直接访问相应的字段并且不通过 getter。

如果您有动态行为，则应在每次值更改时调用相应的 setter。这将通知已经进行了超类更改，并且通常这还会触发属性更改事件以通知其他相关方。

如果您对 Java bean 进行搜索，您可以找到更多关于此约定的信息。

在您的情况下，一个可能的解决方案是让您的 UI 类`PropertyChangeEvent`在该`gizmo`实例更改时触发 a，并让您的操作侦听该事件。当他们收到这样的事件时，他们会更新自己的启用状态。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-12T09:19:37.137

启用状态存储在您的**两个**对象中，即 AbstractAction 和 JButton 中。

这很重要，因为您只需要`Action_StartPlayback`多个组件的一个实例，例如：

1.  在菜单的按钮中。
2.  在工具栏中。
3.  在示例中的快捷方式`Strg``p`中。

它们都可以具有相同的`Action_startPlayback`. `Action_startPlayback`是唯一的**真相来源**。组件有责任尊重这一**事实来源，**因此每个组件都会要求 AbstractAction 通知它们是否有更改。AbstractAction 将记住所有组件并使用 Method 通知它们`firePropertyChange()`。

但是如何重新绘制所有待处理的组件？您必须强制所有待处理的组件询问实际`Action_startPlayback`的启用状态！看这个：

```
@Override public void actionPerformed(ActionEvent e) 
{
  gizmo_ = new Gizmo();
  // now, force the components to get notified.
  setEnabled(true);
} 
```

# google-apps-script - 如何在 Google Apps 脚本中创建逗号分隔的字符串

> ID：11398812
> 
> 赞同：0
> 
> 时间：2012-07-09T15:59:34.717
> 
> 标签：google-apps-script

在这方面我需要很多帮助，但我认为这是一个对未来其他绿色程序员有帮助的程序。

我有一个谷歌表格供人们填写我们社区的新手。显然，它提供了一个 Google Docs 电子表格。（这是一个链接，指向刚刚编辑以屏蔽一些个人数据的工作表副本：

[https://docs.google.com/spreadsheet/ccc?key=0AjsoIob8dJfodG9WN0ZmWUE1ek9rc3JrVFpDQ0J0OGc](https://docs.google.com/spreadsheet/ccc?key=0AjsoIob8dJfodG9WN0ZmWUE1ek9rc3JrVFpDQ0J0OGc)

)

问题之一是您有兴趣加入我们的哪个小组。表单提出问题，然后允许用户检查新成员有兴趣加入的大约 10 个组中的哪一个。然后将数据输入到工作表中，该工作表列出了新成员想要加入的所有组（即 F 列）。

我现在需要处理的管理任务是查看所有回复并找出那些说过——例如——他们有兴趣加入“帮助之手”组的成员，复制他们的电子邮件地址（它位于 X 列中）并将其粘贴到该组的 Google Groups 注册表单中。

这是可以理解的乏味。特别是因为——再一次——我们有大约 15 个需要填充的 Google 群组列表。

如果我可以编写一个小 Google Apps 脚本，它会遍历工作表中的数据，并给我一个逗号分隔的列表，列出所有符合正确标准的电子邮件地址，这样我就可以复制——并将其粘贴到 Google Group 注册页面中。

用简单的英语，正则表达式应该这样说： - IF 列 F 包含 Helping Hands - AND IF 列 G 不包含 Yes - THEN 将列 X 的内容添加到导出的字符串，后跟逗号 - 对中的每一行重复工作表。

所以这里的问题是：1）我该怎么做？2）这是如何触发的？

第一步，我已经确定以下正则表达式将满足我的需求：

/(^|, )伸出援助之手($|, )/

不过，我不确定如何扩充它以包含第二个必需的 IF 语句。我也不知道如何写 THEN 语句。而且——正如我上面所说——我不知道如何触发这一切。

提前感谢任何可以提供帮助的人！塞威克利的新人也谢谢你们！如果我能清除任何东西，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T01:36:44.923

您为什么不进一步设置一个表单提交触发器，该触发器读取组并使用（尚未试验的）[Groups Services](https://developers.google.com/apps-script/service_groups) for Apps 脚本自动添加它们？

这样的脚本实现起来并不难，也许你应该查看[用户指南](https://developers.google.com/apps-script/your_first_script)和[教程](https://developers.google.com/apps-script/articles)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:46:22.487

如果您以逗号分隔格式获取电子邮件地址列表，您似乎很乐意复制粘贴该列表。因此，您可以在需要时自行触发。您可以使用此代码段

```
var options = ['Helping Hands','Book Club',...]; // Add all 10 options here 
var GROUPS_COL = 5 ; //Column F
var COLG = 6; 
var EMAIL_COL = 23 ; //Column X
var emailList = ['', '','',''...] ; // 10 blanks

var data = SpreadsheetApp.openById('ID_HERE').getSheetByName('SheetName').getvalues(); 
for (var i = 1; i < data.length ; i++){
  for( var j = 0 ; j < options.length ; j++){
    if (data[i][GROUPS_COL].indexOf(options[j]) != -1 &&
        data[i][COLG] != 'Yes') {
      // The entry in row i+1 has checked option[j]
      if (emailList[j] != ''){
        emailList[j] += ',' ; // Add your comma
      }
      emailList[j] += data[i][EMAIL_COL]; 
    }
  }
}

/* Now you have your comma separated list in emailList */
for ( var i = 0 ; i < 10; i ++){
  Logger.log(option[i] + ':' + emailList[i])
} 
```

显然，您必须调整此代码以满足您的需要，但会让您对如何进行有一个公平的了解。该代码尚未经过测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-20T21:40:22.473

你不知道这最终解决了我是多么令人难以置信。感谢@Sirik 一百万次坚持使用它并编写代码并帮助我调试它。它完全按照我的意愿去做，它只是世界上最酷的事情，让它完全按照我的意愿去做。

为了后代或任何其他可能想做与我正在做的事情类似的事情的人，这里是确切的代码，所有代码都经过平滑处理，如已实现。你会看到我在最后添加了一些额外的位，以便通过电子邮件将日志发送给我，并给我一个对话框，确认脚本已经运行（我不喜欢单击按钮而不是看到的那种感觉有事发生）。

```
function Export_Groups_List() {

var options = ['1 & 2 Year Olds\' Playgroup','3 & 4 Year Olds\' Playgroup','Babies\' Playgroup','Book Club','Couples Night Out','Directory','Girls Night Out','Helping Hands','Membership','Newsletter','Serving Sewickley','Treasurer'];
var GROUPS_COL = 5; //This is column 5
var COLG = 6; //Column G
var EMAIL_COL = 23; //Column X
var emailList = ['', '', '', '', '', '', '', '', '', '', '', ''] //12 blanks

    var data = SpreadsheetApp.openById('___').getSheetByName('Master').getDataRange().getValues();
  for (var i = 1; i < data.length ; i++){
    for( var j = 0 ; j < options.length ; j++){
      if (data[i][GROUPS_COL].indexOf(options[j]) != -1 &&
         data[i][COLG] != 'Yes') {
        if (emailList[j] != ''){
          emailList[j] += ', ' ;
        }
        emailList[j] += data[i][EMAIL_COL];
      }
    }
  }
  for ( var i = 0 ; i < 12; i ++){
    Logger.log(options[i] + ': ' + emailList[i])
  }
  MailApp.sendEmail("matt@twodoebs.com", "Groups Export", Logger.getLog() + " \n\n" + 
                    "At your request, you've been added to this Sewickley Newcomers & Neighbors Google Group." + "\n\n" +
                    "Using Google Groups allows us to always have up to date e-mail lists, make sure that people don't get bombarded with messages they don't want, and facilitate smooth communication between our members. If you have any questions about how to use the Google Groups service with your Newcomers & Neighbors membership, please send an e-mail to SewickleyNAN@gmail.com." + "\n\n" + 
                    "Thank you and thanks for your participation!") ;

  Browser.msgBox("OK. Check your e-mail for the export list. doebtown rocks the house!")
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-02T17:11:35.350

Evan Plaice 提供了一个不错的 Google Apps 脚本，您可以在自己的电子表格中使用它，它实质上呈现了一个菜单，允许您使用“文本到列”功能转置列。 [https://webapps.stackexchange.com/questions/22799/text-to-columns-conversion-in-google-spreadsheets](https://webapps.stackexchange.com/questions/22799/text-to-columns-conversion-in-google-spreadsheets)

# javascript - DOMParser 或 XMLSerializer 在 IE9 中删除了我的命名空间声明

> ID：11398813
> 
> 赞同：4
> 
> 时间：2012-07-09T15:59:42.087
> 
> 标签：javascript, xml, xslt, internet-explorer-9, xml-namespaces

所以我认为无论如何可能有比我正在做的更清洁的解决方案，但我想知道这是否是一个已知问题，是否有明显的我做错的事情，等等......

由于不值得描述的原因，我有一些 Javascript 代码，在一个可能的路径中，使用 DOMParser 从字符串加载 XML，然后使用 XMLSerializer 将其序列化回字符串。XML 文档是一个 XSL 样式表。主 xsl:stylesheet 标记中有两个 xmlns 元素：一个声明 xsl 命名空间，另一个声明我使用的自定义命名空间。（称它为“富”）

至少在 IE9 中，当我通过 DOMParser 从往返中获取输出时，xmlns:xsl 元素仍然存在，但 xmlns:foo 元素丢失了。这是预期的行为吗？我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:55:59.150

我做了一个测试用例[http://home.arcor.de/martin.honnen/javascript/2012/test2012070901.html](http://home.arcor.de/martin.honnen/javascript/2012/test2012070901.html)我可以确认在 Windows 7 上使用 IE 9 的输出是

```
Input
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0" xmlns:foo="http://example.com/foo">
<xsl:template match="foo:bar">Test</xsl:template>
</xsl:stylesheet>
Output
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
<xsl:template match="foo:bar">Test</xsl:template>
</xsl:stylesheet> 
```

所以命名空间声明被删除。我认为这是 IE 9 中的一个错误，您可能需要检查 connect.microsoft.com 是否已经报告了类似的内容，如果没有提交。有人在这里使用 IE 10 阅读吗？IE 10 显示了什么？

[编辑] IE 10 上存在连接问题，可能相关：[https](https://connect.microsoft.com/IE/feedback/details/728093/xmlserializer-omits-xmlns-attributes) ://connect.microsoft.com/IE/feedback/details/728093/xmlserializer-omits-xmlns-attributes 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-25T17:33:32.313

我也遇到了这个问题。在 IE11 中，我有一些 javascript 序列化 XML，并且名称空间 URI 被删除了。

作为一种解决方法，我`createElementNS`在创建适当的子节点时使用了该方法。

因此，例如，而不是...

```
var r = '<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:n0="web5540"></soap:Envelope>';
var m = new DOMParser().parseFromString(r, "text/xml");
var n = m.createElement('n0:GetSales');
var p = m.firstChild;
p.appendChild(n);
var k = new XMLSerializer().serializeToString(m);
// In IE, k = "<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" ><n0:GetSales /></soap:Envelope>" 
```

...我最终这样做了...

```
var r = '<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"></soap:Envelope>';
var m = new DOMParser().parseFromString(r, "text/xml");
var n = m.createElementNS('web5540', 'n0:GetSales');
var p = m.firstChild;
p.appendChild(n);
var k = new XMLSerializer().serializeToString(m);
// In IE, k = "<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><n0:GetSales xmlns:n0="web5540" /></soap:Envelope>" 
```

我不确定这在原始情况下是否会有所帮助，因为 DOMParser 将完成所有元素的创建，但我决定发布以防其他人遇到类似问题。

# internet-explorer - AutoCAD 和 IE 协同工作的自动化测试

> ID：11398821
> 
> 赞同：1
> 
> 时间：2012-07-09T16:00:11.597
> 
> 标签：internet-explorer, ui-automation, autocad

我有兴趣为使用 IE 作为其 UI 一部分的 AutoCAD 插件编写 UI 自动化测试。当需要用户输入时，它会打开 IE（插件与基于 Web 的 ECM 对话并使用 IE 从 ECM 中选择要下载到用户机器并在 AutoCAD 中打开的文档）。

AutoCAD 和 IE 中的插件之间的交互如下所示：

*   用户在 AutoCAD 的插件菜单中选择“浏览文档”
*   插件使用 ECM URL 启动 IE
*   用户在 IE 的 ECM 应用程序中选择一个文档
*   插件接收来自 IE 的回调，并从 webapp 接收的 HTTP 标头中获取所选文档的 ID
*   插件关闭浏览器（窗口实际上只是隐藏）
*   插件将文档从 ECM 下载到用户的机器并在 AutoCAD 中打开

自动化这样的场景有多难，你会使用什么 UI 自动化工具？

可以将浏览器的 UI 自动化工具和 AutoCAD 的脚本结合使用，但如果它允许这种“跨平台”自动化，那么使用 UI 自动化工具似乎会更容易做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T10:39:10.383

假设您在 Windows 上运行 AutoCAD，您可能需要查看[RIATest](http://www.cogitek.com/riatest.html)。您应该能够使用 Windows UI 自动化和 IE 作为 Web 应用程序来自动化 AutoCAD。RIATest 支持这两种自动化场景。

披露：我是 RIATest 团队成员。

# java - JavaVM.framework。它是什么？我怎么能用它？

> ID：11398822
> 
> 赞同：2
> 
> 时间：2012-07-09T16:00:13.847
> 
> 标签：java, objective-c

最近在玩 Xcode 时，有一个名为`JavaVM.framework`. 这个框架是做什么用的，我该如何使用它？

这是否允许我以某种方式构建使用 Java 库的 Objective-C 应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:20:12.693

JavaVM.framework 是 Objective-C <> Java 的桥梁，更多信息在这里： [http ://cocoadevcentral.com/articles/000024.php](http://cocoadevcentral.com/articles/000024.php)

# asp.net - 我如何防止 AntiXSS Sanitizer 从 AjaxControlToolkit HtmlEditorExtender 生成的 html 中删除 html5 标记

> ID：11398824
> 
> 赞同：3
> 
> 时间：2012-07-09T16:00:19.900
> 
> 标签：asp.net, tinymce, sanitization, xss, html-encode

我已经在我的 asp.net Web 应用程序中添加了一个 Htmleditorextender ajax 控件，并在其中放置了 XSS sanitizer 以实现 XSS 安全性，但是现在当我从 Htmleditorextender 检索文本时，sanitizer 会
从中删除 HTML5，并且所有输入都集中在一个中。我在互联网上搜索并发现这是因为 XSS sanitizer 将 HTML5 标签识别为未知的不安全标签，这就是为什么所有 HTML5 标签都从 htmleditorextender 的格式化 HTML 中删除的原因现在我通过使 EnableSanitization="false" 使用 htmleditorextender
我应该删除 XSS sanitizer从我的项目中，或者我应该去

1.  TinyMCE 或
2.  CK编辑器

但是这两个都没有配置为图像上传和用户 hava 添加他们自己的第三方图像上传器。
请告诉我如何在不丢失 htmleditorextender 格式的 html 标签的情况下防止我的网站遭受 XSS 攻击。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:12:45.297

您是否知道最新的 HtmlEditorExtender 为此提供了替代消毒剂？它被称为 HtmlAgilityPackSanitizerProvider。如果您使用 Nuget 下载，不确定它是否包含在内，但如果您从 CodePlex 下载 zip，它包含一个名为“SanitizerProviders”的文件夹，其中包含备用消毒剂所需的 dll。然后，您可以在配置文件中指定备用消毒剂（包含在下载中）。

这是 Stephen Walther 的博客的链接，他对此进行了解释： [http ://stephenwalther.com/archive/2012/06/25/announcing-the-june-2012-release-of-the-ajax-control-toolkit.aspx](http://stephenwalther.com/archive/2012/06/25/announcing-the-june-2012-release-of-the-ajax-control-toolkit.aspx)

我不确定这是否能解决您的问题，或者是否可以选择更新到最新的工具包，但您没有提到尝试这个，所以听起来值得一试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-24T03:13:37.413

作为此问题的解决方法，我`<br>`在清理之前将所有标签替换为未知短语。并将它们放回 PreRender() 上。它适用于所有主要浏览器。

在 aspx 页面中：

```
<asp:TextBox runat="server" ID="txtSign" TextMode="MultiLine"/>
<ajaxToolkit:HtmlEditorExtender TargetControlID="txtSign" OnPreRender="htmlEditorExtender1_PreRender"  ID="htmlEditorExtender1" runat="server" /> 
```

在后面的代码中：

```
protected void Page_Load(object sender, EventArgs e)
{
   if (IsPostBack)       
      txtSign.Text = Server.HtmlDecode(txtSign.Text.Replace("&lt;br&gt;", "~_!_~"));           
}

protected void htmlEditorExtender1_PreRender(object sender, EventArgs e)
{
   txtSign.Text = txtSign.Text.Replace("~_!_~", "<br>");
} 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-09-19T01:18:31.933

***编写您自己的消毒剂：***

网上有很多解析器，例如：[White List Sanitizer Code](http://eksith.wordpress.com/2011/06/14/whitelist-santize-htmlagilitypack/)。

*   获得一个好的**白名单**开始。
*   **白名单**是有效 html 标签的列表，即**br**。
*   更新您的**白名单**以符合**HTML5**和任何新的**w3c**标准和/或您的组织编码标准。
*   在您开发解决方案时，不要依赖**Microsoft来帮助您。**
*   作为一名优秀的开发人员，采取一些**举措**并跳出框框思考。

**示例**：

*   我创建了我自己的带有 **缓存白名单 **的消毒剂， 它可用于我认为合适的地方，而不仅仅是 ajax 控件。:)

*   **查看 Ajax htmlagilitypack** Provider 源代码以获得灵感以了解其意图：[HtmlAgilityPackSanitizerProvider.cs](http://ajaxcontroltoolkit.codeplex.com/SourceControl/network/forks/pagonzalez/NumericUpDownAutoPostBack/changeset/7a3c81bce77f#Server/SanitizerProviders/HtmlAgilityPackSanitizerProvider.cs)

*   我删除了 Ajax htmlagilitypack，它太严格了，生活又一次盛大了。

**优点**：您可以清理/清理所有输入控件的文本属性。

受孕、发育、单元测试以及在不做噩梦的情况下感到被爱和安全的总时间： **2 小时**

我希望这有帮助.... ：）

免责声明：我今天没有服用拼写和语法医学。对不起。

**参考：**

```
Imports System.Linq
Imports HtmlAgilityPack 
```

# c# - 如何打印发生对象引用的行号

> ID：11398829
> 
> 赞同：0
> 
> 时间：2012-07-09T16:00:35.923
> 
> 标签：c#, asp.net, exception-handling

我需要关于*对象引用*问题的建议。我收到这条消息*ExceptionMessage: Object reference not set to an instance of an object。*（因为一些空对象）发生错误时我正在打印堆栈跟踪：

```
 Exception systemException = lastError.GetBaseException(); 
```

通过使用 ex.Message，我可以获得发生异常的方法，但我没有获得有关发生异常的（该方法的）行的任何信息。**我需要知道发生**此异常时发生在哪一行对象引用以及哪个对象为空。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T16:05:13.107

您需要实际的堆栈跟踪：

```
systemException.StackTrace 
```

如果您想要行号，则需要执行以下操作：

```
StackTrace st = new StackTrace(systemException, true);
StackFrame[] frames = st.GetFrames();

foreach(StackFrame frame in frames)
    frame.GetFileLineNumber(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:05:56.637

该行号几乎可以保证在堆栈跟踪中。如果您想深入了解它，请在可能发生的大代码块中放置一个 try-catch 并在 catch 块上放置一个断点，这将允许您通过 Visual Studio 内部的 InnerExceptions 下拉（如果任何存在）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T16:21:22.290

也许这有帮助

```
class Program
    {
        static void Main(string[] args)
        {
            try
            {
                string a = null;
                a.ToString();
            }
            catch (Exception ex)
            {
                var s = ex.StackTrace;
                Console.WriteLine(ex.Source);
                int st = s.LastIndexOf("line");
                Console.WriteLine(s.Substring(st, s.Length - st));
            }
        }
    } 
```

编辑：

是的，我刚刚了解到，在 EkoostikMartin 发布的答案中使用了 StrackTrace。我认为这是一个更好的答案。

# jquery - jquery弹出窗口位置firefox问题

> ID：11398835
> 
> 赞同：0
> 
> 时间：2012-07-09T16:01:01.427
> 
> 标签：jquery, popup

我的网站上有一个 jquery 弹出窗口脚本。它在 chrome 中运行良好，但在 Firefox 中，当窗口打开时，它出现在顶部，我希望它在垂直方向上更居中显示。例如。

```
 ________________________
|     |           |     |
|     |   popup   |     |
|     |           |     |
|     |___________|     |
|                       |
|_______________________| 
```

popup.js 中的脚本：

```
function centerPopup(){
  var windowWidth = document.documentElement.clientWidth;
  var windowHeight = document.documentElement.clientHeight;
  var windowTop =window.screenTop;
  var popupHeight = $(".popupContent").height();
  var popupWidth = $(".popupContent").width();

  $(".popupContent").css({
    "position": "fixed",
    "top": (windowTop+250)-popupHeight/2,
    "left": windowWidth/2-popupWidth/2
    });

  //this is needed for ie6
  $(".backgroundPopup").css({ "position": "fixed", "height": windowHeight, "top": windowTop });
  } 
```

任何人都可以提供任何建议我需要更改以使其正常工作吗？

## 更新

上面的代码来自 popup.js 脚本，还有一个 popup.css，我不确定这部分是否有任何冲突或导致问题

```
 .popupContent{
display:none;
align: center;
position: fixed;
_position: fixed; 
height:auto;
width:500px;
background:#fff;
z-index:9999;
padding:8px;
-moz-border-radius: 10px;
-webkit-border-radius: 5px;
-khtml-border-radius: 5px;
border-radius: 5px;
background-color: #15150B;
border:2px solid #C9C58F;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:06:55.310

您应该专门将 top 和 left 值设置为 50%，然后您需要将 margin-top 和 margin-left 值设置为高度和宽度值除以 -2。请注意，您还应该重复使用您的`$(".popupContent")`，因为您不止一次使用它。

```
function centerPopup(){
    var windowWidth = document.documentElement.clientWidth;
    var windowHeight = document.documentElement.clientHeight;
    var windowTop =window.screenTop;
    var $popup = $(".popupContent");
    var popupHeight = $popup.height();
    var popupWidth = $popup.width();

    $popup.css({
        "position": "fixed",
        "top": "50%",
        "left": "50%",
        "z-index": "100",
        "width": popupWidth,              // Set the width of the popup
        "height": popupHeight,            // Set the height of the popup
        "margin-top": (popupHeight / -2), // Note this value is half the height
        "margin-left": (popupWidth / -2)  // Note this value is half the width
    });

    // IE6 hack :P
    $(".backgroundPopup").css({ "position": "fixed", "height": windowHeight, "top": windowTop });
} 
```

否则，如果您不介意使用插件来处理弹出窗口，我会推荐jquery UI 中提供的[模态弹出插件。](http://jqueryui.com/demos/dialog/)它使创建弹出窗口变得非常简单。您可以执行以下简单的操作：

```
$(function() {
    // Create a modal from an existing div
    $("#div_MyDialog").dialog();

    // OR Create a modal from input html
    $('<div id="div_MyDialog">My new dialog</div>').dialog();  
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:50:39.253

我使用此代码在窗口中心打开一个基本弹出窗口：

[http://jsfiddle.net/hsgtA/](http://jsfiddle.net/hsgtA/)

```
var w = 800;
var h = 500;
var left = (screen.width / 2) - (w / 2);
var top = (screen.height / 2) - (h / 2);
var target_win = window.open ('http://google.com', false, 'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width='+ w +', height='+ h +', top='+ top +', left='+ left); 
```

# c# - SSIS 数据流与自定义传输脚本与批量插入

> ID：11398839
> 
> 赞同：3
> 
> 时间：2012-07-09T16:01:13.613
> 
> 标签：c#, sql-server-2008, ssis

将视图结果从一台服务器上的数据库复制到新服务器上的另一个数据库（均运行 SQL Server 2008）时，以下哪种方法可能最有效？

**1\. 带有 OLE DB 源/目标的 SSIS 数据流任务**

![忽略错误，仅为演示目的设置](../Images/0cda6ef666c7d34cceb5d9f07357e485.png)

**2.自定义脚本**

例如

```
using (SqlConnection connection = new SqlConnection(sourceConnectionString))
using (SqlCommand command = new SqlCommand(sourceQuery, connection))
{
    connection.Open();
    using (SqlDataReader reader = command.ExecuteReader())
    {
        using (SqlBulkCopy bulkCopy = new SqlBulkCopy(destinationConnectionString))
        {
            bulkCopy.DestinationTableName = destinationTable;
            //Any Column mapping required
            bulkCopy.WriteToServer(reader);
        }
    }
} 
```

**3\. SSIS 批量插入**

我看不出这与使用自定义脚本有什么不同，但没有增加的不灵活性，它只适用于表/视图而不适用于存储过程。

* * *

我意识到这与类似的比较不太一样，因为各种选项都有额外的日志记录和错误处理等级别，但假设我根本不需要日志记录来尝试使比赛场地尽可能均匀。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T16:53:44.010

根据[此 SO Post](https://stackoverflow.com/questions/4935846/sqlbulkcopy-or-bulk-insert)，BULK INSERT 的性能优于 SqlBulkCopy。但是，根据[这篇](http://social.msdn.microsoft.com/forums/en-US/sqlintegrationservices/thread/e730f5ac-3a84-4616-8918-53793715faea/)文章，DataFlow 任务优于 Bulk Insert SSIS 任务

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-09T20:34:53.617

这并不是真正直接回答您的问题，但是...

您的问题的简短答案可能是使用具有代表性的数据集尝试不同的方法并亲自查看。这将为您提供一个比 SO 上的任何人都可以提供的对您的环境更有意义的答案，并且是了解每个选项所涉及的工作和问题的好方法。

更长的答案是 SSIS 批量插入任务很可能是最慢的，因为它[只能加载平面文件数据](http://msdn.microsoft.com/en-us/library/ms141239.aspx)。为了使用它，您必须先将数据导出到源服务器上的文件，然后再将其重新加载到目标服务器上。如果服务器之间的 WAN 连接速度非常慢，这可能会很有用，因为您可以在复制文件之前压缩文件以最小化数据量，否则只会增加更多工作量。

至于 SSIS 和`SqlBulkCopy`我之间的区别，我没有个人经验，`SqlBulkCopy`所以我只能建议，如果没有明确的“赢家”，你先选择最简单、最容易维护的实现，不要担心找到最快的解决方案，直到你实际上需要。代码只需要运行得足够快，而不是尽可能快，并且从您的问题中并不清楚您实际上存在性能问题。

# survey - 如何计算定性调查答案的选票

> ID：11398840
> 
> 赞同：-1
> 
> 时间：2012-07-09T16:01:20.803
> 
> 标签：survey, search-suggestion

我们正在为一个客户创建一个网站，该客户想要一个基于对人们“最喜欢的 10 件事”的调查的网站。每个用户必须回答 10 个问题，例如“你最喜欢的颜色是什么”、“你最喜欢的名人是谁”等，然后将结果整理到主页上的全球 Top 10 列表中。

难题在于既允许用户输入他们想要的任何内容，例如他们最喜欢的度假目的地可能是“奶奶家”，又能够准确地计算选票，例如用户 A 可能会说他们最喜欢的名人是“女王”和用户 B 可能会说它是“英国女王”——我们需要将这两个答案计为对同一“事物”的两票。

如果我们强迫用户从一个庞大但预先确定的列表中选择每个问题，它就会限制用户将任何东西定义为他们“最喜欢的东西”的能力。然而，如果我们有一个纯文本输入字段并在提交后尝试解释答案，那么在相同答案的名称或拼写不同的情况下计算选票将变得更加困难。

是否可以通过某种形式的搜索短语建议引擎实时自动调整他们的答案？如果输入法是纯文本字段，我们如何确保允许拼写变化？

如果有人对此功能的可能解决方案有任何想法，可能是一个软件、一个插件、一个 API 等等，请告诉我们。

谢谢，请要求任何澄清。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:12:22.747

As Eric J said, this is getting into cutting edge NLP applications. These are fields of study that are very important for AI/automation researchers and computer science in general, but are still very fledgeling. There are a number of programs and algorithms you can use, the drawbacks and benefits of which very widely. RapidMiner is good, WordNet is widely used in medical applications and should be relatively easy to adjust to your own corpus, and there are more advanced methods like latent Dirichlet allocation. Here are a few resources you should start with (in addition to the Wikipedia article provided above)

[http://www.semanticsearchart.com/index.html](http://www.semanticsearchart.com/index.html)

[http://www.mitpressjournals.org/loi/coli](http://www.mitpressjournals.org/loi/coli)

[http://marimba.d.umn.edu/](http://marimba.d.umn.edu/) (try the SenseClusters calculator)

[http://wordnet.princeton.edu/](http://wordnet.princeton.edu/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T12:34:20.527

对简短答案进行分类的最佳方法是`k-means clustering`. 你需要应用词干。然后您需要使用基本字典将单词转换为索引。您可以使用`EverGroingDictionary.cs`来自`sematicsearchart.com`. 将短语扔到字典后，它将被转换为数字序列或向量。将接近度作为单词中的巧合数引入并应用`k-means`，速度快如闪电`algorithm`。`k-means`将所有答案分组。每个组中最常用的单词将是该组的签名。您的整个程序`C++`或`C#`或`Java`必须少于 1000 行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T16:04:31.720

如果您想*自动*计算“The Queen”和“The Queen of England”，那么您的工作可能比“有趣的小调查”更复杂。如果音量足够轻，请考虑仅手动计算结果。只是给你一个感觉，如果有人进入“瑞典女王”或“莱蒂法女王音乐会”怎么办？

如果您真的想走这条路，请查看自然语言处理 (NLP)。具体来说，分类领域。

对于 NLP 的一般介绍，我推荐相关的 Wikipedia 文章

[http://en.wikipedia.org/wiki/Natural_language_processing](http://en.wikipedia.org/wiki/Natural_language_processing)

[RapidMiner](http://rapid-i.com/content/view/181/190/)是一个值得研究的开源 NLP 解决方案。

# html - HTML X-UA 兼容标签在 IE 9 中不起作用

> ID：11398852
> 
> 赞同：1
> 
> 时间：2012-07-09T16:01:50.850
> 
> 标签：html, grails, internet-explorer-9, knockout.js

我收到错误：X-UA-Compatible META tag ('IE=7') 由于文档模式已经完成而被忽略。

我已经读到解决这个问题的方法是在 head 标签中没有声明 meta 标签足够高，但是我尝试将这个 meta 标签移动到 head 标签的第一行并且不能修复错误。

我正在使用 Grails .gsp 文件，该文件还使用淘汰赛 js。

以下是相关代码：

```
<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"><!--<![endif]-->
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>myInfinitec Membership Management</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="/ucpmanagementportal/static/images/favicon.ico" type="image/x-icon">

  <meta name="layout" content="main"/>

        <script src="/ucpmanagementportal/static/plugins/jquery-1.7.1/js/jquery/jquery-1.7.1.min.js" type="text/javascript" ></script>
<link href="/ucpmanagementportal/static/bundle-bundle_coreCSS_head.css" type="text/css" rel="stylesheet" media="screen, projection" />

    </head> 
```

编辑：在 IE 开发人员窗口中，每行之间都会生成“Text-empty text node”行。也许这算作在 X-UA-Compatible 元标记之前有一些东西。我读到解决方法是将 display: block 和 zoom: 1 添加到受影响的元素，但这不起作用。这是我所描述的一个例子：

```
<head>
Text - Empty Text Node
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
Text - Empty Text Node
<meta style="display: block; zoom: 1;" http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
Text - Empty Text Node 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T18:32:37.650

好吧，我解决了我的问题，尽管我的问题与我描述的错误无关。由于 IE 缓存 ajax 调用，我遇到了错误，并且能够通过添加 jQuery.ajaxSetup({ cache: false }) 来解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-26T13:36:41.220

这对我没有用。我发现的解决方法是将 X-UA-Compatible 值添加到每个控制器的前拦截器中，这似乎使它每次都能正常工作。例如，在我拥有的每个控制器中

```
def beforeInterceptor = [action : this.&setBrowserCompat]

private setBrowserCompat(){
response.addHeader("X-UA-Compatible", "IE=edge")
} 
```

这似乎总是有效。希望这会有所帮助

# php - 如何使用 PHP/mySQL 查看在页面顶部提交的最新数据

> ID：11398872
> 
> 赞同：0
> 
> 时间：2012-07-09T16:02:49.007
> 
> 标签：php, mysql, database, html-table

我正在显示来自 mySQL 数据库中的数据的表格（由填写表格的用户存储）。如何显示它，以便提交的最新数据位于页面顶部？

这是我从表中检索数据并显示它的代码。目前，我可以按姓名、电子邮件等安排表格。

```
<?php
// connect to the database
require 'connect.php';

if(isset($_GET['orderby']))
{
    $orderby = $_GET['orderby'];
    $query = "SELECT name_first,name_last,email,company,city,state,phone,session,optout FROM table
            ORDER by ".mysql_real_escape_string($orderby)."";
}
else
{
    $query = "SELECT name_first,name_last,email,company,city,state,phone,session,optout FROM table";
}

$result = mysql_query($query) or die(mysql_error());
?>

<table style='width: 60%; text-align: left;' cellpadding = '1'>
<tr bgcolor=#000090>
<th><a href=prospstud.php?orderby=name_first><FONT COLOR = #FFFFFF><b>First</b></th>
<th><a href=prospstud.php?orderby=name_last><FONT COLOR = #FFFFFF><b>Last</b></th>
<th><a href=prospstud.php?orderby=email><FONT COLOR = #FFFFFF><b>Email</b></th>
<th><a href=prospstud.php?orderby=phone><FONT COLOR = #FFFFFF><b>Phone</b></th>
<th><a href=prospstud.php?orderby=session><FONT COLOR = #FFFFFF><b>Session</b></th>
<th><a href=prospstud.php?orderby=company><FONT COLOR = #FFFFFF><b>Company</b></th>
<th><a href=prospstud.php?orderby=city><FONT COLOR = #FFFFFF><b>City</b></th>
<th><a href=prospstud.php?orderby=state><FONT COLOR = #FFFFFF><b>State</b></th>
<th><a href=prospstud.php?orderby=optout><FONT COLOR = #FFFFFF><b>Opted Out?</b></th>
</tr>

<?php

while ($row = mysql_fetch_assoc($result))
{
    $name_first = $row['name_first'];
    $name_last = $row['name_last'];
    $email = $row['email'];
    $phone = $row['phone'];
    $session = $row['session'];
    $company = $row['company'];
    $city = $row['city'];
    $state = $row['phone'];
    $optout = $row['optout'];

    echo "<tr bgcolor=#ABB5F6>
    <td>$name_first</td>
    <td>$name_last</td>
    <td>$email</td>
    <td>$phone</td>
    <td>$session</td>
    <td>$company</td>
    <td>$city</td>
    <td>$state</td>
    <td>$optout</td>
    </tr>";
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T16:04:16.593

每次访问/创建会话时，您都可以在数据库中保存时间戳值。

然后你可以使用：

```
ORDER BY timestampRow DESC 
```

在您的 SQL 查询中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-16T12:42:26.953

您可以在数据库表上放置一个自动递增的 ID。当您进行选择时，您会选择具有最大 id 的数据。像这样：

```
 SELECT "id,name_first,name_last,email,company,city,state,phone,session,optout FROM table" WHERE id >=MAX(id); 
```

# media - Sitecore 自动发布媒体和文件夹

> ID：11398880
> 
> 赞同：1
> 
> 时间：2012-07-09T16:03:22.833
> 
> 标签：media, sitecore, publish, directory

我们有一个媒体项目和网页项目的结构，其工作方式类似于 - 部分 -> 年 -> 月 -> 日 -> 文章/媒体。目前，上传到媒体库的这些日期文件夹和图像要么由用户手动发布，要么由每 15 分钟运行一次的计划发布任务发布，从而导致媒体或文章出现短暂延迟。

有没有办法在创建这些文件夹/图像后立即自动发布它们？我知道项目可以设置为具有最终状态的工作流，其下方有一个“自动发布”命令，该命令在项目达到最终状态后立即触发。

我不想在基于系统模板的文件夹和图像上设置工作流。我可以利用管道或命令在保存时自动发布文件夹/媒体库吗？

也欢迎任何其他建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T12:46:11.400

我不建议在创建时自动发布它们，因为如果您创建一个文件夹，它将发布，然后是另一个，它会再次发布。每个发布操作都会清除 Sitecore 缓存。

相反，我建议您创建一个用于发布的管道处理器或一个用于发布的事件处理程序，如果您正在发布一个媒体项目，请在媒体库（文件夹）中遍历其父项并从那里启动发布直到您找到一个已经发布的（那是你遍历的断点）。您需要确定代码以查看其是否已发布。这只是一种方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T18:35:09.867

我认为您必须为 item:saved 创建一个新的处理程序，然后检查其上的模板。我不相信媒体项目有特定的管道。

# c# - 如何将 json 转换为 NameValueCollection

> ID：11398882
> 
> 赞同：6
> 
> 时间：2012-07-09T16:03:30.570
> 
> 标签：c#, .net, json

如何`NameValueCollection`简单地将 JSON 字符串转换为 C#，最好不使用 3rd 方解析器？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-09T16:18:02.497

我不确定为什么每个人仍然推荐使用 JSON.NET 来反序列化 JSON。我写了[一篇关于如何将 JSON 反序列化为 C#](http://procbits.com/2011/04/21/quick-json-serializationdeserialization-in-c/)的博客文章。

简而言之，它是这样的：

```
using System.Web.Script.Serialization;

var jss = new JavaScriptSerializer();
var dict = jss.Deserialize<Dictionary<string, string>>(jsonText);

NameValueCollection nvc = null;
if (dict != null) {
  nvc = new NameValueCollection(dict.Count);
  foreach (var k in dict) {
    nvc.Add(k.Key, k.Value);
  }
}
                    }
var json = jss.Serialize(dict);
Console.WriteLine(json); 
```

请务必添加对 System.Web.Extensions.dll 的引用。

**注意：** 我通常反序列化为`dynamic`，所以我假设这`NameValueCollection`会起作用。但是，我还没有验证它是否确实如此。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-09T16:08:50.240

**编辑**

没有第三方开发的纯 .net 解决方案请看：[JavaScriptSerializer – 字典到 JSON 序列化和反序列化](http://weblogs.asp.net/hajan/archive/2010/07/23/javascriptserializer-dictionary-to-json-serialization-and-deserialization.aspx)

* * *

使用[Json.NET](http://www.codeplex.com/Json)

```
string jsonstring = @"{""keyabc"":""valueabc"",""keyxyz"":""valuexyz""}";

Dictionary<string, string> values = 
   JsonConvert.DeserializeObject<Dictionary<string, string>>(jsonstring); 
```

检查@jon 答案建议相同：[.Net Linq to JSON with Newtonsoft JSON library](https://stackoverflow.com/questions/5033178/net-linq-to-json-with-newtonsoft-json-library)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-09T20:11:51.803

如果您的 JSON 包含其中的嵌套对象，则下面的解决方案将正确处理它们（基于 JSON.NET，但您可以适应您选择的 JSON 解析器）。

此用法示例：

```
var json = "{\"status\":\"paid\",\"date\":\"2019-10-09T17:30:51.479Z\",\"customer\":{\"id\":123456789,\"country\":\"br\",\"name\":\"Thomas Vilhena\",\"phone_numbers\":[\"+5511987654321\"],\"documents\":[{\"id\":\"doc_id\"}]}}";

var dict = JsonConvert.DeserializeObject<Dictionary<string, object>>(json);            
var nvc = new NameValueCollection(dict.Count);
AddKeyValuePairs(nvc, dict);

Console.WriteLine(nvc["status"]);
Console.WriteLine(nvc["date"]);
Console.WriteLine(nvc["customer[phone_numbers][0]"]);
Console.WriteLine(nvc["customer[id]"]);
Console.WriteLine(nvc["customer[documents][0][id]"]); 
```

产生以下输出：

```
paid
09.10.2019 17:30
+5511987654321
123456789
doc_id 
```

这是实现：

```
private static void AddKeyValuePairs(
    NameValueCollection nvc,
    Dictionary<string, object> dict,
    string prefix = null)
{
    foreach (var k in dict)
    {
        var key = prefix == null ? k.Key : prefix + "[" + k.Key + "]";
        if (k.Value != null)
            AddKeyValuePair(nvc, key, k.Value);
    }
}

private static void AddKeyValuePair(
    NameValueCollection nvc,
    string key,
    object value)
{
    if (value is string || value.GetType().IsPrimitive)
    {
        nvc.Add(key, value.ToString());
    }
    else if (value is DateTime)
    {
        nvc.Add(key, ((DateTime)value).ToString("g"));
    }
    else
    {
        AddNonPrimitiveValue(nvc, key, value);
    }
}

private static void AddNonPrimitiveValue(
    NameValueCollection nvc,
    string key,
    object value)
{
    var a = value as JArray;
    if (a != null)
    {
        for (int i = 0; i < a.Count; i++)
            AddKeyValuePair(nvc, key + "[" + i + "]", a[i]);
    }
    else
    {
        var v = value as JValue;
        if (v != null)
        {
            AddKeyValuePair(nvc, key, v.Value);
        }
        else
        {
            var j = value as JObject;
            if (j != null)
                AddKeyValuePairs(nvc, j.ToObject<Dictionary<string, object>>(), key);
        }
    }
} 
```

# c++ - 使用最小生成树查找从 A 到 B 的路径 - C/C++

> ID：11398885
> 
> 赞同：1
> 
> 时间：2012-07-09T16:03:39.353
> 
> 标签：c++, algorithm, tree, graph-algorithm, minimum-spanning-tree

假设我们找到了一个最小生成树。现在，我们只需要 MST 中从 A 到 Z 的路径。我们如何在 O(n^2) 时间内做到这一点？

我们从根 A 开始。然后我们查看 Ax 形式的树中的所有边（其中 x 是任何顶点）。

然后，假设我们找到：AB、AC、AD 等......然后对于每一个，我们寻找形式的边：Bx、Cx、Dx......这显然不是 O(n^2)。

那么在给定 MST 的情况下，找到路径 A -> Z 的更好/有效方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T16:13:28.700

[Depth-first search](http://en.wikipedia.org/wiki/Depth-first_search) will be sufficient, it is in the worst case *O(|V| + |E|)*. The fact that your input is a MST means that you don't have to worry about any loop detection, as you would have in a general graph.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:14:32.927

查找[最小生成树](http://en.wikipedia.org/wiki/Minimum_spanning_tree)，你会发现它是一个将所有顶点连接在一起的最小子图。这意味着每条边**最多**只能使用一次。您可以只使用 DFS 或 BFS 来查找所需的路径，而无需检查循环，因为您已经拥有 MST。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T18:12:51.160

如果你仔细想想，Prim 寻找 MST 的算法实际上只是 Dijkstra 的伪装。因此，如果您找到一条，MST 已经为您提供了最短路径（如上所述，想想 DFS）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T18:03:16.863

在 MST 创建期间，您可以填写 parent[]，因此之后使用简单的回溯，您将能够找到没有 DFS 的路径。

# java - 最佳实践 struts/jsp/i18n/resourceBundle

> ID：11398896
> 
> 赞同：1
> 
> 时间：2012-07-09T16:04:13.097
> 
> 标签：java, jsp, internationalization, struts2, resourcebundle

我正在使用 Struts 2 和 Apache 磁贴，而且我都是新手。我正在尝试“清理”一些对我来说不正确的现有资源（如果我错了，请告诉我）。

我有以下结构：

*   在 layout.jsp 中：

    ```
    <html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <title><tiles:getAsString name="title" /></title>
        <tiles:insertAttribute name="header" />
    </head>
    <body>
        <div id="content-size-and-border">
            <s:if test="display!='nomenu'">
                <tiles:insertAttribute name="menu" />
            </s:if>         
            <div id="maincontent">
                <tiles:insertAttribute name="maincontent" />
            </div>
        </div>

    </body> 
    ```

主要内容部分根据单击的项目菜单显示各种 jsp/action。菜单部分直接在jsp中使用一些java代码，通过迭代一个列表来生成多个子文件夹。

```
<li class="highlight sousmenu"><a href="#"><s:text
    name="menu.demarrage" /></a>
    <ul class="niveau2">

        <%
        Locale language = (Locale) session.getAttribute("WW_TRANS_I18N_LOCALE"); 
        // the attribute (used by i18n struts interceptor) 
        // set in session when the user changes the language

        if (language == null)
            language = request.getLocale() ;
        // if the language was not changed, get the default Locale from browser

        User user = ((CustomUserDetails) SecurityContextHolder.getContext()
                .getAuthentication().getPrincipal()).getBpmUser();
            if (user != null) {
                for (Iterator iterator = user.getProcesses().iterator(); iterator
                        .hasNext();) {
                    String processToStart = (String) iterator.next();
                    String processPath = BpmUiConstantes.BPMUI_PROCESS_CONFIG_ROOT + "/" + processToStart ;
                    String processLib = "process." + processToStart + ".label";                              
        %>

        <li>
            <a href="<%=request.getContextPath()%>/restricted/DemarrerProcessAvecTache?processName=<%=processToStart%>">
                <fmt:setLocale value="<%=language%>"/>
                <fmt:bundle basename="<%=processPath%>">
                    <fmt:message key="<%=processLib%>"/>
                </fmt:bundle>
            </a>
        </li>

        <%
                }   
            }
        %>
    </ul>
</li> 
```

我想知道是否有更好的方法来实现相同的结果，而无需 jsp 中的 java 代码。从概念的角度来看，从 jsp 中删除 java 代码是否重要？

该应用程序使用 struts i18n 拦截器进行语言更改。有没有办法让菜单以某种方式使用 struts i18n 拦截器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T08:20:34.823

我肯定会更多地研究 JSTL 核心（使用 foreach 的 C 标记）和 fmt（用于语言环境），使用这两个库，您应该能够安全地将嵌入的 java 代码删除到您的页面中并使用更一致的/安全的方法

这是 JSTL 的 oracle 网页，因此您可以参考

[JSTL 参考](http://docs.oracle.com/javaee/5/jstl/1.1/docs/tlddocs/overview-summary.html)

如果您还有其他问题，请随时询问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T09:34:44.023

我将在上一篇文章中添加一些答案：

没有办法让这个菜单使用 struts i18n 拦截器，最重要的是，它是无用的，因为这个拦截器不会设置 ResourceBundle 的 Locale 或 fmt:bundle 的 Locale。有必要明确指定语言环境（就像我在代码中所做的那样）=> 这部分不能更改。

不过，我仍然不确定从 jsp 中删除此 java 代码的重要性。

# android - 防止Android中的渐变条带

> ID：11398898
> 
> 赞同：0
> 
> 时间：2012-07-09T16:04:14.690
> 
> 标签：android, drawable

我将通过两种方式在我的应用程序中实现渐变。一个实际的 .png 和一个使用渐变的形状。我一直在四处寻找，以确保我的两种不同的实现在所有设备上都能很好地工作。我归结为两种解决方案。

**1.** `GradientDrawable.setDither()`

和

**2.** `getWindow().setFormat(PixelFormat.RGBA_8888);`

一种方法比另一种更好吗？我应该同时使用这两种方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:34:16.160

```
 getWindow().setFormat(PixelFormat.RGBA_8888); 
```

那对你来说很好。。

看看它...[渐变在 SurfaceView 中显示为带状，但在普通视图中看起来非常平滑](https://stackoverflow.com/questions/7774867/gradient-appears-banded-in-a-surfaceview-but-looks-very-smooth-in-a-normal-view)

希望能帮助到你...

# django - Django 身份验证行为怪异。工作“有时”，并不总是

> ID：11398900
> 
> 赞同：2
> 
> 时间：2012-07-09T16:04:17.107
> 
> 标签：django, templates, authentication

我在使用 Django 的身份验证系统时遇到了一些问题。我已经设法设置了一个登录页面、注销页面和一个基本的个人资料页面。现在我试图将站点上的不同区域限制为仅经过身份验证的用户。它适用于某些模板，而不适用于其他模板。

也许最奇怪的是它在同一个模板中工作/不工作。

这是base.html：

```
<div id="account">
    {% if user.is_authenticated %}
        Hello, <a href="{% url accounts-profile %}">{{ user.username }}</a>! | <a href="{% url accounts-logout %}">Log out</a>
    {% else %}
        <a href="{% url accounts-login %}">Log in</a>
        or
        <a href="#">Sign up</a>
    {% endif %}
</div>

<div id="sidebar">
    {% if user.is_authenticated %}
        <h3 id="plus" style="padding-top: 20px;"><a href="#">Sign up!</a></h3>
        <a href="{% url accounts-login %}">Log in</a>
    {% else %}
        <div style="margin-top: 45px">
            <a href="{% url accounts-profile %}">Profile</a>
        </div>
    {% endif %}     
</div> 
```

在 account-div 中工作，但不在 sidebar-div 中。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T19:00:45.803

你有

```
 {% if user.is_authenticated %}
        <h3 id="plus" style="padding-top: 20px;"><a href="#">Sign up!</a></h3>
        <a href="{% url accounts-login %}">Log in</a>
 {% else %} 
```

如果他登录了，为什么他必须注册？你可以试试 {% if not user.is_authenticated %}

# jquery - JQuery - 用逻辑隐藏/显示

> ID：11398904
> 
> 赞同：0
> 
> 时间：2012-07-09T16:04:31.723
> 
> 标签：jquery

说到 JQuery，我是新手。简单地说，我有四个“portlet-topper”类的 div。每个 div 都有一个“portlet-content”类的兄弟。此内容是隐藏的，直到单击 portlet-topper 的一个实例。单击后，将显示其同级内容。我使用以下代码：

```
$(".portlet-topper").click(function(e){
    e.preventDefault();
    $(this).siblings(".portlet-content").toggle();
}); 
```

点击前澄清：

|----portlet-topper-A----|

|----portlet-topper-B----|

点击A后：

|----portlet-topper-A----|

A 的 Portlet 内容

|----portlet-topper-B----|

如果我单击 B，则显示 B 的内容，而 A 的内容也将显示。如果点击了A，我希望在隐藏A的同时点击B来显示B。我将如何在这个逻辑中进行编码？我需要它适用于任意数量的 div，而不仅仅是两个。本质上，只允许一次显示一组 portlet 内容。我想我会明确调用显示和隐藏，而不是切换。即使这样，我也不确定从哪里开始......

另外，我正在使用 Liferay，所以我几乎无法控制每个 div 的类和 id。我只能操作 css 或 javascript

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:10:14.190

我相信您正在寻找的功能是由 jQuery UI 提供的。

演示：http: [//jsfiddle.net/SO_AMK/22fWm/](http://jsfiddle.net/SO_AMK/22fWm/)

文档：http: [//jqueryui.com/demos/accordion/](http://jqueryui.com/demos/accordion/)

jQuery：

```
$(function() {
    $( "#accordion" ).accordion();
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:17:20.667

我认为你需要这样做：

```
$(".portlet-topper").click(function(e){ 
    e.preventDefault();
    $(".portlet-content").hide();
    $(this).siblings(".portlet-content").toggle(); 
}); 
```

否则，您将永远不会隐藏您的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T16:09:47.560

页面中是否还有其他地方使用了“portlet-content”类。如果没有，你可以这样做：

```
$('portlet-content').toggle(); 
```

这将切换具有该类的每个内容区域

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T16:11:06.677

如果我理解正确，您希望显示最近单击的 portlet 的内容，并隐藏其余内容。这是一种不使用 jQuery UI 的故障安全方式：

```
$(".portlet-topper").click(function(e) {
    $(".portlet-content").hide();
    $(this).find(".portlet-content").show();
}); 
```

如果 case`.portlet-content`是 的兄弟姐妹，而不是 的孩子，请`.portlet-topper`使用.`.next()``.find()`

# java - SwiftMQ URL 解析器无法解析正确的 URL

> ID：11398906
> 
> 赞同：0
> 
> 时间：2012-07-09T16:04:38.323
> 
> 标签：java, spring, jms

当我尝试发送消息时，出现以下异常。该 URL 似乎正确，我之前使用过类似的配置。我不知道什么可能导致这个问题......

```
Caused by: javax.naming.NamingException: invalid URL: protocol != smqp, URL==smqp://activemq:3001/timeout=10000
    at com.swiftmq.jndi.v400.URLParser.parseURL(Unknown Source)
    at com.swiftmq.jndi.InitialContextFactoryImpl.getInitialContext(Unknown Source)
    at javax.naming.spi.NamingManager.getInitialContext(NamingManager.java:667)
    at javax.naming.InitialContext.getDefaultInitCtx(InitialContext.java:288)
    at javax.naming.InitialContext.init(InitialContext.java:223)
    at javax.naming.InitialContext.<init>(InitialContext.java:197)
    at org.springframework.jndi.JndiTemplate.createInitialContext(JndiTemplate.java:136)
    at org.springframework.jndi.JndiTemplate.getContext(JndiTemplate.java:103)
    at org.springframework.jndi.JndiTemplate.execute(JndiTemplate.java:85)
    at org.springframework.jndi.JndiTemplate.lookup(JndiTemplate.java:152)
    at org.springframework.jndi.JndiTemplate.lookup(JndiTemplate.java:178)
    at org.springframework.jndi.JndiLocatorSupport.lookup(JndiLocatorSupport.java:95)
    at org.springframework.jndi.JndiObjectLocator.lookup(JndiObjectLocator.java:105)
    at org.springframework.jndi.JndiObjectTargetSource.getTarget(JndiObjectTargetSource.java:127)
    ... 50 more 
```

**配置**

```
<!-- JMS Connection Factory -->
<bean id="jndiTemplate" class="org.springframework.jndi.JndiTemplate">
    <property name="environment">
        <props>
            <prop key="java.naming.provider.url">smqp://activemq:3001/timeout=10000</prop>
            <prop key="java.naming.factory.initial">com.swiftmq.jndi.InitialContextFactoryImpl</prop>
        </props>
    </property>
</bean>

<bean id="jmsConnectionFactory" class="org.springframework.jndi.JndiObjectFactoryBean">
    <property name="jndiTemplate" ref="jndiTemplate" />
    <property name="jndiName" value="QueueConnectionFactory" />
    <property name="lookupOnStartup" value="false" />
    <property name="cache" value="false" />
    <property name="proxyInterface" value="javax.jms.QueueConnectionFactory" />
</bean>

<bean id="sendConnectionFactory" class="org.springframework.jms.connection.CachingConnectionFactory" destroy-method="destroy">
    <property name="targetConnectionFactory" ref="jmsConnectionFactory" />
    <property name="reconnectOnException" value="true" />
    <property name="sessionCacheSize" value="100"/>
</bean>

<!-- Template used only for sending messages -->
<bean id="jmsTemplate" class="org.springframework.jms.core.JmsTemplate">
    <property name="connectionFactory" ref="sendConnectionFactory" />
    <property name="defaultDestinationName" value="request@z4smq_4001" />
</bean> 
```

**用法**

```
MessageCreator messageCreator = new MessageCreatorImpl(payload);
jmsTemplate.send(messageCreator); // setter injection 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T06:35:05.780

“smqp://”前面是否有空格或任何其他不可见字符？在那种情况下，我会得到相同的异常，否则它对我有用。

您应该将您的问题发布到 SwiftMQ 的[用户论坛](http://old.nabble.com/SwiftMQ-JMS-Forum-f15660.html)以吸引适当的受众。

# python - 在类中加载外部模块时无法加载 apache 服务器

> ID：11398911
> 
> 赞同：1
> 
> 时间：2012-07-09T16:04:49.277
> 
> 标签：python, django, apache, web-applications, beautifulsoup

这是我的 django 项目层次结构

```
project/
       apache/ django.wsgi
       project/ __init__.py, settings.py, urls.py ..
       pages/
             __init__.py
             widgets.py
             website_views.py
       services/
               __init__.py
               apis/
                    __init__.py
                    fparser.py
                    googleData.py
                    wp.py
                    ...
               wservice.py
       ... 
```

因此，这`wservice.py`是一个类似于类的总结类，它位于所有`apis`模块类中。它甚至为它继承的所有类提供了一些通用功能。

`wservice.py`

```
import feedparser
from bs4 import BeautifulSoup

class WidgetService(FParser):
    def post_content_summary(self, post_number):   
        ....
        content_text = content_soup.get_text()

        ...

    def get_random_image(self, post_number):
        ...
        content_soup = BeautifulSoup(html_content)

        ... 
```

`FParser`班级位于`fparser.py`

`fparser.py`上面的类中的方法就是这样使用的。

```
from services.wservice import WidgetService
def method1():
    obj = WidgetService()
    m1 = obj.foo1() # described in FParser class
    m2 = obj.foo2() # described in WidgetService class 
```

我在`pages/widgets.py`. 所以，我发现，当我开始使用`BeautifulSoup`时，apache 服务器没有加载。它甚至没有显示任何语法错误。

我什至没有在日志文件中看到任何错误。

可能出了什么问题？？？有趣的是，我在开发服务器 heroku (gunicorn) 中没有遇到过这种错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T20:48:22.320

这可能是[此处描述的 Cython 和 mod_wsgi 之间的交互，并在](https://techknowhow.library.emory.edu/blogs/branker/2010/07/30/django-lxml-wsgi-and-python-sub-interpreter-magic)[此处](https://bugs.launchpad.net/beautifulsoup/+bug/948577)在 Beautiful Soup 上下文中进行了探索。这是与您类似[的较早问题。](https://stackoverflow.com/questions/10235579/502-bad-gateway-using-beautiful-soup-python-django)

# c - 硬件处理器计数器重置不正确

> ID：11398912
> 
> 赞同：2
> 
> 时间：2012-07-09T16:04:50.397
> 
> 标签：c, assembly, x86, msr

[我写了一个程序，它读取英特尔芯片上的 APERF/MPERF 计数器（ http://www.intel.com/content/dam/doc/manual/64-ia-32-architectures-software-developer-vol](http://www.intel.com/content/dam/doc/manual/64-ia-32-architectures-software-developer-vol-3b-part-2-manual.pdf)上的第 2 页[-3b-part-2-manual.pdf](http://www.intel.com/content/dam/doc/manual/64-ia-32-architectures-software-developer-vol-3b-part-2-manual.pdf)）。

这些计数器可通过 readmsr/writemsr 指令读取/写入，我目前只是通过 Windows 7 中的设备驱动程序定期读取它们。计数器是 64 位，并且随着每个处理器时钟大约递增，所以你预计它们会在很长一段时间内溢出，但是当我读取计数器时，它们的值会跳跃，就好像它们正在被另一个程序重置一样。

有什么方法可以追踪哪些程序会重置计数器？其他东西会导致读取不正确的值吗？我正在使用的相关程序集和相应的 C 函数附在下面。rdmsr 的 64 位结果保存到 eax:edx 中，因此为了确保我没有丢失 r_x 寄存器中的任何数字，我多次运行该命令以检查它们。

C：

```
long long test1, test2, test3, test4;
test1 = TST1();
test2 = TST2();
test3 = TST3();
test4 = TST4();
status = RtlStringCbPrintfA(buffer, sizeof(buffer), "Value: %llu %llu %llu %llu\n", test1, test2, test3, test4); 
```

集会：

```
;;;;;;;;;;;;;;;;;;;
PUBLIC TST1 
TST1 proc
    mov ecx, 231 ; 0xE7
    rdmsr
    ret ; returns rax
TST1 endp

;;;;;;;;;;;;;;;;;;;
PUBLIC TST2 
TST2 proc
    mov ecx, 231 ; 0xE7
    rdmsr
    mov rax, rbx
    ret ; returns rax
TST2 endp

;;;;;;;;;;;;;;;;;;;
PUBLIC TST3 
TST3 proc
    mov ecx, 231 ; 0xE7
    rdmsr
    mov rax, rcx
    ret ; returns rax
TST3 endp

;;;;;;;;;;;;;;;;;;;
PUBLIC TST4 
TST4  proc
    mov ecx, 231 ; 0xE7
    rdmsr
    mov rax, rdx
    ret ; returns rax
TST4 endp 
```

打印出来的结果如下所示，但唯一改变的寄存器是 rax 寄存器，它不会单调增加（可以跳来跳去）：

```
Value: 312664 37 231 0
Value: 252576 37 231 0
Value: 1051857 37 231 0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T19:45:23.770

I was not able to figure out what was resetting my counters, but I was able to determine the frequency. The Intel docs state that when one counter overflows, the other counter also will. So even though the counters are constantly resetting, the ratio of aperf and mperf still does represent the processor's frequency.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:40:51.647

It seems that Windows 7 and Windows 8 read and reset the writeable APERF/MPERF counters on AMD processors. So, you want to access the read-only APERF/MPERF counters at registers 0xc00000E7/E8.

But there is a new issue. On some of the latest AMD processors (Family 0x16 processors), those registers are not always supported. To determine if those registers are supported, you have to read the EffFreqRO bit in CPUID Fn8000_0007_EDX. As stated before, all this applies only to AMD processors.

# c# - WPF 中的上下文文本编辑器

> ID：11398914
> 
> 赞同：6
> 
> 时间：2012-07-09T16:05:00.307
> 
> 标签：c#, .net, wpf

我们目前正在寻求在 WPF (.NET 4.0) 中创建一个文本编辑器，这将允许我们团队中的作者创建电影脚本。简而言之，功能应该类似于 FinalDraft 或 Adob​​e Story 的功能（即：文本的上下文定位取决于光标的位置和用户意图）

我们目前正在研究两种不同的设计解决方案：

*   一个 WPF 控件将充当容器，多个小的文本编辑控件将表示脚本中的行。这将允许我们使用它们的边距定位控件，同时也使绑定变得容易。这里的挑战是处理多行选择。我正在考虑使用列表框作为容器，每个列表框项都是包含文本框的自定义控件。这将需要根据用户的操作来实例化控件。一切都将被剥皮，以给人一种用户正在空白页面上工作的印象。

*   一个能够显示自定义 XML 数据的大文本框。这里的挑战是确定光标的确切位置（即：光标位于演员姓名的顶部等）并适当地定位文本（即：演员姓名居中并大写等）

我最近尝试实现第一个解决方案，但必须重新实现基本文本框中内置的整个选择行为并非易事，并且需要大量工作。至于第二种解决方案，绑定到我的业务对象将比简单地实例化具有不同绑定的多个控件要困难得多。

您还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T08:32:02.937

我曾经需要一个应用程序的文本编辑器。我们有一个用于设置的大 xml 文件，用户应该能够编辑这些文件。

事实证明，如果您的文件足够大（+ 10000 行），富文本框就会变得*非常*缓慢。

至于构建 gui 掩码：仅当您的用户写一些简短的选项（例如文本）时。但我了解您是否希望您的用户编写创意文本。这个“面具”gui - “很多小地方”会让他们觉得他们是 80 年代。

我建议：不要写 Programm ，只写一个 Plugin 到现有的编辑器。有些是免费的，例如：http: [//www.codeproject.com/Articles/42490/Using-AvalonEdit-WPF-Text-Editor](http://www.codeproject.com/Articles/42490/Using-AvalonEdit-WPF-Text-Editor) 或 word 插件 - 人们喜欢 Word 并了解 Word [http://www.codeproject.com /Articles/8837/Writing-a-Word-Add-in-Part-I](http://www.codeproject.com/Articles/8837/Writing-a-Word-Add-in-Part-I)

而对于绑定数据等：一旦文本被写入，用户只需按下保存按钮，您就可以解析输入的信息。我不会在飞行中这样做，因为它会变得很慢。您还说信息是链接的，因此只有写入所有数据后您才能使用它。

# php - 获取带有纯扩展名的文件名

> ID：11398919
> 
> 赞同：1
> 
> 时间：2012-07-09T16:05:09.430
> 
> 标签：php

我正在编写脚本以从站点获取图像。一切都很好，但后来我注意到有些网站的图像格式如下：

```
http://site-name/images/dude-i-m-batman.jpg?1414151413
http://site-name/images/dude-i-m-batman.jpg?w=300 
```

现在我正在处理它

```
$file = substr($media,0, strrpos($image, '.') + 4); 
```

我只是想知道这是一个好的做法还是有更好的方法。

我尝试了 pathinfo 和其他几种方法，但都返回带有查询字符串的扩展名。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-09T16:09:46.527

用 解析 URL [`parse_url`](http://php.net/manual/en/function.parse-url.php)，检索路径部分：

```
 $datum = parse_url($url);

 $parts = pathinfo($datum['path']);

 $ext = $parts['extension']; 
```

`getImageInfo($full_url)`如果允许，您也可以使用`fopen_wrappers`，并检索图像信息，例如宽度、高度，最重要的是，mime_type。

这是因为您会发现几个没有扩展名或错误的文件，将其放在那里以欺骗浏览器下载为图像并相信浏览器仍然会识别图像格式（去过那里，做到了:-(）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T16:14:28.997

我不确定您是要扩展名还是（从您当前的代码判断）完整路径（减去任何查询字符串）。

这是两个：

```
$file = "http://site-name/images/dude-i-m-batman.jpg?1414151413";
preg_match('/^([^\?]+)(?:\?.*)?/', $file, $path_noQS);
preg_match('/(?<=\.)(\w{2,5})(?:\?.*)?/', $file, $extension);
echo $path_noQS[1]; //path, without QS
echo $extension[1]; //extension 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-09T16:16:15.267

显然你现在做的事情有一些不足之处。其中一个你已经注意到了你自己的：

*   并非所有 URL 都以文件扩展名结尾。
*   并非所有文件扩展名都是三个字母（例如`.jpeg`）

所以你想要的是从一个 URL 获取路径：

```
$imagePath = parse_url($imageUrl, PHP_URL_PATH); 
```

然后您想从该路径获取扩展名：

```
$imageName = pathinfo($imagePath, PATHINFO_EXTENSION); 
```

并做了。您不是第一个需要它的人，因此该工作已经存在功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T16:07:34.437

您的解决方案仅适用于 3 个字符扩展名。如果您知道所有扩展名都是 3 个字符，那么您的扩展名将是一个完全可行的解决方案。除此以外：

```
$ext = pathinfo($filename, PATHINFO_EXTENSION); 
```

如果您有正确的文件名，这绝对可以工作

如果由于某种原因不起作用，您可以使用它：

```
$ext = end(explode('.', $filename));
$ext = substr(strrchr($filename, '.'), 1);
$ext = substr($filename, strrpos($filename, '.') + 1);
$ext = preg_replace('/^.*\.([^.]+)$/D', '$1', $filename);
$exts = split("[/\\.]", $filename);
$n = count($exts)-1;
$ext = $exts[$n]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-09T16:10:58.497

可能是这样的

```
$parsedUrl = parse_url('http://site-name/images/dude-i-m-batman.jpg?1414151413');
$parsedFileInfo = pathinfo($parsedUrl['path']);
echo $parsedFileInfo['extension']; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-09T16:11:06.660

[http://codepad.org/KXZwKCjs](http://codepad.org/KXZwKCjs)

```
$u = 'http://site-name/images/dude-i-m-batman.zip.jpg?1414151413?1234';
$u = explode('?', $u, 2 ); // ignore everything after the first question mark
$ext = end(explode('.',$u[0])); // last 'extension' 
```

# symfony - 使用 Doctrine/Symfony2 对具有没有主键的表的数据库进行逆向工程

> ID：11398925
> 
> 赞同：2
> 
> 时间：2012-07-09T16:05:23.597
> 
> 标签：symfony, doctrine-orm

我试图以这种方式使用 Doctrine 对数据库进行逆向工程：

```
php app/console  doctrine:mapping:convert xml ./src/Acme/TxBundle/Resources/config/doctrine/metadata/orm --from-database --force 
```

或者也这样（遇到同样的问题）：

```
php app/console doctrine:mapping:import TxBundle 
```

但我总是收到以下错误：

```
PHP Fatal error:  Call to a member function getColumns() on a non-object in /var/www/Symfony/vendor/doctrine/lib/Doctrine/ORM/Mapping/Driver/DatabaseDriver.php on line 134
Fatal error: Call to a member function getColumns() on a non-object in /var/www/Symfony/vendor/doctrine/lib/Doctrine/ORM/Mapping/Driver/DatabaseDriver.php on line 134 
```

看来我有一些没有主键的表，我需要知道是否可以让 Doctrine 使用这些表而不改变表结构以添加所需的 PK？

# python - 在 OS X 10.7 上安装 PyCrypto for Python 3.2

> ID：11398928
> 
> 赞同：2
> 
> 时间：2012-07-09T16:05:29.847
> 
> 标签：python, macos, python-3.x, pycrypto

我使用 Python 3.2 在 Mac OSX Lion 上编译并安装了 pycrypto 2.6，但是当我尝试运行命令时

```
import Crypto.Cipher.AES 
```

我得到这个问题

```
Traceback (most recent call last):
File "/Users/DaZzz/Documents/Python Workspace/Cryptography Coursera/W2PA.py", line 8, in <module>
import Crypto.Cipher.AES
File "/Library/Python/2.7/site-packages/Crypto/Cipher/AES.py", line 50, in <module>
from Crypto.Cipher import _AES
ImportError: dlopen(/Library/Python/2.7/site-packages/Crypto/Cipher/_AES.so, 2): Symbol not found: _PyInt_FromLong
Referenced from: /Library/Python/2.7/site-packages/Crypto/Cipher/_AES.so
Expected in: flat namespace
in /Library/Python/2.7/site-packages/Crypto/Cipher/_AES.so 
```

顺便说一句，我使用安装了 PyDev 的 eclipse。我也尝试在 IDLE 中运行它，但出现以下错误：

```
Traceback (most recent call last):
  File "<pyshell#1>", line 1, in <module>
    import Crypto.Cipher.AES
  File "/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/site-packages/Crypto/Cipher/AES.py", line 50, in <module>
    from Crypto.Cipher import _AES
ImportError: cannot import name _AES 
```

应该强调的是，为了在 IDLE 中运行它，我将带有 Crypto 的目录复制到了 python 路径中。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:16:52.947

看到`/Library/Python/2.7`消息中的？看来您实际上在这里运行的是 Python 2.7。您需要告诉 PyDev 使用 Python 3.2。你确定你使用的是 Python 3.2 版本的 IDLE 吗？每个版本的 Python 都有单独的 IDLE。尝试`idle3.2`从命令行输入，或者在 Finder 中单击`/Applications/Python 3.2/IDLE.app`。

更新：适用于我使用 python.org 64 位/32 位 Python 3.2.3 和 Xcode 4.3（您可能需要创建一个符号链接`/Developer`来解决 Xcode 4.3 的 SDK 位置更改）。

```
# for Xcode 4.3+ only
$ [ ! -e /Developer ] && sudo ln -s Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer /Developer

$ tar xf ./pycrypto-2.6.tar.gz
$ cd ./pycrypto-2.6
$ python3.2 setup.py install
$ cd
$ python3.2
Python 3.2.3 (v3.2.3:3d0686d90f55, Apr 10 2012, 11:25:50) 
[GCC 4.2.1 (Apple Inc. build 5666) (dot 3)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import Crypto.Cipher.AES
>>> Crypto.Cipher.AES.__file__
'/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/site-packages/Crypto/Cipher/AES.py' 
```

# gwt - GWT 中的 Handler 概述

> ID：11398929
> 
> 赞同：1
> 
> 时间：2012-07-09T16:05:35.547
> 
> 标签：gwt, handler

是否有关于 GWT 中所有处理程序及其相应容器的概述？每当我尝试向容器添加处理程序时，我必须检查处理程序是否触发事件（JavaDoc 没有提供有关此的有用信息）。例如一个 ResizeHandler：

```
 SplitLayoutPanel splitLayoutPanel = new SplitLayoutPanel() {
            @Override
            public void onResize() {
                super.onResize();
                System.out.println("onResize");
            }           
        };

        splitLayoutPanel.addHandler(new ResizeHandler() {

            @Override
            public void onResize(ResizeEvent event) {

                System.out.println("resize");

            }
        }, ResizeEvent.getType()); 
```

覆盖 onResize() 方法（1\. 示例）会提供信息，如果拆分器发生更改，但如果我添加 ResizeHandler（2\. 示例），我不会收到任何 onResize 方法的调用。我不明白为什么，也没有找到为什么这个容器中不允许处理程序的文档。

我搜索所有可用处理程序的概述，以及它们可能的容器和事件，它们何时被触发。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T18:28:32.307

通常会有更具体的`addHandler`方法。例如，`Button`有`addClickHandler(ClickHandler)`. 定义该方法的接口是`HasClickHandlers`，例如，您可以留意它。

如果事件没有它自己的`addXyzHandler`方法，它可能不会得到很好的支持。在这种情况下，通常很容易将小部件子类化并自己添加对该处理程序的支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T09:40:47.257

如果您在 Widget 上使用 addHandler() 添加处理程序，则必须确保底层 DOM 元素可以捕获匹配事件。如果是，您还必须告诉您的小部件使用

```
void com.google.gwt.user.client.ui.Widget.sinkEvents(int eventBitsToAdd) 
```

其中 eventBitsToAdd 是来自 com.google.gwt.user.client.Event 的常量。本机尚不支持 AFAIK ONRESIZE 事件。所以正如我昨天所说，你必须实现你的鼠标处理程序和手势，或者覆盖一个滑块;-)

# c++ - 如何在 C++ 中对某些数据结构进行超类化？

> ID：11398933
> 
> 赞同：1
> 
> 时间：2012-07-09T16:05:50.227
> 
> 标签：c++, inheritance

我有一个包含 100 个数据结构的 C 头文件。我想创建一个每个数据结构都继承自的超类。怎么做？我应该解析头文件吗？反射？

因为每个 C 数据结构都是公共类，所以我可以创建一个超类，然后……然后呢？我不应该手动进入并显式地使每个结构都从超类继承吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:32:06.257

对于您的特定用例，我将保持 C 代码不变，并利用 C 代码在 C++ 中创建您需要的任何解决方案。例如，您可以创建一个并行层次结构，其基础定义包含接口，`serialize()`每个`deserialize()`派生类型存储一个 C 结构并实现该特定类型的序列化。

您还可以通过提供为每个 C 结构定义的模板化`serialize`/`deserialize`函数来完全从外部解决这个问题……继承是 C++ 中最常被滥用的特性之一。

最佳解决方案将取决于您打算如何使用代码，但我会避免重写 C 代码（即编写编辑器脚本以将 C 标头重写为 C++ 解决方案），因为这将有效地从 C 库分支出来，您将如果您需要在 C 端扩展它，则需要维护两个单独的分支。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T16:33:49.697

如果你有一堆结构：

显而易见的答案是巧妙地使用搜索和替换来使它们继承自新的基类。它无法访问结构的成员，但您可以将指向它们的指针全部存储在容器中

```
struct base {
    int dostuff() const {std::cout << "thing";}
};
struct thing1 : public base {
    int size;
};
//otherstructs inheriting from base
int main() {
    std::vector<std::unique_ptr<base>> objects;
    objects.push_back(std::unique_ptr<base>(new thing1()));
    objects[1].dostuff();
} 
```

如果制作基类太难了，您可以尝试通过*包装*类添加函数。您将无法将指向它们的指针存储在容器中，但它们可以访问成员，只要结构具有相似的成员。

```
struct thing1 {
    int size;
};
//other unchanged structs
template<class mystruct>
struct wrapper : mystruct {
    int getsize() {return mystruct.size;}
};

int main() {
     wrapper<thing1> mything1;
     std::cout << mything1.size << mything1.getsize();
} 
```

或者，如果您只是添加方法，请将它们设为单独的函数：

```
struct thing1 {
    int size;
};
//other unchanged structs
template<class T>
int getsize(const T& obj) {return obj.size;}

int main() {
     thing1 mything1;
     std::cout << mything1.size << getsize(mything1);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T16:12:30.713

C/C++ 中没有反射，C++ 中没有其他类的基类，所以这不是一件容易的事。您可以按照您的建议手动使您从超类继承的每个类，或者您可以创建一个基类，然后为每个数据结构创建一个新结构，该结构继承它的具体数据结构和基类。例如[http://liveworkspace.org/code/7e06e0374ef41bc4aeeafd55ae143527](http://liveworkspace.org/code/7e06e0374ef41bc4aeeafd55ae143527)或[http://liveworkspace.org/code/7e06e0374ef41bc4aeeafd55ae143527](http://liveworkspace.org/code/7e06e0374ef41bc4aeeafd55ae143527)。
我认为手动使每个结构从 C 头文件中的基类继承更有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-09T16:19:57.547

我从来没有听说过使用继承的结构——这可能是某处的标准做法，但所有继承的例子都是使用类——将结构更改为类会造成困难吗？这可能会让人感到困惑，因为当我看到一个结构时，我倾向于认为是“C”。

您还确定通过继承，您仍然需要 100 个结构或类吗？如果他们真的没有重复数据，那没关系，但如果有重复的字段，最好让它们相互继承以删除重复的字段。

# sql-server - 安排存储过程定期运行？

> ID：11398936
> 
> 赞同：1
> 
> 时间：2012-07-09T16:06:07.583
> 
> 标签：sql-server, performance, stored-procedures, scheduled-tasks

我需要使用存储过程定期运行任务来更新表。您能否告诉我是否可以安排定期任务并在存储过程中运行任何系统命令？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T16:08:47.770

您可以使用[SQL Server 代理](http://msdn.microsoft.com/en-us/library/ms189237.aspx)创建定期运行的作业。作业步骤类型之一是执行存储过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:49:51.197

我为我的日程安排使用了第 3 方工具。老实说，它并不比 Sql Server Agent 好很多，但它的好处很少。它被称为 [系统调度程序](http://www.splinterware.com/products/wincron.htm "系统调度程序")。

# nsis - 可以隐藏 NSIS 安装进度页面中的所有详细信息吗？

> ID：11398938
> 
> 赞同：5
> 
> 时间：2012-07-09T16:06:12.787
> 
> 标签：nsis

使用[Nullsoft Scriptable Install System (NSIS)](http://nsis.sourceforge.net/Main_Page)，我正在寻找一种在使用[Modern UI 2](http://nsis.sourceforge.net/Docs/Modern%20UI%202/Readme.html)`MUI_PAGE_INSTFILES`进行设置时隐藏页面细节的方法。

目前我所拥有的一个例子是：

![在此处输入图像描述](../Images/17b5a7a3d090d9b8f2155deb690bc0ee.png)

这将是我想要实现的目标：

![在此处输入图像描述](../Images/89d2805d27aaf5fb255d5d1478fc8fef.png)

*（仅限德语​​，抱歉）*

如您所见，没有关于正在复制的单个文件的信息，也无法显示详细信息。

我搜索了 Modern UI 2 的文档，但没有发现可以调用来隐藏这两个控件（标签和按钮）的函数。

**我的问题是：**

有没有办法隐藏在安装过程中显示的文件标签和详细信息按钮？

* * *

**解决了**

[在 Anders 的帮助下](https://stackoverflow.com/a/11402072/107625)，我设法做我想做的事：

首先，我把

```
ShowInstDetails nevershow
ShowUninstDetails nevershow 
```

在我的 NSI 文件的顶部。接下来，我把

```
SetDetailsPrint none 
```

在本节开头的里面`Section "All files"`，我把

```
SetDetailsPrint none 
```

在本节的开头里面`Section "Uninstall"`。

我的安装程序和卸载程序现在都在运行，但不显示详细信息。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-09T19:48:37.240

[`ShowInstDetails nevershow`](https://nsis.sourceforge.io/Reference/ShowInstDetails)+`SetDetailsPrint none`

```
ShowInstDetails nevershow

Section
SetDetailsPrint none
SectionEnd 
```

# google-maps - 某些服务器已阻止 Google Maps API

> ID：11398941
> 
> 赞同：0
> 
> 时间：2012-07-09T16:06:18.573
> 
> 标签：google-maps, static, blocking

Google Maps API 静态地图阻止了我网站的地图。该站点位于负载平衡器上，因此该地图仅在其中一台服务器上被阻止，并且似乎仅在查看通过电子邮件发送的地图时才被阻止。用户看到一个红色的 X 和一个代表过度使用的 thottle 图像。

如果我在同一设备上使用同一地图的 Javascript V3 版本在浏览器中查看地图，那很好。或者，如果我最终在另一台服务器（负载平衡器）上，那很好。它只是一个特定的服务器，查看电子邮件中带有地图的电子邮件。

[http://maps.google.com/maps/api/staticmap](http://maps.google.com/maps/api/staticmap)？（示例 - 在代码之外不起作用）

我的问题是尝试了解正在发生的事情。查看带有静态地图的电子邮件时，下载地图的是最终用户（电子邮件的接收者）。他们中的任何一个都不可能在一天内达到 2,500 次观看限制。所有电子邮件都来自一台服务器，但在查看时我认为这不是一个因素，因为只有当我在特定的 Web 服务器上时才会遇到问题。

谁能解释发生了什么？

顺便说一句，我已联系 Google Business Premier 小组，但尚未收到回复。在弄清楚他们是否要向我收费以及是否要向我收费时，我需要一种解决方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:20:48.390

我会确保您没有将图像本身嵌入到电子邮件中，而是包含一个直接从 Google 加载地图的标签。如果您的电子邮件爆破程序正在下载图像并将其嵌入到电子邮件中，您可以根据您发送的图像和电子邮件的数量轻松超过该限制。

查看电子邮件的 HTML 源代码并确保您直接从 Google 加载地图是值得的。如果是，那么您遇到的任何超额问题都可能仅限于您当前的 IP 地址。检查来自不同 IP 的电子邮件（模拟您的最终用户之一）应该是一个更好的测试。

# string - 在 Asp Mvc 中连接字符串

> ID：11398942
> 
> 赞同：0
> 
> 时间：2012-07-09T16:06:18.603
> 
> 标签：string, concatenation

我正在使用ajax jquery返回一个字符串，我有一个纠缠，它是我想要连接的连接字符串：

```
string str = "";
str += "<td>"+"<%= Html.ActionLink('Edit', 'ProcessUpdate/' + s.ProductId, 'Stationery')%>"+" </td>"; 
```

但是当我运行应用程序时，这是结果：

我想运行程序得到以下结果

编辑

谢谢大家！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T18:17:47.870

看起来你的问题是你传递给的参数`Html.ActionLink()`。您的问题已在 [此处](https://stackoverflow.com/questions/200476/html-actionlink-method)得到解答。第二个参数中的“/”字符无效，因为此参数是 MVC2+ 中的操作名称或 MVC1 中的控制器名称。

假设`Stationery`是控制器并且`ProcessUpdate`是控制器上的操作，您的代码应如下所示：

```
Html.ActionLink("Edit", "ProcessUpdate", "Stationery" new { Id = s.ProductId }, new { } ) 
```

这是动作的签名

```
public ActionResult ProcessUpdate(string id)
{
    // Do something
} 
```

请注意，最后一个参数用于 Html 属性，并且是此重载`Html.ActionLink()`正常工作所必需的。

# google-chrome - 所有不应该显示斜体文本的浏览器

> ID：11398943
> 
> 赞同：6
> 
> 时间：2012-07-09T16:06:18.653
> 
> 标签：google-chrome, text, safari, osx-lion, italics

我的浏览器（Safari、Chrome 和 FF）出现问题，在不应该用斜体显示文本时以斜体显示文本。这发生在多个网站上，包括 Google 网站（Google、YouTube）以及我建立的网站和其他网站（godaddy email、ford.com，甚至 stackoverflow）。但令人惊讶的是，我的时间跟踪器网站 (freeagent.com) 并没有发生这种情况。

我不知道是怎么回事。我最近没有安装任何新软件，也没有安装任何新字体。我正在运行 Mac OS X 狮子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T14:37:49.563

我一直遇到这个问题...在所有浏览器、网站、推特甚至电子邮件中都使用粗体和斜体...我所做的解决方法是确保 Arial 在我的手提箱中永久打开...它应该无论如何，我猜它一直是系统字体，但谁在乎，因为它修复了它！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-05T22:18:42.373

我遇到了同样的问题，我的 GoDaddy 电子邮件中的所有电子邮件标题都是粗体，在多个浏览器上且仅在一台计算机上。这一切都是在安装 Suitcase Fusion 并将字体库复制到该特定计算机之后发生的。我按照 Lisa 的建议永久打开了另一个版本的 Arial（TrueType，3.05 版），它成功了：所有电子邮件标题都恢复正常（如果未读，则为粗体，如果已读，则为常规）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-17T17:55:52.873

在 chrome 中要解决这个问题，您必须执行以下操作：

*   粘贴地址栏以下内容并回车：`chrome://flags#disable-direct-write`
*   在*禁用 DirectWrite Windows*下单击“启用”（这实际上将禁用 DirectWrite（背景变为白色）
*   屏幕底部会出现一个标有“立即重新启动”的按钮。单击该按钮，将使用新设置重新启动 Chrome，此后文本应正常显示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T16:46:17.350

检查您的 Safari 首选项 (Command-,)，然后导航到外观选项卡，仔细检查并确保标准字体是非斜体字体。我的是 Times 16。希望这会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-20T21:56:06.050

如果您在其他浏览器上也有同样的问题，可能是因为您在 windows 中的字体存在一些错误。尝试在字体文件夹 (c:/windows/fonts) 中重新安装默认的 windows 字体。您可以从另一台电脑复制默认字体或从此处下载：http: [//www.withsteps.com/404/how-i-restored-my-windows-7-default-fonts.html](http://www.withsteps.com/404/how-i-restored-my-windows-7-default-fonts.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-11T14:39:07.890

最近在我的 Windows 7 机器上遇到了这个问题，同时运行 Google Chrome 版本 52.0.2743.116 m。这里提到的其他修复都没有对我有用。

原来安装的应用程序重新注册了一些基本字体，这导致 Chrome 无法找到字体。就我而言，是 NewspaperDirect 的 PressReader（我不记得曾经安装过）修改了注册表，因此一些基本字体指向存储在 PressReaders 程序文件夹中的 .ttf 文件。

## 使固定

1.  运行 regedit.exe（具有管理员权限）
2.  导航到注册表项“HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts”。
3.  滚动字体列表，找到与“C:\Program Files (x86)\NewpaperDirect\PressReader\publisher\Styles\Fonts[ *font name* ].ttf”类似的任何字体
4.  右键单击值名称并选择**修改**...。
5.  删除目录路径，只剩下文件名“[*字体名称*].ttf”。
6.  对所有错误的注册表值重复 4 和 5。
7.  重新启动 Chrome。

[![NewspaperDirect 注册表字体错误](../Images/87d0faf4cf58ba43efd6d447477e7058.png)](https://i.stack.imgur.com/UVaVO.png)
^(*修复前的注册表值*)

[![修改注册表值](../Images/1ce2d5823c96de8c898bb90f6185fb85.png)](https://i.stack.imgur.com/FWrTo.png)
^(*错误的注册表值*)

[![修改注册表值](../Images/59aa8e1022f5f2d28a6b67d6edd729ae.png)](https://i.stack.imgur.com/e1N36.png)
^(*良好的注册表值*)

[![固定注册表值](../Images/c69d249e8b677f567b9f9f61109bfbd4.png)](https://i.stack.imgur.com/w240l.png)
^(*固定注册表值*)

# php - 用于 HTML 的 PHP 缓存

> ID：11398946
> 
> 赞同：0
> 
> 时间：2012-07-09T16:06:35.437
> 
> 标签：php, caching, memcached

我将有一个从数据库结果生成的条形图 html。因为这些图表需要每 5 秒刷新一次，并且可以有 5000 个用户查看此图表。我需要缓存该条形图，这样每次用户尝试查看时我都不必重新创建它。我将每隔一分钟从数据库中重新创建该图表。我正在使用 PHP 。我应该为此目的使用 memcache 吗？还有其他可能的选择吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:12:02.000

Memcache 是最常用的，并且拥有所有其他流行解决方案的最佳文档。

我会继续使用它。它也相当直观，因此启动和运行应该不需要那么长时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T17:02:52.880

类似于@Roman 的建议，应该有单独的过程：

一个生成图表，并将图像保存在memcache中（可以使用crontab）

另一个是通过 webserver 的普通 php 脚本，它只读取 memcache 并打印出来

# php - DOMNodeList 返回 DOMNode 还是 DOMElement？

> ID：11398948
> 
> 赞同：0
> 
> 时间：2012-07-09T16:06:39.010
> 
> 标签：php, dom, domxpath

我在这里遗漏了一些东西......

我有这个命令：

> $xpath->query('//input')->item(0)

php.net 文档说 DOMNodeList:item 应该返回一个 DOMNode [http://www.php.net/manual/en/domnodelist.item.php](http://www.php.net/manual/en/domnodelist.item.php)，但是如果我 var_dump 上面的结果它说它返回一个 DOMElement！

是 php.net 错了还是我错了？

PS：我非常喜欢它返回一个 DOMElement ，看起来更符合逻辑！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:15:23.307

正如 Esailija 在他的评论中所说的`DOMElement`那样`DOMNode`，它确实返回了一个`DOMNode`或者更确切地说是一个共享该接口的对象。也就是说，您不能依赖它是 a`DOMElement`所以如果您使用`DOMElement`特定功能，您需要测试它是 a`DOMElement`而不是其他形式的`DOMNode`.

# javascript - 按钮没有被突出显示

> ID：11398952
> 
> 赞同：1
> 
> 时间：2012-07-09T16:06:52.013
> 
> 标签：javascript, jquery

我有一个 php 代码，它显示来自 AZ 的按钮：

```
 <table id="optionAndAnswer" class="optionAndAnswer">
    <tr class="answer">
    <td>3\. Answer</td>
    <td>
        <?php
            $a = range("A","Z");
        ?>

        <table id="answerSection">
            <tr>

        <?php
            $i = 1;
            foreach($a as $key => $val){
                if($i%7 == 1) echo"<tr><td>";
                echo"<input type=\"button\" onclick=\"btnclick(this);\" value=\"$val\" id=\"answer".$val."\" name=\"answer".$val."Name\" class=\"answerBtns answers answerBtnsOff\">";      
                if($i%7 == 0) echo"</td></tr>";
                $i++;
            }
        ?>

... 
```

我要做的是在 jquery 中为上述代码创建一个模板，这样如果用户想要将这些按钮添加到一个块中，那么 jquery 可以用于将这些按钮添加到一个块中，就像模板一样。

下面是jquery代码：

```
var $this, i=0, $row, $cell;
$('#optionAndAnswer .answers').each(function() {
    $this = $(this);
    if(i%7 == 0) {
        $row = $("<tr/>").appendTo($answer);
        $cell = $("<td/>").appendTo($row);
    }
    var $newBtn = $("<input class='answerBtnsRow answers' type='button' style='display:%s;' onclick='btnclick(this);' />".replace('%s',$this.is(':visible')?'inline-block':'none')).attr('name', $this.attr('name')).attr('value', $this.val()).attr('class', $this.attr('class')).attr('id', $this.attr('id')+'Row');

    $newBtn.appendTo($cell);

    i++;
}); 
```

现在这工作正常，但我有一个问题。我希望用户能够`"answerBtnsOn"`根据字母的内容突出显示和取消突出显示“answerBtnsOff”按钮。

例如，如果字母是“B”，则突出显示按钮 B 并取消突出显示其他按钮。如果有多个字母，例如 AC，则突出显示按钮 A 和 C，并取消突出显示所有其他按钮。

我遇到的问题是它突出显示了应该突出显示的按钮，但它并没有取消突出显示其他按钮。因此，如果按钮 B 被突出显示，但现在字母是 A 和 C，它应该只突出显示按钮 A 和 C，而所有其他按钮都应该不突出显示，但这不会发生，因为按钮 B 仍然与 A 和 C 一起突出显示。

所以我的问题是，在下面的代码中，为什么不取消突出显示按钮？

```
var answersrow = $.map(btn.split(''),function(chr){   return "#answer"+chr+"Row";  }).join(', ');

$('.answerBtnsRow').removeClass('answerBtnsOff').removeClass('answerBtnsOn');
$(answersrow).addClass("answerBtnsOn").siblings().addClass('answerBtnsOff'); 
```

更新：

我在这个[应用程序](http://helios.hud.ac.uk/u0867587/Mobile_app/Text14.php)中创建了一个演示。请打开网址并按照以下步骤操作，以便能够使用演示

*   第 1 步：当您打开应用程序时，立即单击“添加问题”按钮，这将在下方添加一个表格行，显示与上述相同的控件。
*   步骤2：在刚刚添加的行中，点击“Open Grid”链接并选择按钮“7”，这将从下面的“AG”中输出7个按钮。
*   第 3 步：现在在左侧的行中，您将看到一个绿色的加号按钮，单击此按钮，将出现一个模式窗口。
*   第 4 步：在模式窗口的搜索栏中，您将看到一个搜索栏，输入“AAA”并提交。
*   第 5 步：您将看到一堆结果供您搜索。在第一行中，您将看到一个“Answer”列，该列在该第一行中的该列下显示“B”。单击“添加”按钮以添加该行。
*   第 6 步：您现在将看到在您的行中，按钮“B”被突出显示。

目前这很好，但现在出现了问题：

*   第 7 步：再次单击该行中的绿色加号按钮并执行相同的搜索。
*   第 8 步：这次添加“Answer”为“A C”的第二行。现在您可以看到按钮 A 和 C 突出显示，但按钮 B 仍然突出显示，它应该被关闭。

所以这就是我的问题，在这个例子中，为什么按钮“B”没有关闭，因为它现在不是答案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:53:01.260

首先，`$('.answerBtnsRow')`据我所知，不存在。所以这就是为什么这不起作用。此外，假设该选择器确实存在，那么 a）它将对所有行执行此操作，而不仅仅是特定的给定行，并且 b）您应该执行以下操作之一：

```
//to remove all of either answerBtnsOff, answerBtnsOn -- probably not what you want
$('.answerBtnsOff, .answerBtnsOn').removeClass('answerBtnsOff answerBtnsOn');

//to remove the ones from _this answer row_ which appears what you want
$(answersrow + ' .answerBtnsOn').removeClass('answerBtnsOn'); 
```

所以总结一下，你应该替换：

```
var answersrow = $.map(btn.split(''),function(chr){   return "#answer"+chr+"Row";  }).join(', ');

$('.answerBtnsRow').removeClass('answerBtnsOff').removeClass('answerBtnsOn');
$(answersrow).addClass("answerBtnsOn").siblings().addClass('answerBtnsOff'); 
```

和：

```
var answersrow = $.map(btn.split(''),function(chr){   return "#answer"+chr+"Row";  }).join(', ');

$(answersrow + ' .answerBtnsOn').removeClass('answerBtnsOn');
$(answersrow).addClass("answerBtnsOn").siblings().addClass('answerBtnsOff'); 
```

# android - 为什么当我将其设为空时位置管理器仍处于打开状态？

> ID：11398955
> 
> 赞同：0
> 
> 时间：2012-07-09T16:07:02.437
> 
> 标签：android, locationmanager, locationlistener

在我的应用程序中，我将两个位置管理器用于两个不同的活动。第一个位置管理器是在创建第一个活动时创建的。然后从第一个活动开始，我创建了第二个活动，该活动正在创建第二个位置管理器。在第二个活动中，我试图在按下后退按钮时使用以下代码停止位置管理器更新：

```
@Override
public void onBackPressed() {
  lm.removeUpdates(ll);
  ll = null;
  lm = null;
  finish();
} 
```

ll 和 lm 在第一个和第二个活动中分别全局声明。ll 和 lm 在第二个活动的 onCreate 中使用以下代码进行初始化：

```
 lm = (LocationManager)getSystemService(Context.LOCATION_SERVICE);
 ll = new myLocationListener();
 lm.requestLocationUpdates(LocationManager.GPS_PROVIDER, 1000, 0, ll); 
```

问题是，如果我不去第二个活动并停止第一个活动的位置更新，那么我的 Android 中的 GPS 标志就会消失。但是如果我去第二个活动，使用返回按钮回到第一个活动，然后停止第一个活动的位置更新，那么 GPS 位置标志仍然存在。我正在使用同一行代码停止第一个活动的更新：

```
lm.removeUpdates(ll);
ll = null;
lm = null; 
```

当按下开始按钮时，第一个活动中的 ll 和 lm 被初始化：

```
 public void startClick (View target){
      lm = (LocationManager)getSystemService(Context.LOCATION_SERVICE);
      ll = new myLocationListener();
      lm.requestLocationUpdates(LocationManager.GPS_PROVIDER, 1000, 0, ll);
 } 
```

代码中是否存在任何类型的错误或是否存在任何逻辑错误？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:33:35.003

您可以拥有 的单个实例`LocationManager`并将其存储在您的`Application Context`. 为此，您需要创建一个扩展类`Application`。这是一个例子：

```
public class MyApplication extends Application 
{
   private LocationManager locationManager;

   @Override
   public void onCreate()
   {
     super.onCreate();

     //Initialize here the locationManager or initialize it in one of your
     //Activities. It is your choice.
   }

   //To retrieve the locationManager
   public LocationManager getLocationManger()
   {
      return locationManager;
   }

   //In case you want to initialize the locationManger in one of your Activities
   public void setLocationManager(LocationManager locationMangerIn) 
   {
       locationManager = locationMangerIn;
   }
} 
```

不要忘记在文件`MyApplication`的`android:name`属性中添加对的引用`AndroidManifest.xml`。像这样的东西：

```
<application android:icon="@drawable/icon" android:label="@string/app_name"
        android:name="com.your_package_name.MyApplication"> 
```

要访问您的 locationManager 实例，您可以调用以下代码：

```
LocationManger lm = ((MyApplication)activitysContext.getApplication()).getLocationManger(); 
```

要在 Activity 中实例化 locationManager 实例，请使用以下命令：

```
public void startClick (View target){
  LocationManager lm = (LocationManager)getSystemService(Context.LOCATION_SERVICE);

  //You can add the listener now or later. Again, your choice.
  ll = new myLocationListener();
  lm.requestLocationUpdates(LocationManager.GPS_PROVIDER, 1000, 0, ll);

  ((MyApplication)activitysContext.getApplication()).setLocationManger(lm); 
```

}

希望有帮助:)

# python - 无法为 MySQL 加载 Python 绑定 - Trac

> ID：11398957
> 
> 赞同：4
> 
> 时间：2012-07-09T16:07:03.597
> 
> 标签：python, mysql, trac

我最近开始在我的 trac 安装中收到以下错误：

无法为 MySQL 加载 Python 绑定

不幸的是，我不得不重新安装 MySQL，然后，我开始遇到这些问题。我花了最后一个小时试图在谷歌上追踪一些东西，但我什么也做不了。我确保 MySQL 已启动并正常运行。我创建了一个特定于 trac 的新 MySQL 用户。我确保所有的包裹都在那里。没有什么。

这是我的 dkpg（我运行 Ubuntu Maverick）：

# dpkg -l | grep 蟒蛇

*   libapache2-mod-python
*   libapache2-mod-python-doc
*   libpython2.6
*   libpython3.1
*   Python
*   蟒蛇中央
*   python-docutils
*   蟒蛇源氏
*   蟒蛇成像
*   蟒蛇lxml
*   蟒蛇最小
*   python-mysqldb
*   python-pkg-资源
*   python-pybabel
*   python-pygments
*   蟒蛇罗马
*   蟒蛇安装工具
*   蟒蛇颠覆
*   蟒蛇支持
*   蟒蛇-tz
*   python2.6
*   python2.6-minimal
*   python3.1
*   python3.1-最小

如果有人对它可能是什么有任何想法，我将永远感激不尽。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:46:37.147

当 Trac 尝试执行“ `import MySQLdb`”但它失败时，应该会导致该错误。您确实拥有应该提供该模块的正确软件包，但由于某种原因它失败了。要找出原因，您应该查看 Trac 运行的环境。它是否使用 Python 以外的其他 Python `/usr/bin/python2.6`？它`$PYTHONPATH`有一套吗？

您可能还想尝试直接导入 MySQLdb：

```
/usr/bin/python2.6 -c 'import MySQLdb' 
```

如果可以按预期加载包，那应该没有输出。

最后，这可能不相关，但您知道不再支持 Maverick，对吧？它不会从 Ubuntu 获得任何安全更新或其他支持。

**编辑：**

python2.6 导入工作正常，所以我们需要仔细查看 trac 环境。一种方法是编辑`db/mysql_backend.py`文件并插入一些调试信息。（如果这是一个 OS 打包安装，您应该在 下找到该文件`/usr/lib/python2.6/dist-packages/trac/`；否则，您可能知道将它放在哪里）。让我们尝试改变`MySQLConnector.get_supported_schemes()`方法，因为我不确定 plain `print`s 会出现在哪里。

```
def get_supported_schemes(self):
    if not has_mysqldb:
        import sys
        self.error = "Cannot load Python bindings for MySQL. sys.path = %r, sys.executable = %r" \
                     % (sys.path, sys.executable)
    yield ('mysql', -1 if self.error else 1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:53:00.233

而不是像保罗建议的那样调用特定的python安装，在你的终端上试试这个：

启动路径的 python 实例

```
python 
```

看看能不能导入mysqldb

```
import MySQLdb 
```

还为我们运行：

```
pip freeze 
```

我们应该`mysql-python`在输出中看到 a

# javascript - 什么可能导致相同的 .json 通话后出现 406？

> ID：11398958
> 
> 赞同：1
> 
> 时间：2012-07-09T16:07:05.197
> 
> 标签：javascript, jquery, drag-and-drop, http-status-code-406

我正在使用一个使用拖放功能的重型基于 javascript 的应用程序。

它运作良好。但是，如果我向页面添加一个动态对象（它具有与其他对象*完全相同的*属性和变量），它会拖动，但在放置时，POST 返回 406。

我完全不确定这里会发生什么，因为我重新实例化了在进行此调用之前可能需要的任何环境侦听器。我已经分解了对这个的调用：

`.cranbar`一个工作的预先存在的对象在哪里。我用一个动态添加的相同切换它`.foobar`，它返回一个 406。

```
attrs = { _method:"put"};
box = $(".cranbar");
$.post(box.attr('data-update_path'), attrs, function(data) {
}); 
```

这个片段来自`make_droppable`在对象实例化之后和我尝试拖放它之前加载的方法。

```
make_droppable: function(){
  $('table#week .day').droppable({
    accept: '.job, .task',
    hoverClass: 'droppable-hover',
    drop: function(e, ui) {
      if (confirmOnDrop){
        if (!confirm('Are you sure?')) {
          if ($('table#week').length > 0) {
            draw_weekly_calendar();
          }
          return false;
        }
      }

      var box = $(ui.draggable);
      // var old_container = box.parents('td:first');
      var new_cell = $(this);
      var new_container = $(this).find('.rel_box');

      // add indicator
      box.addClass('indicator');

      // add box to new container
      box.attr('style', 'position: absolute;').appendTo(new_container);

      var attrs = null;

      if (box.attr('data-object-type') == 'job') {
        // update job already on screen
        attrs = {
          'job[scheduled_on]': new_cell.attr('data-scheduled_on'),
          '_method': 'put'
        }
      }
      else if  (box.attr('data-object-type') == 'task') {
        attrs = {
          'task[scheduled_at]': new_cell.attr('data-scheduled_on'),
          '_method': 'put'
        }
      }

      if (attrs) {
        $.v = attrs;
        $.post(box.attr('data-update_path'), attrs, function(data) {
          box.removeClass('indicator');
          box.attr('data-scheduled_at', new_cell.attr('data-scheduled_on'));
          draw_weekly_calendar();
        });
      }

      // nice effect
      box.effect('shake', { times: 1, distance: 2 }, 50);
    }
  });      
}, 
```

有谁知道我可以做些什么来找到这个406的来源？

**更新**

这可能与它有很大关系。但我现在正在比较标题。

失败的帖子：

```
Response Headers
Cache-Control   no-cache
Connection  Keep-Alive
Content-Length  1
Content-Type    text/html; charset=utf-8
Date    Mon, 09 Jul 2012 16:11:27 GMT
Server  WEBrick/1.3.1 (Ruby/1.9.2/2011-02-18)

Request Headers
Accept  text/javascript
Accept-Encoding gzip, deflate
Accept-Language en-us,en;q=0.8,es-es;q=0.5,es;q=0.3
Connection  keep-alive
Content-Length  57
Content-Type    application/x-www-form-urlencoded; charset=UTF-8 
```

成功发帖：

```
Response Headers
Cache-Control   max-age=0, private, must-revalidate
Connection  Keep-Alive
Content-Length  2024
Content-Type    application/json; charset=utf-8
Date    Mon, 09 Jul 2012 16:11:35 GMT
Etag    "93432c11e3cc55dfec8e0aee7c08bcc1"
Server  WEBrick/1.3.1 (Ruby/1.9.2/2011-02-18)

Request Headers
Accept  text/javascript
Accept-Encoding gzip, deflate
Accept-Language en-us,en;q=0.8,es-es;q=0.5,es;q=0.3
Connection  keep-alive
Content-Length  57
Content-Type    application/x-www-form-urlencoded; charset=UTF-8 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:34:09.937

在我看来，问题在于`Content-Type`resposne 标头。它正在使用`text/html`，但期望`application/json`. 这会导致 406 错误，因为虽然数据已成功查询，但它不是有效的响应 -> 406。老实说，我不知道您是否可以更改`contentType`$.post 参数中的 ，但您可以使用`.ajax()`.

```
$.ajax({ 
  type: 'POST', 
  url: box.attr('data-update_path'), 
  contentType: 'application/json; charset=utf-8', 
  data: attrs,
  success: function(data){ 
    box.removeClass('indicator');
    box.attr('data-scheduled_at', new_cell.attr('data-scheduled_on'));
    draw_weekly_calendar();
  }
}); 
```

希望这可以解决您的问题。

# c++ - 模板编程：专业化和 enable_if

> ID：11398966
> 
> 赞同：2
> 
> 时间：2012-07-09T16:07:23.620
> 
> 标签：c++, gcc, c++11, libffi

我正在使用 libffi，并且我创建了一个具有类似模板的类`std::function`（即`class Func<Ret (Args...)> { /* ... */};`。我想将返回类型（`Ret`）和每个参数类型（`Args`）转换为它们相应的 libffi 类型（请参阅[此](http://www.atmark-techno.com/%7Eyashi/libffi.html#Primitive-Types)以供参考）。到目前为止我想出了这个：

```
// Member function of 'Func' class
Prepare(void)
{
 // This vector holds all the type structures
 std::vector<ffi_type*> argumentTypes{ GetFFIType<Args>()... };
 ffi_type * returnType = GetFFIType<Ret>();

 // Rest of the code below
 // ....
} 
```

其中 GetFFIType 函数实现如下：

```
template <typename T>
ffi_type * GetFFIType(void)
{
    // We will check for any kind of pointer types
    if(std::is_pointer<T>::value || std::is_array<T>::value ||
       std::is_reference<T>::value || std::is_function<T>::value)
        return &ffi_type_pointer;

    if(std::is_enum<T>::value)
        //return GetFFIType<std::underlying_type<T>::type>();
    {
        // Since the size of the enum may vary, we will identify the size
        if(sizeof(T) == ffi_type_schar.size)    return std::is_unsigned<T>::value ? &ffi_type_uchar : &ffi_type_schar;
        if(sizeof(T) == ffi_type_sshort.size)   return std::is_unsigned<T>::value ? &ffi_type_ushort : &ffi_type_sshort;
        if(sizeof(T) == ffi_type_sint.size) return std::is_unsigned<T>::value ? &ffi_type_uint : &ffi_type_sint;
        if(sizeof(T) == ffi_type_slong.size)    return std::is_unsigned<T>::value ? &ffi_type_ulong : &ffi_type_slong;
    }

    assert(false && "cannot identify type");
}

// These are all of our specializations
template <> ffi_type * GetFFIType<void>(void)       { return &ffi_type_void; }
template <> ffi_type * GetFFIType<byte>(void)       { return &ffi_type_uchar; }
template <> ffi_type * GetFFIType<char>(void)       { return &ffi_type_schar; }
template <> ffi_type * GetFFIType<ushort>(void)     { return &ffi_type_ushort; }
template <> ffi_type * GetFFIType<short>(void)      { return &ffi_type_sshort; }
template <> ffi_type * GetFFIType<uint>(void)       { return &ffi_type_uint; }
template <> ffi_type * GetFFIType<int>(void)        { return &ffi_type_sint; }
template <> ffi_type * GetFFIType<ulong>(void)      { return &ffi_type_ulong; }
template <> ffi_type * GetFFIType<long>(void)       { return &ffi_type_slong; }
template <> ffi_type * GetFFIType<float>(void)      { return &ffi_type_float; }
template <> ffi_type * GetFFIType<double>(void)     { return &ffi_type_double; }
template <> ffi_type * GetFFIType<long double>(void)    { return &ffi_type_longdouble; } 
```

这行得通，但显然还有一些改进的余地。如果类型无效（即类或结构），则不会在编译时识别（使用 代替会发生运行时错误`assert`）。我将如何避免这种情况，并使此函数在编译期间确定类型是否有效（原始类型）？

我也不喜欢在`enum`s 的情况下识别基础类型的方式。我更喜欢`std::underlying_type<T>`改用（在代码中注释掉），但如果类型是 void 指针（`type_traits:1762:38: error: ‘void*’ is not an enumeration type`） ，它会发出编译错误

我试图使用`std::enable_if`但没有成功来实现这种行为......请告诉我是否应该解释一些事情，以防听起来有点模糊！

摘要：我想获取 GetFFIType 函数来确定编译期间的所有内容，并且该函数应仅支持原始类型（请参阅[this](http://www.atmark-techno.com/%7Eyashi/libffi.html#Primitive-Types)以获得更广泛的参考）

编辑：对不起标题，没有比这更好的了:(

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T16:28:27.880

重载函数模板比​​专门化它们更容易而且通常更好。我将添加一个带有指针参数的函数版本，以便可以在没有模板参数列表的情况下调用它：

```
inline ffi_type * GetFFITypeHelper( void* ) { return &ffi_type_void; }
inline ffi_type * GetFFITypeHelper( byte* ) { return &ffi_type_uchar; }
// ... 
```

然后，您可以将`enable_if`其用于您想要涵盖的更普遍的情况。

```
template<typename T> auto GetFFITypeHelper( T* ) ->
    std::enable_if< std::is_function<T>::value, ffi_type* >::type
{ return &ffi_type_pointer; }
template<typename T> auto GetFFITypeHelper( T* ) ->
    std::enable_if< std::is_enum<T>::value, ffi_type* >::type
{ return GetFFITypeHelper( static_cast<std::underlying_type<T>::type*>(nullptr) ); } 
```

在声明所有这些重载之后，您想要的版本是：

```
template<typename T> ffi_type * GetFFIType()
{ return GetFFITypeHelper( static_cast<T*>(nullptr) ); } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T17:25:43.497

将逻辑放在类模板而不是函数模板中将允许部分特化，我们也可以利用 SFINAE 技巧：

```
// Second parameter is an implementation detail
template<typename T, typename Sfinae = std::true_type>
struct ToFFIType;

// Front-end
template<typename T>
ffi_type* GetFFIType()
{ return ToFFIType<T>::make(); }

// Primary template where we end up if we don't know what to do with the type
template<typename T, typename = std::true_type>
struct ToFFIType {
    static_assert( dependent_false_type<T>::value,
                   "Write your clever error message to explain why we ended up here" );

    static ffi_type* make() = delete;
};

// Trait-like to match what we want with ffi_type_pointer
template<typename T>
struct treat_as_pointer: or_<
    std::is_pointer<T>
    , std::is_array<T>
    , std::is_reference<T>
    , std::is_function<T>
> {};

template<typename T>
struct ToFFIType<T, typename treat_as_pointer<T>::type> {
    static ffi_type* make()
    { return &fii_type_pointer; }
};

// Matches enumeration types
template<typename T>
struct ToFFIType<T, typename std::is_enum<T>::type> {
    static ffi_type* make()
    {
        return ToFFIType<typename std::underlying_type<T>::type>::make();
    }
}; 
```

总的专业很容易写，所以我不会展示它们。尽管请注意，您可以选择匹配 eg`std::is_integral`并根据`sizeof(T)`需要打开，类似于您为解决`std::underlying_type`.

最后，这里是上面代码中假设的两个实用程序的两个建议实现；显然，只要您以同样的方式编写其他内容，您就不需要逐字使用它们。

```
// Same functionality as std::false_type but useful
// for static_assert in templates
template<typename Dummy>
struct dependent_false_type: std::false_type {};

// Disjunction of boolean TMP integral constants
// Take care to inherit from std::true_type/std::false_type so
// the previous SFINAE trick works
template<typename... T>
struct or_: std::false_type {};

// There likely are better implementations
template<typename Head, typename... Tail>
struct or_<Head, Tail...>: std::conditional<
    Head::value
    , std::true_type              // short circuit to desired base
    , typename or_<Tail...>::type // or inherit from recursive base
>::type {}; // Note: std::conditional is NOT the base 
```

# c# - 如何在 Selenium 中使用 C# 处理 Firefox 的另存为对话框？

> ID：11398967
> 
> 赞同：2
> 
> 时间：2012-07-09T16:07:27.307
> 
> 标签：c#, selenium

我正在寻找从网站下载文件/报告到我的本地文件夹。我在 C# 中使用 Selenium。到目前为止，我能够单击下载按钮，打开另存为或打开选项的对话框。任何人都可以帮助我通过 Firefox 对话框将文件保存到 MyDocuments 中的文件夹吗？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T18:23:20.720

This is still an open enhancement request, so it shouldn't have ever worked for you unless you had something else handling the browser modal dialog.

[http://code.google.com/p/selenium/issues/detail?id=95](http://code.google.com/p/selenium/issues/detail?id=95)

Ken

# speech-recognition - 谷歌语音搜索延迟和时间计算

> ID：11398969
> 
> 赞同：1
> 
> 时间：2012-07-09T16:07:32.933
> 
> 标签：speech-recognition

我知道谷歌语音搜索的工作原理是将原始音频（当然是数字化的）发送到谷歌的服务器，然后谷歌以文本形式返回结果。

结果本身相对较小（除非它是一个很长的句子......），所以我相信通过 Internet 发送它所花费的时间可以忽略不计（扣除 HTTP 开销、服务器负载等）。

我有兴趣知道发送到 Google 语音服务器的实际“模拟”原始音频的大小 (KB)，以便大致了解该组件对 Internet 连接速度（上行链路）的依赖性。

当然，原始音频包的大小很大程度上取决于所说的短语（一个词？整个句子？一个很长的句子？），所以我正在寻找一些关于这个的统计信息（平均，典型等）。

我也知道那些原始音频数据包被压缩了。有关压缩方法的任何信息？（它不是 MP3，不是吗？）

Android 设备和 PC（即基于 Chrome）之间的压缩是否不同？

虽然这似乎不是一个直接的编程问题，但就我而言，它与编程非常直接相关，因为答案可能会影响在构建基于 Google 语音搜索的应用程序时要使用的算法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T19:46:14.093

我没有测量实际发送到 Google 服务器的数据量，但让我们合理假设语音搜索

*   记录单声道
*   以 16kHz 采样率记录
*   16 位分辨率的记录
*   应用无损压缩，尺寸缩小 2 倍

在这种情况下，1 秒的录制消耗`(1 * 16,000 * 2) / 2 = 16,000 bytes`.

# asp.net-mvc-3 - MVC3 - 发布到操作的空值

> ID：11398971
> 
> 赞同：2
> 
> 时间：2012-07-09T16:07:43.190
> 
> 标签：asp.net-mvc-3, asp.net-mvc-routing

我在 Windows 2008 R2 服务器 (IIS 7.5) 上运行几个经典的 ASP 网站，并添加了一个简单的 MVC3 电子商务网站。问题是当我尝试使用表单从产品页面将商品添加到购物车时。使用 Razor 语法，我有以下代码：

```
@using (Html.BeginForm("Add", "Cart", FormMethod.Post, new { }))
{
    @Html.HiddenFor(m => m.Id)
    @Html.TextBoxFor(m => m.Quantity, new { size = "1" })
    <input type="submit"  value="Add to Cart"/>
}

public class AddToCartViewModel
{
    public string Id { get; set; }
    public int Quantity { get; set; }
}

[HttpPost]
public ActionResult Add(AddToCartViewModel cartItem)
{
    // Code that adds the item to the cart

    // Go back to the product page
    return RedirectToAction("Model", "Product", new { id = cartItem.Id });
} 
```

问题是 ModelId 和 Quantity 没有填充表单中的数据。cartItem 不为 null，并且正在调用此操作。此代码在通过 Visual Studio 2010 运行时完美运行，所以我猜测它是服务器和/或 IIS 配置设置。奇怪的是，我还有另一个购物车页面，允许用户更新购物车中的商品数量，效果非常好。该页面更复杂，因为它使用视图模型中的列表，所以我看不出为什么我的简单请求会失败。

使用 ActionLink（带有硬编码数量）而不是表单有效。

```
@Html.ActionLink("Add to cart", "Add", "Cart", new { Id = Model.Id, Quantity = 1}, new {}) 
```

我尝试更改操作方法的签名以获取字符串和 int，但由于数量为空而引发异常。

抓住稻草，我运行了以下命令以确保 .NET 4.0 已注册，看起来还不错。我有 2.0.50727.0，以及 4.0.30319.0 的 x32 和 x64 版本

按照[Phil Haack 的说明](http://haacked.com/archive/2011/05/25/bin-deploying-asp-net-mvc-3.aspx)部署应用程序的 Bin也不起作用

我没有想法，因为在 Visual Studio 中一切正常，我找不到其他有同样问题的帖子。我只是缺少一些简单的东西吗？另外，我刚刚注意到通过帐户控制器登录在服务器上也不起作用。没有显示错误或验证问题。我正在使用默认的成员资格提供程序，但 web.config 配置为使用我自己的数据库。连接有效，因为我可以注册一个新用户，并且该新用户已登录成功注册。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:10:36.580

**[编辑]**

好的，现在你已经更新了你的问题，更新了答案。我认为问题很可能归结为您没有在初始获取 Add 操作的请求中初始化模型。尝试添加`HttpGet`and`HttpPost`如下：

```
[HttpGet]
public ActionResult Add()
{
    var viewModel = new AddToCartViewModel() 
    {
        Id = "myid", 
        Quantity = 0
    };
    return View(viewModel);
}

[HttpPost]
public ActionResult Add(AddToCartViewModel cartItem)
{
    // Code that adds the item to the cart

    // Go back to the product page
    return RedirectToAction("Model", "Product", new { id = cartItem.Id });
} 
```

我相信这现在可以工作了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:21:48.943

使用强类型的 html 助手

```
@Html.HiddenFor(m => m.Id)     
@Html.TextBoxFor(m => m.Quantity, new { size = "1" }) 
```

并确保您已将操作标记为`[HttpPost].`

# java - 查看是否启用并连接了 wi-fi

> ID：11398980
> 
> 赞同：1
> 
> 时间：2012-07-09T16:08:19.767
> 
> 标签：java, android

我在 SO 上的很多答案中找到了这个答案：

我正在检查用户是否启用了 wi-fi 并在他选择微调器选项（下拉菜单）时连接。

```
private static boolean isConnected(Context context, AdapterView<?> parent) {
        ConnectivityManager connectivityManager = (ConnectivityManager) context
                .getSystemService(Context.CONNECTIVITY_SERVICE);
        NetworkInfo networkInfo = null;
        if (connectivityManager != null) {
            networkInfo = connectivityManager.getNetworkInfo(ConnectivityManager.TYPE_WIFI);
        }
        return networkInfo == null ? false : networkInfo.isConnected();
    } 
```

它对我不起作用，我一定忘记了 Manifest 中的一些权限我还缺少什么？

或者我使用它更好`WifiManager`吗？有人有例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:16:09.557

`android.permission.ACCESS_WIFI_STATE`确保您正在使用清单中的权限，并且`android.permission.ACCESS_NETWORK_STATE`如果您想读取蜂窝网络状态。

# php - 带有flex对象问题的zend amf php日期时间映射

> ID：11398987
> 
> 赞同：0
> 
> 时间：2012-07-09T16:09:06.397
> 
> 标签：php, apache-flex, zend-framework, zend-amf

我们需要在 flex 中列出日期对象中的课程安排。php&mysql 是它的后端。datetime 对象使用 zend amf 从 php 发送到 flex。当我用 flex f 映射 datetime 对象时，它需要一些默认时区。（将 gmt+5.30 添加到原始日期时间对象）。例如，如果 php 值为 30-06-2012 02:00，那么在 flex 中它显示 30-06-2012 07:30。避免这种情况的解决方法是什么？

php $stDtObj = new DateTime('30-06-2012 02:00');

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T07:06:26.270

弗洛伦特的回答是正确的。您可以轻松地将 Flex 中的整数时间戳转换为更易读的日期。尝试在 Flex 中从 PHP 格式化 DateTime 会做更多的工作... =/

# java - java中简单的字符串连接操作

> ID：11398992
> 
> 赞同：5
> 
> 时间：2012-07-09T16:09:36.330
> 
> 标签：java, string

我想得到以下输出：

> 你好史蒂夫安德鲁斯！

这些是我的变量：

```
a = "steve";
b = "Andrew" 
```

我试过这个：

```
System.out.print("Hello " + a + " " + b + "s"); 
```

我不知道该放在哪里`.toUpper()`。应该是大写的`steve`。`s`我该怎么做呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-09T16:10:53.473

使用[`StringUtils.capitalize(a)`](http://commons.apache.org/lang/api-2.5/org/apache/commons/lang/StringUtils.html#capitalize%28java.lang.String%29),

```
"Hello " + StringUtils.capitalize(a) + " " + b + "s" 
```

> 根据 Character.toTitleCase(char) 将第一个字母更改为标题大小写的字符串大写。其他字母没有变化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T16:12:16.557

你可以使用[StringUtils.capitalize(str)](http://commons.apache.org/lang/api-2.5/org/apache/commons/lang/StringUtils.html#capitalize%28java.lang.String%29)，或者如果你想自己做：

```
public static String capitalize(String str) {
    int strLen;
    if (str == null || (strLen = str.length()) == 0) {
        return str;
    }
    return new StringBuffer(strLen)
        .append(Character.toTitleCase(str.charAt(0)))
        .append(str.substring(1))
        .toString();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T16:22:21.957

您也可以尝试使用此方法：

 `````
public static String capitalize(String str) {
    str = (char) (str.charAt(0) - 32) + str.substring(1);
    return str;
} 
```` 

 `尽管应该注意，此方法假定 str 中的第一个字符确实是小写字母。`

 `* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T16:56:53.160

最后，我尝试在没有 stringutils 的情况下做到这一点。但无论如何，感谢所有帮助过的人 :)

```
public class Hello
    {
      public static void main(String[] args){
        String a = "steve";
        String b = "Andrew";
        String firstletter = a.substring(0,1);
        String remainder = a.substring(1);
        String capitalized = firstletter.toUpperCase() + remainder.toLowerCase();

        System.out.print("Hello " + capitalized + " " + b + "s" );

    }
} 
`````

# objective-c - AVAssetReader 到 AudioQueueBuffer

> ID：11398997
> 
> 赞同：2
> 
> 时间：2012-07-09T16:09:58.107
> 
> 标签：objective-c, ios, core-audio, audioqueueservices, avassetreader

目前，我正在做一个小测试项目，看看是否可以从 AVAssetReader 获取样本以在 iOS 上使用 AudioQueue 进行播放。

我读过这个：（[使用 AudioQueue 播放未压缩的原始声音，没有声音](https://stackoverflow.com/questions/9451508/play-raw-uncompressed-sound-with-audioqueue-no-sound)）和这个：（[如何使用 AVAssetReader 在 iOS 上正确读取解码的 PCM 样本——目前解码不正确](https://stackoverflow.com/questions/9364227/how-to-correctly-read-decoded-pcm-samples-on-ios-using-avassetreader-currentl)），

这两者实际上确实有帮助。在阅读之前，我完全没有声音。现在，我得到了声音，但音频播放速度非常快。这是我第一次涉足音频编程，因此非常感谢任何帮助。

我因此初始化读者：

```
NSDictionary * outputSettings = [NSDictionary dictionaryWithObjectsAndKeys:
                                         [NSNumber numberWithInt:kAudioFormatLinearPCM], AVFormatIDKey,
                                         [NSNumber numberWithFloat:44100.0], AVSampleRateKey,
                                         [NSNumber numberWithInt:2], AVNumberOfChannelsKey,
                                         [NSNumber numberWithInt:16], AVLinearPCMBitDepthKey,
                                         [NSNumber numberWithBool:NO], AVLinearPCMIsNonInterleaved,
                                         [NSNumber numberWithBool:NO], AVLinearPCMIsFloatKey,
                                         [NSNumber numberWithBool:NO], AVLinearPCMIsBigEndianKey,

                                         nil];

        output = [[AVAssetReaderAudioMixOutput alloc] initWithAudioTracks:uasset.tracks audioSettings:outputSettings];
        [reader addOutput:output];
... 
```

我就这样抓取了数据：

```
CMSampleBufferRef ref= [output copyNextSampleBuffer];
    // NSLog(@"%@",ref);
    if(ref==NULL)
        return;
    //copy data to file
    //read next one
    AudioBufferList audioBufferList;
    NSMutableData *data = [NSMutableData data];
    CMBlockBufferRef blockBuffer;
    CMSampleBufferGetAudioBufferListWithRetainedBlockBuffer(ref, NULL, &audioBufferList, sizeof(audioBufferList), NULL, NULL, 0, &blockBuffer);
    // NSLog(@"%@",blockBuffer);

    if(blockBuffer==NULL)
    {
        [data release];
        return;
    }
    if(&audioBufferList==NULL)
    {
        [data release];
        return;
    }

    //stash data in same object
    for( int y=0; y<audioBufferList.mNumberBuffers; y++ )
    {
//        NSData* throwData;
        AudioBuffer audioBuffer = audioBufferList.mBuffers[y];
        [self.delegate streamer:self didGetAudioBuffer:audioBuffer];
        /*
        Float32 *frame = (Float32*)audioBuffer.mData;
        throwData = [NSData dataWithBytes:audioBuffer.mData length:audioBuffer.mDataByteSize];
        [self.delegate streamer:self didGetAudioBuffer:throwData];
        [data appendBytes:audioBuffer.mData length:audioBuffer.mDataByteSize];
         */
    } 
```

最终将我们带到音频队列，以这种方式设置：

```
//Apple's own code for canonical PCM
    audioDesc.mSampleRate       = 44100.0;
    audioDesc.mFormatID         = kAudioFormatLinearPCM;
    audioDesc.mFormatFlags      = kAudioFormatFlagsAudioUnitCanonical;
    audioDesc.mBytesPerPacket   = 2 * sizeof (AudioUnitSampleType);    // 8
    audioDesc.mFramesPerPacket  = 1;
    audioDesc.mBytesPerFrame    = 1 * sizeof (AudioUnitSampleType);    // 8
    audioDesc.mChannelsPerFrame = 2;
    audioDesc.mBitsPerChannel   = 8 * sizeof (AudioUnitSampleType);    // 32

err = AudioQueueNewOutput(&audioDesc, handler_OSStreamingAudio_queueOutput, self, NULL, NULL, 0, &audioQueue);
    if(err){
#pragma warning  handle error
//never errs, am using breakpoint to check
        return;
    } 
```

我们就这样排队

```
while (inNumberBytes)
        {
            size_t bufSpaceRemaining = kAQDefaultBufSize - bytesFilled;
            if (bufSpaceRemaining < inNumberBytes)
            {
                AudioQueueBufferRef fillBuf = audioQueueBuffer[fillBufferIndex];
        fillBuf->mAudioDataByteSize = bytesFilled;
        err = AudioQueueEnqueueBuffer(audioQueue, fillBuf, 0, NULL);
            }

                bufSpaceRemaining = kAQDefaultBufSize - bytesFilled;
                size_t copySize;
                if (bufSpaceRemaining < inNumberBytes)
                {
                    copySize = bufSpaceRemaining;
                }
                else
                {
                    copySize = inNumberBytes;
                }

                if (bytesFilled > packetBufferSize)
                {
                    return;
                }

                AudioQueueBufferRef fillBuf = audioQueueBuffer[fillBufferIndex];
                memcpy((char*)fillBuf->mAudioData + bytesFilled, (const char*)(inInputData + offset), copySize);

                bytesFilled += copySize;
                packetsFilled = 0;
                inNumberBytes -= copySize;
                offset += copySize;
            }
        } 
```

我试图尽可能地包含代码，以便让每个人都能轻松指出我在哪里是个白痴。话虽如此，我感觉我的问题出现在轨道阅读器的输出设置声明中或 AudioQueue 的实际声明中（我向队列描述我将要发送什么样的音频）。事实是，我真的不知道如何在数学上实际生成这些数字（每个数据包的字节数，每个数据包的帧数，你有什么）。对此的解释将不胜感激，并提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:34:17.747

不确定这是多少答案，但是会有太多的文本和链接来发表评论，希望它会有所帮助（也许会引导您找到答案）。

首先，我知道在我当前的项目中调整采样率会影响声音的速度，所以你可以尝试使用这些设置。但是 44k 是我在大多数默认实现中看到的，包括苹果示例[SpeakHere](http://developer.apple.com/library/ios/#samplecode/SpeakHere/Introduction/Intro.html)。但是，我会花一些时间将您的代码与该示例进行比较，因为存在很多差异。就像在排队之前检查一样。

首先查看这篇文章[https://stackoverflow.com/a/4299665/530933](https://stackoverflow.com/a/4299665/530933) 它讨论了您需要如何了解音频格式，特别是一帧中有多少字节，以及适当的投射

也祝你好运。我在这里发布了很多问题，苹果论坛和 ios 论坛（不是官方论坛）。很少有回应/帮助。为了获得今天的成就（ulaw 中的音频录制和流式传输），我最终不得不打开 Apple Dev Support Ticket。在处理音频之前我从来不知道存在（开发支持）。一件好事是，如果您有一个有效的开发帐户，您将免费获得 2 次事件！CoreAudio 不好玩。文档很少，除了 SpeakHere 之外没有太多示例。我确实发现的一件事是框架标题确实有一些很好的信息和[这本书](https://rads.stackoverflow.com/amzn/click/com/0321636848)。不幸的是，我才刚刚开始阅读这本书，否则我可能会为您提供进一步的帮助。

您还可以查看我自己的一些帖子，这些帖子我已尽力回答。 [这是我的主要音频问题，我花了很多时间来编译所有相关的链接和代码。](https://stackoverflow.com/questions/10501236/stream-media-from-iphone)

[在目标 c 类中使用 AQRecorder（音频队列记录器示例）](https://stackoverflow.com/questions/11318493/how-to-use-aqrecorder-from-speakhere-example)

[尝试将 AVAssetWriter 用于 ulaw 音频](https://stackoverflow.com/questions/11208593/record-and-play-audio-with-avassetwriter)( [2](https://stackoverflow.com/questions/11191403/avassetwriter-record-settings-not-working-like-avaudiorecorder) )

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T17:29:54.663

出于某种原因，即使我看到的使用 LPCM 的音频队列的每个示例都有

```
ASBD.mBitsPerChannel = 8* sizeof (AudioUnitSampleType); 
```

对我来说，事实证明我需要

```
ASBD.mBitsPerChannel    = 2*bytesPerSample; 
```

描述：

```
ASBD.mFormatID          = kAudioFormatLinearPCM;
ASBD.mFormatFlags       = kAudioFormatFlagsAudioUnitCanonical;
ASBD.mBytesPerPacket    = bytesPerSample;
ASBD.mBytesPerFrame     = bytesPerSample;
ASBD.mFramesPerPacket   = 1;
ASBD.mBitsPerChannel    = 2*bytesPerSample;
ASBD.mChannelsPerFrame  = 2;           
ASBD.mSampleRate        = 48000; 
```

我不知道为什么会这样，这让我很困扰……但希望我最终能弄清楚。

如果有人可以向我解释为什么会这样，我将非常感激。

# ruby-on-rails - RESTFUL 路由同页面

> ID：11398999
> 
> 赞同：1
> 
> 时间：2012-07-09T16:09:59.717
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在寻找为我的应用程序设置路线的最佳方法。

该应用程序允许用户注册、发布工作和申请工作。我遇到的问题是，两条应该真正显示不同内容的路线正在链接到相同的页面。

我的路线如下：

```
 resources :users do
   resources :apps
 end

 resources :jobs do
   resources :apps
 end 
```

因此，我最终得到了两条路径：

```
users/id/apps
jobs/id/apps 
```

我想做的是使用第一个路径来显示用户已完成的工作申请。然后，我想使用第二条路径向工作的所有者展示他们收到的该工作的申请。

我遇到的问题是两条路径最终都在`apps#index`

人们可以就如何最佳路线提供任何建议，将不胜感激！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:25:49.930

这两条路径都可能适合您想要做的事情。当一个请求进入

`users/:user_id/apps`

然后你就可以在你的控制器中做这样的事情来填充应用程序列表：

```
@apps = User.find_by_id(params[:user_id]).apps 
```

而在另一条路径的情况下，你会做同样的事情，但使用`params[:jobs_id]`，例如

```
@apps = Job.find_by_id(params[:job_id]).apps 
```

在您的控制器中，您将有一些条件代码构建@apps，具体取决于请求通过哪个路径进入（通过查看 :user_id 或 :job_id 是否在参数中）......像这样：

```
if params[:user_id]
    @apps = User.find_by_id(params[:user_id]).apps
elsif params[:job_id]
    @apps = Job.find_by_id(params[:job_id]).apps
end 
```

或者也许重构为...

```
if params[:user_id]
    @user = User.find(params[:user_id])
    @apps = @user.apps
elsif params[:job_id]
    @job = Job.find(params[:job_id])
    @apps = @job.apps
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T16:39:47.807

如果你使用“resources”关键字，rails 只会映射到默认路由。
如果您希望将特定路线映射到其他内容，则应考虑使用“匹配”。
例如：

```
match "users/id/apps" => "users/id/apps"
match "jobs/id/owners" => "jobs/id/owners" 
```

此页面显示了它的更详细用法：http: [//guides.rubyonrails.org/routing.html](http://guides.rubyonrails.org/routing.html)
您还可以选择将路由更改为其他内容或代码本身。
希望有帮助。