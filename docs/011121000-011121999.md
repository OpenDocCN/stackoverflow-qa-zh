# StackOverflow 问答 11121000-11121999

# makefile - 强制 make 从文件中查找过时的条件

> ID：11121000
> 
> 赞同：2
> 
> 时间：2012-06-20T13:43:50.293
> 
> 标签：makefile, gnu-make

（这类似于[GNU make: Execute target but take dependency from file](https://stackoverflow.com/questions/11104681/gnu-make-execute-target-but-take-dependency-from-file)但略有不同）。

当我试图强制构建一个目标时，make 会自动认为这个目标已经过时并强制运行所有依赖它的目标。

在我的例子中，目标是一个递归的 make 调用，它做了很多工作并且可能只是返回“无事可做”：

```
 .PHONY: intermediate.dat
 intermediate.dat:
      $(MAKE) expensive_chain_which_finally_creates_intermediate.dat

 step1.dat: intermediate.dat
      sleep 10

 step2.dat: step1.dat
      sleep 15

 step3.dat: step2.dat
      sleep 10

 all: step3.dat
      sleep 5 
```

在这种情况下，“make all”会运行 40 秒，尽管 intermediate.dat 可能没有改变（递归 make 返回“无事可做”）。但是，*如果*递归使更新了intermediate.dat，则目标将过期。

真的没有办法做到这一点吗？

问候 divB

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T13:53:35.917

使`intermediate.dat` *依赖*于虚假目标而不是虚假本身。

```
 .PHONY : always-remake

 intermediate.dat : always-remake 
```

IIRC，我上次解决问题时，.PHONY 没有按预期工作，我使用了：

```
 always-remake :
     @true 
```

反而。但是，我不记得为什么了，所以先试试 .PHONY。

使`intermediate.dat`自己变得虚假的问题是`make` **永远不会检查虚假文件的存在/日期**，这是您想要的行为。您只需要触发重建规则，这是由一个过时的先决条件完成的；一个虚假的先决条件总是过时的，所以它可以完成工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-16T23:32:08.080

另一个技巧是使用[***仅订单的***先决条件](https://www.gnu.org/software/make/manual/html_node/Prerequisite-Types.html#Prerequisite-Types)，以及对 的递归调用`make`。`intermediate.dat`当您想要在需要创建文件时实现一些额外的逻辑时，或者当您想要将目标与通常的`exists && newer than`检查分离时，这可能很有用`make`。

### 例如：

假设该文件包含一些后续任务所依赖的对日期敏感的材料，并且它会在**12 小时**后过期。我们只想在其中任何一个为真时重新创建文件：

*   文件超过 12 小时
*   文件不存在

为了实现 make 目标和配方，我们将创建一个目标，它运行时间检查，如果文件过期，则有条件地删除文件，然后为该文件`.PHONY` `check-intermediate.dat`重新运行。`make`

请注意，`check-intermediate.dat`目标将通过[*仅顺序的*先决条件语法](https://www.gnu.org/software/make/manual/html_node/Prerequisite-Types.html#Prerequisite-Types)（例如`intermediate.dat: | check-intermediate.dat`）定义，这使其始终在目标之前运行（例如`intermediate.dat`）。时间检查成本低，我们总是希望它为我们运行和管理文件，但不会像[正常的先决条件](https://www.gnu.org/software/make/manual/html_node/Prerequisite-Types.html#Prerequisite-Types)目标那样使原始`make`检查无效。`intermediate.dat` `.PHONY`

```
 .PHONY: check-intermediate.dat
 check-intermediate.dat:
    if [ -e intermediate.dat ]; then  find intermediate.dat -mmin +720 -exec bash -c 'rm -f "{}"; $(MAKE) intermediate.dat' \; ; fi

 intermediate.dat: | check-intermediate.dat
    echo run-expensive-tasks-here-to-create-intermediate.dat
 step1.dat: intermediate.dat
    sleep 10

 step2.dat: step1.dat
    sleep 15

 step3.dat: step2.dat
    sleep 10

 all: step3.dat
    sleep 5 
```

现在，任何依赖于目标的东西都将首先运行检查，如果文件过期则删除文件，然后在运行其余依赖目标之前`intermediate.dat`重新运行。`make intermediate.dat`如果`intermediate.dat`文件已经存在，它将运行检查，如果检查通过，它将继续运行而不运行耗时的重新创建任务。

依赖`.PHONY`目标的问题在于它**总是**会运行依赖它的任务，因为[GNU Make 处理`.PHONY`目标](https://www.gnu.org/software/make/manual/html_node/Phony-Targets.html#Phony-Targets)的方式。这可能导致`make`运行始终执行耗时的操作，即使它不需要：

> 虚假目标不应该是真实目标文件的先决条件；如果是，则每次 make 更新该文件时都会运行其配方。只要虚假目标永远不是真实目标的先决条件，虚假目标配方将仅在虚假目标是指定目标时执行（请参阅指定目标的参数）。

# android - C2DM 不稳定或某种限制？

> ID：11121002
> 
> 赞同：0
> 
> 时间：2012-06-20T13:43:53.453
> 
> 标签：android, android-c2dm

我有一个有效的 C2DM 项目，atm。我已经注册了我和我的同事的电话，到目前为止效果很好。虽然今天我们都在用它进行测试，这导致我们不得不等待很长时间才能让这些消息出现在我们的手机上，甚至有些消息从未发送过。

我们在 ½-1 小时内向 2 台设备发送约 100 条消息……

任何人都知道这可能是谷歌问题还是？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T15:37:15.370

你的消息有多大？我的理解是 C2DM 的有效载荷是 1kb 或更少。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T15:36:10.293

这在情理之中。C2DM 不是有保证的消息传递服务。它当然不是为“在 ½-1 小时内向 2 台设备发送约 100 条消息”而设计的。这种消息速率需要像 XMPP 这样的东西，您在其中维护持久的套接字连接。

# algorithm - 如何按比例缩小值，使其适合最小值和最大值

> ID：11121012
> 
> 赞同：1
> 
> 时间：2012-06-20T13:44:14.330
> 
> 标签：algorithm, math, graph

我有 6 个带有价格的图表条。
每个**价格数字**将通过尊重`min`和高度来表示其图形栏的`max`高度。
我想要的是图表栏的高度不会低于或高于`min`和`max`值。

所以我有`min = 55`和的值`max = 110`。
并且`price numbers`是：

1.  49
2.  212
3.  717
4.  1081
5.  93

通过哪种数学算法我可以达到预期的结果？
这是某种动态可伸缩条形图。

**修改后**
，价格表中的最小值和最大值将是：`49(min price) => 55(min)`和`1081 (max price) => 110(max)`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-20T13:54:11.100

解决方案很简单：

*   选择最小和最大的项目并找出差异。
*   (largest_item - minimum_item) 映射到 (max-min)。
*   计算`ratio = (max-min)/(largest_item-smallest_item)`
*   `final_value = min_value + ratio*(value-smallest_item)`

作为数学函数：

```
f(x,max,min,largest,smallest) = min + (max-min)/(largest-smallest)*(x-smallest)
where:
x : Input item's price
max: Maximum value (here, 110)
min: Minimum value (here, 55)
largest: Largest item in input (Here, 1081)
smallest: Smallest item in input (Here, 49) 
```

正如@amit 正确指出的那样，一项检查：确保最大和最小的项目是不同的。

* * *

所以让 x = 93。我们还有其他 4 个值。

```
f(x,max,min,largest,smallest) = min + (max-min)/(largest-smallest)*(x-smallest)

value = 55  +   ((110-55)/(1081-49)) * (93-49)
value = 57.344961 
```

更远，

```
f(93,110,55,1081,49) = 57.344961
f(49,110,55,1081,49) = 55
f(1081,110,55,1081,49) = 110 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T13:53:35.560

功能：

```
[(x - min ) / (max-min)*55] + 55 
```

确保您追求的边界 - 但您还应该考虑 - 图表应该显示什么？你希望读者从中理解什么？

为什么？

*   `(x-min) / (max-min)`给出一个范围内的数字`[0,1]`- 0 代表`min`， 1 代表`max`.
*   将其与 55 相乘可确保范围内的数字`[0,55]`。
*   添加 55 可确保范围内的数字`[55,110]`- 正如预期的那样。

(*) 注意：对于 max = min - 由于除以 0，上述失败，请手动处理这些情况。

# java - Panel.add 不立即？

> ID：11121014
> 
> 赞同：0
> 
> 时间：2012-06-20T13:44:26.370
> 
> 标签：java, applet, panel

遇到了一些问题。

构建了一个必须逐步使用的小程序。在每一步之后，单击一个按钮，下一步应该添加到 GUI 中。

问题：没有缩放，添加的内容不可见。在应用程序中，您可以解决缩放窗口大小的问题，但在小程序中我无法解决该问题。

谢谢

编辑：

实际上，它看起来像这样：

```
 Panel cp = new Panel(new GridLayout(0,2));
 Panel Block1 = new Panel(new GridLayout(2,2));
 Panel Block1 = new Panel(new GridLayout(2,2));
  ... 
```

在里面

```
 public void init()
  {  

   buildBlock1();
   buildBlock2();

    add(cp);
    cp.setVisible(true);
  } 
```

在此处添加一些空面板，之后将被填充的面板

```
private void buildBlock1()
{
Block1.add(panel1);
Block1.add(panel2);
Block1.add(panel3);
Block1.add(panel4);

cp.add(Block1);
} 
```

按钮动作监听器

```
private void generatePanel1()
 {
  //adding some Components to the subpanel of Block1, which is a subpanel of cp.
 Panel1.add(...);
 cp.repaint();
 cp.validate();
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T13:57:14.497

现在我没有任何可以检查的代码，但是向容器添加（和删除）组件通常需要“验证”。所以试试

```
panel.add(...); 
panel.revalidate(); 
```

* * *

API 文档[`JComponent.revalidate()`](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/JComponent.html#revalidate%28%29)：

> 验证此容器及其所有子组件。
> 
> 支持延迟自动布局。
> 
> 调用 invalidate 然后将此组件的 validateRoot 添加到需要验证的组件列表中。验证将在所有当前挂起的事件都已调度后进行。换句话说，在调用此方法后，将验证在向上遍历此组件的包含层次结构时找到的第一个 validateRoot（如果有）。默认情况下，JRootPane、JScrollPane 和 JTextField 从 isValidateRoot 返回 true。
> 
> 当属性值发生变化，导致此组件的大小、位置或内部布局受到影响时，将自动在此组件上调用此方法。这种自动更新与 AWT 不同，因为程序通常不再需要调用 validate 来获取要更新的 GUI 的内容。validate 方法用于使容器重新布置其子组件。在容器显示后修改此容器的子组件（添加到容器或从容器中删除，或更改布局相关信息）时，应调用它。

# php - MongoDB 在 find() 上返回空，但在 findOne 或使用 count() 时返回内容

> ID：11121016
> 
> 赞同：1
> 
> 时间：2012-06-20T13:44:28.873
> 
> 标签：php, mongodb

我正在将 mongoDB 用于工作中的一个新项目，但遇到了一些我找不到任何解决方案的麻烦。我的项目中有一个模型，其中包含从 MongoDB 获取一些数据的方法，只要我使用 findOne() 而不是 find()，它就可以正常工作。

方法：

```
public function getData($input) {

        $output = $this->_collection->find($input);
        //$output = $this->_collection->findOne($input);
        Zend_Debug::Dump($output);
        return $output;
    } 
```

运行那段代码时，我从转储中得到了这个：

```
object(MongoCursor)#52 (0) {
} 
```

使用 findOne() ：

```
array(12) {
  ["_id"] => object(MongoId)#54 (1) {
    ["$id"] => string(24) "4fd85d178efd307080000001"
  }
  ["autoadd"] => string(1) "1"
  ["name"] => string(5) "Sport"
  ["keyword"] => string(8) "cookie29"
  ["antal"] => string(1) "0"
  ["antal_week_date"] => string(10) "1218818007"
  ["version"] => string(1) "1"
  ["active"] => string(1) "1"
  ["antal_week"] => string(1) "0"
  ["customer_id"] => string(1) "2"
  ["id"] => string(2) "29"
  ["insert_date"] => string(10) "2007-11-21"
} 
```

使用时`$output = $this->_collection->find($input)->count();`：

```
int(20) 
```

我究竟做错了什么？这可能是一个简单的问题，但我找不到任何其他方法来做这些事情。如果您想知道输入是什么，它只是一个关联数组：

```
$data = array('active' => '1'); 
```

请帮我获取所有这 20 个不错的“行”数据。我将不胜感激。

感谢您的建议和更好的智慧！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-20T13:48:02.270

`find()`返回游标，而不是具有实际数据的数组。您必须迭代光标。这是[文档中的一个示例](http://php.net/manual/en/mongocollection.find.php)

```
$m = new Mongo();
$db = $m->selectDB('test');
$collection = new MongoCollection($db, 'phpmanual');

// search for documents where 5 < x < 20
$rangeQuery = array('x' => array( '$gt' => 5, '$lt' => 20 ));

$cursor = $collection->find($rangeQuery);
foreach ($cursor as $doc) {
    var_dump($doc);
} 
```

# django - Apache中的Django gevent单线程错误

> ID：11121019
> 
> 赞同：1
> 
> 时间：2012-06-20T13:44:29.960
> 
> 标签：django, apache, mod-wsgi, gevent

我正在用我的代码导入一个库，它给了我

```
NotImplementedError: gevent is only usable from a single thread 
```

图书馆是内部的，所以很遗憾我不能分享它。

我设法通过添加以下内容为 Django 开发服务器解决了这个问题：

```
import gevent.monkey
gevent.monkey.patch_all(signal=False, httplib=False) 
```

作为shebang之后我的manage.py文件的**前**两行。然后我开始使用 mod_wsgi 将它部署在 apache 上，并认为将它作为我的 wsgi.py 文件的前两行就足够了。这是错误的。我想我现在已经尝试了一切，有没有人知道该怎么做？！

关于在 wsgi.py 文件之前执行的文件的任何想法，我可以在其中尝试猴子补丁？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T13:54:29.910

我没有设法解决这个问题，但我设法将两个 gevent 客户端替换为其他客户端类型，这使得问题消失了......

# android - 从源代码的 res/values/dimension.xml 加载维度值

> ID：11121028
> 
> 赞同：395
> 
> 时间：2012-06-20T13:44:56.233
> 
> 标签：android, android-resources, dpi, dimension

我想按原样加载值。我有两个`dimension.xml`文件，一个在`/res/values/dimension.xml`，另一个在`/res/values-sw360dp/dimension.xml`.

从源代码我想做类似的事情

```
getResources().getDimension(R.dimen.tutorial_cross_marginTop); 
```

这可行，但我得到的值乘以屏幕密度因子（hdpi 为 1.5，xhdpi 为 2.0 等）。

我也尝试过

```
getResources().getString(R.dimen.tutorial_cross_marginTop); 
```

这原则上可行，但我得到一个以“dip”结尾的字符串......

* * *

## 回答 #1

> 赞同：920
> 
> 时间：2013-04-29T10:27:07.287

在我的 dimens.xml 我有

```
<dimen name="test">48dp</dimen> 
```

在代码中如果我这样做

```
int valueInPixels = (int) getResources().getDimension(R.dimen.test) 
```

这将返回 72 作为文档状态乘以当前手机的密度（在我的情况下为 48dp x 1.5）

完全按照文档状态：

> 检索特定资源 ID 的维度。单位转换基于与资源关联的当前 DisplayMetrics。

因此，如果您想要精确的 dp 值，就像在 xml 中一样，只需将其除以 DisplayMetrics 密度

```
int dp = (int) (getResources().getDimension(R.dimen.test) / getResources().getDisplayMetrics().density); 
```

dp现在是48

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-06-20T13:47:54.310

```
Context.getResources().getDimension(int id); 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-06-20T13:48:14.267

该类`Resource`还有一个方法[getDimensionPixelSize()](http://developer.android.com/reference/android/content/res/Resources.html#getDimensionPixelSize%28int%29)我认为它会满足您的需求。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2017-10-25T03:10:11.183

对于那些只需要`int`在资源中节省一些价值的人，您可以执行以下操作。

整数.xml

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <integer name="default_value">100</integer>
</resources> 
```

代码

```
int defaultValue = getResources().getInteger(R.integer.default_value); 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2018-02-02T11:16:32.893

您可以使用**getDimensionPixelOffset()**代替 getDimension，因此您不必强制转换为 int。

```
int valueInPixels = getResources().getDimensionPixelOffset(R.dimen.test) 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2020-01-09T09:09:52.860

## 使用 Kotlin 扩展

您可以添加一个扩展来简化此过程。它使您只需调用`context.dp(R.dimen. tutorial_cross_marginTop)`即可获取 Float 值

```
fun Context.px(@DimenRes dimen: Int): Int = resources.getDimension(dimen).toInt()

fun Context.dp(@DimenRes dimen: Int): Float = px(dimen) / resources.displayMetrics.density 
```

如果你想在没有上下文的情况下处理它，你可以使用`Resources.getSystem()`：

```
val Int.dp get() = this / Resources.getSystem().displayMetrics.density // Float

val Int.px get() = (this * Resources.getSystem().displayMetrics.density).toInt() 
```

例如，在 xhdpi 设备上，用于`24.dp`获取 12.0 或`12.px`获取 24

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-11-07T05:23:28.210

您也可以在 xml 文件中写入整数..
你见过 [this] [http://developer.android.com/guide/topics/resources/more-resources.html#Integer](http://developer.android.com/guide/topics/resources/more-resources.html#Integer)吗？用于 。

```
 context.getResources().getInteger(R.integer.height_pop); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-06-20T13:47:55.200

```
 This works but the value I get is multiplied times the screen density factor
  (1.5 for hdpi, 2.0 for xhdpi, etc). 
```

我认为根据分辨率获得值是件好事，但如果你不想这样做，请在 px 中给出这个值......

与密度无关的像素 (dp)

定义 UI 布局时应使用的虚拟像素单位，以与密度无关的方式表示布局尺寸或位置。与密度无关的像素相当于 160 dpi 屏幕上的一个物理像素，这是系统为“中等”密度屏幕假定的基线密度。在运行时，系统会根据需要透明地处理 dp 单位的任何缩放。`based on the actual density of the screen in use. The conversion of dp units to screen pixels is simple: px = dp * (dpi / 160). For example, on a 240 dpi screen, 1 dp equals 1.5 physical pixels.`在定义应用程序的 UI 时，应始终使用 dp 单位，以确保在不同密度的屏幕上正确显示 UI。

我认为根据分辨率更改值很好，但如果你不想这样做，请以 px 为单位......

参考这个[链接](http://developer.android.com/guide/topics/resources/more-resources.html#Dimension)

按照这个

dp

与密度无关的像素 - 基于屏幕物理密度的抽象单位。这些单位是相对于 160 dpi（每英寸点数）的屏幕而言的，在该屏幕上 1dp 大致等于 1px。`When running on a higher density screen, the number of pixels used to draw 1dp is scaled up by a factor appropriate for the screen's dpi. Likewise, when on a lower density screen, the number of pixels used for 1dp is scaled down.`dp与像素的比例会随着屏幕密度而变化，但不一定成正比。使用 dp 单位（而不是 px 单位）是一种简单的解决方案，可以使布局中的视图尺寸针对不同的屏幕密度正确调整大小。换句话说，它为不同设备上 UI 元素的真实尺寸提供了一致性。

像素

像素 - 对应于屏幕上的实际像素。不推荐使用此度量单位，因为实际表示可能因设备而异；每个设备每英寸的像素数可能不同，并且屏幕上可用的总像素数可能更多或更少。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2021-08-24T14:50:52.840

这是一个更好的解决方案，不涉及从 dp 到 px 再从 px 到 dp 的双重转换：

# 在科特林

```
fun Resources.getRawDimensionInDp(@DimenRes dimenResId: Int): Float {
    val value = TypedValue()
    getValue(dimenResId, value, true)
    return TypedValue.complexToFloat(value.data)
}
// Usage: 
resources.getRawDimensionInDp(R.dimen.my_dimen_id) 
```

# 在 Java 中

```
public class ResourcesUtil {
    static Float getRawDimensionInDp(Resources resources, @DimenRes int dimenResId) {
        TypedValue value = new TypedValue();
        resources.getValue(dimenResId, value, true);
        return TypedValue.complexToFloat(value.data);
    }
}

// Usage: 
ResourcesUtil.getRawDimensionInDp(resources, R.dimen.my_dimen_id); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-11-10T07:01:13.543

如果您只想动态更改字体大小，那么您可以：

```
textView.setTextSize(TypedValue.COMPLEX_UNIT_PX, resources.getDimension(R.dimen.tutorial_cross_marginTop)) 
```

作为@achie 的回答，您可以像这样从dimens.xml 获取dp：

```
val dpValue = (resources.getDimension(R.dimen.tutorial_cross_marginTop)/ resources.displayMetrics.density).toInt() 
```

或者像这样得到sp

```
val spValue = (resources.getDimension(R.dimen.font_size)/ resources.displayMetrics.scaledDensity).toInt() 
```

关于 Resources.java #{getDimension}

```
 /**
     * Retrieve a dimensional for a particular resource ID.  Unit 
     * conversions are based on the current {@link DisplayMetrics} associated
     * with the resources.
     * 
     * @param id The desired resource identifier, as generated by the aapt
     *           tool. This integer encodes the package, type, and resource
     *           entry. The value 0 is an invalid identifier.
     * 
     * @return Resource dimension value multiplied by the appropriate 
     * metric.
     * 
     * @throws NotFoundException Throws NotFoundException if the given ID does not exist.
     *
     * @see #getDimensionPixelOffset
     * @see #getDimensionPixelSize
     */ 
```

**资源维度值乘以相应的**

# java - 关于 socket.startHandshake(); 在java中

> ID：11121030
> 
> 赞同：0
> 
> 时间：2012-06-20T13:44:59.717
> 
> 标签：java, sockets, ssl

我有一个小型 Java 程序，它从文本文件中读取 IP 列表，并在循环内创建与 IP 的 ssl 会话。会话可能成功或失败取决于是否在另一端启用了端口 443。

我的问题： 1、如果对方没有开启443端口，会话会失败。问题是我的程序在这里停止并转到异常处理并向我打印错误并结束。我希望程序继续使用下一个 IP 创建下一个会话，依此类推。我怎样才能让它继续并打印出一条消息，说明该 IP 的会话失败？

另一个问题：如何获得启用的密码套件？我试图打印 socket.getEnabledCipherSuites(); 但打印的奇怪文本根本不是一种密码套件。

编辑：

```
public static void main(String[] argv) {

try{

    while ((there are IPs)   

    {
        try{
            //call for Connect function which has try/catch on it the same way

            }catch (Exception e){
              System.err.println("Error: " + e.getMessage());
          }//catch
    }//end while loop

   catch (Exception e){
  System.err.println("Error: " + e.getMessage());
 }//catch

 }//end void main </i> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T13:48:14.903

您的第 1 点似乎是异常处理应该注意的事情：将 all_ips 上的每个迭代都包含在其自己的 try/catch 块中。

你可以从这里的一些多线程和超时中受益匪浅，因为一些防火墙只会默默地丢弃你的 SYN 数据包，让你的扫描工具无限期地等待。

但在您这样做之前，请注意：您将看起来*非常*像一个恶意工具，它正在扫描网络以查找某些漏洞。如果您过于激进或针对您不认识的人，您可能会遇到管理麻烦。一个线程池或一些类似的技术，以确保您不超过相当数量的连接建立/秒是最低限度的。

# ruby-on-rails - Rails 应用程序运行问题

> ID：11121038
> 
> 赞同：0
> 
> 时间：2012-06-20T13:45:30.413
> 
> 标签：ruby-on-rails, ruby, deployment

全部。Rails 3.0.7 版；红宝石版本 1.8.7。我对部署 Rails 应用程序有疑问。我从 github repo 中提取它们，运行 bundle install。正确安装了所有 gem（“您的捆绑包已完成！”）。但是当我尝试运行 rails server 时，我收到以下信息：

```
ophui@ophui:~/rep/govno$ rails server
    /home/ophui/.rvm/gems/ruby-1.8.7-p358@global/gems/bundler-1.1.4/lib/bundler/runtime.rb:74:in `require': no such file to load -- twilio/ruby (LoadError)
        from /home/ophui/.rvm/gems/ruby-1.8.7-p358@global/gems/bundler-1.1.4/lib/bundler/runtime.rb:74:in `require'
        from /home/ophui/.rvm/gems/ruby-1.8.7-p358@global/gems/bundler-1.1.4/lib/bundler/runtime.rb:55:in `each'
        from /home/ophui/.rvm/gems/ruby-1.8.7-p358@global/gems/bundler-1.1.4/lib/bundler/runtime.rb:55:in `require'
        from /home/ophui/.rvm/gems/ruby-1.8.7-p358@global/gems/bundler-1.1.4/lib/bundler.rb:119:in `require'
        from /home/ophui/rep/govno/config/application.rb:7
        from /home/ophui/.rvm/gems/ruby-1.8.7-p358/gems/railties-3.0.7/lib/rails/commands.rb:28:in `require'
        from /home/ophui/.rvm/gems/ruby-1.8.7-p358/gems/railties-3.0.7/lib/rails/commands.rb:28
        from /home/ophui/.rvm/gems/ruby-1.8.7-p358/gems/railties-3.0.7/lib/rails/commands.rb:27:in `tap'
        from /home/ophui/.rvm/gems/ruby-1.8.7-p358/gems/railties-3.0.7/lib/rails/commands.rb:27
        from script/rails:6:in `require'
        from script/rails:6 
```

附言。我是 Rails 的新手。谢谢大家！

**更新：**

我的*宝石文件*是

```
source 'http://rubygems.org'

gem 'geocoder'
gem 'twilio-ruby'
gem 'localtunnel', :group => :development
gem "rake", "0.8.7"
gem 'sass'
gem 'haml'
gem 'request-log-analyzer'
gem 'daemons'
gem 'jasmine', :group => [:development, :test] 
gem "selenium-webdriver", "2.20.0"
gem 'jquery-rails', '>= 1.0.12'
gem 'whenever', :require => false
gem 'rails', '3.0.7'
gem 'sanitize'
gem "prawn"
gem "aws-s3", '>= 0.6.2', :require => 'aws/s3'
gem "geocoder-us", '1.1.0', :require => 'geocoder_us'
gem "yahoo", '1.1.0'
gem 'gchartrb', '0.8', :require => 'google_chart'
gem 'simple-rss'

#gem 'tiny_mce', :git => 'https://github.com/kete/tiny_mce.git'
gem 'will_paginate', '3.0.pre2'
gem 'defensio', '0.9.1'
gem 'imagesize', '0.1.1', :require => "image_size"
gem 'httpclient', '2.1.6.1'
gem 'rc-rest', '1.0.0', :require => 'rc_rest'
gem "fastercsv"
gem "koala" # FB library
gem "carmen" # Mapping for states of various countries
#gem "dynamic_form", :git => "https://github.com/joelmoss/dynamic_form"
gem "foreigner", "0.9.2" # Adds support to migrations to create foreign keys

gem 'shoulda', :group => :test
gem 'mocha', :group => :test
gem 'ruby-debug', :group => [:development, :test]
gem 'awesome_print', :group => [:development, :test]
gem "meta_where" # Nicer querying

group :cucumber do
  #gem "capybara" # test javascript
  gem "rspec", "~> 2.8"
  gem "database_cleaner"
  gem "cucumber-rails"
  gem 'pickle'
  #gem 'factory_girl'
  gem "factory_girl_rails", "1.2"
end
gem 'mysql2', '~> 0.2.7' 
```

并且*gemfile.lock*太大，无法在此处发布。（大约 250 行）这里还需要它们吗？

**更新 2**

```
$ bundle install --path vendor/bundle 
```

返回以下内容：

```
Gems included by the bundle:
  * Ascii85 (1.0.1)
  * abstract (1.0.0)
  * actionmailer (3.0.7)
  * actionpack (3.0.7)
  * activemodel (3.0.7)
  * activerecord (3.0.7)
  * activeresource (3.0.7)
  * activesupport (3.0.7)
  * arel (2.0.10)
  * awesome_print (1.0.2)
  * aws-s3 (0.6.3)
  * builder (2.1.2)
  * bundler (1.1.4)
  * capybara (1.1.2)
  * carmen (0.2.13)
  * childprocess (0.3.2)
  * chronic (0.6.7)
  * columnize (0.3.6)
  * cucumber (1.2.1)
  * cucumber-rails (1.3.0)
  * daemons (1.1.8)
  * database_cleaner (0.8.0)
  * defensio (0.9.1)
  * diff-lcs (1.1.3)
  * dynamic_form (1.1.3 d31a6c0)
  * erubis (2.6.6)
  * factory_girl (2.1.2)
  * factory_girl_rails (1.2.0)
  * faraday (0.8.1)
  * fastercsv (1.5.5)
  * ffi (1.0.11)
  * foreigner (0.9.2)
  * gchartrb (0.8)
  * geocoder (1.1.2)
  * geocoder-us (1.1.0)
  * gherkin (2.11.0)
  * haml (3.1.6)
  * httparty (0.8.3)
  * httpclient (2.1.6.1)
  * i18n (0.5.0)
  * imagesize (0.1.1)
  * jasmine (1.2.0)
  * jasmine-core (1.2.0)
  * jquery-rails (1.0.19)
  * json (1.7.3)
  * jwt (0.1.4)
  * koala (1.5.0)
  * linecache (0.46)
  * localtunnel (0.3)
  * mail (2.2.19)
  * meta_where (1.0.4)
  * metaclass (0.0.1)
  * mime-types (1.18)
  * mocha (0.11.4)
  * multi_json (1.3.6)
  * multi_xml (0.5.1)
  * multipart-post (1.1.5)
  * mysql2 (0.2.18)
  * net-ssh (2.5.2)
  * net-ssh-gateway (1.1.0)
  * nokogiri (1.5.4)
  * pdf-reader (1.1.1)
  * pickle (0.4.10)
  * polyglot (0.3.3)
  * prawn (0.12.0)
  * rack (1.2.5)
  * rack-mount (0.6.14)
  * rack-test (0.5.7)
  * rails (3.0.7)
  * railties (3.0.7)
  * rake (0.8.7)
  * rbx-require-relative (0.0.9)
  * rc-rest (1.0.0)
  * request-log-analyzer (1.12.2)
  * rspec (2.10.0)
  * rspec-core (2.10.1)
  * rspec-expectations (2.10.0)
  * rspec-mocks (2.10.1)
  * ruby-debug (0.10.4)
  * ruby-debug-base (0.10.4)
  * ruby-rc4 (0.1.5)
  * rubyzip (0.9.9)
  * sanitize (2.0.3)
  * sass (3.1.19)
  * selenium-webdriver (2.20.0)
  * shoulda (3.0.1)
  * shoulda-context (1.0.0)
  * shoulda-matchers (1.0.0)
  * simple-rss (1.2.3)
  * thor (0.14.6)
  * tiny_mce (0.1.8 49aa365)
  * treetop (1.4.10)
  * ttfunk (1.0.3)
  * twilio-ruby (3.7.0)
  * tzinfo (0.3.33)
  * whenever (0.7.3)
  * will_paginate (3.0.pre2)
  * xml-simple (1.1.1)
  * xpath (0.1.4)
  * yahoo (1.1.0) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T13:47:35.360

尝试安装gem

```
gem install twilio
gem install twilio-ruby 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T14:17:07.503

请试一试：

```
$ bundle install --path vendor/bundle 
```

# javascript - 根据div中的多个数据对div进行排序

> ID：11121044
> 
> 赞同：0
> 
> 时间：2012-06-20T13:46:13.677
> 
> 标签：javascript, jquery, algorithm

我正在尝试实现最佳匹配功能。基本上我正在做一个任务，我不擅长 jQuery 或 JS。该功能就像用户将使用搜索功能来搜索属性并显示搜索结果，搜索结果顶部有一个下拉列表，其中包含按距离排序、按最佳匹配等排序选项。我已经实现了其他排序选项的功能，只剩下最佳匹配。我不知道如何解决这个问题，因为为了实现最佳匹配，我必须匹配显示的每条记录的所有字段并按此对结果进行排序。主要问题是如何使用 jQuery 比较每条记录的多个字段。

以下是显示结果的格式：

```
<div class="container">
    <div id="ptype">property type</div>
    <div id="ttype">sale</div>
    <div id="price">$20000</div>
    <div id="distance">24 Miles</div>
</div> 
```

不同的属性会有多个 div。现在我想根据最佳匹配对这些结果进行排序，比较价格、距离等每个给定字段。

请指导我如何解决这个问题。

# perl - 无法重定向到 perl 中的 url

> ID：11121047
> 
> 赞同：0
> 
> 时间：2012-06-20T13:46:24.110
> 
> 标签：perl

我正在使用管理工具。我在管理工具中有一个以合作伙伴身份登录按钮。当我单击管理工具时，我想直接转到用户配置文件而无需登录。我正在使用一个 html 页面，其中有一个标题，在该标题下我想要该用户配置文件。

所以我正在做的是我正在获取用户个人资料的 url 并重定向到该 url。

我正在获取标题页面，但在它下方正在获取登录页面以转到用户个人资料。当我直接打开网址时，我可以直接进入用户个人资料。

但是当我重定向时，我正在让登录页面转到用户个人资料。我正在使用下面的代码重定向到一个 url。

```
## Redirecting the partner to abc.com
                my $r = new CGI;
                print STDERR " url is $result\n";
                print $r->redirect( -URL => $result);
                close(STDOUT);
                exit(0); 
```

请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T15:56:02.007

您没有说您是否想像公众一样查看用户的个人资料，作为用户可能（编辑他们自己的个人资料）或作为管理员用户。

如果您需要像以用户身份登录一样查看页面，以下是我解决此类案例的方法：

在我们的会话中，我们有一个“real_user_id”和“effective_use_id”。通常它们是相同的，并且在会话处理的大多数地方，我们检查“effective_user_id”。但是，在管理区域中，有时我们想以另一个用户身份登录，以便我们可以看到他们所做的事情。在这种情况下，我们在 admin 区域中有一个功能，可以将 admin 用户的“有效用户 id”设置为另一个用户。这使我们可以像没有密码一样有效地以用户身份“登录”，但是由于系统仍然可以看到“真实用户 ID”，因此我们还可以构建一个选项以返回到普通管理员用户身份。

您可能会遇到问题，因为当您重定向到正确的页面时，该页面正在重定向回登录屏幕，因为您没有登录该用户。您可以通过手动发出请求来查看命令行上发生的情况，如下所示：

```
HEAD -sSe 'http://example.com/users-profile-page-to-redirect-to' 
```

（'HEAD' 工具来自 LWP::UserAgent perl 模块）。

您可能需要更新“用户个人资料页面”的身份验证，以便普通用户和管理员用户都可以看到它。您如何做到这一点取决于您如何在系统中实施授权。

# ssis - 使用 SSIS 行数更新 SQL 表

> ID：11121049
> 
> 赞同：3
> 
> 时间：2012-06-20T13:46:31.147
> 
> 标签：ssis

我有一个要保存到 SQL 表的平面文件。我想计算插入的行并将计数写入另一个表。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-20T15:47:57.253

简单的答案是创建一个 SSIS 变量并将 RowCount 转换拖放到您的数据流中。

## 创建变量

在控制流上，单击背景。不要单击任何任务，否则您的变量将在错误的范围内创建（此警告不适用于 2012）。右键单击并选择变量。在“变量”窗口中，单击“添加”按钮并将其命名为 RowCounts，数据类型为 Int32（除非您需要 Int64（超过 2M 行））

## 添加行计数转换

在数据流中，在数据源之后添加行计数转换。将其配置为使用我们在上面创建的变量。生成的数据流可能看起来像这样

![行数数据流](../Images/600458d217a89bcf33582907a912f760.png)

*需要注意的是，行计数组件在*数据流完成之前不会将行计数分配给@User::RowCount 变量。

## 保存行计数值

数据流完成后，您需要使用控制流中的执行 SQL 任务将值写入表中。

![控制流](../Images/4f05cd3e578fbd4969f65f0c3f65855f.png)

执行 SQL 任务看起来像这样，具体取决于您的表被定义为什么。

```
INSERT INTO 
    dbo.RowCounts
(
    rowcounts
) 
SELECT 
    ? AS rowcounts 
```

在“参数映射”选项卡中，它看起来像

```
User::RowCount  Input  Long  0  -1 
```

# wpf - 直接设置绑定值

> ID：11121057
> 
> 赞同：8
> 
> 时间：2012-06-20T13:46:56.330
> 
> 标签：wpf, binding, attached-properties

是否可以在不知道绑定属性的情况下直接设置双向绑定后面的值？

我有一个附加属性，它绑定到这样的属性：

```
<Element my:Utils.MyProperty="{Binding Something}" /> 
```

现在我想`Something`从附加属性的角度更改有效存储的值。所以我不能直接访问绑定的属性，而只能引用`DependencyObject`（即 Element 实例）和`DependencyProperty`对象本身。

简单地设置它时的问题`DependencyObject.SetValue`是这有效地删除了绑定，但我想更改底层的绑定属性。

使用`BindingOperations`I 可以同时获得`Binding`和`BindingExpression`。现在有没有办法访问它背后的属性并改变它的值？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-20T14:55:31.653

好的，我现在自己在绑定表达式上使用了一些反射技巧解决了这个问题。

我基本上查看绑定路径和响应数据项并尝试自己解决绑定。对于更复杂的绑定路径，这可能会失败，但对于我上面示例中的简单属性名称，这应该可以正常工作。

```
BindingExpression bindingExpression = BindingOperations.GetBindingExpression(dependencyObj, dependencyProperty);
if (bindingExpression != null)
{
    PropertyInfo property = bindingExpression.DataItem.GetType().GetProperty(bindingExpression.ParentBinding.Path.Path);
    if (property != null)
        property.SetValue(bindingExpression.DataItem, newValue, null);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T14:13:48.300

尝试在`PropertyMetadata`

您可以在 MSDN 上找到更多信息 - [http://msdn.microsoft.com/en-us/library/system.windows.propertymetadata.aspx](http://msdn.microsoft.com/en-us/library/system.windows.propertymetadata.aspx)

这是一个例子：

```
 public Boolean State
  {
    get { return (Boolean)this.GetValue(StateProperty); }
    set { this.SetValue(StateProperty, value); } 
  }
  public static readonly DependencyProperty StateProperty = DependencyProperty.Register(
    "State", typeof(Boolean), typeof(MyStateControl),new PropertyMetadata(myDefaultValue)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-01T21:32:34.997

> 简单地通过 DependencyObject.SetValue 设置它时的问题是这有效地删除了绑定，但我想更改底层绑定属性。

如果 Binding.Mode 设置为 OneWay，则为 true。如果将其设置为 TwoWay，则使用 DependencyObject.SetValue 不会删除其绑定。

这是 C# 中 Pro WPF 4.5 的引用（第 232 页）：

> 删除绑定：如果要删除绑定以便以通常的方式设置属性，则需要 ClearBinding() 或 ClearAllBindings() 方法的帮助。仅仅对属性应用一个新值是不够的。如果您使用双向绑定，您设置的值将传播到链接对象，并且两个属性保持同步。

因此，为了能够在不删除其绑定的情况下使用 SetValue 更改（和传播） my:Utils.MyProperty：

```
<Element my:Utils.MyProperty="{Binding Something, Mode=TwoWay}" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-15T10:02:39.720

您可以通过虚拟对象上的绑定传递值。

```
 public static void SetValue(BindingExpression exp, object value)
    {
        if (exp == null)
            throw new ValueCannotBeNullException(() => exp);
        Binding dummyBinding = new Binding(exp.ParentBinding.Path.Path);
        dummyBinding.Mode = BindingMode.OneWayToSource;
        dummyBinding.Source = exp.DataItem;
        SetValue(dummyBinding, value);
    }

    public static void SetValue(Binding binding, object value)
    {
        BindingDummyObject o = new BindingDummyObject();
        BindingOperations.SetBinding(o, BindingDummyObject.ValueProperty, binding);
        o.Value = value;
        BindingOperations.ClearBinding(o, BindingDummyObject.ValueProperty);
    } 
```

这是我的虚拟对象

```
 internal class BindingDummyObject : DependencyObject
{
    public object Value
    {
        get
        {
            return (object)GetValue(ValueProperty);
        }
        set
        {
            SetValue(ValueProperty, value);
        }
    }

    public static readonly DependencyProperty ValueProperty = DependencyProperty.Register("Value", typeof(object), typeof(BindingDummyObject));
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-01T05:15:50.900

在尝试实现由枚举支持的菜单时，我遇到了类似的问题。我希望能够将基础属性（它是一个枚举）设置为与菜单项关联的值。

在我的示例中，我将两个属性附加到了 MenuItem：

```
 public static readonly DependencyProperty EnumTargetProperty = DependencyProperty.RegisterAttached(
        "EnumTarget",
        typeof(object),
        typeof(MenuItem),
        new PropertyMetadata(null, EnumTargetChangedCallback)
        );

    public static readonly DependencyProperty EnumValueProperty = DependencyProperty.RegisterAttached(
        "EnumValue",
        typeof(object),
        typeof(MenuItem),
        new PropertyMetadata(null, EnumValueChangedCallback)
        ); 
```

标记如下所示：

```
 <MenuItem.ItemContainerStyle>
                    <Style TargetType="MenuItem">
                        <Setter Property="IsCheckable" Value="True"/>
                        <Setter Property="local:EnumMenuItem.EnumValue" Value="{Binding EnumMember}"/>
                        <Setter Property="local:EnumMenuItem.EnumTarget" Value="{Binding RelativeSource={RelativeSource AncestorType=local:MainWindow}, Path=DataContext.Settings.AutoUpdateModel.Ring}"/>
                        <Setter Property="Header" Value="{Binding DisplayName}"/>
                        <Setter Property="ToolTip" Value="{Binding ToolTip}"/>
                    </Style>
                </MenuItem.ItemContainerStyle> 
```

父菜单项的项目源绑定到为枚举中的每个成员提供值的 MarkupExtension 实现。

现在，当检查菜单项时，我使用此代码设置属性的值而不删除绑定。

```
 menuItem.Checked += (sender, args) =>
        {
            var checkedMenuItem = (MenuItem)sender;
            var targetEnum = checkedMenuItem.GetValue(EnumTargetProperty);
            var menuItemValue = checkedMenuItem.GetValue(EnumValueProperty);
            if (targetEnum != null && menuItemValue != null)
            {
                var bindingExpression = BindingOperations.GetBindingExpression(d, EnumTargetProperty);
                if (bindingExpression != null)
                {
                    var enumTargetObject = bindingExpression.ResolvedSource;
                    if (enumTargetObject != null)
                    {
                        var propertyName = bindingExpression.ResolvedSourcePropertyName;
                        if (!string.IsNullOrEmpty(propertyName))
                        {
                            var propInfo = enumTargetObject.GetType().GetProperty(propertyName);
                            if (propInfo != null)
                            {
                                propInfo.SetValue(enumTargetObject, menuItemValue);
                            }
                        }
                    }
                }
            }
        }; 
```

这似乎适用于我的路径复杂的场景。

我希望这会有所帮助！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-12-29T18:49:22.413

这是我为 a 所做的`TextBlock`：

```
BindingExpression bindingExpression = textBlock.GetBindingExpression(TextBlock.TextProperty);
string propertyName = bindingExpression.ResolvedSourcePropertyName;
PropertyInfo propertyInfo;
Type type = bindingExpression.DataItem.GetType();
object[] indices = null;
if (propertyName.StartsWith("[") && propertyName.EndsWith("]"))
{
    // Indexed property
    propertyInfo = type.GetProperty("Item");
    indices = new object[] { propertyName.Trim('[', ']') };
} 
else
    propertyInfo = type.GetProperty(propertyName);
if (propertyInfo.PropertyType == typeof(string))
{
    propertyInfo.SetValue(bindingExpression.DataItem, text, indices);
    // To update the UI.
    bindingExpression.UpdateTarget();
} 
```

# xslt - 替换表列中的所有值

> ID：11121058
> 
> 赞同：3
> 
> 时间：2012-06-20T13:47:02.670
> 
> 标签：xslt, replace, html-table, xslt-2.0

我正在尝试使用 XSLT 向特定列中的所有节点添加一个值（在本例中为字符串“I added This”），如果该列确实包含某个值（在本例中为文本“I Want You”） 2.0。

这意味着，如果我有下表：

```
<table>
        <tr>
            <th>header value</th>
            <th>I Want You</th>
            <th>header value</th>
        </tr>

        <tr>
            <td>value 1</td>
            <td>value 2</td>
            <td>value 3</td>
        </tr>

        <tr>
            <td>value 4</td>
            <td>value 5</td>
            <td>value 6</td>
        </tr>
</table> 
```

应用 xslt 脚本后，输出应该是这样的：

```
<table>
        <tr>
            <th>header value</th>
            <th>I Want You</th>
            <th>header value</th>
        </tr>

        <tr>
            <td>value 1</td>
            <td>I Added This value 2</td>
            <td>value 3</td>
        </tr>

        <tr>
            <td>value 4</td>
            <td>I Added This value 5</td>
            <td>value 6</td>
        </tr>
</table> 
```

为了实现这一点，我编写了许多不同的样式表，但我什至没有接近：

复制整个表：

```
<xsl:template match="node()|@*">
    <xsl:copy>
            <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>
</xsl:template> 
```

这让我得到了我想要更改的列的值 - 但从那里我不知道如何在每个 td 值前面加上“我添加了这个值”这个短语

```
<xsl:template match="//th[contains(lower-case(.), 'I Want You')]">

    <xsl:variable name="tdPos" select="count(preceding-sibling::td)+2"/>

    <xsl:for-each select="current()/parent::*/following-sibling::tr">
        <xsl:value-of select="./td[$tdPos]/text()"/>
    </xsl:for-each>
</xsl:template> 
```

非常感谢任何可能将我指向正确方向的提示！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:26:41.877

一个值得注意的问题是您的“包含”测试不太正确

```
<xsl:template match="//th[contains(lower-case(.), 'I Want You')]"> 
```

大概是下面这个

```
<xsl:template match="//th[contains(lower-case(.), lower-case('I Want You'))]"> 
```

但是，如果您将搜索值参数化，则可能会更好，尽管您无法在模板匹配中使用此类参数。相反，您只需匹配任何单元格......

```
<xsl:template match="tr/*"> 
```

然后您可以测试前一行上的等效列是否具有您想要的值

```
<xsl:if 
   test="../preceding-sibling::tr/*[$position][contains(., $match)]"> 
```

（为简洁起见删除了小写（）命令）

这里 $position 将是一个包含当前单元格位置的变量，而 $match 是您要查找的变量。

尝试以下 XSLT

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="html" indent="yes"/>
   <xsl:param name="match" select="'I Want You'" />
   <xsl:param name="add" select="'I Added This'" />

   <xsl:template match="tr/*">
      <xsl:variable name="position" select="count(preceding-sibling::*) + 1"/>          <xsl:copy>
         <xsl:apply-templates select="@*"/>
         <xsl:if test="../preceding-sibling::tr/*[$position][contains(lower-case(.), lower-case($match))]">
            <xsl:value-of select="concat($add, ' ')" />
         </xsl:if>
         <xsl:apply-templates select="text()"/>
      </xsl:copy>
   </xsl:template>

   <xsl:template match="@*|node()">
      <xsl:copy>
         <xsl:apply-templates select="@*|node()"/>
      </xsl:copy>
   </xsl:template>
</xsl:stylesheet> 
```

当应用于您的 XML 时，将生成以下内容

```
<table>
<tr>
   <th>header value</th>
   <th>I Want You</th>
   <th>header value</th>
</tr>
<tr>
   <td>value 1</td>
   <td>I Added This value 2</td>
   <td>value 3</td>
</tr>
<tr>
   <td>value 4</td>
   <td>I Added This value 5</td>
   <td>value 6</td>
</tr>
</table> 
```

当应用于这个 XML

```
<table>
   <tr>
      <th>header value</th>
      <th>header value</th>
      <th>header value</th>
   </tr>
   <tr>
      <td>value 1</td>
      <td>I Want You</td>
      <td>value 2</td>
   </tr>
   <tr>
      <td>value 3</td>
      <td>value 4</td>
      <td>value 5</td>
   </tr>
</table> 
```

以下是输出

```
<table>
<tr>
   <th>header value</th>
   <th>header value</th>
   <th>header value</th>
</tr>
<tr>
   <td>value 1</td>
   <td>I Want You</td>
   <td>value 2</td>
</tr>
<tr>
   <td>value 3</td>
   <td>I Added This value 4</td>
   <td>value 5</td>
</tr>
</table> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T14:42:13.490

您在正确的路线上 - 您只需要在输出节点时执行一个条件，以便在 TD 节点的情况下，检查同一索引处的表亲 TH 节点是否具有所需的文本。

```
<xsl:template match="*|@*">
    <xsl:variable name='curr_pos' select='position()' />
    <xsl:copy>
        <xsl:apply-templates select='@*' />
        <xsl:if test='name() = "td" and /table/tr[1]/th[$curr_pos] = "I Want You"'>prefix - </xsl:if>
        <xsl:value-of select='text()' />
        <xsl:apply-templates select='*' />
    </xsl:copy>
</xsl:template> 
```

您可以在[这个游乐场会话](http://www.xmlplayground.com/uo6iNO)中运行它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T02:47:01.253

**可能是最短和最简单的转换（没有`preceding-sibling::`，没有`position()`，没有条件指令，没有变量）**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="tr/*[2]/text()[not(. = 'I Want You')]">
  <xsl:value-of select="concat('I Added This ', .)"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<table>
    <tr>
        <th>header value</th>
        <th>I Want You</th>
        <th>header value</th>
    </tr>
    <tr>
        <td>value 1</td>
        <td>value 2</td>
        <td>value 3</td>
    </tr>
    <tr>
        <td>value 4</td>
        <td>value 5</td>
        <td>value 6</td>
    </tr>
</table> 
```

**产生了想要的正确结果：**

```
<table>
   <tr>
      <th>header value</th>
      <th>I Want You</th>
      <th>header value</th>
   </tr>
   <tr>
      <td>value 1</td>
      <td>I Added This value 2</td>
      <td>value 3</td>
   </tr>
   <tr>
      <td>value 4</td>
      <td>I Added This value 5</td>
      <td>value 6</td>
   </tr>
</table> 
```

**说明**：

1.  身份规则“按原样”复制每个匹配的节点。

2.  有一个覆盖模板。它匹配字符串值不是字符串的任何文本节点，`'I Want You'` *并且*该节点是任何元素的子节点（因此两者都匹配），`th`并且`td`是 a 的第二个子元素`tr`。此模板输出字符串的串联`'I Added This '`和当前（匹配）节点的字符串值。

**请注意**：这是一个 XSLT 1.0 解决方案，但它与 XSLT 2.0 处理器的工作原理相同，完全没有任何变化。`version`将 的属性更改`xsl:stylesheet`为“2.0”是安全的（如果需要） 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T15:09:18.060

谢谢蒂姆C！它就像一个魅力，它是一个非常好的解决方案！虽然如果文档中有多个表格我会遇到一些小问题，但我会在上面应用此样式表。它还会在不包含“我想要你”值的表中添加值。有什么解决方法吗？我尝试选择所有表，然后单独运行其列，但这导致没有输出。

```
<xsl:template match="//table">
  <xsl:for-each select="/tr/*">
    <xsl:variable name="position" select="position()" />
    <xsl:copy>
        <xsl:apply-templates select="@*"/>
        <xsl:if test="../preceding-sibling::tr/*[position() = $position][contains(lower-case(.), lower-case($match))]">
            <xsl:value-of select="concat($add, ' ')" />
        </xsl:if>
        <xsl:apply-templates select="text()"/>
    </xsl:copy>
  </xsl:for-each>
</xsl:template> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-20T15:16:20.790

此样式表（也适用于 XSLT 1.0）...

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" indent="yes"/>

<xsl:template match="@*|node()">
 <xsl:copy>
  <xsl:apply-templates select="@*|node()"/>
 </xsl:copy>
</xsl:template>

  <xsl:template match="td">
  <xsl:variable name="col" select="count(preceding-sibling::td)+1" /> 
  <xsl:copy>
   <xsl:apply-templates select="@*"/>
   <xsl:if test="contains(../../tr[1]/th[$col], 'I Want You')">
     <xsl:value-of select="'I Added This '" /> 
   </xsl:if>  
   <xsl:apply-templates select="node()"/>
 </xsl:copy>
</xsl:template>

</xsl:stylesheet> 
```

...当应用于您的样本输入时，将产生您所需的输出。

蒂姆的回答是不正确的，或者至少不是始终正确的。position() 函数很棘手。问题是 position() 包括空白节点和您可能在 html 表中拥有的其他非表内容，例如微数据格式。如果标题行中的空白与数据行不同，则 Tim C 的解决方案将不起作用。count() 是必需的。

我故意留下了小写（）位。我将测试的琐碎细节留给 OP。

这里还有一个更简单的 XSLT 2.0 解决方案......

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" indent="yes"/>

<xsl:template match="@*|node()">
 <xsl:copy>
  <xsl:apply-templates select="@*|node()"/>
 </xsl:copy>
</xsl:template>

  <xsl:template match="td[
     for $col in position() return
       contains(../../tr[1]/th[$col], 'I Want You')]">
  <xsl:copy>
   <xsl:apply-templates select="@*"/>
   <xsl:value-of select="'I Added This '" /> 
   <xsl:apply-templates select="node()"/>
 </xsl:copy>
</xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-21T21:00:37.870

这是一个简短而正确的答案，它可以处理任何形式的“我想要这个”，`<th>`并且可以在具有大量此类表格的文档中使用（如果它们在语义上是正确的）。

**当这个 XSLT：**

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output omit-xml-declaration="no" indent="yes"/>
  <xsl:strip-space elements="*"/>

  <!-- Template #1 - Identity Template -->
  <xsl:template match="node()|@*">
    <xsl:copy>
      <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>
  </xsl:template>

  <!-- Template #2 -->
  <xsl:template match="tr[position() &gt; 1]/td[position() = count(../../th[. = 'I Want You']/preceding-sibling::th) + 1]/text()">
    <xsl:value-of select="concat('I Added This ', .)" />
  </xsl:template>

</xsl:stylesheet> 
```

**应用于此 XML 文档：**

```
<table>
  <tr>
    <th>header value</th>
    <th>I Want You</th>
    <th>header value</th>
  </tr>
  <tr>
    <td>value 1</td>
    <td>value 2</td>
    <td>value 3</td>
  </tr>
  <tr>
    <td>value 4</td>
    <td>value 5</td>
    <td>value 6</td>
  </tr>
</table> 
```

**产生了想要的结果：**

```
<?xml version="1.0" encoding="UTF-8"?>
<table>
  <tr>
    <th>header value</th>
    <th>I Want You</th>
    <th>header value</th>
  </tr>
  <tr>
    <td>value 1</td>
    <td>I Added This value 2</td>
    <td>value 3</td>
  </tr>
  <tr>
    <td>value 4</td>
    <td>I Added This value 5</td>
    <td>value 6</td>
  </tr>
</table> 
```

请注意，如果您`<table>`的文档中有多个这样的元素，那么这个 XSLT 也涵盖了这种情况。这不是您特别要求的，但它不在可能性范围之外，所以我想我会涵盖它。

**XML:**

```
<body>
  <table>
    <tr>
      <th>header value</th>
      <th>I Want You</th>
      <th>header value</th>
    </tr>
    <tr>
      <td>value 1</td>
      <td>value 2</td>
      <td>value 3</td>
    </tr>
    <tr>
      <td>value 4</td>
      <td>value 5</td>
      <td>value 6</td>
    </tr>
  </table>
  <table>
    <tr>
      <th>I Want You</th>
      <th>header value</th>
      <th>header value</th>
    </tr>
    <tr>
      <td>value 1</td>
      <td>value 2</td>
      <td>value 3</td>
    </tr>
    <tr>
      <td>value 4</td>
      <td>value 5</td>
      <td>value 6</td>
    </tr>
  </table>
</body> 
```

**结果：**

```
<?xml version="1.0" encoding="UTF-8"?><body>
  <table>
    <tr>
      <th>header value</th>
      <th>I Want You</th>
      <th>header value</th>
    </tr>
    <tr>
      <td>value 1</td>
      <td>I Added This value 2</td>
      <td>value 3</td>
    </tr>
    <tr>
      <td>value 4</td>
      <td>I Added This value 5</td>
      <td>value 6</td>
    </tr>
  </table>
  <table>
    <tr>
      <th>I Want You</th>
      <th>header value</th>
      <th>header value</th>
    </tr>
    <tr>
      <td>I Added This value 1</td>
      <td>value 2</td>
      <td>value 3</td>
    </tr>
    <tr>
      <td>I Added This value 4</td>
      <td>value 5</td>
      <td>value 6</td>
    </tr>
  </table>
</body> 
```

**解释：**

1.  **模板 #1 - 身份模板**- 按原样复制所有内容。我们在后续模板中覆盖此模板。

2.  **模板#2——**这个模板匹配了一个XPath：获取包含在`<td>`元素中的所有文本，其位置与值为“I Want You”的`<th>`元素（在最近的“header”中）匹配。`<tr>`对于这个文本，返回一个新值，它是“我添加了这个”和原始文本的连接。

# html - 列表元素“值”属性

> ID：11121059
> 
> 赞同：1
> 
> 时间：2012-06-20T13:47:05.657
> 
> 标签：html, css

我有一个用 CSS/Javascript 创建的自定义样式下拉选择框，它旨在模仿一个`<select>`元素。该框是一个由元素`<div>`组成的内部列表`<li>`，它反映`<option>`了标准选择框的元素。

现在，一个标准的选择`<option>`元素有两个重要的组成部分：内部文本节点，它是实际显示在屏幕上的下拉菜单，以及一个`value`属性，它是指示选择值的字符串（用于表单提交或Javascript）。

使用我的自定义框，元素内的`<li>`文本节点反映了元素中的内部文本节点`<option>`。但是我应该如何反映“价值”属性？根据[w3schools](http://www.w3schools.com/tags/tag_li.asp)（不是最好的资源，我知道），LI 元素有一个可以使用的“值”属性，但它已被弃用以支持 CSS 样式。但是什么 CSS 属性可以用来表示 List 元素的“值”呢？或者有没有更好的方法将值与 LI 元素相关联？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T13:50:41.737

如今，任何以“data-”开头的属性都是有效的 html。因此，您可以执行以下操作：

```
<ul>
    <li data-value="1">Option #1</li>
    <li data-value="754">Option #2</li>
</ul> 
```

这样您就可以在以后轻松访问每个选项的价值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T13:49:54.767

[`data-*`](http://www.w3.org/TR/2011/WD-html5-20110525/elements.html#embedding-custom-non-visible-data-with-the-data-attributes)任何时候需要在元素上存储任意数据时都应该使用 HTML5属性：

```
<li data-value="something">Some text</li> 
```

* * *

边注：

> 盒子是一个由元素`<div>`组成的内部列表`<li>`

我希望你有一个`ul`（或`ol`，或`menu`）元素作为这些元素的父`li`元素！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T13:50:01.487

“但是可以使用什么 CSS 属性” 没有 CSS 属性，因为只有 HTML 属性。

要在任何元素上存储任何数据，您可以使用`data-*`- 属性，例如`<li data-value="some value">`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T13:50:05.203

根据 HTML5 标准，您应该使用**data-***属性

```
<li data-value="value">Text here</li> 
```

# c# - WPF 中的多页 FlowDocument

> ID：11121063
> 
> 赞同：0
> 
> 时间：2012-06-20T13:47:16.587
> 
> 标签：c#, wpf, xaml, flowdocument

WPF 文档的初学者在这里。

我正在探索在 WPF 应用程序中逐页显示静态内容的可能性。很像 PowerPoint 演示文稿，可以在其中导航下一个和上一个幻灯片。

从我最初的研究中，我认为 FlowDocument 是我一直在寻找的东西，但是当我需要显示多个可以在下一页和上一页导航的页面时，我陷入了困境。

如果我使用 FlowDocument 的方法正确，任何人都可以指导我，我如何拥有多个页面（或文档）？

这对我来说是一个单页：

```
<FlowDocumentReader  HorizontalAlignment="Stretch" VerticalAlignment="Stretch" >
        <FlowDocument PagePadding="0" ColumnWidth="999999">
            <Paragraph  Style="{StaticResource headerText}" TextAlignment="Center" >
                <Bold>AGENDA</Bold>
            </Paragraph>
            <List StartIndex="1" MarkerStyle="Decimal" Style="{StaticResource normalText}" MarkerOffset="20" TextAlignment="Left">
                <ListItem>
                    <Paragraph>XAML</Paragraph>
                </ListItem>
                <ListItem>
                    <Paragraph>Layouts in WPF</Paragraph>
                    <List StartIndex="1" Margin="0"  MarkerStyle="Decimal" Style="{StaticResource subText}" MarkerOffset="20" TextAlignment="Left">
                        <ListItem>
                            <Paragraph>Controls</Paragraph>
                        </ListItem>
                        <ListItem>
                            <Paragraph>Styles</Paragraph>
                        </ListItem>
                        <ListItem>
                            <Paragraph>Templates</Paragraph>
                        </ListItem>
                    </List>
                </ListItem>
                <ListItem>
                    <Paragraph>Binding</Paragraph>
                    <List StartIndex="1" Margin="0" MarkerStyle="Decimal" Style="{StaticResource subText}" MarkerOffset="20" TextAlignment="Left">
                        <ListItem>
                            <Paragraph>DependencyObject</Paragraph>
                        </ListItem>
                        <ListItem>
                            <Paragraph>DependencyProperty</Paragraph>
                        </ListItem>
                    </List>
                </ListItem>
            </List>
        </FlowDocument>
    </FlowDocumentReader> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:08:15.547

我认为最简单的方法就是在视图模型中绑定一个“CurrentPage”变量的内容控件。IE

```
private UserControl _currentpage
public UserControl CurrentPage { 
    get
    {
        return _currentpage;
    }
    set
    {
       if (PropertyChanged != null)
           PropertyChanged(this, new PropertyChangedEventArgs("CurrentPage"));
    } 
}

public ViewModel()
{
    CurrentPage = new FirstPage();
}

private void NextPageExecuted(object parameter)
{
     //Logic that picks the next page from a set of pages
}

private void PrevPageExecuted(object parameter)
{
     //Logic that picks the previous page from a set of pages
} 
```

然后在 xaml 中放一个通用的内容控件

```
<ContentControl Content="{Binding CurrentPage}" /> 
```

然后只需定义一个用户控件来定义您想要查看的每个页面，FirstPage 可能是您粘贴在那里的代码。

# xquery - 如何将多个文件上传到xquery中的文件夹？

> ID：11121069
> 
> 赞同：-1
> 
> 时间：2012-06-20T13:47:37.403
> 
> 标签：xquery, marklogic

如何将多个文件上传到 xquery 中的文件夹？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T16:06:48.273

您是否尝试遍历文件系统上的目录并将这些文件插入到数据库中的某个位置，就像这样？

```
for $e in xdmp:filesystem-directory('c:\my-files\')/dir:entry
let $file := xdmp:filesystem-file($e/dir:pathname)
let $dest-uri := concat('/dest-path/',$e/dir:filename)
where ($e/dir:type eq 'file')
return xdmp:document-insert($dest-uri,$file) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T20:22:21.693

您应该看看[Information Studio](http://community.marklogic.com/pubs/5.0/books/info_studio.pdf)。它提供了一个用于加载和转换内容的 UI。内置的“收集器”之一允许您指向文件系统目录并递归加载其内容。Information Studio 自动处理目录遍历并将负载分解为多个事务，以及许多其他便利。

# java - 如何在 AutoCompleteField 中获取选定的文本并通过 post 将其发送到服务器

> ID：11121073
> 
> 赞同：0
> 
> 时间：2012-06-20T13:47:46.227
> 
> 标签：java, post, blackberry

我是黑莓开发的新手。我曾多次遇到过这个问题，即“如何将所选项目作为字符串获取”。给出的答案并没有完全回答这个问题：

```
AutoCompleteField autoCompleteField = new AutoCompleteField(filterList)
{
 public void onSelect(Object selection, int SELECT_TRACKWHEEL_CLICK) {
     ListField _list = getListField();
     if (_list.getSelectedIndex() > -1) {
         Dialog.alert("You selected: "+_list.getSelectedIndex());
         // get text selected by user and do something...
     }
 } 
```

关键是*如何*获得选定的文本并“做某事”。想象一下，我想通过 post 将项目作为字符串发送到服务器。我将如何在代码中做到这一点？

谢谢！迈克尔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T07:51:53.767

这些实际上（至少）是两种不同的东西。

要获取所选文本，[请参阅此答案](https://stackoverflow.com/a/2280900/119114)

要发送 HTTP POST 请求，[请参阅this other answer](https://stackoverflow.com/questions/6184223/http-post-in-blackberry)

通常，在 UI 线程上发出网络请求也很糟糕（这将回调您的`onSelect()`方法）。因此，最好从第二个答案中获取 HTTP POST 代码，并将其放在可以在后台线程上运行的对象的`run()`方法中。`Runnable`像这样的东西：

```
private class PostRequest implements Runnable {

  private String _postParam;

  public PostRequest(String param) {
    _postParam = param;
  }

  public void run() {
    // make POST request here, using _postParam
  }
} 
```

并像这样使用它：

```
 AutoCompleteField acf = new AutoCompleteField(list) {
     protected void onSelect(Object selection, int type) {
        super.onSelect(selection, type);
        if (selection != null) {
          String selectionAsString = getEditField().getText();
          Thread worker = new Thread(new PostRequest(selectionAsString));
          worker.start();
        }
     }
  }; 
```

# php - 无法在 XML 文件上插入之前

> ID：11121079
> 
> 赞同：0
> 
> 时间：2012-06-20T13:47:58.620
> 
> 标签：php, xml

我正在尝试编写一个将更新 RSS XML 文件的脚本。我希望它采用现有文件并将新项目添加到项目列表的顶部。我之前已经将它添加到文件的末尾，但现在它目前根本没有添加新项目。我一直在网上检查，但我仍然无法让它工作。这是我到目前为止所拥有的：

```
$rssDoc = new DOMDocument();
$rss_file = $_SERVER['DOCUMENT_ROOT'].'/test_site/feed.xml';
$rssDoc->load($rss_file);
$items = $rssDoc->getElementsByTagName('item');

$newItem = $rssDoc->createElement('item');
$rssTitle = $rssDoc->createElement('title');
$rssTitle->appendChild($rssDoc->createTextNode($title));
$newItem->appendChild($rssTitle);

$rssDesc = $rssDoc->createElement('description');
$rssDesc->appendChild($rssDoc->createTextNode($string));
$newItem->appendChild($rssDesc);

$rssLink = $rssDoc->createElement('link');
$rssLink->appendChild($rssDoc->createTextNode($link));
$newItem->appendChild($rssLink);

$rssDate = $rssDoc->createElement('pubDate');
$rssDate->appendChild($rssDoc->createTextNode($pubDate));
$newItem->appendChild($rssDate);

$firstItem = $items->item(0);
$firstItem->insertBefore($newItem,$firstItem->firstChild);

$rssDoc->formatOutput = true;
echo $rssDoc->saveXML(); 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:05:07.600

“我错过了什么？”

输出： http: `$rssDoc->save( 'filename.xml' )` [//php.net/domdocument.save.php](http://php.net/domdocument.save.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T14:42:14.867

我让它工作了。我改变了这些行：

```
$firstItem = $items->item(0);
$firstItem->insertBefore($newItem,$firstItem->firstChild); 
```

到这一行：

```
$items->item(0)->parentNode->insertBefore($newItem,$items->item(0)); 
```

# ajax - IIS 7.5 上的 Asp .Net MVC4 网站在 ajax 错误响应中出现 HTTP 404 错误

> ID：11121082
> 
> 赞同：3
> 
> 时间：2012-06-20T13:48:12.127
> 
> 标签：ajax, asp.net-mvc, asp.net-mvc-4

```
function girisAjaxKontrol() {
var kullanici = { 'kullaniciAdi': $('#username').val(), 'hidden': $('#password').val() };
$.ajax({
    url: '/Giris/GirisGecerliMi',
    type: 'POST',
    data: kullanici,
    success: girisAjaxReturn,
    error: function (error, textstatus) {
        JSON.stringify(error);
        errorMessage($("div.girisSubmit input"), JSON.stringify(error), false);            
    }
}); 
```

}

这个函数得到下面的错误（它在部署之前工作）。该网站是本地 IIS 7.5 上的 Asp .Net MVC4 网站；我搜索了很多，但仍然无法解决。

```
Server Error in Application \"DEFAULT WEB SITE\"

HTTP Error 404.0 - Not Found

The resource you are looking for has been removed, had its name changed, or is temporarily unavailable.

Module: IIS Web Core
Notification: MapRequestHandler
Handler: StaticFile
Error Code: 0x80070002

Requested URL   http://localhost:80/Giris/GirisGecerliMi
Physical Path   C:\\inetpub\\wwwroot\\Giris\\GirisGecerliMi
Logon Method    Anonymous
Logon User  Anonymous 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T13:51:05.500

```
url: '/Giris/GirisGecerliMi', 
```

不应该像这样硬编码。你应该使用 url helpers 来生成这个 url。原因是当您在 IIS 中部署应用程序时，您应该考虑一个虚拟目录名称，因此正确的 url 是：

```
url: '/MyAppName/Giris/GirisGecerliMi', 
```

但是通过像您一样对 url 进行硬编码，这是无法正常工作的。在 ASP.NET MVC 中，您应该始终使用 url 帮助程序，例如`Url.Action`生成给定控制器操作的 url，因为这些帮助程序不仅考虑您的路由定义，还考虑虚拟目录名称等内容。

所以正确的方法是让这个 url 在服务器端生成并作为参数传递给`girisAjaxKontrol`函数：

```
function girisAjaxKontrol(url) {
    var kullanici = { 'kullaniciAdi': $('#username').val(), 'hidden': $('#password').val() };
    $.ajax({
        url: url,
        type: 'POST',
        data: kullanici,
        success: girisAjaxReturn,
        error: function (error, textstatus) {
            JSON.stringify(error);
            errorMessage($("div.girisSubmit input"), JSON.stringify(error), false);            
        }
    });
} 
```

# java - 无法使用 getResources() 方法访问资源

> ID：11121083
> 
> 赞同：0
> 
> 时间：2012-06-20T13:48:12.970
> 
> 标签：java, getresource

我有以下项目树：

![在此处输入图像描述](../Images/b6f9d3f8097e4573db52a72593ac94a1.png)

我可以使用以下命令访问路径中的 290.gif 文件：**Java GUI/src/dk/resources/290.gif**：

```
this.getClass().getResource("/dk/resources/290.gif") 
```

但我*无法*使用以下命令访问路径中的 290.gif 文件：**Java GUI/resources2/290.gif**：

```
this.getClass().getResource("/resources2/290.gif") 
```

我正在尝试从 HelloWorldFrame.java 类访问 290.gif 文件。我想访问路径中的 290.gif 文件：**Java GUI/resources2/290.gif**！

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T14:05:57.517

您已将`src`和`resources2`目录声明为Eclipse 中的*源文件夹*。当 Eclipse 构建您的应用程序时，它会将资源复制到该`build`文件夹​​，因此：

*   `dk.resources` **包**中的文件可通过以下方式访问`/dk/resources/290.gif`
*   文件`resources2` **夹**中的文件不在任何包中，可以通过以下方式访问`/290.gif`

如果您希望通过 访问该文件，则在该文件夹下`/resources2/290.gif`创建一个名为的包。`resource2``src`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T13:54:03.327

似乎文件夹`src`和`resources2`都在构建路径中。你试过`this.getClass().getResource("/290.gif")`吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T13:58:03.577

在工件的运行时，您可以访问资源

```
InputStream resource = SomeClass.class.getResourceAsStream("<file or directory name")) 
```

或者

```
URL resource = SomeClass.class.getResource("<file or directory name")) 
```

其中 SomeClass 是工件中的一个类。第一种方式会给你一个 InputStream，你可以用它来读取文件的内容，第二种方式会返回一个 URL，你可以用它来找出文件或目录的路径或沿着目录树移动。

# java - Java/Android：传递 Intent Extras，然后在另一种方法上使用它

> ID：11121088
> 
> 赞同：1
> 
> 时间：2012-06-20T13:48:23.783
> 
> 标签：java, android

大家好，
这次我遇到了 Intent & Extras 的问题。

这是我的第一个活动

```
Intent i1 = new Intent(RoomSetting.this, App.class);
i1.putExtra("subposition1", "right");
final int result=1;
startActivityForResult(i1, result); 
```

在第二个活动中，我尝试获得“subposition1”值

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);
    mSensorManager = (SensorManager) getSystemService(SENSOR_SERVICE);
    mAccelerometer = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
    mAccVals = new Number3d(); 
    Bundle extras = getIntent().getExtras();
    String SubPos = extras.getString("subposition1");
} 
```

我的问题是，如何在另一种方法上使用 SubPos？

对不起，noobish 问题。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T13:50:50.347

```
String SubPos;
// declare SubPos String as class variable and you can access anywhere in class<<<
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);
    mSensorManager = (SensorManager) getSystemService(SENSOR_SERVICE);
    mAccelerometer = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
    mAccVals = new Number3d(); 
    Bundle extras = getIntent().getExtras();
    SubPos = extras.getString("subposition1");
}

public void anotherMethod(){
//here you can access it...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T13:51:06.857

之前声明**SubPos**`onCreate`为：

```
public String SubPos=null; // or you can also declare it as static as your need
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);
    mSensorManager = (SensorManager) getSystemService(SENSOR_SERVICE);
    mAccelerometer = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
    mAccVals = new Number3d(); 
    Bundle extras = getIntent().getExtras();
    SubPos = extras.getString("subposition1");
}

   public void testmethod()
   {
      String str=SubPos; //get SubPos value  
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T13:56:26.647

有两种方法可以轻松做到：

第一种方式：为类使用全局变量：

```
 String SubPos;
   public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);
    mSensorManager = (SensorManager) getSystemService(SENSOR_SERVICE);
    mAccelerometer = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
    mAccVals = new Number3d(); 
    Bundle extras = getIntent().getExtras();
    SubPos = extras.getString("subposition1"); //note that I've deleted the 'String'
} 
```

2n方式：将变量传递给方法：

```
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);
    mSensorManager = (SensorManager) getSystemService(SENSOR_SERVICE);
    mAccelerometer = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
    mAccVals = new Number3d(); 
    Bundle extras = getIntent().getExtras();
    String SubPos = extras.getString("subposition1");
    otherMethod(SubPos);
}

public void otherMethod(String s) {
    //do stuff.
} 
```

我认为也许你想在另一个类中使用这个变量，然后你可以添加这个函数（在类中将 String SubPos 作为全局）：

```
 String SubPos;
   public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);
    mSensorManager = (SensorManager) getSystemService(SENSOR_SERVICE);
    mAccelerometer = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
    mAccVals = new Number3d(); 
    Bundle extras = getIntent().getExtras();
    SubPos = extras.getString("subposition1"); //note that I've deleted the 'String'
   }
    public String getSubPos() {
        return SubPos;
    } 
```

这样，您可以在任何其他具有该实例的类中调用 instanceOfTheClass.getSubPos()。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-20T13:56:36.990

代替

```
Bundle extras = getIntent().getExtras();
String SubPos = extras.getString("subposition1"); 
```

和

```
String SubPos = getIntent().getStringExtra("subposition1"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-20T14:14:49.777

只需在您的“其他方法”上调用它即可。

```
String subposition = getIntent().getStringExtra("subposition1"); 
```

# xpath - 使用 XPath/XQuery 获取元素名称

> ID：11121089
> 
> 赞同：9
> 
> 时间：2012-06-20T13:48:27.170
> 
> 标签：xpath, xquery

拥有以下 XML 示例文档，我需要发出 XPath/XQuery 表达式来获取 CD 元素的每个子元素的元素名称。

```
<CD>
  <TITLE>Empire Burlesque</TITLE>
  <ARTIST>Bob Dylan</ARTIST>
  <COUNTRY>USA</COUNTRY>
  <COMPANY>Columbia</COMPANY>
  <PRICE>10.90</PRICE>
  <YEAR>1985</YEAR>
</CD> 
```

所以我需要查询返回 TITLE, ARTIST, COUNTRY, COUNTRY, PRICE, YEAR ，有人可以帮忙吗？谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-20T15:09:34.103

```
/CD/*/name() 
```

（因为 StackOverflow 不喜欢简短的答案而被填充）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-04-14T17:29:19.447

尝试`/\*/name()`
例如供 Oracle 使用

```
XMLCast(XMLQuery('/*/name()' PASSING db_some_field_name RETURNING CONTENT) AS VARCHAR2(4000)) 
```

# wix - 在wix而不是文件中将文件夹添加到安装程序？

> ID：11121092
> 
> 赞同：5
> 
> 时间：2012-06-20T13:48:44.407
> 
> 标签：wix, wix3.5, wix3

我的安装程序必须将文件复制到 installdir... 我的应用程序有大约 2000 个文件，我无法编写脚本来将每个文件都添加到安装程序中。wix 中是否有任何选项，以便我可以一次添加所有文件或包含文件的整个文件夹？我是wix的新手，我在任何教程中都没有找到任何选项......请帮助我并提前感谢......

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-20T13:59:20.500

Heat 是[WiX 的收获工具](http://wix.sourceforge.net/manual-wix3/heat.htm)。您可以在目录上运行它以生成必要的 WiX 源代码。

编辑：如果您想在 VS 项目构建之前运行 heat，请将其添加到您的项目预构建事件中，如下面的屏幕截图所示（这就是我的项目设置为我们不断变化的帮助内容动态生成 W​​iX 源的方式）： ![VS 构建事件](../Images/8ba9c3dd52fb4f7e7c5d2cc9a7c0e299.png)

请注意`-var wix.HelpSource`我的开关。heat 生成的 WiX 源文件会将源文件的位置设置为该变量，而不是对其进行硬编码。因此生成的源代码将具有如下所示的组件：

```
<Component Id="Welcome.htm" Directory="Content" Guid="INSERT-GUID-HERE">
  <File Id="Welcome.htm" KeyPath="yes" Source="!(wix.HelpSource)\Content\Welcome.htm" />
</Component> 
```

在我的特殊情况下，我在我的 WiX VS 项目的工具设置屏幕上将该变量定义为相对目录`..\..\Help\Output`，如下所示： ![在此处输入图像描述](../Images/9ad9812bc57a2c21511ad5b9350e16ab.png)

**注意：**以这种方式收集文件将导致每次构建时收集的组件的 GUID 都会发生变化。如果您不希望您的 GUID 更改，您可能必须编写一些调用 heat 来收集文件的包装器，然后更新您的原始 WiX 源，而不管所有 GUID。

# android - 更改屏幕方向时如何保存 WebView

> ID：11121094
> 
> 赞同：1
> 
> 时间：2012-06-20T13:48:52.203
> 
> 标签：android, android-webview

在我的应用程序中，我仅使用 WebView 来加载 index.html，其中运行所有应用程序逻辑（html 和 javascript）。

当屏幕方向发生变化时，来自 JavaScript 变量的所有数据都会消失。

方向改变时如何保存所有数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T14:16:43.210

您必须自己捕捉方向变化并处理它们，因为默认情况下会重新创建 Activity（并且您的 WebView 将被重新加载）。

[`android:configChanges`](http://developer.android.com/guide/topics/manifest/activity-element.html#config)在 AndroidManifest.xml中将属性添加到您的 Activity

```
<activity ... android:configChanges="orientation|keyboardHidden|keyboard"> 
```

并覆盖`onConfigurationChanged`Activity 类中的方法。

```
@Override
public void onConfigurationChanged(Configuration newConfig){
    super.onConfigurationChanged(newConfig);
} 
```

也看看这里：[Activity restart on rotation Android](https://stackoverflow.com/questions/456211/activity-restart-on-rotation-android)

# php - 在基于移动的社交应用程序中记录消息的最佳方式

> ID：11121095
> 
> 赞同：0
> 
> 时间：2012-06-20T13:49:00.813
> 
> 标签：php, logging, concurrency

我正在开发社交应用程序的后端部分。客户端是 iOS/Android 手机。后端代码是一个向客户端提供 REST API 的 PHP 应用程序。

我正在使用一个简单的日志系统，具有多个日志级别和不同的日志编写器。更简单的编写器是 FileWriter。所有日志消息都转到每天更改的日志文件中。至少到目前为止，日志文件不会用于分析目的。只记录错误和用户的重要操作（主要是数据库访问）

我很担心，因为如果用户群快速增长，我认为写入文件是一种瓶颈，原因有两个：

*   磁盘写入开销
*   ¿ 并发？

关于第二点，我有疑问。如果怀疑是愚蠢的，我很抱歉：我正在使用带有 Prefork MPM 的 Apache。至于使用不同进程处理不同客户端的请求，当两个进程尝试将消息记录到同一个文件时，不存在并发问题。操作系统（Ubuntu 11.10）处理这个问题。我对吗？

即使在那种情况下，当我不必担心并发写入文件时，这是一个好主意吗？是不是太慢了？

提前谢谢了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T13:54:47.287

只要您以附加模式打开文件就可以了。请注意，只要您想要持久的日志文件，它们就必须在某个时候转到磁盘上的文件。使用 DBMS 完全没有意义，因为它只是文件系统之上的另一层。只要您没有在禁用缓存的情况下打开文件，操作系统就应该处理 I/O 调度并成批写入内容。

# .net - 使用 WebRequest 时的超时究竟是什么？

> ID：11121096
> 
> 赞同：1
> 
> 时间：2012-06-20T13:49:06.930
> 
> 标签：.net, webclient

MSDN 状态[WebRequest.Timeout](http://msdn.microsoft.com/en-us/library/system.net.webrequest.timeout.aspx)表示

> 直到请求超时的时间长度（以毫秒为单位），或者值 Timeout.Infinite 指示请求不会超时。

究竟什么是“超时”？这是类在返回第一个字节之前等待的最长时间吗？它是完成整个请求的最长时间吗？是别的吗？

我之所以问，是因为我正在使用[修改后的 WebClient](https://stackoverflow.com/a/3052637/141172)从有时会打嗝并且需要几分钟到几小时才能开始发送响应的源下载相当大的（~1GB）文件。我想设置超时，以便成功传输（可能需要长达 20 分钟，具体取决于连接质量）不会超时，但理想情况下偶尔的打嗝会很快超时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T14:15:52.247

[在 C# 中调整 HttpWebRequest 连接超时](https://stackoverflow.com/questions/1500955/adjusting-httpwebrequest-connection-timeout-in-c-sharp)的不被接受的答案引导我检查[ReadWriteTimeout](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.readwritetimeout.aspx)属性，该属性指出

> 具体来说，ReadWriteTimeout 属性控制 Read 方法（用于读取 GetResponseStream 方法返回的流）和 Write 方法（用于写入 GetRequestStream 方法返回的流）的超时。
> 
> 要指定等待请求完成的时间量，请使用 Timeout 属性。

# sharepoint - 对特定列表项求和并将总和值分配到不同的列表中

> ID：11121100
> 
> 赞同：1
> 
> 时间：2012-06-20T13:49:21.283
> 
> 标签：sharepoint, sharepoint-2010

好的，这是我的场景：

我有 2 个自定义列表：**订单和项目**。项目**列表**包含一个字段**描述**（文本）和一个**每项目金额**字段（计算）。**Orders 列表**包含一个**Total amount**字段和一个**Items**字段（在允许选择多个值的项目中的描述字段上查找）。

这是一个更直观的解释：

> 1.  **订单**
>     
>     
>     *   总金额
>     *   项目（在允许选择多个值的项目中查找描述字段）
> 2.  **项目**
>     
>     
>     *   说明（文字）
>     *   每件金额

我想**从 Orders 的 Items 查找字段**中对所选项目的**Amount per Item字段****求和**，并将总和的值放在**Orders 的总金额字段中**

 ******有什么建议么？是否可以在没有代码的 SharePoint 2010 中执行此操作？如果没有，你能展示一下代码的样子吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T13:57:23.153

你可以试试

```
OrderList.Total = OrderList.Items.Sum(item => item.AmountPerItem); 
```******

# assemblies - ADOMD.net x64 与 x86 程序集？

> ID：11121108
> 
> 赞同：1
> 
> 时间：2012-06-20T13:49:32.753
> 
> 标签：assemblies, ssas, adomd.net

有谁知道 ADOMD.net 的 x64 和 x86 安装是否包含不同的程序集？我已经安装了两者，它们都包含看起来完全相同的程序集`Microsoft.AnalysisServices.AdomdClient.dll`，一个在 [Program Files] 中，另一个在 [Program Files (x86)] - 相同的版本号，完全相同的大小，所以我假设程序集是为“任何 CPU”编译的，可以在任一平台上互换使用。

# gwt - 访问页面时出现IE错误？

> ID：11121115
> 
> 赞同：0
> 
> 时间：2012-06-20T13:49:53.483
> 
> 标签：gwt

我有 GWT 应用程序。我正在使用 IE8。当我尝试以托管模式访问页面时，出现以下错误。如何解决？

![在此处输入图像描述](../Images/d5a75c04c840f84c0a9181f72035e671.png)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T13:58:02.700

IE6、IE7、IE8有很多bug。尝试在“Pretty”或“Detailed”javascript 中编译您的项目并查看错误所在行。然后尝试在谷歌中找到这个方法。如果你很幸运，你会找到解决方案。它帮助了我好几次。但有时 IE 中的错误 GWT 并没有得到解决。

# python - 我收到错误 No JSON object could be decoded but with a valid JSON file

> ID：11121117
> 
> 赞同：2
> 
> 时间：2012-06-20T13:49:55.650
> 
> 标签：python, django

我正在使用 Django-Smuggler 将 JSON 数据上传到我的数据库。

当我加载 JSON 文件时，出现错误：`No JSON object could be decoded`

我使用在线 JSON 验证器来确保数据有效并且确实有效。我通过数据转储获得了这些数据。

有谁知道为什么会这样？

这是引发异常的地方（加星标）：

```
try:
    for format, stream in data:
        objects = serializers.deserialize(format, stream)
        for obj in objects:
            model = obj.object.__class__
            if router.allow_syncdb(using, model):
                models.add(model)
                counter += 1
                obj.save(using=using)
    if counter > 0:
        sequence_sql = connection.ops.sequence_reset_sql(style, models)
        if sequence_sql:
            for line in sequence_sql:
                cursor.execute(line)
**except Exception, e:**
    transaction.rollback(using=using)
    transaction.leave_transaction_management(using=using)
    raise e 
```

这里也是我的 JSON 文件的一般格式：

```
[
  {
"pk": 1, 
"model": "auth.message", 
"fields": {
  "message": "Successfully uploaded a new avatar.", 
  "user": 1
}
      }, 
  {
"pk": 2, 
"model": "auth.message", 
"fields": {
  "message": "You have saved model 'mymodel'", 
  "user": 1
}
  }, 
      {
"pk": 3, 
"model": "auth.message", 
"fields": {
  "message": "You have saved model 'sdfsd'", 
  "user": 1
}
  }, 
  {
"pk": 4, 
"model": "auth.message", 
"fields": {
  "message": "Successfully uploaded a new avatar.", 
  "user": 1
}
  }, 
  {
"pk": 5, 
"model": "auth.message", 
"fields": {
  "message": "Successfully updated your avatar.", 
  "user": 1
}
  }
] 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-20T14:27:06.363

您需要删除 JSON 字符串中的最后一个 ',' 字符。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-01T00:58:49.467

我对此有点晚了，但您的 JSON 文件可能不是那么有效，即使它通过了 jsonlint。**检查它是否使用没有 BOM**编码的 UTF-8 。

# android - Android：使用 DownloadManager 类下载应用程序

> ID：11121121
> 
> 赞同：2
> 
> 时间：2012-06-20T13:50:04.577
> 
> 标签：android, download

我正在尝试使用`DownloadManager`该类在 Android 中下载非市场应用程序。我正在做的是以下内容：

```
DownloadManager dm = (DownloadManager) getSystemService(DOWNLOAD_SERVICE);
Request request = new Request(Uri.parse("PATH_TO_MY_APP"));
long enqueue = dm.enqueue(request); 
```

通知栏显示正在下载该应用程序。但我无法安装它或在设备上找到它。我做错了什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-21T20:09:03.950

同样的问题。通过调用解决：

```
public DownloadManager.Request setDestinationUri (Uri uri) 
```

您需要拥有 WRITE_EXTERNAL_STORAGE 权限。

```
Uri src_uri = Uri.parse("http://your.url.here/File.apk");
Uri dst_uri = Uri.parse("file:///mnt/sdcard/download/File.apk");

DownloadManager.Request req = new DownloadManager.Request(src_uri);
req.setDestinationUri(dst_uri);
DownloadManager dm = (DownloadManager) getSystemService(DOWNLOAD_SERVICE);
dm.enqueue(req); 
```

# python - 非常简单的数学游戏的答案总是错误的 - Python

> ID：11121124
> 
> 赞同：1
> 
> 时间：2012-06-20T13:50:09.523
> 
> 标签：python, math, if-statement, python-3.x

这是我的脚本：

```
from random import *
from turtle import *

while True: 
    r1 = randint(1,20)
    r2 = randint(1,20)

    # ... ask the question ... then

    a = textinput("Answer?", "")

    if a == r1 * r2:
        write("Well done", font = ("Comic Sans MS", 30, "bold"))
    else:
        write("WRONG", font = ("Comic Sans MS", 30, "bold")) 
```

游戏非常简单。它选择了太随机的数字并要求您将它们相乘。你得到正确的答案，你的分数就会上升。回答错了你的分数就会下降。当我输入正确的答案时，它仍然出现“错误”，我想也许我正在以不同的方式执行 ifs，或者由于随机数它可能无法正常工作。有没有人知道我的脚本有什么问题。谢谢 ：）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-20T13:52:25.010

`r1 * r2`是一个整数。

`a`是一个字符串。

转换`a`为整数并进行比较。

转换为整数很简单：

```
s = int(a) 
```

但是， a`ValueError`可以提出并且必须处理。

# mysql - 为什么此查询返回太多结果？

> ID：11121127
> 
> 赞同：3
> 
> 时间：2012-06-20T13:50:23.247
> 
> 标签：mysql

我有一个mysql查询

```
Select * from tbl_schoolphotos where Filename like 
         'glasshouse_1_%' order by DateTaken 
```

我想匹配

*   温室_1_20122204123455
*   温室_1_20122206102415

但不是

*   温室_18_20122206102415

但它匹配所有三个。有谁知道为什么？_在mysql中有特殊含义吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T13:52:54.343

因为下划线匹配任何单个字符

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-20T13:55:12.000

请求必须转义下划线才能正常工作。

```
 Select * from tbl_schoolphotos where Filename like 
             'glasshouse\_1\_%' order by DateTaken 
```

信息：LIKE 和 NOT LIKE 有两个搜索助手符号。查找一个字符的下划线 _ 字符和查找零个或多个字符的百分比 % 字符。

而且您不希望下划线成为搜索助手，您必须使用`\`like对其进行转义`\_`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-20T13:53:51.333

是的，`_`在 MySQL 中 LIKE 只匹配一个字符。

# javascript - Javascript 中的多个标记信息窗口

> ID：11121128
> 
> 赞同：0
> 
> 时间：2012-06-20T13:50:30.100
> 
> 标签：javascript, google-maps, google-maps-markers, infowindow

谈到 Javascript，我是个菜鸟，但我正在为我的网站/学校项目尝试一些东西。

在地图上，我想显示 2 个位置，每个位置都有一个标记和一个自己的信息窗口。1 显示我的位置 + 联系方式，第二个标记应显示公司的其他详细信息。

我已经设法在地图中获得 2 个标记以显示在我想要的位置，但下一个问题是给每个标记它自己的信息窗口。

var Rafael = 新的 google.maps.LatLng(52.341949,6.682236); var Aandagt = 新的 google.maps.LatLng(52.341949,6.782236);

```
var myOptions = {
    zoom: 10,
    center: new google.maps.LatLng(52.341949,6.682236),
    streetViewControl: false,
    zoomControl: false,
    panControl: false,
    scaleControl: false,
    overviewMapControl: false,
    mapTypeControl: false,
    mapTypeId: google.maps.MapTypeId.TERRAIN
};

var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

var marker = new google.maps.Marker({
    position: Rafael,
    map: map,
    title:"Rafael"
}); 

var marker = new google.maps.Marker({
    position: Aandagt,
    map: map,
    title:"Aandagt"
}); 

var infowindow = new google.maps.InfoWindow({
    content: '<h9><a href="http://www.aandagt.nl">AANDAGT Reclame & Marketing</a></h9><h10><br /><br />Einsteinstraat 8b<br />7601 PR Almelo<br /><br />Telefoon (0546) 85 03 69<br />Fax (0546) 45 53 31<br /><br /><a href="mailto:info@aandagt.nl">info@aandagt.nl</a></h10>'
})

google.maps.event.addListener(marker, 'mouseover', function() {
  infowindow.open(map,marker);
});

google.maps.event.addListener(marker, 'click', function() {
  infowindow.close(map,marker);
}); 
```

任何有关如何添加和附加 2 个 InfoWindows、1 个用于标记“Rafael”和 1 个用于标记“Aandagt”的帮助或建议将不胜感激。

查看我当前的地图：[http ://www.imrafaelhi.nl/stageverslag/?page_id=266](http://www.imrafaelhi.nl/stageverslag/?page_id=266)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-10T04:53:17.990

您可以为每个标记提供 id ..并且可以使用它们的 id 访问这些标记：

```
var marker = new google.maps.Marker({
  position:mycenter,
  title:infoName,
  id: count++
  // animation:google.maps.Animation.BOUNCE
  });

 if(marker.id == count) //get access to marker id value..
 {
     //do what you want..
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:26:44.480

您已经为名为 Rafael 的标记创建了 2 个具有不同位置值的标记和一个鼠标悬停侦听器。

我建议您将标记声明为：marker1 和 marker2。

然后为与每个标记关联的每个信息窗口创建 2 个内容字符串变量：content1、content2

为每个标记添加一个侦听器（鼠标悬停）以显示内容字符串。添加一个侦听器（mouseout）以关闭与标记关联的信息窗口。

```
google.maps.event.addListener(marker, 'mouseover', function() {
infowindow.open(map, this);
});

// assuming you also want to hide the infowindow when user mouses-out
google.maps.event.addListener(marker, 'mouseout', function() {
infowindow.close();
}); 
```

# c# - 以高压缩级别压缩 JP2 (JPEG2000) 图像

> ID：11121129
> 
> 赞同：4
> 
> 时间：2012-06-20T13:50:33.533
> 
> 标签：c#, .net, http-compression, image-conversion, jpeg2000

从数据库中读取图像后，我需要将该图像转换为 JP2 (JPEG2000)

更新：

我使用 FreeImage 将图像转换为 JP2

```
 // Load bitmap           
   FIBITMAP dib = FreeImage.LoadEx(imageName);
// Check success
if (dib.IsNull)
{
    MessageBox.Show("Could not load Sample.jpg", "Error");
    return;
}    

// Convert Bitmap to JPEG2000 and save it on the hard disk
FreeImage.Save(FREE_IMAGE_FORMAT.FIF_JP2, dib, "Image.jp2", FREE_IMAGE_SAVE_FLAGS.DEFAULT);

// Unload source bitmap
FreeImage.UnloadEx(ref dib); 
```

现在，我需要以高压缩级别压缩此图像！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T17:30:49.443

***我找到了答案***

```
 // Load bitmap           
   FIBITMAP dib = FreeImage.LoadEx(imageName);
    //
    Check success
    if (dib.IsNull)
    {
        MessageBox.Show("Could not load Sample.jpg", "Error");
        return;
    }    

    // Convert Bitmap to JPEG2000 and save it on the hard disk
    FreeImage.Save(FREE_IMAGE_FORMAT.FIF_JP2, dib, "Image.jp2", FREE_IMAGE_SAVE_FLAGS.EXR_PXR24 | FREE_IMAGE_SAVE_FLAGS.EXR_LC);

    // Unload source bitmap
    FreeImage.UnloadEx(ref dib); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-20T15:53:27.923

JP2（和 J2K）格式的标志被简单地解释为缩减因子。这来自 PluginJP2.cpp 源

```
// if no rate entered, apply a 16:1 rate by default
if(flags == JP2_DEFAULT) {
    parameters.tcp_rates[0] = (float)16;
} else {
    // for now, the flags parameter is only used to specify the rate
    parameters.tcp_rates[0] = (float)(flags & 0x3FF);
} 
```

因此，您实际上可以指定高达 1023:1 的减少率：

```
// Load bitmap           
FIBITMAP dib = FreeImage.LoadEx(imageName);
// Check success
if (dib.IsNull)
{
    MessageBox.Show("Could not load Sample.jpg", "Error");
    return;
}    

// Convert Bitmap to JPEG2000 and save it on the hard disk
FreeImage.Save(FREE_IMAGE_FORMAT.FIF_JP2, dib, "Image.jp2", (FREE_IMAGE_SAVE_FLAGS)1023);

// Unload source bitmap
FreeImage.UnloadEx(ref dib); 
```

这将为您提供一个非常小质量非常低的文件。

# asp.net - 是否可以在 Local.config 文件中同时覆盖 appSettings 和 connectionStrings？

> ID：11121135
> 
> 赞同：1
> 
> 时间：2012-06-20T13:50:48.037
> 
> 标签：asp.net, web-config

我们目前`appSettings`在每个开发人员的 Local.config 文件中覆盖我们的 web.config。但是，我们还需要覆盖连接字符串，因此我们访问我们机器上的本地副本，而 web.config 可能会引用生产服务器。我知道您可以通过指定来覆盖 appSettings `file="Local.config"`，但是对于 connectionStrings 也可以这样做吗？我们已经为连接字符串使用了一个外部文件，但这个文件包含所有三个连接字符串（本地开发人员、开发人员和生产人员）。

我想做的是将connectionString默认为生产，但在开发人员的机器和开发服务器上被覆盖。但是，这似乎不可能，因为与 appSettings 不同，当您告诉它使用外部文件时，您无法为 connectionStrings 指定值。

这是否可以在无需添加额外代码的情况下实现？

我应该注意，我**目前无法**使用配置转换，因为我们在 ASP.NET 3.5 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T15:50:20.850

在主应用程序配置文件中，您使用 configSource 属性来指定外部文件的完全限定名称和位置。此示例引用了一个名为 connections.config 的外部配置文件。

```
<?xml version='1.0' encoding='utf-8'?>
<configuration>
    <connectionStrings configSource="connections.config"/>
</configuration> 
```

有关详细信息，请访问msdn 上的[此链接](http://msdn.microsoft.com/en-us/library/ms254494.aspx)（部分：使用外部配置文件）

# wordpress - 修剪侧面裸露的标题

> ID：11121139
> 
> 赞同：0
> 
> 时间：2012-06-20T13:51:00.330
> 
> 标签：wordpress

我的 wordpress 主题具有“将帖子保存为收藏夹”功能。并将该帖子标记为侧栏的最爱。但它不会缩短标题。侧边栏的长标题看起来很乱。在我使用的功能中：

```
 function short_title( $after = '', $length ) {
        $mytitle = get_the_title();
        if( mb_strlen( $mytitle ) > $length ) {
            $mytitle = mb_substr( $mytitle, 0, $length );
            echo $mytitle . $after;
        } else echo $mytitle;
    } 
```

我称之为：

```
<?php short_title( '...', 99 ); ?> 
```

我怎样才能把short_title放在这里：

```
 echo '</p>';
        echo '<h4><a href="' . $curr_perma . '" rel="nofollow">' . stripslashes( strip_tags( $post_obj_fave->post_title ) ) . '</a></h4>';
        echo '<p class="info">'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T12:02:30.967

您需要将缩短标题功能应用于`$post_obj_fave->post_title`

所以改变你的代码：

```
echo '<h4><a href="' . $curr_perma . '" rel="nofollow">' . stripslashes( strip_tags( $post_obj_fave->post_title ) ) . '</a></h4>'; 
```

至：

```
echo '<h4><a href="' . $curr_perma . '" rel="nofollow">' . stripslashes( strip_tags( shorten_title($post_obj_fave->post_title, $length=99) ) ) . '</a></h4>'; 
```

现在为`shorten_title()`

这里是：

```
 function shorten_title($var, $length ) {

        if( mb_strlen( $var ) > $length ) {
            $var= mb_substr( $var, 0, $length );
            return $var;
        } else return $var;
    } 
```

在这种情况下，这应该根据相关长度缩短传递的变量（$post_obj_fave->post_title）。

# asp.net-mvc - 使用 ASP.NET MVC 中的内置 JsonResult 对 NHibernate 实体进行 JSON 序列化会产生循环依赖错误

> ID：11121144
> 
> 赞同：3
> 
> 时间：2012-06-20T13:51:19.930
> 
> 标签：asp.net-mvc, nhibernate, serialization, lazy-loading

我正在尝试通过 ASP.NET MVC 前端层从我的服务器返回一个 JSON 列表：

```
var stuff = repo.GetStuff();
return Json(stuff); 
```

但是，我收到一条错误消息，而不是预期的 JSON

> 序列化“System.Reflection.RuntimeModule”类型的对象时检测到循环引用。

我想我已经找到了发生这种情况的地方，但是为了解释它，我需要一个简单的示例域模型，如下所示：

![在此处输入图像描述](../Images/723cd3d4d29056df49389099a220d1ed.png)

我正在（懒惰地？）从 NHibernate 加载一系列文档，如下所示：

```
var session = getNHibernateSession();
var query = new NhQueryable<Document>(session.GetSessionImplementation());
var docs = query.ToList().AsEnumerable(); 
```

`JsonResult`然后我传递文件以在我的控制器中返回 a ：

```
return Json(docs, JsonRequestBehavior.AllowGet); 
```

现在，当`Json()`对集合进行序列化时，它会遍历文档的属性，找到一个人。它序列化那个人，并找到一个项目。它对项目进行序列化，并再次找到 - 没错 - 那个人！由于我是延迟加载，所以如果没有什么能阻止它，它可以一直走下去，但它会因循环引用错误而停止。

我真的不需要降低所有这些级别（如果不首先加载项目我会很好） - 我可以以某种方式影响`Json()`这个集合的序列化方式，而不是进一步降低，比如说，降低 2 级吗？我搜索了一下，但我发现的大部分内容似乎来自那些决定直接使用序列化库的人，而不仅仅是使用 .NET MVC 中的内置功能。（注意：这个问题的解决方案必须可以专门应用于这种情况，因为我可能想要在应用程序的其他地方获取人员的 JSON 列表，包括项目......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:09:55.950

如果您正在检索 Json，则您有一个服务 api。除了实现之外，您还必须设计 api。将使用它的页面是否需要所有这些字段和集合？可能不是。为其他功能和服务添加更多属性怎么样？它们将开始出现在所有请求中。

您需要使用 ViewModel 或仅使用具有所需结构的匿名类型：

```
var session = getNHibernateSession();
var query = new NhQueryable<Document>(session.GetSessionImplementation());
var docs = query.ToList();
var result = query.Select(x => new {
                                       x.Id,
                                       x.Name,
                                       People = new { p.Id, 
                                                      p.Name, 
                                                      p.Title
                                                    }
                                    });

return Json( result, JsonRequestBehavior.AllowGet); 
```

通过这种方式，您可以控制渲染的内容和方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T13:57:09.660

[这里](https://stackoverflow.com/questions/1411577/ignoring-a-field-during-net-json-serialization-similar-to-xmlignore)已经回答了。

此外，像这样公开您的域实体通常不是一个好主意。如果它是用于只读目的，它可能不会那么糟糕，但是如果您的任何操作方法接受域实体，那么特定格式的请求可以覆盖您不想要的域实体上的属性（例如您的 PK ）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-07T10:06:06.963

要在 JSON 中保留对象引用，请将以下代码添加到**Global.asax**文件中的**Application_Start**方法：

 **```
var json = GlobalConfiguration.Configuration.Formatters.JsonFormatter;
json.SerializerSettings.PreserveReferencesHandling = Newtonsoft.Json.PreserveReferencesHandling.All; 
```**

# php - 检查文件是否在公共 html 目录中的方法比 PHP FTP 函数更快

> ID：11121146
> 
> 赞同：1
> 
> 时间：2012-06-20T13:51:22.470
> 
> 标签：php, performance, ftp

我有大约 295 个域来检查它们是否在其 public_html 目录中包含文件。目前我正在使用 PHP FTP 函数，但脚本需要大约 10 分钟才能完成。我试图缩短这个时间，我可以使用什么方法来实现这一点。

这是我的PHP代码

```
 <?php
  foreach($ftpdata as $val) {

    if (empty($val['ftp_url'])) {

        echo "<p>There is no URL provided</p>";

    }

    if (empty($val['ftp_username']))    {

        echo "<p>The site ".$val['ftp_url']." dosent have a username</p>";

    }

    if (empty($val['ftp_password']))    {

        echo "<p>The site ".$val['ftp_url']." dosent have a password</p>";

    }

    if($val['ftp_url'] != NULL && $val['ftp_password'] != NULL && $val['ftp_username'] != NULL) {

        $conn_id = @ftp_connect("ftp.".$val['ftp_url']);

        if($conn_id == false)   {

            echo "<p></br></br><span>".$val['ftp_url']." isnt live</span></p>";

        }
        else    {

            $login_result = ftp_login($conn_id, $val['ftp_username'], $val['ftp_password']);

            ftp_chdir($conn_id, "public_html");

            $contents = ftp_nlist($conn_id, ".");

            if (count($contents) > 3)   {

                echo "<p><span class='green'>".$val['ftp_url']." is live</span><p>";
            }
            else {

                echo "<p></br></br><span>".$val['ftp_url']." isnt live</span></p>";
            }
        }
    }

 }
 ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T16:15:41.770

M，这实际上只是对[AlexeyKa](https://stackoverflow.com/users/1279064/alexeyka)答案的解释。扫描 10 分钟的原因是您正在序列化大约 300 个网络事务，每个事务平均花费大约 2 秒，而 300 x 2s 为您提供了总共 10 分钟的经过时间。

请求标头和没有正文的各种方法可以减少每笔事务的成本，但杀手是您仍然一次运行查询。curl_multi_ *****例程允许您并行运行批次，例如 30 x 批次 10 接近 30 秒。浏览 PHP 文档的用户提供的注释后，可以看到这篇文章解释了如何设置：
[Executing multiple curl requests in parallel with PHP 和 curl_multi_exec](http://www.rustyrazorblade.com/2008/02/curl_multi_exec/)。

另一种选择（如果您使用的是**php-cli**）只是简单地启动，例如，十个批处理线程，每个线程与您当前的代码差不多，但有十分之一的站点的自己的子列表要检查。

由于这两种方法主要受延迟限制，而不是特定的链路容量限制，因此时间应该在很大程度上下降相同的因素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T13:54:30.583

如果它是一个公开可用的文件，您可以使用[`file_get_contents()`](http://us2.php.net/manual/en/function.file-get-contents.php)它来尝试抓取它。如果它成功了，你就知道它就在那里。如果它失败了，那么它不是。您无需下载整个文件。只需将其限制为少量字符，这样它就可以快速且不浪费带宽。

```
$page = file_get_contents($url, NULL, NULL, 0, 100);
if ($page !== false)
{
    // it exists
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T14:53:44.740

使用卷曲。将选项 CURLOPT_NOBODY 设置为 true 请求方法设置为 HEAD 并且不传输正文。

```
<?php
// create a new cURL resource
$ch = curl_init();

// set URL and other appropriate options
curl_setopt($ch, CURLOPT_URL, "http://google.com/images/srpr/logo3w.png"); //for example google logo
curl_setopt($ch, CURLOPT_HEADER, true);
curl_setopt($ch, CURLOPT_NOBODY, true);
curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt ($ch, CURLOPT_FOLLOWLOCATION, true);

//get content
$content = curl_exec($ch);

// close
curl_close($ch);

//work with result
var_dump($content);
?> 
```

在输出中，如果 isset "HTTP/1.1 200 OK" 则文件/资源​​存在。

PS。尝试使用 curl_multi_*。它非常快。

# javascript - 我想单击一个按钮，一次只从已经制作的程序中执行一行代码..（javascript）

> ID：11121149
> 
> 赞同：1
> 
> 时间：2012-06-20T13:51:29.507
> 
> 标签：javascript

是的，那我可以这样做吗？

我已经编写了一个具有两个功能的程序..一个是递归的..所以我想知道如何通过按下按钮一次只执行一行代码..我希望这是可能的

我也在网页中这样做

这是我的剧本..它不重要，只是让你提出一个想法..

读这个...我不想用萤火虫或其他东西调试它...我想在我的程序中自己做这个...我想让代码在我按下按钮时一次执行 1 行。 .所以基本上我正在构建我自己的调试器..图形部分已经完成..我只需要知道如何做到这一点..

```
 function nod(){
                            var info;
                            var st;
                            var dr;
                        }
                        function help(){
                            var rad;
                        }

                        var h = new help();
                        h.rad = new nod();
                        h.rad = null;

                        function create(h,x)
                        {

                            if(h.rad==null)
                            {
                                h.rad = new nod();
                                h.rad.info = x ;
                                h.rad.st = h.rad.dr = null;
                            }
                            else{
                                if(x < h.rad.info){
                                    var h1;
                                    h1 = new help();
                                    h1.rad = h.rad.st;
                                    create(h1,x);
                                    h.rad.st = h1.rad;
                                }
                                else{ 
                                    var h2;
                                    h2 = new help();
                                    h2.rad = h.rad.dr;
                                    create(h2,x);
                                    h.rad.dr = h2.rad;
                                }
                            }

                        }

                        function read(h)
                        {

                            var input = [0,10,2,1,8,9,4,5,3,6,20,11,30,21,31,22,23,
                            ];
                            var i;
                            for(i=1;i<=16;i++)
                            {
                                create(h,input[i]);

                            }

                        }

                        read(h); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T13:58:40.707

在 Chrome 中打开您的站点，并使用[集成的脚本调试器](https://developers.google.com/chrome-developer-tools/)在您设置的断点后逐步执行脚本。

但是至少快速浏览一下我链接的整个工具箱，以确保您知道您可以期待什么，并根据您的需要使用最好的工具。

# c++ - C++ 运行时错误

> ID：11121155
> 
> 赞同：0
> 
> 时间：2012-06-20T13:52:10.160
> 
> 标签：c++, visual-studio-2008

我有一个在几台机器上运行良好的 C++ 应用程序。但我发现不止一台 PC 上的应用程序因错误而失败：

> 此应用程序已请求运行时以不寻常的方式终止它。请联系应用程序的支持团队以获取更多信息。

有趣的是，在一台计算机中，它部分工作，部分不工作。几天前它因错误而失败，现在它可以工作了。

这种行为的原因可能是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:27:51.147

正确的态度不是它在某些机器上失败——而是“我的程序**到处**都是错误的——它只是巧合地在某些机器上工作”

最有可能的是一个未初始化的变量，它恰好指向*工作*机器上的空内存和零内存，但指向其他机器上的垃圾，或者您没有检查某些分配是否失败并且工作机器有很多内存。另一个常见问题是某些运行时库的不同版本。

建议：
在编译器上调高警告级别
尝试调试构建 - 这些通常会将所有变量设置为零
这是了解堆栈转储和远程调试的好机会

# android - 在我的活动中放置带有正弦/余弦波的图表

> ID：11121158
> 
> 赞同：4
> 
> 时间：2012-06-20T13:52:28.150
> 
> 标签：android, graph

我目前正在开发一个 Android 应用程序，它需要从蓝牙设备接收数据，然后显示它。其中一些数据以正弦/余弦波的形式出现，需要绘制图表。

有谁知道如何将图表添加到我的活动中？图表最初应该是空白的，然后用户可以从 12 种不同的信号中选择来绘制图表。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T13:58:42.280

[achartengine](http://code.google.com/p/achartengine/)是一个为 android 构建的图形库。

Google 还提供了[Image Charts API](https://developers.google.com/chart/image/)，它会为您生成 png，然后您可以在 ImageView 中显示

我认为两者都能够制作折线图。您只需要生成代表正弦/余弦波的数据并将其传递给图表引擎。

# wcf - 发布到 wcf 服务，但 Request.InputStream 的长度为 0

> ID：11121160
> 
> 赞同：1
> 
> 时间：2012-06-20T13:52:44.853
> 
> 标签：wcf

我有一个这样定义的 wcf 服务：

`[OperationContract] [WebInvoke(Method = "POST", ResponseFormat = WebMessageFormat.Json)] public CreateOrderResponse CreateOrder(CreateOrderRequest request)`

请求参数填充得很好，但在我的方法中访问 HttpContext.Current.Request.InputStream 以获取原始帖子正文但 InputStream 为空，InputStream.Lenght 为 0。

我的问题是，当从发布请求中很好地填充请求参数时，为什么 Request.InputStream 为空？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T13:55:14.013

您需要使用 CreateOrderRequest 实例及其相关属性。

据我所知，我可能是错的，Inputstream 将始终为 null，因为它在传递给 WCF 方法之前已经过处理。有关更多信息，请参阅此链接[在异常期间捕获原始 HTTP POST 数据](https://stackoverflow.com/questions/906788/capturing-raw-http-post-data-during-exception)

# performance - 将代码（css、js）嵌入到知名网站的文档中

> ID：11121162
> 
> 赞同：0
> 
> 时间：2012-06-20T13:52:49.007
> 
> 标签：performance, page-load-time

将您的 CSS 和 JS 嵌入到您的网页中，而不是将代码保存在单独的文件中，是否有某种优势（速度或性能方面）？我从小就相信将代码分开存放在不同的文件中会使事情更容易维护。然而，在亚马逊、谷歌甚至 facebook 等知名网站上，我看到了很多嵌入代码。他们选择这样做是否有性能原因，或者这只是一种旧/新的做事方式。我想我的问题与此类似：[我应该在移动网站中内联 CSS 和 JS 以节省带宽吗？](https://stackoverflow.com/questions/8732102/should-i-inline-css-js-in-mobile-sites-to-save-bandwidth)

但我想听听专家意见，尤其是那些在知名网站上工作过的人，如果有的话。

附言

额外问题：亚马逊网页上的最后一个 html 评论是`<!-- MEOW -->`什么意思，还是只是一个有趣的恶作剧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:42:25.370

内联资源有充分的理由，但与大多数事情一样，它也有其权衡。内联最简单的情况是 HTTP 连接的成本远远超过资源本身的情况，例如：如果您需要显示一个 10x10 的图标，那么与内联数据相比，专门的请求可能不值得通过数据 URI。

当您有许多需要获取的小资源时尤其如此。大多数浏览器将自己限制为每个主机最多 6 个连接，因此如果您有 60 个需要获取的资源，那么您将在很长一段时间内被阻止。

为了解决这些情况，我们发明了其他解决方法：域分片以超过 6 个连接限制，以及“拆分”以获取一个资源与多个资源。

如果您查看 mod_pagespeed（Apache 模块），它会为您即时执行许多这些优化，那么我们提供的推荐设置是内联任何小于 2kb 的资源。对于今天的堆栈来说，这是一个非常好的经验法则。

一旦 SPDY 被更广泛地部署，这些变通方法中的许多都可以被消除：不需要进行域分片，额外请求的成本要少得多，等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T14:00:39.863

CSS/JS 外部文件通常缓存在该用户浏览器配置文件下的用户硬盘上。因此，除非您经常更改代码，否则将其内联并不会真正帮自己一个忙。

绝对可以节省您的维护时间，但是您可以轻松地调用 javascript/css 文件并将代码嵌入到您在服务器端填充的页面上，但这也意味着您正在让您的服务器做额外的工作。

至于喵喵——是的，他们想搞笑，或者是代码……为……猫……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T18:46:23.773

Stoyan 做了一个你可能会觉得有趣的实验[http://www.phpied.com/style-tag-to-inline-style-attrrib/](http://www.phpied.com/style-tag-to-inline-style-attrrib/)

# c# - 从 sql 源加载 GridView

> ID：11121163
> 
> 赞同：0
> 
> 时间：2012-06-20T13:52:49.913
> 
> 标签：c#, asp.net, sql, data-binding, gridview

我正在尝试加载我的gridview（我是新手），但我有点迷路了。我想做的是手动创建一个名为“描述”的列标题，并从我的表 DocumentTypes（dataset1）的 sql 数据集中获取所有其他列标题。

“Description”列需要从“Literature”表（dataset2）中获取所有内容。所有其他列需要从表“文档”（dataset3）中获取所有内容（如果有的话）

这就是我卡住的地方。这就是我手动创建我的第一个列标题的方法。我希望此列包含来自 dataset2 的所有信息。

```
BoundField m_bfBoundField = new BoundField();
m_bfBoundField.HeaderText = "Description";
m_bfBoundField.DataField = "Name";
gridView.Columns.Add(m_bfBoundField); 
```

然后我做

```
gridView.DataSource = dataset2;
gridView.DataBind(); 
```

我尝试了同样的方法从 datasource1 获取我的标题，但现在没有放置 .DataField （我的关系需要一个吗？）

实际上，这是从 datasource2 获取所有“名称”列并将其加载到“描述”列，但它还在我的网格中显示一个具有相同信息的“名称”列:(。

出了什么问题，我该怎么做？明白了吗？

我想

```
-------------------------------------------------------------------------------------------------------
| Description (can be called as I want) | Manuals (data from dataset1) | Catalog (data from dataset1) |
-------------------------------------------------------------------------------------------------------
| DescripionA (data from dataset2)      | Yes (data from dataset3)     | No (data from dataset3)      |
| DescripionB (data from dataset2)      | No (data from dataset3)      | Yes(data from dataset3)      |
------------------------------------------------------------------------------------------------------- 
```

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T14:40:42.743

这可能会让人头疼，但我知道如何做到这一点的唯一方法是在 gridview 中设置它

```
AutoGenerateColumns="False" 
```

然后为所有列制作数据绑定项目。如果您希望列标题与数据集列名称相同，请不要在新的 boundField() 中设置 HeaderText；

您可以像这样直接在 .aspx 页面上执行此操作

```
<asp:GridView ID="Gridview1" runat="server" CellPadding="4" 
    ForeColor="#333333" GridLines="None" AutoGenerateColumns="False">
    <AlternatingRowStyle BackColor="White" ForeColor="#284775" />
    <Columns>
        <asp:TemplateField ShowHeader="False">
            <ItemTemplate>
                <asp:LinkButton ID="NONOPSgridviewDelete" runat="server" CausesValidation="false" 
                    CommandName="Delete" Text="Delete"></asp:LinkButton>
            </ItemTemplate>
        </asp:TemplateField>
         <!-- These are the boundedfields of the rest of your dataset -->
         <asp:BoundField DataField="Firstname"/>
        <asp:BoundField DataField="Lastname" />
    </Columns>
</asp:GridView> 
```

希望这可以帮助，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T14:47:55.053

您可以尝试将新列添加到您的数据源吗？
或者您可以将数据源复制到新数据表并在新数据表中添加新列。之后将该数据表作为数据源绑定到您的网格。
编辑数据源的好方法是因为如果您对网格描述中的数据进行重新排序，如果它们没有堆叠在数据源中，则可能不像您喜欢的那样。

# .net - 随机出现“Invalid Typeref token”错误

> ID：11121164
> 
> 赞同：8
> 
> 时间：2012-06-20T13:52:53.577
> 
> 标签：.net, dll, c#-2.0

我有一个运行了大约 2 年的 .Net Web 应用程序。我们正在使用 NewRelic 对其进行监控，并且每天至少一次，或者有时每天几次，我们会在一段时间内每次请求都会导致以下错误：

System.BadImageFormatException ... 无效的 Typeref 令牌。

如果我们回收应用程序池，错误就会消失。如果我们什么都不做，错误就会自行消失，一切都很好。

我找不到它何时发生或哪个页面导致它的模式。

由于回收应用程序池似乎有帮助，它让我相信这是一个内存错误，所以我一直在尝试减少对 ViewState 的使用，特别是在大型 GridViews 上。到目前为止，它没有帮助。

这个问题的其他建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T06:53:44.853

首先我建议你有日志管理。最简单的方法是使用纯文本文件，在生成异常时在其中写入错误，以便您可以看到根本没有生成错误。

其次，您可以尝试在应用程序级别（在 Web.config 中）启用跟踪，因为您不知道您在哪个页面收到异常。

这是另一个有同样问题的链接，如果以下链接不相关，请告诉我们。 [System.BadImageFormatException：如何修复 .NET 版本不匹配？](https://stackoverflow.com/questions/826038/system-badimageformatexception-how-to-fix-net-version-mismatch)

# php - 如何将动态生成的 n 数量 输入

> ID：11121165
> 
> 赞同：0
> 
> 时间：2012-06-20T13:52:54.450
> 
> 标签：php, html

你好 :) 我真的需要你的帮助。我动态生成项目列表，但不是将每个项目分开放置，而是`<li>`我想要得到这样的东西：

```
<ul>
   <li>
      <div>$pt</div>
      <div>$pt</div>
      <div>$pt</div>
   </li>
   <li>
      <div>$pt</div>
      <div>$pt</div>
      <div>$pt</div>
   </li>
</ul> 
```

这是我的代码：

```
<ul class="some-ul-class">
    <?php $itemCount = 3; ?>
       <?php $i=0; foreach ($p->getItems() as $pt): ?>
           <?php if ($i++%$itemCount==0): ?>
              <li class="item">
           <?php endif; ?>
                 <div>$pt</div>
              </li>
       <?php endforeach; ?>
</ul> 
```

但结果我得到这样的结构：

```
<ul>
   <li>
      <div>$pt</div>
   </li>
   <div>$pt</div>
   <div>$pt</div>

   <li>
      <div>$pt</div>
   </li>
   <div>$pt</div>
   <div>$pt</div>
</ul> 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T13:58:00.983

```
<ul class="some-ul-class">
<?php $itemCount = 3; ?>
   <?php $i=0; foreach ($p->getItems() as $pt): ?>
       <?php if ($i%$itemCount==0): ?>
          <li class="item">
       <?php endif; ?>
             <div>$pt</div>
       <?php if ($i%$itemCount==2): ?>
          </li>
       <?php endif; $i++; ?>
   <?php endforeach; ?>
</ul> 
```

你可以试试这个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T13:57:19.470

```
<ul class="some-ul-class">
  <?php $itemCount = 3;
    $i=0;
    foreach ($p->getItems() as $pt):
      if ($i%$itemCount==0):
        echo '<li class="item">';
      endif;
        echo "<div>$pt</div>";
      if ($i%$itemCount==2):
        echo '</li>';
      endif; $i++;
    endforeach; ?>
</ul> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T13:56:48.830

尝试这样的事情：

```
<ul class="some-ul-class">
    <?php $itemCount = 4; ?>
    <li>
    <?php $i = 1; foreach ($p->getItems() as $pt): ?>
        <?php if ( $i % $itemCount == 0): ?>
            </li><li>
        <?php endif; ?>
        <?php $i++; ?>
        <div><?php echo $pt; ?></div>
    <?php endforeach; ?>
     </li>
</ul> 
```

这会产生：

```
<ul class="some-ul-class">
    <li>
        <div>1</div>
        <div>2</div>
        <div>3</div>
    </li><li>
            <div>4</div>
            <div>5</div>
            <div>6</div>
    </li>
</ul> 
```

[演示](http://codepad.viper-7.com/YsQKHj)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T14:10:00.603

您的代码不会在 LI 中实现嵌套 DIVS，因为您需要一个多维数组来将项目嵌套在容器中。解决方案是将初始 DB 结果集分解为带有数组块的块。

这只是将您的数组 (1,2,3,4,5,6) 拆分为 ([0] => array(1,2,3), [2] => array(4,5,6)

运行下面的循环，您将获得两个带有 3 个嵌套 DIV 的 LI。该代码未经测试，但应该是可操作的。

```
<?php 

$items = array(1,2,3,4,5,6,8,9,10,11,12,13,14,15);         
// Your initial item array

$rows = 3;                           
// Number of rows in each li 

$items = array_chunk($items, $rows); 
// Final nested array in blocks of 3

if ($items) {       
    echo "<ul class='some-ul-class'>\n";        
    foreach ( $items as $item ) {           
        echo "<li class='items'>\n";            
        foreach ($item as $divs) {
            echo "<div>{$divs}</div>\n";
        }           
        echo "</li>\n";             
    }       
    echo "</ul>\n";
}

?> 
```

# ruby-on-rails - Rails + Paperclip + Amazon S3：将图像保存到 Amazon 但需要在前后处理它们

> ID：11121167
> 
> 赞同：0
> 
> 时间：2012-06-20T13:52:56.623
> 
> 标签：ruby-on-rails, imagemagick, paperclip

我有一个应用程序，我将用户上传的图像保存到 Amazon S3。然而，通常用户的图像是不一致的。为了让我能够在我的应用程序中使用它们，它们需要具有一定的宽度和高度。

我想在存储中存储一个基本图像，但是在网络应用程序中使用图像时，在不同的视图中我需要不同的尺寸。

我应该如何解决这个问题？挑战在于保存图像和检索图像直接从应用程序到 Amazon S3，而不涉及应用程序。

有什么建议么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T14:31:32.703

Paperclip 允许您定义样式以在上传后调整图像大小。参考[https://github.com/thoughtbot/paperclip/wiki/Thumbnail-Generation](https://github.com/thoughtbot/paperclip/wiki/Thumbnail-Generation)

# c# - 如何检查单击的对象是否是 C# XNA 中的最顶层？

> ID：11121169
> 
> 赞同：0
> 
> 时间：2012-06-20T13:53:03.597
> 
> 标签：c#, events, xna

我试图在 C# XNA 中重现简单的窗口界面对象，如标签、列表框、文本框和面板。因此，所有对象都派生自绘制对象并对其进行更新的基本抽象类 (XNAInterfaceObject)。在更新方法中，它与鼠标和键盘交互并引发各种事件。问题是当两个接口对象相互重叠时（例如，列表框上的弹出上下文菜单）并且都具有非空事件 - 当我只需要最顶层对象的事件时，代码会触发这两个事件。如何检查哪个对象是最上面的？或者以某种方式使顶部对象与下部对象重叠。我想到了全局变量，它将保留最后一次单击对象的引用，而其他对象将检查该变量是否为空以继续其事件，

对不起我的语言，我不是以英语为母语的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:31:36.850

我可能会将这个问题分解为两个部分：

1.  确定接口对象的顺序。
2.  仅在重叠时触发最顶层对象上的事件。

解决第一部分很简单。在指定对象深度的基类中包含一个“层”字段/属性。在大多数游戏节点类中，我无论如何都会包含它，因为它在绘图中很有用。如果事情变得有点复杂，您可能需要一个单独的分层系统来进行接口排序，而这种方法的缺点是您可能会获得层相同的重叠。

正如@Attila 所建议的那样，您可以管理界面元素的 Z 顺序列表。在这种情况下，排序是由索引管理的，它很容易管理，但是如果不进行一些额外的处理，您也不能使用此信息进行绘图，并且它不会像简单的值比较那样快。

**财产**

```
public class InterfaceComponent
{
    // Class members...
    private float layer;
    public float Layer { get { return layer; } set { layer = Math.Abs(value); } }

    public bool InFrontOf(InterfaceComponent other) { return this.Layer < other.Layer; }
} 
```

**Z-有序列表**

```
public class InterfaceComponent
{
    private static List<InterfaceComponent> zOrder = new List<InterfaceComponent>();

    // Class Members....

    public InterfaceComponent()
    {
        // Construct class...
        zOrder.Add(this);
    }

    private void SetZOrder(int order)
    {
        if (order < 0 || order >= zOrder.Count)
            return;

        zOrder.Remove(this);
        zOrder.Insert(order, this);
        // There are more efficient ways, but you get the idea.
    }

    public void SendBack() { SetZOrder(zOrder.indexOf(this) + 1); }
    public void SendToFront() { SetZOrder(0); }
    // etc...
} 
```

**第二部分** 有多种方法可以处理第二部分。最明显的是检查所有接口组件的交集和图层属性，或者在 Z 顺序列表的情况下，检查列表中较高的所有组件（在我的示例中接近 0）以进行交集。

即使您使用屏幕使列表更小，这最终也会变得非常昂贵。相反，您可以管理引发事件的列表并在处理输入后处理它们。例如...

```
public static class InterfaceEvents
{
    public static List<EventData> List = new List<EventData>();

    public static void Resolve()
    {
        while (List.Count > 0)
        {
            for (int i = List.Count - 1; i > 0; i--)
            {
                if (List[i].EventType == List[0].EventType && List[i].Sender.Intersects(List[0].Sender))
                {
                    if (List[i].Sender.Layer < List[0].Layer) // However you choose to manage it.
                    {
                        List[0] = List[i];
                        List.RemoveAt(i);
                    }
                    else
                        List.RemoveAt(i);
                }
            }
            // Toggle event from List[0]
            List.RemoveAt(0);
        }
    }
}

public struct EventData
{
    public InterfaceComponent Sender;
    public int EventType;
} 
```

无论如何，这些是我的想法。现在已经很晚了，所以我希望一切都保持理智，没有明显的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T14:01:56.447

通常在 GUI 中有一个可见性排序（z-order）列表，它维护什么在什么之上。使用这种技术（为每个组件分配 az 顺序），您可以检查单击组件的顶部是否还有其他内容，也包括单击的坐标 - 如果有，请不要处理单击（其他组件是最重要的是，它将处理它）；否则此组件是处理点击的最顶层组件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T15:57:38.443

一个简单的解决方案是在您的 Game 类中创建一个列表：

```
List<XNAInterfaceObject> controls; 
```

然后，您可以使用列表的顺序来解决您的问题。将列表中的第一个元素视为位于最前面的控件。在游戏的 GetControlAt() 方法中，您可以从前到后循环控制控件：

```
protected override void Update(GameTime gameTime)
{
    ...

    MouseState ms = Mouse.GetState();
    if (ms.LeftButton == ButtonState.Pressed)
    {
        XNAInterfaceObject control = GetControlAt(ms.X, ms.Y);
        if (control != null)
            control.MouseClickMethod(ms);
    }

    ...
}

private XNAInterfaceObject GetControlAt(int x, int y)
{
    for (int i = 0; i < controls.Count; i++)
    {
        if (controls[i].Rectangle.Contains(x, y)
        {
            return controls[i];
        }
    }
    return null;
} 
```

这意味着 XNAInterfaceObject 应该有一个 Rectangle 属性和一个 MouseClickMethod()。请记住，在绘制控件时，您必须向后循环列表。

# jquery - 加载用户选择的图像目录的 jQuery/PHP 图像滑块

> ID：11121174
> 
> 赞同：-1
> 
> 时间：2012-06-20T13:53:21.020
> 
> 标签：jquery, jquery-plugins, server-side, server-side-scripting

我正在寻找一个能够通过我的服务器加载不同目录的图像滑块。我没有使用任何 CMS。

例如，如果我有目录：`localhost/galleries/florida`、、`localhost/galleries/wedding`和`localhost/galleries/graduation`

当用户访问我的网站时，他们会看到图像滑块（只有一个占位符图像）和一些带有不同画廊标题的链接。然后，用户可以单击该链接以选择要从中查看的画廊。在这种情况下，它是佛罗里达州、婚礼或毕业时，单击它会将目录加载到滑块中（无需重新加载页面）。

是否有任何图像滑块附带我可以为此自定义的服务器端脚本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T17:13:29.040

查看[幻灯片](http://developers.slidedeck.com/)。它相信它会满足您的要求。否则[，此页面](http://www.tripwiremagazine.com/2012/02/jquery-image-slider-plugins.html)有许多 jQuery 选项。

# jquery - 如何保持焦点直到关闭弹出窗口

> ID：11121184
> 
> 赞同：2
> 
> 时间：2012-06-20T13:53:51.250
> 
> 标签：jquery

如何保持对 popuP 窗口的关注？目前它显示弹出窗口，但是当我单击弹出窗口外的任何位置时它会关闭窗口，我想要的是仅在用户单击关闭按钮时关闭。这是**[演示](http://jsfiddle.net/abuhamzah/DSa9H/)**

```
//html:
    <a id='clickShow' class='a'>Click here</a> 
    <div id="popupContact" class='divpopup'>
            <a id="popupContactClose">x</a>
            <h1>Option Image</h1>
            test 123
         </div>
        <div id="backgroundPopup"></div> 
```

//js:

```
//SETTING UP OUR POPUP
//0 means disabled 1 means enabled
var popupStatus = 0;
function centerPopup(){
    //request data for centering
    var win = {
            height: $(document).height(),
            width: $(document).width()
        },
        pop = {
            height: $("#popupContact").height(),
            width: $("#popupContact").width()
        };
    $("#popupContact").css({
        "position": "fix",
        "top": win.height/2-pop.height/2,
        "left": win.width/2-pop.width/2
    });
    //only need force for IE6    
    $("#backgroundPopup").css({
        "height": win.height
    });   
}
function disablePopup(){
    //disables popup only if it is enabled
    if(popupStatus==1){
        $("#backgroundPopup, #popupContact").fadeOut();
        popupStatus = 0;
    }
}
function loadPopup(id){
    //centering with css
    centerPopup();
    //loads popup only if it is disabled
    if(popupStatus==0){
        $("#backgroundPopup").css("opacity", "0.7").fadeIn();
        $("#popupContact").fadeIn();
        popupStatus = 1;
        getValueOptionImage($(this).attr('id'));
    };
}
function getValueOptionImage(value) {
    $(".option_radio").unbind("change").change(function(e) {
        alert("a ID: " + value + "\nradio Value: " + $(this).val());
    });
}
$(function() {
    $("a").on("click", loadPopup);
    //CLOSING POPUP
    $("#popupContactClose, #backgroundPopup").click(disablePopup);
    //Press Escape event!
    $(document).keypress(function(e){
        if(popupStatus==1 && e.which==27) disablePopup();
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T13:55:05.293

这是由于您的事件处理程序已注册以收听您的关闭和背景的点击，因此请更改

```
$("#popupContactClose, #backgroundPopup").click(disablePopup); 
```

到

```
$("#popupContactClose").click(disablePopup); 
```

# c# - 等待第三方应用程序窗口加载

> ID：11121186
> 
> 赞同：7
> 
> 时间：2012-06-20T13:53:55.823
> 
> 标签：c#, multithreading, wait, window-load

我正在尝试创建一个 C#.NET 2.0 脚本来自动化用 Java 编写的第三方应用程序中的工作流。

我正在使用 user32.dll 函数来与 Java 应用程序窗口进行交互。

我的问题是 Java 应用程序窗口完全加载速度很慢，并且我发送的操作`IntPtr SendMessage(IntPtr hWnd, UInt32 Msg, UInt32 wParam, IntPtr lParam)`有时会丢失。示例：在加载主窗口期间，如果我尝试打开一个菜单（此时我实际上在主窗口上有一个句柄），我的消息就丢失了，菜单永远不会打开。

我在 Stack Overflow 上找到了一些答案，告诉我们可以`Process.WaitForInputIdle()`为此目的使用该方法，但我发现这仅适用于应用程序是单线程的，而我的 Java 应用程序不是这种情况。（[C# SendKeys 等待程序加载后再发送](https://stackoverflow.com/questions/10710141/c-sharp-sendkeys-wait-for-program-to-load-before-sending)）

我正在寻找具有相同想法但支持多线程或您可能拥有的任何其他想法的东西？！：）

遵循 Mari9 的想法，我终于用`System.Diagnostic.PerformanceCounter()`来观看第三方应用程序进程的活动。然后它变为 0，这意味着该进程已经完成了它必须做的事情并且能够执行我发送给它的消息。

```
PerformanceCounter PC = new PerformanceCounter();
PC.CategoryName = "Process";
PC.CounterName = "% Processor Time";
PC.InstanceName = "<process name>";
Console.WriteLine(PC.NextValue().ToString()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T16:13:15.077

我假设您有一种方法可以检测要发送输入的窗口何时显示在屏幕上，但是由于窗口繁忙，因此无法立即发送输入。

您可以有一个预定义/硬编码的等待间隔（可能为每个 Java 窗口定制） - 这不是很可靠，但可能在受控环境中运行良好（例如，如果应用程序仅在您的计算机上使用）。

如果加载完成后窗口的外观发生了可靠的变化，您可以捕获窗口的屏幕截图并测试是否存在正确的像素，然后在发送消息之前重复此操作直到为真。

另一种选择是使用 Spy++ 来查看加载完成时是否为窗口生成任何特定消息（例如，可能是使用某些参数重新绘制）并安装一个挂钩来检测这些消息。

如果 Java 应用程序使用本机窗口控件 (SWT)，您可以尝试检测窗口文本/结构中指示加载完成的变化。

如果窗口加载过程是资源密集型的，您还可以监控 Java 应用程序的 CPU 使用情况，并在发送消息之前等待“峰值”结束。

# c# - Linq 查询返回异常

> ID：11121187
> 
> 赞同：0
> 
> 时间：2012-06-20T13:53:56.680
> 
> 标签：c#, .net, linq

所以我有这段代码：

```
var imageList = (from stepImages in xrmContext.SdkMessageProcessingStepImageSet
       where stepImages.IsNotNull() && stepImages.SdkMessageProcessingStepId.Id == tempPluginStep.steps.Id
                select new
                {
                     stepImages

                }).ToList(); 
```

它的问题是它返回一个“序列不包含元素”异常，但如果没有选择任何元素，我虽然 .ToList 会返回一个空的 IEnumerable。似乎是什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T13:55:20.080

尝试替换这个：

```
select new
{
   stepImages
} 
```

和：

```
select stepImages 
```

# powershell - Powershell 参数在路径中未按预期工作

> ID：11121190
> 
> 赞同：1
> 
> 时间：2012-06-20T13:54:12.093
> 
> 标签：powershell

在下面的 powershell 脚本中，我传递了三个字符串参数。$ComputerName 参数行按预期工作。我可以远程进入我指定的机器。

**问题 1**
在 $latestbuildfolder 行上，我使用 $builddefinition 参数来指定构建定义。它附加了构建定义的名称，但不列出该文件夹内的文件夹。如果我将 $BuildDefinition 参数替换为“TeamBuild”我们的构建定义名称，那么它能够列出所有文件夹并获取最新文件夹。有些我觉得加入不起作用。我也尝试过使用 Join-Path 但仍然无法正常工作。

**问题 2**
当我尝试在该字符串中指定 $Configuration 时，在 $deploycmdlocation 行上它不起作用。它在该路径之间输出一个空白。我使用 Write-Host 检查并将参数传递给脚本。

```
param(
[System.String] $ComputerName,
[System.String] $Configuration,
[System.String] $BuildDefinition
)
$session = New-PSSession -ComputerName $ComputerName 
Invoke-Command -Session $session -ScriptBlock {
$latestbuildfolder = Get-ChildItem "C:\procmon\procmonBuilds\$BuildDefinition" | Sort-Object LastWriteTime -Descending | SELECT-Object -First 1
$deploycmdlocation = "\procmon\procmonWebProject\$Configuration\_PublishedWebsites\procmonWebProject_Package\procmonWebProject.zip"
$finalstring = $latestbuildfolder.FullName + $deploycmdlocation
$finalstring
}
Remove-PSSession $session 
```

我已经尝试了很多选择，但到目前为止仍然没有运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T14:02:45.180

尝试像这样改变：

```
Invoke-Command -Session $session -ScriptBlock { param($a, $b)
$latestbuildfolder = Get-ChildItem "C:\procmon\procmonBuilds\$b" | Sort-Object LastWriteTime -Descending | SELECT-Object -First 1 
$deploycmdlocation = "\procmon\procmonWebProject\$a\_PublishedWebsites\procmonWebProject_Package\procmonWebProject.zip"
$finalstring = $latestbuildfolder.FullName + $deploycmdlocation 
$finalstring
} -argumentlist $Configuration, $BuildDefinition 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:45:20.910

对我有用的解决方案就像是盗梦空间电影。事实证明，我必须在两个地方声明 param。感谢我的同事朋友提供此解决方案。

这是适合我的最终脚本。这是一个在构建机器上运行的脚本，然后在远程计算机上执行 new-pssession 从最新的构建放置文件夹中获取 web 包。这些参数通过用于调用 powershell 脚本的流程模板活动 Invoke-Process 传递。

```
param(
[System.String] $ComputerName,
[System.String] $Config,
[System.String] $BuildDef
)
$session = New-PSSession -ComputerName $ComputerName 
Invoke-Command -Session $session -ScriptBlock {
param(
[string] $ComputerName,
[string] $Configuration,
[string] $BuildDefinition
$latestbuildfolder = Get-ChildItem "C:\procmon\procmonBuilds\$BuildDefinition" | Sort-Object LastWriteTime -Descending | SELECT-Object -First 1
$deploycmdlocation = "\procmon\procmonWebProject\$Configuration\_PublishedWebsites\procmonWebProject_Package\procmonWebProject.zip"
$finalstring = $latestbuildfolder.FullName + $deploycmdlocation
$finalstring
} -args $ComputerName, $Config, $BuildDef
Remove-PSSession $session 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T15:09:39.720

我想前几天我遇到了类似的问题...尝试以下行...

```
$latestbuildfolder = Get-ChildItem "C:\procmon\procmonBuilds\$($b)" | ... 
```

[在字符串中的 $b 变量周围添加 $()，看看是否有帮助。]

# vim - 如何不通过插入`#`来删除缩进？

> ID：11121191
> 
> 赞同：2
> 
> 时间：2012-06-20T13:54:14.137
> 
> 标签：vim, indentation, vi, auto-indent

当使用`autoindent`来自 VIM 的配置时，它会在创建新行后自动将光标缩进到有意义的位置。但是，当您输入的第一个字符是井号字符 ( `#`) 时，缩进将被删除，并且`#`将作为该行的第一个字符插入。

**为什么会这样？如何配置 VIM 不这样做？**

示例（`_`作为空光标位置）：

```
def python_function():
    _ 
```

单击`#`键盘上的 后会发生这种情况：

```
def python_function():
#_ 
```

但*应该*发生的是：

```
def python_function():
    #_ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T14:00:15.353

你可能有`smartindent`or`cindent`而不是 (or as well as) `autoindent`; 这些缩进样式是为 C 语法语言设计的。编辑 Python 以使用它是一个好主意，`:filetype plugin indent on`因为这将为 Python 加载适当的缩进设置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-20T13:59:15.917

`:help smartindent`

使用映射`:inoremap # X^H#`（^h 通过 CTRL-V CTRL-H 输入）

# javascript - 编写 if 语句的新方法

> ID：11121193
> 
> 赞同：1
> 
> 时间：2012-06-20T13:54:21.737
> 
> 标签：javascript, if-statement, short-circuiting

在搜索网站的源代码时，我找到了一种以`if`另一种方式（我认为）编写语句的方法。

代替：

```
if(a)b; 
```

或者：

```
a?b:''; 
```

我读：

```
!a||b; 
```

第三种方式和前两种方式一样吗？如果是，为什么我们要使用第三种方式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T13:55:25.930

第三种方式与前一种方式相同。使用它的一个论点是节省字节。反对使用它的一个强有力的论据是可读性。您最好在编写代码时关注可读性，并使用最小化器（例如[Google Closure Compiler](http://closure-compiler.appspot.com)）来节省字节。

它可以更短：

```
a && b;
/*  !a||b  means:
 (not a) OR b
    which is equivalent to
 a AND b
    which turns out to be
 a && b
*/ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-20T14:00:37.287

欢迎来到[短路评估](https://developer.mozilla.org/en/JavaScript/Reference/Operators/Logical_Operators)的概念。这是在不同语言中使用的逻辑运算符的众所周知的属性。大多数情况下，这将用作适当的`if`或任何其他流控制语句中的子表达式，或者表达条件足够短，以便以这种方式保持可读性，或者通过自动转换来节省字节。

甚至还有关于这些问题的标签：[短路](/questions/tagged/short-circuiting "显示标记为“短路”的问题")。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T14:03:54.087

布尔表达式的结果有时可以在不评估所有子表达式的情况下进行评估。如果我们有`A||B`, 并且`A`是真的，那么甚至不需要评估`B`，因为无论如何结果都会是真的。这种行为称为“快捷布尔评估”，是大多数编程语言中的事实标准。它允许在`if (i < A.length && A[i] == ...)`不评估操作数的情况下编写表达式，如果值不正确`A[i]`，可能会导致异常。`i`

在这种特殊情况下，`!a||b`与 相同`if(a)b`，是的，但是此类代码的可读性和可维护性是一个问题。

# asp.net-mvc - 消耗的 REST 服务，领域模型

> ID：11121195
> 
> 赞同：0
> 
> 时间：2012-06-20T13:54:43.093
> 
> 标签：asp.net-mvc, rest, .net-4.0, domain-driven-design

这个问题涉及到我在说什么：

[在 .NET MVC 3 中使用 REST Web 服务](https://stackoverflow.com/questions/4970542/consuming-rest-web-service-in-net-mvc-3)

这也是在正确的区域：

[通过 DDD 应用程序从 REST api 返回域模型是否很好？](https://stackoverflow.com/questions/10943758/is-it-good-to-return-domain-model-from-rest-api-over-a-ddd-application)

所以...

我有几个吐出 XML 的资源（WCF REST）。从 ASP.NET MVC 到现在，方法一直是通过资源 URI ( [http://uri.com/collection](http://uri.com/collection) ) 将资源作为 XML 检索，将其反序列化为域模型，然后最终使用 AutoMapper 映射到 DTO。在 ASP.NET MVC 控制器中，这些 DTO 被序列化为 JSON，然后在视图中使用一些花哨的 JavaScript 库来呈现。

这感觉像是一种更纯粹的方法，将领域模型与视图模型分开。

我一直在研究其他 ASP.NET MVC 应用程序，人们在 ASP.NET MVC 控制器中引用他们的资源（WCF REST）合同，因此依赖于合同所在的程序集。然后他们将其序列化为 JSON并且和我做的几乎一样来呈现数据。

虽然我的方式更纯粹，但我觉得另一种方式更务实。

我很困惑。没有拖延，我想建立最好的解决方案。

更让我困惑的是，还有其他方法可以做我正在做的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:01:19.983

我不确定你的问题到底是什么。如果它与使用 XML 与 JSON 有关，我会说[使用 RestSharp 来使用您的服务并完成它](http://restsharp.org/)。让它为你做样板代码。如果您希望以不同的方式公开 API，那么我建议使用[ServiceStack](http://servicestack.net/)之类的东西，它会创建一个可以随心所欲使用的 API（XML、JSON 等）。我不确定这是否回答了你的问题......

# html - 只有四个元素的简单搜索页面，试图在调整大小时保持布局

> ID：11121199
> 
> 赞同：0
> 
> 时间：2012-06-20T13:54:44.560
> 
> 标签：html, css

我一直在尝试构建一个简单的搜索页面，类似于 google 主搜索页面的结构。我无法以容忍浏览器缩放的方式定位元素。在放大/缩小时，搜索的输入字段似乎会扩大和缩小，这会打乱网页的布局。所以我的问题是，有谁知道如何在放大和缩小时保持下面标记中元素的初始布局？

更具体地说，我希望输入字段的宽度与其上方的横幅完全相同，同时放大/缩小。

尝试在 google 主页上按 Ctrl + '+' 和 Ctrl + '-' 并注意在放大和缩小时所有内容如何保持完全相同的位置。这就是我试图用我的例子来完成的。

我的标记：

```
<div style="width:1000px; border:2px solid grey;">
    <div style="margin:0px auto 0px auto; width:600px;">
        <img src="http://spiritsentient.com/wp-content/uploads/2009/12/foobar2000_banner1.jpg" style="width:600px; height:150px;">
    </div>
    <div style="width:800px; margin:0px auto 0px 200px;">
        <br/><input type="text" size="94">
        <select>
            <option>Option1</option>
            <option>Option2</option>
            <option>Option3</option>
        </select>
    </div>
    <div style="width:30px; margin:0px auto 0px auto;" >
        <input type="submit" value="search">
    </div>
</div> 
```

jsfiddle：

[http://jsfiddle.net/QbQS7/](http://jsfiddle.net/QbQS7/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T14:09:26.610

主要问题是对容器 div 使用 width="1000px"，尝试使用 % 代替，例如 width="100%"。或者至少使元素居中。

然后你有包含搜索框的 div 向左对齐 200px，尝试将其转换为 % 或简单地使用 margin: 0px auto;

最后声明文本输入和选择输入的宽度，因此它们在某些缩放尺寸下不会重叠。如果元素的父元素已声明宽度，则向元素声明宽度通常是个好主意。

见下文：

```
<div style="width:100%; border:2px solid grey;">
 <div style="margin:0px auto 0px auto; width:600px;">
     <img src="http://spiritsentient.com/wp-content/uploads/2009/12/foobar2000_banner1.jpg" style="width:600px; height:150px;">
 </div>     
 <div style="width:800px; margin:0px auto;">
     <input type="text" style="width: 600px" size="94">
     <select style="width: 150px;">             
      <option>Option1</option>             
      <option>Option2</option>             
      <option>Option3</option>         
     </select>     
  </div>     
  <div style="width:30px; margin:0px auto 0px auto;" >
     <input type="submit" value="search">     
  </div> 
 </div> ​ 
```

# objective-c - Objective-C 按内部数组的值对数组进行排序

> ID：11121206
> 
> 赞同：1
> 
> 时间：2012-06-20T13:55:08.473
> 
> 标签：objective-c, sorting, multidimensional-array, indexing

我想对具有 NSArrays 的 NSMutableArray 进行排序，该 NSMutableArray 相对于 NSArray 的索引 1 处的值。我将尝试绘制数组的图片。

```
NSMutableArray *ultimateHighscoreArray = { 
    ( (NSString) userName, (double) score, (int) numOfCorrectAnswers ) , 
      ( John , 4.5 , 3 ) , 
      ( Terry , 7.5 , 1) , 
                                     ... } 
```

NSMutableArray 中的第一个数组是一个示例，它显示了示例的位置。第二和第三是价值观的实际情况。所以，我想要的是对这些数组进行排序，这些数组在第一个索引处包含更高值的数组，以便在排名中更高。对于此示例，具有 7.5 的数组（即 Terry 数组）应位于具有 4.5 的数组之前。我希望将结果按降序保存在 NSMutableArray 中。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:05:57.533

这应该这样做：

```
[ultimateHighscoreArray sortUsingComparator:^(id obj1, id obj2) {
    NSNumber *score1 = [obj1 objectAtIndex:1];
    NSNumber *score2 = [obj2 objectAtIndex:2];

    // Reverse the comparison here (compare score2 to score1)
    // in order to get a descending order
    return [score2 compare:score1];
}]; 
```

`NSDictionary`一般建议：如果它是一个实例数组甚至是一个自定义对象数组（例如，您的自定义`Score`类） ，您的数据结构会更清晰。在这些情况下，您还可以使用`NSSortDescriptor`对数组进行排序，这将产生更清晰、更易于阅读的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T14:06:05.420

该`sortUsingComparator:`方法允许您使用块对数组进行排序，例如：

```
[ultimateHighscoreArray sortUsingComparator:^(id obj1, id obj2) {
    return [[obj1 objectAtIndex:1] compare:[obj2 objectAtIndex:1]];
}]; 
```

为清楚起见，最好为此数据结构使用字典数组（或自定义类的实例）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T14:05:53.743

您可以像这样编写自定义比较器:)

```
[ultimateHighscoreArray sortUsingComparator:^NSComparisonResult(id obj1, id obj2) {
    NSArray *arrayA = (NSArray *)obj1;
    NSArray *arrayB = (NSArray *)obj2;

    double scoreA = [arrayA objectAtIndex:1];
    double scoreB = [arrayB objectAtIndex:1];

    if (scoreA > scoreB) {
        return NSOrderedDescending;
    } else if (scoreA < scoreB) {
        return NSOrderedAscending;
    } else {
        return NSOrderedSame;
    }
}]; 
```

# vb.net - VB.NET打字机效果

> ID：11121215
> 
> 赞同：-3
> 
> 时间：2012-06-20T13:55:32.607
> 
> 标签：vb.net, winforms

我想让打字机效果像：http:
[//img139.imageshack.us/img139/9775/screenshot0002mm2.gif](http://img139.imageshack.us/img139/9775/screenshot0002mm2.gif)

```
dim s as string = "123"
label1.text = s.substring(0,1)
WAIT
label1.text = s.substring(0,2)
WAIT
label1.text = s.substring(0,3) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T13:58:03.560

```
Public str As String
Public count As Integer 
```

Form1_Load：

```
 Label1.Text = ""
 count = 1
 str = ":D test 12345678910"
 Timer1.Enabled = True 
```

timer_tick：

```
If Label1.Text.Length = str.Length Then
    Timer1.Enabled = False
    Exit Sub
End If
Label1.Text = str.Substring(0, count)
count = count + 1 
```

只需使用计时器:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T14:04:51.043

声明计时器：

对于字符串中的每个字符

控制台.writeline（字符）

//或者您可以将其写入文本框。Textbox.text=Textbox.text & 字符

添加时间（可以设置每个字符之间的延迟）

结束

# xml - 以 id="key" value="value" 属性格式读取 XML？

> ID：11121218
> 
> 赞同：5
> 
> 时间：2012-06-20T13:55:37.507
> 
> 标签：xml, extjs, extjs4

如何将属性格式的 XML 读入 ExtJS 存储，其中键/值在一行上指定为 id/值？我更熟悉下面给出的第二种格式。

```
<?xml 版本="1.0" 编码="UTF-8"?>
<XML响应>
    <数据>
        <行>
            <column id="title" value="星球大战"/>
            <column id="导演" value="卢卡斯"/>
            <column id="year" value="1977"/>
        </row>
        <行>
            <column id="title" value="Jaws"/>
            <column id="导演" value="斯皮尔伯格"/>
            <column id="year" value="1975"/>
        </row>
    </数据>
</XML响应>

```

更传统的 XML 编写方式。

```
<?xml 版本="1.0" 编码="UTF-8"?>
<XML响应>
    <数据>
        <行>
            <title>星球大战</title>
            <导演>卢卡斯</导演>
            <年>1977 年</年>
        </row>
        <行>
            <title>大白鲨</title>
            <导演>斯皮尔伯格</导演>
            <年>1975 年</年>
        </row>
    </数据>
</XML响应>

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T17:49:46.833

它的文档记录不是很好，但是您的字段的映射可以是[Ext.dom.Query](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.dom.Query)接受的任何表达式。因此，您通常有一个简单的“title”映射来选择一个名为“title”的子标签，您可以包含一个更复杂的选择器。在这种情况下，您要选择 ID 属性与您要查找的字段名称匹配的“列”标签的“值”属性，因此在您的模型或商店中，您可以像这样定义您的字段：

```
fields: [
    { name: 'title', mapping: 'column[id=title]@value' },
    { name: 'director', mapping: 'column[id=director]@value' },
    { name: 'year', mapping: 'column[id=year]@value' }
], 
```

# php - PHP Curl 在加载图像时有时会出现 404 错误，但它适用于 file_get_contents() 为什么会这样？

> ID：11121220
> 
> 赞同：1
> 
> 时间：2012-06-20T13:55:43.767
> 
> 标签：php, curl, header

有时我在尝试通过 curl 访问网页时遇到 404 错误，但如果我使用 file_get_contents 访问它工作的完全相同的 URL，知道为什么会这样吗？

这是一个示例：我的 curl 设置：

```
curl_setopt($this->ch, CURLOPT_USERAGENT, $this->UserAgent);
curl_setopt($this->ch, CURLOPT_AUTOREFERER, TRUE);
curl_setopt($this->ch, CURLOPT_FOLLOWLOCATION, TRUE);
curl_setopt($this->ch, CURLOPT_COOKIEFILE, $this->CookieFile);
curl_setopt($this->ch, CURLOPT_COOKIEJAR, $this->CookieFile);
curl_setopt($this->ch, CURLOPT_RETURNTRANSFER, TRUE);
curl_setopt($this->ch,CURLOPT_VERBOSE,true);
curl_setopt($this->ch,CURLOPT_HEADER,true);
curl_setopt($this->ch,CURLOPT_ENCODING, "gzip");
curl_setopt($this->ch, CURLOPT_CONNECTTIMEOUT, 30);
curl_setopt($this->ch, CURLOPT_TIMEOUT, 30); 
```

我的 Firefox 网络浏览器的请求标头：

```
GET /image.png HTTP/1.1
Host: ssl.website.net
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:13.0) Gecko/20100101 Firefox/13.0.1
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: de-de,de;q=0.8,en-us;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: keep-alive
Cookie: some cookie info
Cache-Control: max-age=0 
```

响应头：

```
HTTP/1.1 200 OK
Date: Wed, 20 Jun 2012 13:38:43 GMT
Content-Type: image/png
Transfer-Encoding: chunked
Connection: close
Pragma: no-cache
Cache-Control: no-cache
Server: '; DROP TABLE servertypes; -- 
```

# python - 遍历目录并在python中返回文本

> ID：11121223
> 
> 赞同：0
> 
> 时间：2012-06-20T13:56:00.147
> 
> 标签：python

有没有人有代码在搜索文本值时遍历目录和子目录？然后一旦找到返回python中的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T13:58:55.117

首先，`os.walk()`返回一个遍历给定目录树的 Python 生成器。对于树中遇到的每个目录，生成器返回一个 3 元组`(dirpath, dirnames, filenames)`。您将需要`os.walk()`在循环中使用

然后，内置`open()`函数用于返回一个`file`对象，您可以从中读取文件的内容。`read()`将读取文件的全部内容，而`readlines()`一次读取一行。

假设您要查找的文本不能位于多行上，以便一次处理一行文件是安全的，您可以按照以下方式执行操作：

```
import os
import re

matching_files = []

root = "/path/to/root/folder/you/want/to/walk"
# Navigate the directory structure starting at root
for root, dirs, files in os.walk(root):
    # For each file in the current directory
    for file_name in files:
        # Reconstruct the full path
        file_path = os.path.join(root, file_name)
        # Open the file
        with open(file_path, 'r') as f:
            # Read the file one line at a time
            for line in f.readlines():
                 # Look for your text in the current line
                 if re.findall(r'text_you_are_searching_for', line):
                     matching_files.append(file_path) 
```

您可以在有关的在线文档中获取更多详细信息

*   [os.walk](http://docs.python.org/library/os.html#os.walk)
*   Python[文件对象](http://docs.python.org/library/stdtypes.html#bltin-file-objects)
*   Python中的[正则表达式](http://docs.python.org/library/re.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T13:59:32.063

只需阅读 的文档`[os.walk()](http://docs.python.org/library/os.html#os.walk)`，试一试，如果无法使用，请返回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T14:12:26.517

要实现您自己的 grep，您可以使用`os.walk()`一些基本的文件 I/O。在我们生成代码之前，我们需要更多关于具体要求的信息。

# javascript - Javascript/Jquery：使用数字范围验证输入

> ID：11121227
> 
> 赞同：5
> 
> 时间：2012-06-20T13:56:20.627
> 
> 标签：javascript, jquery

我想验证预先配置的数字范围内的输入字段。只允许从 1 到 24 的数字。

我能怎么做？

* * *

使用这样的自定义解决方案：

```
 $('.field').keypress(function(event) {
        var val = parseInt($(this).val()) + HERE_I_SHOULD_SUM_THE_NEWLY_ADDED_DIGIT;
        if(val < 1 || val > 24) event.preventDefault();
    }); 
```

我能够检索当前输入值。如何添加新添加的数字？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-20T14:02:25.727

这样的事情怎么样？

```
​$("input").on("change", function() {
    var val = Math.abs(parseInt(this.value, 10) || 1);
    this.value = val > 25 ? 24 : val;
});​​​​​​​​​​​​​ 
```

**演示：http:** [//jsfiddle.net/3jw4S/](http://jsfiddle.net/3jw4S/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T14:13:28.153

现代浏览器中有用于输入的内置功能：

可以在此处找到全面的概述：[http ://www.the-art-of-web.com/html/html5-form-validation/](http://www.the-art-of-web.com/html/html5-form-validation/)

基本上，你可以写：

```
<input type="number" min="1" max="24" step="1" required> 
```

使用模式，您可以定义正则表达式进行测试：

```
pattern="\d[0-3]" 
```

**[例子](http://jsfiddle.net/EDnYZ/1/)**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T13:59:48.150

有一个用于 JQuery 的插件可以帮助您进行名为 Valid8 的验证：

[http://unwrongest.com/projects/valid8/](http://unwrongest.com/projects/valid8/)

您将需要使用正则表达式，例如：

```
^([1-9]|[1]?[1-9]?|[2][0-4]|10)$ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T14:01:29.067

```
function validateForm()
{
var x=document.forms["myForm"]["fname"].value;
if (x==null || x <1|| x >24)
  {
  alert("Value must be between 1 & 24");
  return false;
  }
} 
```

沿着这些思路的东西应该起作用

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-20T14:08:40.923

试试这个

```
function validate() {
 var x = parseInt(value,10) // its the value from the input box;
 if(isNaN(x)||x<1||x>24)
 {
  alert("Value must be between 1 and 24");
  return false;
  }
} 
```

# c# - 在 C# 中打开多个文件并检查每个文件的内容

> ID：11121229
> 
> 赞同：0
> 
> 时间：2012-06-20T13:56:26.680
> 
> 标签：c#, winforms, openfiledialog

我想要做的是打开多个文件并从每个文件中读取文本并检查某些关键字并将它们全部打印到一个新文件中，一旦完成，将使用所有关键字创建一个新文件。我已经在使用 foreach 来遍历所有文件名，并且我知道如何打开多个文件，但是在同时打印的同时检索内容并检查某些条件呢？

下面只是我到目前为止的一个例子，非常标准的东西。

多谢你们！

```
 if (dr == System.Windows.Forms.DialogResult.OK)
        {
            // Read the files
            foreach (String file in openFileDialog1.FileNames)
            {

                try
                {

                    listView1.Items.Add(file);

                }
                catch (SecurityException ex)
                {
                    // The user lacks appropriate permissions to read files, discover paths, etc.
                    MessageBox.Show("Security error. Please contact your administrator for details.\n\n" +
                        "Error message: " + ex.Message + "\n\n" +
                        "Details (send to Support):\n\n" + ex.StackTrace
                    );
                }
                catch (Exception ex)
                {
                    // Could not load the image - probably related to Windows file system permissions.
                    MessageBox.Show("Cannot display the image: " + file.Substring(file.LastIndexOf('\\'))
                        + ". You may not have permission to read the file, or " +
                        "it may be corrupt.\n\nReported error: " + ex.Message);
                }

            }

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T13:59:16.663

要读取文件，请使用`System.IO.File.ReadAllText()`. 这会将所有内容放入一个字符串变量中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T14:11:54.717

您可以像 SoMoS 建议的那样使用[System.IO.File.ReadAllText()](http://msdn.microsoft.com/en-us/library/system.io.file.readalltext.aspx)读取文件。[以最有效的方式搜索字符串并使用](http://msdn.microsoft.com/en-us/library/ms228630%28v=vs.80%29.aspx)[StreamWriter](http://msdn.microsoft.com/en-us/library/system.io.streamwriter.aspx)写回数据

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T14:32:45.167

```
Try
            Using sr As New StreamReader("TestFile.txt")
                Dim line As String
                Do
                    line = sr.ReadLine()
                    If Not (line Is Nothing) Then
                       Console.WriteLine(line)
                    End If
                Loop Until line Is Nothing
            End Using
        Catch e As Exception
            Console.WriteLine("The file could not be read:")
            Console.WriteLine(e.Message)
        End Try 
```

;)

# c# - TeeChart WPF - 更改系列类型问题 - 保留原始，混合样式

> ID：11121237
> 
> 赞同：1
> 
> 时间：2012-06-20T13:56:38.130
> 
> 标签：c#, .net, wpf, teechart

所以我正在构建一个 WPF TeeChart 编辑器，但我在尝试使用静态方法更改图表上的系列类型时遇到了一些问题：
`Steema.TeeChart.WPF.Styles.Series.ChangeType(ref Series s, Type newType)`

原代码思路：

```
//user has selected a sample chart showing the Series Type they want
Type targetType = selectedChart.Series[0].GetType();

//SelectedItems contains Series objects already on a chart
for (int i = 0; i < SelectedItems.Count; i++)
{
    Series sS = (Series) SelectedItems[i];
    Series.ChangeType(ref sS, targetType);
} 
```

当上面的代码运行时，我的图表最终有两个系列：原始系列和一个新系列，它是原始和目标的某种混合。

例如，如果我在图表上放置了一个带有 4 个随机值的点系列，然后运行上面的代码，在 SelectedItems 中唯一的东西就是我刚刚创建的点系列，我的图表有一个新的系列类型 Line 但带有点标记它，以及原来的点系列。

我修改了上面的代码以删除重复项，然后我意识到有些东西正在从 SelectedItems 集合中删除其他项目。下面是删除原始系列的最终代码，并且在 SelectedItems 集合中有多个系列时也可以使用。

```
//Added List to keep selected items since they were being lost
List<Series> selected = new List<Series>(SelectedItems.Count);
for (int x = 0; x < SelectedItems.Count; x++)
    selected.Add((Series) SelectedItems[x]);

for (int i = 0; i < selected.Count; i++)
{
    Series sS = selected[i];
    int cI = chart.Series.IndexOf(sS); //added to track index in chart

    Series.ChangeType(ref sS, targetType);

    //The following line ensures overwite of original Series in chart
    // since new Series is being created inside above method
    chart.Series[cI] = sS;

    //finally, remove original Series from chart
    chart.Series.Remove(selected[i]);
} 
```

这解决了将原始系列留在图表上的问题，但我仍然无法弄清楚为什么系列的样式会变成原始系列和目标系列类型的某种奇怪混合。

在我的方法中有什么我遗漏或忽略的东西吗？有没有更好的方法来改变系列的类型？我无法在 TeeChart 文档中找到任何有用的信息。

我不认为这种行为是有意的，因为当我将此方法获得的输出与 WinForms TeeChart 编辑器进行比较时，WinForms 版本不会混合系列的样式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T09:42:41.260

恐怕这是 TeeChartWPF 的错误，我们已将其添加到错误列表报告中，编号为 [TW16016232]。我们将尝试将其修复到即将发布的 TeeChartFor.Net 维护版本。另一方面，我建议您使用一种解决方法来解决您的问题，在这种情况下，它包括将源系列替换为点系列。

```
 private void InitializeChart()
        {
            tChart1.Series.Clear();
            Steema.TeeChart.WPF.Styles.Line line1 = new Steema.TeeChart.WPF.Styles.Line(tChart1.Chart);
            Steema.TeeChart.WPF.Styles.Line line2 = new Steema.TeeChart.WPF.Styles.Line(tChart1.Chart);
            line2.FillSampleValues();
            line1.FillSampleValues();

        }

        private void button1_Click(object sender, RoutedEventArgs e)
        {
            for (int i = 0; i < 2; i++)
            {
                Steema.TeeChart.WPF.Styles.Points s = new Steema.TeeChart.WPF.Styles.Points(tChart1.Chart);
                s.DataSource = tChart1[i];
                tChart1[i].Visible = false;
            }

        } 
```

你能告诉我们，如果以前的代码现在按你预期的那样工作吗？

我希望会有所帮助。

谢谢，

最好的问候，桑德拉帕索斯

Steema 支持中心 [http://www.steema.com/](http://www.steema.com)

# multithreading - boost::asio 中的动态线程池示例

> ID：11121238
> 
> 赞同：7
> 
> 时间：2012-06-20T13:56:40.923
> 
> 标签：multithreading, boost, boost-asio

我将使用单线程池实现 boost::asio 服务器`io_service`（[HTTP Server 3 示例](http://www.boost.org/doc/libs/1_45_0/doc/html/boost_asio/examples.html)）。`io_service`将绑定到 unix 域套接字并将请求从该套接字上的连接传递到不同的线程。为了减少资源消耗，我想让线程池动态化。

这是一个概念。首先创建一个线程。当请求到达并且服务器发现池中没有空闲线程时，它会创建一个新线程并将请求传递给它。服务器最多可以创建某个最大数量的线程。理想情况下，它应该具有暂停空闲一段时间的线程的功能。

有人做过类似的东西吗？或者也许有人有一个相关的例子？

至于我，我想我应该以某种方式覆盖`io_service.dispatch`以实现这一目标。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-26T16:44:13.157

最初的方法可能存在一些挑战：

*   `boost::asio::io_service`并非旨在派生或重新实现。注意缺少虚函数。
*   如果您的线程库不提供查询线程状态的能力，则需要单独管理状态信息。

另一种解决方案是将工作发布到 中`io_service`，然后检查它在 中放置了多长时间`io_service`。如果它准备好运行和实际运行之间的时间差超过某个阈值，那么这表明队列中的作业比服务队列的线程多。这样做的一个主要好处是动态线程池增长逻辑与其他逻辑分离。

这是一个使用`deadline_timer`.

*   设置为从现在起几秒钟后`deadline_timer`过期。`3`
*   异步等待`deadline_timer`。处理程序将在设置后`3`几秒钟内准备好运行`deadline_timer`。
*   在异步处理程序中，检查相对于计时器设置为过期时间的当前时间。如果大于`2`秒，则`io_service`队列正在备份，因此向线程池添加一个线程。

例子：

```
#include <boost/asio.hpp>
#include <boost/bind.hpp>
#include <boost/thread.hpp>
#include <iostream>

class thread_pool_checker
  : private boost::noncopyable
{
public:

  thread_pool_checker( boost::asio::io_service& io_service,
                       boost::thread_group& threads,
                       unsigned int max_threads,
                       long threshold_seconds,
                       long periodic_seconds )
    : io_service_( io_service ),
      timer_( io_service ),
      threads_( threads ),
      max_threads_( max_threads ),
      threshold_seconds_( threshold_seconds ),
      periodic_seconds_( periodic_seconds )
    {
      schedule_check();
    }

private:

  void schedule_check();
  void on_check( const boost::system::error_code& error );

private:

  boost::asio::io_service&    io_service_;
  boost::asio::deadline_timer timer_;
  boost::thread_group&        threads_;
  unsigned int                max_threads_;
  long                        threshold_seconds_;
  long                        periodic_seconds_;
};

void thread_pool_checker::schedule_check()
{
  // Thread pool is already at max size.
  if ( max_threads_ <= threads_.size() )
  {
    std::cout << "Thread pool has reached its max.  Example will shutdown."
              << std::endl;
    io_service_.stop();
    return;
  }

  // Schedule check to see if pool needs to increase.
  std::cout << "Will check if pool needs to increase in " 
            << periodic_seconds_ << " seconds." << std::endl;
  timer_.expires_from_now( boost::posix_time::seconds( periodic_seconds_ ) );
  timer_.async_wait( 
    boost::bind( &thread_pool_checker::on_check, this,
                 boost::asio::placeholders::error ) );
}

void thread_pool_checker::on_check( const boost::system::error_code& error )
{
  // On error, return early.
  if ( error ) return;

  // Check how long this job was waiting in the service queue.  This
  // returns the expiration time relative to now.  Thus, if it expired
  // 7 seconds ago, then the delta time is -7 seconds.
  boost::posix_time::time_duration delta = timer_.expires_from_now();
  long wait_in_seconds = -delta.seconds();

  // If the time delta is greater than the threshold, then the job
  // remained in the service queue for too long, so increase the
  // thread pool.
  std::cout << "Job job sat in queue for " 
            << wait_in_seconds << " seconds." << std::endl;
  if ( threshold_seconds_ < wait_in_seconds )
  {
    std::cout << "Increasing thread pool." << std::endl;
    threads_.create_thread(
      boost::bind( &boost::asio::io_service::run,
                   &io_service_ ) );
  }

  // Otherwise, schedule another pool check.
  schedule_check();
}

// Busy work functions.
void busy_work( boost::asio::io_service&,
                unsigned int );

void add_busy_work( boost::asio::io_service& io_service,
                    unsigned int count )
{
  io_service.post(
    boost::bind( busy_work,
                 boost::ref( io_service ),
                 count ) );
}

void busy_work( boost::asio::io_service& io_service,
                unsigned int count )
{
  boost::this_thread::sleep( boost::posix_time::seconds( 5 ) );

  count += 1;

  // When the count is 3, spawn additional busy work.
  if ( 3 == count )
  {
    add_busy_work( io_service, 0 );
  }
  add_busy_work( io_service, count );
}

int main()
{
  using boost::asio::ip::tcp;

  // Create io service.
  boost::asio::io_service io_service;

  // Add some busy work to the service.
  add_busy_work( io_service, 0 );

  // Create thread group and thread_pool_checker.
  boost::thread_group threads;
  thread_pool_checker checker( io_service, threads,
                               3,   // Max pool size.
                               2,   // Create thread if job waits for 2 sec.
                               3 ); // Check if pool needs to grow every 3 sec.

  // Start running the io service.
  io_service.run();

  threads.join_all();

  return 0;
} 
```

输出：

```
将检查池是否需要在 3 秒内增加。
作业作业排队等待 7 秒。
增加线程池。
将检查池是否需要在 3 秒内增加。
作业作业在队列中等待了 0 秒。
将检查池是否需要在 3 秒内增加。
作业作业在队列中等待了 4 秒。
增加线程池。
将检查池是否需要在 3 秒内增加。
作业作业在队列中等待了 0 秒。
将检查池是否需要在 3 秒内增加。
作业作业在队列中等待了 0 秒。
将检查池是否需要在 3 秒内增加。
作业作业在队列中等待了 0 秒。
将检查池是否需要在 3 秒内增加。
作业作业在队列中等待了 3 秒。
增加线程池。
线程池已达到最大值。示例将关闭。
```

# android - Android-如何在不创建应用程序或服务的情况下记录现有信息

> ID：11121239
> 
> 赞同：0
> 
> 时间：2012-06-20T13:56:42.970
> 
> 标签：android, logging, kernel

如何在不创建应用程序或服务（不安装任何应用程序）的情况下在 android 中记录现有信息。例如，如果我想在不编写应用程序的情况下每分钟记录连接的 wifi BSSID。我只想记录一个已经存在的信息。我想创建一个内置模块。我准备更改内核或任何层并刷新手机。但我不想安装启动服务或任何类似的应用程序。如果您能提供一些建议或链接和示例，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T14:00:19.303

您想记录您不拥有或创建的应用程序的现有信息吗？

这似乎是一项复杂的任务。您几乎要求反编译所说的 APK，添加一些日志记录然后重建。

您最好的选择是通过 Android Debug Bridge 了解“adb logcat”，并希望您想要记录的任何内容都已被记录，因为我认为这是一项艰巨的任务。

# http - 如何将多个cookie从服务器端写入浏览器？

> ID：11121240
> 
> 赞同：0
> 
> 时间：2012-06-20T13:56:44.683
> 
> 标签：http, setcookie

我正在使用[vert.x](http://vertx.io/)编写应用程序。它还没有内置 cookie 支持，我们必须使用“putHeader()”方法手动设置 cookie。

现在我想设置几个cookie，所以我写：

```
 req.response.putHeader("Set-Cookie", "aaa=111; path=/")
 req.response.putHeader("Set-Cookie", "bbb=222; path=/")
 req.response.putHeader("Set-Cookie", "ccc=333; path=/") 
```

但我发现 vert.x 只发送一个“Set-Cookie”：

```
 Set-Cookie ccc=333; path=/ 
```

我不确定我是否误会了什么。服务器可以一次发送多个“Set-Cookie”命令吗？以这种方式发送多个 cookie 是否正确？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-11-07T14:45:18.197

使用netty的`io.netty.handler.codec.http.ServerCookieEncoder`功能：

```
req.response.putHeader("Set-Cookie", 
        ServerCookieEncoder.encode(new DefaultCookie("aaa", "111"))) 
```

有许多有用的方法签名：

```
ServerCookieEncoder.encode(Cookie cookie)
ServerCookieEncoder.encode(Cookie... cookies)
ServerCookieEncoder.encode(Collection<Cookie> cookies)
ServerCookieEncoder.encode(Iterable<Cookie> cookies) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T19:51:29.263

我认为不，开箱即用是不可能的，因为标头存储在 HashMap 中： [https ://github.com/purplefox/vert.x/blob/master/src/main/java/org/vertx/java/core/http /impl/DefaultHttpServerResponse.java#L81](https://github.com/purplefox/vert.x/blob/master/src/main/java/org/vertx/java/core/http/impl/DefaultHttpServerResponse.java#L81)

你可以：

*   打开新问题
*   评论现有问题[https://github.com/purplefox/vert.x/issues/89](https://github.com/purplefox/vert.x/issues/89)
*   签出源并使用允许重复键 的映射 使用重复键[的映射实现](https://stackoverflow.com/questions/1062960/map-implementation-with-duplicate-keys)（您需要手动处理重复项，例如 Location-header 应该只有一次
*   扩展 DefaultHttpServerResponse 并查看如何集成它
*   合并 cookie 并手动处理，例如：

    req.response.putHeader("Set-Cookie", "aaa=111&bbb=222&ccc=333; path=/")

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-02T08:22:23.287

有一个工作区。

```
req.response()
.putHeader("Set-Cookie", "some=cookie;max-age=1000;path=/;HttpOnly"
    +"\nSet-Cookie: next=cookie"
    +"\nSet-Cookie: nnext=cookie;HttpOnly"); 
```

# jquery - Jquery Ajax 不发送发送邮件表单

> ID：11121243
> 
> 赞同：0
> 
> 时间：2012-06-20T13:56:56.133
> 
> 标签：jquery

我正在尝试使用 AJAX 和 PHP 发送电子邮件，但没有成功:(
我的成功函数提醒我它正在**工作**，但我的邮箱中什么也没有。PHP 表单位于我的 ROOT 文件夹中并且它正在工作，所以我知道它是不是 PHP 问题。已经尝试了几个小时来解决这个问题，但没有效果。有人可以帮忙吗？THX !!!这是我的**console.log**显示的内容：

name=MY NAME&email=dejo.dekic@yahoo.com&message=SOME MESSAGE pagepays。 js
POST [http://www.homepagepays.robertpeic.com/kontakt.php](http://www.homepagepays.robertpeic.com/kontakt.php) 200 OK 284ms 我的 jquery 代码如下所示：

```
 $('#button').click(function(){
      var name = $('#name').val();
      var email = $('#email').val();
      var message = $('#message').val();

      var data ='name=' + name + '&email=' + email + '&message=' + message;
      console.log(data);
      $.ajax({
      type:"POST",
      url:'kontakt.php',
      data: data,
      success: function(){
      alert('Working!');
      }

      });
      return false;
      }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:13:29.287

我看不出你的 jQuery 有什么问题。如果您使用 URL 中的变量或电子邮件页面中的一些默认值加载它，您的 php 页面实际上是否会向您发送电子邮件？

您可以尝试通过获取数据然后在您的 php 页面中使用它来打印出 php 页面正在接收的数据。

```
print("$name - $email - $message"); 
```

然后将您的 jQuery ajax 调用更改为此；

```
$.ajax({
  type:"POST",
  url:'kontakt.php',
  data: data,
  success: function(response){
    alert(response);
  }
}); 
```

这应该告诉您 php 页面是否正在使用 ajax 调用和您发送的数据。如果您没有取回您期望的数据，那么 php 页面获取其变量的方式一定有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T14:16:12.660

您可能需要对您传递的值进行 URI 编码。如果任何字段有`=`或`&`，它可能会使您的 URL 关闭。当然，根据我上面的评论，我认为您应该序列化您的表单并对其进行编码，也可以按照您的方式完成。

```
 var name = encodeURIComponent($('#name').val());
  var email = encodeURIComponent($('#email').val());
  var message = encodeURIComponent($('#message').val()); 
```

JSFiddle：http: [//jsfiddle.net/UXZQk/5/](http://jsfiddle.net/UXZQk/5/)

# c# - WP7 中的 IsolatedStorageFileStream 不允许操作

> ID：11121244
> 
> 赞同：0
> 
> 时间：2012-06-20T13:56:57.120
> 
> 标签：c#, .net, windows-phone-7, isolatedstorage

我试图从 URL 获取图像并将其存储在我的隔离存储中，然后从隔离存储中获取图像这里是我的相关代码：

```
public void GetImages()
{
    string uri = "http://sherutnetphpapi.cloudapp.net/mini_logos/" + path;
    WebClient m_webClient = new WebClient();
    imageUri = new Uri(uri);   
    m_webClient.OpenReadAsync(imageUri);
    m_webClient.OpenReadCompleted += new OpenReadCompletedEventHandler(webClient_ImageOpenReadCompleted);
    m_webClient.AllowReadStreamBuffering = true;  
}

void webClient_ImageOpenReadCompleted(object sender, OpenReadCompletedEventArgs e)
{
    string iso_path = "~/SherutApp1;component/" + path;
    var isolatedfile = IsolatedStorageFile.GetUserStoreForApplication();
    using (IsolatedStorageFileStream stream = new IsolatedStorageFileStream(iso_path, FileMode.Create, isolatedfile))                                                                    
    {

        byte[] buffer = new byte[e.Result.Length];
        while (e.Result.Read(buffer, 0, buffer.Length) > 0)
        {
            stream.Write(buffer, 0, buffer.Length);
        }
    }
} 
```

我在这一行的标题处得到了例外：

```
using (IsolatedStorageFileStream stream = new IsolatedStorageFileStream(iso_path, FileMode.Create, isolatedfile)) 
```

我不知道是什么问题，尽管我认为图像可能没有正确插入到隔离存储中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:04:11.027

我不认为你需要`"~/SherutApp1;component/"`那里的部分。如果你整个路径是`"test.jpg"`或者`"folderThatExists\\test.jpg"`它应该工作。

# c# - 如何在 ScriptManager 中更改注册脚本的顺序

> ID：11121251
> 
> 赞同：8
> 
> 时间：2012-06-20T13:57:22.043
> 
> 标签：c#, asp.net, .net, master-pages

## 背景

在我们的母版页中，我们有一个`ScriptManager`看起来像这样的

```
<asp:ScriptManager ID="ScriptManager" runat="server" EnablePartialRendering="False" EnableScriptLocalization="true">
    <Scripts>
        <asp:ScriptReference Path="~/js/master.js" />
        <asp:ScriptReference Path="~/js/jquery-min.js" />
    </Scripts>
</asp:ScriptManager> 
```

我正在通过执行以下操作在页面上的嵌套控件中注册其他脚本

```
protected override void OnPreRender(EventArgs e)
{
    ScriptManager.RegisterClientScriptInclude(this, this.GetType(), "jquery-ui", "~/js/jquery-ui.js");
    base.OnPreRender(e);
} 
```

## 预期的

1.  大师.js
2.  jquery-min.js
3.  jQuery-ui.js *

## 实际的

1.  jQuery-ui.js *
2.  大师.js
3.  jquery-min.js

## 问题

有什么办法可以改变注册脚本的加载顺序吗？

*- 或者 -*

是否可以至少确保在实际`ScriptManager`块中注册的脚本在代码隐藏注册脚本之前注册？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T09:22:40.870

在深入研究`ScriptManager`源代码之后，我们可以做出两个有用的观察：

*   添加到管理器的脚本会按照它们出现在集合中的顺序一一注册在页面上`ScriptManager.Scripts`（如果您好奇 - 通过方法`ClientScript.RegisterClientScriptBlock`，而不是在`Render`方法或类似的东西中）。

*   标记中声明的脚本将`ScriptManager.Scripts`在`ScriptManager`对象创建时添加到集合中。

因此，一种方法

> 确保在实际 ScriptManager 块中注册的脚本在代码隐藏注册脚本之前注册

是将控件中的脚本直接添加到`ScriptManager.Scripts`集合中，而不是使用`ScriptManager`类的静态实用程序方法。控件的代码示例如下：

```
protected override void OnPreRender(EventArgs e)
{
    ScriptManager currentScriptManager = ScriptManager.GetCurrent(this.Page);
    if (currentScriptManager != null)
    {
        ScriptReference scriptRef = new ScriptReference("~/js/jquery-ui.js");
        currentScriptManager.Scripts.Add(scriptRef);
    }
    else
    {
        this.Page.ClientScript.RegisterClientScriptInclude(
            this.GetType(), "jquery-ui", "js/jquery-ui.js");
    }

    base.OnPreRender(e);
} 
```

一个小注释 - 正如代码示例中所见，我建议`ScriptManager`在页面上没有的情况下处理案例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-09T14:36:18.160

在您的页面中，使用`<asp:ScriptManagerProxy>`注册您的脚本，它们将按预期顺序出现。在代码隐藏中注册的脚本在 ASPX 被解析之前被添加到脚本管理器中。

# c - 删除 C 中的文件表明未找到该文件

> ID：11121256
> 
> 赞同：1
> 
> 时间：2012-06-20T13:57:46.413
> 
> 标签：c, delete-file

我正在处理 ac 项目，我需要从目录中删除一个文件。出于某种原因，尽管它一直说由于文件或目录不存在而无法删除。下面是我用来删除文件的代码。

```
void deleteOldestLog()
{
    FILE *fp;
    char path[FILE_PATH_BUF_LEN], *fileName;

    fp = popen("ls -tr /home/myfolder/logs/ |head -1", "r");
    if (fp == NULL)
    {
        printf("Failed to run command");
    }
    else
    {
        char removalPath[FILE_PATH_BUF_LEN];
        while ((fileName = fgets(path, sizeof(path)-1, fp)) != NULL)
        {
            sprintf(removalPath, "/home/myfolder/logs/%s", fileName, sizeof(fileName)-1);

            printf("Removing file: %s", removalPath);
            if (remove(removalPath) != 0)
            {
                perror("ERROR DELETING LOG");
            }
            else
            {
                printf("Successfully deleted %s", removalPath);
            }
            break;
        }
        pclose(fp);
    }
} 
```

即使它说它找不到文件，因为它不存在，但我知道这不是真的，因为如果我运行`ll`后跟 c 程序打印的路径，它会返回我试图删除的文件。

我认为这可能是因为 fgets 将 '\0' 放在阻止删除工作的字符串的末尾。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T14:02:12.197

读取的文件名末尾有一个换行符`fgets()`。您的文件名实际上并不以换行符结尾。

您尝试使用以下方法删除换行符：

```
sprintf(removalPath, "/home/myfolder/%s", fileName, sizeof(fileName)-1); 
```

但是，为了有效，您需要使用`strlen()`而不是`sizeof()`，并且您需要修改格式字符串：

```
sprintf(removalPath, "/home/myfolder/%.*s", (int)strlen(fileName)-1, fileName); 
```

的参数`*`必须是 an`int`并`strlen()`返回 a `size_t`; 因此演员。（如果您打开警告，GCC 会警告这类事情；至少使用`-Wall`.）

给您的提示：如有疑问，请打印字符串。我通常会使用这样的格式。注意字符串周围的尖括号：

```
printf("Removing: <<%s>>\n", removalPath); 
```

当你看到：

```
Removing: <</home/myfolder/something
>> 
```

您知道字符串中的换行符有问题。如果没有标记，您可能不会注意到字符串中的换行符导致输出中出现额外的换行符。

* * *

> 为什么需要修改格式字符串？

我们再来看看原文`sprintf()`：

```
sprintf(removalPath, "/home/myfolder/%s", fileName, sizeof(fileName)-1); 
```

格式字符串需要 1 个参数，一个字符串。该调用提供了两个值，一个字符串和一个长度。所以，第一个问题是有一个剩余的参数。这通常不会造成损害，但请注意这一点。据推测，传递长度减一的原因是丢失了最后一个字符。系列中的格式`printf()`可以用一个或两个数字装饰，其中一个或两个都可以有一个`*`而不是一个整数值。这些数字限制了格式化值的长度。当你写：

```
%.*s 
```

您声明输出的长度应`int`与字符串本身之前作为参数传递的值指定的长度完全相同。因此修订：

```
sprintf(removalPath, "/home/myfolder/%.*s", (int)strlen(fileName)-1, fileName); 
```

（我在添加此信息时刚刚修复。）

我也没有在`sprintf()`etc 的输出中添加错误检查。这并不罕见；但是，最佳编码实践确实可以确保函数之类`sprintf()`的返回您期望的值（这是写入字符串的字符数，不包括结尾的 null `'\0'`。

（旁白：一般来说，使用`snprintf()`比`sprintf()`; 更好，可以避免缓冲区溢出。

```
snprintf(removalPath, sizeof(removalPath), "/home/myfolder/%.*s",
         (int)strlen(fileName)-1, fileName); 
```

但是，`*snprintf()`MSVC 下的函数行为不同于 C 标准（C99、C11）规定的行为。更糟糕的是，对于 of`vsnprintf_s()`和其他`_s`函数，MSVC 和 C 标准之间的参数列表是不同的。）

# linux - 为什么没有适用于 Linux 的 DirectX API？

> ID：11121258
> 
> 赞同：21
> 
> 时间：2012-06-20T13:57:49.410
> 
> 标签：linux, directx, drivers

在考虑现代视频卡的 Windows 系统上 DirectX API 的驱动程序端实现时，我想知道为什么此实现在非 Windows 系统上不可用，尤其是 linux。

由于明显缺乏此功能，我只能假设有一个我不知道的充分理由，但在我的原始理解中，我只是将 DirectX 调用视为硬件设备上的函数入口点。为了记录，我指的不是兼容层（最值得注意的是 WINE，一个我每天都为之惊叹的项目），而是一个直接进行硬件调用的库。

是否可以创建 Directx 的开源版本？这可能但非常困难吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-20T14:14:46.933

AFAIK，DirectX 包含 3 个部分

*   供应商驱动程序（提供 DX 定义的低级 API）
*   DirectX 库（使用 DX 定义的低级 API 访问硬件，提供 DirectX API）
*   软件（使用 DirectX API，例如游戏）

linux上没有提供DX定义的低级API的驱动，所以即使提供DirectX库也是可以的，但是如果没有合适的厂商驱动就不行，我也看不到有没有厂商在为他们的硬件平台创建一个。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-20T14:10:06.210

为什么不直接使用 OpenGL？它支持 DirectX 的所有功能。您有使用 DirectX 的特定理由吗？至于一个原因，[微软制造了 DirectX](http://en.wikipedia.org/wiki/DirectX#History)，我猜他们认为没有必要让它在 Linux 上运行。

您可以[使用 Wine 在 Linux 中运行 DirectX 游戏](http://www.dedoimedo.com/games/wine-directx.html)。[您可以使用MonoGame](http://monogame.codeplex.com/)在 Linux 上对 XNA 进行编程。但所有这些都使用 OpenGL 来提供硬件加速渲染。AFAIK，在可预见的未来，OpenGL 一直是（并且可能会是）Linux 上的唯一选择。

是否可以编写自己的 DirectX 实现？当然 - 但它涉及编写驱动程序、专有知识以及任何人都可能真正从中受益的成本太高。

编辑：如今，[DXVK](https://github.com/doitsujin/dxvk)是在 Linux 上运行 DirectX 应用程序的一种非常真实和高效的方式。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-12-29T09:02:35.853

DirectX 是一套 API：

*   **Direct3D**（绘制 3D 图形）
*   **DirectX 图形基础结构**（枚举适配器和监视器以及管理交换链）
*   **Direct2D** （绘制 2D 图形）
*   **DirectWrite**（字体）
*   **直接**计算（GPU 计算）
*   **DirectSound3D**（播放 3D 声音）
*   **DirectX 媒体**（用于 2D/3D 网络动画的 DirectAnimation，用于多媒体播放和流媒体的 DirectShow，用于网络交互的 DirectX 变换，以及用于更高级别 3D 图形的 Direct3D 保留模式）
*   **DirectX 诊断**（用于诊断和生成与 DirectX 相关的组件（例如音频、视频和输入驱动程序）的报告的工具）
*   **DirectX 媒体对象**（支持编码器、解码器和效果等流对象）
*   **DirectSetup**（安装 DirectX 组件，并检测当前 DirectX 版本）

DirectX 组件已弃用，但仍受支持

*   **直接绘图**
*   **直接输入**
*   **直接播放**
*   **直接声音**
*   **直接音乐**

正如您所看到的，DirectX API 套件的许多部分都需要使用为 Linux 编写的驱动程序的功能重写。此外，DirectX 诉讼的某些部分可能会调用 Windows 操作系统，并且必须为 Linux 机器重写代码，而不会侵犯 DirectX 或 Windows 操作系统的复制部分。

是的，您可以编写一个开源 API 套件，它与 DirectX for Linux 做同样的事情，但是如果没有他们的 Linux 制造商对声音和图形驱动程序/支持的深入了解，这将是一项非常艰巨的任务。

但是，如果您的问题更多的是“我可以获取/编写一些东西来运行使用 DirectX 制作的游戏和程序以在 Linux 上运行吗？” 就其含义而言，总之没有，因为更有可能侵犯版权。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-20T15:20:51.070

为 DirectX 创建端口的工作会产生与您在 WINE 中遇到的相同的问题。它永远不会与 Windows 相同。源自该原则，您将不得不研究 OpenGL 和相关的多平台库。

此时此刻，如果您想使用已有的 DirectX 代码完成某事，WINE 将是您最接近的媒介。再说一次，我不确定 Visual Studio 或普通打字会以何种方式让您更接近流利的环境。WINE 库与原生库相距不远，但始终存在仿真，在我诚实的观点中，在某种程度上是可以接受的。

如果我看看《最终幻想 XIV》在我的 iMac（2011 年）的完整设置上运行得多么出色，我认为依靠 WINE 的实现并没有那么糟糕。该游戏与我的 iMac 上的 Bootcamp (Windows) 完全一样。

如果您真的想在这方面开展工作，您可以尝试在他们的论坛或邮件列表中询问 WINE 开发人员，您如何才能仅使用他们的 DirectX 兼容性的实现并在您的项目中使用它。您可以在其中调用库而不是通过 Windows 模拟的系统调用请求 DirectX。

编辑：我也完全同意 user956030 的回答。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-01-28T13:30:41.890

您的问题在 2019 年是错误的[。DXVK](https://github.com/doitsujin/dxvk)是使用 Vulkan 和 Wine 的 Linux 的 D3D11 和 D3D10 实现的实现

mesa 也有原生 Direct3D 9 实现，但据我所知，除了 wine 没有人使用它

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-04-23T17:23:53.750

DirectX 是专为 Microsoft 目标设计的专有产品，因此发生这种情况将是非常不寻常的

我想到了另外两个软件，SDL 和 OpenGL

OpenGL 提供 DirectX 的硬件替代方案，SDL 与 OpenGL 一起提供您期望 DirectX 提供的软件支持

# sql - SQL Server 获取两个表的外键

> ID：11121264
> 
> 赞同：1
> 
> 时间：2012-06-20T13:58:07.520
> 
> 标签：sql, sql-server

在 SQL Server 中，我们是否有 build-it 函数来获取两个表之间的外键？

例如`Table_A, Table_B`，

```
select myfunction ('Table_A', 'Table_B')
-- it should give the column name of its foreign keys, if no any relationship, it return null. 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T14:23:30.660

你可以使用这样的东西：

```
SELECT 
    FKName = fk.name,
    ParentTable = tpar.name,
    ParentColumn = colpar.name,
    ReferencedTable = tref.name,
    ReferencedColumn = colref.name
FROM
    sys.foreign_keys fk
INNER JOIN 
    sys.foreign_key_columns fkc ON fkc.constraint_object_id = fk.object_id
INNER JOIN 
    sys.tables tpar ON fk.parent_object_id = tpar.object_id
INNER JOIN 
    sys.columns colpar ON fkc.parent_object_id = colpar.object_id AND fkc.parent_column_id = colpar.column_id
INNER JOIN 
    sys.tables tref ON fk.referenced_object_id = tref.object_id
INNER JOIN 
    sys.columns colref ON fkc.referenced_object_id = colref.object_id AND fkc.referenced_column_id = colref.column_id 
```

但是当然，你可以在and之间有**多个**外键，它们可以“双向”——你可以在 FK 上从to和另一个从to 。`TableA``TableB``ParentTable = TableA``ReferencedTable = TableB``ParentTable = TableB``ReferencedTable = TableA`

因此，要查找两个表之间的**所有**外键，请使用以下内容：

```
WHERE
    (ParentTable = 'TableA' AND ReferencedTable = 'TableB') OR
    (ParentTable = 'TableB' AND ReferencedTable = 'TableA') 
```

是的，如果你愿意——你可以把它包装在一个函数中，如果你愿意的话——但是我不建议这样做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-20T14:07:13.747

```
SELECT TABLE_NAME
   , CONSTRAINT_NAME
   , COLUMN_NAME
   , ORDINAL_POSITION
FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE 
WHERE CONSTRAINT_NAME IN (
   SELECT CONSTRAINT_NAME
   FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS)
ORDER BY TABLE_NAME, ORDINAL_POSITION; 
```

看看[这里](http://msdn.microsoft.com/en-us/library/aa175805%28SQL.80%29.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T14:10:41.863

有几种方法可以做到这一点。您可以使用以下内容：

1.  在 SQL Server Management Studio 中创建图表以查看连接/外键（但不是函数）

2.  您可以使用`INFORMATION_SCHEMA`. 这允许您查看从系统数据库中提取的所有元数据。这是一个有用教程的链接：[INFORMATION_SCHEMA 教程](http://www.mssqltips.com/sqlservertutorial/179/sql-server-informationschema-views/)

此外，下面的 StackExchange 文章也解决了类似的问题。这是一个链接： [链接到类似的 StackOverflow 帖子](https://stackoverflow.com/questions/925738/how-to-find-foreign-key-dependencies-in-sql-server)

# ruby - 从数组构建一种哈希树

> ID：11121271
> 
> 赞同：1
> 
> 时间：2012-06-20T13:58:38.897
> 
> 标签：ruby

假设我们有数组数组：

```
tree_limbs = Array.new
tree_limbs << %w(1 2 3 4 5 7)
tree_limbs << %w(1 2 3 4 6)
tree_limbs << %w(1 2 3 8 9 10 11) 
tree_limbs << %w(1 2 3 8 9 10 12) 
```

在 ruby​​ 中构建这样一个哈希树的有效方法是什么：

```
tree_hash = {1 => 
              {2 => 
                {3 => 
                  {4 => 
                    {5 => 
                      {7 => nil}
                    },
                    {6 => nil}
                  },
                  {8 => 
                    {9 => 
                      {10 => 
                        {11 => nil},
                        {12 => nil}
                      }
                    }
                  }
                }
              }
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:13:45.157

如果您绝对希望`nil`在最后一级明确地使用 's，那么您可以执行以下操作：

```
tree_limbs = Array.new
tree_limbs << %w(1 2 3 4 5 7)
tree_limbs << %w(1 2 3 4 6)
tree_limbs << %w(1 2 3 8 9 10 11)
tree_limbs << %w(1 2 3 8 9 10 12)

tree_hash = {}

tree_limbs.each do |path|
  path.each_with_index.inject(tree_hash) do |node, (step, index)|
    if index < path.size - 1
      node[step] ||= {}
    else
      node[step] = nil
    end
  end
end

p tree_hash
#=> {"1"=>{"2"=>{"3"=>{"4"=>{"5"=>{"7"=>nil}, "6"=>nil}, "8"=>{"9"=>{"10"=>{"11"=>nil, "12"=>nil}}}}}}} 
```

# ruby-on-rails-3 - 回形针在使用 S3 时在本地查找文件以进行重新处理

> ID：11121278
> 
> 赞同：3
> 
> 时间：2012-06-20T13:58:52.013
> 
> 标签：ruby-on-rails-3, amazon-s3, paperclip, jcrop

我正在使用回形针将文件上传到 s3 存储。上传文件后，我将尝试使用 Jcrop 对其进行裁剪。当`logo.reprocess!`运行它尝试在本地而不是在 s3 上查找文件并给我一个`No such file or directory`错误。这是相关代码

```
 has_attached_file :logo,
    styles: { thumb: "145x75#", large: "500x500" },
    :storage => :s3,
    :s3_credentials => "#{Rails.root}/config/s3.yml",
    :processors => [:cropper]

  def cropping_logo?
    !logo_crop_x.blank? && !logo_crop_y.blank? && !logo_crop_w.blank? && !logo_crop_h.blank?
  end

  def logo_geometry(style = :original)
    @geometry ||= {}
    path = (logo.options[:storage]==:s3) ? logo.url(style) : logo.path(style)
    @geometry[style] ||= Paperclip::Geometry.from_file(path)
  end

  def reprocess_logo
      logo.reprocess!
  end

module Paperclip
  class Cropper < Thumbnail
    def transformation_command
      if crop_command
        crop_command + super.sub(/ -crop \S+/, '')
      else
        super
      end
    end

    def crop_command
      target = @attachment.instance
      if target.cropping_logo?
      " -crop '#{target.logo_crop_w.to_i}x#{target.logo_crop_h.to_i}+#{target.logo_crop_x.to_i}+#{target.logo_crop_y.to_i}'"
      end
    end
  end
end 
```

这是一些帮助的堆栈跟踪

```
/usr/local/ruby/lib/ruby/1.9.1/fileutils.rb:1423:in `stat'
/usr/local/ruby/lib/ruby/1.9.1/fileutils.rb:1423:in `block in fu_each_src_dest'
/usr/local/ruby/lib/ruby/1.9.1/fileutils.rb:1439:in `fu_each_src_dest0'
/usr/local/ruby/lib/ruby/1.9.1/fileutils.rb:1421:in `fu_each_src_dest'
/usr/local/ruby/lib/ruby/1.9.1/fileutils.rb:391:in `cp'
paperclip (3.0.2) lib/paperclip/io_adapters/attachment_adapter.rb:53:in `copy_to_tempfile'
paperclip (3.0.2) lib/paperclip/io_adapters/attachment_adapter.rb:44:in `cache_current_values'
paperclip (3.0.2) lib/paperclip/io_adapters/attachment_adapter.rb:6:in `initialize'
paperclip (3.0.2) lib/paperclip/io_adapters/registry.rb:29:in `new'
paperclip (3.0.2) lib/paperclip/io_adapters/registry.rb:29:in `for'
paperclip (3.0.2) lib/paperclip/attachment.rb:91:in `assign'
paperclip (3.0.2) lib/paperclip/attachment.rb:279:in `reprocess!' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T16:04:20.273

我有同样的问题。我认为这与 Paperclip v3 代码有关。

我在我的 Gemfile 中指定使用旧版本。

```
# Gemfile
gem "paperclip", "~> 2.7.0" 
```

和种植工程。我不确定这对你来说是否是一个好的解决方案，但它暂时对我有用。

# python - 如何将列表作为参数函数传递给 Python 3.2.3 中的 timeit 调用？

> ID：11121282
> 
> 赞同：1
> 
> 时间：2012-06-20T13:58:58.163
> 
> 标签：python, performance, python-3.x

```
function_to_test(test, mylist): #test as an int, mylist as a list of int
     do_something    
     return something

function_generates_a_list(min, max): #min, max are int
     do_something
     return a_List 
```

我需要对 function_to_test 进行计时，并且只有这个。目的是测试代码以确定哪一个最适合测试 int 是否在 int 列表中。（`test`是一个 googolplex，`mylist`是一个从 min 到 max 的巨大列表）。是的，我已经知道函数的结果，我需要知道它会花费多少次。

我的问题是：如果我想将全局列表作为我测试的函数的本地参数传递，我应该使用哪种语法与 timeit 一起使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:14:22.863

最简单的方法是创建一个不带参数的函数，并使用它需要的任何参数调用您的函数：

```
mylist = function_generates_a_list()
def newfunc():
   function_to_test(mylist) 
```

然后您可以调用`timeit(newfunc)`. 您也可以使用 lambda 表达式来执行此操作 -`timeit(lambda: function_to_test(mylist))`与上述完全等价。如果您正在使用`timeit`模块方式（即做`python -m timeit ...`），您也可以这样做：

```
python -m timeit --setup='import mymodule' 'mymodule.newfunc()' 
```

`newfunc`您可以通过使用足够复杂的字符串来完全避免使用`setup`（调用`function_generates_a_list`必须在设置中，可能（如这里）但不一定通过在导入模块时发生，如果您不希望它成为您的时间的一部分)，但是拥有该功能会使事情变得更加灵活且不那么烦人。

# c# - 如何创建动态构建的上下文菜单 clickEvent

> ID：11121284
> 
> 赞同：2
> 
> 时间：2012-06-20T13:59:04.073
> 
> 标签：c#, winforms

`DataGridView`当您右键单击特定列时，我有一个上下文菜单会打开。上下文菜单中显示的内容取决于单击的字段中的内容 - 多个文件的路径（对路径进行操作以创建正确文件的完整 UNC 路径）。

唯一的问题是我无法让点击工作。我没有从工具栏中拖放上下文菜单，而是以编程方式创建的。

我想如果我可以让路径（让我们称之为`ContextMenuChosen`）出现，`MessageBox.Show(ContextMenuChosen);`我可以将其设置为`System.Diagnostics.Process.Start(ContextMenuChosen);`

下面的 Mydgv_MouseUp 事件实际上可以`MessageBox.Show("foo!");`在选择上下文菜单中的某些内容时触发它，但这就是它结束的地方。我在下面留下了一堆评论，显示了单击其中一个路径时我尝试过的内容。有些会导致空字符串，有些会导致错误（对象未设置为实例......）。

我昨天一整天都在搜索代码，但找不到另一种方法来连接动态构建的上下文菜单 clickEvent。

代码和注释：

```
 ContextMenu m = new ContextMenu();

    // SHOW THE RIGHT CLICK MENU
    private void Mydgv_MouseClick(object sender, MouseEventArgs e)
    {
        if (e.Button == MouseButtons.Right)
        {
            int currentMouseOverCol = Mydgv.HitTest(e.X, e.Y).ColumnIndex;
            int currentMouseOverRow = Mydgv.HitTest(e.X, e.Y).RowIndex;

            if (currentMouseOverRow >= 0 && currentMouseOverCol == 6)
            {
                string[] paths = myPaths.Split(';');
                foreach (string path in paths)
                {
                    string UNCPath = "\\\\1.1.1.1\\c$\\MyPath\\";
                    string FilePath = path.Replace("c:\\MyPath\\", @"");
                    m.MenuItems.Add(new MenuItem(UNCPath + FilePath));
                }
            }
            m.Show(Mydgv, new Point(e.X, e.Y));
        }
    }

    // SELECTING SOMETHING IN THE RIGHT CLICK MENU
    private void Mydgv_MouseUp(object sender, MouseEventArgs e)
    {
        DataGridView.HitTestInfo hitTestInfo;
        if (e.Button == MouseButtons.Right)
        {
            hitTestInfo = Mydgv.HitTest(e.X, e.Y);
            // If column is first column
            if (hitTestInfo.Type == DataGridViewHitTestType.Cell && hitTestInfo.ColumnIndex == 6)
            {
                //MessageBox.Show(m.ToString());
                ////MessageBox.Show(m.Tag.ToString());
                //MessageBox.Show(m.Name.ToString());
                //MessageBox.Show(m.MenuItems.ToString());
                ////MessageBox.Show(m.MdiListItem.ToString());
                // MessageBox.Show(m.Name);
                //if (m.MenuItems.Count > 0)
                //MessageBox.Show(m.MdiListItem.Text);
                //MessageBox.Show(m.ToString());
                //MessageBox.Show(m.MenuItems.ToString());
                //Mydgv.ContextMenu.Show(m.Name.ToString());
                //MessageBox.Show(ContextMenu.ToString());
                //MessageBox.Show(ContextMenu.MenuItems.ToString());
                //MenuItem.text
                //MessageBox.Show(this.ContextMenu.MenuItems.ToString());

            }

            m.MenuItems.Clear();
        }

    } 
```

我非常接近完成这项工作，因此非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:09:44.817

我没有看到连接到您的菜单项的事件处理程序，因此当您单击它时会发生一些事情：

```
void menu_Click(object sender, EventArgs e) {
  MessageBox.Show(((MenuItem)sender).Text);
} 
```

然后在将菜单项添加到上下文菜单时附加它：

```
 MenuItem mi = new MenuItem(UNCPath + FilePath);
  mi.Click += menu_Click;
  m.MenuItems.Add(mi); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T14:58:14.927

`CellMouseDown`当你当你时，你可能会这样处理`right click a cell of a specific column`。具体列是通过`e.ColumnIndex check`

此外，您可以使用`GetCellDisplayRectangle`而不是 hittest

```
ContextMenu cm = new ContextMenu();

void dataGridView1_CellMouseDown(object sender, DataGridViewCellMouseEventArgs e)
{
    if (e.Button == MouseButtons.Right)
    {

        if (e.ColumnIndex == 0)
        {
            cm.MenuItems.Clear();
            var mi = new MenuItem("C:\temp");
            mi.MenuItems.Add(mi);
            // handle menu item click event here [as required]
            mi.Click += OnMenuItemClick;
            cm.MenuItems.Add(0, mi);
            var bounds = dataGridView1.GetCellDisplayRectangle(e.ColumnIndex, e.RowIndex, false);
            if (sender != null)
            {
                cm.Show(sender as DataGridView, new Point(bounds.X, bounds.Y));
            }
        }
    }
}

 void OnMenuItemClick(object sender, EventArgs e)
 {
      MessageBox.Show(((MenuItem)sender).Text);
 } 
```

# sql - SQL：在站点列表的所有条目中选择一个用户

> ID：11121285
> 
> 赞同：1
> 
> 时间：2012-06-20T13:59:08.393
> 
> 标签：sql, distinct

如果我有一个包含 table1.user 和 table1.site 列的 table1，我如何返回有权访问所有站点列表的不同用户的列表？

让我澄清一下。我可以从以下代码开始：

```
 SELECT  DISTINCT user
    FROM    table1
    WHERE   (site IN ('site1','site2','site3')) 
```

当然，这将显示所有具有三个所列站点中的任何一个的条目的不同用户。我只想要对所有三个列出的站点都有条目的用户。

我觉得可能有一种明显的方法可以做到这一点，一旦有人指出，我可能会觉得很愚蠢。尽管如此，我还是在画一个空白。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:00:38.693

```
SELECT  user
FROM    table1
WHERE   site IN ('site1','site2','site3')
GROUP BY user
HAVING count(*) = 3 
```

这假定用户不能多次分配到同一个站点。如果不是这种情况，那么 Gordon 的评论成立，并且有表达式必须替换为`HAVING count(distinct site) = 3`

一种更加动态的方法，其中站点只指定一次并且 c​​ount() 自动调整可能是这样的：

```
WITH sites (site_name) AS (
   VALUES ('site1'), 
          ('site2'),
          ('site3')
)
SELECT  user
FROM    table1
WHERE   site IN (SELECT site_name FROM sites) 
GROUP BY user
HAVING count(*) = (select count(*) from sites); 
```

（这是 ANSI SQL，因为没有指定 DBMS）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T14:09:16.970

这应该适用于大多数 DBMS：

```
select user from table1
where site in ('site1', 'site2', 'site3')
group by user
having count(distinct site) = 3 
```

请注意，您必须将站点数量（在本例中）与子句`3`中列出的站点数量相匹配。`in`

# internet-explorer - 404页面没有出现在IE9中

> ID：11121286
> 
> 赞同：4
> 
> 时间：2012-06-20T13:59:13.213
> 
> 标签：internet-explorer, http-status-code-404, playframework-2.0

> **可能重复：**
> [在 PHP 404 标头返回“糟糕！这个链接似乎被破坏了。”](https://stackoverflow.com/questions/3970093/include-after-php-404-header-returning-oops-this-link-appears-to-be-broken)

我在 Play 中有一个自定义的 404 页面！项目。出于某种原因，我注意到 404 页面出现在除 IE9 之外的所有浏览器上——它只显示了一个未找到浏览器的默认页面。这有什么原因吗？现在我已经在默认类路径的 Global 类中实现了它。所以当资源没有找到时，它会在到达 handler not found 函数后转发到错误页面。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-21T07:57:54.813

您的 404 页面需要超过一定的大小（对于 IE，IIRC，它是 512 字节）才能显示，而不是默认的“找不到页面”。看到[这个问题。](https://stackoverflow.com/questions/3970093/include-after-php-404-header-returning-oops-this-link-appears-to-be-broken)

# dependencies - YUM/RPM - 如何指定未随 RPM 安装的要求

> ID：11121293
> 
> 赞同：0
> 
> 时间：2012-06-20T13:59:40.670
> 
> 标签：dependencies, rpm, yum

我有一个依赖于软件 Y 的包 X。Y 通常由用户手动编译和安装，但并非总是如此。

如果我在我的规范文件中提出要求，例如“requires: Y”，YUM 将下载并安装包 Y。如果 Y 是由用户安装的，它会被简单地覆盖，这是不行的。

如果我不提出要求，那些没有 Y 的人最终会错过运行 X 的必要软件。

有一种方法可以通过检查某个位置是否存在二进制文件或检查环境变量来了解是否安装了 Y。

如何处理这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T23:14:50.057

可以设置`%pre`RPM文件的部分以检查二进制文件是否存在。`.spec`

```
 %pre
    # Check if binary file exists . If not, exit with an error. 
    if [ -f /path/to/binary/file ]; then
        echo "Info: Pre-requisite exists: /path/to/binary/file"
    else
        echo "Error: Pre-requisite <name> not installed. Exiting..."
        exit 1
    fi 
```

# mysql - 添加/更改主索引的 InnoDB 性能

> ID：11121294
> 
> 赞同：0
> 
> 时间：2012-06-20T13:59:41.247
> 
> 标签：mysql, performance, innodb

所以我有一个巨大的更新，我必须将大约 40gb 的数据插入到一个 innodb 表中。它需要很长时间，所以我想知道哪种方法最快（更重要的是为什么，因为我可以做一个拆分测试）。

方法1)

a) 插入所有行 b) 创建 ALTER TABLE su_tmp_matches ADD PRIMARY KEY ( id )

方法2)

a) ALTER TABLE su_tmp_matches ADD PRIMARY KEY (id) b) 插入所有行

目前我们正在使用方法 1，但步骤 b) 似乎需要大量时间。所以我想知道这里的大小是否有任何含义（40gb - 500 万行）。

---- 所以我决定也对此进行测试 --- 非常快的全新 mysql 服务器 - 加载和加载 ram，以及快速 ram，快速磁盘，并且非常调整（我们每秒有超过 5000 个请求一件）：

1,6 mio 行/6gb 数据：

81 秒“删除”主索引

“添加”主索引需要 550 秒（添加数据后）

120秒用主索引创建表的副本 create BEFORE data insert

创建没有主索引的表副本需要 80 秒（之后创建需要 550 秒）

似乎很荒谬 - 问题是，如果索引是同一件事。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T14:05:28.863

从[文档中](http://dev.mysql.com/doc/refman/5.0/en/converting-tables-to-innodb.html)：

> InnoDB 没有像 MyISAM 存储引擎那样对单独的索引创建进行特殊优化。因此，导出和导入表并随后创建索引是不值得的。将表更改为 InnoDB 的最快方法是直接对 InnoDB 表进行插入。

在我看来，如果您的列具有主键是一个自动递增的整数，那么在插入之前添加唯一性约束只能帮助引擎。但我真的怀疑会有显着差异。

一个有用的建议：

> 在大表转换过程中，增加 InnoDB 缓冲池的大小以减少磁盘 I/O，最大为物理内存的 80%。您还可以增加 InnoDB 日志文件的大小。

*编辑：根据经验，MySQL 并不总是按照文档性能方面的预期执行，我认为你在这方面所做的任何基准测试都会很有趣，即使本身不是一个明确的答案。*

# jquery - 如何在jquery插件中为变量属性赋值

> ID：11121296
> 
> 赞同：2
> 
> 时间：2012-06-20T13:59:46.980
> 
> 标签：jquery, jquery-plugins, variable-assignment

如何从插件**外部**为以下插件“defaults”对象的“extraParams”属性赋值？

```
(function ($) {
jQuery.fn.jScroller = function (store, parameters) {
    var defaults = {
        //numberOfRowsToRetrieve: 10,
        onSuccessCallback: function (row, container) { },
        onErrorCallback: function (thrownError) { window.alert('An error occurred while trying to retrive data from store'); },
        onTimeOutCallback: function () { },
        timeOut: 3 * 1000,
        autoIncreaseTimeOut: 1000,
        retryOnTimeOut: false,
        loadingButtonText: 'Loading...',
        loadMoreButtonText: 'Load more',
        fullListText: 'There is no more items to show',
        routValues: null 
```

我试过这个，但导致错误：

```
$.jScroller.defaults.extraParams = val; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:29:27.820

这里有 2 个非常简单的插件。两者都没有设置任何默认值，但都响应传递给它们的选项。一种用于`$.fn.plugin.defaults`设置默认值，另一种使用`var`您已经开始的本地。在某种程度上，设置默认值的方式取决于个人喜好以及插件的复杂性。

请注意，选项是在插件#2 上以两种不同的方式在外部设置的

演示：http: [//jsfiddle.net/fCbm8/1](http://jsfiddle.net/fCbm8/1)

```
(function($) {
    $.fn.plugin_1 = function(options) {
        var defaults = {}; /* merge the options into defaults*/
        var opts = $.extend({}, defaults, options);

        return this.each(function() {
            if (opts.green) {
                $(this).css('background', 'green')
            }
        });
    }
})(jQuery);
(function($) {
    $.fn.plugin_2 = function(options) { /* merge the options into defaults*/
        var opts = $.extend({}, $.fn.plugin_2.defaults, options);

        return this.each(function() {
            if (opts.big) {
                $(this).css('font-size', '30px')
            }
            if (opts.color) {
                $(this).css('color', 'white')
            }
        });
    }

    $.fn.plugin_2.defaults = {};

})(jQuery)

$(function() {
    $.fn.plugin_2.defaults.big = true;
    $('div').plugin_2({color:true}).plugin_1({green: true  })

}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T14:10:17.103

从手册：

> 对于提供许多选项的更复杂和可定制的插件，最佳实践`$.extend`是在调用插件时具有可以扩展（使用）的默认设置。因此，您可以使用一个参数来调用它，而不是使用大量参数调用插件，该参数是您想要覆盖的设置的对象文字。

```
 $.fn.tooltip = function( options ) {  

    // Create some defaults, extending them with any options that were provided
    var settings = $.extend( {
      'location'         : 'top',
      'background-color' : 'blue'
    }, options);

    return this.each(function() {        

      // Tooltip plugin code here

    });

  };
})( jQuery ); 
```

在示例中，手册显示了如何通过传递额外参数来调用插件，如果您愿意（如`{location: left}`）覆盖默认参数。

# mongodb - MapReduce 与 MongoDB - 减少运行多少次？

> ID：11121299
> 
> 赞同：2
> 
> 时间：2012-06-20T13:59:50.300
> 
> 标签：mongodb, mapreduce

我在 MongoDB 中使用 MapReduce，我想我已经完全理解了所有这些，除了一个我仍然不明白的部分：`reduce`运行了多少次？

例如，我有一个“项目”集合，每个项目都有一个“类别”。这是测试数据（用 javascript 编写，用于 node.js 单元测试）：

```
var i = 0;
var dummyCategories = [
  { categoryId:(++i), categoryName:'Category '+i },   // [0] 1
  { categoryId:(++i), categoryName:'Category '+i },   // [1] 2
  { categoryId:(++i), categoryName:'Category '+i },   // [2] 3
  { categoryId:(++i), categoryName:'Category '+i },   // [3] 4
  { categoryId:(++i), categoryName:'Category '+i }    // [4] 5
];

i=0;
var dummyItems = [
  { itemId: 'TestItem' + (++i), title: 'Test Item ' + i,      // [0] 1
    category: dummyCategories[0]
  },
  { itemId: 'TestItem' + (++i), title: 'Test Item ' + i,      // [1] 2
    category: dummyCategories[1]
  },
  { itemId: 'TestItem' + (++i), title: 'Test Item ' + i,      // [2] 3
    category: dummyCategories[2] 
  },
  { itemId: 'TestItem' + (++i), title: 'Test Item ' + i,      // [3] 4
    category: dummyCategories[3]
  },
  { itemId: 'TestItem' + (++i), title: 'Test Item ' + i,      // [4] 5
    category: dummyCategories[4]
  },
  { itemId: 'TestItem' + (++i), title: 'Test Item ' + i,      // [5] 6
    category: dummyCategories[0]
  }
]; 
```

有 6 个项目，5 个类别，其中一个类别出现两次，其余类别出现一次。

在我的`map`功能中，我正在发射`(this.category.categoryId, { items: 1 });`. （完整版除了 # of items 之外，还包括 value 对象中的其他指标，但无论哪种方式，这种行为都是相同的。）

我的`reduce`功能如下所示：

```
function reduce(key, values) {
  var totals = {
    items: 0
  };

  for (var i = 0; i < values.length; i++) {
    totals.items += values[i].items;
  }

  return totals;
}; 
```

（map 中的输出结构与 reduce 中的输出结构相同，因为它需要如此。）

所以我通过 mapReduce 运行`verbose=true`它，它显示了这些统计信息：

计数：{输出：5，发射：6，减少：1，输入：6}

input:6 有意义，有 6 个文档。emit:6 是有道理的，它为每个文档发出 1 个类别。output:5 有意义，有 5 个类别。但是为什么 reduce 只运行一次呢？

现在写出来，它似乎为每个出现多次的发出键运行reduce。因此，当一个键只发出一次时，它不会减少它。那是对的吗？确定减少运行次数的数学公式是什么？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T17:25:37.430

是的，你是正确的，如果密钥只发出一次，reduce 就不会运行。我认为不存在一个数学公式可以告诉您 reduce 将运行多少次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T17:42:21.943

As long as it is necessary. For big data set individual reduce invocations will be split between nodes and run at the same time. Size of individual reduce job chunks will vary depending on configuration - documentation says that individual emits can not be more than half of maximal document size so I think it implies that maximal reduce batch will be of maximal document size.

# excel - Openpyxl，如何在使用 openpyxl .save() 函数保存之前的 .xlsx 文件样式？

> ID：11121300
> 
> 赞同：2
> 
> 时间：2012-06-20T13:59:52.510
> 
> 标签：excel, openpyxl

*我对 openpyxl 库有疑问。*

**问题：**

当我使用 xlwt，打开一个 .xls 文件并在其中写入一些单元格时，我没有触摸的单元格样式保持不变。但是现在我必须使用 xlsx 文档，所以我为此选择了 openpyxl。但是在使用 .save 函数保存后，它完全剥离了文档的样式，甚至是我根本没有触及的单元格。

**关于如何保持风格的任何建议？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T18:45:50.207

我遇到了这个确切的问题，显然没有很好的方法来保留 openpyxl 中的样式，请参阅 [Use openpyxl to edit a Excel2007 file (.xlsx) without changed its own styles？](https://stackoverflow.com/questions/6772438/use-openpyxl-to-edit-a-excel2007-file-xlsx-without-changing-its-own-styles)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-02-25T01:59:57.500

I don't think openpyxl solved this issue yet. You can try pywin32 to directly interact with windows API with Excel, you can do everything there you want.

# .net - 如何使用 GroupBy() 通过 VB.NET 对多个列进行分组？

> ID：11121303
> 
> 赞同：7
> 
> 时间：2012-06-20T14:00:05.477
> 
> 标签：.net, vb.net, linq, group-by

我尝试像在 C# 中那样使用匿名类型执行此操作，但结果不正确。

VB.NET 示例（错误输出）：

```
Module Module1

Sub Main()
    Dim ls As List(Of Employee) = New List(Of Employee)
    ls.Add(New Employee With {.Age = 20, .Sex = "M"})
    ls.Add(New Employee With {.Age = 20, .Sex = "M"})
    ls.Add(New Employee With {.Age = 20, .Sex = "M"})
    ls.Add(New Employee With {.Age = 30, .Sex = "F"})
    ls.Add(New Employee With {.Age = 30, .Sex = "F"})

    For Each item In ls.GroupBy(Function(k) New With {.Age = k.Age, .Sex = k.Sex})
        Console.WriteLine(String.Format("Group [Age: {0}, Sex: {1}] : {2} Item(s)", item.Key.Age, item.Key.Sex, item.Count()))
    Next

    Console.ReadLine()
End Sub

Class Employee
    Private _Age As Integer
    Public Property Age() As Integer
        Get
            Return _Age
        End Get
        Set(ByVal value As Integer)
            _Age = value
        End Set
    End Property

    Private _Sex As String
    Public Property Sex() As String
        Get
            Return _Sex
        End Get
        Set(ByVal value As String)
            _Sex = value
        End Set
    End Property
End Class
End Module 
```

输出：

```
Group [Age: 20, Sex: M] : 1 Item(s)
Group [Age: 20, Sex: M] : 1 Item(s)
Group [Age: 20, Sex: M] : 1 Item(s)
Group [Age: 30, Sex: F] : 1 Item(s)
Group [Age: 30, Sex: F] : 1 Item(s) 
```

期望的输出：

```
Group [Age: 20, Sex: M] : 3 Item(s)
Group [Age: 30, Sex: F] : 2 Item(s) 
```

C# 示例（正确输出）：

```
class Program
{
    static void Main(string[] args)
    {
        List<Employee> ls = new List<Employee>();
        ls.Add(new Employee { Age = 20, Sex = "M" });
        ls.Add(new Employee { Age = 20, Sex = "M" });
        ls.Add(new Employee { Age = 20, Sex = "M" });
        ls.Add(new Employee { Age = 30, Sex = "F" });
        ls.Add(new Employee { Age = 30, Sex = "F" });

        foreach (var item in ls.GroupBy(k => new { Age = k.Age, Sex = k.Sex }))
        {
            Console.WriteLine(String.Format("Group [Age: {0}, Sex: {1}] : {2} Item(s)", item.Key.Age, item.Key.Sex, item.Count()));
        }
        Console.ReadLine();
    }

    class Employee
    {
        public int Age { get; set; }
        public string Sex { get; set; }
    }
} 
```

有人看到我的错误在哪里吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-20T14:04:12.030

在 VB 代码中创建匿名类型时需要使用`Key`修饰符。默认情况下，它创建读/写属性，而 C# 匿名类型*始终*是只读的。`Equals`/中仅使用只读属性`GetHashCode`。

```
For Each item In ls.GroupBy(Function(k) New With { Key .Age = k.Age, _
                                                   Key .Sex = k.Sex}) 
```

有关详细信息，请参阅[VB 中匿名类型](http://msdn.microsoft.com/en-us/library/bb384767.aspx)的文档。

# regex - 正则表达式用英语解释

> ID：11121310
> 
> 赞同：1
> 
> 时间：2012-06-20T14:00:34.017
> 
> 标签：regex, pcre

我看过[这里](http://www.pcre.org/pcre.txt)，据我了解，以下正则表达式仅表示“任何 unicode 字符序列”。有人可以确认一下吗？

当前正则表达式：/^(?>\P{M}\p{M}*)+$/u

另外，如果我阅读手册，它会说

a) \P{M} = \PM

b) (?>\PM\pM*) = \X

因此，有了这两件事，我不能将正则表达式简化为吗？：

建议的正则表达式：/^\X+$/u

到现在我还是不太明白...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:17:09.230

```
^            # start of string followed by 
(?>          # an independent (non-backtracking) capturing group containing 
    \P{M}    # a single unicode character which is not in the `Mark` category
    \p{M}*   # 0 or more characters in the `Mark` category
)+           # with this capturing group repeated 1 or more times
$            # the end-of-line 
```

鉴于`^\X+$`不包含捕获组；在`\P{M}\p{M}*`其他方面是等价的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T14:18:35.703

是的，`\P{M}\p{M}*`可以简化为`\X`，但并非所有语言都支持`\X`（根据我的经验）`\P{M}`并且`\p{M}`更频繁地支持。

例如，Java 和 .NET 的正则表达式引擎不支持`\X`（Perl 支持，当然……）。

更多信息，请参阅：[http ://www.regular-expressions.info/unicode.html](http://www.regular-expressions.info/unicode.html)

# android - 在日历中设置时间 (android)

> ID：11121314
> 
> 赞同：1
> 
> 时间：2012-06-20T14:00:41.610
> 
> 标签：android, timepicker

我想做一个改变我飞行模式的应用程序。我有一个时间选择器和一个日历。现在我想设置从 tp 到 cal 的时间。我做了 2 次吐司来控制两个对象的时间。tp 的吐司显示了正确的时间（fe 13:04），但日历对象在“设置”错误时间（11:12）之后设置了时间，就像*getTimeinMillis()*之类的方法一样被称为所以添加了这个方法，但它仍然无法正常工作。感谢您的回答

```
Button b;
Button b2;
TimePicker tp;
Calendar cal;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    b = (Button)(findViewById(R.id.button1));
    tp = (TimePicker)(findViewById(R.id.timePicker1));
    cal = Calendar.getInstance();
    b2 = (Button)(findViewById(R.id.button2));

    b.setOnClickListener(new OnClickListener()
            {

                @Override
                public void onClick(View arg0) {

                    Toast.makeText(getApplicationContext(),"TimePicker "+ tp.getCurrentHour()+":"+tp.getCurrentMinute(), Toast.LENGTH_LONG).show();
                    cal.set(Calendar.HOUR_OF_DAY,tp.getCurrentHour());
                    cal.set(Calendar.MINUTE,tp.getCurrentMinute());
                    cal.set(Calendar.SECOND,0);
                    cal.getTimeInMillis();
                    Toast.makeText(getApplicationContext(),"Calendar "+ cal.HOUR_OF_DAY+":"+cal.MINUTE, Toast.LENGTH_LONG).show();
                }
            }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T14:21:01.830

Nuno Gonçalves 提供的答案将解决您的问题。但是，当您向用户显示日期/时间时，最好使用[android.text.format.DateFormat](http://developer.android.com/reference/android/text/format/DateFormat.html)提供的日期/时间格式化程序。这样，信息以用户期望的方式显示（例如 12 小时与 24 小时时间等）。

所以，像这样：

```
Toast.makeText(this, "Calendar: "
                         + DateFormat.getTimeFormat(this).format(cal.getTime())); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-20T14:12:24.277

您正在正确设置字段，但您不会像这样查询日历的字段。您在那里所做的是在日历类上打印 HOUR_OF_DAY 字段的 int 值，其值为 11（[请参见此处](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Calendar.html#HOUR_OF_DAY)）。

getTimeinMillis 方法将只返回自 Epoch（1970 年 1 月 1 日 00:00:00 GMT）以来的毫秒数。它没有必要在那里。

利用：

```
Toast.makeText(getApplicationContext(),"Calendar "+ cal.get(Calendar.HOUR_OF_DAY) +":"+cal.get(Calendar.MINUTE), Toast.LENGTH_LONG).show(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T14:14:49.633

您可以尝试以下日历实现：

`Calendar calendar = Calendar.getInstance(Locale.getDefault());`

# powershell - PowerShell foreach 脚本中不存在路径

> ID：11121316
> 
> 赞同：0
> 
> 时间：2012-06-20T14:00:52.760
> 
> 标签：powershell

我遇到了一个奇怪的情况，我无法弄清楚问题所在。我想要获取给定路径的所有子目录的 ACL 和 AccessRules。如果我单独执行它们，我不会收到任何错误

```
gci -recurse | Where-Object { $_.PSIsContainer } | Get-Acl | Format-List | Out-File C:\temp\permission.txt
gci -recurse | Where-Object { $_.PSIsContainer } | Get-Acl | foreach {$_.GetAccessRules($true, $true, [System.Security.Principal.NTAccount])} | Out-File C:\temp\permission1.txt -Append 
```

但是，我想在 foreach 循环中执行此操作，以更好地操作和处理文件的生成方式。这是我在脚本中尝试做的事情：

```
sl c:\test_folder
gci * -Recurse | Export-Csv c:\temp\dir.csv -Force
$pastas = gci -Recurse | where {$_.PsIsContainer}
if (Test-Path C:\temp\permission.txt)
{
  ri c:\temp\permission.txt
}
foreach ($pasta in $pastas)
{
  $pasta
  Test-Path $pasta
  $acl = get-acl $pasta
  $acl | format-list | Out-File -FilePath c:\temp\permission1.txt -Append
  $acl.GetAccessRules($true, $true, [System.Security.Principal.NTAccount]) | Out-File -FilePath c:\temp\permission1.txt -Append
} 
```

当我`foreach`直接在`$pastas`变量的根目录中处理文件夹时，`Test-Path`返回`true`. 然而，在第一个子目录中，`Test-Path`返回`false`，但该文件夹确实存在。在 get-acl 上，我得到 PathNotFound 异常：

```
Get-Acl : Não é possível localizar o caminho 'Exportacao' porque ele não existe.
Em C:\Temp\Script Get Info.ps1:12 caractere:17
+   $acl = get-acl <<<<  $pasta
    + CategoryInfo          : ObjectNotFound: (:) [Get-Acl], ItemNotFoundException
    + FullyQualifiedErrorId : GetAcl_PathNotFound_Exception,Microsoft.PowerShell.Commands.GetAclCommand 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:15:27.107

尝试：

```
Test-Path $pasta.fullname
  $acl = get-acl $pasta.fullname 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T14:15:52.493

```
sl c:\test_folder
gci * -Recurse | Export-Csv c:\temp\dir.csv -Force
$pastas = gci -Recurse | where {$_.PsIsContainer}
if (Test-Path C:\temp\permission.txt)
{
  ri c:\temp\permission.txt
}
foreach ($pasta in $pastas)
{
  $pasta.FullName
  Test-Path $pasta.FullName
  $acl = get-acl $pasta.FullName
  $acl | format-list | Out-File -FilePath c:\temp\permission1.txt -Append
  $acl.GetAccessRules($true, $true, [System.Security.Principal.NTAccount]) | Out-File -      FilePath c:\temp\permission1.txt -Append
} 
```

试试上面的脚本。

您的代码失败的原因是因为 $pasta 是一个 FileInfo 对象，而 Test-Path 需要一个带有完整路径的字符串。

# tsql - 通过传递输入值并取出输出值来执行 T-SQL 过程的命令是什么

> ID：11121318
> 
> 赞同：0
> 
> 时间：2012-06-20T14:00:54.480
> 
> 标签：tsql, sql-server-2005

抱歉问这个简单的问题，我是 T-SQL 新手

通过传递输入值并获取输出值来执行 T-SQL 存储过程的命令是什么？

比如说有 2 个变量，比如`@id`（输入）和`@sal`（输出）

要求是通过id并获得薪水。那么我们需要这样执行吗？

```
EXEC USP_PROC1 89, 0 
```

（*我是否还需要传递输出变量的默认值*）

当我执行它时，为什么我看不到任何答案？我只能看到`Command(s) completed successfully`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:02:59.717

[MSDN 是你的朋友](http://msdn.microsoft.com/en-us/library/ms188332.aspx)。除了基本的语法布局之外，它还为您提供了大量示例。

[这是另一个带有一些示例的站点。](http://sqlserverpedia.com/wiki/Stored_Procedures_-_Output_Parameters_&_Return_Values)

```
EXEC USP_PROC1 89,0, @OutputValue OUTPUT 
```

# c - 如何在 Linux 内核空间中使用 ioctl()？

> ID：11121319
> 
> 赞同：6
> 
> 时间：2012-06-20T06:58:44.017
> 
> 标签：c, linux-kernel

是否可以`ioctl`从 Linux 内核模块调用？谁能提供一个如何使用它的例子？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-21T06:46:43.303

你可以试着打电话`sys_ioctl`。
如果内核是用`CONFIG_COMPAT`.

或者，如果你有设备驱动程序`struct file_operations`，你可以直接调用它的`ioctl`处理程序。

但是，ioctl 句柄期望指针参数位于当前正在运行的进程的地址空间中，而不是内核地址空间中。`copy_from_user`将用于阅读它们。如果给内核地址空间指针，`copy_from_user`就会失败。我不明白你会如何解决这个问题。

**编辑：**

如果您将在下面的代码之间调用 ioctl 处理程序，`copy_from_user`则永远不会失败。

```
 mm_segment_t fs;

  fs = get_fs();     /* save previous value */
  set_fs (get_ds()); /* use kernel limit */

  /* system calls can be invoked */

  set_fs(fs); /* restore before returning to user space */ 
```

# bash - 如何在bash函数中使用正则表达式查找当前目录路径的一部分

> ID：11121320
> 
> 赞同：0
> 
> 时间：2012-06-20T14:01:07.180
> 
> 标签：bash

我只需要在 bash 脚本函数中找到要用作父路径的路径的一部分。

例如

```
cd = /var/www/
pwd = /var/www/alpha/something/somewhere/somewhere
pwd = /var/www/1042/someplace/somehow 
```

现在我需要找到这条路径的第三部分

例如：**迁移**，或**1042**

成为新的根目录，这样我就可以告诉 bash 寻找其他一些子文件夹，无论我目前在哪里和多深。

因此，例如，如果我在 /8 的 alpha/

```
pwd = /var/www/alpha/1/2/3/4/5/6/7/8
                        /a/b/c/d/ 
```

我可以快速向*/d*发出命令

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:07:25.053

快速一行打印目录：

```
pwd | cut -d / -f 4 
```

要从该目录实际运行命令，请使用：

```
(cd `pwd | cut -d / -f 1-4`; your-command-here) 
```

# git - Git站点部署-接收后挂钩中的结帐不起作用

> ID：11121321
> 
> 赞同：0
> 
> 时间：2012-06-20T14:01:07.040
> 
> 标签：git, repository, git-checkout, git-post-receive

我已经按照本教程[“使用 Git 管理网站”](http://toroid.org/ams/git-website-howto)，使用 Tower 提交本地存储库并将其推送到远程服务器。推送成功并显示以下消息：

```
Pushing to ssh://user@mysite.com/~/git/tprevo.git
stdin: is not a tty
Counting objects: 40, done.
Delta compression using up to 2 threads.
Compressing objects: 100% (37/37), done.
Writing objects: 100% (40/40), 171.95 KiB, done.
Total 40 (delta 3), reused 0 (delta 0)
To ssh://user@mysite.com/~/git/tprevo.git
 * [new branch]      master -> production
updating local tracking ref 'refs/remotes/production/production'

Successfully created tracking connection. 
```

我已经验证了我的 post-receive 挂钩正在执行，但是该`checkout`命令没有将推送的代码添加到我认为我已经设置为我的工作目录的目录中。我整天都在想办法解决这个问题。

**收到后：**

```
#!/bin/sh
GIT_WORK_TREE=/home/tprevo/public_html/tprevo git checkout -f 
```

我是 Git 新手，非常渴望学习。调试这个的最佳方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-20T23:36:06.473

好的......我有一个类似的设置......你的文件是可执行的吗？请检查文件属性...

```
ls -la post-receive 
```

如果它不可执行，那么您需要对其进行 chmod ...

```
sudo chmod +x post-receive 
```

更新

注意到您有一个命名分支，您可能希望在 checkout 命令中为您的 post-receive 钩子指定特定的...

```
git checkout -f production 
```

# spring-ws - Spring OXM 3 + JiBXException：没有为类定义编组器

> ID：11121322
> 
> 赞同：1
> 
> 时间：2012-06-20T14:01:10.640
> 
> 标签：spring-ws, spring-3, jibx, spring-oxm

我在我的应用程序中使用了 Spring OXM 和 JiBX。

下面是我的 Spring 配置文件

```
<context:component-scan base-package="com.controller"/>

<bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping"/>
<bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter"/>

<oxm:jibx-marshaller target-class="com.request.RequestClass" id="rqMarshaller"/>
<oxm:jibx-marshaller target-class="com.response.ResponseClass" id="rsMarshaller"/>

<bean id="xmlViewer" class="org.springframework.web.servlet.view.xml.MarshallingView">
    <constructor-arg ref="rsMarshaller" />
</bean>
<bean id="viewResolver" class="org.springframework.web.servlet.view.BeanNameViewResolver"/> 
```

下面是控制器类

```
@Controller
public class MyController {
    @Autowired
    private JibxMarshaller rqMarshaller;

    @RequestMapping(value = "/myrequest", method = RequestMethod.POST)
    public ModelAndView searchFlights(@RequestBody String request) {
        System.out.println("Inside");
        System.out.println("request = "+request);
        Source source = new StreamSource(new StringReader(request));

        RequestClass rq = null;
        try {
            rq = (RequestClass) rqMarshaller.unmarshal(source);
        } catch (XmlMappingException e1) {
            e1.printStackTrace();
        } catch (IOException e1) {
            e1.printStackTrace();
        }

        ResponseClass e = new ResponseClass();
        e.setVersion("2.0");

        Orig ond = new Orig();
        ond.setCode("AIT");

        e.getOrig().add(ond);
        return new ModelAndView("xmlViewer","object",e);
    }
} 
```

当我发送 XML 请求时，它已成功编组，但为了响应，我收到以下错误消息。

```
org.jibx.runtime.JiBXException: No marshaller defined for class com.response.ResponseClass 
```

我已经`ResponseClass`在 spring 配置文件中定义了 marshaller。

请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T11:42:13.967

最后我想出了解决方案！

注册时需要指定`bindingName`属性`JiBxMarshaller`。

```
<oxm:jibx-marshaller target-class="com.request.RequestClass" id="rqMarshaller" bindingName="rqBinding"/>
<oxm:jibx-marshaller target-class="com.response.ResponseClass" id="rsMarshaller" bindingName="rsBinding/> 
```

并在 JiBX 的各个绑定/映射文件中指定相同的名称。

而已 ！

# excel - 如何将excel中的一列用作另一列中的搜索参数以仅输出某些字符串

> ID：11121326
> 
> 赞同：2
> 
> 时间：2012-06-20T14:01:25.680
> 
> 标签：excel, vba

这个问题源于我的另一个帖子。（请参阅[在 excel 中的列中搜索特定字符串，其中字符串在每个单元格中是随机的](https://stackoverflow.com/questions/11108719/search-through-column-in-excel-for-specific-strings-where-the-string-is-random-i)）

![工作簿示例](../Images/973343f218671f30153ebf5945d31e76.png)

使用上面的图像作为参考，我试图使用列 E 作为“查找值”来搜索列 B（实际上超过 1000 行）。最终目标是“仅”显示在 C 列中的名称。诀窍是包含名称的所有随机生成的字符。下面是我希望数据表的样子。公式或模块应该可以工作，但我无法使用 vlookup 和其他查找功能。

![在此处输入图像描述](../Images/74db4901b21f16b153c59a47e3bcda9f.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-20T15:14:19.980

对于工作表函数方法，您可以输入 C3 并填写以下公式：

```
=LOOKUP(8^5,SEARCH(E$3:E$7,B3),E$3:E$7) 
```

常数 8^5=32768 被选择为大于最大可能的字符串长度，以便 LOOKUP 返回最后一个匹配值。如果没有找到字符串，该公式将返回 #N/A。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-20T14:35:50.533

另一种可能性，这可能比 assylias 最初发布的更容易理解，但也可能会花费更多时间（尽管有 1,000 行，但我认为这并不重要）如下。

这要求您将 E 列中的范围命名为 myNames（或任何您希望的名称，只需更新代码 - 或者，您可以只写 Range("E1:E6")）。此外，如果您从 B 列中移动随机值，也请在代码中进行更新。

```
Sub findString()

Dim celString As Range, rngString As Range, celSearch As Range, rngSearch As Range
Dim wks As Worksheet

Set wks = Sheets("Sheet1") 'change sheet reference to whatever your sheet name is

Set rngString = wks.Range("myNames")
Set rngSearch = Intersect(wks.UsedRange, wks.Range("B1").EntireColumn)

For Each celString In rngString
    For Each celSearch In rngSearch
        If InStr(1, celSearch.Text, celString.Value) > 0 Then
            celSearch.Offset(, 1) = celString.Value
        End If
    Next
Next

End Sub 
```

因为，我也处理了你原来的问题，所以我建议通过 Siddharth 的回答来获得计数，然后运行这个，或者上面的 assylias 的代码来获取列旁边的名称。您可以在工作表上放置一个按钮，或者只使用“宏”对话框来运行宏。

# google-visualization - 在基本的 Google 条形图中添加 API 代码

> ID：11121330
> 
> 赞同：0
> 
> 时间：2012-06-20T14:01:36.837
> 
> 标签：google-visualization

我有一个基本的谷歌图表：-

```
function drawVisualization() {
  // Create and populate the data table.
  var data = google.visualization.arrayToDataTable([
    ['Year', 'Austria', 'Belgium', 'Czech Republic'],
    ['2006',  1600652,   4604684,       940478],
    ['2007',  1968113,   4013653,       1037079],
    ['2008',  1901067,   6792087,       1037327]
  ]);

// Create and draw the visualization.
      new google.visualization.ColumnChart(document.getElementById('visualization')).
          draw(data,
           {title:"Yearly Coffee Consumption by Country",
            width:600, height:400,
            hAxis: {title: "Year"}}
      );
} 
```

​ 我希望能够指定边框颜色和宽度等。你能告诉我如何使用API​​命令：-backgroundColor.stroke，backgroundColor.strokeWidth，

即如何添加这些 API 调用。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T15:30:20.007

您可以发送`stroke`颜色和`strokeWidth`其他选项的设置，类似于您为 指定标题的方式`hAxis`：

```
backgroundColor: {
    stroke: '#000',
    strokeWidth: '2'
} 
```

这会给图表一个黑色的 2 像素边框，在[jsfiddle](http://jsfiddle.net/cchana/enDGt/1/)上演示。

# objective-c - 检查子字符串是否在数组中并将其吐出

> ID：11121334
> 
> 赞同：0
> 
> 时间：2012-06-20T14:01:44.287
> 
> 标签：objective-c

我是一名 Objective-C 初学者，现在我想循环遍历一个数组并检查子字符串是否在其中。如果为真，则应将数组的对象放入另一个数组中，该数组将显示在屏幕上。这是我的代码：

```
NSArray *origarray = [NSArray arrayWithObjects:
                 @"One",
                 @"Two",
                 @"Three",
                 @"Four",
                 @"Five",nil];
for(NSString *words in origarray){
    NSMutableArray *newarray = [[NSMutableArray alloc] init];
    NSRange range = [words rangeOfString:@"o"];
    if(range.location != NSNotFound){
        [newarray addObject:words];
    }
    textview.text = [newarray description];
} 
```

在这种情况下，我们应该得到一个由“一”、“二”和“四”组成的数组，因为它们都包含一个“o”。不幸的是，我的文本视图中有一个空数组。（我知道“描述”仅用于调试目的）。有人可以告诉我如何正确执行此操作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T14:12:29.190

例如，您可以使用它`NSPredicate`来执行此操作

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"SELF contains %@", @"o"];
NSArray* newArray = [origarray filteredArrayUsingPredicate:predicate]; 
```

或者

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"SELF contains[cd] %@", @"o"];
NSArray* newArray = [origarray filteredArrayUsingPredicate:predicate]; 
```

用于不区分大小写的匹配

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T14:06:12.873

你得到一个空数组的原因是每次迭代时，你都在重新分配你的数组。试试这个（注意我已经把数组的分配放在循环之前，所以它只完成了一次并且还更新了文本视图）：

```
NSArray *origarray = [NSArray arrayWithObjects:
             @"One",
             @"Two",
             @"Three",
             @"Four",
             @"Five",nil];

NSMutableArray *newarray = [[NSMutableArray alloc] init];

for(NSString *words in origarray){
    NSRange range = [words rangeOfString:@"o"];
    if(range.location != NSNotFound){
        [newarray addObject:words];
    }
}

textview.text = [newarray description]; 
```

**编辑**：@Alladinian 提出了一个很好的观点，即 rangeOfString: 进行区分大小写的搜索。如果您希望它不区分大小写，则必须更改：

```
NSRange range = [words rangeOfString:@"o"]; 
```

至

```
NSRange range = [words rangeOfString:@"o" options:NSCaseInsensitiveSearch]; 
```

# landscape - AutoCompleteTextView OnItemClickListener 空参数（HTC Desire S 上的横向模式）

> ID：11121337
> 
> 赞同：3
> 
> 时间：2012-06-20T14:01:53.573
> 
> 标签：landscape, autocompletetextview, onitemclicklistener, android

**我的问题：**我有一个带有 OnItemClickListener 的 AutoCompleteTextView。这已经工作了 18 个月，但我现在注意到，当我在 HTC Desire S 上以横向模式选择项目时，它会引发 NullPointerException。（纵向模式或我使用的任何其他手机或模拟器都没有错误测试它）。

该`AdapterView<?> av`参数作为空值传入。为什么会这样，我该如何解决？

**代码 ：**

```
myAutoCompleteTextView = (AutoCompleteTextView) findViewById(R.id.myAutoCompleteTextView);
myAutoCompleteTextView.setSingleLine();

myAutoCompleteTextView.setOnItemClickListener(new OnItemClickListener() {
    public void onItemClick(AdapterView<?> av, View v, int index, long arg) {
        String selectedItem = (String)av.getItemAtPosition(index);  
        //Do stuff with selected item ...
    }
} 
```

**错误 ：**

```
 java.lang.NullPointerException
    at uk.co.myCompany.mobile.android.myCompanymobile.pages.groups.AbstractGroupSelectionPage$3.onItemClick(AbstractGroupSelectionPage.java:228)
    at android.widget.AutoCompleteTextView.onCommitCompletion(AutoCompleteTextView.java:993)
    at com.android.internal.widget.EditableInputConnection.commitCompletion(EditableInputConnection.java:76)
    at com.android.internal.view.IInputConnectionWrapper.executeMessage(IInputConnectionWrapper.java:368)
    at com.android.internal.view.IInputConnectionWrapper$MyHandler.handleMessage(IInputConnectionWrapper.java:86)
    at android.os.Handler.dispatchMessage(Handler.java:99)
    at android.os.Looper.loop(Looper.java:150)
    at android.app.ActivityThread.main(ActivityThread.java:4385)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:507)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:849)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:607)
    at dalvik.system.NativeStart.main(Native Method) 
```

**额外代码 - 我的自定义适配器内部类：**

```
/**
 * An inner class to simply make a custom adapter in which we can alter the on-screen look of selected groups.
 */
private class SelectedGroupAdapter extends ArrayAdapter<Group> {
    private ArrayList<Group> items;
    private int layout;

    public SelectedGroupAdapter(Context context, int layout, ArrayList<Group> items) {
        super(context, layout, items);
        this.items = items;
        this.layout = layout;
    }
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View v = convertView;
        if (v == null) {
            LayoutInflater vi = (LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            v = vi.inflate(layout, null);
        }                           
        Group o = items.get(position);

        //Display the group name and number of contacts
        if (o != null) {
            TextView groupName = (TextView) v.findViewById(R.id.groupName);
            TextView noOfContacts = (TextView) v.findViewById(R.id.noOfContacts);
            if (groupName != null) {
                groupName.setText(o.getGroupName());
            }
            if(noOfContacts != null) {
                if (o.isDynamic())
                    noOfContacts.setText(getString(R.string.dynamic));
                else {
                    int contactsCount = o.getGroupSize();
                    if(contactsCount == 1) noOfContacts.setText(contactsCount + " " + getString(R.string.contact));
                    else noOfContacts.setText(contactsCount + " " + getString(R.string.contacts));
                }
            }
        }
        return v;
    }              
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T14:26:11.897

我的预感是，既然您`android:configChanges="orientation"`在清单中声明，那么当您旋转旧`OnItemClickListener`布局时，旧布局仍然存在，并且由于您在技术上拥有一个新布局，因此`AdapterView`在方向更改之前使用的布局不再存在，因此为空当您单击一个项目时。

如果是这种情况，我认为有两件事可以解决这个问题：

1.  删除`orientation`清单中的选项。您放置的任何事件都会`configChanges`告诉 Android “我正在处理此配置更改，所以让我处理它”，而不是让 Android 处理它。在方向改变的情况下，Android 的正常操作是销毁并重新创建你的`Activity`（它会自动用数据重新填充一些`View`s）。

2.  如果您决定需要处理方向更改，则覆盖`onConfigurationChanged()`并将 设置为应该在方法中重新创建`OnItemClickListener`的新`AdapterView`对象（`ListView`, `GridView`，无论您使用哪个）`onCreate`。

# c++ - C++ 给全局变量一个初始值

> ID：11121338
> 
> 赞同：3
> 
> 时间：2012-06-20T14:01:55.323
> 
> 标签：c++, variables, global

我正在用 Visual C++ 编写代码，我需要使用一个全局变量。我知道这通常不是一个好主意，但在这种情况下，这是必要的。我已经创建了变量，它可以从需要它的函数中访问，但我不知道如何给它一个初始值。

在 .h 文件中，它看起来像

```
extern int lversion; 
```

在 .cpp 文件中它看起来像

```
int lversion; 
```

我怎样才能给这个变量一个初始值0？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T14:02:53.040

分别在 .h 和 .cpp 文件中添加这两行将允许您初始化全局变量。

。H：

```
extern int Val; 
```

.cpp：

```
int Val = 0; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T14:03:03.757

该变量确实具有初始值`0`。除非另有说明，否则全局变量和静态变量都是**值初始化的。**（对于`int`，它将是`0`）

如果你想要任何其他值，你可以指定它：

在**cpp**文件中：

```
int lversion= 3; 
```

或者

```
int lversion(3); 
```

但是对于一个值`0`来说，这么冗长是没有意义的。

# ios - UIButton 隐藏但工作

> ID：11121342
> 
> 赞同：2
> 
> 时间：2012-06-20T14:02:04.917
> 
> 标签：ios, ios5, uinavigationcontroller, uibutton, automatic-ref-counting

我正在做一个应用程序，使用 ARC。我将一个按钮作为子视图添加到导航控制器，然后将其删除。它在模拟器上运行良好，但在设备上，使用很长时间后，按钮被隐藏，但在触摸该区域时，它会响应。

会不会是内存问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T16:31:26.340

无论你放在哪里`button.hidden = YES`，也放在哪里`button.enabled = NO`。

# spring - 自定义maven插件、spring和配置文件

> ID：11121344
> 
> 赞同：1
> 
> 时间：2012-06-20T14:02:08.563
> 
> 标签：spring, maven, maven-plugin

我编写了一个实例化 Spring 上下文的 Maven 插件。我希望能够使用项目类路径中的属性文件配置 Spring 上下文。在插件上下文 XML 中，我有：

```
<bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
  <property name="locations">
    <value>classpath:configurator.properties</value>
  </property>
</bean> 
```

当我使用我的插件在 Maven 项目中运行正确的插件目标时，Spring 无法从**target/classes文件夹中读取****configurator.properties**文件。

 **我应该如何配置我的 mojo 以允许在我的插件中运行的 Spring 从项目类路径中读取属性文件？**

# javascript - 脚本在 jQuery 中不起作用

> ID：11121345
> 
> 赞同：1
> 
> 时间：2012-06-20T14:02:11.263
> 
> 标签：javascript, jquery, html, json

我有这个 jQuery 代码：

```
document.getElementById('geo_us').innerHTML = "<script type='text/javascript' src='http://www.101greatgoals.com/wp-content/themes/tutorial/js/gadout.js'></scr" + "ipt>";
$("#geo_us").append("<div id='div-gpt-ad-1335877669074-0' style='width:160px; height:600px;'></div>");
document.getElementById('div-gpt-ad-1335877669074-0').innerHTML = "<script type='text/javascript' src='http://www.101greatgoals.com/wp-content/themes/tutorial/js/gad.js'></scr" + "ipt>"; 
```

这是我得到的结果：外部js的内容/代码不存在..

```
<div id="geo_us">
   <script src="http://www.101greatgoals.com/wp-content/themes/tutorial/js/gadout.js" type="text/javascript">
   </script>
   <div style="width: 160px; height: 600px;" id="div-gpt-ad-1335877669074-0">
      <script src="http://www.101greatgoals.com/wp-content/themes/tutorial/js/gad.js" type="text/javascript">
      </script>
   </div>
</div> 
```

你知道代码有什么问题吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:03:23.163

您不能使用 innerHTML 添加脚本标签，请将 append 与 document.create 元素一起使用。为什么要混合使用 jQuery 和常规 JavaScript。选一个。

```
var str = '<script src="http://www.101greatgoals.com/wp-content/themes/tutorial/js/gadout.js"></script><div style="width: 160px; height: 600px;" id="div-gpt-ad-1335877669074-0"><script src="http://www.101greatgoals.com/wp-content/themes/tutorial/js/gad.js"></script></div>';
jQuery("#geo_us").append( str ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T14:05:16.413

尝试这个：

```
$('#geo_us').html("<script type='text/javascript' src='http://www.101greatgoals.com/wp-content/themes/tutorial/js/gadout.js'></scr" + "ipt>");

$("#geo_us").append($("<div id='div-gpt-ad-1335877669074-0' style='width:160px; height:600px;'></div>"));

$('#div-gpt-ad-1335877669074-0').html("<script type='text/javascript' src='http://www.101greatgoals.com/wp-content/themes/tutorial/js/gad.js'></scr" + "ipt>"); 
```

# java - Java 中的语义查询

> ID：11121349
> 
> 赞同：1
> 
> 时间：2012-06-20T14:02:25.960
> 
> 标签：java, semantics

我正在做一个爱好项目，我必须在其中爬取不同的网页，进行一些分析并回答一些查询。例如，一个网页可以包含如下数据：

> 1人在抢劫中受伤。
> 昨晚有两人在未遂抢劫案中受伤。
> 警方正在寻找因抢劫未遂而造成三人受伤的人。

我有兴趣回答诸如每起此类事件中有多少人受伤之类的问题。我的问题是我该怎么做。有没有可以帮助我完成这项任务的库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:09:07.990

看看[Jena](http://jena.apache.org/)，似乎就是你要找的东西

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T14:12:45.110

我猜你正在涉足openNLP。您需要有自己的算法来获得问答系统所需的答案。以下内容可能对您有所帮助

Apache 打开 nlp --> [http://opennlp.apache.org/](http://opennlp.apache.org/)

阿帕奇耶拿 --> [http://jena.apache.org/](http://jena.apache.org/)

斯坦福打开 nlp --> [http://nlp.stanford.edu/software/corenlp.shtml](http://nlp.stanford.edu/software/corenlp.shtml)

我猜还有其他几个，但这些是非常受欢迎的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T12:21:15.943

试试[斯坦福 CoreNLP](http://nlp.stanford.edu:8080/corenlp/)演示。它用作语音标记器的一部分。它生成一个 XML 输出和漂亮的打印输出，并将“一个人在抢劫中受伤”中的“一个”显示为一个数字。试试看..这对你真的很有帮助。然后，您可以使用java中的DOM解析器来解析XML文件，您可以通过检查文件中的“NER”标签并查看它是否是数字来轻松分离出“one”。

# c# - Visual Studio 2010 中的 Ajax Accordion，有解决方案吗？

> ID：11121351
> 
> 赞同：2
> 
> 时间：2012-06-20T14:02:34.370
> 
> 标签：c#, asp.net, ajax, visual-studio-2010, accordion

我有一个使用 Ajax Accordion 的页面，当我运行该站点时，它工作得非常好，但是当我在 VS2010 的设计视图中时，一切看起来都是一团糟。手风琴放在我看来像一个列表框的地方，没有要最小化的窗格，并且有很多上下滚动来查看每个窗格中的控件。

我不确定这是否就是它应该的样子，或者我做错了什么，因为在我使用 Dreamweaver 的工作中（虽然它不是 Ajax Accordion），我发现您可以在其设计视图中折叠每个窗格，并且它会更准确地显示您刚刚创建的内容的外观。那么有什么方法可以实现这一点吗？

如果有任何有用的代码我可以提供，谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T15:04:36.583

众所周知，VS 中的设计视图在显示事物应有的样子方面很差。老实说 - 只是不要使用它。如果您想实时查看准确的标记/控件，只需在进行更改时进行调试。保存文件并刷新页面将显示您的更新。

# git - 如何从 GitHub 存储库中删除文件？

> ID：11121352
> 
> 赞同：15
> 
> 时间：2012-06-20T14:02:38.893
> 
> 标签：git, github

我从本地 repo 中删除了 python .pyc 文件，我认为我所做的是从远程 github 中删除。

我推动了所有的变化。这些文件仍在 repo 上，但不在我的本地计算机上。如何从 github 存储库中删除文件？

我尝试了以下方法：

```
git rm classes/file.pyc
git add .
git 
```

乃至：

```
git rm --cached classes/file.pyc 
```

然后，当我尝试签出文件时，我收到此错误。

```
enter code here`error: pathspec 'classes/redis_ha.pyc' did not match any file(s) known to git. 
```

我现在不知道还能做什么。到目前为止，我有一个完全损坏的 git repo。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-06-20T14:06:05.627

你不应该这样做`git add`。就这样

```
git rm classes/file.pyc
git commit -m"bla bla bla"
git push 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-04-29T11:24:34.070

```
git commit -am "A file was deleted"
git push 
```

# iphone - 如何通过选择颜色选项为 UIBezeirPath 设置不同的颜色

> ID：11121354
> 
> 赞同：2
> 
> 时间：2012-06-20T14:02:51.263
> 
> 标签：iphone, ios, cocoa-touch, core-graphics, uibezierpath

我正在使用 UIBezeirPath，并且在我的 drawRect 方法中，我采用了硬编码的颜色以通过以下方式为我的路径（线）设置描边

```
- (void)drawRect:(CGRect)rect
{ 
 [[UIColor redColor] setFill];
 for (UIBezierPath *_path in pathArray) 
 {
      [_path strokeWithBlendMode:kCGBlendModeNormal alpha:1.0];

  }
} 
```

这工作正常并为我绘制的路径（线）设置红色。现在当我从颜色选项中选择不同颜色时，假设我选择蓝色，现在当我开始绘制路径时，颜色为蓝色，**但之前绘制的红线也变为蓝色。这就是整个问题**

下面是我的代码我如何设置不同的颜色

```
- (void)drawRect:(CGRect)rect
{
if(changecolor)
    {
        AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
        strokeColor = appDelegate.color;
        NSLog(@"%@",strokeColor);

        SEL blackSel = NSSelectorFromString(strokeColor);
        UIColor* tColor = nil;
        if ([UIColor respondsToSelector: blackSel])
            tColor  = [UIColor performSelector:blackSel];
        [tColor setStroke];
        [tColor setFill];       
    }
    else
    {    
        [[UIColor redColor] setStroke];
        [[UIColor redColor] setFill];

        for (UIBezierPath *_path in pathArray) 
        {
            [_path strokeWithBlendMode:kCGBlendModeNormal alpha:1.0];

        }
   }
} 
```

无论我这样做是正确的，还是我错过了什么。请帮帮我

问候兰吉特

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T07:05:49.403

只需在一个数组中保持当前颜色，在另一个数组中保持 bezierpaths。然后像下面那样做图。

```
 int q=0;

for (UIBezierPath *_path in pathArray) 
{
UIColor *_color = [colorArray objectAtIndex:q];
[_color setStroke];
[_path strokeWithBlendMode:kCGBlendModeNormal alpha:1.0]; 
q++;
} 
```

# java - 比较循环链表等于方法

> ID：11121360
> 
> 赞同：0
> 
> 时间：2012-06-20T14:03:11.027
> 
> 标签：java, linked-list, circular-reference

```
public class LinkedList {

 Object contents;
 LinkedList next = null;

public boolean equals(Object item) {
   return (this == item) || ((item instanceof LinkedList) &&  this.equals((LinkedList)item)); 
  }

 public boolean equals(LinkedList item) { 
   return myUtil.equals(this.contents, item.contents) && myUtil.equals(this.next, item.next); 
 }

} 

public class myUtil{
  public static boolean equals(Object x, Object y) {
    return (x == y) || (x != null && x.equals(y));
 }
}

main(){
 LinkedList myList = new LinkedList();
 myList.next = new LinkedList();
 LinkedList head = myList.next;
 myList.next = head;
} 
```

我想我在这里创建了一个循环链表。所以我所做的是覆盖equals方法以确保处理循环引用：

由于某种原因 LinkedList.equals 似乎没有返回......是因为我的循环链表，还是我错过了一些条件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:18:39.833

此代码的主要问题是您的比较不会在循环引用时终止，并且如果所有内容字段都相等，则将永远循环。它将一直持续到下一个比较，并且由于下一个项目始终存在（因为它是一个圆圈），这将永远持续下去。

```
myUtil.equals(this.contents, item.contents) && myUtil.equals(this.next, item.next); 
```

要解决此问题，最简单的方法是为每个列表项添加一个布尔私有“已访问”字段。比较时，对比较后的每一项设置visited。如果两者都没有访问过并且相同，则继续。如果只访问一个，则您的列表不相同。如果两者都被访问，则您已经比较了整个列表的可达性。通常，在列表中包含循环是一个坏主意，并且存在专门用于检测它们的算法。这可能是一个令人困惑的话题。这是循环检测的[覆盖范围](http://ostermiller.org/find_loop_singly_linked_list.html)，可以帮助您进一步了解问题。请记住，如果您使用访问字段，则必须在 equals() 中使用另一个循环取消设置所有这些字段，以使其再次运行。

另一方面，您没有为测试初始化​​列表节点的内容字段。这在这里没问题，因为它们被初始化为 null，但通常最好显式初始化所有字段。

一般来说，您也不需要`equals(Object item)`覆盖。尝试

```
public boolean equals(LinkedList item){
  if (this == item){
     return true; // It's the same object
  }

  // Add some null checks here, I'm lazy

  if (this.visited && item.visited && this.contents.equals(item.contents){
     this.visited = false; //Unset
     item.visited = false;
     return true;
  }
  if (this.visited && !item.visited){
      this.visited = false;
      return false;
  }
  if (!this.visited && item.visited){
      item.visited = false;
      return false;
  }
  if (!this.visited && !item.visited && this.visited.contents.equals(item.contents){
      this.visited = true;
      item.visited = true;
      boolean ret = this.next.equals(item.next);
      this.visited = false;
      item.visited = false;
      return ret;
  }

  // Contents not equal
  return false;
} 
```

这会通过一些基本的递归来回溯和取消设置。我显然没有编译这个，但我认为这就是它的要点（我希望没有太多错误）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T14:16:50.087

两个问题，首先你没有循环链表。以下代码创建 2 个列表，list1.next = list2，list2.next = null。没有创建圈子。

```
LinkedList myList = new LinkedList();
myList.next = new LinkedList();
LinkedList head = myList.next;
myList.next = head; 
```

其次，如果你有一个循环链表，下面会产生一个无限循环，因为没有达到结束条件，这是因为在循环链接中，`next`不应该是`null`.

```
public boolean equals(Object item) {
  return (this == item) || ((item instanceof LinkedList) &&       
    this.equals((LinkedList)item)); 
}

public boolean equals(LinkedList item) { 
   return myUtil.equals(this.contents, item.contents) && myUtil.equals(this.next, item.next); 
} 
```

为了有效地做到这一点，您需要提供一些机制来以非循环方式迭代列表，即使该机制是私有的并且不向其他用户公开。一种方法是将单个节点标记为“根”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T14:10:18.703

```
return myUtil.equals(this.contents, item.contents) 
&& myUtil.equals(this.next, item.next); 
```

我想这是您怀疑的问题，当您执行 && 的第二个表达式时，即`myUtil.equals(this.next, item.next);`输入执行此行的 myUtil.equals 方法：

```
return (x == y) || (x != null && x.equals(y)); 
```

它又使用`x`'s .equals() 方法，它会重复它的过程`item.next`，依此类推，因为你有一个循环链表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T14:26:40.890

这将导致无限循环，这是因为在代码中：

```
public static boolean equals(Object x, Object y) {
        return (x == y) || (x != null && x.equals(y));
    } 
```

将`x.equals(y)`再次调用：

```
public boolean equals(LinkedList item) {
        return myUtil.equals(this.contents, item.contents)
                && myUtil.equals(this.next, item.next);
    } 
```

但是如果你正在执行`myList1.equals(myList1)`，你不会得到一个无限循环，因为`(x==y)`in`myUtils.equals()`会返回`true`，所以如果你比较相同的对象，就不会发生无限循环。

但是，当您比较不同的对象时，您将进入无限循环。

这不是循环列表问题，这是因为您选择的代码设计。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-13T16:36:55.363

终于完成了我的**equals**方法实现。为此，我不得不自己使用额外的检查工具。我不能说它是否有效，但检查了一些异常状态。

```
public boolean equals(Object o)
{
    if(!(o instanceof CircularlyLinkedList))
        return false;

    CircularlyLinkedList<E> list=(CircularlyLinkedList<E>)o;

    if(this==list)
        return true;

    if(size()!=list.size())
        return false;
    //tail element of this object
    Node<E> thisTail=tail;

    //tail element of list passing as parameter
    Node<E> listTail=list.tail;

    //checking if tail elements of both lists are the same or not. If not rotate list till equatation is provided for tails
    if(!thisTail.equals(listTail))
    {
        listTail = equate(list);
        if(listTail==null)
            return false;
    }

    //Each element checking
    for(int i=0; i<size(); i++)
    {
        thisTail=thisTail.next;
        listTail=listTail.next;

        if(!thisTail.equals(listTail))
        {
            listTail = equate(list);
            listTail=tail;
            i=0;
            if(listTail==null)
                return false;
        }
    }

    return true;
} 
```

和**等价**方法：

```
private Node<E> equate(CircularlyLinkedList<E> list)
{

    Node<E> thisTail=tail;
    Node<E> listTail;
    for(int i=0; i<list.size(); i++)
    {
        list.rotate();
        listTail=list.tail;

        //If full rotation completes then returns null
        if(list.getRotation()==0)
        {
            return null;
        }
        if(thisTail.equals(listTail))
        {
            return nodeList;
        }
    }

    return null;
} 
```

**getRotation**方法返回旋转操作的计数并在 0 和*size-1*之间变化。我希望它会变得有用。

# c# - 如何在 XmlDocument 中修改 DocumentElement.Prefix

> ID：11121364
> 
> 赞同：0
> 
> 时间：2012-06-20T14:03:32.290
> 
> 标签：c#, .net, xml, xml-parsing, xmldocument

我有一些 xml 集，我必须在没有任何前缀的节点上添加命名空间前缀。

我编写了一个适用于除根元素以外的所有节点的代码。

请指出我也可以更改根元素前缀的事情。

```
 private void ReplaceFile(string xmlfile)
 {
     XmlDocument doc = new XmlDocument();
     doc.Load(xmlfile);
     var a = doc.CreateAttribute("xmlns:mailxml12tm");
     a.Value = "http://idealliance.org/Specs/mailxml12.0a/mailxml_tm";
     doc.DocumentElement.Attributes.Append(a);
     doc.DocumentElement.Prefix = "mailxml12tm";
     //foreach (XmlNode item in doc.SelectNodes("//*").Cast<XmlNode>().Where(item => item.Prefix.Length == 0))
     //{
     //    item.Prefix = "mailxml12tm";
     //}
     doc.Save(xmlfile);
} 
```

xml文件：

```
<DeliveryApptCreateRequest 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
    p3:ApptType="Pallet" p3:PickupOrDelivery="Delivery" 
    p3:ShipperApptRequestID="4490B0C07355" p3:SchedulerCRID="6498874" 
    xmlns:p3="http://idealliance.org/Specs/mailxml12.0a/mailxml_defs">
    <SubmitterTrackingID xmlns="http://idealliance.org/Specs/mailxml12.0a/mailxml_tm">2CAD3FBC71B1E1517021</SubmitterTrackingID>
    <DestinationEntry xmlns="http://idealliance.org/Specs/mailxml12.0a/mailxml_tm">No</DestinationEntry>
    <OneTimeAppt xmlns="http://idealliance.org/Specs/mailxml12.0a/mailxml_tm">
        <PreferredAppt>2012-07-01T09:00:00Z</PreferredAppt>
    </OneTimeAppt> 
</DeliveryApptCreateRequest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T15:14:52.443

您是否看过这个答案：[Jeff Sternal](https://stackoverflow.com/users/47886/jeff-sternal) 的[https://stackoverflow.com/a/2255337/219344](https://stackoverflow.com/a/2255337/219344)？

> 如果您已经在根节点中声明了命名空间，则只需更改 SetAttribute 调用以使用不带前缀的属性名称。因此，如果您的根节点定义了这样的命名空间：
> 
> `<People xmlns:s='http://niem.gov/niem/structures/2.0'>`
> 
> 您可以这样做，该属性将获取您已经建立的前缀：
> 
> `// no prefix on the first argument - it will be rendered as //` `s:id='ID_Person_01' TempElement.SetAttribute("id",` `"http://niem.gov/niem/structures/2.0", "ID_Person_01");`
> 
> 如果您尚未声明命名空间（及其前缀），则三字符串 XmlDocument.CreateAttribute 重载将为您完成：
> 
> `// Adds the declaration to your root node var attribute =` `xmlDocToRef.CreateAttribute("s", "id",` `"http://niem.gov/niem/structures/2.0"); attribute.InnerText =` `"ID_Person_01" TempElement.SetAttributeNode(attribute);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T15:16:40.463

您可以使用以下内容：

```
XmlDocument doc = new XmlDocument();
doc.LoadXml("<test xmlns='123'/>");
XmlElement e = doc.DocumentElement;       
e.Prefix = "a";
Console.WriteLine(doc.InnerXml); 
```

输出：

```
<a:test xmlns="123" xmlns:a="123" /> 
```

创立于[msdn](http://msdn.microsoft.com/en-us/library/ecf3e2k0%28v=vs.110%29)。

**编辑：**

由于它不适用于您的主要元素，您可以`.Replace("<", "<Prefixe:"));`在根元素上使用`String`. 它不漂亮，但它可以完成工作。

# reporting-services - SSRS 工具提示闪烁

> ID：11121365
> 
> 赞同：2
> 
> 时间：2012-06-20T14:03:50.797
> 
> 标签：reporting-services, ssrs-2008

我在将书写模式更改为 Rotate270 的文本上出现闪烁的工具提示问题。闪烁的意思是，当您将鼠标悬停在文本框上时，工具提示不会出现，而只有当您将鼠标悬停在文本框中的实际文本上时才会出现。此时鼠标指针变为闪烁的光标，工具提示随之闪烁。

这不会发生在水平文本上，仅当书写模式设置为 Rotate270 时才会出现此问题。

其他人遇到过这个问题吗？

# amazon-ec2 - 如何允许多个用户同时访问同一个亚马逊实例？

> ID：11121370
> 
> 赞同：2
> 
> 时间：2012-06-20T14:03:58.487
> 
> 标签：amazon-ec2, multi-user

我是 Amazon Cloud 的新手，正在尝试创建一个允许多个用户同时访问的 EC2 实例。

虽然有很多文档，但我还没有找到我的问题的答案。每当这些文档说“用户”时，它指的是我。但是我想在实例中安装一个应用程序，并允许我的多个用户同时访问它。

我怎样才能做到这一点？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:39:22.413

与将多个用户添加到普通实例的方式相同。我假设您使用的是 linux 并且可以登录到实例，如果没有，[请参阅这篇文章。](https://stackoverflow.com/a/8919031/667608)现在您只需要[添加一个用户](http://linux.about.com/od/commands/l/blcmdl8_adduser.htm)，并[设置 ssh 密钥](http://inside.mines.edu/~gmurray/HowTo/sshNotes.html)。

# java - GWT RequestBuilder - 跨站点请求

> ID：11121374
> 
> 赞同：6
> 
> 时间：2012-06-20T14:04:07.597
> 
> 标签：java, gwt, httprequest

我正在尝试使用 GWT 请求构建器进行跨站点请求，但我还不能让它工作。如您所见，这是一个示例 GWT 项目，我已经浏览了[https://developers.google.com/web-toolkit/doc/latest/tutorial/Xsite](https://developers.google.com/web-toolkit/doc/latest/tutorial/Xsite)。但我仍然缺少一些东西。

我在这里发布代码。我错过了什么..？

```
package com.gwt.reqbuilder.client;

import com.google.gwt.core.client.EntryPoint;
import com.google.gwt.http.client.Request;
import com.google.gwt.http.client.RequestBuilder;
import com.google.gwt.http.client.RequestCallback;
import com.google.gwt.http.client.RequestException;
import com.google.gwt.http.client.Response;
import com.google.gwt.http.client.URL;
import com.google.gwt.user.client.Window;

public class GWTRequestBuilder implements EntryPoint
{
    private static final String JSON_URL = "http://localhost:8000/?q=ABC&callback=callback125";
    public void onModuleLoad()
    {
        GWTPOSTHTTP();
    }

    public void GWTPOSTHTTP()
    {
        String postUrl="http://localhost:8000";
        String requestData="q=ABC&callback=callback125";
        RequestBuilder builder = new RequestBuilder(RequestBuilder.POST, postUrl);
        try {
            builder.sendRequest(requestData.toString(), new RequestCallback() 
            {
                public void onError(Request request, Throwable e) 
                {
                    Window.alert(e.getMessage());
                }
                public void onResponseReceived(Request request, Response response)
            {
                    if (200 == response.getStatusCode())
                    {
                        Window.alert(response.getText());
                    } else {
                        Window.alert("Received HTTP status code other than 200 : "+ response.getStatusText());
                    }
            }
            });
        } catch (RequestException e) {
            // Couldn't connect to server
        Window.alert(e.getMessage());
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T21:01:08.337

实际上，如果我们可以在 Servlet 响应头中设置，我们可以从 GWT RequestBuilder 发出跨站点请求

```
Response.setHeader("Access-Control-Allow-Origin","http://myhttpserver"); 
```

它的工作很酷，如果有人需要 GWT 项目和 Python Servlet，请告诉我，我可以上传文件。

```
GWT Client Code : https://github.com/manikandaraj/MLabs/tree/master/GWT/GWTClient 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-20T14:56:40.957

你错过了阅读教程。

[教程](https://developers.google.com/web-toolkit/doc/latest/tutorial/Xsite)中的直接引用：

> RequestBuilder 代码替换为对 getJson 方法的调用。因此**，您不再需要**refreshWatchList 方法中的以下代码：

```
RequestBuilder builder = new RequestBuilder(RequestBuilder.GET, url);

尝试 {
  请求请求 = builder.sendRequest(null, new RequestCallback() {
    public void onError(Request request, Throwable exception) {
      displayError("无法获取 JSON");
    }

    公共无效onResponseReceived（请求请求，响应响应）{
      if (200 == response.getStatusCode()) {
        updateTable(asArrayOfStockData(response.getText()));
      } 别的 {
          displayError("无法检索 JSON (" + response.getStatusText()
            + ")");
      }
    }
  });
} 捕捉（请求异常 e）{
  displayError("无法获取 JSON");
}

```

这大致是您所拥有的，应该由教程中给出的 JSNI 函数替换，如下几行：

```
  /**
   * 调用远程服务器。
   */
  public native static void getJson(int requestId, String url,
      StockWatcher 处理程序）/*-{
   var回调=“回调”+ requestId；

   // [1] 创建一个脚本元素。
   var script = document.createElement("script");
   script.setAttribute("src", url+callback);
   script.setAttribute("type", "text/javascript");

   // [2] 在窗口对象上定义回调函数。
   窗口[回调] = 函数（jsonObj）{
   // [3]
     handler.@com.google.gwt.sample.stockwatcher.client.StockWatcher::handleJsonResponse(Lcom/google/gwt/core/client/JavaScriptObject;)(jsonObj);
     窗口[回调+“完成”] = true;
   }

    ...

```

# node.js - 我的 node.js 在没有报告任何错误的情况下没有响应

> ID：11121379
> 
> 赞同：1
> 
> 时间：2012-06-20T14:04:30.443
> 
> 标签：node.js

我在 node.js 中编写了 http 服务器，它类似于 Amazon S3 的反向代理，并使用 Node 的集群模块、nodejitsu/forever 和 Nginx 将其部署在生产环境中。它工作得很好，但有一天（今天）它停止了响应。我检查了节点的 console.log() 输出和进程，但没有发现任何奇怪的地方。

我的代码要点如下：

```
http.createServer(function(webReq, webRes) {
  http.get(s3Options, function(s3Res) {
    if (s3Res.statusCode == 200) {
      s3Res.on('end', function() {
        webRes.end('Found data on S3');
      });
    } else {
      webRes.end('No data on S3'); 
    }
  }).on('error', function(e) {
    console.log('problem with s3Req: ' + e.message);
  });
}).listen(1337); 
```

节点进程都处于活动状态（2 个子工作者）而不会永远重新启动：

```
# ps x | grep node
31436 ?  Ss  3:43 node /usr/bin/forever -l LOG -o OUT -e ERR -a start server.js
31437 ?  Sl  0:10 node /root/server.js
31440 ?  Sl  1:17 /usr/bin/nodejs /root/server.js
31441 ?  Sl  1:17 /usr/bin/nodejs /root/server.js 
```

然后我怀疑有太多连接的东西并做了“lsof -p PID | wc -l”，但计数都处于良好状态 - 只有几十个。

我的 node.js 经验只有一周左右。我错过了什么重要的事情吗？

# jquery-mobile - 用于移动网站的“与 twitter 联系”

> ID：11121381
> 
> 赞同：0
> 
> 时间：2012-06-20T14:04:37.250
> 
> 标签：jquery-mobile, twitter, twitter-anywhere

我正在使用@Anywhere 代码为我的网站实现 twitter 注册功能

```
twttr.anywhere(function (T) {
            document.getElementById("signin-btn").onclick = function () {
                T.signIn()
            };
        }); 
```

上面写的是我在我的网站上放置“与 twitter 连接”按钮的代码。它会将我重定向到[http://oath.twitter.com/](http://oath.twitter.com/) ......并为桌面浏览器打开一个常规的 twitter 登录网页。

我想打开移动版登录页面而不是桌面大小的登录页面，因为我的网站用户将是移动用户。所以他们在手机上打开我的页面，所以我想要打开 twitter 的手机版页面我该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T11:31:37.007

它应该自动将移动用户重定向到移动页面。你试过在手机上测试它吗？或者尝试将浏览器的用户代理设置为手机的用户代理。

# javascript - 在 CRM 2011 中的 Javascript 中不触发 attachEvent

> ID：11121384
> 
> 赞同：0
> 
> 时间：2012-06-20T14:04:47.043
> 
> 标签：javascript, dom-events, dynamics-crm-2011

我在我使用的地方有以下一段 Javascript `attachEvent`。

```
crmForm.all.new_height.attachEvent ("onkeyup", doCalc);
function doCalc ()
{
   alert("hello");
} 
```

其中 new_height 是一个字段。`onkeyup`所以我的目标是在`new_height`现场触发事件。所以我在表单事件中使用了这个 Javascript ，但是当我写入字段`OnLoad`文本时它没有触发。`new_height`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:34:41.147

为此，请使用：

```
crmForm.all.new_height.attachEvent("onkeyup", function(){doCalc();}); 
```

其他查看此帖子的人的旁注。不要忘记 crmForm.all 是特定于 IE 的，并且 attachEvent 仅适用于 IE（和 Opera）。

在 CRM 2011 中，您最好使用：

```
Xrm.Page.getControl('telephone2')._control._element.attachEvent("onkeyup", function(){alert('test');}); 
```

它也是 IE 特定的（使用 attachEvent），但它使用 Xrm 变量。

# r - 重复data.frame的行

> ID：11121385
> 
> 赞同：110
> 
> 时间：2012-06-20T14:04:47.377
> 
> 标签：r, dataframe, rows, repeat

我想每次重复 data.frame 的行`N`。结果应该是一个新的`data.frame`(with `nrow(new.df) == nrow(old.df) * N`) 保持列的数据类型。

N = 2 的示例：

```
 A B   C
  A B   C             1 j i 100
1 j i 100     -->     2 j i 100
2 K P 101             3 K P 101
                      4 K P 101 
```

因此，每行重复 2 次，字符仍然是字符，因子仍然是因子，数字仍然是数字，...

我第一次尝试使用 apply: `apply(old.df, 2, function(co) rep(co, each = N))`，但这一次将我的值转换为字符，我得到：

```
 A   B   C    
[1,] "j" "i" "100"
[2,] "j" "i" "100"
[3,] "K" "P" "101"
[4,] "K" "P" "101" 
```

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2012-06-20T14:09:10.623

```
df <- data.frame(a = 1:2, b = letters[1:2]) 
df[rep(seq_len(nrow(df)), each = 2), ] 
```

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2017-12-12T19:53:47.730

一个干净的`dplyr`解决方案，取自[这里](https://stackoverflow.com/questions/38237350/repeating-rows-of-data-frame-in-dplyr#comment63896747_38237805 "这里")

```
library(dplyr)
df <- tibble(x = 1:2, y = c("a", "b"))
df %>% slice(rep(1:n(), each = 2)) 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2018-09-13T00:49:36.670

有一个可爱的矢量化解决方案，它只重复某些行 n 次，例如，可以通过`ntimes`在数据框中添加一列：

```
 A B   C ntimes
1 j i 100      2
2 K P 101      4
3 Z Z 102      1 
```

方法：

```
df <- data.frame(A=c("j","K","Z"), B=c("i","P","Z"), C=c(100,101,102), ntimes=c(2,4,1))
df <- as.data.frame(lapply(df, rep, df$ntimes)) 
```

结果：

```
 A B   C ntimes
1 Z Z 102      1
2 j i 100      2
3 j i 100      2
4 K P 101      4
5 K P 101      4
6 K P 101      4
7 K P 101      4 
```

这与 Josh O'Brien 和 Mark Miller 的方法非常相似：

```
df[rep(seq_len(nrow(df)), df$ntimes),] 
```

但是，该方法似乎要慢一些：

```
df <- data.frame(A=c("j","K","Z"), B=c("i","P","Z"), C=c(100,101,102), ntimes=c(2000,3000,4000))

microbenchmark::microbenchmark(
  df[rep(seq_len(nrow(df)), df$ntimes),],
  as.data.frame(lapply(df, rep, df$ntimes)),
  times = 10
) 
```

结果：

```
Unit: microseconds
                                      expr      min       lq      mean   median       uq      max neval
   df[rep(seq_len(nrow(df)), df$ntimes), ] 3563.113 3586.873 3683.7790 3613.702 3657.063 4326.757    10
 as.data.frame(lapply(df, rep, df$ntimes))  625.552  654.638  676.4067  668.094  681.929  799.893    10 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-04-24T22:20:31.443

如果您可以重复整个事情，或者先将其子集然后重复，那么[这个类似的问题](https://stackoverflow.com/questions/13275260/how-can-i-repeat-a-data-frame/13316594#13316594)可能会有所帮助。再来一次：

```
library(mefa)
rep(mtcars,10) 
```

或者干脆

```
mefa:::rep.data.frame(mtcars) 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-05-20T02:23:22.400

除了@dardisco 提到`mefa::rep.data.frame()`的内容之外，它非常灵活。

您可以将**每一行重复 N 次**：

```
rep(df, each=N) 
```

或**重复整个数据帧 N 次**（想想：就像你回收一个矢量化参数时一样）

```
rep(df, times=N) 
```

竖起两个大拇指`mefa`！直到现在我才听说过它，我不得不编写手动代码来做到这一点。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-07-21T18:53:13.803

`mefa::rep.data.frame()`作为参考和添加引用 mefa 的答案，如果您不想包含整个包，可能值得看一下的实现：

```
> data <- data.frame(a=letters[1:3], b=letters[4:6])
> data
  a b
1 a d
2 b e
3 c f
> as.data.frame(lapply(data, rep, 2))
  a b
1 a d
2 b e
3 c f
4 a d
5 b e
6 c f 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-05-30T18:31:28.233

rep.row 函数似乎有时会为列创建列表，这会导致内存问题。我写了以下似乎运作良好的内容：

```
library(plyr)
rep.row <- function(r, n){
  colwise(function(x) rep(x, n))(r)
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-03-01T17:15:23.940

我的解决方案类似于`mefa:::rep.data.frame`，但速度更快，并且关心行名：

```
rep.data.frame <- function(x, times) {
    rnames <- attr(x, "row.names")
    x <- lapply(x, rep.int, times = times)
    class(x) <- "data.frame"
    if (!is.numeric(rnames))
        attr(x, "row.names") <- make.unique(rep.int(rnames, times))
    else
        attr(x, "row.names") <- .set_row_names(length(rnames) * times)
    x
} 
```

比较解决方案：

```
library(Lahman)
library(microbenchmark)
microbenchmark(
    mefa:::rep.data.frame(Batting, 10),
    rep.data.frame(Batting, 10),
    Batting[rep.int(seq_len(nrow(Batting)), 10), ],
    times = 10
)
#> Unit: milliseconds
#>                                            expr       min       lq     mean   median        uq       max neval cld
#>              mefa:::rep.data.frame(Batting, 10) 127.77786 135.3480 198.0240 148.1749  278.1066  356.3210    10  a 
#>                     rep.data.frame(Batting, 10)  79.70335  82.8165 134.0974  87.2587  191.1713  307.4567    10  a 
#>  Batting[rep.int(seq_len(nrow(Batting)), 10), ] 895.73750 922.7059 981.8891 956.3463 1018.2411 1127.3927    10   b 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-06-20T14:09:15.107

尝试使用例如

```
N=2
rep(1:4, each = N) 
```

作为索引

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-06-03T12:07:56.870

另一种方法是首先获取行索引，附加 df 的额外副本，然后按索引排序：

```
df$index = 1:nrow(df)
df = rbind(df,df)
df = df[order(df$index),][,-ncol(df)] 
```

尽管其他解决方案可能更短，但这种方法在某些情况下可能更有利。

# oracle - Oracle Connect By 查询结果集随机不在层次结构中

> ID：11121390
> 
> 赞同：0
> 
> 时间：2012-06-20T14:05:08.203
> 
> 标签：oracle, connect-by

我使用 startwith 和 connectby 准备了几个查询来获取具有父子关系的表的所有项目。

到目前为止，这些查询工作得很好。但是现在，我注意到返回的层次结构不一样。尽管数据相同，但层次结构以完全随机的方式返回。

任何人都可以提出为什么会这样..

以下是示例查询：

```
SELECT id,loc.title Title FROM 
(SELECT level level,id id,parent_id Parent_Id,sort_order FROM table1 
START WITH parent_id=0 
CONNECT BY prior id  = parent_id ORDER SIBLINGS BY sort_order) 
INNER JOIN table2 loc ON id = loc.id WHERE loc.locale=? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:06:05.490

如果您不将查询包装为内联视图，则 ORDER SIBLINGS BY 将执行您想要的操作。

包装后，不再指定顺序

我建议直接在内部查询中进行 JOIN .. 然后你的 order by 应该可以工作。

# python - 将费用类别列表分类为特定类别的方法

> ID：11121395
> 
> 赞同：0
> 
> 时间：2012-06-20T14:05:23.450
> 
> 标签：python, sql

我是 SQL/Python 新手。

我想知道是否有办法将费用项目分类或分类为三个主要类别。

也就是说，我有一个 56,000 行列表，其中包含大约 100 多个不同的费用类别。它们不同于工资单、信用卡 Pmt、电话等。

为了便于分析，我想将它们分为三类。

我知道我可以在 Excel 中做一个 GIANT IF 语句，但这真的很耗时，因为有 100 多个子类别。

有什么方法可以用 Python 甚至在 Excel 中加快这个过程？

另外，我不知道这是否重要，但我正在准备将此文件上传到 SQL 数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T14:10:37.667

您应该创建一个名为 ExpenseCategories 的表，其中包含 ExpenseCategory、PrimaryCategory 列。

该表将为每个费用类别保留一行（如果您愿意，可以使用约束强制执行）。然后，您可以将此表与 SQL 中的现有数据连接起来。

顺便说一句，在 Excel 中，您可以使用 vlookup() 而不是 if() 来执行此操作。vlookup() 类似于在 SQL 中使用查找表。if() 的等价物将是一个巨大的 case 语句，这是另一种可能性。

# css - CSS 3D 变换容器来反转孩子的 3D 变换

> ID：11121401
> 
> 赞同：1
> 
> 时间：2012-06-20T14:05:49.170
> 
> 标签：css, 3d, css-transforms

在以下 HTML

```
<article>
    <div></div>
</article> 
```

the`div`绝对定位在 the 内的任意位置，`article`并使用任意 matrix3d 进行转换。

`div`如何通过变换来“反转” 的变换`article`，使`div`再次以其原始大小出现矩形？

情况如下：http: [//jsfiddle.net/kBWcc/](http://jsfiddle.net/kBWcc/)

注意：在这种情况下必须使用 matrix3d。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T17:27:41.610

经过半天的尝试，我终于找到了一个到目前为止只支持 webkit 的解决方案，其中涉及 WebKitCSSMatrix 对象。

以下是解决方案的外观：http: [//jsfiddle.net/kBWcc/2/](http://jsfiddle.net/kBWcc/2/)

```
var t = window.getComputedStyle($('div').get(0)).webkitTransform;
  , m = new WebKitCSSMatrix(t);

$('article').css('-webkit-transform', m.inverse());
$('div').css('-webkit-transform', m.translate(100, 100));​ 
```

# c# - 在 Visual Studio 2010 的添加引用中缺少 COM 选项卡

> ID：11121402
> 
> 赞同：1
> 
> 时间：2012-06-20T14:05:49.620
> 
> 标签：c#, visual-studio-2010, silverlight

我正在制作一个需要文字转语音的 Silverlight 应用程序。我找到了大量关于如何使用文本转语音应用程序的参考资料，但为了使用该库，我需要将 COM 组件添加到参考资料中。它说

“要创建它，请在 Visual Studio 中打开项目。选择项目菜单并单击添加引用。选择 COM 选项卡，在列表中选择“Microsoft Speech Object Library”，然后单击确定。”

问题是当我去添加引用时没有 COM 选项卡，我不知道如何获取它。如果有人可以提供帮助，那就太好了

# mongodb - 我应该在 mongodb 中对布尔标志使用稀疏索引吗？

> ID：11121403
> 
> 赞同：3
> 
> 时间：2012-06-20T14:05:50.957
> 
> 标签：mongodb, indexing, mongoid

我有一个布尔标志`:finished`。我是不是该

```
A: index({ finished: 1 })
B: index({ finished: 1 }, {sparse: true})
C: use flag :unfinished instead, to query by that
D: other? 
```

Ruby mongoid 语法。我的大多数记录都会有标记finished=true，显然大多数操作都会获取那些未完成的。我不确定我是否了解何时使用稀疏以及何时不使用。谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-21T05:30:12.173

稀疏的标志有点奇怪。要了解何时使用它，您必须首先了解为什么“稀疏”存在。

当您在一个字段上创建简单索引时，每个文档都有一个条目，即使是没有该字段的文档。

例如，如果您有一个索引 on `{rarely_set_field : 1}`，您将拥有一个大部分被填充的索引，`null`因为该字段在大多数情况下不存在。这是浪费空间并且搜索效率低下。

该`{sparse:true}`选项将摆脱这些值，因此您将获得一个仅在定义`null`时包含条目的索引。`{rarely_set_field}`

**回到你的情况。**

你问的是使用布尔+稀疏。但是稀疏并不真正影响“布尔”，稀疏影响“已设置与未设置”。

在您的情况下，您正在尝试获取`unfinished`. 利用`sparse`密钥不是布尔值，而是`unfinished`条目具有该密钥并且“完成”条目根本没有密钥这一事实。

```
{ _id: 1, data: {...}, unfinished: true }
{ _id: 2, data: {...} } // this entry is finished 
```

**听起来您正在使用队列**

您绝对可以利用上面的信息来实现稀疏索引。但是，实际上听起来您正在使用队列。MongoDB 可用作队列，这里有[两个](http://blog.serverdensity.com/2011/09/28/replacing-rabbitmq-with-mongodb/) [示例](http://captaincodeman.com/2011/05/28/simple-service-bus-message-queue-mongodb/)。

但是，如果您查看队列，他们并没有按照您的方式进行操作。我个人将 MongoDB 用作某些生产系统的队列，它运行得很好，但是测试您的预期负载，因为专用队列会执行得更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T08:01:02.337

稀疏仅在值为 时才有用`null`，而不是`false`。当您说“大多数都将完成=真”时，我猜大多数`finished`是非的`null`，这使得稀疏不是很有用。

而且由于大多数值都是单个值，如果您的查询足够具体，我怀疑任何类型的索引都会有所帮助。

# c# - 基类的相同方法的不同返回类型

> ID：11121404
> 
> 赞同：4
> 
> 时间：2012-06-20T14:05:52.253
> 
> 标签：c#, inheritance, overriding

一个非常简单的基类：

```
class Figure {
    public virtual void Draw() {
        Console.WriteLine("Drawing Figure");
    }
} 
```

这个继承类：

```
class Rectangle : Figure
{
    public int Draw()
    {
        Console.WriteLine("Drawing Rectangle");
        return 42;
    }
} 
```

编译器会抱怨矩形的“绘图”隐藏了图形的绘图，并要求我添加一个`new`或`override`关键字。只需添加`new`即可解决此问题：

```
class Rectangle : Figure
{
    new public int Draw() //added new
    {
        Console.WriteLine("Drawing Rectangle");
        return 42;
    }
} 
```

但是，Figure.Draw 有一个 void 返回类型，Rectangle.Draw 返回一个 int。我很惊讶这里允许不同的返回类型......为什么会这样？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-20T14:09:19.710

你真的读过[`new`修改器](http://msdn.microsoft.com/en-us/library/51y09td4%28v=vs.71%29.aspx#vclrfnew_newmodifier)吗？

> 使用 new 修饰符显式隐藏从基类继承的成员。要隐藏继承的成员，请在派生类中使用相同的名称声明它，并使用 new 修饰符对其进行修改。

因此，您已经从基类中*隐藏了版本。*这两个方法具有相同的名称这一事实并不意味着什么 - 它们与两个名称*听起来*相同的方法没有更多的相关性。

* * *

这种情况一般应该避免，但是编译器总是*知道*要调用哪个方法，从而知道它是否有返回值。如果按如下方式访问“the”方法：

```
Figure r = new Rectangle();
r.Draw(); 
```

然后将调用`Figure`s方法。`Draw`没有返回值产生，也没有预期。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-20T14:10:19.603

这里发生的是您隐藏了基本元素的方法。如此有效，`Draw`方法 in`Rectangle`是一种新方法，就好像名字是别的东西一样。

如果您在类型为 时使用此元素`Rectangle`，它将知道返回类型，但如果您尝试使用此实例装箱到基本类型中，则会使用 void 返回类型调用基本方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-20T14:16:33.953

关键字只是告诉编译器这个`new`方法没有覆盖基础方法，而只是具有相同的名称。它不会被基类的虚拟调用执行。

```
class Base 
{
    public virtual void A()
    {
        Console.WriteLine("Base::A");
    }
    public virtual void B()
    {
        Console.WriteLine("Base::B");
    }
}

class Derived : Base 
{
    public override void A()
    {
        Console.WriteLine("Derived::A");
    }
    public new int B()
    {
        Console.WriteLine("Derived::B");
    }
} 
```

所以，

```
Base obj = new Derived();
obj.A();
obj.B(); 
```

将输出

```
Derived::A
Base::B 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-20T14:09:44.753

使用“new”关键字，您只能从 Rectangle 引用中调用 int Draw。没有运行时方法解析。

```
Rectangle r = new Rectangle();
Figure f = r;
f.Draw();  // calls the void method Figure.Draw
int x = r.Draw(); // calls the int method Rectangle.Draw 
```

# loops - Powershell RDP 会话和 CLI 脚本

> ID：11121405
> 
> 赞同：0
> 
> 时间：2012-06-20T14:05:52.103
> 
> 标签：loops, powershell, cmd, rdp, mstsc

我想要做的似乎很简单，但我无法弄清楚。我正在寻找运行 Powershell 脚本来启动 RDP 会话，将文件复制到 c:\ 目录，然后从命令行运行该文件。我希望它循环，从 csv 文件中获取参数，例如服务器 IP、用户名和密码。所以本质上，步骤如下......

1.  从 csv 文件导入 infor 以定义变量
2.  复制指定的文件（然后循环）
3.  启动 mstsc.exe
4.  输入服务器IP、用户名、密码
5.  将复制的文件粘贴到 c:\ 目录
6.  启动 cmd.exe
7.  运行复制到 c:\ 目录的文件
8.  注销服务器

我想看看是否有人可以帮助我解决这个问题。我是 power shell 的新手，并且已经能够完成很多工作。如果有人能指出我正确的方向，或者甚至提供我填补空白的代码，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-08-17T17:17:08.547

我已经使用 psexec 完成了远程安装。`psexec \\servername -u domain\usernamr -p password cmd /c "msiexec /i program.msi`

PSexec 下载：[https ://docs.microsoft.com/en-us/sysinternals/downloads/psexec](https://docs.microsoft.com/en-us/sysinternals/downloads/psexec)

这意味着您将使用 psexec 而不是 RDP 来远程运行安装。

我创建了一个小的 PowerShell 脚本来帮助您入门。因此，假设您的 CSV 文件 (c:\info.csv) 包含三列 ServerName、UserName、Password。

运行以下代码，它应该可以工作，但请确保根据您的环境更改前 4 行。首先放置一台服务器来观察脚本行为。

```
# Set intial variables
$CSVFile = "c:\info.csv"
$MSI = "\\servername\sharename\setup.msi"
$MSILog = "c:\Windows\temp\setup.log"
$Domain = "YourDomain"

# Import info from CSV file
$Servers = import-csv $CSVFile

# loop through each server
foreach ($server in $servers) {
         # run psexec on each server to install a program
         psexec \\$server.servername -u $Domain\$server.username -p $server.password -h cmd /c "msiexec /i $MSI /quite /l*v $MSILog"

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T14:20:47.197

我建议你使用这个命令，因为我不完全是你想要做的。

Get-help Import-CSV
Get-help about_remoting 这将避免为您做 mstsc.exe 的事情。

进入会话并针对该会话调用 Invoke-Command，您可以在该服务器上运行命令。$session = New-PSSession -ComputerName Server1 -Credentials Get-Credential
Invoke-Command -Session $session -ScriptBlock {

}

在 Script 块内指定您的 powershell 命令来复制文件并运行它们。

# c# - 如何在 ListView 中插入超链接

> ID：11121419
> 
> 赞同：1
> 
> 时间：2012-06-20T14:06:18.333
> 
> 标签：c#, asp.net, listview

我正在尝试在 C# 中创建 Link Web / 链接信息目录，用户可以在其中保存他的链接。

以下是我的代码：

```
private void Form1_Load(object sender, EventArgs e)
{
    Int i=0;
    listView1.View = View.Details;
    listView1.GridLines = true;
    listView1.Columns.Add("Links",250,HorizontalAlignment.Center );
    listView1.Columns.Add("Name", 250, HorizontalAlignment.Center);
}

private void button1_Click(object sender, EventArgs e)
{
    listView1.Items.Add(textbox1.text);
    listview1.Items[i].subitems.add("textbox2.text")
} 
```

`textbox2`包含超链接，但是当我插入它时，它显示为文本，而不是超链接。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T14:33:25.557

使用[ObjectListView——](http://www.codeproject.com/Articles/16009/A-Much-Easier-to-Use-ListView)一个围绕标准 ListView 的开源包装器。它直接支持链接：

还可以查看支持 LinkLabel 的 DataGridView 控件。

使用此控件，您可以在 ListView 中获得详细信息视图的所有功能，但每行具有更多自定义。

您也可以将一个属性设置为 true --> listView1.HotTracking = true; 您的代码将如下所示：

```
private void button1_Click(object sender, EventArgs e)
    {
        listView1.Items.Add(textbox1.Text);
        listView1.HotTracking = true;

        listView1.Items[i].SubItems.Add("hyperlynk2.text");
    } 
```

# powershell - 测试用户是否本地存在总是返回 false

> ID：11121421
> 
> 赞同：0
> 
> 时间：2012-06-20T14:06:21.540
> 
> 标签：powershell

我正在尝试编写一个自定义 powershell 脚本，如果不存在具有指定名称的用户，它将创建一个本地用户。

我有这个脚本：

```
function Ensure-LocalUser
{
    [CmdletBinding()]
    param(
        [Parameter(Mandatory=$true)]
        [string] $userName,
        [Parameter(Mandatory=$true)]
        [string] $passWord
    )
    process{

        $objOu = [ADSI]"WinNT://${env:Computername}"
        $localUsers = $objOu.Children | where {$_.SchemaClassName -eq 'user'}  | Select {$_.name[0].ToString()} 

        if($localUsers -NotContains $userName)
        {
            $objUser = $objOU.Create("User", $userName)
            $objUser.setpassword($password)
            $objUser.SetInfo()
            $objUser.description = "CMM Test user"
            $objUser.SetInfo()

            return $true
        }
        else
        {
            return $false
        }

    }
} 
```

与创建用户相关的部分有效，但我的`-NotContains`验证总是返回false。这会导致创建用户的尝试失败，因为该用户已经存在。使用调试器，我可以看到 $localusers 实际上包含我要查找的用户名。

如何更正我的脚本以达到我的目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T14:22:01.957

更改此行

```
localUsers = $objOu.Children | where {$_.SchemaClassName -eq 'user'}  | Select {$_.name[0].ToString()} 
```

和

```
$localUsers = $objOu.Children | where {$_.SchemaClassName -eq 'user'}  | % {$_.name[0].ToString()} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-20T14:22:38.663

你做错了；）你真的想要这个（这将创建一个字符串数组）：

```
$ou.Children | where {$_.SchemaClassName -eq 'user'}  | foreach {
      $_.name[0].tostring() } 
```

您的代码正在创建一个具有名为“$_.name[0].ToString()”的属性的自定义对象

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-05-01T11:20:31.660

在 PowerShell 5.1（在 Windows 10 中可用）及更高版本中，我们可以使用两个 cmdlet 来检查本地用户的存在和创建新的本地用户：`Get-LocalUser`和`New-LocalUser`. 所以我们可以用更紧凑的方式重写上面的函数：

```
function Ensure-LocalUser
{
    [CmdletBinding()]
    param(
        [Parameter(Mandatory=$true)]
        [string] $userName,
        [Parameter(Mandatory=$true)]
        [string] $passWord
    )
    process{
        $out = Get-LocalUser -Name $userName -ErrorAction SilentlyContinue
        if($out -eq $null)
        {
            $passEnc = ConvertTo-SecureString -String $passWord -AsPlainText -Force
            New-LocalUser -Name $userName -Password $passEnc -AccountNeverExpires -PasswordNeverExpires
            return $true
        }
        else
        {
            write-host ("User '"+ $userName + "' already exists")
            return $false
        }
    }
} 
```

然后像这样调用函数：

`Ensure-LocalUser "john" "p@ssw0rd"`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-28T11:43:19.923

我知道我迟到了，但这里有一个简单的方法可以找到本地用户并输出他们的当前状态。

```
# Find User Account to change
$usercheck = Get-WmiObject Win32_UserAccount -Filter "LocalAccount='true' and Name='Administrator'"

if($usercheck.disabled -eq $false){write-host "Account has been found"}
elseif($usercheck.disabled -eq $true){write-host "Account has been found, but disabled"}
else{write-host "Account has not been found."} 
```

# windows - 需要运行一个 .exe，然后在大约 10 秒后将其杀死并移至批处理文件中的下一个命令

> ID：11121424
> 
> 赞同：6
> 
> 时间：2012-06-20T14:06:33.850
> 
> 标签：windows, batch-file, cmd

我正在尝试创建一个运行 .exe 的批处理文件，但在大约 10 秒后（在它完成之前）杀死所说的 .exe，然后继续执行文件中的下一个命令。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-20T15:39:43.257

你可以使用这个：

```
start program.exe
ping 127.0.0.1 -n 10
taskkill /im program.exe /f
rem continue here
echo Another command! 
```

# javascript - 在 iFrame 和/或弹出窗口之间替代 ie6/7 的 postMessage()

> ID：11121435
> 
> 赞同：1
> 
> 时间：2012-06-20T14:07:43.620
> 
> 标签：javascript, internet-explorer, internet-explorer-6, postmessage

我正在尝试为加载 iFrame 或弹出窗口的 Web 应用程序创建登录按钮。类似于 Facebook 的登录按钮。我目前正在使用 postMessage() 方法，这是一种享受。

但是我知道它在我需要支持的 IE6/IE7 中不起作用。我可以使用他们的任何替代品吗？还是我希望从 IE6 的“很棒的浏览器”中得到很多？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T22:08:05.570

过去，我曾经编写基于 IE6 的网站，这些网站打开弹出窗口并在弹出窗口和原始窗口之间进行通信。

所以可以做到。

浏览器提供了一些您可以使用的对象——`window.caller`除了调用返回的对象之外，您最可能希望将调用从打开的窗口传递回原始窗口`window.open()`，您可以使用这些对象将呼叫从原始窗口传回新窗口。

这两者一起将允许您在两个方向进行通信。

您可能还会对 jQuery 感到满意，因为我相信有几个插件可以将这些方法包装在更友好的界面中。

但是，请注意，在这些旧版浏览器中，您可以做的事情比现在可以做的要有限得多，所以即使您能够跨窗口通信，您可能会发现有些事情是您需要做的却不能在较旧的浏览器中完成。

希望有帮助。

# ruby - ActiveRecord 关联集合对象的查询

> ID：11121439
> 
> 赞同：0
> 
> 时间：2012-06-20T14:08:02.167
> 
> 标签：ruby, ruby-on-rails-3

我有一组从表中获取的行。让我们说对象评级。获取这个对象后，我说数据库中有 100 个条目。

Rating 对象可能如下所示：

```
table_ratings
t.integer :num 
```

所以我现在要做的是对这 100 行执行一些计算，而不执行任何其他查询。我可以这样做，运行一个额外的查询：

```
r = Rating.all
good = r.where('num = 2') # this runs an additional query
"#{good}/#{r.length}" 
```

这是我想要做的一个非常粗略的想法，我还有其他更复杂的输出要构建。假设我需要对这些行执行超过 10 种不同的计算，因此在 sql 查询中对它们进行别名可能不是最好的主意。

替换上面的 r.where 查询的有效方法是什么？是否有 Ruby 方法或 gem 可以将类似的查询 api 提供给 ActiveRecord 关联集合对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:20:57.010

Rating.all 返回一个包含所有 Rating 对象的数组。从那里开始，将您的注意力转移到从阵列中选择和映射上。例如。：

```
@perfect_ratings = r.select{|x| x.a == 100} 
```

看：

> [http://www.ruby-doc.org/core-1.9.3/Array.html](http://www.ruby-doc.org/core-1.9.3/Array.html)

补充评论：

查看可用于数组的方法列表，我发现自己经常使用以下方法：

对照多个值检查一个变量：

```
%w[dog cat llama].include? @pet_type  # returns true if @pet_type == 'cat' 
```

创建另一个数组（map 和 collect 是别名）：

```
%w[dog cat llama].map(|pet| pet.capitalize)  #  ["Dog", "Cat", "Llama"] 
```

排序和删除重复项：

```
%w[dog cat llama dog].sort.uniq  # ["cat", "dog", "llama"] 
```

`<<`添加元素，`+`添加数组，`flatten`将嵌入式数组展平为单级数组，`count`或者元素数量，以及`length`其他我经常使用的东西。`size``join`

最后，这是一个例子`join`：

```
%w[dog cat llama].join(' or ')  # "dog or cat or llama" 
```

# c++ - Linux/c++ 计时方法每 N 秒执行一次，尽管有漂移？

> ID：11121440
> 
> 赞同：3
> 
> 时间：2012-06-20T14:08:04.077
> 
> 标签：c++, linux, time, drift

我有一个程序需要每 X 秒执行一次以写入一些输出。该程序将在每个输出之间进行一些间歇性轮询和处理。因此，例如，我可能每 5 秒输出一次，但我每 0.1 秒醒来一次轮询一次，直到达到下一个 5 秒标记。理论上，该程序将在重新启动之间运行数月，甚至可能更长。

我需要每 X 秒执行一次，以保持与挂钟一致。换句话说，我不能让时钟漂移导致我偏离 X 秒标记。在间歇轮询中，我不需要完全相同级别的准确度，但我想更频繁地轮询一秒钟，所以我需要一个可以表示亚秒级精度的结构。

我意识到，由于在操作系统上运行的本质，任何计时器的执行都会存在一定的不一致/延迟，因此我无法保证我将在每x 秒内执行一次*。*但这很好，只要它保持一个小的正态分布，我不想要的是漂移让时间不断地越来越远。

我还希望尽量减少轮询的 CPU 成本，但这是次要问题。

有哪些可用于 Linux 的时序结构可以最好地为我提供这种级别的精确度？由于分发的麻烦，我试图避免在应用程序中包含提升，但如果必须的话可以使用它。所以首选使用标准 c++ 库的方法，但如果 Bosst 可以做得更好，我也想知道这一点。

谢谢你。

-ps，我不能使用 c++11。这不是一个选项，所以我无法使用它的任何构造。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T14:41:32.947

[clock_gettime](http://pubs.opengroup.org/onlinepubs/009604599/functions/clock_gettime.html)和[clock_nanosleep](http://pubs.opengroup.org/onlinepubs/009604599/functions/clock_nanosleep.html)都在亚秒级时间运行，使用`CLOCK_MONOTONIC`应该防止由于调整系统时间（例如 NTP 或[adjtimex](http://www.kernel.org/doc/man-pages/online/pages/man2/adjtimex.2.html)）而导致的任何偏差。例如，

```
long delay_ns = 250000000;
struct timespec next;
clock_gettime(CLOCK_MONOTONIC, &next);
while (1) {
    next.ts_nsec += delay_ns;
    next.ts_sec += ts_nsec / 1000000000;
    next.ts_nsec %= 1000000000;
    clock_nanosleep(CLOCK_MONOTONIC, TIMER_ABSTIME, &next, NULL);
    /* do something after the wait */
} 
```

实际上，您应该检查您是否由于信号而提前返回，以及您是否应该跳过一个间隔，因为您在睡觉时经过了太多时间。

其他睡眠方法，例如[nanosleep](http://pubs.opengroup.org/onlinepubs/009604599/functions/nanosleep.html)和[select](http://pubs.opengroup.org/onlinepubs/009604599/functions/select.html)，仅允许指定时间间隔和 use `CLOCK_REALTIME`，这是系统时间并且可能会更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T10:33:24.520

如果您需要一些没有抖动或时钟漂移的精确计时，请确保有一个外部时间源，如 GPS、原子钟或无线电时钟。例如，参见此[PDF](https://archive.fosdem.org/2012/schedule/event/697/129_ntp-fosdem.pdf)中记录的 NTP 集成。所有 NTP 技巧在 Linux 和 NanoBSD（在 PDF 中）上都能正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T14:18:28.633

我会记录`t_0`我开始的时间，然后在任何给定时间`t`，如果`i = (t - t_0)/X`（整数除法）大于上次执行的相同数量，则再次执行。

例如，假设您每 5 秒跑步一次，如果您从 23 点开始，则记录`i = 0, t_0 = 23`. 然后在时间 27, `(27 - 23)/5 = 0`，所以你还没有执行。但是下一次遇到`(28 - 23)/5 = 1`大于 0 的时间 28，所以你执行。

这样，您就不会在每个可能产生巨大漂移的滴答声中添加到计数器，您绝对计算自开始以来的时间，因此您知道执行的确切时间。

# python - 无法在主文件中访问依赖于其他模块的用户模块？

> ID：11121442
> 
> 赞同：0
> 
> 时间：2012-06-20T14:08:14.767
> 
> 标签：python, import

我有一个 index.py 文件，它导入了一些模块。后来我导入了我自己的模块，它需要一些早期的导入。如何导入我只需要一次的模块，并使它们可用于我构建的所有后续用户模块，而不在我的不同用户模块中导入所有相同的东西？

索引.py

```
import os
import random
import myusermodule
import myotherusermodule

... 
```

我的用户模块.py

```
print random.randrange(0,1) 
```

myotherusermodule.py

```
print random.randrange(0.5) 
```

如何避免在我的 2 个用户模块中导入 random ，而只需将其放在 index.py 文件中？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:15:10.110

你根本不需要担心这个。Python 在 sys.modules 中缓存模块加载，因此在每个自定义模块的顶部导入所需的内容并没有什么坏处，事实上，这是推荐的 Python 方式。

更多信息：[http](http://docs.python.org/tutorial/modules.html) ://docs.python.org/tutorial/modules.html - 特别是第 6.1 节，但值得一读。

# imageresizer - 如果宽度和高度与原始图像相同，如何避免图像大小调整？

> ID：11121444
> 
> 赞同：0
> 
> 时间：2012-06-20T14:08:15.763
> 
> 标签：imageresizer

如果高度和宽度与原始图像相同，是否有办法（参数）避免 Imageresizing 处理图像？

如果没有，我在哪里以及如何取消插件中的缩放过程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T14:53:14.263

**ImageResizer 不会*缩放*已经是适当大小的图像**。但是，它确实会解码它们，剥离元数据，并将它们重新编码为与 Web 兼容且对 Web 有效的格式（通常为 jpg 或 png）。

如果您希望 ImageResizer 提供原始文件，跳过整个过程，这是一个不同的问题，我将在下面尝试回答。

这是实现该目标的主要挑战：要发现源图像文件的宽度和高度，您必须对其进行解码 - 至少部分解码。

这种优化仅在有限的情况下有用（或可能）

1.  源文件的格式允许您解析宽度和高度，而无需将整个文件加载到内存中。JPG/PNG 是，TIFF - 不，FreeImageDecoder 支持 30 多种格式，不。
2.  源文件位于本地、低延迟磁盘存储上，并且可通过 IIS 访问 - 消除了 UNC 路径和插件 S3Reader、SqlReader、AzureReader、RemoteReader、MongoReader 等。
3.  没有 URL 重写规则。
4.  没有使用自定义插件。
5.  该图像已采用经过适当压缩设置的 Web 优化格式，并删除了元数据。
6.  没有使用其他 URL 命令
7.  没有水印规则。
8.  您不需要控制缓存标头。
9.  您 100% 确定该图像不是恶意的（如果不重新编码，您无法确保该文件不能既是脚本又是位图）。

**此外，除非您缓存结果，否则这种“优化”实际上不会改善响应时间或服务器端性能。由于维度数据需要单独解码，因此无论它们是否恰好有维度匹配，都会给所有请求增加统一的、显着的开销。**

我认为这很有用的唯一情况是，如果您花费大量时间在 Photoshop 中优化压缩，并且除非需要，否则不希望 ImageResizer 触摸它。如果您担心，请不要在该场景中应用 URL。或者，设置`process=no`为保持原始字节不变。

绝对可以制作一个插件来做到这一点；但这不是很多人想要使用的东西，而且我无法想象一个可以带来净收益的使用场景。

如果您想继续前进，只需处理`Config.Current.Pipeline.PreHandleImage`事件并替换`e.ResizeImageToStream`为解析返回的流的代码`e.GetSourceImage()`，应用您的维度逻辑（与 相比`Config.Current.GetImageBuilder().GetFinalSize()`，然后重置流并在需要时逐字复制它，如下所示：

```
 using (Stream source = e.GetSourceImage())
     StreamExtensions.CopyToStream(source,stream); //4KiB buffer 
```

这可能无法处理某些情况，例如图像实际上需要将大小调整为小 1px，但您正在添加 1 px 边框等，但它已经接近了。如果您很挑剔，请查看 GetFinalSize 的源代码并返回图像边界而不是画布边界。

# django - django 中的基本关系（建立在遗留数据库之上）

> ID：11121445
> 
> 赞同：1
> 
> 时间：2012-06-20T14:08:20.050
> 
> 标签：django, django-models, django-orm

我一直在谷歌上搜索，但我似乎没有得到它。

如何在 django 中重新创建简单的连接查询？

在 models.py 中（Fylker 是县，Dagensrepresentant 是人）

```
class Fylker(models.Model):
    id = models.CharField(max_length=6, primary_key=True)
    navn = models.CharField(max_length=300)
    def __unicode__(self):
        return self.navn
    class Meta:
        db_table = u'fylker'

class Dagensrepresentanter(models.Model):
    id = models.CharField(max_length=33, primary_key=True)
    etternavn = models.CharField(max_length=300, blank=True)
    fornavn = models.CharField(max_length=300, blank=True)
    fylke = models.ForeignKey(Fylker, db_column='id')
    def __unicode__(self):
        return u'%s %s' % (self.fornavn, self.etternavn)
    class Meta:
        ordering = ['etternavn']  # sette default ordering
        db_table = u'dagensrepresentanter' 
```

由于模型是由 django 自动创建的，因此我添加了 ForeignKey 并尝试将其连接到县。id 字段是从我试图集成到这个 django 项目中的 db 继承的。

通过查询

```
Dagensrepresentanter.objects.all() 
```

我得到所有的人，但没有他们的县。通过查询

```
Dagensrepresentanter.objects.all().select_related() 
```

我加入了 Dagensrepresentanter.id 和 Fylker.id，但我希望他们加入到 fylke，又名

```
SELECT * FROM dagensrepresentanter d , fylker f WHERE d.fylke = f.id 
```

这样我就可以在与所有人相同的结果集中获得县名（Fylke navn）。

附加请求：我已经阅读了 django 文档和 stackoverflow 上的很多问题，但我似乎无法理解这个 ORM 问题。这是伤害的查询。对于习惯于将数据库视为 SQL 事物、需要开始以 django ORM 术语思考的人，您是否有任何好的资源（具有经验/解释的博文等）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-02T21:21:18.410

您的旧数据库可能没有外键约束（例如，如果它使用 MyISAM，则甚至不支持外键）。

你有两个选择：

1.  将外键约束添加到您的表中（如果您在 MyISAM 上，将涉及升级到 Innodb）。然后再次运行 ./manage inspectdb 并且应该出现关系。
2.  按原样使用表（即，它们之间没有明确的关系）并在对象级别或通过编写您自己的 SQL 查询手动组合查询（例如，Mytable.objects.get(other_table_id=23)）。无论哪种方式，您都会失去 python 的 ORM 查询语言的大部分好处。

# tfs - 如何将编辑项添加到 TFS 工作项中的预定义列表

> ID：11121452
> 
> 赞同：4
> 
> 时间：2012-06-20T14:08:41.903
> 
> 标签：tfs

我正在尝试按照[这篇](http://social.msdn.microsoft.com/Forums/en-US/tfssetup/thread/882b6c7a-a7ec-4401-99fc-61d04029e084#5b8c1b44-3121-4c47-a994-3dd3e1395472)文章为特定项目的 Bug 工作项添加新状态做同样的事情。默认情况下我只能看到![这个](../Images/092fa68ade48c81a0c51c1a2ee172d71.png). 我想添加一个新状态“等待”

但我可能错误地遵循它并最终得到![这个](../Images/8dd237d99498608b4eed90bd9e534411.png)

错误显示“打开转换活动~暂停以添加至少一个原因”。如何打开该转换以及在哪里添加一个原因。它在谈论的原因是什么？我只想添加一个新状态。

谢谢你的时间...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T14:16:49.143

双击`Active~On Hold`转换，选择`Reasons`选项卡并输入至少一个原因。

![原因](../Images/a4bfa4b6d2f08c6c4ab268f404fd40fb.png)

保存 .wit 文件后，您必须`Refresh`从团队资源管理器菜单中单击才能查看更改。 ![团队资源管理器刷新 TFS](../Images/d5a49d31cf838c0b07f8f4ffc61f1865.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T06:20:54.637

在工作项编辑器中，双击 Active 和 On hold 状态之间的转换。在“转换详细信息”下，您应该看到“发件人：活动”和“收件人：暂停”。将“发件人：活动”更改为空白，因此应显示“发件人：”。现在保存编辑器，从团队资源管理器菜单中单击“刷新”，您创建的任何新错误都将具有“暂停”作为状态选项。

# javascript - 在文本区域中输出图像

> ID：11121453
> 
> 赞同：0
> 
> 时间：2012-06-20T14:08:41.900
> 
> 标签：javascript, jquery, html, css

我有一个图像和一个文本区域。

我想使用 Jquery 在文本区域中输出图像。但是，当我尝试时，它只输出 html 而不是图像，如何将图像输出到文本区域：

```
var output = '';
output += '<img src="http://aux.iconpedia.net/uploads/286412642.png" />';
$('#textarea').html(output);​ 
```

我已经设置了一个 jsfiddle 来演示场景并说明我尝试过的内容。

[http://jsfiddle.net/DpeU7/](http://jsfiddle.net/DpeU7/)

我知道它被称为 *text*area 是有原因的，但我正在寻找一种方法来做到这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-20T14:15:58.413

您可以使用`div`with`contentEditable="true"`代替`textarea`.

看[**这里**](http://jsfiddle.net/bpNFV/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-20T14:11:26.657

您不能将图像输出到文本区域。如果你想这样做，你需要使用像[CKEditor这样的东西](http://ckeditor.com/)

# c++ - c++ 为什么我的日期解析不是线程安全的？

> ID：11121454
> 
> 赞同：26
> 
> 时间：2012-06-20T14:08:42.543
> 
> 标签：c++, boost, thread-safety, gcc4, date-parsing

```
boost::posix_time::ptime parseDate(const std::string& format, const std::string& localDate)
{
    std::istringstream is(localDate);
    is.imbue(std::locale(is.getloc(), new boost::local_time::local_time_input_facet(format.c_str())));
    boost::posix_time::ptime pt;
    is >> pt;

    if (pt == boost::posix_time::ptime())
    {
        throw std::runtime_error("Parse error");
    }

    return pt;
} 
```

此函数应采用日期和格式字符串以及`return boost::posix_time::ptime`.

例如：`2012:06:14 02:50:58`和`%Y:%m:%d %H:%M:%S`。

但是，如果我在多线程程序中调用它，有时会抛出异常，尽管`format`它`localDate`是正确且可解析的（我对每个调用都使用相同的日期）。我发现了一些关于`std::stringstream`/`std::locale`线程问题的信息，但没有最新的（我使用的是 gcc 4.6.3 64bit）。

[这里](http://www.cplusplus.com/forum/unices/29301/#msg160008)有人有同样的问题：

> 在过去几天使用 Valgrind/drd 进行测试时，我发现我的代码中有很多部分会导致问题。例如，在调用一些 boost 日期时间转换函数时，我点击了 std::locale()，它不是线程安全的。

更新的代码没有问题：

```
boost::posix_time::ptime parseDate(const std::string& format, const std::string& localDate)
{
    std::istringstream is(localDate);
    auto* facet = new boost::local_time::local_time_input_facet(format.c_str());

    {
        boost::unique_lock<boost::mutex> lock(globalLocaleMutex);
        is.imbue(std::locale(is.getloc(), facet));
    }

    boost::posix_time::ptime pt;
    is >> pt;

    if (pt == boost::posix_time::ptime())
    {
        throw std::runtime_error("Parse error");
    }

    return pt;
} 
```

但还是：为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:05:32.093

我看到有人打电话给 local_time。我不确定底层代码是调用 localtime 还是 localtime_r。如果它调用本地时间，那么它不是线程安全的。我相信 localtime 在返回结果时使用静态变量。

# magento - 在 Magento 中发送 System > Configuration 表单后操作发布数据

> ID：11121455
> 
> 赞同：1
> 
> 时间：2012-06-20T14:08:43.100
> 
> 标签：magento

在 Magento 中，我在 Backend System > Configuration 部分有一个带有表单的选项卡，其中包含 2 个输入字段。我想在保存之前操作这两个字段的数据。那可能吗？如果是这样，那么最干净的方法是什么。

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T23:06:35.687

这些类型的工作是“后端模型”的目的。如果一个字段配置了 backend_model，则该后端模型的`_beforeSave()`方法将在值输入数据库之前被调用。

查看`Mage/Paygate/etc/system.xml`和搜索`<backend_model>` 查看`Mage_Adminhtml_Model_System_Config_Backend_Encrypted::_beforeSave()`

# ruby-on-rails-3.1 - 将数据传递给模态

> ID：11121457
> 
> 赞同：1
> 
> 时间：2012-06-20T14:08:53.460
> 
> 标签：ruby-on-rails-3.1, coffeescript

谷歌查了半天也没找到解决办法：

像这样的链接：

```
<%= link_to instruction.name, "#myModal", :data => {:toggle => "modal",\
:id => instruction.id}, :class=> "openModal"%> 
```

应该打开一个模式窗口并显示完整的指令数据。使用咖啡脚本的最佳解决方案是什么？

我可以设法在跨度标签中显示 id。但是如何在 a 中获取 id`Function.find(:id)`呢？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-24T22:13:09.733

好的，没有人回答...发现自己：

风景：

```
<%= link_to instruction.name, "#myModal", :data => {:toggle => "modal", :href => instruction_path(instruction)},  :class=> "openModal"%> 
```

咖啡：

```
$(document).on "click", ".openModal", ->
$(".modal-body").load($(this).data('href')) 
```

与 Twitter 引导程序一起使用

# iphone - 如何将 NSTimeInterval 转换为 int？

> ID：11121459
> 
> 赞同：38
> 
> 时间：2012-06-20T14:09:00.147
> 
> 标签：iphone, ios, integer, nstimeinterval

如何将 NSTimeInterval 转换为整数值？

我的 TimeInterval 持有价值`83.01837`。我需要将其转换为`83`. 我用谷歌搜索但找不到任何帮助。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2012-06-20T14:12:55.137

直接赋值：

```
NSTimeInterval interval = 1002343.5432542;
NSInteger time = interval;
//time is now equal to 1002343 
```

NSTimeInterval 是一个双精度，所以如果你直接将它分配给一个 NSInteger （或 int，如果你愿意的话）它会起作用。这会将时间截断到最接近的秒数。

如果您希望四舍五入到最接近的秒数（而不是将其截断），您可以在分配之前使用 round ：

```
NSTimeInterval interval = 1002343.5432542;
NSInteger time = round(interval);
//time is now equal to 1002344 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-20T14:13:56.093

根据[文档](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_DataTypes/Reference/reference.html#//apple_ref/doc/uid/20000018-SW69)，`NSTimeInterval`只是一个`double`：

```
typedef double NSTimeInterval; 
```

您可以将其转换为`int`：

```
seconds = (int) myTimeInterval; 
```

不过要注意溢出！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-09-28T04:43:44.477

在 Swift 3.0 中

```
let timestamp = round(NSDate().timeIntervalSince1970) 
```

[![在此处输入图像描述](../Images/c91dbef863c3745f9659c286d4bf4215.png)](https://i.stack.imgur.com/hsrlp.png)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-06-26T00:55:45.643

我怀疑来自 NSDate 的 NSTimeInterval 值会溢出 NSInteger。你可能想要很长很长。（64 位整数。）那些可以存储大整数值（-2^63 到 2^63 -1）

```
long long integerSeconds = round([NSDate timeIntervalSinceReferenceDate]); 
```

## 编辑：

它看起来像一个 NSInteger 可以存储一个**NSTimeInterval**，至少在接下来的几十年里。当前日期的 timeIntervalSinceReferenceDate 大约是 519,600,000，或大约 2^28。在 32 位设备上，NSInteger 可以保存从 -2^31 到 2^31-1 的值。(2^31 是 2,147,483,648

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-05-27T14:07:30.203

**斯威夫特 4，斯威夫特 5**

我只是投到`Int64`：

```
Int64(Date().timeIntervalSince1970) 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2015-08-18T14:35:16.297

我需要将 NSDate 存储在 Swift Number 中。我使用了以下效果很好的演员表。

```
Double(startDateTime.timeIntervalSince1970) 
```

# delphi - 在 Delphi XE2 应用程序中双击 TStaticText 将标题复制到剪贴板

> ID：11121460
> 
> 赞同：5
> 
> 时间：2012-06-20T14:09:03.443
> 
> 标签：delphi, delphi-xe2

双击窗体上的 TStaticText 会将该 TStaticText 的标题复制到剪贴板。不需要双击事件。

重现步骤：

*   使用 Win 64 和 Delphi XE2 更新 4。
*   创建一个 VCL 表单应用程序。
*   在窗体上放置一个 TEdit。
*   在窗体上放置一个 TStaticText。将标题更改为“TStaticText1Caption”
*   在窗体上放置第二个 TStaticText。将标题更改为“TStaticText2Caption”
*   运行程序(F9)
*   在 TEdit 中键入一些文本。全部选中并通过 CTRL+C 复制。
*   删除 TEdit 中的文本。将其粘贴以验证文本是您复制的内容。
*   删除 TEdit 中的文本。
*   双击任一 TStaticText。
*   将文本粘贴到 TEdit 中。请注意，它不是原始复制文本，而是 TStaticText 的标题。

我已经向 Embarcadero 提交了错误报告。

我尝试将双击事件分配给 TStaticTexts。即使它执行双击事件，它仍会将标题复制到剪贴板。

```
procedure TForm1.StaticText1DblClick(Sender: TObject);
begin
  Edit1.Text := 'Hello';
end;

procedure TForm1.StaticText2DblClick(Sender: TObject);
begin
  Edit1.Text := 'World';
end; 
```

TLabel 或我尝试过的任何其他 VCL 控件都不会发生这种情况。

我们的表单上有很多 TStaticTexts 用于视觉设计目的，并且不能选择更改为 TLabels。

有人对如何防止这种情况发生有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-20T18:18:12.503

这不是 delphi 错误，此行为是[`Windows Static Control`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb760767.aspx)由 TStaticText VCL 组件创建的。

**从 Windows Vista 开始，如果您设置了SS_NOTIFY**样式（**SS_NOTIFY**样式由 TCustomStaticText 组件的 CreateParams 方法设置），则静态文本控件在您双击它们时会自动将其内容复制到剪贴板

推荐讲座[如何制作，以便用户可以轻松地将对话框上的静态文本复制到剪贴板？](http://blogs.msdn.com/b/oldnewthing/archive/2012/03/01/10275051.aspx)

作为解决方法，您可以像这样删除覆盖 CreateParams 方法的**SS_NOTIFY**样式

```
type
  TStaticText = class(Vcl.StdCtrls.TStaticText)
  protected
    procedure CreateParams(var Params: TCreateParams); override;
  end;

  TForm1 = class(TForm)
    StaticText1: TStaticText;
  private
  public
  end;

var
  Form1: TForm42;

implementation

{$R *.dfm}

{ TStaticText }

procedure TStaticText.CreateParams(var Params: TCreateParams);
begin
  inherited;
  with Params do
    Style := Style and not SS_NOTIFY;
end; 
```

注意：您必须注意，如果您从控件中删除此样式，当用户单击或双击控件时，您将不会收到 STN_CLICKED、STN_DBLCLK、STN_DISABLE 和 STN_ENABLE 通知代码。

# mysql - 选择并加入动态表名

> ID：11121464
> 
> 赞同：1
> 
> 时间：2012-06-20T14:09:11.950
> 
> 标签：mysql, select, join

我想获取有关每个`item`. Items 具有全局变量（此处`on_stock`），但每个项目在不同的表中也有自己的属性，并且该表与项目类型名称具有相同的名称。

1.  选择项目
2.  在类型表 id 上加入其 type_id ->`name`
3.  加入`name`.id上的选定项目

这是示例：

```
[items]
 id  | on_stock |  type_id
-----+----------+-----------
  1       1        1(=car)
  2       0        1(=car)
  3       1        2(=ship)
  4       0        2(=ship)

[types]
 id |  name
----+--------
  1     car
  2    ship

[car]
 id | top_speed
----+-----------
 1       200
 2       300

[ship]
 id  | color
-----+-------
 3     red
 4     blue 
```

预期结果：

```
1 on_stock=1 top_speed=200
2 on_stock=0 top_speed=300
3 on_stock=1 color=red
4 on_stock=0 color=blue 
```

请帮助实现这一目标！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T14:09:50.667

它不漂亮，但数据结构也不漂亮。这是一个查询来做你想做的事

```
SELECT I.id, I.On_stock, C.top_speed,S.Color
FROM ITEMS I
LEFT JOIN Car C ON (I.ID = C.CarID)
LEFT JOIN Ship S ON (I.ID = S.ShipID) 
```

每次添加新项目类型时都必须调整查询，但这只是此数据结构的缺点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T10:57:07.807

如果我不能在一个请求中完成，我会在更多（1+项目类型计数）中完成。

首先，我需要所需的类型为数组（id=>name）：

```
$req_types = array();
    $rs = mysql_query("
        SELECT items.type_id,types.name
        FROM items 
        JOIN types ON items.type_id=type.id 
        GROUP BY items.type_id
        ");
    while($type= mysql_fetch_assoc($rs))
        $req_types[$type['id']] = $type['name']; 
```

然后我需要公共和个人项目数据：

```
$groups = array();     
foreach($req_types as $table)
        {
            $rs = mysql_query("
                    SELECT items.*,$table.*
                    FROM items 
                    JOIN $table ON $table.id=items.id
                    ");
            while($item = mysql_fetch_assoc($rs))
                $groups[$table][] = $item;
        } 
```

# javascript - 在 D3 强制布局链接标记上缩放箭头

> ID：11121465
> 
> 赞同：10
> 
> 时间：2012-06-20T14:09:13.343
> 
> 标签：javascript, svg, d3.js, force-layout, markers

我在 d3 力有向图中有以下代码，我试图根据一个值（从 1 到 3）改变链接的大小及其关联的箭头。笔画粗细会随值而变化，但箭头不会保持在正确的位置。当笔画粗细从 1 变为 3 时，它往往会从末尾移回。关于在更改笔画值时如何保持箭头（标记）正确对齐的任何想法？非常感谢！

```
 var link = vis.selectAll("line.link")
      .data(json.links)
    .enter().append("svg:line")
      .attr("class", "link")
      .style("stroke-width", function(d) { return Math.sqrt(d.value); })
      .attr("x1", function(d) { return d.source.x; })
      .attr("y1", function(d) { return d.source.y; })
      .attr("x2", function(d) { return d.target.x; })
      .attr("y2", function(d) { return d.target.y; })
      .attr("marker-end", "url(#arrowGray)")
      .on("click", function(d) {
            link.style("stroke","#dddddd");
            node.style("stroke","#FFFFFF");
            d3.select(this).style("stroke","red");
            link.attr("marker-end", null);
            link.attr("marker-end", "url(#arrowGray)");
            d3.select(this).attr("marker-end", null);
            d3.select(this).attr("marker-end", "url(#arrowRed)");
            clickLink(d);
            });

    defs.append("svg:marker")
            .attr("id", "arrowGray")
            .attr("viewBox","0 0 10 10")
            .attr("refX","20")
            .attr("refY","5")
            .attr("markerUnits","strokeWidth")
            .attr("markerWidth","9")
            .attr("markerHeight","5")
            .attr("orient","auto")
            .append("svg:path")
            .attr("d","M 0 0 L 10 5 L 0 10 z")
            .attr("fill", "#BBBBBB"); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-03-04T18:35:07.673

### 问题

这个[jsFiddle](http://jsfiddle.net/mzz9B/1/)演示了有问题的问题。标记 def 的值与它所连接的元素的笔画宽度有关（在这种情况下为链接线）。请参阅[markerUnits 规范](http://www.w3.org/TR/SVG/painting.html#MarkerUnitsAttribute)。通过使用`strokeWidth`属性`markerUnits`，不同大小箭头的坐标将略有不同。简而言之，一种尺寸箭头的适当值不会正确转换为其他尺寸。

### 解决方案 1：多个标记

正如评论中提到的，一种解决方案是为每个`strokeWidth`需要的标记创建一个不同的标记。这只有在您事先知道需要什么尺寸时才有效。

### 解决方案 2：修改线条

另一种选择是修改线条的终点。不要让线在节点的中心终止，而是在节点的外边缘终止。这个[jsFiddle](http://jsfiddle.net/mzz9B/3/)演示了这一点。这减少了移动箭头的需要，因为我们现在可以在行尾绘制它。

这个解决方案涉及一些数学来确定应该是什么`x2`和`y2`值。`line`因此，它对于具有大量边的系统可能并不理想。

```
var nodeRadius = 10;
var lineX2 = function (d) {
    var length = Math.sqrt(Math.pow(d.target.y - d.source.y, 2) + Math.pow(d.target.x - d.source.x, 2));
    var scale = (length - nodeRadius) / length;
    var offset = (d.target.x - d.source.x) - (d.target.x - d.source.x) * scale;
    return d.target.x - offset;
};
var lineY2 = function (d) {
    var length = Math.sqrt(Math.pow(d.target.y - d.source.y, 2) + Math.pow(d.target.x - d.source.x, 2));
    var scale = (length - nodeRadius) / length;
    var offset = (d.target.y - d.source.y) - (d.target.y - d.source.y) * scale;
    return d.target.y - offset;
};

var link = svg.selectAll("line.link")
    .data(graph.links)
    .enter().append("svg:line")
    .attr("class", "link")
    .style("stroke-width", function (d) {
      return Math.sqrt(d.value);
    })
    .attr("x1", function (d) {
       return d.source.x;
    })
    .attr("y1", function (d) {
        return d.source.y;
    })
    .attr("x2", lineX2)
    .attr("y2", lineY2)
    .attr("marker-end", "url(#arrowGray)")
    .on("click", function (d) {
        link.style("stroke", "#dddddd");
        node.style("stroke", "#FFFFFF");
        d3.select(this).style("stroke", "red");
        link.attr("marker-end", null);
        link.attr("marker-end", "url(#arrowGray)");
        d3.select(this).attr("marker-end", null);
        d3.select(this).attr("marker-end", "url(#arrowRed)");
    });

var defs = svg.append('defs');
defs.append("svg:marker")
    .attr("id", "arrowGray")
    .attr("viewBox", "0 0 10 10")
    .attr("refX", "10")
    .attr("refY", "5")
    .attr("markerUnits", "strokeWidth")
    .attr("markerWidth", "10")
    .attr("markerHeight", "5")
    .attr("orient", "auto")
    .append("svg:path")
    .attr("d", "M 0 0 L 10 5 L 0 10 z")
    .attr("fill", "#000");

var node = svg.selectAll(".node")
    .data(graph.nodes)
    .enter().append("circle")
    .attr("class", "node")
    .attr("r", nodeRadius)
    .style("fill", function (d) {
        return color(d.group);
    })
    .call(force.drag);

node.append("title")
    .text(function (d) {
        return d.name;
    });

force.on("tick", function () {
    link.attr("x1", function (d) {
        return d.source.x;
    })
    .attr("y1", function (d) {
        return d.source.y;
    })
    .attr("x2", lineX2)
    .attr("y2", lineY2)

    node.attr("cx", function (d) {
        return d.x;
    })
    .attr("cy", function (d) {
        return d.y;
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T01:33:30.353

你`refX`的可能太大了。尝试将其设置为 1 左右。

# php - 在 PHP 表单中使用带有 MySQL 和多个表的复选框

> ID：11121472
> 
> 赞同：1
> 
> 时间：2012-06-20T14:09:24.707
> 
> 标签：php, mysql

我正在尝试使用 PHP 表单（new.php）来更新 2 个 MySQL 表并从第 3 个表中检索信息。我需要使用 3 个表的原因是可以通过另一种形式（search.php）搜索存储的信息，并且可以轻松编辑信息（edit.php）。

New.php 使用 4 个文本输入字段，目前使用 3 个复选框（尽管一旦我让这 3 个工作正常，这个数字会增加）。复选框充当“标签”，用于描述输入数据库的文章。因此，数据库中的单个条目包含以下信息：

文章标题、文章组织、访问日期、文章 URL 和文章标签（此表还有一`id`列。

标题、组织、日期和 url 都存储在一个名为`articles`.

标签都存储在一个名为的表中`tags`（其中有 85 个）。该表有 2 列：`id`和`tag_contents`。

第三个表是一个关系表（或者它可能被称为“交集表”？） ，它`articles_tags`有 2 列：article_id 和 tag_id。

new.php 当前所做的是将标题、组织、日期和 url 添加到`articles`表中，然后`mysql_insert_id()`用于获取该条目的 ID。

但是，在那之后，我无法弄清楚我需要用我的复选框做什么。

我有 3 个复选框：

```
<input type="checkbox" name="articletags[]" value="science" id="articletags_0" />
<input type="checkbox" name="articletags[]" value="geology" id="articletags_1" />
<input type="checkbox" name="articletags[]" value="astronomy" id="articletags_2" /> 
```

我需要以某种方式使用这些复选框与文章建立关系。因此，例如，在插入一篇关于岩石的文章后，表单将如下所示：

```
Article Title: Great new rocks!
Article Organization: US Geology Assoc.
Access Date: 09/20/2012
Article URL: www.rocks.com

Science [X]    Geology [X]    Astronomy [ ] (note that the X marks a checked checkbox) 
```

而且，数据库表看起来像这样：

```
(table: articles) id | articletitle     | articleorganization | articledate | articleurl
                  13 | great new rocks! | US geology assoc.   | 9/20/2012   | www.rocks.com

(table: tags)     id | tag_contents
                   5 | geology
                   9 | science

(table: articles_tags)   article_id  | tag_id
                            13       |   5
                            13       |   9 
```

注意`tags`table 不会改变，它只存储可用的标签并允许它们被 table 引用`articles_tags`。

我无法弄清楚这种情况，我已经研究了一个星期。作为参考，下面添加了 new.php 的代码：

```
 <?php 
 }

 // connect to the database
 include('settings.php');

 if(count($articletags) > 0)
{
 $articletags_string = implode(",", $articletags);
}
 // check if the form has been submitted. If it has, start to process the form and save it to the database
 if($_SERVER['REQUEST_METHOD'] == 'POST')
 { 
 // get form data, making sure it is valid
 $articletitle = mysql_real_escape_string(htmlspecialchars($_POST['articletitle']));
 $articleorganization = mysql_real_escape_string(htmlspecialchars($_POST['articleorganization']));
 $articledate = mysql_real_escape_string(htmlspecialchars($_POST['articledate']));
 $articleurl = mysql_real_escape_string(htmlspecialchars($_POST['articleurl']));

 // check to make sure both fields are entered
 if ($articletitle == '' || $articleorganization == '')
 {
 // generate error message
 $error = 'ERROR: Please fill in all required fields!';

 // if either field is blank, display the form again
 renderForm($articletitle, $articleorganization);
 }
 else
 {
 // save the data to the database
 mysql_query("INSERT INTO articles SET articletitle='$articletitle',
      articleorganization='$articleorganization',
      articledate='$articledate',
      articleurl='$articleurl' ")

 or die(mysql_error()); 

 $article_id = mysql_insert_id();

 foreach( $POST_['articletags'] as $newtag )
{
   mysql_query('INSERT INTO articles_tags (article_id,tag_id) VALUES ($article_id, $newtag)');
}

 // once saved, redirect to success page
 header("Location:addsuccess.php");  
 }
 }
 else
 // if the form hasn't been submitted, display the form
 {
 renderForm('','','','','');
 }
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T14:23:34.763

```
<input type="checkbox" name="articletags[]" value="5" id="articletags_0" />Science
<input type="checkbox" name="articletags[]" value="9" id="articletags_1" />Geology 
```

然后在 php

```
foreach( $POST_['articletags'] as $newtag )
{
   mysql_query('INSERT INTO articles_tags(article_id,tagID) VALUES( $idFromArticleInsert, $newtag )')
} 
```

# python - QLineEdit 和自定义函数不兼容

> ID：11121475
> 
> 赞同：0
> 
> 时间：2012-06-20T14:09:28.290
> 
> 标签：python, string, pyqt4

我正在尝试使用 Python 和 PyQt4 完成我的项目，但在通过我制作的函数传递 QLineEdit 变量时遇到问题。该字符串应该作为一个 url 工作，当我通过我的第一个参数传递它时，它试图读取 url 并获取它的内容，它会抛出这个错误：

```
Traceback (most recent call last):
  File "programa2.py", line 158, in on_link_clicked
    download_mango(self.a, self.path2)

  File "c:\Users\Poblet\ManGet\mango.py", line 19, in download_mango
    urlContent = urllib2.urlopen(url).read() # We read the URL

  File "c:\Python27\lib\urllib2.py", line 126, in urlopen
    return _opener.open(url, data, timeout)

  File "c:\Python27\lib\urllib2.py", line 386, in open
    protocol = req.get_type()

AttributeError: 'QString' object has no attribute 'get_type' 
```

这是由以下操作触发的：

```
def on_link_clicked(self):
    self.a = self.linkEdit.displayText()
    download_mango(self.a, self.path2) 
```

我完全迷路了。可能是 PyQt4 问题还是我的功能有问题？

我感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:57:49.400

您没有发布足够的代码来证明您的声明是正确的

> 该字符串应该作为一个 url 工作，当我通过我的第一个参数传递它时

看起来您正在将 QString 传递给 urlopen。把它包起来`str()`，你应该没问题。

```
>>> url = QString('http://stackoverflow.com/questions/11121475')
>>> urllib2.urlopen(url).read()
### this generates your error ending with
AttributeError: 'QString' object has no attribute 'get_type'

>>> urllib2.urlopen(str(url)).read()
### works 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T15:57:45.953

self.a 丢失

> “ **http://** ”或“ **https://** ”

尝试

```
download_mango("http://"+self.a,self.path2) 
```

见[http://www.nullege.com/codes/search/urllib2.Request.get_type](http://www.nullege.com/codes/search/urllib2.Request.get_type)

# asp.net - 使用 ASP.Net CLR 的 SQL 触发器

> ID：11121478
> 
> 赞同：0
> 
> 时间：2012-06-20T14:09:47.870
> 
> 标签：asp.net, sql-server-2008, clr

所以我正在尝试编写一个将调用 ASP.Net DLL 的 SQL Server 触发器。

我已经把一切都说完了，但我完全被难住了，当触发器触发时，它看不到“插入”的表？！？！

```
Msg 6522, Level 16, State 1, Procedure etrition_train_trigger_clr35, Line 1
A .NET Framework error occurred during execution of user-defined routine or aggregate "etrition_train_trigger_clr35": 
System.Data.SqlClient.SqlException: Invalid object name 'inserted'.
System.Data.SqlClient.SqlException: 
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj)
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlDataReader.ConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader()
   at CLRTrigger.CLRTrigger.SQLTriggerCall() 
```

这是我的 .Net 代码。就像我说的那样，它会在满足触发条件时触发，但是由于某种原因它看不到插入的表。

```
public static void SQLTriggerCall()
{
    SqlTriggerContext triggContext = SqlContext.TriggerContext;
    SqlConnection cn = new SqlConnection("Server=vm260101;Database=RT_Training;uid=XXXXXX;pwd=XXXXXXX;Enlist=False;");
    cn.Open();
    SqlCommand sqlComm = cn.CreateCommand();
    SqlPipe sqlP = SqlContext.Pipe;
    SqlDataReader dr;
    sqlComm.CommandText = "SELECT stu_fee_gu, stu_fee_pay_trans_gu, amount from inserted";
    dr = sqlComm.ExecuteReader();
    String stu_fee_gu = "";
    String stu_fee_pay_trans_gu = "";
    float amount = 0;
    while (dr.Read())
    {
        stu_fee_gu = Convert.ToString(dr["stu_fee_gu"]);
        stu_fee_pay_trans_gu = Convert.ToString(dr["stu_fee_pay_trans_gu"]);
        amount = (float)Convert.ToDecimal(dr["amount"]);
    }
    cn.Close();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T14:18:09.630

您打开的连接`cn`与触发器不共享相同的上下文。尝试使用[上下文连接](http://msdn.microsoft.com/en-us/library/ms131053.aspx)

请参阅下面的示例以[`SqlTriggerContext`](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.server.sqltriggercontext.aspx)了解触发器中的用法，例如：

```
// Retrieve the connection that the trigger is using.
  using (SqlConnection connection
     = new SqlConnection(@"context connection=true"))
  {
     connection.Open();

     // Get the inserted row.
     command = new SqlCommand(@"SELECT * FROM INSERTED;",
                              connection);

     // Get the user name and real name of the inserted user.
     reader = command.ExecuteReader();
     reader.Read();
     //More... 
```

当然，该示例的其余部分非常糟糕，因为它只假设`inserted`. 不要在你自己的代码中犯这个错误。

# android - Android 兼容性库中的 ViewPager 中缺少函数

> ID：11121480
> 
> 赞同：0
> 
> 时间：2012-06-20T14:09:56.133
> 
> 标签：android, compatibility, android-viewpager, android-support-library

我正在尝试`setOffscreenPageLimit()`在 ViewPager 中使用该函数，但 Eclipse 说*The function `setOffscreenPageLimit()`is undefined for type ViewPager*

但是，我在文档和许多示例中都看到了它。 [浏览器](http://developer.android.com/reference/android/support/v4/view/ViewPager.html#setOffscreenPageLimit%28int%29)

这是我的代码：

```
import android.support.v4.view.ViewPager;

public class MyView {
    private final ViewPager viewPager; 

    MyView (ViewPager viewPager) {
       this.viewPager = viewPager;
       viewPager.setOffscreenPageLimit(2); //<-- can't find it
    }
} 
```

我认为这一定是图书馆的一些奇怪问题。我的 minSdk 是 7，target 是 13。我已经多次按下“检查更新”，甚至尝试手动重新导入兼容性库，但这个功能仍然没有出现。有任何想法吗？我真的很需要这个功能！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T12:12:15.850

我认为 .setOffscreenPageLimit() 是最近添加到 android 支持库的。您应该使用 Android SDK Manager 将您的支持库更新到最新的（当前为 v9）。干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T20:38:57.110

我遇到了类似的问题，解决方案是将 jar 文件添加到 libs 目录并将其添加到项目属性中的构建路径中。不要将文件添加为外部 jar，单击“添加 jar”。

希望这可以帮助。

# asp.net-mvc-3 - 比较实体框架和 MVC 中的 OriginalValues 和 CurrentValues

> ID：11121481
> 
> 赞同：2
> 
> 时间：2012-06-20T14:09:56.887
> 
> 标签：asp.net-mvc-3, entity-framework

我有一个标准的 MVC 应用程序，它使用由应用程序功能脚手架 (CRUD) 生成的开箱即用代码。我正在尝试评估特定字段是否已更改，以便对我的数据完成其他任务。显然，我对 OriginalValues 和 CurrentValues 的想法并不是它实际实现的方式（呃！）。关于如何比较这些值以实现这一点的任何想法？提前致谢...

```
 [HttpPost]
    public ActionResult Edit(Address address)
    {
        if (ModelState.IsValid)
        {
            string st1 = db.Entry(address).Property(p => p.locationTypeId).CurrentValue.ToString();
            //string st2 = db.Entry(address).Property(p => p.locationTypeId).OriginalValue.ToString();

            bool bLocationTypeChanged = false;
            db.Entry(address).State = EntityState.Modified;
            db.SaveChanges();

            // Other stuff happens here

            return RedirectToAction("Index");
        }

        ViewBag.locationTypeId = new SelectList(db.LocationTypes, "locationTypeId", "name", address.locationTypeId);
        return View(address);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T15:06:04.040

```
if (ModelState.IsValid)
{        
    foreach (var entry in db.ChangeTracker.Entries<Address>().Where(a => a.State != EntityState.Unchanged))
    {
        string st1 = entry.Property(p => p.locationTypeId).CurrentValue.ToString();
        string st2 = entry.Property(p => p.locationTypeId).OriginalValue.ToString();

        //Do your extra stuff based on your comparison here.... 
    } 
```

您可以查看 ChangeTracker 中的每个实体条目并检查 EntityState。然后，您的`st1`和`st2`值比较应该返回您想要比较的值。

# jquery - jQuery - 将图像缩放到指定位置

> ID：11121485
> 
> 赞同：1
> 
> 时间：2012-06-20T14:10:05.003
> 
> 标签：jquery, image, position, zooming, pan

这是我的要求：我有一个应该显示图像（JPEG）的 DIV。当页面被渲染时，这个 div 应该以指定的缩放系数将图像显示到图片上的指定位置（点）。图片应该放在这个DIV里面（不能超过DIV的边距）。在这个 DIV 上，图像可以（在初始缩放之后）移动/平移（通过鼠标或滚动条）和放大和缩小（通过鼠标滚轮、按钮、滑块或任何方法）。在某些情况下，DIV 应该显示（聚焦）图像的另一个点（相同或其他缩放因子）。图像会在某些事件中发生变化。当焦点从一个点切换到另一个点（但在同一页面上）时，我不想重新加载图片，以防图像源发生变化。

我在这里找到了类似的东西，但不太接近我的要求： [http ://www.htmldrive.net/items/show/394/JQuery.iviewer-zoom-image-and-to-drag-effect](http://www.htmldrive.net/items/show/394/JQuery.iviewer-zoom-image-and-to-drag-effect)

我提到我是 javascript 的新手，对任何部分要求的任何帮助都非常受欢迎。如果您知道可以执行此操作的（免费）插件，请告诉我。

感谢您为我的问题付出的宝贵时间

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:08:51.900

仔细看了上面提到的IVIEWER插件后，发现它还包含一个moveTo方法，可以将图像定位在指定点，所以IVIEWER包含了我所有的需求。

# java - JavaMail 在 osgi 包中失败

> ID：11121490
> 
> 赞同：0
> 
> 时间：2012-06-20T14:10:13.617
> 
> 标签：java, ssl, osgi, jakarta-mail, eclipse-virgo

我正在尝试使用 JavaMail 从包（在 Virgo 上运行）发送邮件，如果我在同一台机器上尝试来自简单测试 jar（不是 osgi）的相同代码，它会成功。

这是我的代码：

```
Properties props = new Properties();
props.put("mail.smtp.host", "smtp.gmail.com");
props.put("mail.smtp.socketFactory.port", "465");
props.put("mail.smtp.socketFactory.class",
        "javax.net.ssl.SSLSocketFactory");
props.put("mail.smtp.auth", "true");
props.put("mail.smtp.port", "465");

Session session = Session.getInstance(props,
        new javax.mail.Authenticator() {
            protected PasswordAuthentication getPasswordAuthentication() {
                return new PasswordAuthentication(
                        "user@gmail.com", "password");
            }
        });

try {

    Message message = new MimeMessage(session);
    message.setFrom(new InternetAddress("user@gmail.com"));
    message.setRecipients(Message.RecipientType.TO,
            InternetAddress.parse("tomail@gmail.com"));
    message.setSubject("Testing 123");
    message.setText("test123");

    // create the message part
    MimeBodyPart messageBodyPart = new MimeBodyPart();

    // fill message
    messageBodyPart.setText("testing testing testing testing");

    Multipart multipart = new MimeMultipart("mixed");
    multipart.addBodyPart(messageBodyPart);

    // Part two is attachment
    messageBodyPart = new MimeBodyPart();
    DataSource source = new FileDataSource("/tmp/sample.pdf");
    messageBodyPart.setDataHandler(new DataHandler(source));

    messageBodyPart.setFileName("/tmp/sample.pdf");
    multipart.addBodyPart(messageBodyPart);

    // Put parts in message
    message.setContent(multipart);

    Transport.send(message);

    System.out.println("Done");

} catch (MessagingException e) {
    throw new RuntimeException(e);
} 
```

这是一个例外：

```
javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target
        at mailsender.test.SendMail(test.java:232) ~[mailsender-bundle-2.2.1.5.jar/:na]
        at mailsender.test.createReport(test.java:152) ~[mailsender-bundle-2.2.1.5.jar/:na]
        at mailsender.test.eventjob.execute(eventjob.java:100) [mailsender-bundle-2.2.1.5.jar/:na]
        at org.quartz.core.JobRunShell.run(JobRunShell.java:202) [com.springsource.org.quartz-1.6.2.jar:1.6.2]
        at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:525) [com.springsource.org.quartz-1.6.2.jar:1.6.2]
Caused by: javax.mail.MessagingException: Exception reading response
        at com.sun.mail.smtp.SMTPTransport.readServerResponse(SMTPTransport.java:1462) ~[na:na]
        at com.sun.mail.smtp.SMTPTransport.openServer(SMTPTransport.java:1260) ~[na:na]
        at com.sun.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:370) ~[na:na]
        at javax.mail.Service.connect(Service.java:297) ~[com.springsource.javax.mail-1.4.0.jar:1.4]
        at javax.mail.Service.connect(Service.java:156) ~[com.springsource.javax.mail-1.4.0.jar:1.4]
        at javax.mail.Service.connect(Service.java:105) ~[com.springsource.javax.mail-1.4.0.jar:1.4]
        at javax.mail.Transport.send0(Transport.java:168) ~[com.springsource.javax.mail-1.4.0.jar:1.4]
        at javax.mail.Transport.send(Transport.java:98) ~[com.springsource.javax.mail-1.4.0.jar:1.4]
        at mailsender.test.SendMail(test.java:227) ~[mailsender-bundle-2.2.1.5.jar/:na]
        ... 4 common frames omitted
Caused by: javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target
        at com.sun.net.ssl.internal.ssl.Alerts.getSSLException(Alerts.java:174) ~[na:1.6]
        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.fatal(SSLSocketImpl.java:1731) ~[na:1.6]
        at com.sun.net.ssl.internal.ssl.Handshaker.fatalSE(Handshaker.java:241) ~[na:1.6]
        at com.sun.net.ssl.internal.ssl.Handshaker.fatalSE(Handshaker.java:235) ~[na:1.6]
        at com.sun.net.ssl.internal.ssl.ClientHandshaker.serverCertificate(ClientHandshaker.java:1206) ~[na:1.6]
        at com.sun.net.ssl.internal.ssl.ClientHandshaker.processMessage(ClientHandshaker.java:136) ~[na:1.6]
        at com.sun.net.ssl.internal.ssl.Handshaker.processLoop(Handshaker.java:593) ~[na:1.6]
        at com.sun.net.ssl.internal.ssl.Handshaker.process_record(Handshaker.java:529) ~[na:1.6]
        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:925) ~[na:1.6]
        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.performInitialHandshake(SSLSocketImpl.java:1170) ~[na:1.6]
        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.readDataRecord(SSLSocketImpl.java:785) ~[na:1.6]
        at com.sun.net.ssl.internal.ssl.AppInputStream.read(AppInputStream.java:75) ~[na:1.6]
        at com.sun.mail.util.TraceInputStream.read(TraceInputStream.java:97) ~[na:na]
        at java.io.BufferedInputStream.fill(BufferedInputStream.java:218) ~[na:1.6.0_33]
        at java.io.BufferedInputStream.read(BufferedInputStream.java:237) ~[na:1.6.0_33]
        at com.sun.mail.util.LineInputStream.readLine(LineInputStream.java:75) ~[na:na]
        at com.sun.mail.smtp.SMTPTransport.readServerResponse(SMTPTransport.java:1440) ~[na:na]
        ... 12 common frames omitted
Caused by: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target
        at sun.security.validator.PKIXValidator.doBuild(PKIXValidator.java:323) ~[na:1.6.0_33]
        at sun.security.validator.PKIXValidator.engineValidate(PKIXValidator.java:217) ~[na:1.6.0_33]
        at sun.security.validator.Validator.validate(Validator.java:218) ~[na:1.6.0_33]
        at com.sun.net.ssl.internal.ssl.X509TrustManagerImpl.validate(X509TrustManagerImpl.java:126) ~[na:1.6]
        at com.sun.net.ssl.internal.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:209) ~[na:1.6]
        at com.sun.net.ssl.internal.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:249) ~[na:1.6]
        at com.sun.net.ssl.internal.ssl.ClientHandshaker.serverCertificate(ClientHandshaker.java:1185) ~[na:1.6]
        ... 24 common frames omitted
Caused by: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target
        at sun.security.provider.certpath.SunCertPathBuilder.engineBuild(SunCertPathBuilder.java:174) ~[na:1.6.0_33]
        at java.security.cert.CertPathBuilder.build(CertPathBuilder.java:238) ~[na:1.6.0_33]
        at sun.security.validator.PKIXValidator.doBuild(PKIXValidator.java:318) ~[na:1.6.0_33]
        ... 30 common frames omitted 
```

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T19:18:50.790

[http://www.oracle.com/technetwork/java/javamail/faq/index.html#installcert](http://www.oracle.com/technetwork/java/javamail/faq/index.html#installcert)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T16:47:43.060

它看起来像服务器配置问题，我在 Equinox 中运行相同的代码，所以它不太可能是与 OSGi 相关的问题。

我认为你需要将你的密钥（或者你的根密钥）安装到 Virgo，有点像这样：

[https://confluence.atlassian.com/display/JIRA/Connecting+to+SSL+services](https://confluence.atlassian.com/display/JIRA/Connecting+to+SSL+services)

# .net - Log4Net 停止记录

> ID：11121496
> 
> 赞同：1
> 
> 时间：2012-06-20T14:10:24.567
> 
> 标签：.net, exception-handling, c#-3.0, log4net

我有一个全天运行的实用程序，用于数据转换和同步。

如果应用程序暂时停止运行，这没什么大不了的，但它必须记录它的操作。我宁愿应用程序失败也不愿让它不记录。我遇到了一些涉及该主题的帖子，但我无法获得任何解决方案。

我需要设置一种方法来阻止应用程序运行（取决于应用程序设置）并在 Log4Net 停止记录时发送警告电子邮件。

我的附加程序有这个：

```
<log4net>
<appender name="LogFileAppender" type="log4net.Appender.FileAppender">
  <errorHandler type="SomeApp.PresentationLayer.Log4NetErrorHandler" />
  <file type="log4net.Util.PatternString" value="H:\SomeApp-%property{RegNo}-log.txt" />
  <appendToFile value="true" />
  <layout type="log4net.Layout.PatternLayout">
    <header value="[START]" />
    <footer value="[END]" />
    <conversionPattern value="%date %-5level - %message%newline" />
  </layout>
</appender>
<!-- Setup the root category, add the appenders and set the default level -->
<root>
  <level value="DEBUG" />
  <appender-ref ref="LogFileAppender" />
  <!-- <appender-ref ref="A" /> -->
</root> 
```

这是我的错误处理程序：

```
namespace SomeApp.PresentationLayer
{
class Log4NetErrorHandler : IErrorHandler
{

    public bool HandleError(Exception ex)
    {
        //Trace.TraceError(ex.ToString());
        ExceptionUtil.GetAndLogMessage(ex, "Log4Net Error in SomeApp", false, true);

        return false;
    }

    public void ProvideFault(Exception error, MessageVersion version, ref Message fault)
    {
        // Shield the unknown exception
        FaultException faultException = new FaultException(
            "Server error encountered. All details have been logged.");
        MessageFault messageFault = faultException.CreateMessageFault();

        fault = Message.CreateMessage(version, messageFault, faultException.Action);
    }
}
} 
```

无论我尝试什么，异常处理程序都不会触发。我将日志文件设置为映射驱动器。在记录时，我断开了驱动器，它永远不会向我的异常处理程序抛出异常。有人看到我错过了什么吗？

我正在使用 c# .net 3.5 log4net 1.2.10

感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T05:42:40.530

我找到了。

这是 Log4Net 的 iErrorHandler：

[http://dotnetforyou.wordpress.com/2011/02/18/debugging-log4net-when-it-stops-logging/](http://dotnetforyou.wordpress.com/2011/02/18/debugging-log4net-when-it-stops-logging/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T02:31:59.747

我实际上没有使用过 log4net errorHandlers 并且可能在这里完全关闭，但我的直觉告诉我，errorHandler 旨在配置 log4net 异常的处理，而不是应用程序异常，并且关于这个主题的可用信息太少以至于虚假关于 errorHandler 参数的博客文章可能会让您感到困惑。从 SDK 文档：

```
Implements log4net's default error handling policy which consists of emitting a 
message for the first error in an appender and ignoring all subsequent errors. 
```

不是很有帮助，我承认，但它似乎并不像你想的那样。您必须正确处理应用程序中的应用程序异常并自己记录消息以在日志中查看。

这里还有[一个问题](https://stackoverflow.com/questions/1239445/how-to-receive-events-if-log4net-stops-logging?rq=1)可能会提供额外的线索。

# node.js - 无法发布/发布 nodejs

> ID：11121501
> 
> 赞同：0
> 
> 时间：2012-06-20T14:10:56.323
> 
> 标签：node.js, content-management-system, pug

我的 app.coffee 中的代码它使用咖啡脚本我已经放置了正文解析器和方法 ovveride

```
 express = require("express")
          everyauth = require("everyauth")
             should = require("should")
        fs = require("fs")

      everyauth.debug = true
        usersByLogin = krishna:
          login: "krishna"
          email: "krishna@blogab.com"
             password: "krishna"

          everyauth.password.loginWith("login").getLoginPath("/login").postLoginPath("        
       /login").loginView("bcore/login.jade").loginLocals((req, res, done) ->
      setTimeout (->
       done null,
           title: "blogab - login"
          ), 200
         ).authenticate((login, password) ->
      errors = []
        errors.push "Missing login"  unless login
       errors.push "Missing password"  unless password
       return errors  if errors.length
         user = usersByLogin[login]
        return [ "Login failed" ]  unless user
        return [ "Login failed" ]  if user.password isnt password
      user
       ).getRegisterPath("/register").postRegisterPath("    

         /register").registerView("bcore                 

         /register.jade").registerLocals((req, res, done) ->
      setTimeout (->
         done null,
            title: " Register"
          ), 200
           ).extractExtraRegistrationParams((req) ->
        email: req.body.email
       ).validateRegistration((newUserAttrs, errors) ->
        login = newUserAttrs.login
        errors.push "Login already taken"  if usersByLogin[login]
        errors
         ).registerUser((newUserAttrs) ->
            login = newUserAttrs[@loginKey()]
             usersByLogin[login] = newUserAttrs
           ).loginSuccessRedirect("/admin").registerSuccessRedirect "/admin"
                    app =  express.createServer

          (express.bodyParser(),express.methodOverride(),     
             express.static(__dirname + "/public"),

                 express.session(secret: "htuayreve"),  everyauth.middleware())

              express.cookieParser(), 
               app.configure ->
             app.set "view engine", "jade"

            app.get "/", (req, res) ->
         res.render "templates/default/index",
          title: "blogab"
          users: JSON.stringify(usersByLogin, null, 2)

         app.get "/admin", (req, res) ->
         res.render "bcore/admin",
         title: "Blogab-admin"
          users: JSON.stringify(usersByLogin, null, 2)

           app.get "/login", (req, res) ->
            res.render "bcore/login",
             title: "login"
             users: JSON.stringify(usersByLogin, null, 2)

               app.get "/post", (req, res) ->
                   res.render "bcore/viewpost",
                    title: "login"
                    users: JSON.stringify(usersByLogin, null, 2)

            app.get "/admin/post/new", (req, res) ->
            res.render "bcore/newpost",
           title: "Blogab-newpost"
            users: JSON.stringify(usersByLogin, null, 2)

       everyauth.helpExpress app
         app.listen 1224, ->
          console.log "blogab is  running on port %d in %s mode",
            app.address().port,   app.setting 
```

在 newpost.jade 中是 newpost 的代码

```
 !!! 5
           html(xmlns='http://www.w3.org/1999/xhtml')
           head
           title
          link(href='/css/master.css', rel='stylesheet', type='text/css')
          body
           h1
           | New post
           form#new_post.new_post(method='post', action='/posts')
             .field
              label(for='post_title') Title
               br
                 input#post_title(type='text', name='title', size='30')
           .field
              label(for='post_content') Content
            br
               textarea#post_content(name='content', cols='40', rows='20')
          .actions
              input#post_submit(type='submit', value='Create Post')
            p
               br
                 a(href='/posts') Back 
```

当我单击在 newpost.jade 中发布它时，它说无法发布/发布，我正在创建基于 nodejs 的 cms，我使用了 express body parser 和方法 ovveride

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:30:34.030

好像您忘记定义 POST /posts 路由：

```
app.get '/posts', (req, res, next) -> 
```

**编辑**添加一个例子，你的代码真的很难阅读。我写了这个：

```
express = require 'express'
app = express.createServer()

app.configure ->
  app.use express.methodOverride()
  app.use express.bodyParser()
  app.use app.router

app.post '/posts', (req, res) -> res.send req.body

app.listen 3000 
```

`$ curl localhost:3000/posts -X POST -d "param1=value1&param2=value2"`

`{"param1":"value1","param2":"value2"}%`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T15:32:52.890

如果您想发布数据来表达，您必须使用 POST 动词定义您的路线：

```
app.post '/posts', (req, res) -> 
```

另外，我不确定您是否要将路由定义为“/post”或“/posts”，因此请仔细检查客户端和服务器代码是否匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-07T03:33:45.600

**app.get**无法发布数据，请尝试始终使用**app.post**发布数据。它对我有用:)

# jquery - jQuery 提示提示：原始提示提示与提示提示提示一起显示（2 个提示提示）

> ID：11121502
> 
> 赞同：0
> 
> 时间：2012-06-20T14:10:59.323
> 
> 标签：jquery, tooltip, cluetip

我对[jQuery 线索提示](http://plugins.learningjquery.com/cluetip)插件有疑问。

我以这种方式初始化插件：

```
$(function(){
    $("#contentTable > tbody > tr").each(function () {
        $(this).children("td:eq(3)").cluetip({
            splitTitle: '|',
            showTitle: false,
            escapeTitle: true,
            dropShadow: true,
            cursor: 'default',
            cluetipClass: 'info',
            positionBy: 'mouse',
            attribute: 'tooltip'
        });
    });
}); 
```

`td`它正在工作，但是在我的元素上单击并悬停几次后，该`title`属性再次被填充，并且**原始工具提示与线索提示工具提示（在 Internet Explorer 中）一起显示**。

有人有想法吗？

*截图*

页面加载：

[http://tinypic.com/r/vowexi/6](http://tinypic.com/r/vowexi/6)

单击/悬停/执行后：

[http://tinypic.com/r/16j4ldi/6](http://tinypic.com/r/16j4ldi/6)

我正在使用*jQuery 1.7.2*和*线索提示 1.2.5*。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T09:42:48.663

我已经切换到[simpletip](http://craigsworks.com/projects/simpletip/)。

我对这个插件没有这样的问题，所以这将是我的选择。

# perforce - perforce，搁置测试失败

> ID：11121509
> 
> 赞同：1
> 
> 时间：2012-06-20T14:11:31.217
> 
> 标签：perforce, shelve

我的 Shelve 测试构建失败了，它给了我：

```
Project file 'e:\p4\tech\...\someproject.vcproj' could not be loaded.
The project is either missing from disk or access was denied. 
```

而该项目实际上存在于我的本地系统上。

我还将一个新项目添加到 perforce 树中，其中： 新路径已添加到客户端规范中，以便它映射到新项目。但是，它仍然抱怨：

```
Project file 'e:\p4\tech\...\newproject.vcproj' could not be loaded.
The project is either missing from disk or access was denied. 
```

请让我知道我应该如何解决这个问题。谢谢。

# orbeon - 如何在 OrbeonForms 3.9 中处理静态内容

> ID：11121510
> 
> 赞同：1
> 
> 时间：2012-06-20T14:11:45.860
> 
> 标签：orbeon

我试图从 OrbeonForms 版本 3.8 升级到 3.9。我使用`PriorityResourceManagerFactory`如下：

```
<context-param>
    <param-name>oxf.resources.factory</param-name>
    <param-value>org.orbeon.oxf.resources.PriorityResourceManagerFactory</param-value>
</context-param>
<!-- Uncomment this for the filesystem resource manager -->
<context-param>
    <param-name>oxf.resources.priority.1</param-name>
    <param-value>org.orbeon.oxf.resources.FilesystemResourceManagerFactory</param-value>
</context-param>
<context-param>
    <param-name>oxf.resources.priority.1.oxf.resources.filesystem.sandbox-directory</param-name>
    <param-value>d:/Sources/esb-repository/user-interface</param-value>
</context-param>
<context-param>
    <param-name>oxf.resources.priority.2</param-name>
    <param-value>org.orbeon.oxf.resources.WebAppResourceManagerFactory</param-value>
</context-param>
<context-param>
    <param-name>oxf.resources.priority.2.oxf.resources.webapp.rootdir</param-name>
    <param-value>/WEB-INF/resources</param-value>
</context-param>
<context-param>
    <param-name>oxf.resources.priority.3</param-name>
    <param-value>org.orbeon.oxf.resources.FilesystemResourceManagerFactory</param-value>
</context-param>
<context-param>
    <param-name>oxf.resources.priority.3</param-name>
    <param-value>org.orbeon.oxf.resources.ClassLoaderResourceManagerFactory</param-value>
</context-param> 
```

我在 page-flow.xml 中有条目：

```
<files path-info=".+\.(gif|css|pdf|json|js|png|jpg|xsd|ico)"
    matcher="oxf:perl5-matcher"/> 
```

在我的目录中，我保留了整个应用程序代码，并且我有文件*theme/styles/layout.css*。在 Orbeon 3.8 服务器路径`/orbeon/theme/styles/layout.css`完美运行，但不是在 3.9。

如何配置它以保持向后兼容性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T03:40:43.887

我假设`/orbeon`是您部署 Orbeon Forms Web 应用程序的上下文。

1.  如果你使用的是Orbeon Forms PE，3.9版本开始[默认开启](http://wiki.orbeon.com/forms/doc/developer-guide/release-notes/39#TOC-CSS-and-JavaScript-resources)资源，浏览器请求的路径需要是，app版本`/orbeon/3.14/theme/styles/layout.css`在哪里。`3.14`如果您编写`/theme/styles/layout.css`代码，Orbeon Forms 会自动为您重写代码，并在发送给浏览器的 HTML 中添加版本号。

2.  从 3.9 开始，[在查找资源时会添加默认的应用路径](http://wiki.orbeon.com/forms/doc/developer-guide/release-notes/39#TOC-Default-app-path-prepended-for-resources)。`/orbeon/3.14/theme/styles/layout.css`因此，对具有版本化资源或不具有版本化资源的 的请求将在您的资源目录中`/orbeon/theme/styles/layout.css`查找该文件。`app/theme/styles/layout.css`所以你需要：

    *   将您的 CSS 移动到磁盘上的不同位置（移动`theme`到`app`目录下）。
    *   添加`theme`为*平台路径*，方法是将其添加到[`oxf.url-rewriting.platform-paths`属性](http://wiki.orbeon.com/forms/doc/developer-guide/configuration-properties/configuration-properties-base#TOC-oxf.url-rewriting.platform-paths)中。这很可能是对您最有意义的选项。

# ios - iOS滚动到视图文本字段

> ID：11121511
> 
> 赞同：3
> 
> 时间：2012-06-20T14:11:48.700
> 
> 标签：ios, objective-c, forms, uitableview, keyboard

我对 iOS 中的长表单有疑问。表单本身是使用静态表格视图完成的。对于表单，我需要一个带有 prev/next 的工具栏并完成。在这个项目中，我添加了[BSKeyboardControls](http://github.com/SimonBS/BSKeyboardControls)，并且我已经在另一个项目中自己完成了。

工具栏工作正常，除非下一个或上一个 textField/textView 看不见。然后对前 textField 的关注不会改变，我仍然在这个文本字段中输入。当我现在手动滚动并出现目标下一个文本字段时，它神奇地成为第一响应者。这当然不是预期的行为。

所以我想在尝试将它们设置为第一响应者之前，我必须将表格视图滚动到相应的字段。但我无法完成这件事。

我已经尝试过使用 indexPathes

```
NSIndexPath *path = [self.tableView indexPathForCell:(UITableViewCell *)textField.superview.superview];
[self.tableView scrollToRowAtIndexPat:path atScrollPosition:UITableViewScrollPositionTop animated:YES]; 
```

尽管 super-superview 是一个有效的（也是正确的）表格单元格，但返回的路径是 nil。我也尝试了一些变化

```
CGPoint point = [self.tableView convertPoint:textField.frame.origin toView:self.tableView];
NSIndexPath *path = [self.tableView indexPathForRowAtPoint:point]; 
```

以及 rects 和 indexPathsForRowsInRect 的其他变体。

唯一的方法是手动跟踪 textFields 单元格 indexPaths，但在这种情况下这不是合适的解决方案。

任何人都知道如何在tableView中实现滚动到看不见的textField？

编辑：

正如贾斯汀保尔森要求keyboardControlsPreviousNextPressed的代码：

```
- (void)keyboardControlsPreviousNextPressed:(BSKeyboardControls *)controls withDirection:(KeyboardControlsDirection)direction andActiveTextField:(id)textField
{
    NSIndexPath *path = [self.tableView indexPathForCell:(UITableViewCell *)((UIView *)textField).superview.superview];
    NSLog(@"path %@ for cell %@", path, ((UIView *)textField).superview.superview);
    [self.tableView scrollToRowAtIndexPath:path atScrollPosition:UITableViewScrollPositionTop animated:YES];
    [textField becomeFirstResponder];
} 
```

正如我根据日志的输出所说，路径为零，而超级超级视图是正确的表视图单元

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T08:18:43.370

感谢您尝试帮助我，我自己有一个解决方案。在我的`keyboardControlsPreviousNextPressed`我现在

```
[self.tableView scrollRectToVisible:((UIView *)textField).superview.superview.frame animated:YES];
[textField becomeFirstResponder]; 
```

这个解决方案似乎工作得很好。我遇到的唯一问题是*有时*新聚焦的 textField 被键盘隐藏，因此 tableViewController 不会自动调整。在大多数情况下，您还可以将该行滚动到顶部以规避这种情况。

```
NSIndexPath *path = [self.tableView indexPathForCell:(UITableViewCell *)textField.superview.superview];
[self.tableView scrollToRowAtIndexPath:path atScrollPosition:UITableViewScrollPositionTop animated:YES]; 
```

# objective-c - Objective-C在for循环中改变数组内容

> ID：11121513
> 
> 赞同：-1
> 
> 时间：2012-06-20T14:11:55.173
> 
> 标签：objective-c, loops, for-loop, scope, nsmutablearray

我有一个问题（我认为）可能与范围有关，但我不确定。我正在尝试做一些我认为应该很简单的事情，但我得到了一个奇怪的结果，我真的可以使用一些建议。我会说我是一个早期目标 c 程序员，但不是一个完整的新手。

我在objective-c 中编写了一个函数，我想用它来更改可变字典对象的可变数组中的键名。所以，我想传入一个可变字典对象的可变数组，并返回具有相同字典对象的相同可变数组，但更改了一些键名。有道理？

我在这段代码中尝试了几个日志语句，这似乎表明我所做的一切都在工作，除了 for 循环完成执行时（当我尝试测试 temp 数组中的值时），数组似乎包含仅源数组中的最后一个元素，重复 [source count] 次。通常，这会让我相信我没有正确写入新值，或者没有正确读取它们，甚至我的 NSLog 语句没有向我展示我认为它们是什么。但这可能是因为范围吗？数组是否不会在 for 循环之外保留其更改？

我已经在这个功能上投入了相当多的时间，而且我已经用尽了我的技巧。任何人都可以帮忙吗？

```
-(NSMutableArray *)renameKeysIn:(NSMutableArray*)source {
/*
// Pre:
// The source array is an array of dictionary items.
// This method renames some of the keys in the dictionary elements, to make sorting easier later. 
// - "source" is input, method returns a mutable array
 */

// copy of the source array
NSMutableArray *temp = [source mutableCopy];

// a temporary dictionary object:
NSMutableDictionary * dict = [[NSMutableDictionary alloc] init];

// These arrays are the old field names and the new names
NSMutableArray *originalField = [NSMutableArray arrayWithObjects:@"text", @"created_at",nil];
NSMutableArray *replacedField = [NSMutableArray arrayWithObjects:@"title", @"pubDate", nil];

// loop through the whole array
for (int x =0; x<[temp count]; x++) {
    // set the temp dictionary to current element
    [dict setDictionary:[temp objectAtIndex:x]]; 

    // loop through the number of keys (fields) we want to replace (created_at, text)... defined in the "originalField" array 
    for (int i=0; i<[originalField count]; i++)
    {   
            // look through the NSDictionary item (fields in the key list)
            // if a key name in the dictionary matches one of the ones to be replaced, then replace it with the new one
            if ([dict objectForKey:[originalField objectAtIndex:i]] != nil) {
                // add a new key/val pair: the new key *name*, and the old key *value* 
                [dict setObject:[dict objectForKey:[originalField objectAtIndex:i]] 
                         forKey:[replacedField objectAtIndex:i]];
                // remove the old key/value pair
                [dict removeObjectForKey:[originalField objectAtIndex:i]];
            }// end if dictionary item not null

    }// end loop through keys (created_at, text)

    [temp replaceObjectAtIndex:x withObject:dict];

}// end loop through array

// check array contents
for (int a=0; a<[temp count]; a++){
    NSLog(@"Temp contents: ############ %@",[[temp objectAtIndex:a] objectForKey:@"pubDate"]);
}

return temp;    
} // end METHOD 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T14:23:06.710

我认为问题在于：

```
[dict setDictionary:[temp objectAtIndex:x]]; 
```

由于这些东西几乎都在指针中工作（而不是复制内容），所以临时数组的每个元素都将指向 dict 字典，该字典设置为最新键的字典。我认为设置实际指针将解决问题。

```
dict = [temp objectAtIndex:x]; 
```

# mongodb - _id + 一些值上的 MongoDB 多键

> ID：11121514
> 
> 赞同：0
> 
> 时间：2012-06-20T14:11:55.950
> 
> 标签：mongodb

在 MongoDB 中，我有一个如下所示的查询，以找出用户已经投票的评论：

```
db.comments.find({
    _id: { $in: [...some ids...] },
    votes.uid: "4fe1d64d85d4f4c00d000002"
}); 
```

正如文档所说，您应该拥有

> 每个查询一个索引

那么在 _id + votes.uid 上创建一个多键更好，还是仅仅在 votes.uid 上建立索引就足够了，因为 Mongo 会以任何方式自动处理 _id？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T14:23:26.653

**_id**上自动有一个索引。

根据您的*查询*（您在 $in 数组中有多少个 id）和您的*数据*（您对一个对象有多少票），您可以在 votes.uid 上创建一个索引。

注意在查询执行期间使用哪个索引，并记住您可以通过添加`.hints(field:1)`或强制 Mongo 使用您想要的索引`hints('indexname')`

# c#-4.0 - AutomationElement 找不到行单元格值（但 UISpy 可以）

> ID：11121517
> 
> 赞同：1
> 
> 时间：2012-06-20T14:12:17.447
> 
> 标签：c#-4.0, automationelement, syslistview32

我正在尝试从具有 3 个列表 (SysListView32) 的窗口中获取数据。我对它们三个都做了同样的事情，UISpy 和 Inspect 都可以看到它们三个中的行和单元格，但是在代码中它们中的两个可以完美运行（Caption="List2" 和 Caption="List3"），但是第三个只包含白色的空字符串。

如果我尝试：

```
IntPtr PrizeListHandle = Win32Utils.FindWindowByCaption(Lobby, "List1");
IUIAutomationElement dataGridPrizes = autom.ElementFromHandle(PrizeListHandle);
IUIAutomationGridPattern gridPrizes = dataGridPrizes.GetCurrentPattern(10006);

string linea = gridPrizes.GetItem(0, 0).CurrentName; 
```

***linea***变为空字符串，gridPrizes 有 17 行 3 列，所有单元格都是空字符串。

如果我尝试：

```
IntPtr PrizeListHandle = Win32Utils.FindWindowByCaption(Lobby, "List1");
IUIAutomationElement dataGridPrizes = autom.ElementFromHandle(PrizeListHandle);
int propIdClassName = 30004; // UIA_ClassNamePropertyId;
IUIAutomationPropertyCondition conditionListItem = (IUIAutomationPropertyCondition)autom.CreatePropertyCondition(propIdClassName, "list item");
IUIAutomationElementArray children = dataGridPrizes.FindAll(interop.UIAutomationCore.TreeScope.TreeScope_Children, conditionListItem);

int i = children.Length; 
```

***我***是0。为什么？

重要的是要注意，当使用 UISpy 时，它会发现一切。此外，我已经尝试在自动化上管理一个非托管版本，结果完全相同。

我正在使用 Windows Server 2008 R2。

这是一个屏幕截图： ![在此处输入图像描述](../Images/c4f0dc66567efdbd4c275144fe301ef8.png)

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-07T05:38:53.947

您需要使用*ScrollItemPattern.ScrollIntoView()*进入视野。

```
var pattern = (ScrollItemPattern)aeDataGridCell
    .GetCurrentPattern(ScrollItemPatternIdentifiers.Pattern);
pattern.ScrollIntoView(); 
```

# vba - Excel VBA代码，一个宏在单独运行时工作，但在一组运行时调试

> ID：11121519
> 
> 赞同：1
> 
> 时间：2012-06-20T14:12:20.667
> 
> 标签：vba, excel

我的程序通过调用一些宏来工作：

```
Sub Start()

Call ClearAll
Call Sales_Download
Call Copy_Sales
Call Receipt_Download
Call Copy_Receipt
Call Copy1
Call Sales_Summary
Call Copy2
Call Receipt_Summary

End Sub 
```

我的程序在 copy2 处中断，它本质上是 copy1 的精确复制品，工作正常。当 copy2 自行运行时，它可以完美运行，但是当我尝试运行整个程序时，它会进行调试。粗线是调试发生的地方。

```
Sub Copy2()

 ' Copies all data from Receipt Download tab for each location, and saves in a seperate folder

Dim i As Long
Dim lngLastRow As Long, lngPasteRow As Long

'Find the last row to search through
lngLastRow = Sheets("Receipt_Download").Range("J65535").End(xlUp).Row

'Initialize the Paste Row
lngPasteRow = 2
Dim rng As Range
Dim c As Range
Dim endrow
Dim strName As String
Dim ws As Worksheet
Dim j As Long
endrow = Sheets("names").Range("A65000").End(xlUp).Row
Set rng = Sheets("names").Range("A2:A" & endrow)
j = 1
FBO = strName

For Each c In rng

For i = 2 To lngLastRow
    strName = c.Value
    If Sheets("Receipt_Download").Range("J" & i).Value = strName Then
        Sheets("Receipt_Download").Select
        Range("A" & i & ":IV" & i).Copy
        Sheets("Summary").Select
        Range("A" & lngPasteRow & ":IV" & lngPasteRow).Select
        ActiveSheet.Paste
        lngPasteRow = lngPasteRow + 1

    End If
Next i
j = j + 1
        Sheets("Receipt_Download").Select
        Rows("1:1").Select
        Selection.Copy
        Sheets("Summary").Select
        Rows("1:1").Select
        ActiveSheet.Paste
        Columns("D:E").Select
        Selection.NumberFormat = "m/d/yyyy"
        Sheets("Summary").Select
        Range("B25000").Select
        ActiveCell.FormulaR1C1 = "Grand Total"
        Range("B25000").Select
        Selection.Font.Bold = True
        Columns("G:G").Select
        Selection.Insert Shift:=xlToRight
        Range("G1").Select
        ActiveCell.FormulaR1C1 = "=IF(RC[-2]=0,""0"",RC[-1])"
        Range("G1").Select
        Selection.AutoFill Destination:=Range("G1:G24950")
        Range("G25000").Select
        ActiveCell.FormulaR1C1 = "=SUM(R[-24950]C:R[-1]C)"
        Range("G25000").Select
        Selection.Copy
        Range("F25000").Select
        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        Columns("G:G").Select
        Application.CutCopyMode = False
        Selection.Delete Shift:=xlToLeft
        Sheets("Summary").Select
        Range("F25000").Select
        Application.CutCopyMode = False
        Selection.Copy
        Sheets("Names").Select
        With Columns("B")
        .Find(what:="", after:=.Cells(1, 1), LookIn:=xlValues).Activate
        End With
        ActiveSheet.Paste
        Sheets("Summary").Select
        Range("b1:b30000").Select
        For Each Cell In Selection
        If Cell.Value = "" Then
        Cell.ClearContents
        End If
        Next Cell
        Range("b1:b30000").Select
        Selection.SpecialCells(xlCellTypeBlanks).EntireRow.Delete
        Sheets("Summary").Select
        Range("D2").Select
        Application.CutCopyMode = False
        Selection.Copy
        Sheets("Names").Select
        ***With Columns("C")
        .Find(what:="", after:=.Cells(1, 1), LookIn:=xlValues).Activate***
        End With
        ActiveSheet.Paste
        Sheets("Summary").Select
        Range("A1:Z5000").Select
        Selection.Copy
        Workbooks.Add
        ActiveSheet.Paste
        Range("A1").Select
        Application.CutCopyMode = False
        Selection.Copy
        Application.CutCopyMode = False
        File = "C:\Documents and Settings\user\Desktop\New FBO\" & strName & "\" & strName & " Receipts.xls"
        ActiveWorkbook.SaveAs Filename:=File, _
        FileFormat:=xlNormal, Password:="", WriteResPassword:="", _
        ReadOnlyRecommended:=False, CreateBackup:=False
        ActiveWorkbook.Close
        IngPasteRow = IngPasteRow + 1
        Sheets("Summary").Select
        Selection.ClearContents
Next c

End Sub 
```

我真的很感谢任何帮助，我当然不是 VBA 大师，这很麻烦。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:58:05.573

替换这部分代码

```
 Sheets("Summary").Select
 Range("D2").Select
 Application.CutCopyMode = False
 Selection.Copy
 Sheets("Names").Select
 With Columns("C")
 .Find(what:="", after:=.Cells(1, 1), LookIn:=xlValues).Activate
 End With
 ActiveSheet.Paste 
```

和

```
Dim lRow As Long

With Sheets("Names")
    lRow = .Range("C" & .Rows.Count).End(xlUp).Row + 1

    Sheets("Summary").Range("D2").Copy .Range("C" & lRow)
End With 
```

现在试试看。

还有一些tips

1.  避免它们是错误`.Select`的`.Activate`主要原因
2.  缩进并适当地注释您的代码。您的代码很难阅读。如果您不缩进/注释您的代码，您将意识到如果您在一周后访问它，您将无法识别您的 OWN 代码:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T15:05:38.723

为了支持上面 Siddharth 的回答，我已经采用了您的一部分代码（直到您的中断发生的位置），并缩进并避免了他提到的`.Select`and 。`.Activate`希望这能为您提供一个良好的开端，让您了解如何使您的代码更具可读性，以便于调试和理解。

```
For Each c In rng

    For i = 2 To lngLastRow

        strName = c.Value

        If Sheets("Receipt_Download").Range("J" & i).Value = strName Then

            Sheets("Receipt_Download").Range("A" & i & ":IV" & i).Copy _
                Destination:=Sheets("Summary").Range("A" & lngPasteRow & ":IV" & lngPasteRow)
            lngPasteRow = lngPasteRow + 1

        End If
Next i

j = j + 1

Sheets("Receipt_Download").Rows("1:1").Copy Destination:=Sheets("Summary").Rows("1:1")

With Sheets("Summary")

    .Columns("D:E").NumberFormat = "m/d/yyyy"

    With .Range("B25000")
        .Formula = "Grand Total"
        .Font.Bold = True
    End With

    .Columns("G:G").Insert Shift:=xlToRight

    With Range("G1")
        .FormulaR1C1 = "=IF(RC[-2]=0,""0"",RC[-1])"
        .AutoFill Destination:=Range("G1:G24950")
    End With

    With ("G25000")
        .FormulaR1C1 = "=SUM(R[-24950]C:R[-1]C)"
        .Copy
    End With

    .Range("F25000").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

    .Columns("G:G").Delete Shift:=xlToLeft

    .Range("F25000").Copy Destination:=Sheets("Names").Columns("B").Find(what:="", after:=Sheets("Names").Cells(1, 1), LookIn:=xlValues)

End With 
```

# java - 这个链表有什么问题？

> ID：11121525
> 
> 赞同：4
> 
> 时间：2012-06-20T14:12:33.410
> 
> 标签：java, linked-list

任务是编写一个函数来交换列表中的 2 个节点。如果该函数可以不考虑顺序交换节点，则奖励 10%。我认为无论列表中的顺序如何，我的实现都能够交换 2 个元素，但我仍然没有收到奖励分数。有什么我想念的吗？

我得到了一个通用节点类，

```
public class Node<T> {
    public T val;
    public Node<T> next;

    public Node(T val) {
        this.val = val;
        this.next = null;
    }
} 
```

我还得到了一个定义如下的接口，

```
public interface SwapList<T> {

    public void add(T val);

    /**
     * Swaps two elements in the list, but only if @param val1 comes BEFORE @param
     * val2\. Solve the problem regardless of the order, for 10% extra. list: A B
     * C -> swap(A,B) will result in the list B A C list: A B C -> swap(B,A)
     * will not swap. list: A C C -> swap(A, D) will throw a
     * NoSuchElementException list: A B C B -> swap (A, B) will result in the
     * list B A C B list: A B C A B B -> swap (A,B) will result in the list B A
     * C A B B a list with one or zero elements cannot do a swap
     */
    public void swap(T val1, T val2);

    public T get(int i);
} 
```

我有我自己的这个接口的实现，如下所示，

```
import java.util.NoSuchElementException;
public class SwapListImpl<T> implements SwapList<T> {

    private Node<T> head;
    private Node<T> tail;
    private int counter;

    public SwapListImpl() {
        head = null;
        tail = null;
        counter = 0;
    }

    @Override
    public void add(T val) {
        Node<T> node = new Node<T>(val);
        if (head == null) {
            head = node;
            tail = node;
        } else {
            tail.next = node;
            tail = node;
        }

        counter++;
    }

    @Override
    public void swap(T val1, T val2) {

        if (counter < 2 || val1.equals(val2))
            return;

        Node<T> current = head;
        Node<T> currentPrev = null;

        Node<T> first = head;
        Node<T> firstPrev = null;
        Node<T> firstNext = first.next;

        Node<T> second = head;
        Node<T> secondPrev = null;
        Node<T> secondNext = second.next;

        boolean foundFirst = false;
        boolean foundSecond = false;
        boolean inOrder = false;

        while (current != null) {
            if (!foundFirst && current.val.equals(val1)) {

                firstPrev = currentPrev;
                first = current;
                firstNext = current.next;

                if (!foundSecond)
                    inOrder = true;

                foundFirst = true;

            }

            if (!foundSecond && current.val.equals(val2)) {

                secondPrev = currentPrev;
                second = current;
                secondNext = current.next;

                if (foundFirst)
                    inOrder = true;

                foundSecond = true;
            }

            if (foundFirst && foundSecond) {

                if (!inOrder) {
                    Node<T> temp = first;
                    first = second;
                    second = temp;

                    temp = firstPrev;
                    firstPrev = secondPrev;
                    secondPrev = temp;

                    temp = firstNext;
                    firstNext = secondNext;
                    secondNext = temp;
                }

                if (firstPrev == null) {

                    head = second;

                    if (first == secondPrev) {
                        second.next = first;
                        first.next = secondNext;
                    } else {
                        second.next = firstNext;
                        secondPrev.next = first;
                        first.next = secondNext;
                    }
                } else {

                    firstPrev.next = second;
                    first.next = secondNext;

                    if (first == secondPrev) {
                        second.next = first;
                    } else {
                        second.next = firstNext;
                        secondPrev.next = first;
                    }
                }

                break;
            }

            currentPrev = current;
            current = current.next;
        }

        if (!foundFirst || !foundSecond) {
            throw new NoSuchElementException();
        }
    }

    @Override
    public T get(int i) {
        if (i < counter) {
            Node<T> node = head;
            for (int n = 0; n < i; n++) {
                node = node.next;
            }
            return node.val;
        } else {
            throw new IndexOutOfBoundsException();
        }
    }
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T09:34:23.083

我认为问题在于交换本身：您忘记设置尾部。

这是针对该问题的一个小测试：

```
@Test
public void test() {
  SwapListImpl<String> list = new SwapListImpl<String>();
  list.add("A");
  list.add("B");
  list.add("C");

  list.swap("A", "C");

  assertEquals("C", list.get(0));
  assertEquals("C", list.getHead().val);
  assertEquals("B", list.get(1));
  assertEquals("A", list.get(2));
  assertEquals("A", list.getTail().val);

  list.add("D");

  assertEquals("C", list.get(0));
  assertEquals("C", list.getHead().val);
  assertEquals("B", list.get(1));
  assertEquals("A", list.get(2));
  assertEquals("D", list.get(3));
  assertEquals("D", list.getTail().val);

  list.swap("A", "C");

  assertEquals("A", list.get(0));
  assertEquals("A", list.getHead().val);
  assertEquals("B", list.get(1));
  assertEquals("C", list.get(2));
  assertEquals("D", list.get(3));
  assertEquals("D", list.getTail().val);

  list.swap("C", "B");

  assertEquals("A", list.get(0));
  assertEquals("A", list.getHead().val);
  assertEquals("C", list.get(1));
  assertEquals("B", list.get(2));
  assertEquals("D", list.get(3));
  assertEquals("D", list.getTail().val);
} 
```

你看我在列表中添加了两种方法，用于获取头部和尾部，但这并不重要 - 如果没有对头部和尾部的显式测试，测试甚至会失败。列表的额外方法非常简单：

```
 public Node<T> getTail() {
      return this.tail;
    }

    public Node<T> getHead() {
      return this.head;
    } 
```

当交换列表的最后一个元素然后添加另一个元素时，会出现不设置tail的问题。

这是实际交换的固定版本：

```
 if (foundFirst && foundSecond) {

    if (second == this.tail) {
      this.tail = first;
    } else if (first == this.tail) {
      this.tail = second;
    }

    if (first == this.head) {
      this.head = second;
    } else if (second == this.head) {
      this.head = first;
    }

    if (firstPrev == second) {
      first.next = second;
    } else {
      if (firstPrev != null) {
        firstPrev.next = second;
      }
      first.next = secondNext;
    }
    if (secondPrev == first) {
      second.next = first;
    } else {
      if (secondPrev != first && secondPrev != null) {
        secondPrev.next = first;
      }
      second.next = firstNext;
    }
    break;
  } 
```

你看我没有在你的代码中添加行——而是我用另一种方式编写了代码。我认为它更具可读性，但您也可以尝试以正确的方式设置尾部。但它对我来说太复杂了，所以我降低了代码的复杂性——这就是我重写它的原因。

我建议您将 first 和 second 用于第一次/第二次出现，而不是用于第一次/第二次参数。我认为这将提高该方法的可读性。但这是另一点;-)

希望有帮助 - 所以恕我直言，订单不是问题，而是问题。

# wcf - Soap UI 不再触发我的 WCF 服务中的断点

> ID：11121532
> 
> 赞同：0
> 
> 时间：2012-06-20T14:12:51.383
> 
> 标签：wcf, debugging, soapui

我最近在我的解决方案中对一个项目进行了一些参考添加，并对 web.config 进行了一些更改，以便在我的代码中使用另一个 WCF 服务，而不使用“添加服务参考”向导，以防止需要继续更新参考，以防它发生变化。由于执行此 SOAP UI 在我使用它来测试我的代码响应时不再触发我的服务中的断点。它曾经完美地工作。我可以改变什么导致这种行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T15:57:58.693

您可以手动配置要启动和调试的内容。

1.  右键单击您的解决方案
2.  属性 -> 启动项目
3.  检查多个启动项目
4.  操作 -> 为您的 GUI 和 WCF 项目启动

这将使调试器附加到这些进程并启用断点。

# gwt - ClickHandler 不会在 jquery-mobile 页眉和页脚中触发

> ID：11121535
> 
> 赞同：0
> 
> 时间：2012-06-20T14:13:05.267
> 
> 标签：gwt, jquery-mobile

经过数小时的搜索和尝试，我决定在这里问。

**JqmHeader.java**

```
public class JqmHeader extends ComplexPanel {

    public JqmHeader() {
        setElement(DOM.createDiv());
        getElement().setAttribute("data-role", "header");
    }

    public void add(Widget widget) {
        super.add(widget, getElement());
    }
} 
```

**JqmPage.java**

```
public class JqmPage extends ComplexPanel {
    ...

    public JqmPage(String id) {
        setElement(Document.get().createDivElement());
        getElement().setAttribute("data-role", "page");
        getElement().setAttribute("data-url", id);

        RootPanel.get().add(page);
        render(page.getId());
    }

    private native void render(String id) /*-{
        $wnd.$("#" + id).page();
    }-*/;

    ...
} 
```

**MyPage.java 扩展了 JqmPage.java**

```
...

JqmHeader header = new JqmHeader();
Button b = new Button("TestButton");

b.addClickHandler(new ClickHandler() {
    @Override
    public void onClick(ClickEvent event) {
        Window.alert("TestButton clicked");
    }
});

header.add(b);
this.add(header);

... 
```

**我的问题**

所以，我的问题是，标题栏中 Button 的 ClickHandler 不会触发。如果我不将按钮添加到标题，而是添加到“RootPage”，例如

```
this.add(b) 
```

，一切正常。

我认为它必须在于 jquery-mobile 标头实现。有什么解决方法/想法吗？

来自柏林的感谢，亚历克斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T17:28:23.307

如果您想查看用于构建移动应用程序的纯 GWT 解决方案，您可以查看[http://www.m-gwt.com](http://www.m-gwt.com)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-21T18:06:02.640

JQuery Mobile 吞下标头上的事件，因此它们不会传播到 GWT。我在为 jqm4gwt (https://github.com/sksamuel/jqm4gwt) 解决这个问题时所做的是在页面级别有一个通用监听器，然后比较事件源。如果它是标题中的按钮，那么我会手动触发该按钮上的事件。

看看[https://github.com/sksamuel/jqm4gwt/blob/master/src/main/java/com/sksamuel/jqm4gwt/JQMPage.java中的 bindHeaderEvents](https://github.com/sksamuel/jqm4gwt/blob/master/src/main/java/com/sksamuel/jqm4gwt/JQMPage.java)

此外，jqm4gwt 项目可能是一个很好的解决方案，让您不必自己发明所有这些小部件。

# xcode - 如何安装最新版本的apple llvm 编译器？

> ID：11121538
> 
> 赞同：1
> 
> 时间：2012-06-20T14:13:18.683
> 
> 标签：xcode, llvm

我是 iOS 开发的新手。我最近在一篇文章中偶然发现了新的objective-c 集合文字语法，并且我希望能够使用该语言的新版本。如何安装最新版本的苹果 llvm 编译器而无需安装 xCode 的最新版本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T15:26:40.383

[您可以在llvm.org](http://llvm.org)上与 Xcode 分开获取 LLVM ，但您可能会发现一些新功能在没有 IDE 和框架支持的情况下无法正常工作。

# configuration - redis.conf 包括：“错误的指令或错误的参数数量”

> ID：11121540
> 
> 赞同：4
> 
> 时间：2012-06-20T14:13:27.603
> 
> 标签：configuration, redis

我已经为 redis [/etc/redis/map.conf] 创建了这个配置：

```
include /etc/redis/ideal.conf
port 11235
pidfile /var/run/redis-map.pid
logfile /var/log/redis/map.log
dbfilename map.rdb 
```

如您所见，它包括/etc/redis/ideal.conf；这个文件确实存在，我们有读取权限。还有另一个文件，略有不同；考虑 [/etc/redis/storage.conf]：

```
include /etc/redis/ideal.conf

pidfile /var/run/redis-storage.pid
port 8000
bind 192.168.0.3
logfile /var/log/redis/storage.log
dbfilename dump_storage.rdb 
```

我的问题是：我可以使用**storage.conf**启动 redis-server （一切正常），但**map.conf**导致以下错误：

```
Reading the configuration file, at line 1
>>> 'include /etc/redis/ideal.conf'
Bad directive or wrong number of arguments
failed 
```

redis的版本是2.2。

我哪里做错了？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-21T07:13:37.480

对不起大家。

我正在使用不同的 Redis 实例。

**storage.conf**的实例由 /usr/local/bin/redis-server 启动，但**map.conf**由 /usr/bin/redis-server 启动；第二个坏了。

还是非常感谢。

# jdbc - JBoss AS7 无法部署 Postgresql JDBC 4 驱动程序

> ID：11121544
> 
> 赞同：0
> 
> 时间：2012-06-20T14:13:31.487
> 
> 标签：jdbc, jboss7.x, postgresql-9.1

我使用部署方法在 JBoss AS7 中安装了 Postgresql JDBC 驱动程序，方法是将 postgresql-9.0-802.jdbc4.jar 放入你的standalone/deployments/ 目录。当我使用standalone.sh 启动AS7 时，出现以下错误。请注意，它调用了“org_postgresql”，这让我认为它是某个地方的错误配置文件。我已经在我的项目和 AS7 安装中的所有文件中进行了搜索，但其中没有一个包含“org_post”。

我在 postgresql-9.1-902.jdbc4.jar 中遇到同样的错误。

有没有其他人能够使用 Postgresql JDBC 驱动程序的部署方法？

```
22:55:31,259 INFO [org.jboss.as.controller] (Controller Boot Thread) JBAS014774: Service status report
JBAS014775: New missing/unsatisfied dependencies:
service jboss.jdbc-driver.org_postgresql (missing) dependents: [service jboss.data-source.java:jboss/kfv6DS_auth] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T04:05:39.217

部署方法坏了。将驱动程序作为核心模块安装可以解决这个问题。

# sql-server - 如何使用两个同名但结构不同的临时表

> ID：11121554
> 
> 赞同：0
> 
> 时间：2012-06-20T14:14:10.353
> 
> 标签：sql-server, tsql, foxpro

以下是我的逻辑应该做的

```
IF @id = 1
BEGIN
  SELECT * INTO #abc from table1
END

IF @id = 2
BEGIN
  SELECT * INTO #abc frm table2
END 
```

但是，当我执行我的语句时，我收到错误消息

> 已经有一个名为#abc..的对象

请问有什么建议可以克服这个错误吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T14:19:47.690

你不能。解析器不理解您的`IF`逻辑，它将两个`SELECT INTO`语句都视为*将要*发生的事情。

你应该做的是：

```
IF @id = 1
BEGIN
SELECT * INTO #abc1 from table1
END

IF @id = 2
BEGIN
SELECT * INTO #abc2 frm table2
END

IF @id = 1
  SELECT * FROM #abc1;
ELSE
  SELECT * FROM #abc2; 
```

毕竟，您需要知道#temp 表中的不同列才能对其执行任何有意义的操作，对吧？

（或者完全避免使用临时表。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T14:18:57.610

另一种可能的解决方案：

```
CREATE TABLE #abc (
 --put schema here
)

IF @id = 1
BEGIN
  insert into #abc
  select * from table1
END

IF @id = 2
BEGIN
  insert into #abc
  select * from table2
END

select * from #abc

drop table #abc; 
```

您应该始终使用列名，而不是`*`因为它在性能方面更好。

并且，`select *`查找当前表中的所有列，表结构的更改，例如添加、删除或重命名列，会自动修改结果`select *`。单独列出列可让您更精确地控制结果。

# iphone - NSManagedObject 不兼容的指针类型警告

> ID：11121556
> 
> 赞同：2
> 
> 时间：2012-06-20T14:14:20.337
> 
> 标签：iphone, objective-c, core-data, ios5, nsmanagedobjectcontext

首先让我确定我有 X-Code 4.3.2 版本和 iOS 5.1 SDK。我的项目中有以下用于核心数据操作的方法。两种方法都给出相同的警告。即**“从结果类型为'NSManagedObject <Protocol>的函数返回'NSManagedObject *'的不兼容指针类型”**。

**方法一：**

```
- (NSManagedObject<Protocol> *)newMOforNilMOC 
{
    return [[NSManagedObject alloc] initWithEntity:[self entityDescription] insertIntoManagedObjectContext:nil];
} 
```

对于方法**方法 A**，我只是进行类型转换并添加 (NSManagedObject<Protocol>*) 然后警告被删除，如下所述。

```
- (NSManagedObject<Protocol> *)newMOforNilMOC 
{
    return  (NSManagedObject<Protocol> *) [[NSManagedObject alloc] initWithEntity:[self entityDescription] insertIntoManagedObjectContext:nil];
} 
```

**方法B：**

```
+ (NSManagedObject<Protocol> *) newInContext:(NSManagedObjectContext *)context 
    {   
        return [[NSEntityDescription insertNewObjectForEntityForName:[[(NSManagedObject<Protocol> *)self class] entityName]                                     inManagedObjectContext:context]retain]; 
    } 
```

对于**方法 B**，当我进行类型转换时它不起作用，因此我只是将方法的名称从 newInContext 更改为 AddnewInContext （在谷歌搜索时在某处找到）然后警告被删除。

我有以下问题：

1.  如果第一种方法需要类型转换，那么为什么第二种方法不适用于该解决方案？
2.  更改方法名称的确切含义是什么。这是删除上述警告的正确方法吗？**为什么类型转换在方法 B**中不起作用 ？

这可能很复杂，但如果您有任何疑问，请随时发表评论。因为我想知道区别，至少我可以学习一些关于核心数据的新东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:51:57.800

我认为您在类方法中使用“自我”。您应该使用该类本身。让我通过代码显示

```
+ (NSManagedObject<Protocol> *) newInContext:(NSManagedObjectContext *)context 
{   
        //Usage of [self class] is not correct, as self points already to a class.
        NSEntityDescription* desc = [NSEntityDescription entityForName:@"myObjectName" inManagedObjectContext:context];
        return [[NSEntityDescription insertNewObjectForEntityForName:desc inManagedObjectContext:context]retain]; 
} 
```

您不能将类类型转换为“id”类型，如果您在对象方法而不是类方法中，则 self 指向的类型。我认为任何方法重命名都不能解决任何警告。

# php - 数组内的while循环？

> ID：11121567
> 
> 赞同：0
> 
> 时间：2012-06-20T14:14:53.717
> 
> 标签：php, arrays, while-loop

我试图弄清楚我是否能够在数组内进行 while 循环

```
while($row = $retail -> fetch(PDO::FETCH_ASSOC)){

$json['data'][] = array(

'id'=>$row['idretailers'],
"category"=>$row['category'],
"headline"=>$row['headline'],
'price'=> array ("full_price" => $row['price']),
'description'=>$row['description'],
"comments" => array(
while($row_c = $comments -> fetch(PDO::FETCH_ASSOC)){

 // more items  
})
);
} 
```

评论中有一个while循环，这可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:20:52.033

您编写它的方式是不可能的，但是有一个简单的解决方案：

```
"comments" => $comments -> fetchAll(PDO::FETCH_ASSOC) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T14:49:24.157

由于您要将其插入 JSON 字符串，因此请执行以下操作：

```
while($row = $retail -> fetch(PDO::FETCH_ASSOC)){

    $json['data'][] = array(

        "id"=>$row['idretailers'],
        "category"=>$row['category'],
        "headline"=>$row['headline'],
        "price"=> array ("full_price" => $row['price']),
        "description"=>$row['description'],
        "comments" => $comments->fetchAll()
    );
} 
```

否则，您可以在评论中调用[implode ：](http://php.net/manual/en/function.implode.php)

```
while($row = $retail -> fetch(PDO::FETCH_ASSOC)){

    $json['data'][] = array(

        "id"=>$row['idretailers'],
        "category"=>$row['category'],
        "headline"=>$row['headline'],
        "price"=> array ("full_price" => $row['price']),
        "description"=>$row['description'],
        "comments" => implode("\n", $comments->fetchAll());
    );
} 
```

# algorithm - 事件过滤和触发算法

> ID：11121568
> 
> 赞同：2
> 
> 时间：2012-06-20T14:14:55.603
> 
> 标签：algorithm, events, stream, complex-event-processing

这是我手头的问题-

我有一系列“较低级别”事件流（并发数据库记录创建），例如 - “Matt 在承诺（维度）中获得 4* 评级”......并且具有预定义的“较高级别”事件标准，例如 - “如果某人在承诺中获得 4* 评级并且在指导中获得 >=3*”，则触发该事件。这将发生在整个系统中的任意 (N) 个用户（Mat 和他的伙伴）上。

处理它的正确方法是什么。首先想到的是 CEP（复杂事件处理）。伙计们，任何建议/指针将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:47:24.557

严格来说，这不是针对您的问题的算法，而是针对您的程序设计的算法。有一个相关的想法叫做[基于事件的组件](http://ebclang.codeplex.com/)。这有助于您设计与传统的请求-响应设计不同的事件驱动系统。也许您会发现这在您的应用程序设计中很有用。

# java - 如何对嵌套 JSON 数组进行排序？

> ID：11121570
> 
> 赞同：0
> 
> 时间：2012-06-20T14:15:01.467
> 
> 标签：java, json, multidimensional-array

如何对嵌套 JSON 数组进行排序？就像下面的 JSON...

```
{
    "id":"rtmc05.lax.someabc.net",
    "name":"rtmc05.lax.someabc.net",

    "tenants":[{
        "id":"rtmc",
        "name":"rtmc"
    },{
        "id":"hrs",
        "name":"hrs"
    },{
        "id":"amotelbe1",
        "name":"amotelbe"
    },{
        "id":"cds",
        "name":"cds"
    },{
        "id":"idx-server",
        "name":"idx-server",

        "tenants":[{
            "id":"amotelbe",
            "name":"amotelbe",

            "tenants":[{
                "id":"amotelui",
                "name":"amotelui"
            }]
        }]
    }]
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:51:51.817

您的问题有一些隐含的部分，目前尚不清楚您在哪里遇到问题：

1.  如何获取 JSON 字符串并从中生成可用的 Java 对象。（我假设是 Java，而不是 JavaScript，因为你已经用“java”标记了你的问题。）
2.  制作完成后如何对这些物品进行分类？
3.  您如何处理嵌套零件的排序？（在您的示例中，“idx-server”有子租户。）

不确定您到底遇到了哪些问题，所以这里有一些关于这三个方面的注意事项。

第 1 部分：获取 Java 对象

我同意另一个人的观点，[Jackson](http://jackson.codehaus.org/)是一个很好的 JSON 解析器。这里有几行代码可以用来解析一些 JSON：

```
String jsonString = "..."; // Load this in whatever way makes sense for you
ObjectMapper mapper = new ObjectMapper();
Map<String,Object> parsedJson = mapper.readValue(jsonString, Map.class); 
```

如果您的 JSON 字符串真的很大，那么`readValue`您可以使用其他重载来避免将整个字符串读入内存。

第 2 部分：对 Java 对象进行排序

一旦你得到了解析的 JSON，排序只是一个调用的问题[`Collections.sort(...)`](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#sort%28java.util.List,%20java.util.Comparator%29)，传入`tenants`数组。另外，您需要编写一个[Comparator](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)来定义您想要的排序。例如，这是一个按名称排序的比较器：

```
public class NameComparator implements Comparator<Map<String,Object>> {
    public int compare(Map<String,Object> o1, Map<String,Object> o2) {
        String name1 = (String) o1.get("name");
        String name2 = (String) o2.get("name");
        return name1.compareTo(name2);
    }
} 
```

然后你取出租户数组（杰克逊将它们变成[`ArrayList`](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)对象）并调用[`Collections.sort(...)`](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#sort%28java.util.List,%20java.util.Comparator%29). 例如，

```
List<Map<String,Object>> tenants =
        (List<Map<String,Object>>) parsedJson.get("tenants");
Collections.sort(tenants, new NameComparator()); 
```

第 3 部分：处理嵌套

最清晰的方法是添加一些额外的代码来遍历您的 JSON 以查找具有租户数组的任何对象，并对其进行排序。例如，这是一个应该执行此操作的递归函数：

```
public static void recursiveSortTenants(Map<String,Object> jsonObject) {
    List<Map<String,Object>> tenants =
            (List<Map<String,Object>>) jsonObject.get("tenants");
    if (tenants != null) {
        Collections.sort(tenants, new NameComparator());
        // For each tenant, see if it has sub-tenants.  If so,
        // call this function again to sort them.
        for (Map<String,Object> tenant : tenants) {
            if (tenants.containsKey("tenants")) {
                recursiveSortTenants(tenant);
            }
        }
    }
} 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T14:20:10.097

将其解析为（javascript）对象，然后编写一个排序函数，对此类 javascript 对象的数组进行排序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T14:23:58.243

将其反序列化为 POJO（使用[Gson](http://code.google.com/p/google-gson/)或[Jackson](http://jackson.codehaus.org/) ），并为这些 POJO编写一个[比较器。](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)

# android - 如何通过 DropboxAPI 对象从一个 Activity 到另一个

> ID：11121571
> 
> 赞同：0
> 
> 时间：2012-06-20T14:15:03.050
> 
> 标签：android, api, authentication, android-activity, dropbox

我想要第二个 Activity 使用 DropboxAPI 对象（此处为 mApi）并调用 Dropbox api 方法....

我怎么能通过它....

```
basket.putParcelable("key", mApi); 
```

篮子是一个 Bundle 对象..

出现错误“Bundle 类型中的 putParcelable(String, Parcelable) 方法不适用于参数 (String, DropboxAPI)”

会铸造工作吗？`basket.putParcelable("key", (Parcelable) mApi);`

可以打包发送吗？？

请帮忙...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:24:31.813

如果`DropboxAPI<AndroidAuthSession>`该类不在`implement Parcelable`其代码中，则不能将其放入`Intent`. 您只能放置`Parcelable`对象。如果您有权访问源代码，则应使其实现`Parcelable`.

这是一个[很好](http://developer.android.com/reference/android/os/Parcelable.html)的起点

# installshield-2012 - 如何从 InstallShield 2012 检查 .NET 4？

> ID：11121574
> 
> 赞同：1
> 
> 时间：2012-06-20T14:15:09.690
> 
> 标签：installshield-2012

我通常在 WIX-land 而不是 InstallShield。

`NETFRAMEWORK40FULL`InstallShield 中的等价物是什么？有没有更好的方法从 InstallShield 2012 检查 .NET 4.0？

请注意：我对从安装程序安装它不感兴趣。只是一个简单的测试，通知用户他们需要在继续之前安装 .NET 4.0。

编辑：我可以使用引导程序，但如果有本地的 InstallShield 方式，我宁愿不这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T14:32:20.767

我在InstallShield 上做的不多。我希望[这](http://kb.flexerasoftware.com/selfservice/documentLink.do?externalID=Q209084)可以解决您的疑问。

# c# - 基于可见区域百分比的自动滚动的 TableLayoutPanel 高度

> ID：11121577
> 
> 赞同：0
> 
> 时间：2012-06-20T14:15:16.000
> 
> 标签：c#, winforms, tablelayoutpanel

我有一个自动滚动的 TableLayoutPanel，我正在向其中动态添加行。我希望每行的高度是 TableLayoutPanel 可见区域的 1/3，即在添加第 4 个面板和自动滚动启动之前面板的原始高度。我可以计算手动到达行的高度并将其设置为绝对高度，但可以调整 TableLayoutPanel 的大小。在那种情况下，我可以处理调整大小的事件并重新计算每行的绝对高度，但我想知道是否有更好的方法。有没有办法将行高指定为可见面板区域的百分比，还是我应该手动计算，绝对高度路线？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:35:53.710

[TableLayoutPanel.RowStyle.Percent](http://msdn.microsoft.com/en-us/library/system.windows.forms.tablelayoutpanel.rowstyles.aspx)

行高被解释为表格高度的百分比

如果您有一个有 2 行的表，每行占面板的 50% - 并希望添加第三行，将所有行调整为 33%：

```
 tableLayoutPanel1.RowCount = 3;
    this.tableLayoutPanel1.RowStyles[0].Height = 33F;
    this.tableLayoutPanel1.RowStyles[1].Height = 33F;
    this.tableLayoutPanel1.RowStyles.Add(new RowStyle(SizeType.Percent, 33F)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T18:10:05.233

我最终在自上而下的 FlowLayoutPanel 中实现了我需要的东西，锚定了 Top、Down、Left 和 Right，以便它可以根据表单调整大小。第一个子面板被添加到 FlowLayoutPanel 并分配一个略小于 FLP 宽度的宽度。每个后续的子面板都被赋予了一个 Dock 样式的填充，因此它的宽度会自动匹配第一个面板。每个面板都分配了 FLP.Height / 3 的高度，我有一个 FLP 的调整大小事件的处理程序，以根据需要重新计算子面板的高度。

感谢所有评论和回答的人。我赞成您的回答，因为它们对其他人有帮助，只是没有解决我的特定问题。

# c# - C# 中的 Flash 样式补间/缓动函数

> ID：11121578
> 
> 赞同：1
> 
> 时间：2012-06-20T14:15:16.890
> 
> 标签：c#, tween

[C# 中的 Flash 样式补间/缓动函数](http://theinstructionlimit.com/flash-style-tweeneasing-functions-in-c)

我今天在网上看到了这篇文章。有没有人有过使用补间/缓动的经验，因为我很想知道在 C# 编程中使用它的地方？可以在 WinForms 中使用吗？您将使用什么应用程序模板？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T14:27:35.023

您可以使用 StoryBoards 创建自己的动画，Blend 非常好用 WPF 中的时间线来做到这一点，但如果您问是否有类似 GreenSock 的库：我不知道......

# git - git不会“添加”子目录

> ID：11121580
> 
> 赞同：1
> 
> 时间：2012-06-20T14:15:21.327
> 
> 标签：git

OSX 上的 git 看到修改后的子目录，但不会“添加”它；我怎样才能解决这个问题？谢谢！（我不相信该子目录中有任何打开的文件）

```
~/gitrepo/python: git status
# On branch br1
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory)
#   (commit or discard the untracked or modified content in submodules)
#
#   modified:   v0/mage-Upload (modified content)
#
no changes added to commit (use "git add" and/or "git commit -a")
~/gitrepo/python: git add v0
~/gitrepo/python: git add v0/mage-Upload    <-- I guess that was unnecessary
~/gitrepo/python: git diff
diff --git a/v0/mage-Upload b/v0/mage-Upload
--- a/v0/mage-Upload
+++ b/v0/mage-Upload
@@ -1 +1 @@
-Subproject commit 7c377092f1f5cbbeecc03ebb533259c23606506e
+Subproject commit 7c377092f1f5cbbeecc03ebb533259c23606506e-dirty
~/gitrepo/python: git commit -a
# On branch br1
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory)
#   (commit or discard the untracked or modified content in submodules)
#
#   modified:   v0/mage-Upload (modified content)
#
no changes added to commit (use "git add" and/or "git commit -a") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T14:18:40.077

尝试将其从缓存中删除，然后重新添加

```
git rm --cached v0
git add v0 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T23:33:29.050

您显然在“v0/mage-Upload”中有一个子模块 - 您需要在“超级模块”中的更改之前处理子模块中的更改。执行以下操作：

```
cd vo/mage-Upload
git status
git commit    # Careful if the submodule is not on a branch
              #   see 'git submodule' documentation
git push ...  # Specific to your submodule 
```

此时您可以返回“超级模块”并将更改提交到子模块引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T00:12:56.437

mage-Upload 是一个 Git 子模块。您应该执行以下操作：

```
cd vo/mage-Upload
git commit -a (or whatever you want to commit)
cd ../..
git commit -a 
```

这将提交子模块中的任何更改，然后将新的子模块版本提交到主存储库。

# javascript - Function.prototype.call.bind 是如何工作的？

> ID：11121586
> 
> 赞同：32
> 
> 时间：2012-06-20T14:15:45.967
> 
> 标签：javascript, prototype

我在理解这个函数时遇到了一些麻烦：

```
var toStr = Function.prototype.call.bind( Object.prototype.toString );
toStr([]) // [object Array]​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

这个函数如何接受第 2 行中的参数？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-20T14:20:02.003

出色地，

*   `Function.prototype.call`引用“call”函数，该函数用于调用具有选定`this`值的函数；
*   随后`.bind`指的是函数原型上的“绑定”函数（请记住：“调用”也是一个函数），它返回一个始终`this`设置为传入参数的新函数。
*   传递给“bind”的参数是对象原型上的“toString”函数，因此整个表达式的结果是一个新函数，它将运行“call”函数并`this`设置为“toString”函数。

因此，结果类似于以下代码：`Object.prototype.toString.call( param )`. 然后，“console.log”调用将该函数传递给一个数组，然后就可以了。

*编辑*请注意，当“param”是一个对象时，这`Object.prototype.toString.call( param )`就像`param.toString()`真的一样。如果不是，则“调用”函数的语义是以 JavaScript 的正常方式（数字 -> 数字，字符串 -> 字符串等）将其转换为一个。

*编辑，2016 年 5 月 24 日*— 上面的最后一句话在 ES2015 中不准确。当函数调用作为值涉及时，新的 JavaScript 运行时*不会“自动装箱”原始类型。*`this`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-20T14:20:18.650

我假设你已经知道做什么`.call`和`.bind`做什么

`toStr`现在是一个基本上可以做到的功能：

```
function toStr( obj ) {
    return Function.prototype.call.call( Object.prototype.toString, obj );
} 
```

即它`.call`是`.call`函数，其上下文参数设置为`.toString`函数。通常，该部分已被处理，因为您通常将`.call`其用作某些函数的属性，该函数将函数设置为`.call`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-20T14:33:51.080

这两行代码是一个函数定义，然后是该定义的执行调用，其中传递了一个空数组。复杂性在于解释“这”将指向什么以及为什么。

为了帮助推断这个值，我将下面两个链接中的内容复制到 MDN 的调用和绑定定义。

[bind](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind) () 函数创建一个新函数（绑定函数），其函数体与调用它的函数（绑定函数的目标函数）相同，并且 this 值绑定到 bind() 的第一个参数。您的代码看起来类似于绑定页面上描述的“快捷方式功能”。

```
var unboundSlice = Array.prototype.slice; // same as "slice" in the previous example
var slice = Function.prototype.call.bind(unboundSlice); 
```

// ...

切片（参数）；

> 使用[call](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/call)，您可以在调用现有函数时分配不同的 this 对象。this 指的是当前对象，即调用对象。通过 call，你可以编写一次方法，然后在另一个对象中继承它，而不必为新对象重写方法。

当 toStr 被调用时，它传入一个要绑定的数组，其中 this 指针被绑定。使用 bind()，这可以简化。

`toStr() is a bound function to the call() function of Function.prototype, with the this value set to the toStr() function of Array.prototype. This means that additional call() calls can be eliminated`.

本质上，它看起来像是 toString 方法的快捷函数覆盖。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-20T14:22:32.517

**bind()** - 创建一个新函数，当被调用时，它本身在提供的 this 值的上下文中调用这个函数，在调用新函数时，给定的参数序列在任何提供的参数之前。

[阅读此文档以获取有关 JavaScript 中的 bind() 的更多信息](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind)

角度示例：

我们定义了函数并将其绑定到对象的父组件：

```
public callback: object;

constructor() {
    this.callback= this.myFunction.bind(this);
}

public myFunction($event: any) {
    // Do something with $event ...
} 
```

（父 html）将绑定的对象传递给子组件：

```
<child-component (callbackFunction)="callback($event)"></child-component> 
```

接收绑定到父函数的对象的子组件：

```
@Output() callbackFunction: EventEmitter<object> = new EventEmitter<object>();

public childFunction() {
    ...
    this.callbackFunction.emit({ message: 'Hello!' });
    ...
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-04-05T16:13:14.963

**JS到英文翻译——**

> var toStr = Function.prototype.call.bind(Object.prototype.toString);

`bind`创建 的新`call`函数`Object.prototype.toString`。

现在您可以使用任何将应用于`Object.prototype.toString`.

像这样：

```
toStr([]) // [object Array]​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

* * *

为什么不直接打电话`Object.prototype.toString.call([])`？？

**回答：**

当然，你可以。但是 OPs 方法为此目的创建了一个专用的和去方法化的函数。

这真的被称为去方法化。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-06-15T11:40:34.983

你可以这样做：

```
var toStr = Object.prototype.toString.call([]); 
```

**问题是**：调用立即执行。你想要的是延迟调用的执行。

*由于函数在 Javascript 中也是一个对象，您可以使用任何函数作为“*调用*”中的第一个参数，而不是将对象作为第一个参数传递。*此外，您可以像在任何对象上一样使用调用点。

**Function.prototype.call.bind( Object.prototype.toString )**，复制调用函数，并将其“ **this** ”设置为*Object.prototype.toString*。您在“toStr”中保存了这个新的调用函数副本。

```
var toStr = Function.prototype.call.bind( Object.prototype.toString ); 
```

现在，您可以随时执行这个新的调用副本，而无需设置 'this'，因为它的 'this' 已经绑定到 Object.prototype.toString 。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-04-28T12:15:28.993

1.  这应该对你有意义

```
Object.prototype.toString.call([]) //work well 
```

2.  你觉得这个表格太长太麻烦，你想简化吗？这使得以后使用起来更容易：

```
const toStr = Object.prototype.toString.call
toStr([]) // unfortunately, this does not work 
```

3.  您需要使用`bind`来更正`this`指向的位置。

```
const toStr = Object.prototype.toString.call.bind(Object.prototype.toString)
toStr([]) //work well 
```

4.  `Object.prototype.toString.call`和`Function.prototype.call`

```
const toStr = Function.prototype.call.bind(Object.prototype.toString)
toStr([]) //done 
```

**概括**

```
function f(){console.log(this, arguments)} 
```

`f.call`和`Function.prototype.call.bind(f)`

`f.call(1,2,3)`和`Function.prototype.call.bind(f,1)(2,3)`

# velocity - 如何通过#include 在 Velocity 宏中包含静态或上传的文件

> ID：11121589
> 
> 赞同：5
> 
> 时间：2012-06-20T14:15:53.527
> 
> 标签：velocity

我正在尝试通过在随初始请求下载的 HTML 中内联一些 CSS 来优化一些移动网页（或更准确地是服务器请求的数量）。

这些页面来自我们基于 Vosao 的 CMS，并使用 Apache Velocity 宏。

正如预期的那样，这工作正常。

```
<link rel="stylesheet" type="text/css" media="screen" href="/file/downloads/contact.css" 
```

这失败了

```
<style>
#include( "/file/downloads/contact.css" )
</style> 
```

由于 Velocity 找不到文件，因此输出

```
org.apache.velocity.exception.ResourceNotFoundException: Unable to find resource '/file/downloads/contact.css' 
```

这在日志中

```
org.apache.velocity.runtime.log.CommonsLogLogChute log: ResourceManager : unable to find resource '/file/Downloads/contact.css' in any resource loader.
E 2012-06-20 13:59:19.688
org.apache.velocity.runtime.log.CommonsLogLogChute log: #include(): cannot find resource '/file/Downloads/contact.css', called at vm[line 7, column 3] 
```

我已经阅读了速度文档（关于资源 ROOT 属性），甚至花了一些时间在源代码上。我在加载时玩过这些属性......但没有运气。

我怎样才能让 Velocity 在我的 /war 目录中包含一个静态文件，或者让它从路径中包含？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-12-08T12:50:13.647

我已经成功地使用了这样的：

```
<style type="text/css">
  #include("my/path/to/file/file.css")
</style> 
```

也许您的文件路径错误？

# apache - .htaccess 基于多个条件的重定向

> ID：11121596
> 
> 赞同：0
> 
> 时间：2012-06-20T14:16:10.057
> 
> 标签：apache, .htaccess, mod-rewrite

我试图配置一个 .htaccess RewriteRule 并且我正在努力。

我有一个域`www.domain.com`

我正在尝试添加这些条件。

我正在尝试`www.domain.com/.htaccess`

```
if URL is www.domain.com with no path to file, redirect to www.domain.co.uk

if URL is www.domain.com AND has a path to file, no rewrite, allow.

if URL is www.domain.com AND has a path to file AND file doesnt exist, return 404

if URL points to a directory, return access forbidden 
```

他们是我的要求。

我已经尝试了很多东西。这是我的`.htaccess`

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^www.domain.com$ [NC]
RewriteRule ^(.*)$ http://www.domain.co.uk/$1 [R=301,L] 
```

此代码满足第一个约束。

但是我不知道如何检查路径是否存在，路径是否有效，或者它是否是目录。

一个完美的答案将是满足所有约束的代码并解释它是如何工作的。

我阅读 mod_rewrite 文档的次数比我愿意承认的要多:'(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:33:24.340

```
# Make sure / redirected to other domain
RewriteEngine On
RewriteCond %{HTTP_HOST} ^www\.domain\.com$ [NC]
RewriteRule ^/$ http://www.domain.co.uk [R=301,L]

# Make sure directory listings are forbidden
Options -Indexes 
```

请注意，您可以使用[`RedirectMatch`](http://httpd.apache.org/docs/2.0/mod/mod_alias.html#redirectmatch)，在这种情况下，这实际上优于重写

并且在您的情况下根本不需要处理文件 - 如果 URI 不是 /，则规则不适用，并且将执行常规文件处理（如果未找到 404 错误等...）

# java - 从 Windows 内存转储创建 Java 堆转储

> ID：11121599
> 
> 赞同：8
> 
> 时间：2012-06-20T14:16:13.597
> 
> 标签：java, debugging, heap-memory

我有一个 JVM 进程的 Windows 内存转储 (DMP) 文件。

> 有什么方法可以使用 Java 工具对此进行堆分析吗？SDK 工具（jhat 等）似乎没有帮助 - 他们似乎都期望 Java 堆转储。

（我有丰富的**Windbg**经验，但在 Java 调试方面我是一个完全无知的人）

这个类似的问题：[Dump file analysis of Java process?](https://stackoverflow.com/q/3883029/87427) 在这一点上没有答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-09-26T18:10:27.677

请参阅[我的另一个答案](https://stackoverflow.com/questions/3883029/dump-file-analysis-of-java-process/52523489#52523489)，即如何从 Windows minidump 获取 Java 信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-10T15:45:09.103

如果我正确理解了您的问题，那么我建议您使用 jconsole，您可以在 jdk 下找到。

你可以在这里找到 API

[http://docs.oracle.com/javase/6/docs/technotes/tools/share/jconsole.html](http://docs.oracle.com/javase/6/docs/technotes/tools/share/jconsole.html)

# java - 用@see 编写正确的javadoc？

> ID：11121600
> 
> 赞同：17
> 
> 时间：2012-06-20T14:16:14.607
> 
> 标签：java, javadoc

如何`@see`正确使用 javadoc？

我的意图是拥有一个带有抽象方法的抽象类。这些方法有 javadoc 注释。现在，如果我扩展抽象类，我会覆盖方法并希望使用`@see`.

`return`但是对于所有参数，例如`@see`链接似乎不起作用。Eclipse 仍然抱怨`expected @return tag`。

那么我该如何使用它呢？

```
public abstract class MyBase {
  protected abstract void myFunc();
}

class MyImpl extends MyBase {

  /**
   * @see MyBase#myFunc()
   */
  @Override
  protected void myFunc() { .. }
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2017-01-06T16:27:50.720

为了包含来自超类的文档，您应该使用`{@inheritDoc}`not `@see`。

然后你得到超类的文档。你可以添加到它，如果你需要的话，你可以覆盖诸如`@param`和之类的东西。`@return`

```
public abstract class MyBase {
  /**
   * @param id The id that will be used for...
   * @param good ignored by most implementations
   * @return The string for id
   */
  protected abstract String myFunc(Long id, boolean good);
}

class MyImpl extends MyBase {

  /**
   * {@inheritDoc}
   * @param good is used differently by this implementation
   */
  @Override
  protected String myFunc(Long id, boolean good) { .. }
} 
```

# java - 如何配置 Struts 2 上传文件夹？

> ID：11121604
> 
> 赞同：1
> 
> 时间：2012-06-20T14:16:24.737
> 
> 标签：java, tomcat, upload, struts2

目前，上传文件后，创建的 tmp 文件存储在：

> \Apache 软件基金会\Apache Tomcat 7.0.22\work\Catalina\localhost\Project\upload__78a0adab_1380z353bfa__7gfe_00000000.tmp

如何将其存储在我自己的自定义目录中？我试过了：

```
<param name="saveDir">/tmp</param> 
```

但它仍然适用于我上面提到的那个。

**编辑 1 - struts.xml：**

```
<action name="file_save" method="fileSave" class="FileActionBean">
            <interceptor-ref name="fileUpload">
                <param name="maximumSize">2097152</param>
                <param name="saveDir">/tmp</param>
                <param name="allowedTypes">
                    image/bmp,image/gif,image/jpeg,image/jpg,image/png
                </param>
            </interceptor-ref>
            <interceptor-ref name="defaultStack"></interceptor-ref>
            <result type="redirect">file</result>
        </action> 
```

**编辑2：**

我正在使用 struts 2 版本 2.1.8.1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T09:24:29.117

你用的是弹簧吗？在这种情况下，您可以使用所需的上传目录配置 ActionBean。只需添加到您的操作豆：

```
private String uploadDir;
public void setUploadDir(String uploadDir){
    this.uploadDir = uploadDir;
} 
```

并修改您的 spring 配置`applicationContext.xml`以设置 uploadDir。您可以通过直接设置值，或者更优选地通过配置文件来设置它，如下所示：

```
<bean id="fileAction" class="FileActionBean" scope="prototype">
    <property name="uploadDir" value="${uploaddir}" />
</bean> 
```

更新：

控制文件的保存位置非常容易。如果路径字符串的第一个字符不是 /，它将相对于您的“当前”目录。因此，如果要将其保存在 webapp 目录中，则实际上不需要任何“根”路径。简单明了：`File file = new File("results.txt");`

或者，如果您想将其存储在当前目录以外的其他位置，您可以使用导航`../../something`或只需将整个结构输入到您想要的位置：`File file = new File("/home/something/something/myFile.txt");`

或者在windows环境下你可以试试`File file = new File("Z:\\results\\results.txt");`

但是将上传的文件放在与 webapp 相同的目录中并不是一个好主意。然后，每次重新部署时，您都会丢失所有文件。

# r - 索引图表

> ID：11121607
> 
> 赞同：0
> 
> 时间：2012-06-20T14:16:37.927
> 
> 标签：r

```
 x = rnorm( 50, 0.5)
   y = rnorm(50, 0, 1) 
   plot(x, type='l',col="red")
   lines(y, col="green") 
```

我必须在图表中创建一个索引，解释红色代表对象 x，绿色代表 y 就像在 MS Excel 中一样，您可以在图表中创建一个小索引

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T14:20:25.047

当您说“索引”时，您的意思是传说吗？如果是这样，那么您可以使用该`legend`功能：

```
legend("topleft", col=2:3, legend=c("x", "y"), lty=1) 
```

查看相关的帮助文件——`?legend`了解更多信息。

# linux - 改变linux内存保护

> ID：11121608
> 
> 赞同：0
> 
> 时间：2012-06-20T14:16:39.633
> 
> 标签：linux, memory-management

有没有办法检查操作系统使用了哪个内存保护机制？

我有一个程序因分段错误而失败，在一台计算机（ubuntu）中但在另一台计算机（RH6）中没有。

一种解释是操作系统使用的内存保护机制。有没有办法可以找到/更改它？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T17:13:53.487

您可能想了解更多关于[虚拟内存](http://en.wikipedia.org/wiki/Virtual_memory)、[系统调用](http://en.wikipedia.org/wiki/System_call)、[Linux 内核](http://en.wikipedia.org/wiki/Linux_kernel)、[ASLR](http://en.wikipedia.org/wiki/ASLR)的信息。

然后你可以研究[mmap 和 munmap](http://linux.die.net/man/2/mmap)系统调用（还有[mprotect](http://linux.die.net/man/2/mprotect)）的作用和用法。它们是用于检索内存的系统调用（例如实现`malloc`& `free`），有时还有过时的系统调用`sbrk`（越来越没用）。

您应该使用`gdb` 调试器（它的`watch`命令可能很方便）和[valgrind](http://valgrind.org/)实用程序。[strace](http://linux.die.net/man/1/strace)也可能有用。

还要查看[/proc](http://linux.die.net/man/5/proc)伪文件系统的内部。试着理解什么

```
cat /proc/self/maps 
```

正在告诉你（关于运行该进程的进程`cat`）。也看里面`/proc/$(pidof your-program)/maps`

还可以考虑使用[pmap](http://linux.die.net/man/5/proc)实用程序。

如果它是您自己的源代码，请始终使用所有警告和调试信息对其进行编译，例如`gcc -Wall -Wextra -g`并对其进行改进，直到编译器不给出任何警告为止。使用`gcc` (ie 4.7) 和`gdb`(ie 7.4) 的最新版本。

# php - 将对象转换为数组 - 调用任何魔术方法？

> ID：11121613
> 
> 赞同：44
> 
> 时间：2012-06-20T14:16:52.497
> 
> 标签：php, arrays, object, casting

我有一个 Foo 类的对象：

```
class Foo extends Bar {
    protected $a;
    protected $b;
}

$obj = new Foo(); 
```

我想要（并且必须）做的是将此对象转换为数组，如下所示：

```
$arr = (array)$obj; 
```

目前是否有任何魔法（或不是魔法:)）方法被调用？或者有没有其他方法可以拦截？我知道我可以写一个简单的方法，例如。`asArray()`在 Foo 中，但我正在寻找一些更“原生”的 PHP 方式。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-12-27T13:15:57.263

## 不

PHP中没有`__toArray`神奇的方法。**2006 年**，一项[增强提案被拒绝](https://bugs.php.net/bug.php?id=38508)，答案如下：

 **> [2006-08-20 11:12 UTC] helly@php.net
> 
> 为什么不简单地将方法 asArray() 甚至作为接口的一部分：
> 
> 接口 ArrayConversion { 函数 asArray(); }
> 
> 看，我们有 __toString，因为它在 echo、print 和其他内部函数等语言结构中得到支持。但是我们已经决定反对数组的自动转换。因此，任何语言结构都不会支持它。也就是说，没有必要这样做，并且您不会赢得上述界面。事实上，你会让 php 变得更复杂，因为你只需要添加一个神奇的特性。

因此，它不太可能在未来的任何版本中实现（如果你问我，这很遗憾）。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2012-06-20T14:18:15.377

您可以让该类实现[`ArrayAccess`](http://us2.php.net/manual/en/class.arrayaccess.php)接口。这将允许您将对象视为数组而不进行强制转换，并且您可以完全控制成员的使用方式。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-06-20T14:22:53.783

可悲的是，没有，强制转换为数组不会触发任何魔术方法，就像它完成的那样：

```
$s = (string)$obj; 
```

哪个触发`__toString()`方法，您可以覆盖哪个。

但是，您可以编写自定义`toArray()`方法。

您可能还对[`Serializable`](http://www.php.net/manual/en/class.serializable.php)允许您编写自定义序列化器策略的接口感兴趣。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-12-28T16:41:31.740

不确定这个问题是否仍然相关，但 php 有内置[的 ArrayObject](http://php.net/manual/en/class.arrayobject.php)类，它允许将对象视为数组，并且在用作数据库记录或集合的容器时很方便。

就严格类型而言，这可能不是最佳实践，但它允许将对象视为数组，并且两个语句都是有效的。

```
$obj = new ArrayObject(['a' => 'alpha']);
var_dump($obj['a']); //alpha
var_dump($obj->getOffset('a'));//alpha 
```

但是，您需要牢记以下行为`ArrayObject`

```
$obj = new ArrayObject(['a' => 'alpha']);
//Access Property
var_dump($obj['a']); //alpha
var_dump($obj->offsetGet('a'));//alpha
var_dump($obj->a); //null Notice: Undefined property: ArrayObject::$a

//Serialization
var_dump(serialize($obj));// string 'C:11:"ArrayObject":41:{x:i:0;a:1:{s:1:"a";s:5:"alpha";};m:a:0:{}}' (length=65)
var_dump($obj->serialize());// string 'x:i:0;a:1:{s:1:"a";s:5:"alpha";};m:a:0:{}'
var_dump(serialize($obj) === $obj->serialize());// false !!!

//Setting Properties
$obj['b'] = 'beta'; //OK
$obj->c = 'gamma'; //value becomes object property!!!
var_dump($obj);
/* OBJECT DUMP
object(ArrayObject)[13]
  public 'c' => string 'gamma' (length=5)
  private 'storage' =>
    array (size=2)
      'a' => string 'alpha' (length=5)
      'b' => string 'beta' (length=4)
 */

//Property validation as array
var_dump(isset($obj['a']));//true
var_dump(isset($obj['b']));//true
var_dump(isset($obj['c']));//false
//Property validation as object
var_dump(isset($obj->a));//false
var_dump(isset($obj->b));//false
var_dump(isset($obj->c));//true

//Typecasting
var_dump((array)$obj);
/*
array (size=2)
  'a' => string 'alpha' (length=5)
  'b' => string 'beta' (length=4)
 */

//var_dump((string)$obj);// Catchable fatal error: Object of class ArrayObject could not be converted to string 
```

ArrayObject 接受两个标志`ArrayObject::STD_PROP_LIST`作为默认标志和`ArrayObject::ARRAY_AS_PROPS`备选标志。

这会改变读取值的行为，但不支持以这种方式设置新属性，下面是示例：

```
$obj = new ArrayObject(['a' => 'alpha'], ArrayObject::ARRAY_AS_PROPS);
//Access Property
var_dump($obj['a']); //alpha
var_dump($obj->offsetGet('a'));//alpha
var_dump($obj->a);//alpha

//Serialization
var_dump(serialize($obj));// string 'C:11:"ArrayObject":41:{x:i:0;a:1:{s:1:"a";s:5:"alpha";};m:a:0:{}}' (length=65)
var_dump($obj->serialize());// string 'x:i:0;a:1:{s:1:"a";s:5:"alpha";};m:a:0:{}'
var_dump(serialize($obj) === $obj->serialize());// false !!!

//Setting Properties
$obj['b'] = 'beta'; //OK
$obj->c = 'gamma'; //OK
var_dump($obj);
/* OBJECT DUMP
object(ArrayObject)[14]
  private 'storage' =>
    array (size=3)
      'a' => string 'alpha' (length=5)
      'b' => string 'beta' (length=4)
      'c' => string 'gamma' (length=5)
 */

//Property validation as array
var_dump(isset($obj['a']));//true
var_dump(isset($obj['b']));//true
var_dump(isset($obj['c']));//false !!!
//Property validation as object
var_dump(isset($obj->a));//true
var_dump(isset($obj->b));//true
var_dump(isset($obj->c));//true

//Typecasting
var_dump((array)$obj);
/*
array (size=2)
  'a' => string 'alpha' (length=5)
  'b' => string 'beta' (length=4)
 */ 
```

为了使这种行为更加一致，您必须扩展此类并实现魔术方法`__get()`、`__set()`和。`__isset()``__unset()`

另一个棘手的部分是序列化，默认方法`serialize`将返回一个副本序列化`$storage`变量而不是对象本身，作为返回实例的序列化副本的解决方法，您可以在`__toString`方法中实现默认序列化，这样它的行为正确。

```
class FooObject extends ArrayObject
{
    public function __get($index)
    {
        if ($this->offsetExists($index)) {
            return $this->offsetGet($index);
        } else {
            throw new UnexpectedValueException('Undefined key ' . $index);
        }
    }

    public function __set($index, $value)
    {
        $this->offsetSet($index, $value);
        return $this;
    }

    public function __isset($index)
    {
        return $this->offsetExists($index);
    }

    public function __unset($index)
    {
        return $this->offsetUnset($index);
    }

    public function __toString()
    {
        return serialize($this);
    }
} 
```

使用示例

```
$obj2 = new FooObject(['a' => 'alpha']);
//Access Property
var_dump($obj2['a']); //alpha
var_dump($obj2->offsetGet('a'));//alpha
var_dump($obj2->a); //alpha

//Serialization
var_dump(serialize($obj));// string 'C:11:"ArrayObject":41:{x:i:0;a:1:{s:1:"a";s:5:"alpha";};m:a:0:{}}' (length=65)
var_dump($obj->serialize());// string 'x:i:0;a:1:{s:1:"a";s:5:"alpha";};m:a:0:{}'
var_dump(serialize($obj) === $obj->serialize());// false !!!

//Setting Properties
$obj2['b'] = 'beta'; //OK
$obj2->c = 'gamma'; //OK
var_dump($obj2);
/* OBJECT DUMP
object(FooObject)[14]
  private 'storage' (ArrayObject) =>
    array (size=3)
      'a' => string 'alpha' (length=5)
      'b' => string 'beta' (length=4)
      'c' => string 'gamma' (length=5)
 */

//Property validation as array
var_dump(isset($obj2['a']));//true
var_dump(isset($obj2['b']));//true
var_dump(isset($obj2['c']));//true
//Property validation as object
var_dump(isset($obj2->a));//true
var_dump(isset($obj2->b));//true
var_dump(isset($obj2->c));//true

//Typecasting
var_dump((array)$obj2);
/*
array (size=3)
  'a' => string 'alpha' (length=5)
  'b' => string 'beta' (length=4)
  'c' => string 'gamma' (length=5)
 */ 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-17T14:31:31.277

在不更改原始类定义的情况下，一种方法是使用反射。这允许您在运行时检查类的属性。

取自手册：[http ://www.php.net/manual/en/reflectionclass.getproperties.php](http://www.php.net/manual/en/reflectionclass.getproperties.php)

```
<?php
class Foo {
    public    $foo  = 1;
    protected $bar  = 2;
    private   $baz  = 3;
}

$foo = new Foo();

$reflect = new ReflectionClass($foo);
$props   = $reflect->getProperties(ReflectionProperty::IS_PUBLIC | ReflectionProperty::IS_PROTECTED);

foreach ($props as $prop) {
    print $prop->getName() . "\n";
}

var_dump($props);

?>

The above example will output something similar to:
foo
bar
array(2) {
  [0]=>
  object(ReflectionProperty)#3 (2) {
    ["name"]=>
    string(3) "foo"
    ["class"]=>
    string(3) "Foo"
  }
  [1]=>
  object(ReflectionProperty)#4 (2) {
    ["name"]=>
    string(3) "bar"
    ["class"]=>
    string(3) "Foo"
  }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-05-05T10:23:04.637

您可以使用 get_object_vars($yourObject) 将返回从上下文可访问的所有属性名称/值的关联数组。

见[http://php.net/manual/en/function.get-object-vars.php](http://php.net/manual/en/function.get-object-vars.php)

如果您想访问受保护或私有属性，我的建议是扩展 ArrayObject，它实现方法 getArrayCopy()**

# objective-c - 使用 KVC 跨 n 键查找最小值

> ID：11121614
> 
> 赞同：0
> 
> 时间：2012-06-20T14:16:56.140
> 
> 标签：objective-c, ios, nsarray, kvc

再次卡在 Obj-C 中的 KVC 上。

我想使用 KVC 来找到多个键的最小值。

考虑以下数组：

```
NSArray *data = [[NSArray alloc] initWithObjects:
                 [NSDictionary dictionaryWithObjectsAndKeys:[NSNumber numberWithFloat:2.0], @"a", [NSNumber numberWithFloat:5.0], @"b", [NSNumber numberWithFloat:4.0], @"c", nil],
                 [NSDictionary dictionaryWithObjectsAndKeys:[NSNumber numberWithFloat:3.0], @"a", [NSNumber numberWithFloat:1.0], @"b", [NSNumber numberWithFloat:1.5], @"c", nil],
                 [NSDictionary dictionaryWithObjectsAndKeys:[NSNumber numberWithFloat:9.0], @"a", [NSNumber numberWithFloat:7.0], @"b", [NSNumber numberWithFloat:6.0], @"c", nil],
                 nil]; 
```

我可以通过以下方法轻松找到“a”、“b”或“c”的最小值：

```
float minKeyA = [[data valueForKeyPath:@"@min.a"] floatValue];  // value: 2.0
float minKeyB = [[data valueForKeyPath:@"@min.b"] floatValue];  // value: 1.0
float minKeyC = [[data valueForKeyPath:@"@min.c"] floatValue];  // value: 1.5 
```

我想要实现的是获取键的 NSSet 或 NSArray 并在这些键的池中找到最小值。

```
NSSet *keySet1 = [NSSet setWithObjects:@"a", @"b", nil]; 
// use to find absolute minimum value across keys 'a' and 'b' --> desired value 1.0
NSSet *keySet2 = [NSSet setWithObjects:@"a", @"c", nil];
// use to find absolute minimum value across keys 'a' and 'c' --> desired value 1.5
NSSet *keySet3 = [NSSet setWithObjects:@"a", @"b", @"c", nil];
// use to find absolute minimum value across keys 'a', 'b', and 'c' --> desired value 1.0 
```

感谢任何指针:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:30:14.947

一个天真的解决方案是首先找到每个键的最小值，然后在第二步中找到这些最小值中的最小值。

```
NSMutableSet *localMinima = [NSMutableSet setWithCapacity:[keySet1 count]];
for (NSString *key in keySet1) {
    NSString *keyPath = [NSString stringWithFormat:@"@min.%@", key];
    NSNumber *localMin = [data valueForKeyPath:keyPath];
    [localMinima addObject:localMin];
}
NSNumber *globalMin = [localMinima valueForKeyPath:@"@min.self"]; 
```

# ruby-on-rails-3 - Rails Devise 在 sqlite 上崩溃了 -> Mysql 升级

> ID：11121615
> 
> 赞同：0
> 
> 时间：2012-06-20T14:16:57.003
> 
> 标签：ruby-on-rails-3, devise

我有一个使用 Devise 进行用户身份验证的 rails 3.0.9 应用程序。它以前使用 SQLite，但我将应用程序的数据库更改为 MySQL。

切换到 MySQL 后，Devise 的用户注册功能停止工作。我在 rails 日志中没有收到错误消息。当新用户尝试注册时，他们只需在单击“提交”后被路由回注册页面。

我需要更改 Devise 配置文件中的任何数据库引用，以便让 Devise 与 MySQL 很好地配合使用？

我也不应该认为用户登录/注销在 MySQL 下工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T14:50:18.537

我刚刚意识到我在我的用户模型上添加了一个 before_save :default_values 过滤器。我最初这样做是为了在模型级别为某些属性设置默认值。相反，我在数据库级别运行了迁移设置默认值，从模型中删除了 before_save 调用，一切正常。

愚蠢的错误。希望这对其他人有帮助。

# java - Maven 找不到 persistence.xml

> ID：11121617
> 
> 赞同：0
> 
> 时间：2012-06-20T14:17:03.183
> 
> 标签：java, hibernate, gwt, jpa, guice

我试图做一个简单的 guice 持久性测试，不幸的是我得到了这个：

```
javax.persistence.PersistenceException: No Persistence provider for EntityManager named test
at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:54)
at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:32)
at com.google.inject.persist.jpa.JpaPersistService.start(JpaPersistService.java:94)
at utfpr.edu.br.client.PersistenceTestModule.getInjector(PersistenceTestModule.java:22)
at utfpr.edu.br.client.PessoaDaoTeste.<init>(PessoaDaoTeste.java:19)
at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
at org.junit.runners.BlockJUnit4ClassRunner.createTest(BlockJUnit4ClassRunner.java:187)
at org.junit.runners.BlockJUnit4ClassRunner$1.runReflectiveCall(BlockJUnit4ClassRunner.java:236)
at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
at org.junit.runners.BlockJUnit4ClassRunner.methodBlock(BlockJUnit4ClassRunner.java:233)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
at org.junit.runner.JUnitCore.run(JUnitCore.java:157)
at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:76)
at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:195)
at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:63)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at com.intellij.rt.execution.application.AppMain.main(AppMain.java:120) 
```

第一：我的 persistence.xml 位于正确的位置资源/META-INF 第二：是的，我放置了正确的提供程序：org.hibernate.ejb.HibernatePersistence

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T00:57:14.780

您的 persistence.xml 应该在运行时位于

```
WEB-INF/classes/META-INF/ . 
```

但是，放入开发文件夹 resources/META-INF/ 是正确的做法，但还不够。您必须确保资源文件夹在 Eclipse 中用作“源文件夹”。

要将文件夹用作源，请右键单击包资源管理器面板中的文件夹，然后右键单击上下文菜单 -> 构建路径 -> 用作源文件夹。

然后在 eclipse WTP 构建期间，Java 源文件将被编译并将它们的字节码类文件放入 WEB-INF/classes 文件夹中。

同时，在源构建路径中找到的非 Java 资源将被大量复制到 WEB-INF/classes 文件夹中 - 这是您的 JPA 驱动程序应该找到持久性 defn 文件的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T13:26:08.300

修复了我不知道为什么，但我修改了我的 pom.xml，通过以下方式更改了所有 guice 版本：

```
<version>${guice.version}</version> 
```

还有属性

```
<properties>
    <guice.version>3.0</guice.version>
</properties> 
```

它的工作原理，谢谢。

# c++ - 在 C++ 中进行字符串赋值的建议是什么？

> ID：11121625
> 
> 赞同：0
> 
> 时间：2012-06-20T14:17:47.387
> 
> 标签：c++, visual-c++

```
std::string s = t; 
```

我认为在此之后， s 和 t 指向同一个地址。

一旦`t`被删除，`s`也是空的。如何制作深拷贝？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-20T14:20:31.970

免责声明：我假设`t`也是一个`std::string`，如果我错了，请纠正我。

> 我认为在此之后， s 和 t 指向地址。

他们没有，他们不是指针。

> 一旦 t 被删除，s 也为空

`t`不能删除，或者如果你删除它，那是你的问题。不要删除`t`，它会自动超出范围。

在您的代码中，您使用`std::string`的复制构造函数 - 顾名思义，它创建原始字符串的副本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T14:19:58.850

这是不正确的，它们是字符串的完全独立的副本。当一个被删除时，另一个仍然存在。赋值运算符正是您应该复制这些的方式。

# c# - C# 正则表达式需要帮助从引号中删除文本

> ID：11121629
> 
> 赞同：0
> 
> 时间：2012-06-20T14:18:11.387
> 
> 标签：c#, regex

> **可能重复：**
> [C# 正则表达式，单引号之间的字符串](https://stackoverflow.com/questions/5662834/c-sharp-regular-expressions-string-between-single-quotes)

我需要从 C# 中的单引号内提取文本。

我需要从中拉出的字符串如下：

```
User Entered 'Some Text Here' 
```

我想去掉所有其他文本和引号，只将单引号内的文本存储在一个新字符串中，这样我就可以进行字符串比较： `Some Text Here`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T14:24:06.480

正则表达式是`'(.+?)'`. 你如何使用它，我会留给你，因为你没有表现出任何努力的证据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T14:25:17.713

尝试使用模式`'([^']+)`并获取捕获组。

例如：

```
Regex.Match(" User Entered 'Some Text Here'", @"'([^']+)").Groups[1].Value 
```

将返回您想要的文本。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-20T14:34:46.537

您也可以不使用正则表达式（只是一个选项）：

```
string test = "this is 'a test 'of a string 'between quotes'.";
string[] tokens = test.Split(new char[] { '\'' });
for(int i = 0; i < tokens.Length; ++i)
    if (i % 2 == 1)
        Console.Write(tokens[i]); 
```

输出：

> 引号之间的测试

# git - 并排递归 Git 子模块

> ID：11121631
> 
> 赞同：0
> 
> 时间：2012-06-20T14:18:17.570
> 
> 标签：git, github, git-submodules, git-subtree

在我们公司，我们通过堆积几个框架/库来制作项目：

```
/Framework
/Extensions (depends on Framework)
/Business (depends on Framework & Extensions)
/Project A (depends on Framework & Extensions & Business)
/Project B (depends on Framework & Extensions & Business)
/Project C (depends on Framework & Extensions & Business)
/... 
```

到目前为止，我们正在使用一个包含所有项目和框架的大型 git 存储库，并且我们正在使用[git subtree](https://github.com/apenwarr/git-subtree)来拆分框架以发布它（它是开源的）。

我们希望能够将这个大存储库拆分到不同的项目中，但是有这么多递归依赖项的事实让我担心：

AFAIK，两个 git 子模块/git 子树都要求所有库代码都在主存储库中，所以我们最终会得到这样的项目结构：

```
/Framework
/Extensions/Framework 
/Business/Extension/Framework
/Project A/Business/Extensions/Framework
/Project B/Business/Extensions/Framework
/Project C/Business/Extensions/Framework 
```

我们不喜欢到处都有这么多的框架副本，也不喜欢框架文件夹在层次结构中如此深入。

我们想要的是项目 A 存储库在拉取时断言存在与当前包含一些 SHA的存储库**并排，并检查此 SHA。**

有没有办法让 git 子模块/子树并排？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T23:23:44.830

您尚未描述您的开发环境，但您所描述的内容听起来与在 Linux /usr/lib 和 /usr/include 中开发具有依赖关系的代码并没有太大的不同。许多项目依赖于共享库；为了将这些项目编译成可执行文件，需要安装项目所依赖的库（框架和扩展）的稳定版本。

在您的情况下，让我们假设框架、扩展和业务都是稳定的（或者至少只是不经常更新）。您将拥有三个结帐，例如：

```
cd /stable
git checkout -b version-x.y /path/to/Framework.git
git checkout -b version-x.y /path/to/Extensions.git
git checkout -b version-x.y /path/to/Business.git 
```

由每个开发人员执行，以便在他们的开发机器上获取这些“库”。每个项目都有引用这些库的构建/制作指令。（引用可以是绝对的 /stable/... 或相对于“项目 X”位置。）扩展对框架的依赖和业务对扩展和框架的依赖是相似的。

使用这种方法，每个克隆只有一个，但所有依赖项都已到位。

[编辑] 如果每个项目都需要修改它所依赖的东西，上述内容将不起作用；如果是这种情况，那么您将无法避免多次克隆所有内容。而且，事实上，最好使用子模块进行克隆，以确保在适当的时候可以将一个项目的更改合并回主模块。

# python - 在python中对具有特定语言环境的字符串列表进行排序

> ID：11121636
> 
> 赞同：12
> 
> 时间：2012-06-20T14:18:37.840
> 
> 标签：python, locale, ctypes, glibc

我在一个使用不同语言文本的应用程序上工作，因此，为了查看或报告目的，一些文本（字符串）需要以特定语言排序。

目前我有一个解决方法弄乱了全局区域设置，这很糟糕，我不想把它投入生产：

```
default_locale = locale.getlocale(locale.LC_COLLATE)

def sort_strings(strings, locale_=None):
    if locale_ is None:
        return sorted(strings)

    locale.setlocale(locale.LC_COLLATE, locale_)
    sorted_strings = sorted(strings, cmp=locale.strcoll)
    locale.setlocale(locale.LC_COLLATE, default_locale)

    return sorted_strings 
```

官方 python 语言环境文档明确表示保存和恢复是一个坏主意，但没有给出任何建议：[http ://docs.python.org/library/locale.html#background-details-hints-tips-and-caveats](http://docs.python.org/library/locale.html#background-details-hints-tips-and-caveats)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-20T17:09:31.153

您可以使用***[PyICU](http://pypi.python.org/pypi/PyICU)的***整理器来避免更改全局设置：

```
import icu # PyICU

def sorted_strings(strings, locale=None):
    if locale is None:
       return sorted(strings)
    collator = icu.Collator.createInstance(icu.Locale(locale))
    return sorted(strings, key=collator.getSortKey) 
```

例子：

```
>>> L = [u'sandwiches', u'angel delight', u'custard', u'éclairs', u'glühwein']
>>> sorted_strings(L)
['angel delight', 'custard', 'glühwein', 'sandwiches', 'éclairs']
>>> sorted_strings(L, 'en_US')
['angel delight', 'custard', 'éclairs', 'glühwein', 'sandwiches'] 
```

*缺点：*依赖[PyICU 库](http://pypi.python.org/pypi/PyICU)；行为与 略有不同`locale.strcoll`。

* * *

我不知道如何在`locale.strxfrm`不全局更改的情况下获取给定语言环境名称的函数。作为*hack*，您可以*在不同的子进程中运行您的函数*：

```
pool = multiprocessing.Pool()
# ...
pool.apply(locale_aware_sort, [strings, loc]) 
```

*缺点：*可能很慢，资源匮乏

* * *

除非您可以控制可以从多个线程调用`threading.Lock`区域设置感知功能（它们不限于`locale`模块，例如）的每个地方，否则使用普通将不起作用。`re`

* * *

您可以使用***Cython***编译您的函数以使用 GIL 同步访问。GIL 将确保在您的函数运行时不会执行其他 Python 代码。

*缺点：*不是纯Python

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-21T13:56:04.257

`ctypes`解决方案很好，但如果将来有人只想修改您的原始解决方案，这里有一种方法：

全局设置的临时更改可以通过上下文管理器安全地完成。

```
from contextlib import contextmanager
import locale

@contextmanager
def changedlocale(newone):
    old_locale = locale.getlocale(locale.LC_COLLATE)
    try:
        locale.setlocale(locale.LC_COLLATE, newone)
        yield locale.strcoll
    finally:
        locale.setlocale(locale.LC_COLLATE, old_locale)

def sort_strings(strings, locale_=None):
    if locale_ is None:
        return sorted(strings)

    with changedlocale(locale_) as strcoll:
        return sorted(strings, cmp=strcoll)

    return sorted_strings 
```

这确保了原始语言环境的干净恢复 - 只要您不使用线程。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-21T13:47:48.317

Glibc 确实支持具有显式状态的语言环境 API。这是使用 ctypes 制作的 API 的快速包装器。

```
# -*- coding: utf-8
import ctypes

class Locale(object):
    def __init__(self, locale):
        LC_ALL_MASK = 8127
        # LC_COLLATE_MASK = 8
        self.libc = ctypes.CDLL("libc.so.6")
        self.ctx = self.libc.newlocale(LC_ALL_MASK, locale, 0)

    def strxfrm(self, src, iteration=1):
        size = 3 * iteration * len(src)
        dest =  ctypes.create_string_buffer('\000' * size)
        n = self.libc.strxfrm_l(dest, src, size,  self.ctx)
        if n < size:
            return dest.value
        elif iteration<=4:
            return self.strxfrm(src, iteration+1)
        else:
            raise Exception('max number of iterations trying to increase dest reached')

    def __del__(self):
        self.libc.freelocale(self.ctx) 
```

和一个简短的测试

```
locale1 = Locale('C')
locale2 = Locale('mk_MK.UTF-8')

a_list = ['а', 'б', 'в', 'ј', 'ќ', 'џ', 'ш']
import random
random.shuffle(a_list)

assert sorted(a_list, key=locale1.strxfrm) == ['а', 'б', 'в', 'ш', 'ј', 'ќ', 'џ']
assert sorted(a_list, key=locale2.strxfrm) == ['а', 'б', 'в', 'ј', 'ќ', 'џ', 'ш'] 
```

剩下要做的是实现所有语言环境函数，支持 python unicode 字符串（我猜是 wchar* 函数），并自动导入包含文件定义或其他东西

# javascript - 将 textarea 拆分为更小的变量

> ID：11121643
> 
> 赞同：0
> 
> 时间：2012-06-20T14:19:02.493
> 
> 标签：javascript, google-chrome

如何在**cookie**中保存包含超过 4kb 文本的 textarea 信息？不幸的是，我只对 Javascript 开放。我不能告诉用户他们不能使用超过 4000 个字符，并且在这种情况下设置限制是不可接受的。试图通过谷歌搜索，但它不会给我一个结果。不必对除 Google Chrome 以外的任何浏览器友好。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:25:03.983

根据您的兼容性要求，您可以使用[本地存储](http://diveintohtml5.info/storage.html)。如果我没记错的话，最多 5MB。

目前，Firefox 3.5+、Safari 4+、IE8+ 和 Chrome 支持 localStorage

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T14:25:50.080

Cookie 是旧的方式，您应该考虑使用[localStorage](https://developer.mozilla.org/en/DOM/Storage)。

```
//Setting the value
var myList = document.getElementById('myToDoList');
localStorage.setItem('toDoData', myList.value);

//Reading the value
var myToDo = localStorage.getItem('toDoData');
if(myToDo){
    myList.value= myToDo;
} 
```

# c++ - C++ std::regex 多行语法

> ID：11121647
> 
> 赞同：6
> 
> 时间：2012-06-20T14:19:16.507
> 
> 标签：c++, regex, c++11

我似乎无法让我的正则表达式正常工作。在 ECMAScript 中的多行文本上，这个正则表达式`begin\n([\s\S]*\nend)?`完全符合我的需要，[我在这里对其进行了测试](http://www.regexpal.com/)。

当我将它翻译成 C++ 时，它无法匹配相同的文本。

这是我在 Visual C++ 2010 中的代码：

```
#include <iostream>
#include <regex>

int main(int argc, char *argv[]) {
    std::regex metadataBlockRegex("begin\\n([\\s\\S]*\\nend)?",
        std::regex::ECMAScript);

    std::string text =
      "begin\n"
      "  123\n"
      "end\n";

    std::sregex_iterator blocksBegin(text.begin(), text.end(), metadataBlockRegex);
    std::sregex_iterator blocksEnd;

    for (auto blockMatch = blocksBegin; blockMatch != blocksEnd; ++blockMatch) {
            std::cout << (*blockMatch)[0].str();
    }
    return 0;
} 
```

这仅输出“开始”，我希望它与整个文本匹配。

我的问题是：这里出了什么问题，我在哪里可以找到`std::regex`引擎语法的详细描述以及它们如何处理多行字符串。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-16T21:17:27.777

**无论如何，没有多行支持......不在MSVC10中。**

您需要在模式中使用**\r & \n**伪造多行。这是一个大麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T14:53:13.180

[LWG 2503](https://wg21.link/lwg2503)添加了`multiline`语法选项，当您使用该选项时，它应该使您的程序按预期工作（对于支持该新功能的 C++ 实现）。

[LWG 2343](https://wg21.link/lwg2343)有更多背景知识，它解释了 ECMAScript RegExp 对象具有 Multiline 属性，默认为 false，以及不同 C++`regex`实现的行为。

**2012年的原始答案：**

> 这里有什么问题

不确定，看起来不错，但我可以访问的唯一 C++11 实现不支持`<regex>`

> 在哪里可以找到关于 std::regex 引擎的语法以及它们如何处理多行字符串的详细说明。

你不能，据我所知。最好看的地方可能是[Boost.Regex](http://www.boost.org/doc/libs/1_49_0/libs/regex/doc/html/index.html)的文档，但请注意，自从它被提议用于标准化并且具有一些不存在于`std::regex`.

# c# - 使用 ResourceDictionary 进行 WPF 本地化

> ID：11121648
> 
> 赞同：0
> 
> 时间：2012-06-20T14:19:20.767
> 
> 标签：c#, wpf, localization, resourcedictionary

目前我像这样整合当前的字符串：

```
<Window.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="lang/Dictionary.en-US.xaml" />
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</Window.Resources> 
```

是否有可能在我的代码隐藏文件中动态执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:44:50.997

当然，您可以执行以下操作：

```
var res = new ResourceDictionary {Source = new Uri("somepath")};
this.Resources.MergedDictionaries.Add(res); 
```

注意：这在我的脑海中没有经过测试，但它应该可以工作

# xpath - 如何让 XPATH 返回两个不同兄弟姐妹之间的节点？

> ID：11121650
> 
> 赞同：1
> 
> 时间：2012-06-20T14:19:25.110
> 
> 标签：xpath, pom.xml, siblings

我正在修改 pom 文件以更改版本节点值。我可以让 xpath 修改所有版本节点，但我只希望它在 artifactId 和分类器都匹配某些值时更改版本节点。这是我的xml：

```
<artifactItem>
    <groupId>com.xyz</groupId>
    <artifactId>foobar</artifactId>
    <version>${project.version}</version>
    <classifier>config</classifier>
    <type>zip</type>
    <overWrite>true</overWrite>
</artifactItem>
<artifactItem>
    <groupId>com.xyz</groupId>
    <artifactId>foobar</artifactId>
    <version>${project.version}</version>
    <type>jar</type>
</artifactItem> 
```

如果 artifactId 是 foobar，并且分类器是 config，我希望返回版本以便我可以修改它。

使用我找到的其他示例，我尝试了这个，但它没有用：

```
/artifactItem/artifactId[.='foobar']
     /following-sibling::*
      [count(.|/artifactItem/classifier[. ='config']/preceding-sibling::*)
      =
      count(/artifactItem/classifier[. ='config']/preceding-sibling::*)
      ] 
```

任何建议将不胜感激！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T14:23:38.580

```
//artifactItem[artifactId='foobar' and classifier='config']/version 
```

解释：

我们从 artifactItem 节点中选择版本节点​​，该节点的 artifactId 为“foobar”，分类器为“config”。

您可以使用括号来限定特定节点，使用 sub-XPATH 语句，其中上下文是括号之前的节点。

这是你想要的？

# replication - 复制监视器中的“未初始化订阅”错误

> ID：11121652
> 
> 赞同：3
> 
> 时间：2012-06-20T14:19:28.040
> 
> 标签：replication, sql-server-2012, transactional-replication

我正在使用 SQL Server 2012 并尝试实现事务复制。我使用系统存储过程来创建发布和订阅。我成功地创建了这些东西，但是当我检查复制监视器时，它显示“未初始化的订阅”。

当我检查订阅的同步状态时，我发现了这个日志

```
Date        6/20/2012 7:36:33 PM
Log     Job History (HYDHTC0131320D-PublisherDB-PublicationOne-HYDHTC0131320D\MSS-ReplicationSubscri-7C1D7509-C8A6-4073-A901-0433A2B6D2D3)

Step ID     1
Server      HYDHTC0131320D\MSSQLSERVER2
Job Name        HYDHTC0131320D-PublisherDB-PublicationOne-HYDHTC0131320D\MSS-ReplicationSubscri-7C1D7509-C8A6-4073-A901-0433A2B6D2D3
Step Name       Run agent.
Duration        00:07:41
Sql Severity    0
Sql Message ID  0
Operator Emailed    
Operator Net sent   
Operator Paged  
Retries Attempted   0

Message
2012-06-20 14:14:13.986 Copyright (c) 2008 Microsoft Corporation
2012-06-20 14:14:13.986 Microsoft SQL Server Replication Agent: distrib
2012-06-20 14:14:13.986 
2012-06-20 14:14:13.986 The timestamps prepended to the output lines are expressed in terms of UTC time.
2012-06-20 14:14:13.986 User-specified agent parameter values:
            -Publisher HYDHTC0131320D
            -PublisherDB PublisherDB
            -Publication PublicationOne
            -Distributor HYDHTC0131320D
            -SubscriptionType 2
            -Subscriber HYDHTC0131320D\MSSQLSERVER2
            -SubscriberSecurityMode 1
            -SubscriberDB ReplicationSubscriberDB
            -Continuous
            -XJOBID 0xDFE51AEC7F9E3F42A450CE8874B662CD
            -XJOBNAME HYDHTC0131320D-PublisherDB-PublicationOne-HYDHTC0131320D\MSS-ReplicationSubscri-7C1D7509-C8A6-4073-A901-0433A2B6D2D3
            -XSTEPID 1
            -XSUBSYSTEM Distribution
            -XSERVER HYDHTC0131320D\MSSQLSERVER2
            -XCMDLINE 0
            -XCancelEventHandle 000005F8
            -XParentProcessHandle 00000560
2012-06-20 14:14:13.986 Startup Delay: 619 (msecs)
2012-06-20 14:14:14.606 Connecting to Subscriber 'HYDHTC0131320D\MSSQLSERVER2'
2012-06-20 14:14:14.656 Connecting to Distributor 'HYDHTC0131320D'
2012-06-20 14:14:14.671 Parameter values obtained from agent profile:
            -bcpbatchsize 2147473647
            -commitbatchsize 100
            -commitbatchthreshold 1000
            -historyverboselevel 1
            -keepalivemessageinterval 300
            -logintimeout 15
            -maxbcpthreads 1
            -maxdeliveredtransactions 0
            -pollinginterval 5000
            -querytimeout 1800
            -skiperrors 
            -transactionsperhistory 100
2012-06-20 14:14:14.683 Agent message code 21040\. Publication '' does not exist. 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T14:48:19.607

我收到了同样的错误。我的解决方法是明确定义 Job_login 和 job_password，我一开始就设置为 null。

```
EXEC sp_addpullsubscription_agent 
@publisher = @publisher, 
@publisher_db = @publicationDB, 
@publication = @publication, 
@distributor = @publisher, 
@job_login = $(Login), 
@job_password = $(Password); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T16:11:34.607

您的复制设置脚本中似乎存在错误。

我怀疑错误出在对 sp_addpushsubscription_agent （如果是推送订阅）或 sp_addpullsubscription_agent （如果是拉订阅）的调用中。具体来说，**@publication**参数是错误的，因为分发代理声明指定的**出版物“不存在”**。

请检查您的脚本并重试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-04T05:47:45.670

我遇到了同样的问题并通过执行以下操作进行了修复：

*   -Subscriber Job owner 与 Publication User 相同

*   -Subscriber 用户已添加到订阅者用户列表并添加到 sysadmin 服务器角色

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-27T15:55:44.030

当我设法通过备份初始化启动并运行拉式订阅者时，只需几个注意事项：

1.  确保您拥有发布者、分发者和订阅者的代理帐户作为系统管理员登录所有实例，示例订阅者必须在分发者和发布者上。
2.  为每个实例上的所有组件创建链接服务器，例如订阅服务器上的分发者和发布者。
3.  然后对源数据库进行完整备份并在订阅实例上恢复而不进行恢复。
4.  在发布者数据库 () 上创建发布组件`sp_addsubscription`并确保您拥有`@sync_type = N'replication support only'`.
5.  然后对源数据库进行差异备份，并在订阅实例上恢复并恢复。
6.  然后在订阅实例（sp_addpullsubscription）上创建拉取订阅，注意如果源是镜像实例，这里使用原始实例值（@publisher）。如果您是“镜像”实例的主体，元数据将被正确创建，并且分发器包含将日志阅读器连接到任一镜像实例的逻辑。
7.  现在您将遇到主键等问题，因为分发者在差异备份之前开始捕获数据......没问题。停止订阅者作业，然后将 -SkipErrors 参数设置为“2601:2627”，将新配置文件添加到分发代理。这将跳过所有主键违规事务并继续处理。请记住选择此代理配置文件，然后单击“确定”。
8.  重新启动订阅作业并在订阅开始赶上事务时对其进行监控。
9.  当赶上时，停止作业，将代理配置文件更改回默认值并重新启动作业。

希望这可以帮助任何仍在为基于备份初始化的订阅者而苦苦挣扎的人......请注意，我在任何时候都没有在复制配置中使用任何备份配置。还声明了拉取订阅不能初始化（`@immediate_sync = 0`）。

这是脚本：

```
-----------------BEGIN: Script to be run at Publisher 'DB001\OLTP'-----------------
use [DB1]
go
exec sp_addsubscription @publication = N'DB1', @subscriber = N'DB002\OLTP', @destination_db = N'DB1', @sync_type = N'replication support only', @subscription_type = N'pull', @update_mode = N'read only'
GO

-----------------END: Script to be run at Publisher 'DB001\OLTP'-----------------

-----------------BEGIN: Script to be run at Subscriber 'DB002\OLTP'-----------------
use [DB1]
exec sp_addpullsubscription @publisher = N'DB001\OLTP', @publication = N'DB1', @publisher_db = N'DB1', @independent_agent = N'True', @subscription_type = N'pull', @description = N'', @update_mode = N'read only', @immediate_sync = 0

exec sp_addpullsubscription_agent @publisher = N'DB001\OLTP', @publisher_db = N'DB1', @publication = N'DB1', @distributor = N'DB003\DIST', @distributor_security_mode = 1, @distributor_login = N'', @distributor_password = null, @enabled_for_syncmgr = N'False', @frequency_type = 64, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 20170327, @active_end_date = 99991231, @alt_snapshot_folder = N'\\DB001\Replication', @working_directory = N'', @use_ftp = N'False', @job_login = null, @job_password = null, @publication_type = 0
GO
-----------------END: Script to be run at Subscriber 'DB002\OLTP'----------------- 
```

# c# - 在 onClosed 事件后导致 PostBack - jQuery Colorbox

> ID：11121653
> 
> 赞同：1
> 
> 时间：2012-06-20T14:19:31.607
> 
> 标签：c#, jquery, asp.net, oracle, colorbox

我试图让我的页面在关闭 jQuery Colorbox 窗口时进行实际的回发而不是完全重新加载。

这是我目前执行 Colorbox 的脚本。注意 onClosed 函数。

```
<script type="text/javascript">
    $(document).ready(function () {
        $(".iframe").colorbox({ iframe: true, width: "40%", height: "70%", transition: "elastic", onClosed: function () { window.location = window.location.href } });
    });

</script> 
```

我想要发生的只是将浏览器放入回发中，这样它就不会在重新加载时丢失文本框日历扩展器信息。

有没有人有什么建议？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T14:26:55.307

如果你想偷懒，你可以从 JQuery 调用一些回发元素的 click() 方法，比如页面上的按钮。如果您使用的任何元素都注册了视图状态，则它应该回发并维护。

# web-applications - SSO 与 SAML - 这种情况可能吗？

> ID：11121654
> 
> 赞同：1
> 
> 时间：2012-06-20T14:19:37.617
> 
> 标签：web-applications, single-sign-on, saml

我们目前有一个在 SAML SSO 配置中充当服务提供者的应用程序。身份提供者是一个完全不同的领域，我们无法控制，我们的客户可以。我们的客户虽然希望我们有一个“花哨”的登录小部件；基本上，他们不想点击链接并被重定向到他们的身份提供者，而是希望我们出现一个用户名和密码输入表单。

我的理解是，由于 SAML 的工作方式，我们不可能提供这种接口，但他们可以在他们的网站上提供这种接口，因为他们的服务提供商应用程序不需要 SAML，他们可以与自己的登录集成系统。

这是正确的，还是有办法按照他们的建议实现登录表单？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T15:07:47.143

SAML 规范中没有任何内容对此进行定义。您可能可以通过将凭据发布到他们外部暴露的登录页面来破解某些东西。但是，这绝对不是安全最佳实践，因为它违反了企业警告员工的反密码模式。此外——如果他们有 SAML IDP，他们为什么还要这个？

# image - 查找图像的边缘并在 MATLAB 中对其进行裁剪

> ID：11121657
> 
> 赞同：1
> 
> 时间：2012-06-20T14:19:52.843
> 
> 标签：image, matlab, crop, edge-detection

我有一个 RGB 图像。我已经扫描了图像。因此，图像只占 A4 尺寸纸张的一小部分。

我想找到图像的边框并裁剪它。我可以使用“Sobel”等边缘检测算子，但它们会检测图像中存在的所有边缘。我想要的只是图像的边框。此外，包括“bwboundaries”在内的许多边缘检测功能仅适用于二进制或灰度图像。我的图像是RGB。

我尝试使用“imcrop”，但这更像是交互式裁剪。我热衷于自动执行此操作。

上传测试图像：![](../Images/7193c1bc0a6f544d95cfe26c5349dd2a.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T16:23:36.973

由于这是一张 rgb 图像，灰色区域会有明显的颜色，但白色区域应该没有。您可以利用它来查找图像，然后您可以获得边界框。

```
img = imread('http://i.stack.imgur.com/dEawA.jpg');
%# instead of "==" you can check for similarity within a tolerance
tt=img(:,:,1)==img(:,:,2) & img(:,:,2) == img(:,:,3); 
```

![在此处输入图像描述](../Images/141852f0179261735ff518a748c3e215.png)

```
%# invert tt so that it's 1 where there is signal
tt = ~tt;

%# clean up some of the smaller artifacts
tto = imopen(~tt,strel('square',100)); 
```

![在此处输入图像描述](../Images/6fbd05669589cd6bd3ec3437a880e64c.png)

```
%# get the areas and bounding box of the areas above threshold
%# as an additional criterion, you could also use excentricity
%# or you could simply remove the bottom 100 rows of the scan
stats = regionprops(tto,'BoundingBox','Area');
area = cat(1,stats.Area);
[~,maxAreaIdx] = max(Area);
bb = round(stats(maxAreaIdx).BoundingBox);

%# note that regionprops switches x and y (it's a long story)
croppedImage = img(bb(2):bb(2)+bb(4),bb(1):bb(1)+bb(3),:); 
```

![在此处输入图像描述](../Images/330167e3cee8d4b755a222cbd55885dc.png)

由于旋转，会留下一点边界。您可以使用上面的蒙版`tto`在裁剪之前将所有非图像像素设置为 NaN，或者您可以使用它`imrotate`来修复图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T14:38:15.770

您可以尝试使用 Harris-Detector（`corner`在 Matlab 中）检测图像的角落。将要检测的最大角点数设置为 4。然后使用 中的角点位置`imcrop`。如果您发布图片，我可以给您更具体的提示。您的图像是 RGB 应该不是问题，只需将其转换为灰度即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T15:59:32.450

您可以尝试使用`bwlabel` [http://www.mathworks.com/help/toolbox/images/ref/bwlabel.html](http://www.mathworks.com/help/toolbox/images/ref/bwlabel.html)（连同查找，如帮助页面中所述）来获取图像的索引并使用它们来裁剪原来的。

您首先需要使用`im2bw` [http://www.mathworks.com/help/toolbox/images/ref/im2bw.html](http://www.mathworks.com/help/toolbox/images/ref/im2bw.html)将原始图像转换为二进制。

# trigger.io - 如何使用 forge.file.cacheURL 正确缓存许多图像（循环中）？

> ID：11121661
> 
> 赞同：0
> 
> 时间：2012-06-20T14:20:01.020
> 
> 标签：trigger.io, forge

我有一个从服务器下载为 json 文件的产品列表。每个项目都包含一个指向存储在服务器上的图像的链接。

现在我希望能够在离线时看到产品，所以我将下载的 json 文件存储到 forge.prefs [http://docs.trigger.io/en/v1.3/modules/prefs.html](http://docs.trigger.io/en/v1.3/modules/prefs.html)并拉出来显示屏幕上的项目。它工作得很好，但我还需要在本地存储图像才能正确显示。

为了实现这一点，我正在尝试使用 forge.file.cacheURL [http://docs.trigger.io/en/v1.3/features/cache.html](http://docs.trigger.io/en/v1.3/features/cache.html)但无法处理正确的操作顺序。为了缓存图像，我运行 json 文件，并为每一行调用 forge.file.cacheURL 并将 url 存储回 JSON 项。但这是 forge.file.cacheURL 异步运行的问题，所以我的循环在项目上运行并收集本地图像完成，我的代码继续显示图像（查看项目）但同时 forge.file.cacheURL 仍然收集并缓存图像，因为它的异步操作。我需要以某种方式检测最后一项正在被缓存，然后刷新屏幕上的视图以使用正确的图像 url ...或其他会导致我需要的东西。

希望你理解这个概念。我应该如何正确处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T15:57:37.273

从 v1.4.26 开始，您已经能够永久存储图像（请参阅[http://docs.trigger.io/en/v1.4/release-notes.html#v1-4-26](http://docs.trigger.io/en/v1.4/release-notes.html#v1-4-26)），而不仅仅是缓存它们。根据您的需要，这可能是比`forge.file.cacheURL`and更好的选择`forge.file.isFile`。

我不完全遵循您描述的情况，但是这样的事情会让您在做某事之前等待几个异步事情完成：

```
// e.g.
var jsonCache = {
    one: "http://example.com/one.jpg",
    two: "http://example.com/two.jpg",
    three: "http://example.com/three.jpg"
};

var cacheCount = 0;
for (var name in jsonCache) {
    if (jsonCache.hasOwnProperty(name)) {
        var imageURL = jsonCache[name];
        cacheCount += 1;
        forge.file.cacheURL(imageURL, function (file) {
            forge.prefs.set(name, file, function () {
                cacheCount -= 1; // race condition, but should be fine (!)
                if (cacheCount <= 0) {
                    alert('all cached');
                }
            });
        });
    }
} 
```

# php - 适用于 PHP 的 AWS 开发工具包在与 PHP 文件不同的文件夹中时不会运行

> ID：11121669
> 
> 赞同：1
> 
> 时间：2012-06-20T14:20:19.233
> 
> 标签：php, sdk, amazon-web-services

在这里把我的头撞到墙上 - 想知道是否有人可以帮助我。

我的网络根目录是`/var/www/`

我已将适用于 PHP 的 AWS 开发工具包安装到`/var/www/aws/`

我的 php.ini 文件中有这一行：`include_path="/var/www/aws/;"`

第一个 php 文件保存在这里：`/var/www/aws/`并包含：

```
include('sdk.class.php');
$s3=new AmazonS3(); 
```

第二个 php 文件保存在这里：`/var/www/`并包含：

```
include('aws/sdk.class.php');
$s3=new AmazonS3(); 
```

第一个文件有效，第二个文件无效。谁能告诉我如何让第二个文件工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T06:21:36.680

由于您已经`/var/www/aws/`设置为`include_path`, 对于您的第二个 PHP 文件，您应该能够简单地：

```
include('sdk.class.php'); 
```

就像第一个一样。

# gwt - mvn gwt:i18n 太慢了

> ID：11121671
> 
> 赞同：1
> 
> 时间：2012-06-20T14:20:24.243
> 
> 标签：gwt, maven

我们有一个比较大的项目。其中一个模块有 30 个生成的 GWT 消息包。生成每个捆绑包需要 2 秒，因此 2*30 = 1 分钟。我认为这是因为类路径很大，因为该项目有很多依赖项，并且它们都添加到了 gwt。实际上，生成只需要 src/main/java 即可。我可以以某种方式配置插件的类路径吗？例如，Surefire 插件有 classpathDependencyExcludes 和 additionalClasspathElement，但没有适用于所有插件的通用选项。正确的？

```
 <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>gwt-maven-plugin</artifactId>
            <version>${gwt.mvn.plugin}</version>
            <executions>
                <execution>
                    <goals>
                        <goal>i18n</goal>
                    </goals>
                </execution>
            </executions>
            <configuration>
                <generateDirectory>${basedir}/src/main/java</generateDirectory>
                <i18nMessagesBundles>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.SmpMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.PrepaymentFormMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.DebitorFinanceStateMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.AttributeAnalyticAccountsMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.SearchCustomerAccountsMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.LoanRatingQualityMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.RegistrationOfContractMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.BalancesAccountTurnoverMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.RegistrationClientAccountsMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.PackTermsDialogMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.OtherLoansMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.RatingQualityControlMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.ActualDebitorPacksTableMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.RegCredDecisionMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.PaymentGrafsMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.RestructuringRegistrationMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.CancelFinishContractAccountingMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.CompletionOfContractAccountingMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.PackInfoMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.RenewalRegistrationMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.ReserveLoanAccountMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.RatingWithDeprecMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.ReserveLoanAccaOrderMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.LoanAccountAttributesMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.EkkEndorsementsMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.ReportHeadingsMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.DocumentDetailsMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.ContractChoiceMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.ZvaWObspRaspPrintListMessages</i18nMessagesBundle>
                    <i18nMessagesBundle>ru.sbrf.iask.client.i18n.TransmitToProcessAlkLimitsMessages</i18nMessagesBundle>
                </i18nMessagesBundles>
            </configuration>
        </plugin> 
```

# php - php "count()" 函数和数据库

> ID：11121677
> 
> 赞同：1
> 
> 时间：2012-06-20T14:20:36.693
> 
> 标签：php, mysql, database, joomla

我有一个 Joomla 1.5 网站。我的网站上有不同“状态”的文章。我要做的是“计数”并显示有多少文章，例如“status = 1”（过期）或“status = 3”（阻塞）或“status = 2”（活动）等。

这是 PhpMyAdmin 中的状态 - [http://awesomescreenshot.com/07a8ijz75](http://awesomescreenshot.com/07a8ijz75)

这是我写的，但它总是给我相同的结果 - **1**

```
<?php echo count($this->row->status==1) ?> 
```

我错过了什么？谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-20T14:23:30.223

使用 SQL 计数函数。

```
select count(*) from articles where status = 1; 
```

使用您的数据库！如果您在 PHP 代码中对数据库中的数据进行排序、计数等操作，*那么您做错了*。

如果您想要所有状态，请执行以下操作：

```
select status, count(*) from articles group by status; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T15:19:58.483

PHP 中的 count 函数对数组中的所有元素进行计数，在您的示例中，您向其传递了一个布尔值。结果 count 不知道如何处理它，因此它返回 -1，这不是有效的计数。

我的 PHP 真的很生疏（我很久没有使用它了），但是这里有两种可能的方法来完成你想要的：

## 1\. 使用函数 map/reduce 风格

```
<?php
$row[0]->status = 1;
$row[1]->status = 2;
$row[2]->status = 1;
$row[3]->status = 3;
$row[4]->status = 1;

// Count the number of statuses that are equal to 1
echo array_reduce(array_map(function($x) {
    return $x->status == 1 ? 1: 0;
}, $row), function($x, $y) {return $x + $y;}); 
```

显然，您必须用 $this->row 替换 $row 变量。该代码基本上分两步工作。内部部分：

```
array_map(function($x) {
    return $x->status == 1 ? 1: 0;
}, $row) 
```

创建一个列表，其中每个等于 1 的状态都变为 1，而其他所有状态都变为 0。因此，您有一个“array(1, 0, 1, 0, 1)”数组。代码的输出部分：

```
array_reduce( ... , function($x, $y) {return $x + $y;}); 
```

将新数组作为第一个参数，并通过将数组的前两个值传递给函数，然后将每个后面的值和最后一次函数调用的结果进行汇总。结果，所有值都被求和，并且您对匹配值有适当的计数。

## 2.使用简单的程序风格

```
<?php
$row[0]->status = 1;
$row[1]->status = 2;
$row[2]->status = 1;
$row[3]->status = 3;
$row[4]->status = 1;

// Do it again, but in a procedural style
$num_1_statuses = 0;
foreach ($row as $r) {
    if ($r->status == 1) {
        $num_1_statuses++;
    }
}
echo $num_1_statuses; 
```

这应该非常简单，它只有一个变量，只要一行的状态匹配，它就会递增。

# vb6 - 在 word 2003 中禁用“您将大量数据复制到剪贴板”警告

> ID：11121678
> 
> 赞同：2
> 
> 时间：2012-06-20T14:20:39.960
> 
> 标签：vb6, word-2003

此代码片段（来自 VB6）启动 Word 2003 应用程序并添加一个新文档：

```
Dim WithEvents wApp As Word.Application
Dim WithEvents wDoc As Document

Set wApp = New Application

wApp.DisplayAlerts = wdAlertsNone

Set wDoc = wApp.Documents.Add
wApp.Visible = True 
```

设想：

1.  我从一个简单的 vb6 应用程序运行类似这样的代码。
2.  我复制一个大文本（即来自网站）并将其粘贴到新的 Word 文档中
3.  将文本多次粘贴到同一个文档中后，我将其全部标记，然后*从*Word中复制
4.  然后我关闭word应用程序，拒绝保存文档，最后得到“....大量数据...”警告。

我发现的几乎每个示例都描述了 MS-Excel 和 MS-Access 案例中的这个警告问题，所以我还没有找到任何有效的 MS Word 解决方案。是的，我试图更改甚至删除注册表值

```
HKey_CURRENT_USER\Software\Microsoft\Office\11.0\Common\General\AcbControl 
```

对 MS-Word 2003 中的警告问题没有任何影响。

我必须在关闭 word-application 后获取最后复制的数据，因此清除剪贴板不是解决方案。

MS Word 2003 是否存在忽略任何警告设置的错误，或者是否有任何方法可以在关闭 Word 2003 时禁用“您将大量数据复制到剪贴板...”警告。在设置中或从某些代码中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T21:03:19.290

我相信只有当剪贴板中有大量数据时才会出现此警告消息。

因此，如果您使用代码清除剪贴板，我相信警告消息将不再显示。

正如您所说，您需要保存在剪贴板中的值，因此将其临时存储在一个变量中，一旦您关闭了 word 文档，然后将保存的有价值的值重新分配回剪贴板。

注意在 Visual Basic 6 中有一个 Clipboard 对象。

有关如何使用 Visual Basic 6 剪贴板对象的文档，请[单击此处](http://msdn.microsoft.com/en-us/library/ebwdx8yh%28v=VS.90%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T13:33:15.587

Word 提供的某些剪贴板格式的数据仅在明确请求时才提供。Word 警告这些需要在关闭时丢失或生成。不知道能不能禁用。

# sql-server - 在 SQL Server 中看不到来自链接服务器的物化视图

> ID：11121682
> 
> 赞同：0
> 
> 时间：2012-06-20T14:20:50.343
> 
> 标签：sql-server, oracle, materialized-views

我有一个 SQL Server 2008 Express Edition，并添加了一个 Oracle DB 作为与`OraOLEDB.Oracle`提供程序的链接服务器。连接有效，但我只能看到来自 Oracle 服务器的视图，没有表，也没有物化视图。

我可以`SELECT *`在可见视图上，所以链接似乎没有明显的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T07:47:48.677

**问题已解决：**我在对象资源管理器树中的 SQL Management Studio 中查找表和物化视图，它只向我显示“正常”视图。我打开对象资源管理器详细信息视图 (F7)，它们都是：表和视图。物化视图也显示在表格下。

# installation - NITE 安装问题

> ID：11121687
> 
> 赞同：1
> 
> 时间：2012-06-20T14:20:58.940
> 
> 标签：installation, openni

我已经安装了 OpenNI 和 SensorKinect，但是当我尝试安装 NITE 时，它中途失败了。这是输出。可能是什么问题呢？

我还安装了早期版本的 NITE。如果不安装此版本的 NITE，它会与较新版本的 OpenNI 兼容吗？

安装 NITE

* * *

复制共享库...好的

复制包括...好的

安装 java 绑定...好的

正在安装模块“Features_1_3_0”...

注册模块'libXnVFeatures_1_3_0.so'... OK

正在安装模块“Features_1_3_1”...

注册模块'libXnVFeatures_1_3_1.so'... OK

正在安装模块“Features_1_4_1”...

注册模块'libXnVFeatures_1_4_1.so'... OK

正在安装模块“Features_1_4_2”...

注册模块'libXnVFeatures_1_4_2.so'...失败：错误！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:20:46.347

1.  安装不稳定的 OpenNi (OpenNi Binaries)[下载](http://www.openni.org/Downloads/OpenNIModules.aspx)
2.  安装传感器[下载](https://github.com/avin2/SensorKinect/tree/unstable/Bin)
3.  安装不稳定的 NITE[下载](http://www.openni.org/Downloads/OpenNIModules.aspx)
4.  安装 avin2 / SensorKinect [下载](https://github.com/avin2/SensorKinect)

循序渐进。目前我已经安装了 openNi 和 Kinect 并且运行良好。之后，您就可以在 OpenNi 文件夹中运行示例了。快乐的代码！

# java - 正则表达式：匹配字符串中两个标签之间的字符串

> ID：11121690
> 
> 赞同：1
> 
> 时间：2012-06-20T14:21:08.087
> 
> 标签：java, regex

我是正则表达式的新手。我为以下场景编写正则表达式感到震惊。有人可以帮我解决这个问题吗？

如果我有如下字符串：

```
<Tag1 attr="test"/>
<Tag2>
    <Tag4 attr="test"/>
    <Tag5 attr="test"/>
</Tag2>
<Tag3 attr="test"/> 
```

<Tag2> 和 </Tag2> 标签之间匹配“测试”的正则表达式是什么？

输出应与 Tag4 和 Tag5 中的“测试”匹配...

任何帮助将不胜感激..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:24:27.493

你为什么要为此使用正则表达式？我不熟悉 Java 库，但我想有一个库可以让您使用 XPath 进行 XQuery。那将是更简单的方法。

[这是一个显示示例的网站](http://www.roseindia.net/tutorials/xPath/java-xpath.shtml)

[这是关于 Java 中 XPath 的一个 SO 问题](https://stackoverflow.com/questions/2811001/how-to-read-xml-using-xpath-in-java)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T14:29:03.933

XPath 确实更适合于此。这看起来像重复的帖子。 [原来的](https://stackoverflow.com/q/2811001/1440715)

Perl 在 CPAN 上有几个很好的 xpath 解析器。但是，如果您绝对必须使用它，这里有一个关于[多行正则表达式](http://austinmatzko.com/2008/04/26/sed-multi-line-search-and-replace/)解析的好页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T15:22:23.690

之前所说的都是完全正确的-但是，如果您仍然想练习一些正则表达式，则可以选择：在一场比赛中进行是不可能的，因为其中一个内部组将始终被丢弃[（请参阅this）](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html#cg)，因此您必须提取首先是内部通道。

```
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class RegexTagParse {

static String html = "<Tag1 attr=\"test\"/><Tag2>    <Tag4 attr=\"test_one\"/>    <Tag5 attr=\"test_two\"/></Tag2><Tag3 attr=\"test\"/>";

public static void main(String[] args) {
    Matcher mat1 = Pattern.compile("Tag2>(.*)</Tag2").matcher(html);
    mat1.find();

    Matcher mat2 = Pattern.compile("<[^<>]*attr=\"([^\"]+)\"[^<>]>").matcher(mat1.group(1));
    while(mat2.find()){
        System.out.println(mat2.group(1));
    }
}

} 
```

无论如何，您最好使用 XPath :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T15:25:19.057

我没有在实践中使用java，但我希望可以为正则表达式提供一些指导。如果您知道要查找的特定属性和值是什么，则可以使用以下内容：

```
Pattern pattern = Pattern.compile("<tag[45].*attr\s*=\s*[\"']test['\"][^>]*>", Pattern.CASE_INSENSITIVE);

Matcher matcher = pattern.matcher("<Tag1 attr='test'/><Tag2><Tag4 attr='test'/><Tag5 attr='test'/></Tag2><Tag3 attr='test'/>");

matcher.matches(); 
```

正则表达式由以下组件组成：

匹配文字字符串：

后跟 4 或 5（[45] 名称）

后跟文字字符串之前的任意数量的字符：attr

后跟任意数量的空格

后跟文字字符：=

后跟任意数量的空格

后跟 ' 或 " 字符

后跟字符串文字：test

后跟 ' 或 " 字符

后跟任何不是>的字符

其次是 >

添加其中一些额外位的目的只是为了强调您可能需要/想要考虑考虑不同的编码样式等。注意：我通过将模式设置为不区分大小写来简化操作，但您可以省略并更改您的表达式以检查适当的大小写（例如，如果您的属性值区分大小写，您可以将“标签”文字更改为 [tT][aA][gG] 以允许匹配标签不区分大小写。

我显然打字太慢了，因为 jvataman 已经回答了你的问题，但也许我的文章有一些价值，所以我还是会发布。

# iphone - 奇怪的 GameKit 行为。还有人看到这个吗？

> ID：11121693
> 
> 赞同：7
> 
> 时间：2012-06-20T14:21:21.290
> 
> 标签：iphone, objective-c, ios, xcode, game-center

我正在运行 Xcode 4.3.3 并针对 iOS 5.1。我正在尝试在游戏中包含 Game Center 功能。

验证 GKLocalPlayer 时，会向用户显示*登录到 Game Center*警报视图或显示已登录。到目前为止这一切都很好，但如果用户按下*创建新帐户*按钮，那么任何打开的模式视图都会移到后面根视图控制器并从控制台吐出以下错误：

> *<GKModalRootViewController: memory address* >开始/结束外观转换的不平衡调用。

我尝试在应用程序委托和根视图控制器之间移动 GKLocalPlayer 身份验证代码。我还尝试在一个新的空白项目中实现身份验证。我已经尝试过使用和不使用 Storyboards 和 ARC。在所有这些情况下，结果都是相同的：隐藏在根视图控制器后面的模式并给出错误。

这是我从应用程序委托的*应用程序调用的 GKLocalPlayer 身份验证方法：didFinishLaunchingWithOptions:*方法：

```
- (void)authenticateLocalPlayer
{
    GKLocalPlayer *localPlayer = [GKLocalPlayer localPlayer];
    [localPlayer authenticateWithCompletionHandler:^(NSError *error) {
        if (localPlayer.isAuthenticated) {
            // Perform additional tasks for the authenticated player.
        } else {
            // Disable Game Center features.
        }
        if (error) {
            // Handle error.
        }
    }];
} 
```

[这](http://lanausee.com/files/wonkygamekit.png)是它的屏幕截图。在这张图片中，根视图控制器的背景具有 50% 的 alpha 值。此错误已将模式推到根视图控制器后面。

[这个stackoverflow问题](https://stackoverflow.com/questions/8049118/unbalanced-calls-to-begin-end-appearance-transitions-for-gkmodalrootviewcontrol)包含我能找到的对这个错误的唯一引用（关于GKModalRootViewController），它不适合因为（a.）我没有使用cocos2d。(b.) 无论我是否执行 segue，都会发生这种情况，并且我没有触摸 viewWillAppear: 或 viewDidAppear:。(c.) 没有给出可接受的答案。

[这个问题](https://stackoverflow.com/questions/11008613/game-center-white-screen-after-create-account)和[这个](https://stackoverflow.com/questions/10561309/underlying-view-disappears-during-game-center-authentication)问题似乎涉及相同的问题（视图层次结构被破坏），但没有得到解答，也没有提及控制台错误消息。

这会发生在其他人身上吗？关于可能导致这种情况的任何想法？

**更新 1：**我什至将身份验证代码放入连接到模式视图中按钮的 IBAction 中，以避免任何初始化冲突。它没有帮助。

**更新 2：**我尝试将身份验证代码移动到 GCD 后台队列中。他的结果是一样的。

[这](http://lanausee.com/files/gamecenter-test.zip)是测试项目（GameCenter 已经准备好我的应用程序的 Bundle ID）。

去测试：

1.  在测试设备/模拟器上注销 Game Center（如果您已登录）。
2.  构建并运行应用程序。
3.  按信息按钮。
4.  按*验证*。
5.  当出现登录 Game Center 警报时，按*Create New Account*。
6.  按*取消*。
7.  控制台中是否出现“不平衡呼叫...”消息？模态视图（带有验证按钮）是否消失了？
8.  按信息按钮。
9.  模态再次显示了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T18:50:14.677

此错误出现在“Apple 在 6.0 中修复的错误”列表中。我知道您会喜欢一种解决方法，但是当您所依赖的 API 有问题时，这种可能性很小。

然而，您可以为 5.x 用户正在慢慢消亡而感到高兴。

祝你的应用好运。

# database - 印度的地理指标 API

> ID：11121697
> 
> 赞同：1
> 
> 时间：2012-06-20T14:21:49.297
> 
> 标签：database, api, statistics, geography

嗨，我最近遇到了一个网站[http://www.azavea.com/Products/Kaleidocade/Home.aspx](http://www.azavea.com/Products/Kaleidocade/Home.aspx)，是否有专门针对印度的类似地理指标网站，涵盖所有州？我想知道燃料价格、蔬菜价格等详细信息，我找到了 indiastat.com，但它非常昂贵。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T11:07:24.093

我建议您登录[www.mapmyindia.com/api](http://www.mapmyindia.com/api)以进一步了解您正在寻找什么 api。

# c# - IEnumerable 属性的 ValidationAttribute

> ID：11121702
> 
> 赞同：1
> 
> 时间：2012-06-20T14:22:21.533
> 
> 标签：c#, ienumerable

我有这个自定义验证属性来验证集合。我需要调整它以与 IEnumerable 一起使用。我尝试使该属性成为通用属性，但您不能拥有通用属性。

```
[AttributeUsage(AttributeTargets.Property, AllowMultiple = false, Inherited = true)]
public class CollectionHasElements : System.ComponentModel.DataAnnotations.ValidationAttribute 
{
     public override bool IsValid(object value)
     {
         if (value != null && value is IList)
         {
             return ((IList)value).Count > 0;
         }
         return false;
     }
} 
```

我无法将它转换为 IEnumerable，以便我可以检查它的 count() 或 any()。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T14:30:14.373

试试这个

```
var collection = value as ICollection;
if (collection != null) {
    return collection.Count > 0;
}

var enumerable = value as IEnumerable;
if (enumerable != null) {
    return enumerable.GetEnumerator().MoveNext();
}

return false; 
```

注意：测试`ICollection.Count`比获取枚举器并开始枚举枚举器更有效。因此，我尽可能尝试使用该`Count`属性。但是，第二个测试将单独工作，因为集合总是实现`IEnumerable`.

继承层次结构是这样的：`IEnumerable > ICollection > IList`. `IList`实现`ICollection`和`ICollection`实现`IEnumerable`。因此`IEnumerable`适用于任何设计良好的集合或枚举类型，但不适用于`IList`. 例如`Dictionary<K,V>`不实现`IList`但`ICollection`因此也是`IEnumeration`。

* * *

.NET 命名约定说属性类名称应始终以“Attribute”结尾。因此，您的班级应该命名为`CollectionHasElementsAttribute`. 应用属性时，您可以删除“属性”部分。

```
[CollectionHasElements]
public List<string> Names { get; set; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-12T13:42:04.880

列表和复选框列表所需的验证属性

```
[AttributeUsage(AttributeTargets.Property)]
public sealed class CustomListRequiredAttribute : RequiredAttribute
{
    public override bool IsValid(object value)
    {
        var list = value as IEnumerable;
        return list != null && list.GetEnumerator().MoveNext();
    }
} 
```

如果您有复选框列表

```
[AttributeUsage(AttributeTargets.Property)]
public sealed class CustomCheckBoxListRequiredAttribute : RequiredAttribute
{
    public override bool IsValid(object value)
    {
        bool result = false;

        var list = value as IEnumerable<CheckBoxViewModel>;
        if (list != null && list.GetEnumerator().MoveNext())
        {
            foreach (var item in list)
            {
                if (item.Checked)
                {
                    result = true;
                    break;
                }
            }
        }

        return result;
    }
} 
```

这是我的视图模型

```
public class CheckBoxViewModel
{        
    public string Name { get; set; }
    public bool Checked { get; set; }
} 
```

用法

```
[CustomListRequiredAttribute(ErrorMessage = "Required.")]
public IEnumerable<YourClass> YourClassList { get; set; }

[CustomCheckBoxListRequiredAttribute(ErrorMessage = "Required.")]
public IEnumerable<CheckBoxViewModel> CheckBoxRequiredList { get; set; } 
```

# c# - 使用 WebClient 快速失败

> ID：11121706
> 
> 赞同：4
> 
> 时间：2012-06-20T14:22:41.497
> 
> 标签：c#, webclient

使用[修改后的 WebClient](https://stackoverflow.com/a/3052637/141172)，我定期从具有以下特征的服务下载数据：

*   数据下载 (~1GB) 大约需要 20 分钟
*   有时服务决定根本不返回任何数据（请求挂起），或者需要几分钟到几小时才能返回第一个字节。

如果服务在合理（可配置）的时间内没有返回任何数据，我想快速失败，但要留出足够的时间让正在取得进展的下载成功。

似乎[WebRequest.Timeout](http://msdn.microsoft.com/en-us/library/system.net.webrequest.timeout.aspx)属性[控制请求完成](https://stackoverflow.com/questions/11121096/what-exactly-is-a-timeout-when-using-webrequest/11121587#11121587)的总时间，而[ReadWriteTimeout](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.readwritetimeout.aspx)控制数据传输开始后可用于读取数据的总时间。

我是否缺少一个属性来控制在建立连接和返回第一个字节之间等待的最长时间？如果没有这样的属性，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:46:47.643

我不知道有任何额外的超时属性可以实现您正在寻找的结果。想到的第一个想法是附加一个处理程序`DownloadProgressChanged`，它将更新一个标志以指示已收到数据（但并不总是准确）。

使用`Timer`or`EventWaitHandle`然后您可以在短时间内阻塞（或处理异步，如果您愿意）并评估是否已收到任何数据。下面的代码不是一个完整的例子，而是一个关于如何实现它的想法。

```
using (var manualResetEvent = new ManualResetEvent(false))
using (var client = new WebClient())
{
    client.DownloadProgressChanged += (sender, e) => manualResetEvent.Set();
    client.DownloadDataAsync(new Uri("https://github.com/downloads/cbaxter/Harvester/Harvester.msi"));

    if (!manualResetEvent.WaitOne(5000))
        client.CancelAsync();
} 
```

在上面的示例中，如果被调用，`manualResetEvent.WaitOne`则将返回。您可能想要检查并仅设置非零值，但我认为您明白了吗？`true``DownloadProgressChanged``e.BytesReceived > 0`

# sql - Oracle：在这种情况下如何使用 regexp_substr

> ID：11121707
> 
> 赞同：0
> 
> 时间：2012-06-20T14:22:43.260
> 
> 标签：sql, regex, oracle

我在 Oracle 中有一个表，其中一列包含形式为 \ 的 UserId。例如“fin\george”、“sales\andy”等。如何使用 REGEXP_SUBSTR 函数仅从 UserIds 中获取。即我只想获取“george”、“andy”等。我已经使用 SUBSTR 函数实现了所需的结果，但在这种情况下我想使用 REGEXP_SUBSTR。

我试过这样做：

```
SELECT REGEXP_SUBSTR('fin\george','\[^\]+,') "UserName" FROM DUAL; 
```

但它没有帮助。谁能指出我的错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T14:33:22.140

我相信您想使用`regexp_replace`带有反向引用的 a 。我假设之前和之后的所有字符`\`都是字母。如果你允许数字，你会想要使用`[[:alnum:]]`而不是`[[:alpha::]`。

```
 1* SELECT REGEXP_replace('fin\george',
                           '([[:alpha:]]+\\)([[:alpha:]]+)$', 
                           '\2') "UserName" 
       FROM DUAL
SQL> /

UserNa
------
george 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T11:41:32.803

```
select regexp_replace( 'fin\george', '.*\\', null ) from dual; 
```

返回`george`。

`\`正则表达式将尽可能多地匹配后面的任何字符（被转义）（贪婪）。所以它将匹配所有东西到决赛`\`。然后匹配的字符串被替换为`null`.

`null`是默认的所以

```
select regexp_replace('fin\george', '.*\\' ) from dual; 
```

做同样的事情

相同的表达式可以从路径名的末尾提取文件名，例如

```
select regexp_replace ('fin\fin2\fin3\fin4\george', '.*\\' ) from dual; 
```

也会回来`george`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-22T16:11:58.430

```
SQL> SELECT REGEXP_SUBSTR('fin\george', '[^\]+', 1, 2) AS userId from dual;

USERID
------
george 
```

请参阅[此 Oracle Base 文章](http://www.oracle-base.com/articles/misc/regular-expressions-support-in-oracle.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T14:26:32.063

您必须使用转义： \\ 而不是 \

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-17T13:33:33.267

执行此操作的最简单方法（恕我直言）如下：

```
SELECT REGEXP_SUBSTR('fin\george', '[^\\]+$') AS "UserName" FROM DUAL; 
```

您的原始查询的问题是 (a)`\`字符没有被转义和 (b) 正则表达式中有一个多余的逗号。我在`$`这里使用了字符串结尾锚，假设由 . 分隔的元素不超过两个`\`。如果有两个以上，而您只需要第二个，则可以使用以下内容：

```
SELECT REGEXP_SUBSTR('fin\george\ringo', '[^\\]+', 1, 2) AS "UserName"
  FROM DUAL; 
```

这告诉 Oracle 开始查看字符串的第一个字符并返回第二个匹配项。

# ruby - Ruby - 如果变量不存在，我该如何处理它

> ID：11121714
> 
> 赞同：4
> 
> 时间：2012-06-20T14:23:15.950
> 
> 标签：ruby

我想做`puts blob`

但如果 blob 变量不存在，我会得到

```
NameError: undefined local variable or method `blob' for main:Object 
```

我试过了

```
blob?  
blob.is_a?('String')
puts "g" if blob  
puts "g" catch NameError
puts "g" catch 'NameError' 
```

但没有一个工作。

我可以通过使用@instance 变量来解决它，但这感觉像是在作弊，因为我应该知道并相应地处理没有价值的问题。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-20T14:29:58.460

在这种情况下，您应该这样做：

```
puts blob if defined?(blob) 
```

或者，如果您也想检查 nil：

```
puts blob if defined?(blob) && blob 
```

该`defined?`方法返回一个字符串，表示参数的类型（如果已定义），`nil`否则。例如：

```
defined?(a)
=> nil
a = "some text"
=> "some text"
defined?(a)
=> "local-variable" 
```

使用它的典型方法是使用条件表达式：

```
puts "something" if defined?(some_var) 
```

更多关于`defined?`这个[问题](https://stackoverflow.com/a/288726/512507)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T15:02:29.893

```
class Object
  def try(*args, &block)
    if args.empty? and block_given?
      begin
        instance_eval &block
      rescue NameError => e
        puts e.message + ' ' + e.backtrace.first
      end
    elsif respond_to?(args.first)
      send(*args, &block)
    end
  end
end

blob = "this is blob"
try { puts blob }
#=> "this is blob"
try { puts something_else } # prints the service message, doesn't raise an error
#=> NameError: undefined local variable or method `something_else' for main:Object 
```

# java - 如何设置自定义 JAXBContext

> ID：11121719
> 
> 赞同：5
> 
> 时间：2012-06-20T14:23:31.360
> 
> 标签：java, jaxb, annotations, jax-ws, java-metro-framework

我想问一个关于jax-ws 中的*[@UsesJAXBContext注释的问题。](https://jax-ws.java.net/nonav/2.2.8/javadocs/rt/index.html?com/sun/xml/ws/developer/UsesJAXBContext.html)*我试图让它在客户端工作，但我可能遗漏了一些东西。这是我的情况：

我有网络服务与操作：

```
@WebMethod(operationName = "putToQueue")
public boolean put(@WebParam(name = "queueName") String queueName, @WebParam(name = "element") Object element) {
    return queues.get(queueName).offer(element);
} 
```

在客户端，我生成了 QueueService 和 Queue（端口）......以及其他东西...... [响应请求。在这种情况下无关紧要。] 我想让用户定义他/她可以放入队列的对象。但是，要调用*put(...)*操作，我需要将对象（我尝试发送）绑定到 JAXBContext 中。我可以通过 在生成的队列存根顶部的*@XmlSeeAlso*来做到这一点[我试过这个并且它有效]。尽管如此，我需要更通用的解决方案来帮助我在运行时绑定对象。我认为我可以创建*@QueueMessage*注释和*ClientJAXBContextFactory*并在创建时将标记的类添加到上下文中。

```
public class ClientJAXBContextFactory implements JAXBContextFactory {

    @Override
    public JAXBRIContext createJAXBContext(SEIModel seim, List<Class> classes, List<TypeReference> references) throws JAXBException {
        Reflections reflections = new Reflections("");
        Set<Class<?>> annotated = reflections.getTypesAnnotatedWith(QueueMessage.class);
        classes.addAll(annotated);

        return JAXBContextFactory.DEFAULT.createJAXBContext(seim, classes, references);
    }
} 
```

接下来我尝试在生成的队列之上使用*@UsesJAXBContext 。*

```
@WebService(name = "Queue")
@UsesJAXBContext(ClientJAXBContextFactory.class)
public interface Queue {
...
} 
```

但是*createJAXBContext(...)*没有被调用，而 jax-ws 只是简单地创建了他的 JAXBContextImpl。

我读过了：

[http://weblogs.java.net/blog/jitu/archive/2008/08/control_of_jaxb.html](http://weblogs.java.net/blog/jitu/archive/2008/08/control_of_jaxb.html)

[http://www.techques.com/question/1-5627173/Specify-JAXB-Packages-in-SLSB-and-JAX-WS](http://www.techques.com/question/1-5627173/Specify-JAXB-Packages-in-SLSB-and-JAX-WS)

还有一些关于stackOverFlow 的问题。我将不胜感激。是否可以实施我的问题中提出的想法？

我也可能会在服务器端添加它...... *@UsesJAXBContext*有效。但对我来说，让它在客户端工作很重要。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-22T12:11:56.803

好的，我可以解决我面临的问题。我仍然无法将*@UsesJAXBContext*与使用网络服务的客户端一起使用。但我发现此注释与具有后修复功能的 bean 相关联。所以有一个类*UsesJAXBContextFeature*

[https://jax-ws.java.net/nonav/2.2.7/javadocs/com/sun/xml/ws/developer/UsesJAXBContextFeature.html](https://jax-ws.java.net/nonav/2.2.7/javadocs/com/sun/xml/ws/developer/UsesJAXBContextFeature.html)

它可以作为端口或服务的参数传递（自 jax-ws 2.2 以来的服务）。我的版本有点麻烦，所以我决定生成类并使用 jax-ws 2.1。现在我只是简单地创建这样的端口：

```
new QueueService().getQueuePort(new UsesJAXBContextFeature(new ClientJAXBContextFactory())); 
```

它有效！

# java - Java 和 C++ 加密结果不匹配

> ID：11121723
> 
> 赞同：21
> 
> 时间：2012-06-20T14:23:50.327
> 
> 标签：java, c++, security, base64

我有一个现有的 c++ 代码，它将加密一个字符串。现在我在 . **一些加密字符串是匹配的。有些是一两个字符不匹配。**

我无法弄清楚为什么会这样。我在调试模式下运行这两个代码，直到他们调用他们的库都具有相同的密钥、盐、iv 字符串进行加密。

我知道即使单个字节填充更改会大幅修改加密字符串。但在这里我只是看到一两个字符发生了变化。这是一个示例（星号之间的粗体字符是不匹配的部分）

**爪哇：**

> U2FsdGVkX18xMjM0NTY3OGEL9nxFlHrWvodMqar82NT53krNkqat0rrgeV5FAJFs1vBsZIJPZ08DJVrQ* **Pw** *yV15HEoyECBeAZ6MTeN+ZYHRitKanY5jiRU2J0KP0Fzola

**C++：**

> U2FsdGVkX18xMjM0NTY3OGEL9nxFlHrWvodMqar82NT53krNkqat0rrgeV5FAJFs1vBsZIJPZ08DJVrQ* **jQ** *yV15HEoyECBeAZ6MTeN+ZYHRitKanY5jiRU2J0KP0Fzola

我正在使用 AES 加密。提供者是 SunJCE 1.6 版。我尝试将提供者更改为 Bouncy Castle。即使那样结果也是一样的。

增加了一个样本：

**C++：**

> U2FsdGVkX18xMjM0NTY3O* **I*** /BMu11HkHgnkx+dLPDU1lbfRwb+aCRrwkk7e9dy++MK+/94dKLPXaZDDlWlA3gdUNyh/Fxv* **oF** *STgl3QgpS0XU=

**爪哇：**

> U2FsdGVkX18xMjM0NTY3O* **D*** /BMu11HkHgnkx+dLPDU1lbfRwb+aCRrwkk7e9dy++MK+/94dKLPXaZDDlWlA3gdUNyh/Fxv* **j9** *STgl3QgpS0XU=

**更新：**

根据评论，我觉得 base 64 加密是罪魁祸首。我在两个地方都使用了 Latin-1 字符集。还有什么我可以检查的

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-20T21:11:10.293

叹！！

几乎可以肯定的问题是，在您加密数据并将加密数据作为**字节**字符串接收后，您正在对数据进行某种字符转换，然后再通过 Base-64 转换发送数据。

请注意，如果您对字符串“ *ABC_D_EFG* *”***和“ABC_G_EFG ***”进行******加密***，加密后的输出将完全不同，从第 4 个字符开始，一直持续到最后。换句话说，Base-64 输出将类似于（使用虚构值）：**

 **U2FsdGVkX18xMj

和

U2FsdGXt91mJpz

在上面的例子中，只有两个孤立的 Base-64 字符（一个字节）在每种情况下都被弄乱了，这一事实几乎证明了损坏发生在加密之后。

加密过程的输出是**字节**序列，而不是字符序列。观察到的损坏与错误地将字节解释为字符并在将它们输入 Base-64 转换器之前尝试对其执行代码页转换是一致的。加密器的输出应直接送入 Base-64 转换器，无需任何转换。

你说你在两个地方都使用了“Latin-1 char set”，这清楚地表明你正在做一些你不应该做的转换——应该没有必要使用 char 集。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T20:12:28.533

先来一段代码：

```
import javax.xml.bind.DatatypeConverter; 
```

...

```
public static void main(String[] args) {
    String s1j = "U2FsdGVkX18xMjM0NTY3OGEL9nxFlHrWvodMqar82NT53krNkqat0rrgeV5FAJFs1vBsZIJPZ08DJVrQPwyV15HEoyECBeAZ6MTeN+ZYHRitKanY5jiRU2J0KP0Fzola";
    String s1c = "U2FsdGVkX18xMjM0NTY3OGEL9nxFlHrWvodMqar82NT53krNkqat0rrgeV5FAJFs1vBsZIJPZ08DJVrQjQyV15HEoyECBeAZ6MTeN+ZYHRitKanY5jiRU2J0KP0Fzola";
    byte[] bytesj = DatatypeConverter.parseBase64Binary(s1j);
    byte[] bytesc = DatatypeConverter.parseBase64Binary(s1c);
    int nmax = Math.max(bytesj.length, bytesc.length);
    int nmin = Math.min(bytesj.length, bytesc.length);
    for (int i = 0; i < nmax; ++i) {
        if (i >= nmin) {
            boolean isj = i < bytesj.length;
            byte b = isj? bytesj[i] : bytesc[i];
            System.out.printf("%s [%d] %x%n", (isj? "J" : "C++"), i, (int)b & 0xFF);
        } else {
            byte bj = bytesj[i];
            byte bc = bytesc[i];
            if (bj != bc) {
                System.out.printf("[%d] J %x != C++ %x%n", i, (int)bj & 0xFF, (int)bc & 0xFF);
            }
        }
    }
} 
```

这提供

```
[60] J 3f != C++ 8d 
```

现在 0x3f 是问号的代码。

错误是，0x80 - 0xBF 是 Latin-1，正式的`ISO-8859-1`，控制字符。Windows Latin-1 正式`Windows-1252`将这些代码用于其他字符。

因此，您应该在 Java 中使用“Windows-1252”或“Cp1252”（代码页）。

* * *

***直言不讳***

在加密中，0x80 .. 0xBF 范围内的*原始*字节被替换为问号，因为某些转换为 ISO-8859-1 而不是 Windows-1252 到 byte[]。**

# windows - 用于 Windows 图形用户界面的 Perl

> ID：11121724
> 
> 赞同：1
> 
> 时间：2012-06-20T14:23:57.060
> 
> 标签：windows, perl, user-interface

我来这里之前搜索了互联网。我想每个人的需求都不一样。我想要一个 Windows GUI 程序，它可以从数据库中获取信息并将其显示在网格中，并且每条记录旁边都有一个删除按钮。我还希望它有一个链接，例如，如果单击记录的 ID 号，它会打开新浏览器并导航到与之关联的页面，并完成表单然后自行提交。

问题是：既然有很多模块，哪一个最适合这个？

(Perl 努比)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T14:47:20.040

没有人能真正说出什么是最好的，但是 `Tk` 在你的情况下，带有后端的模块选项`DBD::MySQL`可能是 Perl 中此类事情的最“标准”。两者的例子都可以在网上找到。

下面是一些使用 mySQL 和 DBD 的 SQL：

[http://sql-info.de/mysql/examples/Perl-DBI-examples.html](http://sql-info.de/mysql/examples/Perl-DBI-examples.html)

这是一个很好的 perl TK 示例文档：

[http://www.ibm.com/developerworks/aix/library/au-perltkmodule/index.html](http://www.ibm.com/developerworks/aix/library/au-perltkmodule/index.html)

至于打开浏览器 - 一个简单的系统命令就可以了：

```
my @command = ('start', $url);
system(@command); 
```

^这适用于 Windows。看起来您想要构建一个相当大的应用程序 - 打开浏览器只是其中的一小部分 - 毫无疑问，您将希望在按下按钮时执行上述操作。

最后一部分...向网络上的表单提交数据，是一个名为“网络爬虫”的主题... `WWW::Mechanize` 是一个值得研究的库 - 谷歌“perl网络爬虫”，你一定会得到更多好的例子。

我通过一些搜索找到了这个 - 它看起来对你有用：

[http://www.stratos.me/2009/05/writing-a-simple-web-crawler-in-perl/](http://www.stratos.me/2009/05/writing-a-simple-web-crawler-in-perl/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-24T16:13:38.200

给一个（讨厌的）前提条件，大约。25 行 HTML

```
<html>
 <head>
  <hta:application id="demo" scroll="No"></hta>
  <title>Demo</title>
  <script language = "PerlScript"
          src      = "demo.pl"
          type     = "text/perlscript"
  ></script>
 </head>
 <body onload="DoOnLoad()" onunload="DoOnUnLoad()">
  <object classid = "clsid:67397AA3-7FB1-11D0-B148-00A0C922E820"
          id      = "id_oDC"
          style   = "position:relative;width:1px;height:1px"
  ></object>
  <object classid = "clsid:CDE57A43-8B86-11D0-B3C6-00A0C90AEA82"
          id      = "id_oDG"
          style   = "position:relative;width:100%;height:95%"
  ></object>
 </body>
</html> 
```

和约。40 行 Perl：

```
use strict;
use warnings;

use Win32::OLE qw( in );
use Win32::OLE::Const 'Microsoft ActiveX Data Objects';
use vars qw( $window );

my $oAdoDC;
my $oAdoDG;

sub DoOnLoad {
  my $owda                    = $window->document->all;
  $oAdoDC                     = $owda->id_oDC;
  $oAdoDC->{ConnectionString} = 'DSN=SakilaGent';
  $oAdoDG                     = $owda->id_oDG;
  $oAdoDC->{CursorType}       = adOpenKeyset;
  $oAdoDG->Font->{Name}       = "Arial";
  $oAdoDG->Font->{Size}       = "8";
  $oAdoDG->HeadFont->{Name}   = "Arial";
  $oAdoDG->HeadFont->{Size}   = "8";
  $oAdoDC->{RecordSource}     = "select * from customer";
  $oAdoDG->{Caption}          = $oAdoDC->{RecordSource};
  $oAdoDC->Refresh();
  $oAdoDG->{DataSource}       = $oAdoDC;
}

sub DoOnUnLoad {
  $oAdoDG->{ DataSource }->Close();
  $oAdoDC->{ Recordset }->Close();
  $oAdoDG = undef;
  $oAdoDC = undef;
} 
```

将为您提供灵活的“显示/编辑 ADO 可访问的每个数据库中的每个记录集”类型的数据网格：

![ADO 网格](../Images/2edb9539486e15d3434c668742a1e5f8.png)

免费。熟悉 HTML（但不是 Tk 或 Wx）和 ADO/Access/Excel（但不是 DBI）的人可以轻松/有效地构建一个漂亮的数据库 GUI。前提条件（即缺点）是：即使部署计算机也需要具有“Microsoft DataGrid Control 6.0 (OLEDB)”（也有普通表格、分层和灵活的分层网格控件；也许可以使用更现代的控件也）以开发/设计时启用模式安装。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-23T12:12:21.757

我建议使用：

*   [用于用户界面的Wx](http://search.cpan.org/dist/Wx-0.9909/Wx.pm)（提供比 Tk 更现代/原生的外观；另请参见主站点[wxWidgets](http://www.wxwidgets.org/)）
*   [DBD::SQLite](http://search.cpan.org/dist/DBD-SQLite/)用于本地数据库存储
*   [WWW::Mechanize](http://search.cpan.org/dist/WWW-Mechanize/) - 提交表单

由于您使用的是 Windows，因此最好的办法是安装包含 SQLite 和 Mechanize的[Strawberry Perl 。](http://strawberryperl.com/)安装 Wx 或 Tk 是一个额外的步骤，但您应该能够在网络上从其他这样做的人那里找到教程。您可能还想查看[Padre，这是一个 Perl IDE](http://padre.perlide.org/)，它是一个 Perl 编辑器/开发环境（它也恰好使用 Wx）。

# asp.net - RequiredFieldValidator 必须点击两次

> ID：11121725
> 
> 赞同：3
> 
> 时间：2012-06-20T14:23:58.210
> 
> 标签：asp.net, requiredfieldvalidator

我遇到了与[此处描述](https://stackoverflow.com/questions/7086471/requiredfieldvalidator-requires-user-to-click-twice)的相同的问题。

只有问题被标记为已回答，仅解释为什么在输入字段上使用 RequiredFieldValidator 时可能必须单击两次 - 一次是因为文本框的模糊（例如）将更正验证，然后再次实际发布形式。

我不想点击一个按钮两次！有谁知道解决方案或解决方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T14:43:55.177

您可以添加[`EnableClientScript=false`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basevalidator.enableclientscript.aspx)到验证器。

这会阻止客户端验证，因此您将始终得到回发（尽管这可能不是您想要的）。验证仍将完成，只是在服务器端。

请务必将按钮单击逻辑包装在 a 中`if (Page.IsValid) { ... }`，以检查验证器的状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T08:55:26.130

抱歉之前没有发布代码，我认为这是 . 的标准问题`RequiredFieldValidator`，但后来意识到我的特定问题来自`CompareValidator`，用于确保输入的密码匹配。

CompareValidator 导致了我所描述的问题，导致我必须单击离开字段以进行模糊和验证，然后才能单击发布按钮。

我不知道为什么，但是将显示`CompareValidator`从*动态*更改为*静态*已经解决了问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-15T20:07:02.920

如果验证器是 Display="Dynamic"，并且错误消息的出现导致提交按钮移动，则提交按钮不会收到 MouseUp 事件。在这种情况下，验证会触发并清除错误消息，但不会触发提交按钮。要解决此问题，请将验证器设置为 Display="Static"，或者重新排列表单，以便在出现错误消息时提交按钮不会移动。

这是一种为动态验证消息保留大约一个垂直线空间的方法：

`<div style="height:1.5em;overflow:visible;"> <asp:RequiredFieldValidator ID="R1" runat="server" ErrorMessage="Name is required" ControlToValidate="TextBoxName" Display="Dynamic"></asp:RequiredFieldValidator> </div>`

我发现没有必要设置 EnableClientScript="false"，尽管这对未实现客户端验证功能的 CustomValidator 确实有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T14:29:23.013

发布您的代码始终是一个好主意，这样我们就可以在测试环境中运行您的代码并对其进行修改以确保它在发布我们的答案之前工作。

我建议添加

```
causesValidation="true" 
```

到您的按钮，看看是否有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-07T15:48:54.930

这是对我来说工作正常并有助于摆脱双击的代码。

```
 <asp:TextBox ID="TextBox1" runat="server" autocomplete="off" 
        Enabled="true" MaxLength="20" onfocus="SetActiveControl(this);" Text=""
        CausesValidation="true"  />

<asp:RequiredFieldValidator ID="RequiredFieldValidator1"
    runat="server" ControlToValidate="TextBox1" Display="Static" ErrorMessage="Ha!" SetFocusOnError="True" EnableClientScript="true" ForeColor="" InitialValue="" /> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-20T14:45:54.110

我有一个更好的主意。

**将 Text="" 添加到文本框控件。**
**将 InitialValue="" 添加到验证器控件。**
它会做什么，当它发布时，它会发现文本框的值仍然是初始值，它会抛出错误并且不会发布表单。

尝试这个：

```
<asp:RequiredFieldValidator ID="reqFieldCloseComment" ControlToValidate="tbCloseComment" ValidationGroup="ChangeStatus" ErrorMessage="Please enter a reason" Display="Dynamic" runat="server" InitialValue=""></asp:RequiredFieldValidator>
            <asp:TextBox ID="tbCloseComment" runat="server" CausesValidation="true" TextMode="MultiLine" Height="107px" Width="400px" Text=""></asp:TextBox>

        <asp:Button ID="btnCloseRequestFinal" Text="Finish" CssClass="CloseReqButton" runat="server" ValidationGroup="ChangeStatus" /> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-01-03T05:28:04.750

```
$(function() {
$("input.btn").on("click",function(){
if(Page_BlockSubmit == true) {Page_BlockSubmit = false};
})
}); 
```

Page_BlockSubmit 是一个 JS 变量，由定义验证器时从后面的代码生成的 js 定义。我还没有深入了解为什么MS需要这个变量，但是场景是：</p>

第一次单击将使 Page_BlockSubmit 变为 false。第二次单击将检查 Page_BlockSubmit 的值并返回 true。

如果您实现了我发布的代码，则每次单击按钮时，该变量都将设置为 false，这将在每次单击时触发提交。

并且，您可以使用 google chrome 来跟踪 Page_BlockSubmit 的值。

# web-services - 使用 RESTful HTTP 创建单个和多个资源

> ID：11121728
> 
> 赞同：30
> 
> 时间：2012-06-20T14:24:04.283
> 
> 标签：web-services, http, rest, web

在我的 API 服务器中，我定义了这条路线：

```
POST /categories 
```

要创建一个类别，您可以：

```
POST /categories {"name": "Books"} 
```

我认为如果你想创建多个类别，那么你可以这样做：

```
POST /categories [{"name": "Books"}, {"name": "Games"}] 
```

我只是想确认这是 Restful HTTP API 的一个好习惯。

或者应该有一个

```
POST /bulk 
```

允许他们一次执行任何操作（创建、读取、更新和删除）？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-06-20T14:45:47.420

在真正的 REST 中，您可能应该在多个单独的调用中发布它。原因是每一个都会产生一个新的表示。否则，您将如何期望得到回报。

每个帖子都应返回结果资源位置：

```
POST -> New Resource Location
POST -> New Resource Location
... 
```

但是，如果您需要批量，则创建一个批量。尽可能教条，但如果不是，实用主义就能完成工作。如果你太执着于教条主义，那么你永远做不到任何事情。

[这是一个类似的问题](https://stackoverflow.com/questions/306271/bulk-collection-manipulation-through-a-rest-restful-api)

[这是一个建议使用 HTTP Pipelining 来提高效率的方法](https://stackoverflow.com/questions/511281/patterns-for-handling-batch-operations-in-rest-web-services)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-06-20T14:57:36.987

将批量操作发布到激活并没有什么特别的问题（它将是非幂等的，因此 POST 是正确的动词），但有一些警告：

*   您正在制作多个资源，因此您需要使用多个 URL 进行响应。这意味着您不能使用重定向模式：您必须以某种形式发回 URL 列表。

*   您的问题在于批量操作通常不太容易被发现。可发现性是关于 RESTfulness 最重要的事情之一，因为这意味着有人可以在没有服务器作者大量帮助的情况下找出如何编写客户端。

*   在进行批量操作时处理部分故障仍然存在问题。这也是任何其他范式的问题（我看到人们在使用 SOAP 扩展时为此束手无策），所以这并不奇怪，但除非你能*保证*所有的创作都能正常工作，否则你就是必须弄清楚当您制作一种资源而未能制作第二种资源时会发生什么。（另外，如果批量请求想要完成第三个请求，你会继续尝试吗？）

最简单的方法是支持每个请求创建一个；这是一个更容易正确的模式，并且更容易全面理解。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-20T17:03:43.130

使用 POST 一次创建多个资源没有任何问题（只是不要使用 PUT 尝试）。它不是“非 REST-ful”，尤其是当您为批量操作本身创建表示时。我建议您在创建单个资源的同时创建一个索引资源，并返回一个“303 See Other”给它。然后，该索引表示将包含指向所有已创建资源的链接（如果其中任何一个资源失败，还可能包含错误信息）。

```
POST /categories/uploads/
[{"name": "Books"}, {"name": "Games"}]

    303 See Other
    Location: /categories/uploads/321/ 
```

*（其实现在想想，201可能比303好）*

```
GET /categories/uploads/321/

    200 OK
    Content-Type: application/json

    [{"name": "Books", "link": "/categories/Books/"},
     {"name": "Games", "error": "The 'Games' category already exists."}] 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-09-29T07:37:32.793

在您的情况下，我也会采用 /bulk 资源方式。但我建议的模式如下，据我所知，这是最自然的：使用 202 Accepted 状态代码。

批量请求的想法是服务器不应该被迫立即回答，因为这意味着客户端需要等到它的批量请求完成。

这是模式：

```
POST /bulk [{"name": "Books"}, {"name": "Games"}]
202 Accepted | Location: /bulk/processing/status/resourceId

GET /bulk/processing/status/resourceId
entry = "REST in peace" | completed | 0 errors | /categories/category/resourceId
entry = "Walking dead" | processing | 0 errors -> 
```

因此，客户端将批量信息发布到服务器。服务器仅使用 202 接受它们，这不能保证响应时的处理状态。但是服务器也提供了一个状态资源的链接。在这里，客户端可以查看每个创建的资源和处理状态。完成后，客户端可以通过给定的链接访问资源。错误情况可以由客户端识别，错误数据可能会通过 PUT 在已完成资源上重新发送。

最后，我通常遵循的一个好建议是：每当您在设计中遇到无法映射到 HTTP 功能的资源时，可能是因为缺少资源。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-11-05T13:59:55.760

实际上，直到今天这仍然是一个热门话题，但简化一些事情，我几乎经常说每次练习都有一个适合击球手的场景。例如： 1\. 如果您从帖子中收到喜欢，则不需要批量，因为以防每条评论只有一个喜欢。2\. 如果您收到最喜欢的评论，考虑某人查看他阅读的评论并选中他所有的收藏并发送一次，可以很好地适应批量。

同样，这是基于我使用 Restful API 的经验，但目前为了多任务处理和其他事情，我和我的同事发现我们自己在我们所做的大多数 MIS（管理信息系统）中一直在做大部分工作。这是因为现代网络应用程序和移动应用程序可以做很多工作并将最终结果发送到后端，这样后端只要接收到的数据不违反商业逻辑。

# php - ajax表单不更新值

> ID：11121733
> 
> 赞同：0
> 
> 时间：2012-06-20T14:24:17.853
> 
> 标签：php, html, jquery

我有这个表格可以更新 db 上的用户信息。但是，此功能不适用于 ajax（使用带刷新的简单提交）。

这将表单序列化数据发布到服务器 **jQuery**

```
 $('#commit-changes').click(function(){               

           $('#validation').submit(function(){
              $.ajax({
                type: "POST",
                data: $("#validation").serialize(),
                cache: false,
                url:"modules/user/updateuser.php",
                success : function(data){
                    $("#response-update").html(data);
                },
                error:function(){
                    alert("ERROR");
                }

            });
           });               
        }); 
```

这是输出标记 HTML 的 **HTML**

```
 $rcs_roles = $user->getRoles();
     $role ='';
     foreach($rcs_roles as $roles)
     {
        if($roles->role_number == $rcs_user->permissao) 
            $role .= '<option value="'.$roles->role_number.'" selected="selected">'.$roles->role.'</option>';
        else
            $role.= '<option value="'.$roles->role_number.'">'.$roles->role.'</option>';
     }

     if($rcs_user->activo == 0)
     {
         $activo = '<input type="checkbox" name="activo" class="on_off_checkbox"  value="1"   />';
     }
     else
     {
         $activo = '<input type="checkbox" name="activo" class="on_off_checkbox" checked="checked"  value="1"   />';
     }

     $response = '';

     $response.='<form id="validation" action="" method="post"> 
                                    <fieldset >
                                    <input type="hidden" name="user_id" 

value="'.$_POST['user_id'].'"/>
                                <legend>Actualizar Dados Utilizador</legend>
                                      <div class="section ">
                                      <label>Nome<small>Insira o seu nome</small></label>   
                                      <div> 
                                      <input type="text" class="validate[required,custom[onlyLetterSp]] large" name="nome" id="f_required" value="'.utf8_encode($rcs_user->nome).'">
                                      </div>                                      
                                      </div>';
 $response.='<div class="section ">
                                      <label> Email<small>Insira o seu email</small></label>   
                                      <div> 
                                      <input type="text" class="validate[required,custom[email]] large" name="email" id="e_required" value="'.  utf8_encode($rcs_user->email).'">
                                      </div>
                                      </div>';

 $response.= '<div class="section">
                                        <label>Permissões<small>Seleccione o tipo de utilizador </small></label>   
                                        <div>
                                            <select class="medium" name="role">

                                                       '.$role.'        

                                        </select>       
                                  </div>
                                  </div>                                      
                                 <div class="section">
                                        <label>Activo<small>Activar utilizador</small></label>   
                                         <div>
                                            '.$activo.'
                                            <span class="f_help">ON / OFF  </span> 
                                        </div>
                                  </div>

                                  <div class="section last">
                                  <div>
                                      <a id="commit-changes" class="uibutton submit_form" name="submit" >Gravar</a><a class="uibutton special"   onClick="ResetForm()" title="Limpar Formulário"   >Limpar Formulário</a>
                                 </div>
                                 </div>

                                </fieldset></form>'; 
```

然后服务器端处理 **PHP**

```
$response='';
$id_user = $_POST['user_id'];
$name = utf8_encode($_POST['nome']);
$email = utf8_encode($_POST['email']);

$permitions = $_POST['role'];

if(!isset($_POST['activo']))
{
    $active = 0;
}
else
{
    $active = 1;
}

$user = new Users();

try
{
    $user->updateUsers($name, $email, $permitions, $active, $id_user);
    $response = "SUCESSO";
}
 catch (Exception $e)
 {
    $response = "ERRO".$e->getMessage();
 }

 echo $response; 
```

很高兴我能得到所有帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T14:29:05.963

删除 .submit() 函数。像这样的东西。

```
 $.post("modules/user/updateuser.php",{data:$("#validation").serialize()},function(response){
     $("#response-update").html(response);
}); 
```

在 php 方面尝试`print_r($_POST['data']);`并请发布输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T14:25:58.440

乍一看，您似乎并没有等到文档加载完毕后才绑定事件处理程序。这意味着当您尝试添加 .click 事件处理程序时，甚至不存在 #commit-changes。

要在 jQuery 中解决此问题，请将其包装在整个代码中：

```
$(document).ready(function(){
  // do stuff
}); 
```

此函数向 jQuery 的 document.ready 处理程序发送一个回调，以便所有代码仅在页面加载后执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T17:56:15.580

在***updateUsers***函数中（在 Users 类中），您尝试更新字段**名称**或**名称**？

您应该只使用**nome**对吗？

# javascript - 在 PhantomJS 中进行评估似乎不起作用

> ID：11121734
> 
> 赞同：4
> 
> 时间：2012-06-20T14:24:23.780
> 
> 标签：javascript, phantomjs

我对 JavaScript 魔法有疑问。当我执行此代码时：

```
var page = require('webpage').create();
var url="http://google.com";
page.open(url, function (status){
  if (status!== "success") {
    console.log("Fail to load: "+url)
  }else{
    console.log('1');
    page.evaluate(function() {
      console.log('2');
      });   
    console.log('3');
  }
phantom.exit();
}); 
```

控制台只有 1 和 3，没有 2。谁能说出为什么？

[如果我在我的代码DOM 操作示例](http://code.google.com/p/phantomjs/wiki/QuickStart#DOM_Manipulation)之后粘贴（但它从不执行）我有我的两个。我是不是忘记了什么重要的事情？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-20T14:27:33.937

默认情况下，PhantomJS 不会在 .evaluate() 语句中记录控制台消息。只包括

```
page.onConsoleMessage = function (msg) {
    console.log(msg);
}; 
```

有关更多详细信息/深入示例，请参阅此页面：

[http://code.google.com/p/phantomjs/wiki/QuickStart#Code_Evaluation](http://code.google.com/p/phantomjs/wiki/QuickStart#Code_Evaluation)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-20T14:29:32.840

来自[谷歌代码](http://code.google.com/p/phantomjs/wiki/QuickStart)

> 默认情况下，不会显示来自网页的任何控制台消息，包括来自 evaluate() 内部代码的消息。要覆盖此行为，请使用 onConsoleMessage 回调。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-10T20:57:44.970

如果您只想通过选择日志，您可以返回您想要打印的值。

例如：

```
console.log(page.evaluate(function() {
    return '2';
}); 
```

# android - 为 Android AppWidget 实施许可服务

> ID：11121740
> 
> 赞同：0
> 
> 时间：2012-06-20T14:24:38.260
> 
> 标签：android, android-appwidget

实施应用程序许可非常简单，但看起来示例代码是为完整的 android 应用程序而不是小部件量身定制的。

就像，在应用程序中，我们主要在启动屏幕或主要活动中添加许可代码，如果不允许用户，那么我们只是完成活动并且不允许使用应用程序。

同样，在小部件中，任何人都可以就在哪里添加许可代码以及如果不允许用户采取什么措施提供一些线索？

如果有人能举出例子，那就太好了。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T07:26:48.337

将配置活动添加到您的小部件并在那里实现您的许可逻辑。如果您没有得到肯定的结果，请不要让他们添加小部件。您可以在小部件更新服务中进行定期许可证检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T08:05:08.310

感谢 Nikolay 指向配置活动。这就是实施许可服务的实际情况。以下是许可服务实施的配置活动：

```
package com.mobisys.android.contactwidget;

import com.google.android.vending.licensing.AESObfuscator;
import com.google.android.vending.licensing.LicenseChecker;
import com.google.android.vending.licensing.LicenseCheckerCallback;
import com.google.android.vending.licensing.ServerManagedPolicy;

import android.app.Activity;
import android.app.AlertDialog;
import android.app.Dialog;
import android.app.ProgressDialog;
import android.appwidget.AppWidgetManager;
import android.content.DialogInterface;
import android.content.Intent;
import android.net.Uri;
import android.os.Bundle;
import android.provider.Settings.Secure;
import android.widget.Toast;

public class ConfigActivity extends Activity {
    private LicenseChecker mChecker;
    private LicenseCheckerCallback mLicenseCheckerCallback;
    public static final String BASE64_PUBLIC_KEY = "PUBLIC KEY OF YOUR ACCOUNT";
    public static final byte[] SALT = new byte[] {
    -120, 30, 50, -20, 33, -100, 32, -90, -98, 104, 12,
    110, 78, -34, 105, 21, 62, 35, -12, 97
    };

    private AESObfuscator mObsfuscator;
    private String android_id;
    ProgressDialog pg;
    int mAppWidgetId = AppWidgetManager.INVALID_APPWIDGET_ID;

    @Override
    public void onCreate(Bundle bundle){
        super.onCreate(bundle);

        setResult(RESULT_CANCELED);
        Intent intent = getIntent();
        Bundle extras = intent.getExtras();
        if (extras != null) {
             mAppWidgetId = extras.getInt(
                     AppWidgetManager.EXTRA_APPWIDGET_ID,
                     AppWidgetManager.INVALID_APPWIDGET_ID);
        }

        // If they gave us an intent without the widget id, just bail.
        if (mAppWidgetId == AppWidgetManager.INVALID_APPWIDGET_ID) {
             finish();
        }

        pg=ProgressDialog.show(this, "Verification", "Verifying purchase");
        pg.show();
        android_id = Secure.getString(this.getContentResolver(), Secure.ANDROID_ID);
        mObsfuscator = new AESObfuscator(SALT, getPackageName(), android_id);
        ServerManagedPolicy serverPolicy = new ServerManagedPolicy(this,mObsfuscator);

        mLicenseCheckerCallback = new MyLicenseCheckerCallback();
        mChecker = new LicenseChecker(
            this, serverPolicy,
            BASE64_PUBLIC_KEY  // Your public licensing key.
            );
        mChecker.checkAccess(mLicenseCheckerCallback);
    }

    private void onAllow(){
         Intent resultValue = new Intent();
         resultValue.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, mAppWidgetId);
         setResult(RESULT_OK, resultValue);
         finish();
    }

    private class MyLicenseCheckerCallback implements LicenseCheckerCallback {
        @Override
        public void allow(int reason) {
            if(pg!=null&&pg.isShowing())
                pg.dismiss();
            if (isFinishing()) {
                // Don't update UI if Activity is finishing.
                return;
            }
            runOnUiThread(new Runnable(){

                @Override
                public void run() {
                    onAllow();
                }

            });
        }

        @Override
        public void dontAllow(int reason) {
            if(pg!=null&&pg.isShowing())
                pg.dismiss();

            if (isFinishing()) {
                // Don't update UI if Activity is finishing.
                return;
            }

            showDialog(0);
        }

        @Override
        public void applicationError(int errorCode) {
            Toast.makeText(ConfigActivity.this, "Application Error:"+errorCode, Toast.LENGTH_SHORT).show();
            if(pg!=null&&pg.isShowing())
                pg.dismiss();
            if (isFinishing()) return;

            finish();
        }
    }

    @Override
    protected Dialog onCreateDialog(int id) {
        // We have only one dialog.
        AlertDialog.Builder builder=new AlertDialog.Builder(this)
        .setTitle("Application Not Licensed")
        .setCancelable(false)
        .setMessage("This application is not licensed. Please purchase it from Google play")
        .setPositiveButton("Buy App", new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialog,int which) {
                Intent marketIntent = new Intent(
                    Intent.ACTION_VIEW,
                    Uri.parse("market://details?id=" + getPackageName()));
                    startActivity(marketIntent);
                    finish();
                }})
                .setNegativeButton("Exit",new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialog, int which) {
                        finish();
                }
            }
        );

        return builder.create();
    }

} 
```

# oracle - ORACLE 根据到达时间将用户消息移动到适当的目录

> ID：11121741
> 
> 赞同：0
> 
> 时间：2012-06-20T14:24:43.623
> 
> 标签：oracle

我的简化表结构如下所示：

```
MESSAGES(Id NUMBER,Content NVARCHAR2, Received_time TIMESTAMP)

DIRECTORIES(Id NUMBER, Name NVARCHAR2, PARENT NUMBER)

MESSAGES_USERS(Id NUMBER, MSG NUMBER (FK MESSAGES(Id)), USER NUMBER, DIRECTORY NUMBER (FK DIRECTORIES(Id))) 
```

因此，任务是根据接收时间将消息移动到适当的目录中。它是通过更新 MASSAGES_USERS 表和更改 DIRECTORY id 来实现的。准备好的目录结构如下所示：

```
2012--
     |
     --- 04/2012
     |
     --- 05/2012 
     |
     --- 06/2012 
```

因此，我必须将 2012 年 4 月收到的消息移动到名为 04 的目录中，该目录是当前用户目录结构中名为 2012 的目录的后代。我使用名称搜索目录

```
name LIKE TO_CHAR(M.Received_time, 'MM')||'/'||EXTRACT(YEAR FROM M.Received_time) 
```

有没有办法在不使用游标的情况下更新一条 UPDATE 语句中每条消息的目录？我已经尝试了一些相关的更新，但它们（即使有一些巨大的子查询）都不是一个合适的解决方案。

该语句应该使用消息接收时间（它要求加入这三个表）和 MESSAGES_USERS 表中的 UPDATE DIRECTORY 字段以及适当的接收 ID 来获取适当的目录 ID。

我不知道如何强制 oracle 在不使用游标循环指定一条消息的 id 的情况下使用适当的目录更新每条消息。这甚至可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:37:39.467

这行吗？

```
update messages_users mu
set directory = 
( select d.id from directories d
  join messages m on d.name = to_char(m.receved_time, 'MM/YYYY')
  where m.id = mu.msg ); 
```

# php - jQuery 预订日历

> ID：11121748
> 
> 赞同：0
> 
> 时间：2012-06-20T14:25:17.147
> 
> 标签：php, javascript, jquery, calendar

我需要一个预订日历。
我制作了这个日历，但这不能正常工作
示例：[http ://bestinvest.ge/?view=10](http://bestinvest.ge/?view=10)

谁能帮我预订日历？

我需要日历中的 3 个状态

> 保留、待定、免费

当我从 [free][res][res][res][res][free] 首先单击 Free 并再次单击 last free 时，我希望 javascript 给出错误：

> “您只能选择免费时段，您选择的时段包括预订日期。”

我知道我的 PHP 文件中有错误，但我找不到：

```
function getmonthdays($m,$y) {
 return cal_days_in_month(CAL_GREGORIAN, $m, $y);
}

   <?php 
    for($i = 1; $i <= 31; $i++) {
        if($i <10) { $day = "0".$i; }else { $day = $i; }
    echo "<th>". $day . "</th>";
    } ?>
    </tr>
    <?php 
    $thismonth = date("m");
    $thisyear = date("Y");
    $nextyear = date("Y",strtotime("+1 year"));
    $countmonths = getmonthcount("$thismonth");
    $tdid=0;
    for($i = $thismonth; $i <= 12; $i++) {

    echo "<tr><td class='month'>". getmonth($i) ."</td>";
        for($x = 1; $x <= getmonthdays($i,$thisyear); $x++) {
            $tdid++;
        echo "<td id='cl". $tdid ."' class='". checkav($thisyear,$i,$x) ."' alt='$thisyear-". $i ."-". $x ."'></td>";
        }
    echo "</tr>";
    }
     ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-02T02:05:23.470

与其在 PHP 中硬编码日历结构，不如在 Javascript/jQuery 中创建日历并将日历的开头设置为当前月份，它更加通用。

在浏览器中生成日历客户端是轻量级且响应更快的。通过 AJAX 将当前预订从站点服务器加载到日历中，并通过表单提交 (AJAX) 将新预订插入回服务器，并从服务器数据库中往返刷新更新的预订。

在此处查看我在 StackOverlow 上的完整代码示例以及我对 dateformat 问题的回答： [JavaScript Render Logic : Horizo​​ntal Dynamic Booking Calendar](https://stackoverflow.com/questions/18564661/javascript-render-logic-issue-for-dynamic-booking-calendar)

# ios - 手动签署 iOS 应用程序并更改其应用程序 ID

> ID：11121752
> 
> 赞同：2
> 
> 时间：2012-06-20T14:25:28.570
> 
> 标签：ios, code-signing, codesign

我想知道是否有一种方法可以编译我的 iOS 项目而无需任何签名并在之后自己进行签名？

我希望能够更改应用程序 ID 和一些资源，但我不想每次都使用 xcode-build 重新编译源代码。

到目前为止，我可以更改应用程序的资源并退出 IPA 文件，但我无法更改应用程序 ID，因为它已硬编码到二进制文件中。有关详细信息，请参阅下面的链接。

[http://oleb.net/blog/2011/06/code-signing-changes-in-xcode-4/](http://oleb.net/blog/2011/06/code-signing-changes-in-xcode-4/)

# c - C -Struct 数组，free 的问题，在我的 struct 数组中赋值的问题

> ID：11121753
> 
> 赞同：0
> 
> 时间：2012-06-20T14:25:34.560
> 
> 标签：c, arrays, struct, malloc, valgrind

下面是我的程序。我正在创建一个结构，使用 malloc 分配内存，因为我想要一个非常大的结构数组，然后将该结构数组传递给函数。功能并不重要，因为我无法离开主程序。我的困惑是我的编译器（gcc）说当我尝试释放每个事件时未声明它，但没有其他地方。当我注释掉它编译的自由语句时，但是 valgrind 说当我执行 each_event[i].timestamp = tim[i] 行时，我有一个大小为 4 的无效写入。上面的行被注释掉了，因为 valgrind 告诉我错误在那里（我用 gcc -g -O0 编译），即使我知道它必须表示下面的行。

```
#include <stdio.h>
#include <math.h>
#include <stdlib.h>
#include <string.h>

#define event_length 512
#define bits_n_byte 8
#define timestamp_bytes 8

typedef enum type {
    DATA, CLOCK, EXPECTED, SPILL, ALL
} type;

typedef struct event {
char clocbuffer[event_length*bits_n_byte];
char datbuffer[event_length*bits_n_byte];
char expect[event_length];
char spil[event_length];
char clocerror[event_length*bits_n_byte];
char daterror[event_length*bits_n_byte];
long unsigned int timestamp;
} event;

int i, j, k, l, length, nevents;
char **spil, **expect, **dat, **cloc, **clocerror, **daterror;
long unsigned int *tim;
char library[256];
char *runnum, *clocmode, *datmode;

void GetPiece(char*, type, struct event*);
void FindMode(type);
void ErrorPiece(type);

int main(int argc,char **argv) {
if (argc != 2) {fprintf(stderr, "Format: ./program #_patterns\nTry again.\n");}

for (i=0;i<256;i++) library[i]=i;

FILE *IN = NULL;
char *buffer = NULL;

runnum = (char *) malloc(2);
runnum = strncpy(runnum,argv[1],1);
runnum[1] = '\0';
IN=fopen(argv[1], "r");                 /*Open input file.*/

if (IN)
{
    fseek(IN, 0, SEEK_END);                 /*This finds  */
    length  = ftell(IN);                    /*the length  */
    fseek(IN, 0, SEEK_SET);                 /*of the file.*/
    buffer = malloc(length + 2);            /*for buffer.     */
    fread(buffer, 1, length, IN);
    tim = (long unsigned int *) malloc(length + 2*sizeof(long unsigned int));
    fread(tim, sizeof(long unsigned int), length/sizeof(long unsigned int), IN);
    fclose(IN);

    nevents = length/2056;
    struct event* each_event = (struct event *) malloc(nevents*sizeof(struct event));

    for (i=0; i<length/sizeof(unsigned long int); i+=2056/sizeof(unsigned long int))
    {
    tim[i] = __builtin_bswap32 (tim[i]);
    tim[i]-=0x80000000;
    //if (tim[i]<1200000000 || tim[i]>1300000000) fprintf(stderr, "Check timestamp. Either endianness, size of bytes, or size of long ints are different.");
    each_event[i].timestamp = tim[i];
    }

    clocmode = malloc(nevents);
    datmode = malloc(nevents);

    GetPiece(buffer, DATA, each_event);
    GetPiece(buffer, CLOCK, each_event);
    GetPiece(buffer, EXPECTED, each_event);
    GetPiece(buffer, SPILL, each_event);
    GetPiece(buffer, ALL, each_event);
    FindMode(DATA);
    FindMode(CLOCK);
    ErrorPiece(DATA);
    ErrorPiece(CLOCK);
}
else fprintf(stderr,"Error in file naming/opening.\n");   /*error*/
free (buffer);
free (tim);
free (runnum);
free (clocmode);
free (datmode);
free (each_event);
return 0;} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T15:13:29.467

因为`each_event`是在`if { ... }`块内声明的，所以当你尝试`free()`它时它已经超出了范围。要么在 的末尾释放它，要么在 .`if { ... }`的开头将声明与其他声明一起放入`main()`。但是，如果您执行后者，您可能会收到有关它可能在未初始化的情况下被使用的警告，因此第一个选项可能是最好的。

# javascript - 是否有适用于子域的现代 sessionStorage 替代方案？

> ID：11121754
> 
> 赞同：6
> 
> 时间：2012-06-20T14:25:39.197
> 
> 标签：javascript, cookies, local-storage, session-storage

我们最近从 cookie 切换到使用 sessionStorage - 切换的触发器是[IE 问题](https://stackoverflow.com/questions/389456/cookie-blocked-not-saved-in-iframe-in-internet-explorer)。

现在，我们发现 sessionStorage 不能跨子域工作 - 的存储`www.site.com`与`site.com`.

有没有一种现代的替代方案可以让两者合作？这很容易通过 cookie 完成，但我不想从 sessionStorage 中恢复，或者（喘气）同时使用这两种方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T06:46:27.330

这几乎是一种黑客攻击，它并不安全，但它是一个巧妙的技巧。JavaScript 对象 window.name 可以保存数据字符串，即使在加载新页面或切换域时，数据也会保留。在这里检查这个 SO：

[在 Web 浏览器中使用 window.name 作为本地数据缓存](https://stackoverflow.com/questions/2035075/using-window-name-as-a-local-data-cache-in-web-browsers)

# php - php 函数，如 wordpress the_content()

> ID：11121755
> 
> 赞同：3
> 
> 时间：2012-06-20T14:25:43.840
> 
> 标签：php

a php 中是否有一个函数（如 Wordpress 的 the_content()）可以限制文本字符串而不破坏其中可能包含的 html 标签？

```
//example:
echo substr ('<p>this <a>is</a> a test</p>', 0, 10);

//output: "<p>this <a"
//desired output: "<p>this </p>" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:33:44.997

不，没有。但是您可以深入研究 Wordpress 的源代码，看看如何`the_content()`实现这一目标。我自己没有这样做过。在较短的版本中保留 HTML 标记将是一个棘手的代码块。

你需要这个做什么？您只是想获得较长 HTML blob 的预览吗？在过去，我通过使用 and 的组合来完成此操作`strip_tags()`，`substr()`并将剥离的内容部分包装在一个新`<p>`标签中。

# spring - ModelAttribute 在提交 spring 3.0 时被覆盖

> ID：11121758
> 
> 赞同：0
> 
> 时间：2012-06-20T14:25:50.317
> 
> 标签：spring

在我的控制器中，我有以下功能

```
@ModelAttribute("ABeanCV")
public AClass getCommand_Class()
{
AClass ABean=new AClass();
ABean.setQuestions(new AutoPopulatingList(ABean.class));
return ABean;
}

@RequestMapping(method = RequestMethod.GET, value="/AFormCV.htm")
protected String showNameForm(@ModelAttribute("ABeanCV") AClass command_Class,ModelMap model)
{
command_Class.getQuestions().get(52).setAns("123456789");
command_Class.getQuestions().get(52).setPrevAns("987654321");
model.addAttribute("Question",as);
command_Class.getQuestions().get(52).setCurrAns("435678543");
model.addAttribute("Question",as);
return "ACV";
}

@RequestMapping(method = RequestMethod.POST, value="/submitQuestionForm.htm")
protected String submitNameForm(@ModelAttribute("ABeanCV") AClass commandClassCV, ModelMap model )
{
System.out.println("Ans wer to q 52 : "+commandClassCV.getQuestions().get(52).getAns());
System.out.println("PREv Ans wer to q 52 : "+commandClassCV.getQuestions().get(52).getPrevAns());
System.out.println("PREv Ans wer to q 52 : "+commandClassCV.getQuestions().get(52).getCurrAns());
model.addAttribute("Question",as);
return "ACV";
} 
```

我的 JSP

```
<form:form method="post" name="classForm" id="classForm" modelAttribute="ABeanCV" commandName="ABeanCV" action="submitQuestionForm.htm">

 here I have only 2 input values " ans and prevAns " but in my showNameForm function I am setting values for  " ans , prevAns and currAns " input values 
```

当我以表单 2 运行项目时，文件显示正常。提交表单后，当我尝试在 submitNameForm 函数中打印 3 个值时，只会打印那些显示在表单上的值，即。“ ans and prevAns ”。在 showNameForm 函数中设置的第三个值“currAns”打印 null。

提交表单时是否会覆盖 modelAttribute？我怎样才能获得“currAns”的价值？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T18:47:30.560

是的。当您提交表单时，首先 ModelAttribute 将被 getCommand_Class() 方法覆盖，然后 AClass 中的 Question 字段将设置为 UI 上显示的值。这是因为控制器中使用 ModelAttribute 注释的所有方法都被执行以初始化 Model 对象。

你可以通过

*   从 showNameForm 方法中删除 getCommand_Class() 方法和 ModelAttribute AClass。
*   创建包含所需数据的 AClass 的新对象，并在 ModelMap 中设置 AClass。
*   返回 ModelAndView 对象，以便 JSP 将获取 Model 对象。

# python - 在 Python 中，如何计算两个数据数组之间的相关性和统计显着性？

> ID：11121762
> 
> 赞同：9
> 
> 时间：2012-06-20T14:26:17.740
> 
> 标签：python, numpy, statistics, scipy, correlation

我有一组包含两个同样长的数据数组的数据，或者我可以制作一个包含两项条目的数组，我想计算数据表示的相关性和统计显着性（可能是紧密相关的，或者可能有无统​​计学显着相关性）。

我正在用 Python 编程并安装了 scipy 和 numpy。我查看并发现在[Python 中计算 Pearson 相关性和显着性](https://stackoverflow.com/questions/3949226/calculating-pearson-correlation-and-significance-in-python)，但这似乎希望对数据进行操作，使其落入指定范围内。

我假设，要求 scipy 或 numpy 给我两个数组的相关性和统计显着性的正确方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-20T14:55:29.943

如果你想计算皮尔逊相关系数，那么`scipy.stats.pearsonr`就是要走的路；虽然，意义只对更大的数据集有意义。此功能不需要将要操作的数据落入指定范围。相关性的值落在区间内`[-1,1]`，也许这就是混乱？

如果重要性不是非常重要，您可以使用`numpy.corrcoef()`.

Mahalanobis 距离确实考虑了两个数组之间的相关性，但它提供了距离度量，而不是相关性。（在数学上，马氏距离不是真正的距离函数；尽管如此，它可以在某些情况下如此使用，从而获得极大的优势。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T14:37:19.887

您可以使用这两个数组之间的[马氏距离](http://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.mahalanobis.html)，其中考虑了它们之间的相关性。

该函数在 scipy 包中：`scipy.spatial.distance.mahalanobis`

[这里](https://stackoverflow.com/questions/9935271/one-dimensional-mahalanobis-distance-in-python)有一个很好的例子

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T14:55:25.357

**scipy.spatial.distance.euclidean()**

这给出了 2 个点、2 个 np 数组、2 个列表等之间的欧几里得距离

```
import scipy.spatial.distance as spsd
spsd.euclidean(nparray1, nparray2) 
```

你可以在这里找到更多信息[http://docs.scipy.org/doc/scipy/reference/spatial.distance.html](http://docs.scipy.org/doc/scipy/reference/spatial.distance.html)

# python - 隐藏python代码

> ID：11121764
> 
> 赞同：1
> 
> 时间：2012-06-20T14:26:18.913
> 
> 标签：python, python-2.7

> **可能重复：**
> [如何保护 python 代码？](https://stackoverflow.com/questions/261638/how-do-i-protect-python-code)

如何隐藏我的python代码，我不希望每个人都可以看到代码。

我知道 python 被解释了，但是有没有办法，工具 .. 等允许某人使用该软件而无法看到代码？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-20T14:28:41.387

您可以将其简化为 pyc 文件，但这并不像完全编译。Python 并不是真正设计为能够“隐藏”代码。据我所知，完全隐藏实现细节的唯一方法是将所有核心逻辑部署在服务器上，并将其作为服务公开给分布式应用程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-20T14:31:41.747

也许 Pyrex 可以帮助你。它是一个 python 到 C 的编译器；它旨在让您使模块可用于 python。这样，您可以选择对用户隐藏的内容（就像在不透明模块中一样）和显示的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T14:34:25.353

您可能（在与一些律师交谈后）用许可证信息（合法地）涂抹您的代码，以防止第 3 方以您不希望的方式使用您的代码......但正如其他人所说，如果用户可以运行您的代码在他们的机器上，他们可以“看到”它（如果他们至少有足够的决心的话）——即使捆绑在一个`exe`或`pyc`文件中......

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-20T14:29:45.320

编译它和/或用它创建一个可执行文件？

[http://www.py2exe.org/](http://www.py2exe.org/)

# javascript - 如何从 Ajax 响应中执行主窗口中定义的 Javascript 函数

> ID：11121766
> 
> 赞同：1
> 
> 时间：2012-06-20T14:26:22.967
> 
> 标签：javascript, ajax, prototypejs

我在主 index.html 文件中定义了 Javascript 函数。
此页面的一部分使用 Ajax（使用prototype.js）进行了更新。尝试从返回的 AJAX 代码中执行主文件中定义的 Javasript 函数失败。
evalScripts: Ajax.Updater prototype.js 函数中的 true 选项没有帮助。
我该如何解决？先感谢您。

这是我的 index.html 文件：

```
<html>
<head>
<script src="js/lib/prototype.js" type="text/javascript"></script>
<script type="text/javascript">
    function foo(x) {
        alert(x);
    }

    function loadContent() {
      new Ajax.Updater('responseArea', 'response.php' , { evalScripts: true } );
    }
</script>
</head>

<body>
    <div id="main">
        <span style="cursor: pointer" onclick="loadContent();">Click on me to call Ajax response</span><br>
        <br></br>
    </div>

    <div id="responseArea">
        This will be replaced with Ajax response
    </div>
</body>
</html>

This is response.php:
  <?php
         echo '<span style="cursor: pointer" onclick="foo("foo Called from within Ajax response");">
             Click on me to call foo from within Ajax response</span>';
   ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T14:32:55.540

由于`evalScripts`is `true`，您可以将任何 JS 片段放入您的响应中，它将在 AJAX 调用完成时执行：

```
<script type="text/javascript">
foo("foo Called from within Ajax response");
</script> 
```

如果不想执行，只想包含更多的JS，可以插入一个普通的JS include标签：

```
<script type="text/javascript src="yournewcode.js"></script> 
```

这比包含 JS 内联更好，因为它允许浏览器缓存文件。

# shell - 在 Shell 脚本中打印多个副本

> ID：11121767
> 
> 赞同：0
> 
> 时间：2012-06-20T14:26:24.560
> 
> 标签：shell, printing

我在使用带有 -n 选项的 lp 命令时打印机存在一些问题，它没有打印正确数量的副本。

```
lp $file -n $numberofcopies

```

如果我使用命令

```
lp file1.txt -n 2
```

. 它打印 4 份而不是 2 份。

任何想法为什么打印机可能会这样做？我在 Ubuntu 上安装了 Brother 标签打印机

同时，如何使用循环打印多份副本

如果我需要 2 个 file1.txt 副本，则如下所示

```
lp文件1.txt
lp文件1.txt

```

我在考虑类似while循环的东西。但现在确定如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:28:53.687

```
for i in `seq 2` ; do
    lp $file
done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T15:04:38.207

该选项应该在参数之前（man lp）

```
lp -n 2 file 
```

对于 bash 中的循环

```
for((i=0;i<2;i++));do lp file;done 
```

# .net - 是否可以强制 JIT 编译程序集并获取 asm 代码？

> ID：11121768
> 
> 赞同：4
> 
> 时间：2012-06-20T14:26:24.853
> 
> 标签：.net, clr, .net-assembly

有没有办法让.NET编译的exe程序集被反汇编成纯汇编程序？也许有一些内置工具可以实现这一点。

我知道 C# 代码被编译成 IL，然后在运行时 JIT 编译它的机器代码。问题是我能否以某种方式强制 jit 编译为程序集并将此输出用于文本文件。或者我很困惑，我对 CLR 工作原理的理解是错误的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T15:04:34.287

你想用它做什么？我不认为你可以直接做到这一点。

假设您已使用[Ngen](http://msdn.microsoft.com/en-us/library/6t9t5wcf%28v=vs.100%29.aspx)创建本机映像，本机映像缓存应位于某个路径，例如

```
C:\Windows\assembly\NativeImages_v4.0.30319_32\ 
```

确切的路径取决于框架版本以及可能的其他一些因素，我认为您不能保证它会一直存在。如果您在其中找到您的本机映像，则可以使用反汇编程序查看机器代码。

# ruby-on-rails - Rails 方式：在一个控制器的显示页面上获取链接并将其连接到另一个控制器的新页面

> ID：11121769
> 
> 赞同：1
> 
> 时间：2012-06-20T14:26:25.490
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有我的持有人（将其视为一个关系表，其中包含属于某个持有人的所有问题以及持有人特定数据（如姓名））显示页面问题列表和指向新问题链接的链接。

```
<% @questions.each do |question| %>
    <%= question.question %> 
    <%= question.answer %>
    <%= link_to "Edit Question", edit_question_path(question) %>
    <br />
<% end %>

<%= link_to "New Question", new_question_path %> 
```

这样做的目的是在创建新问题时设置 holder_id。如果这很重要，我在模型中设置了 belongs_to 和 has_many。

我尝试了一些不同的方法，例如，`<%= link_to "New Question", new_question_path(@holder) %>`但这只是将格式设置为：@holder.id。我想，我可以滥用它来使它工作，但这是一个非常丑陋的黑客。

我听说人们过度使用嵌套路由，并且深度不超过 2 或 3。所以必须有一种方法可以在不使用嵌套路由的情况下做到这一点。

1.  我是否正确，因为有一种方法可以在不使用嵌套路由的情况下做到这一点？它是什么？
2.  为什么嵌套路由对于这个例子来说是个好主意或坏主意？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:31:02.483

我想你可以做这样的事情。
在您指向新的链接中：

```
<%= link_to "New Question", new_question_path(:holder_id => @holder.id) 
```

此链接将使您的请求将**holder_id**作为参数发送到**question_controller.rb中的****新**操作。所以你可以像这样使用它：

 **```
def new
  holder_id = params[:holder_id]
  # Do something with this id
  # ...
end 
```**

# java - 当我运行 mockito 测试时发生 WrongTypeOfReturnValue 异常

> ID：11121772
> 
> 赞同：122
> 
> 时间：2012-06-20T14:26:33.387
> 
> 标签：java, mockito

错误详情：

```
org.mockito.exceptions.misusing.WrongTypeOfReturnValue: 
Boolean cannot be returned by updateItemAttributesByJuId()
updateItemAttributesByJuId() should return ResultRich
This exception might occur in wrongly written multi-threaded tests.
Please refer to Mockito FAQ on limitations of concurrency testing. 
```

我的代码：

```
@InjectMocks
protected ItemArrangeManager arrangeManagerSpy = spy(new ItemArrangeManagerImpl());
@Mock
protected JuItemWriteService juItemWriteService;

when(arrangeManagerSpy
    .updateItemAttributes(mapCaptor.capture(), eq(juId), eq(itemTO.getSellerId())))
    .thenReturn(false); 
```

如您所见，我正在调用`when`on `updateItemAttributes`（它确实返回 a `boolean`）而不是 on `updateItemAttributesByJuId`。

1.  为什么 Mockito 试图返回`boolean`from `updateItemAttributesByJuId`？
2.  如何纠正？

* * *

## 回答 #1

> 赞同：252
> 
> 时间：2012-07-17T09:55:22.520

根据[https://groups.google.com/forum/?fromgroups#!topic/mockito/9WUvkhZUy90](https://groups.google.com/forum/?fromgroups#!topic/mockito/9WUvkhZUy90)，您应该改写您的

```
when(bar.getFoo()).thenReturn(fooBar) 
```

至

```
doReturn(fooBar).when(bar).getFoo() 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2013-12-02T12:54:09.820

出现类似错误消息的另一个原因是试图模拟一个`final`方法。不应尝试模拟最终方法（请参阅[最终方法](https://stackoverflow.com/questions/3793791/final-method-mocking)模拟）。

我还在多线程测试中遇到了错误。gna 的回答在这种情况下有效。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2018-05-25T09:31:51.470

很感兴趣的问题。在我的情况下，当我尝试在类似的行上调试我的测试时导致了这个问题：

```
Boolean fooBar;
when(bar.getFoo()).thenReturn(fooBar); 
```

重要的一点是测试在没有调试的情况下正确运行。

无论如何，当我用下面的代码片段替换上面的代码时，我能够毫无问题地调试问题行。

```
doReturn(fooBar).when(bar).getFoo(); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2018-05-09T16:48:46.970

对我来说，这意味着我正在运行这个：

```
a = Mockito.mock(SomeClass.class);
b = new RealClass();
when(b.method1(a)).thenReturn(c); 
// within this method1, it calls param1.method2() -- note, b is not a spy or mock 
```

所以发生的事情是，mockito 正在检测`a.method2()`正在调用的那个，并告诉我我不能`c`从`a.method2()`哪个错误返回。

修复：使用`doReturn(c).when(b).method1(a)`样式语法（而不是`when(b.method1(a)).thenReturn(c);`），这将帮助您更简洁快速地发现隐藏的错误。

或者在这种特殊情况下，在这样做之后它开始显示更准确的“NotAMockException”，我将其更改为不再尝试从非模拟对象设置返回值。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-09-18T19:29:48.083

我最近遇到了这个问题。问题是我试图模拟的方法没有访问修饰符。添加公众解决了这个问题。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-07-12T08:23:22.333

我有这个错误是因为在我的测试中我有两个期望，一个是模拟类型，一个是具体类型

```
MyClass cls = new MyClass();
MyClass cls2 = Mockito.mock(Myclass.class);
when(foo.bar(cls)).thenReturn(); // cls is not actually a mock
when(foo.baz(cls2)).thenReturn(); 
```

我通过将 cls 更改为模拟来修复它

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-06-14T16:21:56.060

在我的情况下，问题是由于尝试模拟静态方法而忘记调用`mockStatic`类引起的。我也忘了把课程包括在`@PrepareForTest()`

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-04-23T18:42:03.607

就我而言，我同时使用`@RunWith(MockitoJUnitRunner.class)`和`MockitoAnnotations.initMocks(this)`。当我删除它时`MockitoAnnotations.initMocks(this)`，它工作正常。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-01-08T17:16:32.440

如果您使用注解，可能需要使用@Mock 而不是@InjectMocks。因为@InjectMocks 作为@Spy 和@Mock 一起工作。@Spy 会跟踪最近执行的方法，您可能会觉得返回/替换了不正确的数据。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2020-07-15T17:44:23.210

**TL;DR**如果您的测试中的某些参数是`null`，请务必使用`isNull()`而不是模拟参数调用`anyXXX()`。

* * *

从 Spring boot 1.5.x 升级到 2.1.x 时出现此错误。Spring boot 附带了自己的 Mockito，现在也升级到 2.x（参见[Spring boot 2.1.2 的依赖项](https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE/reference/html/appendix-dependency-versions.html)）

Mockito 更改了`anyXXX()`方法的行为，其中`XXX`is `String`，`Long`等。这是 javadoc 的`anyLong()`：

> 从 Mockito 2.1.0 开始，只允许 valued `Long`，因此 `null`不再是有效值 由于原始包装器可以为空，建议**匹配** `null`包装器的 API 是`#isNull()`. 我们认为这种变化将使测试工具比 Mockito 1.x 更安全。

我建议你调试到你的模拟将被调用并检查，是否**至少一个**参数是`null`. 在这种情况下，请确保您使用`isNull()`而不是 eg 来准备模拟`anyLong()`。

所以这：

```
when(MockedClass.method(anyString()); 
```

变成：

```
when(MockedClass.method(isNull()); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-10-19T11:33:07.957

*我最近在模拟 Kotlin 数据类*中的函数时遇到了这个问题。由于某种未知原因，我的一次测试运行最终处于冻结状态。当我再次运行测试时，我之前通过的一些测试开始失败并出现`WrongTypeOfReturnValue`异常。

我确保我`org.mockito:mockito-inline`用来避免最终课程的问题（Arvidaa 提到），但问题仍然存在。为我解决的问题是**终止进程并重新启动 Android Studio**。这终止了我的冻结测试运行，并且以下测试运行顺利通过。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-11-07T18:26:06.713

在我的例子中，bean 已经使用*@Autowired*注释而不是*@MockBean进行了初始化*

因此，以这种方式模拟 DAO 和服务会引发此类异常

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-03-24T16:29:19.893

在我的情况下，或者更确切地说是`Android`项目的仪器测试，
我只需要删除`build`目录（强制重建）。

也许一个错误的原因太多了！
（他们应该已经解决了这个问题）。

但我希望这对某人有帮助
d= (◕‿↼ )

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-06-11T11:24:38.063

对我来说，问题是在共享模拟上进行存根/验证的多线程测试。它导致随机抛出`WrongTypeOfReturnValue`异常。

这不是使用 Mockito 正确编写的测试。不应从多个线程访问模拟。

解决方案是为每个测试制作本地模拟。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2019-10-01T09:54:14.377

我遇到了这个问题`WrongTypeOfReturnValue`，因为我模拟了一个返回 a 的方法`java.util.Optional;`，`com.google.common.base.Optional;`因为我的格式化程序会自动添加缺少的导入。

Mockito 只是在说“method something() 应该返回 Optional”...

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2018-05-04T21:49:35.200

错误：

> org.mockito.exceptions.misusing.WrongTypeOfReturnValue：
> String 不能由 size() 返回
> size() 应该返回 int
> ***
> 如果您不确定为什么会出现上述错误，请继续阅读。
> 由于上述语法的性质，可能会出现以下问题，因为：
> 1\. 此异常*可能*发生在错误编写的多线程
> 测试中。
> 有关并发测试的限制，请参阅 Mockito 常见问题解答。
> 2\. 使用 when(spy.foo()).then() 语法对 spy 进行存根。 使用 doReturn|Throw() 系列方法来
> 存根间谍更安全。
> 更多关于
> Mockito.spy() 方法的 javadocs。

实际代码：

```
@RunWith(PowerMockRunner.class)
@PrepareForTest({ Object.class, ByteString.class})

@Mock
private ByteString mockByteString;

String testData = “dsfgdshf”;
PowerMockito.when(mockByteString.toStringUtf8()).thenReturn(testData); 
// throws above given exception 
```

解决此问题的解决方案：

第一次删除注释“@Mock”。

```
private ByteString mockByteString; 
```

第二次添加`PowerMockito.mock`

```
mockByteString = PowerMockito.mock(ByteString.class); 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2019-02-18T03:26:22.327

在要模拟的 bean 上缺少 @MockBean

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-02-11T15:12:21.717

我正在使用 Scala，并且收到了这条消息，我错误地在两个`Object`s 之间共享了一个 Mock。因此，请确保您的测试彼此独立。并行测试执行显然会产生一些不稳定的情况，因为 Scala 中的对象是单例组合。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-11-03T04:18:32.877

就我而言，事实证明模拟对象的类型实际上是一个抽象接口，将类型更改为某个实现类后问题得到解决，

改变

```
@Mock
private Proxy proxy; 
```

至

```
@Mock
private ProxyImpl proxy; 
```

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2018-12-03T21:14:45.987

这是我的情况：

```
//given
ObjectA a = new ObjectA();
ObjectB b = mock(ObjectB.class);
when(b.call()).thenReturn(a);

Target target = spy(new Target());
doReturn(b).when(target).method1();

//when
String result = target.method2(); 
```

然后我得到这个错误：

```
org.mockito.exceptions.misusing.WrongTypeOfReturnValue: 
ObjectB$$EnhancerByMockitoWithCGLIB$$2eaf7d1d cannot be returned by method2()
method2() should return String 
```

猜一下？

问题是 Target.method1() 是一个静态方法。Mockito 完全警告我另一件事。

# .net - Internet Explorer 保护模式错误

> ID：11121773
> 
> 赞同：9
> 
> 时间：2012-06-20T14:26:38.723
> 
> 标签：.net, selenium, nunit, webdriver

我在 Visual Studio 中的代码使用的是 selenium webdriver 2.24.0。我正在使用的测试框架是 Nunit。在 2.24.0 版本发布之前，我的代码运行良好（加载不同的浏览器、驱动网站）。

我将新的 IE 独立服务器添加到我的项目中。

现在，每当我运行我的代码时，NUnit 都会遇到此错误消息。

```
 FirstSeleniumTest.SeleniumTest.TestGoogle:
SetUp : System.InvalidOperationException : Unexpected error launching Internet Explorer. Protected Mode settings are not the same for all zones. Enable Protected Mode must be set to the same value (enabled or disabled) for all zones. (NoSuchDriver)
TearDown : System.NullReferenceException : Object reference not set to an instance of an object. 
```

然后命令提示符弹出这个。

```
Started InternetExplorerDriver server (64-bit)
2.24.0.0
Listening on port 50329 
```

我在我的 IE 上禁用了保护模式。仍然没有运气。

我怎样才能让我的代码恢复到正确的网络驱动？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-20T16:26:49.673

*您应确保为所有*4 个安全区域（Int​​ernet、本地 Intranet、受信任站点、受限制站点）启用或禁用保护模式。换言之，所有安全区域的设置值应该相同。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-07-18T12:31:51.923

只是为了添加到已经正确的答案，如果将所有值设置为相同不是一个选项，（需要禁用安全性是某些区域，但希望在其他区域保持启用安全性）您还可以使用包含的重载初始化驱动程序`InternetExplorerOptions`，并且利用

```
new InternetExplorerOptions() { IntroduceInstabilityByIgnoringProtectedModeSettings = true} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-21T06:33:51.800

您需要将每个区域的保护模式设置设置为相同的值。阅读：[http ://code.google.com/p/selenium/wiki/InternetExplorerDriver#Required_Configuration](http://code.google.com/p/selenium/wiki/InternetExplorerDriver#Required_Configuration)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-10-09T14:14:14.737

我同意 Alexander 的说法，但是如果您的公司不允许您对 IE 设置进行任何更改怎么办。

* * *

**以下对我有用：**

```
 File file = new File("M:\\dev\\ria\\iedriver\\2.42.0\\install\\exec\\IEDriverServer.exe");
    System.setProperty("webdriver.ie.driver", file.getAbsolutePath());

    DesiredCapabilities caps = DesiredCapabilities.internetExplorer();
    caps.setCapability(CapabilityType.ACCEPT_SSL_CERTS, true);  
    caps.setCapability(InternetExplorerDriver.INTRODUCE_FLAKINESS_BY_IGNORING_SECURITY_DOMAINS,true);

    WebDriver driver = new InternetExplorerDriver(caps);
    driver.get("http://www.google.com"); 
```

# uitableview - 拖动 TableViewCells 时将其推开。（类似于 UITableViewCellReorderControl）

> ID：11121774
> 
> 赞同：2
> 
> 时间：2012-06-20T14:26:39.913
> 
> 标签：uitableview, drag-and-drop, placeholder

我想拥有与 UITableViewCell 中的 UITableViewCellReorderControl 类似的功能，但据我所知，我不能使用 reordercontrol。

我已经为多个 UITableViews 实现了拖放。我可以将一个单元格从任何 TableView 拖动到任何其他单元格。到目前为止，拖放确实有效。现在，当我将对象拖到 2 个单元格上时，我想将单元格分开，就像 Apple 在 Tableviews 中或重新排序应用程序时那样（您可能放置的位置变空以指示放置位置）。

我想到的解决方案是： 1\. 在放置位置插入一个占位符图像（这不太好，因为我必须一直与 CoreData 同步） 2\. 更改单元格的高度以模拟其下方的空白空间。

我不认为这是最好的解决方案。

# sql - 使用 Pivot 转换 SQL 表的形状

> ID：11121775
> 
> 赞同：2
> 
> 时间：2012-06-20T14:26:40.660
> 
> 标签：sql, sql-server, sql-server-2008-r2, pivot

我有一些数据以下列格式存储在表中

```
BatchID              EntityChanged             ChangeValue

EERS                  ABC                       DEF
EERS                  ABCD                      XYZ
EERS                  Something                 SomeValue
New Batch             SomethingMore             GHI 
```

可以出现在“EntityChanged”列中的值列表是有限的，事先已知并且其中没有空格等。为了争论，让我们说这个列表是 - ABC，ABCD，Something，SomethingMore

然后对于上面的数据集，我想要一个输出

```
BatchID            ABC              ABCD            Something       SomethingMore
EERS               DEF              XYZ             SomeValue       NULL   
New Batch          NULL             NULL            NULL            GHI 
```

使用 Pivot 我只能走这么远。

有人可以帮我以所需的方式分割这些数据吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T14:51:38.707

您可以为此使用 PIVOT，通过静态 PIVOT 或动态 PIVOT，如果您有未知数量的列，这可能会很好。

静态（参见[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/5e8e9/1)）：

```
create table t2
(
    batchid varchar(10),
    entitychanged varchar(20),
    changevalue varchar(10)
)

insert into t2 values ('EERS', 'ABC', 'DEF')
insert into t2 values ('EERS', 'ABCD', 'XYZ')
insert into t2 values ('EERS', 'Something', 'SomeValue')
insert into t2 values ('New Batch', 'SomethingMore', 'GHI')

select *
from 
(
    select batchid, entitychanged, changevalue
    from t2
) x
pivot
(
    min(changevalue)
    for entitychanged in ([ABC], [ABCD], [Something], [SomethingMore])
) p 
```

动态（参见[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/5e8e9/2)）：

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX);

select @cols = STUFF((SELECT distinct ',' + QUOTENAME(entitychanged) 
                    from t2
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT batchid, ' + @cols + ' from 
             (
                 select batchid, entitychanged, changevalue
                 FROM   t2
            ) x
            pivot 
            (
                min(changevalue)
                for entitychanged in (' + @cols + ')
            ) p '

execute(@query) 
```

两者都会给你相同的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T14:38:09.420

尝试这个：

```
SELECT BatchID, 
   MAX(CASE WHEN EntityChanged = 'ABC' THEN ChangeValue END) 'ABC',
   MAX(CASE WHEN EntityChanged = 'ABCD' THEN ChangeValue END) 'ABCD',
   MAX(CASE WHEN EntityChanged = 'Something' THEN ChangeValue END) 'Something',
   MAX(CASE WHEN EntityChanged = 'SomethingMore' THEN ChangeValue END) 'SomethingMore'
FROM YourTable t 
GROUP BY BatchID 
```

## [演示](https://data.stackexchange.com/stackoverflow/query/73513)

# java - 如何让 jboss 显示 log.debug 消息？

> ID：11121778
> 
> 赞同：3
> 
> 时间：2012-06-20T14:26:46.650
> 
> 标签：java, jboss, log4j

**myController.java**

```
 private static final Logger log = Logger.getLogger(myController.class
  .getName());
@GET
  @Path("/testDebug")
  public String testDebug(@Context final ServletContext context)
  {
    log.error("This is an error message");
    log.debug("This is a debug message");
    log.fatal("This is fatal message");
    log.warn("This is a warn message");
    log.info("This is a info message");

    return "Test Page.  Debug Mode is on =" + log.isDebugEnabled();
  } 
```

**jboss-log4j.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">

<!-- ===================================================================== -->
<!--                                                                       -->
<!--  Log4j Configuration                                                  -->
<!--                                                                       -->
<!-- ===================================================================== -->

<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/" debug="false">

   <!-- ================================= -->
   <!-- Preserve messages in a local file -->
   <!-- ================================= -->

   <!-- A time/date based rolling appender -->
   <appender name="FILE" class="org.jboss.logging.appender.DailyRollingFileAppender">
      <errorHandler class="org.jboss.logging.util.OnlyOnceErrorHandler"/>
      <param name="File" value="${jboss.server.log.dir}/server.log"/>
      <param name="Append" value="false"/>

      <!-- Rollover at midnight each day -->
      <param name="DatePattern" value="'.'yyyy-MM-dd"/>

      <layout class="org.apache.log4j.PatternLayout">
         <!-- The default pattern: Date Priority [Category] Message\n -->
         <param name="ConversionPattern" value="%d %-5p [%c] %m%n"/>

          -->
      </layout>
   </appender>

   <!-- ============================== -->
   <!-- Append messages to the console -->
   <!-- ============================== -->

   <appender name="CONSOLE" class="org.apache.log4j.ConsoleAppender">
      <errorHandler class="org.jboss.logging.util.OnlyOnceErrorHandler"/>
      <param name="Target" value="System.out"/>
      <param name="Threshold" value="DEBUG"/>

      <layout class="org.apache.log4j.PatternLayout">
         <!-- The default pattern: Date Priority [Category] Message\n -->
         <param name="ConversionPattern" value="%d{ABSOLUTE} %-5p [%c{1}] %m%n"/>
      </layout>
   </appender>

   <!-- ================ -->
   <!-- Limit categories -->
   <!-- ================ -->

   <!-- Limit the org.apache category to INFO as its DEBUG is verbose -->
   <category name="org.apache">
      <priority value="INFO"/>
   </category>

   <!-- Limit the org.jboss.serial (jboss-serialization) to INFO as its DEBUG is verbose -->
   <category name="org.jboss.serial">
      <priority value="INFO"/>
   </category>

   <!-- Limit the org.jgroups category to WARN as its INFO is verbose -->
   <category name="org.jgroups">
      <priority value="WARN"/>
   </category>

   <!-- Limit the jacorb category to WARN as its INFO is verbose -->
   <category name="jacorb">
      <priority value="WARN"/>
   </category>

   <!-- Limit JBoss categories -->
   <category name="org.jboss">
      <priority value="INFO"/>
      <appender-ref ref="CONSOLE"/>
   </category>

   <!-- Limit the JSR77 categories -->
   <category name="org.jboss.management">
      <priority value="INFO"/>
   </category>

   <!-- This is is the package to myController.java -->
   <category name="com.myPackage.src">
      <priority value="DEBUG"/>
   </category>

   <!-- ======================= -->
   <!-- Setup the Root category -->
   <!-- ======================= -->

   <root>
      <appender-ref ref="CONSOLE"/>
      <appender-ref ref="FILE"/>
   </root>

</log4j:configuration> 
```

**期望的结果**

当路径`/testDebug`被命中时得到消息：“这是一条调试消息”

**问题：**

**除了**调试，我得到所有要显示的消息

```
10:29:49,440 INFO  [STDOUT] 10:29:49,440 ERROR [myController] This is an error message
10:29:49,440 INFO  [STDOUT] 10:29:49,440 FATAL [myController] This is fatal message
10:29:49,440 INFO  [STDOUT] 10:29:49,440 WARN  [myController] This is a warn message
10:29:49,440 INFO  [STDOUT] 10:29:49,440 INFO  [myController] This is a info message 
```

为什么我无法显示调试消息？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-01-14T03:55:49.520

有关查看 Jboss 7.1.1+ 的调试日志的更新信息，请参阅[此问题。](https://stackoverflow.com/questions/22044656/logging-with-debug-level-in-jboss-7-1-1?rq=1)

几点：

1.  您的班级`myController`按预期使用日志记录。（*另一个答案声称您错误地实例化了您的记录器；不是真的。*）

2.  从您的项目中删除 log4j.xml（或 logback.xml 等）配置文件（即，从`main/resources/META-INF`）

3.  在您的`pom.xml`中，确保您的`slf4j`依赖项具有提供的范围**（** Jboss 将提供此）。此外，不要包含 log4j（或 logback 等）实现依赖项。例如，您的日志记录依赖项部分可能如下所示：

    ```
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>1.7.7</version>
        <scope>provided</scope>
    </dependency> 
    ```

4.  确保您的文件中有您的包的**记录器**`standalone/configuration/standalone.xml`条目。

    ```
    <logger category="com.myPackage.src">
         <level name="DEBUG"/>
    </logger> 
    ```

5.  确保**控制台处理程序**和**周期性旋转文件处理**程序处理程序具有调试级别。（默认情况下，它们是 INFO。它们需要是 DEBUG 否则您的调试语句将被忽略。）

*请注意，有一个 CLI 允许您更新日志记录。我手动完成，但使用 CLI 可能是明智的。*

这是您的`standalone.xml`日志记录部分的缩写版本：

```
 <subsystem xmlns="urn:jboss:domain:logging:2.0">
        <console-handler name="CONSOLE">
            <level name="DEBUG"/>
            <formatter>
                <named-formatter name="COLOR-PATTERN"/>
            </formatter>
        </console-handler>
        <periodic-rotating-file-handler name="FILE" autoflush="true">
            <level name="DEBUG"/>
            <formatter>
                <named-formatter name="PATTERN"/>
            </formatter>
            <file relative-to="jboss.server.log.dir" path="server.log"/>
            <suffix value=".yyyy-MM-dd"/>
            <append value="true"/>
        </periodic-rotating-file-handler>
        <logger category="com.myPackage.src">
            <level name="DEBUG"/>
        </logger>
        <root-logger>
            <level name="INFO"/>
            <handlers>
                <handler name="CONSOLE"/>
                <handler name="FILE"/>
            </handlers>
        </root-logger>
        <formatter name="PATTERN">
            <pattern-formatter pattern="%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"/>
        </formatter>
        <formatter name="COLOR-PATTERN">
            <pattern-formatter pattern="%K{level}%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"/>
        </formatter>
    </subsystem> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T17:20:23.133

您的类别定义不正确。当您实例化您正在使用的记录器时，[`Class.getName()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getName%28%29)它会返回完全限定的类名。您只使用包名称定义您的记录器类别，这意味着没有为该类别打开调试`com.myPackage.src.myController`。

您需要更改实例化记录器的方式

```
private static final Logger log = Logger.getLogger(myController.class.getPackage().getName()); 
```

或更改您的类别定义

```
<category name="com.myPackage.src.myController">
  <priority value="DEBUG"/>
</category> 
```

另一方面，包不应该有大写字符，类名应该总是以大写字母开头。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T15:41:43.970

您可以尝试这样做吗：

```
<category name="com.myPackage.src">
      <priority value="DEBUG"/>
   </category> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2020-03-03T08:13:19.490

```
Detailed information could be found at: https://docs.jboss.org/author/display/AS71/Logging+Configuration
<subsystem xmlns="urn:jboss:domain:logging:1.0">
   <console-handler name="CONSOLE" autoflush="true">
       <level name="DEBUG"/>
       <formatter>
           <pattern-formatter pattern="%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"/>
       </formatter>
   </console-handler>
   <periodic-rotating-file-handler name="FILE" autoflush="true">
       <formatter>
           <pattern-formatter pattern="%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"/>
       </formatter>
       <file relative-to="jboss.server.log.dir" path="server.log"/>
       <suffix value=".yyyy-MM-dd"/>
   </periodic-rotating-file-handler>
   <logger category="com.arjuna">
       <level name="WARN"/>
   </logger>
   [...]
   <root-logger>
       <level name="DEBUG"/>
       <handlers>
           <handler name="CONSOLE"/>
           <handler name="FILE"/>
       </handlers>
   </root-logger>
</subsystem> 
```

1.可以在standalone.xml中进行更改2.上面的解决方案是显示如何在jboss中查看日志的调试消息这将解决上述问题

# wcf - 在 IIS6 上部署 WCF 服务

> ID：11121779
> 
> 赞同：1
> 
> 时间：2012-06-20T14:26:46.540
> 
> 标签：wcf, deployment, iis-6

我有一个需要在 IIS6 上部署的 WCF RESTFull 服务。我以前从未这样做过，而且我对 IIS 环境完全陌生。我在论坛上找到了一个很好的解决方案，但它对我的情况不够精确。也许有人可以根据这个解决方案给我一个更扩展的版本：

> 选项 1 - “bin”部署（首选选项）
> 
> 1.  将您的 WCF 服务编译为 DLL（类库）
>     2.  在 IIS6 中创建网站
>     3.  将 WCF DLL 复制到网站的 .\bin 文件夹中
>     4.  在该网站中创建一个 *.svc 文件
>     5.  在网站文件夹中添加适当的 web.config 以定义您的端点和服务配置等。
> 
> 您的 WCF 服务现在可以通过网站的基地址以及 *.svc 文件的名称访问，例如
> 
> [http://myserver/someweb/Myservice.svc](http://myserver/someweb/Myservice.svc)
> 
> 你的 *.svc 看起来像这样：
> 
> Service= 属性表示实现服务的类 - 完全限定其名称空间。

第 3 点中的 .\bin 文件夹是什么？我在哪里可以找到它？

我需要网站属性页选项卡的确切设置。还有地址：[http://myserver/someweb/Myservice.svc](http://myserver/someweb/Myservice.svc) ... someweb 是什么？网站的物理目录？还是 webconfig 文件中的基地址？

具有所有需要设置的步骤指南的确切步骤会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:30:41.780

对于“/bin”，在您创建的网站的根目录中手动创建它并将程序集复制到其中。

在网站的根目录中创建 .svc 并使用类似的 url 访问它；

```
http://yourwebsitename/service.svc 
```

# c# - 转换 InArgument 进入 T 型

> ID：11121791
> 
> 赞同：2
> 
> 时间：2012-06-20T14:27:32.530
> 
> 标签：c#, workflow-foundation-4

我正在为工作流制作自定义活动，但在使用 InArguments 时遇到问题。我有字符串类型的 InArguments，我想在代码中用作字符串，但我找不到进行这种转换的方法。我在网上搜索过，但找不到解决方案。

我很确定我应该在创建变量时在“get-set”中执行此操作，但不知道如何准确地进行此转换。

这是我创建变量的地方：

```
[Input("Job Name")]
[Default("BMS_ExtractTransformLoad")]
public InArgument<String> JobName { get; set; } 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T14:29:20.580

你可以通过这种方式得到它。

```
var jobName = JobName.Get(activityContext); 
```

# asp.net-mvc - 如何在 MVC/Razor 视图中显示和编辑分数

> ID：11121793
> 
> 赞同：0
> 
> 时间：2012-06-20T14:27:34.200
> 
> 标签：asp.net-mvc, razor

我正在尝试在 MVC 应用程序中显示和编辑分数。以前在 WPF 中，我使用[转换器](http://wpftutorial.net/ValueConverters.html)的概念来获取双精度并将其格式化为用户的分数，然后获取用户输入并将其转换回分数。在 Razor 视图中执行此操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T18:20:45.180

我承认这比我想象的要难。我仍然不确定这是否是最好的方法，但它确实有效。

我定义了一个超级简单的模型：

```
public class MyModel
{
    [DataType("Fraction")] //It's important to define DataType
    public double MyDouble { get; set; }
} 
```

这是我的简单控制器：

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
        MyModel ViewModel = new MyModel { MyDouble = 0.06 };
        return View(ViewModel);
    }

    [HttpPost]
    public ActionResult Index(MyModel model)
    {
        // Update db.
        // Do what you want to do.
        return View(model);
    }
} 
```

索引视图（\Views\Home\Index.cshtml）：

```
@model MvcApplication1.Models.MyModel
@{ViewBag.Title = "Index";}

@Html.DisplayFor(m => m.MyDouble)
<br />
@using (Html.BeginForm("Index", "Home"))
{
    @Html.EditorFor(m => m.MyDouble)
    <input type="submit" value="Submit" />
}
<script type="text/javascript">
    function fraction_changing(hiddenFieldId, numeratorId, denominatorId) {
        var numeratorValue = document.getElementById(numeratorId).value;
        var denominatorValue = document.getElementById(denominatorId).value;
        var hiddenField = document.getElementById(hiddenFieldId);
        hiddenField.value = numeratorValue / denominatorValue;
    }
</script> 
```

您将在一分钟内了解上述 Javascript 代码。

显示模板也很简单。我刚刚使用[Fraction 类](http://www.codeproject.com/Articles/9078/Fraction-class-in-C)（由[Syed Mehroz Alam 编写](http://www.codeproject.com/script/Membership/View.aspx?mid=778360)）将双精度值转换为 Fraction。

如您所知，模板（即部分视图）应放在“Views”文件夹下的“DisplayTemplates”和“EditorTemplates”文件夹中。我更喜欢将它们放在“Views\Shared\”中，这样​​所有其他视图都可以使用它。

Fraction.cshtml (\Views\Shared**DisplayTemplates\Fraction.cshtml**)

```
@using Mehroz // Fraction class lives in Mehroz namespace
@inherits System.Web.Mvc.WebViewPage<double>
@{
    Fraction fraction = new Fraction(Model);
}
@fraction.Numerator / @fraction.Denominator 
```

现在让我们看看棘手的部分，即编辑模板。

所以这里是 Fraction.cshtml (\Views\Shared**EditorTemplates\Fraction.cshtml**)

```
@using Mehroz
@inherits System.Web.Mvc.WebViewPage<double>
@{
    Fraction fraction = new Fraction(Model);
    string numeratorStr = fraction.Numerator.ToString();
    string denominatorStr = fraction.Denominator.ToString();

    string unifier = Guid.NewGuid().ToString().Replace('-', '_');
    string hiddenFieldElementId = string.Format("hiddenField{0}", unifier);
    string numeratorElementId = string.Format("numerator{0}", unifier);
    string denominatorElementId = string.Format("denominator{0}", unifier);
    string onchangingFunctionSyntax = 
        string.Format("fraction_changing('{0}', '{1}', '{2}')", 
                            hiddenFieldElementId, 
                            numeratorElementId, 
                            denominatorElementId);
}

@Html.HiddenFor(m => m, new { id = hiddenFieldElementId })

@Html.TextBox("Numerator", numeratorStr,
                        new { id = numeratorElementId, onchange = onchangingFunctionSyntax })  /
@Html.TextBox("Denominator", denominatorStr,
                        new { id = denominatorElementId, onchange = onchangingFunctionSyntax }) 
```

这个模板真正做的是：

1.  将 double 值（其模型）转换为 Fraction 的实例。
2.  在单独的文本输入中显示分数的分子和分母值。
3.  重新计算双精度值（通过 Javascript）

因为 Javascript 代码需要唯一的 ID 来获取元素`document.getElementById(id)`，所以我们的编辑模板必须为相关元素生成这些唯一的 ID。

你可以在这里下载代码：http: [//sdrv.ms/MlyDI2](http://sdrv.ms/MlyDI2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:41:09.480

解决您的问题的最佳和最简洁的方法是开发一个**显示/编辑模板**。这是一篇关于它的好文章：

[覆盖 DisplayFor 和 EditorFor 为 MVC 创建自定义输出](http://buildstarted.com/2010/09/10/overriding-displayfor-and-editorfor-to-create-custom-outputs-for-mvc/)

# android - 在应用程序安装时复制 SD 卡上的文本文件？

> ID：11121795
> 
> 赞同：3
> 
> 时间：2012-06-20T14:27:35.573
> 
> 标签：android, android-sdcard

我正在开发一款安卓游戏。我想在用户第一次安装游戏时将文本文件复制到外部 SD 卡。文本文件对于正确运行游戏很重要。

我怎样才能做到这一点？我应该将文本文件放在 Eclipse 源项目中的哪个位置，以便在构建 apk 文件时，我的文本文件也被捆绑在其中，当用户从该 apk 文件安装应用程序时，文本文件被复制到“SDcard\data”文件夹.?

我应该编写什么代码以及在哪里编写，以便在安装时只执行一次。

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-20T20:58:57.757

这是我在首次安装应用程序时将文件复制到 sd 卡的方法：

```
public class StartUp extends Activity {

    /**
     * -- Called when the activity is first created.
     * ==============================================================
     **/
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        FirstRun();
    }

    private void FirstRun() {
        SharedPreferences settings = this.getSharedPreferences("YourAppName", 0);
        boolean firstrun = settings.getBoolean("firstrun", true);
        if (firstrun) { // Checks to see if we've ran the application b4
            SharedPreferences.Editor e = settings.edit();
            e.putBoolean("firstrun", false);
            e.commit();
            // If not, run these methods:
            SetDirectory();
            Intent home = new Intent(StartUp.this, MainActivity.class);
            startActivity(home);

        } else { // Otherwise start the application here:

            Intent home = new Intent(StartUp.this, MainActivity.class);
            startActivity(home);
        }
    }

/**
     * -- Check to see if the sdCard is mounted and create a directory w/in it
     * ========================================================================
     **/
    private void SetDirectory() {
        if (android.os.Environment.getExternalStorageState().equals(android.os.Environment.MEDIA_MOUNTED)) {

            extStorageDirectory = Environment.getExternalStorageDirectory().toString();

            File txtDirectory = new File(extStorageDirectory + "/yourAppName/txt/");
            // Create
            // a
            // File
            // object
            // for
            // the
            // parent
            // directory
            txtDirectory.mkdirs();// Have the object build the directory
            // structure, if needed.
            CopyAssets(); // Then run the method to copy the file.

        } else if (android.os.Environment.getExternalStorageState().equals(android.os.Environment.MEDIA_MOUNTED_READ_ONLY)) {

            AlertsAndDialogs.sdCardMissing(this);//Or use your own method ie: Toast
        }

    }

    /**
     * -- Copy the file from the assets folder to the sdCard
     * ===========================================================
     **/
    private void CopyAssets() {
        AssetManager assetManager = getAssets();
        String[] files = null;
        try {
            files = assetManager.list("");
        } catch (IOException e) {
            Log.e("tag", e.getMessage());
        }
        for (int i = 0; i < files.length; i++) {
            InputStream in = null;
            OutputStream out = null;
            try {
                in = assetManager.open(files[i]);
                out = new FileOutputStream(extStorageDirectory + "/yourAppName/txt/" + files[i]);
                copyFile(in, out);
                in.close();
                in = null;
                out.flush();
                out.close();
                out = null;
            } catch (Exception e) {
                Log.e("tag", e.getMessage());
            }
        }
    }

    private void copyFile(InputStream in, OutputStream out) throws IOException {
        byte[] buffer = new byte[1024];
        int read;
        while ((read = in.read(buffer)) != -1) {
            out.write(buffer, 0, read);
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T14:51:25.593

由于 sdcard 上的文件可能会被用户意外删除，因此您可能应该直接检查它的存在（并可能验证内容），而不是尝试使用独立的东西（例如共享首选项）来判断这是否是第一个活动的运行。

出于潜在应用程序升级的目的，您可能应该在文件中输入一个版本号，并检查它。

如果您想让高级用户手动编辑该文件（以更改专家选项），那么您在升级时可能会遇到一些具有挑战性的情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T14:31:24.943

对于这个目标，最好的方法是制作 SharedPreferences 或者您的文件必须添加到 android 项目的“assets”目录中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T14:32:35.257

根据[链接](https://stackoverflow.com/questions/2227604/is-there-on-install-event-in-android)

有 ACTION_PACKAGE_ADDED 广播意图，`but the application being installed doesn't receive this.`

所以看起来使用 SharedPreferences 是最简单的方法......

```
SharedPreferences p = PreferenceManager.getDefaultSharedPreferences(this);
boolean firstRun = p.getBoolean(PREFERENCE_FIRST_RUN, true);
p.edit().putBoolean(PREFERENCE_FIRST_RUN, false).commit(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-20T14:33:03.980

将文件放在资产文件夹中。然后，使用您想出的任何逻辑，在您的应用启动时确定它是否是应用的第一次运行。

如果是，您可以使用 Activity 中的 getAssets() 来访问资产文件并将其复制到任何需要的地方。

# git - 詹金斯没有获取正确的 Gerrit 分支

> ID：11121799
> 
> 赞同：5
> 
> 时间：2012-06-20T14:28:19.157
> 
> 标签：git, jenkins, gerrit

我希望詹金斯测试代码以供审查。jenkins 作业是在推送到 refs/for/master 时开始的，但它尝试构建 origin/master 分支而不是 refs/changes/XX/X/X 分支。有人知道我做错了什么吗？

詹金斯的日志：

```
Triggered by Gerrit: http://localhost/13
Building on master in workspace 
/var/lib/jenkins/jobs/CI-JoysteerLogApi/workspace
Checkout:workspace / /var/lib/jenkins/jobs/CI-JoysteerLogApi/workspace - hudson.remoting.LocalChannel@28071488
Using strategy: Default
Last Built Revision: Revision f604c6257923d4231b74573528d0116e0b52dc64 (origin/master)
Fetching changes from 1 remote Git repository
Fetching upstream changes from ssh://jenkinsCI@192.168.5.20:29418/JoysteerLogApi.git
Commencing build of Revision f604c6257923d4231b74573528d0116e0b52dc64 (origin/master)
Checking out Revision f604c6257923d4231b74573528d0116e0b52dc64 (origin/master) 
```

吉特配置：

```
Repository URL: ssh://user@localhost:29418/Project.git
Refspec: $GERRIT_REFSPEC
Branches to build: $GERRIT_BRANCH 
```

Gerrit 触发器配置：

```
Gerrit Project:
  Type: Plain
  Pattern: Project
  Branches:
    Type: Path
    Pattern: ** 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T14:35:16.303

抱歉，我没有仔细阅读文档...

Git 配置中缺少的内容：

```
Choosing strategy: Gerrit Trigger 
```

[![在此处输入图像描述](../Images/e6b73419507f5ceae5a9005a6e479a4e.png)](https://i.stack.imgur.com/DNZKj.png)

# asp.net - 这个正则表达式不正确

> ID：11121800
> 
> 赞同：0
> 
> 时间：2012-06-20T14:28:21.217
> 
> 标签：asp.net, regex

我正在尝试使用正则表达式生成器来创建表达式，但我似乎无法正确处理。

我需要做的是在字符串中找到以下类型的字符串：

```
community_n 
```

例如，在可能是的字符串中

```
community community_1 community_new_1 community_1_new 
```

从中，我只想提取`community_1`

我试过`/(community_\\d+)/`了，但这显然是不对的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-20T14:30:44.090

尝试添加单词边界，所以

`/(\\bcommunity_\\d+\\b)/`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T14:32:49.483

尝试使用正则表达式 (community_\d+)。虽然我可能不正确，因为我不知道您使用的是哪种语言。（由于某种原因我无法添加评论，我只能回答问题）。

# visual-studio-2010 - VS 2010 - 代码覆盖结果包括测试项目本身

> ID：11121803
> 
> 赞同：1
> 
> 时间：2012-06-20T14:28:37.727
> 
> 标签：visual-studio-2010, code-coverage

我正在为我的一个 DLL 库编写一些单元测试。“代码覆盖率结果”窗格显示了覆盖和测试的程序集的细分。

出于某种奇怪的原因 - 我的**测试项目本身**出现在覆盖结果中！（大约 90% 被覆盖）。

这似乎很愚蠢......这是怎么回事？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T14:52:07.900

百分比如此之高的原因是代码覆盖率项目被检测以跟踪测试运行命中的行，因为您正在从该项目运行测试，所以项目中的几乎所有代码行都将运行。

您可以在测试设置中选择要收集覆盖率统计信息的项目/DLL。

因此，如果您不需要捕获测试项目的统计信息（实际上不应该），您可以简单地从您用于覆盖的设置中删除该项目。

有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/ms182534.aspx](http://msdn.microsoft.com/en-us/library/ms182534.aspx)（特别是步骤 5 - 7）。

# php - 比较 Magento .phtml 文件中的字符串

> ID：11121806
> 
> 赞同：2
> 
> 时间：2012-06-20T14:28:40.957
> 
> 标签：php, html, string, magento

我正在使用 magento，我想显示一个 div，这取决于我是否处于特定视图中。我使用以下内容：

```
<?php
   $url1 = (string)$this->getBaseUrl()."home_tienda";
   $url2 = (string)$this->getUrl('*/*/*',array('_current'=>true, '_use_rewrite'=>true));
?> 
```

如果我键入 $url1 和 $url2 的“var_dump”，我会得到以下信息：

```
string(28) "http://127.0.0.1/home_tienda"
string(37) "http://127.0.0.1/home_tienda" 
```

好吧，我试过这个：

```
<?php if (strcmp($url1,$url2)==0):?>
<div class="clsbanner"><?php echo $this->getLayout()->createBlock('cms/block')->setBlockId('block_banner')->toHtml(); ?></div>
<?php endif?> 
```

我也试过这个：

```
<?php if ($url1==$url2):?>
<div class="clsbanner"><?php echo $this->getLayout()->createBlock('cms/block')->setBlockId('block_banner')->toHtml(); ?></div>
<?php endif?> 
```

在两者中我都获得了错误，所以我的 div 没有显示，我需要显示它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T16:57:38.840

请重试`strcmp()`和/或`stricmp()`与`===`操作员联系。另一个有用的工具是`stripos()`，它从您的 URL 比较中返回 0，但如果未找到字符串则返回 FALSE。

`0 == FALSE`测试一样...

然而

`0 === FALSE`将捕获您正在寻找的条件作为`===`匹配数据类型。

# php - 多线程方法同时php

> ID：11121807
> 
> 赞同：0
> 
> 时间：2012-06-20T14:28:44.227
> 
> 标签：php

我正在开发一个 PHP 脚本，该脚本用不同的参数实例化同一类的三个对象。这些对象依次运行无限长的方法（如 Cron 作业），因此，下一行或第二行永远不会开始。

所以如果我有

```
$a = new CronJob('Listing', '2010-04-01T00:00:01', '2010-04-01T00:30:01', 'A', 'BUSO');
$s = new CronJob('Listing', '2010-04-01T00:00:01', '2010-04-01T00:30:01', 'S', 'BUSO');
$p = new CronJob('Listing', '2010-04-01T00:00:01', '2010-04-01T00:30:01', 'P', 'BUSO'); 
```

`$s`永远不会执行，因为`$a`运行了无限时间

我怎样才能解决这个问题？我想过在不同的脚本中运行它们，但我不想`3 * (#object types)`同时运行它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:44:23.520

老实说，您最好的选择是制作单独的 cron 作业条目。PHP 本身并不支持多线程，并且许多让它工作的黑客都是昂贵的。

看看这个堆栈溢出问题：[How can one use multi threading in PHP applications](https://stackoverflow.com/questions/70855/how-can-one-use-multi-threading-in-php-applications)

**更新：**

也想为[Gearman](http://php.net/manual/en/book.gearman.php)提出这个想法。如果可以添加外部扩展，请下载 PECL 包并安装。您将需要本地系统上的齿轮箱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T14:31:26.853

你考虑过[PHP 线程](http://php.net/manual/en/function.pcntl-fork.php)吗？

[这是关于PHP 线程问题](https://stackoverflow.com/questions/209774/does-php-have-threading)的另一个 SO 讨论。

# yahoo - yahoo 存储 api 身份验证

> ID：11121812
> 
> 赞同：0
> 
> 时间：2012-06-20T14:28:56.683
> 
> 标签：yahoo, yahoo-api

我正在尝试从雅虎商店获取订单数据。我正在使用此处找到的文档：http: [//lib.store.yahoo.net/lib/vw/order-payment-api.pdf](http://lib.store.yahoo.net/lib/vw/order-payment-api.pdf) 我似乎无法通过身份验证。我有商店ID。店主已经为我打开了访问权限，我已经获得了要添加到我的 xml POST 请求中的密码。

任何人有运气这样做吗？如果你有你能帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T17:14:23.677

就像魔术一样，这在上周末开始起作用。为什么？没有人真正知道。我确实向雅虎发送了一封电子邮件抱怨，但没有得到回复。

此外，在运行 POST 时，我发现在您的请求 XML 前面加上空格是一个坏主意。

# php - 如何检查一个IP地址是否在PHP中的两个IP范围内？

> ID：11121817
> 
> 赞同：64
> 
> 时间：2012-06-20T14:29:14.077
> 
> 标签：php, ip, range

我有一个 IP 地址，并获得了另外两个 IP 地址，它们共同创建了一个 IP 范围。我想检查第一个 IP 地址是否在此范围内。我怎样才能在 PHP 中找到它？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-06-20T14:34:59.193

使用[`ip2long()`](http://php.net/manual/en/function.ip2long.php)它很容易将您的地址转换为数字。在此之后，您只需检查数字是否在范围内：

```
if ($ip <= $high_ip && $low_ip <= $ip) {
  echo "in range";
} 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2012-06-20T14:31:16.370

[这个网站提供了一个很好的指南和代码](https://pgregg.com/blog/2009/04/php-algorithms-determining-if-an-ip-is-within-a-specific-range/)来做到这一点（这是谷歌搜索这个问题的第一个结果）：

```
<?php

/*
 * ip_in_range.php - Function to determine if an IP is located in a
 *                   specific range as specified via several alternative
 *                   formats.
 *
 * Network ranges can be specified as:
 * 1\. Wildcard format:     1.2.3.*
 * 2\. CIDR format:         1.2.3/24  OR  1.2.3.4/255.255.255.0
 * 3\. Start-End IP format: 1.2.3.0-1.2.3.255
 *
 * Return value BOOLEAN : ip_in_range($ip, $range);
 *
 * Copyright 2008: Paul Gregg <pgregg@pgregg.com>
 * 10 January 2008
 * Version: 1.2
 *
 * Source website: http://www.pgregg.com/projects/php/ip_in_range/
 * Version 1.2
 *
 * This software is Donationware - if you feel you have benefited from
 * the use of this tool then please consider a donation. The value of
 * which is entirely left up to your discretion.
 * http://www.pgregg.com/donate/
 *
 * Please do not remove this header, or source attibution from this file.
 */

// decbin32
// In order to simplify working with IP addresses (in binary) and their
// netmasks, it is easier to ensure that the binary strings are padded
// with zeros out to 32 characters - IP addresses are 32 bit numbers
Function decbin32 ($dec) {
  return str_pad(decbin($dec), 32, '0', STR_PAD_LEFT);
}

// ip_in_range
// This function takes 2 arguments, an IP address and a "range" in several
// different formats.
// Network ranges can be specified as:
// 1\. Wildcard format:     1.2.3.*
// 2\. CIDR format:         1.2.3/24  OR  1.2.3.4/255.255.255.0
// 3\. Start-End IP format: 1.2.3.0-1.2.3.255
// The function will return true if the supplied IP is within the range.
// Note little validation is done on the range inputs - it expects you to
// use one of the above 3 formats.
Function ip_in_range($ip, $range) {
  if (strpos($range, '/') !== false) {
    // $range is in IP/NETMASK format
    list($range, $netmask) = explode('/', $range, 2);
    if (strpos($netmask, '.') !== false) {
      // $netmask is a 255.255.0.0 format
      $netmask = str_replace('*', '0', $netmask);
      $netmask_dec = ip2long($netmask);
      return ( (ip2long($ip) & $netmask_dec) == (ip2long($range) & $netmask_dec) );
    } else {
      // $netmask is a CIDR size block
      // fix the range argument
      $x = explode('.', $range);
      while(count($x)<4) $x[] = '0';
      list($a,$b,$c,$d) = $x;
      $range = sprintf("%u.%u.%u.%u", empty($a)?'0':$a, empty($b)?'0':$b,empty($c)?'0':$c,empty($d)?'0':$d);
      $range_dec = ip2long($range);
      $ip_dec = ip2long($ip);

      # Strategy 1 - Create the netmask with 'netmask' 1s and then fill it to 32 with 0s
      #$netmask_dec = bindec(str_pad('', $netmask, '1') . str_pad('', 32-$netmask, '0'));

      # Strategy 2 - Use math to create it
      $wildcard_dec = pow(2, (32-$netmask)) - 1;
      $netmask_dec = ~ $wildcard_dec;

      return (($ip_dec & $netmask_dec) == ($range_dec & $netmask_dec));
    }
  } else {
    // range might be 255.255.*.* or 1.2.3.0-1.2.3.255
    if (strpos($range, '*') !==false) { // a.b.*.* format
      // Just convert to A-B format by setting * to 0 for A and 255 for B
      $lower = str_replace('*', '0', $range);
      $upper = str_replace('*', '255', $range);
      $range = "$lower-$upper";
    }

    if (strpos($range, '-')!==false) { // A-B format
      list($lower, $upper) = explode('-', $range, 2);
      $lower_dec = (float)sprintf("%u",ip2long($lower));
      $upper_dec = (float)sprintf("%u",ip2long($upper));
      $ip_dec = (float)sprintf("%u",ip2long($ip));
      return ( ($ip_dec>=$lower_dec) && ($ip_dec<=$upper_dec) );
    }

    echo 'Range argument is not in 1.2.3.4/24 or 1.2.3.4/255.255.255.0 format';
    return false;
  }

}
?> 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2014-09-27T06:27:19.517

我发现这个小[要点](https://gist.github.com/tott/7684443) 的解决方案比这里已经提到的更简单/更短。

第二个参数（范围）可以是静态 IP，例如 127.0.0.1，也可以是范围，例如 127.0.0.0/24。

```
/**
 * Check if a given ip is in a network
 * @param  string $ip    IP to check in IPV4 format eg. 127.0.0.1
 * @param  string $range IP/CIDR netmask eg. 127.0.0.0/24, also 127.0.0.1 is accepted and /32 assumed
 * @return boolean true if the ip is in this range / false if not.
 */
function ip_in_range( $ip, $range ) {
    if ( strpos( $range, '/' ) === false ) {
        $range .= '/32';
    }
    // $range is in IP/CIDR format eg 127.0.0.1/24
    list( $range, $netmask ) = explode( '/', $range, 2 );
    $range_decimal = ip2long( $range );
    $ip_decimal = ip2long( $ip );
    $wildcard_decimal = pow( 2, ( 32 - $netmask ) ) - 1;
    $netmask_decimal = ~ $wildcard_decimal;
    return ( ( $ip_decimal & $netmask_decimal ) == ( $range_decimal & $netmask_decimal ) );
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-10-23T12:38:02.200

```
if(version_compare($low_ip, $ip) + version_compare($ip, $high_ip) === -2) {
    echo "in range";
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-12-28T20:30:40.530

### 范围比较（包括 IPv6 支持）

以下两个函数是在 PHP 5.1.0 中引入的，`inet_pton`而`inet_pton`. 它们的目的是将人类可读的 IP 地址转换为它们的打包`in_addr`表示。由于结果不是纯二进制，我们需要使用该`unpack`函数来应用位运算符。

这两个函数都支持 IPv6 和 IPv4。唯一的区别是您如何从结果中解压缩地址。使用 IPv6，您将使用 A16 解包内容，使用 IPv4，您将使用 A4 解包。

为了将前面的内容放在一个角度来看，这里有一个小示例输出以帮助澄清：

```
// Our Example IP's
$ip4= "10.22.99.129";
$ip6= "fe80:1:2:3:a:bad:1dea:dad";

// ip2long examples
var_dump( ip2long($ip4) ); // int(169239425)
var_dump( ip2long($ip6) ); // bool(false)

// inet_pton examples
var_dump( inet_pton( $ip4 ) ); // string(4)
var_dump( inet_pton( $ip6 ) ); // string(16) 
```

我们在上面演示了 inet_* 系列支持 IPv6 和 v4。我们的下一步是将打包的结果转换为未打包的变量。

```
// Unpacking and Packing
$_u4 = current( unpack( "A4", inet_pton( $ip4 ) ) );
var_dump( inet_ntop( pack( "A4", $_u4 ) ) ); // string(12) "10.22.99.129"

$_u6 = current( unpack( "A16", inet_pton( $ip6 ) ) );
var_dump( inet_ntop( pack( "A16", $_u6 ) ) ); //string(25) "fe80:1:2:3:a:bad:1dea:dad" 
```

注意：当前函数返回数组的第一个索引。相当于说 $array[0]。

解包打包后，我们可以看到我们得到了和输入一样的结果。这是一个简单的概念证明，以确保我们不会丢失任何数据。

最后使用，

```
if ($ip <= $high_ip && $low_ip <= $ip) {
  echo "in range";
} 
```

参考：[php.net](http://php.net/manual/en/function.inet-ntop.php)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-06-20T14:40:39.747

我总是建议[ip2long](http://php.net/manual/en/function.ip2long.php)，但有时您需要检查网络等。我过去已经构建了一个 IPv4 Networking 类，可以在[HighOnPHP](http://www.highonphp.com/php-ipv4-network-class)上找到。

使用 IP 寻址的好处是它的灵活性，尤其是在使用 BITWISE 运算符时。AND'ing、OR'ing 和 BitShifting 将像魅力一样发挥作用。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-05-14T14:48:22.430

使用支持 IPv4 和 IPv6 的优秀[rlanvin/php-ip](https://github.com/rlanvin/php-ip)（通过[GMP 扩展](https://www.php.net/manual/en/book.gmp.php)）：

```
use PhpIP\IPBlock;

$block = IPBlock::create('10.0.0.0/24');
$block->contains('10.0.0.42'); // true 
```

有关更多示例，请参阅[他们的文档](https://github.com/rlanvin/php-ip/wiki#blocks-as-containers)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-10-02T06:56:05.750

这是旧帖子，但我在[GitHub 上有一个很好的解决方案。](https://github.com/CreativForm/PHP-Solutions/blob/master/function.ip.in.range.php)

```
$ip_in_range = is_ip_in_range('54.208.101.55', array(
    '50.16.241.113'     =>  '50.16.241.117',
    '54.208.100.253'    =>  '54.208.102.37'
)); 
```

此函数将返回匹配的 IP 或不匹配的布尔值 false。

这是功能：

```
// https://github.com/CreativForm/PHP-Solutions/blob/master/function.ip.in.range.php
function is_ip_in_range( $ip, $range ){

    if(!is_array($range)) return false;

    // Let's search first single one
    ksort($range);

    // We need numerical representation of the IP
    $ip2long = ip2long($ip);

    // Non IP values needs to be removed
    if($ip2long !== false)
    {
        // Let's loop
        foreach($range as $start => $end)
        {
            // Convert to numerical representations as well
            $end = ip2long($end);
            $start = ip2long($start);
            $is_key = ($start === false);

            // Remove bad one
            if($end === false) continue;

            // Here we looking for single IP does match
            if(is_numeric($start) && $is_key && $end === $ip2long)
            {
                return $ip;
            }
            else
            {
                // And here we have check is in the range
                if(!$is_key && $ip2long >= $start && $ip2long <= $end)
                {
                    return $ip;
                }
            }
        }
    }

    // Ok, it's not finded
    return false;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-10-17T14:18:08.373

顺便说一句，如果您需要一次检查多个范围，您可以在代码中添加几行以传递范围数组。第二个参数可以是数组或字符串：

```
public static function ip_in_range($ip, $range) {
      if (is_array($range)) {
          foreach ($range as $r) {
              return self::ip_in_range($ip, $r);
          }
      } else {
          if ($ip === $range) { // in case you have passed a static IP, not a range
             return TRUE;
          }
      } 
      // The rest of the code follows here..
      // .........
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-09-02T12:28:20.453

这是我对该主题的处理方法。

```
function validateIP($whitelist, $ip) {

    // e.g ::1
    if($whitelist == $ip) {
        return true;
    }

    // split each part of the IP address and set it to an array
    $validated1 = explode(".", $whitelist);
    $validated2 = explode(".", $ip);

    // check array index to avoid undefined index errors
    if(count($validated1) >= 3 && count($validated2) == 4) {

        // check that each value of the array is identical with our whitelisted IP,
        // except from the last part which doesn't matter
        if($validated1[0] == $validated2[0] && $validated1[1] == $validated2[1] && $validated1[2] == $validated2[2]) {
            return true;
        }   

    }

    return false;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-02-09T02:55:56.000

我为我的客户使用了这个：

```
$clientIpArray = explode(".", $clientIp);
$fromArray = explode(".", $from);
$toArray = explode(".", $to);

if( ((str_pad($clientIpArray[0], 3, "0", STR_PAD_LEFT) >= str_pad($fromArray[0], 3, "0", STR_PAD_LEFT)) && (str_pad($clientIpArray[0], 3, "0", STR_PAD_LEFT) <= str_pad($toArray[0], 3, "0", STR_PAD_LEFT)))
 &&((str_pad($clientIpArray[1], 3, "0", STR_PAD_LEFT) >= str_pad($fromArray[1], 3, "0", STR_PAD_LEFT)) && (str_pad($clientIpArray[1], 3, "0", STR_PAD_LEFT) <= str_pad($toArray[1], 3, "0", STR_PAD_LEFT)))
 &&((str_pad($clientIpArray[2], 3, "0", STR_PAD_LEFT) >= str_pad($fromArray[2], 3, "0", STR_PAD_LEFT)) && (str_pad($clientIpArray[2], 3, "0", STR_PAD_LEFT) <= str_pad($toArray[2], 3, "0", STR_PAD_LEFT)))
 &&((str_pad($clientIpArray[3], 3, "0", STR_PAD_LEFT) >= str_pad($fromArray[3], 3, "0", STR_PAD_LEFT)) && (str_pad($clientIpArray[3], 3, "0", STR_PAD_LEFT) <= str_pad($toArray[3], 3, "0", STR_PAD_LEFT)))){
  echo "IP within range";
} 
```

例如，让我们看这个例子：

```
$clientIp = "120.02.3.112";
$from = "1.02.1.112";
$to = "120.02.20.112"; 
```

如您所见，此 IP 在范围内。如果您尝试将其按原样进行比较，那将是行不通的。我的解决方案是将 IP 划分为元素，例如生成的数组将是：

```
$clientIpArray = ["120","02","3","112"];
$fromArray = ["1","02","1","112"];
$toArray = ["120","02","20","112"]; 
```

我们有 4 个元素要比较，这里我使用**str_pad**函数从每个元素生成一个 3 个字符的字符串，所以不是检查“3”是否在“1”和“20”之间（这不是真的），我们将检查“ 003”介于“001”和“020”之间（这是正确的）。

# jsf - 生成要在 Facelets 中显示的链接列表

> ID：11121818
> 
> 赞同：2
> 
> 时间：2012-06-20T14:29:17.923
> 
> 标签：jsf, hyperlink, facelets

我需要有一个由 JSF 生成并显示在 Facelets 中的链接列表。该 bean 将包含所有链接以及它们需要指向的位置，然后我假设将运行一些方法来分散所有这些链接，这些链接可以由 Facelets 页面中的某个 JSF 属性调用。

我有点不知所措。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:36:16.537

您可以使用`ui:repeat`标签：

```
<ui:repeat value="#{bean.links}" var="link" varStatus="status">
    <h:outputLink value="#{link.url}">
        <h:outputLabel value="#{link.name}"/>
    </h:outputLink>
    <h:outputText value=", " rendered="#{not status.last}"/>
</ui:repeat> 
```

`bean`是有`getLinks`方法的托管bean。`getLinks`方法返回链接列表。每个链接都是一个具有`name`和`url`属性的对象。所有链接都用逗号分隔。

# mysql - Python 中的 MySQLdb：“无法连接到 'localhost' 上的 MySQL 服务器”

> ID：11121819
> 
> 赞同：27
> 
> 时间：2012-06-20T14:29:18.627
> 
> 标签：mysql, python-2.7

我已经为 Python 安装了 MySQLdb，并且可以导入 MySQLdb。现在我尝试使用以下代码连接到本地计算机上的 MySQL 社区服务器：

```
db=MySQLdb.connect(
    host="localhost",
    user="br_admin",
    passwd="blabla",
    db="br_brain"
) 
```

此代码失败并出现此错误：

```
Traceback (most recent call last):
  File "<pyshell#22>", line 5, in <module>
  db="brainse_brain"
File "C:\Python27\lib\site-packages\MySQLdb\__init__.py", line 81, in Connect
return Connection(*args, **kwargs)
File "C:\Python27\lib\site-packages\MySQLdb\connections.py", line 187, in __init__
super(Connection, self).__init__(*args, **kwargs2)
OperationalError: (2003, "Can't connect to MySQL server on 'localhost' (10061)") 
```

如何解决此错误？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-08-03T06:32:12.017

确保提供正确的主机和端口：

```
'default': {
    'ENGINE': 'django.db.backends.mysql', 
    'NAME': 'yourdbname',                      
    'USER': 'root',                      
    'PASSWORD': 'your password',         
    'HOST': '127.0.0.1',                 
    'PORT': '3306',                      
}, 
```

这是我的 django 应用程序的 settings.py 文件配置。

你也一样，请使用主机“127.0.0.1”和端口“3306”。

这可能会解决您的问题。而对于python idle，我已经测试过......

```
>>> import MySQLdb
>>> Con = MySQLdb.Connect(host="127.0.0.1", port=3306, user="yoruname", passwd="yourpwd", db="test")
>>> Cursor = Con.cursor()
>>> sql = "SELECT * FROM test.testing"
>>> Cursor.execute(sql)
2L 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-26T20:48:34.987

我也遇到了同样的麻烦，我正在使用 64 位的 Windows，解决方案只是更改主机变量值。当正确的值必须是“127.0.0.1”时，我设置了“localhost”。但是，当我在 32 位的 Windows 上工作时。我可以在主机变量值中设置“localhost”或“127.0.0.1”，无论如何，我的 django 项目运行良好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-09-30T06:32:08.857

这将正常工作：

```
 db = MySQLdb.connect(host="127.0.0.1",user="db_username",passwd="db_password",db="db_name") 
```

或者

```
 db=  MySQLdb.connect("127.0.0.1","db_username","db_password","db_name") 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-17T10:14:46.657

如果您使用的是 Windows，您应该将 IP 指定为“127.0.0.1”，使用“localhost”会给您错误 2003。在 Ubuntu 上我没有问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-08-21T11:30:07.333

在 Windows 32 中，如果您将主机设置为`127.0.01`它会给出关闭错误：

```
OperationalError: (2005, "Unknown MySQL server host '127.0.01' (0)") 
```

但是，如果您将主机设置为，`127.0.0.1`则不会出现错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-21T10:27:37.380

```
 - DATABASES = {
       'default': {
           'ENGINE': 'django.db.backends.mysql',
           'NAME': 'dataflair',
           'USER':'root',
           'PASSWORD':'',
           'HOST':'127.0.0.1',
           'PORT':'3306',
           'OPTIONS':{
       'init_command':"SET sql_mode=STRICT_TRANS_TABLES" } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-04-06T15:00:47.927

1.转到MySQL工作台
2.在上面的任务栏上，点击服务器->然后点击启动/关闭
3.在屏幕上，点击启动服务器，您将获得服务器启动和运行的日志

# json - jsFiddle如何获取json？

> ID：11121821
> 
> 赞同：3
> 
> 时间：2012-06-20T14:29:21.393
> 
> 标签：json, echo, openlayers, jsfiddle

嗨，

我正在开发一个带有 openlayers 示例的 jsFiddle。 [http://dev.openlayers.org/releases/OpenLayers-2.11/examples/snapping.html](http://dev.openlayers.org/releases/OpenLayers-2.11/examples/snapping.html)

目前它不起作用，因为它没有得到对获取数据的 http 请求的响应。我该如何解决？

jsFiddle 在这里：http: [//jsfiddle.net/TcuxA/6/](http://jsfiddle.net/TcuxA/6/) 转到脚本中的“// 创建三个矢量图层”行。有 3 个数据请求。如果您在浏览器中键入 URL，您会得到 JSON，但是当我运行 jsFiddle 时，我的萤火虫会给出 3 个错误。

我尝试使用 jsFiddle echo ( [http://doc.jsfiddle.net/use/echo.html](http://doc.jsfiddle.net/use/echo.html) ) 进行修复，但这没有用。我不知道如何更改脚本以加载数据。

为什么我不能通过这些 URL 获取 json？什么是好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T13:43:26.793

一个好的解决方案可以是：[使用 github 响应](http://doc.jsfiddle.net/use/github_response.html)。您可以将示例与预定义的 XHR 请求响应一起存储在 github 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T16:03:30.760

您遇到的是 XMLHttpRequest 对象引发的异常，因为您正在使用`AJAX`调用来自不同域的元素。[最好这样说，例如，在这里：](http://www.simple-talk.com/dotnet/asp.net/calling-cross-domain-web-services-in-ajax/)

*“XMLHttpRequest 对象被阻止从其自己的域之外调用 Web 服务。这是明智的，因为如果您在一个地方调用脚本，然后它又调用另一台服务器上的脚本，它可能会使应用程序对所有人开放各种恶意脚本、黑客和漏洞利用。”*

因此，最简单的方法是在本地对其进行编码并调用将驻留在本地服务器上的文件（poly.json、line.json 和 point.json）的本地副本。为了测试地图上是否所有显示，您可以将文件硬编码到您的代码中。我不确定如何以其他方式实现它。

# ios - Xcode iOS 按下按钮然后向上拖动第二个按钮

> ID：11121827
> 
> 赞同：1
> 
> 时间：2012-06-20T14:29:30.910
> 
> 标签：ios, ipad, uibutton, touch, drag

假设我不想给整数加 1。只有当我按下 a`UIButton`然后松开手指时才会这样做`UIButton`。**拖拽组合。**什么是我可以`IBAction`从组合中发生的最简单方法？这可以通过触摸坐标来完成，也可以只用`UIButtons`and来完成`IBActions`。

## 如何创建一个 2 按钮组合`IBActions`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T14:37:11.653

尝试将您希望触摸的按钮实现为“Touch Down”、“Touch Up Inside”和“Touch Up Outside”按钮。

UIButtons 可以响应许多不同类型的事件 Touch Cancel Touch Down Touch Down Repeat Touch Drag Enter Touch Drag Exit Touch Drag Inside Touch Drag Outside Touch Up Inside Touch Up Outside

您可以为每个按钮实现不同的操作代码，以便最好地控制您想要的任何内容。简单的案例只使用我上面提到的 2。

此代码已经过测试并且有效

在您的 ViewController 头文件中（这是我的）：

```
@interface ViewController : UIViewController{
    IBOutlet UIButton * upButton;    // count up when finger released button
    IBOutlet UIButton * downButton;
    IBOutlet UILable * score;
    BOOL isButtonDown;
    unsigned int youCounter;
}

-(IBAction)downButtonDown:(id)sender;
-(IBAction)downButtonUpInside:(id)sender;
-(IBAction)downButtonDragOutside:(id)sender event:(UIEvent *)event;
-(IBAction)downButtonUpOutside:(id)sender event:(UIEvent *)event;

@end 
```

在您的 .xib 中，将向下按钮（您希望成为原始手指按下的按钮）连接到上面的正确操作。

在您的 ViewController.m 文件中

```
-(void)viewDidLoad{
    [super viewDidLoad];

    isButtonDown = NO;
    youCounter   = 0;
}

-(IBAction)downButtonDown:(id)sender{
    isButtonDown = YES;
}

-(IBAction)downButtonUpInside:(id)sender{
    isButtonDown = NO;
}

-(IBAction)downButtonDragOutside:(id)sender event:(UIEvent *)event{
    NSArray theTouches = [[event allTouches] allObjects];

    [downButton setHighlighted:YES];

    if(YES == [upButton pointInside:[[theTouches objectAtIndex:0] locationInView:upButton] withEvent:event]){
        [upButton setHighlighted:YES];
    }else{
        [upButton setHighlighted:NO];
    }
}

-(IBAction)downButtonUpOutside:(id)sender event:(UIEvent *)event{
    if(YES == [upButton pointInside:[[theTouches objectAtIndex:0] locationInView:upButton] withEvent:event]){
        youCounter++;
        score.text = [NSString stringWithFormat:@"Score = %d", youCounter];
    }

    [downButton setHighlighted:NO];
    [upButton setHighlighted:NO];
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-20T14:38:57.707

```
 //Initalize a BOOL variable to know if you started the touch in the right place.
 BOOL correctStart = NO;

 //Get the location of the first touch, if its in the first button make correctStart = YES.
 -(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
      NSSet *allTouches = [event allTouches];
           for (UITouch *touch in allTouches) {
                if ([touch locationInView:button1.view]) {
                     correctStart = YES;
                }
           }
 }

 -(void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
      NSSet *allTouches = [event allTouches];
           for (UITouch *touch in allTouches) {
                if (([touch locationInView:button2.view]) && (correctStart == YES)) {
                     anInteger++;
                }
           }
      correctStart = NO;
 } 
```

我没有尝试这段代码，因为我不在我的 mac，所以你的结果可能会有所不同，但这应该会让你朝着正确的方向前进。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T20:31:30.200

另一种方法是使用`UITapGestureRecognizer`and`UIPanGestureRecognizer`并跟踪按钮中的位置。我发现这更具可读性。（实际上我最终使用了 UILabels，因为我不需要任何进一步`UIButton`的行为。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-08-08T07:36:11.037

// 创建一个按钮，添加目标

```
UIButton *cloudButton = [UIButton buttonWithType:UIButtonTypeCustom];
        [cloudButton setImage:[UIImage imageNamed:@"notification_add.png"] forState:UIControlStateNormal];
        [cloudButton setFrame:CGRectMake(0, 0, 30, 30)];
        [cloudButton addTarget:self action:@selector(dragBegan:withEvent: )
           forControlEvents: UIControlEventTouchDown];
        [cloudButton addTarget:self action:@selector(dragMoving:withEvent: )
           forControlEvents: UIControlEventTouchDragInside | UIControlEventTouchDragOutside];
        [cloudButton addTarget:self action:@selector(dragEnded:withEvent: )
           forControlEvents: UIControlEventTouchUpInside |
         UIControlEventTouchUpOutside];

        [self.view addSubview:cloudButton]; 
```

//事件方法

```
- (void) dragBegan: (UIControl *) c withEvent:ev
{
    NSLog(@"dragBegan......");
}

- (void) dragMoving: (UIControl *) c withEvent:ev
{
    NSLog(@"dragMoving..............");
}
- (void) dragEnded: (UIControl *) c withEvent:ev
{
    NSLog(@"dragEnded..............");
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-10-24T23:55:40.643

`ViewDidLoad`对方法中的第一个 UIButton 执行以下操作

```
 [button1 addTarget:self action:@selector(dragMoving:withEvent: )
              forControlEvents: UIControlEventTouchDragInside | UIControlEventTouchDragOutside];

    [button1 addTarget:self action:@selector(dragEnded:withEvent: )
              forControlEvents: UIControlEventTouchUpInside |
     UIControlEventTouchUpOutside]; 
```

在`dragMoving`方法中

```
- (void)dragMoving:(UIControl *)c withEvent:event{

    NSSet* touches = [event allTouches];
    UITouch *touch = [touches anyObject];
    CGPoint currentPoint = [touch locationInView:[button2 superview]];

        if ( CGRectContainsPoint(button2.frame, currentPoint) ) {
            NSLog(@"over second button); 
        } 
    } 
```

至于`dragEnded`方法：

```
- (void) dragEnded:(UIControl *)c withEvent:event{

    NSSet* touches = [event allTouches];
    UITouch *touch = [touches anyObject];
    CGPoint currentPoint = [touch locationInView:[self.button1 superview]];
        if ( CGRectContainsPoint(button2.frame, currentPoint) ) {
            NSLog(@"ended on button 2");
            //add 1 to the integer

        }
    else {
        NSLog(@"not on button 2");
    }
} 
```

# wpf - 如何设置转换器的样式而不是路径？

> ID：11121828
> 
> 赞同：3
> 
> 时间：2012-06-20T14:29:30.597
> 
> 标签：wpf, binding, styles, converter, attached-properties

我正在尝试为我希望能够在我的代码中使用的文本框创建一种样式。我的样式在 Text 属性的绑定中定义了一个转换器，但没有设置它的路径，因为无论我在哪里使用此样式，我的绑定数据的名称都可能不同。

```
<Style x:Key="CustomTextBox" BasedOn="{StaticResource {x:Type TextBox}}"
    TargetType="{x:Type TextBox}">
    <Setter Property="Text">
        <Setter.Value>
            <Binding>
                <Binding.Converter>
                    <CustomTextBoxConverter/>
                </Binding.Converter>
            </Binding> 
        </Setter.Value>
    </Setter>
</Style> 
```

然后 customTextBox 将像这样使用：

```
<TextBox Height="28" Name="txtRate" Style="{StaticResource CustomTextBox}"
         MaxLength="5" Text="{Binding Path=BoundData}"/> 
```

当我编写上面的代码时，我得到一个“双向绑定需要 Path 或 XPath。”的执行。

我什至尝试创建一个在样式绑定中使用的附加属性，以在样式中反映这个值，但我也无法工作。见下：

```
<Converters:SomeConvertingFunction x:Key="CustomTextConverter"/>
<local:CustomAttachedProperties.ReflectedPath x:Key="ReflectedPath"/>

<Style x:Key="CustomTextBox" BasedOn="{StaticResource {x:Type TextBox}}"
    TargetType="{x:Type TextBox}">
    <Setter Property="Text">
        <Setter.Value>
            <Binding Path=ReflectedPath Converter=CustomTextConverter/>
        </Setter.Value>
    </Setter>
</Style> 
```

在这样的页面中使用：

```
<TextBox Height="28" Name="txtRate" Style="{StaticResource CustomTextBox}"
         MaxLength="5" CustomAttachedProperty="contextBoundDataAsString"/> 
```

附加属性的代码是：

```
Public Class CustomAttachedProperties

    Public Shared ReadOnly ReflectedPathProperty As DependencyProperty = 
        DependencyProperty.RegisterAttached("ReflectedPath", GetType(String),
        GetType(CustomAttachedProperties))

    Public Shared Sub SetReflectedPath(element As UIElement, value As String)
        element.SetValue(ReflectedPathProperty, value)
    End Sub

    Public Shared Function GetReflectedPath(element As UIElement) As String
        Return TryCast(element.GetValue(ReflectedPathProperty), String)
    End Function
End Class 
```

当我尝试使用上面的代码时，它编译得很好，但它似乎没有在我的 XAML 上做任何事情，就像它可能正在创建 CustomAttachedProperty 的不同实例一样。

抱歉这个冗长的问题，但我认为创建自定义控件应该很容易，这些控件具有自己的 WPF 默认转换器......我很困惑！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T15:22:00.057

在我看来，最好的方法是创建一个继承自 的新类`TextBox`，然后覆盖`PropertyMetadata`for`Text`属性，让自己有机会在`Coerce`回调中更改值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-21T16:00:06.287

您可以创建一个`UserControl`非常简单的方法：

```
<UserControl x:Class="namespace.MyCustomConverterTextBox">
    <TextBlock Text="{Binding Text, Converter={StaticResource yourconverter}}"/>
</UserControl> 
```

然后在代码隐藏中声明`Text`为：`DependencyProperty`

```
public partial class MyCustomConverterTextBox : UserControl
{
    public string Text {
        get{return (string) GetValue(TextProperty);} 
        set{SetValue(TextProperty, value);}
    }

    public static readonly DependencyProperty TextProperty = 
        DependencyProperty.Register("Text", typeof(string), typeof(MyCustomConverterBox));
 } 
```

这应该足以让您在 xaml 中使用它：

```
<local:MyCustomConverterTextBox Text="{Binding YourBinding}" /> 
```

我没有运行此代码，因此可能存在拼写错误，但这应该足以让您了解如何处理此问题。

# c# - Telerik 图表未正确加载（ajax/脚本问题？）

> ID：11121832
> 
> 赞同：1
> 
> 时间：2012-06-20T14:29:38.113
> 
> 标签：c#, jquery, ajax, asp.net-mvc-3, telerik

我有一个页面，其中包含带有**Telerik 图表**的用户控件（也有网格，但它们工作正常）。从这个页面，用户可以点击一个按钮被重定向到一个“Printer-Friendly Version”类型的页面，该页面通过javascript打开一个**新窗口**并通过一个稍微不同的视图（用于格式化和东西），但是telerik代码都是一样的。

**问题是**，我的图表在原始窗口中显示得很好，但**新窗口基本上显示一个没有数据的空图表**。此错误**仅存在于 IE 中，并且仅适用于 Charts**。无论出于何种原因，网格都可以正常工作。我认为这是由于浏览器之间的脚本缓存存在差异——如果我错了，请纠正我，我对客户端导向的 Web 开发是半新手。

无论如何，我在某处读到 Telerik 在通过 ajax 加载时存在加载数据和/或 js 文件的问题，所以也许这就是问题所在？如果是这样，我怎么能解决这个问题？如果没有，关于什么可能导致这个问题的任何想法？这让我非常沮丧，因为打印预览页面似乎应该是最简单的工作。

**编辑：**

图表被呈现为 html（如果有人可以解释如何将它们呈现为图像，那就太棒了）。开发工具在 chrome 和 IE 之间显示基本相同的东西。每当我的网络服务出现故障时，WinMerge 它们并寻找它们之间的任何特性/差异。与此同时，“渲染为图像”的概念听起来很有希望。这样我就可以从第一页保存图像，然后将其直接插入打印预览页面，对吗？而且由于它是一个打印预览页面，它不需要交互或任何东西，所以效果很好。

**另一个（重要的）编辑：**

## ***这些应该是罪魁祸首……***

![这里有一些 jQuery 错误..但是为什么呢？](../Images/1874fc38f08db8084c147ae1b782a409.png)

这里有更多细节：

![不确定 <code>b</code> 指的是什么，但看起来是问题所在](../Images/51abd7c86a3f8b478c9e394f92c74870.png)

这是它工作（在 chrome 中）和不工作（在 IE 中）的并行：

![看起来在 IE 中它只是没有提取任何数据](../Images/e1baa6997e4c2842d2ac28cccf56dfec.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:34:19.640

您是否考虑过使用特定于打印的样式表，例如

```
<link rel="stylesheet" type="text/css" media="print" href="print.css" /> 
```

在其中指定打印时要应用的样式。

这样，您就可以避免重新加载页面（重复的数据库命中等），并且不需要深入研究 Telerik 控件的 AJAX。

**编辑：**

关于使用图像而不是 HTML，首先确保您不会丢失任何功能/细节，然后检查`.Save()`RadChart 控件的方法。您可以将其保存到内存流中，或者如果您想重新使用图像，请将其保存到网络服务器上的目录并定期清理它。这样，您只需将打印版本指向图像，而不是重新生成它。

[这个 Telerik 论坛帖子](http://www.telerik.com/community/forums/aspnet/chart/rad-chart-export-to-xls-or-pdf-or-word-doc.aspx)可能有用。

# javascript - Google 电子表格脚本 getValues - 强制使用 int 而不是 string

> ID：11121837
> 
> 赞同：11
> 
> 时间：2012-06-20T14:29:48.267
> 
> 标签：javascript, google-apps-script, google-sheets

有没有办法强制 .getRange().getValues() 返回一个 int？尽管我的范围内只存在数字，但它会将它们作为字符串返回。我想避免在我的每一个语句中使用 parseInt 或创建一个带有转换值的单独数组。

或者这是唯一的解决方案，获取数组，然后在循环中解析整个数组？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-03T18:59:29.890

您可以使用一元“+”运算符轻松完成此操作，如下所示：

首先使用`getValue()`或从电子表格中获取值`getValues()`。假设您得到两个这样的值，并将它们存储在`A = 1`和中`B = 2`。`+`您可以通过使用除连接字符串的任何数学二元运算符来强制将它们识别为数字，因此`A - B = -1`, while`A + B`将返回“12”。

您可以通过将`+`一元运算符与任何可能被解释为字符串的变量一起使用来强制变量为数字。例如，`+A + +B`将返回正确的值 3。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-20T22:01:54.247

您可以使用`parseInt()` 或`Number()`

例子

```
var A='12';var B=5
A+B = 125
parseInt(A)+B = 17
Number(A)+B = 17 
```

也就是说，除非值中有一些空格或其他非数字字符，否则 getValues() 不应该返回字符串……这些值是手动输入的还是由某些函数产生的？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-21T04:41:48.477

getValues() 返回一个 2D 对象数组 - 所以这些是字符串、整数或日期对象，具体取决于这些在电子表格中的格式。

返回您的电子表格，查看具有整数值的单元格的格式。将它们格式化为整数，你应该得到整数。

# objective-c - weak 和 unsafe_unretained 的区别

> ID：11121839
> 
> 赞同：9
> 
> 时间：2012-06-20T14:29:57.130
> 
> 标签：objective-c, ios5, memory-management, ios4

所以我有一个支持 iOS 4 的项目，所以我所有的 IBOutlets`__unsafe_unretained`甚至是在 nib 中但在控制器主视图之外的 IBOutlets（同一个 nib 中的单独视图）并且都运行良好。

所以时间到了，现在客户只想支持 iOS 5，所以我们的团队更改了所有`__unsafe_unretained` IBOutlets，`__weak IBOutlets`但现在不在主视图内的 IBOutlets 设置为`nil`（除了 in `viewdidload`），因此我们以后无法添加它们。

如果我考虑一下，这是有道理的，因为如果没有视图（主视图）保留那些 IBOutlets，它们应该被释放并归零（我不知道这是否是正确的词），所以解决方案是`__weak`从那些IB奥特莱斯

但是对我来说没有意义的是为什么 和 之间的不同行为`unsafe_unretained`，`weak`在我的脑海中`unsafe_unretained`，应该释放它们，当应用程序尝试访问它们时，它们应该指向一个无效的引用，然后应用程序应该崩溃。

我认为 unsafe__unretained 与弱相同，但没有归零。

我在这里错过了什么吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T15:49:24.777

> 我认为 unsafe__unretained 与弱相同，但没有归零。

是的，是的。

当 Cocoa 加载 nib 时，它会创建所有自动释放的对象，因此它们在`viewDidLoad`被调用时仍然存在。但是，自动释放池的生命周期在控制权返回到运行循环时结束。此时，所有不属于任何东西的对象都将消失，因此任何弱出口都将在此时归零。

对于大多数网点来说，这不是问题，因为 NIB 中的对象通常已经由某物拥有。因此，例如，视图中的按钮归其父视图所有。因此，拥有指向该按钮的强大出口是矫枉过正或更糟的可能导致保留周期。

顶级对象显然没有父视图来拥有它们，因此它们需要由其他东西拥有，例如控制器或“文件所有者”。如果你发现东西消失了，你需要在 File 的所有者中为它创建一个强大的 IBOutlet。

有关更多详细信息，请参阅[Apple 的文档](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/LoadingResources/CocoaNibs/CocoaNibs.html#//apple_ref/doc/uid/10000051i-CH4-SW6)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-03T23:57:43.433

对于遇到这个问题的未来搜索者，我认为 CRD 的[Stackoverflow](https://stackoverflow.com/a/13484472/2067021)对类似问题的回答可以解释。即使对象已被释放，不安全的未保留指针（包含实际对象数据）所引用的内存也不一定会归零，因此在该内存实际重用/修改/归零之前，事情可能会正常运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-06T12:11:14.507

你是对的，当试图通过你陈旧的 __unsafe_unretained 引用访问已释放的对象时，应用程序会崩溃。

原因很可能是因为应用程序的某些其他部分正在使用强引用引用这些对象。

尝试在启用僵尸的情况下运行，这会在取消引用假定的陈旧指针时立即导致崩溃。

# r - 如何将数据框中的条目分配给不同的组？

> ID：11121841
> 
> 赞同：0
> 
> 时间：2012-06-20T14:29:58.803
> 
> 标签：r, grouping, dataframe

因此，在我的 df 中有一个列，其中包含我为实验测试的所有主题。条目被编码为具有 x 级别的因子。每个主题都经过了两次测试，因此 df 中的每个主题都有两个数据集。这些数据集可以有不同的长度。现在我需要按测试时间（1 或 2）对受试者进行分组，因此我可以将时间作为固定效应包含在我的模型中。我怎样才能做到这一点？

这是我的小例子df：

```
require("stringr")
>Subject<- c("DG_120204", "DG_120204", "DG_120305", "BZ_120407", "BZ_120506", "BZ_120506",     "BZ_120506", "SN_120310", "SN_120412")
s2<- str_extract(Subject, "\\d{6}")
dates<-as.Date(s2, format="%y%m%d") 
df<-data.frame(Subject, dates)

    Subject      dates
1 DG_120204 2012-02-04
2 DG_120204 2012-02-04
3 DG_120305 2012-03-05
4 BZ_120407 2012-04-07
5 BZ_120506 2012-05-06
6 BZ_120506 2012-05-06
7 BZ_120506 2012-05-06
8 SN_120310 2012-03-10
9 SN_120412 2012-04-12 
```

例如，Subject DG 的前 2 个条目来自测试会话 1，第三行是会话 2，第 4 行是对象 BZ 的会话 1，第 5-7 行是会话 2 的 BZ，依此类推。

我的想法是添加另一个因子列（df$time）并根据 df$Subject 的级别（以及 df$dates 中的日期值？）用 1 和 2 填充它。但现在我什至没有走那么远。

所以我应该有这样的东西：

```
 Subject      dates time
1 DG_120204 2012-02-04    1
2 DG_120204 2012-02-04    1
3 DG_120305 2012-03-05    2
4 BZ_120407 2012-04-07    1
5 BZ_120506 2012-05-06    2
6 BZ_120506 2012-05-06    2
7 BZ_120506 2012-05-06    2
8 SN_120310 2012-03-10    1
9 SN_120412 2012-04-12    2 
```

我知道这是另一个非常基本的问题，请多多包涵！我最终会学会这个...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:42:29.200

如果我正确阅读了您的数据，则每个唯一的 2 字符标识符都是主题，每个唯一的 6 位数字都是差异试验，对吗？如果是这样，这个问题就是为 量身定做的`colsplit`。

```
> cbind(df, colsplit(df$Subject, '_', c('Subject_ID', 'Trial')))
    Subject      dates Subject_ID  Trial
1 DG_120204 2012-02-04         DG 120204
2 DG_120204 2012-02-04         DG 120204
3 DG_120305 2012-03-05         DG 120305
4 BZ_120407 2012-04-07         BZ 120407
5 BZ_120506 2012-05-06         BZ 120506
6 BZ_120506 2012-05-06         BZ 120506
7 BZ_120506 2012-05-06         BZ 120506
8 SN_120310 2012-03-10         SN 120310
9 SN_120412 2012-04-12         SN 120412
> 
```

现在您已经准备好使用您的主题 ID 和试用号了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T14:57:43.117

您可以为主题添加一列（目前，它显然只是第一列的子字符串），然后添加一列指示它是否是新日期（1）或不是（0），然后只是累积计数日期更改。

```
df$id <- str_replace(df$Subject, "_.*", "") 
library(plyr)
df <- df[ order(df$Subject), ]
ddply(df, "id", mutate, 
  new  = c(1, dates[-1] != dates[-length(dates)]), 
  time = cumsum(new)
)

#     Subject      dates id new time
# 1 BZ_120407 2012-04-07 BZ   1    1
# 2 BZ_120506 2012-05-06 BZ   1    2
# 3 BZ_120506 2012-05-06 BZ   0    2
# 4 BZ_120506 2012-05-06 BZ   0    2
# 5 DG_120204 2012-02-04 DG   1    1
# 6 DG_120204 2012-02-04 DG   0    1
# 7 DG_120305 2012-03-05 DG   1    2
# 8 SN_120310 2012-03-10 SN   1    1
# 9 SN_120412 2012-04-12 SN   1    2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T14:49:18.890

`split()`与`for`循环的组合可以解决问题：

```
require("stringr")
Subject<- c("DG_120204", "DG_120204", "DG_120305", "BZ_120407", "BZ_120506",
"BZ_120506", "BZ_120506", "SN_120310", "SN_120412")
s2 <- str_extract(Subject, "\\d{6}")
dates<-as.Date(s2, format="%y%m%d") 
df <- data.frame(Subject, dates)

# Add categorical variable:
spl <- split(df, f=df$Subject)
times <- 1:length(spl)
for(x in seq(along=times)) {
    spl[[x]]$time <- times[x]
}
df <- unsplit(spl, f=df$Subject)

# Sort based of 'Subject' column: 
df <- df[order(df$Subject),]
> df
    Subject      dates time
4 BZ_120407 2012-04-07   1
5 BZ_120506 2012-05-06   2
6 BZ_120506 2012-05-06   2
7 BZ_120506 2012-05-06   2
1 DG_120204 2012-02-04   3
2 DG_120204 2012-02-04   3
3 DG_120305 2012-03-05   4
8 SN_120310 2012-03-10   5
9 SN_120412 2012-04-12   6 
```

# jqgrid - Jqgrid 缺少关于程序集版本的文档

> ID：11121843
> 
> 赞同：1
> 
> 时间：2012-06-20T14:30:10.177
> 
> 标签：jqgrid

我打算购买 jqgrid 的商业许可证，以便在我的 aspx 网站上将 Jqgrid 用作程序集，但我正在努力寻找图书馆的任何文档。

我发现的每一点文档都显示了 javascripts 的示例，但我需要有关使用 asp 组件的文档..

有谁知道我在哪里可以找到这个？我认为商业许可证会有更好的文档..

**编辑**

我不知道我怎么没找到这个站点，但是演示站点非常好！

[http://www.trirand.net/demoaspnet.aspx](http://www.trirand.net/demoaspnet.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T15:31:41.963

这是 jqGrid ASP.NET 组件的 API 文档：[http ://www.trirand.net/documentation.aspx](http://www.trirand.net/documentation.aspx)

同一页面包含指向组件的演示和其他有用信息的链接。另请记住，这些组件仍会在网页上呈现 JavaScript 网格，因此根据您的需要，某些 JavaScript 文档可能仍然适用。

# configuration - 如何为包配置 logback？

> ID：11121846
> 
> 赞同：43
> 
> 时间：2012-06-20T14:30:21.377
> 
> 标签：configuration, package, logback

是否可以将 logback 配置为除 xy 之外的所有包以例如 WARN 或 INFO 级别记录？然后仅对包 xy 进行单独配置。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2013-02-13T17:14:22.410

我不知道您可以通过任何方式获得问题的“NOT”包方面，但我通常在 DEBUG 记录一个包，在 INFO 记录所有其余包......以上是......WARN 和 ERROR。这是直接的中间日志。我的记录器都像...

```
package rekdev.org.service.api;
public class DefaultConfigResource {
    // ...
    private static final Logger log = LoggerFactory.getLogger( DefaultConfigResource.class );
    // ...
} 
```

...在 logback.xml 配置上，例如...

```
 <logger name="rekdev.org.service.api" level="debug" />
  ...
  <root level="info">
    <appender-ref ref="STDOUT" />
    <appender-ref ref="DAILY_ROLLING" />
    <appender-ref ref="SYSLOG" />
  </root> 
```

具有在 INFO、WARN、ERROR 但所有 rekdev.org.service.api 类中弹出大多数输出​​的效果。rekdev.org.service.api 包中的所有类都会在 DEBUG、INFO、WARN、ERROR 处产生输出。

还是我完全误解了你的问题？

# c - 访问 C 中的位域

> ID：11121852
> 
> 赞同：4
> 
> 时间：2012-06-20T14:30:38.350
> 
> 标签：c, bit-fields, powerpc

我有一个对应于硬件寄存器的结构。

```
typedef unsigned int uint32;
typedef union A_u{
    uint32 words[4];
    struct {

        uint32 a : 2;
        uint32 b : 3;
        uint32 unused : 27;

        uint32 c : 2;
        uint32 d : 3;
        uint32 unused0 : 27;

        uint32 unused1 : 1;
        uint32 e : 1;
        uint32 f : 1;
        uint32 g : 1;
        uint32 h : 1;
        uint32 i : 1;
        uint32 unused2 : 26;

        uint32 reserved6 : 32;
       }s;
}A_t;

main()
{

    A_t obj;
    uint32 val = 1;

    memset(&obj, 0, sizeof(A_t));
    //fills data
    read_data(&obj);

    printf("0x%x\n", obj.words[2]);
    printf("obj.s.h = %d\n", obj.s.h);

} 
```

输出是

> 0x80000000
> obj.sh = 1。

虽然第三个单词是 0x80000000，但 obj.sh 显示为 1。我无法理解这一点。我在 powerpc 上运行它，其中第一位字段是最高有效位。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T15:44:05.520

就内存位置如何与结构和联合以及其他复杂数据结构的成员对齐而言，编译器可以自由地做他们喜欢的事情。

我已经看到由于对齐边界问题导致的使用结构的神秘运行时错误，因为源的一部分以一种方式看待结构，而另一部分以不同的方式看待它。

C 基本上使用结构作为模板来覆盖内存区域，如果不同的文件以不同的方式查看结构，则一段代码正在计算与另一个不同的结构成员的地址偏移量。

一些编译器将提供一个编译指示，允许您指定一个打包操作，以便您可以指定结构成员的对齐边界。

为了保持与硬件的兼容性，最好的方法似乎是使用无符号字符数组，因为这样您可以索引到无符号字符数组元素，然后使用按位运算符选择八位之一。然后，您可以将无符号字符数组包装在各种访问函数、类、宏等中，以操作您想要读取和写入的实际数据。使用无符号字符数组也更易于移植。

位字段似乎更多地是应用程序以更节省内存的方式维护指标和标志的一种方式，但对于与应用程序外部的实体（硬件或软件）进行通信并没有那么有用。并且取决于编译器和运行应用程序的硬件，使用位字段可能会在访问、打包和解包位字段时引入小的运行时间损失。

# sql - 根据另一个表中的日期获取一个表中某个日期范围内的最新记录

> ID：11121857
> 
> 赞同：0
> 
> 时间：2012-06-20T14:30:59.100
> 
> 标签：sql, join, oracle10g, left-join

我在 Oracle 10 数据库中有以下表。

列出 ID 和相关日期的 TABLE_A：

```
ID         DATE
-----------------------
A1234    | 31-Dec-2008 
B5678    | 31-Dec-2009
A1234    | 31-Dec-2010 
```

TABLE_B 在月末给出 ID 的评级：

```
ID         RATING_DATE   RATING
--------------------------------
A1234    | 31-Dec-2008 | 3
A1234    | 31-Jan-2009 | 3
A1234    | 28-Feb-2009 | 3
A1234    | 31-Mar-2009 | 2
A1234    | 30-Apr-2009 | 2
A1234    | 31-May-2009 | 3
A1234    | 31-Jun-2009 | 2
A1234    | 31-Jan-2010 | 3
A1234    | 28-Feb-2010 | 3
B5678    | 31-Dec-2009 | 4
B5678    | 31-Dec-2010 | 4
B5678    | 31-Jan-2011 | 4
B5678    | 28-Feb-2011 | 4 
```

**我需要的：**

对于 TABLE_A 中的所有`ID`,`DATE`对，我想在 [DATE, DATE + 12 个月) 范围内找到最新的`RATING_DATE`和TABLE_B 中的对。`RATING`

**例如：**对于`A1234 | 31-Dec-2008`，我有兴趣在 2008 年 12 月 31 日至 2009 年 11 月 30 日之间找到最新的`RATING_DATE`。`RATING`在这里，我想要`A1234 | 31-Jun-2009 | 2`

我有以下 SQL 来获取最新的`RATING_DATE`，但我不知道如何获取`RATING`：

```
SELECT      A.DATE, 
            A.ID, 
            MAX(TABLE_B.RATING_DATE)

FROM        TABLE_A A LEFT JOIN TABLE_B B
            ON
            A.ID = B.ID
            AND
            B.RATING_DATE >= A.DATE
            AND
            B.RATING_DATE < ADD_MONTHS(A.DATE, 12)

GROUP BY    A.DATE, 
            A.ID 
```

有没有办法在没有嵌套连接或其他子查询的情况下完成这项工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T20:45:51.673

这是一个满足指定要求的查询：

```
SELECT DISTINCT a.id
     , a.date_
     , LAST_VALUE(b.rating_date) OVER (PARTITION BY a.id, a.date_ ORDER BY b.rating_date ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_rating_date
     , LAST_VALUE(b.rating)      OVER (PARTITION BY a.id, a.date_ ORDER BY b.rating_date ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_rating 
  FROM table_a a
  LEFT JOIN table_b b ON b.id = a.id 
       AND b.rating_date >= a.date_ AND b.rating_date < ADD_MONTHS(a.date_,12)
 ORDER BY a.id, a.date_ 
```

这是另一种选择：

```
SELECT DISTINCT a.id
     , a.date_
     , MAX(b.rating_date) KEEP (DENSE_RANK LAST ORDER BY b.rating_date) OVER(PARTITION BY a.id, a.date_) as last_rating_date 
     , MAX(b.rating     ) KEEP (DENSE_RANK LAST ORDER BY b.rating_date) OVER(PARTITION BY a.id, a.date_) as last_rating
  FROM table_a a
  LEFT 
  JOIN table_b b ON b.id = a.id AND b.rating_date >= a.date_ AND b.rating_date < ADD_MONTHS(a.date_,12)
 ORDER BY a.id, a.date_ 
```

* * *

两者都返回相同的结果集：

```
ID    DATE_      LAST_RATING_DATE LAST_RATING
----- ---------- ---------------- -----------
A1234 2008-12-31 2009-06-30                 2
A1234 2010-12-31                             
B5678 2009-12-31 2009-12-31                 4 
```

注意：为了设置测试环境，我将`date`列的名称更改`table_a`为`date_`.

```
create table table_a (id varchar2(5), date_ date);
create table table_b (id varchar2(5), rating_date date, rating int);
alter session set nls_date_format = 'YYYY-MM-DD';
insert into table_a values ('A1234','2008-12-31');
insert into table_a values ('B5678','2009-12-31');
insert into table_a values ('A1234','2010-12-31');
insert into table_b values ('A1234','2008-12-31',3);
insert into table_b values ('A1234','2009-01-31',3);
insert into table_b values ('A1234','2009-02-28',3);
insert into table_b values ('A1234','2009-03-31',2);
insert into table_b values ('A1234','2009-04-30',2);
insert into table_b values ('A1234','2009-05-31',3);
insert into table_b values ('A1234','2009-06-30',2);
insert into table_b values ('A1234','2010-01-31',3);
insert into table_b values ('A1234','2010-02-28',3);
insert into table_b values ('B5678','2009-12-31',4);
insert into table_b values ('B5678','2010-12-31',4);
insert into table_b values ('B5678','2011-01-31',4);
insert into table_b values ('B5678','2011-02-28',4); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T18:45:57.067

```
MAX(B.RATING) KEEP (DENSE_RANK LAST ORDER BY RATING_DATE) 
```

这假设如果上个月有多个评级，您想要最大的评级。

[这](http://docs.oracle.com/cd/E11882_01/server.112/e26088/functions065.htm#i1000901)是文档`FIRST`和`LAST`语法。（顺便说一句，6 月 31 日不存在。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T14:55:34.013

虽然 SQL 的特定实现可能会使这更容易，但我认为这应该适合你

```
SELECT v1.id, v1.myDate, v1.rating_date, b2.rating
FROM (SELECT a.id, a.myDate, MAX(b.rating_date) rating_date
      FROM tab_a a 
      LEFT JOIN tab_b b
      ON a.id = b.id
      AND b.rating_date >= a.myDate
      AND b.rating_date < ADD_MONTHS(a.myDate, 12)
      GROUP BY a.id, a.myDate) v1
LEFT JOIN tab_b b2
ON v1.id = b2.id
AND v1.rating_date = b2.rating_date 
```

# c++ - 保存具有自定义扩展名的文件

> ID：11121869
> 
> 赞同：0
> 
> 时间：2012-06-20T14:31:42.030
> 
> 标签：c++, linux, qt, save, file-extension

我有一个我在 Windows 中编写的程序，这段代码可以在 Windows 上运行，但是在 linux 中编译时，保存的文件没有 .l2p 扩展名。

```
void MainWindow::on_saveButton_clicked()
 {
     QString fileName = QFileDialog::getSaveFileName(this,
         tr("Salvesta Projekt"), "",
         tr("Latid Pindalaks (*.l2p)"));

     if (fileName.isEmpty())
         return;
     ... 
```

我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T15:48:45.533

如果文件名没有您需要的扩展名，只需添加它：

```
QString fileName = QFileDialog::getSaveFileName(this,
    tr("Salvesta Projekt"), "",
    tr("Latid Pindalaks (*.l2p)"));

if (fileName.isEmpty())
    return;

if (!fileName.endsWith(".l2p"))
    fileName += ".l2p"; 
```

# jquery - jquery 移动图像宽度导致在 xcode iPhone (4.3.3) 上延迟加载图像

> ID：11121870
> 
> 赞同：1
> 
> 时间：2012-06-20T14:31:42.297
> 
> 标签：jquery, image, jquery-mobile

我正在使用 jquery 1.7.1 和 jquery-mobile 1.1.0。它适用于 iPhone（和 iPad）设备 - 在 Mac OS X 上使用 xCode 进行了测试。

我有一个[多页面模板](http://jquerymobile.com/demos/1.1.0/docs/pages/multipage-template.html)（不是简单页面）：

```
<div data-role="page" id="page-start">
    <img src="src/images/header-img.png" style="max-width:100%;" />

    <div data-role="content">
        <p>
            Welcome to the test page<br/>
            now some test input fields:
        </p>
        <div data-role="fieldcontain">
            <label for="name">Text Input:</label>
            <input type="text" name="name" id="name" value=""/>
        </div>
        <div data-role="fieldcontain">
            <label for="name2">Text Input:</label>
            <input type="text" name="name2" id="name2" value=""/>
        </div>
    </div>
</div> 
```

现在我的问题是，页面已经显示，但是图像（原点宽度：770px）的显示延迟了 2-3 秒。如果没有“最大宽度”或简单的“宽度”样式属性，它会直接显示（但宽度为 770 像素）。

如何解决显示页面时图像已经加载的问题？

我还尝试隐藏“#page-start”（最初使用 style="display:none"）并在 javascript 上执行：

```
$(document).bind('pageinit', function() {
    $("#page-start").show();
}); 
```

但这并没有解决我的问题，页面直接显示，图像需要 2,3,4 秒才能显示出来并且页面向下跳了一下（特别是图像高度）。

# json - 使用 org.json.me 解析 JSON 是否有字符串长度限制

> ID：11121871
> 
> 赞同：3
> 
> 时间：2012-06-20T14:31:42.043
> 
> 标签：json, blackberry

我在 Blackberry OS 5.0 上使用 org.json.me ( *https://github.com/upictec/org.json.me )。*

解析来自服务器的 JSON 消息时出现以下错误。

```
JSONException: Expected a ',' or '}' at character 16201... 
```

**我的问题：使用这个库时是否有解析字符串长度限制？**

*附加信息*：我正在测试的 API 允许客户端提供搜索查询和要返回的最大记录数。当我打电话询问 100 条记录时，我收到此错误。此响应有 28542 个字符。当我要求 50 条记录时，它工作正常 - 没有错误。此响应有 14195 个字符。

**这是 json 类的限制还是我的代码在某处有问题？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T16:53:19.240

听起来您没有从服务器获取所有数据。通过移动传输接收数据时有严格的大小限制。尝试切换到 Wi-Fi，看看是否有任何不同。

# javascript - 用于 android 的 google chrome beta 是否支持带有 webkitdirectory 属性的文件上传？

> ID：11121876
> 
> 赞同：4
> 
> 时间：2012-06-20T14:31:51.467
> 
> 标签：javascript, android, html, google-chrome, webkit

我最近对 ​​Google Chrome 进行了大量研究，并且浏览了 beta 页面，但我找不到关于这个特定主题的任何文档。我有一个使用 webkitdirectory 方法的网络应用程序：

```
<input type="file" class="hidden-input" multiple webkitdirectory> 
```

并且适用于桌面版谷歌浏览器，但不适用于 Android 测试版。根据我在 Android Chrome 测试版上运行应用程序时发生的情况（更多没有发生的情况），我假设不支持这种类型的文件上传。我只是想要一些文档，所以我可以确定它不是其他原因导致它不起作用。

更新：我找到了这个 jsFiddle： http: [//jsfiddle.net/SeYgA/1/](http://jsfiddle.net/SeYgA/1/)，它给出了与我的网络应用程序相同的结果。它为您提供了有关如何处理操作的选项，但选择文件浏览器仅允许您选择文件，即使在选择文件后，也不会上传。（注意：必须在 chrome beta 上运行才能让 android 体验相同的行为）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:35:01.890

这个时候，答案是否定的。

# iphone - 在 CGContext 上绘制一个矩形而不使用 UIView 的子类

> ID：11121879
> 
> 赞同：0
> 
> 时间：2012-06-20T14:31:59.377
> 
> 标签：iphone, drawing, cgcontext

如何在不使用子类`UIView`和使用 a 的情况下绘制两个具有黑色背景的不同矩形`CGContext`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T12:43:11.547

在适当的位置添加您需要的任何 vanilla UIView 对象，并将它们的背景颜色设置为您喜欢的任何颜色。

绘图将在 CGContext 中完成，您将无法控制它。

或者，添加您自己的*CALayer*子类，将其设置为视图层并在其中绘制矩形，在`drawInContext:`.

或者，将不同的对象设置为视图层的委托，并在委托方法中绘制它`drawLayer:inContext:`。

# drupal - DRUPAL：制作具有相同布局但内容不同的多个首页

> ID：11121881
> 
> 赞同：0
> 
> 时间：2012-06-20T14:32:09.690
> 
> 标签：drupal, drupal-7, drupal-theming

首先，我是 drupal 的初学者，所以任何建议都对我有很大帮助。

我的问题：

我正在为一个乡村礼堂实习，他们希望我使用 drupal 为他们重新创建他们的网站。到目前为止，我已经创建了一个带有下拉菜单、幻灯片和快速选项卡的首页。我想要做的是创建四个与当前下拉列表（商业、住宅、政府、访客）分开的菜单按钮，当有人点击它们时，它会将它们带到特定页面，该页面具有相同的布局但不同的图像下拉菜单中的幻灯片和菜单项。

例如，登录页面将是业务的默认设置。因此幻灯片、下拉菜单和快速选项卡将包含与业务相关的内容。如果有人点击居民，它会将他们带到具有相同布局的居民部分，但幻灯片中的图像不同，下拉菜单中要单击的项目不同，快速选项卡中的选项卡也不同。

我曾尝试使用视图来做到这一点，但我一直觉得这不是我想要的。我的想法是操纵 pa​​ge.tpl.php，但我可能会再次朝着完全错误的方向前进。

谢谢你的帮助！！

![截图][1] [http://i.stack.imgur.com/bIIXc.jpg](http://i.stack.imgur.com/bIIXc.jpg) “截图”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T13:29:31.803

我知道这个问题已经“回答”了，但我想我遇到了你遇到的类似问题。我解决这个问题的方法是操纵 php page.tpl.php 页面和 front-page.tpl.php。然后，您可以根据自己的喜好自定义页面。如果您在 google austin texas 上搜索，您会看到一个对您正在寻找的东西做了一些事情的网站。

干杯!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T14:41:21.950

正如您所提到的，我认为这是将它们视为登录页面。

我会创建一个名为“登陆页面”的内容类型。我会给该内容类型一个具有多个值的图像字段。然后，您创建一个使用该图像字段的幻灯片，并有一个使用当前节点的子菜单项的下拉菜单。

然后，这允许您创建任意数量的这些登录页面作为节点，分别为每个页面上传图像，并使用菜单系统定义下拉菜单中可用的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T17:33:21.407

使用[Context](http://drupal.org/project/context)、[Delta](http://drupal.org/project/delta)和像[Omega](http://drupal.org/project/omega)这样的基本主题将是解决“登陆页面”问题的一种方式。

# stdout - 如何从 delay_job 作业中获取标准输出？

> ID：11121882
> 
> 赞同：2
> 
> 时间：2012-06-20T14:32:14.493
> 
> 标签：stdout, delayed-job, stderr, exit-code

我需要从 rails 运行一些外部操作系统命令，我需要向用户显示它们的输出和退出代码。我检查了**Delayed::Job** API，但没有看到如何获取作业的标准输出。尝试过**BJ** (BackgroungJob) - 它有 stdout、stderr 和 exit_status 方法，但它在 rails 开始时失败：

```
~/my_src/ruby_apps/ro > script/rails c
DEPRECATION WARNING: Calling set_table_name is deprecated. Please use `self.table_name = 'the_name'` instead. (called from <top (required)> at /home/zhoran/my_src/ruby_apps/ro/config/application.rb:7)
DEPRECATION WARNING: Calling set_primary_key is deprecated. Please use `self.primary_key = 'the_name'` instead. (called from <top (required)> at /home/zhoran/my_src/ruby_apps/ro/config/application.rb:7)
DEPRECATION WARNING: Calling set_table_name is deprecated. Please use `self.table_name = 'the_name'` instead. (called from <top (required)> at /home/zhoran/my_src/ruby_apps/ro/config/application.rb:7)
DEPRECATION WARNING: Calling set_primary_key is deprecated. Please use `self.primary_key = 'the_name'` instead. (called from <top (required)> at /home/zhoran/my_src/ruby_apps/ro/config/application.rb:7)
DEPRECATION WARNING: Calling set_table_name is deprecated. Please use `self.table_name = 'the_name'` instead. (called from <top (required)> at /home/zhoran/my_src/ruby_apps/ro/config/application.rb:7)
DEPRECATION WARNING: Calling set_primary_key is deprecated. Please use `self.primary_key = 'the_name'` instead. (called from <top (required)> at /home/zhoran/my_src/ruby_apps/ro/config/application.rb:7)
script/rails:6: stack level too deep (SystemStackError) 
```

似乎它与 3.2.3 不兼容

请帮助我从延迟的工作中获取标准错误、标准输出和退出代码，或者建议类似的 BJ。

# lucene.net - RavenDB 停用词

> ID：11121884
> 
> 赞同：1
> 
> 时间：2012-06-20T14:32:27.787
> 
> 标签：lucene.net, ravendb

我希望在 RavenDB 中的 StandardAnalizer 中添加一些新的停用词。

我的文档结构有一个全名。我正在使用 RavenDB 来支持自动完成功能。当用户输入“先生”时，我们不想要任何结果。我想只过滤我的 jQuery 脚本中的单词，但想看看 RavenDB 中的选项。

{ 姓名：“约翰·史密斯先生”}

在 RavenDB 中将停用词列表作为单个文档也很好，但是配置文件很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T08:58:16.237

您必须定义一个自定义分析器才能使其工作。

# java - 非静态变量访问静态变量的java checkstyle规则

> ID：11121885
> 
> 赞同：5
> 
> 时间：2012-06-20T14:32:29.487
> 
> 标签：java, checkstyle, static-variables

是否有可用的 Checkstyle 规则来限制对静态变量和方法的非静态访问？

这应该引起警告：

```
instance.staticField = value; 
```

Eclipse 对此有一个设置，但我想在构建中强制执行它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T15:12:03.730

我想使用`javac -Xlint:static -Werror toto.java`是你正在寻找的。

从[文档](http://docs.oracle.com/javase/7/docs/technotes/tools/solaris/javac.html)：

*   `-Xlint:name`：启用警告名称。请参阅[可以使用 -Xlint 选项启用或禁用](http://docs.oracle.com/javase/7/docs/technotes/tools/solaris/javac.html#xlintwarnings)的警告部分，了解可以使用此选项启用的警告列表。

*   `-Werror`: 如果出现警告则终止编译。

我试过这个例子：

```
public class StaticTest {
    public static String toto = "toto";

    public static void main(String s[]) {
        StaticTest st = new StaticTest();
        st.toto="dfd";
    }
} 
```

输出是：

> StaticTest.java:16：警告：[静态] 静态变量应由类型名称限定，
> 
> StaticTest，而不是通过表达式
> 
> ```
>  st.toto="dfd";
> 
>      ^ 
> ```
> 
> 错误：发现警告并指定 -Werror 1 个错误 1 ​​个警告

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T14:36:28.910

顾名思义，Checkstyle 只检查代码的形式。如果您搜索错误模式，您应该查看 Findbugs：

[http://findbugs.sourceforge.net](http://findbugs.sourceforge.net)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-09T06:35:44.633

不，Checkstyle 对所有检查都有限制/范围 - 它仅检查一个文件的结构，无法获取其他类/文件的结构。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-20T14:42:34.090

为此，您可以使用[Firebug](http://en.wikipedia.org/wiki/FindBugs)或[PMD 。](http://pmd.sourceforge.net)两个主要的构建工具`Maven`，并且`Ant`确实有为您执行此操作的命令。

# multithreading - Perl 多线程 - Perl 以活动线程退出：已完成且未加入

> ID：11121892
> 
> 赞同：0
> 
> 时间：2012-06-20T14:32:53.763
> 
> 标签：multithreading, perl

我正在尝试在我的程序中创建子程序的线程（称为重组）。我使用下面的代码来创建线程，我改编自[http://chicken.genouest.org/perl/multi-threading-with-perl/](http://chicken.genouest.org/perl/multi-threading-with-perl/)我使用了这段代码，因为这些线程是在循环中创建的，使用取决于变量 $ParentTally 的线程数，每个循环都不同（$ParentTally 最多可以有 1000 个，我不想一次运行 1000 个线程）

```
my $nb_process = 20;
my $nb_compute = $ParentTally;
my $i=0;
my @running = ();
my @Threads;
my %NewPopulation;

while (scalar @Threads < $nb_compute) {
    @running = threads->list(threads::running);
    if (scalar @running < $nb_process) {
        my $Offspring= threads->new (sub {Recombination(\%Parent1Chromosome, \%Parent2Chromosome)});
        push (@Threads, $Offspring);
        my $tid = $Offspring->tid;
    }

    @running = threads->list(threads::running);
    foreach my $thr (@Threads) {
        if ($thr->is_running()) {
           my $tid = $thr->tid;
        }
       elsif ($thr->is_joinable()) {
          my $tid = $thr->tid;
          my $Offspring1=$thr->join();
          $NewPopulation{$Offspring1}{'Tally'}+=1;
       }
    }
    @running = threads->list(threads::running);
    $i++;
}

while (scalar @running != 0) {
     foreach my $thr (@Threads) {
      if ($thr->is_joinable()){
         my $Offspring1=$thr->join(); 
         $NewPopulation{$Offspring1}{'Tally'}+=1;
      }
    }
    @running = threads->list(threads::running);
} 
```

（注意：$ParentTally 取自代码前面的另一个哈希值，我的 $ParentTally=$hashref->{'Tally'}; 所以这部分程序每次循环使用不同的 $ParentTally 值。%Parent1Chromosome & %Parent2Chromosome 是在程序前面创建的。子程序“重组”很长，所以我没有发布它，但它返回一个整数。）

通常在运行程序时（尽管并非总是如此，许多早期的代码都依赖于随机变量，因此程序永远不会运行相同的）一旦它完成我得到'Perl exited with active threads:'number'finished and unjoined'（ “数字”因运行而异）。我以为：

```
 while (scalar @running != 0) {
     foreach my $thr (@Threads) {
      if ($thr->is_joinable()){
         my $Offspring1=$thr->join(); 
         $NewPopulation{$Offspring1}{'Tally'}+=1;
      }
    } 
```

是否意味着所有线程都会在进入下一段代码之前完成？我究竟做错了什么？（我以前从未使用过线程）。我曾研究过使用[http://www.perlmonks.org/?node_id=735931](http://www.perlmonks.org/?node_id=735931)但我并不真正了解如何使用 Thread::Queue 并且无法找到教程（并且不了解[http ://perldoc.perl.org/Thread/Queue.html](http://perldoc.perl.org/Thread/Queue.html)）。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T15:33:15.240

不是对您的代码的修复，但这里是我如何使用队列的大纲（显然需要一些填充以适应您的目的）。如果内存使用存在问题，有很多方法可以改进这一点 - 每个生成的线程都获取所有范围内变量的完整副本；使用线程时很容易遇到内存问题

```
#!/usr/bin/perl

use strict ;
use threads ;
use Thread::Queue ;

my $threadCount = 2 ;

my $DataQueue = Thread::Queue->new() ;
my $ReportQueue = Thread::Queue->new() ;

my $threads = [] ;

# create pool of worker threads
for ( my $i = 0 ; $i<$threadCount ; $i ++ ){
    push( @$threads, threads->create( \&doStuff, $DataQueue, $ReportQueue ) ) ;
}

# array of data on which the threads have to work
my @array ;
# put work onto queue for threads to process
foreach my $workItem ( @array ){
   $DataQueue->enqueue( $workItem );
}

# enqueue undef for each worker to tell it no more work
# then wait for them all to join
$DataQueue->enqueue( (undef) x $threadCount ) ;
$_->join for @$threads ;

my %NewPopulation ;
# read the output of the threads from ReportQueue
while ( my $reportItem = $ReportQueue->dequeue() ){
    $NewPopulation{$reportItem}{'Tally'}++ ;
}

# display tallys
for my $offspring ( keys %NewPopulation ){
    print "Offspring $offspring Tally => " . $NewPopulation{$offspring}{'Tally'} . "\n" ;
}

sub doStuff{
    my ( $DataQueue, $ReportQueue ) = @_ ;

    while ( my $inputHash = $DataQueue->dequeue() ){
        my $result ;
        # do things here - the logic in your Recombination sub

        # return result to report queue
        $ReportQueue->enqueue($result) ;
    }

   # Enqueue undef to report queue so report thread knows we're done
   $ReportQueue->enqueue( undef ) ;

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T15:10:10.200

我相信错误在最后一个`while`循环中：

```
while (scalar @running != 0) {
     foreach my $thr (@Threads) {
      if ($thr->is_joinable()){
         my $Offspring1=$thr->join(); 
         $NewPopulation{$Offspring1}{'Tally'}+=1;
      }
    }
    @running = threads->list(threads::running);
} 
```

根据[线程文档](http://perldoc.perl.org/threads.html#THREAD-STATE)`is_joinable`，仅当线程已*完成运行*、尚未分离且尚未加入时，调用才会返回 true。我的猜测是，当您进入本节时，您仍然有正在运行的线程，因此您跳过它们。您可能会像在上一个`while`循环中所做的那样进行另一个调用，`is_running`以查看您是否仍有线程在运行并以某种方式处理线程。

# extjs - 从另一个 extjs 脚本执行 extjs 脚本

> ID：11121895
> 
> 赞同：1
> 
> 时间：2012-06-20T14:32:59.577
> 
> 标签：extjs, extjs3

我正在研究**extjs 3.2.1**，我正在尝试从另一个 extjs 脚本执行一个 extjs 脚本。我想要做的是当用户点击**数据库**面板时，脚本**Database.js**应该执行。到目前为止我所做的是

```
var tabs = new Ext.TabPanel({
        activeTab : 0,
        autoScroll: true,
            items:[
                {
              title:'Graphical-View',
              height:550,
              bodyStyle:{"background-color":"white"},
              autoScroll: true,
              items:[ GraphicalViewPanel]
              },{
                title: 'Database',
                height : 800,
                autoScroll: true,
                bodyStyle:{"background-color":"white"},
                autoLoad:{
                        url:'/resource/js/Database.js',
                        scripts : true
                }
}]      
}); 
```

但是当我执行文件并单击***数据库面板*****时， Database.js**的内容会加载到面板中，而不是执行脚本。

此外，如果我将**图形视图面板**放在**数据库面板**之后，浏览器会给出错误 --- **null 为 null 或不是对象**

我无法弄清楚问题，任何帮助将不胜感激

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T06:09:46.970

在 iframe 中加载您的 Database.js

```
 bodyCfg: {
        tag: 'iframe',         
        src : ""
    } 
```

或制作一个 php 文件并将您的 Database.js 代码放在脚本标签中，并在 src 中提供 url

```
 bodyCfg: {
        tag: 'iframe',         
        src : "abc.php"
    } 
```

对于 Extjs 3

# javascript - 如何使 div 的不透明度低于过度分层的 iframe

> ID：11121899
> 
> 赞同：0
> 
> 时间：2012-06-20T14:33:14.637
> 
> 标签：javascript, jquery, css, opacity

我想显示注册表单，其中页面显示为灰色，并且包含该表单的 iframe 出现在中间，如下所示：

代码：

```
<div id="cover5">
    <iframe name="warning" src="SignIn.php" id="warning" style="position: relative; height: 250px;">
     </iframe>
</div> 
```

CSS：

```
#cover5 {
    position:absolute;
    top:0px;
    left:0px;
    overflow:hidden;
    display:none;
    width:100%;
    height:100%;
    background-color:gray;
    text-align:center;
    opacity: 0.5;
}

#warning {
    border-radius: 20px;
    top: 150px;
    margin:auto;
    position:relative;
    width:600px;
    height:fit-content;
    background-color:white;
    color:black;
    padding:10px;
    border: 5px solid #003366;
    opacity: 1;
} 
```

我希望封面（div）的不透明度低（背景模糊）而iframe不应该被模糊，问题是当我改变div的不透明度时，iframe的不透明度也会改变，如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:50:47.177

将 iframe 从 cover5 中取出并用绝对定位。在这种情况下，您不需要触摸 iframe 的不透明度

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T14:55:29.027

因为你的 iframe 是嵌入在 cover5 中的，所以它会受到 cover5 的不透明度的影响。据我所知，没有办法解决这个问题。我试过设置 z-indexs 和其他显示设置，但没有任何效果。

但是，由于您的 cover5 div 是绝对定位的，而您的警告不是，请将您的标记更改为此，这应该可以解决您的问题；

```
<div id="cover5"></div>
<iframe name="warning" src="SignIn.php" id="warning" style="position: relative; height: 250px;"></iframe> 
```

此外，`opacity`不支持跨浏览器，因此您的 css 应包含这些其他规则；

```
-khtml-opacity: .50;
-moz-opacity: .50;
-ms-filter: ”alpha(opacity=50)”;
filter:alpha(opacity=50);
opacity:.50; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T15:02:11.843

正如 Huangism 提到的，您可以保留 #cover5 样式，移除 #cover5 div 的外部并将绝对定位应用于 iframe 以使其在屏幕上居中。

具体来说，对

```
top: 50%;
left: 50%;
position: absolute; 
```

只需确保将边距偏移容器宽度和高度的一半，在这种情况下：

```
margin: -125px 0 0 -300px; /* The height is 250px and the width is 600px */ 
```

你的标记看起来像这样：

```
<div id="cover5"></div>

<iframe name="warning" src="SignIn.php" id="warning" style="position: relative; height: 250px;"></iframe> 
```

这是一个 jsFiddle 示例：http: [//jsfiddle.net/VxntD/](http://jsfiddle.net/VxntD/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T14:45:03.653

在父级而不是子级上具有不透明度的方法不是使用不透明度而是使用**Alpha 通道**(RGBa)。

警告：旧版浏览器不支持 RGBa。

```
background-color:rgba(128,128,128,.5); 
```

见：[http ://deepubalan.com/blog/2010/03/29/rgba-vs-opacity-the-difference-explained/](http://deepubalan.com/blog/2010/03/29/rgba-vs-opacity-the-difference-explained/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-20T15:00:16.800

一个 jquery 实现将是：

```
$(document).ready(function() {
    $('#cover5').animate({opacity: 0.5},1000); // which changes opacity smoothly
}); 
```

--

在此处查看带有不透明动画效果的代码的工作演示：http: [//jsfiddle.net/teFYa/](http://jsfiddle.net/teFYa/)

# mongodb - 如何使用 JMSSerializerBundle 反序列化 Doctrine 对象？

> ID：11121900
> 
> 赞同：2
> 
> 时间：2012-06-20T14:33:14.607
> 
> 标签：mongodb, symfony, doctrine, doctrine-odm

我正在使用 Doctrine-ODM，并且正在尝试（反）序列化 Symfony 中的文档对象。

序列化似乎有效，但是当我尝试反序列化时，出现以下错误：

> 您必须为 My\Bundle\Repository\Item::$id 定义一个类型。

我尝试用这个调用反序列化：

```
$object = $serializer->deserialize($serializedItem, 'My\Bundle\Repository\Item', 'json'); 
```

我的文档有一些嵌入式文档，但它们在序列化字符串中似乎没问题。它缺少有关文档类型的信息。这是输出的简化示例：

```
{
    id: "itemID",
    - embededDocument: {
        id: "embeddedDocumentID",
        moreInformation: true
    }
} 
```

现在我已经阅读了[使用说明](http://jmsyst.com/bundles/JMSSerializerBundle/master/usage)，并假设我的解决方案[在第三方食谱的元数据中进行了](http://jmsyst.com/bundles/JMSSerializerBundle/master/cookbook/metadata_for_third_party)解释，但我不知道该怎么做。

如何解决这个问题并将我的字符串正确反序列化为对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T21:24:45.067

在`My\Bundle\Repository\Item`中，您需要定义一个`id`属性，并使用[@Type 注释](http://jmsyst.com/bundles/JMSSerializerBundle/master/reference/annotations#type)对其进行装饰。

# ajax - 在（django）网络应用程序中处理服务器错误（500）

> ID：11121903
> 
> 赞同：0
> 
> 时间：2012-06-20T14:33:20.113
> 
> 标签：ajax, django, error-handling

我编写了一个使用`ajax`和 的网络应用程序。`django`它解析一个文件，从文件中收集一些数据，然后向用户展示处理数据的结果。

如果文件不是预期的格式，解析和数据处理就会失败，程序会告诉用户文件不能被处理。

我试过这种方式

```
def process_file(request):
    success = False
    return_dict = {}    
    ...
    if (request.is_ajax()) and(request.method == "POST"):
        filename = request.POST['filename']
        ...
        data = parse_file(filename)
        results = process_data(data)
        success = True
        return_dict = {'result':results}
     serialized = json.dumps(return_dict)
     if success == True:
         return HttpResponse(serialized,mimetype="application/json")
     else:
        return HttpResponseServerError(serialized, mimetype="application/json") 
```

在`javascript`中，我有一个检查 .If 状态的功能`ajax query`，`status is not 'success'`它会显示一条错误消息。

当我使用 django 服务器时，即使 django 视图中出现 500 错误，这也有效。服务器控制台显示 500 错误，但仍然顺利进行。我想知道如果它部署在生产环境中是否会出现这种情况。

有没有更好的方法来处理 django 视图中的运行时错误？你们有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T15:31:32.680

这里的问题是您并没有真正响应错误。只要请求是通过 AJAX 作为 POST 发送的*，*`success`总是. 这不会告诉您文件是否可以被解析，或者即使文件已经上传，也不会告诉*您*。 *`True`*

 **首先，您的代码目前*总是*会失败（500 错误），因为没有`request.post`; 它应该是`request.POST`。

其次，任何时候你需要从 中提取一个值`request.POST`，你应该总是你`dict.get`，即：

```
filename = request.POST.get('filename') 
```

如果在 POST 数据中找不到该字段，`filename`则等于`None`. `filename`因此，您应该对此进行分支，如果不是，则仅继续使用其余代码`None`，例如：

```
if filename is None:
    return HttpResponseBadRequest()
else:
    # the rest of your code 
```

第三，我假设`filename`是一个输入`type="file"`。如果是这种情况，无论如何它实际上不会存在于 中`request.POST`。所有文件上传进入`request.FILES`. 上述相同的注释适用：

```
filename = request.FILES.get('filename')
if filename is None:
    return HttpResponseBadRequest()
else:
    # the rest of your code 
```

第四，两者`parse_file`似乎`process_data`都是您创建的专有方法，因此无法在此处为您提供太多帮助。但是请记住，`try...except`每当您执行任何可能失败的操作时，都要明智地使用块，例如从文件中读取数据，或以假定的格式解析该数据，而该格式实际上并不存在。

您的`parse_file`and`process_data`方法应该捕获*所有*可能的异常。然后他们可以向上传播它们，在他们的位置引发另一个自定义异常，或者只是默默地失败返回类似`None`. 然后由您的视图在这里做出相应的响应，捕捉异常或分支返回值是否`None`存在。**

# apache - 如果 URI 是目录，则在 htaccess 中返回 403 禁止

> ID：11121904
> 
> 赞同：0
> 
> 时间：2012-06-20T14:33:21.220
> 
> 标签：apache, .htaccess

在我的 htaccess 文件中，如果用户尝试访问目录，我想使用 http 403 代码进行响应，但是如果他们尝试访问文件，请允许。这是怎么做到的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-20T14:35:26.847

关闭[索引选项](http://httpd.apache.org/docs/current/mod/core.html#options)。只有打开时才会提供目录列表页面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T14:43:49.187

使用 mod_rewrite：

启用 mod_rewrite

如果文件系统路径匹配请求 ( `REQUEST_FILENAME`) 是目录 ( `-d`)

发送 403 标头（禁止 - `[F]`）

（不确定将什么作为前两个参数放入 RewriteRule，因此将任何内容重定向到 root）

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -d 
RewriteRule .* / [F] 
```

# asp.net - 发送带有表格的电子邮件

> ID：11121908
> 
> 赞同：2
> 
> 时间：2012-06-20T14:33:30.550
> 
> 标签：asp.net, vb.net, html-email, mailmessage

我正在使用`MailMessage`并希望嵌入一个动态填充的表格来创建电子邮件。我已经设置了一个`MailMessage`属性，`IsBodyHtml`所以我已经能够将 HTML 编码的文本插入到电子邮件的正文中。使用它我可以轻松地创建表格的顶部和底部，但创建行似乎是一场`StringBuilder`噩梦。

该表将有 6 列和可变数量的行，这些行将从集合中填充。请求者不希望将数据作为附件发送。

关于如何最好地开发更好的解决方案的任何建议？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T15:46:10.980

这根本不是一场`StringBuilder`噩梦。

您可以构建一个类，调用它`TableBuilder`或任何您想要的，这将封装这个逻辑。

```
 public class TableBuider
    {

        private StringBuilder builder = new StringBuilder();

        public string[] BodyData { get; set; }
        public int BodyRows { get; set; }

        public TableBuider(int bodyRows, string[] bodyData)
        {
            BodyData = bodyData;
            BodyRows = bodyRows;
        }

        /// <summary>
        /// Since your table headers are static, and your table body
        /// is variable, we don't need to store the headers. Instead
        /// we need to know the number of rows and the information
        /// that goes in those rows.
        /// </summary>
        public TableBuider(string[] tableInfo, int bodyRows)
        {
            BodyData = tableInfo;
            BodyRows = bodyRows;
        }

        public string BuildTable()
        {
            BuildTableHead();
            BuildTableBody();
            return builder.ToString();
        }

        private void BuildTableHead()
        {
            builder.Append("<table>");
            builder.Append("<thead>");
            builder.Append("<tr>");
            AppendTableHeader("HeaderOne");
            AppendTableHeader("HeaderTwo");
            builder.Append("</tr>");
            builder.Append("</thead>");
        }

        private void BuildTableBody()
        {
            builder.Append("<tbody>");
            builder.Append("<tr>");
            // For every row we need added, append a <td>info</td>
            // to the table from the data we have
            for (int i = 0; i < BodyRows; i++)
            {
                AppendTableDefinition(BodyData[i]);
            }
            builder.Append("</tr>");
            builder.Append("</table");
        }

        private void AppendTableHeader(string input)
        {
            AppendTag("th", input);
        }

        private void AppendTableDefinition(string input)
        {
            AppendTag("td", input);
        }

        private void AppendTag(string tag, string input)
        {
            builder.Append("<" + tag + ">");
            builder.Append(input);
            builder.Append("</" + tag + ">");
        }

    }
} 
```

、`AppendTableHeader`和方法封装了`AppendTableDefinition`.`AppendTag``StringBuilder`

这也只是一个基本示例，您也可以在此基础上进行构建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T15:09:43.840

这篇文章是特定于 Lightswitch 的。但是示例代码显示了如何使用 XHTML 和嵌入式 LINQ 表达式来填充 HTML 电子邮件中的可变行表。我认为您应该能够对其进行调整以适合您的应用程序。

[http://blogs.msdn.com/b/bethmassi/archive/2011/01/27/how-to-send-html-email-from-a-lightswitch-application.aspx](http://blogs.msdn.com/b/bethmassi/archive/2011/01/27/how-to-send-html-email-from-a-lightswitch-application.aspx)

# c++ - 在向量中存储对象或指针

> ID：11121909
> 
> 赞同：4
> 
> 时间：2012-06-20T14:33:40.190
> 
> 标签：c++, oop

我在这里问了一个非常相似的问题，但由于这是一个非常基本的问题，我想更准确地陈述我的（新）问题。

假设我有一个非常复杂的 A 类，并且 A 的每个实例都存储在多个容器中，例如向量、队列、......

即使在静态设置中，这意味着对象被添加到容器中一次并且不会被删除或修改：
容器现在应该包含指向对象的指针还是对象本身？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-20T14:36:23.477

如果您需要对象的副本 - 使用对象。如果您需要共享对象或需要多态行为，请使用`smart pointers`. 如果使用智能指针，您将同时拥有自动对象销毁和多态行为。

例如：

```
std::vector<std::shared_ptr<MyObject>> v;
auto ptr = std::shared_ptr<MyObject>(new MyObject());
v.push_back(ptr); 
```

如果您需要存储唯一指针（不共享）：

```
std::vector<std::unique_ptr<MyObject>> v;
auto ptr = std::unique_ptr<MyObject>(new MyObject());
v.push_back(std::move(ptr)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-20T14:41:13.120

如果每个实例`A`都存储在多个容器中，那么您**必须**存储（智能）指针而不是对象本身。否则，每个容器都会有自己唯一的副本。修改一个容器中的实例不会影响其他容器。即使您没有修改任何内容，存储完整的对象副本也不能**说明您的意思**，即跨容器的实例实际上是相同的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-20T14:38:40.903

如果您的对象很大，或者复制成本高或复制复杂，则存储智能指针。

# c++ - 具有模板化成员函数的类，是同一个类吗？

> ID：11121910
> 
> 赞同：2
> 
> 时间：2012-06-20T14:33:41.823
> 
> 标签：c++, templates

我对模板化成员函数有点困惑，假设我们有一些带有模板化成员函数的奇怪结构，如下所示：

```
struct Foo
{
    template <typename T> void f(T t) {};
}; 
```

然后，我们将该结构存储到一些标准容器中：

```
std::vector<Foo> V;

V.push_back(Foo());
V.push_back(Foo());
V.push_back(Foo());
V.push_back(Foo()); 
```

下一个; 让我们调用模板化成员函数的不同实例：

```
V.at(0).f<int>(1);
V.at(0).f<char>(2);
V.at(1).f<float>(3.4f);
V.at(2).f<double>(5.6);
V.at(3).f<long>(7); 
```

最后，问题：

**¿ Foo 类的所有实例都来自同一个类？**似乎答案是肯定的，但是......第一个 Foo 实例最后有两个 f 成员函数的重载：

```
[0] Foo::f(int t);
[0] Foo::f(char t); 
```

另一方面，其他 Foo 实例似乎只有一个版本的 f 函数。显然，由于成员函数的差异，每个实例的基本类型是不同的。

```
[1] Foo::f(float t);
[2] Foo::f(double t);
[3] Foo::f(long t); 
```

**¿ f 函数在哪里被实例化？**显然我们只能从第一个 Foo 实例中获取 Foo::f(int t) 函数的地址，因为该函数只属于该实例；其他功能相同。

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-20T14:37:18.800

所有的重载都是编译器为`Foo::f`成员函数生成的，你可以认为它是手工写出来的。

**重载生成（模板实例化）不是基于实例的，而是基于类的**，类本身获取所有模板实例化（就像在类的主体中编写了所有不同类型的重载一样，对于给定的T型）

所以在你的情况下：

```
struct Foo 
{     
   template <typename T> void f(T t) {}; 
}; 
```

将成为（概念上）

```
struct Foo 
{     
   void f<int>(int t) {}; 
   void f<char>(char t) {}; 
   void f<float>(float t) {}; 
   ...
   /// all the other uses of f with different types, anywhere in your code.
}; 
```

这是人们反对模板的原因之一，它被称为“代码膨胀”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T14:39:29.377

> ¿ Foo 类的所有实例都来自同一个类？似乎答案是肯定的

是的，所有实例都属于同一类型。

> 但是...第一个 Foo 实例最后有两个 f 成员函数的重载

重载是每个类型，而不是每个实例。该类型将包含所有重载，无论模板函数在哪个对象上被实例化。

> ¿ f 函数在哪里被实例化？显然我们只能从第一个 Foo 实例中获取 Foo::f(int t) 函数的地址，因为该函数只属于该实例；其他功能相同。

它们由编译器实例化（编译成二进制代码），这*不是*一个合适的问题（除了二进制）。成员函数的地址只能从*类*中获取，而不能从任何实例中获取，正如我已经提到的，成员函数是按类型的，而不是按类型的实例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T14:38:25.977

所有`Foo`实例都具有所有重载，并且它们都是同一类型，因为`Foo`它们本身不是模板类。

函数在编译时在目标代码中实例化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T14:40:11.040

让我们看一个不同的例子：

```
struct Foo
{
    void f(int);
    void f(double);
};

// ...
Foo foo1, foo2;
foo1.f(3);
foo2.f(3.0); 
```

这与您自己的版本完全相似，只是编译器不会创建方法的新实例`f()`。我们只调用方法`f(int)`on `foo1`，而且我们只调用方法`f(double)`on `foo2`。您是否认为它们现在有不同的类型，只是因为我们没有在每个实例上调用所有方法？

方法与类相关联，而不是与实例相关联。您的代码生成的所有方法重载都是类的方法`Foo`，并且您的所有实例都具有相同的类型。

# java-me - 手机关机时的 PushRegistry.registerAlarm

> ID：11121911
> 
> 赞同：1
> 
> 时间：2012-06-20T14:33:44.667
> 
> 标签：java-me, midp

我正在开发一个 J2ME 应用程序，它应该每小时启动一次。

我正在使用该`PushRegistry.registerAlarm`方法，并且效果很好。即使我关闭手机，然后打开它仍然可以工作。

问题是：如果手机关机超过一小时，当手机开机时，闹钟的时间已经过去了。并且应用程序没有被通知要启动。

问题：
即使实际时间已经从预定时间过去了，有没有办法让我的 midlet 报警？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T15:05:05.367

每当处理手机关机、MIDlet 不运行时必须“记住”某些东西以及其他需要*持久性*的东西时，首先想到的是[MIDP rms](https://stackoverflow.com/tags/rms/info "在 SO tag wiki 上找到更多详细信息")，

> ...记录管理系统 API，一种持久存储机制，MIDlet 可以通过它持久存储数据并在以后检索数据。

对于您的情况，它看起来很简单：使用 RMS 来保持**下一个预期通知的时间**，例如

1.  在您的 MIDlet 发出的每个通知中，
    将下一个预期时间的当前值替换为下一个通知的值
2.  在`startApp`（或定期通过计时器任务/或通过某个后台线程，无论如何），
    检查 RMS 中的值并找出是否有错过（未删除）的预期事件

# asp.net - 如何像 WCF 一样实现 Asp.net MVC OneWay/FireAndForget 调用？

> ID：11121915
> 
> 赞同：8
> 
> 时间：2012-06-20T14:34:00.030
> 
> 标签：asp.net, asp.net-mvc, wcf, wcf-client

在 WCF 你有这样的东西

```
[ServiceContract]
public interface IDoAuditService
{
    [OperationContract(IsOneWay = true)]
    [WebInvoke]
    void Audit(AuditEntry auditEntry);
} 
```

因此，这将允许消费者发出请求并继续流程而无需等待响应。

我已经使用 AsyncController 尝试了 Asp.net MVC，但使用者仍会阻塞并等待控制器中调用回调。

我想要的是使用 Asp.Net MVC，但 WCF 的行为就像，我想发出请求并继续流程而不等待处理请求

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T14:44:40.483

在服务器上执行异步操作并立即返回给调用者怎么样。这并不完全是一场火灾，然后忘记，但它会效仿。

```
public ActionResult MyAction()
{
    var workingThread = new Thread(OperationToCallAsync);
    workingThread.Start();

    return View();
}

void OperationToCallAsync()
{
    ...
} 
```

# javascript - 构建一个简单的随机化器，其中包括一个点、一个下划线、字母 A 和字母 B

> ID：11121924
> 
> 赞同：0
> 
> 时间：2012-06-20T14:34:36.397
> 
> 标签：javascript, random

基本上，我想构建一个随机发生器，它可以产生具有以下可能组合的输出：

```
.
. .
. . .
_
_ _
_ _ _
. _
_ .
. . _
_ . .
. _ _
_ _ .
_ . _
. _ . 
```

最后，在开头随机添加字母 A 和 B。

例如：

```
A . _
B _ _
A . . _
A _ .
B . _ _
A .

etc. 
```

关于如何使用 JavaScript 完成此任务的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:40:24.613

```
var a = [
    ".",
    ". .",
    ". . .",
    "_",
    "_ _",
    "_ _ _",
    ". _",
    "_ .",
    ". . _",
    "_ . .",
    ". _ _",
    "_ _ .",
    "_ . _",
    ". _ ."
    ],

    b = ["A ", "B "];

    function getRandom() {
        return b[Math.random()*b.length|0] + a[Math.random()*a.length|0];
    }

    getRandom(); //"A ."
    getRandom(); //"A _ _ _"
    getRandom(); //"B . _ _" 
```

有一个循环：

```
var l = 20;
while(l--) console.log( getRandom() ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T14:42:28.153

这是另一种方式：http: [//jsfiddle.net/8AHaw/](http://jsfiddle.net/8AHaw/)

```
function makeid() {
    var text = "";
    var possibleChars = "._";
    var possibleLetters = "AB";

    text += possibleLetters.charAt(Math.floor(Math.random() * possibleLetters.length));
    for( var i=0; i < Math.floor(Math.random() * 3)+1; i++ )
        text += " " + possibleChars.charAt(Math.floor(Math.random() * possibleChars.length));

    return text;
}

for (var i=0; i < 20; i++)
    $("body").append("<div>" + makeid() + "</div>"); 
```

改编自[Generate random string/characters in JavaScript](https://stackoverflow.com/questions/1349404/generate-a-string-of-5-random-characters-in-javascript)

# asp.net-mvc - Asp.net MVC/Web Api Routing：需要路由有点不同

> ID：11121932
> 
> 赞同：6
> 
> 时间：2012-06-20T14:34:59.890
> 
> 标签：asp.net-mvc, asp.net-mvc-routing, asp.net-web-api, asp.net-routing

我已经使用路由设置了一个 asp.net web api 项目（它与 Mvc 项目完全相同） - 因此我有以下内容

```
routes.MapHttpRoute(
    name: "API Default",
    routeTemplate: "api/{controller}/{id}",
    defaults: new { id = RouteParameter.Optional }
); 
```

所以一切都按我想要的方式工作....我输入 api/Products/15 它到达我的产品控制器，传入 15 作为 id。

伟大的。

我还有 2 个控制器，1 个称为 UploadsController，1 个称为 DownloadsController。这些提供上传和下载（GET / PUT 等）

现在我不希望他们被原始规则所接受（见上文）

但我想要的是使用这 2 个 url 来访问它们

/api/Transport/Uploads/15 /api/Transport/Downloads/15

我已经通过了 15 作为 ID，在现实生活中可能不会发生......只是它有利于演示 :-)

现在运输不存在所以我可以做以下

```
routes.MapHttpRoute(
    name: "API Default",
    routeTemplate: "api/Transports/{controller}/{id}",
    defaults: new { id = RouteParameter.Optional }
); 
```

我相信这有效...

但问题是，如果我这样做

/api/Uploads/15 - 这也会被我不想要的原始规则捕获..

我希望通过假的“传输”而不是没有传输来访问 Uploads 和 Downloads 控制器

任何人都可以帮忙吗？

提前致谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-20T14:39:04.510

您可以使用[路由约束](http://www.asp.net/mvc/tutorials/controllers-and-routing/creating-a-route-constraint-cs)并按以下顺序定义 2 个 API 路由：

```
// matches /api/transports/downloads/id or /api/transports/uploads/id only
// and no other possible controller
routes.MapHttpRoute(
    name: "API Transport",
    routeTemplate: "api/transports/{controller}/{id}",
    defaults: new { id = RouteParameter.Optional },
    constraints: new { controller = "uploads|downloads" }
);

// matches anything in the form /api/{controller}/id where {controller}
// could be anythnig different than "downloads" or "uploads" because we don't
// want to allow the following urls: /api/downloads/id and /api/uploads/id
routes.MapHttpRoute(
    name: "API Default",
    routeTemplate: "api/{controller}/{id}",
    defaults: new { id = RouteParameter.Optional },
    constraints: new { controller = @"^((?!(downloads|uploads)).)*$" }
); 
```

# java - 可以使用netty将数据服务器到前端的主干吗？

> ID：11121933
> 
> 赞同：0
> 
> 时间：2012-06-20T14:35:00.310
> 
> 标签：java, backbone.js, real-time, netty

我知道 node.js 通常用于服务器作为backbone.js 的后端，但是 netty 也可以这样做吗？

我更喜欢 jvm，并希望有人可以提供一些有价值的代码，作为backend.js 的后端。

**而这样做的重点是能够拥有一个实时的Web应用程序，因此它会使用长轮询来保持与客户端的连接以更新UI（比如说有人通过移动设备更新了一些东西，浏览器应该对此作出反应）。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T19:28:32.373

Backbone 100% 与后端无关。

我们整个网站的前端都建立在 Backbone 之上，而后端则完全使用 Java。

个人项目使用 Python 和 Flask 来处理 API 层。

Backbone 最初是从一个 RoR 项目中挑选出来的......

# .net - DotNet Soundex 函数

> ID：11121936
> 
> 赞同：5
> 
> 时间：2012-06-20T14:35:21.750
> 
> 标签：.net, soundex

我有一个数据库表，其中有一列 SQLServer Soundex 编码的姓氏 + 名字。在我的 C# 程序中，我想使用 soundex 转换一个字符串以用于我的查询。

dotnet 库中是否有用于 soundex 的标准字符串函数，或者是实现它的开源库（可能作为字符串的扩展方法）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-09-24T02:46:55.920

我知道这已经晚了，但我也需要类似的东西（尽管不涉及数据库），唯一的答案是不准确的（'Tymczak' 和'Pfister' 失败）。

这就是我想出的：

```
class Program
{
    public static void Main(string[] args)
    {
                Assert.AreEqual(Soundex.Generate("H"), "H000");
                Assert.AreEqual(Soundex.Generate("Robert"), "R163");
                Assert.AreEqual(Soundex.Generate("Rupert"), "R163");
                Assert.AreEqual(Soundex.Generate("Rubin"), "R150");
                Assert.AreEqual(Soundex.Generate("Ashcraft"), "A261");
                Assert.AreEqual(Soundex.Generate("Ashcroft"), "A261");
                Assert.AreEqual(Soundex.Generate("Tymczak"), "T522");
                Assert.AreEqual(Soundex.Generate("Pfister"), "P236");
                Assert.AreEqual(Soundex.Generate("Gutierrez"), "G362");
                Assert.AreEqual(Soundex.Generate("Jackson"), "J250");
                Assert.AreEqual(Soundex.Generate("VanDeusen"), "V532");
                Assert.AreEqual(Soundex.Generate("Deusen"), "D250");
                Assert.AreEqual(Soundex.Generate("Sword"), "S630");
                Assert.AreEqual(Soundex.Generate("Sord"), "S630");
                Assert.AreEqual(Soundex.Generate("Log-out"), "L230");
                Assert.AreEqual(Soundex.Generate("Logout"), "L230");
                Assert.AreEqual(Soundex.Generate("123"), Soundex.Empty);
                Assert.AreEqual(Soundex.Generate(""), Soundex.Empty);
                Assert.AreEqual(Soundex.Generate(null), Soundex.Empty);
    }
}

public static class Soundex
{
    public const string Empty = "0000";

    private static readonly Regex Sanitiser = new Regex(@"[^A-Z]", RegexOptions.Compiled);
    private static readonly Regex CollapseRepeatedNumbers = new Regex(@"(\d)?\1*[WH]*\1*", RegexOptions.Compiled);
    private static readonly Regex RemoveVowelSounds = new Regex(@"[AEIOUY]", RegexOptions.Compiled);

    public static string Generate(string Phrase)
    {
        // Remove non-alphas
        Phrase = Sanitiser.Replace((Phrase ?? string.Empty).ToUpper(), string.Empty);

        // Nothing to soundex, return empty
        if (string.IsNullOrEmpty(Phrase))
            return Empty;

        // Convert consonants to numerical representation
        var Numified = Numify(Phrase);

        // Remove repeated numberics (characters of the same sound class), even if separated by H or W
        Numified = CollapseRepeatedNumbers.Replace(Numified, @"$1");

        if (Numified.Length > 0 && Numified[0] == Numify(Phrase[0]))
        {
            // Remove first numeric as first letter in same class as subsequent letters
            Numified = Numified.Substring(1);
        }

        // Remove vowels
        Numified = RemoveVowelSounds.Replace(Numified, string.Empty);

        // Concatenate, pad and trim to ensure X### format.
        return string.Format("{0}{1}", Phrase[0], Numified).PadRight(4, '0').Substring(0, 4);
    }

    private static string Numify(string Phrase)
    {
        return new string(Phrase.ToCharArray().Select(Numify).ToArray());
    }

    private static char Numify(char Character)
    {
        switch (Character)
        {
            case 'B': case 'F': case 'P': case 'V':
                return '1';
            case 'C': case 'G': case 'J': case 'K': case 'Q': case 'S': case 'X': case 'Z':
                return '2';
            case 'D': case 'T':
                return '3';
            case 'L':
                return '4';
            case 'M': case 'N':
                return '5';
            case 'R':
                return '6';
            default:
                return Character;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-06-13T09:59:01.853

根据[Dotnet Services](https://stackoverflow.com/users/6870473/dotnet-services)和[tigrou](https://stackoverflow.com/users/1083855/tigrou)的回答，我已经更正了算法，以反映[Wikipedia](https://en.wikipedia.org/wiki/Soundex)中描述的功能。

Ashcraft = A226、Tymczak = T522、Pfister = P236 和 Honeyman = H555 等测试用例现在可以正常工作。

```
public static string Soundex(string data)
{
    StringBuilder result = new StringBuilder();

    if (data != null && data.Length > 0)
    {
        string previousCode = "", currentCode = "", currentLetter = "";
        result.Append(data[0]); // keep initial char

        for (int i = 0; i < data.Length; i++) //start at 0 in order to correctly encode "Pf..."
        {
            currentLetter = data[i].ToString().ToLower();
            currentCode = "";

            if ("bfpv".Contains(currentLetter)) 
                currentCode = "1";
            else if ("cgjkqsxz".Contains(currentLetter))
                currentCode = "2";
            else if ("dt".Contains(currentLetter))
                currentCode = "3";
            else if (currentLetter == "l")
                currentCode = "4";
            else if ("mn".Contains(currentLetter))
                currentCode = "5";
            else if (currentLetter == "r")
                currentCode = "6";

            if (currentCode != previousCode && i > 0) // do not add first code to result string
                result.Append(currentCode);

            if (result.Length == 4) break;

            previousCode = currentCode; // always retain previous code, even empty
        }
    }
    if (result.Length < 4)
        result.Append(new String('0', 4 - result.Length));

    return result.ToString().ToUpper();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-17T20:13:31.190

根据[维基百科中描述的算法](http://en.wikipedia.org/wiki/Soundex)

```
 private string Soundex(string word)
    {
        word = word.ToUpper();
        word = word[0] + 
            Regex.Replace(
                Regex.Replace(
                Regex.Replace(
                Regex.Replace(
                Regex.Replace(
                Regex.Replace(
                Regex.Replace(word.Substring(1), "[AEIOUYHW]",""),
                "[BFPV]+", "1"),
                "[CGJKQSXZ]+", "2"),
                "[DT]+","3"),
                "[L]+","4"),
                "[MN]+","5"),
                "[R]+","6")
            ;
        return word.PadRight(4,'0').Substring(0,4);
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-06T13:29:58.700

您可以在每个 SQL 的 c# 中使用类似的东西

```
public static string Soundex(string data)
    {
        StringBuilder result = new StringBuilder();

        if (data != null && data.Length > 0)
        {
            string previousCode = "", currentCode = "", currentLetter = "";

            result.Append(data.Substring(0, 1));

            for (int i = 1; i < data.Length; i++) 
            {
                currentLetter = data.Substring(i, 1).ToLower();
                currentCode = "";

                if ("bfpv".IndexOf(currentLetter) > -1)
                    currentCode = "1";

                else if ("cgjkqsxz".IndexOf(currentLetter) > -1)
                    currentCode = "2";

                else if ("dt".IndexOf(currentLetter) > -1)
                    currentCode = "3";

                else if (currentLetter == "l")
                    currentCode = "4";

                else if ("mn".IndexOf(currentLetter) > -1)
                    currentCode = "5";

                else if (currentLetter == "r")
                    currentCode = "6";

                if (currentCode != previousCode)
                    result.Append(currentCode);

                if (result.Length == 4) break;

                if (currentCode != "")
                    previousCode = currentCode;

            }
        }
        if (result.Length < 4)
            result.Append(new String('0', 4 - result.Length));

        return result.ToString().ToUpper();
    } 
```

# winhttp - WinHttpCrackurl 是如何工作的

> ID：11121944
> 
> 赞同：0
> 
> 时间：2012-06-20T14:36:04.633
> 
> 标签：winhttp

WinHttpCrackurl 上的 MSDN 文档强调说它“同步”运行。但是，有人可以提供一些权威文档，说明 WinHttpCrackurl 尝试或不尝试网络连接吗？我搜索无果，并希望避免拆卸该功能。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T21:52:32.567

`WinHttpCrackUrl()` **不**以任何方式使用网络。没有文档说明这一点，但它所做的只是将输入字符串解析为其各个组件，仅此而已，因此不需要网络。

# facebook - 如何通过在 facebook 中使用相同的 Page Tab App 在不同的 facebook 页面上呈现不同的标签内容

> ID：11121950
> 
> 赞同：0
> 
> 时间：2012-06-20T14:36:26.443
> 
> 标签：facebook, facebook-apps

有什么方法可以通过使用相同的“页面标签应用程序”为不同的 Facebook 页面呈现不同的页面标签。

**就像是：**

```
For FB Page "Blah" the app should render the page from the url "http://www.mywebsite.com/Blah"

For FB Page "Blah-Blah" the app should render the page from the url "http://www.mywebsite.com/Blah-Blah"

For FB Page "Blah-Blah-Blah" the app should render the page from the url "http://www.mywebsite.com/Blah-Blah-Blah" 
```

**我可以通过使用相同的 facebook 应用程序来实现这一点吗？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T15:12:55.240

在 PHP 中，这非常简单。获取[signedRequest](https://developers.facebook.com/docs/reference/php/facebook-getSignedRequest/)（[这是数组的样子](https://developers.facebook.com/docs/authentication/signed_request/)）并找出应用程序的加载位置。不要忘记可以通过 ht*tp://apps.facebook.com/AppNameSpace 加载应用程序，因此不会有关键页面。（我必须在链接中添加*，因为我是新来的，所以我不能发布这个，因为它包含超过 2 个链接。）

```
if(isset($signedRequest['page']))
{
    switch($signedRequest['page'])
    {
        case 'pageID1':
            //code
        break;

        case 'pageID2':
            //code
        break;
        ...
    }

} 
```

# datepicker - Bootstrap datepicker with knockout.js 数据绑定

> ID：11121960
> 
> 赞同：23
> 
> 时间：2012-06-20T14:37:20.793
> 
> 标签：datepicker, knockout.js, twitter-bootstrap

这个问题类似于[带有 jquery-ui datepicker 的 knockoutjs 数据绑定](https://stackoverflow.com/questions/6399078)，但我想使用其中一个[Bootstrap](https://github.com/Aymkdn/Datepicker-for-Bootstrap) datepicker 而不是 jQueryUI datepicker 。

Bootstrap datepicker 的 API 与 jquery-ui 不同，我在想使它与 knockout.js 一起工作时遇到了一些麻烦。我创建[了一个 jsFiddle 来尝试一下](http://jsfiddle.net/bmh_ca/Qehaj/3/)。

似乎 Bootstrap 日期选择器可以更简单地使用，因为它不独立存储日期。但是，我想知道jsFiddle是否是使用带有knockout.js的Bootstrap datepicker小部件的合适方法，即

```
ko.bindingHandlers.datepicker = {
    init: function(element, valueAccessor, allBindingsAccessor) {
      //initialize datepicker with some optional options
      var options = allBindingsAccessor().datepickerOptions || {};
      $(element).datepicker(options);

      ko.utils.domNodeDisposal.addDisposeCallback(element, function() {
            $(element).datepicker("destroy");
        });
    },
    update: function(element, valueAccessor) {
    }
}; 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-06-20T15:17:04.257

以下是如何使用您正在使用的日期选择器完成此操作的示例：

```
ko.bindingHandlers.datepicker = {
    init: function(element, valueAccessor, allBindingsAccessor) {
      //initialize datepicker with some optional options
      var options = allBindingsAccessor().datepickerOptions || {};
      $(element).datepicker(options);

      //when a user changes the date, update the view model
      ko.utils.registerEventHandler(element, "changeDate", function(event) {
             var value = valueAccessor();
             if (ko.isObservable(value)) {
                 value(event.date);
             }                
      });
    },
    update: function(element, valueAccessor)   {
        var widget = $(element).data("datepicker");
         //when the view model is updated, update the widget
        if (widget) {
            widget.date = ko.utils.unwrapObservable(valueAccessor());
            if (widget.date) {
                widget.setValue();            
            }
        }
    }
}; 
```

看起来没有任何破坏功能，所以我删除了那块。`changeDate`当用户更改日期时，它会处理小部件事件以更新视图模型。该`update`函数在视图模型更改以更新小部件时进行处理。

如果要将值绑定到不可观察的值，则需要更多代码。让我知道这是否是您需要支持的东西。

[http://jsfiddle.net/rniemeyer/KLpq7/](http://jsfiddle.net/rniemeyer/KLpq7/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-08-11T11:36:18.210

我当前的版本是已经显示的解决方案之间的混合：

```
ko.bindingHandlers.datepicker = {
init: function (element, valueAccessor, allBindingsAccessor) {

    var unwrap = ko.utils.unwrapObservable;
    var dataSource = valueAccessor();
    var binding = allBindingsAccessor();

    //initialize datepicker with some optional options
    var options = allBindingsAccessor().datepickerOptions || {};
    $(element).datepicker(options);
    $(element).datepicker('update', dataSource());
    //when a user changes the date, update the view model
    ko.utils.registerEventHandler(element, "changeDate", function (event) {
        var value = valueAccessor();
        if (ko.isObservable(value)) {
            value(event.date);
        }
    });
},
update: function (element, valueAccessor) {
    var widget = $(element).data("datepicker");

    var value = ko.utils.unwrapObservable(valueAccessor());

    //when the view model is updated, update the widget
    if (widget) {
        widget.date = value;
        if (widget.date) {
            widget.setValue();
            $(element).datepicker('update', value)
        }
    }
}}; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-09-24T16:35:53.010

接受的答案不适用于当前版本的日期选择器。输入没有被可观察的值初始化。我做了一个更新的绑定，我添加了这个：

```
$(element).datepicker('update', dataSource()); 
```

这似乎可以解决问题。

这是一个使用最新可用日期选择器、Bootstrap、jQuery 和 Knockout 的更新小提琴：http: [//jsfiddle.net/krainey/nxhqerxg/](http://jsfiddle.net/krainey/nxhqerxg/)

**更新：**

当用户手动编辑文本字段中的值时，我遇到了一些困难，日期选择器不能很好地与 observable 配合使用。该工具将立即解析日期，并将结果插入输入字段。

例如，如果用户尝试编辑 10/07/2014，并使用退格键或 delete 删除数字 (10/0/2014)，则结果值将立即解析并插入到文本输入中。如果该值暂时是 2014 年 10 月 0 日，则选择器会将日历移动到 2014 年 9 月 30 日，并将该值插入文本字段。如果我尝试编辑月份，并且该值暂时为 2014 年 1 月 7 日，则选择器将切换到 2014 年 1 月 7 日，并将该值插入文本字段。

你可以在这个小提琴中看到这种行为：

[http://jsfiddle.net/krainey/nxhqerxg/10/](http://jsfiddle.net/krainey/nxhqerxg/10/)

我必须用一个特殊的处理程序更新我的绑定以检测焦点，并绑定一个一次性模糊事件以使其正确处理手动编辑。

```
$(element).on("changeDate", function (ev) {
    var observable = valueAccessor();
    if ($(element).is(':focus')) {
        // Don't update while the user is in the field...
        // Instead, handle focus loss
        $(element).one('blur', function(ev){
            var dateVal = $(element).datepicker("getDate");
            observable(dateVal);
        });
    }
    else {
        observable(ev.date);
    }
}); 
```

原始答案中引用的小提琴已更新以反映这一点：

[http://jsfiddle.net/krainey/nxhqerxg/](http://jsfiddle.net/krainey/nxhqerxg/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-06-16T09:58:38.017

这就是我的结局

```
ko.bindingHandlers.datepicker = {
init: function (element, valueAccessor, allBindingsAccessor) {
    //initialize datepicker with some optional options

    var options = {
        autoclose: true,
        format: 'yyyy-mm-dd',
    }

    //var options = allBindingsAccessor().datepickerOptions || {};
    $(element).datepicker(options);

    //when a user changes the date, update the view model
    ko.utils.registerEventHandler(element, "changeDate", function (event) {
        var value = valueAccessor();

        if (ko.isObservable(value)) {
            var myDate = event.date;
            var month = myDate.getMonth() + 1;
            var monthText = month;

            if (month < 10)
                monthText = "0" + month;

            var day1 = parseInt(myDate.getDate());
            var dayText = day1;

            if (day1 < 10)
                dayText = '0' + day1;

            value(myDate.getFullYear() + '-' + monthText + '-' + dayText);
        }
    });
},
update: function (element, valueAccessor) {

    var widget = $(element).data("datepicker");
    //when the view model is updated, update the widget
    if (widget) {
        widget.date = ko.utils.unwrapObservable(valueAccessor());
        widget.setValue(widget.date);
    }
}}; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-11-17T18:31:15.827

有一种更简单的方法可以让 bootstrap-datepicker.js 和 knockout.js 一起工作。`datepicker`通常在页面加载期间/之后调用输入的初始化。但是，当 knockout.js 更新值绑定时，`datepicker`新值不会正确更新，因此当您关注`datepicker`输入时，它默认为 2001 年 1 月 1 日。

您所要做的就是在`datepicker`根据以下方法更新任何 knockout.js 值绑定后销毁并重新初始化输入，该`ViewModel`方法设置要编辑的映射对象。

```
self.showEditOrderForm = function (data) {
    ko.mapping.fromJS(data, self.entity);
    self.mode('edit');
    $('#edit-dateordered').datepicker('destroy');
    $('#edit-dateordered').datepicker({
        format: 'dd-M-yyyy',
        title: 'Select Date',
        weekStart: 1,
        todayHighlight: true,
        autoClose: true,
        endDate: '0d'
    });
}; 
```

# node.js - drupal - node.js 集成

> ID：11121961
> 
> 赞同：0
> 
> 时间：2012-06-20T14:37:21.700
> 
> 标签：node.js, drupal

几天来，我们尝试将 drupal 与 node.js 集成。但我们无法连接到 socket.io.js ..

我们从 chrome 控制台收到此错误消息；

XMLHttpRequest 无法加载[http://mydomainname.com:8080/socket.io/1/?t=1340201859161](http://mydomainname.com:8080/socket.io/1/?t=1340201859161)。来源[http://mydomainname.com](http://mydomainname.com)Access-Control-Allow-Origin 不允许

我们的后端设置是；

```
/**
* This configuration file was built using the 'Node.js server configuration builder'.
* For a more fully commented example see the file nodejs.config.js.example in the root of this module
*/
backendSettings = {
  "scheme":"http",
  "host":"mydomainname",
  "port":8080,
  "key":"/path/to/key/file",
  "cert":"/path/to/cert/file",
  "resource":"/sites/all/modules/nodejs/node_modules/socket.io/lib",
  "publishUrl":"publish",
  "serviceKey":"",
  "backend":{
  "port":80,
  "host":"urb5.com",
  "messagePath":"realtime"},
  "clientsCanWriteToChannels":false,
  "clientsCanWriteToClients":false,
  "extensions":["nodejs.server.extension.js"],
  "debug":true,
  "transports":["websocket",
  "flashsocket",
  "htmlfile",
  "xhr-polling",
  "jsonp-polling"],
  "jsMinification":true,
  "jsEtag":true,
  "logLevel":1}; 
```

而且，在源代码中，我们有一个脚本 socket.io 脚本，比如

```
<script type="text/javascript" src="http://mydomainname.com:8080/sites/all/modules/nodejs/node_modules/socket.io/lib/socket.io.js"></script> 
```

这个脚本的内部版本号是 0.9.6，但是如果我们在 ftp 中按照这条路径，有一个 socket.io.js 但它的内部版本号是 0.9.5

有什么建议吗，谢谢。。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T17:48:45.877

这里的问题是您试图从服务器加载 socket.io，但您的前端文件位于另一个域空间/服务器中。
如果服务器未启用跨域 ajax 和资源请求，则存在不允许跨域 ajax 和资源请求的安全规定。
因此，在 socket.io.js 来自的服务器端，您应该在页眉中添加如下内容：

```
Access-Control-Allow-Origin: http://hello-world.example
Access-Control-Max-Age: 3628800
Access-Control-Allow-Methods: PUT, DELETE 
```

这将允许您与指定域共享资源内容。并且浏览器将不再抛出 Access-Control-Allow-Origin 错误。
还有，为什么要通过 8080 端口包含 js 文件？如果这是你绑定socket.io监听的端口，那么这是错误的，你需要通过通常的端口获取js文件（大多数情况下没有定义，或者80）。

# android - 如何在平方 SurfaceView（如 Instagram）中将相机预览大小设置为平方纵横比

> ID：11121963
> 
> 赞同：47
> 
> 时间：2012-06-20T14:37:29.610
> 
> 标签：android, camera, surfaceview

我正在尝试开发自己的相机活动，但我有一个我无法解决的问题......

我想要的是与 instagram 相框非常相似的东西，这就是我得到的：

![我的形象](../Images/5d9095122199dc71c17ca77e0bda263d.png)

当我应该得到这样的东西时：

![Instagram 图片](../Images/4f6909c94147545d92fa22dab68095bd.png)

和...

![我的第二张图](../Images/703bed1cd46b68e0e21aa12ede4f9c0e.png)

当我应该得到类似的东西时：

![Instagram 2](../Images/bed7bae2cd202a4d8471201866fe66c6.png)

我想我可以很好地管理 SurfaceView 和 Camera 预览，只使用

```
Camera.Parameters parameters = camera.getParameters();
camera.setDisplayOrientation(90); 
```

和自定义 SurfaceView：

```
public class SquaredSurfaceView extends SurfaceView {

private int width;
private int height;

public SquaredSurfaceView(Context context) {
    super(context);
}

public SquaredSurfaceView(Context context, AttributeSet attrs) {
    super(context, attrs);
}

public SquaredSurfaceView(Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);
}

@Override
protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
    super.onMeasure(widthMeasureSpec, heightMeasureSpec);
    width = MeasureSpec.getSize(widthMeasureSpec);
    height = width;
    setMeasuredDimension(width, width);
}

public int getViewWidth() {
    return width;
}

public int getViewHeight() {
    return height;
} 
```

}

我做错了什么？？:-(

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-03T09:09:51.027

如前所述，您需要找到正确的预览尺寸（宽高比为 1:1 的预览尺寸），并且您可能必须为 SurfacePreview 使用 FrameLayout。看起来你有纵横比问题，也许你有正确的预览尺寸，但你把它放在不正确的布局中。

另一种解决方案可能是（就像 Instagram 一样）将您的相机设置为全尺寸，然后隐藏布局的某些区域，使其看起来像一个正方形。然后通过软件，您必须剪切图像以使其成为真正的正方形。

希望这可以帮助你

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-05-31T01:15:04.103

对我有用的解决方案是第二个答案，但是因为我们需要将相机旋转 90º 才能将 WIDTH 与 HEIGTH 切换，所以像这样......

```
 camera.setDisplayOrientation(90);
   Camera.Parameters params= camera.getParameters();
   surfaceView.getLayoutParams().width=params.getPreviewSize().height;
   surfaceView.getLayoutParams().height=params.getPreviewSize().width; 
```

希望这个解决方案有帮助！！:D

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-08-16T19:05:39.283

我的解决方案更像是构建一个方形蒙版，然后将其放置在预览表面上。

您主要需要三样东西，首先是一个方形框架组件。我制作了一个自定义组件：

```
package com.example.squaredviewer;

import android.content.Context;
import android.util.AttributeSet;
import android.view.Display;
import android.view.WindowManager;
import android.widget.RelativeLayout;

/**
* Created by yadirhb on 14-08-2015.
*/
public class SquaredFrame extends RelativeLayout{
    public SquaredFrame(Context context, AttributeSet attrs) {
         super(context, attrs);
    }

    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        super.onMeasure(widthMeasureSpec, heightMeasureSpec);
        int size = Math.min(getMeasuredWidth(), getMeasuredHeight());
        setMeasuredDimension(size, size);
    }
} 
```

根据您正在开发的 Android API 版本，您可能需要添加另一个构造函数重载。对于 Kitkat 来说，这很好。

第二步是构建布局：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="horizontal"
android:visibility="visible">

<RelativeLayout
    android:id="@+id/camera_preview"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="false"
    android:layout_alignParentTop="false"
    android:layout_centerInParent="true"
    android:background="#ffffff">

</RelativeLayout>

<LinearLayout
    android:orientation="horizontal"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <LinearLayout
        android:orientation="vertical"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:background="#131008">

    </LinearLayout>

    <com.example.squaredviewer.SquaredFrame
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_centerInParent="true"></com.example.squaredviewer.SquaredFrame>

    <LinearLayout
        android:orientation="vertical"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:background="#131008" />
</LinearLayout>
</RelativeLayout> 
```

请注意，RelativeLayout“camera_preview”是用于渲染预览的，它居中并且有一个包含平方组件的 LinearLayout。这实际上是“蒙版”，它覆盖了相机预览。另请注意，除了透明的 SquaredFrame 之外，其他两个都是黑色的背景色。

现在是表面视图，用于根据纵横比调整表面大小的相机预览。

```
public class CameraPreview extends SurfaceView implements SurfaceHolder.Callback {

    private final String TAG = "PIC-FRAME";

    private SurfaceHolder mHolder;
    private Camera mCamera;
    private Display display;

    public CameraPreview(Activity context, Camera camera) {
        super(context);
        mCamera = camera;
        display = ((WindowManager) context.getSystemService(Context.WINDOW_SERVICE)).getDefaultDisplay();

        // Install a SurfaceHolder.Callback so we get notified when the
        // underlying surface is created and destroyed.
        mHolder = getHolder();
        mHolder.addCallback(this);
        // deprecated setting, but required on Android versions prior to 3.0
        mHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);

        setKeepScreenOn(true);
    }

    public void surfaceDestroyed(SurfaceHolder holder) {
        // empty. Take care of releasing the Camera preview in your activity.
        this.getHolder().removeCallback(this);
    }

    public void surfaceChanged(SurfaceHolder holder, int format, int w, int h) {
        // If your preview can change or rotate, take care of those events here.
        // Make sure to stop the preview before resizing or reformatting it.

        if (mHolder.getSurface() == null) {
            // preview surface does not exist
            return;
        }

        try {
            // stop preview before making changes
            mCamera.stopPreview();
            // set preview size and make any resize, rotate or
            // reformatting changes here
            // Now that the size is known, set up the camera parameters and begin
            // the preview.
            Camera.Parameters parameters = mCamera.getParameters();
            // You need to choose the most appropriate previewSize for your app
            Camera.Size previewSize = parametes.getSupportedPreviewSizes().get(0);
            parameters.setPreviewSize(previewSize.width, previewSize.height);

             // start preview with new settings
             mCamera.setParameters(parameters);

             // Set the holder size based on the aspect ratio
             int size = Math.min(display.getWidth(), display.getHeight());
             double ratio = (double) previewSize.width / previewSize.height;

             mHolder.setFixedSize((int)(size * ratio), size);
             mCamera.setPreviewDisplay(mHolder);
             mCamera.startPreview();

         } catch (Exception e) {
             Log.d(TAG, "Error starting camera preview: " + e.getMessage());
         }
      }
   }
} 
```

现在一切都必须绑定在活动类中

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_picture_taker);

    mDecorView = getWindow().getDecorView();

    //mCamera = a camera instance;

    // Create our Preview view and set it as the content of our activity.
    mPreview = new CameraPreview(this, mCamera);

    //Layout where camera preview is shown.
    RelativeLayout preview = (RelativeLayout) findViewById(R.id.camera_preview);
    //FrameLayout stack controllers inside and superpose them.
    preview.addView(mPreview, 0);

    // TODO
} 
```

有点长，但我希望它对不止一个人有帮助。:-)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-09-10T22:12:53.863

我在方形视图中遇到了同样的问题 - 只需将 SurfaceView 的相机大小设置为我想要绘制它的视图大小即可解决它。没有复杂的计算，它对我有用。有关整个方法，请在此处查看我的回复：[https ://stackoverflow.com/a/39430615/5181489](https://stackoverflow.com/a/39430615/5181489)

```
public void surfaceChanged(SurfaceHolder holder, int format, int width, int height) {
        ...
        params.setPreviewSize(viewParams.height, viewParams.width);
        camera.setParameters(params); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-05-09T18:29:10.280

您可以使用它来获取图片大小：

```
public static void initialCameraPictureSize(Context context, android.hardware.Camera.Parameters parameters) {

    List list = parameters.getSupportedPictureSizes();
    if(list != null) {
        android.hardware.Camera.Size size = null;
        Iterator iterator = list.iterator();
        do {
            if(!iterator.hasNext())
                break;
            android.hardware.Camera.Size size1 = (android.hardware.Camera.Size)iterator.next();
            if(Math.abs(3F * ((float)size1.width / 4F) - (float)size1.height) < 0.1F * (float)size1.width && (size == null || size1.height > size.height && size1.width < 3000))
                size = size1;
        } while(true);
        if(size != null)
            parameters.setPictureSize(size.width, size.height);
        else
            Log.e("CameraSettings", "No supported picture size found");
    }
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2015-12-03T09:24:05.423

它是如此艰苦。不容易。

第一件事：您定义 2 black`Linear Layout`以获取您发布的 UI。

第二件事：您需要将图片从完整图片剪切为方形图片。

如何切割，你需要使用`scaleBitmap`方法。

或者你想要真正的自定义相机？可以在[这里办理入住](https://github.com/mirrortowers/custom_camera_gallery_library/)

# events - jQuery - 检测按钮是否被按下

> ID：11121964
> 
> 赞同：0
> 
> 时间：2012-06-20T14:37:32.700
> 
> 标签：events, jquery

你不得不原谅我在这里问了一个微不足道的问题，但我通常很好奇是否有更好的方法来检测是否按下了按钮。我猜这也适用于锚标签。

目前我有两个提交按钮（所以我不能`$(form).submit`在这种情况下使用），当它们被激活时，它们都会改变另一个字段：

```
<button id="accept" type="submit">Accept</button>
<button id="decline" type="submit">Decline</button> 
```

为了实现这一点，我已经分别检测到了一个点击事件和 Enter keypress 事件：

```
$('#accept').click(function(){ $('#decision').val('Agree');  })
$("#accept").keyup(function(event){
    if(event.keyCode == 13){
        $('#decision').val('Agree');
    }
}); 
```

我想最重要的是我想知道是否有办法简化这段代码，因为它相当麻烦，特别是如果有很多处理（你可以创建一个函数，但那是另一个步骤）并且因为 jQuery 似乎有大多数事情都涵盖了，在搜索互联网后我很惊讶我找不到更清洁的解决方案。

*（上面我担心模仿按钮按下的其他方法，比如点击空格，虽然这似乎被覆盖了！）*

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:45:57.357

你可以做这样的事情来使点击更好一点：（在这里使用一个函数来获得更好的东西是必要的）：

```
function setDecision(value){
    $('#decision').val(value);
}

$('button[type=submit]').click(function() {
    var val = $(this).text();

    setDecision(val);
});

$("button[type=submit]").keyup(function(event){
    var val = $(this).text();

    if(event.keyCode == 13){
        setDecision(val);
    }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T14:54:55.137

对于按钮元素，在按钮上按下空格键和回车键[都会根据 W3C 事件规范生成点击事件](http://www.w3.org/TR/2012/WD-DOM-Level-3-Events-20120614/#event-flow-activation)。您不必进行任何特殊处理来处理它。

至于使用`$(form).submit()`，你可以。[只需通过将按钮更改为按钮 (W3C)](http://www.w3.org/TR/html401/interact/forms.html#adef-type-BUTTON)来更改按钮以不隐式提交表单：

```
<button type="button" id="...">...</button> 
```

然后在您的处理程序中，您可以执行以下操作：

```
$('#accept,#decline').click(function(event){
    $('#decision').val($(event.target).text());
    $(form).submit();
} 
```

如果需要，您可以在必要时进行一些处理`$(event.target).text()`以使“拒绝”为空/空字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T14:45:43.883

我想我理解你的问题，在这个相关主题中可能会有一些优先级。

[jQuery：如何获取表单提交时点击了哪个按钮？](https://stackoverflow.com/questions/5721724/jquery-how-to-get-which-button-was-clicked-upon-form-submission)

此方法避免向每个按钮添加 .click() 事件，尽管这对于您的应用程序来说可能是一个可行的选项。

希望这可以帮助！石匠

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-20T14:49:31.953

添加`name="decision"`和`value="Accept"`/ `value="Decline"`（相应地）到提交按钮

这样你根本不需要javascript来处理这个......

如果“接受”按钮是第一个，那么在任何表单字段中按 Enter 也会触发该按钮

样本：

```
<form action="1.html" method="get">

<input type="text" name="in">

<button type="submit" name="decision" value="Accept">Accept</button>
<button type="submit" name="decision" value="Decline">Decline</button>

</form> 
```

# ruby-on-rails - Rails：你如何使用搜索查询来查找 belongs_to 项目呢？

> ID：11121969
> 
> 赞同：0
> 
> 时间：2012-06-20T14:37:43.990
> 
> 标签：ruby-on-rails, search, belongs-to

我需要的是在一次搜索中搜索故事标题以及故事属于谁。

显然这是不对的，但它让我明白了：

```
@stories = Story.where("user.display_name LIKE ? And title LIKE ?", 
             "%#{@query}%", "%#{@query}%").limit(500).page(params[:page]) 
```

故事属于用户，用户有很多故事。不知道我还需要在这里放什么，而且我还没有真正理解任何似乎相关的答案。

谢谢。

更新

```
<% if @stories.size == 0 %>
    Sorry, there were no stories found.
<% else %>
    <table class="sortableTable table-striped" style="width: 100%; text-align: left;">
      <thead>
        <tr>
         <th width="55%">Title</th>
         <th width="25%">User</th>
         <th width="10%">Created At</th>
         <th width="10%">Updated At</th>
        </tr>
      </thead>
      <tbody>
        <% @stories.each do |s| %>
        <tr>
         <td width="55%"><div class="span5 search_result"><%= link_to s.title, s %></div></td>
         <td width="25%"><div class="span3 search_result"><%= link_to s.user.display_name, s.user %></div></td>
         <td width="10%"><div class="span3 search_result"><%= time_ago_in_words(s.created_at) %> ago</div></td>
         <td width="10%"><div class="span3 search_result"><%= time_ago_in_words(s.updated_at) %> ago</div></td>
        </tr>
        <% end %>

      </tbody>
    </table>
<% end %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T16:38:02.880

如果您不想急切加载与故事关联的用户对象：

```
Story.joins(:user).where(
   "users.display_name LIKE :term And stories.title LIKE :term", 
   :term =>  "%#{@query}%"
).limit(500).page(params[:page]) 
```

如果您想预先加载与故事关联的用户对象：

```
Story.includes(:user).where(
   "users.display_name LIKE :term And stories.title LIKE :term", 
   :term =>  "%#{@query}%"
).limit(500).page(params[:page]) 
```

**笔记：**

我在 where 子句中使用占位符条件，因为在两个地方使用了相同的查询词。

# java - 复制缓存的地图 对象放入临时地图 目的

> ID：11121975
> 
> 赞同：3
> 
> 时间：2012-06-20T14:38:17.303
> 
> 标签：java, map, ehcache

我正在`Map<String , List>`从 ehcache 中获取一个对象。我不想更新该`Map`对象，而是想将缓存的内容复制`Map`到临时的`Map`. 如何创建 a 的副本，`Map`以便更改 main 中的值`Map`不会同时更改副本中的值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T14:47:52.457

这真的取决于你想做什么。如果你只需要一个浅拷贝，保罗的回答就足够了，或者执行以下操作

```
Map<String, Object> fromEhcache = ...
Map<String, Object> copy = new HashMap<String, Object>(fromEhcache); 
```

但是，如果您需要深度复制，即您还需要复制地图中的所有对象，则必须遍历整个地图，并单独复制每个对象。另外，地图中的对象必须支持某种复制构造函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T14:41:26.193

您可以创建一个新`Map`实例，然后调用[`putAll(Map)`](http://docs.oracle.com/javase/7/docs/api/java/util/Map.html#putAll%28java.util.Map%29)，传入原始的`Map`. 这会将所有键值映射复制到新实例中。

如果您使用的是 Guava，您也可以调用[`Maps.newHashMap(Map)`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Maps.html#newHashMap%28java.util.Map%29)etc. 以在一行中实现相同的效果。

# reserved-words - Mogenerator 和 setPrimitiveType

> ID：11121981
> 
> 赞同：2
> 
> 时间：2012-06-20T14:38:51.933
> 
> 标签：reserved-words, mogenerator

我有大约六张来自旧版 Web 服务器的表。这些表都有一个“类型”列。我需要在应用程序级别保持这些列名同步。

使用 mogenerator，它创建的基类尽职尽责地生成**setPrimitiveType**属性。好吧，Apple 不喜欢这种方法并拒绝了我们的应用程序。

是否可以将 mogenerator 更改为不创建模型属性的某些方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-28T18:15:53.463

是的，可以微调 mogenerator 创建的内容。这是通过更新机器文件模板中的条目来完成的。例如，可以从 machine.h 模板文件中注释掉以下行。

```
- (void)setPrimitive<$Attribute.name.initialCapitalString$>:(<$Attribute.objectAttributeType$>)value; 
```

```
- (void)setPrimitive<$Attribute.name.initialCapitalString$>Value:(<$Attribute.scalarAttributeType$>)value_; 
```

前者是常规访问者。后者是标量访问器，如果需要，它甚至可以重命名。

[但是，请注意 Core Data 框架而不是 mogenerator 正在生成 Apple Docs Core Data Programming Guide](https://developer.apple.com/library/mac/#documentation/cocoa/Conceptual/CoreData/Articles/cdAccessorMethods.html)指出的基本访问器：

> 例如，给定一个具有 firstName 属性的实体，Core Data 会自动生成 firstName、setFirstName:、primitiveFirstName 和 setPrimitiveFirstName:。Core Data 甚至对由 NSManagedObject 表示的实体也是如此。要在调用这些方法时抑制编译器警告，您应该使用 Objective-C 2.0 声明的属性功能，如“声明”中所述。</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-04T14:37:05.647

我对“类型”关键字有同样的问题。我的解决方案是手动创建和实施方法，例如

```
- (NSNumber *)primitiveType;
- (void)setPrimitiveType:(NSNumber *)value_; 
```

# git - GIT 或 Subversion - 如何忽略部分代码

> ID：11121984
> 
> 赞同：2
> 
> 时间：2012-06-20T14:39:00.747
> 
> 标签：git, svn

我正在检查根据特定需求在版本控制应用程序之间进行选择：

源文件由导出脚本文件的 4GL 图形客户端生成。问题是某些代码部分需要被忽略。这是一个脚本的代码示例：

```
BEGIN DSRECORD
   Identifier "V0"
   DateModified "1899-12-30"
   TimeModified "00.00.01"
   (...)
   StageXSize "730|48|46|48|48|48|48|48|48|48|48|48|48|48"
   StageYSize "132|48|48|48|48|48|48|48|48|48|48|48|48|48"
   ContainerViewSizing "0083 0345 0569 0735 0000 0001 0183 0680"
END DSRECORD 
```

在该代码中，应该忽略 StageXSize 和 StageYSize 行，因为每次开发人员移动框（称为 Stage）时，这些值都会改变，但我不想将其视为代码的更改。

所以我在 GIT 或 Subversion 中的问题，是否有办法指定在比较脚本的 2 个版本时忽略部分代码？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:44:39.203

我听说过的所有版本控制应用程序都只允许忽略每个文件，但不能忽略文件中的特定行。

在任何 VCS 中，您通常通过签入具有默认值的“模板文件”来处理配置文件（=需要以某种形式存在于存储库中的文件，但任何开发人员都应该可以对其进行编辑而不提交更改），然后让开发人员在其副本中进行更改，VCS 会忽略该副本。

这是一个如何执行此操作的示例：
[如何使用 tortoise hg “作为存储库的一部分”忽略 kiln/mercurial 中的文件](https://stackoverflow.com/questions/7351076/how-to-ignore-files-in-kiln-mercurial-using-tortoise-hg-that-are-part-of-the-re/7351306#7351306)

如果可能的话，您应该尝试将整个脚本文件视为“配置文件”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T14:43:40.140

我不这么认为。

我认为“正确”的解决方案是将其拆分为两个文件，并让构建过程的某些部分将它们粘合到运行时所需的单个文件中（大概）。

这样，每个开发人员都可以更改仅包含`StageXSize`and`StageYSize`行的较小文件，而根本不提交它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T14:57:19.553

只需回答“否”。对于 SVN 和 Git，都不能忽略文件的某些部分。您可以忽略文件。

在 SVN 中通过 svn:ignore 属性在 Git 中通过 .gitignore 文件获取目录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T19:56:08.510

听起来 StageXSize 和 StageYSize 的值是不应该硬编码的配置选项。他们应该进入一个配置文件，比如 stage.config 或 some-app.conf

# javascript - 防火墙和代理后的 Ajax 调用

> ID：11121986
> 
> 赞同：1
> 
> 时间：2012-06-20T14:39:05.433
> 
> 标签：javascript, ajax, asp.net-mvc-3, jquery, asp.net-ajax

我正在使用 .NET MVC3 和 Ajax (JQuery) 开发应用程序。

当客户端使用直接互联网连接时，我的应用程序运行良好。但是有一些客户端在代理和防火墙后面工作。

该应用程序在开始时运行良好，但经过一些更改后，ajax 调用不时返回 null。

我不知道这个问题。是ajax调用失败还是防火墙阻止了一些ajax调用？

谢谢，

# ios - 显示 imageView 的 y 值

> ID：11121999
> 
> 赞同：0
> 
> 时间：2012-06-20T14:39:30.750
> 
> 标签：ios, uiimageview, location

```
NSString *yValue;

yValue= [[NSString alloc] initWithFormat:@"%1.2f", imageView.center.y];
[label setText:yValue]; 
```

我试图在图像视图在屏幕上移动时显示它的 y 值。当我使用此代码时，标签根本不会出现。我不确定我做错了什么，感谢您的帮助。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T14:44:24.710

您需要从图像的框架中获取 y 值，然后将其转换为字符串，然后设置标签的文本。

尝试：

```
CGRect imageFrame = imageView.frame;
NSString *yValue = [NSString stringWithFormat:@"%d", imageFrame.size.y];

[label setText: yValue]; 
```

** 我还没有测试过这段代码，但它应该很接近 **