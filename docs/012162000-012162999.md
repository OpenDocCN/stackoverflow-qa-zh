# StackOverflow 问答 12162000-12162999

# xslt - 将属性即时插入“a”标签

> ID：12162001
> 
> 赞同：1
> 
> 时间：2012-08-28T14:53:57.137
> 
> 标签：xslt, diazo

我需要即时修改特定 div (#navigation) 中存在的所有“a”标签的“内容”。

是否有重氮规则或 xslt 模式？

谢谢维托

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:38:36.183

不明白你的意思。如果您想创建一个 XSLT 复制所有内容但只调整 div id='navigation' 内的“a”元素，您应该执行以下操作：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="html" />

<xsl:template match="@*|node()" priority="-1">
    <xsl:copy>
      <xsl:apply-templates select="@*|node()"/>
    </xsl:copy>
  </xsl:template>

<xsl:template match="//div[@id='navigation']//a">
   <a>
       <xsl:attribute name='href'>
           <xsl:value-of select='@href' />
       </xsl:attribute>
       <!-- Change your content here -->
   </a>
</xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T04:27:26.117

下面演示为每个标签添加一个属性（在这种情况下`target`），这些`a`标签是具有 id 的元素下的子元素`navigation`（因此对应`#navigation`于 CSS 中）。保留原始标签中的所有内容和其他属性（尽管顺序可能不是 - 尽管这不应该成为问题）。

```
<?xml version="1.0" encoding="UTF-8"?>
<rules xmlns="http://namespaces.plone.org/diazo"
       xmlns:css="http://namespaces.plone.org/diazo/css"
       xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <after css:theme="#target" css:content="#navigation" />

    <xsl:template match="*[@id='navigation']//a">
        <xsl:copy>
            <xsl:attribute name="target">_blank</xsl:attribute>
            <xsl:copy-of select="@*" />
            <xsl:apply-templates />
        </xsl:copy>
    </xsl:template>
</rules> 
```

`match`如果要匹配特定`a`标签，请使用附加条件相应地调整条件。将在所有标准重氮规则之后执行，因此如果您碰巧更改了结果文档中标签位置的结构，`xsl:template`请确保相应地调整条件。`match``a`

这是在[http://docs.diazo.org/en/latest/recipes/adding-an-attribute/index.html官方 Diazo 文档中扩展的示例](http://docs.diazo.org/en/latest/recipes/adding-an-attribute/index.html)

# java - 更多 URL 选项 HttpServletRequest

> ID：12162005
> 
> 赞同：0
> 
> 时间：2012-08-28T14:54:06.197
> 
> 标签：java, google-app-engine, http, servlets, httprequest

我将参数传递给服务器行

```
"login=testAva4&nick=testAvaNick&social=vk&saurl=http://domain.example?param1=1&param2=2&param3=3&maurl=1" 
```

等待值 saurl="http://domain.example?param1=1¶m2=2¶m3=3"

但我得到[http://domain.example?param1=1](http://domain.example?param1=1)和 param2=2 param3=3

从 Eclipse 调试

```
req->_parameters

{maurl=1, nick=testAvaNick, param2=2, saurl=http://domain.example?param1=1, param3=3, social=vk, login=testAva4} 
```

获取代码中的参数如下：

```
public class AddProfileServlet extends PlacerServlet {

    //Add new profile method
    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp)
            throws ServletException, IOException {

        //Receive variables from URL
        String login = req.getParameter("login");
        String nick = req.getParameter("nick");
        String social = req.getParameter("social");
        String saurl = req.getParameter("saurl"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:01:45.900

您应该在 saurl 参数上使用 URLEncoding。
在公共编解码器中查看 URLCodec 在[此处输入链接描述](http://commons.apache.org/codec/userguide.html)项目。
我认为您不需要对整个参数部分进行编码，而只需对这个特定参数的值进行编码。您可以使用以下方法对字符串进行编码：

```
URLCodec codec = new URLCodec();
String encodedValue = codec.encode(valueToEncode); 
```

您应该使用 encodedValue 作为传递给 saurl 参数的值。

# android - 安卓上的 PyAudio

> ID：12162008
> 
> 赞同：2
> 
> 时间：2012-08-28T14:54:06.977
> 
> 标签：android, python, c, apk, pyaudio

有没有人在 SL4A 旁边的 Android 上安装这样的库，或者甚至将它打包到 APK 中？

由于 PyAudio 使用 CI，我不完全确定这将如何完成，如果它可以完成的话。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T02:37:44.453

PyAudio 包装在[PortAudio](http://portaudio.com/)库上。所以在 PortAudio 自己封装了 Android 的底层音频系统之前，PyAudio 是没有机会在 Android 上工作的。与此同时，在 PortAudio 上提交了一张支持 Android的[票，您可以跟踪该票。](https://www.assembla.com/spaces/portaudio/tickets/154)

# bash - POSIX sh 等效于 Bash 的 printf %q

> ID：12162010
> 
> 赞同：23
> 
> 时间：2012-08-28T14:54:09.117
> 
> 标签：bash, posix, printf, quotes, sh

假设我有一个`#!/bin/sh`脚本，它可以采用各种位置参数，其中一些可能包括空格、两种/两种引号等。我想迭代`"$@"`并为每个参数立即以某种方式处理它，或者将其保存以备后用。在脚本结束时，我想启动（也许`exec`）另一个进程，传入其中一些参数，并且所有特殊字符都完好无损。

如果我不对参数进行任何处理，`othercmd "$@"`可以正常工作，但我需要提取一些参数并稍微处理一下。

如果我可以假设 Bash，那么我可以`printf %q`用来计算 args 的引用版本，我`eval`以后可以使用，但这不适用于例如 Ubuntu 的 Dash ( `/bin/sh`)。

是否有任何等价物`printf %q`可以用普通的 Bourne shell 脚本编写，只使用内置和 POSIX 定义的实用程序，比如我可以复制到脚本中的函数？

例如，一个脚本试图以`ls`相反的顺序对其参数：

```
#!/bin/sh
args=
for arg in "$@"
do
    args="'$arg' $args"
done
eval "ls $args" 
```

适用于许多情况：

```
$ ./handle goodbye "cruel world"
ls: cannot access cruel world: No such file or directory
ls: cannot access goodbye: No such file or directory 
```

但不是何时`'`使用：

```
$ ./handle goodbye "cruel'st world"
./handle: 1: eval: Syntax error: Unterminated quoted string 
```

以下工作正常，但依赖于 Bash：

```
#!/bin/bash
args=
for arg in "$@"
do
    printf -v argq '%q' "$arg"
    args="$argq $args"
done
eval "ls $args" 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-04-23T13:08:33.327

这是绝对可行的。

您看到的 Jesse Glick 的答案大致就在那里，但它有几个错误，我还有更多的选择供您考虑，因为这是我不止一次遇到的问题。

首先，您可能已经知道，echo 是一个坏主意，如果目标是可移植性，则应该使用 printf：如果它接收的参数是“-n”，则“echo”在 POSIX 中具有未定义的行为，并且实际上有些echo 的实现将 -n 视为特殊选项，而其他实现仅将其视为打印的普通参数。所以就变成了这样：

```
esceval()
{
    printf %s "$1" | sed "s/'/'\"'\"'/g"
} 
```

或者，不要通过将嵌入的单引号转义为：

```
'"'"' 
```

..相反，您可以将它们变成：

```
'\'' 
```

..我猜的风格差异（我认为无论哪种方式性能差异都可以忽略不计，尽管我从未测试过）。生成的 sed 字符串如下所示：

```
esceval()
{
    printf %s "$1" | sed "s/'/'\\\\''/g"
} 
```

（这是四个反斜杠，因为双引号会吞掉其中两个，留下两个，然后 sed 吞下一个，只留下一个。就我个人而言，我发现这种方式更具可读性，因此我将在其余涉及的示例中使用它它，但两者应该是等价的。）

但是，我们仍然有一个错误：命令替换将从命令输出中删除至少一个（但在许多 shell 中全部）尾随换行符（不是所有空格，只是换行符）。因此，除非您在参数的最后有换行符，否则上述解决方案有效。然后你会失去那个/那些换行符。修复显然很简单：在实际命令值之后添加另一个字符，然后再从引用/esceval 函数输出。顺便说一句，我们已经需要这样做了，因为我们需要用单引号开始和停止转义参数。您有两种选择：

```
esceval()
{
    printf '%s\n' "$1" | sed "s/'/'\\\\''/g; 1 s/^/'/; $ s/$/'/"
} 
```

这将确保参数已经完全转义，在构建最终字符串时无需添加更多单引号。这可能是您将获得的最接近单个可内联版本的东西。如果你对 sed 依赖没问题，你可以在这里停下来。

如果您对 sed 依赖项不满意，但可以假设您的 shell 实际上是 POSIX 兼容的（仍然有一些，特别是 Solaris 10 及更低版本上的 /bin/sh，它不会能够执行下一个变体 - 但您需要关心的几乎所有外壳都可以做到这一点）：

```
esceval()
{
    printf \'
    unescaped=$1
    while :
    do
        case $unescaped in
        *\'*)
            printf %s "${unescaped%%\'*}""'\''"
            unescaped=${unescaped#*\'}
            ;;
        *)
            printf %s "$unescaped"
            break
        esac
    done
    printf \'
} 
```

您可能会注意到这里看似多余的引用：

```
printf %s "${unescaped%%\'*}""'\''" 
```

..这可以替换为：

```
printf %s "${unescaped%%\'*}'\''" 
```

我做前者的唯一原因是，曾几何时，Bourne shell 在将变量替换为带引号的字符串时存在错误，其中变量周围的引号并没有完全从变量替换的开始和结束位置开始。因此，这是我偏执的便携习惯。在实践中，你可以做后者，这不会有问题。

如果您不想`unescaped`在 shell 环境的其余部分中破坏变量，则可以将该函数的全部内容包装在子 shell 中，如下所示：

```
esceval()
{
  (
    printf \'
    unescaped=$1
    while :
    do
        case $unescaped in
        *\'*)
            printf %s "${unescaped%%\'*}""'\''"
            unescaped=${unescaped#*\'}
            ;;
        *)
            printf %s "$unescaped"
            break
        esac
    done
    printf \'
  )
} 
```

“但是等等”，你说：“我想在一个命令中对 MULTIPLE 参数执行什么操作？如果我出于某种原因从命令行运行它，我希望作为用户的输出仍然看起来不错且清晰易读。”

永远不要害怕，我为您提供保障：

```
esceval()
{
    case $# in 0) return 0; esac
    while :
    do
        printf "'"
        printf %s "$1" | sed "s/'/'\\\\''/g"
        shift
        case $# in 0) break; esac
        printf "' "
    done
    printf "'\n"
} 
```

..或同样的事情，但只有外壳版本：

```
esceval()
{
  case $# in 0) return 0; esac
  (
    while :
    do
        printf "'"
        unescaped=$1
        while :
        do
            case $unescaped in
            *\'*)
                printf %s "${unescaped%%\'*}""'\''"
                unescaped=${unescaped#*\'}
                ;;
            *)
                printf %s "$unescaped"
                break
            esac
        done
        shift
        case $# in 0) break; esac
        printf "' "
    done
    printf "'\n"
  )
} 
```

在最后四个中，您可以折叠一些外部 printf 语句并将它们的单引号向上滚动到另一个 printf - 我将它们分开，因为我觉得当您可以看到单独的开始和结束单引号时它使逻辑更加清晰打印报表。

PS 还有我制作的这个怪物，它是一个 polyfill，它将在前两个版本之间进行选择，具体取决于你的 shell 是否能够支持必要的变量替换语法（虽然看起来很糟糕，因为只有 shell 的版本必须放在一个 eval-ed 字符串中，以防止不兼容的 shell 在看到它时吐出）：[https ://github.com/mentalisttraceur/esceval/blob/master/sh/esceval.sh](https://github.com/mentalisttraceur/esceval/blob/master/sh/esceval.sh)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T15:28:55.137

我认为这是POSIX。`$@`它的工作原理是在为 for 循环扩展它之后清除，但只有一次，这样我们就可以使用`set`.

```
flag=0
for i in "$@"; do
    [ "$flag" -eq 0 ] && shift $#
    set -- "$i" "$@"
    flag=1
done

echo "$@"   # To see that "$@" has indeed been reversed
ls "$@" 
```

我意识到颠倒参数只是一个例子，但你可以在其他情况下`set -- "$arg" "$@"`使用这个技巧。`set -- "$@" "$arg"`

是的，我意识到我可能刚刚重新实现了（很差）ormaaj 的 Push。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T15:35:14.930

以下似乎适用于我到目前为止所抛出的所有内容，包括空格、两种引号和各种其他元字符以及嵌入的换行符：

```
#!/bin/sh
quote() {
    echo "$1" | sed "s/'/'\"'\"'/g"
}
args=
for arg in "$@"
do
    argq="'"`quote "$arg"`"'"
    args="$argq $args"
done
eval "ls $args" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-28T15:08:38.033

[推](https://github.com/vaeth/push)。有关示例，请参阅自述文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-19T00:36:44.607

如果您可以调用外部可执行文件（如`sed`其他答案中给出的解决方案），那么您也可以调用`/usr/bin/printf`. 虽然内置的 POSIX shell`printf`确实不支持`%q`，但`printf`Coreutils 的二进制文件确实支持（[从 8.25 版开始](https://github.com/coreutils/coreutils/commit/5ef08864113505c6392158c9fac9a6cb1b3ac0e6)）。

```
esceval() {
    /usr/bin/printf '%q ' "$@"
} 
```

# jquery - Rails 应用程序创建对象并使用 jquery 进行部分渲染

> ID：12162011
> 
> 赞同：0
> 
> 时间：2012-08-28T14:54:11.273
> 
> 标签：jquery, ruby-on-rails, ajax

我的应用程序中有一个页面，我在其中使用 button_to 或 button_to_function，用户可以在其中向表中添加一行。表格的每一行都是来自 Event 模型的数据对象。

当用户单击“添加事件”按钮时，它应该创建一个新的事件对象并在表中呈现一行，该行是与事件对象中的字段相对应的几个下拉列表。然后，我将使用 best_in_place 进行就地编辑来修改这些字段。

使用 jquery 创建一个新的 Event 对象并将一行附加到具有与新创建的事件对象对应的表单字段的表上的最佳方法是什么？我正在考虑调用创建对象并呈现部分的控制器操作，但不确定如何具体执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T14:59:01.453

看看 Railscast #136 - [http://railscasts.com/episodes/136-jquery](http://railscasts.com/episodes/136-jquery)

它应该让你朝着正确的方向前进。本质上，您的控制器需要响应 Javascript，然后有一个 js 模板，当浏览器接收到该模板时，该模板将在页面上执行您想要的操作。

# javascript - Richfaces & Ajax - Cufon 字体替换？

> ID：12162012
> 
> 赞同：1
> 
> 时间：2012-08-28T14:54:11.867
> 
> 标签：javascript, ajax, jsf, richfaces, cufon

我利用 Cufon 在我的应用程序中进行字体替换。我有几个地方使用 Richfaces 4.2 (JSF2) 进行 Ajax 调用，但请注意，刷新页面时不会应用 Cufon 替换。确保调用后显示的 HTML 正确应用了 Cufon 字体替换的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T16:06:22.970

每次使用 cufon 文本刷新内容时，请使用 Cufon.refresh() 函数，此处的详细信息：[https ://github.com/sorccu/cufon/wiki/API](https://github.com/sorccu/cufon/wiki/API)

# c# - 带有虚线样式和大量数据点的 MSChart 折线图

> ID：12162013
> 
> 赞同：4
> 
> 时间：2012-08-28T14:54:22.550
> 
> 标签：c#, mschart, linestyle

我正在尝试使用 C# 中的 MSChart 以虚线样式呈现折线图。我设置样式没有问题，但我有大量数据。这会导致虚线渲染出错，因为它似乎在绘制每个线段时重新启动了“破折号”序列。因此，我得到一条看起来与实线相同的线。如果我放大以使我的数据点密度降低，则虚线样式变得可见。

这对我没有好处，因为我真的需要它来保持任何缩放级别的冲刺。有没有人知道这怎么可能？对我来说它搞砸了这样的渲染似乎很奇怪......

有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T12:08:20.567

好吧，这比我预期的要麻烦得多。问题的出现是因为 MSChart 在每 2 个点之间绘制线作为单独的 DrawLine 调用。如果整个东西都是用一个 DrawLines 调用绘制的，那么问题就不会存在。

因此，我想出了一种处理绘制它的方法。

首先在 PrePaint 中存储所有“BorderWidth”，然后将它们设置为 0。这意味着 MSChart 不会绘制我的线条。

最后在 PostPaint 中，我使用我想要的破折号样式绘制线条。这给出了完美的渲染。

我确信在某些极端情况下我的代码将无法正常工作，但这应该让您对如何做到这一点有一个很好的了解：

```
 private List< int > mBorderWidths   = null;
    private void LineChartPrePaint( object sender, System.Windows.Forms.DataVisualization.Charting.ChartPaintEventArgs e )
    {
        if ( e.ChartElement.GetType() == typeof( System.Windows.Forms.DataVisualization.Charting.ChartArea ) )
        {
            System.Windows.Forms.DataVisualization.Charting.Chart           c   = (System.Windows.Forms.DataVisualization.Charting.Chart)e.Chart;
            System.Windows.Forms.DataVisualization.Charting.ChartArea       ca  = (System.Windows.Forms.DataVisualization.Charting.ChartArea)e.ChartElement;

            mBorderWidths   = new List<int>();
            foreach( System.Windows.Forms.DataVisualization.Charting.Series s in c.Series )
            {
                mBorderWidths.Add( s.BorderWidth );
                s.BorderWidth   = 0;
                s.ShadowOffset  = 0;
            }

            RectangleF rectF    = ca.Position.ToRectangleF();
            rectF               = e.ChartGraphics.GetAbsoluteRectangle( rectF );

            e.ChartGraphics.Graphics.FillRectangle( new SolidBrush( ca.BackColor ), rectF );
        }
        if ( e.ChartElement.GetType() == typeof( System.Windows.Forms.DataVisualization.Charting.Chart ) )
        {
            RectangleF rectF    = e.Position.ToRectangleF();
            rectF               = e.ChartGraphics.GetAbsoluteRectangle( rectF );

            e.ChartGraphics.Graphics.FillRectangle( new SolidBrush( e.Chart.BackColor ), rectF );
        }
    }

    System.Drawing.Drawing2D.DashStyle ChartToDrawingDashStyle( System.Windows.Forms.DataVisualization.Charting.ChartDashStyle cds )
    {
        switch( cds )
        {
            case System.Windows.Forms.DataVisualization.Charting.ChartDashStyle.NotSet:
            case System.Windows.Forms.DataVisualization.Charting.ChartDashStyle.Solid:
                return System.Drawing.Drawing2D.DashStyle.Solid;
            case System.Windows.Forms.DataVisualization.Charting.ChartDashStyle.Dash:
                return System.Drawing.Drawing2D.DashStyle.Dash;
            case System.Windows.Forms.DataVisualization.Charting.ChartDashStyle.DashDot:
                return System.Drawing.Drawing2D.DashStyle.DashDot;
            case System.Windows.Forms.DataVisualization.Charting.ChartDashStyle.DashDotDot:
                return System.Drawing.Drawing2D.DashStyle.DashDotDot;
            case System.Windows.Forms.DataVisualization.Charting.ChartDashStyle.Dot:
                return System.Drawing.Drawing2D.DashStyle.Dot;
        }
        return System.Drawing.Drawing2D.DashStyle.Solid;
    }

    private void LineChartPostPaint( object sender, System.Windows.Forms.DataVisualization.Charting.ChartPaintEventArgs e )
    {
        if ( e.ChartElement.GetType() == typeof( System.Windows.Forms.DataVisualization.Charting.ChartArea ) )
        {
            System.Windows.Forms.DataVisualization.Charting.Chart       c   = (System.Windows.Forms.DataVisualization.Charting.Chart)e.Chart;
            System.Windows.Forms.DataVisualization.Charting.ChartArea   ca  = (System.Windows.Forms.DataVisualization.Charting.ChartArea)e.ChartElement;

            RectangleF clipRect = e.ChartGraphics.GetAbsoluteRectangle( e.Position.ToRectangleF() );
            RectangleF oldClip  = e.ChartGraphics.Graphics.ClipBounds;
            e.ChartGraphics.Graphics.SetClip( clipRect );

            int seriesIdx   = 0;
            foreach( System.Windows.Forms.DataVisualization.Charting.Series s in c.Series )
            {
                PointF  ptFLast         = new PointF( 0.0f, 0.0f );
                List< PointF > points   = new List<PointF>();
                foreach( System.Windows.Forms.DataVisualization.Charting.DataPoint dp in s.Points )
                {
                    double dx   = (double)dp.XValue;
                    double dy   = (double)dp.YValues[0];

                    // Log the value if its axis is logarithmic.
                    if ( ca.AxisX.IsLogarithmic )
                    {
                        dx  = Math.Log10( dx );
                    }
                    if ( ca.AxisY.IsLogarithmic )
                    {
                        dy  = Math.Log10( dy );
                    }

                    dx  = e.ChartGraphics.GetPositionFromAxis( ca.Name, System.Windows.Forms.DataVisualization.Charting.AxisName.X, dx );
                    dy  = e.ChartGraphics.GetPositionFromAxis( ca.Name, System.Windows.Forms.DataVisualization.Charting.AxisName.Y, dy );

                    PointF  ptFThis         = e.ChartGraphics.GetAbsolutePoint( new PointF( (float)dx, (float)dy ) );
                    points.Add( ptFThis );
                }

                if ( points.Count > 0 )
                {
                    Pen pen = new Pen( Color.FromArgb( 255, s.Color ) );
                    pen.Width       = mBorderWidths[seriesIdx];
                    pen.DashStyle   = ChartToDrawingDashStyle( s.BorderDashStyle );
                    //pen.DashStyle = System.Drawing.Drawing2D.DashStyle.Custom;
                    //pen.DashPattern   = new float[]{ 4.0f, 4.0f, 1.0f, 3.0f, 2.0f, 3.0f };
                    pen.DashCap     = System.Drawing.Drawing2D.DashCap.Round;

                    e.ChartGraphics.Graphics.SmoothingMode  = System.Drawing.Drawing2D.SmoothingMode.HighQuality;
                    e.ChartGraphics.Graphics.DrawLines( pen, points.ToArray() );

                }
                s.BorderWidth   = mBorderWidths[seriesIdx];
            }

            e.ChartGraphics.Graphics.SetClip( oldClip );
        }
    } 
```

我真的希望这可以减轻一些痛苦！

# javascript - Google Maps v3 Listener（点击）- 更改 URL

> ID：12162015
> 
> 赞同：0
> 
> 时间：2012-08-28T14:54:28.893
> 
> 标签：javascript, google-maps

我有一个带有标记集群和各种点的谷歌地图地图。使用事件侦听器生成如下点，它会在页面加载的每个点上消失。

```
function mappyfuntime() {
    var mapOptions = {
        center: new google.maps.LatLng(51.481581,-3.17909),
        zoom: 4,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    var map = new google.maps.Map(document.getElementById("bigmap"), mapOptions);
    <?php echo prepare_javascript(); ?>
    var markers = [];
    var marker = [];
    linkto = new Array();
    for(g=0; g<LocationsArray.length; g++) {
        var latlng = new google.maps.LatLng(LocationsArray[g][0], LocationsArray[g][1]);
        marker[g] = new google.maps.Marker({'position': latlng});
        markers.push(marker[g]);
        google.maps.event.addListener(marker[g], 'click', click_handler(PermalinksArray[g]));
    }
    var markerCluster = new MarkerClusterer(map, markers);
}

mappyfuntime();
function click_handler(link) {
    alert(link);
} 
```

但是，如果我将 google.maps.event.addListener 更改为以下内容，则警报会返回未定义。

```
google.maps.event.addListener(marker[g], 'click', function() {
    alert(PermalinksArray[g]);
}); 
```

如果我将 PermalinksArray[g] 传递给函数，也会发生同样的事情。当在地图上单击其对应点时，有什么方法可以从数组（全局定义）中获取一条信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:13:29.100

我猜永久链接数组来自 php 插入？那么它不在全球范围内。尝试将 php-insert 放在 javascript 脚本的顶部。

```
// set globals
var map;
var markers = [];
var PermalinksArray = ['...'];
var LocationsArray = ['...'];

function mappyfuntime() {

    // init map
    var mapOptions = {
        center: new google.maps.LatLng(51.481581,-3.17909),
        zoom: 4,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    map = new google.maps.Map(document.getElementById("bigmap"), mapOptions);

    // create markers        
    for(g=0; g<LocationsArray.length; g++) {

        // create new Position
        var latlng = new google.maps.LatLng(LocationsArray[g][0], LocationsArray[g][1]);
        // create new marker with position
        var marker = new google.maps.Marker({'position': latlng});
        // add event to marker
        google.maps.event.addListener(marker, 'click', function() {
            click_handler(marker, PermalinksArray[g]);
        });
        // push marker into markers array
        markers.push(marker);
    }
    var markerCluster = new MarkerClusterer(map, markers);
}

function click_handler(marker, link) {
    alert(link);
}

mappyfuntime(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T17:04:39.437

我创建了一个带有 2 个标记的谷歌地图，当单击一个标记时，该区域的名称会出现在信息窗口中。标记中的信息通过名为 cityList 的全局定义数组加载。你可以在下面找到我的代码。

```
<!doctype html>
<html lang="en">
   <head>
        <title>jQuery mobile with Google maps - Google maps jQuery plugin</title>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
        <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?v=3&sensor=false&language=en"> </script>
        <script type="text/javascript">

            var cityList = [
                ['Chicago', 41.850033, -87.6500523, 1],
                ['Illinois', 40.797177,-89.406738, 2]
            ],
            demoCenter = new google.maps.LatLng(41,-87),
            map;

            function initialize()
            {
                map = new google.maps.Map(document.getElementById('map_canvas'), {
                   zoom: 7,
                   center: demoCenter,
                   mapTypeId: google.maps.MapTypeId.ROADMAP
                 });
            }

            function addMarkers()
            {
                var marker, i;
                var infowindow = new google.maps.InfoWindow();
                for (i = 0; i < cityList.length; i++) 
                {  
                    marker = new google.maps.Marker({
                        position: new google.maps.LatLng(cityList[i][1], cityList[i][2]),
                        map: map,
                        title: cityList[i][0]
                    });

                    google.maps.event.addListener(marker, 'click', (function(marker, i) {
                        return function() {
                            infowindow.setContent(cityList[i][0]);
                            infowindow.open(map, marker);
                        }
                    })(marker, i));
                }
            }

            $(document).on("pageinit", "#basic-map", function() {
                initialize();
            });

            $(document).on('click', '.add-markers', function(e) {
                e.preventDefault();
                addMarkers();
            });

        </script>
    </head>
    <body>
        <div id="basic-map" data-role="page">
            <div data-role="header">
                <h1><a data-ajax="false" href="/">jQuery mobile with Google maps v3</a> examples</h1>
                <a data-rel="back">Back</a>
            </div>
            <div data-role="content">   
                <div class="ui-bar-c ui-corner-all ui-shadow" style="padding:1em;">
                    <div id="map_canvas" style="height:350px;"></div>
                </div>
                <a href="#" class="add-markers" data-role="button" data-theme="b">Add Some More Markers</a>
            </div>
        </div>      
    </body>
</html> 
```

我希望这有帮助。

# vb.net - VB.NET XML Literals vs StringBuilder 在性能方面

> ID：12162019
> 
> 赞同：2
> 
> 时间：2012-08-28T14:54:35.190
> 
> 标签：vb.net, performance, stringbuilder, xml-literals

我有很多带有 StringBuilder 的 VB 代码。我正在考虑将它们更改为 XML Litterals，关于性能是否比 StringBuilder 快？还是它更慢？

这是 XML 文字的示例：

```
Dim bookString = <bookstore xmlns="http://examples.books.com">
                       <book publicationdate=<%= publicationdate %> ISBN=<%= isbn %>>
                           <title>ASP.NET Book</title>
                           <price><%= price %></price>
                           <author>
                               <first-name><%= a.FirstName %></first-name>
                               <last-name><%= a.LastName %></last-name>
                           </author>
                       </book>
                   </bookstore>.Value 
```

这是使用 StringBuilder 的示例：

```
Dim stringBuilder = new StringBuilder()

stringBuilder.Append("<bookstore xmlns="http://examples.books.com">")
stringBuilder.Append("<book publicationdate=<%= publicationdate %> ISBN=<%= isbn %>>")
stringBuilder.Append("<title>ASP.NET Book</title>")
stringBuilder.Append("<price><%= price %></price>")
stringBuilder.Append("<author>")
stringBuilder.Append("<first-name><%= a.FirstName %></first-name>")
stringBuilder.Append("<last-name><%= a.LastName %></last-name>")
stringBuilder.Append("</author>")
stringBuilder.Append("</book>")
stringBuilder.Append("</bookstore>")

Dim bookString = stringBuilder.toString() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T14:57:15.747

您应该使用 XML 文字来确保您的代码是正确的。
如果您使用`StringBuilder`，您很可能会忘记转义某些内容并生成无效的 XML。

XML 文字可能会比纯字符串慢一点，但应该不会有太大区别。

如果您正在处理巨大的文件，您应该使用`XmlWriter`直接写入磁盘或网络的文件；这应该比任何一个都快。

请注意，在您的具体示例中，普通字符串连接会比 StringBuilder 更快。（因为您没有使用任何循环）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T17:49:10.067

从纯粹的性能角度来看，最好的选择是测试这两种选择。除了已经提到的其他选项之外，您可能需要考虑 XStreamingElement 将 Xml Literals 的类型安全（与字符串连接/字符串构建器相比）与输出流结合起来以限制内存开销。有关 XStreamingElement 的信息，请参阅[http://msdn.microsoft.com/en-us/library/system.xml.linq.xstreamingelement.aspx](http://msdn.microsoft.com/en-us/library/system.xml.linq.xstreamingelement.aspx)。

# python - Flask：传递后台工作者作业（rq，redis）

> ID：12162021
> 
> 赞同：8
> 
> 时间：2012-08-28T14:54:47.833
> 
> 标签：python, session, redis, backgroundworker, flask

我想做一件非常简单的事情：启动一个工作人员，然后将答案返回给用户。我正在尝试使用 Flask 和 RQ 的组合来做到这一点。

```
import os
from flask import Flask, session
from somewhere import do_something
from rq import Queue
from worker import conn

app = Flask(__name__)
app.debug = True
app.secret_key = '....'

q = Queue(connection=conn)

@app.route('/make/')
def make():
    job = q.enqueue(do_something, 'argument')
    session['job'] = job
    return 'Done'

@app.route('/get/')
def get():
    try:
        session['job'].refresh()
        out = str(session['job'].result)
    except:
        out = 'No result yet'
    return out 
```

这个非常简单的例子中的想法是人们去 /make/ 并且工作开始。一段时间后，可以转到 /get/ 并且工作人员的结果将在那里打印。

然而，一行导致问题：

```
session['job'] = job 
```

似乎这项工作不能被腌制，这显然是由 Flaks 会议使用的。我收到错误：

```
...
10:52:16 web.1     |   File "/Users/julius/twitter-sentiment/venv/lib/python2.7/site-packages/flask/app.py", line 804, in save_session
10:52:16 web.1     |     return self.session_interface.save_session(self, session, response)
10:52:16 web.1     |   File "/Users/julius/twitter-sentiment/venv/lib/python2.7/site-packages/flask/sessions.py", line 205, in save_session
10:52:16 web.1     |     secure=secure, domain=domain)
10:52:16 web.1     |   File "/Users/julius/twitter-sentiment/venv/lib/python2.7/site-packages/werkzeug/contrib/securecookie.py", line 329, in save_cookie
10:52:16 web.1     |     data = self.serialize(session_expires or expires)
10:52:16 web.1     |   File "/Users/julius/twitter-sentiment/venv/lib/python2.7/site-packages/werkzeug/contrib/securecookie.py", line 235, in serialize
10:52:16 web.1     |     self.quote(value)
10:52:16 web.1     |   File "/Users/julius/twitter-sentiment/venv/lib/python2.7/site-packages/werkzeug/contrib/securecookie.py", line 192, in quote
10:52:16 web.1     |     value = cls.serialization_method.dumps(value)
10:52:16 web.1     |   File "/Users/julius/twitter-sentiment/venv/bin/../lib/python2.7/copy_reg.py", line 70, in _reduce_ex
10:52:16 web.1     |     raise TypeError, "can't pickle %s objects" % base.__name__
10:52:16 web.1     | TypeError: can't pickle function objects 
```

我真的希望能有所帮助。我可能以完全错误的方式执行此操作（通过会话传递作业），但我不知道如何访问作业的结果......

任何帮助将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T15:25:28.270

我以前没有用过`rq`，但我看到一个工作有一个`.key`属性。在会话中存储该哈希可能更容易。然后您可以使用`Job`该类的`.fetch`方法，该方法本身将调用 a`.refresh()`并将作业返回给您。在那一点上阅读`.result()`将为您提供工作的当前状态。

也许像这样（未经测试）：

```
from rq.job import Job

@app.route('/make/')
def make():
    job = q.enqueue(do_something, 'argument')
    session['job'] = job.key
    return 'Done'

@app.route('/get/')
def get():
    try:
        job = Job()
        job.fetch(session['job'])
        out = str(job.result)
    except:
        out = 'No result yet'
    return out 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T15:27:10.623

序列化参数的问题（您实际上试图序列化函数对象，这是不可能的`pickle`）。

尝试

```
@app.route('/make/')
def make():
    job = q.enqueue(func=do_something, args=('argument',))
    session['job'] = job
    return 'Done' 
```

# ruby - Ruby - 将构造函数添加到 Fixnum 和其他类

> ID：12162022
> 
> 赞同：1
> 
> 时间：2012-08-28T14:54:48.770
> 
> 标签：ruby, oop, metaprogramming, fixnum

在我的[上一个问题](https://stackoverflow.com/questions/12146777/ruby-extend-built-in-variables-in-ruby)中，我正在寻找一种方法来扩展 Ruby 变量的能力。回答这个问题让我想到了一个新问题。显然，“猴子补丁”解决了这个问题的很大一部分，现在我至少可以使用类似于“猴子补丁”方法进入 Fixnum 检查天气“3”是一个有效值的方法`(a = 3).nat`来间接地进行输入。`nat`一开始还可以，但仍然有点笨拙和不直观。最后我真正需要的是一种方法来重写、扩展、拦截或重载到 Fixnum 的构造函数，以便`a = 3`直接调用方法`nat`。

有没有办法做到这一点？

我不仅对“正确的方式”感兴趣，而且可能有点“hacky”。这仅用于我的研究，它可能是一种危险的、不受支持的方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:22:45.673

在您的示例中，未调用构造函数，发生的情况是您通过使用赋值运算符来`a`引用文字。`3``=`

您想要的是覆盖AFAIK不可能的分配。

# asp.net - 虚拟目录 asp.net 4.5

> ID：12162024
> 
> 赞同：3
> 
> 时间：2012-08-28T14:54:55.010
> 
> 标签：asp.net, iis

我正在尝试在本地 IIS 中创建一个新目录，我想要的是能够将我的网站作为 www.localsitename.com/mywebsite 运行，其中 mywebsite 是 IIS 中配置为我的应用程序位置的应用程序（C:\mydocument \文件夹....）

通常在VS 2010中我曾经编辑项目文件并在IISUrl中添加条目但是当我在VS 2012中尝试相同的事情时，我得到一个错误无法创建虚拟目录，他们建议它必须使用本地主机.

我在这里有什么遗漏吗？

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T11:33:35.763

[按照此处](http://forums.whirlpool.net.au/archive/700646)所述更改您的本地主机名称。

# ruby-on-rails - 在 application.rb 中调用 import 会导致 jruby on rails 应用程序中的 rake 任务失败

> ID：12162028
> 
> 赞同：0
> 
> 时间：2012-08-28T14:55:04.713
> 
> 标签：ruby-on-rails, rake, jruby

我创建了一个[简单的应用程序](https://github.com/dalton/java_system)来演示我的问题。

在这个系统中，我更新了 application.rb 以允许我通过添加行来更新系统属性

```
require 'java'
include Java
import Java::JavaLang::System 
```

这在运行典型的 rails 任务（如 rails server 或 rails console）时没有影响，但 rake 任务会失败。

```
rake java_system:test 
```

结果是

```
rake aborted!
can't convert Class into String 
```

关于如何让 rake 工作的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:13:15.453

很简单的解决方案。显然 rake[定义了自己的导入方法](https://github.com/jimweirich/rake/blob/master/lib/rake/dsl_definition.rb)，这与 jruby 中的导入混淆。调用 java_import 可以解决问题！

[来源](http://jira.codehaus.org/browse/JRUBY-3171?focusedCommentId=160043&page=com.atlassian.jira.plugin.system.issuetabpanels%3acomment-tabpanel#comment-160043)

# css - 如何更改所选文本的不透明度？

> ID：12162033
> 
> 赞同：2
> 
> 时间：2012-08-28T14:55:22.427
> 
> 标签：css, selection, opacity

我在网页上有几乎不可见的文本，`opacity: 0.1;` 我希望它在被选中时变得可见。

但是，选择也几乎是不可见的。不幸的是，`::selection`不会改变不透明度。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-28T15:01:50.503

您将无法使用该`opacity`属性`::selection`。它从来都不是允许的属性之一，即使它被实现，它也没有任何意义，因为无论如何你都没有修改元素本身的不透明度。

您可以将`rgba()`颜色与文本和背景一起使用，而不是`opacity`在整个元素上使用。这不是理想的解决方法，但它至少适用于颜色：

```
body {
    color: rgba(0, 0, 0, 0.1);
}

::selection {
    color: rgba(0, 0, 0, 1);
} 
```

[jsFiddle 预览](http://jsfiddle.net/BoltClock/DEy9z)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-28T19:37:56.780

而不是使用不透明度，只需将 alpha 设置为 rgba 颜色，就像这样......

```
::selection {
    background: rgba(255, 255, 0, 0.5)
} 
```

# c# - 数据绑定到 XAML 中的 TreeView

> ID：12162034
> 
> 赞同：2
> 
> 时间：2012-08-28T14:55:26.540
> 
> 标签：c#, wpf, xaml, data-binding, mvvm

我正在尝试使用 WPF 数据绑定功能来`TreeView`显示对象（类别）的层次结构树。

我大致遵循[了 Josh Smith 的本教程](http://www.codeproject.com/Articles/26288/Simplifying-the-WPF-TreeView-by-Using-the-ViewMode)，但没有效果：我的`TreeView`.

这是我极其简单的应用程序的完整代码：

```
using System.Windows;

namespace WpfApplication1
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {   
            InitializeComponent();
            this.DataContext = CategoriesTreeViewModel.CreateDefault;
        }
    }
} 
```

ViewModel 对象和示例数据：

```
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Linq;

namespace WpfApplication1
{
    public class Category
    {
        public Category()
        {
            Children = new ObservableCollection<Category>();
        }

        public ObservableCollection<Category> Children
        {
            get;
            set;
        }
        public string Name { get; set; }

    }

    public class CategoriesTreeViewModel
    {
        public ReadOnlyCollection<Category> FirstGeneration;

        private static IEnumerable<Category> SomeCategories
        {
            get
            {
                var A = new Category() { Name = "A" };
                var B = new Category() { Name = "B" };
                var A1 = new Category() { Name = "A1" };
                var A2 = new Category() { Name = "A2" };
                var B1 = new Category() { Name = "B1" };
                var B2 = new Category() { Name = "B2" };

                A.Children.Add(A1);
                A.Children.Add(A2);
                B.Children.Add(B1);
                B.Children.Add(B2);

                yield return A;
                yield return B;
            }
        }

        public static CategoriesTreeViewModel CreateDefault
        {
            get
            {
                var result = new CategoriesTreeViewModel()
                {
                    FirstGeneration = new ReadOnlyCollection<Category>(SomeCategories.ToList())
                };
                return result;                
            }
        }
    }
} 
```

和 XAML：

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Grid>
        <TreeView ItemsSource="{Binding FirstGeneration}" Name="treeView1">
            <TreeView.ItemTemplate>
                <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                    <TextBlock Text="{Binding Name}" />
                </HierarchicalDataTemplate>
            </TreeView.ItemTemplate>
        </TreeView>
    </Grid>
</Window> 
```

为什么`TreeView`控件是空白的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T15:09:23.043

您无法访问您的 FirstGeneration 财产。没有“get”访问器的属性被认为是只写的。

```
public ReadOnlyCollection<Category> FirstGeneration { get; set; } 
```

# php - 使用从 AJAX 传递的数据编辑 XML 文件 - 正在删除 XML 数据

> ID：12162036
> 
> 赞同：0
> 
> 时间：2012-08-28T14:55:29.260
> 
> 标签：php, javascript, jquery, simplexml

我正在做一个项目，我将从谷歌地图 API 读取数据并将其转换为每个对象的 XML，然后将该 XML 存储在数组插槽中（这将发生多次，直到读取所有数据）然后我将对 PHP 文件的 Ajax POST 请求发送充满 XML 的数组和一个布尔值（让服务器知道它是哪个请求）。然后 PHP 将使用 SimpleXML 加载、使用接收到的数据编辑 XML，然后保存它。

我的问题是当我发出 ajax 请求时，Firebug 会识别一个`POST`请求并发送所有正确的数据。它抛出一个`302`（错误？）说`Moved Temporarily`然后`GET`发生一个请求（我认为这是由服务器启动的），它`Undefined inded: ajax`在我询问布尔值（称为ajax）是否为真的那一行输出一个错误。然后当我检查我的 XML 文件时，所有数据都被删除（文件仍然存在，但其中不再有任何 XML）我对如何解决这个问题感到非常困惑，我不确定该怎么做。这是我的一些相关代码。

预先感谢您提供的任何帮助。任何帮助都会非常有帮助！

另外，如果您需要我澄清任何事情，请随时发表评论。

javascript

```
function sendData(result)
{
    $.ajax(
    {
        type:'POST',
        url:'getXML.php',
        traditional: false,
        data:
        {
            //Result is an array full of XML
            'myXML': result,
            //The ajax boolean is for letting the PHP know that it is this request
            'ajax' : true
        },
        success: function(data)
        {
            $('#output').text(data);
        }
    })
} 
```

PHP

```
<?php
    //Set error reporting
    ini_set('display_errors', 1);
    ini_set('log_errors', 1);
    ini_set('error_log', dirname(__FILE__) . '/error_log.txt');
    error_reporting(E_ALL);

    //Checks if the get request is from the AJAX call
    if($_POST['ajax'])
    {
        //////////////////////////////Code for editing XML/////////////////////////////////////////
        //Checks to see if the xml file exists.
        if (file_exists('business.xml')) 
        {
            //Loads the XML file
            $xml = simplexml_load_file('business.xml');
            $result = $_POST['myXML'];
            //Append XML to existing file using data loaded in from AJAX request
            appendXML($xml, $result);   
        } 
        else 
        {
            //Loading XML has failed
            exit('Failed to open business.xml.');
        }
    }

    function appendXML($xml, $xmlResult)
    {
        foreach($xmlResult as $result)
        {
            //Creates new business node
            $business = $xml ->addChild('business');

            //Adds XML to business node (Please oh dear god let this work)
            $business ->addChild($result);

            file_put_contents("business.xml", $xml);
            header('Location: getXML.php');

        }
    }
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:40:18.693

您遇到的问题是这一行：

```
header('Location: getXML.php'); 
```

在页面的第一次运行时，一切正常，并且正在调用 appendXML 代码块。但是，当这种情况发生时，您正在将标头重定向到同一页面（我不确定为什么）。发生这种情况时，页面会重新加载，但在新页面中，您之前设置的帖子数据未设置。结果 $_POST 为空并且您的 if 语句失败，进一步 $_POST['myXML'] 也为空，这将清除您的 XML。

如果您出于某种原因需要重新加载页面，请考虑创建会话并将您的值存储在会话变量中。您还应该考虑清理您传入的数据，因为您当前的代码存在一个漏洞，有人可以将从浏览器传入的任何信息注入到您服务器上的 XML 文件中。这可能没什么大不了的，但我总是担心让某人将任何未转义的内容直接写入我系统上的文件中。如果没有其他人可以用这个恶意最大化您驱动器上的空间。

# sql-server - 使用触发器确保唯一性

> ID：12162037
> 
> 赞同：1
> 
> 时间：2012-08-28T14:55:31.363
> 
> 标签：sql-server, sql-server-2008, triggers

因此，我尝试使用以下触发器，以便在更新表中的行时，它将特定列设置为 8 个随机字母数字字符的字符串。触发器工作正常，只是结果必须是唯一的。在触发器之前它将是空白的，因此不会在服务器上强制执行此唯一性。这个想法是，一旦客户在流程中走得足够远，他们就会得到这个字符串，但之前不会，因为我们有很多没有走得那么远的客户。

触发：

```
CREATE TRIGGER test_rand
ON test_trigger
AFTER UPDATE 
AS
    UPDATE test_trigger set col2=(select
    Random_String =
    substring(x,(abs(checksum(newid()))%36)+1,1)+
    substring(x,(abs(checksum(newid()))%36)+1,1)+
    substring(x,(abs(checksum(newid()))%36)+1,1)+
    substring(x,(abs(checksum(newid()))%36)+1,1)+
    substring(x,(abs(checksum(newid()))%36)+1,1)+
    substring(x,(abs(checksum(newid()))%36)+1,1)+
    substring(x,(abs(checksum(newid()))%36)+1,1)+
    substring(x,(abs(checksum(newid()))%36)+1,1)

from
          (select x='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ') a) WHERE col2=''; 
GO 
```

这个触发器是我使用一个只有两列的简单表运行的测试，`col1`并且`col2`. 我更新`col1`了一堆行并`col2`获得了看似随机的值，但是我知道两行可以获得相同的数字，如果可能的话，我想防止这种情况发生。

我曾想过在不存在该字符串的地方检查 select 语句本身，但我无法想出一个好的方法来做到这一点。

我是触发器的新手，所以如果我遗漏了一些简单的东西或者应该搜索一下，那么我为浪费你的时间而道歉。据我所知，这甚至可能是不可能的，但我想我应该在放弃并尝试其他事情之前先问清楚。

此外，在执行更新的脚本中没有这样做的原因是我无法从客户端得到关于哪些脚本实际执行此操作的直接答案。如果这不可能，我将只编写一个由 Windows 任务计划程序运行的任务，但我希望这样做。

**我的解决方案**

根据 usr 告诉我的内容，我创建了以下代码来满足我的要求：

```
CREATE TRIGGER test_rand
ON test_trigger
AFTER UPDATE 
AS
    DECLARE @Ins_Col3 int;
    DECLARE Ins_Curs CURSOR FOR SELECT col3 FROM inserted;
    DECLARE @Ref char(8);

    OPEN Ins_Curs

    FETCH NEXT FROM Ins_Curs
    INTO @Ins_Col3;

    WHILE @@FETCH_STATUS = 0
    BEGIN;
        SET @Ref = LEFT(NEWID(), 8);

        WHILE(EXISTS(SELECT col2 from test_trigger WHERE col2=@Ref))
        BEGIN;
            SET @Ref = LEFT(NEWID(), 8);
        END;

        UPDATE test_trigger SET test_trigger.col2=@Ref FROM inserted WHERE test_trigger.col3=@Ins_Col3;
            FETCH NEXT FROM Ins_Curs
        INTO @Ins_Col3;
    END; 
```

我必须添加`col3`一个自动递增的 id 值，以便我可以识别每一行。 `col1`因此，只有在那里，我才能通过更新语句进行更改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:00:04.977

您应该使用 GUID 而不是混合 8 个字符的字符串。在 SQL Server 中，它是 UniqueIdentifier 列类型。这是一篇关于它的文章：http: [//msdn.microsoft.com/en-us/library/ms190215 (v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ms190215(v=sql.105).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:00:03.917

如果您想防止这种情况发生，`WHILE`请在触发器中包含一个循环，只要生成的字符串由于违反唯一性条件而无效，就会循环：

```
WHILE 0=0
BEGIN
 SET_TO_NEW_VALUE
 IF(NEW_VALUE_IS_UNIQUE)
  BREAK
END 
```

如果值不是唯一的，`ROLLBACK`您也可以。`RAISEERROR`取决于你想要发生什么。

# excel - Excel VBA 自定义函数给出“引用无效”错误

> ID：12162038
> 
> 赞同：0
> 
> 时间：2012-08-28T14:55:32.350
> 
> 标签：excel, vba, reference

我已经尝试追踪并解决这个错误几个小时了，但我就是想不通。这是设置。

我有一本 Excel 工作簿，里面有两张纸：“输入”和“计算”。我已经编写了一些自定义函数来计算某些事情。这些函数在“计算”表中使用，但在“输入”表中引用单元格。现在，如果我只是使用工作表本身，一切都可以正常工作并且功能可以正常工作。

但是，我有第二个与第一个交互的 Excel 工作簿。我在第二个工作簿中有一个宏，它试图在第一个工作簿的“输入”表中定义值。但是，当它这样做时，突然这些功能不起作用。当我尝试在“计算”表中跟踪单元格的错误，并尝试转到“输入”表中的单元格时，它声称引用无效。

我不知道问题是什么。起初我认为这可能与第一个工作簿的名称有关（即“Log K Calculator 7.0.0.xlsm”），但我尝试更改它，但我遇到了同样的问题。这是第二张表中的宏，它试图更改第一张表中的值：

```
Sub macro()

Dim logK As String
Dim this As String
logK = "Log K Calculator 7.0.0.xlsm"
this = ThisWorkbook.Name

Workbooks(logK).Activate

Workbooks(logK).Sheets("Input").Cells(11, 4).Value = Workbooks(this).Sheets(1).Cells(1,   "B").Value
Workbooks(logK).Sheets("Input").Cells(12, 4).Value = Workbooks(this).Sheets(1).Cells(2, "B").Value
Workbooks(logK).Sheets("Input").Cells(14, 4).Value = Workbooks(this).Sheets(1).Cells(3, "B").Value

End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-11-29T10:40:24.193

我知道这个线程已经有 4 年历史了，但是，以防万一有人还在像我一样寻找答案，对我来说，这个错误不是由我的代码引起的，而是因为我通过单击一个文本框来运行该程序我是从另一个工作簿中复制的。我已将过程/宏附加到文本框，但忘记了已经分配给同一个文本框的超链接。删除超链接解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T23:35:16.217

您可能想要检查 Excel 如何处理外部工作簿中的任何值。例如，它是否将数字视为文本？您可以通过在输入表中手动输入 '10000、'300 和 '600 来检查这一点（强制将它们视为文本但显示数字），并查看是否收到相同的参考错误。

如果你这样做了，那么将值转换为类型变量（Long，Decimal，你命名它）可能会解决这个问题。或者至少让 VBA 扼杀格式不正确的那些（例如，其中一些有空格，这可能解释了明显的不一致）

# android - 在android中将真实路径格式转换为Uri

> ID：12162043
> 
> 赞同：9
> 
> 时间：2012-08-28T14:55:42.937
> 
> 标签：android, android-intent

例如

真实路径是 mnt/sdcard/image_1.jpg Uri 路径是 content://media/external/images/media/140 像这样

```
 Uri photoUri =Uri.parse("content://media/external/images/media/140");
                                            Log.d("selectedphoto",""+photoUri);
               selectedImagePath = getPath(photoUri);

     public String getPath(Uri uri) {
            String[] projection = { MediaStore.Images.Media.DATA };
            Cursor cursor = managedQuery(uri, projection, null, null, null);
            int column_index = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
            cursor.moveToFirst();

    return cursor.getString(column_index);
    } 
```

在上面的代码中，我将 Uri 转换为真实路径，但不知道如何将真实路径转换为 ​​Uri

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-28T15:12:15.523

尝试这个：

```
Uri.fromFile(new File("/sdcard/cats.jpg")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-05T12:54:50.827

这将从 MediaProvider、DownloadsProvider 和 ExternalStorageProvider 获取文件路径，同时回退到您提到的非官方 ContentProvider 方法。

[https://stackoverflow.com/a/27271131/3758898](https://stackoverflow.com/a/27271131/3758898)

# sublimetext - 如何在 Sublime Text 中选择选定区域的所有实例

> ID：12162047
> 
> 赞同：319
> 
> 时间：2012-08-28T14:55:50.047
> 
> 标签：sublimetext

是否有快捷键或单步菜单选项来查找和选择 Sublime Text 中突出显示的选择的所有实例？

* * *

## 回答 #1

> 赞同：417
> 
> 时间：2012-08-28T15:01:21.427

在 Mac OS 上，您可以使用：`CMD`+ `CTRL`+`G`

* * *

## 回答 #2

> 赞同：299
> 
> 时间：2012-09-14T17:34:37.037

在 Windows/Linux 上按`Alt`+ `F3`。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2013-09-27T20:59:08.773

> 在 Windows/Linux 上按`Alt`+ `F3`。

这在 Ubuntu 上对我有用。我在“Key-Bindings：User”中将其更改为我更喜欢的东西。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2013-04-11T23:49:01.587

在 Mac 上：

`⌘</kbd>+`CTRL`+`g``

但是，您可以使用“[自定义您的 Sublime Text 2 配置以获得出色的编码。](http://www.nerdi.net/blog/2012/02/05/customize-your-sublime-text-2-configuration-for-awesome-coding/) ”以任何方式重置任何键，适用于 Mac。

* * *

在 Windows/Linux 上：

`Alt`+`F3`

如果有人有这方面的方法或文章，我会非常乐意更新。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2014-01-06T21:39:17.910

注意：您不应编辑默认设置，因为它们会在更新/升级时重置。对于自定义，您应该使用用户绑定覆盖任何设置。

在 Mac 上：

*   Sublime Text 2 > Preferences > Key Bindings-Default
*   Sublime Text 3 > 首选项 > 键绑定

这将打开一个文档，您可以在其中编辑 Sublime 的键绑定。

如果你搜索`"ctrl+super+g"`你会发现：

```
{ "keys": ["ctrl+super+g"], "command": "find_all_under" }, 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2017-09-14T07:40:52.017

在其他帖子中，您有快捷键，但如果您想要每个系统中的菜单选项，只需转到*Find > Quick Find All*，如附图所示。

此外，检查键绑定的其他答案比单击菜单更快。

[![崇高的文字 3](../Images/ce0d6ff127fb81583774773c5c66a479.png)](https://i.stack.imgur.com/Anuem.png)

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-01-20T09:47:46.133

即使有多个答案，使用这种方法也存在问题。它选择所有匹配的文本，而不仅仅是像变量这样的整个单词。

根据“ [Sublime Text：选择变量的所有实例并编辑变量名称”和“](https://stackoverflow.com/questions/16844657/sublime-text-select-all-instances-of-a-variable-and-edit-variable-name) [Sublime Text：选择](https://stackoverflow.com/questions/16844657/sublime-text-select-all-instances-of-a-variable-and-edit-variable-name/18422707#18422707)变量的所有实例并编辑变量名称”中的答案，我们必须从空选择开始。也就是说，开始使用快捷键`Alt`+`F3`这将有助于只选择整个单词。

# android - 在android中将文件上传到服务器

> ID：12162048
> 
> 赞同：0
> 
> 时间：2012-08-28T14:56:01.470
> 
> 标签：android, file-upload

我想将文件从我的 android 手机上传到服务器 URL。但服务器需要先登录。我怎样才能将文件上传到此服务器 URL 以及登录 URL。例如：上传网址： [http](http://api.someapi.net/v1/medium/14) ://api.someapi.net/v1/medium/14 所需参数：文件和标题

登录网址： [http](http://api.someapi.net/v1/user/login) ://api.someapi.net/v1/user/login 所需参数：邮箱和密码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:00:04.073

您的项目需要 Apache 的 Mime4J jar 文件（此处 - [http://james.apache.org/download.cgi#Apache_Mime4J](http://james.apache.org/download.cgi#Apache_Mime4J)）

并做：

```
MultipartEntity entity = new MultipartEntity(HttpMultipartMode.BROWSER_COMPATIBLE);
entity.addPart("file", new InputStreamBody(file, "UPLOAD.jpg"));
request.setEntity(entity); 
```

多田！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:03:39.003

使用以下代码检查登录凭据。如果响应正常，则使用下面的相同代码和不同的参数将文件发送到 url。否则随心所欲。

```
URL siteUrl;
    try {
        siteUrl = new URL("yoururl");
        HttpURLConnection conn = (HttpURLConnection) siteUrl
                .openConnection();
        conn.setRequestMethod("POST");
        conn.setDoOutput(true);
        conn.setDoInput(true);

        DataOutputStream out = new DataOutputStream(conn.getOutputStream());
        String content1 = ""; 

      //Here param is the Map<String,String> which holds the value of email and password
        Set getkey = param.keySet();
        Iterator keyIter = getkey.iterator();
        String content = "";
        for (int i = 0; keyIter.hasNext(); i++) {
            Object key = keyIter.next();
            if (i != 0) {
                content += "&";
            }
            content += key + "=" + param.get(key);

        }
       //Check by printing here
        System.out.println(content);
        out.writeBytes(content.trim());
        out.flush();
        out.close();
        BufferedReader in = new BufferedReader(new InputStreamReader(
                conn.getInputStream()));
        String line = "";
        while ((line = in.readLine()) != null) {
            System.out.println(line);
        }
        in.close(); 

    } catch (MalformedURLException e) {
        e.printStackTrace();
    } 
```

希望能帮助到你

# f# - 序列 与序列 在 F#

> ID：12162057
> 
> 赞同：2
> 
> 时间：2012-08-28T14:56:49.057
> 
> 标签：f#

我有以下方法：

```
 member this.addColumnWithHeading heading column =
    this.addColumn (seq { yield heading; yield! (column |> Seq.map string)}) 
```

它接受一个字符串标题和任何序列（在这种情况下被编译为 seq），创建一个字符串序列并使用该数据调用另一个方法。但是，它不适用于作为浮点序列的列：

```
Error   1   The type 'obj' does not match the type 'float'  C:\Users\ga1009\Documents\PhD\cpp\pmi\fsharp\pmi\Program.fs 138 
```

如何定义该方法`addColumnWithHeading`以使其也适用于浮点数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T15:07:06.537

内置`string`函数是一个使用静态解析的泛型参数的内联函数；由于您的`addColumnWithHeading`方法未声明`inline`，因此 F# 类型推断必须假定序列中的值是类型`obj`。

不过，有一个简单的解决方案——换掉`string`函数以支持“手动”调用`.ToString()`序列中的值。如果你这样做，F# 将能够为序列使用标准的泛型参数类型，这样你就可以传递你想要的任何类型的序列。

```
member this.addColumnWithHeading heading column =
    seq {
        yield heading
        yield! Seq.map (fun x -> x.ToString()) column }
    |> this.addColumn 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T15:07:42.987

`string`是内联的，因此它的参数类型必须在编译时解析。由于您的成员没有内联，因此它会选择最通用的类​​型（`obj`在这种情况下）。内联您的方法将允许`column`保持通用性。

```
member inline x.AddColumnWithHeading(heading, column) =
  x.AddColumn(seq { yield heading; yield! Seq.map string column }) 
```

编辑

根据对杰克回答的评论，您可能不需要内联您对`string`. 当然，如果`column`总是这样`seq<float>`，您应该只添加一个类型注释。在函数外部传递`seq<string>`和移动字符串转换是另一种选择。

# google-maps - 绑定的 Knockout 值与输入元素的值之间的差异

> ID：12162062
> 
> 赞同：0
> 
> 时间：2012-08-28T14:57:00.227
> 
> 标签：google-maps, knockout.js

我有一个从 JSON 对象映射的 Knockout 对象。该剔除对象的值数据绑定到输入元素。

我还将谷歌位置自动完成绑定到同一个输入元素。

淘汰对象引用的值告诉我我输入的值（未选中，所以它会是'bar'）。

输入框的值是正确的值（我选择的位置，'Barnet, United Kingdom'）。

这是一个演示问题的 JSFiddle... [http://jsfiddle.net/twistedinferno/CPEMk/](http://jsfiddle.net/twistedinferno/CPEMk/)

为什么这两个值不同，我可以将选定的值作为我的绑定值吗？（最好不需要我的 KO 对象上的其他属性）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T16:07:37.217

[在这里更新了 JSFiddle](http://jsfiddle.net/CPEMk/1/)

这是正常行为。Knockout 将其值绑定注册到它知道的事件，例如`afterkeypress`或`blur`。默认情况下，它无法“检测”其他框架（例如 Google Places API）所做的更改。因此，为了工作，您需要编写一些将事件从其他框架推送到 Knockout 的代码。

在这种情况下，Google Places Autocomplete API 支持[`place_changed`](https://developers.google.com/maps/documentation/javascript/places#getting_place_information)事件。我已将此事件合并到我更新的 Fiddle 中以展示一个工作示例。[有关此事件的更多信息，请参阅 Google 文档](https://developers.google.com/maps/documentation/javascript/places#getting_place_information)。最重要的一点是：

```
google.maps.event.addListener(autocomplete, 'place_changed', function() {
    var place = autocomplete.getPlace();
    koObj.StartDescription(place.formatted_address);
    koObj.Name(place.name);
    koObj.Address(place.formatted_address);
}); 
```

**但是，如果您打算多次使用此功能，我强烈建议您将此行为包装在[自定义 Knockout 绑定](http://knockoutjs.com/documentation/custom-bindings.html)中。**

[这是一篇关于自定义 Knockout 绑定的优秀文章](http://www.knockmeout.net/2011/07/another-look-at-custom-bindings-for.html)。如果您一直滚动到最后一章，您将看到一个环绕第三方控件的 Knockout 绑定示例。您将希望对 Google Places Autocomplete 执行相同的操作，因此您可以处理使用此控件的三个方面：

1.  初始化控件（带有小部件的可选配置选项）
2.  通过设置事件处理程序来响应 UI 中的更新。这是通过环绕`place_changed`事件来实现的。
3.  响应对视图模型所做的更新。对于您的方案，这可能不是必需的。

使用自定义敲除绑定将如下所示：

```
<input id="startDescription" type="text" data-bind="googleAutoComplete: StartDescription, googleAutoCompleteOptions: { componentRestrictions: { country: 'uk' } }" /> 
```

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-11T10:16:59.080

这是我为此编写的一个简单的自定义绑定，以防有人正在搜索它：

```
ko.bindingHandlers.addressAutocomplete = {
    init: function (element, valueAccessor, allBindingsAccessor) {
        var value = valueAccessor(), allBindings = allBindingsAccessor();

        var options = { types: ['geocode'] };
        ko.utils.extend(options, allBindings.autocompleteOptions)

        var autocomplete = new google.maps.places.Autocomplete(element, options);

        google.maps.event.addListener(autocomplete, 'place_changed', function () {
            result = autocomplete.getPlace();
            value(result.formatted_address);
        });
    },
    update: function (element, valueAccessor, allBindingsAccessor) {
        ko.bindingHandlers.value.update(element, valueAccessor);
    }
}; 
```

你可以像这样使用它：

```
<input type="text" data-bind="addressAutocomplete: Address" /> 
```

或者，如果您想指定 google 地方自动完成的选项（例如，将您的搜索限制在一个国家/地区）：

```
<input type="text" data-bind="addressAutocomplete: Address, autocompleteOptions: { componentRestrictions: { country: 'au' } }" /> 
```

希望能帮助到你。

（注意。默认情况下，我将自动完成功能限制为地理编码类型。）

另外，如果您想绑定到地址的特定组件，请参阅此要点[https://gist.github.com/chadedrupt/5974524](https://gist.github.com/chadedrupt/5974524)

# objective-c - 如何以编程方式滚动 UIScrollVIew

> ID：12162066
> 
> 赞同：4
> 
> 时间：2012-08-28T14:57:11.843
> 
> 标签：objective-c

我想滚动我的`UIScrollView`（水平）。但是当按下按钮时，它会转到滚动视图的最左侧。我想滚动它 3,4 像素，当我再次按下它时，它又滚动了 3,4 像素

```
- (IBAction)leftScroll:(id)sender
{
    CGPoint pt;
    pt.x = 1;
    pt.y = 0;
    UIScrollView *sv = (UIScrollView *)[self.view viewWithTag:5];
    [sv setContentOffset:pt animated:YES];         
} 
```

提前感谢您的回答

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-28T15:02:54.590

尝试并手动设置新位置。

**目标-c**

```
 float width = CGRectGetWidth(scrollView.frame);
  float height = CGRectGetHeight(scrollView.frame);
  float newPosition = scrollView.contentOffset.x+width; 
  CGRect toVisible = CGRectMake(newPosition, 0, width, height);

 [scrollView scrollRectToVisible:toVisible animated:YES]; 
```

**斯威夫特 4**

```
let scrollView = UIScrollView()
let width: CGFloat = scrollView.frame.size.width
let height: CGFloat = scrollView.frame.size.height
let newPosition: CGFloat = scrollView.contentOffset.x + width
let toVisible: CGRect = CGRect(x: newPosition, y: 0, width: width,   height: height)

scrollView.scrollRectToVisible(toVisible, animated: true) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-01-20T19:48:36.343

你可以使用`[scrollView setContentOffset:CGPointMake(x, y) animated:YES];`方法。如果您的 scrollView 水平滚动，那么您需要相应地设置 x 值，否则设置 y 值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-10-08T07:37:36.640

您可以使用 Obj-C 中的以下内容滚动到滚动视图中的某个点

```
[scrollView setContentOffset:CGPointMake(x, y) animated:YES]; 
```

或斯威夫特

```
scrollView.contentOffset = CGPoint(x: x, y: y) 
```

要使用 UIScrollView 进行幻灯片放映，您可以在滚动视图中排列所有图像，设置重复计时器，然后 -setContentOffset:animated: 当计时器触发时。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-09T11:34:33.017

```
UIButton *locatorbutton_frame=(UIButton *)[scrollviewoutlet viewWithTag:numberglobal];
float width = scrollviewoutlet.frame.size.width;
float height = scrollviewoutlet.frame.size.height;
float newPosition = scrollviewoutlet.contentOffset.x-locatorbutton_frame.frame.size.width;//+width;
CGRect toVisible = CGRectMake(newPosition, 0, width, height);

[scrollviewoutlet scrollRectToVisible:toVisible animated:YES]; 
```

我发现它工作正常 locatorbutton_frame 是我添加到滚动视图的按钮。

# android - 将原始数据包发送到 Android 中的 NetworkInterface 不起作用？

> ID：12162069
> 
> 赞同：8
> 
> 时间：2012-08-28T14:57:17.693
> 
> 标签：android, ip, ip-address

我正在尝试通过 VPN 将数据包从 VPN 发送到适当的硬件上，而无需使用任何真正的 VPN 服务器，因此我可以记录正在发送的数据包。

我能够获得一个我希望数据包实际到达`InetAddress`的`wlan0`接口，但我不太确定这是否是正确的位置（它显示了我当前的 IP 地址）。

然后我在其上使用`DatagramChannel`(称为`socket`和`IntetAddress`is `uplink`)：

```
socket.connect(new InetSocketAddress(uplink, 0)); 
```

并向其写入数据包：

```
socket.write(packet); 
```

但没有什么坚持，我只是得到

```
java.net.SocketException: sendto failed: EINVAL (Invalid argument) 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-15T19:04:21.583

我正在尝试在为 Android 创建防火墙/过滤应用程序时做类似的事情。我在这中间，所以用适当大小的盐粒来接受我所说的话。:-)

您/我的情况的问题是您正在从 VpnService 提供给您的虚拟网络接口中取出数据包，但随后您正在取出这些数据包并使用套接字将它们写出。套接字旨在处理客户端和服务器之间的应用程序有效负载的传输，而不是数据包。

套接字将获取您提供的任何数据，并将该数据包装在它自己创建的数据包中（如果使用 Socket，则为 TCP，如果使用 DatagramSocket，则为 UDP）。在您的情况下，您正在处理套接字的数据本身就是一个数据包，因此您最终会得到一个数据包中的数据包（可能是 UDP 数据包中的 TCP 数据包）。

当打包的数据包到达服务器的套接字时，该端的网络接口和 ServerSocket 将打开有效负载并发现它是另一个数据包。可能不会工作，因为从服务器端套接字（例如 Web 服务器）读取的任何内容都需要应用程序有效负载（例如 HTTP 标头/等）。

现在，当您拥有一个真正的 VPN 隧道时，该隧道的服务器端可能会将您的“包装数据包”有效负载从它接收的 UDP 数据包中提取出来，然后将该数据包直接交给可以解释数据包本身的网络接口.

如果没有这个真正的 VPN 隧道，您的 VpnService 实现本质上必须成为一个虚拟网络接口本身，处理 TCP/UDP/等。虚拟网络接口和您的代码之间的协议。基本上，从您的 VPN 接口读取的数据包必须被视为应用程序数据流（数据包整理和重组），然后再写入您的传出套接字。然后，您必须以某种方式确认您刚刚从接口消耗的数据包。然后，您必须从您的 Socket（这是一个有效负载数据流）中获取传入数据，并将其分解为数据包，然后您可以将这些数据包发送回您的 VPN 接口的输出流。最后，您需要处理您的虚拟 VPN 接口为响应您发送的数据包而发送的确认流量。这并非易事。

我真的希望我对这一切都错了，有人有一个用 Java 编写的简单的“虚拟网络接口”，可以用来代替真正的 VPN 隧道。我一直没能找到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T20:43:56.297

您可以使用[NetworkInterface API](http://developer.android.com/reference/java/net/NetworkInterface.html)以编程方式获取 wlan0 地址。

我也在尝试做类似的事情..我能够在虚拟接口上看到数据包..但我无法通过本地接口发送数据包..

我可以使用 DatagramChannel 连接到 wlan0，但是从 wlan0 到外部服务器的连接卡在 SYN_SEND 上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T20:48:17.957

你可以试试更高的端口。这对我有用： `InetSocketAddress(uplink, 3022)`

我不知道如何确保该端口未被使用。

你是怎么得到wlan0的地址的？我使用了 adb shell ifconfig 并粘贴了地址。

# java - JBoss 6x 绝对 uri：http://java.sun.com/jsp/jstl/core 无法在 web.xml 或随此应用程序部署的 jar 文件中解析

> ID：12162072
> 
> 赞同：1
> 
> 时间：2012-08-28T14:57:20.937
> 
> 标签：java, jsp, jboss, tags, jstl

我在 JBoss 6x 中有一个 Web 应用程序（它是一个 ear 文件）。

**访问 JSP 页面时** 出现错误消息：绝对 uri: [http://java.sun.com/jsp/jstl/core](http://java.sun.com/jsp/jstl/core)无法在 web.xml 或随此应用程序部署的 jar 文件中解析

**JSP**

```
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%> 
```

**web.xml**

```
<web-app      
    xmlns="http://java.sun.com/xml/ns/javaee"    
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"     
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"     
    version="3.0"> 
```

**WEB-INF\lib 包含**

```
jstl-1.2.jar 
```

请指教，我在这里做错了什么？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T11:14:42.613

问题出在 JBoss 6x for .ear（企业档案）中的类加载器行为。我的耳朵文件里面有一个战争，它最终使用了它自己的类加载器——它总是只在 WEB-INF\lib 中查找 jar 文件。

我的 jstl-1.2.jar 位于 JBOSS_HOME\server\domain\lib 此位置的所有 jar 对 .ear 可见，但对其中的 .war 不可见。因此 JSP 找不到 jstl-1.2.jar

一旦我在战争中将 jstl-1.2.jar 放在 WEB-INF\lib 中，错误就消失了。这解释了问题和立即解决方案。

虽然我想为整个 .ear 提供一个类加载器（对于 .war 来说不是一个不同的类加载器）——不知道该怎么做——但这是一个不同的问题。

# c#-4.0 - 如何使用 LINQ C# 修改 XElement

> ID：12162073
> 
> 赞同：0
> 
> 时间：2012-08-28T14:57:23.817
> 
> 标签：c#-4.0

如何在内存中处理现有的 xemement 类型对象？

我的内存中有类似 XElement 的内容，我想在循环中进行下一次迭代之前对其进行修改。想要添加到组所有节点。使用 xElement.Add 没有用 - 所以想知道最好的方法是什么？

`<Root> <deals> <deal> <dealid> D1 </dealid> <Trade> T1</Trade> <Details> dt1 </Details> <Details> dt2 </Details> <Trade> T2</Trade> <Details> dt1 </Details> <Details> dt2 </Details> <Group> g1 </Group> <Group> g2 </group>
</deal> </deals> <Root>`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:30:20.240

这是通过使用两个不同的 XElement 对象并在每次迭代后合并两者来完成的 - 感谢您对此的关注。

问候，

# ibm-midrange - 为什么 READADC 操作在单页子文件制作的单个选择列表中取先前选择的值？

> ID：12162076
> 
> 赞同：0
> 
> 时间：2012-08-28T14:57:33.237
> 
> 标签：ibm-midrange

我正在制作一个显示文件，其中包含由单个页面子文件创建的单个选择列表。通过这个实现，我发现了两个问题。

第一个是当我在加载显示文件时第一次按Enter选择一个选项时，RPGLE中的READADC操作将返回正确的值（它返回子文件记录中的字符串）。当我再次按下 Enter 并选择了不同的选项时，返回了上一次 Enter 按下的值。在随后的轮次中，它一直返回它之前的选择值。我在程序中的第一个之后添加了第二个 READADC，只是为了看看会发生什么，并发现两个 READADC 都返回了值。第一个返回之前选择的值，第二个返回我当前选择的值。

第二个问题是多次选择相同的选项不起作用，即它只在第一次起作用，如果我立即尝试再次选择它，它没有响应。

我已将相同的逻辑应用于另一个由加载所有子文件组成的单个选择列表，它没有任何这些问题。是不是说单页子文件不适合做单选列表？

这是子文件的 DDS：

```
A                R ITFMAT02
A                  S1OPTN          50 A 6 11
A                R ITFMAT01
A                                           SFLCLT(ITFMAT02)
A 27                                        SFLDSP
A 28                                        SFLCLR
A 29                                        SFLEND
A                                           CF12(12)
A                                           SFLSNGCHC(*AUTOSLT) 
```

这是 RPGLE 主循环：

```
C        *IN12     DOWEQ       *OFF
C                  EXFMT       ITFMAT01
C        *IN12     IFEQ        *ON
C                  LEAVE
C                  ENDIF
C                  READC       ITFMAT02
C                  MOVEL       S0OPTN         W1OPTN
                     .
                     .
                     .
C                  ENDDO 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:01:55.710

这是一个工作示例。我怀疑你没有清除选择控制字段。

```
 A*
 A          R ITFMAT02                  SFL
 A            CTL            1Y 0H      SFLCHCCTL
 A            S1OPTN        50A     6 11
 A*
 A          R ITFMAT01
 A                                      SFLCTL(ITFMAT02)
 A  27                                  SFLDSP
 A N28                                  SFLDSPCTL
 A  28                                  SFLCLR
 A  29                                  SFLEND
 A                                      SFLSIZ(15)
 A                                      SFLPAG(05)
 A                                      CF12(12)
 A                                      SFLSNGCHC(*AUTOSLT)
 A            SFLRRN         4S 0H      SFLRCDNBR(CURSOR)
 A                                  1 30'Title'
 A            CHOICE         4S 0   3  1
 A                                  4  5'Choose one' 
```

还有 RPG。我通常不以固定格式工作，但试图反映现有的风格。

```
 fsotest    cf   e             workstn
 f                                     SFILE(itfmat02:RRN)

 c* clear sfl
 c                   z-add     1             sflrrn
 c                   setoff                                       272829
 c                   seton                                        28
 c                   write     itfmat01
 c                   setoff                                       28
 c* load sfl
 c     1             do        9             rrn               4 0
 c                   movel     rrn           s1optn
 c                   write     itfmat02
 c                   seton                                        27
 c                   enddo

 C     *IN12         DOWEQ     *OFF
 C                   EXFMT     ITFMAT01

 C     *IN12         IFEQ      *ON
 C                   LEAVE
 C                   ENDIF

 C                   READC     ITFMAT02                               80
 C  n80              do
 C                   movel     rrn           choice
 C                   z-add     0             ctl
 C                   update    itfmat02
 C                   enddo
 C                   ENDDO

 c                   seton                                        lr 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:44:18.167

READADC 行为完全符合预期。Read Changed 的​​“已更改”部分读取称为修改数据标签的内容。如果用户对子文件记录进行了更改 - 包括空格键在内的任何更改 - 都会为该记录设置 MDT。这意味着如果用户触摸多条记录，则会设置多个 MDT。典型的用途是将 READADC 置于一个循环中，以便 RPG 程序处理每个接触的记录。至于为什么 MDT 没有被关闭，你在使用`SFLNXTCHG`吗？

不确定第二个问题；发布您正在使用的 DDS 和 RPG。

# ruby-on-rails - 从自定义控制器操作（Rails）中注销设计会话

> ID：12162077
> 
> 赞同：3
> 
> 时间：2012-08-28T14:57:41.050
> 
> 标签：ruby-on-rails, devise

如何从自定义控制器中退出设计会话？

我们有任何内置功能来做到这一点吗？就像我们有`user_signed_in?`

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-28T15:24:58.870

设计中有一个`sign_out`方法。您可以不带参数调用它。见[文档](http://www.rubydoc.info/github/plataformatec/devise/Devise/Controllers/SignInOut#sign_out-instance_method)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-28T19:43:03.477

可以清除会话：

```
reset_session 
```

# php - 如何显示变量的每个数字？

> ID：12162086
> 
> 赞同：-1
> 
> 时间：2012-08-28T14:58:30.303
> 
> 标签：php, mysql, numbers, paging

基本上我想要的是显示一个计数，直到它达到某个数字，所以如果我在屏幕上有数字“5”，它将显示“1 2 3 4 5”。或者如果我有数字“3”，它会显示“1 2 3”。

原因是因为我为我的 MySQL 结果创建了一个分页系统。我到目前为止的代码是

```
$result1 = mysql_query("SELECT * FROM questions WHERE subcat = '$conditions'");
$num_rows = mysql_num_rows($result1);
$results_per_page = "3";
$num_pages = $num_rows / $results_per_page; 
```

所以它计算有多少结果，例如我们会说 12 个结果。然后它将这个数字除以我希望每页显示多少个结果。在本例中，它的“3”。所以答案是“4”。所以我现在想在屏幕上显示“1 2 3 4”，但是我希望每个数字都是一个链接。

我该怎么做呢？

谢谢本

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T15:00:44.577

```
foreach( range( 1, $num_pages) as $i) {
    echo '<a href="index.php?page=' . $i . '">' . $i . '</a>';
} 
```

或者，knittl 建议的方法：

```
echo implode( ' | ', array_map( function( $i) {
    return sprintf( '<a href="index.php?page=%d">%d</a>', $i, $i);
}, range( 1, $num_pages))); 
```

打印[这样的东西](http://viper-7.com/Gi5zgd)：

```
1 | 2 | 3 | 4 | 5 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T15:00:33.080

使用 for 循环。

```
for($i = 1; $i <= $num_pages; $i++){
    echo '<a href="page.php?page='.$i.'">'.$i.'</a> ';
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-28T15:02:05.220

使用循环：

```
for($i = 0; $i < $num_pages; ++$i) {
  printf('<a href="?page=%d">page %d</a>', $i, $i);
} 
```

# python - 如何通过 plone 浏览器代理 Web 服务，生成 utf-8 编码的 xml

> ID：12162087
> 
> 赞同：0
> 
> 时间：2012-08-28T14:58:42.123
> 
> 标签：python, ajax, character-encoding, plone, zope

我有一个 Plone 3.3 站点，它从 RESTful Web 服务中检索信息；该服务返回 utf-8 编码的 xml 数据。请求是通过一个特殊的浏览器发送的（让我们称之为`@@proxy`这个问题）。只要不返回非 ASCII 数据，一切正常。

浏览器的`get`方法是这样的：

```
def get(self, thedict=None):
    """
    reduced version for stackoverflow
    """
    context = self.context
    request = context.request
    response = request.response
    if thedict is None:
        thedict = request.form
    theurl = '?'.join((basejoin(SERVICEBASE, thedict['path']),
                       urlencode(auth_data),
                       ))
    fo = urlopen(theurl)
    code = fo.code
    headers = fo.info().headers
    for line in headers:
        name, text = line.split(':', 1)
        response.setHeader(name, text.strip())    # trailing \r\n
    text = unicode(fo.read(), 'utf-8')
    # --- debugging only ... -- 8< ----- 8< ----- 8< ----- 8< ----- 8<
    CHARSHERE = set(list(text))
    funnychars = CHARSHERE.difference(XMLCHARS)
    if funnychars:
        funnychars = u''.join(tuple(funnychars))
        logger.info('funny chars: %r' % funnychars)
    elif 1:
        logger.info('funny chars: none')
    # --- ... debugging only -- >8 ----- >8 ----- >8 ----- >8 ----- >8
    response.setBody(text.encode('utf-8')) 
```

首先，我没有对编码（`unicode`，`encode`）做任何事情。但是，这似乎是必要的；当包含诸如变音符号等非 ASCII 数据时（例如`INFO proxy@@w3l funny chars: u'\xdf'`），浏览器不喜欢结果。当我直接尝试相同的请求（到`theurl`，而不是通过我的`@@proxy`浏览器）时，它可以工作。问题不取决于互联网浏览器，即Firefox 和IE 咳嗽。

有一个`Content-Type`值为“ `text/xml;charset=UTF-8`”的标头；在分号后面插入一个空格字符并没有改变任何东西。

**编辑：**这就是 Seamonkey 所说的：

```
XML-Verarbeitungsfehler: Kein Element gefunden
Adresse: http://.../@@proxy/get
Zeile Nr. 1, Spalte 1:

^ 
```

（英文：xml processing error: no element found; row #1, column #1）

由于我不是该服务的作者，因此我不*完全*确定数据是否*真实* `UTF-8`（尽管 HTTP 标头和`<?xml ...>`行是这样说的）。

我的错误是什么？我该怎么做才能找到问题？我是否遗漏了有关 Zope 响应对象和/或的重要信息`urllib2.urlopen`？

我也尝试过类似的东西（浓缩）：

```
fo = urlopen(theurl)
raw = fo.read().strip()
try:
    text = unicode(raw, 'utf-8')
    logger.info('Text passes off as utf-8')
except Exception, e:
    logger.info('no valid utf-8:')
    logger.exception(e)
    text = unicode(raw, 'latin-1') 
```

……或者反过来；我从来没有遇到任何解码错误。

我将“原始”数据写入了一个文件 ( `open(filename, 'wb')`)，我用 vim ( `set enc? fenc?`) 检查了该文件，生成了`utf-8`.

我无计可施。

# apache - 如何将 /?a=a 重写为 /a/？

> ID：12162089
> 
> 赞同：1
> 
> 时间：2012-08-28T14:58:50.173
> 
> 标签：apache, .htaccess, mod-rewrite

如何重写此 URL：

```
http://mywebsite.com/?a=a 
```

到这个网址：

```
http://mywebsite.com/a/ 
```

用htaccess？

我尝试了这个重写规则，但它不起作用：

```
RewriteRule /a /?a=a 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:02:55.147

如果您只是在 URI 中寻找完全匹配的`?a=a`，则可以使用它。

```
RewriteRule ^\?a=a$ /a/ [R=301] 
```

这假设您想要重写用户浏览器中的实际 URL 并提供 301 标头以让任何爬入页面的内容都知道要使用的“正确”URI（因此是`[R=301]`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T15:03:43.223

试试这个：

```
RewriteRule ^a/?$ /?a=a [L] 
```

`http://mywebsite.com/a/`这会将请求路由到`http://mywebsite.com/?a=a`

# java - Ant“Java”任务未运行

> ID：12162090
> 
> 赞同：2
> 
> 时间：2012-08-28T14:59:00.823
> 
> 标签：java, ant

所以我有这个 ant 文件，它一直工作到它到达“运行”任务。它清理并编译，但是当它“运行”时，什么也没有发生。我什至没有收到错误消息。我知道它正在运行的程序没有问题，因为当我在命令行上执行 java Driver 时它运行良好。

```
<project name="lab3" default="run">

  <target name="run" depends="compile">
      <java classname="Driver" fork="true"/>
  </target>

  <target name="compile" depends="clean">
     <javac srcdir="." includes="**/*.java" includeantruntime="false"/>
  </target> 

  <target name="clean">
    <delete>
       <fileset dir="." includes="**/*.class, **/*.jar"/>
    </delete>
  </target> 

</project> 
```

非常感谢任何可以帮助初学者的人！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:03:01.157

尝试从 <java> 任务中删除 fork="true"。它目前正在生成一个单独的 JVM。

# r - R 摆动输出错误

> ID：12162092
> 
> 赞同：7
> 
> 时间：2012-08-28T14:59:04.663
> 
> 标签：r, sweave

我正在使用 RStudio v0.96.331 和 pdfTeX，版本 3.1415926-1.40.10（TeX Live 2009/Debian）。我在“/home/operacao/Myprojs/projName”中有一个 R 项目，这是我的工作目录。

现在，如果我在“/home/operacao/Myprojs/projName/reports”中创建一个名为“reports”的文件夹，并在 sweave 文件（位于报告文件夹中）中使用代码

```
 setwd('/home/operacao/Myprojs/projName') 
```

加载一些包后，我收到错误

```
 Error in driver$finish(drobj) : 
 the output file 'my_report.tex' has disappeared
 Calls: <Anonymous> -> <Anonymous>
 Execution halted 
```

但是文件在文件夹中，我制作的图出现在.pdf中。文本输出不出现。

有谁知道为什么会这样？如果我将 Sweave 文件直接保存在我的工作目录中，一切正常。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T12:43:02.840

可能 RStudio 要求您将工作目录设置为包含 Sweave 文件的位置。为什么需要将工作目录设置为另一个目录？您可以`source`用来加载任何位于`projName`.

# firefox - 在 selenium grid2 中使用浏览器配置文件

> ID：12162097
> 
> 赞同：1
> 
> 时间：2012-08-28T14:59:16.523
> 
> 标签：firefox, selenium, selenium-webdriver, selenium-grid

我需要使用 selenium GRID 根据用户要求启动具有不同浏览器配置文件的 Firefox。

我怎样才能做到这一点？

我的框架在 Selenium-RC 中，所以我无法使用 Webdriver DesiredCapabilities。

有人有解决办法吗？？

# asp.net - 我如何让我的查询来比较价格？

> ID：12162098
> 
> 赞同：0
> 
> 时间：2012-08-28T14:59:20.713
> 
> 标签：asp.net, linq, linq-to-sql

下午，

如果价格匹配，我想返回一个布尔值。我返回 3 个不同的价格，但是我需要比较 lowprice 和 amzprice 是否相同。如果他们是我也需要返回......

```
pricematched = true 
```

以下是我当前的查询。

```
 var query = from a in dc.aProducts
             join t in dc.tProducts on a.sku equals t.sku
             join lp in dc.LowestPrices on a.asin equals lp.productAsin
             orderby t.title
             select new GetLowestPrices
             {
                 productAsin = lp.productAsin,
                 sku = t.sku,
                 title = t.title,
                 oprice = Convert.ToString(t.tPrice),
                 lowprice = Convert.ToString(lp.price),
                 amzprice = Convert.ToString(lp.tAmzPrice),
                 lastupdated = Convert.ToDateTime(lp.priceDate)
            };
            return query.ToList(); 
```

所有的帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:03:33.543

```
select new GetLowestPrices
         {
             productAsin = lp.productAsin,
             sku = t.sku,
             title = t.title,
             oprice = Convert.ToString(t.tPrice),
             lowprice = Convert.ToString(lp.price),
             amzprice = Convert.ToString(lp.tAmzPrice),
             lastupdated = Convert.ToDateTime(lp.priceDate),
             pricematched = lp.price == lp.tAmzPrice
        }; 
```

顺便说一句，为什么要对价格进行字符串处理？还：

```
return query.ToList(); 
```

如果你可以侥幸逃脱`return query`而不是列出清单，那就去做吧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:03:49.973

如果您可以将布尔值添加到现有对象中，它只会影响查询，如下所示：

```
 var query = from a in dc.aProducts
         join t in dc.tProducts on a.sku equals t.sku
         join lp in dc.LowestPrices on a.asin equals lp.productAsin
         orderby t.title
         select new GetLowestPrices
         {
             productAsin = lp.productAsin,
             sku = t.sku,
             title = t.title,
             oprice = Convert.ToString(t.tPrice),
             lowprice = Convert.ToString(lp.price),
             amzprice = Convert.ToString(lp.tAmzPrice),
             lastupdated = Convert.ToDateTime(lp.priceDate),
             pricematched = lp.tAmzPrice >= lp.price    // This should do it
        };
        return query.ToList(); 
```

否则，您必须在查询之外使用辅助查询：

```
var matchedItems = query.Where(x => x.amzprice >= x.lowprice); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T15:52:29.617

我决定使用 jquery 来代替。

# asp.net-mvc - excel报告不能下载，还需要做什么？

> ID：12162101
> 
> 赞同：0
> 
> 时间：2012-08-28T14:59:26.403
> 
> 标签：asp.net-mvc

1.  当我使用提交按钮并将 Excel 导出代码放入控制器 POST 操作时，下面的代码运行良好。
2.  现在我不想回发并移动下面的代码，但现在报告没有下载，虽然控制器操作“ExcelExport”按预期调用，但报告没有下载？请建议这里有什么问题？

**模型**

```
public class Product
{
    public int Id { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }
    public Decimal Price { get; set; }

    public Product(int id, string name, string description, decimal price)
    {
        Id = id;
        Name = name;
        Description = description;
        Price = price;
    }

    static readonly List<Product> AllProducts = new List<Product>
    {
        new Product(1, "Games Console", "Fun for all the family", 199.99m),
            new Product(2, "MP3 player", "Listen to your favourite tunes on the move", 99.99m),
            new Product(3, "Smart Phone", "Apps, apps, apps", 399.99m),
            new Product(4, "Digital Photo frame", "All your photos in one beautiful frame", 49.99m),
            new Product(5, "E-book reader", "Take your favourite books on the move with you", 149.99m),
            new Product(6, "DVD Box Set", "All of season one plus exclusive extras", 39.99m)
    };

    public static List<Product> GetAllProducts()
    {
        return AllProducts;
    } 
```

**控制器**

```
public ActionResult Index()
    {
        return View();
    }

    public ActionResult ExcelExport()
    {
        var products = Product.GetAllProducts();

        var grid = new GridView();
        grid.DataSource = from p in products
                          select new
                          {
                              ProductName = p.Name,
                              SomeProductId = p.Id
                          };
        grid.DataBind();

        Response.ClearContent();
        Response.AddHeader("content-disposition", "attachment; filename=MyExcelFile.xls");

        Response.ContentType = "application/excel";

        StringWriter sw = new StringWriter();

        HtmlTextWriter htw = new HtmlTextWriter(sw);

        grid.RenderControl(htw);

        Response.Write(sw.ToString());

        Response.End();

        return Content("tr");
    } 
```

**看法**

```
@{
ViewBag.Title = "Index";
}
@using (Html.BeginForm())
{

<div id="rptExport" style="display: none">
</div>

<input type="button" id="ExportExcelButton" value="Export To Excel" onclick="ExportExcel()" />
}

<script type="text/javascript">
//global cache false
$.ajaxSetup({ cache: false });

function ExportExcel() {
    //block the UI until the request is rendered
    $.blockUI({ message: '<h3><b><img src="@Url.Content("~/content/images/loading.gif")" />Please wait while Processing</b></h3>' });

    $('#rptExport').load('@Url.Action("ExcelExport", "Home")', function (data) {
        var urlFile = "";
        if (data != '') {
            debugger;
            //unblock the UI     
            $.unblockUI();
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:01:21.610

您不能使用 AJAX 下载文件。
您需要使用常规页面请求。

# unix - 从 Windows 2008 Server 到 AIX Unix Box 的 RSH 和 REXEC

> ID：12162102
> 
> 赞同：1
> 
> 时间：2012-08-28T14:59:28.807
> 
> 标签：unix, windows-server-2008, rsh, rexec

有谁知道如何从 Windows 2008R2 服务器上的脚本调用 RSH 和 REXEC 命令到 AIX Unix 机器 - 这些命令在 2003 服务器下工作，安装了 unix 插件，但不是 2008

# gwt - GWTTestCase 文件上传

> ID：12162111
> 
> 赞同：0
> 
> 时间：2012-08-28T14:59:51.433
> 
> 标签：gwt, file-upload

我正在尝试编写一些 gwt 测试用例来使用 FileUpload 和 FormPanel 上传文件。

我的代码（未经测试）看起来像：

```
@Test
public void testImportXml() {
    delayTestFinish(10000);
    FormPanel fileForm=new FormPanel();
    fileForm.setEncoding(FormPanel.ENCODING_MULTIPART);
    fileForm.setMethod(FormPanel.METHOD_POST);
    fileForm.setAction(GWT.getModuleBaseURL()+"/xmlupload");
    URL myFile=this.getClass().getClassLoader().getResource("myfile.xml");
    // FileUpload uploadField; ??

    fileForm.addSubmitHandler(new SubmitHandler() {
        @Override
        public void onSubmit(SubmitEvent event) {
            logger.info("submit handler pushed");
        }
    });
    fileForm.submit();
} 
```

我找不到将 FileUpload 配置为使用“myFile”的方法。我知道这样做是出于浏览器安全的原因，但在编写测试用例时这是一个巨大的障碍。

是否有一种方法可以为 gwt 中的测试用例的 FileUpload 指定文件名？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T16:06:44.410

不。

但是有人可能想知道您实际上要测试的是什么？

*   提交/提交完成处理程序？您最好直接在 FormPanel 上触发事件；您还可以重构您的代码以使用一些 MV* 模式，以便您实际测试的代码不依赖于 GWT 小部件，然后您可以使用 vanilla JUnit 测试。
*   小服务程序？然后不要使用 GWTTestCase，使用 HttpClient 或任何类似的东西，对你的 servlet 发出请求，在服务器中运行（最好作为*集成测试*完成；看看[Arquillian](http://arquillian.org)以使其更容易设置）
*   FormPanel+FileUpload 和 servlet 之间的整个交互？然后不要使用 GWTTestCase，使用 Selenium 驱动浏览器与正在运行的服务器通信（最好作为*集成测试*或*验收测试*完成）

# android - 通过 RFCOMM 传输数据时蓝牙 Android 音频跳 过

> ID：12162119
> 
> 赞同：1
> 
> 时间：2012-08-28T15:00:15.970
> 
> 标签：android, bluetooth

嘿伙计们，我正在处理一件烦人的事情。

当我通过 RFCOMM 通道和连接的 A2DP 发送大量数据时，音频会跳过。我尝试了很多不同的方法，唯一可靠的方法是将延迟发送的数据隔开。我很确定这是一个低级别的 Android 问题，因为它主要发生在 2.3.X 上，但仍然发生在 4.0 上

有没有人见过类似的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T16:33:28.117

A2DP 连接会消耗大部分可用的蓝牙带宽。一旦您开始添加其他 RFCOMM 数据包，您就会占用原本可用于 A2DP 重传的空间，因此您隐藏丢失数据包的能力会降低。如果您的设备正在进行定期页面或查询扫描，其他部分带宽可能会丢失，因此您可能需要确保不会发生这种情况。基本上，我不会对同时运行 A2DP 和 RFCOMM 抱有太多期望，除非您的 RFCOMM 流量非常低。

# c# - Html.ListBox 用于将数据保存到模型

> ID：12162125
> 
> 赞同：0
> 
> 时间：2012-08-28T15:00:28.607
> 
> 标签：c#, asp.net-mvc, razor

标题可能有点尴尬，但很难用一句话来解释。对不起。

无论如何，这就是我试图完成的。

假设有一个`Property`模型类包含`ID`、`Name`和`List`。

我想提供一个`TextBox`for name 属性、`ListBox`for`List`属性以及`TextBox`将`Button`字符串添加到列表中。

```
 ----------
Name     |        | <-textbox
-------- ----------
|item1 |
|...   |
|      | <-listbox
--------
------------ <-textbox for adding
|          | [add] <- button
------------ 
```

当我保存模型时，它应该保存`List`到模型的属性中`Property`。

我尝试了几件事，总是出问题。如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T20:44:19.537

如果您要提供一些您尝试过的代码，我们将能够更好地帮助您 - 我认为这听起来像您想要建模绑定一个`Enumerable<T> eg A List<OfSomething>`？？？

菲尔哈克在这里写了关于这个的博客：

[http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)

它是一个旧帖子，但我认为它仍然是最好的方法？

# java - 从 Apple 脚本运行 Java

> ID：12162127
> 
> 赞同：0
> 
> 时间：2012-08-28T15:00:35.997
> 
> 标签：java, applescript, classpath

我对 Apple 脚本非常陌生，所以请多多包涵。我需要使用 运行一个`.jar`文件`applescript`，它`jar`是不可执行的，所以我调用了`class`like `com.path.to.myClass`。我的 Apple 脚本如下所示 -

```
display alert "You are about to start the image rename process." buttons {"OK", "Cancel"}
set theAnswer to button returned of the result
if theAnswer is "OK" then
    do shell script "java -classpath ./ImageRename_JAVA-1.0.0.jar:. com.mff.image.rename.Main"
else
    say "Exit"
end if 
```

applescript 和`ImageRename_JAVA-1.0.0.jar`都在同一个目录中，但是当我运行脚本时，它给了我一个错误-

```
error "Exception in thread \"main\" java.lang.NoClassDefFoundError: com/mff/image/rename/Main
Caused by: java.lang.ClassNotFoundException: com.mff.image.rename.Main
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)" number 1 
```

我设置`classpath`错了吗？如果是这样，正确的方法是什么？另外，我怎样才能添加更多`jar`的 s `classpath`？

当我从中运行以下命令时，`Terminal`它运行得很好。

```
$ java -classpath ./ImageRename_JAVA-1.0.0.jar:. com.mff.image.rename.Main 
```

我知道它可以用更好的方式完成，`JAR Bundler`但我无法控制`JAR`它由其他人开发。有没有办法可以`JAR`在目录下的应用程序中包含所有 s`YourApplicationName.app/Contents/MacOS/Resources/Java/`并在类路径中使用它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T16:02:38.263

我认为您不能保证 a 中的工作目录是什么`do shell script`，但您可以通过以下方式解决：

```
set scriptPath to the POSIX path of (path to me)
do shell script "SCRIPTDIR=`dirname " & scriptPath & "` ; " ¬
    & "java -classpath $SCRIPTDIR/ImageRename_JAVA-1.0.0.jar:$SCRIPTDIR com.mff.image.rename.Main" 
```

要将额外的 JAR 添加到类路径，您可以利用`java`命令提供的快捷方式，从而以结尾的类路径条目`*`包括给定目录中的所有`.jar`文件。

```
do shell script "java -classpath " ¬
  & "/Applications/Something.app/Contents/Resources/Java/\\* com.example.MyClass" 
```

需要对`*`反斜杠进行转义以保护其不被 shell 扩展，并且反斜杠本身在 AppleScript 字符串文字中时需要进行反斜杠转义，因此`\\*`.

# orchardcms - 在 Orchard 中创建网页

> ID：12162131
> 
> 赞同：0
> 
> 时间：2012-08-28T15:00:54.177
> 
> 标签：orchardcms

我需要在 Orchard 中创建一个“自定义”网页。据我了解，以下是我需要采取的步骤。在我进行这个有点冗长的过程之前，是否有任何我遗漏或可以跳过的步骤？

*   创建模型
*   创建使用上述模型的内容部分和内容部分记录
*   创建一个实现 Display 方法的驱动程序，该方法返回内容部分的“形状”
*   创建形状模板以渲染从上述驱动程序返回的形状
*   创建一个包含内容部分的内容类型
*   创建一个包含内容类型的页面
*   将页面添加到我的网站

此页面是“自定义”的，因为它需要从 Web 服务中提取数据并以交互方式显示它。当用户进行更改时，这些更改将需要发送回 Web 服务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T16:34:09.387

这些是创建内容项的真正步骤。如果您的页面应被视为内容，您可能需要创建一个内容项 - 例如，管理员可以创建、编辑、发布、取消发布并最终删除您的页面。

如果您只想创建一个简单的页面，那么没有什么可以阻止您创建自己的 ASP MVC 控制器。你可以使用 Orchard 的路由为它定义路由，如果你用一个`[Themed]`属性来装饰它，它甚至会继承网站的主题。

# json - index.php 没有接收到主干 Post 发送的 JSON

> ID：12162132
> 
> 赞同：3
> 
> 时间：2012-08-28T15:01:00.093
> 
> 标签：json, backbone.js

我一直在尝试了解 Backbone 如何工作并与后端代码进行通信，但我遇到了无法接收我发送到我的 php 文件的 JSON 的问题。

这是代码：HTML：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link href='http://fonts.googleapis.com/css?family=Abel' rel='stylesheet' type='text/css' />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Understanding Backbone</title>
<style type="text/css">
body { padding: 0; margin: 0; background-color: #fff; }

h2 { font-family: Abel, sans-serif; margin: 0; padding: 0 0 5px 0;}
input { background-color: #ddd; border: 0; }
input:active { background-color: #bbb; }

#new-status { margin: 20px; padding: 20px; background-color: #67A9C3; }
#statuses { margin: 20px; padding: 20px; background-color: #92B456; }

</style>
</head>

<body>

<div id="new-status">
<h2>New monolog</h2>
<form>
    <textarea id="status" name="status"></textarea>
    <br />
    <input type="submit" value="Post" />
</form>
</div>

<div id="statuses">
    <h2>Monologs</h2>
    <ul></ul>
</div>
<script src="js/jquery-min.js"></script>
<script src="js/underscore.js"></script>
<script src="js/backbone.js"></script>
<script src="js/main.js"></script>
</body>
</html> 
```

JS：

```
var Status = Backbone.Model.extend({
    url: 'api/index.php'
});

var Statuses = Backbone.Collection.extend({
    model: Status
});

var NewStatusView = Backbone.View.extend({
    events: {
        "submit form": "addStatus"
    },

    initialize: function(options) {
        this.collection.on("add", this.clearInput, this);
    },

    addStatus: function(e) {
        e.preventDefault();

        this.collection.create({ text: this.$('textarea').val() });
    },

    clearInput: function() {
        this.$('textarea').val('');
    }
});

var StatusesView = Backbone.View.extend({
    initialize: function(options) {
        this.collection.on("add", this.appendStatus, this);
    },

    appendStatus: function(status) {
        this.$('ul').append('<li>' + status.escape("text") + '</li>');
    }
});

$(document).ready(function() {
    var statuses = new Statuses();
    new NewStatusView({ el: $('#new-status'), collection: statuses });
    new StatusesView({ el: $('#statuses'), collection: statuses });
}); 
```

索引.php：

```
<?php

echo(var_dump($_POST));

?> 
```

这是我得到的回应：

数组（0）{}

我一直在为此烦恼，所以请帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T15:43:41.437

在对stackoverflow（awesome community btw）进行了更多研究之后，我发现主干不会直接发送帖子或到达RESTful api，或者任何可能的代码隐藏，而是一组标题。因此，您必须在 $_SERVER 全局变量中查找并找出请求的内容。您将能够在 $_SERVER["REQUEST_METHOD"] 中找到您的请求，然后执行 switch/case 来决定您要对该请求执行什么操作。通过发送的数据（在主干的情况下始终是 JSON 字符串）在 HTTP 正文中，为了将其取出，我使用了 file_get_contents('php://input')，并对 JSON 进行解码，以便 php 可以使用它.

```
<?php 
$requestMethod = $_SERVER["REQUEST_METHOD"];     
switch ($requestMethod) 
{ 
case 'POST': $data = json_decode(file_get_contents('php://input'), true); 
echo $data; 
break; 
} 
?> 
```

@orangewarp，我真的很想在不使用 RESTful php 框架的情况下了解幕后发生的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T13:37:55.630

```
$raw_data = file_get_contents("php://input");
var_dump($raw_data);
if( !empty($raw_data) ){
    $data = @json_decode($raw_data, true);
    if( $data ){
        var_dump($data);
    }
} 
```

# jax-ws - JBoss AS7 中的 JAX-WS，出现强制转换异常

> ID：12162134
> 
> 赞同：0
> 
> 时间：2012-08-28T15:01:09.650
> 
> 标签：jax-ws, jboss7.x

我用 JAX-WS 创建了一个简单的 web 服务，但我期待一个令人讨厌的问题。

我的网络服务代码是这样的：

```
@WebService
public class UpdateList implements IUpdateList {

    public UpdateList() {
    }

    @Override
    public Collection<Long> getFrom(Long version) {
        System.out.println("test");
        return new ArrayList<Long>();
    }

} 
```

我生成了客户端代码`wsimport`并为其创建了一个简单的主代码：

```
public class App {

    public static void main(String[] args) {
        System.out.println(new UpdateListService().getUpdateListPort().getFrom(183L));
    }
} 
```

但是，当我运行它时，我得到了一个无法解释的类转换异常：

```
Exception in thread "main" java.lang.ExceptionInInitializerError
    at com.sun.xml.internal.ws.client.sei.SyncMethodHandler.invoke(Unknown Source)
    at com.sun.xml.internal.ws.client.sei.SyncMethodHandler.invoke(Unknown Source)
    at com.sun.xml.internal.ws.client.sei.SEIStub.invoke(Unknown Source)
    at $Proxy29.getFrom(Unknown Source)
    at com.test.App.main(App.java:8)
Caused by: java.lang.ClassCastException: com.sun.xml.bind.v2.runtime.JAXBContextImpl cannot be cast to com.sun.xml.internal.bind.api.JAXBRIContext
    at com.sun.xml.internal.ws.fault.SOAPFaultBuilder.<clinit>(Unknown Source)
    ... 5 more 
```

然后我才意识到这可能是一些依赖冲突，所以我运行了`mvn dependency:tree`，它很干净，我唯一的 deps 是 hibernate、guava、guice 和 jaxws-rt。（您可以在我的 web 服务示例中看到，它没有使用任何引用的依赖项，但我会尽快解决此问题）。

好吧，完整的清单，供客户使用：

```
+- com.google.guava:guava:jar:13.0:compile
+- com.google.inject:guice:jar:3.0:compile
|  +- javax.inject:javax.inject:jar:1:compile
|  \- aopalliance:aopalliance:jar:1.0:compile
+- log4j:log4j:jar:1.2.17:compile
+- junit:junit:jar:4.10:test
|  \- org.hamcrest:hamcrest-core:jar:1.1:test
+- com.sun.xml.bind:jaxb-impl:jar:2.2.6:compile
+- org.hsqldb:hsqldb:jar:2.2.8:test
+- com.google.inject.extensions:guice-persist:jar:3.0:compile
+- org.hibernate:hibernate-entitymanager:jar:4.1.6.Final:compile
|  +- org.jboss.logging:jboss-logging:jar:3.1.0.GA:compile
|  +- org.hibernate:hibernate-core:jar:4.1.6.Final:compile
|  |  \- antlr:antlr:jar:2.7.7:compile
|  +- org.jboss.spec.javax.transaction:jboss-transaction-api_1.1_spec:jar:1.0.0.Final:compile
|  +- dom4j:dom4j:jar:1.6.1:compile
|  +- org.javassist:javassist:jar:3.15.0-GA:compile
|  \- org.hibernate.common:hibernate-commons-annotations:jar:4.0.1.Final:compile
+- org.hibernate.javax.persistence:hibernate-jpa-2.0-api:jar:1.0.1.Final:compile
+- mysql:mysql-connector-java:jar:5.1.21:compile
\- commons-lang:commons-lang:jar:2.6:compile 
```

和服务：

```
 +- com.sun.xml.ws:jaxws-rt:jar:2.2.6-2:compile
 |  +- javax.xml.ws:jaxws-api:jar:2.2.8:compile
 |  |  +- javax.xml.bind:jaxb-api:jar:2.2.4:compile
 |  |  +- javax.xml.soap:saaj-api:jar:1.3.4:compile
 |  |  +- org.glassfish:javax.annotation:jar:3.1.1:runtime
 |  |  \- javax.jws:jsr181-api:jar:1.0-MR1:runtime
 |  +- com.sun.xml.messaging.saaj:saaj-impl:jar:1.3.18:compile
 |  +- com.sun.xml.stream.buffer:streambuffer:jar:1.4:compile
 |  |  +- javax.xml.stream:stax-api:jar:1.0-2:compile
 |  |  \- javax.activation:activation:jar:1.1:compile
 |  +- org.codehaus.woodstox:woodstox-core-asl:jar:4.1.2:compile
 |  +- org.codehaus.woodstox:stax2-api:jar:3.1.1:compile
 |  +- org.jvnet.mimepull:mimepull:jar:1.8:compile
 |  +- com.sun.xml.ws:policy:jar:2.3.1:compile
 |  |  +- com.sun.xml.txw2:txw2:jar:20110809:compile
 |  |  |  \- relaxngDatatype:relaxngDatatype:jar:20020414:compile
 |  |  \- com.sun.istack:istack-commons-runtime:jar:2.4:compile
 |  +- org.jvnet.staxex:stax-ex:jar:1.7:compile
 |  +- org.glassfish.gmbal:gmbal-api-only:jar:3.1.0-b001:compile
 |  |  \- org.glassfish.external:management-api:jar:3.0.0-b012:compile
 |  \- org.glassfish.ha:ha-api:jar:3.1.8:compile
 +- com.google.guava:guava:jar:13.0:compile
 +- com.google.inject:guice:jar:3.0:compile
 |  +- javax.inject:javax.inject:jar:1:compile
 |  \- aopalliance:aopalliance:jar:1.0:compile
 +- log4j:log4j:jar:1.2.17:compile
 +- junit:junit:jar:4.10:test
 |  \- org.hamcrest:hamcrest-core:jar:1.1:test
 +- com.sun.xml.bind:jaxb-impl:jar:2.2.6:compile
 +- org.hsqldb:hsqldb:jar:2.2.8:test
 +- com.google.inject.extensions:guice-persist:jar:3.0:compile
 +- org.hibernate:hibernate-entitymanager:jar:4.1.6.Final:compile
 |  +- org.jboss.logging:jboss-logging:jar:3.1.0.GA:compile
 |  +- org.hibernate:hibernate-core:jar:4.1.6.Final:compile
 |  |  \- antlr:antlr:jar:2.7.7:compile
 |  +- org.jboss.spec.javax.transaction:jboss-transaction-api_1.1_spec:jar:1.0.0.Final:compile
 |  +- dom4j:dom4j:jar:1.6.1:compile
 |  +- org.javassist:javassist:jar:3.15.0-GA:compile
 |  \- org.hibernate.common:hibernate-commons-annotations:jar:4.0.1.Final:compile
 +- org.hibernate.javax.persistence:hibernate-jpa-2.0-api:jar:1.0.1.Final:compile
 +- mysql:mysql-connector-java:jar:5.1.21:compile
 \- commons-lang:commons-lang:jar:2.6:compile 
```

我结束了这个想法，我的 jboss 中缺少一些配置或 jar 文件。我做了一些研究，但没有找到任何相关的东西。

有人已经通过了这个？有什么建议吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T16:08:42.010

看起来您正在捆绑一个 JAXP 实现，`com.sun.xml.bind:jaxb-impl:jar:2.2.6:compile`. 尝试将范围更改为`<scope>provided</scope>`. 对于`com.sun.xml.ws:jaxws-rt:jar:2.2.6-2:compile`.

事实上，大部分都应该提供。

# oauth - 刷新 OAuth2 访问令牌的正确范例

> ID：12162135
> 
> 赞同：2
> 
> 时间：2012-08-28T15:01:16.727
> 
> 标签：oauth, oauth-2.0, access-token

我正在使用一个使用 OAuth2 的 API，它提供了一个在 3600 秒后过期的访问令牌，并提供了一个刷新令牌。最初，我等待 API 调用以表明访问令牌已过期的方式失败，然后尝试使用刷新令牌刷新访问令牌。当访问令牌过期并且同时进行多个 API 调用（每个调用单独触发刷新并且大多数调用失败）时，这已经成为问题。

3600秒后使用刷新令牌自动刷新访问令牌会更好吗？（或者 3599 秒还是 3601 秒？）我应该使用不同的范例来刷新访问令牌吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:51:18.013

理想情况下，客户端应该有足够的智慧来不使用过期的访问令牌。幸运的是，来自 OAuth AS 令牌端点的响应应包含 expires_in 属性，以确认到期时间为 3600 秒。例如：

```
{"token_type":"Bearer","expires_in":3600,"refresh_token":"p8BPdo01kkjh6fhatclD3wwBEQblm4kL4ctYRVlrHo","access_token":"9XebAAXeu6hQOAiwmOk8vdhRyUFV"} 
```

由于此 JSON 响应是由服务器生成的，因此传输回客户端可能需要一些时间，因此“expires_in”值可能比它看起来的要小。

鉴于此，我建议您在到期前有某种缓冲区（例如 5-10 秒），以自动使用您的刷新令牌来请求新的访问令牌。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-16T07:28:43.553

我可能使用了以下场景。由于访问令牌验证错误会导致访问失败，但这些错误将是最小的。

1.  App1 使用密码授权类型调用令牌 api 并获取访问令牌和刷新令牌对 (accto1/refto1)
2.  App2 在执行启动时也做同样的事情 (accto1/refto1)
3.  当 App1 的访问令牌过期时，他可以通过调用具有刷新令牌授予类型和他现有的刷新令牌 (refto1) 的令牌 api 来执行刷新令牌，他将检索一对新的访问令牌和刷新令牌。(accto2/refto2)
4.  当 App2 在其访问令牌过期时也到达实例时，他还将尝试使用他已经拥有的刷新令牌 (refto1) 授予刷新令牌，但由于该刷新令牌现已过期，他将收到授权错误。

5.  当任何一个应用程序收到此错误时，应用程序需要意识到其他人已刷新令牌，因此此时应用程序需要使用密码授权进行调用以检索新的访问令牌/刷新令牌对。这一次，与示例中一样，App2 还将检索 App1 先前收到的用于其刷新令牌授权的相同访问令牌和刷新令牌对。(accto2/refto2)

# entity-framework - 实体框架Multiple Parent为一个孩子

> ID：12162142
> 
> 赞同：0
> 
> 时间：2012-08-28T15:01:31.740
> 
> 标签：entity-framework, ef-code-first

如何在实体框架中实现具有多个父级的子级？
结果表必须如下：

1.课程：

```
CourseID int identity
CourseTitle nvarchar
.
.
.

OtherColumns as neede 
```

2.课程先决条件：

```
CourseID (FK to Course.CourseID)
PreRequisiteCourseID (FK to Course.CourseID) 
```

或者有没有更好的方法来实现一个子记录的多个父级？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T19:58:44.460

您只需要在子类中引用同一个父类的两个导航属性和 - 可选 - 两个对应的外键属性：

```
public class Course
{
    public int CourseID { get; set; } // PK property
    public string CourseTitle { get; set; }
}

public class CoursePreRequisite
{
    public int CoursePreRequisiteID { get; set; } // PK property

    public int CourseID { get; set; }  // FK property 1
    public Course Course { get; set; } // Navigation property 1

    public int PreRequisiteCourseID { get; set; }  // FK property 2
    public Course PreRequisiteCourse { get; set; } // Navigation property 2
} 
```

如果两个关系中的一个或两个是可选的，则使用`int?`代替`int`外键属性。

如果您使用上面示例中指示的属性名称，则无需配置任何内容。EF 将通过命名约定识别这两个一对多关系。

`Course`如果需要或想要它们，还可以将集合用作实体中的逆属性：

```
public class Course
{
    public int CourseID { get; set; } // PK property
    public string CourseTitle { get; set; }

    public ICollection<CoursePreRequisite> PreRequisites1 { get; set; }
    public ICollection<CoursePreRequisite> PreRequisites2 { get; set; }
} 
```

但是，在这种情况下，您必须指定哪些导航属性对属于一个关系。您可以使用数据注释来执行此操作，例如：

```
 [InverseProperty("Course")]
    public ICollection<CoursePreRequisite> PreRequisites1 { get; set; }
    [InverseProperty("PreRequisiteCourse")]
    public ICollection<CoursePreRequisite> PreRequisites2 { get; set; } 
```

或者使用 Fluent API：

```
modelBuilder.Entity<Course>()
    .HasMany(c => c.PreRequisites1)
    .WithRequired(p => p.Course)      // Or WithOptional
    .HasForeignKey(p => p.CourseID);

modelBuilder.Entity<Course>()
    .HasMany(c => c.PreRequisites2)
    .WithRequired(p => p.PreRequisiteCourse)      // Or WithOptional
    .HasForeignKey(p => p.PreRequisiteCourseID); 
```

# java - 上传时减小图像大小

> ID：12162147
> 
> 赞同：0
> 
> 时间：2012-08-28T15:01:38.017
> 
> 标签：java, php, javascript

上传时是否可以减小图像大小？

上传文件时，大小可以从 2MB 减少到 500kb 或更少吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:05:01.227

当然，它工作正常。我在 PHP 中使用这个类：

```
<?php

    function thumbnail( $img, $source, $dest, $maxw, $maxh ) {      
        $jpg = $source.$img;

        if( $jpg ) {
            list( $width, $height  ) = getimagesize( $jpg ); //$type will return the type of the image
            $source = imagecreatefromjpeg( $jpg );

            if( $maxw >= $width && $maxh >= $height ) {
                $ratio = 1;
            }elseif( $width > $height ) {
                $ratio = $maxw / $width;
            }else {
                $ratio = $maxh / $height;
            }

            $thumb_width = round( $width * $ratio ); //get the smaller value from cal # floor()
            $thumb_height = round( $height * $ratio );

            $thumb = imagecreatetruecolor( $thumb_width, $thumb_height );
            imagecopyresampled( $thumb, $source, 0, 0, 0, 0, $thumb_width, $thumb_height, $width, $height );

            $path = $dest.$img."_thumb.jpg";
            imagejpeg( $thumb, $path, 75 );
        }
        imagedestroy( $thumb );
        imagedestroy( $source );
    }

?> 
```

`imagejpeg( $thumb, $path, 75 );`是上传后您想要多少图像的大小和质量。

调用 PHP 脚本：

```
if( isset( $_FILES['img-content'] ) ) {
    $img = str_replace( " ","_",$_FILES['img-content']['name'] );
    move_uploaded_file( $_FILES['img-content']['tmp_name'], "../../images/content/".$img );
    $source = "../../images/content/";
    $dest = "../../images/thumb/";
    thumbnail( $img, $source, $dest, 480, 400 ); 
```

}

# heroku - Heroku - 启用/禁用每周备份

> ID：12162149
> 
> 赞同：3
> 
> 时间：2012-08-28T15:01:44.663
> 
> 标签：heroku, database-backups

我正在使用免费的 heroku add-on PG Backups 并按照这些[说明](https://devcenter.heroku.com/articles/pgbackups#creating-a-backup)进行操作。我找到了安装应用程序的命令：heroku addons:add pgbackups:auto-week。但是我想知道如何启用/禁用每周备份。

```
heroku addons:add pgbackups:auto-week
Adding pgbackups:auto-week on myProject... failed
 !    pgbackups:plus add-on already added.
 !    To upgrade, use addons:upgrade instead. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:27:40.960

[Postgres 开发中心文章](https://devcenter.heroku.com/articles/database#backups)提到仅对生产数据库启用自动备份（即Crane[层数据库付款计划和更高级别](https://addons.heroku.com/heroku-postgresql)）。也许 PG Backups 插件不会在“Starter”层（即“dev”或“basic”）数据库计划上执行自动备份？

可能值得与 Heroku 支持部门核实，看看是否是这种情况，以及是否需要更新[PG 备份文章。](https://devcenter.heroku.com/articles/pgbackups)

# c# - 如何使用 c# 对 excel 文件中特定标题的所有行求和？

> ID：12162153
> 
> 赞同：1
> 
> 时间：2012-08-28T15:01:50.580
> 
> 标签：c#, excel

我有一张 1 张的 excel 表格。该表在第 1 行有标题。其中一个标题是金额。

我想从该标题中读取所有行，并独立于行数或行数，将其总和，这永远不会相同，放入浮点类型的变量中。

我正在用 c# 做这个。

我打开工作簿，得到活动工作表，然后什么也没有，我被阻止了。

我该怎么做？瑞马丁斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:07:59.783

您可以使用 OleDB 而不是 Excel.Interop

```
string con = @"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=D:\test.xls;" + 
              "Extended Properties='Excel 8.0;HDR=Yes;'";
using(OleDbConnection c = new OleDbConnection(con))
{
    c.Open();
    string selectString = "SELECT SUM(Amount) FROM [Sheet1$]";
    using(OleDbCommand cmd1 = new OleDbCommand(selectString))
    {
       cmd1.Connection = c;
 var result = cmd1.ExecuteScalar();
       Console.WriteLine(result);
    }
 } 
```

此示例使用旧`Microsoft.Jet.OleDB.4.0`提供程序，但同样适用于新提供程序`Microsoft.ACE.OLEDB.12.0`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:07:01.997

看一下这篇文章，您应该能够遍历行并通过将单元格值完全相加来获得总数。

[有关如何检索 excel 单元格值的 MSDN 文章。](http://msdn.microsoft.com/en-us/library/office/ff921204.aspx)

# magento-1.7 - Magento 按自定义属性过滤产品

> ID：12162154
> 
> 赞同：3
> 
> 时间：2012-08-28T15:01:55.573
> 
> 标签：magento-1.7

我想我尝试了所有内容并阅读了所有内容，但是我对在 Magento 中过滤产品集合感到非常困惑。我创建了一个新的产品属性“syncron_state”，但我无法通过此过滤器过滤 product_collection。当我尝试按核心属性进行过滤时，它可以工作，这很清楚。

```
$productsCollection = Mage::getResourceModel('catalog/product_collection')
->addAttributeToFilter('sku', array('eq' => '000001'))
->setCurPage(1)->setPageSize(10)
->load(); 
```

但是，如果我尝试按我的属性进行过滤，我什么也得不到。

```
$productsCollection = Mage::getResourceModel('catalog/product_collection')
->addAttributeToFilter('syncron_state', array('eq' => '1'))
->setCurPage(1)->setPageSize(10)
->load(); 
```

syncron_state 是一个是/否属性，据我所知它在数据库中有一个整数值（但我在过滤中也尝试了真/假和是/否）。

我尝试了所有版本的 addAttributeToFilter 和 AddFieldToFilter。

哦，我正在与 Magento 1.7.0.0 战斗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T10:51:08.773

您的集合`syncron_state`用作过滤器*应该*可以按预期工作，至少对于`syncron_state`设置为 的产品`yes`。

未获得产品的一个可能原因是，您未能将新`syncron_state`属性添加到正确的属性集中（这是必须的）。

另一个可能的原因是，您只是忘记将`syncron_state`至少一个产品的属性设置为`Yes`.

# javascript - &&评价问题

> ID：12162157
> 
> 赞同：6
> 
> 时间：2012-08-28T15:02:17.057
> 
> 标签：javascript, jquery, ecmascript-5

据我所知，逻辑`&&`工作如下

```
var test = false;
var foo = test && 42; 
```

**仅**当第一个条件被评估为时，此代码才会分配`42`给。所以在这个例子中，将保持它的当前值。`foo` **`true``foo`**

 **我想知道为什么这个片段根本不起作用：

```
var test = "";
var foo = test && 42; 
```

现在，从assigned中`foo`获取值。`test`我很困惑。空*字符串*是 Javascript 的*虚假值*之一，那么为什么`&&`操作符会在这种情况下失败呢？

有人可以帮我看看这个规格吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-28T15:03:05.947

你误会了运营商。
`foo = x && y`将*始终*分配`foo`.

`&&`运算符对其最左边的“假”操作数求值。

`false && 42`评估为假；`"" && 42`评估为`""`。

`var foo = test && 42;`分配`false`给`foo`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-28T15:17:49.797

你自己已经回答了你的问题。

```
var foo = test && 42; 
```

`42``foo` **仅当`test`评估为 true**时才会分配给。

因此，如果`test`是空字符串（评估为假），则 42 不会分配给`foo`，`foo`将是空字符串。**

# sql - 通过 sql 日志表找出哪些任务应该已经运行，哪些在给定的时间间隔内实际运行

> ID：12162161
> 
> 赞同：1
> 
> 时间：2012-08-28T15:02:37.530
> 
> 标签：sql, datetime, loops, sql-server-2008-r2

很难将我的问题放在标题中。我正在寻找的是一种查看过去 15 分钟内计划运行哪些任务的方法。

我目前有一个表格，显示任务应该运行的窗口以及它应该在该窗口内启动的频率。但是，我对这种类型的查询没有经验。希望有人可以帮忙。我还应该说我想这样做而不创建额外的表

日程表

```
| taskID | startTime | endTime | everyMinutes |
|________|___________|_________|______________|
| 135467 |    8:00   |  20:00  |      15      |
| 675314 |    7:15   |  13:45  |      30      | 
```

例如，在上表中，如果时间是 9:18，则查询将返回两个任务

```
| taskID | scheduledTime|
|________|______________|
| 135467 |     9:15     |
| 675314 |     9:15     | 
```

好像它是在 9:35 运行的，查询只会返回 1 个结果

```
| taskID | scheduledTime|
|________|______________|
| 135467 |     9:30     | 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T22:51:06.810

您可以使用[数字表](https://stackoverflow.com/questions/10819/sql-auxiliary-table-of-numbers "SQL，数字辅助表")将`Schedule`表扩展为一系列`taskID, scheduledTime`行，然后过滤行以仅返回`scheduledTime`过去 15 分钟内的行：

```
WITH expanded AS (
  SELECT
    s.taskID,
    scheduledTime = DATEADD(MINUTE, s.everyMinutes * n.N, s.startTime)
  FROM Schedule s
  INNER JOIN Numbers n
  ON n.N BETWEEN 0 AND DATEDIFF(MINUTE, s.startTime, s.endTime) / s.everyMinutes
)
SELECT e.*
FROM expanded e
CROSS APPLY (SELECT CAST(GETDATE() AS time)) x (now)
WHERE e.scheduledTime BETWEEN DATEADD(MINUTE, -15, x.now) AND x.now
; 
```

[您可以在 SQL Fiddle](http://sqlfiddle.com/#!3/ba033/7)尝试这个查询，也可以使用它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-28T16:54:17.590

**第 1 点**：您应该使用[cron 作业](http://www.unixgeeks.org/security/newbie/unix/cron-1.html)来安排您的任务，并使用数据库表来保存实际运行的作业的历史记录（开始时间、结束时间、结果等）。这样您可以获得更准确的报告。所有作业都有例外（例如，有些作业不在周末运行，有些不在公共假期运行），因此使用时间表推断运行的作业可能会导致您做出错误的假设。

**第 2 点**：我不建议在数据库中执行此操作。与在数据库中相比，在 C# 或 PHP 中编码更容易，运行速度更快

# sql - 无法在 SQLite3 中创建触发器

> ID：12162162
> 
> 赞同：2
> 
> 时间：2012-08-28T15:02:40.003
> 
> 标签：sql, sqlite, triggers, syntax-error

我在 sqlite3 中创建此触发器 second_loop 时遇到问题：它是更多代码的一部分，但正是这部分给出了错误。当我在数据库上执行代码时，我得到以下信息：**near "CREATE": syntax error**。

我确信触发器内部的部分工作得很好，因为我已经单独测试过了，但是这肯定有其他类型的问题。

请注意，我在同一个 SQL 中有另一个触发器，它工作得很好！

请指教，谢谢

```
CREATE TRIGGER second_loop AFTER UPDATE OF stack_count ON global WHEN NEW.stack_count<>0

BEGIN
 CREATE TEMP TABLE last_row(id INTEGER PRIMARY KEY, unvisited INTEGER DEFAULT 1, predecessor INTEGER DEFAULT 0, discovery INTEGER DEFAULT 0, finish INTEGER DEFAULT 0);

 INSERT INTO last_row
        SELECT *
        FROM nodes
        WHERE id = (SELECT node_id
                   FROM stack
                   ORDER BY oid DESC LIMIT 1);

 UPDATE last_row SET unvisited =0, predecessor = (SELECT parent_id FROM global), discovery = (SELECT time FROM global);

 UPDATE global SET current_id = (SELECT node_id FROM stack WHERE ROWID = (SELECT MAX(ROWID) FROM stack));
 UPDATE global SET time = time + 1;

 DELETE FROM stack WHERE ROWID = (SELECT MAX(ROWID));

 INSERT INTO stack(node_id)
   SELECT DISTINCT edges.target_id
   FROM nodes, edges, global
   WHERE edges.source_id=global.current_id AND nodes.unvisited=1;

  -- update stack count to go to second_loop trigger
  UPDATE global SET stack_count = stack_count + 1;
 END; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T15:54:35.860

根据[语法图](http://www.sqlite.org/lang_createtrigger.html)， SQLite3 的[`CREATE TRIGGER`语句](http://www.sqlite.org/lang_createtrigger.html)不支持嵌入式子语句。`CREATE TEMP TABLE`

# linux - linux系统上的cilk++

> ID：12162164
> 
> 赞同：0
> 
> 时间：2012-08-28T15:02:51.690
> 
> 标签：linux, cilk, cilk-plus

我在使用在 Windows 系统上运行良好但在 linux 系统上运行良好的 cilk++ 程序时遇到了一些问题：

在windows系统上，增加线程数会减少执行时间，而在linux系统上，增加线程数会增加执行时间。

我使用 linux ubuntu 2.6.35-22-generic x86_64 GNU/Linux

我无法理解问题的根源。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T15:12:23.920

没有消息来源，就没有办法知道。可能有一个资源在 Windows 上具有每线程实现，而在 Linux 上具有共享实现。

我建议使用像 Intel 的 VTune/Amplifier 这样的性能分析器来确定您的应用程序将时间花在了哪里。

```
- Barry Tannenbaum
  Intel Cilk Plus Runtime Development 
```

# vb.net - 从另一个组合框填充组合框

> ID：12162169
> 
> 赞同：0
> 
> 时间：2012-08-28T15:03:10.737
> 
> 标签：vb.net

我有两个组合框；一个包含国家列表，另一个包含城市列表。如何设置它，以便当您选择一个国家/地区时，该国家/地区的城市在另一个组合框中可见？

我想这基本上是根据第一个框的选定值为第二个框创建项目集合。

编辑：我正在寻找这样的东西：

```
If cboCountry.Text = "Australia" Then
 cboCity.Collection("Melbourne, "Sydney")
End If 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:50:53.507

将数据加载到`Dictionary(Of String, List(Of String))`包含从国家到城市的映射中。

然后只需在字典中查找所选国家并迭代其值。

这是如何做后半部分的示例。这假设您已经加载了字典数据（显然*不要*硬编码代码中的值）：

```
' As a private Form variable:
Private cities As New Dictionary(Of String, List(Of String))()
' … Load data in Form_Load. 
```

```
' In the citiesCombo.SelectedValueChanged event of the combo box:
cboCity.Items.Clear()
For Each city As var In cities(cboCountry.Text)
    cboCity.Items.Add(city)
Next 
```

如果你只是想用一些玩具数据来测试它，这里有一些：

```
Private cities As New Dictionary(Of String, List(Of String))() From { _
    {"England", New List(Of String)() From {"London", "Darthmouth", "Oxford", "Cambridge"}}, _
    {"Wales", New List(Of String)() From {"Cardiff", "Swansea"}}, _
    {"Scotland", New List(Of String)() From {"Edinburgh", "Glasgow", "Aberdeen"}} _
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:16:47.597

编辑

继续你的编辑，我已经改变了代码，这应该是你要找的:)

将其放入组合框 1 选定值更改事件中，并且应该可以工作。

```
 Private Sub cboCountry_SelectedValueChanged(sender As System.Object, e As System.EventArgs) Handles cboCountry.SelectedValueChanged

            If cboCountry.Text = "England" Then
               cboCity.Items.Add("London")
            End If

          End Sub 
```

# java - 使用 JRE 与 JDK

> ID：12162170
> 
> 赞同：0
> 
> 时间：2012-08-28T15:03:10.940
> 
> 标签：java

> **可能重复：**
> [JDK和JRE有什么区别？](https://stackoverflow.com/questions/1906445/what-is-the-difference-between-jdk-and-jre)

您使用其中一个来对抗另一个的主要原因是什么？什么时候应该使用 JRE，什么时候应该使用 JDK？做出决定时考虑的因素是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T15:04:39.207

为了*运行*Java 代码，您需要一个 JRE：Java 运行时环境。

为了*开发*Java 代码，您需要一个 JDK：一个 Java 开发工具包。JDK*包括*一个 JRE。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T15:05:05.440

JRE 不包含编译器，因此要开发 Java 应用程序，您需要带有编译器和其他开发工具的 JDK。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T15:11:50.250

JDK 包含 Java 编译器，它将您的 Java 代码编译为中间字节码，然后在 JVM 中执行。JRE 将 JVM 和几个可由您的程序调用的标准 java 类库捆绑在一起。为了编译 java 程序，您需要 JDK，但要运行 java 程序，您只需要在系统上安装 JRE。

# apache - 从子域重定向而不更改 URL

> ID：12162173
> 
> 赞同：0
> 
> 时间：2012-08-28T15:03:20.210
> 
> 标签：apache, .htaccess, web

我想在不更改 URL 的情况下使用 .htaccess 文件重定向子域。但是想不通。

前任。我想转

```
http://foo.domain.com 
```

进入

```
http://www.domain.com/users/foo/dashboard.php 
```

我生成了一个脚本来执行此操作，但 URL 没有保留在[http://foo.domain.com](http://foo.domain.com)

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^(.*)\.domain\.com [NC]
RewriteRule ^ http://www.domain.com/users/%1/dashboard.php [L] 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:50:35.143

试试这个（假设所有子域都指向根目录）：

```
RewriteEngine on
RewriteBase /
RewriteCond %{HTTP_HOST} ^(.*)\.domain\.com$ [NC]
RewriteRule ^.*$ users/%1/dashboard.php [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:07:04.447

你正在做的 htaccess 它只是说“如果你找到这个，做一个完整的重定向到那个 url”

做这个：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^(.*)\.domain\.com [NC]
RewriteRule ^ dashboard.php?domain=%1 [L, QSA] 
```

它应该可以工作（相对地，移动到仪表板在服务器目录结构中的任何位置）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-21T18:26:10.707

代理标志 [P] 可以解决问题：

```
<IfModule mod_rewrite.c>
Options +FollowSymLinks
Options +Indexes

RewriteEngine On
RewriteBase /

RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteCond %{HTTP_HOST} ^(.*)\.example\.org$ [NC]
RewriteRule http://example.org/users/%1/dashboard.php [P,NC,QSA]
</IfModule> 
```

# ruby-on-rails - nil:NilClass 的 Omniauth-facebook 未定义方法“切片”。SessionsController#create 中的 NoMethodError

> ID：12162174
> 
> 赞同：2
> 
> 时间：2012-08-28T15:03:22.657
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我完全按照[本教程](http://railscasts.com/episodes/360-facebook-authentication)进行操作，但出现此错误：

```
NoMethodError in SessionsController#create
undefined method `slice' for nil:NilClass
Rails.root: /Users/raybesiga/Documents/Sites/foodie
Application Trace | Framework Trace | Full Trace
app/models/user.rb:29:in from_omniauth'
app/controllers/sessions_controller.rb:3:increate' 
```

但是我的`user.rb`文件如下：

```
class User < ActiveRecord::Base
  # Include default devise modules. Others available are:
  # :token_authenticatable, :confirmable,
  # :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :name, :email, :password, :password_confirmation, :remember_me,     :provider, :uid
  validates_presence_of :name
  validates_uniqueness_of :name, :email, :case_sensitive => false
  # attr_accessible :title, :body

  def self.from_omniauth(auth)
    where(auth.slice(:provider, :uid)).first_or_initialize.tap do |user|
      user.provider = auth.provider
      user.uid = auth.uid
      user.name = auth.info.name
      user.oauth_token = auth.credentials.token
      user.oauth_expires_at = Time.at(auth.credentials.expires_at)
      user.save!
    end
  end
end 
```

我的`sessions_controller.rb`文件如下：

```
class SessionsController < ApplicationController
        def create
                user = User.from_omniauth(env["ominauth.auth"])
                # session[:user_id] = user.user_id
                session[:user_id] = user.id
                redirect_to root_url
        end

        def destroy
                session[:user_id] = nil
                redirect_to root_url
        end
end 
```

知道为什么我会收到此错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:13:25.157

您在会话控制器中拼写`env['omniauth.auth']`错误。你把`env['ominauth.auth']`

# asp-classic - 会话和 XMLHTTP

> ID：12162175
> 
> 赞同：1
> 
> 时间：2012-08-28T15:03:26.260
> 
> 标签：asp-classic

我在同一台服务器上有两个 asp 页面。第一个使用查询字符串信息和会话信息动态生成 XML。第二个使用 XMLHTTP 对象读取第一个并使用 XML 数据执行操作。

但是，我的问题是 XMLHTTP 请求是在服务器端完成的。因此，当生成 xml 时，客户端的会话变量是不可访问的。

如何使生成 XML 的页面接收会话变量？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:18:01.860

您尝试做的事情有很多问题，尤其是它可能导致繁忙的服务器完全锁定。

这是另一种方法。

在您的解决方案中添加第三页。该页面仅包含一个返回 XML DOMDocument 的函数。此函数包含原始 xml 生成页面中的所有逻辑，但将 XML 构建到 DOM 中（您可能已经准备好了吗？）。

现在您的原始页面只包含这个新功能页面，调用该功能并将 DOM 发送到响应：

```
 <!-- #include file="xmlFunction.asp" -->
 <%
      Response.ContentType = "text/xml"
      Response.CharSet = "UTF-8"
      GenerateXml().Save Response
 %> 
```

您的客户页面现在可以看到这个

```
 <!-- #include file="xmlFunction.asp" -->
 <%
    . . .

    Dim dom: Set dom = GenerateXml()
    ''# Code that uses the XML in the dom.

 %> 
```

不需要额外的“对自己的请求”，因此没有潜在的锁定。由于 xmlFunction.asp 中的代码作为原始请求的一部分运行，因此可以访问相应的 Session 对象。

# java - 如何通过远程接口代理访问有状态会话 bean？

> ID：12162177
> 
> 赞同：1
> 
> 时间：2012-08-28T15:03:28.333
> 
> 标签：java, ejb, ejb-3.0, openejb

我有一个使用[OpenEjb](http://openejb.apache.org)的 @LocalClient 注释（嵌入式容器）并使用 @EJB 注释注入 EJB 的测试用例：

```
@LocalClient
public class MyTestCase {

    @EJB
    private BoxDao boxDao;

    ...   

} 
```

BoxDao 是一个远程 EJB 接口。现在，为了测试，我需要访问 BoxDao 的实现 BoxDaoBean 的一些内部状态，它是一个有状态会话 bean。我在 BoxDaoBean 中创建了一个受保护的方法，它公开了所需的内部状态，但在我的测试用例中我还没有找到访问它的方法，因为注入的 BoxDao 是一个远程接口代理（不能转换为 BoxDaoBean）。

有没有办法在测试用例中访问远程接口BoxDao后面的有状态会话bean？如果解决方案是特定[于 OpenEjb](http://openejb.apache.org)的，则无关紧要。

**更新：**很遗憾，我们不能使用 EJB 3.1 特定的解决方案，因为我们有几个 EJB 3.0 项目正在运行。使用 Proxy.getInvocationHandler(boxDao)，我可以通过 StatefulEjbObjectHandler 访问 OpenEjb 容器。是否可以通过这种方式访问​​有状态 bean？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T21:15:40.340

您也可以尝试`BoxDaoBean`公开一个`@LocalBean`接口。`@WebService`单个 EJB 可以从、`@Local`、`@Remote`、 JAX-RS 等公开几乎无限数量的视图。

只需像这样更新您的bean：

```
@Stateful
@LocalBean
public class BoxDaoBean implements BoxDao {
   //...
} 
```

然后将另一个字段添加到您的测试中：

```
@LocalClient
public class MyTestCase {

    @EJB
    private BoxDao boxDao;

    @EJB
    private BoxDaoBean boxDaoBean;

    ...   

} 
```

# php - Shell 访问 Apache 用户在 PHP 中创建的文件

> ID：12162181
> 
> 赞同：0
> 
> 时间：2012-08-28T15:03:40.020
> 
> 标签：php, apache, shell, permissions, console

我的网站在上传文件时使用所有者 apache:apache 创建文件，如下所示：

```
 drwxr-xr-x    2 apache apache   4096 Aug 28 14:07 .
drwxr-xr-x 9118 apache apache 233472 Aug 28 14:07 ..
-rw-r--r--    1 apache apache  41550 Aug 28 14:07 468075_large.jpg
-rw-r--r--    1 apache apache  26532 Aug 28 14:07 468075_medium.jpg
-rw-r--r--    1 apache apache  50881 Aug 28 14:07 468075_original.jpg
-rw-r--r--    1 apache apache   4316 Aug 28 14:07 468075_small.jpg 

```

现在，我尝试在 Plesk 中拥有该域的用户在同一个文件夹中创建一个文件，但我的权限被拒绝。

如何让 apache 和 shell 用户都拥有对该文件的权限？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:37:11.793

如果该 shell 用户不是 apache 而是在同一个组中，则需要使文件夹组可写。

```
chown 755 . 
```

就像现在一样，它不允许除了 apache 之外的任何人添加文件夹。或者，你可以尝试用php来做fopen？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T15:30:41.283

您必须创建一个组并将您的 Plesk 和 Apache 用户放入其中。比你必须在你的文件上 chmod -R g+rwX 。

并将系统的默认 umask 设置为 002。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T13:30:51.933

感谢您的回答，但我最终决定运行一个 cron 作业，该作业将使用 wget 从网站打开一个 php 脚本。

这样，它就是已经有权访问文件的同一个 apache 用户。我这样做基本上是因为我有大量文件，大约 300GB 的图像，所以我认为应用所有新权限需要很多时间。

# eclipse - 在任何 IDE 中每次 SVN 提交后自动填充 changelog.txt

> ID：12162184
> 
> 赞同：2
> 
> 时间：2012-08-28T15:03:45.917
> 
> 标签：eclipse, svn, ide, phpstorm, changelog

在尝试搜索有关“**使用 IDE****动态更改`changelog.txt`**文件”的一些信息后，我没有发现任何可以帮助我找到答案的信息。

想象一下，我使用`Eclipse PHP`or对许多文件（PHP 环境）进行了一些更改`JetBrains PHPStorm 3+`，并且我想将它们提交到`svn repository`. 是否可以将这些 IDE 中的任何一个配置为`changelog.txt`使用信息（日期、SVN 注释等）以预定义格式动态填充文件？

提前感谢您提供任何指向答案的信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T15:59:32.353

不知道有任何插件会自动执行此操作，但您可以使用命令行 svn 工具编写脚本（Linux 上默认安装 svn 实用程序；在 Windows 上，您可以使用 CollabNet SVN 或类似工具）。您可以提取 svn 日志并以您想要的格式重定向到 changelog.txt。

您也可以使用 pysvn 模块在 python 中执行此操作。

# html - 样式定义列表与定义顶部的术语水平

> ID：12162185
> 
> 赞同：0
> 
> 时间：2012-08-28T15:03:48.530
> 
> 标签：html, css, stylesheet

我有一段代码，比如说

```
<dl>
   <dt>term 1</dt>
   <dd>My data</dd>
   <dt>term 1</dt>
   <dd>My data</dd>
   <dt>term 1</dt>
</dl> 
```

使用 css(3)，我将如何实现将它们排列起来以使顺序像这样？

```
Definition    Definition    ......
Term          Term 
```

感谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:13:18.590

如果它们具有固定的宽度和高度，或者如果它们不需要换行到下一行，则应该可以通过一些技巧来实现：

[http://jsfiddle.net/GolezTrol/hN34S/](http://jsfiddle.net/GolezTrol/hN34S/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:11:33.260

如果没有额外的包装元素，就无法做到这一点。这是一个非常好的样式定义列表站点：http: [//www.maxdesign.com.au/articles/definition/](http://www.maxdesign.com.au/articles/definition/)

# facebook-graph-api - 如何获得持久的 Facebook Access Token？

> ID：12162188
> 
> 赞同：8
> 
> 时间：2012-08-28T15:03:56.790
> 
> 标签：facebook-graph-api

主要目标：如何获得对 Facebook 应用程序具有无限有效性的访问令牌？

**背景资料**

我们有一个名为 MyApp 的 FB 应用程序，其设置如下：

*   MyApp 被授权与我们的 facebook 应用程序进行交互
*   MyApp 有权管理我们的页面 (manage_pages)
*   MyApp 有权访问 Insights (read_insights)

我们的目标是自动提取洞察数据，例如每晚一次。

**尝试使用 oauth 生成的应用令牌**

1.  获取属于MyAPP的APP_ACCESS_TOKEN

    graph.facebook.com/oauth/access_token?client_id=YOUR_APP_ID&client_secret=YOUR_APP_SECRET&grant_type=client_credentials

    废弃令牌示例：328467452729456598|Wn2Gt69Ofg5ySdOGa3TsP2p4R

2.  使用 APP_ACCESS_TOKEN 获取每个页面的 PAGE_ACCESS_TOKEN graph.facebook.com/me/accounts?access_token=APP_ACCESS_TOKEN

3.  使用 PAGE_ACCESS_TOKEN 获取页面的 Insights 数据：graph.facebook.com/YOUR_APP_ID/insights?access_token=PAGE_ACCESS_TOKEN

我的问题是我从步骤 1 获得的 APP_ACCESS_TOKEN 似乎缺少令牌的用户部分，导致运行步骤 2 时出现以下错误：

```
 "message": "An active access token must be used to query information about the current user.",
 "type": "OAuthException",
 "code": 2500 
```

**尝试使用从 Graph Explorer API 令牌中检索到的令牌**

如果我使用通过 Graph API Explorer (https://developers.facebook.com/tools/explorer) 获得的 APP_ACCESS_TOKEN，我会得到一个带有明显更长的用户部分的令牌。如果我在第 2 步和第 3 步中使用此令牌，我将获得正确的数据，但所有令牌仅在 2 小时内有效，随后我无法将其用于自动检索洞察数据。

**尝试将短期令牌换成长期令牌**

按照本指南中概述的步骤：[https](https://developers.facebook.com/roadmap/offline-access-removal/#page_access_token) ://developers.facebook.com/roadmap/offline-access-removal/#page_access_token ，我尝试将短期令牌换成长期令牌。

如果我尝试交换从 oauth 进程获得的令牌，则会收到错误消息：

```
 "message": "No user access token specified",
  "type": "OAuthException",
  "code": 1 
```

如果我在交换方法中使用从 Graph explorer 手动获取的令牌，我可以让其他步骤也能正常工作，但是这个新令牌能持续多久？如果令牌在 x 天后或其他一些事件之后过期，我仍然会面临以编程方式获取初始令牌的问题（而不是从 Graph Explorer 手动获取）。

那么有谁知道我怎样才能获得一个长期有效的、自动检索的令牌来解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T20:14:47.797

此 shell 脚本尝试帮助生成访问令牌：

[https://github.com/dncohen/fb_token](https://github.com/dncohen/fb_token)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-28T15:46:23.227

在第 2 步中，您必须使用用户的`access_token`来访问`/accounts`API 端点。您不能在此处使用应用访问令牌。

你应该做的是：

1.  从 Facebook 获取用户的访问令牌
2.  将 access_token 交换为长期存在的令牌
3.  调用`/accounts`以获取长期页面访问令牌
4.  使用长期令牌访问页面洞察力，直到它过期
5.  重复步骤 1-4。

# c# - 通过 TCP 发送枚举值

> ID：12162193
> 
> 赞同：1
> 
> 时间：2012-08-28T15:04:19.487
> 
> 标签：c#, tcp, enums, bytearray, byte

作为“协议”的一部分，我有一个`Enum`在客户端和服务器之间共享的 ，它指示如何处理其余数据

客户：

```
byte[] outStream = Encoding.UTF8.GetBytes((int)Shared.CommandType.ClientJoin + "sometext");
serverStream.Write(outStream, 0, outStream.Length);
serverStream.Flush(); 
```

在服务器端：

```
string dataFromClient = null;
byte[] bytesFrom = new byte[1024];
NetworkStream networkStream = tcpclient.GetStream();
int bytesread = networkStream.Read(bytesFrom, 0, bytesFrom.Length);

Byte[] commandBytes = new Byte[4];
Array.Copy(bytesFrom, commandBytes, 4);
dataFromClient = Encoding.UTF8.GetString(bytesFrom, 4, bytesread - 4);

//test values
int receivedcommand = BitConverter.ToInt32(commandBytes, 0);
int actualcommand = (int)Shared.CommandType.ClientJoin; 
```

但是，收到的“值”（测试中的 1634222896）与实际值（0）大不相同

我确定我做错了什么，与字节数组拆分有关，但我一生都看不到什么

有任何想法吗？

（与往常一样，如果有比上述更好的实施方法，我愿意接受建议:)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:19:17.753

```
byte[] outStream = Encoding.UTF8.GetBytes((int)Shared.CommandType.ClientJoin + "sometext"); 
```

变成

```
byte[] outStream = Encoding.UTF8.GetBytes(0+ "sometext");

byte[] outStream = Encoding.UTF8.GetBytes("0sometext"); 
```

接收后`commandBytes`会有字节表示 `{'0','s','o','m'}`

并且`BitConverter.ToInt32(commandBytes, 0);`只会制作一个 4 字节数组的整数表示，其所有成员都具有非零值（因为都是 ascii 文本）。

# python - 使用 GAE 批量加载程序时出错：无法下载种类统计信息

> ID：12162194
> 
> 赞同：2
> 
> 时间：2012-08-28T15:04:21.503
> 
> 标签：python, google-app-engine

当我尝试使用 bulkloader 时，我得到以下输出：

```
[INFO    ] Logging to bulkloader-log-20120828.105614
[INFO    ] Throttling transfers:
[INFO    ] Bandwidth: 250000 bytes/second
[INFO    ] HTTP connections: 8/second
[INFO    ] Entities inserted/fetched/modified: 20/second
[INFO    ] Batch Size: 10
[INFO    ] Opening database: bulkloader-progress-20120828.105614.sql3
[INFO    ] Opening database: bulkloader-results-20120828.105614.sql3
[INFO    ] Connecting to sortexpr.appspot.com/_ah/remote_api
[ERROR   ] Unable to download kind stats for all-kinds download.
[ERROR   ] Kind stats are generated periodically by the appserver
[ERROR   ] Kind stats are not available on dev_appserver. 
```

我可以在 GAE 仪表板中查看我的数据。我有一种有两个字段，两个字段都包含字符串。似乎可能的一件事是尚未生成类型统计信息。有人知道它们的生成频率吗？

我已经在各个地方看到了有关此问题的一些讨论，但还没有找到实际的解决方案。有任何想法吗？批量加载器解决方案失败，是否有其他方法可以将我的数据从谷歌服务器转移到我的计算机上？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T14:15:42.050

它现在可以工作了，大约 24 小时后。这与不经常生成此类统计信息的问题是一致的。

# sql - SQL选择一定数量的行

> ID：12162196
> 
> 赞同：1
> 
> 时间：2012-08-28T15:04:26.297
> 
> 标签：sql, range, rows, database-agnostic

您好，我需要一个 SQL 查询语句来让我从“开始”到“结束”行。

例如：

一个包含许多项目的网站，其中第 1 页仅选择项目 1-10，第 2 页有 11-20 等等。

我知道如何使用 Microsoft SQL Server 和 MySQL 做到这一点，但我需要一个独立于平台的实现。：/

我有一个用于 ID 的增量行，但是当我选择时，删除中间会弄乱结果

```
WHERE ID > number AND ID < othernumber 
```

当然

如果不将整个数据库提取到 ResultSet，这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:23:58.247

我认为您最安全的选择是使用`BETWEEN`运营商。我相信它适用于 Oracle/MySQL/MSSQL。

```
WHERE ID BETWEEN number AND othernumber 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T05:01:33.583

关于您的评论“我只是想在前 100 个 ID 消失的情况下，我将不得不进一步检查，直到有东西要获取”，您可能想考虑*不要*实际上从数据库中删除东西，而是添加一个标志，例如“活跃”或类似的东西到你的桌子上，这样你就可以避免像你现在试图避免的那种情况。另一种方法是您现在所在的位置，必须在过滤器中找到最大和最小行

# javascript - Javascript。当前 AJAX 停止后运行 AJAX 流

> ID：12162197
> 
> 赞同：1
> 
> 时间：2012-08-28T15:04:29.380
> 
> 标签：javascript, ajax, jquery

所以我有一个简单的javascript，当用户点击更多时，它会从数据库中加载更多评论。现在我想扩展这个脚本，让它在开始让用户查看评论之前先填充 SQL 数据库。我觉得我在正确的轨道上，但我无法让它发挥作用。

首先是可以工作的代码。

```
$(function() {

$('.load_more').live("click",function() {

    var photoid = document.getElementById('photoid').value;
    var lastid = document.getElementById('lastid').value;

    if(lastid!='end'){

        $.ajax({
        type: "POST",
        url: "/more_comments_ajax.php",
        data: {
            photoid : photoid,
            lastid : lastid
        },
        beforeSend:  function() {
            $('a.load_more').html('<img src="/images/loading.gif" />');//Loading image during the Ajax Request

        },
        success: function(html){//html = the server response html code
            $("#more").remove();//Remove the div with id=more 
            $("div#updates").append(html);//Append the html returned by the server .

        }
        });

    }
    return false;
});
}); 
```

现在我觉得应该可以这样扩展。

```
$(function() {
        $.ajax({
        type: "POST",
        url: "/populate_sql.php",

        beforeSend:  function() {
            $('a.load_more').html('<img src="/images/loading.gif" />');//Loading image during the Ajax Request
        },

    sucess: $('.load_more').live("click",function() {

    var photoid = document.getElementById('photoid').value;
    var lastid = document.getElementById('lastid').value;

    if(lastid!='end'){

        $.ajax({
        type: "POST",
        url: "/more_comments_ajax.php",
        data: {
            photoid : photoid,
            lastid : lastid
        },
        beforeSend:  function() {
            $('a.load_more').html('<img src="/images/loading.gif" />');//Loading image during the Ajax Request

        },
        success: function(html){//html = the server response html code
            $("#more").remove();//Remove the div with id=more 
            $("div#updates").append(html);//Append the html returned by the server .

        }
        });

    }
    return false;
});
});
}); 
```

我在哪里失去它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T20:05:08.933

感谢你的回答。这不完全是我所需要的，但它给了我一个想法，对我有用的解决方案是 2 个 javascripts 一起工作。如果有人需要类似的东西，我会把代码留在这里。

```
<script type="text/javascript">
jQuery(function($){
var pid = '<?php echo $ids['0']; ?>';
$.ajax({
type: "POST",
url: "/prepare_sql.php",
data: "pid="+ pid,
beforeSend:  function() {
        $('div#updates').html('<img src="/images/loading.gif" />');//Loading image during the Ajax Request

    },
    success: function(html) {
        $("div#updates").replaceWith(html);
    }
});
});
</script>

<script type="text/javascript">
$('.load_more').live("click",function() {

var photoid = document.getElementById('photoid').value;
var lastid = document.getElementById('lastid').value;

if(lastid!='end'){

    $.ajax({
    type: "POST",
    url: "/more_comments_ajax.php",
    data: {
        photoid : photoid,
        lastid : lastid
    },
    beforeSend:  function() {
        $('a.load_more').html('<img src="/images/loading.gif" />');//Loading image during the Ajax Request

    },
    success: function(html){//html = the server response html code
        $("#more").remove();//Remove the div with id=more 
        $("div#updates").append(html);//Append the html returned by the server .

    }
    });

}
return false;
});

</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T15:32:42.230

您可以使用此功能。我以前用过，效果很好。在第一个回调接收到然后它发送第二个请求。

```
(function($) 
    {
        var ajaxQueue = $({});
        $.ajaxQueue = function(ajaxOpts) 
        {
            var oldComplete = ajaxOpts.complete;
            ajaxQueue.queue(function(next)
            {
                ajaxOpts.complete = function() 
                {
                    if (oldComplete) oldComplete.apply(this, arguments);
                    next();
                };
                $.ajax(ajaxOpts);
            });
        };
    })(jQuery); 
```

像普通的ajax一样使用它。样本：

```
 $.ajaxQueue({ url: 'x.php', data:{x:x,y:y}, type: 'POST', 
        success: function(respond) 
        {
            .....
        }
        }); 
```

因此您可以检查是否有来自第一个 ajax 的回调，然后发送第二个请求。希望它可以帮助你。

# c# - C# 自定义表单在退出时抛出 COMException

> ID：12162203
> 
> 赞同：3
> 
> 时间：2012-08-28T15:04:40.783
> 
> 标签：c#, exception, error-handling, ms-office, add-in

我创建了一个自定义表单，其中包含几个按钮和一个文本框。

此自定义表单由我在 Microsoft Outlook 加载项上创建的单击事件按钮打开，我正在处理该加载项附加到“功能区”。（不确定这是否重要，这里没问题）。

在 windows 窗体上，第一个按钮只是将文本文件的内容保存到磁盘。

另一个按钮尝试关闭表单。在此按钮单击事件中，我尝试了以下两行，分开和一起

this.Close(); 和 this.Dispose();

当我使用此按钮或表单退出（位于 windows 窗体右上角的“x”）时，我收到以下错误，

COMException 未被 HRESULT 中的用户异常处理：0x800A01A8

抛出此错误时，它会将我带到以下方法的“Connect.cs”文件，

```
public void OnBeginShutdown(ref System.Array custom)
        {

            this.toolbarButton.Delete(System.Reflection.Missing.Value);
            this.toolbarButton = null;

        } 
```

我不确定如何开始对此进行故障排除。我做了相当多的研究，但不幸的是没有找到太多。我确信问题可能在于我创建了一个没有经验的自定义表单，并且有一些我没有做过或不知道的“内务管理”或“最佳实践”。

有人对此有见识吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:16:11.950

我在这里猜测了一下，但是 HResult 的`COMException`意思是[Object Required](https://stackoverflow.com/questions/1563406/what-is-error-code-0x800a01a8-coming-out-of-excel-activex-call)，所以，当你调用[`CommandBarButton.Delete`](http://msdn.microsoft.com/en-us/library/office/aa432758%28v=office.12%29.aspx)两件事之一时是错误的。

您已经处理了按钮实例，或者您应该传递`true`或传递`false`给`Delete`调用。

该按钮在从工具栏中删除之前不应被释放，并且当它被释放时，您可能需要执行 a[`Marshal.ReleaeComObject`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.releasecomobject.aspx)以正确取消引用它。

# java - 如何将 log4j 默认初始化与 configureAndWatch() 结合起来？

> ID：12162205
> 
> 赞同：4
> 
> 时间：2012-08-28T15:04:50.970
> 
> 标签：java, logging, log4j

一些**Log4j**配置器有一个`configureAndWatch()`方法，它*启动一个线程*来监视用于配置的文件（`XML`文件或`properties`文件）并在文件*更改时**触发*重新配置。

 *但是，如果您依赖`Log4j` *默认初始化*过程，您将永远没有机会调用`configureAndWatch()`. 您甚至不知道用于配置的文件（它甚至可能不是文件。）

是否有一种获得*`configureAndWatch()`*样式行为的好方法，允许动态更改日志配置，同时仍使用*默认初始化*过程？我假设您的配置 URL 最终解析为可以观看的文件，因为另一台服务器上的 URL 可能不是您希望每*60 秒*提取一次的内容。

（我看到这个方法在*Java EE*`configureAndWatch()`环境中是不安全的， 因为是单独的线程，我看到一些应用服务器有自己的机制来查看配置文件，但是我现在正在处理的程序没有运行在*Java EE*中。）*`log4j`*

 *** * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-30T15:26:25.327

我之前已经放弃了答案中的所有内容，现在重新开始，因为我更好地理解了你想要什么。

以下段落描述了 log4j 用来确定 log4j 配置文件名的真实顺序。此代码尝试遵循这些规则。

[http://logging.apache.org/log4j/1.2/manual.html#defaultInit](http://logging.apache.org/log4j/1.2/manual.html#defaultInit)

它确定要使用的 log4j 配置文件，然后使用它找到的文件设置 PropertyConfigurator。这仅在文件位于文件系统上时才有效。如果文件在 jar 中或在远程 HTTP URL 上，它将不起作用。

```
 String prop = System.getProperty("log4j.configuration");
    if (prop == null) prop = "log4j.properties";
    URL log4jConfig = Loader.getResource(prop);
    if (log4jConfig.getProtocol().equalsIgnoreCase("file")) {
        PropertyConfigurator.configureAndWatch(log4jConfig.getFile().substring(1), 10000);
    }
    else {
        // cannot monitor if file changed because URL is not a file
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T15:49:46.670

> 但是，如果您依赖 Log4j***默认初始化过程***，您将永远没有机会调用 configureAndWatch()。您甚至不知道用于配置的文件（它甚至可能不是文件。）

您已经发布了一些我已经在[[1]](https://stackoverflow.com/a/12206797/1082681)和[[2]](https://stackoverflow.com/a/12213782/1082681)中回答的相关问题，所以这个答案是建立在其他人的解释之上的。同样，我正在使用 AspectJ：

**示例应用程序类：**

```
import org.apache.log4j.Logger;

public class Log4jDemo {
    private static Logger logger = Logger.getLogger("scrum-master.de");

    public static void main(String[] args) throws InterruptedException {
        while (true) {
            logger.info("Log message");
            Thread.sleep(2000);
        }
    }
} 
```

**方面捕获默认 URL 并将其移交给`configureAndWatch`：**

```
import java.io.File;
import java.net.URISyntaxException;
import java.net.URL;
import org.apache.log4j.helpers.OptionConverter;
import org.apache.log4j.LogManager;
import org.apache.log4j.PropertyConfigurator;
import org.aspectj.lang.SoftException;

public aspect Log4jAspect {
    after(URL defaultURL) returning :
        within(LogManager) &&
        cflow(staticinitialization(LogManager)) &&
        call(* OptionConverter.selectAndConfigure(URL, ..)) &&
        args(defaultURL, ..)
    {
        try {
            PropertyConfigurator.configureAndWatch(new File(defaultURL.toURI()).getAbsolutePath(), 2000);
        } catch (URISyntaxException e) {
            throw new SoftException(e);
        }
    }
} 
```

我使用 Eclipse 对其进行了测试，在*log4j.properties*`-Dlog4j.configDebug=true`中将输出通道从`System.log`（Eclipse 控制台中的黑色）更改为`System.err`（红色，此处不可见），并且效果很好。在日志输出中，您还可以看到检测到文件更改后重新配置的调试信息：

 *```
log4j: Trying to find [log4j.xml] using context classloader sun.misc.Launcher$AppClassLoader@f4a24a.
log4j: Trying to find [log4j.xml] using sun.misc.Launcher$AppClassLoader@f4a24a class loader.
log4j: Trying to find [log4j.xml] using ClassLoader.getSystemResource().
log4j: Trying to find [log4j.properties] using context classloader sun.misc.Launcher$AppClassLoader@f4a24a.
log4j: Using URL [file:/C:/Dokumente%20und%20Einstellungen/Robin/Eigene%20Dateien/java-src/dummy2/bin/log4j.properties] for automatic log4j configuration.
log4j: Reading configuration from URL file:/C:/Dokumente%20und%20Einstellungen/Robin/Eigene%20Dateien/java-src/dummy2/bin/log4j.properties
log4j: Parsing for [root] with value=[debug, stdout].
log4j: Level token is [debug].
log4j: Category root set to DEBUG
log4j: Parsing appender named "stdout".
log4j: Parsing layout options for "stdout".
log4j: Setting property [conversionPattern] to [%d{ABSOLUTE} %5p %c{1}:%L - %m%n].
log4j: End of parsing for "stdout".
log4j: Setting property [target] to [System.err].
log4j: Parsed "stdout" options.
log4j: Finished configuring.
log4j: Parsing for [root] with value=[debug, stdout].
log4j: Level token is [debug].
log4j: Category root set to DEBUG
log4j: Parsing appender named "stdout".
log4j: Parsing layout options for "stdout".
log4j: Setting property [conversionPattern] to [%d{ABSOLUTE} %5p %c{1}:%L - %m%n].
log4j: End of parsing for "stdout".
log4j: Setting property [target] to [System.err].
log4j: Parsed "stdout" options.
log4j: Finished configuring.
17:48:20,944  INFO de:10 - Log message
17:48:22,944  INFO de:10 - Log message
17:48:24,944  INFO de:10 - Log message
17:48:26,944  INFO de:10 - Log message
log4j: Parsing for [root] with value=[debug, stdout].
log4j: Level token is [debug].
log4j: Category root set to DEBUG
log4j: Parsing appender named "stdout".
log4j: Parsing layout options for "stdout".
log4j: Setting property [conversionPattern] to [%d{ABSOLUTE} %5p %c{1}:%L - %m%n].
log4j: End of parsing for "stdout".
log4j: Setting property [target] to [System.out].
log4j: Parsed "stdout" options.
log4j: Finished configuring.
17:48:28,944  INFO de:10 - Log message
17:48:30,944  INFO de:10 - Log message
17:48:32,944  INFO de:10 - Log message
17:48:34,944  INFO de:10 - Log message
log4j: Parsing for [root] with value=[debug, stdout].
log4j: Level token is [debug].
log4j: Category root set to DEBUG
log4j: Parsing appender named "stdout".
log4j: Parsing layout options for "stdout".
log4j: Setting property [conversionPattern] to [%d{ABSOLUTE} %5p %c{1}:%L - %m%n].
log4j: End of parsing for "stdout".
log4j: Setting property [target] to [System.err].
log4j: Parsed "stdout" options.
log4j: Finished configuring.
17:48:36,944  INFO de:10 - Log message
17:48:38,944  INFO de:10 - Log message 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T15:59:01.037

在使用默认记录器和附加程序之前，我已经这样做了。您将不得不编写一个单独的处理程序来观察属性文件的修改。当发生更改时，只需重置您的记录器并重新添加附加器设置：

```
/**
 * Setup log4j appender.
 */
public static void setupLog4jAppender(Class appender) {
    getLogger();

    String rootLogger=(String)props.get("log4j.rootLogger");
    rootLogger+=",appname";
    getProps().setProperty("log4j.rootLogger", rootLogger);

    getProps().put("log4j.appender.appname", appender.getName());  // Our custom appender
    getProps().put("log4j.appender.appname.layout", "org.apache.log4j.PatternLayout"); 
    //See: http://logging.apache.org/log4j/docs/api/org/apache/log4j/PatternLayout.html
    getProps().put("log4j.appender.appname.layout.ConversionPattern", "%d{ABSOLUTE} %5p %c{1}:%L - %m%n");

    LogManager.resetConfiguration();
    PropertyConfigurator.configure(getProps());
} 
```****

# bash - 仅按月份名称和日期排序。重击

> ID：12162210
> 
> 赞同：2
> 
> 时间：2012-08-28T15:05:11.670
> 
> 标签：bash, sorting

您好正在尝试按月和日对该列表进行排序。不能直截了当。任何指针？

列表示例：

```
Jul 23 Drive :NTFS (Windows 31.6 GB/29.4 GiB) Details : Mounted /dev/sdc1 (Read-Write, label "FreeAgent GoFlex Drive", NTFS 3.1)
Jul 30 Drive :NTFS (Windows 31.6 GB/29.4 GiB) Details : Mounted /dev/sdb1 (Read-Write, label "HP USB FD", NTFS 3.1)
Aug 2 Drive :NTFS (Windows 31.6 GB/29.4 GiB) Details : Mounted /dev/sdb1 (Read-Write, label "WINPART", NTFS 3.1)
Jul 24 Drive :EXT (Linux) Details : EXT3-fs (sdc1)
Jul 25 Drive :EXT (Linux) Details : EXT3-fs (sdb1)
Jul 27 Drive :EXT (Linux) Details : EXT4-fs (sdb2)
Aug 2 Drive :EXT (Linux) Details : EXT3-fs (sdb1)
Aug 2 Drive :EXT (Linux) Details : EXT4-fs (sdb1) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-28T15:08:43.663

如果您的版本`sort`支持它：

```
sort -k1,1M -k2,2n 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-09T09:50:08.093

在外国计算机上工作时，我们必须在对此类数据进行排序之前设置语言：

```
LC_ALL=C sort -k1,1M -k2,2n file.txt 
```

# batch-file - 从带有空格的字符串中批量删除日期和时间戳

> ID：12162213
> 
> 赞同：0
> 
> 时间：2012-08-28T15:05:18.113
> 
> 标签：batch-file

我正在制作一个程序，它可以自动备份文件，最多存储五个文件，并且可以选择恢复五个文件中的任何一个。备份文件时，它会添加格式为 YYYYMMDD_HHMMSS_filename.ext 的日期和时间戳。为了恢复文件，必须先剪掉日期戳。我目前用来切断文件开头的日期戳的方法如下。

```
set VAR=%VAR:~16%
echo %VAR% 
```

问题是，如果备份的文件名为“20120825_140343_file name.txt”，上述方法将只返回“file”，省略空格后的任何内容。需要保留文件名中的空格，以便使用它们的程序识别它们。

tl；博士我需要将字符串 20120825_140343_file name.txt 剪切成“file name.txt”，但我的方法只返回“file”。

如果分隔符或其他东西有帮助，我可以用不同的字符分隔日期戳和文件名，IE 20120825_140343-file-name.txt

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T15:41:13.447

您的方法虽然不雅且不灵活，但应该有效。这告诉我您没有将整个文件名存储在`VAR`. 这就是为什么`%var:~16%`只有结果`file`，而不是`file name.txt`。我假设你`VAR`在某处这样分配：

```
SET VAR=%1 
```

您需要执行以下操作：

```
SET VAR=%1 %2 
```

或者在调用批处理文件时在文件名周围插入双引号，然后`var`像这样设置以删除引号：

```
SET VAR=%~1 
```

这应该足以让您的批次工作。

==================================================== ==

但是，为了回答您实际提出的问题，我将向您展示一种从中提取“文件名.txt”的方法，`var`即使前缀字符多于甚至少于 16 个也将起作用。

使用`for /f`语句，指定第三个标记，下划线作为分隔符。这是一个独立的例子。（要从命令行运行，请更改`%%x`为`%x`.

```
SET VAR=20120825_140343_file name.txt
for /f "tokens=3 delims=_" %%x in ("%VAR%") do set VAR=%%x
ECHO %VAR% 
```

请记住，如果您不修复代码以确保**变量**`VAR`包含整个文件名，则此解决方案将无法解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:12:09.517

你试过这个吗？

```
set VAR="%VAR:~16%" 
```

# spring - 在 Spring 中使用 MOXy JAXB 生成 JSON 输出

> ID：12162216
> 
> 赞同：2
> 
> 时间：2012-08-28T15:05:23.793
> 
> 标签：spring, jaxb, eclipselink, moxy

我需要编组 json 和 xml 输出。但是，如何在 Spring 中使用 MOXy JAXB 生成 JSON 输出？我可以生成 xml 文件，如示例所示：[http ://wiki.eclipse.org/EclipseLink/Examples/MOXy/Spring/JAXBDynamicOXM](http://wiki.eclipse.org/EclipseLink/Examples/MOXy/Spring/JAXBDynamicOXM)

该文档没有任何输出 json 的示例。我知道我可以使用 JAXB Marshaller 通过设置 jaxb 属性来生成 json 输出。如何使用 MOXy/Spring/JAXB 做同样的事情？

感谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:41:28.647

**注意：** 我是[**EclipseLink JAXB (MOXy)**](http://www.eclipse.org/eclipselink/moxy.php)负责人，也是[**JAXB (JSR-222)**](http://jcp.org/en/jsr/detail?id=222)专家组的成员。

以下答案基于 MOXy wiki 中的示例：

*   [http://wiki.eclipse.org/EclipseLink/Examples/MOXy/Spring/JAXBDynamicOXM](http://wiki.eclipse.org/EclipseLink/Examples/MOXy/Spring/JAXBDynamicOXM)

**eclipselink-oxm.xml**

通常 JAXB/MOXy 与静态域模型一起使用。在您排列的示例中，没有真正的模型，所有元数据都是通过 MOXy 的元数据文件提供的。

```
<?xml version="1.0" encoding="US-ASCII"?>
<xml-bindings xmlns="http://www.eclipse.org/eclipselink/xsds/persistence/oxm" package-name="example.gettingstarted">
    <java-types>
        <java-type name="Customer">
            <xml-root-element/>
            <java-attributes>
                <xml-element java-attribute="name" type="java.lang.String" xml-path="personal-info/name/text()" />
                <xml-element java-attribute="address" type="example.gettingstarted.Address" xml-path="contact-info/address" />
                <xml-element java-attribute="phoneNumbers" type="example.gettingstarted.PhoneNumber" container-type="java.util.ArrayList" xml-path="contact-info/phone-number" />
            </java-attributes>
        </java-type>
        <java-type name="PhoneNumber">
            <java-attributes>
                <xml-attribute java-attribute="type" type="java.lang.String"/>
                <xml-value java-attribute="value" type="java.lang.String"/>
            </java-attributes>
        </java-type>
        <java-type name="Address">
            <xml-root-element/>
            <java-attributes>
                <xml-element java-attribute="street" type="java.lang.String" xml-path="street/text()" />
                <xml-element java-attribute="city" type="java.lang.String" xml-path="city/text()" />
            </java-attributes>
        </java-type>
    </java-types>
</xml-bindings> 
```

**jaxb.properties**

要将 MOXy 与动态模型一起使用，您需要指定与正常不同的 jaxb.properties 文件：

```
javax.xml.bind.context.factory=org.eclipse.persistence.jaxb.dynamic.DynamicJAXBContextFactory 
```

**演示**

在下面的示例中，我们将 XML 文档转换为动态模型，然后将其编组为 JSON。请注意，上下文路径（本例中为“forum12162216”）必须对应于包含 jaxb.properties 文件的包名称。JSON 绑定通过`"eclipselink.media-type"`在`Marshaller`.

```
package forum12162216;

import java.io.File;
import java.util.*;

import javax.xml.bind.*;

import org.eclipse.persistence.dynamic.DynamicEntity;
import org.eclipse.persistence.jaxb.JAXBContextProperties;
import org.eclipse.persistence.jaxb.MarshallerProperties;

public class Demo {

    public static void main(String[] args) throws Exception {
        Map<String, Object> properties = new HashMap<String, Object>(1);
        properties.put(JAXBContextProperties.OXM_METADATA_SOURCE, "forum12162216/eclipselink-oxm.xml");
        JAXBContext jc = JAXBContext.newInstance("forum12162216", Demo.class.getClassLoader(), properties);

        Unmarshaller unmarshaller = jc.createUnmarshaller();
        File xml = new File("src/forum12162216/customer.xml");
        DynamicEntity customer = (DynamicEntity) unmarshaller.unmarshal(xml);

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.setProperty(MarshallerProperties.MEDIA_TYPE, "application/json");
        marshaller.marshal(customer, System.out);
    }

} 
```

**客户.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<customer>
    <personal-info><name>Jane Doe</name></personal-info>
    <contact-info>
        <address>
          <city>My Town</city>
          <street>123 Any Street</street>
        </address>
        <phone-number type="work">613-555-1111</phone-number>
        <phone-number type="cell">613-555-2222</phone-number>
    </contact-info>
</customer> 
```

**输出**

```
{
   "customer" : {
      "personal-info" : {
         "name" : "Jane Doe"
      },
      "contact-info" : {
         "address" : {
            "street" : "123 Any Street",
            "city" : "My Town"
         },
         "phone-number" : [ {
            "type" : "work",
            "value" : "613-555-1111"
         }, {
            "type" : "cell",
            "value" : "613-555-2222"
         } ]
      }
   }
} 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2011/08/binding-to-json-xml-geocode-example.html](http://blog.bdoughan.com/2011/08/binding-to-json-xml-geocode-example.html)

# javascript - preventDefault() 对我不起作用

> ID：12162217
> 
> 赞同：1
> 
> 时间：2012-08-28T15:05:25.813
> 
> 标签：javascript, jquery, preventdefault

为什么这会拒绝工作？
HTML 的东西

```
<div id="nav-bar">  
  <ul>  
    <li>  
      <span>  
        <a href="contact.html">Contact</a>  
      </span>  
    </li>  
  </ul>  
</div> 
```

Javascript 的东西

```
$('div#nav-bar').filter('a').click(function(event){
    event.preventDefault();
}); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-28T15:06:35.493

过滤器仅过滤已选择的内容。在你的情况下，`#nav-bar`元素。

你需要这个：

```
$('div#nav-bar a').click(function(event){
        event.preventDefault();
    }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T15:09:07.927

`filter` is the wrong method to use here. you should either use `find` to look for elements in a selection:

```
$('div#nav-bar').find('a')... 
```

or simply combine that into one selector:

```
$('div#nav-bar a')... 
```

after you've fixed that, your `preventDefault` will actually get applied and work, theres nothing wrong with that piece of code directly.

# php - 安全的班级建设

> ID：12162223
> 
> 赞同：3
> 
> 时间：2012-08-28T15:05:37.570
> 
> 标签：php, sql, security, oop, xss

以这种方式调用`__construct()`登录或注册课程是否安全：

```
function __construct(PDO $DBH, $_POST['1'], $_POST['2'])
{
    $this->_user=$_POST['1'];
    $this->_pass=$_POST['2'];
    $this->_DBH=$DBH;
} 
```

我想稍后在这个类中清理用户输入，我不确定我的代码是否适合 SQL 注入或 XSS，因为类是用原始 POST 输入构建的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T15:08:25.320

如果您知道您清理/使用准备好的语句（即原始 POST 数据未按原样插入到查询中），则可以这样做。

事实上，如果你使用准备好的语句，你根本不需要清理你的输入（对于 SQL，如果你要将数据显示为 HTML，它仍然需要这样清理）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-28T15:12:56.517

将未经清理的数据从一个变量复制到另一个变量不会产生任何影响。这不是 SQL 注入/XSS 的意义所在。

*这是关于在使用*这些变量时应用适当的转义（或者更确切地说，避免不转义）。只需使用准备好的语句，就可以大大降低 SQL 注入的风险；不过，转义输出以防止 XSS 仍然是必要的 :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T15:09:51.073

不解析用户输入绝不是一个好主意。每当用户输入内容时，您都应该检查输入。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-28T15:10:42.650

我总是`htmlentities($value, ENT_QUOTES);`，只是为了安全起见。

使用准备好的语句，永远不要相信用户输入。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-28T15:11:08.327

这不是您应该担心注入攻击的地方。SQL 注入预防通常需要大量的清理**输入**；XSS 预防通常相当于各种形式的**输出**编码。这些都不一定与数据的内部表示（变量本身的值）相关。

正如其他人所提到的，使用准备好的语句（[PDO](http://www.php.net/manual/en/book.pdo.php)和[PDOStatement](http://www.php.net/manual/en/class.pdostatement.php)）将自动执行必要的 SQL 注入转义。但最终，由于[适当的转换会根据您使用数据的方式而有所不同](https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet#Why_Can.27t_I_Just_HTML_Entity_Encode_Untrusted_Data.3F)，因此**您通常应该在使用时进行这种缓解**。

# facebook - 分享内容的 Facebook 权限

> ID：12162225
> 
> 赞同：0
> 
> 时间：2012-08-28T15:05:51.173
> 
> 标签：facebook, permissions

我正在构建一个应用程序，显示 Facebook 上 2 个朋友的“共享”内容。

例如，两个用户都被标记的照片。

我希望任何一个用户都能够与他们的朋友分享结果内容。

这确实意味着，如果您不是其中一位用户的朋友，您可能仍然可以看到他们“拥有”的内容，无论他们针对该内容设置了何种隐私设置（因为您的朋友已经共享了联合内容）。

是否有扩展内容隐私的权限？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:42:25.883

无法扩展或更改用户帐户上的隐私设置。虽然您可以更改他们通过您的应用共享的内容的权限，但您无法更新已通过您的应用共享的内容的设置 - 只有用户可以控制。

此外，用户的最低隐私设置将始终是您可以使用的最高隐私设置。例如，如果用户将墙帖设置为“朋友”，则您的应用不能将内容发布为“公开”。您将能够在您的应用程序中使用“朋友”或更低版本。

# php - 不一致的致命错误：超过 30 秒的最大执行时间

> ID：12162227
> 
> 赞同：0
> 
> 时间：2012-08-28T15:06:03.107
> 
> 标签：php

我有一个 php 表单，用户向我显示他们收到了一个致命错误：

```
Maximum execution time of 30 seconds exceeded in C:\Program Files\Apache2.2\htdocs\eeallparts\registration.php on line 282\. 
```

奇怪的是，他们再次重新提交了表单，并且表单按照应该将数据插入数据库的方式工作，因此这不是一个一致的错误。我在表单上收到了很多提交（其中相当一部分是垃圾邮件），所以我知道该表单通常有效，但这个随机错误显然困扰着我。

我去了 282 行，我唯一看到的是：

```
if(!$insertContact_query = mssql_query($sql)) { 
```

我阅读了一些与此相关的其他线程，这些线程建议查看[设置的时间限制](http://www.php.net/manual/en/function.set-time-limit.php)。如果查询只需要太长时间，查询实际上不会总是超时而不是定期超时吗？我让用户在表单中重新提交了相同的信息，并且第二次成功了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:13:02.197

时间限制不包括在任何外部数据源上花费的时间，例如查询数据库所需的时间。

> set_time_limit() 函数和配置指令 max_execution_time 只影响脚本本身的执行时间。在确定脚本运行的最长时间时，不包括在脚本执行之外发生的任何活动所花费的时间，例如使用 system() 的系统调用、流操作、数据库查询等。在测量时间是真实的 Windows 上，情况并非如此。

如果查询返回大型数据集，它可能只是在处理集合期间超时。如果可能，请使用 php 配置文件来指示瓶颈。

# iphone - Parse.com - 如何一次加载 PFQueryTableViewController 中的所有图像？

> ID：12162231
> 
> 赞同：2
> 
> 时间：2012-08-28T15:06:11.163
> 
> 标签：iphone, ios, parse-platform

在[Parse 的 AnyPic 示例应用程序](https://www.parse.com/tutorials/anypic)中，每个表格单元格中的照片只有在您滚动到它们并等待几秒钟时才会被下载。

有没有办法让应用程序一次下载 PFQueryTableViewController 中的所有图像，这样用户就不必在每张照片上暂停来加载它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T17:21:06.267

您可以在 tableView:cellForRowAtIndexPath:object: 中调用 [cell.imageView loadInBackground] 来加载图像，而无需等待表格停止。

如果您想下载所有图像而不需要滚动表格，您可以在 objectDidLoad 中进行。只需遍历 self.objects 并获取 PFFile，然后为每个文件调用 getDataInBackground 以启动下载。它们将被保存到磁盘，如果在您滚动表格时可用，它们应该会立即加载。

# graphics - 如何以编程方式从实时视频中捕获静止图像

> ID：12162232
> 
> 赞同：1
> 
> 时间：2012-08-28T15:06:12.060
> 
> 标签：graphics, directx, video-capture

当我尝试截取桌面的屏幕截图时，我发现 Windows Media Player 窗口的区域是空的，里面什么都没有，我用谷歌搜索了一段时间，发现大多数视频播放器使用覆盖表面来提高性能，而覆盖表面不能被捕获，所以有些想法说要禁用 DDraw 加速，这样你就可以从实时视频中抓取静止图像，但是当播放器启动时，它已经使用了硬件加速，即使我禁用了硬件加速，它在我重新启动播放器之前不会生效，我的问题是：如何在不禁用 ddraw 加速的情况下从实时视频中捕获图像？或者如何在不重新启动视频播放器的情况下使设置（禁用硬件加速）工作？

*   我不会用我的程序播放视频，我只想在第三方播放器（如 Windows Media Player 或 Real player 等）播放时拍摄静止图像......
*   我想以编程方式执行此操作，例如通过 C/C++ 和 DirectX，所以我不想使用任何现有的软件或工具
*   无论使用哪个播放器，我的程序都应该捕获它，我知道有些工具可以做到这一点，比如[CapTrue](http://www.captrue.com/download.html)和[腾讯 qq](http://en.wikipedia.org/wiki/Tencent_QQ)，所以我认为可以做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:08:40.693

A workaround can be to use vlc to play your file. It gives a screenshot option in it directly.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:16:46.823

AFAIK，这是 WMP 中的一个有意的“功能”，用于保护。如果您需要 WMP，那么您需要一个不错的屏幕抓取工具。不幸的是，我认识的[hypersnap](http://www.hyperionics.com/hsdx/)不是免费的。

如果你只想要一个帧的屏幕截图，VLC 是你的朋友，就像@zdd 说的那样。

# php - Wordpress home.php 重复内容？

> ID：12162234
> 
> 赞同：0
> 
> 时间：2012-08-28T15:06:19.793
> 
> 标签：php, wordpress

我有点像 Wordpress 菜鸟，但试图将我的 HTML/CSS 主题实现到 WP 中，但我偶然发现了一个奇怪的错误......每次我添加另一个帖子时，home.php 页面都会在页面结束后复制自己:o 这是我的 home.php 的 HTML/PHP 代码，这将是我的主页：

```
<?php 
    get_header();
?>      
        <!-- WRAPPER START -->
        <section id="wrapper">
            <?php 
                if(have_posts()):
                    while(have_posts()):
                        the_post();
            ?>
            <!--  start dynamic part -->
            <!-- NEWS START -->

            <div id="slider">       
                <article>
                    <h2>
                        <a href="<?php the_permalink();?>"><?php the_title(); ?></a>
                    </h2>

                    <p class="m-post-info">
                        Posted by <a href="<?php the_permalink();?>"><?php the_author(); ?></a> on 
                        <?php the_date('d-m-Y'); ?> |
                         <a href="<?php the_permalink();?>"><?php comments_number( 'no comment', 'one comment', '% comments' ); ?></a>
                    </p>

                    <div>
                        <?php the_content(); ?> 
                    </div>

                    <a id="arrow-left" href="#" title="Previous"></a>
                    <a id="arrow-right" href="#" title="Next"></a>
                </article>
            </div>

            <!-- NEWS END -->

            <!-- MAIN CONTENT START-->

            <section id="main-content">

                <!-- 3COLUMN LAYOUT START -->

                <div id="column-1">
                    <h3>
                        POPULAR ARTICLES
                    </h3>
                    <article class="news-article">
                        <header>
                            <h4>
                                 <a href="<?php the_permalink();?>"><?php the_title(); ?></a>
                            </h4>
                            <p class="post-info">
                                Posted by <a href="<?php the_permalink();?>"><?php the_author(); ?></a> in on <?php the_date('d-m-Y'); ?> |  <a href="<?php the_permalink();?>"><?php comments_number( 'no comment', 'one comment', '% comments' ); ?></a>
                            </p>
                        </header>
                        <img src="<?php echo get_template_directory_uri() ?>/images/image-small.png" title="Riots" alt="Example Image 1" width="75" height="75" />
                        <div class="post-text">
                             <?php the_excerpt(); ?>
                        </div>
                    </article>
                    <article class="news-article">
                        <header>
                            <h4>
                                 <a href="<?php the_permalink();?>"><?php the_title(); ?></a>
                            </h4>
                            <p class="post-info">
                                Posted by <a href="<?php the_permalink();?>"><?php the_author(); ?></a> in on <?php the_date('d-m-Y'); ?> |  <a href="<?php the_permalink();?>"><?php comments_number( 'no comment', 'one comment', '% comments' ); ?></a>
                            </p>
                        </header>
                        <img src="<?php echo get_template_directory_uri() ?>/images/image-small.png" title="Riots" alt="Example Image 1" width="75" height="75" />
                        <div class="post-text">
                             <?php the_excerpt(); ?>
                        </div>
                    </article>
                </div>

                <div id="column-2">
                    <h3>
                        RECENT COMMENTS
                    </h3>

                    <div class="comment">
                        <?php
                        $comments = get_comments('status=approve&number=3');
                          foreach($comments as $comment) :?>
                          <?php $my_id = $comment->comment_post_ID ; $post_id_comms = get_post($my_id); $title = $post_id_comms->post_title;?> 
                        <p class="user">
                            <?php echo($comment->comment_author);?> <span class="text-decoration">says</span><br />
                           </p>
                         <p class="user-text">
                            <?php echo($comment->comment_content);?><br />
                        </p>
                        <?php endforeach;?>
                    </div>
                </div>

                <div id="column-3">
                    <h3>
                        LIFESTREAM
                    </h3>
                    <article class="news-article">
                        <header>
                            <h4>
                                 <a href="<?php the_permalink();?>"><?php the_title(); ?></a>
                            </h4>
                            <p class="post-info">
                                Posted by <a href="<?php the_permalink();?>"><?php the_author(); ?></a> in on <?php the_date('d-m-Y'); ?> |  <a href="<?php the_permalink();?>"><?php comments_number( 'no comment', 'one comment', '% comments' ); ?></a>
                            </p>
                        </header>
                        <img src="<?php echo get_template_directory_uri() ?>/images/image-small.png" title="Riots" alt="Example Image 1" width="75" height="75" />
                        <div class="post-text">
                             <?php the_excerpt(); ?>
                        </div>
                    </article>
                    <article class="news-article">
                        <header>
                            <h4>
                                 <a href="<?php the_permalink();?>"><?php the_title(); ?></a>
                            </h4>
                            <p class="post-info">
                                Posted by <a href="<?php the_permalink();?>"><?php the_author(); ?></a> in on <?php the_date('d-m-Y'); ?> |  <a href="<?php the_permalink();?>"><?php comments_number( 'no comment', 'one comment', '% comments' ); ?></a>
                            </p>
                        </header>
                        <img src="<?php echo get_template_directory_uri() ?>/images/image-small.png" title="Riots" alt="Example Image 1" width="75" height="75" />
                        <div class="post-text">
                             <?php the_excerpt(); ?>
                        </div>
                    </article>
                </div>

                <!-- 3COLUMN LAYOUT END -->

                <!-- SIDEBAR START -->

                <aside id="tab-lists">
                    <?php if(!dynamic_sidebar('telerik-sidebar')): ?>
                    <div>
                        <h5 id="tab1">
                            <span>recent posts</span>
                        </h5>
                        <ul>
                            <li>
                                <a href="#">Pellentesque tincidunt, diam eget accumsan</a>
                            </li>
                            <li>
                                <a href="#">Pellentesque tincidunt, diam eget accumsan</a>
                            </li>
                            <li>
                                <a href="#">Pellentesque tincidunt, diam eget accumsan</a>
                            </li>
                            <li>
                                <a href="#">Pellentesque tincidunt, diam eget accumsan</a>
                            </li>
                            <li>
                                <a href="#">Pellentesque tincidunt, diam eget accumsan</a>
                            </li>
                            <li>
                                <a href="#">Pellentesque tincidunt, diam eget accumsan</a>
                            </li>
                        </ul>
                    </div>
                    <?php endif; ?>
                    <?php if(!dynamic_sidebar('telerik-sidebar2')): ?>
                    <div>
                        <h5 id="tab2">
                            <span>recent posts</span>
                        </h5>

                        <ul>
                            <li>
                                <a href="#">Pellentesque tincidunt, diam eget accumsan</a>
                            </li>
                            <li>
                                <a href="#">Pellentesque tincidunt, diam eget accumsan</a>
                            </li>
                            <li>
                                <a href="#">Pellentesque tincidunt, diam eget accumsan</a>
                            </li>
                            <li>
                                <a href="#">Pellentesque tincidunt, diam eget accumsan</a>
                            </li>
                            <li>
                                <a href="#">Pellentesque tincidunt, diam eget accumsan</a>
                            </li>
                            <li>
                                <a href="#">Pellentesque tincidunt, diam eget accumsan</a>
                            </li>
                        </ul>
                    </div>
                    <?php endif; ?>
                </aside>    

                <!-- SIDEBAR END -->

                <!-- BIG POST START -->
                <div id="big-post">
                    <h3>
                        RECENT POSTS
                    </h3>
                    <article>
                        <header>
                            <h2>
                                <a href="<?php the_permalink();?>"><?php the_title(); ?></a>
                            </h2>
                            <p class="post-info">
                                Posted by <a href="<?php the_permalink();?>"><?php the_author(); ?></a> in on <?php the_date('d-m-Y'); ?> | <a href="<?php the_permalink();?>"><?php comments_number( 'no comment', 'one comment', '% comments' ); ?></a>
                            </p>
                        </header>
                        <img src="<?php echo get_template_directory_uri() ?>/images/image-big.png" alt="Picture" title="Example Image 2" width="214" height="214" />
                        <div class="post-text">
                            <?php the_content(); ?>  
                        </div>
                    </article>
                </div>
                <!-- BIG POST END -->

            </section>

            <!-- MAIN CONTENT END -->
        <!-- END DYNAMIC PART -->
            <?php 
                endwhile;
                endif;
            ?>
        </section>

        <!-- WRAPPER END -->

<?php 
    get_footer();
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:13:27.017

您已经（几乎）在[循环](http://codex.wordpress.org/the_loop)中获得了整个页面，因此对于每个帖子，它都会重复所有内容。在您想结束帖子之后
关闭，而不是在我们页面的末尾。`while`

您需要在以下情况后停止它：`<!-- NEWS END -->`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:16:36.613

我不明白你自己复制的意思。

```
<article class="news-article">
    <header>
        <h4>
            <a href="<?php the_permalink();?>"><?php the_title(); ?></a>
        </h4>
        <p class="post-info">
            Posted by <a href="<?php the_permalink();?>"><?php the_author(); ?></a> in on <?php the_date('d-m-Y'); ?> |  <a href="<?php the_permalink();?>"><?php comments_number( 'no comment', 'one comment', '% comments' ); ?></a>
        </p>
    </header>
    <img src="<?php echo get_template_directory_uri() ?>/images/image-small.png" title="Riots" alt="Example Image 1" width="75" height="75" />
    <div class="post-text">
        <?php the_excerpt(); ?>
    </div>
</article>
<article class="news-article">
    <header>
        <h4>
            <a href="<?php the_permalink();?>"><?php the_title(); ?></a>
        </h4>
        <p class="post-info">
            Posted by <a href="<?php the_permalink();?>"><?php the_author(); ?></a> in on <?php the_date('d-m-Y'); ?> |  <a href="<?php the_permalink();?>"><?php comments_number( 'no comment', 'one comment', '% comments' ); ?></a>
        </p>
    </header>
    <img src="<?php echo get_template_directory_uri() ?>/images/image-small.png" title="Riots" alt="Example Image 1" width="75" height="75" />
    <div class="post-text">
        <?php the_excerpt(); ?>
    </div>
</article> 
```

在我看来，您应该只拥有此代码部分一次：

```
<article class="news-article">
    <header>
        <h4>
            <a href="<?php the_permalink();?>"><?php the_title(); ?></a>
        </h4>
        <p class="post-info">
            Posted by <a href="<?php the_permalink();?>"><?php the_author(); ?></a> in on <?php the_date('d-m-Y'); ?> |  <a href="<?php the_permalink();?>"><?php comments_number( 'no comment', 'one comment', '% comments' ); ?></a>
        </p>
    </header>
    <img src="<?php echo get_template_directory_uri() ?>/images/image-small.png" title="Riots" alt="Example Image 1" width="75" height="75" />
    <div class="post-text">
        <?php the_excerpt(); ?>
    </div>
</article> 
```

我在我的模板中这样做，但我仍然完全不理解这个问题。

仔细观察，您必须尝试在此上执行多个循环。每个部分应该不止一次，或者你想看到你的帖子，你需要一个循环。

# c# - 在 C# 中扩展数据表

> ID：12162235
> 
> 赞同：13
> 
> 时间：2012-08-28T15:06:22.077
> 
> 标签：c#, datatable

类的静态构造函数`SourceManager`遍历所有模块/类并发现所有实现`ISource`. 它将实例化其中的每一个并将`IEnumerable`它们中的一个公开为名为`IEnumerable<ISource> Sources`. 为简单起见`ISource`，有两个属性，`DataTable Table { get; }`和`string UniqueName { get; }`。实例化时，每个不同`ISource`的对象负责`Table`从 SQL、MDX 等中填充它。对于`ISource`我迄今为止编写的所有 's，在实例化时加载`Table`所有`DataRow`s 就足够了。但是**，我现在有一种情况，我想懒惰地加载`Table`with `DataRow`，而不是全部预先加载。我该怎么做呢？** 我将通过一个例子。

`PermissionSource`实现`ISource`。它`Table`具有 a`private set`的属性的值为`new PermissionDataTable()`。它`UniqueName`是`"Permissions"`。截至目前，没有权限从数据库加载到此`Table`属性中。

```
ISource permissionSource = SourceManager.Sources.
    Where(s => "Permission".Equals(s.UniqueName)).First(); 
```

现在我们已经获得了`PermissionSource`, 但通过一个接口。让我们获得许可。

```
DataRow row = permissionSource.Table.Rows.Cast<DataRow>().
    Where(r => r["PermissionName"].Equals("PermissionName")).First() 
```

我已经覆盖了该`Rows`属性，`PermissionDataTable`以便上面以某种方式获取与`"PermissionName"`数据库中关联的权限的值。其他权限不加载。

我在权限系统中没有选择权，也没有选择不使用`DataTable`.

**编辑：**

在我的示例中， 我需要覆盖`Rows`. 但是，是一个[DataRowCollection](http://msdn.microsoft.com/en-us/library/system.data.datarowcollection.aspx)，它是. 因此，像我想要做的那样，在创建最小的自定义 DataTable 实现方面没有什么可以做的。`DataTable``Rows``sealed`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T09:30:45.877

我不确定我是否理解您在使用 DataTable 时的限制，但是我过去在需要“刷新”DataTable 中的数据或使用不同的标准重新填充它时做过的一件事是创建一个从 DataTable 派生的新类其中包括对 DataAdapter 的引用，该引用带有最初用于填充 DataTable 的连接和选择信息。

例如，DataTable 子类可能类似于`LazyDataTable`下面的代码。请注意，我添加了几种访问行的不同方法。在查看本文末尾附近的`PermissionSource`主要代码后，它们可能会更有意义。*另外，请注意，我并未包含与在每种情况下正确打开和关闭数据库连接相关的所有详细信息。**您如何处理取决于您的数据库访问模型（例如连接池、共享连接等）。*`Program`

 *```
//using System.Data.Common;
public class LazyDataTable : DataTable {
    protected DbDataAdapter Adapter { get; set; }

    public LazyDataTable(DbDataAdapter a) {
        Adapter = a;
    }
    /// <summary>
    /// Save changes back to the database, using the DataAdapter
    /// </summary>
    public void Update() {
        Adapter.Update(this);
    }
    /// <summary>
    /// Fill this datatable using the SelectCommand in the DataAdapter
    /// The DB connection and query have already been set.
    /// </summary>
    public void Fill() {
        Adapter.Fill(this);
    }

    /// <summary>
    /// read and return one row at a time, using IEnumerable syntax
    /// (this example does not actually add the row to this table, 
    /// but that can be done as well, if desired.
    /// </summary>
    public IEnumerable<DataRow> LazyReadRows() {
        using (var reader = OpenReader()) {
            //Get the schema from the reader and copy it to this table.
            var schema = reader.GetSchemaTable();
            var values = new object[schema.Columns.Count];
            while (reader.Read()) {
                reader.GetValues(values);
                var row = schema.NewRow();
                row.ItemArray = values;
                yield return row;
            }
        }
    }

    /// <summary>
    /// Fill one row at a time, and return the new row.
    /// </summary>
    public DataRow ReadRow() {
        if (_reader == null || _reader.IsClosed) 
            _reader = OpenReader();
        //Get the schema from the reader and copy it to this table.
        if (this.Columns.Count == 0) 
            this.Columns.AddRange(_reader.GetSchemaTable().Columns.Cast<DataColumn>().ToArray());
        if (!_reader.Read()) {
            _reader.Dispose();
            return null;
        }
        var values = new object[_reader.FieldCount];
        _reader.GetValues(values);
        return this.Rows.Add(values);
    }
    private DbDataReader _reader = null;

    private DbDataReader OpenReader() {
        OpenConnect();
        return Adapter.SelectCommand.ExecuteReader();
    }

    private void OpenConnect() {
        var cn = Adapter.SelectCommand.Connection;
        if (cn.State == ConnectionState.Closed)
            cn.Open();
    }

    /// <summary>
    /// Change a Parameter in the SelectCommand, to filter which rows to retrieve.
    /// </summary>
    public void SetSelectParam(string name, object value) {
        var selparams = Adapter.SelectCommand.Parameters;
        selparams[name].Value = value;
    }
} 
```

然后您`PermissionSource`将创建一个`LazyDataTable`并适当地设置 DataAdapter（包括连接和 SELECT 命令）。它不会填充 DataTable，而是将其返回为空，稍后由应用程序代码填充。所以你`PermissionSource`可能类似于下面的代码。我以`System.Data.OleDb`数据对象为例，但您可以使用任何您想要的 ADO 提供程序。

```
interface ISource {
    public DataTable Table { get; }
    string UniqueName { get; }
}

public class PermissionSource : ISource {
    /// <summary>
    /// Loads a DataTable with all of the information to load it lazily.
    /// </summary>
    public DataTable Table { 
        get { 
            const string SELECT_CMD = "SELECT * FROM [Permissions] WHERE ([PermissionName] IS NULL OR [PermissionName]=@p1) AND [OtherProperty]=@p2";
            var conn = new OleDbConnection("...ConnectionString...");
            var selectCmd = new OleDbCommand(SELECT_CMD, conn);
            selectCmd.Parameters.AddWithValue("p1", "PermissionName");
            selectCmd.Parameters.AddWithValue("p2", 0);
            var adapter = new OleDbDataAdapter(selectCmd);
            var builder = new OleDbCommandBuilder(adapter); //used to generate the UPDATE and DELETE commands...
            adapter.UpdateCommand = builder.GetUpdateCommand(); //etc.
            //Do NOT fill the table here. Instead, let the caller fill it.
            return new LazyDataTable(adapter);
        }
    }
    public string UniqueName { get { return "Permission"; } }
} 
```

`PermissionSource`您的主程序代码将使用`LazyDataTable`如下：

```
 static class Program {
    void GetPermissions() {
        ISource permissionSource = SourceManager.Sources.
            Where(s => "Permission".Equals(s.UniqueName)).First();

        var table = permissionSource.Table as LazyDataTable;
        table.SetSelectParam("PermissionName", "Admin");

        //If you want to fill ALL rows in one step:
        table.Fill(); 

        // OR If you want to fill one row at a time, and add it to the table:
        DataRow row;
        while(null != (row = table.ReadRow())) {
            //do something with each individual row. Exit whenever desired.
            Console.WriteLine(row["PermissionName"]);
        }

        // OR If you prefer IEnumerable semantics:
        DataRow row = table.LazyReadRows().FirstOrDefault(someValue.Equals(row["columnname"]));

        //OR use foreach, etc. Rows are still ONLY read one at a time, each time IEnumerator.MoveNext() is called.
        foreach (var row in table.LazyReadRows())
            if (row["someColumn"] == "someValue")
                DoSomething(row["anothercolumn"]);
    }
} 
```

您当然可以混合和匹配此处显示的 LazyDataTable 的各个部分，以在应用程序约束范围内准确实现您想要的。如果您可以切换到不同的共享数据模型当然会好得多，但是如果您*必须*从每个 Source 返回一个 DataTable，那么至少您可以在必要时通过子类化返回一个功能更强大的 DataTable，正如我所展示的这里。这允许您传回更多信息，您可以根据需要使用这些信息来填充表格。我仍然鼓励您查看 LinqToSQL，并可能尝试切换为简单地传回 DbDataReader 或类似于我在此处显示的 LazyDataTable 的其他对象，这将允许您自定义原始查询（例如，通过使用`SetSelectParam`方法）并且一次读取一行中的数据。

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T09:08:07.927

我认为您正在寻找的是类似于 LinqToSql 的东西，您的每个 ISource 都可以返回一个 Table 而不是 DataTable。这将允许您使用示例中给出的动态查询，并且仅加载请求的数据，并且仅在需要时加载。我不知道您是否能够为您的所有数据源找到 LinqToSql 提供程序。如果这成为问题，您可以尝试使用 Entity Framework，如前所述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-21T11:29:20.117

以下示例通过 ExtendedProperties 属性将时间戳值添加到 DataTable。

```
private void GetAndSetExtendedProperties(DataTable myTable){
 // Add an item to the collection.
 myTable.ExtendedProperties.Add("TimeStamp", DateTime.Now);
 // Print the item.
Console.WriteLine(myTable.ExtendedProperties["TimeStamp"]);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T14:16:44.880

它可能不再有用了，但这可能会做到。

```
public interface ISource
{
    DataTable Table { get; }
    string Name { get; set; }
}

public class MySource : ISource
{
    private DataTable table;
    public DataTable Table
    {
        get
        {
            if (table == null)
                // Initialize your data.
                table = new System.Data.DataTable();
            return table;
        }
        private set
        {
            this.table = value;
        }
    }
    public string Name { get; set; }
} 
```*

# mysql - 高效的 MySQL 查询/模式来存储来自并行进程的信息

> ID：12162236
> 
> 赞同：1
> 
> 时间：2012-08-28T15:06:26.930
> 
> 标签：mysql, sql

**问题**：

我有**多个处理平面文件记录的并行进程**。每个文件对应于电信系统中的给定接口（通过系统的消息被赋予**32 位全球唯一标识符**，并且可以在多个接口上存在给定消息的记录）。有**一个处理每个文件**的进程。

我们将接口称为：A、B 和 C。消息字符串可以根据编写它的接口而有所不同。我应该创建一个表来存储有关通过系统的每条消息的信息。因此，该表应包含（以及其他字段）：id、message_on_A、message_on_B、message_on_C。我想避免相同ID的重复条目。

我尝试过的是以下内容：

1.  将 id 设置为 PRIMARY KEY 并使用 INSERT ON DUPLICATE KEY UPDATE 命令为每个进程设置相应的消息字段
2.  将 id 分解为多个部分，并将这些部分用作复合主键；其余与 1 相同。
3.  存储所有记录，然后使用第二个查询提取每个 id 的所有信息（使用 GROUP BY ID 和 max(message_on_A)、max(message_on_B)、max(message_on_C)）。没有为此方法定义主键。

这些方法都不够快。我正在寻找一种解决方案，它可以为 100 万个 id 实现大约 30 秒的运行时间（考虑到 3 个接口，因此有 300 万条记录）。

第一种和第二种方法在 MyISAM 表上完成了大约 400 秒的工作。我也尝试过 InnoDB，但速度要慢得多。

目前我正在考虑再次尝试方法 3，但我需要找到一个更快的查询（GROUP BY 和 max() 查询在我终止之前持续了 20 多分钟）

**问题**：任何人都可以为这个问题提出一个更好的模式吗？还有更好的查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:31:16.010

我正在考虑修改第三种方法。将数据存储在三个单独的表中，并将 GUId 作为每个表中的主键。这应该使插入尽可能快地发生。在此级别处理重复项。

而不是 group by，请尝试以下操作：

```
select A.id,
       A.message as A_message,
       (select B.message from B where B.id = A.id limit 1) as B_message,
       (select C.message from C where C.id = A.id limit 1) as C_message
from A 
```

如果这可行，那么您唯一的问题是消息缺少 A 组件时。我认为也有办法解决这个问题。问题是这是否能实现您的绩效目标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T15:18:55.037

innodb 有很多配置参数。我相信这个存储引擎在并发环境中会表现得更好。mysql 的默认设置不适合现代硬件 - 所以可能从[调整](https://serverfault.com/a/377559/2413)它们开始并重新运行基准测试。

# teamcity - TeamCity - 在一个地方报告多个项目配置的成功

> ID：12162240
> 
> 赞同：2
> 
> 时间：2012-08-28T15:06:50.697
> 
> 标签：teamcity

我们目前有 TeamCity 设置，因此每个组件（网站、API、移动应用等）都有一个项目。每个项目都包含一个功能测试配置。

所有这些组件都依赖于同一个数据库，该数据库应用了迁移。迁移是在功能测试运行之前应用的，因此有问题的迁移会导致构建失败。但是，要发现哪些功能测试因迁移而失败，我们必须手动查看每个测试（我们目前有 15 多个组件和相关的 TC 项目，因此并不理想）。

为了能够在一个地方查看所有功能测试配置的结果，是否可以将所有功能测试配置的结果聚合到一个新项目中，而无需创建当前功能测试配置的模板并在新项目？

# jquery - 验证必须分组和取消分组的字段时的JQuery验证插件

> ID：12162252
> 
> 赞同：0
> 
> 时间：2012-08-28T15:07:26.453
> 
> 标签：jquery, jquery-validate

我有一个以范围日期作为过滤器的报告。用户已指定每个输入都必须有自己的验证消息。因此，如果用户输入了两个无效日期，那么我就有两条无效消息，每个输入一条。但是当验证失败时，用户也想要消息，因为这两个输入，即，如果开始日期不早于结束日期。这是我当前的代码：

```
$(document).ready(function() {
    // Quick search
    $('input#email_search_list').quicksearch('#detailed-opt-out-report #detailed-opt-out-report-table tbody tr');

    // A custom method for validating the date range.
    $.validator.addMethod("dateRange", function() {
        var startDate = $("#startDate").val();
        var endDate = $("#endDate").val();
        return isDate(startDate) && isDate(endDate) ? Date.parse(startDate) <= Date.parse(endDate) : true;
    });

    // Another custom method for validating if at least one of the fields has value.
    $.validator.addMethod("bothEmpty", function() {
        return $("#startDate").val() || $("#endDate").val();
    });

    var form = $('#frmdetailedoptoutreport');
    form.validate({
        submitHandler: function(form) {
            $.blockUI({fadeIn:0, message: '<h1>Por favor, aguarde...</h1>'});
            form.submit();
        }, 
        rules: {
            startDate: {
                date: true,
                dateRange: true,
                bothEmpty: true
            },
            endDate: {
                date: true,
                dateRange: true,
                bothEmpty: true
            }
        },
        errorPlacement: function(error, element) {
            alert("oi");
            form.find(".errorContainer").append(error);
        },
        messages: {
            startDate: {
                date: "Por favor, especifique uma data inicial válida.",
                bothEmpty: "É obrigatório inserir pelo menos um filtro na busca.",
                dateRange: "A data final não pode ser menor que a data inicial."
            },
            endDate: {
                date: "Por favor, especifique uma data final  válida."
            }
        }
    });
});​ 
```

这是HTML代码：

```
 <form id="frmdetailedoptoutreport" name="frmdetailedoptoutreport" method="post" action="detailedoptoutreport">
    <fieldset class="form">
        <input type="hidden" name="page" id="page" value="1" />
        <p>
            <label for="startDate">Selecione intervalo de data:</label>
            <input class="datapicker" id="startDate" type="text" name="startDate" value="" maxlength="10" />
            a
            <input class="datapicker" id="endDate" type="text" name="endDate" value="" maxlength="10" />
        </p>
        <div class="errorContainer"></div>
        <div class="clr"></div>
        <input type="submit" value="Filtrar" onclick="restartPagination();" />
    </fieldset>
</form> 
```

restartPagination 和 isDate JS 函数：

```
function restartPagination() {
    $("#page").val(1);
}

function isDate(txtDate) {
    if (!txtDate) {
        return false;
    }

    // Declare Regex
    var rxDatePattern = /^(\d{1,2})(\/|-)(\d{1,2})(\/|-)(\d{4})$/;
    var dtArray = txtDate.match(rxDatePattern); // is format OK?
    if (dtArray == null) {
        return false;
    }

    // Checks for dd/MM/yyyy format.
    dtDay = dtArray[1];
    dtMonth = dtArray[3];
    dtYear = dtArray[5];

    if (dtMonth < 1 || dtMonth > 12) {
        return false;
    } else if (dtDay < 1 || dtDay > 31) {
        return false;
    } else if ((dtMonth == 4 || dtMonth == 6 || dtMonth == 9 || dtMonth == 11) && dtDay == 31) {
        return false;
    } else if (dtMonth == 2) {
        var isleap = (dtYear % 4 == 0 && (dtYear % 100 != 0 || dtYear % 400 == 0));
        if (dtDay > 29 || (dtDay == 29 && !isleap)) {
            return false;
        }
    }
    return true;
} 
```

不幸的是，这段代码给了我两种我不想要的行为。第一个行为是验证执行了两次。好的，如果我切断其中一个字段的验证，我会解决这个问题，但如果我这样做，输入不会获得作为我的用户规范之一的 CSS 错误类（为有问题的输入着色）。

我不想要的第二个行为是消息被复制。同样，如果我从其中一个输入中切断验证，我的问题就会解决，但输入会再次丢失 CSS 错误类。如果我使用 jquery 组验证器，我会收到一条消息，但是当我有两个字段时，即两个字段的日期无效并且如上所述两条消息，第二条消息会覆盖第一条消息。

所以，这是我的问题，如果我只在一个字段中调用验证，是否有人知道如何将错误类放在另一个字段中，或者知道当消息用于由于两个输入而失败的验证时如何不重复消息？

# android - 获取下载的可绘制对象时 ImageView 自动调整大小

> ID：12162258
> 
> 赞同：0
> 
> 时间：2012-08-28T15:07:51.043
> 
> 标签：android, drawable, android-imageview

我正在正确获取我下载的可绘制对象并且它们正确显示。我只想在我的 ImageView 上显示图像的顶部 144x284dip。相反，当下载图像时，ImageView 会将自身调整为可绘制对象的宽度和高度。我尝试修改 layoutparams 和 minimumwidth / minimumheight，但无济于事。

我能做些什么来强制 ImageView 保持在 144x284 吗？

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="284dip"
    android:layout_height="144dip" >

    <ImageView
        android:id="@+id/imageViewLogo"
        android:layout_width="284dip"
        android:layout_height="144dip" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:31:26.640

好的，我解决了。

我只是这样做了：

```
Bitmap newBitmap = Bitmap.createBitmap(bm, 0, 0, 144, 284); 
```

然后将其设置为 ImageView。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T17:07:52.347

如果我理解正确，你想做两件事：

1.  将 ImageView 的大小固定为 284dip X 144dip。
2.  仅显示图像的左上部分，未缩放。

执行第二部分将要求您使用“矩阵”比例类型并将比例设置为 1.0 并将变换因子设置为 0.0。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <ImageView
        android:id="@+id/imageView"
        android:layout_width="284dip"
        android:layout_height="144dip"
        android:scaleType="matrix"
        android:src="@drawable/ic_launcher" />
</LinearLayout> 
```

默认情况下，比例因子为 1，平移为 0。因此，您无需执行任何其他操作。如果您确实希望进行不同的缩放和转换，您可以编写这样的代码。

```
void showImage(Bitmap bm) {
    float scaleFactor = ...;
    float transform = ...;

    imageView.setImageBitmap(bm);
    final Matrix matrix = new Matrix();
    matrix.setScale(scaleFactor, scaleFactor);
    matrix.setTranslate(transform, transform);
    imageView.setImageMatrix(matrix);
} 
```

# symfony1 - 在 symfony 的 500 错误页面中使用 helper 函数是否安全？

> ID：12162259
> 
> 赞同：0
> 
> 时间：2012-08-28T15:07:51.267
> 
> 标签：symfony1, symfony-1.4

我正在自定义我的 symfony 1.4 应用程序的 500 错误页面，但我不确定 i18n 助手和其他类似功能`url_for`是否可以安全使用（在某些情况下不会被破坏）。

你有使用它们的经验吗？你有什么建议？

**编辑** 这是我的设置：

```
all:
  .settings:
    i18n:                   true
    default_culture:        en
    enabled_modules:        [sfGuardAuth]
    standard_helpers:       [I18N, Partial, Date] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:14:34.633

我们在 500 个页面中使用本地化助手，没有任何问题。尽管您应该注意 i18n 助手可能会由于不存在的翻译而失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:31:39.297

500 错误页面表明发生了严重错误，您无法知道在哪里。它可能在你的代码、symfony 的代码或配置文件中。

即使在某些情况下您可能能够使用助手，但在其他情况下，它会完全失败（WSOD）。

您最好的选择是坚持使用简单的 php，就好像您没有使用框架一样。

# sql - SQL Server 2008 R2 数据导出问题

> ID：12162262
> 
> 赞同：11
> 
> 时间：2012-08-28T15:08:07.423
> 
> 标签：sql, sql-server, sql-server-2008-r2

我正在尝试将数据从生产数据库导出到开发数据库，​​但出现此错误：

> 消息错误 0xc0202049：数据流任务 1：插入只读列“id”失败。（SQL Server 导入和导出向导）

有没有办法检查哪一列是因为我有 20 个表，它们都使用列名`id`，或者至少得到更好的错误报告？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2014-09-04T14:49:51.113

`Edit mappings`当您选择要从中导入和导入的表时，只需单击即可。并选中`Enable identity insert`复选框。你应该对每个选择的表都这样做。然后就可以完成导入了。在同样的情况下，它对我有所帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-28T15:17:39.443

如果列 ID 是标识列，它可能设置为在插入行时自动生成，并且无法直接写入。

要保留从生产环境到测试的链接，请使用：

```
SET Identity_Insert <TableName> ON 
```

允许您编写标识值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-28T16:35:12.627

我所要做的就是：

*   右键单击列（在本例中为“ID”）
*   选择修改
*   在 Column Properties 内向下滚动，直到您看到 Identity Specification
*   展开视图并从下拉菜单中选择 NO。

如果有人知道这样做的不同（更快）方式，请分享

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T15:18:56.960

听起来好像您可能正在尝试将值插入已声明为 IDENTITY 字段的列中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-10T03:28:06.140

好吧，答案有点晚了，但我还是发布它是为了提供给社区。

我假设您正在尝试复制表（不是部分数据）。我的回答是基于这个假设。

1.  通过 SSMS 中的对象资源管理器连接到源数据库。
2.  **右键单击**要复制其表的数据库。
3.  转到**“任务”->“导出”**。
4.  选择您的源服务器和目标服务器，如果您不想在动手之前运行其他脚本，只需按下一步（“从一个或多个表或视图复制数据”）。现在您可以选择要复制到目标的表。

选择要完全复制到目标的表。然后单击“编辑映射”。在这里您可以“启用身份插入”。您还将有其他选项，因此请在按 OK 之前检查屏幕。

如果您在此处不使用 SSMS 的快速版本，则可以创建一个 SSIS 包来创建作业并在将来自动化此过程。您可以检查“立即运行”并按照屏幕了解所有警告和错误的情况。希望你什么也得不到。祝你好运！

```
Tested with:
(
    Microsoft SQL Server 2008 R2 (SP1) - 10.50.2500.0 (Intel X86) 
    Jun 17 2011 00:57:23 
    Copyright (c) Microsoft Corporation
    Enterprise Edition on Windows NT 5.2 <X86> (Build 3790: Service Pack 2)
) 
```

# javascript - jquery来回滑动或圆形滑动

> ID：12162264
> 
> 赞同：3
> 
> 时间：2012-08-28T15:08:15.160
> 
> 标签：javascript, jquery, html, css

请我需要帮助使用 jquery 来回滑动图像，或者只是来回滑动。现在它滑到最后一个元素并冲回第一个 div 并重新开始，一点也不漂亮，我知道我应该回调一个函数来做到这一点，但我不断出错。在此先感谢，这是我下面的 jquery 代码

```
$(document).ready(function() {
    var currentPosition = 0;
    var slideWidth = 190;
    var slides = $('.slider_move');
    var numberOfSlides = slides.length;
    var slideShowInterval;
    var speed = 5000;

    slideShowInterval = setInterval(changePosition, speed);                 
    slides.wrapAll('<div id="slidesHolder"></div>')                 
    slides.css({ 'float' : 'left' });                   
    $('#slidesHolder').css('width', slideWidth * numberOfSlides);  

    function changePosition() {
        if(currentPosition == numberOfSlides - 1) {
            currentPosition = 0;
        } else {
            currentPosition++;
        }
        moveSlide();
    }                   
    function moveSlide() {
            $('#slidesHolder')
              .animate({'marginLeft' : slideWidth*(-currentPosition)});
    }
});​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:12:12.367

代替：

```
if(currentPosition == numberOfSlides - 1) {
    currentPosition = 0;
} else {
    currentPosition++;
} 
```

您需要将第一张幻灯片移动到最后（并同时调整容器的位置）：

```
if (currentPosition > 0) {
    $('#slidesHolder').css('marginLeft',0)
        .children().first().appendTo('#slidesHolder');
} else {
    currentPosition += 1;
} 
```

[http://jsfiddle.net/mblase75/qatry/](http://jsfiddle.net/mblase75/qatry/)

或者，为了进一步优化整个事情，您可以消除`currentPosition`变量和`moveSlide`子函数，并在`.animate`方法中使用回调：

```
function changePosition() {
    $('#slidesHolder').animate({
        'marginLeft': 0-slideWidth
    }, function() {
        $('#slidesHolder').css('marginLeft', 0)
            .children().first().appendTo('#slidesHolder');
    });
} 
```

[http://jsfiddle.net/mblase75/8vaCg/](http://jsfiddle.net/mblase75/8vaCg/)

# http - Things to watch out for with Content-Encoding: gzip

> ID：12162273
> 
> 赞同：11
> 
> 时间：2012-08-28T15:08:44.227
> 
> 标签：http, browser, amazon-s3, gzip

I've created a static website that is hosted on a S3 Bucket. My asset files (css and js files) are minified and compressed with gzip. The filename itself is either `file_gz.js` or `file_gz.css` and is delivered with a `Content-Encoding: gzip` header.

So far, I've tested out the website on various browsers and it works fine. The assets are delivered with their compressed versions and the page doesn't look any different.

The only issue that I see is that since this is a S3 bucket, there is no failsafe for when the the client (the browser) doesn't support the gzip encoding. Instead the HTTP request will fail and there will be no styling or javascript-enhancements applied to the page.

Does anyone know of any problems by setting `Content-Encoding: gzip`? Do all browsers support this properly? Are there any other headers that I need to append to make this work properly?

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-28T15:52:22.763

现代浏览器几乎全面支持编码内容。但是，假设所有用户代理都会这样做是不安全的。您的实现的问题在于它完全忽略了 HTTP 的内置方法来避免这个问题：*内容协商*。你有几个选择：

1.  您可以继续对问题视而不见，并希望*每个*访问您的内容的用户代理都能够解码您的 gzip 资源。不幸的是，几乎可以肯定情况并非如此。浏览器并不是唯一的用户代理，解决问题的“头脑风暴”方法很少是一个好主意。

2.  实施一种解决方案来协商是否使用`Accept-Encoding`标头提供压缩响应。如果客户端根本没有指定此标头，或者指定了它但没有提及 gzip，那么您可以相当肯定用户将无法解码 gzip 后的响应。在这些情况下，您需要发送未压缩的版本。

内容协商的来龙去脉超出了这个答案的范围。您需要对如何解析`Accept-Encoding`标头和协商响应的编码进行一些研究。通常，内容编码是通过使用第三方模块（如 Apache 的 mod_deflate）来完成的。虽然我不熟悉 S3 在这方面的选项，但我怀疑您需要自己实施协商。

总而言之：在*不先与客户端清除的情况下发送编码内容不是一个好主意。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-22T08:33:20.593

1.  你有 CSS / minfied CSS ( `example.css`[247 kb])。
2.  使用 cmd`gzip -9 example.css`和隐蔽文件将类似于`example.css.gz`[44 kb]。
3.  将文件重命名`example.css.gz`为`example.css`.
4.  将文件上传到 S3 存储桶并在属性中单击元数据。
5.  添加新的元数据标签、选择`Context-Encoding` 和值`gzip`。
6.  现在你的 CSS 和 gzip 都会被压缩。

来源： [http ://www.rightbrainnetworks.com/blog/serving-compressed-gzipped-static-files-from-amazon-s3-or-cloudfront/](http://www.rightbrainnetworks.com/blog/serving-compressed-gzipped-static-files-from-amazon-s3-or-cloudfront/)

# osx-mountain-lion - Dock icon in Mountain Lion disappears for open app

> ID：12162275
> 
> 赞同：0
> 
> 时间：2012-08-28T15:08:46.583
> 
> 标签：osx-mountain-lion, dock

This is a perplexing issue: a program icon for a RUNNING program disappears from my Mountain Lion (10.8.1) Dock once the documents it was displaying are closed.

The offending App is TextEdit, although I suspect this will also happen in other apps. I'll be editing a text file, then close the window using the red "x" button in the top left, and as expected the window will close and the TextEdit icon will remain in the Dock with the little blue dot underneath. But wait a few seconds, and the Dock icon disappears!

I know that it's still running, because I can see the process in Activity Monitor. So what gives? Does anyone know how to make running applications remain in the Dock?

Thanks in advance.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:14:53.557

尝试使用以下任一过程重置扩展坞。

1.打开终端并输入

```
defaults delete com.apple.dock
killall Dock 
```

或者

```
rm ~/Library/Preferences/com.apple.dock.{db,plist}
killall Dock 
```

希望这对您有所帮助。

# r - Appending column to a data frame - R

> ID：12162278
> 
> 赞同：3
> 
> 时间：2012-08-28T15:03:42.913
> 
> 标签：r, dataframe

Is it possible to append a column to data frame in the following scenario?

```
dfWithData <- data.frame(start=c(1,2,3), end=c(11,22,33))
dfBlank <- data.frame() 
```

..how to append column `start` from `dfWithData` to `dfBlank`?

It looks like the data should be added when data frame is being initialized. I can do this:

```
dfBlank <- data.frame(dfWithData[1]) 
```

but I am more interested if it is possible to append columns to an empty (but inti)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T17:46:13.240

我建议简单地对从 RODBC 调用返回的数据框进行子集化。就像是：

```
df[,c('A','B','D')] 
```

也许，或者你也可以用它们的数字位置对你想要的列进行子集化，即

```
df[,c(1,2,4)] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T15:12:49.937

```
dfBlank[1:nrow(dfWithData),"start"] <- dfWithData$start 
```

# python - ipython map_async input and output data

> ID：12162279
> 
> 赞同：0
> 
> 时间：2012-08-28T15:09:13.900
> 
> 标签：python, map, parallel-processing, ipython

I am new to the IPython parallel package but really want to get it going. What I have is a 4D numpy array which I want to run through slices,rows,columns and process the 4th dimension (time). The processing is a minimization routine that takes a bit of time which is why I would like to parallelize it.

```
from IPython.parallel import Client
from numpy import *
from matplotlib.pylab import *

c = Client()

v = c.load_balanced_view()
v.block=False

def process( src, freq, d ):
        # Get slice, row, col
        sl,r,c = src

        # Get data
        mm = d[:,sl,c,r]

        # Call fitting routine
        <fiting routine that requires freq, mm and outputs multiple parameters> 

        return <output parameters??>

##  Create the mask of what we are going to process
mask = zeros(d[0].shape)
mask[sl][ nonzero( d[0,sl] > 10*median(d[0]) ) ] = 1

# find all non-zero points in the mask
points = array(nonzero( mask == 1)).transpose()

# Call async
asyncresult = v.map_async( process, points, freq=freq, d=d ) 
```

My function "process" requires two parameters: 1) freq is a numpy array (100,1) and 2) d which is (100, 50, 110, 110) or so. I want to retrieve several parameters from the fitting.

All the examples I have seen that use map_async have simple lambda functions etc and the outputs seem to be trivial.

What I want is to apply "process" to every point in d where the mask is not zero and to have maps of the output parameters in the same space. [Added: I am getting "process() takes exactly 3 arguments (1 given) ].

(Step 2 of this might be required as I am passing a huge numpy array "d" to each process. But once I figure out the data passing I should hopefully be able to figure out a more efficient way of doing this.)

Thanks for any help.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T01:35:45.983

我通过做解决了数据传递问题

```
def mapper(x):
    return apply(x[0], x[1:]) 
```

并使用元组列表调用 map_async，其中第一个元素是我的函数，其余元素是我的函数的参数。

```
asyncResult = pool.map_async(mapper, [(func, arg1, arg2) for arg1, arg2 in myArgs]) 
```

我先尝试了一个 lambda，但显然它不能被腌制，所以这是不行的。

# c# - Visualise map data in Excel

> ID：12162281
> 
> 赞同：1
> 
> 时间：2012-08-28T15:09:25.193
> 
> 标签：c#, excel, add-in, gis

I have postcode level data in an Excel workbook and ideally I would like to have a map on another sheet of the area that I am interested in. The postcodes in my dataset should be highlighted within that map. I am using Excel 2010 and have no prior experience with GIS but plenty of experience with C#, Java. Any ideas of how I can achieve this? I looked for open source add-ins and didn't find an awful lot. Is there another way I can achieve what I want?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T17:37:08.570

您可以查看非 gis 用户的解决方案：http: [//www.esri.com/software/esri-maps-for-office](http://www.esri.com/software/esri-maps-for-office)

它需要 Office 2010（在您的情况下没问题），它基于**私有**GIS 软件（无 FLOSS）。在视频部分有一些例子。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T05:11:43.043

我使用[Topo.ly](http://topo.ly)。您可以从 Excel 中复制所有邮政编码并将其粘贴到 Topo.ly，它会在 Google 地图上绘制它们。它还托管您的地图，因此您可以保存并稍后返回，或与他人共享。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T15:52:07.483

这可能是一个很好的起点。您将需要一些 WPF 知识

[必应地图 Windows Presentation Foundation (WPF) 控件，版本 1.0](http://www.microsoft.com/en-us/download/details.aspx?id=27165)

然后使用 VSTO，您可以将其集成到 Excel [使用 Office 解决方案中的 WPF 控件](http://msdn.microsoft.com/en-us/library/bb772076.aspx)

示例 WPF 应用程序是[@Integrating Bing Maps With WPF](http://visualstudiomagazine.com/Articles/2012/04/01/Map-Your-Apps.aspx?Page=1)

**编辑**：

在非 WPF 解决方案上找不到太多，但您可以尝试一下

[使用 Visual Studio 2005 Tools for Office Second Edition 集成虚拟地球地图和 Excel 2007](http://msdn.microsoft.com/en-us/library/cc531008.aspx)

在此处下载[http://archive.msdn.microsoft.com/VSTOVirtualEarthXL](http://archive.msdn.microsoft.com/VSTOVirtualEarthXL)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-01-22T15:09:18.157

为了将来参考或有类似问题的人，您可以使用名为 Funfun 的 Excel 加载项在 Excel 2016 中创建数据映射。我在这里做了两个示例。

[![在此处输入图像描述](../Images/dbf53022ebaf858ae54c616e99485c57.png)](https://i.stack.imgur.com/BWaFI.png)

[![在此处输入图像描述](../Images/5649ccf020c718bb2026babbff16d57d.png)](https://i.stack.imgur.com/HHlS7.png)

如您所见，屏幕截图的中间部分有一些代码。那是因为 Funfun 允许您直接在 Excel 中编写和运行 JavaScript 代码，而且 JavaScript 代码可以使用存储在工作表中的数据。使用 JavaScript 的能力意味着您可以使用 HighCharts.js 或 D3.js 等第三方库来绘制数据图等图表。在这两个示例中，我实际上使用了 highmaps，它是 HighCharts.js 库的一部分。highmaps.js 已经有不同的模板，从世界地图到不同国家的特定地图。我相信你能找到你需要的地图。

Funfun 还有一个在线编辑器，您可以在其中使用您的数据测试您的 JavaScript 代码。您可以在下面的链接中查看上述示例的详细代码。

[https://www.funfun.io/1/#/edit/5a5c9a50404f66229bda3ae0](https://www.funfun.io/1/#/edit/5a5c9a50404f66229bda3ae0)

[https://www.funfun.io/1/#/edit/5925036104ce702ccfb22b0e](https://www.funfun.io/1/#/edit/5925036104ce702ccfb22b0e)

如果您对在线编辑器中获得的结果感到满意，您可以使用上面的 URL 轻松地将结果加载到 Excel 中。当然，首先您需要从**Insert - My add-ins 插入**Funfun 插件。以下是一些屏幕截图，展示了如何执行此操作。

[![在此处输入图像描述](../Images/e3a5ef4b7145bb6a3ae41e7912c64ddf.png)](https://i.stack.imgur.com/xXRWk.png)

[![在此处输入图像描述](../Images/5b9b244582110d25c13c545889cd1e4d.png)](https://i.stack.imgur.com/DS7Kh.png)

***披露：我是 Funfun 的开发者***

# objective-c - Rounded of a float with a decimal

> ID：12162282
> 
> 赞同：0
> 
> 时间：2012-08-28T15:09:34.483
> 
> 标签：objective-c, ios, floating-point, decimal

Do someone know if there is a method in order to round a float two numbers after the comme.

Examples :

```
10.28000 -> 10.3
13.97000 -> 14.0
5.41000 -> 5.4 
```

Thanks a lot !

Regards, Sébastien ;)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T03:21:13.437

具有 NSRoundPlain 行为的纯 Cocoa 方式：

```
- (NSDecimalNumber *)decimalNumberForFloat:(float)f_ 
```

{

```
NSNumber *number                           = [NSNumber numberWithFloat:f_];
NSDecimal decimal                          = [number decimalValue];
NSDecimalNumber *originalDecimalNumber     = [NSDecimalNumber decimalNumberWithDecimal:decimal];
NSDecimalNumberHandler *roundingBehavior   = [NSDecimalNumberHandler decimalNumberHandlerWithRoundingMode:NSRoundPlain
                                              scale:0
                                              raiseOnExactness:NO
                                              raiseOnOverflow:NO
                                              raiseOnUnderflow:NO
                                              raiseOnDivideByZero:NO];

return [originalDecimalNumber decimalNumberByRoundingAccordingToBehavior:roundingBehavior]; 
```

}

由于 NSDecimalNumber 是 NSNumber 的子类，因此要获取原始浮点调用 -[NSDecimalNumber floatValue]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T15:16:14.787

你也可以试试

```
float num = 10.28000
float result = (roundf(num * 10.0))/10.0; 
```

（乘以 10，然后舍入，然后再除以 10）不要忘记 .0 以便除以浮点数而不是整数，这将再次舍入

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T15:13:35.973

使用 NSNumberFormatter 创建具有指定派系数字的字符串。

```
float num = 10.28000;

formatter = [[NSNumberFormatter alloc] init];
[formatter setMaximumFractionDigits:1];

NSNumber *value = [NSNumber numberWithFloat:num];
NSString *newNumString = [formatter stringFromNumber:value]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-28T15:12:14.820

尝试这个：

```
float aFloatValue = 3.1415926;
NSString *formatted = [NSString stringWithFormat:@"%01.1f", aFloatValue];
NSLog(@"Formatted: %@", formatted); 
```

认为它是一个很好的旧`sprintf`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-28T15:16:35.210

试试这个：

```
float myFloat = 10.4246f;
myFloat = ((int) ((myFloat * 100) + 5)) / 100.0f; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-28T15:23:08.907

```
float fval = 1.54f;
float nfval = ceilf(fval * 10.0f + 0.5f)/10.0f; 
```

# php - 将 Magento 从 web 主机移动到本地 Linux 沙箱——仍然重定向到实时测试站点

> ID：12162285
> 
> 赞同：1
> 
> 时间：2012-08-28T15:09:41.530
> 
> 标签：php, magento, caching

本地 magento 安装将我重定向到我们的实时测试站点，而不是使用本地文件。索引文件被读取直到 Mage::run()，然后重定向发生：

```
 Mage::run($mageRunCode, $mageRunType); 
```

详细信息：我从我们的实时测试环境中提取了 Magento 系统文件和数据库，并将它们设置在我本地机器的 Linux 环境中。一切似乎都很顺利，除了在浏览器中导航到我的根目录时，我被重定向到我们的实时测试站点（而不是查看我的本地文件）。

我的问题是......源配置或数据库表中的哪些代码将包含此重定向的信息？我使用在 Stack 上从遇到相同[问题](https://stackoverflow.com/questions/7726084/magento-transfer-from-live-to-local)的人那里找到的脚本清除了 Magento 缓存：

```
 require_once 'app/Mage.php';
    $app = Mage::app();

    echo "<pre>";

    if($app != null) {
      echo "The app was initialized.\n";
      $cache = $app->getCache();

      if($cache != null) {
           echo "The cache is not empty. Clean it.\n";
           $cache->clean();
      }  
    } 
```

提问者说这是一个缓存问题，但上面的脚本没有解决我的问题。我假设有一个配置/缓存文件包含安装的“根”目录，并且它仍然指向我们的实时站点。我通过几个目录无济于事。

对此（以及您认为我在此过程中可能偶然发现的任何其他问题）的任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T15:17:34.530

您需要更改 core_config_data mysql 表中的值：

> 更新 core_config_data SET value='http://live-site.com/' WHERE path='web/unsecure/base_url'

并对 web/secure/base_url 执行相同的操作。如果您有多家商店，您还应该根据 scope/scope_id 进行过滤。

# sql - WPF application with local database

> ID：12162286
> 
> 赞同：0
> 
> 时间：2012-08-28T15:09:43.603
> 
> 标签：sql, wpf

I'm making a WPF application with a local database,

I made the database with SQL server management studio, then I linked a .edmx file to the database I made.

Now if i wanna run my program on another PC i don't have that database anymore so it kinda crashes. Can I copy my database file (.mdf) in my Debug folder and change my App.Config so it takes that database?

Becouse I wanna copy my program to a computer that dosn't have SQL server Management studio installed. Is that posible?

My App.Config looks like this atm:

```
<connectionStrings>
<add name="PRCEntities" connectionString="metadata=res://*/PRC.csdl|res://*/PRC.ssdl|res://*/PRC.msl;provider=System.Data.SqlClient;provider connection string=&quot;Data Source=DESKTOP-BERNARD\SQLEXPRESS;Initial Catalog=PRC;Integrated Security=True;MultipleActiveResultSets=True;Application Name=EntityFramework&quot;" providerName="System.Data.EntityClient" /></connectionStrings>
</configuration> 
```

Thx

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:15:12.213

您可以复制 mdf，但是：

*   目标计算机必须安装 SQL Server
*   您必须[附加 mdf 文件](http://msdn.microsoft.com/en-us/library/ms190209.aspx)
*   您需要更改连接字符串，或者让安装应用程序的用户输入它，或者将机器名称更改为 localhost，但您可能会遇到具有命名实例且没有默认实例的机器。

# asp.net-mvc - IIS 6 中的 MVC3 .Net 预编译问题

> ID：12162290
> 
> 赞同：0
> 
> 时间：2012-08-28T15:09:54.290
> 
> 标签：asp.net-mvc, aspnet-compiler

我有一个 MVC3 C# .Net Web 应用程序，我在我的应用程序上运行 aspnet_compiler 以进行预编译。我正在运行这个命令：

```
aspnet_compiler -v /dev/boe 
```

Boe 是“默认网站”下开发结构中的应用程序。上面的命令产生了这个错误。

```
c:\Windows\Microsoft.NET\Framework\v4.0.30319\Temporary ASP.NET Files\dev_boe\25d5f53a\2ad742fc\App_Web_vujir5mm.0.cs(29): error CS0234: The type or namespace name 'Models' does not exist in the namespace 'BOE' (are you missing an assembly reference?)
c:\Windows\Microsoft.NET\Framework\v4.0.30319\Temporary ASP.NET Files\dev_boe\25d5f53a\2ad742fc\App_Web_vujir5mm.2.cs(29): error CS0234: The type or namespace name 'Models' does not exist in the namespace 'BOE' (are you missing an assembly reference?)
c:\Windows\Microsoft.NET\Framework\v4.0.30319\Temporary ASP.NET Files\dev_boe\25d5f53a\2ad742fc\App_Web_vujir5mm.3.cs(29): error CS0234: The type or namespace name 'Models' does not exist in the namespace 'BOE' (are you missing an assembly reference?) 
```

但是，模型不在我们的解决方案中。我们的模型对象位于我们的 Web 应用程序引用的域项目中。看来编译器期望在我们的 MVC 应用程序中有一个模型引用。这是真的？还是有其他原因导致此错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T14:39:01.260

感谢 David Hirst 建议查看临时文件中的代码行，我发现了问题：

基本上，有些文件未包含在 Visual Studio 解决方案中，但仍在我机器上的文件结构中。有 3 个引用模型的 .cshtml 文件。由于这些文件未包含在解决方案中，因此它们未包含在使用 VS 的构建中。而且，由于它们不在解决方案中，所以当我搜索模型时，我没有得到任何结果......但是编译器扫描了整个目录结构，因此试图编译带有错误引用的文件。

Outstanding lesson in being sure to remove legacy code, and make sure the code base and file structures are in snyc.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:17:29.200

尝试在 IIS 7.5 上使用 Razor 引擎时遇到类似错误（即使安装了 .NET 4！）

如果您的项目中有您建议的参考，您可能需要进入参考，突出显示它，转到属性并在 Copy Local 下，将其设置为 true。重新发布，希望这能像我一样解决您的问题。

# node.js - 如何断开与本地主机的连接？

> ID：12162294
> 
> 赞同：8
> 
> 时间：2012-08-28T15:10:08.650
> 
> 标签：node.js, testing, networking, websocket, localhost

是否可以与本地主机断开连接？

我正在编写一个 Node.js WebSocket 服务器，我想在本地测试如果连接错误关闭会发生什么。

如果我在远程测试，我只会关闭 Wi-Fi，但这不会断开我与 localhost 的连接。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:12:43.430

除了通过防火墙阻止端口或您在本地主机上运行的程序之外，我不知道您会以任何方式执行您的要求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T15:12:45.897

`localhost`只是主机文件中的别名。如果您删除该别名，那么您将有效地与本地主机“断开连接”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T22:27:41.973

正如大卫所提到的，您可以使用简单的防火墙来阻止端口。

例如在 OSX 上，在端口 8080 上阻止 localhost

```
$ sudo ipfw add deny tcp from any to localhost 8080 
```

将返回如下响应：

```
00100 deny tcp from any to 127.0.0.1 dst-port 8080 
```

然后删除规则：

```
sudo ipfw delete 00100 
```

（不推荐使用 ipfw 取而代之的是 pfctl，但对于这些目的，我仍然觉得它更简单）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-08T10:58:55.707

我没有使用本地主机，而是使用 IPv4 地址（可以使用 ipconfig 调用或查看本地连接获得）来访问本地机器，然后，为了模拟网络故障，我只是禁用本地连接。它可以帮助我在本地机器上测试网络故障。

# cmake - Debian package bug on squeeze?

> ID：12162295
> 
> 赞同：0
> 
> 时间：2012-08-28T15:10:12.393
> 
> 标签：cmake, debian, packaging, deb, cpack

My hand-made debian package wont install if i build it on Squeeze (well, a squeezechroot)? If i built it on a wheezy box though it builds installable packages.

Note that it *builds* fine in either case. Im generating the debian packages using CMake/CPack.

The error message i get is:

```
user@buildbox:/builddir/packagename# dpkg -i packagename_1.0.3.deb
(Reading database ... 35116 files and directories currently installed.)
Unpacking packagename (from packagename_1.0.3.deb) ...
dpkg: error processing packagename_1.0.3.deb (--install):
 unable to create `/usr/share/packagename/builddir/mixer_devices.txt.dpkg-new' (while processing `./usr/share/packagename/builddir/mixer_devices.txt'): No such file or directory
dpkg-deb: subprocess paste killed by signal (Broken pipe)
Errors were encountered while processing:
 packagename_1.0.3.deb

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:27:54.913

可能`mixer_devices`由于某种原因未包含在创建的 deb 文件中？

只需执行`ar x packagename_1.0.3.deb`并查看 tar 文件包含的内容。

# java - JTable row totals color coded label

> ID：12162296
> 
> 赞同：2
> 
> 时间：2012-08-28T15:10:13.460
> 
> 标签：java, swing, jtable, code-reuse, rowcount

I have 5 JTables on different forms with arbitrary numbers of rows and I would like to have a label for each one that will show me the total number of rows in that table and also change color for 3 seconds when the row count changes. The color should go green if incrementing and red if decrementing. What would be the best way to implement this such that I do not need to duplicate too much code in each of my forms?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T16:23:05.663

基本上，您将 TableModelListener 添加到 JTable 的模型中，并在接收到更改事件时，根据需要更新相应的标签

一些代码：

```
public class TableModelRowStorage 
    // extends AbstractBean // this is a bean convenience lass  of several binding frameworks
                            // but simple to implement directly  
     implements TableModelListener {

    private int rowCount;

    public TableModelRowStorage(TableModel model) {
        model.addTableModelListener(this);
        this.rowCount = model.getRowCount();
    }
    @Override
    public void tableChanged(TableModelEvent e) {
        if (((TableModel) e.getSource()).getRowCount() != rowCount) {
            int old = rowCount;
            rowCount = ((TableModel) e.getSource()).getRowCount();
            doStuff(old, rowCount);
        }

    }

    protected void doStuff(int oldRowCount, int newRowCount) {
        // here goes what you want to do - all in pseudo-code
        // either directly configuring a label/start timer
        label.setText("RowCount: " + newRowCount);
        label.setForeground(newRowCount - oldRowCount > 0 ? Color.GREEN : Color.RED);
        timer.start();

        // or indirectly by firing a propertyChange
        firePropertyChange("rowCount", oldRowCount, newRowCount);
    }

} 
```

# git - Merge two git branches which had a common ancestor but are (almost) not the same project

> ID：12162298
> 
> 赞同：2
> 
> 时间：2012-08-28T15:10:22.180
> 
> 标签：git, merge

Related but not quite what I am looking for [merge-two-branches-what-direction.](https://stackoverflow.com/questions/2351108/git-merge-two-branches-what-direction)

## Situation:

I have inherited an interesting problem. So we have a rails application that houses the code for a number of websites. Before I came to work here they branched the master branch to develop a new website. That's great but it was never merged back into master, and changes from master were not merged into the branch to keep it up to date.

Now master has 2 new websites and almost a third done while this branch has the one it was branched for and a new one that was similar enough to it that development was made simpler by doing it in that branch (like min saving of 100 hours).

Also they use the same database-structure and authentication systems which is really important for keeping track of our customers. Which is why I would like to merge them so I don't have to make the same changes to each code base when we change something in the database ect...

## Problem:

My problem is that Now I don't know what to do with this branch. I want work being done out of the master branch with the occasional break off for a new feature that's rolled back in, but that's not whats happened. Its almost like we have 2 master branchs now because the code bases have grown so far apart.

I have tried merging the master into the other branch but that resulted in chaos, which we can't afford since there is development going on in both branches. So then I created a local branch and tried to merge the two into it. But after struggling with it for a couple days now and seemingly getting all the conflicts merged, only to have it fail my unit-tests and normal testing.

## Plea for help:(question)

I am starting to think its impossible to merge the two since they are almost separate projects at this point (merging them involved adding or changing something like 430 files)

In short I guess my question is this: What do I do with the branches now?

(This is the first time as a developer that I have been in-charge of the source control and overall project management. So really at a loss here.)

p.s. sorry for the wall of text,

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T15:32:35.447

首先，叉子没问题！如果您有两个分歧的分支，那么分开考虑它们可能是值得的。如果每个核心代码都有很大的改进，我只会真正尝试将它们合并回来，彼此分享会很好。否则，叉子通常很有用。

话虽如此，让我们假设您将努力合并它们。

首先，我会决定哪个分支实际上是你的主分支。当然，一个称为 master，但出于此合并的目的，您应该决定哪个分支更共享，并且如果历史记录发生变化会影响更多人。通常这确实是 master 分支，但如果没有其他人有 master 的副本，您可以选择看起来更容易的任何一个。

好的，现在你有了一个“master”分支，你应该努力不打扰那个 master 分支的历史。我们将调用另一个分支`tf`（用于完全分叉）。无论是来自添加到分支顶部的大型合并提交，还是来自`tf`. 这是我首先要做的：

*   **创建存储库的完整备份！** <-- 如有疑问，请务必这样做。

## 试用合并

```
git checkout tf;
git branch tf_merging;
git checkout tf_merging; 
```

`git merge master;` 检查冲突的程度。查看这些是否是重复修复（在这种情况下可以消除提交）或并行修复的冲突 // 如果您认为无法使用合并，请放弃此分支：

```
git checkout tf; 
```

## 交互式变基

```
git checkout tf;
git branch tf_rebase; 
```

`git rebase -i master;`// 交互式变基。使用合并尝试中的列表，尝试消除重复提交以防止。另请查看重新排列 tf 的提交是否会提供更好的合并候选者。
// 如果冲突太多：

```
git rebase --abort 
```

// 仅尝试在 rebase 开始后执行几个 git rebase --continue 循环，最多可能是 7-10 次，否则您可能会过度处理冲突并最终导致一团糟。

## 最终的解决方案

如果你无法通过 git 实现你想要的解决方案，还有一个替代方案，那就是从非主分支中挑选你特别想保留的特性`tf`，并丢弃非必需项。例如，如果添加了一个`tf`在 master 中不存在的库，则将该库和其他有用的功能放在一边，以添加一个明确的 master 提交，以创建一个类似的分支`tf`，并且具有相同的功能，但是实际上是对最有用/核心功能更改的重新实现，并跳过了许多非必要的提交。`tf`本质上，您在核心 master 的一个分支之上杀死并重新实现它的最佳部分，以允许重新开始共享开发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T15:19:41.497

Ryan，您可以创建一个新项目，在其中逐步复制旧项目的部分内容，使您的团队能够同时在两个不同的分支上工作。好的部分是您必须迁移工作代码，这样您就不会像从头开始实施 430 个文件那样痛苦。从应用程序的最基础开始，始终迁移少量文件，逐渐达到合并效果。另外，您应该注意两个分支中已经合并的文件的更改。祝你好运。

# image - InstantCommons 在 MediaWiki 1.19 和 SELinux 中不起作用

> ID：12162301
> 
> 赞同：2
> 
> 时间：2012-08-28T15:10:38.797
> 
> 标签：image, mediawiki, wiki, wikimedia-commons

我在本地设置自己的 MediaWiki 网站，但无法使用 InstantCommons 功能*（用于直接嵌入来自 commons.wikimedia.org 的文件）*。

我没有收到错误消息，我尝试使用以下语法从 Commons 加载文件：

```
 [[File:Cervus elaphus Luc Viatour 1.jpg|Cervus elaphus Luc Viatour 1]] 
```

只是没有加载，最后我的页面上有一个红色链接，指的是一个不存在的文件。现在我已经 2 天了，我正在寻找解决方案，但到目前为止没有任何成功。

我在跑步：

*   MediaWiki v.1.19.1
*   Fedora 16（带有 SElinux）
*   PHP 5.3.15
*   MySQL Ver 14.14 Distrib 5.5.25a，适用于 Linux (x86_64)

我在我的 中尝试了以下两种配置`LocalSettings.php`，但均未成功：

```
$wgUseInstantCommons = true; 
```

和

```
$wgForeignFileRepos[] = array(
   'class'                   => 'ForeignAPIRepo',
   'name'                    => 'shared',
   'apibase'                 => 'http://commons.wikimedia.org/w/api.php',
   'fetchDescription'        => true, // Optional
   'descriptionCacheExpiry'  => 43200, // 12 hours, optional (values are seconds)
   'apiThumbCacheExpiry'     => 43200, // 12 hours, optional, but required for local thumb caching
); 
```

任何建议都是最受欢迎的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:10:44.957

好的，这（还）不是一个答案，而是一个调试建议。在我看来，从您的服务器到 Commons 的 HTTP 请求由于某种原因失败了，但不幸的是，ForeignAPIRepo 并没有以任何方式指出错误的原因。

这确实是 MediaWiki 中的一个错误，应该修复，但与此同时，您能否尝试将以下差异（或仅手动添加标有`+`符号的行）应用到您的`includes/filerepo/ForeignAPIRepo.php`文件：

```
Index: includes/filerepo/ForeignAPIRepo.php
===================================================================
--- includes/filerepo/ForeignAPIRepo.php    (revision 97048)
+++ includes/filerepo/ForeignAPIRepo.php    (working copy)
@@ -385,6 +385,7 @@
        if ( $status->isOK() ) {
                return $req->getContent();
        } else {
+               wfDebug( "ForeignAPIRepo: HTTP GET failed: " . $status->getXML() );
                return false;
        }
    } 
```

应用后，尝试加载 Commons 图像的文件描述页面并查看 MediaWiki 调试日志。现在应该有一行以 开头，`ForeignAPIRepo: HTTP GET failed:`后跟几行 XML 错误转储。该错误数据应该有望表明出了什么问题；请复制并粘贴到这里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-19T13:43:18.910

我的也不是一个确定的答案。参考[Ilmari Karonen 的帖子](https://stackoverflow.com/a/12183998/4695615)，我无法找到或获取`getXML()`为我的 Mediawiki v1.23.0 版本执行的方法。我正在查看[此处](https://doc.wikimedia.org/mediawiki-core/master/php/classStatus.html)找到的参考文档，以尝试在`Status`该类上找到任何其他方法调用，这些方法可以为我提供良好的故障排除信息。我最终找到了以下内容并编辑了[Ilmari Karonen](https://stackoverflow.com/a/12183998/4695615) `includes/filerepo/ForeignAPIRepo.php`从第 521 行开始的帖子中提到的相同文件：

```
if ( $status->isOK() ) {
    return $req->getContent();
} else {
    $error = $status->getErrorsArray();
    $dump = print_r($error, true);
    wfDebug("ForeignAPIRepo: HTTP GET failed: $dump\n");
    return false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-08T09:29:17.197

旧版 MediaWiki 的默认 InstantCommons 配置有点傻。由于[T114098](https://phabricator.wikimedia.org/T114098)，我推荐以下其中一项，希望能解决您的问题：

1.  升级到 MediaWiki 1.27（当它发布时），或者
2.  将您`LocalSettings.php`的热链接图像设置为保存服务器端请求和处理。

`$wgUseInstantCommons = false; $wgForeignFileRepos[] = array( 'class' => 'ForeignAPIRepo', 'name' => 'commonshotlink', 'apibase' => 'https://commons.wikimedia.org/w/api.php', 'hashLevels' => 2, 'url' => 'https://upload.wikimedia.org/wikipedia/commons', 'thumbUrl' => 'https://upload.wikimedia.org/wikipedia/commons/thumb', 'transformVia404' => true, 'fetchDescription' => true, 'descriptionCacheExpiry' => 43200, 'apiThumbCacheExpiry' => 24 * 3600, );`

# mysql - Imported data are missing in Mysql

> ID：12162304
> 
> 赞同：0
> 
> 时间：2012-08-28T15:10:52.540
> 
> 标签：mysql

I had copyed the data folder under wamp/bin/mysql/mysql(v)/data befor formate my computer, then after installing new os and then wamp I replace the data folder. Now when I opening phpmyadmin the list of databases are showing but under the data base the tables are not shownig. When I am using the myadminer it shows the lisst of table but not the tables data.

when I am using sqlbuddy one warning is showing in the place of listing tables. warning is like

```
Warning: array_key_exists() expects parameter 2 to be array, boolean given in E:\wamp\apps\sqlbuddy1.3.3\dboverview.php on line 215 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:13:31.533

您应该进行适当的备份 - 使用 mysqldump。如果你使用了 innodb 存储引擎，并且它被配置为将日志文件或表空间文件保存在其他地方——恐怕你已经丢失了数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:40:13.920

对不起，您丢失了数据。将来经常创建备份并在您想要迁移数据库时创建 MySQL 转储。

# ruby-on-rails - ruby rules engine

> ID：12162305
> 
> 赞同：7
> 
> 时间：2012-08-28T15:11:06.847
> 
> 标签：ruby-on-rails, ruby, dsl

I feel like that I am about to reinvent the wheel here, so before I do that ...

I have a large set of data that I need to process, and the 'rules' that process the data will evolve over time, so I thought that implementing a simple rules engine would be in order.

Note **I am not looking for a natural language parser**, I want all of the rules to be ruby procs.

I could imagine the syntax to look something like:

```
engine = SimpleRulesEngine.new

rule = engine.add_rule(priority: 10) do |row|
  row.name != 'George'
end

rule.action do |row|
  puts "Yikes, name is not George!, it was #{row.name}"
  row.update_attribute :name, 'George'
end

engine.process collection 
```

I was wondering if there was any existing patterns or gems out there that would help with this. The one that seems closest is [ruleby](https://github.com/codalytics/ruleby), but does not seem to be actively maintained, and seems too complex of a solution for my problem.

Thanks!

* * *

Note this is a similar question to : [Ruby & Rules Engines](https://stackoverflow.com/questions/820259/ruby-rules-engines), but different in that, I do not care about natural language processing, and rule storage.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T15:41:18.253

@DaveNewton 对我说了一些话，很明显，基本上我正在为我的应用程序寻找一些简单的 DSL，这就是我最终使用的——它非常简单，但如果它对其他人有用：

```
# /lib/simple_rules_engine
# To use, just include it in any file where you need some rules engine love ...
# then defile rules like so:
#
# rule :name_of_rule,
#       priority: 10,
#       validate: lambda {|o| # do something with o}
#       fail: lambda {|o| o.fail!}} 
# 
# then to run the engine
# process_rules(your_data_set)
#   
module SimpleRulesEngine
  extend ActiveSupport::Concern

  included do
    class_attribute :rules
    self.rules = []
  end

  module ClassMethods

    # rule :name_of_rule,
    #       priority: 10,
    #       validate: lambda {|o| # do something with o}
    #       fail: lambda {|o| o.fail!}}
    def rule(name,options={})
      self.rules << SimpleRulesEngine::Rule.new(name,options)
    end

    def process_rules(collection)
      collection.each do |row|
        rules.sort_by(&:priority).each do |rule|
          rule.run(row)
        end
        row.valid!
      end
    end

  end

  ## Helper Classes

  class Rule

    attr_accessor :priority
    attr_accessor :name

    # proc to test
    attr_accessor :validate

    # if valid
    attr_accessor :success

    # if invalid
    attr_accessor :fail

    NO_OP = lambda {|o| true }

    def initialize(name, options={})
      self.name = name
      self.priority = options[:priority] || 10
      self.validate = options[:validate] || NO_OP
      self.fail = options[:fail] || NO_OP
      self.success = options[:success] || NO_OP
    end

    def run(data)

      if validate.call(data)
        success.call(data)
      else
        fail.call(data)
      end

    end
  end

end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:46:08.780

与其他现有的 Ruby 规则引擎相比，Ruleby 似乎是维护最积极的：

*   [罗尔斯](http://rools.rubyforge.org/)
*   [红宝石规则](http://ruby-rules.codehaus.org/)

但是，**[Wongi 引擎](https://github.com/ulfurinn/wongi-engine)**看起来很有前途，可能会成为您所需要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-06T08:31:27.430

正如 Stratus3D 所建议的那样，也许看看 Wongi。乍一看，它看起来不错，并且有很好的介绍。在接下来的几周里，我将在一个更复杂的测试用例上对其进行测试。

另一方面，Rools 似乎没有维护（rubyforge 页面已死，我发现的所有分叉似乎也已死）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-05T21:50:00.753

不要忘记 wongi-engine gem ( [https://github.com/ulfurinn/wongi-engine](https://github.com/ulfurinn/wongi-engine) )。它基于 Rete 算法 ( [http://en.wikipedia.org/wiki/Rete_algorithm/](http://en.wikipedia.org/wiki/Rete_algorithm/) ) 并且具有类似于您正在寻找的语法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-26T22:03:43.707

我已经断断续续地玩了几个星期的 Ruleby，它使用起来并不太复杂，尽管我增加的复杂性是使用大量的 case 语句以编程方式将规则加载到引擎中。

一旦您了解诸如事实之类的东西在引擎中是持久的，并且每次后续运行不仅评估您刚刚输入的事实，而且还评估您之前断言的事实，它就非常直截了当。不喜欢其中一些是如何黑盒的，尽管当我遇到运行时错误时，排除故障绝对是一件痛苦的事（因为我目前正在处理一个部分）。

# iphone - 键盘上方的目标 c 工具栏

> ID：12162308
> 
> 赞同：-1
> 
> 时间：2012-08-28T15:11:09.877
> 
> 标签：iphone, objective-c, ios

> **可能重复：**
> [以编程方式对齐 iPhone 键盘顶部的工具栏](https://stackoverflow.com/questions/158574/programatically-align-a-toolbar-on-top-of-the-iphone-keyboard)

我试图了解，如何在键盘上方执行此图像中的工具栏
![在此处输入图像描述](../Images/e5cfada69afcf1ecc3ba9502ec2d58ac.png)

这是我可以使用的原生 ios 视图吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-28T15:14:41.700

只需搜索一个关键字：`inputAccessoryView`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T15:15:31.653

这是你可以做的，`inputAccessoryView`看看[http://developer.apple.com/library/ios/#documentation/uikit/reference/UITextField_Class/Reference/UITextField.html#//apple_ref/occ/instp/UITextField /inputAccessoryView](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITextField_Class/Reference/UITextField.html#//apple_ref/occ/instp/UITextField/inputAccessoryView)

# asp.net - log4net does not write in IIS 6.0

> ID：12162309
> 
> 赞同：2
> 
> 时间：2012-08-28T15:11:15.087
> 
> 标签：asp.net, logging, asp-classic, iis-6, log4net

I have the following log4net configuration:

```
<log4net>
<appender name="Console" type="log4net.Appender.ConsoleAppender">
  <layout type="log4net.Layout.PatternLayout">
    <!-- Pattern to output the caller's file name and line number -->
    <conversionPattern value="%date [%thread] %-5level %ndc - %message%newline" />
  </layout>
</appender>

<appender name="RollingFile" type="log4net.Appender.RollingFileAppender">
  <file value="C:/logs/mysystem.log" />
  <appendToFile value="true" />
  <lockingModel type="log4net.Appender.FileAppender+MinimalLock" />
  <maximumFileSize value="1024MB" />
  <maxSizeRollBackups value="30" />

  <layout type="log4net.Layout.PatternLayout">
    <conversionPattern value="%date [%thread] %-5level - %message%newline" />
  </layout>
</appender>

<root>
  <level value="DEBUG" />
  <appender-ref ref="Console" />
  <appender-ref ref="RollingFile" />
</root> 
```

in the local machine it works fine, but when I deploy the web site to the remote server (IIS 6.0) it does not create the log file despite the fact that the system is running.

The AppPool identity is configured to "Network Service".

Any idea?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:11:15.087

When the application pool is configured to "Network Service" it does not have sufficient permissions to write to the file system, therefore the log file does not created.

Configure the identity of the app pool to "Local System", it will work fine!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:26:17.013

您可以通过使用机器名称作为原则在文件夹上创建 ACE 来授予对日志文件夹的访问“网络服务”访问权限。将池标识更改为“本地系统”可能会产生不良影响，因此我会避免这种情况。

另一种方法是创建域用户并将此用户添加到机器 IIS_WPG 组。更改池标识以使用此用户。然后，您可以向该用户授予适当的文件夹访问权限。

# silverlight - Silverlight Grid Column widths

> ID：12162312
> 
> 赞同：1
> 
> 时间：2012-08-28T15:11:22.133
> 
> 标签：silverlight

I have a Silverlight 5.0 Grid with three columns, defined with widths `"Auto", "*", and "Auto"`. Inside the second column, I have another Grid with four columns, defined with width `"25*"`. Each of these four columns is a ComboBox.

Even though the widths are all defined the same, the ComboBoxes "Auto" size themselves, and when I select one, the box itself narrows to just larger than the down arrow, although the items are sized to fit.

```
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="Auto"/>
    </Grid.ColumnDefinitions>
<ContentControl Grid.Column="0" FontSize="20" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="10,1,0,1">
    <ContentPresenter Content="This is a Label" />
</ContentControl>
    <Grid Grid.Column="1" HorizontalAlignment="Center">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="25*"/>
            <ColumnDefinition Width="25*"/>
            <ColumnDefinition Width="25*"/>
            <ColumnDefinition Width="25*"/>
        </Grid.ColumnDefinitions>
        <ComboBox Grid.Column="0" Name="comboView" FontSize="14" Margin="2,1,2,1" >
            <ComboBox.Items>
                <ComboBoxItem Content="Item1" IsSelected="True" />
                <ComboBoxItem Content="Item2" />
            </ComboBox.Items>
        </ComboBox>
        <ComboBox Grid.Column="1" Name="comboField" FontSize="14" Margin="2,1,2,1" >
            <ComboBox.Items>
                <ComboBoxItem Content="Field1" IsSelected="True" />
                <ComboBoxItem Content="Field2" />
            </ComboBox.Items>
        </ComboBox> 
```

...

What have I missed? When I had just one grid, with the first column set to `Auto` and all the rest set to something like `Width=9*`, the ComboBoxes did not behave this way.

After further observation, it appears that the `HorizontalAlignment="Center"` in the inner grid is the culprit. If I remove it, the ComboBoxes return to retaining their size, but they take up the whole outer Column 1, when I want them to take up their necessary space and then be centered within the outer Column.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T14:05:49.183

如果我现在理解正确，您最大的问题是您希望所有组合框的宽度相同，都占用相同的空间（即：所有大小都等于具有最大尺寸的组合框）。我*相信*你已经把其他一切都理顺了。

这在 WPF 中很容易；他们有一个名为“ [IsSharedSizeScope](http://msdn.microsoft.com/en-us/library/system.windows.controls.grid.issharedsizescope%28v=vs.100%29.aspx) ”的属性，它可以均匀地分布网格宽度。

Silverlight 中没有这样的属性。为此，您可能需要绑定它们每个的大小并在后面的代码中完成。这有点hacky，但它应该可以工作。对他们所有人来说都是这样的：

```
<ComboBox Grid.Column="1" Name="comboField" FontSize="14" Margin="2,1,2,1" Width="{Binding Path=Width}" SizeChanged="comboField_SizeChanged"> 
```

然后在后面的代码中：

```
GridLength Width = new GridLength(10);

private void comboField_SizeChanged(object sender, SizeChangedEventArgs e)
{
    if (e.NewSize.Width > len.Value)
    {
        Width = new GridLength( e.NewSize.Width );
    }
} 
```

编辑：还有[这个库](http://www.die-rooter.de/ITworks/archives/27-SharedSize-Grid-with-Silverlight.html)似乎可以做你想做的事情。

# javascript - 如何在 jQuery 屏蔽文本输入上执行 .select()

> ID：12162321
> 
> 赞同：3
> 
> 时间：2012-08-28T15:11:49.553
> 
> 标签：javascript, jquery, jquery-events, mask, masking

我正在使用[http://digitalbush.com/projects/masked-input-plugin/](http://digitalbush.com/projects/masked-input-plugin/)插件。

有一个带有定义掩码的输入文本：

```
<input type="text" id="txtMyInput" class="FocusSense"/> 
```

和一个脚本：

```
$(document).ready(function () {
    jQuery(function ($) {            
        $("#txtMyInput").mask("?9.99");            
    });
    $(".FocusSense").focus(function () {
        this.select();
    });
}) 
```

如您所见，我想全选，`txtMyInput`但可惜！在焦点上，面具出现并消失`.select()`。

我应该怎么做才能保存面具和`.select()`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T16:32:04.607

我想你在找什么，是这样的：

```
$(document).ready(function () {
    jQuery(function ($) {            
        $("#txtMyInput").mask("?9.99");            
    });
    $(".FocusSense").focus(function (e) {
      var that = this;
      setTimeout(function(){$(that).select();},10);
      return false;
    });
}); 
```

setTimeout 将“排队” select() 执行。所以它会在屏蔽完成后选择内容。

[**工作演示**](http://jsfiddle.net/nYtDu/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T15:35:43.653

您需要使用 $(this) 来获取当前对象。

```
$(document).ready(function () {
    jQuery(function ($) {            
        $("#txtMyInput").mask("?9.99");            
    });
    $(".FocusSense").focus(function () {
        $(this).select(); // instead of this.select();
    });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T15:36:31.230

sory改变焦点改变点击功能；

```
jQuery(".FocusSense").click(function() {
    this.focus();
    this.select(); 
});​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T15:20:04.070

this.select() 改变 jQuery(this).select();

```
$(".FocusSense").focus(function () {
    jQuery(this).select();
}); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-04-29T15:54:13.230

这是 ' [jQuery 屏蔽输入插件的副本。当文本框收到焦点时选择所有内容](https://stackoverflow.com/questions/480979/jquery-masked-input-plugin-select-all-content-when-textbox-receives-focus/23369361#23369361)'我在其中发布了此修复的说明。

**imeout方法是不必要的！**

```
$(".yourMaskedInput").attr("readonly", true).select().removeAttr("readonly"); 
```

# javascript - 使用 JavaScript 或 Prototype 获取表单中的所有控件并启用它们？

> ID：12162323
> 
> 赞同：-2
> 
> 时间：2012-08-28T15:11:56.520
> 
> 标签：javascript, controls, prototypejs

如何获取所有控件（单选按钮、选择、文本字段等）并将其状态设置为启用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:13:13.983

使用 Prototype.js：

```
$$(":input").each(function (el) {
   el.enable();
});​ 
```

**[演示](http://jsfiddle.net/LFQWb/)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:14:15.240

如果您不关心旧版浏览器，可以使用：

```
(function (slice) {
    "use strict";
    var elems;

    //select the elements
    elems = document.querySelectorAll('button, input, select, textarea');

    //cast to an array
    elems = slice.call(elems); 

    //iterate over the array
    elems.forEach(function (el) {
        //enable each element
        el.disabled = false;
    });
}(Array.prototype.slice)); 
```

否则，您将需要使用`document.getElementsByTagName`并遍历每个标签：

```
(function (slice) {
    "use strict";
    var elems,
        elem,
        i,
        l;
    function getElemArr(tag) {
        var els;
        //get the elements
        els = document.getElementsByTagName(tag);
        //cast to array
        els = slice.call(els);
        return els;
    }
    //select each type
    elems = [].concat(
        getElemArr('button'),
        getElemArr('input'),
        getElemArr('select'),
        getElemArr('textarea')
    );
    //loop over every element
    for (i = 0, l = elems.length; i < l; i += 1) {
        elem = elems[i];
        elem.disabled = false;
    }
}(Array.prototype.slice)); 
```

# python - 如何在交互式绘图时摆脱最大递归深度误差？

> ID：12162328
> 
> 赞同：7
> 
> 时间：2012-08-28T15:12:13.630
> 
> 标签：python, matplotlib

我正在尝试构建一个交互式情节。如果在轴内单击并在随机位置画一个圆圈，这个应该会清除图形。代码如下：

```
import matplotlib.pyplot as plt
import random

def draw_circle(event):
    if event.inaxes:
        print(event.xdata, event.ydata)
        plt.cla()
        a = random.randint(0,100)
        b = random.randint(0,100)
        s, = plt.plot(a,b,'o', ms=100, color="blue",visible=True )
        plt.show()

fig = plt.figure()
ax = plt.subplot(111)
s, = plt.plot(1,2,'o', ms=100, color="blue",visible=True )
plt.connect("button_press_event", draw_circle)
plt.show() 
```

单击 42 次后，程序中断，我得到以下回溯：

```
Exception in Tkinter callback
Traceback (most recent call last):
  File "/usr/lib/python2.7/lib-tk/Tkinter.py", line 1413, in __call__
    return self.func(*args)
  File "/usr/lib/pymodules/python2.7/matplotlib/backends/backend_tkagg.py", line 286, in button_press_event
    FigureCanvasBase.button_press_event(self, x, y, num, guiEvent=event)
  File "/usr/lib/pymodules/python2.7/matplotlib/backend_bases.py", line 1632, in button_press_event
    self.callbacks.process(s, mouseevent)
  File "/usr/lib/pymodules/python2.7/matplotlib/cbook.py", line 262, in process
    proxy(*args, **kwargs)
  File "/usr/lib/pymodules/python2.7/matplotlib/cbook.py", line 192, in __call__
    return mtd(*args, **kwargs)
  File "/home/almarahat/Dropbox/python/GUI/Testing site/test_rt/baud_test.py", line 8, in draw_circle
    plt.cla()
  File "/usr/lib/pymodules/python2.7/matplotlib/pyplot.py", line 2784, in cla
    ret =  gca().cla()
  File "/usr/lib/pymodules/python2.7/matplotlib/axes.py", line 842, in cla
    spine.cla()
  File "/usr/lib/pymodules/python2.7/matplotlib/spines.py", line 157, in cla
    self.axis.cla()
  File "/usr/lib/pymodules/python2.7/matplotlib/axis.py", line 731, in cla
    self.reset_ticks()
  File "/usr/lib/pymodules/python2.7/matplotlib/axis.py", line 744, in reset_ticks
    self.majorTicks.extend([self._get_tick(major=True)])
  File "/usr/lib/pymodules/python2.7/matplotlib/axis.py", line 1553, in _get_tick
    return XTick(self.axes, 0, '', major=major, **tick_kw)
  File "/usr/lib/pymodules/python2.7/matplotlib/axis.py", line 141, in __init__
    self.tick2line = self._get_tick2line()
  File "/usr/lib/pymodules/python2.7/matplotlib/axis.py", line 401, in _get_tick2line
    l.set_transform(self.axes.get_xaxis_transform(which='tick2'))
  File "/usr/lib/pymodules/python2.7/matplotlib/axes.py", line 586, in get_xaxis_transform
    return self.spines['top'].get_spine_transform()
  File "/usr/lib/pymodules/python2.7/matplotlib/spines.py", line 374, in get_spine_transform
    self._ensure_position_is_set()
  File "/usr/lib/pymodules/python2.7/matplotlib/spines.py", line 140, in _ensure_position_is_set
    self.set_position(self._position)
  File "/usr/lib/pymodules/python2.7/matplotlib/spines.py", line 365, in set_position
    self.axis.cla()
  File "/usr/lib/pymodules/python2.7/matplotlib/axis.py", line 731, in cla
    self.reset_ticks()
  File "/usr/lib/pymodules/python2.7/matplotlib/axis.py", line 744, in reset_ticks
    self.majorTicks.extend([self._get_tick(major=True)])
  File "/usr/lib/pymodules/python2.7/matplotlib/axis.py", line 1553, in _get_tick
    return XTick(self.axes, 0, '', major=major, **tick_kw)
  File "/usr/lib/pymodules/python2.7/matplotlib/axis.py", line 140, in __init__
    self.tick1line = self._get_tick1line()
  File "/usr/lib/pymodules/python2.7/matplotlib/axis.py", line 383, in _get_tick1line
    zorder=self._zorder,
  File "/usr/lib/pymodules/python2.7/matplotlib/lines.py", line 195, in __init__
    self._marker = MarkerStyle()
  File "/usr/lib/pymodules/python2.7/matplotlib/markers.py", line 112, in __init__
    self.set_marker(marker)
  File "/usr/lib/pymodules/python2.7/matplotlib/markers.py", line 171, in set_marker
    self._recache()
  File "/usr/lib/pymodules/python2.7/matplotlib/markers.py", line 116, in _recache
    self._path = Path(np.empty((0,2)))
  File "/usr/lib/pymodules/python2.7/matplotlib/path.py", line 112, in __init__
    if ma.isMaskedArray(vertices):
  File "/usr/local/lib/python2.7/dist-packages/numpy-1.6.2-py2.7-linux-x86_64.egg/numpy/ma/core.py", line 5683, in isMaskedArray
    return isinstance(x, MaskedArray)
RuntimeError: maximum recursion depth exceeded while calling a Python object 
```

在这一点上，我不确定递归发生在哪里以及如何缓解这个错误。

我知道（从其他问答中）我可以提高我的筹码限制并解决问题。但是，我不认为这是在这种特殊情况下的解决方案，并且想深入了解这一点。

任何帮助将不胜感激。

提前致谢。

附加信息：

*   重要的主要功能包括清除图形并在单击画布时绘制新内容。
*   The clicking does not raise this error, if I am not trying to plot something. Thus, I suspect, I'm missing something in handling matplotlib.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-28T15:17:07.083

Instead of `plt.show()`, from within your callback call `plt.draw()`. The problem is that `plt.show` runs a mainloop of the GUI library; you just want to update what is shown within the existing mainloop. Using the Qt backend, your code would show the error `QCoreApplication::exec: The event loop is already running`.

See [What is interactive mode?](http://matplotlib.sourceforge.net/faq/usage_faq.html#what-is-interactive-mode) for more guidance on how to use Matplotlib interactively.

# rspec - 在 STI 模型上运行我的规范时获得 Active::Record::StatementInvalid

> ID：12162334
> 
> 赞同：0
> 
> 时间：2012-08-28T15:12:25.710
> 
> 标签：rspec, ruby-on-rails-3.2, fixtures, sti

所以，这是我的问题。我有一个名为 AdminNotifications 的模型。它属于 AdminUser 模型。有一个 QuorumAdminNotification 模型，它使用 STI 从 AdminNotification 继承。它目前是空的。当我运行我的规范时，我在所有测试中都得到了这个错误：

> ```
> Failure/Error: Unable to find matching line from backtrace
>      ActiveRecord::StatementInvalid:
>        PG::Error: ERROR:  column "admin_user" of relation "admin_notifications" does not exist
>        LINE 1: ...admin_notifications" ("type", "event", "message", "admin_use...
>                                                                     ^
>        : INSERT INTO "admin_notifications" ("type", "event", "message", "admin_user", "created_at", "updated_at", "id") VALUES 
> ```
> 
> ('Quorum', 'reached', 'Quorum has been reached', 'admin', '2012-08-28 14:50:43', '2012-08-28 14:50:43', 853808134)

如果我将继承列设置为不存在的列，则所有测试都会通过。

有谁知道为什么会这样？

以下是相关代码：

应用程序/模型/admin_notification.rb

```
class AdminNotification < ActiveRecord::Base
  belongs_to :admin_user

  attr_accessible :message, :model, :record_id, :type

  scope :addressed, where('admin_user_id IS NOT NULL')
  scope :unaddressed, where('admin_user_id IS NULL')

  def addressed?
    !admin_user.nil?
  end
end 
```

规范/模型/admin_notification_spec.rb

```
describe AdminNotification do
  fixtures :admin_notifications

  describe "#addressed?" do
    it "should return false if admin_user is not set" do
      AdminNotification.new.should_not be_addressed
    end

    it "should return true when admin_user is set" do
      notification = AdminNotification.new
      notification.stub(:admin_user).and_return(mock(AdminUser, nil?: false))
      notification.should be_addressed
    end
  end

  describe "addressed scope" do
    it "returns all addressed notifications" do
      AdminNotification.addressed.should == admin_notifications(:addressed1, :addressed2)
    end
  end

  describe "unaddressed scope" do
    it "returns all unaddressed notifications" do
      AdminNotification.unaddressed.should == admin_notifications(:unaddressed1, :unaddressed2)
    end
  end
end 
```

规格/夹具/admin_notification.yml

```
unaddressed1:
  type: Quorum
  event: reached 
  message: "Quorum has been reached"

unaddressed2:
  type: Quorum
  event: test 
  message: "Test message"

addressed1:
  type: Quorum
  event: reached 
  message: "Quorum has been reached"
  admin_user: admin

addressed2:
  type: Quorum
  event: reached 
  message: "Quorum has been reached"
  admin_user: admin 
```

应用程序/规范/admin_users.yml

```
admin:
  email: admin@example.com
  password: password
  password_confirmation: password 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:32:55.323

修复。

问题在于固定装置中的类型字段

它应该是

> QuorumAdminNotification

不是

> 法定人数

# c++ - 更改静态库的“动态 RTL”设置有什么影响？

> ID：12162337
> 
> 赞同：8
> 
> 时间：2012-08-28T15:12:45.127
> 
> 标签：c++, c++builder, static-linking

在 Embarcadero RAD Studio 2010 中，静态库的项目选项中有一个设置，称为“动态 RTL”。（它在 TLib 部分。）

我的印象是，关于是动态链接还是静态链接 RTL 的决定是在链接时做出的，而不是在编译时做出的。但是静态库只能编译；没有链接步骤。那么，更改此选项如何影响我的静态库？

我有一些使用这些静态库的 .exe 和 .dll 项目，我在这些项目中设置了“动态 RTL”选项。这是有道理的，因为它们实际上有一些要链接的东西，但我不明白这个设置对静态库有什么影响。

如果静态库具有动态 RTL = true 而使用此库的 DLL 和 EXE 具有动态 RTL = false，是否会导致任何问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-27T21:06:51.183

我不使用 Embarcadero，而是使用旧版本的 C++ Builder。我认为它们的工作方式相同。当您使用动态 RTL 时，您的代码将从您的程序附带的运行时 DLL 中调用 RTL 函数。当您不使用动态 RTL 时，函数会从库复制到您的 exe 或 lib 文件中。我使用动态 RTL 减小 EXE 文件的大小。exe 或 libs 的逻辑相同。这意味着如果您在任何模块中使用动态 RTL，无论是 exe 还是 lib，您还必须提供适当的运行时 DLL。

# c# - 根据屏幕宽 x 屏幕高查找显示器配置

> ID：12162339
> 
> 赞同：2
> 
> 时间：2012-08-28T15:12:46.453
> 
> 标签：c#, .net, screen, multiple-monitors

我正在查看 Screen 类，以了解桌面宽度的显示器数量。如果我们说显示器的 3x1 配置（非常标准的配置），我想在 Rectangle 中获得 3 和 1。

如果它是 2x2 配置的显示器（较少标准），我希望 2 和 2 在一个矩形中。

我对这些显示器的分辨率不感兴趣，只对它们排列方式的物理矩阵感兴趣。

编辑：我认为，如果我获得总工作区域，然后使用每个单独的屏幕尝试找到适合的配置，那么我将留下系统中屏幕的物理数量。想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:49:52.537

这*可以*工作：

```
var width = Screen.AllScreens.Select(s => s.Bounds.X).Distinct().Count();
var height = Screen.AllScreens.Select(s => s.Bounds.Y).Distinct().Count(); 
```

注意：我使用多台在各方面都相同的显示器对此进行了测试。

# asp.net - 使用 Entity Framework 保存更改会导致分离的实体重复

> ID：12162341
> 
> 赞同：0
> 
> 时间：2012-08-28T15:12:52.110
> 
> 标签：asp.net, asp.net-mvc-3, entity-framework, entity-framework-4

我正在制作一个调查程序，其中包含从数据库中作为实体提取的问题列表。在调查过程中，实体的属性可能会被编辑，但我不希望这些更改保留到数据库中。因此，我将问题加载到 中后分离它们`dbcontext`并通过字典访问它们。

当我尝试将答案保存到数据库时出现问题。由于答案实体与问题实体（已分离）相关，因此将一个全新的问题实体添加到数据库中。我不确定为什么会发生这种情况，因为添加的答案实体包含分离实体的正确 ID（当我在调试器中查看它时）。但是，在保存更改后，它会更新为新创建的重复实体的 ID。

有没有办法阻止这种行为？或者，是否有一种方法可以对实体进行更改并且即使在`SaveChanges`上下文中调用以将答案或日志条目写入数据库时​​也不让它们持久保存到数据库中？

这是加载的代码，然后分离问题（项目）：

```
 public FixedLengthBlockElementRuntime(FixedLengthBlock block, RuntimeContext context) : base(block, context)
    {
        this._items = ((FixedLengthBlock)this.Element).ItemBank.Items.OfType<FixedLengthItem>().ToDictionary(x => x.ItemName, x => x);

        foreach(FixedLengthItem fixedLengthItem in this._items.Values)
        {
            this.Context.DetachEntity(fixedLengthItem);
        }
    } 
```

这是添加重复条目的代码：

```
 public void SetResponse(Response response)
    {
        response.Session = this.Session;
        this.DbContext.Responses.AddObject(response);
        this.DbContext.SaveChanges();
    } 
```

请注意，在保存更改之前，响应具有正确的 ItemId。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:38:51.233

您可以将问题[DbSet](http://msdn.microsoft.com/en-us/library/system.data.objects.mergeoption.aspx)上的 MergeOption 设置为 OverwriteChanges。

```
Context.Questions.MergeOption = MergeOption.OverwriteChanges; 
```

但是，您需要确保在查询问题之前设置它才能正常工作。

[更多](http://msmvps.com/blogs/kevinmcneish/archive/2010/02/16/setting-entity-framework-mergeoptions-what-works-what-doesn-t.aspx)关于 MergeOptions 如何工作的阅读

# php - 公共页面认证

> ID：12162342
> 
> 赞同：1
> 
> 时间：2012-08-28T15:12:53.910
> 
> 标签：php

我对所有页面使用相同的标题，其中包括：

*   用户验证码，
*   徽标和主菜单 html，
*   登录信息（未登录时的用户名、注销按钮/登录注册按钮）。

现在的问题。

如何检查页面是否公开（非注册用户可访问）？我通常将非注册用户重定向到登录页面，但是当某些页面是公开的而有些不是时如何处理呢？我显然不能使用标题，因为它是独立于页面的。将公共状况放在每一页上是个好主意吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:21:27.940

您将需要在文件或数据库中存储每个页面是公共页面还是私有页面。否则你怎么知道它是公共页面还是私人页面？我本人建议在数据库中完成此操作，以免您对此类设置进行硬编码。如果您希望将来更改页面，您只需登录后端并进行更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:31:28.200

您想要实现[ACL](http://en.wikipedia.org/wiki/Access_control_list)，它代表访问控制列表。

> 关于计算机文件系统的访问控制列表 (ACL) 是附加到对象的权限列表。ACL 指定哪些用户或系统进程被授予访问对象的权限，以及允许对给定对象执行哪些操作。典型 ACL 中的每个条目都指定了一个主题和一个操作。例如，如果一个文件的 ACL 包含 (Alice, delete)，这将授予 Alice 删除该文件的权限。

您没有提到如何在应用程序中处理路由，但您可以查看下面的文章以获得对该概念的简要说明。

[在 PHP 中创建自定义 ACL](http://www.developer.com/lang/php/creating-a-custom-acl-in-php.html)

或阅读基于角色的访问控制：

[基于角色的访问控制](https://stackoverflow.com/questions/113543/role-based-access-control)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T15:41:05.327

我解决这个问题的方法是延迟加载我的身份验证层；它是一个实用程序类，它使用会话（默认情况下它使用`session_xyz()`函数和`$_SESSION`）来确定用户是否登录。

需要了解当前登录用户的页面将在顶部有这段代码：

```
$user = SiteConfig::getSharedAuth()->ensureLoggedIn(); 
```

那行代码将始终延迟加载返回当前登录用户的身份验证对象。为此，目标代码执行以下步骤：

1.  续会
2.  如果会话可以恢复，则在`$_SESSION['_user']`
3.  如果找到用户对象，则返回它
4.  如果未找到用户对象，则将当前路径存储在会话中并重定向到`/login`
5.  登录完成后，将用户对象存储在会话中并重定向到存储的路径
6.  返回第 1 步。

总而言之，除非另有说明，否则页面默认是公开的：）

# sql - 将日期时间值更新为相同的日期但保持时间

> ID：12162344
> 
> 赞同：6
> 
> 时间：2012-08-28T15:13:00.130
> 
> 标签：sql, sql-server

我处于一种情况，我想将表中所有值的日期更新为同*一天*，但保留每条记录的*时间*。

```
So these three dates...
8/28/2012 14:00:00
8/28/2010 12:00:00
8/28/2008 10:00:00

Should be turned into...
8/28/2012 14:00:00
8/28/2012 12:00:00
8/28/2012 10:00:00

UPDATE MySpecialTable
SET DateField = {...?}; 
```

**编辑：** 无论日期是哪一天（即 2012 年 8 月 28 日、2012 年 1 月 1 日、2012 年 4 月 1 日等），我都希望将时间和*批量更新*全天/月/年持续到一个特定的值。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T15:18:25.193

```
DECLARE @Target DATETIME;
SET @Target = '20120828';

-- if the date is supposed to be today rather than hard-coded or parameterized:

-- SET @Target = DATEADD(DAY, DATEDIFF(DAY, '19000101', CURRENT_TIMESTAMP), '19000101');

UPDATE dbo.MySpecialTable
  SET DateField = DATEADD(DAY, DATEDIFF(DAY, DateField, @Target), DateField); 
```

如果目标日期在列中的值之前或之后，这将起作用。

此外，如果您只关心时间，则应考虑使用[TIME 数据类型](http://msdn.microsoft.com/en-us/library/bb677243.aspx)（SQL 2008+）。这将使您可以在查询时轻松地将您想要的任何日期应用于数据，而无需实际执行任何更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:20:21.873

这是一种方法，假设您使用的是 SQL Server 2008 或更高版本：

```
update MySpecialTable
    set DateField = cast(CURRENT_TIMESTAMP as date) + (DateField - cast(DateField as date)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T15:22:25.113

试试这个（更新为具有相同的日期）：

```
DECLARE @myDate DATETIME
SET @myDate = '2012-08-28T00:00:00.000'
UPDATE [MySpecialTable]
   SET [DateField] = DATEADD(Day, 0-DATEDIFF(Day, 0, [DateField]), [DateField]) + @myDate 
```

*   `DATEADD(Day, 0-DATEDIFF(Day, 0, [DateField]), [DateField])`获取时间戳并将日期设为最小值 (1/1/1900)
*   将以上内容添加到变量中的所需日期

# jquery - 比较jquery中的2个价格，如果它们匹配添加一个类？

> ID：12162348
> 
> 赞同：2
> 
> 时间：2012-08-28T15:13:08.357
> 
> 标签：jquery

如果我返回匹配的 2 个价格，我将如何向 jquery 中的元素添加一个类？

假设这两个项目（Price1 和 Price2）都通过 JSON 返回，如果它们匹配，则将 class="red" 添加到元素。

下面是我现有的代码，我需要匹配**res.amzprice**和**res.lowprice**，如果两者都匹配我需要添加一个类到 res.lowprice td :)

```
 $.ajax({ type: "POST",
    url: "aWeb.asmx/GetLowPrices",
    data: "{ }",
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function (response) {
        $('#loading').hide();
        var result = response.d;
        var new_record = "";
        $.each(result, function (index, res) {
            new_record = "<tr id=\"" + res.sku + "\">" +
                         "<td scope=\"row\" class=\"t-left\"><a href=\"../product/editproduct.aspx?sku=" + res.sku + "\" title=\"Edit this product listing\">" + res.title + "</a></td>" +
                         "<td>" + res.sku + "</td>" +
                         "<td> £" + res.tprice + "</td>" +
                         "<td class=\"amzprice-edit\"><input type=\"text\" id=\"txt" + res.sku.replace(/[^a-z0-9\s]/gi, '').replace(/[_\s]/g, '-') + "\" value=\"" + res.amzprice + "\"> <img src=\"images/icons/info.png\" alt=\"Info\" title=\"Price (inc. Shipping): £xx.xx\" /></td>" +
                         "<td> £" + res.lowprice + " <img src=\"images/icons/info.png\" alt=\"Info\" title=\"Price: £xx.xx | Shipping: £xx.xx\" /> <a href=\"lowpricedata.aspx?sku=" + res.sku + "\" id=\"lnkInfoGrpah\" class=\"link-to info-graph\" data-fancybox-type=\"iframe\"><img src=\"images/icons/graph-icon.png\" alt=\"Info\" title=\"View Lowprice History\" /></a></td>" +
                         "<td><div class=\"twe-button mini update\">Update</div></td>" +
                         "</tr>";

            $('#dataResults').append(new_record);
        });

    },
    error: function (msg) {
        $('#loading').hide();
        $('#dataTable').hide();
        $('#infoMsg').show();
        $('#infoMsg').addClass('er-red');
        $('#infoMsg').html("Error while calling web service.");
    }
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T15:19:50.233

我建议：

```
$.each(result, function (index, res) {

    var lowPriceClass = res.amzprice == res.lowprice ? 'red' : 'noMatch';

    new_record = "<tr id=\"" + res.sku + "\">" +
                 "<td scope=\"row\" class=\"t-left\"><a href=\"../product/editproduct.aspx?sku=" + res.sku + "\" title=\"Edit this product listing\">" + res.title + "</a></td>" +
                 "<td>" + res.sku + "</td>" +
                 "<td> £" + res.tprice + "</td>" +
                 "<td class=\"amzprice-edit\"><input type=\"text\" id=\"txt" + res.sku.replace(/[^a-z0-9\s]/gi, '').replace(/[_\s]/g, '-') + "\" value=\"" + res.amzprice + "\"> <img src=\"images/icons/info.png\" alt=\"Info\" title=\"Price (inc. Shipping): £xx.xx\" /></td>" +
                 "<td class='" + lowPriceClass + "'> £" + res.lowprice + " <img src=\"images/icons/info.png\" alt=\"Info\" title=\"Price: £xx.xx | Shipping: £xx.xx\" /> <a href=\"lowpricedata.aspx?sku=" + res.sku + "\" id=\"lnkInfoGrpah\" class=\"link-to info-graph\" data-fancybox-type=\"iframe\"><img src=\"images/icons/graph-icon.png\" alt=\"Info\" title=\"View Lowprice History\" /></a></td>" +
                 "<td><div class=\"twe-button mini update\">Update</div></td>" +
                 "</tr>";

    $('#dataResults').append(new_record);
}); 
```

尽管让我感到震惊`lowPrice`的是，应该评估任何元素显示的“低价”是否*小于或等于*，而不仅仅是*等于*，所以我真的建议：

```
 var lowPriceClass = res.amzprice <= res.lowprice ? 'red' : 'noMatch'; 
```

这种方法使用三元运算符来评估返回布尔值的条件，如果发现为真则返回第一个值/变量（在本例中为`'red'`之后`?`和之前`:`），如果发现为假，则返回返回第二个值/变量（*后面*的那个`:`）并将返回的值/变量分配给变量名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T15:30:32.033

三元条件是您在这里寻找的：

```
new_record = "<tr id=\"" + res.sku + "\">" +
                     "<td scope=\"row\" class=\"t-left\"><a href=\"../product/editproduct.aspx?sku=" + res.sku + "\" title=\"Edit this product listing\">" + res.title + "</a></td>" +
                     "<td>" + res.sku + "</td>" +
                     "<td> £" + res.tprice + "</td>" +
                     "<td class=\"amzprice-edit\"><input type=\"text\" id=\"txt" + res.sku.replace(/[^a-z0-9\s]/gi, '').replace(/[_\s]/g, '-') + "\" value=\"" + res.amzprice + "\"> <img src=\"images/icons/info.png\" alt=\"Info\" title=\"Price (inc. Shipping): £xx.xx\" /></td>" +
                     "<td class="+((res.lowprice===res.amzprice)?'red':'green')"+> £" + res.lowprice + " <img src=\"images/icons/info.png\" alt=\"Info\" title=\"Price: £xx.xx | Shipping: £xx.xx\" /> 

<a href=\"lowpricedata.aspx?sku=" + res.sku + "\" id=\"lnkInfoGrpah\" class=\"link-to info-graph\" data-fancybox-type=\"iframe\"><img src=\"images/icons/graph-icon.png\" alt=\"Info\" title=\"View Lowprice History\" /></a></td>" +
                     "<td><div class=\"twe-button mini update\">Update</div></td>" +
                     "</tr>";

        $('#dataResults').append(new_record); 
```

此条件将检查价格并相应地分配类，如果匹配则给出“红色”类或“绿色”类。我使用“===”进行严格检查

((res.lowprice===res.amzprice)?'red':'green')

# apache - apache 出现问题 - 403 试图保护除 index.php 之外的所有内容

> ID：12162349
> 
> 赞同：1
> 
> 时间：2012-08-28T15:13:11.383
> 
> 标签：apache, .htaccess, webserver, xampp

**我想要的是：**

保护除 index.php 之外的所有文件/文件夹。

**阿帕奇：**

*   Apache/2.4.2 (Win32) OpenSSL/1.0.1c PHP/5.4.4
*   作为服务运行 (xampp 1.8)
*   未修改

**我的项目结构**

URL：“http://localhost/MyProject/”
PROJECT_DIRECTORY C:/xampp/htdocs/MyProject/

项目目录如下所示：

*   配置（文件夹）
*   资源（文件夹）
*   来源（文件夹）
*   索引.php

**问题：**

我的 .htaccess 文件有问题，因为我总是收到 403 甚至 500 错误。

我尝试了不同的设置来实现目标，但这些都不起作用。我尝试了 Directory、DirectoryMatch、Files、FilesMatch 等。

但我认为它应该很简单：

```
# Activate rewrite engine
RewriteEngine on
RewriteBase /

# Redirect all requests to index.php
RewriteRule ^(.*)$ index\.php?/$1 [QSA]

# Deny from all
Order deny,allow
Deny from all

# Allow only index.php
<Files "index.php">
Allow from all
</Files> 
```

~~或者是这样的：~~

 ~~```
...

# Deny from all
<Directory />
Order deny,allow
Deny from all
</Directory>

# Allow only root dir
<Directory "/MyProject" />
Allow from all
</Directory> 
```~~ 

~~有人可以帮助我吗？~~

 ~~**编辑：**我最近发现，我不能使用标记，因为 .htaccess 对我放入的目录有效，因此无需在 .htaccess 中定义该目录。这并没有解决我的问题，但我知道第二个例子是错误的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:04:19.050

你可以试试这个：

```
RewriteEngine On
RewriteCond %{REQUEST_URI} !^/(index\.php)$
RewriteRule ^ - [L,F] 
```

这将允许请求`/`和`/index.php`通过，同时以 403 Forbidden 响应其他任何内容。

但是，您已经有了这条规则：

```
# Redirect all requests to index.php
RewriteRule ^(.*)$ index\.php?/$1 [QSA] 
```

因此，如果所有内容都已通过 index.php 进行路由，则您实际上不需要否认任何事情~~

# javascript - js图像加载的奇怪结果，在safari和chrome中

> ID：12162353
> 
> 赞同：0
> 
> 时间：2012-08-28T15:13:21.173
> 
> 标签：javascript, jquery, image, load

我有几张图片，每张图片的宽度是 1400px，我想在加载所有图片后，提醒所有图片的总宽度，这是我的代码：

```
var images = new Array("0.jpg", "1.jpg", "2.jpg");

for (var i = 0; i < images.length; i = i + 1) {
    $("#img_place").append("<img src='" + images[i] + "'>");
}

var loadedImgsCount = 0;
var imgTotalWidth = 0;

for (var i = 0; i < images.length; i = i + 1) {

    var currImg = new Image();
    currImg.src = images[i];
    currImg.onload = function() {
        loadedImgsCount = loadedImgsCount + 1;
        imgTotalWidth = imgTotalWidth + currImg.width;
    }

}

interv = setInterval(function() {
    if (images.length === loadedImgsCount) {
        alert(imgTotalWidth );
        clearInterval(interv);
    }
}, 500); 
```

在 HTML 中：

```
 <div id="img_place">
 </div> 
```

此代码例如用于 3 个图像，问题是：在 chrome 和 safari 中，此代码的结果有时不正确：有时 1400，有时 2800 但有时正确：4200。在 opera 和 firefox 中，结果总是预期：4200。请告诉，我哪里出错了？为什么我的代码在 safari 和 chrome 中不正确？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T15:15:12.283

反过来做：

```
currImg.onload = function() {
    loadedImgsCount = loadedImgsCount + 1;
    imgTotalWidth = imgTotalWidth + currImg.width;
};
currImg.src = images[i]; 
```

您的问题是`onload`图像在缓存中时可能不会调用该函数，因为该`load`事件是在您设置`onload`回调之前生成的。

作为旁注，通常这样做是为了增加一个变量：

```
loadedImgsCount++; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:50:11.433

只要宽度属性不是硬编码的，我更喜欢检查图像的宽度以确定它是否已加载。这避免了缓存问题。

```
var
images = ["0.jpg", "1.jpg", "2.jpg"],
images_place = $("#img_place"),  
images_loaded_interval = setInterval(function() {
    var total_width = 0;

    for (var i = 0; i < images.length; i++)
        if($('img',images_place).eq(i).width()*1 == 0) return;
        else total_width += $('img',images_place).eq(i).width()*1;

     alert(total_width);
     clearInterval(images_loaded_interval);

}, 500);

for (var i = 0; i < images.length; i++)
    images_place.append("<img src='" + images[i] + "'>"); 
```

# jscrollpane - 将 jScrollPane 应用于附加了 ajax 的 div

> ID：12162363
> 
> 赞同：0
> 
> 时间：2012-08-28T15:13:35.443
> 
> 标签：jscrollpane, jquery-jscrollpane

我有一个显示三个单独循环的选项卡式小部件。在默认隐藏的第三个选项卡部分下，我显示了一个提供 ajax 结果的搜索。我的问题是我不知道如何将 jScrollPane 应用于结果的容器 div。每次输入搜索时，容器 div 都会被清空并附加新结果，因此我每次都需要重新应用它。这是我用来触发搜索的代码。

```
jQuery( function( $ ) {
// search filed
var $s = $( '#s' );
// the search form
var $sForm = $s.closest( 'form' );
console.log( $sForm );
$sForm.on( 'submit', function( event) {
    event.preventDefault();
    $.post(
        T5Ajax.ajaxurl,
        {
            action:     T6Ajax.action,
            search_term: $s.val()
        },
        function( response ) {
            $("#music-results").empty();
            $("#music-results").append( response );

        },
    );
 });
}); 
```

现在我有基本的调用来为其他循环设置jscrollpane，但这并没有应用于有问题的div，因为我猜它默认是隐藏的。

```
$(document).ready(function(){
  $('#music-results').jScrollPane({showArrows: true,autoReinitialise: false}); 
}); 
```

那么如何在每次清空 div 并添加新结果时将 jscroll 应用于 div 呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T01:19:56.867

没错，jscrollpane 不适用于未显示的内容（显示：无）。要解决您的问题，您只需在附加内容时调用 jscrollpane。

因此`$('#music-results').jScrollPane({showArrows: true,autoReinitialise: false});`，与其放入文档 ready()，不如简单地将其放在`$("#music-results").append( response );`. 然后它应该工作。

```
$.post(
        T5Ajax.ajaxurl,
        {
            action:     T6Ajax.action,
            search_term: $s.val()
        },
        function( response ) {
            $("#music-results").empty();
            $("#music-results").append( response );
            $('#music-results').jScrollPane({showArrows: true,autoReinitialise: false}); 

        },
    ); 
```

[还有另一种使用api](http://jscrollpane.kelvinluck.com/api.html)做你想做的事情的方法。为 api 声明一个全局变量，所有函数都可以使用该变量，然后将其设置为 document.ready()

```
var api;    
$(document).ready(function(){
      var element = $('##music-results').jScrollPane({showArrows: true,autoReinitialise: false});
      api = element.data('jsp'); //you can now access the api through this variable.
    }); 
```

然后，当您将内容附加到 #music-results 时，只需使用 api 重新初始化滚动窗格。

```
$.post(
            T5Ajax.ajaxurl,
            {
                action:     T6Ajax.action,
                search_term: $s.val()
            },
            function( response ) {
                $("#music-results").empty();
                $("#music-results").append( response );
                api.reinitialise();

            },
        ); 
```

但请记住，为了做到这一点，您的内容需要可见，因为 jscrollpane 需要计算高度，如果不显示，将找不到高度。因此，如果您附加内容并且选项卡不可见，只需在选项卡开关上重新初始化 jscrollpane。

希望这可以帮助。

# jquery-mobile - jquerymobile - 多页模板中的导航

> ID：12162365
> 
> 赞同：0
> 
> 时间：2012-08-28T15:14:01.257
> 
> 标签：jquery-mobile

我设置了一个多页模板。第一个页面有一组指向内页的链接——但是除了一个链接到同一个动态加载数据的#template 页面之外，所有链接都没有。另一个链接是我在页面中构建的表单。

我遇到的问题是当您导航到其中一个链接时，继续浏览页面，然后使用后退按钮返回第一页，如果您然后单击指向表单的链接，它不会导航到 #页面，它会转到您在其他链接中的最后一页。

希望这是有道理的——也许一张图表会让它更清楚

首页 > 产品列表 > 产品详情

产品详情 > 产品列表 > 主页（返回按钮）

首页 > 联系表格

最后一步再次显示产品详细信息页面，而不是联系表格。就好像它没有清除页面一样：

我的代码（为清楚起见截断）：

```
<script type="text/javascript">
    $(document).bind("mobileinit", function () {
        $.mobile.allowCrossDomainPages = true;
        $.support.cors = true;
    });

    $(document).delegate("#pageDetail", "pagecreate", function () {
        $(this).css('background', '#ECF2FE');//`this` refers to `#pageDetail`
    });

    $(document).bind("pagebeforechange", function (e, data) {           
        // We only want to handle changePage() calls where the caller is
        // asking us to load a page by URL.         

        if (typeof data.toPage === "string") {
            $.mobile.pageData = (data && data.options && data.options.pageData) ? data.options.pageData : null;
            // We are being asked to load a page by URL, but we only
            // want to handle URLs that request the data for a specific
            // category.

            var page;
            var type;
            var cat;
            if ($.mobile.pageData && $.mobile.pageData.type) {
                type = $.mobile.pageData.type;
            }

            if ($.mobile.pageData && $.mobile.pageData.cat) {
                cat = $.mobile.pageData.cat;
            }

            if ($.mobile.pageData && $.mobile.pageData.page) {
                page = $.mobile.pageData.page;
            }

            var url = $.url(data.toPage);   //  page url
            var hash = url.fsegment(1).replace(/&.*/, "");  //  nav hash for page holder            

            switch (hash) {
                case "pageList":
                    $.ajax({
                        url: "http://localhost/myapp/" + type + ".aspx?type=" + type,
                        datatype: "html",
                        success: function (data) {
                            $('.submenu').html(data);
                            $('.title').html(type);
                            $('.submenu').trigger('create');
                        }
                    });
                    break;
                case "pageDetail":
                    $('.detail').load('http://localhost/myapp/' + type + '.aspx?page=' + page + '&type=' + type + ' #contentdiv', function () {
                        $(this).trigger('create');
                    });
                    break;
                default:
                    break;
            }
        }
    });
</script>
</head> 
```

HTML 位

```
<body>
<div data-role="page" id="home">
    <div data-role="content">
        <a href="#pageList?type=products" data-transition="slide"><img src="images/Icon-Courses.png" alt="courses" /></a><br />
        <a href="#contactForm" data-transition="slide"><img src="images/Icon-Contact.png" alt="contact" /></a>              
    </div>
</div>

<div data-role="page" data-theme="a" id="pageList" data-add-back-btn="true" style="background-color:#F0F0F0 !important;">
    <div data-role="header" data-position="fixed">          
        <h1 class="title">Products</h1>      
    </div>
    <div data-role="content" class="submenu">   
        <!-- content gets put in here -->
    </div>

</div>

<div data-role="page" data-theme="a" id="pageDetail" data-add-back-btn="true" style="background-color:#F0F0F0 !important;">
    <div data-role="header" data-position="fixed">          
        <h1 class="title">Products</h1>      
    </div>
    <div data-role="content" class="submenu">   
        <!-- content gets put in here -->
    </div>

</div>

<div data-role="page" data-theme="a" id="contactForm" data-add-back-btn="true" class="detailpage" style="background-color:#F0F0F0 !important;">
    <div data-role="header" data-position="fixed">          
        <h1 class="title">Contact Us</h1>
    </div>
    <div data-role="content" class="detail">
        <div id="contentdiv" style="margin:10px auto;width:90%;">
        <label for="name">Your Name</label>
            <input type="text" id="name" style="width:90%;" data-mini="true" />
            <label for="email">Email Address</label>
            <input type="text" id="email" style="width:90%;" data-mini="true" />
            <label for="phone">Phone Number</label>
            <input type="text" id="phone" style="width:90%;" data-mini="true" />
            <label for="comments">Enquiry / Comments</label>
            <textarea id="comments" rows="80" style="width:90%;" data-mini="true"></textarea>
            <br />
            <input type="submit" id="submit" value="Send Enquiry Now" />                
        </div>
    </div>

</div>

</body>
</html> 
```

我正在使用 jqm.page.params.js 来处理查询字符串参数。

那里有什么明显的吗？#pageDetail 页面的链接在#pageList 上显示的内容中返回。

不明白为什么我似乎无法清除缓存，并且如果您先到过其他任何地方，它也无法正确导航到联系表单。如果你直接去那里它工作正常。

任何人有任何启示？顺便说一句，这需要单独使用 PhoneGap

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T08:59:10.260

实际上对此感觉有点暗淡，但这是因为我在多个 div 上具有相同的类名，并且它正在使用这些类名来导入数据 - 所以当它远程加载数据时，它会将它放在多个地方，覆盖表单同时...

# php - 在 Symfony2 中从 javascript 访问 php 变量

> ID：12162368
> 
> 赞同：0
> 
> 时间：2012-08-28T15:14:08.247
> 
> 标签：php, javascript, variables, symfony

我正在开发一个小型绘图工具，它在启动工具之前从用户那里收集一些数据。我正在使用 Symfony2 - 绘图工具是纯 JavaScript。

因此，一旦用户到达加载工具的页面，javascript 需要了解用户之前输入的一些数据（例如画布的高度和宽度），这些数据已通过表单发送到控制器。我使用模板中的变量没有问题，但无法使用 javascript 文件访问它们。

有没有办法在模板中设置 javascript 变量？

我已经像这样在模板中包含了javascript文件（有效）：

```
<script type="text/javascript" src="<?php echo $view['assets']->getUrl('bundles/mybundle/js/myjs.js') ?></script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T15:18:16.037

只需在模板中添加一些脚本标签，然后使用 PHP 将变量输出到其中。它可能看起来类似于：

```
<script type="text/javascript">
var canvasHeight = <?php echo $canvasHeight; ?>;
var canvasWidth = <?php echo $canvasWidth; ?>;
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T15:18:33.837

你不能在页面中用 php 打印变量吗？就像是

```
<script type="text/javascript">
    var t=<?php echo $var; ?>

</script> 
```

# python - 删除要合并在一起的具有不同属性的重复项

> ID：12162372
> 
> 赞同：0
> 
> 时间：2012-08-28T15:14:16.493
> 
> 标签：python, csv

我有以下 csv 文件：

```
name, sector, year, region, number

bob,,1999,AS,2

bob,hi-tech,,,3

mike,,2001,NE,2

plan,pharma,,,1 
```

我编写了一个脚本，该脚本查找“名称”对于一行及其下方的行相同的每个实例（csv 文件已按“名称”值排序）。我当前脚本的输出如下：

```
name, sector, year, region, number

bob,tennis,1999,AS,2+3

bob,tennis,,,3

mike,,2001,NE,2

plan, baseball,,,1 
```

这几乎就是我想要的。我当前脚本的优点在于它识别了“name”值相同的每个实例，然后将两行的所有属性与该名称组合在一起，并更新“number”列。我的脚本的问题是，一旦创建新行，就应该删除进入合并的两行。在上面的例子中，第二行：

```
bob,tennis,,,3 
```

不应该在这里。我已经在下面复制了我的实际脚本的相关部分，并且非常感谢任何人可以提供的任何澄清。

```
for next_row in reader:
        first_name = first_row['name']
        next_name = next_row['name']

        if first_name == next_name:
            if first_row['source'] == '2':
                #get relevant attributes from next_row and add them to first_row

                first_row['number'] = first_row['number'] + ' + ' + next_row['number']
            elif next_row['number'] == '2':
                #get relevant attributes from next_row and add them to first_row

                first_row['number'] = first_row['number'] + ' + ' + next_row['number']
            writer.writerow(first_row)
            first_row = next_row
        else:
            writer.writerow(first_row)

            first_row = next_row 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T21:02:58.883

正如评论中所建议的那样，您可能希望使用迭代器来`reader`. 如果`reader`有`next`方法，你就可以；否则，您可以使用`reader=iter(reader)`.

首先，定义你的`first_row`: 你可以简单地做`first_row = reader.next()`.

然后，只需一个接一个地尝试一个条目：您将编写您的行并`first_row`仅在它不再等于时更新您的行`next_row`。

一旦迭代器被完全消耗掉，`StopIteration`就会引发 a 。你只需要写最后一个`first_row`。

```
try:
    while True:
        next_row = reader.next()
        if first_row["name"] == next_row["name"]:
            ...do_something...
        else:
            writer.writerow(first_row)
            first_row = next_row
except StopIteration:
    writer.writerow(first_row) 
```

# iphone - 围绕屏幕外的一个点旋转 UIImageView？（uiImageView 的中心

> ID：12162374
> 
> 赞同：0
> 
> 时间：2012-08-28T15:14:16.923
> 
> 标签：iphone, ios, objective-c, rotation, quartz-graphics

嗨，我有一个 UIImageView 部分在屏幕上，部分在屏幕外。

我想围绕屏幕外的一个点（视图的中心）旋转视图。

我该怎么做呢？

```
fullRotationAnimation           = [CABasicAnimation animationWithKeyPath:@"transform.rotation"];
    fullRotationAnimation.fromValue= [NSNumber numberWithFloat:0.0f];
    fullRotationAnimation.toValue   = [NSNumber numberWithFloat:2 * M_PI];
    fullRotationAnimation.duration  = 4;
    fullRotationAnimation.repeatCount = 1;
    [self->greyRings.layer addAnimation:fullRotationAnimation forKey:@"360"]; 
```

我目前正在使用该代码，但它只是围绕屏幕中心旋转。

请问有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:29:41.143

使用块动画：

```
- (void)rotateImageView:(UIImageView *)imageView aroundPoint:(CGPoint)point byAngle:(CGFloat)angle {

    CGFloat sinA = sin(angle);
    CGFloat cosA = cos(angle);
    CGFloat x = point.x;
    CGFloat y = point.y;

    CGAffineTransform transform = CGAffineTransformMake(cosA,sinA,-sinA,cosA,x-x*cosA+y*sinA,y-x*sinA-y*cosA);

    [UIView animateWithDuration:4.0 animations:^{
        imageView.transform = transform;
    }];
} 
```

请注意，角度以弧度为单位，因此完整旋转为 2.0*M_PI。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T15:45:57.157

也许您必须设置 CALayer 的 anchorPoint：有关详细信息，请参阅[指定图层的几何图形。](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/CoreAnimation_guide/Articles/Layers.html#//apple_ref/doc/uid/TP40006082)

```
//(0,0) is the left-bottom of your layer bounds
self->greyRings.layer.anchorPoint = CGPointMake(0.0f, 0.0f); 
```

我认为负锚点也应该起作用。所以你最好给出你的界限，我们可以为你计算。

# git - 如何使用 git 将另一个分支中的文件检出到当前分支中的新文件中？

> ID：12162376
> 
> 赞同：4
> 
> 时间：2012-08-28T15:14:20.530
> 
> 标签：git

假设我在 HEAD 的分支 master 中有一个文件 core.clj，它与 HEAD 的其他分支中的 core.clj 不同，并且我目前在其他分支中。我想用其他文件名（比如 tmp.clj）将 master 的 core.clj 检出到当前分支中，以便于比较。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T15:59:16.707

您可以使用`git show master:core.clj`来显示文件。将其重定向到一个新文件 (`git show ... > temp.clj`以保存它以供进一步处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T15:18:36.080

你不需要；`git diff`会做你需要做的。 `git diff master otherbranch core.clj`是该命令的基本用法，如果您需要更多帮助，`man git-diff`可以向您解释更多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T15:39:59.430

这很简单：

```
 git checkout master -- core.clj 
```

# jquery - jQuery ajax 记住变量

> ID：12162379
> 
> 赞同：0
> 
> 时间：2012-08-28T15:14:33.867
> 
> 标签：jquery, variables

我需要跟踪之前所做的选择

此代码在每次 ajax 成功后运行

```
var region = $("#regionDropDown :selected").html();
var newRegion;

if ($('#regionDropDown').find("option:selected[value!='all']").length) {
    var region = newRegion;
    var newRegion = "-Region: " + $("#regionDropDown :selected").html();
}​ 
```

但这不起作用，我在区域上不确定。

有小费吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T15:16:26.947

您分配 region = newRegion 这意味着它们现在都未定义并且您的数据丢失了。你不需要那行 ( `var region = newRegion;`)

# asp.net - 我想在网格视图中表示工作日

> ID：12162380
> 
> 赞同：0
> 
> 时间：2012-08-28T15:14:41.340
> 
> 标签：asp.net, datetime, gridview, weekday

```
<asp:GridView ID="grid1" runat="server" AutoGenerateColumns="False">

   <Columns>
      <asp:BoundField DataField='id' HeaderText="Id" Visible="False" />
      <asp:BoundField DataField='Name' Visible="True"  HeaderText="Full Name"/>

     <asp:BoundField  HeaderText="Monday"  />   
     <asp:BoundField  HeaderText="Tuesday" />   
     <asp:BoundField  HeaderText="Wednesday"  />   
     <asp:BoundField  HeaderText="Thursday"  />   
      <asp:BoundField HeaderText="Friday"  />              
  </Columns>

</asp:GridView>

<asp:TextBox ID="tbFirstDate" runat="server"></asp:TextBox> 
```

//在作为此grid1 源的DataTable 中，我有一列“日期”，但在网格中我需要显示带有该日期的工作日（例如，2012 年8 月20 日星期一）。我还有一个 TextBox(tbFirstDate) 定义哪一天是星期一，所以使用该信息我需要计算工作日的其余时间，日期格式为 yyyy-mm-dd

我使用 PostreSQL，这是 SQL 查询：

```
SELECT  *  FROM Table1
WHERE  id1=212 AND date BETWEEN '20.08.2012' AND  '24.08.2012'
ORDER BY date 
```

![在此处输入图像描述](../Images/fb1f6761578c859bb46c8d502604c82b.png)

现在这个结果我想像这样在网格中表示

![在此处输入图像描述](../Images/4ffab12ae0e8b920a68639de65250dfa.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T16:02:41.870

所以基本上你的实际问题是如何`DateTime's` `DayOfWeek`通过它到指定的一周的第一天的距离来改变一个值？

然后你可以使用这个方法：

```
public static int Weekday(DateTime dt, DayOfWeek startOfWeek)
{
    return (dt.DayOfWeek - startOfWeek + 7) % 7;
} 
```

例如，假设用户输入今天以指定这`Tuesday`是一周的开始：

```
DateTime value = new DateTime(2012, 8, 20);
DayOfWeek weekday = (DayOfWeek)Weekday(value, DateTime.Now.DayOfWeek);
Console.Write("normally:{0} changed to:{1}", value.DayOfWeek, weekday); 
```

演示：http: [//ideone.com/Zk99b](http://ideone.com/Zk99b)

如果是这样，您只需使用该方法中`RowDataBound`的该方法，根据指定的日期和GridViewRow中的值手动`GridView`设置标签的文本。用于获取对标签的引用。`TemplateField``tbFirstDate``date``DataItem``GridViewRow.FindControl("LabelID")`

# applescript - 使用 AppleScript 将邮件消息设置为纯文本

> ID：12162392
> 
> 赞同：3
> 
> 时间：2012-08-28T15:15:18.027
> 
> 标签：applescript, plaintext, apple-mail

我有一个 AppleScript 可以很好地整理信息并创建带有附件的电子邮件。

我找不到脚本将消息格式设置为接收收件箱所需的“纯文本”（而不是默认的“富文本”）的方法。

是否有 AppleScript 方法（或技巧）将消息格式设置为“纯文本”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-11T21:48:39.060

我在试图解决这个问题时发现了这个问题。最终我想出了以下解决方案：

```
tell application "Mail"
    set newMessage to make new outgoing message 
        with properties {visible:true,
                         subject:"message title",
                         sender:"sender@from.address",
                         content:mailBody}
    tell newMessage
        make new to recipient with properties {address:"mail@recipient.com"}
    end tell
    activate
end tell

tell application "System Events"
    click menu item "Make Plain Text" of ((process "Mail")'s (menu bar 1)'s (menu bar item "Format")'s (menu 1))
end tell 
```

希望有人会发现这很有用，我知道我会在几个小时前！

这在 Mail 版本 7.3 和 12.4 上进行了测试。较新或较旧的版本可能需要不同的菜单标题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:55:32.507

在脚本中创建消息的部分之前，添加此行。

```
 tell application "Mail" to set default message format to plain text 
```

在脚本的最后添加这个来重置值

```
 tell application "Mail" to set default message format to rich text 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-12T01:09:54.570

您可以使用键盘快捷键`⌘</kbd>`shift`**`t`** also to change the message format to `plain text`:`

```
tell application "System Events" to keystroke "t" using {command down, shift down} 
```

在邮件版本 12.4 中测试

# facebook - FOSFacebookBundle 打破了 FOSUserBundle 的“记住我”

> ID：12162394
> 
> 赞同：2
> 
> 时间：2012-08-28T15:15:31.247
> 
> 标签：facebook, symfony, login, fosuserbundle, fosfacebookbundle

**问题：**

我们一直在为 Symfony2 使用 FOSUserBundle，一切正常，包括“记住我”。

我们最近推出了 FOSFacebookBundle。从那时起，“正常”登录的“记住我”就被打破了。

**例如：**

当我们只使用 FosUSer 时，如果用户通过登录表单登录，并且停留，例如 5 小时没有活动，在单击任何链接后一切都继续工作，用户登录并识别。

当我们激活 FosFacebook 时，同一个用户也通过登录表单（不是从 facebook）登录，并保持一段时间没有活动。单击任何链接后，他将被重定向到登录表单，并在再次输入其密码后，将再次重定向到目标 URL。

如果我们从配置中停用 FosFacebook，则 FosUser 的“记住我”会再次正常工作。

**问题：**

FosFacebook 打破 FosUser “自然” 让不使用 FB 的用户记住我是正常的吗？

如果应该正常工作......谁能看到我们是否在我们的配置文件中犯了错误？

**配置文件：**

配置.yml

```
# FOS User
fos_user:
    db_driver: %database_method% # other valid values are 'mongodb', 'couchdb'
    firewall_name: main
    user_class: Common\ODMBundle\Document\User
    from_email:
        address:        %fos_email_address%
        sender_name:    %fos_sender_name%
    profile:
        form:
            type:               fos_user_profile
            handler:            fos_user.profile.form.handler.default
            name:               fos_user_profile_form
            validation_groups:  [Profile]
    change_password:
        form:
            type:               fos_user_change_password
            handler:            fos_user.change_password.form.handler.default
            name:               fos_user_change_password_form
            validation_groups:  [ChangePassword]
    registration:
        confirmation:
            enabled:    true
            template:   FOSUserBundle:Registration:email.txt.twig
        form:
            type:               fos_user_registration
            handler:            fos_user.registration.form.handler.default
            name:               fos_user_registration_form
            validation_groups:  [Registration]
    resetting:
        token_ttl: 600
        email:
            template:   FOSUserBundle:Resetting:email.txt.twig
        form:
            type:               fos_user_resetting
            handler:            fos_user.resetting.form.handler.default
            name:               fos_user_resetting_form
            validation_groups:  [ResetPassword]

# FOS facebook
fos_facebook:
    file:   %kernel.root_dir%/../vendor/facebook/src/base_facebook.php
    alias:  facebook
    app_id: xxxxxxxxxxxxxxx
    secret: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    cookie: true
    permissions: [email, user_birthday] 
```

安全.yml

```
security:
    providers:
        fos_userbundle:
            id: fos_user.user_manager
        my_fos_facebook_provider:
            id: my.facebook.user

    factories:
          - "%kernel.root_dir%/../vendor/bundles/FOS/FacebookBundle/Resources/config/security_factories.xml"

    firewalls:
        main:
            pattern: ^/
            fos_facebook:
                check_path: /login_checkFB
                default_target_path: /user/
                provider: my_fos_facebook_provider
            form_login:
                provider: fos_userbundle
                default_target_path: /user/
            logout:       true
            anonymous:    true
            switch_user:  true
            remember_me:
                key:      aSecretKey
                lifetime: 604800
                path:     /
                domain:   ~

    access_control:
        #- { path: ^/.*$, role: IS_AUTHENTICATED_ANONYMOUSLY }
        - { path: ^/login$, role: IS_AUTHENTICATED_ANONYMOUSLY }
        - { path: ^/register, role: IS_AUTHENTICATED_ANONYMOUSLY }
        - { path: ^/resetting, role: IS_AUTHENTICATED_ANONYMOUSLY }
        - { path: ^/private/, role: ROLE_USER }
        - { path: ^/user/, role: ROLE_USER }
        - { path: ^/admin/, role: ROLE_ADMIN }

    role_hierarchy:
        ROLE_ADMIN:       ROLE_USER
        ROLE_SUPER_ADMIN: [ROLE_ADMIN, ROLE_ALLOWED_TO_SWITCH] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-03T13:35:52.133

添加 facebooklogin 后，你记得我开始使用 Facebookprovider 检查登录凭据。您可以像这样将 user_provider 添加到记住我的配置中：

```
remember_me:
    key:      aSecretKey
    lifetime: 604800
    path:     /
    domain:   ~
    user_provider: fos_userbundle 
```

添加这将解决您的问题。

# java - 从其他方法访问对象

> ID：12162397
> 
> 赞同：0
> 
> 时间：2012-08-28T15:15:33.137
> 
> 标签：java, object, instantiation

如何以另一种方法访问在构造函数中实例化的对象？（例如下面的对象 b）实例化这个对象的最佳方法是什么，以便我的所有类方法都可以访问同一个对象？

```
public class ClassA{ 
  private final int size;       

  public ClassA(int N){
      size = N;    
      ClassB b = new ClassB(size);
  }

  public void doSomething(){
      b.doSomething();        
  }      
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T15:16:48.327

您只需要将其分配给一个字段：

```
public class ClassA{ 
  private final int size;       
  private final ClassB b;

  public ClassA(int N){
    size = N;    
    b = new ClassB(size);
  }

  public void doSomething(){
    b.doSomething();        
  }      
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T15:16:47.173

将 ClassB b 定义为实例变量。

```
public class ClassA{ 
  private final int size;       
 ClassB b;
  public ClassA(int N){
  size = N;    

  b = new ClassB(size);
  }

  public void doSomething(){
  b.doSomething();        
  }      
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-28T15:16:54.350

就像您所做的那样将其声明为一个字段`size`：

```
public class ClassA{ 
  private final int size;   
  private final ClassB b;    

  public ClassA(int N){
    size = N;    

    b = new ClassB(size);
  }

  public void doSomething(){
    b.doSomething();        
  }      
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-28T15:19:19.223

您可以简单地创建 B 类型的属性/字段

```
public class ClassA{ 
  private final int size;       
  private B bInstance;

  public ClassA(int N){
  size = N;    

  bInstance = new ClassB(size);
  }

  public void doSomething(){
  b.doSomething();        
  }      
} 
```

# javascript - Node.js 使变量等待分配，直到回调函数完成

> ID：12162400
> 
> 赞同：2
> 
> 时间：2012-08-28T15:16:06.967
> 
> 标签：javascript, node.js, mongodb, express, mongoose

我正在使用 Node.js、Express、MongoDB 和 Mongoose。我有一个函数可以获取我的 MongoDB 数据库中文档的最大 ID 号并将其返回给程序。我已经开始模块化我的代码，并将该功能迁移到另一个模块。我已经成功访问​​了主模块中的函数，但它涉及到异步数据库查询。当函数返回一个值时，我想将它分配给一个变量。不幸的是，当将返回值赋给变量时，变量实际上被设置为未定义。我正在考虑使用事件发射器来表示查询已完成，但这也带来了两个问题：

1）我不认为你可以在一个返回语句之后在程序中做任何事情，这将是需要的。

2) 模块之间的事件发射器看起来非常挑剔。

请帮助我将变量分配给正确的值。主要功能和模块的代码如下：

**（主文件）app.js：**

```
//requires and start up app
var express = require('express');
var mongoose = require('mongoose')
  , dbURI = 'localhost/test';
var app = express();
var postmodel = require('./models/post').postmodel;

//configures app for general stuff needed such as bodyParser and static file directory
app.configure(function () {
    app.use(express.bodyParser());
    app.use(express.static(__dirname + '/static'));
});

//configures app for production, connects to mongoLab databse rather than localhost
app.configure('production', function () {
    dbURI = 'mongodb://brad.ross.35:lockirlornie@ds037387.mongolab.com:37387/heroku_app6901832';
});

//tries to connect to database.
mongoose.connect(dbURI);
//once connection to database is open, then rest of app runs
mongoose.connection.on('open', function () {
    var PostModel = new postmodel();
    var Post = PostModel.setupPostSchema();
    var largest_id = PostModel.findLargestID(Post); 
```

**（模块）post.js：**

```
var mongoose = require('mongoose');

module.exports.postmodel = function () {
    this.setupPostSchema = function () {
        var postSchema = new mongoose.Schema({
                title: String,
                body: String,
                id: Number,
                date_created: String
            });

        var Post = mongoose.model('Post', postSchema);
        return Post;
    };

    this.findLargestID = function (Post) {
        Post.find(function (err, posts) {
            if (err) {
                console.log("error finding largest ID!");
            } else {
                var largest_id = 0;
                for (var post in posts) {
                    if (posts[post].id >= largest_id) largest_id = posts[post].id;
                }
                console.log(largest_id);
                return largest_id;
            }
        });
    };
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T15:38:24.240

您需要`findLargestID`接受一个回调参数，该参数将`largest_id`在可用时调用：

```
this.findLargestID = function (Post, callback) {
    Post.find(function (err, posts) {
        if (err) {
            console.log("error finding largest ID!");
            callback(err);
        } else {
            var largest_id = 0;
            for (var post in posts) {
                if (posts[post].id >= largest_id) largest_id = posts[post].id;
            }
            console.log(largest_id);
            callback(null, largest_id);
        }
    });
}; 
```

# directx - HLSL 无效 ps_2_0 输入语义 POSITION0

> ID：12162408
> 
> 赞同：3
> 
> 时间：2012-08-28T15:16:24.450
> 
> 标签：directx, hlsl, directx-9, rendermonkey

我正在尝试在 RenderMonkey 中为 Dx9 编写一个 phong 着色器效果。

我在像素着色器中遇到编译错误

> *"无效的 ps_2_0 输入语义 'POSITION0'"*

而且我不确定如何解决它，尽管我知道它必须与 VS_OUTPUT 中的 POSITION0 语义有关。

我尝试将 VS_OUTPUT 的 Pos 语义更改为 TEXCOORD0，但随后系统报告

> *顶点着色器必须至少写入 POSITION 的所有四个组件*

下面提供了着色器。有什么建议么？

这是我的顶点着色器：

```
struct VS_INPUT 
{
   float4 Pos : POSITION0;
   float3 Normal : NORMAL0;
};

struct VS_OUTPUT 
{
   float4 Pos : POSITION0;
   float3 Normal : TEXCOORD0;
};

VS_OUTPUT vs_main( VS_INPUT Input )
{
   VS_OUTPUT Output;

   Output.Pos     = Input.Pos;
   Output.Normal  = Input.Normal;

   return Output;  
} 
```

和我的像素着色器：

```
 float4x4 matViewProjection;

// light source
float4 lightPos;
float4 Ambient;
float4 Diffuse;
float4 Specular;

// material reflection properties
float4 Ke;
float4 Ka;
float4 Kd;
float4 Ks;
float  nSpecular;

// eye
float4 eyePosition;

struct VS_OUTPUT 
{
   float4 Pos : POSITION0;
   float3 Normal : TEXCOORD0;
};

float4 ps_main( VS_OUTPUT vsOutput ) : COLOR0
{   
   vsOutput.Pos = mul( vsOutput.Pos, matViewProjection );

   float3 ViewDirection = normalize( eyePosition.xyz - vsOutput.Pos.xyz );
   float3 LightDirection = normalize( lightPos.xyz - vsOutput.Pos.xyz );

   float3 N = normalize( vsOutput.Normal );
   float3 R = reflect( -LightDirection, N );

   float LdotN = max( 0.0, dot( LightDirection, N ) );
   float VdotR = max( 0.0, dot( ViewDirection, R ) );

   // find colour components
   float4 a = Ka * Ambient;
   float4 d = Kd * Diffuse * LdotN;
   float4 s = Ks * Specular * pow( VdotR, nSpecular );

   float4 FragColour = Ke + a + d + s;
   return FragColour;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T11:09:00.357

好的，我为感兴趣的人找到了解决方案。

顶点着色器应定义以下结构：

```
struct VS_INPUT 
{
   float4 Pos : POSITION0;
   float3 Normal : NORMAL0;
};

struct VS_OUTPUT 
{
   float4 Pos : POSITION0;
   float4 PosOut : TEXCOORD0;
   float3 Normal : TEXCOORD1;
}; 
```

VS_OUTPUT 结构在像素着色器中应该不同：

```
struct VS_OUTPUT 
{
   float4 PosOut : TEXCOORD0;
   float3 Normal : TEXCOORD1;
}; 
```

我的问题源于您不能将 POSITION 语义作为像素着色器的输入。至少对于 ps_2_0。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-27T02:22:35.027

作为用户，不允许使用`POSITION0`. 这个属性似乎在 Vertex 和 Pixel Shader 之间的某个点被切断了。`VertexShaderOutput``PixelShaderFunction`

相反，您需要在 中声明另一个属性`VertexshaderOutput`，例如，

```
float4 newPosition : TEXCOORD1; 
```

您分配与 相同的值`POSITION0`。这个新属性，你可以在`PixelShaderfunction`.

# jackson - 杰克逊使用 JsonSerialize.Inclusion.NON_NULL 除了一类

> ID：12162413
> 
> 赞同：23
> 
> 时间：2012-08-28T15:16:34.283
> 
> 标签：jackson

我通常使用 objectMapper.setSerializationInclusion(JsonSerialize.Inclusion.NON_NULL) 因为我从不希望我的类的空值被序列化。除了现在我应该写出一个特定的字段，即使它是空的。我可以在这个字段上添加一个快速注释来覆盖该字段的 Inclusion.NON_NULL 属性吗？实现这一目标的好方法是什么？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-08-28T15:52:33.987

对于 Jackson 1.x，您可以使用`@JsonSerialize(include = Inclusion.ALWAYS)`，对于 Jackson 2.x，您可以使用`@JsonInclude(Include.ALWAYS)`. 这些注释将覆盖您的默认配置`ObjectMapper`。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-05-13T21:27:42.767

@user1433372，JsonInclude 是仅适用于 Jackson 2.x 的注释。

在杰克逊 1.9

```
@JsonSerialize(include=JsonSerialize.Inclusion.NON_EMPTY) 
```

在 Jackson 2.x 中与

```
@JsonInclude(JsonInclude.Include.NON_EMPTY) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-05-12T06:17:26.020

使用杰克逊 1.9`@JsonSerialize(include= JsonSerialize.Inclusion.ALWAYS)`

`@JsonSerialize(include=Include.ALWAYS)`没有编译。

# r - 对计数值进行聚类

> ID：12162417
> 
> 赞同：3
> 
> 时间：2012-08-28T15:16:46.333
> 
> 标签：r, cluster-analysis, heatmap

我有一个表，其中包含每个组内每个变量的计数。

```
Age var1 var2 var3 var4
10  0    200  0    100 
20  180  500  200  300
30  0    80   0    60
40  150  10   90   20 
```

我正在尝试使用 R 创建热图。在热图的结果中，列的顺序与它们在数据中的顺序相同。

我需要以将具有相似值的变量聚集在一起的方式排列/聚集这些列（以提供聚集的外观）。

在上面的示例中，查看计数（值），var1 与 var3 更相似，而 var2 与 var4 更相似。

这是生成相同的代码：

```
tmp = rbind(c(0,200,0,100),
rbind(c(180,  500,  200,  300),
rbind(c (0,    80,   0,    60), 
c(150,  10,   90,   20)
)))
rownames(tmp) = c('age10', 'age20', 'age30', 'age40')
colnames(tmp) = c('var1', 'var2', 'var3', 'var4')
tmp
heatmap(tmp, Rowv=NA, Colv=NA, 
        col = heat.colors(256), scale="column", margins=c(5,10)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T16:16:40.010

只需删除`Rowv=NA`和`Colv=NA`参数，热图将按值聚类：

```
heatmap(tmp, col = heat.colors(256), scale="column", margins=c(5,10)) 
```

# java - 如何找到 log4j 默认初始化中使用的 URL？

> ID：12162423
> 
> 赞同：4
> 
> 时间：2012-08-28T15:16:55.893
> 
> 标签：java, logging, log4j

[Log4j 默认初始化](http://logging.apache.org/log4j/1.2/manual.html#defaultInit)通过一个过程来查找和使用 URL 进行配置。之后，您如何找出最终使用的 URL，而不必自己编写相同的程序？（如果您必须自己编写代码，您可能无法得到与 log4j 完全相同的代码，而且它可能会在未来的版本中发生变化。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-30T16:04:06.767

使用的过程被硬编码在 中的静态初始化程序块中`LogManager`，因此似乎没有办法挂钩它。它告诉你发生了什么的唯一地方是

```
LogLog.debug("Using URL ["+url+"] for automatic log4j configuration."); 
```

但`LogLog`它本身是硬编码的，可`System.out.println`用于这些消息，所以我能看到的唯一可能性是打开调试（`-Dlog4j.debug=true`）并`System.setOut`在 log4j 初始化之前以某种方式连接，然后解析调试日志消息。但这可能比自己编写配置过程更脆弱。

即便如此，在默认配置过程（例如 Spring ）之后可能已经应用了其他编程配置`Log4jConfigListener`- 不一定有单个配置 URL。

将 log4j 功能请求放入一个可以从其他地方调用的静态方法中分解配置文件搜索代码可能是值得的，但是当您可能不得不处理较早版本的 log4j 时，这将无济于事。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-30T23:01:02.803

如果你愿意使用 AspectJ LTW (load-time weaving)，你可以看看`LogManager`Ian Roberts 提到的静态初始化。在*log4j 1.2.14*中，它看起来像这样：

```
static {
    // (...)
    // if there is no default init override, then get the resource
    // specified by the user or the default config file.
    if (override == null || "false".equalsIgnoreCase(override)) {
        // (...)
        URL url = null;

        // (...)    
        // If we have a non-null url, then delegate the rest of the
        // configuration to the OptionConverter.selectAndConfigure method.
        if (url != null) {
            LogLog.debug("Using URL [" + url + "] for automatic log4j configuration.");
            OptionConverter.selectAndConfigure(
                url, configuratorClassName, LogManager.getLoggerRepository()
            );
        } else {
            LogLog.debug("Could not find resource: [" + configurationOptionStr + "].");
        }
    }
} 
```

显然，如果可以确定默认 URL，`OptionConverter.selectAndConfigure(URL, ..)`则将在静态块内的某一点调用，以便使用该 URL初始化*log4j 。*

通过*AspectJ*，捕获该方法调用非常简单：

```
import java.net.URL;
import org.apache.log4j.helpers.OptionConverter;
import org.apache.log4j.LogManager;

public aspect Log4jAspect {
    before(URL defaultURL) :
        within(LogManager) &&
        cflow(staticinitialization(LogManager)) &&
        call(* OptionConverter.selectAndConfigure(URL, ..)) &&
        args(defaultURL, ..)
    {
        System.out.println("log4j default URL = " + defaultURL);
    }
} 
```

在散文中，这段代码意味着：

*   如果我们在 LogManager 类中并且
*   在静态类初始化的控制流程中和
*   `OptionConverter.selectAndConfigure`叫做，
*   然后捕获第一个参数（URL）和
*   将其打印到控制台（您也可以执行其他操作）。

如果没有默认 URL，则不会打印任何内容。您可以将其分配给任何类的静态成员或您喜欢的任何东西，而不是打印 URL。

这是您的问题的解决方案，我对其进行了测试，并且可以正常工作。我很乐意收到回答您问题的赏金，即使该解决方案可能使用了您没有想到的技术。但它解决了问题。:-)

* * *

**编辑：**在没有找到默认 URL 的情况下，也可以显式拦截日志调用，即使我认为没有必要。我只是想提一下。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-03T04:33:51.130

如果您可以设置自己的配置器，则可以执行以下操作：

设置 JAVA 系统属性： -Dlog4j.configuratorClass=MyConfigurator 然后让您的配置器实例拦截 doConfigure 调用。

```
public class MyConfigurator implements Configurator
{
    public static URL url;

    @Override
    public void doConfigure(URL url, LoggerRepository repository)
    {
        this.url = url;
        new PropertyConfigurator().doConfigure(url, repository);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-31T11:47:23.070

将此插入您的 java 调用中：

```
-Dlog4j.configDebug=true 
```

就这样。

# html - 当两个表格单元格都有内表时如何确保两列对齐

> ID：12162427
> 
> 赞同：1
> 
> 时间：2012-08-28T15:17:07.957
> 
> 标签：html, css

我有一个 HTML 表格，其中单元格 #3 和单元格 #4 有内部表格。

我需要单元格#3 和单元格#4 中每个表中的行正确排列。

问题有时是一行文本行的长度可能超过一行，而另一个表没有这个，所以行不匹配。

由于数据来自我无法控制的数据库，我该如何纠正这种看法？

我创建了一个 jsfiddle：http: [//jsfiddle.net/HPkvV/](http://jsfiddle.net/HPkvV/)

```
<style>
.main
{
 border: 1px solid #000000;
}
.main td
{
 border: 1px solid #000000;
}
.grid
{
    border-left: none !important;
    border-right: none !important;
    border-top:1px solid #dddddd;
    border-bottom:1px solid #dddddd;
}
.grid td
{
    border-left: none !important;
    border-right: none !important;
    border-top:1px solid #dddddd;
    border-bottom:1px solid #dddddd;
}
</style>

<table width="400">
<tr>
    <td>
        <table width="100%" class="main">
            <td valign=top>column 1</td>
            <td valign=top>column 2</td>
            <td valign=top>column 3
                <table id="names" class="grid">
                    <tr>
                        <td>line 1</td>
                    </tr>
                    <tr>
                        <td>line 2</td>
                    </tr>
                    <tr>
                        <td>line 3</td>
                    </tr>
                </table>
            </td>
            <td valign=top>column 4
                <table id="desc" class="grid">
                    <tr>
                        <td>line 1 description is a little too long so it wraps line 1 description is a little too long so it wraps</td>
                    </tr>
                    <tr>
                        <td>line 2 description</td>
                    </tr>
                    <tr>
                        <td>line 3 description</td>
                    </tr>
                </table>
            </td>

        </table>
    </td>
</tr>
</table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:45:08.483

您使用嵌套表是否有原因？第二组信息看起来可能包含在列表中。如果是这样的话，让一切都变得美好起来会容易得多。

风格

```
.main
{
 border: 1px solid #000000;
}
.main td, .main th
{
 border: 1px solid #000000;
    vertical-align: top;
}
.grid li
{
    height: 4em; /*  this is the value that will help you get them even.  Though you will be guessing, hoping that no content runs too long.*/
    border-bottom:1px solid #dddddd;
} 
```

HTML

```
<table class="main">
    <thead>
        <tr><th>Column 12</th>
        <th>Column 2</th><th>Column 3</th><th>Column 4</th></tr>
    </thead>
    <tbody>                    
        <tr>
            <td>foo</td>
            <td> bar</td>
            <td>
                <ul class="grid">
                    <li>
                        line 1
                    </li>
                    <li>
                        line 2
                    </li>
                    <li>
                        line 3
                    </li>
                </ul>
            </td>
            <td>
                <ul class="grid">
                    <li>
                        line 1 description is a little too long so it wraps line 1 description is a little too long so it wraps
                    </li>
                    <li>
                        line 2 description
                    </li>
                    <li>
                        line 3 description
                    </li>
                </ul>                
            </td>
        </tr>
    </tbody>
</table>​ 
```

如果对数据有一点了解，这不是一个完整的解决方案。我也用这个解决方案更新了你的小提琴。

哎呀新小提琴[http://jsfiddle.net/HPkvV/2/](http://jsfiddle.net/HPkvV/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T16:07:36.687

```
 <style>
  .main
 {
 border: 1px solid #000000;
 }
 .main td
  {
    border: 1px solid #000000;
  }
 .grid
 {
table-layout: fixed;
overflow: scroll;
border-left: none !important;
border-right: none !important;
border-top:1px solid #dddddd;
border-bottom:1px solid #dddddd;

}
.grid td
{

border-left: none !important;
border-right: none !important;
border-top:1px solid #dddddd;
border-bottom:1px solid #dddddd;
}
</style>

 <table width="400">
 <tr>
<td>
    <table width="100%" class="main">
    <tr>
        <td valign="top">column 1</td>
        <td valign="top">column 2</td>
        <td valign="top" style="width:25%;">column 3
            <table id="names" class="grid">
                <tr style="height:20;">
                    <td>line 1</td>
                </tr>
                <tr  style="height:20;">
                    <td>line 2</td>
                </tr>
                <tr  style="height:20;">
                    <td>line 3</td>
                </tr>
            </table>
        </td>
        <td valign="top" style="width:25%;">column 4
            <table id="desc" class="grid">
                <tr>
                    <td  ><div style="overflow-y:auto; height:20px;">line   1                 description is a little too long so it wraps line 1 description is a little too long so it wraps</div></td>
                </tr>
                <tr>
                    <td><div style="overflow-y:auto; height:20px;">line 2 description</div></td>
                </tr>
                <tr>
                    <td><div style="overflow-y:auto; height:20px;">line 3 description</div></td>
                </tr>
            </table>
        </td>
        </tr>
    </table>
   </td>
 </tr>
  </table> 
```

对不起，它不是很优雅，但我希望它是你的原因......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T17:31:19.163

如果您坚持使用表格（仅适用于表格数据），我强烈建议您不要嵌套它们。通过使用 rowspan 属性，您可以在没有它们的情况下完美地实现您想要的结果。您的代码将如下所示：

```
<table width="400" class="main">
    <tr>
        <td rowspan="4" valign=top>column 1</td>
        <td rowspan="4"valign=top>column 2</td>
        <td  valign=top>column 3</td>
        <td valign=top>column 4</td>
    </tr>
    <tr class="grid">
        <td>line 1</td>
        <td>line 1 description is a little too long so it wraps line 1 description is a little too long so it wraps</td>
    </tr>
    <tr  class="grid">
        <td>line 2</td>
        <td>line 2 description</td>
    </tr>
    <tr  class="grid">
        <td>line 3</td>
        <td>line 3 description</td>
    </tr>
</table>​ 
```

随着内容的增长，您将不得不更新 rowspan 值，但是使用一些服务器端脚本应该相当容易。

对于一个工作示例，请看这里：http: [//jsfiddle.net/HPkvV/8/](http://jsfiddle.net/HPkvV/8/)

（请注意，我还`!important`从您的 css 中删除了可怕的东西，这里不需要，应该小心使用！）

# jquery - jquery ajaxstart ajaxstop 显示隐藏

> ID：12162430
> 
> 赞同：2
> 
> 时间：2012-08-28T15:17:17.010
> 
> 标签：jquery, spinner, show-hide

由于通常看似简单的事情需要几天才能解决，也许有人可以为我指出一个解决方案，但两天后我放弃了以下问题；

在 html 中，在一个表单中，我有一个按钮，应该通过 ajax 调用触发数据加载：

```
<button type="" class="btn" onclick="getData(); return false;">Show Data</button> 
```

在 JavaScript 中：

```
$(document).ajaxStart(function() {
    $("#qloader").show();
}).ajaxStop(function() {
    $("#qloader").hide('slow');
});​ 
```

并且在 id 为 qloader 的 html div 中定义为 100% 的宽度和高度，微调器居中作为背景，z-index 高于其他：

```
<div id="qloader" class="myLoader" >&nbsp;</div> 
```

现在，当页面加载时，执行 ajax 调用以获取初始数据，qloader div 被调出并显示微调器 - 动画，在 ajax 调用完成后，qloader 被 ajaxStop 隐藏。

接下来，当我单击一个按钮（显示数据）以启动另一个 ajax 调用时，触发了 ajaxStart，但它不显示 qloader，它等到 ajaxStop 被触发，然后眨眼间它显示 qloader 并隐藏它。

我怀疑 ajaxStart 没有执行，所以我在 $("#qloader").show() 之前放了警报，然后会显示警报，之后会显示 qloader 但微调器动画会暂停 - 没有旋转，在 ajaxStop 之后它会被隐藏起来。

在 ajaxStart 触发器中没有警报，在随后的 ajax 调用中，直到触发 ajaxStop 之前才会显示 div。

它适用于第一个 ajax 调用，但对于通过单击表单按钮触发的后续 ajax 调用它不起作用。

知道这个设置有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-06-29T20:34:23.827

正常睡眠是不行的。请在下面尝试，它已经过测试并且可以 100% 工作。

```
$("#showData").click(function(event){
    $("#qloader").show();
    setTimeout(function(){
        //Do what the button normally does
        $("#qloader").hide('slow');
    }, 10000);          
}); 
```

干杯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-16T12:12:07.563

在下面的链接中有一个示例获取加载数据并单击按钮获取数据。这工作正常。

在您的代码中，如果按钮未键入提交，则单击按钮不需要“返回 false”

```
$(document).ajaxStart(function() {
  $("#qloader").show();
}).ajaxStop(function() {
  $("#qloader").hide('slow');
});
$(document).ready(function() {
  getData();
})
```

```
.myLoader{
    width:100%;
    height:500px;
    background-color:blue;
    opacity:0.5
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<form>

  <button type="button" class="btn" onclick="getData(); return false;">Show Data</button>
</form>
<div id="qloader" class="myLoader" style="display:none">Loading...</div>
<script>
  function getData() {
    $.post("/echo/json", {
      "json": JSON.stringify({
        "test": "test"
      })
    });
  }
</script>
```

.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-28T15:36:45.790

您的按钮单击事件处理程序不正确。`return false`不会阻止默认行为，这只是 jQuery 的事情。所以我会这样做。

```
$('.btn').on( "click" , function( event ){
   getData();
   return false;
}); 
```

这是一个工作示例。[http://jsfiddle.net/FuFHe/](http://jsfiddle.net/FuFHe/)

# java - 检查 item 是否是泛型类的实例

> ID：12162432
> 
> 赞同：9
> 
> 时间：2012-08-28T15:17:27.057
> 
> 标签：java, class, generics, instanceof

```
public class Test<T>{

    public boolean isMember(T item) {

        if(item instanceof Test)
        {
            return true;
        }
        return false;
    }
} 
```

这是检查项目是否是类的实例的正确方法吗？

我进行了一些搜索，似乎对于通用类，这不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T15:32:02.393

目前尚不清楚您要在这里测试什么，但这里有一些可能性：

1.  是`item`一个`T`？是的。否则，它可能无法传递到`isMember`方法中。编译器将不允许它。（请参阅下面评论中 Alex 的警告。）
2.  是`item`一个`Test`？您`isMember`编写的方法将对此进行测试，但我在这里感觉到代码异味。为什么你会期望 a`T`也是 a `Test`，但只是在某些时候？您可能需要重新考虑如何组织课程。此外，如果这确实是您想要的，那么您的方法可以写成：

    ```
    public boolean isMember(T item) {
        return (item instanceof Test);
    } 
    ```

    这就引出了一个问题：为什么首先要有这样的方法？哪个更容易写？

    ```
    if(obj instanceof Test) {...} 
    ```

    或者

    ```
    if(Test<Something>.isMember(obj)) {...} 
    ```

    我认为第一个更简单，大多数 Java 开发人员会比自定义方法更容易理解它的含义。

3.  是`item`一个`Test<T>`？在运行时无法知道这一点，因为 Java 使用擦除实现泛型。如果这是您想要的，您必须将方法签名修改为类似于 Mike Myers 的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:28:31.157

`T`不是变量，而是在运行时定义的类的占位符。泛型是一个编译时特性，因此它们在编译时添加检查，这在运行时可能没有任何意义。我们只能检查运行时引用的对象的类型，它可能是代码中的超类类型。如果我们想将类型`T`作为参数传递给方法，我们所要做的就是像下面这样显式地接近：

```
void genericMethod(Class<T> tClass) {
    if(String.class.isAssignableFrom(tClass)) 
```

或者

```
void genericMethod(Class<T> tClass, T tArg) { 
```

请注意，类型可能与此处的类型不同，我们可以看到如何操作：

```
genericMethod(Number.class, 1); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-29T15:33:33.487

```
public class LinkList<T>{

    public boolean isMemberOfClass(T item) {

        if(item instanceof LinkList)
        {
            return true;
        }
        return false;
    }
} 
```

对不起，我不支持发布问题作为答案。

LinkList 类是一个泛型类。功能是检查项目是否属于该类。检查是否有相同的T。

# android - Android AVD 模拟器从防火墙后面访问 Internet

> ID：12162437
> 
> 赞同：0
> 
> 时间：2012-08-28T15:17:32.747
> 
> 标签：android, android-emulator

是否可以从运行在防火墙后面的 PC 上的 Android 4.1 AVD 模拟器访问 Internet？

如果我点击浏览器图标，我会收到一条错误消息“*网页不可用。请确保您有数据连接。* ”
如果我点击地图图标，我会收到一条错误消息“*网络故障。此应用程序需要工作数据连接。* ”
如果我尝试添加电子邮件帐户，我会收到一条错误消息“*无法打开与服务器的连接。* ”

我已将**-dns-server 10.xxx.xx.31,10.xxx.xx.32 -http-proxy [http://10.xxx.xx.201:8080](http://10.xxx.xx.201:8080)** *（使用正确的 IP 地址！）*添加到 emulator.exe命令行，但这似乎没有任何区别？

我可以在屏幕顶部的三角形旁边看到“ **3G ”符号，我可以使用 [** **F8** ] 键切换它，但这似乎也没有任何区别。

谢谢你的帮助，
最好的问候，
詹姆斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T10:03:51.660

我已经设法使用以下说明解决了这个问题**：** -

1.  在 ADK 模拟器中，转到设置图标 -> 无线和网络 -> 移动网络 -> 接入点名称
2.  按 [F2] 并选择“新建 APN”
3.  姓名 = 詹姆斯
4.  APN = www
5.  代理 = 10.xxx.xx.201
6.  端口 = 8080
7.  用户名 = xxxxxxxx
8.  密码 = xxxxxxx
9.  按 [F2] 并选择“保存”
10.  单击“James”设置为默认 APN

现在转到浏览器，您应该能够看到主页**:)**

# c# - 在 DoWork Ba ckgroundworker 方法结束时未处理 TargetInvocationException

> ID：12162438
> 
> 赞同：-2
> 
> 时间：2012-08-28T15:17:34.187
> 
> 标签：c#, backgroundworker, targetinvocationexception

这是 DoWork：

```
private void uploadWorker_DoWork(object sender, DoWorkEventArgs e)
        {
            uploadWorker.ReportProgress(20);

            int tiffError = 0;

            finalFiles = Directory.GetFiles(AppVars.FinalPolicyImagesFolder);

            foreach (string file in finalFiles)
            {
                if (!file.EndsWith(".tiff"))
                {
                    tiffError = 1;
                    break;
                }
            }

            uploadWorker.ReportProgress(50);

            if (tiffError == 1)
            {
                MessageBox.Show("There are files in this folder that are not .tiff. Please ensure only .tiff files are in this folder.", "Error!", MessageBoxButtons.OK, MessageBoxIcon.Error);
            }
            else
            {
                if (finalFiles.Length == 0)
                {
                    MessageBox.Show("There are no TIFF files to be uploaded. Please generate files first.", "Error!", MessageBoxButtons.OK, MessageBoxIcon.Error);
                    pbUpload.Value = 0;
                    EnableAllButtons();
                }
                else
                {
                    double count = finalFiles.Length;
                    int current = 0;
                    int pbValue = 0;

                    uploadWorker.ReportProgress(70);

                    foreach (string file in finalFiles)
                    {
                        current = current + 2;

                        if (file.Contains(".tiff") == true)
                        {
                            PolicyNumber = Path.GetFileName(file).Split('_')[0];
                            basePolicyNumber = PolicyNumber.Remove(PolicyNumber.Length - 2);
                            basePolicyNumber = basePolicyNumber + "00";

                            finalPolicyName = Path.GetFileName(file);

                            PolicyUUID = Transporter.GetPolicyUUID(AppVars.pxCentralRootURL, basePolicyNumber);

                            if (PolicyUUID == "")
                            {
                                MessageBox.Show("The InsightPolicyID for the policy you are trying to upload does not exist in ixLibrary. Please ensure the policy number is correct. If you are sure it should be in ixLibray, please contact IT.", "Error!", MessageBoxButtons.OK, MessageBoxIcon.Error);
                            }
                            else
                            {
                                ixLibrarySourceFileURL = AppVars.ixLibraryPolicyAttachmentsURL + finalPolicyName;

                                UploadToixLibraryErrorCode = Transporter.UploadFileToixLibrary(AppVars.ixLibraryPolicyAttachmentsURL, file);

                                if (UploadToixLibraryErrorCode != 0)
                                {
                                    MessageBox.Show("There was an error uploading the file to ixLibrary. Please contact IT about this problem.", "Error!", MessageBoxButtons.OK, MessageBoxIcon.Error);
                                }
                                else
                                {
                                    GeneratePayLoadErrorCode = Transformer.GeneratePayLoad(ixLibrarySourceFileURL, finalPolicyName);

                                    if (GeneratePayLoadErrorCode != 0)
                                    {
                                        MessageBox.Show("There was an error generating the XML for pxCentral. Please contact IT about this problem.", "Error!", MessageBoxButtons.OK, MessageBoxIcon.Error);
                                    }
                                    else
                                    {
                                        pxCentralPOSTErrorCode = Transporter.pxCentralPOST(AppVars.pxCentralRootURL + PolicyUUID, AppVars.pxCentralXMLPayloadFilePath);

                                        pbValue = Convert.ToInt32(((current / count) * 30) + 70);

                                        uploadWorker.ReportProgress(pbValue);
                                    }
                                }
                            }
                        } 
                    }
                }
            }
        } 
```

一旦它到达最后一个}，我就会在此处收到 TargetInvocationException 未处理错误（请参阅代码中的注释）：

```
static class Program
    {
        [STAThread]
        static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);

            bool createdNew = false;

            Mutex mutex = new Mutex(true, "MyApplicationMutex", out createdNew);

            if (createdNew == true)
            {
                //error happens here
                Application.Run(new frmMain());
            }
            else
            {
                MessageBox.Show("The application is already running.", Application.ProductName, MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
            }
        }
    } 
```

我不确定为什么会突然发生这种情况。有谁知道为什么？

最后，这是 RunWorkerCompleted：

```
private void uploadWorker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {
            if (e.Error == null)
            {
                DeleteFinalFiles(finalFiles);
                MessageBox.Show("Upload process complete.", "Complete!", MessageBoxButtons.OK, MessageBoxIcon.Information);
            }
            EnableAllButtons();
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T15:39:24.177

您正在调用`EnableAllButtons`您的`DoWork`处理程序。这大概会改变`Enabled`表单上按钮的状态。这对于 UI 线程以外的任何其他线程都是不合法的。您应该`EnableAllButtons`在`ProgressChanged`事件处理程序或`RunWorkerCompleted`事件处理程序中进行调用。您还使用代码调用`ProgressBar.Value`。`DoWork``pbUpload.Value = 0`

此外，您应该`MessageBox.Show`从您的 UI 线程（即 in`ProgressChanged`或`RunworkerCompleted`处理程序）调用，以便`MessageBox`可以与您的表单消息泵正确关联。您应该传递一个表单对象以`MessageBox.Show`将消息框与表单相关联，这样您就不能在显示消息框时将表单带到前台。例如：

```
MessageBox.Show(this, 
    "There are files in this folder that are not .tiff. Please ensure only .tiff files are in this folder.", 
    "Error!", MessageBoxButtons.OK, MessageBoxIcon.Error); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-21T03:44:16.737

我在后台进程完成后引发的 TargetInvocation Exception 遇到了完全相同的问题。在 backgroundWorker ProgressChanges 事件中，我引用了如下所示的控件`private void m_oWorker_ProgressChanged(object sender, ProgressChangedEventArgs e) {

```
 // This function fires on the UI thread so it's safe to edit
       // the UI control directly, no funny business with Control.Invoke :)
       CurrentState state =
               (CurrentState)e.UserState;
       txtProgress.Text = state.CrawlStatus;
       lblStatus2.Text = state.sStatus;
       txtItemsStored.Text = state.TotItems.ToString() + " items";
       txtLastRunTime.Text = state.MostRecentGatherDate.ToString();
       AppNameKey.SetValue("LastCrawlTime", txtLastRunTime.Text);
   }` 
```

DoWork 事件从控件中读取

```
private  void m_oWorker_DoWork(object sender, DoWorkEventArgs e)
   {

       DateTime LastCrawlTime;
       try
       {
         LastCrawlTime = Convert.ToDateTime(txtLastRunTime.Text);
        if (lblStatus2.Text != "Status: Running" || (!cmdRunNow.Enabled && cmdStopRun.Enabled)) // run is not currently running or cmdRunNow clicked
        {
            //lblStatus2.Text = "Status: Running";
            GetUpdated(LastCrawlTime,e);
        }
       }
       catch (Exception Ex)
       {
           MessageBox.Show(Ex.Message);
       }

   } 
```

RunWorkedrCompleted 事件写入控件：

```
void m_oWorker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
   {
        if (e.Cancelled)
       {
           lblStatus2.Text = "Status: Stopped";
           cmdStopRun.Enabled = false;
       }
       // Check to see if an error occurred in the background process.
       else if (e.Error != null)
       {
           lblStatus2.Text = "Fatal Error while processing.";
       }
       else
       {
           // Everything completed normally.
           //CurrentState state = (CurrentState)e.UserState;
           lblStatus2.Text = "Status: Finished";            
       }

   } 
```

这些都没有引起问题。导致问题的原因是尝试在 RunWorker_Completed 事件中引用 e.UserState（上面已注释掉）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T15:28:55.810

在 WinForms 中，您只能访问创建控件的线程上的控件。您的 DoWork 事件处理程序未在创建表单的线程上运行（这当然是重点）。因此，您不得在 DoWork 处理程序中访问表单上的任何控件。这样做会产生不可预知的结果。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-28T15:35:14.920

我弄清楚了这个问题。

进度条超出了允许的最大值（100）。

问题是在代码中，我是这样递增进度条的：

```
current = current + 2; 
```

我将其替换为：

```
current++; 
```

我增加 2 的原因仅仅是为了测试目的。

# linux - 寄存器值调试

> ID：12162442
> 
> 赞同：0
> 
> 时间：2012-08-28T15:17:46.777
> 
> 标签：linux, kernel, paging, mips, objdump

我有一个崩溃方法的 objdump。我发现崩溃是由于内存访问错误造成的。内存地址存在于 MIPS 寄存器 a0 中。除了逐步回溯（演练）objdump（a0 从 s3 获得它等等）之外，有没有办法跟踪寄存器是如何获得这个地址的。

我还有一个问题。

如何在内核中完成分页。内核中必须没有虚拟地址的概念，因为它们都已经在内存中。这个问题是因为在我的崩溃中有一个叫做 BADVA（它是 BAD 虚拟地址）的东西持有一个错误的地址。

这是崩溃报告

```
Cpu 0
Registries dump
Status: 10000302    KERNEL EXL 
**Cause : 00803c08    TLBL**
**BadVA : fdca9b68**
PrId  : 01019378 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T22:39:46.697

崩溃的直接原因是没有 TLB 条目与 BadVA 中的虚拟地址匹配，并且这发生在 CPU 处于异常模式时。

BadVA 地址 (fdca9b68) 位于虚拟地址空间的 KSEG2 区域中。该区域用于 MIPS Linux 内核中的映射地址（通常用于内核模块）。我会怀疑内核模块中的错误。

如果您想了解 MIPS CPU 中发生的事情，您应该购买并学习[请参阅 MIPS Run](https://rads.stackoverflow.com/amzn/click/com/0120884216)。

# oracle - 有没有办法在包范围内为另一个包中的常量创建本地化同义词？

> ID：12162447
> 
> 赞同：2
> 
> 时间：2012-08-28T15:18:03.950
> 
> 标签：oracle, oracle11g

场景：`package_a`引用一个公共常量`package_b`

现有代码如下所示：

```
PACKAGE package_a
IS
   PROCEDURE do_something
   IS
   BEGIN
      ...
      do_something_else(package_b.global_constant);
      ...
   END;
END package_a; 
```

我想做这样的事情：

```
PACKAGE package_a
IS
   SYNONYM global_constant FOR package_b.global_constant;

   PROCEDURE do_something
   IS
   BEGIN
      ...
      do_something_else(global_constant);
      ...
   END;
END package_a; 
```

我不想创建一个局部变量或常量，它是用另一个常量的值设置的。我不想创建公共同义词。

我希望它在包私有范围内。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T15:48:36.253

如果您真的想要它 - 除了可能更短的名称之外，我看不出它有什么优势 - 您可以使用私有函数来获得类似的效果：

```
create package package_b is
    global_constant number := 42;
end package_b;
/

create package body package_b is
end package_b;
/

create package package_a is
    procedure do_something;
end package_a;
/

create package body package_a is
    /* private function */
    function global_constant return number is
    begin
        return package_b.global_constant;
    end global_constant;

    /* public procedure */
    procedure do_something is
    begin
        dbms_output.put_line('Constant is: ' || global_constant);
    end do_something;
end package_a;
/

set serveroutput on
exec package_a.do_something; 
```

哪个输出：

```
Constant is: 42 
```

因为该函数仅在包体中声明，所以它是包私有的，我认为这符合您的范围要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:24:48.013

A`SYNONYM`是一个 SQL 构造，因此，不，您不能`SYNONYM`在 PL/SQL 中声明 a 具有包范围。

与您拒绝的选项（例如 A 中的包变量引用 B 中的常量）相比，在包中声明同义词有什么好处？

# javascript - 如何为 HTML 页面上的所有内部链接自动添加页码？

> ID：12162448
> 
> 赞同：8
> 
> 时间：2012-08-28T15:18:04.867
> 
> 标签：javascript, html, css

在打印模式下，我想呈现这样的链接：

```
<a href="#targetPage">link</a> 
```

像这样：

```
<a href="#targetPage">link (page 11)</a> 
```

（假设目标页面在打印预览中的第 11 页）。

可以使用计数器将页码添加到带有纯 CSS 的页脚，但我可以以更多“我想要的方式”使用它吗？

该解决方案不需要跨浏览器（FF/Chrome 就足够了），允许使用任何 CSS/Javascript 技巧。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T15:36:51.393

正如我在我的博文“[打印网页](http://blog.pdark.de/2010/11/19/printing-web-pages/)”中所写，打印网页处于一种令人遗憾的状态。

除非您只打印（一列）没有图像和表格的文本，否则很难获得至少在某种程度上类似于屏幕内容的打印输出（是的，我在这里夸大了但不多）。

大约十年来，目前最好的打印浏览器仍然是 Opera。所有其他浏览器或多或少都很糟糕。

CSS 可以提供很大帮助，但没有浏览器实现必要的部分。请参阅[为分页媒体生成的内容模块中的目标计数器](http://www.w3.org/TR/css3-gcpm/#the-target-counter-and-target-counters-v)- 这正是您需要的。

好的，在消除咆哮之后，这里有一些你需要解决的障碍：

一旦您开始向现有链接添加测试，页码就会开始变化。所以如果你写“blabla（第12页）”，一旦你到达那里，它可能会出现在第13页。

为了能够知道哪个页面上的内容，您必须自己将网页拆分为多个页面。如果您主要有文本，这并不难：只需`div`每页创建一个，确保浏览器不会在分页符上打印它（祝你好运 :-( ）然后将 DOM 元素移动到`div`s 直到它们适合一页......如果你能找出页面大小是多少。

为避免移位问题，请在所有链接中添加“(page #0000)”以确保它们占据足够的空间。稍后，它们将被较短的文本替换，因此具有大量链接的页面底部可能会有一些空白区域，但这比替代方案要好。

您应该能够在短短六个月左右的时间内编写类似的东西（并对其进行调试）......

这就是为什么每个人都在服务器上使用可以生成 HTML 和 PDF 输出的渲染引擎的原因。PDF 允许您精确控制页面布局。你只需要找到一个支持文本引用的渲染引擎。我建议[LaTeX](http://www.latex-project.org/)；它有点笨拙，但可以完成工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T15:22:57.613

这能行吗？

```
@page {
  @bottom-right {
    content: counter(page) " of " counter(pages);
  }
} 
```

（来自[带有 CSS/HTML 的页码](https://stackoverflow.com/questions/6109893/page-numbers-with-css-html)）

# javascript - 使用 Raphael js 直接在谷歌地图上绘制

> ID：12162453
> 
> 赞同：3
> 
> 时间：2012-08-28T15:18:16.503
> 
> 标签：javascript, maps

我如何使用 raphael js 直接在谷歌地图上绘制？当我在地图上绘制一些东西时，它有背景，我不希望这样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:31:36.037

Havent 使用 Raphael js 进行了很多工作，但发现了这一点。

[将 Google 地图与 Raphael JS 混合使用（一）](http://scriptstress.blogspot.in/2010/03/mixing-google-maps-with-raphael-js-i.html)

[谷歌地图、Raphael JS 和浏览器](http://scriptstress.blogspot.in/2010/03/google-maps-raphael-js-and-browsers.html)

也尝试看看 [Cartographer](http://cartographer.visualmotive.com/)，它使用 Raphel JS

还有关于 Google 组 [Raphael Overlay的讨论](https://groups.google.com/forum/?fromgroups=#!msg/google-maps-js-api-v3/swOSMcDnaVY/BmNboCQzh0IJ)

# c# - MVC 3，用于用户注册过程的视图模型。密码验证无法正常工作

> ID：12162459
> 
> 赞同：4
> 
> 时间：2012-08-28T15:18:53.147
> 
> 标签：c#, asp.net-mvc-3, view, model, passwords

我正在尝试使用 MVC 3 创建一个用户注册页面，以便我可以更好地了解它的工作过程、幕后发生的事情等。我在尝试使用`[Compare]`来检查时遇到了一些问题用户两次输入相同的密码。

我首先尝试将该`ComparePassword`字段添加到我的用户模型中，但发现这不会按照我想要的方式工作，因为我在数据库中没有该字段，因此显而易见的答案是使用包含该`ComparePassword`字段的相同信息创建一个视图模型。

所以我现在创建了一个`User`模型和一个`RegistrationViewModel`，但是密码上的似乎`[Compare]`没有返回任何内容，例如，无论我在两个框中输入了什么，当我单击创建时它没有给出错误，这在我看来是意味着它已成功验证。

我不确定我在做什么或不做什么来使这项工作正常进行。我已尝试将其更新`jQuery.Validate`到最新版本，因为旧版本中报告了一些错误，这对我的努力没有帮助。

以下是我正在使用的所有代码。

```
 public class RegistrationViewModel
    {
        [Required]
        [StringLength(15, MinimumLength = 3)]
        [Display(Name = "User Name")]
        [RegularExpression(@"(\S)+", ErrorMessage = " White Space is not allowed in User Names")]
        [ScaffoldColumn(false)]
        public String Username { get; set; }

        [Required]
        [StringLength(15, MinimumLength = 3)]
        [Display(Name = "First Name")]
        public String firstName { get; set; }

        [Required]
        [StringLength(15, MinimumLength = 3)]
        [Display(Name = "Last Name")]
        public String lastName { get; set; }

        [Required]
        [Display(Name = "Email")]
        public String email { get; set; }

        [Required]
        [Display(Name = "Password")]
        [DataType(DataType.Password)]
        public String password { get; set; }

        [Required]
        [DataType(DataType.Password)]
        [Display(Name = "Re-enter Password")]
        [Compare("Password", ErrorMessage = "Passwords do not match.")]
        public String comparePassword { get; set; }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T15:36:53.227

CompareAttribute 是否区分大小写？我在属性中看到您引用“密码”，但您的属性被声明为“密码”。

# mod-rewrite - WordPress 文件扩展名

> ID：12162462
> 
> 赞同：0
> 
> 时间：2012-08-28T15:18:55.397
> 
> 标签：mod-rewrite, wordpress

我正在将网站的科学怪人怪物转换为 Wordpress。我面临的第一个挑战是保留 Google 的旧 URL。这个站点有几个 .PHP 页面和几个 HTML 页面。

我们的谷歌排名在几个关键搜索词中都很高。所以对我来说重要的是页面地址保持不变。到目前为止，我找不到可以让我的 Wordpress 网站同时拥有 .HTML 和 .PHP 永久链接的插件。

我熟悉 mod_rewrite() 并且以前使用过它，但是当我将重写规则插入现有的 Wordpress .htacces 文件时，它完全破坏了路由。

我将非常感谢您的 Wordpress 专家提供的任何意见:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:10:49.837

你需要这样做`301 redirect`，这里有一个例子`.htaccess`。

```
Redirect 301 /oldpage2.html http://www.yoursite.com/folder/ 
```

# javascript - 切换功能不起作用

> ID：12162465
> 
> 赞同：1
> 
> 时间：2012-08-28T15:19:12.417
> 
> 标签：javascript, toggle, jquery, slidetoggle

以下是我用于切换的代码。

```
function toggle_visibility(id) {
       var e = document.getElementById(id);
       if(e.style.display == 'block')
          e.style.display = 'none';
       else
          e.style.display = 'block';
    } 
```

它在我的电脑上运行良好。但是当我在调用 .asp 页面的服务器端使用它时，它就不起作用了。我知道我必须使用 .live() 处理程序。我用jquery slidetoggle试过了。但它不工作。以下是html代码

```
<div class="issue_button">
<a align="center" href="#" onclick="toggle_visibility('dropdown1');">Link</a></div>
<div id="dropdown1"> <p>Some text</p> </div> 
```

难道我做错了什么？坦率地说，我不知道如何使用实时处理程序编写代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T15:30:27.587

既然你说你可以使用 jQuery，我建议你这个替代代码

```
function toggle_visibility(id) {
    $('#' + id).toggle();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T15:31:00.753

这是用于切换的 jquery 解决方案。

```
 <div class="issue_button">
        <a align="center" href="#">Link</a>
    </div>
    <div id="dropdown1"> <p>Some text</p> </div>

$(function () {
    $(".issue_button a").click(function () {
        $("#dropdown1").slideToggle();
    });        
});​ 
```

​</p>

[http://jsfiddle.net/aJFSy/1/](http://jsfiddle.net/aJFSy/1/)

**更新**

我不会使用 Live，因为它自 1.7 以来已被弃用

代表 - [http://api.jquery.com/delegate/](http://api.jquery.com/delegate/) http://jsfiddle.net/aJFSy/2/

或者

在 [http://api.jquery.com/on/](http://api.jquery.com/on/)

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-08-28T15:24:40.617

尝试：

```
function toggle_visibility(id) { 
  var e = document.getElementById(id); 
  if(e.style.display == 'block'){
    e.style.display = 'none'; 
  }else{ 
    e.style.display = 'block';
  }
} 
```

# java - 如何通过 websphere ORB 调用获取数据库连接？

> ID：12162468
> 
> 赞同：1
> 
> 时间：2012-08-28T15:19:15.960
> 
> 标签：java, jakarta-ee, websphere, websphere-7, websphere-6.1

我有一个 websphere 6.1 集群环境，它由两个节点组成，每个节点有 2 个应用服务器。让我们打电话**`NodeA including Server1(2809) & Server2(2810)`**，**`NodeB including Server3(2811) & Server4(2812)`**。同时，我使用 JNDI 创建了一个集群范围的数据源**`local_db`**。

现在我想通过上述环境中的 WAS ORB 调用在 java 客户端中获取数据库连接。Java 代码的特定部分如下所示：

```
 Hashtable env = new Hashtable();
        env.put(Context.INITIAL_CONTEXT_FACTORY,"com.ibm.websphere.naming.WsnInitialContextFactory");
        env.put(Context.PROVIDER_URL,"iiop://localhost:2809");  

        javax.sql.DataSource ds = (DataSource)initialContext.lookup("local_db");

        Connection cn = ds.getConnection(); 
```

1.  如果上面的java客户端代码运行起来，数据库连接检索请求会在所有应用服务器的四个连接池中遵循负载均衡规则吗？

2.  再者，如果我的java客户端成功获得一个数据库连接，然后运行一个大的SQL查询，结果返回很大，至于内存空间占用，哪个WAS应用服务器会处理？由于上面使用的端口 2809 或返回数据库连接的目标服务器，只有**server1 ？**

3.  顺便说一句，如果我为此设置两个服务器成员`PROVIDER_URL`，例如**`iiop://localhost:2809, localhost:2810`**，这是否意味着负载平衡或故障转移？

    如果我理解错误，请帮助解释和纠正我！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T23:56:53.620

让我从简单的开始，然后继续其余的

1.  Having two provider URLs' implies failover. If you can't connect to the first naming server, it connects to the second naming server and continues till the end of that list. Notice the Fail over is for connection to the naming server (not to the resource itself)

The look up is done on the server that you connect to. THe local_db represents a datasource (and its connection pool) on that server. You will one work with the server1 (as you are connecting to that NS) and will get connection from the datasource hosted on that server.

You will never get any connection from the other servers. In others words there is no load balancing (one request uses connection from server1, another uses a connection from server 2 etc). I believe this is what you mean by load balancing in your question above.

HTH

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T11:41:54.500

A `DataSource` is neither remotable nor serializable. Therefore, if you look up `local_db` from the server, it will return a `javax.naming.Reference` that the client uses to create a **new** `DataSource` instance with the same configuration as the one on the server. That also means that once the lookup has been performed, no JDBC method will ever send requests to the WebSphere server.

# android - 日期存储为 long 并且时区更改时的 Android 不一致

> ID：12162473
> 
> 赞同：0
> 
> 时间：2012-08-28T15:19:27.047
> 
> 标签：android, datetime

我有一个仅供英国和爱尔兰人使用的 Android 应用程序，并且没有计划在海外使用此应用程序。

在应用程序中，我存储各种事物的日期，虽然我不需要包括一天中的时间在内的完整时间戳，但我只需要日期。

为了可以轻松地比较日期，我一直在创建日历对象并清除时间值，并使用其中的毫秒数存储在数据库中。

```
public Calendar clearCalTime(long l) {
    Calendar cal = Calendar.getInstance();
    cal.setFirstDayOfWeek(Calendar.MONDAY);
    cal.setTimeInMillis(l);
    cal.clear(Calendar.HOUR);
    cal.clear(Calendar.HOUR_OF_DAY);
    cal.clear(Calendar.MINUTE);
    cal.clear(Calendar.SECOND);
    cal.clear(Calendar.MILLISECOND);
    return cal;
} 
```

问题是如果用户更改时区，由于某种原因日期开始混乱，例如将内容保存到错误的日期。时区可以是任何东西，我无法控制用户设置的内容。

我尝试将时区设置为 UTC，但这也不起作用。有什么办法可以忽略时区？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:33:02.573

没有。您将不得不设置 TimeZone 进出存储。

你需要这样做：

```
Calendar c = new GregorianCalendar(TimeZone.getTimeZone("GMT")); 
```

在您的代码中使其保持一致。

请参阅此 SO：[Java.util.Calendar - 自 1970 年 1 月 1 日以来的毫秒数](https://stackoverflow.com/questions/263376/java-util-calendar-milliseconds-since-jan-1-1970)

或者在处理复杂的日期/时间数学时使用[Joda Time 。](http://joda-time.sourceforge.net/ "乔达时间")

# scala - 我可以对之前在 REPL 中键入的代码进行修改吗？

> ID：12162475
> 
> 赞同：4
> 
> 时间：2012-08-28T15:19:30.887
> 
> 标签：scala

也许我遗漏了一些东西，但我发现在 REPL 中试验代码对我的手指比对我的大脑更好。

假设您已经定义了一个简单的类（请原谅蹩脚的例子）：

```
scala> class Farmer(){var name = ""
     | def apply (name: String) = {this. name = name}
     | override def toString():String={name}
     | }
defined class Farmer

scala> 
```

有没有办法获得整个定义并对其进行更改，而无需逐行重新输入或“向上箭头”。例如，假设我只想添加一个函数定义：

```
scala> class Farmer(){var name = ""
     | def apply (name: String) = {this.name = name}
     | override def toString():String={name}
     | def +(surname: String) = {name = name + " " + surname}
     | }
defined class Farmer

scala> 
```

换句话说，有没有办法告诉 REPL 从前一个输入重播完整的多行条目（直到某一行），而不是一次只重播一行（就像按下向上箭头时发生的那样）？

在 'Happy land' 中，做一些类似的事情会很好，按下`ALT`然后输入`toString`然后点击`return`，然后 REPL 将重新输入：

```
scala> class Farmer(){var name = ""
     | def apply (name: String) = {this.name = name}
     | override def toString 
```

所以基本上 REPL 会为你重新输入你的代码，直到你指定的点。

如果有人对如何使使用 REPL 比我正在做的事情更有效率有任何想法，我很乐意听取他们的意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:04:23.050

复制粘贴怎么样？Scala 将检测到您正在从 repl 会话中粘贴，并采取相应的措施（即忽略“scala>”和“|”）。尽管如果您使用 :paste 模式来做事，它的可读性会更高。

否则，您可能会对另一个 repl 更满意。我发现[ScalaConsole](https://bitbucket.org/centaur/scalaconsole/wiki/Home)非常适合这种东西。

# vba - 将多个 CSV 导入单个工作簿中的多个工作表

> ID：12162477
> 
> 赞同：17
> 
> 时间：2012-08-28T15:19:36.507
> 
> 标签：vba, excel, csv

我该怎么做呢？基本上我希望我的多个 CSV 文件被导入到多个工作表中，但只在一个工作簿中。这是我要循环的 VBA 代码。我需要循环来查询所有 CSV`C:\test\`

```
Sub Macro()
With ActiveSheet.QueryTables.Add(Connection:= _
    "TEXT;C:\test\test1.csv", Destination:=Range("$A$1"))
    .Name = "test1"
    .FieldNames = True
    .RowNumbers = False
    .FillAdjacentFormulas = False
    .PreserveFormatting = True
    .RefreshOnFileOpen = False
    .RefreshStyle = xlInsertDeleteCells
    .SavePassword = False
    .SaveData = True
    .AdjustColumnWidth = True
    .RefreshPeriod = 0
    .TextFilePromptOnRefresh = False
    .TextFilePlatform = 437
    .TextFileStartRow = 1
    .TextFileParseType = xlDelimited
    .TextFileTextQualifier = xlTextQualifierDoubleQuote
    .TextFileConsecutiveDelimiter = False
    .TextFileTabDelimiter = False
    .TextFileSemicolonDelimiter = False
    .TextFileCommaDelimiter = True
    .TextFileSpaceDelimiter = False
    .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1)
    .TextFileTrailingMinusNumbers = True
    .Refresh BackgroundQuery:=False
End With
Sheets.Add After:=Sheets(Sheets.Count)
End Sub 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2015-11-03T11:57:36.827

[这家伙](https://sites.google.com/a/madrocketscientist.com/jerrybeaucaires-excelassistant/merge-functions/csvs-to-sheets)绝对算了。非常简洁的代码，在 2010 年非常适合我。所有功劳都归功于他（Jerry Beaucaire）。我从[这里](http://www.excelforum.com/excel-general/742348-merge-multiple-csv-files-to-one-xls-with-multiple-tabs.html#post2367007)的一个论坛找到它。

```
Option Explicit
Sub ImportCSVs()
'Author:    Jerry Beaucaire
'Date:      8/16/2010
'Summary:   Import all CSV files from a folder into separate sheets
'           named for the CSV filenames

'Update:    2/8/2013   Macro replaces existing sheets if they already exist in master workbook

Dim fPath   As String
Dim fCSV    As String
Dim wbCSV   As Workbook
Dim wbMST   As Workbook

Set wbMST = ThisWorkbook
fPath = "C:\test\"                  'path to CSV files, include the final \
Application.ScreenUpdating = False  'speed up macro
Application.DisplayAlerts = False   'no error messages, take default answers
fCSV = Dir(fPath & "*.csv")         'start the CSV file listing

    On Error Resume Next
    Do While Len(fCSV) > 0
        Set wbCSV = Workbooks.Open(fPath & fCSV)                    'open a CSV file
        wbMST.Sheets(ActiveSheet.Name).Delete                       'delete sheet if it exists
        ActiveSheet.Move After:=wbMST.Sheets(wbMST.Sheets.Count)    'move new sheet into Mstr
        Columns.Autofit             'clean up display 
        fCSV = Dir                  'ready next CSV
    Loop

Application.ScreenUpdating = True
Set wbCSV = Nothing
End Sub 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-28T15:45:41.480

请注意，这不会处理错误，例如如果您导入`csv`.

这使用早期绑定，因此您需要`Microsoft.Scripting.Runtime`在*Tools..References*下的Reference`VBE`

```
Dim fs  As New FileSystemObject
Dim fo As Folder
Dim fi As File
Dim wb As Workbook
Dim ws As Worksheet
Dim sname As String

Sub loadall()
    Set wb = ThisWorkbook

    Set fo = fs.GetFolder("C:\TEMP\")

    For Each fi In fo.Files
        If UCase(Right(fi.name, 4)) = ".CSV" Then
            sname = Replace(Replace(fi.name, ":", "_"), "\", "-")

            Set ws = wb.Sheets.Add
            ws.name = sname
            Call yourRecordedLoaderModified(fi.Path, ws)
        End If
    Next
End Sub

Sub yourRecordedLoaderModified(what As String, where As Worksheet)
With ws.QueryTables.Add(Connection:= _
    "TEXT;" & what, Destination:=Range("$A$1"))
    .name = "test1"
    .FieldNames = True
    .RowNumbers = False
    .FillAdjacentFormulas = False
    .PreserveFormatting = True
    .RefreshOnFileOpen = False
    .RefreshStyle = xlInsertDeleteCells
    .SavePassword = False
    .SaveData = True
    .AdjustColumnWidth = True
    .RefreshPeriod = 0
    .TextFilePromptOnRefresh = False
    .TextFilePlatform = 437
    .TextFileStartRow = 1
    .TextFileParseType = xlDelimited
    .TextFileTextQualifier = xlTextQualifierDoubleQuote
    .TextFileConsecutiveDelimiter = False
    .TextFileTabDelimiter = False
    .TextFileSemicolonDelimiter = False
    .TextFileCommaDelimiter = True
    .TextFileSpaceDelimiter = False
    .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1)
    .TextFileTrailingMinusNumbers = True
    .Refresh BackgroundQuery:=False
End With
Sheets.Add After:=Sheets(Sheets.Count)
End Sub 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-28T23:04:44.490

您可以使用`Dir`过滤掉并仅使用`csv`文件运行

```
Sub MacroLoop()
Dim strFile As String
Dim ws As Worksheet
strFile = Dir("c:\test\*.csv")
Do While strFile <> vbNullString
Set ws = Sheets.Add
With ws.QueryTables.Add(Connection:= _
    "TEXT;" & "C:\test\" & strFile, Destination:=Range("$A$1"))
    .Name = strFile
    .FieldNames = True
    .RowNumbers = False
    .FillAdjacentFormulas = False
    .PreserveFormatting = True
    .RefreshOnFileOpen = False
    .RefreshStyle = xlInsertDeleteCells
    .SavePassword = False
    .SaveData = True
    .AdjustColumnWidth = True
    .RefreshPeriod = 0
    .TextFilePromptOnRefresh = False
    .TextFilePlatform = 437
    .TextFileStartRow = 1
    .TextFileParseType = xlDelimited
    .TextFileTextQualifier = xlTextQualifierDoubleQuote
    .TextFileConsecutiveDelimiter = False
    .TextFileTabDelimiter = False
    .TextFileSemicolonDelimiter = False
    .TextFileCommaDelimiter = True
    .TextFileSpaceDelimiter = False
    .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1)
    .TextFileTrailingMinusNumbers = True
    .Refresh BackgroundQuery:=False
End With
strFile = Dir
Loop
End Sub 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-05-08T20:56:12.030

我有 183 个 csv 文件要压缩成一个工作簿，每个 csv 文件一个工作表以方便分析数据，并且不想一次手动执行此操作。我在这个问题上尝试了最高评价的解决方案，但与另一个用户有同样的问题；csv 文件将打开，但不会将任何内容插入到目标工作簿中。我花了一些时间调整了代码，使其在 Excel 2016 中运行。我没有在旧版本上进行测试。我已经很久没有用 Visual Basic 编码了，所以我的代码可能还有很大的改进空间，但它在紧要关头对我有用。万一有人碰巧像我一样偶然发现了这个问题，我将粘贴我在下面使用的代码。

```
Option Explicit
Sub ImportCSVs()
'Author:    Jerry Beaucaire
'Date:      8/16/2010
'Summary:   Import all CSV files from a folder into separate sheets
'           named for the CSV filenames

'Update:    2/8/2013   Macro replaces existing sheets if they already exist in master workbook
'Update: base script as seen in: https://sites.google.com/a/madrocketscientist.com/jerrybeaucaires-excelassistant/merge-functions/csvs-to-sheets
'Update: adjusted code to work in Excel 2016

Dim fPath   As String
Dim fCSV    As String
Dim wbName  As String
Dim wbCSV   As Workbook
Dim wbMST   As Workbook

wbName = "this is a string"
Set wbMST = ThisWorkbook

fPath = "C:\pathOfCSVFiles\"                  'path to CSV files, include the final \
Application.ScreenUpdating = False  'speed up macro
Application.DisplayAlerts = False   'no error messages, take default answers
fCSV = Dir(fPath & "*.csv")         'start the CSV file listing

    On Error Resume Next
    Do While Len(fCSV) > 0
        Set wbCSV = Workbooks.Open(fPath & fCSV)                    'open a CSV file
        If wbName = "this is a string" Then 'this is to check if we are just starting out and target workbook only has default Sheet 1
            wbCSV.Sheets.Copy After:=wbMST.Sheets(1) 'for first pass, can leave as is. if loading a large number of csv files and excel crashes midway, update this to the last csv that was loaded to the target workbook
        Else
            wbCSV.Sheets.Copy After:=wbMST.Sheets(wbName) 'if not first pass, then insert csv after last one
        End If

        fCSV = Dir                  'ready next CSV
        wbName = ActiveSheet.Name 'save name of csv loaded in this pass, to be used in the next pass
    Loop

Application.ScreenUpdating = True
Set wbCSV = Nothing
End Sub 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-28T15:43:33.837

我没有尝试过，但我[会这样做](http://www.forumtopics.com/busobj/viewtopic.php?p=150279)：

```
Dim NumFound As Long 
With Application.FileSearch 
    .NewSearch
    .LookIn = "C:\test\"
    .FileName = "*.csv"
    If .Execute() > 0 Then 
        For i = 1 To .FoundFiles.Count
            With ActiveSheet.QueryTables.Add(Connection:= _
                "TEXT;" & "C:\test\" & (Application.FileSearch.FoundFiles(i)), Destination:=Range("$A$1"))
                ...
            End With
            Sheets.Add After:=Sheets(Sheets.Count)
        Next i
    End If
End With 
```

# zend-framework - 如何在视图中打印数组元素

> ID：12162479
> 
> 赞同：0
> 
> 时间：2012-08-28T15:19:43.373
> 
> 标签：zend-framework

我的控制器中有一个数组：

```
$data = array(
          'a' => "Hay",
          'b' => "Bee",
          'c' => "Sea",
);
$this->view->assign($data); 
```

在视图中没有返回任何内容：

```
<?php echo $this->data['a']; ?>
<?php var_dump($this->data); ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:23:10.760

在控制器中试试这个

```
$this->view->data = $data; 
```

更好的解释转到[Zend 手册](http://framework.zend.com/manual/en/zend.view.controllers.html)

# jsf - 从 Servlet 的 doPost 方法重定向到 PhaseListener

> ID：12162486
> 
> 赞同：0
> 
> 时间：2012-08-28T15:20:20.473
> 
> 标签：jsf, servlets, httpresponse

我想`PhaseListener`从 a 的 doPost 方法调用`Servlet`。我怎样才能做到这一点？

我不想这样做

`RequestDispatcher dispatcher = request.getRequestDispatcher("/jsp/html/index.jsf");` `dispatcher.forward(request, response);`

因为在我`PhaseListener`正在检查`viewId`. 通过上述方法，视图 id 始终保持为`index.xtml`. 所以，我无法检查我的条件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T08:37:42.510

您正在使用不会启动新请求的转发，因此您将保留原始请求 URI。您需要执行一个重定向，它会启动一个新请求并为您提供新的请求 URI。所以需要使用：

```
response.sendRedirect("/jsp/html/index.jsf"); 
```

请注意，`response.sendRedirect()`将[状态](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes)设置为 302。如果您需要 301 状态，则需要使用：

```
response.setStatus(301);
response.setHeader("Location", "/jsp/html/index.jsf"); 
```

# c# - 使用 jquery 从表单更新数据

> ID：12162490
> 
> 赞同：0
> 
> 时间：2012-08-28T15:20:25.637
> 
> 标签：c#, asp.net-mvc-3, razor

这个标题有很多主题，但没有一个能帮助我解决我的问题。我是 MVC 和 jQuery 的新手，所以我的猜测是我的方法在语法上有些问题。任何帮助是极大的赞赏。

我有一个 Web 应用程序，我的页面上有一个上部和一个下部（两个 div）。我的目标是在顶部 div（用户列表）中选择一条记录，并让底部显示用户可以填写答案的挑战问题列表。下面的列表是根据顶部网格中选择的记录使用 jquery 注入的。这是我用来执行此操作的代码。

查看 - javascript：

```
function editModeratorSecurity(aPersonId) {
    $.ajax({
        url: '/Admin/GetAdvSecurity/' + aPersonId,
        type: 'POST',
        progress: showModSearchProgress(),
        success: function (result) {
            AdvancedSuccess(result);
        },
        error: function (result) {
            AdvancedFailure(result);
        }
    });
}

function showModSearchProgress() {
    $("#ModeratorDetail").hide();
    $("#progressMod").show();
}

function endModProgress() {
    $("#progressMod").hide();
    $("#ModeratorDetail").show();
}

function AdvancedSuccess(result) {
    $('#ModeratorDetail').html(result);
endModProgress();
}

function AdvancedFailure(result) {
    endModProgress();
} 
```

控制器：

```
 public PartialViewResult GetAdvSecurity(string id)
    {
        //ID is the iD from the person table
        PersonModelBuilder pmb = new PersonModelBuilder(CurrentSession.AccountId);
        PersonEditModel pers = pmb.GetPersonToEdit(new Guid(id));

        if (pers != null)
        {
            AdvancedSecurityModel sec = new AdvancedSecurityModel();
            UserModelBuilder umb = new UserModelBuilder();

            //Need to get the ID from the login table - using the email address
            UserModel selUser = umb.CurrentUser(pers.EmailAddress);
            //Need to get the challenge questions/answers for the selected users
            List<UserQuestionModel> theQ = umb.GetUserChallengeQuestions(selUser.LoginId);

            sec.theUser = selUser;
            sec.theQuestions = theQ;

            return PartialView("_UserChallengeQuestions",sec);
        }
        else
        {
            return PartialView("_UserChallengeQuestions", new AdvancedSecurityModel());
        }

    } 
```

所以 - 这个对控制器的调用返回部分视图，我在部分视图中使用以下代码填充问题列表：

```
 @model AdvancedSecurityModel

    <form id="frmChallengeQuestions" class="inlineForm">
    <div style="min-height: 100px; max-height: 400px;overflow: hidden" >
        <table width="100%">
            <tr>
                <td align="right"><input type="button" value="Save Changes" onclick="ValidateAndSave()"/>&nbsp;</td>
            </tr>
            <tr>
                <td>
                    @{
                        string sInstruction = "";
                        string isChecked="";
                        string isDisplay = "none";
                        if (Model.theUser.SecondLevelAuthReqd)
                        {
                            isChecked = "checked='true'";
                            isDisplay = "";
                            sInstruction = "<br>&nbsp;Please answer <strong>at least 5</strong> of the questions below to set up this feature...";
                        }
                    }
                    &nbsp; 2nd Authentication&nbsp;&nbsp;<input type="checkbox" id="2ndAuth" onclick="javascript:ToggleQuestions()" @isChecked/>
                    <br />&nbsp;Checking this means that you will be required to answer a random challenge question from the questions you answer in the<br/>&nbsp;list below each time you log in.
                    <span id="spnExplanation"></span>
                    <p>&nbsp;</p>
                    <div id="theQuestionsandAnswers" style="display: @isDisplay; max-height: 175px;overflow-y: scroll" >

                        <table width="100%">
                            @{
                                if (Model.theQuestions != null)
                                {
                                    int iCount = 0;
                                    foreach (UserQuestionModel ques in Model.theQuestions)
                                    {
                                        string theAnswer = "";
                                        iCount += 1;
                                        if (ques.UserAnswer != null)
                                        {
                                            NLxCommon.Encryption enc = new NLxCommon.Encryption();
                                            theAnswer = enc.Decrypt256(ques.UserAnswer);
                                            enc.Dispose();
                                            enc = null;                                        
                                        }
                                        <tr>
                                            <td width="5%">&nbsp;</td>
                                            <td>@ques.QuestionText</td>
                                            <td><input id="Answer_@iCount" type="text" value="@theAnswer" /></td>
                                            <td>
                                                <input id="UserQuestionId_@iCount" type="hidden" value="@ques.UserQuestionId">
                                                <input id="QuestionId_@iCount" type="hidden" value="@ques.QuestionId">
                                                <input id="UserId_@iCount" type="hidden" value="@Model.theUser.LoginId">
                                            </td>
                                            <td width="5%">&nbsp;</td>
                                        </tr>

                                    }

                                }
                            }
                        </table>                
                    </div>
                </td>
            </tr>
        </table>
    </div>
    </form> 
```

在循环中，我命名我的控件 - 输入 id="Answer_@iCount" - 其中 iCount 是问题的编号 - 从 1 到 x。

输入按钮是为了保存我对所列问题的答案所做的更改。下面列出了 javascript 函数。

```
 var numQ = @Model.theQuestions.Count;
    function ValidateAndSave() {
        var NumAnswers = 0;

        for (i=1;i<=numQ;i++) {
            var answer = "#Answer_" + i.toString();

            var theAnswer = $(answer).val();
            if (theAnswer != "") {
                NumAnswers += 1;
            }
        }

        if (NumAnswers < 5) {
            alert('You must answer at least 5 questions to enable this feature');
            return false;
        }

        //Answered the right number of questions so SAVE
        for (j=1;j<=numQ;j++) {
            var uAnswer = "#Answer_" + j.toString();
            var uUserQid= "#UserQuestionId_" + j.toString();
            var uQuestionId= "#QuestionId_" + j.toString();
            var uUserId = "#UserId_" + j.toString();

            var theUAnswer = $(uAnswer).val();
            alert(theUAnswer );

            var theuUserQuestionId = $(uUserQid).val();
            alert(theuUserQuestionId );

            var theuQuestionid = $(uQuestionId).val();
            alert(theuQuestionid);

            var theuUserId = $(uUserId).val();
            alert(theuUserId );

            $.ajax({
                url: '/admin/savechallengequestion',
                type: 'POST',
                data: {
                    UserQuestionId:  theuUserQuestionId.toString(),
                    LoginId: theuUserId.toString(),
                    QuestionId: theuQuestionid.toString(),
                    UserAnswer: theUAnswer.toString()
                },
                contentType: 'application/json; charset=utf-8',
                //progress: showModSearchProgress(),
                success: insSuccess(data),
                error: function () {
                    alert("error");
                }
            });
        }

    } 
```

我的目标是遍历答案，每笔交易发送一个 ajax 调用。如果有人能告诉我如何在一个电话中做到这一点，我愿意听 :)

警报全部弹出，显示正确的数据，但是当我进行 ajax 调用时，进度函数被调用，但 ajax 调用从未到达服务器 - 我什至从未在 Fiddler 中看到它 - 就像什么都没发生一样。下面列出了控制器方法和预期的模型——还没有填写控制器方法——仍然试图让它触发。

模型：

```
 public class UserQuestionModelSave
    {
        public string UserQuestionId { get; set; }
        public string LoginId { get; set; }
        public string QuestionId { get; set; }
        public string UserAnswer { get; set; }
    } 
```

控制器：

```
 [HttpPost]
    public ActionResult SaveChallengeQuestion(UserQuestionModelSave aQuestionInfo)
    {
        UserModelBuilder umb = new UserModelBuilder();

        if (ModelState.IsValid)
        {
            try
            {
                return Json(new { success = true });

            }
            catch (Exception)
            {
                return Json(new { success = false });
            }
        }

        return Json(new { success = false });

    } 
```

如果有人有任何想法，我将不胜感激 - 这已经困扰了我近 2 天......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:31:03.770

如果 ajax 请求没有触发，那么您应该检查控制台是否有 javascript 错误。顺便说一句，您的代码中没有“inSuccess()”函数，您在此 ajax 调用中使用了该函数。

# http - 将数据从设备发送到服务器的最佳方法是什么

> ID：12162492
> 
> 赞同：1
> 
> 时间：2012-08-28T15:21:01.047
> 
> 标签：http, post, csv, device

我目前正在为一家能源监测公司开发一个网站。我们正在尝试将大量数据从记录数据的设备发送到服务器，以便在数据库中进行处理。开发固件的人似乎认为发送数据的最佳方式是生成 CSV 文件并通过 FTP 发送它们。服务器上的程序需要监控通过 FTP 接收到的文件并运行 PHP 脚本来处理它们。然而，我认为发送数据的最佳方式是通过 HTTP POST。

我们有 HTTP POST 工作，然后我开始尝试使用 CSV，这变得很痛苦，因为可靠地监控通过 FTP 接收的文件意味着编辑 ProFTPD 配置文件（我发现这是一项几乎不可能完成的任务）并安装一个名为 mod_exec 的包（带有安全风险），以便 ProFTPD 可以运行 PHP 脚本。这些问题以及我不熟悉需要大量使用来设置它的 linux 控制台的事实，使得 CSV 方法很难设置。HTTP POST 对我来说似乎是一种更直接的发送数据的方式，无需担心文件或依赖 ProFTPD。它还允许我们使用标识符来为传递的数据赋予含义，而不是含义不立即显现的一串值。此外，

然而，仅仅因为 HTTP POST 方法更容易并不意味着 CSV 方法没有优势。此外，固件人员在计算机方面的经验比我多得多，所以我相信他的意见。

你能帮我理解他对 CSV 方法优势的观点并解释什么是最好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:31:38.473

你是对的。FTP 在防火墙方面存在重大问题，尤其是在移动（经过 NAT 的）IPv4 上不能很好地工作。在这种情况下，HTTP POST 的工作要好得多，只是因为没有人接受破坏 HTTP 的“互联网”连接。

此外，HTTP 在设备上也更容易。它只是一个单套接字协议，在该套接字上具有微不足道的读/写语义。

还有一些好处？HTTP 几乎原生支持压缩 (gzip)。HTTP 传输可以在输入完成之前开始。HTTP 更容易保护（HTTPS）...

不，确实没有什么理由使用 FTP。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T15:34:42.817

“CSV 方法”（尽管我将其称为“FTP 方法”）具有嵌入式开发人员知道的优势。接收方将不得不创建某种方法来检查是否有文件。这增加了复杂性。

“HTTP 方法”有几个优点：

*   HTTP 在发送端很容易实现
*   无需创建文件检查器
*   如果一切正常，您可以回复嵌入式设备

我实际上只是实现了一个这样的系统（数据不多，但仍然如此）并使用 HTTP POST 发送数据。我自己实现了 HTTP POST。

# spring - 几个带有spring的PropertyPlaceholderConfigurer

> ID：12162495
> 
> 赞同：2
> 
> 时间：2012-08-28T15:21:06.507
> 
> 标签：spring, properties

我的 spring bean 定义有一个奇怪的问题。我的应用程序是一个多模块的东西。目前我有一个名为 core-lib 的项目，它有一个 spring.xml 文件，它定义了一个 PropertyPlaceholderConfigurer，如下所示：

```
<bean id="corePropertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="order" value="10" />
    <property name="locations">
        <list>
            <!-- default properties files containing ALL possible properties -->
            <value>classpath:default.connection.properties</value>
            <value>classpath:default.mq.properties</value>
            <!-- installation specific, optional properties file containing overridden properties -->
            <value>classpath:connection.properties</value>
            <value>classpath:mq.properties</value>
        </list>
    </property>
    <property name="ignoreResourceNotFound" value="true" />
</bean> 
```

其次，我有一个依赖项目，它有自己的 spring.xml 文件，包括来自 core-lib 项目的文件。此外，它定义了第二个 PropertyPlaceholderConfigurer，如下所示：

```
<!-- import configuration from service layer -->
<import resource="classpath:spring.xml"/> 

<bean id="commPropertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="order" value="20" />
    <property name="locations">
        <list>
            <!-- properties files containing ALL possible properties -->
            <value>classpath:processing.properties</value>
        </list>
    </property>
    <property name="ignoreResourceNotFound" value="true" />
</bean> 
```

现在我的行​​为是由于缺少属性，在第二个 spring PlaceholderConfigurer 中定义的 bean 无法实例化：

> BeanDefinitionStoreException：在类路径资源 [comm-server.spring.xml] 中定义的名称为“commServer”的 bean 定义无效：无法解析占位符“comm.server.CommServer.port”

如果我在 PropertyPlaceholderConfigurer 类中设置断点，它只会为第一个 bean 实例触发，而不会为第二个实例触发。有没有人有类似的设置，可以给我一些建议？

谢谢，

塞巴斯蒂安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:31:47.083

好的，我自己解决了这个问题，尽管我不明白为什么这会如此奇怪。我在第二个占位符 (?{ 而不是 ${) 中定义了一个不同的前缀，现在它可以工作了。我曾预计这将在没有任何特殊前缀的情况下工作......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-02T12:59:16.520

通过定义新的占位符前缀和后缀，有一种更舒适的方法：

```
<bean id="propertyConfigurer"
      class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
  <property name="location">
    <value>classpath:configuration.properties</value>
  </property>
  <property name="placeholderPrefix" value="myprefix{" />
  <property name="placeholderSuffix" value="}" />
</bean> 
```

在这里找到：http: [//javalibs.blogspot.co.at/2008/04/java-spring-framework-multiple.html](http://javalibs.blogspot.co.at/2008/04/java-spring-framework-multiple.html)

# drop-down-menu - Dropdown 落后于 jPlayer (IE7)

> ID：12162497
> 
> 赞同：0
> 
> 时间：2012-08-28T15:21:15.287
> 
> 标签：drop-down-menu, internet-explorer-7, z-index, hidden, jplayer

我正在重新设计一个新的网站；到目前为止，所有浏览器兼容性问题都已解决，但 IE7 中仍然存在一个问题。

客户端有一个从标题延伸到内容的下拉菜单，但是当客户端在页面上有相关视频时会出现问题，因为这通常首先显示；视频 [显示在标题下方] 将菜单​​推到后面。

下拉菜单是在 CSS 中使用高 z-index 值 (1000) 创建的。JavaScript 用于通过更改“可见性”值来隐藏和显示菜单。

该视频使用 jPlayer，考虑到 IE7 的时代，它不使用 HTML5 来显示视频，而是包含一个 .swf 文件。

* * *

我尝试将标题、jPlayer 等的 z-index 更改为该站点上的建议，但没有运气。我也尝试将位置从绝对位置更改为相对位置，但这破坏了下拉菜单。

我修改了参数“wmode”，使其属性为“透明”，我也尝试过“不透明”。

到目前为止，我所做的唯一不同是在工作日志中增加了几个小时。

* * *

该页面的问题可以在这里找到：http: [//www.newforest.gov.uk/healthandleisure/](http://www.newforest.gov.uk/healthandleisure/)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:37:52.157

您是否尝试过 iframe 垫片？我对 google earth 插件也有类似的体验，并将 shim 添加到需要放在 swf 元素之上的部分中：

```
<iframe class="bgi" frameborder="0" scrolling="no" src="about:blank">
<html><head></head><body></body></html>
</iframe> 
```

其中 bgi 是一个具有

```
height:100%;
width:100%;
z-index:-1; 
```

# html - 设置页面加载时选中的几个复选框（jsf）

> ID：12162498
> 
> 赞同：0
> 
> 时间：2012-08-28T15:21:18.670
> 
> 标签：html, jsf, jsf-2, checkbox

我正在使用 JSF 2.0 创建 Web 应用程序，我想在其中设置要在页面加载时选中的复选框。

```
<h:selectManyCheckbox value="#{UserRegistration.rightSelected}" id="myRight">
    <f:selectItem itemValue="add" itemLabel="Add"/>
    <f:selectItem itemValue="delete" itemLabel="Delete" />
    <f:selectItem itemValue="edit" itemLabel="Edit" />
</h:selectManyCheckbox> 
```

在这种情况下，我想设置、添加和删除复选框默认选中。我怎样才能做到这一点？

我试过了，

```
 <body onload="myRight:0:true"> 
```

生成 HTML 内容是

```
<td><table id="myRight">
<tr>
     <td>
     <input name="myRight" id="myRight:0" value="add" type="checkbox" checked="checked" />         <label for="myRight:0" class=""> Add</label></td>
     <td>
     <input name="myRight" id="myRight:1" value="delete" type="checkbox" checked="checked" /><label for="myRight:1" class=""> Delete</label></td>
     <td>
     <input name="myRight" id="myRight:2" value="edit" type="checkbox" checked="checked" /><label for="myRight:2" class=""> Edit</label></td>
</tr> 
```

但是它不起作用。

请建议我如何完成这项工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T16:51:43.210

如果`rightSelected`是一个数组初始化你`rightSelected`如下

```
private String[] rightSelected= {"add","delete"}; 
```

如果`rightSelected`是一个列表就行

```
rightSelected.add("add");
rightSelected.add("delete"); 
```

或者

```
List<String> rightSelected = Arrays.asList("add", "delete"); 
```

# python - 通过 Py2exe 导入 PyVISA

> ID：12162500
> 
> 赞同：0
> 
> 时间：2012-08-28T15:21:20.950
> 
> 标签：python, py2exe, visa

我的脚本文件 test.py 是：

```
try:
    from visa import *
except Exception as ex:
    print ex
    raw_input() 
```

我的 setup.py 文件是：

```
from distutils.core import setup
import py2exe

setup(console=['test.py']) 
```

然后我运行：

> python setup.py py2exe

如果我然后在我的电脑上启动 test.exe，我看不到任何问题，但如果我将它复制到没有先前安装 python 的新电脑，我会得到：

> [错误 126] 找不到指定的模块

我不知道如何打印完整的回溯。有没有其他人看到这个问题？运行 Python 2.7、PyVisa 1.4。两台机器都是Win7。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T21:05:47.903

Turns out the problem was that the visa libraries that pyvisa relies on weren't installed on the test pc. These libraries don't come included with pyvisa.

# javascript - 您无权调用 msgbox

> ID：12162501
> 
> 赞同：1
> 
> 时间：2012-08-28T15:21:27.393
> 
> 标签：javascript, google-apps-script, google-sheets, triggers

我有代码需要提醒今天的时间表代码是：

```
function daily() {
var d = new Date();
var number = d.getDay()
var number1 = number + 1
var day1 = ["חשבון והנדסה - דנה","תרבות ישראל - בתיה","אנגלית - בברלי","מדעים (מעבדה) - אורנה","מדעים (מעבדה) - אורנה","מוזיקה - אביטל","אומנות - רננה","ערבית - ז'קלין"];
var day2 = ["מדעים - אורנה","כישורי שפה - לאה","אנגלית - בברלי","אנגלית - בברלי","גיאוגרפיה - ליאת","תרבות ישראל - בתיה","חינוך גופני - אופירה"];
var day3 = ["תנך לאה","גיאוגרפיה ליאת","כישורי חיים - לאה","כישורי שפה - לאה","ערבית - ז'קלין","כישורי שפה - לאה","היסטוריה - ליאת","ערבית - ז'קלין"];
var day4 = ["כישורי שפה - לאה","מדעים - אורנה","סינית/צרפתית","סינית/צרפתית","אומנות - רננה","חשבון והנדסה - דנה","חשבון והנדסה - דנה"];
var day5 = ["מדעים - אורנה","חשבון והנדסה - דנה","מדעים - אורנה","דרמה - חגית","תנך לאה","חינוך גופני - אופירה","היסטוריה - ליאת"];
var day6 = ["אנגלית - בברלי","אנגלית - בברלי","חשבון והנדסה - דנה","חשבון והנדסה - דנה"];
var text = eval("day" + number1) ;
var i = 1;
var tosend = text[0];
while (text[i])
{
tosend = tosend + "\n" + text[i];
i++
}
Browser.msgBox(tosend);
} 
```

问题是我得到了错误： `You do not have permission to call msgbox for this line - You do not have permission to call msgbox`

你能用糟糕的英语解释我为什么会出现这个错误以及如何解决它吗？

我试图做到这一点，它也没有奏效。

```
alertit(tosend)
}

function alertit(alertthis) {
Browser.msgBox(alertthis)
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-20T13:21:20.040

`Browser.msgBox()`只能在容器绑定到电子表格的脚本中使用，并且仅在电子表格 UI 可用时使用。

例如，如果您从基于时间的触发器运行此操作，它将失败并显示该错误消息，因为没有 UI 与触发器的电子表格版本相关联。

您应该考虑使用其他方式来生成带有时间表的警报，例如发送电子邮件。

# jquery - jqGrid 过滤器显示

> ID：12162506
> 
> 赞同：0
> 
> 时间：2012-08-28T15:21:42.823
> 
> 标签：jquery, jqgrid

我已经看到了很多关于这个的问题和答案。不知道我做错了什么。我试图在第一次显示网格时对其进行过滤。我有一个过滤器工具栏，从用户输入数据加载后可以成功过滤。问题在于尝试在用户输入之前进行过滤。

```
grid.jqGrid({
    ...
    colModel: [
       { name: 'someName', label: 'someLabel', index: 'someIndex', width: 110,
         sortable: true, editable: true, edittype: "select", 
         searchoptions: { defaultValue:'Default value' } }
    ...

grid.jqGrid('filterToolbar', { defaultSearch: 'cn', stringResult: true }); 
```

列过滤器已成功设置为“默认值”。我可以按回车键，然后用它过滤列。我该怎么做才能让网格使用过滤器集自行初始化？

我知道我可以打电话

```
grid[0].triggerToolbar(); 
```

更新 postdata.filters。但是，如果我在设置上面的工具栏后这样做，那就太晚了。查询已发送到服务器。我确定我可能需要在 beforeSend 中执行此操作？

谢谢，斯科特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T16:17:17.333

这里的解决方案有效：[jqGrid Filter Toolbar initial default value](https://stackoverflow.com/questions/2440417/jqgrid-filter-toolbar-initial-default-value)

这是最好/唯一的方法吗？

斯科特

# content-management-system - 找不到 TYPO3 4.7 入门

> ID：12162514
> 
> 赞同：0
> 
> 时间：2012-08-28T15:22:26.297
> 
> 标签：content-management-system, typo3

您好我开始使用TYPO3 4.7，安装后出现问题：

> 在此服务器上找不到请求的 URL /public/typo3/get-started/。

我已经激活了 mod_rewrite 重新启动的 apache 并尝试启用/禁用真实 url .. 问题总是一样的。我不知道我是否必须激活页面或模板。我想知道为什么安装后我看不到本地主机的索引。为什么？有人能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:32:06.133

我猜你的.htaccess 有问题。可能你需要改变

```
RewriteBase /public/typo3/ 
```

要确定问题是什么，您可以检查特定页面的请求是否有效：（对不起，我不知道是否有 id 为 5 的页面。您可以在后端查看它们或尝试一些数字）

```
/public/typo3/index.php?id=5 
```

# c++ - 如何正确处理带有移动构造函数的 shared_ptr 映射？

> ID：12162515
> 
> 赞同：4
> 
> 时间：2012-08-28T15:22:27.487
> 
> 标签：c++, map, shared-ptr

考虑我有一个容器`std::map<int, std::shared_ptr<MyClass>>`，我想将它填充到外部函数中并避免处理它的内容。所以我有

```
typedef Container std::map<int, std::shared_ptr<MyClass>>

Container&& f(){
    Container bar;
    auto foo = std::shared_ptr<MyClass>(new MyClass());
    bar.insert(std::make_pair(0,foo));
    std::cout<<bar.at(1)->print_smth<<'\n'; //This works
    return std::move(bar);
}

int main(){
    Container baz(f());
    std::cout<<bar.at(1)->print_smth<<'\n'; //This doesn't
    // Container baz has element 1, but shared_ptr is invalidated, because it has 0 references.

} 
```

如果我使用传统的复制构造函数，一切都会按预期工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T15:27:22.217

这*太*复杂了。为什么不直接说：

```
int main()
{
    Container baz { { 0, std::make_shared<MyClass>() } };

    // ...
} 
```

如果您绝对必须使用辅助函数，则必须返回一个对象，而不是悬空引用。像这样的东西：

```
Container f()
{
    return Container { { 0, std::make_shared<MyClass>() } };
} 
```

很难放纵任何比这更平庸的东西，但最后一个，永远不会在家里使用的版本：

```
Container f()
{
   Container bar;
   auto p = std::make_shared<MyClass>;

   bar[0] = p;                        // Method #1
   // ---- ALTERNATIVELY ---
   bar.insert(std::make_pair(0, p));  // Method #2
   // ---- ALTERNATIVELY ---
   bar.emplace(0, p);                 // Method #3

   return bar;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:43:11.250

问题是您从`f()`. 右值引用仍然是一个引用，就像你永远不会从函数返回对本地的引用一样，你也不能用右值引用来做到这一点。

好消息是您不必这样做。由于[返回值优化](http://en.wikipedia.org/wiki/Return_value_optimization)，您可以简单地返回一个`Container`from `f()`，它会完全按照您的要求进行操作。

# objective-c - 应用关闭时的 UILocalNotification

> ID：12162516
> 
> 赞同：3
> 
> 时间：2012-08-28T15:22:30.063
> 
> 标签：objective-c

使用 `UILocalNotification` 应用程序打开时，应用程序委托中的此功能被触发：

```
 - (void)application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification
{ 
```

但是当应用程序关闭并且不在后台时，它会在我点击通知按摩时启动应用程序，但它不会触发此方法。

我需要开火，因为她是带我去另一个场景的人——当有人收到通知时我需要展示它。

仅当她在后台时才有效。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T15:24:50.183

你必须实施`application:didFinishLaunchingWithOptions:`. 通知将是选项之一。

```
- (BOOL)application:(UIApplication *)application 
  didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
    UILocalNotification *notification = [launchOptions objectForKey:UIApplicationLaunchOptionsLocalNotificationKey];
    if (notification) {
        // handle your notification here.
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-28T15:28:11.120

从规格：

```
If the action button is tapped (on a device running iOS), the system 
launches the application and the application calls its delegate’s    
application:didFinishLaunchingWithOptions: method (if implemented); it passes 
in the notification payload (for remote notifications) or the local-notification 
object (for local notifications). 
```

换句话说，`application:didReceiveLocalNotification`仅当您发现应用程序正在运行时。

如果应用程序由于本地（或远程）通知而启动，则通知中的商品将传递到`application:didFinishLaunchingWithOptions:`方法中，这就是您捕获的地方。

# codeigniter - Codeigniter Mail - 我让它工作了，但现在不行了。告诉我为什么？

> ID：12162519
> 
> 赞同：1
> 
> 时间：2012-08-28T15:23:01.883
> 
> 标签：codeigniter, email

只是想在 Codeigniter 中设置一个 AJAX 联系表。这是我第一次使用 CI。

我让它工作，现在它坏了，我不知道为什么。

这是代码..

JS

```
$.ajax({
        type:'POST',
        url: post_url,
        data: post_data,
        beforeSend:function(){
            alert(this.data);  <<< This is alerting the correct form data to me
        },
        success:function(msg){
            $($form).fadeOut(500, function(){
                var msg = '<div class="messageSent"><p>'+ msg +'</p></div>';
                $form.html(msg).fadeIn();  <<< This is returning undefined
            });
        }
    }); 
```

..和PHP ...

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');
class Email extends CI_Controller{

 public function __construct()
   {
        parent::__construct();
        $this->load->library('email');
   }

public function index(){

$emailFromName = $this->input->post('name', TRUE);
$emailFromAddress = html_entity_decode($this->input->post('email', TRUE));
$emailFromMessage = "Email from the Brewer's website\n";
$emailFromMessage .= "==============================\n";
$emailFromMessage .= "From: " + $emailFromName + "\n";
$emailFromMessage .= "==============================\n";
$emailFromMessage .= "Respond Email; " + $emailFromAddress +"\n";
$emailFromMessage .= "==============================\n";
$emailFromMessage .= $this->input->post('message', TRUE);

$this->email->from($emailFromName);
$this->email->to('recipient@gmail.com'); 
$this->email->subject('Message from the website.');
$this->email->message($emailFromMessage);   

$this->email->send();

echo $this->email->print_debugger();  // echoes undefined
// echo($emailFromName);  // also echoes undefined
}
}

?> 
```

我认为问题一定出在 PHP 中。它似乎没有读取任何已发布的变量。我什至无法回显 $this->input->post('name'); （虽然我有它的工作！）

..那么我做错了什么？

注意 - 我把 html_entity_decode 放在那里，因为我注意到电子邮件地址被发布为“address%40gmail.com”......所以这似乎是个好主意。有必要吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:29:11.157

严格来说，这不是您问题的答案——但我在稳定我的 CodeIgniter 项目的邮件功能方面遇到了很大的困难。我找到的解决方案花了大约 1 个小时来实施，我敢肯定，它为我节省了 10 个小时的麻烦。

考虑使用“SwiftMailer”框架从您的应用程序发送邮件。它是一个强大可靠的 php 邮件框架，而且它是免费的。起初我很难整合这 2 个框架，然后我找到了这个博客，我在几分钟内完成了任务。

[http://grafikkaos.co.uk/blog/article/101-using-swift-mailer-with-codeigniter](http://grafikkaos.co.uk/blog/article/101-using-swift-mailer-with-codeigniter)

# ruby - 无法加载此类文件 -- ntlm/http (LoadError) - ruby

> ID：12162525
> 
> 赞同：1
> 
> 时间：2012-08-28T15:23:28.767
> 
> 标签：ruby

我正在使用 ntlm-http gem 来验证 Windows 身份验证。当我在我的测试 Ruby 代码中运行时，这很好用，但是当我使用 Cucumber 实现它时，它抱怨：

```
cannot load such file -- ntlm/http (LoadError) 
```

任何人都可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T14:01:12.940

尝试以下操作：

```
require 'net/ntlm_http' 
```

为我工作！

# android - 用于移动数据的广播接收器

> ID：12162530
> 
> 赞同：0
> 
> 时间：2012-08-28T15:23:58.237
> 
> 标签：android

我有这个 BroadCastReceiver 来监听`WiFi`状态的变化：

```
private BroadcastReceiver mWifiStateChangedReceiver = new BroadcastReceiver() {

    @Override
    public void onReceive(Context context, Intent intent) {

        int extraWifiState = intent.getIntExtra(
                WifiManager.EXTRA_WIFI_STATE,
                WifiManager.WIFI_STATE_UNKNOWN
                );

        wifiState = new WifiState(Main.this);

        switch (extraWifiState) {

        case WifiManager.WIFI_STATE_DISABLED:
            wifiState.haveNetworkConnection();
            break;

        case WifiManager.WIFI_STATE_ENABLED:

            ConnectivityManager conMan = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
            while (conMan.getActiveNetworkInfo() == null
                    || conMan.getActiveNetworkInfo().getState() != NetworkInfo.State.CONNECTED) {

                wifiState.cancelDialog();

            }
            break;
        case WifiManager.WIFI_STATE_ENABLING:
            break;
        case WifiManager.WIFI_STATE_UNKNOWN:
            break;
        }
    }
}; 
```

如何在此广播接收器中添加对收听移动数据的支持？

提前谢谢各位！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T16:00:29.697

您可以收听`"android.intent.action.ANY_DATA_STATE"`并在数据连接状态更改（移动数据和/或 wifi）时收到通知。

# c# - 用水晶报表显示一对多关系

> ID：12162533
> 
> 赞同：0
> 
> 时间：2012-08-28T15:24:13.073
> 
> 标签：c#, .net, crystal-reports

我的数据库中有两个表：

```
Order(OrderID, Date, ClientID)
OrderItem(OrderID, ProductID, Quantity) 
```

1 个订单可以有多个 OrderItem(s)。这是一对多的关系。

我想以主从方式显示这些记录，如下所示：

```
 Order 1 :
            -OrderItem2
            -OrderItem4

        Order 2:
             -OrderItem10 
```

在我的 asp.net 应用程序中，我创建了一个包含两个 DataTable（Order 和 OrderItem）的 DataSet。这两个数据表具有基于 OrderID 的关系。

我的问题是：

```
 - Is this the right way to go in this situation ?
  - Is there a more natural way to do this in Crystal Reports ? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:37:29.207

自然的方法是按订单（特别是 OrderID）对您的报告进行分组。然后，您可以将 OrderItem 数据放在报告的详细信息部分，将订单数据放在报告的 Group Header 部分，它将按照您的描述显示。

# jquery - 验证失败时表单仍然提交

> ID：12162534
> 
> 赞同：0
> 
> 时间：2012-08-28T15:24:16.203
> 
> 标签：jquery, html

我有一个表单，即使验证失败，它仍会提交给控制器。

jQuery：

```
$(document).ready(function () {
       $('#commentForm').validate();
});

 $(function () {
     $('#commentForm').submit(function () {
         $('#result').empty();
         $.ajax({
             url: "Action/Index",
             type: "POST",
             data: {
                 name: $('#name').val(),
                 emailAddress: $('#emailAddress').val()
             },
             success: function (result) {
              alert(result);

                 }
             }
         });
       return false;
     });
 }); 
```

html:

```
<form class="cmxform" id="commentForm">
<fieldset>
<div id="contactUsName">Your Name<br />
    <input type="text" id="name" class="required" />
</div>
<div id="contactUsEmail">Email Address<br />
    <input type="text" id="emailAddress" class="required email" />
</div>
</fieldset>
</form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T15:26:19.327

您应该使用验证 submitHandler 属性，如下所示：

```
$('#commentForm').validate(
  submitHandler: function () {
         $('#result').empty();
         $.ajax({
             url: "Action/Index",
             type: "POST",
             data: {
                 name: $('#name').val(),
                 emailAddress: $('#emailAddress').val()
             },
             success: function (result) {
              alert(result);

             }
           }
         );
       return false;
     });
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T15:26:31.340

你有一个额外的括号`}`：

```
 }
         } //<-- you should remove this one
     });

   return false; 
```

# architecture - Stevens 的 TCP/IP 图解图形

> ID：12162538
> 
> 赞同：3
> 
> 时间：2012-08-28T15:24:43.943
> 
> 标签：architecture, network-programming, tcp-ip

我正在研究流程图和其他图形和图表。

Stevens 在 TCP/IP Illustrated 中解释协议或流程时，使用带有两条垂直线“客户端”和“服务器”以及它们之间的箭头的图表。有人知道书中图表的名称吗？

有人知道其他类型的图表或可以列出它们吗？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T15:28:08.203

我不熟悉这本书，但听起来你在描述 UML[序列图](http://www.agilemodeling.com/artifacts/sequenceDiagram.htm)：

![在此处输入图像描述](../Images/a703c243edae961e674c0a73e17d49fc.png)

如果您想自己制作，[WebSequenceDiagrams](http://www.websequencediagrams.com/)是一个很棒的免费在线资源。

UML 有[许多其他](http://www.agilemodeling.com/essays/umlDiagrams.htm)用于表示代码的图表，您可能会发现它们很有帮助。

# jquery - 无法在页面上找到表格的当前位置

> ID：12162539
> 
> 赞同：2
> 
> 时间：2012-08-28T15:24:45.117
> 
> 标签：jquery, twitter-bootstrap

我正在使用 twitter bootstrap 尝试通过克隆表来锁定表中的第一列，如下所示：

```
$('#dashboardtab').load('load_table.php', function() {  

    $('#scroller #testcase').each(function(){
        var table = $(this),
        fixedCol = table.clone(true),
        fixedWidth = table.find('th').eq(0).width(),
        tablePos = table.position();

        alert("LEFT: " + tablePos.left);

        ...
    });
}); 
```

我的 HTML 如下所示：

```
<div class="row">
<div id="scroller">

    <table id="testcase" class="table table-striped table-bordered table-condensed">
    <thead>
        <tr>
           <th>TEST 1</th>
           <th>TEST 2</th>
           <th>TEST 3</th>
        </tr>
    </thead>
    <tbody>
    ...
    </tbody>
    </table>
</div>
</div> 
```

知道为什么位置总是0吗？查看页面时，它显然不在这个位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:29:54.183

我认为问题在于`position()`返回元素相对于其父元素的位置；而在这种情况下，您似乎想要页面上的位置，这将是`offset()`（但据我所知，否则使用相同）。从 API（对于`position()`）：

> .position() 方法允许我们检索元素相对于偏移父元素的当前位置。将此与 .offset() 进行对比，后者检索相对于文档的当前位置。当将新元素定位在另一个元素附近并在同一个包含 DOM 元素内时，.position() 更有用。

因此，我建议：

```
tablePos = table.offset(); 
```

参考：

*   [`offset()`](http://api.jquery.com/offset/).
*   [`position()`](http://api.jquery.com/position/).

# android - Android：使用 getWritableDatabase() 获取 java.lang.NullPointerException

> ID：12162547
> 
> 赞同：1
> 
> 时间：2012-08-28T15:25:05.927
> 
> 标签：android, nullpointerexception

运行 getWritableDatabase 或 getReadableDatabase 时收到空错误。我知道这个问题已被多次提出，但我花了 7 天时间倾注所有评论，但没有任何运气。

这是第一个代码 - HandleCall

```
package com.mintz.callmeback;
import android.app.Notification;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.app.Service;
import android.content.Context;
import android.content.Intent;
import android.os.IBinder;
import android.util.Log;

public class HandleCall extends Service implements Runnable {
String TAG = "HandleCall";
String phoneNum;

private NotificationManager notificationManager; 
private Notification notification;

//CallMeBackApp CallApp = new CallMeBackApp();
Context context;

public HandleCall(String phone)
{
    phoneNum = phone;

    Log.i(TAG, "Constractor");

}

public void run() {

    CallData callData = new CallData(this);

    //CallMeBackApp callApp = new CallMeBackApp();
    //callApp.endCall2();
    Log.i(TAG, "run1"+phoneNum);
    if (callData!=null)
        Log.d(TAG,"callData is not null!"); 
```

这是“if”语句中的问题，我阅读了很多关于“null”的答案，所以我尝试在 SQL 任务之前检查它是否为 null，如您所见：

```
 if ((callData != null)&&(callData.isPhoneInTheList1(phoneNum, this))){              Log.i(TAG, "run2");
        SendSms.sendIt(phoneNum);
        Log.i(TAG, "run3");

        notificationManager = (NotificationManager) this.getSystemService(NOTIFICATION_SERVICE);
        notification = new Notification(android.R.drawable.stat_notify_chat,"", 0);
        sendCallNotification(phoneNum);
    }
    else{
        Log.d(TAG, "didnt found the phone number");
    }

}

private void sendCallNotification(String phone) {
    Log.d(TAG, "sendCallNotification'ing");
    Intent callIntent = new Intent(getApplicationContext(), MakeCall.class);
    callIntent.putExtra("PhoneNumberToCallBack", phone);
    PendingIntent pendingIntent = PendingIntent.getActivity(this, -1,callIntent ,PendingIntent.FLAG_UPDATE_CURRENT); //
    this.notification.when = System.currentTimeMillis(); // time when it's happened
    this.notification.flags |= Notification.FLAG_AUTO_CANCEL; // This flag tells the Notification manager to cancel this notification as soon as the user clicks on it.
    CharSequence notificationTitle = this.getText(R.string.callBackToTitle); //
    CharSequence notificationSummary = this.getString(R.string.callBackToMessage, phone);
    this.notification.setLatestEventInfo(this, notificationTitle, notificationSummary, pendingIntent); //
    this.notificationManager.notify(0, this.notification);
    Log.d(TAG, "sendTimelineNotificationed");
    }

@Override
public IBinder onBind(Intent intent) {
    // TODO Auto-generated method stub
    return null;
}

} 
```

和另一个类：

```
package com.mintz.callmeback;

import android.content.Context;
import android.content.ContentValues;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.util.Log;

public class CallData {

static final String TAG = "CallData";
static final String DB_NAME = "PhoneToCallBack.db"; // database filename
static final int DB_VERSION = 1;
static final String TABLE = "PhoneToCallBack";
static final String C_ID = "_id";
static final String C_PHONE_NUMBER = "phone_number";
private static final String GET_ALL_ORDER_BY = C_PHONE_NUMBER + " DESC";
private static final String[] DB_PHONE_COLUMNS = { C_PHONE_NUMBER };
Context context;

// Constructor
public CallData(Context context) {
    Log.i(TAG, "Initialized data");
    this.context = context;
    this.dbHelper = new DBHelper(context);
}

// DataBase Helper for the all App
public class DBHelper extends SQLiteOpenHelper {
    Context context;

    // Constructor
      public DBHelper(Context context) {
          super(context, DB_NAME, null, DB_VERSION);
          this.context = context;
      }  
    // Not nead for now
    //public DBHelper(Context context, String name, SQLiteDatabase.CursorFactory factory) {
    //  super(context, name, factory, DB_VERSION);
    //  this.context = context;
    //}

    @Override
    public void onCreate(SQLiteDatabase db) {
        Log.d(TAG, "Creating database: " + DB_NAME);
        //String sql = context.getString(R.string.sql1);
        //Log.d(TAG, "onCreated sql: " + sql);
        db.execSQL("create table " + TABLE + " (" + C_ID + " int primary key, "
                  + C_PHONE_NUMBER + " text)");
        //db.execSQL(sql);
    }

    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        db.execSQL("drop table if exists " + TABLE); // blow the old database away
        Log.d(TAG, "onUpdated");
        this.onCreate(db); // run onCreate to get new database
      }
}//End of DBHelper Class

public DBHelper dbHelper;

public void close() {
    this.dbHelper.close();
}

public void insertOrIgnore(ContentValues values) {
    Log.d(TAG, "insertOrIgnore on " + values);
    SQLiteDatabase db = this.dbHelper.getWritableDatabase();
    try {
        db.insertWithOnConflict(TABLE, null, values, SQLiteDatabase.CONFLICT_IGNORE); 
    } finally {
        db.close();
    }
}

  /**
   * 
   * @return Cursor where the columns are _id, phone_number
   */
  public Cursor getPhoneList() {
    SQLiteDatabase db = this.dbHelper.getReadableDatabase();
    return db.query(TABLE, null, null, null, null, null, GET_ALL_ORDER_BY);
  } 

  /**
   * Deletes ALL the data
   */
  public void delete() {
    // Open Database
    SQLiteDatabase db = this.dbHelper.getWritableDatabase();

    // Delete the data
    db.delete(TABLE, null, null);

    // Close Database
    db.close();
  }

  /**
   * 
   * @param Phone number to check if exist
   * @return True if the number is in the list
   */
  public Boolean isPhoneInTheList(String phone) {
    SQLiteDatabase db = dbHelper.getReadableDatabase();
    Log.d(TAG, "befor query");
    //Cursor cursor = db.query(TABLE, null, null, phone, null, null, null);

    Cursor cursor = db.query("PhoneToCallBack", null, "phone_number=" + phone,null, null, null, null);

      return (cursor.moveToFirst()) ; //Return True if find the Phone number in the DB

  }

  public Boolean isPhoneInTheList1(String phone, Context context) {
        //DBHelper dbHelper1;
        dbHelper = new DBHelper(context);
        SQLiteDatabase database;

        if (dbHelper != null)
            Log.d(TAG,"dbHelper1 != null");

        database = dbHelper.getWritableDatabase();
        Log.d(TAG, "befor query");
        Cursor cursor = database.query("PhoneToCallBack", null, "phone_number=" + phone,null, null, null, null);
        return (cursor.moveToFirst()) ; //Return True if find the Phone number in the DB

      } 
```

}

这是我拨打电话并拨打 HandleCall 时得到的信息：

```
08-28 15:17:45.706: I/CallData(340): Initialized data
08-28 15:17:45.725: I/CallData(340): Initialized data
08-28 15:17:45.725: D/CallMeBackMainActivity(340): onCreate
08-28 15:17:45.826: D/CallMeBackMainActivity(340): onResume
08-28 15:17:45.826: D/CallMeBackMainActivity(340): Get the data from the database
08-28 15:17:45.886: D/CallMeBackMainActivity(340): Get the Cursor
08-28 15:19:21.495: D/PhoneServiceReceiver(340): the number is: 55555555
08-28 15:19:21.505: D/MyPhoneStateListener(340): RINGING from 55555555
08-28 15:19:21.535: I/HandleCall(340): Constractor
08-28 15:19:21.588: I/CallData(340): Initialized data
08-28 15:19:21.588: I/HandleCall(340): run155555555
08-28 15:19:21.595: D/HandleCall(340): callData is not null!
08-28 15:19:21.605: D/CallData(340): dbHelper1 != null
08-28 15:19:21.605: W/dalvikvm(340): threadid=9: thread exiting with uncaught exception (group=0x40015560)
08-28 15:19:21.638: E/AndroidRuntime(340): FATAL EXCEPTION: Thread-10
08-28 15:19:21.638: E/AndroidRuntime(340): java.lang.NullPointerException
08-28 15:19:21.638: E/AndroidRuntime(340):  at                android.content.ContextWrapper.openOrCreateDatabase(ContextWrapper.java:203)
08-28 15:19:21.638: E/AndroidRuntime(340):  at android.database.sqlite.SQLiteOpenHelper.getWritableDatabase(SQLiteOpenHelper.java:118)
08-28 15:19:21.638: E/AndroidRuntime(340):  at com.mintz.callmeback.CallData.isPhoneInTheList1(CallData.java:133)
08-28 15:19:21.638: E/AndroidRuntime(340):  at com.mintz.callmeback.HandleCall.run(HandleCall.java:43)
08-28 15:19:21.638: E/AndroidRuntime(340):  at java.lang.Thread.run(Thread.java:1019)
08-28 15:19:21.895: W/IInputConnectionWrapper(340): showStatusIcon on inactive     InputConnection
08-28 15:19:40.655: D/dalvikvm(340): GC_EXPLICIT freed 92K, 52% free 2599K/5379K, external 884K/1038K, paused 115ms 
```

我很想得到任何帮助，我真的被困住了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:43:48.633

我认为您正在使用来自 Activity 的新调用来初始化 HandleCall。如果是这样，你不能那样做。因为在这种情况下，您将没有服务 HandleCall 的上下文。这就是为什么你有一个崩溃。

如果您正在这样做，那么`new HandleCall`您将无法通过`this`

```
CallData callData = new CallData(this); 
```

您必须`context`在上面的行中传递一个已由框架初始化的属性，而不是 this

编辑：

```
public HandleCall(String phone, Context ctx)
{
    phoneNum = phone;
    context = ctx;
    Log.i(TAG, "Constractor");

} 
```

现在使用

```
 CallData callData = new CallData(context); 
```

还有打电话的时候`new HandleCall(phone, Activityname.this)`

# ruby - Nokogiri 无法使用 UTF-16 声明输出 XML（理解和解决）

> ID：12162548
> 
> 赞同：6
> 
> 时间：2012-08-28T15:25:09.573
> 
> 标签：ruby, xml, character-encoding, nokogiri, libxml2

## 概括

尝试读取和序列化具有 UTF-16 编码和声明的 XML 文档会导致 Nokogiri 在某个时间点之后产生垃圾。

1.  这是一个错误，还是对此有合理的解释？
2.  避免它的最佳方法是什么？

## 环境

```
C:\>nokogiri -v
# Nokogiri (1.5.5)
    ---
    warnings: []
    nokogiri: 1.5.5
    ruby:
      version: 1.9.3
      platform: i386-mingw32
      description: ruby 1.9.3p194 (2012-04-20) [i386-mingw32]
      engine: ruby
    libxml:
      binding: extension
      compiled: 2.7.7
      loaded: 2.7.7 
```

## 细节

我有一个用 UTF-16(LE) 编码的 XML 文件，它还在顶部包含一个 PI XML 声明，表明编码是 UTF-16。总结一下，它看起来像这样：

```
<?xml version="1.0" encoding="UTF-16" ?>
<Foo>
  <Bar><![CDATA[
Lorem ipsum dolor ...about 3900 more bytes of content here...
  ]]></Bar>
  <Jim>Oh! Hello there.</Jim>
</Foo> 
```

当我使用 Nokogiri 阅读此文档时，一切似乎都很好：

```
xml = File.open('Simplified.xml','rb:utf-16le',&:read)
p xml.encoding                        # #<Encoding:UTF-16LE>
p xml.valid_encoding?                 # true
doc1 = Nokogiri.XML(xml,&:noblanks)
xml1 = doc1.to_xml.encode('utf-8')
p xml1.encoding                       # #<Encoding:UTF-8>
p xml1.valid_encoding?                # true 
```

但是，序列化文档的输出在某个时间点之后变得模糊：

```
p xml1  # Correct contents of CDATA removed from the following output
#=> "<?xml version=\"1.0\" encoding=\"UTF-16\"?>\n<Foo>\n  <Bar><![CDATA[\n...\n\t]]></Bar>\n  <Jim>Oh! Hello there.\uFFFE\u3C00\u0000\u2F00\u0000\u4A00\u0000\u6900\u0000\u6D00\u0000\u3E00\u0000\u0A00\u0000\u3C00\u0000\u2F00\u0000\u4600\u0000\u6F00\u0000\u6F00\u0000\u3E00\u0000\u0A00\u0000" 
```

[（限制似乎与字符数有关。我可以从 Lorem ipsum 文本中添加和删除几个单词而不做任何更改，但是删除某个点以下的文本会突然修复输出。）]

然而，Nokogiri 文件并没有被破坏。我可以`<Jim>`成功独立序列化：

```
puts doc1.at('Jim').to_xml.encode('utf-8')
#=> <Jim>Oh! Hello there.</Jim> 
```

我发现的唯一解决方法是在解析文档之前删除文档顶部的 XML 声明。有了这个，所有工作都按需要：

```
decl = '<?xml version="1.0" encoding="UTF-16" ?>'.encode('UTF-16LE')
doc2 = Nokogiri.XML(xml.sub(decl,''),&:noblanks)
puts doc2.to_xml.encode('utf-8')
#=> <?xml version="1.0"?>
#=> <Foo>
#=>   <Bar><![CDATA[
#=> Lorem ipsum dolor...and more...
#=>   ]]></Bar>
#=>   <Jim>Oh! Hello there.</Jim>
#=> </Foo> 
```

## 完整的 XML

这是您自己测试的完整文件：

```
<?xml version="1.0" encoding="UTF-16" ?>
<Foo>
  <Bar><![CDATA[
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam ac augue arcu, eget laoreet lorem. Quisque ac augue velit. Integer consectetur suscipit vehicula. Etiam et convallis enim. Etiam varius massa sit amet lacus rhoncus varius in non ante. Sed dictum, metus eu bibendum ornare, ligula dui commodo urna, ut dignissim felis dolor eget nisl. Proin sit amet nisi nunc. Vestibulum a urna sed dui dignissim blandit nec vel enim. Vivamus tincidunt nulla id dui hendrerit hendrerit.
Aliquam neque orci, luctus sit amet fringilla eu, varius vitae diam. Suspendisse varius rutrum lorem eget malesuada. Sed dapibus dapibus nisl, in cursus ante lacinia non. Aenean id sagittis ipsum. Suspendisse elit nunc, porta sit amet blandit ut, laoreet sed est. Nunc eget sem vitae nisl elementum ullamcorper ut sit amet urna. Sed ligula quam, fringilla in facilisis tincidunt, vehicula in nisi. Maecenas a augue in augue semper scelerisque sit amet ut arcu.
Praesent hendrerit, enim in elementum ornare, lorem nisi euismod dolor, sit amet ornare mi sem sodales lacus. Fusce et tempor mauris. In non quam nisl, non consequat diam. Duis sit amet massa ultrices massa cursus iaculis. Nunc ullamcorper malesuada sem dignissim semper. Fusce aliquet lacus quis nisi tincidunt sodales. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque posuere commodo aliquet. Aliquam blandit vestibulum facilisis. Sed pellentesque viverra dignissim. Etiam est lacus, mollis eu pretium vitae, lacinia eleifend augue. Mauris vitae quam nisl. In venenatis nunc ac eros elementum cursus.
Sed a metus sit amet nunc euismod condimentum id non orci. Curabitur velit turpis, lacinia non eleifend sed, rhoncus id est. Fusce ut massa dolor, ut sodales odio. Donec aliquam convallis tellus, eu pharetra tortor iaculis non. Integer imperdiet feugiat ipsum a gravida. Mauris sapien ipsum, ultricies ac placerat ut, imperdiet eu justo. Quisque quis consectetur velit. Etiam facilisis sapien nec enim tincidunt pulvinar. Duis fermentum faucibus felis, sed consequat libero pretium at. Phasellus nibh purus, suscipit in vestibulum vel, blandit at leo. Suspendisse placerat elit sed enim bibendum vel hendrerit mauris pretium. Maecenas ut lacus eu nisi euismod pretium.
Aliquam feugiat felis id massa aliquam pharetra sed non eros. Morbi interdum molestie iaculis. Curabitur varius ante ac dui dapibus non laoreet risus blandit. Nunc sit amet magna lacus. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Phasellus egestas nunc sed turpis imperdiet a rhoncus massa aliquam. Nulla facilisi. Phasellus sit amet neque felis, nec vestibulum massa. Donec luctus fringilla dolor et gravida. Phasellus euismod lectus eget elit hendrerit non vehicula tellus venenatis. Phasellus sit amet ligula et purus dignissim feugiat at vitae libero. Proin ut tortor eros, quis laoreet lectus. Quisque nec urna mattis ante gravida fermentum eu at nibh. Phasellus sapien elit, tincidunt quis laoreet id, lobortis sed magna. Aliquam pulvinar erat eu sapien pretium bibendum. Maecenas eleifend, leo quis sodales tincidunt, leo felis tristique dolor, vitae ultrices neque felis ut metus.
Etiam dignissim egestas ipsum, eget tempor ipsum rutrum eu. Donec vehicula eleifend ullamcorper. Mauris justo nulla, varius a mattis a, cursus sit amet risus. Phasellus rutrum interdum blandit. Donec ut justo eros, ut auctor dolor. Suspendisse potenti. Cras ultricies, dui eget mattis bibendum, leo dui luctus purus, sit amet rhoncus libero metus eget purus. Pellentesque scelerisque ornare sapien faucibus tempor.
Suspendisse potenti. Proin fermentum bibendum dapibus. Pellentesque facilisis aliquam. Nam egestas tellus non mauris scelerisque feugiat pellentesque lacus dignissim. Quisque id nulla felis. Mauris justo mauris, posuere sed facilisis in, venenatis nec risus. Mauris eu dui sed tellus laoreet tempor a in turpis volutpat.
  ]]></Bar>
  <Jim>Oh! Hello there.</Jim>
</Foo> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T18:19:39.547

`encode`您可以指定要在[选项中`to_xml`](http://nokogiri.org/Nokogiri/XML/Node.html#method-i-to_xml)使用的编码，而不是序列化 xml 然后调用字符串；代替

```
xml1 = doc1.to_xml.encode('utf-8') 
```

采用：

```
xml1 = doc1.to_xml(:encoding => 'utf-8') 
```

这似乎解决了问题。

* * *

至于发生了什么，我只能提供一些观察。

首先，在`to_xml`没有指定编码的情况下生成的字符串的编码是`UTF-16`，这在 Ruby 中是一种“虚拟编码”（不管是什么意思）：

```
xml1 = doc1.to_xml
p xml1.encoding
#=> #<Encoding:UTF-16 (dummy)> 
```

文档说这个关于[虚拟编码](http://ruby-doc.org/core-1.9.3/Encoding.html#method-i-dummy-3F)：

> 虚拟编码是未正确实现字符处理的编码。它用于有状态的编码。

我注意到的另一件事是输出的 munged 部分中的值实际上对应于应该出现的代码点。

```
Hello there.\uFFFE\u3C00\u0000\u2F00\u0000\u4A00\u0000\u6900... 
```

`3C`is `<`, `2F`is `/`, `4A`is `J`, `69`is`i`等，产生（如果你忽略零和额外的 BOM）

```
Hello there.</Ji... 
```

如果您在编码为 UTF-8 之前写出 Nokogiri 生成的 XML）并将十六进制编辑器指向它，开始看起来像这样：

```
0000000 ff fe 3c 00 3f 00 78 00 6d 00 6c 00 20 00 76 00 
```

它以 开头`FF FE`，即小端 BOM。

在 munging 开始时，它看起来像这样：

```
0001f20 3c 00 4a 00 69 00 6d 00 3e 00 4f 00 68 00 21 00
0001f30 20 00 48 00 65 00 6c 00 6c 00 6f 00 20 00 74 00
0001f40 68 00 65 00 72 00 65 00 2e 00 fe ff 00 3c 00 00
0001f50 00 2f 00 00 00 4a 00 00 00 69 00 00 00 6d 00 00
0001f60 00 3e 00 00 00 0a 00 00 00 3c 00 00 00 2f 00 00 
```

`fe ff`是 munged 输出开始的地方（在中间线上）。`fe ff`也是*大端*BOM，其他字符似乎是 BE（您可以看到零列如何在 . 之前和之后不对齐`fe ff`。但字符之间还有额外的零字节对。

# android - 使用带有多个子句的 where 子句删除 SQLite Row

> ID：12162549
> 
> 赞同：13
> 
> 时间：2012-08-28T15:25:12.073
> 
> 标签：android, sqlite, where-clause, sql-delete

我一直在四处寻找，但没有找到解决方案或工作示例，所以就到这里了。

我已经建立了一个 SQLite 数据库，它有五个具有不同字段的列，可以有效地为用户构建一个列表。列表中会有多个相同的值，除了设置为自动递增的 ROWID。

一旦将值输入数据库，用户和程序都不会知道 ROWID，因此我希望用户能够删除包含所有其他四个字段的一行。

我的代码如下所示：

```
Database
            .delete(DATABASE_TABLE,
                    "KEY_DATE='date' AND KEY_GRADE='style2' AND KEY_STYLE='style' AND KEY_PUMPLEVEL='pumpLevel'",
                    null); 
```

但这不会删除任何值。我几乎可以肯定这个命令的语法是罪魁祸首。

如何为具有多个 where 子句的删除命令格式化 where 子句？

**下面的解决方案：**

```
ourDatabase.delete(DATABASE_TABLE, "ROWID = (SELECT Max(ROWID) FROM "
            + DATABASE_TABLE + " WHERE " + "date=? AND grade=? AND "
            + "style=? AND pump_level=?)", new String[] { date, grade,
            style, pumpLevel }); 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-28T15:33:35.057

我有一种感觉`KEY_DATE`，`KEY_GRADE`, 等是您的 Java 变量名*而不是*您的实际列名。尝试将您的代码更改为：

```
.delete(DATABASE_TABLE,
        KEY_DATE + "='date' AND " + KEY_GRADE + "='style2' AND " +
        KEY_STYLE + "='style' AND " + KEY_PUMPLEVEL + "='pumpLevel'",
        null); 
```

另外我假设`'date'`,`'style'`等存储在局部变量中，您应该使用该`whereArgs`参数从[SQL 注入攻击](http://en.wikipedia.org/wiki/SQL_injection)中投射自己：

```
.delete(DATABASE_TABLE,
        KEY_DATE + "=? AND " + KEY_GRADE + "=? AND " +
        KEY_STYLE + "=? AND " + KEY_PUMPLEVEL + "=?",
        new String[] {date, grade, style, pumpLevel}); 
```

（其中`date = "date"`,`grade = "style2"`等）

* * *

**从评论中添加**

要删除最后一行，请使用：

```
.delete(DATABASE_TABLE,
        "ROWID = (SELECT Max(ROWID) FROM " + DATABASE_TABLE + ")",
        null); 
```

* * *

要删除最后匹配的行，请尝试以下操作：

```
.delete(DATABASE_TABLE,
        "ROWID = (SELECT Max(ROWID) FROM " + DATABASE_TABLE + " WHERE " +
            "KEY_DATE='date' AND KEY_GRADE='style2' AND " +
            "KEY_STYLE='style' AND KEY_PUMPLEVEL='pumpLevel')",
        null); 
```

但是请参阅我关于 SQL 注入攻击以保护您的数据的第二条说明。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-28T15:39:45.140

你应该使用：

```
Database.delete(DATABASE_TABLE,
                "KEY_DATE=? AND KEY_GRADE = ? AND KEY_STYLE = ? AND KEY_PUMPLEVEL = ?",
                 new String[]{"date", "style2", "style", "pumpLevel"}); 
```

这简化了转义值。

# django - django查询中ImageField的Url

> ID：12162558
> 
> 赞同：3
> 
> 时间：2012-08-28T15:26:10.950
> 
> 标签：django, django-queryset, django-models

我有一个`ModelA`带有 ImageField 类型字段的模型。现在，我想一口气获取所有图像的网址。

所以，当我做 ModelA.objects.all().values() 时，我想要得到类似的东西：

```
[{"id":1, "image_field": "/media/upload_folder/xyz.jpg"}, {...}] 
```

现在，它给出了类似的东西：

```
[{"id":1, "image_field": "upload_folder/xyz.jpg"}, {...}] 
```

我错过了什么吗？

我能做些什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T15:28:18.483

MEDIA_URL 可以更改，因此 Django 不会将其存储在数据库中。您可以自己添加：

```
from django.conf import settings

values = ModelA.objects.all().values()
for value in values:
    value['image_field'] = settings.MEDIA_URL + value['image_field'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T15:33:31.627

您的 settings.py 文件中的 MEDIA_URL 是可变的，因此它无法在开头为您添加它。

循环遍历每个对象并自己添加 MEDIA_URL 值。

```
for value in values:
    newURL = settings.MEDIA_URL
    newURL += value['image_field']
    value['image_field'] = newURL 
```

对斜线要格外小心....您不想最终将两个放在一起// ...这取决于您的 MEDIA_URL 末尾是否有一个。

# python - 如何将解码的数据包数据和标头输出组合到单个变量/字典中以进行字符串搜索

> ID：12162563
> 
> 赞同：0
> 
> 时间：2012-08-28T15:26:23.150
> 
> 标签：python, variables, packet

我有点像 Python 新手，但我已经开始了一个小型个人项目来自学更多知识。基本上，我正在使用套接字和 impacket 编写一个数据包嗅探器。但是，我遇到的一个特殊点是：将标头和数据包的输出组合到一个变量中（我在想一本字典，但它不喜欢那样...），这样我就可以简单地搜索一个特定的部分源 IP（即前两个八位字节）的 IP 标头。或者会有更有效的方法来处理这个问题吗？任何帮助表示赞赏。:-)

编辑：当我尝试字典时，我正在做

```
ip_dict = { header: packet } 
```

但是，我得到的输出类似于：

```
{<impacket.ImpactPacket.IP instance at 0x02563440>: <impacket.ImpactPacket.Data instance at 0x02563530>} 
```

与所述IP头和数据的实际输出相反。

```
HOST = socket.gethostbyname(socket.gethostname())

s = socket.socket(socket.AF_INET, socket.SOCK_RAW, socket.IPPROTO_IP)
s.bind((HOST, 0))

while True:

    # Include IP headers
    s.setsockopt(socket.IPPROTO_IP, socket.IP_HDRINCL, 1)

    # receive all packages
    s.ioctl(socket.SIO_RCVALL, socket.RCVALL_ON)

    # receive a packet
    packet = s.recvfrom(42028)[0]

    # look at IP info
    h_decode = ImpactDecoder.IPDecoder()
    header = h_decode.decode(packet)

    # disabled promiscuous mode
    s.ioctl(socket.SIO_RCVALL, socket.RCVALL_OFF)

    decoder = ImpactDecoder.DataDecoder()
    packet = decoder.decode(packet)

    print header
    print packet

    time.sleep(1) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:58:37.237

字典是一组键/值对。当你使用

```
ip_dict = { header: packet } 
```

您告诉它构建一个字典，其中标头实例作为键，数据包实例作为值，它就是这样做的：

```
{<impacket.ImpactPacket.IP instance at 0x02563440>: <impacket.ImpactPacket.Data instance at 0x02563530>} 
```

如果你想从这些实例中获取一些东西，你必须自己提取它。例如，虽然我以前从未使用过该`impacket`库，但这些对象似乎有很多方法存在于其中。例如【压制实数和数据，用废话代替】：

```
In [25]: z
Out[25]: <impacket.ImpactPacket.IP instance at 0xb6151fac>

In [26]: z.[here I hit TAB in the IPython interpreter]
z.add_option              z.get_ip_offmask          z.set_bytes_from_string
z.auto_checksum           z.get_ip_p                z.set_checksum_from_data
z.calculate_checksum      z.get_ip_rf               z.set_ip_address
z.child                   z.get_ip_src              z.set_ip_df
z.compute_checksum        z.get_ip_sum              z.set_ip_dst
z.contains                z.get_ip_tos              z.set_ip_hl
z.ethertype               z.get_ip_ttl              z.set_ip_id
z.fragment_by_list        z.get_ip_v                z.set_ip_len
z.fragment_by_size        z.get_long                z.set_ip_mf
z.get_buffer_as_string    z.get_packet              z.set_ip_off
z.get_byte                z.get_pseudo_header       z.set_ip_offmask
z.get_bytes               z.get_size                z.set_ip_p
z.get_data_as_string      z.get_word                z.set_ip_rf
z.get_header_size         z.is_BSD                  z.set_ip_src
z.get_ip_address          z.list_as_hex             z.set_ip_sum
z.get_ip_df               z.load_header             z.set_ip_tos
z.get_ip_dst              z.normalize_checksum      z.set_ip_ttl
z.get_ip_hl               z.packet_printable        z.set_ip_v
z.get_ip_id               z.parent                  z.set_long
z.get_ip_len              z.protocol                z.set_parent
z.get_ip_mf               z.set_byte                z.set_word
z.get_ip_off              z.set_bytes               

In [26]: z.get_ip_src()
Out[26]: '1.2.3.4' # fake

In [27]: z.get_ip_dst()
Out[27]: '5.6.7.8' # fake

In [29]: z.get_data_as_string()
Out[29]: '\x00abcde' # fake 
```

我不知道其中一半的方法是做什么的，或者其中哪些很重要，但是您可以轻松地根据自己的喜好构建字典：

```
In [31]: {(z.get_ip_src(), z.get_ip_dst()): z.get_bytes()}
Out[31]: 
{('1.2.3.4',
  '5.6.7.8'): array('B', [1,2,3,4,5,6,7,8])} # fake 
```

或组合来自 IPDecoder 和 DataDecoder 的位，无论如何。关键是问题不在于 Python 字典，而在于`impacket`库的数据结构，以及您想从中提取什么信息。文档可能会描述如何获得您需要的东西。

# javascript - 如何在不裁剪的情况下正确调整画布大小.. 特定脚本

> ID：12162565
> 
> 赞同：1
> 
> 时间：2012-08-28T15:26:29.383
> 
> 标签：javascript, html, canvas, clipping

我正在使用这个很棒的脚本来剪辑 jpeg。

```
var polyClip = new function () {
    function s(b, c) {
        q[b] = new Image;
        var e = q[b];
        $(c).attr("data-polyclip-index", b);
        $(e).bind("load", function () {
            d.drawShape(b, c)
        });
        e.src = c.src
    }
    var d = this,
        r, k = [],
        q = [];
    d.isOldIE = window.G_vmlCanvasManager;
    d.init = function () {
        r = $("img[data-polyclip]");
        r.each(s)
    };
    d.drawShape = function (b, c) {
        var e = $(c),
            a = document.createElement("canvas");
        a.width = c.offsetWidth;
        a.height = c.offsetHeight;
        a.id = "polyClip" + b;
        var l = jQuery.trim(e.attr("data-polyclip")).split(","),
            j = c.src;
        k[a.id] = [];
        e.replaceWith(a);
        d.isOldIE && G_vmlCanvasManager.initElement(a);
        for (var f = a.getContext("2d"), e = 0; e < l.length; e += 2) {
            var h = parseInt(jQuery.trim(l[e])),
                i = parseInt(jQuery.trim(l[e + 1]));
            k[a.id].push({
                x: h,
                y: i
            });
            e == 0 ? f.moveTo(h, i) : f.lineTo(h, i)
        }
        if (d.isOldIE) f.fillStyle = "", f.fill(), a = $("fill", a).get(0), a.color = "", a.src = c.src, a.type = "tile", a.alignShape = false;
        else {
            var g = new Image;
            g.onload = function () {
                var a = f.createPattern(g, "repeat");
                f.fillStyle = a;
                f.fill();
                a: {
                    for (var b = parseInt(jQuery.trim(l[0])), c = parseInt(jQuery.trim(l[1])), e = -1; e <= 1; e++) for (var d = 0; d <= 1; d++) if (a = f.getImageData(b + e, c + d, 1, 1).data[3], a != 0) {
                        a = true;
                        break a
                    }
                    a = false
                }
                a || g.src.indexOf("?chromeError") < 0 && (g.src += "?chromeError")
            };
            g.src = j
        }
    };
    d.findObject = function (b) {
        var c = b.currentTarget;
        if ($(c).hasClass("cropParent")) return $(c);
        for (var e in k) if (k.hasOwnProperty(e) && (c = $("#" + e), d.isInPolygon(c, b.pageX, b.pageY, true))) return c
    };
    d.isInPolygon = function (b, c, e, a) {
        var d = b.get(0),
            d = k[d.id],
            j = d.length,
            f, h, i, g, o, m, p = false,
            n = {
                left: 0,
                top: 0
            };
        a && (n = b.offset());
        if (j < 3) return false;
        f = d[j - 1].x + n.left;
        h = d[j - 1].y + n.top;
        for (m = 0; m < j; m++) b = d[m].x + n.left, a = d[m].y + n.top, b > f ? (i = f, o = b, g = h, h = a) : (i = b, o = f, g = a), b < c == c <= f && (e - g) * (o - i) < (h - g) * (c - i) && (p = !p), f = b, h = a;
        return p
    }
};
document.write('<style type="text/css">img[data-polyclip], img.polyClip { visibility: hidden; }</style>');
polyClip.isOldIE ? $(window).bind("load", polyClip.init) : $(document).ready(polyClip.init); 
```

它非常适合我正在做的事情。我在 div 中使用流体宽度，所以所有宽度都是基于百分比的。唯一的问题是，除非它是一个完整的浏览器屏幕，否则它会剪切画布。如果是完整浏览器，则图像渲染良好。当我在完整的浏览器中打开它并调整大小时，效果也很好。我遇到的问题是，当我在调整大小的浏览器或 iPhone 上打开它时，它会剪切图像并将其保持在大约 960 像素，

所以在完整浏览器中它看起来像这样：

XX-----全图----xx

从完整浏览器调整大小仍然看起来不错：

xx-调整大小的图像--xx

从较小的屏幕屏幕加载

xx-----全图

任何帮助，将不胜感激。还要记住，整个设计旨在保持流畅，到目前为止，除了这个小障碍外，它一直在工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:45:19.503

如果我理解得很好，你有图像

[![图像1](../Images/8ef0dabb85ad56942b992d4261216ab3.png)](https://i.stack.imgur.com/kYGRd.jpg)
[（来源：[salestemplate.com](http://www.salestemplate.com/wp-content/uploads/2012/08/toptrim.jpg)）]

（白色部分为白色）。

你想转换成

![在此处输入图像描述](../Images/c0c72bb34f21e7d73274772fd5197abb.png)

（白色部分是透明的）。

然后，一旦你有了透明的，你就可以得到 base64 编码的图像：

[http://jsfiddle.net/fAUbp/show/](http://jsfiddle.net/fAUbp/show/)

```
data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA78AAADkCAYAAABQQZMzAAAgAElEQVR4nOy955Mk252el/bkSZ9ZWd679r572kxPj+3x3pvr5nqDC1wAC3OxIBZYYBfcpSjFUhRD1JIRCumLDMVgKPQPPvqQVTXVM5XV9/YsCCnID0+8VWlPZeXJ... 
```

（为简洁起见省略其余部分）

然后，将其粘贴到浏览器的 URL 栏中，将其下载到您的计算机并将图像上传到您的服务器。

最后，使用新的透明 .png 图像而不是第一个 .jpg。

这样，您不必在每次用户访问您的网站时都生成透明的，而只需生成一次。

# c# - 打包“visual studio c# windows application”项目，然后在客户端设置，无需安装网络框架

> ID：12162567
> 
> 赞同：-6
> 
> 时间：2012-08-28T15:26:35.223
> 
> 标签：c#

我使用 Visual Studio 2008 c# windows form 应用程序完成了我的项目的编程，并使用 Visual Studio 2008 的插件（设置向导）创建了设置项目。但是当我在使用此插件打包后安装我的程序时，出现错误消息屏幕：“此安装要安装.Netframework 3.5”我想要什么..？我想打包我的项目以安装在客户端计算机上，而无需安装 .Netframework liprary。无论如何我如何使用任何程序来做到这一点......请给我明确的步骤

我的意思不是：我从不想安装 .Netframework 3.5 但我想知道如何总结与我的项目一起使用的 liprary 然后将这个 liprary 包含在我的项目包中，因为我想缩小我的安装文件大小。

对不起，因为我的问题不是故意的。

谢谢你们..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:49:18.420

随着最近 vNext 的出现，这种担忧开始逐渐消失。

[.NET CORE 5](http://blogs.msdn.com/b/cesardelatorre/archive/2014/11/18/what-is-net-core-5-and-asp-net-5-within-net-2015-preview.aspx)在跨操作系统和架构线的可部署应用程序方面弥合了差距。 [Scott Guthrie](http://weblogs.asp.net/scottgu/introducing-asp-net-5)强调了一个事实，因为依赖项是与应用程序一起部署的：

> 您可以使用您的应用程序部署 .NET Core 运行时，这意味着您的应用程序将使用此已部署的运行时版本而不是安装在主机操作系统上的运行时版本运行。

虽然截至 2015 年 5 月，这尚未影响桌面应用程序，但这是向前迈出的一大步，并且最终也可能会延续到桌面应用程序。

* * *

虽然这无助于您当前的困境，但如果您想为目标受众保持免费的框架，请考虑为您的下一个软件创建一个 Web 项目。虽然您需要一个 IIS 服务器来托管应用程序（有很多公司这样做），但您的查看器只需要一个浏览器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T15:28:28.180

如果要在客户端计算机上执行 .Net 程序，则自动需要安装 .Net Framework。

您可以做的是使用[clickOnce](http://msdn.microsoft.com/en-us/library/ee942965.aspx#clickonce)让客户端计算机为您自动下载和安装 .Net Framework。

# ruby-on-rails - Rails：属于其他两个模型的新条目

> ID：12162570
> 
> 赞同：0
> 
> 时间：2012-08-28T15:26:49.687
> 
> 标签：ruby-on-rails, rails-models, mass-assignment

在我的应用程序中，一个产品有很多意见，由许多客户编写。以下是具有关联的模型：

```
class Product < ActiveRecord::Base
    attr_accessible :name, :desc, :price

    has_many :opinions
end

class Client < ActiveRecord::Base
    attr_accessible :name, :bio

    has_many :opinions
end

class Opinion < ActiveRecord::Base
    attr_accessible :rate, :comment

    belongs_to :client, :product
end 
```

在参数中，我有评估邀请 id，它可以帮助我获取 product_id 和 client_id（所以考虑一下我同时拥有它们）。

该表单仅包含速率（radio_button，从 1 到 5）和评论（text_field）。

**opinion#create 方法如何创建新的意见，它属于两种模型：客户和产品？**

我尝试直接传递 client_id 和 product_id，但出现 MassAssignment 错误：

```
# Remember: I have product_id and client_id
product = Product.find_by_id product_id

opinion = product.opinions.build params[:opinion]
opinion.product_id = product_id
opinion.client_id = client_id

opinion.save 
```

以防万一它有用：在我的应用程序的第一个版本中，意见仅属于产品，使用上面的代码（删除`opinion.client_id = client_id`行）效果很好，这就是我用来`product`构建意见的原因）。所以，这只是一个增强。

任何的想法？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:45:04.553

`product.opinions.build params[:opinion]`将构建一个已经将其 product_id 设置为 product.id 的新意见。它知道这样做是因为协会`belongs_to :product`。但是，它还不知道它属于哪个客户端，因此您必须手动设置它。但是您需要将 attr_accessible :client_id 添加到 Opinion 来执行此操作。

# java - Eclipse 警告未捕获的错误

> ID：12162572
> 
> 赞同：0
> 
> 时间：2012-08-28T15:27:00.367
> 
> 标签：java, eclipse, exception, error-handling, compiler-warnings

当未能捕获 的子类时`Exception`，Eclipse 将发出编译警告（红色）。

但是，当一个子类`Error`未被捕获时，不会发出警告，从而很容易忘记包含该`throws SomethingError`语句。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:51:51.040

这是已检查（不包括 RuntimeException 的 Exception 的子类）和未检查的异常（RuntimeException 或 Error 的子类）之间的区别。

*   关于该主题的Oracle[注释](http://docs.oracle.com/javase/tutorial/essential/exceptions/runtime.html)
*   Stackoverflow：[Java：已检查与未检查的异常解释](https://stackoverflow.com/questions/6115896/java-checked-vs-unchecked-exception-explaination)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T15:57:30.620

这本质上是为了避免必须在您编写的每一行代码中添加异常处理代码。这个问题很好地解释了这一点：[为什么在 Java 中“未检查”运行时异常？](https://stackoverflow.com/questions/1656376/why-are-runtime-exceptions-unchecked-in-java)

# html - “块样式”单选按钮适用于除 iPad 之外的所有设备

> ID：12162576
> 
> 赞同：7
> 
> 时间：2012-08-28T15:27:13.207
> 
> 标签：html, ios, ipad, css

我有一组单选按钮，并对它们进行了样式设置，以便它们显示：块，使它们看起来像按钮（也隐藏了单选按钮本身）。这在台式机和安卓平板电脑上的 Chrome 和 Firefox 中效果很好……但不适用于 iPad。

在这里看到它：http: [//jsfiddle.net/WhNRK/](http://jsfiddle.net/WhNRK/)

无论出于何种原因，块元素在 iPad 上都不是“活动的”，并且没有设置单选按钮。如果我“取消隐藏”单选按钮，您会看到单击块时它没有被选中。但是，如果我单击实际的单选按钮本身，它会正确选择甚至更改块元素的背景颜色！ [http://jsfiddle.net/WhNRK/1/](http://jsfiddle.net/WhNRK/1/)

关于我做错了什么导致这种情况发生的任何想法？似乎它应该是非常简单的功能，所以我希望它只是我忽略的一些简单的东西......

包含此内容的网站的主要用途是用于移动设备，因此绝对需要它在任何 iOS 设备上运行（假设它也可能发生在 iPhone 上，只是现在我这里没有一个可以测试）。

感谢您提出的任何建议！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T16:58:29.030

首先，你的小提琴在 iphone 上也确实不起作用，无论是在 safari 还是 chrome 中。

我很好奇，我试图通过玩一下你的代码来找到解决方案。稍微更改了 html 以使标签成为输入的同级，而不是父级。对我的iphone仍然没有影响。

经过一番谷歌搜索后，我发现了这个：[http](http://forums.macrumors.com/showthread.php?t=785632) ://forums.macrumors.com/showthread.php?t= 785632 我尝试了解决方案，它似乎有效，尽管我不知道为什么。我想这是某种错误...

**您必须添加`onclick=""`到标签中。**

我没有在 iPad 上测试它，但因为它只是一个大 iPhone，它应该可以正常工作。可以在这里找到一个工作示例：http: [//jsfiddle.net/WhNRK/15/](http://jsfiddle.net/WhNRK/15/)

# c# - 绑定到 TabControl SelectedIndex

> ID：12162577
> 
> 赞同：2
> 
> 时间：2012-08-28T15:27:16.840
> 
> 标签：c#, wpf, mvvm

我在页面上有一个选项卡控件；它的项目绑定回我的 ViewModel，它还公开了一个 ActiveTabItemIndex，它绑定（两种方式）到我的 xaml 中的 SelectedIndex 属性，并实现 INotifyPropertyChanged，以便我的 TabControl 知道何时更新。

这是（我理解）MVVM 正确的做事方式，并且 99% 正常工作。

```
class MainWindowViewModel : BaseViewModel, INotifyPropertyChanged
{
    ObservableCollection<TabItemViewModel> _TabItems;
    int _ActiveTabItemIndex;

    public event PropertyChangedEventHandler PropertyChanged;

    protected void RaisePropertyChanged(string name)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
            handler(this, new PropertyChangedEventArgs(name));
    }

    void _TabItems_CollectionChanged(object sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e)
    {
        if (e.Action == System.Collections.Specialized.NotifyCollectionChangedAction.Add)
            _ActiveTabItemIndex = _TabItems.IndexOf((TabItemViewModel)e.NewItems[0]);
        RaisePropertyChanged("ActiveTabItemIndex");
    }

    public ObservableCollection<TabItemViewModel> TabItems
    {
        get
        {
            if (_TabItems == null)
            {
                _TabItems = new ObservableCollection<TabItemViewModel>();
                _TabItems.CollectionChanged += new System.Collections.Specialized.NotifyCollectionChangedEventHandler(_TabItems_CollectionChanged);
            }
            return _TabItems;
        }
    }

    public int ActiveTabItemIndex
    {
        get
        {
            return _ActiveTabItemIndex;
        }
        set
        {
            _ActiveTabItemIndex = value;
        }
    }
} 
```

这样，我对 TabItems 集合所做的任何操作都会反映在 TabControl 上，并且当我添加一个新项目时，它会自动被选中。这是一种享受；但是，当将第一项添加到空选项卡控件时，它看起来像这样：

![显示选项卡内容但未选择选项卡](../Images/6a2f31ffe9755247c14e03aa603d5369.png)

显示选项卡内容，但未选择选项卡。我需要手动单击选项卡以使其看起来正确：

![显示的选项卡内容和选择的选项卡](../Images/350b5b2b88c86746835462d5d4dae6e5.png)

就好像在选项卡的绘制和它们的内容的绘制之间存在某种脱节。我知道绑定正在工作，因为后续选项卡已正确处理，如果我完全删除绑定，则在手动选择选项卡之前第一页不会显示其内容。如果有人看到这一点或可以阐明一些问题，将不胜感激！谢谢你们 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:19:20.063

仅在 setter 中引发您的属性更改事件；您可以将其视为允许属性本身决定“更改”的含义，并通过扩展来控制事件何时触发（并使其按照您的期望进行）：

```
public int ActiveTabItemIndex
{
    get{ return _ActiveTabItemIndex; }
    set
    {
        if(_ActiveTabItemIndex != value)
        {
            _ActiveTabItemIndex = value;
            RaisePropertyChanged("ActiveTabItemIndex");
        }
    }
} 
```

只是改变

```
_ActiveTabItemIndex = _TabItems.IndexOf(...); 
```

到

```
ActiveTabItemIndex = _TabItems.IndexOf(...); 
```

并从 _TabItems_CollectionChanged 中删除 RaisePropertyChanged 调用

有时您需要在属性的设置器之外引发属性更改通知，但那是更复杂的一天:)

顺便说一句，应该在 BaseViewModel 上实现 INotifyPropertyChanged。查看绝对出色的[MVVM Light Toolkit](http://mvvmlight.codeplex.com/) - 它包含您在使用 MVVM 的每个项目中必须复制的所有代码。

# c - C有stackalloc函数吗？

> ID：12162579
> 
> 赞同：11
> 
> 时间：2012-08-28T15:27:20.450
> 
> 标签：c, memory-management, stack

是否有在 C 中实现的 stackalloc 函数，允许您在堆栈上分配可变长度数组，如[C# 中的 stackalloc](http://msdn.microsoft.com/en-us/library/cx9s2sy4%28v=vs.71%29.aspx)？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-28T15:28:05.020

有`alloca`，但不规范。此外，从 C99 开始，有一个称为“可变长度数组”的功能。

```
int n;
scanf("%d", &n);
int v[n]; /* Will fail badly if n is large. */ 
```

**谨慎使用**并使用较小的值 VLA 可能会非常好。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-28T15:28:23.423

`alloca`有点像这样，但你需要非常小心地使用它。

# mono - 带有便携式库项目的 MonoTouch 无法构建

> ID：12162581
> 
> 赞同：5
> 
> 时间：2012-08-28T15:27:27.017
> 
> 标签：mono, xamarin.ios, monodevelop, portable-class-library

在我使用 MonoDevelop (3.0.3.5) 创建的解决方案中，我有 3 个项目：

1.  带有 UI 的 MonoTouch 项目，
2.  带有 iOS 特定代码的 MonoTouch 库项目，
3.  具有域模型的便携式库项目。

Portable Library 项目无法编译，并在 MonoDevelop 中的引用（System、System.Core、System.Xml）上显示警告符号。当我展开程序集引用时，会显示以下错误消息：

`Assembly not available in .NETPortable 4.0 Profile1 Profile (in Mono 2.10.9)`

[此论坛主题](http://monotouch.2284126.n4.nabble.com/cross-platform-library-code-td4656600.html)中报告了相同的问题。

有没有人有同样的问题并且能够解决它？

**更新**

可以在 GitHub 上找到带有构建错误的演示解决方案[(bgever/plp-build-error)](https://github.com/bgever/plp-build-error)。

我发现虽然显示了错误消息，但基本代码可以编译并按预期工作。

但是，阻止演示解决方案编译的两种构建错误变体是：

```
public T Get<T> (Expression<Func<T, bool>> predicate) where T : new() { 
```

> 使用通用类型`System.Func<T1,T2,T3,T4,T5,T6,T7,T8,T9,TResult>' requires`10' 类型参数 (CS0305)

*所以似乎`Func<T, TResult>`不支持 2 参数泛型重载？*

```
public void RunInTransaction (Action action) { 
```

> 使用泛型类型`System.Action<T>' requires`1' 类型参数 (CS0305)

*所以似乎`Action`找不到非泛型版本？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T11:14:12.630

通过附加错误消息，我发现了以下 SO 问题：[MonoDevelop：是否可以切换 PCL 的编译器？](https://stackoverflow.com/questions/12041290/monodevelop-is-it-possible-to-switch-pcls-compiler)通过@mhutch 提供的答案，可以强制执行 MonoTouch 编译器，然后能够编译代码。

然而，这只是一种解决方法，因此，在 Mono、MonoDevelop 和 MonoTouch 中看到适当的可移植类库支持仍然会很棒。

**如果您还需要适当的可移植类库支持：[在 Xamarin 的 UserVoice 上投票支持此功能](http://xamarin.uservoice.com/forums/149713-monotouch-suggestions/suggestions/2920846-net-portable-class-library)。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T22:34:27.143

我对 PLP 中的 .Net 引用也有类似的问题，我实际上所做的是删除现有引用并从安装 .Net Framework 的位置手动添加它们，重新启动 MonoDevelop，然后我又启动并运行了.

# git - 修复合并冲突？

> ID：12162582
> 
> 赞同：0
> 
> 时间：2012-08-28T15:27:34.523
> 
> 标签：git, merge, git-merge

我有两个远程分支，“葡萄”和“主人”。我目前在“葡萄”上。

现在我切换到“大师”：

```
git checkout master 
```

现在我想将所有更改从“葡萄”拉到“主人” - 这是这样做的方法吗？：

```
git merge origin grape 
```

我的理解是 git 会将远程分支“葡萄”的所有当前状态拉到我的本地“主”副本中。它将尝试为我自动合并。如果存在冲突，则冲突的文件将实际注入一些冲突文本到文件中。然后我必须进入这些文件，并删除我不想要的块（基本上告诉 git 如何合并这些文件）。

对于每个有冲突的文件，我是否要再次添加并提交更改？：

```
git add problemfile1.txt
git commit -m "Fixed merge conflict."

git add problemfile2.txt
git commit -m "Fixed another merge conflict."

... 
```

在我修复了上述所有合并冲突之后，我是否只需再次推送到“master”以完成该过程？：

```
git push origin master 
```

或者当我们进入这种冲突状态时，我们还需要做些什么吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:32:45.247

在我看来，您应该*首先手动解决文件中的所有合并冲突*，然后您可以提交并推送到 master，它会起作用。

如果你按照你说的那样做，你的提交历史将充满垃圾提交，如果你和朋友一起做任何项目，那真的很烦人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:36:14.387

`origin`引用另一个服务器上的另一个存储库；通常，它指的是您从中提取 repo 的 github 服务器。如果你想合并葡萄和主分支，那么你需要`git merge grape`解决任何冲突，然后你可以将更新推送到服务器。

您可以通过查看和编辑它说存在冲突的文件来解决合并问题，使其成为您希望它们结束的方式，将它们添加到索引中，然后提交。

# bash - 如何使用 netcat 判断数据包来自哪个主机？

> ID：12162583
> 
> 赞同：2
> 
> 时间：2012-08-28T15:27:38.197
> 
> 标签：bash, udp, netcat

我正在尝试使用 netcat 和 bash 编写服务器。接收异步数据包，我使用命令 `netcat -lu 6791`

如何判断数据包来自哪个主机？有没有更好的工具我应该使用然后 netcat（socat 也许？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:44:26.440

`wireshark`（GUI 工具）、`tshark`（基于文本的版本`wireshark`）和/或`tcpdump`（`tshark`与

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T14:45:44.587

@twalberg 的建议， `netcat -vv -lu -p 6791`奏效了。

# c++ - 输出函数调用到日志文件

> ID：12162587
> 
> 赞同：2
> 
> 时间：2012-08-28T15:27:45.513
> 
> 标签：c++, gdb, stack-trace

我有一些多年未维护的遗留 C++ 代码。我正在尝试了解它目前的功能。它需要 .xml 输入并且应该输出一个输出文本文件。处理两个不同的 .xml 输入文件所花费的时间大不相同，其中一个运行正常，另一个则不正常。不过，它们的开头是一样的。我想输出当我使用两个不同的输入执行代码时所做的函数调用的日志文件，并将这些日志相互比较以查看它们开始分歧的位置。我不能只在 main() 的第一行中断代码，然后逐步完成 gdb 中的控制流。时间太长了 理想情况下，我想找到一种方法来做类似的事情

`gdb --args old_exec inp1.xml -step >log1.txt
gdb --args old_exec inp2.xml -step >log2.txt
diff log1.txt log2.txt`

当然，“-step”标志不是真实的，但也许有某种方式告诉它记录所有步骤确实存在。有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T15:40:35.757

GCC 编译器有一个标志，`-finstrument-functions`，它使你的函数在进入和退出时调用特定的函数；您可以使用它来跟踪您的代码流。使用此标志后，您将需要提供以下功能：

```
void __cyg_profile_func_enter (void *this_fn, void *call_site);
void __cyg_profile_func_exit  (void *this_fn, void *call_site); 
```

*并且请记住，当您编译这些函数时，它们不能使用 intrumentation 标志编译！*

您可以使用 addr2line 将指针转换为文件/函数/行号。通常最好在运行时记录原始指针，并执行事后地址转换。

有关更多详细信息，请参阅[http://balau82.wordpress.com/2010/10/06/trace-and-profile-function-calls-with-gcc/](http://balau82.wordpress.com/2010/10/06/trace-and-profile-function-calls-with-gcc/)。

# javascript - Rally API 2.0 模型与模型

> ID：12162604
> 
> 赞同：1
> 
> 时间：2012-08-28T15:28:46.160
> 
> 标签：javascript, rally

我创建了一个自定义看板。在板子里，我在卡片上有一个按钮，供人们在对项目进行代码审查时声明。单击按钮后，我想检查实时数据以确保自屏幕加载以来没有其他人声称。

如果它是一个故事，我有所有的工作，但如果它是一个缺陷，我有一个问题。所以在查看代码时，我注意到我做了 a`Rally.data.ModelFactory.getModel`然后 a `model.load`。

所以我认为这应该更改为`.getModels`并更改类型以合并故事和缺陷。但是，当我这样做时，如何正确地将其纳入搜索。我被如何加载和检查卡住了。

代码片段是：

```
if (this.getRecord().get("StoryStatus") == "Review Ready") {
                    if (this.getRecord().get("CodeReviewedBy") == '') {
                        content.add([{ xtype: 'button',
                            text: 'I will review',
                            scale: 'small',
                            listeners: {
                                click: function (btn, e, eOpts) {
                                    // Verify nobody has claimed it yet !
                                    var mod = Rally.data.ModelFactory.getModels({
                                        types: ['HierarchicalRequirement', 'Defect'],
                                        success: function (models) {
                                            var model;
                                            debugger;
                                            if (models.Defect) model = models.Defect
                                            else model = models.HierarchicalRequirement;

                                            model.load(eOpts.scope.record.internalId, {
                                                fetch: ['CodeReviewedBy'],
                                                success: function (currentRecord) {
                                                    var currentCRB = currentRecord.get("CodeReviewedBy");
                                                    if (currentCRB) {
                                                        window.alert('While you were sitting around doing nothing, ' + currentCRB + ' already started reviewing this code');
                                                    } else {
                                                        var con = Rally.environment.getContext();
                                                        currentRecord.set("CodeReviewedBy", con.context.user._refObjectName);
                                                        currentRecord.save();
                                                        location.reload(true);
                                                        //eOpts.scope.refresh();
                                                    }

                                                }
                                            });
                                        }
                                    });
                                    this.refresh()
                                },
                                scope: this
                            }
                        }]);
                    } else {
                        content.add([{ xtype: 'label',
                            html: '<b>Being reviewed by: </b>' + this.getRecord().get("CodeReviewedBy") + '<br>'
                        }]);
                    }
                } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T16:56:49.077

一旦你有了记录，你就可以实际使用 self 属性来获取模型——这将使你不必再次使用 ModelFactory.getModels。

```
var model = this.getRecord().self;
model.load(this.getRecord().get('ObjectID'), {
    //fetch, success, etc...
}); 
```

# actionscript-3 - 如何克隆字典（及其内容）？

> ID：12162607
> 
> 赞同：3
> 
> 时间：2012-08-28T15:28:46.943
> 
> 标签：actionscript-3, dictionary, clone

我用谷歌搜索了一些时间来找到一种克隆 dic 的方法，我找到了一些选项，但它们没有用。一个是使用 byteArray，它仅在您注册所有涉及的类并且您的类的所有构造函数参数都具有默认值 <- 在我的情况下不是一个选择时才有效。

Ohter 是一个副本，但仅适用于第一个值，这个：

```
private function clone(original:Dictionary):Dictionary {
    var cloned:Dictionary = new Dictionary();
    for(var key:Object in original) {
        cloned[key] = original[key];
    }
    return cloned;
} 
```

但是，它不会在主字典中克隆字典。

你知道如何对给定的字典进行完美的克隆，即使它里面有另一个字典吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:39:47.897

制作一个检查元素类型的递归函数，如果它们是字典本身，则继续递归和复制。

类似（未经测试）：

```
private function clone(original:Dictionary):Dictionary {
    var cloned:Dictionary = new Dictionary();
    for(var key:Object in original) {
      if( original[key]  is Dictionary)
         cloned[key] = clone(original[key]);
      else
         cloned[key] = original[key];
    }
    return cloned;
} 
```

编辑 ：

似乎适用于这样的简单嵌套字典：

```
var dic:Dictionary = new Dictionary();
dic["test"] = 5;
dic["otherDic"] = new Dictionary();
dic["otherDic"]["foo"] = 1;
dic["otherDic"]["bar"] = "bar";

var copy:Dictionary = clone(dic);

dic["test"] = 0;
dic["otherDic"]["foo"] = 0;
dic["otherDic"]["bar"] = "changed";
    //copy doesn't change, copy and dic are different dictionaries 
```

# symfony - Symfony2 中的通用评论系统

> ID：12162609
> 
> 赞同：2
> 
> 时间：2012-08-28T15:28:48.893
> 
> 标签：symfony, doctrine, symfony-2.1

我的 Symfony 2.1 RC 应用程序中有一个简单的`Comment`模型（使用 Doctrine 2）。每个评论都有一个`user`和一个`message`。

目前，`CommentBundle`管理文章的评论。我希望它更通用，能够评论任何类型的实体，而无需跨专门用于评论的不同包复制代码......

为此，我还需要一种方法来引用评论中的任何实体。我认为有两个领域`entity_type`，`entity_id`可以是一个很好的解决方案。`entity_type`但是，如果不手动映射到类并使用该`find`方法，我无法从中获取对象。

那么如何从评论中引用实体呢？以及如何创建适用于多个实体的通用行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T16:23:16.313

您可以创建一个名为的抽象基类实体`Commentable`并创建继承的实体，`Commentable`例如`Document`或`Post`。

由于`Document`和`Post`派生自，您可以分别在实体和`Commentable`之间创建一对多关系。`Commentable``Comment`

确保在您的基类 ORM 注释中包含继承：

```
@InheritanceType
@DiscriminatorColumn
@DiscriminatorMap 
```

示例可以在[Doctrine Project Inheritance Documentation中找到](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/inheritance-mapping.html)

# c# - 仅将对象转换为 JSON 字符串 序列化字段

> ID：12162612
> 
> 赞同：4
> 
> 时间：2012-08-28T15:29:01.127
> 
> 标签：c#, json, serialization

```
JavaScriptSerializer serializer = new JavaScriptSerializer();
string sJSON =  serializer.Serialize(pt); 
```

这工作正常，除了它还包括设置为的字段`[NonSerialized]` 有没有办法排除这些字段？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T15:31:57.220

`[ScriptIgnore()]`是你想要的

该`[NonSerialized()]`标记仅适用于二进制序列化，您的示例是 Java 脚本序列化之一

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T15:32:05.713

我认为您正在寻找[`ScriptIgnoreAttribute`](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.scriptignoreattribute.aspx)：

```
public class Data {

    [ScriptIgnore]
    public string Ignore;

    public string DoNotIgnore;
} 
```

# testng - 为 webdriver 并行运行 testng 方法

> ID：12162613
> 
> 赞同：0
> 
> 时间：2012-08-28T15:29:09.303
> 
> 标签：testng

该脚本具有方法=并行。但它在任何给定时间只执行一种方法，并为另一种方法提供错误。

测试脚本：

```
<suite name="test suite" verbose="1" parallel="methods" thread-count="3">

<test name="test on FF">
<parameter name="platform" value="local" />
<parameter name="browser" value="firefox" />
<parameter name="version" value="13" />
<parameter name="login" value="test" />
<classes>
  <class name="com.auto.tests.TitlesTests" >
    <methods>
        <include name="testCreateNewTitle" />
        <exclude name="testCreateNewTitlesFolder" />
        <include name="testCreateNewTitlesUsingAuto" />
    </methods>
  </class>
  </classes> 
```

BeforeClass、BeforeMethod、BeforeSuite 在一个脚本中，@Test selenium webdriver 测试在另一个脚本中。

```
Class A

@BeforeSuite
public void beforeSuite() throws Exception {
    log.info("BeforeSuite");
}

    @BeforeTest
public void beforeTest() throws Exception{

        setupBrowser("Default test");
    }
}

    @BeforeClass
public void beforeClass() throws Exception {
    if(loginMethod.equalsIgnoreCase("class")){
        setupBrowser(this.getClass().getSimpleName());
    }
}

    @BeforeMethod
public void beforeMethod(Method method) throws Exception {
    log.info("BeforeMethod");
    if(loginMethod.equalsIgnoreCase("method")){
        setupBrowser(method.getName());
    }
}

class B extends A {

 @Test
public void testCreateNewtitle(){
                log.info("Create new title test case1 starts");
        log.info("Create folder1 worked");
        }

@Test
public void testCreateNewTitlesUsingAuto(){
                log.info("Create new title test case2 starts");
        log.info("Create folder2 worked");
        } 
```

}

```
testng output
[main] 0      INFO  - BeforeSuite
[main] 14     INFO  - BeforeTest
[main] 16562  INFO  - Browser = firefox, Version = 13, Platform = local
[main] 22953  INFO  - Authenticated. HTTP/1.1 302 Moved Temporarily
[main] 22954  INFO  - 
[pool-1-thread-1] 31981  INFO  - BeforeClass
[pool-1-thread-2] 31988  INFO  - BeforeMethod
[pool-1-thread-1] 31988  INFO  - BeforeMethod
[pool-1-thread-1] 32005  INFO  - Create new title test case1 starts
[pool-1-thread-2] 32011  INFO  - Create new title test case2 starts
[pool-1-thread-2] 32079  ERROR - 
[pool-1-thread-2] 32090  INFO  - AfterMethod
[pool-1-thread-1] 32091  INFO  - Create folder1  worked
[pool-1-thread-1] 59100  INFO  - AfterMethod
[pool-1-thread-1] 59101  INFO  - AfterClass
[main] 59103  INFO  - AfterTest
[main] 59778  INFO  - AfterSuite

java.lang.AssertionError: null
at org.testng.Assert.fail(Assert.java:89)
at org.testng.Assert.fail(Assert.java:96)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
at java.lang.reflect.Method.invoke(Unknown Source)
at               org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:80)
at org.testng.internal.Invoker.invokeMethod(Invoker.java:715)
at org.testng.internal.Invoker.invokeTestMethod(Invoker.java:907)
at org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1237)
at org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:127)
at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:111)
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
at java.lang.Thread.run(Unknown Source) 
```

谢谢

# android - 使用 AsyncTask 创建数据库时的 Android ProgressDialog

> ID：12162614
> 
> 赞同：0
> 
> 时间：2012-08-28T15:29:08.857
> 
> 标签：android, database, android-asynctask, progressdialog

`ProgressDialog`创建my 时显示的`database`内容。这仅显示一次。

我的活动中有这段代码：

```
 baseDados.open();
    ListView listContent = (ListView)findViewById(android.R.id.list);
    Cursor query = baseDados.getData(1,0,null);
    MyAdapt cursorAdapter = new MyAdapt(this, query,0);
    listContent.setAdapter(cursorAdapter); 
```

在第一次运行时，创建并填充数据库，查询结果显示在`listview`. 上面的代码可以再次使用，但这一次，数据库没有创建，因为它已经创建了。

在互联网上，我看到实现的最佳方法是使用`AsyncTaks`，但如果我使用`AsyncTaks`.

我创建了一个类来处理我的数据库，并在那里创建了我的`AsyncTaks`.

这是我所做的：

```
public class Database {

    private DbHelper DBHelper;
    private final Context Context;
    private SQLiteDatabase BaseDados;
    static Context ctx;

    private static class DbHelper extends SQLiteOpenHelper {

        public DbHelper(Context context) {
            super(context, BD_NAME, null, BD_VERSION);
            ctx = context;
        }

        @Override
        public void onCreate(SQLiteDatabase db) {
            new loadDB().execute(db);
        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVesion) {
            // Drop table if table exists
            (....)
            // creates new tables and data
            onCreate(db);
        }

        public class loadDB extends AsyncTask<SQLiteDatabase, Void, Integer> {
            ProgressDialog progresso;

            @Override
            protected void onPreExecute() {
                // TODO Auto-generated method stub
                super.onPreExecute();
                progresso = ProgressDialog.show(ctx, "INFO", "Instaling for the first time") );

            }
            @Override
            protected Integer doInBackground(SQLiteDatabase... params) {

                SQLiteDatabase db = params[0];
            // Code to create the tables and populate them
            // Lots of code like below
                db.execSQL("SQL statement goes here");      
                return 1;
            }

            @Override
            protected void onPostExecute(Integer result) {
            // Dismiss the ProgressDialog
                progresso.dismiss();
                super.onPostExecute(result);
            }
        }

    }

    public Database(Context c) {
        Context = c;
    }

    public Database open() throws SQLException {
        DBHelper = new DbHelper(Context);
        BaseDados = DBHelper.getWritableDatabase();
        return this;
    }

    public void close() {
        DBHelper.close();
    }

    public Cursor getData(int tipo, long groupId, String query[]) {
    // querys performed on the database
}
    } 
```

我有两个问题。

**问题 1**

ProgressDialog 从未显示，尽管创建和填充我的数据库需要将近五秒钟

**问题 2**

在某些时候，应用程序崩溃并且数据库没有正确创建，因为查询给出错误`no such table` 创建填充数据库的代码是可以的，因为如果在方法中

```
@Override
public void onCreate(SQLiteDatabase db) {
    new loadDB().execute(db);
} 
```

我删除`new loadDB().execute(db);`并放了这个：

```
@Override
public void onCreate(SQLiteDatabase db) {
    // SQL code that was on `doInBackground(SQLiteDatabase... params)`
} 
```

你能告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:50:44.563

您不能使用 AsyncTask 在构造函数中初始化数据库，尤其是因为在调用构造函数后立即调用

```
 BaseDados = DBHelper.getWritableDatabase(); 
```

AsyncTask 不会运行，因此不会创建您的数据库，但您正在尝试获取可写数据库。更好的设计是让所有与数据库相关的东西都同步，然后在一个 Asynctask 中使用所有 db 相关的方法。

我也认为像你所做的那样混合 UI 和 db 操作是不好的。你将不得不重新设计整个事情

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T16:09:56.560

您可能根本不需要显示进度对话框：

1.  如果您的数据库创建时间足够短（大多数情况下），您可以同步进行。
2.  如果没有，您可以嵌入一个预先存在的数据库并复制它。它更快，并且在文件副本上放置一个进度对话框非常简单。请参阅此示例以了解如何将数据库嵌入您的 apk 中：

[http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/](http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/)

# c++ - 这段代码是否调用了一个不存在的构造函数？

> ID：12162617
> 
> 赞同：-1
> 
> 时间：2012-08-28T15:29:16.370
> 
> 标签：c++

也许这是一个基本的误解，但以下行让我感到困惑：

```
return *static_cast<MockBehavior*>(COMPOSITE::m_Children[index]); 
```

这条线到底在做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T15:33:02.330

您的标题和问题文本似乎不一致，但该行采用由标记的指针`COMPOSITE::m_Children[index]`（其中 COMPOSITE 应该是某种命名空间或类），将指针类型强制转换为`MockBehavior*`，然后取消引用，产生一个引用`MockBehavior`对象。然后这可能是按值返回的（同样，问题缺少重要的所需上下文），导致调用问题中未显示的某些对象类型的复制构造函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:34:45.287

它正在访问`COMPOSITE::m_Children[index]`，无论是什么。希望是指向某些东西的指针数组。

然后它尝试将该指针转换为指向`MockBehavior`. 最后，它取消引用该指针，并返回结果。

如果包含 this 的函数按值返回，那将涉及`MockBehavior`.

# magento - 如何允许新的管理员用户仅访问特定类别？

> ID：12162622
> 
> 赞同：0
> 
> 时间：2012-08-28T15:29:37.893
> 
> 标签：magento, magento-1.6

> **可能重复：**
> [如何限制用户访问magento中的特定类别？](https://stackoverflow.com/questions/12161706/how-to-restrict-user-to-access-a-particular-category-in-magento)

我想创建一个新的管理员用户，该用户只允许访问所有类别中的特定类别。

我怎样才能做到这一点？

我应该在数据库中更改还是从管理面板更改。

谢谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:53:32.750

试试这个模块：

[http://www.magentocommerce.com/magento-connect/advanced-permissions.html](http://www.magentocommerce.com/magento-connect/advanced-permissions.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T16:32:23.407

转到管理面板，因此您访问系统（菜单）>权限>角色，单击管理员并转到屏幕左侧的角色资源。将组合框设置为自定义。现在您可以选中/取消选中您想要拒绝访问的内容...

# python - 在 Python2.x 中使用 print()（函数版本）

> ID：12162629
> 
> 赞同：56
> 
> 时间：2012-08-28T15:30:09.007
> 
> 标签：python, printing, python-2.x, function-call

我了解语句和表达式之间的区别，并且我了解 Python3 将 print() 变成了函数。

然而，我在各种 Python2.x 解释器上运行了一个用括号括起来的 print() 语句，它运行完美，我什至不必导入任何模块。

我的问题：以下代码是`print("Hello SO!")`作为 Python2.x 中的语句还是表达式进行评估的？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2012-08-28T15:37:19.117

考虑以下表达式：

```
a = ("Hello SO!")
a = "Hello SO!" 
```

它们是等价的。同理，用一个语句：

```
statement_keyword("foo")
statement_keyword "foo" 
```

也是等价的。

请注意，如果您将打印功能更改为：

```
print("Hello","SO!") 
```

你会注意到 python 2 和 python 3 之间的区别。在 python 2 中，`(...,...)`由于 print 是一个语句，所以它被解释为一个元组，而在 python 3 中，它是一个带有多个参数的函数调用。

因此，要回答手头的问题，除非您（在 python 2.6 中引入），`print`否则在 python 2.x 中将其评估为语句`from __future__ import print_function`

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-08-28T15:38:37.337

`print("Hello SO!")`被评估为语句`print ("Hello SO!")`，其中语句的参数`print`是表达式`("Hello SO!")`。

如果您要打印多个值，这可能会有所不同；例如`print("Hello", "world")`将打印 2 元素元组`('Hello', 'world')`而不是两个字符串`"Hello"`和`"world"`.

为了与 Python 3 兼容，请使用`from __future__ import print_function`：

```
>>> print("Hello", "world")
('Hello', 'world')
>>> from __future__ import print_function
>>> print("Hello", "world")
Hello world 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-28T15:32:21.720

它仍然被评估为一个语句，您只是在打印`("Hello SO!")`，它只是评估为，`"Hello SO!"`因为它不是一个元组（如 delnan 所述）。

# spring - Spring 并行处理

> ID：12162631
> 
> 赞同：0
> 
> 时间：2012-08-28T15:30:21.207
> 
> 标签：spring, parallel-processing

我有一个要求，其中一个流程同步工作（请求-响应），而在同一个应用程序中，另一组流程轮询外部源以更改信息。有人可以告诉我如何使用spring进行配置。我发现 Spring Batch、Camel、Spring Integration 可能满足我的需求，想知道它们是否有帮助，或者是否有其他更简单或更好的解决方案？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:13:15.147

让我们分解一下您要执行的操作：

您想要一个基于 spring 的简单应用程序，它可以执行多项任务（我不会使用 word parallel，因为我认为这不是您的要求 - 但如果您认为需要，请详细说明）

*   您可以使用 Spring Web/REST 在请求-响应模型中公开您需要的服务
*   对于从外部源轮询某些事件 - 根据您的外部源是什么，spring 提供了丰富的适配器集，您可以使用它们来轮询事件。例如，如果它是一个文件系统，您期望一些文件到达，那么您将配置一个文件适配器和轮询器。
*   Spring 集成专门针对集成多个系统并提供丰富的适配器集——纯粹基于需求。
*   Spring Batch 适用于您计划频繁运行并进行大量数据移动或更改的任务/作业，并且您希望基础设施代码开箱即用！

# python - 在哪里定义 Flask 中 url_for() 使用的域？

> ID：12162634
> 
> 赞同：79
> 
> 时间：2012-08-28T15:30:28.517
> 
> 标签：python, flask, url-for

当我调用`url_for('index')`它时，它会生成`'/'`，但有时我希望它生成`'domain.tld/'`。我在文档中找不到我要指定的地方。我只需要做`'domain.tld/%s' % url_for('index')`吗？

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2012-08-28T15:35:51.200

[`url_for`](http://flask.pocoo.org/docs/api/#flask.url_for)接受一个`_external`关键字参数，该参数将返回一个绝对（而不是相对）URL。我相信您需要为`SERVER_NAME`您的根域设置一个配置密钥以使其正常工作。

# c++ - 矩阵乘法

> ID：12162637
> 
> 赞同：0
> 
> 时间：2012-08-28T15:30:37.273
> 
> 标签：c++, multidimensional-array

请告诉我下一个问题。我正在尝试将 2 个矩阵相乘，但我的代码中有一些我无法识别的逻辑错误。请帮忙。先感谢您

```
#include <iostream>
#include <cstdio>

using namespace std;

int main() {
    short int Mtx_A[4][2] = {
        {1,2},
        {3,4},
        {5,6},
        {7,8},
    };

    short int  Mtx_B[2][3] = {
        {5,7,9},
        {11,2,6},
    };

    short int  Mtx_res[4][3] = {0};

    for (short int i = 0;i<4;i++) {         // Mtx_A lines counter
        for (short int j=0;j<2;j++) {       // Mtx_B lines & Mtx_A columns counter
            for (short int k=0;k<3;k++) {   // Mtx_res columns counter
                Mtx_res[i][k] += Mtx_A[i][j] * Mtx_B[j][k];
                cout<< Mtx_res[i][k] <<"*"<<"\t";
            }
            cout<<"o"<<"\n";
        }
    }

    getchar();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T15:40:41.687

创建数组的逻辑是正确的，但输出是错误的。

矩阵结果是二维的，但您正在编写三个维度。

输出必须等到该过程完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T15:41:58.727

尚未完成时，您将开始输出结果矩阵。实际上，您将输出每个单元`Mtx_Res`两次，分别为 j = 0 和 1（因此，如您所说，`8x3`而不是）。`4x3`

我会在一个单独的循环中完成输出（在 Mtx_Res 构造循环结束之后）：

```
for (int i = 0; i < 4; i++) {
  for (int j = 0; j < 3; j++) {
    cout << Mtx_res[i][j] << "*" << "\t";
  }
  cout << "o" << "\n";
} 
```

事实上，我认为这是一种（通常）有用的技术：**将处理与显示分开**。诚然，有时您应该为了效率而同时执行这些操作，但更多时候，通过简单赢得的时间对您和您的客户来说都更加宝贵。)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T15:45:00.060

`j`在处理完所有索引后，您可以更改输出以发出单元格。`k`在处理完所有索引后，输出中的下一行继续进行。

```
 Mtx_res[i][k] += Mtx_A[i][j] * Mtx_B[j][k];
            if (j == 1) {
                cout<< Mtx_res[i][k] <<"*"<<"\t";
                if (k == 2) cout<<"o"<<"\n";
            } 
```

# performance - 从 FAST SEARCH 结果中排除 html 文件类型 - SharePoint

> ID：12162641
> 
> 赞同：0
> 
> 时间：2012-08-28T15:31:13.247
> 
> 标签：performance, search, sharepoint-2010

我正在尝试从快速搜索结果中排除 *.html 文件。任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T16:43:42.770

尝试在 html 页面中添加 Meta 机器人标签。然后认为 SharePoint Fast 应该将它们排除在外。

[http://www.dummies.com/how-to/content/exclude-web-pages-from-search-engines-using-meta-r.html](http://www.dummies.com/how-to/content/exclude-web-pages-from-search-engines-using-meta-r.html)

希望这可以帮助。

# android - Android：如何将 website.type_XXX 转换为字符串？

> ID：12162644
> 
> 赞同：3
> 
> 时间：2012-08-28T15:31:21.057
> 
> 标签：android

如何将 ContactsContract.CommonDataKinds.Website.TYPE_HOMEPAGE 等转换为字符串？ContactsContract.CommonDataKinds.Phone 有Phone.getTypeLabel，但Website 没有这个功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T16:14:34.020

只需为他们自己定义一个方法，该方法将返回当前类型的字符串。

# jsf-2 - JSF 生命周期：跳过验证和更新模型

> ID：12162649
> 
> 赞同：1
> 
> 时间：2012-08-28T15:31:30.117
> 
> 标签：jsf-2

我有一个包含很多字段的表单。我需要知道是否有错误。但用户可以根据需要保存错误数据。

我使用 JSF，我问我是否有一种简单的方法可以跳过验证。有关信息，包含所有字段的表单都包装在一个组合中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:56:57.820

您可以通过添加属性来跳过验证**您可以通过将属性immediate="true"**添加到**h:commandButton**或**h:commandLink**。

```
<h:form>
<h:inputText value="#{someBean.input}"/>
//other input fields
<h:commandButton action="#{someBean.invoke}" value="Go" immediate="true"/>
</h:form> 
```

在这种情况下，即使存在验证错误，也会发生导航。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T08:36:59.603

您可以编写一个验证器（不是 jsf 验证器），它将验证数据并将错误添加到 faces 消息中，在操作方法中调用此验证器。

我想这会实现你的目标，但 JSF 自己的验证器使用不会有帮助。

希望这可以帮助 ！！！！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T10:25:30.470

最后，我完成了RequiredValidator（和其他）的重载，并将参数传递给每个按钮[Save with error] 和[Save]。如果单击带有错误的保存按钮，则我的自定义验证器将跳过验证。转换错误可能是一个问题。所以我的 managedBean 中的所有字段都是字符串。如果我期望一个整数，我也会为此编写一个 custum 验证器。

有点重，但它的工作原理。

# objective-c - 如何向特定设备发送推送通知

> ID：12162650
> 
> 赞同：2
> 
> 时间：2012-08-28T15:31:32.663
> 
> 标签：objective-c, ios5

我读过这篇文章：

[Apple 向特定用户推送通知](https://stackoverflow.com/questions/7751937/apple-push-notifications-to-specific-users)

我需要将推送发送到特定设备，但我的问题是登录我的应用程序的用户由生成的 UDID 标识，而不是使用已弃用的 UIDevice。我看到easyAPNS将此值存储到MySQL中：

```
CREATE TABLE `apns_device_history` (
2
  `pid` int(9) unsigned NOT NULL auto_increment,
3
  `appname` varchar(255) NOT NULL,
4
  `appversion` varchar(25) default NULL,
5
  `deviceuid` char(40) NOT NULL,
6
  `devicetoken` char(64) NOT NULL,
7
  `devicename` varchar(255) NOT NULL,
8
  `devicemodel` varchar(100) NOT NULL,
9
  `deviceversion` varchar(25) NOT NULL, 
```

我不知道如何将注册的应用程序用户与该表链接，以实现向特定用户发送推送。是否可以通过代码用户 pid 或设备令牌获取？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T16:03:04.377

开发任何级别的 APNS 都可能是一项艰巨的任务，除非您对服务器端和客户端所涉及的内容有很多了解。

要记住的事情：

1.  服务器端必须考虑到设备标识符（令牌）在每台设备上更新或恢复设备时会发生变化——甚至是新设备！
2.  客户端必须考虑必须在 App Delegate 中实现的委托方法，以正确接受和处理这些推送通知，并开始启动它们。（示例如下）。
3.  服务器再次必须意识到，如果您没有设置适当的“反馈”服务，您可能会将您的推送通知证书列入黑名单。这样做是检查该标识符是否存在，如果不存在，则将其从数据库中取出，这样您就不会继续尝试再次向该用户发送推送通知。
4.  在服务器上，您可以一次发送一个通知（每个通知之间有时间）或将它们排队成大量并“流式传输”这些通知。确实，您必须遵循此操作或再次操作，您可能会被列入黑名单，并且无法再次向您的用户发送推送通知。

在我们开始创建任何类型的推送通知服务器之前，确实需要了解这 4 点。

```
id (int)
token (int - 32 length)
dateChanged (dateTime) 
```

列出的三个字段实际上是基本推送通知服务器所需的全部内容。数据库中的个人标识，设备条目的令牌，以便您知道谁将收到推送消息，并且 dateChanged 是可选的，但很高兴知道您在数据库中已保存了多长时间。

回到“流式”推送通知的概念——你应该真正研究如何使用基本的 PHP 脚本一次发送多个通知（我已经用不到 100 行代码用 PHP 完成了整个服务器，所以它可以使用基于类的 PHP 非常简单）。

**代码：**

不幸的是，放置基本推送服务所需的所有代码会占用大量空间，但我强烈建议您查看我上面提到的要点以及下面列出的有关此任务的一些非常棒的教程：

*   [http://www.raywenderlich.com/3443/apple-push-notification-services-tutorial-part-12](http://www.raywenderlich.com/3443/apple-push-notification-services-tutorial-part-12)
*   [http://mobile.tutsplus.com/tutorials/iphone/iphone-sdk_apns/](http://mobile.tutsplus.com/tutorials/iphone/iphone-sdk_apns/)

# java - 如何使war文件占用更少的内存

> ID：12162654
> 
> 赞同：3
> 
> 时间：2012-08-28T15:31:38.430
> 
> 标签：java, jakarta-ee, tomcat7, out-of-memory, war

我需要有关如何减少 Web 应用程序的内存使用量的帮助。所以我可以更适合我的网络服务器。

所以我正在构建一个使用 JSF 2.0 在 eclipse helios 中开发并在 Apache Tomcat 服务器上运行的 Java Web 应用程序。我还有一个带有 tomcat 的专用虚拟服务器，我在其中部署这些战争文件。webApp 的大小约为 35MB（它有很多 jars 等）但是当我将它部署到我的 tomcat 网络服务器时，我可以看到它需要大约 300MB 的 RAM，这正常吗？我的专用服务器只有 2GB 的内存，通常有 1 个可以使用。所以我一部署 3 个应用程序就会收到 OOM 错误，我已经收到 permgen OOM 和 out of swamp Memory 错误；为了解决这个问题，我将我的 MaxPermGen 提高到大约一个 gig 并重新启动服务器以取回一些沼泽空间。所以我尝试部署较小的旧应用程序（大约 15MB），它们占用的内存要少得多。

现在我发现[这个堆栈溢出问题](https://stackoverflow.com/questions/3855758/large-portlet-war-takes-up-memory-causing-performance-issues)，可以应用于我的情况吗？如果是这样，tomcat服务器中的常用文件夹是什么？以前有人这样做过，还是有其他更有效、不那么复杂的方法？

任何想法和/或评论都值得赞赏。谢谢！

我的

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T15:36:19.473

> 我部署这些战争文件。webApp 的大小约为 35MB（它有很多 jar 等）

只有您使用的文件才会占用任何内存。删除不使用的类会节省磁盘空间，但不会节省内存。

> 但是当我将它部署到我的 tomcat 网络服务器时，我可以看到它需要大约 300MB 的 RAM，这正常吗？

如果您的服务器中有 300 Mb 可用空间，它将全部使用。如果您有 3 GB 的可用空间，它也可能会使用所有这些空间。在实际使用服务器并执行 Full GC 后，您需要查看使用了多少。

> 如果我有 1 GB 的内存，我希望能够在我的网络服务器中安装更多应用程序而不会出现任何 OOM 错误。

您需要确定每个应用程序真正需要多少内存。或者您需要购买更多内存，因为 1 GB 的成本约为 20 美元。（我假设它是一个托管解决方案，其中内存成本更高；）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T16:23:47.377

正常的内存使用取决于 webapp 和它在做什么。正如@Peter Lawrey 所说，WAR 文件的大小与使用的内存量之间没有直接关系。

是的，将通用 JAR 文件从 WAR 中移出并移入共享库文件夹的方法会减少内存，尽管总体上可能不会产生显着差异。有关库文件夹名称，请参阅[Tomcat7 文档](http://tomcat.apache.org/tomcat-7.0-doc/appdev/deployment.html#Shared_Library_Files)。

共享库中的类只会为 JVM 加载一次，而不是为每个使用它的 webapp 加载一次。但是，如果任何类具有静态状态，您会发现该状态现在已在所有 Web 应用程序之间共享。这可能会导致来自一个 webapp 的对象/类型被另一个 webapp 看到，这可能会导致问题。

> 如果我有 1 GB 的内存，我希望能够在我的网络服务器中安装更多应用程序而不会出现任何 OOM 错误。

好吧，Java 确实往往会占用大量内存，实际上，在给定的内存量（和努力）下，您可以做的事情是有限的。归根结底，我怀疑您将需要向下修改您的期望……或者购买具有更多内存的虚拟机。

* * *

在走这条路之前，我建议您使用 Java 内存分析器来查看您的 webapps 设计和实现是否有一些东西使它们使用大量内存。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-28T16:30:28.460

你的war文件的大小并不能决定你的应用程序消耗多少内存。此外，如果您设法在您的 tomcat 中启动 5 个应用程序，这并不意味着它们仍然会在 3 周后运行。

为此，您需要分别对每个应用程序进行负载测试以确定它的内存占用量（从长远来看它需要多少内存）。

为此，您需要：

*   估计将使用您的应用程序的**最大**并发用户数
*   为每个用户分配一个测试用例。例如：您可能有最多 100 个并发用户，其中 10 个注册，10 个搜索一些东西，10 个输入一些数据，等等。
*   使用[JMeter](http://jmeter.apache.org/)或[Grinder](http://grinder.sourceforge.net/)等工具为每个用例编写/记录测试
*   在负载测试期间使用 java 内存分析器来监控内存使用情况、垃圾收集等

运行负载生成器一段时间后，使用的内存应该稳定在某个地方：1GB、1.5GB 等。这就是你的内存占用量。您需要确保您的硬件提供这么多内存。

如果不稳定，那么你有内存泄漏，你最终会得到一个`OutOfMemoryError`. 但这是另一个话题。

您将尝试各种 jvm 内存配置，并注意应用程序的性能：TPS 数。它由上述工具提供。

我刚刚触及了冰山一角，负载和性能测试是一个密集的话题。

# android - XML 元素未正确显示

> ID：12162656
> 
> 赞同：3
> 
> 时间：2012-08-28T15:31:49.837
> 
> 标签：android, android-layout

在我的应用程序中，我想解析一个 XML 文件并将元素添加到视图中，这非常有效。但是更“复杂”的 XML 文件有一点问题，没有正确显示。例如，当我将此文件作为输入时，除了最后一个之外，TextViews 不会出现在屏幕上？

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@drawable/general_bg"
    android:gravity="center_horizontal" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <TextView
            android:id="@+id/txt_newgame_title"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:paddingBottom="25dip"
            android:paddingTop="10dip"
            android:text="New Game"
            android:textColor="@color/menu_title"
            android:textSize="24.5sp" />

        <TextView
            android:id="@+id/txt_newgame_profile"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="left"
            android:paddingBottom="20dip"
            android:paddingLeft="10dip"
            android:text="Profile: Denis"
            android:textColor="@color/menu_submenu"
            android:textSize="18sp" />

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="0.5dip"
            android:background="#999" />

        <TextView
            android:id="@+id/txt_newgame_difficulty"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="left"
            android:paddingBottom="5dip"
            android:paddingLeft="10dip"
            android:paddingTop="5dip"
            android:textColor="@color/menu_submenu"
            android:textSize="18sp" />

        <SeekBar
            android:id="@+id/seekb_newgame_difficulty"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_marginBottom="10dip"
            android:max="10"
            android:paddingLeft="20dip"
            android:paddingRight="20dip"
            android:progress="4" />

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="0.5dip"
            android:background="#999" />

        <RelativeLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_gravity="center_vertical"
            android:layout_marginBottom="10dip"
            android:layout_marginTop="10dip" >

            <TextView
                android:id="@+id/txt_newgame_showshadow"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentLeft="true"
                android:layout_centerVertical="true"
                android:paddingLeft="10dip"
                android:text="Show shadow"
                android:textColor="@color/menu_submenu"
                android:textSize="18sp" />

            <CheckBox
                android:id="@+id/checkbox_newgame_shadow"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentRight="true"
                android:layout_centerVertical="true"
                android:paddingRight="20dip" />
        </RelativeLayout>

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="0.5dip"
            android:background="#999" />

        <RelativeLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_gravity="center_vertical"
            android:layout_marginBottom="10dip"
            android:layout_marginTop="10dip" >

            <TextView
                android:id="@+id/txt_newgame_cooperative"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentLeft="true"
                android:layout_centerVertical="true"
                android:paddingLeft="10dip"
                android:text="Cooperative"
                android:textColor="@color/menu_submenu"
                android:textSize="18sp" />

            <CheckBox
                android:id="@+id/checkbox_newgame_cooperative"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentRight="true"
                android:layout_centerVertical="true"
                android:paddingRight="20dip" />
        </RelativeLayout>

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="0.5dip"
            android:background="#999" />

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:gravity="center"
            android:orientation="horizontal"
            android:paddingTop="60dip" >

            <Button
                android:id="@+id/btn_newgame_start"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:gravity="center_vertical"
                android:paddingLeft="50dip"
                android:paddingRight="50dip"
                android:text="Start" />

            <Button
                android:id="@+id/btn_newgame_back"
                android:layout_width="wrap_content"
                android:layout_height="wrap_conte
                android:gravity="center_vertical"
                android:paddingLeft="50dip"
                android:paddingRight="50dip"
                android:text="Back" />
        </LinearLayout>
    </LinearLayout>

    <TextView
        android:id="@+id/txt_start_status"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:text="Status: Connected"
        android:textColor="@color/green_ok"
        android:textSize="18sp" />

</RelativeLayout> 
```

所以我的问题是当我使用解析时我必须考虑什么，为什么不显示 TextViews？它们是被其他元素落后还是 RelativLayout 有线索？

将不胜感激提示！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T16:25:14.413

您必须设置`android:layout_height`大于`0.5dip`（例如`10dip`或`15dip`）的文本视图，以便它们可见。
我改变了你的布局，所有的文本视图都是可见的：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/general_bg"
    android:gravity="center_horizontal" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <TextView
            android:id="@+id/txt_newgame_title"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:paddingBottom="25dip"
            android:paddingTop="10dip"
            android:text="New Game"
            android:textColor="@color/menu_title"
            android:textSize="24.5sp" />

        <TextView
            android:id="@+id/txt_newgame_profile"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="left"
            android:paddingBottom="20dip"
            android:paddingLeft="10dip"
            android:text="Profile: Denis"
            android:textColor="@color/menu_submenu"
            android:textSize="18sp" />

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="15dip"
            android:background="#999" />

        <TextView
            android:id="@+id/txt_newgame_difficulty"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="left"
            android:paddingBottom="5dip"
            android:paddingLeft="10dip"
            android:paddingTop="5dip"
            android:textColor="@color/menu_submenu"
            android:textSize="18sp" />

        <SeekBar
            android:id="@+id/seekb_newgame_difficulty"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginBottom="10dip"
            android:max="10"
            android:paddingLeft="20dip"
            android:paddingRight="20dip"
            android:progress="4" />

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="15dip"
            android:background="#999" />

        <RelativeLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_gravity="center_vertical"
            android:layout_marginBottom="10dip"
            android:layout_marginTop="10dip" >

            <TextView
                android:id="@+id/txt_newgame_showshadow"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentLeft="true"
                android:layout_centerVertical="true"
                android:paddingLeft="10dip"
                android:text="Show shadow"
                android:textColor="@color/menu_submenu"
                android:textSize="18sp" />

            <CheckBox
                android:id="@+id/checkbox_newgame_shadow"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentRight="true"
                android:layout_centerVertical="true"
                android:paddingRight="20dip" />
        </RelativeLayout>

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="15dip"
            android:background="#999" />

        <RelativeLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_gravity="center_vertical"
            android:layout_marginBottom="10dip"
            android:layout_marginTop="10dip" >

            <TextView
                android:id="@+id/txt_newgame_cooperative"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentLeft="true"
                android:layout_centerVertical="true"
                android:paddingLeft="10dip"
                android:text="Cooperative"
                android:textColor="@color/menu_submenu"
                android:textSize="18sp" />

            <CheckBox
                android:id="@+id/checkbox_newgame_cooperative"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentRight="true"
                android:layout_centerVertical="true"
                android:paddingRight="20dip" />
        </RelativeLayout>

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="15dip"
            android:background="#999" />

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:gravity="center"
            android:orientation="horizontal"
            android:paddingTop="60dip" >

            <Button
                android:id="@+id/btn_newgame_start"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:gravity="center_vertical"
                android:paddingLeft="50dip"
                android:paddingRight="50dip"
                android:text="Start" />

            <Button
                android:id="@+id/btn_newgame_back"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:gravity="center_vertical"
                android:paddingLeft="50dip"
                android:paddingRight="50dip"
                android:text="Back" />
        </LinearLayout>
    </LinearLayout>

    <TextView
        android:id="@+id/txt_start_status"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:text="Status: Connected"
        android:textColor="@color/green_ok"
        android:textSize="18sp" />

</RelativeLayout> 
```

# r - 可以打印超过 100 行的 data.table 吗？

> ID：12162657
> 
> 赞同：51
> 
> 时间：2012-08-28T15:31:50.347
> 
> 标签：r, printing, data.table, options, output-formatting

data.table 有一个很好的特性，可以抑制表头和表尾的输出。

是否可以一次查看/打印超过 100 行？

```
library(data.table)
## Convert the ubiquitous "iris" data to a data.table
dtIris = as.data.table(iris)
## Printing 100 rows is possible
dtIris[1:100, ]
## Printing 101 rows is truncated
dtIris[1:101, ] 
```

我经常有我只想查看的有点大（例如 200 行）的 data.table 结果。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-08-28T15:37:57.650

的 print 方法`data.table`有一个参数`nrows`：

```
args(data.table:::print.data.table)
function (x, nrows = 100L, digits = NULL, ...) 
```

您可以使用它来控制打印的行数：

```
print(dtIris, nrow=105)
.....
99:          5.1         2.5          3.0         1.1 versicolor
100:          5.7         2.8          4.1         1.3 versicolor
101:          6.3         3.3          6.0         2.5  virginica
102:          5.8         2.7          5.1         1.9  virginica
103:          7.1         3.0          5.9         2.1  virginica
104:          6.3         2.9          5.6         1.8  virginica
105:          6.5         3.0          5.8         2.2  virginica
     Sepal.Length Sepal.Width Petal.Length Petal.Width    Species 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-08-28T17:16:11.127

`View()`（如`View(iris)`or `View(dtIris[1:120,])`）不会截断`data.table`s，并且通常比打印/喷出 a`data.*`到控制台更好。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-01-26T02:21:13.767

打印前 60 行和后 60 行（默认为前 5 行和后 5 行）：

```
print(dtIris, topn = 60) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-28T16:31:50.223

您可以将其转换为仅用于打印的 data.frame：

```
iris_dt = as.data.table(iris)
print(as.data.frame(iris_dt)) 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-28T15:40:56.320

一个凌乱的选项，但您始终可以将其导出到 excel 中以方便地查看它。

```
library(xlsReadWrite)
write.xls(mydata, "c:/mydata.xls") 
```

# vba - 将单元格从一个工作簿（非特定）复制到另一个（特定）

> ID：12162658
> 
> 赞同：0
> 
> 时间：2012-08-28T15:31:51.290
> 
> 标签：vba, excel

好的，所以我正在尝试为企业（员工使用）创建订单日志。

我有一个表格，其中多个用户可以访问/输入所有需要的信息。它打印到 Excel 电子表格中，供一个人打开和下订单。有时用户可能想要从前一年的日志中复制一个订单行（到目前为止有 4 个），所以我试图将其合并到当前日志中。

我无法引用用户已打开的另一个工作簿并将信息复制到当前日志中打开的用户窗体中。我有这个：

```
Private Sub cmdCopy_Click()

Dim rowRef As Integer, colItem As Integer, colSup As Integer, colCatNum As Integer, colQty As Integer, colUnit As Integer, colCat As Integer

'stores row of selected order from old order log successfully
rowRef = ActiveCell.row

'I'm trying to find which column has which headers as the logs aren't consistent
For x = 2 To 9
    If ActiveWorkbook.Sheet1.Cells(2, x).Text = "Item" Then
        colItem = x
    ElseIf ActiveWorkbook.Sheet1.Cells(2, x).Text = "Supplier" Then
        colSup = x
    ElseIf ActiveWorkbook.Sheet1.Cells(2, x).Text = "Catalogue #" Then
        colCatNum = x
    ElseIf ActiveWorkbook.Sheet1.Cells(2, x).Text = "Qty" Then
        colQty = x
    ElseIf ActiveWorkbook.Sheet1.Cells(2, x).Text = "Unit" Then
        colUnit = x
    ElseIf ActiveWorkbook.Sheet1.Cells(2, x).Text = "Category" Then
        colCat = x
    End If
Next x

'fills information into userform
txtItem.Text = Sheet1.Cells(rowRef, colItem).Text
txtSup.Text = Sheet1.Cells(rowRef, colSup).Value
txtCatNum.Text = Sheet1.Cells(rowRef, colCatNum).Value
txtQty.Text = Sheet1.Cells(rowRef, colQty).Value
cboUnit.Text = Sheet1.Cells(rowRef, colUnit).Value
cboCat.Text = Sheet1.Cells(rowRef, colCat).Value

End Sub 
```

所以我想要发生的是：

1.  用户打开当前订单日志
2.  用户按下 ActiveX 按钮打开 frmOrderLog
3.  a) 用户手动输入信息
    b) 用户从当年的日志中复制信息
    c) 用户最小化窗口，打开上一年的日志，选择一个单元格，然后在用户窗体中按下“复制顺序”按钮，然后从相应单元格中复制信息上一年的订单登录到本年度订单日志内表格中相应的文本框/组合框

如果有任何澄清要求，请告诉我。如果这已经在论坛中，我很抱歉，但是使用我的搜索词我找不到有帮助的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T16:20:54.847

对我来说似乎是一个简单的语法问题：

你想改变：

```
If ActiveWorkbook.Sheet1.Cells(2, x).Text = "Item" Then 
```

到：

```
If ActiveWorkbook.Sheets(1).Cells(2, x).Text = "Item" Then 
```

Sheet1 语法对我不起作用。

显然，您希望在 Sheet1 出现的任何其他地方进行相同的更改。

# r - 将个人分配到收入分位数

> ID：12162660
> 
> 赞同：5
> 
> 时间：2012-08-28T15:31:57.780
> 
> 标签：r

我有一组数据，如下所示：

```
annual_exp<-as.data.frame(c(6000,4200,240001,750,20000,3470,10500,2400,2280,36000,3600,20000,2000,12000,1200,3000,4500,64000))
annual_exp<-as.data.frame(annual_exp) 
```

我想创建一个新变量，称为“五分位数”，它为每个观察值分配一个介于 1 和 5 之间的整数，包括 1 和 5，具体取决于它们属于哪个五分之一的收入支出 (annual_exp)。所以应该有相同数量的 1 到 5。

到目前为止，我的尝试是执行以下操作：

```
test<-quantile(annual_exp$annual_exp, probs= seq(0,1,0.2), na.rm=TRUE)
summary(test)
test

breaks<-c(test[1],test[2],test[3],test[4],test[5],test[6])
quantiles<-cut(annual_exp$annual_exp, breaks, labels=c("1","2","3","4","5"), include.lowest=TRUE, right=TRUE)
quantiles<-as.data.frame(quantiles)
quantiles<-cbind(annual_exp, quantiles) 
```

问题（在这个例子中创建的这么小的样本并没有真正显示出来）是通过这样做落入每个分位数的人数变化很大。这是因为我使用了上面的“分位数”函数。

因此，我正在寻找等式中“分位数”部分的替代方案，它将根据样本的年度支出将样本分成 5 个相等的五分位数组。

对此的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-28T15:42:33.250

**ggplot2**有一个很好的实用功能，`cut_number()`它可以满足您的需求。

```
library(ggplot2)
as.numeric(cut_number(annual_exp[[1]], n = 5))
# [1] 3 3 5 1 4 2 4 2 1 5 3 4 1 4 1 2 3 5 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-09-07T16:54:47.153

这是使用`data.table`包的解决方案，这可能是最快的解决方案（如果您正在处理大型数据集，这是一个大问题）

```
library(data.table)

setDT(data)

data[ , newVarDecile := cut(varIncome,
                            breaks=quantile(varIncome,
                            probs=seq(0, 1, by=0.1), na.rm=T),
                            include.lowest= TRUE, labels=1:10) ] 
```

如果您想为不同的子组分别计算十分位数，您只需要包含`by =`.

```
data[ , newVarQuintiles := cut(varIncome,
                               breaks=quantile(varIncome,
                               probs=seq(0, 1, by=0.2), na.rm=T),
                               include.lowest= TRUE, labels=1:5), 
                               by = groupVar ] 
```

附言。请注意，在第二个示例中，我们通过更改`probs`和`labels`参数计算了收入五分位数

# c++ - Rapidxml 正在写入错误的字符

> ID：12162661
> 
> 赞同：2
> 
> 时间：2012-08-28T15:31:58.260
> 
> 标签：c++, xml, rapidxml

我最近一直在使用 Rapidxml 并且遇到了以下问题。当我尝试添加不是硬编码但在程序运行时生成的属性时，rapidxml 会插入错误的字符。

这是我的代码示例：

```
 void ProcessInfo::retriveInfo()
{
    HANDLE hSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);

   PROCESSENTRY32 pe = { sizeof(pe) };  
   BOOL fOk = ProcessFirst( &pe, hSnapshot );

   using namespace rapidxml;
   xml_document<> doc;

   xml_node<>* decl = doc.allocate_node(node_declaration);
   decl->append_attribute(doc.allocate_attribute("version", "1.0"));
   decl->append_attribute(doc.allocate_attribute("encoding", "utf-8"));
   doc.append_node(decl);

   xml_node<>* root = doc.allocate_node(node_element, "rootnode");

   while(fOk)
   {
       std::string processFile = pe.szExeFile;

   xml_node<>* processName = doc.allocate_node(node_element, PROCESS_NODE);
       root->append_node( processName );

       processName->append_attribute(doc.allocate_attribute( PROCESS_NAME, processFile.c_str() ) );

       char szPID[PID_BUFFER];
       memset(szPID, 0x00, sizeof(szPID) );
       itoa(pe.th32ProcessID, szPID, 10 );
       processName->append_attribute(doc.allocate_attribute( PROCESS_ID, szPID ));

       char szParentPID[PID_BUFFER];
       itoa( pe.th32ParentProcessID, szParentPID, 10 );
       processName->append_attribute(doc.allocate_attribute( PROCESS_PARENT_ID, szParentPID ));

       std::cout << processFile.c_str() << " " << szPID <<  " " << szParentPID << std::endl;

       fOk = ProcessNext( &pe, hSnapshot );
   }

   doc.append_node( root );
   std::cout << doc;   

} 
```

编码似乎有问题，但我无法弄清楚，为什么？有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T15:44:16.283

当您将字符串传递给 RapidXML 时，它不会复制它，它只会记住地址。因此，您添加的“变量”字符串将被覆盖，从而破坏 RapidXML 文档。

在此处阅读本节。

[http://rapidxml.sourceforge.net/manual.html#namespacerapidxml_1modifying_dom_tree](http://rapidxml.sourceforge.net/manual.html#namespacerapidxml_1modifying_dom_tree)

特别是，您需要更改使用如下变量的 allocate_attribute 调用：-

```
char *node_name = doc.allocate_string(szPID);        // Allocate string and copy name into it
processName->append_attribute(doc.allocate_attribute(PROCESS_ID, node_name);  // Set node name to node_name 
```

我的这个问题也可能是相关的：[如何解决 RapidXML 字符串所有权问题？](https://stackoverflow.com/questions/2432478/how-to-fix-rapidxml-string-ownership-concerns?rq=1)

# jquery - jQuery - 循环中的队列中的动画 + show()

> ID：12162673
> 
> 赞同：0
> 
> 时间：2012-08-28T15:32:21.693
> 
> 标签：jquery

我有一个非常具体的问题，我什至不知道在谷歌中寻找什么......我正在尝试创建一个动画字母。有一支笔和 5 条线在一个单独的标签中，都在一个容器元素中，相对定位，有自己的 ID，并且这些线是隐藏的（都在它们应该出现的位置上）。动画是这样的：画笔对角移动，出现一条线，画笔移动到新线的开头，重复5次，画笔回到默认位置，线消失。我不想分别为所有 5 个循环编写动画代码，所以我使用 for 循环将动画插入到队列中。一切都很好，除了最愚蠢的事情 - 我无法显示当前的行号。这是代码：

```
var penAnimating = false;

function animateLetter() {
    var pen = $('#form_decor_pen');
    var startRight = pen.css('right');
    var startTop = pen.css('top');

    if (!penAnimating) {
        penAnimating = true;

        for (var i=1; i<=5; i++) {
            pen.animate( {
                right: '-=26',
                top: '-=10',
            },{ 
                duration: 600,
                queue: 'penAnimation'
            }); 
```

这是问题部分：

```
pen.queue('penAnimation', function(next) {          
    //var line = $('#form_header_decor :nth-child(' + i.toString() + ')')
    var line = $('#line_' + i.toString())
    line.show();
    //alert(line.id);
    next(); 
}) 
```

问题是，我总是输出 5 - 循环结束的数字。

```
 if (i<5) {
                pen.animate({
                    right: '+=26',
                    top: '+=20',
                   },{
                    duration: 300,
                    queue: 'penAnimation'
                });
            } else {
                pen.animate({
                    right: startRight,
                    top: startTop,
                   },{
                    duration: 300,
                    queue: 'penAnimation',
                    complete: function() {
                        penAnimating = false;
                    }
                });
            }​
         }
       pen.dequeue('penAnimation');
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T17:51:00.360

当您有一个包含异步调用的 for 循环时，for 变量的值将是最后一个值。除非您将代码放入闭包中。

将 for 循环更改为带有闭包的 for 循环。

```
 for (var i=1; i<=5; i++) { 
    (function(i){
    // the second i is now in a closure.
    })(i);
    } 
```

# c# - 将DIB转换为DDB？

> ID：12162676
> 
> 赞同：3
> 
> 时间：2012-08-28T15:32:37.123
> 
> 标签：c#, pinvoke, gdi+, clipboard, gdi

我正在开发一个剪贴板管理器（可以在这里看到：http: [//flamefusion.net/software/shapeshifter](http://flamefusion.net/software/shapeshifter)）。

但是，我目前遇到的问题是位图 ( `bmp`) 无法真正正确地插入剪贴板。我的第一种方法如下，使用`SetClipboardData`.

```
var hBitmap = bmp.GetHBitmap();
SetClipboardData(CF_BITMAP, hBitmap); 
```

我知道这可能存在内存泄漏，并且仅作为测试。测试失败。粘贴到剪贴板中的图像在粘贴时无法被 Paint 读取。

所以经过大量的研究和失败的尝试，我得到了一个新的理论。我正在使用的位图是从 a 创建的`MemoryStream`，它是通过先前调用该`Bitmap.Save(Stream, ImageFormat)`方法创建的。这使我相信 a`System.Drawing.Bitmap`不是`GetHBitmap`函数所期望`HBITMAP`的那种。`SetClipboardData`

所以我尝试了以下方法，并取得了某种成功。

```
var memDC = CreateCompatibleDC(IntPtr.Zero);
var memBitmap = CreateCompatibleBitmap(memDC, bmp.Width, bmp.Height);
SetClipboardData(CF_BITMAP, memBitmap); 
```

现在图像以正确的尺寸插入，但作为黑色图像。这是非常明显的，因为除了`bmp`宽度和高度之外，实际上没有任何东西用于创建“兼容”位图。

我假设我必须以某种方式使用 BitBlt 将我的原始位图复制到这个现在“兼容”的位图，但我不知道从哪里开始。

你们中的任何一个 GDI 向导都知道吗？这里显然需要魔法。

**编辑 1** 正如 dthorpe 很好地指出的那样，我的问题似乎是我试图保存的图像实际上是一个 DIB。现在问题变了。我需要弄清楚如何从 DIB 转换为 DDB。我知道在执行此操作时会造成 alpha 损失，但仍然需要它。

**编辑 2** 不能接受使用`Clipboard.SetImage`. 这在我的场景中不起作用。我需要使用 API。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T16:40:45.483

CF_BITMAP 可能是与您的位图一起使用的错误格式。CF_BITMAP 剪贴板格式指定设备位图，但如今几乎所有位图都是 DIB - 与设备无关的位图。设备位图与系统/硬件设备调色板相关（想想 EGA 图形），并且必须匹配当前显示模式的像素格式。DIB 带有自己的颜色信息，其像素格式与显示模式无关。

文档说，如果应用程序在从剪贴板读取时请求 CF_DIB，剪贴板管理器会将 CF_BITMAP 转换为 CF_DIB，但这假定原始图像实际上是当前显示模式像素格式的设备位图。如果不是，则转换将产生垃圾，因为输入是垃圾。

再次尝试使用 CF_DIB 而不是 CF_BITMAP。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T19:21:01.173

我认为你过于复杂了。根本不需要 p/invoke —— 框架已经为你处理好了。您可以以单行方式执行此操作：

```
Clipboard.SetImage(bmp); 
```

# mongodb - MongoDB 2.1 聚合框架总和匹配名称的数组元素

> ID：12162681
> 
> 赞同：17
> 
> 时间：2012-08-28T15:32:47.520
> 
> 标签：mongodb

这是一个关于在我必须匹配另一个元素的数组中添加一系列数据的最佳方法的问题。我正在尝试使用 2.2 聚合框架，我可以用一个简单的组来做到这一点。

因此，对于给定的一组文档，我试图获得这样的输出；

```
{
    "result" : [
            {
                "_id" : null,
                "numberOf": 2,
                "Sales" : 468000,
                "profit" : 246246,
            }
    ],
    "ok" : 1
} 
```

现在，我最初有一个文档列表，其中包含分配给命名属性的值，例如；

```
[
{
    _id : 1,
    finance: {
        sales: 234000,
        profit: 123123,
    }
}
,
{
    _id : 2,
    finance: {
        sales: 234000,
        profit: 123123,
    }
}
] 
```

这很容易加起来，但由于其他原因该结构不起作用。例如，可能还有其他列，如“财务”，我希望能够在不创建数千个索引的情况下对它们进行索引，所以我需要转换为这样的结构；

```
[
{
    _id : 1,
    finance: [
        {
            "k": "sales",
            "v": {
                "description":"sales over the year",
                v: 234000,
            }
        },
        {
            "k": "profit",
            "v": {
                "description":"money made from sales",
                v: 123123,
            }
        }
    ]
}
,
{
    _id : 2,
    finance: [
        {
            "k": "sales",
            "v": {
                "description":"sales over the year",
                v: 234000,
            }
        },
        {
            "k": "profit",
            "v": {
                "description": "money made from sales",
                v: 123123,
            }
        }
    ]
}
] 
```

如果我愿意，我可以索引finance.k，但是我正在努力构建一个聚合查询来将所有与特定键匹配的数字相加。这就是我最初选择命名属性的原因，但这确实需要在有数千个“k”标签的情况下工作。

有谁知道如何使用新框架为此构建聚合查询？我试过这个；

```
db.projects.aggregate([
    {
        $match: {
            // QUERY
            $and: [
                // main query
                {},
            ]
        }
    },
    {
        $group: {
            _id: null,
            "numberOf": { $sum: 1 },
            "sales":    { $sum: "$finance.v.v" },
            "profit":   { $sum: "$finance.v.v" },
        }
    },
]) 
```

但我明白了；

```
{
    "errmsg" : "exception: can't convert from BSON type Array to double",
    "code" : 16005,
    "ok" : 0
} 
```

** 为了获得额外的荣誉，我还需要能够在 MapReduce 查询中执行此操作。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-29T01:22:47.613

您可以使用聚合框架来获取销售额*和*利润*以及*您可能存储在键/值对表示中的任何其他值。

对于您的示例数据：

```
var pipeline = [
    {
        "$unwind" : "$finance"
    },
    {
        "$group" : {
            "_id" : "$finance.k",
            "numberOf" : {
                "$sum" : 1
            },
            "total" : {
                "$sum" : "$finance.v.v"
            }
        }
    }
]

R = db.tb.aggregate( pipeline );
printjson(R);
{
        "result" : [
            {
                "_id" : "profit",
                "numberOf" : 2,
                "total" : 246246
            },
            {
                "_id" : "sales",
                "numberOf" : 2,
                "total" : 468000
            }
        ],
        "ok" : 1
} 
```

如果您有额外的 k/v 对，那么您可以添加一个仅通过 ["sales","profit"] 中的 k 值的匹配。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-28T17:12:58.297

您将不得不使用“$unwind”来分解数组中的值，这意味着您无法在单个聚合命令中获得销售额和利润的总和。鉴于此，查询本身很简单：

```
var pipeline = [ 
        {"$unwind": "$finance" } ,
        {"$match": {"finance.k": "sales"} },
        { $group: 
            { _id: null,
                numberOf: { "$sum": 1 },
                sales: {"$sum": "$finance.v.v" }
            }
        }
    ];

R = db.tb.aggregate( pipeline );
printjson(R);

{
        "result" : [
                {
                        "_id" : null,
                        "numberOf" : 2,
                        "sales" : 236340
                }
        ],
        "ok" : 1
} 
```

您可以运行类似的利润查询，只需在“$match”运算符中将“利润”替换为“销售额”。

哦，这是 map/reduce 示例：

```
map = function() {
    var ret = { sales: 0.0 , profit: 0.0, count: 1 };

    // iterate over 'finance[]' array
    this.finance.forEach( function (i) { 
        if ( i.k == "sales" ) ret.sales =  i.v.v ;
        if ( i.k == "profit" ) ret.profit =  i.v.v ;
    } );

    emit( 1, ret );
}

reduce = function(key, values) {
    var ret = { sales: 0.0 , profit: 0.0, count: 0 };

    values.forEach(function(v) {
        ret.sales += v.sales;
        ret.profit += v.profit;
        ret.count += v.count;
    });

    return ret;
    };
//
// run map/reduce
//
res = SOURCE.mapReduce( map, reduce ); 
```

# c# - 如何根据 BrokeredMessage 类的内置属性过滤 ServiceBus 主题订阅？

> ID：12162683
> 
> 赞同：12
> 
> 时间：2012-08-28T15:32:56.240
> 
> 标签：c#, azure, publish-subscribe, servicebus

使用 2012 年 6 月的 Azure SDK，我有一个服务总线主题，我正在向它添加订阅。

我想过滤该订阅。如果我根据我添加到 BrokeredMessage 属性包中的一项来执行此操作，那么这可以正常工作：

```
// Send the message:
BrokeredMessage message = new BrokeredMessage(serializableObject);
message.Properties.Add("MySessionId", "GUID");
getTopicClient("MY_TOPIC").Send(message); // method creates client. omitted here.

// Retrieve it:
SqlFilter myFilter = new SqlFilter(@"(MySessionId = ""GUID"")");
namespaceManager.CreateSubscription("MY_TOPIC", "MY_SUB", myFilter);
SubscriptionClient client = getSubscriptionClient("MY_TOPIC", "MY_SUB"); // method creates client. omitted here.

// This will work fine:
Message newMessage = client.Receive(); 
```

但是，如果我执行相同操作，但将过滤器值添加到 BrokeredMessage 对象的直接属性之一，例如 SessionId，则此操作将失败：

```
// Send the message:
BrokeredMessage message = new BrokeredMessage(serializableObject);
message.SessionId = "GUID";
getTopicClient("MY_TOPIC").Send(message); // method creates client. omitted here.

// Retrieve it:
SqlFilter myFilter = new SqlFilter(@"(SessionId = ""GUID"")");
namespaceManager.CreateSubscription("MY_TOPIC", "MY_SUB", myFilter);
SubscriptionClient client = getSubscriptionClient("MY_TOPIC", "MY_SUB"); // method creates client. omitted here.

// This will never receive a message
Message newMessage = client.Receive(); 
```

如何构造一个 SqlFilter 来处理 BrokeredMessage 对象的内置属性（SessionId、ReplyToSessionId 或 MessageId？

这甚至可能吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-28T16:58:31.793

SQL 过滤器中的属性表达式实际上具有范围前缀。您通常看不到它们，因为默认值为“用户”。对于用户定义的属性。您可以通过前缀“sys”来获取系统属性。

请参阅此处的语法描述；寻找“范围” [http://msdn.microsoft.com/en-us/library/windowsazure/microsoft.servicebus.messaging.sqlfilter.sqlexpression.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/microsoft.servicebus.messaging.sqlfilter.sqlexpression.aspx)

# jquery - 为什么这个跨域 ajax 调用真的有效？

> ID：12162687
> 
> 赞同：6
> 
> 时间：2012-08-28T15:33:04.540
> 
> 标签：jquery, ajax, web-services, cross-domain

[我无意中写了一个对NextBus](http://www.nextbus.com/xmlFeedDocs/NextBusXMLFeed.pdf)的跨域 AJAX 调用（使用 jQuery）：

```
$.ajax({
      url: 'http://webservices.nextbus.com/service/publicXMLFeed?command=predictions&a=sf-muni&r=1&s=6294',
      dataType: 'xml',
      success: function(data) {
           do_stuff();
      }
}); 
```

问题是，它适用于所有浏览器，尽管来自不同的域。鉴于单一来源政策，**为什么这实际上有效？**

该页面在这里：[http://sftransitfirst.org/F/](http://sftransitfirst.org/F/)，从下拉菜单中选择一个停止会触发 ajax。

[正如预期的那样，对Google Maps API Web Services](https://developers.google.com/maps/documentation/directions/)进行类似的调用会失败`Origin ... is not allowed by Access-Control-Allow-Origin`（并且它不支持 jsonp）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-28T15:37:29.630

他们必须通过以下方式明确允许跨域访问：

```
<?php header('Access-Control-Allow-Origin: *'); ?> 
```

或者使用 htaccess：

```
<ifModule mod_headers.c>
    Header set Access-Control-Allow-Origin: *
</ifModule> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-28T15:45:54.780

许多现代 Web API 支持[跨域资源共享](https://en.wikipedia.org/wiki/Cross-origin_resource_sharing)(CORS)。CORS 是一种让网站自愿将其页面提供给跨域脚本的方法。来自服务器的[`Access-Control-Allow-Origin`](http://www.w3.org/TR/cors/#access-control-allow-origin-response-header)HTTP 标头向您的 Web 浏览器发出信号，表明允许脚本使用 Ajax 访问页面是可以的，即使脚本在不同的源上运行也是如此。如果服务器不提供 CORS 标头，您的浏览器将照常执行 SOP。

大多数 API 选择将其页面公开给跨域脚本，因为他们知道几乎所有用户都希望能够通过 Ajax 从他们自己的域访问 API。

# java - 从 Java 中的多个类继承（可能不使用接口）

> ID：12162688
> 
> 赞同：2
> 
> 时间：2012-08-28T15:33:06.560
> 
> 标签：java, interface, multiple-inheritance

因此，假设我们有 A、B 和 C 类，我想从所有这些类继承并有另一个名为 D 的类，这可以使用 Java 中的实现和接口来完成。但是假设我们不想使用这个简单的解决方案，你能在 Java 中以任何其他方式从类 A、B 和 C 继承类 D 吗？

（这个问题可能与设计模式有关，在午餐讨论设计模式时挑战我的同事后提出）我认为除了使用多个接口之外，在 Java 中没有其他方法可以实现多重继承。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T15:36:27.920

多重继承是不可能的。

无论如何，您可以尝试使用[composition](https://stackoverflow.com/questions/5003285/java-multiple-inheritance)来模拟这种继承。

[JB Nizet](https://stackoverflow.com/users/571407/jb-nizet)在提供的链接中回答了您的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T16:00:24.250

从 Java SE 8 开始，接口的实现可能有限。这给出了实现的多重继承形式。

作为多重继承的替代方案，内部类可以执行类似的工作。

```
class Derived extends BaseOne {
    ... fields ...
    private class InnerTwo extends BaseTwo {
        ... code with access to Derived's fields ...
    }
} 
```

If methods overridden from `BaseOne` need to call methods of `BaseTwo` they will need an explicit reference to the inner class, but not the other way around and the `Derived` fields are shared.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-28T15:34:38.460

不，Java 的多重继承方法是使用接口。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-28T15:34:51.827

Java 中的一个类只能从一个类继承（如果您不指定基类，则它是`java.lang.Object`）。从三个类继承的唯一方法是它们在链中相互继承：

```
class A {}
class B extends A {}
class C extends B {}
class D extends C {} 
```

现在你的`D`类继承自`A`,`B`和`C`，但我怀疑这就是你要找的。

Java 中惯用的解决方案是实现多个接口而不是继承多个类。如果您必须“继承”实现，请使用组合而不是继承。

```
interface IA {}
interface IB {}
interface IC {}
class A implements IA {}
class B implements IB {}
class C implements IC {}
class D implements IA, IB, IC {
    A a = ...;
    B b = ...;
    C c = ...;
    // Implementations of methods from IA, IB, and IC
    // need to forward the calls to a, b, and c
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-28T15:36:07.410

Java 不支持`class D extends A, B, C`. 正如 Lanaru 所提到的，执行此操作的首选方法是使用接口。

否则，您可以执行以下操作：

```
public class A {}
public class B extends A {}
public class C extends B {}
public class D extends C {} 
```

实际上，将`D`间接扩展。`A``B``C`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-28T15:35:16.337

快速回答是否定的。多个接口不是多重继承。接口和类是不同的概念。

类是对象的定义，而接口是对象必须遵循的契约。

# php - 将 SOAP 与 PHP 一起使用，简单的问题

> ID：12162689
> 
> 赞同：3
> 
> 时间：2012-08-28T15:33:15.310
> 
> 标签：php, soap

我正在尝试将 API 集成到我的网站中（API 并不重要，问题在于 SOAP）。我通常不会用 PHP 编写代码，而是专注于 javascript，所以 SOAP 和相关的东西对我来说很陌生。我一直在搜索和尝试不同的事情大约 2 个半小时，并设法缩小我的问题范围。

我调用`$client->__getFunctions()`了 ，它给了我一个字符串列表，定义了我可以使用的所有函数。这是我想使用的函数的字符串：

```
"GetActivationCodeResponse GetActivationCode(GetActivationCode $parameters)" 
```

我已经和 API 创建者按照惯例编写并正在编写，因为这是我第一次使用 SOAP，也是一段时间以来第一次使用 php。

所以我在我的类中创建了一个函数，名称`GetActivationCode`如下：

```
public function GetActivationCode($params) {
    $this->client->GetActivationCode($params);
    var_dump($this->client);
} 
```

这将始终输出 SOAP 错误：

```
Server was unable to process request. --->
System.NullReferenceException:  
Object reference not set to an instance of an object 
```

所以我猜它期望传递的参数是一个名为的类的实例`GetActivationCode`？我不知道该怎么做，也不想创建一个全新的类来提供一个功能（但如果这是解决方案，我会这样做）。

**我写过的课**

```
<?php

require_once("../includes/mbApi.php");
error_reporting(E_ALL);
ini_set('display_errors', '1');

class MBActivateService extends MBAPIService 
{
    function __construct($debug = false)
    {
        $serviceUrl = "http://" . GetApiHostname() . "/0_5/SiteService.asmx?wsdl";

        $this->debug = $debug;
        $option = array();
        if ($debug)
        {
            $option = array('trace'=>1);
        }
        $this->client = new soapclient($serviceUrl, $option);
    }

    public function GetActivationCode($s, $k, $ids) {
        var_dump($this->client->__getFunctions());
        $arr = array();
        $arr["SourceName"] = $s;
        $arr["Password"] = $k;
        $arr["SiteIDs"] = $ids;
        var_dump($arr);
        $this->client->GetActivationCode($arr);
    }

}

$activate = new MBActivateService();

$result = $activate->GetActivationCode("She3", "private api key", array("28856"));

var_dump($result);

?> 
```

**总体的目标**

这是总体目标，以防有人可以提供更好的解决方案。我需要发送以下 SOAP 请求：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns="http://clients.mindbodyonline.com/api/0_5">
   <soapenv:Header/>
   <soapenv:Body>
      <GetActivationCode>
         <Request>
            <SourceCredentials>
               <SourceName>XXXX</SourceName>
               <Password>XXXX</Password>
               <SiteIDs>
                  <int>XXXX</int>
               </SiteIDs>
            </SourceCredentials>
         </Request>
      </GetActivationCode>
   </soapenv:Body>
</soapenv:Envelope> 
```

我需要发送`SourceName`、`Password`和`SiteIDs`(array) 的选项。

提前感谢您的任何意见！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:47:54.910

这听起来很熟悉。我会尝试的第一件事是将你的函数重写为：

```
public function GetActivationCode($params) {
    var_dump($this->client->GetActivationCode(array(
        'Request' => array(
            'SourceCredentials' => $params
        ),
    )));
} 
```

此外，要调试，您可以将其添加到`SoapClient`构造函数的选项中：

```
array(
    'trace' => true,
) 
```

这样你就可以`$this->client->__getLastRequest()`调试你的代码。

# javascript - 防止元素包裹

> ID：12162692
> 
> 赞同：0
> 
> 时间：2012-08-28T15:33:29.833
> 
> 标签：javascript, jquery, html, css, dom

`HTMLElement`防止包装的“最佳”方式或“最佳实践”是什么？

我实际上是在谈论`relative`定位元素。我认为您可以只使用`absolute`元素并将它们的`left`位置附加到`anotherElement.width`.

示例：http: [//jsfiddle.net/YX4cm/](http://jsfiddle.net/YX4cm/)

这个例子使用了一种`float:left`样式，但是当右侧没有足够的空间时，它也会包裹新的元素。

所以我的问题是：

*   有没有办法完全拒绝包装？
*   如果是这样，最好的做法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:40:18.770

`white-space: nowrap`和的组合`display: inline-block`似乎有效：http: [//jsfiddle.net/YX4cm/2/](http://jsfiddle.net/YX4cm/2/)

编辑：也适用于身体[http://jsfiddle.net/YX4cm/5/](http://jsfiddle.net/YX4cm/5/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:41:07.870

一种方法是使用双容器系统，将内部容器设置为绝对位置，这样您就不必实际接触内部重复元素的样式。

**小提琴：http: [//jsfiddle.net/3kB3D/](http://jsfiddle.net/3kB3D/)**

HTML：

```
<div id='container'>
    <ul>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
    </ul>
</div> 
```

CSS：

```
#container { width: 200px; background: black; height: 50px; padding: 10px; }
ul { position: absolute; }
li { float: left; margin-right: 12px; width: 50px; height: 50px; background: red; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T16:17:20.087

您可以将元素包装在一个容器元素中，该元素是绝对定位并具有 css 属性`min-width:[large value]`，如[this fiddle所示](http://jsfiddle.net/KooiInc/2K5Nz/)

# jsf - 如何从 Servlet 设置请求属性并从 JSF (xhtml) 页面检索它们

> ID：12162696
> 
> 赞同：2
> 
> 时间：2012-08-28T15:33:46.560
> 
> 标签：jsf, servlets

我一直在阅读[这个类似的 SO question](https://stackoverflow.com/questions/550448/get-request-and-session-parameters-and-attributes-from-jsf-pages)，但建议的一些方法似乎对我不起作用。我的堆栈是**JSF2.0** (+ PrimeFaces)，我部署到**JBoss 7 AS**。

有一个**Servlet**将请求分派到**xhtml**页面（在同一个**war 中**），但后者无法检索那里设置的属性值。

这是 Servlet 代码片段：

```
protected void doPost(HttpServletRequest request, HttpServletResponse response)
 throws ServletException, IOException {
    (...)
    request.setAttribute("foo", "foo test");
    RequestDispatcher dispatcher = getServletContext().getRequestDispatcher(url);
    dispatcher.forward(request, response);                                    
} 
```

这是**xhtml**页面上的代码：

```
<p><h:outputText value="#{sessionScope['foo']}" /></p>   
<p><h:outputText value="#{param['foo']}" /></p>                          
<p><h:outputText value="#{request.getParameter('foo')}" /></p> 
```

其中在这三种情况中的任何一种情况下都没有出现。

DID 的工作是使用支持 bean（如对参考 SO 文章的响应中所建议的那样），其中属性是在**@PostConstruct**方法中获得的，如下所示：

```
@PostConstruct
public void init() {
    HttpServletRequest request = (HttpServletRequest)FacesContext.getCurrentInstance()
                                               .getExternalContext().getRequest();
    message = (String) request.getAttribute("foo");
} 
```

...其中检索到的值随后在**xhtml**页面中可用。

但是为什么一种方法有效，而另一种无效？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T16:16:30.050

问题是您在 servlet 的请求范围内设置了一个属性，但在您正在编写`request.getParameter("foo")`并`sessionScope['foo']`访问它的 xhtml 页面中。

在 xhtml 页面中写下：`#{requestScope.foo}`它会显示属性 foo 的值。

# php - 使用自定义 URL 结构显示特定类别中的表达式引擎条目

> ID：12162698
> 
> 赞同：0
> 
> 时间：2012-08-28T15:34:11.980
> 
> 标签：php, expressionengine, categories

让我解释一下，我有一个网站，我需要显示一个类别结构，一次显示一个类别深度，然后当达到最终深度时，它将显示该类别中的条目。

我设法做到这一点的唯一方法是使用 gwcodecategories。使用这个我将深度输出到 url 结构中，然后使用这个段来硬编码要在我的主页中显示的深度。否则 gwcodecategories 将显示每个深度，您实际上无法根据当前类别动态获取类别的当前深度。

这很好用，我可以循环遍历所有深度，但是当我达到最终深度时，我认为通过在我的 gwcode 代码中添加 {if no_results} 来输出该类别中的条目会很容易。但是现在这不起作用，因为我在我的 url 中添加了一个深度......我的 URL 结构现在是：

www.website.com/products/list/(depth)/category/(category url title)

无论 URL 是什么，如何显示条目？这是我的代码：

```
<div id="cat-filter">
<div id="products">
{exp:gwcode_categories 
    channel="product" 
    cat_url_title="{last_segment}" 
    depth="{if segment_3 == '1'}2{/if}{if segment_3 == '2'}3{/if}{if segment_3 == '3'}4{/if}{if segment_3 == '4'}5{/if}{if segment_3 == '5'}6{/if}" 
    style="linear" 
    id="category-items"
    }
    <div class="product-list{switch='|| no-margin'}"  onClick="location.href='{title_permalink='products/list/category/{cat_url_title}'}'">
        <a href="{path='products/view'}">
        {exp:imgsizer:size src="{cat_image}" width="190"}
        <img src="{sized}" width="{width}" alt="{title}" />
        {/exp:imgsizer:size}
        </a>

        <div class="prod-spacer"></div>
        <div class="product-info">
            <a href="{title_permalink='products/view'}"><p>{cat_name}</p></a>
            <a class="view-btn" href="{path='products/list/{depth}/category/{cat_url_title}'}">+ View Category</a>
        </div>
    </div><!-- END PRODUCTS LIST -->

    {if no_results}
    {embed="products/product_feed"}
    {/if}

{/exp:gwcode_categories}
</div><!-- END PRODUCTS -->
</div><!-- END CAT FILTER --> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:49:16.110

没关系对不起 - 让它工作！

将我的链接中的 {depth} 移动到 url 的末尾，因此 url 是：

www.website.com/products/list/category/（类别网址标题）/（深度）

这不会干扰 url 的表达式引擎解析，因为它位于 url 的末尾，然后我只是将 if 条件更改为 last_segment。

如果有人希望显示这样的类别，这是我在拔掉头发数小时后发现的唯一方法。

# php - FOSUserBundle - 将数组类型字段添加到用户实体

> ID：12162701
> 
> 赞同：1
> 
> 时间：2012-08-28T15:34:17.377
> 
> 标签：php, symfony, doctrine, fosuserbundle

使用 FOSUserBundle、Symfony2 和 Doctrine，我试图在用户实体中引入一个新字段。

到目前为止，我还没有遇到问题自定义用户实体以添加“正常”类型的字段，例如字符串、布尔值等...

但是现在我想添加一个“数组”类型的字段，只是我在其他实体中制作的。

这是我在用户实体中介绍的代码：

```
/**
 * @var array $archivedPackages
 *
 * @ORM\Column(name="archivedPackages", type="array")
 */
private $archivedPackages; 
```

但是，一旦我重新生成实体 ( `doctrine:generate:entities`) 后重新加载我的页面，我就会收到以下错误：

```
ConversionException: Could not convert database value "" to Doctrine Type array 
```

堆栈：

```
in /Users/pgbonino/Sites/Symfony/vendor/doctrine-dbal/lib/Doctrine/DBAL/Types/ConversionException.php line 46
at ConversionException::conversionFailed() in /Users/pgbonino/Sites/Symfony/vendor/doctrine-dbal/lib/Doctrine/DBAL/Types/ArrayType.php line 48
at ArrayType->convertToPHPValue() in /Users/pgbonino/Sites/Symfony/vendor/doctrine/lib/Doctrine/ORM/Internal/Hydration/SimpleObjectHydrator.php line 85
at SimpleObjectHydrator->_hydrateRow() in /Users/pgbonino/Sites/Symfony/vendor/doctrine/lib/Doctrine/ORM/Internal/Hydration/SimpleObjectHydrator.php line 43
at SimpleObjectHydrator->_hydrateAll() in /Users/pgbonino/Sites/Symfony/vendor/doctrine/lib/Doctrine/ORM/Internal/Hydration/AbstractHydrator.php line 99
at AbstractHydrator->hydrateAll() in /Users/pgbonino/Sites/Symfony/vendor/doctrine/lib/Doctrine/ORM/Persisters/BasicEntityPersister.php line 582
at BasicEntityPersister->load() in /Users/pgbonino/Sites/Symfony/vendor/doctrine/lib/Doctrine/ORM/EntityRepository.php line 181
at EntityRepository->findOneBy() in /Users/pgbonino/Sites/Symfony/vendor/bundles/FOS/UserBundle/Entity/UserManager.php line 69
at UserManager->findUserBy() in /Users/pgbonino/Sites/Symfony/vendor/bundles/FOS/UserBundle/Model/UserManager.php line 79
at UserManager->findUserByUsername() in /Users/pgbonino/Sites/Symfony/vendor/bundles/FOS/UserBundle/Model/UserManager.php line 141
at UserManager->loadUserByUsername() in /Users/pgbonino/Sites/Symfony/vendor/bundles/FOS/UserBundle/Model/UserManager.php line 127 
```

# string - 在 powershell 中将字符串转换为 24 小时时间格式

> ID：12162702
> 
> 赞同：4
> 
> 时间：2012-08-28T15:34:17.837
> 
> 标签：string, powershell, time

我在将一些字符串短时间值转换为 24 小时时间格式时遇到问题。

在脚本中，我有以下 foreach 循环来解析来自 a 的每一行数据`csv`：

```
Foreach ($Line in $Data) {
    $command.CommandText=$SQLCommandPre+ `
        "'"+$line."Reference" `
        +"','"+$line."Date" `
        +"','"$line."Business Hour".SubString(0,8) `
        +"','"+"{0:f2}" -f ($line."Total"/2) `
    +"','"+"{0:f0}" -f ($line."Number"/2) `
    +"')"
    [void] $command.ExecuteNonQuery()
} 
```

例如，我的源数据是：

```
0101,8/19/2012,12:00 AM - 12:59 AM,241.83,21 
```

目前在脚本中它只是上午 12 点，但我需要转换为 00:00。我尝试使用以下方法，但它对 powershell 创建的查询没有影响：

```
"{0:HH:mm}" -f ($line."Business Hour".SubString(0,8)) 
```

我一直无法找到另一种方法来达到我的目标。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-28T15:40:04.870

确保在尝试格式化之前将检索到的字符串转换为 [DateTime] 对象，例如：

```
C:\PS> "{0:HH:mm}" -f [datetime]'12:00 AM'
00:00 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:41:47.360

将有多种方法来实现这一点。这是我可能会这样做的方式：

```
$test = '0101,8/19/2012,12:00 AM - 12:59 AM,241.83,21'
([dateTime]$test.Split(',')[2].Split('-')[0]).ToString('HH:mm') 
```

如果需要，您可以调整如何获取子字符串。在这种情况下，我更喜欢拆分 .SubString() ，因为它更能容忍字符串长度的变化。

# permissions - CLLocationManager 每次都在 Mountain Lion 上请求许可

> ID：12162703
> 
> 赞同：1
> 
> 时间：2012-08-28T15:34:19.397
> 
> 标签：permissions, cllocationmanager, osx-mountain-lion

我的 Mac 应用程序在 Snow Leopard 和 Lion OS 版本上只询问一次位置许可。

但在 Mountain Lion 上，每次用户运行应用程序时都会询问。

如何解决这个问题？有没有办法请求操作系统获得永久许可？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T17:30:05.917

发现问题。

似乎 Mountain Lion 要求应用程序的二进制文件应位于“应用程序”文件夹中以保存权限。

我将应用程序拖到应用程序文件夹中，应用程序最后一次请求访问用户位置的权限，以后再也不访问了。

# wix - Wix Visual C++ Redistributables with Bootstrapper

> ID：12162704
> 
> 赞同：2
> 
> 时间：2012-08-28T15:34:29.307
> 
> 标签：wix, bootstrapper, redistributable

嗨，谁能告诉我如何`vcredist_x86.exe`在我的 wix 安装程序的引导程序中引用该文件。

我试过这个：

```
<ItemGroup>
<BootstrapperFile Include="vcredist_86">
  <ProductName>Microsoft Visual C++ Redistributables</ProductName>
</BootstrapperFile>
</ItemGroup>

 <Target Name="AfterBuild">
<GenerateBootstrapper ApplicationFile="$(TargetFileName)" ApplicationName="Server Setup" BootstrapperItems="@(BootstrapperFile)" ComponentsLocation="Relative" CopyComponents="True" OutputPath="$(OutputPath)" Path="C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bootstrapper\" />
 </Target> 
```

但我的错误是：

```
 warning MSB3155: Item 'vcredist_86' could not be located in 'C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bootstrapper\'. 
```

我认为这条线是问题所在，但我不知道要输入的正确名称，也无法在任何地方找到它：

```
<BootstrapperFile Include="vcredist_86"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T16:07:27.977

查看 C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bootstrapper\Packages 并找到相应的文件夹（例如：vcredist_x86）。然后打开 product.xml 文件并使用作为 ProductCode 列出的任何内容。

例如：

> ProductCode="Microsoft.Visual.C++.10.0.x86"

# azure-storage - CloudFx QueueListener 似乎对我不起作用。为什么？

> ID：12162709
> 
> 赞同：0
> 
> 时间：2012-08-28T15:34:51.947
> 
> 标签：azure-storage, cloudfx

我正在尝试将 Microsoft“发布”的 CloudFx 库与一组示例一起使用。关于该库以及应该如何使用它的文档非常少（除了服务总线），但我正在尝试使用 CHM 参考和示例。我试图复制他们在通过存储队列进行通信的简单生产者/消费者工作者角色中所做的事情，但我似乎无法让 CloudQueueListenerExtension 类按我希望的方式工作。首先，我围绕监听器编写了一个简单的包装类：

```
public class QueueListener<T>
{
    private readonly CloudQueueLocation _queueLocation;
    private readonly CloudQueueListenerExtension<T> _queueListenerExtension;
    private readonly IObserver<T> _observer;

    public static QueueListener<T> StartNew(IExtensibleComponent owner, string storageAccount, Action<T> action)
    {
        var location = new CloudQueueLocation()
                            {
                                StorageAccount = storageAccount,
                                QueueName = typeof(T).Name.ToLowerInvariant()
                            };
        return new QueueListener<T>(owner, location, action).Start();
    }

    protected QueueListener(IExtensibleComponent owner, CloudQueueLocation queueLocation, Action<T> action)
    {
        _queueLocation = queueLocation;
        _queueListenerExtension = new CloudQueueListenerExtension<T>(queueLocation, owner);
        _observer = Observer.Create(action);

        _queueListenerExtension.Subscribe(_observer);            
    }

    protected QueueListener<T> Start()
    {
        _queueListenerExtension.StartListener();
        return this;
    }
} 
```

然后我将它设置为主要工作角色，如下所示：

```
QueueListener<MyMessageType>.StartNew(this, storageAccountString,
         newMsg => _log.InfoFormat("Got {0}", newMsg)); 
```

我有一个将 MyMessageType 消息发布到队列的 Web 应用程序，但该操作从未执行。我在诊断日志中看到一些痕迹，表明侦听器指向了正确的存储帐户和正确的队列，我什至看到了对`ReliableCloudQueueStorage.Get`. 我无法构建示例，但我认为我正在以与示例完全相同的方式使用侦听器扩展。

关于可能发生什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T03:47:31.083

感谢您的精彩解释和代码片段。这对于故障排除非常有用。:-)

我们最近将 CloudFx 迁移到 Reactive Extensions 2.0，在我们进行迁移时，我们未能了解我们如何在队列侦听器组件内部处理可观察序列的一些细节。现在已经解决了这个问题，我刚刚推出了一个新版本的 NuGet 包 (1.3.0.1)，旨在解决您面临的挑战。

让我们知道您的进展情况。

瓦莱里

# date - Web API：在 URL 中传递日期时间（格式）

> ID：12162710
> 
> 赞同：1
> 
> 时间：2012-08-28T15:34:56.393
> 
> 标签：date, time, format, asp.net-web-api

我正在使用微软的 web api 来实现 REST API。

我想传递一个日期/时间值并选择 ISO 8601 格式。在我的请求中，我处理查询字符串中的“where 子句”（以指定所需的资源）。在这个过滤子句中，我处理与**ISO 8601**格式的字符串数字和日期时间的比较。

字符串用 ' 括起来

> 例如：'这是一个字符串'

数字只是数字/小数点：

> 例如 123 或 12.34

目前是这样指定日期时间：

> 日期'2007-12-24T18:21Z'

有没有更好的说法：“这是一个日期，而不是一个字符串”？我在标准化的封闭字符中搜索日期时间值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:45:03.600

我假设您像这样调用您的服务[http://someservice.com/resource/1346168537681/otherparam](http://someservice.com/resource/1346168537681/otherparam)

我会做这样的事情-以毫秒为单位获取时间-解码参数，对于日期，您可以简单地检查长度，或者如果您愿意，可以变得更健壮

# wpf - 在不使用 MVVM 的情况下实现双向 DataGrid 数据绑定

> ID：12162711
> 
> 赞同：2
> 
> 时间：2012-08-28T15:34:57.283
> 
> 标签：wpf, binding, datagrid

我会尽可能清楚地说明这一点，但我很清楚我可能问错了问题。我在 WPF (.NET 4.0) 中有一个 datagrd，我将它绑定到数据集中的数据表。相关的代码隐藏（在窗口加载时运行）是：

```
// create a connection to Top Trumps database
String cs = ConfigurationManager.ConnectionStrings["csTopTrumps"].ConnectionString;
SqlConnection cn = new SqlConnection(cs);

// create a new dataset
DataSet ds = new DataSet();

// open the connection (not strictly necessary, as the
// data adapter will do this when you use it anyway)
cn.Open();

// fill data table called Cards with contents of tblCard
SqlDataAdapter daCards = new SqlDataAdapter();
daCards.SelectCommand =
new SqlCommand("SELECT * FROM tblCard ORDER BY CardTitle", cn);
daCards.Fill(ds, "Cards");

// now set the data context for the entire window
this.DataContext = ds; 
```

我的数据网格定义开始：

```
<DataGrid ItemsSource="{Binding Tables[Cards]}" 
```

所有这些都很好，我理解。我现在想以两种方式进行数据绑定，以便在数据网格中所做的更改将更新回底层数据库。我知道我可以做到这一点的一种方法是获取已更改行的值并使用带有 Update 方法的 tableadapter 将所做的任何更改写回底层数据库（可能是在 SelectedCellsChanged 事件或类似事件上）。但是，任何这样的方法都很难实现，因为在 WPF 的代码隐藏中获取单元格值很困难（我的理解是这是错误的方法，因为我应该使用 WPF 框架，所以请帮助我）。

那么......我如何设置双向数据绑定来为我完成工作？我见过人们提到设置 datagrid 属性，例如：

```
SelectedItem="{Binding Path=SelectedIndex,Mode=TwoWay}" 
```

但我不明白如何让它与数据适配器和数据集一起使用。我不想要任何涉及 MVVM 或模型的解决方案，因为我没有使用这些（是的，我可能应该使用，我知道）。我还想避免大量复杂的 C# 代码，包括可观察的集合、通过控制层次结构递归搜索以查找父对象等。

我已经搜索了很长时间，我认为我所要求的确实存在 - 如果不存在，请告诉我它不存在，并为浪费您的时间道歉，温柔的读者！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:25:46.600

我完全不明白你。您希望避免使用 WPF 框架（可观察集合、绑定、递归搜索等），但您想找到一种使用 WPF 框架的方法。

首先你需要这些功能：

```
public static T GetVisualChild<T>(Visual parent) where T : Visual
{
    T child = default(T);
    int numVisuals = VisualTreeHelper.GetChildrenCount(parent);
    for (int i = 0; i < numVisuals; i++)
    {
        Visual v = (Visual)VisualTreeHelper.GetChild(parent, i);
        child = v as T;
        if (child == null)
        {
            child = GetVisualChild<T>(v);
        }
       if (child != null)
       {
           break;
       }
   }
       return child;
}

public static DataGridRow GetSelectedRow(this DataGrid grid)
{
    return (DataGridRow)grid.ItemContainerGenerator.ContainerFromItem(grid.SelectedItem);
}
public static DataGridRow GetRow(this DataGrid grid, int index)
{
    DataGridRow row = (DataGridRow)grid.ItemContainerGenerator.ContainerFromIndex(index);
    if (row == null)
    {
        // May be virtualized, bring into view and try again.
        grid.UpdateLayout();
        grid.ScrollIntoView(grid.Items[index]);
        row = (DataGridRow)grid.ItemContainerGenerator.ContainerFromIndex(index);
    }
    return row;
}

public static DataGridCell GetCell(this DataGrid grid, DataGridRow row, int column)
{
    if (row != null)
    {
        DataGridCellsPresenter presenter = GetVisualChild<DataGridCellsPresenter>(row);

        if (presenter == null)
        {
            grid.ScrollIntoView(row, grid.Columns[column]);
            presenter = GetVisualChild<DataGridCellsPresenter>(row);
        }

        DataGridCell cell = (DataGridCell)presenter.ItemContainerGenerator.ContainerFromIndex(column);
        return cell;
    }
    return null;
}

public static DataGridCell GetCell(this DataGrid grid, int row, int column)
{
    DataGridRow rowContainer = grid.GetRow(row);
    return grid.GetCell(rowContainer, column);
} 
```

现在 DataGrid 实际上有几乎有用的事件。它被称为 CellEditEnding。把它挂起来

```
private bool isManualEditCommit;
private void yourHandler(
  object sender, DataGridCellEditEndingEventArgs e) 
{
 if (!isManualEditCommit) 
 {
  isManualEditCommit = true;
  DataGrid grid = (DataGrid)sender;
  grid.CommitEdit(DataGridEditingUnit.Row, true);
  isManualEditCommit = false;
 } else {
    /* you can write foreach loop that would loop through all the DataGridCells
      with DataGridCell cell = grid.GetCell(row, col),
      you can recieve value like GetVisualChild<TextBlock>(cell).Text
      and update everything when you're at last value */
 }
} 
```

也读这个；[WPF DataGrid CellEditEnding - 数据集不更新直到行失去焦点](https://stackoverflow.com/questions/6246452/wpf-datagrid-celleditending-dataset-not-updating-till-row-lost-focus)

这是一个艰难的方法，但如果你有经验，你可以提供更好的代码。尝试搜索术语数据绑定、datagrid、datagridtemplatecolumn、双向绑定、cellEditEnding。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T12:49:43.157

好的，有点晚了，我想我有我想要的答案。数据网格绑定到数据表（在我的实例中）。这意味着您可以获取所选项目（可能是用户双击的行），将其转换为数据行，然后获取您感兴趣的字段。

```
private void DataGrid_MouseDoubleClick(object sender, MouseButtonEventArgs e) 
```

{

```
// turn the datagrid selected "item" into a data row
DataRowView dr = dg.SelectedItem as DataRowView;

// get at the value for any field (here it's the one called CARD) in the underlying datatable
string CardTitle = (string)dr["Card"];

// display it ...
MessageBox.Show("You are on card " + CardTitle); 
```

}

这将解决双击数据网格中的一行的问题，这就是我的想法。如果您正在使用类，则可以将所选项目转换为相关对象，并获取其属性。

我希望这可以帮助别人！

# android - 当我的应用程序被系统关闭时，它可以收到通知吗？

> ID：12162712
> 
> 赞同：2
> 
> 时间：2012-08-28T15:35:00.327
> 
> 标签：android

当我的 android 应用程序进入后台时，它可能会被系统关闭以回收资源。我可以检测到这一刻并运行一些代码吗？发生时是否有任何通知（调用方法）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:51:14.057

正确答案是“否”。当 Android 想要关闭您的应用程序以回收资源时，它只会**杀死您的进程**。就是这样。没有警告，没有回调，根本没有机会做任何事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T16:13:45.497

尝试从本机 (NDK/JNI) 库中捕获 SIGKILL。但是您几乎无法在信号处理代码中做任何有价值的事情；绝对不会回调到 Java 世界。信号处理程序受到 *nix 规则的严重限制。

你首先想要完成什么？所有合理的清理通常在活动终止代码 ( `onDestroy()`) 中执行。在大多数使用场景下，进程生命周期不应该是您关心的问题，因为它被明确记录为不可预测的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T15:38:31.657

的实现`onDestroy()`方法`Activity`。

请参阅[活动生命周期](http://developer.android.com/images/activity_lifecycle.png)

# asp.net - ASP:Menu : 需要应用 CSS 来制作项目符号列表

> ID：12162713
> 
> 赞同：0
> 
> 时间：2012-08-28T15:35:01.360
> 
> 标签：asp.net, css, aspmenu, aspmenu-control, bulletedlist

我正在使用 ASP:Menu，我希望菜单如下所示。请建议如何应用 CSS 以及我应该进行哪些更改？

产品

*   有存货
*   缺货

订单

*   订单
*   销售订单
    *   延期交货
    *   发票

ASP：菜单代码如下。

```
<asp:Menu runat="server" ID="Navigator" MaximumDynamicDisplayLevels="0" StaticDisplayLevels="3" 
Orientation="Vertical" DataSourceID="RelativeSiteMapDataSource"   /> 
```

Update1：​​由 ASP:menu 生成的当前 html 如下所示。

```
<ul class="Menu"> 
<li class="Menu-Leaf"><a href="prodxeon/products.aspx"; class="Menu-Link" title="Products">Products</a></li>
<li class="Menu-Leaf"><a href="prodxeon/orders.aspx"; class="Menu-Link" title="Orders">Orders</a></li> 
    <ul>
        <li class="Menu-Leaf"><a href="http://pdxeon/po.aspx" class="Menu-Link" title="Purchase Orders">Purchase Orders</a></li>
        <li class="Menu-Leaf"><a href="http://pdxeon/so.aspx" class="Menu-Link" title="Sales Orders">Sales Orders</a></li>
            <ul>    
                <li class="Menu-Leaf"><a href="http://pdxeon/Bso.aspx" class="Menu-Link" title="Back Orders">Back Orders</a></li>               
                <li class="Menu-Leaf"><a href="http://pdxeon/iso.aspx" class="Menu-Link" title="Invoices">Invoices</a></li>
            </ul>
    </ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:22:39.473

你可以使用这个 CSS：

```
ul.Menu {  margin:0 1.5em 1.5em 1.5em; }
ul.Menu li {     list-style-type:disc; }
ul.Menu ul {     margin:0 3em 1.5em 1.5em; } 
```

请记住，您的 HTML 已损坏。

```
<li class="Menu-Leaf"><a href="http://pdxeon/so.aspx" class="Menu-Link" title="Sales Orders">Sales Orders</a></li>
     <ul>   <--- this should be before the </li>. Lists must be nested. Any tag outside </li> is illegal. 
```

嵌套列表必须遵循以下模式：

```
<ul>
    <li>
       <ul>
           <li>...</li>
       </ul>
    </li>
</ul> 
```

这是 .NET 控件的问题之一 - 它们将您与 HTML 隔离得太远，为开发人员提供了方便的方法来快速完成工作，而无需了解 HTML 实际工作的基本原理。

# wolfram-mathematica - 列出所有定义了 `data[i_Integer]` 的 `i`

> ID：12162721
> 
> 赞同：0
> 
> 时间：2012-08-28T15:35:27.430
> 
> 标签：wolfram-mathematica

我正在读取一个`Get[]`包含分号分隔的子脚本定义序列的文件，如下所示：

```
data[1] = {stuff};
data[5] = {otherStuff};
data[99] = {yetMoreStuff}; 
```

以编程方式决定定义的值的最简洁方法是`i`什么`data[i]`？索引列表会很好，例如`{1, 5, 99}`.

一个 hacky 方法是遍历可能值的范围以查看哪些值没有头部“数据”（例如`Select[data/@Range[1,1000],(Not[MatchQ[#,_data]])?]`），但这并不吸引人，因为它不通用（例如，`data[dog] = "Max";`如果我们删除整数下标要求）并假设可以选择一个上限。它也会很慢并浪费内存。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T16:15:01.760

我仍然不在我的 Mathematica 机器上，但我`DownValues[data]`突然想到可能会返回一个规则列表，您可能很乐意操纵这些规则来摆脱`i`s. 也许是这样的；

```
Cases[DownValues[data],RuleDelayed[HoldPattern[data[i_Integer]],rhs_]:>i] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T12:54:33.043

```
data[1] = {stuff};
data[5] = {otherStuff};
data[99] = {yetMoreStuff};

Cases[
 DownValues @ data,
 _[_@_@x_Integer, _] :> x
] 
```

> ```
> {1, 5, 99} 
> ```

# vim - 在 vim 中移动视觉选择后回到最底线

> ID：12162728
> 
> 赞同：1
> 
> 时间：2012-08-28T15:35:56.970
> 
> 标签：vim

我经常在 vim 中进行视觉选择以移动右/左代码行。Vim 总是让我在轮班后排在最前面。**我想要的是一种到达最底线的简单方法。有没有办法做到这一点？**

例如

```
# before
  puts 'hello'
puts 'oops i messed up     # visual select to indent
puts 'and need to indent'  # visual select to indent
puts 'these three lines'   # visual select to indent

# after
  puts 'hello'
  puts 'oops i messed up    # cursor ends up here
  puts 'and need to indent'
  puts 'these three lines'  # but i want it here 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:48:58.670

```
`> 
```

标记将`'>`放置在最后一个视觉选择的末尾

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T04:41:01.067

当您对线条进行视觉选择时，`o`它将从顶部跳到底部并返回。

如果你有一个视觉块，`o`从左上角跳到右下角，然后返回。

# android - Android - 测试计费有效，但相同的代码不适用于实时应用

> ID：12162730
> 
> 赞同：0
> 
> 时间：2012-08-28T15:36:02.377
> 
> 标签：android

我正在尝试让 Android 计费工作。感觉我做对了，当我在我的设备上测试时，我得到了正确的行为，但是当我在实时应用程序上发布账单时，它就不能正常工作。

这是我所做的：

```
 @Override
    public void onPurchaseStateChange(PurchaseState purchaseState, String itemId,
            int quantity, long purchaseTime, String developerPayload) 
    {
        if (purchaseState == PurchaseState.PURCHASED) 
        {                
            // Product ids are "3" and "4"

            if ( itemId != null && itemId.trim().equals("android.test.purchased") )
            { 
               // DURING TESTING THIS WORKS AND GETS INTO THIS IF CASE  
       Intent myIntent = new Intent(ExtraHelpActivity.this, PsychologyActivity.class);
       ExtraHelpActivity.this.startActivity(myIntent);                
            }
            else
            if ( itemId != null && itemId.trim().equals("3") )
            {
               // WHEN THE USER BUYS PRODUCT WITH ID "3" FOR SOME REASON CODE DOES NOT GET HERE.

               Intent myIntent = new Intent(ExtraHelpActivity.this, PsychologyActivity.class);
       ExtraHelpActivity.this.startActivity(myIntent);
            }
            else
            if ( itemId != null && itemId.trim().equals("4") )
            {   
                Intent myIntent = new Intent(ExtraHelpActivity.this, NumberOfBusinessesActivity.class);
        ExtraHelpActivity.this.startActivity(myIntent); 
            }
        }
        else 
        if (purchaseState == PurchaseState.CANCELED) 
        {  
            // purchase canceled
        } 
        else 
        if (purchaseState == PurchaseState.REFUNDED) 
        {
            // user ask for a refund
        }
    } 
```

我这样称呼它：

```
Button psychology = (Button)findViewById(R.id.psychology); 

psychology.setOnClickListener(new Button.OnClickListener() 
{  
    public void onClick(View v) 
    { 
    if(mBillingService.checkBillingSupported(Consts.ITEM_TYPE_INAPP))
        { 
                                //OK
        } 
    else 
    {
             // Send them to the screen of the article.
         Intent myIntent = new Intent(ExtraHelpActivity.this, PsychologyActivity.class);
         ExtraHelpActivity.this.startActivity(myIntent);    
    }

    try
    {   
        if (mBillingService.requestPurchase(issueProductIdPsych, 
                              Consts.ITEM_TYPE_INAPP ,  null)) 
        {                         

            } 
    }
    catch ( Exception e )
    {   }
    }
}); 
```

有没有人知道为什么当 itemId 为“3”而不是有效的测试值时 onStateChange 方法不起作用？

谢谢！

# batch-file - 如何在不输入批处理文件的情况下进行用户输入

> ID：12162749
> 
> 赞同：4
> 
> 时间：2012-08-28T15:37:06.020
> 
> 标签：batch-file, cmd

我正在尝试运行一个需要用户输入“y/n”来执行进一步操作的批处理文件。我想调用这个批处理文件进行自动化，因为在自动化参数是或否需要在没有用户干预的情况下传递，知道如何实现它吗？

```
cmd /c setup.bat 
```

现在如果`setup.bat`运行“是或否”需要选择以获得所需的结果，因为现在这`setup.bat`在自动化期间被调用。有没有将“yes”参数作为输入传递给`setup.bat`?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T15:47:42.487

您可以使用像 < 之类的流运算符。在文件中每行写一个预期的答案（例如 foi）。使用 < 运算符将此文件传递给 setup.bat：

```
cmd /c setup.bat < foi 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-28T22:20:48.560

`y`使用下面的命令行通过模拟按键来自动回答“是” （将包括`ENTER`密钥）。

```
cmd /c echo y^> "%temp%\answer.tmp" ^& (setup.bat ^< "%temp%\answer.tmp") ^& del "%temp%\answer.tmp" 
```

通过模拟`n`键然后 ENTER` 键自动回答“否”。

```
cmd /c echo n^> "%temp%\answer.tmp" ^& (setup.bat ^< "%temp%\answer.tmp") ^& del "%temp%\answer.tmp" 
```

通过模拟“是”按键自动回答“是”，然后`ENTER`按键：

```
cmd /c echo yes^> "%temp%\answer.tmp" ^& (setup.bat ^< "%temp%\answer.tmp") ^& del "%temp%\answer.tmp" 
```

通过模拟“否”按键自动回答“否”，然后`ENTER`按键：

```
cmd /c echo no^> "%temp%\answer.tmp" ^& (setup.bat ^< "%temp%\answer.tmp") ^& del "%temp%\answer.tmp" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-12-31T08:41:04.423

我想这里最简单的解决方案是使用带有 cmd 的管道（ | ：读取一个命令的输出并将其写入另一个命令的输入。也称为管道）所以对你来说......

```
cmd /c echo Y | setup.bat 
```

其中 Y 将是您的提示输入，您希望自动按下

# xml - 如何创建和下载 XML 而不将其存储在服务器上

> ID：12162756
> 
> 赞同：1
> 
> 时间：2012-08-28T15:37:24.780
> 
> 标签：xml, vb.net, download, webforms, on-the-fly

我有一个**ASP.NET Web 窗体**应用程序。我想创建一个下载链接，让用户可以下载**XML 文件**。但是，文件不必存储在服务器上。

在我的**aspx**文件中，我有下载链接（放置在 GridView 中）：

```
 <asp:HyperLinField Text="Download" DataNavigateUrlFormatString="download.aspx?ProductId={0}" DataNavigateUrlFields="ProductId"> 
```

在**下载.aspx.vb**页面中：

```
Dim productId As String = Request.QueryString("productId")
Dim xmlDoc As String = _ProductServices.GetXmlDocPerId(productId)
Dim xdoc As XmlDocument = New XmlDocument()
xdoc.LoadXml(xmlLicense) 
```

现在我想创建一个文件，将 XML 内容放入其中并将其交付给用户，而不将其保存到服务器。我应该将 a`MemoryStream`与 a 结合使用`StreamReader`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T15:46:47.297

它可以很简单：

```
Private Sub SendResults()
         'Write the XML for the DataSet.
         Page.Response.ContentType = "text/xml"
         Page.Response.Output.Write(xmlContentAsString)
         Page.Response.End()
    End Sub 
```

本质上，您更改响应输出类型，并将 xmldocument 内容传递给输出。您实际上并没有在系统中创建文件，而是将响应流式传输到客户端。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T15:47:02.167

您无需创建文件 - 您的 .xml 文件中已有 XML 内容，`XmlDocument`您可以直接将其输出到浏览器。

未经测试的例子：

```
Response.ContentType = "application/xml"
Response.Clear()

xdoc.Save(Response.OutputStream)
Response.Flush() 
```

更新：

要让浏览器显示*下载*对话框，您只需添加一个`content-disposition`标题：

```
Response.AddHeader("Content-Disposition", "attachment; filename=some_name.xml"); 
```

# android - android LinearLayout 滚动太深

> ID：12162757
> 
> 赞同：0
> 
> 时间：2012-08-28T15:37:27.800
> 
> 标签：android, android-layout, android-linearlayout

我的布局滚动得太高。它滚动直到结束，甚至向上滚动，直到最后 4 行可见。

所以我的页面几乎没有文字 - 它太高了..有我的布局：

```
<LinearLayout
  xmlns:android="http://schemas.android.com/apk/res/android"
  android:orientation="vertical"
  android:layout_width="fill_parent"
  android:layout_height="fill_parent">

<include layout="@layout/title_bar" android:id = "@+id/title"/>
<ScrollView  
    android:layout_width="fill_parent"
    android:layout_height="360dp"
    android:layout_below="@id/title"
    >
<TableLayout 
    android:layout_width="wrap_content"
    android:layout_height="fill_parent"
    android:layout_gravity="center"
    >

     <TextView android:layout_width="fill_parent" android:layout_height="360dp"/>  

   <!-- <TableRow>
        <TextView
            android:paddingBottom="20dp"
            android:layout_span="4"  
            android:gravity="center_horizontal"         
            android:layout_width="fill_parent" 
            android:layout_height="wrap_content" 
            android:textSize="16dp"
            android:text="@string/btn_system_setup"
            />
    </TableRow> --> 

        <RadioGroup android:layout_height="wrap_content"
            android:layout_width="wrap_content"
            android:gravity="left">
            <RadioButton 
                    android:id="@+id/test_over_xdsl"
                    android:layout_width="wrap_content"
                    android:text="@string/test_over_xdsl"
                    />
            <RadioButton 
                    android:id="@+id/test_over_shdsl"
                    android:layout_width="wrap_content"
                    android:text="@string/test_over_shdsl"
                    />

            <RadioButton 
                    android:id="@+id/test_over_eth"
                     android:layout_width="wrap_content"
                    android:text="@string/test_over_eth"/>
        </RadioGroup>

    <TableRow
    >
        <TextView
            android:layout_width="fill_parent" 
            android:layout_height="wrap_content" 
            android:text="@string/ip_adress"
            />
        <EditText 
            android:gravity="center_horizontal" 
            android:layout_width="200dp" 
            android:layout_height="wrap_content"
            android:singleLine="true" 
            android:id="@+id/ip_adress"
            android:imeOptions="actionDone|flagNoExtractUi">
        </EditText>

        <TextView  
            android:layout_width="fill_parent" 
            android:layout_height="wrap_content" 
            android:text="@string/netmask"
            android:paddingLeft="20dp"
        />

        <EditText 
            android:gravity="center_horizontal"
            android:layout_height="wrap_content" 
            android:singleLine="true"
            android:id="@+id/netmask"
            android:imeOptions="actionDone|flagNoExtractUi"
            android:layout_width="200dp">
        </EditText>

    </TableRow>

    <TableRow
    >
        <TextView
            android:text="@string/default_gateway"
            android:layout_width="fill_parent" 
            android:layout_height="wrap_content" 
        />

        <EditText
            android:gravity="center_horizontal" 
            android:layout_height="wrap_content" 
            android:id="@+id/default_gateway"
            android:paddingRight="10dp"
            android:singleLine="true"
            android:imeOptions="actionDone|flagNoExtractUi"
            android:layout_width="200dp">
        </EditText>

        <TextView  
            android:layout_width="fill_parent" 
            android:layout_height="wrap_content" 
             android:paddingLeft="20dp"
             android:paddingRight="10dp"
            android:text="@string/primary_dns"
        />

        <EditText 
            android:gravity="center_horizontal"
            android:layout_height="wrap_content" 
            android:id="@+id/dns_server"
            android:singleLine="true"
            android:imeOptions="actionDone|flagNoExtractUi"
            android:layout_width="200dp">
        </EditText>

    </TableRow>

    <TableRow
    >
        <TextView
            android:text="@string/secondary_dns"
            android:layout_width="fill_parent" 
            android:layout_height="wrap_content" 
        />

        <EditText 
            android:gravity="center_horizontal"
            android:layout_height="wrap_content" 
            android:id="@+id/secondary_dns_server"
            android:singleLine="true"
            android:imeOptions="actionDone|flagNoExtractUi"
            android:layout_width="200dp">
        </EditText>

    </TableRow>

    <RadioGroup android:layout_height="wrap_content"
            android:layout_width="wrap_content"
            android:gravity="center">
            <RadioButton 
                    android:id="@+id/emulated"
                    android:layout_width="match_parent"
                    android:text="@string/emulated"
                    />

            <RadioButton 
                    android:id="@+id/through"
                     android:layout_width="match_parent"
                    android:text="@string/through"/>
        </RadioGroup>

    <RadioGroup 
            android:id="@+id/dhcp_radiogroup"
            android:visibility="gone"
            android:paddingLeft="30dp"
            android:layout_height="wrap_content"
            android:layout_width="wrap_content"
            android:gravity="center">
            <RadioButton 
                    android:id="@+id/dhcp_disabled"
                    android:layout_width="match_parent"
                    android:text="@string/disable_dhcp"
                    android:checked="true"
                    />

            <RadioButton 
                    android:id="@+id/dhcp_enabled"
                     android:layout_width="match_parent"
                    android:text="@string/enable_dhcp"/>
        </RadioGroup>

    <TableRow android:id = "@+id/start_stop"
                android:visibility="gone">
        <TextView
            android:layout_width="fill_parent" 
            android:layout_height="wrap_content" 
            android:text="@string/ip_adress_start"
            />
        <EditText 
            android:gravity="center_horizontal" 
            android:layout_width="200dp" 
            android:layout_height="wrap_content"
            android:singleLine="true" 
            android:id="@+id/ip_adress_start"
            android:imeOptions="actionDone|flagNoExtractUi">
        </EditText>

        <TextView  
            android:layout_width="fill_parent" 
            android:layout_height="wrap_content" 
            android:text="@string/ip_adress_end"
            android:paddingLeft="20dp"
        />

        <EditText 
            android:gravity="center_horizontal"
            android:layout_height="wrap_content" 
            android:singleLine="true"
            android:id="@+id/ip_address_end"
            android:imeOptions="actionDone|flagNoExtractUi"
            android:layout_width="200dp">
        </EditText>

    </TableRow>

    <TableRow
    >
        <TextView
            android:text="@string/change_date_time"
            android:layout_width="fill_parent" 
            android:layout_height="wrap_content" 
        />
       <TextView
            android:id="@+id/date_time"
            android:text=""
            android:layout_width="200dp" 
            android:layout_height="wrap_content" 
        />
        <Button 
            android:text="@string/set_time_and_date"
            android:layout_column="1"
            android:id="@+id/setTimeButton" 
            android:layout_width="wrap_content" 
            android:layout_height="wrap_content">
        </Button>

    </TableRow>

    <TableRow
    >
        <TextView
            android:text="@string/change_language"
            android:layout_width="fill_parent" 
            android:layout_height="wrap_content" 
        />
       <TextView
            android:id="@+id/language"
            android:text=""
            android:layout_width="200dp" 
            android:layout_height="wrap_content" 
        />
        <Button 
            android:text="@string/set_time_and_date"
            android:layout_column="1"
            android:id="@+id/setLanguageButton" 
            android:layout_width="wrap_content" 
            android:layout_height="wrap_content">
        </Button>

    </TableRow>

    <TableRow
    >
        <TextView
            android:text="@string/change_country"
            android:layout_width="fill_parent" 
            android:layout_height="wrap_content" 
        />
       <TextView
            android:id="@+id/country"
            android:text=""
            android:layout_width="200dp" 
            android:layout_height="wrap_content" 
        />
        <Button 
            android:text="@string/set_time_and_date"
            android:layout_column="1"
            android:id="@+id/setCountryButton" 
            android:layout_width="wrap_content" 
            android:layout_height="wrap_content">
        </Button>

    </TableRow>

    <TableRow
    >
        <TextView
            android:text="@string/hardware_type"
            android:layout_width="fill_parent" 
            android:layout_height="wrap_content" 
        />
       <TextView
            android:id="@+id/hardware_type_text"
            android:layout_width="200dp" 
            android:layout_height="wrap_content" 
        />

    </TableRow>

    <TableRow
    >
        <TextView
            android:text="@string/hardware_version"
            android:layout_width="fill_parent" 
            android:layout_height="wrap_content" 
        />
       <TextView
            android:id="@+id/hardware_version_text"
            android:layout_width="200dp" 
            android:layout_height="wrap_content" 
        />

    </TableRow>

    <TableRow
    >
        <TextView
            android:text="@string/software_version"
            android:layout_width="fill_parent" 
            android:layout_height="wrap_content" 
        />
       <TextView
            android:id = "@+id/software_version_text"
            android:text="@string/the_version"
            android:layout_width="200dp" 
            android:layout_height="wrap_content" 
        />

    </TableRow>

    <TableRow
    >
        <TextView
            android:text="@string/firmware_version"
            android:layout_width="fill_parent" 
            android:layout_height="wrap_content" 
        />
       <TextView
            android:id = "@+id/firmware_version_text"
            android:text="@string/the_version"
            android:layout_width="200dp" 
            android:layout_height="wrap_content" 
        />
    </TableRow>
</TableLayout>
</ScrollView> 
```

现在我想会有简单的解决方案建议。

# json - 在 Trigger.IO 中缓存 json

> ID：12162763
> 
> 赞同：1
> 
> 时间：2012-08-28T15:37:57.173
> 
> 标签：json, caching, trigger.io

有谁可以帮我在 Trigger.io 中缓存一个 json 字符串？我有很多 json 请求，我认为将它们缓存 1 小时是个好主意。根据关于 $.ajax 的 jquery 手册（Trigger.io 指向 forge.request.ajax 的本手册）没有缓存 jsonp 和脚本作为一种类型，但我在这里使用 json 所以我希望做一些缓存在上面。

我正在使用 forge.request.ajax，如下所示：

```
 forge.request.ajax({
    url: the_url_to_api,
    dataType: 'json',
    cache: true,
    success: function(data) {
      parsed_template = _.template( $('#sales_index_template').html(), {nowOnSale:     data.activeSales, soonOnSale: data.upcomingSales } );
      app.end_set_right_content(parsed_template);
    },
    error: function(error) {
    alert('Request for sales failed');
    }
  }); 
```

这是我在 API 中的 json 返回脚本的标头

*   日期 2012 年 8 月 28 日星期二 15:19:30 GMT
*   x-powered-by PHP/5.3.15
*   连接保活
*   内容长度 4294
*   杂注缓存
*   服务器 Apache/2.2.11 (Unix) mod_ssl/2.2.11 OpenSSL/0.9.8g PHP/5.3.15
*   内容类型应用程序/json；字符集=utf-8
*   缓存控制 max-age=3600
*   保活超时=5，最大值=100
*   2012 年 8 月 28 日星期二 16:19:30 GMT

使用上述设置，如果我查看 chrome 或 safaris 网络调试器，则不会进行缓存。也许有人可以帮助我解决我做错了什么？或者也许有人对在 Trigger.io 中进行缓存有更好的想法？

预先感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:50:22.630

在我最近开发的一个应用程序中，我缓存（在内存中）生成的 json，直到用户按下小“刷新”图标。我想我可以添加一个额外的用户偏好设置以在 x 天后自动过期。此外，我可以使用 trigger.io 将 json 保存到磁盘，而不是使用内存。

如果你想看看我是怎么做的，这里是应用程序（注意：我今天早上提交了几个未经测试的 tweeks）：

[https://github.com/dragthor/south-ridge-app](https://github.com/dragthor/south-ridge-app)

viewmanager.js 处理大部分的主干.js 模型缓存逻辑。基本上我照常做：

1.  模型在缓存中吗？
2.  如果是，则使用缓存模型。
3.  如果否，则绑定模型（通过 json）添加到缓存。
4.  使用它（返回的模型）。

# autoconf - 使用新库更新 configure.ac

> ID：12162764
> 
> 赞同：0
> 
> 时间：2012-08-28T15:37:57.523
> 
> 标签：autoconf

我正在尝试将 pcap 库添加到我的应用程序中。我需要将它添加到`configure.ac`文件中，但我不明白如何。

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T14:04:22.333

检查库是否存在并链接到它的标准方法是使用`AC_CHECK_LIB`. 例如：

```
AC_CHECK_LIB([pcap],[pcap_create]) 
```

您还应该检查标题：

```
AC_CHECK_HEADERS([pcap/pcap.h]) 
```

有一种观点主张使用`PKG_CHECK_MODULES`，但这不是必需的。只需添加`AC_CHECK_LIB`即可启用配置良好的系统来构建您的包。浏览旧版本的 libpcap 源代码，我发现 libpcap 做了正确的事情并且不提供 *.pc 文件，因此`PKG_CHECK_MODULES`在您的情况下不是一个选项，您可以放心地忽略这一段。

# castle-windsor - Castle Windsor 无法拦截为类实例注册的组件

> ID：12162769
> 
> 赞同：1
> 
> 时间：2012-08-28T15:38:25.480
> 
> 标签：castle-windsor

我在拦截注册到类实例的组件时遇到问题。

```
//this does not get intercepted
container.Register(Component.For<IService>().Instance(instanceService)
                                .Interceptors<Interceptor>()); 
```

如果我在不使用类实例的情况下注册组件，拦截器就可以工作

```
//this get intercepted
container.Register(Component.For<IService>().ImplementedBy<SampleService>()
                         .Interceptors<Interceptor>()); 
```

这是一个错误还是设计使然？

谢谢

这是单元测试代码。

```
 [Test]
    public void Test_Windsor_Interceptor_With_Instance_Component_Registration()
    {
        IService instanceService = new SampleService();

        var container = new WindsorContainer();
        container.Register(Component.For<Interceptor>());

        //this get intercepted
        container.Register(Component.For<IService>().ImplementedBy<SampleService>()
                            .Interceptors<Interceptor>());

        ////this does not get intercepted
        //container.Register(Component.For<IService>().Instance(instanceService)
        //                    .Interceptors<Interceptor>());

        var proxiedService = container.Resolve<IService>();

        proxiedService.DoSomething();

    }

    public class Interceptor : Castle.DynamicProxy.IInterceptor
    {
        public void Intercept(Castle.DynamicProxy.IInvocation invocation)
        {
            throw new System.NotImplementedException("Interceptor succesfully called but not implemented");
        }
    }

    public interface IService
    {
        void DoSomething();
    }

    public class SampleService : IService
    {
        public void DoSomething()
        {
            string dummy = string.Empty;
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T23:54:42.440

这是设计使然。如果您手动实例化对象，则不能指望 Windsor 连接拦截器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-03T05:42:20.797

实际上，您可以使用拦截器选择器拦截已注册的实例，但如果它以上述“风筝”的方式工作，那就太好了。就是这样。这个例子是特定于我的实现的，但是有足够的细节来解决你自己的使用。

```
StubISecurityService instance= new StubISecurityService();
Container.Register(Component.For<ISecurityService>().Instance(instance));

//Apply the interceptors.
Container.Kernel.ProxyFactory.AddInterceptorSelector(new InterceptorSelector<SecurityInterceptor>(model => model.Implementation == typeof(ExampleSecureService)));

IExampleSecureService exampleSecureService = Container.Resolve<IExampleSecureService>();

/// <summary>
/// A generic implementation of <see cref="IModelInterceptorsSelector"/> used to apply a single interceptor on matching types.
/// </summary>
/// <typeparam name="TInterceptor">The type of the interceptor.</typeparam>
public class InterceptorSelector<TInterceptor> : IModelInterceptorsSelector {
    private readonly Func<ComponentModel, bool> _selector;

    /// <summary>
    /// Initializes a new instance of the <see cref="InterceptorSelector{TInterceptor}"/> class.
    /// </summary>
    /// <param name="selector">The function used to find matching types.</param>
    public InterceptorSelector(Func<ComponentModel, bool> selector) {
        _selector = selector;
    }

    public virtual bool HasInterceptors(ComponentModel model) {
        bool isNotItself = typeof(TInterceptor) != model.Implementation;
        bool isMatch = _selector.Invoke(model);
        return isNotItself && isMatch;
    }

    public virtual InterceptorReference[] SelectInterceptors(ComponentModel model, InterceptorReference[] interceptors) {
        return new[] {InterceptorReference.ForType<TInterceptor>()};
    }
} 
```

# php - 使用 Uploadify 并遇到权限问题

> ID：12162774
> 
> 赞同：1
> 
> 时间：2012-08-28T15:38:44.003
> 
> 标签：php, html, permissions, uploadify

我正在使用 uploadify 将图像上传到服务器并将它们的文件名上传到数据库，然后使用 wordpress 动态生成将使用这些照片的页面。到目前为止，我所拥有的有时会起作用，有时却不起作用。

我希望uploadify 检查文件名是否已经存在（我将有数百个不同的用户上传图像），如果文件名匹配，我已经uploadify 返回一个错误，要求用户重命名文件。一旦文件成功上传。我删除了uploadify 按钮，并将文件名返回到将提交到我的数据库的隐藏字段。

然后我使用从数据库中提取的这个文件名来告诉 WP 在哪里查找文件。

但是，有时我会在创建的页面上成功查看文件，然后有时它会返回并告诉我禁止访问该文件。我已经阅读并发现了几个关于 uploadify 权限问题的案例，但我发现并尝试过的都没有成功。我尝试在uploadify.php 中添加一个chmod 命令，但没有成功。我尝试更改服务器上文件夹的权限，这对以后上传的文件没有任何影响。我不知道出了什么问题，甚至不知道从哪里开始解决问题。以下是我的 HTML（只是一个包含相关 uploadify 内容的摘录，因为完整的 HTML 页面非常大）和我的 uploadify.php 文件（有 2 个，因为我对每个文件都有不同的参数检查。

从标头上传脚本（两者）：

```
$(function() {
    $('#photo_upload').uploadify({
        'buttonText' : 'Select File',
        'multi'    : false,
        'method'   : 'post',
        'fileSizeLimit' : '100KB',
        'height'   : 20,
        'swf'      : 'uploadify-v3/uploadify.swf',
        'uploader' : 'uploadify-v3/uploadify.php',
        'onUploadStart' : function(file) {
                                           $('#photo_upload').uploadify('settings','formData',{'upName' : $('#usersName').val()});
                                         },
        'onUploadSuccess' : function(file, data) {
                            if(data == 'failed'){
                                alert('The file you attempted to upload failed.  Please check that the file meets all requirements, then try again. Thank you.');
                            } else if(data == 'FileNameExists'){
                                alert('An image with the same file name already exists.  Please rename the file to a different name, then try again. Thank you.');
                            } else{
                            $("#photo_upload").remove();
                            var starting = data.indexOf("upload-images");
                            var savedAs = data.substring(starting+14 , data.indexOf(".jpg"))+".jpg";
                            document.form.photo.value = savedAs;
                            }
                        }
        // Your options here
    });
    $('#logo_upload').uploadify({
        'buttonText' : 'Select File',
        'multi'    : false,
        'method'   : 'post',
        'fileSizeLimit' : '100KB',
        'height'   : 20,
        'swf'      : 'uploadify-v3/uploadify.swf',
        'uploader' : 'uploadify-v3/uploadify2.php',
        'onUploadStart' : function(file) {
                                           $('#logo_upload').uploadify('settings','formData',{'upName' : $('#usersName').val()});
                                         },
        'onUploadSuccess' : function(file, data) {
                            if(data == 'failed'){
                                alert('The file you attempted to upload failed.  Please check that the file meets all requirements, then try again. Thank you.');
                            } else if(data == 'FileNameExists'){
                                alert('An image with the same file name already exists.  Please rename the file to a different name, then try again. Thank you.');
                            } else{
                            $("#logo_upload").remove();
                            var starting = data.indexOf("upload-images");
                            var savedAs = data.substring(starting+14 , data.indexOf(".jpg"))+".jpg";
                            document.form.logo.value = savedAs;
                            }
                        }
        // Your options here
    });
}); 
```

HTML（这只是上传按钮和字段的相关 HTML）：

```
<span class="Form-Header">Upload Images</span>&nbsp;
    <br />
    <div id="Form-wrapper">
        <div id="Form-wrapper-left">
          Your Photograph:<br />
        </div>
        <div id="Form-wrapper-right">
          <input name="photo" type="hidden" id="photo" value="NULL"/>
          <input type="file" name="photo_upload" id="photo_upload" />

          (Image Dimensions: 300w x 420h, JPEG) (100kb Size Limit)
        </div>
        <div id="clear" style="clear:both;"></div>
        <br />
    </div>
    <div id="Form-wrapper">
        <div id="Form-wrapper-left">
          Your Logo:<br />
        </div>
        <div id="Form-wrapper-right">
          <input name="logo" type="hidden" id="logo" value="NULL"/>
          <input type="file" name="logo_upload" id="logo_upload" />
          (Image Dimensions: 450w x 65h, JPEG) (100kb Size Limit)
        </div>
        <div id="clear" style="clear:both;"></div>
    </div>
    <div id="Form-wrapper">
      <div id="Form-Footer"><strong>Next: </strong> Go <a href="#top">to the top of the page</a> and click on &quot;Profile Information&quot; to continue.<br />
        </div>
        <div id="clear" style="clear:both;"></div>
    </div> 
```

最后，但同样重要的是，这里是我的uploadify1 和uploadify2 的PHP 页面（我只显示一个，因为它们除了大小要求之外都是相同的）：

```
<?php
// Define a destination
$targetFolder = '/Eye-Doctors/upload-images'; // Relative to the root

if (!empty($_FILES)) {
    $tempFile = $_FILES['Filedata']['tmp_name'];

    $size = getimagesize($tempFile);
    if($size[0] <= 300 && $size[1] <= 420){

          $targetPath = $_SERVER['DOCUMENT_ROOT'] . $targetFolder;
          $targetFile = rtrim($targetPath,'/') . '/' . $_FILES['Filedata']['name'];

          // Validate the file type
          $fileTypes = array('jpg'); // File extensions
          $fileParts = pathinfo($_FILES['Filedata']['name']);

          if (in_array($fileParts['extension'],$fileTypes)) {

                       $exists = 0;
                        if( file_exists($targetFile) ) {
                                $exists = 1;
                                echo 'FileNameExists';

                        }
              if($exists == 0){
                move_uploaded_file($tempFile,$targetFile);
                echo $targetFile;
              }

          } else {
              echo 'failed';
          }

    } else{
        echo 'failed';
        }
}
?> 
```

我真的希望这是足够的信息来获得一些帮助。我已经尝试到处寻找解决方案，但仍然找不到。如果还有什么我可以提供的帮助，请告诉我。

# regex - PCRE 正则表达式辅助 - 数字范围，减去一个数字

> ID：12162782
> 
> 赞同：1
> 
> 时间：2012-08-28T15:39:19.933
> 
> 标签：regex, pcre

我正在尝试为 400-699 范围内的所有 SIP 代码解析 SIP 消息，但 401 除外（它用于客户端身份验证并用垃圾填充我们的日志）。

消息看起来像这样（小子集，有大量代码，我想避免将它们全部列出）：

```
SIP/2.0 400 Bad Request
SIP/2.0 401 Unauthorized
SIP/2.0 500 Internal Server Error
SIP/2.0 604 Does not exist anywhere 
```

这是我当前的正则表达式（不起作用，仍在尝试解决这个问题，所以如果它不是最优雅的，请原谅）

```
(?m)^SIP/2\.0\s(400|40[2-9]|4[1-90-9]|[5-60-90-9]).*$ 
```

如果没有找到一堆 PHP 信息，我似乎无法确定 PCRE 是否支持字符类减法。任何帮助使这项工作真正有用。谢谢！！！

编辑：刚刚修改了正则表达式。我更近了，但它仍然包含 401 消息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T16:08:25.023

[1-90-9] 等于 [0-9] 似乎您的想法有所不同，请解释一下您的期望

# sql-server - 跨 2 个数据库连接 4 个表

> ID：12162784
> 
> 赞同：1
> 
> 时间：2012-08-28T15:39:25.203
> 
> 标签：sql-server, stored-procedures

`TB1, TB2, TB3`在服务器上的一个数据库中，`TB4`在另一个数据库中。

join需要的列信息如下：

*   TB1 - a1、b2 列。
*   TB2 - a2、b2、c3 列。
*   TB3 - a3 栏。
*   TB4 - a4 栏。

`TB1, TB2, TB3`由`ID` TB1 的 ID 相关联的是主键和 TB2、TB3 和 TB4 中的外键

我正在使用 SQL Server Management Studio

代码：

从 TB1、TB2、TB3 中选择 ID，其中 TB1.ID = TB2.TB1.ID

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:51:15.017

你可以像这样链接它们（不要忘记把你错过的关系说出来）：

```
SELECT t1.a1, t1.b2, t2.a2, t2.b2, t2.c3, t3.a3, t4.a4
FROM db1..TB1 t1
INNER JOIN db1..TB2 t2 ON t1.ID = t2.ID
INNER JOIN db1..TB3 t3 ON t1.ID = t3.ID
INNER JOIN db2..TB4 t4 ON --put relation here 
```

还要用每个表所在的数据库名称替换`db1`和`db2`。

* * *

最后一点，您的代码提供了冗余信息，因为您没有做出所有限制。因此，产生了笛卡尔积。

# javascript - 向本地存储添加新对象

> ID：12162786
> 
> 赞同：25
> 
> 时间：2012-08-28T15:39:31.887
> 
> 标签：javascript, html, local-storage

我正在尝试使用本地存储制作购物车前端，因为有一些模式窗口，我需要在那里传递购物车项目信息。每次单击添加到购物车时，它都会创建对象并将其添加到本地存储。我知道在尝试多种解决方案后，我需要将所有内容放入数组并将新对象推送到数组 - 无法使其正常工作

这就是我所拥有的（仅保存最后一个对象）：

```
var itemContainer = $(el).parents('div.item-container');
var itemObject = {
    'product-name': itemContainer.find('h2.product-name a').text(),
    'product-image': itemContainer.find('div.product-image img').attr('src'),
    'product-price': itemContainer.find('span.product-price').text()
};

localStorage.setItem('itemStored', JSON.stringify(itemObject)); 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-08-28T15:49:17.123

您每次都覆盖其他对象，您需要使用一个数组来保存它们：

```
var oldItems = JSON.parse(localStorage.getItem('itemsArray')) || [];

var newItem = {
    'product-name': itemContainer.find('h2.product-name a').text(),
    'product-image': itemContainer.find('div.product-image img').attr('src'),
    'product-price': itemContainer.find('span.product-price').text()
};

oldItems.push(newItem);

localStorage.setItem('itemsArray', JSON.stringify(oldItems)); 
```

[http://jsfiddle.net/JLBaA/1/](http://jsfiddle.net/JLBaA/1/)

您可能还需要考虑使用对象而不是数组，并使用产品名称作为键。这将防止在 localStorage 中出现重复条目​​。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-17T18:36:47.683

它与本地存储没有直接关系，但现在，使用 React/Angular 是一种很好的做法。这是一个例子：

```
var TodoItem = React.createClass({
  done: function() {
    this.props.done(this.props.todo);
  },

  render: function() {
    return <li onClick={this.done}>{this.props.todo}</li>
  }
});

var TodoList = React.createClass({
  getInitialState: function() {
    return {
      todos: this.props.todos
    };
  },

  add: function() {
    var todos = this.props.todos;
    todos.push(React.findDOMNode(this.refs.myInput).value);
    React.findDOMNode(this.refs.myInput).value = "";
    localStorage.setItem('todos', JSON.stringify(todos));
    this.setState({ todos: todos });
  },

  done: function(todo) {
    var todos = this.props.todos;
    todos.splice(todos.indexOf(todo), 1);
    localStorage.setItem('todos', JSON.stringify(todos));
    this.setState({ todos: todos });
  },

  render: function() {
    return (
      <div>
        <h1>Todos: {this.props.todos.length}</h1>
        <ul>
        {
          this.state.todos.map(function(todo) {
            return <TodoItem todo={todo} done={this.done} />
          }.bind(this))
        }
        </ul>
        <input type="text" ref="myInput" />
        <button onClick={this.add}>Add</button>
      </div>
    );
  }
});

var todos = JSON.parse(localStorage.getItem('todos')) || [];

React.render(
    <TodoList todos={todos} />,
    document.getElementById('container')
); 
```

从[这里](https://jsfiddle.net/kyanny/1guv5g4w/)

# jquery - ASP.Net & JQuery Document.ready：不触发

> ID：12162787
> 
> 赞同：1
> 
> 时间：2012-08-28T15:39:38.397
> 
> 标签：jquery, asp.net

所以我有一个母版页，它在 Page_Load 事件中手动包含一些 javascript，如下所示：

```
Page.ClientScript.RegisterClientScriptInclude("site.master", ResolveUrl("~/Scripts/site.master.js")); 
```

我将 $(document).ready() 放在脚本的开头，期望在包含它时它会正确绑定，它确实如此。

问题是它不会在回发时触发 $(document).ready() （不涉及 AJAX）。我使用的解决方案是将其包装成一个 init 函数，然后通过母版页 .aspx 文件调用该 init 函数。它有效并且不是那么脏，但我很困惑。

我知道浏览器会缓存文件，但我原以为它仍然会在每个请求上执行，但它似乎并没有这样做。

有人可以解释为什么，或者如果我没有看到我认为我看到的东西，也可以解释一下吗？

我在 Chrome 浏览器上看到了这种行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:51:24.173

您在哪里注册了以下这些行？

```
Page.ClientScript.RegisterClientScriptInclude("site.master", ResolveUrl("~/Scripts/site.master.js")); 
```

您是否仅在当前请求不是回发时有条件地注册？那将是愚蠢的。每次需要提供整页时都需要注册。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:45:35.983

在您的 Masterpage 中，您是否在包含您自己的 JavaScript 文件之前包含了 JQuery？

这种情况通常发生在 JQuery 加载得太晚的过程中。

# jquery - 父 div 之外的目标 div 类

> ID：12162788
> 
> 赞同：0
> 
> 时间：2012-08-28T15:39:43.987
> 
> 标签：jquery, class, target

如何在 jquery 中指定`a`目标类？`contenido_calendario`

```
<div class="col1 sub_section_title">
    <article>
        <h3 class="article_header calendari">2012</h3>
    </article>
    <a href="#" class="button arrow_back_but" rel="tooltip" title="Click Aquí"></a>           
</div> 
```

这是我的代码：

```
$("a").click( function() {    
    $(".contenido_calendario").hide();
    $(this).children(".contenido_calendario").toggle();
}); 
```

但它不起作用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:41:55.210

如果您的锚标签中确实有某些内容，您可能想尝试：

```
$(this).find(".contenido_calendario").toggle(); 
```

因为`.children()`只针对*直系后代*- 我猜这*不是*`.contenido_calendario`点击锚的直系后代。

 *编辑（根据您的评论“它是 'col1 sub_section_title' div 之外的下一个 div，对不起，我把它放在问题中”）：

```
$(this).closest(".sub_section_title").next().toggle(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:45:58.243

鉴于添加到您的帖子中的信息，我建议（尽管未经测试）：

```
$('a').click(
    function(e){
        e.preventDefault();
        $(this).closest('div').next().toggle();
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T15:44:12.370

你忘记了 preventDefault
没有它你正在刷新你的页面

```
$("a").click( function(event) { 
   event.preventDefault();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T15:44:45.233

您的链接没有孩子。所以：

```
$(this).children(".contenido_calendario").toggle(); 
```

什么也找不到。因为 $(this) 是指您的链接元素。*

# grails - 有没有办法在 Grails 的 message.properties 文件中将消息链接在一起？

> ID：12162791
> 
> 赞同：2
> 
> 时间：2012-08-28T15:39:49.410
> 
> 标签：grails

在 Grails 中有一个`message.properties`文件。在此文件中，消息定义如下：

```
exampleClass.fieldOne.label=Field One

otherExampleClass.fieldOne.label=Field One 
```

我希望能够使用这两条消息，即使它们在文本上是相同的。我想这样定义它们：

```
exampleClass.fieldOne.label=Field One

otherExampleClass.fieldOne.label=${message(code: 'exampleClass.fieldOne.label')} 
```

...但这只是调用`otherExampleClass.fieldOne.label`返回字符串`${message(code: 'exampleClass.fieldOne.label')}`而不是所需的字符串`Field One`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T03:04:52.603

在 message.properties 中，我认为您不能这样做，但也许通过约定和修改 Grails 的模板，您可以实现它。所以我的想法是：

为您的消息定义一个约定（例如，使用一些特殊字符初始化消息）

```
exempleClass.fieldOne.label=FieldOne
otherExampleClass.fieldOne.label=#exempleClass.fieldOne.label 
```

创建一个 TagLib 来处理消息

```
class MyTagLib {
  static namespace = "my"
  def inheritedMessage = { attrs, body -> 
    String message = g.message(attrs)
    if(message.startsWith("#")) {
      //get the other message...
    }
    out << message
  }
} 
```

最后[安装模板](http://grails.org/doc/latest/ref/Command%20Line/install-templates.html)并更改`<g:message/>`for`<my:inheritedMessage/>`或您所称的任何内容。

对于第 2 步，另一种方法是覆盖`g.message()`，其好处是不需要第 3 步，并为您的应用程序的所有部分提供修改。缺点是它必须有良好的文档记录和传播，否则可能会在其他开发人员中引起一些混乱。

**编辑**

为了涵盖所有消息，我认为更好的方法是自定义 Grails 使用的 messageResource。[这](https://stackoverflow.com/questions/10623388/override-springmessage-tag-with-database-values)是一个问题，涵盖了如何使用 Spring 从数据库中获取消息，这可能是一个起点。这是一个[问题](https://stackoverflow.com/questions/1522568/create-a-new-resource-bundle-in-grails)，显示了如何替换 Grails 中的 bean。

# python - 如何在没有 python 的情况下（交叉）编译 boost？

> ID：12162793
> 
> 赞同：21
> 
> 时间：2012-08-28T15:39:54.277
> 
> 标签：python, boost, cross-compiling

我的嵌入式设备有一个 gcc 4.3.3 工具链，但我没有 python（也不需要它）。

我正在寻找一种在没有 python 的情况下配置 boostbuild 的方法（编译和交叉编译）。

python是强制性的吗？

我必须编译除 boost-python 之外的每个部分吗？（我希望不是）。

提前致谢。

**我所做的一切都要感谢木星**

```
./bootstrap.sh --without-libraries=python
./b2
```

我得到了

```
组件配置：

    - 计时：建筑
    - 上下文：建筑
    - 日期时间：建筑
    - 例外：建筑
    - 文件系统：构建
    - 图：建筑
    - graph_parallel：建筑
    - iostreams：建设
    - 语言环境：建筑
    - 数学：建筑
    - mpi：建筑
    - 程序选项：建筑
    - 蟒蛇：不建设
    - 随机：建筑
    - 正则表达式：建筑
    - 序列化：建筑
    - 信号：建筑
    - 系统：建筑
    - 测试：建筑
    - 线程：建筑
    - 计时器：建筑
    - 波：建筑

```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-28T21:51:25.223

查看 --without-* bjam 选项，例如 --without-python

# c# - WMI ManagementObjectSearcher 挂起查询

> ID：12162797
> 
> 赞同：7
> 
> 时间：2012-08-28T15:40:11.287
> 
> 标签：c#, .net, wmi

我有一个 WMI 查询，使用 ManagementObjectSearcher。

通常，这可以正常工作，但在某些机器上，它会挂起/永远不会返回。我尝试在查询上设置超时，但似乎没有什么区别。

这是我的代码：

```
using (var query = new ManagementObjectSearcher("SELECT IDProcess, PercentProcessorTime, WorkingSet FROM Win32_PerfFormattedData_PerfProc_Process"))
{
   try
   {
        query.Options.Timeout = new TimeSpan(0, 0, 10);
        query.Options.ReturnImmediately = false;
        Log.Info("Query built");
        foreach (ManagementObject obj in query.Get())
        {
            using (obj)
            {
                var key = (uint)obj.GetPropertyValue("IDProcess");
                Log.Info(key);
                processStats[key] = new ulong[] { (ulong)obj.GetPropertyValue("PercentProcessorTime"), (ulong)obj.GetPropertyValue("WorkingSet") };
            }
        }
    }
} 
```

在我的日志中，我看到“查询已构建”，然后什么也没有，程序变得无响应。

我尝试过使用和不使用手动超时设置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-19T08:48:27.337

最近我们在“C# 命令行”测试了 WMI 查询，WMI 按预期工作，但是在 WPF 中重写后，我们遇到了和你一样的问题。经过一些研究，我发现如果您在 STA（单线程公寓模式）下运行，但 WPF 在 STA 模式下运行，WMI 会挂起，因此要执行我们使用 ThreadPool 的任务（重写您的案例）：

```
 ThreadPool.QueueUserWorkItem((_) =>
            {
                using (var query = new ManagementObjectSearcher("SELECT IDProcess, PercentProcessorTime, WorkingSet FROM Win32_PerfFormattedData_PerfProc_Process"))
                {
                    try
                    {
                        query.Options.Timeout = new TimeSpan(0, 0, 10);
                        query.Options.ReturnImmediately = false;
                        Log.Info("Query built");
                        foreach (ManagementObject obj in query.Get())
                        {
                            using (obj)
                            {
                                var key = (uint)obj.GetPropertyValue("IDProcess");
                                Log.Info(key);
                                processStats[key] = new ulong[] { (ulong)obj.GetPropertyValue("PercentProcessorTime"), (ulong)obj.GetPropertyValue("WorkingSet") };
                            }
                        }
                    }
                    catch (SystemException)
                    {
                    }
                }
            }); 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-09-20T23:12:44.377

它应该在没有“使用”的情况下工作

```
var query = new ManagementObjectSearcher("SELECT IDProcess, PercentProcessorTime, WorkingSet  FROM Win32_PerfFormattedData_PerfProc_Process");
try
{
    query.Options.Timeout = new TimeSpan(0, 0, 10);
    query.Options.ReturnImmediately = false;
    log.Info("Query built");
    foreach (ManagementObject obj in query.Get())
    {
        using (obj)
        {
            var key = (uint)obj.GetPropertyValue("IDProcess");
            Log.Info(key);
            processStats[key] = new ulong[] { (ulong)obj.GetPropertyValue("PercentProcessorTime"), (ulong)obj.GetPropertyValue("WorkingSet") };
        }
    }
 } 
```

# hibernate - GWT / Hibernate NullPointerException

> ID：12162804
> 
> 赞同：0
> 
> 时间：2012-08-28T15:40:27.203
> 
> 标签：hibernate, gwt

试图找出这个 NullPointerException。我有一个使用 Hibernate 3 的 GWT 2.5 项目。现在应用程序在通过休眠调用存储过程时可以工作，但是在使用 Session.save() 保存新实体时出现错误。

我无法弄清楚什么是空的。我目前没有在 bean 中使用验证，并且我确保所有字段在实体中都有一个默认值，因此没有空字段。

有人熟悉这种类型的错误吗？我必须获得许可才能发布该项目的代码，但非常感谢任何能指出我正确方向的东西。

```
java.lang.NullPointerException
    at org.hibernate.cfg.beanvalidation.BeanValidationEventListener.validate(BeanValidationEventListener.java:131)
    at org.hibernate.cfg.beanvalidation.BeanValidationEventListener.onPreInsert(BeanValidationEventListener.java:94)
    at org.hibernate.action.EntityIdentityInsertAction.preInsert(EntityIdentityInsertAction.java:160)
    at org.hibernate.action.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:65)
    at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:273)
    at org.hibernate.event.def.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:320)
    at org.hibernate.event.def.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:203)
    at org.hibernate.event.def.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:129)
    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.saveWithGeneratedOrRequestedId(DefaultSaveOrUpdateEventListener.java:210)
    at org.hibernate.event.def.DefaultSaveEventListener.saveWithGeneratedOrRequestedId(DefaultSaveEventListener.java:56)
    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.entityIsTransient(DefaultSaveOrUpdateEventListener.java:195)
    at org.hibernate.event.def.DefaultSaveEventListener.performSaveOrUpdate(DefaultSaveEventListener.java:50)
    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.onSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:93)
    at org.hibernate.impl.SessionImpl.fireSave(SessionImpl.java:713)
    at org.hibernate.impl.SessionImpl.save(SessionImpl.java:701)
    at org.hibernate.impl.SessionImpl.save(SessionImpl.java:697)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.hibernate.context.ThreadLocalSessionContext$TransactionProtectionWrapper.invoke(ThreadLocalSessionContext.java:345)
    at $Proxy33.save(Unknown Source)
    at org.afscme.outreach.external.server.ConferenceServiceImpl.saveReservation(ConferenceServiceImpl.java:117)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:561)
    at com.google.gwt.user.server.rpc.RemoteServiceServlet.processCall(RemoteServiceServlet.java:208)
    at com.google.gwt.user.server.rpc.RemoteServiceServlet.processPost(RemoteServiceServlet.java:248)
    at com.google.gwt.user.server.rpc.AbstractRemoteServiceServlet.doPost(AbstractRemoteServiceServlet.java:62)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:487)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:362)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:729)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:405)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.handler.RequestLogHandler.handle(RequestLogHandler.java:49)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.Server.handle(Server.java:324)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:505)
    at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:843)
    at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:647)
    at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:211)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:380)
    at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:395)
    at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:488) 
```

**更新＃1：**

图书馆：感谢@ChrisHinshaw 的回复。我包含以下库：

*   休眠3
*   hibernate-jpa-2.0-api-1.0.0-Final
*   gwt-验证-2.1
*   antlr-2.7.6
*   slf4j-api-1.6.6
*   slf4j-log4j12-1.6.6-来源
*   slf4j-simple-1.6.6
*   commons-collections-3.1
*   dom4j-1.6.1
*   javassist-3.12.0.GA
*   jta-1.1
*   jtds-1.2.5

...其余的是与 GWT 相关的罐子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-01T22:13:58.673

我得到了同样的错误：

解决方案是让我清除 WEB-INF/lib 目录并完全刷新库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T13:57:15.020

当我将 Hibernate 库放在 libs 目录内的文件夹中时，我遇到了类似的错误，即 lib/hibernate/。如果是这种情况，请尝试将它们放在 /lib 中。

# c++ - 为什么结构是轻量级的，而类在 C++ 中是重量级的

> ID：12162805
> 
> 赞同：-4
> 
> 时间：2012-08-28T15:40:27.063
> 
> 标签：c++

请告诉我区别以及为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T15:41:17.743

> 为什么结构是轻量级的，而类在 C++ 中是重量级的

谁说的？这是完全错误的说法。

struct 和 class 之间的区别在于，*默认*可访问性为`struct`is `public`，而 for `class`it 为`private`。否则，`struct`与 相同`class`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-28T15:42:41.393

因为程序员的大脑是如何工作的。

`struct`来自 C，它最初没有`class`C++ 带来的方法、访问级别和其他特定的东西。它在 C++ 中还具有默认`public`访问级别，这使其更像是某些成员的容器，而不是完整的 OOP 对象。

`class`另一方面，由 C++ 引入，并提供上述所有内容（`private`默认情况下是访问级别）。

当然，两者在 C++ 中没有区别（除了默认访问级别），因此它主要是一种表示轻量级和重量级的*元方式。*当您说 时`class`，您天生就会想到方法、私有成员、多态性和继承。当你说`struct`你认为它有 2 `int`s 作为成员时，就是这样:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T15:46:03.877

我不确定你的问题。也许你在问“虚拟”的东西。在 C++ 中的类/结构中可能有虚拟表。你不能 memset 他们，这会导致很多问题。虚拟表会花费您额外的内存，所以也许这就是它们“沉重”的原因...

[http://www.programmerinterview.com/index.php/c-cplusplus/how-vtables-work/](http://www.programmerinterview.com/index.php/c-cplusplus/how-vtables-work/)

还要记住，C++ 中的 Struct 和 Class 是相同的，但默认情况下 struct 具有公共字段和函数。

# ruby-on-rails - Omniauth 登录而不刷新页面？

> ID：12162807
> 
> 赞同：4
> 
> 时间：2012-08-28T15:40:33.977
> 
> 标签：ruby-on-rails, omniauth

我正在使用 Omniauth gem 让我的用户通过 twitter 注册。

我希望omniauth过程在幕后发生，所以我试图建立`/auth/twitter`一个`remote: true`链接。但是，当我这样做时，我得到“回调阶段启动”，然后仅此而已。

我认为这是因为omniauth gem 只识别标准调用。如何让它响应 AJAX 调用？

```
= link_to "Sign in with Twitter", twitter_signin_path, remote: true 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-22T14:57:42.207

这是不可能的，因为 oauth 授权流程涉及重定向到提供商网站。

这一步发生在 twitter.com 上。无法从 javascript AJAX 请求完成流程。

# python - wxPython 对话框 self.Destoy() 将冻结应用程序

> ID：12162808
> 
> 赞同：0
> 
> 时间：2012-08-28T15:40:34.277
> 
> 标签：python, wxpython, boa-constructor

我正在使用 Python 2.6 和 wxPython 2.8.12 通过 BoaConstructor 开发应用程序。我编写了一个应用按钮，以便它将存储来自 TextCtrl 的一些变量，然后在对话框窗口上执行 self.Destroy() 调用以关闭它。当我单击此按钮时，GUI 挂起并且应用程序冻结。但是，如果我不调用 self.Destroy()，我可以毫无问题地存储变量，直到我尝试使用窗口右上角的 X 按钮关闭窗口（使用打印命令进行测试）。如果我不尝试存储任何变量而只是在按下按钮时执行 self.Destroy() ，一切都很好。只有当我尝试存储变量并执行 self.Destroy() 时，GUI 才会挂起。任何机构都可以伸出援手吗？提前致谢。

```
 def OnApplyButton(self, event):
        print self.IMSINumberDigitTextCtrl.GetValue()
        if self.IMSINumberDigitCheckBox.GetValue() == True:
            print self.IMSINumberDigit #Debugging purposes only.  Returns expected value
            print self.IMSINumberDigitTextCtrl.GetValue() #Debugging purposes only.  Returns expected value
            self.IMSINumberDigit = self.IMSINumberDigitTextCtrl.GetValue()
            print self.IMSINumberDigit #Debugging purposes only.  Returns expected value
    self.Destroy() 
```

编辑：这是指迈克的建议。这是我测试过的较小程序的两个文件，它们可以完美运行。

```
#!/usr/bin/env python
#Boa:App:BoaApp

import wx

import Frame1

modules = {'Frame1': [1, 'Main frame of Application', u'Frame1.py']}

class BoaApp(wx.App):
    def OnInit(self):
        self.main = Frame1.create(None)
        self.main.Show()
        self.SetTopWindow(self.main)
        return True

def main():
    application = BoaApp(0)
    application.MainLoop()

if __name__ == '__main__':
    main() 
```

和

```
#Boa:Frame:Frame1

import wx

def create(parent):
    return Frame1(parent)

[wxID_FRAME1, wxID_FRAME1APPLY, wxID_FRAME1CHECKBOX1, wxID_FRAME1CHECKBOX2, 
 wxID_FRAME1TEXTCTRL1, 
] = [wx.NewId() for _init_ctrls in range(5)]

class Frame1(wx.Frame):
    def _init_ctrls(self, prnt):
        # generated method, don't edit
        wx.Frame.__init__(self, id=wxID_FRAME1, name='', parent=prnt,
              pos=wx.Point(480, 245), size=wx.Size(279, 135),
              style=wx.DEFAULT_FRAME_STYLE, title='Frame1')
        self.SetClientSize(wx.Size(279, 135))

        self.checkBox1 = wx.CheckBox(id=wxID_FRAME1CHECKBOX1, label='checkBox1',
              name='checkBox1', parent=self, pos=wx.Point(24, 16),
              size=wx.Size(95, 22), style=0)
        self.checkBox1.Bind(wx.EVT_CHECKBOX, self.OnCheckBox1Checkbox,
              id=wxID_FRAME1CHECKBOX1)

        self.checkBox2 = wx.CheckBox(id=wxID_FRAME1CHECKBOX2, label='checkBox2',
              name='checkBox2', parent=self, pos=wx.Point(48, 48),
              size=wx.Size(95, 22), style=0)
        self.checkBox2.Enable(False)
        self.checkBox2.Bind(wx.EVT_CHECKBOX, self.OnCheckBox2Checkbox,
              id=wxID_FRAME1CHECKBOX2)

        self.Apply = wx.Button(id=wxID_FRAME1APPLY, label=u'Apply',
              name=u'Apply', parent=self, pos=wx.Point(24, 88),
              size=wx.Size(232, 29), style=0)
        self.Apply.Bind(wx.EVT_BUTTON, self.OnApplyButton, id=wxID_FRAME1APPLY)

        self.textCtrl1 = wx.TextCtrl(id=wxID_FRAME1TEXTCTRL1, name='textCtrl1',
              parent=self, pos=wx.Point(160, 44), size=wx.Size(80, 27), style=0,
              value='textCtrl1')
        self.textCtrl1.SetEditable(True)
        self.textCtrl1.Enable(False)

    def __init__(self, parent):
        self._init_ctrls(parent)
        self.TextCtrlVariableHolder = None

    def OnCheckBox1Checkbox(self, event):
        value = self.checkBox1.GetValue()
        if value == True:
            self.checkBox2.Enable(True)
        else:
            self.checkBox2.Enable(False)

    def OnCheckBox2Checkbox(self, event):
        value = self.checkBox2.GetValue()
        if value == True:
            self.textCtrl1.Enable(True)
        else:
            self.textCtrl1.Enable(False)

    def OnApplyButton(self, event):
        print self.textCtrl1.GetValue()
        if self.checkBox2.GetValue() == True:
            print self.TextCtrlVariableHolder
            print self.textCtrl1.GetValue()
            self.TextCtrlVariableHolder = self.textCtrl1.GetValue()
            print self.TextCtrlVariableHolder
        self.Destroy() 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T19:58:18.560

原来问题是我自己的编码，我一直怀疑但无法隔离。由于我捕获值的方式，我运行了一个无限循环。TextCtrls 返回字符串，而不是整数。谁知道。因此，在生成对话框的框架中， i < "StringThatIThoughtWasAnINT" 永远不会逃脱。感谢您通过@MikeDriscoll 提供的所有帮助！

# ios - iPad - UITableView 的自动调整大小

> ID：12162810
> 
> 赞同：0
> 
> 时间：2012-08-28T15:40:38.497
> 
> 标签：ios, ipad, uiview, autoresizingmask

我的代码在这里：

```
CGRect mainFrame = [UIScreen mainScreen].bounds;

_contentView = [[[UIView alloc] initWithFrame:CGRectMake(0, 0.0, mainFrame.size.width, mainFrame.size.height-20)] autorelease];
_contentView.autoresizingMask = (UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth);
_contentView.backgroundColor = [UIColor clearColor];
[self.view addSubview:_contentView];

self.tableView = [[[UITableView alloc] initWithFrame:_contentView.frame style:UITableViewStylePlain] autorelease];
[self.tableView setBackgroundColor:[UIColor clearColor]];
self.tableView.delegate = self;
self.tableView.dataSource = self;
self.tableView.separatorStyle = UITableViewCellSeparatorStyleSingleLine;
[self.tableView setSeparatorColor:[UIColor clearColor]];
[_contentView addSubview:_tableView];
self.tableView.autoresizingMask = (UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight); 
```

我在 iPhone 上的 _contentView 和 self.view 上的 _contentView 添加了一个 tableview 没有问题，但是在 iPad 上我不知道为什么当我为 table view 设置自动调整掩码时，它会增加宽度和高度......没有自动调整掩码很好用，但我需要为风景自动调整蒙版。如何解决这个问题？

带有自动调整大小的蒙版 ![带有自动调整大小的蒙版](../Images/019682ffaaafc6ec70b185d3df69a4ba.png) 没有自动调整大小的蒙版 ![没有自动调整大小的蒙版](../Images/f082de815cabceadd95fe5095b8d84cb.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-12-11T06:09:06.033

一旦尝试这个

```
_contentView.autoresizesSubviews = YES ; 
```

希望这会奏效。

# r - 在 R 中使用 pROC 包从特定阈值获取 SP 和 SN 的 CI

> ID：12162811
> 
> 赞同：2
> 
> 时间：2012-08-28T15:01:57.753
> 
> 标签：r, roc

使用该`pROC`软件包，是否有人知道一种通过输入特定阈值而不是特定 SP 或 SN 值来获取 SP 和 SN 置信区间的方法？`ci()`似乎只使用相应的 SN 或 SP 作为参数来显示 SP 和 SN 值；我可以要求 SN 为 0.8 的 SP 的 CI，但不能要求阈值为 9.0 的 SP 的 CI。

我知道我可以找到阈值的 SP/SN 值，然后将它们用作 的参数`ci()`，但这似乎很笨拙。当然，这最终可能只是包开发人员的一个问题。

提前感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T17:03:40.343

可以在第一次创建 roc 对象以及从`ci.thresholds(rocobj, thresholds=0.9)`

使用帮助文件中的示例数据`pROC`：

```
library(pROC)
data(aSAH)

rocobj <- roc(aSAH$outcome, aSAH$s100b, ci=TRUE, of="thresholds", thresholds=0.9) 
```

给予

> ```
> 95% CI (2000 stratified bootstrap replicates):
>  thresholds sp.low sp.median sp.high se.low se.median se.high
>         0.9      1         1       1      0   0.04878   0.122 
> ```

# ruby-on-rails - Rails 3 建模复杂的 Has_Many 关系

> ID：12162812
> 
> 赞同：0
> 
> 时间：2012-08-28T15:40:39.090
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我正在为游戏构建一种留言板系统，但在建模关系时遇到了问题。这是我到目前为止所拥有的：

```
Models
------
User (Has Many Posts)
Post (Belongs to User, Belongs to Game)
Game (Has Many Posts) 
```

这是我需要添加的内容。

```
Models
------
Server (Belongs to Game but also part of Post)
Replies (Belongs to Post and Post's User but needs to function like private messaging) 
```

对这两件事进行建模的最简单方法是什么？我对服务器的最佳猜测是：

```
Server - Has Many Posts, Belongs To Game
Posts - Belongs To Server
Game - Has Many Servers 
```

我什至不知道从哪里开始回复。帖子和用户将有许多回复，但回复将有两个用户和一个帖子。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T20:27:05.710

我用这些关系解决了这个问题：

模型服务器

```
belongs_to :game
has_many :posts 
```

模型游戏

```
has_many :posts
has_many :servers 
```

模型回复

```
belongs_to :post
belongs_to :poster, class_name: :user, foreign_key: :poster_id
belongs_to :replier, class_name: :user, foreign_key: :replier_id 
```

模型柱

```
belongs_to :user
belongs_to :game
belongs_to :server
has_many :replies, dependent: :destroy 
```

模型用户

```
has_many :posts, dependent: :destroy
has_many :replies, dependent: :destroy 
```

# php - 表情符号的 preg_replace (php)

> ID：12162815
> 
> 赞同：-2
> 
> 时间：2012-08-28T15:40:47.257
> 
> 标签：php, preg-replace

[从旧问题修订 - 现在使用不同的前进方式](https://stackoverflow.com/questions/12161084/str-replace-text-with-image)

我正在构建一个聊天框，并想使用表情符号。因此，当一个人发送“:)”时，它被替换为它的图像，不幸的是，我的代码不会发生这种情况。我也做了很多实验，我知道`str_replace`会实现我的项目鹅蛋，我决定使用`preg_replace`

```
<?php

$message = $chatText;

$emoticons = array(
"/\:\)/");

$replacements = array(
"<img src='images/icons/smileys/smile.png' width='20' height='20' alt='Smile' />");

$chatText = preg_replace($emoticons,$replacements,$message);

?> 
```

而不是用笑脸替换“:)”，它只是插入文本`<img src='images/icons/smileys/smile.png' width='20' height='20' alt='Smile' />`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:43:02.917

这不是您的正则表达式的问题，而是您如何显示数据的问题。在某些时候，您正在使用类似的东西`htmlspecialchars`来防止聊天者将 HTML 注入您的聊天窗口。不幸的是，这导致笑脸也被逃脱。

您替换笑脸的代码应该*在*转义原始文本后出现。

# visual-studio-2010 - 如何在 SSL 环境中调试服务器端代码？

> ID：12162817
> 
> 赞同：0
> 
> 时间：2012-08-28T15:40:50.470
> 
> 标签：visual-studio-2010, debugging, ssl

我正在编写一个 Silverlight 应用程序，我想调试我的自定义`UserNamePasswordValidator`. 由于验证器需要 SSL（有充分的理由），我无法弄清楚如何调试它。我似乎无法对与 Visual Studio 2010 关联的 ASP.NET 开发服务器使用 SSL。由于它是服务器端的，因此我无法将 Visual Studio 的调试器附加到该进程。我到底该如何调试这个东西？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:50:32.617

*   您可以将 VS 调试器附加到 IIS。选择调试，附加到进程，检查显示所有进程，附加到 w3wp.exe。（VS 必须提升运行。）

*   如果您想查看您的应用程序和服务器之间的 HTTP 通信，[Fiddler](http://www.fiddler2.com/fiddler2/)将允许您这样做。阅读[有关 HTTPS 解密的文档](http://www.fiddler2.com/Fiddler/help/httpsdecryption.asp)以开始使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T16:02:23.863

建议[尝试 IIS Express](http://www.hanselman.com/blog/WorkingWithSSLAtDevelopmentTimeIsEasierWithIISExpress.aspx)，它可以利用 SSL 和/或[localtest.me](http://readme.localtest.me/)（有 ssl 证书可供下载）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-24T18:15:14.310

是的，IIS Express 可以配置为 VS 2010 SP1 中 Web 项目的默认 Web 服务器。它位于站点项目“属性”页面的“Web”选项卡上，位于“服务器”下：

右键单击项目，选择属性。选择 Web 选项卡。选择“使用本地 IIS Web 服务器”查看[Jason Shaver 的博客](http://www.jasonrshaver.com/post/2011/09/28/WP7-Client-Certificates-Part-2-(Client-Certs-on-the-Browser).aspx)以获取有关更新 applicationhost.config 的详细信息（在 User\Documents\IISExpress\config 中）：

我必须将该属性选项卡上的 Project Url 字段更改为 applicationhost.config 中标识的值，以便 Debug/F5 在 SSL 中运行。

刚开始玩这个，所以我不知道你是否可以设置这个 VS-wide 而不是逐个项目。

# c# - 在 C# 中加载 COM 对象会引发异常“无法将 'System.__ComObject' 类型的 COM 对象转换为接口类型 ...”，但 C++ 或 VB 不会

> ID：12162818
> 
> 赞同：4
> 
> 时间：2012-08-28T15:40:52.190
> 
> 标签：c#, c++, com, com-interop

我需要在非托管 C++ 中制作 COM 服务器，在 C# 中制作 COM 客户端。我在 C++ 中找到了教程 COM Hello World ( [http://antonio.cz/static/com/5.html](http://antonio.cz/static/com/5.html) )。页面是捷克语。COM 服务器在从 IHello 接口调用函数 Print() 后显示带有文本“Hello world”的 MessageBox。源代码在这里：[http](http://antonio.cz/static/com/Hello.zip) ://antonio.cz/static/com/Hello.zip 。该存档包含 C++ 中 COM 服务器和 COM 客户端的源代码，并且可以正常工作。

但是我的 C# COM 客户端不起作用。它是一个参考“Interop.Hello.dll”的 C# 控制台应用程序。我使用以下命令制作互操作 dll：

```
tlbimp Hello.tlb /out:Interop.Hello.dll 
```

C#代码：

```
static void Main(string[] args)
{
    Interop.Hello.IHello Hello = new Interop.Hello.CHello();
    Hello.Print();
} 
```

但是 C# 客户端抛出异常：

```
Unable to cast COM object of type 'System.__ComObject' to interface type
'Interop.Hello.CHello'. This operation failed because the QueryInterface call on the
COM component for the interface with IID '{B58DF060-EAD9-11D7-BB81-000475BB5B75}' 
failed due to the following error: No such interface supported (Exception from 
HRESULT: 0x80004002 (E_NOINTERFACE)). 
```

我也尝试从 Visual Basic 加载 COM 服务器。它有效。我参考“Interop.Hello.dll”在VB中制作了控制台应用程序。

VB代码：

```
Module Module1
    Sub Main()

        Dim ic As Interop.Hello.CHello

        ic = CreateObject("MyCorporation.Hello")
        ic.Print()

    End Sub
End Module 
```

从 C# 客户端加载时，我调试了 COM 服务器。当变量“riid”是 IHello 接口 guid 时，方法 QueryInterface() 返回 S_OK。

任何想法为什么 C# 代码不起作用？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-25T12:47:06.397

> 不支持这样的接口

错误消息不明确。每个人都会认为是*他们的*接口不受支持，在你的情况下是 IHello。但事实并非如此，错误消息并没有说得足够清楚。不支持的是[IMarshal 接口。](http://msdn.microsoft.com/en-us/library/windows/desktop/dd542707%28v=vs.85%29.aspx)

COM 处理 .NET 没有的编程细节，它不会忽略线程。众所周知，线程很难正确处理，有很多代码不是线程安全的。.NET 允许您在工作线程中使用此类代码，并且不会反对您出错，通常会产生非常难以诊断的错误。COM 设计者最初认为线程处理太难了，应该由聪明的人来处理。并内置在基础架构中，以使在工作线程中使用非线程安全的代码无论如何都是安全的。效果很好，它可以解决 95% 的典型线程问题。然而，最后的 5% 往往会让您非常头疼。像这个。

像您的 COM 组件可以发布从注册表中的线程使用是否安全。注册表值名称是“ThreadingModel”。一个*非常*常见的值，也是缺失时的默认值，是“Apartment”。解释公寓有点超出了这个答案的范围，它真的意味着“我不是线程安全的”。COM 基础结构确保对对象的任何调用都来自创建对象的同一线程，从而确保线程安全。

然而，这需要一些魔法。将一个线程的调用编组到*特定*的其他线程是一件非常重要的事情。.NET 使用 Dispatcher.BeginInvoke 和 Control.BeginInvoke 等方法使它看起来很简单，但这隐藏了一个相当大的代码冰山，99% 都在水下。而 COM 很难做到这一点，它缺少一个 .NET 功能，使这更容易实现，它不直接支持反射。

一方面，需要在目标线程上构建一个堆栈框架，以便可以进行调用。这需要知道该方法的参数是什么样的。COM 在这方面需要帮助，它不知道它们的样子，因为它不能依赖反射。需要的是两段代码，称为代理和存根。代理*确实*知道参数的样子，并将方法的参数序列化为 RPC 数据包。该代码由 COM 自动调用，使用看起来与原始接口*完全相同*的虚拟接口，但每个方法都进行代理调用。在目标线程上，存根代码接收 RPC 数据包，构建堆栈帧并进行调用。

这在 .NET 术语中可能听起来很熟悉，这正是 .NET Remoting 和 WCF 的工作方式。除了 .NET 可以自动创建代理和存根，这要归功于反射。在 COM 中，它们需要由您创建。两种基本方式完成，一般方式是用一种称为 IDL 的语言描述 COM 接口，然后使用 midl.exe 工具对其进行编译。它可以从 IDL 中的接口描述中自动生成代理和存根代码。或者，当您的 COM 服务器将自身限制为自动化子集并可以生成类型库时，可以使用一种简单的方法。在这种情况下，您可以使用 Windows 中内置的代理/存根实现，它使用类型库来确定参数的外观。这真的很像反射。

所以异常消息的*真正*含义是 COM 找不到编组调用的方法。它在注册表中查找，但找不到代理/存根的注册表项。然后它会询问您的 COM 对象“您知道如何编组自己吗？” 通过查询 IMarshal。答案是否定的！这就是它的结束，给你留下一个很难解释的异常消息。错误报告是 COM 的致命弱点。

* * *

接下来，我需要关注*为什么*COM 决定将调用编组到您的 COM 服务器，这是您没想到会发生的事情。调用 COM 对象的线程的一项基本要求是，它需要告诉 COM 它为封送调用提供何种支持。除了构建堆栈框架之外，第二个很难做的事情是调用需要在一个非常特定的线程上进行，即创建 COM 对象的线程。实现线程的代码需要使这成为可能，这不是一件容易的事。它需要解决一般[生产者/消费者问题](http://en.wikipedia.org/wiki/Producer-consumer_problem)，这是软件工程中的一般问题。其中“生产者”是进行调用的线程，“消费者”是创建对象的线程。

所以线程必须告诉 COM 是“我实现了生产者/消费者问题的解决方案，继续并随意生产”。大多数 Windows 程序员都知道该问题的通用解决方案，它是 GUI 线程实现的“消息循环”。

您很早就告诉 COM，每个进行 COM 调用的线程都必须调用 CoInitializeEx()。您可以指定两个选项之一，您可以指定 COINIT_APARTMENTTHREADED（又名 STA）以保证您为非线程安全的 COM 对象提供安全的家。“公寓”这个词又来了。或者您可以指定 COINIT_MULTITHREADED（又名 MTA），它基本上表示您对 COM*没有任何*帮助，而将其留给 COM 基础设施来解决。

.NET 程序不会直接调用 CoInitializeEx()，CLR 会为您调用。它还需要知道您的线程是 STA 还是 MTA。您可以使用程序主线程的 Main() 方法上的属性来执行此操作，指定 [STAThread] 或 [MTAThread]。MTA 是默认的，也是线程池线程的默认和唯一选项。或者，当您创建自己的线程时，您可以通过调用 Thread.SetApartmentState() 来指定它。

MTA 和非线程安全的 COM 对象的组合，或者换句话说，“我对 COM 无能为力”的场景是这里问题的一部分。你强迫 COM 给对象一个安全的家。COM 基础结构将自动创建一个**新线程**，即一个 STA 线程。它必须，因为您选择不提供帮助，所以没有其他方法可以确保对对象的调用是线程安全的。因此，您对该对象进行的*任何*调用都将被编组。这是非常低效的，创建自己的 STA 线程可以避免编组成本。但最重要的是，COM 将需要代理和存根来进行调用。你没有实现它们，所以这是一个kaboom。

这在您的 C++ 客户端代码中有效，因为它可能调用了 CoInitialize()。其中选择 STA。它可以在您的 VB.NET 代码中运行，因为 vb.net 运行时支持会自动选择 STA，这是该语言的典型特征，它会自动做很多事情来帮助程序员陷入成功的陷阱。

但这不是 C# 的方式，它自动做的事情很少。您得到了 kaboom，因为您的 Main() 方法没有 [STAThread] 属性，因此它默认为 MTA。

但是请注意，这实际上不是技术上正确的解决方案。当您向 STA 承诺时，您也必须履行该承诺。这说明您解决了生产者/消费者问题。这需要您在 .NET 中抽取消息循环 Application.Run()。你没有。

违背这一承诺可能会产生不愉快的后果。COM 将依赖您的承诺，并会在需要时尝试编组调用，并期望它能够正常工作。它不起作用，由于您没有调用 GetMessage()，因此不会在您的线程上分派调用。你没有消费。您可以使用调试器轻松看到这一点，线程将*死锁*，调用永远不会完成。单元线程 COM 服务器通常也很容易假设您的 STA 线程泵送消息循环并将使用它来实现自己的线程间封送处理，通常通过从工作线程调用 PostMessage()。WebBrowser 控件就是一个很好的例子。该 PostMessage() 消息不去任何地方的副作用通常是组件不会引发事件或不履行职责。例如，在 WebBrowser 的情况下，您将永远不会收到 DocumentCompleted 事件。

听起来您的 COM 服务器没有做出这些假设，否则您不会在工作线程上进行调用。或者您会注意到它在您的 C++ 或 VB.NET 客户端代码中出现故障。这是一个危险的假设，可以随时字节，但你很可能会侥幸逃脱。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-20T07:37:03.003

正确的 C# 代码：

```
 [STAThread]
 static void Main(string[] args)
 {
     Interop.Hello.IHello Hello = new Interop.Hello.CHello();
     Hello.Print();
 } 
```

# objective-c - 点击纹理区域

> ID：12162819
> 
> 赞同：0
> 
> 时间：2012-08-28T15:40:54.100
> 
> 标签：objective-c, xcode4.3

我想创建一个通过单击纹理对象来调用的函数。我刚刚弄清楚按钮操作是如何处理的。你能告诉我它是如何工作的吗？也许某些特殊控件必须与纹理对象相对应？提前致谢 ）））

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:52:50.743

我认为这是针对 iOS 的，点击是指点击。以下代码将向 any 添加手势识别器`UIView`：

```
 myView.userInteractionEnabled = YES;
    UITapGestureRecognizer *recognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleTap:)];
    recognizer.numberOfTapsRequired = 1;
    recognizer.numberOfTouchesRequired = 1;

    [myView addGestureRecognizer:recognizer]; 
```

并像这样实现您的处理程序：

```
- (void)handleTap:(UITapGestureRecognizer *)sender {     
    if (sender.state == UIGestureRecognizerStateEnded) {
        //your code
    }
} 
```

`handleTap:`每次您的视图收到点击时，都会调用该方法。

# java - LDAP：如何使用 sAMAccountName 对用户进行身份验证？

> ID：12162820
> 
> 赞同：4
> 
> 时间：2012-08-28T15:40:54.090
> 
> 标签：java, spring, ldap, spring-ldap

当用户通过`sAMAccountName`和`password`.

如果我这样做：

```
env.put(Context.SECURITY_PRINCIPAL, "CN="+username+",OU=Service Accounts,OU=TECH,DC=wawalab2,DC=ins");
env.put(Context.SECURITY_CREDENTIALS, password); 
```

它抛出异常：

> javax.naming.AuthenticationException：[LDAP：错误代码 49 - 80090308：LdapErr：DSID-0C090334，注释：AcceptSecurityContext 错误，数据 525，vece

```
Note: I can use Spring LDAP framework too. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T23:39:30.427

首先，525 错误是错误的 DN。您可以在此链接中查看 AD 返回的 LDAP 错误列表：[AD LDAP 错误代码](http://www.novell.com/communities/node/1424/sub-error-codes-ldap-error-49)

所以你有一个糟糕的DN。您要做的是搜索 samAccountName=username，从返回的值中获取 DN，并与该正确的 DN 绑定。

# jquery - 使用 jquery validate 和自定义 errorPlacement 时如何清除错误

> ID：12162831
> 
> 赞同：5
> 
> 时间：2012-08-28T15:41:49.657
> 
> 标签：jquery, jquery-validate

我正在使用 jquery 和 validate 来验证我的表单。我没有向缺少的字段添加元素，而是使用此选项 errorPlacement 向元素添加边框

```
$("#signup-form").validate({
       submitHandler: function(form) {
      form.submit();
   },
   errorPlacement: function(error, element) {
      element.css("border", "solid 1px red");
   }                    
}); 
```

我似乎无法弄清楚的一件事是如何在有效时清除它？

所以我从上面的代码开始。然后尝试了，我对结果感到困惑。`success:`如果在字段失败时我没有选项，它会成功添加类。但是，一旦我添加了该`success`选项，所有必填字段都将获得该类，并且如果我检查我看到的元素，`<input class="required invalid valid">`那么我做错了什么。

```
 $("#signup-form").validate({
                submitHandler: function(form) {
                    // do other stuff for a valid form
                    //form.submit();
                },
                errorPlacement: function(error, element) {
                    element.addClass("invalid");
                },        
                success: function(error) {
                    // change CSS on your element(s) back to normal
                },                    
                 debug:true
            }); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-28T15:47:26.530

您可以尝试将此添加到您的`.validate()`选项列表中...

```
success: function(error) {
    // change CSS on your element(s) back to normal
} 
```

这应该在没有表单提交的情况下动态工作。一旦错误得到解决，包含的代码就会运行。

请参阅[文档](http://docs.jquery.com/Plugins/Validation/validate)。

请使用 jsFiddle 为您的问题创建一个演示。这是[一个空白的 jsFiddle](http://jsfiddle.net/jLE2s/)，`.validate()`已经包含并可以使用。

* * *

**编辑**

根据[OP 的 jsFiddle](http://jsfiddle.net/paries/u3Td3/1/)，我做了这些改变......

```
 errorPlacement: function(error, element) {
        $(element).filter(':not(.valid)').addClass("invalid");
    },
    success: function(error) {
        console.log(error);
        $("#signup-form").find('.valid').removeClass("invalid");
    } 
```

**工作演示：http:** [//jsfiddle.net/u3Td3/6/](http://jsfiddle.net/u3Td3/6/)

**旁注：** 您还遇到了一些 HTML 问题。您应该`input`使用`/>`. 提交按钮也是如此，自动关闭而不是使用`</input>`. 请参阅[validator.w3.org](http://validator.w3.org/)以验证您的 HTML。我也不会使用`table`布局，使用 CSS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-25T13:59:13.427

```
<form id="signupForm">
    <div class="form-group">
        <label for="contact">Your Name <em>(required)</em></label>
        <input type="text" class="form-control" id="contact" name="contact" placeholder="Name" required>
    </div>
</form>

$('#serviceForm').validate({
    errorPlacement: function (error, element) {
        element.parent().addClass("hasError");
    },
    success: function (error, element) {
        $(element).parent().removeClass("hasError");
    }
}) 
```

# javascript - 一旦滚动窗口的垂直高度，我需要帮助弄清楚如何切换元素

> ID：12162838
> 
> 赞同：0
> 
> 时间：2012-08-28T15:42:02.263
> 
> 标签：javascript, jquery, height, toggle, sticky-windows

当我使用javascript向下滚动200px时，我试图将div从相对切换到固定。当我从窗口顶部到达 200px 时，我的 div 应该切换到固定。当我从顶部超过 200 像素时，它应该回到相对位置。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:44:46.857

就像是：

```
$(window).on('scroll', function() {
    $("#myDivID").css({
       position: $(this).scrollTop()<200?'relative':'fixed',
       top: $(this).scrollTop()<200?'200px':'0px'
    });
}); 
```

您可能还必须重置`top`元素的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:48:18.313

我知道至少有几个插件可以做到这一点。不记得我上次看到的名字了，但这是我自己写的：[http ://code.google.com/p/sleekphp/source/browse/trunk/Sites/SleekBase/Modules/Base/ JS/jQuery.fixedIfNeeded.js](http://code.google.com/p/sleekphp/source/browse/trunk/Sites/SleekBase/Modules/Base/JS/jQuery.fixedIfNeeded.js)

你像这样使用它：

```
$('#my-element').fixedIfNeeded(); 
```

有一个可选参数指定元素是否应该在到达另一个元素之前停止固定（例如页脚）：

```
$('#my-element').fixedIfNeeded('#footer'); 
```

# javascript - 连接 SQlite 数据库

> ID：12162839
> 
> 赞同：0
> 
> 时间：2012-08-28T15:42:05.147
> 
> 标签：javascript

我试图在我的网络应用程序上查看数据库。这里的问题是它不能从 SQLite 中查看。而是从 chrome 插件中查看数据库。有什么方法可以让我使用 Jscript 查看 SQlite 数据库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:45:12.260

无法通过在 Web 浏览器中运行的客户端 JavaScript 直接访问任意 SQLite 数据库。

如果您的数据库存在于网络服务器上，那么您可以编写一个基于 HTTP 的 API（最好是 RESTful）并通过 XMLHttpRequest 对象与之交互。

# qt - 在主窗口运行之前显示一个弹出窗口

> ID：12162840
> 
> 赞同：0
> 
> 时间：2012-08-28T15:42:23.963
> 
> 标签：qt, popup

如何制作一个在主窗口开始之前出现的弹出窗口？我希望弹出窗口有几个`QLineEdit`小部件来接收主窗口所需的输入。我搜索了解决方案，但我无法理解找到的大多数示例。有人能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:30:55.837

只需创建 QDialog 的子类，在运行正常启动逻辑之前模态执行它。

这就是我为需要登录的应用程序所做的，效果很好。这将是 Python 中的一般想法（在 PyQt 中考虑它花费的时间更少）：

```
import sys

from PyQt4 import QtGui, QtCore
from mymodule import MyDialog, MyWindow

def main(argv):
    app = QtGui.QApplication(argv)

    # make a dialog that runs in its own event loop
    dlg = MyDialog()
    if ( not dlg.exec_() ):  # in C++, this would be dlg->exec()
        sys.exit(0)

    var1, var2, var3 = dlg.values()        

    window = MyWindow()
    window.setPropertyOne(var1)
    window.setPropertyTwo(var2)
    window.setPropertyThree(var3)
    window.show()

    sys.exit(app.exec_())

if ( __name__ == '__main__' ):
    main(sys.argv) 
```

# c# - 为什么 Umbraco WYSIWYG 在标签链接前放置正斜杠？

> ID：12162846
> 
> 赞同：6
> 
> 时间：2012-08-28T15:42:43.573
> 
> 标签：c#, tinymce, wysiwyg, umbraco

我正在使用 Umbraco WYSIWYG 数据类型，我注意到在使用 HTML 窗口输入 HTML 时，一个 A 标记

```
<a href="http://www.someurl.com">link</a> 
```

最终将是：

```
<a href="/http.....>link</a> 
```

如果链接只是 www.something.com 而不是 Http://，也会发生这种情况。它也将以 (/) 开头。

作为额外的副作用，如果链接中确实包含 http://，则正斜杠将更改此链接

```
http:// 
```

到

```
/http:/     (single forward slash like its a path) 
```

所见即所得是 TinyMCE 所见即所得。为什么会这样，我能做些什么来改变它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-28T15:48:03.067

您需要更改*TinyMCE*配置以更改此行为。在文件 `config/tinyMceConfig.config`中，将其添加到`<customConfig>`文件末尾的部分：

```
<config key="relative_urls">true</config> 
```

在 tinymce 网站上阅读[relative_urls](http://www.tinymce.com/wiki.php/Configuration%3arelative_urls)。

# android - Android.mk 包含 libaudio.so 以进行本机编译

> ID：12162852
> 
> 赞同：0
> 
> 时间：2012-08-28T15:43:13.587
> 
> 标签：android, audio, android-ndk

我有一个用 Native 编写的代码。我想通过这个本机代码访问音频 HAL。我的本机代码是一种媒体播放器类型的代码。那么我在 Android.mk 文件中包含哪些更改，以便在其编译中包含 libaudio.so。据我了解，libaudio 实际上是音频的 HAL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T06:31:32.547

[http://www.kandroid.org/online-pdk/guide/audio.html](http://www.kandroid.org/online-pdk/guide/audio.html)

[http://forum.cyanogenmod.com/topic/3180-compiling-libaudio-on-its-own/](http://forum.cyanogenmod.com/topic/3180-compiling-libaudio-on-its-own/)

它的编译libaudio.so的方式，看看吧。它为您提供了方法，尤其是包含录制 FM 音乐的第二个链接。libaudio 是有问题的，因为它包含供应商特定的功能，不幸的是没有装饰/公开。最好的选择是从 android git sourcetree 获取 libaudio 标准，改变你喜欢的方式你想公开和编译只 libaudio

`make audio.primary.herring`

然后备份你当前的 rom，关闭手机，用你的替换原来的 libaudio，然后你就可以开始宾果游戏了。这就是我在三星银河案例中所做的

# ios - 如何比 CGContextStrokePath 更快地渲染线条？

> ID：12162860
> 
> 赞同：8
> 
> 时间：2012-08-28T15:43:49.150
> 
> 标签：ios, performance, cgcontext

我正在使用 CGContextStrokePath 为图形绘制约 768 个点。问题是每秒钟我都会得到一个新的数据点，从而重新绘制图表。这目前在已经很忙的应用程序中占用了 50% 的 CPU。

![图形](../Images/822c361b10061f52fd3cc496a12a40aa.png)

![仪器](../Images/8314d5e55dc65e06464381949bc90407.png)

图形绘制是在 UIView 中的 drawRect 中完成的。该图是基于时间的，所以新的数据点总是在右边。

我正在考虑一些替代方法：

1.  使用 GLKit 绘图（以不支持旧设备为代价）似乎需要做很多工作。
2.  做某种屏幕抓取（renderInContext？），向左移动 1 px，blit，只为最后两个数据点画一条线。
3.  有一个非常宽的 CALayer 并沿着它平移？
4.  平滑数据集，但这感觉像是作弊:)

也有可能我在这里遗漏了一些明显的东西，我看到的表现如此糟糕？

```
 CGContextBeginPath(context);
CGContextSetLineWidth(context, 2.0);
UIColor *color = [UIColor whiteColor];
CGContextSetStrokeColorWithColor(context, [color CGColor]);
…
        CGContextAddLines(context, points, index);
        CGContextMoveToPoint(context, startPoint.x, startPoint.y);
        CGContextClosePath(context);

        CGContextStrokePath(context); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-28T23:14:43.533

让我们实现一个图形视图，它使用一堆又高又瘦的层来减少所需的重绘量。我们将在添加样本时将图层向左滑动，因此在任何时候，我们都可能有一层悬挂在视图的左边缘，另一层悬挂在视图的右边缘：

![层视图](../Images/01f24afe4adb1c384cf272642cc5515d.png)

[您可以在我的 github 帐户](https://github.com/mayoff/stackoverflow-12162860-GraphView)上找到以下代码的完整工作示例。

## 常数

让我们将每一层设为 32 点宽：

```
#define kLayerWidth 32 
```

假设我们将沿 X 轴以每个点一个样本间隔样本：

```
#define kPointsPerSample 1 
```

所以我们可以推断出每层的样本数。让我们将一层的样本称为*tile*：

```
#define kSamplesPerTile (kLayerWidth / kPointsPerSample) 
```

当我们绘制一个层时，我们不能只在层内严格地绘制样本。我们必须在每个边缘上绘制一个或两个样本，因为这些样本的线穿过图层的边缘。我们将这些称为*填充样本*：

```
#define kPaddingSamples 2 
```

iPhone 屏幕的最大尺寸为 320 点，因此我们可以计算需要保留的最大样本数：

```
#define kMaxVisibleSamples ((320 / kPointsPerSample) + 2 * kPaddingSamples) 
```

（如果你想在 iPad 上运行，你应该更换 320。）

我们需要能够计算出哪个图块包含给定的样本。正如您将看到的，即使样本数为负，我们也希望这样做，因为它会使以后的计算更容易：

```
static inline NSInteger tileForSampleIndex(NSInteger sampleIndex) {
    // I need this to round toward -∞ even if sampleIndex is negative.
    return (NSInteger)floorf((float)sampleIndex / kSamplesPerTile);
} 
```

## 实例变量

现在，要实现`GraphView`，我们需要一些实例变量。我们需要存储用于绘制图形的图层。我们希望能够根据它所绘制的图块来查找每一层：

```
@implementation GraphView {

    // Each key in _tileLayers is an NSNumber whose value is a tile number.
    // The corresponding value is the CALayer that displays the tile's samples.
    // There will be tiles that don't have a corresponding layer.
    NSMutableDictionary *_tileLayers; 
```

在实际项目中，您希望将样本存储在模型对象中，并为视图提供对模型的引用。但是对于这个例子，我们只是将样本存储在视图中：

```
 // Samples are stored in _samples as instances of NSNumber.
    NSMutableArray *_samples; 
```

由于我们不想存储任意数量的样本，所以我们会在`_samples`变大时丢弃旧样本。但是，如果我们可以假装我们从不丢弃样本，它将简化实现。为此，我们会跟踪收到的样本总数。

```
 // I discard old samples from _samples when I have more than
    // kMaxTiles' worth of samples.  This is the total number of samples
    // ever collected, including discarded samples.
    NSInteger _totalSampleCount; 
```

我们应该避免阻塞主线程，所以我们将在单独的 GCD 队列上进行绘图。我们需要跟踪需要在该队列上绘制哪些图块。为了避免多次绘制待处理的图块，我们使用集合（消除重复）而不是数组：

```
 // Each member of _tilesToRedraw is an NSNumber whose value
    // is a tile number to be redrawn.
    NSMutableSet *_tilesToRedraw; 
```

这是我们将在其上进行绘图的 GCD 队列。

```
 // Methods prefixed with rq_ run on redrawQueue.
    // All other methods run on the main queue.
    dispatch_queue_t _redrawQueue;
} 
```

## 初始化/销毁

无论您是在代码中还是在 nib 中创建此视图，为了使该视图都能正常工作，我们需要两种初始化方法：

```
- (id)initWithFrame:(CGRect)frame {
    if ((self = [super initWithFrame:frame])) {
        [self commonInit];
    }
    return self;
}

- (void)awakeFromNib {
    [self commonInit];
} 
```

两种方法都调用`commonInit`来进行真正的初始化：

```
- (void)commonInit {
    _tileLayers = [[NSMutableDictionary alloc] init];
    _samples = [[NSMutableArray alloc] init];
    _tilesToRedraw = [[NSMutableSet alloc] init];
    _redrawQueue = dispatch_queue_create("MyView tile redraw", 0);
} 
```

ARC 不会为我们清理 GCD 队列：

```
- (void)dealloc {
    if (_redrawQueue != NULL) {
        dispatch_release(_redrawQueue);
    }
} 
```

## 添加样本

要添加新样本，我们选择一个随机数并将其附加到`_samples`. 我们也增加`_totalSampleCount`. `_samples`如果变大，我们会丢弃最旧的样本。

```
- (void)addRandomSample {
    [_samples addObject:[NSNumber numberWithFloat:120.f * ((double)arc4random() / UINT32_MAX)]];
    ++_totalSampleCount;
    [self discardSamplesIfNeeded]; 
```

然后，我们检查我们是否已经开始了一个新的瓦片。如果是这样，我们会找到绘制最旧图块的图层，并重用它来绘制新创建的图块。

```
 if (_totalSampleCount % kSamplesPerTile == 1) {
        [self reuseOldestTileLayerForNewestTile];
    } 
```

现在我们重新计算所有层的布局，它会向左一点，以便新样本在图中可见。

```
 [self layoutTileLayers]; 
```

最后，我们将图块添加到重绘队列中。

```
 [self queueTilesForRedrawIfAffectedByLastSample];
} 
```

我们不想一次丢弃一个样本。那将是低效的。相反，我们让垃圾堆积一段时间，然后一次性扔掉：

```
- (void)discardSamplesIfNeeded {
    if (_samples.count >= 2 * kMaxVisibleSamples) {
        [_samples removeObjectsInRange:NSMakeRange(0, _samples.count - kMaxVisibleSamples)];
    }
} 
```

要为新瓦片重用图层，我们需要找到最旧瓦片的图层：

```
- (void)reuseOldestTileLayerForNewestTile {
    // The oldest tile's layer should no longer be visible, so I can reuse it as the new tile's layer.
    NSInteger newestTile = tileForSampleIndex(_totalSampleCount - 1);
    NSInteger reusableTile = newestTile - _tileLayers.count;
    NSNumber *reusableTileObject = [NSNumber numberWithInteger:reusableTile];
    CALayer *layer = [_tileLayers objectForKey:reusableTileObject]; 
```

现在我们可以将它从`_tileLayers`字典中的旧键下删除，并将其存储在新键下：

```
 [_tileLayers removeObjectForKey:reusableTileObject];
    [_tileLayers setObject:layer forKey:[NSNumber numberWithInteger:newestTile]]; 
```

默认情况下，当我们将重用层移动到新位置时，Core Animation 将动画它滑过。我们不希望这样，因为它将是一个在我们的图表上滑动的大空橙色矩形。我们想立即移动它：

```
 // The reused layer needs to move instantly to its new position,
    // lest it be seen animating on top of the other layers.
    [CATransaction begin]; {
        [CATransaction setDisableActions:YES];
        layer.frame = [self frameForTile:newestTile];
    } [CATransaction commit];
} 
```

当我们添加一个样本时，我们总是希望重新绘制包含该样本的图块。如果新样本在前一个图块的填充范围内，我们还需要重新绘制前一个图块。

```
- (void)queueTilesForRedrawIfAffectedByLastSample {
    [self queueTileForRedraw:tileForSampleIndex(_totalSampleCount - 1)];

    // This redraws the second-newest tile if the new sample is in its padding range.
    [self queueTileForRedraw:tileForSampleIndex(_totalSampleCount - 1 - kPaddingSamples)];
} 
```

排队重绘瓷砖只是将其添加到重绘集中并调度一个块以重绘它`_redrawQueue`。

```
- (void)queueTileForRedraw:(NSInteger)tile {
    [_tilesToRedraw addObject:[NSNumber numberWithInteger:tile]];
    dispatch_async(_redrawQueue, ^{
        [self rq_redrawOneTile];
    });
} 
```

## 布局

系统将在它第一次出现时发送`layoutSubviews`到`GraphView`，并且在它的大小发生变化的任何时候（例如，如果设备旋转调整它的大小）。`layoutSubviews`只有当我们真的要出现在屏幕上时，我们才会收到消息，并且设置了最终的界限。所以`layoutSubviews`是设置瓦片层的好地方。

首先，我们需要根据需要创建或删除图层，以便我们拥有适合我们尺寸的图层。然后我们需要通过适当地设置它们的框架来布置图层。最后，对于每一层，我们需要将其瓦片排队以进行重绘。

```
- (void)layoutSubviews {
    [self adjustTileDictionary];
    [CATransaction begin]; {
        // layoutSubviews only gets called on a resize, when I will be
        // shuffling layers all over the place.  I don't want to animate
        // the layers to their new positions.
        [CATransaction setDisableActions:YES];
        [self layoutTileLayers];
    } [CATransaction commit];
    for (NSNumber *key in _tileLayers) {
        [self queueTileForRedraw:key.integerValue];
    }
} 
```

调整图块字典意味着为每个可见图块设置一个图层，并为不可见图块删除图层。我们每次都会从头开始重置字典，但我们会尝试重用我们已经创建的图层。需要图层的图块是最新的图块和之前的图块，因此我们有足够的图层来覆盖视图。

```
- (void)adjustTileDictionary {
    NSInteger newestTile = tileForSampleIndex(_totalSampleCount - 1);
    // Add 1 to account for layers hanging off the left and right edges.
    NSInteger tileLayersNeeded = 1 + ceilf(self.bounds.size.width / kLayerWidth);
    NSInteger oldestTile = newestTile - tileLayersNeeded + 1;

    NSMutableArray *spareLayers = [[_tileLayers allValues] mutableCopy];
    [_tileLayers removeAllObjects];
    for (NSInteger tile = oldestTile; tile <= newestTile; ++tile) {
        CALayer *layer = [spareLayers lastObject];
        if (layer) {
            [spareLayers removeLastObject];
        } else {
            layer = [self newTileLayer];
        }
        [_tileLayers setObject:layer forKey:[NSNumber numberWithInteger:tile]];
    }

    for (CALayer *layer in spareLayers) {
        [layer removeFromSuperlayer];
    }
} 
```

第一次，以及任何时候视图变得足够宽时，我们都需要创建新层。在创建视图时，我们会告诉它避免为其内容或位置设置动画。否则默认情况下会为它们设置动画。

```
- (CALayer *)newTileLayer {
    CALayer *layer = [CALayer layer];
    layer.backgroundColor = [UIColor greenColor].CGColor;
    layer.actions = [NSDictionary dictionaryWithObjectsAndKeys:
        [NSNull null], @"contents",
        [NSNull null], @"position",
        nil];
    [self.layer addSublayer:layer];
    return layer;
} 
```

实际上布置平铺层只是设置每个层的框架：

```
- (void)layoutTileLayers {
    [_tileLayers enumerateKeysAndObjectsUsingBlock:^(id key, id obj, BOOL *stop) {
        CALayer *layer = obj;
        layer.frame = [self frameForTile:[key integerValue]];
    }];
} 
```

当然，诀窍是计算每一层的框架。y、width 和 height 部分很简单：

```
- (CGRect)frameForTile:(NSInteger)tile {
    CGRect myBounds = self.bounds;
    CGFloat x = [self xForTile:tile myBounds:myBounds];
    return CGRectMake(x, myBounds.origin.y, kLayerWidth, myBounds.size.height);
} 
```

为了计算图块框架的 x 坐标，我们计算图块中第一个样本的 x 坐标：

```
- (CGFloat)xForTile:(NSInteger)tile myBounds:(CGRect)myBounds {
    return [self xForSampleAtIndex:tile * kSamplesPerTile myBounds:myBounds];
} 
```

计算样本的 x 坐标需要一点思考。我们希望最新的样本位于视图的右边缘，第二最新的样本位于视图`kPointsPerSample`的左侧，依此类推：

```
- (CGFloat)xForSampleAtIndex:(NSInteger)index myBounds:(CGRect)myBounds {
    return myBounds.origin.x + myBounds.size.width - kPointsPerSample * (_totalSampleCount - index);
} 
```

## 重绘

现在我们可以谈谈如何实际绘制瓷砖。我们将在单独的 GCD 队列上进行绘图。我们不能同时从两个线程安全地访问大多数 Cocoa Touch 对象，所以在这里我们需要小心。我们将`rq_`在所有运行的方法上使用前缀 of`_redrawQueue`来提醒自己我们不在主线程上。

要重绘一个瓦片，我们需要获取瓦片编号、瓦片的图形边界以及要绘制的点。所有这些东西都来自我们可能在主线程上修改的数据结构，所以我们只需要在主线程上访问它们。所以我们派回主队列：

```
- (void)rq_redrawOneTile {
    __block NSInteger tile;
    __block CGRect bounds;
    CGPoint pointStorage[kSamplesPerTile + kPaddingSamples * 2];
    CGPoint *points = pointStorage; // A block cannot reference a local variable of array type, so I need a pointer.
    __block NSUInteger pointCount;
    dispatch_sync(dispatch_get_main_queue(), ^{
        tile = [self dequeueTileToRedrawReturningBounds:&bounds points:points pointCount:&pointCount];
    }); 
```

碰巧我们可能没有任何瓷砖可以重绘。如果您回头看`queueTilesForRedrawIfAffectedByLastSample`，您会发现它通常会尝试将同一个图块排队两次。由于`_tilesToRedraw`是一个集合（不是数组），因此重复项被丢弃，但`rq_redrawOneTile`无论如何都被分派了两次。所以我们需要检查我们是否真的有一个要重绘的图块：

```
 if (tile == NSNotFound)
        return; 
```

现在我们需要实际绘制瓦片的样本：

```
 UIImage *image = [self rq_imageWithBounds:bounds points:points pointCount:pointCount]; 
```

最后，我们需要更新瓦片的图层以显示新图像。我们只能触摸主线程上的一个层：

```
 dispatch_async(dispatch_get_main_queue(), ^{
        [self setImage:image forTile:tile];
    });
} 
```

下面是我们实际绘制图层图像的方式。我假设你知道足够的核心图形来遵循这个：

```
- (UIImage *)rq_imageWithBounds:(CGRect)bounds points:(CGPoint *)points pointCount:(NSUInteger)pointCount {
    UIGraphicsBeginImageContextWithOptions(bounds.size, YES, 0); {
        CGContextRef gc = UIGraphicsGetCurrentContext();
        CGContextTranslateCTM(gc, -bounds.origin.x, -bounds.origin.y);

        [[UIColor orangeColor] setFill];
        CGContextFillRect(gc, bounds);

        [[UIColor whiteColor] setStroke];
        CGContextSetLineWidth(gc, 1.0);
        CGContextSetLineJoin(gc, kCGLineCapRound);
        CGContextBeginPath(gc);
        CGContextAddLines(gc, points, pointCount);
        CGContextStrokePath(gc);
    }
    UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    return image;
} 
```

但是我们仍然需要获取瓦片、图形边界和要绘制的点。我们派回主线程来做这件事：

```
// I return NSNotFound if I couldn't dequeue a tile.
// The `pointsOut` array must have room for at least
// kSamplesPerTile + 2*kPaddingSamples elements.
- (NSInteger)dequeueTileToRedrawReturningBounds:(CGRect *)boundsOut points:(CGPoint *)pointsOut pointCount:(NSUInteger *)pointCountOut {
    NSInteger tile = [self dequeueTileToRedraw];
    if (tile == NSNotFound)
        return NSNotFound; 
```

图形边界只是瓦片的边界，就像我们之前计算的设置层的框架一样：

```
 *boundsOut = [self frameForTile:tile]; 
```

我需要在瓷砖的第一个样本之前从填充样本开始绘制图形。但是，在有足够的样本来填充视图之前，我的图块编号实际上可能是负数！所以我需要确保不要尝试以负索引访问样本：

```
 NSInteger sampleIndex = MAX(0, tile * kSamplesPerTile - kPaddingSamples); 
```

当我们计算停止绘图的样本时，我们还需要确保我们不会尝试超过样本的末尾：

```
 NSInteger endSampleIndex = MIN(_totalSampleCount, tile * kSamplesPerTile + kSamplesPerTile + kPaddingSamples); 
```

当我实际访问样本值时，我需要考虑我丢弃的样本：

```
 NSInteger discardedSampleCount = _totalSampleCount - _samples.count; 
```

现在我们可以计算要绘制的实际点：

```
 CGFloat x = [self xForSampleAtIndex:sampleIndex myBounds:self.bounds];
    NSUInteger count = 0;
    for ( ; sampleIndex < endSampleIndex; ++sampleIndex, ++count, x += kPointsPerSample) {
        pointsOut[count] = CGPointMake(x, [[_samples objectAtIndex:sampleIndex - discardedSampleCount] floatValue]);
    } 
```

我可以返回点数和图块：

```
 *pointCountOut = count;
    return tile;
} 
```

下面是我们实际上如何从重绘队列中拉出一个图块。请记住，队列可能为空：

```
- (NSInteger)dequeueTileToRedraw {
    NSNumber *number = [_tilesToRedraw anyObject];
    if (number) {
        [_tilesToRedraw removeObject:number];
        return number.integerValue;
    } else {
        return NSNotFound;
    }
} 
```

最后，这是我们如何将切片图层的内容实际设置为新图像。请记住，我们派回主队列来执行此操作：

```
- (void)setImage:(UIImage *)image forTile:(NSInteger)tile {
    CALayer *layer = [_tileLayers objectForKey:[NSNumber numberWithInteger:tile]];
    if (layer) {
        layer.contents = (__bridge id)image.CGImage;
    }
} 
```

## 让它更性感

如果你做所有这些，它会工作得很好。但实际上，当新样本出现时，您可以通过动画层的重新定位来使其看起来更好看。这很容易。我们只是修改`newTileLayer`，以便它为`position`属性添加动画：

```
- (CALayer *)newTileLayer {
    CALayer *layer = [CALayer layer];
    layer.backgroundColor = [UIColor greenColor].CGColor;
    layer.actions = [NSDictionary dictionaryWithObjectsAndKeys:
        [NSNull null], @"contents",
        [self newTileLayerPositionAnimation], @"position",
        nil];
    [self.layer addSublayer:layer];
    return layer;
} 
```

我们创建这样的动画：

```
- (CAAnimation *)newTileLayerPositionAnimation {
    CABasicAnimation *animation = [CABasicAnimation animationWithKeyPath:@"position"];
    animation.duration = 0.1;
    animation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionLinear];
    return animation;
} 
```

您需要设置持续时间以匹配新样本到达的速度。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T15:47:57.343

您不必在每次绘制时都将整个路径栅格化 - 您可以将其缓存为栅格位图。顺便说一句，您对“滚动”的想法是此类任务的标准解决方案......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T16:37:11.217

创建一个与视图高度相同但宽度为两倍的位图上下文。开始将点绘制到上下文中，然后在 drawRect 中创建一个 CGImageRef。这个想法是当您最初填充屏幕时，您的图像将从头开始。您将绘制的图像将具有适当的宽度和高度，但 bytesPerRow 将是 2 倍（更多信息）。当它们出现时，您会继续绘制新点，直到到达最后一点 - 现在 x 已经用尽了。

继续在您的上下文中写入点，但是现在，当您创建图像时，将初始指针偏移一个像素。继续这样做，直到你完成了 2 行 - 你现在处于上下文的最后。

那时，您需要将图像的“右侧”向左移动，并重置偏移计数。也就是说，您需要 memcpy(starOfBitMap, startOfBitMap+bytesPerRow/2, sizeOfBitMap - bytesPerRow/2)。本质上，您是在左移一个可见帧。

现在，当您添加新线时，它位于第一帧的末尾，并且您在绘制时开始偏移一个像素。

# java - 检查方法是否被调用

> ID：12162862
> 
> 赞同：0
> 
> 时间：2012-08-28T15:43:58.853
> 
> 标签：java, methods, osgi, aop

我正在尝试创建一个日志记录`OSGi`包，它能够记录所有标有特定注释的方法的输入、输出、异常（如果有）参数。

我尝试设置`Spring` `AOP`登录，`OSGi`但没有成功。

我只需要知道如何确定何时调用该方法？例如，我已经扫描了一个类中所有用我的注释进行注释的方法，并且我在数组或列表中有这些方法。

例如有三种方法：`getStatus`, `getDetails`, `getSomething`。并且用户调用`getDetails`方法，那么我应该如何知道何时调用该方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T06:58:31.493

检测方法调用需要您[检测您的代码](http://en.wikipedia.org/wiki/Instrumentation_%28computer_programming%29)。如果您想在运行时执行此操作，则需要字节码操作（据我所知，这是 Spring AOP 所做的）。或者，您可以在编译时使用生成检测的 Java 代码的自定义预处理步骤检测您的代码，但我不知道这是否容易得多。

我想你最好的选择是尝试 Spring AOP 工作。

# php - 将 php 文档的响应加载到文本字段中 - jQuery/Ajax

> ID：12162864
> 
> 赞同：0
> 
> 时间：2012-08-28T15:44:04.617
> 
> 标签：php, jquery, html, ajax

我的实际项目确实有一点问题。

我的 .HTML 文档通过 post 向 php 文档提供了一些数据，该文档仅回显了一些数字和字母，但没有空格。所以现在我喜欢将响应直接加载到文本框中，而不显示“丑陋”的响应 php 文档或重新加载站点。

感谢帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:52:17.590

```
$.ajax({
    url: "/mydoc.php",
    type: 'POST',
    data: {tb1: "arbitrary"}, // this could be anything
    success: function(data) {
        $("#myTextBox").val(data);
    }}); 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:51:40.887

您可以使用 jquery 完成此操作。

您将需要捕获您的响应并设置 textfield`value`属性。

如果您正在获取数据，也许您应该使用 GET 方法而不是 post。

```
$.get('your_php_url?some_data=here&some_more_data=here', function(response, status) {
  if (status === 'success') {
    $('#your_textbox').val(response);    
  }

}); 
```

或者甚至更好地用 JSON 编码您的数据，而不是传递纯文本。

`$.getJSON`并将您的文本框设置为 json 响应

您可以使用 submit 将提交处理程序附加到您的表单。确保返回 false 以使表单不会转到操作页面。

# android - 如何将日期选择器保存到共享首选项

> ID：12162865
> 
> 赞同：0
> 
> 时间：2012-08-28T15:44:10.063
> 
> 标签：android, datepicker, sharedpreferences

有没有办法将日期选择器数据保存到共享首选项？如果是这样，你能给我一些关于如何做的代码吗？我将使用 datepicker 来保存用户的出生日期。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:49:16.390

你可以，以迂回的方式。根据 DatePicker 的年/月/日值，构造一个`java.util.Date`对象。然后调用`getTime()`该对象 - 它会将日期作为一个非常长的数字（自 1970 年以来的毫秒数）作为 datatype 返回`long`。然后您可以将其存储在`SharedPreferences`using`putLong()`并使用`getLong()`.

要将日期放回选择器，请`Date`使用该值构造一个对象`long`，然后从中检索年/月/日。

或者，您可以将年/月/日保存为三个单独的首选项。

编辑：这是一个示例。DatePicker 对象来自您应用程序中的某个位置 - 我不知道。

```
DatePicker dp; //Where does this come from? You tell me.
Date d = new Date(dp.getYear(), dp.getMonth(), dp.getDay());
SharedPreferences Prefs = PreferenceManager.getDefaultSharedPreferences(Ctxt);
Prefs.edit().putLong("Birthday", d.getTime()).commit(); 
```

# xml - 知道图像何时完成从服务器加载

> ID：12162873
> 
> 赞同：0
> 
> 时间：2012-08-28T15:44:20.640
> 
> 标签：xml, ajax, jquery

是否有任何类型的`oncomplete`方法可以知道图像何时从服务器完全加载？

我有一个 XML 提要，我使用它来获取图像 URL，然后将它们显示在我创建的画廊中。这些图像以各种不同的尺寸出现，我正在尝试调整它们的大小以适应特定的纵横比。我无法调整它们的大小，因为我没有宽度和高度。

以下是我通过 Jquery 提取提要的方式：

```
$.get('feed/test.xml', function(data){
        $(data).find('item').each(function(){  
            var obj = $(this);
            var image = obj.find('ImageURL').text();  //  http://testimageurl.com

            var str = ' <li>';
            str += '        <img src="'+ image +'" />';
            str += '    </li>';

            $("#slider").append(str);
        });

         // Code for resizing images goes here
    }); 
```

加载完成后，我需要能够从 URL 获取图像大小。

对任何人都有意义吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:45:35.303

您正在寻找`load`（`complete`如果图像已被缓存）事件：

尝试改变

```
$("#slider").append(str); 
```

进入

```
$(str).find('img')
   .one('load complete', function() {
       /* do something onload or complete event */
   })
   .end()
   .appendTo($("#slider")); 
```

# vb6 - 如何在 VB6 中调整 LeadRasterDlgFile 对话框的大小

> ID：12162881
> 
> 赞同：0
> 
> 时间：2012-08-28T15:44:52.137
> 
> 标签：vb6

我有一个使用leadtools 14 的vb6 应用程序。代码引用Class LeadRasterDlgFile 中的成员ShowDirectoryDlg。最终用户已要求将此对话框放大。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T16:03:29.263

我不知道这个库，也没有简单的方法可以在网站上搜索 LeadRasterDlgFile。无论如何，我假设您已经搜索了文档以找到执行此操作的方法。

这只留下 Windows API 调用。在将计时器设置为启用后，您必须使用设置为触发 1 毫秒的计时器。然后你调用你的函数。在计时器事件循环中，使用 FindWindow() 或 FindWindowsEx() 来获取对话窗口。接下来，使用 MoveWindow() 调整窗口大小。您可能还想调整子窗口的大小。使用 GetWindow() 来识别子窗口。使用 Spy++ 检查子窗口 ID。

请注意，这仅适用于已编译的应用程序 - 而不是 IDE。

这样做的问题是对话可能不使用标准的 Windows 窗口。您将使用 Spy++ 发现这一点。

# mysql - MySQL 中的复合键查询

> ID：12162890
> 
> 赞同：0
> 
> 时间：2012-08-28T15:45:18.797
> 
> 标签：mysql, join, subquery

我有一个名为 Modules 的表，其中包含列（M_Id、Name、Version、Descr）。我有另一个表详细说明每个模块的依赖关系，即一个模块可能依赖于另一个模块。为此，我使用了一个名为 Mod_depends 的表，它具有复合键 (M_Id_1, Depends)。示例条目：

```
Module
1 | Chameleon | 2.9.2 | HTML/XML template engine
2 | Unittest2 | 1.0.0 | unittest module
3 | OrderedDict | 1.0.1 | Ordered dictionary

Mod_depends
1 | 2
1 | 3 
```

我正在寻找一个 MySQL 查询，对于给定的 id，它可以从表示依赖项的 Modules 表中返回条目。在上面的示例中，提供 Id = 1 将返回：

```
2 | Unittest2 | 1.0.0 | unittest module
3 | OrderedDict | 1.0.1 | Ordered dictionary 
```

这是否需要连接或一些子查询魔术或两者兼而有之？

有没有一种方法可以添加约束，以便仅当模块表中存在条目时才能添加到 Mod_depends 表？

干杯

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:51:24.743

好吧，你没有给出你的领域的名字，所以我只是做了一些希望能解释的事情。基本上，您加入模块表中的 id 和 mod_depends 表中的依赖项 id（右列），然后使用 mod_depends 表中的模块 id（左列）查找，如下所示：

```
SELECT m.module_id, m.module_name, m.module_version, m.module_description FROM module as m INNER JOIN mod_depends as md on m.module_id = md.module_dependency_id
WHERE md.module_id = 1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:54:31.690

对于最简单的情况（仅限一阶依赖项），它是这样的：

```
 SELECT m.M_id, m.Name, m.Version, m.Descr
      FROM Module AS m
INNER JOIN Mod_depends AS md
        ON m.M_id = md.Depends
     WHERE md.M_Id_1 = 1; 
```

...但是找到更深层次的依赖关系将是一项非常重要的任务，因为它将成为对树状结构的查询。因此，您可以使用[此讨论](https://stackoverflow.com/questions/10999888/mysql-adjacency-list-model-get-depth)来获取想法，也可以将您的数据库从邻接表重组为闭包表。也许您也想检查[这个精彩的答案](https://stackoverflow.com/a/192462/1229023)。)

# java - 为什么这段代码不读取我的文件？

> ID：12162892
> 
> 赞同：0
> 
> 时间：2012-08-28T15:45:25.390
> 
> 标签：java, exception, file-io

这是我从文本文件中读取的代码：

```
 public RecordManager(){
    int pos;
    String athlete, record, country, raceTime;
    try {
        Scanner scFile = new Scanner(new File("resultdata.txt"));
        while(scFile.hasNext()){
            Scanner sc = new Scanner(scFile.next()).useDelimiter("#");
            athlete = sc.next();
            country = sc.next();
            pos = sc.nextInt();
            record = sc.next();
            raceTime = sc.next();                
            sc.close();
            if("WRC".equals(record)){
                resultArr[size] = new WorldRecord(athlete, country, pos, raceTime);
            }
            else if("OLR".equals(record)){
                resultArr[size] = new OlympicRecord(athlete, country, pos, raceTime);
            }
            else{
                resultArr[size] = new RaceResult(athlete, country, pos, raceTime);
            }
            size++;
        }
    } catch (FileNotFoundException ex) {
        Logger.getLogger(RecordManager.class.getName()).log(Level.SEVERE, null, ex);
    } 
```

这是文本文件中的内容：

```
Carey Blem#ITA#6#---#4m49.8 
Tammera Hoesly#POR#1#---#4m6.2 
Toi Swauger#FRA#1#OLR#51.3 
Moises Mellenthin#ZIM#2#---#4m34 
Madelene Mcclennon#LUX#1#WRC#1m52.7 
Lashon Meisenheimer#RSA#1#---#2m31.2 
```

我一直在尝试和尝试，但我只是不断得到这个：

```
run:
Exception in thread "main" java.util.NoSuchElementException
at java.util.Scanner.throwFor(Scanner.java:907)
at java.util.Scanner.next(Scanner.java:1416)
at it.practical.training.RecordManager.<init>(RecordManager.java:29)
at it.practical.training.SimpleInterface.main(SimpleInterface.java:20)
Java Result: 1
BUILD SUCCESSFUL (total time: 13 seconds) 
```

请告诉我有什么问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T15:48:54.273

当您使用`next()`它时，它会读取下一个单词。你的第一行有两个词`Carey`和`Blem#ITA#6#---#4m49.8`。当您从一行中读取单词时，您需要使用`nextLine()`它转到下一行。

我怀疑你真正想要的是

```
Scanner sc = new Scanner(scFile.nextLine()).useDelimiter("#"); 
```

一次读一整行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T16:13:59.280

我不完全确定出了什么问题，但我根本不会使用 Scanner 读取文件。我会使用[BufferedReader](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/BufferedReader.html)，并在 readline 方法不返回 null 时循环。然后我会使用 String 类的 split 方法来获取您需要的信息。例如

```
public RecordManager(){
  int pos;
  String line;
  String[] info;
  try {
    BufferedReader scFile = new BufferedReader(new FileReader(new File("resultdata.txt")));
    line = scFile.readLine();
    while(line != null){
        info = line.split("#");//now athlete is in index 0, country at index 1 etc              
        if("WRC".equals(info[3])){
            resultArr[size] = new WorldRecord(info[0], info[1], info[2], info[4]);
        }
        else if("OLR".equals(info[3])){
            resultArr[size] = new OlympicRecord(info[0], info[1], info[2], info[4]);
        }
        else{
            resultArr[size] = new RaceResult(info[0], info[1], info[2], info[4]);
        }
        size++;
        line = scFile.readLine();
     }
  } catch (FileNotFoundException ex) {
    Logger.getLogger(RecordManager.class.getName()).log(Level.SEVERE, null, ex);
  }
} 
```

我知道它不会直接回答您的代码出了什么问题，但它提供了一种替代方法来满足您的需求。我希望它无论如何都会有所帮助。

# c++ - 当结构具有 c-tor 时，为什么我不能静态初始化它？

> ID：12162893
> 
> 赞同：3
> 
> 时间：2012-08-28T15:45:31.380
> 
> 标签：c++, static, constructor, initialization, structure

我的问题：当一个结构有 c-tor 时，为什么我不能静态初始化它？

我的编译器声称：

```
type `myStruct' must be initialized by constructor, not by `{...}' 
```

这是为什么 ？我正在使用 gcc 3.4.4 版（cygming 特殊，gdc 0.12，使用 dmd 0.125）

为了说明，这里是`struct`编译器拒绝的。

```
struct myStruct
{
    int a;
    double b;

    myStruct() { a= 0; b = 0.0; }
}

void main()
{
    myStruct ms = {7, 7.7}; // Now this compiler does not accept.
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-28T15:47:37.470

包含用户定义的 c-tor 意味着它不再是聚合类型。如果自身没有用户定义的 c-tor ，但您有一个非POD 或聚合类型`struct`的非静态数据成员，也会出现这种情况。`struct`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-28T15:50:38.497

因为语言以这种方式指定它......

原因是构造函数是将对象初始化为有效状态的指定方式，因此直接将值转储到字段中是没有意义的。想法是你要么有一个值的集合，要么有一个自包含的对象，但你想做的事情会两者兼而有之。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-28T15:57:37.873

只有聚合可以使用初始化列表进行初始化。根据 8.5.1:1，包含用户提供的构造函数可防止结构或类成为聚合：

> [c++11](/questions/tagged/c%2b%2b11 "显示标记为“c++11”的问题")
> 
> ### 8.5.1 聚合 [dcl.init.aggr]
> 
> 1 - 聚合是一个数组或一个类（第 9 条），没有用户提供的构造函数 [...]

在 C++03 中，

> [c++03](/questions/tagged/c%2b%2b03 "显示标记为“c++03”的问题")
> 
> ### 8.5.1 - 聚合 [dcl.init.aggr]
> 
> 1 - 聚合是一个数组或一个类（子句类），没有用户声明的构造函数 [...]

聚合不同于 POD ( [c++11](/questions/tagged/c%2b%2b11 "显示标记为“c++11”的问题") 9:10)；并非所有聚合都是 POD，也不是所有 POD 都是聚合；具有用户提供的析构函数的类可以是聚合但不是 POD，而具有非复制非默认构造函数的类可以是 POD 但不是聚合。

示范：

```
#include <type_traits>
#include <iostream>

struct non_pod_aggregate { int i, j; ~non_pod_aggregate() {} };
struct non_aggregate_pod { int i, j; non_aggregate_pod(int) {}
    non_aggregate_pod() = default; };

int main() {
    std::cout << std::is_pod<non_pod_aggregate>::value << '\n'; // false
    std::cout << std::is_pod<non_aggregate_pod>::value << '\n'; // true
    non_pod_aggregate{0, 0};
    // non_aggregate_pod{0, 0}; // does not compile
} 
```

在 C++03 中，所有 POD ( [c++03](/questions/tagged/c%2b%2b03 "显示标记为“c++03”的问题") 9:4) 都是聚合，但仍有可能存在不是 POD 的聚合；如上所述，用户提供的析构函数足以使结构失去 POD 的资格。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-28T15:48:38.703

在 C++03 中，列表初始化仅适用于聚合。您需要更改代码以调用构造函数：

```
myStruct ms; 
```

如果您希望能够为所有成员指定值，则需要添加一个带有足够参数的构造函数：

```
struct myStruct
{
    int a;
    double b;

    myStruct() : a(), b() { }
    myStruct(int a, double b) : a(a), b(b) { }
};

void main()
{
    myStruct ms(7, 7.7);
} 
```

# java - 如何从 javax.naming.directory.Attribute 中提取值

> ID：12162898
> 
> 赞同：8
> 
> 时间：2012-08-28T15:45:45.163
> 
> 标签：java, ldap, jndi

这个问题说明了一切。当我打印一个属性时，它是：

```
cn: WF-008-DAM-PS 
```

代码片段是：

```
private void searchGroup() throws NamingException {
    NamingEnumeration<SearchResult> searchResults = getLdapDirContext().search(groupDN, "(objectclass=groupOfUniqueNames)", getSearchControls());
    String searchGroupCn = getCNForBrand(m_binder.getLocal("brandId"), m_binder.getLocal("brandName"));
    Log.info(searchGroupCn);
    while (searchResults.hasMore()) {
        SearchResult searchResult = searchResults.next();
        Attributes attributes = searchResult.getAttributes();
        Attribute groupCn = attributes.get("cn");
        if(groupCn != null) {
            Log.info(groupCn.toString());               
        }
    }
} 
```

我怎样才能只获得值：`WF-008-DAM-PS`，即没有关键部分？问候。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-24T11:49:00.533

解决方案是：

```
Attribute groupCn = attributes.get("cn");
String value = groupCn.get(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-28T15:51:11.210

调用`getValue()`方法或`getValue(int)`方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-12-17T14:49:57.187

**一般的**

假设我们有：

```
Attributes attributes;
Attribute a = attributes.get("something"); 
```

*   `if(a.size() == 1)`
    *   那么您可以使用`a.get()`or`a.get(0)`来获取唯一值
*   `if(a.size() > 1)`

    *   遍历所有值：

        ```
        for ( int i = 0 ; i < a.size() ; i++ ) {
            Object currentVal = a.get(i);
            // do something with currentVal
        } 
        ```

        如果在`a.get()`此处使用，它将仅返回第一个值，因为它的内部实现 (in `BasicAttribute`) 如下所示：

        ```
        public Object get() throws NamingException {
            if (values.size() == 0) {
                throw new NoSuchElementException("Attribute " + getID() + " has no value");
            } else {
                return values.elementAt(0);
            }
        } 
        ```

两种方法 (`get(int)`和`get()`) 都会抛出一个`NamingException`.

**实际例子**
（当`Attribute`实例有多个值时）

```
LdapContext ctx = new InitialLdapContext(env, null);

Attributes attributes = ctx.getAttributes("", new String[] { "supportedSASLMechanisms" });
System.out.println(attributes); // {supportedsaslmechanisms=supportedSASLMechanisms: GSSAPI, EXTERNAL, DIGEST-MD5}

Attribute a = atts.get("supportedsaslmechanisms");
System.out.println(a); // supportedSASLMechanisms: GSSAPI, EXTERNAL, DIGEST-MD5

System.out.println(a.get()); // GSSAPI

for (int i = 0; i < a.size(); i++) {
    System.out.print(a.get(i) + " "); // GSSAPI EXTERNAL DIGEST-MD5
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-27T11:18:07.330

这有效：（在获取属性值之前检查属性是否存在）

```
 Attributes attributes = searchResult.getAttributes();
            Attribute mail = attributes.get("mail");
            if (mail != null)
               {
                   System.out.println(" Mail-id value from LDAP :"+mail.get());
               } 
```

# z3 - 数组和量词

> ID：12162900
> 
> 赞同：4
> 
> 时间：2012-08-28T15:45:53.133
> 
> 标签：z3, smt

我正在尝试在 Z3 中使用数组和量词来查找给定文本中的子字符串。

我的代码如下：

```
(declare-const a (Array Int Int))
(declare-const x Int)

;; a|A
(assert (or (= (select a 0) 61) (= (select a 0) 41)))
;; b|B
(assert (or (= (select a 1) 62) (= (select a 1) 42)))
;; c|C
(assert (or (= (select a 2) 63) (= (select a 2) 43)))

(assert (>= x 0))
(assert (< x 3))

(assert (exists ((i Int)) (= (select a i) 72) ))
(check-sat) 
```

Z3 在不应该的时候说那是 SAT。我对 Z3 和 SMT 理论相当陌生，我无法弄清楚我的代码有什么问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T16:13:31.220

在您的示例中，实际上可以通过将 i 设为 0、1、2 范围之外的任何自然数来满足。因此，例如，如果您让 i = 3，因为您没有以任何方式限制索引 3 处的数组， a[3] 可能是 72。

这是一个链接，显示了 Z3@Rise 界面上您的示例的令人满意的分配（模型），以及接下来描述的修复：[http ://rise4fun.com/Z3/E6YI](http://rise4fun.com/Z3/E6YI)

为了防止这种情况发生，一种方法是将 i 的范围限制为您已经分配的数组索引之一。也就是说，将 i 限制在 0 和 2 之间。

```
(declare-const a (Array Int Int))
(declare-const x Int)

;; a|A
(assert (or (= (select a 0) 61) (= (select a 0) 41)))
;; b|B
(assert (or (= (select a 1) 62) (= (select a 1) 42)))
;; c|C
(assert (or (= (select a 2) 63) (= (select a 2) 43)))

(assert (>= x 0))
(assert (< x 3))

(assert (exists ((i Int)) (= (select a i) 72)))
(check-sat)
(get-model) ; model gives i == 3 with a[i] == 72

(assert (exists ((i Int)) (and (>= i 0) (<= i 2) (= (select a i) 72) )))
(check-sat) 
```

# assembly - 如何用汇编语言（intel）执行机器指令

> ID：12162906
> 
> 赞同：0
> 
> 时间：2012-08-28T15:46:07.993
> 
> 标签：assembly, x86, fasm

例如，如果我有一条像 00010101 这样的指令，并且我将它放在 ram 中供程序访问，我如何能够在不使用 OS 函数的情况下以汇编语言执行该指令？我正在将 Fasm 用于英特尔。谢谢。

编辑：我知道这是非常糟糕的代码，我什至还没有组装它，我知道很多都是错误的，但请记住这是出于学习目的。这是加载带有二进制指令的文件并将其存储在 ram 中的代码部分。我再一次知道这很糟糕。

```
loadkernel:
    mov dx, 1F7h
    in dx, bl
    bt bl, 6    ;this reads the sixth bit of bl and stores it in the carry flag(cf)

    cmp cf, 1   ;if bit 6 is one, then the hard drive is signaling that it is ready for the next operation
    jz loadkernel
    clc ;clear carry flag

beginload:
    mov eax, 300h
    mov ecx, eax    ;copy the starting point of the kernel in memory to ecx
    mov ebx, 0  ;clear
    mov edx, 0  ;clear

    mov bl, 1F4h
    out ebx, bl ;give the hard drive the low address of the location of the kernel
    mov bl, 1F5h
    out 0h, bl      ;give the hard drive the high address of the location of the kernel

    mov bl, 1F0h

    in edx, bl   ;read the hard drive
    mov [eax], edx   ;add kernel data to memory
    add eax, 1

    inc ebx     ;move the hard drive reading head thing forward

    mov ip, [eax]   ;mov the instruction pointer to memory, so that the computer excecutes the kernel

    cmp edx, 0AA55h
    jz beginload    ;if 0AA55h is not at the end, then read the next data of the kernel. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T16:11:53.747

根据您的执行环境，您可能必须为您的程序禁用（大多数）操作系统的 Execute-Disable 安全性。这是为了使易受攻击的程序更难注入代码。如果您在独立环境（如 DOS 或您自己的内核）中运行，则无需担心。

无论如何，您所要做的就是：

```
mov ax,0x9090 //0x90 is opcode for NOP
mov [code],ax
code:
jmp  foo //this is a 2-byte opcode (so long as it does the "correct" behavior and generate a relative jmp

bar:
hlt //this will get executed "magically"

foo:
//won't get here 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T15:47:23.503

只需跳转到存储指令的地址即可。

# c# - 确定线程运行了多长时间

> ID：12162911
> 
> 赞同：0
> 
> 时间：2012-08-28T15:46:22.713
> 
> 标签：c#, multithreading, c#-4.0, timer

我需要一个允许我在线程运行超过 X 秒时执行某些操作的逻辑。

就像在这个非常丑陋的例子中一样，它会每秒检查一次，如果`workerThread`运行了 10 分钟或更长时间，它会显示一条消息......

```
var timeWorking = TimeSpan.FromMinutes(0);
workerThread = new Thread(RunTask);
workerThread.Start(task);
while (workerThread.IsAlive)
{
    Thread.Sleep(TimeSpan.FromSeconds(1));
    timeWorking = timeWorking.Add(TimeSpan.FromSeconds(1));
    if (timeWorking.TotalMinutes < 10) continue;
    timeWorking = TimeSpan.FromMinutes(0);
    Console.Writeline("Here we go... the event")
} 
```

请帮我把它做对......我应该使用什么`Diagnostics.StopWatch`，`System.Timers.Timer`或者`Threading.Timer`？

UPD：所有的答案让我更加困惑......

任务是检查是否`workerThread`运行超过 X 时间，如果是，则调用某个方法，重置计时器并再次检查`workerThread`自上次调用该方法以来现在是否运行超过 X 时间……等等等等……

UPD2：基本上我有一个线程根据从 AmazonSQS 队列中提取的信息进行处理。SQS 队列消息具有可见性超时。如果任务花费的时间超过默认可见性超时 - 消息将在任务完成之前返回队列。然后它将被另一台机器拾取。为避免这种情况，我需要延长 SQS 消息的可见性超时。所以我可以通过定期检查线程是否仍然如此来做到这一点，`isALive`然后我可以在消息可见性超时中增加几分钟。大约一分 50 秒后，我应该再次检查线程是否仍然存在，`isALive`然后再添加几分钟，依此类推。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:53:27.800

根据您的描述，我认为[System.Timers.Timer更适合。](http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx)但是，这取决于。如果你想用计时器对 UI 做一些事情。Forms.Timer 更好。

在任何一种情况下，您都可以简单地检查当计时器经过（或 Ticked）时线程是否仍然处于活动状态，如果是，则执行一些操作。

例如

```
 timeThreadStarted = DateTime.Now;
    workerThread = new Thread(RunTask);
    System.Timers.Timer timer = new System.Timers.Timer(TimeSpan.FromSeconds(1).TotalMilliseconds);
    timer.Elapsed += new System.Timers.ElapsedEventHandler(timer_Elapsed);
    workerThread.Start(task);
//...

static void timer_Elapsed(object sender, System.Timers.ElapsedEventArgs e)
{
    if(workerThread != null && workerThread.IsAlive)
    {
        Console.WriteLine("thread has been running for {0}!", DateTime.Now - timeThreadStarted);
    }
} 
```

这会在 1 秒后检查线程状态。如果它仍然活着，那么它已经运行了至少一秒钟。

这样做的好处是不会阻塞任何线程。如果你有一个 UI 并且你想这样做，那么你不能阻止 UI 线程（它会变得无响应并提供糟糕的用户体验）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T15:55:33.397

既然你知道线程需要在十分钟后做某事，为什么不简单地在计时器上使用一个间隔，如下所示：

```
var interval = 1000 * 60 * 10; // ten minutes
var timer = new System.Timers.Timer(interval) { AutoReset = false };
timer.Elapsed += ((sender, eventArgs) =>
    {
        // Do your work here...
    });

workerThread = new Thread(RunTask);
workerThread.Start(task);
timer.Start(); 
```

这样您就不会检查每一秒，您将在所需的时间后执行您的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T15:59:55.083

您也可以`Thread.Join`使用[http://msdn.microsoft.com/en-us/library/23f7b1ct.aspx](http://msdn.microsoft.com/en-us/library/23f7b1ct.aspx)`TimeSpan`上的示例，这样您就不必执行.`Thread.Sleep`

注意：任何一种方法都会阻塞调用线程，直到时间过去。不适用于主/UI 线程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T15:55:18.237

您可以使用一个 Timer，一旦触发了经过的时间，它将引发一个事件。

```
 private static void Main(string[] args)
    {
        var thread = new Thread(
            () =>
                {
                    var timer = new System.Timers.Timer
                        {
                            Interval = 10000, //10s
                            AutoReset = false, //only raise the elapsed event once
                        };
                    timer.Elapsed += timer_Elapsed;
                    timer.Start();
                    while (true)
                    {
                        Console.WriteLine("Running...");
                        Thread.Sleep(1000); //Always put a thread to sleep when its blocking so it does not waste CPU cycles.
                    }
                });
        thread.Start();
    }

    private static void timer_Elapsed(object sender, ElapsedEventArgs e)
    {
        //thread is running for more that X (10s) amount of seconds
        Console.WriteLine("Timer elapsed");
    } 
```

这是一个简单的例子。在这个例子中，线程永远不会退出。但是您可以在必要时添加自己的逻辑来获得您想要完成的任务。

简短回答：是的，使用 System.Timers.Timer

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-28T15:57:44.667

您可以使用任务等待方法，例如

```
var t = Task.Factory.StartNew(() => MyAction()); // MyAction is an action to be executed in parallel

bool check = t.Wait(10000); //wait for 10000 milliseconds
if (check)
{
 // all ok
}
else 
{
  // over time 
} 
```

Wait 方法会阻塞，直到任务结束或发生超时。如果您不想阻塞主线程，您可以使用另一个并行工作的任务运行示例代码并检查工作任务。

# amazon-web-services - 我可以同时运行 1000 个 AWS 微实例吗？

> ID：12162915
> 
> 赞同：4
> 
> 时间：2012-08-28T15:46:29.717
> 
> 标签：amazon-web-services, cloud, instances

我有一个简单的纯 C 程序，它接受一个整数作为输入，运行一段时间（比如说一个小时），然后返回一个文本文件。我想用从 1 到 1000 的输入整数运行这个程序 1000 次。

目前我正在并行运行这个程序（4 个处理器），需要 250 小时。该程序适合 AWS 微实例（我已经测试过）。是否可以在一小时内使用 AWS 中的 1000 个微型实例来完成整个工作？（成本约为 20 美元 - 0.02 美元/次）？

如果可能的话，是否有人对如何做到这一点有一些指导方针？如果不是，是否有人也有低预算的替代方案？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T12:03:12.780

为了实现这一目标，您需要：

*   创建一个 S3 存储桶来存储您的引导脚本、应用程序、输入数据和输出数据

*   自定义轻量级 AMI：您可能想要创建一个自定义轻量级 AMI，它知道如何下载引导脚本

*   引导脚本：将从您的 S3 存储桶下载您的软件，解析包含整数 [1..1000] 的[自定义实例标签](http://docs.amazonwebservices.com/AWSEC2/latest/CommandLineReference/ApiReference-cmd-CreateTags.html)并下载任何其他数据。

*   您的应用程序：进行处理。

*   处理结束脚本是将结果上传到另一个结果 S3 存储桶并[终止实例](http://docs.amazonwebservices.com/AWSEC2/latest/CommandLineReference/ApiReference-cmd-TerminateInstances.html)，您可能还希望发送[SNS 通知](http://aws.amazon.com/sns/)以传达处理结束状态。

*   如果您需要**结果合并**，您可能希望创建另一个实例并将其用作协调器，等待所有“处理结束”通知以完成处理。在这种情况下，您可能会考虑在未来使用[Amazon 的 Hadoop map reduce](http://aws.amazon.com/elasticmapreduce/)引擎，因为它几乎可以免费完成所有这些繁重的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:55:09.063

您没有指定要使用哪种语言执行此操作，并且由于您用于部署程序的应用程序不必使用相同的语言，因此我建议您使用 C#。网络上有许多关于如何使用 SDK 以编程方式生成新 Amazon 实例的示例。例如：

[如何在 .NET 中以编程方式启动 Amazon EC2 实例](https://stackoverflow.com/questions/7420368/how-to-start-an-amazon-ec2-instance-programmatically-in-net)

您可以使用已经存在的程序创建自己的 AMI，但如果您想对其进行调整，这最终可能会很痛苦，因为它需要您重新创建整个 AMI。我建议创建一个额外的实例或简单地将程序托管在可从公共 URL 访问的位置。然后，我将创建某种服务，该服务将提前安装在 AMI 上，以允许我指定下载应用程序的 URL 以及该特定实例所需的任何命令行参数。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T12:22:11.463

请注意，默认情况下，您只能按区域生成 20 个实例。您需要询问亚马逊才能使用更多实例。

如果您想要低成本但不关心延迟，您应该使用现场实例。

# css - css 选择器合并

> ID：12162918
> 
> 赞同：0
> 
> 时间：2012-08-28T15:46:40.327
> 
> 标签：css, css-selectors

有没有办法合并这个选择器：

```
ul#social_footer li a:link,
ul#social_footer li a:visited {} 
```

我希望为两个锚状态选择 ID 为 #footer_navigate 的 ul 的相同选择器。

这是唯一的方法吗？

```
ul#social_footer li a:link,
ul#social_footer li a:visited,
ul#footer_navigate li a:link,
ul#footer_navigate li a:visited {} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T15:49:23.083

您可以假设其中没有您不想影响的其他*元素*`a`，将其缩短为：

 *```
ul li a:link,
ul li a:visited {
    /* css */
} 
```

这种方法确实存在一个问题，即您必须为由同一选择器匹配的其他链接覆盖给定样式。

不过，我建议使用类来识别那些共享样式的链接：

```
ul.navigation li a.happyColors:link
ul.navigation li a.happyColors:visited {
    /* CSS */
} 
```

显然，这确实需要编辑 html 以添加您选择使用的那些（或其他）类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T15:52:46.620

`ul`您可以在应该有两个选择器的所有标记处添加一个额外的公共类。

在这种情况下，您只能使用这个 css：

```
ul.*commonClass* li a:link, ul.*commonClass* li a:visited {}

<ul id="social_footer" class="*commonClass*" >...</ul>
<ul id="footer_navigate" class="*commonClass*" >...</ul> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T15:50:33.487

也许像这样：

```
 ul#social_footer li a:link, ul#social_navigate li a:link{

    }

    ul#footer_footer li a:visited, ul#footer_navigate li a:visited{

    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T17:08:41.370

我知道您已经发现添加一个类作为可接受的答案（确实如此）。您可能还想查看[lesscss](http://lesscss.org/)作为一种以编程方式应用 css 样式的方法。*

# javascript - 在 Javascript 中访问 Razor 布尔变量时出错

> ID：12162919
> 
> 赞同：3
> 
> 时间：2012-08-28T15:46:42.557
> 
> 标签：javascript, jquery, asp.net-mvc, asp.net-mvc-3, razor

我尝试了几种策略来使用 JS 中的布尔值，但没有任何效果：

```
<script type="text/javascript">
var model = @Html.Raw(Json.Encode(Model));
       if (model.IsNew == true) {
        alert("1");
     }
</script> 
```

尝试了以下方法：

```
var IsNew = @Model.IsNew ;
var IsNew = "@Model.IsNew"; 
```

我不断收到以下错误：

```
Conditional compilation is turned off 
```

任何人都可以解释为什么会发生这种情况，并可能指导我找到可能的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T15:57:02.187

尝试

```
if ('@Model.IsNew' == 'true') {
    alert("Is New");
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T15:47:38.453

那只是 VS IDE 无法理解 Razor 和 Javascript 的混合。

您的代码将正常工作。

# asp.net - CHILKAT CRYPT 在 64 位机器上失败

> ID：12162920
> 
> 赞同：1
> 
> 时间：2012-08-28T15:46:44.163
> 
> 标签：asp.net, cryptography, iis-6, encryption

我有一个 64 位 CHILKAT CRYPT 程序集（用于 .NET 4.0）。当我在 Windows Server 2003（64 位）的 IIS 6.0 中运行我的应用程序时，我收到一个错误，提示找不到程序集。另一方面，在我的本地机器上，我有一个 32 位程序集和 Windows7 32 位，它工作正常。

我应该怎么做才能克服这个错误，原因是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T15:52:10.230

我发现的主要问题是 Web 应用程序是为平台 x86 构建的，并部署到 x64 机器上，该机器不允许运行 32 位程序。在这种情况下，指示未找到程序集的错误是不正确的。它根本不兼容 x64 机器。

我发现以下步骤解决了这个问题：

1.  将 64 位程序集添加到 Web 应用程序项目 (visual studio 2010)
2.  从 Visual Studio 的配置管理器中选择 x64 作为目标平台
3.  构建解决方案并部署它

这个步骤真的解决了我的问题。

# regex - 如果存在某个单词，但不存在另一个部分单词，则 RegEx 排除匹配

> ID：12162921
> 
> 赞同：2
> 
> 时间：2012-08-28T15:46:44.607
> 
> 标签：regex, url, filtering, firewall

我有我们的防火墙用来阻止成人网站的关键字“cum”，问题是这有点太好用了，因为这也阻止了任何带有单词“document”的 URL

防火墙将采用正则表达式字符串，我尝试了这个：

```
^.*(?!document)cum.*$ 
```

Vut 它仍然匹配“文档”。我有一种感觉，我应该使用管道`|`，但我不明白。

我想要的是匹配任何地方

```
*cum* 
```

在 URL（或域名）中找到，但如果单词是`document`or ，则不是`documents`。

可能的？据我了解，单词边界在这里不起作用，因为该单词`cum`在 URL 中时不一定会被空格分隔，如果它在域名中则绝对不会。

这是另一种说法：

```
Allow "examplesearchdocuments.com"
Allow "examplemydocuments.com"
Allow "documentexample.com"
Allow "example.com/somedocuments"
Don't allow "funnycumsiteexample.com"
Don't allow "cumallovereverythingexample.com"
Don't allow "exampleseemycum.com" 
```

哪里`cum`是坏词匹配。抱歉，如果这些示例中的任何一个是真实站点，我不知道如何传达这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T16:14:24.137

根据评论，我错了。

如果您在前瞻中使用后向搜索，则只有当它不在“文档”一词中时，您才能匹配“cum”。

```
cum(?!(?<=docum)ent) 
```

这是一些关于环视的阅读[http://www.regular-expressions.info/lookaround.html](http://www.regular-expressions.info/lookaround.html)

这是针对大量测试的。

[http://www.rubular.com/r/b5iZrn6Cjz](http://www.rubular.com/r/b5iZrn6Cjz)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T16:14:37.753

我的第一个建议也是`\bcum\b`像其他人一样使用，但这不匹配，例如卡明。

`(?!)`否定环视语法几乎是正确的：

*   对于负面的向后看，您需要`<`
*   对于负前瞻，您不需要`>`
*   有关更多信息，请参见：[http ://www.regular-expressions.info/lookaround.html](http://www.regular-expressions.info/lookaround.html)

> `^.*(?<!do)cum(?!ent).*$`

或者

> `^.*(?<!do)cum(?!ents?).*$`

支持复数。您可以在[http://fiddle.re/3pyj](http://fiddle.re/3pyj)通过单击 Java 来查看您提供的示例。

*我的建议是`^.*\bcum.*$`匹配单词边界，即单词开头和“cum”以及之后的任何内容。*

# zend-framework - 使用 Zend Auth 验证密码？

> ID：12162925
> 
> 赞同：0
> 
> 时间：2012-08-28T15:46:56.887
> 
> 标签：zend-framework, authentication

使用 Zend Auth 和 AuthAdapter 库，您可以使用该方法轻松处理登录操作`authenticate()`。但是，我正在尝试实施“您必须重新输入密码才能更新您的个人资料”操作。

如果我使用该`authenticate()`方法但失败，则用户将完全注销，因此失去查看帐户编辑表单的权限。除了手动在数据库中查找用户的密码信息外，Zend Auth 中是否有“验证密码”选项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T16:16:47.740

找到我自己的答案：

来自 Zend Auth 文档：

> “当持久存储的自动使用不适用于特定用例时，开发人员可以直接使用适配器类绕过 Zend_Auth 类的使用。”

因此，调用`Zend_Auth::getInstance()->authenticate($authAdapter);`会导致用户会话被修改。相反，调用`$authAdapter->authenticate();`不会修改用户的会话，但仍会返回一个`Zend_Auth_Result`对象，以便您可以检查该`isValid()`方法。

# wordpress - WordPress - 切换用户后保持管理员权限

> ID：12162926
> 
> 赞同：0
> 
> 时间：2012-08-28T15:47:00.963
> 
> 标签：wordpress, privileges

我们有一个客户在他们的网站上使用 Cart66。他们希望选择接受支票并运送 COD，但只希望管理员用户能够执行手动结帐，但为了跟踪客户的订单历史记录，他们希望以客户身份通过​​网站下达所有订单。

我想我的问题归结为：有没有办法以管理员用户身份登录然后切换到非管理员用户但保持管理员权限？他们希望切换到普通用户，但保留管理员手动签出的能力。

他们可以将用户切换为管理员，执行交易，然后将用户切换回订阅者。没有这些步骤，还有其他方法可以保持管理员权限吗？

我希望这是有道理的。如果有人可以为我指明正确的方向，我将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:49:10.007

老实说，没有。我通过打开两个不同的浏览器解决了这个问题。即，我将创建两个用户：管理员帐户（我的普通帐户），然后是设置为订阅者的备用（测试）帐户。我将使用常规浏览器并以管理员身份（我的常用帐户）登录，然后打开备用浏览器并以测试帐户身份登录。因此，我将打开 2 个窗口，但每个窗口中都打开了不同的帐户。工作得很好。*我可以同时看到作为管理员和*订阅者发生的所有事情。

如果你能做你所描述的事情会很酷 - 但我明白你为什么不能 - 你正在进入用户角色和功能，如果你能做你所描述的事情，那将毫无意义。

我想*一种*可能性是使用当前登录用户的 ID，并编写一个可以剥离*前端*功能的函数（在视觉上使它们看起来是登录的订阅者），但是打开要容易得多两个不同的浏览器窗口。

# jpa - JPA 中两个不同实体的值的总和

> ID：12162928
> 
> 赞同：0
> 
> 时间：2012-08-28T15:47:07.780
> 
> 标签：jpa, jpa-2.0

我有两个总和要在 JPA 中计算，来自两个不同的实体：

```
SELECT SUM(da.debtorBalance) FROM DebtorAccount da WHERE <conditions for DebtorAccounts> 
```

和

```
SELECT SUM(mda.debtorBalance) FROM MasterDebtorAccount mda WHERE <conditions for MasterDebtorAccounts> 
```

我需要的是这些总和的总和。JPAQL可以吗？或者我需要运行两个单独的查询并将其添加到应用程序中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T16:04:58.850

你不能在严格的 JPQL 中。

在 SQL 中，它类似于

SELECT SUM(a) FROM (SELECT da.debtorBalance a from DebtorAccount UNION SELECT mda.debtorBalance a FROM MasterDebtorAccount)

JPA 不支持 UNION，尽管有几个实现支持。

不，没有联合你不能这样做，因为关系代数意味着你从 DebtorAccount * MasterDebtorBalance 开始，然后通过条件/应用函数对其进行改进。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:51:01.063

你有没有尝试过？

```
SELECT SUM(SUM(da.debtorBalance), SUM(mda.debtorBalance)) 
FROM DebtorAccount da, MasterDebtorAccount mda
WHERE (<conditions for DebtorAccounts>) OR (<conditions for MasterDebtorAccounts>) 
```

各位，

# c# - 支持自定义数字类型的 ToString（字符串格式）

> ID：12162929
> 
> 赞同：8
> 
> 时间：2012-08-28T15:47:08.453
> 
> 标签：c#, string, formatting, tostring

创建了自己的数字类型（实际上`DoubleDouble`）之后，我想实现`IFormattable`接口。所以我必须以某种方式解析格式字符串。

```
public string ToString(string format, IFormatProvider formatProvider) {
    // formatting string according to format and using formatprovider?
    return formattedString;
} 
```

该类的用户应该能够将其用作`double`（或任何其他数字格式）的替代品。

```
String.Format("{0:0.##}", (DoubleDouble)123.4567); 
```

我的问题是，有人知道这方面的好教程或者可以给我一些提示吗？在这个过程中如何支持本地化？

*如何解析格式字符串？* 是否有一些方法可以帮助完成这项任务，或者我是否必须使用正则表达式等“手动”完成这一切？

我真的在寻找帮助，但找不到任何帮助，如果您发现其他语言（C、C++）可能有帮助，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T21:51:35.487

MSDN 有一个[很好](http://msdn.microsoft.com/en-us/library/26etazsy.aspx#IFormattable)的类示例，它使用自己的自定义格式`Temperature`实现接口。`IFormattable`

我想你已经知道了；无论如何，今天我了解到，如果你的`DoubleDouble`类实现了`IFormattable`接口，那么：

```
String.Format("{0:0.##}", (DoubleDouble)123.4567); 
```

... 将使用特定格式作为第一个参数调用`DoubleDouble`类的实现，我怀疑它接近你想要的。不过，您仍然必须解析格式的那部分。`ToString(...)``"0.##"`

我会大胆猜测，大部分格式解析都嵌入在高度优化的 .Net 库二进制文件中，因此您没有任何自定义解析虚拟方法可以提供帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T04:34:24.790

> 在这个过程中如何支持本地化？

类似于以下内容：

```
public string ToString(string format, IFormatProvider formatProvider)
{
  CultureInfo culture = formatProvider as CultureInfo;
  if (culture != null)
  {
    // Now you can do things like 
    // culture.NumberFormat.NumberDecimalSeparator, etc.
  }
} 
```

> 如何解析格式字符串？是否有一些方法可以帮助完成这项任务，或者我是否必须使用正则表达式等“手动”完成这一切？

.NET 框架中没有公共 API 可以为您执行此操作。如果您查看.NET 原始数字类型的实现的[源代码](http://referencesource.microsoft.com/netframework.aspx)`IFormattable`，它们最终都会调用外部方法，因此它们没有提供任何洞察力。您可能需要使用 RegEx 之类的东西来解析格式字符串。然后你可以除以最大的幂`10`来计算输出的第一个数字是什么，减去它，然后重复较小的幂，`10`直到你生成所有的数字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-30T17:39:31.863

几年前，我编写了一个 JavaScript 数字格式化函数，它模仿了大多数 .NET 解析格式字符串的方式。它可能对您编写它的 C# 版本有所帮助。至少它可以给你一个起点。

[https://github.com/flamewave/jquery-ui-numeric/blob/master/jquery-ui-numeric.js](https://github.com/flamewave/jquery-ui-numeric/blob/master/jquery-ui-numeric.js)

一直向下滚动到 $.formatNumber 函数的底部。

注意：我不再维护这个函数来支持使用[Globalize](https://github.com/jquery/globalize)库，它也可以让你对解析格式字符串有一些了解。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-10T06:06:50.953

也许这可以帮助你：

```
var my = DoFormat(123.0)

public static string DoFormat( double myNumber )
{

    var s = string.Format("{0:0.00}", myNumber);

    if ( s.EndsWith("00") )
    {
        return ((int)myNumber).ToString();
    }
    else
    {
        return s;
   }
} 
```

# c++ - 当后代需要不同的参数列表时，我应该如何在基类中定义抽象方法？

> ID：12162944
> 
> 赞同：0
> 
> 时间：2012-08-28T15:47:49.123
> 
> 标签：c++, methods, abstract-class

这是我的代码：

```
class LibItem
{
public:
    virtual void PrintDetails() = 0;
    virtual void setDetails() = 0;
    void setTitle(string TitleName)
    {
        Title = TitleName;
    }
    string getTitle()
    {
        return Title;
    }
    void setReleaseDate(string date)
    {
        ReleaseDate = date;
    }
    string getReleaseDate()
    {
        return ReleaseDate;
    }
    void setAuthor(string AuthorName)
    {
        Author = AuthorName;
    }
    string getAuthor()
    {
        return Author;
    }
    void setCopyright(string CopyrightDetails)
    {
        Copyright = CopyrightDetails;
    }
    string getCopyright()
    {
        return Copyright;
    }
    void setGenre(string GenreDetails)
    {
        Genre = GenreDetails;
    }
    string getGenre()
    {
        return Genre;
    }
    void setStatus(string StatusDetails)
    {
        Status = StatusDetails;
    }
    string getStatus()
    {
        return Status;
    }
private:
    string Title;
    string ReleaseDate;
    string Author;
    string Copyright;
    string Genre;
    string Status;
};

class Book : public LibItem
{
public:
    Book(string TitleName)
    {
        setTitle(TitleName);
    }
    void setISBN(int ISBNDetails)
    {
        ISBN = ISBNDetails;
    }
    int getISBN()
    {
        return ISBN;
    }
    void setDetails(string setBookTitle, string setBookAuthor, string setBookReleaseDate, string setBookCopyright, string setBookGenre, string setBookStatus, int setBookISBN)
    {
        setTitle(setBookTitle);
        setAuthor(setBookAuthor);
        setReleaseDate(setBookReleaseDate);
        setCopyright(setBookCopyright);
        setGenre(setBookGenre);
        setStatus(setBookStatus);
        setISBN(setBookISBN);
    }
    void PrintDetails()
    {
        cout << "Title: " << getTitle() << endl;
        cout << "Author: " << getAuthor() << endl;
        cout << "Release Date: " << getReleaseDate() << endl;
        cout << "Copyrite: " << getCopyright() << endl;
        cout << "Genre: " << getGenre() << endl;
        cout << "Status: " << getStatus() << endl;
        cout << "ISBN: " << getISBN() << endl;
    }

private:
    Book();
    int ISBN;

};

class DVD : public LibItem
{
public:
    DVD(string TitleName)
    {
        setTitle(TitleName);
    }
    void setRunningTime(int RunningTimeDetails)
    {
        RunningTime = RunningTimeDetails;
    }
    int getRunningTime()
    {
        return RunningTime;
    }
    void setDirector(string DirectorDetails)
    {
        Director = DirectorDetails;
    }
    string getDirector()
    {
        return Director;
    }
    void setStudio(string StudioDetails)
    {
        Studio = StudioDetails;
    }
    string getStudio()
    {
        return Studio;
    }
    void setProducer(string ProducerDetails)
    {
        Producer = ProducerDetails;
    }
    string getProducer()
    {
        return Producer;
    }
    void setDetails(string setDVDTitle, string setDVDAuthor, string setDVDReleaseDate, string setDVDCopyright, string setDVDGenre, string setDVDStatus, int setDVDRunningTime, string setDVDDirector, string setDVDStudio, string setDVDProducer)
    {
        setTitle(setDVDTitle);
        setAuthor(setDVDAuthor);
        setReleaseDate(setDVDReleaseDate);
        setCopyright(setDVDCopyright);
        setGenre(setDVDGenre);
        setStatus(setDVDStatus);
        setDirector(setDVDDirector);
        setStudio(setDVDStudio);
        setProducer(setDVDProducer);
    }
    void PrintDetails()
    {
        cout << "Title: " << getTitle() << endl;
        cout << "Author: " << getAuthor() << endl;
        cout << "Release Date: " << getReleaseDate() << endl;
        cout << "Copyrite: " << getCopyright() << endl;
        cout << "Genre: " << getGenre() << endl;
        cout << "Status: " << getStatus() << endl;
        cout << "Running Time: " << getRunningTime() << endl;
        cout << "Director: " << getDirector() << endl;
        cout << "Studio: " << getStudio() << endl;
        cout << "Producer: " << getProducer() << endl;
    }

private:
    DVD();
    int RunningTime;
    string Director;
    string Studio;
    string Producer;

}; 
```

我在使用虚拟 void setDetails(); 时遇到问题；

我希望 Book 和 DVD 类都有一个名为 setDetails 的方法来设置详细信息。问题是，Book 类和 DVD 类对此方法都有不同的参数。

我怎样才能做到这一点？

解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:51:03.940

自从

```
setDetails(string setDVDTitle, string setDVDAuthor, string setDVDReleaseDate, string setDVDCopyright, string setDVDGenre, string setDVDStatus, int setDVDRunningTime, string setDVDDirector, string setDVDStudio, string setDVDProducer) 
```

仅对 DVD 对象有意义，并且

```
setDetails(string setBookTitle, string setBookAuthor, string setBookReleaseDate, string setBookCopyright, string setBookGenre, string setBookStatus, int setBookISBN) 
```

只对一本书有意义，方法不应该是`virtual`，也不应该在基类中。

假设我给你一个`LibItem*`，我告诉你设置它的细节。你做什么工作？设置它的细节是否有意义，因为它们从一个具体的实现类到另一个不同？

基类应该只具有设置的方法：

```
string Title;
string ReleaseDate;
string Author;
string Copyright;
string Genre;
string Status; 
```

不应该是`virtual`，因为它的行为不会因实现而异，您应该在实现类本身上设置具体细节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:54:23.787

抽象基类只能包含所有派生类共有的函数，所以如果在不同派生类中需要不同的函数，就不能进入基类。

您可以向下转换以获取派生类型，并访问其特定于类型的函数：

```
LibItem & item = some_item();

if (Book * book = dynamic_cast<Book*>(&item)) {
    book->setDetails(book_details);
} else if (DVD * dvd = dynamic_cast<DVD*>(&item)) {
    dvd->setDetails(dvd_details);
} 
```

如果您有许多不同的类型和许多特定于类型的操作，那么可能值得考虑[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)；但在大多数情况下，这太过分了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T15:55:49.853

你不能，你需要通用接口。[http://www.tutorialspoint.com/cplusplus/cpp_interfaces.htm](http://www.tutorialspoint.com/cplusplus/cpp_interfaces.htm)。这篇文章对你理解抽象类有很大帮助。对于不同的孩子有不同的参数的成员函数不应该是虚拟的。

查看您的代码：

尝试将您的参数类型从“string”更改为“const string&”，您将避免复制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T15:57:41.183

```
virtual void LibItem::setDetails() = 0; 
```

和

```
void Book::setDetails(string setBookTitle, string setBookAuthor, string setBookReleaseDate, string setBookCopyright, string setBookGenre, string setBookStatus, int setBookISBN) 
```

和

```
void DVD::setDetails(string setDVDTitle, string setDVDAuthor, string setDVDReleaseDate, string setDVDCopyright, string setDVDGenre, string setDVDStatus, int setDVDRunningTime, string setDVDDirector, string setDVDStudio, string setDVDProducer) 
```

是不同的方法，因此，您的代码中没有重载。

顺便提一句。不要忘记 LibItem 中的虚拟析构函数......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-28T16:10:40.573

有两种方法可以处理这个问题。第一个涉及可变参数，将基中的接口声明为`setDetails( std::string const& title... )`. 但是，我不会进一步讨论这种方式，因为它是以后发生无法解释的崩溃的可靠途径。另一种解决方案是使用类似: 的东西`setDetails( std::map< std::string, std::string > const& )`，并在具体实现中按名称提取您想要的详细信息。即使这样，我也不确定这是一个好的解决方案，因为给定 a `LibItem*`，你不知道在地图中放什么。*（如果*您从用户那里获取对象的类型和详细信息列表，这可能是一个有效的解决方案。即便如此，我可能会将其封装到一个工厂函数中，该函数将知道它正在创建的类型，验证详细信息对应，然后将所有细节传递给构造函数。）

当我这样做时：你不能使用`int`for ISBN。最合理的表示是字符串。

# python - 数据存储中现有实体的复合索引写入

> ID：12162945
> 
> 赞同：2
> 
> 时间：2012-08-28T15:47:50.420
> 
> 标签：python, google-app-engine, google-cloud-datastore

我有一个模型：

```
class MyModel(db.Model):
  some_list = db.StringListProperty(indexed=True)
  some_value = db.StringProperty(indexed=True) 
```

和一个综合指数：

```
indexes:
- kind: MyModel
  properties:
  - name: some_list
  - name: some_value 
```

如果我创建一个新实体：

```
entity = MyModel(some_list=['a', 'b'], some_value='xxx') 
```

然后我将其放入数据存储区：

```
key = entity.put() 
```

这将导致

*   2 次写入（在本例中为 2 次写入）
*   每个索引属性值 2 次写入（在本例中为 2 + 4 次写入）
*   每个复合索引值 1 次写入（在本例中为 2 次写入）

在这种情况下，总共有 10 次写入。到目前为止，我了解[文档](https://developers.google.com/appengine/docs/billing)。

但是现在我得到了现有的属性，将“c”添加到 some_list 并放回去：

```
existing = MyModel.get(key)
existing.some_list.append('c')
existing.put() 
```

那是多少数据存储写入？

文档说：

1 次写入 + 每个修改的索引属性值 4 次写入 + 每个修改的复合索引值 2 次写入

这是否意味着 some_list 中的 'a' 和 'b' 的索引不需要重写：

1 + 4 + 2 = 7 次写入

或者是因为 some_list 更改而重写了 some_list 中的 'a' 和 'b' 的索引：

1 + 12 + 6 = 19 次写入

?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T16:02:08.217

（没有复合索引）appstats 显示如下`billed_ops`：

对于第一把：

@2ms datastore_v3.Put real=169ms api=0ms cost=800 billed_ops=[DATASTORE_WRITE:8]

*   1 写入实体表
*   1 写入种类索引表
*   2 次写入`some_value`索引表 (asc/desc)
*   4 次写入`some_list`索引表（每个附加值 2 次，asc/desc）

对于第二次放置（更新）：

@187ms datastore_v3.Put real=50ms api=0ms cost=300 billed_ops=[DATASTORE_WRITE:3]

*   1 写入实体表
*   2 次写入`some_list`索引表（每个附加值 2 次，asc/desc）

文档说`4 writes per modified indexed property value`，但由于每个列表属性元素都有自己的索引行（每个值 1 行），添加一个元素相当于创建新的索引属性（而不是修改一个）。

但是，如果您修改`some_value`，这将导致：

@484ms datastore_v3.Put real=46ms api=0ms cost=500 billed_ops=[DATASTORE_WRITE:5]

*   1 写入实体表
*   4 次写入`some_value`索引表（2 次写入用于删除现有行 asc/desc，2 次写入用于添加新行 asc/desc）

# sql - 涉及多个表的sql查询

> ID：12162952
> 
> 赞同：1
> 
> 时间：2012-08-28T15:48:02.820
> 
> 标签：sql, sql-server, sql-server-2008

我有两张桌子..

**人员：**

```
 empid(primary key)
  firstname
  lastname
  email 
```

**细节：**

```
 Did(primary key)
  salary
  designation
  empid 
```

现在我需要`SELECT`指定名称为 的员工的名字和姓氏`Manager`。

我是初学者，我一直在从 W3school 学习 SQL（顺便说一句，这很棒），如果你能建议我在完成 w3school 后我应该去哪里，那就太好了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:51:19.603

就像你说的那样，在将两个表关联在一起的列上进行简单的连接（在这种情况下`EmpID`）：

```
SELECT firstname,
       lastname
FROM   Persons
       INNER JOIN Details
         ON Persons.EmpID = Details.EmpID
WHERE  designation = 'Manager' 
```

至于最好的知识来源，如果你问我，你无法击败书籍、MSDN 和 StackOverFlow。周围也有很多博客——但它们往往是针对更高级的主题的。无论如何，作家们倾向于闲逛！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:54:27.047

```
Select p.fname, p.lname
from persons p, details d
where d.designation="Manager" and p.empid=d.empid 
```

使用单个字符的东西, `p.`and `d.`, 是一种速记并节省打字的方法。

至于 SQL 源代码，我是 tizag 的忠实粉丝。通常是我的主要 goto 之一，用于 PHP、SQL 和任何东西，真的。首先是 W3，其次是 Stack Overflow，然后是 tizag。我总是这样找到答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T15:50:47.657

您要查找的查询：

```
select t1.firstname, t1.lastname
from person t1 inner join
details t2 on t1.empid = t2.empid
where t2.designation = 'Manager' 
```

至于在网上学习Sql，我真的不知道有什么好的教程，但是由于您使用的是sql server 2008，我建议您经常查阅[MSDN](http://msdn.microsoft.com/en-us/library/bb510741 "MSDN")。如果你有动力，你可以在那里找到非常深入的信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T15:50:55.540

我不知道这是否适用于 SQL Server 2008，但这应该是相当标准的 SQL：

```
SELECT firstname, lastname
FROM Persons
INNER JOIN Details ON Persons.empid = Details.empid
WHERE Details.designation = 'Manager' 
```

# asp.net - 如何在 ASP.Net 4.5 Web 窗体模型绑定中访问外键描述

> ID：12162954
> 
> 赞同：2
> 
> 时间：2012-08-28T15:48:12.647
> 
> 标签：asp.net, asp.net-4.5

在 ASP.Net 4.5 Web 窗体中，我有一个网格，它使用新的模型绑定功能，由实体框架支持：

```
<asp:GridView runat="server" ID="uxGrid" ItemType="SAData.SelfAssessment" DataKeyNames="SelfAssessmentID" AllowPaging="True" AllowSorting="True" PageSize="2"
        SelectMethod="GetSelfAssessments" CellPadding="5" ForeColor="#333333" GridLines="None" AutoGenerateColumns="False"> 
```

这正式列出了数据库中的所有评估，包括它们的目的地，这是明显命名的目的地表的 FK。DynamicField 设置为显示 DestinationID，但我真的很想从实际的 Destination 表中查看 Destination*名称。*

我尝试了几种变体，例如

```
<asp:DynamicField DataField="Destinations.DestinationDescription" HeaderText="Destination" /> 
```

（其中 Destinations 是表格）

和

```
<asp:DynamicField DataField="Destination.DestinationDescription" HeaderText="Destination" /> 
```

（其中 Destination 是 Navigation 属性）。

这两种方法都会导致“表 'SelfAssessment' 没有名为 'Destinations.DestinationDescription' 的列”。或类似的。

我的 GetSelfAssessments 方法使用 .Include 方法来包含 Destinations 表，但无济于事。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T08:47:42.763

好的，修复它 - 使用 asp:BoundField 到 Destination.DestinationDescription，而不是 asp:DynamicField，这很好。此外，也没有必要 .Include("Destination") ，尽管我想知道是否应该防止假定的延迟加载。

现在，按目的地排序是另一回事......

# php - PHP/MySQL 过滤搜索类似于 Facebook

> ID：12162957
> 
> 赞同：3
> 
> 时间：2012-08-28T15:48:19.343
> 
> 标签：php, mysql, wordpress, innodb

我正在尝试使用 PHP 和 mysql 数据库为 Wordpress 站点构建一个简单的自定义搜索，该数据库将返回来自许多不同表的结果，例如`Groups`，`Users`并且`Sites`每个表的数据都与正在搜索的另一个表无关。我的目标是构建类似于 Facebook 的它，它根据结果类型对结果进行分组。

我已经构建了单独的查询，但我坚持如何将它们全部联系在一起，以便我可以过滤结果类型并像 Facebook 一样对它们进行相应的分组。有没有一种简单的方法可以判断哪个表格结果来自哪个表格结果，或者它会完全朝着错误的方向前进？我对mysql知之甚少，无法了解最佳实践。这是我正在运行的示例查询：

```
SELECT 
    name, slug
FROM 
    ".$bp->groups->table_name."                              
WHERE 
    name LIKE '%".$search_string."%'
        OR 
    name = '%".$exp_string[0]."%'
        OR 
    name IN ('".$join_string."'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:57:12.710

尝试这个：

```
SELECT 
    name, slug, '$bp->groups->table_name' as table
FROM 
    ".$bp->groups->table_name."                              
WHERE 
    name LIKE '%".$search_string."%'
        OR 
    name = '%".$exp_string[0]."%'
        OR 
    name IN ('".$join_string."'); 
```

这应该将表名输出到结果中。我不知道你以后可能想如何分组..

# c# - 从进程读取输出时无法获取最后一位

> ID：12162958
> 
> 赞同：1
> 
> 时间：2012-08-28T15:48:24.957
> 
> 标签：c#, process, console, readline

当我将服务器控制台用于游戏时，我正在构建一个小程序来帮助我（因此我没有控制台程序的源代码）。我让控制台在后台启动，它重定向输出，然后我把它写在可爱的小文本框中。问题是它似乎并没有在每次输出时都给我最后一行。这是我的 server.cs 中的一些代码：

```
public StreamWriter inputWriter;
public event EventHandler outputWritten;

string outtext = outputReader.ReadLine();

        while (!process.HasExited)
        {
            // check for output from server
            if (outtext != null)
            {
                if (outputWritten != null)
                {
                    outputWritten(outtext, new EventArgs());
                }
            }
            outtext = outputReader.ReadLine();
        } 
```

这几乎是输出的样子：1）如果它在我的程序之外运行：

```
Welcome to the game server!
1  OptionA
2  OptionB
3  OptionC

Choose option:_  <-- this is where it should end waiting for input 
```

2）如果在我的程序中：它看起来像上面，但不会显示最后一行，而是会在“选择选项：”上方的空行结束，当我给它一个输入时，它会搞砸位，我得到一个类似于“选择选项：欢迎来到游戏服务器！”的输出。它应该写在哪里：“选择选项：1”并在下一行给出我关于如何进行的一个小问题。

# google-drive-api - 在 Google Drive SDK 中，如何上传新的文件内容

> ID：12162961
> 
> 赞同：1
> 
> 时间：2012-08-28T15:48:38.367
> 
> 标签：google-drive-api

我知道有一个方法 files/insert (https://developers.google.com/drive/v2/reference/files/insert)，但文档没有指定将实际文件内容放在哪里。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T16:15:11.583

**快速入门示例，显示上传，选择您自己的语言：**

[https://developers.google.com/drive/quickstart](https://developers.google.com/drive/quickstart)

**插入示例，显示上传选择您的语言：**

[https://developers.google.com/drive/v2/reference/files/insert](https://developers.google.com/drive/v2/reference/files/insert)

**上传协议说明：**

[https://developers.google.com/drive/manage-uploads](https://developers.google.com/drive/manage-uploads)

# firefox-addon - 自定义附加安装程序

> ID：12162962
> 
> 赞同：2
> 
> 时间：2012-08-28T15:48:39.653
> 
> 标签：firefox-addon, firefox-addon-sdk

我正在使用 Firefox Add-on SDK 编写一个插件，并且在安装插件时我必须执行一些操作。有没有办法自定义附加安装程序？如果没有，我可以在第一次加载加载项时执行这些操作。我怎么能那样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T07:12:43.387

不，安装程序只会安装扩展，没什么特别的。它将调用扩展`install()`中的方法，`bootstrap.js`但附加组件 SDK 不会将该功能公开给附加组件。

因此，如果您需要初始化某些东西 - 只需检查它是否已经初始化。例如，如果您需要在第一次运行时创建一个文件：在您的扩展程序启动时检查该文件是否已经存在。如果没有，则创建它。

如果您无法轻松检测到您的扩展是否已初始化，那么您可以[使用首选项](https://addons.mozilla.org/en-US/developers/docs/sdk/1.9/packages/addon-kit/simple-prefs.html)。像这样的东西：

```
var {prefs} = require("simple-prefs");
if (!prefs.firstRunDone)
{
  prefs.firstRunDone = true;
  // Your first-run code goes here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-09T09:22:02.003

main.js 中有两个函数，`exports.main`和`exports.onUnload`，分别在加载项执行之前和卸载之前调用。您可以像这样覆盖它们：

```
exports.main = function(options, callbacks)
{
    if (options.loadReason == 'install') {
        // init stuff
    }
}

exports.onUnload = function(reason)
{
    if (reason == 'uninstall') {
        // uninit stuff
    }
} 
```

有更多的领域`options`和多种可能的原因。[来源](https://addons.mozilla.org/en-US/developers/docs/sdk/latest/dev-guide/tutorials/load-and-unload.html)。

# php - PHP - JQuery 实现 Progress 长时间运行的请求

> ID：12162964
> 
> 赞同：1
> 
> 时间：2012-08-28T15:48:49.270
> 
> 标签：php, zend-framework

我有一个 Zend 框架应用程序来从 IMAP 帐户获取邮件。这可能需要一段时间。所以我想在前端显示还有多少邮件需要处理。

我正在考虑这个解决方案：

*   处理邮件的对象正在将处理的邮件数量（int）写入文件/数据库
*   脚本运行时，每 20 秒请求一次该文件的内容并向用户显示数字

使用 php/javascript 有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:55:03.703

您可以使用 flush() 在某些点将数据输出到浏览器。诚然，这不是一个漂亮的，但你可以（应该）重构：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
    <title>Progress Bar</title>
</head>
<body>
<!-- Progress bar holder -->
<div id="progress" style="width:500px;border:1px solid #ccc;"></div>
<!-- Progress information -->
<div id="information" style="width"></div>
<?php
// Total processes
$total = 10;

// Loop through process
for($i=1; $i<=$total; $i++){
    // Calculate the percentation
    $percent = intval($i/$total * 100)."%";

    // Javascript for updating the progress bar and information
    echo '<script language="javascript">
    document.getElementById("progress").innerHTML="<div style=\"width:'.$percent.';background-color:#ddd;\">&nbsp;</div>";
    document.getElementById("information").innerHTML="'.$i.' row(s) processed.";
    </script>';

    // This is for the buffer achieve the minimum size in order to flush data
    echo str_repeat(' ',1024*64);

    // Send output to browser immediately
    flush();

    // Sleep one second so we can see the delay
    sleep(1);
}

// Tell user that the process is completed
echo '<script language="javascript">document.getElementById("information").innerHTML="Process completed"</script>';
?>
</body>
</html> 
```

编辑：代码示例来自[W3Shaman](http://w3shaman.com/article/php-progress-bar-script)

# jquery - 动态添加 ListView 不会渲染 jQuery Mobile CSS

> ID：12162965
> 
> 赞同：1
> 
> 时间：2012-08-28T15:48:51.307
> 
> 标签：jquery, jquery-mobile

我正在将带有列表项的列表视图添加到 jQuery 移动可折叠网格中。这是我的 Default.js 代码

```
$(document).ready(function () {

    var appNames = getApprovalNames(phone, pin);

    for (var i = 0; i < appNames.length; i++) {

        var header = '<h3>' + appNames[i].Name + '</h3>';

        var ulHeader = '<ul data-role="listview" id="myAppsSectionGridTable">';

        var approvals = getApprovalInformation(phone, pin, appNames[i].Name);

        var listArray = new Array();

        for (var j; j < approvals.length; j++) {

            var link = '<li><a href="' + 'NickData' + '"' + '><img src="';
            var detailHeader = '" alt="" class="ui-li-icon"/>' + '<h3>' + 'NickData' + '</h3>';
            var detail = '<p>' + 'NickData' + '</p>' + '</a>' + '</li>';

            var list_item = link + detailHeader + detail;

            listArray.push(list_item);

        }

     var entire_list = null;

     for (var y in listArray) {

        entire_list = entire_list + listArray[y];

    }

    $('#accMain').append(header + ulHeader + entire_list + '</ul>');

    }   

}); 
```

此代码在屏幕上显示数据，但屏幕上的任何位置都没有 jQuery mobile css。此外，当我在源代码中查看它时，我没有在其中看到我新创建的标记。我是在错误的事件中添加这个还是什么？如果我只是对页面中的标记进行硬编码，一切正常。它与动态添加 jQuery 移动标记有关。

```
<asp:Content ID="HContent" ContentPlaceHolderID="HeadContent" runat="server">

<script src="Js/Pages/Default.js" type="text/javascript"></script>

</asp:Content>
<asp:Content ID="THContent" ContentPlaceHolderID="TopHeaderContent" runat="server">
    <h1>
        Applications</h1>
</asp:Content>
<asp:Content ID="MContent" ContentPlaceHolderID="MainContent" runat="server">

 <div id="accMain" data-role="collapsible" data-inset="false" data-collapsed="false">

 </div>

</asp:Content> 
```

这个母版页正文是..

```
<body>

<div data-role="page" data-theme="b">

    <div data-role="header" data-position="fixed">

         <asp:ContentPlaceHolder ID="TopHeaderContent" runat="server"></asp:ContentPlaceHolder>

    </div><!-- /header -->

    <div data-role="content">   

 <asp:ContentPlaceHolder ID="MainContent" runat="server"></asp:ContentPlaceHolder>

    </div><!-- /content -->

    <div data-role="footer" data-position="fixed">
    <asp:ContentPlaceHolder ID="FooterContent" runat="server"></asp:ContentPlaceHolder>

    </div><!-- /footer -->

</div><!-- /page -->

</body> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T15:56:00.337

你需要调用[listview](http://jquerymobile.com/demos/1.1.1/docs/lists/docs-lists.html)方法

```
$('#mylist').listview() 
```

如果您只是将内容添加到现有列表视图，则调用该`refresh`方法

```
$('#mylist').listview('refresh'); 
```

有时您可能需要在`pageshow`活动中调用它，如下所示

```
 $('#myPage').on('pageshow', function() {
     try 
    {
       $('#mylist').listview('refresh');
    } catch (e) {
     $('#mylist').listview();
    }
}); 
```

如果您要添加多个需要增强的小部件/项目，那么您可以尝试触发 create 事件

```
$('#myPage').trigger('create'); 
```

# tsql - T-SQL 查询/按部分日期分组计算行数

> ID：12162973
> 
> 赞同：1
> 
> 时间：2012-08-28T15:49:17.360
> 
> 标签：tsql, sql-server-2008-r2

我有一个表（在 SQL Server 2008 R2 中，以防万一），用以下行定义。该`DateAdded`列是一种`SmallDateTime`数据类型。

```
 ID    DateAdded
  1    2012-08-01 12:34:02
  2    2012-08-01 12:48:25
  3    2012-08-05 08:50:22
  4    2012-08-05 11:32:01
  5    2012-08-26 09:22:15 
  6    2012-08-26 13:42:02
  7    2012-08-27 08:22:12 
```

我需要做的是计算出现在相同 YYYY/MM/DD 值上的行数。所以我需要获得的结果看起来像这样......

```
DateAdded   QTY
2012-08-01  2  
2012-08-05  2  
2012-08-26  2  
2012-08-27  1 
```

我无法弄清楚让它工作的语法/表达式。有人可以指出我正确的方向吗？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T15:53:29.840

```
SELECT 
  DateAdded = DATEADD(DAY, DATEDIFF(DAY, 0, DateAdded), 0), 
  QTY = COUNT(*)
FROM dbo.tablename
GROUP BY DATEADD(DAY, DATEDIFF(DAY, 0, DateAdded), 0); 
```

或者正如 Marc 正确指出的那样（我花更多的时间查看格式错误而不是标签）：

```
SELECT 
  DateAdded = CONVERT(DATE, DateAdded), 
  QTY = COUNT(*)
FROM dbo.tablename
GROUP BY CONVERT(DATE, DateAdded); 
```

# ruby - OpenSSL not enough data

> ID：12162975
> 
> 赞同：2
> 
> 时间：2012-08-28T15:49:19.847
> 
> 标签：ruby, openssl, digital-signature, x509

I've generated a self signed certificate using Adobe X, and exported a pfx file (for my private key) along with a .cer file (for the certificate).

I then try to collect the certificate, along with the key, but for some reason, OpenSSL is giving the error

```
OpenSSL::X509::CertificateError: not enough data 
```

Here is my code

```
require 'openssl'

CERTFILE = "test.cer"
RSAKEYFILE = "test.pfx"

# Open certificate files

cert = OpenSSL::X509::Certificate.new(File.read CERTFILE)
key = OpenSSL::PKey::RSA.new(File.read RSAKEYFILE ) 
```

My certificate was generated using Adobe X reader, and is a self-signed certificate. It is working fine to sign pdf documents...

What might i do to make this work?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T13:02:25.810

Apparently OpenSSL has some problems reading directly from .cer files, and for the key, we should use only the private_key, and the pfx has both the privatekey and the cert.

So, i installed openSsl locally, and first [converted](http://www.openssl.org/docs/apps/x509.html) my .cer certificate to .pem with the following command :

```
C:\OpenSSL-Win32\bin>openssl x509 -inform der -in "c:\mydir\test.cer" -out "C:\mydir\certificate.pem" 
```

and then extracted my privatekey from the pfx file (based on [this](http://sycure.wordpress.com/2008/05/15/tips-using-openssl-to-extract-private-key-pem-file-from-pfx-personal-information-exchange/) site) :

```
C:\OpenSSL-Win32\bin>openssl pkcs12 -in "c:\mydir\test.pfx" -nocerts -out "c:\mydir\test_pk.pem" 
```

just make sure you have your pfx pwd and select a passphrase when you extract the privatekey.

Here is the final code :

```
require 'openssl'

CERTFILE = "certificate.pem"
RSAKEYFILE = "test_pk.pem"
passphrase = "your chosen passphrase for the private key"
key4pem=File.read RSAKEYFILE

# Open certificate files

cert = OpenSSL::X509::Certificate.new(File.read CERTFILE)
key = OpenSSL::PKey::RSA.new key4pem, passphrase 
```

And voilá :-), we have successfully mapped into memory both our certificate and privatekey, and can put it to uses like the answer [here](https://stackoverflow.com/questions/12078006/insert-digital-signature-into-existing-pdf-file)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-02-15T06:49:39.520

While trying to create an [OpenSSL::X509::Certificate](https://ruby-doc.org/stdlib-2.6.1/libdoc/openssl/rdoc/OpenSSL/X509/Certificate.html) object from '.cer', I found this error:

```
OpenSSL::X509::CertificateError (not enough data) 
```

I checked that file was actually a `DER-encoded certificate` which is in binary format. In that case, we should read the file contents by **File.binread**.

To check if the file is PEM or DER encoded? We can use the following code:

```
require "open3"
require "openssl"

def pem_cert?(file)
  details, status = Open3.capture2e("file", file)
  return false unless status.success?
  details.rpartition(":").last.strip == "PEM certificate"
end

contents = if pem_cert?(cer_file_path)
    File.read(cer_file_path)
  else
    File.binread(cer_file_path)
  end

OpenSSL::X509::Certificate.new(contents) 
```

This is a pure ruby way, without any shell interaction.

# python - 我在哪里可以找到 osx 上的 libpython2.6.dylib

> ID：12162976
> 
> 赞同：1
> 
> 时间：2012-08-28T15:49:19.637
> 
> 标签：python, macos, python-2.6, dylib

我在我的框架文件夹中寻找，`libpython2.6.dylib`但对于我所有的安装，我只能找到`libpython2.7.dylib`.

我正在寻找 'System/Library/Frameworks/Python.framework/Versions/2.x'/lib 。

我还注意到这`libpython2.7.dylib`实际上只是“/System/Library/Frameworks/Python.framework/Versions/2.7/Python”的别名，这是否意味着我可以为所有其他“Python”二进制文件创建自己的别名安装目录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-27T18:17:31.520

在 Mac 上，它存储在 /usr/lib 下

# android - Android：自定义 ExpandableListView 的问题

> ID：12162979
> 
> 赞同：1
> 
> 时间：2012-08-28T15:49:48.327
> 
> 标签：android

我希望我的 ExpandableListView 一次只允许扩展一个组。我找到了一个解决方案，它通过覆盖 ListViewAdapter 的 onGroupExpanded 方法来折叠先前展开的组：

```
@Override
public void onGroupExpanded(int groupPosition)
{
   //collapse the old expanded group, if not the same
   //as new group to expand
   if(groupPosition != mLastExpandedGroup && mLastExpandedGroup != -1)
   {
        epView.collapseGroup(mLastExpandedGroup);
   }

   mLastExpandedGroup = groupPosition;
   super.onGroupExpanded(groupPosition);           
} 
```

默认情况下，当展开新组时，ListView 会滚动，以便新组的 GroupView 保持可见。这种滚动不适用于我自定义的 ListView（通常新扩展组的 GroupView 最终会离开屏幕）。

基于android源，这不起作用的原因是因为扩展后滚动位置是在调用onGroupExpanded方法之前确定的，所以在我强制一个组折叠后位置不准确。

那么，对于自定义 ListView 的任何建议，它一次只允许扩展一个组，并正确滚动以便在组扩展时 GroupView 可见？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:18:06.957

尝试在 a 中调用滚动函数，`post()`或`postDelayed()`确保滚动显示晚于默认滚动。

# user-defined-functions - 将数组参数传递给自定义猪加载器

> ID：12162986
> 
> 赞同：2
> 
> 时间：2012-08-28T15:50:13.427
> 
> 标签：user-defined-functions, apache-pig

我写了一个 LoadFunc 函数，它允许我选择一个非结构化的巨大日志文件的给定关键字。如何将元组作为参数传递给我的函数？

就像是

```
A = load '/input/*' using MyLoader('keyword1','keyword2'); 
```

或者

```
A = load '/input/*' using MyLoader( ('keyword1','keyword2') ); 
```

导致错误：

```
grunt> a = LOAD '/input/*' USING MyLoader( ('keyword1','keyword2') );     
2012-08-28 19:44:04,331 [main] ERROR org.apache.pig.tools.grunt.Grunt - ERROR 1200: <line 3, column 36>  mismatched input '(' expecting RIGHT_PAREN
Details at logfile: /home/hadoop/pig-0.10.0/pig_1346159261142.log 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T21:11:38.590

实际上，Pig LoadFunc 只能接受其构造函数的字符串参数。请参阅[http://mail-archives.apache.org/mod_mbox/pig-user/201302.mbox/%3CCAO8ATY27UOdcgSjdh19F=iHsnFEAwmzedWbsnZ66sNvcsjfgog@mail.gmail.com%3E](http://mail-archives.apache.org/mod_mbox/pig-user/201302.mbox/%3CCAO8ATY27UOdcgSjdh19F=iHsnFEAwmzedWbsnZ66sNvcsjfgog@mail.gmail.com%3E)。

出于您的目的，我会将 CSV 作为字符串传递给您的 LoadFunc，然后在 LoadFunc 的构造函数中对其进行解析。

# ms-access - MS Access：从 ComboBox 中选择一个选项，它会自动更新其他文本框

> ID：12162989
> 
> 赞同：0
> 
> 时间：2012-08-28T15:50:25.110
> 
> 标签：ms-access, combobox

我想要做的是从组合框中选择一个选项（即人 ID），并基于该选项表单自动填充其他文本框（人名、位置、号码）

我有一张包含信息的表格。该表包含人员 ID 以及每条记录中的人员信息。该表包含 1400 条记录。

任何简单的方法来做到这一点。感谢所有答案。即使是困难的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T16:22:20.580

添加一个子表单，其记录源是这样的查询......

```
SELECT [Person ID], [Person Name], Location, [Number]
FROM The_Table; 
```

然后，从子窗体控件的属性表中，选择主窗体的组合框作为链接主字段，并选择 [Person ID] 作为链接子字段。结果应该是子表单显示当前在组合框中选择的 ID 的附加详细信息。

这是一种*显示*详细信息的简单方法。如果您打算*将*这些详细信息再次存储在另一个表中，我建议不要这样做。仅存储 ID，然后如果您需要在其他上下文中显示详细信息，请使用查询来连接（基于 ID）这两个表。

# c# - 使用反射将通用列表的实例添加到对象

> ID：12162998
> 
> 赞同：2
> 
> 时间：2012-08-28T15:50:52.457
> 
> 标签：c#, generics, reflection

我正在尝试使用反射将通用列表附加到类的实例，这与附加简单对象方法不同，当值是（而不是字符串、int、bool 甚至自定义类的实例）时`PropertyInfo.SetValue(obj, value, index)`返回异常）。`{"Parameter count mismatch."}``List<SomeType>`

那个夏天可能没有多大意义；以下内容可能有助于解释我正在尝试做的事情。

假设我们正在尝试用反射填充以下类：

```
public class Foo
{

 public virtual int someInt {get; set;}
 public virtual IList<SomeClass> list {get; set;}

} 
```

该方法可能如下所示：

```
public static T Parse<T>(HttpRequest request) where T : new()
{
   returnObj = new T();
   PropertyInfo[] properties = typeof(T).GetProperties();
   foreach (PropertyInfo p in properties)
   {
     // Get a meaningful property name
     string ins = System.Text.RegularExpressions.Regex.Replace(p.PropertyType.FullName, "([^,]*),.*$", "$1");
     switch(ins)
     {
        // populate int
        case "System.Int32":
           p.SetValue(returnObj, Int32.Parse(request[p.Name]) , null);
           break;

        // populate list
        case "System.Collections.Generic.IList`1[[SomeNamespace.Domain.SomeClass":
           IList<SomeClass> list = new List<SomeClass>();
           foreach (string s in request[p.Name].Split(','))
           {
              list.Add(new SomeClass(s));
           }
           // This will throw the exception 'Parameter count mismatch.'
           p.SetValue(returnObj, list, null);
           break;
      }
   }
   return returnObj;
} 
```

但是，当尝试以这种方式添加 List (IList) 的实例时，会引发异常。

编辑：澄清一下，如果用细齿梳（断点）（嗯，应用程序中的那个，不完全是这个）完成了这种方法，并且所有变量都按预期填充；直到`SetValue`抛出异常；如果有人需要更多信息，请询问。

Edit2：所以我构建了一个较小的应用程序来测试它（以上传它作为示例）；而且我无法重新创建自己的问题；正如你们中的许多人所建议的那样。当我设法找到它时，我会用这个问题更新这个问题。它可能是微不足道的，因为这些事情经常发生（原始代码库很大，因此不适合我发布）。感谢您迄今为止的所有帮助，并为浪费您的时间而道歉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T16:37:06.497

我从您的问题中运行代码，并进行了一些小的更改以使其编译，并且它似乎工作正常：

```
void Main()
{
    Parse<Foo>();
}

public static T Parse<T>() where T : new()
{
   var returnObj = new T();
   PropertyInfo[] properties = typeof(T).GetProperties();
   foreach (PropertyInfo p in properties)
   {
     // Get a meaningful property name
     string ins = p.PropertyType.Name;
     switch(ins)
     {
        // populate int
        case "Int32":
           p.SetValue(returnObj, 1 , null);
           break;

        // populate list
        case "IList`1":
           var list = new List<string>();
           // This will throw the exception 'Parameter count mismatch.'
           p.SetValue(returnObj, list, null);
           break;
      }
   }
   return returnObj;
}

public class Foo
{
 public virtual int someInt {get; set;}
 public virtual IList<string> list {get; set;}
} 
```

另一方面，如果您将 更改`Foo`为具有返回的索引器属性，则会在您的问题中遇到异常：`IList`

```
public class Foo
{
 public virtual int someInt {get; set;}
 public virtual IList<string> this[int key] 
 {
    get{ return null; }
    set 
    {
    }
 }
} 
```

生成：

> TargetParameterCountException：参数计数不匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T16:22:49.530

您是否验证了该案例

```
"System.Collections.Generic.IList`1[[SomeNamespace.Domain.SomeClass" 
```

被击中了吗？当我传入一个列表时，即使是一个创建为 IList 的列表，GetType() 也会给我

```
System.Collections.Generic.List`1[SomeNamespace.Domain.SomeClass] 
```

使用它可能更可靠：

```
typeOf(System.Collections.Generic.IList).isAssignableFrom(p.GetType()) 
```