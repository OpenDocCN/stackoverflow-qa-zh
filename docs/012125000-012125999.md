# StackOverflow 问答 12125000-12125999

# android - OnActivityResult 处理同一活动中的不同请求代码

> ID：12125003
> 
> 赞同：2
> 
> 时间：2012-08-25T19:30:28.837
> 
> 标签：android, speech-recognition

一直在尝试应用类似问题的一些解决方案，但到目前为止我还没有运气。

我有一个带有两个按钮的活动，每个按钮都会调用 RecognizerIntent 进行一些语音识别。我试图让每个按钮调用它自己的 RecognizerIntent 并在同一活动中检查单独的 requestCode(s)。

这就是我到目前为止所拥有的：

```
public class Cooking  extends Activity implements OnClickListener{

    ListView lv;
        static final int check = 111;
        static final int checka = 111;
        static final int checkb = 111;

    @Override
        protected void onCreate(Bundle savedInstanceState) {
            // TODO Auto-generated method stub
            super.onCreate(savedInstanceState);
            setContentView(R.layout.cooking);
              initialize();                 
    }        

    private void initialize() {
        // TODO Auto-generated method stub
        lv = (ListView)findViewById(R.id.lvVoiceReturn);

        display = (ImageView) findViewById(R.id.IVdisplay);
        ImageView image1 = (ImageView) findViewById(R.id.IVimage1);
        ImageView image2 = (ImageView) findViewById(R.id.IVimage2);

        image1.setOnClickListener(this);
        image2.setOnClickListener(this);

        ActionBar actionBar = getActionBar();
        actionBar.setDisplayHomeAsUpEnabled(false);     
    }

    @Override
    public void onClick(View v) {
        if(v.getId() == R.id.IVimage1){
            Intent a = new Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH);
            a.putExtra(RecognizerIntent.EXTRA_LANGUAGE_MODEL, 
                       RecognizerIntent.LANGUAGE_MODEL_FREE_FORM);
            a.putExtra(RecognizerIntent.EXTRA_MAX_RESULTS, 1);
            a.putExtra(RecognizerIntent.EXTRA_PROMPT, "Speak.");
            startActivityForResult(a, checka);
        }else if(v.getId() == R.id.IVimage2){
            Intent b = new Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH);
            b.putExtra(RecognizerIntent.EXTRA_LANGUAGE_MODEL,
                       RecognizerIntent.LANGUAGE_MODEL_FREE_FORM);
            b.putExtra(RecognizerIntent.EXTRA_MAX_RESULTS, 1);
            b.putExtra(RecognizerIntent.EXTRA_PROMPT, "Speak.");
            startActivityForResult(b, checkb);  
        }
    }

    @Override
    protected void onActivityResult(int requestCode, 
                                    int resultCode, 
                                    Intent data) {
        // TODO Auto-generated method stub
        if (requestCode == checka && resultCode == RESULT_OK){
            ArrayList<String> results = 
                data.getStringArrayListExtra(RecognizerIntent.EXTRA_RESULTS);
            lv.setAdapter(
                new ArrayAdapter<String>(this, 
                                         android.R.layout.simple_list_item_1,
                                         results));
            if(results.contains("really")
               || results.contains("yes really") 
               || results.contains("disease"))
            {                   
                /////toast referenced to xml the after 400ms
                counter_score ++ ;
                txView.setId(1);
                counter_score_z +=1;
                ourSong = MediaPlayer.create(Cooking.this, R.raw.rightsound2);
                ourSong.start();
                AlertDialog dialogBuilder = new AlertDialog.Builder(this).create();
                dialogBuilder.setTitle("Nice");
                dialogBuilder.setMessage("Correct!.");
                dialogBuilder.setIcon(R.drawable.ic_mark);
                dialogBuilder.show();

                Thread timer = new Thread(){
                    public void run(){
                        try{
                            sleep(2500);
                        }catch (InterruptedException e){
                            e.printStackTrace();
                        } finally {
                            Intent nextAct = new Intent(Cooking.this, LetterEx.class);
                            startActivity(nextAct);
                            finish();
                        }
                    }
                };

                timer.start();

            }else{
                lv.setAdapter(
                    new ArrayAdapter<String>(this, 
                                             android.R.layout.simple_list_item_1,
                                             results));
                    counter_score +=0;
                    txView.setId(0);
                    counter_score_z +=0;
                    ourSong = MediaPlayer.create(Cooking.this, R.raw.wrongsound);
                    ourSong.start();
                    AlertDialog dialogBuilder = new AlertDialog.Builder(this).create();
                    dialogBuilder.setTitle("Oops");
                    dialogBuilder.setMessage("Try again");
                    dialogBuilder.setIcon(R.drawable.ic_wrong);
                    dialogBuilder.setButton(
                        "Continue", 
                        new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialog, int which) {
                                Intent openApp = 
                                    new Intent(Cooking.this, LetterEx.class);
                                startActivity(openApp);
                                finish();
                            }
                        });

                    dialogBuilder.setButton2(
                        "try again", 
                        new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialog, int which) {
                                // TODO Auto-generated method stub
                                dialog.dismiss();
                            }
                        });

                        dialogBuilder.show();
                        Thread timer = new Thread(){
                        public void run(){
                        try{
                           sleep(4000);
                        }catch (InterruptedException e){
                    e.printStackTrace();
                        } finally {

                        }
                    }
                };

                timer.start();
            }
        }

        if (requestCode == checkb && resultCode == RESULT_OK){
            ArrayList<String> results = 
                data.getStringArrayListExtra(RecognizerIntent.EXTRA_RESULTS);
            lv.setAdapter(
                new ArrayAdapter<String>(this, 
                                         android.R.layout.simple_list_item_1, 
                                         results));

            if(results.contains("delivering mail")
               || results.contains("no not really") 
               || results.contains("hi"))
            {

               /////toast referenced to xml the after 400ms
               counter_score ++ ;
               txView.setId(1);
               counter_score_z +=1;
               ourSong = MediaPlayer.create(Cooking.this, R.raw.rightsound2);
               ourSong.start();
               AlertDialog dialogBuilder = new AlertDialog.Builder(this).create();
               dialogBuilder.setTitle("Nice");dialogBuilder.setMessage("Correct!");
               dialogBuilder.setIcon(R.drawable.ic_mark);
               dialogBuilder.show();
               Thread timer = new Thread(){
                        public void run(){
                            try{
                             sleep(2500);
                            }catch (InterruptedException e){
                                e.printStackTrace();
                            } finally {
                                Intent nextAct2 = new Intent(Cooking.this, LetterEx.class);
                                startActivity(nextAct2);
                                finish();

                            }
                        }
                    };
                    timer.start();

           }else{
               lv.setAdapter(
                   new ArrayAdapter<String>(this, 
                                            android.R.layout.simple_list_item_1,
                                           results));
               counter_score +=0;
               txView.setId(0);
               counter_score_z +=0;
               ourSong = MediaPlayer.create(Cooking.this, R.raw.wrongsound);
               ourSong.start();
               AlertDialog dialogBuilder = new AlertDialog.Builder(this).create();
               dialogBuilder.setTitle("Oops");
               dialogBuilder.setMessage("Try again");
               dialogBuilder.setIcon(R.drawable.ic_wrong);
               dialogBuilder.setButton(
                   "Continue", 
                   new DialogInterface.OnClickListener() {
                       @Override
                       public void onClick(DialogInterface dialog, int which) {
                           Intent openApp2 = new Intent(Cooking.this, LetterEx.class);
                           startActivity(openApp2);
                           finish();
                       }
                   });

                   dialogBuilder.setButton2("try again", 
                                            new DialogInterface.OnClickListener() {

                        @Override
                        public void onClick(DialogInterface dialog, int which) {
                            // TODO Auto-generated method stub
                            dialog.dismiss();
                        }
                    });
                    dialogBuilder.show();
                    Thread timer = new Thread(){
                        public void run(){
                            try{
                             sleep(4000);
                            }catch (InterruptedException e){
                                e.printStackTrace();
                            } finally {

                            }
                        }
                    };
                    timer.start();
                }
            }
            super.onActivityResult(requestCode, resultCode, data);  
        }
    } 
```

这不会崩溃或任何事情，但它没有做我想做的事。

按下按钮 (IVimage1) 时...

```
public void onClick(View v) {
     if(v.getId() == R.id.IVimage1){
        Intent a = new Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH);
        a.putExtra(RecognizerIntent.EXTRA_LANGUAGE_MODEL, 
                       RecognizerIntent.LANGUAGE_MODEL_FREE_FORM);
        a.putExtra(RecognizerIntent.EXTRA_MAX_RESULTS, 1);
        a.putExtra(RecognizerIntent.EXTRA_PROMPT, "Speak.");
        startActivityForResult(a, checka); 
```

checka 的 requestCode 已正确检查并显示“正确”对话框，但“checkb”的错误对话框也会显示。显然，我需要打破 If 语句代码..以分隔 requestCodes 并为每个按钮分配一个。

我试过休息；返回; 做 swtich(); 和类似问题的案例，但到目前为止还没有运气......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T19:39:17.307

你`checka == checkb`总是这样定义它。尝试给他们不同的价值。

```
 // For example:
    static final int check = 111;
    static final int checka = 112;
    static final int checkb = 113; 
```

# html - 链接在 chrome 和 opera 中不可点击，但在 Firefox 和 IE 中不可点击？

> ID：12125009
> 
> 赞同：0
> 
> 时间：2012-08-25T19:31:16.133
> 
> 标签：html, internet-explorer, firefox, google-chrome, opera

我在图像周围有一个链接标签，它在 IE 和 Firefox 中工作，但在 Chrome 和 Opera 中不起作用？

```
 <div class="gallery">
<a href="index.php?id=1331&no_cache=1&uid=1&mode=s"><img width="172" height="235" src="mi35.jpg"></a>
<div class="title">Mini</div>
</div> 
```

我尝试了 urlencode 无济于事：

```
index.php%3Fid%3D1331%26no_cache%3D1%26uid%3D1%26mode%3Ds
```

我已经在我的 php 源代码中删除了 no_cache=1 和 urlencode ，但无济于事：

```
urlencode ( str_replace ( "no_cache=1", "", $this->pi_getPageLink ( $GLOBALS [ 'TSFE' ]->id, '', array ( "uid" => $row [ "UID" ], "mode " => "s" ) )) );

```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-25T20:01:02.007

事实上，这是 CSS 文件中的一个问题，图像周围 div 上的负 z-index 使得无法点击链接。

# css - 如何删除垂直滚动条 SyntaxHighlighter 块？

> ID：12125010
> 
> 赞同：13
> 
> 时间：2012-08-25T19:31:17.290
> 
> 标签：css, joomla, scrollbar, syntax-highlighting

我是 Web 开发的新手，可能有一个主要问题。我已经在我的网站上安装了 Joomla 2.5 CMS，下载、安装并打开了[SyntaxHighlighter](http://alexgorbatchev.com/SyntaxHighlighter/)插件。然后启用`bash`语法并在我的页面中添加以下代码

```
<pre class="brush: bash">$ uname -a
Linux laptop 2.6.32-41-generic #89-Ubuntu SMP Fri Apr 27 22:22:09 UTC 2012 i686 GNU/Linux
$</pre> 
```

我得到了这个结果

![SyntaxHighlighter 块中的垂直滚动条](../Images/54a8d4606ec9209328d1fcc48b83ab5b.png)

没关系，但我不知道为什么会出现突出显示的垂直滚动条。它只滚动一个或两个像素。因此，我尝试将以下代码添加到模板`CSS`文件的开头

```
.syntaxhighlighter,
.syntaxhighlighter div,
.syntaxhighlighter code,
.syntaxhighlighter table,
.syntaxhighlighter table td,
.syntaxhighlighter table tr,
.syntaxhighlighter table tbody {
  overflow-y: hidden;
} 
```

它没有帮助我，我认为问题更深。您对如何删除此垂直滚动条有任何想法吗？

**更新**如果我`!important`在模板中使用声明，`CSS`滚动条就会消失，但是带有突出显示代码的块在页面缩放时表现得非常奇怪。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-08T19:21:00.413

您可以添加以下样式以删除垂直滚动条并仅在需要时添加水平滚动条：

```
<style type="text/css">
  .syntaxhighlighter { 
     overflow-y: hidden !important; 
     overflow-x: auto !important; 
  }
</style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-01T04:01:00.930

syntaxhighlighter 具有`overflow: auto`默认样式（请参阅 shCoreDefault.css 中的以下 css 片段）。`overflow-y:hidden !important`这就是为什么我们不喜欢垂直滚动条时要设置的原因。但是我们不再需要设置`overflow-x: auto`了。它已经在那里了。

```
.syntaxhighlighter {
    font-size: 1em !important;
    margin: 1em 0 !important;
    overflow: auto !important;
    position: relative !important;
    width: 100% !important;
} 
```

你可以看到 syntaxhighlighter 已经使用了 '!important'，这就是为什么，你会发现不同的浏览器有不同的结果。根据我的经验，在 Firefox 中，我得到了预期的结果：垂直滚动条被隐藏。但在 Chrome 中，滚动条仍然存在。

为了使我定义的类具有更高的优先级，我在其他一些范围选择器前面加上前缀，例如容器的 id 或类。

```
ContainerId .syntaxhighlighter {
    overflow-y: hidden !important;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T19:43:03.777

我查看了示例，发现其中也有一个垂直滚动。当我检查 `"syntaxhighlighter javascript"`自己有一个溢出。检查您是否在包含 css 之后或之前包含了代码

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-24T19:45:57.140

Trying to remove a *horizontal* scroll bar, this was what finally worked for me, taking inspiration from John Yin's post above. No sub-set of the below worked in-and-of itself.

```
/* .post class is on high-level div */
.post .syntaxhighlighter {
    position: relative !important;
    width: 100% !important;
    overflow-y: visible !important;
    overflow-x: visible !important;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-13T14:24:17.273

要在您的网站中删除 SyntaxHighlighter 的垂直滚动条，您可以在`<head>...</head>`页面的部分中使用以下代码段。

```
<style type="text/css">
 .syntaxhighlighter table td.code .container {
  position: relative !important;
  padding-bottom: 5px !important;
}
</style> 
```

希望这段代码对您有所帮助！:)

# c++ - 标题包含的嵌套深度是否有限制？

> ID：12125014
> 
> 赞同：6
> 
> 时间：2012-08-25T19:31:44.923
> 
> 标签：c++, compiler-construction, limit, header-files, nested

我在 MSDN 或其他地方找不到任何东西，但是对于标题包含的嵌套深度是否存在硬编码限制？例子：

```
// H1.h
// guards etc.
#include "H2.h"

// H2.h
// guards etc.
#include "H3.h"

//...

// HN.h <---- how large can N get?? 
```

我想知道标准中是否有任何关于此的内容。如果答案是定义了实现，那么我主要对 Visual Studio 工具链感兴趣。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-25T19:56:49.867

该标准还对此做了一些说明（在关于实施数量的部分，附件 B）：

> 这些限制可能会限制包括以下描述的数量或其他数量。建议将每个数量后面的括号中的数字作为该数量的最小值。但是，这些数量仅作为指导，并不能确定合规性。
> 
> ...
> 
> *   #include 文件的嵌套级别 [256]。

请注意，这只是推荐的最小值，因此编译器可能不支持那么多包含（但大多数编译器都支持，如其他答案所示）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-25T19:40:11.203

我编写了一个包含自身的头文件，并使用 MSVS 2010 对其进行了编译。这给出了错误消息：

```
fatal error C1014: too many include files : depth = 1024 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-25T19:39:30.803

是：200。至少对于我的 gcc 版本。

它可以很容易地测试：

```
#!/bin/bash

i=0

touch "test$i.c"

while gcc -c "test$i.c"; do
  j="$[ $i + 1 ]"
  echo "#include \"test$i.c\"" > "test$j.c"
  i="$j"
  echo "$j" | grep -q "000$" && echo "$j are fine"
done 
```

这产生：

```
In file included from test2.c:1:0,
             from test3.c:1,
             from test4.c:1,
             ...
             from test198.c:1,
             from test199.c:1,
             from test200.c:1:
test1.c:1:19: error: #include nested too deeply 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-25T19:36:51.640

来自[Visual Studio 2012 的 MSDN](http://msdn.microsoft.com/en-us/library/36k2cdd4%28v=vs.110%29.aspx)：

> 包含文件的嵌套最多可以持续 10 层。

**更新**：

这个“官方”限制可能更像是一个指导方针，这样人们就不会无缘无故地开始堆叠包含文件。我不相信至少几十年来没有一个编译器具有如此严格的包含限制。

例如，根据其他答案之一，至少一个版本的 VS C++ 编译器支持大约 1024 个嵌套级别。

# javascript - Lotus Xpages Extension 库和页面提交

> ID：12125017
> 
> 赞同：0
> 
> 时间：2012-08-25T19:32:03.043
> 
> 标签：javascript, dojo, xpages, lotus-domino, lotus

第 1 步：向 xpage 添加两个输入文本和一个带有保存文档服务器端操作的按钮。通过单击按钮，它会保存文档。

步骤 2\. 将输入文本之一设置为 dijit.form.ValidationTextBox。这会自动将 '**parseOnLoad: true**' 参数添加到页面。浏览器中页面的来源：

步骤 3\. 将 **required=true** 参数添加到 dijit.form.ValidationTextBox。即使validationTextBox 留空，文档仍然可以保存。

步骤 4\. 将 Lotus Extension 库中的 numberspinner 项目添加到 xpage。这会在页面中添加 **dojoType="dijit.form.Form"** 属性，如果 inputvalidationtextbox 为空，则会阻止文档保存。

步骤 4\. 将 Lotus Extension 库中的 numberspinner 项目添加到 xpage。如果 inputvalidationtextbox 为空，这会将 dojoType="dijit.form.Form" 属性添加到页面并防止文档保存。浏览器中页面的来源：

```
 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="hu">
<head>
<script type="text/javascript">if(!navigator.cookieEnabled)window.location.href='http://localhost/development/Labor/labor.nsf/test1.xsp?SessionID=D937UTFGVR';</script>
<title></title>
<link rel="stylesheet" type="text/css" href="/xsp/.ibmxspres/.mini/css/@Da&amp;@Ib&amp;2Tfxsp.css&amp;2TfxspLTR.css&amp;2TfxspFF.css.css">
<script type="text/javascript" src="/xsp/.ibmxspres/dojoroot-1.6.1/dojo/dojo.js" djConfig="locale: 'hu-hu', parseOnLoad: true"></script>
<script type="text/javascript" src="/xsp/.ibmxspres/.mini/dojo/.hu-hu/@Fi&amp;@Fo&amp;@Iq.js"></script>
</head>
<body class="xspView tundra">
<form id="view:_id1" method="post" action="/development/Labor/labor.nsf/test1.xsp" class="xspForm" enctype="multipart/form-data" dojoType="dijit.form.Form">
<input type="text" dojoType="dijit.form.ValidationTextBox" required="true" id="view:_id1:inputText1" name="view:_id1:inputText1" class="xspInputFieldEditBox"><button class="xspButtonCommand" type="button" name="view:_id1:button1" id="view:_id1:button1">Label</button><br>
<input type="text" id="view:_id1:inputText2" name="view:_id1:inputText2" class="xspInputFieldEditBox"><input dojoType="dijit.form.NumberSpinner" id="view:_id1:djNumberSpinner1" name="view:_id1:djNumberSpinner1">
<input type="hidden" name="$$viewid" id="view:_id1__VUID" value="!d937utjhyk!">
<input type="hidden" name="$$xspsubmitid">
<input type="hidden" name="$$xspexecid">
<input type="hidden" name="$$xspsubmitvalue">
<input type="hidden" name="$$xspsubmitscroll">
<input type="hidden" name="view:_id1" value="view:_id1"></form>
<script type="text/javascript">
XSP.addOnLoad(function() {
XSP.attachEvent("view:_id1:_id2", "view:_id1:button1", "onclick", null, true, 2);
}); 
</script>
</body>
</html> 
```

我的问题是如何向xpage添加部分刷新，或者提交功能，可以执行，甚至是空的必填字段。这是可能的，直到我从扩展库中添加 dijit.form.NumberSpinner。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T09:45:05.690

```
<form id="view:_id1" 
  method="post" 
  action="/development/Labor/labor.nsf/test1.xsp" 
  class="xspForm" enctype="multipart/form-data" 
  dojoType="dijit.form.Form">
<script type="dojo/method" event="submit">

     if(!this.validate()) {

          dojo.xhrPost({ url: form.get("action"), content: form.getValues() }).then(
              function() { /* successor */ }, 
              function() { /* errorhandle */ }
           );
     }
     else {

           this.containerNode.submit();
     }
</script>

 <!-- ... -->
</form> 
```

# web-services - 使用soap调用在excel中创建UDF，但返回#Value！我究竟做错了什么？

> ID：12125018
> 
> 赞同：0
> 
> 时间：2012-08-25T19:32:08.727
> 
> 标签：web-services, excel, soap, user-defined-functions

这是我写的代码。有关 Web 服务的更多信息，请访问[https://tckimlik.nvi.gov.tr/Service/KPSPublic.asmx?op=TCKimlikNoDogrula](https://tckimlik.nvi.gov.tr/Service/KPSPublic.asmx?op=TCKimlikNoDogrula)

```
Function tckimlik(ad As String, soyad As String, tckn As Double, dy As Integer) As String
Dim responseText As String
    Dim sURL As String
    Dim sEnv As String
    Dim xmlhtp As New MSXML2.XMLHTTP
    Dim xmlDoc As New DOMDocument
    Dim startPos, endPos, openTag, closeTag, startTagPos, sid As String
    sURL = "http://tckimlik.nvi.gov.tr/WS/TCKimlikNoDogrula"
    sEnv = "<?xml version=""1.0"" encoding=""utf-8""?>"
    sEnv = sEnv & "<soap:Envelope xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns:soap=""http://schemas.xmlsoap.org/soap/envelope/"">"
    sEnv = sEnv & " <soap:Body>"
    sEnv = sEnv & "<TCKimlikNoDogrula xmlns=""http://tckimlik.nvi.gov.tr/WS""> "
    sEnv = sEnv & "<TCKimlikNo>"
    sEnv = sEnv & tckn
    sEnv = sEnv & "</TCKimlikNo>"
    sEnv = sEnv & "<Ad>"
    sEnv = sEnv & ad
    sEnv = sEnv & "</Ad>"
    sEnv = sEnv & "<Soyad>"
    sEnv = sEnv & soyad
    sEnv = sEnv & "</Soyad>"
    sEnv = sEnv & "<DogumYili>"
    sEnv = sEnv & dy
    sEnv = sEnv & "</DogumYili>"
    sEnv = sEnv & " </TCKimlikNoDogrula>"
    sEnv = sEnv & " </soap:Body>"
    sEnv = sEnv & "</soap:Envelope>"

With xmlhtp
        .Open "post", sURL, False
        .setRequestHeader "Host", "tckimlik.nvi.gov.tr"
        .setRequestHeader "Content-Type", "text/xml; charset=utf-8"
        .setRequestHeader "soapAction", "http://tckimlik.nvi.gov.tr/WS/TCKimlikNoDogrula"
        .send sEnv
        xmlDoc.LoadXML .responseText
        responseText = .responseText
    End With
tckimlik = responseText

End Function 
```

谢谢

# c# - 如何从列表框中加载项目作为文件并显示文件内容？

> ID：12125022
> 
> 赞同：0
> 
> 时间：2012-08-25T19:32:48.913
> 
> 标签：c#

我在 Form1 中有这个代码。我正在搜索 xml 文件。当我使用 listBox1 选择索引更改事件找到它们时，我想这样做，当我在 lixtBox 中选择项目时，它会将其视为文件将解析它的内容并向我显示解析的内容。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Xml;
using System.Xml.Linq;
using System.Xml.XPath;
using System.IO;
using System.Collections;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        DirectoryInfo dirinf = new DirectoryInfo(@"C:\");
        List<FileSystemInfo> fsi = new List<FileSystemInfo>();

        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {

            backgroundWorker1.RunWorkerAsync();
            button1.Enabled = false;
        }

        private void ParseAndDisplayXml(string filename)
        {
            XDocument document = XDocument.Load(filename);
            var list = document.Root.Elements("Message")
                .Select(
                e => new
                {
                    Date = e.Attribute("Date").Value.ToString(),
                    Time = e.Attribute("Time").Value.ToString(),
                    Text = e.Element("Text").Value.ToString()
                }
                );
 string result="";
            foreach (var item in list)
            {
               result += string.Format("Date--{0},Time--{1},Text--{2}", item.Date, item.Time, item.Text + Environment.NewLine);
            }
        }

        public void Search(string strExtension,
                            DirectoryInfo di,
                            List<FileSystemInfo> pResult)
        {
            try
            {

                foreach (FileInfo fi in di.GetFiles())
                {
                    if (InvokeRequired)
                    {
                        BeginInvoke(new Action(() => label2.Text = fi.Name));
                    }
                    if (fi.Name == "MessageLog.xsl")
                    {
                        foreach (FileInfo fii in di.GetFiles())
                        {
                        if (fii.Extension == strExtension)
                            pResult.Add(fii);
                        }
                        if (InvokeRequired)
                        {
                            BeginInvoke(new Action(() => label4.Text = pResult.Count.ToString() + Environment.NewLine));
                        }

                    }
                }

                    foreach (DirectoryInfo diChild in di.GetDirectories())
                        Search(strExtension, diChild, pResult);

            }
            catch (Exception e)
            {
            }
        }

        private void backgroundWorker1_DoWork(object sender, DoWorkEventArgs e)
        {
            Search(".xml", dirinf, fsi);
            backgroundWorker1.ReportProgress(100);

        }

        private void backgroundWorker1_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {
            for (int i = 0; i < fsi.Count; i++)
            {                
                    listBox1.Items.Add(fsi[i].Name + Environment.NewLine);
            }

        }

        private void listBox1_SelectedIndexChanged(object sender, EventArgs e)
        {
            label2.Text = listBox1.SelectedItem.ToString();
        }            
    }
} 
```

我从 C:\ 开始搜索，然后当搜索结束时，我将找到的项目添加到 listBox1。

例如，现在在我的 listBox1 中有 4 个文件：

danny.xml adi.xml sharon.xml yoval.xml

在 selectedindexchanged 中，我添加了选项，以便用户可以在项目之间移动。

现在我想要做的是当用户在列表框中选择一些索引，例如索引 [1]，并且只有当他用键盘单击输入或用鼠标左键单击时，它才会调用/使用函数：ParseAndDisplayXML。

然后它将解析需要转换为文件的选定索引，因此在 backgroundWorker1_RunWorkerCompleted 事件中，我将文件作为项目添加到 listBox 中，但仅包含文件的名称。如果我做了 .FullName 而不是 .Name 它也在添加带有目录的文件名。

因此，我需要以某种方式获取已完成事件中文件的 FullName，然后在选择 FullName 项目之一对其进行解析并将其显示在 listBox 中时。

parse 函数应该从 xml 文件中获取特定内容，并且它工作我之前单独检查了这个函数。

问题是我如何使用户通过单击/键输入选择索引以及如何解析和显示它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T20:48:00.193

当您向列表框添加内容时。它需要一个对象，并将文本设置为 object.ToString()

例如

```
MyListBox.Add(100); 
```

将框 100 并显示“100”

找不到 FileSystemInfo 的 ToString() 方法是否已被覆盖，但首先要尝试的是

```
private void backgroundWorker1_RunWorkerCompleted(object sender,
RunWorkerCompletedEventArgs e)
{
// newline is unnecesary and you should be using foreach
  foreach(FileSystemInfo f in fsi)
  {                
    listBox1.Items.Add(f);
  }
}
// display full name of file
private void listBox1_SelectedIndexChanged(object sender, EventArgs e)
{
  label2.Text = ((FileSystemInfo)listBox1.SelectedItem).Fullname;
} 
```

如果 FileSystemInfo.ToString() 没有返回 Name，有几种方法可以处理它。如果您不想保留 FileSystemInfo 实例，我们也可以处理。

# mysql - MySQL UPDATE 字段来自 SELECT

> ID：12125024
> 
> 赞同：0
> 
> 时间：2012-08-25T19:33:20.690
> 
> 标签：mysql, select

我想更新一个匹配几个条件的表中的一些结果（即来自其他表的变量以匹配 SELECT 语句）

我在网上找到了类似的东西：

```
START TRANSACTION;
SELECT * FROM score_test,score_2,score_3, etc WHERE score=20000 AND score_test.id=score_2.id AND etc.. FOR UPDATE;
UPDATE score_test SET name='Test';
COMMIT; 
```

**注意**： UPDATE score_test SET ... WHERE 不能满足我的需要，因为我需要收集满足 SELECT 语句的结果

但它没有用。它更新了我所有的字段。我正在寻找的是一种用于仅更新 SELECT 语句中的结果的语法。

我的数据库分为 10-15 个表，并且条件可能会有所不同，因为我必须更新一些严格完成某些条件的字段，这些条件依赖于其他表的查询。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T19:40:48.013

SQL`UPDATE`语句接受`WHERE`子句，就像`SELECT`语句一样：

```
UPDATE score_test SET name='Test' WHERE score=20000; 
```

# 编辑

您还可以将跟随的部分视为与跟随的部分大致`UPDATE`相同，这意味着您可以进行连接：`SELECT``FROM`

```
UPDATE score_test 
  JOIN test ON test.id=score_test.test_id
SET score_test.name = 'Test'
WHERE score_test.score=20000 
```

这方面的提示在[UPDATE 文档](http://dev.mysql.com/doc/refman/5.0/en/update.html)中，它使用`table_reference`语法定义中的符号。的语法[在 JOIN 页面上](http://dev.mysql.com/doc/refman/5.0/en/join.html)`table_reference`定义。意味着和查询中的相同处理。`SELECT``UPDATE`

# 注意事项`FOR UPDATE`

语句中的`FOR UPDATE`子句*实际上*`SELECT`并没有做任何与更新相关的事情......它只收集行上的锁。您仍然需要使用适当的查询来执行所有必要的 JOINS 和 WHERE（可能与您的相同）*`UPDATE``SELECT`*

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T19:42:21.710

有多种方法可以完成您的要求。满足您的问题的最简单方法就是进行更新。

`UPDATE score_test SET name='Test' WHERE score=20000;`

如果要满足来自多个表的条件，可以在更新语句中使用连接，就像选择语句一样。

如果您有如此复杂的用例，您可以进一步实现您的目标，方法是创建一个包含要编辑的项目的 ID 的临时表，并通过多个查询逐个剔除该表，`DELETE`直到获得所需的集合更新。*

# jquery - 将json嵌入到jquery ajax GET请求

> ID：12125027
> 
> 赞同：0
> 
> 时间：2012-08-25T19:33:38.723
> 
> 标签：jquery, ajax, rest, decode, encode

我想针对在 Flask 上运行的 RESTful API 使用类型为“GET”的 jQuery 的 ajax 调用。在我的请求中，我想将一些数据作为 JSON 发布。

我正在为 POST 请求做同样的事情，它们就像魅力一样工作。但是使用 GET Flask 给了我 400 个错误，并且深入研究它似乎 JSON 在途中被部分 URIEncoded ({%22email%22:%22some@email.com%22})。

我尝试使用 decodeURIComponent，因为我正在 JSON.stringifying ajax 数据参数中的 json，但没有区别。

```
sessiontoken = "123abc";
jsonData = {"email": email};

$.ajax({
    type: 'GET',
    crossDomain: true,
    url: 'http://someserver/sessions/' + sessiontoken,
    dataType: 'json',
    processData: false, //added this to see if it helps, it didn't 
    contentType: "application/json",
    async: false,
    data: JSON.stringify(jsonData),
    success: function(data){
        //I'd be happy
    },
    error: function(data){
        //This is where I get as my backend throws a 400 on me due to the screwed up json
    }
}); 
```

这让我发疯，因为我似乎无法在这个星球上找到遇到同样问题的任何人。我以前一直在 ajaxing 请求，过去从未遇到过这种愚蠢的事情。

编辑：好的，看来我需要放弃我的目标，只需将任何参数作为查询字符串传递，而不是尝试将它们添加到请求正文中。我想这没有什么问题，例如这里讨论的：[REST API 最佳实践：在哪里放置参数？](https://stackoverflow.com/questions/4024271/rest-api-best-practices-where-to-put-parameters/4026505#4026505)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T19:47:01.543

我怀疑您想附加`jsonData`为查询参数。为此，您无需对其进行编码。

```
$.ajax({
  ...
  data: jsonData,
  ...
 }); 
```

您生成的 URL 将类似于

```
http://someserver/sessions/123abc?email=foo%40bar.com 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T19:46:23.040

如果您尝试将任何数据设置为 ajax 的 GET 请求，它将被转换为 URL 字符串的参数。当然，像 " 这样的任何符号都将表示为 %URL_CODE （[查看所有代码](http://www.w3schools.com/tags/ref_urlencode.asp)），您将得到如下查询：

```
http://someserver/sessions/sessiontoken?{%22email%22:%22some@email.com%22} 
```

组织 restful 服务的最佳方式是在 URI 部分中描述查询。另一种方法可以将 json 放入 URL 参数中，并在服务器端解析符号的 url 代码。

# eclipse - Eclipse 的 Lua 解释器

> ID：12125033
> 
> 赞同：0
> 
> 时间：2012-08-25T19:34:15.870
> 
> 标签：eclipse, eclipse-plugin, lua, interpreter, coronasdk

我正在尝试在 Eclipse 模拟器中运行 lua 代码。LuaEclipse 插件已安装和更新，但当我尝试运行代码时，Eclipse 要求提供“Lua 解释器”。

如果我将 Lua 解释器设置为 CoronaSimulator.exe，那么 Eclipse 将在 Corona 模拟器中正确运行 Lua 代码。但是，我想在 Eclipse 模拟器中运行 Lua 代码！

任何帮助将不胜感激 - 在此先感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T00:22:28.477

Eclipse 只能使用普通的命令行 lua 解释器... Corona 有自己的内部 Lua 解释器，它以自己的方式与自己的代码集成，它不会像您期望的那样运行。

# ruby-on-rails - 编写一个不显示私有资源的方法，除非它是当前用户？

> ID：12125035
> 
> 赞同：1
> 
> 时间：2012-08-25T19:34:32.580
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我的`Product`模型具有属性`private`。我想制作一种方法，允许当前用户能够选择他们的私人产品和其他产品 `private = false`。

```
class Product < ActiveRecord::Base
  attr_accessible :name, :private
  belongs_to :user

  def permission
    unless self.current_user
      unless self.private
      end
    end
  end
end 
```

开始是这样的吗？我将如何编写此方法？目标是将其放在选择菜单中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T19:46:39.357

我会为此创建一个类方法，你会传递类似`current_user`的东西

```
class Product < ActiveRecord::Base
  attr_accessible :name, :private
  belongs_to :user

  def self.for_user_or_public(user)
    where("user_id = ? or private = ?", user.id, false)
  end
end 
```

用法：

```
products = Product.for_user_or_public(current_user) 
```

至于选择，应该像下面这样

```
<%= f.collection_select :owner_id, Product.for_user_or_public(current_user), :user_id, :name, { :include_blank => true } %> 
```

# c# - 在实体框架中使用 bindingSource 的过滤器

> ID：12125037
> 
> 赞同：4
> 
> 时间：2012-08-25T19:35:16.180
> 
> 标签：c#, entity-framework, bindingsource

**我正在开发一个 C# win-form 应用程序。**

在我的表单中，我有与 Binding-Source 绑定的 Data-Grid-View，而 Binding-Source Data-source 是一个实体框架表。

当我使用实体框架时，我不能使用绑定源的过滤器和按数据网格视图的列排序，但是当我不使用实体框架时，我可以使用它们。我如何将它们与实体框架一起使用？

表单加载时我的代码是

```
contex = new myEntity();
myBindingSource.DataSource = contex.myTable; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T20:20:43.637

每个 BindingSource 都有一个属性**[SupportsFiltering](http://msdn.microsoft.com/de-de/library/system.windows.forms.bindingsource.supportsfiltering.aspx)**（和**[SupportsSorting](http://msdn.microsoft.com/de-de/library/system.windows.forms.bindingsource.supportssorting.aspx)**）。如果您将**entitySet 设置为 DataSource，**这两个属性将自动设置为**false**！所以有一些可能的解决方案。您可以为您提供一个扩展方法，如此处`IEnumberable<T>`所示[，](http://www.extensionmethod.net/Details.aspx?ID=474)或者您选择使用`Linq2Entities`.

**Linq2Entities**的代码段可能是：

```
myEntity context = new myEntity();
myBindingSource.DataSource = (from m in context.myTable
                              where m.PROPERTY MEETS CONDITION
                              select m).ToList<TYPE>(); 
```

**扩展方法**的片段：

```
// extension method
public static IEnumerable<T> Filter<T>(this IEnumerable<T> list, Func<T, bool> filterParam) {
        return list.Where(filterParam);
}

// filtering example
context.myTable.Filter(x => x.ItemName.StartsWith("Test")) 
```

此外，这个主题之前已经讨论过很多次，甚至在[SO](https://stackoverflow.com/questions/26196/filtering-collections-in-c-sharp)上也是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T20:42:07.780

您标记了实体框架，但没有显示您的模型。假设 MyEntity 是您的 ObjectContext 或 DBContext ，您可以绑定到 DbSet 的[本地属性](http://blogs.msdn.com/b/efdesign/archive/2010/09/08/data-binding-with-dbcontext.aspx)，这是一个支持排序的可观察集合。

```
myBindingSource.DataSource = contex.myTable.Local; 
```

# ruby-on-rails - 我在哪里确认使用 FactoryGirl 创建的用户？

> ID：12125038
> 
> 赞同：16
> 
> 时间：2012-08-25T19:35:34.267
> 
> 标签：ruby-on-rails, rspec, factory-bot, devise-confirmable

使用 rails、devise、rspec 和 factorygirl：

试图为我的网站创建一些测试。我正在使用可确认模型进行设计，因此当我使用 FactoryGirl 创建用户时，该用户未得到确认。

这是我的工厂.rb：

```
FactoryGirl.define do
  factory :user do
    full_name             "Aren Admin"
    email                 "aren@example.com"
    password              "arenaren"
    password_confirmation "arenaren"
    role_id               ADMIN
  end
end 
```

这是我的 rspec 测试文件：

```
require 'spec_helper'

describe "Admin pages" do

  subject { page }

  describe "home page" do
    let(:user) { FactoryGirl.create(:user) }
    before { visit admin_home_path }

    it { should have_content("#{ROLE_TYPES[user.role_id]}") }
  end
end 
```

由于未确认用户，我收到错误消息。通过四处搜索，我很确定我需要使用“确认！”的方法。并且它属于 factory.rb 文件，但我不知道把它放在哪里。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-08-25T20:52:32.777

您还可以按如下方式设置 Confirmed_at 属性。为我工作：

```
FactoryGirl.define do
  factory :user do
    full_name             "Aren Admin"
    email                 "aren@example.com"
    password              "arenaren"
    password_confirmation "arenaren"
    role_id               ADMIN
    confirmed_at          Time.now
  end
end 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-08-25T20:47:32.117

更好的是，执行以下操作（然后您不需要为每个测试套件创建一个前置过滤器）

```
Factory.define :confirmed_user, :parent => :user do |f|
  f.after_create { |user| user.confirm! }
end 
```

在这里找到： [https ://stackoverflow.com/a/4770075/1153149](https://stackoverflow.com/a/4770075/1153149)

**编辑以添加不推荐使用的语法**

```
FactoryGirl.define do |f|
  #Other factory definitions

  factory :confirmed_user, :parent => :user do
    after_create { |user| user.confirm! }
  end
end 
```

**编辑 01/27 再次更新语法**

```
FactoryGirl.define do
  #Other factory definitions

  factory :confirmed_user, :parent => :user do
    after(:create) { |user| user.confirm! }
  end
end 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-08-25T20:44:33.503

试试`user.confirm!`你的`before`街区

在[这里找到](https://github.com/plataformatec/devise/wiki/How-To:-Controllers-and-Views-tests-with-Rails-3-%28and-rspec%29)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-07-06T00:46:09.503

这是为我工作的工厂

```
FactoryGirl.define do
  factory :user do
    sequence :email do |n|
      "address#{n}@example.com"
    end
    sequence :password do |n|
      "password#{n}"
    end

    factory :confirmed_user do
      before(:create) {|user| user.skip_confirmation! }
    end
  end
end 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-12-26T08:46:28.017

将此行添加到您的`User`工厂定义中：

```
before(:create) { |user| user.skip_confirmation! } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-04-21T15:02:18.467

将 Devise 可确认逻辑放在 after(:build) 回调中...

```
FactoryGirl.define do
  factory :user do
    after(:build) do |u|
      u.confirm!
      u.skip_confirmation_notification!
    end
 ...
end 
```

对我来说，确认！或跳过确认！在 after(:create) 块中导致电子邮件参数的验证错误并且不起作用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-12-28T21:34:47.723

您应该`skip_confirmation!`在之前调用，`create`以便将其保留在用户身上。

```
before(:create) do |user|
  user.skip_confirmation!
end 
```

# linux - 在 Ubuntu 12.04 中打开 Eclipse Juno，出现错误“没有更多句柄 ...”

> ID：12125044
> 
> 赞同：11
> 
> 时间：2012-08-25T19:36:04.620
> 
> 标签：linux, eclipse, ubuntu, swt, mozilla

从今天开始，每次打开 Eclipse 时，都会弹出一个标题为“出现问题”的消息框，上面写着：

> 没有更多句柄 [Unknown Mozilla path (MOZILLA_FIVE_HOME not set)] 可能的参数：{0}、{1}、{2}、{3} 没有更多句柄 [Unknown Mozilla path (MOZILLA_FIVE_HOME not set)]

然后我单击“确定”并继续工作台，我得到另一个错误说

> 发生 SWT 错误。建议您退出工作台。随后的错误可能会发生并在没有警告的情况下退出工作台。有关详细信息，请参阅 .log 文件。
> 
> 是否要退出工作台？（是/否）

然后我单击“是”并查看了 .metadata 中的 .log 文件。我看到了这个长堆栈跟踪：

```
!ENTRY org.eclipse.datatools.sqltools.plan 4 0 2012-08-25 14:28:52.355
!MESSAGE No resource bundle has been set for the LoggerNo more handles [Unknown Mozilla path (MOZILLA_FIVE_HOME not set)]".

!ENTRY org.eclipse.datatools.sqltools.plan 4 0 2012-08-25 14:28:52.359
!MESSAGE No more handles [Unknown Mozilla path (MOZILLA_FIVE_HOME not set)] possible args: {0}, {1}, {2}, {3}
!STACK 0
org.eclipse.swt.SWTError: No more handles [Unknown Mozilla path (MOZILLA_FIVE_HOME not set)]
    at org.eclipse.swt.SWT.error(SWT.java:4387)
    at org.eclipse.swt.browser.Mozilla.initMozilla(Mozilla.java:1939)
    at org.eclipse.swt.browser.Mozilla.create(Mozilla.java:699)
    at org.eclipse.swt.browser.Browser.<init>(Browser.java:99)
    at org.eclipse.datatools.sqltools.plan.internal.ui.view.GraphicsPlanControl.createDetailForm(GraphicsPlanControl.java:93)
    at org.eclipse.datatools.sqltools.plan.internal.ui.view.GraphicsPlanControl.init(GraphicsPlanControl.java:73)
    at org.eclipse.datatools.sqltools.plan.internal.ui.view.GraphicsPlanControl.<init>(GraphicsPlanControl.java:54)
    at org.eclipse.datatools.sqltools.plan.internal.ui.view.PlanView.createPartControl(PlanView.java:136)
    at org.eclipse.ui.internal.e4.compatibility.CompatibilityPart.createPartControl(CompatibilityPart.java:129)
    at org.eclipse.ui.internal.e4.compatibility.CompatibilityView.createPartControl(CompatibilityView.java:155)
    at org.eclipse.ui.internal.e4.compatibility.CompatibilityPart.create(CompatibilityPart.java:300)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.eclipse.e4.core.internal.di.MethodRequestor.execute(MethodRequestor.java:56)
    at org.eclipse.e4.core.internal.di.InjectorImpl.processAnnotated(InjectorImpl.java:857)
    at org.eclipse.e4.core.internal.di.InjectorImpl.processAnnotated(InjectorImpl.java:837)
    at org.eclipse.e4.core.internal.di.InjectorImpl.inject(InjectorImpl.java:111)
    at org.eclipse.e4.core.internal.di.InjectorImpl.internalMake(InjectorImpl.java:318)
    at org.eclipse.e4.core.internal.di.InjectorImpl.make(InjectorImpl.java:240)
    at org.eclipse.e4.core.contexts.ContextInjectionFactory.make(ContextInjectionFactory.java:161)
    at org.eclipse.e4.ui.internal.workbench.ReflectionContributionFactory.createFromBundle(ReflectionContributionFactory.java:102)
    at org.eclipse.e4.ui.internal.workbench.ReflectionContributionFactory.doCreate(ReflectionContributionFactory.java:71)
    at org.eclipse.e4.ui.internal.workbench.ReflectionContributionFactory.create(ReflectionContributionFactory.java:53)
    at org.eclipse.e4.ui.workbench.renderers.swt.ContributedPartRenderer.createWidget(ContributedPartRenderer.java:141)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.createWidget(PartRenderingEngine.java:889)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.safeCreateGui(PartRenderingEngine.java:623)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$6.run(PartRenderingEngine.java:511)
    at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.createGui(PartRenderingEngine.java:496)
    at org.eclipse.e4.ui.workbench.renderers.swt.ElementReferenceRenderer.createWidget(ElementReferenceRenderer.java:74)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.createWidget(PartRenderingEngine.java:889)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.safeCreateGui(PartRenderingEngine.java:623)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.safeCreateGui(PartRenderingEngine.java:725)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.access$2(PartRenderingEngine.java:696)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$7.run(PartRenderingEngine.java:690)
    at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.createGui(PartRenderingEngine.java:675)
    at org.eclipse.e4.ui.workbench.renderers.swt.StackRenderer.showTab(StackRenderer.java:1042)
    at org.eclipse.e4.ui.workbench.renderers.swt.LazyStackRenderer.postProcess(LazyStackRenderer.java:98)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.safeCreateGui(PartRenderingEngine.java:639)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.safeCreateGui(PartRenderingEngine.java:725)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.access$2(PartRenderingEngine.java:696)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$7.run(PartRenderingEngine.java:690)
    at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.createGui(PartRenderingEngine.java:675)
    at org.eclipse.e4.ui.workbench.renderers.swt.SWTPartRenderer.processContents(SWTPartRenderer.java:59)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.safeCreateGui(PartRenderingEngine.java:635)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.safeCreateGui(PartRenderingEngine.java:725)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.access$2(PartRenderingEngine.java:696)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$7.run(PartRenderingEngine.java:690)
    at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.createGui(PartRenderingEngine.java:675)
    at org.eclipse.e4.ui.workbench.renderers.swt.SWTPartRenderer.processContents(SWTPartRenderer.java:59)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.safeCreateGui(PartRenderingEngine.java:635)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.safeCreateGui(PartRenderingEngine.java:725)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.access$2(PartRenderingEngine.java:696)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$7.run(PartRenderingEngine.java:690)
    at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.createGui(PartRenderingEngine.java:675)
    at org.eclipse.e4.ui.workbench.renderers.swt.SWTPartRenderer.processContents(SWTPartRenderer.java:59)
    at org.eclipse.e4.ui.workbench.renderers.swt.PerspectiveRenderer.processContents(PerspectiveRenderer.java:59)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.safeCreateGui(PartRenderingEngine.java:635)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.safeCreateGui(PartRenderingEngine.java:725)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.access$2(PartRenderingEngine.java:696)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$7.run(PartRenderingEngine.java:690)
    at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.createGui(PartRenderingEngine.java:675)
    at org.eclipse.e4.ui.workbench.renderers.swt.PerspectiveStackRenderer.showTab(PerspectiveStackRenderer.java:103)
    at org.eclipse.e4.ui.workbench.renderers.swt.LazyStackRenderer$1.handleEvent(LazyStackRenderer.java:67)
    at org.eclipse.e4.ui.services.internal.events.UIEventHandler$1.run(UIEventHandler.java:41)
    at org.eclipse.swt.widgets.Synchronizer.syncExec(Synchronizer.java:180)
    at org.eclipse.ui.internal.UISynchronizer.syncExec(UISynchronizer.java:150)
    at org.eclipse.swt.widgets.Display.syncExec(Display.java:4291)
    at org.eclipse.e4.ui.internal.workbench.swt.E4Application$1.syncExec(E4Application.java:187)
    at org.eclipse.e4.ui.services.internal.events.UIEventHandler.handleEvent(UIEventHandler.java:38)
    at org.eclipse.equinox.internal.event.EventHandlerWrapper.handleEvent(EventHandlerWrapper.java:197)
    at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:197)
    at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:1)
    at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230)
    at org.eclipse.osgi.framework.eventmgr.ListenerQueue.dispatchEventSynchronous(ListenerQueue.java:148)
    at org.eclipse.equinox.internal.event.EventAdminImpl.dispatchEvent(EventAdminImpl.java:135)
    at org.eclipse.equinox.internal.event.EventAdminImpl.sendEvent(EventAdminImpl.java:78)
    at org.eclipse.equinox.internal.event.EventComponent.sendEvent(EventComponent.java:39)
    at org.eclipse.e4.ui.services.internal.events.EventBroker.send(EventBroker.java:81)
    at org.eclipse.e4.ui.internal.workbench.UIEventPublisher.notifyChanged(UIEventPublisher.java:57)
    at org.eclipse.emf.common.notify.impl.BasicNotifierImpl.eNotify(BasicNotifierImpl.java:374)
    at org.eclipse.e4.ui.model.application.ui.advanced.impl.PerspectiveStackImpl.setSelectedElement(PerspectiveStackImpl.java:135)
    at org.eclipse.e4.ui.model.application.ui.advanced.impl.PerspectiveStackImpl.setSelectedElement(PerspectiveStackImpl.java:1)
    at org.eclipse.e4.ui.workbench.addons.perspectiveswitcher.PerspectiveSwitcher$13.widgetSelected(PerspectiveSwitcher.java:436)
    at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:248)
    at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)
    at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1276)
    at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3554)
    at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3179)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1022)
    at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:916)
    at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:86)
    at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:585)
    at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
    at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:540)
    at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)
    at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124)
    at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:353)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:180)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:629)
    at org.eclipse.equinox.launcher.Main.basicRun(Main.java:584)
    at org.eclipse.equinox.launcher.Main.run(Main.java:1438)
!SESSION 2012-08-25 14:48:17.623 -----------------------------------------------
eclipse.buildId=I20120608-1400
java.version=1.6.0_34
java.vendor=Sun Microsystems Inc.
BootLoader constants: OS=linux, ARCH=x86, WS=gtk, NL=en_US
Framework arguments:  -product org.eclipse.epp.package.jee.product
Command-line arguments:  -os linux -ws gtk -arch x86 -product org.eclipse.epp.package.jee.product 
```

[我做了几个小时的谷歌搜索，看到](https://stackoverflow.com/questions/9695271/swt-browser-eclipse)了所有不同的解决方案，但它们要么太复杂，我无法弄清楚，要么根本不起作用。

我尝试了以下方法：

1.  编辑 /etc/environment 并添加`MOZILLA_FIVE_HOME=/usr/lib/firefox`，没有效果
2.  编辑 eclipse.desktop 并更改`Exec=/usr/bin/eclipse/eclipse`为`Exec=env MOZILLA_FIVE_HOME=/usr/lib/firefox /usr/bin/eclipse/eclipse`此时 eclipse 将在启动时冻结。
3.  [从这里](http://ftp.mozilla.org/pub/mozilla.org/xulrunner/releases/1.9.2.19/source/)下载 XULRunner-1.9.2.19并将环境`MOZILLA_FIVE_HOME`变量指向我提取它的目录。我收到了一个新错误：

> 条目 org.eclipse.datatools.sqltools.plan 4 0 2012-08-25 14:48:25.509

```
!ENTRY org.eclipse.datatools.sqltools.plan 4 0 2012-08-25 14:48:25.509
!MESSAGE No resource bundle has been set for the LoggerNo more handles [MOZILLA_FIVE_HOME='/usr/lib/mozilla-1.9.2'] (java.lang.UnsatisfiedLinkError: Could not load SWT library. Reasons: 
    /usr/bin/eclipse/configuration/org.eclipse.osgi/bundles/626/2/.cp/libswt-mozilla-gtk-4233.so: libxpcom.so: cannot open shared object file: No such file or directory
    no swt-mozilla-gtk in java.library.path
    Can't load library: /home/simon/.swt/lib/linux/x86/libswt-mozilla-gtk-4233.so
    Can't load library: /home/simon/.swt/lib/linux/x86/libswt-mozilla-gtk.so
    /home/simon/.swt/lib/linux/x86/libswt-mozilla-gtk-4233.so: libxpcom.so: cannot open shared object file: No such file or directory
)".

!ENTRY org.eclipse.datatools.sqltools.plan 4 0 2012-08-25 14:48:25.513
!MESSAGE No more handles [MOZILLA_FIVE_HOME='/usr/lib/mozilla-1.9.2'] (java.lang.UnsatisfiedLinkError: Could not load SWT library. Reasons: 
    /usr/bin/eclipse/configuration/org.eclipse.osgi/bundles/626/2/.cp/libswt-mozilla-gtk-4233.so: libxpcom.so: cannot open shared object file: No such file or directory
    no swt-mozilla-gtk in java.library.path
    Can't load library: /home/simon/.swt/lib/linux/x86/libswt-mozilla-gtk-4233.so
    Can't load library: /home/simon/.swt/lib/linux/x86/libswt-mozilla-gtk.so
    /home/simon/.swt/lib/linux/x86/libswt-mozilla-gtk-4233.so: libxpcom.so: cannot open shared object file: No such file or directory
) possible args: {0}, {1}, {2}, {3}
!STACK 0
org.eclipse.swt.SWTError: No more handles [MOZILLA_FIVE_HOME='/usr/lib/mozilla-1.9.2'] (java.lang.UnsatisfiedLinkError: Could not load SWT library. Reasons: 
    /usr/bin/eclipse/configuration/org.eclipse.osgi/bundles/626/2/.cp/libswt-mozilla-gtk-4233.so: libxpcom.so: cannot open shared object file: No such file or directory
    no swt-mozilla-gtk in java.library.path
    Can't load library: /home/simon/.swt/lib/linux/x86/libswt-mozilla-gtk-4233.so
    Can't load library: /home/simon/.swt/lib/linux/x86/libswt-mozilla-gtk.so
    /home/simon/.swt/lib/linux/x86/libswt-mozilla-gtk-4233.so: libxpcom.so: cannot open shared object file: No such file or directory
)
    at org.eclipse.swt.SWT.error(SWT.java:4387)
    at org.eclipse.swt.browser.Mozilla.initMozilla(Mozilla.java:1970) 
```

...然后是超长的堆栈跟踪

谁能帮我弄清楚如何解决这个问题。谢谢。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-01-02T23:19:54.903

这对我有用：

```
 sudo apt-get install libwebkitgtk-1.0-0 
```

重新启动 Eclipse。不需要其他下载或更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-24T21:28:55.530

如果您尝试从与启动 X 会话的用户不同的用户启动应用程序，也可能会收到此错误。

# c++ - 链接到 Boost 预编译库时获取 LnK1104

> ID：12125049
> 
> 赞同：3
> 
> 时间：2012-08-25T19:36:35.183
> 
> 标签：c++, boost

我已经使用包含的工具构建了 boost，并且最终得到了 stage/lib 文件夹！lib 文件夹包含几个具有以下 anming 模式的库：

libboost_*lib_name*_vc100_mt-gd-1_50.lib

libboost_*lib_name*_vc100_mt-1_50.lib

虽然使用 cl.exe 构建项目，但我得到 lib 的链接器错误 1104，具有以下模式

libboost_*lib_name*_vc100_mt-s-1_50.lib

有任何想法吗 ？？另一方面，如果使用 Visual Studio 10 并在我的 VC++ Direcotries - Library Direcotries 中设置舞台/lib，一切都像魅力一样！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T21:50:28.750

`mt-s`在 lib 名称中表示您的项目使用选项编译以使用多线程和静态链接的 C++ 标准运行时库。看起来您的 Boost 构建未配置为构建此类 lib 版本，因此它丢失了。

# css - CSS :before 添加内容后？

> ID：12125053
> 
> 赞同：1
> 
> 时间：2012-08-25T19:37:08.210
> 
> 标签：css, pseudo-element

看到[这个小提琴。](http://jsfiddle.net/xce56/)

为什么新添加的蓝色 div 会显示在段落上方？不`:before`应该放在后面`p`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T19:46:55.303

似乎没有文档评论 和 的 z 维`:before`位置`:after`。而且，正如@BoltClock 指出的那样，就堆叠而言，它们的行为应该与普通元素（非伪元素）一样。

如果您想在段落本身后面使用它，请尝试`z-index: -1;`在您的段上使用。`:before`（基本小提琴： http: [//jsfiddle.net/fDvTk/](http://jsfiddle.net/fDvTk/)；应用小提琴：http: [//jsfiddle.net/XvYng/](http://jsfiddle.net/XvYng/)）

代码：

```
#example1 p:before{
  /* ... */
  z-index: -1;
}​ 
```

# c++ - C++ 正则表达式字符串捕获

> ID：12125057
> 
> 赞同：5
> 
> 时间：2012-08-25T19:37:29.873
> 
> 标签：c++, regex, visual-studio, boost, g++

使 C++ 正则表达式字符串捕获工作。我已经尝试过 Windows 与 Linux、Boost 与原生 C++ 0x11 的所有四种组合。示例代码是：

```
#include <string>
#include <iostream>
#include <boost/regex.hpp>
//#include <regex>

using namespace std;
using namespace boost;

int main(int argc, char** argv)
{
    smatch sm1;
    regex_search(string("abhelloworld.jpg"), sm1, regex("(.*)jpg"));
    cout << sm1[1] << endl;
    smatch sm2;
    regex_search(string("hell.g"), sm2, regex("(.*)g"));
    cout << sm2[1] << endl;
} 
```

最接近的是 g++ (4.7) 和 Boost (1.51.0)。在那里，第一个 cout 输出预期的`abhelloworld.`结果，但第二个 cout 没有输出。

g++ 4.7 与 -std=gnu++11 而`<regex>`不是不`<boost/regex.hpp>`产生输出。

使用本机的 Visual Studio 2012 会`<regex>`产生关于不兼容字符串迭代器的异常。

带有 Boost 1.51.0 的 Visual Studio 2008 并`<boost/regex.hpp>`产生关于“标准 C++ 库无效参数”的异常。

这些是 C++ 正则表达式中的错误，还是我做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-25T21:12:34.407

> 这些是 C++ 正则表达式中的错误，还是我做错了什么？

在您发布时，gcc 不支持`<regex>`，如另一个答案中所述（[现在](https://stackoverflow.com/a/23476206/111307)支持）。至于其他问题，您的问题是您正在传递**临时字符串对象**。将您的代码更改为以下内容：

```
smatch sm1;
string s1("abhelloworld.jpg");
regex_search(s1, sm1, regex("(.*)jpg"));
cout << sm1[1] << endl;
smatch sm2;
string s2("hell.g");
regex_search(s2, sm2, regex("(.*)g"));
cout << sm2[1] << endl; 
```

您的原始示例可以编译，因为`regex_search`它接受了一个临时对象可以绑定到的 const 引用，但是，`smatch`它只将迭代器存储到您不再存在的临时对象中。解决方案是不通过临时人员。

如果您查看 [§ 28.11.3/5] 中的 C++ 标准，您会发现以下内容：

> 返回： regex_search(s.begin(), s.end(), m, e, flags) 的结果。

这意味着在内部，仅使用传入字符串的*迭代器*，因此如果传入一个临时对象，则将使用该临时对象的迭代器，这些迭代器是无效的，并且实际临时对象本身*不会被存储*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T19:39:50.797

GCC 还不支持`<regex>`。参考[手册](http://gcc.gnu.org/onlinedocs/libstdc++/manual/status.html#status.iso.2011)

# visual-studio - 如何将 SignalR.Client.NET35 安装到项目中

> ID：12125061
> 
> 赞同：1
> 
> 时间：2012-08-25T19:38:07.463
> 
> 标签：visual-studio, nuget, signalr

我正在为我的 .NET 4.5 Web 应用程序使用通过 NuGet 安装的 SignalR 0.5.3 - 现在，由于我需要从 SQL SERVER 2008R2 推送数据（仅支持最高 3.5 的 .NET Framework），我需要创建一个库使用 SignalR .NET 3.5 客户端。

我在[项目网站](https://github.com/SignalR/SignalR)上看到可能有一个 SignalR.Client.NET35 版本，但是（对 github 和 NuGet 都不是很熟悉）我不知道如何为我必须处理的库项目安装该客户端。我尝试使用 std 命令安装，`install-package SignalR.Client`但我得到的消息是：

```
Install-Package : Could not install package 'SignalR.Client 0.5.3'.
You are trying to install this package into a project that targets 
'.NETFramework,Version=v3.5', but the package does not contain any assembly 
references that are compatible with that framework. 
For more information, contact the package author. 
```

所以看起来正确的.NET版本没有正确/开箱即用。

在打扰作者之前，我想在这里尝试一下。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T08:55:00.947

我们还没有将 3.5 客户端打包到包中。您需要从源代码构建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-07T03:32:11.360

我将 v1.x 和 v2.x SignalR 客户端反向移植到 NET 3.5。在此处作为 NuGet 包提供：[http ://www.nuget.org/packages/Nivot.SignalR.Client.Net35/](http://www.nuget.org/packages/Nivot.SignalR.Client.Net35/)

# html - 插入维图像...”在优化的上下文中是什么意思？

> ID：12125063
> 
> 赞同：0
> 
> 时间：2012-08-25T19:38:47.953
> 
> 标签：html, css

我不知道为什么我得到评论“插入维度图像......” [当我检查网站的加载时间时](http://gtmetrix.com/) ，我得到了它，但我仍然得到这个评论。我很想帮助如何正确地做到这一点。

重要的是要注意页面已经过验证 - WC3HTML 4.01 + WC3SCC。

[http://www.class-a-studio.co.il/gallery.php](http://www.class-a-studio.co.il/gallery.php)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T00:42:00.993

博克电视！这意味着 GTmetrix 建议您在 HTML 或 CSS 中指定图像或占位符的尺寸（宽度/高度），以便查看者的浏览器可以在布局中保留其空间并继续构建 DOM，即使图像仍然需要时间下载。或者，您指定了尺寸，但提供的图像太大，因此查看者的浏览器必须按比例缩小它们。这两个问题都会影响网站的性能。

# java - 从位于 jdk1.7.0_06 的 Eclipse 中的 JAVA DB 中检索数据

> ID：12125065
> 
> 赞同：1
> 
> 时间：2012-08-25T19:38:54.440
> 
> 标签：java, database, jdbc

我正在尝试检索安装在 jdk1.7.0_06 中的数据库服务器 JAVA DB 上的数据。我能够连接到服务器并创建数据库。但是我在编译和运行时遇到以下错误：

```
No suitable driver found for jdbc:derby:AddressBook 
```

请你帮帮我！谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T21:33:39.063

我说：“我想知道您是否需要`derby.system.home`按照 Java DB 教程的建议设置属性。您尝试过吗？例如，`System.setProperty("derby.system.home", DERBY_HOME_PATH);`第二个参数是数据库主目录的路径。”

而你回复：

> @HovercraftFullOfEels，我想我没有，但我确信我已经通过命令行设置了一些可变变量。

@Dorji：这并没有在你的JVM中设置系统属性。我仍然认为您需要在使用数据库之前设置此属性。例如，

```
public class Test {
   public static final String DERBY_HOME = "derby.system.home";

   // ***** the two Strings below will be different for you *****
   public static final String DERBY_HOME_PATH = "D:/DerbyDB";
   private static final String DB_NAME = "sample";

   public static void main(String[] args) {
      System.setProperty(DERBY_HOME, DERBY_HOME_PATH);
      Connection conn = null;
      try {
         Class.forName("org.apache.derby.jdbc.EmbeddedDriver").newInstance();
         conn = DriverManager.getConnection("jdbc:derby:" + DB_NAME);

      } catch (InstantiationException | IllegalAccessException
            | ClassNotFoundException | SQLException e) {
         e.printStackTrace();
      } finally {
         if (conn == null) {
            System.exit(-1);
         }
      }

      // .... etc... 
```

我的 derby.system.home 目录是 D/:DerbyDB，我的数据库位于 D/:DerbyDB/sample 目录中：

![在此处输入图像描述](../Images/f9ed938c1285aacf570a16e1fd66d48b.png)

这对你来说当然会有所不同。

# c++ - RegQueryValueEx REG_SZ [C++]

> ID：12125069
> 
> 赞同：0
> 
> 时间：2012-08-25T19:39:18.837
> 
> 标签：c++, windows, registry

从注册表接收数据的变量应该具有哪种数据类型？

```
HKEY hKey;
HKEY hKey2;

DWORD dwMHz = MAX_PATH;
string pName;

long lError = RegOpenKeyEx(HKEY_LOCAL_MACHINE,
        "HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0",
        0,
        KEY_READ,
        &hKey);
long lError2 = RegOpenKeyEx(HKEY_LOCAL_MACHINE,
        "HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0",
        0,
        KEY_READ,
        &hKey2);

// Working
RegQueryValueEx(hKey, "~MHz", NULL, NULL, (LPBYTE) &dwMHz, &BufSize);

//Not working                                            <-- THIS -->
RegQueryValueEx(hKey2, "ProcessorNameInfo", NULL, NULL, (LPBYTE) &pName, &BufSize2);

cout << "   Processor frequency: " << dwMHz / 1024 << " GHz" << endl;
cout << "   Processor Name: " << pName << endl;

RegCloseKey(hKey);
RegCloseKey(hKey2); 
```

当我尝试打印“pName”时，我什么也没得到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T20:00:31.427

a您需要将此数据读入类型为 的数组`TCHAR`，这取决于您的应用程序的构建方式（UNICODE/MBCS）将正确键入为`char`或`wchar_t`。

使用此 API 读取 REG_SZ 字符串时，您需要确保两件事。

1) 您的输出缓冲区需要为任何尾随 NULL 终止符留出空间 2) 成功后，您的输出缓冲区可能不会被 NULL 终止。

最后一点很重要 - 如果字符串没有使用 NULL 终止符存储，那么您的输出缓冲区也不会。您需要注意这一点并正确处理，以免最终在应用程序中出现安全漏洞。

# winforms - DevExpress MemoEdit 选择背景色

> ID：12125072
> 
> 赞同：0
> 
> 时间：2012-08-25T19:39:37.243
> 
> 标签：winforms, devexpress, background-color

我正在尝试实现与`RichTextBox`使用`MemoEdit`控件时类似的功能。

`RichTextBox`可以使用以`.Select()`选择部分文本，然后使用`.SelectionBackColor()`以仅更改所选文本的背景色，而其余文本仍具有相同的颜色。遗憾的是，我无法实现这一点，因为`MemoEdit`控件似乎没有任何类似的方法可以实现这一点。

任何人都设法得到任何类似的工作`MemoEdit`或有一个很好的选择（允许控件仍然能够使用表单皮肤）？

提前致谢。

# java - Java - 反序列化 InvalidClassException（没有有效的构造函数）

> ID：12125076
> 
> 赞同：16
> 
> 时间：2012-08-25T19:40:02.410
> 
> 标签：java, serialization, deserialization

我正在尝试序列化一个对象，然后在将其数据发送到客户端程序后对其进行反序列化。

这是对象继承如何工作的示例。我正在序列化和反序列化的对象是人。

生活 -> 动物 -> NPC -> 人 -> 儿童

Living、Animal 和 NPC 不实现 Serializable。我不能改变这三个类。Person 和 Child 确实实现了 Serializable。Person 和 Living 也是抽象类。我可以很好地序列化一个人（他是一个孩子）并发送它，但是当我尝试反序列化一个人（他是一个孩子）时，我在 Child 上得到一个 InvalidClassException，说“没有有效的构造函数”。

为什么会这样？Living、Animal 和 NPC 都必须实现 Serializable 吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-25T19:50:54.970

[下面的问题Deserializing an ArrayList](https://stackoverflow.com/questions/12067405/deserializing-an-arraylist-no-valid-constructor)的答案中做了很好的解释 。[没有有效的构造函数](https://stackoverflow.com/questions/12067405/deserializing-an-arraylist-no-valid-constructor)

长话短说-`NPC`在您的情况下，您的类的第一个不可序列化的超类需要无参数构造函数。

如果您无权访问 NPC 并且它不包含无参数构造函数 - 那么您可以在层次结构中再添加一个“假”类，该类将选择正确的类。例如

```
class SomeClass extends NPC {
// will be called during deserialization
public SomeClass(){
// call custom constructor of NPC
super(null);
}
}

class Person extends SomeClass implements Serializable {
// ..
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T19:56:11.597

根据[这个线程](http://www.jguru.com/faq/view.jsp?EID=251942)，它们不需要实现可序列化，但它们（或至少 NPC，因为它是层次结构中的第一个不可序列化类）必须包含一个 0 参数构造函数。如果类中没有定义构造函数，则隐式构造函数就足够了，但如果在这些类中定义了其他构造函数，则必须编写显式的 0 参数构造函数。

由于您无法控制 NPC，因此请尝试创建定义显式 0 参数构造函数但不实现 Serializable 的它的子代，并查看是否不这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-16T18:40:30.040

[我在Hazelcast](http://hazelcast.com/)的序列化中遇到了同样的问题，但是通过使用自定义序列化解决了这个问题，而无需借助中间类。我向 Animal 类添加了一个空的无参数构造函数，并实现了 Person 类，如下所示：

```
class Person extends Animal implements Serializable {

    private void writeObject(ObjectOutputStream o) throws IOException {
        o.writeObject(this.fieldA);
        o.writeObject(this.fieldB);
        o.writeObject(this.fieldC);
        ...
    }

    private void readObject(ObjectInputStream o) throws IOException, ClassNotFoundException {
        this.fieldA = (TypeOfA) o.readObject();
        this.fieldB = (TypeOfB) o.readObject();
        this.fieldC = (TypeOfC) o.readObject();
        ...
    }
} 
```

# c# - 滚动到虚拟化 ItemsControl 的元素

> ID：12125078
> 
> 赞同：11
> 
> 时间：2012-08-25T19:40:11.780
> 
> 标签：c#, wpf, itemscontrol, virtualizingstackpanel

我有一个`ItemsControl`在 a 中显示它的项目`ScrollViewer`，并进行虚拟化。我正在尝试将其滚动`ScrollViewer`到它包含的（屏幕外，因此是虚拟的）项目。但是，由于该项目是虚拟化的，因此它实际上并不存在于屏幕上并且没有位置 (IIUC)。

我已经尝试`BringIntoView`过子元素，但它不会滚动到视图中。我也尝试使用`TransformToAncestor`,`TransformBounds`和手动执行此操作`ScrollToVerticalOffset`，但`TransformToAncestor`永远不会返回（我猜也是因为虚拟化，因为它没有位置，但我没有证据）并且它永远不会执行之后的代码。

是否可以通过虚拟化滚动到项目`ItemsControl`？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-28T04:11:21.460

我一直在寻找一个带有 VirtualizingStackPanel 的 ItemsControl 来滚动到一个项目一段时间，并一直在寻找“使用 ListBox”的答案。我不想，所以我找到了一种方法。首先，您需要为您的 ItemsControl 设置一个控件模板，其中包含一个 ScrollViewer（如果您正在使用项目控件，您可能已经拥有该模板）。我的基本模板如下所示（包含在 ItemsControl 的方便样式中）

```
<Style x:Key="TheItemsControlStyle" TargetType="{x:Type ItemsControl}">
    <Setter Property="Template">
    <Setter.Value>
            <ControlTemplate TargetType="{x:Type ItemsControl}">
                <Border BorderThickness="{TemplateBinding Border.BorderThickness}" Padding="{TemplateBinding Control.Padding}" BorderBrush="{TemplateBinding Border.BorderBrush}" Background="{TemplateBinding Panel.Background}" SnapsToDevicePixels="True">
                    <ScrollViewer Padding="{TemplateBinding Control.Padding}" Focusable="False" HorizontalScrollBarVisibility="Auto">
                        <ItemsPresenter SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" />
                    </ScrollViewer>
                </Border>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

所以我基本上有一个带有滚动查看器的边框，它将包含我的内容。
我的 ItemsControl 定义为：

```
<ItemsControl x:Name="myItemsControl" [..snip..] Style="{DynamicResource TheItemsControlStyle}"  ScrollViewer.CanContentScroll="True" VirtualizingStackPanel.IsVirtualizing="True"> 
```

好的，现在是有趣的部分。我创建了一个扩展方法来附加到任何 ItemsControl 以使其滚动到给定项目：

```
public static void VirtualizedScrollIntoView(this ItemsControl control, object item) {
        try {
            // this is basically getting a reference to the ScrollViewer defined in the ItemsControl's style (identified above).
            // you *could* enumerate over the ItemsControl's children until you hit a scroll viewer, but this is quick and
            // dirty!
            // First 0 in the GetChild returns the Border from the ControlTemplate, and the second 0 gets the ScrollViewer from
            // the Border.
            ScrollViewer sv = VisualTreeHelper.GetChild(VisualTreeHelper.GetChild((DependencyObject)control, 0), 0) as ScrollViewer;
            // now get the index of the item your passing in
            int index = control.Items.IndexOf(item);
            if(index != -1) {
                // since the scroll viewer is using content scrolling not pixel based scrolling we just tell it to scroll to the index of the item
                // and viola!  we scroll there!
                sv.ScrollToVerticalOffset(index);
            }
        } catch(Exception ex) {
            Debug.WriteLine("What the..." + ex.Message);
        }
    } 
```

因此，使用适当的扩展方法，您可以像使用 ListBox 的伴随方法一样使用它：

```
myItemsControl.VirtualizedScrollIntoView(someItemInTheList); 
```

效果很好！

请注意，您还可以调用 sv.ScrollToEnd() 和其他常用的滚动方法来绕过您的项目。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-25T20:59:41.167

在 .NET 源代码中四处寻找让我向您推荐使用 a`ListBox`及其[`ScrollIntoView`](http://msdn.microsoft.com/en-us/library/system.windows.controls.listbox.scrollintoview.aspx)方法。此方法的实现依赖于一些`internal`方法`VirtualizingPanel.BringIndexIntoView`，例如强制在该索引处创建项目并滚动到它。许多这些机制是内部机制的事实意味着，如果你试图自己做这件事，*你会度过一段糟糕的时光*。

（要使这带来的选择不可见，您可以重新模板`ListBoxItems`）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-11-27T20:58:38.890

我知道这是一个旧线程，但如果其他人（比如我）遇到它，我认为值得我刚刚发现的更新答案。

从 .NET Framework 4.5 开始，`VirtualizingPanel`有一个像魅力一样工作的公共`BringIndexIntoViewPublic`方法，包括基于像素的滚动。您必须对 your 进行子类化`ItemsControl`，或者使用`VisualTreeHelper`来找到它的 child `VirtualizingPanel`，但无论哪种方式，现在都很容易强制您`ItemsControl`精确滚动到特定的项目/索引。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-04-18T20:48:30.843

使用@AaronCook 示例，创建了一个适用于我的 VirtualizingItemsControl 的行为。这是代码：

```
public class ItemsControlScrollToSelectedBehavior : Behavior<ItemsControl>
{
    public static readonly DependencyProperty SelectedItemProperty =
        DependencyProperty.Register("SelectedItem", typeof(object), typeof(ItemsControlScrollToSelectedBehavior),
            new FrameworkPropertyMetadata(null,
                new PropertyChangedCallback(OnSelectedItemsChanged)));

    public object SelectedItem
    {
        get => GetValue(SelectedItemProperty);
        set => SetValue(SelectedItemProperty, value);
    }

    private static void OnSelectedItemsChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        ItemsControlScrollToSelectedBehavior target = (ItemsControlScrollToSelectedBehavior)d;
        object oldSelectedItems = e.OldValue;
        object newSelectedItems = target.SelectedItem;
        target.OnSelectedItemsChanged(oldSelectedItems, newSelectedItems);
    }

    protected virtual void OnSelectedItemsChanged(object oldSelectedItems, object newSelectedItems)
    {
        try
        {
            var sv = VisualTreeHelper.GetChild(VisualTreeHelper.GetChild(AssociatedObject, 0), 0) as ScrollViewer;
            // now get the index of the item your passing in
            int index = AssociatedObject.Items.IndexOf(newSelectedItems);
            if (index != -1)
            {
                sv?.ScrollToVerticalOffset(index);
            }
        }
        catch
        {
            // Ignore
        }
    }
} 
```

用法是：

```
<ItemsControl Style="{StaticResource VirtualizingItemsControl}"                      
                  ItemsSource="{Binding BoundItems}">
        <i:Interaction.Behaviors>
            <behaviors:ItemsControlScrollToSelectedBehavior SelectedItem="{Binding SelectedItem}" />
        </i:Interaction.Behaviors>
    </ItemsControl> 
```

对于喜欢行为和干净 XAML 的人很有帮助，没有代码隐藏。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-03-17T18:53:22.407

我知道我参加聚会已经很晚了，但希望这可以帮助其他人一起寻找解决方案......

```
int index = myItemsControl.Items.IndexOf(*your item*).FirstOrDefault();
int rowHeight = *height of your rows*;
myScrollView.ScrollToVerticalOffset(index*rowHeight);
//this will bring the given item to the top of the scrollViewer window 
```

...我的 XAML 是这样设置的...

```
<ScrollViewer x:Name="myScrollView">
    <ItemsControl x:Name="myItemsControl">
        <ItemsControl.ItemTemplate>
            <DataTemplate>
                <Grid>
                    <!-- data here -->
                </Grid>
            </DataTemplate>
        </ItemsControl.ItemTemplate>
    </ItemsControl>
</ScrollViewer> 
```

# javascript - Phonegap - 使用数据库中的值更改 youtube 嵌入链接

> ID：12125080
> 
> 赞同：1
> 
> 时间：2012-08-25T19:40:20.667
> 
> 标签：javascript, mysql, html, cordova, youtube

我试图在我的 phonegap 项目中实现一个 youtube 嵌入视频。如果将 iframe 插入任何页面，iframe 工作正常，我希望从我的 mysql 数据库中加载这些视频。我希望视频出现在这个结构中：

```
 <div data-role="collapsible-set" id="gameVideo" data-theme="" data-content-theme="">
                                      <div data-role="collapsible" data-collapsed="true">
                                          <h3>
                                              Trailer
                                          </h3>
                                       <iframe width="300" height="169" src="http://www.youtube.com/embed/Jx3vb_AC0ZQ" frameborder="0" allowfullscreen></iframe>
                                      </div> 
```

我需要替换的只是 iframe 部分以从数据库中加载数据。到目前为止，这是我加载数据的 javascript：

```
 function displayGame(data) {
game = data.item;
console.log(game);
$('#gamePic').attr('src', '' + game.Image);
$('#gameTitle').text(game.Title);
$('#gamePrice').text(game.Price);
$('#gameFormat').text(game.Format);
$('#gameStock').text(game.Stock);
$('#gameDesc').text(game.Description);
$('#gameVideo').attr('src', '' + game.Video);
$('#actionList').listview('refresh'); 
```

}

有任何想法吗？

# cakephp - Cakephp with Rackspace cloud database

> ID：12125081
> 
> 赞同：0
> 
> 时间：2012-08-25T19:40:21.603
> 
> 标签：cakephp, cakephp-2.1, rackspace-cloud, rackspace

I'm thinking about moving one of my clients mysql db to Rackspace could databases. Application is using Cakephp.. I would like to know if someone has experience doing so or will this work just by editing host/user/pass in the database.php file?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T00:20:14.493

I havn't done so but Rackspace has a tutorial about doing so :

[http://www.rackspace.com/knowledge_center/article/installing-cakephp-on-cloud-sites](http://www.rackspace.com/knowledge_center/article/installing-cakephp-on-cloud-sites)

It seems pretty simple, so you should not have any problems

> # Steps for cake
> 
> 1.  Locate the .htaccess file in the content directory. After "RewriteEngine on", add a new line with "RewriteBase /" to the .htaccess file and save the file back to the site. You will need to repeat this step for the rewrite rules in the .htaccess files in the app and app/webroot directories.
> 2.  Load the site in your browser. You will notice several warnings concerning the installation. The first warning will be the following: Notice (1024): Please change the value of Security.salt in app/config/core.php to a salt value specific to your application [CORE/cake/libs/debugger.php, line 556].
> 3.  Open app/config/core.php file and search for Security.salt. Change its value to whatever characters or string you would like, then save and close the file.
> 4.  In the app/config/directory in FTP, rename the database.php.default file to be database.php.
> 5.  Open app/config/database.php and scroll down to the bottom of the page to find the database connection information. Enter your database host name, user name, password and hostname, then save and close the file.
> 6.  Reload your site in your browser.

# ruby-on-rails - 使用 ajax on rails 更新计数

> ID：12125090
> 
> 赞同：0
> 
> 时间：2012-08-25T19:41:56.233
> 
> 标签：ruby-on-rails, ruby, ajax, dynamic, vote

目前我在我的页面上静态显示投票计数，但我想找到一种方法来动态更新计数，这样当我单击投票按钮时，它就不必刷新页面来更改计数。

这是我认为投票按钮的代码

_post.html.erb

```
 <%= form_for(@vote, :remote => true) do |f| %>
     <%= f.hidden_field "post_id", :value => post.id %>
     <%= f.hidden_field "user_id", :value => current_user.id %>
     <%= image_submit_tag "arrow.png" %> 
  <% end %> 
```

这是我认为如何呈现计数的代码

_post.html.erb

我正在使用 jquery，我试图寻找一种更新计数的方法，但没有找到太多信息。感谢您的帮助，我很感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T20:01:23.137

检查这个 railscasts [http://railscasts.com/episodes/205-unobtrusive-javascript](http://railscasts.com/episodes/205-unobtrusive-javascript)

您将简要了解如何通过 ajax 更新数据。

# delphi - ShellExecute 从流而不是文件打印

> ID：12125091
> 
> 赞同：2
> 
> 时间：2012-08-25T19:42:04.097
> 
> 标签：delphi, delphi-xe2

有了这个

```
ShellExecute(Handle, 'print', PChar(ExtractFilePath(ParamStr(0))+'Test.txt'), 
   nil, nil, SW_HIDE); 
```

可以打印文件。

有没有办法可以使用 a`TStream`而不是文件，以便我可以直接从我的流中打印？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T19:45:17.800

不，您不能用于`ShellExecute`从 Delphi 流中打印。调用`ShellExecute`将导致执行打印操作的不同进程。而那个不同的进程看不到你的 Delphi 流。

有几个选项浮现在脑海中：

1.  将流保存到临时文件，并使用`ShellExecute`.
2.  直接从 Delphi 打印文本。一种快速而肮脏的方法是将文本添加到 a`TRichEdit`并调用其[`Print`](http://docwiki.embarcadero.com/Libraries/XE2/en/Vcl.ComCtrls.TCustomRichEdit.Print)方法。Andreas Rejbrand[在这里](https://stackoverflow.com/questions/6809478/help-needed-about-printing-text-file-with-delphi/6810708#6810708)有更多细节。

# css - 子 div 相对于父 div 的边距

> ID：12125092
> 
> 赞同：2
> 
> 时间：2012-08-25T19:42:06.293
> 
> 标签：css, html

我有一个简单的子 div 嵌套在父 div 中，就像这样......

我试图理解为什么我不能通过使用 margin-top: 25px 将子 div 相对于父 div 向下移动（例如 25px），除非我给父 div 一个边框。我在想子 div 使用边框作为参考点，这就是为什么在应用边框后 margin-top 实际上起作用的原因。这一切都很好而且很花哨，但是在我正在处理的具体示例中，父 div 有一个背景图像，我不想给它一个边框。但是没有边框，子 div 不会移动！

```
<body>

  <div id="main">

      <div id="child">
      </div>

 </div> 

</body

#main {width: 500px;
   border: 1px solid black;
   height: 500px;
   background-color: red;
   margin: auto;
   margin-top: 200px;
   }

#child {width: 100px;
    height: 100px;
    background: blue;
    position: relative;
    top: 5px;
   } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-25T19:45:03.713

几天前我遇到了这个问题，我通过向父 div 添加一个小填充 (1px) 来解决它，然后在子 div 上使用边距。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-25T19:53:01.683

您应该将`display:inline-block;`财产分配给子 div。

# c# - 使通用对象实例化更通用

> ID：12125101
> 
> 赞同：2
> 
> 时间：2012-08-25T19:43:20.613
> 
> 标签：c#, c#-4.0, generics

我有这段代码可以以通用方式创建新对象：

```
var user = User.Create<User>(c => c.Name = "321X"); 
```

我不喜欢它的事实是我需要为每个创建调用传递“通用符号”<T>。毕竟我创建了一个我已经提到过的对象......

当前功能背后的代码是：

```
public class User : CreateBase
{
    public string Name { get; set; }
}

public abstract class CreateBase
{
    public DateTime CreateDate { get; set; }
    public Guid Guid { get; set; }

    public static T Create<T>(Action<T> init) where T : CreateBase, new()
    {
        T obj = new T();
        obj.Guid = Guid.NewGuid();
        obj.DateTime = DateTime.Now;
        init(obj);
        return obj;
    }
} 
```

是否有可能（**以及如何**）将我的代码重构为此，创建一个对象？

```
var user = User.Create(c => c.Name = "321X"); 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T19:49:51.217

在类级别定义通用参数：

```
public abstract class CreateBase<T> where T : CreateBase<T> , new()
{
    public static T Create(Action<T> init) 
    {
        //...
    }
}

public class User : CreateBase<User>
{
    public string Name { get; set; }
} 
```

然后你可以写`var user = User.Create(c => c.Name = "321X");`

否则编译器无法在`Create`不指定类型参数的情况下推断您的方法的类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T19:50:32.503

你不是很远。试试这个修改：

```
 public abstract class CreateBase<T> where T : CreateBase<T> , new()
  {
    public DateTime CreateDate { get; set; }
    public Guid Guid { get; set; }

    public static T Create(Action<T> init)
    {
      T obj = new T();
      obj.Guid = Guid.NewGuid();
      obj.CreateDate = DateTime.Now;
      init(obj);
      return obj;
    }
  }

  public class User : CreateBase<User>
  {
    public string Name { get; set; }
  } 
```

**编辑**：在我的本地环境中测试*后*更新了代码。现在可以了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-25T19:50:27.197

更好的方法是将此功能包含在基类的构造函数中（我称之为 ModelBase）

```
public abstract class ModelBase
{
    public DateTime CreateDate { get; private set; }
    public Guid Guid { get; private set; }

    public ModelBase()
    {
        Guid = Guid.NewGuid();
        DateTime = DateTime.Now;
    }
}

public User : ModelBase
{
    public User()
        : base()
    {
    }

    public User(string name)
        : base()
    {
        Name = name
    }

    public string Name { get; set; } 
} 
```

以标准方式创建用户将自动初始化 Guid 和日期

```
var user = new User { Name = "xy }; 
```

* * *

**编辑**

我添加了第二个带有名称参数的构造函数。我要强制初始化名称，删除第一个无参数构造函数。

```
var user = new User("xy"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-25T19:51:35.520

你做错了。与其摆脱一般论点，不如摆脱（不必要地）说`User.`。反而：

```
CreateBase.Create<User>(...) 
```

不再裁员。

除此之外，通过派生类调用基类的静态成员是一种反模式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-25T19:50:09.000

如果您**真的**对那个语法感到不舒服（老实说，我在这里没有看到太多问题）

您可以执行以下操作：

```
public class User : CreateBase
{
    public string Name { get; set; }

    public static User Create(Action<User> a)
    {
        return Create<User>(a); //CALL BASE CLASS GENERIC FUNCTION
    }
} 
```

在你可以用你想要的方式调用它之后：

`var user = User.Create(c => c.Name = "321X");`

# javascript - 骨干.js + google.maps api v3 + overlayview = 使用骨干进行原型设计

> ID：12125106
> 
> 赞同：1
> 
> 时间：2012-08-25T19:44:13.620
> 
> 标签：javascript, google-maps, google-maps-api-3, backbone.js

我读了：

[将 Google 地图自定义叠加层与主干视图混合](https://stackoverflow.com/questions/9102762/mixing-google-maps-custom-overlays-with-backbone-views)

并尝试实现和玩弄它，因为我需要使用自定义叠加层作为视图，并且我已经使用了主干.js

```
var Label = function(){
        Backbone.View.apply(this, arguments);
        this.newInit();
    };

    Label.extend = Backbone.View.extend;

    _.extend(Label.prototype, Backbone.View.prototype, google.maps.OverlayView.prototype,{
        newInit: function(){
         this.setMap(this.options.map);
        },
        onAdd: function(){...},
        onRemove: function(){...},
        draw: function(){...}
    });

    var label_view = new LabelView({map: map});
    label_view.bindTo('some_event', {name: 'some_event_occured'}); 
```

从我的测试来看，“draw”方法没有被调用，尽管它应该覆盖它。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T17:59:05.913

找到了解决方案：

```
var Label = function(){
        Backbone.View.apply(this, arguments);
        google.maps.OverlayView.apply(this, arguments);
    }; 
```

而不是

```
newInit: function(){ 
```

利用：

```
initialize: function(options){ 
```

希望这可以帮助

# php - 类似于 Campaign Monitor 的电子邮件模板编辑器

> ID：12125107
> 
> 赞同：3
> 
> 时间：2012-08-25T19:44:39.430
> 
> 标签：php, email, templates, editor

我需要做一个与 Campaign Monitor 类似的电子邮件模板编辑器 (http://www.campaignmonitor.com/templates/)。我尝试了很多所见即所得的编辑器，但它不能按我的意愿工作。

你知道使用了哪些技术吗？我不知道如何做一个面板来编辑右侧的内容。

如果你有一些技巧、好的资源、文章，我会很高兴的！

先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T13:21:04.617

我自己一直在研究这个问题，因为我们的 CMS 正在重建，需要更好的所见即所得编辑器。他们使用经过大量修改的 CKEditor [http://www.ckeditor.com](http://www.ckeditor.com)

CKEditor 有一个 beta 版本 4，它将支持内联编辑（我们需要的东西），所以我会密切关注这个。演示位于[http://nightly-v4.ckeditor.com/3466/samples/](http://nightly-v4.ckeditor.com/3466/samples/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-19T09:45:31.537

他们的技术是专有的。在过去的几年里，每个 ESP 都创建了自己的此类编辑器。

**Mosaico Editor**是此类中的第一个开源**电子邮件模板构建器。**

[您可以在http://mosaico.io](http://mosaico.io)找到免费使用的部署（也可以作为现场演示），您可以在[https://github.com/voidlabs/mosaico](https://github.com/voidlabs/mosaico)获取资源

**您可以从“主模板**”定义的集合中选择块，然后填充内容并以**所见即所得**样式更改其样式。如果您在大窗口上，您还可以实时预览移动版本。

主模板定义了块是什么，您可以编辑什么以及您可以设置什么样式，并且它包含任何 html 技巧以使其与大多数客户端兼容：这意味着您可以通过简单地编写一个新的主模板来改变编辑器的行为。

[![电子邮件模板生成器屏幕截图](../Images/1402877478acd7326eae14626671586d.png)](https://i.stack.imgur.com/3xw7g.png) 它是 99% 的 javascript（IE10+ 和任何其他现代浏览器），并且仅依赖于服务器端函数来执行“最终内联”和“图像上传/调整大小”

# hive - 为什么增加实例数不会提高 Hive 查询速度

> ID：12125115
> 
> 赞同：0
> 
> 时间：2012-08-25T19:46:34.230
> 
> 标签：hive, elastic-map-reduce, amazon-emr, emr

我在 Amazon 的 Elastic MapReduce 中使用 Hive 创建了一个表，将数据导入其中并对其进行分区。现在我运行一个查询来计算表字段之一中最常见的单词。

当我有 1 个主实例和 2 个核心实例并且计算需要 180 秒时，我运行该查询。然后我将它重新配置为拥有 1 个主控和 10 个核心，它也需要 180 秒。为什么不更快？

在 2 核和 10 核上运行时，我的输出几乎相同：

```
Total MapReduce jobs = 2
Launching Job 1 out of 2

Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201208251929_0003, Tracking URL = http://ip-10-120-250-34.ec2.internal:9100/jobdetails.    jsp?jobid=job_201208251929_0003
Kill Command = /home/hadoop/bin/hadoop job  -Dmapred.job.tracker=10.120.250.34:9001 -kill     job_201208251929_0003
Hadoop job information for Stage-1: number of mappers: 2; number of reducers: 1
2012-08-25 19:38:47,399 Stage-1 map = 0%,  reduce = 0%
2012-08-25 19:39:00,482 Stage-1 map = 3%,  reduce = 0%
2012-08-25 19:39:03,503 Stage-1 map = 5%,  reduce = 0%
2012-08-25 19:39:06,523 Stage-1 map = 10%,  reduce = 0%
2012-08-25 19:39:09,544 Stage-1 map = 18%,  reduce = 0%
2012-08-25 19:39:12,563 Stage-1 map = 24%,  reduce = 0%
2012-08-25 19:39:15,583 Stage-1 map = 35%,  reduce = 0%
2012-08-25 19:39:18,610 Stage-1 map = 45%,  reduce = 0%
2012-08-25 19:39:21,631 Stage-1 map = 53%,  reduce = 0%
2012-08-25 19:39:24,652 Stage-1 map = 67%,  reduce = 0%
2012-08-25 19:39:27,672 Stage-1 map = 75%,  reduce = 0%
2012-08-25 19:39:30,692 Stage-1 map = 89%,  reduce = 0%
2012-08-25 19:39:33,715 Stage-1 map = 94%,  reduce = 0%, Cumulative CPU 23.11 sec
2012-08-25 19:39:34,723 Stage-1 map = 94%,  reduce = 0%, Cumulative CPU 23.11 sec
2012-08-25 19:39:35,730 Stage-1 map = 94%,  reduce = 0%, Cumulative CPU 23.11 sec
2012-08-25 19:39:36,802 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 62.57 sec
2012-08-25 19:39:37,810 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 62.57 sec
2012-08-25 19:39:38,819 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 62.57 sec
2012-08-25 19:39:39,827 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 62.57 sec
2012-08-25 19:39:40,835 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 62.57 sec
2012-08-25 19:39:41,845 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 62.57 sec
2012-08-25 19:39:42,856 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 62.57 sec
2012-08-25 19:39:43,865 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 62.57 sec
2012-08-25 19:39:44,873 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 62.57 sec
2012-08-25 19:39:45,882 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 62.57 sec
2012-08-25 19:39:46,891 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 62.57 sec
2012-08-25 19:39:47,900 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 62.57 sec
2012-08-25 19:39:48,908 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 62.57 sec
2012-08-25 19:39:49,916 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 62.57 sec
2012-08-25 19:39:50,924 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 62.57 sec
2012-08-25 19:39:51,934 Stage-1 map = 100%,  reduce = 67%, Cumulative CPU 62.57 sec
2012-08-25 19:39:52,942 Stage-1 map = 100%,  reduce = 67%, Cumulative CPU 62.57 sec
2012-08-25 19:39:53,950 Stage-1 map = 100%,  reduce = 67%, Cumulative CPU 62.57 sec
2012-08-25 19:39:54,958 Stage-1 map = 100%,  reduce = 72%, Cumulative CPU 62.57 sec
2012-08-25 19:39:55,967 Stage-1 map = 100%,  reduce = 72%, Cumulative CPU 62.57 sec
2012-08-25 19:39:56,976 Stage-1 map = 100%,  reduce = 72%, Cumulative CPU 62.57 sec
2012-08-25 19:39:57,990 Stage-1 map = 100%,  reduce = 90%, Cumulative CPU 62.57 sec
2012-08-25 19:39:59,001 Stage-1 map = 100%,  reduce = 90%, Cumulative CPU 62.57 sec
2012-08-25 19:40:00,011 Stage-1 map = 100%,  reduce = 90%, Cumulative CPU 62.57 sec
2012-08-25 19:40:01,022 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 72.86 sec
2012-08-25 19:40:02,031 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 72.86 sec
2012-08-25 19:40:03,041 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 72.86 sec
2012-08-25 19:40:04,051 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 72.86 sec
2012-08-25 19:40:05,060 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 72.86 sec
2012-08-25 19:40:06,070 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 72.86 sec
2012-08-25 19:40:07,079 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 72.86 sec
MapReduce Total cumulative CPU time: 1 minutes 12 seconds 860 msec
Ended Job = job_201208251929_0003
Counters:
Launching Job 2 out of 2
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201208251929_0004, Tracking URL = http://ip-10-120-250-34.ec2.internal:9100/jobdetails.    jsp?jobid=job_201208251929_0004
Kill Command = /home/hadoop/bin/hadoop job  -Dmapred.job.tracker=10.120.250.34:9001 -kill     job_201208251929_0004
Hadoop job information for Stage-2: number of mappers: 1; number of reducers: 1
2012-08-25 19:40:30,147 Stage-2 map = 0%,  reduce = 0%
2012-08-25 19:40:43,241 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 7.48 sec
2012-08-25 19:40:44,254 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 7.48 sec
2012-08-25 19:40:45,262 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 7.48 sec
2012-08-25 19:40:46,272 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 7.48 sec
2012-08-25 19:40:47,282 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 7.48 sec
2012-08-25 19:40:48,290 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 7.48 sec
2012-08-25 19:40:49,298 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 7.48 sec
2012-08-25 19:40:50,306 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 7.48 sec
2012-08-25 19:40:51,315 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 7.48 sec
2012-08-25 19:40:52,323 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 7.48 sec
2012-08-25 19:40:53,331 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 7.48 sec
2012-08-25 19:40:54,339 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 7.48 sec
2012-08-25 19:40:55,347 Stage-2 map = 100%,  reduce = 33%, Cumulative CPU 7.48 sec
2012-08-25 19:40:56,357 Stage-2 map = 100%,  reduce = 33%, Cumulative CPU 7.48 sec
2012-08-25 19:40:57,365 Stage-2 map = 100%,  reduce = 33%, Cumulative CPU 7.48 sec
2012-08-25 19:40:58,374 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 10.85 sec
2012-08-25 19:40:59,384 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 10.85 sec
2012-08-25 19:41:00,393 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 10.85 sec
2012-08-25 19:41:01,407 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 10.85 sec
2012-08-25 19:41:02,420 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 10.85 sec
2012-08-25 19:41:03,431 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 10.85 sec
2012-08-25 19:41:04,443 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 10.85 sec
MapReduce Total cumulative CPU time: 10 seconds 850 msec
Ended Job = job_201208251929_0004
Counters:
MapReduce Jobs Launched: 
Job 0: Map: 2  Reduce: 1   Accumulative CPU: 72.86 sec   HDFS Read: 4920 HDFS Write: 8371374 SUCCESS
Job 1: Map: 1  Reduce: 1   Accumulative CPU: 10.85 sec   HDFS Read: 8371850 HDFS Write: 456 SUCCESS
Total MapReduce CPU Time Spent: 1 minutes 23 seconds 710 msec 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T07:39:04.873

您只有一个减速器 - 它正在完成大部分工作。我认为这是一个原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-20T20:54:54.567

我认为，您应该增加执行查询的 reducer 的数量。它由以下代码完成：

```
set mapred.reduce.tasks=n; 
```

哪里`n`是减速器的数量。

然后使用`DISTRIBUTE BY`or`CLUSTER BY`子句（不要与 混淆`CLUSTERED BY`）在 reducer 之间尽可能均匀地分布数据集的各个部分。如果您不需要排序，最好使用`DISTRIBUTE BY`，因为

> `Cluster By``Distribute By`是和的捷径`Sort By`。

这是[hive 手册的链接](https://cwiki.apache.org/confluence/display/Hive/LanguageManual+SortBy)。

# java - 在 Eclipse 项目中将 .class 或 .java 文件作为资源是否有任何限制？

> ID：12125121
> 
> 赞同：2
> 
> 时间：2012-08-25T19:47:09.757
> 
> 标签：java, eclipse

我目前遇到问题，因为我试图将`.class`文件作为 Eclipse 下我的 Java 项目的资源。`.java`过去尝试将文件作为资源文件时，我也肯定会遇到问题。尽管 Eclipse 根本不会大喊大叫，但试图在运行时操纵资源给我带来了麻烦。我只能假设它与以特殊方式对待它们有关，因为它们是特定于语言的扩展。

除了使用不同的扩展名或根本不使用外，有什么办法可以规避这个问题？

我目前正在尝试将`.class`文件作为资源，以便可以在运行时将其复制到用户指定的文件夹中。在定义资源时，`MyResource.class`我将无法打开，但一旦我将其更改为`MyResource`一切正常并按预期工作。

* * *

经过一番检查，我得出的结论是 Eclipse 没有将`.class`文件放在输出目录中的对应文件夹中（它只是忽略它）。关于如何覆盖此行为的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T20:29:20.153

在 Eclipse 中，右键单击您的项目，`Properties > Java Build Path`然后选择`Libraries`选项卡。用于`Add Class Folder`创建与文件夹同级的`src`文件夹。

然后你可以将你的`.class`文件（在它们适当的包文件夹中）放在类文件夹下，它们将被复制到 bin/ 作为构建过程的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T20:16:43.770

至少对我来说，这听起来确实符合预期。Java 正在尝试加载或使用以（已编译）结尾的类：

> 。班级

你期待什么？就像在您尝试使用的类路径中有一个 jar 时一样，在 jar 中您将有一堆 .class 文件供您参考。还是我什么都不懂？

# 3d - 从地球到太阳的坐标转换

> ID：12125124
> 
> 赞同：0
> 
> 时间：2012-08-25T19:47:40.923
> 
> 标签：3d, physics, coordinate-transformation

我正在构建太阳系的 3D 模型，需要弄清楚每个行星的极星的位置，以便将行星向正确的方向倾斜正确的量。我已经找到了极星位置的信息，问题是它们在地球相对坐标中。例如，火星的极星是天鹅座伽玛，位于 RA 20h 22m 13.70184s，Dec +40° 15' 24.0450"。

赤经 (RA) 位于本初子午线以东几个小时的位置。赤纬 (Dec) 是赤道以北 (+) 或南 (-) 度数。这些共同定义了一个假想天球上的一个位置，在这个天球的表面上，人们可以想象所有的星星吗？

那么我如何从这些坐标转到一个向量，该向量定义了天球上远处某处恒星的位置？

我正在使用 ThreeJS。[这个](https://stackoverflow.com/questions/10431632/showing-coordinate-lines-of-a-3d-earth)问题指出了在定义球体原点或至少其纹理方面的部分解决方案。

编辑我已经在`physics.stackexchange.com` [这里发布了同样的问题](https://physics.stackexchange.com/questions/34927/coordinate-transformation-from-earth-to-solar)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T07:59:14.470

我在physics.stackexchange.com 上得到了这个答案

* * *

欢迎来到天文学中令人困惑的坐标系世界！

与您的问题相关的两个坐标系是国际天体参考系 (ICRS) 和黄道坐标系。第一个定义非常明确，后者是“简单”派生出来的。

简而言之，ICRS 是基于将地球赤道平面延伸到无限远。系统将 X 轴与太阳分点线对齐。Z 轴指向地球的北极，Y 完成右手系统。

不用说，从远处观察太阳系时，这个系统并不是最自然的选择。更自然的选择是黄道坐标系。该系统遵循与 ICRS 相同的定义，不同之处在于黄道（大致是地球轨道所在的平面）延伸到无限远，而不是赤道平面。

将黄道坐标转换为赤道坐标并返回相当简单。不要忘记将角距离 (RA, dec) 转换为欧几里得坐标，到极星的距离等于 1（这有助于计算并提供很好的检查）。

罗迪·奥尔登惠斯

# android - 在 ActionBarSherlock 中将标题重力设置为中心

> ID：12125126
> 
> 赞同：9
> 
> 时间：2012-08-25T19:47:49.050
> 
> 标签：android, android-actionbar, actionbarsherlock, android-theme

您好，我想为我的主要活动应用自定义背景布局。我找不到解决方案。有人可以给我一些提示吗？

想在操作栏中有一个带有背景的简单 TextView。这可能吗？

我设法删除了图标并设置了背景图像。但是如何将文本的重心设置为居中并更改字体？

```
getSupportActionBar().setDisplayShowHomeEnabled(false);
    getSupportActionBar().setBackgroundDrawable(getResources().getDrawable(myimage)); 
```

它应该如下所示： ![在此处输入图像描述](../Images/46fdc34fb19fe53b8d623093e558d26f.png)

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-25T20:22:43.963

您必须像这样为 Actionbar 设置自定义布局：

```
getSupportActionBar().setDisplayOptions(ActionBar.DISPLAY_SHOW_CUSTOM); 
getSupportActionBar().setCustomView(R.layout.yourlayout); 
```

然后，在您的布局中，您可以添加一个 TextView 并将其重力设置为`center`. 例如：

```
<LinearLayout 
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="#000000">

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:text="Header!"
        android:id="@+id/mytext"
        android:textColor="#ffffff"
        android:textSize="25dp" />

</LinearLayout> 
```

然后，您可以在 Activity 中从您的资产中设置自定义字体，如下所示：

```
 TextView txt = (TextView) findViewById(R.id.mytext);  
 Typeface font = Typeface.createFromAsset(getAssets(), "yourfont.ttf");  
 txt.setTypeface(font); 
```

# asp.net-mvc - 如何创建指向不同控制器的索引操作的 ActionLink？

> ID：12125128
> 
> 赞同：0
> 
> 时间：2012-08-25T19:48:12.520
> 
> 标签：asp.net-mvc, html.actionlink

如何更改以下代码以生成正确的 URL？

注意：ActionLink 是从与 DomainsController 不同的控制器生成的。

```
@Html.ActionLink("Domains", "Index", "Domains", new { id = item.Name }, null) 
```

目标是查看以下 URL。

```
/Domains/ItemName 
```

我得到的是：

```
/Domains/Index/ItemName 
```

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T20:00:19.500

奇怪的路由:)

这是快速而肮脏的解决方案：

```
@{string link= "Domains/" + item.Name;}
@Html.ActionLink("Domains", "", link, null, null) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T20:06:52.100

你的要求有点不切实际。你当然*可以*用类似的东西来实现这一点

```
routes.MapRoute(null,
                "Domains/{id}",
                new { controller = "Domains", action = "Index" }
); 
```

但是，您必须为所有其他`DomainsController`操作方法创建显式路由规则，否则您将无法再简单地使用 eg `/Domains/OtherAction`- 它会被上述规则捕获并解释为对`Index`方法的调用`id == "OtherAction"`

# iphone - iPhone 版 Twitter 中的导航样式

> ID：12125130
> 
> 赞同：2
> 
> 时间：2012-08-25T19:48:31.503
> 
> 标签：iphone, objective-c, ios, cocoa-touch

我试图弄清楚 iPhone 版 Twitter 中的导航样式是如何实现的。

当您在时间线中点击一条推文时，（自定义）标签栏会在从时间线到详细视图的过渡期间保持原位。这表明选项卡栏是 'main' 的子视图`UIViewController`，其中包含一个 4 数组，`UINavigationControllers`每个选项卡一个。当一个选项卡被按下时，主视图从其视图`UIViewController`中删除当前可见的并将新的添加为子视图。`UINavigationController`在这种方法中，标签栏不是任何导航堆栈的一部分，因此它在每次转换期间都保持原位。

但是，当您在详细视图中点击 URL 时，选项卡栏会移出屏幕并出现一个新的工具栏。这与上述理论相矛盾。

Tweetbot 使用与官方 Twitter 应用完全相反的导航风格。如果您在 Tweetbot 的时间轴中点击一条推文，标签栏会移出屏幕。标签栏在过渡期间永远不会停留在原位。他们可能使用一个`UINavigationController`，主`UIViewController`+ 选项卡栏作为 rootviewcontroller。我假设当用户点击一条推文时，时间线会通过委托或类似的方式调用`[self.navigationController pushViewController:]`主线。`UIViewController`

事实上，iPhone 版 Twitter 将第一个理论与 Tweetbot 导航风格背后的理论混合在一起。我怎样才能实现官方 Twitter 应用程序的功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T21:33:15.227

这可能是一个过于简化的描述，而且很多内容都是凭记忆进行的，但我认为这应该能让你继续前进……</p>

根视图控制器主要是从头开始实现的选项卡栏控制器。在出现简单的 iOS API 之前，它最初是用于自定义标签栏样式。但是，通过继续拥有代码，添加工具栏/标签栏交换并不难。

根视图控制器拥有标签栏视图和工具栏视图。根视图控制器是每个选项卡导航控制器的代表；当导航控制器推送新的视图控制器时，主视图控制器检查它是否有工具栏项，并管理交换。

出于可用性原因，将标签栏替换为工具栏通常不是一个好主意。标签栏为屏幕内容提供基础；想想浏览器的标签。标签栏项目还允许您在标签处于活动状态时通过点击它来跳转到层次结构中的根视图控制器。（这不是最容易发现的功能，但至少它是系统范围内的标准功能。）

这不是一个硬性规定。在导航层次结构中，将标签栏替换为“叶子”是很常见的；想想 Music.app 和 Photos.app。除非你有强有力的理由，否则请避免它。

# javascript - 在选择运输选项之前隐藏结帐按钮？

> ID：12125137
> 
> 赞同：2
> 
> 时间：2012-08-25T19:49:28.327
> 
> 标签：javascript, jquery

我正在使用 simpleCart js。我希望在客户选择英国或世界其他地区之前隐藏结帐按钮和运费。这是选择块：

```
<select id="shippingSelect" onchange="simpleCart.update();">
 <option value="nothing" selected="selected">Choose Shipping Location</option>
 <option value="uk">UK</option>
 <option value="world">Rest of World</option>
</select> 
```

下面是运费和结帐按钮：

```
<div class="place_order" style="display:none">
 <span id="simpleCart_shipping" class="simpleCart_shipping"></span>
 <a href="javascript:;" class="simpleCart_checkout btnDownload">checkout</a>
</div> 
```

生成购物车的 simpleCart 脚本：

```
<script>
simpleCart({
    cartColumns: [
        { attr: "name" , label: "Item" },
        { view: "decrement" , label: false , text: "-" },
        { attr: "quantity", label: "Quantity", view: "input"},
        { view: "increment" , label: false , text: "+" },
        { attr: "price", label: "Price"},
        { attr: "total" , label: "Subtotal", view: "currency"  }
    ],
    cartStyle: "table",
    currency: "GBP",
    language: "english-us",
    checkout: { 
        type: "PayPal" , 
        email: "email@ddress",
        success: "success.html"
    },
    shippingCustom: function(){ 
                 if( $("#shippingSelect").val() == "uk" ){
                      return 0;
                 } else {
                      return 2;
             }
        }
    });

</script> 
```

我以为我可以`$('.place_order').css('display', 'inline');`用来更改内联样式，但我不知道该怎么做，是将其合并到 simpleCart 脚本中还是让它触发单独的脚本？也许有更有效的方法？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T19:56:11.710

你是这个意思吗？

```
$('.simpleCart_checkout btnDownload').hide(); //hide your element upon intial page load

$('#shippingselect').change(function() {
   if ($(this).val() != "nothing") {
      $('.simpleCart_checkout btnDownload').show(); //show element if shipping option selected
   } else {
      $('.simpleCart_checkout btnDownload').hide();
   }
}); 
```

AFAIK 在类/ID 名称中有空格是不好的做法。

我认为禁用/启用按钮而不是隐藏或显示它会更好。

```
$('.simpleCart_checkout btnDownload').attr('disabled', true); 
```

# visual-c++ - IFileOpenDialog 给出错误“位置不可用”并且无法在 Windows 7 上加载用户库

> ID：12125142
> 
> 赞同：0
> 
> 时间：2012-08-25T19:49:55.340
> 
> 标签：visual-c++, windows-7

遇到与此相同的问题： [Windows 7 上的 CoCreateInstance 问题](https://stackoverflow.com/questions/7688624/cocreateinstance-issue-on-windows-7) {基本上使用 IFileOpenDialog 有时会出现错误：“位置不可用”“C:\Windows\system32\config\systemprofile\Desktop 指的是不可用的位置”。显示此消息后，用户可以继续，但库无法正确显示内容，这很烦人。}

该代码在以用户权限运行的 MFC 应用程序中被调用，但该问题仅在至少 3 个测试系统上间歇性发生。

这是创建对话框并显示它的代码：

```
 IFileOpenDialog *pFileOpen = NULL;

    HRESULT hr = CoCreateInstance(__uuidof(FileOpenDialog), NULL, 
        CLSCTX_INPROC_SERVER, IID_PPV_ARGS(&pFileOpen));

    if (SUCCEEDED(hr))
    {
        DWORD dwFlags = 0;

        pFileOpen->GetOptions ( &dwFlags );
        pFileOpen->SetOptions ( dwFlags | FOS_ALLOWMULTISELECT | FOS_PATHMUSTEXIST | FOS_FORCEFILESYSTEM );

        pFileOpen->SetTitle ( L"Select file for upload" );

        hr = pFileOpen->Show(this->GetSafeHwnd());

        //everything after this for retrieving files selected works fine. 
```

# javascript - 从 HTML 标记中为 observable 赋予初始值

> ID：12125143
> 
> 赞同：24
> 
> 时间：2012-08-25T19:49:56.203
> 
> 标签：javascript, data-binding, knockout.js, observable

我正在尝试创建一个`HtmlHelper`将一些 HTML 输出到视图的扩展。在这个 HTML 中，我正在连接一些 KnockoutJS 绑定。我是 KO 的新手，所以我仍然在努力完成一些事情。无论如何，我要做的是在我的客户端代码上生成绑定到可观察对象的输入字段（在服务器端代码中），然后通过隐藏字段的值设置可观察对象的初始值。不幸的是，这对我不起作用。所以我想知道是否有任何方法可以完成这项工作（即使我必须完全不同）。

这就是我基本上在做的事情：

在我的客户端视图模型中，我有以下内容：

```
self.dataSource = ko.observable();
self.pageSize = ko.observable(); 
```

我的扩展方法输出以下内容：

```
<input type="hidden" value="/Employee/Get" data-bind="value: dataSource" />
<input type="hidden" value="30" data-bind="value: pageSize" /> 
```

但是当页面呈现时，当我检查元素时，我注意到`value`输入字段的 被设置为空字符串，我认为这是因为声明了可观察对象的方式。但是有没有办法覆盖这种行为或什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2014-02-11T23:24:02.030

这里有点晚了。我实际上对 RP 的回答并不满意，因为它破坏了 Knockout 的声明性。具体来说，如果您使用 valueWithInit 来定义您的属性，则不能在较早的绑定中*使用它。*这是[他的 jsfiddle 的一个分支来演示](http://jsfiddle.net/joeyespo/LYb72/)。

您以相同的方式使用它，但它仍然是文档范围内的声明性：

```
<input data-bind="valueWithInit: firstName" value="Joe" /> 
```

扩展这个想法，您还可以使用它来分离初始化和绑定：

```
<input data-bind="initValue: lastName, value: lastName" value="Smith" /> 
```

这有点多余，但当您使用插件而不是内置绑定时会变得很有用：

```
<input data-bind="initValue: lastName, myPlugin: lastName" value="Smith" /> 
```

再扩展一点，我还需要一种初始化复选框的方法：

```
<input type="checkbox" data-bind="checkedWithInit: isEmployed" checked /> 
```

这里是处理程序：

```
ko.bindingHandlers.initValue = {
    init: function(element, valueAccessor) {
        var value = valueAccessor();
        if (!ko.isWriteableObservable(value)) {
            throw new Error('Knockout "initValue" binding expects an observable.');
        }
        value(element.value);
    }
};

ko.bindingHandlers.initChecked = {
    init: function(element, valueAccessor) {
        var value = valueAccessor();
        if (!ko.isWriteableObservable(value)) {
            throw new Error('Knockout "initChecked" binding expects an observable.');
        }
        value(element.checked);
    }
};

ko.bindingHandlers.valueWithInit = {
    init: function(element, valueAccessor, allBindings, data, context) {
        ko.applyBindingsToNode(element, { initValue: valueAccessor() }, context);
        ko.applyBindingsToNode(element, { value: valueAccessor() }, context);
    }
};

ko.bindingHandlers.checkedWithInit = {
    init: function(element, valueAccessor, allBindings, data, context) {
        ko.applyBindingsToNode(element, { initChecked: valueAccessor() }, context);
        ko.applyBindingsToNode(element, { checked: valueAccessor() }, context);
    }
}; 
```

注意`valueWithInit`只是`initValue`在引擎盖下使用。

[在 jsfiddle 上](http://jsfiddle.net/joeyespo/uEvd3/)查看它的实际效果。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-08-27T03:03:33.660

您可以用来使代码更简洁的一种替代方法是使用自定义绑定，该绑定通过使用元素的当前值对其进行初始化来包装值绑定。

如果它们不存在，您甚至可以让它在您的视图模型上创建可观察对象。

绑定可能类似于：

```
ko.bindingHandlers.valueWithInit = {
    init: function(element, valueAccessor, allBindingsAccessor, data) {
        var property = valueAccessor(),
            value = element.value;

        //create the observable, if it doesn't exist 
        if (!ko.isWriteableObservable(data[property])) {
            data[property] = ko.observable();
        }

        data[property](value);

        ko.applyBindingsToNode(element, { value: data[property] });
    }
}; 
```

你会像这样使用它：

```
<input value="someValue" data-bind="valueWithInit: 'firstName'" /> 
```

请注意，属性名称用引号引起来，这允许绑定创建它，如果它不存在而不是从未定义的值中出错。

这是一个示例：http: [//jsfiddle.net/rniemeyer/BnDh6](http://jsfiddle.net/rniemeyer/BnDh6)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-01-01T22:22:10.007

如果自定义绑定太重，那么一个简单的解决方案是从 DOM 初始化可观察对象。

例如，给定以下 HTML 表单：

```
<form name="person">
  <input type="text" name="firstName" value="Joe" data-bind="value: firstName"/>
</form> 
```

然后 Knockout 可以如下初始化：

```
ko.applyBindings({
  firstName: ko.observable(document.forms['person']['firstName'].value)
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-07-07T07:36:45.970

您可以简单地使用[自定义绑定](http://knockoutjs.com/documentation/custom-bindings.html)并将值分配给现有的 observables：

```
ko.bindingHandlers.yourBindingName = {
    init: function (element, valueAccessor, allBindings, viewModel, bindingContext) {
        viewModel.dataSource($(".dataSource").val());
        viewModel.pageSize($(".pageSize").val());
    }
}; 
```

`data-bind="yourBindingName"`然后，只需向输入和包含它们的 HTML 元素添加一个类或一个 Id 。

# objective-c - 格式为 cell.detailTextLabel.text

> ID：12125144
> 
> 赞同：0
> 
> 时间：2012-08-25T19:50:07.243
> 
> 标签：objective-c, format, subtitle

我在单元格字幕中有格式问题。我有一个字符串和一个数字，我想在单元格的副标题中显示

字符串应该左对齐，数字右对齐

我以这种方式尝试过：

```
rangeAutor = [rangeAutor stringByPaddingToLength:40-[rangeAutor length] withString:@" " startingAtIndex:0];

NSString *subTitle = [NSString stringWithFormat:@"by %@ %1.2f km", rangeAutor, rangeDistance];
cell.detailTextLabel.text = subTitle; 
```

结果你能在这里看到吗:-([格式问题](http://myrange.de/support/format.png)

您对我有解决方案的想法吗？

由于我只有 7 个声誉，我无法在评论中写下我的答案 :-( 所以我尝试在这里做：

```
 static NSString *const kIdentifier = @"SelectRange";
static NSInteger const kDistanceLabelTag = 1;

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:kIdentifier];
UILabel *distanceLabel;
if (cell) {
    distanceLabel = (UILabel *)[cell.contentView viewWithTag:kDistanceLabelTag];
} else {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:kIdentifier];
    CGRect cellBounds = cell.bounds;
    static CGFloat const kLabelHeight = 20.0f;
    distanceLabel = [[UILabel alloc] initWithFrame:CGRectMake(0, cellBounds.size.height - kLabelHeight, cellBounds.size.width, kLabelHeight)];
    distanceLabel.tag = kDistanceLabelTag;
    distanceLabel.font = cell.textLabel.font;
    distanceLabel.textColor = cell.textLabel.textColor;
    distanceLabel.textAlignment = UITextAlignmentRight;
    distanceLabel.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleTopMargin;
    [cell.contentView addSubview:distanceLabel];
}

UIImage *icon = [UIImage imageNamed:iconName];;
cell.imageView.image = icon;
cell.textLabel.text = rangeName;
cell.detailTextLabel.text = [@"by " stringByAppendingString:rangeAutor];
distanceLabel.text = [NSString stringWithFormat:@"%1.2f km", rangeDistance];
NSLog(@"RangeDistance: %1.2f", rangeDistance);

return cell; 
```

抢劫梅奥夫

我只更改了一些小东西，但现在我在单元格中看不到 rangeDistance :-( 日志输出正常

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T20:10:39.973

问题是您使用的是可变宽度字体。字体中的每个字形可能有不同的宽度。因此，您不能只将自动填充到 40 个字符，因为“llll”后跟 36 个空格的宽度（在屏幕上）与“MMMM”后跟 36 个空格的宽度不同。

只要给你`cell`另一个标签来保持距离。我假设您帖子中的代码来自您的`tableView:cellForRowAtIndexPath:`方法。你需要做这样的事情：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *const kIdentifier = @"Cell";
    static NSInteger const kDistanceLabelTag = 1;

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:kIdentifier];
    UILabel *distanceLabel;
    if (cell) {
        distanceLabel = (UILabel *)[cell.contentView viewWithTag:kDistanceLabelTag];
    } else {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:kIdentifier];
        CGRect cellBounds = cell.bounds;
        static CGFloat const kLabelHeight = 20.0f;
        distanceLabel = [[UILabel alloc] initWithFrame:CGRectMake(0, cellBounds.size.height - kLabelHeight, cellBounds.size.width, kLabelHeight)];
        distanceLabel.tag = kDistanceLabelTag;
        distanceLabel.font = cell.textLabel.font;
        distanceLabel.textColor = cell.textLabel.textColor;
        distanceLabel.textAlignment = UITextAlignmentRight;
        distanceLabel.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleTopMargin;
        [cell.contentView addSubview:distanceLabel];
    }

    cell.imageView.image = rangeImage;
    cell.textLabel.text = rangeName;
    cell.detailTextLabel.text = [@"by " stringByAppendingString:rangeAutor];
    distanceLabel.text = [NSString stringWithFormat:@"%1.2f km", rangeDistance];

    return cell;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T19:55:25.213

尝试使用常量值而不是`40-[rangeAutor length]`

# web-services - 使用 jquery ajax 调用 asmx Web 服务方法

> ID：12125153
> 
> 赞同：1
> 
> 时间：2012-08-25T19:50:59.890
> 
> 标签：web-services, jquery, iis, asmx, webmethod

我在 IIS 7.5 中使用简单的 asmx Web 服务托管了 Web 应用程序

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Services;

namespace TestWebService
{
    [WebService(Namespace = "http://tempuri.org/")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [System.ComponentModel.ToolboxItem(false)]
    [System.Web.Script.Services.ScriptService]
    public class Test : System.Web.Services.WebService
    {
        [WebMethod]
        public static string HelloWorld()
        {
            return "Hello World";
        }

    }
} 
```

当我单击调用按钮时，`http://localhost/Test/Test.asmx?op=HelloWorld`它工作正常，但是当我尝试使用 $.ajax() 从在 ASP.NET 开发服务器（`http://localhost:1756/HTMLPage1.htm`）上运行的不同 Web 应用程序项目中调用此方法时，我得到一个错误 response.status 为 0 和无法调用 web 方法，这是我的代码。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Consume Test </title>
    <script src="jquery-1.5.1.js" type="text/javascript"></script>
    <script type="text/javascript">

        function displayMessageCall() {

            $.ajax({
                type: "POST",
                url: "http://localhost/Test/Test.asmx/HelloWorld",
                data: '{}',
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: successMsg,
                error: errorMsg

            });
        }

        function successMsg(response) {
            alert('Success');
        }

        function errorMsg(response) {
            alert(response.status + " " + response.statusText)
        }

        $(document).ready(function () {
            displayMessageCall();
        });
    </script>
</head>
<body>
</body>
</html> 
```

我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T09:24:54.780

我认为您只是遇到了[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy#Origin_determination_rules)。

由于端口差异，浏览器限制了 javascript 访问 web 服务。当然，也有一些[解决方法](http://en.wikipedia.org/wiki/Same_origin_policy#Workarounds)。

# class - 在 JRuby 中获取由字符串表示的 Java 类？（没有评估）

> ID：12125154
> 
> 赞同：3
> 
> 时间：2012-08-25T19:51:05.847
> 
> 标签：class, reflection, jruby

我想在 JRuby 中调用 Java 类的静态方法。目前为了实现这一点，我使用：

```
class_name = "com.slackworks.naether.util.LogUtil"
clazz = eval(class_name)
clazz.setLogLevel( "debug" ) 
```

必须使用 eval 将 String 转换为 Class 似乎很笨拙。我环顾四周，但找不到一个 JRuby 助手来代替`eval`.

* * *

我需要将 String 转换为 Class 的原因是，这发生在处理 JRuby 或 RJB 请求的包装器中，具体取决于 Ruby 运行时。如果 Ruby 运行时使用 RJB，则调用类似于：

```
class_name = "com.slackworks.naether.util.LogUtil"
clazz = Rjb::import( class_name )
clazz.setLogLevel( "debug" ) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T17:18:47.700

So I stumbled upon a solution from looking at the [JRuby Wiki](https://github.com/jruby/jruby/wiki/CallingJavaFromJRuby). `Java::JavaClass.for_name` can be used to convert the String to a Java class, which can be converted to a Ruby class using `ruby_class`. Example using IRB:

```
jruby-1.6.8 :053 > math_class = Java::JavaClass.for_name("java.lang.Math").ruby_class
 => Java::JavaLang::Math 
jruby-1.6.8 :054 > math_class.floor( 10.7 )
 => 10.0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T00:36:23.223

你看过[https://github.com/jruby/jruby/wiki/CallingJavaFromJRuby](https://github.com/jruby/jruby/wiki/CallingJavaFromJRuby)吗？特别是`java_import`应该允许你这样做。

```
$ jruby -S irb
irb(main):001:0> java_import 'java.util.concurrent.TimeUnit'
=> [Java::JavaUtilConcurrent::TimeUnit]
irb(main):002:0> TimeUnit.values
=> java.util.concurrent.TimeUnit[NANOSECONDS, MICROSECONDS, MILLISECONDS, SECONDS, MINUTES, HOURS, DAYS]@46150133 
```

在上面的示例中，您应该能够做到这一点：

```
require 'java'
java_import class_name
LogUtil.setLogLevel "debug" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-20T17:37:01.033

如果您想加载/获取代理类而不将其实际挂钩到您的命名空间，您可以使用：

```
str_class = JavaUtilities.get_proxy_class("java.lang.String") 
```

请注意：这仅在某些情况下有用，`java_import`如果可能，请正常使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-24T09:49:35.913

如果您使用的是rails，您也可以使用constantize。

```
"Java::JavaLang::Math".constantize
 => Java::JavaLang::Math 
```

# php - PHP - register_shutdown_function 自动执行？

> ID：12125162
> 
> 赞同：0
> 
> 时间：2012-08-25T19:52:13.597
> 
> 标签：php

```
function fatal_error_handler() {
    if ($error = error_get_last()) {

        switch ($error['type']) {
            case E_ERROR:
                $code = 'FATAL ERROR';
                break;
            case E_CORE_ERROR:
                $code = 'CORE ERROR';
                break;
            case E_CORE_WARNING:
                $code = 'CORE WARNING';
                break;
            default:
                $code = 'UNKNOWN FATAL ERROR';
        }

        echo 'An error occurred (Test 1): ' . $code . '<br />';
    }

    echo 'An error occurred (Test 2): ' . $code . '<br />';
}

register_shutdown_function('fatal_error_handler'); 
```

我目前正在使用 register_shutdown_function 编写一个致命的错误处理程序。只是想知道， register_shutdown_function 是否应该自动运行/执行？我一直在测试上面的这段代码。我特意加入了第二个 echo 语句，看看它是否自动运行，它实际上打印出了第二个 echo 语句（第一个 echo 语句没有打印，因为没有致命错误）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T19:59:34.363

正如其他人所说，这将在关闭时运行，无论脚本是正常完成还是由于您意识到的错误而异常完成，因为您正在使用它进行错误处理，这有点用处。

您甚至将拥有您之前创建的所有对象，例如静态类等，并且可以按照您的说明输出到浏览器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T19:55:40.387

[是的，这是故意的：（](http://php.net/register_shutdown_function)强调我的）

> **在脚本执行完成**或调用 exit()后注册要执行的回调。

# android - android SQLite查询多列

> ID：12125163
> 
> 赞同：2
> 
> 时间：2012-08-25T19:52:25.393
> 
> 标签：android, database, sqlite

我正在尝试查询我的`SQLite`表并将结果限制为仅显示符合我的条件的记录。

我想在哪里过滤`COLOR="red"`结果`CLASS="alpha"`

这是我到目前为止的结果，导致`NULLPointerException`查询：

```
 public Cursor getDetailRecords( String color, String category ) {

    final String SELECTION = KEY_COLOR + "=?" + " and " + KEY_CLASS + "=?";
    final String[] SELECTION_ARGS = { color, category };

    Cursor mCursor = db.query(DATABASE_TABLE, DATABASE_STRUCTURE, 
            SELECTION, SELECTION_ARGS, null, null, null, null);
    if (mCursor != null) {
        mCursor.moveToFirst();
    }
    return mCursor;
} 
```

我使用类别作为我的变量，而不是作为保留字的类。

我不确定如何格式化我的选择`string`。任何帮助将不胜感激。提前致谢！

# java - 使用 SimpleDateFormat 格式化日期

> ID：12125166
> 
> 赞同：-1
> 
> 时间：2012-08-25T19:52:39.400
> 
> 标签：java

如何解析像 '2012-08-22 11:55:38 这样的日期

到“8 月 8 日”

我尝试使用 formateador = new SimpleDateFormat("d MMM");

但我得到一个“无法解析的日期”异常。

希望您能够帮助我。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T19:57:20.490

你从一个字符串*解析*为一个`Date`. 然后，您可以使用不同的模式将 a*格式化*为字符串。`Date`目前，鉴于您向我们展示的代码，您似乎正在尝试解析值“2012-08-22 11:55:38”，并`SimpleDateFormat` *期待*模式“d MMM”，但显然没有遵守。你应该有类似的东西：

```
SimpleDateFormat inputFormat = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss",
                                                    Locale.US);
// TODO: Set the time zone appropriately
Date date = inputFormat.parse(inputText);

SimpleDateFormat outputFormat = new SimpleDateFormat("d MMM", targetLocale);
// TODO: Set the time zone appropriately
String outputText = outputFormat.format(date); 
```

请注意，如果您在 Java 中做大量的日期/时间工作，您应该查看[Joda Time](http://joda-time.sf.net)，这是一个更好的日期/时间 API。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T19:57:27.987

这应该有效（如果我明白你在问什么）：

```
String s = "2012-08-22 11:55:38";
DateFormat fmt = new SimpleDateFormat("yyyy-MM-dd hh:mm:ss");
Date dt = fmt.parse(s);
DateFormat output = new SimpleDateFormat("d 'of' MMMM", Locale.US);
System.out.println(output.format(dt)); //prints 22 of August 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-25T19:57:32.927

从输入字符串解析日期时遇到问题。

"2012-08-22 11:55:38" 采用 "yyyy-MM-dd HH:mm:ss" 格式，您应该首先使用它从输入字符串中解析日期。

然后，一旦有了`Date`对象，就可以将日期格式化为所需的格式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-25T19:57:50.963

如果我的问题正确，您尝试将第一个字符串解析为日期，然后将结果日期格式化为秒字符串。如果这是真的，那么请看下面的代码：

```
SimpleDateFormat f1 = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
SimpleDateFormat f2 = new SimpleDateFormat("dd 'of' MMMM");
try {
  java.util.Date date = f1.parse("2012-08-22 11:55:38");
  System.out.println(f2.format(date));
} catch (ParseException ex) {
  ex.printStackTrace(); 
} 
```

# azure - Azure 表服务共享访问签名不可用

> ID：12125167
> 
> 赞同：2
> 
> 时间：2012-08-25T19:52:49.967
> 
> 标签：azure, azure-storage, azure-table-storage

我正在运行 Azure SDK June 2012 Sp1，也就是 8 月更新。我正在尝试生成将由 WPF 客户端使用的共享签名。问题是我无法解决

```
SharedAccessTablePolicy policy = new SharedAccessTablePolicy() 
```

我应该参考哪个程序集和哪个版本？

/拉斯穆斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T00:26:52.127

2012 年 6 月 SP1 更新与 2012 年 6 月更新完全相同，只是针对 Visual Studio 2012 RTM 进行了兼容性修复。

如果你去 .net github repo 并拉取[sdk_1.7.1 分支](https://github.com/WindowsAzure/azure-sdk-for-net/tree/sdk_1.7.1)的代码并构建它，你会发现`SharedAccessTablePolicy`. 我上周刚刚构建了它，并可以通过这种方法访问它。只需记住更改您的角色引用以指向您新建的 DLL，它将显示为 1.7.1。

命名空间是`Microsoft.WindowsAzure.StorageClient`：

![在此处输入图像描述](../Images/45d5ce1fa63c8624800cff0cdb3abae2.png)

[这是来自github](https://github.com/WindowsAzure/azure-sdk-for-net/tree/sdk_1.7.1/microsoft-azure-api/StorageClient)的快速屏幕截图，该文件现在存在于 1.7.1 中：

![在此处输入图像描述](../Images/593be3432575569cee7f2f5d7a54d6fb.png)

# javascript - .load 页面中的所见即所得编辑器

> ID：12125168
> 
> 赞同：0
> 
> 时间：2012-08-25T19:52:52.603
> 
> 标签：javascript, jquery, ajax, wysiwyg

我面临以下问题：

我有我的 index.html 页面，带有 div#content。在这个 div 中，我通过我的 js 加载页面

```
//JavaScript Document
$(document).ready(function() {
    $('#loader').load('pages/loader.php').hide();
    $('#content_container').load('pages/dashboard.php');
    //$('.dashboard_quick_news').load('pages/quicknews.php');
});

$('.content_link').click(function(){
    var href = $(this).attr('href');
    $('#loader').show();
    $('#content_container').hide().load(href).delay(1800).fadeIn('normal');
    $('#loader').load('pages/loader.php').delay(1000).fadeOut();
    return false;   

}); 
```

现在这一切都正常工作，加载的页面会按应有的方式显示。尽管在我加载的一个页面中，我包含了一个所见即所得的编辑器（Nicedit）

```
<script type="text/javascript" src="../../nicedit/nicEdit.js"></script>
        <script type="text/javascript">
            bkLib.onDomLoaded(function() { nicEditors.allTextAreas() });
        </script> 
```

当我通过索引（使用 .load 函数）加载此页面时，所见即所得编辑器不显示（也使用 TinyMCE 进行了测试）。当我只是单独访问页面（通过 URL）时，所见即所得编辑器显示完美，因此路径设置正确。还使用包含在我的索引中的所见即所得 js 进行了测试

为了测试 .load 页面是否可能不包含 javascript，我使用所见即所得编辑器在页面上插入了一个警报。此警报确实显示，尽管所见即所得编辑器没有显示。

有谁知道如何解决这个问题？

已经谢谢了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T20:15:44.460

您是否检查了生成的 DOM 并查看编辑器标记是否已附加到您的页面？

大多数（全部？）这些所见即所得的编辑器都使用 iframe。我不确定他们是如何决定它的大小的，但我想既然您将 textarea 作为参数发送，他们会使用该 textarea 的尺寸。因此，请确保 textarea 的大小足够大，并检查注入的 iframe 是否足够大。

编辑：

在启动编辑器时，如果不知道您的文本区域在哪里，很难查明问题（请提供更多代码？）。

我认为问题出在 bkLib.onDomLoaded 中，它在加载 DOM 的那一刻运行。然而，jQuery 的 ready() 做（几乎）同样的事情。因此，当您调用 load() 来获取页面内容时，DOM 已经加载，因此 bkLib.onDomLoaded 将不会运行。

您需要做的是在请求的 .php 页面加载后实例化编辑器：

```
$('#content_container').load('pageWithEditorScript.php', function() {
    nicEditors.allTextAreas();
}); 
```

# c# - 我如何通过使用 linq to xml 在 xml 文件中添加新标签

> ID：12125175
> 
> 赞同：1
> 
> 时间：2012-08-25T19:54:08.210
> 
> 标签：c#, xml, linq-to-xml

我如何通过使用 linq to xml 在 xml 文件中添加新标签，我希望新标签是第一个标签

```
<?xml version="1.0" encoding="utf-8"?>
<settings>
<Device>
  <username>fooo</username>
  <AgentName>fooo</AgentName>
  <password>fooo</password>
</Device>
<Device>
  <username>fooo1</username>
  <AgentName>fooo1</AgentName>
  <password>fooo1</password>
</Device>
</settings> 
```

现在我想添加一个新标签来制作这样的文件

```
<settings>
<IncommingConfig>
    <ip>10.100.101.18</ip>
    <port>5060</port>
</IncommingConfig>
<Device>
  <username>fooo</username>
  <AgentName>fooo</AgentName>
  <password>fooo</password>
</Device>
<Device>
  <username>fooo1</username>
  <AgentName>fooo1</AgentName>
  <password>fooo1</password>
</Device>
</settings> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T19:59:47.227

这很容易使用[`XContainer.AddFirst`](http://msdn.microsoft.com/en-us/library/bb344365.aspx)，它将给定值添加为第*一个*孩子：

```
XDocument doc = XDocument.Load("data.xml");
doc.Root.AddFirst(new XElement("IncomingConfig", // Fixed typo in name
                     new XElement("ip", ipAddress),
                     new XElement("port", port)));
doc.Save("output.xml"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T20:00:47.177

```
XDocument xmldoc = XDocument.Load(Server.MapPath("...."));
XElement parentXElement = xmldoc.XPathSelectElement("settings");
XElement newXElement = new XElement("IncommingConfig");
.. 

parentXElement.AddFirst(newXElement); 
```

# android - Android首选项：使用编辑文本时出现问题

> ID：12125177
> 
> 赞同：2
> 
> 时间：2012-08-25T19:54:27.813
> 
> 标签：android, android-edittext, preferences

我是 android 新手，我有一个编辑文本，我想保存通过首选项输入的文本。任何人都可以帮我....

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T20:05:42.040

在android中持久化数据实际上有3种方式：

1.  共享偏好
2.  本地文件（xml、csv 等）
3.  Sql Lite 数据库

这里有一些代码可以让你开始使用“共享首选项”

```
//get reference to a Shared Preferences instance
SharedPreferences preferences = context.getSharedPreferences("Some Name You Make Up", 0);

//add a string to the given Shared Preferences store by key
SharedPreferences.Editor editor = preferences.edit();
editor.putString("some_key", "some_value");

//read the value from the Shared preferences
String value = preferences.getString("some_key", " "); 
```

这是关于共享首选项的 android 文档的链接。

[http://developer.android.com/reference/android/content/SharedPreferences.html](http://developer.android.com/reference/android/content/SharedPreferences.html)

享受！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T20:54:46.647

```
 SharedPreferences settings=getSharedPreferences("mypref", 0);
 et.setText(settings.getString("tvalue"," ")); 
```

然后重写 onstop() 方法

@覆盖

```
protected void onStop() {
     // TODO Auto-generated method stub
    super.onStop();
    SharedPreferences settings=getSharedPreferences("mypref", 0);
    SharedPreferences.Editor editor=settings.edit();
    editor.putString("tvalue", et.getText().toString());
    editor.commit();

} 
```

# c++ - 获取私有实例变量容器成员值的最佳方法

> ID：12125180
> 
> 赞同：0
> 
> 时间：2012-08-25T19:54:48.247
> 
> 标签：c++, opencv, return, instance, private-members

我是 C++ 的新手，我在弄清楚什么是最好的方法时遇到了一些麻烦。

我已经实现了一个类，我们称之为 imageContainer，它有一个私有的图像向量和用图像填充这个向量的方法。假设现在，我有另一个具有私有 imageContainer 的类，现在，在正确初始化此 imageContainer（读取我希望它包含的图像）之后，我需要处理它的图像。请记住，我的处理不会更改基本图像，只会使用它们计算一些东西。在不复制它们的情况下，获取这些图像的最佳、最安全的方法是什么？我想避免复制它们，因为我可能有很多大图像，这会使复制过程非常缓慢。

哦，我正在阅读的图像都是 openCV 的 Mat 类型。Mat 上的“=”运算符不会复制 Mat，它只共享数据，这让我认为获取图像的最佳方法是：

```
Mat imageContainer::getImage(size_t index)
{
    return vectorOfImages[index];
} 
```

但我不太确定。

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T19:58:35.673

返回引用以避免复制并将其设为 const 以禁止修改：

```
const Mat& imageContainer::getImage(size_t index) const
{
  return vectorOfImages[index];
} 
```

# javascript - 如何隐藏重叠的div而不删除内容

> ID：12125188
> 
> 赞同：1
> 
> 时间：2012-08-25T19:55:45.410
> 
> 标签：javascript, jquery

我有`home.html`以下`div`

```
<div id="feature" class="feature">
</div> 
```

我有 n 个编号的不同按钮显示为

```
 <button id="search" class="btn btn-large navigator-button navigator-icons">
                <i class="icon-search icon-large"></i>
                search
            </button>
          </li>
          <li>
            <button id="playlist" class="btn btn-large navigator-button navigator-icons">
                <i class="icon-list icon-large"></i>
                playlists
            </button>
          </li>
          <li>
            <button id="settings" class="btn btn-large navigator-button navigator-icons">
                <i class="icon-cog icon-large"></i>
                settings
            </button>
          </li>
          <li>
              <button id="queue" class="btn btn-large navigator-button navigator-icons">
                  <i class="icon-cog icon-play-circle"></i>
                  queue
              </button> 
```

当我单击任何按钮时，与该单击关联的内容将显示在`<div id="feature" class="feature">`

但目前，我只是做了`jQuery.load()`并清除了任何存在于`<div id="feature">`

**坏处？**

*   我每次都建立这些页面
*   我不保留较早页面的状态，例如用户搜索的搜索结果

**我想要的是？**

*   我需要一种方法，以便根据页面的点击，加载与当前点击关联的页面，同时隐藏与其他按钮点击对应的其他页面

*   我不知道如何用 jQuery 做到这一点，我对它很陌生

请让我知道我能做些什么来实现上述目标提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T20:49:11.237

一个可能的解决方案是使用 hide() 和 show() 函数，它们不会修改 DOM。

[http://api.jquery.com/show/](http://api.jquery.com/show/)

[http://api.jquery.com/hide/](http://api.jquery.com/hide/)

例如

```
$('#feature .content1').hide();
$('#feature .content2').show(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T20:39:13.330

根据您的描述，也许您可​​以使用 jquery-ui 选项卡。它很容易使用。

您使用 UL 和 LI 来定义标签按钮，并使用 DIV 列表来定义每个标签页。有一些命名约定，但其余的由 jquery-ui 处理。

# c# - Server sending invalid gzip to TcpClient

> ID：12125190
> 
> 赞同：0
> 
> 时间：2012-08-25T19:56:05.467
> 
> 标签：c#, http, tcp, httpwebrequest, tcpclient

I'm trying to learn more about how web and tcp work by implementing web tcp client.

Currently, my web request function looks like this:

```
 public string SendWebRequest(SocketWebRequest request)
    {
        using (NetworkStream ns = tc.GetStream())
        {
                using (System.IO.StreamReader sr = new System.IO.StreamReader(ns))
                {
                    request.WriteTo(ns);
                    ns.Flush();

                    var statusLine = sr.ReadLine();
                    ProcessStatusLine(statusLine);

                    Headers = ReadHeaders(sr);

                    ProcessCookies(request.Host);

                    int contentLength = 0;
                    if (Headers.ContainsKey("Content-Length"))
                    {
                        foreach (var cl in Headers["Content-Length"])
                        {
                            int buf;
                            if (int.TryParse(cl,out buf))
                            {
                                contentLength = buf;
                                break;
                            }
                        }
                    }
                    if (contentLength==0)
                    {
                        return "";
                    }

                    byte[] content = new byte[contentLength];

                    if (IsGziped())
                    {
                        MemoryStream decompressed = new MemoryStream();

                        using (var zs = new GZipStream(ns, CompressionMode.Decompress))
                        {
                            while (true)
                            {
                                var buf = new byte[1024];
                                int read = zs.Read(buf, 0, buf.Length);
                                if (read == 0)
                                {
                                    break;
                                }
                                decompressed.Write(buf, 0, read);
                            }
                        }
                        content = decompressed.ToArray();
                    }
                    else
                    {
                        using (BinaryReader rdr = new BinaryReader(ns))
                        {
                            rdr.Read(content, 0, content.Length);
                        }
                    }

                    var encoding = GetEncoding();

                    return encoding.GetString(content.ToArray());
                }

        }

    } 
```

the request looks like this:

```
GET http://www.youtube.com/ HTTP/1.1
Accept: application/x-ms-application, image/jpeg, application/xaml+xml, image/gif, image/pjpeg, application/x-ms-xbap, */*
Accept-Language: en-US
User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)
Accept-Encoding: gzip, deflate
Connection: Keep-Alive
Host:www.youtube.com 
```

and the response headers look like this:

```
HTTP/1.1 200 OK
Date: Sat, 25 Aug 2012 19:46:51 GMT
Server: Apache
X-Content-Type-Options: nosniff
Content-Encoding: gzip
Set-Cookie: use_hitbox=d5c5516c3379125f43aa0d495d100d6ddAEAAAAw; path=/; domain=.youtube.com
Set-Cookie: VISITOR_INFO1_LIVE=av7rkkf4Sfw; path=/; domain=.youtube.com; expires=Mon, 22-Apr-2013 19:46:51 GMT
Expires: Tue, 27 Apr 1971 19:44:06 EST
Cache-Control: no-cache
P3P: CP="This is not a P3P policy! See //support.google.com/accounts/bin/answer.py?answer=151657&hl=en-US for more info."
X-Frame-Options: SAMEORIGIN
Content-Length: 18977
Content-Type: text/html; charset=utf-8 
```

And after this the first `int read = zs.Read(buf, 0, buf.Length);` sometimes works, but often fails with following exception:

```
The magic number in GZip header is not correct. Make sure you are passing in a GZip stream. I've tried reading the data as string, and it looks encoded. 
```

Youtube works fine via browser. When reading the data as a string, it looks encoded.

Why am I getting this, and how should I fix that?

**UPDATE**

It looks like this is some sort of error during transmission. In 5 cases out of 10, it works, in other 5 it fails without an apparent reason

Here's the code if `IsGziped()`

```
 bool IsGziped()
    {
        foreach (var h in Headers["Content-Encoding"])
        {
            if (h.ToLowerInvariant().Contains("gzip"))
            {
                return true;
            }
        }
        return false;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T21:09:18.717

`StreamReader` does not necessarily read just the required number of bytes. It can read more due to internal buffering. This causes compressed bytes to be taken from the `NetworkStream ns` and put into the `StreamReader` internal buffer.

After the bytes have been taken the `GZipStream` cannot read them.

You probably need to use a custom header parsing solution that works on a binary level. There is no way to restrict `StreamReader` to just read the least possible amount of bytes.

`StreamReader` is not made to be used together with other readers.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-03T04:27:37.160

You can separate seamlessly with the following code (the response stream with header).

```
// Read response.

var buffer2 = new byte[4096];
var hd = new MemoryStream();
var response = new MemoryStream();
var endHeader = false;

do
{
    // Your networkstream object instead > "stream".

    bytes = stream.Read(buffer2, 0, buffer2.Length);

    if (!endHeader)
    {
        var startIndex = 0;
        if (IsContainsHeaderCrLf(buffer2, out startIndex))
        {
            endHeader = true;
            hd.Write(buffer2, 0,startIndex);
            response.Write(buffer2, startIndex + 4, bytes - startIndex - 4);
        }
        else
        {
            hd.Write(buffer2, 0, bytes);
        }
    }
    else
    {
        response.Write(buffer2, 0, bytes);
    }
} while (bytes != 0);

var headertxt = System.Text.Encoding.UTF8.GetString(hd.ToArray());
var unziptxt = "";
var responsetxt = "";

if (headertxt.Contains("gzip"))
{
    unziptxt = System.Text.Encoding.UTF8.GetString(Decompress(response.ToArray()));
}
else
{
    responsetxt = System.Text.Encoding.UTF8.GetString(response.ToArray());
}
return headertxt + "\r\n\r\n" + unziptxt + responsetxt;

//...

private bool IsContainsHeaderCrLf(byte[] buffer, out int startIndex)
{
    for (var i = 0; i <= buffer.Length - 4; i++)
    {
        if (buffer[i] == 13 & buffer[i + 1] == 10 && buffer[i + 2] == 13 && buffer[i + 3] == 10)
        {
            startIndex = i;
            return true;
        }
    }
    startIndex = -1;
    return false;
} 
```

Bonus decompress code.

```
static byte[] Decompress(byte[] gzip)
{
    // Create a GZIP stream with decompression mode.
    // ... Then create a buffer and write into while reading from the GZIP stream.
    using (var stream = new GZipStream(new MemoryStream(gzip), CompressionMode.Decompress))
    {
        const int size = 4096;
        var buffer = new byte[size];
        using (var memory = new MemoryStream())
        {
            var count = 0;
            do
            {
                count = stream.Read(buffer, 0, size);
                if (count > 0)
                {
                    memory.Write(buffer, 0, count);
                }
            }
            while (count > 0);
            return memory.ToArray();
        }
    }
} 
```

# php - 在 php 中添加/修复标点符号

> ID：12125209
> 
> 赞同：3
> 
> 时间：2012-08-25T19:58:15.087
> 
> 标签：php, punctuation

我正在慢慢完善 PHP 中用于清理用户输入的标点符号修复功能。该函数目前在标点符号后添加空格，在标点符号前删除空格，并将每个句子的第一个单词大写。我见过一些人在寻找类似的功能，所以我很高兴分享我到目前为止所拥有的东西。它非常接近我想要的位置，但是，当它在逗号后添加一个空格时，当逗号在诸如 1,000 之类的数字内时，它应该避免这样做? 也许有办法缩短我所拥有的但仍然达到相同的结果？谢谢你的时间...

```
function format_punc($string){
    $punctuation = ',.;:';
    $string = str_replace(' ?', '?', str_replace(' .', '.', str_replace(' ,', ',', preg_replace('/(['.$punctuation.'])[\s]*/', '\1 ', $string))));
    $string = trim(preg_replace('/[[:space:]]+/', ' ', preg_replace('/([\.!\?]\s+|\A)(\w)/e', '"$1" . strtoupper("$2")', $string)));
    if($string[strlen($string)-1]==','){
        $string = substr($string, 0, -1).'.';
    }
    return $string;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T11:56:36.483

这是我更新的 php 修复标点符号功能......它现在似乎工作正常。我确信有办法压缩它，但它可以对字符串执行以下操作...

减少重复的标点符号，例如 !! 到 ！
将多个空格减少为单个空格
删除之前的任何空格？. ,
后加空格；:
在逗号后添加空格，但不是当它们是数字的一部分
在句点后添加空格，但不是当它们是数字或缩写的一部分时
从字符串的开头和结尾删除空格 将句子的
第一个单词大写 将
最后一个字符更改为句点是逗号

```
function format_punc($string){
    $punctuation = ';:';
    $spaced_punc = array(' ?', ' .', ' ,');
    $un_spaced_punc = array('?', '.', ',');
    $string = preg_replace("/([.,!?;:])+/iS","$1",$string);
    $string = preg_replace('/[[:space:]]+/', ' ', $string);
    $string = str_replace($spaced_punc, $un_spaced_punc, $string);
    $string = preg_replace('/(['.$punctuation.'])[\s]*/', '\1 ', $string);
    $string = preg_replace('/(?<!\d),|,(?!\d{3})/', ', ', $string);
    $string = preg_replace('/(\.)([[:alpha:]]{2,})/', '$1 $2', $string);
    $string = trim($string);
    $string = preg_replace('/([\.!\?]\s+|\A)(\w)/e', '"$1" . strtoupper("$2")', $string);
    if($string[strlen($string)-1]==','){
        $string = substr($string, 0, -1).'.';
    }
    return $string;
} 
```

如果您花时间压缩此代码并创建仍然返回相同结果的东西，请分享！谢谢你，享受！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T20:16:18.207

我认为正则表达式应该是*([^0-9][.][^0-9])[\s]* *

```
preg_replace('/([^0-9]['.$punctuation.'][^0-9])[\s]*/', '\1 ', $string) 
```

[链接到正则表达式测试](http://regexpal.com/?flags=g&regex=%28%5B%5E0-9%5D%5B%5C.%5D%5B%5E0-9%5D%29%5B%5Cs%5D%2a&input=asdklfm%20asdlkfmasd%20.%20dsfsf%20dsf%20.df%20df%20df%20.%20df%20%20df%20dffff.fffdf%20df%20d%202323.234434%20-2323.343%0A%0A44%20sdsd.d%20sd%20sd%20%20.%20dsdsd%20sd.%20s%20dsdsdsd.d.dsd.s%20%20%20%20%20%20%20.%20%20%20%20%20%20%20%20%20%20%20sdsd.sdd%20dsf%20%0A%0A%0Asdsf%202323.%20sad%20sad%202323.3233%20asa.as)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T20:28:46.960

这有点复杂，但它应该让你朝着正确的方向前进：

```
<?php

// The following finds all commas in $string and identifies which comma is preceded and followed by a number

$string = 'Hello, my name, is John,Doe. I have 3,425 cats.';

function strpos_r($haystack, $needle)
{
    if(strlen($needle) > strlen($haystack))
        trigger_error(sprintf("%s: length of argument 2 must be <= argument 1", __FUNCTION__), E_USER_WARNING);

    $seeks = array();
    while($seek = strrpos($haystack, $needle))
    {
        array_push($seeks, $seek);
        $haystack = substr($haystack, 0, $seek);
    }
    return $seeks;
}

var_dump($commas = strpos_r($string, ',')); // gives you the location of all commas

for ($i = 0; i <= count($commas) - 1; $i++)
{
    if (is_numeric($commas[$i] - 1) && is_numeric($commas[$i] + 1)) 
    {
      // this means the characters before and after a given comma are numeric
      // don't add space (or delete the space) here

    }
} 
```

# java - Java 当我将参数传递给此方法时，在方法中的任何代码执行之前，它被错误地除以我的常量之一

> ID：12125211
> 
> 赞同：1
> 
> 时间：2012-08-25T19:58:34.347
> 
> 标签：java, methods, divide

我有一个类，旨在成为一个非常简单的游戏内关卡编辑器，用于由 Sprites 下的平铺图像组成的 2D 游戏。我正在调试的代码的目的是根据用户单击的位置更新 StringBuffer 中的字符，以更改在单击位置显示的图块。

程序将正在修改的字符串缓冲区用作地图，以识别应在哪个图块上绘制哪些图像。缓冲区中使用的每个 char 值将代表 1 个图块，char 的值决定在那里显示哪个图像。为此，我将一个常量整数（public static final int TILE_SIZE）定义为 40。我的图块都是大小为 40 x 40 像素的正方形，因此该常量用于帮助计算需要通过图像调整的任何内容宽度和高度。

问题是这样的：每当用户点击屏幕时，传递给更新我的 StringBuffer 的方法的鼠标的 x 和 y 值在方法中的任何代码执行之前都除以 40。

以下是相关代码：

```
 private void modifyGeometry(int x, int y, char tile){
        //Levels are 20x20 grids
        int xIndex=x;//The value of the index we will read based on x
        int yIndex=y;//The value of the index we will read based on y

        if(x<21*TILE_SIZE && y<21*TILE_SIZE){//For safety reasons, check that the x and y aren't somehow greater than the screen

        xIndex=xIndex/TILE_SIZE;//Factor x down to which tile in the row it is on

        yIndex=yIndex/TILE_SIZE;//Factor y down to which tile in the column it is on

        if(xIndex>19){//We will need to reduce the value of x if its factor based on the TILE_SIZE is greater than 19 (a row is 0-19)
            int storetemp=xIndex/20;
            xIndex=xIndex-(20*storetemp);//Because xIndex is an int, xIndex/20*20 does not come out to xIndex, but instead only the first digit of xIndex (0-9)
        }

        if(y>19){
            int storetemp=yIndex/20;
            yIndex=yIndex-(20*storetemp);
        }
    }

    int index=xIndex+yIndex;
    this.geometry.setCharAt(index, tile);//This will set the character corresponding to the point the player clicked to the tile selected
    } 
```

...

```
private class MouseInput extends MouseAdapter{
    public void mouseClicked(MouseEvent e){
        if(layer==0){
            modifyGeometry(e.getX(),e.getY(),currentTile);
        } 
```

我在 Eclipse 的调试器中使用了一些断点来确定 e.getX() 和 e.getY() 获得了正确的坐标（我对此毫无疑问），但在 int xIndex=x 甚至通过之前，x 和y 除以常数 (40)。在传递的变量和接收它们的方法之间没有调用我写的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T20:06:07.263

我*非常*怀疑这里发生了什么神奇的事情。选项：

*   您的诊断错误
*   您实际上并没有运行您认为正在运行的代码，例如由于构建已过时
*   如果您使用 AOP 或其他修改字节码的东西，*那*可能会产生影响

我会添加一些日志记录而不是依赖调试器。例如：

```
private class MouseInput extends MouseAdapter{
    public void mouseClicked(MouseEvent e){
        if(layer==0){
            int x = e.getX();
            int y = e.getY();
            log.info("About to modify geometry; x=" + x + "; y=" + y);
            modifyGeometry(x, y, currentTile);
        }
    }
} 
```

和：

```
private void modifyGeometry(int x, int y, char tile) {
    log.info("Within modifyGeometry; x=" + x + "; y="+ y);
    ...
} 
```

我会*惊讶*地发现这些日志行显示不同的值。

我还要补充一点，进一步除以 20 的业务非常令人困惑，并建议实际上您应该能够显着简化您的设计。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T20:01:39.190

从您的断点开始，查看 modifyGeometry 的调用者，并追溯传入的 x 和 y 的派生。

如果您不知道如何执行此操作... 在调试视图中，您将看到一棵树，其中包含看起来像堆栈跟踪的内容。最初显示的行下方的行给出了调用者的姓名。单击该行，您将看到调用 modifyGeometry 的行。变量视图将显示调用者中的变量。

# tablesorter - stickyHeader 覆盖哈希链接的目标行

> ID：12125213
> 
> 赞同：1
> 
> 时间：2012-08-25T19:59:00.860
> 
> 标签：tablesorter

当 URL 包含哈希时，tablesorter 上的 stickyHeaders 小部件覆盖表格的第一行时遇到问题。

例如 living.php?tab=1#sacramento1

该页面显示正确的选项卡并跳转到正确的行，但标题显示在该行上方。

为了解决这个问题，如果 url 中有哈希，我一直在禁用 stickyHeader 小部件

这就是我正在做的事情：

```
<script type="text/javascript">$(document).ready(function() 
{ 
  //CHECK for hash. don't want sticky headers with hash
  if (window.location.hash) {
    var workingID = window.location.hash;
    tid=workingID.substr(1,workingID.length);
    document.getElementById(tid).setAttribute("class", "showRow");
    // extend the default setting to always include the zebra widget. 
    $.tablesorter.defaults.widgets = ['zebra'];
  } else {
    // extend the default setting to always include the zebra widget and the sticky headers. 
    $.tablesorter.defaults.widgets = ['zebra','stickyHeaders'];
  }
  // extend the default setting to always sort on the first column 
    $.tablesorter.defaults.sortList = [[0,0]]; 
    // call the tablesorter plugin 
    $("table").tablesorter();   
} 
```

);

有没有办法让stickyHeaders 识别哈希行并将其显示在标题下方？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T03:01:41.210

尝试添加此代码（[演示](http://jsfiddle.net/Mottie/eY8uH/149/)）：

```
$('a').click(function(){
    if (this.hash !== "") {
        window.location.hash = this.hash;
        // find table that link is inside
        var $table = $(this).closest('table'),
            // get stickheader height + a little extra,
            // if the link is in a table & table has a stickyheader...
            shHeight = ( $table.find('.tablesorter-stickyHeader').parent().height() || 0 ) * 1.2;
        // move the anchor below the sticky header
        $(window).scrollTop( $(window).scrollTop() - shHeight);
        // prevent anchor from controlling the scrollTop
        return false;
    }
}); 
```

​</p>

# android - 同一应用程序的两个进程之间的共享首选项

> ID：12125214
> 
> 赞同：25
> 
> 时间：2012-08-25T19:59:29.300
> 
> 标签：android, sharedpreferences, android-service

我正在编写一个包含 UI 和运行的单独进程的 Android 应用程序。我想在主进程和在我的应用程序中定义的在不同进程中执行的服务之间共享简单信息。为此，我发现使用 AIDL 进行进程间通信很麻烦。

问题是：使用应用程序的 Shared Preferences 在这两个进程之间进行通信是否安全？这是：读取和写入相同的共享首选项。

我想知道它是否真的有效。在有关共享首选项的 android 开发人员参考 (http://developer.android.com/reference/android/content/SharedPreferences.html) 中，他们声明：*注意：目前此类不支持跨多个进程使用。这将在稍后添加。*但我不知道这到底是什么意思。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-08-27T14:53:13.083

在 Android < 2.3 中它可以工作。一个进程可以写入更改，而另一个进程可以读取更改。读取/写入共享首选项文件的代码（它们实际上存储在文件中）检查在读取/写入之前是否对文件进行了任何更改，并相应地更新其缓存版本。

在 Android > 2.3 中它可以工作，但您需要`MODE_MULTI_PROCESS`在调用时专门设置`getSharedPreferences()`.

在 Android 2.3 中，它已损坏并且无法正常工作:-(

请注意，在[API Level 23 (Android M)](https://developer.android.com/reference/android/content/Context.html#MODE_MULTI_PROCESS)`MODE_MULTI_PROCESS`中已弃用。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-08-27T14:20:14.890

您可以查看[https://github.com/hamsterksu/MultiprocessPreferences](https://github.com/hamsterksu/MultiprocessPreferences)库，该库提供了类似 SharedPreferences 的 API，用于通过 ContentProvider 访问 SharedPreferences 数据。在 Google 从 Android 6 中删除 MODE_MULTI_PROCESS 之后，它看起来也是一个不错的替代品。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-09T13:04:16.120

不; 这样做是不安全的。你引用的注释是正确的。如果您尝试`SharedPreferences`跨多个进程使用，可能会出现已知问题。（见[https://code.google.com/p/android/issues/detail?id=66625](https://code.google.com/p/android/issues/detail?id=66625)。）

如果您想要更多证据，请查看 的源代码`SharedPreferencesImpl`，尤其是保存首选项的部分。

我通过阻止两个进程同时访问`SharedPreferences`文件来解决这个问题。（这是[提供跨进程锁定的一种方法](https://stackoverflow.com/a/29361462/238753)，这是[我编写的完整示例实现](https://github.com/sampalmer/android-auto-rotate/tree/master/app/src/main/java/samuelpalmer/sensorautorotation/settings/application/multiprocess)。）

**警告**：不幸的是，`MODE_MULTI_PROCESS`它在 Android M 中已被弃用，因此它可能会在以后的版本中停止工作。诸如使用 a 之类的替代技术`ContentProvider`可能是更好的选择。

# php - 如何从数组中获取值？

> ID：12125219
> 
> 赞同：0
> 
> 时间：2012-08-25T19:59:53.927
> 
> 标签：php, mysql, arrays

我正在使用 MySQL PHP 类从表中获取最大 id。

```
$sql="SELECT MAX(id) FROM `".TABLE_CUSTOMERS."`";
$rows = $db->fetch_array($sql); 
```

现在我想使用那个最大 id 作为值并给它加 1。

```
$maxid=rows[0];
$newid=maxid+1; 
```

上面的代码不起作用。

如果我在 $maxid 上执行 print_r，我会得到：

```
( [MAX(id)] => 5 ) 
```

在那个 MySQL PHP Class 之前，我曾经这样做过：

```
$MaxID = mysql_query("SELECT MAX(face_id) FROM `".$DBprefix."faces`");
$MaxID = mysql_fetch_array($MaxID, MYSQL_BOTH);
$MaxID = $MaxID[0];
$newid=$MaxID+1; 
```

这没有问题

这是 fetch_array 函数：

```
public function fetch_array($sql){
 $query_id = $this->query($sql);
 $out = array();

 while ($row = $this->fetch($query_id)){
  $out[] = $row;
 }

 $this->free_result($query_id);
 return $out;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T20:01:57.403

使用此代码：

```
$maxid=$rows['MAX(id)'];
$newid=$maxid+1; 
```

我希望它有帮助；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T20:04:28.743

尝试使用别名来定义最大值；

```
$sql="SELECT MAX(id) as `max` FROM `".TABLE_CUSTOMERS."`"; 
```

并且您应该能够在以下位置检索最大值：

```
$rows[0]['max']; 
```

所以加1：

```
$newId = $rows[0]['max']+1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T20:35:06.980

那这个呢？

```
$sql="SELECT (MAX(id) + 1) AS max FROM `".TABLE_CUSTOMERS."`"; 
```

# iphone - 优化调色板映射着色器

> ID：12125223
> 
> 赞同：0
> 
> 时间：2012-08-25T20:00:25.353
> 
> 标签：iphone, opengl-es, glsl

我正在尝试优化用 GLSL（在 iPhone 上运行）编写的调色板映射着色器。我的实现当然很幼稚，但我对 OpenGL 完全陌生......这是它的外观摘要：

```
#define COLOR_BLACK vec4(0.0, 0.0, 0.0, 1.0)
#define COLOR_WHITE vec4(1.0, 1.0, 1.0, 1.0)
(... total of 16 colors)

highp vec4 color = texture2D(inputImageTexture, samplePos );

highp float distances[16];
distances[0] = distance(color, COLOR_BLACK);
distances[1] = distance(color, COLOR_WHITE);
(... total of 16 distance calculations)

(... find smallest colour distance)

mediump vec4 finalColor;
if (colorDistance == distances[0]) {
    finalColor = COLOR_BLACK;
} else if (colorDistance == distances[1]) {
    finalColor = COLOR_WHITE;
(... total of 16 comparisons)

gl_FragColor = finalColor; 
```

这工作正常，但它相当慢。我确定我在这里没有有效地使用 OpenGL :)

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T20:02:26.170

使用最近过滤模式下的（小）3D 纹理作为查找表。

### 因评论而更新

如果 3D 纹理不可用，您可以使用更大尺寸的 1D 纹理，再次以最近的过滤模式，并以与在平面数组中处理它们相同的方式处理 3D 纹素，即

```
texel_index(x,y,z) = x*width*height + y*width + z; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T20:09:44.700

实现这种效果的另一种方法是通过舍入/地板。所以你得到（未经测试）：

```
highp vec4 color = texture2D(inputImageTexture, samplePos );
gl_FragColor = floor(color*2.0) * 0.5; 
```

您可能想玩弄因素 2。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T20:16:38.670

您要映射到哪种调色板？它只是十六种随机颜色还是它们有图案？

假设这 16 种颜色是八种颜色加上亮或暗，那么您可以将传入的 RGB 转换为 YUV（或任何其他面向亮度的空间），在 Y 通道上进行单一判断，然后通过以下方式将 UV 转换为 2d 测试单个纹理查找。如果红色、绿色和蓝色的八种颜色打开或关闭，则无需查找即可进行 2d 测试。

如果你只是想要一个离散的外观，那么像 Jaxan 的rounding-within-components 可能是最聪明的事情。

# powershell - 这个结构在powershell中是什么意思：${c:a.txt}

> ID：12125225
> 
> 赞同：5
> 
> 时间：2012-08-25T20:00:35.150
> 
> 标签：powershell

我是PowerShell的新手。这个结构在powershell中是什么意思：${c:a.txt}

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-25T20:07:12.467

来自[Powershell 脚本](http://en.wikipedia.org/wiki/Windows_PowerShell#Scripting)：

> 根据变量语法，如果文件的路径用大括号括起来，前面有一个美元符号（如 ${C:\foo.txt}），它指的是文件的内容。如果将其用作 L 值，则分配给它的任何内容都将写入文件。当用作 R 值时，将从文件中读取。如果分配了对象，则在存储之前对其进行序列化。

# sql - SQL 在一个语句中搜索表两次：我收到错误 - 'on 子句'中的未知列'statut_comments.id_client'

> ID：12125227
> 
> 赞同：0
> 
> 时间：2012-08-25T20:00:50.803
> 
> 标签：sql, select, inner-join

有人可以帮我处理这个 SQL，因为我看到错误消息为未知列，我知道该列在那里？

```
SELECT 
   statut.*, 
   clien_1.Id, clien_1.mail, clien_1.nom, clien_1.prenom, 
   image_profil_1.image, 
   statut_comments.*, 
   clien_2.Id, clien_2.mail, clien_2.nom, clien_2.prenom, 
   image_profil_2.image  
FROM  
    statut
INNER JOIN 
    clien AS clien_1 ON statut.client_from = clien_1.Id
INNER JOIN  
    clien AS clien_2 ON statut_comments.id_client = clien_2.Id
INNER JOIN  
    statut_comments ON statut_comments.comment_id = statut.id
INNER JOIN 
    image_profil AS image_profil_1 ON image_profil_1.mail = clien_1.Id 
INNER JOIN 
    image_profil AS  image_profil_2 ON image_profil_2.mail = clients_2.Id 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T20:16:52.937

问题在于您的内部连接的顺序 - 您在加入之前使用 blog_statut_comments。

尝试更改连接的顺序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T21:16:47.900

正如 Fiona 已经指出的那样 - 您指`statut_comments`的是在它被添加到连接表列表之前。不确定我是否“明白了” - 这是一个直观的解释：

![在此处输入图像描述](../Images/2d6b94dc31bb0858a19bf97534c44590.png)

你基本上需要改变你的顺序`JOINs`：

```
SELECT 
   (your list of columns)
FROM  
    statut
INNER JOIN     -- include the "status_comments" *BEFORE* refering to it!
    statut_comments ON statut_comments.comment_id = statut.id
INNER JOIN 
    clien AS clien_1 ON statut.client_from = clien_1.Id
INNER JOIN  
    clien AS clien_2 ON statut_comments.id_client = clien_2.Id
INNER JOIN 
    image_profil AS image_profil_1 ON image_profil_1.mail = clien_1.Id 
INNER JOIN 
    image_profil AS  image_profil_2 ON image_profil_2.mail = clients_2.Id 
```

# image - 可以使用谷歌分析跟踪 .png/.jpeg 链接访问吗？

> ID：12125230
> 
> 赞同：0
> 
> 时间：2012-08-25T20:01:15.303
> 
> 标签：image, google-analytics, tracking

我有一个为 Internet 提供图像的网站，并且我实施了 Google 分析，但只跟踪页面访问而不是链接访问，如下例所示：

您可以访问[http://doamin.com/aa](http://doamin.com/aa)的图像，它会显示一个带有模板和已实现图像的 html 页面。

如果可能的话，A 希望 Google 分析跟踪[http://doamin.com/aa.png](http://doamin.com/aa.png)以及在其他网站上打开时的图像。

我来自巴西，所以如果你也是，请用葡萄牙语回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T20:07:38.727

分析从加载到页面中的一些 javascript 工作，以“我在这里，我在一个页面上执行以下操作......”回调谷歌。由于脚本不在图像中，它不能做同样的事情。您只需要分析您的网络日志。有[很多工具可以做到这一点](http://www.google.com/search?q=web%20log%20analysers)，或者你可以 grep 日志，编写一个自定义应用程序来找到你需要的信息等。它不会像分析那样丰富或用户友好，但你仍然有很多可以查到。

# shell - 提取网页上所有图像列表的脚本（网页抓取代码）

> ID：12125232
> 
> 赞同：4
> 
> 时间：2012-08-25T20:01:30.117
> 
> 标签：shell, scripting

我想要一个可以提取`*.jpg`网页上所有图像（例如）列表的脚本，即以`.jpg`

使用此脚本，我将使用管道输出到文件`>`，然后使用管道输出作为`wget`.

这可以使用shell脚本吗？

（编辑：我正在使用`bash`外壳）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T21:37:32.883

怎么用[`lynx`](http://linux.die.net/man/1/lynx)？

```
lynx -image_links -dump www.google.com |
    grep '\. https\?://.*\.\(gif\|jpg\|png\)$' 
```

要稍微清理一下输出，您可以使用[`cut`](http://linux.die.net/man/1/cut)：

```
lynx -image_links -dump www.google.com |
    grep '\. https\?://.*\.\(gif\|jpg\|png\)$' |
    cut -d . -f 2- |
    cut -d ' ' -f 2- 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T20:25:24.213

因为并不是所有的 shell 都提供开箱即用的 Web 连接（Windows shell 肯定没有），所以动态脚本语言（如 Ruby 或 Python）的解决方案可以跨平台工作。

下面是一些 Ruby 代码，当指向网页时，会在其中搜索 *.jpg，将它们全部列出，然后下载它们。（顺便说一句，它可以用于 PDF、PNG，任何你想要的，只需简单的修改。）

```
#  web page scraper that downloads jpgs (or easily PDFs, txt files, csvs, etc.)   AKE  (1/2009)

require 'net/http'

# take instructions from the command line

my_domain_name = ARGV[0]  # JUST the domain name
my_path = ARGV[1]         # the path separated on either end by /
my_filename = ARGV[2]     # the html filename

puts "Scraping #{my_domain_name + my_path + my_filename}"

response = "empty"  

Net::HTTP.start( my_domain_name ) do |http|
     response = http.get( my_path + my_filename ).body
 end

# writing scraped html into text file, for reference / debugging
open("scraped.txt", "wb") {|s|
  s.write(response)
}

 # parse the response  to make list of jpg files
 files = response.scan(/\w+.jpg/)

 # download each jpg
files.each do |file|
   image_filename = file
   puts "Writing #{image_filename}..."
   Net::HTTP.start(my_domain_name) do |http|
   jpg = http.get(file)
   open(image_filename, "wb") {|p|
     p.write(jpg.body)
   }
   end
   puts "Done!"
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-28T17:59:07.823

如果您实际上也想下载所有图像：

```
for i in `lynx -image_links -dump http://www.google.com | grep 'jpg\|gif' \
| grep http | awk '{print $2}'`; do wget $i; done 
```

# java - Html 抓取站点加载错误的 Jsoup Java

> ID：12125237
> 
> 赞同：0
> 
> 时间：2012-08-25T20:02:24.507
> 
> 标签：java, javascript, html, jsoup

我正在尝试运行一个脚本来从网站中提取信息，但是当我将实际网站与我的程序显示的网站进行比较时，它并不相同。

缺少的一些示例是开头！doctype 和公司信息 [http://www.manta.com/mb_43_E7_24/manufacturing/minnesota](http://www.manta.com/mb_43_E7_24/manufacturing/minnesota)

我不确定 javascript 是否是问题的一部分，我尝试将其关闭，但它仍然有效，但我也注意到其中有很多 javascript；该网站无需登录。也许是饼干？（我对饼干不太了解）

```
String keyword = "http://www.manta.com/mb_43_E7_24/manufacturing/minnesota.php";
Document doc = Jsoup.connect(keyword).referrer("http://www.google.com").userAgent("Mozilla/5.0 (Windows; U;     WindowsNT 5.1; en-US; rv1.8.1.6) Gecko/20070725 Firefox/2.0.0.6").get();
System.out.Println(doc.toString()); 
```

以上是我使用的代码

任何想法为什么它无法像我的浏览器那样加载我的页面？有一次我让它工作但我不小心把它弄坏了

如果该解决方案不是从网站提取信息的合理解决方案，您对解决方案有什么建议吗？

我做了更多的工作，发现它适用于[http://www.manta.com/](http://www.manta.com/)但如果我添加后缀字符串 /mb_43_E7_24/manufacturing/minnesota.php 则不行

无论如何都涉及后缀吗？

或者可能是该网站暂时禁止我进行太多请求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-05T14:09:41.073

Jsoup 不执行/呈现 Javascript。HTMLUnit 有一个无头浏览器，它呈现整个页面并将内容作为字符串返回。硒也很有用。Selenium 有用于 Firefox、Chrome、IE 和 HTMLUnit 的 WebDrivers。我使用下面的代码来执行 Javascript 并返回 html。我发现这对我希望在评论部分使用 Javascript 的新闻网站很有用。

```
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.htmlunit.HtmlUnitDriver;

public class Test{

  private WebDriver driver;
  private String output; 

  public Document getDocument(String input) {
    driver = new HTMLUnitDriver(true); //the param true turns on javascript.
    driver.get(input);
    output = driver.getPageSource();
    driver.quit();
    return Jsoup.parse(output);
  }
} 
```

上面的代码应该足以开始......

# javascript - 如何使 jquery-ui 小部件可拖动

> ID：12125242
> 
> 赞同：0
> 
> 时间：2012-08-25T20:03:17.010
> 
> 标签：javascript, jquery, jquery-ui

我需要澄清一些 jquery-ui 概念，并且可以使用您的帮助。

如果我执行以下操作：

```
$("<div></div>").draggable(); 
```

jquery-ui 将创建一个包装所选 div 的可拖动对象。但是，我已经创建了自己的小部件（使用`$.widget("namespace.mywidget"`），所以，我的第一个问题是，调用它时会发生什么？

```
$("<div></div>").draggable().mywidget(); 
```

我想接下来会出现混乱。无论如何，我想为拖动方法定义属性，所以我想把它放在我的小部件中。因此，第二个问题是：如何扩展 $.ui.draggable ？你有什么好的教程吗？简单地调用它似乎是不够的：

```
$.widget( "namespace.mywidget", $.ui.draggable, {} ); 
```

非常感谢您的任何见解！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T14:33:06.030

在使用 draggable 之前，请确保元素在 DOM 中：

```
$('<div></div>').appendTo(document.body) 
```

然后，您可以将您的小部件和可拖动的链接在一起：

```
 $('<div></div>').appendTo(document.body)
     .mywidget()
     .draggable(); 
```

您可以在每个小部件调用上设置您想要的任何参数。[我在jsfiddle.net/bseth99/LEY9A/](http://jsfiddle.net/bseth99/LEY9A/)创建了一个示例，它构建了一个简单的自定义 UI 小部件作为参考和演示目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T20:48:48.650

只需将其包含在您的插件中即可。确保在插件代码之前包含 jqueryUI。

```
(function($){
    $.fn.myWidget = function(){
        return this.each(function(){
            $(this).draggable();
        });

    };
})(jQuery)

$('<div></div>').myWidget();  // this should be draggable. 
```

[http://jsfiddle.net/gJ3CN/2/](http://jsfiddle.net/gJ3CN/2/)

# marshalling - 如何为 JAXB 2.0 编组编写单元测试

> ID：12125245
> 
> 赞同：13
> 
> 时间：2012-08-25T20:03:29.820
> 
> 标签：marshalling, junit4, jaxb2

我在不使用 XSD 的情况下使用 Jaxb 2.0 api，并使用注释创建了内容模型。我想为执行编组的类编写一个 Junit 测试。我最初的计划是将预期的 XML 字符串与断言的实际字符串进行比较（最明显的选择）。但我发现编组会创建属性/属性顺序不可预测的 xml（实际上我不知道默认顺序是什么）。现在，如果是这种情况，我不能假设一个预定义的 xml 字符串，然后将其与编组的字符串进行比较。我在考虑断言 marshaller 类的另一种方法如下：

1-创建内容模型。

2-马歇尔它。

3-解组在步骤 2 中创建的 xml 以获取模型。

4-在第 1 步和第 3 步对属性/属性进行基于模型的断言。

但我仍然不觉得这令人满意。在这种情况下编写用于编组的 Junit 测试的正确方法是什么？

虽然使用编组 xml 的实际应用程序不依赖于 xml 属性/属性顺序，但 Junit 测试似乎很棘手。

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-18T21:24:18.750

我在谷歌搜索同样的事情时偶然发现了你的问题。如果找到这篇[文章](http://codingbone.wordpress.com/2010/09/20/unit-testing-jaxb-marshalling-and-xjc-generated-classes/)，但不喜欢事后必须“解析”生成的 XML 的想法。在筛选了 JAXB Javadoc 之后，我找到了一种我非常喜欢的方法。JAXB`Marshaller`提供了一种将 SAX`ContentHandler`作为参数的方法。您可以模拟它`ContentHandler`并验证是否已使用预期参数调用了特定方法。

这是一个小例子。我编写了一个自定义`Attributes`匹配器，它只验证某些属性本地名称的存在，但不查看值（还）。我希望这个对你有用：

```
@Mock
private ContentHandler handler;

private JAXBContext context;
private ObjectFactory factory;
private Marshaller marshaller;

@Before
public void setUp() throws Exception
{
    context = JAXBContext.newInstance(getClass().getPackage().getName());
    factory = new ObjectFactory();
    marshaller = context.createMarshaller();
}

@Test
public void test() throws Exception
{
    final UpdateDescription description = new UpdateDescription("identifier", "version");
    final JAXBElement<UpdateDescription> element = factory.createUpdateDescription(description);

    marshaller.marshal(element, handler);

    verify(handler).startDocument();
    verify(handler).startElement(anyString(), eq("description"), anyString(), any(Attributes.class));
    verify(handler).startElement(anyString(), eq("identifier"), anyString(), attrs("value"));
    verify(handler).startElement(anyString(), eq("version"), anyString(), attrs("value"));
    verify(handler).endDocument();
}

private static Attributes attrs(final String... localNames)
{
    final Matcher<Attributes> matcher = new TypeSafeMatcher<Attributes>()
    {
        private Set<String> names = Sets.<String> newHashSet(localNames);

        @Override
        public void describeTo(final Description description)
        {
            // TODO Auto-generated method stub
        }

        @Override
        public boolean matchesSafely(final Attributes item)
        {
            final Set<String> presentLocalNames = Sets.newHashSetWithExpectedSize(item.getLength());
            final int length = item.getLength();
            for (int i = 0; i < length; ++i) {
                presentLocalNames.add(item.getLocalName(i));
            }

            return Sets.difference(names, presentLocalNames).isEmpty();
        }
    };
    return new ThreadSafeMockingProgress().getArgumentMatcherStorage().reportMatcher(matcher).returnFor(
            new AttributesImpl());
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-07-18T18:40:00.467

对于那些喜欢更简单测试的人，这是我从 RobertB 的答案中链接的帖子中汇总的内容，以及[此处](https://stackoverflow.com/questions/819720/no-xmlrootelement-generated-by-jaxb)的答案：

```
import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;

import javax.xml.bind.JAXBContext;
import javax.xml.bind.JAXBElement;
import javax.xml.bind.JAXBException;
import javax.xml.bind.Marshaller;
import javax.xml.bind.Unmarshaller;
import javax.xml.namespace.QName;
import javax.xml.transform.stream.StreamSource;

public class JaxbTestHelper {

    @SuppressWarnings({ "rawtypes", "unchecked" })
    public static Object jaxbMarshalUnmarshal(Object schemaObject) throws Exception {
        JAXBContext context = JAXBContext.newInstance(schemaObject.getClass());
        Marshaller marshaller = context.createMarshaller();
        Unmarshaller unmarshaller = context.createUnmarshaller();
        ByteArrayOutputStream output = new ByteArrayOutputStream();
        Object unmarshalledObject = null;

        try {
            marshaller.marshal(schemaObject, output);
            ByteArrayInputStream input = new ByteArrayInputStream(output.toByteArray());
            unmarshalledObject = unmarshaller.unmarshal(input);
        } catch (JAXBException e) {
            // object class not annotated with @XmlRootElement, so we have to "wrap" and "unwrap" the object
            marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, Boolean.TRUE);
            marshaller.marshal(new JAXBElement(new QName("uri", "local"), schemaObject.getClass(), schemaObject),
                    output);

            StreamSource source = new StreamSource(new ByteArrayInputStream(output.toByteArray()));
            unmarshalledObject = unmarshaller.unmarshal(source, schemaObject.getClass()).getValue();
        }

        // callers should verify this returned object equals the schema object passed in
        // ie, mySchemaObject.equals(jaxbMarshalUnmarshal(mySchemaObject))
        return unmarshalledObject;
    }

} 
```

[单元测试](/questions/tagged/unit-testing "显示标记为“单元测试”的问题")[jaxb](/questions/tagged/jaxb "显示标记为“jaxb”的问题")[解组](/questions/tagged/unmarshalling "显示标记为“解组”的问题")

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-06-13T00:51:20.793

我遇到了同样的 XML 编组测试问题。您可以使用[XmlUnit](http://www.xmlunit.org/)库将您的序列化 xml 与标准具进行比较。XmlUnit 可以比较两个 xml 并支持忽略空间、元素重新排序等功能。

这是 IBM developerWorks[关于 XmlUnit](http://www.ibm.com/developerworks/java/library/j-cq121906/index.html)的好文章，
虽然描述的是旧版本的 XmlUnit，但它提供了很好的解释和示例。

比较 xml 可能如下所示：

```
Diff diff = DiffBuilder
            .compare(expectXml)
            .withTest(marshaledXml)
            //Ignore element order
            .withNodeMatcher(new DefaultNodeMatcher(ElementSelectors.byName))
            .ignoreWhitespace()
            .ignoreComments()
            .checkForSimilar()
            .build()

    assert !diff.hasDifferences() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T05:48:03.110

实际上，您可以编写预期结果来与 jaxb 生成的结果进行比较，不要忘记在预期结果的末尾添加“\n”，这可能会导致断言错误

# playframework-2.0 - Play 2.0 从 Java 中的 FakeApplication 访问 play 的默认 Akka 演员系统

> ID：12125246
> 
> 赞同：0
> 
> 时间：2012-08-25T20:03:30.663
> 
> 标签：playframework-2.0, akka

我正在编写一个测试用例来测试 akka 演员。但是，我必须在假应用程序之外创建一个单独的 Akka 系统。有没有办法从 FakeApplication 获取 akka 演员系统？

```
public class ChannelWorkerTest {

    private TestActorRef<ChannelWorker> actorRef;
    private ActorSystem actorSystem;

    @Before
    public void initActor() {
        actorSystem = ActorSystem.apply();
        actorRef = TestActorRef.apply(new Props(ChannelWorker.class), actorSystem);
    }

    @Test
    public void calculatePiFor1() {
        running(fakeApplication(TestConf.getConf()), new Runnable() {
            public void run() {
              TestProbe testProbe = TestProbe.apply(actorSystem);
              .....
              actorRef.tell(aMessage, testProbe.ref());
              }
        });
    }

    @After
    public void shutdownActorSystem() {
        actorSystem.shutdown();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T14:35:28.273

您可以尝试使用静态方法获取 Akka 演员系统`Akka.system()`。

但我认为它不适用于 FakeApplication，您可能需要使用[testServer() 助手](https://github.com/playframework/Play20/wiki/JavaFunctionalTest)启动 Play 服务器：

```
@Test
public void testInServer() {
  running(testServer(3333), new Runnable() {
      public void run() {
         ActorSystem  actorSystem = Akka.system();
         // do whatever you need
      }
  });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:49:52.903

这就是我所做的。

```
public class MyHelpers extends Helpers {

    /**
     * Build a new fake application.
     */
    public static MyFakeApplication myFakeApplication(Map<String,String> additionalConfiguration,
        List<String> withoutPlugins, List<String> additionalPlugin) {
        return new MyFakeApplication(new java.io.File("."), MyHelpers.class.getClassLoader(),
            additionalConfiguration, withoutPlugins, additionalPlugin);
    }

    /**
     * Executes a block of code in a running application.
     */
    public static void myRunning(MyFakeApplication fakeApplication, final Runnable block) {
    try {
        myStart(fakeApplication);
        block.run();
    } finally {
        myStop(fakeApplication);
            play.core.Invoker$.MODULE$.system().shutdown();
            play.core.Invoker$.MODULE$.uninit();
    }
    }
}

public class ChannelWorkerTest {
    private MyFakeApplication app;
    private TestActorRef<ChannelWorker> actorRef;
    private ActorSystem actorSystem;

    @Before
    public void initTest() {
    app = myFakeApplication(TestConf.getConf(), withoutPlugins, additionalPlugins);
        actorSystem = play.api.libs.concurrent.Akka.system(app.getWrappedApplication());
        actorRef = TestActorRef.apply(new Props(new UntypedActorFactory() {
            public UntypedActor create() {
                return new MessageMaster(Config.NUMBER_OF_WORKER_ACTOR);
            }
        }), actorSystem);
    }

    @Test
    public void calculatePiFor1() {
        running(fakeApplication(TestConf.getConf()), new Runnable() {
            public void run() {
                 TestProbe testProbe = TestProbe.apply(actorSystem);
                 actorRef.tell("Hello", testProbe.ref());
                 testProbe.expectNoMsg(Duration.apply(100, TimeUnit.MILLISECONDS));
              }
        });
    }

    @After
    public void shutdownActorSystem() {
        actorSystem.shutdown();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T16:54:13.760

我只是在 scala 测试中做到了这一点。但是你必须在运行块内初始化actor。我猜它在 java 中的工作原理是一样的——但我还没有在 java 中测试过它。我不需要实际启动 Web 服务器。

# objective-c - Gesture Not Recognized on subview

> ID：12125247
> 
> 赞同：1
> 
> 时间：2012-08-25T20:03:51.933
> 
> 标签：objective-c, ios

I am trying recognize gestures in a subview. I only get response when i define the gestureRecognizer in the superview. I wanted to know why i am not getting the gestutre response when i define it with in the subview which in my case is 'View.m', although i get response when i define the gestureHandler in the superview which in my case is the view of ViewController but i want why it isnt working in subview. The Code Will Make it more clear. Also the gestures arent recognized during Animation as in my case im moving the subview from left to right in my 'view.m' and when i click during animation gestures arent recognized . i have tried UIViewAnimationOptionAllowUserInteraction but still no gestures are recognized.

This is the SubView Class With a TapgesturHandler

```
//  View.m
//  GestrureonImageView
//
//  Created by Noman Khan on 8/24/12.
//  Copyright (c) 2012 __MyCompanyName__. All rights reserved.
//

#import "View.h"

@implementation View

- (id)initWithFrame:(CGRect)frame
{

    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
    }

    UITapGestureRecognizer *tapGestures=[[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(gesturesCallBack:)];

    // NSLog(@"init gestures");

    [tapGestures setDelegate:self];

    // Set required taps and number of touches
    [tapGestures setNumberOfTapsRequired:1];
    [tapGestures setNumberOfTouchesRequired:1];
    [self addGestureRecognizer:tapGestures];
    return self;
}
-(void) gesturesCallBack:(UITapGestureRecognizer *)sender 
{
    NSLog(@"abcView");
    [UIView animateWithDuration:10 

                          delay:0.1
                        options:UIViewAnimationOptionAllowUserInteraction
                     animations:^
     {
         // [self initGestures];
         CGAffineTransform transform = CGAffineTransformMakeTranslation(500,0);

         self.transform = transform;
     }
                     completion:^(BOOL finished){

                     }];   

}

-(void)viewDidLoad{

    NSLog(@"Inview");

}

/*
// Only override drawRect: if you perform custom drawing.
// An empty implementation adversely affects performance during animation.
- (void)drawRect:(CGRect)rect
{
    // Drawing code
}
*/

@end 
```

And View.h

```
//  View.h
//  GestrureonImageView
//
//  Created by Noman Khan on 8/24/12.
//  Copyright (c) 2012 __MyCompanyName__. All rights reserved.
//

#import <UIKit/UIKit.h>

@interface View : UIView<UIGestureRecognizerDelegate>

@end 
```

This is ViewController.m class

```
//  ViewController.m
//  GestrureonImageView
//
//  Created by Noman Khan on 8/24/12.
//  Copyright (c) 2012 __MyCompanyName__. All rights reserved.
//

#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController
@synthesize v;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

-(void) gesturesCallBack:(UITapGestureRecognizer *)sender 
{
    NSLog(@"abc");

}

- (void)viewDidLoad
{
    [super viewDidLoad];
    [self.view setBackgroundColor:[UIColor blueColor]];

    UITapGestureRecognizer *tapGestures=[[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(gesturesCallBack:)];

   // NSLog(@"init gestures");

    [tapGestures setDelegate:self];

    // Set required taps and number of touches
    [tapGestures setNumberOfTapsRequired:1];
    [tapGestures setNumberOfTouchesRequired:1];

    [self.view addGestureRecognizer:tapGestures];
    v=[[View alloc]initWithFrame:CGRectMake(40, 50, 80, 50)];
    v.backgroundColor=[UIColor yellowColor];
//    [v addGestureRecognizer:tapGestures];    
    [self.view addSubview:v];

    // Do any additional setup after loading the view.
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

@end 
```

this is my ViewController.h

```
//  ViewController.h
//  GestrureonImageView
//
//  Created by Noman Khan on 8/24/12.
//  Copyright (c) 2012 __MyCompanyName__. All rights reserved.
//

#import <UIKit/UIKit.h>
#import "View.h"

@interface ViewController : UIViewController <UIGestureRecognizerDelegate>

@property(nonatomic,strong)View *v;

@end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T20:31:15.907

Just try setting `v.userInteractionEnabled = YES`

# eclipse - 尝试在 Cocos2d-X 中切换场景。未定义对 `diffMenu::scene() 错误的引用

> ID：12125248
> 
> 赞同：2
> 
> 时间：2012-08-25T20:04:18.090
> 
> 标签：eclipse, cocos2d-x, undefined-reference, scene

所以我试图用一个名为“diffMenu”的难度菜单场景来替换 HelloWorld 场景。它在 XCode 上运行良好，所以我转到 Eclipse 来测试 Android 端并得到一个错误，上面写着“对 `diffMenu::scene() 的未定义引用”我已将 diffMenu.ccp 添加到 Android.mk 但我仍然得到错误。

```
Android.mk

LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)

LOCAL_MODULE := game_shared

LOCAL_MODULE_FILENAME := libgame

LOCAL_SRC_FILES := helloworld/main.cpp \
               ../../Classes/AppDelegate.cpp \
               ../../Classes/HelloWorldScene.cpp \
               ../../Classes/diffMenu.ccp

LOCAL_C_INCLUDES := $(LOCAL_PATH)/../../Classes                   

LOCAL_WHOLE_STATIC_LIBRARIES := cocos2dx_static cocosdenshion_static

include $(BUILD_SHARED_LIBRARY)

$(call import-module,CocosDenshion/android) $(call import-module,cocos2dx)

HelloWorldScene.ccp

#include "HelloWorldScene.h"
#include <sys/time.h>

#include "diffMenu.h"
USING_NS_CC; 

//using namespace CocosDenshion ;

CCScene* HelloWorld::scene()
{
    // 'scene' is an autorelease object
    CCScene *scene = CCScene::create();

    // 'layer' is an autorelease object
    HelloWorld *layer = HelloWorld::create();

    // add layer as a child to scene
    scene->addChild(layer);

    // return the scene
    return scene;
 }

    // on "init" you need to initialize your instance
    bool HelloWorld::init()
    {
        //////////////////////////////
        // 1\. super init first
        if ( !CCLayer::init() )
        {
             return false;
        }

    CCSize size = CCDirector::sharedDirector()->getWinSize();
    CCSprite* background = CCSprite::create("menuBackground.jpg");
    //-------------------Background
    background->setPosition(ccp(170, 240));
    this->addChild(background, -1);

    //-------------------Green Play Now
    CCLabelTTF *playLabel = CCLabelTTF::create("Play Now", "American Typewriter", 40.0);
    CCMenuItemLabel *playNow = CCMenuItemLabel::create(playLabel, this,     menu_selector(HelloWorld::play));
    playNow->setPosition(ccp(0, 50));
    playNow->setColor(ccc3(0, 255, 0));

    //-------------------White Difficulty
    CCLabelTTF *diffLabel = CCLabelTTF::create("Difficulty", "American Typewriter", 40.0);
    CCMenuItemLabel *difficulty = CCMenuItemLabel::create(diffLabel, this,     menu_selector(HelloWorld::diff));
    difficulty->setPosition(ccp(0, -25));
     difficulty->setColor(ccc3(255, 255, 255));

    //-------------------White Language
    CCLabelTTF *langLabel = CCLabelTTF::create("Language", "American Typewriter", 40.0);
    CCMenuItemLabel *language = CCMenuItemLabel::create(langLabel, this,     menu_selector(HelloWorld::lang));
    language->setPosition(ccp(0, -100));
    language->setColor(ccc3(255, 0, 0));

    //-------------------Red Credits
    CCLabelTTF *credLabel = CCLabelTTF::create("Credits", "American Typewriter", 40.0);
    CCMenuItemLabel *credits = CCMenuItemLabel::create(credLabel, this,      menu_selector(HelloWorld::cred));
    credits->setPosition(ccp(0, -175));
    credits->setColor(ccc3(0, 0, 0));

    //-------------------Add Menu
    CCMenu *menu = CCMenu::create(playNow,difficulty,language,credits, NULL);
    this->addChild(menu,2) ;

    return true;
}
void HelloWorld::diff()
{

    CCDirector::sharedDirector()->setDepthTest(true);

    CCDirector::sharedDirector()->replaceScene(CCTransitionPageTurn::create(1.0f,       diffMenu::scene(), false));

}

void HelloWorld::play(){

}
void HelloWorld::cred(){

}

void HelloWorld::lang(){

}
void HelloWorld::menuCloseCallback(CCObject* pSender)
{
    CCDirector::sharedDirector()->end();

#if (CC_TARGET_PLATFORM == CC_PLATFORM_IOS)
    exit(0);
    #endif
}

diffMenu.h

#ifndef __diffMenu_SCENE_H__
#define __diffMenu_SCENE_H__

#include "cocos2d.h"
USING_NS_CC ;
class diffMenu : public cocos2d::CCLayer
{
public:
    // Here's a difference. Method 'init' in cocos2d-x returns bool, instead of returning      'id' in cocos2d-iphone
    virtual bool init();  

    // there's no 'id' in cpp, so we recommand to return the exactly class pointer
    static cocos2d::CCScene* scene();

    // a selector callback
    //void menuCloseCallback(CCObject* pSender);

    // implement the "static node()" method manually
    LAYER_CREATE_FUNC(diffMenu);

    void play();
    void diff();

};

#endif // __diffMenu_SCENE_H__

diffMenu.ccp

#include "SimpleAudioEngine.h"
#include "diffMenu.h"
using namespace cocos2d;
using namespace CocosDenshion;

CCScene* diffMenu::scene()
{
    // 'scene' is an autorelease object
    CCScene *scene = CCScene::create();

    // 'layer' is an autorelease object
    diffMenu *layer = diffMenu::create();

    // add layer as a child to scene
    scene->addChild(layer);

    // return the scene
    return scene;
}

// on "init" you need to initialize your instance
bool diffMenu::init()
{
//////////////////////////////
// 1\. super init first
if ( !CCLayer::init() )
{
    return false;
}

/////////////////////////////
// 2\. add a menu item with "X" image, which is clicked to quit the program
//    you may modify it.

// add a "close" icon to exit the progress. it's an autorelease object

    /////////////////////////////
    // 3\. add your codes below...

    // add a label shows "Hello World"
    // create and initialize a label
    CCLabelTTF* pLabel = CCLabelTTF::create("Hello World", "Thonburi", 34);

    // ask director the window size
    CCSize size = CCDirector::sharedDirector()->getWinSize();

    // position the label on the center of the screen
    pLabel->setPosition( ccp(size.width / 2, size.height - 20) );

    // add the label as a child to this layer
    this->addChild(pLabel, 1);

    // add "diffMenu" splash screen"
    CCSprite* pSprite = CCSprite::create("pencilBackground.jpg");
    pSprite->setScale(.7);
    pSprite->setRotation(-1);
    // position the sprite on the center of the screen
    pSprite->setPosition( ccp(size.width/2-80, size.height/2) );

    // add the sprite as a child to this layer
    this->addChild(pSprite, 0);

    return true;
}

/*void diffMenu::menuCloseCallback(CCObject* pSender)
{
    CCDirector::sharedDirector()->end();

#if (CC_TARGET_PLATFORM == CC_PLATFORM_IOS)
    exit(0);
#endif
}*/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T02:29:03.553

最后是拼写错误。它应该是

```
diffMenu.cpp 
```

不是

```
diffMenu.ccp 
```

在 Android.mk 中

# java - 与 jpa 2.0 和 GAE 数据存储的一对多关系

> ID：12125251
> 
> 赞同：1
> 
> 时间：2012-08-25T20:04:47.237
> 
> 标签：java, google-app-engine, jpa-2.0, datanucleus

我在理解如何在应用引擎上实现一对多无主关系时遇到问题。我目前遇到一个异常，我可以追溯到一个空列表。

```
@Entity
public class Inventory extends DatastoreObject {
    /**
     * List of all inventory items in this object.
     */
    @Unowned
    //@OneToMany(cascade = CascadeType.ALL)
    private List<InventoryItem> inventoryItems;
} 
```

这是我在尝试持久化实体时遇到的异常。

```
java.lang.IllegalArgumentException: A collection of values is required.
    at com.google.appengine.api.datastore.DataTypeUtils.checkSupportedValue(DataTypeUtils.java:157)
    at com.google.appengine.api.datastore.Query$FilterPredicate.<init>(Query.java:847)
    at com.google.appengine.api.datastore.Query$FilterOperator.of(Query.java:77)
    at com.google.appengine.api.datastore.Query.addFilter(Query.java:336)
    at com.google.appengine.datanucleus.scostore.FKListStore.getChildrenByKeys(FKListStore.java:383)
    at com.google.appengine.datanucleus.scostore.FKListStore.listIterator(FKListStore.java:360) 
```

似乎 datanucleus 正在使用 Filter IN 查询来获取 InventoryItem 子实体。该列表最初是空的并且不包含任何键，因此这破坏了我的检索。

这是我的 persistence.xml 文件中的一个尝试。

```
<exclude-unlisted-classes/>

<properties>
    <property name="datanucleus.NontransactionalRead" value="true"/>
    <property name="datanucleus.NontransactionalWrite" value="true"/>
    <property name="datanucleus.ConnectionURL" value="appengine"/>
    <property name="datanucleus.singletonEMFForName" value="true"/>
    <property name="datanucleus.appengine.relationDefault" value="unowned" />
    <property name="datanucleus.appengine.datastoreEnableXGTransactions" value="true"/>
</properties> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-26T12:38:33.377

您需要初始化集合

```
@OneToMany(fetch = FetchType.LAZY)
@Unowned
private List<InventoryItem> inventoryItems = new ArrayList<InventoryItem>(); 
```

# jetty - 如何以编程方式将我自己的 ServletConfig 传递给 servlet

> ID：12125255
> 
> 赞同：3
> 
> 时间：2012-08-25T20:05:29.903
> 
> 标签：jetty, servlet-3.0

这是一个关于嵌入 jetty 7 的示例： [http ://wiki.eclipse.org/Jetty/Tutorial/Embedding_Jetty](http://wiki.eclipse.org/Jetty/Tutorial/Embedding_Jetty)

```
public class OneServletContext
{
    public static void main(String[] args) throws Exception
    {
        Server server = new Server(8080);

        ServletContextHandler context = new ServletContextHandler(ServletContextHandler.SESSIONS);
        context.setContextPath("/");
        server.setHandler(context);

        context.addServlet(new ServletHolder(new HelloServlet()),"/*");

        server.start();
        server.join();
    }
} 
```

服务器 HelloServlet 将通过调用 init(ServletConfig config) 进行初始化；

如何告诉 Jetty 将我自己的 ServletConfig 传递给 HelloServet？（我没有 web.xml 文件，我也不想拥有）

```
Note:
I think that in Jetty6, you can call context.setInitParameter("my_key", "my_value");
but this function does not exists in Jetty7.

I've tried with context.getServletContext.setInitParameter("my_key", "my_value");
but I get an exception
java.lang.IllegalStateException was thrown.
org.eclipse.jetty.servlet.ServletContextHandler$Context.setInitParameter(ServletContextHandler.java:569) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-25T23:45:53.010

solved:

```
ServletHolder helloServletHolder = new ServletHolder(new HelloServlet());
helloServletHolder.setInitParameter("my_key", "my_value");
context.addServlet(helloServletHolder,"/*"); 
```

# php - 使用jquery，php向下滚动时重复的内容与加载内容

> ID：12125258
> 
> 赞同：-1
> 
> 时间：2012-08-25T20:05:44.960
> 
> 标签：php, jquery, scroll

我有一个代码，当我向下滚动页面时，它会从数据库中加载更多内容，但我的问题是当我滚动得太快时，从数据库加载的内容会重复，如果我使用此代码并且结果就是这样，这对我的用户来说会很麻烦，

这是代码：

```
<?php
include('../connection.php');

$action = @$_POST['action'];
$boxid = @$_POST['boxid'];

if($action <> "get")
{
?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title></title>
<link rel="stylesheet" href="scroll.css" type="text/css" />
<script type="text/javascript" src="../js/jquery-1.2.6.pack.js"></script>

    <script type="text/javascript">
    $(document).ready(function(){

        function last_msg_funtion() 
        { 

           var boxid=$(".message_box:last").attr("id");
           var action = "get";
            $('div#last_msg_loader').html('<img src="bigLoader.gif">');
            $.post("loader.php", { boxid: boxid, action: action }, function(data){
                if (data != "") {
                $(".message_box:last").after(data);         
                }
                $('div#last_msg_loader').empty();
            });
        };  

        $(window).scroll(function(){
            if  ($(window).scrollTop() == $(document).height() - $(window).height()){
               last_msg_funtion();
            }
        }); 

    });
    </script>

</head>

<body>
<div align="center">

<?php
$sql=mysql_query("SELECT * FROM announcements ORDER BY announce_id DESC LIMIT 10");
while($row=mysql_fetch_array($sql))
        {
        $msgID= $row['announce_id'];
        $msg= $row['content'];
        $posted= $row['postedby'];
?>
<div id="<?php echo $msgID; ?>"  align="left" class="message_box" >
<span class="number"><?php echo $posted; ?></span><?php echo "<b>".$msgID."</b>"; echo $msg; ?> 
</div>

<?php
}
mysql_close();
?>

<div id="last_msg_loader"></div>
</div>
</body>
</html>

<?php
}
else
{

$last_msg_id=$boxid;
 $sql=mysql_query("SELECT * FROM announcements WHERE announce_id < '$boxid' ORDER BY announce_id DESC LIMIT 5");
 $last_msg_id="";

        while($row=mysql_fetch_array($sql))
        {
        $msgID= $row['announce_id'];
        $msg= $row['content'];
        $posted= $row['postedby'];
        ?>
        <div id="<?php echo $msgID; ?>"  align="left" class="message_box" >
<span class="number"><?php echo $posted; ?></span><?php echo "<b>".$msgID."</b>"; echo $msg; ?> 
</div>
<?php
}
mysql_close();

        }
        ?> 
```

提前致谢！我希望有一个人可以帮助我 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T20:14:34.080

好吧试试这段代码......可能只是工作

```
$(document).ready(function(){

        function last_msg_funtion() 
        { 

           var boxid=$(".message_box:last").attr("id");
           var action = "get";
            $('div#last_msg_loader').html('<img src="bigLoader.gif">');
            $.post("loader.php", { boxid: boxid, action: action }, function(data){
                if (data != "") {
                $(".message_box:last").after(data);         
                }
                $('div#last_msg_loader').empty();
            }).complete(function() { return true; });
        };  

        $(window).scroll(function(){
            if  ($(window).scrollTop() == $(document).height() - $(window).height()){
               if(!last_msg_funtion()){
                   return false;
               }
            }
        }); 

    }); 
```

**编辑：**我改变了退出，返回假......因为退出可能会破坏jquery..不确定是否测试适合你的鞋子;）......也许会更好地使用而不是if......哦

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T20:22:51.067

试试这个。它可能会解决您的问题

```
$(document).ready(function(){
  var boxid; // declare global
    function last_msg_funtion() 
    { 

   if(boxid==$(".message_box:last").attr("id")) return false;  // check with previous id

       boxid=$(".message_box:last").attr("id");
       var action = "get";
        $('div#last_msg_loader').html('<img src="bigLoader.gif">');
        $.post("loader.php", { boxid: boxid, action: action }, function(data){
            if (data != "") {
            $(".message_box:last").after(data);         
            }
            $('div#last_msg_loader').empty();
        });
    };  

    $(window).scroll(function(){
        if  ($(window).scrollTop() == $(document).height() - $(window).height()){
           last_msg_funtion();
        }
    }); 

}); 
```

# php - 从 webview 注册 PHP 回显

> ID：12125262
> 
> 赞同：0
> 
> 时间：2012-08-25T20:06:34.610
> 
> 标签：php, android, webview

我需要访问我学校的身份验证服务才能在我的应用程序上对客户端进行身份验证。目前，身份验证服务仅允许通过浏览器进行注册。

我设置了一个可以正确访问身份验证页面的 webview，但我有 2 个问题：

1.  我访问了一个 PHP 脚本，该脚本将我的用户名作为字符串回显返回。如何将该字符串注册到 Android 中？
2.  运行脚本后如何关闭 web 视图？它只应运行身份验证。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T20:13:33.280

在如何构建 HTTP 请求的背后有一点点高峰，您应该能够在没有 WebView 的情况下执行此操作，而只需构建自己的界面来收集用户名/密码/等，然后构建自己的 HTTP 请求。那么你的挑战就是简单地从请求中解析返回的正文，这*有望*支持将 JSON 作为响应 Content-Type 来让你的生活更轻松。

# python - 我不明白这个语法错误的原因

> ID：12125264
> 
> 赞同：4
> 
> 时间：2012-08-25T20:06:47.283
> 
> 标签：python

我正在尝试学习 python 2，但我没有任何计算机语言背景，我正在使用教程“ByeofPython”。练习要求我们将其输入到编辑器中（文本管理员）

```
#!/usr/bin/python
#Filename : helloworld.py
print "Hello World' 
```

并将其保存为 helloworld.py。我这样做并将其保存到我的桌面上一个名为 python 练习的文件夹中。

然后本教程要求我们：

> 通过打开 shell（Linux 终端或 DOS 提示符）并输入命令 python helloworld.py 来运行该程序。如果您使用 IDLE，请使用菜单 Edit -> Run Script 或键盘快捷键 Ctrl-F5。输出如下图所示。
> 
> ```
> $ python helloworld.py
> Hello World 
> ```

但是，当我进入终端并输入 python helloworld.py 时，我得到了这个

```
python helloworld.py
                    ^
SyntaxError: invalid syntax 
```

有人能告诉我哪里出错了吗？我觉得我输入的所有内容都正确。我正在使用 Mac 并运行 python 2.6

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T20:08:55.960

您收到 SyntaxError 是因为您的引号不匹配。

您的打印行应该是：

```
print "Hello World" 
```

不是

```
print "Hello World' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T20:19:32.503

您可能正在输入 Python 解释器，而您输入的命令不是有效的 Python。要退出此模式，您可以按 CTRL-D（文件结束）或 CTRL-C（中断程序）。

（我不确定这些键序列在 Windows 上是否相同）

如果您运行命令`python`后没有脚本文件的名称，它将开始读取用户输入，就好像它是一个 python 程序一样。

# django - Django：将管理命令拆分为子文件夹

> ID：12125268
> 
> 赞同：11
> 
> 时间：2012-08-25T20:07:16.943
> 
> 标签：django, django-manage.py

Django 管理命令文档显示了在 app/management/commands 文件夹中创建的所有命令。是否可以将命令放入子文件夹中，例如 app/management/commands/install 和 app/management/commands/maintenance？这将如何完成？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T03:12:45.307

不幸的是，从 Django 1.4 开始，似乎没有办法做到这一点。[`django.core.management.__init__.py`](https://github.com/django/django/blob/master/django/core/management/__init__.py)有这种方法的来源：

```
def find_commands(management_dir):
    """
    Given a path to a management directory, returns a list of all the command
    names that are available.

    Returns an empty list if no commands are defined.
    """
    command_dir = os.path.join(management_dir, 'commands')
    try:
        return [f[:-3] for f in os.listdir(command_dir)
                if not f.startswith('_') and f.endswith('.py')]
    except OSError:
       return [] 
```

如您所见，它只考虑直接在`commands`文件夹内的文件，而忽略任何子文件夹。然而，如果你以某种方式“猴子补丁”这个函数，其余的代码应该可以正常工作，因为实际创建`Command`实例的代码是这样的：

```
def load_command_class(app_name, name):
    """
    Given a command name and an application name, returns the Command
    class instance. All errors raised by the import process
    (ImportError, AttributeError) are allowed to propagate.
    """
    module = import_module('%s.management.commands.%s' % (app_name, name))
    return module.Command() 
```

因此，如果您有一个名为`subfolder.command`它的命令，它将加载正确的脚本并实例化正确的类。

然而，从实际的角度来看，我认为这样做没有用。当然，使用“命名空间”命令会很好，但是如果需要，您可以随时为所有命令添加一些名称，使用其他名称作为分隔符（例如`_`）。命令名称长度 - 以及在终端中键入它们所需的击键次数 - 将是相同的......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-29T05:57:39.857

这是我的例子：

```
app
- management
  - install
      __init__.py
      check1.py
  - maintenance
      __init__.py
      check2.py
  - commands
    __init__.py
    daily_cron.py 
```

在`daily_cron.py`我使用的：

```
 from app.management.install import check1
 from app.management.maintenance import check2

 flag = check1(args)
 flag2 = check2(args) 
```

请记住在每个新文件夹中放置`__init__.py`空文件

# java - 如何在框架的装饰部分触发事件？

> ID：12125272
> 
> 赞同：1
> 
> 时间：2012-08-25T20:08:07.403
> 
> 标签：java, window-decoration

当鼠标位于框架的装饰部分时，我想触发一个事件。在 Java 中可能吗？

我尝试将侦听器添加到框架、面板等，我尝试了几种方法，但没有任何效果。当我*在*框架中时它工作正常

谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T02:27:27.817

您可以使用 Jpanel 并将组件嵌入到此面板中。然后在 mouseEntered 事件中编写代码。（活动可以通过以下方式找到：

```
1)Right click on the  panel.

2)Select  Properties and select events tab and mouse enterd event. 
```

# asp.net - .net MVC 将 MP4 流式传输到 iDevice 问题

> ID：12125275
> 
> 赞同：4
> 
> 时间：2012-08-25T20:08:24.250
> 
> 标签：asp.net, .net, ios, asp.net-mvc, html

我一直在为提供视频而编写的一段代码遇到了一些问题。代码如下：

```
public ResumingFileStreamResult GetMP4Video(string videoID)
    {
        if (User.Identity.IsAuthenticated)
        {
            string clipLocation = string.Format("{0}\\Completed\\{1}.mp4", ConfigurationManager.AppSettings["VideoLocation"].ToString(), videoID);

            FileStream fs = new FileStream(clipLocation, FileMode.Open, FileAccess.Read);

            ResumingFileStreamResult fsr = new ResumingFileStreamResult(fs, "video/mp4");

            return fsr;
        }
        else
        {
            return null;
        }
    } 
```

这是我的 HTML 代码：

```
<video controls preload poster="@Url.Content(string.Format("~/Videos/{0}_2.jpg", Model.VideoID))">
    <source src="@Url.Action("GetMP4Video", "Video", new { videoID = Model.VideoID })" type="video/mp4" />
    <source src="@Url.Action("GetWebMVideo", "Video", new { videoID = Model.VideoID })" type="video/webm" />

        <object id="flowplayer" data="@Url.Content("~/Scripts/FlowPlayer/flowplayer-3.2.14.swf")" type="application/x-shockwave-flash" width="640" height="360">
            <param name="movie" value="@Url.Content("~/Scripts/FlowPlayer/flowplayer-3.2.14.swf")" />
            <param name="allowfullscreen" value="true" />
            <param name="flashvars" value="config={'playlist':['@Url.Content(string.Format("~/Videos/{0}_2.jpg", Model.VideoID))',{'url':'@Url.Action("GetMP4Video", "Video", new { videoID = Model.VideoID })','autoPlay':false}]}" />
        </object>
</video> 
```

我的问题是这个设置似乎在我桌面上的所有浏览器中都可以正常工作，但是当我尝试使用我的 iPad 或 iPhone 加载页面时，它只会显示播放图标，其中有一条线，表示它无法播放。我尝试将 mp4 视频的源更改为指向 mp4 视频的直接链接，然后 iPad 立即开始播放。

为了使我的方法与iDevices兼容，我是否需要做一些我错过的特别事情？对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T23:56:35.720

要使您的视频在 iOS 设备上可播放，您需要实现对*字节范围*（或*部分*）请求的支持。这些类型的请求允许下载不是全部内容，而是部分地逐块下载（典型的*流式传输*）。这是 iOS 设备在页面上获取和播放视频的唯一方式。

部分请求使用`Range`header 告诉服务器下一个块的位置和大小。另一端的服务器响应`206 Partial Content`并请求块内容。

您可以找到几种 ASP.NET 处理程序的实现，它们可以处理 Internet 中的部分请求。我建议为此使用**[StaticFileHandler](http://code.google.com/p/talifun-web/wiki/StaticFileHandler)**：易于安装，并且还具有开箱即用的缓存功能。它也可以通过 Nuget 交付，但该包称为[Talifun.Web](http://nuget.org/packages/Talifun.Web)。

要配置 StaticFileHandler，请在 web.config 中为*mp4*文件注册处理程序并在单独的配置部分进行配置：

```
<configuration>
  <configSections>
    <section name="StaticFileHandler" type="Talifun.Web.StaticFile.Config.StaticFileHandlerSection, Talifun.Web" requirePermission="false" allowDefinition="MachineToApplication"/>
  </configSections>

  <StaticFileHandler webServerType="NotSet">
    <!-- The defaults to use when an extension is found that does not have a specific rule  -->
    <fileExtensionDefault name="Default" serveFromMemory="true" maxMemorySize="100000" compress="true"/>
    <!-- Specific rules for extension types -->
    <fileExtensions>
        <fileExtension name="VideoStaticContent" extension="3gp, 3g2, asf, avi, dv, flv, mov, mp4, mpg, mpeg, wmv" serveFromMemory="true" maxMemorySize="100000" compress="false"/>
    </fileExtensions>
  </StaticFileHandler>

  <system.webServer>
    <handlers>
      <add name="StaticContentHandler" verb="GET,HEAD" path="*.mp4" type="Talifun.Web.StaticFile.StaticFileHandler, Talifun.Web"/>
    </handlers>
  </system.webServer>
</configuration> 
```

If 还可以通过创建 ASP.NET 处理程序并直接调用来轻松应用您的自定义逻辑，例如授权或自定义视频文件源`StaticFileManager`。

```
public class MyOwnVideoHandler : IHttpHandler
{
    public void ProcessRequest(HttpContext context)
    {
        // Authorization or any other stuff.
        ...

        // Get file from your storage.
        FileInfo file = ...;

        // Serve the file with StaticFileHandler.
        StaticFileManager.Instance.ProcessRequest(new HttpContextWrapper(context), file);
    }
} 
```

此外，您可以查看[Scott Mitchell 关于部分请求](http://dotnetslackers.com/articles/aspnet/Range-Specific-Requests-in-ASP-NET.aspx)详细信息的文章并使用其作者编写的处理程序：它对我有用，但它没有缓存功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T21:14:54.083

感谢您的回复，所提供的信息非常有帮助。最后我使用以下[解决方案](https://www.tpeczek.com/2011/10/range-requests-in-aspnet-mvc.html)来实现字节范围请求。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-26T07:26:57.743

@whyleee 是正确的。我不能说 StaticFileHandler 有多好，但我自己也遇到过同样的问题，这让我发疯。标题必须`Range`包含在`Request`和`Response`标题中才能正常工作。例如，使用我自己的处理程序中的一些代码对您的代码进行轻微修改，如下所示（请记住，这是使用 .ashx 处理程序）：

```
//First, accept Range headers.
context.Response.AddHeader("Accept-Ranges", "bytes")

//Then, read all of the bytes from the file you are requesting.
Dim file_info As New System.IO.FileInfo(clipLocation)
Dim bytearr As Byte() = File.ReadAllBytes(file_info.FullName)

//Then, you will need to check for a range header, and then serve up a 206 Partial Content status code in your response.
Dim startbyte As Integer = 0
If Not context.Request.Headers("Range") Is Nothing Then
    //Get the actual byte range from the range header string, and set the starting byte.
    Dim range As String() = context.Request.Headers("Range").Split(New Char() {"="c, "-"c})
    startbyte = Convert.ToInt64(range(1))

    //Set the status code of the response to 206 (Partial Content) and add a content range header.
    context.Response.StatusCode = 206
    context.Response.AddHeader("Content-Range", String.Format(" bytes {0}-{1}/{2}", startbyte, bytearr.Length - 1, bytearr.Length))
End If

//Finally, write the video file to the output stream, starting from the specified byte position.
context.Response.OutputStream.Write(bytearr, startbyte, bytearr.Length - startbyte) 
```

正如我所说，这是 .ashx 处理程序的代码，所以我不确定它在多大程度上适用于您的情况，但我希望它对您有所帮助！

# java - 如何从带有 Jersey 的多部分表单中读取具有相同名称的多个（文件）输入？

> ID：12125277
> 
> 赞同：23
> 
> 时间：2012-08-25T20:08:52.470
> 
> 标签：java, forms, jersey, jax-rs, multipart

我已经成功开发了一项服务，在该服务中，我读取了在泽西岛以多部分形式上传的文件。这是我一直在做的一个非常简化的版本：

```
@POST
@Path("FileCollection")
@Consumes(MediaType.MULTIPART_FORM_DATA)
public Response uploadFile(@FormDataParam("file") InputStream uploadedInputStream,
        @FormDataParam("file") FormDataContentDisposition fileDetail) throws IOException {
    //handle the file
} 
```

这工作得很好，但我得到了一个新的要求。除了我要上传的文件之外，我还必须处理任意数量的资源。假设这些是图像文件。

我想我只需为客户端提供一个表单，其中包含一个文件输入、一个输入第一个图像和一个按钮以允许向表单添加更多输入（使用 AJAX 或简单的纯 JavaScript）。

```
<form action="blahblahblah" method="post" enctype="multipart/form-data">
   <input type="file" name="file" />
   <input type="file" name="image" />
   <input type="button" value="add another image" />
   <input type="submit"  />
</form> 
```

因此，用户可以在表单中附加更多图像输入，如下所示：

```
<form action="blahblahblah" method="post" enctype="multipart/form-data">
   <input type="file" name="file" />
   <input type="file" name="image" />
   <input type="file" name="image" />
   <input type="file" name="image" />
   <input type="button" value="add another image" />
   <input type="submit"  />
</form> 
```

我希望读取与集合同名的字段足够简单。我已经用 MVC .NET 中的文本输入成功地完成了它，我认为在泽西岛不会更难。事实证明我错了。

在没有找到有关该主题的教程后，我开始进行实验。

为了了解如何做到这一点，我将问题简化为简单的文本输入。

```
<form action="blahblabhblah" method="post" enctype="multipart/form-data">
   <fieldset>
       <legend>Multiple inputs with the same name</legend>
       <input type="text" name="test" />
       <input type="text" name="test" />
       <input type="text" name="test" />
       <input type="text" name="test" />
       <input type="submit" value="Upload It" />
   </fieldset>
</form> 
```

显然，我需要某种集合作为我的方法的参数。这是我尝试过的，按集合类型分组。

## 大批

起初，我检查了 Jersey 是否足够聪明来处理一个简单的数组：

```
@POST
@Path("FileCollection")
@Consumes(MediaType.MULTIPART_FORM_DATA)
public Response uploadFile(@FormDataParam("test") String[] inputs) {
    //handle the request
} 
```

但阵列没有按预期注入。

## 多值映射

在惨遭失败后，我记得`MultiValuedMap`可以开箱即用地处理对象。

```
@POST
@Path("FileCollection")
@Consumes(MediaType.MULTIPART_FORM_DATA)
public Response uploadFile(MultiValuedMap<String, String> formData) {
    //handle the request
} 
```

但它也不起作用。这一次，我遇到了一个例外

```
SEVERE: A message body reader for Java class javax.ws.rs.core.MultivaluedMap, 
and Java type javax.ws.rs.core.MultivaluedMap<java.lang.String, java.lang.String>, 
and MIME media type multipart/form-data; 
boundary=----WebKitFormBoundaryxgxeXiWk62fcLALU was not found. 
```

有人告诉我，可以通过包含库来消除此异常，`mimepull`因此我在 pom 中添加了以下依赖项：

```
 <dependency>
        <groupId>org.jvnet</groupId>
        <artifactId>mimepull</artifactId>
        <version>1.3</version>
    </dependency> 
```

不幸的是，问题仍然存在。这可能是选择正确的正文阅读器并为泛型使用不同参数的问题。我不知道该怎么做。我想同时使用文件和文本输入，以及其他一些输入（主要是`Long`值和自定义参数类）。

## 表单数据多部分

经过更多研究，我找到了[FormDataMultiPart](http://jersey.java.net/nonav/apidocs/1.8/contribs/jersey-multipart/com/sun/jersey/multipart/FormDataMultiPart.html)类。我已经成功地使用它从我的表单中提取字符串值

```
@POST
@Path("upload2")
@Consumes(MediaType.MULTIPART_FORM_DATA)
public Response uploadMultipart(FormDataMultiPart multiPart){
    List<FormDataBodyPart> fields = multiPart.getFields("test");
    System.out.println("Name\tValue");
    for(FormDataBodyPart field : fields){
        System.out.println(field.getName() + "\t" + field.getValue());
        //handle the values
    }
    //prepare the response
} 
```

问题是，这是我的问题的简化版本的解决方案。虽然我知道 Jersey 注入的每个参数都是在某个时候通过解析字符串创建的（难怪，毕竟它是 HTTP）并且我有一些编写自己的参数类的经验，但我真的不知道如何将这些字段转换为`InputStream`或`File`用于进一步处理的实例。

因此，在深入研究 Jersey 源代码以了解这些对象是如何创建的之前，我决定在这里询问是否有更简单的方法来读取一组（未知大小）文件。你知道如何解决这个难题吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-08-29T12:25:41.287

我通过使用`FormDataMultipart`. 事实证明，我非常接近答案。

该类`FormDataBodyPart`提供了一种方法，该方法允许其用户将值作为`InputStream`（或理论上，任何其他存在消息正文阅读器的类）来读取。

这是最终的解决方案：

## 形式

表格保持不变。我有几个同名的字段，我可以在其中放置文件。可以同时使用[`multiple`](http://www.w3.org/TR/html-markup/input.file.html#input.file.attrs.multiple)表单输入（从目录上传许多文件时需要这些输入）和共享名称的大量输入（从不同位置上传未指定数量的文件的灵活方式）。也可以使用 JavaScript 为表单附加更多输入。

```
<form action="/files" method="post" enctype="multipart/form-data">
   <fieldset>
       <legend>Multiple inputs with the same name</legend>
       <input type="file" name="test" multiple="multiple"/>
       <input type="file" name="test" />
       <input type="file" name="test" />
   </fieldset>
   <input type="submit" value="Upload It" />
</form> 
```

## 服务 - 使用[`FormDataMultipart`](http://jersey.java.net/nonav/apidocs/1.5/contribs/jersey-multipart/com/sun/jersey/multipart/FormDataMultiPart.html)

这是一种从多部分表单中读取文件集合的简化方法。具有相同的所有输入都分配给 a`List`并且它们的值`InputStream`使用 的[`getValueAs`](http://jersey.java.net/nonav/apidocs/1.1.4/contribs/jersey-multipart/com/sun/jersey/multipart/FormDataBodyPart.html#getValueAs%28java.lang.Class%29)方法转换为[`FormDataBodyPart`](http://jersey.java.net/nonav/apidocs/1.1.4/contribs/jersey-multipart/com/sun/jersey/multipart/FormDataBodyPart.html)。将这些文件作为`InputStream`实例后，几乎可以轻松地对它们执行任何操作。

```
@POST
@Path("files")
@Consumes(MediaType.MULTIPART_FORM_DATA)
public Response uploadMultipart(FormDataMultiPart multiPart) throws IOException{        
    List<FormDataBodyPart> fields = multiPart.getFields("test");        
    for(FormDataBodyPart field : fields){
        handleInputStream(field.getValueAs(InputStream.class));
    }
    //prepare the response
}

private void handleInputStream(InputStream is){
    //read the stream any way you want
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-05-07T16:58:39.127

```
@Path("/upload/multiples")
@POST
@Consumes(MediaType.MULTIPART_FORM_DATA)
@Produces(MediaType.APPLICATION_JSON)
public Response uploadImage(@FormDataParam("image") List<FormDataBodyPart> imageDatas){
   for( FormDataBodyPart imageData : imageDatas ){
       // Your actual code.
       imageData.getValueAs(InputStream.class);
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-13T23:28:37.147

如果有人尝试像我一样尝试`type=text`使用相同`name`属性的通用输入框，您将能够将它们切换为`type=hidden`输入并将其作为`@FormParam("inputName") List<String> nameList`您的路线中的一个工作。

显然，当切换到隐藏输入时，唯一的一点是仍然将数据发送到服务器而不为它创建 UI 元素，因此您需要切换到备用显示 UI（例如，我使用了一个按钮元素以便于单击-删除功能）。

# javascript - 从图像 A 淡入到图像 B，包括文本？

> ID：12125279
> 
> 赞同：0
> 
> 时间：2012-08-25T20:08:55.450
> 
> 标签：javascript, css, image, opacity

所以我发现了这篇关于使用 javascript（使用不透明度，适用于 Mozilla、Opera 和 IE）的图像之间淡化的精彩文章：[http ://www.cryer.co.uk/resources/javascript/script19_fade_image.htm#self](http://www.cryer.co.uk/resources/javascript/script19_fade_image.htm#self)

我想知道，我可以对文本做同样的事情吗？我的意思是，如果两个图像中都有一些文本，并且我希望淡入淡出与文本同时发生？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T22:02:47.007

下面是如何使用 JQuery 在两个图像和文本之间淡入淡出的示例：

[http://jsfiddle.net/Tr2LA/](http://jsfiddle.net/Tr2LA/)

单击图像开始动画。它的工作原理是使用 JQuery 淡出一个 div，同时淡入另一个。每个 div 包含一个图像和文本。

```
$('#fadeOut').click(function() {

  $('#fadeOut').fadeOut('slow');

  $('#fadeIn').fadeIn('slow');

}); 
```

# google-chrome - 谷歌浏览器下无法删除IndexedDB

> ID：12125281
> 
> 赞同：2
> 
> 时间：2012-08-25T20:09:25.143
> 
> 标签：google-chrome, privacy, indexeddb

如何删除 Google Chrome 中的 IndexedDB？我已经执行了“清除浏览数据”，但什么也没发生。仍然有一堆来自不同域的 IndexedDB ......所有其他数据已被删除。

在开发人员工具中没有删除 IndexedDB 的选项。

![谷歌浏览器清除浏览数据截图](../Images/63e74853433b902957a49d4b243fbb66.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T00:46:09.797

根据[http://code.google.com/p/chromium/issues/detail?id=64050](http://code.google.com/p/chromium/issues/detail?id=64050)，如果 IndexedDB 目录有打开的连接，则不会被删除。您是否尝试过关闭浏览器，等到所有进程都消失，然后使用“清除浏览数据”？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T13:31:28.760

如果您在尝试清除历史记录时仍在访问 IndexedDB，那么数据库将不会被删除，因为它已经在使用中。在这种情况下，您需要先关闭浏览器，然后再次尝试清除历史记录。

或者，您可以从以下位置手动删除所有 IndexedDB 数据库：

视窗`C:\Users\{UserName}\AppData\Local\Google\Chrome\User Data\Default\IndexedDB`

Linux：`/home/{username}/.config/google-chrome/IndexedDB`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T08:50:12.570

根据：[http](http://code.google.com/p/chromium/issues/detail?id=116372) ://code.google.com/p/chromium/issues/detail ?id=116372 您将可以选择很快清除 indexedDB（以及其他客户端存储选项，例如：localstorage 等）...

# javascript - 内部回调的可见性

> ID：12125284
> 
> 赞同：0
> 
> 时间：2012-08-25T20:09:56.417
> 
> 标签：javascript, node.js, mongoose

我在下面写的代码是控制器 user.js 的一部分

```
exports.login = function(req, res) {
var db = require('../db').tables;

//db.user.find(function(err, user) { console.log(user) });

switch (req.method) {
    default:
    case 'GET':
    break;
    case 'POST':
        db.user.find({username: req.body.username}, function(err, user) {

        });

        console.log(user);
    break;
}

res.render('user/login', {title: 'Login'});
}; 
```

问题是函数**db.user.find**并且我在回调中没有可用的变量**res 。**

我已经尝试过几次重新阅读文档 mongoose 以使用更舒适的语法但没有。

您如何建议我更改代码？

抱歉英语不好，但我使用了谷歌。:(

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T21:35:29.093

因为匿名回调函数`find`是在函数的上下文中定义的`login`，所以您的回调已经可以`res`通过闭包访问。

```
...
db.user.find({username: req.body.username}, function(err, user) {
    // code here can reference res from the enclosing scope
    res.json(user);
});
... 
```

# xslt - 在非文本输出中追加重复字符串的计数

> ID：12125292
> 
> 赞同：1
> 
> 时间：2012-08-25T20:11:26.907
> 
> 标签：xslt, w3c, bibtex

我正在使用[w3c bibtex 转换](http://gitorious.org/w3c-bibtex/mainline)来生成一个 bibtex 文件，但不幸的是它正在为同一年的论文生成重复的作者密钥。

*   琼斯：2012
*   琼斯：2012

`bibtex-label`问题模板在[xslt](http://gitorious.org/w3c-bibtex/mainline/blobs/master/w3c-rdf-to-bibtex.xsl)中命名。

我如何添加每个作者每年的计数值，以便 bibtex-label 看起来像这样：

*   琼斯：2012a
*   琼斯：2012b

我找不到任何关于做这类事情的好资源，特别是对于非 xml 输出。

示例输入（来自[此处](http://www.w3.org/2002/01/tr-automation/tr.rdf)）：

```
<rdf:RDF xmlns="http://www.w3.org/2001/02pd/rec54#"
    xmlns:contact="http://www.w3.org/2000/10/swap/pim/contact#"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:doc="http://www.w3.org/2000/10/swap/pim/doc#"
    xmlns:mat="http://www.w3.org/2002/05/matrix/vocab#"
    xmlns:org="http://www.w3.org/2001/04/roadmap/org#"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
    xmlns:rec="http://www.w3.org/2001/02pd/rec54#">

    <REC rdf:about="http://www.w3.org/TR/1998/REC-DOM-Level-1-19981001">
        <dc:date>1998-10-01</dc:date>
        <dc:title>Document Object Model (DOM) Level 1</dc:title>
        <doc:versionOf rdf:resource="http://www.w3.org/TR/REC-DOM-Level-1"/>
        <editor rdf:parseType="Resource">
            <contact:fullName>Arnaud Le Hors</contact:fullName>
        </editor>
        <editor rdf:parseType="Resource">
            <contact:fullName>Scott Isaacs</contact:fullName>
        </editor>
        <editor rdf:parseType="Resource">
            <contact:fullName>Steve Byrne</contact:fullName>
        </editor>
        <editor rdf:parseType="Resource">
            <contact:fullName>Mike Champion</contact:fullName>
        </editor>
        <editor rdf:parseType="Resource">
            <contact:fullName>Gavin Nicol</contact:fullName>
        </editor>
        <editor rdf:parseType="Resource">
            <contact:fullName>Lauren Wood</contact:fullName>
        </editor>
        <editor rdf:parseType="Resource">
            <contact:fullName>Ian Jacobs</contact:fullName>
        </editor>
        <editor rdf:parseType="Resource">
            <contact:fullName>Robert Sutor</contact:fullName>
        </editor>
        <editor rdf:parseType="Resource">
            <contact:fullName>Jonathan Robie</contact:fullName>
        </editor>
        <editor rdf:parseType="Resource">
            <contact:fullName>Chris Wilson</contact:fullName>
        </editor>
        <editor rdf:parseType="Resource">
            <contact:fullName>Vidur Apparao</contact:fullName>
        </editor>
        <org:deliveredBy rdf:parseType="Resource">
            <contact:homePage rdf:resource="http://www.w3.org/DOM/Group/"/>
        </org:deliveredBy>
        <mat:hasErrata rdf:resource="http://www.w3.org/DOM/updates/REC-DOM-Level-1-19981001-errata.html"/>
    </REC>

    <REC rdf:about="http://www.w3.org/TR/1998/REC-html40-19980424">
        <rdf:type rdf:resource="http://www.w3.org/2001/02pd/rec54#Superseded"/>
        <dc:date>1998-04-24</dc:date>
        <dc:title>HTML 4.0 Specification</dc:title>
        <doc:versionOf rdf:resource="http://www.w3.org/TR/html40"/>
        <editor rdf:parseType="Resource">
            <contact:fullName>Arnaud Le Hors</contact:fullName>
        </editor>
        <editor rdf:parseType="Resource">
            <contact:fullName>Ian Jacobs</contact:fullName>
        </editor>
        <editor rdf:parseType="Resource">
            <contact:fullName>David Raggett</contact:fullName>
        </editor>
        <previousEdition rdf:resource="http://www.w3.org/TR/REC-html40-971218"/>
        <org:deliveredBy rdf:parseType="Resource">
            <contact:homePage rdf:resource="http://www.w3.org/MarkUp/"/>
        </org:deliveredBy>
        <mat:hasErrata rdf:resource="http://www.w3.org/MarkUp/html40-updates/REC-html40-19980424-errata.html"/>
    </REC>

</rdf:RDF> 
```

示例输出（[完整](http://pastebin.com/q3mVfz40)）：

```
@TechReport{LeHors:1998,
  author = {Arnaud Le Hors and Scott Isaacs and Steve Byrne and Mike Champion and Gavin Nicol and Lauren Wood and Ian Jacobs and Robert Sutor and Jonathan Robie and Chris Wilson and Vidur Apparao},
  title  = {{Document Object Model (DOM) Level 1}},
  note = {\url{http://www.w3.org/TR/1998/REC-DOM-Level-1-19981001}. Latest version available at \url{http://www.w3.org/TR/REC-DOM-Level-1}},
  year = {1998},
  month = nov,
  bibsource = "http://www.w3.org/2002/01/tr-automation/tr.rdf",
  type = "Recommendation",
  institution = "W3C",
}

@TechReport{LeHors:1998,
  author = {Arnaud Le Hors and Ian Jacobs and David Raggett},
  title  = {{HTML 4.0 Specification}},
  note = {\url{http://www.w3.org/TR/1998/REC-html40-19980424}. Latest version available at \url{http://www.w3.org/TR/html40}},
  year = {1998},
  month = apr,
  bibsource = "http://www.w3.org/2002/01/tr-automation/tr.rdf",
  type = "Recommendation",
  institution = "W3C",
} 
```

期望的输出：

```
@TechReport{LeHors:1998a,
  author = {Arnaud Le Hors and Scott Isaacs and Steve Byrne and Mike Champion and Gavin Nicol and Lauren Wood and Ian Jacobs and Robert Sutor and Jonathan Robie and Chris Wilson and Vidur Apparao},
  title  = {{Document Object Model (DOM) Level 1}},
  note = {\url{http://www.w3.org/TR/1998/REC-DOM-Level-1-19981001}. Latest version available at \url{http://www.w3.org/TR/REC-DOM-Level-1}},
  year = {1998},
  month = nov,
  bibsource = "http://www.w3.org/2002/01/tr-automation/tr.rdf",
  type = "Recommendation",
  institution = "W3C",
}

@TechReport{LeHors:1998b,
  author = {Arnaud Le Hors and Ian Jacobs and David Raggett},
  title  = {{HTML 4.0 Specification}},
  note = {\url{http://www.w3.org/TR/1998/REC-html40-19980424}. Latest version available at \url{http://www.w3.org/TR/html40}},
  year = {1998},
  month = apr,
  bibsource = "http://www.w3.org/2002/01/tr-automation/tr.rdf",
  type = "Recommendation",
  institution = "W3C",
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T08:37:33.300

首先，为了简化**safeSurname**`translate`函数的函数，您可以在 XSLT 顶部定义两个变量，如下所示

 **```
<xsl:variable name="nameIn" 
   select="'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ.- 0123456789Ã±Ã‘Ã§Ã‡Ã¡Ã©Ã­Ã³ÃºÃÃ‰ÃÃ“ÃšÃ¤Ã«Ã¯Ã¶Ã¼Ã„Ã‹ÃÃ–Ãœ'" />
<xsl:variable name="nameOut" 
   select="'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'" /> 
```

然后，这将允许您编写更具可读性的代码来获取格式化的姓氏

```
<xsl:variable name="safeSurname" select="translate($surname, $nameIn, $nameOut)" /> 
```

当您看到生成后缀的代码时会变得更加清晰，这可以使用**xsl:number**函数来计算具有匹配年份和姓氏的前面兄弟姐妹的数量。注意使用**format**属性来输出字母而不是数字：

```
<xsl:number 
   value="count(preceding-sibling::rec:REC
      [substring-before(dc:date/text(), '-') = $date]
      [translate(substring-after(rec:editor[1]/contact:fullName, ' '), $nameIn, $nameOut) = $safeSurname]
   ) + 1" 
   format="a"/> 
```

在此代码中， **$date**是当前**REC**元素的年份。

这是**bibtex-label**的完整匹配模板。注意我已经删除了对**dc:date**模板的调用，模式**为 bibtex-year**，只是为了将代码全部保存在一个模板中。

```
<xsl:template match="*" mode="bibtex-label">
  <xsl:variable name="surname" select="substring-after(rec:editor[1]/contact:fullName, ' ')"/>
  <xsl:variable name="safeSurname" select="translate($surname, $nameIn, $nameOut)" />
  <xsl:variable name="date"  select="substring-before(dc:date/text(), '-')"/>
  <xsl:value-of select="concat($safeSurname, ':', $date)" />
  <xsl:number value="count(preceding-sibling::rec:REC[substring-before(dc:date/text(), '-') = $date][translate(substring-after(rec:editor[1]/contact:fullName, ' '), $nameIn, $nameOut) = $safeSurname]) + 1" format="a"/>
</xsl:template> 
```**

# c++ - 无法从 winapi 中的编辑控件获取文本

> ID：12125293
> 
> 赞同：0
> 
> 时间：2012-08-25T20:11:31.883
> 
> 标签：c++, winapi, text, controls

我无法从主窗口上的编辑控件中检索任何文本。我可以设置在绘制窗口时显示的文本，但我无法获取我想在 MessageBox 中显示的文本。我尝试了“SendMessage()”和“GetWindowText()”，但都做了同样的事情。看来我正在检索的文本长度也是无效的，因此即使我可以看到其中的文本，编辑也没有任何价值。

```
LRESULT CALLBACK WndProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam) {
int wmId, wmEvent;
PAINTSTRUCT ps;
HDC hdc;
HWND addCust, editCust1, editCust2;

switch (message) {
case WM_CREATE: {
    addCust = CreateWindow(L"BUTTON",L"addCust",
                   WS_CHILD|WS_VISIBLE|BS_DEFPUSHBUTTON,
                   140,70,100,25,hWnd,(HMENU)IDC_ADDCUST,NULL,NULL);
    editCust1 = CreateWindowEx(WS_EX_CLIENTEDGE,L"EDIT",L"",
                    WS_CHILD|WS_VISIBLE|ES_AUTOHSCROLL,
                    50,100,200,20,hWnd,(HMENU)IDC_EDITCUST1,NULL,NULL);
    editCust2 = CreateWindowEx(WS_EX_CLIENTEDGE,L"EDIT",L"",
                    WS_CHILD|WS_VISIBLE|ES_AUTOHSCROLL,
                    50,130,200,20,hWnd,(HMENU)IDC_EDITCUST2,NULL,NULL);
    SendMessage(editCust1,WM_SETTEXT,NULL,(LPARAM)L"first name");
    SendMessage(editCust2,WM_SETTEXT,NULL,(LPARAM)L"last name");
    break;
}
case WM_COMMAND:
    wmId    = LOWORD(wParam);
    wmEvent = HIWORD(wParam);
    case IDC_ADDCUST: {
        TCHAR buff[64] = { '\0' };
        int len = SendMessage(editCust1, WM_GETTEXTLENGTH, 0, 0);
        SendMessage(editCust1, WM_GETTEXT, len+1, (LPARAM)buff);
        GetWindowText(editCust1, buff, len+1);
        MessageBox(NULL, buff, L"Information", MB_ICONINFORMATION);
        break;
        }
    default:
        return DefWindowProc(hWnd, message, wParam, lParam);
    }
    break;
default:
    return DefWindowProc(hWnd, message, wParam, lParam);
}
return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T20:31:26.580

```
 HWND addCust, editCust1, editCust2; 
```

那行不通，这些是局部变量。在 WM_CREATE 消息处理程序运行并且 WndProc() 方法退出后，它们将失去其价值。当您在 WM_COMMAND 处理程序中再次使用 editCust1 时，变量包含垃圾。顺便说一句，使用调试器很容易看到。您需要使它们成为全局变量，以便它们保持其值。

*buff*声明也是错误的，它只能包含 63 个字符。当编辑控件实际上包含 64 个或更多字符时，您将破坏堆栈帧并（希望）使您的程序崩溃。使用 malloc() 创建一个足够大的缓冲区。

这些是 C 语言编程陷阱，它们与 Windows api 几乎没有关系。除了“放慢速度”之外，很难给出建议，您确实需要在 Windows 停止让您头痛之前知道 C 是如何工作的。

# c# - 如何按类型排序列表？

> ID：12125295
> 
> 赞同：5
> 
> 时间：2012-08-25T20:12:01.393
> 
> 标签：c#, linq, algorithm, list, extension-methods

想象一下，您有一个名为 的列表`List<Foo>`。

`Foo`是一个抽象类，所以它可以是`FooA`, `FooB`,`FooC`或`FooD`. 而且我想要一个扩展`List<T>`，您可以按类型顺序排列这些元素。

例如，如果我有 9 个元素。

```
FooA, FooA, FooB, FooD, FooC, FooC, FooA, FooB, FooA 
```

依次按类型排序。

```
FooA, FooB, FooC, FooD, FooA, FooB, FooC, FooA, FooA 
```

我正在尝试可以按照您指定的顺序订购该功能，在这种情况下，IE，它是：

```
new[] { typeof(FooA), typeof(FooB), typeof(FooC), typeof(FooD) } 
```

我试图创建这个扩展，但我什么也没得到。你能帮忙一点吗？我猜我可以用 LINQ 完成它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-25T20:22:32.063

您可以按类型对项目进行分组，按类型对组进行排序并交错组：

```
var groups = items.GroupBy(x => x.GetType())
                  .OrderBy(g => orderedTypes.IndexOf(g.Key))
                  .ToList();

var result = groups.First().Interleave(groups.Skip(1).ToArray()); 
```

使用[来自 EvenMoreLINQ 的 Interleave 方法](http://code.google.com/r/azizatif-morelinq-evenmore/source/browse/MoreLinq/Interleave.cs)。

```
foreach (var item in result)
{
    Console.WriteLine(item.GetType());
} 
```

*输出：*

```
FooA
FooB
FooC
FooD
FooA
FooB
FooC
FooA
FooA 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T20:28:33.310

按类型分组，然后循环遍历项目以每次添加一组。就像是：

```
var groups =
  collection.GroupBy(x => x.GetType())
  .ToDictionary(g => g.Key, g => g.ToList());

List<Foo> result = new List<Foo>();
int max = groups.Values.Max(n => n.Count);
for (int i = 0; i < max; i++) {
  foreach (Type  t in sortArray) {
    if (groups[t].Count > i) {
      result.Add(groups[t][i]);
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T13:46:31.810

`list`是要排序的元素的集合。
`pattern`是按特定顺序排列的元素的集合。
`result`是`list`根据 排序的元素的集合`pattern`。

```
var list = new List<Foo> { new FooA(), new FooB(), new FooC(), new FooA(), new FooC(), new FooA(), new FooD() };
var pattern = new Foo[] { new FooB(), new FooC(), new FooD(), new FooA() };

var result = list.OrderBy(p => p, new MyFooComparer(pattern)); 
```

有一个`MyFooComparer`实现接口的类`IComparer<>`。
比较是基于每个集合`Foo`在`pattern`集合中的位置。`pattern`元素**不能重复**，它们必须包含所有类型`Foo`（至少是 中使用的那些`list`）。
我曾经`Dictionary<>`存储模式顺序，因为它具有 O(1) 复杂度。

```
public class MyFooComparer : IComparer<Foo>
{
    private readonly Dictionary<Type, int> _pattern;
    public MyFooComparer(IEnumerable<Foo> pattern)
    {
        _pattern = new Dictionary<Type, int>();
        int i = 0;
        foreach (var foo in pattern)
        {
            _pattern.Add(foo.GetType(), i);
            i++;
        }
    }

    public int Compare(Foo x, Foo y)
    {
        var xVal = _pattern[x.GetType()];
        var yVal = _pattern[y.GetType()];
        return xVal.CompareTo(yVal);
    }
} 
```

调用后：

```
 foreach (var foo in result)
        {
            Console.WriteLine(foo.GetType().Name);
        } 
```

根据`pattern`，您将获得：

```
FooB
FooC
FooC
FooD
FooA
FooA
FooA 
```

**编辑：**

扩展名`List<Foo>`：

```
static class MyExtension
{
    public static IEnumerable<Foo> OrderByFoo<T>(this List<Foo> list, IEnumerable<Foo> patern)
    {
        return list.OrderBy(p => p, new MyFooComparer(patern));
    }
} 
```

# windows-phone-7 - Windows phone 7 中的页面转换

> ID：12125298
> 
> 赞同：0
> 
> 时间：2012-08-25T20:12:33.617
> 
> 标签：windows-phone-7

我想在 Windows phone 7 中显示页面上方的页面

这样第二页是透明的，当它变成（弹出）第一页时，我仍然希望能够看到第一页。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T05:18:38.160

你最好使用`UserControl`s。将每个页面实现为 a`<UserControl>`并将它们相应地加载到`MainPage.xaml`.

我建议你看看[MVVM for Windows Phone](http://msdn.microsoft.com/en-us/library/windowsphone/develop/gg521153%28v=vs.92%29.aspx)

# networking - 以编程方式发送完整的 TCP 或 UDP 包

> ID：12125301
> 
> 赞同：1
> 
> 时间：2012-08-25T20:13:32.443
> 
> 标签：networking, tcp, network-programming, udp, network-protocols

根据 OSI 模型，数据包将分几层完成。**是否可以以编程**方式发送**完整的 TCP 或 UDP 数据包**（包括标头等）。

 **例如带有自定义 MAC ADD 的数据包。和发件人（请求者）的假IP？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T00:37:31.413

是的。如果您使用 RAW sockets 发送它，您可以放置​​任何 TCP 或 UDP 数据包标头，为此您必须具有系统的**root**访问权限：

```
sock = socket(PF_INET, SOCK_RAW, IPPROTO_UDP); 
```

或者您也可以直接使用以太网卡绕过 linux TCP 堆栈和 write() 和 read()。

问题是，如果您在 TCP 中使用假 IP，您将不会从 SYN 请求中获得响应，因为真正的 IP 会拒绝它，或者根本不会将其路由回。如果您查询“ip spoofing”关键字，您可以对此进行研究。**

# objective-c - 如何在 iOS 中获取本地格式化的日期模式字符串？

> ID：12125306
> 
> 赞同：1
> 
> 时间：2012-08-25T20:13:43.403
> 
> 标签：objective-c, ios, ios5, nsdate, nsdateformatter

> **可能重复：**
> [如何确定语言环境的日期格式是月/日还是日/月？](https://stackoverflow.com/questions/5135482/how-to-determine-if-locales-date-format-is-month-day-or-day-month)

我现在挣扎了一段时间，我被困住了！我要么需要格式为“mm-dd-yyyy”或“08-25-2012”的本地格式化模式日期字符串。我该怎么做？使用`dateFormat`？请帮我！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-26T12:47:45.800

NSDateFormatter 有一个方便的类方法：

```
[NSDateFormatter localizedStringFromDate:date dateStyle:NSDateFormatterShortStyle timeStyle:NSDateFormatterNoStyle]; 
```

您可以指定 NSDateFormatterNoStyle、..ShortStyle、..MediumStyle 或..LongStyle

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-25T20:20:09.900

您可以将 NSDateFormatter 与 MM-dd-yyyy 一起使用，然后使用应用于格式化程序的 NSTimeZone 来调整本地时区。

这个：

```
NSDate *date = [[NSDate alloc] init];
NSLog(@"%@", date);

NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateFormat:@"MM-dd-yyyy hh:mm"];
NSString *dateString = [dateFormatter stringFromDate:date];

NSLog(@"%@", dateString);

NSTimeZone *timeZone = [NSTimeZone localTimeZone];
[dateFormatter setTimeZone:timeZone];
NSLog(@"adjusted for timezone: %@", [dateFormatter stringFromDate:date]); 
```

输出：

```
2012-08-26 08:30:53.741 Craplet[2585:707] 2012-08-26 12:30:53 +0000
2012-08-26 08:30:53.742 Craplet[2585:707] 08-26-2012 08:30
2012-08-26 08:30:53.743 Craplet[2585:707] adjusted for timezone: 08-26-2012 08:30 
```

# iphone - iOS - 禁用功能的应用审核流程规则

> ID：12125307
> 
> 赞同：1
> 
> 时间：2012-08-25T20:13:57.053
> 
> 标签：iphone, ios, app-store, appstore-approval

我有一个 iPhone 应用程序（已经在 App Store 中，免费下载），它要求用户输入订阅提供的服务器和登录凭据。该应用程序具有内置的“演示模式”，供潜在客户评估应用程序，到目前为止，Apple 应用程序审核团队一直使用此模式来批准每个提交的版本。
我即将提交的最新版本有一些不适合在演示模式中使用的新功能，并且在此模式下被禁用。没有按钮变灰，但会显示一条警告消息，通知用户“在演示模式下不可用”。我的问题是这是否会导致 Apple 审核团队出现问题 - 是否会因为禁用功能而被拒绝？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T20:53:30.657

不久前，我向您展示了一条与您的“在演示模式下不可用”非常相似的消息。

苹果拒绝了该应用程序，称这会对用户体验产生负面影响！

我会尝试另一种方法 - 即使它只是在信息页面上的应用程序文档中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T20:24:22.120

是的，您应该在上传应用程序时填写的应用程序元数据的审核说明中提供订阅的用户凭据，因为他们需要测试完整的应用程序以完成他们的审核过程。在对完整的应用程序进行审核之前，甚至不要考虑它会获得批准并上线。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T03:37:32.240

IIRC，Apple 的审查指南说，试用或演示应用程序将被拒绝。

相反的可能更容易接受。不要通过说 X 在演示中被禁用或不可用来中断用户体验；但是，如果您的广告中出现 X 以供客户购买完整模式，则该应用程序将得到增强。

# c - 修剪时 realloc 会失败（返回 NULL）吗？

> ID：12125308
> 
> 赞同：13
> 
> 时间：2012-08-25T20:14:25.163
> 
> 标签：c, memory-management, realloc

如果执行下一个：

```
int* array = malloc(10 * sizeof(int)); 
```

他们我使用realloc：

```
array = realloc(array, 5 * sizeof(int)); 
```

在第二行（并且只有它），它可以返回`NULL`吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-25T20:20:52.103

**是的，它可以。**上没有实现保证`realloc()`，即使在收缩时它也可以返回不同的指针。

例如，如果一个特定的实现对不同的对象大小使用不同的池，`realloc()`实际上可能会在池中为较小的对象分配一个新块，并为较大的对象释放池中的块。因此，如果较小对象的池已满，它将失败并返回`NULL`。

* * *

或者它可能只是决定移动块更好

我只是使用以下程序来获取 glibc 实际分配的内存大小：

```
#include <stdlib.h>                                                          
#include <stdio.h>                                                           

int main()                                                                   
{                                                                            
    int n;                                                                   

    for (n = 0; n <= 10; ++n)                                                
    {                                                                        
        void* array = malloc(n * sizeof(int));                               
        size_t* a2 = (size_t*) array;                                        

        printf("%d -> %zu\n", n, a2[-1]);                                    
    }                                                                        
} 
```

对于 n <= 6，它分配 32 个字节，对于 7-10，它是 48。

因此，如果它缩小`int[10]`到`int[5]`，分配的大小将从 48 缩小到 32，有效地提供 16 个空闲字节。由于（正如刚刚提到的）它不会分配小于 32 字节的任何内容，因此这 16 个字节将丢失。

如果它将块移动到其他地方，整个 48 个字节将被释放，并且实际上可以在其中放入一些东西。当然，这只是一个科幻故事，而不是真正的实现；）。

* * *

C99 标准中最相关的引用（**7.20.3.4`realloc`函数**）：

> **退货**
> 
> 4 该`realloc`函数返回一个指向新对象的指针（它**可能**与指向旧对象的指针具有相同的值），如果无法分配新对象，则返回一个空指针。

*“五月”*是这里的关键词。它没有提到可能发生这种情况的任何具体情况，所以你不能依赖其中任何一个，即使它们乍一看听起来很明显。

* * *

顺便说一句，我认为您*可以*考虑`realloc()`有些弃用。如果您看一下 C++，较新的内存分配接口（`new`/`delete`和分配器）甚至不支持这样的事情。他们总是希望你分配一个新块。但这只是一个松散的评论。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-25T20:51:19.490

其他答案已经解决了这个问题，但是假设您知道`realloc`呼叫是“修剪”，您可以将其包装为：

```
void *safe_trim(void *p, size_t n) {
    void *p2 = realloc(p, n);
    return p2 ? p2 : p;
} 
```

并且返回值将始终指向 size 的对象`n`。

在任何情况下，由于实现`realloc`知道对象的大小，因此可以确定它正在“修剪”，从实现质量的角度来看，不在内部执行上述逻辑将是病态的糟糕。但是由于`realloc`不需要这样做，你应该自己做，或者使用上面的包装器，或者在调用时使用类似的内联逻辑`realloc`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-25T20:19:22.470

语言（和库）规范没有做出这样的保证，就像它不保证“修剪”`realloc`将保留指针值一样。

一个实现可能决定以最“原始”的方式实现：通过对新内存块`realloc`执行无条件操作，复制数据并 -处理旧块。显然，这种实现在内存不足的情况下可能会失败。`malloc``free`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-25T20:19:28.160

不要指望它。标准没有这样的规定；它仅声明“*如果无法分配新对象，则为空指针*”。

你很难找到这样的实现，但根据标准，它仍然是合规的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-25T20:21:51.250

我怀疑在您描述的情况下，*理论上*可能存在失败的可能性。

根据堆的实现，可能没有修剪现有分配块这样的事情。相反，首先分配一个较小的块，然后从旧块复制数据，然后释放它。

例如，桶堆策略可能就是这种情况（一些流行的堆使用，例如 tcmalloc）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-08-21T15:36:10.080

有点晚了，但至少有一种流行的实现`realloc()`可能会失败：TCMalloc。（至少据我了解代码）

如果你读取文件`tcmalloc.cc`，在函数`do_realloc_with_callback()`中，你会看到如果你收缩得足够多（分配的内存的50%，否则会被忽略），TCMalloc 会先分配新的内存（可能会失败）然后复制它并删除旧的记忆。

我不复制源代码，因为我不确定（TCMalloc 和 Stackoverflow 的）版权是否允许这样做，但这里是[源代码的链接](https://github.com/gperftools/gperftools/blob/fe62a0baab87ba3abca12f4a621532bf67c9a7d2/src/tcmalloc.cc#L1535)（修订于 2019 年 5 月 17 日）。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-08-25T20:16:28.963

`realloc`收缩现有内存不会失败，因此不会返回`NULL`。`NULL`只有在扩展过程中失败时才能返回。

但是在某些架构中收缩可能会失败，`realloc`可以以不同的方式实现，例如单独分配较小的内存并释放旧内存以避免碎片。在这种情况下，缩小内存可以返回 NULL。但它的实现非常罕见。

但最好是在更安全的一面，`NULL`在缩小内存后进行检查。

# java - 如何将毫秒转换为小时和天？

> ID：12125311
> 
> 赞同：15
> 
> 时间：2012-08-25T20:15:03.417
> 
> 标签：java

我想获取 JVM 启动时间和正常运行时间。到目前为止，我已经这样做了：

```
public long getjvmstarttime(){
    final long uptime = ManagementFactory.getRuntimeMXBean().getStartTime();
    return uptime;
}

public long getjvmuptime(){
    final long uptime = ManagementFactory.getRuntimeMXBean().getUptime();
    return uptime;
} 
```

但我以毫秒为单位获得时间。如何将时间转换为天和小时。我想以这种格式显示毫秒：3 天 8 小时 32 分钟。是否有可以转换毫秒的内部 Java 方法？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-08-25T20:19:55.013

一旦获得以毫秒为单位的时间，您就可以使用[TimeUnit](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/TimeUnit.html)枚举将其转换为其他时间单位。转换为天数只需要一个电话。

```
long days = TimeUnit.MILLISECONDS.toDays(milliseconds); 
```

获取小时数将涉及对总小时数的另一个类似调用，然后计算减去天数后剩余的小时数。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2012-08-25T20:25:55.303

下面的代码执行您需要的数学运算并构建结果字符串：

```
private static final int SECOND = 1000;
private static final int MINUTE = 60 * SECOND;
private static final int HOUR = 60 * MINUTE;
private static final int DAY = 24 * HOUR;

// TODO: this is the value in ms
long ms = 10304004543l;
StringBuffer text = new StringBuffer("");
if (ms > DAY) {
  text.append(ms / DAY).append(" days ");
  ms %= DAY;
}
if (ms > HOUR) {
  text.append(ms / HOUR).append(" hours ");
  ms %= HOUR;
}
if (ms > MINUTE) {
  text.append(ms / MINUTE).append(" minutes ");
  ms %= MINUTE;
}
if (ms > SECOND) {
  text.append(ms / SECOND).append(" seconds ");
  ms %= SECOND;
}
text.append(ms + " ms");
System.out.println(text.toString()); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-25T20:20:34.197

看看[漂亮的时间](http://ocpsoft.org/prettytime/)。它是一个库，用于从毫秒等时间戳生成人类可重复的时间字符串。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-04-29T11:43:56.117

下面的代码干净地完成了这项工作

```
package com.company;

import java.util.Scanner;
import java.util.concurrent.TimeUnit;

public class Main {

    public static void main(String[] args) {
        final long milliseconds;
        Scanner in = new Scanner(System.in);

        System.out.println("Enter time in milliseconds: ");
        milliseconds = in.nextLong();

        final long seconds = TimeUnit.MILLISECONDS.toSeconds(milliseconds);

        final long minute = TimeUnit.MILLISECONDS.toMinutes(milliseconds);

        final long hours = TimeUnit.MILLISECONDS.toHours(milliseconds);

        final long days = TimeUnit.MILLISECONDS.toDays(milliseconds);

        if(milliseconds < 1000){
            System.out.println(days +"d:" +hours+"h:" +minute+"m:" +seconds +"s:" +milliseconds +"ms");
        }
        else{
            System.out.println(days +"d:" +hours % 24 +"h:" +minute % 60 +"m:" +seconds % 60 +"s");
        }
    }
} 
```

样本输出

以毫秒为单位输入时间：12000000

0d:3h:20m:0s

# linux - 从命令行将 ActiveMQ 5.6.0 配置为 CentOS 32 位上的 UNIX 服务

> ID：12125313
> 
> 赞同：1
> 
> 时间：2012-08-25T20:15:36.607
> 
> 标签：linux, apache, centos, activemq

我目前可以使用 xbean 启动 ActiveMQ，但 ActiveMQ 在启动时没有作为 UNIX 服务启动

```
/home/username/activemq/bin/activemq start xbean:/home/username/activemq/conf/my-activemq.xml 
```

控制台提示我运行设置，所以我

```
/home/username/activemq/bin/activemq setup etc/default/activemq 
```

我很困惑为什么控制台说如果我使用 xbean 就创建一个配置文件

然后我创建了 producer.php 和 consumer.php

```
cd /etc/init.d/

cat > producer.php

<?php
$queue1  = '/queue/queue1';
try {$stomp = new Stomp('tcp://localhost:61613');} 
catch(StompException $e) {die('Connection failed: ' . $e->getMessage());}
for($i=1;$i<10;$i++){$msg1 = "queue one my data".$i; 
$stomp->send($queue1, $msg1, array('persistent' => 'true'));}    
unset($stomp);
?>

cat > consumer.php

<?php 
$queue1  = '/queue/queue1';
try {$stomp = new Stomp('tcp://localhost:61613');}
catch(StompException $e) {die('Connection failed: ' . $e->getMessage());}
$stomp->subscribe($queue1);
while(1){$frame = $stomp->readFrame();
if ( $frame != null) {echo $frame->body; //process your message
echo "\n";  
$stomp->ack($frame);}} unset($stomp);
?> 
```

使用 nohup 启动 consumer.php

```
nohup php consumer.php > consumer.log 2>&1 & 
```

它把这个返回到控制台

```
[1] 32707 
```

创建的启动文件

```
cat > activemqstart.sh

#!/bin/bash
export JAVA_HOME=/usr
/usr/share/php/activemq/bin/activemq & 
```

创建停止文件

```
cat > activemqstop.sh

#!/bin/bash
export JAVA_HOME=/usr
/usr/share/php/activemq/bin/activemq-admin stop 
```

服务配置脚本

```
cat > activemq

#!/bin/bash
#
# activemq       Starts ActiveMQ.
#
# chkconfig: 345 88 12
# description: ActiveMQ is a JMS Messaging Queue Server.
### BEGIN INIT INFO
# Provides: $activemq
### END INIT INFO

# Source function library.
. /etc/init.d/functions

[ -f /etc/init.d/activemqstart.sh ] || exit 0
[ -f /etc/init.d/activemqstop.sh ] || exit 0

RETVAL=0

umask 077

start() {
   echo -n $"Starting ActiveMQ: "
   daemon /etc/init.d/activemqstart.sh
   echo
   return $RETVAL
}
stop() {
   echo -n $"Shutting down ActiveMQ: "
   daemon su -c /etc/init.d/activemqstop.sh activemq
   echo
   return $RETVAL
}
restart() {
   stop
   start
}
case "$1" in
start)
   start
   ;;
stop)
   stop
   ;;
restart|reload)
   restart
   ;;
*)
   echo $"Usage: $0 {start|stop|restart}"
   exit 1
esac

exit $? 
```

然后我设置权限

```
chmod +x /etc/init.d/activemqstart.sh
chmod +x /etc/init.d/activemqstop.sh
chmod +x /etc/init.d/activemq
/sbin/chkconfig --add activemq
/sbin/chkconfig activemq on 
```

清除了 actvimq.log

```
cat /dev/null > /home/username/activemq/data/activemq.log 
```

重新启动

```
reboot 
```

并检查了日志，但它是空的并且 ActiveMQ 没有运行

```
more /home/username/activemq/data/activemq.log 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-16T23:32:34.000

你能在本地试试这个命令吗

```
daemon /etc/init.d/activemqstart.sh 
```

我尝试了相同的命令，但上面的命令对我不起作用，因为守护进程不可用。

如果是这样，请尝试下面，而不是上面。

```
/etc/init.d/activemqstart.sh 
```

# ruby-on-rails - Rails + Capybara：单击带有评估脚本的链接会冻结 webdriver

> ID：12125325
> 
> 赞同：4
> 
> 时间：2012-08-25T20:17:10.487
> 
> 标签：ruby-on-rails, capybara

我在我的`js: true`请求规范中运行以下内容：

```
page.evaluate_script("$('#sign-up').click();") 
```

这成功打开了模态。但是，无论规范中的下一步是什么，webdriver 都会在此时冻结。长时间的停顿后，我得到：

```
 Failure/Error: 
 Timeout::Error:
   Timeout::Error
 # ./spec/requests/my_spec.rb:14:in `block (3 levels) in <top (required)>' 
```

在这种情况下，我想使用`evaluate_script`而不是“click_on”，因为该特定链接上没有`href`属性（click_on 不起作用）。如何让它在不超时的情况下工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T20:21:37.383

这是由于 Selenium 中的一个错误。在这里找到答案：[https ://groups.google.com/forum/?fromgroups=#!topic/ruby-capybara/YcZwyPdMJFU](https://groups.google.com/forum/?fromgroups=#!topic/ruby-capybara/YcZwyPdMJFU)

替换为以下内容时它不会挂起`page.evaluate_script`：

```
page.driver.browser.execute_script 
```

# java - 简单的正则表达式匹配前导零

> ID：12125327
> 
> 赞同：3
> 
> 时间：2012-08-25T20:17:29.270
> 
> 标签：java, regex

我是否误解了有关 Java 正则表达式的内容？以下内容不应该与前导零匹配：

```
public class Testit {
    public static void main(String[] args) {
        format("0115724848");
    }

    private static void format(String elementToFormat) {
        if (elementToFormat.matches("^0")) {
            System.out.println("leading zero:" + elementToFormat);
        } else {
            System.out.println("no leading zero:" + elementToFormat);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T20:20:29.093

`String.match`想要匹配整体`String`，而你的正则表达式`^0` *不*匹配。

相反，您需要一个正则表达式：`0.*`，这意味着“字符串以 0 开头，后跟零个或多个字符”。或者，根据您的需要，`0\d*`，这意味着“字符串以 0 开头，后跟零个或多个数字”，这就是您的示例输入的样子。

```
if ("0115724848".matches("0\\d*"))
    System.out.println("leading zero."); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-25T20:22:50.397

`matches`尝试将模式与*整个*输入字符串匹配......并且您的输入字符串不仅仅是“字符串开头后跟 0”。

要么你需要`"0.*"`（这`^`是不必要的，因为`matches`将匹配*整个*字符串）或者你可以创建一个`Pattern`然后使用：

```
if (pattern.matcher(text).lookingAt()) 
```

当然，不清楚你为什么在这里使用正则表达式，因为你可以使用：

```
if (text.startsWith("0")) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-25T20:20:10.227

这是您应该使用的模式：

> ^0.*

还有为什么不使用*startsWith("0")* - 更简单

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-25T20:33:43.287

检查此代码..它应该可以工作。

```
public class Testit {
    public static void main(String[] args) {
        format("0115724848");
    }

    private static void format(String elementToFormat) {
        if (elementToFormat.matches("^0.*")) {
            System.out.println("leading zero:" + elementToFormat);
        } else {
            System.out.println("no leading zero:" + elementToFormat);
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-22T17:16:26.750

此正则表达式将匹配带有前导零的数字，但不匹配“0”：/^0+[1-9]/

# php - PHP中字符串的内部表示

> ID：12125336
> 
> 赞同：7
> 
> 时间：2012-08-25T20:19:30.430
> 
> 标签：php, string, memory

我正在 PHP 5.2.10 上编写一个简单的网站解析器。
当使用默认的内部编码（即 ISO-8859-1）时，我总是在同一个函数调用中得到一个错误：

```
$start = mb_strpos($index, '<a name=gr1>'); 
```

> 致命错误：允许的内存大小为 50331648 字节已用尽（尝试分配 11924760 字节）

在这种情况下，字符串 $index 的长度是 2981190 字节——正好是 PHP 尝试分配的 4 倍。

现在，如果我使用

```
mb_internal_encoding('UTF-8') 
```

错误消失。这是否意味着 PHP 为单字节字符串使用更多内存而不是多字节字符串？这怎么可能？有任何想法吗？

UPD：内存使用似乎不依赖于编码：平均 memory_get_usage() 使用 UTF-8 和 ISO-8859-1 几乎相同。我认为问题可能出在 mb_strpos 中。事实上，字符串 $index 具有 Windows-1251 编码（西里尔文），因此它包含对 UTF-8 无效的符号。这可能会导致 mb_strpos 以某种方式尝试转换或仅将额外的内存用于某些需要。将尝试在 mb_strpos 的来源中找到答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T05:41:45.117

抱歉，如果您已经考虑过这些潜在问题。

多字节字符串函数将检查 UTF-8 编码是否有错误，如果有无效字符，则返回空字符串或 false（如 mb_strpos() 的情况： [http://www.serverphorums.com/read.php? 7,552099](http://www.serverphorums.com/read.php?7,552099)

您是否正在使用`===`运算符检查您获得的结果以确保您没有收到`false`而不是`0`？

该`mb_strpos()`函数使用`mbfl_strpos()`，它在必须执行转换时复制字符串（针，干草堆）（导致内存增加，正如您所观察到的）： [https ://github.com/php/php-src/blob/master /ext/mbstring/libmbfl/mbfl/mbfilter.c#L811](https://github.com/php/php-src/blob/master/ext/mbstring/libmbfl/mbfl/mbfilter.c#L811)

所以，我想知道是否使用默认的内部编码（ISO-8859-1）让一切都通过，并且内存限制被击中，而 utf-8 编码由于非法字符而短路并返回 false（如果您正在使用 进行测试`==`，这会使函数看起来只是没有找到匹配项。）

值得一试 ：）

# ios5 - 将单个 UITableViewCell 链接到两个不同的 Segue

> ID：12125337
> 
> 赞同：0
> 
> 时间：2012-08-25T20:19:31.537
> 
> 标签：ios5, uitableview, uistoryboard, uistoryboardsegue, ios

也许这听起来像是我想做的一件非常奇怪的事情，但让我解释一下我的目的。

我正在编写一个链接到 Dropbox 的应用程序，它会向用户显示他的所有文件夹和文件。我想这样写，当用户点击一个文件夹时，应用程序将在文件夹中挖掘以显示它的所有内容。但是，如果用户点击链接到文件而不是文件夹的单元格，我想转换到另一个具有文本编辑器的 segue。

我已经编写了逻辑挖掘，它就像一个魅力，但我似乎无法将单个单元格链接到两个不同的 segue。每当我尝试将 segue 链接到我的文本编辑器时，前一个 segue 就会消失，因此我无法链接到具有相同单元格的两个 segue。

有什么替代方法可以做到这一点？自然，细胞是动态的。我试图克隆单元格并链接到另一个 segue，但我的应用程序会崩溃，因为动态原型显然不能有多个单元格。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T20:58:34.827

好吧，我不完全确定为什么，但是这次我尝试添加两个单元格（一个代表文件夹，另一个代表项目），这次它没有崩溃……所以现在我有两个单元格可以打开点击时相应的队列。

# java - Java + ServerSocket + 防火墙

> ID：12125339
> 
> 赞同：0
> 
> 时间：2012-08-25T20:19:33.347
> 
> 标签：java, sockets, firewall, serversocket

我有一个使用 ServerSocket 用 Ja​​va 编写的服务器。

我有一个客户端，它通过公司防火墙阻止除公共端口之外的所有内容。

我已经在 SMTP 端口 (#25) 上启动了服务器。

有防火墙的用户连接到它，到目前为止一切正常。

然后服务器处理 ServerSocket.accept()。据我了解，它会在随机端口上创建一个套接字（每次端口号都不同）。并且由于防火墙而失败。

我的问题是 - 我怎样才能让 ServerSocket.accept() 从我的白名单中为套接字选择一个端口？我知道它不适合大规模在线，但我想让我的一个朋友能够连接到我的服务器。

可能吗？如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T20:34:48.743

服务器套接字不选择随机端口。选择随机端口的是客户端套接字。我的猜测是你的防火墙很聪明，它知道检测连接是否被某种 dpi（深度数据包检查）批准。

如果你想误导它，你可以尝试在前 2-3 个数据包中运行看起来像 smtp 的数据，然后切换到你的协议。

另一种选择是在系统外部使用一种连接器，在这种情况下，两台机器都是通过第三个客户端连接的客户端（有很多这样的代理）

# regex - 正则表达式将引用的部分作为一个单词处理，包括转义支持

> ID：12125341
> 
> 赞同：0
> 
> 时间：2012-08-25T20:19:55.727
> 
> 标签：regex

我知道已经有与此非常相似的问题，但我找不到正则表达式处理`\"`作为转义引号。

给定输入：

```
he/l\"lo "//%$&$h w" t "" " " 
```

...我希望有：

```
he/l\"lo
"//%$&$h w"
t
""
" " 
```

我现在的状态是

```
(\"|[^" ])+|"(\"|[^"])*" 
```

根据[http://myregextester.com/index.php](http://myregextester.com/index.php)给了我

```
[0] => he/l\"lo
[1] => "//%$&$h
[2] => w"
[3] => t
[4] => ""
[5] => "
[6] => " 
```

我想知道为什么例如`[1]`and`[2]`是两个元素而不是一个？我的正则表达式的正确部分不应该立即匹配`[1]`吗`[2]`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T21:02:25.837

反斜杠在正则表达式中用于转义。`\"`只是意味着 a `"`，你想要一个黑斜线后跟一个双引号，写成 `\\"`.

这是一个更灵活的表达式，允许各种转义：

```
(?:[^" \\]|\\.)+|"(?:[^"\\]|\\.)*" 
```

# python - 使用 Google App Engine 的 NDB 创建异步方法

> ID：12125342
> 
> 赞同：1
> 
> 时间：2012-08-25T20:20:00.450
> 
> 标签：python, google-app-engine, google-cloud-datastore

我想确保我知道如何创建 tasklet 和异步方法。我所拥有的是一个返回列表的方法。我希望从某个地方调用它，并立即允许进行其他调用。所以我有这个：

```
future_1 = get_updates_for_user(userKey, aDate)
future_2 = get_updates_for_user(anotherUserKey, aDate)
somelist.extend(future_1)
somelist.extend(future_2)

....    

@ndb.tasklet
def get_updates_for_user(userKey, lastSyncDate):
    noteQuery = ndb.GqlQuery('SELECT * FROM Comments WHERE ANCESTOR IS :1 AND modifiedDate > :2', userKey, lastSyncDate)
    note_list = list()
    qit = noteQuery.iter()
    while (yield qit.has_next_async()):
        note = qit.next()
        noteDic = note.to_dict()
        note_list.append(noteDic)
    raise ndb.Return(note_list) 
```

这段代码是否符合我的预期？也就是说，这两个调用会异步运行吗？我是否正确使用期货？

**编辑：**经过测试，代码确实产生了预期的结果。我是 Python 的新手 - 有哪些方法可以测试这些方法是否正在异步运行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T01:21:10.843

很难自己验证这些方法是否同时运行——您必须进行大量登录。此外，在开发应用服务器中，它会更加困难，因为它并没有真正并行运行 RPC。

您的代码看起来不错，它`yield`在正确的位置使用。

我唯一的建议是命名你的函数`get_updates_for_user_async()`——它与 NDB 本身使用的约定相匹配，并且向你的代码的读者暗示该函数返回一个 Future 并且应该让出以获得实际结果。

另一种方法是使用对象`map_async()`上的方法`Query`；它会让你编写一个只包含`to_dict()`调用的回调：

```
@ndb.tasklet
def get_updates_for_user_async(userKey, lastSyncDate):
  noteQuery = ndb.gql('...')
  note_list = yield noteQuery.map_async(lambda note: note.to_dict())
  raise ndb.Return(note_list) 
```

高级提示：您可以通过删除`@ndb.tasklet`装饰器并仅返回由以下方式返回的 Future来进一步简化此操作`map_async()`：

```
def get_updates_for_user_Async(userKey, lastSyncDate):
  noteQuery = ndb.gql('...')
  return noteQuery.map_async(lambda note: note.to_dict()) 
```

这是对仅包含一个 yield 并立即返回所产生值的异步函数的一般轻微优化。（如果你没有立即得到这个，那么你就是一个很好的公司，并且它冒着被未来的维护者破坏的风险。:-)

# python - 使用列表来划分和存储要在变量中使用的字符串

> ID：12125362
> 
> 赞同：1
> 
> 时间：2012-08-25T20:22:57.417
> 
> 标签：python, list

在[上一个问题](https://stackoverflow.com/questions/12124275/splitting-a-string-by-capital-letters-python)中，有人建议，为了分割字符串并存储它，我应该使用一个列表，如下所示：

```
[a for a in re.split(r'([A-Z][a-z]*)', 'MgSO4') if a]
['Mg', u'S', u'O', u'4'] 
```

这次我想问的是如何使用它来将创建的不同字符串存储到变量中，以便我可以在我拥有的 CSV 文件中查找它们，如果可能的话。它说“MgSO4”将来自一个名为“公式”的变量，该变量由 raw_input 生成，如下所示：

```
formula = raw_input("Enter formula: ") 
```

完整的程序代码可以在[这里](http://pastebin.com/3G761hb0)找到，我在下面包含了更相关的部分。提前感谢您的帮助！

```
formula = raw_input("Enter formula: ")

[a for a in re.split(r'([A-Z][a-z]*)', 'MgSO4') if a]

weight_sum = sum(float(formul_data.get(elem.lower())) for elem in elements)
print "Total weight =", weightSum 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T21:22:36.963

如果您的目标是能够将构成分子的原子的分子量相加，我建议您对正则表达式进行一些不同的处理。不要将数字与拆分列表中的元素符号混合，而是将它们附加到前面的元素（如果没有数字，则附加 1）。这是我的做法：

```
import re

# a partial table of atomic weights, replace with something better!
weights = { "H" : 1,  "Na": 11, "Mg": 12, "C" : 12, "N" : 14,
            "O" : 16, "F" : 19, "Al": 27, "S" : 32, "Cl": 35, 
      }

def molecularWeight(formula):
    matches = re.findall(r"([A-Z][a-z]?)([0-9]*)", formula)
    return sum(weights[symbol] * (int(count) if count else 1)
               for (symbol, count) in matches) 
```

为了使它适合您显示的代码，请替换`weights[symbol]`为类似的东西`formul_data.get(symbol.lower(), 0)`（或在代码中通过符号获得适当的原子量所需的任何东西）。

只要没有括号，这应该处理任何经验公式和许多结构公式。要解决带括号的公式，您需要制作更好的解析器，因为简单的正则表达式不起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T20:29:13.590

运行后

```
>>> import re
>>> elements = [a for a in re.split(r'([A-Z][a-z]*)', 'MgSO4') if a] 
```

您可以使用索引访问拆分的部分

```
>>> print elements[0]
'Mg'
>>> print elements[-1]  # print the last element
'4' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-25T20:58:54.447

这只是一个猜测，但您可能没有意识到`re.split`代码可以应用于任何字符串，包括您从中读取的字符串`raw_input`。这是你要求的吗？

```
formula = raw_input("Enter formula: ")

elements = [a for a in re.split(r'([A-Z][a-z]*)', formula) if a]

weight_sum = sum(float(formul_data.get(elem.lower(), 0)) for elem in elements)
print "Total weight =", weight_sum 
```

# r - 为什么中位数跳闸 data.table （整数与双精度）？

> ID：12125364
> 
> 赞同：35
> 
> 时间：2012-08-25T20:23:46.850
> 
> 标签：r, integer, double, data.table, median

我有一个名为 enc.per.day 的 data.table 用于每天的遭遇。它有 2403 行，其中指定了服务日期和当天就诊的患者人数。我想查看在任何类型的工作日看到的患者的中位数。

```
enc.per.day[,list(patient.encounters=median(n)),by=list(weekdays(DOS))] 
```

那行给出了一个错误

> ( enc.per.day `[.data.table`, , list(patient.encounters = median(n)), 中的错误：j 的列不评估为每个组的一致类型：第 4 组的结果具有第 1 列类型“整数”但期望输入“双”

以下都运行良好

```
tapply(enc.per.day$n,weekdays(enc.per.day$DOS),median)
enc.per.day[,list(patient.encounters=round(median(n))),by=list(weekdays(DOS))]
enc.per.day[,list(patient.encounters=median(n)+0),by=list(weekdays(DOS))] 
```

**到底是怎么回事？**我花了很长时间才弄清楚为什么我的代码不起作用。

顺便说一下，底层向量 enc.per.day$n 是一个整数

```
storage.mode(enc.per.day$n) 
```

返回“整数”。此外，data.table 中的任何地方都没有 NA。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-08-25T21:43:24.033

TL;DR 换`median`行`as.double()`

`median()`'绊倒' **data.table**因为 --- 即使只传递整数向量 ---`median()`有时返回一个整数值，有时返回一个双精度值。

```
## median of 1:3 is 2, of type "integer" 
typeof(median(1:3))
# [1] "integer"

## median of 1:2 is 1.5, of type "double"
typeof(median(1:2))
# [1] "double" 
```

用一个最小的例子重现你的错误信息：

```
library(data.table)
dt <- data.table(patients = c(1:3, 1:2), 
                 weekdays = c("Mon", "Mon", "Mon", "Tue", "Tue"))

dt[,median(patients), by=weekdays]
# Error in `[.data.table`(dt, , median(patients), by = weekdays) : 
#   columns of j don't evaluate to consistent types for each group: 
#   result for group 2 has column 1 type 'double' but expecting type 'integer' 
```

**data.table**抱怨是因为，在检查了要处理的第一组的值之后，它得出的结论是，好的，这些结果将是“整数”类型。但是马上（或者在你的第 4 组中），它被传递了一个“double”类型的值，它不适合它的“整数”结果向量。

* * *

**data.table**可以改为累积结果，直到分组计算结束，然后在必要时执行类型转换，但这将需要大量额外的降低性能的开销；相反，它只是报告发生的事情并让您解决问题。在第一个组运行后，它知道结果的类型，它分配一个该类型的结果向量，只要组的数量，然后填充它。如果它稍后发现某些组返回超过 1 个项目，它将根据需要增长（即重新分配）该结果向量。但在大多数情况下，`data.table`对结果最终大小的第一次猜测是第一次正确（例如，每组 1 行结果），因此速度很快。

在这种情况下，使用`as.double(median(X))`而不是`median(X)`提供了一个合适的修复。

（顺便说一句，您的版本使用`round()`有效，因为它总是返回“double”类型的值，正如您可以通过键入看到的那样`typeof(round(median(1:2))); typeof(round(median(1:3)))`。）

# android - 在 SimpleCursorAdapter 中将毫秒字符串转换为格式化的日期字符串

> ID：12125366
> 
> 赞同：2
> 
> 时间：2012-08-25T20:24:00.170
> 
> 标签：android, adapter

我正在`String`从我的`SQLite`数据库中检索毫秒，并希望将其转换为格式化的 date `String`。它基本上可以工作，但当我在数组中尝试它时却不行（见下文）。它抛出一个`NumberFormatException`. 我怎样才能解决这个问题？

```
adapter = new SimpleCursorAdapter(this, R.layout.listrow, cursor,
        new String[] { getDate(Long.parseLong(Database.KEY_DATE), "dd. MMMM yyyy hh:mm:ss") , Database.KEY_NAME },
        new int[] {R.id.text1, R.id.text2}, 0);

public static String getDate(Long milliSeconds, String dateFormat){
SimpleDateFormat formatter = new SimpleDateFormat(dateFormat);
Calendar calendar = Calendar.getInstance();
calendar.setTimeInMillis(milliSeconds);
return formatter.format(calendar.getTime());
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-25T20:36:18.933

在从`new SimpleCursorAdapter`. 这意味着您需要创建自己的`SimpleCursorAdapter`类型并覆盖`setViewText`。

像这样的东西：

```
adapter = new MySimpleCursorAdapter(this, R.layout.listrow, cursor,
        new String[] { Database.KEY_DATE , Database.KEY_NAME },
        new int[] {R.id.text1, R.id.text2}, 0);

// ...

public static String getDate(Long milliSeconds, String dateFormat) {
    SimpleDateFormat formatter = new SimpleDateFormat(dateFormat);
    return formatter.format(milliSeconds);
}

// In MySimpleCursorAdapter.java:

public class MySimpleCursorAdapter extends SimpleCursorAdapter {
    @Override
    public void setViewText(TextView v, String text) {
        if (v.getId() == R.id.text1) { // Make sure it matches your time field
            // You may want to try/catch with NumberFormatException in case `text` is not a numeric value
            text = WhateverClass.getDate(Long.parseLong(text), "dd. MMMM yyyy hh:mm:ss");
        }
        v.setText(text);
    }
} 
```

# javascript - 如何使刻度四舍五入到#的最接近的倍数？

> ID：12125367
> 
> 赞同：6
> 
> 时间：2012-08-25T20:24:07.973
> 
> 标签：javascript, axis, d3.js, rounding

```
x.scale = d3.time.scale().domain(x.extent).range([0, dimensions.graph.width]); 
```

此代码使用`x.extent`( `[Wed Aug 01 2012 00:00:00 GMT+0300 (EEST), Tue Aug 07 2012 00:00:00 GMT+0300 (EEST)]`) 和图形宽度 (1000) 生成`x`值比例。但是，我需要将此值四舍五入为最接近的 25 ( `Math.round(x/25)*25`) 的倍数。

通过这样做，我想获得现在定义为的精确宽度刻度：

```
x.axis = d3.svg.axis()
    .ticks(d3.time.days, 1)
    .tickSize(10, 5, 0)
    .scale(x.scale); 
```

如何扩展`x.scale`到舍入到最接近的 25 倍数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2019-03-26T08:31:50.327

正确答案是`interpolateRound`，来自文档

> 返回两个数字 a 和 b 之间的插值器；插值器类似于`interpolateNumber`，除了它将结果值四舍五入到最接近的整数。

```
var xScale = d3.scaleLinear()
    .domain([0, 100])
    .range([0, width])
    .interpolate(d3.interpolateRound); // <-- round interpolation 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-22T15:50:07.060

Are you looking for the [nice](https://github.com/mbostock/d3/wiki/Quantitative-Scales#wiki-linear_nice) function?

```
x.scale = d3.time.scale().domain(x.extent)
            .range([0, dimensions.graph.width]).nice(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T19:14:53.163

也许我误解了，但是您不能在应用缩放功能后按照您的建议转换结果吗？IE：

```
function roundScale(origVal) { return Math.round(x.scale(origVal)/25) * 25;} 
```

然后使用该值设置属性：

```
.attr("x", function(d) { return roundScale(d.value); } 
```

# android-intent - 安装 Android 应用的修改版本

> ID：12125368
> 
> 赞同：0
> 
> 时间：2012-08-25T20:24:12.870
> 
> 标签：android-intent

我从 Android Market 获得了一些 Android 应用程序的开源代码。我想制作一个我可以玩的第二个版本，同时仍将官方版本保留在我的设备上。

我尝试在@string/app_name 中更改应用程序名称，并在Properties->Run/Debug Settings 中更改启动配置名称。它在清单文件中有一个活动别名，我改变了它。为了更好地衡量，我还为应用程序和活动别名添加了 android:label="@string/app_name" 到意图过滤器。我还继续将默认活动重构为不同的名称。

我仍然收到以下错误：

由于应用程序签名不同，重新安装失败。您必须完全卸载应用程序。警告：这将删除应用程序数据！

如果我卸载原始应用程序，我可以毫无问题地从 Eclipse 安装/启动/运行，但我真的希望能够同时拥有两个版本。我不介意更改名称或任何使之发生的事情。我还缺少什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T09:56:02.527

如前所述，您必须将应用程序包重命名为新的。但一定要修改AndroidManifest.xml中

`<manifest xmlns:android="http://schemas.android.com/apk/res/android" package="your_new_package"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T02:02:40.197

看起来我也可以通过更改包名称来做到这一点。在 Eclipse 中，右键单击项目，选择 Android Tools -> Rename Application Package。我不得不修复 Manifest 文件，因为它已损坏。

# svn - svn的symfony安装问题

> ID：12125372
> 
> 赞同：0
> 
> 时间：2012-08-25T20:25:16.113
> 
> 标签：svn, symfony1

我正在尝试按照说明通过 svn 安装 symfony：

```
Installing from Subversion (recommended)

If you use Subversion, it is even better to use the svn:externals property to embed symfony into your project in the lib/vendor/ directory:

$ svn pe svn:externals lib/vendor/
If everything goes well, this command will run your favorite editor to give you the opportunity to configure the external Subversion sources. 
```

所以我在 /var/www/myproject 和 myproject 中有我的项目文件，当我尝试执行 svn pe svn:externals lib/vendor/ 时，我确实有 /lib/vendor 我收到以下错误：

```
svn: 'lib/vendor' is not a working copy 
```

知道为什么吗？

所以后来我确定 lib/vendor 中没有 .svn 文件夹所以我尝试执行 svn add lib/vendor 但它给了我：

```
svn: 'lib' is not a working copy 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T20:29:26.730

这适用于 Symfony1，[Symfony2](http://symfony.com/)优于[git](http://git-scm.com/) [尽管您也可以使用[svn 进行版本控制](http://symfony.com/doc/current/cookbook/workflow/new_project_svn.html)]。

# c# - 同一列表中的多个泛型类型并调用它们的方法

> ID：12125374
> 
> 赞同：4
> 
> 时间：2012-08-25T20:25:35.977
> 
> 标签：c#, generics

我在业余时间制作了一个对象验证框架来学习一些东西，并可能将它用于一些学校项目。

我有我的通用 Rule 类，它看起来像这样：

```
class Rule<T>
{
    string propertyName;
    Func<T, bool> ruleLambda;

    bool IsBroken(T value)
    {
        return ruleLambda(value);
    }
} 
```

将被验证的对象看起来有点像这样：

```
class Example
{
    List<Rule<?>> MyRules; // can take all types of rules

    List<Rule<T>> Validate<T>(string propertyName, T value)
    {
        List<Rule<T>> brokenRules = new List<Rule<T>>();
        foreach (Rule rule in MyRules.Where(r => r.propertyName == propertyName))
        {
            if (rule.IsBroken(value))
                brokenRules.Add(rule);
        }
        return brokenRules;
    }
} 
```

其中`T value`参数将是 Example 类的属性之一的值，它可以是任何类型。

只要设置了属性，就会调用该`Validate<T>`方法。

问题在于类的规则列表。特别是`List<Rule<?>>`上面的行。我想将给定类的所有规则存储在同一个列表中。

唉，C# 没有像 Java 这样的泛型类型的通配符。

我该怎么做？

使用对象而不是 T 的非泛型接口或基类可以工作，但我将如何调用泛型规则的`IsBroken`方法而不是非泛型方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T21:02:19.937

我会将您的规则存储`object`在`Example`类中，并用于`Enumerable.OfType<T>`查找给定类型的匹配规则：

```
class Example
{
    private List<object> rules;

    List<Rule<T>> Validate<T>(string propertyName, T value)
    {
        return this.rules.OfType<Rule<T>>()
            .Where(r => r.PropertyName == propertyName && r.IsBroken(value))
            .ToList();
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-25T20:42:57.347

如果我需要这样的东西，我会使用接口或非泛型基类。例如，您可以创建一个接口：

```
public interface IRule
{
  //non-generic properties & methods
}

public class Rule<T> : IRule
{
  //implementation
} 
```

然后创建一个接口列表：

```
private List<IRule> MyRules; 
```

如果你想让从接口到泛型的转换变得容易，你可以添加一个扩展方法：

```
public static Rule<T> ToGeneric<T>(this IRule rule)
{
  return rule as Rule<T>;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T03:02:44.840

我已经尝试了一些东西，并且发现了一些非常适合我需要的东西。我`Rule<T>`从一个基本的抽象规则类继承了一个通用`IsBroken`方法：

```
abstract class Rule
{
    string propertyName;
    Func<object, bool> objectRule;

    bool IsBroken<T>(T value)
    {
        Rule<T> rule = this as Rule<T>;
        if (rule == null)
            return objectRule(value);

        return rule.IsBroken(value);
    }
} 
```

如您所见，我尝试使用方法中的泛型类型参数将基类转换为其泛型对应物`IsBroken`。

此外，在创建`Rule<T>`实例时，我将 a 发送`Func<object, bool>`到其基类受保护的构造函数：

```
public Rule(string propertyName, Func<T, bool> ruleLambda)
    : base(propertyName, ConvertToObjectFunc(ruleLambda))
{
} 
```

转换方法如下所示：

```
static Func<object, bool> ConvertToObjectFunc(Func<T, bool> func)
{
    return new Func<object, bool>(o => func((T)o));
} 
```

但是，如果它不能将 o 转换为类型 T，它就会崩溃。所以我写了这个……东西：

```
static Func<object, bool> ConvertToObjectFunc(Func<T, bool> func)
{
    return new Func<object, bool>
    (
        o =>
        {
            try
            {
                T obj = (T)o;
                return func(obj);
            }
            catch { return true; } // rule is broken by default
        }
    );
} 
```

这很丑陋，但它有效。希望这可以帮助其他人。

# java - 膨胀类 com.actionbarsherlock.internal.widget.ActionBarContainer 时出错

> ID：12125376
> 
> 赞同：2
> 
> 时间：2012-08-25T20:26:12.843
> 
> 标签：java, android, actionbarsherlock

我正在尝试将 abs 集成到我的应用程序中，但我不断收到有关无法充气 com.actionbarsherlock.internal.widget.ActionBarContainer 的错误消息。任何人都可以帮忙吗？

“样式.xml”

```
<resources>

    <style name="AppTheme" parent="Theme.Sherlock.Light" />

</resources> 
```

“activity_main.xml”

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:text="@string/hello_world"
        tools:context=".MainActivity" />

</RelativeLayout> 
```

“Android 清单.xml”

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.e.ffgh"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>
</manifest> 
```

“MainActivity.java”

```
package com.e.ffgh;

import com.actionbarsherlock.app.SherlockActivity;

import android.os.Bundle;

public class MainActivity extends SherlockActivity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
} 
```

> 08-26 06:13:36.442: E/AndroidRuntime(1464): java.lang.RuntimeException: 无法启动活动 ComponentInfo{com.e.ffgh/com.e.ffgh.MainActivity}: android.view.InflateException: 二进制XML 文件第 26 行：膨胀类 com.actionbarsherlock.internal.widget.ActionBarContainer 时出错

**更新：**瘦身后。以最低限度开始了一个 BS 项目。它适用于 ICS，但在 Gingerbread 或 Froyo 中仍然给我“错误膨胀类 com.actionbarsherlock.internal.widget.ActionBarContainer”错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T03:25:33.573

我意识到每当我修复 ActionBarSherlock 库中的警告时就会出现问题。我不认为他们会有所作为，但显然他们做到了。我还没有进一步检查我在库中修复了哪些导致编译出错的警告，但我认为这是当我禁止在 IcsProgressBar 类中不推荐使用“android.R.attr.animationResolution”的警告时。我稍后会对此进行研究，但重点是，在导入 ActionBarSherlock 库时不要弄乱它。

# eclipse - 使用嵌入式码头调试 jsp

> ID：12125377
> 
> 赞同：1
> 
> 时间：2012-08-25T20:26:23.793
> 
> 标签：eclipse, jsp, jakarta-ee, java-ee-6, embedded-jetty

如何使用 Eclipse 中的嵌入式 Jetty 服务器调试动态 Web 项目中的 jsp 页面？

我什至尝试使用 Eclipse WTP ......但没有用

非常需要快速帮助。即使是一点点线索也会很有帮助

好吧，我正在使用 Maven，我有 Jetty-Maven 插件。我将在 Eclipse 中将应用程序作为远程 Java 应用程序运行到调试。这样我可以调试 .java 文件，但我无法在 .jsp 文件中放置断点。我不确定 Embedded Jetty 将转换后的 .jsp 文件存储在我的 PC 中的什么位置。

我在eclipse中下载了WTP。并以 Reomte Java App 的身份在调试模式下运行我的应用程序，尝试放置断点。无法使用 WTP 放置断点。

我的目标是调试 .java 和 .jsp 文件。（作为远程java应用程序运行不是我的目标，如果可能的话我可以改变它）

# javascript - 如何使用 jQuery 上下文参数？

> ID：12125378
> 
> 赞同：2
> 
> 时间：2012-08-25T20:26:28.807
> 
> 标签：javascript, jquery

jQuery 使用以下语句将自身的一个版本传递给全局范围：

```
window.jQuery = window.$ = jQuery; 
```

如this [SO Post所示。](https://stackoverflow.com/questions/11977604/jquery-module-pattern-not-named-how-is-accessible)

查看[jQuery 源代码](http://code.jquery.com/jquery-latest.js)，我们可以看到定义在 jQuery 的顶级范围内，并且定义如下：

```
// Define a local copy of jQuery
jQuery = function( selector, context ) {
    // The jQuery object is actually just the init constructor 'enhanced'
    return new jQuery.fn.init( selector, context, rootjQuery );
}, 
```

选择器的使用似乎非常简单：只需传入一个字符串即可从 DOM 中选择一个或多个元素。

但是，如何正确使用上下文参数呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T20:37:48.367

来自 jQuery 手册：

> [jQuery()](http://api.jquery.com/jQuery/)
> 
> [...]
> 
> # 选择器上下文
> 
> 默认情况下，选择器从文档根目录开始在 DOM 中执行搜索。但是，可以使用 $() 函数的可选第二个参数为搜索提供替代上下文。例如，要在事件处理程序中进行搜索，可以像这样限制搜索：
> 
> ```
> $('div.foo').click(function() { $('span', this).addClass('bar'); }); 
> ```
> 
> 当对 span 选择器的搜索仅限于 this 的上下文时，只有单击元素内的 span 才会获得附加类。
> 
> 在内部，选择器上下文是使用 .find() 方法实现的，因此`$('span', this)`等价于`$(this).find('span')`.

请注意，jQuery 会查看其参数的存在和类型并采取相应措施。

# sql-server - 临时表索引/性能帮助请求

> ID：12125379
> 
> 赞同：1
> 
> 时间：2012-08-25T20:26:37.690
> 
> 标签：sql-server, sql-server-2008, sql-server-2008-r2, query-performance

这是我之前的帖子的延续：[RowNumber() and Partition By performance help Wanted](https://stackoverflow.com/questions/12117441/rownumber-and-partition-by-performance-help-wanted)

我有一个需要显着提高性能的查询。根据上一篇文章中的建议，我在查询中删除了除一个 cte 之外的所有内容，并实现了一个带有索引的临时表。它仍然很慢...目前 40 分钟并且还在计数，还没有返回数据。一些背景信息：所有数据来自的一张表大约有 500 万行。它上面有几个索引，包括一个唯一的非聚集索引，它由 Symbol、Period 和 TradeDate 列组成，其中包括 Value 列。我还有两个完全相同，但先是 Period，然后是 TradeDate。表上还有一个唯一的聚集索引。什么可以加快这个速度？临时表上的不同索引？抱歉，有一个半重复的帖子。我在这里停滞不前。任何帮助都是巨大的。

```
create table ##smaComp
(
    RowNum          bigint,
    Rank            bigint,
    TradeDate       Date,
    Symbol          Char(6),
    FastPer         int,
    FastVal         Decimal(9,4),
    SlowPer         int,
    SlowVal         Decimal(9,4),
    FastMinusSlow   Decimal(9,4)
)

;with sma as
(
    select t.TradeDate, t.Symbol, t.Period FastPer, t.Value FastVal, t2.Period SlowPer, 
        t2.Value SlowVal, (t.Value-t2.Value) FastMinusSlow
    from tblDailySMA t join tblDailySMA as t2 on t.Symbol = t2.Symbol 
        and t.TradeDate = t2.TradeDate and t2.Period > t.Period
)

insert into ##smaComp
(
    RowNum, Rank, TradeDate, Symbol, FastPer, FastVal, SlowPer, SlowVal, FastMinusSlow
)
select ROW_NUMBER() OVER (PARTITION BY sma.Symbol, sma.FastPer, sma.SlowPer
    ORDER BY sma.TradeDate) as RowNum, DENSE_RANK() OVER (ORDER BY sma.Symbol, sma.FastPer,
    sma.SlowPer) as Rank, sma.TradeDate, sma.Symbol, sma.FastPer, sma.FastVal, 
    sma.SlowPer, sma.SlowVal, sma.FastMinusSlow
from sma

CREATE UNIQUE NONCLUSTERED INDEX [IX_tblDailySMAClustered] ON ##smaComp
(RowNum, Rank)
INCLUDE (Symbol, TradeDate, FastPer, SlowPer, FastVal, SlowVal, FastMinusSlow)

select t.TradeDate as PriorDate, t.FastPer, t.FastVal, t.SlowPer, t.SlowVal,
    t.FastMinusSlow, t2.TradeDate as LatestDate, t2.FastPer, t2.FastVal, t2.SlowPer, 
    t2.SlowVal, t2.FastMinusSlow, (t2.FastMinusSlow * t2.FastMinusSlow) as Comparison
from ##smaComp t join ##smaComp t2
on t.Rank = t2.Rank and t.RowNum = (t2.RowNum - 1) 
```

执行计划，按要求：

```
StmtText
  create table ##smaComps  (   RowNum   bigint,   Rank   bigint,   TradeDate  Date,   Symbol   Char(6),   FastPer   int,   FastVal   Decimal(9,4),   SlowPer   int,   SlowVal   Decimal(9,4),   FastMinusSlow Decimal(9,4)  )
;with sma as  (   select t.TradeDate, t.Symbol, t.Period FastPer, t.Value FastVal, t2.Period SlowPer,     t2.Value SlowVal, (t.Value-t2.Value) FastMinusSlow   from tblDailySMA t join tblDailySMA as t2 on t.Symbol = t2.Symbol     and t.TradeDate = t2.TradeDate and t2.Period > t.Period  )    insert into ##smaComps  (   RowNum, Rank, TradeDate, Symbol, FastPer, FastVal, SlowPer, SlowVal, FastMinusSlow  )  select ROW_NUMBER() OVER (PARTITION BY sma.Symbol, sma.FastPer, sma.SlowPer   ORDER BY sma.TradeDate) as RowNum, DENSE_RANK() OVER (ORDER BY sma.Symbol, sma.FastPer,   sma.SlowPer) as Rank, sma.TradeDate, sma.Symbol, sma.FastPer, sma.FastVal,    sma.SlowPer, sma.SlowVal, sma.FastMinusSlow  from sma

StmtText
  |--Table Insert(OBJECT:([tempdb].[dbo].[##smaComps]), SET:([tempdb].[dbo].[##smaComps].[RowNum] = [Expr1009],[tempdb].[dbo].[##smaComps].[Rank] = [Expr1010],[tempdb].[dbo].[##smaComps].[TradeDate] = [Market].[dbo].[tblDailySMA].[TradeDate] as [t].[TradeDate],[tempdb].[dbo].[##smaComps].[Symbol] = [Expr1011],[tempdb].[dbo].[##smaComps].[FastPer] = [Market].[dbo].[tblDailySMA].[Period] as [t].[Period],[tempdb].[dbo].[##smaComps].[FastVal] = [Expr1012],[tempdb].[dbo].[##smaComps].[SlowPer] = [Market].[dbo].[tblDailySMA].[Period] as [t2].[Period],[tempdb].[dbo].[##smaComps].[SlowVal] = [Expr1013],[tempdb].[dbo].[##smaComps].[FastMinusSlow] = [Expr1014]))
       |--Compute Scalar(DEFINE:([Expr1014]=CONVERT_IMPLICIT(decimal(9,4),[Expr1008],0)))
            |--Top(ROWCOUNT est 0)
                 |--Compute Scalar(DEFINE:([Expr1011]=CONVERT_IMPLICIT(char(6),[Market].[dbo].[tblDailySMA].[Symbol] as [t].[Symbol],0), [Expr1012]=CONVERT_IMPLICIT(decimal(9,4),[Market].[dbo].[tblDailySMA].[Value] as [t].[Value],0), [Expr1013]=CONVERT_IMPLICIT(decimal(9,4),[Market].[dbo].[tblDailySMA].[Value] as [t2].[Value],0)))
                      |--Sequence Project(DEFINE:([Expr1010]=dense_rank))
                           |--Segment
                                |--Segment
                                     |--Sequence Project(DEFINE:([Expr1009]=row_number))
                                          |--Segment
                                               |--Compute Scalar(DEFINE:([Expr1008]=[Market].[dbo].[tblDailySMA].[Value] as [t].[Value]-[Market].[dbo].[tblDailySMA].[Value] as [t2].[Value]))
                                                    |--Parallelism(Gather Streams, ORDER BY:([t].[Symbol] ASC, [t].[Period] ASC, [t2].[Period] ASC, [t].[TradeDate] ASC))
                                                         |--Sort(ORDER BY:([t].[Symbol] ASC, [t].[Period] ASC, [t2].[Period] ASC, [t].[TradeDate] ASC))
                                                              |--Merge Join(Inner Join, MANY-TO-MANY MERGE:([t].[TradeDate], [t].[Symbol])=([t2].[TradeDate], [t2].[Symbol]), RESIDUAL:([Market].[dbo].[tblDailySMA].[Symbol] as [t].[Symbol]=[Market].[dbo].[tblDailySMA].[Symbol] as [t2].[Symbol] AND [Market].[dbo].[tblDailySMA].[TradeDate] as [t].[TradeDate]=[Market].[dbo].[tblDailySMA].[TradeDate] as [t2].[TradeDate] AND [Market].[dbo].[tblDailySMA].[Period] as [t2].[Period]>[Market].[dbo].[tblDailySMA].[Period] as [t].[Period]))
                                                                   |--Parallelism(Repartition Streams, Hash Partitioning, PARTITION COLUMNS:([t].[TradeDate], [t].[Symbol]), ORDER BY:([t].[TradeDate] ASC, [t].[Symbol] ASC))
                                                                   |    |--Index Scan(OBJECT:([Market].[dbo].[tblDailySMA].[IX_tblDailySMA_TrDateNonClust] AS [t]), ORDERED FORWARD)
                                                                   |--Parallelism(Repartition Streams, Hash Partitioning, PARTITION COLUMNS:([t2].[TradeDate], [t2].[Symbol]), ORDER BY:([t2].[TradeDate] ASC, [t2].[Symbol] ASC))
                                                                        |--Index Scan(OBJECT:([Market].[dbo].[tblDailySMA].[IX_tblDailySMA_TrDateNonClust] AS [t2]), ORDERED FORWARD)

StmtText
 CREATE UNIQUE NONCLUSTERED INDEX [IX_tblDailySMAClustered] ON ##smaComps  (RowNum, Rank)  INCLUDE (Symbol, TradeDate, FastPer, SlowPer, FastVal, SlowVal, FastMinusSlow)
 select t.TradeDate as PriorDate, t.FastPer, t.FastVal, t.SlowPer, t.SlowVal,   t.FastMinusSlow, t2.TradeDate as LatestDate, t2.FastPer, t2.FastVal, t2.SlowPer,    t2.SlowVal, t2.FastMinusSlow, (t2.FastMinusSlow * t2.FastMinusSlow) as Comparison  from ##smaComps t join ##smaComps t2  on t.Rank = t2.Rank and t.RowNum = (t2.RowNum - 1)

StmtText
  |--Hash Match(Inner Join, HASH:([t].[Rank], [t].[RowNum])=([t2].[Rank], [Expr1007]), RESIDUAL:([tempdb].[dbo].[##smaComps].[Rank] as [t].[Rank]=[tempdb].[dbo].[##smaComps].[Rank] as [t2].[Rank] AND [tempdb].[dbo].[##smaComps].[RowNum] as [t].[RowNum]=[Expr1007]))
       |--Table Scan(OBJECT:([tempdb].[dbo].[##smaComps] AS [t]))
       |--Compute Scalar(DEFINE:([Expr1006]=[tempdb].[dbo].[##smaComps].[FastMinusSlow] as [t2].[FastMinusSlow]*[tempdb].[dbo].[##smaComps].[FastMinusSlow] as [t2].[FastMinusSlow], [Expr1007]=[tempdb].[dbo].[##smaComps].[RowNum] as [t2].[RowNum]-(1)))
            |--Table Scan(OBJECT:([tempdb].[dbo].[##smaComps] AS [t2])) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T22:13:32.990

查询计划不包含任何可能出错的内容（如嵌套循环爆炸）。

我认为原因是您在所有“时期”中都交叉加入。我的猜测是您的数据每个 TradeDate 和 Symbol 包含许多（100 个？）周期。这意味着 SQL Server 必须处理二次数据量。谓词`t2.Period > t.Period`过滤了大约一半的行，但另一半仍然存在。

所以原则上数据量非常高。不确定这是否可以优化。您需要所有数据还是只需要一个子集？如果您需要所有这些，我认为没有什么可以做的。

您可以通过将查询限制为一个 TradeDate 和 Symbol 并查看行数来测试这个假设。

# objective-c - 带有 ARC 的 POSIX 回调和 NSAutoreleasePool

> ID：12125382
> 
> 赞同：4
> 
> 时间：2012-08-25T20:27:03.023
> 
> 标签：objective-c, automatic-ref-counting, posix, nsautoreleasepool

根据这个 Apple[页面](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsautoreleasepool_Class/Reference/Reference.html)，我读到在 POSIX 线程上与 Cocoa 交互时，我应该创建一个`NSAutoreleasePool`.

> 如果你在 Application Kit 的主线程之外进行 Cocoa 调用——例如，如果你创建一个仅 Foundation 的应用程序或者如果你分离一个线程——你需要创建你自己的自动释放池。

不幸的是，`NSAutoreleasePool`ARC 不允许使用。

那么我应该怎么做才能保证始终有一个可用于自动发布的任何 ARC 代码的池？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T20:30:03.387

使用[`@autoreleasepool`](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmAutoreleasePools.html#//apple_ref/doc/uid/20000047-SW5).

```
@autoreleasepool
{
    // make Cocoa calls here
} 
```

这允许编译器正确推断跨越池边界的对象的生命周期，这是 ARC 的要求。（这就是你不能使用的原因`NSAutoreleasePool`。）作为奖励，它也更快。

# html - HTML div 创建块链接

> ID：12125383
> 
> 赞同：0
> 
> 时间：2012-08-25T20:27:17.110
> 
> 标签：html, hyperlink

我是一个非常初学者的网络开发人员。对它非常陌生，我决定是时候真正取得一些进展了。

无论如何，我遇到了一个明显的块链接问题，该链接位于我网站标题下方的任何地方。正如您从这个屏幕截图中看到的那样：http: [//puu.sh/YLDH](http://puu.sh/YLDH)它不应该链接到我的光标当前所在的任何地方。

可以在这里找到我的 HTML 代码以及我的 CSS（不长）： http: [//pastie.org/4587834](http://pastie.org/4587834)

如果有人可以提供帮助，那就太棒了。

非常感谢！

汤姆。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T20:30:11.260

你忘了关闭`<a>`标签。

试试这个代码：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Tom Richardson</title>
  <link href="style.css" rel="stylesheet" type="text/css" media="screen" />
</head>
<body bgcolor="d6d6d6">
      <div id="header">
            <div id="logo">
                <div id="navbarlinks">
                  <ul id="navlist">
                  <li><a href="About.html"><img src="images/About.png" alt="About" width="108" height="48" /></a></li>
                  <li><a href="Contact.html"><img src="images/Contact%20Me.png" alt="Contact%20Me" width="202" height="48" /></a></li>
                  <li><a href="JBN.html"><img src="images/JBN.png" alt="JBN" width="65" height="48" /></a></li>
                  <li><a href="Blog.html"><img src="images/Blog.png" alt="Blog" width="83" height="48" /></a></li>
                  </ul>
                </div>
            </div>
      </div>
      <div id="contactform">

    </div>

</body>  
</html> 
```

# api - Trello Api：使用 PHP 代码创建新卡片

> ID：12125384
> 
> 赞同：4
> 
> 时间：2012-08-25T20:27:32.830
> 
> 标签：api, trello

当新用户注册我们的网络应用程序时，我想创建一个新的 Trello 卡。

为此，我为我的用户请求了一个“读、写”令牌（我们将其命名为“myToken”），并且我有我的应用程序密钥（我们将其命名为“myKey”）。

因为找不到任何 PHP-Wrapper，所以我首先使用 Fiddler 来测试 HTTP-Post 请求。具体来说，我尝试了以下方法：

```
HTTP-POST

URL: 
http://api.trello.com/1/cards

Request-Headers: 
User-Agent: Fiddler
Host: api.trello.com
Content-Length: 177

Request Body:
key=myKey&token=myToken&name=newCardName&desc=newCarddescription&idList=myListId 
```

但是，这不起作用。我得到了一个 HTML 代码，它显示了一个告诉用户登录的网站！我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T10:58:20.083

谢谢@Daniel LeCheminant。我犯了两个错误：

1.）我使用 http 而不是 https 2.）我将变量放在请求正文中。即使它是一个发布请求，trello 也需要 url 本身中的变量

这个解决方案对我有用：

```
https://api.trello.com/1/cards?key=myKey&token=myToken&name=newCardName&desc=newCarddescription&idList=myListId 
```

# mysql - 从特定表中最后插入的 id

> ID：12125385
> 
> 赞同：17
> 
> 时间：2012-08-25T20:27:36.833
> 
> 标签：mysql

```
SELECT LAST_INSERT_ID() as id FROM table1 
```

为什么此查询有时会返回 table1 以外的另一个表的最后插入的 id？我在 Node.js（db-mysql 插件）中调用它，我只能做查询。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-08-25T20:36:38.043

`LAST_INSERT_ID()`只能告诉你`ID`最近`ID` *为整个数据库连接*自动生成的，而不是每个单独的表，这也是为什么查询应该只读取`SELECT LAST_INSERT_ID()`- 而不指定表的原因。
一旦您`INSERT`在该连接上启动另一个查询，它就会被覆盖。如果您希望在`ID`插入某个表时生成，则*必须*在执行此操作后立即运行`SELECT LAST_INSERT_ID()`（或使用一些为您执行此操作的 API 函数）。

如果您想要`ID`任意表中当前的最新数据，则必须`SELECT MAX(id)`在该表上执行 a，其中列`id`的名称在哪里`ID`。但是，这不一定是最近生成`ID`的，以防该行已被删除，也不一定是从您的连接生成的，以防另一个连接设法`INSERT`在您自己`INSERT`和您选择的`ID`.

（作为记录，您的查询*实际上*返回 N 行，其中包含该数据库连接上最近生成的 ID，其中 N 是 中的行数`table1`。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-06-18T07:47:36.887

SELECT id FROM tableName ORDER BY id DESC LIMIT 1

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-25T20:51:24.007

我通常选择自动递增的 ID 字段，按字段降序排列并将结果限制为 1。例如，在 wordpress 数据库中，我可以通过执行以下操作获取 wp_options 表的最后一个 ID：

```
SELECT option_id FROM wp_options ORDER BY option_id DESC LIMIT 1; 
```

希望有帮助。

**编辑**- 锁定表以避免更新可能导致返回错误 ID 的表可能是有意义的。

```
LOCK TABLES wp_options READ;
SELECT option_id FROM wp_options ORDER BY option_id DESC LIMIT 1; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-14T13:24:27.630

试试这个。这是有效的

```
select (auto_increment-1) as lastId
from information_schema.tables
where table_name = 'tableName'
and table_schema = 'dbName' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-29T04:20:02.573

如果我知道我永远不会关心生成的 id，我只会`auto_increment`在 MySQL 或SQL Server 中使用。`identity(1,1)`

`select last_insert_id()`是简单的出路，但很危险。

处理相关 id 的一种方法是将它们存储在 util 表中，例如：

```
create table correlatives(
    last_correlative_used int not null, 
    table_identifier varchar(5) not null unique
); 
```

你也可以创建一个存储过程来生成并返回X表的下一个id

```
drop procedure if exists next_correlative;
DELIMITER //
create procedure next_correlative(
    in in_table_identifier varchar(5)
)
BEGIN
    declare next_correlative int default 1;

    select last_correlative_used+1 into next_correlative from correlatives where table_identifier = in_table_identifier;

    update correlatives set last_correlative_used = next_correlative where table_identifier = in_table_identifier;

    select next_correlative from dual;
END //
DELIMITER ; 
```

使用它

```
call next_correlative('SALES'); 
```

这允许您在插入记录之前保留 ID。有时您希望在完成插入之前在表单中显示下一个 id，并有助于将其与其他调用隔离开来。

这是一个测试脚本来搞乱：

```
create database testids;

use testids;

create table correlatives(
    last_correlative_used int not null, 
    table_identifier varchar(5) not null unique
);

insert into correlatives values(1, 'SALES');

drop procedure if exists next_correlative;
DELIMITER //
create procedure next_correlative(
    in in_table_identifier varchar(5)
)
BEGIN
    declare next_correlative int default 1;
    select last_correlative_used+1 into next_correlative  from correlatives where table_identifier = in_table_identifier;
    update correlatives set last_correlative_used = next_correlative where table_identifier = in_table_identifier;
    select next_correlative from dual;
END //
DELIMITER ;

call next_correlative('SALES'); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-07T19:01:51.070

如果您想使用这些解决方法：

*   SELECT id FROM tableName ORDER BY id DESC LIMIT 1
*   从表名中选择 MAX(id)

建议在插入行后使用**where**子句。没有这个，您将遇到**不一致的问题**。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2018-12-26T21:22:01.063

最简单的方法：select max(id) from table_name;

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2020-06-21T08:54:03.303

在我的表中 inv_id 是自动增量

出于我的目的，这是可行的

```
select `inv_id` from `tbl_invoice`ORDER BY `inv_id` DESC LIMIT 1; 
```

# html - 对齐在Firefox上不起作用

> ID：12125387
> 
> 赞同：1
> 
> 时间：2012-08-25T20:27:54.480
> 
> 标签：html, css, firefox

垂直和水平对齐和高度百分比在 Firefox 中无法正常工作虽然它在 IE 和 Chrome 上工作正常，但我在 html 和正文中将高度和宽度设置为 100%

```
html,body { heigh:100% ; width:100% } 
```

我尝试了所有可能的解决方案`text-align: -moz-center; display:block;` ，例如这是我的代码

```
<table cellpadding="0" cellspacing="0" border="0" style="width: 100%; height: 93%;">
    <tr style="height: 42px; width: 100%">
        <td style="width: 80px; background-image: url(Images/logo.png); background-repeat: no-repeat;
            height: 42px;">
        </td>
        <td style="height: 42px">
        </td>
    </tr>
    <tr align="center" valign="middle">
        <td style="height: 196px;" align="center" valign="middle">
            <table class="partTable" style="padding-bottom: 20px">
           <tr>
                    <td align="center" style="font-size: xx-large; font-family: Arial Black; color: #C11B17">
                        <span>
                            <%=System.Configuration.ConfigurationManager.AppSettings["AppName"]%>
                        </span>
                    </td>
                </tr>
            </table>
            <table border="0" style="text-align: -moz-center; vertical-align: middle; display: block;
                margin: 0 auto;">
                <tr>
                    <td valign="middle" class="partHolder" style="width: 314px; height: 201px;">
                 --Content
                    </td>
                </tr>
            </table>
    </tr> 
```

注意：表格不占页面的 93%。它就像一个汽车。当我把它放在`<!DOCTYPE html>`html 标签之前时就发生了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T20:33:16.750

1.  使用样式`margin:0 auto`使您的桌子居中。
2.  确保 table 的所有容器都是 height: 100%; 例如：
    *   [这会起作用](http://jsfiddle.net/A8yVa/1/)
    *   [这不起作用](http://jsfiddle.net/A8yVa/2/)-[这](http://jsfiddle.net/A8yVa/2/)是修复

而且您的代码有一些不便之处：

```
<tr style="height: 42px; width: 100%">
           ^^^^^^^^^^^^ this is ok
   </tr>
   <tr align="center" valign="middle">
       <td style="height: 196px;">
                  ^^^^^^^^^^^^^^ 
                 This is wrong. you should 
                 remove it to make table auto-risze. 
                 And you should use `height` only to <tr> 
```

> 它就像一个汽车。当我把它放在 html 标签之前时就发生了

`height:93%`如果您使用, 然后使用`height:42px`,`height:196px`表示行， Firefox 只会发疯。`<!DOCTYPE html>`我相信当您使用标签时，Firefox 正在使用更严格的方法来呈现 HTML+CSS

另外..不要使用`text-align`for `table`, `tr`- 因为它们不包含任何文本。仅用于`td`

# javascript - 什么可以抵消我的工作形式

> ID：12125388
> 
> 赞同：0
> 
> 时间：2012-08-25T20:28:00.643
> 
> 标签：javascript, jquery, css

我对编程还很陌生，我正在创建一个可以转换的表单，但是 border:none 并没有让我的一个表单像它应该的那样消失。我觉得代码被某些东西覆盖了。在 Jsfiddle 中它工作正常，但在我的浏览器（[http://www.entrilab.com/](http://www.entrilab.com/)）上它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T20:32:41.960

如果你从 调用 jQuery 方法`sliding_form.js`，你应该在它*之前*包含 jQuery 。另外，`sliding_form.js`实际上并没有加载。我假设它在`js`像 jQuery 这样的目录中，所以指向它的路径需要正确才能加载它......

# c++ - 隐藏/虚拟函数使用 C++

> ID：12125389
> 
> 赞同：0
> 
> 时间：2012-08-25T20:28:19.193
> 
> 标签：c++, class, function, virtual

这是一个特定的问题，我已经有一段时间找不到解决方案了。我有这个代码：

```
#include <iostream>

using namespace std;

class Mammal
{
  public:
  Mammal() {cout << "Mammal Constructor\n";}
  virtual ~Mammal() {cout << "Mammal Destructor\n";}
  virtual void Run() {cout << "Mammal Ran One Space\n";}

  protected:
  int mammalDistance;
};

class Horse : public Mammal
{
    public:
    Horse() {cout << "Horse Constructor\n";}
    ~Horse() {cout << "Horse Destructor\n";}
    void Run() {cout << "Horse Ran One Space\n";}
    void Run(int distance) {horseDistance = distance;
                            cout << "Horse Ran " << horseDistance << " Spaces\n";}

    protected:
    int horseDistance;
};

int main()
{
    Mammal *pHorse = new Horse;
    pHorse->Run(5);
    delete pHorse;
    return 0;
} 
```

现在，如果我使用 void Run(int horseDistance) 并将其向上移动到 Mammal 中，则此代码有效，但我想知道是否有办法将其保留在马中而不保持隐藏。

编辑：我的意思是，如果我采用接受输入的函数并将其向上移动到 Mammal 中，而不是像现在这样将它放在 Horse 类中，它会按预期编译和工作。是的，如果它可以在传入 horseDistance 时改变它的值，我希望它。编辑：OI 明白你的意思。我编辑了代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T20:40:28.110

```
Mammal *pHorse = new Horse;
pHorse->Run(5); 
```

不起作用，因为 Mammal 中没有带有签名的成员函数`void Run(int)`。更准确地说：`void Run(int)`Horse 类中给出的函数不是`void Run()`Mammal 中函数的覆盖，因为不同的签名。

您应该考虑添加`void Run(int)`到 Mammal 接口，如果它是更多子类将实现的函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T20:40:47.807

你有两个选择。一个是跟踪您的指针是马的事实：

```
int main()
{
    Horse *pHorse = new Horse;
    pHorse->Run(5);
    delete pHorse;
    return 0;
} 
```

另一种是在中声明一个虚函数`Mammal`：

```
virtual void Run(int mammalDistance) = 0; 
```

如果马是唯一跑特定距离的东西，我会选择选项#1，否则选择选项#2。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T20:37:46.147

现在您知道 pHorse 是一匹马，但是对于编译器来说，它是不同的。唯一的方法是使用动态转换检查 pHorse 是否为马，然后将其转换为 Horse* 并转换 Run(5) 方法。

```
Horse* pHorse2=dynamic_cast<Horse*>(pHorse);
if(pHorse2!=NULL){
   pHorse2->Run(5);
}else{
   pHorse->Run();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-25T20:52:23.543

我认为您在这里寻找多态性。您的所有派生`Mammals`都必须实现`getDistance()`，`setDistance()`并且还可以实现`getAnimal()`以提供名称。我认为在设计上仍有一些改进的空间，但你会通过这种方式掌握多态性的窍门。可能是这样的：

```
#include <iostream>

using namespace std;

class Mammal
{
public:
  Mammal() {cout << "Mammal Constructor\n";}
  virtual ~Mammal() {cout << "Mammal Destructor\n";}
  virtual void Run() {cout << getAnimal() << " Ran " << getDistance() << " Space\n";}
  virtual void Run(int p_distance)
  {setDistance(p_distance);
    cout << getAnimal() << " Ran " << getDistance() << " Spaces\n";}

protected:
  virtual void setDistance(int p_distance) {mammalDistance = p_distance;}
  virtual int getDistance() {return mammalDistance;}
  virtual string getAnimal() {return "Mammal";}
  int mammalDistance;
};

class Horse : public Mammal
{
public:
    Horse() {cout << "Horse Constructor\n";}
    ~Horse() {cout << "Horse Destructor\n";}
protected:
    int horseDistance;
    virtual string getAnimal() {return "Horse";}
};

int main()
{
    Mammal *pHorse = new Horse;
    pHorse->Run(5);
    delete pHorse;
    return 0;
} 
```

# neo4j - 在 Neo4j 中删除大量节点时出现 GC OutOfMemory 错误

> ID：12125390
> 
> 赞同：3
> 
> 时间：2012-08-25T20:28:28.417
> 
> 标签：neo4j

我有大量高度连接的节点，有时我想从数据库中删除这些节点。通过几次遍历，我最终得到了一个要删除的节点列表：

```
for (Node nodeToDelete : nodesToDelete)
{
    for (Relationship rel : nodeToDelete.getRelationships())
    {
        rel.delete();
    }

    nodeToDelete.delete();
} 
```

问题是，无论我设置多大的堆，我都会收到： **java.lang.OutOfMemoryError: GC overhead limit exceeded**

删除大量节点的最佳方法是什么？我知道我必须先删除他们的关系，然后才能真正删除它们——我单步执行代码，它似乎在删除关系时失败了。有没有比我有更好的删除节点的功能？一切都包含在一个非常重要的事务中，因为这个删除的任何部分都不允许失败——这可能是个问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T01:43:46.573

做一个批次。问题是您的删除被包装在一个可以还原的事务中，但是为了存储该还原，它存储在内存中。尝试这样做。

```
long counter = 0;
for (Node nodeToDelete : nodesToDelete)
{
    if (counter == 1000) {
        tx.success();
        tx.finish();
        tx = db.beginTransaction();
        counter = 0;
    }
    for (Relationship rel : nodeToDelete.getRelationships())
    {
        rel.delete();
    }

    nodeToDelete.delete();
    counter++;
} 
```

# objective-c - iOS：处理 didSelectViewController 时的警告

> ID：12125396
> 
> 赞同：0
> 
> 时间：2012-08-25T20:29:10.597
> 
> 标签：objective-c, ios

以下代码：

```
- (void)tabBarController:(UITabBarController *)tabBarController didSelectViewController:(UIViewController *)viewController {
    if (viewController == [tabBarController.viewControllers objectAtIndex:0]) {
        MySearchViewController *controller = viewController;
        [[controller tableView] reloadData];
    }
} 
```

产生以下警告：

```
Incompatible pointer types initializing 'MySearchViewController *__strong' with an expression of type 'UIViewController *__strong' 
```

什么是正确的方法来`viewController`转换到正确的类`MySearchViewController`来调用它的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T21:00:11.043

只需更改为：

```
- (void)tabBarController:(UITabBarController *)tabBarController didSelectViewController:(UIViewController *)viewController {
    if (viewController == [tabBarController.viewControllers objectAtIndex:0] && [viewController isKindOfClass:[MySearchViewController class]]) {
        MySearchViewController *controller = (MySearchViewController *)viewController;
        [[controller tableView] reloadData];
    }
} 
```

# ios - 在 UIViewControllers init 方法中访问 self.view 会导致崩溃

> ID：12125398
> 
> 赞同：1
> 
> 时间：2012-08-25T20:29:20.430
> 
> 标签：ios, uiviewcontroller

我有一个 UIViewController 和一个自定义的 init 方法，如下所示：

```
- (id)initWithFrame:(CGRect)frame_ customObject:(CustomObject *)object_ {
    if(UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) {
        self = [super initWithNibName:@"ArtistViewController_iPad" bundle:nil];
    } else {
        self = [super initWithNibName:@"ArtistViewController" bundle:nil];
    }

    [self.view setFrame:frame_];

    self.customObject = object_;

    return self;
} 
```

但是当 [self.view setFrame:frame_]; 被调用，它在日志中崩溃：

(null) libc++abi.dylib: 终止调用抛出异常

这就是我从另一个 UIViewController 分配 UIViewController 的方式：

```
CGRect frame = self.view.frame;

artistViewController = [[ArtistViewController alloc] initWithFrame:frame customObject:anObject]; 
```

框架存在。自我存在于 [super initWithNibName:bundle];

但 self.view 似乎不存在。nib 文件存在并且连接了它们的视图出口。

为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T20:54:52.580

您不应该从初始化程序中访问视图。有几个更合适的地方来做这项工作，这取决于你真正想要完成的事情。

阅读视图控制器生命周期以了解您可能希望将修改放在哪里。

[http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/ViewLoadingandUnloading/ViewLoadingandUnloading.html#//apple_ref/doc/uid/TP40007457-CH10-SW1](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/ViewLoadingandUnloading/ViewLoadingandUnloading.html#//apple_ref/doc/uid/TP40007457-CH10-SW1)

# python - 带有引用集的 Google App Engine 返回对象

> ID：12125400
> 
> 赞同：0
> 
> 时间：2012-08-25T20:29:30.113
> 
> 标签：python, google-app-engine, google-cloud-datastore

嗨，我有点试图将 DataStore 背后的概念理解为 No-SQL 数据库，我试图获取的是一个对象列表，该列表已被另一个“引用”。作为这个

```
class Person(db.Model):
    name = db.StringProperty(required=True)

class Contact(db.Model):
    name = db.StringProperty(required=True)
    email = db.StringProperty()
    trader = db.ReferenceProperty(Person) 
```

这很好用，当我使用 person.put() 时它们可以被保存，没有任何问题。但是，当我尝试检索它并编码为 json 时，它从不将**联系人**显示为列表，实际上它完全忽略了它。

```
 persons_query = Person.all()
    persons = persons_query.fetch(50)
    data = json.encode(persons) 
```

我希望人们有一个联系人集合，但它对如何解决这个问题没有任何想法？

为了更清楚，目前我得到了这样的东西：

```
[
 {
  name: "John Doe"
 }
] 
```

我想成为

```
[
 {
  name: "John Doe"
  contacts: [{name:"Alex", email:'alex@gmail.com'}]
 }
] 
```

**编辑**

谢谢你是对的，我需要获取联系人集合，只有一个问题是，当联系人被编码时，它递归地尝试对 Trader 对象进行编码，这是联系人等等。

所以我得到了一个明显的错误递归错误，对此的解决方案显然是在编码时从联系人中删除交易者对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T02:57:42.107

在您的班级中制作自定义 toJson 函数

```
class Person(db.Model):
    name = db.StringProperty(required=True)

    def toJson(self):
        contact = self.contact_set #this is the default collection name for your class
        d = {"name":self.name,"contact":contact}
        return json.dumps(d)

class Contact(db.Model):
    name = db.StringProperty(required=True)
    email = db.StringProperty()
    trader = db.ReferenceProperty(Person) 
```

那么你可以做ff：

```
persons_query = Person.all()
persons = persons_query.fetch(50)
data = person.toJson() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T00:28:20.617

要获取所有联系人，您需要编写一个自定义 json 编码器，该编码器获取引用属性的所有反向。

ReferenceProperties 自动获得反向查询。来自文档“collection_name 是要提供给引用模型类的属性的名称。该属性的值是引用该实体的所有实体的查询。如果未设置 collection_name，则 modelname_set（具有引用的名称使用小写字母和 _set 的模型）。”

因此，您将添加一种方法来解析反向引用集查询。

```
class Person(db.Model):
   name = db.StringProperty(required=True)
   def contacts(self):
       return self.contact_set.fetch(50)  # should be smarter than that 
```

然后在您的自定义 json 编码器中使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T20:59:56.313

如果您想查找包含某个人的所有联系人，您需要为其发出查询。

```
contacts = Contact.all().filter("trader =", person) 
```

# sql - oracle sql日期不迟于今天

> ID：12125401
> 
> 赞同：35
> 
> 时间：2012-08-25T20:29:53.920
> 
> 标签：sql, oracle, logic

我需要显示一些数据，如果它是 - 新数据 - 更新数据比方说，我将基于发布日期列和更新列中的这些数据，其中发布日期和更新日期都是时间戳？. 那么如果是新日期，如何计算日期？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-08-25T22:56:54.030

过去 24 小时：

```
Where publish_date >= sysdate -1 
```

或今天的任何时候（午夜前锋）

```
where publish_date >= trunc(sysdate) 
```

如果这是一张大表，我假设您在 publish_date 上有一个索引。如果你使用 trunc(publish_date)，它可能无法使用索引（未经测试，但运行一个解释计划以确保）。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-25T20:54:52.767

试试这个

```
Where TRUNC(sysdate) = TRUNC(publish_date) 
```

`sysdate`返回今天的日期和时间。删除`TRUNC`时间部分

# java - 悬停时激活 JMenuBar

> ID：12125402
> 
> 赞同：7
> 
> 时间：2012-08-25T20:30:01.070
> 
> 标签：java, swing, jmenubar, mouse-listeners

在第一次单击之前， JMenuBar 不会开始将[JMenuItem](http://docs.oracle.com/javase/6/docs/api/javax/swing/JMenuItem.html)显示为选中状态或显示[JMenu](http://docs.oracle.com/javase/7/docs/api/javax/swing/JMenu.html)弹出窗口。单击[JMenuBar](http://docs.oracle.com/javase/7/docs/api/javax/swing/JMenuBar.html)中的某个位置后，所有这些项目都会响应鼠标悬停。

我想绕过所需的初始点击，并在鼠标悬停时自动激活它。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-25T20:47:39.960

方法是添加一个`MouseListener`on the`JMenu`并监听 events `mouseEntered`。在事件处理程序中，您只需使用`doClick`. 例如，

```
jMenuFile.addMouseListener(new MouseListener(){
    public void mouseEntered(MouseEvent e) {
       jMenuFile.doClick();
    }
  ...
}); 
```

一旦以编程方式单击鼠标，它就会自动打开弹出菜单。要激活一个整体`JMenuBar`，您必须在每个上添加一个侦听器`JMenu`。为此，最好单独创建一个监听器对象。

我在栏上有两个菜单项，所以我做了：

```
MouseListener ml = new MouseListener(){
    public void mouseClicked(MouseEvent e) {}
    public void mousePressed(MouseEvent e) {}
    public void mouseReleased(MouseEvent e) {}
    public void mouseExited(MouseEvent e) {}
    public void mouseEntered(MouseEvent e) {
        ((JMenu)e.getSource()).doClick();
    }
  };
  jMenuFile.addMouseListener(ml);
  jMenuHelp.addMouseListener(ml); 
```

如果栏上有这么多菜单项，则可以对其进行迭代：

```
for (Component c: jMenuBar1.getComponents()) {
    if (c instanceof JMenu){
        c.addMouseListener(ml);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-02T01:18:10.403

Roman C 的初始和接受的答案不会 AUTO Close the menu with child MenuItems 作为 JMenuBar 的一部分。

运行 ((JMenu)e.getSource()).doClick(); 在 mouseEntered 上模拟单击到 JMenu 父级之一，但不能简单地添加到 mouseExited 方法，因为 MouseListener 需要附加到子 MenuItems 以及 JMenu 父级。（在对 MenuBar 的正常分配中它不会这样做 - 仅附加到父 JMenu 对象）。

此外，由于试图让 MouseExit 侦听器仅在鼠标离开整个菜单结构（即子菜单下拉菜单）时触发“关闭”方法而出现问题。

**以下是从我的实时应用程序中获取的完整工作答案：**

我解决鼠标退出菜单关闭的方法是在构造函数的顶部运行一个布尔变量“isMouseOut”来跟踪，然后以更OO友好的方式分配MouseListener来跟踪多个MouseIn-MouseOut事件当用户与菜单交互时。它调用了一个单独的 menuClear 方法，作用于布尔“isMouseOut”的状态。该类实现 MouseListener。这就是它的完成方式。

首先创建一个 ArrayList，将所有菜单项添加到该数组中。像这样：

```
 Font menuFont = new Font("Arial", Font.PLAIN, 12);
    JMenuBar menuBar = new JMenuBar();
    getContentPane().add(menuBar, BorderLayout.NORTH); 

// Array of MenuItems
    ArrayList<JMenuItem> aMenuItms = new ArrayList<JMenuItem>();
    JMenuItem mntmRefresh = new JMenuItem("Refresh");
    JMenuItem mntmNew = new JMenuItem("New");
    JMenuItem mntmNormal = new JMenuItem("Normal");
    JMenuItem mntmMax = new JMenuItem("Max");
    JMenuItem mntmStatus = new JMenuItem("Status");
    JMenuItem mntmFeedback = new JMenuItem("Send Feedback");
    JMenuItem mntmEtsyTWebsite = new JMenuItem("EtsyT website");
    JMenuItem mntmAbout = new JMenuItem("About");

    aMenuItms.add(mntmRefresh);
    aMenuItms.add(mntmNew);
    aMenuItms.add(mntmNormal);
    aMenuItms.add(mntmMax);
    aMenuItms.add(mntmStatus);
    aMenuItms.add(mntmFeedback);
    aMenuItms.add(mntmEtsyTWebsite);
    aMenuItms.add(mntmAbout); 
```

然后在此阶段迭代 arrayList，使用 for() 循环添加 MouseListener：

```
 for (Component c : aMenuItms) {
        if (c instanceof JMenuItem) {
            c.addMouseListener(ml);
        }
    } 
```

现在为 MenuBar 设置 JMenu 父级：

```
// Now set JMenu parents on MenuBar
    final JMenu mnFile = new JMenu("File");
    menuBar.add(mnFile).setFont(menuFont);
    final JMenu mnView = new JMenu("View");
    menuBar.add(mnView).setFont(menuFont);
    final JMenu mnHelp = new JMenu("Help");
    menuBar.add(mnHelp).setFont(menuFont); 
```

然后将下拉 menuItems 子项添加到 JMenu 父项：

```
// Now set menuItems as children of JMenu parents
    mnFile.add(mntmRefresh).setFont(menuFont);
    mnFile.add(mntmNew).setFont(menuFont);
    mnView.add(mntmNormal).setFont(menuFont);
    mnView.add(mntmMax).setFont(menuFont);
    mnHelp.add(mntmStatus).setFont(menuFont);
    mnHelp.add(mntmFeedback).setFont(menuFont);
    mnHelp.add(mntmEtsyTWebsite).setFont(menuFont);
    mnHelp.add(mntmAbout).setFont(menuFont); 
```

将 mouseListeners 作为单独的步骤添加到 JMenu 父级：

```
 for (Component c : menuBar.getComponents()) {
        if (c instanceof JMenu) {
            c.addMouseListener(ml);
        }
    } 
```

现在子 menuItem 元素都有自己的侦听器，这些侦听器与父 JMenu 元素和 MenuBar 本身是分开的 - 在 MouseListener() 实例化中识别对象类型很重要，这样您就可以在鼠标悬停时自动打开菜单（在这个例子是 3x JMenu 父级）但也避免了子异常错误，并允许在不尝试监视鼠标位置的情况下干净地识别菜单结构的 mouseOUT。鼠标监听器如下：

```
MouseListener ml = new MouseListener() {
        public void mouseClicked(MouseEvent e) {
        }

        public void mousePressed(MouseEvent e) {
        }

        public void mouseReleased(MouseEvent e) {
        }

        public void mouseExited(MouseEvent e) {
            isMouseOut = true;
            timerMenuClear();
        }

        public void mouseEntered(MouseEvent e) {
            isMouseOut = false;
            Object eSource = e.getSource();
            if(eSource == mnHelp || eSource == mnView || eSource == mnFile){
                ((JMenu) eSource).doClick();
            }
        }
    }; 
```

以上仅模拟鼠标单击 JMenu 'parents'（本例中为 3x），因为它们是子菜单下拉菜单的触发器。timerMenuClear() 方法调用 MenuSelectionManager 以清空在真正 mouseOUT 时处于活动状态的任何选定路径点：

```
public void timerMenuClear(){
    ActionListener task = new ActionListener() {
      public void actionPerformed(ActionEvent e) {
          if(isMouseOut == true){
              System.out.println("Timer");
          MenuSelectionManager.defaultManager().clearSelectedPath();
          }
      }
  };        
    //Delay timer half a second to ensure real mouseOUT
  Timer timer = new Timer(1000, task); 
  timer.setInitialDelay(500);        
  timer.setRepeats(false);
  timer.start();
} 
```

我花了一些时间进行测试，监控在开发过程中我可以在 JVM 中访问哪些值 - 但它确实是一种享受！即使有嵌套菜单 :) 我希望很多人发现这个完整的例子非常有用。

# php - php 多张图片上传器无法正常工作

> ID：12125408
> 
> 赞同：0
> 
> 时间：2012-08-25T20:30:38.960
> 
> 标签：php, file-upload, foreach

我正在尝试将多张照片上传到我的服务器，我让它部分工作，它会做一张照片，但它不会做每一张通过的照片。

的HTML：

```
 <form>
 <input type="file" name="uploadFile"  class="upload" multiple="true" onChange="galleryUpload(this.form,'ajax/add/gallery_photos.php'); return false;"/>
</form> 
```

PHP：

```
$photos = array();

$i = 0;
foreach($_FILES as $file) 
{

$fileArr = explode("." , $file["name"]);
$ext = strtolower($fileArr[count($fileArr)-1]);

$allowed = array("jpg", "jpeg", "png", "gif", "bmp");

if (in_array($ext, $allowed)){

$source = $file['tmp_name'][$i++];

$path = "../../photos/";
$filename = uniqid();

//Crop photo etc..

if(move_uploaded_file($_FILES['uploadFile']['tmp_name'], "$path/$filename.jpg"))
{

$photos[] = array(
'photoID' => $photoID,
'URL' => $filename
);

}

}

}

echo json_encode($photos); 
```

如您所见，我还返回上传照片的 json 数据，因此我可以使用 jQuery 管理它们（这是一种“ajax”上传表单，因此页面不会重新加载）所以我需要返回该数据。所以它需要返回数据数组。尽管只有一个文件，但一切似乎都运行良好，但即使我选择多张照片，它也只会做一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T20:57:28.897

更改您的 name 属性在 input 元素上：

```
name="uploadFile" 
```

到：

```
name="uploadFile[]" 
```

只有一个文件被插入到 $_FILES 数组中

# perl - 用于访问 IRC 服务器的简单 Perl 模块

> ID：12125409
> 
> 赞同：0
> 
> 时间：2012-08-25T20:30:40.627
> 
> 标签：perl, cpan, irc

我正在尝试编写一个非常简单的 IRC 客户端，它将主题设置在给定的频道上（它首先需要识别并获得操作）。理想情况下，我希望能够写出这样的东西：

```
$client = new IRC::Client(%config);
$client->connect();
$client->identify('password');
$client->join('#channel');
$client->op('#channel'); # gain ops
$client->set_topic('#channel', 'new topic');
$client->disconnect(); 
```

是否有支持这种有限功能的模块，具有简单的界面？metacpan 上所有与 IRC 相关的模块似乎都针对想要编写功能齐全的机器人的人——我看过[Bot::BasicBot](https://metacpan.org/module/Bot%3a%3aBasicBot)，但这似乎希望我将模块和[AnyEvent::IRC::Client](https://metacpan.org/module/AnyEvent%3a%3aIRC%3a%3aClient)子类化看起来水平很低。我不想编写事件处理代码，只是连接，发出一些命令，然后断开连接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T11:21:40.620

考虑也[`Net::Async::IRC`](http://www.metacpan.org/module/Net%3a%3aAsync%3a%3aIRC)。

# python - 在 Python 正则表达式中访问 prematch、match 和 postmatch

> ID：12125412
> 
> 赞同：0
> 
> 时间：2012-08-25T20:31:30.207
> 
> 标签：python, regex

在 Perl 中匹配正则表达式时，[会](https://perldoc.perl.org/perlreref.html#VARIABLES)[设置三个名为](https://perldoc.perl.org/perlreref.html#VARIABLES)[和的](https://perldoc.perl.org/perlreref.html#VARIABLES)[变量`$PREMATCH``$MATCH``$POSTMATCH`](https://perldoc.perl.org/perlreref.html#VARIABLES)，其中包含输入字符串匹配前的部分、匹配项本身和匹配后的部分。

如何使用 Python 正则表达式访问相同的值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T20:36:53.390

不，Python 没有明确支持 prematch 和 postmatch 值，但您*可以*使用[匹配对象](https://docs.python.org/3/library/re.html#match-objects)的属性对输入字符串进行切片；给定一个 matchobject `match`，等价物是：

*   `$PREMATCH`：`match.string[:match.start()]`
*   `$MATCH`：`match.group()`
*   `$POSTMATCH`：`match.string[match.end():]`

演示：

```
>>> import re
>>> match = re.search(r'\d+', 'Pre 1234 Post')
>>> match.string[:match.start()]
'Pre '
>>> match.group()
'1234'
>>> match.string[match.end():]
' Post' 
```

您还可以使用[`re.split()`](http://docs.python.org/library/re.html#re.split)围绕正则表达式的字符串和围绕整个表达式的组来划分：

```
>>> re.split(r'(\d+)', 'Pre 1234 Post')
['Pre ', '1234', ' Post'] 
```

如果您愿意，可以使用元组解包将其放入变量中：

```
>>> pre, match, post = re.split(r'(\d+)', 'Pre 1234 Post')
>>> pre, post
('Pre ', ' Post')
>>> match
'1234' 
```

请注意，除非您将其限制为与参数`.split()`匹配的 1 个，否则它将继续拆分：`maxsplit`

```
>>> re.split(r'(\d+)', 'One 1 Two 2 Three 3')
['One ', '1', ' Two ', '2', ' Three ', '3', '']
>>> re.split(r'(\d+)', 'One 1 Two 2 Three 3', 1)
['One ', '1', ' Two 2 Three 3'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T20:38:49.377

不，您`re`在 python 中使用该模块。然而，语法与 Perl 中的有些不同，没有 Perl 中的快捷方式。

根据您要实现的目标，您可以例如使用组。

```
>>> import re
>>> str = 'abcdefghijklmnopqrstuv'
>>> match = re.search('(.*)ij(.*)', str)
>>> match.groups()
('abcdefgh', 'klmnopqrstuv')
>>> 
```

# zurb-foundation - 在 Zurb Foundation 中重新排列列

> ID：12125415
> 
> 赞同：7
> 
> 时间：2012-08-25T20:32:14.357
> 
> 标签：zurb-foundation

我的问题是，在桌面上我喜欢先有菜单，然后是最右上角的徽标。目前，当我将模板缩小到移动版本时，徽标位于菜单下方，这并不令人满意。我想在菜单之前吃。我试过使用推/拉没有成功。

在移动视图中甚至可以在模板顶部显示徽标吗？

这是我的代码...

```
<div class="container" style="margin-top: 15px;">
        <div class="row">
            <div class="ten columns mobile-four">
                <nav>
                    <ul>
                                        <li><a href="#">link</a></li> 
                                        <li><a href="#">link</a></li>
                                        <li><a href="#">link</a></li>
                                        <li><a href="#">link</a></li>
                                        <li><a href="#">link</a></li>
                                        <li><a href="#">link</a></li>
                    </ul>
                </nav>
            </div>
                        <div class="two columns mobile-four">
                <a href="index.php"><img src="images/logo.png" alt="logo"/></a>
            </div>
                </div>
    </div> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-28T20:20:24.220

所以首先你可以取消这个`mobile-four`类，它什么都不做（除非它对你来说是自定义的）。查看文档，有一个`mobile-[one two three]`, 四个相当于将其关闭。

要解决此问题，只需应用源排序类，如下所示：

```
<div class="container" style="margin-top: 15px;">
        <div class="row">
            <div class="two columns push-ten">
                <a href="index.php">
                    <img src="images/logo.png" alt="logo" /></a>
            </div>
            <div class="ten columns pull-two">
                <nav>
                    <ul>
                        <li><a href="#">link</a></li>
                        <li><a href="#">link</a></li>
                        <li><a href="#">link</a></li>
                        <li><a href="#">link</a></li>
                        <li><a href="#">link</a></li>
                        <li><a href="#">link</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </div> 
```

推拉将正确排序菜单第一和徽标第二。推和拉在移动设备上被忽略，这意味着您的徽标将堆叠在移动设备上的菜单上方。

桌面：[菜单][徽标]

手机 [标志] [菜单]

文档： http: [//foundation.zurb.com/docs/grid.php](http://foundation.zurb.com/docs/grid.php)

# javascript - 为什么移位 0 会截断小数点？

> ID：12125421
> 
> 赞同：25
> 
> 时间：2012-08-25T20:33:02.660
> 
> 标签：javascript, numbers, operators, bitwise-operators, bit-shift

我最近发现了这段 JavaScript 代码：

```
Math.random() * 0x1000000 << 0 
```

我知道第一部分只是生成一个介于 0 和 0x1000000 之间的随机数（== 16777216）。

但第二部分似乎很奇怪。执行位移 0 有什么意义？我不认为它会做任何事情。然而，经过进一步调查，我注意到移位 0 似乎*截断了数字的小数部分*。此外，它是右移还是左移，甚至是无符号右移都无关紧要。

```
> 10.12345 << 0
10
> 10.12345 >> 0
10
> 10.12345 >>> 0
10 
```

我用 Firefox 和 Chrome 都测试过，行为是一样的。那么，这种观察的原因是什么？它只是 JavaScript 的细微差别，还是在其他语言中也存在？我以为我理解位移，但这让我很困惑。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-25T20:34:49.323

你是对的；它用于截断值。

之所以`>>`有效是因为它仅对 32 位整数进行操作，因此该值被截断。（它也常用于此类情况，而不是`Math.floor`因为按位运算符的运算符优先级较低，因此您可以避免括号混乱。）

而且由于它只对 32 位整数进行操作，因此它也相当于一个带有`0xffffffff`后舍入的掩码。所以：

```
0x110000000      // 4563402752
0x110000000 >> 0 // 268435456
0x010000000      // 268435456 
```

但这不是预期行为的一部分，因为`Math.random()`它将返回一个介于 0 和 1 之间的值。

`| 0`此外，它与更常见的 做同样的事情。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-25T21:05:26.877

`Math.random()`返回一个介于 0（包括）和 1（不包括）之间的数字。将此数字乘以整数会得到一个包含小数部分的数字。`<<`运算符是消除小数部分的快捷方式：

> 所有按位运算符的操作数都以大端顺序和二进制补码格式转换为有符号的 32 位整数。

上述语句意味着 JavaScript 引擎会将`<<`operator 的两个操作数隐式转换为 32 位整数；对于数字，它通过删除小数部分来实现（不适合 32 位整数范围的数字比小数部分更松散）。

> 它只是 JavaScript 的细微差别，还是在其他语言中也存在？

您会在松散类型的语言中注意到类似的行为。以 PHP 为例：

```
var_dump(1234.56789 << 0);
// int(1234) 
```

对于强类型语言，程序通常会拒绝编译。C# 抱怨是这样的：

```
Console.Write(1234.56789 << 0);
// error CS0019: Operator '<<' cannot be applied to operands of type 'double' and 'int' 
```

对于这些语言，您**已经**有了类型转换运算符：

```
Console.Write((int)1234.56789);
// 1234 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-25T20:37:03.530

来自按位运算符（包括移位运算符）的[Mozilla 文档](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Bitwise_Operators)

> 所有按位运算符的操作数都以大端顺序和二进制补码格式转换为有符号的 32 位整数。

所以基本上代码使用移位运算符的那个有点偶然的方面作为*它所做的唯一重要的事情，*因为它移动了 0 位。伊克。

> 它只是 JavaScript 的细微差别，还是在其他语言中也存在？

当然，我不能代表所有语言，但 Java 和 C# 都不允许`double`值作为左操作数作为移位运算符。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-25T20:42:21.190

根据 ECMAScript 语言规范：
[http ://ecma-international.org/ecma-262/5.1/#sec-11.7.1](http://ecma-international.org/ecma-262/5.1/#sec-11.7.1)

> 产生式 ShiftExpression : ShiftExpression >> AdditiveExpression 的评估如下：
> 
> 1.  令 lref 为评估 ShiftExpression 的结果。
> 2.  令 lval 为 GetValue(lref)。
> 3.  令 rref 为 AdditiveExpression 求值的结果。
> 4.  设 rval 为 GetValue(rref)。
> 5.  令 lnum 为 ToInt32(lval)。
> 6.  设 rnum 为 ToUint32(rval)。
> 7.  令 shiftCount 为屏蔽掉除 rnum 的最低有效 5 位以外的所有结果，即计算 rnum & 0x1F。
> 8.  返回执行 lnum 符号扩展右移 shiftCount 位的结果。传播最高有效位。结果是一个有符号的 32 位整数。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-08-25T20:43:41.533

您观察到的行为在[ECMA-262 标准中定义](http://www.ecma-international.org/publications/standards/Ecma-262.htm)

`<<`这是左移运算符规范的摘录：

> 产生式 ShiftExpression : ShiftExpression << AdditiveExpression 的评估如下：
> 
> 1.  令 lref 为评估 ShiftExpression 的结果。
> 2.  令 lval 为 GetValue(lref)。
> 3.  令 rref 为 AdditiveExpression 求值的结果。
> 4.  设 rval 为 GetValue(rref)。
> 5.  令 lnum 为 ToInt32(lval)。
> 6.  设 rnum 为 ToUint32(rval)。
> 7.  令 shiftCount 为屏蔽掉除 rnum 的最低有效 5 位以外的所有结果，即计算 rnum & 0x1F。
> 8.  通过 shiftCount 位返回 lnum 左移的结果。结果是一个有符号的 32 位整数。

如您所见，两个操作数都转换为 32 位整数。因此小数部分消失了。

这同样适用于其他位移运算符。您可以在我链接到的文档的第**11.7 节按位移位运算**符中找到它们各自的描述。

在这种情况下，执行移位的唯一效果是类型转换。`Math.random()`返回一个浮点值。

# java - 基于变量值选择的方法

> ID：12125422
> 
> 赞同：0
> 
> 时间：2012-08-25T20:33:08.043
> 
> 标签：java, user-interface, javafx-2

我正在编写用户的 GUI，我想创建一个方法，该方法将创建具有先前定义的名称和操作的各种数量的按钮。但我不知道如何编写基于变量值的方法选择。谷歌没有提供任何有用的信息。任何人都可以帮助解决这个问题，或者这是不可能的？

这是一些代码示例：

```
 String[] actions={"testAction1","testAction2","testAction3"};
    defaultDialogWindow(actions,"test1", "test2", "test3");

    void defaultDialogWindow(String[] actions, String... bNames){
          double layoutX = 25;
          double spacing = 15;
          final Stage dialogStage = new Stage();
          dialogStage.initOwner(stage);
          dialogStage.initModality(Modality.WINDOW_MODAL);   
          dialogStage.setFullScreen(false);
          dialogStage.setResizable(false);
          dialogStage.setHeight(100);
          dialogStage.setWidth(bNames.length*100+(bNames.length-1)*spacing+2*layoutX+5);
          dialogStage.setScene(new Scene(buttonBuilder(actions,spacing,layoutX,bNames)));
          dialogStage.show();  
    }

    HBox buttonBuilder(String[] actions, double spacing,double layoutX,String... bNames){
          HBox lBar = new HBox(10);
          final ReadOnlyDoubleProperty menuWidthProperty = lBar.widthProperty();
          lBar.setAlignment(Pos.CENTER_LEFT);
          lBar.setLayoutX(layoutX);
          lBar.setSpacing(spacing);
          for(String text : bNames){
              Button newButton = new Button();
              newButton.setText(text);
              newButton.setFont(Font.font("Times New Roman", 22));
              newButton.prefWidthProperty().set(100);
              newButton.prefHeightProperty().set(50);
              newButton.setOnAction(new EventHandler<ActionEvent>() {
                  @Override
                  public void handle(ActionEvent paramT) {

                      **HERE MUST BE ACTION CALL BASED ON bNames VALUE**

                      System.out.println("button pressed");
                  }
              });
              lBar.getChildren().add(newButton);
          }
          System.out.println(lBar.prefWidth(-1));
          return lBar;
      }

      void testAction1(){
          System.out.println("this is test action one");
      }

      void testAction2(){
          System.out.println("this is test action two");
      }

      void testAction3(){
          System.out.println("this is test action three");
      }**strong text** 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T21:02:19.870

使用哈希映射：

```
Map<String, Runnable> actions2methods = new HashMap<>;
actions2methods.put("Action1", new Runnable { public void run() { testAction1(); })); 
```

如果您的操作`Runnable`从一开始就不是方法，您甚至可以使这更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T20:39:27.910

您可以使用 的`actionCommand`属性`ActionEvent`来传达已采取的操作。这默认为按钮的标签，但也可以使用设置（不影响标签）`Button.setActionCommand()`。

```
 newButton.setOnAction(new EventHandler<ActionEvent>() {
     @Override
     public void handle(ActionEvent paramT) {
         String actionCmd = paramT.getActionCommand();
         if (actionCmd.equals("A")) {
             doA();
         } else if (actionCmd.equals("B")) {
             doB();
         }
         System.out.println("button pressed");
     }
 }); 
```

[http://docs.oracle.com/javase/6/docs/api/java/awt/Button.html#setActionCommand%28java.lang.String%29](http://docs.oracle.com/javase/6/docs/api/java/awt/Button.html#setActionCommand%28java.lang.String%29)

[http://docs.oracle.com/javase/6/docs/api/java/awt/event/ActionEvent.html](http://docs.oracle.com/javase/6/docs/api/java/awt/event/ActionEvent.html)

# c++ - 迭代器不是对象吗？

> ID：12125427
> 
> 赞同：0
> 
> 时间：2012-08-25T20:33:50.030
> 
> 标签：c++, list, for-loop, iterator

这是我的代码：

```
for (list<moveStringTree>::iterator tempIterator=moveList.begin();tempIterator!=moveList.end(); ++tempIterator)
{
    moveStringTree *move = tempIterator;
} 
```

但它给了我一个错误。如果有铸道，我不喜欢。这太耗时了。无论如何，我想抛出一个列表并对其中的每个对象做一些事情。我能做些什么？foreach 无济于事。因为只有它会给出一个副本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T20:39:33.623

> 迭代器不是对象吗？

这是。C++ 中的对象等价于保存一个值的内存位置——不多也不少。但是，我不明白这与问题的其余部分有何关系。

> 但它给了我一个错误。如果有铸道，我不喜欢。这太耗时了。

我不知道这是什么意思。但以防万一你的意思是复制：不，它可能不会太耗时。但如果是的话——别担心；使用参考。

```
moveStringTree& move = *tempIterator; 
```

> foreach 无济于事。因为只有它会给出一个副本。

废话。foreach 的作用与手动迭代相同。因此，您也可以将其与副本一起使用：

```
for (auto& o : moveList) {
    // Do something.
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T20:36:01.280

您可以像使用指针*一样*使用迭代器，但实际上它不是一个。但是，您可以通过一种舞蹈来从中获取指针：

```
moveStringTree *move = &*tempIterator; 
```

`*`解析为对迭代器引用的元素的引用，并返回`&`该元素的地址。最终结果是一个指针。

当然，你可能不应该那样做。这：

```
tempIterator->doSomething(); 
```

工作得很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-25T20:36:54.090

尝试：

```
moveStringTree *move = & (*tempIterator) ; 
```

（括号不是绝对必要的）

迭代器本身并不是指向对象的指针，而是重载 * 以返回对它所引用的对象的引用；从中你可以使用普通的 & 得到一个指针。

请注意，通常您不需要这样做，因为迭代器也重载了 -> 运算符，因此您可以使用通常的 -> 语法访问对象的成员。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-25T20:36:16.433

事实上，您可以从中获得参考`std::for_each`。`moveStringTree* move = &*tempIterator;`会是正确的。但是，更直接地，您可以简单地使用`tempIterator`它，就好像它*已经*是指向相关对象的指针。

```
for(auto it=moveList.begin();it!=moveList.end(); ++it) {
    it->f(); // well formed if moveStringTree::f()
} 
```

# android - 如何回收位图？- 位图大小超出 VM 预算

> ID：12125428
> 
> 赞同：2
> 
> 时间：2012-08-25T20:33:51.740
> 
> 标签：android

我有这个功能，可以从 SD 加载一个大位图并旋转它。

然而，在第二次或第三次旋转后，我得到一个**位图大小超出 VM 预算**错误。

任何想法为什么？我确实回收旧位图，不是吗？

```
public void next(String s, int d)
{

if ( mBitmap!=null ) { mBitmap.recycle(); }

deg = deg + d;
mBitmap = BitmapFactory.decodeFile(s);

Matrix matrix = new Matrix();
matrix.postRotate(deg);
mBitmap = Bitmap.createBitmap(mBitmap, 0, 0, mBitmap.getWidth() , mBitmap.getHeight(), matrix, true); 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T20:56:25.970

当您不正确使用位图时，内存不足错误并不少见。

> 位图占用大量内存，尤其是对于照片等丰富的图像。例如，Galaxy Nexus 上的相机可拍摄高达 2592x1936 像素（5 兆像素）的照片。如果使用的位图配置是 ARGB_8888（Android 2.3 以后的默认配置），则将此图像加载到内存中大约需要 19MB 内存（2592*1936*4 字节），立即耗尽某些设备上的每个应用程序的限制。

[关于如何有效使用位图](http://developer.android.com/training/displaying-bitmaps/index.html)有一个很棒的 android 指南 。

按照指南，您应该能够在不损失任何可见质量的情况下显着减少内存消耗，避免不必要的崩溃。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T20:42:20.597

代码看起来不错。

但是，此异常还取决于位图的大小（分辨率和位图格式）以及其他消耗内存的对象。

# git - 如何更新父存储库的历史记录以反映使用“git branch-filter”对子模块历史记录所做的更改？

> ID：12125429
> 
> 赞同：0
> 
> 时间：2012-08-25T20:34:18.667
> 
> 标签：git

我有两个 Git 存储库，我将它们称为**A**和**B**。Repo **B**恰好是 Repo **A**的子模块。

Repo **B**充满了我想从历史中删除的二进制文件。**我可以轻松地运行一个分支过滤器命令来从 repo B**的历史记录中删除这些文件。那不是我的问题。

我的问题是，在 repo **B上运行 branch-filter 后，repo** **A**中的数千个提交现在将指向 repo **B**中的（现在无效）提交。

所以我的问题是：如何修改 repo A 的历史记录，以便 repo **A****的**每次提交都指向 repo B 的正确**提交**？

 **谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T20:42:58.633

我不是 git 专家。

在我看来，由于您更改了历史记录，因此您需要删除子模块然后重新添加它。

### 删除 .gitmodules 文件中的条目：

> ```
> [submodule "B"]
> path = B
> url = git@server:B 
> ```

### 在 .git/config 文件中删除子模块的条目

> ```
> [submodule "b"]
> url = git@server:B 
> ```

### 删除为子模块创建的路径

> git rm --cached B

现在重新添加子模块。

如果它的起源在没有重新克隆的情况下重写了历史，我不确定你如何修复另一个回购中的历史。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T08:38:45.100

过滤子模块存储库时，您需要记住每个提交 ID 是如何变化的（在地图中）。然后您还需要过滤父存储库，并且对于子模块的每次更改，而不是使用旧的提交 ID，从映射中获取等效的新 ID 并使用它。我不确定如何在实践中做到这一切，因为我从来没有做过，但这里有一些想法：

[手册页](http://www.kernel.org/pub/software/scm/git/docs/git-filter-branch.html#_filters)说有一个`map`可用的函数可以打印哪个新 ID 对应于旧 ID，因此您可以使用该函数来创建永久映射文件。

要更正子模块 ID，您必须使用`--index-filter`一个相当复杂`git ls-files -s`的脚本，该脚本使用 ，转换此阶段信息以引用新提交 ID 的脚本（我`sed`在遇到类似任务时使用），并将`git update-index --index-info`新阶段信息用于重写提交。**

# magento - Magento：config.xml 文件中的“之前”选项有什么作用？

> ID：12125433
> 
> 赞同：1
> 
> 时间：2012-08-25T20:35:03.447
> 
> 标签：magento

我添加了管理控制器。此代码工作正常：

```
 <admin>
        <routers>
            <adminhtml>
                <args>
                    <modules>
                        <mycompany_mymodule>Mycompany_Mymodule_Adminhtml</mycompany_mymodule >
                    </modules>
                </args>
            </adminhtml>
        </routers>
    </admin> 
```

如果我将 before="Mage_Adminhtml" 添加到 mycompany_mymodule：

```
<mycompany_mymodule before="Mage_Adminhtml">Mycompany_Mymodule_Adminhtml</mycompany_mymodule > 
```

然后它不起作用 - 出现 404 错误。

**1\. 这个选项有什么作用？**

我还浏览了 Alans 的 Storm 文章：[http](http://alanstorm.com/magento_admin_controllers) ://alanstorm.com/magento_admin_controllers 有示例：

```
<config>
    <!-- ... -->
    <admin>
        <routers>
            <the_name_of_this_element_is_not_important_it_should_be_unique>
                <use>admin</use>
                <args>
                    <module>Alanstormdotcom_Adminhelloworld</module>
                    <frontName>adminhelloworld</frontName>
                </args>
            </the_name_of_this_element_is_not_important_it_should_be_unique>
        </routers>
    </admin>
    <!-- ... -->        
</config> 
```

**2\. 这些定义有什么区别？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T01:56:42.387

它解决了：

我找到了定义方法的`Mage_Core_Controller_Varien_Router_Standard`类`collectRoutes()`。它解析“after”和“before”参数以对模块进行排序。

此方法调用自`Mage_Core_Controller_Varien_Router_Admin`（从`init`方法 in开始`Mage_Core_Controller_Varien_Front`）。

因此，在我查看了`Mage_Core_Controller_Varien_Router_Standard`.

调试后`Mage_Core_Controller_Varien_Router_Standard`我明白了我的错。

1.  我使用索引控制器而不是`MyModuleContoller`.

2.  Alan Storm 定义了**不在****管理**模块下的控制器（即 adminhtml）。当我使用第一个配置时 - 它工作得很好，因为我在*adminhtml*部分下定义了新模块。在 Alan 的配置中，我无法将我的模块添加到 adminhtml。我可以覆盖它，但它不正确，因为 adminhtml 下的其他模块将被删除。

这是以下菜单的正确代码`adminhtml`：

```
 <admin>
        <routers>
            <adminhtml>
                <args>
                    <modules>
                        <mycompany_mymodule after="Mage_Adminhtml">Mycompany_Mymodule_Adminhtml</mycompany_mymodule >
                    </modules>
                </args>
            </adminhtml>
        </routers>
    </admin> 
```

Incho 也在[此处](http://inchoo.net/ecommerce/magento/custom-router-in-magento/)描述了此配置。

# .net - 如何在 .net 中为多个一对零或一对关系创建类

> ID：12125436
> 
> 赞同：0
> 
> 时间：2012-08-25T20:35:30.563
> 
> 标签：.net, oop

我是 .net 和 OOP 的新手，我一直难以弄清楚我应该如何为我正在构建的房地产网站创建类。

在我的数据库中，我有一个包含各种字段的“House”表。

有时，房子可能有花园、车库、游泳池等，所以我有单独的表来存储每个表的数据，所有这些都连接到“房子”表的唯一标识符。

在我的代码中，我创建了一个“House”类，但是如何为其他表定义类？

我显然可以有一个“花园”类，它将继承“房子”类，但是，根据访问者的选择，我有时可能需要显示（例如）房子、花园和车库的数据，我可以'不知道这种方法是如何工作的。我可以只定义一个大类来定义房子、花园、车库等，并在不需要的时候留下很多空值，但我很确定这不是正确的方法！

我整天都在为此苦苦挣扎，所以非常感谢任何信息！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T20:39:12.363

房屋类可能具有一系列特征。

您基本上可以创建一个名为“Feature”的抽象基类或一个名为“IFeature”的接口，并将其继承/实现到旨在成为特性的类（即`Garden`）。

然后您需要做的就是在`House`名为“Features”的类中创建一个集合。
这是 C# 中的示例接口：

```
interface IFeature
{
    // Properties or methods you want all the features to have.

    decimal Price { get; }
} 
```

您的要素类需要实现`IFeature`接口。

```
class Garden : IFeature
{
    // This property is needed to implement IFeature interface.
    public decimal Price { get; private set; }

    public Garden(decimal price) { Price = price; }
} 
```

要实现`IFeature`，一个类必须有一个`decimal`名为“Price”的属性，并带有一个 get 访问器，如`Garden`上面的`Pool`类和下面的类：

```
class Pool : IFeature
{
    public decimal Price { get; private set; }
    public float Depth { get; private set; }

    public Pool(decimal price, float depth) { Price = price; Depth = depth; }
} 
```

`House`类应该有一个集合 of`IFeature`而不是`Pool`or `Garden`：

```
class House
{
    public List<IFeature> Features { get; private set; }

    public House()
    {
        Features = new List<IFeature>();
    }
} 
```

然后，您可以像这样为房屋添加功能：

```
House h = new House();

h.Features.Add(new Garden(6248.12m));
h.Features.Add(new Pool(4830.24m, 10.4f)); 
```

使用 LINQ，您可以，

```
// Check whether the house has a garden:
h.Features.Any(f => f is Garden);

// Get the total cost of features.
h.Features.Sum(f => f.Price);

// Get the pools that are deeper than 5 feet.
h.Features.OfType<Pool>().Where(p => p.Depth > 5f);

// etc. 
```

[有关接口的更多信息](http://msdn.microsoft.com/en-us/library/ms173156.aspx "接口（C# 编程指南）|  MSDN")。
[有关 LINQ 的更多信息](http://msdn.microsoft.com/en-us/library/bb397926 "LINQ（语言集成查询）|  MSDN")。

# microsoft-metro - Metro 应用程序集启动对象 - 页面

> ID：12125442
> 
> 赞同：1
> 
> 时间：2012-08-25T20:36:32.297
> 
> 标签：microsoft-metro

我将如何设置不同的启动页面？当前页面\表单是 GroupedItemsPage 我想将其更改为 testpage 吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T21:30:07.893

您可以通过编辑项目根目录中的包清单来更改应用程序的默认起始页。

1.  展开项目的节点
2.  双击`package.appxmanifest`
3.  选择起始页选项，并将其指向所需的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T06:17:35.197

在 XAML-C# 中，package.appxmanifest 上没有“起始页”选项。所以上面的答案是行不通的。

在 App.xaml.cs 中，添加以下内容：

```
protected override async void OnLaunched(LaunchActivatedEventArgs args)
{
    ...
    rootFrame.Navigate(typeof(YourCustomStartupPage), "AllGroups");
} 
```

# mpi - MPI_Recv 没有收到整个消息

> ID：12125447
> 
> 赞同：0
> 
> 时间：2012-08-25T20:36:54.460
> 
> 标签：mpi, distributed-computing

在 MPI_Recv 之后，仅填充数组的第一个索引，其余元素保持为“0”。当我在发送之前打印数组时，元素非零。但是收到后，除了第一个，其他的都是零。

我检查了数组的大小和数据类型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-07T22:41:28.747

检查 MPI_Recv 中的 'count' 参数是否正确指示正在发送和接收的数组的总元素。当我准确地指定数组中的元素数量时，我遇到了同样的问题。这是语法： int MPI_Recv(void *buf, int count, MPI_Datatype datatype, int source, int tag, MPI_Comm comm, MPI_Status *status)

# wcf - 删除 net.tcp 中的 .svc 扩展名

> ID：12125455
> 
> 赞同：1
> 
> 时间：2012-08-25T20:37:17.867
> 
> 标签：wcf, iis, wcf-binding, was, svc

我正在尝试在 WAS 和 IIS 中为 http 和 net.tcp 托管我的 WCF 4 Web 服务。是否可以删除 net.tcp 绑定的 .svc 扩展名？

如果我执行以下操作，我会收到错误

> 在 net.tcp://myserver.com/service/TestService 上没有可以接受消息的端点监听。这通常是由不正确的地址或 SOAP 操作引起的。有关更多详细信息，请参阅 InnerException（如果存在）。

```
 <system.serviceModel>
      <serviceHostingEnvironment multipleSiteBindingsEnabled="true">
          <serviceActivations>
              <add relativeAddress="TestService.svc" service="Web.TestService"/>
          </serviceActivations>   
      </serviceHostingEnvironment>     

      <services>
          <service name="Web.TestService" behaviorConfiguration="WebService">
              <host>
                  <baseAddresses>
                      <add baseAddress="http://myserver.com/service/" />

                  </baseAddresses>

              </host>
              <endpoint address=""  contract="Web.ITestService" binding="basicHttpBinding"></endpoint>
              <endpoint address="net.tcp://myserver.com:808/service/TestService" contract="Web.ITestService" binding="netTcpBinding"></endpoint>
              <endpoint address="net.tcp://myserver.com:808/service/TestService/mex"  binding="mexTcpBinding" bindingConfiguration="" contract="IMetadataExchange"></endpoint>
          </service>
      </services>
    <behaviors>
      <serviceBehaviors>
        <behavior name="WebService">                       
          <serviceMetadata httpGetEnabled="true"/>            
          <serviceDebug includeExceptionDetailInFaults="false"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>   
  </system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T20:39:17.287

Nazaf 这些行会导致错误，因为您的地址不正确，您有两个协议。

```
baseAddress="http://myserver.com/service/"
+
<endpoint address="net.tcp://myserver.com:808/service/TestService" contract="Web.ITestService" binding="netTcpBinding"></endpoint> 
```

您的地址中有两个协议，删除基本地址并设置不同的值

您可以阅读这篇关于解决它非常有趣的文章：http: [//msdn.microsoft.com/en-us/magazine/cc163412.aspx](http://msdn.microsoft.com/en-us/magazine/cc163412.aspx)

# ruby-on-rails - 如何从 Ruby on Rails 中的显示页面和索引页面访问方法

> ID：12125461
> 
> 赞同：0
> 
> 时间：2012-08-25T20:38:04.210
> 
> 标签：ruby-on-rails, ruby, methods

在我的模型中，我有一个返回变量的方法。

```
def do_something(param1, param2)
  #code
  return variable
end 
```

我成功地从显示页面中呈现的部分调用此方法。像这样：

```
<%= @user.do_something(param1, param2) %> 
```

我想从我的索引页面中呈现的部分调用相同的方法。但我遇到了错误。**编辑：**类错误的未定义方法。

我可以将所有方法代码复制并粘贴到一个重复的方法中，例如：

```
def self.do_something(param1, param2)
  #code
  return variable
end 
```

并像这样从索引页面部分调用它......

```
<%= User.do_something(param1, param2) %> 
```

...但这不是 DRY，我知道那里可能有更合适的解决方案。我仍在学习 Rails 力学，所以我感谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T21:03:16.937

至少您可以使用委托：

```
class User < ActiveRecord::Base
  def do_something param1, param2
    self.class.do_something param1, param2
  end

  def self.do_something param1, param2
    ...
    return variable
  end
end 
```

# android - 使用 canvas.scale 翻转 Android 画布

> ID：12125470
> 
> 赞同：2
> 
> 时间：2012-08-25T20:39:15.893
> 
> 标签：android, canvas, surfaceview, touch-event

我有一个小问题。:) 在我的新动态壁纸中，我正在水平翻转画布：

```
c.scale(-1f, 1f, screenWidth* 0.5f, screenHeight* 0.5f);
drawFlipped();
c.scale(-1f, 1f, screenWidth* 0.5f, screenHeight* 0.5f); 
```

这一切都很好，但我也碰巧有一个 ontouch 事件，用户可以单击定义为 Rect 的不同移动对象。

但是当在翻转的画布上绘制矩形时，x,y 坐标不正确。它仍然在镜子中，我明白这一点，因为我在绘制精灵后将画布翻转回来。

我的问题是：如何从屏幕右侧计算触摸事件？我试过： Screenwidth - object.x - object.width 但它没有多大帮助:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T11:45:07.543

这对我有用：

```
int screenWidth = getScreenWidth();
Rect newCoordinates = new Rect(object.getRect()); //copies old coordinates
newCoordinates.right = screenWidth - object.getRect().left; //switch right and left since the Rect is being mirrored
newCoordinates.left = screenWidth - object.getRect().right;
object.setRect(newCoordinates); 
```

# java - Java的Vector如何添加原始数组？

> ID：12125480
> 
> 赞同：1
> 
> 时间：2012-08-25T20:40:01.200
> 
> 标签：java, arrays, vector

我使用的是 Java 1.3，这意味着它没有原语的自动装箱。这意味着以下代码：

```
Vector v = new Vector();
byte b = (byte) 4;

v.addElement(b); 
```

不编译，编译器错误：

```
The method addElement(Object) in the type Vector is not applicable for the arguments (byte) 
```

所有原语都必须被包装，如下所示：

```
v.addElement(new Byte(b)); 
```

话虽如此，我注意到这段代码编译并运行得很好：

```
Vector v = new Vector();
byte[] b = new byte[]{1, 2};

v.addElement(b); 
```

这怎么可能？我的 java 版本甚至没有集合，而且[这个文档](http://docs.oracle.com/javase/1.3/docs/api/java/util/Vector.html)说该方法没有重载，它只需要对象。

是不是所有数组，甚至是基元数组，实际上都扩展了 Object？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-25T20:42:09.340

正如您所猜到的，所有数组，即使是仅包含基元的数组，都是`Object`s。它们是引用类型，它简化了 Java，使每个引用类型都成为`Object`.

从某种意义上说，无论数组包含什么类型，它们的行为都是相同的。“原始”是类型的属性，而不是容器的属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T20:42:33.407

所有数组，包括原始类型数组，是`Objects`：

```
int intArray[] = new int[5];

if (intArray instanceof Object)
    System.out.println("array is Object");
else System.out.println("array not Object"); 
```

输出：

```
array is Object 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-25T20:43:27.650

是的。 `Array`s 是`Object`s。

来自Java 语言规范的[§4.3.1](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.3.1)：

> 对象是类实例或数组。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-25T20:42:28.733

> 是不是所有数组，甚至是基元数组，实际上都扩展了 Object

是的。

# php - PHP电子邮件不会发送变量

> ID：12125487
> 
> 赞同：0
> 
> 时间：2012-08-25T20:41:12.473
> 
> 标签：php, html, email

基本上下面的代码是一个查询表单，当网站用户填写时，它会将电子邮件发送到我的电子邮件地址。但是有些东西不起作用...

这是php：

```
<?php
$field_name = $_POST['efName'];
$field_email = $_POST['efEmail'];
$field_phone = $_POST['efPhone'];
$field_date = $_POST['efTravelDate'];
$field_duration = $_POST['efLengthOfStay'];
$field_otherInfo = $_POST['efOtherInfo'];

$mail_to = 'James_Burnside94@hotmail.com';
$subject = 'Enquiry Applicant-'.$field_name;

$body_message = 'From: '.$field_name."\n";
$body_message .= 'E-mail: '.$field_email."\n";
$body_message .= 'Phone: '.$field_phone."\n";
$body_message .= 'Date: '.$field_date."\n";
$body_message .= 'Duration: '.$field_duration."\n";
$body_message .= 'otherInfo: '.$field_otherInfo."\n";

$headers = 'From: '.$field_email."\r\n";
$headers .= 'Reply-To: '.$field_email."\r\n";

$mail_status = mail($mail_to, $subject, $body_message, $headers);

if ($mail_status) { ?>
    <script language="javascript" type="text/javascript">
        alert('Enquiry Sent.');
        window.location = 'index.html';
    </script>
<?php
}
else { ?>
    <script language="javascript" type="text/javascript">
        alert('Enquiry form failed to send. \n Please try again, or send an email             to enquiry@cannes-rental-apartment.com');
        window.location = 'index.html';
    </script>
<?php
}
?> 
```

这是 HTML 正文：

```
<body>

<fieldset style="display:block; width:500px;">
    <form action="enquiry.php" method="post">
    <table> 
                <tr> <td> <span class="enquiryFormHeader"> Enquiry Form     </span> <p>         </p></td> </tr>
            <tr> <td> Name: </td> <td> <input type="text" name="efName"     id="efName"> </td> </tr>
            <tr> <td> Email: </td> <td> <input type="text" name="efEmail"     id="efEmail"> </td> </tr>
            <tr> <td> Phone or Moblie: </td> <td> <input type="text"     name="efPhone" id="efPhone"> </td> </tr>
            <tr> <td> Intended travel date: </td> <td> <input type="text"     name="efTravelDate" id="efTravelDate"> </td> </tr>
            <tr> <td> Intended length of stay: </td> <td> <input type="text"     name="efLengthOfStay" id="efLengthOfStay"> </td> </tr>
            <tr> <td valign="top"> Any other information:  </td> <td> <textarea     name="efOtherInfo" id="efOtherInfo"> </textarea> <p> </p> </td> </tr>
            <tr> <td><input type="submit" value="Send Form"     class="submitButton"> </td> </tr>
    </table>

    </form>
    </fieldset>

</body> 
```

如果我这样做 $mail_status = mail($mail_to, 'subject', 'body_message', 'headers');

它完美地发送了一封基本的电子邮件。

在所有情况下都会出现查询已发送警报。

有谁知道为什么它不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T23:30:20.507

运行 a`var_dump(get_defined_vars());`并确保它们已设置。还要检查PHP 或 Apache 用户`/var/mail/user`在哪里`user`，并查看更多操作系统级别引发的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T21:09:25.957

1-确切地说，你得到了什么？是空邮件还是根本没有邮件？

2-尝试调试你的 $_POST，就像 user1593858 说的那样。在 php 开始标记之后添加以下内容：

```
echo "<pre>";
print_r($_POST);
echo "</pre>"; 
```

看看你的字段是否正确。

3-你说如果你这样做：

```
$mail_status = mail($mail_to, 'subject', 'body_message', 'headers'); 
```

有用; 尝试用 'subject'`$subject`或 'body_message' 代替，`$body_message`直到你找出问题所在。

# python - 如何将密码传递给 Pyramid 和 Cornice？

> ID：12125489
> 
> 赞同：1
> 
> 时间：2012-08-25T20:41:24.967
> 
> 标签：python, pyramid, cornice

我有一个这样的网址：

```
http://site/account/login/ 
```

我想通过命令行来做到这一点，没有形式。

```
import requests
requests.get(url, auth=('username-goes-here', 'password-goes-here')) 
```

但是如何使用 Cornice 在 Pyrmaid 中设计视图功能？

```
@user.get()
def login(request): 
```

我根本没有看到`auth`元组出现`requests.GET`。我需要能够得到这些参数...

任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T07:23:39.270

您可以使用 HTTP 标头传递身份验证令牌。见[http://cornice.readthedocs.org/en/latest/tutorial.html](http://cornice.readthedocs.org/en/latest/tutorial.html)

# c++ - 通过visual studio 2010项目模板设置cocos2d-x应用

> ID：12125490
> 
> 赞同：4
> 
> 时间：2012-08-25T20:41:41.130
> 
> 标签：c++, visual-studio-2010, windows-7, cocos2d-x

我正在尝试使用 Cocos2D-x 在 Windows 7 上设置应用程序。

我跟着这个[教程](http://www.cocos2d-x.org/projects/cocos2d-x/wiki/Cocos2d-x_Application_Wizard_for_Visual_Studio_User_Guide)。

我做了以下事情：

1.  构建运行 Build-win32.bat 脚本的库。作品。
2.  安装VS2010项目模板。作品。
3.  成功运行所有测试程序。
4.  通过安装好的模板新建cocos2D-x项目。作品

当我编译 Hello World 应用程序时，出现以下错误：

```
error C1083: impossible to open inclusion file 'CCstdC.h' No such file or directory
error C1083: impossible to open inclusion file 'cocos2d.h' No such file or directory 
```

这是错误的包含路径。

我可以通过手动修改包含路径来修复它，但由于我通过模板创建项目，我想解决这个问题，可能不必为我将创建的每个新项目手动修改路径。

有没有人遇到过同样的问题？你知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T02:54:04.947

好吧，我像这样设置 cocos2dx 项目：

1.  在 VS 中创建一个空的 win32 应用程序
2.  打开包含您的 .sln 文件的文件夹（您的解决方案文件夹）
3.  用7z什么的打开cocos2dx包（即cocos2d-1.0.1-x-0.12.0.zip）
4.  将 cocos2dx 和可选的 CocosDenshion、Box2D 等拖到您的解决方案文件夹中
5.  将 cocos2dx 项目 (cocos2dx\proj.win32\cocos2d-win32.vcxproj) 添加到您的解决方案中
6.  转到项目的属性，选择 C/C++->General，将以下条目添加到 Additional Include Directories 选项：

    **..\cocos2dx; ..\cocos2dx\包括；..\cocos2dx\平台；..\cocos2dx\平台\win32; ..\cocos2dx\platform\third_party\win32\OGLES**

和**..\CocosDenshion\include**如果您使用的是 SimpleAudioEngine

1.  在 Linker->Input->Additional Dependencies 选项中，添加 libcocos2d.lib，如果使用音频引擎，则添加 libCocosDenshion.lib；在 Linker->General->Additional Library Directories 选项中，添加 $(OutDir)

2.  转到 Configuration Properties->General->Output Directory 选项，将其设置为 $(SolutionDir)\build\

3.  打开 cocos2d 库的项目属性，转到配置属性->常规->输出目录，将其设置为 $(SolutionDir)\build\，对您包含的其余库也执行此操作。

一切就绪，您可以出发了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T02:24:51.127

不幸的是，该模板不是那么有用。我相信在 cocos2d-x（教程所基于的那个）的先前版本中，路径是绝对的，并且直接引用了`cocos2dx`,`cocosdenshion`项目。

现在，由于它们是相对的 ( `..\..\cocos2dx`)，并且在创建项目时不会将它们复制到解决方案目录，因此它不起作用。

您显然可以修复路径（如您所建议的），但我的建议是：复制 HelloWorld 项目并将其用作模板。解决方案结构比模板中的结构要好得多，因为它已经为 iOS、win32 和 Android 做好了准备。相信我，没有比这更容易的了。

现在，问题来了：如果您将 HelloWorld 项目复制到同级文件夹中，那么您就完成了，因为所有引用都已设置好。如果你想复制到其他地方，你还必须复制`cocos2dx`，`cocosdenshion`留下目标结构，如：

```
target_path\cocos2dx
target_path\cocosdenshion
target_path\Copy_of_Hello_World 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T16:39:01.200

我解决了打开 cocos2dx 库解决方案并通过 VS 模板向导添加一个新项目。

# jquery-mobile - jquery.mobile：如何向用户询问日期范围？

> ID：12125494
> 
> 赞同：1
> 
> 时间：2012-08-25T20:42:09.007
> 
> 标签：jquery-mobile, daterangepicker

我需要让我的 jquery 移动网站的用户选择一个日期范围。我找不到任何合适的 jquery-mobile 插件。我寻找了很多用于日期时间选择的插件（对我来说最有希望的是“jQM-DateBox”），但似乎没有人允许日期范围。有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T21:12:25.217

据我所知，到目前为止还没有任何插件可以提供日期范围。

jQM 可用的日期插件是

1.  jQM-[日期框](http://dev.jtsage.com/jQM-DateBox/)
2.  移动[卷轴](http://mobiscroll.com/)

在我看来，最常见的方法是使用两个日期框，一个用于开始日期，一个用于结束日期。最初，结束日期将被停用。用户将选择开始日期并使用更改事件，您必须使用与所选开始日期相同的日期来完成结束日期。之后，用户可以选择是否修改结束日期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-24T07:20:19.013

我不确定它在 jQuery Mobile 中是如何工作的，但您可以尝试 jQuery UI DateRangePicker（大部分 jQuery ui 在 jQuery Mobile 中）...

[http://tamble.github.io/jquery-ui-daterangepicker/](http://tamble.github.io/jquery-ui-daterangepicker/)

我很想知道结果。

# php - Jenkins，bitbucket，带有 SSH 的 mercurial

> ID：12125502
> 
> 赞同：0
> 
> 时间：2012-08-25T20:43:12.067
> 
> 标签：php, mercurial, ssh, jenkins, bitbucket

我已经设置了 jenkins，以便它从 bitbucket repo 中提取代码，但要做到这一点，我必须开始使用 SSH 而不是 HTTPS，所以我重新配置了 mercurial 来这样做。

但是，我现在无法推送文件，因为我收到以下错误：“存储库访问被拒绝，通过部署密钥访问是只读的”。

我所做的是在 bitbucket 的部署密钥部分设置公钥，并在选美中启动私钥。

有谁知道我怎样才能摆脱这个错误？

感谢帮助。

顺便提一句。这是我的 mercurial.ini：

```
[ui]
username = username <email>
ssh = "TortoisePlink.exe" -ssh -2 -batch -C

[auth]
bitbucket.username = username
bitbucket.password = password

[extensions]
largefiles =

[paths]
default = ssh://hg@bitbucket.org/username/project 
```

我已经花了几天时间来设置所有东西，所以任何答案都将不胜感激：D 谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T00:35:29.590

当您通过 ssh 推送到 bitbucket 时，您需要使用*您的*ssh 密钥，而不是您设置的部署密钥。您可以在您的 bitbucket 设置中自己添加一个。通常，您会让 Jenkins 作为自己的 windows 用户使用自己的页面运行，并且该用户将使用只读部署密钥。您将以自己的 Windows 用户身份进行推送，并且您将使用自己的 ssh 密钥。

也就是说，如果您想匆忙执行此操作，您可能可以通过将您的`[paths]`部分更改为：

```
[paths]
default = ssh://hg@bitbucket.org/username/project
default-push = http://bitbucket.org/username/project 
```

然后，当 jenkins 拉取时，它将使用`default`路径，即 ssh 和您配置的部署密钥。当您推送时，您将使用`default-push`http 路径，并将检查您的`[auth]`部分（或提示您输入密码）。

# android - android.content.Intent.ACTION_SEND 发送的电子邮件不显示电子邮件选择器：

> ID：12125508
> 
> 赞同：0
> 
> 时间：2012-08-25T20:44:03.427
> 
> 标签：android

我注意到如果我使用以下代码发送电子邮件，则会显示电子邮件组合。但是，我无法从联系人中选择电子邮件，而是必须填写电子邮件地址。是否可以让用户从联系人中获取电子邮件地址：

```
 public void sendSimpleEmail(View button) {
        try {
            Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND);
            emailIntent.setType("plain/text");
            startActivity(emailIntent);
        } catch (Exception e) {
            Log.e(LOG_TAG, "sendSimpleEmail() failed to start activity.", e);
            Toast.makeText(this, "No handler", Toast.LENGTH_LONG).show();
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T06:49:46.383

替换你`startActivity(emailIntent);`的`startActivity(Intent.createChooser(emailIntent));`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T15:03:23.020

正如上面回答的“nandeesh”，这取决于电子邮件应用程序，有些可能允许有些可能不允许。就我而言，我只尝试使用模拟器。

# javascript - 加载ajax响应时jquery执行函数

> ID：12125510
> 
> 赞同：5
> 
> 时间：2012-08-25T20:44:25.043
> 
> 标签：javascript, jquery, ajax

如何执行在客户端等待服务器响应时运行的函数？这是我的代码。我查找并找到了一个 .load() 函数，但它是如何适应的呢？任何帮助都会很棒！谢谢

```
$.ajax({
    type: "POST",
    url: "mail.php",
    data: {name: name.val(), email: email.val(), phone: phone.val(), subject: subject.val(), message: message.val()}
    }).done(function(){
        alert("Your message was sent. We will be in contact with you shortly.");
        window.location="index.html";
}); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-25T20:52:32.880

您在调用 $.ajax() 之后编写的下一行代码将在浏览器等待响应时运行。

所以：

```
$.ajax();
yourAwesomeFN(); 
```

XhttpRequests 是异步的。不需要额外的工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-25T20:53:11.353

您是否查看过[“beforeSend”参数](http://docs.jquery.com/Ajax_Events)。

```
$.ajax({
type: "POST",
    url: "mail.php",
    data: {name: name.val(), email: email.val(), phone: phone.val(), subject: subject.val(), message: message.val()},

   beforeSend: function(){
     // Handle the beforeSend event
   },
   complete: function(){
     // Handle the complete event
   }
   // ......
 }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-25T20:54:19.490

你不能在 JS 中执行另一个函数*时*执行一个函数，因为它是单线程的：你可以在**之前**和**之后**做一些事情- 你是否正在寻找一种方法来设置在等待时显示的消息/微调器？检查调用中的[beforeSend](http://api.jquery.com/jQuery.ajax/)选项`$.ajax()`：

```
$.ajax({
    type: "POST",
    url: "mail.php",
    data: {name: name.val(), email: email.val(), phone: phone.val(), subject: subject.val(), message: message.val()}
    beforeSend : function(){

        // do your stuff here

    }
    }).done(function(){
        alert("Your message was sent. We will be in contact with you shortly.");
        window.location="index.html";
}); 
```

# python - Python：语法错误（+=）

> ID：12125514
> 
> 赞同：0
> 
> 时间：2012-08-25T20:44:46.920
> 
> 标签：python, syntax-error

为什么在这个简单的函数中使用 += 会出现语法错误？

```
def downloadImages(urllist):
  counter = 0 
  for url in urllist:
    downloadSingleImage(url, (filename_prefix + str(counter))
    counter += 1 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T20:45:53.630

你的括号不平衡就行了`downloadSingleImage(url, (filename_prefix + str(counter))`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T20:48:57.200

你最后忘记了一位父母。

```
def downloadImages(urllist):
  counter = 0 
  for url in urllist:
    downloadSingleImage(url, (filename_prefix + str(counter)))
    counter += 1 
```

# php - 传递一个值 IF 集

> ID：12125516
> 
> 赞同：0
> 
> 时间：2012-08-25T20:45:05.597
> 
> 标签：php, forms, variables

我正在尝试在我的网站上设置一个申请表，其中一个页面上有一个主要的大型申请表（parent.php），另一个页面上有一个较小的表单（child2.php），当用户填写他们的一些详细信息和提交较小的表格，他们将被带到较大的表格，并且他们输入的详细信息已经出现在较大表格的相应文本框中，旁边还有一些额外的框供他们填写（如果有道理的话！）

我可以让它工作，因为第二页上的文本框显示第一页上匹配文本框的值，但仅在设置值时。由于用户可以通过较小的表单或直接访问它来访问主应用程序表单，我需要它以便如果设置了值，则显示设置的值并且也将是输入到数据库中的值，或者如果值不是从较小的表单预先设置的，用户可以将他们的信息输入到主表单中，这就是发送到数据库的内容。我想我可能需要使用 ifisset 并尝试这样做，但无处可去。

为凌乱的代码和文本框的设置道歉，因为它们只是为了测试它，我仍然在掌握这一切，如果有人能帮助我/让我知道我是否走在正确的轨道上，我将不胜感激/完全关闭。提前致谢！

**第 1 页 (parent.php)**

```
<form action="child2.php" method="post" class="validate">
  <div>
  <input class="tb" type="text" name="fName" placeholder="first name" id="fName"      value="<?php $fName ?>" required/><br/>
  <br/>
  <input class="tb" type="text" name="sName" placeholder="surname" id="sName" value="<?php $sName ?>" required/><br/>
  <br/>
  <input class="tb" type="email" name="email" required placeholder="email address" id="email" value="<?php $email ?>" required/>
  <br/>
  <input class="tb" type="address" name="address" placeholder="address" value="<?php $address ?>" id="address" />
  <br/>

  <input id="submit" name="submit" type="submit" value="Submit">
  </div>
  </form> 
```

**第 2 页 (child2.php)**

```
<?php
  function renderForm($fName, $sName, $email, $address){ 
  ?>

<form action="" method="post" class="validate">

<label class="label">first name</label><input class="tb" type="text" id="fName"     name="fName" value="<?php if (isset($fName)) { echo $fName = $_REQUEST['fName'];} else {    echo "first name"; }?>"/> 
</br>
<label class="label">surname</label><input class="tb" type="text" id="sName"  name="sName" value="<?php if (isset($sName)) { echo $sName = $_REQUEST['sName'];} else {    echo "surname"; }?>"/>
</br>
<label class="label">email</label><input class="tb" type="email" id="email"  name="email" value="<?php if (isset($email)) { echo $email = $_REQUEST['email'];} else { echo "email"; }?>"/>
</br>
<label class="label">address</label><input class="tb" type="text" id="address"  name="address" value="<?php if (isset($address)) { echo $address = $_REQUEST['address'];} else { echo "address"; }?>"/>
</br> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T20:57:33.580

您正在寻找的是`$_SESSION`变量，这些变量在用户关闭浏览器或 Session 到期之前一直保持活动状态（我认为默认的 PHP 配置时间是 24 分钟......？）。这比出于时间目的将它们存储在数据库中要高效得多。

因此，您可以使用 etc. 设置变量，`$_SESSION['fName'] = $_POST['fName'];`然后稍后使用`echo $_SESSION['fName'];`etc.调用它们。

要`<?php session_start(); ?>`在页面开头使用会话变量（在使用任何 HTML 之前）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T15:40:00.213

正如 khanahk 所建议的，使用 SESSION 变量将完成您的工作。您正在考虑的解决方案的问题在于，只要您将值从一个页面传递到另一个页面，它就可以了，在这么多混乱之后也是如此。

所以，你应该改为，你应该使用这样的东西

```
session_start();

$email = $_SESSION['email'];

<label class="label">email</label><input class="tb" type="email" id="email"  name="email" value="<?php  echo $email; ?>"/> 
```

# javascript - Javascript：控制台日志记录

> ID：12125518
> 
> 赞同：2
> 
> 时间：2012-08-25T20:45:36.637
> 
> 标签：javascript, logging

我`console.log`在我的 JS 文件中使用来跟踪应用程序。

问题：日志在生产环境中。
如何`console.log`从代码中删除行？

PS请不要建议文本解决方案，如`find + xargs + grep -v`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T20:52:00.270

对于我的重要项目，我有自己的内部使用的日志记录函数`console.log()`，但我的代码中没有`console.log()`调用，除了这个函数中的一个地方。然后我可以通过更改一个变量来启用或禁用日志记录。

我的函数实际上比这更多地涉及将输出放置到控制台以外的位置的选项，但从概念上讲，它看起来像这样：

```
// change this variable to false to globally turn off all logging
var myLoggingEnabled = true;   

function myLog() {
    if (myLoggingEnabled) {
        if (window.console && console.log) {
            console.log.apply(this, arguments);
        }
    }
} 
```

然后，您可以使用这样的代码来记录：

```
myLog(foo); 
```

仅供参考，对于部署的代码紧凑性和性能优化，我还有一个最小化步骤，可以`myLog()`从我的代码中删除所有调用。这是我选择利用的优化。也许您可以分享为什么您也不会考虑这种类型的优化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-25T20:47:01.817

好吧，您可以使用以下命令禁用它们

```
console.log=function(){} 
```

但是除非您手动删除它们，否则这些行将在那里。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-10-13T22:29:56.823

如果你使用 Grunt，你可以添加一个任务来删除/注释 console.log 语句。因此不再调用 console.log。

[https://www.npmjs.org/package/grunt-remove-logging-calls](https://www.npmjs.org/package/grunt-remove-logging-calls)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-02T06:14:37.873

是的，我也遇到过类似的情况，我在这里发过。[http://bhavinsurela.com/naive-way-of-overriding-console-log/](http://bhavinsurela.com/naive-way-of-overriding-console-log/) 这是代码的要点。

```
var domainNames =["fiddle.jshell.net"]; // we replace this by our production domain.

var logger = {
    force:false,
    original:null,
    log:function(obj)
    {
        var hostName = window.location.hostname;
        if(domainNames.indexOf(hostName) > -1)
        {
            if(window.myLogger.force === true)
            {
                window.myLogger.original.apply(this,arguments);
            }
        }else {
            window.myLogger.original.apply(this,arguments);
        }
    },
    forceLogging:function(force){
        window.myLogger.force = force;
    },
    original:function(){
        return window.myLogger.original;
    },
    init:function(){
        window.myLogger.original = console.log;
        console.log = window.myLogger.log;
    }
}

window.myLogger = logger;
console.log("this should print like normal");
window.myLogger.init();
console.log("this should not print");
window.myLogger.forceLogging(true);
console.log("this should print now"); 
```

# c++ - 在 C++ 中调用线程中的方法

> ID：12125522
> 
> 赞同：0
> 
> 时间：2012-08-25T20:46:17.183
> 
> 标签：c++, multithreading

我有一个从消息队列中读取的类。现在这个类里面也有一个线程。根据 msg q 中 msg 的类型，它需要在该线程内执行不同的函数，因为类中的主线程始终等待 msg q。一旦从队列中读取消息，它就会检查其类型并调用适当的方法在线程中执行，然后再次返回读取（在 while 循环中读取）。

我正在使用 boost message q 和 boost threads 我该怎么做。它是这样的：

```
while(!quit) {        
    try
    {                        
        ptime now(boost::posix_time::microsec_clock::universal_time());
        ptime timeout = now + milliseconds(100);

        if (mq.timed_receive(&msg, sizeof(msg), recvd_size, priority, timeout))
        {                
            switch(msg.type)
            {
             case collect:
                {
                    // need to call collect method  in thread
                }
                break;                
            case query:
                {
                    // need to call query method  in thread
                }
                break; 
```

等等。可以做到吗？

如果可以做到，那么当线程说执行collect方法并且主线程得到查询消息并想要调用它时会发生什么。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T20:56:54.837

在接收线程执行长操作时到达的消息将被存储以备后用（在队列中，等待处理）。

如果线程完成了它的操作，它会回来并再次调用接收函数，并立即获取它没有查看时到达的第一条消息并可以处理它。

如果主线程需要消息处理操作的结果，它会阻塞，直到工作线程完成并传递结果。

确保在等待主线程操作的工作线程内不要做任何事情，否则会有死锁的风险。

# algorithm - 3SUM 稍加改动

> ID：12125528
> 
> 赞同：7
> 
> 时间：2012-08-25T20:47:05.050
> 
> 标签：algorithm

面试时被问到这个问题，不知道怎么回答。这是一个常规的 3SUM 问题，我们都知道 O(n^2) 的答案。问题是这样的：你有 3 个未排序的数组 a、b、c。找到三个元素，使得 a[i] + b[j] + c[k] = 0。在这种情况下，您不允许使用散列，并且解决方案必须 <= O(n^2)

这是我的答案，是的，不幸的是，这仍然是 O(n^3)

```
public static void get3Sum(int[] a, int[] b, int[] c) {
    int i = 0, j = 0, k = 0, lengthOfArrayA = a.length, lengthOfArrayB = b.length, lengthOfArrayC = c.length;

    for (i = 0; i < lengthOfArrayA; i++) {
        j = k = 0;
        while (j < lengthOfArrayB) {
            if (k >= lengthOfArrayC) {
                j++;
                continue;
            } else if (a[i] + b[j] + c[k] == 0) {
                // found it: so print
                System.out.println(a[i] + " " + b[j] + " " + c[k]);
                k++;
                if (j > lengthOfArrayB - 1)
                    break;

            } else {
                k++;
                if (k >= lengthOfArrayC) {
                    j++;
                    k = 0;
                }

            }
        }
    }
} 
```

有人有什么绝妙的想法可以在小于或等于 O(N^2) 的时间内解决这个问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-26T03:03:32.000

排序 A 和排序 B。

一旦我们在 O(n) 时间内排序，给定一个 S，我们就可以解决找到 i,j 的问题，使得 A[i] + B[j] = S。

我们可以通过维护两个指针 a 和 b 来做到这一点，a 最初位于 A 的最低元素，b 位于最大元素。然后在将 A[a] + B[b] 与 S 进行比较之后，适当地增加或减少 b。

对于您的问题，通过将 S 全部设为 -C[k] 来运行 O(n) 算法 n 次（因此 O(n^2)）。

# python - Scrapy - SgmlLinkExtractor 将 href 文本和 href 传递给 process_value 回调

> ID：12125529
> 
> 赞同：1
> 
> 时间：2012-08-25T20:47:17.337
> 
> 标签：python, python-2.7, scrapy

我想添加对不包含我所追求的单词但 href 文本包含的链接的支持。

我也希望能够提取 href 文本并将其作为第二个参数传递给 process_value 回调。

有谁知道如何实现这些目标？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T07:11:19.617

您应该创建一个 BaseSpider 并根据您想要的任何标准提取链接。

只是给你一个想法：

```
class MySpider(BaseSpider):

    def parse(self, response):
        hxs = HtmlXPathSelector(response)
        links = hxs.select('//a')
        for link in links:
            href = link.select('@href').extract()[0]
            text = links.select('text()').extract()[0]
                # I make an assumption here that you want text() instead of @href here
                if text == 'something':
                        yield Request(href, callback = self.parse_page)

    def parse_page(self, response):
        return #return your item here 
```

# android - 按钮单击时的 Android setlayout 可见性

> ID：12125532
> 
> 赞同：0
> 
> 时间：2012-08-25T20:47:54.250
> 
> 标签：android, android-layout, android-intent, android-emulator

在单击按钮的以下代码中，我想隐藏相对布局`rl1`并显示`rl2`，但是单击按钮后我的应用程序崩溃了。我做错了什么

```
 <?xml version="1.0" encoding="utf-8"?>

  <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    >
<RelativeLayout 
android:id="@+id/rl1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:background="@drawable/welcome_1">

    <ImageView
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"

        android:layout_alignParentRight="true"

        android:paddingTop="360dp"
        android:layout_marginRight="4dp"
        android:src="@drawable/button1" />

     </RelativeLayout>

    <RelativeLayout
        android:id="@+id/rl2"
         android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:visibility="invisible"
     android:background="@drawable/menu_2"
        ></RelativeLayout>
     </RelativeLayout> 
```

Java 代码

```
public class mockupsActivity extends Activity {
/** Called when the activity is first created. */

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

 // ImageButton img1 = (ImageButton)findViewById(R.id.button1);
    ImageView img1 =(ImageView)findViewById(R.id.button1);
    img1.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
           // your code here
   //       Toast.makeText(TouchpointmockupsActivity.this, "test", Toast.LENGTH_SHORT).show();
            LinearLayout rl1 = (LinearLayout) findViewById(R.id.rl1);
            rl1.setVisibility(View.INVISIBLE);
            LinearLayout rl2 = (LinearLayout) findViewById(R.id.rl2);
            rl2.setVisibility(View.VISIBLE);
        }
    });

}
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T20:49:27.087

在您的代码中更改`LinearLayout` 为。`RelativeLayout`你可能会得到一个 classcastException。

编辑：更改 OnClick 方法如下

```
 RelativeLayout rl1 = (RelativeLayout) findViewById(R.id.rl1);
        rl1.setVisibility(View.INVISIBLE);
        RelativeLayout rl2 = (RelativeLayout) findViewById(R.id.rl2);
        rl2.setVisibility(View.VISIBLE); 
```

# jsf-2 - 如何在richFaces中的鼠标光标位置设置弹出面板显示

> ID：12125536
> 
> 赞同：0
> 
> 时间：2012-08-25T20:48:03.310
> 
> 标签：jsf-2, richfaces

是否有任何属性可以将弹出面板显示在richFaces 4中的鼠标光标位置？

我现在想到的一种解决方法是在丰富的show event中产生影响：component()。Show() 函数，通过 javascript 设置弹出窗口的位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T03:16:05.363

您可以通过javascript直接处理richfaces模式面板的显示，如下[所示](http://docs.jboss.org/richfaces/latest_3_3_X/en/devguide/html/rich_modalPanel.html)

[下面这个 js 函数](http://hartshorne.ca/2006/01/23/javascript_cursor_position/)将为您提供鼠标指针的 x/y 坐标位置，您可以将其返回值作为参数传递给`Richfaces.showModalPanel`函数

`function getPosition(e) { e = e || window.event; var cursor = {x:0, y:0}; if (e.pageX || e.pageY) { cursor.x = e.pageX; cursor.y = e.pageY; } else { var de = document.documentElement; var b = document.body; cursor.x = e.clientX + (de.scrollLeft || b.scrollLeft) - (de.clientLeft || 0); cursor.y = e.clientY + (de.scrollTop || b.scrollTop) - (de.clientTop || 0); } return cursor; }`

所以你可以拥有`RichFaces.showModalPanel('panel',{top:getPosition(ev).y,left:getPosition(ev).x})`

对可怕的 javascript 感到抱歉。

# android - 特定时间的每日通知

> ID：12125537
> 
> 赞同：7
> 
> 时间：2012-08-25T20:48:15.033
> 
> 标签：android, service, notifications, alarmmanager

我想实现这一点：

首次打开应用程序后，如果某些条件为真，用户会在每天下午 2 点收到通知。如果条件为假，我们今天不会显示通知。下午 2 点检查条件，它从 Internet 下载一些数据。

到目前为止，我使用了[AlarmManager](http://developer.android.com/reference/android/app/AlarmManager.html)及其方法 setRepeating()，间隔为 24 小时。AlarmManager 启动一个[Service](http://developer.android.com/reference/android/app/Service.html)。在此服务中，我正在下载数据、检查条件以及是否为真 - 显示[Notification](http://developer.android.com/reference/android/app/Notification.html)。由于下载可能会持续超过 5 秒，因此我已`android:process=":background"`为此服务声明，在单独的进程中运行它并且不会阻塞我的 UI。

这种方法有两个缺点：

* * *

1：如果用户在下午4点打开应用程序（并且条件为真），他将**立即**收到通知。来自[setRepeating](http://developer.android.com/reference/android/app/AlarmManager.html#setRepeating%28int,%20long,%20long,%20android.app.PendingIntent%29) () 文档：

> 如果时间发生在过去，将立即触发警报，警报计数取决于触发时间相对于重复间隔过去多长时间。

我希望该用户今天不会收到通知，只会在第二天收到通知，依此类推。

* * *

2：我担心用户关闭手机后我的通知不会显示。来自[AlarmManager](http://developer.android.com/reference/android/app/AlarmManager.html#setRepeating%28int,%20long,%20long,%20android.app.PendingIntent%29)文档：

> 注册的闹钟在设备处于睡眠状态时会保留（并且可以选择在此期间唤醒设备，如果它们在此期间关闭），但如果它被关闭并重新启动，则会被清除。

我不知道是否有可能让它一直工作。

* * *

如果您有任何想法如何使它变得更好，欢迎您。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-25T21:10:55.820

1：我不太确定我是否理解你的问题，但我认为你所要做的就是如果它已经过了下午 2 点，在下午 2 点加一天：

```
GregorianCalendar twopm = new GregorianCalendar();
twopm.set(GregorianCalendar.HOUR_OF_DAY, 14);
twopm.set(GregorianCalendar.MINUTE, 0);
twopm.set(GregorianCalendar.SECOND, 0);
twopm.set(GregorianCalendar.MILLISECOND, 0);
if(twopm.before(new GregorianCalendar())){
    twopm.add(GregorianCalendar.DAY_OF_MONTH, 1);
}
alarmManager.setRepeating(type, twopm.getTimeInMillis(), 1000*60*60*24, intent); 
```

2：您可以注册一个 BroadcastReceiver 以启动并在那里再次启动您的警报。看看这个：[Android BroadcastReceiver on startup - 当 Activity 处于后台时继续运行](https://stackoverflow.com/questions/5290141/android-broadcastreceiver-on-startup)

# joomla - Joomla 不显示菜单

> ID：12125538
> 
> 赞同：1
> 
> 时间：2012-08-25T20:48:48.653
> 
> 标签：joomla, menu, module

我已将此[模板](http://www.joomla24.com/remository/finishdown/5193.html)下载到我的 joomla 2.5.6 中，并且正在尝试创建一个水平菜单。我已经创建了应该显示该菜单的菜单和模块。我已将位置设置为 user3 （正如我所读到的，这是水平菜单的默认位置），但没有显示任何内容。我可以看到我的菜单的唯一位置是“搜索”和“顶部面板”。

谁能指导我如何找到可能导致问题的原因？

编辑：我已将菜单重命名为“menu1”，“菜单类型”也是如此，它已经出现了。为什么？哪里有逻辑？

谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T21:37:15.187

确保您已设置在哪些页面上激活菜单：

![在此处输入图像描述](../Images/2be0ee1676d5c44344060f0dc11900c7.png)

您可以在模块管理器 > 您的菜单中找到这些设置

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T20:58:14.297

在您的网址末尾使用 ?tp=1 检查位置

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-29T11:14:45.403

登录到您的 joomla 后端。

去文章管理器并创建一篇文章..

转到菜单管理器并创建一个新菜单，选择您的文章，如果您创建了其他文章，我主要是一篇文章，然后选择其他文章，例如特色文章或其他，

然后在所需设置的同一页面上选择您创建的文章。

保存并关闭..

现在转到模块管理器，转到菜单或内容菜单或水平菜单，下面会有菜单分配，选择菜单并显示所有页面..

希望这会对你有所帮助.. 谢谢 Anil Bikram Thapa

# apache - ssl 适用于本地 ip 而不是域名

> ID：12125543
> 
> 赞同：4
> 
> 时间：2012-08-25T20:49:08.200
> 
> 标签：apache, ssl, virtualhost

我已经使用自分配证书在我的 apache 服务器上打开了 ssl。如果我转到我的主机名（dev.local），我可以看到 https 证书警告，这是我在 https 时所期望的。但是，如果我去我的虚拟主机中指定的域，https 不起作用。这是我的 httpd.conf 文件中的示例：

```
<VirtualHost *:80>
DocumentRoot /var/www/public_sites/domain
ServerName domain.com
ServerAlias www.domain.com
Alias /mt "/var/www/public_sites/mt"
ErrorLog "/logs/domain/error_log"
CustomLog "/logs/domain/access_log" common
</VirtualHost>

NameVirtualHost *:443

<VirtualHost *:443>
        SSLEngine on
        SSLCertificateFile /etc/pki/tls/certs/ca.crt
        SSLCertificateKeyFile /etc/pki/tls/private/ca.key
        <Directory /var/www/public_sites/domain>
        AllowOverride All
        </Directory>
        DocumentRoot /var/www/public_sites/domain
        ServerName domain.com
</VirtualHost> 
```

如果我去[https://domain.com](https://domain.com)它不起作用。但是[https://dev.local](https://dev.local)确实有效。如果我在本地访问服务器的 IP 地址，它可以工作（192.168.0.194）。如果我转到外部 ip 的 ip 地址（我的静态 ip dns 使用）它不起作用。谁能告诉我为什么会这样？自从我将 NameVirtualHost 特别是 443 虚拟主机放在 httpd 文件中后，它不应该工作吗？

# objective-c - 用Objective-C中的2D数组互换下标指针？

> ID：12125547
> 
> 赞同：0
> 
> 时间：2012-08-25T20:49:40.987
> 
> 标签：objective-c, pointers, casting, static-array

我有一个像这样静态声明的数组`Cell SMatrix_A[36][10]`。当我在代码 ( `Cell foo = SMatrix_A[12][8]`) 中直接使用 SMatrix_A 时，一切正常。但是，我真正想要的是声明其中几个矩阵（SMatrix_A、SMatrix_B 等），然后在运行时在它们之间进行指针变量切换。

我在想象这样的代码（假设 SMatric_A、B、C 已经声明，并且都在同一个文件范围内）：

```
Cell *curMatrix = SMatrix_B;
Cell foo,bar;
...
foo = curMatrix[13][2]; 
```

编译器给了我一个：`Incompatable pointer types assigning 'Cell*' from 'Cell[36][10]'`关于 curMatrix 的初始分配。我认为引用不带下标的数组变量会给我一个指针类型，其值是数组的第一个位置。

我只是错过了演员或其他什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T15:47:28.797

我之前的回答是完全错误的，所以我再试一次！

```
#import <Foundation/Foundation.h>

typedef int matrix_t[3][3];

matrix_t matrix = { { 1, 2, 3}, { 4, 5, 6}, { 7, 8, 9} };

int main(int argc, char *argv[])
{
    matrix_t *matrixPtr = &matrix;

    for (int i = 0; i < 3; i++)
    {
        for (int j = 0; j < 3; j++)
        {
            NSLog(@"%i", (*matrixPtr)[i][j]);
        }
    }
    return 0;
} 
```

You need to typedef your 2D array type (this is likely a good idea so that your SMatrix_A, SMatrix_B all have the same size). Then you can create pointers to it as normal. Note that you must dereference the pointer before you index it.

# ruby-on-rails - Date::DAYNAMES 在 Windows 上不提供正确的 :select :collection

> ID：12125549
> 
> 赞同：1
> 
> 时间：2012-08-25T20:50:10.843
> 
> 标签：ruby-on-rails, ruby, date

当我尝试`Date::DAYNAMES`在我的 Mac 和我的工作 Windows 7 机器上创建一个下拉列表时，我得到一个带有索引和日期名称的选择框。但是，当我将它移到我的上网本（Windows 7）时，我得到的只是日期名称的第一个字母，尽管代码完全相同。任何想法如何解决它？

选择`ActiveAdmin`注册码：

```
ActiveAdmin.register Assessment do
  form do |f|
    f.inputs do
      f.input :start_dow, :as => :select,
                                 :collection => Date::DAYNAMES.each_with_index
    end
    f.buttons
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T04:08:49.583

我不知道为什么它在过去有时会起作用，但我将其切换为：

```
f.input :start_dow, as => :select,
                          :collection => Date::DAYNAMES.each_with_index.to_a 
```

现在它似乎在我迄今为止用于测试的所有平台上都可以正常工作。也许问题出在不同版本的红宝石上？我最近发现我一直在使用不同的版本……</p>

# html - 手动设置字体图标的 wordpress 类别

> ID：12125552
> 
> 赞同：0
> 
> 时间：2012-08-25T20:51:02.233
> 
> 标签：html, wordpress, themes, font-face, categories

我正在编辑 21 个主题，但我想更改类别，以便它们将图标显示为 @fontface 图标而不是单词。

类别需要看起来像这样（以艺术类别为例）：

```
<a href="THELINKINHERE" rel="category" title="View all categories in Art"><i class="icon-brush"></i></a> 
```

然而，这就是它目前的样子。

```
<span class="entry-utility-prep entry-utility-prep-cat-links">Posted in</span><a href="THELINKINHERE" rel="category" title="View all categories in Art">Art</a> 
```

这是我目前的代码：

```
<?php $show_sep = false; ?>
        <?php if ( 'post' == get_post_type() ) : // Hide category and tag text for pages on Search ?>
        <?php
            /* translators: used between list items, there is a space after the comma */
            $categories_list = get_the_category_list( __( ', ', 'twentyeleven' ) );
            if ( $categories_list ):
        ?>
        <span class="cat-links">
            <?php printf( __( '<span class="%1$s">Posted in</span> %2$s', 'twentyeleven' ), 'entry-utility-prep entry-utility-prep-cat-links', $categories_list );
            $show_sep = true; ?>
        </span>
        <?php endif;?>
        <?php endif; // End if categories ?> 
```

该类需要根据设置的帖子类别进行更改有没有办法手动设置哪些图标链接到哪个类别？

您可以在此处查看我的实时模板[http://mhutchinson.me.uk/](http://mhutchinson.me.uk/) 感谢您的帮助！

梅根

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T15:56:01.130

你可能想尝试这样的事情：

（更改 foreach 内的打印 HTML 以满足您的需要）

```
<?php 
foreach((get_the_category()) as $category) { 
echo '<img src="http://example.com/images/' . $category->cat_ID . '.jpg" alt="' .    $category->cat_name . '" />'; 
} 
?> 
```

干杯

# xml - 在 Excel (2007) VBA 中读取和更改多个 XML 文件 - 附加

> ID：12125561
> 
> 赞同：0
> 
> 时间：2012-08-25T20:52:39.520
> 
> 标签：xml, parsing, vba

我尝试使用代码（Olle Sjögren 先生在 8 月 15 日 13:08 的回答）将文件夹 d:\eBobo 中多个 xml 文件中的一行替换为两行

例如，我想更改一行（在该文件夹中的所有 xml 文件中都是相同的）：

啊啊啊啊

成行（也在所有 xml 文件中）：

bbbbbbbbbb

呸呸呸呸

这是我的尝试：

```
Sub ReplaceStringInFile()

    Const sSearchString As String = "d:\eBobo\*.xml"

    Dim sBuf As String
    Dim sTemp As String
    Dim iFileNum As Integer
    Dim sFileName As String
    Dim sFilePath As String

    sFileName = Dir(sSearchString)

    Do While sFileName <> ""

        sFilePath = "d:\eBobo\" & sFileName  'Get full path to file
        iFileNum = FreeFile
        sTemp = ""  'Clear sTemp

        Open sFilePath For Input As iFileNum

            Do Until EOF(iFileNum)

                Line Input #iFileNum, sBuf
                sTemp = sTemp & sBuf & vbCrLf

            Loop

        Close iFileNum

        sTemp = Replace(sTemp, "aaaaaaaaaa", "bbbbbbbbbb" <br /> "cccccccccc")

        iFileNum = FreeFile

        Open sFilePath For Output As iFileNum
        Print #iFileNum, sTemp

        Close iFileNum

        sFileName = Dir() 'Get the next file
    Loop
End Sub 
```

我收到一条消息语法错误。任何帮助将不胜感激。

谢谢您的回答！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T14:05:01.817

试试这个删除多余的引号：

```
sTemp = Replace(sTemp, "aaaaaaaaaa", "bbbbbbbbbb <br /> cccccccccc") 
```

如果你真的想要在你的 xml 代码中有两行，试试这个：

```
sTemp = Replace(sTemp, "aaaaaaaaaa", "bbbbbbbbbb" & vbCRLF & "cccccccccc") 
```

# mercurial - 修改 Mercurial 中的“公共”变更集

> ID：12125562
> 
> 赞同：17
> 
> 时间：2012-08-25T20:52:55.353
> 
> 标签：mercurial, mercurial-amend

我想修改我的最后一次提交，但正在运行

```
hg commit --amend 
```

给我

> 中止：无法修改公共变更集

即使我知道编辑变更集是安全的。如何更改我上次提交的阶段和/或告诉 Mercurial 可以安全地修改？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-08-25T20:52:55.353

在 Mercurial wiki 上，有一个很好[的阶段概述](https://www.mercurial-scm.org/wiki/Phases)。

要将当前提交从“public”转换为“draft”提交以允许修改，请使用

```
hg phase --draft --force . 
```

`.`（或者如果您想编辑不同的变更集，则替换为另一个修订版）。

# android - sqlite android 基础知识...我错过了什么吗？

> ID：12125575
> 
> 赞同：0
> 
> 时间：2012-08-25T20:54:36.377
> 
> 标签：android, sqlite

好的，所以我已经查看了大概 30 个不同的 SQLite 教程，甚至还有一些关于它的随机讨论。我不是一个程序员，我发现如果我能找到已经在做某事的人，并根据需要进行调整并给予信任，那么它可能比仅仅重新创建轮子更有效率。我敢肯定，我不是唯一一个有这种感觉的人。

在 Eclipse 中，我正在尝试为我的数据库管理类的上下文创建一个构造函数。这是完整的代码。它还没有完成，但在错误消失之前我无法取得进展，所以我们开始吧：

```
package com.bluej.movingbuddy;

import java.util.ArrayList;
import java.util.List;
import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.database.SQLException;
import android.util.Log;

public class MBDatabaseManager {

//Database Version
private final static int DATABASE_VERSION = 1;

//Database Name
private final static String DATABASE_NAME = "dbMovingBuddy";

//items and weights table name
private final static String tblInW = "ItemsAndWeights";
//items and weights table columns
private final static String InWID = "ID";
private final static String InWItem = "Item";
private final static String InWDesc = "Description";
private final static String InWWeightOne = "Weight1";
private final static String InWWeightTwo = "Weight2";
private final static String InWWeightThree = "Weight3";
private final static String InWWeightAvg = "WeightAvg";

//allowances table name
private final static String tblAllowances = "Allowances";
//allowances table columns
private final static String AllowancesID = "ID";
private final static String AllowancesRank = "Rank";
private final static String AllowancesWithDep = "WithDep";
private final static String AllowancesNoDep = "NoDep";

//estimator table name
private final static String tblEstimator = "Estimator";
//estimator table columns
private final static String EstimatorID = "ID";
private final static String EstimatorRoom = "Room";
private final static String EstimatorItem = "Weight";

//inventory table name
private final static String tblInventory = "Inventory";
//inventory table column
private final static String InventoryID = "ID";
private final static String InventoryItem = "Item";
private final static String InventoryWeight = "Weight";
private final static String InventoryValue = "Value";
private final static String InventoryImage1 = "Image1";
private final static String InventoryCondition = "Condition";
private final static String InventoryImage2 = "Image2";
private final static String InventoryNotes = "Notes";
private final static String InventoryMovingInstructions = "MovingInstructions";

//stunt table name
private final static String TABLE_NAME = "database_table";
//stunt table column names
private final static String TABLE_ROW_ID = "id";
private final static String TABLE_ROW_ONE = "table_row_one";
private final static String TABLE_ROW_TWO = "table_row_two";

public MBDatabaseManager(Context context) {
    // TODO Auto-generated constructor stub
    super(context, DATABASE_NAME, null, DATABASE_VERSION);
}

public void onCreate(SQLiteDatabase db) {
    // TODO Auto-generated method stub
    //This string is used to create the database. It should be changed to suit your needs.

    //create items and weights table
    String dbCreateItemsAndWeights = "create table " +
    tblInW +
    " (" +
    InWID + " integer primary key autoincrement not null," +
    InWItem + " text," +
    InWDesc + " text," +
    InWWeightOne + " integer," +
    InWWeightTwo + " integer," +
    InWWeightThree + " integer," +
    InWWeightAvg + " integer" +
    ");";

    db.execSQL(dbCreateItemsAndWeights);

    //allowances table
    String dbCreateAllowances = "create table " +
    tblAllowances +
    " (" +
    AllowancesID + " integer primary key autoincrement not null," +
    AllowancesRank + " text," +
    AllowancesWithDep + " integer," +
    AllowancesNoDep + " integer" +
    ");";

    db.execSQL(dbCreateAllowances);

    //estimator table
    String dbCreateEstimator = "create table " +
    tblEstimator + 
    " (" +
    EstimatorID + " integer primary key autoincrement not null," +
    EstimatorRoom + " text," +
    EstimatorItem + " integer" +
    ");";

    db.execSQL(dbCreateEstimator);

    //inventory table
    String dbCreateInventory = "create table " +
    tblInventory + 
    " (" +
    InventoryID + " integer primary key autoincrement not null," +
    InventoryItem + " text," + 
    InventoryWeight + " integer," +
    InventoryValue + " integer," +
    InventoryImage1 + " blob," +
    InventoryCondition + " text," + 
    InventoryImage2 + " blob," + 
    InventoryNotes + " text," +
    InventoryMovingInstructions + " text" +
    ");";

    db.execSQL(dbCreateInventory);      

    //stunt table
    String newTableQueryString = "create table " +
    TABLE_NAME +
    " (" +
    TABLE_ROW_ID + " integer primary key autoincrement not null," +
    TABLE_ROW_ONE + " text," +
    TABLE_ROW_TWO + " text" +
    ");";

    db.execSQL(newTableQueryString);        

}

public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    // TODO Auto-generated method stub

    db.execSQL("DROP TABLE IF EXISTS " + tblInW);
    db.execSQL("DROP TABLE IF EXISTS " + tblAllowances);
    db.execSQL("DROP TABLE IF EXISTS " + tblEstimator);
    db.execSQL("DROP TABLE IF EXISTS " + tblInventory);
    db.execSQL("DROP TABLE IF EXISTS " + TABLE_NAME);

    onCreate(db);
}

// Adding a row to the database table
public void addRow(String rowStringOne, String rowStringTwo){

    SQLiteDatabase db = this.getWritableDatabase();

    //this is a key value pair holder used by android's SQLite functions
    ContentValues values = new ContentValues();
    values.put(TABLE_ROW_ONE, rowStringOne);
    values.put(TABLE_ROW_TWO, rowStringTwo);

    //ask the database object to insert the new data
    try {
        db.insert(TABLE_NAME,  null, values);
    } catch (Exception e) {
        // TODO Auto-generated catch block
        Log.e("DB ERROR", e.toString());
        e.printStackTrace();
    }
}

//DELETING A ROW FROM THE DATABASE TABLE
//
// This is an example of how to delete a row from a database table
// using this class. In most cases, this method probably does not need to be rewritten.
//
// @param rowID the SQLite database identifier for the row to delete.
//
public void deleteRow(long rowID){

    // ask the database object to delete the row of given rowID
    try {
        db.delete(TABLE_NAME, TABLE_ROW_ID + "=" + rowID, null);
    } catch (Exception e) {
        // TODO Auto-generated catch block
        Log.e("DB ERROR", e.toString());
        e.printStackTrace();
    }

}

//UPDATING A ROW IN THE DATABASE TABLE
//
// This is an example of how to update a row in the database table
// using this class. You should edit this method to suit your needs.
//
// @param rowID the SQLite database identifier for the row to update.
// @param rowStringOne the new value for the row's first column
// @param rowStringTwo the new value for the row's second column

public void updateRow(long rowID, String rowStringOne, String rowStringTwo){

    //this is a key value pair holder used by android's SQLite functions
    ContentValues values = new ContentValues();
    values.put(TABLE_ROW_ONE,  rowStringOne);
    values.put(TABLE_ROW_TWO,  rowStringTwo);

    //ask the database object to update the database row of given rowID
    try {
        db.update(TABLE_NAME,  values, TABLE_ROW_ID + "=" + rowID, null);
    } catch (Exception e) {
        // TODO Auto-generated catch block
        Log.e("DB Error", e.toString());
        e.printStackTrace();
    }
}

//RETRIEVING A ROW IN THE DATABASE TABLE
//'
// This is an example of how to retrieve a row from a database table using this class. You should edit this method to suit your needs.
//
// @param rowID the id of the row to retrieve
// @return an array containing the data from the row

public ArrayList<Object> getRowAsArray(long rowID){

    //create an array list to store data from the database row.
    //I would recommend creating a JavaBean compliant object 
    //to store this data instead. That way you can ensure data types are correct.
    ArrayList<Object> rowArray = new ArrayList<Object>();
    Cursor cursor;

    try {
        // this is a database call that creates a "cursor" object.
        // the cursor object stores the information collected from the 
        // database and is used to iterate through the data.
        cursor = db.query(
                TABLE_NAME,
                new String[] { TABLE_ROW_ID, TABLE_ROW_ONE, TABLE_ROW_TWO },
                TABLE_ROW_ID + "=" + rowID,
                null, null, null, null, null);

        //move the pointer to position zero in the cursor.
        cursor.moveToFirst();

        // if there is data available after the cursor's pointer, add
        // it to the ArrayList that will be returned by the method.

        if (!cursor.isAfterLast()){
            do{

                rowArray.add(cursor.getLong(0));
                rowArray.add(cursor.getString(1));
                rowArray.add(cursor.getString(2));

              } while (cursor.moveToNext());

            }

        //let java know that you are through with the cursor.
        cursor.close();

    } catch (SQLException e) {
        // TODO Auto-generated catch block
        Log.e("DB ERROR", e.toString());
        e.printStackTrace();
    }

    //return the ArrayList containing the given row from the database.
    return rowArray;

    }

//RETRIEVING ALL ROWS FROM THE DATABASE TABLE
//
//This is an example of how to retrieve all data from a database table using this class.
//You should edit this method to suit your needs.
//
// the key is automatically assigned by the database

public ArrayList<ArrayList<Object>> getAllRowsAsArrays(){

    //create an ArrayList that will hold all of the data collected from the database
    ArrayList<ArrayList<Object>> dataArrays = new ArrayList<ArrayList<Object>>();

    //this is a database call that creates a "cursor" object.
    //the cursor object stores the information collected from the database and is used to iterate through the data.
    Cursor cursor;

    try{
        //ask the database object to create the cursor.
        cursor = db.query(
                TABLE_NAME,
                new String[]{TABLE_ROW_ID, TABLE_ROW_ONE, TABLE_ROW_TWO},
                null, null, null, null, null
                );

        //move the cursor's pointer to position zero.
        cursor.moveToFirst();

        //if there is data after the current cursor position add it to the ArrayList.
        if (!cursor.isAfterLast()){

            do
            {
                ArrayList<Object> dataList = new ArrayList<Object>();

                dataList.add(cursor.getLong(0));
                dataList.add(cursor.getString(1));
                dataList.add(cursor.getString(2));

                dataArrays.add(dataList);
            } 

            //move the cursor's pointer up one position.
            while (cursor.moveToNext());

        }
    }
    catch (SQLException e){

        Log.e("DB ERROR", e.toString());
        e.printStackTrace();
    }

    //return the ArrayList that holds the data collected from the database.
    return dataArrays;
}

} 
```

因此，现在我再次查看它时出现了两个错误。当我制作构造函数时

```
public MBDatabaseManager(Context context) {
    // TODO Auto-generated constructor stub
    super(context, DATABASE_NAME, null, DATABASE_VERSION);
} 
```

Eclipse 吓坏了，说“构造函数对象未定义”，当我使用 eclipse 修复它时，它删除了所有上下文内容并变成了 super();。我还没有完全理解所有内容，但我很确定这不会让我很快。

另外，当我尝试

```
SQLiteDatabase db = this.getWritableDatabase(); 
```

它也给了我一个错误，说“方法 getWritableDatabase() 未定义 MBDatabaseManager 类型”

我不知道我错过了什么伙计们。我敢肯定，这很明显。请协助。我需要第二或第三双眼睛。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T20:58:49.110

例如，您忘记扩展基类`public class MBDatabaseManager extends SQLiteOpenHelper`。

您尝试调用的超级构造函数 is`public SQLiteOpenHelper (Context context, String name, SQLiteDatabase.CursorFactory factory, int version)`并且您的调用是正确的，并且在继承`SQLiteOpenHelper`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T21:01:14.127

没有 super ( `Object`) ctor 接受您传递的参数，也没有调用方法`getWritableDatabase`。

你的意思是[继承 SQLiteOpenHelper](http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html)吗？

# java - 如何（取消）隐藏 SWT TableItem？

> ID：12125579
> 
> 赞同：1
> 
> 时间：2012-08-25T20:55:24.743
> 
> 标签：java, events, swt

我试图让我的用户搜索信息表，动态隐藏/显示包含搜索的结果。我已将隐藏部分关闭，并且效果很好，但是一旦更改了搜索条件，我就无法再次显示表格项目。

这是我的隐藏代码：

```
searchField.addModifyListener(new ModifyListener() {
            @Override
            public void modifyText(ModifyEvent arg0) {
                modified = true;
                for (int i = 0; i < table.getItems().length; i++) {
                    if (!(table.getItem(i).getText(2)
                            .contains(searchField.getText()))) {
                        table.getItem(i).dispose();
                    }

                }
                if ("".equals(searchField.getText())) {
                    modified = false;
                                    //where I would want to un-hide items
                }
            }
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T14:08:23.207

在调用之前，您可能必须将数据保存`TableItem`到集合中`dispose`。`Table`然后，当您再次搜索时，您可以检查该集合，如果找到匹配项，则通过创建 new重新插入`TableItem`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T21:14:38.350

实际使用某种表模型和 JFace 绑定进行操作不是更好吗，而是那样做？是的，处置不是隐藏。您可能应该从表中删除该项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T21:03:20.903

查看您的代码，您似乎试图通过调用来*隐藏*. 如果你处理一个小部件，它就永远消失了。你无法取回它。`item``dispose()`

如果要再次*取消隐藏*，则必须在先前隐藏的位置创建一个具有相同内容的新项目。

# android - 处理可变（但很少）数量的已保存项目的最佳实践

> ID：12125581
> 
> 赞同：0
> 
> 时间：2012-08-25T20:56:16.127
> 
> 标签：android, sharedpreferences, android-sqlite

我需要为我的用户提供向屏幕添加按钮的能力。这些按钮将具有标准操作（发送带有预定义文本的短信）。我应该如何保存这些项目？它们将有一个名称和一个文本，可以删除，也可以拖动以更改位置。我应该使用带有加载程序的 sqlite 和 listview 还是仅使用 sharedpreferences （但我不知道在这种情况下如何）以及以编程方式添加到布局中的按钮。项目的数量会非常少（在大多数情况下 <10），所以 sqlite 的工作似乎有点太多（我不想使用列表视图）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T21:04:04.520

这个答案似乎是最适合你的！（根据我从您的问题中了解到的）

[https://stackoverflow.com/a/4955428/327402](https://stackoverflow.com/a/4955428/327402)

它展示了如何在首选项中存储一对字符串字符串。

另一种方法是将其保存在内存中：

```
File file = new File(getDir("data", MODE_PRIVATE), "map");    
ObjectOutputStream outputStream = new ObjectOutputStream(new FileOutputStream(file));
outputStream.writeObject(map);
outputStream.flush();
outputStream.close(); 
```

# c# - 阅读 RSS 提要时程序锁定

> ID：12125588
> 
> 赞同：2
> 
> 时间：2012-08-25T20:57:34.527
> 
> 标签：c#, multithreading, rss

我为自己创建了一个阅读 RSS 提要并将它们返回给我的主类的类。我用于此的代码是：

```
public List<Post> getLatestPosts()
{
    this.rssReader = new XmlTextReader(this.rssUrl);
    this.rssDoc = new XmlDocument();

    // Load the XML content into rssDoc
    rssDoc.Load(rssReader);

    // ... other code to parse XML ... //
} 
```

现在，当我调用`getLatestPosts()`我的应用程序时，它会锁定几秒钟。我假设这是因为这是应用程序请求 RSS 提要（网络延迟等）所需的时间。

我想改变它，这样我的程序就不会锁定，而只是等待响应。我有在我的主窗体中使用线程的想法，但我对如何捕获任何 RSS 数据感到困惑`getLatestPosts()`。

如果我在按钮中执行此操作，请单击我的主表单：

```
private void bGetLatestPosts_Click(object sender, EventArgs e)
{
    Thread thread = new Thread(new ThreadStart(rssReader.getLatestPosts()));
} 
```

我没有捕捉任何`getLatestPosts()`返回的东西。

我对线程完全陌生（这主要是我在尝试学习它们），但我确实有*一些*C# 经验。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T20:59:54.277

我假设您正在编写一个 WinForms 应用程序。编写响应式 WinForms 应用程序有两个重要规则：

*   您在主 UI 线程上执行的所有操作都应该快速完成。
*   您不能从主线程以外的任何线程访问控件。

要解决您的问题，请在[`BackgroundWorker`](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx).

> BackgroundWorker 类允许您在单独的专用线程上运行操作。下载和数据库事务等耗时的操作可能会导致您的用户界面 (UI) 在运行时似乎停止响应。当您需要响应式 UI 并且面临与此类操作相关的长时间延迟时，BackgroundWorker 类提供了一种方便的解决方案。
> 
> 要在后台执行耗时的操作，请创建一个 BackgroundWorker 并侦听报告操作进度并在操作完成时发出信号的事件。您可以通过编程方式创建 BackgroundWorker，也可以从工具箱的“组件”选项卡将其拖到表单上。如果在 Windows 窗体设计器中创建 BackgroundWorker，它将出现在组件托盘中，其属性将显示在属性窗口中。
> 
> 要设置后台操作，请为 DoWork 事件添加事件处理程序。在此事件处理程序中调用您的耗时操作。要开始操作，请调用 RunWorkerAsync。要接收进度更新通知，请处理 ProgressChanged 事件。要在操作完成时接收通知，请处理 RunWorkerCompleted 事件。

以下是一些可能对您有所帮助的代码：

```
private void bGetLatestPosts_Click(object sender, EventArgs e)
{
    bGetLatestPosts.Enabled = false;
    backgroundWorker.RunWorkerAsync();
}

private void backgroundWorker_DoWork(object sender, DoWorkEventArgs e)
{
    e.Result = getLatestPosts();
}

private void backgroundWorker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
{
    if (e.Error != null)
    {
        // Handle exception...
    }
    else
    {
        List<Post> result = (List<Post>)e.Result;
        // Update GUI...
    }
    bGetLatestPosts.Enabled = true;
} 
```

# wpf - 如何在 WPF KeyDown 事件中正确检索修饰键？

> ID：12125590
> 
> 赞同：8
> 
> 时间：2012-08-25T20:57:53.530
> 
> 标签：wpf, keyboard-shortcuts

我已经看到了许多建议使用`Keyboard.Modifiers`来确定`KeyDown`事件是否针对具有修饰符集的键的答案。不幸的是，因为`Keyboard.Modifiers`返回修饰符的*当前*状态（而不是按下键时修饰符的状态），这会导致快速打字员非常烦人的间歇性错误。

具体来说，假设有人按下 Ctrl+A，然后在按下 A 几毫秒后松开 Ctrl。现在假设系统负载很重；密钥处理程序开始执行但被抢占了 50 毫秒。当键处理程序再次执行时，Ctrl 的*当前*状态是“释放”。键处理程序现在会认为在没有 Ctrl 的情况下按下了“A”，这很*糟糕*。

同样，如果快速打字员输入 A，Ctrl+End 并且我的应用程序使用`Keyboard.Modifiers`，它最终可能会观察到 Ctrl+A...

在 WinForms 中，该事件*准确地*`KeyDown`告诉我 Ctrl 的状态，即使在处理事件时它已经被释放。如何在 WPF 中获得相同的行为？

 ***编辑**：Keyboard.Modifiers 可能实际上并未检索“当前”修饰键，而是检索与当前正在处理的按键消息相关的修饰键。在 WinAPI 中，这是“异步”和非异步键状态函数之间的区别。不幸[的是，文档](http://msdn.microsoft.com/en-us/library/system.windows.input.keyboard.modifiers.aspx)没有提到“当前”的确切含义。如果有人知道，请说出来。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T21:53:14.870

由于事件参数中似乎没有任何修饰符信息，您可以自己跟踪某些字段中的状态并处理两者`KeyUp`并`KeyDown`相应地更新它们。

例如

```
private bool ctrl = false;
private void This_KeyDown(object sender, KeyEventArgs e)
{
    if (e.Key == Key.LeftCtrl) //or switch, also: `LeftCtrl` & `RightCtrl` are treated as separate keys
        ctrl = true;
    //etc..
}

private void This_KeyUp(object sender, KeyEventArgs e)
{
    if (e.Key == Key.LeftCtrl)
        ctrl = false;
    //etc..
} 
```

这是否真的是一个好主意，我不能说......

* * *

如果你想处理关键手势，我建议使用专用方法，比如[`KeyBindings`](http://msdn.microsoft.com/en-us/library/system.windows.input.keybinding.aspx)它们应该只在手势发生时触发。对于其他输入，您可能还想看看[`TextInput`](http://msdn.microsoft.com/en-us/library/system.windows.uielement.textinput.aspx)哪个更抽象，并返回输入被翻译成的文本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T03:17:27.130

对不起这个破坏性的答案，但......

经过一点研究，我很清楚......该事件被称为“KeyDown”而不是“KeyCombinationDown”，因此它完全独立于之前按下的任何修饰符......

实际上，有一个正确的方法可以实现您的目标：使用命令模式。

您定义一个命令（参见 google 的 WPF 命令）并向您的应用程序添加一个 KeyBinding，您可以在其中定义将启动命令的键或键/键组合...

请参阅此处的示例：http: [//msdn.microsoft.com/en-us/library/system.windows.input.keybinding.aspx](http://msdn.microsoft.com/en-us/library/system.windows.input.keybinding.aspx)

恕我直言，这是*唯一*的方法，并且在语义上也更优雅。

（如果此模式在 GENERAL 中对您不起作用，您可能必须使用带有 pinvoke 的本机 api）。

干杯。*

# php - PHP/MySQL 从多个 WHERE 和范围中进行选择

> ID：12125592
> 
> 赞同：0
> 
> 时间：2012-08-25T20:58:11.317
> 
> 标签：php, mysql

这正是我想做的（按照对我有意义的顺序一步一步）

1.  从表中选择
2.  WHERE x 在变量 $x 的 +/- 6 范围内
3.  并且 y 在变量 $y 的 +/- 6 范围内
4.  并希望所有这些都以井井有条的方式返回..

这可能吗？不是真的想把它交给我，更多的是寻找搜索的起点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T21:01:26.027

`BETWEEN`是你的答案。

```
SELECT * FROM table WHERE x BETWEEN $x-6 AND $x+6 AND y BETWEEN $y-6 AND $y+6 
```

放入`mysqli_query`（或使用`PDO`）并获取结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T21:03:12.553

一个 select 语句中只能有一个 where 子句

但是您可以使用多个比较器，例如

```
select * from table where (col1=10 and column2>25)  or col3=10 
```

对于您的上述查询

```
select * from table where (x>-6 and x<6) and  (x>-6 and x<6) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T21:03:47.817

```
SELECT * FROM table
WHERE x >= $x - 6 AND x <= $x + 6
AND y >= $y - 6 AND y <= $y + 6 
```

然后使用 PHP 的函数来`fetch_array`查询

# database - 这个数据库模型有意义吗？

> ID：12125594
> 
> 赞同：0
> 
> 时间：2012-08-25T20:58:19.857
> 
> 标签：database, model

我是关于建模数据库的新手。但我尽我所能，尽可能多地自学。因此我想问你，我的第一次尝试是否对以下示例有意义：

![在此处输入图像描述](../Images/60fe6c4a983db4291f4102358e16aee6.png)

所以我对数据库进行了如下建模：

![在此处输入图像描述](../Images/3a6292fca841bff01a9886b49850d539.png)

该数据库是关于医学的。有几种药物应根据患者的年龄给药。每个药物项目可以属于一个或多个组（或不属于）。

这只是一个测试用例来展示我到目前为止所学到的东西。因此，欢迎每一个提高我技能的提示！

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T21:30:57.207

1.  表`relationtable`名只是一个占位符，对吧？它应该更具描述性，也许`dosage`？

2.  有些事情告诉我，年龄范围会有很大差异。有些药物对 3 岁以下的儿童有不同的规定，其他的 5 岁以下、10 岁以下等等。`start`无需创建单独的表，只需`end`在`relationtable`. 查询会容易得多，我不会认为这是非规范化。

3.  谈论`age`和`dose`表格 - 摆脱`unit`列并使用标准化的固定单位。年龄为年，剂量为毫克。这将使查询变得更加简单。不要害怕使用浮点数，例如 0.5 表示六个月。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T21:41:33.667

我同意 Tomasz 所写的内容并想补充：

1.  关系表是否正确取决于表中未包含的一些知识。一种药物可以属于不同的组，并且剂量取决于这种关系，这听起来很奇怪。我希望一种药物可以属于不同的组（产生一个medicine2group映射表）并且它们存在不同的剂量取决于药物的年龄（所以你得到dose4age表，结合现有的年龄和剂量表。那个新表会直接参考药物）

仅从表格中无法判断哪个版本是正确的。

根据经验：当没有正确名称和概念的表格链接的表格多于另外两个表格时，我会持怀疑态度。这是可能的，但经常暗示隐藏在某处的概念。

为了检查建议的模型是否正确，如果您在前三行之一中将 Antibiotika 替换为 Superantibiotika，请询问业务专家该表是否仍然正确。如果是，这意味着剂量不取决于组，不应该与它挂钩，所以我提出的模型会更正确。

如果更改后的表格不正确，您的模型可能是更好的模型，但我会仔细聆听为什么它不正确的解释。

# google-apps-script - Google Apps 脚本 - 摘要式身份验证 - 端到端示例？

> ID：12125595
> 
> 赞同：0
> 
> 时间：2012-08-25T20:58:20.513
> 
> 标签：google-apps-script

我已经玩了好几天了，没有运气。挑战之一是无法查看“UrlFetch”的网络流量，因为它位于 Google 的线路上。

有兴趣发布使用“Digest Auth”和 Google Apps 脚本的详细示例吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T17:24:09.940

这应该是可能的，但我不确定我以前是否见过它。我简要地研究过一次，但摘要式身份验证非常复杂，手动编码是一项任务。如果您正在寻找用于测试的服务器，我建议您使用[test.webdav.org](http://test.webdav.org/)，并且有一些现有的 JavaScript 库，例如[dijestj](http://code.google.com/p/digestj/)，您可以利用或学习这些库。

# android - 提要对话框 - 如何将隐私更改为私人 - Android

> ID：12125597
> 
> 赞同：1
> 
> 时间：2012-08-25T20:58:38.960
> 
> 标签：android, facebook-graph-api

有没有办法在使用 Feed Dialog 抛出我的 Android 应用程序时更改隐私设置？

我想在当前用户的墙上发一条私信...

我知道默认情况下该帖子将是公开的，但对我来说重要的是它将是私人的..

有没有办法用 Feed 对话框来做，还是我必须从图形 api 做，然后请求所需的权限才能代表用户发帖（我真的不想......因为我设法以所需的最低权限创建了一个完整而丰富的应用程序）

# php - CakeRequest $request, CakeResponse $response

> ID：12125598
> 
> 赞同：0
> 
> 时间：2012-08-25T20:58:42.283
> 
> 标签：php, cakephp, oauth, cakephp-2.0

此代码仅在我做一个简单的帖子或获取请求时才有效。

```
 public function authenticate(CakeRequest $request, CakeResponse $response) { 
        //some code - facebook
    } 
```

但就我而言，我有两个选择。通过 facebook 或普通登录（表单）登录。

目前的问题是，当我点击提交表单时，功能验证也会被执行。所以我的问题是：我如何检测 Post 请求的名称是什么？就像是`isset($_POST['submitted_fb']`

主要问题是当我执行任何 Post 请求时总是调用该函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T21:08:21.647

仅当您未登录或无权查看页面时才会进行身份验证。

做这样的验证：

```
public function authenticate(CakeRequest $request, CakeResponse $response) { 
     if($request->data['loginType'] == 'facebook') {
         // Do facebook login
     } else {
         // Do form login
     }
} 
```

并在您的视图中添加一个隐藏的表单：

```
echo $this->Form->input('loginType', array('type' => 'hidden', 'value' => 'facebook')); 
```

# ruby-on-rails-3 - 如何通过 has_many 在 rails 3 中正确执行新操作？

> ID：12125603
> 
> 赞同：0
> 
> 时间：2012-08-25T20:59:43.440
> 
> 标签：ruby-on-rails-3, associations, has-many-through

好的根据所取得的进展大量更新这个问题，同时通过消除一些与问题无关的信息来简化这个问题。我一直在审查很多关于 has_many 的帖子和 railscasts ：通过，但我仍然对相对简单的/新形式有问题......这是模型：

**/app/models/user.rb（将用户视为医生）**

```
 has_many :intakes
  has_many :patients, :through => :intakes
  accepts_nested_attributes_for :intakes 
```

**/app/models/intake.rb**

```
 belongs_to :user
  belongs_to :patient 
```

**/app/models/patient.rb**

```
has_many :intakes
has_many :users, :through => :intakes
    accepts_nested_attributes_for :intakes
    accepts_nested_attributes_for :users 
```

现在，我想要做的是一个简单的**/patients/new**并有一个表格，其中包含一些患者信息和两个医生（用户）的下拉列表。执行此操作的经典方法已解释为：

**/app/controllers/patients_controller.rb**

```
def new
  @patient = Patient.new
  2.times { @patient.intakes.build.build_user }
end 
```

在我看来： **/app/views/patient/new.html.erb**

```
<%= form_for @patient do |f| %>
  <%= render 'fields', :f => f %>
  <%= f.submit "Add Patient" %>
<% end %> 
```

最后，部分字段： **/app/views/patients/_fields.html.erb**

```
<%= f.fields_for :intakes do |builder| %>
    <%= builder.label :first_name, "Cared for by" %>

    <%= select("patient[new_intake_attributes]", "user_id",
                            User.justthishosp(current_user.hospital).collect {
                    |user|
        [ user.first_name+" "+user.last_name, user.id]} ) %>
<% end %> 
```

现在上面实际上**确实**导致了表单出现，并且有**两个**“摄入” html select 元素！是的！问题是**A)**只有第*一次*摄入会保存，因为**B)**摄入 HTML 格式与我在所有建议中看到的不匹配，**C)**我无法确定正确的 SELECT 语法来获取与建议匹配的 HTML 格式。

上述代码生成的 HTML 是：

```
<label for="patient_intakes_attributes_0_first_name">Cared for by</label>
    <select id="patient_new_intake_attributes_user_id"
name="patient[new_intake_attributes][user_id]">
<option value="1"> </option>
<option value="4">Dan Akroyd</option>
<option value="2">Dave Collins</option></select>
    </p>

    <p>
    <label for="patient_intakes_attributes_1_first_name">Cared for by</label>
    <select id="patient_new_intake_attributes_user_id" 
name="patient[new_intake_attributes][user_id]"><option value="1"> </option>
<option value="4">Dan Akroyd</option>
<option value="2">Dave Collins</option></select> 
```

注意，特别是**选择名称**的形式： **name="patient[new_intake_attributes][user_id]"**

他们在 Advanced Rails 食谱中想要的是： **name="patient[new_intake_attributes][][user_id]"**

他们说您应该通过以下选择行来实现这一目标： **select("patient[new_intake_attributes][]", "user_id",**

但是，该语法给了我 *`@patient[new_intake_attributes]' is not allowed as an instance variable name*

我已经尝试了很多 [] 和患者，患者，:患者的变体，但我无法得到任何东西来给我在患者 [new_intake_attributes] 之后包含空 [] 的 HTML

所以，此时我在表单上有两个选择框，但只有**一个**保存，因为只有一个在 params 哈希中传递。其中，顺便说一句，看起来像这样：

```
(PatientsController.create) params[:patient]: 
{"first_name"=>"Nine", "last_name"=>"Niner", ...,
 "new_intake_attributes"=>{"user_id"=>"2"}, "pri_loc_id"=>"6"} 
```

我需要：

```
"new_intake_attributes"=>[{"user_id"=>"2"},{"user_id"=>"4"}] 
```

或者我可以很乐意在我的虚拟方法中处理的*任何类型的集合。*

哇！圣烟！谢谢！

# python - 正则表达式：拉取“FOO”和“BAR”之间的数据

> ID：12125605
> 
> 赞同：2
> 
> 时间：2012-08-25T20:59:54.157
> 
> 标签：python, regex

我在这里有这个字符串：

```
*TACK F\u00d6R DIN BOKNING MED RYANAIR*****\r\n------------------------------\r\n\r\nV\u00e4nligen svara inte p\u00e5 detta e-postmeddelande.****\r\n------------------------------\r\n\r\nDITT BOKNINGSNUMMER \u00c4R:* A1A1A1*****\r\n\r\nF\u00d6R ATT F\u00c5 RESA M\u00c5STE DU CHECKA IN VIA INTERNET OCH P\u00c5 FLYGPLATSEN VISA UPP\r\nDITT INTERNETBOARDINGKORT OCH GILTIG ACCEPTERAD RESEHANDLING. PASSAGERARE\r\nSOM INTE VISAR UPP ETT BOARDINGKORT P\u00c5 FLYGPLATSEN KOMMER ATT BLI\r\nDEBITERADE EN STRAFFAVGIFT F\u00d6R NY-UTSKRIFT P\u00c5 EURO40/GBP40.(varje\r\nboardingkort m\u00e5ste vara utskrivet och presenteras p\u00e5 individuella A4-ark).**\r\n**\r\n\r\nDu kan checka in via Internet fr\u00e5n 15 dagar fram till 4 timmar innan\r\nflygets schemalagda avg\u00e5ng.****\r\n\r\nRESEPLAN/KVITTO \u2013 alla tider \u00e4r lokala.****\r\n\r\nUTRESA****\r\n\r\nFr\u00e5n Milano (Bergamo) (BGY) till Stockholm Skavsta (NYO)\r\nSat, 14Aug10 Flyg FR1944 Avg\u00e5ng BGY kl 21:00 och ankomst NYO kl 23:30****\r\n\r\nPASSAGERARE****\r\n\r\n 
```

而且，我需要在“UTRESA”和“PASSAGERARE”之间提取数据。所以我尝试了这个：

```
re.search(r'UTRESA (.+)PASSAGERARE',x) 
```

出于某种原因，它没有提取数据！你们能否向我解释为什么我不提取数据以及解决方案？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-25T21:01:52.900

匹配换行符时需要使用该[`DOTALL`标志：](http://docs.python.org/library/re.html#re.DOTALL)

```
re.search(r'UTRESA(.+)PASSAGERARE', x, re.DOTALL) 
```

UTRESA 之后没有空格。

演示：

```
>>> re.search(r'UTRESA(.+)PASSAGERARE', x, re.DOTALL).groups()
('****\r\n\r\nFr\\u00e5n Milano (Bergamo) (BGY) till Stockholm Skavsta (NYO)\r\nSat, 14Aug10 Flyg FR1944 Avg\\u00e5ng BGY kl 21:00 och ankomst NYO kl 23:30****\r\n\r\n',) 
```

# php - 这段 PHP 代码显示使用应用程序的用户朋友列表有什么问题？

> ID：12125612
> 
> 赞同：0
> 
> 时间：2012-08-25T21:00:42.900
> 
> 标签：php, facebook, json, facebook-graph-api

这是不起作用的代码。我想显示当前用户也使用我的应用程序的朋友的列表。我可以通过在浏览器中键入变量 $url 并将访问令牌变量替换为页面上打印的访问令牌来手动获取 JSON 文件。出于安全原因，我删除了一些细节。

```
<?php
require 'fb/facebook.php';

$fbconfig['appUrl'] = "REMOVED_FOR_SECURITY"; 

// Create An instance of our Facebook Application.
$facebook = new Facebook(array(
  'appId'  => 'REMOVED_FOR_SECURITY',
  'secret' => 'REMOVED_FOR_SECURITY',
  'cookies' => 'true',
));

// Get the app User ID
$user = $facebook->getUser();
$access_token = $facebook->getAccessToken();

if ($user) {
    try {
        // If the user has been authenticated then proceed
        $user_profile = $facebook->api('/me');
    } catch (FacebookApiException $e) {
        error_log($e);
        $user = null;
    }
}

// If the user is authenticated then generate the variable for the logout URL
if ($user) {
  $logoutUrl = $facebook->getLogoutUrl();

?>
<html>
<head>
<title>Friend's JSON</title>
</head>
<body>
<?php
echo $user_profile['name'] . " is connected.";
echo "<br />Access token: " . $access_token;

$url = "https://graph.facebook.com/fql?q=SELECT name, uid FROM user WHERE is_app_user=REMOVED_FOR_SECURITY and uid IN (SELECT uid2 FROM friend WHERE uid1 = me())&access_token=" . $access_token;
$json = file_get_contents($url,0,null,null);
$array = json_decode($json, true);
echo $array['data']['name'];
echo $array['data']['uid'];
?>
</body>
</html>
<?php  
} else {
  $loginUrl = $facebook->getLoginUrl(array('redirect_uri' => $fbconfig['appUrl']));
  print "<script type='text/javascript'>top.location.href = '$loginUrl';</script>";
}
?> 
```

这两行就是显示的全部内容：

```
echo $user_profile['name'] . " is connected.";
echo "<br />Access token: " . $access_token; 
```

为什么你认为它不起作用？任何帮助，将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T10:57:55.647

这是我用来列出使用该应用程序的用户朋友的代码：

```
$facebook->api(array('method' => 'fql.query', 'query' => "SELECT uid FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1=me()) AND is_app_user = 1")); 
```

`var_dump`返回：

```
array(5) {
  [0]=>
  array(1) {
    ["uid"]=>
    string(15) "100000670846118"
  }
  [1]=>
  array(1) {
    ["uid"]=>
    string(15) "100001811974704"
  }
  …
} 
```

# c++ - MSVC：手动使用 link.exe

> ID：12125613
> 
> 赞同：4
> 
> 时间：2012-08-25T21:00:45.183
> 
> 标签：c++, visual-c++, linker

我正在尝试使用测试 C++ OpenGL/SDL 项目设置名为 Waf 的构建系统，并且在链接过程中遇到了一些问题。据我所知，所有库都已正确找到，并已添加到链接命令中，但链接过程似乎就像未链接库一样。

为了尝试调试该过程，我试图手动运行编译/链接过程，以准确了解它如何与 MSVC 一起工作，但我仍然遇到问题。当我运行以下 LINK.exe 命令时：

```
PS C:\Users\covertcj\Documents\projects\test> & "C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\BIN\amd64\LINK.exe"
/NOLOGO /MANIFEST /SUBSYSTEM:CONSOLE /MACHINE:x64 /VERBOSE
.\build\src\main.cpp.1.o 
/OUT:.\build\test.exe
/LIBPATH:C:\Users\covertcj\Documents\projects\test\lib /LIBPATH:"C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\lib\amd64" /LIBPATH:"C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\lib" /LIBPATH:"C:\Program Files (x86)\Windows Kits\8.0\Lib\win8\um\x64" 
opengl32.lib sdl.lib sdlmain.lib 
```

我得到和往常一样的错误：

```
main.cpp.1.o : error LNK2019: unresolved external symbol SDL_CreateWindow referenced in function SDL_main
main.cpp.1.o : error LNK2019: unresolved external symbol SDL_DestroyWindow referenced in function SDL_main
main.cpp.1.o : error LNK2019: unresolved external symbol SDL_GL_CreateContext referenced in function SDL_main
main.cpp.1.o : error LNK2019: unresolved external symbol SDL_GL_SwapWindow referenced in function SDL_main
main.cpp.1.o : error LNK2019: unresolved external symbol SDL_GL_DeleteContext referenced in function SDL_main
main.cpp.1.o : error LNK2019: unresolved external symbol SDL_PollEvent referenced in function SDL_main
main.cpp.1.o : error LNK2019: unresolved external symbol SDL_Delay referenced in function SDL_main
main.cpp.1.o : error LNK2019: unresolved external symbol SDL_Init referenced in function SDL_main
main.cpp.1.o : error LNK2019: unresolved external symbol SDL_Quit referenced in function SDL_main
LIBCMT.lib(crt0.obj) : error LNK2019: unresolved external symbol main referenced in function __tmainCRTStartup 
```

但是，我也得到了一些有趣的详细输出：

```
Searching libraries
    Searching C:\Program Files (x86)\Windows Kits\8.0\Lib\win8\um\x64\opengl32.lib:
    Searching C:\Users\covertcj\Documents\projects\dungeonhg\lib\sdl.lib:
    Searching C:\Users\covertcj\Documents\projects\dungeonhg\lib\sdlmain.lib:
    Searching C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\lib\amd64\LIBCMT.lib:
      Found _load_config_used
        Loaded LIBCMT.lib(loadcfg.obj)
    Searching C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\lib\amd64\OLDNAMES.lib:
    Searching C:\Program Files (x86)\Windows Kits\8.0\Lib\win8\um\x64\kernel32.lib:

Finished searching libraries

Unused libraries:
  C:\Users\covertcj\Documents\projects\dungeonhg\lib\sdl.lib
  C:\Users\covertcj\Documents\projects\dungeonhg\lib\sdlmain.lib
  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\lib\amd64\OLDNAMES.lib 
```

但是，我的代码绝对使用 SDL 和 SDLmain：

主文件

```
#include <SDL2/SDL.h>
#include <SDL2/SDL_opengl.h>

int main(int argc, char *argv[]) {

  SDL_Init(SDL_INIT_VIDEO); // Init SDL2

  // Create a window. Window mode MUST include SDL_WINDOW_OPENGL for use with OpenGL.
  SDL_Window *window = SDL_CreateWindow(
    "SDL2/OpenGL Demo", SDL_WINDOWPOS_UNDEFINED, SDL_WINDOWPOS_UNDEFINED, 640, 480, SDL_WINDOW_OPENGL|SDL_WINDOW_RESIZABLE
  );

... 
```

有人知道我在这里做错了什么吗？

编辑：我还验证了相同的 waf 脚本适用于 linux 和 osx，所以它似乎是特定于 windows 的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T22:42:08.800

我认为你的主要问题是

```
error LNK2019: unresolved external symbol main referenced in function __tmainCRTStartup 
```

这可能是其他一切都取决于的一个错误。如果我不得不猜测，我将不得不假设您忘记添加“主要”功能......虽然显然您没有，因为我可以在您的帖子中清楚地看到它。

# ios - 用于压缩 JPEG 的 UIKit 与 ImageMagick

> ID：12125614
> 
> 赞同：1
> 
> 时间：2012-08-25T21:00:46.487
> 
> 标签：ios, image-processing, uikit, imagemagick, jpeg

我正在考虑切换到 ImageMagick 以在我的 iOS 应用程序上获得更好的 jpeg 压缩性能。当我说性能时，我的意思是相同数量的质量设置更好的图像，并且可能在文件大小方面更小图像。有没有人有任何比较这两者的经验，这是一个值得的练习吗？样品？

UIKit JPEG 的东西不是很好，图像尺寸仍然很大。我也找不到可以在 iOS 上使用的任何其他库。任何智慧都值得赞赏。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T00:47:53.087

它是影响图像大小和质量之间权衡的 JPEG 标准 - 它与执行它的框架字或应用程序无关。因此，如果您在 iOS 上使用某些“质量”设置压缩 JPEG，则如果您使用 ImageMagik，图像大小将相同。也就是说，一个问题是Apple使用了与libjpg不同的“质量”尺度。

但是，最后，如果您使用 Preview、iOS、ImageMagick 将质量降低到某个较低的数字，并且看起来有些像素化，那么文件大小将是相同的。这就是 JPEG 标准的工作原理。

# events - java中的特殊右键单击事件

> ID：12125615
> 
> 赞同：0
> 
> 时间：2012-08-25T21:01:04.493
> 
> 标签：events, menu, popup, click, jtextfield

所以，这里是这样的场景：我在一个框架中有一个基本的 JTextField，并希望给用户选项，右键单击文本字段，然后像在 Eclipse 或 Microsoft Word 中一样，在弹出菜单中给他复制的选项他已经创建的文本或粘贴文本。如何制作这种特殊的右键单击事件？

这是该程序的简短版本，我到目前为止：

```
import java.awt.*;
import javax.swing.*;

public class TestClass extends JFrame{

    private JFrame frame;
    private JTextField textField;

    /**
     * Main method
     * @param args
     */
    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {
            public void run() {
                try {
                    TestClass window = new TestClass();
                    window.frame.setVisible(true);
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        });
    }

    /**
     * Create the window
     */
    public TestClass() {
        initialize();
    }

    /**
     * Initialize components (TextField)
     */
    private void initialize() {
        frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setBounds(100, 100, 200, 100);

        textField = new JTextField();
        textField.setText("TextField");
        textField.setFont(new Font("Arial", Font.PLAIN, 20));
        frame.add(textField);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T11:29:42.350

您应该使用鼠标事件为您注册一个事件，然后您必须使用一个弹出菜单来在您单击时弹出到目前为止这里是一个示例代码！

```
 privatevoidformMouseClicked(java.awt.event.MouseEventevt){                                  

              if (evt.isPopupTrigger()){
                  pop.show(evt.getComponent(),evt.getX(), evt.getY());
              }

          } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-28T06:00:28.287

```
 private void textfiledMousePressed(java.awt. event.MouseEvent evt) {

           if (evt.getModifiers() == MouseEvent.BUTTON3_MASK){

           p.show(evt.getComponent(), evt.getX(), evt.getY());

           } 

            } 
```

这也可以通过右键单击来完成

# c# - 正确的 Windows 窗体多屏幕程序

> ID：12125621
> 
> 赞同：0
> 
> 时间：2012-08-25T21:02:11.633
> 
> 标签：c#, winforms, user-interface, windows-forms-designer

我正在尝试为处理我们工资单的员工构建一个相当简单的 Windows 应用程序（目前它是一个 vbscript/终端组合）。大部分逻辑都已解决，但我试图找出构建具有多个屏幕（登录/等）的 Windows 窗体应用程序的最佳方法。我一直在`TabControl`为此使用容器，但只是不确定这是否正确......或“常见”。

如果这是通常所做的，选项卡的内容通常由`User Control`对象组成，还是只是在选项卡上填充了不同的布局？

我怀疑我在编码方面需要很多帮助，但更多的是“如何 gui”通常在视觉设计师中布置。

编辑：只是为了提供我需要构建的屏幕的基础。我目前正计划有一个登录屏幕和三个屏幕，引导用户处理两种不同类型的工资单，然后某些应收账款工作。主要我将有两种用户类型。处理工资单的和处理应收账款的工作。我想让它易于扩展，这样当我构建更多功能时，添加屏幕并限制谁可以看到它们并不是什么大问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T21:32:56.177

我最终做的是删除问题中暗示的“登录屏幕”。我最终不再需要登录屏幕和相应的逻辑，而是与我们的 Active Directory 服务器进行了集成。

完成此集成后，我只需将屏幕设计为`UserControl`元素，然后根据用户是否在特定组中将每个屏幕添加到选项卡中。

这样做解决了我对包含逻辑的沉重主表单的主要担忧。现在主窗体中唯一的逻辑是是否添加基于 Active Directory 组的选项卡。

# r - 缩放文本标签以绘制 r 中的特征

> ID：12125628
> 
> 赞同：0
> 
> 时间：2012-08-25T21:02:34.300
> 
> 标签：r, text, plot, label

我有以下情节：

```
xleft<-c(1,2,2.5)
xright<-c(2,2.5,2.75)
ybottom<-c(1,2,2.5)
ytop<-c(2,2.5,2.75)

par(mar = c(15,15,2.75,2.75) + 0.1)
plot(c(1,2.75),c(1,2.75),type="n",main="title",xlab="site.x",ylab="ylab")
rect(xleft,ybottom,xright,ytop,col=c("blue","red","green"))

#Label position along  axes
x.label.position<-(xleft+xright)/2
y.label.position<-(ybottom+ytop)/2

#Labels
x.label<-c("Long species Name1","Long species Name2","Long species Name3")
y.label<-c("Long species Name4","Long species Name5","Long species Name5")

text(par()$usr[1]-0.5,y.label.position,y.label,xpd=TRUE,adj=1)
text(y=par()$usr[3]-0.5,x=x.label.position,x.label,xpd=TRUE,adj=1,srt=90)

par(xpd=TRUE)
legend(-0.1,0,legend=c("Species A","Species B","Species C"),fill=c("blue", "red", "green")) 
```

![在此处输入图像描述](../Images/5681ca337821ffcba76f595abe100319.png)

实际上看起来更像这样：

![在此处输入图像描述](../Images/8b6173d393f1fe6909d2b6deb19e5f2e.png)

有没有办法将文本标签缩放到它们所代表的正方形的宽度？谢谢你的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T01:32:00.900

您可以使用`cex`或其变体调整大小（取决于您添加文本的方式），请参阅`?par`变体和详细信息。但是对于小的，它们可能是不可读的（正如评论已经指出的那样）。

另一种方法是包中的`spread.labs`功能`TeachingDemos`。

# c# - 如何编写通用方法来复制所有继承自同一个抽象基类的类的实例？

> ID：12125629
> 
> 赞同：0
> 
> 时间：2012-08-25T21:02:52.027
> 
> 标签：c#, silverlight-4.0

我想按照以下代码将一个画笔实例的详细信息复制到一个新实例：

```
private static Brush CopyBrush(Brush b)
        {
            Brush b1 = new Brush();

            // code to copy settings from b to b1

            return b1;
        } 
```

我的困难是 Brush 是一个抽象类，所以我无法实例化它。我有许多从 Brush 继承的不同类，我可以将它们中的任何一个传递给这个方法。继承类都在 Brush 中使用相同的属性，因此复制它们不是问题。可以在调用源将返回值强制转换回继承类型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T21:12:08.930

如果您的所有派生类都保证有一个具有特定签名的构造函数，例如没有任何参数，您可以根据其`Type`实例实例化相应的子类型：

```
Brush b1 = (Brush)Activator.CreateInstance(b.GetType()); 
```

如果不能保证，则需要在类中引入虚拟方法`Brush`来创建当前类的新实例。子类可以覆盖它以调用合适的构造函数。

更具体地说，您的`Brush`类可以具有以下方法：

```
protected virtual Brush CreateBrushInstance()
{
    return (Brush)Activator.CreateInstance(GetType());
} 
```

在任何需要不同构造函数参数的派生类中，重写此方法并使用适当的参数值调用该[`Activator.Create(Type, object[])`方法。](http://msdn.microsoft.com/en-us/library/wcxyzt4d%28v=vs.95%29.aspx)

*（这假定这`CopyBrush`是`Brush`该类的一个方法。否则，使用该方法`internal`或`public`该方法的可见性`CreateBrushInstance`。）*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T21:12:45.220

**情况 1：**您的所有`Brush`派生类都有一个公共默认构造函数，并且所有属性都有公共设置器。

在这种情况下，一个通用方法就足够了：

```
static TBrush Copy<TBrush>(this TBrush brush) where TBrush : Brush, new()
{
    return new TBrush() // <- possible due to the `new()` constraint ^^^
           {
               TypeOfHair = brush.TypeOfHair,
               NumberOfHairs = brush.NumberOfHairs,
               …
           };
} 
```

* * *

**案例二：**不满足以上一项或多项前提条件；即没有公共默认构造函数，或者至少一个属性不可公开设置。

您可以使用此模式：

```
abstract class Brush
{
    protected abstract Brush PrepareCopy();
    // replacement for public default ctor; prepares a copy of the derived brush
    // where all private members have been copied into the new, returned instance.

    public Brush Copy()
    {
        // (1) let the derived class prepare a copy of itself with all inaccessible
        //     members copied:
        Brush copy = PrepareCopy();

        // (2) let's copy the remaining publicly settable properties:
        copy.TypeOfHair = this.TypeOfHair;
        copy.NumberOfHairs = this.NumberOfHairs;

        return copy;
    } 
}

sealed class FooBrush : Brush
{
    public FooBrush(int somethingPrivate)
    {
        this.somethingPrivate = somethingPrivate;
        // might initialise other members here…
    }

    private readonly int somethingPrivate;

    protected override Brush PrepareCopy()
    {
        return new FooBrush(somethingPrivate);
    }
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-25T21:06:29.733

尝试克隆方法

[http://msdn.microsoft.com/fr-fr/library/system.drawing.brush.clone%28v=vs.90%29.aspx](http://msdn.microsoft.com/fr-fr/library/system.drawing.brush.clone%28v=vs.90%29.aspx)

# php - 即时添加mysql列

> ID：12125631
> 
> 赞同：1
> 
> 时间：2012-08-25T21:02:59.847
> 
> 标签：php, mysql

当我尝试插入一行时，有没有办法即时添加 mysql 列？

例如，表包含 A、B、C 列，我想在表中插入包含 A、C、D 和 F 的行？

有没有办法实际添加 D 和 F 列而不是导致错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T21:24:46.340

谢谢 GlaciesofPacis 和 Adev

你让我对我提出的问题有了不同的看法，看起来你的解决方案比我最初想的要优雅得多。

我将使用 ID、Key、Value 模型，而不是使用很少行和超过 100 列的表。

谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T21:07:50.323

您可以使用`Alter`and`ADD`向表中添加新列。

例如;

```
ALTER TABLE contacts ADD email VARCHAR(60); 
```

将在表中添加一个名为`email`if的新列。`Varchar``contacts`

当然，在插入行之前，您必须检查要添加哪些列，添加它们然后插入新行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T21:16:11.500

您可以使用 ALTER TABLE 并为其提供您需要的任何查询，例如

```
ALTER TABLE TABLE_NAME
ADD COLUMN_NAME (ATTRIBUTE) 
```

希望这对你有帮助

# c++ - 我可以在 C++ 中定义枚举的大小吗？

> ID：12125637
> 
> 赞同：24
> 
> 时间：2012-08-25T21:03:35.207
> 
> 标签：c++

据我所知（从我在 cpp 编程语言中读到的内容），大小将是“一些可以保持其范围且不大于 sizeof(int) 的整数类型的大小，除非枚举数不能表示为int 或作为无符号整数”。

但是有可能以某种方式定义大小吗？例如，我想使用一个枚举，其 sizeof 是自然字的大小（通常是无符号长整数）。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-08-25T21:06:23.853

您可以在 C++11 中：

```
enum /*class*/ MyEnum : unsigned long
{
    Val1,
    Val2
}; 
```

（您可以为 old-style`enum`或 new-style指定枚举的大小`enum class`。）

您还可以通过有趣的技巧来增加枚举的最小大小，利用您引用的句子的最后一个短语：

```
enum MyEnum
{
    Val1,
    Val2,
    ForceSize = 0xFFFFFFFF // do not use
}; 
```

…这将确保枚举至少是 32 位的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-25T21:06:25.800

在 C++11 中，您可以使用枚举类，您可以在其中指定基础类型。在 C++03 中没有解决方案。

# ios - 如何找到对象数据集的 numberOfRowsInSection

> ID：12125643
> 
> 赞同：0
> 
> 时间：2012-08-25T21:04:22.727
> 
> 标签：ios, xcode, uitableview

下面是一个代码，接近尾声，我试图找出计算部分行数的方法

NS 对象定义
//DataDefinition.h #import

```
@interface DataDefinition : NSObject
@property (nonatomic, retain) NSString *dataHeader;
@property (nonatomic, retain) NSMutableArray *dataDetails;

@end 
```

显示标题部分 //DataDisplay.h #import

```
#import "DataDefinition.h"

@interface DataDisplay : UITableViewController
@property (read write) NSInteger RowsCount;
@property (strong, nonatomic) NSMutableArray *dataSet;
@property (strong, atomic) DataDefinition *individualData;

@end 
```

显示实施部分

```
//DataDisplay.m

 @interface DataDisplay ()
 @end

 @implementation DataDisplay
 @synthesize RowsCount;
 @synthesize dataSet;
 @synthesize individualData;

- (void)viewDidLoad
{

    [super viewDidLoad];

    individualData.dataHeader  = @"Header1";
    individualData.dataDetails = [[NSMutableArray alloc] initWithObjects:@"Header1-Detail1", @"Header1-Detail2", @"Header1-Detail3", nil];
    RowsCount = [individualData.dataDetails count];
    [dataSet addObject:individualData];
    .
    .
    . 
    [dataSet addObject:individualData];   

    self.title = @"DataDisplay";
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    // Return the number of sections.
    return [dataSet count];
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    // Return the number of rows in sections.
    return ?????
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T21:16:24.883

首先，如果数据集中没有要显示的部分，则不必实现此方法。否则，您需要将数据存储在 NSMutableArray 中，这将是一个数组数组：这基本上将存储每个部分的内容。

然后，您可以想象以这种方式访问​​每个部分的项目数量：

> [[self.yourarray objectAtIndex:section] count];

**编辑**

根据您的源代码和讨论，您的代码应该是：

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    // Return the number of rows in sections.
    return [((DataDefinition*)[self.dataSet objectAtIndex:section]).dataDetails count] 
} 
```

# android - Intent.FLAG_ACTIVITY_CLEAR_TOP 未关闭 android 堆栈中的所有活动

> ID：12125644
> 
> 赞同：2
> 
> 时间：2012-08-25T21:04:27.640
> 
> 标签：android

我想在进行新活动之前关闭堆栈中的所有活动。

这是我的代码

```
Intent i=new Intent(first.this,secondsct.class);
                        i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                        //i.addFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP);
                        //i.addFlags(Intent.FLAG_ACTIVITY_NO_HISTORY);
                        //i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                        startActivity(i);
                        finish(); 
```

但这不起作用。我之前尝试过，但现在没有。我不知道为什么。谁能知道可能是什么原因。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-04-08T05:17:07.643

我已经尝试过 Intent.FLAG_ACTIVITY_CLEAR_TOP 但没有得到适当的解决方案所以最后这对我有帮助

```
Intent intent = new Intent(getApplicationContext(), LoginActivity.class);
ComponentName cn = intent.getComponent();
Intent mainIntent = IntentCompat.makeRestartActivityTask(cn);
startActivity(mainIntent); 
```

这将清除所有堆栈并仅运行 LoginActivity

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T22:13:13.810

您可以尝试`FLAG_ACTIVITY_CLEAR_TOP` 与`FLAG_ACTIVITY_NEW_TASK`.

```
i.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TOP) 
```

> [http://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_CLEAR_TOP](http://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_CLEAR_TOP)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-08T05:23:58.397

每当你想退出时使用这个功能。希望这能解决你的问题

```
 public void exit()
    {
         Intent intent = new Intent(Intent.ACTION_MAIN);
         intent.addCategory(Intent.CATEGORY_HOME);
         intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
         startActivity(intent);
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-22T09:41:03.663

我还尝试了所有可能的标志，并且`finish()`像您一样调用该方法。但我找到了一种更好的方法来结束所有以前的活动，`finishAffinity()`而是使用方法。

在第三个答案中提出了此解决方案[。](https://stackoverflow.com/questions/6330260/finish-all-previous-activities)它解决了我的问题。希望它能解决你的问题。

# sublimetext2 - 在 Sublime Text 2 中如何查看回车和换行？

> ID：12125645
> 
> 赞同：51
> 
> 时间：2012-08-25T21:04:32.537
> 
> 标签：sublimetext2, eol

在notepad++中有一个工具栏按钮可以打开/关闭EOL字符的显示，即回车和换行。

Sublime Text 2 可以做类似的事情吗？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2016-11-22T00:52:43.303

万一几年后有人在这里，我发现崇高的包[RawLineEdit](https://packagecontrol.io/packages/RawLineEdit)取得了成功。

1.  使用[包控制安装](https://packagecontrol.io/)
2.  进入`Raw Line Edit: Toggle`命令面板（通过`Ctrl`++ `Shift`）`P`

更多功能文档可以在[用户指南](http://facelessuser.github.io/RawLineEdit/usage/#user-guide)中找到。
**请注意，此包仅在 Sublime Text 3 中受支持。**

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2012-08-25T22:20:35.493

Sublime Text 目前不支持显示 EOL 字符。

[http://sublimetext.userecho.com/topic/104394-is-it-possible-to-show-all-characters-spaces-tabs-cr-lf-etc/](http://sublimetext.userecho.com/topic/104394-is-it-possible-to-show-all-characters-spaces-tabs-cr-lf-etc/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-05-04T08:53:54.983

有一个快速的解决方法，在搜索中，启用`Regular expression`和搜索值使用`\n`。您将看到所有换行符都突出显示。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-05-29T00:32:58.423

# 05 2021

这可能对 OP 问题没有真正的帮助，而且这个问题已经 8 岁了，我假设他一定很早就得到了答案。

这是任何仍在寻找答案以在 Sublime 文本 3 中显示回车的人。

**截至 2021 年 5 月，当前版本为 3.2.2**

@Sam YC 答案的详细版

## 在 Sublime text 3 中测试

1.  按`Ctrl`+ `F` *(Windows)*
2.  选择第一个框“正则表达式 (Alt+R)”
3.  还选择“突出显示匹配” *（最后一个带有纯边框的框）*
4.  进入`\n`

[![在此处输入图像描述](../Images/53a76333d479c53e1f4bd699881de94f.png)](https://i.stack.imgur.com/XTjla.jpg)

5.  你应该看到这样的东西。如果您没有看到任何内容，只需切换“突出显示匹配项”。

[![在此处输入图像描述](../Images/52daf495c4f13159f85823b927402edf.png)](https://i.stack.imgur.com/wyyfy.jpg)

* * *

## 回答 #5

> 赞同：-13
> 
> 时间：2015-07-22T05:40:17.543

还有另一种方法可以实现这一点。

转到首选项-> 选择“设置-用户”

在打开的文件中粘贴此命令。

“ensure_newline_at_eof_on_save”：真

# javascript - 如果 JavaScript 需要语句帮助

> ID：12125646
> 
> 赞同：0
> 
> 时间：2012-08-25T21:04:33.927
> 
> 标签：javascript, jquery, html, if-statement, autocomplete

我正在使用自动完成，其中搜索的每个变量都有 3 个属性（标签、id、值）。我希望根据该选择的 id 将用户选择的值传递给四个隐藏字段之一。

js文件

```
var destinations= [
        {value: "25",label: "USA",id: "1"},
        {value: "26",label: "Midwest",id: "2"},
        {value: "27",label: "Colorado",id: "3"},
        {value: "28",label: "Denver",id: "4"}
        ];

$(document).ready(function() {
    $( "#destinations" ).autocomplete({
        minLength: 1,
        source: destinations,

        select: function( event, ui ) {
            $('#destinations').val( ui.item.label );
            $('#destinationid').val(ui.item.id);
            $('#destinationtype').val(ui.item.value);
            if ($("#destinationid").val() == 1){
            $("#results1").text($('#type1').val());
        }
        if ($("#destinationid").val() == 2){
            $("#results2").text($('#type2').val());
        }
        if ($("#destinationid").val() == 3){
            $("#results3").text($('#type3').val());
        }
        if ($("#destinationid").val() == 4){
            $("#results4").text($('#type4').val());
        }
    },

        focus: function( event, ui ) {
            $("#destinations").val( ui.item.label );
            return false;
        }
    });

}); 
```

在我的 html 中，我有以下内容：（出于测试目的，我没有隐藏它们。）

```
<input id="destinations" /> 
<input type="hidden" input id="type1" /> 
<input type="hidden" input id="type2" />
<input type="hidden" input id="type3" />
<input type="hidden" input id="type4" /> 
```

自动选择很好地拉动标签，但是当我选择一个时，它会将选择更改为其值而不是保留标签。它也没有将值放在相应的文本框中，而只是将值留在第一个文本框中。

任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T21:16:39.600

```
var destinations= [
        {value: "25",label: "USA",id: "1"},
        {value: "26",label: "Midwest",id: "2"},
        {value: "27",label: "Colorado",id: "3"},
        {value: "28",label: "Denver",id: "4"}
        ];

$(document).ready(function() {
    $( "#destinations" ).autocomplete({
        minLength: 1,
        source: destinations,

        select: function( event, ui ) {
                $('#destinations').val( ui.item.label );
                var destinationId = u.item.id;
                $('#destinationvalue').val(ui.item.value);
                $('#type' + destinationId).val(ui.item.value);
        },

        focus: function( event, ui ) {
            $("#destinations").val( ui.item.label );
            return false;
        }
    });

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T22:50:19.830

从您的 select 语句中返回 false，否则 jquery UI 的默认选择将在您之后运行。

工作代码演示：http: [//jsfiddle.net/FCw9f/](http://jsfiddle.net/FCw9f/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T21:59:44.650

```
<input type="hidden" input id="type1" /> 
```

你的输入标签中有一个额外的“输入”......我不确定你的意思是它是故意用于测试还是什么，但这肯定会导致一些不需要的行为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-26T16:24:46.663

多亏杰森为我指出了正确的方向，我才能够弄清楚。它还不完美，但它正在做我想要的。[http://jsfiddle.net/pkracer/RADGs/](http://jsfiddle.net/pkracer/RADGs/)

# android - 我可以从 SmsManager 读取文件吗

> ID：12125648
> 
> 赞同：0
> 
> 时间：2012-08-25T21:04:38.670
> 
> 标签：android

我将文件复制+粘贴到`*.txt`文件夹`/frameworks/opt/telephony/src/java/android/telephony`中。现在我想从中读取它`SmsManager`，但是当我运行它时`"emulator + adb logcat"`它告诉我它找不到文件。

两个文件`SmsManager.java`都`textfile.txt`在同一个文件夹中。

我里面的代码`SmsManager`是：

```
try {

      FileInputStream fstream = new FileInputStream("textfile.txt");
      // Get the object of DataInputStream
      DataInputStream in = new DataInputStream(fstream);
      BufferedReader br = new BufferedReader(new InputStreamReader(in));           
          String line;

          // read every line of the file into the line-variable, on line at the time
          while (( line = br.readLine()) != null) {
              Log.i(TAG, line+"@@@@@@@@@@@@@@@@@@@@@@@@@@");
          }

         in.close();
      } catch (java.io.FileNotFoundException e) {
          Log.i(TAG, "File didnt found");
      } catch (java.io.IOException e) {
          Log.i(TAG, "File didnt found");
      } 
```

出了什么问题，或者我必须在哪里保存文件才能找到它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T21:33:27.703

您必须像下面这样修改 device.mk 才能从源代码复制到 Android 文件系统

```
PRODUCT_COPY_FILES := frameworks/abc.txt:system/abc.txt 
```

在您的代码中，您必须访问`/system/abc.txt`

# c++ - C 和 C++ 标准对位级整数表示和操作有什么看法？

> ID：12125650
> 
> 赞同：20
> 
> 时间：2012-08-25T21:04:46.377
> 
> 标签：c++, c, integer, language-lawyer, data-representation

我知道 C 和 C++ 标准没有规定数字的特定表示（可能是二进制补码、符号和大小等）。但是我不太了解标准（并且无法找到是否已说明），无法知道在使用位时是否有任何特定的限制/保证/保留表示。特别：

1.  如果整数类型中的所有位都为零，那么整个整数是否代表零？
2.  如果整数类型中的任何一位为 1，那么整数作为一个整体是否表示非零？（如果这是“是”，那么像符号和大小这样的一些表示将受到额外限制）
3.  是否有保证的方法来检查是否未设置任何位？
4.  是否有保证的方法来检查是否设置了任何位？（#3 和#4 取决于#1 和#2，因为我知道如何设置，例如某个变量中的第 5 位（参见 #5）`x`，我想检查一个变量`y`以查看它是否是第 5 位是 1，我想知道是否`if (x & y)`可行（因为据我了解，这取决于表示的值，而不是该位实际上是 1 还是 0））
5.  是否有保证的方法来设置最左边和/或最右边的位？（至少比采用 a所有位为`char c`真（由`c = c | ~c``c = c << (CHAR_BIT - 1)``c = c ^ (c << 1)`
6.  如果#1 的答案是“否”，如何遍历整数类型的位并检查每个位是 1 还是 0？

我想我的总体问题是：C 和 C++ 标准对位和整数是否有任何限制/保证/保留表示，尽管整数的表示不是强制性的（如果 C 和 C++ 标准在这方面有所不同，他们有什么区别）？

我在做作业时提出了这些问题，这需要我做一些操作（注意这些不是我作业中的问题，这些问题更加“抽象”）。

**编辑：**至于我所说的“位”，我的意思是“价值形成”位，不包括“填充”位。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-25T21:35:06.290

> **(1)**如果一个整数类型中的所有位都为零，那么整个整数是否代表零？

是的，由全零组成的位模式始终表示 0：

> 整数类型的表示应使用纯二进制计数系统定义值。^(49) **[§3.9.1/7]**
> 
> ^(49)整数的位置表示，使用二进制数字 0 和 1，其中由连续位表示的值是相加的，从 1 开始，并乘以 2 的连续整数幂，可能最高位置的位除外。

* * *

> **（2）**如果整数类型中的任何一位为1，那么整数作为一个整体是否表示非零？（如果这是“是”，那么像符号和大小这样的一些表示将受到额外限制）

不，事实上，有符号的幅度是特别允许的：

> [*示例：*本国际标准允许整数类型的 2 的补码、1 的补码和有符号幅度表示。*—结束示例*] **[§3.9.1/7]**

* * *

> **(3)**是否有保证的方法来检查是否未设置任何位？

如果您考虑签名类型，我*相信*这个答案是“不”。它等同于使用全 1 的位模式进行相等性测试，这只有在您有办法生成具有全 1 的位模式的有符号数时才有可能。对于无符号数，此表示是有保证的，但如果该数不可表示，则从无符号转换为有符号是未定义的：

> 如果目标类型是有符号的，则如果它可以在目标类型（和位域宽度）中表示，则该值不变；否则，该值是实现定义的。**[§4.7/3]**

* * *

> **(4)**是否有保证的方法来检查是否设置了任何位？

我不这么认为，因为有符号幅度是允许的——0 比较等于 -0。但是对于无符号数字应该是可能的。

* * *

> **(5)**是否有保证的方法来设置最左边和/或最右边的位？

同样，我相信无符号数字的答案是“是”，而有符号数字的答案是“否”。负符号数的移位未定义：

> 否则，如果`E1`有一个有符号类型和非负值，并且 E1 × 2 ^(E2)在结果类型中是可表示的，那么这就是结果值；否则，行为未定义。**[§5.8/2]**

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-25T21:42:59.257

您反复使用“所有位”一词，但没有说明您所指的“所有位”是什么。C/C++ 中整数类型的对象表示可能包括*值形成位*和*填充位*。唯一保证没有填充位的整数类型是`[signed/unsigned] char`.

该语言始终保证，如果所有*形成值的*位都为零，则表示的整数值也为零。

至于*填充*位，事情有点复杂。C 语言的原始规范（C89/90 以及原始 C99）不保证将所有对象位设置为零会产生有效的整数表示。它可能产生了无效的*陷阱*表示。即在原始 C 中（甚至最初在 C99 中）使用`memset(..., 0, ...)`整数类型并不能保证对象将接收有效的零值（除了`[signed/unsigned] char`）。这在后来的规范中有所改变，即在 C99 的技术勘误之一中。现在要求整数对象中的全零位模式（涉及所有位，包括填充位）表示有效的零值。

即在现代 C 中`memset(..., 0, ...)`，将任何整数对象设置为零是合法的，但它仅在 C99 之后才变得合法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-25T22:10:01.350

你已经得到了一些关于整数值表示的答案。只有一种方法可以保证为您提供内存中表示的任何对象的所有单独位：将其视为`unsigned char`. 这是唯一没有填充位并且保证没有陷阱表示的整数类型。因此，只要您只访问第一个字节，将类型指针转换`T*`为您的对象将始终有效。这样您就可以根据自己的喜好检查和设置所有字节（以及位）。`unsigned char*``sizeof(T)`

如果您对更多细节感兴趣，这里我已经写了一些关于C[中整数类型的剖析](http://gustedt.wordpress.com/2010/09/21/anatomy-of-integer-types-in-c/)。C++ 可能与此有所不同，特别是`union`所描述的类型处理似乎在 C++ 中没有得到很好的定义。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-25T21:36:59.540

> 问：如果整数类型中的任何一位为1，那么整数作为一个整体是否代表非零？（如果这是“是”，那么像符号和大小这样的一些表示将受到额外限制）

不，C 和 C++ 的标准不排除有符号幅度或反码，两者都有 +0 和 -0。虽然 +0 和 -0 必须比较相等，但它们不必具有相同的表示。

祝你现在找到一台使用有符号幅度或补码的机器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-19T14:44:18.357

如果你想让你的大脑爆炸，考虑一下：如果你将一个 int 或 long 或 long long 解释为一个 unsigned char 数组（如果你想查看所有位，这是最合理的做法），你知道未定义字节顺序，例如“bigendian”与“littleendian”。我们都（希望）知道这一点。

但更糟糕的是：int 的每个位都可以存储在char 数组的*任何*位中。所以有32个！如何通过真正奇怪的实现将 32 位整数的位映射到四个 8 位无符号字符的数组。幸运的是，我自己遇到的方法不止两种（而且我知道在真实计算机中还有另外一种排序方式）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-04T13:08:30.607

> 如果整数类型中的所有位都为零，那么整个整数是否代表零？

**编辑**：由于您现在已经澄清您不关心填充位，因此答案实际上是“是”。但我保留原件：

不一定，它可能是一个陷阱表示。见 C99 6.2.6.1：

*对于 unsigned char 以外的无符号整数类型，对象表示的位应分为两组：值位和填充位（后者不需要任何一个）*

填充位的存在允许所有 0 都是*陷阱表示*的可能性。（正如 Keith Thompson 在下面的评论中所指出的，最近的 C11 明确表明这种表示不是陷阱表示）。

和

*未指定任何填充位的值*

和

*44) 填充位的某些组合可能会产生陷阱表示*

如果您将问题限制为*值和符号*位，则答案是肯定的，因为 6.2.6.2：

*如果有 N 个值位，每个位应表示 1 和 2 N -1 之间的 2 的不同幂，以便该类型的对象应能够使用纯二进制表示表示从 0 到 2 N - 1 的值；这应称为值表示。*

和

*如果符号位为零，则不应影响结果值。*

> 如果整数类型中的任何一位为 1，那么整数作为一个整体是否表示非零？（如果这是“是”，那么像符号和大小这样的一些表示将受到额外限制）

不一定，实际上符号和大小在 6.2.6.2 中得到明确支持。

> 是否有保证的方法来检查是否未设置任何位？

如果您不关心填充和符号位，则可以与 0 进行比较，但这不适用于 1 的补码表示（这是允许的），因为所有位 0 和所有位 1 都表示值 0。

否则：您可以通过 an 读取每个字节的值`unsigned char *`，并将结果与​​ 0 进行比较：

*存储在无符号位域和无符号字符类型对象中的值应使用纯二进制表示法表示*

如果你想检查一个特定的*值*位，你可以使用 (1u << n) 构造一个合适的位掩码，但这并不一定会让你检查*符号*位。

> 是否有保证的方法来检查是否设置了任何位？

答案与上一个问题基本相同。

> 是否有保证的方法来设置最左边和/或最右边的位？

你的意思是最左边的*价值*位？您可以根据类型计算 INT_MAX 或 UINT_MAX 或等效项中的位，并使用它来构造一个值（通过`1 << n`）来 OR 原始值。

> 如果#1 的答案是“否”，如何遍历整数类型的位并检查每个位是 1 还是 0？

您可以使用重复左移的位掩码来执行此操作，但您只能通过这种方式检查*值*位，而不是*符号*位。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-08-25T21:14:28.453

对于位操作，您可以创建一个具有 8 个无符号位字段的结构，并让该结构的指针指向您的字符。通过这种方式，您可以轻松访问每一位。但是编译器可能会在引擎盖下进行屏蔽，所以我认为这对程序员来说只是一种更清洁的方式。您必须检查您的编译器在执行此操作时不会更改字段的顺序。

```
yourstruct* pChar=(yourstruct*)(&c)
pChar.Bit7=1; 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-08-25T21:15:02.530

让我警告这一点，我说的是一般的 C 和 C++（例如 C90 和更低版本，MS Visual C++ 等）：“最大的共同点”（相对于最新/最大的 cx11“标准”）。

问：如果整数类型中的所有位都为零，那么整个整数是否代表零？

答：是的

问：如果整数类型中的任何一位为1，那么整数作为一个整体是否代表非零？（如果这是“是”，那么像符号和大小这样的一些表示将受到额外限制）

答：是的。这包括符号位，用于有符号的 int。坦率地说，我不熟悉“大小”

问：是否有保证的方法来检查是否未设置任何位？

答：始终保证“与”位掩码。

问：是否有保证的方法来检查是否设置了任何位？

答：同样，始终保证“与”位掩码。

问：设置最左边和/或最右边的位是否有保证的方法？

答：我相信您应该始终为所有实现/所有架构提供一个“MAX_INT”来确定最左边的位。

我准备被烧死……但我相信以上是准确的。我希望它有所帮助。

恕我直言...

# jquery - 如何用它的值替换select的标签？

> ID：12125651
> 
> 赞同：0
> 
> 时间：2012-08-25T21:04:50.263
> 
> 标签：jquery, html

HTML：

```
<input type="radio" name="timeformat" id="timeformat-a" value="am/pm" checked="checked" /> <b>am/pm</b> 
<input type="radio" name="timeformat" id="timeformat-b" value="24 hours" /> <b>24 hours</b>
        <select id="default-start-time" class="select check-list">
             <option value="" label="--Select--">--Select--</option>
             <option value="00:00" label="12:00 AM">12:00 AM</option>
             <option value="00:30" label="12:30 AM">12:30 AM</option>
             <option value="01:00" label="01:00 AM">01:00 AM</option>
             <option value="01:30" label="01:30 AM">01:30 AM</option>
             <option value="02:00" label="02:00 AM" selected>02:00 AM</option>
             <option value="02:30" label="02:30 AM">02:30 AM</option>
        </select> 
```

当我选择 24 小时格式时，应显示选项值。

jQuery：

```
$("input[name='timeformat']").click(function() {
      if($(this).val()=='24 hours')
      {
         // code which replaces label with the option value       
      }
  }); 
```

jquery应该怎么看？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T21:17:11.410

根据所选值更改标签的状态将永久更改它。我们需要存储对每个我们想要在易于使用的东西内部切换的值的引用，因此我们使用`data`属性。

我不知道你是否可以访问 HTML，所以这里是 jQuery 来做我们需要的。

```
$('#default-start-time option').each(function(index,obj){
   $(obj).data('ampm', $(obj).prop('label'));
   $(obj).data('24hr', $(obj).val());
}); 
```

现在，在 click 函数中，我们可以根据选择的值在数据属性之间切换。

```
$("input[name='timeformat']").click(function() {
  if($(this).val()=='24 hours')
  {
      $('#default-start-time option').each(function(index,obj){
          $(obj).prop('label', $(obj).data('24hr'));
      });             
  }
  else
  {
      $('#default-start-time option').each(function(index,obj){
         $(obj).prop('label', $(obj).data('ampm'));
      });
  }
}); 
```

[这是完整的 jsFiddle。](http://jsfiddle.net/xK7Xs/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T21:21:15.353

如果元素中同时具有`label`属性和文本内容，则优先。`<option>``<label>`

您可以像这样将值复制到标签中：

```
$('#default-start-time option').attr('label', function() {
     return this.value;
}); 
```

同样，您可以将文本内容复制回标签中，如下所示：

```
$('#default-start-time option').attr('label', function() {
    return this.innerHTML;
}); 
```

见[http://jsfiddle.net/alnitak/cLuZa/](http://jsfiddle.net/alnitak/cLuZa/)

请注意（至少在 Chrome 中）两者都不会导致控件更改其当前显示的值。它们仅在您再次单击该`<select>`元素时出现。我还在努力...

**编辑**这是我的最终答案：

```
$("input[name='timeformat']").click(function() {
    var ampm = $(this).val() !== '24 hours';  // get mode
    var sel = $('#default-start-time')[0];    // get the <select> element

    $('option', sel).attr('label', function() {
        return ampm ? this.innerHTML : this.value;
    });

    sel.selectedIndex += 0;  // force refresh
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T21:54:38.717

我建议将 HTML 加倍并简化 JS：

HTML：

```
<input type="radio" name="timeformat" value="12" checked="checked" /> <b>am/pm</b> 
<input type="radio" name="timeformat" value="24" /> <b>24 hours</b>

<select id="format-12" class="">
     <option value="" selected>--Select--</option>
     <option value="12:00 AM">12:00 AM</option>
     <option value="12:30 AM">12:30 AM</option>
     <option value="01:00 AM">01:00 AM</option>
     <option value="01:30 AM">01:30 AM</option>
     <option value="04:00 PM">04:00 PM</option>
     <option value="05:30 PM">05:30 PM</option>
</select>
<select id="format-24" class="hide">
     <option value="" selected>--Select--</option>
     <option value="00:00">00:00</option>
     <option value="12:30">12:30</option>
     <option value="01:00">01:00</option>
     <option value="01:30">01:30</option>
     <option value="16:00">16:00</option>
     <option value="17:30">17:30</option>
</select> 
```

JS：

```
$("input[name='timeformat']").on('change', function(){
    $('select[id*=format-]').toggleClass('hide');
});​ 
```

CSS：

```
.hide { display: none; }​ 
```

演示：http: [//jsfiddle.net/9ELJj/](http://jsfiddle.net/9ELJj/)

# c++ - 循环列表的最简洁/有效的表达式？

> ID：12125654
> 
> 赞同：1
> 
> 时间：2012-08-25T21:05:08.127
> 
> 标签：c++, algorithm, list, modulo

在实际索引中转换“循环”索引的最简洁/有效的函数（在 C++ 中）是什么？

我的问题可以用下图说明： ![在此处输入图像描述](../Images/6519659136f46208b4ef3f334dfef055.png)

我有一个包含元素大小的真实列表（例如 C++ 向量）`size`（此处`A, B, C, D, E`）。为了模仿“循环”列表，我正在寻找一个函数来将输入索引（从`-inf`到`+inf`）转换为列表的实际索引。使用此功能和图像示例代码：

```
for(i=-10; i < 10; ++i) std::cout<<list[myFunction(i, list.size())]<<" "; 
```

将打印图像中显示的列表的 4 倍。

我目前的表达`myFunction`是：

```
inline int myFunction(const int i, const int size)
{
    return (i >= 0) ? (i%size) : ((size-((-i)%size))%size);
} 
```

你认为有一个更简单/简洁/有效的方式来写这个吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T21:16:01.977

有几种更简洁的方式来表示这一点。`i < 0`两者都涉及 if是`(i % size) + size`您要查找的数字这一事实。所以，你可以使用

```
inline int myFunction(const int i, const int size)
{
    int index = i % size;
    return (index<0) ? (index+size) : index;
} 
```

或者

```
inline int myFunction(const int i, const int size)
{
    return (((i%size)+size)%size);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T21:23:51.803

```
size_t myFunction (const int i, const size_t size)   
{
  return (i - (i<1)) % size;
} 
```

简洁，但不是很清楚，因为它利用了 bool/int 转换。我更喜欢符合 STL 的循环缓冲区（例如 boost 实现[http://www.boost.org/doc/libs/1_50_0/libs/circular_buffer/doc/circular_buffer.html](http://www.boost.org/doc/libs/1_50_0/libs/circular_buffer/doc/circular_buffer.html)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T22:03:27.657

我建议重载`[] operator`. 至于数学，请参阅@murgatroid99 的答案。

# android - 由于 deleteDatabase()，Robotium 测试失败

> ID：12125656
> 
> 赞同：1
> 
> 时间：2012-08-25T21:05:34.167
> 
> 标签：android, android-contentprovider, robotium

我已经重构了我的应用程序以使用 ContentProvider 和所有 CursorLoader 框架，但是自从我完成之后，我的所有测试都因数据库错误而失败，例如

java.lang.IllegalStateException：无法执行此操作，因为连接池已关闭。

但这些仅在机器人测试模式下发生。当我手动测试该应用程序时，它似乎可以工作。

我试图让我的测试正常工作的 2 天......</p>

数据库管理代码可在此处获得： [http ://code.google.com/p/radis/source/browse/#hg%2Fsrc%2Ffr%2Fgeobert%2Fradis%2Fdb](http://code.google.com/p/radis/source/browse/#hg%2Fsrc%2Ffr%2Fgeobert%2Fradis%2Fdb)

我的测试代码可在此处获得： [http ://code.google.com/p/radis/source/browse/?repo=robotium#hg%2Fsrc%2Ffr%2Fgeobert%2Fradis%2Frobotium](http://code.google.com/p/radis/source/browse/?repo=robotium#hg%2Fsrc%2Ffr%2Fgeobert%2Fradis%2Frobotium)

感谢您的帮助，这让我发疯了……</p>

# android - Android 视图在视觉上处于正常位置，但实际上 - 在 TranslateAnimation 之后的起始位置

> ID：12125658
> 
> 赞同：1
> 
> 时间：2012-08-25T21:05:54.643
> 
> 标签：android, android-animation, android-4.0-ice-cream-sandwich, android-4.2-jelly-bean

我有 3 个水平可拖动视图。例如，如果我第一个落在第二个上 - 第二个和第三个必须向右移动。初始位置： ![在此处输入图像描述](../Images/cb91ce8d571a6cb7d956c673fca52272.png)

编码：

```
case DragEvent.ACTION_DROP:
                targetIndex = ((ViewInfo) targetView.getTag()).index;
                int lastIndex = getChildCount() - 1;
                droppedView = (View) event.getLocalState();
                droppedIndex = ((ViewInfo) droppedView.getTag()).index;

                if (droppedView == this) {
                    return false;
                }

                for (int i = targetIndex; i <= lastIndex; i++) {
                    if (getChildAt(i) != droppedView) {
                        moveChildToRight(i);
                    }
                }

private void moveChildToRight(int index) {
            ....
            TranslateAnimation anim = new TranslateAnimation(0, 200, 0, 0);
            anim.setDuration(1000);
            anim.setFillAfter(true);
            anim.setAnimationListener(new AnimationListener() {

                @Override
                public void onAnimationEnd(Animation animation) {
                    Log.d(TAG, "Animation ended");
                    requestLayout();
                }

                @Override
                public void onAnimationRepeat(Animation arg0) {
                    // TODO Auto-generated method stub

                }

                @Override
                public void onAnimationStart(Animation arg0) {
                    // TODO Auto-generated method stub

                }

            });

            child.startAnimation(anim);
        } 
```

好的，放下第二个和第三个视图后向右移动： ![掉落后](../Images/62145f7181a84a81b78da2b790f779cc.png)

之后我长按到第 1 和第 2+3 视图之间的空白处，我看到了什么？开始第二个视图的拖动！但实际上它显示得比它可以触摸的更正确。第二或第三视图的“视觉”表示在动画后不可触摸： ![漏洞](../Images/18b67189db5711e679c453431b0df317.png)

为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-15T16:50:50.000

我意识到这已经有一年多了，但我会回答以防其他人找到该页面。

这就是翻译动画（查看动画）的工作原理。它在视觉上移动对象，但不会更新实际的 X/Y 属性。例如，如果您的视图是按钮，则在原始区域中触摸将显示单击按钮的视觉位置，但单击您看到按钮的位置将无济于事，因为实际按钮从未移动。

# c - 按字符读取 UTF-16 CSV 文件

> ID：12125659
> 
> 赞同：1
> 
> 时间：2012-08-25T21:06:07.550
> 
> 标签：c, csv, ascii, utf-16

目前我正在尝试逐字符读取 UTF-16 编码的 CSV 文件，并将每个字符转换为 ascii，以便我可以处理它。我稍后计划将处理后的数据改回 UTF-16，但这不是重点。

我马上就知道我做错了，因为我以前从未尝试过这样的事情：

```
int main(void)
{
    FILE *fp;
    int ch;
    if(!(fp = fopen("x.csv", "r"))) return 1;
    while(ch != EOF)
    {
        ch = fgetc(fp);
                ch = (wchar_t) ch;
                ch = (char) ch;
        printf("%c", ch);
    }
    fclose(fp);
    return 0;
} 
```

一厢情愿地想着，我希望出于某种原因能通过魔法发挥作用，但事实并非如此。如何读取 UTF-16 CSV 文件并将其转换为 ascii？我的猜测是，因为每个 utf-16 字符都是两个字节（我认为？）我将不得不一次从文件中读取两个字节到某个我不确定的数据类型的变量中。然后我想我将不得不检查这个变量的位以确保它是有效的 ascii 并从那里转换它？我不知道我会怎么做，任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T22:39:00.367

你应该使用[`fgetwc`](http://en.cppreference.com/w/c/io/fgetwc). 下面的代码应该在存在[byte-order mark](http://en.wikipedia.org/wiki/Byte_order_mark)和可用的 locale的情况下工作`en_US.UTF-16`。

```
#include <stdio.h>
#include <wchar.h>
#include <locale.h>

main() {
  setlocale(LC_ALL, "en_US.UTF-16"); 

  FILE *fp = fopen("x.csv", "rb");
  if (fp) {
    int order = fgetc(fp) == 0xFE;
    order = fgetc(fp) == 0xFF;

    wint_t ch;
    while ((ch = fgetwc(fp)) != WEOF) {
      putchar(order ? ch >> 8 : ch);
    }
    putchar('\n');

    fclose(fp);
    return 0;
  } else {
    perror("opening x.csv");
    return 1;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T21:29:25.337

由于我原来的问题下的评论，这是我的解决方案。由于 CSV 文件中的每个字符都是有效的 ascii，因此解决方案很简单：

```
int main(void)
{
    FILE *fp;
    int ch, i = 1;
    if(!(fp = fopen("x.csv", "r"))) return 1;
    while(ch != EOF)
    {
        ch = fgetc(fp);
        if(i % 2) //ch is valid ascii
        i++;
    }
    fclose(fp);

    return 0;
} 
```

# windows - 将窗口强制到一个 CPU 上，然后接管其余的

> ID：12125666
> 
> 赞同：0
> 
> 时间：2012-08-25T21:06:59.717
> 
> 标签：windows, operating-system, kernel

我见过各种采用这种策略的 RTOS，它们在一个或多个 CPU 上启动 Windows，然后在其余 CPU 上运行实时程序。知道如何实现吗？我可以让计算机启动两个 CPU，然后在其余 CPU 上停止执行吗？我应该开始查看哪些文档？我对 linux 内核有足够的经验，我可能能够弄清楚如何在 linux 下做到这一点，所以如果有任何东西可以很好地映射到 linux 上，你可以用它来描述它，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T21:31:49.553

您可以在比可用 CPU 更少的 CPU 上启动 Windows。运行`msconfig.exe`，转到`Boot`选项卡，单击`Advanced options...`按钮，选中该`number of processors`框并设置所需的数字（这是针对 Windows 7 的，Vista 和 XP 的确切位置可能略有不同）。

但这只是解决问题的一小部分。

您将需要实现一个特殊的内核模式驱动程序来启动那些其他 CPU（Windows 不会让您从非内核模式代码中执行此类操作）。而且您将需要为这些 CPU 和许多其他低级事物实现线程调度程序......您可能还想从 Windows 窃取一些物理内存 (RAM) 并实现内存管理器，这两个可能是一件很牵涉的事情。

读什么？Intel/AMD CPU 文档（特别是 APIC 部分）、来自 Intel 的 x86 多处理器规范、有关 Windows 驱动程序的书籍、Windows Internals 书籍、MSDN 等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T10:41:15.490

您不能在一个 CPU 上关闭 Windows 并期望像往常一样运行您的程序，因为系统调用由发出系统调用的线程所在的同一 CPU 提供服务。系统调用依赖于内核模式可访问的每线程数据来处理系统调用，因此任何线程（用户模式或内核模式）只能在 Windows 执行 CPU 的每核初始化时运行。

看起来你正在编写一个超级超级棒的应用程序，它确实需要运行，比如，超级快，你希望其他人都脱离核心，'因为然后，就像，你会完全是最快的，但您并没有真正意识到如果 Windows 不在您的核心上，那么您也不能在该核心上使用 Windows 的任何部分。

如果您确实想这样做，则必须作为引导驱动程序运行。引导驱动程序将能够保留其中一个内核在引导期间不被初始化，从而防止 Windows“看到”该内核。然后，您可以手动构建自己的执行线程以在该内核上运行，但您需要自己处理分页、内存分配、调度、NUMA、NMI 异常、页面错误和 ACPI 事件。如果没有蓝屏 Windows，您将无法从该内核调用 Windows。你会靠自己。

您可能想要做的是将线程锁定到单个处理器（通过 SetThreadAffinity），然后将线程的优先级提高到最大值。当您这样做时，Windows 仍在您的核心上运行以服务诸如页面错误和硬件中断之类的事情，但不会在该核心上运行较低优先级的用户模式线程（它们将全部移动到其他核心，除非它们也被锁定到您的处理器）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T10:33:54.583

我无法正确理解这个问题。但是，如果您要求将进程调度到内核，那么 linux 可以使用 set affinity 来完成此操作。关注此页面：

[http://www.kernel.org/doc/man-pages/online/pages/man2/sched_setaffinity.2.html](http://www.kernel.org/doc/man-pages/online/pages/man2/sched_setaffinity.2.html)

# maven - Maven - 如何构建依赖项目

> ID：12125668
> 
> 赞同：0
> 
> 时间：2012-08-25T21:07:34.457
> 
> 标签：maven, pom.xml

我有一个多模块项目。

*   Parent -> 有子模块 ProjectA 和 ProjectB
*   项目 A 依赖于项目 B 在构建期间生成的目标文件
*   项目 A 具有为 ProjectB 定义的依赖项

构建 ProjectA 时如何让 ProjectB 构建（我需要确保 ProjectB 正确构建并创建其 Jar）？

当我构建父项目时，所有项目构建都正确执行，但我希望所有 ProjectA 都单独构建（构建其依赖项 ProjectB）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T21:12:41.680

恐怕你不能那样做。您已经有一个聚合器项目，父项目，它构建 ProjectA 和 ProjectB。只有在 projectA 上调用 mvn 时，才能触发构建 projectB。如果可以，构建聚合器将构建 B，然后再构建 B，然后再构建 A。

# objective-c - 是什么导致此命令行错误？

> ID：12125673
> 
> 赞同：1
> 
> 时间：2012-08-25T21:08:16.787
> 
> 标签：objective-c, c, macos, cocoa, unix

我正在尝试以编程方式调用“top”命令。以下是使用的代码：

```
char buffer [128];
char* threadsPointer;
char* procPointer;
NSString* numberOfThreadsString;
NSString* numberOfProcString;
FILE* output = popen("/usr/bin/top", "r");

while (fgets(buffer, sizeof(buffer), output) != NULL)
{
    if ((procPointer = strstr(buffer, "Processes:")) != NULL)
    {
        procPointer += strlen("Proceses: ");
        strcpy(buffer, procPointer);
        numberOfProcString =  [NSString stringWithUTF8String: buffer];
    }

    if ((threadsPointer = strstr(buffer, "sleeping,")) != NULL)
    {
        threadsPointer += strlen("sleeping, ");
        strcpy(buffer, threadsPointer);
        numberOfThreadsString =  [NSString stringWithUTF8String: buffer];
    }
}

NSLog(@"Proc: %@\nThreads: %@\n\n\n", numberOfProcString, numberOfThreadsString); 
```

我没有提供有效的输出，而是不断收到错误消息：“错误打开终端：未知”。我推荐了整段代码来识别问题，并意识到它的行：`FILE* output = popen ("/usr/bin/top", "r");`那是导致错误的原因。

有谁知道我做错了什么？注意我在 Mountain Lion OS X 上为 OSX 而不是 iOS 构建应用程序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T21:15:43.700

`top`在 MacOSX 上要求其标准输出或标准错误连接到有效终端才能运行。当您在没有终端（或`$TERM`设置为有效终端名称的环境变量，如“vt100”）的情况下调用它时，它会给您错误：**打开终端时出错：未知**。

你真的不应该使用`top`它，因为它是一个需要终端的交互式程序。你应该只是使用`ps`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-25T21:52:29.020

你可以试试“top -l 1”。

“-l 1”表示 1 个样本，我认为它应该在非交互模式下运行 top，打印结果并退出。

在 linux 上，命令是“top -n 1”（“-n 1”意味着只运行 1 次迭代，这应该相当于 mac osx 上的“top -l 1”）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T00:14:48.600

如果您想要特定信息或所有详细信息，您应该使用“/proc”文件系统。

您可以 readdir() 和 fopen() 包含当前正在运行的进程的 /proc 中的所有文件并获取大量信息，例如某些进程打开了哪些文件，或者进程正在侦听哪些端口。

'top' 命令打开一个终端并等待用户输入。您将无法在自动化脚本中使用它

# php - 通过函数将 PHP 变量传递给 JavaScript

> ID：12125679
> 
> 赞同：0
> 
> 时间：2012-08-25T21:09:44.070
> 
> 标签：php, javascript, variables

我的数据库中的字段中有以下文本：

```
相应地研究项目要求和记录的规范
为 PDMS 管道和相关设备开发路由模型
为管道路线和结构的粗略和最终布局设计了 3D 插图
为复杂的管道结构创建高架支撑系统，以确保正常运行和安全
提供详细的制作图纸
对新的和现有的设计进行压力和功能测试
根据设计和安全标准升级现有布局和结构
准备好地块平面图和设备布置
开发等轴测图、总体布置图和支撑详图

```

我通过变量（即`$text`）将其从数据库中取出，然后通过 javascript 函数对其进行解析`function(text)`，以便将文本发布到表单 textarea 字段中进行编辑。

但是当我单击按钮运行该功能时，它什么也没做。如果文本较小，则可以正常工作。javascript 变量的字符是否有任何限制？

PHP代码：

```
<?
$var = mysql_fetch_row($query);
$text=$var['cool'];

echo "<a onclick=\"func($text)\">button</a>";
?>

<script>
function func(text) {   
        $('<div>cool: '+text+'</div>').fadeIn('slow').appendTo('.somediv');
}
</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T21:31:31.703

您需要对参数进行编码：

```
$text = htmlspecialchars(json_encode($var['cool'])); 
```

也就是说，从长远来看，其他解决方案可能会更好，因为元素已经在页面中的正确位置。这取决于你想用它做什么。

编辑：转义可能并不完美。请对其进行广泛测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T21:30:32.717

我会这样做：（因为 javascript 中的文本限制）

```
<?php
    $var = mysql_fetch_row($query);
    $text=$var['cool'];

    echo "<div id=\"hiddendiv\" style=\"display:none\">".$text."</div><a onclick=\"func()\">button</a>";
?>

<script type="text/javascript">
function func(text) {   
    $('#hiddendiv').fadeIn('slow').appendTo('.somediv');
}
</script> 
```

# css - 在容器 div 内定位固定大小的 div

> ID：12125683
> 
> 赞同：0
> 
> 时间：2012-08-25T21:10:09.667
> 
> 标签：css, html, positioning

所以我有一个固定大小的容器 div，以及固定大小的 div 进入该容器，但我正在寻找一种以某种方式对齐子 div 的方法，如下所示：

![我希望如何对 div 进行排序](../Images/23e131cfc7da14fae7e0147e5c55e8bb.png)

在子 div 上使用默认 display:block 会导致它们继续向下运行，忽略容器 div 的边界，而使用 display:inline-block 会导致它们显示如下：

![div 如何使用 display:inline-block 显示](../Images/64a0ae20aa017f88e3bf401935e8c45f.png)

容器 div 中是否缺少一些东西来阻止孩子们溢出，或者我需要添加到孩子们身上吗？

谢谢，

注意：图片只显示了 8 个盒子，我计划使用更多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T21:43:39.210

**CSS3**列是您正在寻找的。这是一个示例，HTML：

```
<div class = "container">
    <div class = "entry">Glee is awesome!<br/>1</div>
    <div class = "entry">Glee is awesome!<br/>2</div>
    <div class = "entry">Glee is awesome!<br/>3</div>
    <div class = "entry">Glee is awesome!<br/>4</div>
    <div class = "entry">Glee is awesome!<br/>5</div>
    <div class = "entry">Glee is awesome!<br/>6</div>
    <div class = "entry">Glee is awesome!<br/>7</div>
    <div class = "entry">Glee is awesome!<br/>8</div>
</div> 
```

CSS：

```
.container {
    height: 230px; /*2 * 100 + 3 * 10*/
    width: 450px; /*2 * 400 + 5 * 10*/
    -moz-column-count: 4;
    -webkit-column-count: 4;
    column-count: 4; /*4 columns*/
}
.entry {
    height: 100px;
    width: 100px;
    margin: 10px;
    background-color: rgb(0, 162, 232);
    color: white;
    font-family: 'Arial', Helvetica, Sans-Serif;
    text-align: center;
    font-weight: bold;
} 
```

还有一个小演示：[小链接](http://jsfiddle.net/UmcgY/2/)。

我希望这有帮助！

# vb.net - 在屏幕顶部找到窗口的句柄

> ID：12125685
> 
> 赞同：6
> 
> 时间：2012-08-25T21:10:41.320
> 
> 标签：vb.net, winapi, topmost

我想检查外部应用程序（在线扑克游戏桌）的窗口何时跳过所有其他窗口，因为轮到我玩了。

问题是游戏桌在前台跳转......但是窗口没有变得活跃......这意味着我无法检查它是否被API GetForegroundWindow 跳过所有其他可见窗口（以及在fatc此 API 继续返回前一个窗口的句柄，如果它位于跳过所有桌面窗口的游戏桌下）。GetTopWindow API 也不起作用。

现在的问题是：如何找到顶部可见窗口的句柄（在我的眼睛所有其他打开的窗口之上的窗口）如果它不活动？

* * *

不，该窗口不是 TopMost 窗口：事实上，如果我单击另一个窗口，它会进入后台。如果它应该是 TopMost 窗口，它将保持在顶部。

可能它被 WM_SHOW 或 WM_NOACTIVATE 标志放在前台。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T08:00:03.630

[`EnumWindows`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633497%28v=vs.85%29.aspx)可能还有[`WindowFromPoint`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633558%28v=vs.85%29.aspx)API 函数。您可以在 VB.NET 应用程序中通过 P/Invoke 使用它们，并且能够以从上到下的顺序 (EnumWindows) 查找窗口，在识别您感兴趣的窗口的过程中检查它们的位置、标题等，或者直接定位特定位置的窗口（WindowFromPoint；我认为您感兴趣的窗口可能会在屏幕中心弹出，或者以您已经知道的另一个窗口为中心，或者您可以通过其标题轻松找到它 - 这样您就知道您的点屏幕上的兴趣已经）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T03:47:31.887

听起来该应用程序可能正在使用`SetWindowPos(..., HWND_TOPMOST, ...)`成为最顶层的窗口。以这种方式定位的窗口不必处于活动状态即可显示在顶部。

在这种情况下，您可以尝试使用`GetWindow(..., GW_HWNDFIRST)`在窗口管理器的 z 顺序中查找最顶层的窗口。有关执行此操作的简短代码片段，请参阅[http://support.microsoft.com/kb/126386](http://support.microsoft.com/kb/126386)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T03:38:49.870

扑克应用程序必须使用 Win32 API，例如`SetForegroundWindow(hWnd)`在轮到您时将窗口置于顶部。

为了检测这样的调用，您可以使用[Windbg Script Tracing API 调用](http://blogs.msdn.com/b/debuggingtoolbox/archive/2007/04/14/windbg-script-tracing-api-calls.aspx)

> 您可以使用它从 Windbg 屏幕中查看应用程序正在使用的 API，而无需使用其他工具。如果您需要 API 的更多详细信息，只需执行 LogViewer.exe 并打开使用此脚本时自动创建的 .lgv 文件。

![在此处输入图像描述](../Images/ed6bd8fcc460a57b55a63ce7a6fd176f.png)

![在此处输入图像描述](../Images/226d7106dd3c7c963ef1961cf622ceb0.png)

输出文件，扩展名为 .LGV。

![在此处输入图像描述](../Images/36173aa3d3ef36c83efa2e2512ae9726.png)

LogViewer.exe 是 Windows 调试工具的一部分。它与您安装 Windbg 的位置相同。使用 LogViewer.exe 打开 .LGV 文件：

![在此处输入图像描述](../Images/584bc54d2d518b4448a34e2904ae651a.png)

**API_TRACING.TXT 的源代码：**

```
$$
$$ =============================================================================
$$ Trace APIs during the Debugging Session. 
$$ Creates a log on Desktop and Windbg window.
$$ To see the more verbose log run logviewer.exe from Debugging Tools for Windows
$$ and open the file that has the .lgv extension.
$$ This file is inside LogExts on your desktop.
$$
$$ Compatibility: Win32, should work on Win64.
$$
$$ Usage: $$>< to run the program.
$$
$$ Roberto Alexis Farah
$$ Blog: blogs.msdn.com/debuggingtoolbox/
$$
$$ All my scripts are provided "AS IS" with no warranties, and confer no rights.
$$ =============================================================================
$$
!logexts.loge
!logexts.logc e *
!logexts.logo e v
!logexts.logb p
$$
$$ ====================================
$$ Logging is enabled for this process.
$$ ==================================== 
```

一旦你掌握了所有这些信息，你就会知道要从特定的调用者/DLL/等中寻找什么 API 调用，**那就是轮到你的时候了**，扑克窗口就在上面，你可以使用这篇知识库文章来[查找句柄TopMost 窗口的](http://support.microsoft.com/kb/126386)

# grails - 在 CloudFoundry 上启动 Grails 应用程序时出现“状态未确定”

> ID：12125692
> 
> 赞同：2
> 
> 时间：2012-08-25T21:11:48.377
> 
> 标签：grails, cloud-foundry

我有一个在 CloudFoundry 上运行了几个月的 Grails 应用程序。我将应用程序从 Grails 2.0.4 更新到 2.1.0，还更新了一些我一直在使用的插件。

现在，当我将应用程序推送到 CloudFoundry 并启动时，我收到错误消息：

'appname' 状态未确定，没有足够的可用信息。

tomcat Catalina 日志显示下面的 NoClassDefFoundError。

我已经阅读了有关[Ivy 缓存](http://support.cloudfoundry.com/entries/20120727-basic-grails-app-fails-check-the-logs-and-your-dependencies)的问题，但尚未对此进行研究。我已将 vmc 更新到最新版本 (0.3.18)。

```
SEVERE: Error deploying web application directory ROOT
java.lang.NoClassDefFoundError: org/apache/tomcat/PeriodicEventListener
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClassCond(ClassLoader.java:632)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:616)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
    at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:2818)
    at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:1159)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1647)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1128)
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1026)
    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:4421)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4734)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:799)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:779)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:601)
    at org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1079)
    at org.apache.catalina.startup.HostConfig.deployDirectories(HostConfig.java:1002)
    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:506)
    at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1317)
    at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:324)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:142)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1065)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
    at org.apache.catalina.core.StandardService.start(StandardService.java:525)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:595)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)
Caused by: java.lang.ClassNotFoundException: org.apache.tomcat.PeriodicEventListener
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526)
    ... 34 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T18:32:11.037

我刚从 Grails 1.3.7 迁移到 2.1.1 时遇到了这个问题。

我通过解压 WAR 文件、删除所有 tomcat-*.jar 文件（有几个嵌入 tomcat 的 jars）然后重新启动 Tomcat 来修复它。

我已经运行了 Tomcat 6，我想知道这是否是问题所在？无论如何，我的应用程序现在正在运行——尽管它不是最好的安装程序！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T18:07:50.293

我没有使用 CloudFoundry，但在将 Grails 2.1 WAR 部署到 Tomcat 6 时遇到了同样的问题。目前，我已配置为在 WAR 生成之前从 WAR 暂存区域`_Events.groovy`中删除嵌入式`tomcat-`和jar：`grails-plugin-tomcat-`

```
eventCreateWarStart = { warName, stagingDir ->
    // Work-around to remove tomcat jars from .war.
    File libDir = new File("${stagingDir}/WEB-INF/lib/")
    if (libDir.exists() && libDir.isDirectory()) {
        ant.echo(message: 'Events.eventCreateWarStart: Removing embedded tomcat .jars from .war.')
        libDir.eachFileMatch(FileType.FILES, ~/^(tomcat|grails-plugin-tomcat).*\.jar$/) { File jarToRemove ->
            jarToRemove.delete()
        }
    }
} 
```

（`libDir.exists() && libDir.isDirectory()`检查可能不是必需的。）

这目前有效，但获得真正的解决方案而不是解决方法会很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-26T18:24:21.270

我通过从 2.1.0 回滚到 Grails 2.0.4 解决了这个问题。我认为问题可能是[这里描述](http://jira.grails.org/browse/GRAILS-9118)的问题。但是 Graeme 提供的解决方法在部署到 cloudfoundry.com 时并没有解决问题。

在 Grails 2.1.0 下本地运行此应用程序没有问题，但在 cloudfoundry.com 下无法运行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-25T22:05:04.303

我对 spring 应用程序有同样的问题。重新启动服务后 ~cloudfoundry/vcap/dev_setup/bin/vcap stop, cloudfoundry/vcap/dev_setup/bin/vcap start 我设法推送我的应用程序没有任何问题。在更强大的机器上安装 CF 可能会有所帮助。你现在的硬件是什么？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-05-14T07:45:15.123

我知道这个问题是关于 Grails 和 CF 的，但谷歌并不太关心这个问题...... ;)

```
java.lang.ClassNotFoundException: org.apache.tomcat.PeriodicEventListener 
```

当 Eclipse WTP 尝试发布 Maven 项目并运行它时，也可能会出现。在你的依赖层次结构中的某个地方，你应该找到一个 tomcat 库，即使它的范围是`provided`or `test`。

检查您的 WTP-webapp 的 lib 目录，并注意其中的一堆 tomcat 库。

# android - Android切换文本按钮？

> ID：12125694
> 
> 赞同：0
> 
> 时间：2012-08-25T21:12:18.243
> 
> 标签：android

我正在开发一个包含一些引号的应用程序，但我无法使用下一个/上一个按钮在附加图像中的引号之间导航？？有人可以帮忙吗？

[http://img.technospot.net/Free-Android-app-Success-Quotes.jpg](http://img.technospot.net/Free-Android-app-Success-Quotes.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T21:21:30.163

如果唯一改变的是报价，只需让下一个和上一个按钮将单击时的文本更改为循环中的下一个报价。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T21:26:41.140

我假设您正在生成随机数以随机显示引号。只需保存引号的位置（它们是否存储在`array`？）并在用户每次单击下一步时将它们保存在整数列表中。

```
 List<Integer> intList = new ArrayList<Integer>(); 
```

因此，如果用户想返回，只需获取通过访问列表显示的前一个号码：

```
intList.get(intList.size()-1); 
```

下次您应该提供更多信息，并尽可能准确。

# c++ - Webkit GTK：停止加载并重置 Web 视图

> ID：12125705
> 
> 赞同：1
> 
> 时间：2012-08-25T21:13:27.773
> 
> 标签：c++, webkit, gtk

我正在尝试使用**[Webkit GTK](http://webkitgtk.org/reference/webkitgtk/stable/webkitgtk-webkitwebview.html)** API 编写 C++ 程序。该程序只是加载一个页面，然后对其进行处理，然后再加载另一个页面，依此类推。

有时页面加载时间太长，所以我有一个[超时回调](http://developer.gnome.org/glib/2.31/glib-The-Main-Event-Loop.html#g-timeout-add)，它会在一定时间后调用。回调只是调用[webkit_web_view_stop_loading()](http://webkitgtk.org/reference/webkitgtk/stable/webkitgtk-webkitwebview.html#webkit-web-view-stop-loading)，然后加载下一页。

问题是在取消页面加载后，我找不到任何方法来重置[WebkitWebView对象的状态。](http://webkitgtk.org/reference/webkitgtk/stable/webkitgtk-webkitwebview.html)所以有时发生的情况是，我会调用[webkit_web_view_load_uri()](http://webkitgtk.org/reference/webkitgtk/stable/webkitgtk-webkitwebview.html#webkit-web-view-load-uri)来加载页面 A。但是加载页面 A 需要的时间太长，所以会调用超时，并调用[webkit_web_view_stop_loading()](http://webkitgtk.org/reference/webkitgtk/stable/webkitgtk-webkitwebview.html#webkit-web-view-stop-loading)。然后我开始加载页面 B，但是页面 A 剩余的各种资源（如 CSS 文件、JPEG、Iframe 等）仍然会导致调用回调，即使我的意图是完全停止页面 A 的所有加载。

我正在寻找类似 webkit_web_view_reset() 函数（不存在）的东西，它将重置[WebkitWebView](http://webkitgtk.org/reference/webkitgtk/stable/webkitgtk-webkitwebview.html)对象的状态，因此我可以从头开始加载新页面。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T13:42:49.250

以下是您可以考虑的一些选项：

*   您可以创建一个新的 Web 视图。
*   您可以使用`webkit_web_view_load_html_string()`.
*   或者您也可以使用`webkit_web_view_go_back_or_forward()`或返回`webkit_web_view_go_back_or_forward()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T15:44:55.863

您可能想要做的是终止与该会话关联的所有预先存在的会话（也称为连接）。这样做的方法是使用 WebKit 全局函数 ( [http://webkitgtk.org/reference/webkitgtk/stable/webkitgtk-Global-functions.html](http://webkitgtk.org/reference/webkitgtk/stable/webkitgtk-Global-functions.html) ) `webkit_get_default_session()`。这将返回一个`SoupSession`实例，您可以在其中调用`soup_session_abort()`（[https://developer.gnome.org/libsoup/stable/SoupSession.html#soup-session-abort](https://developer.gnome.org/libsoup/stable/SoupSession.html#soup-session-abort)）或`soup_session_cancel_message()`（[https://developer.gnome.org/libsoup/stable /SoupSession.html#soup-session-cancel-message](https://developer.gnome.org/libsoup/stable/SoupSession.html#soup-session-cancel-message)）函数来杀死/取消所有挂起和空闲的请求。

# c# - 查找 dll 依赖项

> ID：12125706
> 
> 赞同：0
> 
> 时间：2012-08-25T21:13:29.943
> 
> 标签：c#, dll

我正在用 C# 构建一个程序，并且使用了很多 dll。但是，我相信我只使用了每个 dll 中的少量函数，因此想知道是否有可能以某种方式访问​​ dll 并将使用的函数仅提取到单独的 dll 中。

或者换句话说，假设我有 2 个 dll A 和 B。A 具有函数 a、b 和 c，而 B 具有函数 1、2 和 3。如果我只使用 a 和 2，有什么办法（或者甚至合法吗？？）以某种方式制作只有a和2的第三个dll C？

目的是我不必参考 2（实际上更像 20），而只需要 1。

这可能/合法吗？？？？我知道微软有一个工具可以将 dll 组合成一个，但我不知道如何编辑它们或任何东西......谁能解释一下？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T21:45:23.253

@Mattb2291：我建议采用不同的方法。取一个具有函数 a 和 2 的类 C。A 类和 B 类应该从 C 继承。在 C 类中，为方法 a 和 2 提供基本实现。

但是对于某些事情，您需要牢记：

首先，从 OOP 的角度来看，A 类和 B 类是否与同一个问题域相关？其次，如果方法 a 和 2 正在访问其各自类中的任何类成员，则必须将它们移至 C 类。您的代码可能如下所示：

```
class C{
    void a(){
    }

    void 2(){
    }
}

class A:C{
}

class B:C{
} 
```

这个答案是从 OPP 的角度来看的。在您的项目中实施之前，您必须对其进行验证。

# c# - 将 Nhibernate 实体序列化为 json 序列化太多

> ID：12125707
> 
> 赞同：0
> 
> 时间：2012-08-25T21:13:30.910
> 
> 标签：c#, .net, nhibernate, caching, serialization

我有一个问题我已经尝试解决了一段时间。

场景如下

该人将在数据库中插入一个新实体。

要开始插入，我需要从 xml 文件进行昂贵的转换以填充一些基本属性。

我想在之前处理这个 xml 并将已经转换为 o 对象的对象存储在一些缺少的缓存中。

之后，填充这个对象的其他属性的过程非常耗时，我希望这个人可以在中间停下来然后结束它。但是，由于插入此对象时在数据库中进行了一些验证，因此我无法将此对象不完整地保存在数据库中。

我整理的解决方案涉及在人停止填充对象时序列化对象，即使它还没有完成，而不是当人回来继续填充时，我会反序列化对象，以便人可以继续。

问题是，当我尝试序列化这个对象时，nihibernate 由于延迟加载而序列化了几乎整个数据库，并且我得到了 stackoverlow 错误（哈哈，在这里说这个错误很有趣，哈哈）。

有谁知道我应该怎么做？

我所做的一件事是将对象保留在缓存中（不知道 /net 4 缓存如何对其进行序列化但接缝工作）但是每次我检索对象时它都会丢失一半的子对象，而且总是正好一半这些孩子 ....

如果是实时的，我有一个包含 20 个项目的订单，如果我尝试从缓存中取回它，它将返回 10 个项目，如果我再次尝试检索它，我将得到只有 5 个项目的订单。

有谁知道如何解决这个问题？

已经在那里尝试了

[NHibernate 使用 WCF 序列化延迟加载的实体](https://stackoverflow.com/questions/5593814/nhibernate-serializing-lazy-loaded-entities-with-wcf)

[将 nHibernate 查询序列化为 JSON](https://stackoverflow.com/questions/4206925/serialize-nhibernate-query-to-json)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T10:11:36.273

一种方法是先投影您想要的，然后将结果序列化为 DTO。

但是，这样做会遇到一个问题，即创建具有大量 setter/getter 的 DTO。创建一个简单的匿名类型并将其序列化不是更容易吗？我写了[一篇博客文章](http://puredotnetcoder.blogspot.co.uk/2012/04/setresulttransformer-into-anonymous.html)来解释这一点。

```
//first create our anonymous type DTO
var dto = new { 
    Id = 0L, 
    Source = string.Empty, 
    Destination = string.Empty, 
    Is301 = false
};

//notice the ListAs(dto) extension method
var model = Session.QueryOver<CmsRedirect>()
  .SelectList(s => s
    .Select(x => x.Id).WithAlias(() => dto.Id)
    .Select(x => x.Source).WithAlias(() => dto.Source)
    .Select(x => x.Destination).WithAlias(() => dto.Destination)
    .Select(x => x.Do301).WithAlias(() => dto.Is301)
  )
  .Take(take).Skip(page * pageSize)
  .ListAs(dto);

return Json(new { Total = total, List = model }, 
    JsonRequestBehavior.AllowGet); 
```

ListAs 是一种简单的（ish）扩展方法。（归功于菲利普·金斯基）

```
public static class NHibernateExtensions {
  public static IList<TRes> ListAs<TRes>(
      this IQueryOver qry, TRes resultByExample) {

    var ctor = typeof(TRes).GetConstructors().First();

    return qry.UnderlyingCriteria
      .SetResultTransformer(
        Transformers.AliasToBeanConstructor(
         (ConstructorInfo) ctor)
        ).List<TRes>();
  }
} 
```

但请注意，在我的示例中，我不会序列化子集合，因此您可能需要自己手动处理。

# windows-8 - Visual Studio 2012 认为我在 Windows 8 上并且需要我没有的库？

> ID：12125713
> 
> 赞同：1
> 
> 时间：2012-08-25T21:14:43.307
> 
> 标签：windows-8, visual-studio-2012, directx-11, xaudio2

我从 2010 年 6 月开始从 DirectX 11 SDK 中的一个示例中实现了代码。我在 2012 年打开了我的项目，然后我也在 2012 年打开了示例，但是当我运行我的时，它需要 XAudio2_8.dll。这是什可能吗？那是 Windows 8 中的 .dll，而 SDK 中的代码是 2010 年的 - 当时不存在这样的 .dll？最奇怪的是 SDK 示例构建并运行，而我的项目要求提供 .dll.I链接了所有的库，制作了所有的包含，我检查了项目设置，在整个硬盘驱动器中搜索了这样的 dll，没有...什么可能导致这样的问题？我也遇到了各种各样的其他问题在 VS2012 下的 SDK 中，例如无法识别 dx11 标头中的类型等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-06-27T18:42:43.800

Windows 8.x SDK 集成了 DirectX SDK，这对于许多领域来说意味着您根本不需要使用旧的 DirectX SDK。特别是，Direct3D、DirectSound、DirectInput 等在 Windows 8.x SDK 中都有正确的头文件和库。

DirectX SDK 非常古老，因此缺少一些旧的东西：没有 DirectMusic 播放、DirectPlay 等。我有一篇[博客](https://walbourn.github.io/directx-sdks-of-a-certain-age/)文章提供了 DirectX SDK 中所有内容的完整清单。

变得复杂的地方是 XAudio 和 XInput。XAudio 2.8 和 XInput 1.4 都是 Windows 8.x 操作系统的一部分，但在 Windows 7 上不可用。如果您的目标是“下级”到 Windows 7，则必须使用 XAudio 2.7 和 XInput 1.3 或 XInput 9.1 .0\. 这个有点混乱的故事在两个博客条目中进行了介绍：一个用于[XInput](https://walbourn.github.io/xinput-and-windows-8/)，另一个用于[XAudio](https://walbourn.github.io/xaudio2-and-windows-8/)。好消息是 XInput 的大多数使用实际上都可以通过 XInput 9.1.0 实现，它是从 Windows Vista 开始的 Windows 操作系统的一部分。它是 XAudio 的“下级”，需要混合现代 Windows 8.x SDK 和旧版 DirectX SDK，并且必须使用旧版 DirectX SDK REDIST (DirectSetup)。

您收到“运行时”错误而不是“编译时”错误的根本原因是您没有将 _WIN32_WINNT 设置为 Windows 7 的 0x0601（或 Windows Vista 的 0x0600）。如果您有，Windows 8.x SDK 中的 XINPUT.H 标头将自动使用 XInput 9.1.0 版本，而 Windows 8.x SDK 中的 XAUIOD2.H 标头会出错并告诉您它不会运行适用于 Windows 7。

最后，我清理了许多旧的 Direct SDK 示例并将其重新发布到[MSDN 代码库](https://walbourn.github.io/directx-sdk-samples-catalog/)，这样它们就不需要旧的 DirectX SDK。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T10:17:40.203

基本规则是，如果你在 Win 8 上开发 XAudio2 程序，使用 Windows SDK，否则使用 DirectX SDK。

如果您正在使用 Win7，请确保

1.  您使用的头文件 XAudio2.h 来自 DirectX SDK，类似于 C:\Program Files\Microsoft DirectX SDK (June 2010)\Include\XAudio2.h，而不来自 Win8 SDK，类似于 C:\ Program Files\Windows Kits\8.0\Include\um\XAudio2.h（如果您安装了 Win8 SDK）
2.  调用 CoInitializeEx(NULL, COINIT_MULTITHREADED); 在调用XAudio2Create之前，由于XAaudio2的旧版本（2.8之前）是COM创建的，所以不需要.lib文件，Win8之前的XAudio2没有.lib文件。

下面这个页面包含了XAudio2版本的详细介绍，大家可以看看。

[XAudio2 版本](http://msdn.microsoft.com/en-us/library/windows/desktop/ee415802%28v=vs.85%29.aspx)

# java - Java swing jTable 未更新

> ID：12125715
> 
> 赞同：1
> 
> 时间：2012-08-25T21:14:48.317
> 
> 标签：java, swing, user-interface, jtable

我使用 NetBeans GUI 构建了一个 jTable，我想在类的构造函数中更新它。我打算在框架上添加一个搜索选项，所以整个更新想法对我来说非常重要。

我的代码：

```
 public availableTrumps(TrumpistClient TC){
    initComponents();
    availableTrumpsTrumpistClient=TC;
    String result=null;

    String query="SELECT * FROM APP.TRUMPS";

        result=this.availableTrumpsTrumpistClient.WritingReading("sql_select", query);

        if (result.contains("empty")){
            JOptionPane.showMessageDialog(this, "There are now trumps to show.");
        }
        else if (result.contains("error")){
            JOptionPane.showMessageDialog(this, "Error in the connection. Please try again.");
        }
        else{
            int i;
            String []data = result.split("\r\n");
            String [][] data2 = new String [data.length][];
            for (i = 0; i < data.length; i++)
            {
                data2[i] = data[i].split("&");
            }
            String[] columnNames = {"From", "To", "Departure Time", "Remaining Places", "Proposer", "ClosingTime", "Cost Per Seat" };
            this.jTable1 = new JTable(data2,columnNames);
            this.jTable1.setPreferredScrollableViewportSize(new Dimension(500,100));
            this.jTable1.setFillsViewportHeight(true);
            JScrollPane jps = new JScrollPane(jTable1);
            add(jps);
            jTable1.revalidate();

    }

    } 
```

输入的二维数组 data2 很好并且经过验证。我添加了代码的最后 5 行，看看它们是否有帮助。我不知道它们是否是强制性的，并且无论如何我都不想更改我用 GUI 构建的 jTable 的图形属性（只是其中的数据）。当我运行程序时，我看到 jTable 仍然是空的。为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T21:20:15.633

我建议您使用表格模型，只要数据发生更改，您就可以更改模型。只构建`JTable`一次实例，而不是在您需要更改数据时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T21:32:34.963

正如其他人所说，您*不想*创建多个`JTable`实例。像这样创建一个：

```
DefaultTableModel model = new DefaultTableModel(new Object[0][0], 
    new String[]{"From", "To", "etc."});

JTable table = new JTable(model); 
```

然后，当您需要添加行时，使用

```
model.addRow(dataForThisRow); // Object 
```

如果要更改单元格：

```
model.setValueAt(newValue, row, col); // Object, int, int 
```

或者，删除行`i`：

```
model.removeRow(i); // int 
```

有关详细信息，请[参阅`DefaultTableModel`文档](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/table/DefaultTableModel.html)。

* * *

如果由于某种原因，您每次都必须重新创建表，我相信问题在于您在没有调用的`revalidate`情况下调用`repaint`。

# php - 如果标签存在，mongodb php upsert

> ID：12125718
> 
> 赞同：1
> 
> 时间：2012-08-25T21:15:10.797
> 
> 标签：php, mongodb

我正在尝试在所有具有**“标题”的条目中更新并插入一条名为****“已启用”的记录**

 **```
{
     "_id": ObjectId("50310c48ba76882419000001"),
     "title": "XKCD",
     "online": true
}   
{
     "_id": ObjectId("50310c48ba76882419000000"),
     "title": "Calvin and Hobbes",
     "author": "Bill Watterson"
} 
```

这是我的尝试，但我似乎遇到了一些问题。
当我运行它时，什么也没有发生。
任何帮助，将不胜感激

```
$mongo = new Mongo();
$db = $mongo->mydb;
$col = $db->members;

$query = array('title'=>array('$exist' => true));
$col->update($query, array('enabled' => '0' )); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T23:11:09.817

我认为您的问题在这里存在：

```
$col->update($query, array('enabled' => '0' )); 
```

这实际上会将除不可变字段之外的所有`_id`字段替换为`enabled: 0`. 尝试`$set`运算符：

```
$col->update($query, array('$set' => array('enabled' => '0' )), array('multiple' => true)); 
```

[http://www.mongodb.org/display/DOCS/Updating#Updating-%24set](http://www.mongodb.org/display/DOCS/Updating#Updating-%24set)**

# svg - Raphael SVG 示例 - 颜色从何而来？

> ID：12125725
> 
> 赞同：0
> 
> 时间：2012-08-25T21:16:20.420
> 
> 标签：svg, raphael, vector-graphics

**我的问题所指的页面：[http ://raphaeljs.com/australia.html](http://raphaeljs.com/australia.html)**

有人可以告诉我这些澳大利亚州的颜色代码来自代码中的哪个位置吗？

此功能在鼠标悬停时应用颜色，但我看不到它从哪里获取颜色。

```
st.animate({fill: st.color, stroke: "#ccc"}, 500); 
```

'st.color' 从哪里获取填充颜色？

**我的问题所指的页面：[http ://raphaeljs.com/australia.html](http://raphaeljs.com/australia.html)**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T21:25:30.913

他们来自这一行：

```
aus[state].color = Raphael.getColor(); 
```

`aus[state]`然后传递给后续立即调用的函数表达式`st`：

```
 (function (st, state) {
                    ...
                })(aus[state], state); 
```

# mysql - mysql组合唯一键

> ID：12125727
> 
> 赞同：20
> 
> 时间：2012-08-25T21:16:30.310
> 
> 标签：mysql, unique-constraint

MySQL中有没有办法拥有两个唯一的键并以某种方式连接它们？

例如，如果我有下表并且“标题”和“商店”是唯一键

```
id | category | title       | price | store
1  | outdoors | fishing rod | 59.99 | wal-mart
2  | auto     | Penzoil Oil | 9.99  | target 
```

我尝试插入以下记录。这条新记录将被忽略，因为标题是“钓鱼竿”并且商店是“沃尔玛”，并且存在具有该标题和商店的现有记录

```
 | outdoors | fishing rod | 30.99 | wal-mart 
```

但是如果我尝试插入以下记录，它将被接受，因为不存在标题为“钓鱼竿”和存储“目标”的记录

```
 | outdoors | fishing rod | 30.99 | target 
```

这可能只用 MySQL 吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-08-25T21:20:09.430

您可以在多个列上定义索引，例如：

```
CREATE UNIQUE INDEX arbitrary_index_name ON table_name (title, store); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-25T21:18:22.460

是的。您应该在两列上创建一个唯一约束，而不是两个单独的唯一约束。

`CREATE INDEX`语法是：

```
CREATE [UNIQUE|FULLTEXT|SPATIAL] INDEX index_name
    [index_type]
    ON tbl_name (index_col_name,...)
    [algorithm_option | lock_option] ... 
```

对于您的示例，它看起来像这样：

```
CREATE UNIQUE INDEX index_name ON tbl_name (title,store); 
```

您还必须删除您创建的两个不正确的唯一索引。

有关如何创建索引的更多详细信息，请参阅[文档。](http://dev.mysql.com/doc/refman/5.6/en/create-index.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-25T21:20:03.943

您需要一个[多列唯一键](http://dev.mysql.com/doc/refman/5.0/en/multiple-column-indexes.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-12T09:14:32.873

ALTER TABLE`table_name`添加唯一索引( `title`, `store`);

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-25T21:20:37.410

是的你可以！

```
ALTER TABLE table_name DROP PRIMARY KEY;
ALTER TABLE table_name ADD PRIMARY KEY(title, store); 
```

# javascript - 更新到 jquery 1.7 和 jquery ui 1.8 后，ui boxer 在拖动时丢失了边框

> ID：12125740
> 
> 赞同：0
> 
> 时间：2012-08-25T21:17:38.957
> 
> 标签：javascript, jquery, html, css, jquery-ui

> **可能重复：**
> [如何更改此 jQuery 小部件（为 jQueryUI 1.7 编写）使其适用于 jQueryUI 1.8](https://stackoverflow.com/questions/4310189/how-to-change-this-jquery-widget-written-for-jqueryui-1-7-so-that-it-works-wit)

我发现 ui boxer jquery ui 插件很酷，但是它基于 jquery 1.3 和 jquery ui 1.7：http: [//jsfiddle.net/7bJak/23/](http://jsfiddle.net/7bJak/23/)

在我将它更新到 jquery 1.7 和 jquery ui 1.8 之后，我发现它在拖动和绘图时丢失了矩形的边框，尽管当你释放鼠标时框终于出来了：http: [//jsfiddle.net/7bJak/ 24/](http://jsfiddle.net/7bJak/24/)

任何人都知道如何在绘制矩形时添加边框？

# c++ - 析构函数和地图

> ID：12125745
> 
> 赞同：2
> 
> 时间：2012-08-25T21:18:48.033
> 
> 标签：c++, destructor

```
class X;

class Y {
    public:
        ~Y();
    private:
        map<int,X*> m;
        vector<X*> v;
        X* px;
}; 
```

我猜析构函数`class Y`应该是这样的？

```
Y::~Y() {
    delete px; 
    for (vector<X*>::iterator it = v.begin(); it!=v.end(); it++) 
    delete *it;
    v.clear();
} 
```

但是呢`Y::m`？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-25T21:26:27.850

不，那是完全错误的。您手动删除了资源，而不是使用资源管理类。这是一个非常糟糕的错误。如果你负责释放它们，你真的想要`unique_ptr<X>`or`shared_ptr<X>`或一些类似的类，而不是。`X*`

```
class Y {
    private:
        map<int,std::unique_ptr<X>> m;
        vector<std::unique_ptr<X>> v;
        std::unique_ptr<X> px;
}; 
```

现在不需要自定义析构函数。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-25T21:20:56.760

至于矢量，但对于地图...

```
for (map<int, X*>::iterator it = m.begin(); it != m.end(); ++it)
   delete it->second; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-25T21:21:20.307

相同的：

```
for (map<int,X*>::iterator it = m.begin() ; it != m.end() ; it++ )
   delete it->second; 
```

在 C++11 中，您可以使用`auto`跳过迭代器类型。

也不需要调用`v.clear();`析构函数。

# android - Android opengl 纹理损坏

> ID：12125763
> 
> 赞同：11
> 
> 时间：2012-08-25T21:20:56.953
> 
> 标签：android, opengl-es, android-emulator

我在 Android 模拟器上遇到纹理损坏问题（它在大多数 Android 设备上运行良好）。

![Android 4.1 参考渲染](../Images/7839e5410ec758010f1770572c52d6a7.png)

上图是运行 Android 4.1 Jelly Bean 的模拟器生成的参考渲染，一切看起来都应该。

![安卓 1.6](../Images/a47358f6ce5e3ff9d08ec077a713819c.png)

第二张图片是在运行 Android 1.6 的模拟器中捕获的。请注意某些禁用的工具栏按钮的损坏（它们以颜色 1f、1f、1f、0.5f 呈现）

![安卓 1.6](../Images/3db69c8245c06081981b434fd030bcbd.png)

第三张图片是在同一个模拟器中捕获的。不同的是，现在分数是在右上角呈现的。Score 是一种位图字体，它的纹理是一个 alpha 蒙版。得分后渲染的所有内容都失去了它的纹理。请注意，之前的屏幕截图还包含以相同方式渲染的位图字体（但使用不同的纹理）。

其中一款三星设备也存在类似问题（我不记得型号了）。渲染地板纹理时，在丢失纹理之后渲染的所有内容。当我 a) 没有绑定纹理 b) 确实绑定了纹理，但没有使用它绘制三角形 c) 从头开始​​重新创建 png 资源时，问题并没有表现出来。

OpenGL设置：

```
gl.glDisable(GL10.GL_LIGHTING);
gl.glDisable(GL10.GL_CULL_FACE);
gl.glDisable(GL10.GL_DEPTH_TEST);
gl.glDisable(GL10.GL_DITHER);
gl.glDepthMask(false);
gl.glEnable(GL10.GL_TEXTURE_2D);
gl.glBlendFunc(GL10.GL_ONE,GL10.GL_ONE_MINUS_SRC_ALPHA);
gl.glShadeModel(GL10.GL_FLAT);
gl.glTexEnvf(GL10.GL_TEXTURE_ENV, GL10.GL_TEXTURE_ENV_MODE, GL10.GL_MODULATE); 
```

如何加载纹理：

```
public void doGLLoading(Engine renderer) {
        GL10 gl=renderer.getGl();
        int[] ids=new int[1];
        gl.glGenTextures(1, ids,0);
        id=ids[0];
        gl.glBindTexture(GL10.GL_TEXTURE_2D, id);
        Log.d("SpriteDraw", String.format("Texture %s has format %s",getPath(),bitmap.getConfig().toString()));
        buildMipmap(gl, bitmap);
        gl.glTexParameterf(GL10.GL_TEXTURE_2D,GL10.GL_TEXTURE_MIN_FILTER, minFilter);
        gl.glTexParameterf(GL10.GL_TEXTURE_2D,GL10.GL_TEXTURE_MAG_FILTER, magFilter);
        gl.glTexParameterf(GL10.GL_TEXTURE_2D,GL10.GL_TEXTURE_WRAP_S, textureWrapS);
        gl.glTexParameterf(GL10.GL_TEXTURE_2D,GL10.GL_TEXTURE_WRAP_T, textureWrapT);
    }
private void buildMipmap(GL10 gl, Bitmap bitmap) {
    int level = 0;
    int height = bitmap.getHeight();
    int width = bitmap.getWidth();

    while (height >= 1 || width >= 1) {
        // First of all, generate the texture from our bitmap and set it to
        // the according level
                    //TextureUtils.texImage2D(gl, GL10.GL_TEXTURE_2D, level, -1, bitmap, -1, 0);
        GLUtils.texImage2D(GL10.GL_TEXTURE_2D, level, bitmap, 0);
        if (height == 1 || width == 1) {
            break;
        }
        // Increase the mipmap level
        level++;
        height /= 2;
        width /= 2;
        Bitmap bitmap2 = Bitmap.createScaledBitmap(bitmap, width, height,
                true);

        // Clean up
        bitmap.recycle();
        bitmap = bitmap2;
    }
} 
```

`gl.glBlendFunc(GL10.GL_SRC_ALPHA, GL10.GL_ONE_MINUS_SRC_ALPHA);`注意：字体是使用和呈现的`GL10.glDrawArrays`。损坏不仅影响 1.6 模拟器，还影响 2.x 系列的 android，虽然它没有那么突出（alpha 掩码仍然呈现不正确）。所有资源都正确加载为两个位图的幂。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T11:55:24.030

1.  我建议使用 32 位纹理，而不是灰度，而不是“alphamasks”（那是什么？）
2.  检查纹理的大小，它不应超过最大大小（ glGetInteger( GL_MAX_TEXTURE_SIZE )。还要确保你的纹理是 2 的幂。是的，你之前提到过它们，但是如果它们在可扩展资源中（drawable_x_dpi 文件夹），它们将由android缩放。为避免缩放，请将它们放在“raw”文件夹中。
3.  只是为了测试，尝试禁用所有过滤，包括 mipmap - 将 GL_TEXTURE_WRAP_S 和 GL_TEXTURE_WRAP_T 设置为 GL_NEAREST

# wpf - 更改列表框中最后一项的样式

> ID：12125764
> 
> 赞同：8
> 
> 时间：2012-08-25T21:21:02.280
> 
> 标签：wpf, listbox, itemtemplate

我有具有颜色列表的列表框控件。这是代码和图像：

```
<ListBox Name="FillSelections" VerticalContentAlignment="Stretch" HorizontalContentAlignment="Center" SelectedItem="{Binding SelectedColor}" SelectionMode="Single" Style="{StaticResource HorizontalListBoxStyle}" ItemsSource="{Binding FillColors}" ItemTemplate="{StaticResource ColorsItemTemplate}"></ListBox>

 <DataTemplate x:Key="ColorsItemTemplate">
    <Border BorderBrush="Transparent">
        <Rectangle Width="20" StrokeThickness="1" Stroke="Black">
            <Rectangle.Fill>
                <SolidColorBrush Color="{Binding}" />
            </Rectangle.Fill>
        </Rectangle>
    </Border> 
```

图片：

![图片](../Images/47eb92fc5205ba2c6d9c98c8b2fa06d7.png)

**我将如何仅像这样更改最后一项的样式：**

![图片](../Images/1dbf24507fb3744b6540e9794765d3a4.png)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-26T15:09:22.050

这可以通过转换器来实现，该转换器负责查找列表框中的最后一项 -

**转换器**

```
public class IsLastItemInContainerConverter : IValueConverter
{
   public object Convert(object value, Type targetType,
                         object parameter, CultureInfo culture)
   {
       DependencyObject item = (DependencyObject)value;
       ItemsControl ic = ItemsControl.ItemsControlFromItemContainer(item);

       return ic.ItemContainerGenerator.IndexFromContainer(item)
               == ic.Items.Count - 1;
   }

   public object ConvertBack(object value, Type targetType,
                             object parameter, CultureInfo culture)
   {
      throw new NotImplementedException();
   }
} 
```

并使用它，您可以像这样在您的 xaml 类中设置 DataTemplate -

```
<ListBox ItemContainerStyle="{StaticResource ColorsItemStyle}"/>

<Style x:Key="ColorsItemStyle">
  <Style.Triggers>
     <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self},
       Converter={StaticResource IsLastItemInContainerConverter}}" Value="False">
          <Setter Property="ContentTemplate">
             <Setter.Value>
                 <DataTemplate></DataTemplate> // Your template goes here
             </Setter.Value>
          </Setter>
      </DataTrigger>

     <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self},
       Converter={StaticResource IsLastItemInContainerConverter}}" Value="True">
          <Setter Property="ContentTemplate">
             <Setter.Value>
                 <DataTemplate></DataTemplate> // Your lastItem template goes here
             </Setter.Value>
          </Setter>
      </DataTrigger>
  </Style.Triggers>
</Style> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-06-11T13:15:36.337

为了使它与随时间变化的 ListBox 一起工作，我最终使用了 MultiBinding：

```
<DataTemplate x:Key="myItemTemplate">
    <StackPanel Orientation="Horizontal">
        <TextBlock Text="{Binding}"/>
        <TextBlock x:Name="dots" Text="..."/>
    </StackPanel>
    <DataTemplate.Triggers>
        <DataTrigger Value="False">
            <DataTrigger.Binding>
                <MultiBinding Converter="{StaticResource isLastItemInContainerConverter}">
                    <Binding RelativeSource="{RelativeSource FindAncestor, AncestorType=ListBoxItem}" />
                    <Binding Path="Items.Count" RelativeSource="{RelativeSource FindAncestor, AncestorType=ListBox}" />
                </MultiBinding>
            </DataTrigger.Binding>
            <Setter TargetName="dots" Property="Visibility" Value="Collapsed"/>
        </DataTrigger>
    </DataTemplate.Triggers>
</DataTemplate> 
```

**注意：**第二个绑定仅用于在列表更改时获得通知

这里是对应的MultivalueConverter

```
public class IsLastItemInContainerConverter : IMultiValueConverter
{
    public object Convert(object[] values, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        DependencyObject item = (DependencyObject)values[0];
        ItemsControl ic = ItemsControl.ItemsControlFromItemContainer(item);

        return ic.ItemContainerGenerator.IndexFromContainer(item) == ic.Items.Count - 1;
    }

    public object[] ConvertBack(object value, Type[] targetTypes, object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-02-18T23:31:35.150

## 停止与 UI 混淆......这只是数据！

就个人而言，我认为最简单的方法是使用`CompositeCollection`（或自定义枚举器）。这种思维方式的优点是它可以将其正确地分离为数据，这就是它的本质，而不是与自定义 UI 废话/绑定/相对源等混淆。

我会解释的。

考虑一下您正在尝试显示存储在`myColors`集合中的“x”个动态生成的颜色，然后是表示“没有颜色”的内容（您的盒子里面有线条。）

首先，在您的应用程序中的某处定义一个“无颜色”标记，就像这样......

```
class NoColorToken{} 
```

然后定义一个`DataTemplate`定位那个类，像这样......

```
<DataTemplate DataType="{x:Type ns:NoColorToken}">
    <TextBlock Text="Replace with template representing 'no color'" />
</DataTemplate> 
```

> 您甚至可以使其更通用，将其称为 a`NoSelectionToken`以与任何类型的列表一起使用。只需确保将 DataTemplate 范围限定为该特定位置的使用情况（即本示例中没有颜色。）

然后在您的代码中，只需将您的颜色填充到一个类`CompositeCollection`的实例中`NoColorToken`，如下所示：

```
var colorsAndToken = new CompositeCollection();
colorsAndToken.Add(new CollectionContainer(myColors));
colorsAndToken.Add(new NoColorToken());

itemsControl.ItemsSource = colorsAndToken; 
```

对 MyColors 的更改（如果可观察到）将自动更新 UI。

如果它们不需要是可观察的（即没有单独的添加或删除），只需编写一个枚举器函数（本质上是`CompositeCollection`内部操作的简化基础），事情就可以变得更加容易。

```
IEnumerable ColorsWithToken(IEnumerable colors){

    foreach (var color in colors)
        yield return color;

    yield return new NoColorToken();
}

itemsControl.ItemsSource = ColorsWithToken(myColors); 
```

同样，自定义枚举器方法不会跟踪对`myColors`. 如果`myColors`更改，您必须重新分配`ItemsSource`. 但是，如果你走 的路线`CompositeCollection`，它会自动处理更新，只是以新对象 为代价`CompositeCollection`，但这就是它的用途。

顺便说一句，您还可以将上述内容包装在一个转换器中，该转换器为您处理任一方法，返回枚举数或`CompositeCollection`用于纯 XAML 方法的 a，无论`ItemsControl.ItemsSource`您将其应用于哪个方法。我实际上已经用`AddNoSelectionPlaceholder`转换器做到了这一点。）

同样，我更喜欢它的原因是它将项目（包括“无颜色”项目）视为数据，这就是它的本质。更好的是，因为它是数据，它可以让你轻松地改变周围的事物。想要“无色”商品排在第一位吗？只需切换您添加它们的顺序。

```
colorsAndToken.Add(new NoColorToken());
colorsAndToken.Add(new CollectionContainer(myColors)); 
```

或者

```
yield return new NoColorToken();

foreach (var color in colors)
    yield return color; 
```

同样，现在只是数据。在数据模板或控件、绑定或其他任何地方都不需要做任何“聪明”的事情。更好的是，它现在也是完全可单元测试的。不需要用户界面。

# c++ - Boost -gd 库文件

> ID：12125771
> 
> 赞同：5
> 
> 时间：2012-08-25T21:22:08.573
> 
> 标签：c++, boost

在构建了 boost 库（所以我可以使用文件系统命名空间）之后，我在`stage/lib`文件夹中找到了以下文件，其名称为 filesystem：

```
libboost_filesystem-vc100-mt-1_51 (838 kb)

libboost_filesystem-vc100-gd-mt-1_51 (4210 kb) 
```

注意第二个中的 -gd。我还把尺寸放在括号里。那么，有什么区别呢？我用哪一个？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-25T22:15:54.813

`-gd`用于调试版本的库。用于`-gd-mt`构建调试配置和`-mt`发布配置。

# python - 按位旋转整个文本

> ID：12125772
> 
> 赞同：0
> 
> 时间：2012-08-25T21:22:32.343
> 
> 标签：python, bit-manipulation

为了它的乐趣，我试图将整个文本按位向右旋转。意思是，我希望每个字符的最后一位（lsb）最终成为下一个字符的第一位（msb），最后一个字符的最后一位成为第一个字符的第一位。这是我尝试过的；

```
def bitwise_text_rotate(text):
    # make a list of ascii codes
    characters = [ord(a) for a in text]

    # save last character's right-most bit
    carry_bit = characters[-1] & 1

    # list of processed characters
    output = []

    for char in characters:
        print "processing", char
        last_bit = char & 1
        char = char >> 1
        mask = (carry_bit << 8) & 1
        char = char & mask
        print "appending", char
        output.append(char)
        carry_bit = last_bit

    return "".join([chr(a) for a in output]) 
```

但它不起作用。我得到了所有的零。有什么想法可以让我做得更好，或者我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T21:30:18.180

试试这个：

```
s = map(ord, text)
return ''.join(chr(((a&1)<<7) + (b>>1)) for a,b in zip(s[-1:] + s, s)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T21:38:29.987

这些行不正确：

```
mask = (carry_bit << 8) & 1
char = char & mask 
```

采用：

```
mask = carry_bit << 7
char = char | mask 
```

# c# - 在 XNA 游戏和控制台应用程序之间共享数据

> ID：12125774
> 
> 赞同：0
> 
> 时间：2012-08-25T21:23:00.337
> 
> 标签：c#, xna

我正在制作一个 XNA 游戏，其中玩家同时与许多对象交互。我希望能够将大块对象数组转储到支持控制台应用程序中，该应用程序将保存数据直到再次需要它。我怎么做？

* * *

我正在考虑使用虚拟 RAM 驱动器来存储临时数据，它可能足够快。

# jquery - 使用 ajax 创建表单后，第二次调用 jQuery 对话框未触发

> ID：12125775
> 
> 赞同：0
> 
> 时间：2012-08-25T21:23:09.113
> 
> 标签：jquery, jquery-ui

储户。你就像裂缝一样。当我需要修复时，我会来找你... 我有一个用户提交的评论系统，它使用 jQuery 对话框在用户提交表单之前确认内容。

第一次绕行没问题。对话框触发良好并且表单提交。当我再次尝试发布时，ajax 调用失败，对话框没有触发，并且提交了默认表单。

该对话框绑定在表单的成功 ajax 创建中，所以据我所知，它应该是绑定的，但我肯定遗漏了一些东西。

这是代码。

第一个 ajax 调用引入了一个表单来发布评论。成功加载后，我会在用户尝试提交表单时启动要调用的对话框。

```
// Make the ajax call for the apppropriate content.

$.ajax({
        type: 'Get',
        url: 'a/url/to/process/form',
        cache: false,
        beforeSend: function() {
        },
        success: function(data) {
            $('#commentBox_' + id).html(data).fadeTo('fast', 100);
            $('#' + oId).addClass('remove').removeClass('respond').html('Close');
            // Destroy the instance if it has already been called.
            if(CKEDITOR.instances['comment'])
            {
                delete CKEDITOR.instances['comment'];
            }
            $('#discussionComment_' + id).submit(function() {
            CKupdate()                                            
            });
            // Set the editor.
            CKEDITOR.replace('comment', {toolbar : 'Basic', skin : 'Office2003', height : 250})
            // Set the submit option.
            $('#postComment_' + id).live('click', function() {
                // Warn the user about submitting. Let them review their comment.
                CKupdate() // Update the field with user input content.
                $('.ui-dialog-content').dialog("destroy"); // Get rid of any old dialogs lurking around.
                // Get the content from the form for the confirmation dialog
                var commentTitle = $('#commentSubject_' + id).val();
                var commentBody = CKEDITOR.instances['comment_' + id].getData();
                // Build the new dialog.
                var NewDialog = $('<div>You are about to submit your comment. Verify before submitting.<hr /><h4>' + commentTitle + '</h4><div>' + commentBody + '</div></div>');
                $(NewDialog).dialog({
                    modal: true,
                    title: 'Confirm Post',
                    width: 500,
                    buttons: {
                    'Submit': function() {  
                        commentPost_ajax(id); // Post the form via ajax.
                        $(this).dialog('destroy');
                        },
                    'Edit': function() {
                        $(this).dialog('destroy');
                        return false; // Don't submit the form.
                        }
                    }
                }); 
                return false;
            });// Click to submit form.

        },
        error: function() {
            window.location = "../../post_discussionComment.html?dId<%=dId%>&amp;id=" + id
        }
    }); 
// Stay here. We're just starting to have fun.
    return false; 
```

这是 ajax 帖子的功能。

```
function commentPost_ajax(id) {

// Just close and submit.
$('#discussionComment_' + id).ajaxSubmit({
    beforeSend: function() {
        $('#discussionComment_' + id + ' input:submit').html('Sending...');
        $('#newEntry').attr('id', '');
    },
    success: function(data) {
        $('#commentBox_' + id).after(data);
        $('#discussionComment_' + id).remove();
        $('#discussionComment_' + id).hide('puff', function() { $(this).remove() }, 'fast');
        $('#content_' + id + ' a.remove').removeClass('remove').addClass('respond').html('Respond');
        $('.expand').show();
        window.location + $('#newEntry');
        $('#newEntry').children().effect("highlight", {}, 3000);
    },
    error: function () {
        alert('There was a problem posting your comment. Please try again.');
    }
 }); // Form submit 
} 
```

任何帮助，将不胜感激。我仔细阅读了很多其他问题，但没有一个直接谈到这一点。如果他们这样做了，我找不到他们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T22:30:19.880

如果我正确理解了场景并假设 Ohgodwhy 提到的双重删除问题已修复，那么手头的问题似乎是“（...）默认表单已提交”

假设当前代码中没有发生其他 JS 错误，我也遇到了这种情况，即在第二次显示对话框时提交默认表单。关闭对话框后，我通过从 DOM 中删除对话框 div 来修复它，如下面的代码所示。

下面的代码是这个问题中提交的原始代码的变体：

```
 $('#postComment').live('click', function() {
      var NewDialog = $('<div></div>');
      $(NewDialog).dialog({
         modal: true,
         title: 'Confirm Post',
         width: 500,
         buttons: {
            'Submit': function() {   
               $(this).dialog('close');  
            }
         },
         close: function(event, ui) { 
            $(this).dialog('destroy');
            $(this).detach();
            $(this).remove();
         }
      }).dialog('open'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-18T19:21:31.447

我正在处理的一些代码也遇到了同样的问题。

ajax 在第一次使用时可以正常工作，但在第二次使用时甚至不会触发。

我的解决方法是将处理代码放入如下函数中：

```
function my_do_processing( myitem ) {
  // set up variables using myitem.data('...') or standard jquery
  var my_response = $.post(ajaxurl, { variables } );
  my_response.done( function( data ) {
    $('#container').html(data);
    $('a.eventtrigger').bind('click', function() {
      my_do_processing($(this));
      return false;
    });
 });
};

$('a.eventtrigger').click(function() {
  my_do_processing($(this));
  return false;
}); 
```

这使用类 eventtrigger 在锚点上设置初始单击事件，当它被触发时，它将相同的事件绑定到通过 ajax 输入到文档中的代码。

它对我很有效......但你的里程可能会有所不同。

# ios - 新 Facebook iOS 应用的自定义 URL 方案

> ID：12125780
> 
> 赞同：21
> 
> 时间：2012-08-25T21:24:38.847
> 
> 标签：ios, facebook

有谁知道在他们的新 iOS 应用程序中打开 Facebook 页面的自定义 URL 方案是什么。我正在使用 fb://page/PAGE_ID 但这似乎不适用于最近更新的 Facebook iOS 应用程序，它只是打开了应用程序，但没有转到所需的页面。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-09-10T17:23:33.820

我在[developer.facebook.com](http://developer.facebook.com)得到了这个答案：

将 word **page**替换为**profile**即可。您的新声明将是：

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"fb://profile/247377102029332"]]; 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-11-20T09:50:18.333

使用[https://graph.facebook.com/YOUR_USERNAME](https://graph.facebook.com/YOUR_USERNAME)获取您的页面 ID。

在您的 iOS 应用程序中使用：`fb://profile/[your ID]`facebook 应用程序将打开到您的页面。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-08-26T04:51:19.630

iOS Facebook 应用程序的 URL 方案是：

> fb://profile/(fbid)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-08-27T09:12:11.813

这里同样的问题。fb://page/PAGE_ID 不再工作。请注意，fb://profile/(fbid) 在 Facebook 4.x 上无法正常工作，在 iPad 和 iPhone 中返回“损坏”页面。相反，Facebook 4.x 中的 fb://profile/(fbid)/ **wall**在使用 iPad 时运行良好，但不适用于 iPhone。

根据我的经验，fb://page/PAGE_ID 是唯一适用于 iPhone 和 iPad 的选项。

我曾经使用[http://wiki.akosma.com/IPhone_URL_Schemes](http://wiki.akosma.com/IPhone_URL_Schemes)作为参考，但它目前已关闭...

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2012-08-25T22:01:06.303

自定义 URL 方案是一种机制，第三方应用程序可以通过该机制相互通信。它不允许您在该特定应用程序中打开页面。它只是触发一个事件以将被调用的应用程序带到前台。阅读[本文档](http://developer.apple.com/library/ios/DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/AdvancedAppTricks/AdvancedAppTricks.html#//apple_ref/doc/uid/TP40007072-CH7-SW50)将进一步消除您的疑虑。

新的 Facebook 应用程序是使用 Objective-C 构建的，而不是之前在 HTML5 中用于支持 URL 方案机制的一次。[这个链接](http://techcrunch.com/2012/08/23/facebook-for-ios-faster/)给出了一个提示。

[http://techcrunch.com/2012/08/23/facebook-for-ios-faster/](http://techcrunch.com/2012/08/23/facebook-for-ios-faster/)

# ruby-on-rails - Gemfile 中的“~> 4.0.1”、“4.0.1”和没有版本说明符有什么区别？

> ID：12125784
> 
> 赞同：34
> 
> 时间：2012-08-25T21:25:26.493
> 
> 标签：ruby-on-rails, ruby, gem, gemfile

在 Rails Gemfile 中，这些之间有什么区别：

```
gem "gemname", "~> 4.0.1" 
```

和

```
gem "gemname", "4.0.1" 
```

和

```
gem "gemname" 
```

另外应该在哪里使用以及遵循这种方式的好处是什么？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-08-25T21:41:12.757

第一个将告诉 bundler 加载随最后一个（补丁）编号变化的任何 gem。所以 4.0.x 其中 x 为 1 或更大。

第二个只会加载 4.0.1。

第三个将获得有效的最高值（取决于您的 Gemfile 中其余 gem 的需求），或者将获得 Gemfile.lock 中指定的任何内容，如果您有的话。

我错过了你的第二个问题。坦率地说，这取决于。在大多数情况下，我选择第一个选项，因为它让我可以修复错误，而不必担心它会如何影响我的其他 gem。

# uml - 组件图是否存在人类可读且基于文本的表示？

> ID：12125791
> 
> 赞同：7
> 
> 时间：2012-08-25T21:26:56.600
> 
> 标签：uml, diagram, component-diagram

我正在寻找执行以下操作的组件图的基于文本的表示：

1.  人类可以通过查看文本来阅读和理解图表
2.  文本可以渲染成图表
3.  简单的。没有花哨的功能。基本上只需要盒子、箭头和标签。

这是我正在寻找的一个很好的例子，但有序列图：[http ://www.websequencediagrams.com/](http://www.websequencediagrams.com/)

组件图是否存在这种语言/格式？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-06-01T17:41:45.743

您可以使用[plantuml](http://plantuml.sourceforge.net/index.html)。它可以根据需要从文本中呈现[组件](http://plantuml.sourceforge.net/component.html)图。您需要安装[Graphviz](http://plantuml.sourceforge.net/graphvizdot.html)来制作图表。UML 文本示例：

```
@startuml

DataAccess - [First Component] 
[First Component] ..> HTTP : use

@enduml 
```

![在此处输入图像描述](../Images/088e27b3b5d9bc586f4739f70d11ea5b.png)

还有其他文本 UML 符号，您可以[在此处](http://modeling-languages.com/uml-tools-textual-notations-define-uml-models/)查看它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-06T17:46:40.660

我大部分时间都使用[yUML 。](http://yuml.me)它可以满足您的需求，而且非常简单。它们本身没有 API，但您可以使用 URL 或 POST 轻松构建图表。

您还可以通过购买许可证将其托管在您自己的服务器上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-06T10:44:01.723

您可以尝试 UMLet 实用程序

“UMLet 是一个免费的开源 UML 工具，具有简单的用户界面：快速绘制 UML 图，从纯文本生成序列和活动图”

[http://www.umlet.com/](http://www.umlet.com/)

# android - ListView 行中的 CheckedTextView 复选标记未显示

> ID：12125792
> 
> 赞同：2
> 
> 时间：2012-08-25T21:27:19.873
> 
> 标签：android, checkmark

我的 ListView 行布局的复选标记有问题。即使 ListView 工作（交互工作），单击 ListItem 时也不会显示复选标记。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T21:38:40.027

您将希望使您的自定义行布局是可检查的。

**首先**，您需要创建一个实现 Checkable 的自定义布局：

```
public class CheckableLinearLayout extends LinearLayout implements Checkable {
    private Checkable mCheckable;

    public CheckableLinearLayout(Context context) {
        this(context, null);
    }

    public CheckableLinearLayout(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    @Override
    public boolean isChecked() {
        return mCheckable == null ? false : mCheckable.isChecked();
    }

    @Override
    protected void onFinishInflate() {
        super.onFinishInflate();

        // Find Checkable child
        int childCount = getChildCount();
        for (int i = 0; i < childCount; ++i) {
            View v = getChildAt(i);
            if (v instanceof Checkable) {
                mCheckable = (Checkable) v;
                break;
            }
        }
    }

    @Override
    public void setChecked(boolean checked) {
        if(mCheckable != null)
            mCheckable.setChecked(checked);
    }

    @Override
    public void toggle() {
        if(mCheckable != null)
            mCheckable.toggle();
    }
} 
```

在这个布局被膨胀之后，它会通过它的孩子寻找一个可检查的（比如 CheckedTextView 或 CheckBox），除此之外它非常简单。

**接下来**在布局中使用它：

```
<your.package.name.CheckableLinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="?android:attr/listPreferredItemHeight"
    android:gravity="center_vertical" >

    <TextView 
        android:id="@+id/text1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" />

    <CheckedTextView 
        android:id="@+id/text2"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:checkMark="?android:attr/textCheckMark"
        android:gravity="center_vertical"
        android:paddingLeft="6dp"
        android:paddingRight="6dp" />

</your.package.name.CheckableLinearLayout> 
```

请注意，您不能只使用 CheckableLinearLayout，因为它不是内置的 Android 视图，您需要告诉编译器它在哪里。例如，将其保存为 checkable_list_row.xml。

**最后**，像使用任何其他自定义布局一样使用这个新布局。

```
adapter = new MySimpleCursorAdapter(this, R.layout.checkable_list_row, cursor,
        new String[] { Database.KEY_DATE , Database.KEY_NAME },
        new int[] {R.id.text1, R.id.text2}, 0); 
```

希望有帮助！

# javascript - jQuery 从 1.4.4 更新到 1.8.0 - 不再从 ajax 插入运行 javascript

> ID：12125793
> 
> 赞同：0
> 
> 时间：2012-08-25T21:27:25.087
> 
> 标签：javascript, ajax, jquery

我使用的是 jquery 1.4.4 - 删除了这个版本，更喜欢最新的 1.8.0，因为它似乎更快，我有一些脚本如果一起运行会产生干扰，因此我曾经通过 ajax 加载它们，当响应是成功我会删除其中一个脚本并通过 html() 将另一个插入到 div 中。

这些脚本中有调用调用脚本加载页面中的函数。通过 ajax 方法加载时无法再调用这些函数。页面中通过 ajax 使用加载脚本的函数和从页面调用时加载脚本的函数都不能在页面中工作。

它曾经与 jquery 1.4.4 一起工作得很好 - 我想扭曲最新的 jquery 以使其正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T22:01:54.977

正是由于调用了未声明的函数，document.ready 和 window.load 崩溃了。

# iphone - UIScrollview 不添加按钮

> ID：12125794
> 
> 赞同：0
> 
> 时间：2012-08-25T21:27:28.657
> 
> 标签：iphone, uiscrollview, uibutton

我已经定义了一个 uiscrollview 并使用一个 for 循环向它添加按钮，但是每当我运行程序时，我都会出现一个空白屏幕。这是我的 viewDidLoad，这是我与此相关的所有代码。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    scrollView = [[UIScrollView alloc]initWithFrame:CGRectMake(0, 0, 320, 1000)];
    scrollView.hidden = NO;
    names = [[NSMutableArray alloc]initWithObjects:@"Excavations",@"Concrete",@"Framing",@"Insulation",@"Drywall",@"Finish Carpentry",@"Paint",@"Electrical",@"HVAC",@"Plumbing",@"Roofing",@"Tile",@"Doors",@"Windows",@"Flooring",@"Countertops",@"Landscape",@"Hardscape", nil];
    for (int i = 0; i < 18; i++) {
        UIButton *button = [[UIButton alloc]init];
        button.frame = CGRectMake(0, 50*i, 320, 50);
        button.tag = i;
        [button addTarget:self action:@selector(NewView:) forControlEvents:UIControlEventTouchUpInside];
        button.titleLabel.text = [names objectAtIndex:i];
        button.hidden= NO;
        [scrollView addSubview:button];
    }

// Do any additional setup after loading the view, typically from a nib.
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T21:30:49.393

您需要手动设置按钮的类型，或者只是使用它进行初始化：

```
UIButton *button = [UIButton buttonWithType:UIButtonTypeRoundedRect]; 
```

编辑：您还忘记将滚动视图添加到主视图

```
[self.view addSubview:scrollView]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T21:33:55.703

您必须将 UIScrollView 添加到您的视图中。尝试

```
...
scrollView = [[UIScrollView alloc]initWithFrame:CGRectMake(0, 0, 320, 1000)];
scrollView.hidden = NO;
[self.view addSubview:scrollView]; 
... 
```

# cocos2d-iphone - 如何在 cocos2d 中显示 CCNode 的锚点？

> ID：12125796
> 
> 赞同：2
> 
> 时间：2012-08-25T21:27:45.653
> 
> 标签：cocos2d-iphone, anchor

有没有办法显示 CCNode 的锚点？这对于调试非常有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T21:36:40.240

不是内置的，但您可以使用 anchorPointInPoints 属性在锚点位置[绘制一个点或圆。](http://www.learn-cocos2d.com/api-ref/latest_2.x/cocos2d-iphone/html/_c_c_drawing_primitives_8h.html#a34d0ad7b8f0d0dbd5fb874d607d69f1d)

```
-(void) draw
{
    [super draw];
    ccDrawCircle(self.anchorPointInPoints, 20, 0, 8, YES);
} 
```

当然，我始终建议**不要**一开始就更改 anchorPoint。另一种方法是将节点添加到父节点，将其从父节点偏移，然后父节点的位置就像子节点的锚点一样。优点是boundingBox之类的方法不会从节点的位置偏移（可能是命中检测的问题），并且您可以围绕其中心点和其父节点旋转子节点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T21:44:37.993

您可以使用以下命令访问 CCNode 的锚点

```
- (CGPoint) anchorPointInPixels 
```

这是一种只读方法。之后，您有几种实际标记该点的方法。你可以使用

```
- ccDrawCircle() 
```

同时覆盖 draw 方法或在该点上放置纹理，如果您想要更漂亮的东西。

# ruby-on-rails - 如何测试文件上传和控制器？

> ID：12125797
> 
> 赞同：0
> 
> 时间：2012-08-25T21:28:07.227
> 
> 标签：ruby-on-rails, file-upload, rspec

我的观点

```
 <%= form_tag({:action => 'upload_image', :car_id => @car.id}, :multipart => true) do %>
    <label for="upload_file"><%= t('field.select_image') %></label>
    <%= file_field 'upload', 'datafile' %>&nbsp;<%= submit_tag t('field.upload_file') %>
  <% end %> 
```

我的控制器

```
 def upload_image   
    if params[:upload].present? && params[:car_id].present?
      DataFile.save_image_file(params[:upload][:datafile], params[:car_id]) # My methods to save image and other operations with file

    end
    redirect_to images_path(:car_id => params[:car_id])
  end 
```

我的 Rspec 测试（不起作用）

```
before :each do
  @car = FactoryGirl.create(:car)
  @file = fixture_file_upload('/files/test-bus-1.jpg', 'image/jpg')

end

it "can upload a car" do
  post :upload_image, :upload => @file, :car_id => @car.id
  response.should redirect_to images_path(:car_id => @car.id)
end 
```

错误：失败/错误：post :upload_image, :upload => @file, :car_id => @car.id NoMethodError: undefined method `[]' for # File:/tmp/test-bus-1.jpg20120826-29027- plg28d

怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T10:04:22.173

在我看来，根据您设置表单的方式（因为您正在调用`params[:upload][:datafile]`），您需要将 rspec 测试更改为：

```
post :upload_image, :upload => { :datafile => @file }, :car_id => @car.id 
```

# visual-studio - 从 MSDNAA 下载 Visual Studio 2012 RC 并在 9 月更新到最终版本？

> ID：12125798
> 
> 赞同：0
> 
> 时间：2012-08-25T21:28:59.740
> 
> 标签：visual-studio, visual-studio-2012, dreamspark

如果我今天从 MSDNAA (dreamspark) 下载 Visual Studio 2012 RC，以后会不会只是升级，还是必须在 9 月发布时重新安装所有内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T21:39:39.337

如果您知道您将获得哪个版本（Ultimate/Premium/Professional），现在只需获得[**发布版本**](http://www.microsoft.com/visualstudio/11/en-us/downloads)[的90 天评估版](http://www.microsoft.com/visualstudio/11/en-us/downloads)**，然后在 9 月输入您的实际密钥。**

# matlab - 使用 MATLAB 保存图像

> ID：12125800
> 
> 赞同：2
> 
> 时间：2012-08-25T21:29:08.023
> 
> 标签：matlab

我在 MATLAB 中编写了一个程序来生成具有不同规格的图像，但是每次我更改这些规格之一时，我都必须以不同的名称和路径重新保存图像。所以，我做了一个for循环来改变这些规范，但我不知道如何让MATLAB用不同的名称和不同的路径保存生成的图像......

***如何编写程序让 MATLAB 保存多个生成的具有不同名称和不同路径的图像作为`for`–loop 的一部分？***

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T21:36:31.677

在循环的末尾放置这样的内容：

```
for i = 1:n
  <your loop code>
  file_name=sprintf('%d.jpg',i);  % assuming you are saving image as a .jpg
  imwrite(your_image, file_name);  % or something like this, however you choose to save your image
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T22:29:38.237

如果您想保存 JPEG、PNG 等，请参阅@AGS 的帖子。如果要保存FIG文件，请使用

```
hgsave(gcf, file_name) 
```

而不是`imwrite`线。还有

```
print('-djpeg', file_name)  %# for JPEG file (lossy)
print('-dpng', file_name)   %# for PNG file (lossless) 
```

作为`imwrite`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-13T18:25:43.370

由于我想将循环中的图保存在当前工作目录 (pwd) 的特定文件夹中，因此我修改了命名例程，如下所示：

```
for s = 1:10
    for i = 1:10 
    <loop commands>
    end
end

% prints stimuli to folder created for them
file_name=sprintf('%s/eb_imgs/%0.3f.tif',pwd,s(i)); % pwd = path of present working  
                                                    % directory and s(i) = the value 
                                                    % of the changing variable
                                                    % that I wanted to document

file_name = /Users/Miriam/Documents/PSYC/eb_imgs/0.700.tif % how my filename appears
print('-dtiff', '-r300', file_name); % this saves my file to my desired location 
```

[matlab](/questions/tagged/matlab "显示标记为“matlab”的问题") [matlab路径](/questions/tagged/matlab-path "显示标记为“matlab-path”的问题")

# git-branch - git 存储库中的 repo 清单和分支

> ID：12125803
> 
> 赞同：0
> 
> 时间：2012-08-25T21:29:25.887
> 
> 标签：git-branch, repository

我使用 repo init 和 repo sync 将 android 存储库复制到本地 pc，分支是 ics_rb7。在 manifest.xml 文件中，revision 是 ics_rb7.2，应该是每个项目中的分支吧？但是，分支 ics_rb7.2 并不存在于存储库中的所有项目中。我们如何知道项目中的哪个分支是默认克隆的？谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-04T12:17:50.580

您在您的指定`repo init`的分支是仅用于清单存储库的分支。您可以在`.repo/manifests`. 该分支不一定（甚至通常）与将用于各个项目的分支相同。

.repo 中的`manifest.xml`文件实际上是指向清单存储库中特定清单的符号链接（用于`ls -l`查看哪个）。它是在您执行 a 时创建的`repo init`，使用您指定的分支 (-b) 和清单 (-m) 标志来确定要使用的标志，或者如果您没有指定，则使用默认值（例如 master 和 default.xml）这些标志。

清单文件为使用该元素的项目指定默认修订版，但各个元素可以覆盖它并指定不同的修订版。这可以解释为什么您的某些项目没有 ics_rb7.2 分支。

如果您想了解给定项目的清单分支是什么，您可以查看 manifest.xml 文件，或者执行`git branch -a`并查找如下所示的分支：

`remotes/m/my_manifest_branch`

# php - MySQL：在表中插入带有重音或ñ的数据时加密的单词

> ID：12125804
> 
> 赞同：0
> 
> 时间：2012-08-25T21:29:56.557
> 
> 标签：php, mysql, utf-8

我使用简单的插入将用户注册的数据（带重音符号的单词）保存在 mysql 表中，但是当我在本地工作中使用此脚本时没有问题，但是当我在主机中使用时，保存为如果加密并且我不不明白。

**PHP**

```
$query = "INSERT INTO usuarios 
    (user, password, name, lastname, phone, email)
        VALUES ('$user','$pass','$name','$lname','$phone','$email')";

$result = mysql_query($query) or die (mysql_error()); 
```

**与数据库的连接**

```
require_once 'config.php';
    //connecting to mysql
    $con = mysql_connect(DB_HOST,DB_USER,DB_PASSWORD);
    //selecting database
    mysql_select_db(DB_DATABASE);
    mysql_query('SET names=utf8');  
    return $con;
} 
```

我的表和数据库有 utf8，在我的 HTML FORM 中我有

```
<meta charset="utf-8"> 
```

例如，如果我插入这些数据：

```
$user = 'soldier';
$pass = '1234';
$name = 'Edgar';
$lname = 'Ramírez';
$phone = '234234';
$email = 'soldier@mail.com'; 
```

这是存储在表中的结果：

```
Table: Users

user    |    password    |    name    |       lastname       | phone  | email
________________________________________________________________________________________
soldier       1234            Edgar      52616dc383c2ad72657a   234234  soldier@mail.com 
```

这一直发生，如果一个词有ñ或重音，以这种方式插入表中：/

我希望我已经解释了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T21:43:33.313

您应该检查创建输出的方式。给定的文本只是“十六进制编码”。请参阅以下代码：

```
$text = '52616dc383c2ad72657a';
for ($l = strlen($text), $i = 0; $i < $l; ++$i) {
  echo chr(hexdec(substr($text, $i * 2, 2)));
} 
```

结果是`RamÃ­rez`。“破碎”字符只是 UTF-8 的 ASCII 表示。

所以你的代码很好，只是你用来检查表格内容的工具以十六进制而不是 UTF-8 显示字符串表示。

# ios - iOS AVAudioPlayer 不播放

> ID：12125808
> 
> 赞同：1
> 
> 时间：2012-08-25T21:30:46.980
> 
> 标签：ios, avfoundation, avaudioplayer

这段代码：

```
NSString *urlPath = [[NSBundle mainBundle] pathForResource:@"snd" ofType:@"mp3"];
NSURL *url = [NSURL fileURLWithPath:urlPath];

NSError *err;

AVAudioPlayer* audioPlayerMusic = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:&err];

[audioPlayerMusic play]; 
```

工作得很好。

虽然这个：

```
NSString *urlPath = [[NSBundle mainBundle] pathForResource:@"snd" ofType:@"mp3"];
NSURL *url = [NSURL fileURLWithPath:urlPath];

AVPlayer* audioPlayerMusic = [AVPlayer playerWithURL:url];

[audioPlayerMusic play]; 
```

什么都不玩！

怎么了？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-25T21:51:05.467

播放/流式传输远程文件时，AVPlayer 尚未准备好播放它 - 您必须等待它缓冲足够的数据才能开始支付，而使用 AVAudioPlayer 时则不需要。因此，要么使用 AVAudioPlayer，要么让 AVPlayer 在准备好开始播放时使用键值观察通知你的类：

```
[player addObserver:self forKeyPath:@"status" options:0 context:NULL]; 
```

在你的类中（`self`指上一行中的实例）：

```
- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context {
    if ([keyPath isEqualToString:@"status"]) {
        if (player.status == AVPlayerStatusReadyToPlay) {
            [player play];
        } else if (player.status == AVPlayerStatusFailed) {
            /* An error was encountered */
        }
    }
} 
```

# c# - 显示模式弹出登录后等待用户响应

> ID：12125812
> 
> 赞同：0
> 
> 时间：2012-08-25T21:31:08.973
> 
> 标签：c#, asp.net, ajaxcontroltoolkit

在我的文件后面的代码中，我调用了一个 html 模式弹出窗口，它提示用户输入他们的用户名和密码。在继续之前，我想从这个返回到我调用函数后面的代码。我该怎么做呢？现在显示了模态表单，并且 c# 代码继续处理这是有道理的，但它不是我想要的。注意： modal signoff html modal form 有一个按钮（btnSignoff），它调用一些其他代码隐藏函数感谢Damo

**后面的代码：**

```
SignoffModal.Show();
//Wait for response (this is what i would like to be able to do)
if (result <0)
{
//throw some error
}

else
{
// Do some more work
} 
```

**HTML 代码：**

```
 <!-- Signoff Modal Form -->
                <asp:HiddenField ID="SignoffForModal" runat="server" />
                <ajaxToolkit:ModalPopupExtender runat="server" ID="SignoffModal" BehaviorID="modalPopupExtenderSignoff"
                    TargetControlID="SignoffForModal" PopupControlID="popUpPaneSignoff" OkControlID="btnSignoff"
                    BackgroundCssClass="modalBackground">
                </ajaxToolkit:ModalPopupExtender>
                <asp:Panel ID="popUpPaneSignoff" runat="server" CssClass="confirm-dialog">
                    <asp:Label ID="lblUsername" runat="server" Text="Username"></asp:Label>
                    <br />
                    <asp:TextBox ID="txtUserName" runat="server" ToolTip="Username" Width="200px"></asp:TextBox>
                    <br />
                    <asp:Label ID="lblPassword" runat="server" Text="Password"></asp:Label>
                    <br />
                    <asp:TextBox ID="txtPassword" runat="server" ToolTip="Password" TextMode="Password"
                        Width="200px"></asp:TextBox>
                    <br />
                    <br />
                    <div class="base">
                        <asp:Button ID="btnSignoff" runat="server" Text="Signoff" />
                        <asp:LinkButton ID="LinkButton3" runat="server" CssClass="close" OnClientClick="$find('modalPopupExtenderSignoff').hide(); return false;" /></div>
                </asp:Panel>
                <!-- End Signoff Modal Form --> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T23:00:23.707

好像`ModalPopupExtender`不是这样设计的。虽然它是*模态*的（防止用户与页面的其余部分交互），但它不是*阻塞*的，意味着代码在调用表单后继续运行。那是因为弹出窗口在客户端上运行，而代码隐藏在服务器上运行。这称为[回调](http://en.wikipedia.org/wiki/Callback_%28computer_programming%29)，因为客户端代码在执行操作时*回调*到服务器。

为了使这项工作，您必须通过添加一个指向处理取消操作的按钮的属性来将您之后的逻辑拆分为`SignoffModal.Show();`“确定”部分和“取消”部分，然后添加按钮：`CancelControlID``ModalPopupExtender`

```
 <!-- Signoff Modal Form -->
<asp:HiddenField ID="SignoffForModal" runat="server" />
<ajaxToolkit:ModalPopupExtender runat="server" ID="SignoffModal" 
    BehaviorID="modalPopupExtenderSignoff"
    TargetControlID="SignoffForModal" 
    PopupControlID="popUpPaneSignoff"     
    OkControlID="btnSignoff" 
 // points to cancel button action
    CancelControlID="btnCancel" 
 BackgroundCssClass="modalBackground"> 
```

...

```
<asp:Button ID="btnSignoff" runat="server" Text="Signoff" />
    // handles Cancel action...
    <asp:Button ID="btnCancel" runat="server" Text="Cancel" />
    ...
<!-- End Signoff Modal Form --> 
```

* * *

在`btnSignoff`代码隐藏事件处理程序中：

```
{
// Do some work... 
```

在`btnCancel`代码隐藏事件处理程序中：

```
{
//throw some error... 
```

# python - 在 Python 中，循环遍历一个 dict 并将 list 或 dict 的所有值设置为字符串

> ID：12125818
> 
> 赞同：0
> 
> 时间：2012-08-25T21:32:04.023
> 
> 标签：python, list, loops, dictionary

我有一个字典“元数据”，其中包含字符串、列表、字典和整数的键值对。如何循环遍历该字典并将所有非字符串或整数类型的值转换为字符串？

有没有办法同时删除值为空的键？如果不添加额外的循环，我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T21:47:17.340

用于[`isinstance`](http://docs.python.org/library/functions.html#isinstance)检查值的类型。在 Python 3 中，您可以简单地编写：

```
{k:v if isinstance(v, (str, int)) else str(v) for k,v in dct.items() if k != ''} 
```

在较旧的 Python 版本中，您必须知道没有字典解析（<2.7），并且有多种类型可以内置 int 和字符串（<3）。如果您在谈论字符串时指的是字符串，那么 2.5-2.7 等效项将*是*

```
dict((k, v if isinstance(v, (unicode, int, long)) else unicode(v))
     for k,v in dct.iteritems()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T21:49:10.783

这有效：

```
d={'l':[1,2,3],'s':'abc','i':5,'f':1.23,'di':{1:'one',2:'two'},'emty':''}
{k:v if type(v) in (str,int, long,unicode) else repr(v) for k,v in d.items() if v!=''} 
```

印刷：

```
{'i': 5, 's': 'abc', 'di': "{1: 'one', 2: 'two'}", 'l': '[1, 2, 3]', 'f': '1.23'} 
```

# c# - 每当检查复选框时，如何插入日期？

> ID：12125819
> 
> 赞同：0
> 
> 时间：2012-08-25T21:32:04.327
> 
> 标签：c#, javascript, vb.net

我有这个标记：

```
 <asp:TemplateField HeaderText="Date Printed">
   <ItemTemplate>
    <asp:Label ID="lblMessage" style ="font-weight:bold; " runat="server" CssClass="style26"></asp:Label>
   </ItemTemplate> 
  </asp:TemplateField> 
```

然后后面的这段代码

```
For Each r As GridViewRow In gridView1.Rows
 If CType(r.Cells(0).FindControl("myrec"), CheckBox).Checked Then
   lblMessaget.Text = DateTime.Now.ToString("dd/MM/yyyy")
 End If
 Next 
```

我真正想做的就是每当用户单击复选框以选中它并单击“打印选中的项目”框时，今天的日期就会插入到复选框所在行的“打印日期”列中。

我正在做一些愚蠢的事情，这就是为什么这不起作用。

任何帮助是极大的赞赏。

虽然我正在尝试使用 vb.net 或 c# 来做这件事，但如果有人可以帮助我用 JavaScript 来做这件事，那也很棒。

```
 <script type="text/javascript">
        function CheckBox_Click() {
            $('#' + '<%=gridView1.ClientID %>' + ' tr:has(:checkbox:checked)  td:nth-child(3) span').each(function () {
                $(this).attr("innerHTML", new Date());
            });

        }

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T02:22:32.840

我认为你需要确保你有正确的标签。 `lblMessaget`总是被分配，但你说：

> *...日期被插入到复选框**所在行的打印日期列中。***

所以你还需要：

```
CType(r.Cells(0).FindControl("row-specific-label"), Label).Text = DateTime.Now.ToString( "dd.MM.yyyy" ); 
```

// 编辑：

您需要确保为单元格使用正确的索引。无论这是什么，您都需要标签的单元格。

# ajax - jquery .submit live click 运行不止一次

> ID：12125820
> 
> 赞同：2
> 
> 时间：2012-08-25T21:32:05.623
> 
> 标签：ajax, post, submit, jquery

我使用以下代码运行我的表单 ajax 请求，但是当我在按钮上使用实时选择器时，我可以看到 ajax 响应触发 1 次，然后如果我重试 2 次、3 次、4 次等等。 ..

我使用它`.live`是因为我还具有添加帖子的功能，并且该功能会立即显示，因此用户可以在不刷新页面的情况下将其删除...

然后这导致了上述问题......使用`.click`可以解决这个问题，但这不是我正在寻找的理想解决方案......

```
jQuery.fn.postAjax = function(success_callback, show_confirm) {
    this.submit(function(e) {
        e.preventDefault();
        if (show_confirm == true) {
            if (confirm('Are you sure you want to delete this item? You can\'t undo this.')) {
                $.post(this.action, $(this).serialize(), $.proxy(success_callback, this));
            }
        } else {
            $.post(this.action, $(this).serialize(), $.proxy(success_callback, this));
        }
        return false;
    })
    return this;
};
$(document).ready(function() {
    $(".delete_button").live('click', function() {
        $(this).parent().postAjax(function(data) {
            if (data.error == true) {

            } else {

            }
        }, true);
    });
});​ 
```

**编辑：临时解决方案是改变**

```
this.submit(function(e) { 
```

到

```
this.unbind('submit').bind('submit',function(e) { 
```

问题是我如何才能真正保护它，因为知道如何在其他浏览器上使用 Firebug 或相同工具的人可以轻松更改我的 Javascript 代码并重新创建问题

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-25T21:42:24.337

如果您不希望每次单击按钮时都绑定新的单击事件，则需要在重新绑定之前取消绑定事件，否则最终会出现多个绑定。

要取消绑定与`live()`您绑定的事件，可以使用`die()`. 我认为使用`die()`with的语法与`live()`此类似（*未经测试*）：

```
$(document).ready(function(){
    $('.delete_button').die('click').live('click', function(){
        $(this).parent().postAjax(function(data){
            if (data.error == true){
            }else{
            }
        }, true);
    });
}); 
```

但是，如果您使用 jQuery 1.7 或更高版本，请使用自 1.7 以来已弃用的 as`on()`而不是`live()`as ，并且有许多缺点。 有关所有详细信息，请参阅[**文档**](http://api.jquery.com/live/)。`live()`
[](http://api.jquery.com/live/)

 **要使用`on()`你可以像这样绑定（我假设它`delete_button`是一个动态添加的元素）：

```
$(document).ready(function(){
    $(document).off('click', '.delete_button').on('click', '.delete_button', function(){
        $(this).parent().postAjax(function(data){
            if (data.error == true){
            }else{
            }
        }, true);
    });
}); 
```

如果您使用的是早期版本的 jQuery，您可以使用`undelegate()`or`unbind()`和`delegate()`代替。我相信语法与`on()`上面类似。

**编辑（2012 年 8 月 29 日）**

> 问题是我如何才能真正保护它，因为知道如何在其他浏览器上使用 Firebug 或相同工具的人可以轻松更改我的 Javascript 代码并重新创建问题

您可以保护您的脚本，但不能阻止任何人针对您的站点执行他们自己的自定义脚本。

为了至少在某种程度上保护您自己的脚本，您可以：

*   在外部 js 文件中编写任何脚本，并在您的站点中包含对该脚本的引用
*   缩小文件以供发布

### 在外部 js 文件中编写任何脚本，并在您的站点中包含对该脚本的引用

这将使您的 html 变得干净，并且不会留下任何脚本的痕迹。用户当然可以看到脚本参考并遵循它，您可以缩小文件以进行发布。

要包含对脚本文件的引用：

```
<script type="text/javascript" src="/scripts/myscript.js"></script>
<script type="text/javascript" src="/scripts/myscript.min.js"></script> 
```

### 缩小文件以供发布

缩小脚本文件将删除任何多余的空格并将函数名称缩短为字母等。类似于 JQuery 的缩小版。代码仍然有效，但毫无意义。当然，铁杆用户可能会遵循毫无意义的命名代码并最终弄清楚您在做什么。但是，除非您值得入侵，否则我怀疑任何人都会在普通网站上打扰。

就我个人而言，我没有经历过缩小过程，但这里有一些资源：

*   [**维基百科 - 缩小（编程）**](http://en.wikipedia.org/wiki/Minification_%28programming%29)
*   [**合并、缩小和压缩 JavaScript 文件以更快地加载 ASP.NET 页面**](http://atashbahar.com/post/Combine-minify-compress-JavaScript-files-to-load-ASPNET-pages-faster.aspx)
*   [**如何使用 PHP 缩小（不混淆）你的 JavaScript**](http://bytes.com/topic/php/insights/796602-how-minify-not-obfuscate-your-javascript-using-php)

**编辑（2012 年 9 月 1 日）**

回应`adeneo`关于使用[**one()**](http://api.jquery.com/one/)的评论。我知道您已经通过取消绑定和重新绑定到提交事件找到了解决问题的方法。

我相信虽然值得`one()`在此答案中提及完整性，因为将事件与[**one()**](http://api.jquery.com/one/)绑定只会执行事件，然后再次解除绑定。

作为您的点击事件，当触发时，无论如何都会重新加载和重新绑定自身，`one()`作为解除绑定和重新绑定的替代方案也是有意义的。

其语法类似于`on()`，请牢记动态元素。

```
// Syntax should be right but not tested.
$(document).ready(function() {
    $(document).one('click', '.delete_button', function() {
        $(this).parent().postAjax(function(data) {
            if (data.error == true) {} else {}
        }, true);
    });
});​ 
```

### 相关资源

*   [**居住（）**](http://api.jquery.com/live/)
*   [**死（）**](http://api.jquery.com/die/)
*   [**在（）**](http://api.jquery.com/on/)
*   [**离开（）**](http://api.jquery.com/off/)
*   [**解绑（）**](http://api.jquery.com/unbind/)
*   [**代表（）**](http://api.jquery.com/delegate/)
*   [**取消委托（）**](http://api.jquery.com/undelegate/)
*   [**一（）**](http://api.jquery.com/one/)

* * *

**再次编辑！！！！：**

```
jQuery.fn.postAjax = function(show_confirm, success_callback) {
    this.off('submit').on('submit', function(e) { //this is the problem, binding the submit function multiple times
        e.preventDefault();
        if (show_confirm) {
            if (confirm('Are you sure you want to delete this item? You can\'t undo this.')) {
                $.post(this.action, $(this).serialize(), $.proxy(success_callback, this));
            }
        } else {
            $.post(this.action, $(this).serialize(), $.proxy(success_callback, this));
        }
    });
    return this;
};
$(document).ready(function() {
    $(this).on('click', '.delete_button', function(e) {
        $(e.target.form).postAjax(true, function(data) {
            if (data.error) {

            } else {

            }
        });
    });
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T07:51:22.350

```
jQuery.fn.postAjax = function(success_callback, show_confirm) {
    this.bind( 'submit.confirmCallback', //give your function a namespace to avoid removing other callbacks
      function(e) {
        $(this).unbind('submit.confirmCallback');
        e.preventDefault();
        if (show_confirm === true) {
            if (confirm('Are you sure you want to delete this item? You can\'t undo this.')) {
                $.post(this.action, $(this).serialize(), $.proxy(success_callback, this));
            }
        } else {
            $.post(this.action, $(this).serialize(), $.proxy(success_callback, this));
        }
        return false;
    })
    return this;
};
$(document).ready(function() {
    $(".delete_button").live('click', function() {
        $(this).parent().postAjax(function(data) {
            if (data.error == true) {

            } else {

            }
        }, true);
    });
});​ 
```

至于“人们可以使用 Firebug 来更改我的 javascript”的说法，它不成立：人们也可以看到您发送的请求`$.post(...)`，并发送两次。

您无法控制浏览器中发生的事情，并且应该保护您的服务器端处理，而不是希望“它不会在浏览器中显示两次，因此它会防止我的数据库被损坏”。**

# c# - 处理上下文菜单中的快捷方式

> ID：12125821
> 
> 赞同：3
> 
> 时间：2012-08-25T21:32:18.420
> 
> 标签：c#, winforms, events, keyboard-shortcuts, contextmenu

我有一个显示为模型对话框的 Windows 窗体。它有一个上下文菜单 class `ContextMenuStrip`。我在上下文菜单中设置了几个项目的快捷方式。但是此快捷方式仅在显示上下文菜单时才有效。即使未激活上下文菜单，如何使它们工作？

我知道的唯一方法是处理`KeyPress`表单事件，递归遍历上下文菜单中的所有项目，并将其`ShortcutKeys`属性与实际按下的键进行比较。如果匹配，手动调用`OnClick`该项目的事件。有更好的想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-05T09:35:52.803

使用 ToolStripMenuItem.ShortCutKeys 属性，这样您就无需迭代和调用事件处理程序。

示例代码：

```
ContextMenuStrip _contextMenuStrip = new ContextMenuStrip();
var menuItem = new ToolStripMenuItem("Copy");
menuItem.ShortcutKeys = Keys.Control | Keys.C;
_contextMenuStrip.Items.Add(menuItem); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T18:32:00.960

您是在打开`ContextMenuStrip`in 代码还是将集合的`ContextMenuStrip`属性`Form`设置为`ContextMenuStrip`您创建的？如果它是在代码中打开的，你可以设置`Form`属性吗？那应该让您无需先打开菜单即可执行快捷方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-19T15:57:03.297

最后，我在`KeyPressed`事件处理程序中实现了手动迭代：

```
 Action<ToolStripMenuItem> check_shortcut = null;

  check_shortcut = (node) =>
  {
    if (node.ShortcutKeys == e.KeyData)
    {
      node.PerformClick();
    }
    foreach (ToolStripMenuItem child in node.DropDownItems)
    {
      check_shortcut(child);
    }
  };

  foreach (ToolStripMenuItem item in MyContextMenuStrip.Items)
  {
    check_shortcut(item);
  } 
```

# c# - 将此 SQL 转换为 LINQ

> ID：12125825
> 
> 赞同：0
> 
> 时间：2012-08-25T21:33:11.713
> 
> 标签：c#, sql, linq, sql-to-linq-conversion

我有以下 SQL 语句要在 C# 中转换为 LINQ。该`@amount`变量将是一个 C# 变量。

```
DECLARE @amount DECIMAL(20,2)
SET @amount = 120.30

UPDATE INVOICES SET AmtPaid = AmtPaid + @amount WHERE InvoiceNum = 'AC0000034550' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T21:35:14.823

您*不能* `UPDATE`使用 LINQ。

LINQ 是一个*查询*引擎，适用于`SELECT`（如果我们用原始 SQL 的话）。

另外，如果您已经有良好的工作 SQL 代码，那么将其转换为 LINQ*没有任何意义；*SQL 更快，并且可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T21:35:11.643

LINQ 不进行更新，因此您无法将 SQL 转换为 LINQ

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T21:40:13.520

为什么不使用 linq 进行选择然后遍历列表并更新变量？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-25T22:22:49.833

我做了如下。不确定是否正确：

```
using (var dataContext = GetDataContext())
{
    var invoiceData = from i in dataContext.Invoices
                      where i.InvoiceNumber == paymentData.InvoiceNumber
                      select i;
    foreach(var invoice in invoiceData)
    {
        decimal outPut;
        if (Decimal.TryParse(paymentData.AmountPaid, out outPut))
        {
            invoice.AmtPaid = invoice.AmtPaid + Convert.ToDecimal(paymentData.AmountPaid);
        }
    }
    dataContext.SubmitChanges();
} 
```

# php - 仅显示行 100 次 PHP

> ID：12125830
> 
> 赞同：0
> 
> 时间：2012-08-25T21:33:50.150
> 
> 标签：php

如何限制显示结果？我需要将其限制为 100 个视图。

在数据库中，我有：

```
ID|NAME|PAGE|COUNT|DATE 
```

在计数中，我想数到 100，然后停止显示该 ID。我可以用 count < 100 来做到这一点。然后更新特定的 ID。我可以获得少于 100 次查看的记录，但我无法更新特定 ID 的计数。

行显示为：

php代码：

```
foreach($bannerGroups[0] as $ban) {
        echo '<li class="right1">'.$ban->html().'</li>';       
} 
```

但我只是不知道在哪里把更新放在那里。我试过了，但我得到的只是更新一个 ID。但它在一页上显示 4 并在刷新时将它们随机化。所以我不知道该怎么办。

另外我想说我只是在学习php。对不起所有的混乱。

[http://pastebin.com/A9hJTPLE](http://pastebin.com/A9hJTPLE)上的代码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T21:39:57.903

如果我理解正确，您想显示之前显示次数少于 100 次的所有横幅？

如果这是正确的，您可以将其添加到您的`WHERE`子句中：

```
$bannerResult = mysql_query("SELECT * FROM table WHERE page='cat' WHERE `COUNT` < 100"); 
```

要全部更新它们，您可以在显示每个单独的横幅时运行查询，或者“记录”每个横幅`id`并在最后运行单个查询，例如：

```
$ids = array();
foreach($bannerGroups[0] as $ban) {
    $ids[] = $ban['ID']; // record the ID; don't know how Banner
                         // class works, assuming uses indexes; maybe ID() method?
    echo '<li class="right1">'.$ban->html().'</li>';
}
...
mysql_query('UPDATE table SET `COUNT` = `COUNT` + 1 WHERE ID IN (' . join(',', $ids) . ')'); 
```

**更新**：
根据评论，您的`Banner`班级没有检索单个横幅的`ID`. 在这种情况下，您可以`ID`在构建横幅数组时记录这些值：

```
$ids = array();
while($row=mysql_fetch_assoc($bannerResult)) {
    $banners[] = new Banner($row);
    $ids[] = $row['ID']; // record the ID
}
// update the `count` on each record:
mysql_query('UPDATE table SET `COUNT` = `COUNT` + 1 WHERE ID IN (' . join(',', $ids) . ')'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T21:39:30.340

对不起，我把你的问题搞错了……

首先，您必须在数据库中插入一个新的 sql 列，例如“viewcount”...在每次读取时，您必须增加 viewcount 中的值...

对于该行为（因为 mysql 不允许在同一表上的更新子句上进行子选择），您必须从 db 中获取结果，然后将记录的所有主键传递给数组...在视图逻辑之后，您必须启动如下查询：

```
UPDATE foo SET viewcount = viewcount + 1 WHERE id IN (1,2,3,4,5,6...,100); 
```

可以使用带有“implode(',', $arr);”的主键数组轻松生成 IN 子句

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T21:39:18.027

```
$bannerResult = mysql_query("SELECT * FROM table WHERE page='cat' AND `count`<100"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-26T09:38:51.127

@newfurniturey 想出来了。在每个`foreach($banneruGroups added: $ids = $ban->getValue('id');`然后`mysql_query("UPDATE dataa SET COUNT = COUNT + 1 WHERE id = '$ids'");`但是有没有办法通过只添加一次查询来更新它们？如果 id 已经显示了 100 次，我`Warning: Invalid argument supplied for foreach() in.`知道如何解决它吗？我在 DB 中有 4 个 id。如果其中一个已经有 100 个视图（计数），那么我会出错！

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-25T21:36:29.553

尝试将您的数据源限制为 100 个项目。
就像`OFFSET x LIMIT 100`在 MySQL/PostgreSQL 查询或`TOP 100`MSSQL 中一样。

# c++ - 使用 QTestLib 进行单元测试

> ID：12125833
> 
> 赞同：3
> 
> 时间：2012-08-25T21:34:34.583
> 
> 标签：c++, unit-testing, qt4, qtestlib

我正在尝试使用 QTestLib 对我的 Qt 应用程序进行单元测试。我看到新的 Visual Studio 2012 有一个内置的 C++ 测试框架并通过谷歌搜索我看到[这个](http://msdn.microsoft.com/it-it/library/hh419385.aspx)页面讨论了测试本机项目的不同方法。我将有两个不同的项目，一个用于正常程序，一个用于测试。实际上，我的应用程序不是 DLL，而是一个简单的 C++ exe。用另一个项目来测试它以链接到 .obj 文件或库的最佳方法是什么？我不会从源代码中导出任何内容，因为我的不是 DLL

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T09:55:08.793

这是一个典型的 QtTest 项目，包含三个代码单元：unit1、unit2 和 unit3

```
 project/
    ├── project.pro
    ├── src
    │   ├── main.cpp
    │   ├── src.pro
    │   ├── unit1.cpp
    │   ├── unit1.h
    │   ├── unit2.cpp
    │   ├── unit2.h
    │   ├── unit3.cpp
    │   └── unit3.h
    └── tests
        ├── stubs
        │   ├── stubs.pro
        │   ├── unit1_stub.cpp
        │   ├── unit2_stub.cpp
        │   └── unit3_stub.cpp
        ├── test1
        │   ├── test1.cpp
        │   ├── test1.h
        │   └── test1.pro
        ├── test2
        │   ├── test2.cpp
        │   ├── test2.h
        │   └── test2.pro
        ├── test3
        │   ├── test3.cpp
        │   ├── test3.h
        │   └── test3.pro
        └── tests.pro 
```

该项目产生 4 个二进制文件：1 个应用程序本身和三个用于测试每个单元的测试二进制文件。例如，test1 应该包括 src/unit1.cpp、src/unit1.h 以及存根 unit2 和 unit3：src/unit2.h、tests/stubs/unit2_stub.cpp、src/unit2.h、tests/stubs/unit3_stub。 cpp。使用这种设置 src/unit1.cpp 和 tests/stubs/unit1_tests.cpp 将被编译两次，如果单元数会更大，这个数字会增长。这对于小型项目来说不是问题，但对于大型项目，这可能会导致构建时间显着增加。

然后将 unitX.cpp 和 unitX.h 拆分为单独的库，并静态链接到主应用程序，每个测试都将消除多次构建的需要。

# google-sheets - 计算列中出现的次数？

> ID：12125847
> 
> 赞同：49
> 
> 时间：2012-08-25T21:37:06.697
> 
> 标签：google-sheets, google-sheets-formula, array-formulas

计算电子表格列中出现次数的好方法是什么？这可以用一个*数组公式*来完成吗？

示例（列`A`是*输入*，列`B`是`C`自动*生成的*）：

```
|   A   |   B   |   C   |
+-------+-------+-------+
| Name  | Name  | Count |
+-------+-------+-------+
| Joe   | Joe   |     2 |
| Lisa  | Lisa  |     3 |
| Jenny | Jenny |     2 |
| Lisa  |       |       |
| Lisa  |       |       |
| Joe   |       |       |
| Jenny |       |       | 
```

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2013-03-09T11:03:29.970

一个更简单的方法

在 B 列的开头，键入

```
=UNIQUE(A:A) 
```

然后在 C 列中，使用

```
=COUNTIF(A:A, B1) 
```

并将它们复制到所有行列 C 中。

编辑：如果这对您不起作用，请尝试使用分号而不是逗号：

```
=COUNTIF(A:A; B1) 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2012-09-02T05:21:35.933

尝试：

`=ArrayFormula(QUERY(A:A&{"",""};"select Col1, count(Col2) where Col1 != '' group by Col1 label count(Col2) 'Count'";1))`

* * *

22/07/2014 上个月的某个时候，Sheets 开始支持更灵活的数组串联，使用嵌入式数组。所以解决方案可以稍微缩短为：

`=QUERY({A:A,A:A},"select Col1, count(Col2) where Col1 != '' group by Col1 label count(Col2) 'Count'",1)`

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2012-08-26T13:48:01.853

```
=COUNTIF(A:A;"lisa") 
```

您可以将条件替换为 B 列中的单元格引用

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-01-02T01:39:40.510

如果需要，只需添加一些额外的排序

```
=QUERY(A2:A,"select A, count(A) where A is not null group by A order by count(A) DESC label A 'Name', count(A) 'Count'",-1) 
```

[![在此处输入图像描述](../Images/ea4468f740c0b1965aac372d42a33392.png)](https://i.stack.imgur.com/D8UaB.png)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-04-23T23:32:06.347

```
=arrayformula(if(isblank(B2:B),iferror(1/0),mmult(sign(B2:B=TRANSPOSE(A2:A)),A2:A))) 
```

我从一个很好的教程中得到这个 - 不记得标题 - 可能是关于使用 MMult

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-24T06:31:25.727

将以下内容放在 B3 中（归功于 @Alexander-Ivanov 的 countif 条件）：

```
={UNIQUE(A3:A),ARRAYFORMULA(COUNTIF(UNIQUE(A3:A),"=" & UNIQUE(A3:A)))} 
```

好处：只需要编辑1个单元格，包含唯一性过滤的名称，简洁。

缺点：它运行独特的功能 3x

要仅使用唯一功能一次，请将其拆分为 2 个单元格：

B3：`=UNIQUE(A3:A)`

C3：`=ARRAYFORMULA(COUNTIF(B3:B,"=" & B3:B))`

# php - Wordpress 小部件输入栏

> ID：12125849
> 
> 赞同：0
> 
> 时间：2012-08-25T21:37:18.587
> 
> 标签：php, wordpress, widget

一直在研究 wordpress 插件（我一直在阅读教程，但它们都用我不太明白的术语说话），这对我来说都是学习曲线的一部分。

```
<?php
/*
Plugin Name: Server status Plugin
Plugin URI: http://minepress.co.uk
Description: Minepress is a site which allows users to start up a free Minecraft website   for their server. This plugin shows the server status
Version: 0.01
Author: Bradly Spicer
Author URI: http://minepress.co.uk
*/
?> 
```

那显然是外壳，我想做它，所以无论人们输入什么，它都会被放入这个 html 中：

```
[b]Server Status:[/b] [img]http://res.public-craft.com/hb.php?ip=YOUR_IP&port=YOUR_PORT&on=OPTIONAL_ONLINE_IMAGE&off=OPTIONAL_OFFLINE_IMAGE[/img] 
```

我认为这将遵循以下原则：

```
<h3>Server Status:</h4> <img = "http://res.public-craft.com/hb.php?ip=<?php $Ipaddress?>&port=<?php$Port?>&on=http://minepress.co.uk/images/on.png&off=http://minepress.co.uk/images/off.png"</img> 
```

我真的不知道我会如何融入它

多谢你们

忘了提及我之前遵循了一个教程并得出了这个：

```
<?php
include('config.php');

Class ServerStatus extends WP_Widget
{
    function ServerStatus()
    {

    }

    function widget($args, $instance)
    {
        extract(   $args, EXTR_SKIP );
        $title = ( $instance['title']) ? $instance['title'] : 'Server Status';
        $body = ( $instance['body']) ? $instance['body'] : 'Server Status Body';
        ?>
        <?php echo $before_widget; ?>
        <?php echo $before_title . $title . $after_title ?>
        <p><?php echo $body ?></p>

error_reporting(E_ALL);
add_action("widgets_init", array('Server_Status', 'register'));
class Widget_name {
  function control(){
    echo 'I am a control panel';
  }
  function widget($args){
    echo $args['before_widget'];
    echo $args['before_title'] . 'Your widget title' . $args['after_title'];
    echo 'I am your widget';
    echo $args['after_widget'];
  }
  function register(){
    register_sidebar_widget('Widget name', array('Server_Status', 'widget'));
    register_widget_control('Widget name', array('Server_Status', 'control'));
  }
}

add_option($name, $value);
update_option($name, $new_value);
delete_option($name);

error_reporting(E_ALL);
add_action("widgets_init", array('Server_Status', 'register'));
register_activation_hook( __FILE__, array('Server_Status', 'activate'));
register_deactivation_hook( __FILE__, array('Server_Status', 'deactivate'));
class Widget_name {
  function activate(){
    $data = array( 'option1' => 'Default value' ,'option2' => 55);
    if ( ! get_option('Server_Status')){
      add_option('Server_Status' , $data);
    } else {
      update_option('Server_Status' , $data);
    }
  }
  function deactivate(){
    delete_option('widget_name');
  }
  function control(){
    echo 'I am a control panel';
  }
  function widget($args){
    echo $args['before_widget'];
    echo $args['before_title'] . 'Your widget title' . $args['after_title'];
    echo 'I am your widget';
    echo $args['after_widget'];
  }
  function register(){
    register_sidebar_widget('Widget name', array('Server_Status', 'widget'));
    register_widget_control('Widget name', array('Server_Status', 'control'));
  }
}

function control(){
  $data = get_option('Server_Status');
  ?>
  <p><label>Option 1<input name="Server_Status_option1"
type="text" value="<?php echo $data['option1']; ?>" /></label></p>
  <p><label>Option 2<input name="Server_Status_option2"
type="text" value="<?php echo $data['option2']; ?>" /></label></p>
  <?php
   if (isset($_POST['widget_name_option1'])){
    $data['option1'] = attribute_escape($_POST['Server_Status_option1']);
    $data['option2'] = attribute_escape($_POST['Server_Status_option2']);
    update_option('Server_Status', $data);
  }
} 
```

目标：目标是让用户在管理面板中输入他们的服务器 ip 和端口（两个单独的输入字段）。然后调用它们并将其放入上述任一脚本中。我想会是

```
<h3>Server Status:</h4> <img = "http://res.public-craft.com/hb.php?ip=<?php $Ipaddress?>&port=<?php$Port?>&on=http://minepress.co.uk/images/on.png&off=http://minepress.co.uk/images/off.png"</img> 
```

但我不知道如何使 $Ipaddress 和 $Port 成为他们输入的任何内容。

# java - 如何创建一个由 JLayeredPane 组成的 JFrame，并且能够在 Applet 上绘图？

> ID：12125852
> 
> 赞同：0
> 
> 时间：2012-08-25T21:37:46.590
> 
> 标签：java, applet, draw, jlayeredpane

我正在尝试创建一个 GUI，我可以在其中根据 Applet 中的内容在 Applet 的“上方”绘制。为了测试这一点，我试图通过使用 JLayeredPane 创建一个带有填充背景的面板来填充一个简单的矩形，以显示在小程序上。我无法让它工作，但我尝试了它。

```
import java.applet.Applet;
import java.awt.Color;
import java.awt.GridLayout;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLClassLoader;
import javax.swing.JFrame;
import javax.swing.JLayeredPane;
import javax.swing.JPanel;

public class GUI {

private static JFrame frame;
private static JLayeredPane layers;
private static JPanel panel;
private static Applet applet;
private static final String JAR_PATH = "file:C:/Applet.jar";

public static void main(String args[]) throws MalformedURLException, ClassNotFoundException, InstantiationException, IllegalAccessException{
    ClassLoader clientClassLoader = new URLClassLoader(new URL[]{new URL(JAR_PATH)});
    Class<?> client = clientClassLoader.loadClass("Loader");
    frame = new JFrame("JLayeredPane Testing");
    frame.setSize(400, 400);
    frame.setResizable(false);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setLayout(new GridLayout());
    applet = (Applet) client.newInstance();
    layers = new JLayeredPane();
    panel = new JPanel();
    panel.setSize(200, 200);
    panel.setOpaque(true);
    panel.setBackground(Color.BLACK);
    layers.add(panel, JLayeredPane.PALETTE_LAYER);
    layers.add(applet, JLayeredPane.DRAG_LAYER);
    frame.setContentPane(layers);
    frame.setVisible(true);
    applet.init();
}

} 
```

当我运行我的程序时，小程序不显示或初始化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T22:31:48.903

我会说您应该尝试将小程序的内容绘制到缓冲图像。 `BufferedImage buf=new BufferedImage(width, height, BufferedImage.TYPE_INT_ARGB);` 覆盖 jframe 中的绘制

```
public void paint(Graphics g){
   applet.paint(buf.getGraphics());
   g.drawImage(buf, 0, 0, this);
   super.paint(g);
} 
```

然后您可以在顶部添加 Swing 组件。还要弄清楚您需要将哪些事件转发到小程序。使用`applet.get____Listeners()`（如getMouseListeners、getKeyListeners等）获取小程序的事件监听器。然后将事件转发给监听器。

# javascript - 使用 JavaScript 正则表达式对象检查字符串是否有 1 到无限重复的星号 (*)

> ID：12125853
> 
> 赞同：-2
> 
> 时间：2012-08-25T21:38:18.293
> 
> 标签：javascript, regex

我在正则表达式方面完全是垃圾，我需要一些帮助来完成一项任务。如何使用 javasctipt regex 对象检查字符串中的单个字符重复（在我的情况下为 *）。

具体来说，我需要检查一个字符串是否有 1 到 n 个 * 字符的重复。如果上述情况为真，则返回真。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T21:40:32.910

恐怕这是相当微不足道的：

```
/\*+/.test("*");           // true
/\*+/.test("hello world"); // false 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T21:43:35.233

如果你想知道有多少 & 它们可以被分开，你可以计算`*`一个字符串中的数量（使用正则表达式）

```
"_*_*_*_*_".match(/\*/g).length; // 4 
```

然后比较`n`

# javascript - 如何取消警报框？

> ID：12125862
> 
> 赞同：1
> 
> 时间：2012-08-25T21:40:08.297
> 
> 标签：javascript

我可以显示一个警告框，如下所示：`alert('Please wait 5 seconds');`。

如果用户到那时还没有使用 JavaScript 单击“确定”，有没有办法在 5 秒后删除此警告框？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T21:42:32.817

不，你不能那样做。

作为替代方案，您可以在 UI 中创建某种模式窗口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T21:47:55.750

当触发本机 JS 警报对话框时，浏览器会停止每一次，直到用户单击“确定”，这也适用于 confirm() 功能。

我推荐使用 jQuery 的 UI 对话框组件：http: [//jqueryui.com/demos/dialog/](http://jqueryui.com/demos/dialog/)

高度可配置的、模态的、非模态的、大小，当然还有供您使用...定时间隔。哎呀，您甚至可以添加一个漂亮的倒计时计时器！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T21:49:05.157

据我所知，没有办法使用浏览器警报窗口来做到这一点。当警告框为“正在警告”时，无法执行 JavaScript。但是，您可以使用带有 close() 方法的 UI 元素，因为这样的元素的显示不会阻止浏览器执行您的 JavaScript。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-25T21:54:39.863

无法删除警报，您可以做的是使用 jquery 制作自定义警报。使用 jquery，您可以自定义您的警报主题，并使用一个简单的命令（如 fadeOut()）来决定如何删除它；

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-09-05T00:12:43.993

这可能对海报毫无帮助，但我敢打赌，一些发现者的读者会因此而火上浇油：重新加载显示警报框的脚本。

为此，您应该添加一个触发警报框的不可见框架，然后重新加载该框架而不会影响您亲爱的首页......甚至不确定这是否有效，我会尝试回到这个......

# c# - 如何仅选择在一列中具有唯一值的行？

> ID：12125864
> 
> 赞同：2
> 
> 时间：2012-08-25T21:40:16.607
> 
> 标签：c#, linq-to-sql, distinct

考虑这个示例数据：

```
field1  field2  
1       100  
2       100  
3       101  
4       102  
5       102  
6       103 
```

我只想选择其中值`field2`仅出现一次的记录。上述所需返回数据的一个示例是：

```
field1  field2  
3       101  
6       103 
```

这将如何使用 LINQ to SQL 完成？

--- 编辑 -------
大家好，谢谢您的回复。我特意提供了简化的数据来找到我问题的根源。我认为所有这些答案都会根据我的示例数据返回所需的结果，我会将它们标记为所有答案。

但是在我的真实数据场景中，使用我从您的回复中学到的东西，我有这样的事情：

```
var RefinedSource =  from a in dSource
                     group a by a.AssetID into g
                     where g.Count() == 1
                     select new
                     {
                          AssetID = g.Key,
                          AssetType = g.Min(a => a.AssetType),
                          IPInfo = AppUtility.GetIPInfo(g.Key),
                          Hostname = AppUtility.GetServerName(g.Key),
                          DeviceID = g.Min(a => a.DeviceID).ToString(),
                          Environment = AppUtility.GetSolutionAndEnvironmentNames(g.Key),
                          Manufacturer = g.Min(a => a.Manufacturer),
                          MakeModel = g.Min(a => a.MakeModel),
                          Location = g.Min(a => a.Location),
                          count = g.Count()
                     }; 
```

所以我担心所有的 .min() 调用......我推断这些是必要的，因为分组？有人可以解释为什么需要这些吗？在我的简单示例中，我认为它们不是问题，但是对于我的真实数据，多次调用 min() 只是为了能够包含我需要的所有字段数据......这似乎不是好的。

分组允许我测试我需要的条件（用于识别重复值的计数），但我如何更直接地使用这样的条件，而只是直接访问我真正的基础数据行？

例如，看看我刚才提供的示例，我希望能够只使用原始“from a in dSource”部分中的 a.FieldName，但是在引入“group by”之后您将无法访问它?

再次感谢您提供的信息，我将标记为答案，但是如果有人可以解释对 min() （或 max 或其他）的所有调用的需要，我也会很感激它，看看我的真实数据，这仍然是我应该走的路吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T21:43:48.403

下面是它在 SQL 中的实现方式（有时使用 SQL 更快）：

```
 SELECT max(field1), field2
 FROM table
 GROUP BY field2
 HAVING count(field2) = 1 
```

在 sql server 中使用窗口函数的示例
（注意，现在无法测试 OVER 子句可能需要在 where 中）：

```
 SELECT COUNT() OVER(PARTITION BY field2) AS [field2Count], *
 FROM table
 WHERE [field2Count] = 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T21:48:00.337

```
from r in tables
  group r.field2 by r.field1 into grp
  where grp.Count() == 1
  select new {grp.First(), grp.Key} 
```

我会仔细检查这是否执行了一个 SQL 调用。它应该，如果是这样，我会把它保留在这里，因为它`First`是一种非常常用的 Linq 方法，并且当在给定的情况下有几十个同样好的东西可以使用时，应该喜欢熟悉的。如果它确实导致了多个 SQL 调用（同样，我会感到惊讶），然后尝试使用`Max()`or`Min()`而不是`First()`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T21:52:10.080

你`LINQ`可以简单地做：

```
var groups = list.GroupBy(r => r.Value).Where(grp => grp.Count() == 1);

foreach(var gr in groups){
   var field1 = gr.Key;      // KEY: is your FIELD1
   var field2 = gr.Value;    // VALUE: is your FIELD2
} 
```

# asp.net-mvc - 用户关闭浏览器时 ASP.net MVC 4 会话 cookie 过期

> ID：12125868
> 
> 赞同：0
> 
> 时间：2012-08-25T21:40:55.560
> 
> 标签：asp.net-mvc, session, cookies, lifetime

我和[这个人](https://stackoverflow.com/questions/3102241/authentication-session-cookie-deleting-after-browser-close)有同样的问题。因为我很幸运，他的解决方案也对我有用。但我认为它有点脏，我想知道是否没有更好的。

我已经在 IIS 上设置了这个配置，但是当用户关闭她的浏览器时，cookie 总是会过期（如果我不使用他的“cookie hack”）

![显示我的 IIS 配置的图像](../Images/94a59d8a7a894bb8525e291181d8f2b4.png)

**有任何想法吗？**

**编辑：**清除：丢失的不是服务器端会话，它只是“ASP.NET_SessionId”cookie 生命周期，这是不正确的。

**EDIT2：**经过一些研究，我想知道`ASP.NET_SessionId`cookie 是什么时候设置的。如果我将其删除（使用 Firefox）并刷新页面（甚至多次），则不会出现新页面……这是怎么回事？

**EDIT3：**我刚刚发现，如果我将某些内容放入会话中，会话 ID cookie 将被设置，因此该问题（EDIT2）已关闭。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:58:33.660

出于安全原因，会话 cookie 将尽快过期。不应由于[会话劫持](http://de.wikipedia.org/wiki/Session_Hijacking)而延长其生命周期。

如果您需要“返回旧会话”，则使用 ASP.NET 身份验证并在用户返回站点后生成新会话。这将保护内存并提高整体安全性。

# java - 如何在java中创建一个方法的监听器

> ID：12125870
> 
> 赞同：2
> 
> 时间：2012-08-25T21:41:31.757
> 
> 标签：java, listener

我在实现方法的侦听器时遇到了非常糟糕的时间。

在我目前的工作中，我必须每 5 秒请求一个方法以验证新信息，所以我想实现一个方法来通知我，每次有新信息出现时，每 5 秒丢弃一次请求方法。

（我已经阅读了观察者模式，但没有成功实施。）

最好的祝福

更多信息：现在我从 smack XMPP 库中重写此方法，以便将新消息存储在 msgs 队列中

```
public void processMessage(Chat chat, Message message) {
    if (message.getType() == Message.Type.chat) {
        req = message.getBody().toString();
        String[] temp = { chat.getParticipant().toString(), req };
        System.out.println(temp[0]+"says:"+temp[1]);
        synchronized (lock) {
            msgs.add(temp);
        }
    }
} 
```

而且我每 0.5 秒执行一次此方法以验证新消息：

```
public String[] getMessage() {
    synchronized (lock) {
        String[] data;
        data=msgs.poll();
        return data;
    }
} 
```

我正在尝试设置一个通知系统，每次执行 processMessage 时都会通知我。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-27T14:12:58.573

好的，我设法解决了我的问题。

我实现了一个基于观察者模型的监听器。为此，我必须实现一个名为 XMPPmessageListener 的接口：

```
public interface XMPPmessageListener {
    public void readMsg(String senderJID, String msg); 
} 
```

与 XmppHandler 类相比，方法 processMessage 和 getMessage 的类我添加了添加和删除侦听器的方法以及存储侦听器的 LinkedList：

```
private LinkedList<XMPPmessageListener> listeners = new LinkedList<XMPPmessageListener>();

public void addMsgListener(XMPPmessageListener listener){
    listeners.add(listener);
}

public boolean removeMsgListener(XMPPmessageListener listener){
    return listeners.remove(listener);
} 
```

为了警告听众，我在 processMessage 方法中做了一些交流：

```
public void processMessage(Chat chat, Message message) {
    if (message.getType() == Message.Type.chat) {
        for(XMPPmessageListener l: listeners){
            l.readMsg(chat.getParticipant().toString(), message.getBody().toString());
        }
    }
} 
```

现在，每次通过创建 XMPPmessageListener 接收消息时，我都可以在任何方法上收到通知，并通过覆盖 readMsg 方法来决定如何处理该消息：

```
XmppHandler xmpp = new XmppHandler(XMPPuser, XMPPpassword, XMPPaddress, XMPPdomain, XMPPport);

XMPPmessageListener msglistener = new XMPPmessageListener() {

                @Override
                public void readMsg(String senderJID, String msg) {
                    String asw=xmlHandler.processMsg(msg,senderJID);

                }
            };
            xmpp.addMsgListener(msglistener); 
```

# java - 连接 USB 时将文件从我的 android 设备传输到我的计算机？

> ID：12125873
> 
> 赞同：-1
> 
> 时间：2012-08-25T21:41:46.860
> 
> 标签：java, android, file-transfer

我现在正在android上编写一个项目，我的程序必须能够将文件传输/替换到具有特定地址的计算机，以将我的应用程序与我的计算机上的应用程序同步，并且只需按一个按钮即可反转（从PC到设备）在我的程序中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T22:01:57.943

使用[http://developer.android.com/tools/help/adb.html#forwardports](http://developer.android.com/tools/help/adb.html#forwardports)通过 USB 电缆转发 TCP/IP 连接。您手机上的应用程序可以充当 TCP 服务器并接收任意命令。

此解决方案的缺点是您必须将 adb 可执行文件与您的程序捆绑在一起，并且用户必须安装正确的驱动程序（这意味着大容量存储连接是不够的）。如果需要，可以使用 adb 的源。

# ios - iOS 6 强制方向

> ID：12125875
> 
> 赞同：5
> 
> 时间：2012-08-25T21:41:59.463
> 
> 标签：ios, ios5, ios6

在 iOS5 中，您可以使用此代码段来强制定向：

```
UIViewController *c = [[UIViewController alloc]init];
[self presentModalViewController:c animated:NO];
[self dismissModalViewControllerAnimated:NO];
[c release]; 
```

然而，这会在 iOS6 中导致 EXC_BAD_ACCESS。如何在 iOS6 中强制某个方向？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-26T19:38:11.907

只是为了完成前面的答案，你应该这样做：

```
UIViewController *viewController = [[UIViewController alloc] init];
[self presentViewController:viewController animated:NO completion:^{
    [viewController dismissModalViewControllerAnimated:NO];
}]; 
```

iOS 6 不再受保密协议约束。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T13:49:26.123

如果有人仍然关心这个，这里是 iOS6 代码片段（我把它放在我的 viewDidLoad 例程中）：

```
UIViewController *viewController    = [[UIViewController alloc] init];
viewController.modalTransitionStyle = UIModalTransitionStyleCoverVertical;
[self presentViewController:viewController animated:NO completion:^{
    [self dismissViewControllerAnimated:NO completion:nil];
}]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-25T21:49:44.597

起初`presentModalViewController`并且`dismissModalViewControllerAnimated`已被弃用，iOS6 可能无法正确使用这些方法。您应该使用类似的方法来代替[编译块。](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/presentViewController%3aanimated%3acompletion%3a)

第二件事是`[self dismissModalViewControllerAnimated:NO];`首先试图解雇自己。在你的情况下这是正确的吗？

最后一件事 iOS6 在 NDA 之下

# mapreduce - 在倒排索引中分配 DocIds，mapreduce

> ID：12125876
> 
> 赞同：1
> 
> 时间：2012-08-25T21:42:19.633
> 
> 标签：mapreduce

如何在使用 map reduce 创建倒排索引时分配 docIds？我在单机上实现这一点的方法是拥有一个全局计数器。我无法使用 map-reduce 框架提出类似的解决方案。Zookeeper 可能是可能的解决方案，但我们可以做到这一点。

# r - 忽略错误并为列表赋值

> ID：12125879
> 
> 赞同：0
> 
> 时间：2012-08-25T21:42:32.953
> 
> 标签：r

我正在使用 fitdistrplus 包的 fitdist 函数。对于某些发行版，我得到一个错误。我不介意我只是希望程序不要停止，并为变量赋值并继续。

根据我的帮助，我的代码如下所示：

```
i=1
for (data in results)
  for (dist in distributions)
    resultst[[i]] <- tryCatch(
      fitdist( data, dist,method="mle",
           start=list(mean=mapply("[[", results[i], 1),
                      sd=mapply("[[", results[i], 2)),
           fix.arg=list(a=minv,b=maxv)),
           error = function(e) results[[i]])
       i=i+1 
```

但是得到这个错误：

```
Error in resultst[[i]] <- tryCatch(fitdist(data, dist, method = "mle",  :
more elements supplied than there are to replace 
```

解决方案：

```
i=1
for (data in results)
  for (dist in distributions)
  params <- tryCatch(
  fitdist( data, dist,method="mle",
           start=list(mapply("[[", results[i], 1),
                      mapply("[[", results[i], 2)),
           fix.arg=list(a=minv,b=maxv)),
           error = function(e) {
             fitdist( data, substring(dist,2),method="mle",
                      start=list(mapply("[[", results[i], 1),
                                 mapply("[[", results[i], 2)))
           })
resultst[i]<-params
resultst2[[i]]<-params
i=i+1 
```

编辑将 i=0 更改为 i=1 （我的错误！）包括参数

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T23:37:17.933

正如 Dason 评论的那样，`tryCatch`应该会有所帮助：

```
List2[[i]] <- tryCatch(
                    fitdist( data, dist,method="mle",
                          start=list(mean=x,
                                     sd=y,
                          fix.arg=list(a=minv,b=maxv)),
                    error = function(e) List1[[i]] 
              ) 
```

# python - 更改直方图 matplotlib 中的默认 x 范围

> ID：12125880
> 
> 赞同：47
> 
> 时间：2012-08-25T21:42:57.000
> 
> 标签：python, matplotlib, histogram, xrange

我想更改直方图的默认 x 范围。数据的范围是从 7 到 12。但是，默认情况下，直方图从 7 开始，到 13 结束。我希望它从 6.5 开始，到 12.5 结束。但是，刻度应该从 7 变为 12。我该怎么做？

```
import asciitable 
import numpy as np
import matplotlib.pyplot as plt
import matplotlib.mlab as mlab
import pylab
from pylab import xticks

data = asciitable.read(file)
hmag = data['col8']
visits = data['col14']
origin = data['col13']

n, bins, patches = plt.hist(hmag, 30, facecolor='gray', align='mid')
xticks(range(7,13))
pylab.rc("axes", linewidth=8.0)
pylab.rc("lines", markeredgewidth=2.0) 
plt.xlabel('H mag', fontsize=14)
plt.ylabel('# of targets', fontsize=14)
pylab.xticks(fontsize=15)
pylab.yticks(fontsize=15)
plt.grid(True)
plt.savefig('hmag_histogram.eps', facecolor='w', edgecolor='w', format='eps')
plt.show() 
```

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-08-25T23:35:09.317

```
plt.hist(hmag, 30, range=[6.5, 12.5], facecolor='gray', align='mid') 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2017-08-29T16:44:35.297

```
import matplotlib.pyplot as plt

...

plt.xlim(xmin=6.5, xmax = 12.5) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-07-11T14:03:56.483

以下代码用于在两个子图上设置相同的 y 轴限制

```
f ,ax = plt.subplots(1,2,figsize = (30, 13),gridspec_kw={'width_ratios': [5, 1]})
df.plot(ax = ax[0], linewidth = 2.5)
ylim = [lower_limit,upper_limit]
ax[0].set_ylim(ylim)
ax[1].hist(data,normed =1, bins = num_bin, color = 'yellow' ,alpha = 1) 
ax[1].set_ylim(ylim) 
```

提醒`plt.hist(range=[low, high])`一下，如果指定范围大于数据点的最大值和最小值，直方图会自动裁剪范围。所以如果你想指定y轴范围号，我更喜欢使用`set_ylim`

# jquery - jquery分页滚动到顶部

> ID：12125883
> 
> 赞同：1
> 
> 时间：2012-08-25T21:43:32.377
> 
> 标签：jquery

我正在使用附加的代码进行分页，我试图添加一个功能来在导航分页时将页面滚动到顶部。我的源脚本在下面，我在这里找到了。

```
 $(document).ready(function () {

        //how much items per page to show
        var show_per_page = 5;
        //getting the amount of elements inside content div
        var number_of_items = $('#content').children().size();
        //calculate the number of pages we are going to have
        var number_of_pages = Math.ceil(number_of_items / show_per_page);

        //set the value of our hidden input fields
        $('#current_page').val(0);
        $('#show_per_page').val(show_per_page);
        var navigation_html = '<ul>';

        navigation_html += '<li class="previous_link">';
        navigation_html += '<a href="javascript:previous();">&larr;</a>';
        navigation_html += '</li>';
        var current_link = 0;
        while (number_of_pages > current_link) {
            navigation_html += '<li class="page_link" id="id' + current_link + '">';
            navigation_html += '<a href="javascript:go_to_page(' + current_link + ')" longdesc="' + current_link + '">' + (current_link + 1) + '</a>';
            current_link++;
            navigation_html += '</li>';
        }
        navigation_html += '<li>';
        navigation_html += '<a class="next_link" href="javascript:next();">&rarr;</a>';
        navigation_html += '</li>';
        navigation_html += '</ul>';

        $('#page_navigation').html(navigation_html);

        //add active class to the first page link
        $('#page_navigation .page_link:first').addClass('active');

        //hide all the elements inside content div
        $('#content').children().css('display', 'none');

        //and show the first n (show_per_page) elements
        $('#content').children().slice(0, show_per_page).css('display', 'block');

    });

function previous() {

    new_page = parseInt($('#current_page').val()) - 1;
    //if there is an item before the current active link run the function
    if ($('.active').prev('.page_link').length == true) {
        go_to_page(new_page);
    }

}

function next() {
    new_page = parseInt($('#current_page').val()) + 1;
    //if there is an item after the current active link run the function
    if ($('.active').next('.page_link').length == true) {
        go_to_page(new_page);
    }

}

function go_to_page(page_num) {
    //get the number of items shown per page
    var show_per_page = parseInt($('#show_per_page').val());

    //get the element number where to start the slice from
    start_from = page_num * show_per_page;

    //get the element number where to end the slice
    end_on = start_from + show_per_page;

    activate_id = page_num;
    var get_box = document.getElementById("id" + page_num);
    //hide all children elements of content div, get specific items and show them
    $('#content').children().css('display', 'none').slice(start_from, end_on).css('display', 'block');

    /*get the page link that has longdesc attribute of the current page and add active class to it
     and remove that class from previously active page link*/
    $("#page_navigation").find('li.active').removeClass("active");
    $(get_box).addClass("active");

    //update the current page input field
    $('#current_page').val(page_num);
} 
```

我试过添加

```
$('#page_navigation .page_link').click(function () {
        $('body,html').animate({
            scrollTop: 0
        }, 600);
        return false;
    }); 
```

这对我来说是一个陌生的领域，所以任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T21:46:59.957

由于两者`previous()`似乎`next()`都使用该`go_to_page()`功能进行导航，似乎最简单的方法是添加：

```
$('body,html').animate({
    scrollTop: 0
}, 600); 
```

在`go_to_page()`函数的最后。这样，无论用户页面是向前还是向后，动画都会在内容切换后发生。

像这样的东西：

```
function go_to_page(page_num) {

    // ... code removed for simplicity ...    

    //update the current page input field
    $('#current_page').val(page_num);

    // Scroll to the top
    $('body,html').animate({
        scrollTop: 0
    }, 600);
} 
```

# r - 在 R 中解析 ISO8601

> ID：12125886
> 
> 赞同：9
> 
> 时间：2012-08-25T21:43:36.390
> 
> 标签：r, date, datetime, posixct

R 中是否存在将[ISO8601](http://en.wikipedia.org/wiki/ISO_8601)字符串解析为 POSIXt 对象的现有实现？ISO8601 规范允许以各种（非重叠）格式打印日期/时间，因此可能需要做一些正则表达式魔术来检测格式并将其提供给`strptime`.

正确地做到这一点实际上可能[非常具有挑战性](http://www.pelagodesign.com/blog/2009/05/20/iso-8601-date-validation-that-doesnt-suck/)，但是检测最常见格式的东西已经非常有帮助了。我很难想象我是第一个遇到这种情况的人，但我很难找到好的实现。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-25T22:10:41.493

严格来说，你不能。我不需要知道任何关于 r 或 cran（甚至它们是什么）的知识来告诉你，因为我对 ISO 8601 的了解足以知道仅仅知道某事是 ISO 8601 不足以明确地知道它的含义通过它，尤其是在较短的形式中。

找出对方正在使用的 ISO 8601*配置文件。*如果他们不知道你在说什么，那么当你指出我在上一段中所说的内容时，你就是在帮他们一个忙。正如我曾经在别处写过的，

> 不幸的是，许多人在听到“ISO 8601”时会想到他们熟悉的特定配置文件，其他人知道使用 8601 是一件好事，但不熟悉实施细节。因此，规范或需求文档可能会提到 8601，但不会比这更明确。在这种情况下，重要的是寻求澄清，而不是假设您认为“ISO 8601”的格式是正确的。

所以，告诉他们“‘ISO 8601’不够具体，我需要确切地知道你在做什么，你对精度的限制是什么。” （可能您对 1582 年之前和可能在 0001 年之前的日期的政策是什么，您的闰秒政策，以及其他一些事情保持开放，但标准）

那么无论你处理什么都应该很容易：除了这一点模棱两可之外，它是一个非常直接的标准。它应该被认为是定义日期格式的标准，而不是定义日期格式的标准。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-25T21:44:48.790

请参阅`.parseISO8601`xts 包中的一种实现。我怀疑这会“开箱即用”，但它应该让您很好地了解如何实现您的特定需求。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-03-08T18:27:57.747

这看起来很有希望：[http ://cran.r-project.org/web/packages/parsedate](http://cran.r-project.org/web/packages/parsedate)

> **parsedate：识别和解析各种格式的日期，包括所有 ISO 8601 格式**
> 
> 自动解析日期，无需指定格式。目前它包括 git 日期解析器。它还可以识别和解析所有 ISO 8601 格式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-20T13:15:56.267

```
t <- strptime("2013-08-20T14:56:37", "%FT%T") 
```

在大多数情况下，对我来说工作得很好。虽然它已经在几分之一秒内失败，并且不包括 Jon Hanna 提到的所有问题的解决方案。（这使得使用时间数据类型变得异常困难。）

# clojure - 在跷跷板上返回 Clojure 动作时出错

> ID：12125888
> 
> 赞同：1
> 
> 时间：2012-08-25T21:43:39.620
> 
> 标签：clojure, action, seesaw

该程序打开一个文件，将其读入列表，然后要求用户一次输入一个列表中的单词，但在它说话后我立即收到错误

```
(ns EKS.Core)
(use '[speech-synthesis.say :as say])
(use '[clojure.java.shell :only [sh]])
(use 'seesaw.core)
(use 'seesaw.dev)
(use 'seesaw.chooser)
(use 'clojure.java.io)
(import 'java.io.File)
(native!)
(defn festival [x](sh "sh" "-c" (str "echo " x " | festival --tts")))
(defn espeak [x] (sh "espeak" x))
(defn mac-say[x] (sh "say" x))
(defn check-if-installed[x] (:exit(sh "sh" "-c" (str "command -v " x " >/dev/null 2>&1 || { echo >&2 \"\"; exit 1; }"))))

(defn env
  "Returns the system property for user.<key>"
  [key]
  (System/getProperty (str "user." key)))

(defn get-lines [fname]
  (with-open [r (reader fname)]
    (doall (line-seq r))))

(defn engine-check[]
(def engines (conj["Google" ]
(if (= (check-if-installed "festival") 0)  "Festival" )
(if (= (check-if-installed "espeak") 0) "ESpeak"   )
(if (= (check-if-installed "say") 0)  "Say"  )))(remove nil? engines))
(engine-check)

(def ListDir  (str (env "home") ))
(def speak say)

(defn setup-list[ file](
 (def ListEntry (remove #{""}  (get-lines (.getAbsolutePath file))))
 (speak (str "Enter the word " (first ListEntry)))
 (.getAbsolutePath file)
 (def current 0)))

(def Open-Action (action :handler (fn [e] (choose-file :type :open :selection-mode :files-only :dir ListDir :success-fn (fn [fc file](setup-list file))))
:name "Open"
:key "menu O"
:tip "Open  list"))

(def entry-text(text :id :entry :text "" ))

(defn check-word[] ((if (= (text entry-text) (nth ListEntry current))(speak "correct")(speak "incorrect"))(def current (+ current 1))(speak (str "Enter the word " (nth ListEntry current)))))

(def Main-Panel(grid-panel :vgap 7 :hgap 20 :border "Main" :items[ (top-bottom-split  entry-text
        (left-right-split (grid-panel :vgap 7 :items[(label :text "Correct: 0") (label :text "Incorrect: 0")]) (grid-panel :vgap 7 :items[(button :text "Next"
            :mnemonic \N
            :listen [:action (fn [e] (check-word))]) 
           (button :text "Repeat!"
            :mnemonic \\
            :listen [:action (fn[e] (speak(nth ListEntry current)))])
                                           ])   :divider-location 1/3 )
          :divider-location 1/3 )]))

(def Main-Window(frame :title "??????", :on-close :exit, :size[425 :by 172]:menubar(menubar :items[(menu :text "File" :items [Open-Action ])]) :content Main-Panel ))

(show! Main-Window) 
```

这是我打开文件时收到的错误消息

```
 Exception in thread "AWT-EventQueue-0" java.lang.ClassCastException: clojure.lang.LazySeq cannot be cast to clojure.lang.IFn
    at clojure.lang.Var.fn(Var.java:378)
    at clojure.lang.Var.invoke(Var.java:409)
    at EKS.Core$setup_list.invoke(NO_SOURCE_FILE:38)
    at EKS.Core$fn__5794$fn__5795.invoke(NO_SOURCE_FILE:42)
    at seesaw.chooser$choose_file.doInvoke(chooser.clj:173)
    at clojure.lang.RestFn.invoke(RestFn.java:619)
    at EKS.Core$fn__5794.invoke(NO_SOURCE_FILE:42)
    at seesaw.action$action$fn__1218.invoke(action.clj:90)
    at seesaw.action.proxy$javax.swing.AbstractAction$0.actionPerformed(Unknown Source)
    at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:2018)
    at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2341)
    at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:402)
    at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:259)
    at javax.swing.AbstractButton.doClick(AbstractButton.java:376)
    at javax.swing.plaf.basic.BasicMenuItemUI.doClick(BasicMenuItemUI.java:833)
    at javax.swing.plaf.basic.BasicMenuItemUI$Handler.mouseReleased(BasicMenuItemUI.java:877)
    at java.awt.AWTEventMulticaster.mouseReleased(AWTEventMulticaster.java:289)
    at java.awt.Component.processMouseEvent(Component.java:6505)
    at javax.swing.JComponent.processMouseEvent(JComponent.java:3321)
    at java.awt.Component.processEvent(Component.java:6270)
    at java.awt.Container.processEvent(Container.java:2229)
    at java.awt.Component.dispatchEventImpl(Component.java:4861)
    at java.awt.Container.dispatchEventImpl(Container.java:2287)
    at java.awt.Component.dispatchEvent(Component.java:4687)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4832)
    at java.awt.LightweightDispatcher.processMouseEvent(Container.java:4492)
    at java.awt.LightweightDispatcher.dispatchEvent(Container.java:4422)
    at java.awt.Container.dispatchEventImpl(Container.java:2273)
    at java.awt.Window.dispatchEventImpl(Window.java:2719)
    at java.awt.Component.dispatchEvent(Component.java:4687)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:713)
    at java.awt.EventQueue.access$000(EventQueue.java:104)
    at java.awt.EventQueue$3.run(EventQueue.java:672)
    at java.awt.EventQueue$3.run(EventQueue.java:670)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:87)
    at java.awt.EventQueue$4.run(EventQueue.java:686)
    at java.awt.EventQueue$4.run(EventQueue.java:684)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:683)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:244)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:163)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:151)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:147)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:139)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:97) 
```

这是我正在使用的测试文件

```
this
here
word 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T00:11:57.090

我认为导致回溯的原因是：

```
(defn setup-list[ file](
  (def ListEntry (remove #{""}  (get-lines (.getAbsolutePath file))))
  (speak (str "Enter the word " (first ListEntry)))
  (.getAbsolutePath file)
  (def current 0))) 
```

注意后面的括号`[ file]`。您正在调用 def （这可能不是您的意思），但是该 def 的结果是一个惰性序列（因为`remove`），并且由于该括号而被称为函数。不幸的是，不清楚你想用 做什么`setup-list`，否则我会为你写一些更惯用的东西。

还有一些其他的事情你应该考虑。首先，不要`(def ...)`在形式非常糟糕的函数中使用。在这种情况下，我认为您真正想要的是`(let ...)`：

```
(defn setup-list [file]
  (let [entries (get-lines (.getAbsolutePath file))]
    ...)) 
```

如果您可以为代码保留更多结构，它还将帮助您了解发生了什么。我认为格式化让像括号这样的东西隐藏起来，如果你有更好的风格，它可能会更明显：

```
(defn setup-list [file]
  ((def ListEntry ...)
    ...)) 
```

在这里，更清楚的是 def 将用作函数调用，这可能不是您想要的。

顺便说一句，Clojure 有一些[库编码标准](http://dev.clojure.org/display/design/Library+Coding+Standards)。他们那里有一些好东西。和Seesaw 一样， [Ring](https://github.com/ring-clojure/ring)是一个很好的代码库示例。

# c# - 用于编译 DLL 的不太严格的 CodeDomProvider

> ID：12125895
> 
> 赞同：0
> 
> 时间：2012-08-25T21:45:10.877
> 
> 标签：c#, dll, compiler-construction, compiler-errors, codedom

有没有办法使用 CodeDomProvider 进行不太严格的编译？我正在尝试使用以下方法将 dll 文件编译并加载到我已经运行的程序中：

```
public static String Compile(string commandName, string source = "")
 {
        private static CodeDomProvider compiler = new CSharpCodeProvider(new Dictionary<string, string>() { { "CompilerVersion", "v3.5" } });
        private static CompilerParameters parameters = new CompilerParameters();
        parameters.GenerateExecutable = false;
        parameters.MainClass = commandName;
        parameters.OutputAssembly = dll;
        parameters.ReferencedAssemblies.Add("MCLight_.dll");
        parameters.CompilerOptions = "/optimize";
        parameters.WarningLevel = 4;
        parameters.TreatWarningsAsErrors = false;
        StreamReader sr = new StreamReader(sourcepath + "cmd" + commandName + ".cs");
        results = compiler.CompileAssemblyFromSource(parameters, sr.ReadToEnd());
        .....
 } 
```

问题是错误，例如：

错误 #CS0122 消息：“MCLight.Independent”由于其保护级别而无法访问 行：1178

和

错误 #CS1501 消息：方法“查找”没有重载采用“1”参数行：617

被抛出。

现在我知道一个事实，当我在 VS 中将它编译为我的解决方案的一部分时，这个类编译得很好。但是当单独编译时，它会抛出这些错误。有没有办法让编译器忽略这些错误，因为我知道它会很好地挂接到应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T21:48:38.607

您可以尝试将警告级别设置得更低：

```
 parameters.WarningLevel = 1; 
```

但是如果不查看您正在编译的代码源，就很难确定。

# php - php OO中的变量范围和发送参数

> ID：12125899
> 
> 赞同：0
> 
> 时间：2012-08-25T21:45:40.643
> 
> 标签：php, oop, parameters, scope

我对通过 PHP OO 的页面使用参数感到非常困惑。我正在关注有关创建框架的教程（就像 Zend 框架一样）；但是，我不明白什么时候发生这种情况：

例如，索引：

```
// File: sourcefiles/index.php

define('DS', DIRECTORY_SEPARATOR);
define('ROOT', realpath(dirname(__FILE__)).DS );
define ('APP_PATH',(ROOT.'aplicacion'));

require_once APP_PATH. DS.'Config.php';
require_once APP_PATH. DS.'Request.php';
require_once APP_PATH. DS.'BootStrap.php';
require_once APP_PATH. DS.'Controller.php';
require_once APP_PATH. DS.'View.php';

try
{
    BootStrap::run(new Request()); 
```

我有：

```
 // File: sourcefiles/controladores/IndexController.php
 <?php
        class IndexController extends Controller
        {
            public function __construct() {
                parent::__construct();
            }

            public function indexAction() 
            {
                 $this->view->titulo='Homepage';
                 $this->view->contenido='Whatever';
                 $this->view->renderizar('index');   
            }
        }
   ?> 
```

和这个：

```
// file : sourcefiles/aplicacion/View.php
<?php

class View
{
    private $controlador;
    private $layoutparams;

    public function __construct(Request $peticion)
    {
        $this->controlador = $peticion->getControlador();
    }

    public function renderizar($vista,$item=false)
    {
        $rutaview = ROOT.'vistas'.DS.$this->controlador.DS.$vista.'.phtml';

        if (is_readable($rutaview))
        {
            include_once $rutaview;
        }
        else
        {
            throw new Exception('Error de vista');
        }
    }
}
?> 
```

这是视图：

```
// file : sourcefiles/vistas/index/index.phtml

<h1>
    Vista index..
    <?php
    echo $this->titulo;
    echo $this->contenido;
    ?>
</h1> 
```

现在我的问题是：

IndexController 可以如何使用该行？`$this->view->titulo = blabla;` 视图类没有“titulo”属性；但是，我可以做到。但这是一件奇怪的事情，如果我在调用 之后这样做`$this->view->renderizar('index')`，我会收到错误消息。

index.phtml 文件是如何知道这一点的？`echo $this->titulo;`因为，没有调用 include 或 require，这让我感到困惑。

当我在文件中执行 require 或 include 调用时，所需或包含的文件知道调用者的变量吗？

如果有人可以向我解释这些，我将不胜感激：D 或将我链接到有关此的官方信息的讨论，或者如何称呼它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T22:11:50.187

将一行`include`或`require`一行视为将代码从一个文件“复制并粘贴”到另一个文件中。这不是很准确，但它解释了这里的部分行为：

在`sourcefiles/aplicacion/View.php`你包括`sourcefiles/vistas/index/index.phtml`while**里面**的功能`View->renderizar`。因此，所有代码都`index.phtml`被加载，就好像它也在该函数内部发生一样。例如，这就是您可以访问的原因`$this`。

至于`$this->view->titulo`在你没有定义的时候引用，这是PHP让你偷懒。就像任何变量一样，对象上的成员会在您提及它时立即生效，只有一个通知警告您可能犯了错误。

# python - 将先前的参数传递到下一个 django 模板请求

> ID：12125901
> 
> 赞同：1
> 
> 时间：2012-08-25T21:46:03.270
> 
> 标签：python, django, django-templates, parameter-passing

我有一个项目按一定顺序列出了许多项目。此顺序由通过参数传递的两个变量确定：

```
<a class="btn btn-info" href={{ request.path }}?key={{ key }}&orientation={{ orientation }}><i class="icon-wrench icon-large"></i></a> 
```

“key”是项目特征，“orientation”是升序或降序。python 代码处理传递回模板的项目的顺序。

我有另一个需要通过时间限制的控件：

```
<a href={{ request.path }}?time={{ time }}>{{ value }}</a> 
```

其中 time 是分钟数。

这里的问题是，如果用户单击排序链接，然后单击时间链接，{{ request.path }} 将仅包含“正确路径”，而不包含已添加的附加参数。

第一次排序点击会产生类似

```
/list/items/?key=importance&orientation=asc 
```

但是第二次点击会返回

```
/list/items/?time=30 
```

我想返回的地方

```
/list/items/?key=importance&orientation=asc&time=30 
```

现在我可以用这个代替

```
<a href={{ request.get_full_path }}?time={{ time }}>{{ value }}</a> 
```

但是如果多次点击时间链接，我可能会得到这样的结果：

```
/list/items/?key=importance&orientation=asc&time=30&time=60&time=15 
```

当我真的想覆盖这种类型的原始参数时，相同类型的多个参数。

我该如何解决这个问题。我想保留所有不属于单击链接传递的类型的参数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T22:20:12.437

你可以使用这个片段[http://djangosnippets.org/snippets/2105/](http://djangosnippets.org/snippets/2105/)。例子：

```
{% load add_get_parameter %}
<a href="{% add_get_paramater param1='const_value',param2=variable_in_context %}">
    Link with modified params
</a> 
```

# android - Android：堆栈溢出错误 - 递归太深

> ID：12125902
> 
> 赞同：0
> 
> 时间：2012-08-25T21:46:18.760
> 
> 标签：android, recursion, callstack, stack-overflow

我正在创建一个小游戏，您需要在地图上移动部队。为了检测是否可以进行移动，我必须验证两个方格之间是否有路。因此，我递归地从一个方格开始，取四个方格（上、下、左、右），并在以下条件下递归地重复测试，因为我只得到死角或目标方格。所有的方块都必须在玩家的控制之下。

我的类案例中有我的递归代码实现：

```
public boolean isContiguJoueur(Case case_origine, Case case_destination, Case[] cases)  {
 boolean haut_true=false, droite_true=false, bas_true=false, gauche_true=false;
 // Above
 if(this.haut!=null)    {
  if(haut.joueur==this.joueur && this.haut!=case_origine)   {
   if(this.haut==case_destination)  {
    return true;
   }
   haut_true=haut.isContiguJoueur(this,case_destination, cases);
  }
 }
 // ...
 // Same code than Above, only variables names change
 // ...
 return haut_true||droite_true||bas_true||gauche_true;
} 
```

*   正方形的类名：Case
*   地图数据：Case[] case
*   玩家ID：joueur
*   上例：haut

该代码在小地图（约 50 到 100 个方格）上运行良好。但我在更大的上得到了这个：

```
08-25 11:26:31.912: E/AndroidRuntime(5497): FATAL EXCEPTION: main
08-25 11:26:31.912: E/AndroidRuntime(5497): java.lang.StackOverflowError
08-25 11:26:31.912: E/AndroidRuntime(5497):     at mypackage.isContiguJoueur(Case.java:xxx)
... x 100 
```

抱歉我的英语不好，感谢您以后的帮助！:-)

**编辑**：我忘了。为了避免大量无用的递归测试，我已经这样做了：

```
if(this.droite!=null && !haut_true) {
// ...
if(this.bas!=null && !haut_true && !droite_true)    {
// ...
if(this.gauche!=null && !haut_true && !droite_true && !bas_true)    {
// ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T16:36:27.863

我只是在我的类案例中添加一个布尔值，如果我测试这个案例，我将布尔值设置为 true，我以后不会进来。改进很重要！在大约 n^4（n 是玩家拥有的案例数量）测试之前。现在大约是n。使用我最大的地图并且玩家拥有整个地图，我没有错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T22:03:40.433

您的问题是您的路径与板上的正方形数量成指数关系。堆栈溢出错误意味着您递归太多次：每次递归都占用堆栈空间，而您正在用完它（Chaque 递归利用 l'espace sur le pile，et il y'en a trop，alors il nya plus d 'espace - et c'est une dépassement de pile）。

您可以迭代地执行此操作（无递归）而不会遇到此问题。但请记住，可能路径的数量仍然*很大*，这可能会消耗 CPU。

希望这可以帮助，

TG

# ruby-on-rails - 嵌套表单：如何设置子资源的用户 ID？

> ID：12125903
> 
> 赞同：0
> 
> 时间：2012-08-25T21:46:29.820
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我试图让我`User`保存到`Rate`. 我可以`Location`通过删除存在验证来将其保存到 Rate 中，但是在它创建之后它没有当前用户。我将如何为我的嵌套表单执行此操作？

**用户.rb**

```
attr_accessible :email, :password
has_many :locations
has_many :rates 
```

**位置.rb**

```
attr_accessible :name, :rates_attributes
belongs_to :user
has_many :rates
accepts_nested_attributes_for :rates, :reject_if => :all_blank
# Not sure if :all_blank works anyways as it - 
# still saves even when theirs no user_id, lol 
```

**比率.rb**

```
attr_accessible :amount, :location_id
belongs_to :location
belongs_to :user
validates_presence_of :amount
# Couldn't use these validations
# validates_presence_of :user_id 
# validates_presence_of :location_id 
```

**位置控制器**

```
def new
  @location = Location.new
  @location.rates.build
end

def create
  @location = current_user.locations.build(params[:location])
  if @location.save.....
end 
```

**位置/new.html.erb**

```
<%= nested_form_for @location do |f| %>
  <%= f.label :name, "Name *" %>
  <%= f.text_field :name  %>

  <%= f.link_to_add "Add Rate", :rates %>
  <%= f.fields_for :rates do |r| %>
    <%= r.text_field :amount %>
    <%= r.link_to_remove "Remove" %>
  <% end %>
  <%= f.submit "Add Location" %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T22:55:40.497

关于这个主题有一个很棒的 railscast；第 196 和 197 集。更好的是，Ryan 写了一个 gem [https://github.com/ryanb/nested_form](https://github.com/ryanb/nested_form)。

gem 非常容易实现。如果设置正确，嵌套表单会在创建时自动获取父对象 ID。

我没有注意到您发布的代码中有任何看起来错误的内容......您的嵌套表单在视图中是什么样的？

# mysql - 从 MySQL 中选择最后 N 行

> ID：12125904
> 
> 赞同：153
> 
> 时间：2012-08-25T21:46:32.097
> 
> 标签：mysql, database

我想在名为**id**的列中从 MySQL 数据库中选择最后 50 行，这是**primary key**。目标是行应按**id**以**ASC**顺序排序，这就是此查询不起作用的原因

```
SELECT 
    *
FROM
    `table`
ORDER BY id DESC
LIMIT 50; 
```

同样值得注意的是，可以操纵（删除）行，这就是为什么以下查询也不起作用的原因

```
SELECT 
    *
FROM
    `table`
WHERE
    id > ((SELECT 
            MAX(id)
        FROM
            chat) - 50)
ORDER BY id ASC; 
```

**问题**：如何从 MySQL 数据库中检索可以操作并按 ASC 顺序排列的最后 N 行？

* * *

## 回答 #1

> 赞同：276
> 
> 时间：2012-08-25T21:49:04.483

您可以使用子查询来做到这一点：

```
SELECT * FROM (
    SELECT * FROM table ORDER BY id DESC LIMIT 50
) sub
ORDER BY id ASC 
```

这将从 中选择*最后*50 行`table`，然后按升序对它们进行排序。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2015-08-06T21:40:43.117

```
SELECT * FROM table ORDER BY id DESC LIMIT 50 
```

节省资源一次查询，无需嵌套查询

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-01-26T12:11:31.193

```
SELECT * FROM table ORDER BY id DESC,datechat desc LIMIT 50 
```

如果您有一个日期字段存储发送聊天的日期（和时间），或者任何以递增方式（按 DESC 排序）或逐行递增（按 ASC 排序）填充数据的字段，请将其作为第二列数据应该是有序的。

这对我有用！！！！希望它会有所帮助！！！！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-11T13:44:46.933

用它从mysql中检索最后n行

**Select * from tbl order by id desc limit 10;**

根据N值限制使用。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2019-07-05T13:36:09.163

```
select * from Table ORDER BY id LIMIT 30 
```

注意： *`id`应该是唯一的。* 可以通过替换`30`查询中的来控制返回的行数

# php - 阻止访问者再次点击链接，直到 24 小时到期

> ID：12125907
> 
> 赞同：0
> 
> 时间：2012-08-25T21:46:54.927
> 
> 标签：php, jquery, mysql, cookies, restriction

我有问题。我有一个包含大约 1,200 个按钮的页面，该网站不会是会员网站，我只是希望能够跟踪每个访问者，以确保他们点击的按钮在 24 小时到期之前不会被他们再次点击.

我知道我可以使用 cookie，但对于 1,200 个按钮来说这太多了。

这是html按钮的样子：

```
<li><a href="http://google.com" class="btn_smallorange" id="button1">Button 1</a></li> 
```

您有什么建议吗？我对几乎所有类型的脚本都持开放态度，但知道这个网站是用 PHP 制作的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T21:53:05.653

您使用某种浏览器识别 ID（因此您可能知道给定用户是谁）跟踪给定浏览器的选择是：

1.  饼干
2.  本地存储

用于存储 1200 按钮状态的选择是：

1.  服务器提供给网页的状态的服务器端存储
2.  Cookies（可能必须将数据折叠到每个按钮一位 0
3.  本地存储

因此，例如，您可以将在 cookie 中存储浏览器标识值与在服务器端数据库中存储实际按钮状态相结合。然后，当页面呈现时，您在数据库中查找 cookie 中的 browserID 的按钮状态，然后从呈现的 HTML 页面中禁用或删除相关按钮。

您可以通过将 1200 个按钮状态折叠为每个按钮一位来完成 cookie 中的所有存储。使用 AZ 和 az 以及 0-9 和几个符号，您可以轻松地为每个字符设置 64 个值，这将允许您存储每个字符 32 个按钮的开/关状态，因此可以存储 1200 个按钮的开/关状态38 个字符，很容易放入 cookie。如果您也必须为每个按钮存储时间/日期，那么这将不适合 cookie，因此您将被留给服务器端存储或本地存储。

仅供参考，我希望您意识到任何客户端方案都很容易解决。事实上，如果您只是想阻止用户多次访问同一个 URL，他们所要做的就是将原始 URL 加入书签，然后他们可以随意访问，甚至无需访问您的网页。或者，他们可以只擦除 cookie 或本地存储。或者，他们可以只使用不同的浏览器。

防止多次访问的唯一真正方法是要求用户身份验证并验证（在您的 Web 服务器上）在呈现页面之前允许给定登录用户访问任何给定页面。因此，如果您想稳健地执行此操作，则必须全部在服务器端完成，并且您将需要某种站点登录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T21:54:29.760

如果您想避免访问者浏览器上多达 1200 个 cookie 的扩散，您需要查看“会话”。会话将单个 ID 作为 cookie 存储在访问者的浏览器上，然后将其用作*服务器上*更大数据存储的密钥。除了更快，向浏览器发送更少的数据意味着用户看到和弄乱它的机会更少。

PHP 的会话支持记录在[http://php.net/manual/en/intro.session.php](http://php.net/manual/en/intro.session.php)

顺便提一下，以这种方式绕过任何依赖于*没有*cookie 或类似的限制是完全微不足道的 - 例如，您可以切换到另一个浏览器，使用浏览器的“清除历史记录”或“隐私浏览”模式，等等

# google-maps - 在 Google Apps 脚本中将航点添加到 DirectionFinder 对象

> ID：12125911
> 
> 赞同：1
> 
> 时间：2012-08-25T21:47:30.600
> 
> 标签：google-maps, google-apps-script

我在 Google Apps 脚本应用程序中使用测向仪，我想添加一些航点。当我这样添加时，一切正常：

```
var directions = Maps.newDirectionFinder().setOrigin(start).setDestination(end)
 .addWaypoint('Berlin')
 .addWaypoint('Hamburg')
 .getDirections(); 
```

但是当我想像这样在循环中动态添加一些航点时：

```
 var directions = Maps.newDirectionFinder().setOrigin(start).setDestination(end)

 while (results.hasNext()) {
      directions.addWaypoint('Berlin')
      directions.addWaypoint('Hamm')
     }

 directions.getDirections(); 
```

最后，对象方向没有任何航路点。我做错了什么？不能在循环中添加航点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T11:16:51.683

我创建了一个简单的脚本（见下文）。它工作正常 -`res`包含 4 条腿。

```
function testMapWayPoints() {
  var directions  = Maps.newDirectionFinder().setOrigin('Berlin').setDestination('Rotterdam');
  var wayPoints = ['Potsdam', 'Hanover', 'Dortmund'];
  for (var i = 0; i < wayPoints.length; i++) {
    directions.addWaypoint(wayPoints[i]);
  }
  var res = directions.getDirections();
} 
```

我假设`results.hasNext()`返回错误。如果不是那么，您是否可以创建一个最小的可编译示例/函数，可以将其复制并粘贴到编辑器并重现问题。

**更新 00**：此外，我编写了一个已[部署的 Web 应用程序](https://script.google.com/macros/s/AKfycbz6rcd3hGXQti69IM1v-mbxS002jNSjy4nTnN0g1nxJ96fpLBxV/exec)来证明该`addWaypoint`功能有效。[这](https://script.google.com/d/12yjBH61ai--RyZhj5OEFuRa6IiUkXKLbtK18XsSr-cOMfqgvB7WAFeX2/edit)是应用程序源代码。

# c++ - 当我无法立即处理数据时如何避免内存泄漏

> ID：12125914
> 
> 赞同：0
> 
> 时间：2012-08-25T21:47:51.130
> 
> 标签：c++

我的问题是，我有一个对象，我将在初始化后立即将其推入向量中。在当前方法超出范围后很长时间将使用该向量。

代码如下所示：

```
DataObject *ptrDataObj = new DataObject();
Parent::DataVector.push_back(ptrDataObj);
:
:
// end of method 
```

这种实现肯定会导致内存泄漏。但是，如果我使用 RAII 而不是指针，则 DataObject 将在 DataVector 使用它时超出范围。我看到的唯一选择可能涉及某种副本。

我已经沉浸在 C# 中很多年了，现在我正试图重新认识自己在原生世界中。

请指教..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T21:49:04.653

为什么您的向量通过指针而不是值来存储对象？

使您的向量成为以下之一：

*   `std::vector<DataObject>`
*   `std::vector<std::shared_ptr<DataObject> >`.

此外，如果您使用的是 C++11，则可以使用[`emplace_back`](http://en.cppreference.com/w/cpp/container/vector/emplace_back)来避免复制。

```
std::vector<DataObject> vec;
vec.emplace_back(constructor_arg1, constructor_arg2); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T21:49:30.930

> 但是，如果我使用 RAII 而不是指针，则 DataObject 将在 DataVector 使用它时超出范围。

如果您使用得当，则不会。如果您使用引用计数智能指针，则该对象将至少与向量一样长，并且将被正确处理。

# php - Mysql如果不存在则自动插入特定记录，如果特定记录被更新则插入新记录

> ID：12125918
> 
> 赞同：1
> 
> 时间：2012-08-25T21:48:22.700
> 
> 标签：php, mysql

我正在使用 php 和 mysql 来开发应用程序；关于它的一些背景数据，它是一个登录系统，它存储用户名和密码以及登录系统所做的所有工作。但是我在删除用户时遇到了一个问题，删除用户的功能可以正常工作，但问题是例如管理员可以删除自己而留下没有用户的数据库。所以我想做的是当我在主页上时，运行一个函数来检查是否存在特定的用户名

```
//Example:
Table name: users
columns: username, password
default username and password I want to always remain in table 'users'
username=dames and password=:password 
//End of Example 
```

如果不添加用户名和密码，并且如果默认用户名和密码已更新，则插入默认用户名和密码，并且不删除更新的用户名和密码。我希望我说得足够清楚，因为我真的很感谢一些帮助和建议。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T21:55:50.293

与其不断地重新创建您的管理员用户，为什么不阻止管理员删除自己呢？

```
if ($user_to_delete == $current_logged_in_user) {
   // Sorry, you can't delete yourself...
} 
```

或者在应用程序的配置文件中存储一组超级管理员。不允许任何人删除超级管理员用户。

```
// In the config file...
$super_admins = array("you", "someone_else");

if (in_array($user_to_delete, $super_admins)) {
  // Sorry, you can't delete a super-admin from the UI.
  // Delete him from the application config first...
} 
```

为了保护您自己多一点，如果您只需要一个无法删除的超级管理员，请在配置中使用无法在代码中修改的常量：

```
define('SUPER_ADMIN', 'you'); 
```

*注意：你不能建立一个常量数组，但是`serialize()` [这个问题有一个解决方法](https://stackoverflow.com/questions/2241569/is-there-a-way-to-define-a-constant-array-in-php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T22:10:08.667

如果您想确保至少有一位管理员始终存在，请仅在另一位管理员仍然存在时删除该管理员：

```
DELETE
  u1
FROM
  user u1
LEFT JOIN
  user u2
ON
  u1.access = u2.access
WHERE
  u1.name = "current-user" AND
  ((u1.name != u2.name AND u1.access = "admin") OR (u1.access != "admin")); 
```

上面给定的查询需要一个带有用户名（名称）和访问级别（访问）的表。它匹配用户“current-user”，但前提是存在另一个具有访问级别“admin”的用户。如果“当前用户”本身没有访问级别“管理员”，则无论如何都会匹配。

这样，您只需创建一个具有“管理员”访问级别的用户一次。可以添加和删除更多用户，而不是最后一个具有“管理员”访问级别的用户。

如果你想在 SQL 中做所有事情，你可以创建一个 BEFORE DELETE TRIGGER。在那里，您只需检查您不想被删除的用户名。请参阅[如何在 MySql 触发器中中止 INSERT 操作？](https://stackoverflow.com/questions/2538786/how-to-abort-insert-operation-in-mysql-trigger)举个例子 - 它是为 INSERT 给出的，但对于 DELETE 是一样的。

再说一次，如果您想使用配置文件（如建议的那样）或数据库逻辑来自定义您的应用程序，这实际上取决于您的设置。

# scala - 提升网址路径映射？

> ID：12125920
> 
> 赞同：2
> 
> 时间：2012-08-25T21:48:34.890
> 
> 标签：scala, url-rewriting, lift

我从 Maven 聊天示例开始，并希望对其进行扩展，以便可以在不同的 URL 路径上发生多个独立的聊天。现在我会满足于将多个页面映射到索引。

我最好的猜测是在引导类中放置诸如[Lift RewriteResponse 之类的未找到有效 url的内容。](https://stackoverflow.com/questions/1219536/lift-rewriteresponse-not-finding-a-valid-url)但到目前为止，我没有尝试过任何工作。

我对缺乏关于如何为不同的常见用例进行路径映射的很好解释的示例感到有点沮丧（大多数电梯文档也是如此）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T22:48:49.970

请参阅[http://simply.liftweb.net/index-3.2.html#toc-Subsection-3.2.7](http://simply.liftweb.net/index-3.2.html#toc-Subsection-3.2.7)

本节介绍如何使用参数化 URL。

如果您想要多个聊天室的示例，请下载[http://tunaforcats.com/chat_done.tgz](http://tunaforcats.com/)

谢谢！

# javascript - Backbone LayoutManager 批量渲染 Collection View 的模型

> ID：12125923
> 
> 赞同：0
> 
> 时间：2012-08-25T21:48:49.227
> 
> 标签：javascript, model-view-controller, backbone.js, client

对于我的主干应用程序的一部分，某些 json 响应最多可以返回 4000 张图像。显然，我不想将所有这些渲染到 DOM 中。

我正在使用backbone.layoutmanager，但我正在努力寻找一种方法来分批渲染集合的视图，比如50-100，然后在用户滚动时渲染其余部分。有没有办法做到这一点而不必覆盖 layoutmanager 的实现`render`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T13:41:22.557

这是您可以使用的东西。它一定会解决你的问题。 [https://github.com/addyosmani/backbone.paginator](https://github.com/addyosmani/backbone.paginator)

# ruby-on-rails - 如何在一台服务器上运行多个小型 Rub y (Rack) 应用程序？

> ID：12125924
> 
> 赞同：8
> 
> 时间：2012-08-25T21:48:57.120
> 
> 标签：ruby-on-rails, ruby, rack

我想在我的 VPS 服务器上运行几个 (>2) 基于 Rack 的小型应用程序，该服务器已经运行了一个大型 Rails 应用程序。

Rails 应用程序使用传统的“Unicorn + nginx”对，它需要我 VPS 机器上的大部分 RAM 资源。

我尝试为每个应用程序添加类似的独角兽配置，这导致我内存资源不足。

所以我的问题是：是否可以设置一个小而棘手的节省内存的服务器来允许一次运行所有 Sinatra 应用程序？

更新：如果重要的话，我不太关心性能。这些应用程序并不打算做任何严肃的工作。

UPDATE2：基于与 Nginx 共享的套接字的方法优于使用端口的方法。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T21:47:56.640

我对这个问题进行了自己的探索，我想我找到了一个解决方案，它可以让我有一个网络服务器同时运行我所有的小应用程序。

它基于由 Remi Taylor ( **@remi** on Github) [https://github.com/remi/rack-stack创建的](https://github.com/remi/rack-stack)**RackStack** not-yet-a-gem 。

 **RackStack 受到 Rack::Builder 的启发，它似乎也很适合完成这样的任务——RackStack 只是朝着同一个方向走得更远，以一种我觉得非常好用和方便的方式抽象“堆栈”功能。

这是 RackStack 的演示，它包含两个示例应用程序（Sinatra 和 Rack）： [https](https://github.com/stanislaw/skeletons/tree/master/rack_stack) ://github.com/stanislaw/skeletons/tree/master/rack_stack 。为了模拟真实服务器上的堆栈应用程序行为，我修改了我的 /etc/hosts 文件，让 localhost2 主机指向 127.0.0.1。

我启动瘦服务器，然后在 localhost 或 localhost2 上运行请求：对“localhost”的请求由 FirstApp 提供，而对“localhost2”的请求由 SecondApp 提供。

当我将在真实服务器上测试我的应用程序时，我现在无法预见可能出现的任何问题，但现在这种方法似乎正是我所寻找的：我想，在真实服务器上 Nginx 会将请求传递给与我的机架应用程序关联的所有主机到瘦服务器侦听的套接字。因此，RackStack 将只满足那些针对我堆栈中的应用程序的请求。

对此方案或替代方案的任何建议、改进仍不胜感激！**

# php - 在php类方法中使最后一个数组参数可选（C）

> ID：12125933
> 
> 赞同：3
> 
> 时间：2012-08-25T21:50:01.193
> 
> 标签：php, c, arrays, php-extension, php-internals

我在 C 中创建一个 PHP 扩展来访问 SPI 接口。到目前为止，我已经完成了几乎所有工作：[Github 上的 php_spi](https://github.com/frak/php_spi)

但是，我似乎无法将构造函数中的 $options 参数设为可选。我的工作代码是这样的：

```
 if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "lla", &bus, &chipselect, &options) == FAILURE) {
    return;
}

_this_zval = getThis();
_this_ce = Z_OBJCE_P(_this_zval);

options_hash = HASH_OF(options);

char device[32];
sprintf(device, "/dev/spidev%d.%d", bus, chipselect);

// If the device doesn't exists, error!
if(access(device, F_OK) == -1) {
    char error[128];
    sprintf(error, "The device %s does not exist", device);
    php_error(E_ERROR, error);
}

// If we can't open it, error!
long fd = open(device, O_RDWR);
if (fd < 0) {
    char error[128];
    sprintf(error, "Could not open %s for read/write operations, are you running as root?", device);
    php_error(E_ERROR, error);
}

// Set the file descriptor as a class property
zend_update_property_long(_this_ce, _this_zval, "device", 6, fd TSRMLS_DC);

// Default property values
uint8_t mode = SPI_MODE_0;
uint8_t bits = 8;
uint32_t speed = 500000;
uint16_t delay = 0;

// Loop through the options array
zval **data;
for(zend_hash_internal_pointer_reset(options_hash);
    zend_hash_get_current_data(options_hash, (void **)&data) == SUCCESS;
    zend_hash_move_forward(options_hash)) {

    char *key;
    int len;
    long index;
    long value = Z_LVAL_PP(data);

    if(zend_hash_get_current_key_ex(options_hash, &key, &len, &index, 1, NULL) == HASH_KEY_IS_STRING) {
        // Assign the value accordingly
        if(strncmp("mode", key, len) == 0) {
            switch(value) {
                case SPI_MODE_1:
                    mode = SPI_MODE_1;
                    break;
                case SPI_MODE_2:
                    mode = SPI_MODE_2;
                    break;
                case SPI_MODE_3:
                    mode = SPI_MODE_3;
                    break;
                default:
                    mode = SPI_MODE_0;
                    break;
            }
        }
        else if(strncmp("bits", key, len) == 0) {
            bits = value;
        }
        else if(strncmp("speed", key, len) == 0) {
            speed = value;
        }
        else if(strncmp("delay", key, len) == 0) {
            delay = value;
        }
    }
} 
```

但是，如果我遵循所有文档的建议，我可以找到并在 l 和 a 之间添加一个管道，如下所示：

```
if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "ll|a", &bus, &chipselect, &options) == FAILURE) { 
```

然后我的扩展默默地失败了 - 任何人都可以给我任何建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T22:26:21.783

假设`options`是`zval*`，如果你这样做：

```
if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "ll|a", &bus, &chipselect, &options) == FAILURE) {
    return;
} 
```

...如果`options`未传递（即省略第三个可选参数），`options`则不会被初始化或修改。稍后，您执行以下操作：

```
options_hash = HASH_OF(options); 
```

因此，您使用的是未初始化的指针或 NULL 指针，这是未定义的行为。这很可能会导致分段错误，从而导致您的 PHP 脚本失败。

你应该做的是：

```
zval* options = NULL;
if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "ll|a", &bus, &chipselect, &options) == FAILURE) {
    return;
}

// ...

if (options != NULL) {
    options_hash = HASH_OF(options);
} 
```

...并处理`options`(and `options_hash`) 的每个实例，条件是检查它是否`NULL`存在。

# java - jframe中的多个'imageviews'

> ID：12125934
> 
> 赞同：2
> 
> 时间：2012-08-25T21:50:02.157
> 
> 标签：java, image, swing, jframe, panel

大家好，我正在尝试向我的 jframe 添加多个组件。但我似乎无法让它工作。

```
private void initGUI() {
    setAlwaysOnTop(true);
    setUndecorated(true);

    AWTUtilities.setWindowOpaque(this, false);

    AWTUtilities.setWindowOpacity(this, 0.5f);
    setLocation(ini.getButtonsX(), ini.getButtonsY());
    setSize(ini.getButtonsW(), ini.getButtonsH());

    setLayout(null);

    JPanel panel = new JPanel();
    panel.setLayout(null);
    ImageView baron = new ImageView("image/nashor.png", 50, 50);
    baron.setBounds(50, 50, 50, 50);
    ImageView test = new ImageView("image/dragon.png", 50, 50);
    test.setBounds(50, 150, 50, 50);

    panel.add(baron);
    panel.add(test);

    panel.setBounds(0, 0, ini.getButtonsW(), ini.getButtonsH());

    add(panel);

} 
```

我的 ImageView 是一个扩展了绘制图像的 JPanel 的类。

在这一点上，只画了 nashor

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T22:15:45.050

考虑这个程序：

```
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
import java.awt.*;
import java.awt.event.*;
import javax.imageio.ImageIO;
import javax.swing.*;

public class Init extends JFrame{
    JPanel view = new JPanel();
    JMenuBar mBar = new JMenuBar();
    JMenu menu = new JMenu("File");
    JMenuItem mItemOpen = new JMenuItem("Open");
    JMenuItem mItemExit = new JMenuItem("Exit");
    JFileChooser fc = new JFileChooser();
    JTextField txtPath = new JTextField();

    BufferedImage myPicture;
    File filePath;
    String path;

    public Init(){
        mBar.add(menu);
        menu.add(mItemOpen);
        menu.addSeparator();
        menu.add(mItemExit);
        setJMenuBar(mBar);
        txtPath.setEditable(false);
        mItemOpen.addActionListener(new ActionListener(){
            public void actionPerformed(ActionEvent e){
                fc.showOpenDialog(null);
                filePath = fc.getSelectedFile();
                path = filePath.getPath();
                txtPath.setText(path);
                try {
                    //view.removeAll();
                    myPicture = ImageIO.read(new File(path));
                    JLabel picLabel = new JLabel(new ImageIcon(myPicture));
                    view.add(picLabel);
                    revalidate();

                } catch (IOException ex) {
                    ex.printStackTrace();
                }
            }
        });
        setLayout(new BorderLayout());
        getContentPane().add(new JScrollPane(view),BorderLayout.CENTER);
        getContentPane().add(txtPath,BorderLayout.SOUTH);
        setTitle(".:My Picture Viewer:.");
        setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        //pack();
        setSize(1024,768);
        setVisible(true);
    }

    public static void main(String [] args){
        SwingUtilities.invokeLater(new Runnable(){
            public void run(){
                new Init();
            }
        });         
    }
} 
```

![在此处输入图像描述](../Images/e4f06d969af61bc2dac85d6f9d03f4f5.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-25T22:02:36.740

我建议您让 JPanel 面板使用 GridLayout，而不是 null 布局，并且不要设置 ImageView 大小，而是确保该类具有`getPreferredSize()`有意义的方法覆盖，它返回适当大小的 Dimension。然后，如果您`pack()`在添加组件后调用 JFrame，布局管理器会为您调整大小。

# ruby - 在 Ruby 中查找调用者方法

> ID：12125938
> 
> 赞同：1
> 
> 时间：2012-08-25T21:50:26.950
> 
> 标签：ruby

> **可能重复：**
> [如何获取调用方法的名称？](https://stackoverflow.com/questions/5100299/how-to-get-the-name-of-the-calling-method)

我有一个方法`#foo`。可以从许多地方（范围）调用该方法。我需要`#foo`找出它是从哪里调用的。但不是堆栈跟踪（如`#caller`返回的内容），我想要方法的纯名称（如`#__callee__`返回的内容）。Ruby 中是否存在这种方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T21:58:34.930

你可以使用`__method__`. 将它放在任何方法体中，它应该提供方法的名称。而且您始终可以使用`.class`or来获取上下文`.class.ancestors`。

# java - 使用 android:layout_centerVertical="true" 时设置 android 视图？

> ID：12125940
> 
> 赞同：2
> 
> 时间：2012-08-25T21:51:37.280
> 
> 标签：java, android, xml, layout

我试图在 android 中垂直获得一个视图中心，但我在顶部有一个 75dps 的 imageView，所以我需要我的居中视图从顶部偏移 75dps 以便它居中！有没有办法做到这一点？我尝试使用 android:layout_marginTop="75dp" 但它没有用！有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T22:08:34.633

您可以将您的视图包装成一个 ViewGroup（例如 LinearLayout），然后使 LinearLayout 居中，并将 marginTop 添加到您的视图中。它应该工作。

无论如何，如果您也发布您的布局 xml，那将会很有帮助。

# ios - 替代 iOS 中的 cvWaitKey() 函数

> ID：12125950
> 
> 赞同：1
> 
> 时间：2012-08-25T21:53:42.727
> 
> 标签：ios, opencv

好的，我想做的是从现有视频文件中检索帧，对帧进行一些工作，然后将其保存到新文件中，

实际发生的是它写入一些帧然后崩溃，因为代码非常快，如果我不输入 cvWaitKey()，我会得到与使用 AVFoundation 库编写视频帧而不使用时相同的错误

```
AVAssetWriterInput.readyForMoreMediaData 
```

OpenCV 视频编写器是使用 AVFoundation 类实现的，但我们无法访问

```
AVAssetWriterInput.readyForMoreMediaData 
```

还是我错过了什么？

这是类似于我正在尝试做的代码，

```
while (grabResult&&frameResult) {

        grabResult = cvGrabFrame(capture);          // capture a frame
        if(grabResult){
            img = cvRetrieveFrame(capture, 0);  // retrieve the captured frame
            cvFlip(img,NULL,0);                 // edit img
            frameResult = cvWriteFrame(writer,img);      // add the frame to the file
            cvWaitKey(-1); or anything that helps to finish adding the previous frame
        }
    } 
```

> 我正在尝试在我的 iPhone/iPad 应用程序中使用 OpenCV（不显示）转换视频文件，除了 cvWaitKey() 函数之外一切正常，我收到此错误：
> 
> ```
> OpenCV Error: Unspecified error (The function is not implemented. Rebuild the library with Windows, GTK+ 2.x or Carbon support. If you are on Ubuntu or Debian, install libgtk2.0-dev and pkg-config, then re-run cmake or configure script) in cvWaitKey, 
> ```
> 
> 如果没有此功能，将丢弃帧，因为无法知道视频编写器是否已准备好，是否有替代我的问题的方法？
> 
> 我正在使用 OpenCV 2.4.2，并且在最新的 OpenCV 预编译版本中出现同样的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T21:36:13.807

我对iOS开发一无所知，但是您是否尝试过调用C++接口方法[`waitKey()`](http://docs.opencv.org/modules/highgui/doc/user_interface.html?highlight=waitkey#waitkey)？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-07T12:08:49.770

重绘`UIImageView`：

```
[[NSRunLoop currentRunLoop]runUntilDate:[NSDate dateWithTimeIntervalSinceNow:0.0f]]; 
```

其次是你的`imshow`或`cvShowImage`

# python - 对登录过程进行功能测试

> ID：12125951
> 
> 赞同：0
> 
> 时间：2012-08-25T21:53:48.480
> 
> 标签：python, testing, selenium, webdriver, functional-testing

我正在网站上使用 selenium 进行一些测试。需要测试的主要内容之一是注册/登录过程。这里有很多变量，并且需要在设置时确认几个不同的网络设置。

注册过程会发送一封确认电子邮件链接以完成注册。

这将如何使用 Selenium 进行测试。看来我需要在网站上进行注册，然后登录我的 gmail 帐户，然后单击注册链接——有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T23:56:56.317

Django 支持这种测试。

您可以使用一些方便的内置[助手](https://docs.djangoproject.com/en/1.4/topics/testing/#email-services)

或[文件后端](https://docs.djangoproject.com/en/dev/topics/email/#file-backend)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T04:49:48.240

这就是我最终做的。唯一的问题是，真的没有办法知道电子邮件*何时*会到达，而且可能需要相当长的时间......

```
def _get_last_message(self):
    mail = imaplib.IMAP4_SSL('imap.gmail.com')
    mail.login(MAIL_USERNAME, MAIL_PASSWORD)
    mail.select("inbox")
    result, data = mail.search(None, "ALL")
    latest_email_id = data[0].split()[-1]
    result, data = mail.fetch(latest_email_id, "(RFC822)")
    raw_email = data[0][1]
    return raw_email 
```

# python - 用于小特征值的 Scipy 稀疏 eigsh()

> ID：12125952
> 
> 赞同：10
> 
> 时间：2012-08-25T21:54:03.630
> 
> 标签：python, scipy, cluster-analysis, linear-algebra, sparse-matrix

我正在尝试使用 NumPy/SciPy 为更大（但仍然易于处理）系统编写谱聚类算法，利用 SciPy 的稀疏线性代数库。不幸的是，我遇到了[eigsh()](http://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.linalg.eigsh.html#scipy.sparse.linalg.eigsh)的稳定性问题。

这是我的代码：

```
import numpy as np
import scipy.sparse
import scipy.sparse.linalg as SLA
import sklearn.utils.graph as graph

W = self._sparse_rbf_kernel(self.X_, self.datashape)
D = scipy.sparse.csc_matrix(np.diag(np.array(W.sum(axis = 0))[0]))
L = graph.graph_laplacian(W) # D - W
vals, vects = SLA.eigsh(L, k = self.k, M = D, which = 'SM', sigma = 0, maxiter = 1000) 
```

该`sklearn`库是指 scikit-learn 包，特别是[这种](https://github.com/scikit-learn/scikit-learn/blob/master/sklearn/utils/graph.py#L132)从稀疏 SciPy 矩阵计算图拉普拉斯算子的方法。

`_sparse_rbf_kernel`是我编写的用于计算数据点的成对亲和力的方法。它通过从图像数据创建一个稀疏的亲和度矩阵来操作，特别是只计算每个像素周围 8 个邻域的成对亲和度（而不是使用 scikit-learn 的`rbf_kernel`方法对所有像素成对地计算，这也不能解决这个问题） .

由于拉普拉斯算子未归一化，因此我正在寻找系统的最小特征值和相应的特征向量。我知道[ARPACK 不适合查找小的特征值](https://stackoverflow.com/questions/9082782/computing-n-smallest-eigenvalues-of-sparse-matrix-in-python)，但我正在尝试使用 shift-invert 来查找这些值，但仍然没有取得太大的成功。

使用上述参数（特别是`sigma = 0`），我收到以下错误：

> RuntimeError: Factor 是完全奇异的

使用`sigma = 0.001`，我得到一个不同的错误：

> scipy.sparse.linalg.eigen.arpack.arpack.ArpackNoConvergence：ARPACK 错误 -1：没有收敛（1001 次迭代，0/5 特征向量收敛）

我已经尝试了所有三个不同的值，`mode`结果相同。**对于使用 SciPy 稀疏库来查找大型系统的小特征值有什么建议吗？**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-30T20:33:41.320

您应该使用`which='LM'`: 在移位反转模式下，此参数指的是转换后的特征值。（如[文档中所述](http://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.linalg.eigsh.html#scipy.sparse.linalg.eigsh)。）

# powershell - power shell：如何发送鼠标中键？

> ID：12125959
> 
> 赞同：4
> 
> 时间：2012-08-25T21:55:31.460
> 
> 标签：powershell

如何使用 power shell 脚本发送鼠标中键？我想要这样的东西：

```
Add-Type -AssemblyName System.Windows.Forms
[Windows.Forms.SendKeys]::SendWait('{MButton}') 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-31T01:09:51.840

```
function Click-MouseButton
{
param(
[string]$Button, 
[switch]$help)
$HelpInfo = @'

Function : Click-MouseButton
By       : John Bartels
Date     : 12/16/2012 
Purpose  : Clicks the Specified Mouse Button
Usage    : Click-MouseButton [-Help][-Button x]
           where      
                  -Help         displays this help
                  -Button       specify the Button You Wish to Click {left, middle, right}

'@ 

if ($help -or (!$Button))
{
    write-host $HelpInfo
    return
}
else
{
    $signature=@' 
      [DllImport("user32.dll",CharSet=CharSet.Auto, CallingConvention=CallingConvention.StdCall)]
      public static extern void mouse_event(long dwFlags, long dx, long dy, long cButtons, long dwExtraInfo);
'@ 

    $SendMouseClick = Add-Type -memberDefinition $signature -name "Win32MouseEventNew" -namespace Win32Functions -passThru 
    if($Button -eq "left")
    {
        $SendMouseClick::mouse_event(0x00000002, 0, 0, 0, 0);
        $SendMouseClick::mouse_event(0x00000004, 0, 0, 0, 0);
    }
    if($Button -eq "right")
    {
        $SendMouseClick::mouse_event(0x00000008, 0, 0, 0, 0);
        $SendMouseClick::mouse_event(0x00000010, 0, 0, 0, 0);
    }
    if($Button -eq "middle")
    {
        $SendMouseClick::mouse_event(0x00000020, 0, 0, 0, 0);
        $SendMouseClick::mouse_event(0x00000040, 0, 0, 0, 0);
    }

}

} 
```

您可以将此函数添加到您的个人资料或其他脚本中，然后您可以使用以下命令调用它：

单击鼠标按钮“中间”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-26T19:49:22.183

好吧，SendKeys 用于模拟键盘输入而不是鼠标输入。如果有调用该函数的键盘机制，那么您可以使用 SendKeys。例如，如果为控件配置了键盘加速器，则可以发送 Alt+«char»。您可以发送 Tab 键，然后发送空格键来单击按钮。

至于实际使用 PowerShell 发送密钥，首先您必须获得要向其发送击键的窗口的句柄。如何获得该窗口句柄取决于窗口的创建方式。一种方法是使用 Win32 API `FindWindow`。一旦你有了窗口，你需要确保它是前台窗口（另一个 Win32 API -`SetForegroundWindow`这样做），然后你可以开始向它发送击键。PowerShell V2 及更高版本允许您通过 .NET PInvoke 机制通过`Add-Type`cmdlet 访问 Win32 API，例如：

```
Start-Process calc.exe

$pinvokes = @'
  [DllImport("user32.dll", CharSet=CharSet.Auto)]
  public static extern IntPtr FindWindow(string lpClassName, string lpWindowName);

  [DllImport("user32.dll")]
  [return: MarshalAs(UnmanagedType.Bool)]
  public static extern bool SetForegroundWindow(IntPtr hWnd);
'@

Add-Type -AssemblyName System.Windows.Forms
Add-Type -MemberDefinition $pinvokes -Name NativeMethods -Namespace MyUtils

$hwnd = [MyUtils.NativeMethods]::FindWindow("CalcFrame", "Calculator")
if ($hwnd)
{
    [MyUtils.NativeMethods]::SetForegroundWindow($hwnd)
    [System.Windows.Forms.SendKeys]::SendWait("6")
    [System.Windows.Forms.SendKeys]::SendWait("*")
    [System.Windows.Forms.SendKeys]::SendWait("7")
    [System.Windows.Forms.SendKeys]::SendWait("=")
} 
```

另一种可能的方法是，*如果*Window 基于 WinForms（或 WPF）并且它在您的 PowerShell 进程中运行，则使用反射进入您要发送 MButtonClick 的控件并自己调用 OnMouseClick。您需要对控件的引用，但如果它在您的 PowerShell 进程中运行，则可能是您创建了该控件，因此您对它有一个引用。

[您可能会发现这篇关于使用 Windows PowerShell 实现 UI 自动化的](http://msdn.microsoft.com/en-us/magazine/cc163301.aspx)MSDN 文章很有用。还有一个[关于模拟鼠标和键盘输入的 MSDN 主题](http://msdn.microsoft.com/en-us/library/ms171548.aspx)可能会有所帮助。

# html - 从网站的 PSD 文件中提取按钮

> ID：12125960
> 
> 赞同：0
> 
> 时间：2012-08-25T21:55:41.203
> 
> 标签：html, css, button, psd

我下载了一个 PSD 文件，其中包含我想在我的网站上使用的按钮。问题是我不知道如何访问它们以在网站上使用。我将如何提取这些按钮？或者有更好的方法吗？这是在 Photoshop 中打开的 psd 的屏幕截图。

![纽扣](../Images/7f77a28078b2ed9ef74a178a1af8b51d.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T14:04:14.433

您可以使用此切片器应用程序：

[http://testslicer.codeborg.com:9080/](http://testslicer.codeborg.com:9080/)

我试过了，效果很好。您必须上传 .png 文件，然后设置切片线。如果要对图层进行切片，则必须单击该图层。试试看，真的很简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T15:28:47.370

我尝试了 Nedoma 的链接，这里是输出：

第一步：我裁剪你的图像并添加一些线条

![切片机](../Images/aaadc8a037268c5bcf4c39d986ea5d2d.png)

第二：我使用了拆分功能

![应用了拆分功能](../Images/230519b5b9f77582220fd705730c3474.png)

看起来还有更多功能，但它们仅在您使用透明背景时才有效。

如果您想在此工具中处理之前隐藏文本图层，有指向 Photoshop 脚本的链接[http://slicer.codeborg.com/hide-text-script.html](http://slicer.codeborg.com/hide-text-script.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T21:57:24.480

您可以使用矩形选框工具，剪下您想要的按钮，然后根据您刚刚剪下的按钮创建一个图像。这基本上会给你你想要的按钮，然后在你的网站上让你的按钮成为那个图像。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-25T22:03:36.303

如果您在保存单个按钮图像时遇到问题，您需要学习如何使用[切片工具](http://www.google.co.uk/webhp?hl=en&tab=ww#hl=en&gs_nf=1&qe=cGhvdG9zaG9wIHNs&qesig=vjlw6EGv3J6jfKSVKv_hjA&pkc=AFgZ2tmofLwkLF_gNSv6wpnSuFCbbosz4znm7Ncv5Hh37tYfFUiIbJxGzKMdyJ7ZVxfXKHNmU5DVTTH9k6rOgfklY_sAB4jjhQ&cp=12&gs_id=1a&xhr=t&q=photoshop+slice+tool&pf=p&sclient=psy-ab&oq=photoshop+sl&gs_l=&pbx=1&bav=on.2,or.r_gc.r_pw.r_qf.&fp=89b2b796eed5d3ab&biw=1680&bih=914)

# css - background-color 属性不能与 HTML5 DOCTYPE 一起正常工作

> ID：12125961
> 
> 赞同：3
> 
> 时间：2012-08-25T21:55:42.320
> 
> 标签：css, html, doctype

所以我有一个基本的 2 列 HTML 布局，我应用了一些基本的 CSS 到：

```
html {
  background-color: gray;
}

body {
  width: 900px;
  background-color: white;
  margin: 0 auto;
  overflow: hidden;
}

.logo, .nav, .contact {
  float: left;
  width: 248px;
  border: 1px black solid;
}

.about, .banner, .content {
  float: right;
  width: 648px;
  border: 1px black solid;
} 
```

问题是，当我将`<!DOCTYPE html>`声明添加到页面的开头时，该`background-color`属性不适用于`body`标签。我认为这与它默认为没有 DOCTYPE 的怪癖模式有关，但我做错了什么可能是无效的 CSS？（我已经用拼图进行了验证，它没有显示任何错误/警告。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T22:21:58.070

因为你错过了 DOCTYPE——它本来就应该在那里——你的页面正在以 quirks 模式呈现。在 quirks 模式下，已知浏览器会将高度拉伸`body`到视口高度的 100%。在标准模式下，由适当的 DOCTYPE 触发，其`body`行为类似于常规块级元素，默认情况下仅与其内容一样高。在您的情况下，这会导致`body`的背景颜色不可见。

你的 CSS 本身没有任何问题，这就是它验证的原因，但如果你想`body`在标准模式下拉伸到视口的高度，你应该分别添加以下高度`html`属性`body`：

```
html {
  height: 100%;
}

body {
  min-height: 100%;
} 
```

# android - 手势识别器和 AndEngine (Android)

> ID：12125962
> 
> 赞同：2
> 
> 时间：2012-08-25T21:55:44.763
> 
> 标签：android, view, andengine, gesture

在我正在开发的游戏中，我需要这个功能：能够在屏幕上绘图并确定绘图是否是确定的形状（比如说矩形、三角形或其他）。

所以我想使用手势，这是更简单的方法；通过手势生成器，我制作了一些形状并将它们用作模型。问题是，我不能让它与 AndEngine 一起工作。

我需要将 GestureOverlayView（基本上是绘图板）放置在游戏场景的顶部，这样我就可以看到场景本身以及所有附加的实体，并且我还可以绘制手势。

现在我尝试的方法不起作用，要么是 AndEngine 的东西显示在屏幕上，要么是 GestureOverlayView，而不是两者。

我是android开发和AndEngine的新手，所以我有点卡在这里......你对我如何让它工作有什么想法吗？我到处找，但我找不到任何有用的东西......

我将在下面留下手势部分的代码，例如，如果您在项目的路径 res/raw 中没有任何预制手势，它显然不会真正起作用：

```
public class ProvaGesture extends Activity implements GestureOverlayView.OnGesturePerformedListener        
{

     private GestureLibrary gestureLib;

     public  GestureOverlayView gestureOverlayView;

     @Override
     public void onCreate(Bundle savedInstanceState) 
     {
          super.onCreate(savedInstanceState);

          gestureOverlayView = new GestureOverlayView(this);

          gestureOverlayView.addOnGesturePerformedListener(this);

          gestureLib = GestureLibraries.fromRawResource(this, R.raw.gestures);

          if (!gestureLib.load())
          {
                finish();
          }

           setContentView(gestureOverlayView);
      }

     public void onGesturePerformed(GestureOverlayView overlay, Gesture gesture)
     {
           ArrayList<Prediction> predictions = gestureLib.recognize(gesture);

           for (Prediction prediction : predictions) 
           {
                 if (prediction.score > 1.0) 
                 {
                        Toast.makeText(this, prediction.name, Toast.LENGTH_SHORT).show();
                 }
           }
     }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T03:17:03.187

我没有在您的演示代码中看到 AndEngine 部分。您的`ProvaGesture`活动应该从 AndEgine 的扩展`SimpleBaseGameActivity`或`BaseGameActivity`实施`IOnSceneTouchListener`。

根据您的想法，我猜您尝试创建一个仅处理手势的单独叠加视图，因此您必须考虑：

*   您在 android**中一次只运行一个活动。**

*   如果您想创建一个与 AndEgine 的表面视图重叠的**用户定义视图**`XMLLayoutExample`，您应该看到 Andengine 的示例：

**解决方案可能是**[建议]：

```
public class OverlapLayoutExample extends SimpleLayoutGameActivity {
@Override
protected int getLayoutID() {
    //your layout id (xml file in layout folder)
    return R.layout.overlaplayout;
}

@Override
protected int getRenderSurfaceViewID() 
{
    //overlaplayout will contain a SurfaceView with following ID
    //this surface is where you render Andgine
    return R.id.overlaplayout_rendersurfaceview;
}
} 
```

不要忘记创建自己的布局：`overlaplayout`包含`surfaceView`和`OverlayView`

# django - 算法问题：多个数据库

> ID：12125965
> 
> 赞同：0
> 
> 时间：2012-08-25T21:55:53.077
> 
> 标签：django, django-models, django-views

我一直在尝试使用 django 获取吃的比萨饼总数

*我的模型是这样的：*

```
class pizza_total_eated(Model.models):
     user           #fk to users
     pizza          #fk to pizzas
     total_eated    #total number of `pizza` eaten

"""
+------+-------+-------+
| user | pizza | total |
+------+-------+-------+
|  1   |   1   |   5   |
|  1   |   2   |   6   |
|  2   |   3   |   4   |

""" 
```

这存储了用户吃的某种类型的比萨饼的总数。基本上我想检索用户吃披萨的总数

当我只有一个披萨时，吃的总数很容易：

```
pizza_total = pizza_total_eated.objects.filter(Pizza = 1)

for user in pizza_total:
    user.total_eated 
```

但是我怎么能为*每个用户做这个=>每个披萨*

```
for user in pizza_total
    for pizza in user.pizza
        pizza.total_eated     #user 1 -> pizza 1 so total_eated = 5 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T23:37:06.590

试试这个备用数据结构：

```
class Pizza(models.Model):
    # pizza_stuff 
    # ...
    # ...

class PizzaEaten(models.Model):
    pizza = models.Foreingkey(Pizza)
    user = models.ForeignKey(User) 
```

每次用户`u`吃披萨`p`时，你会：

```
PizzaEtean.objects.create(user = u, pizza = p) 
```

然后，如果你想查询Pizza的用户你吃了多少，只需使用：

```
PizzaEaten.objects.filter(user = u).count() 
```

如果要获取用户吃的每种类型的比萨饼数量，可以使用 Django 注释并执行以下操作：

```
from django.db.models import Count
PizzaEaten.objects.values('user', 'pizza').annotate(eat_count = Count('id')) 
```

您可以阅读[django 文档`values`并`annotate`](https://docs.djangoproject.com/en/dev/topics/db/aggregation/#values)了解其工作原理。
基本上，将为每个唯一的值组合生成一个注释。
在您的情况下，这意味着您为每个用户/比萨饼组合获得一个计数。

### 边注：

这也将防止竞争条件，因为您不会增加计数器字段，而是在需要时插入新记录。
您还可以在模型上存储其他（相关）信息`PizzaEaten`，例如用户吃披萨的时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T22:53:23.637

我不认为你真的需要 Pizza_total_eated 表：只要有一个 Pizza 表：

```
PIZZA_CHOICES = (
  ('t', 'Tomato'),
  ('c', 'Cheese')
)

class Pizza(models.Model):
    type = models.CharField(choices=PIZZA_CHOICES, max_length=2)
    user = models.ForeignKey(User) 
```

然后查询将是：

```
Pizza.objects.values_list('user_id','type').annotate(total=Count('type')) 
```

该查询将返回一个 3 元组列表（元组的第一个值是用户 id，第二个是比萨饼类型，第三个是用户吃的该类型比萨饼的总数）：

```
 [(4, u't', 2), (4, u'c', 1), ...] 
```

# php - 将网站参数存储在数据库或平面文件中

> ID：12125967
> 
> 赞同：1
> 
> 时间：2012-08-25T21:56:22.673
> 
> 标签：php, database, flat-file

在大多数情况下，我运行的一个组织的 3 个站点都有一个共享的 MySQL 数据库。这使他们能够很好地相互交流。

我有一堆网站需要了解的简单参数，但我不确定最佳途径是什么：

1.  制作一个包含 2 个字段（键、值）的表，我在其中存储参数
2.  将值存储在一个或多个平面文件中

它们各有优缺点。

该数据库允许对所有三个站点使用单个条目（但是，这并不经常发生），所有信息都集中，并且界面已经很好定义。

平面文件更容易作为 FTP 使用，除了网站管理外，还可以使用文本编辑器，平面文件可以编写为 PHP，这意味着网站不需要进行任何解析（只需要包含文件和使用变量），但它们不能在站点之间共享。

我可以继续说下去。你觉得走哪条路比较好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T22:18:23.430

如果有机会，我的意见是使用数据库。从长远来看，这更容易。您已经使用平面文件构建了网站，但现在客户想要一个带有其他参数的附加页面，因此您必须添加一个新文件。现在你已经完成了，他再次问你..好吧，你明白了。

它根本没有组织。因此，如果您有机会使用数据库，请使用它。发明它是有原因的。

但只是为了让我的想法清晰并清楚地知道你在说什么，请告诉我更多关于你想要存储的设置。我可以想象您正在谈论一些全局变量，或者甚至可能会使用 define()，但您也可能想要存储字符串。所以请为我们定义“一堆简单的参数”。

# javascript - 在 JQuery 中是否可以跳过可选参数并传递下一个参数？

> ID：12125968
> 
> 赞同：6
> 
> 时间：2012-08-25T21:56:52.873
> 
> 标签：javascript, jquery

在 JQuery 中是否可以跳过可选参数并传递下一个参数？如果是，jquery 函数如何确定哪个值用于哪个参数？

一个例子：

```
//
// function signature is
// jQuery.get( url [, data] [, success(data, textStatus, jqXHR)] [, dataType] )
//
// function is called as
//
$.get('ajax/test.html', function (data) {
    $('.result').html(data);
    alert('Load was performed.');
}); 
```

在 URL 之后调用 $.get() 时，会跳过 [, data] ，然后传递成功回调。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-25T21:59:40.700

是的，甚至可以从中间*跳过可选参数。*jQuery 查看参数的类型以确定哪个是哪个。看一下签名[`jQuery.load`](http://api.jquery.com/load/)：

```
.load(url [, data] [, complete(responseText, textStatus, XMLHttpRequest)]) 
```

并按预期进行以下工作：

```
.load("test.php")
.load("test.php", {foo: bar})
.load("test.php", {foo: bar}, function(){})
.load("test.php", function(){}) // you skipped the 2nd parameter? no. 
```

您会注意到三个参数是`string`：`object`和`function`。在函数内部，jQuery 可以轻松检查传递了多少参数及其类型。如果它注意到第二个参数是一个函数，它将假定该`data`参数被跳过并采取相应的行动。

令您惊讶的是，还有另一个[`jQuery.load`](http://api.jquery.com/load-event/)具有不同签名的函数执行完全不同的操作：

```
.load(handler(eventObject))
.load([eventData], handler(eventObject)) 
```

同样，jQuery 可以通过查看参数来确定要触发的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T22:23:27.507

这不是 jQuery 的问题，因为它更多地与 JavaScript 本身的功能有关。jQuery 函数是使用参数创建的。传递给函数的参数具有类型。我们可以测试这些参数是什么类型，从而确定它们的用途。

```
function foo( show, text ) {

    if ( typeof show === "function" ) show( text );

    else if ( !show ) alert( text );

} 
```

我们`typeof`用来查找类型。如果从函数调用中排除参数，则其类型为`undefined`. `undefined`是一个假类型。其他虚假类型是`0`, `false`, `NaN`, 空字符串 ( `""`) 和`null`. 我们可以使用逻辑非运算符来测试变量的虚假性`!`。

继续前进，如果我们知道这`show`是一个函数，我们可以将它用作函数并使用参数调用它`text`。

```
foo(function (text) { alert(text); }, "Hello World"); // alerts "Hello World" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-25T22:00:00.903

不像你可能习惯的那样。有些函数可能需要一个对象作为选项，例如`$.ajax`：

```
$.ajax({
    url: 'whatever',
    data: {some: 'thing'}
}); 
```

相对于：

```
$.ajax('whatever', {
    data: {some: 'thing'}
}); 
```

使用前一种形式将允许您省略 URL 并使用默认值。（不是最好的例子，但它是我在所有 jQuery 中临时想到的唯一一个。你有一个特殊的案例吗？）

# php - 第一次点击激活链接如何激活账号？

> ID：12125973
> 
> 赞同：2
> 
> 时间：2012-08-25T21:58:03.583
> 
> 标签：php, mysqli

我正在尝试创建一个激活页面，因此当用户单击其激活链接时，它会将用户导航到 activate.php 页面并显示一条消息，说明该帐户是否已激活。

我遇到的问题是它一直显示消息“代码和用户名不匹配！帐户未激活。” 即使点击了激活链接，它也根本不会显示成功消息“帐户已激活”。

此外，如果识别出正确的用户名和代码，数据库中的“活动”列应更改为“1”，但仍显示“0”，表示帐户仍处于非活动状态。

我的问题是为什么它不能识别用户名和激活码是正确的？

下面是 registration.php 脚本，它插入用户的注册详细信息并通过电子邮件发送激活链接：

```
$teacherpassword = md5(md5("j3j".$teacherpassword."D2n"));  
$code = md5(rand(1,9));

$insertsql = "
INSERT INTO Teacher
(TeacherForename, TeacherSurname, TeacherEmail, TeacherAlias, TeacherUsername, TeacherPassword, Code)
VALUES
(?, ?, ?, ?, ?, ?, ?)
";
if (!$insert = $mysqli->prepare($insertsql)) {
// Handle errors with prepare operation here
}                                           

$insert->bind_param("sssssss", $getfirstname, $getsurname,
$getemail, $getid, $getuser,
$teacherpassword, $code);

$insert->execute();

if ($insert->errno) {
// Handle query error here
}

$insert->close();

    $getuser = $_POST['user'];
    $code = md5(rand(1,9));

    $site = "http://helios.hud.ac.uk/......../Mobile_app";
    $webmaster = "Mayur Patel <.......@hud.ac.uk>";
    $headers = "From: $webmaster";
    $subject = "Activate Your Account";
    $message = "Thanks for Registering. Click the link below to Acivate your Account. \n";
    $message .= "$site/activate.php?user=$getuser&code=$code\n";
    $message .= "You must Activate your Account to Login";

    if(mail($getemail, $subject, $message, $headers)){
    $errormsg = "You have been Registered. You must Activate your Account from the Activation Link sent to <b>$getemail</b>";
    $getfirstname = "";
    $getsurname = "";
    $getid = "";
    $getuser = "";
    $getemail = "";
    } 
```

下面是 activate.php 页面，它检查激活链接并执行 mysqli 操作并显示消息：

```
 <?php
    $user_to_be_activated  =   $_GET['user'];
    $code_to_be_matched   =   $_GET['code'];

    // don't use $mysqli->prepare here
    $query = "SELECT TeacherUsername, Active, Code FROM Teacher WHERE TeacherUsername = ? AND Code = ? ";
    // prepare query
    $stmt=$mysqli->prepare($query);
    // You only need to call bind_param once
    $stmt->bind_param("ss",$user_to_be_activated, $code_to_be_matched);
    // execute query
    $stmt->execute(); 
    // get result and assign variables (prefix with db)
    $stmt->bind_result($dbTeacherUsername, $dbActive, $dbCode);
    //get number of rows
    $stmt->store_result();
    $counting = $stmt->num_rows();

    if($counting == '1')
    {

   $updatesql = "UPDATE Teacher SET Active = ? WHERE TeacherUsername = ? AND Code = ?";                                         
    $update = $mysqli->prepare($updatesql);
    $update->bind_param("iss", 1, $user_to_be_activated, $code_to_be_matched);
        $update->execute();
        $update->close();

        echo "Account is Activated";
    }
    else
    {
        echo "The Code and Username doesn't match! Account is not Activated.";
    }

        ?> 
```

我只是希望它能够在第一次单击链接时激活帐户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T22:11:50.427

我是怎么做到的：

当用户通过以下方式激活他的帐户时，在您的数据库（新列）中创建一个 security_key：

```
 example.com/activate/username/security_key 
```

它将“激活”列设置为 1。现在设置一个新的哈希，所以不可能“再次”激活它并得到一些奇怪的错误。

现在，当用户想要登录时，他没有设置任何凭据，但电子邮件是已知的。因此，只需向他发送一封带有恢复链接的“丢失密码”电子邮件：

```
 example.com/set-password/username/security_key 
```

出于安全原因，最好在他的行中的每次更新时刷新 security_key。因此，您永远不会遇到第 3 方用户（黑客）看到他的安全密钥的奇怪事件。

我希望这对你有帮助:)

结论，呼吸新鲜空气，花点时间，以清醒的头脑再看一遍。最好先在纸上画出这样的系统，这样你就知道你在做什么。（我做了同样的事情，它确实帮助了我！）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T23:41:17.593

明白了，错误在这里：

$update->bind_param("iss", 1, $user_to_be_activated, $code_to_be_matched);

只是它没有通过 1，我不确定为什么它没有显示错误。

所以你可以把那个数字 1 放入一个变量中，然后在你的 sql 代码中使用它，如下所示：

所以整个代码：

```
 $code_activated = 1;

// don't use $mysqli->prepare here
    $query = "SELECT TeacherUsername, Active, Code FROM Teacher WHERE TeacherUsername = ? AND Code = ? ";
    // prepare query
    $stmt=$mysqli->prepare($query);
    // You only need to call bind_param once
    $stmt->bind_param("ss",$user_to_be_activated, $code_to_be_matched);
    // execute query
    $stmt->execute(); 
    // get result and assign variables (prefix with db)
    $stmt->bind_result($dbTeacherUsername, $dbActive, $dbCode);
    //get number of rows
    $stmt->store_result();
    $counting = $stmt->num_rows();

    if($counting == '1')
    {

   $updatesql = "UPDATE Teacher SET Active = ? WHERE TeacherUsername = ? AND Code = ?";                                         
    $update = $mysqli->prepare($updatesql);
    $update->bind_param("sss", $code_activated, $user_to_be_activated,  $code_to_be_matched);
        $update->execute() or die(mysql_error());
        $update->close();

        echo "Account is Activated";
    }
    else
    {
        echo "The Code and Username doesn't match! Account is not Activated.";
    } 
```

你可以在这里测试：

[http://design05.comuf.com/avtivate.php](http://design05.comuf.com/avtivate.php)

有以下细节：

用户：师傅

代码：bbb111

[http://design05.comuf.com/avtivate.php?user=master&code=bbb111](http://design05.comuf.com/avtivate.php?user=master&code=bbb111)

用户：管理员

代码：abc123

[http://design05.comuf.com/avtivate.php?user=admin&code=abc123](http://design05.comuf.com/avtivate.php?user=admin&code=abc123)

当然尝试一些错误的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T00:05:44.743

似乎您生成了一个存储在数据库中的随机代码，然后生成了另一个添加到电子邮件中的代码。这两个代码可能不同:)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-08-26T09:20:34.533

您只需要删除第二个代码 md5，因为您已经拥有一次代码 md5。

# c++ - c++ 多线程单例 - 这段代码有什么问题

> ID：12125975
> 
> 赞同：1
> 
> 时间：2012-08-25T21:58:34.373
> 
> 标签：c++, multithreading, singleton

```
template <typename T, typename Lock>
class Singleton
{
public:
static T * getInstance()
{
    if (obj == 0)
    {
        lock.lock();
        if (obj == 0)
        {
            obj = new T;
        }
        lock.unlock();
    }
    return obj;
}

void deleteInstance()
{
   delete obj;
   obj = 0;
}

private:
volatile static T * obj = 0;
static Lock lock; // some sort of mutex
Singleton();
~Singleton();
Singleton(const Singleton &);
Singleton & operator=(const Singleton &);
}; 
```

obj 是否必须是 volatile 的？如果第一个线程创建 T 实例并假设第二个线程在此之前已经在缓存中加载了 0 的 obj，那么现代处理器缓存是否会失效，或者第二个线程可能会使用 obj 的 0 值并创建 T第二次？假设两个线程都在不同的内核中运行。

另外，请让我知道使用静态 T * 而不是静态 T 作为单例数据可能出现的任何问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T22:04:55.567

该`getInstance()`方法是使用[双重检查锁定](https://en.wikipedia.org/wiki/Double-checked_locking)。双重检查锁定本质上是危险的，因为可能会根据编译器为该行生成代码的方式引入竞争条件：

```
obj = new T; 
```

这条线基本上涉及以下三个步骤：

1.  分配`sizeof (T)`字节。
2.  `T`在分配的空间中构造一个对象。
3.  将指向分配空间的指针分配给`obj`.

问题是，编译器不需要生成按顺序执行这些步骤的代码。例如，它可以分配`sizeof (T)`字节，然后分配`obj`，*然后*`T`就地构造。在这种情况下，存在两个不同的线程可以构造一个新`T`对象的竞争条件。此外，两个不同的线程可以尝试`T`在同一个地方构造一个对象。

请参阅Scott Meyers 和 Andrei Alexandrescu[的 C++ 和双重检查锁定的危险。](http://www.aristeia.com/Papers/DDJ_Jul_Aug_2004_revised.pdf)

就 而言`deleteInstance()`，您可能不应该提供这样的功能，因为它允许您`T`在其他线程仍在使用它时意外地删除对象的错误。

**编辑：**避免双重检查锁定的实现`getInstance()`是：

```
static T * getInstance()
{
    lock.lock();
    if (!obj)
    {
        try
        {
            obj = new T;
        }
        catch (...)
        {
            obj = NULL;
            lock.unlock();
            throw;
        }
    }
    lock.unlock();
    return obj;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T22:01:36.477

很好，`getInstance`没有必要做会员`volatile`。

但是，如果从不同的线程调用它`deleteInstance`，它可能会执行双重删除（即使在检查后）。`NULL`

另一个问题是它`deleteInstance`不会重置`obj`为`NULL`，因此在删除后，`getInstance`将返回一个悬空指针，而不是创建一个新对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-25T23:45:14.520

That is a horrible way of implementing a singleton (and implementing a singleton is a questionable practice in the first place...). If you are using a compiler which supports the relevant parts of C++11, you should use a static local variable:

```
template<typename T>
T& getInstance() {
    static T instance;
    return instance;
} 
```

Otherwise you should use something like [call_once](http://www.boost.org/doc/libs/release/doc/html/thread/synchronization.html#thread.synchronization.once) from Boost.Thread:

```
//singleton.hpp
T& getInstance();

//singleton.cpp
static T* singleton;
static boost::once_flag flag=BOOST_ONCE_INIT;

static void initialize() {
    singleton = new T();
}

T& getInstance() {
    boost::call_once(flag, initialize);
    return *singleton;
} 
```

Another option is to add a function to explicitly initialize your globals, and then to call that before starting any new threads.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-25T22:08:51.057

您不需要使变量易失。互斥锁操作通常由 XCHG 处理器指令实现，该指令还用作内存屏障（至少在 Intel 处理器上）——它将强制从内存而不是缓存中读取变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-26T00:30:18.777

如果你有 C++11，让`obj`原子化，所有的问题`getInstance`都消失了。

```
static std::atomic<T*> obj; 
```

和

```
template <typename T, typename Lock>
std::atomic<T*> Singleton<T, Lock>::obj = 0; 
```

`deleteInstance`需要更多的工作：

```
T *tmp = 0;
obj.exchange(tmp);
delete tmp; 
```

但是`deleteInstance`很危险，因为该类不知道是否有任何未完成的指针，因此调用此函数可能会将对象从某个无辜线程下拉出。

# c# - UpdateProgress 微调器在 90 秒后消失

> ID：12125977
> 
> 赞同：2
> 
> 时间：2012-08-25T21:58:47.727
> 
> 标签：c#, asp.net, sharepoint

我的 UpdateProgress 在 UpdatePanel 之外，我尝试了以下方法

1.  添加了 JavaScript，在母版页中添加了“AsyncPostBackTimeout=3600”
2.  `Page-Load`在事件中添加了以下代码

    `ScriptManager _scriptMan = ScriptManager.GetCurrent(this.Page);`
    `_scriptMan.AsyncPostBackTimeout = 3600;`

3.  在 web.config 文件中添加了以下更改：

    `<system.web>`
    `<httpRuntime maxRequestLength="2097151" requestLengthDiskThreshold="1000" executionTimeout="3600" />`
    `</system.web>`

在此更改后，UpdateProgress 微调器也会出现 90 秒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T21:45:16.833

在我在 ScriptManager 标记本身上设置 AsyncPostBackTimeout 之前，我遇到了同样的问题。

```
<asp:ScriptManager ID="ScriptManager1" runat="server"
 AsyncPostBackTimeout="600" /> 
```

# r - 如何根据条件在 data.frame 中创建新变量？

> ID：12125980
> 
> 赞同：17
> 
> 时间：2011-04-19T08:50:53.817
> 
> 标签：r, dataframe

假设我们有一个数据框

```
x   y
1   1
2   4 
4   5 
```

如何向数据框添加一个新变量，如果 x 小于或等于 1，则返回“好”，如果 x 介于 3 和 5 之间，则返回“坏”，否则返回“公平”

```
x   y  w
1   1  "good"
2   2   "fair"
5   5   "bad" 
```

应用了 ocram. 所示的方法，但是这里的这个方法不起作用。

```
d1 <- c("e", "c", "a")
d2 <- c("e", "a", "b")

w <- ifelse(d1 == "e" & (d2=="e"), 1, ifelse((d1 == "a") & (d2 =="b"), 2, ifelse(d1 == "e"),3,99)) 
```

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2011-04-19T08:55:53.547

一种明显且直接的可能性是使用“if-else 条件”。在那个例子中

```
x <- c(1, 2, 4)
y <- c(1, 4, 5)
w <- ifelse(x <= 1, "good", ifelse((x >= 3) & (x <= 5), "bad", "fair"))
data.frame(x, y, w) 
```

** 对于编辑中的附加问题** 这是您所期望的吗？

```
> d1 <- c("e", "c", "a")
> d2 <- c("e", "a", "b")
> 
> w <- ifelse((d1 == "e") & (d2 == "e"), 1, 
+    ifelse((d1=="a") & (d2 == "b"), 2,
+    ifelse((d1 == "e"), 3, 99)))
>     
> data.frame(d1, d2, w)
  d1 d2  w
1  e  e  1
2  c  a 99
3  a  b  2 
```

如果您对该`ifelse`功能不满意，您还可以使用`if`and`else`语句来处理此类应用程序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-26T07:46:21.347

如果您的级别数量非常有限，您可以尝试转换`y`为因子并更改其级别。

```
> xy <- data.frame(x = c(1, 2, 4), y = c(1, 4, 5))
> xy$w <- as.factor(xy$y)
> levels(xy$w) <- c("good", "fair", "bad")
> xy
  x y    w
1 1 1 good
2 2 4 fair
3 4 5  bad 
```

# html - 单击时消失的表单中的CSS文本？

> ID：12125988
> 
> 赞同：0
> 
> 时间：2012-08-25T22:00:42.590
> 
> 标签：html, css, forms

我正在制作的表单有两个问题，第一个是我想在表单上添加一些 CSS。这适用于我的`<textarea>`盒子，因为它有一个结束标签，您可以将文本放在两者之间。`<input>`另一方面，标签必须通过标签获取文本，`value=""`这不会响应我的任何 CSS 尝试。

其次，我想知道是否可以在单击该框后自行清除。（不确定 HTML 表单是否支持）

这是带有css的表单的链接，因此您可以看到问题。[http://jsfiddle.net/D39rr/5/](http://jsfiddle.net/D39rr/5/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T22:04:48.300

您正在寻找`placeholder`属性：

```
<input placeholder="Your email address" /> 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/LVuuY/)。

要设置文本样式`placeholder`（在兼容的浏览器中）：

```
::-webkit-input-placeholder,
::-moz-input-placeholder,
::-o-input-placeholder,
::-ms-input-placeholder,
::input-placeholder {
    color: #0f0;
    font-weight: bold;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/LVuuY/3/)。

要设置文本的样式，无论是来自`value`属性还是用户输入，只需使用通常`color`的 、`font-style`、`font-weight`等：

```
input {
    color: #f00;
    font-size: 1.5em;
    font-style: italic;
    font-weight: bold;
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/LVuuY/1/)。

顺便说一句，`textarea`正如您正确指出的那样，“有一个结束标签”。因此，它*不是*一个自关闭（或 void）元素，并且它的开始标签中不应*有*一个`/`字符（就像您在链接的 JS Fiddle: 中所做的那样`<textarea id="style" name="message" />Type out your question here</textarea>`），而应该是：

```
<textarea id="style" name="message">Type out your question here</textarea> 
```

或者，使用`placeholder`：

```
<textarea id="style" name="message" placeholder="Type out your question here"></textarea> 
```

同样值得注意的是，使用`placeholder`替换 a`label`意味着一旦用户将注意力集中在该字段或将数据输入到该字段中，所提供的任何指导都会被显式隐藏。如果您不希望`label`元素一直可见，那么仅在`input`聚焦时显示指导的一种方法是：

```
label {
    display: inline;
    opacity: 0;
    overflow: hidden;
    -webkit-transition: all 1s linear;
    -moz-transition: all 1s linear;
    -o-transition: all 1s linear;
    -ms-transition: all 1s linear;
    transition: all 1s linear;
}

input:focus + label,
input:active + label {
    opacity: 1;
    -webkit-transition: all 1s linear;
    -moz-transition: all 1s linear;
    -o-transition: all 1s linear;
    -ms-transition: all 1s linear;
    transition: all 1s linear;
}​ 
```

一旦`input`聚焦/激活就会触发显示：[JS Fiddle demo](http://jsfiddle.net/davidThomas/LVuuY/5/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T22:06:16.067

您正在寻找的是`placeholder`属性。有关示例和样式信息，请参阅 David Walsh 关于[HTML5 Placeholder Styling with CSS的文章。](http://davidwalsh.name/html5-placeholder-css)该`placeholder`属性有[很好的支持](http://caniuse.com/#feat=input-placeholder)，除了IE。不过，您可以使用 Javascript 重新创建`placeholder`属性的效果……我喜欢使用[Webshims 库](http://afarkas.github.com/webshim/demos/demos/webforms.html)来逐步填充 HTML5 表单功能（包括其他属性，如`type="date"`和`required="required"`）。

# stata - 如何在 Stata 中对组内的观察结果进行排名？

> ID：12125989
> 
> 赞同：4
> 
> 时间：2011-05-18T10:42:55.837
> 
> 标签：stata

我在Stata中有一些数据，看起来像前两列：

```
group_id   var_to_rank  desired_rank
____________________________________

1           10          1
1           20          2
1           30          3
1           40          4
2           10          1
2           20          2
2           20          2
2           30          3 
```

我想根据一个变量（var_to_rank）在组（group_id）中创建每个观察的排名。通常，为此我使用：

```
gen id = _n 
```

但是，我的一些观察结果（在我的小示例中为 group_id = 2）具有相同的排名变量值，这种方法不起作用。

我也尝试过使用：

```
egen rank 
```

命令具有不同的选项，但不能使我的排名变量看起来像desired_rank。

你能指出我解决这个问题的方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-05-18T11:40:15.377

以下对我有用：

```
bysort group_id: egen desired_rank=rank(var_to_rank) 
```

![在此处输入图像描述](../Images/bbfd768e249a4bc0a6e98e5b6d303af2.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-05-18T13:41:19.027

[在Statalist](http://statalist.1588530.n2.nabble.com/st-Ranking-observations-within-groups-td1643494.html)上偶然发现了这样的解决方案：

```
bysort group_id (var_to_rank) : gen rank = var_to_rank != var_to_rank[_n-1]
by group_id : replace rank = sum(rank) 
```

似乎解决了这个问题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-05T13:00:49.083

为了更好地理解，我会说这个问题是错误的。目的是对观察结果进行分组，那些具有最低值的都被分配为 1 级，次低的都被分配到 2 级，依此类推。在我所看到的讨论中，这并不是大多数意义上的排名，但 Stata`egen, rank()`确实让你成为其中的一部分。

[但是，在该线程（从此处开始](https://www.stata.com/statalist/archive/2008-12/msg00596.html)）中引用的Statalist线程中提到的直接方法在精神上比引用的任何解决方案都简单：

```
bysort group_id (var_to_rank): gen desired_rank = sum(var_to_rank != var_to_rank[_n-1]) 
```

一旦数据被排序，`var_to_rank`那么当值与每个不同值块开头的先前值不同时，值 1 是`var_to_rank != var_to_rank[_n-1]`; 否则结果为 0。将这些 1 和 0 累加起来就可以得到所需的变量。前缀命令`bysort`执行所需的排序，并确保这一切都在由定义的组内单独完成`group_id`。根本不需要`egen`（许多只偶尔使用 Stata 的人经常觉得奇怪的命令）。

利益声明：引用的国家主义线程表明，当被问到类似的问题时，我也没有想到这个解决方案。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-04T20:42:53.730

@radek：你肯定在此期间把它整理好了......但这将是一个简单（虽然不是很优雅）的解决方案：

```
bysort group_id:   egen desired_rank_HELP =rank(var_to_rank), field
egen desired_rank      =group(grup_id desired_rank_HELP)
drop desired_rank_HELP 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-29T11:29:37.240

工作量太大了。轻松优雅。试试这个。

生成期望排名=int（var_to_rank/10）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-14T07:57:09.043

试试这个命令，它对我很有效：`egen newid=group(oldid)`

# tomcat6 - 在 Tomcat 响应中强制分块编码

> ID：12125993
> 
> 赞同：1
> 
> 时间：2012-08-25T22:01:35.643
> 
> 标签：tomcat6, chunked-encoding

我正在将一个客户的应用程序迁移到 Tomcat 6。在测试期间，我们发现他们的一些客户希望响应**总是**被分块，即 Transfer-encoding: chunked。但是，Tomcat 并不总是使用分块编码，有时使用 Content-Length 来代替，我假设是因为响应大小足够小，以至于在发送标头时它知道整个长度。

我已经看到了大量关于如何禁用分块编码的问题/答案，但我遇到了相反的问题。我知道在每个响应中**强制**分块编码并不理想，并且客户端应该与 http1.1 规范完全兼容并接受任何一种编码，但我只是想找出是否有任何简单的配置可以做以启用所需的行为。

我单独使用 Tomcat 和标准的 http 连接器。我查看了连接器属性并玩弄了 bufferSize 和 socketBuffer ，但没有运气。

我能做些什么来强制分块响应吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T16:34:44.293

以防万一其他人遇到这种情况，我找到了一个 hacky 解决方案。在写入任何内容之前，我会立即刷新输出流。这迫使 Tomcat 立即发送响应标头并使用分块编码。我知道这很糟糕，因为这意味着它会在我完成处理之前立即发送一个 200 状态代码，但这是我能找到强制分块编码的唯一方法。

# image-processing - 是否可以使用 Coldfusions cfthread 延迟加载图像？

> ID：12125997
> 
> 赞同：1
> 
> 时间：2012-08-25T22:01:44.010
> 
> 标签：image-processing, coldfusion, lazy-loading, cfthread

我正在跑步`coldfusion8/MySQL5.0.88`，我有一个产品搜索，我需要在显示它们之前从各种外部来源中提取并调整图像大小。

虽然我主要可以在创建产品时执行此操作（相对于被搜索），但我无法确保所有图像都可以从我的服务器以调整大小的格式提供，因此我需要在产品搜索中进行某种回退。

现在，我正在检查图像在服务器上是否可用，如果没有，我会启动一个例程来抓取并调整图像大小，如下所示：

```
// check if image is available
<cfif results.typ NEQ "img" AND results.typ NEQ "alt">
    <cfif results.bildpfad neq "" AND results.bilddateiname neq "">
    <cfset imgSuccess = form_img_handler.upload
        ( command   = "upload_search"
        , imgPath   = results.bildpfad
        , imgFile   = results.bilddateiname
        , sellerILN = results.iln
        , cookie    = variables.screenWidth
        )/>
    <cfif imgSuccess EQ "false">
        <cfset variables.imgFail = "true">
    </cfif>
 </cfelse>
     <cfset variables.imgFail = "true">
 </cfif>

// missing img
<cfif variables.imgFail EQ "true">
    <cfoutput><div class="resultsImgWrap noImgFound"></div></cfoutput> 
    <cfset variables.imgFail = "false">
<cfelse>
// show image
    <cfoutput><div class="resultsImgWrap"><img src="#variables.imageSrc#" /></div></cfoutput>
</cfif> 
```

该`upload`函数处理`cfhttp`请求和调整大小并返回`true/false`。

我想知道是否可以`cfthread`在这种情况下使用，因此当用户进行搜索时，我会输出包含正确 URL 链接的标记，但图像拉取/调整大小/保存到目标将在 a`cfthread`中完成，以便加快向用户显示结果。

**问题**：
图像会在处理完成后显示，还是在尝试加载尚未创建的图像时（可能）`cfthread`会产生错误？`404`是否有任何其他方式可以向用户显示某些内容并让用户在上传和处理图像时继续？

感谢您的投入！

**编辑：**
好的。根据答案，我想出了以下内容。虽然还没有工作，但我认为它朝着正确的方向发展。

```
// check media log, if image is logged (already created), if so, load it, if not pull it from external
<cfif results.typ NEQ "img" AND results.typ NEQ "alt">
    // check path and filename
    <cfif results.bildpfad neq "" AND results.bilddateiname neq "">
        // pull in
        // arguments: 
        // cm = form
        // pt = path to image
        // fl = filename
        // se = seller id  
        // ck = screen width (I'm using adaptive image sizes
        // ax = origin
        // gb = which image size to return
        <cfset variables.imgSrc = expandPath("../services/img_handler.cfc") & "?method=up&cm=results&pt=" & results.bildpfad & "&fl=" & results.bilddateiname & "&se=" & results.id & "&ck=" & variables.screenWidth & "&ax=rm&gb=s">
    <cfelse>
        cfset variables.imgFail = "true">
    </cfif>
</cfif>

<cfif variables.imgFail EQ "true">
    <cfoutput><div class="resultsImgWrap noImgFound"><img src="../images/not_found.png"></div></cfoutput>
    <cfset variables.imgFail = "false">
 <cfelse>
    <cfoutput><div class="resultsImgWrap"><a class="swipeMe" rel="external" href="#variables.zoomSrc#">
                <img src="#variables.imageSrc#" class="adaptImg ui-li-thumb" /></a>
              </div></cfoutput>
</cfif> 
```

因此，这将检查我正在查询的媒体日志中的图像以及结果（避免对现有图像进行不必要的 s3 检查）。如果日志中没有图像，我将检查路径/文件名是否为空并触发我的`intelligent`图像加载器，它执行以下操作：

```
<cfcomponent output="false" hint="image handler">
    <cffunction name="Init" access="public" returntype="any" output="false" hint="Initialize">
        <cfreturn true />
    </cffunction>       

    <cffunction name="upload" access="remote" output="false" hint="creates images and stores them to S3">
        <cfargument name="cm" type="string" required="true" hint="" /> 
        <cfargument name="pt" type="string" required="true" hint="" /> 
        <cfargument name="fl" type="string" required="true" hint="" />
        <cfargument name="se" type="string" required="true" hint="" />
        <cfargument name="ck" type="string" required="true" hint="" />
        <cfargument name="gb" type="string" required="false" hint="" />
        <cfargument name="ax" type="string" required="false" hint="" />

        <cfscript>  
           var LOCAL = {};  
           // arguments
           LOCAL.command = cm;
           LOCAL.imgPath = pt;
           LOCAL.imgFile = fl;
           LOCAL.sellerILN = se;
           LOCAL.cookie = LSParseNumber(ck);
           LOCAL.getBack = gb;
           LOCAL.access = ax;
           // s3
           // commander
           if ( LOCAL.command NEQ "" ) {
                LOCAL.action = LOCAL.command;
           } else {
                LOCAL.action = "upload";
                }
           // s3 misc
           LOCAL.bucketPath = Session.bucketPath;
           LOCAL.bucketName = Session.bucketName;
           LOCAL.acl = "public-read";
           LOCAL.storage = "";
           LOCAL.tempDirectory = expandPath( "../members/img/secure/" );
           LOCAL.allow = "png,jpg,jpeg";
           LOCAL.failedLoads = "";
           LOCAL.altFailedLoads = "";
           LOCAL.createBucket = "false";
           LOCAL.errorCount = 0;
           LOCAL.altErrorCount = 0;
           LOCAL.cacheControl = 1;
           LOCAL.contentType = "image";
           LOCAL.httptimeout = "300";
           LOCAL.cacheDays = "30";
           LOCAL.storageClass = "REDUCED_REDUNDANCY";
           LOCAL.keyName = "";
           LOCAL.baseUrl = "http://www.baseurl.com";
           LOCAL.imageSrc = "";
           LOCAL.testFilePath = LOCAL.imgPath & LOCAL.imgFile;
           LOCAL.fileExt = ListLast(LOCAL.testFilePath, ".");
           LOCAL.runner = "s,m,l,xl";
           LOCAL.worked = "true";
      </cfscript>   
      // runner is the file size setter, in results I only create two sizes, during imports I create all four
      <cftry>
        <cfhttp timeout="45" 
            throwonerror="no" 
            url="#LOCAL.testFilePath#" 
            method="get" 
            useragent="Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.8.1.12) Gecko/20080201 Firefox/2.0.0.12" 
            getasbinary="yes" 
            result="objGet">
        <cfscript>
            // set file sizes to create
            if ( LOCAL.command EQ "upload_search" ){
                if ( LOCAL.cookie LT 320 ) {
                    LOCAL.runner = "l,s";
                    }
                else if ( LOCAL.cookie GTE 320 AND LOCAL.cookie LTE 767 ) {
                    LOCAL.runner = "l,m";
                    }
                else if ( LOCAL.cookie GT 768 ) {
                    LOCAL.runner = "xl,m";
                    }
                else if ( LOCAL.cookie GT 1280 ){
                    LOCAL.runner = "xl,l";
                    }
                } else if ( LOCAL.command EQ "upload_import") {
                    LOCAL.runner = "xl,l,m,s";
                    }
            // validate
            if ( len(objGet.Filecontent) EQ 0 OR objGet.Mimetype EQ "text/html"  ){
                LOCAL.worked = "false length or mime";
                } else if ( NOT listfindnocase(LOCAL.allow, LOCAL.fileExt ) ){
                LOCAL.worked = "false wrong extension";
                } else {
                // create temp
                LOCAL.objImage = ImageNew(objGet.FileContent);
                LOCAL.basePath = LOCAL.tempDirectory & "_base_" & LOCAL.imgFile;
                imageWrite( LOCAL.objImage, LOCAL.basePath, ".99");
                LOCAL.base = imageRead( LOCAL.basePath );
                LOCAL.imageSrc = LOCAL.tempDirectory;

                // formats
                // S = 100x127, 
                // M = 180x230, 
                // L = 290x370, 
                // XL = 870x1110 

                // portrait
                if ( ImageGetWidth( LOCAL.base ) LT ImageGetHeight( LOCAL.base ) ){
                    for (LOCAL.i = 1; LOCAL.i LTE ListLen(LOCAL.runner,","); LOCAL.i = LOCAL.i+1){
                        LOCAL.lt = ListGetAt(LOCAL.runner, LOCAL.i, ",");
                        LOCAL.base = imageRead( LOCAL.basePath );
                        ImageSetAntialiasing(LOCAL.base,"on");
                        // default image width/height
                        LOCAL.height = Application.strConfig.respH[LOCAL.lt];
                        LOCAL.width = "";
                        ImageScaleToFit(LOCAL.base, LOCAL.width, LOCAL.height, "highestQuality");

                        LOCAL.filekey = LOCAL.lt & "_" & LOCAL.imgFile;
                        LOCAL.keyName = LOCAL.sellerILN & "/" & LOCAL.filekey;
                        LOCAL.filename = LOCAL.tempDirectory & LOCAL.filekey;
                        imageWrite( LOCAL.base, LOCAL.filename, ".99" );

                        // s3
                        Application.strObjs.s3.putObject(LOCAL.bucketName, LOCAL.filekey, LOCAL.contentType, LOCAL.httptimeout, LOCAL.cacheControl, LOCAL.cacheDays, LOCAL.acl, LOCAL.storageClass, LOCAL.keyName, LOCAL.imageSrc, "false" );
                        fileDelete( LOCAL.tempDirectory & LOCAL.lt & "_" & LOCAL.imgFile );
                        }
                    } else {
                    // same for landscape
                    ...
                    }
                }
                // cleanup
                fileDelete( LOCAL.tempDirectory & "_base_" & LOCAL.imgFile );
            } 
        </cfscript>
    // update media log
        ...
        <cfcatch>
        // dump errror message
        </cfcatch>
        </cftry>

    // return image 
        <cfif LOCAL.access EQ "rm">
            <cftry>
            <cfscript>
            if ( LOCAL.getBack EQ "s" ){
                LOCAL.passPath = Session.bucketPath & Session.bucketName & "/" & LOCAL.sellerILN & "/" & ListGetAt(LOCAL.runner, Listlen(LOCAL.runner), ",") & "_" & LOCAL.imgFile;
            } else if( LOCAL.getBack EQ "l" ) {
                LOCAL.passPath = Session.bucketPath & Session.bucketName & "/" & LOCAL.sellerILN & "/" & ListGetAt(LOCAL.runner, 1, ",") & "_" & LOCAL.imgFile;
            }
            LOCAL.mime = "image/" & LOCAL.fileExt;
            </cfscript>

            <cfcontent type="#LOCAL.mime#" file="#LOCAL.passPath#" />
            <cfcatch>
            // dump errors
            </cfcatch>                              
        </cftry>
    <cfelse>
        <cfreturn LOCAL.worked>
    </cfif>
    </cffunction>
</cfcomponent> 
```

因此，我正在设置要创建的文件大小`LOCAL.runner`并查看此列表，将基础图像的大小调整为我预设的图像尺寸并将创建的图像存储在 s3 上。

**问题**： `cfcontent`试图在创建之前返回图像。`The file specified in contentTag does not exist`运行上面的代码时出现错误。如果我检查 S3，图像就在那里，所以我假设这是一个时间问题。

感谢您提供有关如何强制“cfcontent”等到创建图像的任何指示！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T22:20:14.207

将链接输出到将加载 img 的本地 CFM 怎么样？我的意思是 - 对于您服务器上存在的图像，您输出`<img>`指向它的标签。对于您需要加载的图像，您会输出如下内容：

```
<img src="imagegetter.cfm?p=#urlofimagetoload#"> 
```

`imagegetter.cfm`将负责执行 http 以在本地获取和调整图像大小。然后它可以通过 cfcontent 提供这些位。

# iphone - iOS 方向

> ID：12125998
> 
> 赞同：0
> 
> 时间：2012-08-25T22:01:50.840
> 
> 标签：iphone, objective-c, ios

我可以在 UITabBarController 内的 iOS 中更改方向吗？我有这样的东西： UITableViewController-> Team Tab -> UINavigationController -> GalleryViewController 我想只允许 GalleryViewController 更改横向方向是 iOS 可能吗？

如果我设置

```
- (NSUInteger)supportedInterfaceOrientations to UIInterfaceOrientationMaskPortrait 
```

对于 UITabBarController，我无法更改 GalleryViewController 的方向，它始终是纵向的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T22:08:53.540

如果我们从 iOS6 中抽象出来，看一下[Tab Bar Controllers and View Rotation](http://developer.apple.com/library/ios/documentation/WindowsViews/Conceptual/ViewControllerCatalog/Chapters/TabBarControllers.html#//apple_ref/doc/uid/TP40011313-CH3-SW26)文章：

> 标签栏控制器默认支持纵向，除非所有包含的视图控制器都支持这样的方向，否则不会旋转到横向。当设备方向发生变化时，标签栏控制器会查询其视图控制器数组。如果其中任何一个不支持方向，则标签栏控制器不会更改其方向。

这意味着选项卡栏中的**所有**其他视图控制器都应支持所需的方向。