# StackOverflow 问答 11837000-11837999

# mysql - mysql搜索具有相同列值的多个值

> ID：11837007
> 
> 赞同：0
> 
> 时间：2012-08-06T22:42:59.527
> 
> 标签：mysql

编辑更准确的问题：
我有一个表：id、supplierCode、propertyCode、specification。在产品中进行搜索时，我想获得规格具有像 value1 和 value2 这样的文本的产品，所以要获得这些产品，我想要一个类似这样的查询：
`SELECT * FROM tbl WHERE (specification LIKE '%value1%' OR specification LIKE '%value2%') AND (those 2 got rows has the same supplierCode)`
或者从问题的另一端：获取所有供应商代码的行供应商代码在规范列中有 LIKE '%value1%' AND LIKE '%value2%'
示例：
id supplierCode propertyCode, specification
1 001234 11 i7-blabla
2 001234 13 15.3"
3 004321 15 i7-9761
4 004321 16 15.4"
5 003214 14 i7-15.3"

如果我要搜索 'i7' 和 '15.3"' 我可以得到 001234 和 003214 因为他们的规格中有 i7 和 15.3"

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:50:30.087

您可以使用 IN 子句——一定要多研究一下这个问题，您肯定会在网络的某个地方找到解决方案。

```
 SELECT * FROM tbl 
    WHERE specification IN ('value1', 'value2')
      AND propertyCode = 'SOME_VALUE' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:52:30.107

你可以使用**like**关键字

[模式匹配](http://dev.mysql.com/doc/refman/5.0/en/pattern-matching.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T22:53:00.997

```
 SELECT * FROM tbl 
 WHERE (specification='%value1%' OR specification='%value2%') 
 group by propertyCode 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T22:54:15.877

```
$find = mysql_query("SELECT * FROM `tbl` WHERE (`specification` LIKE '%$value1%' OR `specification` LIKE '%$value2%') AND `propertyCode`='$propertycode'")or die(mysql_error());
$display = mysql_fetch_array($find); 
```

请记住，您将需要更改 PHP 变量，因为您没有包含任何我必须假设您正在寻找类似上述内容的内容。

此外，如果您要创建一个列表，那么您将需要在您的 fetch 上使用 while 语句。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T22:48:46.470

使用`LIKE`而不是`= sign`

```
SELECT * 
FROM tbl 
WHERE (
       specification LIKE CONCAT('%', value1, '%') OR 
       specification LIKE CONCAT('%', value2, '%') 
      ) AND 
      propertyCode = valueHere 
```

但是如果您确定规格值使用`IN`而不是`OR`（实际上它们是相同的）

```
SELECT * 
FROM tbl 
WHERE  specification IN ('value1','value2') AND 
       propertyCode = valueHere 
```

# php - 从众多 URL 中提取包含 /find/ 的 URL？

> ID：11837009
> 
> 赞同：2
> 
> 时间：2012-08-06T22:43:03.267
> 
> 标签：php, regex

我真的是 RegEx 的主要新手，可以提供一些帮助。

我有一个包含大量 URL 和其他文本的长字符串，其中一个 URL 包含 /find/。IE：

```
1\. http://www.example.com/not/index.html
2\. http://www.example.com/sat/index.html
3\. http://www.example.com/find/index.html
4\. http://www.example.com/rat/mine.html
5\. http://www.example.com/mat/find.html 
```

我将使用哪种正则表达式来返回该列表中第 3 位的 URL，但也不返回第 5 位的 URL？我想基本上我正在寻找的是一种按顺序返回包含一组特定字母和 / 的整个单词的方法。

TIA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T22:46:18.110

我会假设你想要`preg_match("%/find/%",$input);`或类似的。

编辑：要获得完整的行，请使用：

```
preg_match("%^.*?/find/.*$%m",$input); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T23:16:50.937

我可以建议您使用[RegExr](http://gskinner.com/RegExr/)生成正则表达式。

您可以输入示例列表（如上面的列表）并使用调色板创建 RegExp 并实时测试它。该程序可在线获取，也可作为可下载的 Adob​​e AIR 包获取。

不幸的是，我现在无法访问他们的网站，所以我附上[了可下载版本的 AIR 包](https://dl.dropbox.com/u/9287758/Programmi%20consigliati/RegExr.air)。

我真的向你推荐这个，因为它可以帮助像我这样的 RegExp 新手设计最复杂的模式。

但是，对于你的问题，我认为只是

```
\/find\/ 
```

如果您想获得是/否结果（即，如果它包含或不包含），则顺利`/find/`，否则获得全行使用

```
.*\/find\/.* 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T22:58:27.433

除了 Kolink 的回答之外，如果您想正则表达式匹配整个 URI：

这**绝不是**一个详尽的 URI 正则表达式，但这[是一个很好的起点](http://rubular.com/r/mRqZuNAG9h)。我在关键点添加了一些选项，例如`.com`、`.net`和`.org`。实际上，由于缺乏一致性，您将很难将 URI 与正则表达式匹配，但您可以非常接近

来自上述链接的正则表达式：

`/(https?:\/\/)?(www\.)?([a-zA-Z0-9-_]+)\.(com|org|net)\/(find)\/([a-zA-Z0-9-_]+)\.(html|php|aspx)?/is`

# visual-studio-2010 - RDLC 文件仅在设计器中以文本形式打开

> ID：11837011
> 
> 赞同：2
> 
> 时间：2012-08-06T22:43:04.623
> 
> 标签：visual-studio-2010, rdlc

我有一个 RDLC 文件，它在设计器中仅以文本 (xml) 形式打开，我如何强制它恢复为默认值以使用设计器打开。（我需要来回走动）。

我发誓我已经在 Stack 上看到了这个，但是对于我的谷歌我找不到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-06T14:13:38.767

当我们更改 Visual Studio 中任何文件类型的默认设置时，就会出现此问题。

请按照以下步骤解决此类问题：

*   您可以右键单击该文件！
*   选择打开方式
*   单击报告设计器。
*   点击“设置为默认值”
*   点击确定

你现在应该准备好了。它现在将始终在报表设计器中打开。

![在此处输入图像描述](../Images/48c2bacb4ca7a44e5987fc9a45cde31a.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T14:50:07.203

我刚遇到这个问题...

我通过在设计器中打开的项目中添加一个新报告来解决。

设计器正确打开后，现有报表也在设计器中打开，而不是 XML。

# python - 如何将内存中的django文件上传到S3

> ID：11837013
> 
> 赞同：3
> 
> 时间：2012-08-06T22:43:28.983
> 
> 标签：python, django, amazon-s3

我正在尝试在不使用自定义后端的情况下将文件上传到 S3。这是我到目前为止所拥有的：

```
conn=boto.connect_s3(settings.AWS_KEY, settings.AWS_SECRET)
bucket=conn.get_bucket(settings.AWS_BUCKET)
k = Key(bucket)

filename = f.name
keyname = str(int(uuid.uuid4()))[:10] + filename
k.key = keyname
k.set_contents_from_filename(f)
url = "https://s3.amazonaws.com/.../" + keyname 
```

我收到以下错误：

```
TypeError at /qc/86/
coercing to Unicode: need string or buffer, InMemoryUploadedFile found 
```

`request['FILES']`在不使用自定义存储后端的情况下，如何正确地将文件从 s3 上传？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T22:46:43.580

我不久前遇到了类似的问题，而不是使用`set_contents_from_filename(f)`try`k.set_contents_from_string(f.read())`

我在这里的这个项目中做了同样的事情：[https ://github.com/buddylindsey/developerrage/blob/master/developerrage/comic/views.py](https://github.com/buddylindsey/developerrage/blob/master/developerrage/comic/views.py)

# java - 通过 servlet 进行代理传递？

> ID：11837019
> 
> 赞同：1
> 
> 时间：2012-08-06T22:44:42.160
> 
> 标签：java, apache, proxy

我知道如何使用 ProxyPass 设置 apache 服务器。这样客户端就可以连接到特定的 url，被重定向到另一个 url，但无法识别这一点，因为他输入的 url 仍然存在。

我必须为此使用apache代理吗？或者我可以通过 Servlet 以某种方式获得相同的结果吗？尤其是在不改变浏览器url的情况下进行转发，所以用户还以为自己直接访问了服务器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T22:56:52.237

可能有[很多可用的 Proxy Servlet](https://www.google.com/search?hl=en&site=&source=hp&q=proxy+servlet&oq=proxy+servlet)，其中一些可能具有比 Apache 的 ProxyPass 更丰富的功能集。*但是您通常希望在您的 servlet 前面*有一个健壮的服务器，这就是为什么人们设置类似 Apache 并使用 ProxyPass 将请求代理到本地（或内部）servlet 引擎的原因。

您不需要使用 Apache。例如，您可以使用[NGinx 的 ProxyPass](http://wiki.nginx.org/HttpProxyModule)来做几乎相同的事情。如果您担心负载平衡，除了 Apache 的 mod_proxy 之外，还有其他模块可以执行此操作。

# java - 西蒙说游戏 java android

> ID：11837022
> 
> 赞同：1
> 
> 时间：2012-08-06T22:45:06.010
> 
> 标签：java, android

我是 java 和 android 的初学者，现在我正在尝试编写“simon says”游戏来学习这种语言，但这不能正常工作。:-(

第一个也是最重要的问题：当我尝试使用方法 seq_show().. 显示存储在数组 seq[] 中的颜色序列 [编号 1 到 4] 时，调用 but_show(x) 来更改背景颜色每个按钮的...但是我看不到相应线性布局的背景颜色的变化...而且我已经擦除了READY？源代码按钮，因为在 seq_show() 之前没有关闭。

我不明白这个java的编程方式......不是逐行，一步一步......我的事情是线程，我不明白执行代码的指针在哪里。:-(

有人能帮我吗 ？

然后，在方法 seq_input() 中，我捕捉到了 LinearLayout 上的点击……我认为这运行良好……但我需要先解决 seq_show() 问题才能继续执行该程序。

谢谢 ！！

```
public class MainActivity extends Activity {
public LinearLayout l1, l2, l3, l4;
public GestureDetector gd1,gd2,gd3,gd4;
public static int seq[] = new int[25]; 
public int seq_pos = 0; 

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    // Array pos[] amb 25 clics del joc simon 
    //
    for (int i = 0; i < 25; i++) {
        seq[i] = (int) (Math.random() * 4) + 1;
    }

    // declaració 4 onClickListener
    //
    l1 = (LinearLayout) findViewById(R.id.layout_green);
    l1.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            seq_input(1);
        }
    });

    l2 = (LinearLayout) findViewById(R.id.layout_red);
    l2.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            seq_input(2);
        }
    });
    l3 = (LinearLayout) findViewById(R.id.layout_yellow);
    l3.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            seq_input(3);
        }
    });
    l4 = (LinearLayout) findViewById(R.id.layout_blue);
    l4.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            seq_input(4);
        }
    });

    seq_show(0);
}

// Mostra la sequencia de botons a pulsar
//
public void seq_show(int seq_end) {
    for (int i=0; i <= seq_end; i++){

        try {
            Thread.sleep(1000);
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        but_show(seq[i]);
    }
 }

// Espera la pulsació de la sequencia de botons
//
public void seq_input(int but_pushed){
    if (seq[seq_pos] == but_pushed) {
        seq_pos++;
        but_show(seq[but_pushed]);

        seq_show(seq_pos);

    }else{

        MediaPlayer sound = MediaPlayer.create(this, R.raw.wrong);
        sound.start();
        new Handler().postDelayed(new Runnable() {
            public void run() {
                }
        }, 1000);

    }
}

// Canvia el color i emet un so al botó but_num
//
public void but_show(int but_num) {

    if (but_num == 1) {
        l1.setBackgroundResource(color.green_on);
        MediaPlayer sound = MediaPlayer.create(this, R.raw.tone_green);
        sound.start();
        new Handler().postDelayed(new Runnable() {
            public void run() {
                l1.setBackgroundResource(color.green_off);
            }
        }, 200);
    } else if (but_num == 2) {
        l2.setBackgroundResource(color.red_on);
        MediaPlayer sound = MediaPlayer.create(this, R.raw.tone_red);
        sound.start();
        new Handler().postDelayed(new Runnable() {
            public void run() {
                l2.setBackgroundResource(color.red_off);
            }
        }, 200);
    } else if (but_num == 3) {
        l3.setBackgroundResource(color.yellow_on);
        MediaPlayer sound = MediaPlayer.create(this, R.raw.tone_yellow);
        sound.start();
        Handler handler = new Handler();
        handler.postDelayed(new Runnable() {
            public void run() {
                l3.setBackgroundResource(color.yellow_off);
            }
        }, 200);
    } else if (but_num == 4) {
        l4.setBackgroundResource(color.blue_on);
        MediaPlayer sound = MediaPlayer.create(this, R.raw.tone_blue);
        sound.start();
        // SLEEP HERE ...
        Handler handler = new Handler();
        handler.postDelayed(new Runnable() {
            public void run() {
                l4.setBackgroundResource(color.blue_off);
            }
        }, 200);
    }
} 
```

再见 ！！

# c++ - 字符串常量之前的预期 unqualified-id

> ID：11837024
> 
> 赞同：31
> 
> 时间：2012-08-06T22:45:27.307
> 
> 标签：c++, namespaces, g++, math.h, object-files

我目前正在编写一个 C++ 应用程序，它结合 math.h 实现振荡器。我拥有的代码应该适用于应用程序（尝试编译目标文件），但我遇到了一个编译器错误，很可能与语法/等有关；我认为这与命名空间有关。错误：

终端输出：

```
User-Name-Macbook-Pro:Synth Parts UserName$ make
g++ -o Oscillators.o -c -I. Oscillators.cpp -c
In file included from Oscillators.cpp:2:
/usr/include/math.h:41: error: expected unqualified-id before string constant
In file included from /usr/include/c++/4.2.1/bits/locale_facets.tcc:42,
             from /usr/include/c++/4.2.1/locale:46,
             from /usr/include/c++/4.2.1/bits/ostream.tcc:46,
             from /usr/include/c++/4.2.1/ostream:635,
             from /usr/include/c++/4.2.1/iostream:45,
             from Oscillators.cpp:4:
/usr/include/c++/4.2.1/typeinfo:41: error: expected declaration before end of line
make: *** [Oscillators.o] Error 1 
```

振荡器.cpp

```
#include "Oscillators.h"
#include <math.h>
#include <vector>
#include <iostream>

#define TWOPI (6.2831853072)

using namespace std;

oscillator(int srate = 44100, int tabsize = 8192, double freq = 200) // Default to output 200Hz Sine Wave
{
    if(srate <= 0) {
        cout << "Error: sample rate must be positive" << endl;
        return;
    }
    sizeovrsr_ = (double)tabsize / (double)srate
    if(freq < 20 || freq > 20000) {
        cout << "Error: frequency is out of audible range" << endl;
        return;
    }
    curfreq_ = freq;
    curphase_ = 0.0 // Not out of one, out of tabsize
    incr_ = curfreq * sizeovrsr_;
    for(int i = 0; i < tabsize; i++) {
        gtable.push_back(sin((i*TWOPI)/(double)tabsize));
    }
    gtable.push_back(gtable[0]);
}

void print_table()
{
    vector<double>::size_type i;
    for(i = 0; i < gtable.size(); i++)
        cout << gtable[i] << "\n";
    cout << endl;
} 
```

振荡器.h

```
#ifndef GUARD_OSCILLATORS_H
#define GUARD_OSCILLATORS_H
#include <vector>

class oscillator {
public:
    /*
    void fill_sine(); // Will change the table to a sine wave
    void fill_square(); // Will change the table to a square wave
    void fill_sawtooth(); // Will change the table to a sawtooth wave
    void fill_triangle(); // Will change the table to a triangle wave
    double tick(double freq); // Will output the current sample and update the phase
    */
    void print_table(); // Will print all table values to standard output
    oscillator(int srate = 44100, double freq = 200, int tabsize = 8192);
private:
    double sizeovrsr_; // Will be set at initialization and will determine phase increase for tick func
    double curphase_;
    double curfreq_; // if the freq sent to a tick function doesn't match the current tick, it will be reset;
    double incr_;
    std::vector<double> gtable_; // Will contain a wavetable with a guard point.
}
#endif 
```

我已经看到其他提到使用 g++ -Wall -g 的建议，但我不确定这是问题所在，并且这里还有其他事情发生。

任何帮助将非常感激！谢谢！！

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2012-08-06T22:53:18.683

这是一个简单的问题。

**您只是忘记了头文件末尾的分号。**

由于在类定义末尾缺少分号而导致的编译器错误很难与实际问题联系起来——只要养成在创建类后检查错误时的习惯即可。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-12-22T08:04:55.353

产生此错误的另一种方法：为字符串常量定义一个宏，然后将宏名称用作字符串常量的名称。例子

```
#define FOO "bar"
static const char FOO[] = "bar"; // <-- Error "expected unqualified-id before string constant". 
```

显而易见的答案是删除其中一个定义，或更改一个定义的名称。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-06T22:57:23.660

您的代码有多个问题：

*   您需要在振荡器.cpp 中完全限定名称（`void oscillators::print_table()`而不仅仅是）`void print_table()`
*   你可能需要`#include "oscillators.h"`进入振荡器.cpp
*   您需要在实现中正确声明变量
*   添加缺少的分号。

但我猜这个*特定的错误*是由于头文件中的类定义后缺少分号引起的。只需像这样添加它：

```
 std::vector<double> gtable_; // Will contain a wavetable with a guard point.
};
#endif 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-26T18:03:52.217

对我来说，它发生过一次，因为在较早的标题中声明了重复标识（同名）。

# django - 有没有办法在 django 日志中打印源代码信息和 sql 查询？

> ID：11837029
> 
> 赞同：1
> 
> 时间：2012-08-06T22:46:02.043
> 
> 标签：django, logging, django-database

我正在将数据库信息记录到文件中，但我真正想做的是查看生成每个查询的代码，或者至少是文件/行号。

有没有办法做到这一点？使用文件名/funcName/etc（参见[http://docs.python.org/library/logging.html#logrecord-attributes](http://docs.python.org/library/logging.html#logrecord-attributes)）只记录较低级别的文件/函数（即'utils.py'中的'execute'，而不是我的代码）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T04:13:38.067

您应该尝试使用[Django 工具栏](http://pypi.python.org/pypi/django-debug-toolbar/)，它也可以为您提供带有回溯和计时的页面的 sql 查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T23:39:41.503

SQLCompiler 位于`django.db.models.sql.compiler`

你可以在那里四处逛逛。其中一些被委托给 sql 文件夹中的其他帮助文件，而另一些被进一步委托给相应后端的基本文件。

您可能会尝试在变量通过这些特定点时记录它们。

不过我很好奇，为什么？

# linux - Qt 交叉编译 Linux -> MacOS 无法链接到 Qt 库

> ID：11837030
> 
> 赞同：1
> 
> 时间：2012-08-06T22:46:03.063
> 
> 标签：linux, qt, cross-compiling, mach-o

我正在尝试链接我为 Linux 主机上的 MacOS 目标交叉编译的 Qt 程序。我按照此处的说明 (https://github.com/Tatsh/xchain) 成功构建了 gcc，我可以编译和链接该页面上的两个简单测试程序，以生成在 MacOS 上运行良好的可执行文件。

我已经使用这个 gcc 从源代码构建了我自己的 Qt，我可以顺利编译我的 Qt 程序。问题出现在链接阶段，当我的程序的目标文件应该链接到 Qt 库时，似乎根本找不到 Qt 库，或者因为它们不兼容而被忽略。

我的程序的目标文件和我构建的 Qt 库似乎都可以：

```
$ file MainWindow.o
MainWindow.o: Mach-O object i386

$ file /usr/local/myqt/mac32/Qt-4.8.2/lib/libQtCore.dylib.4.8.2
/usr/local/myqt/mac32/Qt-4.8.2/lib/libQtCore.dylib.4.8.2: Mach-O dynamically linked shared library i386 
```

g++ 调用如下所示：

```
$ i686-apple-darwin10-g++ -o myapp.app/Contents/MacOS/myapp 
     main.o MainWindow.o ... 
     -L/usr/local/myqt/mac32/Qt-4.8.2/lib -lQtCore -lQtGui ... 
```

当然还有更多的目标文件和更多的 Qt 库，为简洁起见，我将它们省略了。

我得到的错误是典型的没有将对象或库添加到命令行，例如：

```
...
  "QMainWindow::event(QEvent*)", referenced from:
      vtable for MainWindowin moc_MainWindow.o
  "QDir::~QDir()", referenced from:
      _main in main.o
ld: symbol(s) not found
collect2: ld returned 1 exit status 
```

似乎基本上没有找到每个 Qt 库。

我也尝试过直接指定 lib 文件而不是 -L/path 和 -lQtFoo 组合，我什至尝试将它们从 .dylib 重命名为 .so :)

如果我用 -v 运行 g++ 来查看链接器调用，然后还添加 -v ，我可以看到正在检查库的路径看起来没问题：

```
$ i686-apple-darwin10-ld64 -dynamic -arch i386 -headerpad_max_install_names 
     -macosx_version_min 10.4 -syslibroot /usr/i686-apple-darwin10 
     -weak_reference_mismatches non-weak -o myapp.app/Contents/MacOS/myapp
     -lcrt1.o /usr/i686-apple-darwin10/SDKs/MacOSX10.6.sdk/usr/bin/../lib/gcc/i686-apple-darwin10/4.2.1/crt3.o 
     main.o MainWindow.o 
     ... 
     -L/usr/local/myqt/mac32/Qt-4.8.2/lib -lQtCore -lQtGui ...
     -v
@(#)PROGRAM:ld64  PROJECT:odcctools-622.3od16
Library search paths:
    /usr/local/myqt/mac32/Qt-4.8.2/lib
    /usr/i686-apple-darwin10/usr/X11/lib
    /usr/local/myqt/mac32/Qt-4.8.2/lib
    /usr/i686-apple-darwin10/usr/lib/i686-apple-darwin10/4.2.1
    /usr/i686-apple-darwin10/usr/lib
    /usr/i686-apple-darwin10/SDKs/MacOSX10.6.sdk/usr/lib/gcc/i686-apple-darwin10/4.2.1
    /usr/i686-apple-darwin10/SDKs/MacOSX10.6.sdk/usr/lib/gcc
    /usr/i686-apple-darwin10/usr/lib/gcc/i686-apple-darwin10/4.2.1
    /usr/i686-apple-darwin10/SDKs/MacOSX10.6.sdk/usr/i686-apple-darwin10/lib
    /usr/i686-apple-darwin10/SDKs/MacOSX10.6.sdk/usr/i686-apple-darwin10/lib
    /usr/i686-apple-darwin10/usr/lib
    /usr/local/lib
Framework search paths:
    /usr/i686-apple-darwin10/Library/Frameworks/
    /usr/i686-apple-darwin10/System/Library/Frameworks/ 
```

库位置和设置看起来不错：

```
$ ls -lh /usr/local/myqt/mac32/Qt-4.8.2/lib/libQtCore.dylib*
lrwxrwxrwx. 1 root root   21 Aug  7 05:22 /usr/local/myqt/mac32/Qt-4.8.2/lib/libQtCore.dylib -> libQtCore.dylib.4.8.2
lrwxrwxrwx. 1 root root   21 Aug  7 05:22 /usr/local/myqt/mac32/Qt-4.8.2/lib/libQtCore.dylib.4 -> libQtCore.dylib.4.8.2
lrwxrwxrwx. 1 root root   21 Aug  7 05:22 /usr/local/myqt/mac32/Qt-4.8.2/lib/libQtCore.dylib.4.8 -> libQtCore.dylib.4.8.2
-rwxr-xr-x. 1 root root 2.7M Aug  7 05:22 /usr/local/myqt/mac32/Qt-4.8.2/lib/libQtCore.dylib.4.8.2 
```

lib 的内容似乎还可以，但是我对这部分不太熟悉……实际上我刚刚在另一个问题上发现了“nm”。

```
$ i686-apple-darwin10-nm /usr/local/myqt/mac32/Qt-4.8.2/lib/libQtGui.dylib.4.8.2 | grep event
     U __ZN16QCoreApplication5eventEP6QEvent
     U __ZN16QEventTransition5eventEP6QEvent
     U __ZN16QEventTransition9eventTestEP6QEvent
     U __ZN17QVariantAnimation5eventEP6QEvent
     U __ZN19QAbstractTransition5eventEP6QEvent
     U __ZN23QCoreApplicationPrivate15eventDispatcherE
     U __ZN7QObject11eventFilterEPS_P6QEvent
     U __ZN7QObject5eventEP6QEvent 
```

我对“名字修饰”也不太熟悉，但我觉得它可能与此有关。

到目前为止，整个交叉编译的过程已经很长了，所以在接近尾声的时候遇到了一些让我非常难过的东西真是太糟糕了——任何建议都将不胜感激！

**********编辑******* **********

 *****我发现如果我取出 ld64 调用的 -dynamic 标志，不同的函数名会显示为缺失。例如，上面提到的对“QMainWindow::event(QEvent*)”的缺失引用变为：

```
 "__ZN11QMainWindow5eventEP6QEvent", referenced from:
      __ZTV10MainWindow in moc_MainWindow.o 
```

现在我可以看到这些名称确实在我构建的 Qt 库中找不到（配置问题......？）。这并没有让我知道应该做些什么来解决这个问题，但也许它可能会给其他人一个线索。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T22:06:04.383

我设法克服了这个问题，尽管没有完全理解它的细节。最初我在 mkspecs 文件中有这两行，虽然它们在构建 Qt 时没有导致任何错误，但将它们注释掉可以解决问题：

```
QMAKE_RANLIB    = i686-apple-darwin10-ranlib
QMAKE_STRIP     = i686-apple-darwin10-strip 
```

我已将这些设置为像这样认为有必要的交叉编译器可执行文件，但似乎只需指定正确的 gcc 和 g++ 即可处理工具链中的所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:56:01.730

我没有完整的答案，但我可以告诉你 nm 输出中的“U”表示该符号未在该可执行文件（或本例中的库）中定义，但应在外部定义链接库，表明该库实际上可能有问题。

作为旁注，您可以使用 nm 的 -C 参数来解开您的 C++ 符号。*****

# php - PHP上传视频但不是图像失败

> ID：11837042
> 
> 赞同：-8
> 
> 时间：2012-08-06T22:47:19.840
> 
> 标签：php, html, forms, file, video

此表单在我使用它上传图像时有效，但在我上传视频时无效。我需要更改什么才能通过此表单上传视频？

```
$videoform = "
    <form action='' method='post' enctype='multipart/form-data' name='uploadform'>
        <input name='video' type='file' id='video' >
        <input name='upload' type='submit' id='upload' value=' Upload Video! '>
    </form>";

echo $form;

if($_POST['upload'])
{
    echo $videoform;
}

if(isset($_POST['upload'])) 
{ 
    // define the posted file into variables 
    $name = $_FILES['video']['name']; 
    $tmp_name = $_FILES['video']['tmp_name']; 
    $type = $_FILES['video']['type']; 
    $size = $_FILES['video']['size']; 
    echo $name;
}

echo "<br /><h5>$cname 's Videos</h5>";
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T22:59:00.067

视频可能超过了您的最大上传大小。要增加最大上传大小，请将以下行添加到您的 .htaccess 文件中：

```
php_value upload_max_filesize "200M"
php_value post_max_size "200M" 
```

（将“200M”替换为您希望的最大值 - “200M”表示“200 兆字节”。）

某些主机可能不允许您更改这些设置，在这种情况下您就不走运了。

这些设置也可以通过您的 php.ini 文件更改，但主机允许这样做的情况不太常见。

# perl - Perl 三元错误地输入“else”子句？

> ID：11837046
> 
> 赞同：7
> 
> 时间：2012-08-06T22:48:19.967
> 
> 标签：perl, ternary-operator

我有以下代码：

```
# List of tests
my $tests = [("system_test_builtins_sin", "system_test_builtins_cos", "system_test_builtins_tan")];

# Provide overrides for certain variables that may be needed because of special cases
# For example, cos must be executed 100 times and sin only 5 times.
my %testOverrides = (
    system_test_builtins_sin => {
        reps => 5,
    },
    system_test_builtins_cos => {
        reps => 100,
    },
);

my %testDefaults = (
    system_test_reps => 10,
);

# Execute a system tests
foreach my $testName (@$tests)
{
    print "Executing $testName\n";
    my $reps;

    if (exists $testOverrides{$testName}{reps})
        { $reps = $testOverrides{$testName}{reps}; }
    else
        { $reps = $testDefaults{system_test_reps}; }
    print "After long if: $reps\n";
    exists $testOverrides{$testName}{reps} ? $reps = $testOverrides{$testName}{reps} : $reps = $testDefaults{system_test_reps};
    print "After first ternary: $reps\n";
    exists $testOverrides{$testName}{reps} ? $reps = $testOverrides{$testName}{reps} : print "Override not found.\n";
    print "After second ternary: $reps\n";
} 
```

这给出了以下输出：

```
Executing system_test_builtins_sin
After long if: 5
After first ternary: 10
After second ternary: 5
Executing system_test_builtins_cos
After long if: 100
After first ternary: 10
After second ternary: 100
Executing system_test_builtins_tan
After long if: 10
After first ternary: 10
Override not found.
After second ternary: 10 
```

这个输出是最出乎意料的！我不明白为什么第一个三元似乎总是在执行“if false”子句。它总是赋值10。我也尝试将“false”子句更改为`$reps = 6`，我看到它总是得到6的值。为什么三元的逻辑取决于第三个（如果为假）子句的内容？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-06T22:54:52.177

这是一个更简单的脚本来说明问题：

```
#!/usr/bin/perl

use strict;
use warnings;

my $x;

1 ? $x = 1 : $x = 0;
print "Without parentheses, \$x = $x\n";

1 ? ($x = 1) : ($x = 0);
print "With parentheses, \$x = $x\n"; 
```

它产生这个输出：

```
Without parentheses, $x = 0
With parentheses, $x = 1 
```

我不确定赋值和运算符之间的关系是否`?:`可以通过运算符优先级来完整解释。（例如，我相信 C 和 C++ 在某些情况下会表现不同。）

运行`perldoc perlop`并搜索“条件运算符”，或查看[此处](http://perldoc.perl.org/perlop.html#Conditional-Operator)；它涵盖了这个确切的问题（比我在这里更简洁）。

无论如何，我认为使用`if`/`else`语句会比使用`?:`运算符更清晰。或者，由于“true”和“false”分支都分配给同一个变量，更好的用法`?:`是改变这个：

```
exists $testOverrides{$testName}{reps}
    ? $reps = $testOverrides{$testName}{reps}
    : $reps = $testDefaults{system_test_reps}; 
```

对此：

```
$reps = ( exists $testOverrides{$testName}{reps}
          ? testOverrides{$testName}{reps}
          : $testDefaults{system_test_reps} ); 
```

但同样，我不得不换行以避免滚动这一事实很好地表明 if/else 会更清晰。

您也可以考虑使用`//`操作符，除非您遇到不支持它的古老版本的 Perl。（它是由 Perl 5.10 引入的。）它也被称为“定义或”运算符。这：

```
$x // $y 
```

相当于

```
defined($x) ? $x : $y 
```

所以你可以写：

```
$reps = $testOverrides{$testName}{reps} // $testDefaults{system_test_reps}; 
```

这没有*完全相同*的语义，因为它使用`defined`而不是`exists`;来测试表达式。`$testOverrides{$testName}{reps}`如果存在但具有值，它将表现不同`undef`。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-06T23:16:50.637

`-p`选项对以下`B::Deparse`问题很有启发性：

```
$ perl -MO=Deparse,-p -e '$condition ? $x = $value1 : $x = $value2'
(($condition ? ($x = $value1) : $x) = $value2); 
```

正如 Keith Thompson 所指出的，一切都与优先级有关。如果条件为假，则最终赋值为`$x = $value2`。如果条件为真，则分配是`($x = $value1) = $value2`——无论哪种方式，结果都是分配`$value2`给`$x`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T06:37:47.330

我会这样做（我不介意使用三元运算符）

```
$reps = exists($testOverrides{$testName}{reps}) ?
    $testOverrides{$testName}{reps}             :
    $testDefaults{system_test_reps}; 
```

高温高压

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-08-07T04:07:51.280

感谢您向我们提供您的代码示例。现在我们可以把它撕成碎片。

不要使用三元运算符。这是一种最初让 C 程序员感到舒服的感染。在 C 中，使用三元运算符是因为它最初比 if/else 语句更有效。但是，编译器在优化代码方面做得很好，所以这不再适用，现在在 C 和 C++ 编程中不鼓励这样做。用 C 语言编程已经够难了，因为它没有三元运算符。

Perl 编译器在优化代码方面也非常有效，因此您应该始终以最清晰的方式编写代码，这样其他编程能力不如并在维护您的代码时遇到困难的人可能会在他们的工作中一头雾水。

您遇到的问题是运算符优先级之一。你假设这个：

```
(exists $testOverrides{$testName}{reps}) 
    ? ($reps = $testOverrides{$testName}{reps}) 
    : ($reps = $testDefaults{system_test_reps}); 
```

我也会的。毕竟，这就是我的意思。但是，赋值运算符的优先级低于三元运算符。真正发生的是这样的：

```
(exists $testOverrides{$testName}{reps}) 
    ? ($reps = $testOverrides{$testName}{reps}) : ($reps))
    = $testDefaults{system_test_reps}); 
```

所以，最后的任务总是发生在`$reps`.

如果你使用 if/else 会更好：

```
if (exists $testOverrides{$testName}{reps}) {
   $reps = = $testOverrides{$testName}{reps};
}
else {
   $reps = $testDefaults{system_test_reps};
} 
```

没有优先级问题，更容易阅读，同样高效。

# drupal - 如何从另一个模块覆盖 Drupal 路径

> ID：11837048
> 
> 赞同：3
> 
> 时间：2012-08-06T22:48:29.177
> 
> 标签：drupal, drupal-6, drupal-7, drupal-modules

我希望我的模块覆盖由另一个模块设置的路径

例子：

模块 A 注册了一个路径：

```
$menu['node/%id/test'] = array(
    'title' => 'Test',
    'page callback' => 'test_A',
    'page arguments' => array(1),
    'access callback' => 'test_access',
    'access arguments' => array(1),
    'type' => MENU_LOCAL_TASK,
) 
```

现在我创建模块 B 并注册相同的路径。

```
$menu['node/%id/test'] = array(
    'title' => 'Test',
    'page callback' => 'test_B',
    'page arguments' => array(1),
    'access callback' => 'test_access',
    'access arguments' => array(1),
    'type' => MENU_LOCAL_TASK,
) 
```

对该路径的每个请求

> www.mysite.com/node/1/test

将路由到模块 B 而不是 A。

覆盖其他模块设置的现有路径的最佳方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-06T22:51:43.283

你想使用一个改变钩子，[`hook_menu_alter()`](http://api.drupal.org/api/drupal/modules!system!system.api.php/function/hook_menu_alter/7)：

```
function mymodule_menu_alter(&$items) {
  $items['node/%id/test']['page callback'] = 'test_B';
} 
```

由于您只是在修改现有的菜单路由器定义，因此您只需声明要更改的部分（例如，页面回调函数名称）。注意也是`$items`通过引用传递的，所以你不需要返回任何东西。

# iphone - 将 nsnumber 或 nsstring 放入 initWithLatitude：

> ID：11837051
> 
> 赞同：2
> 
> 时间：2012-08-06T22:48:39.080
> 
> 标签：iphone, ios, mapkit, cllocation

我也被卡住了，也很愚蠢，我正在尝试将一个或`NSString`一个`NSNumber`放入`initWithLatitude`. `CLLocation`如果有人可以提供帮助，那就太好了。

这是代码

```
CLLocation *location1 = [[CLLocation alloc] initWithLatitude:53.778702 longitude:-0.271887];
CLLocation *location2 = [[CLLocation alloc] initWithLatitude:53.683267 longitude:-0.011330];
label.text = [NSString stringWithFormat:@"Distance in miles: %4.1f", [location1 distanceFromLocation:location2]/1609.344]; 
[location1 release]; 
```

我正在尝试替换`[[CLLocation alloc] initWithLatitude:53.778702 longitude:-0.271887]`为`[[CLLocation alloc] initWithLatitude:lat longitude:lon]`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T22:59:03.067

`CLLocationDegrees`是 a `double`，所以你做

```
[[CLLocation alloc] initWithLatitude:[someNSNumber doubleValue] longitude:[someNSString doubleValue]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T23:07:22.830

你为什么不使用`CLLocationDegrees`数据类型来操作你的位置值？该类型只是普通的双精度数据类型

```
/*
 *  CLLocationDegrees
 *  
 *  Discussion:
 *    Type used to represent a latitude or longitude coordinate in degrees under the WGS 84 reference
 *    frame. The degree can be positive (North and East) or negative (South and West).  
 */
typedef double CLLocationDegrees; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-01T20:22:55.420

```
CLLocation *loc = [[CLLocation alloc] initWithLatitude: (CLLocationDegrees) [lat doubleValue] longitude: (CLLocationDegrees) [lon doubleValue]]; 
```

无论是 NSStrings 还是 NSNumbers `lat`，这都有效。`lon`

# ruby-on-rails - 使用 Acts_as_Votable 创建 VoteUp 和 VoteDown 按钮

> ID：11837059
> 
> 赞同：1
> 
> 时间：2012-08-06T22:50:09.330
> 
> 标签：ruby-on-rails, ruby

我是 RoR 的新手，我正在尝试使用acts_as_votable 插件。我可以看到有一些方法，例如

```
@object.vote :voter => @user, :vote => 'like' 
```

但是我不知道如何根据按钮单击视图来调用此方法，这是我的最终目标。存在底层方法，我只需要用户提供一个操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T23:47:23.463

有两种选择。您可以调用控制器（或模型）中的方法，也可以在页面上使用 AJAX 来执行此操作。对于投票之类的事情，AJAX 方法可能更常见，因为它不涉及重新加载页面。

以下是您想要做的事情的一些简单示例： [http](http://wowkhmer.com/2011/09/19/unobtrusive-ajax-with-rails-31/) ://wowkhmer.com/2011/09/19/unobtrusive-ajax-with-rails-31/ http://stackoverflow.com/questions/10264453/是否可以调用-a-rails-helper-method-from-within-javascript

另外，看看`button_to`文档： [http ://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-button_to](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-button_to)

# reporting-services - 从 SSRS 2008 R2 导出到 Excel 2010 时数字不保持格式

> ID：11837063
> 
> 赞同：4
> 
> 时间：2012-08-06T22:50:30.217
> 
> 标签：reporting-services

我正在使用表达式来显示货币，具体取决于价值是数百万还是数千。此表达式在我的报告的 Format 属性中设置：

```
=iif((Fields!PrevActual.Value < 100000), "'$'#,,0,'K';('$'#,0,'K')", "'$'0,,.0,'M';('$'0,,.0,'M')'") 
```

这样，如果值为 1,500,000，则该数字将显示为 150 万美元，如果为 15,000，则将显示为 15,000 美元。

问题是当我将文件导出到 Excel 时。以千为单位的数字保留格式，但以百万为单位的数字则丢失了格式。所以我有一个电子表格，上面有 1,500,000 和 15,000 美元这样的数字。所有数字都导出为文本。

有谁知道如何将格式保存在 excel 中，使其与 SSRS 报告中的显示方式相匹配，同时确保它仍然是一个数字？

本质上，我想模仿在我们使用 SSRS 自动生成此报告之前 excel 所做的事情。数以百万计的数字采用这种自定义数字格式：$#.0,,\M，数千采用这种格式：$#,K。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T06:30:35.790

如果您导出excel公式，那么它可以工作。即 export ="text(1500000," ""'$'0,,.0,'M';('$'0,,.0,'M')"")"

然后 Excel 会将公式转换为最终的格式化值 $15M

棘手的部分是使格式字符串在 excel 中有效，并创建一个 SSRS 公式，它将连接字符串并生成一个 Excel 公式。

这可以提供帮助：http: [//msdn.microsoft.com/en-us/library/ms159220%28SQL.90%29.aspx](http://msdn.microsoft.com/en-us/library/ms159220%28SQL.90%29.aspx)

# makefile - 错误 127 - 目标配方失败 - 从 Pepper 19 编译 Google NaCl 示例时？

> ID：11837064
> 
> 赞同：2
> 
> 时间：2012-08-06T22:50:35.033
> 
> 标签：makefile, google-nativeclient

当我在 Cygwin 终端中运行 make 批处理文件时，我得到以下输出：

```
mparadis@A-082-MPARADI-0 ~/pepper_19/examples$ make  
make -C dlopen  
make[1]: Entering directory `/cygdrive/c/nacl_sdk/pepper_19/examples/dlopen' /cygdrive/c/nacl_sdk/pepper_19/toolchain/win_x86_glibc/bin/i686-nacl-g++ -o dlopen_x86_32.o -c
dlopen.cc -m32 -g -O0 -pthread -std=gnu++98 -Wno-long-long -Wall  
Makefile:92: recipe for target `dlopen_x86_32.o' failed  
make[1]: *** [dlopen_x86_32.o] Error 127  
make[1]: Leaving directory `/cygdrive/c/nacl_sdk/pepper_19/examples/dlopen'  
Makefile:33: recipe for target `dlopen_TARGET' failed  
make: *** [dlopen_TARGET] Error 2 
```

正确设置 Python 需要一些时间，因为我需要它的语言解释器包并且不知道我还没有它。我`env`的 Python 变量已正确设置为`C:\python27`. 在编译我的同事代码时，我得到了相同的结果，我可以在 Mac 或 Linux 机器上很好地编译。不幸的是，我也需要让它在我的 Cygwin 环境中工作。

任何有使用谷歌本地客户端经验或知道为什么会发生这种情况的人请告知。我已经在这个问题上呆了很长时间，我正对着电脑屏幕盯着看。

更新：

如果我将`--version`标志插入到 makefile 中的引用命令中，我会收到与上述相同的错误。但是，如果我从与 make 文件相同的工作目录中按原样键入命令，则会得到以下信息：

> mparadis@A-082-MPRADI-0 ~/pepper_19/examples/dlopen> $ /cygdrive/c/nacl_sdk/pepper_19/toolchain/win_x86_glibc/bin/i686-nacl-g++.exe -o dlopn_x86_32.o -c dlopen.cc -m32 -g -O0 -pthread -std=gnu++98 --version
> 
> mparadis@A-082-MPRADI-0 ~/pepper_19/examples/dlopen $

换句话说，它只是想了一秒钟，然后返回到提示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-04T15:46:29.273

**tl*****[；博士](https://en.wiktionary.org/wiki/TL;DR)******：***您的**cygwin**可能有问题，并将此返回代码***提供给所有批处理文件***。我的这样做。我的cygwin版本：

 ***```
$ uname -srv
CYGWIN_NT-6.1-WOW64 1.7.17(0.262/5/3) 2012-10-19 14:39 
```

* * *

从您的评论中，我看到了一个叫做“ **make.bat** ”的东西：

```
mparadis@A-082-MPARADI-0 ~/pepper_19/examples/dlopen
$ ls dlopen.cc dlopen.html eightball.cc eightball.h make.bat Makefile 
```

*你也可以用这个小bash*脚本测试你的 cygwin 。

```
#!/bin/bash
echo echo foo %errorlevel% bar >temp.bat
./temp.bat
if [ $? -eq 127 ]; then echo "bug"; fi 
```

如果该目标的 make 配方使用`make.bat`，并且您有此错误，则此 cygwin 错误导致错误 127***

# perl - Catalyst 无法加载帮助程序“Catalyst::Helper::View::TT”

> ID：11837066
> 
> 赞同：2
> 
> 时间：2012-08-06T22:50:56.447
> 
> 标签：perl, catalyst

我遵循“催化剂权威指南”一书。现在当我运行命令“script/lolcatalyst_lite_create.pl view Web TT”时，我得到如下

> 存在“/home/hengaini/LolCatalyst-Lite/script/../lib/LolCatalyst/Lite/View”存在“/home/hengaini/LolCatalyst-Lite/script/../t” 无法加载助手“催化剂： :Helper::View::TT", "Can't locate Catalyst/Helper/View/TT.pm >in @INC (@INC 包含: /home/hengaini/LolCatalyst-Lite/script/../lib /etc /perl /usr/local /lib/perl/5.14.2 /usr/local/share/perl/5.14.2 /usr/lib/perl5 /usr/share/perl5 /usr/lib/perl/5.14 /usr/share /perl/5.14 /usr/local/lib/site_perl .) (eval 338) 第 2 行。

问题：1.Catalyst 还流行吗？每个 Web 框架都说好；2.如何解决以上问题？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T23:17:17.957

1 - 是的，至少对我来说:-)

催化剂维护良好。没有新的 Perl 框架旨在取代 Catalyst。

2 - 安装缺少的模块：

```
sudo cpan Catalyst::Helper::View::TT 
```

确保一切都已安装

```
sudo cpan Catalyst::Runtime
sudo cpan Catalyst::Devel 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T23:15:56.070

是的，Catalyst 非常受欢迎，并且背后有一个非常活跃的社区。

但是您遇到的问题并非特定于 Catalyst。你的服务器上好像`Catalyst::Helper::View::TT`没有安装。

尝试从 CPAN 安装它，看看效果如何。如果您还没有，您还需要`install Template`（[模板工具包）。](http://template-toolkit.org/)

*（如果你已经做到了，我想你知道如何从 CPAN 安装！）*

# iphone - 根据 iPhone 颜色更改颜色

> ID：11837067
> 
> 赞同：0
> 
> 时间：2012-08-06T22:51:03.173
> 
> 标签：iphone, objective-c, ios, xcode, colors

我在我的新项目的配色方案上做了很多工作，并得出结论认为一种方案最适合在白色 iPhone 上使用，而在黑色 iPhone 上应该使用不同的配色方案。
如何根据设备的颜色指定要在设备上使用的不同图片文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:53:56.467

除非您可以访问手机的 SN 以及指示每部手机颜色的苹果数据库，否则这是不可能的。

我建议改为给用户一个选项，以便他们可以选择更改应用程序的配色方案。

# vba - 如何将一系列单元格向右移动

> ID：11837071
> 
> 赞同：1
> 
> 时间：2012-08-06T22:51:31.727
> 
> 标签：vba, excel

有人可以帮我将定义的单元格范围向右移动一列。如果我定义

```
rng = B2:B3 
```

我需要一个代码来将我在 B2:B3 中的值移动到 B3:B4。

这是我到目前为止所拥有的，但这些都不起作用。我在第三行出现错误。

```
Dim rng As Range
Set rng = Range(DataSheet.Cells(arr(z)(1), 2), DataSheet.Cells(arr(z)(1), LastCol))

rng.Insert Shift:=xlShiftToRight '(i tried this first)
 or
rng.Offset(0, 1).Select '(I tried this second and this also did not work) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-06T23:15:27.520

```
rng.Cut rng.Cells(1).Offset(0,1) 'assuming you really mean to move right 
```

# c++ - 在初始化列表中初始化一个常量大小的数组

> ID：11837078
> 
> 赞同：26
> 
> 时间：2012-08-06T22:52:58.780
> 
> 标签：c++, arrays, class, constants, initializer-list

我有一个情况，可以总结如下：

```
class Test
{

    Test();

    int MySet[10];

}; 
```

是否可以`MySet`在初始化列表中进行初始化？

像这种初始化列表：

```
Test::Test() : MySet({1, 2, 3, 4, 5, 6, 7, 8, 9, 10}) {} 
```

有没有办法在类的初始化器列表中初始化一个常量大小的成员数组？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-08-06T23:00:59.887

虽然在 C++03 中不可用，但 C++11 引入了*扩展初始化列表*。如果使用符合 C++11 标准的编译器，您确实可以做到这一点。

```
struct Test {
    Test() : set { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 } { };
    int set[10];
}; 
```

上面的代码使用`g++ -std=c++0x -c test.cc`.

* * *

正如评论中一位乐于助人的用户在我下方指出的那样，此代码**不能**使用 Microsoft 的 VC++ 编译器 cl 进行编译。也许有人可以告诉我是否等效使用`std::array`将？

```
#include <array>

struct Test {
  Test() : set { { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 } } { };
  std::array<int, 10> set;
}; 
```

这也可以很好地使用`g++ -std=c++0x -c test.cc`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-06T23:00:51.427

不幸的是，在 C++03 中，您不能在初始化列表中初始化数组。如果您的编译器较新，您可以在 C++11 中使用 :)

请参阅：[如何使用 initializer_list 初始化成员数组？](https://stackoverflow.com/q/5549524/857994)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-06T23:07:33.443

> “我知道 Set 只是一个指向 10 个整数的静态数组的指针”

不，这是错误的：它是一个数组，而不是一个指针。

您仍然可以在构造函数的初始化列表中对其进行初始化。

对于不支持 C++11 花括号初始化的编译器（想到 Visual C++ 版本 11 及更早版本），您将不得不跳过一些环节，如下所示：

```
#include <iostream>
#include <vector>
using namespace std;

#define CPP11
#if defined( _MSC_VER )
#   if (_MSC_VER <= 1700)
#       undef CPP11
#   endif
#endif

#ifdef CPP11
class Cpp11
{
private:
    int set_[10];

public:
    Cpp11()
        : set_{ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 }
    {}

    int foo() const { return set_[3]; }
};
#endif

class Cpp03
{
private:
    struct IntArray10 { int values[10]; };
    IntArray10 set_;

    static IntArray10 const& oneToTen()
    {
        static IntArray10 const values =
            { {1, 2, 3, 4, 5, 6, 7, 8, 9, 10} };
        return values;
    }

public:
    Cpp03()
        : set_( oneToTen() )
    {}

    int foo() const { return set_.values[3]; }
};

int main()
{} 
```

但是，不要使用原始数组，而是使用`std::vector`和 C++++11 `std::array`，即使 Visual C++ 11 也支持这两者。

# java - 如何使用多连接生成一些 JPA 实体？

> ID：11837081
> 
> 赞同：1
> 
> 时间：2012-08-06T22:53:08.197
> 
> 标签：java, jpa, orm, persistence

我想在这种情况下创建一个应用程序：Zk 6、Spring v3.1.1、JPA 2.0、Hibernate 4.1.4，都带有注释，但我有一些带有 JPA 概念的 pb。

*这是一种案例研究：*

3 个表，全部通过连接表链接；我们正在处理基数 0，n。

*   所以我们有 T_E_USER、T_E_TYPE 和 T_E_AIR。每个表都有一个数字 ID 和一个简单的 VARCHAR 字段。

*   使用 T_J_USR_TPE_AIR 创建连接表，其中 3 个 ID 由外键引用，形成组合主键。

我正在使用 Hibernate Tools 生成我的实体（JPA 版本）。这就是问题开始的地方......

在每个实体类中，我都有一个带有注释@OneToMany 的类型的属性。

我有一个表示连接的类，它具有复杂类型（另一个类）的 id 属性，并带有用于复合键的注释 EmbeddedId。以及用@ManyToOne 注释表示三个实体的属性。

**这是我的问题，因为那是我感到困惑的地方：**

*   我应该在我的实体的注释@ OneToMany 中将哪个设置为“mappedBy”属性？
*   我是否被迫做一个代表加入的类实体？
*   级联如何？是否可以在这种情况下使用它来“自动”丰富连接表？或者我应该手动实例化连接的类代表以便自己保存信息？

非常感谢任何可以帮助我的好心人。

* * *

谢谢你的回答，但是当另一个说“不”时，一个说“是”，哈哈

这是我白天所做的，但我还没有接受过测试。

在每个实体表中，我添加了一个 @OneToMany 关系，并将 mappedBy 设置为“join”实体中定义的属性：

```
@OneToMany(fetch = FetchType.LAZY, 
       mappedBy = "aircraft",
       cascade = { CascadeType.REMOVE })
private Set<UserConfig> userConfigs = new HashSet<UserConfig>(0); 
```

...

```
@OneToMany(fetch = FetchType.LAZY, 
       mappedBy = "userAccount",
       cascade = { CascadeType.REMOVE })
private Set<UserConfig> userConfigs = new HashSet<UserConfig>(0); 
```

...

```
@OneToMany(fetch = FetchType.LAZY, 
       mappedBy = "referenceType",
       cascade = { CascadeType.REMOVE })
private Set<UserConfig> userConfigs = new HashSet<UserConfig>(0); 
```

我为连接表创建了一个新实体。

```
@Entity
@Table(name = "T_J_USR_RFT_AIR_URA")
public class UserConfig implements java.io.Serializable {

@EmbeddedId
@AttributeOverrides({
        @AttributeOverride(name = "airId", 
                           column = @Column(name = "URA_AIR_ID", nullable = false)),
        @AttributeOverride(name = "usrId", 
                           column = @Column(name = "URA_USR_ID", nullable = false)),
        @AttributeOverride(name = "rftId", 
                           column = @Column(name = "URA_RFT_ID", nullable = false))
})  
private UserConfigId id;

@ManyToOne(fetch = FetchType.LAZY)
@JoinColumn(name = "URA_RFT_ID", nullable = false, insertable = false, updatable = false)   
private ReferenceType referenceType;

@ManyToOne(fetch = FetchType.LAZY)
@JoinColumn(name = "URA_USR_ID", nullable = false, insertable = false, updatable = false)   
private UserAccount userAccount;

@ManyToOne(fetch = FetchType.LAZY)
@JoinColumn(name = "URA_AIR_ID", nullable = false, insertable = false, updatable = false)   
private Aircraft aircraft;

...
getter & setter
} 
```

其中 UserConfigId 是：

```
@Embeddable
public class UserConfigId implements java.io.Serializable {

@Column(name = "URA_AIR_ID", nullable = false)  
private Integer airId;

@Column(name = "URA_USR_ID", nullable = false)
private Integer usrId;

@Column(name = "URA_RFT_ID", nullable = false)
private Integer rftId;

...
getter & setter
} 
```

您如何看待这种做法？

如果删除连接表的对象以删除连接中关联的所有元素，我只是使用“级联”。

没关系 ？

无论如何，谢谢汤姆，我会分析你的链接。也感谢 JMelnyk。

如果您想展示此案例的最佳实践，欢迎您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T09:16:30.420

三向连接很棘手。我认为您所做的，使用连接表的实体，可能是正确的做法。要回答您的问题：

1.  您的`@OneToMany`属性是指映射连接表的实体；它们应该是`mappedBy`该实体中的适当`@ManyToOne`属性。
2.  是的，不幸的是，连接表的实体是执行此操作的最佳方式。
3.  级联可用于自动将对象添加到数据库中，但不能用于创建对象。您将需要在代码中创建连接实体的实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T07:58:04.187

> 我应该在我的实体的注释@ OneToMany 中将哪个设置为“mappedBy”属性？

`mappedBy`属性表示您要加入的属性名称。[阅读更多...](http://www.objectdb.com/java/jpa/entity/fields#Inverse_Fields_)

例如，`AnyEntity`持有实体`List<Employee>`中的（mappedBy）`department`属性，并且该属性持有关联。`Employee``department`

> 我是否被迫做一个代表加入的类实体？

不，您没有为连接表提供实体类。

> 级联如何？是否可以在这种情况下使用它来“自动”丰富连接表？或者我应该手动实例化连接的类代表以便自己保存信息？

是的，可以通过使用所需的级联类型标记关联来丰富实体及其本身的关联。

例如，我们有一个`Department`持有者`List<Employee>`，我将 CascadeType.PERSIST 放在员工身上。现在我们用其属性和员工填充部门对象。当我们完成后，我们只坚持部门，它将对员工进行级联操作。

# expressionengine - 表达式引擎 - 频道字段搜索

> ID：11837082
> 
> 赞同：1
> 
> 时间：2012-08-06T22:53:13.827
> 
> 标签：expressionengine

我对 Expression Engine 相当陌生，我觉得这是一个非常简单的问题，我只是无法从文档中找到直接的答案。

我有一个餐馆列表和一个按字母顺序排列的菜单（ABCD 等...）

我只想搜索以字母“A”开头的列表。

在传统的 MySQL 搜索中，WHERE Title LIKE 'A%'

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T01:42:30.197

我不相信 Channel Entries 模块的[搜索参数](http://expressionengine.com/user_guide/modules/channel/channel_entries.html#id64)允许`LIKE`匹配。

在这种特定情况下，您肯定会通过抓住[低字母模块来节省时间。](http://gotolow.com/addons/low-alphabet)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T23:47:32.640

表达式引擎没有确切的“喜欢”选项，但它们确实有类似的东西。

我可以搜索一个字段以查看它是否“包含”一个字符串，但没有任何具体内容可以确定它是以特定字符串开头还是结尾（例如在 MySQL 中很容易获得）。

我最终执行了“包含”搜索参数，然后排除了 exp:channel:entries 循环中与我的确切条件不匹配的任何结果。

# c++ - 模板化对象的编译顺序是什么？

> ID：11837085
> 
> 赞同：2
> 
> 时间：2012-08-06T22:53:30.317
> 
> 标签：c++, templates

抱歉，我的问题找不到更好的标题。基本上我注意到的是以下编译良好：

```
#include <vector>

void foo();

int main () {
    foo();
    return 0;
}

namespace{
struct point {
        double x, y;
    };
}

void foo(){       
    std::vector<point> p;
} 
```

而编译器抱怨以下内容：

```
#include <vector>

void foo();

int main () {
    foo();
    return 0;
}

void foo(){
    struct point {
        double x, y;
    };       
    std::vector<point> p;
}

// g++ output:
a.cpp: In function ‘void foo()’:
a.cpp:14: error: template argument for ‘template<class _Tp> class std::allocator’ uses local type ‘foo()::point’
a.cpp:14: error:   trying to instantiate ‘template<class _Tp> class std::allocator’
a.cpp:14: error: template argument 2 is invalid
a.cpp:14: error: invalid type in declaration before ‘;’ token 
```

我想知道第二种方法有什么问题？`struct point`在创建新`std::vector<point>`对象时没有完全定义吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-06T22:54:56.103

这是由于 C++03 中的限制（现在在 C++11 中取消），它简单地禁止使用本地类型（即在函数体中定义的类型）作为模板参数。

# html - 如何嵌套 HTML 注释？

> ID：11837091
> 
> 赞同：4
> 
> 时间：2012-08-06T22:54:05.887
> 
> 标签：html, comments

这是一个非常简单的问题，但它激怒了我。例如，我想评论以下内容：

```
<!--  
        {if $scenes}
            <!-- Scenes -->
            {include file="$tpl_dir./scenes.tpl" scenes=$scenes}
        {else}
            <!-- Category image -->
            {if $category->id_image}
            <div class="align_center">
                <img src="{$link->getCatImageLink($category->link_rewrite, $category->id_image, 'category')}" alt="{$category->name|escape:'htmlall':'UTF-8'}" title="{$category->name|escape:'htmlall':'UTF-8'}" id="categoryImage" width="{$categorySize.width}" height="{$categorySize.height}" />
            </div>
            {/if}
        {/if}
    --> 
```

我想注释掉所有这些文本，所以浏览器不会显示此代码。问题是我已经发表了评论，而且浏览器似乎混淆了结束标签。因此在这种情况下，当我希望它影响整个文本时，第一个打开的评论标签只会影响 {if $scenes}。你能告诉我怎么做吗？！？！

谢谢，

丹妮

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T23:01:00.183

如果我理解正确，您希望能够嵌套您的 HTML 注释。为此，您需要`--`用两个单破折号和一个空格替换双破折号`- -`。

基本上，

```
<!--
  This is a comment.
  <!- - 
    This is a nested comment.
  - ->
--> 
```

将此应用到您的代码中，您应该得到如下结果：

```
<!--  
        {if $scenes}
            <!- - Scenes - ->
            {include file="$tpl_dir./scenes.tpl" scenes=$scenes}
        {else}
            <!- - Category image - ->
            {if $category->id_image}
            <div class="align_center">
                <img src="{$link->getCatImageLink($category->link_rewrite, $category->id_image, 'category')}" alt="{$category->name|escape:'htmlall':'UTF-8'}" title="{$category->name|escape:'htmlall':'UTF-8'}" id="categoryImage" width="{$categorySize.width}" height="{$categorySize.height}" />
            </div>
            {/if}
        {/if}
    --> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-06T16:28:36.060

您拥有的语言**不是**HTML，而是一种生成 HTML 的语言。该语言显然支持嵌套的 if/else 条件，因为您展示了一个非常典型的例子。因此，即使生成 HTML 的语言本身缺少嵌套注释，您也可以使用条件来删除它的部分执行，从而抑制该 HTML 的生成：

假设标记`false`表示布尔值 false（在给定的模板语言中用正确的表达式代替 false）：

```
{if false}
    {if $scenes}
    <!-- ... >
    {else}
    ...
    {/if}
{/if} 
```

块中的所有内容都`if false`不会被处理器输出。

# mysqli - Mysqli 从多个表中删除行

> ID：11837092
> 
> 赞同：0
> 
> 时间：2012-08-06T22:54:06.520
> 
> 标签：mysqli

我是使用 mysqli 查询的新手。我正在尝试使用以下代码从多个表中删除一行：

```
$del_final = "DELETE confirm, coupon, cpn_image, c_token, deal_24 
              FROM confirm, coupon, cpn_image, c_token, deal_24
              WHERE confirm.customer_id=?
              AND coupon.customer_id=?
              AND cpn_image.customer_id=?
              AND c_token.customer_id=?
              AND deal_24.customer_id=?";

if($stmt->prepare($del_final))
{
    $stmt->bind_param('iiiii', $customer_id, $customer_id, $customer_id, $customer_id, $customer_id);
    $OK3 = $stmt->execute();
    $stmt->free_result();
} 
```

似乎只有当每个表中有一行具有匹配的 customer_id 时才会删除。我是否误解了如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:52:03.310

我认为这个查询很糟糕，非常糟糕。我建议您使用 ID 作为输入参数创建一个存储过程，然后对每个表使用一次删除，这就是这样做的方法。

# jquery - jQuery：ajax 运行两个处理程序 - 完成和失败

> ID：11837095
> 
> 赞同：13
> 
> 时间：2012-08-06T22:54:21.977
> 
> 标签：jquery

我有一个`ajax`电话

```
 $.ajax({
        type: 'POST',
        url: 'addVideo',
        data: {
            video_title: title,
            playlist_name: playlist,
            url: id
            // csrfmiddlewaretoken: '{{ csrf_token }}',
        },
        done: bootstrap_alert.success('video saved successfully'),
        fail: bootstrap_alert.error('There were some errors while saving the video. Please try in a while')
    }); 
```

和行动

```
// setting up alerts on action
bootstrap_alert = function() {}
bootstrap_alert.success = function(message) {
  $('#feature').prepend('<div class="alert alert-success"><a class="close" data-dismiss="alert">×</a><span>'+message+'</span></div>');
}
bootstrap_alert.error = function(message) {
  $('#feature').prepend('<div class="alert alert-error"><a class="close" data-dismiss="alert">×</a><span>'+message+'</span></div>');
} 
```

当前端进行ajax调用时，我同时看到两个通知

```
video saved successfully
There were some errors while saving the video. Please try in a while 
```

是我没有正确地进行ajax调用吗？

**UPDATE**
更改`done`为`success`导致相同的行为

```
// send the data to the server using .ajax() or .post()
        $.ajax({
            type: 'POST',
            url: 'addVideo',
            data: {
                video_title: title,
                playlist_name: playlist,
                url: id
                // csrfmiddlewaretoken: '{{ csrf_token }}',
            },
            success: bootstrap_alert.success('video saved successfully'),
            fail: bootstrap_alert.error('There were some errors while saving the video. Please try in a while')
        }); 
```

服务器响应是`HTTP/1.0" 200 3200`，我相信不`fail`应该被调用

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-06T23:25:59.277

这些值应该是函数、*回调*。但是，您正在做的是立即给他们打电话。将您的回调包装在匿名函数中。

```
$.ajax({
  type: 'POST',
  url: 'addVideo',
  data: { video_title: title, playlist_name: playlist, url: id }
}).done(function(){
  bootstrap_alert.success('video saved successfully');
}).fail(function(){
  bootstrap_alert.error('There were some errors while saving the video. Please try in a while');
}); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-06T22:55:38.327

`done`总是被调用。这应该会发生。您应该在`success`属性中处理您的成功代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-11-11T23:14:46.980

您需要将其包装在一个匿名函数中（正如其他人所指出的那样）。但是，我还没有看到有人提到原因（我认为值得一提）。

您需要这样做的原因是因为 javascript 将冒号右侧的评估分配给左侧。为了评估右侧，它需要首先运行您的函数。但是，如果您在右侧有一个匿名函数，它将函数本身定义为左侧引用的值（在 javascript 中，变量的值可以是函数）并将函数原样分配给左侧边（现在是对该函数的引用）。因此，它会延迟评估（运行函数），直到您的 ajax 调用完成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T23:30:31.880

像这样改变有效

```
// send the data to the server using .ajax() or .post()
        $.ajax({
            type: 'POST',
            url: 'addVideo',
            data: {
                video_title: title,
                playlist_name: playlist,
                url: id
                // csrfmiddlewaretoken: '{{ csrf_token }}',
            },
            success: function(response, textStatus, jqXHR){
                 // log a message to the console
                 console.log("Hooray, it worked!");
                 bootstrap_alert.success('video saved successfully');
            },

            // callback handler that will be called on error
            error: function(jqXHR, textStatus, errorThrown){
                // log the error to the console
                console.log("The following error occured: "+ textStatus, errorThrown);
                bootstrap_alert.error('There were some errors while saving the video. Please try in a while');
            },
        }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T23:01:06.983

尝试`done`用`success`和`fail`替换`error`? 当它们是回调挂钩时，您将它们用作选项。

# python - Twisted python：UDP 多播接口和组

> ID：11837098
> 
> 赞同：2
> 
> 时间：2012-08-06T22:54:32.550
> 
> 标签：python, security, interface, twisted, multicast

关于twisted 的UDP 多播的安全性，我有2 个问题。

```
class UDPProtocol(twisted.internet.protocol.DatagramProtocol):
        def startProtocol(self):
                self.transport.joinGroup('224.0.0.1')
        def datagramReceived(self, data, (host, port)):
            if host == '192.126.1.65':
                print "UDPWebscriptProtocol: received %r from %s:%d" % (data, host, port) 
```

这就是我听的方式：

```
reactor.listenMulticast(10222, UDPProtocol(), listenMultiple = True, interface = '224.0.0.1') 
```

注意listenMulticast 中的接口规范。

1.  在 listenMulticast 中指定接口与在协议中加入组有什么区别？
2.  在协议中，我检查主机接口是否具有正确的 IP（在本例中，是具有 rfc 1918 地址的私有接口）。有人可以欺骗这个 ip 并广播到我的组吗？还是只能欺骗IP而不是接口？

一般来说，这段代码的安全性如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:14:38.567

1.  收听界面是您收听的界面。加入该组会告诉内核和所有路由器您希望接收该组，因此例如您的路由器将传递来自该组的消息，而不是默认情况下丢弃它们。

2.  我不明白。你的意思是你检查传入数据报的源IP地址吗？我看不到您如何检查其他人的主机接口。如果允许的源地址是私有的，则唯一可能的欺骗来自该私有子网内部。

# e-commerce - 电子商务原则 - 动态显示库存还是使用静态页面？

> ID：11837100
> 
> 赞同：0
> 
> 时间：2012-08-06T22:54:45.793
> 
> 标签：e-commerce, online-store

我对此很好奇。让静态 html 页面显示当前库存是更好的做法吗？这显然需要在商品进货/缺货、添加新商品等时手动更新这些页面。

还是更常见的做法是使用动态页面直接从数据库加载商店的库存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:12:54.530

如果您的产品从不改变，并且您只有少数产品，那么您可能无需使用数据库就可以过关。但是，如果您需要经常更新新产品，或者如果您想添加过滤、搜索、排序等功能，那么拥有数据库是您的最佳选择。它还具有以合理的方式组织产品线的额外好处。但是，如果您有十几个产品，您将需要使用一个数据库，以便您可以编写一个根据所选产品填充的视图。否则，如果您想更改布局，您将不得不处理每个产品。

# html - 固定定位侧边栏对齐

> ID：11837107
> 
> 赞同：0
> 
> 时间：2012-08-06T22:56:20.060
> 
> 标签：html, css

我有一个侧边栏，我试图在我的页面上粘贴[http://r1creative.net/station22/](http://r1creative.net/station22/) 我在页脚中有一个脚本，当页面到达某个点时，它可以将其从静态更改为固定。那工作正常，但我遇到的问题是，当它切换时，它会改变 div 保持导航功能区的方式，并且它们不再“悬挂”在侧面。我试过弄乱不同的组合，但没有什么能保持滚动效果，让丝带看起来一样。任何帮助将不胜感激。

谢谢

这是我试图复制的侧边栏示例[http://www.apple.com/finalcutpro/all-features/#incredible-performance](http://www.apple.com/finalcutpro/all-features/#incredible-performance)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T23:03:59.730

您的侧边栏固定在页面的左侧。当您将其位置设置为固定时，只需添加`left: 28px`到元素。更好的是，设置一个类并使用 JavaScript 添加该类，而不是添加每个 CSS 元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T23:15:36.303

看起来问题出在您的“向右浮动”上

```
#navwrap {
    width: 295px;
    float: right; // remove 
    height: 679px;
    background: #F3F3F3;
    position: relative;
    left: 27px; // Add this left positioning
    z-index: 1;
    padding: 20px 0 0;
    box-shadow: -4px 4px 8px #444;
} 
```

让我知道这有帮助。

# bash - 这个 bash 重定向运算符是什么？"< 我看到了以下 bash 代码：at 19:00 <

> ID：11837108
> 
> 赞同：4
> 
> 时间：
> 
> 标签：bash

我看到了以下 bash 代码：`at 19:00 <<! echo "job 1"`. 我有两个问题：

1.  这个重定向运算符是什么：`<<!`？
2.  我编写了以下脚本代码：

    ```
    at 19:00 <<!
        echo "job 1"

    at 20:00 <<!
        echo "job 2" 
    ```

    当我执行这个脚本时，`atq`命令只显示一个作业，第一个。怎么了？我应该如何通过这个脚本正确提交这两个工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T23:06:35.020

来自[bash 参考手册](http://www.gnu.org/software/bash/manual/bashref.html#Redirections)

> 3.6.6 这里文档
> 
> 这种类型的重定向指示 shell 从当前源读取输入，直到看到只包含单词（没有尾随空格）的行。然后将所有读取到该点的行用作命令的标准输入。

```
The format of here-documents is: 
     <<[−]word
             here-document
     delimiter 
```

所以

1.  您不需要在`word`（在您的情况下`!`）之后指定任何内容
2.  然后您应该`at`在一行或多行上指定作业
3.  最后，添加一行包含`word`（再次，在您的情况下`!`）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-06T23:23:39.423

正如 Nya 解释的那样，这`<<!`是一个[此处的文档。](http://www.gnu.org/software/bash/manual/bashref.html#Redirections)

你应该写：

```
at 19:00 <<!
    echo "job 1"
!
at 20:00 <<!
    echo "job 2"
! 
```

如果没有以 开头的行`!`，您的此处文档就是 shell 脚本的其余部分，这就是为什么`atq`. （但是，该命令在运行时会安排第二个作业！）

# google-apps-script - 根据用户的回答显示弹出式 UI

> ID：11837110
> 
> 赞同：1
> 
> 时间：2012-08-06T22:56:49.363
> 
> 标签：google-apps-script

我目前有一个带有下拉问题的 UI。当用户在下拉列表中选择某个答案时，我想显示另一个 UI，允许用户回答更多问题。然后，我想关闭此窗口并将用户返回到第一个 UI 并继续回答问题。

我尝试过弹出面板，将一个 Ui 的不可见性设置为 false，但似乎没有任何效果。

注意：由于我的第一个 UI 中的数据是动态的，因此我无法使用 GUI 构建器，因此请仅使用代码提供解决方案。

这些是我到目前为止的代码：

```
// when user select this drop down option, show another UI
case 'Move to a special meeting':
  displayActionItemsUI();
  cellStatus.offset(numOfRowsOffset,0).setValue(N);
  cellMeetingType.offset(numOfRowsOffset,0).setValue('Special Meeting');
  break;

function displayActionItemsUI() {

  var app = UiApp.getActiveApplication();

  var panelActionItems = app.createVerticalPanel();

  var gridActionItems = app.createGrid(3, 2).setId('gridActionItems')
      .setCellPadding(15);

  var lblTaskStatement = app.createLabel('Task Statement:');
  var lblOwner = app.createLabel('Owner:');
  var lblDeadline = app.createLabel('Deadline:');

  var tboxTask = app.createTextBox().setId('tboxTask').setName('tboxTask');
  var tboxOwner = app.createTextBox().setId('tboxOwner').setName('tboxOwner');
  var dboxDeadline = app.createDateBox()
      .setFormat(UiApp.DateTimeFormat.DATE_SHORT)
      .setId('dboxDeadline').setName('dboxDeadline');

  gridActionItems.setWidget(0, 0, lblTaskStatement);
  gridActionItems.setWidget(0, 1, tboxTask);

  gridActionItems.setWidget(1, 0, lblOwner);
  gridActionItems.setWidget(1, 1, tboxOwner);

  gridActionItems.setWidget(2, 0, lblDeadline);
  gridActionItems.setWidget(2, 1, dboxDeadline);

  var btnAdd = app.createButton('Add');

  var lblTest = app.createLabel().setId('lblTest').setVisible(false);

  panelActionItems.add(gridActionItems)
    .add(btnAdd).add(lblTest);

  app.add(panelActionItems);

  addHandler = app.createServerHandler('_responseToAdd')
    .addCallbackElement(panelActionItems);

  btnAdd.addClickHandler(addHandler);

  var ss = SpreadsheetApp.getActiveSpreadsheet();
  ss.show(app);
}

// add response to a separate tab and close the UI
function _responseToAdd(e) {

  // store user's inputs;
  var actionItems = [];

  var actionObject = new Object();

  var taskStatement = e.parameter.tboxTask;
  var owner = e.parameter.tboxOwner;
  var deadline = e.parameter.dboxDeadline;

  actionObject['task'] = taskStatement;
  actionObject['owner'] = owner;
  actionObject['deadline'] = deadline;

  actionItems.push(actionObject);

  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Action Items");

  var headers = ['task', 'owner', 'deadline'];

  var valuesR = ObjApp.objectToArray(headers, actionItems); //returns [[]]
  sheet.getRange(sheet.getLastRow()+1, 1, 1, valuesR[0].length).setValues([valuesR[0]]);

  var app = UiApp.getActiveApplication();

  var panelActionItems = app.getElementById('panelActionItems');
  panelActionItems.clear();

  return app;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T00:07:24.393

我认为您可以使用多个面板来完成此操作，例如[此帖子的答案](https://stackoverflow.com/questions/11661146/replicate-tab-panel-in-gui-builder-google-apps/11669914#11669914)，您可以构建面板并根据答案更改其内容...

# java - 从什么时候开始手机充电/放电

> ID：11837116
> 
> 赞同：0
> 
> 时间：2012-08-06T22:57:27.710
> 
> 标签：java, android, battery

我想了解更多关于 Android 服务/广播的信息，所以我开始了一个简单的项目，创建一个电池监控应用程序。结果还不错，我用了几天了，但我想添加一个新功能：显示手机从什么时候开始充电/放电。

首先，我想我会在我的 BoradcastReciever 扩展类中创建两个静态字段，在那里我获取并发布有关电池的数据，一个用于实际状态（充电/放电），另一个用于状态变化发生时的时间. 这样，我可以从当前时间中减去最后一次更改，并准确知道手机从什么时候开始充电/放电。

但是这个解决方案有一个问题：当用户启动应用程序时，它一开始不会显示正确的数据。我不会大惊小怪，但我看到 Android 在某处跟踪这些数据，因为在我的手机设置中我找到了这些信息，所以为什么要采取艰难的方式。

**所以我的问题是：** *有没有一种简单的方法可以从 Android 系统中获取上次充电状态更改的日期/时间（无论是什么格式）？*

我查看了[BatteryManager 参考](http://developer.android.com/reference/android/os/BatteryManager.html)，但没有以我所寻求的内容命名的常量，我可以使用它来从接收器的 Intent 获取信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:07:40.023

Android 操作系统会跟踪电源的连接/断开连接，但不会让应用程序访问这些数据。您必须使用意图过滤器自己记录这一切。

要使用的两个意图过滤器是`android.intent.action.ACTION_POWER_CONNECTED`和`android.intent.action.ACTION_POWER_DISCONNECTED`; 有了这些，您可以监控电源何时连接和断开。

[你可以在这里](http://developer.android.com/training/monitoring-device-state/battery-monitoring.html)找到关于这个过程的信息，解释得非常清楚。可以在[此处](http://mihaifonoage.blogspot.de/2010/02/getting-battery-level-in-android-using.html)找到另一个描述该过程的博客。

# sql - SQL 数据库设计建议

> ID：11837118
> 
> 赞同：-1
> 
> 时间：2012-08-06T22:57:47.093
> 
> 标签：sql, database-design

我有一张`product`桌子：

```
ProdId(PK)
Prod1
Prod2
Prod3 
Prod4 
```

和`Certification`表：

```
Certification(PK):
Cert1
Cert2
Cert3 
```

如何建模以下关系（伪表）：

```
ProdwithCertId(PK)              ProdwithCert
ProdwithCert1                   "Prod1 with Cert1"
ProdwithCert2                   "Prod1 with Cert1, Cert2"
ProdwithCert3                   "Prod1 with Cert1, Cert2, Cert3"
ProdwithCert4                   "Prod2 with Cert1, Cert2"
ProdwithCert5                   "Prod2 with Cert1, Cert2, Cert3" 
```

不能有重复项，例如上表，`ProdwithCert6 - "Prod2 with Cert1, Cert2, Cert3"`是不允许的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:15:50.580

这是架构。

```
table product (id, name)
table certification (id, name)
table product_group (id, product_id)
table product_group_certification (id, product_group_id, certification_id) 
```

现在，假设我们`Prod2`在上面的示例中采用了，在这个模式中它看起来像这样。

```
**product**
1, Prod2

**certification**
1, Cert1
2, Cert2
3, Cert3

**product_group**
1, 1  // Prod2 with Cert1, Cert2
2, 1  // Prod2 with Cert1, Cert2, Cert3

**product_group_certification**
1, 1, 1
2, 1, 2
3, 2, 1
4, 2, 2
5, 2, 3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T23:08:59.413

当您在上面说“psuedotable”时，您的意思是所描述的表格只是说明性的，还是您的字面意思是您必须存储文本字符串“Prod1 with Cert1”、“Prod1 with Cert1、Cert2”等等？如果是前者，对我来说基本解决方案似乎类似于以下内容：

```
ProdWithCertId (PK)    Prod (SK) Cert (SK)
1                      Prod1     Cert1
2                      Prod1     Cert2
3                      Prod1     Cert3
4                      Prod2     Cert1
5                      Prod2     Cert2
6                      Prod2     Cert3 
```

# ios - 在不调整大小或重绘的情况下扩展 UIView

> ID：11837123
> 
> 赞同：2
> 
> 时间：2012-08-06T22:58:23.653
> 
> 标签：ios, uiview, cgpath

是否有可能有一个 UIView 可以重复设置其框架，例如在正 x 轴上增加其大小，但不调整大小或挤压图像？

例如，我想将 CGPath 绘制到 320 x 100 帧中，但仅显示帧在 x 值上增加，y 值为 100，因此它会在扩展时显示图像。编辑：我已经绘制了 CGPath，但它当前会随着容纳它的框架的扩展而调整大小。

所以视图不应该重绘或调整其内容的大小，而是将其内容固定在适当的位置，但是当它的框架放大时，只有更多的图像变得可见。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T23:31:24.943

如果您在其`drawRect:`方法中绘制了视图，则视图的`contentMode`属性将确定当其框架更改时视图的内容会发生什么。

的值[在](http://developer.apple.com/library/ios/documentation/uikit/reference/uiview_class/UIView/UIView.html#//apple_ref/doc/uid/TP40006816-CH3-SW69)[*类参考*](http://developer.apple.com/library/ios/documentation/uikit/reference/uiview_class/UIView/UIView.html#//apple_ref/doc/uid/TP40006816-CH3-SW69)`contentMode`中进行了描述。[`UIViewContentMode`*`UIView`*](http://developer.apple.com/library/ios/documentation/uikit/reference/uiview_class/UIView/UIView.html#//apple_ref/doc/uid/TP40006816-CH3-SW69)

默认情况下，视图`contentMode`是`UIViewContentModeScaleToFill`：

> 如有必要，通过更改内容的纵横比来缩放内容以适应其自身的大小。

听起来您可能想要`UIViewContentModeTopLeft`：

> 对齐视图左上角的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T23:19:55.103

如果我理解你，你有一个主视图和一个 UIImageView 作为子视图。如果您将 UIImageView 的 autoResizingMask 设置为不调整大小 - 它只是锚定到左侧 x 和 y 轴 - 应该这样做。

# assembly - 为了乐趣和利润而粉碎堆栈，代码执行顺序

> ID：11837125
> 
> 赞同：0
> 
> 时间：2012-08-06T22:58:46.127
> 
> 标签：assembly, x86

```
 jmp    0x2a                     # 3 bytes
    popl   %esi                     # 1 byte
    movl   %esi,0x8(%esi)           # 3 bytes
    movb   $0x0,0x7(%esi)           # 4 bytes
    movl   $0x0,0xc(%esi)           # 7 bytes
    movl   $0xb,%eax                # 5 bytes
    movl   %esi,%ebx                # 2 bytes
    leal   0x8(%esi),%ecx           # 3 bytes
    leal   0xc(%esi),%edx           # 3 bytes
    int    $0x80                    # 2 bytes
    movl   $0x1, %eax               # 5 bytes
    movl   $0x0, %ebx               # 5 bytes
    int    $0x80                    # 2 bytes
    call   -0x2f                    # 5 bytes
    .string \"/bin/sh\"             # 8 bytes 
```

所以跳转到调用然后“字符串地址将作为返回地址推入堆栈”。是这个地址保存在 esi 为什么要弹出 esi ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:07:24.860

这是编写与[位置无关的代码](http://en.wikipedia.org/wiki/Position-independent_code)（无论位于什么地址都可以成功执行的代码）的常用方法。

该`call`指令做了两件事：

1.  将返回地址（紧跟在调用之后的指令的地址）压入堆栈
2.  跳转到指定的地址。

所以调用之后，字符串“/bin/sh”的地址就在栈上了。下一条指令`pop esi`将该地址从堆栈中取出，并将其放入`esi`寄存器中，以便可以使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T23:10:31.830

好吧，当`call`执行时，它会将返回地址（调用操作码之后的地址）压入堆栈，以便在`ret`遇到时（在正常操作中），从中断处继续执行。这是标准的 x86 调用约定。

在您的代码中，推送的返回地址是“/bin/sh”的位置。`pop %esi`将该值放入 esi 寄存器，然后将其作为指针传递给 linux 系统上的 syscall `0xb`，`execve`执行字符串中命名的命令。

有很多关于[x86 调用约定](http://en.wikipedia.org/wiki/X86_calling_conventions#Caller_clean-up)的好资源，我希望您对 linux x86 会特别感兴趣。

# c#-4.0 - 如何获取静态（编译时）类型的 IDynamicMetaObjectProvider？

> ID：11837126
> 
> 赞同：3
> 
> 时间：2012-08-06T22:58:49.787
> 
> 标签：c#-4.0, ironpython, dynamic-language-runtime, linq-expressions

我想在编译时类型的上下文/范围内执行动态表达式（由用户提供）。在下面的示例中，上下文是任意编译时类型的实例。为了创建评估范围，我想利用所有可用属性及其类型在编译时已知的事实。

```
var engine = IronPython.Hosting.Python.CreateEngine();
var func = engine.CreateScriptSourceFromString("a + b").Compile();
var context = new { a = 1, b = 2 };
var scope = engine.CreateScope((IDynamicMetaObjectProvider)context); // Fails to compile
var result = func.Execute(scope);
context.a = 5;
var result2 = func.Execute(scope); 
```

我不想采取的解决方案是：

1.  让上下文从 DynamicObject 继承并覆盖 GetMember（出于性能原因）
2.  将上下文添加到范围并将表达式更改为“context.a + context.b”（出于可用性原因）

我敢肯定，已经有一种获取 IDynamicMetaObjectProvider 的机制，但无法弄清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T13:39:57.957

`DLR`自动知道如何动态调用在编译时定义的成员。事实上，即使你有一个实际的实现，`IDynamicMetaObjectProvider`它也会在尝试动态元对象之前先查找静态定义的成员。

首先，如果它实际上没有实现它，你不需要（也不能）强制`plain old clr object`转换它。`IDynamicMetaObjectProvider`

其次，我认为您对 python 范围看不到对象成员的困惑是因为您使用的是`Anonymous Type`. `Anonymous Types`被标记为**internal**，因此您的 python 范围无权查看它的成员并抱怨它没有实现它。使用实际定义的对象或`ExpandoObject`. 实际上在获取`ExpandoObjects`成员方面有非常棒的表现（但没有设置它们），事实上他们*比*.`plain old clr object``DLR`

以下基准测试显示 ExpandoObject getter 的运行速度比 DLR 调用的 poco 快 43%：

```
public class Poco{
    public int One {get;set;}
    public string Test {get;set;}
}

void Main()
{
    var iterations =Math.Pow(10,8);

    dynamic expando = new ExpandoObject();
    expando.One =1;
    expando.Test = "Test";
    dynamic poco = new Poco{One =1, Test = "Test"};

    var stopWatch = new Stopwatch();
    stopWatch.Start();
    for(int i=0; i < iterations; i++){
        var test1 = poco.One;
        var test2 = poco.Test;
    }
    stopWatch.Stop();
    var dlrPocoTime = stopWatch.ElapsedMilliseconds;

    stopWatch = new Stopwatch();
    stopWatch.Start();
    for(int i=0; i < iterations; i++){
        var test1 = expando.One;
        var test2 = expando.Test;
    }
    stopWatch.Stop();
    var expandoTime = stopWatch.ElapsedMilliseconds;

    Console.WriteLine((double)dlrPocoTime/expandoTime);

} 
```

# php - mysql插入问题

> ID：11837127
> 
> 赞同：0
> 
> 时间：2012-08-06T22:58:54.510
> 
> 标签：php, mysql

我正在建立一个网站来学习编码，并正在尝试构建一个声明您的业务类型的应用程序。所以在 claim.php 上，我们搜索并列出了所有企业，每个企业都有一个指向 addclaimedbiz.php?id= **$example_business_id**的链接。然后在 addclaimedbiz.php 我使用这个代码：

```
<?

$biz_id = mysql_real_escape_string($_GET['id']);
error_reporting(E_ALL);
$auth = $_COOKIE["auth"];
if ($auth != "1"){
    header("Location: ./signin.php");
}
$firstname = $_COOKIE['firstname'];
$id = $_COOKIE['id'];
$fname = ucwords($_COOKIE['firstname']);
$lname = ucwords($_COOKIE['lastname']);
$email = $_COOKIE['email'];
$city = ucwords($_COOKIE['city']);
$biz = ucwords($_COOKIE['biz']); // This is Line 14

if (!empty($biz)){
    header("Location: ./claim.php?alreadyclaimed=1");
}
else{
    include("./config.php");
    $result = mysql_query("INSERT INTO users (biz) VALUES ('$biz_id')") or die(mysql_error());
    setcookie("biz", "", time()-3600); // This is Line 24
    setcookie("biz", $biz_id, time()+60*60*24*30); // This is Line 25
    header("Location: ./biz.php"); // This is Line 26
}

?> 
```

基本上，这是在获取从 claim.php 传递给它的业务 ID，（然后所有 cookie 都是为了确保没有未经授权的人访问该页面，但我认为它与问题无关，但我将它保留在那里以防万一），然后将 id 添加到表中的**biz**字段**users**中。然后在最后它重定向到 biz.php。

不幸的是，当我运行这段代码时，我得到了错误：

```
Notice: Undefined index: biz in addclaimedbiz.php on line 14

Warning: Cannot modify header information - headers already sent by (output started at addclaimedbiz.php:14) in addclaimedbiz.php on line 24

Warning: Cannot modify header information - headers already sent by (output started at addclaimedbiz.php:14) in addclaimedbiz.php on line 25

Warning: Cannot modify header information - headers already sent by (output started at addclaimedbiz.php:14) in addclaimedbiz.php on line 26 
```

它说有错误的行的行号在上面的代码中。

我的代码出了什么问题？

感谢大家的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:00:56.127

将第 14 行更改为： `$biz = $biz_id;`

编辑：对不起，我从来没有注意到你正在学习 PHP。

# ios5 - 底部边距出现在 UITableViewCell 的 backgroundView (UIImageView) 内

> ID：11837135
> 
> 赞同：1
> 
> 时间：2012-08-06T22:59:53.630
> 
> 标签：ios5, uitableview, uiimageview

我为原生 iPhone 应用程序设计了一个自定义的 tableview（基于 jQuery Mobile 的设计）。tableview 被分割成几个图像（标题、行等），可用作`UITableView`. `UIImageView`我在一个成为`backgroundView`我自定义的图像中使用这个图像`UITableViewCell`。不知何故，底部边距出现在某些设备上。

为了方便起见，我不使用 iOS 的 tableview 标题。表格视图中的所有内容都是表格视图单元格，包括（假）标题。每个单元格的高度与背景图像的高度相匹配。所有视图都以编程方式设置，因此 XIB 文件中没有可能导致问题的隐藏内容。

我使用`UITableView`with 风格`UITableViewStylePlain`。为了防止显示常规分隔符，我在 tableview 控制器的`viewDidLoad`方法中使用此代码：

```
self.tableView.separatorStyle = UITableViewCellSeparatorStyleNone; 
```

在`init`我的自定义（子类）tableview 单元格的方法中，我像这样应用背景图像：

```
UIImage *backgroundImage = [UIImage imageNamed:@"Word.png"];
self.backgroundView = [[UIImageView alloc] initWithImage:backgroundImage]; 
```

这在 iOS 模拟器（iOS 5.0 和 5.1）和我的 iPhone 和 iPad（iOS 6）上完美运行。但是，在我的客户端的 iPhone (iOS 5.1.1) 上，背景图像比 tableview 单元格低 2px。因此，可以看到一条水平线。

[![问题（拇指）](../Images/cf84fa57312261713c145570eecdff35.png)](https://i.imgur.com/3hzJA.png)

*点击查看完整图片*

为了使调试更容易，我在这样的方法中为单元格及其背景视图添加了背景颜色`layoutSubviews`：

```
self.backgroundView.backgroundColor = [UIColor orangeColor];
self.backgroundColor = [UIColor yellowColor]; 
```

对于常规单元格，我使用橙色和黄色，对于标题单元格，我使用蓝色和绿色。如果您查看图像，您会发现背景视图的高度等于单元格的高度。这通过记录两个视图的`frame`和来确认。`bounds`

我不知道这里出了什么问题。所有 UITableViewCells 的大小与背景图像完全相同。`@2x`所有图像都具有正好两倍大的Retina变体。

希望有人知道这里出了什么问题。如果你需要我尝试一些东西，请发表评论，我会的。此外，我将尝试查找安装了 iOS 5.1.1 的其他一些设备，看看那里会发生什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T03:27:34.237

谷歌快速搜索：

UIImageView 一像素

返回先前的 Stackoverflow 讨论，该讨论建议

在构建设置中将“压缩 PNG 文件”设置为“否”

可能会解决这个确切的问题：[iOS 5.1 with Xcode 4.3.1: [UIColor colorWithPatternImage:] 奇怪的行为仅在设备上](https://stackoverflow.com/questions/9630870/ios-5-1-with-xcode-4-3-1-uicolor-colorwithpatternimage-strange-behavior-only)

# c# - 负索引数组的实现

> ID：11837139
> 
> 赞同：8
> 
> 时间：2012-08-06T23:00:23.660
> 
> 标签：c#, arrays

我正在制作一个世界向各个方向无限延伸的游戏。这意味着您可以在位置`X:50`,`Y:50`或`X:-50`, `Y:-50`。但是......我真的不能用普通的 C# 列表做到这一点......

我提出的所有想法似乎都太复杂/效率低下无法工作......

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-07T00:53:21.323

实现无限网格的最简单方法是使用带有字典的稀疏矩阵，其中 x,y 对作为键，您要存储的数据作为值。如果您的网格是稀疏的，这将快速、易于实现且内存友好。

另一种方法是链接网格（类似于链表，但具有指向 4 个方向的指针），或基于瓦片的方法来减少链接网格的开销（瓦片是 NxN 数组的链接网格）。瓦片的实现相当复杂，但是对于非常密集的网格来说，它是内存和性能之间的良好折衷。

但我个人最喜欢的方法是使用奇偶变换。所以奇数指数是正数，而偶数指数是负数。要从虚拟索引转换为物理索引，请使用公式`p = abs(v * 2) - (v > 0 ? 1 : 0)`并将物理索引转换为虚拟索引 `v = (p % 2 == 1 ? +1 : -1) * ((2*p + 3) / 4)`。这种关系的出现是因为自然数和整数之间存在一对一的关系（双射）`(0 <-> 0), (1 <-> 1), (2 <-> -1), (3 <-> 2), (4 <-> -2), (5 <-> 3), (6 <-> -3), ...`。这种方法快速、简单且优雅，但当您的网格非常稀疏且项目离中心线极远时，这种方法的记忆力就不是很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T02:09:59.327

除非你有一个 TON（是的，一个 TON 的位......）的单元格，否则你可以使用字典。将它与 a`System.Drawing.Point`作为键相结合，你会得到一件好事：

```
Dictionary<Point,YourGridObject> myMap = new Dictionary<Point,YourGridObject>(); 
```

编辑：除了字典，每个单元格都可以引用它的相邻单元格，这样你可以使用字典直接去“某处”，然后用相邻的导航。我用这种方式在一个十六进制网格中实现了一个 A* 寻路算法。

编辑2：例如，如果你想访问一个特定的坐标，你可以简单地

```
var myTile = myMap[new Point(25, -25)]; 
```

然后，你想得到`East`瓷砖，你可以

```
var eastTile = myTile.East; 
```

您的网格对象还可以实现偏移方法，因此您可以通过

```
var otherTile = myTile.Offset(-2, 5); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T03:28:06.933

如何在下面使用两个 List 进行两个不同方向的扩展？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T18:19:38.600

我不确定这是否比您想要处理的更复杂，但是您是否考虑过使用极坐标而不是笛卡尔坐标？该坐标系中没有负数。我意识到一开始覆盖很难，但是一旦你把头绕在它周围，它就变成了第二天性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-23T00:46:37.083

您可以使用 Dictionary，它具有数组的所有功能，但显然带有负索引。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-15T12:50:50.377

计算机无法存储无限数组。您的数组必须有一个边界，请提醒您在数组初始化期间在代码中的某处声明了特定大小。也许你在某个地方调整它的大小，但这仍然留下一个从 0.. 到.. 最大的数字范围。

所以你应该做的是，编写一个允许在这样的地图中进行相对定位的函数。因此，您将当前的地图 [x,y] 存储为位置。并且您可以通过具有相对于您当前位置添加/减去的功能来上升。这也使您的代码更易于理解。

如果您处理的不是游戏地图而是数字范围，假设您可以创建一个包含 n 个点的列表或一个 2d 字典的向量。

我在这里发布它，因为您的问题可能会导致人们编写错误的代码。

在地图周围有边框的情况下（通常在游戏场景和图像处理中）也为其他人添加。您的数据来自 [-1..width+1] 只需将其标注为 [0,width+2]然后从“for (int x = 1; x < Width+1; x++)”开始循环遍历它

# c++ - 过度骑行错误...松懈... C++ 语言规范违规可能吗？

> ID：11837149
> 
> 赞同：5
> 
> 时间：2012-08-06T23:01:08.497
> 
> 标签：c++, overriding

我已经查看了这个问题，但没有看到问题出在哪里。我不是 C++ 专家，所以对我来说这看起来不错。我上次尝试时，这曾经编译没有问题。

```
namespace yaaf {

/************************************************************************/
/*                                                                                          */
/*     Standard YAAF Errors                                                            */
/*                                                                                          */
/************************************************************************/

/*     XGYAAFError
 *
 *          YAAF Error; this is the root of my YAAF errors, and is
 *     a descendant of the standard exception class
 */

class XGYAAFError : public std::exception {
     public:
          explicit XGYAAFError(const char *);
          explicit XGYAAFError(const std::string &err);

          const char *what() const throw()
          {
              return fError.c_str();
          }

     private:
          std::string fError;
};

} // namespace yaaf

#endif 
```

GCC 库基类...

```
 /**
   *  @brief Base class for all library exceptions.
   *
   *  This is the base class for all exceptions thrown by the standard
   *  library, and by certain language expressions.  You are free to derive
   *  your own %exception classes, or use a different hierarchy, or to
   *  throw non-class data (e.g., fundamental types).
   */
  class exception 
  {
  public:
    exception() throw() { }
    virtual ~exception() throw();

    /** Returns a C-style character string describing the general cause
     *  of the current error.  */
    virtual const char* what() const throw();
  }; 
```

错误“覆盖函数的规范比基本版本更宽松”是我现在尝试构建时得到的。

我认为这可能与 C++ 语言的变化（大约 2004 年？？）以及您可以在派生类中声明指针的位置有关。但我不确定这里是否是这种情况以及如何解决这个问题。

任何关于具体错误或如何解决此问题的想法都值得赞赏。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T23:04:49.233

`XGYAAFError`有一个 type 的成员变量`std::string`，它有一个可以抛出任何异常的非平凡析构函数。 `std::exception`，如您所见，有一个用户声明的析构函数，该析构函数被声明为不抛出异常。

因此，由于覆盖规则，`XGYAAFError`需要一个用户声明的带有`throw()`异常规范的析构函数。[我在问题“异常规范如何影响虚拟析构函数覆盖？”](https://stackoverflow.com/questions/3233078/how-does-an-exception-specification-affect-virtual-destructor-overriding)中对此主题进行了深入的解释。有关详细信息，请参阅该问题。

# java - 继承和对象创建，理论上和实际

> ID：11837158
> 
> 赞同：5
> 
> 时间：2012-08-06T23:02:33.487
> 
> 标签：java, inheritance, memory-management

假设我有一堂课`A.java`，

![在此处输入图像描述](../Images/74bedbcc2fa23df63c6b016e7322e0c4.png)

当我将执行 A 的构造方法时，它会为`xyz`Object 创建一个内存空间。

```
A xyz = new A(); 
```

对内存的引用可能类似于，

```
[xyz] ---> '0x34524' 
```

这就是 OOP 的基础知识。够简单！

### 现在，

如果一个类从不同的父类继承会发生什么？将在内存中创建多少对象空间？

可以说我们有，

![在此处输入图像描述](../Images/3990aaafff6a99a0bcc30987e130a3f3.png)

然后我们创建一个类的对象`D.java`，

```
D omg = new D(); 
```

在这里，我们知道 D 的对象将调用 C.java 的构造，依此类推，直到 A.java。这是否意味着在内存中我们有 4 个不同的内存引用，因为我们正在实例化所有四个对象（一个直接实例化，另一个 3 个间接实例化）？

```
[omg] ---> '0x34525'
[C]   ---> '0x34526'
[B]   ---> '0x34527'
[A]   ---> '0x34528' 
```

* * *

**笔记 ：**

1.  这不是作业问题，这只是一个好奇心问题。
2.  我知道如果我们在 A.java 中有一个实例变量，那么我们将不会只创建对象 A，但每当我们点击`new`关键字时，我们都会创建其他内部对象。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T23:12:55.473

首先，一点点......调用对象​​的构造函数不会分配它。在字节码中，初始化`new Object()`表示为...

```
new java/lang/Object
invokespecial java/lang/Object <init>()V 
```

该[`new`](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-6.html#jvms-6.5.new)指令负责分配空间并获取对尚未*初始化*的对象的引用，而[`invokespecial`](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-6.html#jvms-6.5.invokespecial)句柄调用构造函数本身（在内部编译为[`void`名为 的方法`<init>`](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-2.html#jvms-2.9)，因此是[描述符](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html#jvms-4.3) `<init>()V`）。

继续前进，[堆上的对象分配和表示的内部结构完全是 JVM 特定的](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-2.html#jvms-2.7)。但是，据我所知，每个分配的对象只有**一个**分配的对象，无论其超类的数量如何。内存中的对象本身具有用于其自身类及其超类的实例字段的空间。它还必须为[*虚拟方法表*](http://en.wikipedia.org/wiki/Virtual_method_table)留出空间，以便在对对象执行虚拟方法调用（例如 via [`invokevirtual`](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html#jvms-4.10.1.4.5.invokevirtual)）时进行虚拟调度。

在内部，Oracle HotSpot JVM 管理称为*oops*或普通对象指针的东西。[您可以在此处](https://wikis.oracle.com/display/HotSpotInternals/CompressedOops)阅读有关 HotSpot 内存布局的更多信息。随意[浏览 HotSpot 源代码库](http://hg.openjdk.java.net/jdk7/hotspot/hotspot/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T11:34:28.223

JVM 只为一个对象分配内存（这里是 D）

1.  内存分配和初始化发生在底部（这里是 D）到顶部（对象）
2.  初始化/调用构造函数发生在顶部（对象）到底部（此处为 D）

参考 ：

[http://www.artima.com/designtechniques/initialization.html](http://www.artima.com/designtechniques/initialization.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T23:27:28.973

我没有在任何地方读过这篇文章，但这是我的经历。当您调用`new D()`时，构造函数链开始，它首先创建 an`java.lang.Object`然后`extends`它到 an `A`，我的意思是在创建`Object`（这是所有对象的根）之后，通过为 A 的成员（包括字段和方法）添加内存来初始化 A （这是指向某些代码的指针！）。然后它`extends`到 B 等等。

在扩展过程中，如果方法被覆盖，对象中的方法指针将指向新的代码。

它只是对 D 的一次引用。

# node.js - 如何在 express 3.0.0rc2 中使用 layout.jade

> ID：11837159
> 
> 赞同：4
> 
> 时间：2012-08-06T23:02:38.670
> 
> 标签：node.js, layout, express, pug

我刚刚更新为表达 3.0.0rc2 。一切正常，除了 layout.jade 不再使用。当我拥有旧版本时，我只是使用这条线将jade设置为默认视图引擎。

```
app.set("view engine", "jade"); 
```

我现在正在渲染这样，但它不起作用。

```
app.render(view, {opt1: 1,opt2: 2, layout: "layout.jade"}, callback); 
```

我以前不需要这个，但以防万一我尝试了这个但没有成功

```
app.set("view options", {
    layout: true
}); 
```

我什至像这样尝试过：

```
app.engine('jade', require('jade').__express);
// instead of this: app.set("view engine", "jade"); 
```

我希望有人知道如何在新版本中使用 layout.jade。谢谢

# jmeter - 您能否使用 JMeter 对 Siebel 应用程序进行性能测试？

> ID：11837162
> 
> 赞同：2
> 
> 时间：2012-08-06T23:02:53.367
> 
> 标签：jmeter, siebel

是否可以记录 JMeter 脚本以进行 Siebel 性能测试？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T08:52:17.867

Siebel 使用自定义格式对其请求和一些必要的技术参数进行编码。

因此，如果它是 http 模块，这是可能的，但这是一项艰巨的工作，因为在技术 ID 上有很多相关性要做。

要录制，请参阅：

*   [JMeter 记录 Siebel CRM 系统](https://stackoverflow.com/questions/48948992/jmeter-record-siebel-crm-system/49135608#49135608)

你可以使用这个商业插件来为你做自动相关：

*   [https://ubikloadpack.com/](https://ubikloadpack.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-31T07:24:45.880

是的，可以使用 JMeter 测试 Siebel。我已经在我的客户 TataSky 的一个项目中这样做了，我使用 JMeters 分布式测试方法生成多达 2000 个用户和 4 - 5 个普通桌面。Siebel 使用 http 协议，因此它最终是关于理解浏览器发送的请求和 Web 服务器的响应以及它们之间的关联。虽然它变得非常混乱，所以我的建议是关联**参数是强制性的。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-02T11:50:23.357

您可以使用[JMeter-Siebel-plugin](https://github.com/Blazemeter/SiebelPlugin/blob/master/README.md)，它提供了方便的**Siebel HTTP(S) 测试脚本记录器**测试元素，用于捕获和关联 Siebel 流量。

该插件可以使用[JMeter Plugins Manager安装](https://jmeter-plugins.org/wiki/PluginsManager/)

[![在此处输入图像描述](../Images/42652ad5cd867de36a8f3e69ef1ca58f.png)](https://i.stack.imgur.com/cN490.png)

查看[在 JMeter 文章中介绍 Siebel CRM 相关插件以](https://www.blazemeter.com/blog/introducing-the-siebel-crm-correlation-plugin-on-jmeter)获得全面的说明。

# math - 滑杆计算器？

> ID：11837163
> 
> 赞同：0
> 
> 时间：2012-08-06T23:03:05.240
> 
> 标签：math, slider, rating

这个网站，[http:](http://www.ukgoldrefiners.co.uk/) //www.ukgoldrefiners.co.uk/ 在右上角的窗口“黄金值多少钱？” 有三个滑块可以估算当前的黄金价格。很明显，它使用了一个公式，将黄金的重量乘以各种克拉的当前黄金价格（取自外部来源）。

如果我为自己的项目操作它：- 我有三个或更多滑块，我可以选择 1 到 100 之间的值，实时数字是滑块上所有数字的平均值。例如

等级 1：1--------|--100 (70)
等级 2：1--------|--100 (70)
等级 3：1--------|-- 100 (70)

所以平均值是 70，如果我操纵滑块，它会改变平均值。

我的问题是这叫什么？我会用什么来做这个，JQuery、Java、HTML？有资源吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T23:05:11.010

[单击此处](http://jqueryui.com/demos/slider/)获取出色的 jQuery 滑块。我以前使用过它，它包含许多事件函数的功能，例如`change`您可以用来进行计算。

您的 html 看起来像：

```
<div id="slider1"></div>
<div id="slider2"></div>
<div id="slider3"></div>
<div id="average"></div> 
```

您将使用以下内容初始化每个滑块 div：

```
$("#slider?").slider({
    change: function(event, ui) {
        //average out the values of all 3 and set the value of 'average' to the averages.
    }
}); 
```

# django - Django：将 Youtube URL 转换为 HTML 嵌入代码

> ID：11837169
> 
> 赞同：6
> 
> 时间：2012-08-06T23:04:00.497
> 
> 标签：django, youtube, embed, django-templates

我在 templatetags/custom_filters.py 中定义了我的自定义 Django 过滤器 youtube_embed_url。它需要一个 Youtube 网址并返回作为视频嵌入代码的字符串。templatetags/custom_filters.py 的代码如下：

```
from django import template
from django.conf import settings
register = template.Library()
import re

@register.filter(name='youtube_embed_url')
# converts youtube URL into embed HTML
# value is url
def youtube_embed_url(value):
    match = re.search(r'^(http|https)\:\/\/www\.youtube\.com\/watch\?v\=(\w*)(\&(.*))?$', value)
    if match:
        embed_url = 'http://www.youtube.com/embed/%s' %(match.group(2))
        res = "<iframe width=\"560\" height=\"315\" src=\"%s\" frameborder=\"0\" allowfullscreen></iframe>" %(embed_url)
        return res
    return ''

youtube_embed_url.is_safe = True 
```

然后我在 link_page.html 页面中使用这个过滤器。以下是 link_page.html 的相关部分：

```
<div>
{{ link.url|youtube_embed_url }}
</div> 
```

但是，当我在浏览器中查看链接页面时，我将 HTML 代码视为字符串：

![在此处输入图像描述](../Images/5cd20548829f5df6f370efedc56b45b4.png)

**知道如何将 youtube_embed_url 方法的结果解释为 HTML 代码，而不是字符串吗？**提前谢谢各位！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-06T23:06:38.587

很好的[`safe`过滤器](https://docs.djangoproject.com/en/dev/ref/templates/builtins/#safe)。

```
{{ link.url|youtube_embed_url|safe }} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-12T10:33:47.643

你也可以使用[django-embed-video](https://github.com/yetty/django-embed-video)。

用法非常相似：

```
{% load embed_video_tags %}

{{ link.url|embed:'560x315' }} 
```

# ios - 有没有办法在线搜索iOS应用商店？

> ID：11837170
> 
> 赞同：54
> 
> 时间：2012-08-06T23:04:07.233
> 
> 标签：ios, app-store

我想以编程方式跟踪我的应用在 Apple 应用商店中的搜索排名。在我的 iPhone 上的“App Store”应用程序之外，是否有任何 API 或网站可以做到这一点？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2016-09-05T01:03:55.557

以下网站允许搜索 iOS 应用商店。

1.  [https://theappstore.org](https://theappstore.org)
2.  [http://fnd.io](http://fnd.io)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-06-03T18:36:55.087

我不确定如何反映确切的排名，但 Apple 现在提供了一个您可以进行的 JSON API 调用。

[https://affiliate.itunes.apple.com/resources/documentation/itunes-store-web-service-search-api/](https://affiliate.itunes.apple.com/resources/documentation/itunes-store-web-service-search-api/)

这包括添加回调参数的能力，因此您甚至可以将其合并到 Web 应用程序中，而无需解析服务器上的结果。

最终的 API 调用看起来像这样：

[http://itunes.apple.com/search?term=props&entity=software&country=US&callback=lkasdfj](http://itunes.apple.com/search?term=props&entity=software&country=US&callback=lkasdfj)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-01-06T17:50:30.037

万一用户还在寻找这个。Apple 终于让只使用 apple.com 网站成为可能：

[https://www.apple.com/ios/app-store/](https://www.apple.com/ios/app-store/) 使用右上角的放大镜搜索应用程序。

找到所需的应用程序后，会有一个唯一的 URL，您可以使用它来获取信息以进行跟踪或其他目的。

此时除了查看应用信息外，您无法执行任何操作（无法启动远程安装到您的手机或留下评论，必须在设备上完成）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-14T07:52:11.207

您可以使用 google 高级搜索选项，例如

> 站点：itunes.apple.com/us/“需要 iOS 9 或更高版本”

然后**抓取**响应。

# ruby-on-rails - 格式化日期对象以显示人类可读的日期

> ID：11837171
> 
> 赞同：42
> 
> 时间：2012-08-06T23:04:07.937
> 
> 标签：ruby-on-rails, ruby, date, format

这是我想展示的内容：

```
May 13, 2012 
```

这是正在显示的内容：

```
2012-05-13 
```

我搜索了一些答案，它引导我进入“[在 Ruby 中格式化日期和浮点数](http://4loc.wordpress.com/2008/09/24/formatting-dates-and-floats-in-ruby/)”，其中提到了一个可能的解决方案：

```
<p class="date"><%= @news_item.postdate.to_s("%B %d, %Y") %></p> 
```

但是，这根本不会改变输出。没有调试错误或异常被触发。

我可以做到这一点，而且效果很好：

```
<p class="date"><%= Time.now.to_s("%B %d, %Y") %></p> 
```

这是我的迁移文件（查看我使用的数据类型）：

```
class CreateNewsItems < ActiveRecord::Migration
  def change
    create_table :news_items do |t|

      t.date :postdate

      t.timestamps
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-08-07T00:11:10.227

`Date.to_s`不一样`Time.to_s`。你`postdate`是 a `Date`，因此你可能想看看[`strftime`](http://www.ruby-doc.org/core-1.9.3/Time.html#method-i-strftime)：

```
postdate.strftime("%B %d, %Y") 
```

或者甚至希望将您自己的自定义日期格式添加到您的 Rails 应用程序中：
[在 ruby​​ 中转换日期格式时需要一些帮助](https://stackoverflow.com/questions/11184305/need-small-help-in-converting-date-format-in-ruby)

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2014-05-29T18:45:19.147

to_formatted_s函数已经为Rails 中的对象[提供了一些常见的人类可读格式。](http://api.rubyonrails.org/classes/DateTime.html#method-i-to_formatted_s)`DateTime`

```
datetime.to_formatted_s(:db)            # => "2007-12-04 00:00:00"
datetime.to_formatted_s(:short)         # => "04 Dec 00:00"
datetime.to_formatted_s(:long)          # => "December 04, 2007 00:00"
datetime.to_formatted_s(:long_ordinal)  # => "December 4th, 2007 00:00"
datetime.to_formatted_s(:rfc822)        # => "Tue, 04 Dec 2007 00:00:00 +0000"
datetime.to_formatted_s(:iso8601)       # => "2007-12-04T00:00:00+00:00" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-07-08T01:14:24.463

```
<%= time_ago_in_words @user.created_at %> 
```

结果：9 小时前

# tsql - 拆分字符串并从相关数据重建

> ID：11837172
> 
> 赞同：0
> 
> 时间：2012-08-06T23:04:24.030
> 
> 标签：tsql

我得到了一个字符串，该字符串可以包含由波浪号分隔的多个优惠代码`123~125~126`
我还有一个表，它可能会**或**可能不会定义父/子关系

```
tbl_allowed
============
offercode varchar(15)
parent_oc varchar(15)

ex:
offercode = 124
parent_oc = 126 
```

我已经有一个函数可以获取分隔字符串并将其拆分，但我想获取字符串，将内容与其中的内容进行比较，然后通过将 parent_oc 列`tbl_allowed`中存在的任何值替换`tbl_allowed`为 offercode 列中的值来重新生成它. 如果不存在已定义的关系，则仅使用自身。

这很简单，只需一个优惠代码：

```
set @newOfferCode = (select top 1 coalesce(cac.offercode, @lOfferCode)
from tbl_allowed cac
where OfferCode = @lOfferCode or parent_oc = @lOfferCode)

select coalesce(nullif(@newOfferCode,''), @lOfferCode) 
```

但是当我有一个波浪线分隔的字符串时我遇到了困难。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T21:36:33.730

这就是我最终做的事情。似乎工作。

```
 CREATE TABLE #tempoffers(OfferCode varchar(15), NewOfferCode varchar(15))

    INSERT INTO #tempoffers
    SELECT OutParam, null
    FROM dbo.SplitString(@lOfferCode, '~')

    update #tempoffers set NewOfferCode = coalesce(cac.offercode, mb.offerCode)
    from #tempoffers mb
    left outer join tbl_Allowed cac on mb.OfferCode = cac.parent_oc

            -- building the new string
    declare @newOfferCode varchar(5000)
    SELECT @newOfferCode = COALESCE(@newOfferCode + '~', '') + NewOfferCode FROM #tempoffers

    drop table #tempoffers
    SELECT @newOfferCode as OfferCode 
```

# asp.net - 删除子页面中 ContentPlaceHolder 的所有当前应用样式？

> ID：11837179
> 
> 赞同：0
> 
> 时间：2012-08-06T23:05:38.693
> 
> 标签：asp.net, master-pages, styling

我想删除母版页为内容占位符应用的所有样式，但在子页面中的代码中执行此操作。我尝试使用以下内容，但它什么也没做。

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (!Page.IsPostBack)
        {
            ContentPlaceHolder mpContentPlaceHolder = (ContentPlaceHolder)Master.FindControl("cphCenterColumn");
            mpContentPlaceHolder.EnableTheming = false;

        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T23:12:01.170

不迟于页面生命周期中需要`Page_Init`更改[主题](http://msdn.microsoft.com/en-us/library/ms178472.aspx)。
尝试将代码移至`Page_Init`or`Page_PreInit`事件。

# command - 从控制器解析 ViewModel 的命令？（棱镜）

> ID：11837180
> 
> 赞同：0
> 
> 时间：2012-08-06T23:05:39.903
> 
> 标签：command, prism, viewmodel, icommand

我将如何从控制器解析 ViewModel 的命令？

现在我必须通过构造函数将 UnityContainer 依赖注入到 ViewModel 中，并用字符串解析 ICommand。我真的不想将容器传递给我的视图模型，而是希望将它保存在我的控制器中。

这些只是片段，不是全部。并不是说它们是那么复杂的课程，尽管我尝试学习。

* * *

视图模型

```
 private ICommand loadedCommand;
    public ICommand LoadedCommand
    {
        get { return loadedCommand; }
        set
        {
            loadedCommand = value;
            RaisePropertyChanged(() => this.LoadedCommand);
        }
    }

    public MainViewModel(IUnityContainer container)
    {
      LoadedCommand = container.Resolve<ICommand>("LoadedCommand")
    } 
```

* * *

*控制器*

```
 DelegateCommand LoadedCommand;
    new DelegateCommand(() => ViewLoaded()); 
```

* * *

*控制器*

```
 Container.RegisterInstance<ICommand>("LoadedCommand", LoadedCommand); 
```

我什至不知道我是否以正确的方式去做这件事。我有点一下子深入研究了所有内容，Prism 和依赖注入和 mvvm（带控制器）对我来说相对较新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T06:29:31.430

我可能不完全确定你的问题。但我在 MVVM 中理解命令的方式是：你有视图，而不是点击事件，你使用命令对象。

原因是，单击事件会转到代码隐藏，而使用命令您可以将逻辑传输到视图模型。

视图使用绑定连接到视图模型。

所以一个简短的例子：（
用法）：

```
<Element Property="{Binding PropertyNameInTheViewModel}" /> 
```

（例子）：

```
<Button Command="{Binding ClickCommand}" /> 
```

然后当然将视图的数据上下文添加到视图模型中。示例（在代码隐藏中完成）：

```
public partial class View : Window
{
   public View(ViewModel vm)
   {
       InitializeComponent();
       this.DataContext = vm:
   }
} 
```

在视图模型中

```
public ICommand ClickCommand { get; set; }

#region constructor
public Viewmodel()
{
    ClickCommand = new DelegateCommand(ButtonClick);
}
#endregion

private void ButtonClick()
{
    // handle the click
} 
```

我不完全确定您所说的“控制器”是什么意思。我学到的设计模式是 View -> ViewModel -> Model。并在视图构造函数中使用依赖注入以传递视图模型。就我个人而言，我正在学习 MEF（托管可扩展性框架）而不是 Unity。

# wpf - 禁用 WPF DataGridCell 时如何检测鼠标双击事件？

> ID：11837181
> 
> 赞同：2
> 
> 时间：2012-08-06T23:05:46.103
> 
> 标签：wpf, datagrid, double-click, datagridcell

当我们禁用 ( `IsEnabled="False"`) DataGridCell 时，它会停止引发鼠标双击事件。我们希望在双击单元格时（在禁用和启用状态下）仍然能够点击双击事件来执行某些操作。

我们如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T02:42:46.640

[禁用](http://msdn.microsoft.com/en-us/library/system.windows.uielement.isenabled.aspx)将`DataGridCell`禁用该单元格的所有鼠标和键盘事件。如果您仍需要响应鼠标/键盘事件，请尝试设置[`IsReadOnly`](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagridcell.isreadonly.aspx)属性。

从第一个链接：

> 未启用的元素不参与命中测试或焦点，因此不会成为输入事件的来源。

# ruby-on-rails-3 - 为什么这种方法不能防止 NoMethodError？

> ID：11837183
> 
> 赞同：0
> 
> 时间：2012-08-06T23:05:57.917
> 
> 标签：ruby-on-rails-3, datatables, will-paginate

我正在使用 will_paginate gem，并尝试根据这个 RailsCast 实现 DataTables，并发现提供属性 total_entries 是个好主意，因为 will_paginate 显然不能很好地做到这一点。

所以我将此方法添加到我的类中，如下所示：

```
class Genotype < ActiveRecord::Base
  attr_accessible :allele1, :allele2, :run_date
  belongs_to :gmarkers
  belongs_to :gsamples

  def total_entries
    @t = Genotype.count;
    return @t
  end

end 
```

但是，当视图尝试加载时，我仍然会收到此错误（这是网络服务器响应的屏幕截图）：

```
 (7.6ms)  SELECT COUNT(*) FROM "genotypes" 
Completed 500 Internal Server Error in 96ms

NoMethodError (undefined method `total_entries' for nil:NilClass):
  app/datatables/genotypes_datatable.rb:13:in `as_json'
  app/controllers/genotypes_controller.rb:7:in `block (2 levels) in index'
  app/controllers/genotypes_controller.rb:5:in `index' 
```

显然，我在定义我的方法时一定做错了什么；但是什么？我对 Rails 太缺乏经验，无法摆脱这种情况......

提前致谢，

瑞克

# php - 更改 Wordpress PHP 以向登录用户显示不同的菜单

> ID：11837187
> 
> 赞同：1
> 
> 时间：2012-08-06T23:06:23.810
> 
> 标签：php, wordpress

我正在 Wordpress 上建立会员网站，并希望向登录用户显示不同的导航菜单。

这是显示菜单的当前 PHP 代码：

```
 <?php /* Our navigation menu. */ ?>
<?php if ( isset ($options['admired_remove_superfish']) &&  ($options['admired_remove_superfish']!="") )
                    wp_nav_menu( array( 'container_class' => 'menu-header', 'theme_location' => 'primary' ) );
                else
                    wp_nav_menu( array( 'container_class' => 'menu-header', 'theme_location' => 'primary', 'menu_class' => 'sf-menu','fallback_cb' => 'admired_page_menu'  ) );?> 
```

这是需要替换该代码的 PHP 代码：

```
<?php
    if ( wp_emember_is_member_logged_in() ) {
    wp_nav_menu( array( 'menu' => 'logged-in-members' ) );
  } else {
    wp_nav_menu( array( 'menu' => 'normal-visitor-menu' ) );
  }
?> 
```

如果我只是用新代码替换旧代码，它将起作用，但格式已关闭。我需要当前代码中的 Superfish 部分，但我不确定如何使其在 PHP 中工作。

我知道这可能有点令人困惑，但我会很感激任何帮助。谢谢！

PS 这是来自插件网站的教程。我一直在关注它，但不知何故我需要把超级鱼留在里面。我确定不知道该怎么做。

[http://www.tipsandtricks-hq.com/wordpress-membership/show-different-navigation-menu-to-your-members-and-non-members-551](http://www.tipsandtricks-hq.com/wordpress-membership/show-different-navigation-menu-to-your-members-and-non-members-551)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T23:43:13.547

`'menu_class' => 'sf-menu'`将为 `sf-menu class`菜单添加，插件将使用它来识别菜单，`(<ul class="sf-menu">)`并且将应用插件中已声明的样式`super fish``class``super fish``css`

```
<?php
    if ( wp_emember_is_member_logged_in() ) {
        wp_nav_menu( array( 'menu' => 'logged-in-members', 'menu_class' => 'sf-menu' ) );
    } else {
        wp_nav_menu( array( 'menu' => 'normal-visitor-menu', 'menu_class' => 'sf-menu' ) );
    }
?> 
```

有关更多信息，[请参阅此](http://codex.wordpress.org/Function_Reference/wp_nav_menu)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T23:42:37.977

考虑到上面的代码，唯一改变的是菜单的实际位置。（现有）代码显示您想要菜单`'theme_location' => 'primary'`，因为您有一个要使用的硬编码菜单，并且您正在选择它`'menu' => 'loggged-in-members'`完成的结果将是......

```
<?php
    if ( wp_emember_is_member_logged_in() ) {
       wp_nav_menu( 
           array( 
               'container_class' => 'menu-header', 
               'menu' => 'logged-in-members', 
               'menu_class' => 'sf-menu',
               'fallback_cb' => 'admired_page_menu' 
           ) 
       );
    } else {
        wp_nav_menu( array( 'menu' => 'normal-visitor-menu' ) );
    } 
```

?>

# objective-c - 如何在 Objective-C 中设置文本字段的委托？

> ID：11837188
> 
> 赞同：11
> 
> 时间：2012-08-06T23:06:24.380
> 
> 标签：objective-c, ios, delegates, uitextfield

我想`UITextField`通过将 a 限制为四个字符来自定义它。我试图了解代表是如何工作的，`Objective-C`并已通过以下步骤来实现此功能，但仍然没有获得有效的解决方案。

1) 创建了一个 LimitedLengthTextField 目标 c 类。制作类型的类`UITextField`并接受 < UITextFieldDelegate > 类型的对象。

LimitedLengthTextField.h：

```
@interface LimitedLengthTextField : UITextField <UITextFieldDelegate>
@end 
```

2）在LimitedLengthTextField.m中实现如下方法：

```
@implementation LimitedLengthTextField

- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {
    NSUInteger newLength = [textField.text length] + [string length] - range.length;
    return (newLength > 4) ? NO : YES;
}

@end 
```

3) 在我的 CreateAccount 类中导入“LimitedLengthTextField.h”，并尝试`viewDidLoad`如下设置 UITextField“ssnTextField”的委托（我的应用程序接受用户 SSN 的最后 4 位数字）。

```
// Set the custom SSN textfield delegate
LimitedLengthTextField *custTextField = [[LimitedLengthTextField alloc] init];
[self.ssnTextField setDelegate:custTextField]; 
```

基于我对`Objective-C`委托的有限理解，我现在创建了一个类，实现了我想要的委托方法，然后创建了该类的一个实例并将其分配给我的 UITextView 对象。我错过了什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-07T02:59:43.220

您不应该将 UITextField 子类化。相反，您在 CreateAccount 类中实现回调。所以你应该有这样的东西：

```
@interface CreateAccount :UIViewController <UITextFieldDelegate>
// I use UIViewController but whatever your CreateAccount from. 
```

并在您的 CreateAccount.m 文件中实现它：

这可能在您的 viewDidLoad 方法中：

```
Self.cusTextField.delegate = self; 
```

还有这个

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {
    NSUInteger newLength = [textField.text length] + [string length] - range.length;
    return (newLength > 4) ? NO : YES;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T23:13:21.203

也许您应该使 CreateAccount（我假设它是一个包含文本字段的视图控制器？）符合`UITextFieldDelegate`而不是自定义文本字段，并`shouldChangeCharactersInRange`在 CreateAccount 类中实现方法。此外，将代表更改为

```
_ssn.delegate = self; 
```

在这种情况下，也许您根本不需要自定义文本字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T23:20:18.613

应该实现该方法的文本字段应该是 LimitedLengthTextField 类型。让其他的类型为 UITextField

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T00:41:35.033

您正在将您的委托设置为一个本地对象，我假设该对象在当前范围结束时被释放。您有责任确保委托至少与其对应的对象一样长。更好的方法是在您的视图控制器中实现委托方法并将您的自定义字段的委托设置为该方法。它只会影响那个，不会影响其他。另一种方法是使用私有类在内部实现委托。然后你只需要设置类并完成。

# api - 在 Google 地图上显示用户头像和姓名

> ID：11837192
> 
> 赞同：2
> 
> 时间：2012-08-06T23:06:42.940
> 
> 标签：api, google-maps, google-maps-api-3, maps

在 Google 地图上显示用户的最佳方式是什么？我需要显示头像图像 (25x25px) 和用户名以及可点击的个人资料链接。

我一直在 api 文档中搜索，但标记和覆盖选项让我感到困惑，我应该使用什么功能/选项？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T23:16:51.750

解决方案是**MarkerImage**。[此链接](http://blog.mridey.com/2010/03/using-markerimage-in-maps-javascript.html)将为您提供帮助。

```
var latlng = new google.maps.LatLng(lat, lng);
var marker = new google.maps.Marker({
    icon: new google.maps.MarkerImage('avatar.png', null, null, new google.maps.Point(13, 25)), // 13 stands for centering
    position: latlng
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T01:25:31.237

So as Jill-Jênn Vie said above, the image can be set by `MarkerImage`;

The user name can be set as a tooltip of that marker/image, it is the "`title:`" parameter of the marker.

Then to open user profile on click add this event for "marker":

```
google.maps.event.addListener(marker, 'click', function() {window.location = 'http://google.com'}); 
```

I would paste the full code but it is already modified to include many markers defined as array.

# ruby-on-rails - Rails 控制器变量和复杂关系

> ID：11837193
> 
> 赞同：1
> 
> 时间：2012-08-06T23:06:52.757
> 
> 标签：ruby-on-rails, ruby, relational-database

假设我们在 Rails 应用程序中有以下场景：

`Users`有很多`Websites`，`Websites`有很多`Simulations`（同样，`Websites`属于`Users`，`Simulations`属于`Websites`）。

现在的问题是，**如何在“用户显示”页面上显示所有用户模拟的列表？**

我的第一个直觉尝试是在以下内容中定义`Users Controller`：

```
def show
  @user = User.find(params[:id])
  @websites = @user.websites
  @simulations = @user.websites.simulations
end 
```

然后`<%= render @simulations %>`在 中使用`Users Show Page`，但是当我访问 localhost:3000 时，会为 []:Array`提供`NoMethodError`：模拟。`undefined method`

那么如何在我的变量中创建一个变量`User Controller`来保存所有`Simulations`属于`Websites`特定的变量`User`？

非常感谢任何和所有帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T06:59:05.730

```
class User < ActiveRecord::Base
  has_many :websites
  has_many :simulations, :through => :websites
end 
```

现在您可以使用`@simulations = @user.simulations`并获取所有用户的模拟

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T02:20:49.997

## **使用埃雷兹的答案**

* * *

您要求的 - 我不了解 ruby​​，但@websites 中的每个网站都应该已经包含一个具有模拟的字段。

这就是你正在做的事情。

1 - 您获取用户、单个对象并获取其网站。凉爽的。用户看起来像这样（在伪代码中）：

```
 Object @user
    {
         Array[] websites = [(Website)site1, (Website)site2];
    } 
```

好吧，这很酷。所以`user.websites`应该返回一系列网站。

2 - 您尝试从网站获取模拟。一个网站大概是这样的：

```
 Object @website
    {
         Array[] simulations = [(Simulation)sim1, (Simulation)sim2];
    } 
```

嗯，怎么没效果？好吧，让我们分解一下你在做什么：

```
@user.websites.simulations 
```

您正在使用`websites`，它是一个数组，并试图引用一个属于`website`类型而不是`array`类型的变量。 `@user.websites`是一个包含网站的数组对象，而不是网站本身。你想要的是得到`@website.simulations`，而不是`websites.simulations`。

所以第一步是建立一个网站。这很容易 - 一种方法是尝试从用户的网站数组中获取网站。

```
@User.websites[0] <-- may not be syntactically correct; I don't know ruby. 
```

现在，如果您想获取所有网站，请使用循环遍历它们并将它们推送到新数组。再次在伪代码中：

```
@all_simulations = new Array();
for(@i=0;@i<count(@user.websites);@i++) //first loop through the websites
{
     for(@q=0;@q<count(@user.websites[@i].simulations);@q++) //then loop through the simulations
     {
           @all_simulations.push(@user.websites[@i].simulations[@q]); //push the simulation into @all_websites
     }
} 
```

我们在这里所做的是进入`user.websites`数组中的每个网站，然后从该网站获取每个模拟并将其放入我们的`@all_simulations`变量中。如果您理解这个概念，您应该能够将此逻辑转换为有效的 ruby​​。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T06:49:25.833

在您的用户模型中添加此方法。这将产生 2 个查询，但仍然比在 ruby​​ 代码中加入模拟要好。

```
def websites_simulations
  Simulation.where(website_id: website_ids)
end 
```

# sql - 是否可以在存储过程中返回文字来模拟数据集？

> ID：11837199
> 
> 赞同：1
> 
> 时间：2012-08-06T23:07:26.913
> 
> 标签：sql, sql-server-2005, stored-procedures, string-literals

首先，对不起这个愚蠢的问题。

我正在寻找的是返回硬编码数据的“数据集”。我需要这个或者它是否是一个好的解决方案的原因是无关紧要的。我只是想知道我该怎么做。

我基本上想通过 a 返回`SELECT`这个“假”数据集。

```
DisplayText  Value
-----------  -----
Yes          true
No           false 
```

我宁愿避免创建一个表，填充它，然后如果可以查询它。我在想有一个聪明的方法可以通过 来做到这一点`SELECT`，但我没有这样做的技能。

任何帮助，将不胜感激。是的，我知道这很愚蠢。让我们过去吧。=)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T23:10:21.157

这不是“聪明”，但这应该有效：

```
Select 'Yes' as DisplayText, 'true' as Value
UNION
SELECT 'No', 'false' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T00:13:58.493

现在不一定适合您，但有一天，当然对于其他读者来说，在 SQL Server 2008 中，您可以使用新的值构造函数更简洁地执行此操作（并且随着您添加更多行，它会变得越来越简洁）：

```
SELECT * FROM (VALUES('Yes','true'),('No','false')) AS x(DisplayText, value); 
```

同样：此解决方案仅适用于 SQL Server 2008 及更高版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T23:12:13.167

你可以这样做：

```
select DisplayText = 'Yes' , Value = 'true'
UNION ALL
select DisplayText = 'No'  , Value = 'false' 
```

或者您可以在存储过程中执行此操作：

```
declare @temp table (
  DisplayText varchar(32) not null ,
  Value       varchar(32) not null ,
)

insert @temp values ( 'Yes' , 'true' )
insert @temp values ( 'No'  , 'false' )

select * from @temp 
```

所以是的，你可以伪造那种东西。

# regex - php regex to preg_replace 字符串中的点，但可能的浮点数中的点

> ID：11837205
> 
> 赞同：1
> 
> 时间：2012-08-06T23:08:11.343
> 
> 标签：regex

```
$string = "Some words here. More words, followed by 1.5 and 2.3 here.Here is no space after the dot." 
```

我需要在句子之间的点之后添加空格（如果没有的话），但不要更改浮点数中的点。

```
$result = "Some words here. More words, followed by 1.5 and 2.3 here. Here is no space after the dot." 
```

曾经是“这里。这里”变成了“这里。这里”

尝试了很多，但找不到解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T23:31:32.590

这个应该做...

```
preg_replace('/([a-z]+)\.([^\s])/i', '$1\. $2', $string); 
```

# mysql - MySQL使用表的行值连接三个表

> ID：11837213
> 
> 赞同：1
> 
> 时间：2012-08-06T23:09:25.683
> 
> 标签：mysql, join, pivot, case

这很快就变得复杂起来，我开始质疑数据库设计。应用程序的基本概念是：

1.  用户帐户
2.  特征
3.  访问级别

因此，用户对每个功能都有不同的访问级别。我认为相当基本和常见的应用程序。

**架构：**

```
CREATE TABLE `user_accounts` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `user_login` varchar(100) COLLATE utf8_unicode_ci NOT NULL,
  `user_password` varchar(60) COLLATE utf8_unicode_ci NOT NULL,
  `user_fname` varchar(100) COLLATE utf8_unicode_ci NOT NULL,
  `user_lname` varchar(100) COLLATE utf8_unicode_ci NOT NULL,
  `user_group` varchar(32) COLLATE utf8_unicode_ci NOT NULL DEFAULT 'Default',
  PRIMARY KEY (`id`),
  UNIQUE KEY `user_login` (`user_login`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci ;

INSERT INTO `user_accounts` VALUES(1, 'email@example.com', 'secret', 'Example', 'Name', 'Admin');
INSERT INTO `user_accounts` VALUES(2, 'john@example.com', 'secret', 'John', 'Doe', 'Trainer');
INSERT INTO `user_accounts` VALUES(3, 'jane@example.com', 'secret', 'Jane', 'Doe', 'Default');

CREATE TABLE `user_access_meta` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `type` varchar(50) COLLATE utf8_unicode_ci NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `type` (`type`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

INSERT INTO `user_access_meta` VALUES(1, 'type_1');
INSERT INTO `user_access_meta` VALUES(2, 'type_2');
INSERT INTO `user_access_meta` VALUES(3, 'type_3');
INSERT INTO `user_access_meta` VALUES(4, 'type_4');
INSERT INTO `user_access_meta` VALUES(5, 'type_5');
INSERT INTO `user_access_meta` VALUES(6, 'type_6');

CREATE TABLE `user_access_levels` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `user_login` varchar(100) COLLATE utf8_unicode_ci NOT NULL,
  `type` varchar(50) COLLATE utf8_unicode_ci NOT NULL,
  `level` int(1) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `user_login_2` (`user_login`,`type`),
  KEY `user_login` (`user_login`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci ;

INSERT INTO `user_access_levels` VALUES(1, 'email@example.com', 'type_1', 1);
INSERT INTO `user_access_levels` VALUES(2, 'email@example.com', 'type_2', 1);
INSERT INTO `user_access_levels` VALUES(3, 'email@example.com', 'type_3', 0);
INSERT INTO `user_access_levels` VALUES(4, 'email@example.com', 'type_5', 2);
INSERT INTO `user_access_levels` VALUES(5, 'john@example.com', 'type_2', 1);
INSERT INTO `user_access_levels` VALUES(6, 'john@example.com', 'type_3', 1);
INSERT INTO `user_access_levels` VALUES(7, 'john@example.com', 'type_5', 3);
INSERT INTO `user_access_levels` VALUES(8, 'jane@example.com', 'type_4', 1); 
```

这些表实际上有更多的字段，并且它们之间有外键约束，但我在这个例子中已经把它们分开了。它们也单独用于其他目的。

我已经成功地为一个用户将所有三个表连接在一起：

```
SELECT
ua.`user_fname`,
uam.`type`,
ual.`level`
FROM `user_access_meta` uam
LEFT JOIN `user_access_levels` ual
ON ual.`user_login` = 'email@example.com'
AND uam.`type` = ual.`type`
JOIN `user_accounts` ua
ON ua.`user_login` = 'email@example.com'; 
```

输出：

```
| USER_FNAME |   TYPE |  LEVEL |
--------------------------------
|    Example | type_1 |      1 |
|    Example | type_2 |      1 |
|    Example | type_3 |      0 |
|    Example | type_4 | (null) |
|    Example | type_5 |      2 |
|    Example | type_6 | (null) | 
```

即使这并不理想，但这是我能想出的全部，它符合它的目的。

* * *

现在，我需要做的是选择所有用户，包括他们的访问级别。它看起来像这样：

```
| USER_FNAME |  type_1 |  type_2 |  type_3 |  type_4 |  type_5 |  type_6 |
--------------------------------------------------------------------------
|    Example |       1 |       1 |       0 |  (null) |       2 |  (null) |
|       John |  (null) |       1 |       1 |  (null) |       3 |  (null) |
|       Jane |  (null) |  (null) |  (null) |       1 |  (null) |  (null) | 
```

我觉得这可能不是最好的设计，但我采用这种设计的原因是我可以轻松地添加和删除功能，甚至可以单独暂时禁用它们。

是否应该重新考虑设计？甚至有可能通过这种设计获得我正在寻找的结果吗？

我已经把它放在 SQL Fiddle 上。[http://sqlfiddle.com/#!2/bb313/2/0](http://sqlfiddle.com/#!2/bb313/2/0)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T18:01:10.610

我对您的表格设计以及如何以您想要的格式获取数据有一些建议。

首先在数据库设计上，我建议的更改是在 table 中`user_access_levels`。将您的表格更改为以下内容：

```
CREATE TABLE `user_access_levels` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `user_id` int(11) NOT NULL,
  `type_id` int(11) NOT NULL,
  `level` int(1) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `user_id_2` (`user_id`,`type_id`),
  KEY `user_id` (`user_id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci ; 
```

当您可以只存储and时，无需将`user_login`and存储在此表中。将这两个用作各自表的外键。`type``user_id``type_id`

然后以您想要的格式获取数据。MySQL 没有`PIVOT`函数，因此您需要使用`CASE`带有聚合函数的语句。

```
select ua.user_fname, 
  MIN(CASE WHEN uam.type = 'type_1' THEN ual.level END) type_1,
  MIN(CASE WHEN uam.type = 'type_2' THEN ual.level END) type_2,
  MIN(CASE WHEN uam.type = 'type_3' THEN ual.level END) type_3,
  MIN(CASE WHEN uam.type = 'type_4' THEN ual.level END) type_4,
  MIN(CASE WHEN uam.type = 'type_5' THEN ual.level END) type_5,
  MIN(CASE WHEN uam.type = 'type_6' THEN ual.level END) type_6
FROM user_accounts ua
LEFT JOIN user_access_levels ual
  ON ua.id = ual.user_id
LEFT JOIN user_access_meta uam
  ON ual.type_id = uam.id
group by ua.user_fname 
```

查看[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/11d49/11)

如果您提前知道要为其获取值的类型列，则此版本将起作用。但如果它是未知的，那么您可以使用准备好的语句来动态生成它。

这是使用准备好的语句的查询版本：

```
SET @sql = NULL;
SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'MIN(case when type = ''',
      type,
      ''' then level end) AS ',
      replace(type, ' ', '')
    )
  ) INTO @sql
FROM user_access_meta;

SET @sql = CONCAT('SELECT ua.user_fname, ', @sql, ' FROM user_accounts ua
LEFT JOIN user_access_levels ual
  ON ua.id = ual.user_id
LEFT JOIN user_access_meta uam
  ON ual.type_id = uam.id
group by ua.user_fname');

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

查看[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/11d49/17)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T23:38:50.553

我通常使用 BIGINT 列并使用位掩码来设置值。

比如level1=2、level2=4、level3=8、level4=16等。

授予某人 level1 和 level2 访问权限：

```
update user set access_level = 2 & 4 
```

有人有二级访问权限吗？

```
select 1 from user where access_level | 2 AND user_id = ? 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T23:17:34.073

虽然我不熟悉 MySQL 的细节，但在我看来，您正在描述一个非常基本的数据透视表查询示例。您正在寻找的内容对我来说似乎是合理的，所以我认为根据您在此处显示的内容，我不会过于担心重新访问数据模型。您可能会发现将“级别”放回“类型”表中，基于 ol' 看到“标准化直到命中伤害，非标准化直到它起作用:)”

只是我的 0.02 美元。祝你好运。

# jquery - Pixastic Blur 不起作用 - 变量问题？

> ID：11837215
> 
> 赞同：0
> 
> 时间：2012-08-06T23:09:38.863
> 
> 标签：jquery, image, blur, pixastic

所以我想尝试使用[Pixastic 快速模糊方法](http://www.pixastic.com/lib/docs/actions/blurfast/)来模糊图像。他们在文档中提供的代码如下：

```
var img = new Image();
img.onload = function() {
    Pixastic.process(img, "blurfast", {amount:0.5});
}
document.body.appendChild(img);
img.src = "myimage.jpg"; 
```

但是当我像这样在我的页面上尝试它时：

```
$(document).ready(function() {
    var myImg = new Image();
    myImg.onload = function() {
        Pixastic.process(myImg, "blurfast", {amount:0.5});
    }
    document.body.appendChild(myImg);
    myImg.src = "../img/theImage.jpg";
}); 
```

它根本什么都不做。

我也试着这样称呼它，也没有任何结果：

```
var img = new Image();
$(".div img").load(function(){
    Pixastic.process(img, "blurfast", {amount:0.5});
});
document.body.appendChild(img);
img.src = "../img/theImage.jpg"; 
```

它甚至不会抛出错误！

我试图了解发生了什么：在`img`中，创建了一个新图像。一旦图像`.div`加载完毕，Pixastic 就会触发并将模糊效果添加到新创建的图像中。现在，图像作为子图像应用并获取`src`属性。

正如您可能注意到的那样，我在那里有一些逻辑错误，但我无法弄清楚。我相信在上面的代码中，`img`并不总是一样的。有时它是变量，有时它必须是来自`img`-tag 的实际图像。这是真的？或者你有没有看到其他让你印象深刻的事情？为什么它不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T08:01:56.980

好的，我知道了！出于某种原因，我需要通过 jQuery 方法调用它。像：

```
$(".div img").pixastic("blurfast", {amount:0.5}); 
```

# c# - 在 excel C# 中设置点颜色给出无效参数异常

> ID：11837217
> 
> 赞同：0
> 
> 时间：2012-08-06T23:10:15.807
> 
> 标签：c#, excel-interop

```
Excel.SeriesCollection seriesCollection = chartPage.SeriesCollection();
Excel.Series series1 = seriesCollection.NewSeries();
series1.XValues = activeSheet.Range["E1", "E3"];
series1.Values = activeSheet.Range["F1", "F3"];

series1.Points(0).Format.Fill.ForeColor.RGB = Color.Green.ToArgb(); 
```

给出无效参数异常。

这是详细信息：

```
System.Runtime.InteropServices.COMException was unhandled by user code
  HResult=-2146827284
  Message=Invalid Parameter
  Source=S
  ErrorCode=-2146827284
  StackTrace:
       at System.RuntimeType.ForwardCallToInvokeMember(String memberName, BindingFlags flags, Object target, Int32[] aWrapperTypes, MessageData& msgData)
       at Microsoft.Office.Interop.Excel.Series.Points(Object Index)
       at OMSS.BobStats.DrawFractionChart(Worksheet activeSheet, ChartObjects xlCharts, Range xRange, Range yRange) in c:\Users\t-jasonj\Documents\Visual Studio 2012\Projects\BobStats\ExcelAddIn1\BobStats.cs:line 104
       at OMSS.BobStats.DrawCharts(Worksheet activeSheet, Range range, Int32 length) in c:\Users\t-jasonj\Documents\Visual Studio 2012\Projects\BobStats\ExcelAddIn1\BobStats.cs:line 66
       at OMSS.BobStats.ThisAddIn_Startup(Object sender, EventArgs e) in c:\Users\t-jasonj\Documents\Visual Studio 2012\Projects\BobStats\ExcelAddIn1\BobStats.cs:line 52
       at Microsoft.Office.Tools.AddInImpl.OnStartup()
       at Microsoft.Office.Tools.AddInImpl.AddInExtensionImpl.Microsoft.Office.Tools.EntryPoint.OnStartup()
       at Microsoft.Office.Tools.AddInBase.OnStartup()
       at OMSS.BobStats.FinishInitialization() in c:\Users\t-jasonj\Documents\Visual Studio 2012\Projects\BobStats\ExcelAddIn1\BobStats.Designer.cs:line 59
       at Microsoft.Office.Tools.AddInBase.Microsoft.Office.Tools.EntryPoint.FinishInitialization()
       at Microsoft.VisualStudio.Tools.Office.Runtime.DomainCreator.ExecuteCustomization.ExecutePhase(ExecutionPhases executionPhases)
       at Microsoft.VisualStudio.Tools.Office.Runtime.DomainCreator.ExecuteCustomization.Microsoft.VisualStudio.Tools.Office.Runtime.Interop.IExecuteCustomization2.ExecuteEntryPoints()
  InnerException: 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T23:28:10.120

你要么使用

```
series1.Points(1).Format.Fill.ForeColor.RGB = System.Drawing.ColorTranslator.ToOle(Color.Green); 
```

或者

```
series1.Points(1).Format.Fill.ForeColor.RGB = Excel.XlRgbColor.rgbGreen 
```

**编辑：请注意，点是 1 索引而不是 0 索引。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T23:50:34.527

它不喜欢 ToArgb() 中的 A。使用 & 运算符摆脱它：

```
series1.Points(1).Format.Fill.ForeColor.RGB = Color.Green.ToArgb() & 0xffffff; 
```

# jquery - jQuery Mobile 在哪里放置 showPageLoadingMsg() 以获取点击事件

> ID：11837220
> 
> 赞同：0
> 
> 时间：2012-08-06T23:10:34.467
> 
> 标签：jquery, jquery-mobile

当用户在执行 AJAX 获取时单击可折叠部分时，我试图显示加载消息。我正在使用 SPServices 库来执行获取。基本上加载消息不显示。一旦 SPServices 操作和单击事件结束，它将显示。我是否正确定义了这个点击事件？谢谢。

```
$(document).bind('pageinit', function (event) {
    $('.ui-collapsible').click(function (event, data) {
        $.mobile.showPageLoadingMsg();
        var myQueryOptions = "";
        var myQuery = "";
        if ($(this).attr('id') == "NewsContainer" && $("#NewsList li").size() == 0) {
            var myQueryOptions = "<QueryOptions><ViewAttributes Scope='RecursiveAll' IncludeRootFolder='True' /></QueryOptions>";
            var myQuery = "<Query><Where><BeginsWith><FieldRef Name='ContentTypeId' /><Value Type='ContentTypeId'>0x010100C568DB52D9D0A14D9B2FDCC96666E9F2007948130EC3DB064584E219954237AF3900DD0126D65DE8404CB540571DFA751B850301</Value></BeginsWith></Where></Query>";
        }
        if (myQueryOptions != "" && myQuery != "") {
            $().SPServices({
                operation: "GetListItems",
                async: false,
                listName: "Pages",
                CAMLViewFields: "<ViewFields><FieldRef Name='Title' /><FieldRef Name='PublishingPageContent' /><FieldRef Name='NewsDate' /></ViewFields>",
                CAMLQuery: myQuery,
                CAMLRowLimit: 5,
                CAMLQueryOptions: myQueryOptions,
                completefunc: function (xData, Status) {
                    $(xData.responseXML).SPFilterNode("z:row").each(function () {
                        ....
                    });
                }
            });
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T06:50:02.620

将 JS`showLoading`放在超时处理程序之后应该会给您预期的结果。

请参阅这个问题：[在 jQuery Mobile 1.1 中进行繁重处理之前显示加载微调器？](https://stackoverflow.com/q/10923992/190695)

# wpf - View inside a View 和数据同步

> ID：11837221
> 
> 赞同：0
> 
> 时间：2012-08-06T23:10:34.350
> 
> 标签：wpf, mvvm

我有一个视图，我需要在其中显示一些 Grid 和 TabControl。网格上有一列应该显示类似于注释（备注）属性的内容。由于该字段可能包含大量数据，因此我将有一个带有 TextBox 控件的选项卡，该选项卡应允许用户查看/编辑便笺，而网格列将仅显示便笺上的几个首字母。

我将只发布相关部分：

```
public classSomeViewModel : ViewModelBase
{
    public SomeViewModel()
    {
        TabScreens = New List<ViewModelBase>();
        TabScreens.Add(new AnotherViewModel1());
        TabScreens.Add(new AnotherViewModel2());
    }

    List<ViewModelBase> TabScreens{get;set;}
} 
```

SomeView xml：

```
<DataTemplate DataType="{x:Type vm:AnotherViewModel1}">
    <vw:AnotherView1 />
</DataTemplate>

<DataTemplate DataType="{x:Type vm:AnotherViewModel2}">
    <vw:AnotherView2 />
</DataTemplate> 
```

另一个视图2：

```
<Grid>
    <TextBox Text={Binding Note} />
</Grid> 
```

另一个ViewModel2：

```
public class AnotherViewModel2
{
    public string Note {get;set;}
}
} 
```

所以 View 上的 TabControl 绑定到 TabScreens。DataTemplates 确保在加载 SomeView 时将同时加载 AnotherView1 和 AnotherView2。网格中的每一行都包含不同的注释。同步 SomeViewModel Remark 和 AnotherViewModel2 Remark 的最简洁方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T23:16:43.717

将 2 个视图模型组合成一个具有单个 Remark 属性的主视图模型。如果没有必要，不要引入同步的需要。

# extjs - 网格数据未显示在 ExtJs 应用程序中

> ID：11837227
> 
> 赞同：1
> 
> 时间：2012-08-06T23:11:11.393
> 
> 标签：extjs, extjs4.1

我正在使用 ExtJs 4.1.0，并且正在尝试显示由远程 json 存储支持的数据网格。当我像这样渲染网格时：

```
Ext.Loader.setConfig({enabled:true});
Ext.Loader.setPath({
    'Grip':'app'
    ,'Ext.ux':'ext/examples/ux'
});
Ext.require([
    'Grip.view.EditableGrid'
    ,'Grip.store.UYNMeetingTypes'
    ,'Grip.view.UYNMeetingGrid'
    ,'Grip.model.UYNMeeting'
    ,'Grip.store.UYNMeetings'
    ,'Ext.ux.CheckColumn'
]);

Ext.require([
    'Ext.panel.*',
    'Ext.toolbar.*',
    'Ext.button.*',
    'Ext.container.ButtonGroup',
    'Ext.layout.container.Table',
    'Ext.tip.QuickTipManager'
]);

Ext.onReady(function() {

    var store = new Grip.store.UYNMeetings();
    grid = new Grip.view.UYNMeetingGrid({
        store: store
        ,renderTo: Ext.getBody()
    });
    store.load({
        // store loading is asynchronous, use a load listener or callback to handle results
        callback: function(){
            Ext.Msg.show({
                title: 'Store Load Callback',
                msg: 'store was loaded, data available for processing',
                modal: false,
                icon: Ext.Msg.INFO,
                buttons: Ext.Msg.OK
            });
        }
    });
}); 
```

它工作正常。但是，当我尝试使用 MVC 教程 ( [http://www.sencha.com/learn/architecting-your-app-in-ext-js-4-part-2/](http://www.sencha.com/learn/architecting-your-app-in-ext-js-4-part-2/) ) 中建议的方式将事物联系起来时，我似乎无法显示我的数据。我在 Google Chrome 20.0.1132.47 上运行 ExtJs 4.1.0。有任何想法吗？

我试图只发布最低限度相关的代码（尽管看起来仍然很多）。如果有什么我可以澄清的，请告诉我。任何帮助将不胜感激。谢谢！

Grip.controller.UYNMeeting：

Ext.define('Grip.controller.UYNMeeting', { 扩展：'Ext.app.Controller',

```
refs: [{
    ref: 'meetingGrid',
    selector: 'uynmeetinggrid'
}],

stores: ['UYNMeetings','UYNMeetingTypes'],

init: function() {

},

onLaunch: function() {
    var meetingsStore = this.getUYNMeetingsStore();        
    meetingsStore.load({
        callback: this.onMeetingsLoad,
        scope: this
    });
    var meetingTypesStore = this.getUYNMeetingTypesStore();        
    meetingTypesStore.load({
        callback: this.onMeetingTypesLoad,
        scope: this
    });
},

onMeetingsLoad: function() {
},

onMeetingTypesLoad: function() {
    Ext.Msg.show({
        title: 'Store Load Callback',
        msg: 'store was loaded, data available for processing',
        modal: false,
        icon: Ext.Msg.INFO,
        buttons: Ext.Msg.OK
    });
} 
```

});

Grip.view.UYNMeetingGrid：

```
var rowEditing = Ext.create('Ext.grid.plugin.RowEditing', {
    clicksToMoveEditor: 1,
    autoCancel: false
});

Ext.define('Grip.view.UYNComboBox', {
    extend:'Ext.form.field.ComboBox'
    ,alias:'widget.uyncombo'
    ,stores:['UYNMeetingTypes']
})

Ext.define('Grip.view.UYNMeetingGrid', {
    extend:'Ext.grid.Panel'
    ,alias:'widget.uynmeetinggrid'

    ,stores:['UYNMeetings']
    ,title:'UYN Meetings Grid'
    ,hideHeaders: true

    ,bodyPadding:5
    ,width:550
    ,height:400
    ,autoScroll: true

    ,initComponent:function(){
        this.columns = [{
            "width": 150,
            "text": "Name",
            "sortable": true,
            //"id": "name",
            "dataIndex": "name",
            editor: {
                allowBlank: false,
                xtype: 'textfield'
            }
        },
        {
            "width": 150,
            "text": "Org.",
            "sortable": true,
            //"id": "org",
            "dataIndex": "org",
            editor: {
                allowBlank: true,
                xtype: 'textfield'
            }
        },
        {
            "width": 100,
            "text": "Date",
            "sortable": true,
            //"id": "date",
            "dataIndex": "date",

            editor: {
                xtype: 'datefield',
                allowBlank: false,
                format: 'm/d/Y',
                maxText: 'Cannot have a meeting date in the future!',
                maxValue: Ext.Date.format(new Date(), 'm/d/Y')
            }
        },
        {
            "width": 75,
            "text": "Meeting Type",
            "sortable": true,
            //"id": "meeting_type",
            "dataIndex": "meeting_type"/*,
            editor: {
                xtype: 'uyncombo'
            }*/
        },
        {
            "width": 75,
            "text": "Num Hours",
            "sortable": true,
            //"id": "num_hours",
            "dataIndex": "num_hours",
            editor: {
                allowBlank: false,
//                 step: '.1',
                xtype: 'numberfield'
            }
        }];

        this.dockedItems = [{
            dock:'bottom'
            ,xtype:'toolbar'
            ,items: [{
                xtype:'button'
                ,text:'New'
                ,action:'newuynmeeting'
            }, {
                xtype:'button'
                ,text:'Edit'
                ,action:'edituynmeeting'
            }, {
                xtype:'button'
                ,text:'Remove'
                ,action:'removeuynmeeting'
            }]
        }];

        this.callParent();
    }

    ,plugins: [rowEditing]
    ,listeners: {
        'selectionchange': function(view, records) {
//          grid.down('#removeEmployee').setDisabled(!records.length);
        }
    }

}); 
```

Grip.view.Viewport：

```
Ext.define('Grip.view.Viewport', {
    extend: 'Ext.container.Viewport',
    layout: 'fit',

    requires: [
        'Grip.view.ContactsPanel'
        ,'Grip.view.UYNMeetingForm'
        ,'Grip.view.UYNMeetingGrid'
        ,'Grip.view.NavBar'
    ],
    renderTo: 'app',
    tbar:{
        xtype:'mynavbar'
    },
    items:[{
        xtype:'tabpanel',
        items:[{ 
            title:'Contacts',
            xtype:'tabpanel',
            items:[{
                title:'Contacts'
                ,xtype:'contactspanel'
            },{
                title:'Add Contact'
                ,html:'TODO: Add content'
            }
            ]
        },{
            title:'UYN',
            xtype:'tabpanel',
            items:[{
                title:'UYN Meetings'
                //,html:'Foo'
                ,xtype:'uynmeetinggrid'
            }]
        }]
    }]

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:42:29.403

我不知道这是否是一个错字，但网格没有`stores`配置 - 它只能显示一个商店的数据，因此它有一个`store`配置（单数，而不是复数）

# python - *大* python 字典，具有持久性存储，用于快速查找

> ID：11837229
> 
> 赞同：25
> 
> 时间：2012-08-06T23:11:38.253
> 
> 标签：python, persistence, object-persistence

我有 4 亿行唯一的键值信息，我希望可以在脚本中快速查找这些信息。我想知道这样做的巧妙方法是什么。我确实考虑了以下内容，但不确定是否有一种方法可以对字典进行磁盘映射，并且除了在创建字典期间之外不使用大量内存。

1.  腌制字典对象：不确定这是否是我的问题的最佳解决方案
2.  NoSQL 类型 dbases ：理想情况下，希望对第三方的依赖最小的东西加上键值就是简单的数字。如果你觉得这仍然是最好的选择，我也想听听。也许它会说服我。

如果有任何不清楚的地方，请告诉我。

谢谢！-阿比

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-06T23:15:43.637

如果你想持久化一个大字典，你基本上是在查看一个数据库。

Python 内置了对[sqlite3](http://docs.python.org/library/sqlite3)的支持，它为您提供了一个由磁盘上的文件支持的简单数据库解决方案。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-08-07T00:01:41.040

原则上，[搁置](http://docs.python.org/library/shelve#module-shelve)模块完全符合您的要求。它提供了一个由数据库文件支持的持久字典。键必须是字符串，但 shelve 会处理酸洗/取消酸洗值。db 文件的类型可以变化，但可以是[Berkeley DB](http://en.wikipedia.org/wiki/Berkeley_DB)哈希，这是一个优秀的轻量级键值数据库。

您的数据量听起来很大，因此您必须进行一些测试，但搁置/BDB 可能取决于它。

*注意：[bsddb](http://docs.python.org/library/bsddb.html#module-bsddb)模块已被弃用。将来可能搁置不支持 BDB 哈希。*

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-08-07T01:05:41.303

没有人提到dbm。它像文件一样打开，行为像字典，并且在标准发行版中。

来自文档[https://docs.python.org/3/library/dbm.html](https://docs.python.org/3/library/dbm.html)

```
import dbm

# Open database, creating it if necessary.
with dbm.open('cache', 'c') as db:

    # Record some values
    db[b'hello'] = b'there'
    db['www.python.org'] = 'Python Website'
    db['www.cnn.com'] = 'Cable News Network'

    # Note that the keys are considered bytes now.
    assert db[b'www.python.org'] == b'Python Website'
    # Notice how the value is now in bytes.
    assert db['www.cnn.com'] == b'Cable News Network'

    # Often-used methods of the dict interface work too.
    print(db.get('python.org', b'not present'))

    # Storing a non-string key or value will raise an exception (most
    # likely a TypeError).
    db['www.yahoo.com'] = 4

# db is automatically closed when leaving the with statement. 
```

我会在任何更奇特的形式之前尝试这个，并且使用搁置/泡菜会在加载时将所有内容拉入内存。

干杯

蒂姆

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-08-06T23:20:49.487

毫无疑问（在我看来），如果您希望这种情况持续存在，那么 Redis 是一个不错的选择。

1.  安装 redis 服务器
2.  启动redis服务器
3.  安装 redis python pacakge (pip install redis)
4.  利润。

* * *

```
import redis

ds = redis.Redis(host="localhost", port=6379)

with open("your_text_file.txt") as fh:
    for line in fh:
        line = line.strip()
        k, _, v = line.partition("=")
        ds.set(k, v) 
```

上面假设文件的值如下：

```
key1=value1
key2=value2
etc=etc 
```

根据您的需要修改插入脚本。

* * *

```
import redis
ds = redis.Redis(host="localhost", port=6379)

# Do your code that needs to do look ups of keys:
for mykey in special_key_list:
    val = ds.get(mykey) 
```

为什么我喜欢 Redis。

1.  可配置的持久性选项
2.  极快
3.  提供的不仅仅是键/值对（其他数据类型）
4.  [@antrirez](http://twitter.com/antirez)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-08-06T23:17:05.053

我认为你不应该尝试腌制的字典。我很确定 Python 每次都会吃掉整个东西，这意味着你的程序等待 I/O 的时间可能比必要的要长。

这就是发明数据库的问题。您正在考虑“NoSQL”，但 SQL 数据库也可以工作。您应该能够为此使用 SQLite；我从来没有做过这么大的 SQLite 数据库，但是根据这个关于 SQLite 限制的讨论，4 亿个条目应该没问题。

[具有非常大的数据库文件的 sqlite 的性能特点是什么？](https://stackoverflow.com/questions/784173/what-are-the-performance-characteristics-of-sqlite-with-very-large-database-file)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-05-11T09:17:38.987

我个人使用[LMDB](http://symas.com/mdb/)及其[python 绑定](http://pypi.python.org/pypi/lmdb)来处理几百万条记录数据库。即使对于比 RAM 更大的数据库，它也非常快。它嵌入在流程中，因此不需要服务器。使用 pip 管理依赖关系。

唯一的缺点是您必须指定数据库的最大大小。LMDB 将映射这个大小的文件。如果太小，插入新数据会引发错误。要大，您创建稀疏文件。

# iframe - 预加载fancybox iframe

> ID：11837236
> 
> 赞同：2
> 
> 时间：2012-08-06T23:12:33.607
> 
> 标签：iframe, preload, fancybox-2

我有一个fancybox iframe，有没有办法在点击打开链接之前预加载iframe的内容？iframe 内容是脚本，而不是图像。

脚本：

```
$("a.fancybox").fancybox({ 
fitToView: false, 
afterLoad: function(){
this.width = $(this.element).data("width");
this.height = $(this.element).data("height"); }
}); 
```

HTML：

```
<a class="fancybox fancybox.iframe" data-width="950" data-height="90%" href="/?page_id=1508" >MLS® SEARCH</a> 
```

谢谢！

# rabbitmq - 从 RabbitMQ 队列中弹出一个元素

> ID：11837238
> 
> 赞同：0
> 
> 时间：2012-08-06T23:12:50.437
> 
> 标签：rabbitmq, pika

我有一个队列，我已经从中塞满了一些 n 元素。

我想从中取出1个元素，然后退出回调。`pika`示例都使用了回调机制，这在应用程序结构中确实没有意义。

定义回调如下

```
def callback(...):
  do_data_thinggs(...)
  exit(0) 
```

不起作用，因为消息留在队列中

这样做的惯用语是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T09:31:27.623

你会想看看频道上的 basic_get 方法，看看：

[https://github.com/pika/pika/blob/03542ef616a2a849e8bfb0845427f50e741ea0c6/docs/examples/blocking_basic_get.rst](https://github.com/pika/pika/blob/03542ef616a2a849e8bfb0845427f50e741ea0c6/docs/examples/blocking_basic_get.rst)例如，这将阻塞直到收到消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T10:12:30.487

如果我理解正确，我认为这与您不确认有关。看看这个教程：[RabbitMQ 教程 2](http://www.rabbitmq.com/tutorials/tutorial-two-python.html)

# actionscript-3 - Google Chrome 中的 Flash 音频延迟

> ID：11837241
> 
> 赞同：3
> 
> 时间：2012-08-06T23:12:58.470
> 
> 标签：actionscript-3, flash, google-chrome, actionscript

我目前正在开发一个 Flash 游戏，至少在我的机器上，音频在 Chrome 中似乎滞后了几分之一秒，但在 IE 或 FF 中却没有。这不是什么大问题，游戏仍然可以玩，但有点烦人。从开发的角度来看，我能做些什么来解决这个问题，还是用户必须解决的问题？

编辑：我现在已经在另外两台机器上测试过了，同样的事情发生了。音频在 chrome 中延迟，但在 Firefox 或 IE 中没有。

编辑 2：我也在 Newgrounds 上的一些流行游戏中尝试过同样的事情，达到同样的效果。这只是 Chrome 的问题吗？

编辑 3：我尝试将音频的比特率从 44kHz 降低到 22，但它没有做任何修复它。（可以预见，这听起来也很糟糕）

编辑 4：为了证明这不是内存管理问题，我创建了一个空白 SWF，它只在鼠标单击时播放音频文件，它也有延迟问题。这绝对不是 Flash 或 AS3 孤立的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T09:00:32.453

我对 Chrome 有同样的问题。

如果你去： chrome://plugins (->details) 并禁用 PepperFlash，那么它运行顺利。不确定 Pepper 是否是 Chrome 的默认设置，或者它是否是我们安装的特定版本的 flash。

C:\Users\ [用户名] \AppData\Local\Google\Chrome\Application\21.0.1180.75\PepperFlash\pepflashplayer.dll

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-24T00:44:48.413

我有一个断断续续的音频，然后视频开始滞后。解决方案有两个：

1.  重新安装铬。
2.  获取最新的 Adob​​e Flash Player。

我必须做这两件事才能正常工作。要获取插件，请在 chrome 地址栏中键入以下内容：chrome://plugins

安装最新的播放器后，您需要禁用旧的播放器。

希望这能像对我一样解决您的问题。

# c# - 如何在 C# 中创建对象？

> ID：11837245
> 
> 赞同：1
> 
> 时间：2012-08-06T23:13:59.177
> 
> 标签：c#, .net, activex, com-interop, tlbimp

我想将以下 VB6 代码翻译成 C#

```
If optHost(0).Value Then
   Set m_oScpiAccess = New IcSCPIActiveX.IcSCPIAccess
Else
   sHost = txtHost.Text
   Set m_oScpiAccess = CreateObject("Exfo.IcSCPIActiveX.IcSCPIAccess", sHost)
End If 
```

我使用 TlbImp.exe 为 COM 类创建包装器，我尝试了：

```
if (string.IsNullOrEmpty(host))
{
   // this works
   IcSCPIAccess = new IcSCPIAccess();
}
else
{
   // throws MissingMethodException
   IcSCPIAccess = (IcSCPIAccess)Activator.CreateInstance(
       typeof(IcSCPIAccessClass),
       host);
} 
```

但是没有接受`host`参数的构造函数

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T23:45:59.817

它不是构造函数调用。sHost变量包含一台*机器*的名称，该机器提供进程外 COM 服务器。等效功能由 Type.GetTypeFromProgId() 提供，使用允许指定服务器名称的重载：

```
 var t = Type.GetTypeFromProgID("Exfo.IcSCPIActiveX.IcSCPIAccess", sHost, true);
  obj = (IcSCPIAccess)Activator.CreateInstance(t); 
```

我将其命名为“obj”，请避免为变量赋予与接口类型相同的名称。无数的事情仍然可能出错，在客户端和服务器机器上正确注册 COM 服务器并正确设置 DCOM 安全性对于使此代码正常工作至关重要。在确定原始代码可以正常工作之前，请勿尝试此操作。

# java - 从 Java 打印到 Epson PictureMate

> ID：11837247
> 
> 赞同：0
> 
> 时间：2012-08-06T23:14:19.660
> 
> 标签：java, printing

我将使用 Java 打印 API 将 JPG 打印到 Epson PictureMate 照片打印机。我希望打印占据整个页面。图像已打印，但右侧边缘有八分之一英寸的未打印空间。这是我正在使用的代码：

```
public void printImage(File image) throws Exception {
  PrintRequestAttributeSet aset = new HashPrintRequestAttributeSet();
  aset.add(OrientationRequested.REVERSE_LANDSCAPE);
  aset.add(MediaSizeName.JAPANESE_POSTCARD);
  DocPrintJob printerJob = printService.createPrintJob();       
  FileInputStream fis = new FileInputStream(image);
  Doc doc = new SimpleDoc(fis, DocFlavor.INPUT_STREAM.JPEG, null);
  printerJob.print(doc, aset);
  fis.close();
} 
```

我认为`JAPANESE_POSTCARD`尺寸是正确的，但对于 4"x6" 打印来说它似乎很小。我也尝试设置`MediaPrintableArea`为 4"x6"，但这也不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T23:19:40.313

我知道在您将 Paper 传递给 之后，Paper 会发生一些（潜在的）内部争吵`PrintJob`，基本上它试图验证纸张尺寸和边距是否可以与指定的打印机一起使用（根据经验）。

但是，您可能会阅读[http://www.jpedal.org/PDFblog/2009/06/java-printing-page-size-problem/](http://www.jpedal.org/PDFblog/2009/06/java-printing-page-size-problem/)，因为它可能对如何克服其中一些问题有一些想法。

至于他们如何将其应用回`PrintService`s API 是另一个问题；）

# android - 将字符串从活动传递到广播接收器

> ID：11837248
> 
> 赞同：0
> 
> 时间：2012-08-06T23:14:30.127
> 
> 标签：android, string, broadcastreceiver

当应用程序当前未在屏幕上打开时，我在将字符串从主要活动传递到广播接收器时遇到问题。

创建 MainActivity 类时，intent 过滤器通过广播接收器返回正确的信息，但是一旦用户进入手机的主屏幕，当接收器在屏幕外触发时，广播接收器就会开始为 toast 返回“null”。

**1.**新意图

```
Intent home_page = new Intent(newIntent.this,MainActivity.class);

 ownAddress  = ""+customInput.getText().toString();
  home_page.putExtra("session_number", ""+ownAddress);

startActivity(home_page); 
```

**2.** MainActivity.java：

```
public class MainActivity extends DroidGap {
SmsReceiver mAppReceiver = new SmsReceiver();

 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    Bundle bundle = getIntent().getExtras();
    final String ownAddress  = bundle.getString("session_number");

    registerReceiver(mAppReceiver, new IntentFilter("SmsReceiver"));
     Intent intent = new Intent("SmsReceiver");
      intent.putExtra("passAddress", ownAddress);
    sendBroadcast(intent);

 }

} 
```

**3.SmsReceiver.java**：

```
public class SmsReceiver extends BroadcastReceiver {

 public void onReceive(Context context, Intent intent) {

    Toast showme = Toast.makeText(context,"Number: "+intent.getExtras().get("passAddress"),Toast.LENGTH_LONG);
    showme.show();

 }

} 
```

当应用程序仅在后台运行或无论何时创建 MainActivity 类时，是否有将字符串传递给广播接收器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T23:32:36.867

我在这里可能错了，但是从逻辑上讲，“当接收器在屏幕外触发时，广播接收器开始为 toast 返回“null””的原因是因为当用户转到 onReceive 构造函数时，传递给构造函数的上下文被破坏了主屏幕。

我想传递字符串的一种解决方案是在 MainActivity 中创建一个公共静态字符串变量，用于存储要传递的字符串值。然后你所要做的就是在你的 BroadcastReceiver 中静态地访问这个字符串。

# qt4 - GTK：将“桌面”标志添加到窗口

> ID：11837249
> 
> 赞同：1
> 
> 时间：2012-08-06T23:14:33.837
> 
> 标签：qt4, gtk, pygtk, pyqt4, desktop

我正在尝试使用 PyGTK 将窗口功能作为桌面（显示图标的东西）。使用 Qt4，我可以设置此属性：

```
window.setAttribute(Qt.WA_X11NetWmWindowTypeDesktop) 
```

GTK有类似的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:24:11.140

没关系，我找到了：

```
window.set_type_hint(gtk.gdk.WINDOW_TYPE_HINT_DESKTOP) 
```

还有一个非常有用的来源：[http ://bloc.eurion.net/archives/2009/standalone-pygtk-desktop-widgets/](http://bloc.eurion.net/archives/2009/standalone-pygtk-desktop-widgets/)

# xml - 向 XSLT 中的 CDATA 节点添加属性

> ID：11837253
> 
> 赞同：0
> 
> 时间：2012-08-06T23:14:50.487
> 
> 标签：xml, xslt, xslt-1.0

我正在尝试将属性添加到属于 CDATA 的节点。我的 XML 是

```
 <documents>
   <document id="1234">
    <field name="CDATA" value="bill"><![CDATA[<bill name="xxx" age="12" />]]> </field>
   </document>
 </documents> 
```

结果 xml 应该是

```
<docs>
  <doc>
   <bill name="xxx" age="12" id="1234" />
  </doc>
</docs> 
```

文档节点中的 id 属性应作为属性添加到 CDATA 内的节点。

我能够将 CDATA 值作为字段 [@name='CDATA'] 获取，但我不确定如何将文档的属性添加到 cdata..

谁能建议我如何做到这一点或指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T02:09:47.450

**CDATA 部分只是文本节点的一部分**。

因此它只包含文本而没有节点（即使文本看起来与节点的文本序列化相同）。

**因此，您想要的在纯 XSLT 1.0 和 2.0 中是不可能的，除非您还有一个用 XSLT 编写的 XML 解析器**。

在 XSLT 3.0/XPath 3.0（仍然是草稿）中可能有一个函数：**[`parse-xml()`](http://www.w3.org/TR/xpath-functions-30/#func-parse-xml)**可用于解析文本并从中创建 XML 文档/片段：

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T05:37:22.217

CDATA 的意思是“即使看起来像标记，这里的内容也将被视为纯文本”。CDATA 是对解析器的显式指令，用于忽略内容中的标记。这是 CDATA 标记的唯一用途。因此，根据定义，CDATA 部分内没有节点。

# javascript - Facebook 应用程序中的弹出窗口有问题

> ID：11837259
> 
> 赞同：-1
> 
> 时间：2012-08-06T23:15:38.847
> 
> 标签：javascript, facebook, html

如果我网站上的 Facebook 用户不允许我们在 Facebook 上使用我们的应用程序，我正在尝试在我的网站上制作一个弹出窗口以用作内容储物柜。我相信我的弹出窗口代码写得很好，因为它本身就可以正常运行。检查用户是否登录的 Facebook 代码也可以独立正常工作。我无法将 Facebook javascript 和我的 DIV 结合起来。我的弹出窗口一直有效，直到我尝试将弹出窗口的 DIV 放入我的`else`or `else if`statments 中。

我可以将这些 div 放入 javascript`else if`和`else`语句中吗？以下 DIV 是我试图放入语句中的内容：

```
<div class="overlay"><div class="overlay-content"></div></div> 
```

我还尝试通过将 div 放入其中来显示它们，`document.write`但这也对我没有帮助。

我的代码可以在[这里找到](http://pastebin.com/TdiA1x8T)，或者从那里粘贴：

```
FB.getLoginStatus(function(response) {
if (response.status === 'connected'){
    document.write("Looks like you're logged into Facebook and our app :)");
    // the user is logged in and connected to your
    // app, and response.authResponse supplies
    // the user’s ID, a valid access token, a signed
    // request, and the time the access token 
    // and signed request each expire
    var uid = response.authResponse.userID;
    var accessToken = response.authResponse.accessToken;
} 
else if (response.status === 'not_authorized'){
    <div class="overlay"><div class="overlay-content"></div></div>
    // the user is logged in to Facebook, 
    //but not connected to the app
}
else{
    <div class="overlay"><div class="overlay-content"></div></div> 
    // the user isn't even logged in to Facebook.
}
});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T08:51:04.197

> 我的弹出窗口一直有效，直到我尝试将弹出窗口的 DIV 放入我的 else 或 else if 语句中。

那是因为你只是在混合 JS 和 HTML 代码，这是不可能的。（请了解这些事情如何工作的一些基本知识，因为这种尝试表明明显缺乏这些基本知识！）

> 我还尝试通过将它们放在 document.write 中来显示 div，但这也对我没有帮助。

这也不是一个有前途的方法。document.write 在文档初始渲染后调用，将*替换*当前文档。所以这也不是你想要的。

解决方案非常简单——随时在您的 HTML 代码中添加覆盖的 DIV 元素；然后，在检查登录后，只需将其样式设置为 display:none （例如，直接或通过操作它的类）使其不可见，或者将其从 DOM 中完全删除。

再次，请获得有关您要使用的技术的一些*基本知识。*

# javascript - 如何在 d3.js 的 javascript 中解决这样的范围问题？

> ID：11837262
> 
> 赞同：0
> 
> 时间：2012-08-06T23:15:47.537
> 
> 标签：javascript, scope, d3.js

我正在使用 d3.js，我发现这很有效：

```
function zoom_in () {
    d3.select(this)
        .select("text")
        .style("font-size","55px");
}
var node = svg.selectAll("g.node")
    .data(json.nodes, function(d) { return d.name;})
    .enter().append("g")
    .on("mouseover", zoom_in); 
```

但这不起作用：

```
function zoom_in () {
    d3.select(this)
        .select("text")
        .style("font-size","55px");
}
var already_done = 0;
var node = svg.selectAll("g.node")
    .data(json.nodes, function(d) { return d.name;})
    .enter().append("g")
    .on("mouseover", function() {zoom_in();already_done=1;}) 
```

但是，我想在调用`zoom_in`函数后做一些事情。我不想写另一个函数`zoom_in_already_done`。

`this`我认为问题是由`zoom_in`. 任何人都知道如何解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T21:14:54.543

找到了这样的方法：

```
function zoom_in (ts) {
    d3.select(ts)
        .select("text")
        .transition()
        .style("fill",function(d) { return color(d.group);})
        .attr("dx",20)
        .style("font-size","55px");
} 
```

然后

```
.on("mouseover", function() {if (dragging==0){zoom_in(this)}}) 
```

# java - Java：压缩后删除解压缩的文件

> ID：11837269
> 
> 赞同：-3
> 
> 时间：2012-08-06T23:16:30.050
> 
> 标签：java, delete-file

我有一个`C:/path`最初包含`abc.xml, img1.jpg, img2.jpg, xyz.html, xyz1.html`等的文件夹，在运行 java 压缩程序后，我的文件夹包含`ABC.zip, abc.xml, img1.jpg, img2.jpg, xyz.html, xyz1.html`我只想`C:/path/ABC.zip`在那里，其余的文件应该被删除。创建 zip 文件夹后如何删除这些文件。感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T23:22:11.530

基本上，一旦您对 zip 文件已成功创建感到满意，就带您`listFiles`遍历它们并调用该`delete`方法。

```
//... all files zipped

for (File file : listFiles) {
    if (!file.delete()) {
      file.deleteOnExit();
    }
}

//... remove the parent folder if you wish, the same way as above 
```

# iphone - 在 iPhone 应用程序中嵌入谷歌日历

> ID：11837270
> 
> 赞同：1
> 
> 时间：2012-08-06T23:16:29.547
> 
> 标签：iphone, ios, xcode4.3

如何使用最新版本的 xcode (4.3.3) 在 iPhone 应用程序中嵌入谷歌日历？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:29:33.643

好吧，我会使用`UIWebView`. 那将是最简单的。然后只需将其加载到谷歌端的日历登录即可。像这样在你的`viewDidLoad`.

```
[YourWebview loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:
                                                   @"Your URL Here"]]]; 
```

# android - 如何从谷歌云或设备读取歌曲

> ID：11837282
> 
> 赞同：3
> 
> 时间：2012-08-06T23:17:16.007
> 
> 标签：android, mediastore

大图：GUI 向用户显示他们的播放列表列表。用户选择一个。程序将选择的播放列表传递给下一个显示该播放列表中歌曲的活动。

问题：我可以显示播放列表并注册用户选择，但我似乎无法显示该播放列表的歌曲。

是的，我看到了以下问题：

[如何在 Android SDK 上查询播放列表中的歌曲？](https://stackoverflow.com/questions/7768631/how-to-query-for-songs-in-playlists-on-android-sdk)

[给定一个 Android 音乐播放列表名称，如何在播放列表中找到歌曲？](https://stackoverflow.com/questions/2694909/given-an-android-music-playlist-name-how-can-one-find-the-songs-in-the-playlist)

[MediaStore.Audio.Playlists.Members.getContentUri 的 String 'volumeName' 参数指的是什么？](https://stackoverflow.com/questions/2627330/what-is-the-string-volumename-argument-of-mediastore-audio-playlists-members-g)

正如您在我的代码中看到的那样，我已尽我所能来实现这些解决方案，但无济于事。

要记住的事情：我在 Galaxy Nexus 上测试这个，所以没有 SD 卡。只是云中的内部存储和音乐。我需要它在任何场景（内部、外部或云）中工作。它目前在这些都不起作用。

```
//@SuppressWarnings ("serial)")
public class CreationActivity extends Activity {
private final String [] STAR= {"*"};
//reads in all songs to an array

@Override
public void onCreate (Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    //set layout view and assign to variable
    setContentView(R.layout.creation);
    TableLayout myLayout = (TableLayout)findViewById(R.id.creationLayout);

    try {
        Bundle extras = getIntent().getExtras();

        if (extras!=null){
            //get the desired playlist and ID
            String playlist = extras.getString("playlist");
            Long playlistID = extras.getLong("playlistID");
            ArrayList<song> songs = new ArrayList<song>();

            //read in the songs from the playlist
            String[] proj = {MediaStore.Audio.Playlists.Members.TITLE,
                    MediaStore.Audio.Playlists.Members.ARTIST,
                    MediaStore.Audio.Playlists.Members.DURATION};

            //method 1
            Cursor songCursor = getContentResolver().query(MediaStore.Audio.Playlists.Members.getContentUri(null,playlistID),
                    proj,
                    null,
                    null,
                    null);

            //method 2
            /*
            Cursor songCursor = getContentResolver().query(Uri.parse("content://com.google.android.music.MusicContent/playlists/members"),
                   proj,
                    null,
                    null,
                    null);
            */

            //method 3
            /*
            Uri membersUri = MediaStore.Audio.Playlists.Members.getContentUri("internal", playlistID);
            Cursor membersCursor = managedQuery(membersUri, STAR, null, null, null);
            */

            //then this part with methods 1 and 2
            /*
            if (songCursor.getCount() > 0) {
                songCursor.moveToFirst();
                do {
                    song currSong = new song();
                    currSong.title = songCursor.getString(0);
                    currSong.artist = songCursor.getString(1);
                    songs.add(currSong);
                } while (songCursor.moveToNext());
            }
            songCursor.close();
            */

            //or this part with method 3
        /*
            membersCursor.moveToFirst();
            for(int s= 0; s<membersCursor.getCount(); s++,                           
                      membersCursor.moveToNext()){
                  song currSong = new song();
                      currSong.title = songCursor.getString(0);
              currSong.artist = songCursor.getString(1);
          songs.add(currSong);
            }
            membersCursor.close();
            */

        }else{
            Toast.makeText(getBaseContext(), "No songs",Toast.LENGTH_LONG).show();
        }
    } catch (NumberFormatException e){
    }
}
} 
```

编译过程中没有错误。但“可惜音乐App意外退出了”。每次。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-18T16:45:54.870

我想到了。关键是将播放列表 ID 用作 URI 中的字符串。请参阅下面的代码。

这是获取播放列表名称和 ID 的部分：

```
String[] proj = {MediaStore.Audio.Playlists.NAME, MediaStore.Audio.Playlists._ID};
    Uri playlistUri = Uri.parse("content://com.google.android.music.MusicContent/playlists");
    Cursor playlistCursor = getContentResolver().query(playlistUri, proj, null, null, null);
    if (playlistCursor.getCount() > 0) {
        playlistCursor.moveToFirst();
        do {
            nameList.add(playlistCursor.getString(0));
            idList.add(playlistCursor.getLong(1));
        } while (playlistCursor.moveToNext());
    } 
```

然后，一旦您拥有播放列表 ID，您就可以查询播放列表中的歌曲。这是实际查询信息并将其全部放入数组列表的代码部分。注意：“song”是我在别处定义的类，其中 readSong 是一种将值分配给各种值（标题、艺术家等）的方法。

```
ArrayList<song> songs = new ArrayList<song>();

            //read songs into library from the correct playlist
            String[] proj = {MediaStore.Audio.Playlists.Members.TITLE, MediaStore.Audio.Playlists.Members.ARTIST, MediaStore.Audio.Playlists.Members.DURATION, MediaStore.Audio.Playlists.Members._ID};
            Uri songUri = Uri.parse("content://com.google.android.music.MusicContent/playlists/" + playlistID + "/members");
            Cursor songCursor = getContentResolver().query(songUri, proj, null, null, null);
            if (songCursor.getCount() > 0) {
                songCursor.moveToFirst();
                do {
                    //create dummy song
                    song currSong = new song();
                    //read info to dummy var
                    currSong.readSong(songCursor);
                    //add instance to collection
                    songs.add(currSong);
                } while (songCursor.moveToNext());
            }
            songCursor.close(); 
```

我希望这可以帮助其他为此苦苦挣扎的人！如果您对我的方法或改进方法有任何意见，请告诉我！

# java - 如何在 appengine 中将 png 与透明背景结合起来？

> ID：11837288
> 
> 赞同：0
> 
> 时间：2012-08-06T23:17:52.777
> 
> 标签：java, google-app-engine

我想将更多具有透明背景的 png 组合成一个图像，该图像稍后将提供给客户端。如何在 appengine 中实现这一点？似乎 api 不起作用，因为不尊重透明度。这是我的片段：

```
 ArrayList<Composite> comps = new ArrayList<Composite>();
            comps.add(ImagesServiceFactory.makeComposite(getImageFromStaticFile("imgs/odontogram/dente_colore/dente_colore_11.png"), 0, 0, 1, Anchor.TOP_LEFT));
            comps.add(ImagesServiceFactory.makeComposite(getImageFromStaticFile("imgs/odontogram/dente_colore/dente_colore_12.png"), 10, 0, 1, Anchor.TOP_LEFT));
            long color = 0xFFFFFFFFL;
            Image resImg = ImagesServiceFactory.getImagesService().composite(comps, 429, 189, color);
            response.getOutputStream().write(resImg.getImageData()); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T22:22:01.147

一种选择是使用 Python 2.7 下可用的 Python Image Library (PIL)。看起来您的应用程序是 Java，但您可以将 Python 代码部署到不同的版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T22:52:32.093

如果没有保留 alpha 通道并且您的输出编码格式支持 alpha 通道（即不是 jpeg），那么这听起来像是一个错误。

您可以在问题跟踪器中提交问题并附上示例图像和代码片段吗？

谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-09T09:45:29.240

我对透明度问题做了更深入的研究，发现问题只存在于开发服务器上。在生产中似乎很好。它仍然很烦人，因为我必须等待 20 分钟才能完成部署，但至少它可以工作......

感谢大家的回答。

# css - 第一个孩子和最后一个孩子对 CSS 不起作用

> ID：11837289
> 
> 赞同：0
> 
> 时间：2012-08-06T23:18:06.400
> 
> 标签：css

第一个孩子应该显示图像图标主页，最后一个孩子不应该显示背景图像：

继承人的小提琴：http: [//jsfiddle.net/gUqC2/](http://jsfiddle.net/gUqC2/)

但在第一个孩子中没有显示图像，并且在最后一个孩子中没有删除图像

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T23:24:12.710

您似乎对类和伪选择器感到困惑，伪选择器`:first-child`不*等同*于`.first`（类名）。同样，`:last-child`不等同于`.last`（再次，类名）。

采用：

```
.bodyheader ul li:first-child a:hover { background-position: 0 -16px; }
.bodyheader ul li:last-child { background: none; margin-right: 0; padding-right: 0; } 
```

[更新了 JS Fiddle](http://jsfiddle.net/davidThomas/gUqC2/4/)

参考：

*   [W3.org 的 CSS 选择器页面上的伪类](http://www.w3.org/TR/CSS2/selector.html#pseudo-class-selectors)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T23:23:08.520

使用`:first-child`and`:last-child`代替`.first`and`.last`

`.whatever`指的是带有`class="whatever"`, while`:first-child`和的元素`:last-child`是伪选择器，就像你在`:hover`链接中使用的那样

# javascript - 需要在 SlideToggle 发生后发生 DIV 显示/隐藏开关

> ID：11837290
> 
> 赞同：0
> 
> 时间：2012-08-06T23:18:18.863
> 
> 标签：javascript, jquery, function, animation

我在网格中有一系列“产品”div，每个都是可点击的。单击时，相应的“产品信息”DIV 会向下滑动以显示相应的产品信息。我有一些工作，但我有几个问题。

我怎样才能做到这一点，当一组信息显示，但另一个“产品”div被点击时，当前信息滑入隐藏状态，切换产品信息，然后显示新信息。有道理？

如果下面的代码没有意义，直接链接在[这里](http://gp3designs.com/starter/nancy/work.html)

这是隐藏信息的 HTML。“selected_show”类的样式为“display:none;” 开始：

```
<section>
        <div class=selected_show>
            <div>
                <div class="product_info grassone piece_info">
                    <img src="./images/detail_info/astronomical.jpg">
                    <div>
                        <p>Short description of the piece...</p>
                    </div>
                </div>
            </div>

            <div>
                <div class="product_info competitive piece_info">
                    <img src="./images/detail_info/astronomical.jpg">
                    <div style="background:red;">
                        <p>Short description of the piece...</p>
                    </div>
                </div>
            </div>

            <div>
                <div class="product_info magpie piece_info">
                    <img src="./images/detail_info/astronomical.jpg">
                    <div style="background:blue;">
                        <p>Short description of the piece...</p>
                    </div>
                </div>
            </div>
        </div>
    </section> 
```

这是选择信息的地方：

```
<section>
        <div class="piece woodcut">
        <a href="grassone" class="showinfo"><p>GRASSONE</p></a>
        </div>

        <div class="piece woodcut">
        <a href="competitive" class="showinfo"><p>COMPETITIVE</p></a>
        </div>

        <div class="piece woodcut">
        <a href="magpie" class="showinfo"><p>MAGPIE</p></a>
        </div>

</section> 
```

这是效果的脚本：

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>  
    <script type="text/javascript">

    $('a.showinfo').click(function(e){
    e.preventDefault();
            $("html, body").animate({ scrollTop: 100 }, "slow");        
        $(".selected_show").slideToggle();

    var a_href = '.'+ $(this).attr('href');
        $('.product_info').hide();
        $(a_href).show();
    });

    </script> 
```

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T23:20:35.567

使用`slideToggle`'s 回调：

```
$(".selected_show").slideToggle(1000, function(){
    $('.product_info').hide();
}); 
```

# c - 如何在c中为条件写一个数字范围

> ID：11837292
> 
> 赞同：2
> 
> 时间：2012-08-06T23:18:32.310
> 
> 标签：c, range

我刚开始用 C 和一般情况下编程。我在语法上有问题。我知道我想说的逻辑明智，但我只是不知道正确的格式/语法。

谢谢！

我该怎么写：“而整数 n 不等于 10 或 20”

我该怎么写：“而整数 n 介于 10 和 20 之间”

我该怎么写：“而整数 n 介于 10 和 20（含）或 30 和 40（含）之间”

我该怎么写：“虽然整数 n 不在 10 和 20 之间或 30 和 40 之间”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T23:27:41.860

```
while( n != 10 && n != 20 )
while( n >= 10 && n <= 20 )
while( ( n >= 10 && n <= 20 ) || ( n >= 30 && n <= 40 ))
while( ! ( n >= 10 && n <= 20 ) && ! ( n >= 30 && n <= 40 )) 
```

# c++ - C ++指向成员成员的指针？

> ID：11837293
> 
> 赞同：9
> 
> 时间：2012-08-06T23:18:48.690
> 
> 标签：c++, class, pointer-to-member

假设我有两个类：

```
class A
{
    int x;
    int y;
};

class B
{
    int z;
    A ref;
}; 
```

假设我还有一个函数，它接受 B 的指向成员整数的指针，如下所示：

```
void doSomethingToB(B* object, int B::* val)
{
    if(val)
    {
        std::cout << object.*val;
    }
} 
```

有没有办法可以指向`ref`内部 B 的成员？

喜欢，`int B::* ptr = &(B::ref.x)`或者类似的东西？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T23:36:07.420

时不时会被问到这个问题

[是否禁止指向“内部结构”成员？](https://stackoverflow.com/questions/1929887/is-pointer-to-inner-struct-member-forbidden)

基本上，这可以说是 C++ 语言设计中相当明显的初始疏忽，由于该语言向更高层次的方向发展，此后一直被忽略。指向数据成员类型的指针可能被认为太低级而无法给予足够的关注。如果有一天发现此类指针已被弃用而不是进一步开发，我不会感到惊讶。

从链接的答案中重复我的陈述，每个 C++ 编译器中已经存在低级支持（因为无论成员“嵌套”多深，低级机制都是相同的 - 它只是成员的偏移量包含对象），但缺少相应的初始化语法。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-06T23:28:54.573

不会只使用普通`int*`指针吗？为什么它需要是成员指针？

```
void doSomethingToVal(int * val) 
{ 
    if(val) 
    { 
        std::cout << *val; 
    } 
} 

int *ptr = &(B::ref.x);
doSomethingToVal(ptr) ; 
```

# ruby-on-rails - ActiveAdmin 和自我关系模型

> ID：11837311
> 
> 赞同：0
> 
> 时间：2012-08-06T23:21:17.910
> 
> 标签：ruby-on-rails, activeadmin

我是 ROR 的新手。安装 ActiveAdmin 并使用它注册部门模型

部门数据库表如下：

```
id parent_id name 
```

部门型号：

```
class Departments < ActiveRecord::Base
  attr_accessible :name, :parent_id

  belongs_to :parent, :class_name => 'Departments'

  validates :name, :presence => true
end 
```

并在活动管理员中：

```
ActiveAdmin.register Departments do
  menu :parent => 'Manage'
  index do 
    column :parent_id
    column :name
    default_actions
  end

  form do |f|
    f.inputs "Departments" do
      f.input :parent_id
      f.input :name
    end
    f.buttons
  end
end 
```

在索引页面上，它在父列下显示 id 号我有两个问题

1.  我如何显示父名称而不是显示父 ID

2.  添加新部门时，如何显示包含所有部门名称而不是文本字段的父字段的下拉列表。

当我单击视图链接时，它会正确显示父名称而不是父 ID

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T04:16:49.193

```
ActiveAdmin.register Departments do
  index do
    column :parent
  end
end 
```

或者，如果这不起作用，您可以更明确

```
ActiveAdmin.register Departments do
  index do
    column :parent do |resource|
      resource.name
    end
  end
end 
```

对于输入菜单

```
form do |f|
  f.inputs "New" do
    f.input :parent, :as = :select, :collection => Department.all, :member_label => lambda { |i| i.name }
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T02:36:35.213

试着把

```
column :parent
input :parent 
```

# ajax - 通过调用返回参数的本地函数来构建 Ajax 数据部分

> ID：11837320
> 
> 赞同：1
> 
> 时间：2012-08-06T23:22:51.170
> 
> 标签：ajax, asp.net-mvc, jquery

我很难弄清楚这个简单的事情。抱歉，我已经尝试了所有这些组合，但我无法让它工作。这是我想要做的

我有一个 javascrip 函数

```
 function getSelectedSearchCriteria() {
               var data = {};
               data.projname = "Test Project";
               return data;
} 
```

我的 Ajax 函数被称为

```
$.ajax({
url:  "/Position/PositionList", 
type: "POST", 
dataType: "json",
data:getSelectedSearchCriteria

} 
```

我的控制器方法定义为

```
 public ViewResult PositionList(string projname)
{
..
} 
```

但是 projname 参数始终为空。任何帮助表示赞赏

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T00:45:50.173

你确定你的javascript函数被调用了吗？您提供的示例代码在 getSelectedSearchCriteria 之后缺少 ()

```
data:getSelectedSearchCriteria 
```

到

```
data:getSelectedSearchCriteria() 
```

# oauth-2.0 - OAuth 2 是否使用随机数？

> ID：11837323
> 
> 赞同：6
> 
> 时间：2012-08-06T23:23:16.453
> 
> 标签：oauth-2.0

我在 2.0 规范中的任何地方都没有看到它，OAuth 2 没有使用 nonce，如果没有，现在它可以防止重放攻击吗？

[1.0 规范](https://www.rfc-editor.org/rfc/rfc5849#section-3.3)指出：

> 3.3\. 随机数和时间戳
> 
> 时间戳值必须是正整数。除非服务器文档另有规定，否则时间戳以自 1970 年 1 月 1 日 00:00:00 GMT 以来的秒数表示。
> 
> nonce 是一个随机字符串，由客户端唯一生成，以允许服务器验证以前从未发出过请求，并有助于防止通过非安全通道发出请求时的重放攻击。在具有相同时间戳、客户端凭据和令牌组合的所有请求中，nonce 值必须是唯一的。
> 
> 为了避免需要为将来的检查保留无限数量的 nonce 值，服务器可以选择限制使用旧时间戳的请求被拒绝的时间段。请注意，此限制意味着客户端和服务器时钟之间的同步级别。应用这种限制的服务器可以为客户端提供一种与服务器时钟同步的方法；或者，两个系统都可以与受信任的时间服务同步。时钟同步策略的细节超出了本规范的范围。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-07T01:13:45.680

这是在单独的规范中捕获的。有关详细信息/答案，请参阅[OAuth 2.0 威胁模型和安全注意事项](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-threatmodel-06):)

# javascript - Dom 网格，固定内部的流体等

> ID：11837325
> 
> 赞同：0
> 
> 时间：2012-08-06T23:23:25.280
> 
> 标签：javascript, html, css, grid, less

我已经为此苦苦挣扎了很长时间，最后求助于 jQuery hacks。我真的很想知道是否有办法用 CSS 或 LESS（使用 javascript mixins）来实现它。

它本质上是一个包含各种固定和流动元素的页面。

[http://cl.ly/IagL](http://cl.ly/IagL)

关于最佳实践的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T00:08:21.807

是的，如果您希望左右列的高度与中间列的高度相等，我看到了一个问题。如果您将高度设置为固定高度，则可以做到，否则您需要使用jquery。

但是如果你想实现流畅的宽度，我建议你使用 twitter bootstrap。他们的框架也支持使用 LESS [http://twitter.github.com/bootstrap/](http://twitter.github.com/bootstrap/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T00:14:22.927

中间高度在技术上使用 CSS 是不可能的，并且是一个已知问题。[http://www.dtelepathy.com/blog/telepathy/sometimes-css-cant-do-it-all](http://www.dtelepathy.com/blog/telepathy/sometimes-css-cant-do-it-all)

我想我将不得不求助于 jQuery

# java - 组合正则表达式解析

> ID：11837327
> 
> 赞同：0
> 
> 时间：2012-08-06T23:23:49.277
> 
> 标签：java, regex, pattern-matching

我想捕捉一些 HTML 标记的值。可能看起来像这样：

```
value='3242312-3245-3245,234:3245:324,asdf asdf,asdf asd'> 
```

或像这样：

```
value=358 > 
```

也许这个：

```
value=83 selected='selected'> 
```

我试过：

```
Pattern.compile("value=[[\'(.+)\'][(0-9)\\s]]") 
```

但没有成功...

知道我应该使用什么模式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T04:10:57.320

这个表达式应该有效：

```
(?<field>\w+)=(('(?<value>[^']*)')|(?<value>\S+)) 
```

您可以[在此处](http://regexpal.com/)使用相同的表达式进行测试，但不包含组名（因为该工具不支持它们）：

```
(\w+)=(('([^']*)')|(\S+)) 
```

# c# - 视频逐帧搜索引擎

> ID：11837328
> 
> 赞同：0
> 
> 时间：2012-08-06T23:23:51.917
> 
> 标签：c#, project

所以事情就是这样......我的最后一年项目即将到来，我有这个视频搜索引擎的想法......

它会做以下这些事情......获取用户查询或他/她想要搜索的任何内容，然后逐帧搜索视频......我知道这可能需要很多时间......

实际上，算法将运行的预处理阶段将分为两个步骤，它将像 youtube 一样在视频上添加标签.. 只是这次标签将由我不知道的算法完成..

我只需要一个初步的推动开始......

有没有任何算法可以给出我想要的结果..？

PS：这仅适用于视频讲座..如果有任何其他想法请告诉..！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T00:35:47.203

您需要首先将问题分解为它的组成部分，因为没有一个解决方案或算法可以做您想做的事情（否则您的高级项目已经为您完成了）。

据我所知，我可以看到的部分。

1.  获取视频流
2.  将视频流拆分成相关的块进行详细处理。（在短时间内寻找超过 30% 的变化（就像一块被擦掉的黑板））
3.  详细处理块，或者将其传递到下一步，或者将块分成两个较小的块。（也许在较长的时间跨度内寻找较小的变化）
4.  OCR 文本。
5.  检测前一个块是否具有相同的文本，如果是，则将当前块丢弃（您在第 3 步或第 4 步中拆分得太细了）。
6.  将 OCR 数据与文本的时间索引一起存储在某种数据库中。
7.  构建一个程序来查询该数据库以供学生使用。

这些步骤中的每一个都有子步骤，您可以使用相同的分而治之的技术来弄清楚如何执行该步骤。

如果您在执行这些单一步骤之一时需要任何帮助，请在新问题中告诉我们（请每个问题一个主题）。

# javascript - Uploadify 无法加载 SWF 文件 (404)

> ID：11837329
> 
> 赞同：0
> 
> 时间：2012-08-06T23:24:01.640
> 
> 标签：javascript, jquery, uploadify

我的第一个 Uploadify 示例遇到了一个奇怪的问题。问题是试图从 加载 SWF 文件`http://localhost:8080/myapp/uploadify/uploadify.swf`，但该文件位于`http://localhost:8080/myapp/resources/uploadify/uploadify.swf`.

出于这个原因，在 Firebug 和 Chrome 开发工具中，我得到了这个文件的 404。

这是代码：

```
<link type="text/css" rel="stylesheet"
    href="<c:url value="/resources/css/myapp.css"/>" />
<link type="text/css" rel="stylesheet"
    href="<c:url value="/resources/uploadify/uploadify.css"/>" />
<link type="text/css" rel="stylesheet"
    href="<c:url value="/resources/jquery-ui/jquery-ui-1.8.18.custom.css"/>" />
<script type="text/javascript"
    src=<c:url value="/resources/uploadify/jquery-1.4.2.min.js" />></script>
<script type="text/javascript"
    src=<c:url value="/resources/uploadify/jquery-ui-1.8.22.custom.min.js" />></script>
<script type="text/javascript"
    src=<c:url value="/resources/uploadify/swfobject.js" />></script>
<script type="text/javascript"
    src=<c:url value="/resources/uploadify/jquery.uploadify.v2.1.4.min.js"/>></script>

<!-- Scripts to display the dialog and to initialize and control the 
   uploadify component behavior.
-->
<script type="text/javascript">

    function submitUpload() {
        try {
            fileSelectorElement.uploadify('upload');
        } catch (e) {
            alert("Failed to start document upload." + e);
        }
    }

    function showUploadDialog() {
        try {
            $('#uploadDialog').dialog({
                modal: true,
                buttons: {
                    "Cancel": function() {
                        $(this).dialog("close");
                    },
                    "Upload": function() {
                        submitUpload();
                    }
                },
                minWidth: 450,
                closeOnEscape: false,
                title: "Upload a document"
            });
        } catch (e) {
            alert("Could not create upload dialog. " + e);
        }
    }

    $(document).ready(function() {

        try {
            $("#inputFile").uploadify({
                'swf': '<c:url value="/resources/uploadify/uploadify.swf" />',
                'script' : '<c:url value="/upload"/>',
                'scriptData' : {'dealId': dealId, 'agendaId': agendaId},
                'buttonImage': '<c:url value="/resources/uploadify/upload-file.png" />',
                'cancelImg' : '<c:url value="/resources/uploadify/cancel.png" />',
                'folder' : '/uploads',
                'height': 31,
                'width': 300,
                'multi': false,
                'method' : 'post',
                'auto' : true,
                'onUploadError': function(a, b, c, errorObj) {
                    alert("Not working: " + errorObj);
                },
                'onComplete'  : function(event, ID, fileObj, response, data) {
                    if(response == 'success')
                        alert("Successfully uploaded!");
                    else
                        alert("Failed");
                }
            });

        } catch (e) {
            alert("Cannot initialize uploadify element " + e);
        }

        showUploadDialog();

    });
</script>

<div id="uploadDialog" style="display: none">

    <p>Upload a document here:</p>
    <input type="file" id="inputFile" name="inputFile"/>

    <form:form modelAttribute="uploadbean" method="post"
        enctype="multipart/form-data">
    </form:form>
</div>

<div id="uploadPitchSuccess" style="display: none;">
    <p class="success">File uploaded successfully.</p>
</div>

<div id="uploadPitchError" style="display: none;">
    <p class="success">The file could not be uploaded.</p>
</div> 
```

我尝试为“swf”参数使用相对路径和绝对路径。以及动态（如上）和硬编码路径。无论我设置什么值，路径都不会改变。

我也尝试将 swf 放入，`http://localhost:8080/myapp/uploadify/uploadify.swf`但它仍然会抛出 404。

我想我必须在这里遗漏一些非常明显的东西；但我不能简单地看到它是什么。

谢谢你的帮助

# python - 重命名 buildbot 中的构建

> ID：11837330
> 
> 赞同：22
> 
> 时间：2012-08-06T23:24:08.767
> 
> 标签：python, buildbot

有没有办法在不丢失所有日志的情况下重命名 buildbot 中的构建？

例如，我有几个可能构建的 Windows 从属服务器：“Windows 2008+ DEBUG”，但我想将此构建重命名为：“Windows 2008R2+ DEBUG”。

我该如何设置`compare_attr`（如果这甚至是我需要做的），以便所有日志/等...都包含在新版本中的先前版本中。

我可以手动重命名目录并期望一切正常吗？实验告诉我这行不通，但也许我可以写一个命令来改变某些事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T19:18:42.750

如果您不关心目录的名称，只关心构建器的名称，您可以将`builddir`构建器的属性设置为当前的任何内容，然后根据需要命名您的构建器。

存储在 builder 目录中的数据在 pickles 中。查看代码，我认为唯一可能导致问题的数据是构建器名称。如果您确实关心非构建事件，您可能只需`builder`从每个目录中删除该文件。否则，用更新构建器名称重写泡菜应该可以工作。

# javascript - 使用 SammyJS 和 requireJS 来路由模块

> ID：11837342
> 
> 赞同：4
> 
> 时间：2012-08-06T23:25:47.303
> 
> 标签：javascript, requirejs, sammy.js

我只是想知道是否有人使用 requireJS 设置 SammyJS 以根据提供的哈希地址路由模块的创建？

可能吗？建议？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T04:53:03.983

在[BoilerplateJS 中](http://boilerplatejs.org/)，我们使用 crossroads.js 来实现根据提供的哈希地址创建模块。这是我们用来实现它的[路由器。](https://github.com/ectechno/boilerplatejs/blob/master/src/core/helpers/router.js)

我相信 sammyJS 可以以类似的方式使用。

# ruby-on-rails - delay_job 没有错误就死掉了——让作业处于锁定状态

> ID：11837344
> 
> 赞同：4
> 
> 时间：2012-08-06T23:26:10.420
> 
> 标签：ruby-on-rails, mongoid, delayed-job

DJ 死后，日志文件什么也没有显示。

跑步：`./script/delayed_job status`

给出：`pid-file for killed process 1143 found (/appPath/tmp/pids/delayed_job.pid), deleting.` `delayed_job: no instances running`

奇怪的是，如果我使用：`./script/delayed_job run`它将在前台完美运行！而且永远不会死。

尝试了许多版本`delayed_job`并`mongoid`具有相同的结果。

有人知道如何调试吗？

使用：

`rails (3.2.7)`

`delayed_job_mongoid (2.0.0)`

`mongoid (3.0.3)`

`delayed_job (3.0.3)`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T16:36:55.917

结果`delayed_job`是正在执行导致分段错误的作业，这将杀死delayed_job 守护程序。

调试后发现`Random.rand()`在守护程序环境中运行时会导致可重现的分段错误。这与随机生成器的初始播种和设置有关，这显然没有被 daemonize 正确处理。

解决方案：`Random.new.rand()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T23:51:53.823

我想知道这个[堆栈溢出 DJ 日志问题](https://stackoverflow.com/questions/2195410/log-doesnt-work-in-production-with-delayed-job?rq=1)中的奇怪行为是否可以解释您的行为。答案看起来也很合理。奇怪的事情发生了。

Pt 2： [权限问题？](https://stackoverflow.com/questions/11279267/why-does-my-delayed-job-fail-without-rvm)也很可能把它搞砸了。这是在生产还是开发中？它在开发中有效吗？

PT 3：来自 DJm 的 github 页面 确保您使用的是 MongoDB 版本 1.3 或更高版本。你是？pt 4：还有这个？`script/rails runner 'Delayed::Backend::Mongoid::Job.create_indexes'`

最后，截至今天，DJM 在 Travis 上运行红灯，有一些可能会影响您的错误。我曾经在宝石中制造过劣质的产品，驱使我喝酒，但 2 天后才修好。[http://travis-ci.org/#!/collectiveidea/delayed_job_mongoid/jobs/1962498](http://travis-ci.org/#!/collectiveidea/delayed_job_mongoid/jobs/1962498)

如果不是这样，请在 Gemfile 中插入 pry，`binding.pry`从顶部开始添加到该脚本并向下工作。

# java - 侦听器拒绝连接并出现以下错误：ORA-12514

> ID：11837345
> 
> 赞同：5
> 
> 时间：2012-08-06T23:26:16.727
> 
> 标签：java, jdbc, oracle11g

我正在尝试使用 java 和 JDBC 代码连接到 Oracle 数据库。我不能这样做，因为我收到以下错误：

> java.sql.SQLException：侦听器拒绝连接并出现以下错误：ORA-12514，TNS：侦听器当前不知道连接描述符中请求的服务

错误的原因是什么以及如何解决？

PS- 在所有 DBMS 中，Oracle express 11g 似乎是最复杂和最难使用的。真的是这样吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T23:31:03.957

> 侦听器当前不知道连接描述符中请求的服务

自我解释。您正在请求连接到数据库侦听器不知道的数据库中的服务或实例，因此它说“我不知道”。

检查您安装 Oracle 11g express 的方式。请记住，那里的服务名称通常是“xe”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-18T09:35:51.907

我通过增加虚拟机的 RAM 大小来解决此问题，因为我在需要更多内存的 VM 中安装了 oracle。所以这可能是你的问题的原因之一。

# opengl - OpenGL - 设置内置统一变量

> ID：11837346
> 
> 赞同：1
> 
> 时间：2012-08-06T23:26:20.650
> 
> 标签：opengl, glsl

我一直在阅读一堆教程，当我遇到一个关于 OpenGL 中雾的教程时，它提到了内置变量 gl_FogParameters。这是在应用程序中设置然后通过着色器访问的东西吗？

换句话说，您是否以相同的方式设置各种雾变量：

```
glFogi(GL_FOG_MODE, GL_LINEAR);
glFogf(GL_FOG_START, 10.f);
glFogf(GL_FOG_END, 40.f); 
```

或者它实际上是你发送给着色器的制服？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T00:00:24.700

`gl_`所有以跟踪 OpenGL 固定功能状态的特定部分开头的制服。它们从 GL 的固定功能状态中获得价值。该规范准确地说明了哪些状态映射到了哪些变量。

# php - 在 php 中自动查找所有 xml 标记名

> ID：11837349
> 
> 赞同：0
> 
> 时间：2012-08-06T23:26:58.573
> 
> 标签：php, xml, dom, getelementsbytagname

我希望我的问题不是太愚蠢:)

我想要做的是自动列出给定 xml 文档中所有不同的标记名和属性；例如从第一项。这样我就可以选择要解析的那些。

例如，对于这个 xml：

```
<productItem id="123456">
    <name>laptop</name>
    <trackingLinks>
        <trackingLink>
            <ppc>http://xxxxxxxxx</ppc>
        </trackingLink>
    </trackingLinks>
    <description>laptop computer</description>
</productItem> 
```

我应该得到所有标记名/属性的列表，例如：

productItem>id

姓名

trackingLinks>trackingLink>ppc

描述

有任何想法吗？

谢谢

# url - 按内容类型自定义 Drupal URL

> ID：11837350
> 
> 赞同：1
> 
> 时间：2012-08-06T23:27:13.793
> 
> 标签：url, drupal, drupal-7

我已经设置了一个内容类型——汽车。有没有办法在 id 之前自动添加前缀 /cars/ ？例如 domain.com/cars/2。我可能还有更多需要执行此操作的内容类型。然而，标准页面不需要前缀。

如何根据内容类型更改 URL 格式？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-06T23:29:30.980

[Pathauto](http://drupal.org/project/pathauto)模块正是为此而构建的：

> Pathauto 模块自动为各种内容（节点、分类术语、用户）生成 URL/路径别名，而无需用户手动指定路径别名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T00:43:20.600

使用带有令牌 [content-type]/[node] 的 pathauto 模块

# php - 如果为空 php mysql，则在重复条目上添加名称

> ID：11837354
> 
> 赞同：5
> 
> 时间：2012-08-06T23:27:39.227
> 
> 标签：php, mysql, insert-into

澄清我要完成的工作： **如果有记录具有相同的电子邮件但没有名称，则更新“用户名”。如果用户已有名称，则不要进行任何更改**

我有一个网站，所有用户都可以是“订阅者、企业家或投资者”。如果订阅者（我之前只要求提供电子邮件）选择上传商业创意，那么该人可能会使用与以前相同的电子邮件地址，只是这次添加了一个名称。所以我想插入，如果电子邮件已经存在 - 添加名称，但前提是那里已经没有名称（这样一个人不能简单地覆盖别人的详细信息）。

我已经做到了这一点：

```
 mysql_query("
     INSERT INTO users
         (email, name)
     VALUES
         ('" .$epost. "',  '" .$namn. "')
    ON DUPLICATE KEY UPDATE
    name=VALUES(name)   -->[if name == '', else do nothing...]
 "); 
```

现在，如果不同，它会用新名称替换当前名称。

我搜索“如果字段为空，则重复更新”并找到： [http ://forums.aspfree.com/sql-development-6/on-duplicate-key-update-but-only-if-value-isn-t-482012 .html](http://forums.aspfree.com/sql-development-6/on-duplicate-key-update-but-only-if-value-isn-t-482012.html)（合并？）

[以重复键更新为条件](https://stackoverflow.com/questions/1044874/conditional-on-duplicate-key-update)（更接近，但如果它不同，我不想更新它，只有当该字段为空时。）

[http://bytes.com/topic/php/answers/914328-duplicate-key-update-only-null-values](http://bytes.com/topic/php/answers/914328-duplicate-key-update-only-null-values)（如果输入为空白......好吧不是）

[http://boardreader.com/thread/Insert_on_duplicate_key_update_only_if_c_can8Xachr.html](http://boardreader.com/thread/Insert_on_duplicate_key_update_only_if_c_can8Xachr.html)（这个页面的布局让我迷失了）

[http://www.digimantra.com/tutorials/insert-update-single-mysql-query-duplicate-key/](http://www.digimantra.com/tutorials/insert-update-single-mysql-query-duplicate-key/)（它只是更新）

我相信**这可能是**我**所追求**的（？）[http://thewebfellas.com/blog/2010/1/18/conditional-duplicate-key-updates-with-mysql](http://thewebfellas.com/blog/2010/1/18/conditional-duplicate-key-updates-with-mysql)但我还没有成功这行得通

这段代码：

```
 mysql_query("UPDATE users SET name='".$namn."'
WHERE email='".$epost."' AND name =''"); 
```

仅当名称以前为空时才更新名称，这就是我所追求的，*但是*如果电子邮件尚不存在，则它不会插入新记录。

我的桌子 ![桌子](../Images/fdf2d9b86dd013b3b33c9602172d40f1.png)

所以我尝试了这个：

```
 mysql_query("
     INSERT INTO users
     SELECT email, 'victoria' FROM users 
     WHERE email='victoria@hejsan.se' ON DUPLICATE KEY UPDATE name = 'victoria'
 "); 
```

我试过这个：

```
 mysql_query("
    INSERT INTO users
    SELECT email, 'yay' from users
    WHERE email='victoria@hejsan.se'
    ON DUPLICATE KEY
    UPDATE name = values(name)
 "); 
```

来自@Fluffeh 的回答

但什么也没发生。我误解了答案吗？

我突然想到，如果有人已经有一个帐户，那么他们也应该有一个密码，所以我会要求他们验证他们的密码，并确保我在他们插入电子邮件时进行 AJAX 调用以查看如果电子邮件已经注册:) 那么这不再是一个问题，我认为这是我将采用的解决方案。！）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:36:20.520

`insert .... on duplicate key...`您可以使用语法来解决您的问题的唯一方法是 if`name`并`email`制作一个复合键 - 我认为您最好使用 auto_increment 作为主键。

您可能需要在 PHP 中添加一些逻辑来首先进行检查，然后插入或更新 - 或编写一个函数来为您执行相同的测试 - 但两者都不是您可以触发的简单查询。

编辑：不确定这是否是您想要做的，但我认为满足您要求的最佳解决方案是在一对多关系中实际使用两个表。

```
Table-Users
id | email | name

create table users(
    id int(10) not null auto_increment,
    email varchar(100),
    name varchar(100),
    primary key(email, name)
    );

Table-Ideas
id | userID | idea

create table users(
    id int(10) not null auto_increment primary key,
    userID int(10) not null,
    idea text
    ); 
```

使用桌子上的主键，您可以安全地执行操作，`insert... duplicate...`而不必担心覆盖人员。但是，第二个表将允许您将想法安全地存储给用户，并让您拥有每个用户的多个想法。由于关系`users.id`对`ideas.userID`您而言，即使他们的详细信息已更新，您也不会失去拥有它的人。

编辑：（又名，ZOMG *facepalm*）

```
$query="
    update users 
        set name='".$userName."' 
    where 
        email='".$userEmail."' 
        and name is null"; 
```

编辑2：（又名，*擦额头*）

```
insert into users 
    select email, '".$namn."' from users where email='".$epost."' 
    on duplicate key 
        update name = values (name); 
```

它在这里工作：

```
mysql> create table test1 (myName varchar(10) unique, myEmail varchar(10));
Query OK, 0 rows affected (0.02 sec)

mysql> insert into test1 values ('Tom','something');
Query OK, 1 row affected (0.01 sec)

mysql> insert into test1 values('Nick',null);
Query OK, 1 row affected (0.00 sec)

mysql> select * from test1;
+--------+-----------+
| myName | myEmail   |
+--------+-----------+
| Tom    | something |
| Nick   | NULL      |
+--------+-----------+
2 rows in set (0.00 sec)

mysql> insert into test1 select myName, myEmail from test1 
where myName='Tom' on duplicate key update myEmail = values (myEmail);
Query OK, 0 rows affected (0.00 sec)
Records: 1  Duplicates: 0  Warnings: 0

mysql> select * from test1;
+--------+-----------+
| myName | myEmail   |
+--------+-----------+
| Tom    | something |
| Nick   | NULL      |
+--------+-----------+
2 rows in set (0.00 sec)

mysql> insert into test1 select 'Tom', myEmail from test1 
where myName='Tom' on duplicate key update myEmail = values (myEmail);
Query OK, 0 rows affected (0.00 sec)
Records: 1  Duplicates: 0  Warnings: 0

mysql> select * from test1;
+--------+-----------+
| myName | myEmail   |
+--------+-----------+
| Tom    | something |
| Nick   | NULL      |
+--------+-----------+
2 rows in set (0.00 sec)

mysql> insert into test1 select myName, 'Something Else' from test1 
where myName='Tom' on duplicate key update myEmail = values (myEmail);
Query OK, 2 rows affected, 1 warning (0.01 sec)
Records: 1  Duplicates: 1  Warnings: 1

mysql> select * from test1;
+--------+------------+
| myName | myEmail    |
+--------+------------+
| Tom    | Something  |
| Nick   | NULL       |
+--------+------------+
2 rows in set (0.00 sec)

mysql> insert into test1 select myName, null from test1 
where myName='Nick' on duplicate key update myEmail = values (myEmail);
Query OK, 0 rows affected (0.00 sec)
Records: 1  Duplicates: 0  Warnings: 0

mysql> select * from test1;
+--------+------------+
| myName | myEmail    |
+--------+------------+
| Tom    | Something  |
| Nick   | NULL       |
+--------+------------+
2 rows in set (0.00 sec)

mysql> insert into test1 select myName, 'yay' from test1 
where myName='Nick' on duplicate key update myEmail = values (myEmail);
Query OK, 2 rows affected (0.01 sec)
Records: 1  Duplicates: 1  Warnings: 0

mysql> select * from test1;
+--------+------------+
| myName | myEmail    |
+--------+------------+
| Tom    | Something  |
| Nick   | yay        |
+--------+------------+
2 rows in set (0.00 sec) 
```

编辑3：试试这个`$query`

```
insert into table1 select coalesce(email,'".$epost."') as email, coalesce(name,'".$namn."') as name from table1 
where email='".$epost."' on duplicate key update name = values (name); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T08:58:52.880

如果你想更新一个已经存在的字段，你可以这样做；

```
-- MySQL 参考
插入表 (a,b,c) 值 (1,2,3),(4,5,6)
  重复键更新 c=VALUES(a)+VALUES(b);

- 所以你的代码
插入用户
         （电子邮件，姓名）
     价值观
         ('" .$epost."', '" .$namn."')

     ON DUPLICATE KEY UPDATE email=VALUES(email), name=VALUES(name)

```

[http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)

**更新**

此时，您需要“MySQL 条件插入”。让我们试试吧；

```
如果不存在“用户”，则创建表（
  `name` varchar(50) NOT NULL,
  `email` varchar(255) NOT NULL,
  唯一键 `email` (`email`)
)

插入用户（姓名，电子邮件）值（'kerem'，'qeremy[atta]gmail[dotta]com'）；
插入用户（姓名、电子邮件） VALUES('test', 'test@example.com');

>> 插入 2 行。（查询耗时 0.0005 秒）

-- 这是你的部分（关于电子邮件字段是唯一的，所以 WHERE email='search email'）

插入用户（姓名、电子邮件）
    SELECT 'test', 'test@example.com' FROM DUAL WHERE NOT EXISTS (
        SELECT * FROM users WHERE email = 'test@example.com' LIMIT 1
    );

>> 已插入 0 行。（查询耗时 0.0003 秒）

```

[https://www.google.com/search?q=conditional+insert+mysql](https://www.google.com/search?q=conditional+insert+mysql)

[http://allurcode.com/2011/04/15/mysql-conditional-insert/](http://allurcode.com/2011/04/15/mysql-conditional-insert/)（这是有用的搜索结果）

**更新 2**

如果这对您不起作用，那么您可以像（只是输入）一样完成您的工作；

```
mysql_query("INSERT IGNORE INTO users (name, email) VALUES('$name', '$email')");
如果（！mysql_insert_id（））{
   mysql_query("UPDATE users SET name='$name' WHERE name='' AND email='$email'");
}

或者;

mysql_query("UPDATE users SET name='$name' WHERE name='' AND email='$email'");
if (mysql_affected_rows() < 1) {
   mysql_query("INSERT INTO users (name, email) VALUES('$name', '$email')");
}

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-06T03:23:20.617

我想建议这个解决方案使用控制函数 IFNULL(exp1,exp2)，定义为“如果 exp1 不为空，则返回 exp1；如果 exp1 为空，则返回 exp2”。

[http://dev.mysql.com/doc/refman/5.7/en/control-flow-functions.html](http://dev.mysql.com/doc/refman/5.7/en/control-flow-functions.html)

```
INSERT INTO users (name, email) VALUES ('$name','$email')
ON DUPLICATE KEY UPDATE name = IFNULL(name, VALUES(name)) 
```

当然，您必须以某种方式超越这一点，但这对我有所帮助。

# java - java swing：调整大小后旋转的JComponent尺寸不正确

> ID：11837368
> 
> 赞同：2
> 
> 时间：2012-08-06T23:29:30.053
> 
> 标签：java, swing, resize, rotation, paintcomponent

有没有办法纠正旋转组件的尺寸？

在我的摇摆应用程序中，我希望能够旋转单个面板，并让它正确响应调整大小事件。旋转是直接的，但在调整大小时，高度和宽度尺寸是相反的。如果从覆盖的 paint() 调用中调用 setSize 以交换尺寸，它几乎可以工作，但这不起作用，因为 setSize 会导致另一个调用 paint 发生，然后递归......我已经还尝试添加一个 ComponentAdapter 来处理调整大小事件的交换，但得到了相同的结果。

因此，这是我正在使用的简化示例。这里的组件是按钮，但逻辑也适用于像 JPanel 这样的 JComponent。按钮 c 使用 JXTransformer 旋转，但这不会调整大小（在代码中已注释掉，但如果您愿意，可以将 JXTransformer 类添加到类路径中）。如果您编译示例，请尝试调整窗口大小并查看旋转按钮的行为。截图：（它说我不能发布截图，但这些链接似乎是实时的..）

[http://i.stack.imgur.com/S3qmb.png](https://i.stack.imgur.com/S3qmb.png)

如果我添加了比例转换，则调整大小是正确的，但组件的变形超出了可用性。截屏：

[http://i.stack.imgur.com/K4l9e.png](https://i.stack.imgur.com/K4l9e.png)

我在这里看到了很多讨论旋转部分的问题，但没有关于调整大小的问题。例如，[Java GUI 中的旋转方形面板](https://stackoverflow.com/questions/6333464/a-rotated-square-panel-in-java-gui)

谢谢！

代码：

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.geom.AffineTransform;

import javax.swing.BorderFactory;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class RotatingTest {

    public static void main(String[] args) {

        JFrame frame = new JFrame();
        JPanel panel = new JPanel(new BorderLayout());

        // The button rotates, but the height/width dimensions are incorrect
        RotatedButton a = new RotatedButton("ROTATED CONTENTS!");

        JButton b = new JButton("Normal Contents");

        JButton c = new JButton("Transformer Contents");
//      JXTransformer t = new JXTransformer(c);
//      t.rotate(Math.toRadians(90));

        panel.add(a, BorderLayout.CENTER);
        panel.add(b, BorderLayout.WEST);
//      panel.add(t, BorderLayout.EAST);

        panel.setBorder(BorderFactory.createEmptyBorder(30, 30, 30, 30));

        frame.add(panel);
        frame.pack();
        frame.setVisible(true);

    }
}
class RotatedButton extends JButton{

    private static final long serialVersionUID = -3355833063753337573L;

    RotatedButton(String string){
        super(string);
    }

    @Override
    protected void paintComponent(Graphics g) {

        int width = getWidth();
        int height = getHeight();

        Graphics2D graphics = (Graphics2D) g;
        AffineTransform txOrig = graphics.getTransform();
        AffineTransform transformer = new AffineTransform(txOrig);

        transformer.translate(width/2, height/2);
        transformer.rotate(Math.toRadians(90));
        transformer.translate(-height/2, -width/2);

        // this scaling fits the button to the window, but distorts the contents
//      double coef1 = (double)width / (double)height;
//      double coef2 = (double)height / (double)width;
//      transformer.scale(coef2, coef1);

        // this line sets the rotation, comment out to disable
        graphics.setTransform(transformer);

        super.paintComponent(graphics);
        graphics.setTransform(txOrig);
        graphics.dispose();

        System.out.println("Parent size: "+getRootPane().getParent().getSize());
        System.out.println("this size: "+getSize());

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-09T18:12:35.213

所以，这里的问题是`JComponents`在设置它们的大小时不要关心它们实际上是什么。当您修改其中的某些内容时，`paintComponent()`它只会影响组件的表面部分，而不会影响组件实际返回的任何内容。你想要做的是改造你的`paintComponent()`方法，或者改变你调整组件大小的方式。

想象一下，当您将图像放在太大的按钮上时。该按钮将简单地显示它可以显示的内容，其余的就按钮而言无关紧要。在 a 上旋转图形`JComponent`是完全相同的方式。您可以提前创建图形，并将您的尺寸设置为该尺寸（这是复杂的方式），或者如果您只旋转 90 度，只需更改您放入 int 的内容`setSize()`。我一直发现第二个非常简单，因为您可以不断更改它的大小而无需额外的代码，您只需要记住切换所有尺寸。

但是，如果您希望将其放置在一个不是 90 度的倍数的角度，则必须为组件放置一个更大的正方形。（使用毕达哥拉斯理论）这可能看起来很愚蠢，但请考虑一下从左上角如何制作所有坐标。该角定义了该对象的位置，但如果它不在绝对位置（最左边的最高点），那么使用该组件的任何操作都必须手动查看组件的每个部分，而不仅仅是计算它。

希望这会有所帮助，尽管可能已经晚了。

# date - 水晶报表日期公式，使其成为月末

> ID：11837372
> 
> 赞同：2
> 
> 时间：2012-08-06T23:30:21.300
> 
> 标签：date, crystal-reports, formula

我是 CR 的新手，需要一个公式，可以在日期字段上为我提供月末 a。如果日期是 628/2012 或 7/12/2012，无论该字段显示月份中的哪一天，我都需要将公式作为月末。当然，我们知道并非每个月都在 30 日或 31 日结束，2 月有时会在 29 日或 30 日结束。那么我可以使用什么公式来做到这一点

示例字段名称 {table.end_date}

任何帮助是极大的赞赏。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T00:16:58.370

创建一个公式字段来计算月末：

```
//{@EndOfMonth}
// find the first day of the month, add a month to it, then subtract a day
DateAdd("m", 1, DateTime( Year({table.dateField}), Month({table.dateField}), 1, 0,0,0 )) - 1 
```

创建将生成文本表示的第二个公式：

```
//{@TextRepresentation}
If Isnull({table.end_date}) Then
  Space(8)
Else
  ToText({@EndOfMonth}, "YYYYMMDD") 
```

# heroku - 在 RVM (OSX) 上更新 Heroku gem，导致 LoadError 和“损坏”的 heroku gem。什么是最安全的修复方法？

> ID：11837379
> 
> 赞同：0
> 
> 时间：2012-08-06T23:31:16.943
> 
> 标签：heroku, gem, rvm

我使用 RVM（v1.14.11 和 JewelryBox GUI）和 OSX 10.6.8 已经一年多了，没有任何问题。我安装了两个红宝石（1.9.2 和 1.9.3），以及每个红宝石的各种宝石组。

由于我刚刚完成将当前数据库迁移到他们的新产品，我想我也可以更新 heroku gem（2.14）。所以我通过 rvm 选择了我的 ruby​​-1.9.2-p290@rails gemset，打开终端，然后运行“heroku udpate”。

在更新过程中我没有发现任何错误，但我尝试运行“heroku 版本”以及各种其他“heroku”命令，现在收到以下错误：

```
/Users/me/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require': no such file to load -- netrc (LoadError)
        from /Users/me/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
        from /Users/me/.heroku/client/lib/heroku/auth.rb:6:in `<top (required)>'
        from /Users/me/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
        from /Users/me/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
        from /Users/me/.heroku/client/lib/heroku/client.rb:4:in `<top (required)>'
        from /Users/me/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
        from /Users/me/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
        from /Users/me/.rvm/gems/ruby-1.9.2-p290@rails/gems/heroku-2.14.0/lib/heroku.rb:6:in `<top (required)>'
        from /Users/me/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
        from /Users/me/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
        from /Users/me/.rvm/gems/ruby-1.9.2-p290@rails/gems/heroku-2.14.0/bin/heroku:6:in `<top (required)>'
        from /Users/me/.rvm/gems/ruby-1.9.2-p290@rails/bin/heroku:19:in `load'
        from /Users/me/.rvm/gems/ruby-1.9.2-p290@rails/bin/heroku:19:in `<main>' 
```

我注意到上面有一些对“1.9.1”的引用，这是我用 rvm 安装的原始 gemset，然后将其更新为“1.9.2”。也许这就是原因？

运行“宝石环境”给出：

```
RubyGems Environment:
  - RUBYGEMS VERSION: 1.8.10
  - RUBY VERSION: 1.9.2 (2011-07-09 patchlevel 290) [x86_64-darwin10.8.0]
  - INSTALLATION DIRECTORY: /Users/me/.rvm/gems/ruby-1.9.2-p290@rails
  - RUBY EXECUTABLE: /Users/me/.rvm/rubies/ruby-1.9.2-p290/bin/ruby
  - EXECUTABLE DIRECTORY: /Users/me/.rvm/gems/ruby-1.9.2-p290@rails/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - x86_64-darwin-10
  - GEM PATHS:
     - /Users/me/.rvm/gems/ruby-1.9.2-p290@rails
     - /Users/me/.rvm/gems/ruby-1.9.2-p290@global
  - GEM CONFIGURATION:
     - :update_sources => true
     - :verbose => true
     - :benchmark => false
     - :backtrace => false
     - :bulk_threshold => 1000
  - REMOTE SOURCES:
     - http://rubygems.org/ 
```

我确实有另一个gemset（ruby-1.9.3-p194@rails32），它也包含“heroku”gem，当我使用rvm切换到它时，使用它的“heroku”gem没有问题。

由于 rvm/osx 安装有时可能是“喜怒无常的”，或者至少在过去是这样，我真的可以就出了什么问题提出一些建议，以及如何**安全地**修复损坏的 gemset。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T23:49:32.873

Gem`netrc`是 的依赖项`heroku`，`gem install heroku`再次运行以安装所有依赖项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T00:15:31.097

如果上述解决方案不起作用，请删除 heroku 客户端，我已经解决了同样的问题：

```
rm -rf ~/.heroku/client 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-10T20:28:04.820

某些早期版本的更新程序存在错误。我建议从[https://toolbelt.heroku.com](https://toolbelt.heroku.com)重新下载并重新安装。完成此操作后，您应该拥有最新版本，并且随着新版本的继续发布，更新应该可以按预期工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-14T18:45:53.973

`gem install heroku`如果您在特定项目的 Gemfile 中有 heroku gem，可能还不够。我遇到了这个问题，不得不做一个`bundle update heroku`. 这仅取决于您的项目正在使用什么，本地 gemset 或全局 gemset。当然，您要确保您的 Gemfile 没有将 heroku gem 锁定在特定版本，否则运行更新将无济于事。

# node.js - nodejs通知系统

> ID：11837381
> 
> 赞同：1
> 
> 时间：2012-08-06T23:31:31.523
> 
> 标签：node.js, mongodb

我正在为我的网站做一个**通知系统**。类似的通知系统`facebook`。或`stackoverflow`。我有**2个**问题。

1.  如何存储在数据库中？我可以将所有通知存储在用户文档中吗？或者在一个单独的文档中（因为我认为monogdb在文档中的大小是有限的？）或者，智能存储？（使用 inc 或 db 中的值（参见：true/false），查询复杂）

2.  页面上的 for 怎么办？例如，当我单击我`inbox`的 for中的链接时`stackoverflow`，我将重定向到该页面。但是我，我有一个系统，`multipage`例如**：**我有 100 个朋友。每页列出 30 个。因此，当我单击通知时，我无法重定向到，因为不可能知道好的页面（可以删除用户）。

非常感谢你 ！如果您有其他想法，请告诉我。谢谢。

**编辑：**

（对不起我的英语，我是法国人）

对于第一个问题，我意识到我必须等待时机来选择我的结构。因为我的通知..有点复杂，所以提前感受下。

第二，我解决了这个问题。我解释一下：（我以朋友为例，因为它很容易理解。）我这样存储我的数据：

```
{
  friends: [
    {_id: xxxxx, ts: xxxx},
    {_id: xxxxx, ts: xxxx}
  ]
} 
```

想象一下，我显示所有朋友：每页 30 个。问题是：

*   当我想显示所有朋友时，我无法使用 mongo 进行排序。（一个小问题）
*   如果我想在一个特别的朋友处将用户引导到此列表（每页 30 个），请始终保留`sort`by `ts`。我不知道页面。唯一的解决方案是获取所有文档。但是：性能非常差。

所以，我这样存储：

```
{
  friends: {
    xxxx: {ts:xxx},
    xxxx: {ts:xxx}
  }
} 
```

知道我可以使用跳过和限制对文档进行排序。所以如果我想要一份，我不需要拿走所有的文件。

要知道页面，我只需对 ts 进行 < 或 > 的数量，例如，我有 11 个朋友 > 到我想要的朋友的 ts，并对所有朋友进行计数（例如：50 个朋友）用 50 和 11，我可以猜到页面。

这个解决方案好吗？- 我需要一个计数 - 一个查询以了解 > 或 < 的数量，我可以获取列出朋友的页面，保持`the sort ts`

你无法理解我为什么使用计数。我需要，因为它们没有存储在同一个文档中。

**2 编辑：**

`query object`这个解决方案的问题是我需要`update object`在`mongo query`（例如：for do`friends.xxxxxx: {$exists:true}`

ps：用什么优势`ts`代替`date`mongodb ？我正在使用`ts`，但我想我会存储`date`，没有`ts`。

**3 编辑**

我会喜欢的`Sammaye`。存放在单独的文件中。看看： http: [//mongly.com/Multiple-Collections-Versus-Embedded-Documents/#1](http://mongly.com/Multiple-Collections-Versus-Embedded-Documents/#1)和[http://openmymind.net/2012/1/30/MongoDB-Embedded-Documents-vs-Multiple-收藏/](http://openmymind.net/2012/1/30/MongoDB-Embedded-Documents-vs-Multiple-Collections/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T13:33:44.060

@Stennie 给出了一个非常完整的答案。

但是最近我在 PHP 中为我的网站做了类似的事情。首先要了解的是您是在做通知系统还是墙（两者非常不同），我似乎不清楚，我不确定您的意思是：

> 页面上的 for 怎么办？例如，当我在收件箱中单击 stackoverflow 的链接时，我将重定向到该页面。但是我，例如，我有一个多页面系统：我有 100 个朋友。每页列出 30 个。因此，当我单击通知时，我无法重定向到，因为不可能知道好的页面（可以删除用户）。

那不是很好的英语，当我阅读时非常混乱。如果您可以对此进行扩展，我相信人们可以更好地回答。

对于通知系统，我发现大量通知对象也可以工作。所以我有一个像这样的模式：

```
{
    _id: {},
    to_user: ObjectId{},
    user_id: ObjectId{}, // Originating user
    custom_text: "has posted a new comment on your wall post",
    read: false,
    ts: MongoDate()
} 
```

这实际上就是我必须生成通知的文件。每次用户提交生成通知的操作时，它都会向数据库写入一个新行，`to_user`每次都需要通知每个用户。至于执行相同操作的多个用户，我实际上将`user_id`字段转换为`OjbectId`'s 列表，所以我可以说：

`Sam, Dan and Mike all commented on your wall post`

然后，我通过`ts`存储`ts`用户在他们的行中查看的最后一次进行查询，从而允许我每次对最新通知进行基于范围的查询。根据我的个人经验，这对于分片和查询非常有效。

希望能帮助到你，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T02:20:20.817

是[嵌入还是链接](http://www.mongodb.org/display/DOCS/Schema+Design#SchemaDesign-EmbeddingandLinking)是MongoDB中数据建模的一个常见问题。如果您的通知数量将不受限制，您可能会更好地将它们保存在单独的集合中。

当前的 16Mb 文档限制实际上并不像其他一些考虑那么严重：

*   通过将所有通知包含在单个文档中可能会遇到的性能问题是快速增长的文档可能还需要更频繁地在数据库中重新定位（请参阅[填充因子](http://www.mongodb.org/display/DOCS/Padding+Factor#PaddingFactor-Overview)）。

*   您可能希望在很短的时间内对文档应用多个更新（例如在通知上设置“读取”标志），这意味着更新同一文档时会出现更多争用（请参阅[原子操作](http://www.mongodb.org/display/DOCS/Atomic+Operations)）。

为了实现分页，您可以将[limit()](http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%7B%7Blimit%28%29%7D%7D)与范围查询或[skip()](http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%7B%7Bskip%28%29%7D%7D)结合使用。范围查询（例如，基于 indexed `notificationDate`）将更有效地使用索引，并且比`skip()`您的集合增长时执行得更好。

# android - Android手机之间的位置交换

> ID：11837383
> 
> 赞同：0
> 
> 时间：2012-08-06T23:31:57.433
> 
> 标签：android, service, synchronization, gps, push

我正在寻求更多关于下一步去哪里的建议，而不是如何去做。

我正在开发一个增强现实 Android 游戏作为学生项目，但我偶然发现了一个问题。四部手机必须知道彼此的位置，并在地图上显示时间步长（为了游戏，它不应该是真正的实时）。除此之外，当其中一部手机/玩家到达某个位置或做某事时，应该通知玩家。

我想用 PHP 服务来做这件事，每部手机会在几秒钟内检查其余手机的位置（全部由 JSON），发送它的位置，就是这样。挺简单的，但是我怕随着游戏的进行会出现很多不同步和不一致的数据。由于电话不会在每个人都登录的同一秒开始。另外，我不确定如何以这种方式进行事件（例如，其中一名玩家可以隐身并且他的位置不应该在接下来 x 秒），或到达某个位置，或地图上仍有哪些物品（玩家可以“拾取”物品）。有人会比其他人更早知道。

这确实需要一个类似推送的解决方案，但我对 C2DM 并不是很熟悉，在我看来，使用它是开发中的真正开销，我需要一个 C#/Java 或类似的服务器，因为 PHP 确实可以' t 推送到云端（或者可以吗？）。我知道 C# 和 Java，但需要更多时间，因为我需要解决线程等问题。C2DM 甚至可以用于此目的吗？

基本上，我正在寻求更有经验的开发人员的想法，这里同步的最佳解决方案是什么？有什么办法可以解决 PHP 的问题并定期检查服务器，还是我应该继续使用云服务和更复杂的服务器？

抱歉，解释太长了:)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:56:33.680

抱歉，这并不简单，但我在自己的应用程序中遇到了几乎完全相同的问题，没有办法避免这种情况，你需要；

1.  具有 REST API 以管理和分发数据的服务器
2.  一种建立朋友/群组的方法
3.  一种推送数据的方法

Google Cloud Messaging 真的没有那么麻烦。

查看 Google IO 2012 代码，他们在那里使用了它，但代码不多。

[http://code.google.com/p/iosched/source/browse/](http://code.google.com/p/iosched/source/browse/)

您真正需要构建的是一个带有很多功能的rest api，用于识别设备并设置这些朋友组。我建议使用 Facebook 集成来建立朋友网络。

[https://developers.facebook.com/](https://developers.facebook.com/)

设置 REST API 的方法有无数种，但我见过的最快的方法是今年在 google IO 和 Google AppEngine EndPoints 上发布的。

[http://devthots.blogspot.com/2012/07/building-awesome-android-apps-with.html](http://devthots.blogspot.com/2012/07/building-awesome-android-apps-with.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T23:42:49.423

试试[Comet](http://en.wikipedia.org/wiki/Comet_%28programming%29)，都是关于 http 请求的

# c++ - 如何抑制有关 C++ 中未使用变量的警告？

> ID：11837385
> 
> 赞同：6
> 
> 时间：2012-08-06T23:32:24.570
> 
> 标签：c++

如何抑制编译器生成的关于 C++ 程序中未使用变量的警告？

我正在使用 g++ 编译器

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-06T23:34:10.450

放入一个强制转换为无效：

```
int unused;
(void)unused; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-06T23:37:36.233

`-Wno-unused-variable`使用选项编译。

有关详细信息，请参阅[有关警告选项的 GCC 文档](http://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html)。

`-Wno-__`选项关闭由 设置的选项`-W__`。在这里我们关闭[`-Wunused-variable`](http://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#index-Wunused_002dvariable-333)。

此外，您可以将 应用于`__attribute__((unused))`变量（或函数等）以根据具体情况抑制此警告。感谢[Jesse Good](https://stackoverflow.com/users/906773/jesse-good)提到这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-06T23:36:08.567

为了消除这些警告，我制作了一个可以在整个项目中使用的**宏：**

```
#define UNUSED(x) (void)(x) 
```

# php - 本地主机上的 Netbeans 7.2 和 PHP

> ID：11837388
> 
> 赞同：1
> 
> 时间：2012-08-06T23:32:37.400
> 
> 标签：php, netbeans, xampp, localhost, netbeans-7.2

我一直在 Dreamweaver 中开发一个 PHP 项目。在确定 Netbeans 将使我的生活更轻松之后，我为 PHP 安装了 Netbeans 7.2。

我遵循了项目设置指南，但我遇到了项目文件夹的问题。我可以编辑和保存源文件，但如何更新本地主机上的文件？

具体来说，我的项目源文件位于我们的工作驱动器上，我可以将其用作常规硬盘驱动器。我什至在 Dreamweaver 中有这个项目的站点文件，其中源文件夹、本地文件夹和远程文件夹配置文件均已设置好且运行良好。

我是否需要更改存储项目文件的方式？我的 Netbeans 项目属性如下：

```
Sources
-Project Folder: D:\work\cms\current
-Sourec Folder:  D:\work\cms\current
-Test Folder:

Run Configuration
-Configuration: <default>
-Run As: Local Web Site (running on local web server)
-Project URL: http://localhost/cms/current/
-Index File: index.php 
```

而且我看不到其他相关设置，但是如果您提出任何问题，我会更新我的问题。

当我进行更改时，我保存并选择运行。页面按预期加载，但不存在更改，本地主机副本未更新。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T12:44:41.070

您可以安装 FTP 服务器，例如 filezilla 服务器，并在项目“运行配置”中更改为远程 Web 服务器，然后指定 localhost 和 ftp 详细信息。

或者创建一个脚本来复制项目，例如 .bat 或 .sh，具体取决于操作系统。

或者将您的项目位置更改为在 localhost web 目录中，然后在其中使用它。

我遇到了同样的问题，我放弃了，现在让 apache 指向我的开发机器上的项目文件夹。

# gwt - GXT 菜单按钮的样式

> ID：11837390
> 
> 赞同：0
> 
> 时间：2012-08-06T23:32:57.503
> 
> 标签：gwt, extjs, gxt

我看到 GXT 菜单只能通过 setMenu() 方法在 CellButtonBase 子类的实例上设置。我想显示图像而不是按钮，并在用户单击该图像时显示菜单。不幸的是， Image 不是 CellButtonBase 的子类，因此我无法将 GXT 菜单附加到它。那么如果必须使用 TextButton （这似乎是我在这里唯一的选择），我该如何使它看起来像一个图像？没有关于此主题的文档或示例。我在 Sencha GXT 论坛上询问了支持，但没有得到回应。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T01:24:34.747

ok, I found a way to do this without TextButton. add an Image and call menu.show(...) in click handler.

```
 private void createMenu() {
    menu = new Menu();

    Image menuButtonImage = new Image(Resources.INSTANCE.nav_preferences());
    menuButtonImage.addStyleName(CSS.header_bar_icon());
    menuButtonImage.addClickHandler(new ClickHandler() {
      @Override
      public void onClick(ClickEvent event) {
        menu.showAt(getAbsoluteLeft(), getAbsoluteTop() + MENU_OFFSET_FROM_IMAGE_TOP);
      }
    });
    menu.addShowHandler(new ShowEvent.ShowHandler() {
      @Override
      public void onShow(ShowEvent event) {
        highlight();
      }
    });
    menu.addHideHandler(new HideEvent.HideHandler() {
      @Override
      public void onHide(HideEvent event) {
        removeHighlight();
      }
    });
    menu.setStyleName(CSS.menu());
    add(menuButtonImage);

  }
  private void addUserSettings() {
    MenuItem userSettingsItem = new MenuItem("User Settings");
    userSettingsItem.addSelectionHandler(new SelectionHandler<Item>() {
      @Override
      public void onSelection(SelectionEvent<Item> event) {
        _coreLayout.showUserSettingsPage();
      }
    });
    userSettingsItem.setStyleName(CSS.menu_item());
    menu.add(userSettingsItem);
  }

  private void highlight() {
    addStyleName(CSS.header_bar_icon_box_selected());
  }

  private void removeHighlight() {
    removeStyleName(CSS.header_bar_icon_box_selected());
  } 
```

# c++ - 使用 mpl::fold 占位符和我自己的结构事故

> ID：11837391
> 
> 赞同：1
> 
> 时间：2012-08-06T23:33:07.383
> 
> 标签：c++, templates, template-meta-programming, boost-mpl

我有以下主要模板：

```
template<size_t pos, size_t lev>
struct Sol; 
```

我专门针对一些 pos 值，如下所示：

```
template<size_t lev>
struct Sol<0, lev>
{
    static const mpl::vector_c<size_t, 4, 6> jumps;
    static const size_t value =
        mpl::fold<jumps, mpl::integral_c<size_t, 0>, 
                  mpl::plus<Sol<_1, lev-1>::value, 
                            Sol<_2, lev-1>::value> >::type::value;
} 
```

但我得到了`Sol`预期`size_t` 并得到了`mpl_::_1`。`Sol`我知道在这种情况下，我可能会忽略我试图做的折叠事情，只是将 value 声明为其他两个结构的一个级别较低值的总和，即`pos`4 和 6 ..但我想知道这是否可以修复以防`vector_c`打字有点长？

谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T19:08:53.273

下面的代码将做你想做的事。我做了一些改变。

首先，我`pos` **用**`mpl::integral_c`. 通常，在使用 Boost.MPL 时，建议包装所有非类型模板参数。这样，您以后就不必再区分它们了。

其次，我使用**了模板元功能转发**。这意味着我没有`value`在 内部定义模板数据成员，而是从包含该值的 Boost.MPL 模板`Sol`派生而来。`Sol`这将节省您在整个地方打字`::type::value`的时间。使用良好的缩进使代码更易于阅读。

第三，我`mpl::plus`用`mpl::fold`. `boost::mpl::lambda`这对于您提供的代码并不是绝对必要的，但是如果您`Sol`在另一个`mpl::fold`带有其他占位符参数的表达式中使用它自己（lambda 包装将延迟评估，直到整个模板被解析）。

第四，我做了一个完全专业化来停止你的`lev`参数的递归。顺便说一句，如果您开始进行编译时计算 ons `lev`，同样的建议也适用：首先将其包装成`mpl::integral_c`.

```
#include <boost/mpl/fold.hpp>
#include <boost/mpl/integral_c.hpp>
#include <boost/mpl/lambda.hpp>
#include <boost/mpl/placeholders.hpp>
#include <boost/mpl/plus.hpp>
#include <boost/mpl/vector_c.hpp>

namespace mpl = boost::mpl;
using namespace mpl::placeholders;

// primary template
template<typename pos, size_t lev>
struct Sol;

// partial specialization for zero position
template<size_t lev>
struct Sol< mpl::integral_c<size_t, 0>, lev>
:
        mpl::fold<
                mpl::vector_c<size_t, 4, 6>, 
                mpl::integral_c<size_t, 0>,
                mpl::lambda<
                        mpl::plus<
                                Sol<_1, lev-1>, 
                                Sol<_2, lev-1>
                        > 
                > 
        >        
{};

// full specialization for zero position and level
template<>
struct Sol< boost::mpl::integral_c<size_t, 0>, 0>
:
        boost::mpl::integral_c<size_t, 0> // or whatever else you need
{}; 
```

# amazon-web-services - 如何在 CloudFormation 模板中禁用对 Auto Scaling 组中实例的详细监控？

> ID：11837395
> 
> 赞同：5
> 
> 时间：2012-08-06T23:33:45.193
> 
> 标签：amazon-web-services, amazon-cloudformation

我正在使用 CloudFormation 来启动 Auto Scaling 组中的一些服务器，并且我希望它们都使用**基本**监控。我尝试`Monitoring`在`false`属性`AWS::AutoScaling::AutoScalingGroup`和 中设置`AWS::AutoScaling::LaunchConfiguration`，但堆栈无法启动；我看到`CREATE_FAILED`错误消息：`Encountered unsupported property Monitoring`.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-07T03:36:51.990

Just another day in the lovingly roguish world of almost-but-not-quite-consistant CFN template syntax.

The property you want is `InstanceMonitoring`, not `Monitoring`. It should apply to your LaunchConfiguration resource. More details are [in the docs.](http://docs.amazonwebservices.com/AWSCloudFormation/latest/UserGuide/aws-properties-as-launchconfig.html#cfn-as-launchconfig-instancemonitoring)

```
InstanceMonitoring

Indicates whether or not instance monitoring should be enabled for this
    autoscaling group. This is enabled by default. To turn it off, set
    InstanceMonitoring to "false".

Required: No. Default value is "true".
Type: Boolean 
```

Of course, if you're provisioning an AWS::EC2::Instance resource, it's just straight up `Monitoring`. For what it's worth, I find this slightly less annoying than changing `SecurityGroups` to `SecurityGroupIds` when moving Instance declarations in and out of VPCs, but that's just me.

# javascript - 将变量传递给 Javascript 模块化模式方法

> ID：11837397
> 
> 赞同：0
> 
> 时间：2012-08-06T23:34:10.930
> 
> 标签：javascript, oop

我想做类似下面的代码。显然这不起作用，因为这不允许您传入变量，在下面的例子中，它是最小值和最大值。

有可能这样做吗？如果是这样，怎么办？

谢谢。J。

```
var utils = (function() {

    function randomRange(min, max) {
        return ((Math.random() * (max - min)) + min);
    };

    return {
        randomRange : randomRange(min, max);
    };

}());

utils.randomRangeRound(20,5); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T23:39:01.323

如果您想要的是这样，这将起作用：

```
utils.randomRangeRound(20,5); 
```

然后，您可以这样做：

```
var utils = {
    randomRangeRound: function(min, max) {
        return ((Math.random() * (max - min)) + min);
    }
}; 
```

或者，如果您`utils`在代码中不同位置分配的对象上有多个方法：

```
var utils = utils || {};

utils.randomRangeRound = function(min, max) {
    return ((Math.random() * (max - min)) + min);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T05:14:08.257

或者，您的代码几乎可以正常工作，您只是语法错误：

```
var utils = (function() {

    this.randomRange = function (min, max) {
        return ((Math.random() * (max - min)) + min);
    };

}()); 
```

# html - 具有位置的元素上的垂直空间：绝对

> ID：11837401
> 
> 赞同：16
> 
> 时间：2012-08-06T23:34:41.363
> 
> 标签：html, css, positioning

如何仅使用 css 使具有**动态高度**`position:absolute`的元素占据垂直空间？我可以使用容器和显示器有什么技巧吗？

 *** * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-06T23:56:54.037

不幸的是，根据定义，使用绝对定位意味着您的元素不再占用空间。所以不，只有通过 css 没有办法做到这一点。

您当然可以使用 jQuery（或纯 javascript）来完成此操作。我的做法是`space`在每个垂直元素旁边都有一个元素。将空间元素和绝对定位的垂直元素都包含在相对定位的 div 中。在页面加载时，更改空间元素的[高度](http://api.jquery.com/height/)以匹配垂直元素的高度。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-07T14:34:43.670

`position: absolute`意味着它们不占用流量中的空间。但是，您不必使用边距进行动画处理，您可以使用`float`让元素占据任何空间，并制作每个元素 `position:relative`。

```
div.animate-me {
   width: 300px;
   margin: 20px;
   float: left;
   left: -1000px; // Make them start offscreen
   position: relative;
   border: 1px solid red;
   visibility: hidden
}​

$('div').css().animate({
    left: 0
}); 
```

[**示例**](http://jsfiddle.net/qxzzX/1/) [http://jsfiddle.net/qxzzX/1/](http://jsfiddle.net/qxzzX/1/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-01-09T17:26:00.577

这并不适用于所有情况，但是：如果`position: absolute`元素具有固定的纵横比（例如，使用 响应调整大小的图像或视频`height: auto`），您可以利用该[`padding-bottom`技巧](https://css-tricks.com/aspect-ratio-boxes/)为间隔元素提供相同的纵横比，以便它与`absolute`元素一起调整大小：

```
.spacer {
  height: 0;
  padding-bottom: 125%; /* for a 1.25 height/width ratio */
} 
```

您可以阅读链接，但这有效，因为`padding-bottom`百分比被解释为元素宽度的百分比。

然后由您的特定布局来定位垫片，使其精确地覆盖或覆盖`position: absolute`元素，并占用您的`absolute`元素本来应该拥有的空间`absolute`。**

# cakephp - CakePHP 自定义路由调用错误的动作

> ID：11837402
> 
> 赞同：1
> 
> 时间：2012-08-06T23:34:41.977
> 
> 标签：cakephp, routes

我有以下代码`routes.php`：

```
Router::connect('/c/details/:id/:slug',
    array('controller' => 'cars'),
    array('pass' => array('id', 'slug'))
); 
```

如果我尝试访问`http://domain.com/c/details/123/abc`，它可以工作。但是，如果我删除`abc`（即 slug），CakePHP 会尝试访问操作`123`（这是 id，而不是操作）。

```
Error: The action 123 is not defined in controller CarsController 
```

如果我使用`/c/details/:id/:slug/:action/*`，这是我从 1.2（是的，很旧）升级到 2.2.1 之前所拥有的，并且它工作正常，CakePHP 也会尝试访问操作`123`，无论我是否有 slug。

没有 slug 的 URL 在升级 CakePHP 之前总是有效的，并且使用我在控制器中的代码，如果 URL 中没有 slug，它将重定向到正确的 URL。

**编辑：**我刚刚检查了一下，似乎当我不提供蛞蝓时，整个事情都发生了变化。`c`被忽略，`details`成为控制器并`123`成为动作。

```
[request] => CakeRequest Object
    (
        [params] => Array
            (
                [plugin] => 
                [controller] => details
                [action] => 123
                [named] => Array()
                [pass] => Array()
                [isAjax] => 
            ) 
```

什么时候是正确的，如果我提供一个蛞蝓，这就是我得到的：

```
[request] => CakeRequest Object
    (
        [params] => Array
            (
                [plugin] => 
                [controller] => cars
                [action] => index
                [named] => Array()
                [pass] => Array
                    (
                        [0] => 123
                        [1] => abc
                    )

                [id] => 123
                [slug] => abc
                [isAjax] => 
            ) 
```

知道现在可能导致此问题的原因是什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T05:15:55.307

如果您希望 slug 是可选的（不确定），您可能需要 2 条路线。在任何情况下，`action`也将密钥添加到每个路由。

```
Router::connect('/c/details/:id',
    array('controller' => 'cars', 'action' => 'details'),
    array('pass' => array('id'))
);

Router::connect('/c/details/:id/:slug',
    array('controller' => 'cars', 'action' => 'details'),
    array('pass' => array('id', 'slug'))
); 
```

# internet-explorer - Opencart IE 问题购物车下拉菜单在其他浏览器中无法正常工作

> ID：11837405
> 
> 赞同：0
> 
> 时间：2012-08-06T23:35:26.670
> 
> 标签：internet-explorer, opencart

对于我的一生，我找不到导致 opencart 购物车标题在 IE 中工作的问题或冲突。它在其他浏览器中运行良好。

当您访问我网站上的产品并按（添加到购物车）时，它似乎不会更新购物车，也不会在单击时显示购物车。

要复制问题，请访问 IE 中的[http://www.hollinwoodhydroponics.co.uk/ph-nutrient-management/ph-buffer-4](http://www.hollinwoodhydroponics.co.uk/ph-nutrient-management/ph-buffer-4)并尝试添加到购物车。还要注意 Success: Message 不显示。

Opencart 1.5.1.3 更新：这一切都在分类页面上工作，所以我认为这可能是我的问题：

```
<script type="text/javascript">
if (!window.console) {var console = {};}
if (!console.log) {console.log = function() {};}

function updatePx() {
console.log('OPU: updatePx() called');
    var ajaxurl = 'index.php?option=com_aceshop&format=raw&tmpl=component&route=product/option_price_update/updatePrice';

jQuery.ajax({
    type: 'post',
    url: ajaxurl,
    dataType: 'json',
    data: jQuery(':input[name^="option"][type=\'checkbox\']:checked, :input[type=\'hidden\'], :input[name^="option"][type=\'radio\']:checked, select[name^="option"], :input[name=\'quantity\']'),

    success: function (mydata) {
        console.log('OPU: mydate.price'+mydata.price);
        console.log('OPU: mydate.special'+mydata.special);
        console.log('OPU: mydate.tax'+mydata.tax);

        // Update the main price with the new price.

        jQuery('#opu_price').fadeOut('100').queue(function(n){jQuery(this).html(mydata.price); n();}).fadeIn('100');
        jQuery('#opu_special').fadeOut('100').delay(100).queue(function(n){jQuery(this).html(mydata.special); n();}).fadeIn('100');
        jQuery('#opu_tax').fadeOut('100').delay(200).queue(function(n){jQuery(this).html(mydata.tax); n();}).fadeIn('100');
    },
    error: function(xhr, ajaxOptions, thrownError) {
        console.log(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
    }
});
}

jQuery(document).ready(function () {
console.log('OPU: initialized');
var $updateOnLoad = false; // Change to true if using 1.4.x or want to force an update on page load

// Update on initial page load for 1.4.x only
if ($updateOnLoad) {
    updatePx();
}

// Update whenever the triggerable page inputs are changed
jQuery(':input[name^="option"],:input[name^="quantity"]').change(function(){
    updatePx();
});

});
</script> 
```

提前感谢您对可能导致此问题的问题或冲突的任何见解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T23:46:26.667

我看到你也在使用 mootools。我的猜测是你的问题的根源，看看这里[http://docs.jquery.com/Using_jQuery_with_Other_Libraries](http://docs.jquery.com/Using_jQuery_with_Other_Libraries)

# iphone - 远程推送通知

> ID：11837411
> 
> 赞同：0
> 
> 时间：2012-08-06T23:36:12.267
> 
> 标签：iphone, objective-c, notifications, push-notification, apple-push-notifications

我是 iPhone 开发的新手，我想知道如何能够远程发送推送通知。我尝试了多种方法，但无法正常工作。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T02:50:42.257

本地通知示例代码：

[本地推送通知示例代码操作系统](http://iphonesdkdev.blogspot.kr/2010/04/local-push-notification-sample-code-os.html)

[iphone 编程教程本地通知](http://www.icodeblog.com/2010/07/29/iphone-programming-tutorial-local-notifications/)

* * *

APNS（苹果推送通知服务）

如果您是初学者，我建议您使用 UrbanAirship。推送服务在基本帐户中每月免费提供 100 万条免费推送消息。

站点：[UrbanAirShip](https://urbanairship.com/)，文档：[docs.urbanairship](https://docs.urbanairship.com/display/DOCS/Getting+Started%3A+iOS%3A+Push)

其他apns教程：

[使用 APNS 构建 iOS SDK “Poke” 应用程序](http://mobile.tutsplus.com/tutorials/iphone/iphone-sdk_apns/)

* * *

# prolog - 序言约束

> ID：11837414
> 
> 赞同：1
> 
> 时间：2012-08-06T23:36:59.843
> 
> 标签：prolog, constraint-programming

我有这个功能

```
test(X, Y, Z) :-
   { Z = Y+X },!. 
```

当我运行查询时

```
test(1,X,8), test(X,4,8), test(1,5,X) 
```

我能够获得 X 的值，但如果我这样做

```
test(X, Y, Z) :-
   { Z = Y**X },!. 
```

我收到类似于每个查询的错误

未处理的异常：未知消息：type_error(nf(_G353**1,_G351),1,a numeric expression,_G353**1)

我尝试了其他运算符，它们都可以工作，我猜 ** 是特殊的，但我们具体如何处理呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T00:58:39.610

假设您的意思是 ** 表示取幂，您想要的运算符是 ^; ** 不是 prolog 中的有效运算符，因此是错误消息。

# .net - 正则表达式负后视可变距离

> ID：11837415
> 
> 赞同：1
> 
> 时间：2012-08-06T23:37:30.473
> 
> 标签：.net, regex, lookbehind

我正在尝试使用正则表达式在后来出现的 groupB 中查找早期 groupA 中不存在的内容。如果它存在于 A 中，但不存在于 B 中，这很好。这似乎意味着如果我必须使用正则表达式，则必须进行否定的后视。

大量简化的示例：

文本：

```
groupA:
tag 789
tag 123

groupB:
Item 1:
... 123
... 456 
```

我对环视很陌生。这是立即想到的（或十几种变体之一），但你们中的知情人士会发现它没有按预期工作。

```
regex:(\.\.\. (?<ID>(\d+)))(?<=(?s).*?tag (\k<ID>)) 
```

我的理想目标是匹配 groupB 中不存在于 groupA 中的项目，并且我无法重新排序输入。正确的示例输出：（不是由提供的正则表达式完成）

```
... 456 
```

.NET 支持可变回溯距离，但显然我遗漏了一些东西！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T03:20:35.703

.NET 正则表达式引擎从左到右解析字符，因此您不能从右到左反向引用。当你到达B组时，A组中的所有角色都已经被消耗并且无法匹配。虽然正则表达式可能看起来回溯，但它实际上是[预匹配或分支](http://msdn.microsoft.com/en-us/library/dsy130b4.aspx)- 解析器永远不会向后运行。

使用正向运行的解析器，您需要首先匹配（并保留）A 组中的项目，然后只返回 B 组中不存在于 A 组中的项目。这对于[确定性有限自动化](http://en.wikipedia.org/wiki/Deterministic_finite_automata)来说太复杂了计算，因为它不能在恒定空间中完成。

您*可以*通过反转字符串并向后运行匹配项来使用正则表达式来解决您的问题，但是代码可能会变得非常难以理解：

```
321 ...
:1 metI
:Bpuorg

321 gat
987 gat
:Apuorg

"((?<id>\d+)(?=\s\.\.\.))(?!.*\k<id>\sgat)" 
```

结果：

```
"654" 
```

相反，我建议通过以下方式保持简单：

```
var groupA = Regex.Matches(text, @"(?<=tag\s)\d+").Cast<Match>().Select(x => x.Value);
var groupB = Regex.Matches(text, @"(?<=\.\.\.\s)\d+").Cast<Match>().Select(x => x.Value);

var bNotA = groupB.Except(groupA); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-16T14:44:51.960

我知道这是一个非常古老的问题，您自己可能不再对解决方案感兴趣，但我发现现有答案具有误导性，并想提供另一个答案。（另一个答案中的最终解决方案非常适合给定的问题 - 您不需要使用单个正则表达式来解决所有问题。但您的答案中指出的问题实际上并不是问题。）

您的想法实际上是正确的，但实施不正确。第一个问题是您正在使用积极的后视，这将确保之前出现过相同的*值*。你想要的是消极的向后看，`(?<!...)`以确保该值*没有*出现。

然而，主要问题是您的后视内容的顺序是错误的。在您的代码中，您*首先*拥有通配符`.*?`，*然后*是您想要匹配的东西`tag (\k<ID>)`。但是您正在寻找当前位置*左侧*`tag X`的某个位置，这意味着通配符实际上需要排在第二位。在*后面*看，正则表达式引擎的当前位置（在后面的外部）位于内部模式的*末尾*。想象一下做。这匹配in但不匹配 in 。（更重要的是，如果一定要走在前面，为什么自己不倒过来呢？***`(?<=abc)def``def``abcdef``cbadef``.*?``tag (\k<ID>)``(\k<ID> gat)`***

 ***所以这工作得很好：

```
(\.\.\. (?<ID>(\d+)))(?<!(?s)tag (\k<ID>).*?) 
```

尽管它的组比您实际需要的多得多。这就足够了：

```
\.\.\. (?<ID>\d+)(?<!(?s)tag \k<ID>.*?) 
```

[在这里测试一下。](http://regexstorm.net/tester?p=%5c.%5c.%5c.+(%3f%3cID%3e%5cd%2b)(%3f%3c!(%3fs)tag+%5ck%3cID%3e.*%3f)&i=groupA%3a%0d%0atag+789%0d%0atag+123%0d%0a%0d%0agroupB%3a%0d%0aItem+1%3a%0d%0a...+123%0d%0a...+456)

至于 Simon 的评论“.NET 正则表达式引擎从左到右解析字符，所以你不能从右到左反向引用。” 我不知道那件事。*我还没有看到 regex 引擎的代码，但是从多年试验 .NET 的 regex 风格并将其滥用于各种恶作剧中*，我可以说它肯定会像你所期望的那样回溯到所有实际目的。（他链接到的更快的算法只适用于不使用反向引用的模式，结果完全无法区分。）模式从左到右匹配，是的。但是，直到您实际到达模式中的后视后才会处理后视，并且它可以反向引用较早的捕获，即使这些在匹配的*后期结束。*

对此的两个警告是 a) .NET 具有从右到左的匹配模式，该模式实际上从右到左处理模式，因此捕获必须出现*在*代码中的反向引用之后，并且 b) 后视使用所述从右到-left 模式（不幸的是，这是未记录的），因此引擎实际上可以通过使用正常的从左到右模式中的后视（或从右到左模式中的前瞻，或内部前瞻）来回编织输入字符串向后看，什么不是，但这可能不是您想在生产代码中使用的东西）。

在考虑反向引用何时有效以及何时无效时，这种处理输入的方向*始终很重要。****

# objective-c - 在我的 iOS 应用程序中使用地图共享我的位置？

> ID：11837417
> 
> 赞同：0
> 
> 时间：2012-08-06T23:37:37.513
> 
> 标签：objective-c, xcode

我正在开发一个演示家庭应用程序。我想在其中一个选项卡中添加位置地图功能。用户可以在哪里看到我固定的位置。

假设有一个家庭活动正在进行，我想与拥有该应用程序的用户分享位置。因此，他们只需检查标签并在我的应用程序内的谷歌地图上查看位置。

你能给我一些建议，从哪里开始，或者是否有一个阅读图书馆可以工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T23:50:38.653

简而言之，您将要使用[Location Services](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/LocationAwarenessPG/Introduction/Introduction.html#//apple_ref/doc/uid/TP40009497-CH1-SW1)。

一旦您确定位置服务可用，您就可以设置它们并提供一个实现 CLLocationManagerDelegate 的委托。除其他外，当用户的位置更改时会触发一个回调。您需要在此处处理位置更改并存储用户的位置以在您的应用程序中使用。

```
 // Delegate method from the CLLocationManagerDelegate protocol.    
- (void)locationManager:(CLLocationManager *)manager    
    didUpdateToLocation:(CLLocation *)newLocation    
    fromLocation:(CLLocation *)oldLocation    
{    
    // If it's a relatively recent event, turn off updates to save power    
    NSDate* eventDate = newLocation.timestamp;    
    NSTimeInterval howRecent = [eventDate timeIntervalSinceNow];

    if (abs(howRecent) < 15.0)
    {
        NSLog(@"latitude %+.6f, longitude %+.6f\n",
                newLocation.coordinate.latitude,
                newLocation.coordinate.longitude);
    }

    // else skip the event and process the next one.
} 
```

# asp.net - ASP.Net MVC 3 允许匿名白名单不起作用

> ID：11837420
> 
> 赞同：0
> 
> 时间：2012-08-06T23:38:00.893
> 
> 标签：asp.net, asp.net-mvc-3

我从一位同事那里接手了一个 MVC 3 Razorview 项目。我创建了一个忘记密码的页面，但是当点击登录页面上的忘记密码链接时，网站会要求用户登录。我做了一些谷歌搜索并使用该属性实现了[白名单操作的解决方案。](http://blogs.msdn.com/b/rickandy/archive/2011/05/02/securing-your-asp-net-mvc-3-application.aspx)`[AllowAnonymous]`然而，这并没有解决问题。

单步执行代码永远不会调用忘记密码操作。它被直接推送到帐户控制器上的登录操作。`_ViewStart.cshtml`即使忘记密码布局不使用它并且在代码中设置了布局，也会调用以下代码。

```
@{
    Layout = Request.IsAuthenticated ? "~/Views/Shared/_Layout.cshtml" : null;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T18:04:10.040

您必须将视图中使用的控制器的所有操作方法包含在白名单中（使用 [AllowAnonymous]）。我在使用 RecoverPassword 页面时遇到了同样的问题，我意识到我的布局调用了一个不在白名单中的菜单方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T03:34:27.037

你可以试试这个。[http://blog.tomasjansson.com/2011/08/securing-your-asp-net-mvc-3-application/](http://blog.tomasjansson.com/2011/08/securing-your-asp-net-mvc-3-application/)

**更新**

以下代码工作正常。它在基类本身中实现 ​​OnAuthorization。

```
public class MyBaseController : Controller
{
    protected override void OnAuthorization(AuthorizationContext filterContext)
    {
        var skipAuthorization = filterContext.ActionDescriptor.IsDefined(typeof(AllowAnonymousAttribute), true) ||
                            filterContext.ActionDescriptor.ControllerDescriptor.IsDefined(
                                typeof(AllowAnonymousAttribute), true);
        if (!skipAuthorization)
        {
            base.OnAuthorization(filterContext);
            if (!User.Identity.IsAuthenticated)//Implement your own logic here
            {
                var url = new UrlHelper(filterContext.RequestContext);
                var logonUrl = url.Action("LogOn", "Home", new { reason = "NotAuthorized" });
                filterContext.Result = new RedirectResult(logonUrl);

            }
        }

    }
}

public class HomeController : MyBaseController 
{

    public ActionResult Index()
    {
        return View();
    }

    [AllowAnonymous]
    public ActionResult PasswordReset()
    {
        return Content("reset your password");
    }

    [AllowAnonymous]
    public ActionResult LogOn(string reason)
    {
        return Content("please log in");
    }
}

[AttributeUsage(AttributeTargets.Method | AttributeTargets.Class, AllowMultiple = true, Inherited = true)]
public class AllowAnonymousAttribute : Attribute
{
} 
```

# jquery - JQuery使用一页用新图像替换图像并在地址栏中显示正确的参数

> ID：11837423
> 
> 赞同：0
> 
> 时间：2012-08-06T23:38:14.727
> 
> 标签：jquery, image, replace

我对 JQuery 相当陌生。单击以更改包含占位符的图像以将图像替换为新图像时，我已经能够获得颜色链接。我遇到的问题是，当您单击红木颜色等颜色链接时，顶部的地址栏应显示网页以及单击的颜色参数并保持红木颜色。单击红木图像时地址栏的外观示例：

```
 ".../wb/JourneymenSelect.htm?color=redwood" 
```

还有一个按钮，上面写着“电子邮件”，应该能够从地址栏中获取链接，当您单击该链接时，应该显示正确的颜色选择。e.preventDefault(); 如果我删除它，则行，除了单击颜色链接时，您会看到新图像的快速闪烁，但不会保留新图像信息。以下是我正在使用 HTML 部分的代码的主要部分：

```
 <div style="text-align: center;" id="houseImage">
            <img src="images/houses/JourneymenSelect/charcoal_gray.jpg" width="320" height="206" class="houseimage" alt="" /></div>
        <div id="colorbuttons" style="width: 300px; margin: 0px auto; margin-top: 10px; padding-left: 20px;
            text-align: center; font-style: italic;">
            <span>Click swatches below to change panel color on house</span><br />
            <br />
            COLORSCAPES® DARK COLOR<br />
            <a href="JourneymenSelect.htm?color=charcoal_gray"" class="myButton" style="background-image: url(images/buttons/charcoal_gray.png)!important;">&nbsp;</a>
            <a href="JourneymenSelect.htm?color=redwood" class="myButton" style="background-image: url(images/buttons/redwood.png)!important;">&nbsp;</a><br />
            <a href="JourneymenSelect.htm?color=natural_cedar" class="myButton" style="background-image: url(images/buttons/natural_cedar.png)!important;">&nbsp;</a>
            <a href="JourneymenSelect.htm?color=heritage_blue" class="myButton" style="background-image: url(images/buttons/heritage_blue.png)!important;">&nbsp;</a>
            <a href="JourneymenSelect.htm?color=shamrock" class="myButton" style="background-image: url(images/buttons/shamrock.png)!important;">&nbsp;</a><br />
            <br /> 
```

jQuery代码：

```
 $('#colorbuttons a').click(function (e) {
    e.preventDefault();
    // get the link and its 'href' attribute...
    var linkImage = $(this);
    var link = linkImage.attr('href');
    var extension = '.jpg';
    //alert(link);

    // split the 'href' attribute with the '=' character and get the
    // last element in the array...
    link = link.split('=');
    //alert(link);
    var filename = link[link.length - 1] + extension;
    //alert(filename);

    // now we can create the image we're going to put in the
    // Replace image container...
    var image_folder = 'images/houses/';
    //alert(image_folder + filename);

    //Get the folder name of where image will be coming from
    //This will help when there are muliple pages with different folder locations
    var folderPath = $('.houseimage').attr('src');
    folderPath = folderPath.split('/');
    var folderName = folderPath[folderPath.length - 2] + '/';
   // alert(folderName);

    var replace_image = $('<img class="houseimage" width="320" height="206" alt="" />');
    replace_image.attr('src', image_folder + folderName + filename);
   //alert(replace_image.attr('src'));

    // set the HTML of the container to the new image...
    // first, clear out whatever HTML was in there, then add
    // the new image...
    $('.houseimage').html('');
    // alert($('.houseimage').html() + 'this is empty string');
    $('.houseimage').replaceWith(replace_image);

}); 
```

我只使用一个页面，因为可能还有其他相关页面，并试图使其易于管理。你能帮忙的话，我会很高兴。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T12:56:17.867

我终于弄明白了。必须删除此标语行中的内容

```
 var newImage = $('<img class="houseimage" width="320" height="206" alt="" />'); 
```

然后我必须回忆图像的所有属性，以便正确显示。在替换图像行后，我使用了以下脚本。

```
 $('#houseImage img').addClass('houseimage');
    $('.houseimage').attr('width', '300');
    $('.houseimage').attr('height', '186');
    $('.houseimage').attr('alt', ''); 
```

它现在适用于所有浏览器。唯一不重要的是 IE 在加载图像时会闪烁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:46:42.240

我修复了部分解决方案。我决定尝试加载事件，而不是使用点击事件。它包含一个检查 URL 的 if 语句，如果它包含某种颜色，则显示图像。下面是我想出的，似乎有效。

```
 $(window).load(function () {
    var url = document.URL;
    var colorName = url.substring(url.lastIndexOf("=") + 1);

    var folderPath = $('.houseimage').attr('src');
    folderPath = folderPath.split('/');
    var folderName = folderPath[folderPath.length - 2] + '/';
    var extension = '.jpg';
    var newImage = $('<img class="houseimage" width="320" height="206" alt="" />');
    newImage.attr('src', 'images/houses/' + folderName + colorName + extension);
    //alert(newImage);

    if (url.indexOf(colorName)) {
        //alert(url + ' indexof ' + colorName);
        $('.houseimage').html('');
        $('.houseimage').replaceWith(newImage);
    }
    else {
        // show default.
        $('.houseimage').attr('src', 'images/houses/' + folderName + '/charcoal_gray.jpg');

    }

}); 
```

现在的问题是它现在在 Firefox、android 手机和 iphone 中运行良好。但对于 IE7、8、9，它根本不起作用。使用我的窗口 load() 脚本。URL 会更改，但图像不会更改。

# ruby-on-rails - Ajax 文件上传 rails + Rack RawUpload + Paperclip

> ID：11837425
> 
> 赞同：3
> 
> 时间：2012-08-06T23:38:51.397
> 
> 标签：ruby-on-rails, ruby-on-rails-3, paperclip, ajax-upload

我正在尝试在我的 rails 应用程序中上传 ajax 图像。我正在使用 Paperclip 进行正常的图像上传，效果很好，但我似乎无法连接 ajax 方法。我正在使用 Rack RawUpload 和 [File Uploader](https://github.com/valums/file-uploader)插件。[我按照这里](http://marc-bowes.com/2011/08/17/drag-n-drop-upload.html)的一般说明进行操作，但我被困在实际将图像附加到创建时的新对象上。这是我的控制器代码：

```
@bottle = Bottle.new(params[:bottle])
    @bottle.user_id = current_user.id
#file = params[:qqfile].is_a?(ActionDispatch::Http::UploadedFile) ? params[:qqfile] : params[:file]
is_qq = params.has_key?(:qqfile)

if is_qq
    params[:bottle][:image] = params.delete(:file)
    render :json => { "success" => true }
else
        respond_to do |format|
            if @bottle.save
                    format.html { redirect_to '/bottles', notice: 'Bottle was successfully created.' }
                    format.json { render json: @bottle, status: :created, location: @bottle }
            else
                    format.html { render action: "new" }
                    format.json { render json: @bottle.errors, status: :unprocessable_entity }
            end
        end
    end 
```

这是查看代码：

```
<%= simple_form_for(@bottle, :html => { :multipart => true }) do |f| %>
    <%= f.error_notification %>

    <div class="form-inputs">
        <%= f.input :brand, :placeholder => 'Brand', :label => false %>
        <%= f.input :region, :placeholder => 'Region', :label => false %>
        <%= f.input :age, :collection => 5..35, :prompt => "Bottle Age", :label => false %>
        <%= f.input :price, :placeholder => 'Price', :label => false, :as => :currency, :input_html => { :class => 'span2' } %>
        <%= f.input :image_id, :as => :hidden %>
        <%= f.text_area :notes, :placeholder => 'Tasting notes...', :size => "160x5"  %>
    </div>  
</div>
<div class="span3 offset2">
Drag a file from your desktop here...
    <div class="well" height="105" style="width:200px;height:300px;">
    <!-- <img src="http://placehold.it/200x300" alt="" class="temp_image"> -->
        <div id="file-uploader"></div>
    </div>
    or...
    <%= f.file_field :image %>
</div>
<div class="span8 offset2">
    <%= f.button :submit, :class => 'btn-primary' %>
    &nbsp;
    <%= link_to bottles_path, :class => 'btn btn-danger' do %>
        Cancel
    <% end %>
</div>
<% end %> 
```

我正在像这样使用文件上传器上传：

```
var uploader = new qq.FileUploader({
debug: false,

/* Do not use the jQuery selector here */
element: document.getElementById("file-uploader"),

action: '/bottles',

allowedExtensions: ["jpg", "png"],

/*
 * This uploads via browser memory. 1 MB example.
 */
sizeLimit: 1048576,

/* Set Article category on submit */
onSubmit: function(id, fileName) {
  uploader.setParams({
    authenticity_token: $("input[name='authenticity_token']").attr("value")
  });
},
onComplete: function(id, fileName, responseJSON){
    url = responseJSON.image.image.url;
    $('.well').html('<img src="'+url+'" />');
    $('input#bottle_image_id').val(responseJSON.image.id);
} 
```

});

似乎使用 Rack 上传很好，并将 :file 参数传递给该方法，但我无法将 param[:bottle][:image] 与 param[:file] 一起分配，我得到错误：

```
undefined method `[]=' for nil:NilClass 
```

任何帮助将不胜感激。

编辑：
所以我能够让 ajax 上传挂钩到回形针上传并添加适当的参数，但现在我需要在提交表单的其余部分时更新同一个对象，而不是创建新对象。如何存储由 ajax 上传创建的包含所有图像内容的对象，并在提交完整表单后更新它？

编辑2：我保存时得到的错误是

```
undefined method `save' for #<ActiveSupport::HashWithIndifferentAccess:0x007ff961d08e48> 
```

我假设是因为我正在获取表单数据并尝试将其放在同一个 @bottle 对象中并且哈希不匹配。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-26T04:20:38.540

我在 217 行修补 lib/rack/request.rb 来解决这个问题

代替

```
{} 
```

和

```
@env["rack.request.form_hash"] || {} 
```

# unix - 独占锁和共享锁有什么区别？

> ID：11837428
> 
> 赞同：134
> 
> 时间：2012-08-06T23:39:13.433
> 
> 标签：unix, locking

根据维基百科，

> 共享锁有时称为“读锁”，排他锁有时称为“写锁”。

你能解释一下“共享”和“独占”这两个词背后的原因吗？

* * *

## 回答 #1

> 赞同：496
> 
> 时间：2012-08-07T00:19:25.120

我写下这个答案是因为我认为这是一个有趣（且合适）的类比：

将可锁定对象想象为教室中的*黑板（可锁定），其中包含**教师*（作家）和许多*学生*（读者）。

当老师在黑板上写东西（排他锁）时：

1.  没有人可以阅读它，因为它仍在编写中，而且她挡住了你的视线 =>*如果一个对象被独占锁定，则无法获得共享锁*。

2.  其他老师也不会上来开始写，或者板子变得不可读，迷惑学生=>*如果一个对象被排他锁，其他排他锁就无法获得*。

当学生阅读（共享锁）黑板上的内容时：

1.  他们都可以一起阅读上面的内容 =>*多个共享锁可以共存*。

2.  老师等他们读完才清板写更多 =>*如果已经存在一个或多个共享锁，则无法获取排他锁*。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2012-08-06T23:59:44.770

这很简单。读锁也称为共享锁，因为多个进程可以同时读取。读锁的目的是防止另一个进程获取写锁。相比之下，写锁在写操作完成时禁止所有其他操作，这就是它被描述为独占的原因。

所以读锁说“你现在可以读，但如果你想写，你必须等待”，而写锁说“你必须等待”。

* * *

我知道您正在研究以支持您的学习，但我无法抗拒演讲的冲动。

不恰当地使用锁定是性能问题的主要原因。使用区分读锁和写锁的锁定系统是一个好的开始，但仔细的设计有时可以消除对锁定的大部分需求。例如，会话状态*永远*不应保存在每个状态元素的一个全局集合中。

我实际上已经看到这样做了。这是一个残暴的设计，每次会话状态的最后一次更改都会导致装箱和对集合的更改，从而导致长时间的写锁定。开销非常严重，有效地将服务器减少到单线程行为。

简单地将所有会话状态聚合到一个结构中是一个巨大的改进。对会话状态的更改仅仅改变了会话状态结构成员的值。由于没有其他会话有机会甚至有机会直接引用会话的状态，因此唯一被更新的集合是会话列表。结果，在会话*期间*完全不需要锁定，只是在开始和结束时，吞吐量增加了 3000 倍。

另一个常见的锁定场景是在用户应用程序的线程之间共享资源。大多数现代框架使用消息而不是锁来解决这个问题。当您“转换到 UI 线程”时，实际上是在排队包含函数指针和一些参数（或委托和堆栈帧，具体取决于实现）的消息。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-08-07T00:00:30.230

*   独占锁或写锁为进程提供了对文件指定部分的独占访问权限。当写锁到位时，没有其他进程可以锁定文件的该部分。

*   共享锁或读锁禁止任何其他进程在文件的指定部分请求写锁。但是，其他进程可以请求读锁。

更多信息：[http ://www.gnu.org/software/libc/manual/html_node/File-Locks.html](http://www.gnu.org/software/libc/manual/html_node/File-Locks.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-22T04:05:53.117

数据库端的原理也是一样的。根据 Oracle 文档

排他锁模式防止相关资源被共享。获得这种锁定模式是为了修改数据。第一个独占锁定资源的事务是唯一可以更改资源的事务，直到独占锁定被释放。

共享锁定模式允许共享关联的资源，具体取决于所涉及的操作。读取数据的多个用户可以共享数据，持有共享锁以防止写入者（需要排他锁）并发访问。多个事务可以
获取同一资源上的共享锁。

# backbone.js - 如何检查数据是否存在于主干模型的特定字段中？

> ID：11837429
> 
> 赞同：1
> 
> 时间：2012-08-06T23:39:13.890
> 
> 标签：backbone.js, tastypie

我有一个模型。我有添加到该模型的注释。那里没有问题。

当我实例化视图时，我想看看 data.objects 是否有笔记中的内容。

我在哪里放置 if 语句？在视图渲染中？以及如何测试它。

js 和骨干菜鸟在这里，所以请原谅我错过了基础知识。

让我知道，非常感谢。

欢迎任何对教程的引用。

更新：这是我的模型的视图

```
var BlasterView = Backbone.View.extend({

    tagName: 'li',
    className: 'blaster',

    events: {

        'click .td-blaster a': 'done'

    },

    initialize: function() {

        _.bindAll(this, 'render');

    },

    render: function(){

        this.$el.html(ich.blasterTemplate(this.model.toJSON()));
        return this;

    },

    done: function(){

        this.model.toggle();

        this.$el.animate({
            backgroundColor:'#faeca9'
        }, 600 ).delay(600).fadeOut('fast');

        return false;

    }

}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T03:16:55.190

```
render: function(){

    if( this.model.get('particularField') ){
       console.log('Particular Field has a value');
    }else{
       console.log('Particular Field does NOT have a value');
    }

    this.$el.html(ich.blasterTemplate(this.model.toJSON()));
    return this;

}, 
```

如果您的意思是该字段也是一个对象的实例，只需执行此操作，检查 specificField 是否为空，并检查嵌套属性是否已设置：

```
if( this.model.get('particularField') && 
this.model.get('particularField').someChildAttr){ 
```

**更新：**

“Backbone 现在支持 has 属性”（来自：@TyroneMichael）。所以你可以使用：

```
this.model.has('particularField') 
```

# iphone - 如何根据字典的几个属性对字典数组进行排序

> ID：11837430
> 
> 赞同：2
> 
> 时间：2012-08-06T23:39:37.867
> 
> 标签：iphone, ios, nsarray, nsdictionary, nssortdescriptor

我需要使用字典中的键控对象对字典数组进行排序（尽可能接近快速排序），但是由于我的字典的复杂性（键值的数量）和可以在其中返回的数据，我需要能够根据字典中的几个键值对每个字典进行排序。

例如，假设数组 [0]、数组 [1] 中的字典键值 1 是否相等，然后检查键值 2 是否相等，如果是，则继续向下键值列表直到您可以对数组 [0] 和 [ 进行排序的两项1] 上。

我已经阅读了 NSSortDescriptor 并指定了要与可以设置升序或降序的位置进行比较的属性，但我不确定这是否可以用来实现我想要实现的目标。

我已经得到了一个我需要做的例子，但它在 delphi 中，我不是很熟悉，但是我认为这个例子对我正在尝试做的事情提供了一些见解。

```
//
Result := AnsiCompareText (left.property1, right.Property1);
if Result <> 0 then Exit;
Result := AnsiCompareText (left.property2, right.Property2);
if Result <> 0 then Exit;
Result := AnsiCompareText (left.property3, right.Property3);
if Result <> 0 then Exit;
Result := AnsiCompareText (left.property4, right.Property4);
if Result <> 0 then Exit;
Result := AnsiCompareText (left.property5, right.Property5);
if Result <> 0 then Exit;
// 
```

希望这会给您一些关于我想要实现的目标的想法，如果您知道目标 C 中的类似解决方案，我很乐意听到它的任何帮助！:P

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T00:44:37.217

假设您有一个可变数组。然后你用这个：

```
[myArray sortUsingComparator:^ NSComparisonResult(NSDictionary *d1, NSDictionary *d2)
{
  // you have two items - use whatever complex logic you want, then return
  // one of NSOrderedAscending, NSOrderedSame, NSOrderedDescending
} ]; 
```

例如，假设您只关心一个“名称”属性：

```
[myArray sortUsingComparator:^ NSComparisonResult(NSDictionary *d1, NSDictionary *d2)
{
  NSString *n1 = [d1 objectForKey:@"name"];
  NSString *n2 = [d2 objectForKey:@"name"];
  return [n1 localizedCompare:n2];
} ]; 
```

这种技术的真正好处是逻辑可以任意复杂。

# ios - GLKView快照方法：null返回val，报错

> ID：11837432
> 
> 赞同：2
> 
> 时间：2012-08-06T23:39:46.747
> 
> 标签：ios, opengl-es, uiimage

我不知道如何使用 GLKView:snapshot 方法。

我正在使用 GLKView 来渲染一些 OpenGL 的东西。一切正常；好像我已经正确设置了它。

但是，当我尝试做快照时，它失败了：我得到一个空返回值，以及以下日志消息：

错误：CGImageCreate：无效的图像大小：0 x 0。

似乎这意味着视图本身由于某种原因无效，但事实并非如此——除此之外，一切正常。

我查看了一些代码示例，但我没有做任何不同的事情。

所以……有人见过这个吗？想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T17:16:10.223

我从来没有弄清楚上述问题；但是，我找到了一个很好的解决方法。我发现这个块只是读取渲染缓冲区并将其保存到 UIImage。问题解决了！

```
- (UIImage*)snapshotRenderBuffer {

    // Bind the color renderbuffer used to render the OpenGL ES view
    // If your application only creates a single color renderbuffer which is already bound at this point, 
    // this call is redundant, but it is needed if you're dealing with multiple renderbuffers.
    // Note, replace "_colorRenderbuffer" with the actual name of the renderbuffer object defined in your class.
    glBindRenderbufferOES(GL_RENDERBUFFER_OES, viewRenderbuffer);

    NSInteger dataLength = backingWidth * backingHeight * 4;
    GLubyte *data = (GLubyte*)malloc(dataLength * sizeof(GLubyte));

    // Read pixel data from the framebuffer
    glPixelStorei(GL_PACK_ALIGNMENT, 4);
    glReadPixels(0.0f, 0.0f, backingWidth, backingHeight, GL_RGBA, GL_UNSIGNED_BYTE, data);

    // Create a CGImage with the pixel data
    // If your OpenGL ES content is opaque, use kCGImageAlphaNoneSkipLast to ignore the alpha channel
    // otherwise, use kCGImageAlphaPremultipliedLast
    CGDataProviderRef ref = CGDataProviderCreateWithData(NULL, data, dataLength, NULL);
    CGColorSpaceRef colorspace = CGColorSpaceCreateDeviceRGB();
    CGImageRef iref = CGImageCreate(
                                    backingWidth, backingHeight, 8, 32, backingWidth * 4, colorspace, 
                                    kCGBitmapByteOrder32Big | kCGImageAlphaNoneSkipLast,
                                    ref, NULL, true, kCGRenderingIntentDefault);

    // (sayeth abd)
    // This creates a context with the device pixel dimensions -- not points. 
    // To be compatible with all devices, you're meant to keep everything as points and a scale factor;  but,
    // this gives us a scaled down image for purposes of saving.  So, keep everything in device resolution,
    // and worry about it later...
    UIGraphicsBeginImageContextWithOptions(CGSizeMake(backingWidth, backingHeight), NO, 0.0f);
    CGContextRef cgcontext = UIGraphicsGetCurrentContext();
    CGContextSetBlendMode(cgcontext, kCGBlendModeCopy);
    CGContextDrawImage(cgcontext, CGRectMake(0.0, 0.0, backingWidth, backingHeight), iref);

    // Retrieve the UIImage from the current context
    UIImage *image = UIGraphicsGetImageFromCurrentImageContext();

    UIGraphicsEndImageContext();

    // Clean up
    free(data);

    return image;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T09:36:00.537

Maybe this doesn't apply in your case, but the docs for GLKView:snapshot say:

> Never call this method inside your drawing function.

# java - GWT - 编译错误：没有可用于类型的源代码

> ID：11837435
> 
> 赞同：4
> 
> 时间：2012-08-06T23:40:03.097
> 
> 标签：java, maven, gwt, compiler-errors, gwt2

我正在通过 Maven 构建 GWT 应用程序。

编译时收到以下消息：

```
Validating newly compiled units 
```

一开始有这个警告：

```
[WARNING] Don't declare gwt-dev as a project dependency. This may introduce complex dependency conflicts 
```

然后出现这个错误：

```
[ERROR] Line 19: No source code is available for type org.apache.commons.lang.StringUtils did you forget to inherit a required module? 
```

尽管这个版本没有下降，开发模式也能正常工作。我怎样才能摆脱这些错误信息？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-07T00:04:10.590

也许一个原因在您的模块文件中。您应该识别要编译的包。这是在`.gwt.xml`模块中配置的。

```
<source path="packagename"> 
```

GWT 编译器将编译包**gwtxmlmodulepath.packagename**。

[看更多](https://developers.google.com/web-toolkit/doc/latest/DevGuideOrganizingProjects#DevGuideModuleXml)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-07T00:39:03.207

该错误意味着某些客户端代码（将被编译为 javascript）包含对来自 Apache Commons 的 StringUtils 类的引用。这是不允许的，因为此库包含与 GWT 客户端不兼容的代码。

# php - MySQL 查询计数（）

> ID：11837436
> 
> 赞同：0
> 
> 时间：2012-08-06T23:40:11.480
> 
> 标签：php, mysql

当我尝试这个查询时：

```
mysql_query("SELECT COUNT(id) AS `unique`, impressions 
             FROM statistic 
             WHERE FROM_UNIXTIME(time_add, '%d.%m.%Y') = '" . date('d.m.Y', time()) . "'") or die(mysql_error()); 
```

我看到此错误消息：

> 如果没有 GROUP BY 子句，则混合没有 GROUP 列的 GROUP 列 (MIN(),MAX(),COUNT(),...) 是非法的

我不知道这是什么错误，我想有人可以在这里帮助我:)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:43:37.553

`WHERE`在子句后添加这一行

```
mysql_query("SELECT COUNT(id) AS `unique`, impressions 
             FROM statistic 
             WHERE FROM_UNIXTIME(time_add, '%d.%m.%Y') = '" . date('d.m.Y', time()) . "'
             GROUP BY impressions") or die(mysql_error()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T23:43:41.590

count 是一个组函数，除非在 group 子句中提及，否则您不能选择具有 count 的另一列。

```
 mysql_query("SELECT COUNT(id) AS `unique`, impressions FROM 
statistic WHERE FROM_UNIXTIME(time_add, '%d.%m.%Y') = '" . date('d.m.Y', time()) . "' 
GROUP BY impressions") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T23:43:57.533

当您在聚合函数中使用列时，您必须在子句`COUNT, MIN, MAX, AVG`中提及该列，如下所示：`GROUP BY`

```
mysql_query("SELECT COUNT(id) AS `unique`, impressions FROM statistic WHERE FROM_UNIXTIME(time_add, '%d.%m.%Y') = '" . date('d.m.Y', time()) . "' GROUP BY id") or die(mysql_error()); 
```

PS mysql_* 函数已弃用，使用 PDO 或 MySQLi 函数更安全，以避免 sql-injections 和其他 sql 违规。

# c# - 如何将任意数量的图像动态添加到源字符串位于数据库中的 Web 表单中？

> ID：11837440
> 
> 赞同：1
> 
> 时间：2012-08-06T23:42:04.287
> 
> 标签：c#, javascript, asp.net

您好我正在尝试为用户设置一个页面，以查看特定汽车的详细信息和与汽车相关的照片。到目前为止，我使用 sql 表来保存图像的路径，然后将每个路径作为“ImageUrl”属性分配给我手动创建的 img 标签。

我的问题是：有没有办法动态创建 img 标签并根据表中有多少相关实体相应地分配“ImageUrl”，因为图片的数量会改变？如果这是不可能的，任何人都可以提供任何替代方案吗？

我在 Web 表单的其他部分使用的脚本类型是 C#、javacript、sqlcommand。我对此很陌生，我的搜索只显示了如何在后面的代码中分配 ImageUrl，这就是我所做的。提前谢谢你。

这就是我的 img 标签：

```
 <asp:Image ID="Image1" runat="server" ImageUrl="~/Images/Default.png" />

     <asp:Image ID="Image2" runat="server" ImageUrl="~/Images/Default.png" /> 
```

这是背后的代码：

```
 List<string> folder = new List<string>();

        while (readerPhoto.Read())
        {
            folder.Add(readerPhoto["Folder"].ToString());
        }

        switch (folder.Count)
        { 
            case 1:
                Image1.ImageUrl = folder[0];
                break;
            case 2:
                Image1.ImageUrl = folder[0];
                Image2.ImageUrl = folder[1];
       //and so fourth....... 
```

2012 年 8 月 7 日。新的尝试代码（图像是动态创建的，但“src”属性未正确分配）：

```
 .aspx 
   <asp:SqlDataSource ID="SqlDataSource1" runat="server" ConnectionString="<%$ ConnectionStrings:CarsConnectionString %>"
        SelectCommand="SELECT Folder FROM Cars INNER JOIN Photos ON Cars.SN = Photos.Cars_SN WHERE (Cars.SN = @SN)">
        <SelectParameters>
            <asp:QueryStringParameter DefaultValue="SN" Name="SN" QueryStringField="SN" />
        </SelectParameters>
    </asp:SqlDataSource>
    <asp:ListView ID="lvPhotos" runat="server" DataSourceID="SqlDataSource1">
        <ItemTemplate>
            <asp:Image ID="imgListImage" runat="server" ImageUrl='<% Eval("Folder") %>' />
        </ItemTemplate>
    </asp:ListView> 
```

Html 输出一个损坏的图像图标和脚本：

```
 <img id="MainContent_ListView1_imgListImage_0" src="<%%20Eval("Folder")%20%>" style="width: 80px; height: 80px; "> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:02:20.270

您需要使用数据绑定标记语法（注意`#`）：

```
<ItemTemplate>
    <asp:Image ID="imgListImage" runat="server" ImageUrl='<%# Eval("Folder") %>' />
</ItemTemplate> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T23:53:01.180

编辑：不知何故，我错过了你使用 sql 表而不是文件。编辑 2：固定绑定错误

基本上你根本不需要任何代码。您需要 SqlDataSource 和 ListView 并将第二个绑定到第一个。

```
.aspx

<asp:SqlDataSource id="SqlDataSource1"
      runat="server"
      ConnectionString="<%$ ConnectionStrings:MyConnString%>"
      SelectCommand="SELECT * FROM Table">
  </asp:SqlDataSource>

<asp:ListView ID="lvImages" runat="server" DataSource="SqlDataSource1">
   <ItemTemplate>
       <asp:Image ID="imgListImage" runat="server" ImageUrl='<%# Eval("Folder") %>' />
   </ItemTemplate>
</asp:ListView> 
```

[msdn 上的 ListView](http://msdn.microsoft.com/en-us/library/bb398790.aspx)

# ssh - SSH 合并同名文件夹 - 复制整个文件夹结构

> ID：11837441
> 
> 赞同：0
> 
> 时间：2012-08-06T23:42:07.853
> 
> 标签：ssh, command

我有一个像这样非常烦人的树结构的模块

```
APP  -CODE    - COMMUNITY - VB - FILE 1
                                - FILE 2        
     -DESIGN - ADMIN - DEFAULT - FILES
             - FRONTEND - DEFAULT - MORE FILES 
```

现有应用程序已经有一个 APP 文件夹，该文件夹共享一些沿树的相同文件夹名称。

该应用程序当前已解压缩到一个名为 __MACOSX 的文件夹中，我尝试使用`sudo mv __MACOSX/*`命令复制内容，但它显示“无法移动...目录不为空”。

我的 FTP 程序只会将所有文件添加到它们的目录中，并询问是否要覆盖任何重复的文件。在这台新服务器上，我只有 SSH 访问权限，所以我想知道是否有办法跨文件夹复制以便它们填充 APP 中的目录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T03:11:36.163

您可以在命令中使用递归 ( `-R`) 标志来`cp`执行您想要的操作。例如，如果我有：

```
__MACOSX/
  dir1/file1
  dir1/file2
  dir2/file3 
```

我有：

```
app/
  dir1/ 
```

然后我可以运行：

```
cp -R __MACOSX/* app/ 
```

我最终会得到：

```
app
app/dir1
app/dir1/file1
app/dir1/file2
app/dir2
app/dir2/file3 
```

...这就是我认为你想要做的。

# c# - 使用 webdriver 和弹出窗口进行 http 授权

> ID：11837442
> 
> 赞同：1
> 
> 时间：2012-08-06T23:42:20.790
> 
> 标签：c#, selenium-webdriver

我正在尝试使用[Selenium WebDriver](http://seleniumhq.org/projects/webdriver/)使用用户名和密码自动登录到站点。我已经完成了我的研究，我不相信 WebDriver 支持这个功能，所以我需要找到另一种方法。我尝试自动登录的站点位于[此处](https://portal.adp.com/public/index.htm)。

当提示登录时，会出现一个似乎不是浏览器一部分的弹出窗口。我正在使用 Firefox 和 Chrome。似乎可能需要 Windows API？我已经尝试在 URL 中传递凭据，但这不起作用。还尝试了 sendkeys，但收到了应用程序不接受 Windows 消息的 Windows 异常。我也尝试切换当前`handle`使用`driver.windowhandles`，但弹出窗口似乎不是新句柄。

有人有什么想法吗？我有点卡住了。进入弹出窗口的初步代码是：

```
IWebDriver driver = new FirefoxDriver();
driver.Navigate().GoToUrl("http://www.portal.adp.com");
string currentWindow = driver.CurrentWindowHandle;
IWebElement userLogin = driver.FindElement(By.Id("employee"));
userLogin.Click(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T05:35:38.637

您看到的弹出窗口由 Web 服务器提示，是一个身份验证提示。Selenium 不支持此操作。

处理此限制的一种方法是在 url 中传递用户和密码，如下所示：

`http://user:password@example.com`

更多信息在这里：[http ://aleetesting.blogspot.in/2011/10/selenium-webdriver-tips.html](http://aleetesting.blogspot.in/2011/10/selenium-webdriver-tips.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-28T20:00:02.350

我想要我的答案，因为我想我已经解决了。此答案不需要通过 URL 传递凭据（对于那些无法喜欢我的人）。它也不需要安装或包含在解决方案中或安装到浏览器上的任何自定义 Firefox 配置文件或扩展，从而消除了跨机器兼容性问题。

我的问题是无法通过通过 URL 传递凭据来完成身份验证，因为登录位于代理后面。

所以，我转向 Windows 自动化工具包并找到了 AutoIT。使用 AutoIT 和 Selenium，您可以通过将用户名和密码发送到出现的 Windows 对话框来自动登录。方法如下（注意以下步骤适用于 c#：

[1 - 从http://www.autoitscript.com/site/autoit/downloads/](http://www.autoitscript.com/site/autoit/downloads/)下载 AutoIT

2 - 将 autoit .dll 添加到您的项目引用中。

右键单击引用，选择添加引用。接下来单击浏览按钮并浏览到 dll 位置（大多数默认安装将是 c:\Program Files (x86)\AutoIt3\AutoItX\AutoItX3.dll），然后添加到项目中。

3 - 像这样使用 AutoIT 和 Selenium（假设您的 Web 驱动程序已经初始化）：

```
 //Initialize AutoIT
    var AutoIT = new AutoItX3();

    //Set Selenium page load timeout to 2 seconds so it doesn't wait forever
    Driver.Manage().Timeouts().SetPageLoadTimeout(TimeSpan.FromSeconds(2));

    //Ingore the error
    try
    {
      Driver.Url = url;
    }
    catch
    {
      return;
    }

    //Wait for the authentication window to appear, then send username and password
    AutoIT.WinWait("Authentication Required");
    AutoIT.WinActivate("Authentication Required");
    AutoIT.Send("username");
    AutoIT.Send("{TAB}");
    AutoIt.Send("password");
    AutoIT.Send("{ENTER}");

    //Return Selenium page timeout to infinity again
    Driver.Manage().Timeouts().SetPageLoadTimeout(TimeSpan.FromSeconds(-1)); 
```

无论如何，就是这样，它就像一个魅力:)

另请注意，有些特殊字符需要在 AutoIT 中使用序列“{x}”进行转义。例如，如果您的密码是“!tRocks”，则需要将其作为“{!}tRocks”传递给 AutoIT。

快乐的自动化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-03T14:25:17.613

```
 FirefoxProfile profile = new FirefoxProfile();
   profile.SetPreference("network.http.phishy-userpass-length", 255);
   profile.SetPreference("network.automatic-ntlm-auth.trusted-uris", hostname);
   Driver = new FirefoxDriver(profile); 
```

主机名是您的 URL (example.com) 然后尝试

```
Driver.Navigate().GoToUrl(http://user:password@example.com); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-17T02:00:18.933

我刚刚完成了一个原型项目的工作，该项目应该能够准确处理这种情况。

它利用流行的开源代理 BrowserMob 来执行身份验证。

[SeleniumBasicAuthWrapper](https://sourceforge.net/projects/seleniumbasicauthwrapper/?source=navbar) 希望对您有所帮助！它仍在进行中，但希望我们能在不久的将来解决任何问题或缺陷。

# python - python中的类实例化和“自我”

> ID：11837447
> 
> 赞同：5
> 
> 时间：2012-08-06T23:42:52.347
> 
> 标签：python, class, function, instantiation, self

我知道关于这个主题已经写了很多。但是，我无法吸收其中的大部分内容。也许是因为我是一个完全的新手，在没有任何计算机科学培训的情况下自学。无论如何，也许如果你们中的一些有头脑的人在这个特定的例子中加入进来，你会帮助像我这样的其他初学者。

因此，我编写了以下函数，当我调用它（作为一个模块？）时它工作得很好，因为它是一个名为“funky.py”的文件：

我在终端中输入以下内容：

```
python classy.py 
```

它运行良好。

```
def load_deck():
    suite = ('Spades', 'Hearts')
    rank = ('2', '3')
    full_deck = {}
    i = 0
    for s in suite:
        for r in rank:
            full_deck[i] = "%s of %s" % (r, s)
            i += 1
    return full_deck

print load_deck() 
```

但是，当我将相同的函数放在一个类中时，我得到了一个错误。

这是我的“classy.py”代码：

```
class GAME():
    def load_deck():
        suite = ('Spades', 'Hearts')
        rank = ('2', '3')
        full_deck = {}
        i = 0
        for s in suite:
            for r in rank:
                full_deck[i] = "%s of %s" % (r, s)
                i += 1
        return full_deck
MyGame = GAME()
print MyGame.load_deck() 
```

我收到以下错误：

```
Traceback (most recent call last):
File "classy.py", line 15, in <module>
print MyGame.load_deck()
TypeError: load_deck() takes no arguments (1 given) 
```

因此，我将定义行更改为以下内容，它工作正常：

```
def load_deck(self): 
```

将函数放在需要使用“自我”的类中是什么意思。我知道“自我”只是一个约定。那么，为什么需要任何论证呢？当从类中调用函数时，它们的行为是否不同？

另外，这几乎更重要，为什么我的课程没有使用**init**的好处？使用**init**会为我的班级做什么？

基本上，如果有人有时间像我 6 岁一样向我解释这一点，那会有所帮助。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T23:46:14.790

在类定义中定义一个函数会调用一些将其转换为方法描述符的魔法。当您访问 foo.method 时，它将自动创建一个绑定方法并将对象实例作为第一个参数传递。您可以通过使用 @staticmethod 装饰器来避免这种情况。

`__init__`只是在创建类以进行可选设置时调用的方法。`__new__`是实际创建对象的内容。

这里有些例子

```
>>> class Foo(object):
    def bar(*args, **kwargs):
        print args, kwargs

>>> foo = Foo()
>>> foo.bar
<bound method Foo.bar of <__main__.Foo object at 0x01C9FEB0>>
>>> Foo.bar
<unbound method Foo.bar>
>>> foo.bar()
(<__main__.Foo object at 0x01C9FEB0>,) {}
>>> Foo.bar()

Traceback (most recent call last):
  File "<pyshell#29>", line 1, in <module>
    Foo.bar()
TypeError: unbound method bar() must be called with Foo instance as first argument (got nothing instead)
>>> Foo.bar(foo)
(<__main__.Foo object at 0x01C9FEB0>,) {} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T00:26:55.553

> 那么，为什么需要任何论证呢？

访问类的当前实例的属性。

假设您有一个具有两种方法的类，`load_deck`并且`shuffle`. 最后`load_deck`你想洗牌（通过调用`shuffle`方法）

在 Python 中，你会做这样的事情：

```
class Game(object):
    def shuffle(self, deck):
        return random.shuffle(deck)

    def load_deck(self):
        # ...

        return self.shuffle(full_deck) 
```

将此与大致等效的 C++ 代码进行比较：

```
class Game {
    shuffle(deck) {
        return random.shuffle(deck);
    }
    load_deck() {
        // ...

        return shuffle(full_deck)
    }
} 
```

在线`shuffle(full_deck)`上，首先它查找一个名为的局部变量`shuffle`- this 不存在，然后它检查更高级别，并找到一个名为的实例方法`shuffle`（如果它不存在，它将检查全局变量正确的名字）

这没关系，但不清楚`shuffle`是指某个局部变量还是实例方法。为了解决这种歧义，实例方法或实例属性也可以通过以下方式访问`this`：

```
...
load_deck() {
    // ...

    return this->shuffle(full_deck)
} 
```

`this`几乎与 Python 的 self 相同，只是它没有作为参数传递。

为什么有用`self`的论点是有用的？[FAQ 列出了几个很好的理由](http://docs.python.org/faq/design.html#why-self)——这些可以用[“Python 之禅”中的一句话](http://www.python.org/dev/peps/pep-0020/)来概括：

```
Explicit is better than implicit. 
```

这得到了[Python 历史](http://python-history.blogspot.co.uk/2009/02/adding-support-for-user-defined-classes.html)博客中的一篇文章的支持，

> 我决定放弃隐式引用实例变量的想法。像 C++ 这样的语言允许您编写 this->foo 来显式引用实例变量 foo（以防有单独的局部变量 foo）。因此，我决定让这种显式引用成为引用实例变量的唯一方法。此外，我决定与其将当前对象（“t​​his”）设为特殊关键字，不如简单地将“this”（或其等价物）设为方法的第一个命名参数。实例变量总是作为该参数的属性被引用。
> 
> 使用显式引用，不需要为方法定义使用特殊的语法，也不必担心与变量查找有关的复杂语义。相反，人们只是简单地定义一个函数，它的第一个参数对应于实例，按照惯例，它被命名为“self”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-31T23:30:01.153

如果您不打算使用**self**您可能应该将该方法声明为**staticmethod**。

```
class Game:
    @staticmethod
    def load_deck():
        .... 
```

这取消了自动默认打包，该打包通常将**类**范围内的函数转换为以实例作为参数的方法。

传递你不使用的参数会让其他试图阅读你的代码的人感到不安。

大多数班级都有成员。你的没有，所以它的所有方法都应该是静态的。随着项目的发展，您可能会发现其中的所有函数都应该可以访问的数据，然后将它们放入**self**中，并将其传递给所有函数。

在这种情况下，应用程序本身是您的主要对象，**__init__**只是初始化所有这些共享值的函数。

这是迈向面向对象风格的第一步，其中较小的数据片段本身被用作对象。但这是从直接脚本转向 OO 编程的正常阶段。

# windows - How to inject a Windows API call use ollydbg in Windows7 x64

> ID：11837458
> 
> 赞同：1
> 
> 时间：2012-08-06T23:43:37.793
> 
> 标签：windows, debugging, process, cracking, ollydbg

I am using Windows7 x64, and OllyDbg 2.01(alpha 2)

I have an exe, and I want to popup a MessageBox to show some information during execution, and there is a great tutorial shows you how to do this: [How to inject code into a exe file](http://home.inf.fh-rhein-sieg.de/~ikarim2s/how2injectcode/code_inject.html), basically, it is about adding a MessageBoxA API call with the wanted information:

```
PUSH 0                 ; BUTTONS = <OK ONLY>
PUSH 1008751           ; CAPTION  = Our adress of the "INJECTED NOTEPAD"
PUSH 1008751           ; MESSAGE  = Same like above.
PUSH 0                 ; ICON        = <NO ICON>
CALL MessageBoxA       ; Run MessageBoxA with the Params above. 
```

It does work when in live debug session: I injected the code, and then debug it - the message box does pops up. But after I save the executable (RMB->Edit->Select all; RMB->Edit->Copy to executable; In the new window, RMB->save file), and then execute, it just crashed.

Here are what I've observed:

> Before save, the CALL MessageBoxA is actually CALL 74DAFD1E, which means 74DAFD1E is the address of API MessageBoxA, but after save, the address is changed to some other value.

Also, do you think [ASLR](http://en.wikipedia.org/wiki/Address_space_layout_randomization) would virtually stop up from injecting windows API call?

Any ideas? how could I managed to show the information I wanted from that exe?
Thanks in advance!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T14:07:12.897

This is caused by ASLR, to make it work in Windows7, one approach is to disable ASLR (at your own risk).

You can download the [Enhanced Mitigation Experience Toolkit (EMET)](http://support.microsoft.com/kb/2458544) tool, install and run EMET_GUI.exe, in the pop up dialog, disable the ASLR and reboot: ![EMET GUI](../Images/f04f388af1f780c54e82cf53137978d8.png)

You may want to re-enable ASLR after finishing your work, as it has impact on your OS's security.

# javascript - JS函数不返回值

> ID：11837461
> 
> 赞同：0
> 
> 时间：2012-08-06T23:44:04.213
> 
> 标签：javascript

我在 Game.js 中有这个功能

```
Game.prototype.onClick = function(event){
     var x = event.x;
     var y = event.y;
     if (this.blueDeck[0].contains(x, y)) 
       alert("Blue Deck Clicked");
} 
```

*在 Main.js 中从此函数调用*OnClick**

 *```
canvas.addEventListener('mouseup', game.onClick, false); 
```

我在 Card.js 中有这个功能

```
Card.prototype.contains = function(x, y){
    return true;
} 
```

警报永远不会出现。

如果我删除*onClick*中的 if 语句，则会调用警报。`this.blueDeck[0].setDeckPos(w, h);`在 Game.js 中调用时，其他功能（例如）可以正常工作。

为什么*contains*不返回 true？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T23:56:03.417

更新证实了我的假设。`this`将引用 DOM 元素。的值`this`在运行时确定，即它取决于函数的调用*方式*，而不是定义的位置/方式。

要么使用闭包：

```
canvas.addEventListener('mouseup', function(event) {
    game.onClick(event);
}, false); 
```

或者如果您不需要访问该元素，您可以使用[`.bind` *^([MDN])*](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)（请参阅此链接以获取不支持本机支持的浏览器的 polyfill）：

```
canvas.addEventListener('mouseup', game.onClick.bind(game), false); 
```

了解更多`this`：

*   [MDN -`this`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)（一般）
*   [quirksmode.org -`this`](http://www.quirksmode.org/js/this.html)（强调事件处理程序）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T23:58:36.767

OP 的一个简单示例有效，因此错误在其他地方：

```
function Game(){
  this.blueDeck = [new Card()];
}

Game.prototype.onClick = function(event){
     var x;
     var y;
     if (this.blueDeck[0].contains(x, y)) 
       alert("Blue Deck Clicked");
}

function Card(){}

Card.prototype.contains = function(x, y){
    return true;
}

var g = new Game();
g.onClick(); // "Blue Deck Clicked" 
```

## 编辑

编辑问题时，请清楚地标记编辑。请参阅 Felix 的回答，该方法不是由 Game 的实例调用，而是由事件侦听器调用。请记住，*这*是由调用设置的。*

# cocoa-touch - 将当前绘制到视图中的内容保存为图像

> ID：11837464
> 
> 赞同：1
> 
> 时间：2012-08-06T23:44:20.270
> 
> 标签：cocoa-touch, drawing

我正在创建一个绘图应用程序并遇到了问题。我有一系列曲线；每条曲线都有一个点数组，每个点都保持它的颜色、粗细和坐标。

当我`drawRect:`被调用时，我会重新绘制这个数组中的所有曲线。问题是这个数组变得越来越大，应用程序变慢了。

我的想法是，在每次重绘结束时，将当前上下文保存为图像，释放曲线数组，然后在下一次重绘时，使用该图像作为背景。最终，我根本不需要曲线数组，只需要一个正在进行的曲线数组。这可能吗？或者也许还有另一种方法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T00:03:14.863

您可以将视图的相应层渲染为图像以在下一次迭代中更新。当然，在这种情况下使用`UIImageView`yourViewToSaveAsImage 会更好。在这种情况下，您可以更轻松地完成此过程......

```
UIView *view = yourViewToSaveAsImage;

UIGraphicsBeginImageContext(view.bounds.size);
[view.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage *result = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T23:53:42.043

路径仅包含有关点的信息，因此如果您想跟踪渲染的变化，您需要一个单独的对象列表。

我通过创建一个`NSArray*`我自己的自定义对象来实现这一点，其中包括以下字段：an `NSBezierPath*`（用于捕获点并简化绘制线段）、`CGPathDrawingMode`用于线段的 a 以及有关颜色和线条大小的信息。

然后，当我绘制时，我遍历数组的元素，设置上下文的当前颜色，并根据我配置该段的方式调用当前元素`stroke`或`fill`当前元素。`NSBezierPath*`

我也想知道是否有更快的方法，但这种方法肯定效果很好。

# android - 为什么使用 android-support-v4 时找不到 android.util.LruCache.*？

> ID：11837465
> 
> 赞同：5
> 
> 时间：2012-08-06T23:44:20.360
> 
> 标签：android, android-support-library, android-2.3-gingerbread, android-lru-cache

我正在编写一个使用 LruCache 的项目，该项目包含在 android-support-v4.jar 兼容库中。在带有 JB 的设备上运行时，代码运行良好，但是当我在带有 GB 的 Droid X 上运行它时，应用程序因以下错误而死：

```
I/dalvikvm(2459): Could not find method android.util.LruCache.put, referenced from method blah.blah.Utility.getBitmap
W/dalvikvm(2459): VFY: unable to resolve virtual method 2641: Landroid/util/LruCache;.put (Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
D/dalvikvm(2459): VFY: replacing opcode 0x6e at 0x0026
... [repeats similar lines] ...
W/dalvikvm(2459): Unable to resolve superclass of Lblah/blah/Utility$1; (353)
W/dalvikvm(2459): Link of class 'Lblah/blah/Utility$1;' failed
E/dalvikvm(2459): Could not find class 'blah.blah.Utility$1', referenced from method blah.blah.Utility.initCaches
W/dalvikvm(2459): VFY: unable to resolve new-instance 559 (Lblah/blah/Utility$1;) in Lblah/blah/Utility;
D/dalvikvm(2459): VFY: replacing opcode 0x22 at 0x000d
D/dalvikvm(2459): VFY: dead code 0x000f-002c in Lblah/blah/Utility;.initCaches (ILandroid/content/Context;)V
I/dalvikvm(2459): Could not find method android.util.LruCache.get, referenced from method blah.blah.Utility.mCacheGet
W/dalvikvm(2459): VFY: unable to resolve virtual method 2640: Landroid/util/LruCache;.get (Ljava/lang/Object;)Ljava/lang/Object;
D/dalvikvm(2459): VFY: replacing opcode 0x6e at 0x0008
D/dalvikvm(2459): VFY: dead code 0x000b-000e in Lblah/blah/Utility;.mCacheGet (Ljava/lang/String;)Landroid/graphics/Bitmap;
... [repeats similar lines] ...
D/AndroidRuntime(2459): Shutting down VM
W/dalvikvm(2459): threadid=1: thread exiting with uncaught exception (group=0x40018560)
E/AndroidRuntime(2459): FATAL EXCEPTION: main
E/AndroidRuntime(2459): java.lang.NoClassDefFoundError: blah.blah.Utility$1
E/AndroidRuntime(2459):     at blah.blah.Utility.initCaches(Utility.java:49)
E/AndroidRuntime(2459):     at blah.blah.MainActivity.onCreate(MainActivity.java:40)
... [etc] ...
W/ActivityManager(1318):   Force finishing activity blah.blah/.MainActivity 
```

Utility.java:49 看起来像这样：

```
 mCache = new LruCache<String, Bitmap>( mCacheSize )   // <-- line 49 --
    {
        @Override
        protected int sizeOf( String key, Bitmap bitmap )
        {
            return bitmap.getByteCount();
        }
    }; 
```

所以我在任何地方引用 LruCache 或其方法都会导致错误。首先想到的是 android-support-v4.jar 不知何故被排除在 APK 文件之外，但事实并非如此。我将jar文件放在libs/下，运行ant debug后检查classes.dex.d，我看到它添加了以下行：

```
/home/paul/workspace/blah/libs/android-support-v4.jar \ 
```

我的第二个想法是，也许 LruCache 不在 android-support-v4 中，但是查看源代码我看到下面的源文件在那里，并且它具有我正在尝试使用的方法：

```
/home/paul/bin/android-sdk/extras/android/support/v4/src/java/android/support/v4/util/LruCache.java 
```

那为什么找不到呢？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-06T23:52:21.250

支持库中的类使用不同的命名空间。

您需要导入：

```
import android.support.v4.util.LruCache; 
```

或者，您可以将 LruCache.java 直接复制并编译到您的应用程序中。

# php - mongodb $OR 语句

> ID：11837468
> 
> 赞同：0
> 
> 时间：2012-08-06T23:45:19.647
> 
> 标签：php, mongodb

我对以下 MongoDB PHP 脚本有一个小问题

```
$collection = $this->db->retail_details;
        $array = array('$OR'=>array(
            "salesperson"=>new MongoId($uid),
            "Manager"=>new MongoId($uid)
        ));
        $cursor = $collection->find($array); 
```

我有所有的销售人员和经理行，我正在为经理发送正确的 $UID，它不会与销售人员匹配，但它仍应返回数据，因为它与经理 MongoID 匹配。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T05:57:29.787

mongodb 中的运算符区分大小写。所以你应该使用“$or”而不是“$OR”。但我认为您的查询也不正确，因为 "$or" 需要一个索引数组作为它的条件：

```
$collection = $this->db->retail_details;
$array = array('$or'=>array(
    array("salesperson"=>new MongoId($uid)),
    array("Manager"=>new MongoId($uid))
));
$cursor = $collection->find($array); 
```

在我看来，这应该有效。

# c++ - 如何将表驱动的 CRC 实现转换为按位实现？

> ID：11837478
> 
> 赞同：2
> 
> 时间：2012-08-06T23:46:55.310
> 
> 标签：c++, crc

我有一些需要测试的 CRC 方法。这些方法不是我自己写的。我认为最好的方法是使用不同的技术实现 CRC 算法，然后比较结果。

目前所有的 CRC 例程都以表格驱动的格式编写。我似乎找不到任何教程来解释如何将代码转换为按位实现。我确定这是我对 CRC 的工作原理缺乏了解。

如果有人可以提供一个相同的 CRC 例程的示例，实现了 2 种不同的方式，那就太好了。我在互联网上进行了搜索，并没有发现很多对我的问题有帮助的东西。

这是我需要测试的一种 CRC 算法的示例代码：

```
// This table implements the EPO CRC16 algorithm with a polynomial of 0x17531
static const uint16 s_EPOCRC16Table[] =
{
   0x0000U, 0x7531U, 0xEA62U, 0x9F53U, 0xA1F5U, 0xD4C4U, 0x4B97U, 0x3EA6U,
   0x36DBU, 0x43EAU, 0xDCB9U, 0xA988U, 0x972EU, 0xE21FU, 0x7D4CU, 0x087DU,
   0x6DB6U, 0x1887U, 0x87D4U, 0xF2E5U, 0xCC43U, 0xB972U, 0x2621U, 0x5310U,
   0x5B6DU, 0x2E5CU, 0xB10FU, 0xC43EU, 0xFA98U, 0x8FA9U, 0x10FAU, 0x65CBU,
   0xDB6CU, 0xAE5DU, 0x310EU, 0x443FU, 0x7A99U, 0x0FA8U, 0x90FBU, 0xE5CAU,
   0xEDB7U, 0x9886U, 0x07D5U, 0x72E4U, 0x4C42U, 0x3973U, 0xA620U, 0xD311U,
   0xB6DAU, 0xC3EBU, 0x5CB8U, 0x2989U, 0x172FU, 0x621EU, 0xFD4DU, 0x887CU,
   0x8001U, 0xF530U, 0x6A63U, 0x1F52U, 0x21F4U, 0x54C5U, 0xCB96U, 0xBEA7U,
   0xC3E9U, 0xB6D8U, 0x298BU, 0x5CBAU, 0x621CU, 0x172DU, 0x887EU, 0xFD4FU,
   0xF532U, 0x8003U, 0x1F50U, 0x6A61U, 0x54C7U, 0x21F6U, 0xBEA5U, 0xCB94U,
   0xAE5FU, 0xDB6EU, 0x443DU, 0x310CU, 0x0FAAU, 0x7A9BU, 0xE5C8U, 0x90F9U,
   0x9884U, 0xEDB5U, 0x72E6U, 0x07D7U, 0x3971U, 0x4C40U, 0xD313U, 0xA622U,
   0x1885U, 0x6DB4U, 0xF2E7U, 0x87D6U, 0xB970U, 0xCC41U, 0x5312U, 0x2623U,
   0x2E5EU, 0x5B6FU, 0xC43CU, 0xB10DU, 0x8FABU, 0xFA9AU, 0x65C9U, 0x10F8U,
   0x7533U, 0x0002U, 0x9F51U, 0xEA60U, 0xD4C6U, 0xA1F7U, 0x3EA4U, 0x4B95U,
   0x43E8U, 0x36D9U, 0xA98AU, 0xDCBBU, 0xE21DU, 0x972CU, 0x087FU, 0x7D4EU,
   0xF2E3U, 0x87D2U, 0x1881U, 0x6DB0U, 0x5316U, 0x2627U, 0xB974U, 0xCC45U,
   0xC438U, 0xB109U, 0x2E5AU, 0x5B6BU, 0x65CDU, 0x10FCU, 0x8FAFU, 0xFA9EU,
   0x9F55U, 0xEA64U, 0x7537U, 0x0006U, 0x3EA0U, 0x4B91U, 0xD4C2U, 0xA1F3U,
   0xA98EU, 0xDCBFU, 0x43ECU, 0x36DDU, 0x087BU, 0x7D4AU, 0xE219U, 0x9728U,
   0x298FU, 0x5CBEU, 0xC3EDU, 0xB6DCU, 0x887AU, 0xFD4BU, 0x6218U, 0x1729U,
   0x1F54U, 0x6A65U, 0xF536U, 0x8007U, 0xBEA1U, 0xCB90U, 0x54C3U, 0x21F2U,
   0x4439U, 0x3108U, 0xAE5BU, 0xDB6AU, 0xE5CCU, 0x90FDU, 0x0FAEU, 0x7A9FU,
   0x72E2U, 0x07D3U, 0x9880U, 0xEDB1U, 0xD317U, 0xA626U, 0x3975U, 0x4C44U,
   0x310AU, 0x443BU, 0xDB68U, 0xAE59U, 0x90FFU, 0xE5CEU, 0x7A9DU, 0x0FACU,
   0x07D1U, 0x72E0U, 0xEDB3U, 0x9882U, 0xA624U, 0xD315U, 0x4C46U, 0x3977U,
   0x5CBCU, 0x298DU, 0xB6DEU, 0xC3EFU, 0xFD49U, 0x8878U, 0x172BU, 0x621AU,
   0x6A67U, 0x1F56U, 0x8005U, 0xF534U, 0xCB92U, 0xBEA3U, 0x21F0U, 0x54C1U,
   0xEA66U, 0x9F57U, 0x0004U, 0x7535U, 0x4B93U, 0x3EA2U, 0xA1F1U, 0xD4C0U,
   0xDCBDU, 0xA98CU, 0x36DFU, 0x43EEU, 0x7D48U, 0x0879U, 0x972AU, 0xE21BU,
   0x87D0U, 0xF2E1U, 0x6DB2U, 0x1883U, 0x2625U, 0x5314U, 0xCC47U, 0xB976U,
   0xB10BU, 0xC43AU, 0x5B69U, 0x2E58U, 0x10FEU, 0x65CFU, 0xFA9CU, 0x8FADU,
};

/**
 * This routine returns the CRC-16 of Cp_ptr.
 * This CRC routine is reversed to match the routine used in the EPO.
 *
 * @param  const uint8 *Cp_ptr - data pointer to the bit string to be calculated over
 * @param  const uint32 Len    - the number of bytes pointed to by Cp_ptr
 * @return the calculated 16-bit CRC
 * @ureq
 *    -# epoCRC16() shall calculate a 16-bit CRC on a block of data starting at an address of a specified length.
 *    -# epoCRC16() shall ASSERT if the passed in pointer is NULL.
 */
uint16 epoCRC16( const uint8 *Cp_ptr, const uint32 Len )
{
   ASSERT( Cp_ptr != NULL );

   // local variable
   uint16 crc = 0x0;

   // calculate the crc
   for ( uint16 i = Len; i > 0; i-- )
   {
      const uint8 TableIndex = ( *Cp_ptr ^ static_cast<uint8>( crc >> 8 ) );
      crc = static_cast<uint16>( crc << 8 );
      crc = ( crc ^ s_EPOCRC16Table[TableIndex] );
      Cp_ptr++;
   }

   return crc;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T02:31:53.293

您首先需要 CRC 多项式，您可以在此类表的第二个条目或第 128 个条目中找到它，具体取决于 CRC 的位顺序。或者在这种情况下，您可以在评论中找到它`0x17531`。`1`后面是多项式的`x`第一项，它简单地定义了 CRC 的长度。它在计算中被删除。您可以`0x7531`在表格的第二个条目中找到。

此例程（在 C 中）仅使用多项式生成上表：

```
void make_crc_table(unsigned poly, unsigned *table)
{
    unsigned n, k, crc;

    for (n = 0; n < 256; n++) {
        crc = n << 8;
        for (k = 0; k < 8; k++)
            crc = crc & 0x8000 ? (crc << 1) ^ poly : crc << 1;
        table[n] = crc & 0xffff;
    }
} 
```

它会被这样称呼：`make_crc_table(0x7531, table)`where`table`是一个由 256 个无符号整数组成的数组。

逐位 CRC 例程看起来大致相同：

```
unsigned epobit(unsigned char *buf, unsigned len, unsigned poly)
{
    unsigned n, k, crc = 0;

    for (n = len; n > 0; n--) {
        crc ^= (*buf++ << 8);
        for (k = 0; k < 8; k++)
            crc = crc & 0x8000 ? (crc << 1) ^ poly : crc << 1;
    }
    return crc & 0xffff;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T02:36:17.673

对于工具，请查看[pycrc](http://www.tty1.net/pycrc/index_en.html)，它具有用于任意 CRC 的代码生成器。

有关 CRC 计算的说明，请参阅[A Painless Guide to CRC Error Detection Algorithms](http://www.ross.net/crc/download/crc_v3.txt)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T14:59:59.983

```
// Bitise and tablewise CRC-16 can be compared by following source code with polynomial 0x17531 !

// CRC.cpp : 
//

#include "stdafx.h"
#include "CRC.h"

#include "afx.h"
#include <conio.h>

#ifdef _DEBUG
#define new DEBUG_NEW
#endif

CWinApp theApp;

using namespace std;

#define BUFLENGTH (0x100000*1)  //0x100000=1MB

void makeCRC16Table();
void crc16update(unsigned short &crc0, const void *data, int length);
void crc16updateBitwise(unsigned short &crc0, const void *data, int length);

static byte crc8Table[256];
static unsigned short crc16Table[256];
static unsigned long crc32Table[256];

int _tmain(int argc, TCHAR* argv[], TCHAR* envp[])
{
    int nRetCode = 0;

    unsigned char crc8=0x00;
    unsigned short crc16=0x0000;
    unsigned long crc32=0x00000000;

    byte *dataBuf = new byte[BUFLENGTH];
    if(dataBuf==0)
    {
        cout<<"Not enough memory allocation to dataBuf[] !";
        while(!_kbhit());
        return nRetCode;
    }
    for(int i=0; i<BUFLENGTH; i++)
        dataBuf[i]=i+1;

    makeCRC16Table();
    crc16=0x00;
    crc16update(crc16, dataBuf, BUFLENGTH);
    crc16=0x00;
    crc16updateBitwise(crc16, dataBuf, BUFLENGTH);

    delete[] dataBuf;

    while(!_kbhit());

    }

    return nRetCode;
}

void makeCRC16Table()
{
    /* generate a table for a byte-wise 16-bit CRC caculation on the polynomial ;
      */
    CString soutputfile=_T("crc16Table.txt");
    CString soutputbuffer;
    CStdioFile fileTarget( soutputfile, CFile::modeCreate | CFile::modeWrite );
    int i,j;
    unsigned long poly, cc;
    /* terms of polynomial defining this crc (except x^16) */
    //static const byte pp[]={0,5,12};
    static const byte pp[]={0,2,15};

    /* make exclusive-or pattern from polynomial 0x1021 */
    poly=0;
    //for(i=0; i<sizeof(pp)/sizeof(byte); i++) 
    //  poly|=1<<pp[i];
    poly=0x7531;
    //poly=0x1021;
    //poly=0x8005;

    for(i=0; i<256; i++) {
        cc=i<<8; 
        for(j=0; j<8; j++) {
            cc=(cc&0x8000)?(poly^(cc<<1)):(cc<<1);  //MSB first transmission

        }
        crc16Table[i]=cc&0xffff;

        soutputbuffer.Format("%3d:%04X\n", i, crc16Table[i]);
        fileTarget.WriteString(soutputbuffer);
    }
    fileTarget.Close();
    //ShellExecute(NULL, NULL, soutputfile, NULL, NULL, SW_SHOWNORMAL);
}

void crc16update(unsigned short &crc0, const void *data, int length)
{
    CString soutputfile=_T("crc16.txt");
    cout<<"\n"<<soutputfile<<"\n";

    CString soutputbuffer, soutputbufferTotal;
    CStdioFile fileTarget( soutputfile, CFile::modeCreate | CFile::modeWrite );

    int percentage=0, ntemp;
    unsigned short crc,crc1;
    const unsigned char *buf=(const unsigned char *)data;
    int i=0, j;
    crc=crc0;
    while(i<length) 
    {
        ntemp=i/(length/100);
        if(ntemp!=percentage)
        {
            soutputbuffer.Format("%d%% ", percentage );
            cout<<soutputbuffer;
            percentage=ntemp;
            if(ntemp<0)
                int nn=0;
        }

        crc1=crc;
        j = ((crc >> 8) ^ buf[i]) & 0xff;
        crc = (crc << 8) ^ crc16Table[j];

        soutputbuffer.Format("%d:%02X:%04X>%04X\n", i, buf[i], crc1, crc );
        fileTarget.WriteString(soutputbuffer);
        i++;
    }
    soutputbuffer.Format("\n%04X>%04X", crc1, crc );
    cout<<soutputbuffer;
    crc0=crc;
    fileTarget.Close();
    //ShellExecute(NULL, NULL, soutputfile, NULL, NULL, SW_SHOWNORMAL);
}

void crc16updateBitwise(unsigned short &crc0, const void *data, int length)
{
    CString soutputfile=_T("crc16BW.txt");
    cout<<"\n"<<soutputfile<<"\n";

    CString soutputbuffer;
    CStdioFile fileTarget( soutputfile, CFile::modeCreate | CFile::modeWrite );

    static const byte BitTable[]={0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80};
    int percentage=0, ntemp;
    unsigned long poly;
    /* terms of polynomial defining this crc (except x^16) */
    //static const byte pp[]={0,5,12};//CCITT
    static const byte pp[]={0,2,15};//GENERAL

    /* make exclusive-or pattern from polynomial 0x1021 */
    int i;
    poly=0;
    //for(i=0; i<sizeof(pp)/sizeof(byte); i++) 
    //  poly|=1<<pp[i];
    //poly=0x8005;
    poly=0x7531;

    unsigned short crc,crc1;
    const unsigned char *buf=(const unsigned char *)data;
    byte a,b,c;
    crc=crc0;
    i=0;
    while(i<length) 
    {
        ntemp=i/(length/100);
        if(ntemp!=percentage)
        {
            soutputbuffer.Format("%d%% ", percentage );
            cout<<soutputbuffer;
            percentage=ntemp;
        }
        crc1=crc;
        for(int j=0; j<8; j++) {
            a=(crc&0x8000)?1:0;//x^16
            b=(buf[i]&BitTable[7-j])?1:0;////MSB first transmission 
            c=a^b;
            crc=(c?(poly^(crc<<1)):(crc<<1))&0xffff;
        }
        soutputbuffer.Format("%d:%02X:%04X>%04X\n", i, buf[i], crc1&0xffff, crc&0xffff );
        fileTarget.WriteString(soutputbuffer);
        i++;
    }
    soutputbuffer.Format("\n%04X>%04X", crc1&0xffff, crc&0xffff );
    cout<<soutputbuffer;
    crc0=crc;
    fileTarget.Close();
    //ShellExecute(NULL, NULL, soutputfile, NULL, NULL, SW_SHOWNORMAL);
} 
```

# ios - 自定义按钮 initWithImage 在自定义图像后面显示默认按钮

> ID：11837479
> 
> 赞同：0
> 
> 时间：2012-08-06T23:47:13.120
> 
> 标签：ios, xcode, uibutton

我正在尝试使用自定义图像为我的导航栏制作一个按钮。当我运行以下代码时，按钮会按原样显示，但您可以看到它后面的另一个更宽的按钮，伸出两侧。我如何摆脱那个其他按钮？

```
UIBarButtonItem *emailButton = [[UIBarButtonItem alloc] initWithImage:[UIImage imageNamed:@"emailBut"]
                                                                style:UIBarButtonSystemItemCompose
                                                               target:self 
                                                               action:@selector(emailSheet)];
self.navigationItem.rightBarButtonItem = emailButton; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:50:24.423

嗯......`UIBarButtonSystemItemCompose`是一个系统图标，所以我猜你可能将你的图标覆盖在它上面。您应该改为使用`UIBarButtonItemStylePlain`（或其他样式）作为您的`style:`论点。

**编辑：**

```
UIButton *button = [[UIButton alloc] initWithFrame:CGRectMake(...)];
[button setBackgroundImage:someImage];
[button addTarget:self action:@selector(something:) forControlEvents:UIControlEventTouchUpInside];
UIBarButtonItem *barButtonItem = [[UIBarButtonItem alloc] initWithCustomView:button];
[self.navigationItem setRightBarButtonItem:barButtonItem]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T09:17:05.227

好的，由于某种原因 initWithImage 只将图像放在默认按钮的中心。解决方法是按照 iBlue 的建议进行 initWithCustomView 。

需要注意的另一件事是 barBackButton 不允许自定义视图，因此我必须使用我自己的返回方法将其设为 leftButton 而不是 backButton。我希望 Apple 在未来能够让这一切变得更容易。

# python - 来自链接文本的 Selenium click() 在 Windows 上引发异常

> ID：11837481
> 
> 赞同：1
> 
> 时间：2012-08-06T23:47:25.603
> 
> 标签：python, firefox, selenium, webdriver

从命令行使用 python，我执行以下命令：

```
driver = webdriver.Firefox()
driver.get('http://amazon.com/mp3')
el = driver.find_element_by_link_text('MP3 Downloads : MP3 Songs')
el.click()

Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "C:\Python27\lib\site-packages\selenium-2.19.1-py2.7.egg\selenium\webdriver\remote\webelement.py", line 45, in click
    self._execute(Command.CLICK_ELEMENT)
  File "C:\Python27\lib\site-packages\selenium-2.19.1-py2.7.egg\selenium\webdriver\remote\webelement.py", line 194, in _execute
    return self._parent.execute(command, params)
  File "C:\Python27\lib\site-packages\selenium-2.19.1-py2.7.egg\selenium\webdriver\remote\webdriver.py", line 153, in execute
    self.error_handler.check_response(response)
  File "C:\Python27\lib\site-packages\selenium-2.19.1-py2.7.egg\selenium\webdriver\remote\errorhandler.py", line 147, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: u'current is undefined' 
```

我不知道“当前”是什么......我在另一台机器上运行它，错误变成了

```
...Message u'l is undefined' 
```

有什么建议么？顺便说一句，这只发生在 Firefox 上的 Windows 上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:12:49.010

单击按钮时，我遇到了同样的问题。

您可以通过发送“空格”字符来单击它：

```
webDriver.FindElement("button_id").SendKeys(" "); 
```

希望能帮助到你！

# tcp - 从服务器向客户端发送消息的最快方式

> ID：11837484
> 
> 赞同：1
> 
> 时间：2012-08-06T23:48:18.913
> 
> 标签：tcp, udp, webserver, xmpp, nat-traversal

我想制作一个每秒发送数千条消息的应用程序。这些将是非常小的消息，每个只有几个字符，但也可能非常快，每个客户端每秒可能 10-20 个。消息将仅从服务器发送到不同的客户端，并且一次可能多达 10,000 个用户，因此每秒发送 200,000 条消息。

这些可以通过 3g 和/或 wifi 发送给客户端。

你认为有什么能力做到这一点？一个 xmpp 应用程序，带有 NAT 遍历的 udp 消息，还是我还没有想到的其他东西？

# jquery - WordPress wp_ajax 无法按预期工作

> ID：11837486
> 
> 赞同：0
> 
> 时间：2012-08-06T23:48:56.417
> 
> 标签：jquery, ajax, wordpress

已经看了几个小时的 WP ajax 文档，但仍然无法弄清楚

所有代码都在一个页面上。尝试通过 ajax 更新一些选项，但它不起作用。响应说它成功，但 current_form 选项没有被更新。任何帮助将不胜感激。

```
<?php
add_action('wp_ajax_AWNT_save', 'AWNT_save_data');
function AWNT_save_data() {
update_option('current_form', 'foo');
}
echo get_option('current_form');
?>

<script type="text/javascript">
    jQuery(document).ready(function($) {
$('#save').click(function() { 
        var data = {
            action: 'AWNT_save',
            form_name : $('#form_name').val(),
customC: $('#customC').is(":checked"),
no_throttle: $('#no_throttle').is(":checked"),
form_code : $('#form_code').val()};

        jQuery.post( ajaxurl, data, function(response) {
            alert('Response: ' + response);
        });
    });
});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T00:59:50.483

要使 ajax 工作，您需要添加两个动作挂钩，一个已经拥有，另一个需要在用户未登录时工作，并且它是`wp_ajax_nopriv_AWNT_save`，这将使 ajax 工作而无需登录，最后添加`die()`函数到停止进一步执行，否则它将始终返回`0`并`echo`应在函数内部使用。

```
add_action('wp_ajax_AWNT_save', 'AWNT_save_data');
add_action('wp_ajax_nopriv_AWNT_save', 'AWNT_save_data');
function AWNT_save_data() {
    update_option('current_form', 'foo');
    echo get_option('current_form'); 
    die(); // this should be here
} 
```

此外，您应该`javascript`从 中删除`single.php`并将其保存在单独的`js`文件中，例如在主题的根文件夹中创建一个子文件夹`js`或您想要的任何内容，并将文件保存在该文件夹中并命名它，`my_single_ajax.js`然后将 javascript 代码粘贴到该文件如下

```
jQuery(document).ready(function($) { // my_single_ajax.js file
    $('#save').click(function() {
        var data = {
            action: 'AWNT_save',
            // more...
        };

        jQuery.post( ajaxurl, data, function(response) {
            alert('Response: ' + response);
        });
    });
}); 
```

在您的`functions.php`文件中添加`hook`如下操作

```
add_action('wp_enqueue_scripts', 'my_scripts_method');
function my_scripts_method() {
    if(is_single())
        wp_enqueue_script( 'my_single_ajax', get_bloginfo('stylesheet_directory').'/js/my_single_ajax.js'); // assumed your sub folder name is 'js' and file name is 'my_single_ajax.js'
} 
```

只有当它是 时，这才会将脚本 (my_single_ajax.js) 排入队列，仅`single.php`此而已。

# python - 是否可以在 Heroku dynos 上刷新内存？

> ID：11837487
> 
> 赞同：5
> 
> 时间：2012-08-06T23:48:59.493
> 
> 标签：python, django, memory, heroku

我目前正在 Heroku 上开发 Python/Django 应用程序，并且遇到了内存问题。

我有一个泄漏（或两个或三个），但为了帮助测试，能够重置测功机这样它们是自由和清晰的，这样测试就不会相互“污染”。我已经尝试过“重新启动”命令，但这似乎只是重新启动测功机上的进程/服务并且不会清除内存。

搜索没有出现太多有用的信息，您是否知道这是否可能？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-07T04:58:33.710

`heroku restart`将启动全新的测功机。由于我们在测功机之间没有任何共享内存状态，因此当您重新启动并获得新的测功机时，您应该从头开始。

有关更多信息，请参阅[https://devcenter.heroku.com/articles/ps#process-restarts](https://devcenter.heroku.com/articles/ps#process-restarts)。

# javascript - 如何使链接/按钮可下载？

> ID：11837491
> 
> 赞同：0
> 
> 时间：2012-08-06T23:49:22.163
> 
> 标签：javascript, jquery, html, download

所以情况是这样的：我有一个动态网页。有一个带有“选择”的表单，后跟一个链接（或按钮）。当用户点击链接时：

1.  如果选择选项是“显示”，则将显示数据（通过 JQuery 通过 AJAX 提供）。这已经完成了——没有问题。

2.  如果选项是下载，那么如何通过单击链接（或按钮）使数据可下载？？？？

在“下载”选项的情况下，从 AJAX 返回的结果只是 CSV 文本。它不是一个文件，只是一个 javascript 字符串。我需要做什么才能将其变成可下载的文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T23:53:39.387

试试这个：http: [//jsfiddle.net/vpnQe/](http://jsfiddle.net/vpnQe/)

随意玩，希望对您的需求有所帮助`:)`

**代码**

```
var URL = window.webkitURL || window.URL;
var BlobBuilder = window.WebKitBlobBuilder || window.MozBlobBuilder || window.BlobBuilder;

var url;

$("button").click(function() {
    if (url) URL.revokeObjectURL(url);
    var bb = new BlobBuilder();
    bb.append("it works!");
    var file = bb.getBlob("text/plain");
    url = URL.createObjectURL(file);
    $("a[download]").attr("href", url);

    var evt = document.createEvent('MouseEvents');
    evt.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);
    $("a[download]")[0].dispatchEvent(evt);
});​ 
```

**HTML**

```
<article>
    <button type="button">create url, put it in below link, and click it</button><br/>
    <a download="test.txt">Download as text.txt</a>
</article>
<footer>
<ul>
    <li><a href="https://developer.mozilla.org/en/Document_Object_Model_(DOM)/window.URL.createObjectURL">window.URL.createObjectURL</a></li>
    <li><a href="http://updates.html5rocks.com/2011/08/Downloading-resources-in-HTML5-a-download">a[download]</a></li>
</ul>
</footer>​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T23:54:24.867

我建议您在选择“下载”选项时打开一个新窗口，并在服务器端使用适当的标题告诉浏览器该内容应该下载到文件中，而不是在窗口中显示。中的标头主要取决于您要下载的内容，例如使用 PHP 的 CSV（因为我不知道您使用哪种服务器端语言）

```
<?php
header("Content-type: application/octet-stream");
header("Content-Disposition: attachment; filename=\"my-data.csv\"");

// output the content of your file here

?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T00:15:02.120

你应该看看这个例子。

[http://drupal.org/node/417866](http://drupal.org/node/417866)

如果您正在运行 Apache，它将改变每个目录的控制方式，因此您不必将其放入代码中。您只需将其放在 .htaccess 控制信息传递给客户端的方式的位置。

# php - 在 $_FILES['file']['name'] 中使用变量

> ID：11837494
> 
> 赞同：1
> 
> 时间：2012-08-06T23:49:32.213
> 
> 标签：php, image, file, post

有没有办法在实际`$_FILES['file']`部分使用变量？我正在上传多个并不总是上传的图像。例如，我可以更新 1-4 个图像的潜力，但希望能够仅上传`#3`或`#4`在一个实例中。代码是这样的：

```
if($selectedimages != ''){
    foreach ($selectedimages as $i){

        $imagename = $productid."-".$i;
        $imageid = "image_loc-".$imagename;
        if($_FILES['$imageid']['name']!=''){ 
```

但它不会在文件中注册变量的名称，有没有办法做到这一点？

其他变量肯定是有效的，因为我已经检查过它们，函数在这一步就快死了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T23:55:40.590

是的：`if($_FILES[$imageid]['name']!=''){`- 只是不要使用引号，它不会被视为文字。

# c# - 如何编码以获得所需的结果？

> ID：11837495
> 
> 赞同：0
> 
> 时间：2012-08-06T23:49:57.240
> 
> 标签：c#, winforms, visual-studio-2010, encoding

原始字符串是：

```
 csrfToken=ajax:1238044988226892967&postTitle=Job Openings Linux Systems Administrator 
Staff&postText=Security Clearance: Public Trust -- Linux systems administration experience specifically in managing or supporting RedHat and/or Centos Linux in...&pollChoice1-
ANetPostForm=&pollChoice2-ANetPostForm=&pollChoice3-ANetPostForm=&pollChoice4-ANetPostForm=&pollChoice5-ANetPostForm=&pollEndDate-ANetPostForm=0&contentImageCount=1&contentImageIndex=0&
contentImage=http://www.ideal-jobs.net/images/image070.jpg&contentEntityID=5637974394992087135&contentUrl=http%3a%2f%2fwww.ideal-jobs.net%2fjob-openings-
linux-systems-administrator-staff%2f&contentTitle=Job Openings Linux Systems Administrator 
Staff&contentSummary=Security Clearance: Public Trust -- Linux systems administration experience specifically in managing or supporting RedHat and/or Centos Linux in...&contentImageIncluded=true&%23=Save&tweet=&postItem=Share&gid=50565&ajax=true&tetherAccountID=&facebookTetherID= 
```

字符串我希望它在编码后是这样的：

```
 csrfToken=ajax%3A6293994705950333071&postTitle=hello&postText=Hi%20everyone%20hae%20a%20good%20day%20%2C%20i%20am%20new%20to%20this%20%3A)&
pollChoice1-ANetPostForm=&pollChoice2-ANetPostForm=&pollChoice3-ANetPostForm=&pollChoice4-
ANetPostForm=&pollChoice5-ANetPostForm=&pollEndDate-ANetPostForm=0&contentImageCount=0&contentImageIndex=-1&contentImage=&contentEntityID=&contentUrl=&contentTitle=&
contentSummary=&contentImageIncluded=true&%23=&gid=163857&postItem=&ajax=true&tetherAccountID=&facebookTetherID= 
```

目前我正在使用：

```
byte[] byteData = HttpUtility.UrlEncodeToBytes(postData); 
```

我得到了这样的字符串（我在提琴手中看到）：

```
 csrfToken%3dajax%3a1238044988226892967%26postTitle%3dJob+Openings+Linux+Systems+Administrat
or+Staff%26postText%3dSecurity+Clearance%3a+Public+Trust+--+Linux+systems+administration+ex
perience+specifically+in+managing+or+supporting+RedHat+and%2for+Centos+Linux+in...%26pollCh
oice1-ANetPostForm%3d%26pollChoice2-ANetPostForm%3d%26pollChoice3-ANetPostForm
%3d%26pollChoice4-ANetPostForm%3d%26pollChoice5-ANetPostForm%3d%26pollEndDate-
ANetPostForm%3d0%26contentImageCount%3d1%26contentImageIndex%3d0%26contentImage%3dhttp
%3a%2f%2fwww.ideal-
jobs.net%2fimages%2fimage070.jpg%26contentEntityID%3d5637974394992087135%26contentUrl%3dhtt
p%253a%252f%252fwww.ideal-jobs.net%252fjob-openings-linux-systems-administrator-
staff%252f%26contentTitle%3dJob+Openings+Linux+Systems+Administrator+Staff%26contentSummary
%3dSecurity+Clearance%3a+Public+Trust+--+Linux+systems+administration+experience+specifical
ly+in+managing+or+supporting+RedHat+and%2for+Centos+Linux+in...%26contentImageIncluded%3dtr
ue%26%2523%3dSave%26tweet
%3d%26postItem%3dShare%26gid%3d50565%26ajax%3dtrue%26tetherAccountID
%3d%26facebookTetherID%3d 
```

还尝试过：

```
UTF8Encoding encoding = new UTF8Encoding(); 
```

和

```
byte[] byteData = HttpUtility.UrlEncodeUnicodeToBytes(postData); 
```

还是没有运气。。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T00:09:24.833

问题是您正在对整个字符串进行 URL 编码，包括分隔符 & 和 =。您首先需要将字符串解析为字段，然后对字段名称和值进行 url 编码，最后重新组合成一个字符串。

试试这个：

```
string input;      // Your input string
List<string> outputs = new List<string>();

// Parse the original string
NameValueCollection parms = HttpUtility.ParseQueryString(input);

// Loop over each item, url encoding
foreach (string key in parms.AllKeys)  {
    foreach (string val in parms.GetValues(key))
        outputs.Add(HttpUtility.UrlEncode(key) + "=" + HttpUtility.UrlEncode(val));
}

// combine the encoded strings, joining with &
string result = string.Join("&", outputs);    // the final result 
```

**编辑**

这是我在尝试以前的想法时发现的一个更简单的版本：

```
string result = HttpUtility.ParseQueryString(postData).ToString(); 
```

# ruby-on-rails - Windows 上的 Rails 生产 Web 服务器

> ID：11837498
> 
> 赞同：1
> 
> 时间：2012-08-06T23:50:11.777
> 
> 标签：ruby-on-rails, windows, deployment, production-environment, production

我几乎完成了我的第一个 ruby​​ on rails 应用程序的开发。我正在使用 Windows 进行开发。现在我想部署我的应用程序（很可能在 iPage 网络托管上）。Agile Web dev...中描述的过程似乎只适用于MAC OS X（带有乘客等）并且没有太多运气谷歌搜索。

我的问题是：

1- 是否有关于如何在 Windows 上设置本地生产服务器（例如使用 apache 和 mysql（可能是 WAMP））并将其移植到远程主机的良好且易于遵循的教程/书籍/等？

2-“部署 Rails 应用程序：分步指南”一书可以帮助我吗？

3- 值得我安装 VMware、Ubunto（或其他基于 Unix/Linux 的操作系统）并在那里进行生产吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T04:55:04.127

我遇到了类似的情况，我们必须决定将 Rails 应用程序部署到 Windows 服务器而不是 Linux 服务器。我做了一些研究，但从未尝试过任何东西，因为幸运的是我们决定坚持使用 Linux 服务器。我对我的发现并不特别满意，但如果它有帮助的话：

[使用基于 Capistrano 的 gem 部署到 Windows](http://github.com/SciMed/capistrano-windows-server)

[有关 Windows 的其他部署选项的文章](http://napcs.com/howto/rails/deploy/)

# ruby-on-rails - 使用变量名构建rails jbuilder json参数

> ID：11837500
> 
> 赞同：2
> 
> 时间：2012-08-06T23:50:28.647
> 
> 标签：ruby-on-rails, json, jbuilder

我正在尝试使用 jbuilder 从 rails 构建一些 json 输出。我有类似的东西：

```
 json.links do | i |
    i.array!( @links ) do | j, link |
      j.source link['source']
      j.target link['target']
      j.stats do | s |
        [ 'item1', 'item2' ].each { |item|
          s.item statistics_path( :source => link['source'], :metric => item )
        }
      end
    end
  end 
```

当然，这会导致类似：

```
 {
    links: [
      source: "a",
      target: "b",
      stats: {
        item: 'url for item2'
      }
    ]
  } 
```

当我真正想要类似的东西时：

```
 {
    links: [
      source: "a",
      target: "b",
      stats: {
        item1: 'url for item1',
        item2: 'url for item2'
      }
    ]
  } 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-07T09:51:55.893

您可以使用：

`json.set!(:item1, "stuff")`

在你的情况下：

```
 json.links do | i |
    i.array!( @links ) do | j, link |
      j.source link['source']
      j.target link['target']
      j.stats do | s |
        [ 'item1', 'item2' ].each { |item|
          s.set!(item, statistics_path( :source => link['source'], :metric => item ))
        }
      end
    end
  end 
```

# ios - 记住登录的控制器/视图之间的 iOS 导航

> ID：11837501
> 
> 赞同：1
> 
> 时间：2012-08-06T23:50:29.923
> 
> 标签：ios, login, uinavigationcontroller

我有 A、B 和 C，它们是处理用户登录的控制器。这将是流程：

A->B

或者

A->C

然后

B->主要

或者

C->主要

从 Main 应该有一个左按钮来注销并从 A 重新开始。我知道这可以使用 popToRootViewControllerAnimated 来完成。问题是，如果在 B/C 中记住用户（我有一个 UISwitch），那么如果应用程序终止并重新启动，我想直接转到 Main，所以根控制器将是 Main 而不是 A。所以 popToRootViewControllerAnimated 不会不行。

如何才能做到这一点？

# c++ - Drawing points with GL_POINTS and GL_POINT_SMOOTH results it two pixel tall points?

> ID：11837506
> 
> 赞同：2
> 
> 时间：2012-08-06T23:51:11.843
> 
> 标签：c++, opengl, sdl

I have the following:

```
glHint(GL_POINT_SMOOTH, GL_NICEST);
glEnable(GL_POINT_SMOOTH); 
```

The issue is that when I attempt to draw a pixel:

```
DrawPoints(float x1,float y1)
{
    glBlendFunc(GL_DST_ALPHA,GL_ONE_MINUS_DST_ALPHA);
    glPointSize(1);
    glBegin(GL_POINTS);
        glVertex2f(x1, y1);
    glEnd();
} 
```

I get points on the screen that are two pixels wide, and two pixels tall. The pixels that were two pixels wide were solved by making sure that `x1` is called with a `.5` at the end. Forcing the `y1` variable to end in `.5` did **not** fix the height issue. The points are always 2 pixels tall despite being set to be only one.

How could I solve this?

**EDIT:**

Took a screen shot of the issue in question. It is drawing out a sine wave on the screen.

![Shot0](../Images/38622dbaf959df1471218243617757b4.png)

**EDIT 2:**

Here's the full initialization code:

```
if(SDL_Init(SDL_INIT_EVERYTHING) < 0) {
    fprintf(stderr,"%s:%d\n    SDL_Init call failed.\n",__FILE__,__LINE__);
    return false;
}

if((Surf_Display = SDL_SetVideoMode(WWIDTH, WHEIGHT, 32, SDL_HWSURFACE | SDL_GL_DOUBLEBUFFER | SDL_OPENGL)) == NULL) {
    fprintf(stderr,"%s:%d\n    SDL_SetVideoMode call failed.\n",__FILE__,__LINE__);
    return false;
}
// Init GL system
glClearColor(0, 0, 0, 1);

glClearDepth(1.0f);

glViewport(0, 0, WWIDTH, WHEIGHT);

glMatrixMode(GL_PROJECTION);

glLoadIdentity();

glOrtho(0, WWIDTH, WHEIGHT, 0, 1, -1);

glMatrixMode(GL_MODELVIEW);

glEnable(GL_TEXTURE_2D);

glHint(GL_POINT_SMOOTH, GL_NICEST);
glHint(GL_LINE_SMOOTH, GL_NICEST);
glHint(GL_POLYGON_SMOOTH, GL_NICEST);

glEnable(GL_POINT_SMOOTH);
glEnable(GL_LINE_SMOOTH);
glEnable(GL_POLYGON_SMOOTH);

glLoadIdentity(); 
```

Making sure that `glEnable(GL_BLEND);` has been called did not help either.

Another note, calling `SDL_GL_SetAttribute(SDL_GL_MULTISAMPLESAMPLES, 2);` had no effect on the pixel height either.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T19:18:48.523

I found the answer to what went wrong.

This code caused the error:

```
glHint(GL_POINT_SMOOTH, GL_NICEST);
glHint(GL_LINE_SMOOTH, GL_NICEST);
glHint(GL_POLYGON_SMOOTH, GL_NICEST); 
```

These are not the correct flags to give to glHint.

This code fixed it and got rid of a ENUM error that OpenGL was throwing. I found that one through debugging whole other issue. Serves me right for not checking error states!

```
glHint(GL_POINT_SMOOTH_HINT, GL_NICEST);
glHint(GL_LINE_SMOOTH_HINT, GL_NICEST);
glHint(GL_POLYGON_SMOOTH_HINT, GL_NICEST); 
```

# nlp - NuGram 中的多位数字被空格分割？

> ID：11837510
> 
> 赞同：1
> 
> 时间：2012-08-06T23:51:26.163
> 
> 标签：nlp, grammar, context-free-grammar, bnf

我在用于 ABNF 语法开发的 NuGram IDE Eclipse 插件中看到了一些意外行为。

假设我有一条规则：

```
$fifties =
    50 | 51 | 52 | 53 | 54 | 55 | 56 | 57 | 58 | 59
; 
```

句子生成器会提供匹配项 5 0、5 1、5 2……我通常会期望 50、51、52 ​​等等，但根据 NuGram 的覆盖工具，这些被认为是 OOG。

来发现它会用空格分割任何多位数字，除非有一个领先的非数字：

```
1234 -> 1 2 3 4
1234asdf -> 1 2 3 4 asdf
asdf1234 -> asdf1234
1234asdf5678 -> 1 2 3 4 asdf5678 
```

据我所知，正常的 ABNF 语法不会这样做。还是我忘记了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T00:40:52.413

这是因为 NuGram IDE 将数字视为单独的 DTMF 音调。我同意此行为应仅适用于 DTMF 语法，而不适用于语音语法。

您可以用双引号将数字序列括起来，例如：

```
$fifties =
    "50" | "51" | "52" | "53" | "54" | "55" | "56" | "57" | "58" | "59"
; 
```

希望有帮助！

# python - python中dict.update的替代品

> ID：11837512
> 
> 赞同：0
> 
> 时间：2012-08-06T23:51:43.020
> 
> 标签：python, dictionary

所以我意识到

```
dict1.update(dict2) 
```

如果两个字典中都存在键，则用 dict1 替换 dict2 的值。如果键存在而不是循环键值对，有什么方法可以直接将 dict2 的值添加到 dict1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T00:37:00.870

你说你想添加值，但不是它们是什么类型。如果它们是数字，您可以使用`collections.Counter`而不是`dict`

```
>>> from collections import Counter
>>> a = Counter({'a':1, 'b':2})
>>> b = Counter({'a':5.4, 'c':6})
>>> a + b
Counter({'a': 6.4, 'c': 6, 'b': 2}) 
```

# .net - 支持视觉样式的控制按钮背景颜色

> ID：11837513
> 
> 赞同：2
> 
> 时间：2012-08-06T23:51:51.053
> 
> 标签：.net, winforms, user-interface, background-color

我在表单上有一个按钮，目前使用视觉样式绘制，在 Win7 机器上使用圆形阴影渐变和蓝色悬停高亮绘制。

从高到高的词是这个按钮，它控制一个特定的功能是打开还是关闭，当该功能打开时应该看起来绿色并突出显示更绿色，当功能关闭时看起来红色并突出显示更红色，*而不会*丢失整体默认值按钮的视觉风格。如果我们简单地设置 BackColor，我们会得到一个无阴影、无色的按钮，在 Win7 默认天蓝色的边框周围突出显示。

不幸的是，这是 WinForms 而不是 WPF，所以我没有高级样式控制，而且我们还没有使用 WPF。有什么我可以开箱即用的方法来更改 Windows 视觉样式为这个按钮使用的颜色吗？

**编辑：**为了节省时间，我创建了一个带有按钮的 WPF 用户控件，托管在 WinForm 中，允许所需的高级样式和情节提要控件。有用。我仍然对如何在 GDI 中完成这一点感到好奇，特别是因为我也没有通过 WPF 获得我想要的一切，但我有一个可行的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:31:19.870

如果您将 UseVisualStyleBackColor 保留为 false 并使用部分 alpha 手动指定 BackColor，例如“64、255、0、0”，则颜色将与视觉样式背景混合，并且标准主题渐变将显示为该颜色。我不确定这是否适用于 Windows < 7。

# python - BeautifulSoup：AttributeError：“str”对象没有属性“copy”。在 Ubuntu 上工作，在 Windows 上失败

> ID：11837515
> 
> 赞同：3
> 
> 时间：2012-08-06T23:52:08.097
> 
> 标签：python, windows, windows-xp, beautifulsoup

我在使用 BeautifulSoup 时遇到了一个奇怪的错误。

这是我正在运行的代码片段：

```
while True:
    listing_soup = soupify(urlget(page_url))
    for i in listing_soup.findAll('div', 'searchResultContent'):
       # do some stuff ... 
```

这是抛出的异常：

```
Traceback (most recent call last):
  File "C:\path\to\script.py", line 71
6, in <module>
    for i in listing_soup.findAll('div', 'searchResultContent'):
  File "c:\python27\BeautifulSoup.py", line 612, in findAll
    return self._findAll(name, attrs, text, limit, generator, **kwargs)
  File "c:\python27\BeautifulSoup.py", line 275, in _findAll
    strainer = SoupStrainer(name, attrs, text, **kwargs)
  File "c:\python27\BeautifulSoup.py", line 660, in __init__
    self.attrs=attrs.copy()
AttributeError: 'str' object has no attribute 'copy' 
```

我在 Windows XP Professional 上运行 Python 2.7.3。该脚本在 Ubuntu Linux 上运行良好。

**笔记：**

我希望来自网络的数据是 UTF，因此 python 脚本以以下行开头：

`# coding=utf-8`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T01:33:14.737

从行号来看，您使用的是 Beautiful Soup 3.0.0，它没有您尝试使用的“按 CSS 类搜索”快捷方式（它在 3.0.1 中重新引入）。更重要的是，您使用的是五年前的软件版本。我向所有新项目推荐[Beautiful Soup 4](http://www.crummy.com/software/BeautifulSoup/bs4/doc/)。

很可能您在 Ubuntu 上看不到问题，因为您的 Ubuntu 安装运行的是更新版本的 Beautiful Soup。

# javascript - 如何为 ajax 生成的图像设置绝对定位

> ID：11837519
> 
> 赞同：1
> 
> 时间：2012-08-06T23:53:05.273
> 
> 标签：javascript, jquery

我正在尝试为 ajax 生成的所有图像设置绝对位置。

这是我的代码，

```
for loop...

  var imagediv = document.getElementById('image_layout');

//generate many images
  imagediv.innerHTML=  imagediv.innerHTML + "<div class='imgDiv'>" + "<a href=\"#\""><img src=\"" + mystuff.list[n].imgPath \"" + "\" )\"" + "></a></div>";

//The image shows correctly but I want to set all of them in absolute position so I can create other effects. 
```

我不知道该怎么做，如果有人可以在这里帮助我，我将不胜感激。非常感谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T00:01:52.973

我没有看到任何 AJAX 发生，但无论如何，如果您使用的是 jQuery，那么请充分利用它：

```
var imgs = []
var $wrap = $('#image_layout')

for ( ... ) {
  imgs.push(
    "<div class='imgDiv'>"+
      "<a href='#'><img src='"+ mystuff.list[n].imgPath +"'/></a>"+
    "</div>"
  )
}

// Append everything at last for best performance
$wrap.append(
  $(imgs.join(''))
    .css('position', 'absolute')
) 
```

# ftp - 山狮服务器FTP访问

> ID：11837521
> 
> 赞同：1
> 
> 时间：2012-08-06T23:53:14.397
> 
> 标签：ftp, osx-mountain-lion, portforwarding

所以我试图在我的 Mountain Lion 服务器上提供 FTP 访问。我启用了它，它似乎可以工作，就像在同一台 Mac 上一样，使用我的静态 IP 地址，我可以连接、编辑和删除/添加文件。但在我的另一台 Mac 上，使用相同的登录名、IP 地址和密码，它将无法正常工作。它在所有其他计算机上也显示“530 登录身份验证失败”。我已经转发了端口，并在谷歌上搜索了几个小时。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T22:19:37.663

我已经重新安装了 Mountain Lion，它似乎已经解决了这个问题。我不确定出了什么问题，所以我无法分享我的修复。对不起。

# html - 绕过 Firefox 的离线存储警告？

> ID：11837526
> 
> 赞同：3
> 
> 时间：2012-08-06T23:53:56.410
> 
> 标签：html, firefox, offline-caching, cache-manifest

我正在开发一个支持 HTML5 离线浏览的网络应用程序。我写了一个清单文件，如下所示：

```
CACHE MANIFEST

CACHE:
audio/a.ogg

NETWORK:
* 
```

当我在 Firefox 中访问我的应用程序时，会提示一条警告消息：

'*该网站 [192.168.2.14] 要求将数据存储在您的计算机上以供离线使用。允许，从不用于此站点，现在不允许*'。
见[https://dl.dropbox.com/u/83574968/ff-offline.png](https://dl.dropbox.com/u/83574968/ff-offline.png)

我在 Ubuntu 12.04 上使用 FF 14.0.1 稳定版，Chrome 运行良好。显然我无法控制最终用户使用哪个浏览器，而且用户似乎在看到警告消息时倾向于禁用离线存储：[请参阅此处](http://answers.yahoo.com/question/index?qid=20120325135250AA7fSgx)

那么，**如果我想使用离线存储，有什么办法可以绕过 FF 中的这个警告消息？**

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T00:02:15.673

不，这目前是不可能的。删除该警告将允许开发人员做一些非常可怕的事情

这是关于该主题的持续讨论： [https ://bugzilla.mozilla.org/show_bug.cgi?id=648064#c1](https://bugzilla.mozilla.org/show_bug.cgi?id=648064#c1)

[Web 应用程序如何在您不知情的情况下下载和存储超过 2GB](http://www.jefclaes.be/2012/03/how-web-application-can-download-and.html "Web 应用程序如何在您不知情的情况下下载和存储超过 2GB")

# c# - MVC 存储库架构和访问不同的表

> ID：11837530
> 
> 赞同：3
> 
> 时间：2012-08-06T23:54:10.950
> 
> 标签：c#, .net, asp.net-mvc, architecture

感谢您帮助我理解其中的一些内容：

假设我在 MVC 应用程序中有 2 个控制器 - 1 个控制与销售人员相关的视图模型 1 个控制与销售相关的视图模型

每个都有自己的存储库，它使用实体框架访问数据（代码优先）

两个存储库都设置为处理依赖注入，但也有 0 个参数构造函数，默认使用适当的 EF 数据访问。

销售人员控制器使用 _salesPeopleRepository.getAllSalesPeople() 函数返回销售人员列表以填充索引视图。

销售控制器需要访问相同的列表来填充下拉列表。

有几种方法可以将信息发送给销售控制器，我想知道哪些选项会被认为是最佳实践：

a) 在控制器中

```
db = new DataContext();
_saleRepos = new SalesRepository(db);
_salesPeople = new SalesPeopleRepository(db);
 .....
modelA.SalePeopleSelectList = SelectList(_salesPeople.getAllSalesPeople(),"id","name") 
```

b) 在 SalesRepository - 使用 EF 本身：

```
public IEnumerable<salesPerson> getAllSalesPeople()
{ 
    return _db.SalesPeople.ToList();
} 
```

c) 或者在调用函数之前实例化和注入相同的数据访问对象

```
public IEnumerable<salesPerson> getAllSalesPeople()
{ 
    return (new SalesPersonRepository(_db)).getAllSalesPeople();
} 
```

**编辑**

如果答案是 a)，应如何从 1 个存储库调用自定义业务逻辑 - 例如 sales 有一个 storeId，并且存储库检查为销售输入的 storeId 是否与 salesPerson 的 storeId 匹配。用于业务逻辑目的的 salesPerson 对象（在 salesRepository 内）应该通过 salesPerson 存储库访问，还是直接从 dataContext 对象访问？

感谢您的想法和经验

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T01:09:25.907

从表中`SalesRepository`检索数据是没有意义的。`SalesPerson`该数据访问逻辑应该集中在`SalesPeopleRepository`. 在我看来，跨存储库复制该方法只会使水变得浑浊。

那么为什么不在销售控制器中同时使用`SalesRepository`和呢？`SalesPeopleRepository`我只是实例化一个实例`SalesPeopleRepository`并使用其中已经定义的方法。

此外，如果您的控制器使用依赖注入，您可以将存储库传递给构造函数：

```
public SalesController (ISalesRepository salesRepository, ISalesPeopleRepository salesPeopleRepository)
{
   this._salesRepository = salesRepository;
   this._salesPeopleRepository = salesPeopleRepository;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T06:39:25.460

*最佳实践*始终取决于上下文，但在EF 之上经常使用**存储库**和**工作单元模式的组合。**

**用法：**

```
using (var uow as new DataContext()) {
    var salesPeople = new SalesPeopleRepository(uow);

    // ...

    uow.Commit(); // If changes must be committed back to the database
} 
```

**执行：**

```
public interface IUnitOfWork {
    public void Commit();
}

public class DataContext : IUnitOfWork {
    public void Commit() {
        this.SaveChanges();
    }
}

public class SalesPeopleRepository {

    private DataContext _db

    public SalesPeopleRepository(IUnitOfWork uow) {
        _db = uow as DataContext;
    }

    public IEnumerable<SalesPerson> GetAllSalesPeople() { 
        return _db.SalesPeople.ToList();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T05:55:07.740

首先，应遵循 C# 命名约定：getAllSalesPeople() 应为 GetAllSalesPeople。其次，在这种情况下，IoC 容器和依赖注入将是最佳实践。

项目**a**应该避免，因为 DataContext 和 Repositories 是直接在控制器中创建的，它违反了依赖注入，并使您的代码与 Repositories 和 DataContext 紧密耦合，并且无法模拟单元测试。相反，存储库应该被注入到控制器中，而 DataContext 应该被注入到存储库中。

```
public Repository(DataContext dataContext)
{
    _dataContext = dataContext;
}

public SalesController(ISalesRepository salesRepository, 
                          ISalesPeopleRepository salesPeopleRepository) 
{ 
   _salesRepository = salesRepository; 
   _salesPeopleRepository = salesPeopleRepository; 
} 
```

DataContext 的生命周期管理应该保存在 IoC 容器中的每个请求中，而不是直接在控制器中创建，大多数 IoC 容器都支持这一点。不知道您使用哪个 IoC 容器，但我最喜欢的是：Autofac 和 Windsor。

对于项目**c**，您正在将业务逻辑泄漏到存储库层，相反，业务逻辑应该在控制器或单独的层中。存储库只处理您的数据库的 CRUD 操作。

# facebook - 使用 FQL 时的意外行为

> ID：11837531
> 
> 赞同：0
> 
> 时间：2012-08-06T23:54:22.683
> 
> 标签：facebook, limit, facebook-fql

将 LIMIT 选项添加到 FQL 会导致返回比没有 LIMIT 更多的结果。例如：

```
SELECT post_id, actor_id, message,description,type FROM stream WHERE source_id = me() 
```

返回 4 个结果：

```
{ "data": [
{
  "post_id": "1458319848_4164228991531", 
  "actor_id": 1458319848, 
  "message": "Oh happy days!", 
  "description": null, 
  "type": 46
}, 
{
  "post_id": "1458319848_4081409841104", 
  "actor_id": 1458319848, 
  "message": "", 
  "description": "Caroline Natan and Or Karlinsky are now friends.", 
  "type": null
}, 
{
  "post_id": "1458319848_4076275592751", 
  "actor_id": 1458319848, 
  "message": "", 
  "description": "Caroline Natan changed her Interested In.", 
  "type": null
}, 
{
  "post_id": "1458319848_4075703458448", 
  "actor_id": 100001179537125, 
  "message": "", 
  "description": null, 
  "type": 237
}]} 
```

但是使用：

```
SELECT post_id, actor_id, message,description,type FROM stream WHERE source_id = me() LIMIT 9 
```

返回**5 个**结果：

```
{"data": [
{
  "post_id": "1458319848_4164228991531", 
  "actor_id": 1458319848, 
  "message": "Oh happy days!", 
  "description": null, 
  "type": 46
}, 
{
  "post_id": "1458319848_4081409841104", 
  "actor_id": 1458319848, 
  "message": "", 
  "description": "Caroline Natan and Or Karlinsky are now friends.", 
  "type": null
}, 
{
  "post_id": "1458319848_4076275592751", 
  "actor_id": 1458319848, 
  "message": "", 
  "description": "Caroline Natan changed her Interested In.", 
  "type": null
}, 
{
  "post_id": "1458319848_4075703458448", 
  "actor_id": 100001179537125, 
  "message": "", 
  "description": null, 
  "type": 237
}, 
{
  "post_id": "1458319848_4069875152744", 
  "actor_id": 100000876758120, 
  "message": "", 
  "description": null, 
  "type": 237
}]} 
```

当然，这没有任何意义！我在这里错过了什么吗？如果有，是什么？我也读过[这个](https://developers.facebook.com/blog/post/478/)，我没有看到关于这里描述的问题的任何内容。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T13:07:46.533

The article you linked to actually addresses this issue:

> You might notice that the number of results returned is not always equal to the “limit” specified. This is expected behavior. Query parameters are applied on our end before checking to see if the results returned are visible to the viewer. Because of this, it is possible that you might get fewer results than expected.

Which basically means that facebook filters the results after it executes the query.

In your example, in the first query, there's an implicit limit, say 5\. Out of these 5 results, 1 is filtered out because of visibility restrictions and you get 4. In the second query, the server gets 10 results, filters 5 of them out based on visibility and returns 5 to you.

# twitter-bootstrap - TinyMCE弹窗定制，如何改变外观来满足Twitter Bootstrap？

> ID：11837533
> 
> 赞同：1
> 
> 时间：2012-08-06T23:54:28.263
> 
> 标签：twitter-bootstrap, tinymce, wysiwyg

有没有办法改变TinyMCE中**每个弹出窗口的外观？**我的意思是更改弹出按钮、标题等？每个插件的弹出样式似乎都相同：

![在此处输入图像描述](../Images/e12c84f0703370cb04f3006153cc4865.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T00:07:35.367

检查插件文件夹。

```
tiny_mce\plugins\PLUGIN_FOLDER 
```

插件使用了一个 HTML 文件和所有 CSS 和 JS（如果有）。编辑这个你正在编辑弹出窗口。

# php - mysql选择和回显结果问题

> ID：11837534
> 
> 赞同：0
> 
> 时间：2012-08-06T23:54:40.513
> 
> 标签：php, mysql

我正在建立一个网站来学习 PHP，并且刚刚建立了一个会员应用程序。

这是我的代码，用于获取我在用户登录时设置的用户 cookie，然后获取它们关联的业务 ID，称为**biz**并在名为**company**的表中查找ID 等于**biz**的业务的所有详细信息：（顺便说一句，我知道我正在使用 mysql，但是当我完成我的应用程序时，我将切换到 PDO 或 mysqli）

 **```
<?
$auth = $_COOKIE["auth"];
if ($auth != "1"){
    header("Location: ./signin.php");
}
//Grab all the cookies

$firstname = $_COOKIE['firstname'];
$id = $_COOKIE['id'];
$fname = ucwords($_COOKIE['firstname']);
$lname = ucwords($_COOKIE['lastname']);
$email = $_COOKIE['email'];
$city = ucwords($_COOKIE['city']);
$biz = $_COOKIE['biz'];

if(!empty($biz)){
    $donthaveabizyet = "false";
}
else{
    include("./config.php");
    $result = mysql_query("SELECT * FROM company WHERE id = '$biz'") or mysql_error();
    while($row = mysql_fetch_array($result))
    {
           $business_name = $row['name'];
           $business_phone = $row['phone'];
           $business_website = $row['website'];
           $business_phone = $row['phone'];
           $business_cat1 = $row['cat1'];
           $business_cat2 = $row['cat2'];
           $business_cat3 = $row['cat3'];
           $business_subcat1 = $row['subcat1'];
           $business_subcat2 = $row['subcat2'];
           $business_subcat3 = $row['subcat3'];
           $business_email = $row['email'];
           $business_product1 = $row['product1'];
           $business_product2 = $row['product2'];
           $business_product3 = $row['product3'];
           $business_product4 = $row['product4'];
           $business_product5 = $row['product5'];
           $business_product6 = $row['product6'];
           $business_product7 = $row['product7'];
           $business_noaddress = $row['noaddress'];
           $business_address = $row['address'];
           $business_address2 = $row['address2'];
           $business_zipcode = $row['zipcode'];
           $business_city = $row['city'];
    }
    $result = mysql_query("SELECT * FROM company_secondary WHERE company_id = '$biz'") or mysql_error();
    while($row = mysql_fetch_array($result))
    {
           $business_description = $row['company_description'];
           $business_since = $row['phone'];
           $business_logo = $row['logo'];
           $business_since = $row['since'];
           $business_smoking = $row['smoking'];
           $business_delivery = $row['delivery'];
           $business_alcohol = $row['alcohol'];
           $business_kids = $row['kids'];
           $business_wheelchair = $row['wheelchair'];
           $business_twitter = $row['twitter'];
           $business_facebook = $row['facebook'];
           $business_youtube = $row['youtube'];
           $business_creditcards = $row['creditcards'];
           $business_outdoor = $row['outdoor'];
           $business_featured = $row['featured'];
     }
}
?> 
```

现在，如果用户的企业 id 等于 0，或者如果设置了用户的企业 id，我将显示到 claim.php 的链接，我会显示企业的名称。

```
<?php 
if($donthaveabizyet != "false")
{
     echo "<br/><br/>You haven't claimed a business yet. <a href='claim.php'>Click here to claim one now.</a>";
}
else
{
     echo $business_name;
}
?> 
```

不幸的是，$business_name 没有显示，错误是`Notice: Undefined variable: business_name`. 为什么没有设置business_name？

非常感谢大家的帮助！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T23:58:13.710

```
while($row = mysql_fetch_array($result))
{ 
```

导致你的问题。将其更改为

```
while($row = mysql_fetch_assoc($result))
{ 
```

这是因为 fetch_array 创建了一个带有数字索引的数组（$array[1]、$array[2] 等）。fetch_assoc 使索引与列名相同（$array['this']、$array['that'] 等）**

# php - 删除字符串PHP的某些字符

> ID：11837538
> 
> 赞同：-3
> 
> 时间：2012-08-06T23:55:32.357
> 
> 标签：php, regex

我需要删除字符串的第三个字符。这是我尝试过的。

```
$my_string['2'] = ""; 
```

这很有效，但是当我尝试将此变量放入 MySQL 查询中时，它返回了错误。
从字符串中删除某个字符（在我的情况下为字符 3）的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T23:57:54.363

试试[substr_replace](http://php.net/manual/en/function.substr-replace.php)。

例如：

```
$new_string = substr_replace($my_string, '', 2, 1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T00:14:24.347

使用整数作为索引，而不是字符串：

```
$my_string[2] = ''; 
```

# c# - 检查端口是否打开

> ID：11837541
> 
> 赞同：32
> 
> 时间：2012-08-06T23:55:43.760
> 
> 标签：c#, .net, winforms

我似乎找不到任何可以告诉我路由器中的端口是否打开的信息。这甚至可能吗？

我现在拥有的代码似乎并没有真正起作用......

```
private void ScanPort()
{
    string hostname = "localhost";
    int portno = 9081;
    IPAddress ipa = (IPAddress) Dns.GetHostAddresses(hostname)[0];
    try
    {
        System.Net.Sockets.Socket sock =
                new System.Net.Sockets.Socket(System.Net.Sockets.AddressFamily.InterNetwork,
                                              System.Net.Sockets.SocketType.Stream,
                                              System.Net.Sockets.ProtocolType.Tcp);
        sock.Connect(ipa, portno);
        if (sock.Connected == true) // Port is in use and connection is successful
            MessageBox.Show("Port is Closed");
        sock.Close();
    }
    catch (System.Net.Sockets.SocketException ex)
    {
        if (ex.ErrorCode == 10061) // Port is unused and could not establish connection 
            MessageBox.Show("Port is Open!");
        else
            MessageBox.Show(ex.Message);
    }
} 
```

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-08-07T00:09:58.513

尝试这个：

```
using(TcpClient tcpClient = new TcpClient())
{
    try {
        tcpClient.Connect("127.0.0.1", 9081);
        Console.WriteLine("Port open");
    } catch (Exception) {
        Console.WriteLine("Port closed");
    }
} 
```

您可能应该将 127.0.0.1 更改为 192.168.0.1 或任何您的路由器的 IP 地址。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2016-07-08T02:39:07.147

一个更好的解决方案，您甚至可以指定超时：

```
using System;
using System.Net.Sockets;

// ...

bool IsPortOpen(string host, int port, TimeSpan timeout)
{
    try
    {
        using(var client = new TcpClient())
        {
            var result = client.BeginConnect(host, port, null, null);
            var success = result.AsyncWaitHandle.WaitOne(timeout);
            client.EndConnect(result);
            return success;
        }
    }
    catch
    {
        return false;
    }
} 
```

而且，在 F# 中：

```
open System
open System.Net.Sockets

let isPortOpen (host: string) (port: int) (timeout: TimeSpan): bool =
    try
        use client = new TcpClient()
        let result = client.BeginConnect(host, port, null, null)
        let success = result.AsyncWaitHandle.WaitOne timeout
        client.EndConnect result
        success
    with
    | _ -> false

let available = isPortOpen "stackoverflow.com" 80 (TimeSpan.FromSeconds 10.)
printf "Is stackoverflow available? %b" available 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-02-27T16:26:36.090

没有办法知道该端口是否在您的路由器中转发，除非有程序在该端口上侦听。

正如您在克林顿的回答中看到的那样，正在使用的 .Net 类是 TcpClient ，这是因为您正在使用 TCP 套接字进行连接。这就是操作系统建立连接的方式：使用套接字。但是，路由器只是将数据包（OSI 模型的第 3 层）转发进出。在您的情况下，您的路由器正在执行的操作称为：NAT。它是一个由一个或多个私有 IP 共享的公共 IP。这就是您进行端口转发的原因。

数据包的路径中可能有很多路由器，你永远不会知道发生了什么。

假设您正在以传统方式发送一封信。也许您可以在信中写下收件人必须回答，以检查他/她是否在那里（您和收件人是插座）。如果您收到答复，您将确定他/她在那里，但如果您没有收到任何东西，您不知道邮递员（在您的情况下是路由器）是否忘记递送信件，或者收件人没有回答。您也永远不会知道邮递员是否要求朋友送出那封信。此外，邮递员不会打开这封信以知道他/她可能会回复，因为您正在等待回复。您可能要做的就是等待一段时间才能收到答案。如果你在那段时间没有收到任何东西，你会认为收件人不在你寄信的地方。那是一个“超时”。

我看到一个提到 nmap 软件的答案。它真的是一个非常好的和复杂的软，但我认为它会以同样的方式工作。如果该端口中没有应用程序侦听，则无法知道它是否打开。

请让我知道我是否清楚。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-07T00:13:19.500

如果您要连接到[环回适配器](http://en.wikipedia.org/wiki/Loopback#Virtual_network_interface)——`localhost`或者`127.0.0.1`（[没有像 127.0.0.1 这样的地方！](http://www.thinkgeek.com/product/5d6a/)），那么您不太可能连接到路由器。操作系统足够聪明，可以识别它是一个特殊地址。如果您实际指定机器的“真实”IP 地址，不知道这是否也适用。

另请参阅此问题：[Microsoft Loopback Adapter 的用途是什么？](https://stackoverflow.com/questions/2021415/what-is-the-purpose-of-the-microsoft-loopback-adapter)

另请注意，运行`traceroute localhost`（`tracert localhost`在 Windows 中）表明所涉及的唯一网络节点是您自己的机器。路由器从不涉及。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-09-11T03:57:03.913

除了 BeginConnect，您还可以使用 ConnectAsync（我认为是在 .NET Framework 4.5 中添加的？）。

```
TcpClient client = null;

try {
    client = new TcpClient();
    var task = client.ConnectAsync(host, port);
    if (task.Wait(timeout)) {//if fails within timeout, task.Wait still returns true.
        if (client.Connected) {
            // port reachable
        }
        else
            // connection refused probably
    }
    else
        // timed out
}
catch (Exception ex) {
    // connection failed
}
finally {
    client.Close();
} 
```

完整的项目在[这里，](https://github.com/changbowen/PortPing)因为 paping 拒绝运行，而且我找不到另一个我喜欢的“ping host:port”工具。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-01-13T09:04:51.870

无法从 LAN 内部测试路由器上的端口转发，您需要从 WAN（互联网）端连接以查看端口转发是否工作。

一些互联网站点提供检查端口是否打开的服务：

[什么是我的 IP 端口扫描仪](http://www.whatsmyip.org/port-scanner/)

[GRC | 盾牌！](https://www.grc.com/x/ne.dll?bh0bkyd2)

如果您想检查自己的代码，则需要确保 TCP/IP 连接通过外部代理重新路由或设置隧道。这与您的代码无关，它是基本的网络 101。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-05-29T05:46:53.603

```
public static bool PortInUse(int  port)
{
    bool inUse = false;

    IPGlobalProperties ipProperties = IPGlobalProperties.GetIPGlobalProperties();
    IPEndPoint [] ipEndPoints = ipProperties.GetActiveTcpListeners();

    foreach(IPEndPoint endPoint in ipEndPoints)
    {
        if(endPoint.Port == port)
        {
            inUse = true;
            break;
        }
    }

    return  inUse;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-05-18T14:18:19.073

对我来说，在与端口的连接可用或经过一定次数的重试之前，我需要一些阻塞。所以，我想出了这段代码：

```
public bool IsPortOpen(string host, int port, int timeout, int retry)
{
    var retryCount = 0;
    while (retryCount < retry)
    {
        if (retryCount > 0)
            Thread.Sleep(timeout);

        try
        {
            using (var client = new TcpClient())
            {
                var result = client.BeginConnect(host, port, null, null);
                var success = result.AsyncWaitHandle.WaitOne(timeout);
                if (success)
                    return true;

                client.EndConnect(result);
            }
        }
        catch
        {
            // ignored
        }
        finally { retryCount++; }
    }

    return false;
} 
```

希望这可以帮助！

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-04-26T10:21:58.940

```
public string GetAvailablePort()
        {int startingPort=1000;
            string portnumberinformation = string.Empty;
            IPEndPoint[] endPoints;
            List<int> portArray = new List<int>();
            IPGlobalPr`enter code here`operties properties = IPGlobalProperties.GetIPGlobalProperties();`enter code here`

            //getting active tcp listners 
            endPoints = properties.GetActiveTcpListeners();
            portArray.AddRange(from n in endPoints
                               where n.Port >= startingPort
                               select n.Port);    

            portArray.Sort();

            for (int i = 0; i < portArray.Count; i++)
            {
                if (check condition)
                {
                    do somting
                }
            }

            return portnumberinformation;
        } 
```

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2019-11-08T05:50:34.120

如果是路由器，是通过在线服务检查它的最简单方法，例如

*   [端口检查器](https://www.portcheckers.com)
*   [端口转发测试](https://www.portforwarding.org/)

您也可以尝试使用**Telenet**来检查端口是否可以访问

```
telenet [ip-address] [port] 
```

# visual-studio-2010 - 重命名变量的键盘快捷键？

> ID：11837547
> 
> 赞同：1
> 
> 时间：2012-08-06T23:56:50.013
> 
> 标签：visual-studio-2010, visual-studio, keyboard-shortcuts

在 Visual Studio 中，当您更改变量的名称时，它下方会出现一个红色小方块，当您将鼠标悬停在它上面时，会出现一个更大的黄色框，当您单击该选项时，会出现一个自动重命名该变量的所有实例的选项到新名称。有这个键盘快捷键吗？这比试图将鼠标悬停在小红框上半小时要快得多......（如果重要的话，我正在使用 C# 代码编辑器）

编辑：我知道`CTRL`+**`.`**但有没有你不必在之后按 enter 的地方？:-)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T04:31:31.720

F2 显示**重命名**对话框，允许重命名标识符的所有引用。

![在此处输入图像描述](../Images/118f6ef605714e29c587b649dbbbe58b.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-10T17:51:49.007

您可以通过以下简单方法重命名变量：右键单击 -> 重命名或 Ctrl+R-> Ctrl+R

![在此处输入图像描述](../Images/ae14254d6fcbb6731c3b558ad59cba70.png)

# linux - 禁止 x86/x86_64 上未对齐的内存访问

> ID：11837550
> 
> 赞同：16
> 
> 时间：2012-08-06T23:57:29.373
> 
> 标签：linux, debugging, x86, memory-alignment

我想在 x86/x86_64 上使用禁止的未对齐内存访问来模拟系统。是否有一些调试工具或特殊模式可以做到这一点？

当使用为 SPARC 或其他类似 CPU 设计的软件 (C/C++) 时，我想在几台 x86/x86_64 PC 上运行许多（CPU 密集型）测试。但是我对 Sparc 的访问是有限的。

据我所知，Sparc 总是检查内存读取和写入中的对齐是否自然（从任何地址读取一个字节，但仅当地址可被 4 整除时才允许读取 4 字节字）。

可能是 Valgrind 或 PIN 有这种模式？还是编译器的特殊模式？我正在寻找 Linux 非商业工具，但也允许使用 Windows 工具。

或者可能在 EFLAGS 中有秘密的 CPU 标志？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-07-19T14:20:21.630

我刚刚阅读了问题[是否未对齐的内存访问总是会导致总线错误？](https://stackoverflow.com/questions/1496848/does-unaligned-memory-access-always-cause-bus-errors)链接到 Wikipedia 文章[Segmentation Fault](http://en.wikipedia.org/wiki/Segmentation_fault "分段故障")。

在这篇文章中，有一个非常罕见的[英特尔处理器标志](http://en.wikipedia.org/wiki/FLAGS_register "标志寄存器")AC aka Alignment Check 的精彩提醒。

这是启用它的方法（来自维基百科的[总线错误示例](https://en.wikipedia.org/wiki/Bus_error#Example)，为 x86-64 System V 修复了一个[红色区域破坏错误](https://stackoverflow.com/questions/39160450/how-do-i-tell-gcc-that-my-inline-assembly-clobbers-part-of-the-stack)，因此这在 Linux 和 MacOS 上是安全的，并且[从基本 asm 转换而来](https://gcc.gnu.org/wiki/ConvertBasicAsmToExtended)，这在函数内部从来都不是一个好主意：您希望对 AC 的更改按照内存访问进行排序。

```
#if defined(__GNUC__)
# if defined(__i386__)
    /* Enable Alignment Checking on x86 */
    __asm__("pushf\n orl $0x40000,(%%esp)\n popf" ::: "memory");
# elif defined(__x86_64__) 
     /* Enable Alignment Checking on x86_64 */
    __asm__("add $-128, %%rsp \n"    // skip past the red-zone, in case there is one and the compiler has local vars there.
            "pushf\n"
            "orl $0x40000,(%%rsp)\n"
            "popf \n"
            "sub $-128, %%rsp"       // and restore the stack pointer.
           ::: "memory");       // ordered wrt. other mem access
# endif
#endif 
```

一旦启用，它的工作原理很像 ARM 对齐设置`/proc/cpu/alignment`，请参阅答案[如何捕获未对齐的内存访问？](https://stackoverflow.com/questions/16548059/how-to-trap-unaligned-memory-access)举些例子。

此外，如果您使用的是 GCC，我建议您启用`-Wcast-align`警告。在为具有严格对齐要求的目标（例如 ARM）构建时，GCC 将报告可能导致内存访问未对齐的位置。

但请注意，libc 为 memcpy 和其他功能编写的手写 asm 仍然会进行未对齐的访问，因此在 x86（包括 x86-64）上设置 AC 通常不实用。GCC 有时会发出 asm 进行非对齐访问，即使您的源没有，例如，作为一次复制或归零两个相邻数组元素或结构成员的优化。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-07T06:15:29.280

这很棘手，我没有亲自做过，但我认为你可以通过以下方式做到这一点：

x86_64 CPU（特别是我检查过 Intel Corei7，但我猜也有其他的）有一个性能计数器 MISALIGN_MEM_REF，它计数器未对齐的内存引用。

所以首先，你可以运行你的程序并在 Linux 下使用“perf”工具来计算你的代码已经完成的错位访问的数量。

一个更棘手和有趣的 hack 是编写一个内核模块，该模块对性能计数器进行编程以在溢出时生成中断并让它溢出第一个未对齐的加载/存储。在内核模块中响应此中断，但向您的进程发送信号。

实际上，这会将 x86_64 变成不支持未对齐访问的内核。

但这并不简单——除了您的代码之外，系统库还使用未对齐的访问，因此将它们与您自己的代码分开会很棘手。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2020-12-20T23:25:22.763

GCC 和 Clang 都内置了 UndefinedBehaviorSanitizer。其中一项检查 ,`alignment`可以使用`-fsanitize=alignment`. 它将发出代码以在运行时检查指针对齐情况，并在取消引用未对齐的指针时中止。

请参阅在线文档：

*   [https://clang.llvm.org/docs/UndefinedBehaviorSanitizer.html](https://clang.llvm.org/docs/UndefinedBehaviorSanitizer.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T00:14:52.577

也许您可以通过所有对齐的动作编译到 SSE。未对齐的访问`movaps`是非法的，并且可能会在其他架构上表现为非法的未对齐访问。

# c - 如何在 c 中使用 printf 打印整数

> ID：11837553
> 
> 赞同：-3
> 
> 时间：2012-08-06T23:58:03.603
> 
> 标签：c

我如何打印整数？当我使用：

```
int n = GetInt();

printf("%n \n", n); 
```

我得到一个错误，有一个未使用的变量，我无法编译它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T00:00:12.350

有符号整数使用`%d`（或`%i`）。

另请参阅`man 3 printf`（在类 Unix 系统上）以获取完整的修饰符列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T23:59:33.380

那是因为您需要使用与您传递的整数相对应的格式说明符。最常见的是`%d`. 尝试将 替换`%n`为`%d`.

[这是对所有格式代码的更深入的解释](http://www.cplusplus.com/reference/clibrary/cstdio/printf/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T00:18:01.610

正如其他答案所示，您通常`int`使用`%d`转换规范或可选地使用`%i`转换规范打印。您也可以使用`%o`,`%x`或`%X`(and `%u`)，尽管从技术上讲，这样做意味着有符号到无符号的转换。

请注意，这`%n`是[`printf()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/printf.html)等人的有效转换规范。但是，与所有其他转换规范不同，`%n`转换规范是一个输出操作，它接受一个指向 an 的指针`int`，它用于找出在格式字符串中已经写入了多少个字符。因此，您可以使用：

```
int n = GetInt();
int c;

printf("%d%n\n", n, &c);
printf("%d characters in number %d\n", c, n); 
```

还要注意，换行之前几乎不需要空格。

TR24731-1 [（](https://stackoverflow.com/questions/372980/do-you-use-the-tr-24731-safe-functions)或 ISO/IEC 9899:2011 附录 K，边界检查接口）定义了`printf_s()`等，并明确禁止`%n`转换规范，因为它经常导致问题，正是因为它是输出参数而不是输入参数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-16T05:12:07.957

`int n;`

```
printf("get number:");
scanf("%d",&n);
scanf("%d",&n); 
```

printf("你的号码是 %d\n",n); 返回0；

# javascript - 为什么reference = null 不影响被引用的对象？

> ID：11837556
> 
> 赞同：3
> 
> 时间：2012-08-06T23:58:23.290
> 
> 标签：javascript, types, reference, null

我知道这行得通，但我不知道为什么或为什么它以这种方式工作的原因：

```
var foo = [5, 10];
var bar = foo;
console.log(foo); //[5, 10]
console.log(bar); //[5, 10]
bar[0] = 1; 
console.log(foo); //[1, 10]
bar = null;
console.log(foo); //[1, 10] 
```

我预计不仅`bar`会变为空，而且`foo`也会变为空。我希望得到一些帮助来理解这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T00:03:18.043

当您这样做时`bar = null;`，只需将某些内容分配给`bar`变量的值。它不会影响过去分配给 的内容`bar`。该对象继续存在，如果有其他对它的引用，它仍然存在，其价值不受影响。

当你这样做时：

```
var foo = [5, 10];
var bar = foo; 
```

你有三个实体。您有一个数组`[5,10]`和两个变量，每个变量都引用了该数组。如果您更改数组，那么由于两个变量都指向同一个数组，因此无论您通过哪个变量引用数组，您都会看到更改。

但是，如果您设置`bar = null`，那只会影响`bar`不再引用数组的变量。它根本不影响仍然指向的数组`foo`。

事实上，如果你这样做：

```
var foo = [5, 10];
var bar = foo;
bar = [20,30]; 
```

你会有同样的结果。在第二行代码之后都`bar`指向`foo`同一个数组，但是在第三行之后，`bar`现在指向一个新数组并且只`foo`指向原来的数组。关键是要意识到使用`bar`修改它指向的对象`bar[0] = 1`和重新分配 bar 的整个值是有区别的`bar = [20,30]`。在第一种情况下，`foo`和`bar`指向的基础对象发生了变化。在第二种情况下，`bar`最初指向的底层对象没有被触及。相反，`bar`改为指向一个新对象并且不触及先前的对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T00:06:34.910

区别在于[重新绑定和变异](http://en.wikipedia.org/wiki/Name_binding#Rebinding_and_mutation)操作。

```
bar[0] = 1 
```

正在变异；它会影响`bar`指向的对象。

```
bar = null 
```

正在重新绑定；它只会影响标识符的`bar`含义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T00:08:04.767

您有两个指向数组的指针。Bar = foo 复制原始指针。取消引用 bar 不会取消引用 foo。

阅读更多@ [http://snook.ca/archives/javascript/javascript_pass](http://snook.ca/archives/javascript/javascript_pass)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T00:08:50.957

当你这样做

```
var foo = [5, 10]; 
```

它创建对数组的引用，如下所示

```
foo --->  [5, 10] 
```

当你分配`bar`给 时`foo`，你现在有

```
foo --->  [5, 10]

bar ------^ 
```

你打电话时

```
bar[0] = 1; 
```

你得到

```
foo --->  [1, 10]

bar ------^ 
```

where`foo`和`bar`指向同一个对象。

你打电话时

```
bar = null; 
```

你现在有

```
foo --->  [1, 10] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-07T00:09:19.077

参考，但它的定义只是指向某个对象的指针。当您分配`null`给 bar 时，您只需删除存储在 中的这个“指针” `bar`，使其不再指向对象。

把它想象成一个写在纸上的地址。如果工作表`foo`和`bar`上面有相同的地址，你发出一个命令：去写在工作表上的地址`foo`，把东西放在那里，操作完成后，自然地，任何人查看这些工作表并检查该地址，都会找到那些变化。现在你的分配`null`就像用橡皮擦从工作表上擦这个地址一样。它既不会触及任何其他床单，也不会以任何方式触及房屋。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-07T00:13:12.277

我喜欢将变量视为标签。使解释它们更容易。

```
//Create an array containing 5 and 10, and put the label "foo" on it
var foo = [5, 10];
//Put the label "bar" on the thing with the label "foo"
var bar = foo;      
console.log(foo); //[5, 10]
console.log(bar); //[5, 10]
//Take the thing labeled "bar" (which also has the label "foo") and change the first element to 1
bar[0] = 1;         
console.log(foo); //[1, 10]
//Take the label "bar" and attach it to nothing
bar = null;
console.log(foo); //[1, 10] 
```

var foo = [5, 10]; var bar = foo; 控制台.log(foo); //[5, 10] console.log(bar); //[5, 10] bar[0] = 1; 控制台.log(foo); //[1, 10] bar = null; 控制台.log(foo); //[1, 10]

# android - Android 用画布在位图上书写

> ID：11837559
> 
> 赞同：0
> 
> 时间：2012-08-06T23:59:13.103
> 
> 标签：android, canvas, bitmap, android-edittext

如何使我的 editText 写入内容，在 Bitmap 上写入我找到了这段代码，但它不起作用

```
EditText et = (EditText) findViewById(R.id.etWrite);
Bitmap b = Bitmap.createBitmap(500,500,Bitmap.Config.Alpha_8);
Canvas c = new Canvas(b);
et.draw(c); 
```

我想我应该使用 currentBitmap 我想，我试过但它不起作用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T00:16:56.570

试试我给你看的东西：

```
EditText et = (EditText) findViewById(R.id.etWrite);
et.buildDrawingCache();
Bitmap bmp = Bitmap.createBitmap(et.getDrawingCache());
Canvas c = new Canvas(bmp);
et.draw(c); 
```

希望它有效！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T00:27:45.560

`Bitmap.Config.ALPHA_8`仅绘制 Alpha 通道。使用`Bitmap.Config.ARGB_8888`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T05:04:23.477

此代码应该足以将生成的位图放到视图中。

```
EditText et = (EditText) findViewById(R.id.etWrite);
et.buildDrawingCache(); 
Bitmap bitmap = et.getDrawingCache(); 
```

现在使用以下行进行普通视图

```
view.setBackgroundDrawable(new BitmapDrawable(bitmap)); 
```

用于图像视图

```
imageview.setImageDrawable(new BitmapDrawable(bitmap)); 
```

AFAIK draw 方法将覆盖您使用画布传递给它的位图的像素值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T13:50:08.100

好的，所以这可能有点晚了，但基本上，您需要使用这些调用在画布上进行写入。首先，使用 OnFocusChanged 侦听器将您的 edittext 文本设置为字符串，然后在画布的 Ondraw(c) 调用中将其写入画布。在你这样做之前，虽然你需要一个字符串来从你的编辑文本中写入（etstring），并且你需要声明一个绘制对象。

```
 Paint paint= new Paint();
 paint.setTypeface(Typeface.SERIF); //sets typface
 int textx = screenwidth/2;  //use screenwidth/2 to center the text
 c.drawText(etstring, textx, 85, paint); //85 is the height 
```

# javascript - JavaScript setTimeout() 不会等待执行？

> ID：11837562
> 
> 赞同：9
> 
> 时间：2012-08-06T23:59:22.883
> 
> 标签：javascript, callback, settimeout, setinterval

考虑以下示例：

```
<script type="text/javascript">
    function alertBox(){
        alert('Hello World!');
    }
    function doSomething(){
        setInterval(alertBox(), 5000); //This is for generic purposes only
    };
    function myFunction(){
        setTimeout(doSomething(),3000);
    };

    myFunction();
</script> 
```

是什么导致它***立即***执行，而不是等待设置的 3 秒，以及只执行一次警报***，***而不是按预定的 5 秒间隔执行？

感谢您的任何帮助，您可以提供！

石匠

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-07T00:00:52.173

```
alertBox() 
```

这看起来不像是一个立即的函数调用吗？

尝试传递函数（而不执行它）：

```
setInterval(alertBox, 5000); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-07T00:00:43.317

这是因为您正在执行函数，而不是传递函数对象。

```
function myFunction(){
    setTimeout(doSomething, 3000); // no () on the function
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-11T06:05:36.113

以下代码执行不同，

```
setTimeout(console.log('Nuwan'),0)---(A); and 
setTimeout(function(){console.log('Nuwan'),0}) --- (B) 
```

原因是(B)在执行时，javascript runtime中的CallStack将setTimeout()推送到Web API，WebAPI等待0秒将回调函数推送到事件队列，然后EventLoop在当前堆栈完成后将回调推送到堆栈空的。

在案例（A）中，console.log()直接调用，因为它在WepAPI中，不需要去执行一个事件循环。

**更多参考：** WebAPI：[https](https://developer.mozilla.org/en-US/docs/Web/API/Console_API) ://developer.mozilla.org/en-US/docs/Web/API/Console_API Javascript 运行时和事件循环：[https ://cybrohosting.com/knowledgebase/17/How-JavaScript-works- in-browser-and-node.html](https://cybrohosting.com/knowledgebase/17/How-JavaScript-works-in-browser-and-node.html)

# asp.net-mvc - HttpPost 上的模型为空

> ID：11837565
> 
> 赞同：2
> 
> 时间：2012-08-06T23:59:42.337
> 
> 标签：asp.net-mvc, asp.net-mvc-3

这个让我彻底懵了……

我有一个非常简单的输入模型，具有三个字符串属性，如下所示：

```
public class SystemInputModel
{
    public string Name;
    public string Performance;
    public string Description;
} 
```

在我的控制器中：

```
public ViewResult AddSystem()
{
    return View(new SystemInputModel());
}

[HttpPost]
public ActionResult AddSystem(SystemInputModel model) 
{
    if (ModelState.IsValid)
    {
        var system = new OasisSystem
        {
            Name = model.Name,
            Description = model.Description,
            Performance = model.Performance
        };
        return Json(repository.AddSystem(system));
    }
    return Json(new {success = false, message = "Internal error"});
} 
```

风景：

```
<h2>Add System</h2>

@using (Html.BeginForm())
{
    @Html.ValidationSummary(true)
    <label>Name</label>
    @Html.EditorFor(m => m.Name)
    <br />
    <label>Description</label>
    @Html.EditorFor(m => m.Description)
    <br />
    <label>Performance</label>
    @Html.EditorFor(m => m.Performance)
    <br />

    <input type="submit" />
} 
```

我填写表格字段并点击提交。我查看了 Fiddler 中的原始帖子：

```
POST http://localhost.:4772/System/AddSystem HTTP/1.1
Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/x-ms-application, application/x-ms-xbap, application/vnd.ms-xpsdocument, application/xaml+xml, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*
Referer: http://localhost.:4772/System/AddSystem
Accept-Language: en-us
Content-Type: application/x-www-form-urlencoded
UA-CPU: x86
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; .NET4.0C; .NET4.0E; MS-RTC LM 8)
Connection: Keep-Alive
Content-Length: 42
Host: localhost.:4772
Pragma: no-cache
Cookie: ASP.NET_SessionId=5i4jtrrhjuujvtbpsju4bu3f

Name=foo&Description=bar&Performance=yes 
```

但是，传递给我的 HttpPost 控制器方法的模型对所有三个属性都有空值。如果我将它从我的模型对象更改为 FormCollection，我可以看到传入的三个属性。

为什么发布的字段没有映射到我的模型对象？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T01:14:12.473

默认的 MVC 3 模型绑定器需要模型的属性。

如果您将模型更改为此：

```
public class SystemInputModel
{
    public string Name { get; set; }
    public string Performance { get; set; }
    public string Description { get; set; }
} 
```

一切都会好起来。

# asp.net - MasterPage 代码文件的“继承”属性错误 - ASP.NET

> ID：11837567
> 
> 赞同：3
> 
> 时间：2012-08-06T23:59:48.040
> 
> 标签：asp.net, master-pages, code-behind, inheritance

我最近接管了一个应用程序的支持，该应用程序为一个离开我们公司的开发人员使用了为我们所有开发人员提供的标准模板。

当我尝试构建应用程序时，出现以下错误：

> 确保此代码文件中定义的类与'inherits' 属性匹配，并且它扩展了正确的基类（例如Page 或UserControl）。

这是导致错误的源代码：

MasterPage 标记

```
<%@ Master Language="C#" AutoEventWireup="true" CodeFile="AppStatic.master.cs" Inherits="AppStatic" %> 
```

后面的代码：

```
public partial class AppStatic : System.Web.UI.MasterPage 
```

我已经用谷歌搜索了这个错误消息和验证类名`Inherits`匹配的解决方案。`CodeFile`

# php - PHP 添加到购物车 - 如何创建数组？

> ID：11837569
> 
> 赞同：0
> 
> 时间：2012-08-07T00:00:15.847
> 
> 标签：php, arrays

我不明白该怎么做。这是我添加到购物车的脚本：

```
$_SESSION['sku'] = $_POST['sku'];
$_SESSION['quantity'] = $_POST['quantity'];

$_SESSION['cart'][] = array($_SESSION['sku'] => $_SESSION['quantity']);

foreach($_SESSION['cart'] as $sku => $quantity) {
    echo $sku . ":" . $quantity "<br/>";
} 
```

这呼应了这样的事情：

```
2:Array
3:Array
4:Array
5:Array 
```

我认为我的构建`$_SESSION['cart']`是正确的，是吗？我只是不明白如何正确地回显它们。

编辑：$_SESSION 的 var_dump 在玩了一会儿之后：

```
array(3) { ["sku"]=> &string(3) "503" ["quantity"]=> &string(1) "2" ["cart"]=> &array(17) { [0]=> array(1) { [506]=> string(1) "4" } [1]=> array(1) { [505]=> string(1) "2" } [2]=> array(1) { [505]=> string(1) "2" } [3]=> array(1) { [505]=> string(1) "2" } [4]=> array(1) { [505]=> string(1) "2" } [5]=> array(1) { [505]=> string(1) "2" } [6]=> array(1) { [505]=> string(1) "2" } [7]=> array(1) { [505]=> string(1) "2" } [8]=> array(1) { [505]=> string(1) "2" } [9]=> array(1) { [505]=> string(1) "2" } [10]=> array(1) { [506]=> string(0) "" } [11]=> array(1) { [505]=> string(1) "2" } [12]=> array(1) { [505]=> string(1) "2" } [13]=> array(1) { [503]=> string(1) "2" } [14]=> array(1) { [503]=> string(1) "2" } [15]=> array(1) { [503]=> string(1) "2" } [16]=> array(1) { [503]=> string(1) "2" } } } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T00:09:59.210

你的数组看起来像：

```
cart = Array(n){
         [0]=>  array(1){ ['SKU1'] => int(Quantity1)},
         [1]=>  array(1){ ['SKU2'] => int(Quantity2)},
...
} 
```

所以你实际上应该像这样使用它：

```
foreach($_SESSION['cart'] as $arr) {
    foreach($arr as $sku => $quantity) {
        echo $sku . ":" . $quantity . "<br/>";
    }    
} 
```

或者，您可以像这样将 SKU 添加到购物车：

```
$sku = $_SESSION['sku'];
$quantity = $_SESSION['quantity']);
$_SESSION['cart'][$sku] = $quantity; 
```

然后您就可以“按原样”使用您的代码：

```
foreach($_SESSION['cart'] as $sku => $quantity) {
    echo $sku . ":" . $quantity "<br/>";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T00:02:45.480

是的，你做得对。你想怎么看结果？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T00:13:35.450

做：

```
$_SESSION['cart'][$_SESSION['sku']] = $_SESSION['quantity']; 
```

只使用一个`foreach`

# iphone - 按下按钮更改视图控制器

> ID：11837571
> 
> 赞同：3
> 
> 时间：2012-08-07T00:00:26.020
> 
> 标签：iphone, objective-c, ios

我有两个视图控制器，我需要在 ViewControllerOne 中有一个按钮，当我按下它时向我显示 ViewControllerTwo。

在情节提要中，我将这两个视图与“Prepresenting Segues”相关联 - 推送模式。两个视图都有一个视图控制器类。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-07T00:54:58.937

我不确定您所说的“我将这两个视图都与 'Presenting Segues' - Push modal 相关联”是什么意思。您是在使用导航控制器并想要推送转场，还是想做模态转场？“推送模式”在术语上是矛盾的。

所以，让我们假设你想要一个模态转场。因此，您在第一个视图上放置一个按钮，右键单击并从该按钮拖动（或按住 Control 单击并拖动）到第二个视图。

![创建转场 1](../Images/c54575d371530d56d70a13d885fb606b.png)

你会弹出一个询问segue类型的窗口。选择“模态”。

![创建转场 2](../Images/9cf4477219eaade0d76e2a6bfd40fdb9.png)

你已经完成了从 1 到 2 的转换。不需要任何代码。

如果您希望第二个视图上的按钮将您带回第一个视图，您*不*希望从第二个视图返回到第一个视图的模态转换，而是您想要`dismissViewControllerAnimated`. 您可以通过自定义 segue 来执行此操作，或者更简单，只需一个调用`dismissViewControllerAnimated`. 因此，您将在第二个视图中添加一个按钮，并且当编辑器处于“助手”模式时（关联的 .h 文件显示在界面构建器下方；如果您想知道如何显示 .h 文件，请参见下文。 h 文件与 Interface Builder 屏幕同时显示），右键单击（或按住 Control 单击）并从第二个视图上的按钮向下拖动到第二个视图控制器的 .h 文件：

![解雇 1](../Images/f95b85c92ba78e0f5d7f6771f34d0961.png)

顺便说一句，如果您在那里看不到 .h 文件，请单击“助手”编辑器按钮并选择“自动”以便在此处显示文件，您应该会很好：

![助理编辑](../Images/609e11ccee02c3316fe25a3bcbece718.png)

然后它会向您显示一个弹出窗口，询问您想要做什么。选择`IBAction`并为您的新方法命名：

![解雇 2](../Images/7de3fb54a03b9eb6ea370ce95d763155.png)

然后转到视图控制器的代码，并添加`dismissViewControllerAnimated`代码：

![在此处输入图像描述](../Images/5a889926cf5a0503dbca089fdf272aca.png)

所有这些代码都说（在这个例子中，我刚刚调用了我的 IBAction `dismissTwo`）是：

```
- (IBAction)dismissTwo:(id)sender
{
    [self dismissViewControllerAnimated:YES completion:nil];
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-07T01:20:07.197

如果你想做一个 push segue，那就更容易了。首先，如果您还没有导航控制器，请通过选择第一个视图并选择“嵌入”-“导航控制器”来添加一个：

![推1](../Images/0a5c1d2f6ed7a86f772d8240d817c73f.png)

当您这样做时，您将拥有一个新的导航控制器（您实际上并不需要对其进行太多操作），并且第一个视图将有一个导航栏。

![推 2](../Images/54d6375c85a4c3d942c7fa69c3f154f4.png)

现在，右键单击（或按住 Control 单击）第一个视图的按钮并拖动到第二个视图：

![推 3](../Images/64d44255d5a90ba033a1aa67151172aa.png)

这一次，选择“push”segue：

![推4](../Images/13ebdcff88160015d89d474c048f1a14.png)

而且您会知道它有效，因为您的第二个视图将有一个导航控制器

![在此处输入图像描述](../Images/e87c32ebdd7c0cc4e21b1f59a353a391.png)

你不需要一个按钮来返回，因为导航控制器会自动有一个“返回”按钮，所以你不需要自己添加。

这就是你实现 push segue 的方式。

# php - 使用 JQuery 从多行（购物车）中捕获按钮按下

> ID：11837574
> 
> 赞同：1
> 
> 时间：2012-08-07T00:00:42.913
> 
> 标签：php, jquery, forms

我正在编写一个购物车类型功能，我在 $(.ajax) 调用中查询数据库中的许多项目（SKU、数量、名称）。我想显示一个表格，其中包含与用户正在寻找的所有项目相匹配的选项，用户可以在其中指定所需数量的选项。然后，他们可以单击“添加”将他们的选择添加到“购物车”。

这是一个简化的示例：

```
<table>
  <tr><td>Item A</td><td>SKU: 001</td><td>Qty: <input name="qty-sku001"> <input type="button" value="Add"></td></tr>
  <tr><td>Item B</td><td>SKU: 002</td><td>Qty: <input name="qty-sku002"> <input type="button" value="Add"></td></tr>
  <tr><td>Item C</td><td>SKU: 003</td><td>Qty: <input name="qty-sku003"> <input type="button" value="Add"></td></tr>
</table> 
```

单击按钮时，仅从一行获取信息的理想方法是什么？我正在考虑添加一个 onclick="AddToCart(x);" 到每个按钮，但这只是传递一个 HTML 表单元素对象。我是否需要将每一行设为自己的表单，还是可以获取按钮的父 TR，然后从该行的输入和其他元素中获取值？

数据最终将被附加到“购物车”div 的表中，所以我需要从我的 ajax 调用中加载的三段数据。我想我可以为每一行添加隐藏元素，但必须有一个更高效、更优雅的解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T00:06:20.840

假设你使用 jQuery，你可以使用这个：

```
$("input[type=button]").click(function(evn){
    var rowName = $(this).prev().attr('name'); // this will give you the name attribute of element that is before the button in the DOM

    // do here whatever you need with rowName
}); 
```

**编辑**

您可以向按钮添加一个类，以防止为页面上的所有按钮运行此代码，如下所示：

```
<input class="row-button" type="button" value="Add"> 
```

并使用这个 javascript：

```
$(".row-button").click(function(evn){
    // the code from above
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T00:16:33.080

```
$("input:button").click(function(){var $tr = $(this).closest('tr');}); 
```

$tr is the jquery row object that a button has been clicked

# ruby-on-rails-3 - Rails 3：链接到新窗口中的图像

> ID：11837575
> 
> 赞同：0
> 
> 时间：2012-08-07T00:00:44.973
> 
> 标签：ruby-on-rails-3

我想显示链接到打开新窗口（_target）的图像的文本，但我不知道 Rails 3 这样做的方式。我所有的搜索都刚刚使图像成为链接（即链接到（image_tag ....）），但这不是我想要做的。

我要做的是在我的资产/图像文件夹中显示文本链接“单击此处查看示例”到图像“example.gif”。

我试过：

`<%= link_to "Click here to see an example", image_tag("example.gif"), :target => "_blank" %>`

但这没有用。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T00:22:42.170

像这样 ：

```
<%= link_to "Click here to see an example", image_path("example.gif"), :target => "_blank" %> 
```

# android - Android - 使用 ViewFlipper 时出错

> ID：11837578
> 
> 赞同：0
> 
> 时间：2012-08-07T00:01:08.090
> 
> 标签：android, android-layout, android-widget, viewflipper, android-gui

一切看起来都很好，但是当我尝试通过按下按钮更改视图时仍然出现错误。这是代码：

```
 package com.example.testy;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.view.View;
import android.widget.ViewFlipper;

public class MainActivity extends Activity {

    ViewFlipper flipper;

    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        flipper = (ViewFlipper) findViewById(R.id.viewFlipper1);
        setContentView(R.layout.activity_main);

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    public void clcik(View v) {
        flipper.showNext();
    }

} 
```

这是我的 XML：

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="top" >

    <ViewFlipper
        android:id="@+id/viewFlipper1"
        android:layout_width="match_parent"
        android:layout_height="match_parent" >

        <Button
            android:id="@+id/button1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:onClick="click"
            android:text="Button!!" />

        <TextView
            android:id="@+id/textView1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="TextView!!" />
    </ViewFlipper>

</RelativeLayout> 
```

任何人都知道这段代码有什么问题吗？谢谢你的回答！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T00:04:00.623

也许你应该把你的方法的名字改成`click`?

```
 public void **clcik**(View v) {
        flipper.showNext();
    } 
```

由于`clcik`我们的活动代码中的拼写错误 ( )，您可能会收到一个异常，因为 Android 找不到该`click`方法。

感谢@yugidroid 的回答，我在您的代码中发现了另一个错误：

公共无效 onCreate(Bundle savedInstanceState) {

```
 super.onCreate(savedInstanceState);
    flipper = (ViewFlipper) findViewById(R.id.viewFlipper1);
    setContentView(R.layout.activity_main);

} 
```

你`findViewById`甚至在你有任何意见之前打电话（打电话给`setContentView`）。因此，您将获得 NullPointException。

我建议您调用方法`super.onCreate`的第一行`onCreate()`。这就是[谷歌所做](http://developer.android.com/training/basics/firstapp/starting-activity.html#DisplayMessage)的。

关于在布局上设置点击侦听器或在代码上创建侦听器和设置。好吧，没有太大区别，虽然后者肯定更快，因为第一个使用反射，这比仅仅调用一个方法成本更高。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T00:09:43.540

首先，确保你`setContentView(R.layout.activity_main);`在 super 之后调用，这是一个很好的做法。

您的问题是您设置`android:onClick="click"`但您在 Java 中引用了错误的方法（`clcik`不存在）。

我建议您在活动中声明和设置侦听器，而不是在 xml 中。

# android - 如何使 TimePicker 更小

> ID：11837581
> 
> 赞同：12
> 
> 时间：2012-08-07T00:01:34.577
> 
> 标签：android, android-layout, datetimepicker

是否可以在活动 xml 中使默认的 TimePicker 更小​​？我已经对此进行了搜索，但到目前为止只发现了如何创建一个我不想做的自定义时间选择器，或者创建一个我也不想做的弹出窗口。有没有人尝试过这个并取得了成功？我的 TimePicker 坐在滚动视图中的 tableRow 中。干杯

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2014-11-17T10:31:52.173

你可以这样做。我也有同样的问题。但谷歌帮助了我。您只需更改您的 XML 文件。

```
android:scaleY="0.90" & android:scaleX="0.90" 
```

它会根据您提供的百分比值缩小您的选择器。

仅适用于 API 11。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-30T18:30:19.093

您无法更改 TimePicker 的大小，但您可以做一件事。您可以将 TimePicker 作为对话框。

签出以下代码：

```
Button setTime;
setTime = (Button)findViewById(R.id.button1);
setTime.setOnClickListener(this);

public void onClick(View v) 
{
    TimePickerDialog tp1 = new TimePickerDialog(this, this, cal.get(Calendar.HOUR_OF_DAY), cal.get(Calendar.MINUTE), true);
    tp1.show();
}

public void onTimeSet(TimePicker view, int hourOfDay, int minute)
{
    cal.set(Calendar.HOUR_OF_DAY, hourOfDay);
    cal.set(Calendar.MINUTE, minute);
    //rest of the code
} 
```

# objective-c - 实例变量和方法如何存储在 Objective-C 2.0 对象中？

> ID：11837589
> 
> 赞同：5
> 
> 时间：2012-08-07T00:02:37.470
> 
> 标签：objective-c, objective-c-runtime

在 Objective-C 的旧版本中，objc_class 结构体是这样实现的：

```
struct objc_class {
    Class isa;
    Class super_class;
    const char *name;
    long version;
    long info;
    long instance_size;
    struct objc_ivar_list *ivars;
    struct objc_method_list **methodLists;
    struct objc_cache *cache;
    struct objc_protocol_list *protocols;
}; 
```

因此，表示对象的结构存储了指向对象类的指针，指向对象超类的指针，对象的类名，对象的版本，信息和实例大小，对象的实例变量列表，对象的方法列表，对象的缓存和对象的协议列表。结构中代表对象的这些字段的存在是很容易理解的，因为它们中的每一个都存储有关对象的信息。

然而，相同结构 objc_class 的 Objective-C 2.0 实现是这样的：

```
struct objc_class {
    Class isa;
}; 
```

因此，在这个版本的 objc_class 中，结构中只有一个字段：指向对象的类结构的指针。

那么，我的问题是，关于对象的其他信息如何存储在 Objective-C 2.0 中，因为结构中只有一个字段表示对象？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-07T00:07:52.043

这一切都在新的（好吧，不再那么新）非脆弱的 ABI 中了。

基本上，编译器不会像以前那样将 iVar 存储在结构中（如果超类更改了它的 iVar 布局，这会破坏继承），编译器会将 iVar 重定向通过另一层，类似于`objc_setAssociatedObject`在运行时。

这允许一些有趣的场景。考虑以下：

```
@interface A { // part of libA.a
   id var1;
   int var2;
   float var3;
} 

@end

@interface B : A { // part of libB.a
   id var4;
}

@end 
```

现在，如果某个时候，我们需要更改 class `A`，并且我们确定我们需要更高的精度`var3`（例如，将其转换为 a `long double`）怎么办？

在旧的、脆弱的 ABI 中，我们会被搞砸，直到`libB`更新的制造商。然而，有了这个新的、非脆弱的 ABI，我们可以灵活地改变所有这一切，同时`libB`仍然有效。

虽然理论上这可能会慢几个周期，但它增加了在运行时查找 iVar 的更简单方法、更灵活的子类化以及对不同类型 iVar 的支持（`__weak`例如）。

# c++ - 使用模板时出现 C++ 指针错误

> ID：11837598
> 
> 赞同：1
> 
> 时间：2012-08-07T00:03:54.073
> 
> 标签：c++, templates, generics, pointers, stl

嘿，我正在用 C++ 实现一个 ArrayList 的通用实现，其中一部分是实现 MergeSort，但现在我已经开始测试它，我遇到了一个奇怪的问题。在我的测试中，为了简单起见，我使用了 int 类型，在下面的第二个函数签名中，我收到了错误：

```
initializing argument 1 of 'T* ArrayList<T>::mergeSort(T*, int) [with T = int]' [-fpermissive] 
```

然后在第二个函数的递归调用中我得到这个错误：

```
invalid conversion from 'int' to 'int*' [-fpermissive] 
```

我不明白为什么它认为我正在尝试从 int 转换为 int ......不应该都是 int* 类型！？我是 C++ 的菜鸟，尤其是 C++ 中的泛型（虽然我精通 Java），所以任何有用的指针（不是双关语）都会受到赞赏！

```
/**
 * Runs merge sort on this ArrayList<T>. Interface function to the central,
 * recursive, merge sort function.
 */
template<class T>
void ArrayList<T>::mergeSort() {

    mergeSort(array, size);
}

/**
 * Runs merge sort on the passed in array. Recursive.
 *
 * @param array the array to sort.
 * @param arraySize the size of the array that is to be sorted.
 * @return the sorted array.
 */
template<class T>
T* ArrayList<T>::mergeSort(T* array, int arraySize) {

    T* returnArray = array;

    //If the arraySize isn't 1, recurse. Otherwise return the single element array.
    if (arraySize != 1) {

        returnArray = new T[arraySize];

        //Split arrays further. Recurse.
        returnArray = mergeSort(array[0], arraySize / 2);
        returnArray += arraySize / 2;
        returnArray = mergeSort(array[arraySize / 2], arraySize - (arraySize / 2));
    }

    return returnArray;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T00:13:13.150

在您的两个递归调用中，您不是在传递指针，而是在这些索引处传递数组中的值。

```
if (arraySize != 1) {

        returnArray = new T[arraySize];

        //Split arrays further. Recurse.
        returnArray = mergeSort(array[0], arraySize / 2);
        returnArray += arraySize / 2;
        returnArray = mergeSort(array[arraySize / 2], arraySize - (arraySize / 2));
    } 
```

将您的递归调用更改为：

```
returnArray = mergeSort(&array[0], arraySize / 2);
returnArray = mergeSort(&array[arraySize / 2], arraySize - (arraySize / 2)); 
```

或者：

```
returnArray = mergeSort(array, arraySize / 2);
returnArray = mergeSort(array + (arraySize / 2), arraySize - (arraySize / 2)); 
```

我不清楚你的第一个错误是什么，看起来你已经切断了部分错误信息。

# c - 使用openCV在avi视频上绘制框

> ID：11837600
> 
> 赞同：1
> 
> 时间：2012-08-07T00:04:07.597
> 
> 标签：c, opencv

嗨，我还是 openCV 的新手……我正在尝试读取 avi 视频，然后在一定数量的帧之后显示帧，以允许用户在感兴趣区域 (ROI) 周围绘制一个框，以便用户给出视频的名称和用于跳过此帧数后的帧数显示下一帧并让用户绘制一个框并保存像素角坐标

问题是......我不知道我的代码中的问题在哪里......我不能画一个盒子（我看不到盒子）

任何帮助将不胜感激

这是我的代码......我正在使用 openCV 2.4.0

CvRect 框；布尔绘图框=假；

void draw_box(IplImage* img, CvRect rect) { cvRectangle(img, cvPoint(box.x, box.y), cvPoint(box.x+box.width,box.y+box.height), cvScalar(255, 255,255 ),1); }

void my_mouse_callback(int event, int x, int y, int flags, void* param) { IplImage* image = (IplImage*) param;

```
switch( event )
{
    case CV_EVENT_MOUSEMOVE: 
        if( drawing_box )
        {
            box.width = x-box.x;
            box.height = y-box.y;
        }
        break;

    case CV_EVENT_LBUTTONDOWN:
        drawing_box = true;
        box = cvRect( x, y, 0, 0 );
        break;

    case CV_EVENT_LBUTTONUP:
        drawing_box = false;
        if( box.width < 0 )
        {
            box.x += box.width;
            box.width *= -1;
        }
        if( box.height < 0 )
        {
            box.y += box.height;
            box.height *= -1;
        }
        draw_box( image, box );
        break;
} 
```

}

int main (int argc, char * const argv[]) {

```
int n; 
char name [50]; 
box = cvRect(-1,-1,0,0);

if (argc==1)
{
    printf("\nEnter the name of the video:");
    scanf("%s",name); 
    printf("\nEnter number of frames:");
    scanf("%d",&n);

} else if (argc == 3)
{
    strcpy(name, argv[1]);
    n = atoi (argv[2]);
}
else 
{
    printf("To run this program you should enter the name of the program at least, or you can enter the name of the program then the file name then the number of frames ");
    return 0; 
}

// GET video
CvCapture* capture = cvCreateFileCapture( name );
if (!capture ) 
{
    printf( "Unable to read input video." );
    return 0;
}

int nframes = cvGetCaptureProperty( capture,CV_CAP_PROP_FRAME_COUNT);

//mouse data 
int ** points= new int*[nframes]; //x1, y1 , x2 , y2  
for (int i=0 ; i< nframes; i++)
    points[i]=new int [4]; 

// Read frame
IplImage* frame = cvQueryFrame( capture );

int c = 1; 
int sum = 1; 
char k ; 
cvNamedWindow("Draw box around the ROI ", CV_WINDOW_AUTOSIZE);

while(c <= nframes) 
{

    if(c == sum)
    {
        cvSetMouseCallback( "Draw box around the ROI ", my_mouse_callback, (void*) frame);

        cvShowImage("Draw box around the ROI ", frame);
        if( drawing_box ) 
        {
            draw_box( frame, box );
            cvShowImage("Draw box around the ROI ", frame);
            cvWaitKey( 15 ); 
        }

        points[c-1][0]= box.x  ;//x1
        points[c-1][1]= box.y ;//y1
        points[c-1][2]= box.x+box.width ;//x2
        points[c-1][3]= box.y+box.height ;//y2

        sum += n; 
    }

    frame = cvQueryFrame( capture );
    c++; 

    k = cvWaitKey(33);
    if( k == 27 ) 
        break;

}

// CLEAN everything
cvReleaseImage( &frame );
cvReleaseCapture( &capture );
cvDestroyWindow( "Draw box around the ROI" );

return 0; 
```

}

# php - 链式支付的订单摘要？

> ID：11837604
> 
> 赞同：0
> 
> 时间：2012-08-07T00:04:39.277
> 
> 标签：php, paypal, paypal-adaptive-payments

不久前，我建立了一个使用 Express Checkout 的网站。我会使用这种代码将买家的“购物车”发送到 PayPal：

（对于购物篮中的每件商品）：

```
$nvpstr = $nvpstr ."&L_PAYMENTREQUEST_0_NAME$key=$product[Name], $size[Size]";
$nvpstr = $nvpstr ."&L_PAYMENTREQUEST_0_NUMBER$key=$product[ID]";
$nvpstr = $nvpstr ."&L_PAYMENTREQUEST_0_DESC$key=$product[Description]";
$nvpstr = $nvpstr ."&L_PAYMENTREQUEST_0_AMT$key=$product[Price]";
$nvpstr = $nvpstr ."&L_PAYMENTREQUEST_0_QTY$key=$quantity"; 
```

但是，我决定使用自适应支付，特别是链式支付。我已经完全集成它并且工作正常，但我无法将项目列表发送到 PayPal。

我将如何使用链式付款来做到这一点？上面的代码当然不起作用，我找不到任何有关此的文档。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-30T22:26:27.203

Check the SetPaymentOptions API Operation.

[https://developer.paypal.com/docs/classic/api/adaptive-payments/SetPaymentOptions_API_Operation/](https://developer.paypal.com/docs/classic/api/adaptive-payments/SetPaymentOptions_API_Operation/)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-10T11:19:22.953

[以下是](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_APIntro)来自 PayPal 自适应支付页面的信息：

Adaptive Payments 提供多种支付方式：简单支付、并行支付和链式支付。您可以使用 Pay API 创建每种付款方式。

*   简单付款使发送方能够向单个接收方发送单笔付款。例如，您的网站可以使用自适应付款支付流程将销售产生的资金从客户的 PayPal 账户转移到您自己的账户。这是传统的支付方式。
*   **并行支付**使发送方能够将单笔付款发送给多个接收方。例如，您的应用程序可能是一个购物车，它使买家能够通过一次付款从多个商家处购买商品。您的购物车将付款分配给实际提供商品的商家。然后 PayPal 从发送者的账户中扣除款项，并将其存入接收者的账户。
*   **链式支付**使发送方能够向主要接收方发送单笔付款。主要收款人保留部分付款，并将剩余部分支付给次要收款人。例如，您的应用程序可以是处理机票预订、酒店预订和汽车租赁预订的在线旅行社。发件人仅将您视为主要收件人。您为您的佣金和其他接收方提供的服务的实际成本分配付款。然后，PayPal 从发件人的账户中扣除款项，并将其存入您的账户和次要收款人的账户。注意：链式付款还包括延迟的链式付款，其中向二级收款人的付款最多可延迟 90 天。

看起来你想要的是并行支付。[这里](https://cms.paypal.com/es/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_ECParallelPaymens)有一些关于并行支付的好信息。

# css - 在具有透明 div 的部分底部淡出文本，但覆盖 div 后高度保持在部分下方

> ID：11837606
> 
> 赞同：51
> 
> 时间：2012-08-07T00:04:49.483
> 
> 标签：css, html, fade, fadeout, fadein

我试图在一段文本的底部获得一个很好的淡出效果作为“阅读更多”指示器。

我一直在关注[这个](http://css-tricks.com/text-fade-read-more/)和其他教程，我的代码目前如下：

### html

```
<section>
    <p>malesuada fames ac turpis egestas...leo.</p>                                                                  
    <p>malesuada fames ac turpis egestas...leo.</p>
    <div class="fadeout"></div>
</section>
<p>Stuff after</p> 
```

### css

```
.fadeout {
    position: relative; 
    bottom: 4em;
    height: 4em;
    background: -webkit-linear-gradient(
        rgba(255, 255, 255, 0) 0%,
        rgba(255, 255, 255, 1) 100%
    ); 
} 
```

[jsFiddle](http://jsfiddle.net/6k3vV/)

问题是，即使我将透明 div 放置在文本主体上，4em 的空间仍然存在于和“其他东西”之间。

有任何想法吗？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2019-11-07T00:47:11.757

# 2020年答案：

现在可以使用真正的 alpha 透明度来实现此效果，而无需使用额外的`<div>`. 只需使用带有从到`mask-image`渐变的线性渐变的 CSS属性。浏览器应该为您处理其余的事情。演示：`black``transparent`

```
.container {
  -webkit-mask-image: linear-gradient(to bottom, black 50%, transparent 100%);
  mask-image: linear-gradient(to bottom, black 50%, transparent 100%);
  height:  150px;
  width: 300px;
  overflow-y: scroll;
}
body {
  background: #09f;
  transition: background 0.5s ease-out;
}
body:hover {
  background: #f90;
}
```

```
<div class="container">
  <p>Mouse in/out of this demo or scroll down to see that it's true alpha! <br/>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam sed nisl id lectus viverra faucibus. Cras sed est sit amet turpis placerat consequat. Vestibulum viverra accumsan nisl a dapibus. Quisque mollis porta dictum. Praesent dictum non nisl at rutrum. Nam sem orci, efficitur quis faucibus non, aliquam eget est. In nec finibus ex, quis tristique augue. Duis tristique turpis a nunc sodales tincidunt.</p>
  <p>Morbi vehicula nisi ut lacus ornare, ac tincidunt sapien pellentesque. Aliquam gravida id dolor eget volutpat. In hac habitasse platea dictumst. Aenean ac enim eros. Vivamus augue nunc, interdum vitae pellentesque nec, interdum non turpis. Quisque viverra eget nibh in varius. Vivamus vel euismod velit. Vivamus suscipit lorem et porttitor gravida. Donec non nulla nulla. Duis eget dui sed urna eleifend sagittis.</p>
</div>
```

这种方法最好的部分是它是真正的透明度，而不是通过用与背景匹配的颜色覆盖文本来伪装它。这允许滚动和背景图像！我在悬停时更改了背景颜色以证明它是真正透明的。

[浏览器支持非常可靠](https://caniuse.com/#search=mask-image)，除了 IE。

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2012-08-07T00:14:47.523

相对位置元素不会从正常的 html 流中删除，因此如果您将其移动到为其保留的初始空间仍然保留，但是对于绝对定位，情况并非如此

```
.fadeout {
    position: absolute; 
    bottom: 0em;
    width:100%;
    height: 4em;
    background: -webkit-linear-gradient(
        rgba(255, 255, 255, 0) 0%,
        rgba(255, 255, 255, 1) 100%
    ); 
    background-image: -moz-linear-gradient(
        rgba(255, 255, 255, 0) 0%,
        rgba(255, 255, 255, 1) 100%
    );
    background-image: -o-linear-gradient(
        rgba(255, 255, 255, 0) 0%,
        rgba(255, 255, 255, 1) 100%
    );
    background-image: linear-gradient(
        rgba(255, 255, 255, 0) 0%,
        rgba(255, 255, 255, 1) 100%
    );
    background-image: -ms-linear-gradient(
        rgba(255, 255, 255, 0) 0%,
        rgba(255, 255, 255, 1) 100%
    );
} 
section {position:relative} 
```

[**演示**](http://jsfiddle.net/mowglisanu/6k3vV/56/)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2017-01-14T16:07:16.370

参加聚会的时间很晚，但这也可以在没有`.fadeout`div 的情况下使用`::before`或`::after`伪元素来完成：

```
 section {
            position: relative;
        }

        section::after {
            content: '';
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 15px;
            background: -webkit-linear-gradient(
                    rgba(255, 255, 255, 0) 0%,
                    rgba(255, 255, 255, 1) 100%
            );
            background-image: -moz-linear-gradient(
                    rgba(255, 255, 255, 0) 0%,
                    rgba(255, 255, 255, 1) 100%
            );
            background-image: -o-linear-gradient(
                    rgba(255, 255, 255, 0) 0%,
                    rgba(255, 255, 255, 1) 100%
            );
            background-image: linear-gradient(
                    rgba(255, 255, 255, 0) 0%,
                    rgba(255, 255, 255, 1) 100%
            );
            background-image: -ms-linear-gradient(
                    rgba(255, 255, 255, 0) 0%,
                    rgba(255, 255, 255, 1) 100%
            );
        } 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2017-07-10T00:19:55.877

简单添加`.fade-out`到您想要“淡出”的元素上：

```
.fade-out {
  position: relative;
  max-height: 350px; // change the height
}
.fade-out:after {
  content: '';
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  background-image: linear-gradient( rgba(255, 255, 255, 0) 50%, rgba(255, 255, 255, 1) 100% );
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-27T16:56:53.787

只需替换`bottom: 4em`为`margin-top: -4em`. 非常适合我。

# objective-c - Objective C - 如何以编程方式停止执行以进行调试，同时允许继续？

> ID：11837608
> 
> 赞同：13
> 
> 时间：2012-08-07T00:04:57.213
> 
> 标签：objective-c, breakpoints, assertions, continuation

当以编程方式指定条件时，我已经成功地让调试版本停止执行，使用目标 C 中的标准 NSAssert(condition_which_should_evaluate_true, @"error message") 语句，并在断点导航器中添加“所有异常”断点。

很好，但是大多数时候我在调试时，我也想在那之后继续正常的程序执行。通常在断言失败后继续程序有助于追踪混淆/错误的来源。至少据我记得当我在不同的平台上编程时。

在 Objective C 开发中是否有这样做的标准方法？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-07T03:04:19.570

有办法。这不是 Objective-C 的东西，而是 Unix 的东西。

```
kill(getpid(), SIGSTOP); 
```

或者简单地说：

```
raise(SIGSTOP); 
```

在斯威夫特：

```
raise(SIGSTOP) 
```

这将在`__kill`or`__pthread_kill`函数中的调试器中中断。然后，您将需要向上几个堆栈帧来查看调用`kill`or的帧`raise`。您可以使用调试器的 continue 命令恢复执行。

请注意，如果您没有在调试器下运行并执行此操作，您的应用程序将挂起。看看 [技术问答 QA1631：检测调试器]( [http://developer.apple.com/library/mac/#qa/qa1361/_index.html](http://developer.apple.com/library/mac/#qa/qa1361/_index.html)。您可以使用该信息编写包装函数或宏仅`SIGSTOP`在调试器下运行时发送。[这个答案](https://stackoverflow.com/a/60295985/77567)可能会有所帮助。

此外，Foundation 框架提供了一个不同的断言宏以用于常规函数。是`NSCAssert`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T00:09:09.210

听起来您想使用条件断点。如果您通过单击源代码的边缘设置断点，然后按住 ctrl 并单击蓝色的小断点，您可以编辑一些选项，包括使断点以变量的值为条件。

这是[一篇包含一些屏幕截图](http://useyourloaf.com/blog/2011/03/01/xcode-conditional-breakpoints.html)和更多信息的博客文章。

[这个 Stack Overflow 问题](https://stackoverflow.com/questions/988621/how-to-set-a-conditional-breakpoint-in-xcode-based-on-an-object-string-property)也有一些很好的提示。

* * *

如果您坚持以编程方式触发断点，则编写一个函数并在其中放置一个断点：

```
void MyConditionalBreak(BOOL condition, NSString *comment)
{
    if (condition) {
        NSLog(@"Stopped because %@", comment); // SET BREAKPOINT ON THIS LINE
    }
} 
```

然后你可以用与 NSAssert 类似的方式调用这个函数。如果您在项目的预编译头文件 (Whatever.pch) 中声明该函数，它将在您的所有源文件中可用，而无需显式`#import`任何内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-10-18T06:51:18.623

这是我的做法：

首先，在断点选项卡中，如果引发任何异常，我将我的应用程序设置为中断： [![所有例外](../Images/16f59f27759f494d3a2352c357912b5a.png)](https://i.stack.imgur.com/oUAug.png)

然后在代码中（我通常有通用头文件，其中包含我在各处导入的通用定义）：

```
static void ThrowException(NSString* reason)
{
   @try 
   {
      @throw [NSException
               exceptionWithName:@"DebugAssertionException"
               reason:reason
               userInfo:nil];
   }  
   @catch (NSException * e) 
   {
      NSLog(@"%@", e);
   }
}

#define MYAssert(test, fmt, ...) if (!(test)) { ThrowException([NSString stringWithFormat:@"%s !!! ASSERT !!! " fmt, __PRETTY_FUNCTION__, ##__VA_ARGS__]); } 
```

现在，您可以像使用 NSAssert 一样使用它，但不是杀死您的应用程序，您只需触发一个断点：

```
MYAssert(bEverythingOkay, @"Something went wrong!");

// Or with arguments of course
MYAssert(bEverythingOkay, @"Something went wrong (TestValue=%zd; Reason=%@)", myTestValue, [this getLastError]); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-07T01:14:09.370

我绝不是该领域的专家，但我使用的代码可以通过键盘输入进入调试器。

[DCIntrospect](https://github.com/domesticcatsoftware/DCIntrospect/)来自 github 上的国内猫软件。

看看它的主文件[DCIntrospect.m](https://github.com/domesticcatsoftware/DCIntrospect/blob/master/DCIntrospect/DCIntrospect.m)的顶部，看看它是如何做到的。

它引用了一些来源，但根据我的经验，它与破解 armv6/7 上的调试器和模拟器所需的当前程序集相当最新

更多背景信息的外部参考

*   [http://blog.timac.org/?p=190](http://blog.timac.org/?p=190)
*   [http://developer.apple.com/library/mac/#qa/qa1361/_index.html](http://developer.apple.com/library/mac/#qa/qa1361/_index.html)
*   [http://cocoawithlove.com/2008/03/break-into-debugger.html](http://cocoawithlove.com/2008/03/break-into-debugger.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-04-28T04:50:31.173

不知道为什么没有人给出明确直接的答案......已经五年了，但迟到总比没有好..

* * *

### 预处理器：

```
#ifdef DEBUG
#define manualBreakpoint() \
            NSLog(@"\n\n\
                    Breakpoint called on: \n\n\
                    File: %s \n\n\
                    Line number: %i", __FILE__, __LINE__);\
                                                          \
            raise(SIGSTOP)
#else
#define manualBreakpoint() ;
#endif 
```

### 用法：

要使用它，只需键入以下内容：`manualBreakpoint();`

### 笔记：

> 这将在调用该代码时停止应用程序并在堆栈跟踪中显示当前方法（以及记录应用程序已停止的文件名和行号）如果您处于调试模式，则如果您处于生产模式appstore （又名*release*、*distribution*或*archive*）它什么也不做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-24T02:55:24.163

使用 Rob 的评论，以及来自“ios5 Programming: Pushing the Limits”和 Lumberjack 框架的一些想法，这里有一个宏可以让调试器在构建中的断言期间停止并允许继续`DEBUG`，但在其他情况下像往常一样在`RELEASE`（或实际上任何非`-DEBUG`）构建。

```
#ifdef DEBUG

#define MyAssert(condition, desc, ...) \
if (!(condition)) { \
    NSLog((desc), ## __VA_ARGS__); \
    if (AmIBeingDebugged()) \
        kill (getpid(), SIGSTOP); \
    else { \
        NSLog(@"%@, %d: could not break into debugger.", THIS_FILE, __LINE__); \
    } \
}

#define MyCAssert(condition, desc, ...) \
if (!(condition)) { \
    NSLog((desc), ## __VA_ARGS__); \
    if (AmIBeingDebugged()) \
        kill (getpid(), SIGSTOP); \
    else \
        NSLog(@"%@, %d: could not break into debugger.", THIS_FILE, __LINE__)); \
    } \
}

#else  //NOT in DEBUG

#define MyAssert(condition, desc, ...) \
if (!(condition)) { \
    DDLogError((desc), ## __VA_ARGS__); \   //use NSLog if not using Lumberjack
    NSAssert((condition), (desc), ## __VA_ARGS__); \
}

#define MyCAssert(condition, desc, ...) \
if (!(condition)) { \
    DDLogError((desc), ## __VA_ARGS__); \   //use NSLog if not using Lumberjack
    NSCAssert((condition), (desc), ## __VA_ARGS__); \
}

#endif //end  DEBUG

#endif 
```

这些宏需要函数`AmIBeingDebugged()`，您可以通过 Rob 提供的链接从 Apple 获得该函数：技术问答 QA1631：检测调试器。（您还需要`DEBUG`在构建设置中定义。）

请注意，我在非构建中选择了 Lumberjack's `DDLogError()`over ，因为它会吐出发生致命断言的方法、文件和行号。`NSLog()``DEBUG`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-10-24T20:20:45.013

如果您想使用控制台，一个简单的技巧是：

```
if (!condition_which_should_evaluate_true) {
   ; // Put breakpoint here
} 
```

然后将断点放在该行内。如果条件评估为 NO，则调用您的断点。

# java - java.sql.SQLException: ORA-01501: CREATE DATABASE 失败 ORA-01100: 数据库已经安装

> ID：11837609
> 
> 赞同：2
> 
> 时间：2012-08-07T00:05:56.427
> 
> 标签：java, jdbc, oracle11g, sqlexception

我制作了一些 MySQL java-jdbc 代码来创建数据库并向其中添加一些示例行。我想让这段代码也适用于 oracle 11g。因此，我相应地更改了代码中的连接 URL。但是，现在我得到了错误：

java.sql.SQLException: ORA-01501: CREATE DATABASE 失败 ORA-01100: 数据库已经安装

我不知道为什么会出现此错误。这是什么意思“数据库已经安装”？请帮我解决这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T08:47:26.700

关闭数据库，然后在 nomount 阶段启动它，然后应用 create database 语句

```
 SQL>shutdown immediate;
     SQL>startup nomount;
     SQL>CREATE ........ 
```

# memory-management - Fortran 可分配数组生命周期

> ID：11837616
> 
> 赞同：0
> 
> 时间：2012-08-07T00:06:36.263
> 
> 标签：memory-management, fortran, fortran90, dynamic-memory-allocation, fortran95

假设我有以下代码：

```
program test
  call foo
  call foo
contains
  subroutine foo
    integer(8),dimension(:),allocatable:: var1
    allocate(var1(10))
    ...
    return
  end subroutine foo
end 
```

变量 var1 会被分配两次吗？（我猜是）。如果为每个调用分配它，那么在第一次调用期间分配的内存是否会变得空闲？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-07T00:48:41.343

每次执行 ALLOCATE 语句（即每次调用 foo 过程）时，都会（尝试）分配 var1。

根据 Fortran 90 的规则（仅），当过程结束时 foo 的分配状态变为未定义。具有未定义分配状态的变量将变得不可用 - 您不能在随后的过程调用中合法地重新分配。

在 Fortran 95 和更高版本中，因为它是一个本地的、未保存的变量，所以每次 foo 过程的执行结束时都会释放 var1。

# java - java中更快的二维渲染

> ID：11837619
> 
> 赞同：2
> 
> 时间：2012-08-07T00:06:49.650
> 
> 标签：java, performance, swing, graphics, java-2d

在 java 中渲染 2d 图形的更快方法是什么？我见过的两种好方法是双缓冲，您可以在其中创建 BufferStrategy ，例如：

```
JFrame f = new JFrame();
f.setSize()
.....
createBufferStrategy(2); 
```

我见过的另一种方法是使用 createImage 方法。

```
Image dbimage = createImage(....);
Graphics g = dbimage.getGraphics();
.... 
```

这是我见过的两个。哪个最快？有没有更好的方法？请不要告诉我获取附加库，因为我知道它们存在。先感谢您...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T00:43:32.833

第一个片段 [BufferStrategy] 是在 java 中进行 2d 渲染的最快和推荐的方法。有了它，您可以利用硬件渲染或优化的软件渲染。当您进行全屏 2d 渲染时，性能非常显着。例如，您可以通过一个非常简单的操作（包括更改指向缓冲区的指针）来从更新屏幕的页面翻转中受益。另一个好处是在视频内存中有缓冲区。

# python - 通过 URL 的唯一用户配置文件

> ID：11837620
> 
> 赞同：0
> 
> 时间：2012-08-07T00:06:50.243
> 
> 标签：python, google-app-engine

好吧，我以前也问过这个问题。但是，当我问它时，我对 python 和应用程序引擎的了解有限。这很可能是我过去未能实现这一点的原因。我正在尝试根据用户名使每个配置文件都是唯一的。

任何人，在我深入研究之前，我都会抛出我的个人资料处理程序，该处理程序目前只处理当前登录的用户：

```
class Profile(MainHandler):
    def get(self):
        if self.user:
            current_user = str(self.user.name)
            key = ''
            imgs  = db.GqlQuery("select * from Profile_Images WHERE name =:1", current_user)
            team_name  = db.GqlQuery("select * from Teams WHERE name =:1", current_user)
            team_images  = db.GqlQuery("select * from Teamimg WHERE user =:1", current_user)
        for clan in team_name:
                name1 = clan.team_name_anycase
        for image in team_images:
            team_imagee = image.key()
        if self.user:
            for img in imgs:
                key = img.key()
            self.render('profile.html', team_img = team_imagee, team_name = name1, profile_image = key, username = self.user.name, email = self.user.email, firstname = self.user.first_name, last_name = self.user.last_name, country = self.user.country)
        else:
            self.redirect('/register') 
```

此处理程序通过 ('profile', Profile) 映射。

到目前为止，我所了解的是，我需要将用户名通过 URL 传递到配置文件处理程序中，然后使用该用户名作为标识符从数据库中提取数据。

我在 stackoverflow 上看到的内容是`('profile/<profile_id>', Profile)`. 我已经搞砸了一段时间，但似乎尾随用户名（例如 localhost:8080/profile/admin）出现 404 错误。我会假设我的映射失败，或者变量（即用户名）无法与配置文件处理程序交互。

有人可以帮我吗？我确信我拥有它，但它失败了。

**YAML 文件：**

```
application: suitegamer
version: 1
runtime: python27
api_version: 1
threadsafe: true

handlers:
- url: /static
  static_dir: static

- url: /img
  static_dir: img

- url: /.*
  script: main.app

libraries:
- name: jinja2
  version: latest

- name: PIL
  version: "1.1.7" 
```

**主处理器：**

```
class MainPage(MainHandler):
    def get(self):
    if self.user:
            self.render('index.html', username = self.user.name, firstname = self.user.first_name)
        else:
            self.render('index.html')

    def post(self):
    username = self.request.get('username').lower()
        password = self.request.get('password')

        u = User.login(username, password)
        if u:
            self.login(u)
            self.redirect('/news_page')
        else:
            msg = 'Invalid login.'
            self.render('login.html', error = msg) 
```

**映射：**

```
app = webapp2.WSGIApplication([('/', MainPage),
                               ('/logout', Logout),
                               ('/img', GetImage),
                               ('/register', Register),
                               ('/welcome', Welcome),
                               ('/news_page', News_Page),
                               ('/profile', Profile),
                               ('/edit_profile', Edit_Profile),
                               ('/change_profile_image', Change_Profile_Image),
                               ('/found_a_team', Found_Team),
                               ('/team_main', Team_Main),
                               ('/edit_team_main', Edit_Team_Main),
                               ('/edit_team_image', Edit_Team_Image)],
                              debug=True) 
```

**测试配置文件处理程序：**

```
class Profile(MainHandler):
    def get(self, profile_id):
        profile_id = 'admin'
        if self.user:
            key = ''
            imgs  = db.GqlQuery("select * from Profile_Images WHERE name =:1", profile_id)
            team_name  = db.GqlQuery("select * from Teams WHERE name =:1", profile_id)
            team_images  = db.GqlQuery("select * from Teamimg WHERE user =:1", profile_id)
        for clan in team_name:
                name1 = clan.team_name_anycase
        for image in team_images:
            team_imagee = image.key()
        if self.user:
            for img in imgs:
                key = img.key()
            self.render('profile.html', team_img = team_imagee, team_name = name1, profile_image = key, username = self.user.name, email = self.user.email, firstname = self.user.first_name, last_name = self.user.last_name, country = self.user.country)
        else:
            self.redirect('/register') 
```

图像处理程序：

```
class GetImage(MainHandler):
    def get(self):
        img = db.get(self.request.get("entity_id"))
        self.response.out.write(img.image) 
```

映射到 ('/img', GetImage)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:20:17.990

映射应如下所示：

```
('/profile/(.*)/?', Profile) 
```

并且您的 Handlers get 函数应该采用一个参数，该参数将是配置文件 ID/名称

```
class Profile(MainHandler):
    def get(self, profile_id):
        # do something with the profile id... 
```

我认为您应该对文档进行更深入的了解。
例如这里：[https ://developers.google.com/appengine/docs/python/tools/webapp/running](https://developers.google.com/appengine/docs/python/tools/webapp/running)

# c# - 向工作项添加超链接（不是指向另一个工作项的链接）

> ID：11837626
> 
> 赞同：2
> 
> 时间：2012-08-07T00:07:38.883
> 
> 标签：c#, tfs, tfs-sdk

我如何才能将超链接（不是指向另一个工作项的链接）添加到 TFS 中的工作项（使用 API）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T03:01:17.993

```
Hyperlink hl = new Hyperlink("http://microsoft.com");
hl.Comment = "Microsoft";

workItem.Links.Add(hl); 
```

[参考](http://blogs.microsoft.co.il/blogs/shair/archive/2008/10/06/more-about-creating-work-item-using-tfs-api.aspx)

# iphone - 在 UIImage 上绘制边框和阴影

> ID：11837633
> 
> 赞同：0
> 
> 时间：2012-08-07T00:08:12.010
> 
> 标签：iphone, objective-c, ios, uiimageview, uiimage

我已经能够成功地重绘带有边框的 UIImage，但不能使用边框 + 阴影。下面的代码成功地绘制了带有白色边框的图像，但我不知道如何在边框下添加阴影。非常感谢您的帮助！

```
- (UIImage *)generatePhotoFrameWithImage:(UIImage *)image {
    CGSize newSize = CGSizeMake(image.size.width + 50, image.size.height + 60);
    UIGraphicsBeginImageContext(newSize);
    CGRect rect = CGRectMake(25, 35, image.size.width, image.size.height);
    [image drawInRect:rect blendMode:kCGBlendModeNormal alpha:1.0];

    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSetRGBStrokeColor(context, 1.0, 1.0, 1.0, 1.0);
    CGContextStrokeRectWithWidth(context, CGRectMake(25, 35, image.size.width, image.size.height), 50);

    //CGContextSetShadowWithColor(context, CGSizeMake(0, -60), 5, [UIColor blackColor].CGColor);

    UIImage *result =  UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    return result;
} 
```

PS：我没有使用 UIImageView 因为我需要保留完整的图像质量。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-07T04:05:17.957

你需要`CGContextSetShadowWithColor`在描边之前调用，所以边框会投下阴影。

如果您不希望边框在图像上投射阴影，则需要设置一个透明层，在该图层中同时绘制图像和边框。[*您可以在Quartz 2D Programming Guide*](http://developer.apple.com/library/ios/DOCUMENTATION/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_trans_layers/dq_trans_layers.html#//apple_ref/doc/uid/TP30001066-CH210-TPXREF101)中阅读有关透明度层的信息。

如果要保留图像质量，则需要使用`UIGraphicsBeginImageContextWithOptions`并传入原始图像的比例。

```
- (UIImage *)generatePhotoFrameWithImage:(UIImage *)image {
    CGSize newSize = CGSizeMake(image.size.width + 50, image.size.height + 60);
    CGRect rect = CGRectMake(25, 35, image.size.width, image.size.height);

    UIGraphicsBeginImageContextWithOptions(newSize, NO, image.scale); {
        CGContextRef context = UIGraphicsGetCurrentContext();

        CGContextBeginTransparencyLayer(context, NULL); {
            [image drawInRect:rect blendMode:kCGBlendModeNormal alpha:1.0];

            CGContextSetRGBStrokeColor(context, 1.0, 1.0, 1.0, 1.0);
            CGContextSetShadowWithColor(context, CGSizeMake(0, 5), 5, [UIColor blackColor].CGColor);
            CGContextStrokeRectWithWidth(context, CGRectMake(25, 35, image.size.width, image.size.height), 50);
        } CGContextEndTransparencyLayer(context);
    }
    UIImage *result =  UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    return result;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-07T19:33:50.857

感谢 Rob 为我指明了正确的方向。这是在图像周围绘制白色边框的最终代码，然后在边框外部绘制浅灰色阴影

```
- (UIImage *)generatePhotoStackWithImage:(UIImage *)image {
    CGSize newSize = CGSizeMake(image.size.width + 70, image.size.height + 70);
    CGRect rect = CGRectMake(25, 25, image.size.width, image.size.height);

    UIGraphicsBeginImageContextWithOptions(newSize, NO, image.scale); {
    CGContextRef context = UIGraphicsGetCurrentContext();
        //Shadow
        CGContextSetShadowWithColor(context, CGSizeMake(0, 0), 10, [UIColor colorWithRed:0.0f green:0.0f blue:0.0f alpha:0.5f].CGColor);

        CGContextBeginTransparencyLayer (context, NULL);
        //Draw
        [image drawInRect:rect blendMode:kCGBlendModeNormal alpha:1.0];
        CGContextSetRGBStrokeColor(context, 1.0, 1.0, 1.0, 1.0);
        CGContextStrokeRectWithWidth(context, rect, 40);
        CGContextEndTransparencyLayer(context);
    }

    UIImage *result =  UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    return result;
} 
```

# propel - 在 Symfony 2.1 中将 FOS UserBundle 从 1.2 升级到 2.0 后出错

> ID：11837636
> 
> 赞同：4
> 
> 时间：2012-08-07T00:08:47.327
> 
> 标签：propel, fosuserbundle, symfony-2.1

我在 Symfony 2.1 中有一个项目，带有 PropelBundle 和 FOS UserBundle。我使用 Composer 将 FOS UserBundle 从 1.2 升级到最新版本 (2.0) 并按照说明删除 app/config/config.yml 文件中的“propel_user_class”定义，如[Upgrade.md 文件](http://symfony.vivons-ici.fr/vendor/bundles/FOS/UserBundle/Upgrade.md)中所示。我的新配置如下：

```
# FOSUserBundle Configuration
fos_user:
    db_driver: propel
    firewall_name: main
    user_class: MyVendor\MyBundle\Model\Member
    registration:
        form:
            type: myvendor_user_registration 
```

这样做并重建模型后，我在提交用户登录表单时收到以下错误：**“用户提供程序必须返回一个 UserInterface 对象。”**

我认为 FOS UserBundle 存在问题，无法识别我的用户类“成员”及其属性。在 FOS/UserBundle 的早期版本（1.2）中，[FOS\UserBundle\Model\UserInterface 是由代理对象实现的](https://github.com/FriendsOfSymfony/FOSUserBundle/blob/1.2.0/Resources/doc/index.md)，因此我之前的配置（正在运行）包括以下内容：

```
user_class: MyVendor\MyBundle\FOSUserBundle\Propel\UserProxy
propel_user_class: MyVendor\MyBundle\Model\Member 
```

我的 UserProxy.php 文件用于扩展 FOS\UserBundle\Propel\UserProxy 并添加特定于我的项目的属性。新的 UserBundle 版本不再需要 UserProxy.php 了吗？我还需要做什么才能使新的 UserBundle 版本正常工作？上面提到的 Upgrade.md 文件还谈到了配置文件表单不再将用户包装在 CheckPassword 类中，并且不再由 User 类完成令牌的生成。但是，我不确定是否必须因此而进行任何更改？谁能给我一些指导方针？

我尝试将我的 Member、Circle 和 MemberCircle 类定义架构移动到 app/Resources/FOSUserBundle/config/propel/schema.xml 以覆盖 FOS 用户包中的架构，如文档中所示，同时告诉我自己的包中的类扩展 FOS UserBundle 中的那些，但在尝试使用“app/console propel:build”构建推进模型时出现以下错误：

> [RuntimeException]
> “MyProjectName/app/Resources/FOSUserBundle/config/propel/schema.xml”资源被“MyBundle”派生包中的资源隐藏。创建一个“MyProjectName/app/Resources/MyBundle/config/propel/schema.xml”文件来覆盖捆绑资源。

我在 app/Resources/FOSUserBundle/config/propel/schema.xml 文件中保留了命名空间“FOS\UserBundle\Propel”。如何使该架构覆盖 FOS/UserBundle 中的架构？我可以在其中使用名为“Member”（用于用户）和“Circle”（用于组）的类吗？

# asp.net - 如何获取用户的输入来过滤 XML 文档？在 XSLT 中

> ID：11837642
> 
> 赞同：0
> 
> 时间：2012-08-07T00:09:18.753
> 
> 标签：asp.net, xml, xslt, button, input

我目前有以下 XSLT 文件

```
 <xsl:template match="/">
    <html>
      <head>

      </head>
      <body>
        <input type="text" id="txtSearch"/>
        <input type="submit" name="btnSearch" value="Search" onclick="" />

        <br />
        <br />
        <!-- Call to the procedure/function -->
        <xsl:apply-templates select="CommercialClients">
        </xsl:apply-templates>        
      </body>
    </html>
  </xsl:template>

  <!-- Procedure/function -->
  <!-- Loop through each AClient and retrieve CompanyName-->
  <xsl:template match="CommercialClients">
    <xsl:for-each select="AClient[starts-with(CompanyName,'L')]">
      <xsl:sort select="CompanyName" order="ascending"/>
        <xsl:value-of select="CompanyName"/>
        <br />
    </xsl:for-each>
  </xsl:template> 
```

而且我还有一个 XML 文档，它是这样的：

```
<CommercialClients>
<AClient>
<ClientNo>1813</ClientNo><CompanyName>K Plastics</CompanyName><FullAddress>
  <Address>Cleveragh Industrial Estate </Address>
  <Town>SLIGO</Town>
  <Country>IRELAND</Country>
  <PostCode>00353 7166</PostCode>
</FullAddress><TelephoneNo/>
</AClient> 
```

我的问题：我想使用我制作的按钮，以便当用户单击该按钮时，它会从文本框中获取用户的输入并过滤要显示的数据。

因此，如果用户输入文本框“L”，它只会显示以字母“L”开头的公司。目前，仅显示带有“L”的公司是硬编码的，我不确定如何使其成为用户定义的。

有什么帮助或想法吗？这是 ASPX 文件，但我不知道如何使用所有这些来编辑过滤器！

```
//from the request object get the value of the filter
string AFilter = Request.QueryString["txtFilter"];
//if there is no filter
if (AFilter == null)
{
    //make the filter a blank string (a null value will crash the program)
    AFilter = "";
}
//create an instance of the XML Conduit class passing the name of the xml file to the constructor
MyClassLibrary.clsXMLConduit MyXMLConduit = new MyClassLibrary.clsXMLConduit("commercial.xml");
//add a parameter to filter the data on company name
MyXMLConduit.AddParameter("CompanyFilter", AFilter);
//perform the transformation using the xslt file commercial.xslt
MyXMLConduit.Execute("commercial.xslt");
//set the character set encoding for the output stream
Response.Charset = "UTF-8";
//output the transformed document to the requesting browser
Response.Write(MyXMLConduit.TransformedOutput); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T06:22:59.697

看起来在您的 ASP.Net 代码中，您至少将过滤器值作为参数传递给 XSLT

```
MyXMLConduit.AddParameter("CompanyFilter", AFilter); 
```

在这种情况下，您需要在 XSLT 本身中声明参数。这将位于 XSLT 样式表的顶部，在任何 xsl:template 元素之外

```
<xsl:param name="CompanyFilter" /> 
```

如果你愿意，你可以给它一个默认值

```
<xsl:param name="CompanyFilter" select="'L'" /> 
```

然后，要使用它而不是进行任何硬编码，就像使用普通变量（以 $symbol 为前缀）

```
<xsl:for-each select="AClient[starts-with(CompanyName, $CompanyFilter)]"> 
```

# sql - 在 Rails 中，是否可以进行查询以返回文本或字符串列中字符数最少的所有记录？

> ID：11837644
> 
> 赞同：1
> 
> 时间：2012-08-07T00:09:34.227
> 
> 标签：sql, ruby-on-rails, ruby, activerecord

我问是因为彻底的谷歌搜索没有返回关于如何做到这一点的线索。

我正在尝试提取一个很少使用的列字段的示例，不幸的是，即使在空字段中也散布着换行符和破折号，所以我不能只要求那些有数据的字段。我需要一个至少有 10-15 个字符或类似内容的列。我还可以想象这个查询对于验证预先存在的数据很有用。我知道执行此操作的验证器，但我不是在尝试验证，而是在尝试搜索。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T00:21:00.390

似乎 ActiveRecord 不支持这一点。但是你无论如何都可以这样做（Mysql示例）

```
Model.where("CHAR_LENGTH(text_field) = ?", 10) 
```

在 Postgres 中同样应该工作，但在文档中它说使用 char_length()

* * *

您还可以做的是使用回调保存记录存储字段的大小

```
before_save {|r| r.text_field_size = r.text_field.size} 
```

有了这个，你现在可以用它来查询，这将是 DB 不可知的。

```
Model.where(text_field_size: 10) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T00:19:30.283

我认为您必须在 SQL 中编写请求的一部分。

对于 MySQL，使用类似：

```
Model.where("CHAR_LENGTH(field_name) >= ?", min_length) 
```

# jquery - jQuery mobile：为什么 .bind() 有效但 addEventListener 无效？

> ID：11837649
> 
> 赞同：0
> 
> 时间：2012-08-07T00:10:25.737
> 
> 标签：jquery, dom, jquery-mobile, jquery-events

使用 jQuery mobile，我试图在一个简单的复选框上注册一个单击事件处理程序，如下所示：

```
<input type="checkbox" name="cb" id="cb" />
<label for="cb">I am a checkbox</label> 
```

使用 jQuery 添加点击事件处理程序有效：

```
$("#cb").bind("click", function(){...}); 
```

不调用使用传统 DOM 方法添加的事件处理程序：

```
document.getElementById("cb").addEventListener("click", function(){...}); 
```

大问题是为什么？有任何想法吗？

ps 我对“pageinit”和“pagebeforeshow”的事件处理程序有类似的问题，这些问题只能在通过“bind”添加时接收。这些事件不是作为 DOM 事件触发的吗？

**[编辑]**

这是一个完整的测试用例（[链接到 jsfiddle](http://jsfiddle.net/p5MN2/)）：

```
<!DOCTYPE html> 
<html> 
    <head>
    <meta charset="utf-8">
    <title>My Page</title> 
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.css" />
    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.js"></script>
    <script>
        $(document).ready(function() {
            $("#cb").bind("click", function(){alert("Clicked by jquery")});
            document.getElementById("cb").addEventListener("click", function(){alert("Clicked by DOM")});
        });
    </script>
</head> 
<body> 

<div data-role="page">
    <input type="checkbox" name="cb" id="cb" />
    <label for="cb">I am a checkbox</label>
</div>

</body>
</html> 
```

**[编辑 2]**

回答我自己的问题：使用 jquery 移动 css 文件时似乎没有点击，可能是因为它在复选框上显示了标签。不使用 CSS，一切都按预期工作。

**[编辑 3]**

回答我自己的第二个问题，为什么我不能通过 addEventListener 捕获“pageinit”和其他自定义事件：这是一个[jQuery 错误](http://bugs.jquery.com/ticket/11047)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T00:30:30.437

据我所知 addEventListener 需要三个参数，而不仅仅是 2，例如：

```
/**
* in DHTML
* @param {String} type
* @param {Function} listener
* @param {Boolean} [useCapture]
*/
window.addEventListener = function(type,listener,useCapture) {}; 
```

或者

```
/**
* in DOMEvents
* @param {String} type
* @param {EventListener|Function} listener
* @param {Boolean} [useCapture]
*/
EventTarget.prototype.addEventListener = function(type,listener,useCapture) {}; 
```

# css - 浮动 div 中的对齐问题

> ID：11837650
> 
> 赞同：-1
> 
> 时间：2012-08-07T00:10:54.903
> 
> 标签：css

我在对齐浮动到左侧的 div 中的图像时遇到问题。在下面的代码中，如何将“logo.jpg”对齐垂直和水平居中？谢谢你。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" />
<title>layout</title>
<style type="text/css">

body,div,ul,li,dl,dt,dd,ol,p,h1,h2,h3,h4,h5,h6,form {font-size:11px; margin:0;padding:0;line-height: 150%;}
ul,ol,dl {list-style:none}
img {border:0;vertical-align:top;}
ul {list-style:none; padding:0; margin:0;}

#_layout {margin:0 auto; width:980px;}
#_top_cntr {width:980px; height:150px; background:#fff; margin-bottom:10px;}

/* top_cntr */
#_brand {height:110px; background:url(images/top_bg.jpg);}

#_left_logo {width:280px; height:110px; float:left; padding-left:10px;}
#_right_logo {width:680px; height:110px; float:right; margin-left:10px;}

</style>
</head>
<body>
<div id="_layout">
   <div id="_top_cntr">
       <div id="_brand">
            <div id="_left_logo">
                <img src="images/logo.jpg"/>
            </div>
            <div id="_right_logo">
            </div>
       </div>
     </div>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T01:32:27.727

我认为这通常可以通过 CSS 来完成。

```
<div id="_brand">
    <a id="_left_logo" class="img-replacement"> <!-- best practice to make the logo a link -->
        Now you can even throw text Here as a fall back when the image doesn't work
    </a>
    <div id="_right_logo">
    </div>
</div> 
```

接着：

```
.img-replacement {
    display: block;
    text-indent: -9999px;
}

#_left_logo {
    width:280px; 
    height:110px; 
    float:left; 
    padding-left:10px;

    /* and then: */
    background: url("/images/logo.png") center center no-repeat;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T00:21:27.437

你必须使用`vertical-align: middle`，但因为它只适用于元素，`display: table-cell`你还需要添加它，就像在[这个例子](http://jsfiddle.net/NbJyn/)中一样（我已经修改了#_left_logo 的样式）。

你可以看看[这篇文章](http://phrogz.net/css/vertical-align/index.html)，还有一些其他的方法可以让你的 div 的内容垂直居中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T04:00:59.023

如果您知道图像的高度，您可以使用`position: absolute`. 例如，图像大小为 200x60。

```
#_left_logo {width:280px; height:110px; float:left; padding-left:10px; position: relative;}

#_left_logo img {width:200px; height:60px; position: absolute; top: 50%; left: 50%; margin-top: -100px; margin-left: -30px; } 
```

# python - 如何在 Django 模型中编写此 SQL 查询

> ID：11837654
> 
> 赞同：0
> 
> 时间：2012-08-07T00:11:13.523
> 
> 标签：python, sql, django, django-models

我有一个模型主题

```
#models.py

class Subjects(models.Model)
    ....
    name = models.ForeignKey(User, unique=False)
    ....
    number_of_followers = models.IntegerField( I want to have something like this: SELECT COUNT( DISTINCT name ) FROM school_subjects; ) 
```

我真的不知道我是否可以在 IntegerField 中执行此操作，或者我必须将其添加到保存方法中。

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T00:17:15.233

像这样的东西（使用[`count()`](https://docs.djangoproject.com/en/dev/ref/models/querysets/#count)）？

```
Subjects.objects.all().count() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T00:56:01.607

试试这个：

```
school_subjects.objects.all().distinct('name').count() 
```

# mule - 需要在 Mule Studio 中设置 AMQP 连接器的步骤

> ID：11837656
> 
> 赞同：1
> 
> 时间：2012-08-07T00:11:24.400
> 
> 标签：mule, amqp

如果有人可以提供在 mule 流中为 AMQP 连接器设置入站端点的步骤，其中步骤 0 是从 github 下载 zip 文件的点，我将不胜感激。

似乎有这样一种假设的知识，即大多数人都知道如何从 github 获取一个 zip 文件，并以某种方式使该文件可用于 mule eclipse。我是否需要将其转换为 jar 文件，如果需要，我如何从 mule 项目中引用该文件？.. 非 Java 程序员的排列似乎无穷无尽

我已经通过 mule eclipse 成功地将来自 salesforce 的事件发送到了我的电子邮件，所以我在一个非常高的水平上得到了这个想法.. 但是添加一个连接器让我完全迷惑了

### 这是错误

错误 2012-08-07 00:35:30,833 [main] org.mule.module.launcher.application.DefaultMuleApplication: null org.springframework.beans.factory.parsing.BeanDefinitionParsingException：配置问题：无法找到命名空间的 NamespaceHandler [http ://www.mulesoft.org/schema/mule/amqp]

### 这是我的配置

```
<amqp:connector name="amqpConnector" host="localhost"></amqp:connector>

<flow name="test2" doc:name="test2">
    <amqp:inbound-endpoint exchangeName="topic"></amqp:inbound-endpoint>
    <smtp:outbound-endpoint host="relay.jangosmtp.net" port="25" user="xxxx" password="xxxx" to="xxx@xxxx.com" from="xxx@xxxx.com" subject="test" responseTimeout="10000" doc:name="SMTP"/>
</flow> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T17:57:06.060

这是我会尝试的：

*   从 Studio 中删除项目**而不删除文件**
*   Maven-ify Studio 项目： http: [//www.mulesoft.org/documentation/display/MULE3STUDIO/Importing+Maven+into+Studio](http://www.mulesoft.org/documentation/display/MULE3STUDIO/Importing+Maven+into+Studio)
*   将以下依赖项添加到`pom.xml`：

    ```
    <dependency>
      <groupId>org.mule.transports</groupId>
      <artifactId>mule-transport-amqp</artifactId>
      <version>3.3.0</version>
    </dependency> 
    ```

*   跑`mvn studio:studio`

*   将项目重新导入 Eclipse，其中应该添加了 AMQP 传输依赖项。

# jquery - 将 jQuery Datepicker 集成到 Rails 中

> ID：11837660
> 
> 赞同：1
> 
> 时间：2012-08-07T00:11:57.217
> 
> 标签：jquery, ruby-on-rails, datepicker

我`gem 'jquery-rails'`通过 Gemfile 安装了，并且在 application.js 文件中有以下内容：

```
//= require jquery
//= require jquery_ujs
//= require_tree . 
```

我正在尝试将以下代码集成到 Rails 3 中：

```
<script>
    $(function() {
        $( "#datepicker" ).datepicker();
    });
    </script>

<div class="demo">

<p>Date: <input type="text" id="datepicker"></p>

</div><!-- End demo --> 
```

我应该能够将它复制到我的视图（ERB）中，它应该可以正常工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T00:33:34.677

您还需要包含 jquery UI - [http://jqueryui.com/](http://jqueryui.com/)。这还将包括一个 CSS 文件，用于设置日期选择器小部件的样式，所以也不要忘记这一点。

# java - 写入的数据多于读取的数据时 NIO 失败

> ID：11837663
> 
> 赞同：3
> 
> 时间：2012-08-07T00:12:28.090
> 
> 标签：java, select, asynchronous, nio, nonblocking

我一直在玩弄 NIO 和非阻塞套接字，希望编写一个简单且高性能的服务器，如果写入或中间处理花费的时间超过应有的时间，我可以轻松地限制输入数据。不幸的是，我似乎无法理解选择过程的一些概念。

尽管我已经看到了一些奇怪的行为并且已经循环执行和重做我的代码，但有一个用例一直失败，这就是我在这里描述的那个 - 我尝试写入比我更多字节的情况读。

我一直在尝试遵循其他示例中的模式，其中套接字处于 READ 或 WRITE 状态（但永远不会同时处于两者，也永远不会），并且一旦有字节要写入，套接字就会切换到 WRITE，写入为尽可能多，然后切换回 READ。

从我的调试会话来看，如果我只是在没有任何读取的情况下写入，除非我在两者之间强制读取，否则选择永远不会返回（或仅在几秒钟后出现）。不幸的是，那时我不想阅读，因为我已经有太多的数据要处理，所以我尝试启用读取标志并只读取一个字节，但流量太多，即使这还不够。据我所知，它挂起的点没有与缓冲区大小或操作系统缓冲区大小相关的值。

该示例包含 4 个测试，测试 1 返回相同数量的字节并且有效，测试 4 返回一半，并且显然有效，测试 2 和 3 返回两倍的输入并且惨遭失败。

在这个示例中，我什至没有尝试限制输入（但记录缓冲区或队列是否已满），所以请帮助我并告诉我我做错了什么。

要对其进行测试，只需将任何数据转储到其中，如下所示：

```
cat /dev/zero | pv -bracN1 | nc ::1 8080 | pv -bracN2 > /dev/null 
    1:  338MB [  58MB/s] [56.3MB/s]
    2:  338MB [58.1MB/s] [56.3MB/s] 
```

示例代码：

```
package com.example;

import java.io.IOException;
import java.net.InetSocketAddress;
import java.net.ServerSocket;
import java.net.Socket;
import java.nio.ByteBuffer;
import java.nio.channels.SelectionKey;
import java.nio.channels.Selector;
import java.nio.channels.ServerSocketChannel;
import java.nio.channels.SocketChannel;
import java.nio.channels.spi.SelectorProvider;
import java.util.HashSet;
import java.util.Iterator;
import java.util.Set;
import java.util.concurrent.BlockingQueue;
import java.util.concurrent.LinkedBlockingQueue;
import java.util.logging.Level;
import java.util.logging.Logger;

/** Socket Server Example. */
public class SocketServer {

    /**
     * @param args ignored.
     * @throws IOException exception.
     */
    public static void main(final String[] args) throws IOException {
        final SocketServer server = new SocketServer();
        assert server != null;
    }

    private static final Logger LOGGER = Logger.getLogger(SocketServer.class.getName());

    /** The {@link ServerSocketChannel} we're listening to. */
    private final ServerSocketChannel serverChannel;
    /** The {@link Selector}. */
    private final Selector mSelector;
    /** The set of write interests. */
    // it seems that it's recommended to not change interests with multiple threads
    // so multiple other examples uses this indirection where the other thread registers
    // a hint to write by adding the relevant information to a list/set/etc., and then
    // the main thread where the select runs is the one picking this data and calling
    // the key.interestOps(xxx).
    private final Set<SocketChannel> mWriteInterests = new HashSet<SocketChannel>();

    /** @throws IOException exception. */
    public SocketServer() throws IOException {
        super();
        // listen to all 8080, good enough for testing
        final InetSocketAddress addr = new InetSocketAddress(8080);
        // open the socket channel
        this.serverChannel = ServerSocketChannel.open();
        // set it to non-blocking
        this.serverChannel.configureBlocking(false);
        // get the real socket
        final ServerSocket socket = this.serverChannel.socket();
        // set the socket to reuse so it doesn't hang on time-wait when the app is restarted
        socket.setReuseAddress(true);
        // create a selector
        this.mSelector = SelectorProvider.provider().openSelector();
        // register the socket into the selector, for accepting new connections
        this.serverChannel.register(this.mSelector, SelectionKey.OP_ACCEPT);
        // finally bind it to the address
        socket.bind(addr);
        if (SocketServer.LOGGER.isLoggable(Level.INFO))
            SocketServer.LOGGER.log(Level.INFO, socket + " started");

        // now loop!
        Iterator<SelectionKey> selectedKeys;
        SelectionKey key;
        while (true) {
            // set sockets to write if requested
            // this indirection is to ensure that the key.interestOps is
            // *never* called from a different thread
            synchronized (this.mWriteInterests) {
                for (final SocketChannel change : this.mWriteInterests) {
                    // socket closed or invalid / null key may happen if
                    // the connection is closed inbetween the other thread
                    // pinging this and the selector cycling
                    if (!change.isOpen())
                        continue;
                    key = change.keyFor(this.mSelector);
                    if (key == null || !key.isValid())
                        continue;
                    key.interestOps(SelectionKey.OP_WRITE);
                }
                this.mWriteInterests.clear();
            }

            this.mSelector.select();

            selectedKeys = this.mSelector.selectedKeys().iterator();
            while (selectedKeys.hasNext()) {
                key = selectedKeys.next();
                selectedKeys.remove();
                if (!key.isValid())
                    continue;
                // it seems the key has only one interest (never read+write), so a elseif is better here
                if (key.isAcceptable())
                    this.accept(key);
                else if (key.isReadable())
                    this.read(key);
                else if (key.isWritable())
                    this.write(key);
            }
        }
    }

    private void accept(final SelectionKey key) throws IOException {
        // For an accept to be pending the channel must be a server socket channel.
        final ServerSocketChannel serverSocketChannel = (ServerSocketChannel) key.channel();

        // Accept the connection and make it non-blocking
        final SocketChannel socketChannel = serverSocketChannel.accept(); // IOException
        socketChannel.configureBlocking(false); // IOException
        // get the socket and set it to no delay (so small packets don't hang on the OS's buffers
        final Socket socket = socketChannel.socket();
        socket.setTcpNoDelay(true);
        socket.setKeepAlive(true);
        socket.setTrafficClass(0x08 | 0x10);

        final SocketControl socketControl = new SocketControl() {

            @SuppressWarnings("synthetic-access")
            @Override
            public void hintWrite() {
                SocketServer.this.hintWrite(socketChannel);
            }
        };

        // instead of a map of connections and workers, we attach the worker directly to the
        // key, thank you for the key.attach() api!
        final Worker worker = new Worker(socketControl);
        // Register the new SocketChannel with our Selector, indicating
        // we'd like to be notified when there's data waiting to be read
        socketChannel.register(this.mSelector, SelectionKey.OP_READ, worker);
    }

    private void hintWrite(final SocketChannel socket) {
        // only call the selector.wakeup once per cycle, kind of
        boolean changed;
        synchronized (this.mWriteInterests) {
            changed = this.mWriteInterests.add(socket);
        }
        if (changed)
            this.mSelector.wakeup();
    }

    private void read(final SelectionKey key) throws IOException {
        final SocketChannel socketChannel = (SocketChannel) key.channel();
        final Worker worker = ( (Worker) key.attachment() );
        final ByteBuffer buf = worker.getReadBuffer();
        if (buf.remaining() == 0)
            System.err.println("buffer full BAD BAD BAD!"); // XXX
        else {
            int numRead;
            try {
                numRead = socketChannel.read(buf);
            }
            catch (final IOException e) {
                this.disconnect(key);
                return;
            }
            if (numRead <= 0) {
                this.disconnect(key);
                return;
            }
            System.out.println("read " + numRead);
        }
        worker.parseReadBuffer();
    }

    private void write(final SelectionKey key) throws IOException {
        final SocketChannel socketChannel = (SocketChannel) key.channel();
        final Worker worker = ( (Worker) key.attachment() );
        int wrote = 0;
        ByteBuffer buf;
        try {
            // write all data until...
            while (true) {
                buf = worker.getWriteBuffer();
                if (buf == null || buf.remaining() == 0)
                    // ...no more data
                    break;
                wrote += socketChannel.write(buf);
                if (buf.remaining() > 0) {
                    // ... or the socket's buffer fills up
                    break;
                }
                //break;
            }
        }
        catch (final IOException e) {
            this.disconnect(key);
            return;
        }
        worker.parseWriteBuffer();
        // if no more data to write, switch it back to READ mode.
        if (buf == null || buf.remaining() == 0)
            key.interestOps(SelectionKey.OP_READ);
        System.out.println("wrote " + wrote + " hasmore=" + ( buf != null && buf.remaining() != 0 ));
    }

    @SuppressWarnings("static-method")
    private void disconnect(final SelectionKey key) throws IOException {
        final SocketChannel socketChannel = (SocketChannel) key.channel();
        final Worker worker = (Worker) key.attachment();
        worker.disconnected();
        key.attach(null);
        // The remote forcibly closed the connection, cancel
        // the selection key and close the channel.
        key.cancel();
        key.channel().close();
        if (SocketServer.LOGGER.isLoggable(Level.INFO))
            SocketServer.LOGGER.log(Level.INFO, "[" + socketChannel.socket().getRemoteSocketAddress() + "] Disconnected");
    }

    private static interface SocketControl {

        /**
         * Hint the selector that there are bytes to write.
         */
        void hintWrite();

    }

    private static class Worker {

        // the SocketControl to hint when there are bytes to write
        private final SocketControl mSocketControl;
        // queue of incoming data
        private final BlockingQueue<ByteBuffer> mQueueIn = new LinkedBlockingQueue<ByteBuffer>(1024);
        // queue of outgoing data
        private final BlockingQueue<ByteBuffer> mQueueOut = new LinkedBlockingQueue<ByteBuffer>(1024);
        // buffer for incoming data
        private final ByteBuffer mReadBuf = ByteBuffer.allocate(8192);
        // holder for outgoing data
        private ByteBuffer mWriteBuf;
        // thread for doing something with the data
        private Thread mThread;

        Worker(final SocketControl socketControl) {
            super();
            this.mSocketControl = socketControl;
            final Runnable r = new Runnable() {

                private final int test = 3;

                @SuppressWarnings("synthetic-access")
                @Override
                public void run() {
                    while (true) {
                        try {
                            while (true) {
                                switch (this.test) {
                                    case 1: {
                                        // test case 1 simply writes back every incoming packet
                                        // expected and result values between 50 and 80MB/s in and out
                                        final ByteBuffer buf = Worker.this.mQueueIn.take();
                                        Worker.this.mQueueOut.put(buf);
                                        Worker.this.mSocketControl.hintWrite();
                                        break;
                                    }
                                    case 2: {
                                        // test case 2 writes back every incoming packet as a double-sized packet
                                        // expected values ?
                                        // result failed read and write
                                        final ByteBuffer buf = Worker.this.mQueueIn.take();
                                        final ByteBuffer buf2 = ByteBuffer.allocate(buf.remaining() * 2);
                                        buf2.put(buf);
                                        buf.flip();
                                        buf2.put(buf);
                                        buf2.flip();
                                        Worker.this.mQueueOut.put(buf2);
                                        Worker.this.mSocketControl.hintWrite();
                                        break;
                                    }
                                    case 3: {
                                        // test case 3 writes back every incoming packet as a two similar packets
                                        // expected values ?
                                        // result failed read and write
                                        final ByteBuffer buf = Worker.this.mQueueIn.take();
                                        final ByteBuffer buf2 = ByteBuffer.allocate(buf.remaining());
                                        buf2.put(buf);
                                        buf.flip();
                                        buf2.flip();
                                        Worker.this.mQueueOut.put(buf);
                                        Worker.this.mSocketControl.hintWrite();
                                        Worker.this.mQueueOut.put(buf2);
                                        Worker.this.mSocketControl.hintWrite();
                                        break;
                                    }
                                    case 4: {
                                        // test case 4 writes back every incoming packet as a half sized packets
                                        // expected and result values between 50 and 80MB/s in and exactly half out
                                        final ByteBuffer buf = Worker.this.mQueueIn.take();
                                        final ByteBuffer buf2 = ByteBuffer.allocate(buf.remaining() / 2);
                                        buf.limit(buf.remaining() / 2);
                                        buf2.put(buf);
                                        buf2.flip();
                                        Worker.this.mQueueOut.put(buf2);
                                        Worker.this.mSocketControl.hintWrite();
                                        break;
                                    }
                                }
                            }
                        }
                        catch (final Throwable t) {
                            if (t instanceof InterruptedException)
                                return;
                            t.printStackTrace();
                        }
                    }
                }
            };
            this.mThread = new Thread(r);
            this.mThread.start();
        }

        ByteBuffer getReadBuffer() {
            return this.mReadBuf;
        }

        void parseReadBuffer() {
            // skip until the whole incoming buffer if full
            // each read will increase the .position() until it reaches .limit()
            // which in this case is the same as .capacity, and hence remaining==0 
            // happens when position=limit=capacity
            if (this.mReadBuf.remaining() != 0)
                return;
            // flip switches position to 0 and limit to capacity, so we can read it
            this.mReadBuf.flip();
            // duplicate the bytebuffer
            final ByteBuffer bb = ByteBuffer.allocate(this.mReadBuf.remaining());
            // this will set bb and readbuf to position=limit=capacity
            bb.put(this.mReadBuf);
            bb.flip(); // set position to 0 so later it can be read
            // put the new buffer into the incoming queue
            if (this.mQueueIn.offer(bb))
                // reset the buffer to read more data
                this.mReadBuf.clear();
            else
                // here we don't reset, hoping the next read cycle will skip with
                // the other BAD BAD error, but maybe the queue will have space to
                // fit it and the code above will be sucessful
                System.err.println("queue full BAD BAD BAD!"); // XXX
        }

        ByteBuffer getWriteBuffer() {
            // if the writeBuf is null or completely writen, pick a new one from the queue
            if (this.mWriteBuf == null || this.mWriteBuf.remaining() == 0)
                this.mWriteBuf = this.mQueueOut.poll();
            return this.mWriteBuf;
        }

        void parseWriteBuffer() {
            // noop
        }

        void disconnected() {
            synchronized (this.mThread) {
                this.mThread.interrupt();
            }
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T08:59:44.517

我知道你想要非阻塞 NIO，但如果你想要一个高性能的 NIO 服务器，我会从这个作为基线开始，如果除了简单之外没有其他原因。通常最简单的也是最快的。

```
package example.nio;

import java.io.Closeable;
import java.io.IOException;
import java.net.InetSocketAddress;
import java.nio.ByteBuffer;
import java.nio.channels.ServerSocketChannel;
import java.nio.channels.SocketChannel;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class NioEchoServer implements Runnable, Closeable {
    private final ExecutorService service = Executors.newCachedThreadPool();
    private final ServerSocketChannel ssc;
    private volatile boolean closed = false;

    public NioEchoServer(int port) throws IOException {
        ssc = ServerSocketChannel.open();
        ssc.socket().setReuseAddress(true);
        ssc.bind(new InetSocketAddress(port));
        service.submit(this);
    }

    @Override
    public void run() {
        try {
            while (!closed) {
                SocketChannel sc = ssc.accept();
                service.submit(new EchoHandler(sc));
            }
        } catch (IOException e) {
            if (!closed)
                e.printStackTrace();
        } finally {
            closeQuietly(ssc);
        }
    }

    @Override
    public void close() throws IOException {
        closed = true;
        service.shutdownNow();
        closeQuietly(ssc);
    }

    static void closeQuietly(Closeable closeable) {
        try {
            if (closeable != null) closeable.close();
        } catch (IOException ignored) {
        }
    }

    public int getPort() {
        return ssc.socket().getLocalPort();
    }

    static class EchoHandler implements Runnable {
        private final SocketChannel sc;

        public EchoHandler(SocketChannel sc) {
            this.sc = sc;
        }

        @Override
        public void run() {
            ByteBuffer bb = ByteBuffer.allocateDirect(64 * 1024);
            try {
                while (!Thread.interrupted() && sc.read(bb) > 0) {
                    int len = bb.position();
                    bb.flip();
                    while (bb.remaining() > 0)
                       sc.write(bb);
                    // write everything a second time.
                    bb.position(0);
                    bb.limit(len);
                    while (bb.remaining() > 0)
                        sc.write(bb);

                    bb.clear();
                }
            } catch (IOException e) {
                e.printStackTrace();
            } finally {
                System.out.println("Server disconnected");
                closeQuietly(sc);
            }
        }
    }
} 
```

* * *

```
package example.nio;

import java.io.IOException;
import java.net.InetSocketAddress;
import java.nio.ByteBuffer;
import java.nio.channels.SocketChannel;
import java.util.concurrent.atomic.AtomicLong;

public class NioEchoClient {
    public static void main(String... arg) throws IOException, InterruptedException {
        NioEchoServer nes = new NioEchoServer(0); // use a free port.
        final SocketChannel sc = SocketChannel.open(new InetSocketAddress("localhost", nes.getPort()));
        // send data for 2 seconds.
        long writeCount = 0;
        final AtomicLong readCount = new AtomicLong();
        long start = System.currentTimeMillis();
        long end = start + 2000;
        Thread reader = new Thread(new Runnable() {
            @Override
            public void run() {
                ByteBuffer bb = ByteBuffer.allocateDirect(64 * 1024);
                bb.clear();
                int read;
                try {
                    while ((read = sc.read(bb)) > 0) {
                        bb.clear();
                        readCount.addAndGet(read);
                    }
                } catch (IOException ignored) {
                }
            }
        });
        reader.start();
        ByteBuffer bb = ByteBuffer.allocateDirect(64 * 1024);
        while (end > System.currentTimeMillis()) {
            bb.clear();
            int write = sc.write(bb);
            if (write < 0)
                throw new AssertionError("Unexpected disconnection?");
            writeCount += write;
        }
        sc.shutdownOutput();
        reader.join();
        long time = System.currentTimeMillis() - start;
        System.out.printf("Wrote: %,d bytes and read: %,d bytes in %,d ms%n",
                writeCount, readCount.get(), time);
        sc.close();
        nes.close();
    }
} 
```

印刷

```
Wrote: 186,318,848 bytes and read: 186,318,848 bytes in 2,001 ms 
```

当我写的是我读的两倍时，我得到

```
Wrote: 118,161,408 bytes and read: 236,322,816 bytes in 2,002 ms 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T00:16:59.383

当套接字发送缓冲区中有空间时，通道是可写的，内核中的缓冲区大小由 setSendBufferSize() 控制。它包含已发送但尚未被对等方确认的数据。如果它已满，则意味着对等方的接收缓冲区已满，这反过来意味着对等方的读取速度不如本地节点的写入速度。这是 TCP 的“窗口关闭”条件，一种自我节流的形式。

**编辑：**您的代码还有其他几个常见问题。

1.  关闭通道会取消其所有键。你不需要两者都做。并且已取消的密钥不再可访问，因此您也不需要将其附件清空。

2.  如果您遇到零长度读取，您将断开连接。这意味着当前没有数据可供读取。这不是断开连接的理由。

3.  accept() 有可能返回 null。

# opencv - OpenCV 中的 MU-SURF 实现

> ID：11837665
> 
> 赞同：0
> 
> 时间：2012-08-07T00:12:46.490
> 
> 标签：opencv, surf, ros

OpenCV 是否有 MU-SURF 描述符的实现？我正在使用基于 CenSuRe 的 Star Detector。我正在为具有 ROS 和 OpenCV 的移动机器人制作单目视觉里程计系统。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-09T13:28:21.047

不，但您可以使用此处提供的 MU-SURF 的 OpenSURF 实现[https://code.google.com/p/opensurf1/source/browse/trunk/OpenSURFcpp/src/surf.cpp](https://code.google.com/p/opensurf1/source/browse/trunk/OpenSURFcpp/src/surf.cpp)

# apache - 为什么这不会禁用我网站的目录列表？

> ID：11837666
> 
> 赞同：0
> 
> 时间：2012-08-07T00:12:49.547
> 
> 标签：apache, .htaccess

我在要禁用列表的目录`Options –Indexes`中的`.htaccess`文件中使用，但是当我转到该目录时，我仍然可以看到该目录中的所有文件。我究竟做错了什么？（阿帕奇服务器）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T01:30:24.217

有没有可能你已经`DirectorySlash`关机了？它使得对缺少尾部斜杠的目录的请求被重定向到*带有*尾部斜杠的同一目录。默认情况下它是打开的，但如果它被关闭，它有一个[奇怪的副作用，允许列出目录而不考虑`Indexes`选项](http://httpd.apache.org/docs/2.2/mod/mod_dir.html#directoryslash)：

> 关闭尾部斜杠重定向可能会导致信息泄露。考虑 mod_autoindex 处于活动状态（选项 +Indexes）并且 DirectoryIndex 设置为有效资源（例如 index.html）并且没有为该 URL 定义其他特殊处理程序的情况。在这种情况下，带有斜杠的请求将显示 index.html 文件。但是没有斜杠的请求会列出目录内容。

# java - 如何知道当前 JVM 上允许的最大可运行线程数？

> ID：11837675
> 
> 赞同：1
> 
> 时间：2012-08-07T00:13:44.817
> 
> 标签：java

我有一个在多个不同环境中运行的多线程应用程序，我认为有时环境会限制可以同时运行的线程总数。特别是，我认为其中一个系统只允许单个线程运行，因此多线程没有任何好处。有什么简单的方法可以判断这种情况何时发生？

```
ExecutorService exec = Executors.newFixedThreadPool(4);
TestRunnable tr = new TestRunnable();
for ( int i = 0; i < 20; i++ ) {
  try {
     exec.execute(sr);
  } catch (Exception E) {
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T02:33:28.493

> 我有一个在多个不同环境中运行的多线程应用程序，我认为有时环境会限制可以同时运行的线程总数。

是的，环境确实限制了实际上可以同时**运行**的线程数。具体来说：

*   硬件不能同时运行比物理机或虚拟机上可用的处理器（或超线程）更多的线程。
*   各种操作系统限制可能会阻止您使用所有可用资源；例如基于 ulimit 和 cgroup 的限制。

*   如果系统繁忙，您的 JVM 可能正在与其他应用程序进程竞争。

*   您的 Java 代码中可能存在并发瓶颈；例如，一个线程对某些数据结构的锁定经常阻碍其他线程。

但是，JVM 本身不会人为地限制您。

[`Runtime.availableProcessors`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Runtime.html#availableProcessors%28%29)您可以使用该方法找出可用处理器的名义数量。

* * *

注意：“可运行”线程的数量与“运行”线程的数量不同；即可以同时物理执行指令的线程数。“可运行”线程的数量是*可以*安排执行的线程数量......如果有足够的处理器可用。

# php - PHP 的 DOMXPath 中是否需要 registerNamespace？

> ID：11837679
> 
> 赞同：5
> 
> 时间：2012-08-07T00:14:04.713
> 
> 标签：php, domdocument, epub, domxpath

我正在使用这样的 XML：（它是 epub 书中的标准[container.xml ）](http://www.writersservices.com/wps/epub_container.htm)

```
<?xml version="1.0"?>
<container version="1.0" xmlns="urn:oasis:names:tc:opendocument:xmlns:container">
   <rootfiles>
      <rootfile full-path="OEBPS/9780765348210.opf" media-type="application/oebps-package+xml"/>
   </rootfiles>
</container> 
```

我正在尝试使用 PHP 解析它。到目前为止，这是我的代码：

```
$c = new DOMDocument();
$c->load($filename);
$x = new DOMXPath($c);
//fine up to here!

//is this even what I'm supposed to be doing?
$x->registerNamespace('epub', 'urn:oasis:names:tc:opendocument:xmlns:container');
$root = $x->query('/epub:container/epub:rootfiles/epub:rootfile');

//fine down from here!
$opf = $root->item(0)->getAttribute('full-path'); //I know I should check if the element's there and if it has the attribute. Not important. 
```

我的问题是：**有没有办法不打那个`registerNamespace`电话？**我不确定不同的 epub 是否设置了这个值有点不同，我需要这个代码来处理我扔给它的任何 epub。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-09T16:56:53.210

阿法克：没有。XML 文档可能会出现名称冲突，因此使用了名称空间。如果不注册一个或多个名称空间并为它们设置前缀，就无法在 XML 文档上使用 XPath。

在您的示例中，XML 声明了一个默认命名空间（`xmlns="<namespace identifier>"`），在这种情况下，所有没有一个或多个命名空间前缀的元素都将属于默认命名空间。只要您知道要查找的内容在此默认命名空间中，那么就会有一些更简单的事情：您可以做的不是硬编码默认命名空间并像这样获取它：

```
// ... load the DOMDocument ...

$defaultNamespace = $c->lookupNamespaceURI($c->namespaceURI);
$x->registerNamespace('epub', $defaultNamespace);

// ... now query like in your example
$root = $x->query('/epub:container/epub:rootfiles/epub:rootfile'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-05-09T00:01:30.617

为了详细说明 Max 的响应，如果您的 XML 文档本身没有声明默认命名空间，那么从技术上讲，您可以避免在 DOMXPath 上注册命名空间。这意味着文档中的所有元素都不会与任何命名空间相关联。但是，由于您使用的似乎是行业标准，我猜想在 XML 文档本身中声明该名称空间是必要的。如果您的 XML 文档如下所示，那么您可以跳过 registerNamespace 声明，而不必在查询中使用命名空间前缀“epub”。

```
<?xml version="1.0"?>
<container version="1.0">
   <rootfiles>
      <rootfile full-path="OEBPS/9780765348210.opf" media-type="application/oebps-package+xml"/>
   </rootfiles>
</container>
```

但是，大多数不是在单个组织内专门使用的 XML 文档都将声明一个默认名称空间。

# ios - UINavigationBar 上方的标题

> ID：11837680
> 
> 赞同：0
> 
> 时间：2012-08-07T00:14:12.533
> 
> 标签：ios, uinavigationcontroller, header, uinavigationbar

我的 iOS 应用程序当前正在使用一个，`UINavigationController` 但我需要在导航栏上方添加一个自定义标题。

它应该类似于以下内容：[Calcio app](http://itunes.apple.com/it/app/vodafone-calcio/id342886317?mt=8)

如何开发？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T00:56:00.837

您需要将 UINavigationController 的视图放在另一个 UIView 中。

默认情况下，您的 rootViewController 的视图被添加到应用程序委托的窗口中。

在应用程序委托级别，创建另一个 UIView 或 UIViewController 来管理 UINavigationController 的视图，以及显示您希望在 UINavigationBar 上方显示的任何其他视图。

# asp.net-mvc-3 - MVC3 动作中的 HTML5 视频无法正常工作

> ID：11837681
> 
> 赞同：2
> 
> 时间：2012-08-07T00:14:20.217
> 
> 标签：asp.net-mvc-3, html5-video, mediaelement.js, http-streaming, video.js

我正在从 MVC3 站点提供视频，返回视频的控制器操作返回 FilePathResult，当尝试在浏览器中播放时，我看到一些令人沮丧的问题，无论我使用的是 video.js 还是 mediaelement。 js。

*   Chrome 不允许您使用进度条更改位置，也不允许您在完成后重播视频
*   IE9好像还不错
*   Firefox 无法正确显示经过/剩余时间

但是，如果我只是提供托管文件的相对路径，那么一切正常。这些视频只需要对属于某些角色的用户开放，所以这不是一个真正的选择。

那个行动：

```
 [Authorize]
    public ActionResult Video(string fileName)
    {
        var pathBase = Server.MapPath("~/Downloads/Videos/");
        var filePath = pathBase + fileName;
        var contentType = ContentType(fileName);
        return new FilePathResult(filePath, contentType) { FileDownloadName = fileName };
    } 
```

剃须刀：

```
 <!-- @t = the video entity -->
   <video width="640" height="360" id="@t.Id" poster="@Url.Action("Video", "Download", new { fileName = @t.Poster })" controls="controls" preload="none">
        <!-- MP4 source must come first for iOS -->
        <source src="@Url.Action("Video", "Download", new { fileName = @t.Mp4 })" type='video/mp4' />
        <!-- WebM for Firefox 4 and Opera -->
        <source src="@Url.Action("Video", "Download", new { fileName = @t.WebM })" type='video/webm' />
        <!-- OGG for Firefox 3 -->
        <source src="@Url.Action("Video", "Download", new { fileName = @t.Ogv })" type='video/ogg' />
        <!-- Fallback flash player for no-HTML5 browsers with JavaScript turned off -->
        <object width="640" height="360" type="application/x-shockwave-flash" data="@Url.Content("~/Content/flashmediaelement.swf")">       
            <param name="movie" value="@Url.Content("~/Content/flashmediaelement.swf")" /> 
            <param name="flashvars" value="controls=true&poster=@Url.Action("Video", "Download", new { fileName = @t.Poster })&file=@Url.Action("Video", "Download", new { fileName = @t.Mp4 })" />         
            <!-- Image fall back for non-HTML5 browser with JavaScript turned off and no Flash player installed -->
            <img src="@Url.Action("Video", "Download", new { fileName = @t.Poster })" width="640" height="360" alt="@t.Title" 
                title="No video playback capabilities" />
        </object>   
    </video> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T04:51:03.940

我最终编写了一个 HTTP 处理程序来处理这些扩展，尽管 Chrome 的问题似乎与我的处理程序不支持 Range 请求有关。

我使用以下博客文章来帮助我：http: [//blogs.visigo.com/chriscoulson/easy-handling-of-http-range-requests-in-asp-net/](http://blogs.visigo.com/chriscoulson/easy-handling-of-http-range-requests-in-asp-net/)。解决方案（由我修改以包括内容类型，以及一些基本的安全性）如下：

```
 public void ProcessRequest(HttpContext context)
    {
        if (!context.Request.RequestContext.HttpContext.User.Identity.IsAuthenticated)
            context.Response.Redirect("~");
        var path =
            context.Request.RequestContext.HttpContext.Server.MapPath(
                context.Request.AppRelativeCurrentExecutionFilePath);
        long size, start, end, length, fp = 0;
        using (StreamReader reader = new StreamReader(path))
        {

            size = reader.BaseStream.Length;
            start = 0;
            end = size - 1;
            length = size;
            // Now that we've gotten so far without errors we send the accept range header
            /* At the moment we only support single ranges.
             * Multiple ranges requires some more work to ensure it works correctly
             * and comply with the spesifications: http://www.w3.org/Protocols/rfc2616/rfc2616-sec19.html#sec19.2
             *
             * Multirange support annouces itself with:
             * header('Accept-Ranges: bytes');
             *
             * Multirange content must be sent with multipart/byteranges mediatype,
             * (mediatype = mimetype)
             * as well as a boundry header to indicate the various chunks of data.
             */
            context.Response.AddHeader("Accept-Ranges", "0-" + size);
            context.Response.ContentType = "video/mp4";
            // header('Accept-Ranges: bytes');
            // multipart/byteranges
            // http://www.w3.org/Protocols/rfc2616/rfc2616-sec19.html#sec19.2

            if (!String.IsNullOrEmpty(context.Request.ServerVariables["HTTP_RANGE"]))
            {
                long anotherStart = start;
                long anotherEnd = end;
                string[] arr_split =
                    context.Request.ServerVariables["HTTP_RANGE"].Split(new char[] {Convert.ToChar("=")});
                string range = arr_split[1];

                // Make sure the client hasn't sent us a multibyte range
                if (range.IndexOf(",") > -1)
                {
                    // (?) Shoud this be issued here, or should the first
                    // range be used? Or should the header be ignored and
                    // we output the whole content?
                    context.Response.AddHeader("Content-Range", "bytes " + start + "-" + end + "/" + size);
                    throw new HttpException(416, "Requested Range Not Satisfiable");

                }

                // If the range starts with an '-' we start from the beginning
                // If not, we forward the file pointer
                // And make sure to get the end byte if spesified
                if (range.StartsWith("-"))
                {
                    // The n-number of the last bytes is requested
                    anotherStart = size - Convert.ToInt64(range.Substring(1));
                }
                else
                {
                    arr_split = range.Split(new char[] {Convert.ToChar("-")});
                    anotherStart = Convert.ToInt64(arr_split[0]);
                    long temp = 0;
                    anotherEnd = (arr_split.Length > 1 && Int64.TryParse(arr_split[1].ToString(), out temp))
                                     ? Convert.ToInt64(arr_split[1])
                                     : size;
                }
                /* Check the range and make sure it's treated according to the specs.
                 * http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html
                 */
                // End bytes can not be larger than $end.
                anotherEnd = (anotherEnd > end) ? end : anotherEnd;
                // Validate the requested range and return an error if it's not correct.
                if (anotherStart > anotherEnd || anotherStart > size - 1 || anotherEnd >= size)
                {

                    context.Response.AddHeader("Content-Range", "bytes " + start + "-" + end + "/" + size);
                    throw new HttpException(416, "Requested Range Not Satisfiable");
                }
                start = anotherStart;
                end = anotherEnd;

                length = end - start + 1; // Calculate new content length
                fp = reader.BaseStream.Seek(start, SeekOrigin.Begin);
                context.Response.StatusCode = 206;
            }
        }
        // Notify the client the byte range we'll be outputting
        context.Response.AddHeader("Content-Range", "bytes " + start + "-" + end + "/" + size);
        context.Response.AddHeader("Content-Length", length.ToString());
        // Start buffered download
        context.Response.WriteFile(path, fp, length);
        context.Response.Flush();
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-11T08:08:20.147

感谢您的回答！

我使用了类似的东西：

```
 internal static void StreamVideo(string fullpath, HttpContextBase context)
    {
        long size, start, end, length, fp = 0;
        using (StreamReader reader = new StreamReader(fullpath))
        {

            size = reader.BaseStream.Length;
            start = 0;
            end = size - 1;
            length = size;
            // Now that we've gotten so far without errors we send the accept range header
            /* At the moment we only support single ranges.
             * Multiple ranges requires some more work to ensure it works correctly
             * and comply with the spesifications: http://www.w3.org/Protocols/rfc2616/rfc2616-sec19.html#sec19.2
             *
             * Multirange support annouces itself with:
             * header('Accept-Ranges: bytes');
             *
             * Multirange content must be sent with multipart/byteranges mediatype,
             * (mediatype = mimetype)
             * as well as a boundry header to indicate the various chunks of data.
             */
            context.Response.AddHeader("Accept-Ranges", "0-" + size);
            // header('Accept-Ranges: bytes');
            // multipart/byteranges
            // http://www.w3.org/Protocols/rfc2616/rfc2616-sec19.html#sec19.2

            if (!String.IsNullOrEmpty(context.Request.ServerVariables["HTTP_RANGE"]))
            {
                long anotherStart = start;
                long anotherEnd = end;
                string[] arr_split = context.Request.ServerVariables["HTTP_RANGE"].Split(new char[] { Convert.ToChar("=") });
                string range = arr_split[1];

                // Make sure the client hasn't sent us a multibyte range
                if (range.IndexOf(",") > -1)
                {
                    // (?) Shoud this be issued here, or should the first
                    // range be used? Or should the header be ignored and
                    // we output the whole content?
                    context.Response.AddHeader("Content-Range", "bytes " + start + "-" + end + "/" + size);
                    throw new HttpException(416, "Requested Range Not Satisfiable");

                }

                // If the range starts with an '-' we start from the beginning
                // If not, we forward the file pointer
                // And make sure to get the end byte if spesified
                if (range.StartsWith("-"))
                {
                    // The n-number of the last bytes is requested
                    anotherStart = size - Convert.ToInt64(range.Substring(1));
                }
                else
                {
                    arr_split = range.Split(new char[] { Convert.ToChar("-") });
                    anotherStart = Convert.ToInt64(arr_split[0]);
                    long temp = 0;
                    anotherEnd = (arr_split.Length > 1 && Int64.TryParse(arr_split[1].ToString(), out temp)) ? Convert.ToInt64(arr_split[1]) : size;
                }
                /* Check the range and make sure it's treated according to the specs.
                 * http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html
                 */
                // End bytes can not be larger than $end.
                anotherEnd = (anotherEnd > end) ? end : anotherEnd;
                // Validate the requested range and return an error if it's not correct.
                if (anotherStart > anotherEnd || anotherStart > size - 1 || anotherEnd >= size)
                {
                    context.Response.ContentType = MimeMapping.GetMimeMapping(fullpath);
                    context.Response.AddHeader("Content-Range", "bytes " + start + "-" + end + "/" + size);
                    throw new HttpException(416, "Requested Range Not Satisfiable");
                }
                start = anotherStart;
                end = anotherEnd;

                length = end - start + 1; // Calculate new content length
                fp = reader.BaseStream.Seek(start, SeekOrigin.Begin);
                context.Response.StatusCode = 206;
            }
        }
        // Notify the client the byte range we'll be outputting
        context.Response.AddHeader("Content-Range", "bytes " + start + "-" + end + "/" + size);
        context.Response.AddHeader("Content-Length", length.ToString());
        // Start buffered download
        context.Response.WriteFile(fullpath, fp, length);
        context.Response.End();

    } 
```

# xml - 删除具有匹配子元素的 XML 文件的元素

> ID：11837685
> 
> 赞同：0
> 
> 时间：2012-08-07T00:14:33.533
> 
> 标签：xml, xml-parsing

`<offering>`我有一个包含很多元素的大型 XML 文件（180 兆左右） 。我想删除所有`<offering>`没有与某个事物（`<parent_id>12345</parent_id>`）匹配的子元素的 s。我从未使用过 Xquery，它看起来有点吓人（阅读：比我想象的要复杂得多）。任何人都可以推荐一个可以让我轻松做到这一点的程序吗？

在我的大脑中，它应该很简单，`DELETE <offering> WHERE <parent_id> <> '12345'`但是我查找的所有 xquery 看起来你必须声明一大堆废话，而且它是多行只是为了删除一些东西。

我找到了 XML Marker Free，它可以出色地处理大文件，但我找不到删除符合特定条件的多个元素的简单方法。

**编辑：我正在接近使用 vbscript 和 XML DOM。***

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T01:08:43.460

开始通过 windows vbscript 使用 XML DOM，并提出了这个似乎可以完美运行的解决方案。

```
Set objXMLDoc = Wscript.CreateObject("Microsoft.XMLDOM") 
objXMLDoc.async = False 

Dim XMLFile
XMLFile = "services.xml"
objXMLDoc.load(XMLFile) 
Set nodes = objXMLDoc.selectNodes("xml/offering/parent_id[. != '10001']")
For Each node In nodes
  objXMLDoc.documentElement.removeChild(node.parentNode)
Next

objXMLDoc.Save(XMLFile) 
```

# c# - Struct 内部值的意外行为

> ID：11837691
> 
> 赞同：0
> 
> 时间：2012-08-07T00:15:14.487
> 
> 标签：c#, struct

***解决了**。感谢各位的解释，我没有完全理解在这种情况下使用值类型的含义。

我有一个从静态类中使用的结构。但是，当我在运行时打印其内部状态时，该行为显示出意外行为。这是我的结构：

```
 public struct VersionedObject
    {

        public VersionedObject(object o)
        {
            m_SelectedVer = 0;
            ObjectVersions = new List<object>();
            ObjectVersions.Add(o);
        }

        private int m_SelectedVer;
        public int SelectedVersion
        {
            get
            {
                return m_SelectedVer;
            }

        }

        public List<object> ObjectVersions;//Clarifying:  This is only used to retrieve values,  nothing is .Added from outside this struct in my code.

        public void AddObject(object m)
        {
            ObjectVersions.Add(m);
            m_SelectedVer = ObjectVersions.Count - 1;
        }
    } 
```

**测试代码**

```
 VersionedObject vo = new VersionedObject(1);
        vo.AddObject(2);//This is the second call to AddObject()
        //Expected value of vo.SelectedVerion:  1
        //Actual value of vo.SelectedVersion:   1 
```

现在，如果您单独测试此代码，即，将其复制到您的项目中试一试，***它将返回预期的结果。***

**问题;** 我在生产代码中观察到的是这个调试输出：

```
objectName, ObjectVersions.Count:2, SelectedVer:0, 
```

为什么？根据我的理解和测试，这在任何情况下都应该是完全不可能的。

我的随机猜测是存在某种不变性，由于某种原因，正在通过默认构造函数实例化一个新结构，并且正在复制 ObjectVersions 数据，但是 m_SelectedVersion 是私有的，不能复制到新结构中?
我使用静态类和方法来操作结构与它有什么关系吗？

我很困惑，我现在只是在胡乱猜测。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T00:21:55.993

结构是值类型。因此，您很可能正在实际代码中创建对象的多个副本。

考虑简单地将结构更改为类，因为结构的内容并不适合值类型（因为它是可变的并且还包含可变引用类型）。

有关“结构是值类型”的更多信息：

首先检查已经有很多好的答案的[常见问题解答。](https://stackoverflow.com/questions/tagged/struct+c%23?sort=frequent)

值类型是按值传递的 - 因此，如果您调用函数来更新此类对象，它将不会更新原始对象。您可以将它们类似于将整数值传递给函数：即您希望`SomeFunction(42)`能够更改 42 的值吗？

```
struct MyStruct { public int V;}
void UpdateStruct(MyStruct x)
{
  x.V = 42; // updates copy of passed in object, changes will not be visible outside.
}
....
var local = new MyStruct{V = 13}
UpdateStruct(local); // Hope to get local.V == 42
if (local.V == 13) {
  // Expected. copy inside UpdateStruct updated,
  // but this "local" is untouched.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T00:39:16.607

为什么这是一个结构而不是一个类？更好的是，您为什么要跟踪后备存储 ( `List<T>`) 的大小，而不是让`List<T>`跟踪为您服务。由于该底层后备存储是公共的，因此可以在您的结构不知情的情况下对其进行操作。我怀疑您的生产代码中的某些内容正在添加到后备存储中而无需通过您的结构。

如果是我，我会设置这样的东西，虽然我会把它变成一个类......但这几乎可以肯定是一个突破性的变化：

```
public struct VersionedObject
{

    public VersionedObject()
    {
        this.ObjectVersions = new List<object>() ;
        return ;
    }

    public VersionedObject(object o) : this()
    {
        ObjectVersions.Add(o);
        return ;
    }
    public VersionedObject( params object[] o ) : this()
    {
        ObjectVersions.AddRange( o ) ;
        return ;
    }

    public int SelectedVersion
    {
        get
        {
            int value = this.ObjectVersions.Count - 1 ;
            return value ;
        }
    }
    public List<object> ObjectVersions  ;

    public void AddObject(object m)
    {
        ObjectVersions.Add(m);
        return ;
    }

} 
```

您会注意到这与您的结构具有相同的语义，但该`SelectedVersion`属性现在反映了后备存储中的实际内容。

# python - 使用 get_current_user() 方法时产生此 python AttributeError 的原因是什么？

> ID：11837693
> 
> 赞同：3
> 
> 时间：2012-08-07T00:15:42.453
> 
> 标签：python, google-app-engine, syntax-error, jinja2

这行代码：

```
 geted_nickname = user.nickname() 
```

这个处理程序：

```
class MainHandler(webapp2.RequestHandler):
    def get(self):
        user = users.get_current_user()
        if user == None:
            self.redirect(users.create_login_url(self.request.uri))
        geted_nickname = user.nickname() 
```

正在产生此错误：

```
File "C:\Users\Py\Desktop\Apps\contract\main.py", line 99, in get
    geted_nickname = user.nickname()
AttributeError: 'NoneType' object has no attribute 'nickname' 
```

由于`user`是 NoneType 对象，程序应该执行 if 块`self.redirect(users.create_login_url(self.request.uri))`，但这没有发生。为什么？如何解决？

谢谢你的帮助！

这里是整个代码：

```
# -*- coding: utf-8 -*-
# -*- coding: utf-8 -*-
#!/usr/bin/env python
#
# Copyright 2007 Google Inc.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

from google.appengine.api import users

from google.appengine.ext.webapp.util import run_wsgi_app

import os

import webapp2

import jinja2

jinja_environment = jinja2.Environment(autoescape=True,
    loader=jinja2.FileSystemLoader(os.path.join(os.path.dirname(__file__), 'templates')))

import re

from google.appengine.ext import db

USER_RE = re.compile(r"^[a-zA-Z0-9_ -]{3,20}$")
def valid_person(person):
    return USER_RE.match(person)

PASS_RE = re.compile(r"^.{3,20}$")
def valid_SSN(SSN):
    return PASS_RE.match(SSN)

EMAIL_RE = re.compile(r"^[\S]+@[\S]+\.[\S]+$")
def valid_email(email):
    return EMAIL_RE.match(email)

clauses = {u'Software development agreement':"Don't be evil", 'Car Rental Contract':"non-skid the tires", 'House Rental Contract':"Don't break stuff"}

import time

import datetime

def dateToday():
    today = datetime.datetime.today()
    todayDay = str(today.day)
    todayMonth = str(today.month)
    monthExt = {'1':' January ', '2':'February', '3':' March ', '4':'April', '5':'May', '6':'June', '7':' July ', '8':'August', '9':'September', '10':'October', '11':'November ', '12':'December'}
    todayYear = str(today.year)
    return(todayDay + ' of  ' + monthExt[todayMonth] + ' of ' + todayYear)

class Person(db.Model):
    person_name = db.StringProperty(required = True)
    nacionality = db.StringProperty(required = True)
    marital_status = db.StringProperty(required = True)
    profession = db.StringProperty(required = True)
    SSN = db.IntegerProperty(required = True)
    driver_license = db.IntegerProperty(required = True)
    address = db.address = db.PostalAddressProperty(required = True)

class Contract(db.Model):
    book_number = db.IntegerProperty(required = True)
    initial_page = db.IntegerProperty(required = True)
    final_page = db.IntegerProperty(required = True)
    contract_type = db.StringProperty(required = True)
    date = db.DateProperty (required = True, auto_now = True, auto_now_add = True)

class RegisteredUser(db.Model):
    user_name = db.UserProperty()
    user_nickname = db.StringProperty()
    name = db.StringProperty()
    user_position = db.StringProperty()
    org_name = db.StringProperty()
    org_address = db.StringProperty()
    org_city = db.StringProperty()
    org_state = db.StringProperty()

class ContractingParty(db.Model):
    person = db.ReferenceProperty(Person, required=True, collection_name="party_to_contracts")
    contract = db.ReferenceProperty(Contract, required=True)
    condition = db.StringProperty(required = True, choices=set(["active position", "passive position", "witness"]))

class MainHandler(webapp2.RequestHandler):
    def get(self):
        user = users.get_current_user()
        if user == None:
            self.redirect(users.create_login_url(self.request.uri))
        geted_nickname = user.nickname()
        registeredUser = db.GqlQuery("SELECT * FROM RegisteredUser WHERE user_nickname =:nickname", nickname = geted_nickname).get()
        if registeredUser is None:
            self.redirect('/register?user_nickname=%s' % (geted_nickname))
        contract = db.GqlQuery("SELECT * FROM Contract ORDER BY date DESC").get()
        if contract == None:
            numBook = 1
            numInitialPage = 1
            numFinalPage = 1
        else:
            numBook = contract.book_number
            numInitialPage = contract.final_page +1
            numFinalPage = numInitialPage
        template_values = {"numBook": numBook,
                           "numInitialPage": numInitialPage,
                           "numFinalPage": numFinalPage}
        template = jinja_environment.get_template('index.html')
        self.response.out.write(template.render(template_values))

    def post(self):
        choosed_contract_type = self.request.get("contract_type")
        numBook = self.request.get("numBook")
        numInitialPage = self.request.get("numInitialPage")
        numFinalPage = self.request.get("numFinalPage")

        person_name = self.request.get("person_name")
        user_nacionality = self.request.get('nacionality')
        user_profession = self.request.get('profession')
        user_marital_status = self.request.get('marital_status')
        user_driver_license = self.request.get('driver_license')
        driver_license_error = ''
        user_SSN = self.request.get('SSN')
        SSN_error = ""
        address = self.request.get('address')

        person_name2 = self.request.get("person_name2")
        user_nacionality2 = self.request.get('nacionality2')
        user_profession2 = self.request.get('profession2')
        user_marital_status2 = self.request.get('marital_status2')
        user_driver_license2 = self.request.get('driver_license2')
        user_SSN2 = self.request.get('SSN2')
        SSN_error2 = ""
        address2 = self.request.get('address2')

        bsubmit = self.request.get('bsubmit')

        if (bsubmit == 'Submit Contract') and (person_name and valid_person(person_name)) and (user_SSN and valid_SSN(user_SSN)):
            contract_record = Contract(book_number = int(numBook),
                                       initial_page = int(numInitialPage),
                                       final_page = int(numFinalPage),
                                       contract_type = choosed_contract_type)
            contract_record.put()
            contract_id = contract_record.key().id()

            person_record = Person(person_name = person_name,
                               nacionality = user_nacionality,
                               profession = user_profession,
                               marital_status = user_marital_status,
                               driver_license = int(user_driver_license),
                               SSN = int(user_SSN),
                               address = address)
            person_record.put()
            person_id = person_record.key().id()

            person_record2 = Person(person_name = person_name2,
                               nacionality = user_nacionality2,
                               profession = user_profession2,
                               marital_status = user_marital_status2,
                               driver_license = int(user_driver_license2),
                               SSN = int(user_SSN2),
                               address = address2)
            person_record2.put()
            person_id2 = person_record2.key().id()

            self.redirect('/your_contract?contract_id=%s&person_id=%s&person_id2=%s' % (contract_id, person_id, person_id2))

        else:
            if not person_name or not valid_person(person_name):
                person_name_error = "Oh no!!! this person name isn't valid!"
            if not user_SSN or not valid_SSN(user_SSN):
                SSN_error = "Oh no!!! SSN isn't valid!"
            template_values = {"person_name": person_name,
                                "nacionality": user_nacionality,
                                "marital_status": user_marital_status,
                                "profession": user_profession,
                                "SSN": user_SSN,
                                "driver_license": user_driver_license,
##                                "email": user_email,
                                "person_name_error": person_name_error,
                                "SSN_error": SSN_error,
                                "driver_license_error": user_driver_license,
                                "address": address,

                                "person_name2":person_name2,
                                "nacionality2":user_nacionality2,
                                "marital_status2":user_marital_status2,
                                "profession2":user_profession2,
                                "driver_license2":user_driver_license2,
                                "SSN2":user_SSN2,
                                "address2":user_address2,

                                "contract_type":choosed_contract_type,
                                "numBook":geted_numBook,
                                "numInitialPage":geted_numInitialPage,
                                "numFinalPage":geted_numInitialPage,
                                }
            template = jinja_environment.get_template('index.html')
            self.response.out.write(template.render(template_values))

class your_contractHandler(webapp2.RequestHandler):
    def get(self):
        contract_id = self.request.get('contract_id')
        contract = Contract.get_by_id(int(contract_id))
        geted_contract_type = contract.contract_type
        geted_clauses = clauses[geted_contract_type]
        geted_numBook = contract.book_number
        geted_numInitialPage = contract.initial_page
        geted_numFinalPage = contract.final_page

        geted_dateToday = dateToday()

        user = users.get_current_user()
        geted_nickname = user.nickname()
        registered_user = db.GqlQuery("SELECT * FROM RegisteredUser WHERE user_nickname =:nickname", nickname = geted_nickname).get()
        geted_autor_ato = registered_user.user_name
        user_position = registered_user.user_position
        org_name = registered_user.org_name
        org_city = registered_user.org_city
        org_state = registered_user.org_state

        person_id = self.request.get('person_id')
        person = Person.get_by_id(int(person_id))
        geted_person_name = person.person_name
        geted_user_nacionality = person.nacionality
        geted_user_profession = person.profession
        geted_user_marital_status = person.marital_status
        geted_user_driver_license = person.driver_license
        geted_user_SSN = person.SSN
        geted_user_address = person.address

        person_id2 = self.request.get('person_id2')
        person2 = Person.get_by_id(int(person_id2))
        geted_person_name2 = person2.person_name
        geted_user_nacionality2 = person2.nacionality
        geted_user_profession2 = person2.profession
        geted_user_marital_status2 = person2.marital_status
        geted_user_driver_license2 = person2.driver_license
        geted_user_SSN2 = person2.SSN
        geted_user_address2 = person2.address

        your_contract = jinja_environment.get_template('your_contract.html')
        your_contract_values = {"autor_ato":geted_autor_ato,
                                "user_position":user_position,
                                "org_name":org_name,
                                "org_city":org_city,
                                "org_state":org_state,
                                "contract_type":geted_contract_type,
                                "clauses":geted_clauses,
                                "dateContract":geted_dateToday,
                                "numBook":geted_numBook,
                                "numInitialPage":geted_numInitialPage,
                                "numFinalPage":geted_numInitialPage,

                                "person_name":geted_person_name,
                                "nacionality":geted_user_nacionality,
                                "marital_status":geted_user_marital_status,
                                "profession": geted_user_profession,
                                "driver_license":geted_user_driver_license,
                                "SSN":geted_user_SSN,
                                "address":geted_user_address,

                                "person_name2":geted_person_name2,
                                "nacionality2":geted_user_nacionality2,
                                "marital_status2":geted_user_marital_status2,
                                "profession2": geted_user_profession2,
                                "driver_license2":geted_user_driver_license2,
                                "SSN2":geted_user_SSN2,
                                "address2":geted_user_address2,
                                }
        template = jinja_environment.get_template('index.html')
        self.response.out.write(your_contract.render(your_contract_values))

class RegisterHandler(webapp2.RequestHandler):
    def get(self):
        user = users.get_current_user()
        if not user:
            self.redirect(users.create_login_url(self.request.uri))
        nickname = user.nickname()
        template_values = {"user_nickname": nickname}
        template = jinja_environment.get_template('register.html')
        self.response.out.write(template.render(template_values))

    def post(self):
        user = users.get_current_user()
        geted_user_nickname = user.nickname()
        geted_user_name = self.request.get("user_name")
        geted_user_position = self.request.get('position')
        geted_org_name = self.request.get('org_name')
        geted_org_address = self.request.get('org_adress')
        geted_address = self.request.get('address')
        geted_city = self.request.get('city')
        registered_user = RegisteredUser(user = user,
                               user_name = geted_user_name,
                               user_nickname = geted_user_nickname,
                               position = geted_user_position,
                               org_name = geted_org_name,
                               org_address = geted_org_address,
                               city = geted_city,
                               )
        registered_user.put()
##        registered_user_id = registered_user.key().id()
        self.redirect('/')

app = webapp2.WSGIApplication([('/', MainHandler), ('/your_contract', your_contractHandler), ('/register', RegisterHandler)],
                              debug=True) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-07T00:37:02.393

根据[文档](http://webapp-improved.appspot.com/api/webapp2.html#webapp2.redirect)调用`redirect`不会停止代码执行，除非`abort`设置为`True`. 它建议返回重定向的结果，例如：

```
return redirect('/some-path') 
```

在您的情况下，您的方法会继续执行，并且`user`正在`None`查找不存在的属性。

# java - 将 .addKeyListener 应用于 JTextFields 数组

> ID：11837695
> 
> 赞同：1
> 
> 时间：2012-08-07T00:16:12.297
> 
> 标签：java, swing, event-handling, jtextfield

我写了下面的代码。它检查来自 JTextField 的输入并确保用户正在输入数字。如果不是，该框会闪烁红色并删除无效字符。

tipArray[] 是一个 JTextField 数组，我通过循环将其添加到 JFrame。

如何将以下代码应用于每个可能的数组（tipArray[0]、tipArray[1] ....tipArray[6]）？

```
tipArray[6].addKeyListener(new KeyAdapter() {
@Override
public void keyPressed(KeyEvent e) {
    char keyChar = e.getKeyChar();;
    char[] badCharArray = "abcdefghijklmnopqrstuvwxyz-`~!@#$%^&*()[,]{}<>_+=|\"':;?/ ".toCharArray();
        for (int i = 0; i < badCharArray.length; i++) {
            if (badCharArray[i] == keyChar) {
                tipArray[1].setBackground(Color.RED);
                }
                } 
            }
@Override
public void keyReleased(KeyEvent e) {
    if (tipArray[6].getBackground() == Color.RED) {
        if (tipArray[6].getText() != "0"){
            String removeLastLetter = tipArray[1].getText().substring(0, tipArray[6].getText().length()-1);
            tipArray[6].setText(removeLastLetter);
            tipArray[6].setBackground(Color.WHITE);
        }
    }
}

}); 
```

我尝试过的循环不起作用：

```
for (int i = 0; i <= 6; i++) {
tipArray[i].addKeyListener(new KeyAdapter() {
@Override
public void keyPressed(KeyEvent e) {
    char keyChar = e.getKeyChar();;
    char[] badCharArray = "abcdefghijklmnopqrstuvwxyz-`~!@#$%^&*()[,]{}<>_+=|\"':;?/ ".toCharArray();
        for (int x = 0; x < badCharArray.length; x++) {
            if (badCharArray[x] == keyChar) {
                tipArray[i].setBackground(Color.RED);
                }
                } 
            }
@Override
public void keyReleased(KeyEvent e) {
    if (tipArray[i].getBackground() == Color.RED) {
        if (tipArray[i].getText() != "0"){
            String removeLastLetter = tipArray[i].getText().substring(0, tipArray[i].getText().length()-1);
            tipArray[i].setText(removeLastLetter);
            tipArray[i].setBackground(Color.WHITE);
        }
    }
}

}); 
```

}

^以上结果导致“if (badCharArray[x] == keyChar) {”行之后的所有变量 i 都有语法错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T00:17:56.917

将第二个 for 循环中的计数器更改为不同的变量（可能是 z 而不是 i）。您现在有一个重复的变量（两个 i）。此外，建议您使用 DocumentListener 而不是 KeyListener 来检查无效字符，因为 KeyListeners 有时会失败。

# c# - 控制器中的 MVC3 死锁

> ID：11837698
> 
> 赞同：0
> 
> 时间：2012-08-07T00:16:39.443
> 
> 标签：c#, asp.net-mvc-3, iis-7.5, wkhtmltoimage

我正在尝试使用 wkhtmltoimage 栅格化地图。我正在启动一个新进程并将获取所需图像所需的命令行参数传递给它。

当进程开始时，我目前正遭受很长时间的停顿。我已启用显示窗口以查看是否有任何与对话框相关的活动需要用户输入但没有。该进程以 0% CPU 运行 2 到 3 分钟。在命令上执行相同的命令需要几秒钟。

```
using (Process p = new Process())
{
    ProcessStartInfo info = new ProcessStartInfo(wkhtmlPath, dimensions + EscapeArgument(location) + " -");
    info.UseShellExecute = false;
    info.RedirectStandardOutput = true;
    p.StartInfo = info;
    p.Start();

    byte[] buffer = new byte[32768];
    int read = 0;

    while ((read = p.StandardOutput.BaseStream.Read(buffer, 0, buffer.Length)) > 0)
    {

        //... write bytes to the an ouput buffer
    }

} 
```

它需要几分钟才能完成。当它没有指向使用同一会话的我的一个控制器时，这可以正常工作。当它使用相同的会话时，打印控制器等待来自 wkhtmltoimage 的响应，它正在等待打印控制器释放锁定以便它可以获取页面。一些超时必须打破这个僵局。我可以以某种方式安全地释放会话锁吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T04:55:51.647

在 MVC3 中，控制器操作默认在用户会话上同步。使用相同的会话令牌重新发出请求会导致死锁。重新发出的请求等待发出它的请求以放弃对会话的锁定。我通过根本不使用会话作为入口点解决了这个问题，但这可能不是最好的解决方案。

无需进一步调查，最好的解决方案就是开始考虑异步控制器。我编写的许多控制器操作都是通过 ajax 异步调用的。这种会话锁定行为表明控制器正在同步请求，这在甚至不使用会话的情况下并不理想。

# css - 如何在 sass 结果中包含空类和 ID

> ID：11837701
> 
> 赞同：5
> 
> 时间：2012-08-07T00:16:57.583
> 
> 标签：css, ruby-on-rails, gem, stylesheet, sass

我刚开始使用 sass，还在学习。我正在使用这个命令从 sass 生成 css：

```
sass --watch custom.scss:custom.css 
```

它似乎删除了空类和 ID。是否可以将它们包含在生成的 CSS 中？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-08T08:05:04.997

SASS 从不编译空类，作为一种解决方法，您可以在类中添加一个没有规则的 CSS 注释，因此它将被编译。

```
.empty {
  /*I'm still empty*/
} 
```

# javascript - 从rest api获取文件并下载

> ID：11837703
> 
> 赞同：0
> 
> 时间：2012-08-07T00:17:10.043
> 
> 标签：javascript

单击下载按钮时，我需要从rest api url（http://localhost:xxxx/xx.xml）“获取”一个xml文件并将其保存在用户桌面上。我如何在javascript中实现这一点。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T00:23:26.400

```
$('#your_button').click(function(){
    window.open('http://localhost:xxxx/xx.xml');
    return false;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T00:24:47.147

如果您可以控制虚拟主机，请发送标头：

```
Content-disposition: attachment; filename=x.xml 
```

您还可以使用 AJAX 调用和类似[downloadify](https://github.com/dcneiner/Downloadify) flash 对象的东西。除此之外，没有本地方法可以强制下载文件

# excel - SSRS Excel 保护工作簿

> ID：11837705
> 
> 赞同：0
> 
> 时间：2012-08-07T00:17:22.483
> 
> 标签：excel, reporting-services

我正在使用 SSRS 2008 R2。

我想生成一个受保护的 Excel 工作簿，以便报表用户可以引用它，但不能意外更改它。

或者，我会接受能够保护各个列。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T10:56:10.550

据我所知，SSRS 2008 R2 无法做到这一点。快速搜索导致[msdn 线程](http://social.msdn.microsoft.com/Forums/en-US/sqlreportingservices/thread/98f52748-4f89-4623-a638-c0094c4c29ef)证实了这一点。

我能想到的替代方案，但其中一些有点“沉重”：

1.  使用 SSIS 填充具有保护的现有 XLS 文件。
2.  导出为 XML，然后使用 XSLT 进行自定义后处理以转换为 Office2007 格式。
3.  编写[自定义渲染扩展插件](http://msdn.microsoft.com/en-us/library/ms154606%28v=sql.105%29.aspx)来进行您自己的 Excel 渲染。

# python - 在 Mountain Lion 上安装 psycopg2 (brew + pip)

> ID：11837708
> 
> 赞同：0
> 
> 时间：2012-08-07T00:17:59.630
> 
> 标签：python, homebrew, psycopg2, osx-mountain-lion

我试图让 psycopg2 在 ML 上工作，默认 Python 2.7 (2.7.2)。我通过自制软件安装了 postgresql，并用 pip 安装了 psycopg2。Postgres 愉快地启动并运行，PGAdmin3 可以看到我创建的 db。

但是当我运行 python 并尝试

```
import psycopg2 
```

我得到：

```
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/Library/Python/2.7/site-packages/psycopg2/__init__.py", line 67, in <module>
    from psycopg2._psycopg import BINARY, NUMBER, STRING, DATETIME, ROWID
ImportError: dlopen(/Library/Python/2.7/site-packages/psycopg2/_psycopg.so, 2): Symbol not     found: _PQbackendPID
  Referenced from: /Library/Python/2.7/site-packages/psycopg2/_psycopg.so
  Expected in: flat namespace
 in /Library/Python/2.7/site-packages/psycopg2/_psycopg.so 
```

现在的输出`sudo pip install psycopg2`并不完全干净。Clang 给出了一堆警告，但没有错误：

> 警告：编译期间未使用的参数：'-mno-fused-madd'
> 警告：未使用的函数 'Dprintf' 警告：隐式转换丢失整数精度：'long' 到 'int' 警告：无符号表达式 < 0 的比较始终为 false
> ld：警告：忽略文件/usr/local/Cellar/postgresql/9.1.4/lib/libpq.dylib，文件是为不受支持的文件格式构建的（0xcf 0xfa 0xed 0xfe 0x 7 0x 0 0x 0 0x 1 0x 3 0x 0 0x 0 0x 0 0x 6 0x 0 0x 0 0x 0 ）这不是被链接的架构（i386）：/usr/local/Cellar/postgresql/9.1.4/lib/libpq.dylib

最后一个链接器警告让我担心，我想知道它是否又是旧的 32-vs-64 位 Python 问题。我试过旧的：

```
defaults write com.apple.versioner.python Prefer-32-Bit -bool yes 
```

但没有骰子。

我接下来的想法是：强制 brew 将 postgresql 编译为 x86_64，或者从 brew 安装 python。我想要第一个选择，因为我还有一些其他软件（叹气），这取决于 Apple 的 Python 是 PATH 中的第一个。

任何想法如何使用 brew 将 postgresql 编译为 64 位？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T02:39:03.027

正如@Doughal 指出的那样，我已经在运行*32*位 Python，而该库需要 64 位。所以，用一个简单的固定

```
defaults write com.apple.versioner.python Prefer-32-Bit -bool no 
```

# ruby-on-rails-3 - 导轨形式不保留值

> ID：11837713
> 
> 赞同：0
> 
> 时间：2012-08-07T00:19:17.630
> 
> 标签：ruby-on-rails-3, forms

我的一个 Rails 表单中有一个字段，它选择了一个“单元”并且最初可以正常工作。但是，当我进入记录时，选择默认为另一个单位，而不是分配的单位，因此不保留该值。

```
_form.html.erb
<%= f.select :unit_id, options_for_select(unit_select), {}, {:class => 'select'} %>  

helper
def unit_select
    Unit.all.map{|unit| unit.calls.empty? ? [unit.unit_name, unit.id] : ["#{unit.unit_name} (on call)", unit.id] }
  end 
```

我唯一能想到的是它没有保留值，因为表单字段正在使用地图。我对 Rails 和 Ruby 有点陌生，所以我还没有完全理解我的代码的约束。

任何帮助或建议表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:42:50.700

我能够通过使用 options_for_select 来解决这个问题：selected => @call.unit.id

然后它保留了先前选择的值。

# java - Xstream 附加到现有的 XML 文件

> ID：11837716
> 
> 赞同：2
> 
> 时间：2012-08-07T00:19:44.597
> 
> 标签：java, xstream

首先让我说我对 Java 很陌生。我一直在试图弄清楚如何使用 Xstream 将一大块 XML 附加到现有的 XML 文件中。

示例 XML：

```
<root>
    <first>
        <a>Some Value</a>
        <b>Some Value B</b>
    </first
    <second>
        <a>Another Value</a>
        <b>Another Value B</b>
    </second>
</root> 
```

我将如何使用 Xstream 附加以下内容？

```
<third>
    <a>More A</a>
    <b>More B</b>
</third> 
```

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-08-07T01:15:29.867

你有没有看过 Xstream 的两分钟教程？这可以在[这里](http://x-stream.github.io/tutorial.html)找到。

您应该首先解决一些实现选择：Xstream 采用哪种方式？例如：XML 文档是大文档还是小文档（如果小，可以使用 DomDriver。如果大，使用 StaxDriver）？

您的 XML 文档是否使用名称空间？如果是这样，请注意并非所有 Xstream 解析器都实现命名空间感知，请参阅 Xstream[常见问题解答](http://x-stream.github.io/faq.html#XML_namespaces)。

可以在[此处](http://www.ibm.com/developerworks/xml/library/x-xstream/)找到更多信息以帮助您入门。

请向我们提供您的 SSCCE，以便用户可以试用您的代码示例。[在此处](https://meta.stackexchange.com/questions/22754/sscce-how-to-provide-examples-for-programming-questions)和[此处](http://mindprod.com/jgloss/sscce.html)查看有关如何编写 SSCCE 的详细信息

还要在您的 SSCCE 中包含一个小的有效 XML 文件。

# soap - 将 WSS4CF 与

> ID：11837717
> 
> 赞同：0
> 
> 时间：2012-08-07T00:19:57.437
> 
> 标签：soap, coldfusion

这有点牵强，我希望有 WSS4CF 经验的人能确切地知道我在说什么。

我们正在尝试访问远程 Web 服务，需要带有用户名/密码的 WS 安全性。在使用 SOAP +`<cfhttp>`并遇到课堂问题后，我的同事建议我看看[WSS4CF](http://wss4cf.riaforge.org/wiki/)。这似乎正是我需要避免需要处理那些额外的 jar 文件等。

没有提供示例，我注意到 cfc（[在此处查看](http://code.google.com/p/training-govt-au/wiki/secureWebservice)）似乎被配置为使用类似 dotNet SOAP 服务的东西，您只需调用带有参数的方法，例如

```
<cfinvoke 
            webservice="https://service.gov.au/OrgService.svc?WSDL" 
            refreshwsdl="true"
            method="Search"
            returnvariable="aSearch">
                <cfinvokeargument name="request" value="#arguments.sXML#"/>
        </cfinvoke> 
```

WSS4CF 首先创建一个安全的 Web 服务，然后在该安全环境中发出请求。我尝试了上面的代码，但它不起作用（没想到会这样）。该服务需要一个 xml 数据包，而不是带有参数的方法调用。

而不是摆弄它，我需要将它配置为与 cfhttp 一起使用，我们在 cfhttpparam 中传递一个 xml 信封，例如如下：

```
<cfhttp
    url="/service.gov.au/OrgService.svc?WSDL"
    method="post">

    <cfhttpparam type="header" name="content-type" value="application/soap+xml" /><!---text/xml--->
    <cfhttpparam type="header" name="SOAPAction" value="http://service.gov.au/services/IOrgService/Search"/>
    <cfhttpparam type="header" name="accept-encoding" value="no-compression" />
    <cfhttpparam type="xml" value="#trim(sXML)#"/>

</cfhttp> 
```

对此的任何帮助将不胜感激。我不指望人们研究图书馆，除非他们感兴趣。更希望有使用过WSS4CF的人可以提供一些启发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T08:50:01.493

尽管它本身没有使用 WS-Security，[但这里的答案](https://stackoverflow.com/questions/10630394/coldfusion-how-to-authenticate-webservice-getshipmentsimplequote-of-wwex/10651618#10651618)可能会帮助您完成您所追求的事情，假设您可以在消息头中发送 WS-Security 数据包（维基百科向我保证可以）。在这种方法中，您使用 cfinvoke，但添加一个标头，在您的情况下是 ws-security 标头。您仍然必须自己组装标题，但我认为这是可能的

# linux - 使用每行一个项目的输入文件在shell脚本中创建一个对话框？

> ID：11837718
> 
> 赞同：0
> 
> 时间：2012-08-07T00:20:02.903
> 
> 标签：linux, bash, shell, scripting

我正在使用这种格式的 CURL 将项目列表检索到文件中：

```
USA, Colorado, Denver
USA, Colorado, Denver (LOC1 S3) 
USA, Florida 
USA, Florida (LOC1 S2) 
```

我需要在对话框中显示该列表（例如使用 Zenity）并选择一行然后将其用作命令中的变量，例如

```
selloc = *prompt here*
dosomething "$selloc" 
```

这将执行

```
dosomething "USA, Colorado, Denver (LOC1 S3)" 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T01:28:59.663

```
#!/bin/sh
mapfile -t bravo < alpha.txt
select charlie in "${bravo[@]}"
do
  break
done
echo "$charlie" 
```

输出：

```
1) USA, Colorado, Denver            3) USA, Florida
2) USA, Colorado, Denver (LOC1 S3)  4) USA, Florida (LOC1 S2)
#? 2
USA, Colorado, Denver (LOC1 S3) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T04:09:23.883

[http://linux.byexamples.com/archives/265/a-complete-zenity-dialog-examples-2/](http://linux.byexamples.com/archives/265/a-complete-zenity-dialog-examples-2/)提供了如何使用 Zenity 显示“收音机列表”或“复选框列表”对话框的示例。

```
selloc=$(zenity  --list  --text "Pick a Location" --radiolist  \
    --column "Pick" --column "Location" \
      TRUE            "USA, Colorado, Denver" \
      FALSE           "USA, Colorado, Denver (LOC1 S3)" \
      FALSE           "USA, Florida" \
      FALSE           "USA, Florida (LOC1 S2)"
dosomething "$selloc" 
```

从文件中获取选项列表应该可以使用`xargs`or `eval`。

```
selloc=$(eval zenity --list --text \"Pick a Location\" --radiolist \
    --column \"\" --column Location $(curl -s http://example.com/list.txt |
        sed 's/.*/FALSE "&"/;1s/^FALSE /TRUE /')) 
```

# c++ - MFC C++ 截图

> ID：11837726
> 
> 赞同：0
> 
> 时间：2012-08-07T00:21:21.777
> 
> 标签：c++, mfc, screenshot

我有一个使用 CDC 绘制网格的应用程序（它有文本、矩形和位图）。我想在保存完成的网格时对其进行截图，并将该截图用作文件的“预览”。

如何截取我的应用程序的屏幕截图并保存？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T00:31:01.837

答案[在这里](https://stackoverflow.com/questions/7292757/how-to-get-screenshot-of-a-window-as-bitmap-object-in-c)

```
void CScreenShotDlg::OnPaint()
{
    // device context for painting
    CPaintDC dc(this);

    // Get the window handle of calculator application.
    HWND hWnd = ::FindWindow( 0, _T( "Calculator" ));

    // Take screenshot.
    PrintWindow( hWnd,
                 dc.GetSafeHdc(),
                 0 );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T00:00:19.890

最终我最终这样做了，因为我想捕捉窗口的隐藏部分（因为内容超出了屏幕并需要滚动）：

```
CDC* WindowToCaptureDC = AfxGetMainWnd()->GetWindowDC();
CDC CaptureDC;
CDC MemDC;
MemDC.CreateCompatibleDC(WindowToCaptureDC);
CaptureDC.CreateCompatibleDC(WindowToCaptureDC);

CBitmap CaptureBmp;
CBitmap ResizeBmp;
int pWidth = grid.tableWidth + grid.marginLeft*2;
int pHeight = grid.tableHeight + grid.marginBottom; 

CaptureBmp.CreateCompatibleBitmap( WindowToCaptureDC, pWidth, pHeight);
CaptureDC.SelectObject(&CaptureBmp);

CBrush brush(RGB(255, 255, 255));
CaptureDC.SelectObject(&brush);
CaptureDC.Rectangle(0, 0, pWidth, pHeight); 
```

///像我在此处为 OnDraw 所做的那样将项目绘制到 CaptureDC///

```
double width = //desired width;
double height = //desired width;

    //maintain aspect ratio
if(pWidth!=width || pHeight!=height)
{
    double w = width/pWidth;
    double h = height/pHeight;
    if(w < h)
        height = height*w;
    else
        width = width*h;
}

ResizeBmp.CreateCompatibleBitmap(WindowToCaptureDC, width, height);
MemDC.SelectObject(&ResizeBmp);

MemDC.StretchBlt(0, 0, width, height, &CaptureDC, 0, 0, pWidth, pHeight, SRCCOPY);

CImage TempImageObj;
TempImageObj.Attach((HBITMAP)ResizeBmp.Detach());
CString filePath = _T("LOCATION\\image.bmp");
TempImageObj.Save(filePath); 
```

# javascript-events - 我应该担心附加很多不需要的事件处理程序/侦听器吗？

> ID：11837728
> 
> 赞同：2
> 
> 时间：2012-08-07T00:21:47.227
> 
> 标签：javascript-events, event-handling, jquery

我有一个站点，每个页面上都有许多 jQuery 事件处理程序，都在一个大的 .js 文件中。

这意味着对于任何页面，大多数事件处理程序都是针对不存在且根本不会使用的 HTML。

这会影响我的表现吗？

**编辑：**例如，大多数事件处理程序将执行如下操作：

```
$(".page").on("click", ".notes .add", function(){ ... }); 
```

因为`.on()`适用于新元素，它是否总是在浪费处理能力，或者只有在 ajax 调用后 DOM 发生变化时才会生效？所以为了进一步澄清我的问题，我想我应该把它分成两部分。

1.  如果有表演叮当，什么时候会发生？（始终，在任何事件上，仅在 DOM 更改时，仅在加载时）。
2.  丁足以担心吗？我如何衡量这个？如果有一千个这样的听众，叮当声会以秒、毫秒、微秒来衡量吗？我知道我可以加载页面并查看它的“感觉”，但我想知道我是否在开始之前构建了整个错误！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T00:49:01.460

它在很大程度上取决于标记，但总的来说，如果不需要的事件处理程序不被使用，最好删除它们。

jQuery 事件使用 Sizzle 选择引擎附加到元素。这意味着调用`$('a').click()`仍然必须遍历整个 DOM 来搜索链接。由于您的元素不存在，因此不会绑定任何事件，但这并不妨碍 jQuery 必须搜索目标元素。减少 jQuery 工作量的一种方法是在绑定必要的事件之前测试已知元素的存在，比如表单标签。

```
if ($('form').size() > 0) { 
   // bind events for form here
} 
```

`.on()`如果事件使用 , 持久化，情况会变得更糟`.delegate()`，或者`.live()`因为它们被设计为绑定到所有元素，包括尚未创建的元素，所以它们会占用更多资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T09:34:51.457

I think it goes without saying that you should only include the JavaScript that you actually need. Any piece of code you don't need is just wasting processing power **but** whether it has a performance impact really depends on your markup / other code / etc.

Instead of worrying about performance, I would worry about **maintainability**. Do you really want to have only one large JavaScript file with all the code for all pages of your site? It will get messy eventually.

* * *

Regarding: `$(".page").on("click", ".notes .add", function(){ ... });`. It really depends. The nice thing with event delegation is that it only binds *one* event handler to manage *multiple* elements.

Here, it binds the event handler only to `.page`. But the handler is examining *any* click event originating from a descendant of `.page` to see whether the element matches `.notes .add`. It should be obvious that if there are no `.notes .add` elements, this is just unnecessary computation.

But if instead the `.page` element does not even exist, then the event handler won't even be bound, which is ok. jQuery will try to find `.page` elements and will fail. Depending on the complexity of the selector, this can really have an impact (a class name is not complex though).

# c - 代码运行良好，但在执行中途随机停止

> ID：11837734
> 
> 赞同：0
> 
> 时间：2012-08-07T00:23:04.883
> 
> 标签：c, cs50

所以我一直在 iTunes U 上学习哈佛 CS50 课程，但遇到了一些问题。代码运行然后停止。我解释了代码给我带来麻烦的问题。

```
// Program calculates the amount of change you can give with the least amount of coins.

 #include <stdio.h>
 #include <cs50.h>
 #include <math.h>

int
main(void)
{

    float change = 0, inputflag = 1;
    int changeint = 0;
    int quarter = 25, dime = 10, nickel = 5, penny = 1; // Coins and values
    int qc = 0, dc = 0, nc = 0, pc = 0; // Coin value change (Qc = Quarter Change)

// Prompts user for input and validates. 

    while (inputflag == 1)
     {
        printf("How much change? ");
        change = GetFloat();

        if (change == 0)
        {
            printf("You have no change!\n");
            inputflag = 0;
        }
        else if (change > 0)
        {
            printf("%.2f\n", change);
            inputflag = 0;
        }
        else
        {
            printf("Please enter a non-negative number! \n");
        }
     } 
```

程序到此停止。我运行代码，输入一个可接受的值，然后程序停止运行。它不会移动到下面的部分。

我花了最后一个小时来解决这个问题，但仍然无法弄清楚是什么阻止了程序运行。inputflag 值被设置为 0 从而打破了第一个 while 循环，然后应该在 if (change != 0) 下方继续前进，它不会......所以任何建议都将不胜感激。

```
 if (change != 0) // If the change is zero, this section is skipped
        {
            changeint = round(100 * change);
            printf("%d", changeint);
        }

      // The following four sections subtract coin amount, compare it, and add 1 to count.  
          while (changeint >= quarter);    
          {   
               changeint = changeint - quarter;
               qc = qc + 1;
          }

          while (changeint >= dime);
          {
               changeint = changeint - dime;
               dc = dc + 1;
          }

          while (changeint >= nickel);
          {
               changeint = changeint - nickel;
               nc = nc + 1;
          }

          while (changeint >= penny);
          {
               changeint = changeint - penny;
               pc = pc + 1;
          }

//Prints output

          printf("You owe a total of %d coins!", qc + dc + nc + pc);

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T00:33:49.040

`while`每个语句第一行的分号是罪魁祸首。您应该删除它们以避免不可避免的无限循环：

```
 while (changeint >= quarter) 
      {   
           changeint = changeint - quarter;
           qc = qc + 1;
      }

      while (changeint >= dime)
      {
           changeint = changeint - dime;
           dc = dc + 1;
      }

      while (changeint >= nickel)
      {
           changeint = changeint - nickel;
           nc = nc + 1;
      }

      while (changeint >= penny)
      {
           changeint = changeint - penny;
           pc = pc + 1;
      } 
```

是的，即使是最简单的问题也可能未被发现，而带有分号的 for/while 语句就是其中之一（这可能是有意的）。

# javascript - 动画代码不起作用

> ID：11837736
> 
> 赞同：0
> 
> 时间：2012-08-07T00:23:11.137
> 
> 标签：javascript, jquery, html, css

我有这个演示：

[jsfiddle.net](http://jsfiddle.net/WFVby/1/)

```
$(document).ready(function(e) {        
    $(".footer-list li").mouseover(function() {
         $(this).animate({ backgroundColor: "#d31d4a" }, 1500);
        // $(this).css("background-color", "#d31d4a");
    });
}); 
```

动画代码不起作用，我不知道为什么！

当我使用`.css`时，它可以正常工作。

谁能告诉我问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T00:31:36.847

正如其他人所说，jQuery`.animate()`默认情况下不做彩色动画。使其工作的另一个选择是包含[jQuery UI](http://jqueryui.com/demos/animate/)，它（除其他外）“升级”默认`.animate()`方法（如此处所示：http: [//jsfiddle.net/nnnnnn/WFVby/3/](http://jsfiddle.net/nnnnnn/WFVby/3/)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T00:27:15.480

jQuery 没有开箱即用的颜色动画，所以你需要一个颜色动画插件，比如[这个](http://www.bitstorm.org/jquery/color-animation/jquery.animate-colors-min.js). 只需包括它，一切都应该工作。

演示：http: [//jsfiddle.net/WFVby/2/](http://jsfiddle.net/WFVby/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T00:27:54.590

您需要安装“jquery.Color”插件：

[https://github.com/jquery/jquery-color](https://github.com/jquery/jquery-color)

# css - ASP.NET 中的 CSS 文件

> ID：11837739
> 
> 赞同：0
> 
> 时间：2012-08-07T00:23:44.417
> 
> 标签：css, stylesheet

我知道这是一个简单的问题，但出于某种原因，我想知道我是否在这里做错了什么。

我的理解是，如果你**声明 2 个 CSS**文件

```
<script type="text/css" src="JQueryUI.css"></script>     
<script type="text/css" src="Override.css"></script> 
```

我想使用“Override.css”来覆盖一些值，所以如果我输入让我们说“.ui-accordion”并输入我自己的值，我希望它们优先于位于该名称下的原始值jQuery.css 文件。

主要是因为**声明声明**Override.css 出现在**JWuery.css 之后**。

**出于某种原因，这不会发生**。

我尝试切换 2 个文件的声明
......但 Jquery.css 似乎**总是**优先考虑。

有什么理由吗？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T00:49:18.637

这不起作用，因为您没有正确加载 css 文件。

它应该是：

```
<link rel="stylesheet" href="JQueryUI.css" type="text/css" media="all" />
<link rel="stylesheet" href="Override.css" type="text/css" media="all" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T00:51:44.410

关于元素的特殊性，我同意志豪的观点，但我也注意到您正在使用`<script>`附加 CSS 文件，`<link>`而是使用标签，也许这会加载您的 css 并且它会覆盖现有样式：

```
<link rel="stylesheet" type="text/css" href="JQueryUI.css" />
<link rel="stylesheet" type="text/css" href="Override.css" /> 
```

PS刚刚在评论中发布了我的通知作为答案

# git - 在开发多种服务时，哪种 scm(git) 工作流效果很好？(SOA)

> ID：11837740
> 
> 赞同：1
> 
> 时间：2012-08-07T00:23:44.443
> 
> 标签：git, version-control, workflow, soa

我们即将开始将我们的 Web 应用程序拆分为多个服务，每个服务都是它们自己的存储库。我们使用 git 作为我们的 scm，我想知道是否有人对我们的 scm（在本例中为 git）的工作流程有任何建议。

现在我们使用与此处所示类似的工作流程：http: [//nvie.com/posts/a-successful-git-branching-model/](http://nvie.com/posts/a-successful-git-branching-model/)。

我想转向一个更简单的模型，例如 Github 的工作原理：[http](http://scottchacon.com/2011/08/31/github-flow.html) ://scottchacon.com/2011/08/31/github-flow.html 。这对于开发 SOA 是否可行？

好奇是否有人对此有意见。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T15:22:06.853

[Github flow](http://scottchacon.com/2011/08/31/github-flow.html)将功能分支与单个产品相关联，但没有理由无法实现。您的工作流程选项取决于您部署应用程序的方式。考虑“MyApp”，它具有三个组件服务：

```
MyApp
|- ServiceA
|- ServiceB
|- ServiceC 
```

如果您可以`ServiceA`独立于`ServiceB`and进行部署`ServiceC`，更重要的是部署所有这些独立于 MyApp 包含但不存在于任何`Service*`存储库中的代码，那么只需将您首选的工作流 Github 流应用到每个存储库和团队。

如果服务紧密交织在一起，并且部署`ServiceA`必然需要部署，`ServiceB`或者更重要的是，`MyApp`代表每次一个`Services*`存储库执行时都必须推进的大量脚手架或路由代码，那么您可能需要类似[submodules](http://git-scm.com/book/en/Git-Tools-Submodules)或[subtree](https://stackoverflow.com/a/1597087/877115)的东西。在该模型中，您将拥有一个 Github 流程，以及 #4 和 #5 之间的额外步骤，即在部署之前收集服务的子模块（或子树）更新。我会避免没有子树或子模块的存储库嵌套，除非你（和你的团队）非常了解 git。

写完所有这些，我建议您深入了解拆分应用程序的动机。它有其优点和成功的工作流程，但它们是有代价的：获得历史的“全貌”更加困难；在某些情况下，使用以下工具进行调试可能会更加困难`git bisect`；每个新开发人员都必须先了解您的 git 基础架构，然后才能熟练使用您的代码库。这些不是放弃计划的理由，只是值得深思。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T04:40:33.473

您会希望每个服务的存储库都有指向您的消息或合同存储库的子模块。这个 repo 将强制执行仅添加模型。这意味着您一旦发布了消息或合同，就无法删除它。您可以简单地添加新版本的按摩并停止使用旧版本。这使您可以进行增量部署。

# asp.net - 如何构建我的架构服务器项目？

> ID：11837741
> 
> 赞同：0
> 
> 时间：2012-08-07T00:24:14.527
> 
> 标签：asp.net, silverlight, architecture, webserver

我正在使用 Silverlight。在其中，我创建了一个 Web 项目。

我总是创建桌面应用程序，将我的项目分为三个模块：

*   领域
*   应用
*   介绍

但是现在，我正在服务器端工作，我真的对如何构建我的架构一无所知。在其中，我计划为我的数据库创建一个实体模型。

那么，您能否就如何构建模块提供一些想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T11:44:00.497

我按如下方式构建我的 Silverlight 服务器端库：

*   **MyApp.Host**：silverlight 应用程序的主要托管项目。实际上带来的只是包含 XAP 的 aspx 文件和包含 XAP 文件的 ClientBin 文件夹。此外，您可以使用 global.asax 文件来运行引导程序或启动服务器端应用程序所需的任何其他组件。

*   **MyApp.Server.Services**：这个项目包含我所有的域服务。客户端库为此项目设置了 RIA-Services 链接

*   **MyApp.Server.Data**：这个项目包含我的实体和我的数据访问层，例如数据库上下文或封装数据库访问的存储库。

注意：此结构适用于 RIA 服务应用程序。当使用其他服务类型时，您可能需要一个名为 MyApp.Interfaces 的可移植库来访问服务和实体。

# java - 将Java中的字符串分解为字符串数组

> ID：11837742
> 
> 赞同：0
> 
> 时间：2012-08-07T00:24:23.043
> 
> 标签：java, string

我已经彻底研究了这个主题，包括这个网站上的问题和答案......这是我的基本代码：

```
import java.util.Scanner;  
class StringSplit {  
public static void main(String[] args)   
{  
    System.out.println("Enter String");    
    Scanner io = new Scanner(System.in);  
    String input = io.next();  
    String[] keywords = input.split(" ");  
    System.out.println("keywords" + keywords);      
} 
```

我的目标是能够输入一个像“hello, world, how, are, you, today”这样的字符串，并让程序把这个字符串分解成一个字符串数组，比如“[hello, world, how, are ，你，今天] ...但是每当我编译这段代码时，我都会得到这个输出：“keywords = [Ljava.lang.String;@43ef9157” 有人可以建议一种以我需要的方式输出数组的方法吗？ ?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T00:25:59.357

当然：

```
System.out.println("keywords: " + Arrays.toString(keywords)); 
```

这不是导致您出现问题的拆分（尽管它可能没有按照您的意愿行事） - 事实是数组不会覆盖`toString`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T00:47:38.340

此代码应该可以工作：

```
String inputString = new String("hello, world, how, are, you, today");    
Scanner scn = new Scanner(inputString);
scn.useDelimiter(",");
ArrayList<String> words = new ArrayList<String>();
while (scn.hasNext()) {
   words.add(scn.next());
}

//To convert ArrayList to array
String[] keywords = new String[words.size()];
for (int i=0; i<words.size(); ++i) {
   keywords[i] = words.get(i);
} 
```

useDelimiter 函数使用逗号分隔单词。希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T00:29:14.130

您可以尝试使用 Java 的[String.Split](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#split%28java.lang.String%29)：

只需给它一个正则表达式，它将匹配您想要的一个（或多个）分隔符，并将您的输出放入一个数组中。

至于输出，请使用 for 循环或 foreach 查找来检查数组的元素并打印它们。

你得到你现在得到的输出的原因是数组的 ToString() 方法不会打印数组内容（就像在 Python 中那样），而是打印对象的类型及其地址.

# restkit - RestKit sendSynchronously 方法的最佳实践

> ID：11837746
> 
> 赞同：2
> 
> 时间：2012-08-07T00:24:58.333
> 
> 标签：restkit, synchronous

我正在尝试使用 RestKit 同步加载对象，并`[anObjectLoader sendSynchronously]`在后台线程上使用。然后在`RKObjectLoader` **didFinishLoad:**应用程序当前停止在第一行：`NSAssert([NSThread isMainThread], @"RKObjectLoaderDelegate callbacks must occur on the main thread");`

查看[文档](http://restkit.org/api/master/Classes/RKRequest.html#//api/name/sendSynchronously)，该类中的`sendSynchronously`方法`RKRequest`说请求将被同步请求，并且将返回一个水合响应对象。

这是我的代码的快照：

```
RKObjectLoader *anObjectLoader = [self.objectManager loaderWithResourcePath:resourcePath];
NSLog(@"Response: %@", [anObjectLoader sendSynchronously]); 
```

在控制台上：

```
*** Assertion failure in -[RKManagedObjectLoader didFinishLoad:], ...RestKit/Code/ObjectMapping/RKObjectLoader.m:423 
```

可以将**RestKit**与同步调用一起使用吗？
有没有更好的方法来发送同步请求？
我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T07:57:50.423

你永远不应该进行同步调用。使用该`send`方法并使用委托或块回调来捕获响应。除其他外，此方法针对网络带宽使用进行了优化，并且还可以正确处理线程。

顺便说一句，`RKObjectLoader`需要主线程的原因是因为这是您的主对象上下文所在的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T16:17:28.183

我最近也有同样的问题。我想出了如何使用块发送同步调用，它实际上非常好。基本上，您执行您打算执行的任何 restkit 调用，但不是将委托设置为 self，而是使用`usingBlock`. 然后，在该块中，您可以处理来自 API 调用的各种响应。

块示例（APIUser 是我编写的代表当前用户的类）：

```
[[RKObjectManager sharedManager] loadObjectsAtResourcePath:[@"/api/users/" stringByAppendingString:userName] usingBlock:^(RKObjectLoader* loader) {

    loader.onDidLoadResponse = ^(RKResponse *response) {

        NSLog(@"Response: \n%@", [response bodyAsString]);
    };

    loader.onDidLoadObjects = ^(NSArray *objects) {

        APIUser *apiUser = [objects objectAtIndex:0];    

    };

    loader.onDidFailWithError = ^(NSError *error) {

        NSLog(@"Response: \n%@", [response bodyAsString]);          
    };
}]; 
```

我原来的问题和答案[可以在这里找到](https://stackoverflow.com/questions/11768287/how-to-make-a-synchronous-restkit-call)。

# python - 在 CRON 作业中运行时 Python 脚本编码问题

> ID：11837748
> 
> 赞同：1
> 
> 时间：2012-08-07T00:25:12.933
> 
> 标签：python, utf-8, cron

正如许多人所希望的那样，这个编码问题正在驱使我*思考*。我真的很感激对此有所了解！

最终目标是能够从终端和 cron 以及从 cron 和`> stdout.txt`. 不用说，我遇到了严重的编码问题。

因此，我的 script.py 从终端运行良好：`python script.py`
它会抛出一个错误，但是，当从终端运行时：`python script.py > stdout.txt`
它会在 cron 中运行时抛出相同的错误，无论哪种方式。

我有一个 python 脚本，`crontab -e`以 root 身份输入。

这是我的 script.py 标头：

```
#!/usr/bin/python
# -*- coding: utf-8 -*- 
```

这是我的 cron 条目：

```
* * * * * python /home/ubuntu/parrot/script.py > /home/ubuntu/parrot/stdout.txt 
```

这是我的 stdout.txt （相关部分）：

```
Unexpected error!  (<type 'exceptions.UnicodeDecodeError'>, UnicodeDecodeError('ascii', 'blabla some weird text n\xc3\xa5r end', 54, 55, 'ordinal not in range(128)')) 
```

这是我来自终端的环境（相关部分）：

```
LANG=en_US.UTF-8 
```

这是我来自 cron 的环境（相关部分）：

```
LANG=en_US.UTF-8 
```

这是 script.py 中引发错误的（第一）行：

```
print 'Posting @%s: %s' % (statusObj.user.screen_name.encode('ascii', 'replace'), statusObj.text.encode('utf-8', 'replace')) 
```

编辑： `sys.getdefaultencoding()`返回`ascii`

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T01:11:07.653

如果您可以控制，`statusObj`则应检查将数据解析到对象中的相关代码，并尝试使输入尽可能*干净*。

您要确保在尝试对其进行编码之前将您的字符串解码为 un​​icode。

如果没有，您可以尝试：

```
# try to get the string into unicode
screen_name = unicode(statusObj.user.screen_name) 
post = unicode(statusObj.text) # probably an error here?
output_str = u"Posting @{name}: {post}".format(name=screen_name, post=post)
print output_str.encode("utf8", "replace") # encode the unicode string on 
```

# java - 以 30 fps 运行的 GUI？

> ID：11837749
> 
> 赞同：6
> 
> 时间：2012-08-07T00:25:20.853
> 
> 标签：java, swing, swingworker

在测试一些使用 Swingworker 的实时模拟代码时，我注意到我的 GUI 似乎总是以 30 fps 运行，不多也不少。每次用户与应用程序交互（如鼠标移动）或调用 Swingworker 的 process() 方法时，我都会更新 GUI。Swingworker 现在不做任何事情，它只是从 GUI 中获取鼠标位置并通过 publish() 和 process() 方法将其作为克隆发送回（我这样做只是为了看看我能做什么和能做什么'在线程之间进行通信时不要这样做，因为多线程对我来说还是相当新的）。我在任何地方都没有任何计时器，Swingworker 的 process() 方法在 GUI 上调用 repaint()，所以我想知道是什么导致 GUI 以 30 fps 更新？默认情况下，在 GUI 中是否有类似活动的 vsync 或者它是 Swingworker 中 process() 方法的某些行为？最后：有没有办法获得更高的帧率？

这是一个表现出这种行为的 sscce：

```
public class SimGameTest implements Runnable {
    public static void main(String[] args) {
        SwingUtilities.invokeLater(new SimGameTest());
    }

    @Override
    public void run() {
        MainWindow mainWindow = new MainWindow(new Game());

        mainWindow.setLocationRelativeTo(null);
        mainWindow.setVisible(true);
    }
}

public class MainWindow extends JFrame {
    private Game        game;
    private GamePanel   gamePanel;

    public MainWindow(Game game) {
        this.game = game;

        createAndShowGUI();

        startGame();
    }

    private void startGame() {
        GameSim gameSim = new GameSim(game, gamePanel);
        gameSim.execute();
    }

    private void createAndShowGUI() {
        setTitle("Sim game test");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setResizable(false);

        JPanel contentPane = new JPanel(new GridBagLayout());

        gamePanel = new GamePanel(game);
        contentPane.add(gamePanel);

        add(contentPane);
        pack();
    }
}

public class Game {
    public Point            mouseLocation       = new Point();
    public Point            clonedMouseLocation = new Point();
}

public class GameSim extends SwingWorker<Point, Point> {
    private Game                game;
    private GamePanel           gamePanel;

    public GameSim(Game game, GamePanel gamePanel) {
        this.game = game;
        this.gamePanel = gamePanel;
    }

    @Override
    protected Point doInBackground() throws Exception {
        while (true) {
            publish((Point) game.mouseLocation.clone());
        }
    }

    @Override
    protected void process(List<Point> pointList) {
        game.clonedMouseLocation = pointList.get(pointList.size() - 1);
        gamePanel.repaint();
    }
}

public class GamePanel extends JPanel {
    private Game                game;
    private long                lastTime;

    public GamePanel(Game game) {
        this.game = game;
        setPreferredSize(new Dimension(512, 512));
    addMouseMotionListener(new GamePanelListener(););
    }

    @Override
    public void paintComponent(Graphics g) {
        // draw background
        g.setColor(new Color(0, 0, 32));
        g.fillRect(0, 0, getWidth(), getHeight());

        g.setColor(new Color(192, 192, 255));
        g.drawString(game.clonedMouseLocation.x + ", " + game.clonedMouseLocation.y, 10, 502);

        long now = System.nanoTime();
        long timePassed = now - lastTime;
        lastTime = now;
        double fps = ((double) 1000000000 / timePassed);
        g.drawString("fps: " + fps, 10, 482);
    }

    private class GamePanelListener extends MouseInputAdapter {
        @Override
        public void mouseMoved(MouseEvent e) {
            if (contains(e.getPoint())) {
                game.mouseLocation = e.getPoint();
            }
        }
    }
} 
```

我创建了另一个版本，我只计算重新绘制 GUI 的次数并在屏幕上显示计数，它似乎以每秒 30 次的速度增加，所以我猜 fps 计算不是问题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-07T02:02:33.883

It turns out `SwingWorker` posts instances of `Runnable` to the `EventQueue` using a `javax.swing.Timer` with exactly that `DELAY`.

```
private static class DoSubmitAccumulativeRunnable 
      extends AccumulativeRunnable<Runnable> implements ActionListener {
    private final static int DELAY = (int) (1000 / 30);
    ...
} 
```

You can get a higher frame rate, but not with `javax.swing.SwingWorker`. You can build `SwingWorker` from [source](https://stackoverflow.com/a/69291525/230513), but eventually you saturate the thread with instances of `Runnable`. One alternative is to run the model flat out and sample it periodically, as shown [here](https://sites.google.com/site/drjohnbmatthews/threadwatch).

# iphone - 如何使 MKMapKit 中的注释中的标注按钮转到另一个视图控制器

> ID：11837753
> 
> 赞同：0
> 
> 时间：2012-08-07T00:26:21.167
> 
> 标签：iphone, objective-c, mkmapview, mapkit

我希望标注中的按钮转到另一个视图控制器以显示额外信息，然后能够返回到地图视图。该地图位于选项卡式视图控制器内。目前，如果您单击标注中的按钮，应用程序会崩溃并给您一个线程错误。目前不知道该怎么做。

这是头文件：

```
#import UIKit/UIKit.h>
#import MapKit/MapKit.h>
#define METERS_PER_MILE 1609.344

@interface MSKSecondViewController :UIViewController<MKMapViewDelegate>
{
    IBOutlet MKMapView *stillwellMapView;
}
@property (nonatomic, assign) CLLocationCoordinate2D mainEntranceToStillwellCoordinate;
@end 
```

这是实现文件：

```
@interface MSKSecondViewController ()
@end
@implementation MSKSecondViewController
@synthesize mainEntranceToStillwellCoordinate;

- (void)viewDidLoad
{
    [super viewDidLoad];
    stillwellMapView.delegate=self;
    // Do any additional setup after loading the view, typically from a nib.
    [self mainEntrancetoStillwellCoordinate];
    [self bambooForestCoordinate];
}

- (void)mainEntrancetoStillwellCoordinate
{
    MKPointAnnotation * main = [[MKPointAnnotation alloc]init];
    CLLocationCoordinate2D mainLocation;
    mainLocation.latitude = 40.831685;
    mainLocation.longitude = -73.477453;
    [main setCoordinate:mainLocation];
    [main setTitle:@"Entrance"];
    [main setSubtitle:@"Main"];
    [stillwellMapView addAnnotation:main];
}
- (void)bambooForestCoordinate
{
    MKPointAnnotation * bambooForest = [[MKPointAnnotation alloc]init];
    CLLocationCoordinate2D bambooForestLocation;
    bambooForestLocation.latitude = 40.829118;
    bambooForestLocation.longitude = -73.466443;
    [bambooForest setCoordinate:bambooForestLocation];
    [bambooForest setTitle:@"Bamboo Forest"];
    [bambooForest setSubtitle:@"Exit to Woodbury"];
    [stillwellMapView addAnnotation:bambooForest];
}

- (void)viewDidUnload
{
    stillwellMapView = nil;
    [super viewDidUnload]; 
    // Release any retained subviews of the main view.
}
-(MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation: 
(id<MKAnnotation>)annotation    
{
    MKPinAnnotationView * annView = [[MKPinAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:nil];
    UIButton *entranceButton = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];
    [entranceButton addTarget:self action:@selector(entranceButtonPressed:) 
forControlEvents:UIControlEventTouchUpInside];
    annView.rightCalloutAccessoryView = entranceButton;
    entranceButton = [UIButton buttonWithType:UIButtonTypeCustom];
    entranceButton.frame = CGRectMake(0, 0, 23, 23);
    entranceButton.contentVerticalAlignment = UIControlContentVerticalAlignmentCenter;
    entranceButton.contentHorizontalAlignment = UIControlContentHorizontalAlignmentCenter;
    [UIButton buttonWithType:UIButtonTypeDetailDisclosure];  
    annView.animatesDrop=TRUE;
    annView.canShowCallout = YES;
    annView.calloutOffset = CGPointMake(-5, 5);
    return annView;
}
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}
- (void)viewWillAppear:(BOOL)animated 
{  
    //the coordinates in which the map shows once loaded
    CLLocationCoordinate2D zoomLocation;
    zoomLocation.latitude = 40.831922;
    zoomLocation.longitude= -73.476353; 
    //the amount of area shown by the map when it loads
    MKCoordinateRegion viewRegion = MKCoordinateRegionMakeWithDistance(zoomLocation,  
0.15*METERS_PER_MILE, 0.15*METERS_PER_MILE); 
    MKCoordinateRegion adjustedRegion = [stillwellMapView regionThatFits:viewRegion];                
    [stillwellMapView setRegion:adjustedRegion animated:YES]; 
}
@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T05:01:51.043

使用 entryButton 添加您在 Touch Up Inside 上注册的事件。

```
-(void) entranceButtonPressed:(UIButton *)sender
{
//Write the controller push code here
} 
```

此外，在代码中，您在将 entryButton 分配给 rightCalloutAccessoryView 后重新初始化它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-07T11:52:51.430

在 mapView:viewForAnnotation: 委托方法中

```
-(MKAnnotationView *)mapView:(MKMapView *)mapView
        viewForAnnotation:(id <MKAnnotation>)annotation 
```

// 添加以下行

```
UIButton *rightButton = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];
pinView.rightCalloutAccessoryView = rightButton; 
```

然后在下面的委托方法中实现代码导航到其他视图控制器

```
-(void)mapView:(MKMapView *)mapView annotationView:(MKAnnotationView *)view calloutAccessoryControlTapped:(UIControl *)control 
```

确保视图控制器嵌入在导航控制器中

# javascript - JQuery UI：弹跳动画排队但 stop() 不起作用

> ID：11837758
> 
> 赞同：1
> 
> 时间：2012-08-07T00:27:31.493
> 
> 标签：javascript, jquery, jquery-ui

我正在使用 JQuery UI 中的弹跳动画：

```
$('.mydiv').mouseover(function () {
      $(this).effect("bounce", { times:4 }, 300);
}); 
```

如果我将鼠标悬停在它们上，我会遇到动画“排队”的老问题（即：如果我将鼠标快速移动到一个 div 上 4 次，动画将在超过 4 次之后出现一次）。

通常我会用`.stop()`它来处理它，例如：

```
$('.mydiv').mouseover(function () {
      $(this).stop().effect("bounce", { times:4 }, 300);
}); 
```

但在这种情况下，它没有任何区别。有谁知道解决方案？

Using`.stop(true)`意味着动画在没有完成反弹的情况下停止，如下所示：

![在此处输入图像描述](../Images/64f24fb88d72cbc34fb832848081fc30.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-07T01:01:24.670

使用带有[方法的](http://api.jquery.com/is)[`:animated`选择器](http://api.jquery.com/animated-selector/)来测试元素是否已经有动画在进行中。如果是这样，请不要开始反弹：[`.is()`](http://api.jquery.com/is)

```
$('.mydiv').mouseover(function () {
    var $this = $(this);
    if (!$this.is(":animated"))
      $this.effect("bounce", { times:4 }, 300);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T00:36:25.500

[.stop()](http://api.jquery.com/stop/)接受两个参数，这两个参数都默认为 false。

有 param1，或者 --`clearQueue`它将从队列中清除它后面的所有其他动画并停止它的轨迹中的动画。

然后是 param2，或`jumpToEnd`- 将立即完成动画。

如果您设置`.stop(true)`它应该按预期工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-29T18:59:33.100

是的，如果它只是......没有使用两次，就不可能使用 .stop() 停止（完成）和出队 jQueryUI（但不是核心 jQuery）动画。:)

改变它的执行顺序只是一个“技巧”。所以，试试这个：

`$('button').on('click', function(){ $(this).stop(false, true).stop(true, false).animate('bounce') });`

# iphone - 寻找从 iPhone 上的保管箱文件夹中打开文件的示例

> ID：11837759
> 
> 赞同：1
> 
> 时间：2012-08-07T00:27:35.190
> 
> 标签：iphone, xamarin.ios, dropbox

使用单触。由于我在 iPhone 上安装了保管箱，因此可以在没有 OAuth 的情况下完成此操作吗？理想情况下，我想使用 u/p 从路径打开文件登录到 Dropbox。

谢谢！

# html - 下拉菜单未在 IE 中显示（隐藏在内容后面）

> ID：11837760
> 
> 赞同：1
> 
> 时间：2012-08-07T00:27:38.343
> 
> 标签：html, css, internet-explorer, drop-down-menu

我被这件事难住了。我试图将 position:relative 和各种 z-index 放入无济于事。下面是我的简单下拉菜单代码。它在除 IE 之外的所有浏览器中都能正常工作。

html页面：

```
 <div id="nav">
 <ul id="navul">
  <li id="rootHome">
    <ul id="Home"></ul><a href="index.php"><img src="images/LA-icon.png" style=
    "height: 40px;" id="home" /></a>
  </li>
  <li id="rootProducts" onclick="showMenu(this)">Products
    <ul id="Products">
      <li>
        <p class="navLink" onclick="changePage('products-1.php')">Product 1</p>
      </li>
      <li>
        <p class="navLink" onclick="changePage('products-2.php')">Product 2</p>
      </li>

      <li>
        <p class="navLink" onclick="changePage('products-3.php')">Product 3</p>
      </li>
    </ul>
  </li>
  <li id="rootNews">
    <a href="#Link for news" class="navLink">News</a>
  </li>
  <li id="rootCompany" onclick="showMenu(this)">Company &acirc;&circ;&uml;
    <ul id="Company">
      <li>
        <p class="navLink" onclick="changePage('./company-aboutUs.php')">About Us</p>
      </li>
      <li>
        <p class="navLink" onclick="changePage('./company-contactUs.php')">Contact
        Us</p>
      </li>
    </ul>
  </li>
</ul> 
```

CSS：（格式化在这里不起作用） [http://pastebin.com/raw.php?i=CjyQhXCs](http://pastebin.com/raw.php?i=CjyQhXCs)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T02:41:55.567

~~尝试在div上使用`position: relative`和。Z 索引分层工作。如果一个元素的父元素的 z-index 为 0，而该元素的 z-index 为 100，则该元素仍将出现在另一个元素的后面，该元素是 z-index 为 1 的父元素的兄弟元素。`z-index: 100``id=nav`~~

* * *

该问题是`filter`在#navul ul 上使用的直接结果。IE 在其计算中的某处使元素自动隐藏任何溢出。要修复，请将背景移动到它自己的元素并绝对定位它。

[http://jsfiddle.net/uTBZN/30/](http://jsfiddle.net/uTBZN/30/)

归功于：

[如何阻止 Internet Explorer 的专有渐变过滤器截断应该溢出的内容？](https://stackoverflow.com/questions/2756851/how-do-i-stop-internet-explorers-propriety-gradient-filter-from-cutting-off-con)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-20T18:53:33.320

就像@Stu 一样，我的导航栏上有一个过滤器（在我的例子中是 .navbar）：

```
.navbar {
  filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#87e0fd', endColorstr='#64d7f4',GradientType=0 ); /*  IE6-9 */
} 
```

根据@Greg，一旦我删除了该过滤器，下拉菜单就会停留在 IE9 页面内容的顶部。谢谢你，拯救了我的一天！

# ruby - 如何在Ruby中的另一个字符串之后匹配和迭代一个字符串

> ID：11837764
> 
> 赞同：2
> 
> 时间：2012-08-07T00:28:03.543
> 
> 标签：ruby, regex, string

我有一个像这样的字符串：

```
"abc-12\nxyz-17\nabc-18\npqr-13\n" 
```

我想匹配每个字符串后面的数字并将它们全部加起来。例如，我想对和`12`求和`18`。`abc`我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T00:36:49.447

```
"abc-12\nxyz-17\nabc-18\npqr-13\n".split("\n").inject(0) do |sum, line|
  sum += line[/[\w]+(\d)+/].to_i
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T00:41:46.233

```
s = "abc-12\nxyz-17\nabc-18\npqr-13\n"

s.split.inject(Hash.new(0)) { |h,e| id, n = e.split('-'); h[id] += n.to_i; h }
=> {"abc"=>30, "xyz"=>17, "pqr"=>13} 
```

# gwt - 以发布模式在本地运行 GWT？

> ID：11837765
> 
> 赞同：3
> 
> 时间：2012-08-07T00:28:23.117
> 
> 标签：gwt

有没有办法在本地以“发布”模式运行 GWT？我正在使用画布开发一个项目，它非常缓慢，以至于我无法真正提高工作效率。在释放模式下，性能很好。显然我会失去调试模式的所有好处，但在这种情况下，它需要很长时间才能工作，

谢谢

- - - - - - - - - 编辑 - - - - - - - - -

“发布”模式是指“生产”模式。“本地”运行意味着我在 Eclipse 中右键单击该项目，然后选择“运行方式”->“Web 应用程序”。然后我可以通过浏览器导航到“http://127.0.0.1:8888/myproject.html?gwt.codesvr=127.0.0.1:9997”查看。正是在这里，画布代码运行速度太慢而无法生产。

同样，它在“生产”模式下运行良好（右键单击应用程序，谷歌 -> 部署到应用程序引擎）。当我点击实时 url (http://myproject.appspot.com) 时，画布代码运行得又快又好。

因此，在“本地”模式下，每次我对源代码进行更改并刷新浏览器时，更改都会立即可用。但是对于这种情况，我可以在本地运行生产模式吗？

再次感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T14:17:17.613

您无需部署到应用引擎。

只需*在 Eclipse 中右键单击项目，然后选择 Run As -> Web Application*

然后，

*   而不是导航到：' http: **//127.0.0.1** :8888/myproject.html?gwt.codesvr=127.0.0.1:9997 '
*   只需转到：' http: **//127.0.0.1** :8888/myproject.html '

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T12:43:23.653

一般来说，您的`Developper`模式运行缓慢是不正常的。也许你应该看看为什么它很慢。

要在`Production`模式下运行，您可以在本地：

1.  编译和打包您的应用程序
2.  将其部署到本地服务器，例如`Tomcat`

你应该在这里找到更多信息：

[https://developers.google.com/web-toolkit/doc/2.4/DevGuideCompilingAndDebugging?hl=fr](https://developers.google.com/web-toolkit/doc/2.4/DevGuideCompilingAndDebugging?hl=fr)

# php - 将 html 和 jquery 值传递给 PHP 和 MySQL 表

> ID：11837768
> 
> 赞同：1
> 
> 时间：2012-08-07T00:28:33.617
> 
> 标签：php, jquery, html, forms

我正在做一个个人项目，在尝试使用 val(); 时遇到了一些问题；函数，然后在我的 php 脚本中使用它，我可以成功地将一行插入到我的数据库表中：

这是我的 HTML 代码： http: [//www.icovi.com/stackoverflow/index.png](http://www.icovi.com/stackoverflow/index.png)

这是我的 jQuery 代码： http: [//www.icovi.com/stackoverflow/jquery.png](http://www.icovi.com/stackoverflow/jquery.png)

这是我的 PHP 代码： http: [//www.icovi.com/stackoverflow/php.png](http://www.icovi.com/stackoverflow/php.png)

对于 jQuery 代码，我使用以下代码：

```
var emm = $('#email').val();
$.post("submit.php", { "email": emm } ); 
```

^ 这个 jQuery 代码应该从名为“email”的文本输入中获取电子邮件值，然后我会在我的 PHP 代码中使用它，最后将它引入我的 MySQL 数据库表：

```
$email = $_POST['email'];
$sql="INSERT INTO people (id, email, time) VALUES ('','$email','2')"; 
```

任何帮助将不胜感激，谢谢！

# cakephp - CakePHP 2.x 无法阻止已删除和禁止用户登录

> ID：11837770
> 
> 赞同：2
> 
> 时间：2012-08-07T00:29:00.853
> 
> 标签：cakephp, login, cakephp-2.0, cakephp-2.1

我有一些代码可以防止已删除和禁止的用户登录。为了清除头脑，状态为 -2 意味着用户被删除，-1 意味着用户被禁止。下面是在本地运行良好的代码，但在现场它很烂。状态为 -1 或 -2 的用户仍然可以登录。我找不到问题出在哪里。

```
if ($this->Auth->login()) {
    //first check if the user's status is -1 or -2\. 
    $status = $this->Auth->user('status');

    if ($status == '-1') {
        $this->Auth->logout();
        $this->Session->setFlash(__('This account has been banned. Please contact with us.'));
        $this->redirect('/');
    } elseif ($status == '-2') {
        $this->Auth->logout();
        $this->Session->setFlash(__('This account has been deleted, and is not usable anymore.'));
        $this->redirect('/');
    }

    //something else
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-07T01:48:52.430

通过调用`$this->Auth->login()`检查，您正在登录用户。

您可以避免这种情况，并在登录前检查用户信息，或者您可以将状态标志添加到用户范围。

```
$this->Auth->authenticate = array(
    AuthComponent::ALL => array(
        'userModel' => 'User',
        'scope' => array('User.status' => '> 0)
    ),
    'Form',
    'Basic'
); 
```

这会将`status`字段检查添加到登录过程中。

如果要像示例中那样自定义消息，可以在处理登录之前检查用户信息的值：

```
$user = $this->User->findByUsername($this->data['User']['username']);
if (!empty($user)) {
    if ($user['User']['status'] == -1) {
        // Set message for banned account
    }
    if ($user['User']['status'] == -2) {
        // Set message for deleted account
    }
    $this->redirect( ... ); // Redirect away
}

if ($this->Auth->login()) {
    // Normal login process
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-11T20:22:49.883

范围答案是最好的，但条件有一个小错误，而不是

```
'scope' => array('User.status' => '> 0) 
```

该行应为

```
'scope' => array('User.status >' => 0) 
```

这是在条件数组中添加比较运算符的典型 cakephp 方式

（我本来只是对此发表评论，但是当您刚接触该网站时，更容易创建答案。）

# android - Android 自定义弹出对话框

> ID：11837771
> 
> 赞同：1
> 
> 时间：2012-08-07T00:29:02.027
> 
> 标签：android, android-activity, dialog, popup, customdialog

如何制作可以像图像一样自定义的自定义对话框？使用对话框片段我们可以制作自定义对话框。如何对其进行更多定制并使其灵活。我[在这里指](http://www.mkyong.com/android/android-custom-dialog-example/)

![自定义对话框示例](../Images/c1e73977419b9fa2fcb56a061e6975d0.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T00:52:16.250

使用对话框片段。来自谷歌开发博客的这篇文章会给你一个想法。这是[链接](http://android-developers.blogspot.in/2012/05/using-dialogfragments.html)

# php - php维护状态

> ID：11837772
> 
> 赞同：0
> 
> 时间：2012-08-07T00:29:03.273
> 
> 标签：php, javascript, get, state, persistent

这将是一个新手问题，但我学习 php 的唯一目的（atm）是为了实现一个解决方案——我学到的关于 php 的一切都是在过去 18 小时内学会的。

目标是向我的 javascript get 请求添加间接性，以允许跨域访问另一个网站。我也不希望限制上述网站，并希望采取保护措施。我不能依赖他们在 javascript 中，因为这不能说明其他同行发送他们的请求。

所以现在我有以下临时代码，没有任何限制措施：

```
<?php

  $expires = 15;

  if(!$_GET["target"])
    exit();
  $fn = md5($_GET["target"]);
  if(!$_GET["cache"]) {
    if(!array_search($fn, scandir("cache/")) ||
      time() - filemtime($file) > $expires)
      echo file_get_contents("cache/".$fn);
    else
      echo file_get_contents(file);
  }
  else if($_GET["data"]) {
    file_put_contents("cache/".$fn, $_GET["data"]);
  }
?> 
```

据我所知，它工作得很好（不考虑不可能的校验和冲突）。现在我想知道的是，我在 google 中的搜索查询拒绝为我采购的是 php 的实际启动方式和结束时间。

显然，如果我在运行自己的 Web 服务器，我会对此有更深入的了解：我不是，我也没有 shell 访问权限。

基本上我试图弄清楚我是否可以控制脚本何时在代码中结束，以及对 php 文件的每个“获取”请求是否会启动脚本的新实例，或者它是否可以“唤醒”相同脚本。原因是我希望跟踪它是否已经在过去 n 毫秒内向“目标”发送了请求，并且将值转储到保存文件然后一遍又一遍地恢复它似乎有点浪费不需要在内存中保存很长时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T00:36:11.977

每个 HTTP 请求都会启动一个新的解释器实例；无论这是一个全新的流程，还是对现有流程的重用，它基本上都是一个实现细节。

这通常会将您推向简单且可扩展的良好设计：您可以运行多个服务器进程和线程，并且您不会获得不同的行为，具体取决于请求是否返回到同一实例。

在 Linux 上加载最近接触过的文件会非常快，因为它会直接来自缓存。别担心。

确实要担心这样一个事实，即通过直接将请求参数附加到路径中，您有一个严重的安全漏洞：人们可以获取`data=../../../etc/passwd`等等。阅读[http://www.php.net/manual/en/security.variables.php](http://www.php.net/manual/en/security.variables.php)等。（在这个特定的示例中，您在将输入放入路径之前对其进行哈希处理，因此这不是一个实际问题，但需要注意。）

更一般地说，如果您想跨多个请求保存缓存，那么这些天的典型做法是使用[memcached](http://memcached.org)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T00:30:38.923

php 是从每个连接的基础上完成的。IE：对 php 文件的每个请求都被视为一个新实例。每个实例通常在连接关闭时结束。但是，您可以使用会话在特定用户的连接之间保存数据

对于会话的基本使用，请查看：

```
session_start()
$_SESSION
session_destroy() 
```

# highcharts - Highcharts AreaSpline Chart - 改变每个点的颜色

> ID：11837773
> 
> 赞同：0
> 
> 时间：2012-08-07T00:29:12.820
> 
> 标签：highcharts

我有一个“列”样式的 Highchart，每列都是不同的颜色。如果我将类型更改为“areaspline”（或“区域”），那么整个东西就是一种纯色。有没有办法保留每个部分的颜色？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T07:29:18.773

这是您的图表选项的样子吗？

```
chart = new Highcharts.Chart({
        chart: {
            renderTo: 'container',
            type: 'areaspline'
        },
        title: {
            text: 'Monthly Average Rainfall'
        },
        subtitle: {
            text: 'Source: WorldClimate.com'
        },
        xAxis: {
            categories: [
                'Jan',
                'Feb',
                'Mar',
                'Apr',
                'May',
                'Jun',
                'Jul',
                'Aug',
                'Sep',
                'Oct',
                'Nov',
                'Dec'
            ]
        },
        yAxis: {
            min: 0,
            title: {
                text: 'Rainfall (mm)'
            }
        },
        legend: {
            layout: 'vertical',
            backgroundColor: '#FFFFFF',
            align: 'left',
            verticalAlign: 'top',
            x: 100,
            y: 70,
            floating: true,
            shadow: true
        },
        tooltip: {
            formatter: function() {
                return ''+
                    this.x +': '+ this.y +' mm';
            }
        },
        plotOptions: {
            column: {
                pointPadding: 0.2,
                borderWidth: 0
            }
        },
            series: [{
            name: 'Tokyo',
            data: [49.9, 71.5, 106.4, 129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4]

        }, {
            name: 'New York',
            data: [83.6, 78.8, 98.5, 93.4, 106.0, 84.5, 105.0, 104.3, 91.2, 83.5, 106.6, 92.3]

        }, {
            name: 'London',
            data: [48.9, 38.8, 39.3, 41.4, 47.0, 48.3, 59.0, 59.6, 52.4, 65.2, 59.3, 51.2]

        }, {
            name: 'Berlin',
            data: [42.4, 33.2, 34.5, 39.7, 52.6, 75.5, 57.4, 60.4, 47.6, 39.1, 46.8, 51.1]

        }]
    }); 
```

小提琴@http [://jsfiddle.net/jugal/ZrTck/](http://jsfiddle.net/jugal/ZrTck/)

请记住在@jsfiddle 上分享您的问题，以便社区可以正确、快速、轻松地帮助您。

# python - Python 将文本添加到 matplotlib.image.AxesImage 实例

> ID：11837779
> 
> 赞同：2
> 
> 时间：2012-08-07T00:30:09.210
> 
> 标签：python, text, matplotlib

我有这个代码用于从一系列矩阵创建一系列图像，并且在每个图像中我想添加一个特定的文本。这是我的典型代码：

```
ax = axes([0,0,1,1])

for i in range(0,5):
    text(1,1,str(i))
    ax.imshow(a[:,:,i],origin='lower')
    savefig(str("%04d" % int(i))+'.png',format="png")
    del ax.texts[-1] 
```

但问题是随着迭代次数的增加，速度下降，变得如此缓慢。在后台打开很多窗口似乎有问题。

有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T05:28:30.970

每个循环都不会创建新的图像和文本对象，而是重用这些对象。

```
ax = axes([0,0,1,1])
t = text(1,1,str(0))
img = ax.imshow(a[:,:,0],origin='lower')

for i in range(0,5):
    t.set_text(str(i)
    img.set_data(a[:,:,i])
    savefig(str("%04d" % int(i))+'.png',format="png") 
```

也见

[逐帧可视化 3D-numpy-array](https://stackoverflow.com/questions/11563295/visualization-of-3d-numpy-array-frame-by-frame/11563414#11563414)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-10T13:15:19.453

我刚刚在循环末尾添加了这一行，现在它工作正常。只是在记忆中积累之前打开的数字的问题。

```
ax = axes([0,0,1,1])

for i in range(0,5):
    text(1,1,str(i))
    ax.imshow(a[:,:,i],origin='lower')
    savefig(str("%04d" % int(i))+'.png',format="png")
    del ax.texts[-1] 
    close(gcf()) 
```

# iphone - 将 iPhone 应用程序转换为通用应用程序；边界与帧

> ID：11837786
> 
> 赞同：0
> 
> 时间：2012-08-07T00:31:32.347
> 
> 标签：iphone, objective-c, ios, ipad

我正在尝试将 iPhone 应用程序转换为通用（在 iPhone 和 iPad 上）。我已经设法让框架正确调整大小，但似乎边界（用户实际可以与之交互的部分）没有适当地调整大小。因此，例如，UIWebView 将以正确的尺寸绘制，但我只能在 iPhone 屏幕大小的较小范围内与它进行交互。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T03:07:35.680

你如何重新调整这个视图的大小？它是否在具有自动调整大小掩码设置以正确扩展的 xib 中？如果是这样，其他事情就会出错。我刚刚尝试使用 webview 制作一个示例项目，其中 xib 的大小适合 iPhone。然后我将该应用程序标记为通用，它在 iPad 模拟器中运行良好，所有区域均可触摸。

# jquery - 动态 appendTo 选项

> ID：11837793
> 
> 赞同：0
> 
> 时间：2012-08-07T00:32:27.280
> 
> 标签：jquery, appendto

这是我用来从系统生成的逗号分隔列表中创建链接的一些 jQuery，它总是运行良好。

在非常特殊的情况下，我需要脚本来添加 iframe 并打开其中的链接。我想出了以下内容，但无法正常工作。我的问题是，是否可以推动脚本以这种方式工作？如果是这样，我哪里错了？

jQuery

```
$('.assigns').each(function() {
var obj = $(this),
    assigns = obj.text().split(','),
    i = 0,
    len = assigns.length;
if (obj.text()) {
    for (i; i < len; i++) {
        var assign = assigns[i].replace(/(^\s*)|(\s*$)/g, '');
        if (assign != "") {

            assigns[i] = '<a onclick="$(' <iframe style="width: 100%; height: 5.5em;" scrolling="no" name="frame" src="http://www.example.com"></iframe>').appendTo('#assign_frame');" title="Assign to '+assign+'" class="button_main_build">'+assign+'</a>';
        }
    }
    obj.html(assigns.join(' '));

}

}); 
```

的HTML

```
<div id="assign_frame"></div>

<p class="assigns">Bob Jones, Tom Smith, John Appleseed</p> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T00:58:00.740

由于您使用的是 jQuery，因此您可以使用 jQuery 方式进行操作。

```
var $links = $(); // empty jQuery container

for (i; i < len; i++) { 
  var assign = assigns[i].replace(/(^\s*)|(\s*$)/g, '');
  // Create jQuery link element
  // and attach events upon creation
  // allowing for delegation
  var $link = $('<a/>', {
    'class': 'button_main_build',
    href: '#',
    title: 'Assign to ' + assign,
    text: assign,
    click: function () {
      var $iframe = $('<iframe/>', {
        name: 'frame',
        src: 'http://www.example.com',
        scrolling: 'no',
      })
      $iframe.css({
        width: '100%',
        height: '5.5em'
      })
      .appendTo('#assign_frame')
    }
  });

  if (assign) 
    $links.add($link)
}

obj.append($links) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T00:42:37.950

这是实现预期目标的更好方法：

```
$('.assigns').each(function() {
var obj = $(this),
    assigns = obj.text().split(','),
    len = assigns.length;
if (obj.text()) {
    for (var i=0; i < len; i++) {
        var assign = assigns[i].replace(/(^\s*)|(\s*$)/g, '');
        if (assign != "") {
            obj.append( $('<a title="Assign to ' + assign + '" class="button_main_build">'+assign+'</a>') );
        }
    }
}
});

$(".button_main_build").live('click', function() {   
    $('<iframe style="width: 100%; height: 5.5em;" scrolling="no" name="frame" src="http://www.example.com"></iframe>').appendTo('#assign_frame');
}); 
```

# nant - 使用 Nant 构建 .NET 4.5 项目

> ID：11837795
> 
> 赞同：18
> 
> 时间：2012-08-07T00:33:09.617
> 
> 标签：nant, .net-4.5, c#-5.0

我很好奇是否可以使用 Nant 使用 C# 5.0 编译器来定位 .NET 4.5。截至目前，最新版本仅声明支持 .NET 4.0。

在安装 .net 4.5 框架后，我尝试下载源代码并使用 msbuild 构建 .sln，但这会产生大量错误。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-08-07T07:09:07.517

最好将您的发现发送到[NAnt 邮件列表](http://www.mail-archive.com/nant-developers@lists.sourceforge.net/)。它不是那么活跃，但 NAnt 肯定会得到更新以支持新框架。问题是，微软通常会使用新版本更改文件位置，并且指向这些文件的注册表项也会更改，因此在微软发布实际版本之前，实际上不可能支持它。用于测试。

我目前正在运行它，目标是 4.5。在`NAnt.exe.config`中，更改`<startup>`节点：

```
<startup>
    <!-- .NET Framework 4.5 -->
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.5"/>
    <!-- .NET Framework 4.0 -->
    <supportedRuntime version="v4.0.30319" />
    <!-- .NET Framework 2.0 -->
    <supportedRuntime version="v2.0.50727" />
</startup> 
```

我还添加了一个新`<framework>`节点（**net-4.0**的副本，参考程序集除外）：

```
<framework
    name="net-4.5"
    family="net"
    version="4.5"
    description="Microsoft .NET Framework 4.5"
    sdkdirectory="${sdkInstallRoot}"
    frameworkdirectory="${path::combine(installRoot, 'v4.0.30319')}"
    frameworkassemblydirectory="${path::combine(installRoot, 'v4.0.30319')}"
    clrversion="4.0.30319"
    clrtype="Desktop"
    vendor="Microsoft"
      >
  <runtime>
    <probing-paths>
      <directory name="lib/common/2.0" />
      <directory name="lib/common/neutral" />
    </probing-paths>
    <modes>
      <strict>
        <environment>
          <variable name="COMPLUS_VERSION" value="v4.0.30319" />
        </environment>
      </strict>
    </modes>
  </runtime>
  <reference-assemblies basedir="${path::combine(installRoot, 'v4.0.30319')}">
    <include name="Accessibility.dll" />
    <include name="Microsoft.Build.Conversion.v4.0.dll" />
    <include name="Microsoft.Build.dll" />
    <include name="Microsoft.Build.Engine.dll" />
    <include name="Microsoft.Build.Framework.dll" />
    <include name="Microsoft.Build.Tasks.v4.0.dll" />
    <include name="Microsoft.Build.Utilities.v4.0.dll" />
    <include name="Microsoft.CSharp.dll" />
    <include name="Microsoft.Data.Entity.Build.Tasks.dll" />
    <include name="Microsoft.JScript.dll" />
    <include name="Microsoft.Transactions.Bridge.dll" />
    <include name="Microsoft.Transactions.Bridge.Dtc.dll" />
    <include name="Microsoft.VisualBasic.Activities.Compiler.dll" />
    <include name="Microsoft.VisualBasic.Compatibility.Data.dll" />
    <include name="Microsoft.VisualBasic.Compatibility.dll" />
    <include name="Microsoft.VisualBasic.dll" />
    <include name="Microsoft.VisualC.dll" />
    <include name="Microsoft.VisualC.STLCLR.dll" />
    <include name="mscorlib.dll" />
    <include name="System.Activities.Core.Presentation.dll" />
    <include name="System.Activities.dll" />
    <include name="System.Activities.DurableInstancing.dll" />
    <include name="System.Activities.Presentation.dll" />
    <include name="System.AddIn.Contract" />
    <include name="System.AddIn.dll" />
    <include name="System.ComponentModel.Composition.dll" />
    <include name="System.ComponentModel.DataAnnotations.dll" />
    <include name="System.Configuration.dll" />
    <include name="System.Configuration.Install.dll" />
    <include name="System.Core.dll" />
    <include name="System.Data.DataSetExtensions.dll" />
    <include name="System.Data.dll" />
    <include name="System.Data.Entity.Design.dll" />
    <include name="System.Data.Entity.dll" />
    <include name="System.Data.Linq.dll" />
    <include name="System.Data.OracleClient.dll" />
    <include name="System.Data.Services.Client.dll" />
    <include name="System.Data.Services.Design.dll" />
    <include name="System.Data.Services.dll" />
    <include name="System.Data.SqlXml.dll" />
    <include name="System.Deployment.dll" />
    <include name="System.Design.dll" />
    <include name="System.Device.dll" />
    <include name="System.DirectoryServices.dll" />
    <include name="System.DirectoryServices.Protocols.dll" />
    <include name="System.dll" />
    <include name="System.Drawing.Design.dll" />
    <include name="System.Drawing.dll" />
    <include name="System.Dynamic.dll" />
    <include name="System.EnterpriseServices.dll" />
    <include name="System.EnterpriseServices.Thunk.dll" />
    <include name="System.EnterpriseServices.Wrapper.dll" />
    <include name="System.IdentityModel.dll" />
    <include name="System.IdentityModel.Selectors.dll" />
    <include name="System.IO.Log.dll" />
    <include name="System.Management.dll" />
    <include name="System.Management.Instrumentation.dll" />
    <include name="System.Messaging.dll" />
    <include name="System.Net.dll" />
    <include name="System.Numerics.dll" />
    <include name="System.Runtime.Caching.dll" />
    <include name="System.Runtime.DurableInstancing.dll" />
    <include name="System.Runtime.Remoting.dll" />
    <include name="System.Runtime.Serialization.dll" />
    <include name="System.Runtime.Serialization.Formatters.Soap.dll" />
    <include name="System.Security.dll" />
    <include name="System.ServiceModel.Activation.dll" />
    <include name="System.ServiceModel.Activities.dll" />
    <include name="System.ServiceModel.Channels.dll" />
    <include name="System.ServiceModel.Discovery.dll" />
    <include name="System.ServiceModel.dll" />
    <include name="System.ServiceModel.Routing.dll" />
    <include name="System.ServiceModel.ServiceMoniker40.dll" />
    <include name="System.ServiceModel.WasHosting.dll" />
    <include name="System.ServiceModel.Web.dll" />
    <include name="System.ServiceProcess.dll" />
    <include name="System.Transactions.dll" />
    <include name="System.Web.Abstractions.dll" />
    <include name="System.Web.ApplicationServices.dll" />
    <include name="System.Web.DataVisualization.Design.dll" />
    <include name="System.Web.DataVisualization.dll" />
    <include name="System.Web.dll" />
    <include name="System.Web.DynamicData.Design.dll" />
    <include name="System.Web.DynamicData.dll" />
    <include name="System.Web.Entity.Design.dll" />
    <include name="System.Web.Entity.dll" />
    <include name="System.Web.Extensions.Design.dll" />
    <include name="System.Web.Extensions.dll" />
    <include name="System.Web.Mobile.dll" />
    <include name="System.Web.RegularExpressions.dll" />
    <include name="System.Web.Routing.dll" />
    <include name="System.Web.Services.dll" />
    <include name="System.Windows.Forms.DataVisualization.Design.dll" />
    <include name="System.Windows.Forms.DataVisualization.dll" />
    <include name="System.Windows.Forms.dll" />
    <include name="System.Workflow.Activities.dll" />
    <include name="System.Workflow.ComponentModel.dll" />
    <include name="System.Workflow.Runtime.dll" />
    <include name="System.WorkflowServices.dll" />
    <include name="System.Xaml.dll" />
    <include name="System.Xaml.Hosting.dll" />
    <include name="System.Xml.dll" />
    <include name="System.Xml.Linq.dll" />
  </reference-assemblies>
  <!-- WPF Assemblies -->
  <reference-assemblies basedir="${path::combine(installRoot, 'v4.0.30319')}/WPF">
    <include name="NaturalLanguage6.dll" />
    <include name="NlsData0009.dll" />
    <include name="NlsLexicons0009.dll" />
    <include name="PenIMC.dll" />
    <include name="PresentationCore.dll" />
    <include name="PresentationFramework.Aero.dll" />
    <include name="PresentationFramework.Classic.dll" />
    <include name="PresentationFramework.dll" />
    <include name="PresentationFramework.Luna.dll" />
    <include name="PresentationFramework.Royale.dll" />
    <include name="PresentationHost_v0400.dll" />
    <include name="PresentationNative_v0400.dll" />
    <include name="PresentationUI.dll" />
    <include name="ReachFramework.dll" />
    <include name="System.Printing.dll" />
    <include name="System.Speech.dll" />
    <include name="System.Windows.Input.Manipulations.dll" />
    <include name="System.Windows.Presentation.dll" />
    <include name="UIAutomationClient.dll" />
    <include name="UIAutomationClientsideProviders.dll" />
    <include name="UIAutomationProvider.dll" />
    <include name="UIAutomationTypes.dll" />
    <include name="WindowsBase.dll" />
    <include name="WindowsFormsIntegration.dll" />
    <include name="wpfgfx_v0400.dll" />
    <include name="wpftxt_v0400.dll" />
  </reference-assemblies>
  <reference-assemblies basedir="${environment::get-folder-path('ProgramFiles')}/Reference Assemblies/Microsoft/Framework/.NETFramework/v4.5">
    <include name="Microsoft.Build.Conversion.v4.0.dll" />
    <include name="Microsoft.Build.dll" />
    <include name="Microsoft.Build.Engine.dll" />
    <include name="Microsoft.Build.Framework.dll" />
    <include name="Microsoft.Build.Tasks.v4.0.dll" />
    <include name="Microsoft.Build.Utilities.v4.0.dll" />
    <include name="Microsoft.CSharp.dll" />
    <include name="Microsoft.JScript.dll" />
    <include name="Microsoft.VisualBasic.Compatibility.Data.dll" />
    <include name="Microsoft.VisualBasic.Comptatibility.dll" />
    <include name="Microsoft.VisualBasic.dll" />
    <include name="Microsoft.VisualC.dll" />
    <include name="Microsoft.VisualC.STLCLR.dll" />
    <include name="mscorlib.dll" />
    <include name="PresentationBuildTasks.dll" />
    <include name="PresentationCore.dll" />
    <include name="WindowsBase.dll" />
    <include name="PresentationFramework.dll" />
    <include name="PresentationFramework.Aero.dll" />
    <include name="PresentationFramework.Classic.dll" />
    <include name="PresentationFramework.Luna.dll" />
    <include name="PresentationFramework.Royale.dll" />
    <include name="ReachFramework.dll" />
    <include name="System.Activities.Core.Presentation.dll" />
    <include name="System.Activities.dll" />
    <include name="System.Activities.DurableInstancing.dll" />
    <include name="System.Activities.Presentation.dll" />
    <include name="System.AddIn.Contract.dll" />
    <include name="System.AddIn.dll" />
    <include name="System.ComponentModel.Composition.dll" />
    <include name="System.ComponentModel.DataAnnotations.dll" />
    <include name="System.Configuration.dll" />
    <include name="System.Core.dll" />
    <include name="System.Data.DataSetExtension.dll" />
    <include name="System.Data.dll" />
    <include name="System.Data.Entity.Design.dll" />
    <include name="System.Data.Entity.dll" />
    <include name="System.Data.Linq.dll" />
    <include name="System.Data.OracleClient.dll" />
    <include name="System.Data.Services.Client.dll" />
    <include name="System.Data.Services.Design.dll" />
    <include name="System.Data.Services.dll" />
    <include name="System.Data.SqlXml.dll" />
    <include name="System.Deployment.dll" />
    <include name="System.Design.dll" />
    <include name="System.Device.dll" />
    <include name="System.DirectoryServices.AccountManagement.dll" />
    <include name="System.DirectoryServices.dll" />
    <include name="System.DirectoryServices.Protocols.dll" />
    <include name="System.dll" />
    <include name="System.Drawing.Design.dll" />
    <include name="System.Drawing.dll" />
    <include name="System.EnterpriseServices.dll" />
    <include name="System.EnterpriseServices.Thunk.dll" />
    <include name="System.EnterpriseServices.Wrapper.dll" />
    <include name="System.IdentityModel.dll" />
    <include name="System.IdentityModel.Selectors.dll" />
    <include name="System.IO.Log.dll" />
    <include name="System.Management.dll" />
    <include name="System.Management.Instrumentation.dll" />
    <include name="System.Messaging.dll" />
    <include name="System.Net.dll" />
    <include name="System.Numerics.dll" />
    <include name="System.Printing.dll" />
    <include name="System.Runtime.Caching.dll" />
    <include name="System.Runtime.DurableInstancing.dll" />
    <include name="System.Runtime.Remoting.dll" />
    <include name="System.Runtime.Serialization.dll" />
    <include name="System.Runtime.Serialization.Formatters.Soap.dll" />
    <include name="System.Security.dll" />
    <include name="System.ServiceModel.Activation.dll" />
    <include name="System.ServiceModel.Activities.dll" />
    <include name="System.ServiceModel.Channels.dll" />
    <include name="System.ServiceModel.Discovery.dll" />
    <include name="System.ServiceModel.dll" />
    <include name="System.ServiceModel.Routing.dll" />
    <include name="System.ServiceModel.Web.dll" />
    <include name="System.ServiceProcess.dll" />
    <include name="System.Speech.dll" />
    <include name="System.Transactions.dll" />
    <include name="System.Web.Abstractions.dll" />
    <include name="System.Web.ApplicationServices.dll" />
    <include name="System.Web.DataVisualization.Design.dll" />
    <include name="System.Web.DataVisualization.dll" />
    <include name="System.Web.dll" />
    <include name="System.Web.DynamicData.Design.dll" />
    <include name="System.Web.DynamicData.dll" />
    <include name="System.Web.Entity.Design.dll" />
    <include name="System.Web.Entity.dll" />
    <include name="System.Web.Extensions.Design.dll" />
    <include name="System.Web.Extensions.dll" />
    <include name="System.Web.Mobile.dll" />
    <include name="System.Web.RegularExpressions.dll" />
    <include name="System.Web.Routing.dll" />
    <include name="System.Web.Services.dll" />
    <include name="System.Windows.Forms.DataVisualization.Design.dll" />
    <include name="System.Windows.Forms.DataVisualization.dll" />
    <include name="System.Windows.Forms.dll" />
    <include name="System.Windows.Input.Manipulations.dll" />
    <include name="System.Windows.Presentation.dll" />
    <include name="System.Workflow.Activities.dll" />
    <include name="System.Workflow.ComponentModel.dll" />
    <include name="System.Workflow.Runtime.dll" />
    <include name="System.WorkflowServices.dll" />
    <include name="System.Xaml.dll" />
    <include name="System.Xml.dll" />
    <include name="System.Xml.Linq.dll" />
  </reference-assemblies>
  <task-assemblies>
    <!-- include MS.NET version-neutral assemblies -->
    <include name="extensions/net/neutral/**/*.dll" />
    <!-- include MS.NET 4.0 specific assemblies -->
    <include name="extensions/net/4.0/**/*.dll" />
    <!-- include MS.NET specific task assembly -->
    <include name="NAnt.MSNetTasks.dll" />
    <!-- include MS.NET specific test assembly -->
    <include name="NAnt.MSNet.Tests.dll" />
    <!-- include .NET 4.0 specific assemblies -->
    <include name="extensions/common/4.0/**/*.dll" />
  </task-assemblies>
  <tool-paths>
    <directory name="${sdkInstallRoot}"
        if="${property::exists('sdkInstallRoot')}" />
    <directory name="${path::combine(installRoot, 'v4.0.30319')}" />
  </tool-paths>
  <project>
    <readregistry
        property="installRoot"
        key="SOFTWARE\Microsoft\.NETFramework\InstallRoot"
        hive="LocalMachine" />
    <locatesdk property="sdkInstallRoot" minwinsdkver="v7.0A" minnetfxver="4.0" maxnetfxver="4.0.99999" failonerror="false" />
  </project>
  <tasks>
    <task name="csc">
      <attribute name="supportsnowarnlist">true</attribute>
      <attribute name="supportswarnaserrorlist">true</attribute>
      <attribute name="supportskeycontainer">true</attribute>
      <attribute name="supportskeyfile">true</attribute>
      <attribute name="supportsdelaysign">true</attribute>
      <attribute name="supportsplatform">true</attribute>
      <attribute name="supportslangversion">true</attribute>
    </task>
    <task name="vbc">
      <attribute name="supportsdocgeneration">true</attribute>
      <attribute name="supportsnostdlib">true</attribute>
      <attribute name="supportsnowarnlist">true</attribute>
      <attribute name="supportskeycontainer">true</attribute>
      <attribute name="supportskeyfile">true</attribute>
      <attribute name="supportsdelaysign">true</attribute>
      <attribute name="supportsplatform">true</attribute>
      <attribute name="supportswarnaserrorlist">true</attribute>
    </task>
    <task name="jsc">
      <attribute name="supportsplatform">true</attribute>
    </task>
    <task name="vjc">
      <attribute name="supportsnowarnlist">true</attribute>
      <attribute name="supportskeycontainer">true</attribute>
      <attribute name="supportskeyfile">true</attribute>
      <attribute name="supportsdelaysign">true</attribute>
    </task>
    <task name="resgen">
      <attribute name="supportsassemblyreferences">true</attribute>
      <attribute name="supportsexternalfilereferences">true</attribute>
    </task>
    <task name="delay-sign">
      <attribute name="exename">sn</attribute>
    </task>
    <task name="license">
      <attribute name="exename">lc</attribute>
      <attribute name="supportsassemblyreferences">true</attribute>
    </task>
  </tasks>
</framework> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T06:12:42.607

nAnt 已经发布了 0.92，所以它还没有死。不知道他们什么时候会使用 csc 5.0。

由于您提到在其本机环境中构建 Mono 作为您的实际关注点，因此 Mono 项目有它自己的 msbuild 克隆，称为 xbuild (http://www.mono-project.com/Microsoft.Build)。他们说这不是 100% 的功能完整，但不要提供任何细节。我猜，除非你在外面做点什么，否则它可能会奏效。我建议简单地尝试从命令行调用 xbuild 并将解决方案作为第一个快速冒烟测试传递。

问候，迈克尔

# javascript - Jquery：延迟和淡入多个 div 加载？

> ID：11837797
> 
> 赞同：0
> 
> 时间：2012-08-07T00:33:14.707
> 
> 标签：javascript, jquery, delay, fadein, onload

我对javascript不是很有经验，但我认为这不是一个难题。无论如何，我都迷失了方向，并且想知道如何让多个 div 在页面加载时延迟淡入，比如使用 Jquery 的 5-10 个 div。以下是我正在使用和需要但已修改的代码，因此我可以加载 5+ div：

```
<script>
    $(".fade").hide(0).delay(1000).fadeIn(1000)
</script>​ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T00:35:07.603

```
$(".fade, #anotherElement, #yetAnother, .etc").hide(0).delay(1000).fadeIn(1000) 
```

它被称为[多重选择器](http://api.jquery.com/multiple-selector/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T00:36:11.883

*如果*“.fade”元素在运行时已经被解析，那么该代码应该可以正常工作- 如果您将该脚本块放在`<head>`. 如果脚本块位于正文的底部，它将起作用，或者如果您将代码放在文档就绪处理程序中，以便在文档被解析后运行：

```
$(document).ready(function() {
   $(".fade").hide(0).delay(1000).fadeIn(1000);
}); 
```

演示：http: [//jsfiddle.net/nnnnnn/QHwge/](http://jsfiddle.net/nnnnnn/QHwge/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T00:39:39.597

您不必*使用*javascript 执行此操作，但此处的示例似乎都可以正常工作。

下面是一个使用 CSS 的例子：

```
.fade {
   opacity: 1;
   transition: opacity .25s ease-in-out;
   -moz-transition: opacity .25s ease-in-out;
   -webkit-transition: opacity .25s ease-in-out;
   }

.fade:hover {
  opacity: 0.5;
} 
```

# wpf - 在 Windows XP 中运行 .NET 4.0 WPF 应用程序时与 ICommand 相关的错误

> ID：11837800
> 
> 赞同：1
> 
> 时间：2012-08-07T00:33:40.053
> 
> 标签：wpf, mvvm, windows-xp

我有一个针对 .NET 4.0 框架的 WPF 应用程序，并将 MVVM 模式与 MVVM Light 工具包一起使用。当我在安装了 .NET 4.0 运行时的 Windows XP 机器上运行此应用程序时，我收到以下异常：

```
Could not load type 'System.Windows.Input.ICommand' from assembly 'System, Version=4.0.0.0 ... 
```

我很困惑，因为 .NET 4.0 中的 ICommand 接口不在系统程序集中，而是在 PresentationCore.dll 中。在任何情况下，XP 机器都应该拥有所有的 4.0 程序集。有谁知道如何解决这个异常？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T13:25:46.333

在我运行 Windows 更新并选择与 .NET 4.0 相关的所有可选更新后，此问题就消失了。所以也许这只是框架中没有完全最新的东西。

# php - 使用回复系统显示来自评论的评论

> ID：11837803
> 
> 赞同：0
> 
> 时间：2012-08-07T00:33:51.413
> 
> 标签：php, sql

**数据库结构：**

```
TABLE cmts

| id | article_id | reply_id | name | comment |
-----------------------------------------------
| 1  |     3      |     0    | .... | ....... |
| 2  |     3      |     1    | .... | ....... |
| 3  |     3      |     2    | .... | ....... |
| 4  |     3      |     3    | .... | ....... |
| 5  |     3      |     0    | .... | ....... |
| 6  |     3      |     0    | .... | ....... | 
```

我的问题是用 PHP 显示它，我的意思是如何编写一个循环来为我带来理想的评论结构：

```
comment
    reply
        reply
            reply 
comment 
comment 
```

**记住：** “回复回复”是无限的。这是我的问题。

另外，数据库结构好吗？确保您理解，当`reply_id = 0`意思是它是独立评论时。

谢谢你们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T00:44:23.810

您正在尝试采用父/子评论系统，以便您可以回复实际评论和子评论

我的意思是你可以回复回复？

然后用这个做一个带有 WHILE 的 MYSQL QUERY（只显示父评论） - 这会列出所有父评论

在你的时间里，你应该再做一次查询和同时回复该评论（其中reply_id =评论id） - 这将显示所有子评论以及

另一个查询和 while 检查对子评论的回复（将列出对该回复的回复）回复 WHERE the reply_id = child comment id（在子 while 内）

您当前的数据库应该可以完成这项工作:)

可能更简单的方法会引起您的注意。

# php - MYSQL 选择最接近给定日期但不旧的记录

> ID：11837804
> 
> 赞同：2
> 
> 时间：2012-08-07T00:34:41.213
> 
> 标签：php, mysql, sql, database

我有一张表，其中包含属于不同用户的记录。

桌子：

```
RECORD_ID     USER_ID     DATE_CREATED
1             5           08/05/12
2             5           08/04/12
3             10          08/05/12
4             10          08/02/12
5             10          08/01/12 
```

询问：

```
SELECT user_id, MIN(date_created) as date_created
FROM (entries) 
GROUP BY user_id 
```

该查询返回每个用户的最旧记录。

```
RECORD_ID     USER_ID     DATE_CREATED
2             5           08/04/12
5             10          08/01/12 
```

如何选择最接近给定日期但不旧的最旧记录？类似于...的东西

```
SELECT oldest record > given oldest record
WHERE oldest record NOT =< given oldest record 
```

例如，查询返回 user 的所有记录`10`：

```
RECORD_ID     USER_ID     DATE_CREATED
3             10          08/05/12
4             10          08/02/12
5             10          08/01/12 
```

用户的给定日期`10`是`08/02/12`。现在我必须选择上面的下一个最旧的记录`08/02/12`。

除非它到达顶部，否则它将`08/05/12`永远不会低于该值。这在 MYSQL 中怎么可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T00:37:29.713

您可以使用 和 的组合来做到这`WHERE`一点`LIMIT`：

```
SELECT user_id, content, MIN(date_created) as date_created
FROM (entries) 
WHERE date_created > '2012-08-02'
GROUP BY user_id
LIMIT 1 
```

那里`WHERE`的声明将处理日期问题。该`LIMIT`语句将使您的结果减少到一行。显然，您可以更改`2012-08-02'`为变量或您需要的任何日期。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T00:38:00.257

让`$date_given`有给定的日期。

```
SELECT user_id, MIN(date_created) as date_created
FROM (entries) 
WHERE date_created > $date_given
GROUP BY user_id
LIMIT 1 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-07T00:54:20.843

怎么样

从 date_created > somedate order by date_created desc limit 1 的条目中选择 user_id, date_created

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T10:07:41.387

这是为所有具有 record_id 的用户选择最近记录的查询。只需将“08/02/12”更改为您需要的日期：

```
select 
    entries.record_id,entries.user_id, entries.Date_created 
from entries
join
(select 
      user_id,min(Date_created) minDate 
           from entries 
           where Date_Created>'08/02/12' 
      group by user_id
) minDates on (entries.user_id=minDates.user_id) 
              and 
              (entries.Date_created=minDates.minDate) 
```

# windows - 在 windows 命令中使用 egrep

> ID：11837809
> 
> 赞同：0
> 
> 时间：2012-08-07T00:35:31.133
> 
> 标签：windows, wget, grep

我是 Windows 用户，想使用以下脚本执行爬网（我下载了 wget 和 egrep）

```
wget --quiet http://example.com/sitemap.xml --output-document - | egrep -o "http://example.com[^<]+" | wget -q --delete-after -i - 
```

但是无法识别 egrep 选项，您能建议吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T00:50:28.957

这是一个 Unix 命令行。尝试安装 cygwin 或 git-bash 打开一个 bash 窗口并从那里运行命令。

# batch-file - 我需要创建一个带有批处理文件的文件夹，但它必须自动命名

> ID：11837810
> 
> 赞同：-1
> 
> 时间：2012-08-07T00:35:32.223
> 
> 标签：batch-file

我正在为我正在制作的程序制作这个批处理文件，但该程序需要创建一个文件夹。我怎样才能做到这一点？该文件夹需要在当前用户之后自动命名。谢谢！

\BAT\EPHR\Recoverd\%USERNAME%\

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T00:38:27.887

`mkdir \BAT\EPHR\Recoverd\%USERNAME%`

# c# - 自定义、复杂、动态反射解决方案 - C#

> ID：11837812
> 
> 赞同：9
> 
> 时间：2012-08-07T00:35:47.137
> 
> 标签：c#, winforms, reflection, propertygrid

我有许多正在使用的自定义类，我将对其进行解释和发布示例。在解释了他们都做了什么之后，我将尝试清楚地描述我的错误发生的条件。

首先，我使用 PropertyGrid 来显示几种不同类型对象的属性。因为 PropertyGrid 的默认绑定不像我想要的那样具有描述性，所以我创建了一些自定义类，我将它们称为“显示”类。这些 Display 类是通过传入一个对象然后创建属性来构造的，这些属性返回格式良好的字符串和对传入的真实对象的公共属性（在某些情况下是方法）的描述。

我将使用一些简短的示例代码来演示这一点：

这是我想在我的 PropertyGrid 中显示的对象的示例：

```
public class Joint
{
   public Joint(...)
   {...}

   //properties
   public string Name { get; set;}
   public CustomObject CC { get; set;}
   public List<CustomObject> Custom List { get; set;}
} 
```

字符串属性“名称”在 PropertyGrid 中显示良好但是 CustomObject 和 List 并没有以对我来说非常用户友好的方式显示。

所以我试图通过编写这个类来创建一个解决方案：

```
public class DisplayJoint
{       

   private Joint _jnt;

   public DisplayJoint(Joint jnt)
   {
      _jnt = jnt;
   }

   //properties
   public string Name {  get { return _jnt.Name; } }

   [TypeConverterAttribute(typeof(ExpandableObjectConverter))]
   public DisplayCustomObject CC {  get { return new DisplayCustomObject(_jnt.CC); } }

   [TypeConverterAttribute(typeof(ExpandableObjectConverter))]
   public List<CustomObject> CustomList { get; set;}
} 
```

正如您在上面的代码中看到的，我为 Joint 类和 CustomObject 类创建了特殊的 DisplayClasses。在我的项目中，我有许多不同类型的对象，它们需要相同类型的重叠显示类属性。

上面你可以看到我在最后两个属性上面添加的 Lines

> [TypeConverterAttribute(typeof(ExpandableObjectConverter))]

这条线解决了我在propertGrid中显示CustomObject的问题（几乎......稍后会详细介绍）。但是，对于我的自定义列表属性，它的工作方式不同。在自定义列表上，它扩展为仅显示计数和容量（列表的实际属性）这是有道理的，但这不是我想要的。我想查看列表中实际包含的对象。

![在此处输入图像描述](../Images/1e9a6ecac15b6cb46dabcac2e3052f5d.png)

所以这是我的复杂解决方案，最初来自[这个问题](https://stackoverflow.com/questions/313822/how-to-modify-propertygrid-at-runtime-add-remove-property-and-dynamic-types-enu)：

我有两个类用于以属性的形式将对象动态添加到 propertyGrid 绑定列表。第一个（CustomClass）可以在[这里下载](https://docs.google.com/open?id=0B_ZZBZRCDoDmaTRDSmhUclZuMFk)。它用于动态创建属性。我使用的第二个类（DisplayIEnumerable）是从第一个类派生的，可以在[这里找到。](https://docs.google.com/open?id=0B_ZZBZRCDoDmVWliekx5RGkwVFE)

DisplayIEnumerable 类循环遍历列表对象并向自身添加一个属性，其中包含每个对象中包含的信息。传入一个 DisplayClass 以准确定义这些对象属性应如何在 Grid 中表示。

到目前为止，一切都很好！正如这张图片所证明的（图片不是使用提供的类创建的，字符串在我使用的类中的格式不同，删除了格式化代码以帮助您专注于相关代码：

![在此处输入图像描述](../Images/e50657a6a3962437f6be3e612ebda733.png)

现在经过漫长的介绍，真正的问题。使用上面的技术，我想编写一个可以动态处理我没有为其编写唯一显示类的 CustomObjects 的类。我打算将此代码留给那些使用该应用程序进行测试的人，以便他们可以更有效地进行测试，而不必为我公司的每个 CustomObjects 提供完整的显示类。（有数百个）相反，通过将 propertyGrid 与下面的类绑定，我希望将所有列表属性和具有相应 DisplayClasses 的 CustomObjects 绑定在它们的位置。

这是我已经尝试过并且有错误的课程。我还没有尝试用我的 DisplayIEnumerable 类来实现 Lists 的替换，我想让基本功能首先工作：

```
using System;
using System.ComponentModel;
using System.Collections.Generic;
using System.Reflection;
using System.Collections;
using System.Windows.Forms;

   internal class DisplayObject : CustomClass<T>
   {
      #region Variables
      protected T _obj;
      #endregion

      #region Constructor
      public DisplayObject(T obj)
      {
         if (obj != null)
         {
            try
            {
               Type currentType = typeof(T);
               foreach (PropertyInfo propertyInfo in currentType.GetProperties())
               {
                  Attribute[] attributes = new Attribute[1];
                  if (propertyInfo.GetType() is IEnumerable)
                     attributes[0] = new TypeConverterAttribute(typeof(ExpandableObjectConverter));
                  else
                     attributes[0] = null;
                  this.Add(new CustomProperty(propertyInfo.Name, propertyInfo, propertyInfo.GetType(), false, true, attributes));
               }
            }
            catch
            {
               MessageBox.Show("Failure!");
            }
         }
      }
      #endregion

      #region Properties
      [Browsable(false)]
      public object Item
      {
         get { return _obj; }
         set { _obj = value; }
      }
      #endregion
   } 
```

运行时，PropertyGrid 显示为应有的样子： ![前](../Images/9416b405f6e961cab5d5f774366112ef.png)

但是，一旦您单击展开箭头，什么都不会发生，并且箭头会消失： ![后](../Images/3566b754de83ecf7cf3c6960cea27f92.png)

上面的类有什么问题，而我的 DisplayIEnumerable 类没有问题，导致这种行为差异？

我正在使用这样的 DisplayObject 类（在 DisplayClass 内）：

```
 [TypeConverterAttribute(typeof(ExpandableObjectConverter))]
  public DisplayObject EndJoint { get { if (_member.bcEnd != null) { return new DisplayObject(_member.EndJoint); } else return null; } } 
```

提前致谢！如果有人通过这个问题，我会印象深刻。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T14:47:54.460

您不必创建特殊的类来使用属性网格。只需用适当的属性装饰属性。这是一个例子：

两个自定义类：

```
public class MyObjType1
{
    public int Id { get; set; }
    public string Name { get; set; }

    public override string ToString()
    {
        return Name;
    }
}

public class MyObjType2
{
    public string Reference { get; set; }

    public override string ToString()
    {
        return Reference;
    }
} 
```

请注意`ToString`，如果没有为给定类型定义 TypeConverter，这就是属性网格默认使用的内容。

一个拥有一组自定义对象的“持有者”类：

```
public class MyHolder
{
    public MyHolder()
    {
        Objects = new List<object>();
    }

    public string Name { get; set; }

    [TypeConverter(typeof(MyCollectionConverter))]
    public List<object> Objects { get; private set; }
} 
```

请注意`TypeConverter`直接应用于`Objects`属性的自定义。这是来源：

```
public class MyCollectionConverter : ExpandableObjectConverter
{
    public override PropertyDescriptorCollection GetProperties(ITypeDescriptorContext context, object value, Attribute[] attributes)
    {
        IEnumerable enumerable = value as IEnumerable;
        if (enumerable == null)
            return base.GetProperties(context, value, attributes);

        int i = 0;
        List<PropertyDescriptor> list = new List<PropertyDescriptor>();
        foreach (object obj in enumerable)
        {
            MyItemPropertyDescriptor index = new MyItemPropertyDescriptor(i.ToString(), obj);
            list.Add(index);
            i++;
        }
        return new PropertyDescriptorCollection(list.ToArray());
    }

    public override object ConvertTo(ITypeDescriptorContext context, CultureInfo culture, object value, Type destinationType)
    {
        if (destinationType != typeof(string))
            return base.ConvertTo(context, culture, value, destinationType);

        IEnumerable enumerable = value as IEnumerable;
        if (enumerable == null)
            return base.ConvertTo(context, culture, value, destinationType);

        StringBuilder sb = new StringBuilder();
        foreach (object obj in enumerable)
        {
            if (sb.Length > 0)
            {
                sb.Append(',');
            }
            sb.AppendFormat("{0}", obj);
        }
        return sb.ToString();
    }
} 
```

请注意，我们覆盖`ConvertTo`并给它一个特殊的字符串，以显示列表中以逗号分隔的对象列表。也被`GetProperties`覆盖并使用特殊的`PropertyDescriptor`; 它`ExpandableObjectConverter`为子对象添加了一个属性，因此它们也可以扩展：

```
public class MyItemPropertyDescriptor : PropertyDescriptor
{
    private object _value;

    public MyItemPropertyDescriptor(string name, object value)
        : base(name, new[] { new TypeConverterAttribute(typeof(ExpandableObjectConverter)) })
    {
        _value = value;
    }

    public override bool IsReadOnly
    {
        get { return false; }
    }

    public override object GetValue(object component)
    {
        return _value;
    }

    public override Type PropertyType
    {
        get { return _value == null ? typeof(object) : _value.GetType(); }
    }

    public override bool ShouldSerializeValue(object component)
    {
        return false;
    }

    public override Type ComponentType
    {
        get { return typeof(object); }
    }

    public override bool CanResetValue(object component)
    {
        return false;
    }

    public override void ResetValue(object component)
    {
    }

    public override void SetValue(object component, object value)
    {
    }
} 
```

现在，这里有一些示例代码：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();

        MyHolder holder = new MyHolder();
        for (int i = 0; i < 3; i++)
        {
            holder.Objects.Add(new MyObjType1 { Id = i, Name = i + "Name" });
        }
        for (int i = 0; i < 3; i++)
        {
            holder.Objects.Add(new MyObjType2 { Reference = "Ref" + i });
        }
        propertyGrid1.SelectedObject = holder;
    }
} 
```

结果：

![在此处输入图像描述](../Images/d4afcdedd261946f8128afc4489f0cd1.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:19:15.457

我自己使用过 TypeConverters，我可以确认它们是底部的主要痛苦。你得到关于实际出了什么问题的 nada 信息，只有奇怪的输出......

如果它有帮助，我会想办法，但是将一个空（null）数组添加到任何*不是*IEnumerable 的东西中可能是个问题？尝试将 add 指令移到 if (...) 的范围内。我不认为这有什么害处。

另外，您确定（在最后一个使用 EndJoint 的示例中）getter 不返回空指针吗？空白条目闻起来像从我的经验中传递的空指针。

# java - Androidplot线不显示

> ID：11837821
> 
> 赞同：0
> 
> 时间：2012-08-07T00:36:33.083
> 
> 标签：java, android, eclipse, charts, androidplot

我遵循了[快速入门教程](http://androidplot.com/wiki/Quickstart)并使用 new`LineAndPointFormatter(Color.BLACK, Color.RED, Color.TRANSPARENT)`来绘制我的线条。红色顶点出现在我的 Android 平板电脑上，但黑色线条没有。可能是什么问题？

我使用最新的`Androidplot version (0.5.0)`并完全按照教程进行，但修改了`lineandpointformatter`参数值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T03:17:38.787

我设法通过删除硬件加速来解决这个问题。这是通过转到 AndroidManifest.xml 文件并在标记中添加以下行来实现的：

```
 <android:hardwareAccelerated = "false"> 
```

# ant - FDT ANT 任务 - exportAirApplication 与 release.AirApplication

> ID：11837822
> 
> 赞同：1
> 
> 时间：2012-08-07T00:36:43.047
> 
> 标签：ant, air, fdt

我在 FDT 5.6.x 下使用定制的 ANT 驱动的 AIR 封装而苦苦挣扎。

我刚刚从 FDT 5.0.x 升级，我正在努力通过工作流程重建。我有一个 ANT 脚本，它加载当前项目属性（内部版本号等），将它们注入 AIR properties.xml 文件，然后使用 fdt.release.AirApplication 任务打包应用程序的一个版本，并使用自定义文件名来指示释放等

我可以看到发布打包机制进行了重大重构；消失的是在“启动配置”对话框中创建发布配置文件的能力，而现在它位于“项目属性”中。

我正在使用的 ANT 任务 (fdt.release.AirApplication) 也消失了。唯一似乎接近的是 fdt.exportAirApplication，它只需要 2 个参数，根据[文档](http://fdt.powerflasher.com/docs/FDT_Ant_Tasks#fdt.exportAirApplication_.28FDT_5.6.29 "FDT ANT 文档")是：

> 此任务执行与在“移动属性 > 部署”中按“导出应用程序”按钮相同的行为

我不确定它引用的对话框是否已被称为该对话框。

Project Properties > FDT AIR Properties > Desktop 中的对话框表明您可以将自定义参数传递给 AIR 打包程序，但我一直无法找到任何有关如何使用此功能的文档。

就像 FDT 中的很多东西一样，这里有强大的功能，而伴随它的文档却很少。有没有人在 5.6.x 下得到 ANT 驱动的定制编译？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T13:40:20.417

要通过 Ant 自定义和控制您的 AIR 包装，您需要使用：

*   预包装启动器。这只是一个现有的启动器。这是为了确保您正在编译优化的 SWF。
*   将变量注入“com.powerflasher.fdt.core.prefs”文件。
*   使用[fdt.exportAirApplication](http://fdt.powerflasher.com/docs/FDT_Ant_Tasks#fdt.exportAirApplication_.28FDT_5.6.29)

## com.powerflasher.fdt.core.prefs

下面是选择“com.powerflasher.fdt.core.prefs”文件的屏幕截图。在其中，您将完善用于 AIR 导出的所有属性。要修改 ADT 参数，请查看：

...CUSTOM.ADT.CMD.LINE。

在那里您可以看到 FDT 使用的全局变量 - 例如 ${target}。要改变这一点，只需添加您自己的参数。例子：

CUSTOM.ADT.CMD.LINE=${package} -target ipa-debug-interpreter ${connection}...

![在此处输入图像描述](../Images/7dd09507e8908399cb1ddd4805f49d72.png)

# php - 从函数返回 html

> ID：11837828
> 
> 赞同：1
> 
> 时间：2012-08-07T00:37:16.967
> 
> 标签：php, html

所以作为一个新手，这只是一个最佳实践问题，但最好从这样的函数返回 html：

```
function returnHtml($userName)
{   
$htmlMsg = "
<html>
    <head>
        <title>Return the html</title>
    </head>
    <body>
        <p>You've received an email from: ".$userName.".</p>
    </body>
</html>
";

return $htmlMsg;
} 
```

或者像这样：

```
function returnHtml($userName)
{
?>
<html>
    <head>
        <title>Return the html</title>
    </head>
    <body>
        <p>You've received an email from: <?php $userName ?>.</p>
    </body>
</html>
<?php
} 
```

第二个比第一个容易得多，因为您不必将 html 转换为字符串，但我想知道缺少 return 语句是否会导致任何无法预料的问题。感谢您的任何建议！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T00:39:27.950

您发布的两个功能做不同的事情。第一个返回一个html字符串，第二个打印字符串。

本质上，这取决于您要使用该功能完成什么。如果你想打印一些 HTML，第二个函数更好，如果你想在一个字符串中包含一些 HTML，第一个更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T00:45:12.337

如果您使用它来使用 AJAX、GET 或 POST 方法获取 HTML 代码，那么我会选择第一个，因为从 php 文件回显的任何内容都会放入您可以使用的变量中。

例如：

```
$.ajax({
    type: "POST",
    url: "document.php",
    data: {data: "some information to send"},
    success: function(echoed_data) {
        $('#element').html(echoed_data);
    }
}); 
```

文件.php

```
function returnHtml($userName) {   
    $htmlMsg = "
        <html>
            <head>
                <title>Return the html</title>
            </head>
            <body>
                <p>You've received an email from: ".$userName.".</p>
            </body>
        </html>
    ";

    echo $htmlMsg;
} 
```

这将使用 AJAX 从“document.php”发送和接收数据，然后将从 .php 文件回显的 HTML 代码输入到某个元素中。

# .net - 省电 SpinWait

> ID：11837830
> 
> 赞同：2
> 
> 时间：2012-08-07T00:37:41.657
> 
> 标签：.net, visual-c++, assembly, intel, spinwait

我在 C# 中有一个轮询循环，**平均需要每 100 微秒轮询一次** *<EDIT>（当然，由于核心短缺，Windows 没有进行过多的抢占式线程上下文切换）</EDIT>*。

由于没有时间重新安排，Sleep(1) 不会这样做。

所以我决定专用一个线程（实际上，在设置亲和力时，一个核心）并使用 Thread.SpinWait 为每次迭代的一组周期。虽然这很好用，但它消耗了不必要的电量。100 微秒足以让 CPU 暂停（但不足以让线程从调度程序中临时删除，因为 Windows 时间片会很长）。

相反，我正在考虑使用 Intel PAUSE 指令，但我不确定它是否会触发 Intel CPU 暂停硬件线程。英特尔声称它可以保存功率并且应该在自旋循环中使用，但由于暂停时间长达 100 微秒，我真的希望内核进入 C1 模式睡眠。

有任何想法吗？

编辑：我正在轮询第三方 API，因此没有要阻止的同步事件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T14:14:55.320

鉴于您的等待时间很长，您可能会发现[SSE3 内存区域监视器](http://www.rz.uni-karlsruhe.de/rz/docs/VTune/reference/Guideline_for_MONITOR_MWAIT.htm)在节能方面效率更高，但是，它并不是真正设计为阻塞自旋等待，而是作为警报等待，但仍可能证明是一种可行的替代方案。

然而，在 C# 中获取它需要一个外部 DLL，它提供了 C++ 内部函数（`_mm_mwait`和`_mm_monitor`）的接口。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T13:25:38.643

自然地，使用同步原语和计时器是避免 CPU/耗电量大的忙等待的首选方法。但是，如果您需要*如此*频繁地轮询 - 至少在用户模式下，无法通过常规方式实现这一点。

您可以做的一件简单的事情是`pause`在循环中包含一条 CPU 指令。在 MSVC 中，它是通过内部`YieldProcessor()`方法实现的。

除此之外 - 可能仅在内核模式编程中。在那里您可以使用高精度多媒体计时器。

**编辑：**

关于`SetWaitableTimer`. 这可能是一种选择。与“传统的”Win32 等待函数（例如`Sleep`等`WaitForSingleObject`）不同，它使用高精度超时作为参数。

然而，用户模式定时器本质上是**异步**的。让我们假设计时器以高精度激活（这并不明显，“传统”Win32 等待函数精确到刻度量，大约几十毫秒）。计时器激活后 - 它释放适当的等待线程。但是线程调度程序不必立即将此线程附加到执行中——它可能会等待下一个时间片。如果有并发线程，甚至会更多地延迟线程执行。

总之：这个想法似乎值得一试。但是，如果这或多或少等同于 using ，我不会感到惊讶`Sleep`。

# c# - 在类型转换时使用“int”或“Int32”？

> ID：11837833
> 
> 赞同：3
> 
> 时间：2012-08-07T00:38:17.107
> 
> 标签：c#, c#-4.0

> **可能重复：**
> [C#、int 或 Int32？我应该关心吗？](https://stackoverflow.com/questions/62503/c-int-or-int32-should-i-care)

我`GetPosition(this)`在`MouseMoved event`被触发时使用，因此具有：

```
Point pt = e.GetPosition(this); 
```

据我所知，以下两种类型转换都有效，但推荐使用哪一种，为什么？

```
int x = (int)pt.X;
int x = (Int32)pt.X; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-07T00:39:57.500

它们做的事情完全相同——它们甚至会编译成相同的 IL。（假设你在某个地方没有疯狂的其他`Int32`类型......）

`int`只是`global::System.Int32`.

（这不仅适用于强制转换——几乎在任何使用类型名称的地方。）

# javascript - d3js 移动节点而不拖动

> ID：11837837
> 
> 赞同：1
> 
> 时间：2012-08-07T00:38:57.913
> 
> 标签：javascript, d3.js

我正在使用以下代码在我的 d3.js 图中移动一个节点：

```
d3.select("#"+ nodeid).attr("x",x);
d3.select("#"+ nodeid).attr("y",y); 
```

这很好用，但是当我再次开始拖动节点时，它会“跳”回原来的位置并从那里开始移动。

有什么想法我在这里做错了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T01:19:53.353

我最终也将其添加到代码中

```
d3.select("#"+ nodeid).data([{x: x, y: y}]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T00:56:14.100

您正在更新 DOM 元素（图形），而不是基础数据，并且 dragstart 事件正在使用仍存储在数据中的原始位置。

尝试这样的事情：

```
force.setNodeCoords = function (id, x, y) {
    var fnodes = force.nodes();
    fnodes[id].x = x;
    fnodes[id].y = y;
    force.nodes(fnodes);
    svg.selectAll("circle.node")
        .attr("cx", function(d) { return d.x; })
        .attr("cy", function(d) { return d.y; });
}; 
```

（`svg`您的 SVG 或其他父 div 在哪里，并且`node`是您的节点的类）

您可能还想更新行/链接！

# ruby-on-rails - 如何将属性添加到rails中的一组模型

> ID：11837839
> 
> 赞同：0
> 
> 时间：2012-08-07T00:39:07.093
> 
> 标签：ruby-on-rails

基本上我需要连接到另一个应用程序的数据库，我已经完成了连接`config/database.yml`，该数据库不是来自 rails 应用程序，所以对于初学者来说，表名不是复数形式，我还需要`establish_connection`将试图创建一个父类并从中继承其他类，但我就是做错了，一直抱怨父类没有表，如果我添加`abstract_class`到它，那么子模块也是抽象的-。 -

怎么能干一点

### 更新

这工作...

```
class QB < ActiveRecord::Base
  self.abstract_class = true
  establish_connection 'quickbooks'

  def self.pluralize_table_names
    false
  end
end 
```

不太清楚为什么要这样设置复数表名，但它可以工作，感谢抽象类@zetetic 的提示

### 更新

在父类中使用它，更适合我的情况

```
def self.table_name
    self.name.gsub(/QB::/,'').downcase
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T03:37:51.857

> if i add abstract_class to it then the child modules are abstract as well

This should not be the case. `self.abstract_class = true` sets an instance variable in the class singleton, a 'class instance variable'. This is not shared by subclasses:

```
class A < ActiveRecord::Base
  self.abstract_class = true
end

class B < A; end

A.abstract_class # true
B.abstract_class # nil 
```

This [Martin Fowler blog post](http://martinfowler.com/bliki/ClassInstanceVariable.html) describes what is going on in more detail.

# ios - iOS App Store 提交：Apple 是否使用经过验证的 Facebook 帐户测试 Facebook 应用程序？

> ID：11837840
> 
> 赞同：3
> 
> 时间：2012-08-07T00:39:12.440
> 
> 标签：ios, facebook, submission

我目前正在向 Apple 提交申请。我的应用程序刚刚被拒绝，他们还好心地附上了屏幕截图。

我的应用程序是 Facebook 应用程序，他们无法登录，因为 Facebook 报告他们没有使用经过验证的 Facebook 帐户。

所以我的问题是：Apple 是使用“已验证”的 Facebook 帐户测试 Facebook 应用程序，还是“测试”Facebook 帐户？如果是后者，我可以切换服务器端来解决问题。

有没有人在审核过程中遇到过这种情况？

谢谢！

（我不确定这是否是 NDA，但它不应该是 :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:11:21.997

答案是：不 - 他们使用未经验证的帐户（至少在我的情况下）。

# html - 在同一行放置一个左/右跨度，所以没有空格

> ID：11837847
> 
> 赞同：-2
> 
> 时间：2012-08-07T00:40:33.847
> 
> 标签：html

我正在尝试制作一个网站，我需要右侧左侧内容框中的菜单。

```
#Wrapper { 
    position: absolute;
    margin-left: auto;
    margin-right: auto;
    left: 0%;
    right: 0%;
    top: 10px;
}

span.left {
    position: relative;
    left: -365px;
    top: 400px;
    z-index:1;
}

span.right {
    position: relative;
    right: -74px;
    z-index:-1;
} 
```

每次我在左侧跨度下添加新图像时，右侧跨度的顶部都会下降，因为它们不在同一行。我仍然想要相对定位，但我希望两个跨度彼此重叠。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T00:43:27.480

你应该使用浮点数：

```
span.right {
     float: right;
}
span.left {
     float: left;
} 
```

然后在包装广告的底部显示以下内容：

```
<div style="clear: both; height: 0">&nbsp;</div> 
```

使包装器与最高的浮动 div 具有相同的高度

# php - 在带有存储过程的 php 中使用 pdo

> ID：11837849
> 
> 赞同：8
> 
> 时间：2012-08-07T00:40:45.337
> 
> 标签：php, mysql, stored-procedures, pdo

我在 MySQL 数据库中有一个简单的存储过程：

```
DELIMITER $$
CREATE DEFINER=`vidhu`@`%` PROCEDURE `test`(var_datain TEXT)
BEGIN
    SELECT var_datain;
END 
```

在 mysql-workbench 中调用此过程时，它会返回我输入的数据：

![截图表单mysql工作台](../Images/328a0be60ddd1208c06ec3cbced0ae4a.png)

*现在，当我使用pdo*从 PHP 调用它时，出现错误：

```
Fatal error: Cannot pass parameter 2 by reference in C:/apache......(3rd line) 
```

这是我的php代码：

```
$db = new PDO(DSN, DBUSER, DBPASS);
$stmt = $db->prepare("CALL test(?)");
$stmt->bindParam(1, 'hai!', PDO::PARAM_STR);
$rs = $stmt->execute();
$result = $stmt->fetchAll(PDO::FETCH_ASSOC);
echo $result[0]; 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-07T00:52:14.237

您需要使用[bindValue](http://www.php.net/manual/en/pdostatement.bindvalue.php)而不是[bindParam](http://www.php.net/manual/en/pdostatement.bindparam.php)。

当您使用 bindParam 时，它会将提供的变量绑定到参数，而不是变量的值。

所以，如果你这样做：

```
$x = 5;
$stmt->bindParam(1, $x, PDO::PARAM_INT);
$x = 6;
$stmt->execute(); //executes with 6 instead of 5 
```

它实际上是用 6 而不是 5 执行的。为此，该方法必须具有对变量的引用。您不能引用文字，因此这意味着 bindParam 不能与文字（或您无法引用的任何内容）一起使用。

```
$x = 5;
$stmt->bindValue(1, $x, PDO::PARAM_INT);
$x = 6;
$stmt->execute(); //executes with 5 instead of 6 
```

然后：

```
$stmt->bindParam(1, 1, PDO::PARAM_INT); 
//invalid because there's no way to pass a literal 1 by reference
$stmt->bindValue(1, 1, PDO::PARAM_INT);
//valid 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2020-12-22T06:32:57.733

该`bindParam`函数只接受值变量，这就是为什么参数二`hai`不是变量的原因`cannot be passed`。所以不需要bindValue，而是正确使用bindParam。示例：使用 bindParam 时：来自您的代码段。

```
$a = "hai";
$db = new PDO(DSN, DBUSER, DBPASS);
$stmt = $db->prepare("CALL test(?)");
$stmt->bindParam(s, $a, PDO::PARAM_STR);
$rs = $stmt->execute();
$result = $stmt->fetchAll(PDO::FETCH_ASSOC);
echo $result[0]; 
```

这应该解决您的问题，而不是上面的答案。

* * *

## 回答 #3

> 赞同：-6
> 
> 时间：2015-01-22T20:11:09.157

以下代码适用于没有准备语句的调用！

```
$query="CALL store_procedure_name(@a)";
$conn->query($query);

$query="SELECT @a as outvar;";
$result = $conn->query($query);
foreach ($result as $x)
{
    $res=$x['outvar'];
}

echo $res; 
```

# ios - iOS 应用商店统计数据按应用划分

> ID：11837859
> 
> 赞同：0
> 
> 时间：2012-08-07T00:42:38.690
> 
> 标签：ios, app-store-connect, itunes-store

我希望能够检查 iOS App Store 收入统计数据并添加只能查看某些应用程序统计信息的新用户（例如，用户 1 可以查看 iTunes 帐户中所有应用程序的统计信息，用户 2 可以查看其中一个应用程序的统计信息2 或 3 个应用程序。）

有没有系统可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T23:26:25.987

AppFigures.com 会这样做，但它确实有月费。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-07T00:50:07.130

我将回答说这是不可能的，因为 iTunes Connect 无法为您提供对用户的这种细粒度的控制。

我很高兴被其他知道第三方服务的人证明是错误的，该第三方服务可以抓取 iTunes Connect [AppViz](http://www.ideaswarm.com/AppViz2.html)样式并使用其自己的身份验证系统限制访问。

# delphi - Delphi中ListView上的半透明层？

> ID：11837865
> 
> 赞同：5
> 
> 时间：2012-08-07T00:44:33.490
> 
> 标签：delphi, delphi-xe2, zooming

在 Delphi XE2 中，我有一个带有图像缩略图的 ListView。当我单击其中一个缩略图时，我希望 ListView 被一个深色的半透明图层覆盖，并将单击的图像放大到该图层的顶部。

由于不可能将 TImage 放在 ListView 的顶部，因此我尝试使用另一种具有 AlphaBlend 128 透明度的表格作为图层。然而，这个 AlphaBlend 形式也使得它上面的 TImage 是 Alpha 透明的。

所以目标似乎是使图层形成 AlphaBlend 透明而不是其上的图像。如何做到这一点？

* * *

2012 年 8 月 7 日编辑：

解决了！！感谢 Remy Lebeau，他给了我决定性的暗示来培养形象。我从 TMS 中找到了 TW7Image，这是我所知道的唯一具有 Opacity（即 AlphaBlend）属性的图像类型。我使用了这个程序：

在 W7Image 中，在 Picture 属性中加载一个黑色图像，将 Opacity 设置为 192 并设置 Stretch 模式。

将其他图像设置为中心、比例等，然后：

```
// In this order (!):
// 1.
imgSemiTransparentBlackLayer.Parent := MyListView;
imgSemiTransparentBlackLayer.Align := alClient;
// 2.
imgTop.Picture.LoadFromFile('MyPicture.png');
imgTop.Parent := MyListView;
imgTop.Align := alClient; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T02:05:51.740

The `TForm.AlphaBlend` property applies to the entire `TForm` as a whole. What you need is per-pixel alpha-blending instead, which `TForm` does not natively support. You could call `UpdateLayeredWindow()` to implement per-pixel alpha, but that may conflict with the VCL's use of `SetLayeredWindowAttributes()`.

For a purely VCL solution, you could try using two `TForm` objects. Have one `TForm` contain just the `TImage` and no background, then have a second `TForm` lay on top of it, where the second `TForm` has both its `TransparentColor` and `AlphaBlend` properties enabled, has a square of the `TransparenColorValue` that is the same dimensions as the `TImage`, and has a dark background color that gets alpha-blended with whatever is underneath it.

An alternative solution would be to use the Win32 API `CreateWindowEx()` function directly to create the image window, then you can use `UpdateLayeredWindow()` on it. That requires you to create an in-memory bitmap to back the window drawing, so you can draw your image directly on to that bitmap, rather than using a `TImage` component. Then you just give it a dark background and specify a per-pixel alpha for the bitmap pixels surrounding the image pixels.

BTW, you **can** put a `TImage` on top of a `TListView`, if you set the `TListView` as the `TImage.Parent`. You just won't be able to alpha-blend the `TImage`, that's all.

# spring - Riak for Grails 插件 - 无法工作

> ID：11837873
> 
> 赞同：0
> 
> 时间：2012-08-07T00:47:17.623
> 
> 标签：spring, grails, spring-data, riak, springsource

我正在尝试配置和测试 Riak for Grails 插件。我通过在 BuildConfig 中删除它的依赖项来删除了 hibernate 插件。注意：我并没有尝试对 GORM 使用它——而只是使用 spring 数据支持进行查询。

我必须添加以下两行以避免在删除休眠后运行时出错；

```
springConfig.addAlias "persistenceInterceptor", "riakPersistenceInterceptor"
springConfig.addAlias('transactionManager', 'riakTransactionManager') 
```

该项目编译良好，并运行。但是 - 一旦我尝试使用任何 Riak 方法，我通常会得到 404 - Object not found 错误，或者更难以捉摸的东西。

文档建议我可以使用自动接线服务；

```
import org.springframework.data.keyvalue.riak.core.RiakTemplate

class myClass {

    // Service injection
    def riakTemplate

    def myMethod() {
        riakTemplate.set("myBucket", "myKey", "A String")
    }

} 
```

但这不起作用。我试过了;

```
RiakTemplate riakTemplate = new riakTemplate("serviceurl", "mapredurl")
riakTemplate.set("myBucket", "myKey", "A String") 
```

我的想法不多了。是否有指南或有助于使其正常工作的东西？

值得注意的是，我在本地主机上运行了 Riak，而且我可以使用 Curl 轻松管理密钥。所以我认为这不是 Riak 的问题。

我可能遗漏了一些明显的东西。:)

我正在运行 Grails 2.1.0。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:26:13.877

我知道这并不能“回答问题”，但是对于当前的项目，由于类似的问题，我们决定放弃插件，转而在服务类中直接使用 Spring Rest。我认为这种方法也适合您，因为您在顶部提到您没有尝试使用插件的 GORM 支持。

您应该会发现直接的 Spring Rest 方法相当容易实现，可以更好地控制 map reduce 和利用 2i。我还建议从尝试遵循 Basho 自己的 Java 客户端的 Riak 接口开始，这样如果您觉得需要性能优势，将来某个时候用 Basho 的 PBC 实现替换您的 Rest 实现可能会更容易。

关于 Riak 插件的一个特别说明：它似乎在不久前无限期搁置，而领导者 Jonathan Brisbin 似乎特别关注新的 Spring Data - 最近的 REST 项目 - 也许关于 Riak 插件的新工作会“春天”由此而来？

-托德

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T12:57:22.180

我也遇到了这个问题，发现这是因为默认配置是在底层 RestTemplate 中使用 DefaultErrorHandler。

要使 RiakTemplate 在 404 上不会失败，您可以将属性 'ignoreNotFound' 设置为 true，它会再次工作。

# ssis - SSIS 查找转换

> ID：11837878
> 
> 赞同：0
> 
> 时间：2012-08-07T00:48:08.160
> 
> 标签：ssis, transform, lookup, bids

在 SSIS 中，我有一个查找转换，它执行仅将新数据插入表的功能，称为 tableY。所以过程如下：

```
0) Aggregate (group by) the primary key for the input row
1) Do a lookup with the current input row on tableY using the primary key
2) Insert the input row if there is not a match (the current row does not exist in tableY) 
```

我收到“违反主键列的完整性约束”的错误

这怎么可能，因为所有输入都是唯一的，并且转换的输出是“查找不匹配输出”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T11:26:45.897

可能您的查找转换正在使用 TableY 的缓存副本。尝试在查找转换编辑器上选择“无缓存”（尽管加载时间可能会受到影响）。

有关查找缓存模式的更多信息，请参阅[此博客文章](http://blogs.msdn.com/b/mattm/archive/2008/10/18/lookup-cache-modes.aspx)。

# postgresql - 需要帮助将 mysql 查询转换为 postgres

> ID：11837880
> 
> 赞同：-1
> 
> 时间：2012-08-07T00:48:21.263
> 
> 标签：postgresql

我在搞一个教程 [http: //www.kendoui.c​​om/blogs/teamblog/posts/12-01-18/get_rolling_with_kendo_ui_and_php_ndash_part_1.aspx](http://www.kendoui.com/blogs/teamblog/posts/12-01-18/get_rolling_with_kendo_ui_and_php_ndash_part_1.aspx)

并从这里使用 postgres 北风端口： [http ://code.google.com/p/northwindextended/downloads/detail?name=northwind.postgre.sql](http://code.google.com/p/northwindextended/downloads/detail?name=northwind.postgre.sql)

我无法在数据库上执行此查询：

```
SELECT TRIM(t.TerritoryDescription) AS TerritoryDescription
            FROM Territories t                 
            INNER JOIN EmployeeTerritories et ON t.TerritoryID = et.TerritoryID    
            INNER JOIN Employees e ON et.EmployeeID = e.EmployeeID           
            WHERE e.EmployeeID = 1 
```

错误是：

```
错误：列 t.territoryid 不存在
第 3 行：INNER JOIN EmployeeTerritories et ON t.Territory

```

但是表格`territories`和`territoryid`列都在那里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T01:14:46.387

问题是在您用于创建数据库的 SQL 中，您使用的是带引号的列名：

```
CREATE TABLE territories (
    "TerritoryID" character varying(20) NOT NULL,
    "TerritoryDescription" bpchar NOT NULL,
    "RegionID" smallint NOT NULL
); 
```

由于您使用了带引号的名称，postgres 期望列大小写匹配。但是，默认情况下，它会将所有列名小写：

> PostgreSQL 在对象创建时和查询时自动将所有标识符（例如表/列名）折叠为小写值。要强制使用混合或大写标识符，您必须使用双引号 ("") 对标识符进行转义。

*来自[PHP pgsql 文档](http://php.net/manual/en/ref.pgsql.php)。*

`""`因此，请在执行查询时引用您的列名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T01:14:18.463

谢谢@Adrian Cornish，这是区分大小写的，所以现在可以使用：

```
SELECT TRIM(t."TerritoryDescription") AS "TerritoryDescription"
        FROM Territories t                 
        INNER JOIN employeeterritories et ON t."TerritoryID" = et."TerritoryID"    
        INNER JOIN employees e ON et."EmployeeID" = e."EmployeeID"           
        WHERE e."EmployeeID" = 1 
```

# c++ - 我对 set.union (C++) 有疑问

> ID：11837881
> 
> 赞同：0
> 
> 时间：2012-08-07T00:48:28.810
> 
> 标签：c++, set-union

我正在尝试合并两组（在向量中）。

setA 包含 a、b。setB 包含 a、c。

联合之后，结果应该包含a，b，c。但是，该程序不工作，它有某种调试错误。

```
#include <vector>
#include <iostream>
#include <algorithm>
using namespace std;

int main()
{
vector<char> setA;
vector<char> setB;
vector<char> result;
vector<char>::iterator it;

setA.push_back('a');
setA.push_back('b');
setB.push_back('a');
setB.push_back('c');

it = set_union(setA.begin(), setA.end(), setB.begin(), setB.end(), result.begin());

for (int i = 0; i < result.size(); i++)
{
    cout << result[i] << " ";
}

system("PAUSE");
} 
```

有谁知道问题是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T00:53:18.793

您应该使用`resize`结果向量来适应联合的最大大小，或者使用`std::back_inserter`：

```
it = set_union(setA.begin(), setA.end(),
               setB.begin(), setB.end(),
               back_inserter(result)); 
```

# ruby-on-rails - RSpec 控制器响应正文返回响应类的字符串名称而不是响应

> ID：11837884
> 
> 赞同：1
> 
> 时间：2012-08-07T00:48:49.213
> 
> 标签：ruby-on-rails, rspec, response, controllers

我正在使用 rspec 在 Rails 中测试控制器。响应正文只是响应实例的字符串，而不是实际响应。我的测试如下。

```
require 'spec_helper'

describe CampusesController do
    render_views

    before(:each) do
        sign_in :auth_role, 'test@test.com', 'password'
    end

    it 'should retrieve all campuses as json' do
        FactoryGirl.create(:basic_campus)
        get 'index', :format => :json
        ap response.body
    end

end 
```

response.body 是字符串“#<ActionDispatch::Response:0x007f87d6ee8800>”。如何获得实际的 json 响应？当我通过浏览器时，它工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T01:47:39.383

它与声明性授权和设计有关。这个答案帮助我弄清楚如何设置我的测试。[在 Rails 3.1 中使用 RSpec 进行设计和声明性测试的字符串化键错误](https://stackoverflow.com/questions/7827247/stringify-keys-error-with-devise-and-declarative-testing-with-rspec-in-rails-3-1)

# c# - 将电话号码转换为字母 (C#)

> ID：11837885
> 
> 赞同：-1
> 
> 时间：2012-08-07T00:48:58.170
> 
> 标签：c#, phone-number

所以对于这个 C# 类，我必须让用户在控制台中输入一个 7 位数的电话号码。每个数字都存储为不同的字符。然后将每个字符更改为一个字母。数字更改为的字母背后没有逻辑。（我真的不明白这个作业的意义，这可能会影响我的编码器。）这是作业的内容。

您的任务：预付费电话服务需要一个将字母数字键盘输入转换为电话号码的程序。用户将输入八个字符，程序将输出错误消息或翻译后的七位数电话号码。输入可能包含数字、字母或两者兼有。字母可以是大写或小写。

编码方法：

*   Main()：声明七个字符变量，并通过引用将它们传递给以下方法：
    *   ProcessInput()：获取用户输入并执行转换
        *   ShowResults()：显示结果
            *   GetInput()：从用户那里获取七个字符并将它们存储到 Main() 通过引用传递的七个变量中。
            *   ProcessInput()：为每个调用 ToDigit()，通过引用传递每个字符变量，并按值将这些代码之一返回到 Main()：o 如果没有输入错误，则为 0 o 如果有输入错误，则为 -1"

该程序将按照标准电话键盘布局执行转换。

基本上，2 s A、B、C 3 是 D、E、F 等，然后 D、E、F 是 3，依此类推。

现在我除了输入之外什么也没做，但它没有存储为字符，只是一个字符串。我真的很讨厌这个作业，因为我们刚刚用 Cases 和 If 语句做了两个作业，这对我来说似乎是多余的。

```
Console.WriteLine("Write a Phone Number that consists of Seven Numbers.");
string Number = Console.ReadLine();

if (Number.Length != 7)
    Console.WriteLine("You have entered a phone number that is too long.");

Console.WriteLine("You have entered: {0}", Number);
Console.ReadLine(); 
```

所以我真正的问题是：如何将输入数字存储为字符，然后用 case 语句定义这些字符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T01:06:37.767

如果课堂上没有涉及到字典课程，请不要使用它，因为这个作业将使用你在课堂上学到的工具来解决，你可能会在作业中得到一个糟糕的成绩。

有两种方法可以解决这个问题。

1.  为一个人可以输入的每个字母或数字做一个`switch`声明。`case`如果你为字母表中的每个字母做一个并输入它对应的数字，这可能会让你的成绩很差，但是如果你使用`case`诸如“失败”之类的陈述的一些特征（没有链接，我把它留给你研究那是什么）你可能会得到一个好成绩。

2.  这也可以用`if`语句来完成，就像第 1 点一样，如果你`if`为每个条目做一个，你会得到一个糟糕的成绩，但如果你能弄清楚如何`A, B, C, and 1`用一个来解决，`if`你可能会得到一个好成绩。

* * *

我将为您提供如何单独获取每个字母的答案，因为我认为这不是本课的目的，最简单的方法是使用 foreach 语句。

```
string finalNumber = "";
foreach(char digit in Number)
{
  finalNumber += ProcessDigit(digit);
}
Console.WriteLine(finalNumber);

//Elsewhere
char ProcessDigit(char digit)
{
     char newDigit;

     //change digit to whatever you needed to turn it in to and store it in newDigit;

     return newDigit;
} 
```

另外一个免费的，在将字符串输入 foreach 之前对字符串执行[ToUpperInvariant() ，您只需要检查大写字母。](http://msdn.microsoft.com/en-us/library/system.string.toupperinvariant)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T00:53:32.807

由于这是家庭作业，因此您应该执行以下步骤：

1.  创建对应于电话键盘的字母到数字的**映射**
2.  循环遍历输入字符串的每个字符：
    1.  如果它是一个数字（整数），则在字母>数字映射中查找它，打印字符。
    2.  如果是字母，则查找同一张表，并打印相应的数字。
    3.  如果它不符合这两个条件，则打印一条错误消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T00:56:50.897

您可以创建一个字典，将所有可能的输入字符映射到您想要的输出。输入后，您根据字典替换字符。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T01:04:45.143

这应该工作

```
 Dictionary<string, int> dict = new Dictionary<string, int>();
        dict.Add("ABC", 2);
        dict.Add("CDE", 3);
        dict.Add("FGH", 4);
        dict.Add("JKL", 5);

        string Numbers = "BDJ";
        string myints = "";
        foreach (char c in Numbers)
            myints += dict.FirstOrDefault(X => X.Key.Contains(c)).Value.ToString();
//the output : "235" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-16T02:07:47.757

真的很抱歉没有对此做出回应或选择正确的答案，我最终自己想通了。我遇到这么多麻烦的原因是因为我认为我应该为 1(800)384-2347 创建多个输出，并将最后 4 个数字转换为可能有意义的各种字母。但这只是一个简单的案例陈述。

# arrays - 生成一个新变量，平均 R 中一组列的行

> ID：11837891
> 
> 赞同：2
> 
> 时间：2012-08-07T00:49:55.330
> 
> 标签：arrays, r

我是 R 新手。我正在使用一个比较面板数据集，其中一个关键变量是时间的横截面，因此我必须对该时间段内的所有变量进行平均。

数据的格式如下：行是国家观察，列是可变年份。

我已经构建了这个例子：

```
cname<- c("ARGENTINA", "BOLIVIA", "CHILE", "CHINA", "ECUADOR", "EGYPT")
gdp2003<- c(1.5, 2.3, 5.2, 12, 2.3, 3.3)
gdp2004<- c(1.7, 2.2, 4.7, 13.3, 1.7, 1.5)
corrupt2003<- c(5.1, 6.7, 3.4, 5.5, 4.5, 8.7)
corrupt2004<- c(4.5, 5.4, 2.4, 4.5, 5.4, 8.9)
df<- data.frame(cbind(cname, gdp2003, gdp2004, corrupt2003, corrupt2004))
df 
```

生成此输出：

```
 cname gdp2003 gdp2004 corrupt2003 corrupt2004
1 ARGENTINA     1.5     1.7         5.1         4.5
2   BOLIVIA     2.3     2.2         6.7         5.4
3     CHILE     5.2     4.7         3.4         2.4
4     CHINA      12    13.3         5.5         4.5
5   ECUADOR     2.3     1.7         4.5         5.4
6     EGYPT     3.3     1.5         8.7         8.9 
```

我想创建一个函数，可以按国家 obs 对列变量进行平均，如下所示：

```
 cname gdp2003 gdp2004 corrupt2003 corrupt2004 new.col.gdp new.col.corrupt
1 ARGENTINA     1.5     1.7         5.1         4.5         1.6             4.8
2   BOLIVIA     2.3     2.2         6.7         5.4        2.25            6.05
3     CHILE     5.2     4.7         3.4         2.4        4.95             2.9
4     CHINA      12    13.3         5.5         4.5       12.65               5
5   ECUADOR     2.3     1.7         4.5         5.4           2            4.95
6     EGYPT     3.3     1.5         8.7         8.9         2.4             8.8 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T01:58:01.983

First you need to change the command creating the data frame. By using cbind() you converted all of your numeric columns to text (to match the cname column which is text. Then R converted those text columns to factors when you made the data.frame. Also change your data.frame name to DF to avoid any conflicts with function df():

```
DF<- data.frame(cname, gdp2003, gdp2004, corrupt2003, corrupt2004)
vars <-c("gdp","corrupt")
new.cols <- sapply(vars, function(i) rowMeans(DF[, grepl(i, colnames(DF))]))
colnames(new.cols) <- paste0(colnames(new.cols), ".mean")
DF <- data.frame(DF, new.cols)
DF 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T01:33:44.110

您可以只`rowMeans`在选择列上使用

```
df$new.col.gdp <- rowMeans(df[,2:3])
df$new.col.corrupt <- rowMeans(df[,3:4]) 
```

现在，假设您并不真正了解您想要的所有列的编号，但您碰巧知道它们都将包含名称中常见的内容。假设它是'gdp'。你可以使用类似的东西。

```
selectColumns <- grep('gdp', names(df))
df$new.col.gdp <- rowMeans(df[,selectColumns]) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-07T10:09:49.240

虽然到目前为止提供的解决方案肯定会奏效，但我建议以不同的方式构建您的数据。您在这里组合数据和字段名称：与其拥有一个名为“gdp2003”的字段，您实际上应该只拥有一个名为“gdp”的字段并拥有另一个名为“year”的字段，然后记录 gdp 的年份是 2003 年。有关此方法的更多信息，我强烈建议阅读 Hadley Wickham 的论文[Tidy Data](http://vita.had.co.nz/papers/tidy-data.html "整齐的数据")。

以下是如何修改以这种方式设置数据的方法：

```
df <- data.frame(country=cname, year=2003, gdp=gdp2003,
                 corrupt=corrupt2003)
df <- rbind(df, data.frame(country=cname, year=2004,
                 gdp=gdp2004, corrupt=corrupt2004)) 
```

您的数据框现在应该如下所示：

```
 country year  gdp corrupt
1  ARGENTINA 2003  1.5     5.1
2    BOLIVIA 2003  2.3     6.7
3      CHILE 2003  5.2     3.4
4      CHINA 2003 12.0     5.5
5    ECUADOR 2003  2.3     4.5
6      EGYPT 2003  3.3     8.7
7  ARGENTINA 2004  1.7     4.5
8    BOLIVIA 2004  2.2     5.4
9      CHILE 2004  4.7     2.4
10     CHINA 2004 13.3     4.5
11   ECUADOR 2004  1.7     5.4
12     EGYPT 2004  1.5     8.9 
```

在这种形式中，您会发现以后添加数据要容易得多，并且仍然使用您的代码来计算平均值。一种方法是使用`by`：

```
by(df[,-(1:2)], df$country, colMeans) 
```

这将为您提供平均值列表：

```
df$country: ARGENTINA
    gdp corrupt 
    1.6     4.8 
------------------------------------------------------------ 
df$country: BOLIVIA
    gdp corrupt 
   2.25    6.05 

[etc] 
```

你可以把它变成一个更好的表，如下所示：

```
t(simplify2array(by(df[,-(1:2)], df$country, colMeans)))

            gdp corrupt
ARGENTINA  1.60    4.80
BOLIVIA    2.25    6.05
CHILE      4.95    2.90
CHINA     12.65    5.00
ECUADOR    2.00    4.95
EGYPT      2.40    8.80 
```

要在处理整洁数据时获得更大的灵活性，请查看该`plyr`软件包。

```
ddply(df, .(country), summarise, gdp=mean(gdp), corrupt=mean(corrupt)) 
```

如果您想要平均值和原始结果（例如，如果您想计算每年的平均值差异）：

```
ddply(df, .(country), transform, gdp.m=mean(gdp), corrupt.m=mean(corrupt))

      country year  gdp corrupt gdp.m corrupt.m
1  ARGENTINA 2003  1.5     5.1  1.60      4.80
2  ARGENTINA 2004  1.7     4.5  1.60      4.80
3    BOLIVIA 2003  2.3     6.7  2.25      6.05
4    BOLIVIA 2004  2.2     5.4  2.25      6.05
5      CHILE 2003  5.2     3.4  4.95      2.90
6      CHILE 2004  4.7     2.4  4.95      2.90
7      CHINA 2003 12.0     5.5 12.65      5.00
8      CHINA 2004 13.3     4.5 12.65      5.00
9    ECUADOR 2003  2.3     4.5  2.00      4.95
10   ECUADOR 2004  1.7     5.4  2.00      4.95
11     EGYPT 2003  3.3     8.7  2.40      8.80
12     EGYPT 2004  1.5     8.9  2.40      8.80 
```

# c# - 如何在 Windows 窗体 c# 中加载网页

> ID：11837892
> 
> 赞同：1
> 
> 时间：2012-08-07T00:49:56.813
> 
> 标签：c#, windows, forms, load, webpage

我只想加载一个网页，我不想打开它。

我想在进度条中显示页面加载过程。

当页面加载完成时，我想显示一条消息：“页面加载完成”。

我使用了这段代码，但它打开了浏览器：

System.Diagnostics.Process.Start("http://google.com");

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T01:03:52.930

您可以在表单上使用 Web 浏览器控件。

请参阅以下示例：

[C# 代码项目中的 Web 浏览器](http://www.codeproject.com/Articles/60179/Web-Browser-in-C)

[WebBrowser.ProgressChanged 事件 MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.progresschanged)

[使用 c# SO 在 Windows 应用程序项目中的 Web 浏览器控件的进度条](https://stackoverflow.com/questions/3386135/progress-bar-for-a-web-browser-control-in-windows-application-project-using-c-sh)

[C# Winforms：使用带有 Web 浏览器控件 Wordpress 的进度条](http://hashfactor.wordpress.com/2009/03/31/c-winforms-using-a-progress-bar-with-web-browser-control/)

# installation - 检查注册表项是否存在总是失败

> ID：11837895
> 
> 赞同：0
> 
> 时间：2012-08-07T00:50:08.830
> 
> 标签：installation, nsis

我正在尝试确定是否存在注册表项。我正在使用某人制作的宏，但它没有正确识别出存在注册表项

它说某个键实际上不存在。我是否错误地使用了这个[宏](http://nsis.sourceforge.net/Check_for_a_Registry_Key)？

我的代码，注册表项的路径是正确的：

```
!insertmacro IfKeyExists "HKLM" "Software\Microsoft\Windows\CurrentVersion\Uninstall\${COMPANYNAME}\${APPNAME}" "Version"
Pop $R0
MessageBox MB_OK "Exists: $R0" # always is zero when shd be 1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T01:05:05.847

`ReadRegStr`您可以通过对密钥（例如）发出读取操作来更简单地解决此问题，然后使用 Logiclib 检查是否发生任何错误。从功能上讲，不存在的密钥等同于您无法读取的密钥...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T06:20:57.063

确保您谈论的是正确的密钥（意味着您需要注意 WOW64 分离和注册表虚拟化）使用[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)监控安装程序...

# haskell - /bin/sh: 1: ./respondPalindromes: not found - 这是什么意思？

> ID：11837899
> 
> 赞同：0
> 
> 时间：2012-08-07T00:50:54.150
> 
> 标签：haskell, emacs, haskell-platform, haskell-mode

我能够在respondPalindromes.hs文件中的终端中运行下面的代码，但无法在emacs中测试相同的代码。

> 响应回文= unlines 。map (\xs -> if isPalindrome xs then "palindrome" else "not a palindrome") 。isPalindrome
> xs = xs == reverse xs
> main = 交互的行

以下是终端详细信息：

> optimight@optimight:~$ cat words.txt | runhaskell respondPalindromes.hs
> 不是回文
> 回文
> 回文回文
> 回文

下面是 Emacs haskell 模式的详细信息：

> *Main> :load "/home/optimight/respondPalindromes.hs"
> [1 of 1] 编译 Main (/home/optimight/respondPalindromes.hs, 解释)
> 好的，模块已加载：Main。
> *主要> :! 猫话.txt | ./respondPalindromes.hs
> /bin/sh: 1: ./respondPalindromes.hs: Permission denied
> *Main> :! 猫话.txt | ./respondPalindromes
> /bin/sh: 1: ./respondPalindromes: 未找到
> *Main>

在迪特里希·埃普的回答之后编辑：

> *Main> !: cat words.txt | runhaskell respondPalindromes.hs
> :12:1: 解析输入错误'!:'
> 
> *Main> cat words.txt | runhaskell respondPalindromes.hs
> ：13:15：输入“|”解析错误
> *主要>

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T01:20:48.913

在常规终端窗口中，运行以下命令：

```
cat words.txt | runhaskell respondPalindromes.hs 
```

但在 Haskell 窗口中，您运行以下 shell 命令：

```
cat words.txt | ./respondPalindromes.hs 
```

如果第一个命令工作正常，为什么要运行不同的命令？

这些只是普通的 shell 命令。如果您尚未设置`respondPalindromes.hs`为可执行文件，则它不会作为可执行文件运行，您必须使用`runhaskell`它才能执行它。

**此外，**如果您以这种方式运行程序（通过从 Haskell 交互式 shell 中执行 shell 命令），那么使用花哨的 Haskell shell 毫无意义。您还不如使用普通的外壳。

相反，您可能希望完全避免使用 shell，例如：

```
readFile "words.txt" >>= respondPalindromes >>= putStr 
```

Haskell 中的`>>=`运算符有点像`|`外壳中的管道。

**总结：**该`:!`命令执行的是一个普通的shell命令，与Haskell没有任何关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T00:53:45.690

我不知道`haskell`，但在命令行上你正在执行`runhaskell respondPalindromes.hs`，但在里面`emacs`你正在运行`./respondPalindromes.hs`。

很确定这就是问题所在。

# oracle - 将 Oracle Warehouse Builder 与最新版本的 Oracle 结合使用

> ID：11837901
> 
> 赞同：1
> 
> 时间：2012-08-07T00:51:12.857
> 
> 标签：oracle, oracle11g

Oracle Warehouse Builder 11.1 的文档表明它可以与 Oracle 11.1 及更早版本一起使用。但是，我们正在处理多个数据库，其中一个是 Oracle 11.2 - 我们无法升级我们的 Oracle 11.1 数据库（这是 OWB 11.1 的数据库）。

有没有人知道某种解决方法可以让我们将 OWB 11.1 与 Oracle 11.2 一起使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T10:25:11.717

根据[OWB 的 OTN 主页](http://www.oracle.com/technetwork/developer-tools/warehouse/overview/introduction/index.html)：

> “OWB 11gR2 预装了 Oracle Database 11gR2，可以与 Oracle Database 10gR2 和 11gR1 一起安装和使用。”

因此，也许您想要的解决方案是让 11gR2 数据库成为您的 OWB 存储库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T16:44:44.693

我们的 DBA 发现，如果指向 11gR2 实例的数据库链接是在 OWB 之外创建的，然后导入到 OWB 中，而不是让 OWB 创建初始数据库链接，那么 OWB 的 11gR1 版本就能够读取我们的第 2 版数据库。

# ruby - 使错误显示条件消息？

> ID：11837902
> 
> 赞同：1
> 
> 时间：2012-08-07T00:51:16.603
> 
> 标签：ruby, ruby-on-rails-3, ruby-on-rails-3.1

我怎样才能让我的错误消息像这样有条件：

```
<% if object.errors.any? %>

  <% if object.errors.count = 1 %>
    Oops, an error was found.
  <% else %>
    Oops, <%= pluralize(object.errors.count, "errors") %> were found
  <% end %>

  <% object.errors.full_messages.each do |msg| %>
    <%= msg %>
  <% end %>

<% end %> 
```

我现在得到一个`undefined method count=`错误。正确的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T01:03:27.030

你在哪里

```
 <% if object.errors.count = 1 %> 
```

你需要有：

```
 <% if object.errors.count == 1 %> 
```

注意双等号。

# java - 如何提高 RandomAccessFile 的使用？

> ID：11837907
> 
> 赞同：2
> 
> 时间：2012-08-07T00:52:05.383
> 
> 标签：java, android

我一直在使用 a `RandomAccessFile`to **rw**数据。文件的大小可以从 5MB 到 200MB。该文件用作**循环缓冲区**。

我主要关心的是在读写之前不断寻找。

寻找之后会发生什么？部分文件数据是否立即缓冲到内存中？搜索后它甚至会做任何事情吗？

我想了解它是如何工作的，以及如何提高`RandomAccessFile`在不同位置使用 读写的性能。我只是觉得不断的寻找可能使用了太多的资源？

**避免不断寻找的可能解决方案？**

1.  实例化两个`RandomAccessFile`实例，一个用于读取，另一个用于写入。当然，这些将紧密同步。
2.  使用两个`FileChannels`. 当我需要读取缓冲区的尾部或缓冲区的头部时，甚至不确定如何防止指针移动。

# php - Magento：运输方式名称中的重复术语

> ID：11837910
> 
> 赞同：0
> 
> 时间：2012-08-07T00:52:19.777
> 
> 标签：php, magento

当我调用`$order->getShippingDescription()`时，返回的字符串包含使用 Paypal 和 Google Checkout 支付的订单的承运人的重复字词。返回字符串的一个示例是..

```
USPS - USPS - Priority 
```

或者

```
UPS - UPS Ground 
```

有人为什么这些条款只针对使用 Paypal 和 Google Checkout 支付的订单出现两次？

***更新：找到一个相关的线程。[http://www.magentocommerce.com/boards/viewthread/76265/#t213276](http://www.magentocommerce.com/boards/viewthread/76265/#t213276)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T07:38:56.350

尝试寻找相反的方法并查看这些方法在代码中的位置

```
setShippingDescription(); 
```

通常是标题、名称、标签或类似的东西

# cordova - Phonegap XML 读取

> ID：11837911
> 
> 赞同：0
> 
> 时间：2012-08-07T00:52:24.463
> 
> 标签：cordova, xml-parsing

是否可以给电话间隙一个指向 XML 提要的链接，然后将其放入 HTML 本身？

我知道过去在连接到在线数据源的 iphone 应用程序方面存在问题......但想知道这是否还会导致问题？

感谢您的见解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T01:03:38.780

是的，这是可能的。您可以编写读取 XML 提要并写入 div 的 Javascript 代码。如果您可以在桌面浏览器中运行的本地 HTML5 文件中执行此操作，那么您应该能够执行此操作，那么我不知道有任何 PhoneGap 限制会禁用它。

# php - 我如何定义mysql的空返回？

> ID：11837913
> 
> 赞同：-1
> 
> 时间：2012-08-07T00:52:30.853
> 
> 标签：php, mysql

我有一个这样的变量；

```
$x=mysql_query("SELECT uye,yorum,tarih FROM bahisyorum WHERE bahisid='$bahisid'"); 
```

如果此 mysql 查询返回零结果，我想显示一条错误消息。但如果它返回结果，我想展示它们。

我怎样才能做到这一点？我尝试了 isset 和 empty 但没有奏效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T00:54:25.207

使用**[mysql_num_rows](http://php.net/manual/en/function.mysql-num-rows.php)**命令：

```
if (mysql_num_rows($x)==0) {
    //Show Error Message
}
else {
    //Perform actions
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T00:55:17.237

引用[参考页面](http://php.net/manual/en/function.mysql-query.php)：

> 使用 mysql_num_rows() 找出 SELECT 语句返回了多少行

# php - 在 /home/content/20/9628620/html/home.php 第 59 行 errno 1064 中为 foreach() 提供的参数无效

> ID：11837914
> 
> 赞同：-1
> 
> 时间：2012-08-07T00:52:46.217
> 
> 标签：php, oop, mysqli, prepared-statement

我一直在尝试为我的 mysqli 查询创建一个动态类，因为我很讨厌一直输入它们。在尝试解析页面上返回的数据之前，我已经足够让它不会抛出任何错误。当我尝试在页面上输出我的查询时，会抛出上述错误。我把我的旧代码留在那里，试图展示我在做什么。

主页.php

```
<?php
                require('config/dbconfig.php');
                include('classes/mysqli.class.php');
                $mysqli = new DATABASE($db_host,$db_user,$db_pass,$db_name);
                $results = $mysqli->select('id,title,category,desc,postdate,author','news',null,null,'orderByLimit','id','DESC',4);
                /*
                $query = "SELECT * FROM news ORDER BY id DESC LIMIT 4";
                if ($stmt = $mysqli->prepare($query)) {
                    // execute statement
                    $stmt->execute();

                    // bind result variables
                    $stmt->bind_result($idn, $titlen, $categoryn, $descn, $postdaten, $authorn);

                    // fetch values
                    while ($stmt->fetch()) {
                    */
                        //echo 'id: '. $id .' title: '. $title;
                        echo "<table border='0'>";
                        foreach($results as $row)
                        {

                        $shortDescLengthn = strlen($row['desc']);
                        if ($shortDescLengthn > 106) {
                            $sDCutn = 106 - $shortDescLengthn;
                            $shortDescn = substr($row['desc'], 0, $sDCutn);
                        } else {
                            $shortDescn = $row['desc'];
                        }
                        echo "<h1>" . $row['title'] . "</h1>"; 
                        echo "<tr><td>$shortDescn...</td></tr>"; 
                        echo '<tr><td><a href="javascript:void(0);" onclick="' 
                        . 'readMore(' . $row['id'] . ',' . htmlspecialchars(json_encode($row['title'])) . ',' 
                        . htmlspecialchars(json_encode($row['category'])) . ',' 
                        . htmlspecialchars(json_encode($row['desc'])) . ',' . htmlspecialchars(json_encode($row['postdate'])) . ',' 
                        . htmlspecialchars(json_encode($row['author'])) . ')">Read More</a></td></tr>'; 
                        echo "<tr><td>Written by: " . $row['author'] . "</td></tr>"; 
                        echo '<tr><td><img src="images/hardcore-games-newsbar-border.png" width="468px" /></td></tr>'; 
                    }
                    echo "</table><br />";

                    /*
                    //close statement
                    $stmt->close();
                }

                //close connection
                $mysqli->close();
                */
            ?> 
```

mysqli.class.php

```
<?php
class DATABASE
{
private $db_host;
private $db_user;
private $db_pass;
private $db_name;
private $connection;
private $paramaters = array();
private $results = array();
private $numrows;

public function __construct($db_host, $db_user, $db_pass, $db_name)
{
    $this->host = $db_host;
    $this->user = $db_user;
    $this->pass = $db_pass;
    $this->name = $db_name;
    $this->mysqli = new mysqli($this->host, $this->user, $this->pass, $this->name) or die('There was a problem connecting to the database!');
}
public function __destruct()
{
    $mysqli->close();
}
public function select($fields, $from, $where, $whereVal, $type, $orderByVal, $ASDESC, $limitVal)
{
    if ($whereVal != null)
    {
        if (is_int($whereVal))
        {
            $bindVal = 'i';
        } elseif (is_string($whereVal)){
            $bindVal = 's';
        } else {
            return 'Invalid variable type!';
        }
    }       if (count($whereVal) > 1)
    {
        $y = array();
        foreach($whereVal as $type => $brand)
        {
            $y[$type] = $brand;
        }
    } else 
    {
        $y = $bindVal;
    }
    switch($type)
    {
        case "regular":
            $queryPre = "SELECT " . $fields;
            $querySuff = " WHERE " . $where . " =  ?";
            break;
        case "orderByLimit":
            $queryPre = "SELECT " . $fields;
            $querySuff = " ORDER BY " . $orderByVal . " " . $ASDESC . " LIMIT " . $limitVal;
            break;
    }
    $stmt = $this->mysqli->prepare($queryPre . " FROM " . $from . " " . $querySuff) or die('There was a problem preparing the Query!');

    //bind parameters for markers
    if($y&&$queryPre&&$querySuff)
    { 
        $bind_names[] = $y; 
        for ($i=0; $i<count($whereVal);$i++)  
        { 
            $bind_name = 'bind' . $i; 
            $$bind_name = $whereVal[$i]; 
            $bind_names[] = &$$bind_name; 
        } 
        $return = call_user_func_array(array($stmt,'bind_param'),$bind_names); 
    }
    $stmt->execute();
    $meta = $stmt->result_metadata();

    while ($field = $meta->fetch_field())
    {
        $parameters[] = &$row[$field->name];
    }
    call_user_func_array(array($stmt, 'bind_result'), $parameters);

    while ($stmt->fetch()) 
    {
        $x = array();
        foreach($row as $key => $val)
        {
            $x[$key] = $val;
        }
        $results[] = $x;
    }
    $stmt->close();
    return $results;
}
/*
 * Function Insert
 * @param into
 * @param values
 * @returns boolean
*/
public function insert($into, $values)
{
    $query = "INSERT INTO " . $into . " VALUES(" . $values . ")";

    $this->last_query = $query;

    if($this->mysqli->query($query))
    {
        return true;
    } else {
        return false;
    }

}

/*
 * Function Delete
 * @param from
 * @param where
 * @returns boolean
*/
public function delete($from, $where)
{
    $query = "DELETE FROM " . $from . " WHERE " . $where;

    $this->last_query = $query;

    if($this->mysqli->query($query))
    {
        return true;
    } else {
        return false;
    }
}
}
?> 
```

同样，我至少在加载 home.php 时没有收到任何错误，除了这个问题的标题中的错误。如果我删除 foreach 那么它根本不会返回任何东西，但没有错误。如果我忘记了什么，请告诉我。我和我儿子病得很重，我真的很累。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T01:06:20.930

您的 foreach() 不起作用，因为没有匹配的数据，或者您的查询格式不正确。

在后者的情况下，将您的 sql 语句构建为 var 并将其作为调试形式回显到屏幕上：例如：

```
$sql = $queryPre . " FROM " . $from . " " . $querySuff;

echo $sql; 
```

将其粘贴到您的数据库中，看看它看起来是否格式正确，是否会产生错误，是否有匹配的数据？（一个积极的结果？）仔细查看错误消息。

# sql - 修复达到州长限制的 soql 查询

> ID：11837915
> 
> 赞同：1
> 
> 时间：2012-08-07T00:52:48.703
> 
> 标签：sql, salesforce, apex-code, soql

我有 500 个地区要耕耘，还有 50 万个联系人。我尝试了一个 group by，但无法正常工作。如何避免遇到 soql 查询和返回行数的调控器限制？

```
public with sharing class Test {
  public static void  test() {
    List <_Territory__c> terrsWithAee = [select id,name, Aee_Territory__c from _Territory__c where Aee_Territory__c != null];
    String s = ' t.test Terrs with Aee = ' + terrsWithAee.size() + '\n';

    for (_Territory__c t :terrsWithAee) {
      Integer err = [select count() from contact where (Contact_AML_Territory__c  = :t.id AND BDW_AML_Territory__c != :t.Aee_Territory__c ) OR (Contact_ChoicePlus_Territory__c  = :t.id AND BDW_CP_Territory__c != :t.Aee_Territory__c)]; 

      s = 'For   Terr '+ t.id  + '  errors=  ' + err + ' terr name = \n'  ;
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T02:09:38.417

只有两种方法可以查询这 500,000 个联系人行。

1.  将此设置为区域上的批处理作业，并将批处理大小设置为 1 或其他一些较小的数字，以便您一次只查看几个区域的联系人。

2.  使用[@readonly 注释](http://www.salesforce.com/us/developer/docs/apexcode/index_Left.htm#CSHID=apex_classes_annotation_ReadOnly.htm%7CStartTopic=Content/apex_classes_annotation_ReadOnly.htm%7CSkinName=webhelp)。这将消除查询行限制，但您将无法执行任何 DML 语句或执行任何其他会影响数据库的操作。

# ios - 为什么导入时出现 GDataXML 错误

> ID：11837919
> 
> 赞同：1
> 
> 时间：2012-08-07T00:53:20.870
> 
> 标签：ios, xml, gdataxml

任何机构都可以帮助我！我想使用 GDataXML，但是当我将 GData 文件复制到我的项目时，编译器给我错误“找不到文件”这一行：

```
#import <libxml/tree.h> 
```

我认为这与使用 GData 的说明有关，因为在上面的评论中它说：

```
// libxml includes require that the target Header Search Paths contain
//
//   /usr/include/libxml2
//
// and Other Linker Flags contain
//
//   -lxml2 
```

但我不明白我该怎么办，请你帮帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T20:53:37.323

嘿伙计们，这对于我发现它用于使用的初学者来说是非常重要的一步

```
#import <libxml/tree.h> 
```

这是显示如何使用它的链接：http: [//iphone-bitcode.blogspot.com/2011/06/gdataxml-is-googles-xml-processing.html](http://iphone-bitcode.blogspot.com/2011/06/gdataxml-is-googles-xml-processing.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-08-23T16:24:38.110

在以后的 XCode 版本（6.x、7.x 等）中，将其添加到标题搜索路径：

```
$(SDKROOT)/usr/include/libxml2 
```

我认为较新的 XCode 中的一个问题是 SDKROOT 周围缺少括号。

（注意：要找到“标题搜索路径”，请转到项目编辑器：构建设置：搜索路径：标题搜索路径。）

# objective-c - panGesture 发布后将 UIView 捕捉到设定位置

> ID：11837921
> 
> 赞同：1
> 
> 时间：2012-08-07T00:53:28.810
> 
> 标签：objective-c, uiview, center, uipangesturerecognizer, xcode4.4

我目前正在使用**XCode**，但**没有使用 Objective-C / Cocoa Touch 等的经验，**所以如果这是一个非常初级的问题，请耐心等待。我只问你们，因为我几天来一直在尝试用谷歌搜索答案，并且厌倦了死胡同。

**我正在尝试创建一个水平平移菜单。**

我目前将 3`UILabels`放在一个主`UIView`对象中，该对象附加到`UIPanGestureRecognizer`.

我已经使用了一个handlePan 方法来根据用户的平移手势接收和翻译***menuview对象，但是我需要在** **PanGesture**被释放时找到它的中心坐标来计算将元素向后/向前捕捉到的位置。`UIView``UIView`**`UIView`**

 **```
- (IBAction)handlePan:(UIPanGestureRecognizer *)recognizer {
CGPoint translation = [recognizer translationInView:self.view];
recognizer.view.center = CGPointMake(recognizer.view.center.x + translation.x, 150);
[recognizer setTranslation:CGPointMake(0, 0) inView:self.view];

if(recognizer.state == UIGestureRecognizerStateEnded)
{
    if(recognizer.view.center.x >= 576);{
        [UIView beginAnimations:nil context:nil];
        [UIView setAnimationDuration:0.5];
        menuview.transform = CGAffineTransformMakeTranslation((764 - menuview.center.x), 0);
        [UIView commitAnimations];

    }

    if(recognizer.view.center.x && menuview.center.x >= 264);{
        [UIView beginAnimations:nil context:nil];
        [UIView setAnimationDuration:0.5];
        menuview.transform = CGAffineTransformMakeTranslation((406 - menuview.center.x), 0);
        [UIView commitAnimations];

    }

    if(recognizer.view.center.x < 264);{
        [UIView beginAnimations:nil context:nil];
        [UIView setAnimationDuration:0.5];
        menuview.transform = CGAffineTransformMakeTranslation((122 - menuview.center.x), 0);
        [UIView commitAnimations];

    }

} 
```

}

你看我试图捕捉到 x 轴上的三个点之一，这取决于`UIView`用户释放`PanGesture`.

目前，它的行为就好像它忽略了“ **recognizer.view.center.x** ” if 语句，因为无论它在哪里发布，它都会捕捉到**x=122 (122 - menuview.center.x)**。

我已经尝试了这些 if 语句：

```
if(menuview.center.x >= 576);{... 
```

等，但这也失败了。

`UIViews`当用户释放他们的 CURRENT 位置时，我需要在这些 if 语句中添加什么来创建操作`PanGesture`？

谢谢，

克里斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T01:14:56.527

这是我用的，希望对你有帮助：

。H

```
#import <QuartzCore/QuartzCore.h> 
```

delcare 这两个花车

```
float firstX;
float firstY; 
```

.m

```
-(void)moveHorizontallyAndVertically:(id)sender {
[[[(UITapGestureRecognizer*)sender view] layer] removeAllAnimations];

//  [self.view bringSubviewToFront:[(UIPanGestureRecognizer*)sender view]];
CGPoint translatedPoint = [(UIPanGestureRecognizer*)sender translationInView:self.view];
if([(UIPanGestureRecognizer*)sender state] == UIGestureRecognizerStateBegan) {
    firstX = [myView center].x;
    firstY = [myView center].y;

}

translatedPoint = CGPointMake(firstX+translatedPoint.x, firstY+translatedPoint.y);

[myView setCenter:translatedPoint];

if([(UIPanGestureRecognizer*)sender state] == UIGestureRecognizerStateEnded) {
    CGFloat finalX = translatedPoint.x + (0.0*[(UIPanGestureRecognizer*)sender velocityInView:self.view].x);
    CGFloat finalY = translatedPoint.y + (0.0*[(UIPanGestureRecognizer*)sender velocityInView:self.view].y);
    if(finalX < 0) {
        finalX = 0;
    }
    else if(finalX > 320) {
        finalX = 320;
    }
    if(finalY < 0) {
        finalY = 0;
    }
    else if(finalY > 480) {
        finalY = 480;
    }
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:0.3];
    [UIView setAnimationCurve:UIViewAnimationCurveEaseOut];
    [myView setCenter:CGPointMake(finalX, finalY)];
    [UIView commitAnimations];
} 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-20T16:05:11.743

这一切都可以使用 Interface Builder 和 Autolayout 来实现。这是我用来执行此操作的代码：

```
@property (weak,nonatomic) IBOutlet NSLayoutConstraint *buttonXConstraint;  
@property (weak,nonatomic) IBOutlet NSLayoutConstraint *buttonYConstraint; 
```

然后将它们`IBOutlets`连接到 Interface Builder 中的水平约束（X 位置）和垂直约束（Y 位置）。确保约束连接到基础视图，而不是最近的视图。

连接一个平移手势，然后使用以下代码拖动您的对象：

```
- (IBAction)panPlayButton:(UIPanGestureRecognizer *)sender
{
  if(sender.state == UIGestureRecognizerStateBegan){

  } else if(sender.state == UIGestureRecognizerStateChanged){
     CGPoint translation = [sender translationInView:self.view];

     //Update the constraint's constant
     self.buttonXConstraint.constant += translation.x;
     self.buttonYConstraint.constant += translation.y;

     // Assign the frame's position only for checking it's fully on the screen
     CGRect recognizerFrame = sender.view.frame;
     recognizerFrame.origin.x = self.buttonXConstraint.constant;
     recognizerFrame.origin.y = self.buttonYConstraint.constant;

     // Check if UIImageView is completely inside its superView
     if(!CGRectContainsRect(self.view.bounds, recognizerFrame)) {
         if (self.buttonYConstraint.constant < CGRectGetMinY(self.view.bounds)) {
             self.buttonYConstraint.constant = 0;
         } else if (self.buttonYConstraint.constant + CGRectGetHeight(recognizerFrame) > CGRectGetHeight(self.view.bounds)) {
             self.buttonYConstraint.constant = CGRectGetHeight(self.view.bounds) - CGRectGetHeight(recognizerFrame);
         }

         if (self.buttonXConstraint.constant < CGRectGetMinX(self.view.bounds)) {
             self.buttonXConstraint.constant = 0;
         } else if (self.buttonXConstraint.constant + CGRectGetWidth(recognizerFrame) > CGRectGetWidth(self.view.bounds)) {
             self.buttonXConstraint.constant = CGRectGetWidth(self.view.bounds) - CGRectGetWidth(recognizerFrame);
         }
     }

     //Layout the View
     [self.view layoutIfNeeded];
 } else if(sender.state == UIGestureRecognizerStateEnded){ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-29T05:33:17.377

我也通过在动画块中简单地使用 CGRectMake 设置一个新帧来做到这一点。也在 UIGestureRecognizerStateEnded 中完成

```
[UIView animateWithDuration:0.1f
                      delay:0.0f
                    options:UIViewAnimationOptionCurveEaseInOut
                 animations:^{ 
                               NSLog(@"before: %@",NSStringFromCGPoint(piece.center));
                               piece.frame = CGRectMake(targImgView.frame.origin.x,
                               targImgView.frame.origin.y,                                                                                      
                               targImgView.frame.size.width,
                               targImgView.frame.size.height);                                                                      
                               NSLog(@"after: %@",NSStringFromCGPoint(piece.center));
                              } 
                  completion:nil]; 
```**

# sql - 如何从单行创建多行 - 规范化表

> ID：11837928
> 
> 赞同：2
> 
> 时间：2012-08-07T00:54:49.837
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我对 SQL 很陌生，并试图解决这个问题：

我有一个名为 BUDGET 的表，该表在一年中的每个月都有 12 列，显示该月的预算余额。所以表格看起来像这样：

```
[Department]  [Year]  [Month1] [Month2] .... [Month12]  
ABCD           2010   $5000     $5500   .....  $4000
ABCD           2011   $6000     $6500   .....  $3000 
```

我想要做的是规范化这个表并将每一行分成 12 行，每一行都有一个以下格式的日期字段。我还想要一个显示当月值的 [Balance] 列。因此，标准化表将如下所示：

```
[Department]  [Date]     [Balance] 
ABCD          20100101     $5000   
ABCD          20100201     $5500 
ABCD          20100301     .....
ABCD          .......      ...... 
```

我尝试在同一张表上使用 CROSS JOIN 但失败了。我也尝试使用 while 循环，但也失败了。任何形式的帮助表示赞赏。谢谢！

编辑：我正在使用 SQL Server 2008

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-07T01:29:07.090

只是为了好玩，这里有一个 CROSS APPLY 解决方案：

```
SELECT
   B.Department,
   DateAdd(month, (B.Year - 1900) * 12 + M.Mo - 1, 0) [Date],
   M.Balance
FROM
   dbo.Budget B
   CROSS APPLY (
      VALUES
      (1, Month1), (2, Month2), (3, Month3), (4, Month4), (5, Month5), (6, Month6),
      (7, Month7), (8, Month8), (9, Month9), (10, Month10), (11, Month11), (12, Month12)
   ) M (Mo, Balance); 
```

这与@Aaron Bertrand 的 UNPIVOT 并没有什么不同，没有使用 UNPIVOT。

如果您必须将日期作为字符串，则将字符串放入 CROSS APPLY 中，然后将`('01', Month1)`SELECT 更改为`Convert(char(4), B.Year) + M.Mo`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-07T01:10:56.483

```
SELECT 
  Department, 
  [Date] = DATEADD(MONTH, CONVERT(INT, SUBSTRING([Month],6,2))-1, 
     DATEADD(YEAR, [Year]-1900, 0)), 
  Balance
FROM
  dbo.BUDGET AS b
  UNPIVOT 
  (
    Balance FOR [Month] IN 
    (
      Month1, Month2,  Month3,  Month4,
      Month5, Month6,  Month7,  Month8,
      Month9, Month10, Month11, Month12
    )
  ) AS y
ORDER BY Department, [Date]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T01:22:14.733

我就是这样做的。没必要全神贯注。

```
select department = b.department ,
       year       = b.year       ,
       month      = m.month      ,
       balance    = case m.month
                    when  1 then b.Month1
                    when  2 then b.Month2
                    when  3 then b.Month3
                    when  4 then b.Month4
                    when  5 then b.Month5
                    when  6 then b.Month6
                    when  7 then b.Month7
                    when  8 then b.Month8
                    when  9 then b.Month9
                    when 10 then b.Month10
                    when 11 then b.Month11
                    when 12 then b.Month12
                    else         null
                    end
from dbo.budget b
join (           select month =  1
       union all select month =  2
       union all select month =  3
       union all select month =  4
       union all select month =  5
       union all select month =  6
       union all select month =  7
       union all select month =  8
       union all select month =  9
       union all select month = 10
       union all select month = 11
       union all select month = 12
     ) m on 1 = 1  -- a dummy join: we want the cartesian product here so as to expand every row in budget into twelve, one per month of the year. 
```

# android - 膨胀类 android.widget.listview 时出错

> ID：11837932
> 
> 赞同：3
> 
> 时间：2012-08-07T00:55:39.117
> 
> 标签：android, listview, android-layout, inflate-exception

我查看了一堆其他人的问题和解释，但没有什么对我有用。我的程序的第一个活动是 ListActivity，它在扩展其 xml 文件时遇到了问题。LogCat 输出为：

```
08-01 08:36:17.800: E/AndroidRuntime(1935): FATAL EXCEPTION: main
08-01 08:36:17.800: E/AndroidRuntime(1935): java.lang.RuntimeException: Unable to start activity ComponentInfo{jamie.basketball.gui/jamie.basketball.gui.TeamDisplayActivity}: android.view.InflateException: Binary XML file line #15: Error inflating class android.widget.ListView
08-01 08:36:17.800: E/AndroidRuntime(1935):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at android.app.ActivityThread.access$1500(ActivityThread.java:117)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at android.os.Handler.dispatchMessage(Handler.java:99)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at android.os.Looper.loop(Looper.java:123)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at android.app.ActivityThread.main(ActivityThread.java:3683)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at java.lang.reflect.Method.invokeNative(Native Method)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at java.lang.reflect.Method.invoke(Method.java:507)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at dalvik.system.NativeStart.main(Native Method)
08-01 08:36:17.800: E/AndroidRuntime(1935): Caused by: android.view.InflateException: Binary XML file line #15: Error inflating class android.widget.ListView
08-01 08:36:17.800: E/AndroidRuntime(1935):     at android.view.LayoutInflater.createView(LayoutInflater.java:518)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at com.android.internal.policy.impl.PhoneLayoutInflater.onCreateView(PhoneLayoutInflater.java:56)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:568)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at android.view.LayoutInflater.rInflate(LayoutInflater.java:623)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at android.view.LayoutInflater.inflate(LayoutInflater.java:408)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at android.view.LayoutInflater.inflate(LayoutInflater.java:276)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:207)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at android.app.Activity.setContentView(Activity.java:1657)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at jamie.basketball.gui.TeamDisplayActivity.onCreate(TeamDisplayActivity.java:137)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
08-01 08:36:17.800: E/AndroidRuntime(1935):     ... 11 more
08-01 08:36:17.800: E/AndroidRuntime(1935): Caused by: java.lang.reflect.InvocationTargetException
08-01 08:36:17.800: E/AndroidRuntime(1935):     at java.lang.reflect.Constructor.constructNative(Native Method)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at java.lang.reflect.Constructor.newInstance(Constructor.java:415)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at android.view.LayoutInflater.createView(LayoutInflater.java:505)
08-01 08:36:17.800: E/AndroidRuntime(1935):     ... 22 more
08-01 08:36:17.800: E/AndroidRuntime(1935): Caused by: java.lang.NullPointerException
08-01 08:36:17.800: E/AndroidRuntime(1935):     at     android.content.res.AssetManager.getResourceTextArray(AssetManager.java:214)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at android.content.res.Resources.getTextArray(Resources.java:361)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at android.content.res.TypedArray.getTextArray(TypedArray.java:628)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at android.widget.ListView.<init>(ListView.java:168)
08-01 08:36:17.800: E/AndroidRuntime(1935):     at android.widget.ListView.<init>(ListView.java:159)
08-01 08:36:17.800: E/AndroidRuntime(1935):     ... 25 more 
```

我不完全确定发生了什么。我已经检查了 Android Manifest，第 15 行`<application`似乎不是问题。我的 XML 文件的第 15 行只是`<ListView`. 我将发布整个 XML 文件，以防其中似乎有其他问题。

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:tools="http://schemas.android.com/tools"
        android:layout_width="match_parent"
        android:layout_height="match_parent" >

        <TextView
            android:id="@+id/num_of_teams"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentTop="true"
            android:layout_centerHorizontal="true"
            android:text="@string/debug"
            android:textAppearance="?android:attr/textAppearanceLarge" />

        <ListView
            android:id="@+id/@android:id/list"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_below="@+id/num_of_teams"
            android:layout_marginTop="5dp"
            android:entries="@layout/team_list_entry" >

        </ListView>

        <Button
            android:id="@+id/delete_team"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_below="@+id/@android:id/list"
            android:layout_marginLeft="20dp"
            android:layout_marginTop="30dp"
            android:text="@string/delete_team" />

        <Button
            android:id="@+id/add_team"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="false"
            android:layout_alignParentTop="false"
            android:layout_below="@+id/@android:id/list"
            android:layout_marginLeft="50dp"
            android:layout_marginTop="30dp"
            android:layout_toRightOf="@id/delete_team"
            android:text="@string/add_team" />

    </RelativeLayout> 
```

此外，为了记录，引用 TeamDisplayActivity 第 137 行的堆栈跟踪只是`setContentView(R.layout.team_list_display)`. 任何帮助都会很棒，我真的不确定出了什么问题。提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T01:08:16.717

这条线看起来不正确：

```
 android:entries="@layout/team_list_entry" 
```

通常我认为它被指定为

```
 android:entries="@array/servers" etc. 
```

并尝试将 id 指定为：

```
android:id="@+id/list" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T01:06:37.270

你用`@+id/@android:id/list`

我认为它必须是`@+id/android:list`或`@+id/list`

你可以在这里看到：[https ://stackoverflow.com/a/4355644/617801](https://stackoverflow.com/a/4355644/617801)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-12T03:56:04.550

我有一个类似的问题，也许这对其他人有帮助。

我不小心`android:onClick="onClickExamplesMethod"`在 ListView 中设置了。删除它后它再次工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-14T11:53:37.173

android:id="@+id/@android:id/list" 将其更改为 android:id="@+id/list1" 。您的二进制膨胀异常问题将得到解决。并且永远不要尝试使用 android :id="@+id/list" 在 ListView 中。通过使用另一个选项，您可以创建您的 ListView，即 android:id="@id/android:list"。

# mysql - SELECT LAST_INSERT_ID - 不产生数值

> ID：11837942
> 
> 赞同：0
> 
> 时间：2012-08-07T00:57:32.717
> 
> 标签：mysql, sql, asp-classic

我试图从我的数据库中获取最后插入的 id 以在另一个查询中使用，但是......当我检查它是否是一个数值时，它失败了！

```
// my big insert query goes here //

Set rs = conn.Execute("SELECT LAST_INSERT_ID();")
member_id = rs(0)
rs.Close : Set rs = Nothing

If member_id <> "" AND IsNumeric(member_id) Then
    conn.Execute(" INSERT INTO members_reputation (member_id, awarded_for, awarded_when, awarded_what) " _
    & "VALUES ("&member_id&", 'Created an account', Now(), 1); ")
Else
    Response.Write member_id //testing
    Response.End // testing
End If 
```

如您所见，如果 IsNumeric 条件失败，我会将 member_id 写入屏幕（仅用于测试），它成功显示了正确的 ID，但显然它不是数字，因此下一个查询不会触发！

为什么是这样？围绕它的最佳解决方案是什么？

**更新**

好的，我使用 TRIM() 解决了这个问题，如下所示：

```
If Trim(member_id) <> "" AND IsNumeric(Trim(member_id)) Then 
```

这让我很高兴，因为它可以工作，但让我很难过知道这样一个简单的获取数字 ID 的过程失败了。向 SQL 询问整数 ID 怎么会产生空格？DB字段中显然没有空格，我的代码中也没有空格。如果有人有任何想法，我仍然希望得到答案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T01:01:25.227

mysql_insert_id 是获取上一次查询生成的ID。至于你的情况，在 mysql_insert_id 之前没有查询。您可以执行以返回 MAX(member_id) 代替。

# google-chrome-extension - 在图像加载之前更改chrome 扩展中的 SRC

> ID：11837944
> 
> 赞同：1
> 
> 时间：2012-08-07T00:57:36.717
> 
> 标签：google-chrome-extension

我想编写一个 Chrome 扩展程序，它将在加载图像之前更改 img 元素的 src= 值。

我有更改图像的代码，但它总是在 img 加载后执行。如何在加载图像之前更改 SRC 中的 url？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T01:36:10.427

你应该：

1.  确保`run_at`内容脚本的属性是`document start`.
2.  将您的图像重写代码放在[`beforeload`事件处理程序](https://developer.apple.com/library/safari/#documentation/Tools/Conceptual/SafariExtensionGuide/MessagesandProxies/MessagesandProxies.html#//apple_ref/doc/uid/TP40009977-CH14-SW9)中。

您的脚本应如下所示：

```
String.prototype.endsWith = function(str) {
    return this.substr(str.length*-1) === str;;
};

function doBeforeLoad(event) {
    // Check to see if its what you want to redirect
    // You can check against different things about the element, such as its type (tagName), id, class, whatever
    // Be aware that if your checking the src attribute and it was a relative path in the html then the src you recieve will be resolved....
    // so if the html was <img src="/bunyip.png"> and the base url is www.google.com then the event.srcElement.src will be www.google.com/bunyip.png
    // this is why I use the ends with...so you dont have to deal with things like http://www.google.com, https://www.gooogle.com, http://google.com 
    // We also check for a data attribute that we set, so we know its allready been redirected
    // we do this because if you redirect a source it will fire another beforeload event for its new url
    if (!event.srcElement.dataset['redirected'] && event.srcElement.tagName == "IMG" && event.srcElement.src.endsWith('/test.png')) {
        // If it is something we want to redirect then set a data attribute so we know its allready been changed
        // Set that attribute to it original src in case we need to know what it was later
        event.srcElement.dataset['redirected'] = event.srcElement.src;
        // Set the source to the new url you want the element to point to
        event.srcElement.src = "replacement.png";
    }
}

document.addEventListener('beforeload', doBeforeLoad, true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-28T10:00:30.600

如果您知道 url 模式，则可以使用 webRequest API- [http://developer.chrome.com/extensions/webRequest.html](http://developer.chrome.com/extensions/webRequest.html)来阻止和重定向图像调用。但是这不会改变 src，你可以稍后再做。这甚至会阻止对该图像源的 GET 调用。

最初来自 -[如何防止通过内容脚本从 <img> 加载？](https://stackoverflow.com/questions/19424070/how-can-i-prevent-loading-from-img-via-content-script)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T01:13:10.050

看看[避免 jQuery（预）加载图像](https://stackoverflow.com/questions/10599926/avoid-jquery-preloading-images)或[从字符串构造 DOM 树而不加载资源（特别是图像）](https://stackoverflow.com/questions/2302129/construct-a-dom-tree-from-a-string-without-loading-resources-specifically-image/2302157)。不久前我遇到了这个问题，我的解决方案基本上是相同的（用 'blah=' 替换 html 字符串中的 src 属性，然后添加我自己的 src）。正如链接中所说，如果您使用的是 jquery，请不要使用`$(html)`，因为它一解析就会获取图像。

# c# - 使用其他类的类字段

> ID：11837947
> 
> 赞同：4
> 
> 时间：2012-08-07T00:58:08.530
> 
> 标签：c#, oop, class

我对 C# 和 OOP 很陌生，所以请多多包涵。

我有两个具有不同名称空间的类：

```
namespace Class1

public class class1
{
 public double x;
 public double y;
}

...

namespace Class2

public class class2
{
 public double z = x + 5;
} 
```

我创建了一个名为 add 的项目，并有一个带有按钮的表单。该按钮将添加 x、y 和 z。我的问题是：

如何在 class2 中使用字段 x 以及如何在按钮单击事件下使用字段 x、y 和 z？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T01:05:09.390

您可能希望在其构造函数`class2`中包含一个实例：`class1`

```
public class class2
{
 private readonly class1 _c1;
 public class2(class1 c1) { _c1 = c1; }

 public double z = _c1.x + 5;
} 
```

至于如何在表单中通过按钮单击事件使用字段 x、y 和 z，您只需访问 class1 和 class2 实例上的公共字段 x、y 和 z：

```
protected void button_click(){
 class1 c1 = new class1();
 c1.x = 10;
 c1.y = 20;
 class2 c2 = new class2(c1);

 //do something with c1 and c2 now...
 Console.WriteLine("{0} {1} {2}", c1.x.ToString(), c1.y.ToString(), c2.z.ToString());
} 
```

如果我误解了您要执行的操作，请告诉我。希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T01:04:35.503

您不使用类字段（除非它们是静态的，但在您的情况下它们不是），而是使用对象字段。这是一个示例，说明如何实现您想要的。

```
public class1 {
  public double Radius;

  // Function to calculate the area
  public double Area(double Rad) {
    this.Radius = Rad;
    return Math.PI * Math.Pow(this.Radius, 2);
  }

}

public class2 {
  public double Depth;

  // Function to calculate the volume of a cylinder
  public double Volume(double Rad, double Dep) {
    this.Depth = Dep;

    // Create an instance of Class1 and use it to calculate the Volume
    var Obj1 = new class1();
    return Obj1.Area(Rad) * this.Depth;
  }
} 
```

如何在按钮单击事件中使用上述内容

```
// Let's calculate an Area from a Radius
double SomeRadius = 1.234;

MyObj1 = new class1();
double Area = MyObj1.Area(SomeRadius);

double StoredRadius = MyObj1.Radius; // This will give you back the Radius stored by MyObj1, which is the same you passed to Area() function

// Now let's calculate a Volume, using the Radius we indicated earlier and a Depth
double SomeDepth = 4.567;
MyObj2 = new class2();
double Volume = MyObj2.Volume(SomeRadius, SomeDepth);

double StoredDepth = MyObj2.Depth; // This will give you back the Depth stored by MyObj2, which is the same you passed to Volume() function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T08:20:23.633

这里的每个人都为您提供了访问字段的正确答案，但在面积和体积的情况下，您是在程序上解决问题，而不是 OO 方式。这是一个示例，向您展示如何访问内部字段，以及解决此类问题的 OO 方法：

```
public abstract class Shape
{
    public abstract double Area();
    public abstract double Perimeter();
}

public class Circle : Shape
{
    public double Radius;

    public override double Perimeter()
    {
        return 2 * Radius * Math.PI;
    }

    public override double Area()
    {
        return Radius * Radius * Math.PI;
    }
}

public class Square : Shape
{
    public double Side;

    public override double Perimeter()
    {
        return Side * 4;
    }

    public override double Area()
    {
        return Side * Side;
    }
}

public abstract class Solid
{
    public abstract double Volume();
}

public abstract class CircleBaseSolid : Solid
{
    protected Circle Base = new Circle();

    public double Radius
    {
        get { return Base.Radius; }
        set { Base.Radius = value; }
    }

    public double Height;
}

public class Cylinder : CircleBaseSolid
{
    public override double Volume()
    {
        return Base.Area() * Height;
    }
}

public class Cone : CircleBaseSolid
{
    public override double Volume()
    {
        return Base.Area() * Height / 3;
    }
}

public abstract class SquareBaseSolid : Solid
{
    protected Square Base = new Square();

    public double Side
    {
        get { return Base.Side; }
        set { Base.Side = value; }
    }

    public double Height;
}

public class SquareParallelepiped : SquareBaseSolid
{
    public override double Volume()
    {
        return Base.Area() * Height;
    }
}

public class SquarePyramid : SquareBaseSolid
{
    public override double Volume()
    {
        return Base.Area() * Height / 3;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T01:06:33.777

在`class2`你需要从`class1`

```
public class class2
{
class1 class1 = new class1(); 

public double z = class1.x + 5;
} 
```

# java - 使用 Apache Mina 作为模拟/内存 SFTP 服务器进行单元测试

> ID：11837948
> 
> 赞同：15
> 
> 时间：2012-08-07T00:58:30.203
> 
> 标签：java, unit-testing, sftp

我在弄清楚如何使用 Apache Mina 时遇到了一些麻烦。他们的文档对于我那无能的大脑来说有点不足。我在 [Java SFTP 服务器库中看到了有用的起始代码？](https://stackoverflow.com/questions/3076443/java-sftp-server-library)

我不知道如何使用它。我想设置一个单元测试来检查我的 sftp 代码，使用 Mina 作为一种模拟服务器，即能够编写一个单元测试，例如：

```
@Before 
public void beforeTestSetup() {
    sshd = SshServer.setUpDefaultServer();
    sshd.setPort(22);
    sshd.setKeyPairProvider(new SimpleGeneratorHostKeyProvider("hostkey.ser"));

    List<NamedFactory<UserAuth>> userAuthFactories = new ArrayList<NamedFactory<UserAuth>>();
    userAuthFactories.add(new UserAuthNone.Factory());
    sshd.setUserAuthFactories(userAuthFactories);
    sshd.setPublickeyAuthenticator(new PublickeyAuthenticator());

    sshd.setCommandFactory(new ScpCommandFactory());

    List<NamedFactory<Command>> namedFactoryList = new ArrayList<NamedFactory<Command>>();
    namedFactoryList.add(new SftpSubsystem.Factory());
    sshd.setSubsystemFactories(namedFactoryList);

    try {
        sshd.start();
    } catch (Exception e) {
        e.printStackTrace();
    }
}

@Test
public void testGetFile() {

} 
```

问题是要放入什么`testGetFile()`。

我一直在浏览测试代码，想知道上面是否需要更多配置来指定根目录、用户名和身份验证密钥文件名。然后我需要使用客户端或我自己的 SFTP api 代码从中获取和提取文件？

我确信这是一个优秀的 API，只是没有太多的说明，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-13T22:55:46.797

这是我所做的（JUnit）：

```
 @Test
  public void testPutAndGetFile() throws JSchException, SftpException, IOException
  {
    JSch jsch = new JSch();

    Hashtable<String, String> config = new Hashtable<String, String>();
    config.put("StrictHostKeyChecking", "no");
    JSch.setConfig(config);

    Session session = jsch.getSession( "remote-username", "localhost", PORT);
    session.setPassword("remote-password");

    session.connect();

    Channel channel = session.openChannel( "sftp" );
    channel.connect();

    ChannelSftp sftpChannel = (ChannelSftp) channel;

    final String testFileContents = "some file contents";

    String uploadedFileName = "uploadFile";
    sftpChannel.put(new ByteArrayInputStream(testFileContents.getBytes()), uploadedFileName);

    String downloadedFileName = "downLoadFile";
    sftpChannel.get(uploadedFileName, downloadedFileName);

    File downloadedFile = new File(downloadedFileName);
    Assert.assertTrue(downloadedFile.exists());

    String fileData = getFileContents(downloadedFile);

    Assert.assertEquals(testFileContents, fileData);

    if (sftpChannel.isConnected()) {
      sftpChannel.exit();
      System.out.println("Disconnected channel");
    }

    if (session.isConnected()) {
      session.disconnect();  
      System.out.println("Disconnected session");
    }

  }

  private String getFileContents(File downloadedFile)
    throws FileNotFoundException, IOException
  {
    StringBuffer fileData = new StringBuffer();
    BufferedReader reader = new BufferedReader(new FileReader(downloadedFile));

    try {
      char[] buf = new char[1024];
      for(int numRead = 0; (numRead = reader.read(buf)) != -1; buf = new char[1024]) {
        fileData.append(String.valueOf(buf, 0, numRead));
      }
    } finally {    
      reader.close();
    }

    return fileData.toString();
  } 
```

# php - 发布表单时如何自动填充 PHP 全局变量（即 $email）？

> ID：11837949
> 
> 赞同：3
> 
> 时间：2012-08-07T00:58:30.430
> 
> 标签：php, syntax

我遇到了一些在其他人的代码中为表单验证器工作的代码。它应该从发布的表单数据中返回一个值。不管怎样，它*总是*回来`NULL`的。这就是函数的全部内容（假设这段代码*确实*在某一时刻有效）：

```
function _getValue($field)
{
    global ${$field};
    return ${$field};
} 
```

从其他函数的上下文中，我可以看出它试图从（在这种情况下）$_POST 变量中获取值。当我将功能更改为以下内容时，一切都像魅力一样：

```
function _getValue($field)
{
    // $_REQUEST should hold $_GET and $_POST values
    return $_REQUEST[$field];
} 
```

所以我的问题是......在这种情况下到底是什么`global ${$field}`意思？我知道是什么`${$field}`，但假设他们传递`email`给了那个函数。这个全局`$email`变量是从哪里来的？

原始功能应该如何工作？我知道有什么叫做“Super Globals”之类的东西，那很糟糕。这有关系吗？这可能是它停止工作的原因吗？楼主是不是关了Super Globals？

**[编辑]**我提出问题的方式明显有些混乱。我知道 ${$field} 和 $$field 是什么意思，但我不知道如何

```
global ${$field};
return ${$field}; 
```

返回用户放入表单中的值，例如

```
<input name="email"> 
```

你打电话时

```
$this->_getValue('email'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T01:07:48.730

由于[register_globals](http://php.net/manual/en/security.globals.php "注册全球")指令，您之前的程序员希望 POST 变量位于全局空间中。值得庆幸的是，此功能在 PHP 4.2 中默认关闭，并在 PHP 5.4 中删除。

引用文档：

> 当打开时， register_globals 将向您的脚本注入各种变量，例如来自 HTML 表单的请求变量。

我想知道怎么会有人认为这是个好主意:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T01:09:12.347

是的，它与 register_globals 有关，是的，它非常糟糕。我认为您已经从非常旧的代码中获取了它。现在默认情况下，Php 将 register_globals 设置为关闭。这就是代码不起作用的原因。您的修复是正确的。Register_globals 不好，因为它会产生严重的安全风险问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T01:09:31.650

显然，我对问题的措辞不佳，我很抱歉，但是从 Radu 和 pst 对 Radu 的帖子的评论中，我发现以下内容完美地回答了我的问题（如在[http://php.net/manual/上找到的） zh/security.globals.php](http://php.net/manual/en/security.globals.php)）：

> **注意：处理 register_globals**
> 
> 如果不推荐使用的[register_globals](http://www.php.net/manual/en/ini.core.php#ini.register-globals)指令设置为***on，***则其中的变量也将在脚本的全局范围内可用。例如，`$_POST['foo']`也将作为`$foo`.

# android - 每个视图共享相同 ListView 的 ViewPager

> ID：11837953
> 
> 赞同：0
> 
> 时间：2012-08-07T00:58:54.193
> 
> 标签：android, android-layout

** 现在的情况： **

一个带有一个 ListView 的 Activity，它根据在三个不同适配器之间重置适配器来更改其内容。只有一个具有 id 的 ListView ：列表。而已。当我重置适配器时，它会调整列表视图的内容。

我想做的事：

使用 ViewPager 在不同的列表实例之间进行分页。

问题：视图寻呼机似乎设置为采用单独的布局，但我已经针对单个列表编写了所有逻辑。使用三个不同的 ListView 指向不同的列表将是一个很大的重写。

问题：如何使用 ViewPager 在同一列表的视图之间切换，这些视图由应用于列表的不同适配器生成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T03:13:09.737

只需为每个页面使用相同的片段。在意图中设置一个变量，告诉片段应该使用哪个适配器。从技术上讲，它不是同一个列表视图，尽管它是相同的代码（我认为这通常很重要）。

考虑到滑动动画，我认为它在技术上不可能是相同的列表视图。

# jquery - 添加/删除最接近的类跨度

> ID：11837960
> 
> 赞同：0
> 
> 时间：2012-08-07T00:59:53.230
> 
> 标签：jquery, class, html

我目前正在研究一个小的 jQuery 元素，在谷歌搜索和我的一些旧工作的帮助下，我相处得很好。但现在我碰到了一些东西，我有点卡住了。

这是元素的jsFiddle：http: [//jsfiddle.net/HeAyW/](http://jsfiddle.net/HeAyW/)

如您所见，这是一个非常简单的选择器。您可以单击数字来获取输入，您可以单击 + 和 - 按钮来更改输入以及单击它的数字更改的背景。

但问题是，当您按下 + 或 - 按钮时，它不会更改跨度的类别，而输入中的数字确实会更改。我认为这与兄弟姐妹有关，但我不能指望它。

**代码参考**

```
jQuery(document).ready(function() {

$('.spanval').click(function(){
    $('#hourvalue').val($(this).text());
});

    $('.spanval').click(function(){
        $('.spanval_active').removeClass('spanval_active');
         $(this).addClass('spanval_active');
    });

jQuery('.hour_dropdown').hide()

jQuery('.more').click(function() {
    $('.hour_dropdown').fadeToggle(200);
});

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T01:38:30.857

您从未将任何内容绑定到 Add 和 Subtract 链接。我正要这样做，然后有点得意忘形。我取出了您的内联 Javascript，并为添加和删除类制作了一个通用处理程序。您现在还可以键入一个数字来更改班级。

[http://jsfiddle.net/HeAyW/3/](http://jsfiddle.net/HeAyW/3/)

**编辑**

我更新了每个索引都有一个属性“data-num”，jQuery 可以将其读取为索引的正值。

注意HTML和JS最后一行的变化

[http://jsfiddle.net/HeAyW/4/](http://jsfiddle.net/HeAyW/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T01:07:46.893

添加和减去“按钮”的事件处理程序是内联的，并且非常简单地仅增加（或减少）小时值框中的数字，没有代码可以更改相同相关数字的类（.spanval 元素）。在单击 + 和 - 按钮时添加一些代码，以根据需要添加/删除类。或者可能在小时值框中为更改事件添加一些代码，以将类添加到相关编号（如果还没有的话）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T01:42:03.703

正如@OJay 提到的，您已将 onclick 事件声明为内联。将所有 JS 代码放在一起是个好主意。

基本上，您没有`.spanval_active`在 onclick 事件处理程序中更改加号和减号元素的类。

这是一种方法：http: [//jsfiddle.net/PcWjA/2/](http://jsfiddle.net/PcWjA/2/)

```
jQuery(document).ready(function() {
        // You can set this to a default hour and then call update_hour()
        var hour = 0;

        $('.spanval').click(function() {
            hour = $(this).text();
        });

        $('.subtract').click(function() {
            hour--;
        });

        $('.add').click(function() {
            hour++;
        });

        $('.spanval, .subtract, .add').click(function() {
            update_hour();
        });

        function update_hour()
        {
            $('.spanval_active').removeClass('spanval_active');

            $('.spanval').eq( hour - 1 ).addClass('spanval_active');

            $('#hourvalue').val( hour );
        }

        //update_hour();

        jQuery('.hour_dropdown').hide()

        jQuery('.more').click(function() {
            $('.hour_dropdown').fadeToggle(200);
        });

    });​ 
```

# java - Maven 部署超时/无法生成校验和

> ID：11837961
> 
> 赞同：2
> 
> 时间：2012-08-07T01:00:18.207
> 
> 标签：java, eclipse, maven, deployment, maven-deploy-plugin

我正在尝试将工件部署到提供公共 Maven 存储库的[clojars 。](https://clojars.org/)

当我运行部署时，最后出现以下输出失败，显然是在 60 秒超时后：

```
[INFO] --- maven-deploy-plugin:2.7:deploy (default-deploy) @ clisk ---
Uploading: https://clojars.org/repo/net/mikera/clisk/0.3.0/clisk-0.3.0.jar
Uploading: https://clojars.org/repo/net/mikera/clisk/0.3.0/clisk-0.3.0.pom
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 2:13.466s
[INFO] Finished at: Tue Aug 07 08:51:00 SGT 2012
[INFO] Final Memory: 21M/253M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-deploy-plugin:2.7:deploy (default-deploy) on project clisk: Failed to deploy artifacts: Could not transfer artifact net.mikera:clisk:jar:0.3.0 from/to clojars (https://clojars.org/repo): No response received after 60000 -> [Help 1] 
```

有趣的是，会发生以下情况：

*   jar 和 pom*已*成功部署（我可以在 repo 中看到它们）
*   *不*生成各种 MD5/SHA1 校验和

更多链接：

*   报告的[问题](https://github.com/mikera/clisk/issues/2)
*   [pom.xml](https://github.com/mikera/clisk/blob/0.3.0/pom.xml) _

我在 Eclipse Juno 中使用内置的 Maven 支持

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T06:26:08.493

这不是一个完整的解决方案，而是我发现的一种解决方法，张贴在这里以防其他人需要它。

*   使用“Run As.../Maven Install”构建代码并安装在本地存储库中
*   确保`pageant`使用您的 SSH 密钥（来自 PuTTY 套件）运行。SSH 密钥必须与您在个人资料中提供给 Clojars 的公钥匹配
*   打开控制台并 cd 进入“.m2”本地存储库目录以找到 .pom 和 .jar 文件
*   运行以下命令：

    pscp -scp *.pom *.jar clojars@clojars.org:

这似乎很成功：Clojars 本身将生成所需的校验和文件。

# scala - 这是设计 Scala API 的良好返回类型模式吗？

> ID：11837966
> 
> 赞同：6
> 
> 时间：2012-08-07T01:00:54.177
> 
> 标签：scala

我在 Scala 中经常看到这种类型的模式（[在此处找到此示例）：](https://github.com/janm399/akka-patterns/wiki/Spring)

```
class UserActor extends Actor {
  def receive = {
    case GetUser(id) =>
      // load the user, reply with None or Some(user)
      val user: Option[User] = ... 
      sender ! user
    case FindAll() =>
      // find all users
      val users: List[User] = ...
      sender ! users
    case Save(user) =>
      // persist the user
      sender ! Right(user)
  }
} 
```

因此，根据您获得的调用：Option[User]、List[User]、Right[User]。这个方法不错！我只是出于兴趣问这是否是最佳的？例如（这可能是一个糟糕的问题）：总是返回 List[User] 来尝试泛化是否会使 API 变得更好或更糟？因此，当未找到用户或保存失败时，列表将为空。我只是好奇......关于如何改进上述“模式”的任何其他建议？

我只是想为这种风格的 API 确定一个完美的模式，有时你会得到一个实体，有时没有，有时是它们的列表。有没有“最好”的方法来做到这一点，或者每个人都扮演自己的角色？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-07T02:52:01.063

返回类型应该有助于阐明 API 的预期行为。

如果`GetUser`返回 a `List`，开发人员可能会感到困惑，并想知道是否可能返回多个用户。当他们看到`Option`返回 an 时，他们会立即理解预期的行为。

我曾经不得不使用一个相当复杂的 API，它提供了以您描述的方式概括的 CRUD 操作。我发现它难以理解、定义模糊且难以使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T06:14:42.300

在我看来，这是一个非常好的 API 设计模式。
如果我想返回单个元素，我经常`Option`将其用作函数的返回类型，显然是因为我不需要处理`null`. 返回 a`Seq`自然适用于多个元素，`Either`如果您想返回故障描述，这是最佳选择，我在解析 I/O 时经常使用它。有时我什至将`Seq`与其他之一结合起来。您可能不知道 API 用户的偏好和目标，因此提供所有这些返回类型以使用户感到尽可能舒适是有意义的。

# iphone - Objective-C概念中的混淆类别

> ID：11837967
> 
> 赞同：-1
> 
> 时间：2012-08-07T01:01:05.460
> 
> 标签：iphone, objective-c, ios, categories

嗨，我想知道 Objective-C 中的类别

我有 3 个文件

1.  A_ViewController

2.  A_ViewController+类别

3.  B_ViewController

这是示例代码

1-1。A_ViewController.h

```
@interface A_ViewController {
// some instance Variables
}
//some public methods
@end 
```

1-2 A_ViewController.m

```
#import "A_ViewController.h."
@implementation A_ViewController
// implementation public methods and private methods
@end 
```

2-1。A_ViewController+Category.h

```
@interface A_ViewControler(Category)
-(void) categoryMethod;
@end 
```

2-2。A_ViewController+Category.m

```
#import "A_ViewController.h"
#import "A_ViewController+Category.h"
@implementation A_ViewController(Category)
-(void) categoryMethod {
     NSLog(@"it's A_ViewController+Category");
}
@end 
```

3-1。B_ViewController.h

```
@interface B_ViewController {
// some instance variables
}
-(void) myMethod; 
```

3-2。B_ViewController.m

```
#import "B_ViewController.h"
#import "A_ViewController.h"
@interface A_ViewController() // i think it's A_ViewController extension, not A_ViewController+Category, am i right?
-(void) categoryMethod;
@end
@implementation B_ViewController
-(void) myMethod
{
     A_ViewController *obj = [[A_ViewController alloc] init];
     [obj categoryMethod];
}
@end 
```

我以为它崩溃了，因为我没有导入 A_ViewController+Category.h

而且我没有`-(void) categoryMethod`在 B_ViewController.m 中实现

但它工作正常，没有警告。

怎么`[obj categoryMethod]`能联系起来？？

如果这是非常好的语法，我有扩展问题。

如果我有另一个名为 A_ViewController+Category2 的类别

这是 A_ViewController+Category.h

```
@interface A_ViewController(Category2)
-(void) categoryMethod;
@end 
```

和 A_ViewController+Category2.m

```
#import "A_ViewController.h"
#import "A_ViewController+Category2.h"
@implementation A_ViewController(Category2)
-(void) categoryMethod
{
    NSLog(@"it's A_ViewController+Category2");
}
@end 
```

而这种情况，如果我写一个像 3-2 这样的代码，

那么`[obj categoryMethod]`可以保证

来自 A_ViewController+Category 或 A_ViewController+Category2，对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T01:06:21.733

我正在努力弄清楚你想要做什么，但关于标准类别行为。

如果要调用from`categoryMethod`的实例，则需要导入包含类别方法 @interface 的标头。`A_ViewController``B_BiewController`

您不能`()`在`A_ViewController`from within上声明私有类别`B_ViewController.m`，因为私有类别或类扩展是一个特殊类别。

**B_ViewController.m 应该是这样的**

```
#import "B_ViewController.h"
#import "A_ViewController+Category.h"

@implementation B_ViewController

- (void) myMethod {
  A_ViewController *obj = [[A_ViewController alloc] init];
  [obj categoryMethod];
}

@end 
```

**编辑**

我刚刚注意到您的`Category2`方法名称与您的`Category`方法名称相同。这是 Objective C 中不正确和未定义的行为。

# javascript - 具有双重功能的按钮：在 _blank 窗口中打开一个链接，以及在 _self 中打开一个不同的链接

> ID：11837971
> 
> 赞同：0
> 
> 时间：2012-08-07T01:01:35.537
> 
> 标签：javascript, javascript-events

这可能吗？我正在构建一个简单的 Facebook 应用程序，并且想要一个按钮在 _blank 窗口中加载外部链接，而应用程序的下一页在 _self 窗口中加载。我是 JavaScript 的新手，因此非常感谢任何帮助/建议！

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T01:08:58.417

将单击事件侦听器添加到执行以下行的按钮：

```
window.open('http://www.example.org/external_link.html', 'New Window');
window.location.href = 'http://www.example.org/internal_link.html'; 
```

第一行可能会被一些弹出窗口阻止程序阻止，但让我们试一试。

# ruby - Rails 中的工作日选择器

> ID：11837976
> 
> 赞同：0
> 
> 时间：2012-08-07T01:02:38.300
> 
> 标签：ruby, ruby-on-rails-3, forms, simple-form

我有一个`Schedule`模型，用户可以选择小时和一周中的特定日期（例如`3hrs` `monday, tuesday, saturday`）。我的迁移看起来像

```
 class CreateSchedules < ActiveRecord::Migration
 def change
 create_table :schedules do |t|
  t.integer :hourss
  t.integer :user_id
  t.boolean :monday
  t.boolean :tuesday
  t.boolean :wednesday
  t.boolean :thursday
  t.boolean :friday
  t.boolean :saturday
  t.boolean :sunday

  t.timestamps
end
end
end 
```

如何在视图中编写表单以显示工作日的复选框并选择一些，布尔值应设置为 true。我正在使用`Simple Form`Rails 3.2.7

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T04:03:56.323

用简单的形式它真的很容易。做就是了

= f.输入：星期一

= f.输入：星期二

等简单的形式自动将布尔数据库项目转换为复选框

# knockout.js - 我可以将 Knockout.js-External-Template-Engine 与嵌套模型一起使用吗？

> ID：11837977
> 
> 赞同：4
> 
> 时间：2012-08-07T01:02:43.537
> 
> 标签：knockout.js

我正在尝试使用嵌套模板的工作演示来实现**Knockout.js-External-Template-Engine**

目前我有这样的设置

```
<ul data-bind="template: {name: 'TopTemplate'}"></ul>

<script type="text/html" id="TopTemplate">
    <li><span>Result</span>
        <ul data-bind=" template: {name:  'FooTemplate' , foreach: foos}">
        </ul>
    </li>
    <button data-bind='click: addFoo'>Add Foo</button>
</script> 
```

当我尝试将此 TopTemplate 移动到文件 (templates\view.html) 时， **view.html**即

```
<li><span>Result</span>
<ul data-bind=" template: {name:  'FooTemplate' , foreach: foos} " style="list-style-type:circle;margin-left:15px">
</ul>
</li>
<button data-bind='click: addFoo'>Add Foo</button> 
```

失败**（无法解析绑定....foos 未定义）**

这是我使用**whichTemplateToUse更新的视图模型**

```
 var viewModel = {
    isEditable: ko.observable(false),
    foos: ko.mapping.fromJS([]),
    loadInitialData: function () {
        ko.mapping.fromJS(serverData, dataMappingOptions, viewModel.foos);
    },
    loadUpdatedData: function () {
        ko.mapping.fromJS(serverData, dataMappingOptions, viewModel.foos);
    },
    whichTemplateToUse: function() {
        return viewModel.isEditable() ? 'edit' : 'view';
    }
}; 
```

我确定我错过了这里的重点 - 但我是否需要更改我的 Top Template 数据绑定表达式

允许加载外部子模板。顶部模板适用于简单的静态文本，因此我认为基本集成是正确的。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T02:10:50.057

找到了一个很好的[演示](http://ifandelse.com/?p=100)来做这件事。

# python - 删除已保存图像周围的空白

> ID：11837979
> 
> 赞同：250
> 
> 时间：2012-08-07T01:02:57.643
> 
> 标签：python, matplotlib

我需要拍摄一张图片并在经过一些处理后保存。当我显示它时，这个图看起来很好，但是在保存图之后，我在保存的图像周围有一些空白。我已经尝试了方法`'tight'`选项`savefig`，也没有工作。编码：

```
 import matplotlib.image as mpimg
  import matplotlib.pyplot as plt

  fig = plt.figure(1)
  img = mpimg.imread("image.jpg")
  plt.imshow(img)
  ax=fig.add_subplot(1, 1, 1)

  extent = ax.get_window_extent().transformed(fig.dpi_scale_trans.inverted())
  plt.savefig('1.png', bbox_inches=extent)

  plt.axis('off') 
  plt.show() 
```

我正在尝试通过在图形上使用 NetworkX 来绘制基本图形并保存它。我意识到没有图表它可以工作，但是当添加图表时，我会在保存的图像周围出现空白；

```
import matplotlib.image as mpimg
import matplotlib.pyplot as plt
import networkx as nx

G = nx.Graph()
G.add_node(1)
G.add_node(2)
G.add_node(3)
G.add_edge(1, 3)
G.add_edge(1, 2)
pos = {1:[100, 120], 2:[200, 300], 3:[50, 75]}

fig = plt.figure(1)
img = mpimg.imread("image.jpg")
plt.imshow(img)
ax=fig.add_subplot(1, 1, 1)

nx.draw(G, pos=pos)

extent = ax.get_window_extent().transformed(fig.dpi_scale_trans.inverted())
plt.savefig('1.png', bbox_inches = extent)

plt.axis('off') 
plt.show() 
```

* * *

## 回答 #1

> 赞同：283
> 
> 时间：2012-08-07T13:39:05.087

`bbox_inches="tight"`您可以通过设置删除空白填充`savefig`：

```
plt.savefig("test.png",bbox_inches='tight') 
```

你必须把参数`bbox_inches`作为一个字符串，也许这就是为什么它不能更早地为你工作。

* * *

**可能的重复：**

[Matplotlib 绘图：删除轴、图例和空白](https://stackoverflow.com/questions/9295026/matplotlib-plots-removing-axis-legends-and-white-spaces)

[如何设置 matplotlib 图形的边距？](https://stackoverflow.com/questions/10898919/how-to-set-the-margins-for-a-matplotlib-figure)

[减少matplotlib图中的左右边距](https://stackoverflow.com/questions/4042192/reduce-left-and-right-margins-in-matplotlib-plot)

* * *

## 回答 #2

> 赞同：262
> 
> 时间：2014-12-01T11:45:51.573

我不能声称我确切地知道我的“解决方案”为什么或如何工作，但当我想将几个翼型截面的轮廓（没有白边）绘制到 PDF 文件时，我必须这样做。（请注意，我在 IPython 笔记本中使用了 matplotlib，带有 -pylab 标志。）

```
plt.gca().set_axis_off()
plt.subplots_adjust(top = 1, bottom = 0, right = 1, left = 0, 
            hspace = 0, wspace = 0)
plt.margins(0,0)
plt.gca().xaxis.set_major_locator(plt.NullLocator())
plt.gca().yaxis.set_major_locator(plt.NullLocator())
plt.savefig("filename.pdf", bbox_inches = 'tight',
    pad_inches = 0) 
```

我试图停用它的不同部分，但这总是会导致某处出现白边。您甚至可以对此进行修改，以防止靠近图形边界的粗线因缺少边距而被剃掉。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2018-11-15T00:19:13.247

在尝试上述答案但没有成功（以及大量其他堆栈帖子）之后，最终对我有用的只是

```
plt.gca().set_axis_off()
plt.subplots_adjust(top = 1, bottom = 0, right = 1, left = 0, 
            hspace = 0, wspace = 0)
plt.margins(0,0)
plt.savefig("myfig.pdf") 
```

重要的是，这不包括 bbox 或 padding 参数。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2017-09-11T15:05:23.683

我从 Arvind Pereira ( [http://robotics.usc.edu/~ampereir/wordpress/?p=626](http://robotics.usc.edu/~ampereir/wordpress/?p=626) ) 找到了一些东西，似乎对我有用：

```
plt.savefig(filename, transparent = True, bbox_inches = 'tight', pad_inches = 0) 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2018-11-28T09:23:50.637

以下函数包含上面 johannes-s 的答案。我已经使用多个轴对其进行了测试，`plt.figure`并且`plt.subplots()`效果很好。

```
def save(filepath, fig=None):
    '''Save the current image with no whitespace
    Example filepath: "myfig.png" or r"C:\myfig.pdf" 
    '''
    import matplotlib.pyplot as plt
    if not fig:
        fig = plt.gcf()

    plt.subplots_adjust(0,0,1,1,0,0)
    for ax in fig.axes:
        ax.axis('off')
        ax.margins(0,0)
        ax.xaxis.set_major_locator(plt.NullLocator())
        ax.yaxis.set_major_locator(plt.NullLocator())
    fig.savefig(filepath, pad_inches = 0, bbox_inches='tight') 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2018-05-24T15:16:58.857

我发现以下代码非常适合这项工作。

```
fig = plt.figure(figsize=[6,6])
ax = fig.add_subplot(111)
ax.imshow(data)
ax.axes.get_xaxis().set_visible(False)
ax.axes.get_yaxis().set_visible(False)
ax.set_frame_on(False)
plt.savefig('data.png', dpi=400, bbox_inches='tight',pad_inches=0) 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2018-11-27T13:06:10.023

我按照这个顺序，它就像一个魅力。

```
plt.axis("off")
fig=plt.imshow(image array,interpolation='nearest')
fig.axes.get_xaxis().set_visible(False)
fig.axes.get_yaxis().set_visible(False)
plt.savefig('destination_path.pdf',
    bbox_inches='tight', pad_inches=0, format='pdf', dpi=1200) 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2019-08-14T15:59:01.620

最直接的方法是使用`plt.tight_layout`转换，实际上更可取，因为它在使用时不会进行不必要的裁剪`plt.savefig`

```
import matplotlib as plt    
plt.plot([1,2,3], [1,2,3])
plt.tight_layout(pad=0)
plt.savefig('plot.png') 
```

但是，这对于修改图形的复杂绘图可能并不可取。如果是这种情况，请参阅[Johannes S 的答案。](https://stackoverflow.com/a/27227718/7898913)`plt.subplots_adjust`

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2020-07-24T15:20:36.720

这对我有用 `plt.savefig(save_path,bbox_inches='tight', pad_inches=0, transparent=True)`

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2019-06-28T09:18:15.573

我发现一个更简单的方法是使用`plt.imsave`：

```
 import matplotlib.pyplot as plt
    arr = plt.imread(path)
    plt.imsave('test.png', arr) 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2019-09-20T02:05:42.853

对于任何想要以像素而不是英寸工作的人来说，这都行得通。

加上通常你还需要

```
from matplotlib.transforms import Bbox 
```

然后，您可以使用以下内容：

```
my_dpi = 100 # Good default - doesn't really matter

# Size of output in pixels
h = 224
w = 224

fig, ax = plt.subplots(1, figsize=(w/my_dpi, h/my_dpi), dpi=my_dpi)

ax.set_position([0, 0, 1, 1]) # Critical!

# Do some stuff
ax.imshow(img)
ax.imshow(heatmap) # 4-channel RGBA
ax.plot([50, 100, 150], [50, 100, 150], color="red")

ax.axis("off")

fig.savefig("saved_img.png",
            bbox_inches=Bbox([[0, 0], [w/my_dpi, h/my_dpi]]),
            dpi=my_dpi) 
```

[![在此处输入图像描述](../Images/dbcd9e6b36716425687a94d9fffe06fc.png)](https://i.stack.imgur.com/0ktoi.png)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-12-27T19:06:34.547

因此解决方案取决于您是否调整子图。如果您指定 plt.subplots_adjust (top, bottom, right, left)，您不想将 bbox_inches='tight' 的 kwargs 与 plt.savefig 一起使用，因为它自相矛盾地创建了空白填充。它还允许您将图像保存为与输入图像相同的暗淡（600x600 输入图像保存为 600x600 像素输出图像）。

如果您不关心输出图像大小的一致性，您可以省略 plt.subplots_adjust 属性，只需将 bbox_inches='tight' 和 pad_inches=0 kwargs 与 plt.savefig 一起使用。

此解决方案适用于 matplotlib 版本 3.0.1、3.0.3 和 3.2.1。当您有超过 1 个子图（例如 plt.subplots(2,2,...)）时，它也可以工作。

```
def save_inp_as_output(_img, c_name, dpi=100):
    h, w, _ = _img.shape
    fig, axes = plt.subplots(figsize=(h/dpi, w/dpi))
    fig.subplots_adjust(top=1.0, bottom=0, right=1.0, left=0, hspace=0, wspace=0) 
    axes.imshow(_img)
    axes.axis('off')
    plt.savefig(c_name, dpi=dpi, format='jpeg') 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-07-17T15:59:59.747

你可以试试这个。它解决了我的问题。

```
import matplotlib.image as mpimg
img = mpimg.imread("src.png")
mpimg.imsave("out.png", img, cmap=cmap) 
```

* * *

## 回答 #14

> 赞同：-4
> 
> 时间：2018-05-02T01:52:57.027

这适用于我将使用 imshow 绘制的 numpy 数组保存到文件

```
import matplotlib.pyplot as plt

fig = plt.figure(figsize=(10,10))
plt.imshow(img) # your image here
plt.axis("off")
plt.subplots_adjust(top = 1, bottom = 0, right = 1, left = 0, 
        hspace = 0, wspace = 0)
plt.savefig("example2.png", box_inches='tight', dpi=100)
plt.show() 
```

# postgresql - Node.js Postgres 获取最后执行的查询

> ID：11837991
> 
> 赞同：1
> 
> 时间：2012-08-07T01:04:44.957
> 
> 标签：postgresql, node.js

js 和 Postgres（使用[这个](https://github.com/brianc/node-postgres/)模块），我想查看查询数据库后已执行的 SQL（因为我正在使用参数化语句）。是否有捷径可寻？

例如，我执行代码如下：

```
var first = client.query("UPDATE settings SET json=$1 WHERE source_name=$2", [JSON.stringify(settings), 'website']);

first.on('end', function(result){
        console.log(result);
        client.end();               
}); 
```

有没有`result.lastQuery()`我可以使用的方法，因为我在文档中找不到类似的东西？我无法让我的查询正常工作，我想进一步调试它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T03:40:31.787

似乎没有直接的方法来做到这一点（如果 Postgres 像大多数数据库服务器一样，带有参数标记的查询被编译成中间代码，并且稍后绑定实际参数，因此永远不会有任何实际的 SQL 文本与参数插入其中的值）。

这篇[博文](http://chrismiles.info/systemsadmin/databases/articles/viewing-current-postgresql-queries/)可能有帮助，也可能没有帮助。

# ruby-on-rails - 来自变量名的 Rails 参考模型

> ID：11837993
> 
> 赞同：4
> 
> 时间：2012-08-07T01:04:54.730
> 
> 标签：ruby-on-rails, model, variable-assignment

我有一些代码使用字符串来动态确定要使用的模型类以及 find_by() 的字段。但是，我很难了解如何使用这些变量来获取模型实例。具体来说，我有

```
class Item
  include MongoMapper::Document
  key :my_variable, String 
```

在我的代码中

```
m = "Item"
f = "my_variable" 
```

我希望能够

```
i = m.find_by_my_variable( f )
result = i[f] 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T02:08:58.773

由于您在 Rails 中（根据类别标签判断），您可以使用：

```
m = m.constantize 
```

使字符串成为常量，然后这样的东西是否适用于您的查询？

```
m.where("#{f} = ?", some_value) 
```

（编辑）或使用 ismaelga 建议的发送，如果您不想要 ActiveRecord::Relation 数组对象

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T02:18:49.907

你可以做`eval(m.capitalize).send("find_by_#{variable_name}", variable_content)`

大写它只是为了确保它得到一个大写字母。